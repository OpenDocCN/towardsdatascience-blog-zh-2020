<html>
<head>
<title>Reducing AI bias with Synthetic data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用合成数据减少人工智能偏差</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/reducing-ai-bias-with-synthetic-data-7bddc39f290d?source=collection_archive---------58-----------------------#2020-05-18">https://towardsdatascience.com/reducing-ai-bias-with-synthetic-data-7bddc39f290d?source=collection_archive---------58-----------------------#2020-05-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="7b18" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/fairness-and-bias" rel="noopener" target="_blank">公平和偏见</a></h2><div class=""/><div class=""><h2 id="1afc" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">生成人工记录以平衡有偏差的数据集并提高整体模型准确性</h2></div><p id="0940" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在这篇文章中，我们将探索使用<a class="ae ln" href="https://en.wikipedia.org/wiki/Synthetic_data" rel="noopener ugc nofollow" target="_blank">合成数据</a>来增强Kaggle上一个受欢迎的健康数据集，然后训练表现和概括更好的AI和ML模型，同时减少<a class="ae ln" href="https://en.wikipedia.org/wiki/Algorithmic_bias" rel="noopener ugc nofollow" target="_blank">算法偏差</a>。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/8cb213d67a1fccd87b0e7e3e8ff3c733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7VyQ5Ribi2ieG2APQ8hnbw.jpeg"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">来源:Kubkoo，via iStockPhoto</p></figure><p id="8900" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">由<a class="ae ln" href="https://archive.ics.uci.edu/ml/datasets/Heart+Disease" rel="noopener ugc nofollow" target="_blank">加州大学欧文分校</a>发布的<a class="ae ln" href="https://www.kaggle.com/ronitf/heart-disease-uci" rel="noopener ugc nofollow" target="_blank">心脏病数据集</a>是数据科学竞赛网站<a class="ae ln" href="http://kaggle.com" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上排名前5的数据集之一，列出了9个数据科学任务和1014+个由数据科学家创建的笔记本内核。它是一系列健康14属性，并标有患者是否患有心脏病，使其成为一个很好的预测数据集。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi me"><img src="../Images/fc00f035e9f42d66d04af136495fd016.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sthprM9FDFQj-VLSKYlzQQ.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">Kaggle上的UCI心脏病数据集概述</p></figure><p id="2b88" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">快速浏览数据集显示，男性患者记录占整个数据集的68%，女性患者记录仅占32%。由于男性与女性患者的比例为2比1，这可能导致数据集上训练的算法过度索引男性症状，并对女性患者进行不良诊断。在训练数据中，没有什么可以替代平等的群体代表性，尤其是在医疗保健领域。如果没有这些，我们如何尽可能减少输入数据中的偏差？</p><blockquote class="mf"><p id="8b1c" class="mg mh it bd mi mj mk ml mm mn mo lm dk translated">"通过用合成记录扩充训练集，我们能减少性别偏见并提高ML的准确性吗？"</p></blockquote><p id="4a75" class="pw-post-body-paragraph kr ks it kt b ku mp kd kw kx mq kg kz la mr lc ld le ms lg lh li mt lk ll lm im bi translated">为了测试我们的论文，我们将使用<a class="ae ln" href="https://gretel.ai" rel="noopener ugc nofollow" target="_blank"> Gretel.ai </a>的开源<a class="ae ln" href="https://github.com/gretelai/gretel-synthetics" rel="noopener ugc nofollow" target="_blank">合成数据库</a>来生成额外的女性患者记录，以尝试补偿有偏差的训练数据。我们希望这将有助于分类器提高对男性和女性患者心脏病的预测，并更好地推广未知数据。然后，我们可以在Kaggle上通过ML算法运行合成数据集，将结果与训练集进行比较。</p><p id="ee84" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">Kaggle上的一个顶级数据科学笔记本(由forks开发，链接如下)在UCI数据集上运行了一系列6种分类算法，并比较了所得模型的准确性。笔记本将原始数据集分割成训练(80%)和测试(20%)分割，我们将它们保存到磁盘上作为<code class="fe mu mv mw mx b"><a class="ae ln" href="https://gretel-public-website.s3-us-west-2.amazonaws.com/datasets/uci-heart-disease/train.csv" rel="noopener ugc nofollow" target="_blank">train.csv</a></code>和<code class="fe mu mv mw mx b"><a class="ae ln" href="https://gretel-public-website.s3-us-west-2.amazonaws.com/datasets/uci-heart-disease/test.csv" rel="noopener ugc nofollow" target="_blank">test.csv</a></code>。我们将使用train.csv来训练我们的合成模型，并使用test.csv来验证笔记本中的6种分类算法的结果。</p><div class="my mz gp gr na nb"><a href="https://www.kaggle.com/cdabakoglu/heart-disease-classifications-machine-learning" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd jd gy z fp ng fr fs nh fu fw jc bi translated">心脏病-分类(机器学习)</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自UCI心脏病研究中心的数据</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">www.kaggle.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np ly nb"/></div></div></a></div><h1 id="08e3" class="nq nr it bd ns nt nu nv nw nx ny nz oa ki ob kj oc kl od km oe ko of kp og oh bi translated">训练合成数据模型</h1><p id="7f65" class="pw-post-body-paragraph kr ks it kt b ku oi kd kw kx oj kg kz la ok lc ld le ol lg lh li om lk ll lm im bi translated">要生成自己的合成记录，请通过谷歌合作实验室(点击<a class="ae ln" href="https://colab.research.google.com/github/gretelai/gretel-synthetics/blob/master/examples/research/heart_disease_uci.ipynb" rel="noopener ugc nofollow" target="_blank">此处</a>)启动Gretel-synthetics，或者直接在我们的<a class="ae ln" href="https://github.com/gretelai/gretel-synthetics/blob/master/examples/research/heart_disease_uci.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上查看笔记本。单击Colaboratory中的“Run all”下载从Kaggle导出的训练数据集，训练模型，并生成新的患者记录以扩充原始训练数据。</p><p id="a8e2" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">为您的合成数据模型配置以下设置-请注意，我们通过15个时期的训练和256个隐藏单元找到了泛化与模型准确性之间的良好平衡。请注意，在此配置中，不需要使用差异隐私进行培训，因为数据集已经被取消标识。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="on oo l"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">UCI数据集的最佳合成数据模型配置</p></figure><p id="6fdc" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">为了测试关于算法偏差的理论，我们在笔记本上添加了一个非常简单的自定义验证器，它只接受由我们的合成模型生成的女性记录(第1列-性别等于0)。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="on oo l"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">简单的合成记录验证器，只接受由模型生成的“女性”患者数据记录</p></figure><p id="9685" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们现在准备在我们的输入数据上训练一个合成数据模型，并使用它来生成111个女性患者数据记录，以增加我们的训练集。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi op"><img src="../Images/ba7c1afb1d7418044cc3cfa59cb81f83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*4HxNihQ2F8voXlDhwmG2og.gif"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">创建合成的女性患者记录以添加到训练数据集(点击<a class="ae ln" href="https://colab.research.google.com/github/gretelai/gretel-synthetics/blob/master/examples/research/heart_disease_uci.ipynb" rel="noopener ugc nofollow" target="_blank">此处</a>在Google Colab中运行！)</p></figure><p id="06e0" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">合成模型很快学会了数据的语义，并在10个时期内训练到95%以上的准确度。接下来，下载生成的数据集，让我们在Kaggle上运行它！</p><h1 id="f8d6" class="nq nr it bd ns nt nu nv nw nx ny nz oa ki ob kj oc kl od km oe ko of kp og oh bi translated">进行实验</h1><p id="61d6" class="pw-post-body-paragraph kr ks it kt b ku oi kd kw kx oj kg kz la ok lc ld le ol lg lh li om lk ll lm im bi translated">现在，让我们转到Kaggle并运行分类笔记本(进行最少的编辑以允许原始模型和我们的增强模型运行)。为了方便起见，您可以在此处加载修改后的笔记本。默认情况下，它将与我们生成的测试集一起运行。要使用您自己的数据集，请将上一步生成的数据集上传到Kaggle笔记本。</p><div class="my mz gp gr na nb"><a href="https://www.kaggle.com/redlined/heart-disease-classifications-machine-learning" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd jd gy z fp ng fr fs nh fu fw jc bi translated">心脏病-分类(机器学习)</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">使用Kaggle笔记本探索和运行机器学习代码|使用来自多个数据源的数据</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">www.kaggle.com</p></div></div><div class="nk l"><div class="oq l nm nn no nk np ly nb"/></div></div></a></div><h1 id="e7a0" class="nq nr it bd ns nt nu nv nw nx ny nz oa ki ob kj oc kl od km oe ko of kp og oh bi translated">结果</h1><p id="3e2a" class="pw-post-body-paragraph kr ks it kt b ku oi kd kw kx oj kg kz la ok lc ld le ol lg lh li om lk ll lm im bi translated">正如我们在下面看到的，创建并向训练集添加合成生成的患者记录提高了6种分类算法中5种算法的准确性，实现了<strong class="kt jd">KNN 96.7%的总体准确性(高于88.5%) </strong>，随机森林93%，决策树分类器相对于非合成数据集上训练的模型提高了13%。由于算法强烈假设所有特征都是独立的(因此是朴素的),并且合成数据模型可能学习并重放了训练数据中的相关性，因此朴素贝叶斯的准确性可能会下降。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi or"><img src="../Images/e07036654743172882f0790e0f48f722.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*I0TkCGEtuFanXGFE6djbGg.png"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">合成的平均准确率:90.16%，原始的:85.79%。平均改善率:4.37%</p></figure><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi os"><img src="../Images/bedffe09c51a898ab1cb99746545f7f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*nXdKqco8z1l86peNBBBoyQ.png"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">整体模型性能(基线与基线+综合)</p></figure><p id="b067" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">最后，查看按性别划分的模型准确性结果，女性的原始模型准确性平均值为84.57%。通过增加女性患者数据记录和训练相同的模型，准确率提高到90.74%。有趣的是，男性患者数据预测准确率也从86.61%提高到90.71%。</p><blockquote class="mf"><p id="3036" class="mg mh it bd mi mj mk ml mm mn mo lm dk translated">6.17%的女性心脏病患者现在可以被准确诊断！</p></blockquote><h1 id="5657" class="nq nr it bd ns nt nu nv nw nx ny nz oa ki ot kj oc kl ou km oe ko ov kp og oh bi translated">结论</h1><p id="4b6f" class="pw-post-body-paragraph kr ks it kt b ku oi kd kw kx oj kg kz la ok lc ld le ol lg lh li om lk ll lm im bi translated">在<a class="ae ln" href="https://gretel.ai" rel="noopener ugc nofollow" target="_blank"> Gretel.ai </a>，我们对使用合成数据来增强训练集以创建ML和ai模型的可能性感到非常兴奋，这些模型可以更好地概括未知数据，并减少算法偏差。我们很乐意听到你的用例——欢迎在评论中联系我们进行更深入的讨论，<a class="ae ln" href="https://twitter.com/gretel_ai" rel="noopener ugc nofollow" target="_blank"> twitter </a>或<a class="ae ln" href="mailto:hi@gretel.ai" rel="noopener ugc nofollow" target="_blank"> hi@gretel.ai </a>。关注我们，用合成数据跟上最新趋势！</p><p id="27ce" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">有兴趣在自己的数据集上进行训练吗？Gretel-synthetics 是免费开源的，你可以通过<a class="ae ln" href="https://camo.githubusercontent.com/52feade06f2fecbf006889a904d221e6a730c194/68747470733a2f2f636f6c61622e72657365617263682e676f6f676c652e636f6d2f6173736574732f636f6c61622d62616467652e737667" rel="noopener ugc nofollow" target="_blank">合作实验室</a>在几秒钟内开始实验。</p></div></div>    
</body>
</html>