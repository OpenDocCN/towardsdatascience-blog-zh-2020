<html>
<head>
<title>An R Package to Explore the Novel Coronavirus</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索新型冠状病毒的R包</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-r-package-to-explore-the-novel-coronavirus-590055738ad6?source=collection_archive---------7-----------------------#2020-02-10">https://towardsdatascience.com/an-r-package-to-explore-the-novel-coronavirus-590055738ad6?source=collection_archive---------7-----------------------#2020-02-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/></div><div class="ab cl jq jr hx js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="im in io ip iq"><p id="e31c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">冠状病毒(CoV)是一个大的病毒家族，可导致从普通感冒到更严重疾病的疾病，如中东呼吸综合征(MERS-CoV)和严重急性呼吸综合征(SARS-CoV)。一种新型冠状病毒(nCoV)是一种新的毒株，此前尚未在人类中发现。</p><p id="52b6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">最近发现南方医科大学生物信息学教授于广创的一篇博文，讲的是一个R包，里面包含了中国乃至全世界最新的nCov数据之一。在过去的几天里，我一直在把这个包从中文翻译成英文，以便让每个人都更容易理解。</p><p id="ee6d" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><em class="kv">*注:这篇博文是对于博士的原帖的尝试性英文翻译。我会在页面底部用中文链接他的博文。</em></p><h1 id="c246" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">第一部分—快速入门</h1><p id="3058" class="pw-post-body-paragraph jx jy it jz b ka lu kc kd ke lv kg kh ki lw kk kl km lx ko kp kq ly ks kt ku im bi translated">首先，您可以通过在R中运行以下命令来轻松安装:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="198c" class="mi kx it me b gy mj mk l ml mm">remotes::install_github("GuangchuangYu/nCov2019")</span></pre><p id="0734" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">要获取最新数据，可以用<code class="fe mn mo mp me b">get_nCov2019()</code>载入。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="b23a" class="mi kx it me b gy mj mk l ml mm"><strong class="me iu">library</strong>(nCov2019)<br/>x &lt;- get_nCov2019(lang='en')</span></pre><p id="2d0c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">确保您包含了参数<code class="fe mn mo mp me b">lang='en'</code>，否则，数据默认为中文(如果您能阅读中文，这没问题)。</p><p id="9cf8" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果打印数据，会显示中国确诊病例总数，以及最新更新时间:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="3fff" class="mi kx it me b gy mj mk l ml mm">&gt; x<br/>China (total confirmed cases): 40235<br/>last update: 2020-02-10 15:12:35</span></pre><p id="4e98" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><em class="kv">此数据收集自腾讯，at</em><a class="ae mq" href="https://news.qq.com/zt2020/page/feiyan.htm" rel="noopener ugc nofollow" target="_blank"><em class="kv">https://news.qq.com/zt2020/page/feiyan.htm</em></a><em class="kv">，包含冠状病毒的最新公开信息之一。</em></p><h2 id="d8e4" class="mi kx it bd ky mr ms dn lc mt mu dp lg ki mv mw lk km mx my lo kq mz na ls nb bi translated">全局数据</h2><p id="93ba" class="pw-post-body-paragraph jx jy it jz b ka lu kc kd ke lv kg kh ki lw kk kl km lx ko kp kq ly ks kt ku im bi translated">要查看全局数据，您可以运行代码<code class="fe mn mo mp me b">x['global', ]</code>:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="e84c" class="mi kx it me b gy mj mk l ml mm">&gt; x['global', ]<br/>                   name confirm suspect dead heal showRate deadRate healRate<br/>1                 China   40235   23589  909 3371    FALSE     2.26     8.38<br/>2                 Japan      96       0    0    1    FALSE     0.00     1.04<br/>3             Singapore      43       0    0    2    FALSE     0.00     4.65<br/>4              Thailand      32       0    0    8    FALSE     0.00    25.00<br/>5     Republic of Korea      27       0    0    3    FALSE     0.00    11.11<br/>6              Malaysia      18       0    0    3    FALSE     0.00    16.67<br/>7             Australia      15       0    0    5    FALSE     0.00    33.33<br/>8               Germany      14       0    0    0    FALSE     0.00     0.00<br/>9               Vietnam      14       0    0    3    FALSE     0.00    21.43<br/>10    United States USA      12       0    0    1    FALSE     0.00     8.33<br/>11               France      11       0    0    0    FALSE     0.00     0.00<br/>12               Canada       7       0    0    0    FALSE     0.00     0.00<br/>13 United Arab Emirates       7       0    0    0    FALSE     0.00     0.00<br/>14       United Kingdom       4       0    0    0    FALSE     0.00     0.00<br/>15                Italy       3       0    0    0    FALSE     0.00     0.00</span></pre><h2 id="6350" class="mi kx it bd ky mr ms dn lc mt mu dp lg ki mv mw lk km mx my lo kq mz na ls nb bi translated">中国省市数据</h2><p id="3d81" class="pw-post-body-paragraph jx jy it jz b ka lu kc kd ke lv kg kh ki lw kk kl km lx ko kp kq ly ks kt ku im bi translated">因为数据来源主要集中在中国，你有能力真正深入挖掘中国的案例。比如你有能力看到四川某个城市确诊病例数。</p><p id="f17f" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">通过<code class="fe mn mo mp me b">x[]</code>，您可以轻松查看中国各省的数据。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="624b" class="mi kx it me b gy mj mk l ml mm">&gt; x[]<br/>             name confirm suspect dead heal showRate deadRate healRate<br/>1           Hubei   29631       0  871 1795     TRUE     2.94     6.06<br/>2       Guangdong    1151       0    1  148    FALSE     0.09    12.86<br/>3        Zhejiang    1092       0    0  215    FALSE     0.00    19.69<br/>4           Henan    1073       0    6  181    FALSE     0.56    16.87<br/>5           Hunan     879       0    1  201    FALSE     0.11    22.87<br/>6           Anhui     830       0    3   89    FALSE     0.36    10.72<br/>7         Jiangxi     771       0    1  102    FALSE     0.13    13.23<br/>8         Jiangsu     492       0    0   80    FALSE     0.00    16.26<br/>9       Chongqing     468       0    2   61    FALSE     0.43    13.03<br/>10       Shandong     466       0    1   64    FALSE     0.21    13.73<br/>11        Sichuan     405       0    1   79    FALSE     0.25    19.51<br/>12        Beijing     337       0    2   44    FALSE     0.59    13.06<br/>13   Heilongjiang     331       0    7   20    FALSE     2.11     6.04<br/>14       Shanghai     299       0    1   48    FALSE     0.33    16.05<br/>15         Fujian     261       0    0   36    FALSE     0.00    13.79</span></pre><p id="1d3e" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果您想获得更精细的数据，您可以进入每个省，将数据分解到各个城市。例如，如果您想查看湖北省内的案例，您可以使用<code class="fe mn mo mp me b">x[1,]</code>或<code class="fe mn mo mp me b">x['Hubei',]</code>。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="6bfd" class="mi kx it me b gy mj mk l ml mm">&gt; x['Hubei', ] # replace Hubei with any province<br/>           name confirm suspect dead heal showRate deadRate healRate<br/>1         Wuhan   16902       0  681 1044     TRUE     4.03     6.18<br/>2       Xiaogan    2541       0   33   81     TRUE     1.30     3.19<br/>3     Huanggang    2252       0   45  189     TRUE     2.00     8.39<br/>4       Suizhou    1049       0   10   23     TRUE     0.95     2.19<br/>5      Jingzhou    1045       0   15   46     TRUE     1.44     4.40<br/>6     Xiangyang    1019       0    9   42     TRUE     0.88     4.12<br/>7      Huangshi     805       0    3   67     TRUE     0.37     8.32<br/>8       Yichang     749       0    8   43     TRUE     1.07     5.74<br/>9         Ezhou     725       0   24   48     TRUE     3.31     6.62<br/>10      Jingmen     641       0   20   63     TRUE     3.12     9.83<br/>11     Xianning     507       0    4   44     TRUE     0.79     8.68<br/>12       Shiyan     481       0    0   46     TRUE     0.00     9.56<br/>13      Xiantao     416       0    7   16     TRUE     1.68     3.85<br/>14      Tianmen     217       0   10   10     TRUE     4.61     4.61<br/>15        Enshi     187       0    0   24     TRUE     0.00    12.83</span></pre><p id="a403" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">当然，也可以将这些数据用于可视化。这里有一个安徽的例子。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="9a1e" class="mi kx it me b gy mj mk l ml mm">library(forcats)<br/>library(ggplot2)<br/>d = x['Anhui',] # replace Anhui with any province<br/>d$confirm=as.numeric(d$confirm)<br/>d$name = fct_reorder(d$name, d$confirm)</span><span id="9f92" class="mi kx it me b gy nc mk l ml mm">ggplot(d, aes(name, confirm)) + <br/>  geom_col(fill='steelblue') + coord_flip() +<br/>  geom_text(aes(y = confirm+2, label=confirm), hjust=0) +<br/>  theme_minimal(base_size=14) + <br/>  scale_y_continuous(expand=c(0,10)) +<br/>  xlab(NULL) + ylab(NULL)</span></pre><figure class="lz ma mb mc gt ne gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/c0aa22bedc189e0e08acb757ca0f82ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eiltdeS9svX5_IfMP92VoA.png"/></div></figure><h2 id="3d15" class="mi kx it bd ky mr ms dn lc mt mu dp lg ki mv mw lk km mx my lo kq mz na ls nb bi translated">每日数据</h2><p id="2478" class="pw-post-body-paragraph jx jy it jz b ka lu kc kd ke lv kg kh ki lw kk kl km lx ko kp kq ly ks kt ku im bi translated">您已经在上面看到了如何获得总的累积数据，但是如果您有兴趣查看新添加的案例的数量呢？一种方法是使用参数<code class="fe mn mo mp me b">by='today'</code>。要查看中国所有省份新增的数量，您可以运行以下命令:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="dd3c" class="mi kx it me b gy mj mk l ml mm">&gt; head(x[by='today'], 10)<br/>        name confirm suspect dead heal isUpdated<br/>1      Hubei    2618       0    0    0      TRUE<br/>2  Guangdong      31       0    0    0      TRUE<br/>3   Zhejiang      29       0    0    0      TRUE<br/>4      Henan      40       0    0    0      TRUE<br/>5      Hunan      41       0    0    0      TRUE<br/>6      Anhui      51       0    0    0      TRUE<br/>7    Jiangxi      32       0    0    0      TRUE<br/>8    Jiangsu      24       0    0    0      TRUE<br/>9  Chongqing      22       0    0    0      TRUE<br/>10  Shandong      31       0    0    0      TRUE</span></pre><p id="34e7" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">类似地，要获得更细粒度的视图，您可以通过运行以下命令来获得数据:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="9599" class="mi kx it me b gy mj mk l ml mm">&gt; x['Hubei', by='today'] # replace Hubei with any province<br/>           name confirm suspect dead heal isUpdated<br/>1         Wuhan    1921       0    0    0      TRUE<br/>2       Xiaogan     105       0    0    0      TRUE<br/>3     Huanggang     115       0    0    0      TRUE<br/>4       Suizhou      65       0    0    0      TRUE<br/>5      Jingzhou      48       0    0    0      TRUE<br/>6     Xiangyang      57       0    0    0      TRUE<br/>7      Huangshi      52       0    0    0      TRUE<br/>8       Yichang      45       0    0    0      TRUE<br/>9         Ezhou      89       0    0    0      TRUE<br/>10      Jingmen      12       0    0    0      TRUE<br/>11     Xianning      14       0    0    0      TRUE<br/>12       Shiyan      14       0    0    0      TRUE<br/>13      Xiantao      37       0    0    0      TRUE<br/>14      Tianmen      20       0    0    0      TRUE<br/>15        Enshi      21       0    0    0      TRUE<br/>16    Qianjiang       3       0    0    0      TRUE<br/>17  Shennongjia       0       0    0    0      TRUE<br/>18 Location TBD       0       0    0    0      TRUE</span></pre><p id="9b4a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><em class="kv">*注:第二部分中关于每日/历史数据的更多细节。</em></p><h2 id="ce1c" class="mi kx it bd ky mr ms dn lc mt mu dp lg ki mv mw lk km mx my lo kq mz na ls nb bi translated">每日数据摘要</h2><p id="2ad5" class="pw-post-body-paragraph jx jy it jz b ka lu kc kd ke lv kg kh ki lw kk kl km lx ko kp kq ly ks kt ku im bi translated">要获得每日数据的累积摘要，可以使用<code class="fe mn mo mp me b">x</code>上的<code class="fe mn mo mp me b">summary</code>函数。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="accc" class="mi kx it me b gy mj mk l ml mm">&gt; summary(x)<br/>   confirm suspect dead heal deadRate healRate  date<br/>1       41       0    1    0      2.4      0.0 01.13<br/>2       41       0    1    0      2.4      0.0 01.14<br/>3       41       0    2    5      4.9     12.2 01.15<br/>4       45       0    2    8      4.4     17.8 01.16<br/>5       62       0    2   12      3.2     19.4 01.17<br/>6      198       0    3   17      1.5      8.6 01.18<br/>7      275       0    4   18      1.5      6.5 01.19<br/>8      291      54    6   25      2.1      8.6 01.20<br/>9      440      37    9   25      2.0      5.7 01.21<br/>10     571     393   17   25      3.0      4.4 01.22<br/>11     830    1072   25   34      3.0      4.1 01.23<br/>12    1287    1965   41   38      3.2      3.0 01.24<br/>13    1975    2684   56   49      2.8      2.5 01.25<br/>14    2744    5794   80   51      2.9      1.9 01.26<br/>15    4515    6973  106   60      2.3      1.3 01.27</span></pre><p id="68fc" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">类似地，如果您想查看新的每日案例，您可以使用<code class="fe mn mo mp me b">today</code>参数:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="8b87" class="mi kx it me b gy mj mk l ml mm">&gt; summary(x, by="today")<br/>   confirm suspect dead heal deadRate healRate  date<br/>1       77      27    0    0      0.0      0.0 01.20<br/>2      149      53    3    0      2.0      0.0 01.21<br/>3      131     257    8    0      6.1      0.0 01.22<br/>4      259     680    8    6      3.1      2.3 01.23<br/>5      444    1118   16    3      3.6      0.7 01.24<br/>6      688    1309   15   11      2.2      1.6 01.25<br/>7      769    3806   24    2      3.1      0.3 01.26<br/>8     1771    2077   26    9      1.5      0.5 01.27<br/>9     1459    3248   26   43      1.8      2.9 01.28<br/>10    1737    4148   38   21      2.2      1.2 01.29<br/>11    1982    4812   43   47      2.2      2.4 01.30<br/>12    2102    5019   46   72      2.2      3.4 01.31<br/>13    2590    4562   45   85      1.7      3.3 02.01<br/>14    2829    5173   57  147      2.0      5.2 02.02<br/>15    3235    5072   64  157      2.0      4.9 02.03</span></pre><p id="9524" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果您想要可视化累积汇总数据，示例图如下:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="987a" class="mi kx it me b gy mj mk l ml mm">library(ggplot2)<br/>ggplot(summary(x), aes(as.Date(date, "%m.%d"), as.numeric(confirm))) +<br/>  geom_col(fill='firebrick') + theme_minimal(base_size = 14) +<br/>  xlab(NULL) + ylab(NULL) + <br/>  labs(caption = paste("accessed date:", time(x)))</span></pre><figure class="lz ma mb mc gt ne gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/e493084311b8ccb2bf7fafd60f401fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2cbmMcxqZLnI3htQfsV1WA.png"/></div></figure></div><div class="ab cl jq jr hx js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="im in io ip iq"><h1 id="6851" class="kw kx it bd ky kz nh lb lc ld ni lf lg lh nj lj lk ll nk ln lo lp nl lr ls lt bi translated">第二部分—历史数据</h1><p id="d73a" class="pw-post-body-paragraph jx jy it jz b ka lu kc kd ke lv kg kh ki lw kk kl km lx ko kp kq ly ks kt ku im bi translated">第一部分只能显示最新的数据，但大多数人真正关心的是每天的历史数据。</p><p id="d45a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><em class="kv">如果要分析一些详细的历史数据怎么办？不要害怕，</em> <code class="fe mn mo mp me b"><em class="kv">load_nCov2019()</em></code> <em class="kv">是来救援的。</em></p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="da04" class="mi kx it me b gy mj mk l ml mm">&gt; x &lt;- load_nCov2019(lang='en')<br/>&gt; x<br/>nCov2019 historical data <br/>last update: 2020-02-07</span></pre><p id="3b02" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">同样，如果你想使用中文版本，你可以删除<code class="fe mn mo mp me b">lang='en'</code>的说法。</p><p id="9e94" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">注:该数据仅包含中国的病例。不幸的是，您将无法获得全球历史数据。</p><h2 id="8633" class="mi kx it bd ky mr ms dn lc mt mu dp lg ki mv mw lk km mx my lo kq mz na ls nb bi translated">中国的历史数据</h2><p id="a80d" class="pw-post-body-paragraph jx jy it jz b ka lu kc kd ke lv kg kh ki lw kk kl km lx ko kp kq ly ks kt ku im bi translated">使用与<code class="fe mn mo mp me b">get_nCov2019()</code>相同的方法，我们可以使用<code class="fe mn mo mp me b">[</code>查询所有省级明细数据。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="13d5" class="mi kx it me b gy mj mk l ml mm">&gt; head(x[][c(1:6, 9:11)])<br/>  province          city       time cum_confirm cum_heal cum_dead confirm dead heal<br/>1 Shanghai      Shanghai 2020-02-08         292       41        1           NA     <br/>2   Yunnan        Yunnan 2020-02-08         140       17        0           NA     <br/>3   Yunnan       Kunming 2020-02-08          41        6        0           NA     <br/>4   Yunnan Xishuangbanna 2020-02-08          15        2        0           NA     <br/>5   Yunnan          Yuxi 2020-02-08          14        2        0           NA     <br/>6   Yunnan      Zhaotong 2020-02-08          12        1        0           NA</span></pre><p id="ee6a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我们可以只选择累积的和新添加的数据。相关列是<code class="fe mn mo mp me b">province, city, time, cum_confirm, cum_heal, cum_dead, confirm, dead, heal</code>，所以<code class="fe mn mo mp me b">x['Hubei', c(1:6,9:11)]</code>就足够了。</p><h2 id="761f" class="mi kx it bd ky mr ms dn lc mt mu dp lg ki mv mw lk km mx my lo kq mz na ls nb bi translated">中国各省市的详细信息</h2><p id="58dc" class="pw-post-body-paragraph jx jy it jz b ka lu kc kd ke lv kg kh ki lw kk kl km lx ko kp kq ly ks kt ku im bi translated">与上面类似，如果您想更深入地获取特定于省份的数据，那么您只需要包括省份名称:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="e255" class="mi kx it me b gy mj mk l ml mm">&gt; head(x['Hubei', c(1:6, 9:11)]) # replace Hubei with any province<br/>    province      city       time cum_confirm cum_heal cum_dead confirm dead heal<br/>250    Hubei     Wuhan 2020-02-08       14982      877      608           NA     <br/>251    Hubei   Xiaogan 2020-02-08        2436       45       29           NA     <br/>252    Hubei Huanggang 2020-02-08        2141      137       43           NA     <br/>253    Hubei  Jingzhou 2020-02-08         997       34       13           NA     <br/>254    Hubei Xiangyang 2020-02-08         988       40        7           NA     <br/>255    Hubei   Suizhou 2020-02-08         984       23        9           NA</span></pre><p id="4c04" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果您想更深入地挖掘特定于城市的数据，那么您可以在省内指定一个<code class="fe mn mo mp me b">city</code>。例如，如果您想查看武汉的数据，您可以执行以下操作:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="1ecf" class="mi kx it me b gy mj mk l ml mm">&gt; head(subset(x['Hubei',], city == "Wuhan"))[c(1:6, 9:11)]<br/>     province  city       time cum_confirm cum_heal cum_dead confirm dead heal<br/>250     Hubei Wuhan 2020-02-08       14982      877      608           NA     <br/>612     Hubei Wuhan 2020-02-07       13603      698      545           NA     <br/>972     Hubei Wuhan 2020-02-06       11618      535      478           NA     <br/>1084    Hubei Wuhan 2020-02-05       10117      432      414           NA     <br/>1464    Hubei Wuhan 2020-02-04        8351      369      362    1967   49   65<br/>1976    Hubei Wuhan 2020-02-03        6384      303      313    1242   48   79</span></pre><p id="c1b6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">然后，您可以将这些数据用于可视化。例如:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="a43c" class="mi kx it me b gy mj mk l ml mm">library(ggplot2)<br/>require(ggrepel)</span><span id="f4d7" class="mi kx it me b gy nc mk l ml mm">d &lt;- x['Anhui',] # replace Anhui with any province</span><span id="3b61" class="mi kx it me b gy nc mk l ml mm">ggplot(d, aes(time, as.numeric(cum_confirm), group=city, color=city)) +<br/>  geom_point() + geom_line() +<br/>  geom_text_repel(aes(label=city), data=d[d$time == time(x), ], hjust=1) +<br/>  theme_minimal(base_size = 14) + theme(legend.position='none') +<br/>  xlab(NULL) + ylab(NULL)</span></pre><figure class="lz ma mb mc gt ne gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/35ef289c570a1aef0c23c3ca20ccf92b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V-LZhA3aWprvOPgUbAKrEA.png"/></div></figure><h2 id="0aee" class="mi kx it bd ky mr ms dn lc mt mu dp lg ki mv mw lk km mx my lo kq mz na ls nb bi translated">中国的汇总结果</h2><p id="046f" class="pw-post-body-paragraph jx jy it jz b ka lu kc kd ke lv kg kh ki lw kk kl km lx ko kp kq ly ks kt ku im bi translated">与<code class="fe mn mo mp me b">get_nCov2019()</code>类似，您也可以对数据调用<code class="fe mn mo mp me b">summary()</code>函数。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="7190" class="mi kx it me b gy mj mk l ml mm">&gt; head(summary(x)[,1:5])<br/>         province       time cum_confirm cum_heal cum_dead<br/>1        Shanghai 2020-02-07         281       30        1<br/>2          Yunnan 2020-02-07         138       12        0<br/>17 Inner Mongolia 2020-02-07          52        5        0<br/>29        Beijing 2020-02-07         315       34        2<br/>30         Taiwan 2020-02-07          16        1        0<br/>31          Jilin 2020-02-07          69        4        1</span></pre><p id="0f12" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果您想查看特定省份的汇总，您只需将省份名称添加到<code class="fe mn mo mp me b">summary</code>中，如下所示:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="aef0" class="mi kx it me b gy mj mk l ml mm">&gt; summary(x, 'Hubei')[,1:5]<br/>     province       time cum_confirm cum_heal cum_dead<br/>251     Hubei 2020-02-07       24953     1119      699<br/>611     Hubei 2020-02-06       22112      818      618<br/>723     Hubei 2020-02-05       19665      651      549<br/>1103    Hubei 2020-02-04       16678      520      479<br/>1615    Hubei 2020-02-03       13522      396      414<br/>1792    Hubei 2020-02-02       11177      295      350<br/>2325    Hubei 2020-02-01        9074      215      294<br/>2482    Hubei 2020-01-31        7153      166      249<br/>2820    Hubei 2020-01-30        5806      116      204<br/>3452    Hubei 2020-01-29        4586       90      162<br/>3673    Hubei 2020-01-28        3554       80      125<br/>3803    Hubei 2020-01-27        2714       47      100<br/>4225    Hubei 2020-01-26        1423       44       76<br/>4488    Hubei 2020-01-25        1052       42       52<br/>4710    Hubei 2020-01-24         729       32       39</span></pre><p id="4af2" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这是另一个快速可视化的例子:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="9ca4" class="mi kx it me b gy mj mk l ml mm">ggplot(summary(x, 'Hubei'), aes(time, as.numeric(cum_confirm))) +<br/>  geom_col()</span><span id="13a6" class="mi kx it me b gy nc mk l ml mm"># or city-specific<br/># ggplot(subset(x['Hubei',], city == "Huanggang"), aes(time, as.numeric(cum_confirm))) + geom_col()</span></pre><figure class="lz ma mb mc gt ne gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/8c3995b4813b7ac621fcddf0244b1e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gsJmEUkeNObjfTQ38BKl_w.png"/></div></figure><h1 id="6819" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">第三部分—地图绘制</h1><h2 id="afd5" class="mi kx it bd ky mr ms dn lc mt mu dp lg ki mv mw lk km mx my lo kq mz na ls nb bi translated">世界地图</h2><p id="62dd" class="pw-post-body-paragraph jx jy it jz b ka lu kc kd ke lv kg kh ki lw kk kl km lx ko kp kq ly ks kt ku im bi translated">得到世界地图的一个情节真的很简单。只需要三行代码:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="8ca1" class="mi kx it me b gy mj mk l ml mm">require(nCov2019)<br/>x = get_nCov2019(lang='en')<br/>plot(x)</span></pre><figure class="lz ma mb mc gt ne gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/a729bc352a1ca6ef5c5bc353e0586f08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fMJxXzzPI_NPN1-LAukw2g.png"/></div></figure><p id="4206" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如你所见，与其他地方相比，中国确诊病例的数量高得吓人。你现在可能会想，有没有一种方法可以分解中国的案例？当然可以，但是你必须先安装<code class="fe mn mo mp me b">chinamap</code>，才能得到中国地图。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="81c9" class="mi kx it me b gy mj mk l ml mm">remotes::install_github("GuangchuangYu/chinamap")</span></pre><p id="6597" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">安装后，您可以运行以下代码来查看中国各地的确诊病例。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="b7c0" class="mi kx it me b gy mj mk l ml mm">require(chinamap)</span><span id="9576" class="mi kx it me b gy nc mk l ml mm">cn = get_map_china()<br/>## translate province <br/>cn$province &lt;- trans_province(cn$province)</span><span id="6b73" class="mi kx it me b gy nc mk l ml mm">plot(x, chinamap=cn)</span></pre><p id="0758" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><em class="kv">*注意:为了给中国着色，省份必须如上翻译。</em></p><figure class="lz ma mb mc gt ne gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/96b2246047060bb96d41b141bc7b899d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yMvrvD7FxEZnMfGL1xHYxA.png"/></div></figure><p id="d18a" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果红色不适合你，你可以使用<code class="fe mn mo mp me b">palette</code>参数随意改变它:</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="41b7" class="mi kx it me b gy mj mk l ml mm">plot(x, chinamap=cn, palette="Purples")</span></pre><figure class="lz ma mb mc gt ne gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/c3c9d04bac0e80bd0af1fe14d14745c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JDDisfmRcv2vG6kel5MAOg.png"/></div></figure><h2 id="6102" class="mi kx it bd ky mr ms dn lc mt mu dp lg ki mv mw lk km mx my lo kq mz na ls nb bi translated">中国地图</h2><p id="734e" class="pw-post-body-paragraph jx jy it jz b ka lu kc kd ke lv kg kh ki lw kk kl km lx ko kp kq ly ks kt ku im bi translated">为了更好地了解中国的情况，你可以在情节中添加一个<code class="fe mn mo mp me b">region = ‘china'</code>参数。我建议使用<code class="fe mn mo mp me b">font.size=2</code>,这样省的文本就不会太大。</p><pre class="lz ma mb mc gt md me mf mg aw mh bi"><span id="d0b7" class="mi kx it me b gy mj mk l ml mm">plot(x, region='china', chinamap=cn, font.size=2)</span></pre><figure class="lz ma mb mc gt ne gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/fc5dabbbf2821692bba7da822d802373.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gtw0VPUKYfORM7xVFVlnrQ.png"/></div></figure></div><div class="ab cl jq jr hx js" role="separator"><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv jw"/><span class="jt bw bk ju jv"/></div><div class="im in io ip iq"><p id="fb63" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果到目前为止你已经看完了所有的内容，非常感谢！这是我的第一篇博客，但绝对不是最后一篇。如果你正在寻找余博士的中文帖子，我会在本页底部链接它们。</p><p id="9663" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">任何评论、问题或总体反馈总是。请随时通过我的<a class="ae mq" href="https://www.linkedin.com/in/patricktung/" rel="noopener ugc nofollow" target="_blank"><em class="kv">LinkedIn</em></a><em class="kv">联系我。</em></p><p id="b6a6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi"><em class="kv">Thank you Dr. Yu for the package, as well as allowing me to contribute. And special thanks to Tencent and 新一线城市研究所×8点健闻 for making the data available in the first place.</em></p><h2 id="7bdc" class="mi kx it bd ky mr ms dn lc mt mu dp lg ki mv mw lk km mx my lo kq mz na ls nb bi translated">于博士文章的链接:</h2><ul class=""><li id="f5d0" class="nm nn it jz b ka lu ke lv ki no km np kq nq ku nr ns nt nu bi"><a class="ae mq" href="https://mp.weixin.qq.com/s/_0D8ENb-4lGm4UV16Ok28A" rel="noopener ugc nofollow" target="_blank">检索疫情数据的R包来了！</a></li><li id="03e5" class="nm nn it jz b ka nv ke nw ki nx km ny kq nz ku nr ns nt nu bi"><a class="ae mq" href="https://mp.weixin.qq.com/s/lrQWGKj-mReWrxfi_4Sw9A" rel="noopener ugc nofollow" target="_blank">各省市的疫情历史数据来了！</a></li><li id="0356" class="nm nn it jz b ka nv ke nw ki nx km ny kq nz ku nr ns nt nu bi"><a class="ae mq" href="https://mp.weixin.qq.com/s/bPXdOGFzFK5dWLTEOEJB3g" rel="noopener ugc nofollow" target="_blank">疫情地图全搞定，小白都会画！</a></li></ul></div></div>    
</body>
</html>