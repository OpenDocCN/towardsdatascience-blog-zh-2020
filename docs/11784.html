<html>
<head>
<title>Clustering Using Convex Hulls</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨å‡¸åŒ…çš„èšç±»</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/clustering-using-convex-hulls-fddafeaa963c?source=collection_archive---------17-----------------------#2020-08-15">https://towardsdatascience.com/clustering-using-convex-hulls-fddafeaa963c?source=collection_archive---------17-----------------------#2020-08-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b403" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">å¦‚ä½•åœ¨æ•°æ®èšç±»ä¸­ä½¿ç”¨å‡¸åŒ…</h2></div><p id="0634" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æœ€è¿‘åœ¨<a class="ae le" href="https://www.sciencedirect.com/science/journal/01678655" rel="noopener ugc nofollow" target="_blank">æ¨¡å¼è¯†åˆ«å¿«æŠ¥</a>å¶ç„¶çœ‹åˆ°å“ˆåÂ·åˆ‡ç»´å¡æ™®çš„æ–‡ç« ã€Šåˆ©ç”¨å±€éƒ¨ä»¿å°„/å‡¸åŒ… è¿›è¡Œé«˜ç»´æ•°æ®èšç±»ã€‹ã€‚æå‡ºäº†ä¸€ç§åˆ©ç”¨å±€éƒ¨ä»¿å°„/å‡¸åŒ…å¯¹é«˜ç»´æ•°æ®è¿›è¡Œèšç±»çš„æ–°ç®—æ³•ã€‚ä»–ä»¬ä½¿ç”¨å‡¸åŒ…è¿›è¡Œèšç±»çš„æ–¹æ³•å¯å‘äº†æˆ‘ã€‚æˆ‘æƒ³å°è¯•ä½¿ç”¨å‡¸åŒ…å®ç°æˆ‘è‡ªå·±çš„ç®€å•èšç±»æ–¹æ³•ã€‚å› æ­¤ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å‘æ‚¨ä»‹ç»æˆ‘ä½¿ç”¨å‡¸åŒ…å®ç°èšç±»æ–¹æ³•çš„è¿‡ç¨‹ã€‚åœ¨æˆ‘ä»¬è¿›å…¥ç¼–ç ä¹‹å‰ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä»€ä¹ˆæ˜¯å‡¸åŒ…ã€‚</p><h1 id="cb9c" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">å‡¸åŒ…</h1><p id="5337" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">æ ¹æ®<a class="ae le" href="https://en.wikipedia.org/wiki/Convex_hull" rel="noopener ugc nofollow" target="_blank">ç»´åŸºç™¾ç§‘</a>ï¼Œå‡¸åŒ…å®šä¹‰å¦‚ä¸‹ã€‚</p><blockquote class="mc"><p id="b9de" class="md me it bd mf mg mh mi mj mk ml ld dk translated">åœ¨å‡ ä½•å­¦ä¸­ï¼Œä¸€ä¸ªå½¢çŠ¶çš„å‡¸åŒ…æˆ–å‡¸åŒ…ç»œæˆ–å‡¸é—­åŒ…æ˜¯åŒ…å«å®ƒçš„æœ€å°å‡¸é›†ã€‚</p></blockquote><figure class="mn mo mp mq mr ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mm"><img src="../Images/7a82e2d9536323fdfa4c331ef0d8e194.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rk8DDgeMACxJSXtdFs0ysg.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">å›¾ä¸€ã€‚ä¸€ç»„é’‰å­çš„å‡¸åŒ…(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><p id="3bdb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªç®€å•ç±»æ¯”çš„ä¾‹å­ã€‚å¦‚å›¾ 1 æ‰€ç¤ºï¼Œå‡è®¾æœ‰å‡ ä¸ªé’‰å­è¢«é’‰åœ¨æœ¨æ¿çš„ä¸­é—´ã€‚ä½ æ‹¿ä¸€æ ¹æ©¡çš®ç­‹ï¼ŒæŠŠå®ƒæ‹‰é•¿åŒ…ä½é’‰å­ï¼Œç„¶åæ”¾å¼€å®ƒã€‚å®ƒå°†é€‚åˆæœ€å¤–é¢çš„æŒ‡ç”²(æ˜¾ç¤ºä¸ºè“è‰²)ï¼Œå¹¶é‡‡å–æœ€å°åŒ–å…¶é•¿åº¦çš„å½¢çŠ¶ã€‚è¢«æ©¡çš®ç­‹å›´èµ·æ¥çš„åŒºåŸŸå«åšè¿™ç»„é’‰å­çš„<strong class="kk iu">å‡¸åŒ…</strong>ã€‚</p><p id="4f4e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™ä¸ªäºŒç»´ç©ºé—´ä¸­çš„å‡¸åŒ…(å¦‚å›¾ 1 æ‰€ç¤º)å°†æ˜¯ä¸€ä¸ª<em class="nd">å‡¸å¤šè¾¹å½¢</em>ï¼Œå…¶æ‰€æœ‰å†…è§’éƒ½å°äº 180Â°ã€‚å¦‚æœæ˜¯åœ¨ 3 ç»´æˆ–è€…æ›´é«˜ç»´çš„ç©ºé—´ï¼Œé‚£ä¹ˆå‡¸åŒ…ä¼šæ˜¯ä¸€ä¸ª<em class="nd">å¤šé¢ä½“</em>ã€‚</p><p id="dde1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æœ‰å‡ ç§ç®—æ³•å¯ä»¥ç¡®å®šç»™å®šç‚¹é›†çš„å‡¸åŒ…ã€‚ä¸€äº›è‘—åçš„ç®—æ³•æ˜¯<a class="ae le" href="https://en.wikipedia.org/wiki/Gift_wrapping_algorithm" rel="noopener ugc nofollow" target="_blank">ç¤¼å“åŒ…è£…ç®—æ³•</a>å’Œ<a class="ae le" href="https://en.wikipedia.org/wiki/Graham_scan" rel="noopener ugc nofollow" target="_blank">æ ¼é›·å„å§†æ‰«æç®—æ³•</a>ã€‚</p><p id="40fc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç”±äºå‡¸åŒ…åŒ…å›´äº†ä¸€ç»„ç‚¹ï¼Œæ‰€ä»¥å®ƒå¯ä»¥å……å½“èšç±»è¾¹ç•Œï¼Œå…è®¸æˆ‘ä»¬ç¡®å®šèšç±»ä¸­çš„ç‚¹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å‡¸åŒ…å’Œæ‰§è¡Œèšç±»ã€‚è®©æˆ‘ä»¬è¿›å…¥ä»£ç ã€‚</p><h1 id="dba7" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">ç®€å•çš„ä¾‹å­</h1><p id="a754" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨ Pythonã€‚åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä»¥ä¸‹ Python åº“ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="176a" class="nn lg it nj b gy no np l nq nr">sklearn<br/>numpy<br/>matplotlib<br/>mpl_toolkits<br/>itertools<br/>scipy<br/>quadprog</span></pre><h2 id="f9e3" class="nn lg it bd lh ns nt dn ll nu nv dp lp kr nw nx lr kv ny nz lt kz oa ob lv oc bi translated">èµ„æ–™ç»„</h2><p id="5c25" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">ä¸ºäº†åˆ›å»ºæˆ‘ä»¬çš„æ ·æœ¬æ•°æ®é›†ï¼Œæˆ‘å°†ä½¿ç”¨<strong class="kk iu"> sci-kit learn </strong>åº“çš„<strong class="kk iu"> make blobs </strong>å‡½æ•°ã€‚æˆ‘å°†åˆ¶ä½œ 3 ä¸ªé›†ç¾¤ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="534e" class="nn lg it nj b gy no np l nq nr">import numpy as np<br/>from sklearn.datasets import make_blobs</span><span id="feee" class="nn lg it nj b gy od np l nq nr">centers = [[0, 1, 0], [1.5, 1.5, 1], [1, 1, 1]]<br/>stds = [0.13, 0.12, 0.12]</span><span id="d364" class="nn lg it nj b gy od np l nq nr">X, labels_true = make_blobs(n_samples=1000, centers=centers, cluster_std=stds, random_state=0)<br/>point_indices = np.arange(1000)</span></pre><p id="11da" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç”±äºè¿™æ˜¯ä¸€ä¸ªä¸‰ç»´ç‚¹æ•°æ®é›†ï¼Œæˆ‘å°†ç»˜åˆ¶ä¸€ä¸ª 3D å›¾æ¥æ˜¾ç¤ºæˆ‘ä»¬çš„åœ°é¢çœŸå®é›†ç¾¤ã€‚å›¾ 2 æ˜¾ç¤ºäº†å¸¦æœ‰å½©è‰²èšç±»çš„æ•°æ®é›†çš„æ•£ç‚¹å›¾ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="18f6" class="nn lg it nj b gy no np l nq nr">import matplotlib.pyplot as plt<br/>from mpl_toolkits.mplot3d import Axes3D</span><span id="ab78" class="nn lg it nj b gy od np l nq nr">x = X[:,0]<br/>y = X[:,1] <br/>z = X[:,2]<br/><br/># Creating figure <br/>fig = plt.figure(figsize = (15, 10)) <br/>ax = plt.axes(projection ="3d") <br/>    <br/># Add gridlines  <br/>ax.grid(b = True, color ='grey',  <br/>        linestyle ='-.', linewidth = 0.3,  <br/>        alpha = 0.2)  <br/>  <br/>mycolours = ["red", "green", "blue"]</span><span id="d680" class="nn lg it nj b gy od np l nq nr"># Creating color map <br/>col = [mycolours[i] for i in labels_true]</span><span id="8ddc" class="nn lg it nj b gy od np l nq nr"># Creating plot <br/>sctt = ax.scatter3D(x, y, z, c = col, marker ='o')</span><span id="1614" class="nn lg it nj b gy od np l nq nr">plt.title("3D scatter plot of the data\n") <br/>ax.set_xlabel('X-axis', fontweight ='bold')  <br/>ax.set_ylabel('Y-axis', fontweight ='bold')  <br/>ax.set_zlabel('Z-axis', fontweight ='bold')<br/>  <br/># show plot <br/>plt.draw()</span></pre><figure class="ne nf ng nh gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi oe"><img src="../Images/00e0d00c1b2f23482db81f742a73eab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*woTl_QjdCRfv2odzEyZwCg.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">å›¾äºŒã€‚æ•°æ®é›†çš„åˆå§‹æ•£ç‚¹å›¾(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><h2 id="f421" class="nn lg it bd lh ns nt dn ll nu nv dp lp kr nw nx lr kv ny nz lt kz oa ob lv oc bi translated">è·å¾—åˆå§‹èšç±»</h2><p id="a8e5" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†æ•°æ®é›†åˆ†æˆä¸¤éƒ¨åˆ†ã€‚ä¸€éƒ¨åˆ†å°†è¢«ç”¨ä½œç§å­ï¼Œä»¥ä½¿ç”¨ K-means è·å¾—åˆå§‹èšç±»ã€‚å¦ä¸€éƒ¨åˆ†ä¸­çš„ç‚¹å°†è¢«åˆ†é…ç»™åŸºäºåˆå§‹èšç±»çš„èšç±»ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="d051" class="nn lg it nj b gy no np l nq nr">from sklearn.model_selection import train_test_split</span><span id="2ef4" class="nn lg it nj b gy od np l nq nr">X_seeds, X_rest, y_seeds, y_rest, id_seeds, id_rest = train_test_split(X, labels_true, point_indices, test_size=0.33, random_state=42)</span></pre><p id="75e8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å¯¹ç§å­ç‚¹æ‰§è¡Œ K å‡å€¼èšç±»ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="0c42" class="nn lg it nj b gy no np l nq nr">from sklearn.cluster import KMeans</span><span id="db2f" class="nn lg it nj b gy od np l nq nr">kmeans = KMeans(n_clusters=3, random_state=9).fit(X_seeds)<br/>initial_result = kmeans.labels_</span></pre><p id="1215" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç”±äºç”Ÿæˆçš„æ ‡ç­¾å¯èƒ½ä¸åœ°é¢çœŸå®æ ‡ç­¾ä¸åŒï¼Œæˆ‘ä»¬å¿…é¡»æ˜ å°„è¿™ä¸¤ç»„æ ‡ç­¾ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‡½æ•°ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="806a" class="nn lg it nj b gy no np l nq nr">from itertools import permutations</span><span id="bbc4" class="nn lg it nj b gy od np l nq nr"># Source: <a class="ae le" href="https://stackoverflow.com/questions/11683785/how-can-i-match-up-cluster-labels-to-my-ground-truth-labels-in-matlab" rel="noopener ugc nofollow" target="_blank">https://stackoverflow.com/questions/11683785/how-can-i-match-up-cluster-labels-to-my-ground-truth-labels-in-matlab</a></span><span id="492f" class="nn lg it nj b gy od np l nq nr">def remap_labels(pred_labels, true_labels):</span><span id="0637" class="nn lg it nj b gy od np l nq nr">    pred_labels, true_labels = np.array(pred_labels), np.array(true_labels)<br/>    assert pred_labels.ndim == 1 == true_labels.ndim<br/>    assert len(pred_labels) == len(true_labels)<br/>    cluster_names = np.unique(pred_labels)<br/>    accuracy = 0</span><span id="3729" class="nn lg it nj b gy od np l nq nr">    perms = np.array(list(permutations(np.unique(true_labels))))</span><span id="0949" class="nn lg it nj b gy od np l nq nr">    remapped_labels = true_labels</span><span id="4424" class="nn lg it nj b gy od np l nq nr">    for perm in perms:</span><span id="0827" class="nn lg it nj b gy od np l nq nr">        flipped_labels = np.zeros(len(true_labels))<br/>        for label_index, label in enumerate(cluster_names):<br/>            flipped_labels[pred_labels == label] = perm[label_index]</span><span id="c002" class="nn lg it nj b gy od np l nq nr">        testAcc = np.sum(flipped_labels == true_labels) / len(true_labels)</span><span id="d1e4" class="nn lg it nj b gy od np l nq nr">        if testAcc &gt; accuracy:<br/>            accuracy = testAcc<br/>            remapped_labels = flipped_labels</span><span id="afa8" class="nn lg it nj b gy od np l nq nr">    return accuracy, remapped_labels</span></pre><p id="cf15" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å¯ä»¥ä»ä¸Šé¢çš„å‡½æ•°ä¸­å¾—åˆ°ç²¾åº¦å’Œæ˜ å°„çš„åˆå§‹æ ‡ç­¾ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="f3e0" class="nn lg it nj b gy no np l nq nr">intial_accuracy, remapped_initial_result = remap_labels(initial_result, y_seeds)</span></pre><p id="5311" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å›¾ 3 è¡¨ç¤ºç§å­ç‚¹çš„åˆå§‹èšç±»ã€‚</p><figure class="ne nf ng nh gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi oe"><img src="../Images/8f856a85e791e8d02b9383d5f3dcf98b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uaQEBEUnxfWc6P57P0OzUQ.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">å›¾ä¸‰ã€‚ä½¿ç”¨ K-means å¯¹ç§å­ç‚¹è¿›è¡Œåˆå§‹èšç±»(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><h2 id="57b9" class="nn lg it bd lh ns nt dn ll nu nv dp lp kr nw nx lr kv ny nz lt kz oa ob lv oc bi translated">å¾—åˆ°åˆå§‹èšç±»çš„å‡¸åŒ…</h2><p id="4b86" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">ä¸€æ—¦æˆ‘ä»¬è·å¾—äº†åˆå§‹èšç±»ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°æ¯ä¸ªèšç±»çš„å‡¸åŒ…ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»è·å¾—èšç±»ä¸­æ¯ä¸ªæ•°æ®ç‚¹çš„ç´¢å¼•ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="ef22" class="nn lg it nj b gy no np l nq nr"># Get the idices of the data points belonging to each cluster<br/>indices = {}</span><span id="bf04" class="nn lg it nj b gy od np l nq nr">for i in range(len(id_seeds)):<br/>    if int(remapped_initial_result[i]) not in indices:<br/>        indices[int(remapped_initial_result[i])] = [i]<br/>    else:<br/>        indices[int(remapped_initial_result[i])].append(i)</span></pre><p id="26a8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥ä»æ¯ä¸ªé›†ç¾¤ä¸­è·å¾—å‡¸åŒ…ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="5198" class="nn lg it nj b gy no np l nq nr">from scipy.spatial import ConvexHull</span><span id="af7c" class="nn lg it nj b gy od np l nq nr"># Get convex hulls for each cluster<br/>hulls = {}</span><span id="9699" class="nn lg it nj b gy od np l nq nr">for i in indices:<br/>    hull = ConvexHull(X_seeds[indices[i]])<br/>    hulls[i] = hull</span></pre><p id="b660" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å›¾ 4 è¡¨ç¤ºä»£è¡¨ 3 ä¸ªèšç±»ä¸­çš„æ¯ä¸€ä¸ªçš„å‡¸åŒ…ã€‚</p><figure class="ne nf ng nh gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi oe"><img src="../Images/f64730017fde56f9d0731d6526367f9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_GsDEJwOqqbuGxeViZU8Qw.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">å›¾ 4ã€‚æ¯ä¸ªèšç±»çš„å‡¸åŒ…(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><h2 id="8d1e" class="nn lg it bd lh ns nt dn ll nu nv dp lp kr nw nx lr kv ny nz lt kz oa ob lv oc bi translated">å°†å‰©ä½™çš„ç‚¹åˆ†é…ç»™æœ€è¿‘çš„å‡¸åŒ…ç°‡</h2><p id="0173" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†åˆå§‹èšç±»çš„å‡¸åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥å°†å‰©ä½™çš„ç‚¹åˆ†é…ç»™æœ€è¿‘çš„å‡¸åŒ…çš„èšç±»ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»å°†æ•°æ®ç‚¹æŠ•å½±åˆ°ä¸€ä¸ªå‡¸åŒ…ä¸Šã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‡½æ•°ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="f5c3" class="nn lg it nj b gy no np l nq nr">from quadprog import solve_qp</span><span id="12f5" class="nn lg it nj b gy od np l nq nr"># Source: <a class="ae le" href="https://stackoverflow.com/questions/42248202/find-the-projection-of-a-point-on-the-convex-hull-with-scipy" rel="noopener ugc nofollow" target="_blank">https://stackoverflow.com/questions/42248202/find-the-projection-of-a-point-on-the-convex-hull-with-scipy</a></span><span id="0941" class="nn lg it nj b gy od np l nq nr">def proj2hull(z, equations):</span><span id="dc58" class="nn lg it nj b gy od np l nq nr">    G = np.eye(len(z), dtype=float)<br/>    a = np.array(z, dtype=float)<br/>    C = np.array(-equations[:, :-1], dtype=float)<br/>    b = np.array(equations[:, -1], dtype=float)</span><span id="6c9c" class="nn lg it nj b gy od np l nq nr">    x, f, xu, itr, lag, act = solve_qp(G, a, C.T, b, meq=0, factorized=True)</span><span id="cd66" class="nn lg it nj b gy od np l nq nr">    return x</span></pre><p id="97d3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¯»æ‰¾å‡¸å£³ä¸Šçš„ç‚¹çš„æŠ•å½±çš„é—®é¢˜å¯ä»¥ä½¿ç”¨äºŒæ¬¡è§„åˆ’æ¥è§£å†³ã€‚ä¸Šè¿°åŠŸèƒ½åˆ©ç”¨äº†<code class="fe of og oh nj b">quadprog</code>æ¨¡å—ã€‚æ‚¨å¯ä»¥ä½¿ç”¨<code class="fe of og oh nj b"><a class="ae le" href="https://anaconda.org/omnia/quadprog" rel="noopener ugc nofollow" target="_blank">conda</a></code>æˆ–<code class="fe of og oh nj b"><a class="ae le" href="https://pypi.org/project/quadprog/" rel="noopener ugc nofollow" target="_blank">pip</a></code>å®‰è£…<code class="fe of og oh nj b">quadprog</code>æ¨¡å—ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="1f2d" class="nn lg it nj b gy no np l nq nr">conda install -c omnia quadprog<br/>OR<br/>pip install quadprog</span></pre><p id="f355" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å…³äºå¦‚ä½•ç”¨äºŒæ¬¡è§„åˆ’è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘å°±ä¸èµ˜è¿°äº†ã€‚å¦‚æœä½ æœ‰å…´è¶£ï¼Œä½ å¯ä»¥é˜…è¯»æ›´å¤šæ¥è‡ª<a class="ae le" href="https://stackoverflow.com/questions/42248202/find-the-projection-of-a-point-on-the-convex-hull-with-scipy" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>å’Œ<a class="ae le" href="https://math.stackexchange.com/questions/2146961/find-a-point-on-the-convex-hull-of-a-given-set-of-points-which-is-closest-to-a-g/2153051#2153051" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>ã€‚</p><figure class="ne nf ng nh gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi oi"><img src="../Images/47e95b089e9cc8b17bce7d4259159509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4RGFsuR9XYdgNX3cji-UA.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">å›¾äº”ã€‚ä»ä¸€ä¸ªç‚¹åˆ°å®ƒåœ¨å‡¸åŒ…ä¸Šçš„æŠ•å½±çš„è·ç¦»(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><p id="8e6a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä¸€æ—¦è·å¾—äº†å‡¸åŒ…ä¸Šçš„æŠ•å½±ï¼Œå°±å¯ä»¥è®¡ç®—ä»è¯¥ç‚¹åˆ°å‡¸åŒ…çš„è·ç¦»ï¼Œå¦‚å›¾ 5 æ‰€ç¤ºã€‚åŸºäºè¿™ä¸ªè·ç¦»ï¼Œç°åœ¨è®©æˆ‘ä»¬å°†å‰©ä½™çš„æ•°æ®ç‚¹åˆ†é…ç»™æœ€è¿‘çš„å‡¸åŒ…çš„ç°‡ã€‚</p><p id="203e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘å°†è€ƒè™‘ä»æ•°æ®ç‚¹åˆ°å®ƒåœ¨å‡¸åŒ…ä¸Šçš„æŠ•å½±çš„æ¬§å‡ é‡Œå¾·è·ç¦»ã€‚é‚£ä¹ˆè¯¥æ•°æ®ç‚¹å°†è¢«åˆ†é…åˆ°å…·æœ‰è·ç¦»è¯¥æ•°æ®ç‚¹æœ€çŸ­è·ç¦»çš„å‡¸åŒ…çš„èšç±»ä¸­ã€‚å¦‚æœä¸€ä¸ªç‚¹ä½äºå‡¸åŒ…å†…ï¼Œé‚£ä¹ˆè·ç¦»å°†ä¸º 0ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="2646" class="nn lg it nj b gy no np l nq nr">prediction = []</span><span id="1331" class="nn lg it nj b gy od np l nq nr">for z1 in X_rest:</span><span id="7233" class="nn lg it nj b gy od np l nq nr">    min_cluster_distance = 100000<br/>    min_distance_point = ""<br/>    min_cluster_distance_hull = ""<br/>    <br/>    for i in indices:</span><span id="eddb" class="nn lg it nj b gy od np l nq nr">        p = proj2hull(z1, hulls[i].equations)</span><span id="f47e" class="nn lg it nj b gy od np l nq nr">        dist = np.linalg.norm(z1-p)</span><span id="6343" class="nn lg it nj b gy od np l nq nr">        if dist &lt; min_cluster_distance:</span><span id="0a33" class="nn lg it nj b gy od np l nq nr">            min_cluster_distance = dist<br/>            min_distance_point = p<br/>            min_cluster_distance_hull = i</span><span id="4595" class="nn lg it nj b gy od np l nq nr">    prediction.append(min_cluster_distance_hull)</span><span id="ffac" class="nn lg it nj b gy od np l nq nr">prediction = np.array(prediction)</span></pre><p id="39dd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å›¾ 6 æ˜¾ç¤ºäº†æœ€ç»ˆçš„èšç±»ç»“æœã€‚</p><figure class="ne nf ng nh gt ms gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi oe"><img src="../Images/94f90c1f0cf11f215e54eeed65e338e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*THA9SlnZEM5pl7xnnlsFrw.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">å›¾å…­ã€‚å‡¸åŒ…çš„æœ€ç»ˆç»“æœ(å›¾ç‰‡ç”±ä½œè€…æä¾›)</p></figure><h2 id="5a63" class="nn lg it bd lh ns nt dn ll nu nv dp lp kr nw nx lr kv ny nz lt kz oa ob lv oc bi translated">è¯„ä¼°æœ€ç»ˆç»“æœ</h2><p id="4145" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">è®©æˆ‘ä»¬è¯„ä¼°ä¸€ä¸‹æˆ‘ä»¬çš„ç»“æœï¼Œçœ‹çœ‹å®ƒæœ‰å¤šå‡†ç¡®ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="ae3b" class="nn lg it nj b gy no np l nq nr">from sklearn.metrics import accuracy_score</span><span id="2457" class="nn lg it nj b gy od np l nq nr">Y_pred = np.concatenate((remapped_initial_result, prediction))<br/>Y_real = np.concatenate((y_seeds, y_rest))<br/>print(accuracy_score(Y_real, Y_pred))</span></pre><p id="9a78" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘å¾—åˆ°äº† 1.0 (100%)çš„å‡†ç¡®ç‡ï¼æ£’æäº†ï¼Œæ¿€åŠ¨äººå¿ƒï¼Œå¯¹å§ï¼ŸğŸ˜Š</p><p id="3cbe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¦‚æœæƒ³äº†è§£æ›´å¤šå…³äºè¯„ä¼°èšç±»ç»“æœçš„å†…å®¹ï¼Œå¯ä»¥æŸ¥çœ‹æˆ‘ä¹‹å‰çš„æ–‡ç« <a class="ae le" rel="noopener" target="_blank" href="/evaluating-clustering-results-f13552ee7603">è¯„ä¼°èšç±»ç»“æœ</a>ã€‚</p><div class="oj ok gp gr ol om"><a rel="noopener follow" target="_blank" href="/evaluating-clustering-results-f13552ee7603"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">è¯„ä¼°èšç±»ç»“æœ</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">ç”¨äºè¯„ä¼°èšç±»ç»“æœçš„æ ‡å‡†</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa mx om"/></div></div></a></div><p id="1d7c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä½¿ç”¨äº†ä¸€ä¸ªéå¸¸ç®€å•çš„æ•°æ®é›†ã€‚æ‚¨å¯ä»¥åœ¨æ›´å¤æ‚çš„æ•°æ®é›†ä¸Šå°è¯•è¿™ç§æ–¹æ³•ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p><h2 id="4a8b" class="nn lg it bd lh ns nt dn ll nu nv dp lp kr nw nx lr kv ny nz lt kz oa ob lv oc bi translated">é«˜ç»´æ•°æ®</h2><p id="b72e" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">æˆ‘è¿˜å°è¯•ä½¿ç”¨æˆ‘çš„èšç±»å¤–å£³æ–¹æ³•å¯¹ä¸€ä¸ªå…·æœ‰ 8 ç»´æ•°æ®ç‚¹çš„æ•°æ®é›†è¿›è¡Œèšç±»ã€‚ä½ å¯ä»¥æ‰¾åˆ°æ˜¾ç¤ºä»£ç å’Œç»“æœçš„<a class="ae le" href="https://gist.github.com/Vini2/0dc28a1d8b7d78cf30b3d633cd62c271" rel="noopener ugc nofollow" target="_blank"> jupyter ç¬”è®°æœ¬</a>ã€‚æœ€ç»ˆç»“æœå¦‚ä¸‹ã€‚</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="4a74" class="nn lg it nj b gy no np l nq nr">Accuracy of K-means method: 0.866<br/>Accuracy of Convex Hull method: 0.867</span></pre><p id="6928" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘çš„å‡¸åŒ…æ–¹æ³•ç›¸å¯¹äº K-means æœ‰ä¸€ç‚¹æ”¹è¿›ã€‚</p><h1 id="52f0" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">æœ€åçš„æƒ³æ³•</h1><p id="5824" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">HakanCevikalp çš„é¢˜ä¸º<a class="ae le" href="https://doi.org/10.1016/j.patrec.2019.10.007" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">é€šè¿‡ä½¿ç”¨å±€éƒ¨ä»¿å°„/å‡¸åŒ…</strong> </a>è¿›è¡Œé«˜ç»´æ•°æ®èšç±»çš„æ–‡ç« è¡¨æ˜ï¼Œä»–ä»¬æå‡ºçš„åŸºäºå‡¸åŒ…çš„æ–¹æ³•é¿å…äº†â€œ<em class="nd">å­”æ´ä¼ªå½±</em>â€é—®é¢˜(é«˜ç»´ç©ºé—´ä¸­çš„ç¨€ç–å’Œä¸è§„åˆ™åˆ†å¸ƒä¼šä½¿æœ€è¿‘é‚»è·ç¦»ä¸å¯é )ï¼Œå¹¶ä¸”ä¸å…¶ä»–æœ€å…ˆè¿›çš„å­ç©ºé—´èšç±»æ–¹æ³•ç›¸æ¯”ï¼Œæé«˜äº†é«˜ç»´æ•°æ®é›†çš„å‡†ç¡®æ€§ã€‚</p><div class="oj ok gp gr ol om"><a href="https://www.sciencedirect.com/science/article/pii/S0167865519302806?via%3Dihub" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">åˆ©ç”¨å±€éƒ¨ä»¿å°„/å‡¸åŒ…çš„é«˜ç»´æ•°æ®èšç±»</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">æˆ‘ä»¬æå‡ºäº†ä¸€ç§æ–°çš„ç®—æ³•ï¼Œä½¿ç”¨å±€éƒ¨ä»¿å°„/å‡¸åŒ…çš„é«˜ç»´æ•°æ®èšç±»ã€‚*å»ºè®®çš„â€¦</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">www.sciencedirect.com</p></div></div><div class="ov l"><div class="pb l ox oy oz ov pa mx om"/></div></div></a></div><p id="77ae" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ‚¨å¯ä»¥æ‰¾åˆ°åŒ…å«æœ¬æ–‡æ‰€ç”¨ä»£ç çš„<a class="ae le" href="https://gist.github.com/Vini2/2d35132f70ee18298fdea142b5530a52" rel="noopener ugc nofollow" target="_blank"> jupyter ç¬”è®°æœ¬</a>ã€‚</p><figure class="ne nf ng nh gt ms"><div class="bz fp l di"><div class="pc pd l"/></div></figure><p id="3be7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¸Œæœ›è¿™ç¯‡æ–‡ç« æ˜¯æœ‰è¶£å’Œæœ‰ç”¨çš„ã€‚</p><p id="636f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¹²æ¯ï¼ğŸ˜ƒ</p></div></div>    
</body>
</html>