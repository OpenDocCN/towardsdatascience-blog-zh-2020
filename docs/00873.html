<html>
<head>
<title>Time to Change (Data) — Track Your Personal Finance With Power BI Using Pivot and Python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">是时候改变了(数据)—使用Pivot和Python，借助Power BI跟踪您的个人财务状况。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7?source=collection_archive---------5-----------------------#2020-01-25">https://towardsdatascience.com/time-to-change-data-track-your-personal-finance-with-power-bi-using-pivot-and-python-5839a6f804e7?source=collection_archive---------5-----------------------#2020-01-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="1e2f" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">采用微软POWER BI的数据科学</h2><div class=""/><div class=""><h2 id="46a5" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">一种使用python在Power BI中实现完全动态透视的方法，同时还可以享受跟踪个人财务的乐趣</h2></div><p id="6b5f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在Power BI中学习一些关于pivot和python的新知识，同时构建一种更好的方法来跟踪您的个人财务状况，这不是很好吗？</p><p id="de76" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果你想要这个<strong class="kq ja">仪表盘</strong>👇那么这个故事是给你的！</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/6000f5ad7ef8a3f41db0be29eac1287c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*86Lc6D2nEDV0ssJE77mItQ.png"/></div></div><p class="lw lx gj gh gi ly lz bd b be z dk translated">个人财务仪表板</p></figure><p id="ff31" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">除了有趣的部分，我们还学到了以下内容:</p><ul class=""><li id="0cc6" class="ma mb iq kq b kr ks ku kv kx mc lb md lf me lj mf mg mh mi bi translated">如何在Power BI中进行透视，同时保持所有列完全动态，使添加新数据变得容易，而无需接触我们的模型。</li><li id="3e45" class="ma mb iq kq b kr mj ku mk kx ml lb mm lf mn lj mf mg mh mi bi translated">动态检测Power BI中的数据类型，并使用自定义函数转换列。</li><li id="1a47" class="ma mb iq kq b kr mj ku mk kx ml lb mm lf mn lj mf mg mh mi bi translated">在Power BI中使用Python清理和转换数据。</li></ul><h1 id="b8a7" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">数据</h1><p id="8d79" class="pw-post-body-paragraph ko kp iq kq b kr ng ka kt ku nh kd kw kx ni kz la lb nj ld le lf nk lh li lj ij bi translated">从我的<a class="ae nl" href="https://github.com/sebastianzolg/dynamic-pivot-in-powerbi" rel="noopener ugc nofollow" target="_blank"> Github库</a>下载样本数据。</p><div class="nm nn gp gr no np"><a href="https://github.com/sebastianzolg/dynamic-pivot-in-powerbi" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd ja gy z fp nu fr fs nv fu fw iz bi translated">sebastian zolg/动力枢轴bi</h2><div class="nw l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">github.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc lu np"/></div></div></a></div><p id="0fa7" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">让我们快速浏览一下我们的数据。</p><p id="103e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在Excel中打开<em class="od"> personal-spendings.xlsx </em>文件，注意它的简单结构。这样做的目的是让你从不同的地方添加数据变得容易，比如你的银行账户或者你正在做的任何项目。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/7772b34f178cce3d4eea628a691c4c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0KvXAa4eAouXCZgTDjrZjA.png"/></div></div></figure><p id="c7ec" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">您可以随意添加任意多的细节，但是输入数据要简单，这样跟踪数据就不会太难。我们让权力BI为我们做繁重的工作。</p><h1 id="e0e1" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">在枢轴上转动</h1><p id="a4ef" class="pw-post-body-paragraph ko kp iq kq b kr ng ka kt ku nh kd kw kx ni kz la lb nj ld le lf nk lh li lj ij bi translated">Pivot是将我们的数据维度转换为新形式的过程。在我们的例子中，我们希望初始的<strong class="kq ja">类别</strong>作为一个特征矩阵，以<strong class="kq ja">数量</strong>作为值。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi of"><img src="../Images/514ea1a12e3379d6fa73379131494fca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gQbLnR-x2GcuQtPoUuBJYQ.png"/></div></div><p class="lw lx gj gh gi ly lz bd b be z dk translated">将左侧数据集透视到右侧数据集</p></figure><p id="d060" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">Power BI中的pivot面临的挑战是在初始建模之后引入新标签(列)所需的工作。</p><p id="22ad" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">这是因为Power BI通过名称静态引用列和其他元素<em class="od">。这迫使我们每次推出新品类时都要接触我们的模型。我们需要一个解决方案！</em></p><h1 id="fc31" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">构建我们的模型</h1><p id="2645" class="pw-post-body-paragraph ko kp iq kq b kr ng ka kt ku nh kd kw kx ni kz la lb nj ld le lf nk lh li lj ij bi translated">在Power BI中，点击<strong class="kq ja">获取数据，</strong>选择<strong class="kq ja"> Excel </strong>，点击<strong class="kq ja">连接。</strong>从我的Github存储库中打开样本数据，或者选择您自己的数据集。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/b756e6a2debff0f90c990e30a7af9519.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lEIcmXHxn2sp2NknaaONQQ.png"/></div></div></figure><p id="3850" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">选择<strong class="kq ja">财务</strong>电子表格，查看数据并点击<strong class="kq ja">转换</strong>。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi og"><img src="../Images/5adf1ddb28e0c4f7ddba9cc0162af3df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Kckpi_D1DweXO87h5kRxw.png"/></div></div></figure><p id="990e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">第一步，我们将列<strong class="kq ja">月</strong>和<strong class="kq ja">年</strong>转换成一个单独的<strong class="kq ja">日期</strong>列。</p><p id="7218" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">选择两列并点击<strong class="kq ja">合并列</strong>。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/42ad8140150a11803477b84f61d8e900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vVxpVkNhCgiqXkVCpEgQFw.png"/></div></div></figure><p id="8030" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">选择<strong class="kq ja">自定义</strong>作为分隔符类型，并使用斜线(<strong class="kq ja"> / </strong>)作为分隔符。将列命名为<strong class="kq ja">日期</strong>并点击<strong class="kq ja">确定</strong>按钮。搞定了。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oh"><img src="../Images/436ef4b9302907b3d0bdbf63fe8b896b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oMPO7C4ZBz7e5qDuAAGx1w.png"/></div></div></figure><p id="d820" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在是时候将我们的数据转换到目标结构中，其中<strong class="kq ja">类别</strong>成为我们的列，<strong class="kq ja">数量</strong>成为我们的值。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/744fce05ad60dd036e8da93f6aa08572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*413r9RZx_7mmdWOp2fnmpA.png"/></div></div></figure><p id="42b9" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">确保您已经选择了<strong class="kq ja">类别</strong>列，然后单击<strong class="kq ja">透视列</strong>。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/a116e7317088906eb148f15f295b32c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DV-YIbSm8PegfN0KT2Ksvg.png"/></div></div></figure><p id="28fb" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">从数值下拉字段中选择<strong class="kq ja">金额</strong>。如果我们在同一个月有多个条目，我们希望Power BI使用<strong class="kq ja"> Sum </strong>作为聚合函数。</p><p id="dc0d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">点击<strong class="kq ja">确定</strong>。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oh"><img src="../Images/b88fdd573e6b30b391af6f2ebb9d1ed5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*djywfd63Q-VUW6t7UzuSNA.png"/></div></div></figure><p id="7543" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">结果应该如下面的屏幕所示。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/e0009278fd2aec4b27e6b3f5119209ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H-csZmAsuOZAVeWG8PEpAg.png"/></div></div></figure><p id="6820" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">请注意以下三点:</p><ol class=""><li id="6413" class="ma mb iq kq b kr ks ku kv kx mc lb md lf me lj oi mg mh mi bi translated">我们有很多无效数据，因为不是每个<strong class="kq ja">类别</strong>都有收益<em class="od">和</em>支出。</li><li id="3412" class="ma mb iq kq b kr mj ku mk kx ml lb mm lf mn lj oi mg mh mi bi translated">我们对<strong class="kq ja">支出</strong>类型的值有负数，这可能很难想象。</li><li id="4123" class="ma mb iq kq b kr mj ku mk kx ml lb mm lf mn lj oi mg mh mi bi translated">我们没有每个日期(月)的<strong class="kq ja">总计</strong>栏。</li></ol><p id="607c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">为了满足我们的需求，我们在Power BI中使用了一个Python脚本。</p><p id="aa57" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">点击<strong class="kq ja">运行Python </strong> <strong class="kq ja">脚本</strong>并插入下面的脚本。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/6568cffa0cf28a8a280f4e2c6242fe33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MlNXnihHDJUAcz1BOKhKXQ.png"/></div></div></figure><figure class="ll lm ln lo gt lp"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="d2f6" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">让我们分解一下，看看这个python脚本为我们做了什么。</p><p id="10ab" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">首先，我们动态选择数据类型为<em class="od">编号为</em>的所有列。这样我们就不用硬引用任何列，并且可以很容易地添加新列。</p><pre class="ll lm ln lo gt ol om on oo aw op bi"><span id="16e1" class="oq mp iq om b gy or os l ot ou">numeric_cols = dataset.select_dtypes(include=np.number).columns</span></pre><p id="9c55" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">接下来，我们用数字<strong class="kq ja"> 0 </strong>替换所有的<em class="od">空值</em> <strong class="kq ja"> <em class="od"> </em> </strong>。</p><pre class="ll lm ln lo gt ol om on oo aw op bi"><span id="69e0" class="oq mp iq om b gy or os l ot ou">dataset.fillna(0, inplace=True)</span></pre><p id="a05b" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在我们已经选择了所有的数字列，我们只需在所有的行上调用<code class="fe ov ow ox om b">abs()</code>函数，将所有的负数转换成它的绝对等效值。</p><pre class="ll lm ln lo gt ol om on oo aw op bi"><span id="d77f" class="oq mp iq om b gy or os l ot ou">dataset[numeric_cols] = dataset[numeric_cols].abs()</span></pre><p id="382f" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">最后，我们对所有行及其数字列进行求和。我们将结果存储在名为<strong class="kq ja"> GrandTotal的新列中。</strong></p><pre class="ll lm ln lo gt ol om on oo aw op bi"><span id="4ae0" class="oq mp iq om b gy or os l ot ou">dataset['GrandTotal'] = dataset[numeric_cols].sum(axis=1)</span></pre><p id="130b" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">为了使用结果，我们单击<strong class="kq ja">表</strong>来扩展数据集。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/2d33ae8007609681ad28f38cbfa9def7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KSHt8mrQlQAjmn9LwrkDhg.png"/></div></div></figure><p id="46f0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在运行Python片段后，Power BI试图自动检测数据类型，但在这里没有做好。</p><p id="7bfb" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">此外，这一步添加了对命名列的硬引用。</p><p id="6368" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">因为我们希望它是完全动态的，我们通过点击<strong class="kq ja"> X </strong>图标从<strong class="kq ja">应用步骤</strong>面板中移除了<strong class="kq ja">变更类型</strong>步骤。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/e46fccf8e2387d8868c1a2461f63cb6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CnAGsVJjXpe7L5w-5ATLKg.png"/></div></div></figure><p id="92a6" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">等一下！</strong>当我们不能使用Power BI类型检测时，我们如何动态地输入数据？我们需要一个函数！</p><p id="76bd" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">右键点击<strong class="kq ja">查询</strong>面板，选择<strong class="kq ja">新建查询&gt;空白查询</strong>。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/484ac0298c5bbaf9e909403ea6d5289e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JIqkOFDQIYg2u59zZhl1hQ.png"/></div></div></figure><p id="d868" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">首先，我们给新的查询函数起一个好听的名字，比如<code class="fe ov ow ox om b">AutoDetectAndTransformTypes</code>。</p><p id="05fb" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">接下来，我们通过点击<strong class="kq ja">高级编辑器</strong>图标<strong class="kq ja">调出编辑器。</strong>插入下面的脚本，点击<strong class="kq ja">完成</strong>。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/49b519776e302bfd7184287c037c9a5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fg9m2Cv7ILAiOK1JIBMGxg.png"/></div></div></figure><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oy"><img src="../Images/74d10135f03dc49ec5b537d286117c3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gh1RP8MmgZh1nvbiYxlTpg.png"/></div></div></figure><figure class="ll lm ln lo gt lp"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="c0dc" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja"> <em class="od">这是怎么回事？</em> </strong> <em class="od">这个剧本的灵感来源于</em> <a class="ae nl" href="https://datachant.com/2018/05/14/automatic-detection-of-column-types-in-powerquery/" rel="noopener ugc nofollow" target="_blank"> <em class="od">这里的</em> </a> <em class="od">。向作者致敬。这篇文章很好地解释了脚本的作用。然而，我介绍了一些简化和另一种类型检测方法。</em></p><p id="e7d4" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><em class="od">简而言之，脚本检查每一列，并通过检查每个值来推断正确的数据类型。然后，它构建列和数据类型的映射，并将其传递回Power BI。</em></p><p id="90fa" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">现在我们通过点击公式栏中的<strong class="kq ja"> <em class="od"> fx </em> </strong>图标来调用此功能。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/6fd62424363c30205fb81bbf11da7126.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lqe4YCRT5pR8ZbkY0JtqVQ.png"/></div></div></figure><p id="5dd0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja"> <em class="od">没看到公式栏？</em> </strong> <em class="od">转到</em> <strong class="kq ja"> <em class="od">查看</em> </strong> <em class="od">并勾选</em> <strong class="kq ja"> <em class="od">公式</em> </strong> <em class="od"> </em> <strong class="kq ja"> <em class="od">栏</em> </strong> <em class="od">旁边的方框。</em></p><p id="8618" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">要调用数据集上的函数，请输入下面的公式并点击enter。</p><pre class="ll lm ln lo gt ol om on oo aw op bi"><span id="ef5e" class="oq mp iq om b gy or os l ot ou">= AutoDetectAndTransformTypes(dataset)</span></pre><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/2e01d48201762514d5984bffbbca232f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QZ-LOTpupRioUSyxqEIZdw.png"/></div></div></figure><p id="4522" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">搞定！</strong>如您所见，我们的函数运行得非常好，将所有数值转换为类型<em class="od">十进制数</em>并将日期字段转换为类型<em class="od">日期。</em></p><p id="3db5" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">要开始可视化您的数据，点击<strong class="kq ja">关闭&amp;应用</strong>。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/d32ea131be70d941c3368397028ff371.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OQlDfFl9PHeJRhd-cflbhA.png"/></div></div></figure><h1 id="4e07" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">构建仪表板</h1><p id="dec3" class="pw-post-body-paragraph ko kp iq kq b kr ng ka kt ku nh kd kw kx ni kz la lb nj ld le lf nk lh li lj ij bi translated">现在我们有了如此简单的数据，我们可以轻松地构建一个漂亮的报告。我让你自己去做。</p><p id="e3b5" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果您不想自己动手，我会将Power BI模板放在我的Github存储库中的数据文件旁边。只需克隆整个存储库并从同一个目录中打开<em class="od">dynamic-pivot-in-power bi . pbit</em>文件。</p><p id="44d0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">由于我们的旋转模型，这都是视觉上的拖放。不需要代码或公式。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/c5991a5707c18c365c4d611f44ba221e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*665LJdbjkdI6syzj3PW1Cw.png"/></div></div></figure><h1 id="d57b" class="mo mp iq bd mq mr ms mt mu mv mw mx my kf mz kg na ki nb kj nc kl nd km ne nf bi translated">添加新类别</h1><p id="c2b0" class="pw-post-body-paragraph ko kp iq kq b kr ng ka kt ku nh kd kw kx ni kz la lb nj ld le lf nk lh li lj ij bi translated">让我们来看看这一解决方案的强大功能。在Excel中打开原始数据，在列表底部引入任何<em class="od">新的</em>类别<strong class="kq ja">和</strong>。别忘了<strong class="kq ja">救</strong>它。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/72afd96c767e07b0442bab2a02e44dd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZFPcGw3ocix9qoBjSk0F7w.png"/></div></div></figure><p id="65d7" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">回到Power BI，您唯一需要做的就是刷新数据。</p><p id="02db" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">点击<strong class="kq ja">刷新</strong>，选择仪表板上的任何视觉效果，看到新添加的类别自动出现在<strong class="kq ja">字段</strong>列表中。勾选旁边的方框就大功告成了。</p><p id="0f83" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">当然，这个字段也是<strong class="kq ja">总计</strong>计算的一部分。一切都充满活力。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi oe"><img src="../Images/a7276e76475b19d13e504da52f4d5ad3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hJN7fnKnc2plYAMlkJXBBw.png"/></div></div></figure><p id="3b86" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">就是这样！</strong>你做得很好。</p><p id="fbde" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">就这样吧。</p><p id="5f05" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">—塞巴斯蒂安</p></div></div>    
</body>
</html>