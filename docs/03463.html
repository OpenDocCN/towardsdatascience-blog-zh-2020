<html>
<head>
<title>How to Use Selenium to Web-Scrape with Example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Selenium进行网页抓取并举例说明</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-selenium-to-web-scrape-with-example-80f9b23a843a?source=collection_archive---------2-----------------------#2020-04-02">https://towardsdatascience.com/how-to-use-selenium-to-web-scrape-with-example-80f9b23a843a?source=collection_archive---------2-----------------------#2020-04-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1ec4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Selenium从Hoopshype.com收集NBA球员的姓名和薪水</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f03491b90c7a0bbff05e00483b1f3c76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dnKDZrA1DL5uZkPB"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@jcgellidon?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> JC Gellidon </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="5bfa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Selenium是一个Python库和工具，用于自动化web浏览器来完成许多任务。其中之一是网络搜集，以提取有用的数据和信息，否则可能无法获得。这里有一个如何使用Selenium的分步指南，以从https://hoopshype.com/salaries/players/<a class="ae kv" href="https://hoopshype.com/salaries/players/" rel="noopener ugc nofollow" target="_blank">网站</a>提取NBA球员工资数据为例。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="56a2" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">步骤1 —安装和导入</h1><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="d5e1" class="mw ma iq ms b gy mx my l mz na">pip install selenium</span></pre><p id="37e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">安装完成后，就可以开始导入了。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="df6b" class="mw ma iq ms b gy mx my l mz na">from selenium import webdriver<br/>from selenium.webdriver.common.keys import Keys<br/>import pandas as pd</span></pre><h1 id="33e0" class="lz ma iq bd mb mc nb me mf mg nc mi mj jw nd jx ml jz ne ka mn kc nf kd mp mq bi translated">步骤2 —安装并访问网络驱动程序</h1><p id="b24f" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">网络驱动是这一过程的重要组成部分。它实际上会自动打开你的浏览器来访问你选择的网站。根据您使用哪种浏览器浏览互联网，此步骤会有所不同。我正好用谷歌Chrome。有人说Chrome与Selenium配合使用效果最好，尽管它也支持Internet Explorer、Firefox、Safari和Opera。对于chrome，你首先需要在https://chromedriver.chromium.org/downloads<a class="ae kv" href="https://chromedriver.chromium.org/downloads" rel="noopener ugc nofollow" target="_blank">下载网络驱动。根据您的Chrome版本，有几种不同的下载选项。要找到你的Chrome版本，点击浏览器窗口右上角的3个垂直点，向下滚动帮助，选择“关于谷歌Chrome”。在那里你会看到你的版本。我的版本是80.0.3987.149，如下图所示。</a></p><div class="kg kh ki kj gt ab cb"><figure class="nl kk nm nn no np nq paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/e3ba808d44a395e2b85c6652241617ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*r-Q4TeNZvUnLadBXoRma5w.png"/></div></figure><figure class="nl kk nm nn no np nq paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/2a6d6e1d6212c65fb694f156b7ec9727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*zCG2a96Fn5WhKmM_FWTRbA.png"/></div></figure></div><p id="a984" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，您需要知道您在本地计算机上保存webdriver下载的位置。我的只是保存在我默认的下载文件夹中。现在，您可以使用下载的webdriver的直接路径来创建一个驱动程序变量。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="3a00" class="mw ma iq ms b gy mx my l mz na">driver = webdriver.Chrome('/Users/MyUsername/Downloads/chromedriver')</span></pre><h1 id="cd60" class="lz ma iq bd mb mc nb me mf mg nc mi mj jw nd jx ml jz ne ka mn kc nf kd mp mq bi translated">步骤3-通过Python访问网站</h1><p id="a2ee" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">非常简单但非常重要的一步。你需要你的代码来打开你试图抓取的网站。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="e3d7" class="mw ma iq ms b gy mx my l mz na">driver.get('<a class="ae kv" href="https://hoopshype.com/salaries/players/" rel="noopener ugc nofollow" target="_blank">https://hoopshype.com/salaries/players/</a>')</span></pre><p id="d93e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行时，该代码片段将打开浏览器访问您想要的网站。</p><h1 id="6a30" class="lz ma iq bd mb mc nb me mf mg nc mi mj jw nd jx ml jz ne ka mn kc nf kd mp mq bi translated">第4步—找到您正在搜集的特定信息</h1><p id="2d07" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">为了提取您想要搜集的信息，您需要定位元素的XPath。XPath是一种用于查找网页上任何元素的语法。要定位元素的XPath，突出显示您要查找的列表中的第一个元素，右键单击并选择inspect这打开了开发者工具。对于我的例子，我首先想定位NBA球员的名字，所以我首先选择斯蒂芬·库里。</p><div class="kg kh ki kj gt ab cb"><figure class="nl kk nm nn no np nq paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/6e5596c2961ba64f5d014480290cf4af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*GOEh7zFXSb29EGb8WiyVwg.png"/></div></figure><figure class="nl kk nm nn no np nq paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/a06946b75914d3f6be98d250ae6adf4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*w0Bwcb-Rdi0ZqKNXFku2vQ.png"/></div></figure></div><p id="e60f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在开发者工具中，我们现在看到元素“斯蒂芬·库里”就是这样出现的。</p><blockquote class="nr ns nt"><p id="3394" class="kw kx nu ky b kz la jr lb lc ld ju le nv lg lh li nw lk ll lm nx lo lp lq lr ij bi translated"><td class="”name”"><br/>&lt;a href = "<a class="ae kv" href="https://hoopshype.com/player/stephen-curry/salary/" rel="noopener ugc nofollow" target="_blank"/>"&gt;<br/>斯蒂芬·库里&lt; /a &gt; <br/> &lt; /td &gt;</td></p></blockquote><p id="76be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个元素可以很容易地转换成它的XPath，但是首先，我们需要记住，我们不只是试图定位这个元素，而是所有玩家的名字。使用相同的过程，我找到了列表中的下一个元素，拉塞尔·维斯特布鲁克。</p><blockquote class="nr ns nt"><p id="3e86" class="kw kx nu ky b kz la jr lb lc ld ju le nv lg lh li nw lk ll lm nx lo lp lq lr ij bi translated"><td class="”name”"><br/>&lt;a href = "<a class="ae kv" href="https://hoopshype.com/player/russell-westbrook/salary/" rel="noopener ugc nofollow" target="_blank"/>"&gt;<br/>拉塞尔·维斯特布鲁克&lt; /a &gt; <br/> &lt; /td &gt;</td></p></blockquote><p id="2994" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这两个(以及所有其他玩家名字)之间的共同点是<code class="fe ny nz oa ms b">&lt;td class=”name”&gt;</code>，所以我们将使用它来创建一个包含所有玩家名字的<em class="nu">列表。翻译成XPath看起来像<code class="fe ny nz oa ms b">//td[@class=”name”]</code>。分解一下，所有的XPaths前面都有一个<strong class="ky ir">双斜线</strong>，我们希望它出现在一个<strong class="ky ir"> td </strong>标签中，在那个<strong class="ky ir"> td </strong>标签中的每个<strong class="ky ir">类</strong>需要对应于<strong class="ky ir">【name】</strong>。我们现在可以用这个Selenium函数创建球员姓名列表。</em></p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="940a" class="mw ma iq ms b gy mx my l mz na">players = driver.find_elements_by_xpath('//td[<a class="ae kv" href="http://twitter.com/class" rel="noopener ugc nofollow" target="_blank">@class</a>="name"]')</span></pre><p id="a818" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，为了将每个玩家的名字放入一个列表中，我们编写了这个函数。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="ae1d" class="mw ma iq ms b gy mx my l mz na">players_list = []<br/>for p in range(len(players)):<br/>    players_list.append(players[p].text)</span></pre><p id="5b04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">按照同样的过程来获得球员的薪水…</p><div class="kg kh ki kj gt ab cb"><figure class="nl kk nm nn no np nq paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/11e69437cc7138f5238b7ed7e7e1ebd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*CnYC4HMCHWOfZv5j0HveVw.png"/></div></figure><figure class="nl kk nm nn no np nq paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/c1c14c47bfafba162de918a014fc606b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*DwvaxadlRylCi4nxKPkHMQ.png"/></div></figure></div><p id="a63a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">斯蒂芬·库里2019/20工资</p><blockquote class="nr ns nt"><p id="4302" class="kw kx nu ky b kz la jr lb lc ld ju le nv lg lh li nw lk ll lm nx lo lp lq lr ij bi translated"><td style="”color:black”" class="”hh-salaries-sorted”" data-value="”40231758&quot;"><br/>&lt;/TD&gt;40231758美元</td></p></blockquote><p id="054e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">拉塞尔·威斯布鲁克2019/20赛季薪资</p><blockquote class="nr ns nt"><p id="755a" class="kw kx nu ky b kz la jr lb lc ld ju le nv lg lh li nw lk ll lm nx lo lp lq lr ij bi translated"><td style="”color:black”" class="”hh-salaries-sorted”" data-value="”38506482&quot;"><br/>&lt;/TD&gt;38，506，482美元</td></p></blockquote><p id="e524" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在检查这些元素并转换成XPath时，我们可以忽略样式和数据值，只关心类。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="62ce" class="mw ma iq ms b gy mx my l mz na">salaries = driver.find_elements_by_xpath('//td[<a class="ae kv" href="http://twitter.com/class" rel="noopener ugc nofollow" target="_blank">@class</a>="hh-salaries-sorted"]')</span></pre><p id="31fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">和工资清单文本…</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="0f56" class="mw ma iq ms b gy mx my l mz na">salaries_list = []<br/>for s in range(len(salaries)):<br/>    salaries_list.append(salaries[s].text)</span></pre><h1 id="83a4" class="lz ma iq bd mb mc nb me mf mg nc mi mj jw nd jx ml jz ne ka mn kc nf kd mp mq bi translated">第五步——申请每一年，把所有的事情联系起来</h1><p id="c828" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">通常，在使用Selenium时，您会试图检索位于同一网站的多个不同页面上的数据。在我的例子中，hoopshype.com有追溯到1990/91赛季的NBA薪资数据。</p><div class="kg kh ki kj gt ab cb"><figure class="nl kk nm nn no np nq paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/edc5b56ec23ccdb9a3b00c5c71bc58b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*_WzgkbGp5m-2KKKhavzpDw.png"/></div></figure><figure class="nl kk nm nn no np nq paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/e5d7e622f31fed989c55269ae5c7ba4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ilLy8A8BrAANl764osxNpQ.png"/></div></figure></div><p id="2f93" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你所看到的，每个季节的URL之间的差异只是被包含在最后的年份的问题。所以2018/19赛季的网址是<a class="ae kv" href="https://hoopshype.com/salaries/players/2018-2019/" rel="noopener ugc nofollow" target="_blank">https://hoopshype.com/salaries/players/2018-2019/</a>，1990/91赛季的网址是<a class="ae kv" href="https://hoopshype.com/salaries/players/1990-1991/" rel="noopener ugc nofollow" target="_blank">https://hoopshype.com/salaries/players/1990-1991/</a>。这样，我们可以创建一个函数，循环遍历每一年，分别访问每个URL，然后将我们之前展示的每一年的所有步骤放在一起。我还将每个球员与他们在该赛季的工资配对在一起，放入一个临时数据帧中，将年份添加到该临时数据帧中，然后将该临时数据帧添加到一个主数据帧中，该主数据帧包含了我们获得的所有数据。最后的代码在下面！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure></div></div>    
</body>
</html>