<html>
<head>
<title>Analysis of Tweets about Uncut Gems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于原钻的推文分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/twitter-sentiment-analysis-of-uncut-gems-92cc0e0ae628?source=collection_archive---------29-----------------------#2020-01-10">https://towardsdatascience.com/twitter-sentiment-analysis-of-uncut-gems-92cc0e0ae628?source=collection_archive---------29-----------------------#2020-01-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="be4a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">原钻的推特情感分析:去除假阴性</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dda5a3e15d49c80799d05b827556bff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ke-pxTYsz2EZ30XmNDAZA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/@jonnylew" rel="noopener ugc nofollow" target="_blank">乔尼·卢</a>在<a class="ae ky" href="https://www.pexels.com/photo/closeup-photo-of-purple-gemstones-1121123/" rel="noopener ugc nofollow" target="_blank">像素</a>上拍摄</p></figure><p id="33b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">《原钻》</em>是一部犯罪/惊悚片，由亚当·桑德勒、茱莉亚·福克斯、勒凯斯·斯坦菲尔德和前NBA球员凯文·加内特主演。由乔希和本尼·萨夫迪编剧和导演的《原钻》是一部历时十年制作的电影。故事情节讲述了一个纽约珠宝商和赌博成瘾的人，他必须找回一颗在埃塞俄比亚开采的黑欧泊未切割宝石，以便出售和偿还债务。这部电影是A24迄今为止票房最高的电影，在撰写本文时票房收入为4000万美元。</p><p id="8525" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以我个人的经验来看，抛开专业影评人对这部电影的好评如潮不谈，我的同行对这部电影的评价褒贬不一。这启发了我对关于原钻的推文进行情感分析。在本文中，我们将使用python Twitter API包装器Tweepy来检索关于电影的推文，然后使用另一个名为textblob的python库对这些推文进行情感分析。</p><p id="389f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><p id="5776" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，你需要申请一个Twitter开发者账户:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/8de478e493cd200d2ddb35292f06e27d.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*0xmSHPJRMafMjW4Zr4atYQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://projects.raspberrypi.org/en/projects/getting-started-with-the-twitter-api/3" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="a903" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您的开发人员帐户获得批准后，您需要创建一个Twitter应用程序:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lx"><img src="../Images/535749c04db1726dafff300aac41628c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5EGnUjPFY2dF-jUkTdd6QA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://projects.raspberrypi.org/en/projects/getting-started-with-the-twitter-api/4" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="f9b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">申请Twitter开发者账户和创建Twitter应用程序的步骤在这里<a class="ae ky" href="https://projects.raspberrypi.org/en/projects/getting-started-with-the-twitter-api/4" rel="noopener ugc nofollow" target="_blank">有所概述</a>。</p><p id="2741" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了访问Twitter API，我们将使用免费的python库tweepy。tweepy的文档可以在这里找到<a class="ae ky" href="https://tweepy.readthedocs.io/en/latest/getting_started.html" rel="noopener ugc nofollow" target="_blank">。</a></p><ol class=""><li id="44fd" class="ly lz it lb b lc ld lf lg li ma lm mb lq mc lu md me mf mg bi translated"><strong class="lb iu">安装</strong></li></ol><p id="4861" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，确保您已经安装了tweepy。打开命令行并键入:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="a36d" class="mm mn it mi b gy mo mp l mq mr">pip install tweepy</span></pre><p id="8039" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.<strong class="lb iu">导入库</strong></p><p id="23e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，打开您最喜欢的编辑器，导入tweepy和pandas库:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="725b" class="mm mn it mi b gy mo mp l mq mr">import tweepy<br/>import pandas as pd</span></pre><p id="9918" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.<strong class="lb iu">认证</strong></p><p id="b15e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要我们的消费者密钥和访问令牌:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/6e8d1ea132e104bb6c262ddad9d50495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7TxOpsOni5I1HAdafJ9BWw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://projects.raspberrypi.org/en/projects/getting-started-with-the-twitter-api/4" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="d398" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，该网站建议您保持您的密钥和令牌私有！这里我们定义了一个假的密钥和令牌，但是在创建Twitter应用程序时，您应该使用真正的密钥和令牌，如上所示:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="7ab4" class="mm mn it mi b gy mo mp l mq mr">consumer_key = '5GBi0dCerYpy2jJtkkU3UwqYtgJpRd' <br/>consumer_secret = 'Q88B4BDDAX0dCerYy2jJtkkU3UpwqY'<br/>access_token = 'X0dCerYpwi0dCerYpwy2jJtkkU3U'<br/>access_token_secret = 'kly2pwi0dCerYpjJtdCerYkkU3Um'</span></pre><p id="39f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是创建OAuthHandler实例。我们传递上面定义的消费者密钥和访问令牌:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="607d" class="mm mn it mi b gy mo mp l mq mr">auth = tweepy.OAuthHandler(consumer_key, consumer_secret)<br/>auth.set_access_token(access_token, access_token_secret)</span></pre><p id="6ffd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将OAuthHandler实例传递给API方法:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="7715" class="mm mn it mi b gy mo mp l mq mr">api = tweepy.API(auth)</span></pre><p id="58f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4.<strong class="lb iu"> TWITTER API请求</strong></p><p id="2cca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们为我们有兴趣分析的字段初始化列表。现在，我们可以查看推文字符串、用户和推文时间。接下来，我们在一个tweepy“Cursor”对象上编写一个for循环。在“Cursor”对象中，我们传递“api.search”方法，为我们想要搜索的内容设置查询字符串，并设置“count”= 1000，这样我们就不会超过Twitter的速率限制。在这里，我们将搜索关于“星球大战”的推文。我们还使用“item()”方法将“Cursor”对象转换为iterable。</p><p id="c42f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了简化查询，我们可以删除转发，只包含英文推文。为了了解该请求返回的内容，我们还可以打印附加到每个列表的值:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="7e95" class="mm mn it mi b gy mo mp l mq mr">twitter_users = []<br/>tweet_time = []<br/>tweet_string = []<br/>for tweet in tweepy.Cursor(api.search,q='Uncut Gems', count=1000).items(1000):<br/>            if (not tweet.retweeted) and ('RT @' not in tweet.text):<br/>                if tweet.lang == "en":<br/>                    twitter_users.append(tweet.user.name)<br/>                    tweet_time.append(tweet.created_at)<br/>                    tweet_string.append(tweet.text)<br/>                    print([tweet.user.name,tweet.created_at,tweet.text])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/00bc34d91bdbbff0a1a81f4cfc169b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LTDpyYVf1yi21_QJEZxVXQ.png"/></div></div></figure><p id="5557" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了实现可重用性，我们可以将它封装在一个函数中，该函数将关键字作为输入。我们还可以将结果存储在数据帧中并返回值:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="9658" class="mm mn it mi b gy mo mp l mq mr">def get_related_tweets(key_word):</span><span id="04af" class="mm mn it mi b gy mu mp l mq mr">twitter_users = []<br/>    tweet_time = []<br/>    tweet_string = [] <br/>    for tweet in tweepy.Cursor(api.search,q=key_word, count=1000).items(1000):<br/>            if (not tweet.retweeted) and ('RT @' not in tweet.text):<br/>                if tweet.lang == "en":<br/>                    twitter_users.append(tweet.user.name)<br/>                    tweet_time.append(tweet.created_at)<br/>                    tweet_string.append(tweet.text)<br/>                    print([tweet.user.name,tweet.created_at,tweet.text])<br/>    df = pd.DataFrame({'name':twitter_users, 'time': tweet_time, 'tweet': tweet_string})<br/>    <br/>    return df</span></pre><p id="f3a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们可以用关键字“原钻”调用函数时:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="9379" class="mm mn it mi b gy mo mp l mq mr">get_related_tweets('Uncut Gems')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/2abc49d73c941e737d6e887a54577b37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IikpQbXh9XSxVLnZxh8KPQ.png"/></div></div></figure><p id="ed89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以传入关键字“亚当·桑德勒”:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="7350" class="mm mn it mi b gy mo mp l mq mr">get_related_tweets('Adam Sandler')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/308e775bcf4517d88bb20d9abcb39464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rb1srxIjRj2fLGXDLg5Q1w.png"/></div></div></figure><p id="6982" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以传入关键字“Julia Fox”:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="993e" class="mm mn it mi b gy mo mp l mq mr">get_related_tweets('Julia Fox')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/cf173f3bb4d1ffc032800766c601cbff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X5rW4ItVHrpL-BH_uwZpGA.png"/></div></div></figure><p id="f643" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有《萨夫迪兄弟》:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="aef9" class="mm mn it mi b gy mo mp l mq mr">get_related_tweets('Safdie Brothers')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/add84b19166f35d6330ce2508bc20bb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KodN5BWkJH5_vQjymmCyJg.png"/></div></div></figure><p id="2863" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了获得情感分数，我们需要导入一个名为textblob的python包。textblob的文档可以在<a class="ae ky" href="https://textblob.readthedocs.io/en/dev/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。要安装textblob，请打开命令行并键入:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="28f6" class="mm mn it mi b gy mo mp l mq mr">pip install textblob</span></pre><p id="9259" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下次导入textblob:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="e7e0" class="mm mn it mi b gy mo mp l mq mr">from textblob import TextBlob</span></pre><p id="4a82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用极性得分作为积极或消极情绪的衡量标准。极性得分是一个从-1到+1的浮点数。</p><p id="9bf6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果我们定义一个textblob对象并传入句子“原钻是最好的！”：</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="ef4c" class="mm mn it mi b gy mo mp l mq mr">sentiment_score = TextBlob("Uncut Gems is the best!").sentiment.polarity<br/>print("Sentiment Polarity Score:", sentiment_score)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/1d7f324de670bdb2b2f4b5a8e81fbf01.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*AadSQdZBjyHGNIIjSfMg1A.png"/></div></figure><p id="850f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以试试“亚当·桑德勒太棒了！”：</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="3068" class="mm mn it mi b gy mo mp l mq mr">sentiment_score = TextBlob("Adam Sandler is amazing!").sentiment.polarity<br/>print("Sentiment Polarity Score:", sentiment_score)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/a337a104a8befa1e63769168e4390a14.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*XEF-Xo3wux9jK0KsZ48Ckw.png"/></div></figure><p id="9688" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我在使用textblob时注意到的一个缺陷是，尽管存在积极的形容词，但它对消极单词的存在给予了更大的权重，这可能会夸大错误的否定。电影标题中出现“未剪辑”一词会显著降低情感值。例如，考虑“这部电影太棒了”vs“原钻太棒了！”：</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="18f6" class="mm mn it mi b gy mo mp l mq mr">sentiment_score = TextBlob(“This movie is amazing”).sentiment.polarity<br/>print("Sentiment Polarity Score:", sentiment_score)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/5590f204a4e91163bff363afe49fa98b.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*psWCNChqdxpvve-Pr-6Bsg.png"/></div></figure><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="9e4b" class="mm mn it mi b gy mo mp l mq mr">sentiment_score = TextBlob(“Uncut Gems is amazing!”).sentiment.polarity<br/>print("Sentiment Polarity Score:", sentiment_score)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/b1b394f6662e71030efffeffdfef91a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*KDnGqYvYKDqCVnRvvKXXqg.png"/></div></figure><p id="738d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，对于“原钻太棒了！”，在情绪依然积极的同时，明显低于前一句“这部电影太棒了”时两者应该价值接近或相等。我们解决这个问题的方法(作为一个快速解决方案)是，我们将从tweet中删除单词“Uncut ”,并从结果中生成情感评分。</p><p id="eeff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们获得关于“原钻”的推文的情感极性分数，并将它们存储在一个数据框中(在删除单词“未切割”之前):</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="0368" class="mm mn it mi b gy mo mp l mq mr">df = get_related_tweets("Tesla Cybertruck")<br/>df['sentiment'] = df['tweet'].apply(lambda tweet: TextBlob(tweet).sentiment.polarity)<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/20cd3e9c61cd8424235eecf72ff1cdce.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*q2AkgGauPi_vucPNv2sf_w.png"/></div></figure><p id="1cb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以计算积极和消极情绪的数量:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="5518" class="mm mn it mi b gy mo mp l mq mr">df_pos = df[df['sentiment'] &gt; 0.0]<br/>df_neg = df[df['sentiment'] &lt; 0.0]<br/>print("Number of Positive Tweets", len(df_pos))<br/>print("Number of Negative Tweets", len(df_neg))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/96d0c98b7f292c2a60f0dc6baaea9d24.png" data-original-src="https://miro.medium.com/v2/resize:fit:452/format:webp/1*EgIE8-PIOjFirgJHEQJZfw.png"/></div></figure><p id="8e2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所看到的，关于“原钻”的负面推文明显多于正面推文，但这可能是因为电影名称中出现了“未剪辑”这个词，这可能给了我们错误的否定。</p><p id="3f9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们修改数据框架，从推文中删除“未剪切”一词:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="e7db" class="mm mn it mi b gy mo mp l mq mr">df['tweet'] = df['tweet'].str.replace('Uncut', '')<br/>df['tweet'] = df['tweet'].str.replace('uncut', '')<br/>df['tweet'] = df['tweet'].str.replace('UNCUT', '')<br/>df['sentiment'] = df['tweet'].apply(lambda tweet: TextBlob(tweet).sentiment.polarity)<br/>print(df.head())<br/>df_pos = df[df['sentiment'] &gt; 0.0]<br/>df_neg = df[df['sentiment'] &lt; 0.0]<br/>print("Number of Positive Tweets", len(df_pos))<br/>print("Number of Negative Tweets", len(df_neg))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/96d017f20fda8c0de68187aaf12f00e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*UDOf2vOU5zZUuHuantwkzg.png"/></div></figure><p id="5e16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，当我们删除“未切割”这个词时，积极的推文明显更多。</p><p id="f077" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于代码重用，我们可以将其全部封装在一个函数中:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="ae18" class="mm mn it mi b gy mo mp l mq mr">def get_sentiment(key_word):<br/>    df = get_related_tweets(key_word)<br/>    df['tweet'] = df['tweet'].str.replace('Uncut', '')<br/>    df['tweet'] = df['tweet'].str.replace('uncut', '')<br/>    df['tweet'] = df['tweet'].str.replace('UNCUT', '')<br/>    df['sentiment'] = df['tweet'].apply(lambda tweet: TextBlob(tweet).sentiment.polarity)<br/>    df_pos = df[df['sentiment'] &gt; 0.0]<br/>    df_neg = df[df['sentiment'] &lt; 0.0]<br/>    print("Number of Positive Tweets about {}".format(key_word), len(df_pos))<br/>    print("Number of Negative Tweets about {}".format(key_word), len(df_neg))</span></pre><p id="fde8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们用“原钻”调用这个函数，我们得到:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="805e" class="mm mn it mi b gy mo mp l mq mr">get_sentiment(“Uncut Gems”)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/123823dd50073ac0d06e456509dadd1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*1udyAcQwoXt6h1-S16_pZg.png"/></div></figure><p id="6037" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们能以编程方式可视化这些结果，那将会很方便。让我们导入seaborn和matplotlib并修改我们的get _情操函数:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="2109" class="mm mn it mi b gy mo mp l mq mr">import seaborn as sns<br/>import matplotlib.pyplot as plt</span><span id="cbd7" class="mm mn it mi b gy mu mp l mq mr">def get_sentiment(key_word):<br/>    df = get_related_tweets(key_word)<br/>    df['tweet'] = df['tweet'].str.replace('Uncut', '')<br/>    df['tweet'] = df['tweet'].str.replace('uncut', '')<br/>    df['tweet'] = df['tweet'].str.replace('UNCUT', '')<br/>    df['sentiment'] = df['tweet'].apply(lambda tweet: TextBlob(tweet).sentiment.polarity)<br/>    df_pos = df[df['sentiment'] &gt; 0.0]<br/>    df_neg = df[df['sentiment'] &lt; 0.0]<br/>    print("Number of Positive Tweets about {}".format(key_word), len(df_pos))<br/>    print("Number of Negative Tweets about {}".format(key_word), len(df_neg))<br/>    sns.set()<br/>    labels = ['Postive', 'Negative']<br/>    heights = [len(df_pos), len(df_neg)]<br/>    plt.bar(labels, heights, color = 'navy')<br/>    plt.title(key_word)<br/>    <br/>get_sentiment("Uncut Gems")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c31f54eb901295978df45e4f21af0def.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*yzW5ecVgI6kl249Q5n7fDA.png"/></div></figure><p id="dbf1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以用“亚当·桑德勒”来调用函数:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="b278" class="mm mn it mi b gy mo mp l mq mr">get_sentiment( “Adam Sandler”)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/042f73708a1f7b5edf394cd0e792d4a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*3W4qjtpZKT_KqeVQ6iD29g.png"/></div></figure><p id="fe42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">和“朱莉娅·福克斯”:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="f736" class="mm mn it mi b gy mo mp l mq mr">get_sentiment(“Julia Fox”)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/59a8c9bb4ff2be27d2debe9c4e3c78a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*ACbkLIlLZQ27RZIcCrcplA.png"/></div></figure><p id="72f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有“凯文·加内特”:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="26e9" class="mm mn it mi b gy mo mp l mq mr">get_sentiment(“Kevin Garnett”)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/4b1ab7c242a0069d6b7ca5c7b4b53fe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*99juJCqoKly29uWsPEa3Ow.png"/></div></figure><p id="5947" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有《勒凯斯·斯坦菲尔德》:</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="942a" class="mm mn it mi b gy mo mp l mq mr">get_sentiment(“Lakeith Stanfield”)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/0d06f035de57b5b08daa0a0e03e70703.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*i2DILrXmCc_WTqUWM_5RCg.png"/></div></figure><p id="d170" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如你所见，关于《原钻》及其主演的推文正面情绪多于负面情绪。</p><p id="779f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">概括地说，在这篇文章中，我们讨论了如何使用python twitter API wrapper (Tweepy)从Twitter中提取推文。我们还回顾了python情感分析包textblob，以及如何使用它从推文中生成情感得分。最后，我们展示了如何通过删除“未剪切”这个词来修改推文，这个词会人为地降低情感分数。收集几天的数据来观察情绪如何随时间变化会很有趣。也许我会把它留到以后的文章里。</p><p id="8c04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。这篇文章的代码可以在GitHub 上找到。</p><p id="66b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你喜欢这篇文章，你可以在我的patreon链接<a class="ae ky" href="https://www.patreon.com/from_sklearn" rel="noopener ugc nofollow" target="_blank">这里</a>做一点贡献。</p><p id="153b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">祝好运，机器学习快乐！</p></div></div>    
</body>
</html>