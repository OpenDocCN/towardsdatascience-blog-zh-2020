<html>
<head>
<title>Which Celebrity Are You? Face recognition using Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你是哪位名人？使用深度学习的人脸识别</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/which-celebrity-are-you-d8c6507f21c9?source=collection_archive---------18-----------------------#2020-04-17">https://towardsdatascience.com/which-celebrity-are-you-d8c6507f21c9?source=collection_archive---------18-----------------------#2020-04-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5fa0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 ResNet-50 卷积神经网络架构在 Python 中构建影像分类模型的简单指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/201fa3f14ef5d46071fb7cd867b1f615.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*fbTbcDOuFOtEBe4IcjfaHw.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图像分类器以 95.9 %的概率检测到该图像中的查宁·塔图姆(<a class="ae ku" href="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/Channing_Tatum_by_Gage_Skidmore_3.jpg/330px-Channing_Tatum_by_Gage_Skidmore_3.jpg" rel="noopener ugc nofollow" target="_blank"> img 源</a></p></figure><h1 id="3f34" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated"><strong class="ak">简介</strong></h1><p id="13c3" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi mj translated">T4:你有没有想过哪个名人和你长得很像？如果你在想“是的，我愿意”，那么这篇文章就是给你的。</p><p id="131c" class="pw-post-body-paragraph ln lo it lp b lq ms ju ls lt mt jx lv lw mu ly lz ma mv mc md me mw mg mh mi im bi translated">由于机器学习，你可以扫描你的面部特征，并将其与超过 3000 名名人的 260 万张面孔的数据库进行比较。</p><p id="4e11" class="pw-post-body-paragraph ln lo it lp b lq ms ju ls lt mt jx lv lw mu ly lz ma mv mc md me mw mg mh mi im bi translated">阅读本指南后，您将了解以下内容:</p><ul class=""><li id="85ee" class="mx my it lp b lq ms lt mt lw mz ma na me nb mi nc nd ne nf bi translated">深度学习卷积神经网络过程背后的直觉是什么</li><li id="8024" class="mx my it lp b lq ng lt nh lw ni ma nj me nk mi nc nd ne nf bi translated">如何安装 keras_vggface 库并在实际项目中使用这些模型</li><li id="25c4" class="mx my it lp b lq ng lt nh lw ni ma nj me nk mi nc nd ne nf bi translated">你如何让模型预测哪个名人与你最相似</li></ul></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h2 id="379b" class="ns kw it bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">概观</h2><p id="7955" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">要知道哪个名人和自己最像，我们得执行以下步骤。这些步骤将在整篇文章中详细解释:</p><ol class=""><li id="6f59" class="mx my it lp b lq ms lt mt lw mz ma na me nb mi oe nd ne nf bi translated">载入图像(你自己的图像或随机图像)</li><li id="ca8b" class="mx my it lp b lq ng lt nh lw ni ma nj me nk mi oe nd ne nf bi translated">从图像中提取人脸</li><li id="a5c7" class="mx my it lp b lq ng lt nh lw ni ma nj me nk mi oe nd ne nf bi translated">进行预处理，使人脸图像能够被识别。</li><li id="742f" class="mx my it lp b lq ng lt nh lw ni ma nj me nk mi oe nd ne nf bi translated">将图像加载到深度神经网络“ResNet-50”中。</li><li id="6ff3" class="mx my it lp b lq ng lt nh lw ni ma nj me nk mi oe nd ne nf bi translated">提取结果</li></ol><h1 id="4af6" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">人脸识别</h1><p id="9dca" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">在我们进入编码之前，我们需要对一些概念有一个高层次的介绍。<br/>人脸识别是从图像中识别人的过程。由于机器学习领域的最新发展，我们现在能够让模型本身学习应该从图像中提取哪些特征。</p><h2 id="5d28" class="ns kw it bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated"><strong class="ak">卷积神经网络</strong></h2><p id="e38c" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">深度卷积神经网络目前主导着图像分类领域。近年来的趋势是建立更深层次的神经网络来解决越来越复杂的图像分类任务。由于本文的范围相当有限，我们将只解释其背后的直觉。</p><p id="a195" class="pw-post-body-paragraph ln lo it lp b lq ms ju ls lt mt jx lv lw mu ly lz ma mv mc md me mw mg mh mi im bi translated">过程如下，我们给网络输入一张人脸图像。这张人脸图像将被传送到多层(卷积基底)。在第一层中，检测基本特征:边缘、角、…中间层检测物体的一部分。在我们的例子中，他们可能会学会察觉:眼睛、鼻子、耳朵……在最后一层，他们学习识别不同形状和位置的完整物体。然后，基于所有这些检测到的特征，分类器进行预测。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="og oh di oi bf oj"><div class="gh gi of"><img src="../Images/f732d905f8abfd8973d16cb4fdf2267e.png" data-original-src="https://miro.medium.com/v2/resize:fit:350/format:webp/0*LgvYCvnvv_2TLe25.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">卷积神经网络的过程</p></figure><h2 id="cc89" class="ns kw it bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">Resnet50</h2><p id="d81a" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">Resnet50 是一个深度学习卷积神经网络，在标准人脸识别数据集上取得了最先进的结果。它使用了 VGGFace2 数据集，这是一个大规模的人脸数据集，包含 9.9131 名受试者的超过 331 万张图像。与标准卷积神经网络的主要区别在于它使用残差学习。这意味着它不是试图学习特征，而是试图学习残差。更详细的解释可以在<a class="ae ku" href="https://arxiv.org/pdf/1512.03385.pdf" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="bb9f" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">我们开始吧！</h1><h2 id="ce93" class="ns kw it bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">步骤 0:安装并加载必要的包</h2><p id="973e" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">首先，我们需要安装必要的软件包。为了确保得到和我一样的结果，我建议你在<a class="ae ku" href="https://colab.research.google.com/notebooks/intro.ipynb#recent=true" rel="noopener ugc nofollow" target="_blank">谷歌合作环境</a>上运行这段代码。协作笔记本在谷歌的云服务器上执行代码，这意味着无论你的机器功率如何，你都可以利用谷歌硬件的能力。最棒的是，它完全<strong class="lp iu">免费</strong>！</p><ul class=""><li id="7631" class="mx my it lp b lq ms lt mt lw mz ma na me nb mi nc nd ne nf bi translated">用于从图像中检测人脸的 mtcnn 包(<a class="ae ku" href="https://github.com/ipazc/mtcnn" rel="noopener ugc nofollow" target="_blank">来源</a>)</li><li id="1bfe" class="mx my it lp b lq ng lt nh lw ni ma nj me nk mi nc nd ne nf bi translated">resnet50 cnn 模型的 keras _ vgg face(<a class="ae ku" href="https://github.com/rcmalli/keras-vggface" rel="noopener ugc nofollow" target="_blank">来源</a>)</li><li id="d907" class="mx my it lp b lq ng lt nh lw ni ma nj me nk mi nc nd ne nf bi translated">张量流(<a class="ae ku" href="https://github.com/tensorflow/tensorflow" rel="noopener ugc nofollow" target="_blank">来源</a>)</li><li id="48d5" class="mx my it lp b lq ng lt nh lw ni ma nj me nk mi nc nd ne nf bi translated">keras ( <a class="ae ku" href="https://github.com/keras-team/keras" rel="noopener ugc nofollow" target="_blank">来源</a>)</li><li id="5d6e" class="mx my it lp b lq ng lt nh lw ni ma nj me nk mi nc nd ne nf bi translated">opencv ( <a class="ae ku" href="https://github.com/opencv/opencv" rel="noopener ugc nofollow" target="_blank">来源</a>)</li></ul><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="31b2" class="ns kw it ol b gy op oq l or os">!pip install mtcnn</span><span id="9c0b" class="ns kw it ol b gy ot oq l or os">!pip install keras_vggface</span><span id="34ca" class="ns kw it ol b gy ot oq l or os">!pip install tensorflow</span><span id="091e" class="ns kw it ol b gy ot oq l or os">!pip install keras</span><span id="b5cb" class="ns kw it ol b gy ot oq l or os">!pip install opencv</span><span id="2e69" class="ns kw it ol b gy ot oq l or os">!pip install PIL</span></pre><p id="053a" class="pw-post-body-paragraph ln lo it lp b lq ms ju ls lt mt jx lv lw mu ly lz ma mv mc md me mw mg mh mi im bi translated">按如下方式导入已安装的软件包:</p><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="cb98" class="ns kw it ol b gy op oq l or os">import mtcnn</span><span id="1745" class="ns kw it ol b gy ot oq l or os">from mtcnn.mtcnn import MTCNN</span><span id="6d2a" class="ns kw it ol b gy ot oq l or os">from keras_vggface.vggface import VGGFace</span><span id="099d" class="ns kw it ol b gy ot oq l or os">from keras_vggface.utils import preprocess_input</span><span id="304b" class="ns kw it ol b gy ot oq l or os">from keras_vggface.utils import decode_predictions</span><span id="e101" class="ns kw it ol b gy ot oq l or os">import PIL</span><span id="b6a3" class="ns kw it ol b gy ot oq l or os">import os</span><span id="76e2" class="ns kw it ol b gy ot oq l or os">from urllib import request</span><span id="12a9" class="ns kw it ol b gy ot oq l or os">import numpy as np</span><span id="d187" class="ns kw it ol b gy ot oq l or os">import cv2</span><span id="75c7" class="ns kw it ol b gy ot oq l or os"># Import this one if you are working in the google colab environment</span><span id="30de" class="ns kw it ol b gy ot oq l or os">from google.colab.patches import cv2_imshow</span></pre><h2 id="ed3a" class="ns kw it bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">步骤 1:图像加载</h2><p id="7ed0" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">为了这个练习，我们导入一张查宁·塔图姆的图片。这使得每个人都可以很容易地复制它，也证明了模型的准确性。用你自己的图片链接更改 url 链接(<em class="ou">提示:你可以使用你的 linkedin 账户的图片 url)。</em></p><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="8e21" class="ns kw it ol b gy op oq l or os"># Give the image link</span><span id="02a6" class="ns kw it ol b gy ot oq l or os">url = "https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/Channing_Tatum_by_Gage_Skidmore_3.jpg/330px-Channing_Tatum_by_Gage_Skidmore_3.jpg"</span><span id="7fcf" class="ns kw it ol b gy ot oq l or os"># Open the link and save the image to res</span><span id="1b5d" class="ns kw it ol b gy ot oq l or os">res = request.urlopen(url)</span><span id="10a0" class="ns kw it ol b gy ot oq l or os"># Read the res object and convert it to an array</span><span id="bd04" class="ns kw it ol b gy ot oq l or os">img = np.asarray(bytearray(res.read()), dtype='uint8')</span><span id="8410" class="ns kw it ol b gy ot oq l or os"># Add the color variable</span><span id="25f5" class="ns kw it ol b gy ot oq l or os">img = cv2.imdecode(img, cv2.IMREAD_COLOR)</span><span id="bf54" class="ns kw it ol b gy ot oq l or os"># Show the image</span><span id="81d3" class="ns kw it ol b gy ot oq l or os">cv2_imshow(img)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/4acc68caccddab9600357c5c7b4151ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*eos-N62tQqrDpdL8xI7siA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">步骤 1 的期望输出(<a class="ae ku" href="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/Channing_Tatum_by_Gage_Skidmore_3.jpg/330px-Channing_Tatum_by_Gage_Skidmore_3.jpg" rel="noopener ugc nofollow" target="_blank"> img 源</a>)</p></figure><h2 id="660e" class="ns kw it bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">第二步:人脸检测</h2><p id="c934" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">图像现在已载入。因为我们的模型只需要人脸，所以我们需要从图像中提取人脸。为此，我们使用 mtcnn 包。MTCNN 实现了最先进的结果，并且能够检测各种面部特征(眼睛、嘴等等)。更多关于 MTCNN 的信息可以在这里找到。</p><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="bbfd" class="ns kw it ol b gy op oq l or os"># Initialize mtcnn detector</span><span id="fc0a" class="ns kw it ol b gy ot oq l or os">detector = MTCNN()</span></pre><p id="7cc9" class="pw-post-body-paragraph ln lo it lp b lq ms ju ls lt mt jx lv lw mu ly lz ma mv mc md me mw mg mh mi im bi translated">然后，我们确定一些面部提取参数:</p><ul class=""><li id="d3d5" class="mx my it lp b lq ms lt mt lw mz ma na me nb mi nc nd ne nf bi translated">目标尺寸:人脸图像应该有多大？对于 ResNet50 图像，要求大小为(224，224)</li><li id="a892" class="mx my it lp b lq ng lt nh lw ni ma nj me nk mi nc nd ne nf bi translated">Border_rel:这个参数决定了我们希望人脸图像放大到什么程度。我们现在把它设置为零。</li></ul><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="0f21" class="ns kw it ol b gy op oq l or os"># set face extraction parameters</span><span id="9737" class="ns kw it ol b gy ot oq l or os">target_size = (224,224) # output image size<br/>border_rel = 0 # increase or decrease zoom on image</span></pre><p id="c015" class="pw-post-body-paragraph ln lo it lp b lq ms ju ls lt mt jx lv lw mu ly lz ma mv mc md me mw mg mh mi im bi translated">我们调用检测器来检测给定图像中的人脸。我们看到人脸被检测到的概率为 99.8%。关键点被分配了坐标。</p><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="cd44" class="ns kw it ol b gy op oq l or os"># detect faces in the image</span><span id="d15c" class="ns kw it ol b gy ot oq l or os">detections = detector.detect_faces(img)</span><span id="ae99" class="ns kw it ol b gy ot oq l or os">print(detections)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/d1bd2a9adc3370acca88a4675b849ae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*q0svf7dWxFPHm3AVohSdvQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">MTCNN 检测输出</p></figure><p id="d9b3" class="pw-post-body-paragraph ln lo it lp b lq ms ju ls lt mt jx lv lw mu ly lz ma mv mc md me mw mg mh mi im bi translated">通过使用 box 变量，我们可以确定面部的坐标。</p><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="8938" class="ns kw it ol b gy op oq l or os">x1, y1, width, height = detections[0]['box']</span><span id="e18f" class="ns kw it ol b gy ot oq l or os">dw = round(width * border_rel)</span><span id="4294" class="ns kw it ol b gy ot oq l or os">dh = round(height * border_rel)</span><span id="4d10" class="ns kw it ol b gy ot oq l or os">x2, y2 = x1 + width + dw, y1 + height + dh</span><span id="6d7a" class="ns kw it ol b gy ot oq l or os">face = img[y1:y2, x1:x2]</span></pre><p id="6889" class="pw-post-body-paragraph ln lo it lp b lq ms ju ls lt mt jx lv lw mu ly lz ma mv mc md me mw mg mh mi im bi translated">选择图像中的人脸后，我们将人脸的大小调整为 ResNet-50: 224，224 所需的格式。</p><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="e2e6" class="ns kw it ol b gy op oq l or os"># resize pixels to the model size</span><span id="8644" class="ns kw it ol b gy ot oq l or os">face = PIL.Image.fromarray(face)<br/>face = face.resize((224, 224))<br/>face = np.asarray(face)</span><span id="9d32" class="ns kw it ol b gy ot oq l or os"># show face</span><span id="f491" class="ns kw it ol b gy ot oq l or os">cv2_imshow(face)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/6819f9155ff81ec302adb6a24d4ae4f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*NdbaBlxRwMuv0Ri2u_ltxA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">查宁·塔图姆的脸(<a class="ae ku" href="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/Channing_Tatum_by_Gage_Skidmore_3.jpg/330px-Channing_Tatum_by_Gage_Skidmore_3.jpg" rel="noopener ugc nofollow" target="_blank"> img 来源</a>)</p></figure><h2 id="aceb" class="ns kw it bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">第三步:预处理</h2><p id="ac6b" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">ResNet-50 模型期望有多个图像作为输入。目前，我们只有一个图像。为了解决这种差异，我们扩展了一维，因此我们有一个 1 x 224 x 224 x 3 的形状，而不是 224 x 224 x 3 的形状。</p><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="86b6" class="ns kw it ol b gy op oq l or os"># convert to float32<br/>face_pp = face.astype('float32')<br/>face_pp = np.expand_dims(face_pp, axis = 0)</span></pre><p id="f0c2" class="pw-post-body-paragraph ln lo it lp b lq ms ju ls lt mt jx lv lw mu ly lz ma mv mc md me mw mg mh mi im bi translated">机器学习模型需要得到一致的数据。为了确保我们所有的图像是一致的，我们必须应用一个归一化函数。幸运的是，我们可以使用 Keras 的 preprocess_input 函数来归一化我们的人脸图像。该函数将对 0 到 255 范围内的像素值进行归一化，使其适合深度学习。不要忘记将 version 参数设置为“2 ”,以便对 ResNet-50 进行专门的预处理。</p><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="0872" class="ns kw it ol b gy op oq l or os">face_pp = preprocess_input(face_pp, version = 2)</span></pre><h2 id="ed37" class="ns kw it bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">第四步:预测</h2><p id="e793" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">所有的准备工作现在都完成了。干得好！</p><p id="7a4b" class="pw-post-body-paragraph ln lo it lp b lq ms ju ls lt mt jx lv lw mu ly lz ma mv mc md me mw mg mh mi im bi translated">这里，我们通过调用 VGGFace 实例来初始化 ResNet50 模型。我们仔细检查模型期望的输入和模型将给出的输出。</p><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="fedc" class="ns kw it ol b gy op oq l or os"># Create the resnet50 Model</span><span id="88d0" class="ns kw it ol b gy ot oq l or os">model = VGGFace(model= 'resnet50')</span><span id="c053" class="ns kw it ol b gy ot oq l or os"># Check what the required input of the model is &amp; output</span><span id="8cd7" class="ns kw it ol b gy ot oq l or os">print('Inputs: {input}'.format(input = model.inputs))</span><span id="fa40" class="ns kw it ol b gy ot oq l or os">print('Output: {output}'.format(output = model.outputs))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="og oh di oi bf oj"><div class="gh gi ox"><img src="../Images/474a2891f9ad1242683544b22c3ea8d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yIf4CoiHHGOmf-szw10b3g.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">ResNet-50 型号的输入和输出</p></figure><p id="df95" class="pw-post-body-paragraph ln lo it lp b lq ms ju ls lt mt jx lv lw mu ly lz ma mv mc md me mw mg mh mi im bi translated">接下来，我们让我们的模型预测预处理后的人脸。</p><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="e55a" class="ns kw it ol b gy op oq l or os"># predict the face with the input</span><span id="eddc" class="ns kw it ol b gy ot oq l or os">prediction = model.predict(face_pp)</span></pre><h2 id="d4a1" class="ns kw it bd kx nt nu dn lb nv nw dp lf lw nx ny lh ma nz oa lj me ob oc ll od bi translated">第五步:提取结果</h2><p id="6c52" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">这张脸现在已经被预测到了。我们只需要解码我们的预测，并以可读的方式打印出来。</p><pre class="kj kk kl km gt ok ol om on aw oo bi"><span id="8311" class="ns kw it ol b gy op oq l or os"># convert predictions into names &amp; probabilities</span><span id="cb91" class="ns kw it ol b gy ot oq l or os">results = decode_predictions(prediction)</span><span id="cb6a" class="ns kw it ol b gy ot oq l or os"># Display results</span><span id="906d" class="ns kw it ol b gy ot oq l or os">cv2_imshow(img)<br/>for result in results[0]:<br/>print ('%s: %.3f%%' % (result[0], result[1]*100))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/31bea74c4357e1176e37f33755fd9d4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*0gpuFQId0X0hzbEkF6iFkQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">查宁·塔图姆的预测结果(<a class="ae ku" href="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/Channing_Tatum_by_Gage_Skidmore_3.jpg/330px-Channing_Tatum_by_Gage_Skidmore_3.jpg" rel="noopener ugc nofollow" target="_blank"> img 来源</a></p></figure><p id="08f7" class="pw-post-body-paragraph ln lo it lp b lq ms ju ls lt mt jx lv lw mu ly lz ma mv mc md me mw mg mh mi im bi translated">这就对了。<br/>你刚刚在卷积神经网络的帮助下进行了一次预测。如果你用查宁·塔图姆的照片做了这个，别忘了用你自己的照片试试，看看你和哪个名人有最大的相似之处。</p><h1 id="72b7" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">后续步骤</h1><p id="eceb" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">下一步，我们可以应用迁移学习。迁移学习指的是<strong class="lp iu">重用</strong>一个问题的预训练模型，并将其应用于另一个问题的过程。我们可以使用这种最先进的 ResNet-50 模型，并在不同的人群中重新训练分类层。</p><h1 id="f86f" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">来源</h1><p id="4743" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated"><a class="ae ku" href="https://arxiv.org/pdf/1512.03385.pdf" rel="noopener ugc nofollow" target="_blank"> ResNet50 论文</a></p><p id="c968" class="pw-post-body-paragraph ln lo it lp b lq ms ju ls lt mt jx lv lw mu ly lz ma mv mc md me mw mg mh mi im bi translated"><a class="ae ku" href="https://machinelearningmastery.com/how-to-perform-face-recognition-with-vggface2-convolutional-neural-network-in-keras/" rel="noopener ugc nofollow" target="_blank">keras 中的卷积神经网络</a></p><h1 id="bbf0" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">开源代码库</h1><p id="bb8d" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">完整的代码可以在<a class="ae ku" href="https://github.com/BgtEwoud/CNN_celeb" rel="noopener ugc nofollow" target="_blank">我的 github </a>上找到。我建议在执行代码时使用 google collab。</p></div></div>    
</body>
</html>