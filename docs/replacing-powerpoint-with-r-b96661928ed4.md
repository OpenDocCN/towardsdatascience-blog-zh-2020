# 用 R 替换 PowerPoint

> 原文：<https://towardsdatascience.com/replacing-powerpoint-with-r-b96661928ed4?source=collection_archive---------29----------------------->

如果你正在做一个分析性的演示，用 R Markdown 创建的演示来代替 PowerPoint 是一个好主意，原因有三。

1.  交互性:R Markdown 使您能够生成交互式幻灯片。拥有交互式图表更有趣，应该会让你的演示对象参与进来。
2.  文档:您编写的用于生成分析的代码可以存储在幻灯片中(它可以打开/关闭),并作为您的分析方法的文档。没有必要编写您的方法或包含您用来创建可视化的数据截图，因为 R 会为您呈现它们。
3.  自动化:如果您必须频繁地使用新数据(如月报或周报)进行相同的演示，那么您可以将相同的代码应用于不同的数据，从而节省您的时间和精力。

# 创建演示文稿

要用 R 创建一个演示文稿，您需要 R Studio IDE，如果您有，就可以开始使用。要开始点击文件>新建文件> R 降价，这将生成下面的弹出窗口。

![](img/8bd8312bac45dc5da1db1c5d82074b15.png)

创建新的 R Markdown 文件

在左侧面板选择“演示”后，您会看到 4 个演示类型选项(如果您使用的是 R Studio 1.0，您将看不到 PowerPoint)。虽然这篇文章是关于不使用 PowerPoint 的，但是结合 R 使用它仍然是一个巨大的进步。只有 HTML 输出允许交互结果，所以在我看来，这是最好的选择，尽管如果你选择制作 PowerPoint 或 PDF，文档和自动化的好处是不变的。在这个例子中，我将选择 Slidy。

在您创建的新 R Markdown 文件中，前几行是 YAML，这是一种用于声明环境或配置变量的文件格式。这个 YAML 将告诉我们关于演示文稿的事情——标题、作者、日期和输出。我将把标题改为“财务报告”，日期改为“r 系统”。Date()` "将使报告始终具有当前日期。

![](img/4fe8365e0ba9f3a5a33f96c397c9da42.png)

YAML 降价

# 写作降价

Markdown 是一种轻量级的标记语言，它基本上意味着文本的格式与文本写在同一个文档中。这类似于 HTML 的工作方式。以下是减价的原则，涵盖了你需要的大部分东西。HTML 和 CSS 可以应用到您的文档中进行进一步的定制。

*   幻灯片:新的幻灯片将以一些标签开始。单个#生成一个

    # 标记，##生成一个

    ## 标记，###生成一个

    ### 标记，依此类推。

*   链接:可以包含在[链接文本](url)中
*   图像:要插入图像，请键入！[备选文本](path/to/your/image.png)
*   加粗:要使文本加粗，把它放在星号之间，像这样:*加粗的单词*
*   斜体:要将文本设为斜体，请将其放在两个星号之间:**斜体文本* *
*   列表:无序列表可以用*来创建，用+来创建。只需输入“1”就可以创建有序列表，这在您必须向列表中插入新项目时很有帮助，因为您不必重新编号。
*   块引号:要包含块引号，只需在段落开头加上>。

# 编写代码

您的代码将以内联或代码块的形式编写。内联代码可以和你的 markdown 一起写，我们在写 r Sys 的时候已经看到了一个例子。日期()`在 YAML。要使用内联代码，只需确保将 R 代码写在反勾号内，而不是撇号内，反勾号与大多数键盘上的波浪号共享同一个键。

代码块是编写大部分代码的地方。每个代码块都以三个反斜杠和一组大括号开始，其中设置了编程语言、代码块名称和显示选项。一个代码块将以三个反斜线结束。以下是您可能需要的主要显示选项:

*   echo:隐藏代码。
*   eval:不运行代码。
*   包含:运行代码，但不显示代码或输出。常见的用例是在一个块上加载包并隐藏它。
*   error:隐藏错误消息。
*   缓存:缓存结果以供将来渲染。如果您经常在幻灯片之间切换，这很有用。
*   图形宽度:调整图形宽度。
*   身材高度:调整身材高度。

# 呈现演示文稿

要呈现您的演示文稿，请单击屏幕顶部的“编织”。这将生成您的演示文稿，以及可以在浏览器中打开的幻灯片的 HTML 文件。记住，作为一个 HTML 文档，你可以根据自己的需要编写 CSS 样式，比如改变字体或背景颜色。

![](img/adbc5e0e4dfff2c59827d8ff743b1d65.png)

经过渲染的演示

# 插入交互式可视化效果

交互性是 R Markdown 在 PowerPoint 上最明显的优势。虽然自动化和文档化可能会节省您的时间，并使您的工作更清晰，但交互性是演示时真正令人惊叹的因素。

使用下面的 quantmod 和 highcharter 包，我在一个有一些交互功能的图上显示谷歌的股票价格。这比您可能在 Excel 中对同一图表进行截图并复制/粘贴到 PowerPoint 中要令人印象深刻得多。它也比你期望的用传统的数据软件花费更少的工作，下面两行单独渲染了这个图。

`x <- getSymbols("GOOG", auto.assign=FALSE)
highchart(type="stock") %>% hc_add_series(x)`

![](img/dcdf4bc277850beb09240270d6118109.png)

HIghcharter 烛台图表

添加更多高级交互功能(例如，允许您更改正在查看的股票)，需要您学习 R package Shiny，它可以帮助您快速构建 web 应用程序。如果你希望你的演示文稿需要大量关于类似数据的图表或幻灯片，添加 Shiny 可以解决这个问题，但使用 [htmlwdigets](https://www.htmlwidgets.org/showcase_leaflet.html) 包可以快速实现基本的交互功能。