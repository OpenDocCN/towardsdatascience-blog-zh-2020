<html>
<head>
<title>Is Normal Distribution Necessary in Regression? How to track and fix it?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">回归中正态分布有必要吗？如何跟踪修复？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/is-normal-distribution-necessary-in-regression-how-to-track-and-fix-it-494105bc50dd?source=collection_archive---------4-----------------------#2020-05-15">https://towardsdatascience.com/is-normal-distribution-necessary-in-regression-how-to-track-and-fix-it-494105bc50dd?source=collection_archive---------4-----------------------#2020-05-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6008" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">博克斯-考克斯变换，夏皮罗-维尔克检验，QQ 图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2f292e94171d1efde5233eedf8ead49a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F7qEGCSLH0jjz3sEhvURXw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者拍摄的图片——新加坡南洋理工大学的钟形建筑</p></figure><p id="e0e7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我相信对于每个以前学过统计学的人来说，正态分布(高斯分布)是他们学到的最重要的概念之一。每次运行模型或者做数据分析的时候，我都倾向于检查因变量和自变量的分布，看它们是否正态分布。如果有些变量是偏斜的，不是正态分布的，我会有点慌。</p><blockquote class="lu"><p id="85c5" class="lv lw it bd lx ly lz ma mb mc md lt dk translated">我该怎么办？我应该转换变量吗？我应该把它从模型中移除还是就这么放着？</p></blockquote><p id="cca5" class="pw-post-body-paragraph ky kz it la b lb me ju ld le mf jx lg lh mg lj lk ll mh ln lo lp mi lr ls lt im bi translated">我总是想知道常态是否是一个必要的假设，以及我们应该如何解决它。这篇文章就是关于这些的。</p><blockquote class="mj mk ml"><p id="a870" class="ky kz mm la b lb lc ju ld le lf jx lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">那么对于自变量和因变量，正态性假设有必要成立吗？<strong class="la iu">答案是否定的</strong>！</p></blockquote><p id="43ff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设正态分布的变量只是预测误差。什么是预测误差？是模型预测结果与真实结果的偏差。</p><p id="a0cf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Y =系数* X +截距+预测误差</p><p id="9655" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">预测误差应遵循平均值为 0 的正态分布。置信区间和变量显著性的计算就是基于这个假设。这是什么意思？例如，您试图分析哪些变量有助于预测房价，并且您选择了基于 5%显著性水平的因素。如果误差分布显著偏离均值 0 正态分布，那么你选择的显著因素实际上可能不足以显著影响房价变化。但是，如果您只想获得基于最小均方误差的预测，这不会影响您的预测。</p><p id="a408" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">那么我们该怎么办？</strong>如果你只是想得到预测，那就随它去吧。如果要选择重要的预测因素，在构建模型和预测后，应该绘制图表以查看预测误差的分布。</p><p id="8c89" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了更好地说明，我创建了 1 个随机正态分布样本和 1 个非正态分布样本，每个样本都有 1000 个数据点。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="850a" class="mv mw it mr b gy mx my l mz na">#create normal and nonnormal data sample<br/>import numpy as np<br/>from scipy import stats<br/>sample_normal=np.random.normal(0,5,1000)<br/>sample_nonnormal=x = stats.loggamma.rvs(5, size=1000) + 20</span></pre><p id="92d8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有许多方法可以检验数据的正态性，下面只是一些例子:</p><ol class=""><li id="39d7" class="nb nc it la b lb lc le lf lh nd ll ne lp nf lt ng nh ni nj bi translated">简单地画出分布曲线，看看曲线是否符合钟形曲线形状。非正态样本明显是左尾的。</li></ol><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="da75" class="mv mw it mr b gy mx my l mz na">import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>sns.distplot(sample_normal)<br/>plt.show()<br/>sns.distplot(sample_nonnormal)<br/>plt.show()</span></pre><div class="kj kk kl km gt ab cb"><figure class="nk kn nl nm nn no np paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/ac3cdf177428dd9df93ce1aa3a2662e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*u5Mb0WCf7f63qIAQdR0t9A.png"/></div></figure><figure class="nk kn nq nm nn no np paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/eea4e79c639ac914ffe4da88d781546f.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*vkJueYgzm-S33xmQSvdKOw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk nr di ns nt translated">正态分布样本的分布(左)；非正态分布样本的分布图(右)</p></figure></div><p id="02b1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">2.使用<a class="ae nu" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.shapiro.html" rel="noopener ugc nofollow" target="_blank">夏皮罗-维尔克测试</a>，内置的 python 库可用，您可以根据您决定的 p 值来决定，通常我们在 5%的显著性水平上拒绝 H0，这意味着如果 p 值大于 0.05，那么我们接受它为正态分布。注意，如果样本量大于 5000，就应该用检验统计量而不是 p 值作为指标来决定。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="75ca" class="mv mw it mr b gy mx my l mz na">print (stats.shapiro(sample_normal))<br/>print (stats.shapiro(sample_nonnormal))</span><span id="79c8" class="mv mw it mr b gy nv my l mz na">#Test Statistics, p-value<br/>#(0.9970424175262451, 0.06130971387028694) - H0 accepted<br/>#(0.9806660413742065, 2.945287624900317e-10) - H0 rejected</span></pre><p id="4a2c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">3.<a class="ae nu" href="https://www.statsmodels.org/stable/generated/statsmodels.graphics.gofplots.qqplot.html" rel="noopener ugc nofollow" target="_blank"> QQ 图</a>，一个非常流行的用来观察数据分布是否遵循正态分布的图。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="f643" class="mv mw it mr b gy mx my l mz na">fig = sm.qqplot(sample_normal,line='s')<br/>plt.show()<br/>fig = sm.qqplot(sample_nonnormal,line='s')<br/>plt.show()</span></pre><div class="kj kk kl km gt ab cb"><figure class="nk kn nw nm nn no np paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/4f5a2bdb65e2a0b196674b428192c1d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*1BsFxGzzOMVU0i8RffzzcA.png"/></div></figure><figure class="nk kn nx nm nn no np paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/8ff163d5162d981741e5a5ffc6437a2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*dUXFxR_-ivniyMGcVWLjJg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk ny di nz nt translated">正态分布 QQ-plot(左)；非正态分布 QQ 图(右)</p></figure></div><h2 id="73f4" class="mv mw it bd oa ob oc dn od oe of dp og lh oh oi oj ll ok ol om lp on oo op oq bi translated">我们如何解决常态问题:</h2><p id="33c7" class="pw-post-body-paragraph ky kz it la b lb or ju ld le os jx lg lh ot lj lk ll ou ln lo lp ov lr ls lt im bi translated">通常，出现此问题(误差不符合正态分布)有两个原因:</p><ol class=""><li id="5833" class="nb nc it la b lb lc le lf lh nd ll ne lp nf lt ng nh ni nj bi translated">因变量或自变量太不正常(可以从变量的偏斜度或峰度看出)</li><li id="b945" class="nb nc it la b lb ow le ox lh oy ll oz lp pa lt ng nh ni nj bi translated">存在一些干扰模型预测的异常值/极值</li></ol><p id="ff92" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们应该做的是首先检查因变量和自变量中是否存在异常值。如果去除异常值不能解决问题，那么我们应该使用 box-cox 变换将一些非正态变量转换为正态分布。</p><p id="dd3c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是 Box-Cox 变换的数学公式。将基于数据点来决定λ值，以在变换后提供最佳的正态分布形状。我们可以直接使用<a class="ae nu" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.boxcox.html" rel="noopener ugc nofollow" target="_blank"> Python 包</a>来帮助我们转换数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/77c4613d1f5d7d43908b2504fa06e928.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*_vXfmcxyVPu6c8qr4-nEcg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Box-Cox 变换数学公式</p></figure><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="0451" class="mv mw it mr b gy mx my l mz na">#transform the data using box-cox<br/>sample_transformed, lambd = stats.boxcox(sample_nonnormal)</span><span id="4a75" class="mv mw it mr b gy nv my l mz na">#plot the distribution curve and QQ-plot for transformed data<br/>sns.distplot(sample_transformed)<br/>plt.show()<br/>fig = sm.qqplot(sample_transformed,line='s')<br/>plt.show()</span></pre><div class="kj kk kl km gt ab cb"><figure class="nk kn pc nm nn no np paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/84235dc198b209b9876f63001c3c27e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*fzJBDjSM3cugi5Zi95uf9g.png"/></div></figure><figure class="nk kn pd nm nn no np paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/5bace03723dcb83946341feee9b442f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*dSV8R1omn9ay_zVAVIy2aQ.png"/></div></figure></div><p id="04bd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以看到，经过 box-cox 变换后，非正态分布的样本是正态分布的。</p><p id="c2ac" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">总之，如果您试图找到一个重要的预测因子或定义置信区间，请记住在模型建立后检查误差项的分布。如果因变量或自变量非常非正态，那么可以使用 box-cox 变换对其进行变换，使误差项更加正态分布。</p><p id="af36" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您认为在构建模型之前，您已经完成了所有的统计假设检查了吗？不，你不是！如果你想了解更多关于回归模型中的其他统计假设，请参考我下面另一篇关于多重共线性的文章。</p><div class="pe pf gp gr pg ph"><a rel="noopener follow" target="_blank" href="/multi-collinearity-in-regression-fe7a2c1467ea"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd iu gy z fp pm fr fs pn fu fw is bi translated">回归中的多重共线性</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">为什么这是个问题？如何跟踪和修复它</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">towardsdatascience.com</p></div></div><div class="pq l"><div class="pr l ps pt pu pq pv ks ph"/></div></div></a></div></div></div>    
</body>
</html>