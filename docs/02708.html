<html>
<head>
<title>How to sort months chronologically in Power BI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Power BI中按时间顺序排列月份</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-sort-months-chronologically-in-power-bi-73dac77850e1?source=collection_archive---------8-----------------------#2020-03-16">https://towardsdatascience.com/how-to-sort-months-chronologically-in-power-bi-73dac77850e1?source=collection_archive---------8-----------------------#2020-03-16</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="8c45" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">了解如何在Power BI中按时间顺序对月份字段进行排序</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/d28bc6fff2acff95cd3b390f1d0e7b95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZwEJvHiXINkL5MIcNbujnQ.jpeg"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated">图片来自<a class="ae kw" href="https://unsplash.com/photos/LtNvQHdKkmw" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="d5b8" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在本文中，我将演示如何在Power BI中按时间顺序对月份进行排序。可视化一段时间内的销售数据是最有影响力的报告方式之一。通常，设计图表来显示指标随时间的趋势或增长是非常重要的。时间段可以是任何时间，例如几天、几周、几个月或几年。它基本上让您了解指标在特定时间段内是如何增加或减少的。</p><p id="b86e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在Power BI中，您还可以按特定的选定时间段可视化您的指标。这通常通过绘制显示一段时间内趋势的折线图来实现，或者通过使用垂直条形图来显示该时间段内的特定指标，甚至简单地使用表格矩阵来以文本方式显示结果。出于本文的考虑，为了简单起见，我们将只考虑第三种情况，即表格矩阵。然而，同样的解决方案可以适用于任何类型的包含时间段的图表。</p><p id="6e19" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">有时，当您将数据导入Power BI时，特别是如果您在原始数据源中有月或季度作为文本数据(来自平面文件的<em class="lt">，那么Power BI无法理解导入的字段是否是实际的日期字段(日/月/年等)。)或者只是简单的文本数据。在这种情况下，在导入后，月份或季度按字母顺序排序，而不是按时间顺序排序，这是一个错误，取决于需求和与开发趋势报告不太相关的东西。在这个解决方案中，我们将首先学习如何重现错误，然后了解如何对数据模型进行必要的更改以解决这个错误，并在Power BI中按时间顺序对月份进行排序。</em></p><h1 id="2425" class="lu lv ir bd lw lx ly lz ma mb mc md me jx mf jy mg ka mh kb mi kd mj ke mk ml bi translated">重现错误</h1><p id="a52b" class="pw-post-body-paragraph kx ky ir kz b la mm js lc ld mn jv lf lg mo li lj lk mp lm ln lo mq lq lr ls ik bi translated">让我们首先试着重现这个错误，然后我将解释如何在幂BI中按时间顺序排列月份。为了重现错误，我们需要创建一个简单的CSV文件，如下图所示。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj mr"><img src="../Images/c855a7ab5a8da951ec382c4683941a6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/0*jJIuWM9WwZKh5q1F.png"/></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图1 — CSV数据集</em></p></figure><p id="da9b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">如上图所示，我们只有两个简单的列— <em class="lt">月</em>和<em class="lt">销售</em>。<em class="lt">月</em>列出了从“1月”到“12月”的所有值以及相应的<em class="lt">销售额</em>值。一旦创建了CSV文件，下一步就是打开Power BI并将其连接到这个数据集。</p><p id="24ca" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">打开Power BI Desktop，按照以下步骤将该数据提取到Power BI数据模型中:</p><p id="2752" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">选择<strong class="kz is">获取数据</strong>，并从出现的菜单中选择<strong class="kz is">文本/CSV </strong>。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj mt"><img src="../Images/e4b47a35c42901c4ea3727be53b2a4f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/0*2xDUfaFmZRyFXvY6.png"/></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图2 —获取功率BI中的数据</em></p></figure><p id="cf35" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">浏览上一步刚创建的文件，点击<strong class="kz is">打开。</strong></p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mu"><img src="../Images/4fa02f583f60eee0264fd85358c28310.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ARxOHupeYVqSdnf9.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图3 —浏览数据集</em></p></figure><p id="fbd1" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在出现的下一个对话框中，验证数据并点击<strong class="kz is">加载。</strong></p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mv"><img src="../Images/b734e4ccfbdecf2197a02ac8441b2fe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UJL0ad23cjopj-5S.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图4 —将数据加载到Power BI模型中</em></p></figure><p id="b633" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">您将看到数据已经加载到Power BI中。</p><p id="628b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">点击<em class="lt">可视化</em> <em class="lt">窗格</em>中的<strong class="kz is">表格</strong>，将字段拖放到如图所示的表格中。</p><p id="c8cb" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在创建的新表中，您可以看到月份现在按字母顺序排序。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj mw"><img src="../Images/9976fad37b1c8699bff000b7f9177290.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/0*DhbLEsE9zh5Z7wuw.png"/></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图5 —创建表格</em></p></figure><p id="1411" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在Power BI桌面中，选择<strong class="kz is">转换数据</strong>，然后点击<strong class="kz is">转换数据。</strong></p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mx"><img src="../Images/4562ca18e92fbfcadb0e950845c111e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8NmXL3bPrQZP3iIo.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图6 —转换数据</em></p></figure><p id="a85c" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在打开的<strong class="kz is"> Power Query Editor </strong>中，导航到打开的<strong class="kz is"> Add Column </strong>选项卡。</p><p id="2762" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">选择<strong class="kz is">自定义栏</strong>，输入公式，如下图所示。</p><p id="b867" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">对于自定义列的名称，我使用“<strong class="kz is"> Date </strong>”，因为该列将存储虚拟日期值。</p><p id="b98a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在自定义列的公式中，使用以下内容:= " 1 " &amp;[月] &amp; " 2020"。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj my"><img src="../Images/65faee1cd58c61b34323cebb0b8999f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_Gw-OPcyDqoexJYo.png"/></div></div></figure><p id="b535" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><em class="lt">图7 —添加虚拟日期列</em></p><p id="d2e9" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">因此，基本上，我们试图实现的只是创建一个虚拟日期值，方法是将“1”作为日期，将“2020”作为年份值添加到已经存在的月份中。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mz"><img src="../Images/f0ab5adaa540c01bb23b2aef7b781dc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ft1hZGmHuHRd-Jsp.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图8 —增加了新的日期栏</em></p></figure><p id="925b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">下一步是将这个新字段<strong class="kz is"> Date </strong>转换为<em class="lt"> date数据类型</em>。右键点击该列，选择<strong class="kz is">更改类型</strong>，然后选择<strong class="kz is">日期。</strong></p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj na"><img src="../Images/be5561226ab783ff00d47e2a2c2fdead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XDlC_RTaPjpPLgjo.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图9 —改变数据类型</em></p></figure><p id="bf05" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">您可以看到该列的数据类型和值已经更改。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nb"><img src="../Images/aed437a4cc4e9f0a6d8b006d96446060.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JAySOw9A8C5t98ux.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图10 —更改了数据类型</em></p></figure><p id="1596" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们现在将再添加一个自定义列，从该字段中提取月份数。点击<strong class="kz is">添加列</strong>，然后点击<strong class="kz is">自定义列。</strong></p><p id="32b4" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">提供字段名称为“<strong class="kz is">月份号</strong>”，公式为“=日期”。月份([日期])”并点击<strong class="kz is">确定。</strong></p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nc"><img src="../Images/cd695dfebef59b4bc995eb79fb90aed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yQwkynAigTgn0roK.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图11 —添加新的月份号列</em></p></figure><p id="c663" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在，您将看到数据集中又添加了一列。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nc"><img src="../Images/bb05725b83eef89ef51266d49999f3b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QgfOoWdESdPzgvOr.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图12 —增加了新的月份号列</em></p></figure><p id="825d" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们将把这个字段的数据类型改为整数。右键点击<strong class="kz is">月份号</strong>，选择<strong class="kz is">更改类型</strong>，然后选择<strong class="kz is">整数。</strong></p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nd"><img src="../Images/fcdd59a63ae80527c91325e5500869c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HVoZhVfABGHi3dCG.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图13 —将数据类型更改为整数</em></p></figure><p id="f1a3" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">由于我们的数据模型中有了所需的字段<strong class="kz is"> MonthNumber </strong>，我们可以删除在前面的步骤中创建的虚拟日期字段。右键单击<strong class="kz is">日期</strong>栏并选择<strong class="kz is">移除。</strong></p><p id="1373" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">最后，您可以通过导航到<strong class="kz is">主页</strong>并选择<strong class="kz is">关闭和应用来关闭Power Query编辑器窗口。</strong></p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj ne"><img src="../Images/9b1cf2fc1aa06d2bb4389b2bbebfce64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ofS-eeeptnAGtoza.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图15 —关闭电源查询编辑器</em></p></figure><h1 id="d3e0" class="lu lv ir bd lw lx ly lz ma mb mc md me jx mf jy mg ka mh kb mi kd mj ke mk ml bi translated">在Power BI中选择按时间顺序排列月份的列</h1><p id="5a51" class="pw-post-body-paragraph kx ky ir kz b la mm js lc ld mn jv lf lg mo li lj lk mp lm ln lo mq lq lr ls ik bi translated">既然我们已经在数据模型中进行了必要的更改，以在Power BI中按时间顺序对月份进行排序，那么最后一步就是按照<strong class="kz is"> MonthNumber </strong>的升序对<strong class="kz is">月份</strong>进行排序。请按照下面的步骤对月份进行排序。</p><p id="85dc" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">点击左侧窗格上的<strong class="kz is">数据</strong>选项卡。</p><p id="7cf7" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">选择<strong class="kz is">月</strong>列，然后在上方工具栏的<strong class="kz is">排序</strong>窗格中选择<strong class="kz is">按列排序</strong>。</p><p id="75b5" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在出现的下拉菜单中，选择<strong class="kz is">月份号</strong>并导航至<strong class="kz is">报告</strong>选项卡。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nf"><img src="../Images/19bb152aa2a1f347ab467c9763d0c5ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*J_lOnnQ6rFeJJpeg.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图16 —按月号排序</em></p></figure><p id="28a3" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">您现在可以看到，月份是按时间顺序而不是字母顺序排序的。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj ng"><img src="../Images/6114da8f1f86c8d916a7e85aebe2a361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4dB24y1IotKRpN5G.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图17——按时间顺序排列的月份幂BI </em></p></figure><p id="a9c7" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">此外，如果您想隐藏<strong class="kz is">月份号</strong>字段，您只需右击它并选择<strong class="kz is">隐藏</strong>。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj nh"><img src="../Images/c27c188d167a295582d8975c1bebff7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/0*yyQ5e4TTrPskFMCl.png"/></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图18 —隐藏月份号字段</em></p></figure><p id="a2d6" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">您将拥有原始CSV文件中的数据集，但月份是按时间顺序排序的。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj ni"><img src="../Images/1a5b5730a42731f69267c41578cb85ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rb_wGYzJt8DqAHZL.png"/></div></div><p class="ks kt gk gi gj ku kv bd b be z dk translated"><em class="ms">图19——以幂BI形式按时间排序的月份</em></p></figure><h1 id="653a" class="lu lv ir bd lw lx ly lz ma mb mc md me jx mf jy mg ka mh kb mi kd mj ke mk ml bi translated">结论</h1><p id="a399" class="pw-post-body-paragraph kx ky ir kz b la mm js lc ld mn jv lf lg mo li lj lk mp lm ln lo mq lq lr ls ik bi translated">在本文中，我解释了如何在Power BI中按时间顺序对月份进行排序。我还提到了复制错误的步骤，然后提供了如何解决问题并最终获得预期结果的分步指导。</p></div><div class="ab cl nj nk hv nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ik il im in io"><p id="a46c" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><em class="lt">原载于2020年3月16日https://www.sqlshack.com</em><a class="ae kw" href="https://www.sqlshack.com/how-to-sort-months-chronologically-in-power-bi/" rel="noopener ugc nofollow" target="_blank"><em class="lt"/></a><em class="lt">。</em></p></div></div>    
</body>
</html>