<html>
<head>
<title>The Box Plot Guide I Wish I Had When I Started Learning R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当我开始学习 R 的时候，我希望我有这个盒子情节指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-box-plot-guide-i-wish-i-had-when-i-started-learning-r-d1e9705a6a37?source=collection_archive---------30-----------------------#2020-08-12">https://towardsdatascience.com/the-box-plot-guide-i-wish-i-had-when-i-started-learning-r-d1e9705a6a37?source=collection_archive---------30-----------------------#2020-08-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="eecf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">信息数据可视化是 R！我提供了一些有用的技巧来定制你的情节，使它们更有信息量和色盲友好。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a757a5574229cea51ba1ab9b5b9c3698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*HALR-CLoJL5XMJQxvV04ng.gif"/></div></div></figure><p id="edae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在 R 语言中，定制一个图形来将其转换成一个漂亮的图形并不是炼金术。尽管如此，我还是花了很多时间(也很沮丧)来弄清楚如何让这些情节具有知识性和出版质量。我想分享我用来绘制数据的代码，解释它的每一部分是做什么的，而不是像龙掌管它的宝藏一样囤积这些信息。</p><p id="fe7f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，让我们加载我们的包并生成一个虚拟数据集，其中包含一个自变量和一个连续因变量。在代码片段之前，我将讨论我们将使用的函数和参数。我们还预先为我们的分类变量设定了一个顺序。</p><h2 id="a39a" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">虚拟数据集:函数和参数</h2><ul class=""><li id="e3e5" class="mj mk it kw b kx ml la mm ld mn lh mo ll mp lp mq mr ms mt bi translated"><strong class="kw iu"> runif </strong>生成 100 个介于 0 和 1 之间的数字</li><li id="8728" class="mj mk it kw b kx mu la mv ld mw lh mx ll my lp mq mr ms mt bi translated"><strong class="kw iu">抽样</strong>随机抽取数字 1 或 2，100 次</li><li id="bde9" class="mj mk it kw b kx mu la mv ld mw lh mx ll my lp mq mr ms mt bi translated"><strong class="kw iu">因子</strong>为我们的分组变量设置了一个首选顺序</li></ul><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="6ec1" class="lq lr it na b gy ne nf l ng nh">### Load packages<br/>install.packages('ggplot2')<br/>install.packages('RColorBrewer')<br/>install.packages('ggpubr')<br/>library(ggplot2)<br/>library(RColorBrewer)<br/>library(ggpubr)</span><span id="dec7" class="lq lr it na b gy ni nf l ng nh">#Create dummy dataset<br/>ndf &lt;- data.frame(<br/>  value     = rep(runif(100)), <br/>  factor1   = as.char(rep(sample(1:2, replace = TRUE, 100))<br/>)<br/>ndf$factor1 = factor(ndf$factor1, levels = c('1', '2'))</span></pre><h2 id="83d4" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">箱形图:函数和参数</h2><ul class=""><li id="4270" class="mj mk it kw b kx ml la mm ld mn lh mo ll mp lp mq mr ms mt bi translated"><strong class="kw iu"> ggplot </strong>允许我们指定自变量和因变量，以及用于图表的数据集</li><li id="ba72" class="mj mk it kw b kx mu la mv ld mw lh mx ll my lp mq mr ms mt bi translated"><strong class="kw iu"> stat_boxplot </strong>让我们指定添加到绘图上的胡须类型</li><li id="0b7f" class="mj mk it kw b kx mu la mv ld mw lh mx ll my lp mq mr ms mt bi translated"><strong class="kw iu"> geom_boxplot </strong>指定图形中盒子的自变量和因变量</li></ul><p id="3290" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第一次基本的尝试并没有很大的信息量或视觉吸引力。我们首先关注绘制第一个独立变量，<em class="nj"> factor1。</em>我也不喜欢 ggplot 内默认的灰色主题。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="55ae" class="lq lr it na b gy ne nf l ng nh">plot_data &lt;- ggplot(ndf, aes(y = value, x = factor1)) +<br/>  stat_boxplot( aes(y = value, x = factor1 ), <br/>                geom='errorbar', width=0.5) +<br/>  geom_boxplot(aes(y = value, x =  factor1))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8931b27ce2a563717aa8b8e43681f743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hYKzMf3l1nc5c-wPmYKADw.png"/></div></div><p class="nk nl gj gh gi nm nn bd b be z dk translated">由作者在 R 中生成</p></figure><h2 id="200c" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">带点的方框图:函数和参数</h2><ul class=""><li id="f973" class="mj mk it kw b kx ml la mm ld mn lh mo ll mp lp mq mr ms mt bi translated"><strong class="kw iu"> theme_bw() </strong>为剧情设置黑白主题，去掉讨厌的灰色背景</li><li id="fd8d" class="mj mk it kw b kx mu la mv ld mw lh mx ll my lp mq mr ms mt bi translated"><strong class="kw iu">geom _ dot plot:</strong><em class="nj">binaxis</em>指定哪个变量将与点一起显示。其他参数指定了点的外观，而<em class="nj"> binwidth </em>指定了我们希望在绘图的同一行中有多少个点。如果你想让点透明，使用<em class="nj"> alpha </em>参数，它可以让你指定点的不透明度从 0 到 1。</li></ul><p id="9bc7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们的情节更丰富了，但仍需要改进。我们想修改一些颜色，轴和标签。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="2cb9" class="lq lr it na b gy ne nf l ng nh">plot_data &lt;- ggplot(ndf, aes(y = value, x = factor1)) +<br/>    stat_boxplot( aes(y = value, x = factor1 ), <br/>                  geom='errorbar', width = 0.5) +<br/>    geom_boxplot(aes(y = value, x =  factor1)) +<br/>      theme_bw() +<br/>      geom_dotplot(binaxis='y', <br/>                   stackdir = "center", <br/>                   binwidth = 1/20,<br/>                   dotsize = 1, <br/>                   aes(fill = factor1))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/adb868ae165d9d3b277811d2d4fe60f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cnTedWzJpp7HZfBMlq-y4Q.png"/></div></div></figure><h2 id="94f6" class="lq lr it bd ls lt lu dn lv lw lx dp ly ld lz ma mb lh mc md me ll mf mg mh mi bi translated">为小事流汗</h2><ul class=""><li id="b48a" class="mj mk it kw b kx ml la mm ld mn lh mo ll mp lp mq mr ms mt bi translated"><strong class="kw iu"> scale_fill_manual </strong>让我们为自变量的特定值设置特定的颜色</li><li id="8dfb" class="mj mk it kw b kx mu la mv ld mw lh mx ll my lp mq mr ms mt bi translated"><strong class="kw iu"> xlab 和 ylab </strong>允许我们分别标记 x 轴和 y 轴。如果你把换行符后面的转义字符放入标题中(\n)，它将在下一行继续标签的其余部分！</li><li id="00fa" class="mj mk it kw b kx mu la mv ld mw lh mx ll my lp mq mr ms mt bi translated">命名你的情节</li><li id="54b1" class="mj mk it kw b kx mu la mv ld mw lh mx ll my lp mq mr ms mt bi translated">主题是脚本中非常可定制的部分。它让我们可以定制任何我们想要的参数。由于我不喜欢放置在 ggplots 中的默认网格，我将<em class="nj"> element_blank </em>归属于几个面板参数，以消除绘图周围的边界。我把轴涂成黑色而不是灰色。我还用<em class="nj"> plot_margin </em>指定了图形周围需要多少空白空间。因为这个情节很简单，所以我们去掉了这个例子的图例。通过各种<em class="nj"> axis_text </em>参数，我设置了 axis 文本和标签的大小、字体、颜色和位置。</li><li id="8120" class="mj mk it kw b kx mu la mv ld mw lh mx ll my lp mq mr ms mt bi translated"><strong class="kw iu"> scale_y_continuous </strong>设置 y 轴以 0.2 为间隔从 0 增加到 1。通过将剧情的限制扩大到 1 以上，给了标题更多的喘息空间。如果我需要使用带有离散变量名称的 y 轴，我可以使用不同的参数——scale _ y _ discrete。</li><li id="bacd" class="mj mk it kw b kx mu la mv ld mw lh mx ll my lp mq mr ms mt bi translated"><strong class="kw iu"> scale_x_discrete </strong>让我重新标记两个独立变量。这使您可以快速重命名编码数据。我把自变量重新标为丹尼·德维托和尼古拉斯·凯奇。让我们假设我们正在看尼克·凯奇和丹尼·德维托在票房上的表现，使用 0 到 1 之间的分数。</li><li id="f9a6" class="mj mk it kw b kx mu la mv ld mw lh mx ll my lp mq mr ms mt bi translated"><strong class="kw iu"> stat_compare_means </strong>允许您进行统计测试。这个是给你探索的！只需键入<strong class="kw iu"> stat_compare_means( </strong>并按 tab 键即可探索您可用的不同选项。不然可以打字？stat_compare_means 获取该功能的帮助手册！</li></ul><p id="7c0f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你想知道代码中不同元素的 hjust 和 vjust，它只允许我们改变文本元素的位置。我通过改变箱线图的颜色以及点的填充来添加一些光斑。如果您正在构建一个繁忙的地块，检查可访问性也很重要。你可以用这个工具找到色盲友好调色板:<a class="ae no" href="https://colorbrewer2.org/" rel="noopener ugc nofollow" target="_blank">https://colorbrewer2.org/</a>。</p><p id="f078" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了方便起见，我将代码中的任何变化都加粗，以便于理解。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="d391" class="lq lr it na b gy ne nf l ng nh">plot_data &lt;- ggplot(ndf, <br/>                    aes(y = value, x = factor1, <strong class="na iu">color = factor1</strong>))+<br/>                    scale_color_manual(values = <br/>                                       c(<strong class="na iu">'1' = 'blue'</strong>, <br/>                                         <strong class="na iu">'2' = 'firebrick4'</strong>)) +<br/>      stat_boxplot( aes(y = value, x = factor1 ), <br/>                    geom='errorbar', width = 0.5) +<br/>      geom_boxplot(aes(y = value, x =  factor1), shape = 2)+<br/>                         theme_bw() +<br/>        geom_dotplot(binaxis='y', <br/>                     stackdir = "center", <br/>                     binwidth = 1/20,<br/>                     dotsize = 1,<br/>                     aes(fill = factor1)) + <br/>  <strong class="na iu">scale_fill_manual(values = c('1' = '</strong>#0571b0<strong class="na iu">', '2' = '#ca0020'))</strong> +<br/>  <strong class="na iu">xlab("Independent\nVariable") + ylab("Dependent\nVariable") +<br/>  ggtitle("Box-Dot Plot") +<br/>  theme(  panel.grid.major = element_blank(),<br/>          panel.grid.minor = element_blank(), <br/>          axis.line = element_line(colour = "black"), <br/>          panel.border = element_blank(), <br/>          plot.margin=unit(c(0.5,0.5, 0.5,0.5),"cm"), <br/>          legend.position="none", <br/>          axis.title.x= element_text(size=14, color = 'black', vjust = 0.5),<br/>          axis.title.y= element_text(size=14, color = 'black', vjust = 0.5),<br/>          axis.text.x = element_text(size=12, color = 'black'),<br/>          axis.text.y = element_text(size=14, color = 'black'),<br/>          plot.title  = element_text(hjust = 0.5, size=16, face = 'bold', vjust = 0.5)) +<br/>    scale_y_continuous(expand = c(0,0), breaks = seq(0,1,0.2),<br/>                   limits = c(0,1.1)) +<br/>    scale_x_discrete(labels = c('Nicholas Cage', 'Danny DeVito'))<br/></strong>    <strong class="na iu">stat_compare_means(method = 't.test', hide.ns = FALSE, size = 4,   vjust = 2)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fef0e9977850bb87df000f11e60a5685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sPRmOQEULO3vrdAFla3aqQ.png"/></div></div></figure><p id="b5ea" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在很短的时间内，我们已经从一个简单的箱线图变成了一个视觉上更吸引人、更容易理解的图，为我们提供了关于各个数据点的更多信息。无论何时需要绘制数据，您都可以保存代码并随意修改。这使得定制过程更加容易！没有更多的(好吧，也许少很多)计算机防御！</p><p id="50b1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你想下载代码，可以在这里找到:<a class="ae no" href="https://github.com/simon-sp/R_ggplot_basic_dotplot" rel="noopener ugc nofollow" target="_blank">https://github.com/simon-sp/R_ggplot_basic_dotplot</a>。我在代码中留下了大量的注释，以防您遇到困难！请记住，在 RStudio 中，在函数前放置一个问号会为您带来一个说明指南！</p></div></div>    
</body>
</html>