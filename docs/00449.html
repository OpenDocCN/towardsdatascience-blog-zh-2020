<html>
<head>
<title>The exponential adoption of Tesla in the Netherlands</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">特斯拉在荷兰的迅速普及</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-exponential-adoption-of-tesla-in-the-netherlands-9bda9c0b56d8?source=collection_archive---------35-----------------------#2020-01-13">https://towardsdatascience.com/the-exponential-adoption-of-tesla-in-the-netherlands-9bda9c0b56d8?source=collection_archive---------35-----------------------#2020-01-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a9fa" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用 BigQuery、云存储和 Data Studio 探索 RDW 车牌数据集</h2></div><p id="dfbd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated">去年，在荷兰的高速公路上，我注意到路上的特斯拉数量一直在迅速增加。</p><p id="2951" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这有几个很好的理由。荷兰政府通过税收优惠积极支持全电动(租赁)汽车的采用。此外，最新的 Model 3 是第一款价格相对友好的特斯拉，约为 6 万欧元，而不是 10 万欧元以上。</p><p id="4df2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了验证我的观察，我将通过 RDW 探索一个开放的数据集。RDW(荷兰车辆管理局)负责车辆的许可，他们提供荷兰所有许可车辆的每日更新数据集。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/684b617584cfda3c937a25adec4250ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M9xbKJnE917u25Ef"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">照片由<a class="ae md" href="https://unsplash.com/@ort?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Bram Van Oost </a>在<a class="ae md" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="3866" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">正在准备数据…</h1><p id="8a43" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">首先，让我们<a class="ae md" href="https://opendata.rdw.nl/en/Voertuigen/Open-Data-RDW-Gekentekende_voertuigen/m9d7-ebf2" rel="noopener ugc nofollow" target="_blank">下载</a>数据集(更新日期:2020 年 1 月 10 日)。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nb"><img src="../Images/86f44563cf49dda78597e87f1a64ead9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X6fyjfrxmqQMf6zIw6hvkA.png"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">所有荷兰车辆在一个大的 CSV，好吃！</p></figure><p id="cfda" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">CSV(约 7.7GB)太大，无法导入电子表格，因此我们将使用谷歌的 Pb 级数据工具<a class="ae md" href="https://cloud.google.com/bigquery/" rel="noopener ugc nofollow" target="_blank"> BigQuery </a>来处理这些数据。</p><p id="1594" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为 BigQuery 将手动 CSV 上传限制为 10MB，所以我们需要首先将我们的文件上传到<a class="ae md" href="https://cloud.google.com/storage/" rel="noopener ugc nofollow" target="_blank">云存储</a>中的存储桶:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nc"><img src="../Images/e4ccdb5cbf6e9cbd795898fa697f8612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EMwLr1qYx1LDNlh755q__w.png"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">云存储桶</p></figure><p id="e112" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们通过选择云存储中的文件在 BigQuery 中创建新表，设置表名<code class="fe nd ne nf ng b">kentekens_2020</code>、模式设置<code class="fe nd ne nf ng b">auto-detect</code>、字段分隔符<code class="fe nd ne nf ng b">comma</code>和要跳过的标题行<code class="fe nd ne nf ng b">1</code>。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nh"><img src="../Images/29bf2fb9e7d1303de0c5ba811a0eb2b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Q0oEy0oa09OAADvDPcjwQ.png"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">在 BigQuery 中创建我们的表</p></figure><p id="0090" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">几秒钟后，表就创建好了，我们的数据集就可以开始研究了。当我们查看详细信息时，有 1440 万行等待查询。根据该模式，有 64 列。这意味着我们的表包含了近十亿个字段。).每行代表一辆注册了牌照的汽车。</p><h1 id="fe0a" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">我们来查询一下！</h1><p id="2656" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">因为我们只对乘用车数据感兴趣，所以我们通过对<code class="fe nd ne nf ng b">Voertuigsoort</code>(车辆类别)应用过滤器来排除所有其他类别。让我们把所有的车按品牌分组，然后数数。</p><pre class="lo lp lq lr gt ni ng nj nk aw nl bi"><span id="f4e8" class="nm mf it ng b gy nn no l np nq">SELECT<br/>  merk AS brand,<br/>  COUNT(*) AS cars<br/>FROM<br/>  `&lt;project&gt;.RDW_kentekens.kentekens_2020`<br/>WHERE<br/>  Voertuigsoort = 'Personenauto'<br/>GROUP BY<br/>  brand<br/>ORDER BY<br/>  cars DESC</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nr"><img src="../Images/1b83bc5720df9089555fb983c385c453.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dxl4glC95fSkzTjzgCmRmA.png"/></div></div></figure><p id="e4f3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">获胜者是…大众！要查看 Tesla 的排名，我们可以向下滚动，但我们也可以在 Data Studio 中显示我们的结果。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ns"><img src="../Images/9598dd89fb998ff943ae00eb9404f607.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rlcD6WNtpV1pMVrE6PzzQA.png"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">水平条形图 FTW！</p></figure><p id="54a9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们到了。我们发现泰斯拉排名 29。如果你仔细看，你还会发现“特斯拉汽车公司”。这意味着我们无法在品牌过滤器中进行精确匹配。我们希望所有品牌包含(小写或大写)<code class="fe nd ne nf ng b">tesla</code>。</p><p id="b179" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们统计特斯拉汽车占所有乘用车的百分比。</p><pre class="lo lp lq lr gt ni ng nj nk aw nl bi"><span id="a01c" class="nm mf it ng b gy nn no l np nq">SELECT<br/>  all_cars,<br/>  tesla_cars,<br/>  ROUND(tesla_cars/all_cars*100,2) AS percentage_tesla_cars<br/>FROM (<br/>  SELECT<br/>    COUNT(*) AS all_cars,<br/>    (<br/>    SELECT<br/>      COUNT(*)<br/>    FROM<br/>      `&lt;project&gt;.RDW_kentekens.kentekens_2020`<br/>    WHERE<br/>      LOWER(merk) LIKE '%tesla%') AS tesla_cars,<br/>  FROM<br/>    `&lt;project&gt;.RDW_kentekens.kentekens_2020`<br/>  WHERE<br/>    Voertuigsoort = 'Personenauto')</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nt"><img src="../Images/7489d6be3461ff6b5a52d4fae365f66f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Yejdqc2nOEJ6_2mLnwuig.png"/></div></div></figure><p id="b8e8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2020 年初，将近 50000 辆特斯拉正在荷兰的街道上漫游。这大约是荷兰所有乘用车的 0.5%。这些数字还没有打动我。</p><p id="4bff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了回答我们最初的问题(荷兰道路上的特斯拉数量是否呈指数增长？)我们需要在一个时间框架内绘制这些数字。因此，我们使用列<code class="fe nd ne nf ng b">Datum_eerste_afgifte_Nederland</code>，它给出了特定汽车在荷兰首次注册的日期。</p><p id="2fa0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从我们的数据中排除许多老前辈(第一辆汽车甚至在大战前就获得了许可，数据质量警报！)我们只看 2008 年及以后的数据。根据维基百科的说法，第一辆特斯拉是在那一年交付给埃隆·马斯克个人的。</p><pre class="lo lp lq lr gt ni ng nj nk aw nl bi"><span id="c919" class="nm mf it ng b gy nn no l np nq">SELECT<br/>  Datum_eerste_afgifte_Nederland AS date,<br/>  CASE<br/>    WHEN merk LIKE '%TESLA%' THEN 'TESLA'<br/>  ELSE<br/>  merk<br/>END<br/>  AS brand,<br/>  COUNT(*) AS cars<br/>FROM<br/>  `&lt;project&gt;.RDW_kentekens.kentekens_2020`<br/>WHERE<br/>  Voertuigsoort = 'Personenauto'<br/>  AND Datum_eerste_afgifte_Nederland &gt;= 20080101<br/>GROUP BY<br/>  date,<br/>  brand<br/>ORDER BY<br/>  date</span></pre><p id="55d6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们在 Data Studio 中研究这个查询的结果，我们会得到一个折线图，其中显示了排名前 20 位的品牌。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nu"><img src="../Images/c34274300fd1c54dd10259ce7179a668.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bm2MuP6Ja-annq0kzGl1WQ.png"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">有人看到我的特斯拉吗？</p></figure><p id="4e74" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于特斯拉在前 20 名中无处可寻，我们不得不对品牌<code class="fe nd ne nf ng b">TESLA</code>设置一个包含过滤器，以便看到我们期望看到的趋势。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ns"><img src="../Images/669351017b937e0548f8613e4c4f8f9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L-uOEI4ZvXChZFP0JzR2mA.png"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">嘣！</p></figure><p id="aad9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那里！我观察到荷兰道路上的特斯拉数量迅速增加，这似乎得到了数据的证实。</p><h1 id="3348" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">深入挖掘</h1><p id="39b8" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">下一步是调查荷兰在全球特斯拉生产供应中的份额。我在<a class="ae md" href="https://en.wikipedia.org/wiki/Tesla,_Inc.#Sales" rel="noopener ugc nofollow" target="_blank">维基百科</a>上找到了一些数字，做了一些数据清理，产生了这个小 CSV，我直接把它作为表格上传到 BigQuery:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nv"><img src="../Images/923f17ba0e55621800dad1f4ed7894c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KNR39JFGxU0-sTcOitdyIA.png"/></div></div></figure><p id="c7c5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们可以把这些数字和我们自己的数据联系起来。</p><pre class="lo lp lq lr gt ni ng nj nk aw nl bi"><span id="37f3" class="nm mf it ng b gy nn no l np nq">WITH<br/>  p AS (<br/>  SELECT<br/>    CAST(year AS string) AS year,<br/>    production<br/>  FROM<br/>    `&lt;project&gt;.RDW_kentekens.production` ),<br/>  k AS (<br/>  SELECT<br/>    CASE<br/>      WHEN CAST(Datum_eerste_afgifte_Nederland AS string) LIKE '2014%' THEN '2014'<br/>      WHEN CAST(Datum_eerste_afgifte_Nederland AS string) LIKE '2015%' THEN '2015'<br/>      WHEN CAST(Datum_eerste_afgifte_Nederland AS string) LIKE '2016%' THEN '2016'<br/>      WHEN CAST(Datum_eerste_afgifte_Nederland AS string) LIKE '2017%' THEN '2017'<br/>      WHEN CAST(Datum_eerste_afgifte_Nederland AS string) LIKE '2018%' THEN '2018'<br/>      WHEN CAST(Datum_eerste_afgifte_Nederland AS string) LIKE '2019%' THEN '2019'<br/>    ELSE<br/>    NULL<br/>  END<br/>    AS date,<br/>    CASE<br/>      WHEN merk LIKE '%TESLA%' THEN 'TESLA'<br/>    ELSE<br/>    merk<br/>  END<br/>    AS brand,<br/>    COUNT(*) AS cars<br/>  FROM<br/>    `&lt;project&gt;.RDW_kentekens.kentekens_2020`<br/>  WHERE<br/>    Voertuigsoort = 'Personenauto'<br/>    AND Datum_eerste_afgifte_Nederland BETWEEN 20140101<br/>    AND 20191231<br/>  GROUP BY<br/>    date,<br/>    brand<br/>  HAVING<br/>    brand = 'TESLA')<br/>SELECT<br/>  date,<br/>  brand,<br/>  cars,<br/>  production,<br/>  ROUND(cars/production*100,1) AS percentage_dutch_teslas<br/>FROM<br/>  k<br/>LEFT JOIN<br/>  p<br/>ON<br/>  k.date = p.year<br/>ORDER BY<br/>  date DESC</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nw"><img src="../Images/4010a01b3503338ec5d06e61fda0fa04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*APiMUj8zPGaZIPwZHs987Q.png"/></div></div></figure><p id="2bed" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意粉红线。这是荷兰特斯拉占全球年产量的百分比。2019 年生产的所有特斯拉汽车中，有 8.5%是同年在荷兰获得许可的。对于这样一个小国来说，这是相当大的份额！</p><p id="9a33" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好的。接下来让我们关注最畅销的型号，并在 Data Studio 中显示前 10 名。</p><pre class="lo lp lq lr gt ni ng nj nk aw nl bi"><span id="e388" class="nm mf it ng b gy nn no l np nq">SELECT<br/>  Datum_eerste_afgifte_Nederland AS date,<br/>  CASE<br/>    WHEN merk LIKE '%TESLA%' THEN 'TESLA'<br/>  ELSE<br/>  merk<br/>END<br/>  AS brand,<br/>  Handelsbenaming AS model,<br/>  COUNT(*) AS cars<br/>FROM<br/>  `&lt;project&gt;.RDW_kentekens.kentekens_2020`<br/>WHERE<br/>  Voertuigsoort = 'Personenauto'<br/>  AND Datum_eerste_afgifte_Nederland &gt;= 20080101<br/>GROUP BY<br/>  date,<br/>  brand,<br/>  model<br/>ORDER BY<br/>  date</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nx"><img src="../Images/5d2a0adae0ac1c59f3d8825a14105cae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wAoZJZQIDg4K3bDxURb1vA.png"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">你好模型 3！</p></figure><p id="2efc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">似乎 Model 3 是荷兰最畅销的产品。其他特斯拉车型呢？有没有 2008 年的特斯拉跑车？</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nr"><img src="../Images/7037a5021d97b20b678f1a399c08f8f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNd0KyCgw8LLpHZaCP4Q1g.png"/></div></div></figure><p id="33a9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有了 24 排，我们有一些清洁工作要做，因为特斯拉没有 24 种不同的型号。我们还可以按日期查询车型，以便搜索我们的 2008 款跑车。</p><pre class="lo lp lq lr gt ni ng nj nk aw nl bi"><span id="7ff1" class="nm mf it ng b gy nn no l np nq">SELECT<br/>  Datum_eerste_afgifte_Nederland AS date,<br/>  CASE<br/>    WHEN merk LIKE '%TESLA%' THEN 'TESLA'<br/>  ELSE<br/>  merk<br/>END<br/>  AS brand,<br/>  CASE<br/>    WHEN Handelsbenaming LIKE '%MODEL 3%' THEN 'MODEL 3'<br/>    WHEN Handelsbenaming LIKE '%MODEL S%' THEN 'MODEL S'<br/>    WHEN Handelsbenaming LIKE '%MODEL X%' THEN 'MODEL X'<br/>    WHEN Handelsbenaming LIKE '%R__DSTER%' THEN 'ROADSTER'<br/>  ELSE<br/>  NULL<br/>END<br/>  AS model,<br/>  COUNT(*) AS cars<br/>FROM<br/>  `&lt;project&gt;.RDW_kentekens.kentekens_2020`<br/>WHERE<br/>  Voertuigsoort = 'Personenauto'<br/>  AND merk LIKE 'TESLA%'<br/>  AND Datum_eerste_afgifte_Nederland &gt;= 20080101<br/>GROUP BY<br/>  date,<br/>  brand,<br/>  model<br/>HAVING<br/>  model IS NOT NULL<br/>ORDER BY<br/>  cars DESC</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ny"><img src="../Images/f19c558a83559a81df963f6db08c508c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qi6qXuA47AXn6ouyu_lWIw.png"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">特斯拉玩具十年</p></figure><p id="8d4f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首批跑车于 2009 年第四季度抵达荷兰。这些司机是一些真正的早期采用者。让我们看看该季度的前四位车主是否仍然驾驶同一辆车！</p><pre class="lo lp lq lr gt ni ng nj nk aw nl bi"><span id="d98c" class="nm mf it ng b gy nn no l np nq">SELECT<br/>  Datum_eerste_afgifte_Nederland AS date,<br/>  Datum_tenaamstelling AS ownership_date,<br/>  CASE<br/>    WHEN merk LIKE '%TESLA%' THEN 'TESLA'<br/>  ELSE<br/>  merk<br/>END<br/>  AS brand,<br/>  CASE<br/>    WHEN Handelsbenaming LIKE '%MODEL 3%' THEN 'MODEL 3'<br/>    WHEN Handelsbenaming LIKE '%MODEL S%' THEN 'MODEL S'<br/>    WHEN Handelsbenaming LIKE '%MODEL X%' THEN 'MODEL X'<br/>    WHEN Handelsbenaming LIKE '%R__DSTER%' THEN 'ROADSTER'<br/>  ELSE<br/>  NULL<br/>END<br/>  AS model,<br/>  kenteken AS license_plate,<br/>  CASE<br/>    WHEN Datum_eerste_afgifte_Nederland = Datum_tenaamstelling THEN 'TRUE'<br/>  ELSE<br/>  'FALSE'<br/>END<br/>  AS first_owner<br/>FROM<br/>  `&lt;project&gt;.RDW_kentekens.kentekens_2020`<br/>WHERE<br/>  Voertuigsoort = 'Personenauto'<br/>  AND merk LIKE 'TESLA%'<br/>  AND Datum_eerste_afgifte_Nederland &gt; 20080101<br/>GROUP BY<br/>  date,<br/>  ownership_date,<br/>  brand,<br/>  model,<br/>  license_plate<br/>HAVING<br/>  model IS NOT NULL<br/>  AND model = 'ROADSTER'<br/>  AND date &lt; 20100101<br/>ORDER BY<br/>  date</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nz"><img src="../Images/53c179545be71a03d3ac2b3b6d7e53f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lH0M5syuUS5SYItYJO3arA.png"/></div></div></figure><p id="7f76" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们有赢家了！这个坏男孩(或女孩)仍然像 2009 年一样开车。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/f27245150a81bc078b1f45cd7cc34f4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*R5hpSqmgU-MYuYrr1_hKdw.png"/></div></figure><p id="faca" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一辆特斯拉呢？他们还被第一个主人许可吗？我们会找到答案的。</p><pre class="lo lp lq lr gt ni ng nj nk aw nl bi"><span id="e6c5" class="nm mf it ng b gy nn no l np nq">SELECT<br/>  brand,<br/>  model,<br/>  ROUND(COUNT(CASE<br/>        WHEN first_owner = 'TRUE' THEN 1<br/>      ELSE<br/>      NULL<br/>    END<br/>      )/ COUNT(first_owner)*100,1) AS percentage_first_owners<br/>FROM (<br/>  SELECT<br/>    Datum_eerste_afgifte_Nederland AS date,<br/>    Datum_tenaamstelling AS ownership_date,<br/>    CASE<br/>      WHEN merk LIKE '%TESLA%' THEN 'TESLA'<br/>    ELSE<br/>    merk<br/>  END<br/>    AS brand,<br/>    CASE<br/>      WHEN Handelsbenaming LIKE '%MODEL 3%' THEN 'MODEL 3'<br/>      WHEN Handelsbenaming LIKE '%MODEL S%' THEN 'MODEL S'<br/>      WHEN Handelsbenaming LIKE '%MODEL X%' THEN 'MODEL X'<br/>      WHEN Handelsbenaming LIKE '%R__DSTER%' THEN 'ROADSTER'<br/>    ELSE<br/>    NULL<br/>  END<br/>    AS model,<br/>    kenteken AS license_plate,<br/>    CASE<br/>      WHEN Datum_eerste_afgifte_Nederland = Datum_tenaamstelling THEN 'TRUE'<br/>    ELSE<br/>    'FALSE'<br/>  END<br/>    AS first_owner<br/>  FROM<br/>    `&lt;project&gt;.RDW_kentekens.kentekens_2020`<br/>  WHERE<br/>    Voertuigsoort = 'Personenauto'<br/>    AND merk LIKE 'TESLA%'<br/>    AND Datum_eerste_afgifte_Nederland &gt; 20080101<br/>  GROUP BY<br/>    date,<br/>    ownership_date,<br/>    brand,<br/>    model,<br/>    license_plate<br/>  HAVING<br/>    model IS NOT NULL<br/>  ORDER BY<br/>    date)<br/>GROUP BY<br/>  brand,<br/>  model<br/>ORDER BY<br/>  percentage_first_owners DESC</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ob"><img src="../Images/a86eb815c35481388edad5cf8bd8bcb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MgL7F9QelmSeZql8umuIDg.png"/></div></div></figure><p id="c5e9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">原来特斯拉车主都挺喜欢自己的车的。</p><p id="e154" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好了，现在结束。仍然有很多数据可以利用，但我会把荷兰特斯拉目录价格的发展留给你(根据 RDW)。</p><pre class="lo lp lq lr gt ni ng nj nk aw nl bi"><span id="4883" class="nm mf it ng b gy nn no l np nq">SELECT<br/>  Datum_eerste_afgifte_Nederland AS date,<br/>  CASE<br/>    WHEN merk LIKE '%TESLA%' THEN 'TESLA'<br/>  ELSE<br/>  merk<br/>END<br/>  AS brand,<br/>  CASE<br/>    WHEN Handelsbenaming LIKE '%MODEL 3%' THEN 'MODEL 3'<br/>    WHEN Handelsbenaming LIKE '%MODEL S%' THEN 'MODEL S'<br/>    WHEN Handelsbenaming LIKE '%MODEL X%' THEN 'MODEL X'<br/>    WHEN Handelsbenaming LIKE '%R__DSTER%' THEN 'ROADSTER'<br/>  ELSE<br/>  NULL<br/>END<br/>  AS model,<br/>  ROUND(AVG(catalogusprijs)) AS price<br/>FROM<br/>  `&lt;project&gt;.RDW_kentekens.kentekens_2020`<br/>WHERE<br/>  Voertuigsoort = 'Personenauto'<br/>  AND merk LIKE 'TESLA%'<br/>  AND Datum_eerste_afgifte_Nederland &gt; 20080101<br/>GROUP BY<br/>  date,<br/>  brand,<br/>  model<br/>HAVING<br/>  model IS NOT NULL<br/>ORDER BY<br/>  date DESC</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi oc"><img src="../Images/792185c218e17e857434820aac100f09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uwsVdl_6ga4d2Vwm9i8Ntg.png"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">荷兰每年每辆特斯拉车型的平均价格(欧元)</p></figure><p id="4586" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="od">注:我每天都在学习，欢迎在评论区添加您的意见和建议，或者通过</em> <a class="ae md" href="https://www.linkedin.com/in/johanvdwerken/" rel="noopener ugc nofollow" target="_blank"> <em class="od"> LinkedIn </em> </a> <em class="od">联系我。</em></p></div></div>    
</body>
</html>