<html>
<head>
<title>Synthetic Instrumental Variables</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">合成工具变量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/synthetic-instrumental-variables-968b12f68772?source=collection_archive---------35-----------------------#2020-09-10">https://towardsdatascience.com/synthetic-instrumental-variables-968b12f68772?source=collection_archive---------35-----------------------#2020-09-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1935" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">具有不可测混杂因素的因果推断</h2></div><p id="454b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我喜欢能让你走的报纸”这在事后看来是显而易见的。为什么以前没人尝试过？”一些 NLP 的人对变形金刚做了这样的评论(“<a class="ae le" href="https://arxiv.org/pdf/1706.03762.pdf" rel="noopener ugc nofollow" target="_blank">注意力是你所需要的全部</a>”)。对我来说，“<a class="ae le" href="https://arxiv.org/pdf/1805.06826.pdf" rel="noopener ugc nofollow" target="_blank">多重原因的祝福</a>”唤起了类似的感觉:为什么人们没有创造合成乐器？</p><h1 id="23e0" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">先决条件</h1><p id="ebcd" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">本文假设对因果 Dag 和因果推理有基本的了解。如果你对这些术语不熟悉，请阅读<a class="ae le" rel="noopener" target="_blank" href="/beyond-a-b-testing-primer-on-causal-inference-d8e462d90a0b">我之前关于因果关系的文章</a>的后三分之一，以获得简要概述。</p><p id="abdc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，虽然有许多方法可以创建合成工具，但本文使用概率 PCA，因为它是最通用的方法之一。如果你对 PCA 不太了解，建议看一下这篇<a class="ae le" href="https://stats.stackexchange.com/questions/2691/making-sense-of-principal-component-analysis-eigenvectors-eigenvalues" rel="noopener ugc nofollow" target="_blank">精彩直观的讲解</a>。</p><h1 id="e87c" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">什么是乐器？</h1><p id="2021" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated"><a class="ae le" href="https://en.wikipedia.org/wiki/Instrumental_variables_estimation" rel="noopener ugc nofollow" target="_blank">工具变量</a>由来已久，可以说是计量经济学的中坚力量之一。我们关心的是这个 DAG:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mc"><img src="../Images/4398e38513e2a14bdf940ac742e83f14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7uWVCYEsxzfsVxGoIHMfiw.png"/></div></div></figure><p id="85fe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">u 是一个未观察到的混杂因素。我们要估计 Y 对 Z 的因果作用，Y → Z，通过这个 DAG，我们可以估计 X → Y 和 X → Z，假设线性，我们有 X → Z = (X → Y) (Y → Z)，我们可以代数求解 Y → Z。</p><p id="03ac" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个设置中，我们称 X 为工具变量，如果:</p><ul class=""><li id="59ae" class="mo mp it kk b kl km ko kp kr mq kv mr kz ms ld mt mu mv mw bi translated">x 与 Y 强相关(强第一阶段)</li><li id="22c3" class="mo mp it kk b kl mx ko my kr mz kv na kz nb ld mt mu mv mw bi translated">x 仅通过 Y 影响 Z(排除限制)</li></ul><p id="1afa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在实践中，找到一种工具是困难的。如果 X 与 Y 仅弱相关，那么因果效应估计可能会严重偏差。第二个条件无法测试或验证，所以我们只能争论假设的合理性，比如“蛋黄酱是一种工具吗？”</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nc"><img src="../Images/0239f2513a6972a18a4fd4c121411eff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*edntJ0BrtJSi_5Daho0dHg.jpeg"/></div></div><p class="nd ne gj gh gi nf ng bd b be z dk translated">图片由<a class="ae le" href="https://pxhere.com/en/photo/1620864" rel="noopener ugc nofollow" target="_blank">玛丽亚·波尔娜</a></p></figure><p id="739b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创新要求我们重新思考现有的方法。聪明之处在于:</p><blockquote class="nh"><p id="5da3" class="ni nj it bd nk nl nm nn no np nq ld dk translated">如果寻找乐器很难，为什么不创造乐器呢？</p></blockquote><h1 id="3246" class="lf lg it bd lh li lj lk ll lm ln lo lp jz nr ka lr kc ns kd lt kf nt kg lv lw bi translated">问题设置</h1><p id="1baa" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">原论文标题为“<a class="ae le" href="https://arxiv.org/pdf/1805.06826.pdf" rel="noopener ugc nofollow" target="_blank">多重因缘的祝福</a>”，因为多重因缘是创造我们自己的工具的必要条件。DAG 看起来有点像:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/f841e58f41952da57e01ed512911fd2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*xP0jLhLvNSMPw-lx7Br_dw.png"/></div></figure><p id="6641" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们希望在存在共享的未观察到的混杂因素 u 的情况下，推断每个 Y 对 Z 的因果影响。可以将 Y 视为回归模型中的列名和预测值。我们假设没有干扰，没有互动——这当然过于简单，但很实用。</p><p id="d6fb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个 DAG 看起来是限制性的，但是对于许多现实世界的过程来说，它是足够合理的(参考本文中的例子)。更重要的是，与直觉相反，这个问题比单一案例要简单得多:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nv"><img src="../Images/05a7b6529cc7db4b074d512c6bac3dde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*1LkiGWoFxTGMlMjGfXanpg.png"/></div></div></figure><p id="ff1e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个“更简单”的 DAG 是不可能求解的。我们无法对因果关系做出无偏见的估计。</p><p id="68a9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，这个问题假设没有未被观察到的单一原因混杂因素。未观察到的 V 的存在会打乱我们的估计:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/0d9942db205b49f64ee50b0d563a1d95.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*avyKQ3zWFk4YtZQ97wvN9w.png"/></div></figure><p id="468d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，正如论文指出的，假设不存在这样的 V 是一个比不可忽略更令人舒服的假设。大多数使用协变量调整的因果分析假设我们根本没有不可测量的混杂因素。这里我们假设<em class="nx">一些</em>不可测量的常见混杂因素，只是没有不可测量的单一原因混杂因素。</p><h1 id="c42c" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">创建工具</h1><p id="8109" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">现在我们将看到为什么多重因果关系是必要的。我们希望创建一个通用的仪器 X。这个 X 是一个局部变量，即每个观测值都有一个唯一的 X 向量(稍后将详细介绍)。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/37dd5fb74702354841d25c1f49b93080.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*J6NLkdFfAdQRG4wpH5B7Zg.png"/></div></figure><p id="ed0a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我们可以拟合 PCA 并选择前几个主成分作为我们的 x。通过构造，排除限制得到满足，因为 PCA 不使用 z。我们不必为这一假设争论不休。</p><p id="7e8f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，如果使用整个数据集来训练 PCA，我们不知道 X 是否是好的工具。我们可以从随机噪声中获得主要成分，但 X 不能很好地预测 Y。此外，重新使用 Y 来估计仪器和因果效应在哲学上是有问题的，并将导致过度拟合。</p><p id="64a6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一种思路是将数据集一分为二，在一半上使用 PCA，在另一半上执行推理。这导致了一个死胡同。对于看不见的数据(后半部分)，我们对每个观察值的最佳猜测是 X =零向量，这简化为 OLS 回归。找出新方法的全部意义在于，我们知道 OLS 是行不通的。</p><p id="7739" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文通过删除每个观察值的随机 Y 来解决这个问题(比如说，一半)。经典 PCA 不能处理缺失值。概率主成分分析(PPCA)，它的贝叶斯对应物，可以很好地处理缺失值。</p><p id="bc2a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">PCA 使用 y = Wx 对每个观察值的 y 向量进行建模，其中 W 是权重矩阵，x 是潜在变量的向量。PPCA 假设存在高斯误差项ε，使得 y = Wx + ε。生成模型:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nz"><img src="../Images/9e3b22f937b3582e6aa558d6f15a51d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2migbaAEEYi3TolivrWVnQ.png"/></div></div></figure><p id="f823" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当σ → 0 时，我们得到 PCA。如果我们用允许对角线值变化的对角矩阵代替σ I，我们得到<a class="ae le" href="https://en.wikipedia.org/wiki/Factor_analysis" rel="noopener ugc nofollow" target="_blank">因子分析</a>。</p><p id="d7d2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以:</p><ul class=""><li id="ff97" class="mo mp it kk b kl km ko kp kr mq kv mr kz ms ld mt mu mv mw bi translated">我们可以使用 y 的一半来估计每个观测值的潜在向量 X。通过构造，X 满足排除限制。</li><li id="f659" class="mo mp it kk b kl mx ko my kr mz kv na kz nb ld mt mu mv mw bi translated">我们可以用删除的一半来评估 X 的预测性能。换句话说，给定观察到的一半，我们能预测删除的一半吗？我们可以测试一个强大的第一阶段。</li></ul><p id="c2be" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果 X 具有良好的预测性能，那么我们有一个从 Y 综合创建的<strong class="kk iu">有效的</strong>工具(具体来说，在 PPCA 的情况下，残差是工具)。或者，由于 X 的概率性质，我们可以使用<a class="ae le" href="https://www.math.mcgill.ca/dstephens/SISCER2020/Articles/HIrano-Imbens-2004.pdf" rel="noopener ugc nofollow" target="_blank">广义倾向得分</a>来拟合潜在的结果模型，并获得因果效应估计。</p><h1 id="1b17" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">结束语</h1><p id="86a3" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">这听起来好得难以置信吗？也许吧。但是合成控制也有代价:偏差-方差权衡<a class="ae le" href="https://en.wikipedia.org/wiki/Bias%E2%80%93variance_tradeoff" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="6d0a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">创建合成仪器的贝叶斯模型具有其自身的估计不确定性，因此在消除偏差的同时增加了方差。作者建议遵循<a class="ae le" href="https://en.wikipedia.org/wiki/Occam%27s_razor" rel="noopener ugc nofollow" target="_blank">奥卡姆剃刀</a>。在 PPCA 的情况下，每个额外的主成分都会增加方差，因此我们希望保留最少数量的成分，但仍能产生“良好”的预测性能。</p><p id="1b3c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然本文使用了 PPCA，但是只要潜在变量模型能够处理缺失值，它们通常就能工作。例如，PPCA 不适用于计数数据，因为它假设高斯误差。</p></div></div>    
</body>
</html>