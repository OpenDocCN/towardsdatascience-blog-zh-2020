<html>
<head>
<title>Fast Real Estate Image Classification using Machine Learning with code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于带代码的机器学习的快速房地产图像分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fast-real-estate-image-classification-using-machine-learning-with-code-32e0539eab96?source=collection_archive---------38-----------------------#2020-08-21">https://towardsdatascience.com/fast-real-estate-image-classification-using-machine-learning-with-code-32e0539eab96?source=collection_archive---------38-----------------------#2020-08-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d85fd76e50b025b5e7ee00e3132adb47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lg3nyZauxa9bXHha.png"/></div></div></figure><p id="240d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">RoomNet 是一个非常轻量级(<em class="kw"> 700 KB </em>)和快速卷积神经网络，用于对一所房子/公寓的不同房间的图片进行分类，在 1839 张图片中具有<strong class="ka ir"> 88.9 %的验证准确性</strong>。我用 python 和<a class="kx ky ep" href="https://medium.com/u/b1d410cb9700?source=post_page-----32e0539eab96--------------------------------" rel="noopener" target="_blank"> TensorFlow </a>写了这个。</p><p id="2138" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">顺便说一句，我制作了这个艺术品，是的，我<em class="kw">实际上</em>不是三年级学生，尽管它引发了诱人的流行观点。</p><p id="5477" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一个我设计的自定义架构，用于将输入图像分类为以下 6 个类别之一(按照类别 id 的顺序)</p><blockquote class="kz la lb"><p id="5250" class="jy jz kw ka b kb kc kd ke kf kg kh ki lc kk kl km ld ko kp kq le ks kt ku kv ij bi translated"><strong class="ka ir">后院</strong> -0、<strong class="ka ir">浴室</strong> -1、<strong class="ka ir">卧室</strong> -2、<strong class="ka ir">前院</strong> -3、<strong class="ka ir">厨房</strong> -4、<strong class="ka ir">客厅</strong> -5</p></blockquote><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lf"><img src="../Images/392aff3d8cc4ce2ece16df45f0c8eb4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-nMQr8q-Xzr4L9Y-s2UbZg.png"/></div></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">照片来源按顺时针方向从左至右依次为<a class="ae lo" href="https://unsplash.com/@chastityco?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Chastity Cortijo </a>在<a class="ae lo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>(浴室)拍照、<a class="ae lo" href="https://unsplash.com/@rpnickson?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Roberto Nickson </a>在<a class="ae lo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>(卧室)拍照、<a class="ae lo" href="https://unsplash.com/@jsnbrsc?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Jason Briscoe </a>在<a class="ae lo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>(厨房)拍照、<a class="ae lo" href="https://unsplash.com/@notsazuki?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Shaun Montero </a>在<a class="ae lo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>(后院)拍照、<a class="ae lo" href="https://unsplash.com/@rpnickson?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Roberto Nickson 拍照</a></p></figure><h1 id="b0d3" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">建筑积木-</h1><p id="0088" class="pw-post-body-paragraph jy jz iq ka b kb mn kd ke kf mo kh ki kj mp kl km kn mq kp kq kr mr kt ku kv ij bi translated">这些模块用于构建最终的神经网络。它们由基本的基本神经层组成，如卷积、平均池和批量标准化。</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/ceb107bc4a73dd018702325eab894e37.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*plRavZ4UbVK3Em6mcePdSg.png"/></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">RoomNet 卷积块。这是最基本的块</p></figure><figure class="lg lh li lj gt jr gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/7a2775d506bbd2c4ba6cd183da9f3fb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*XGulR1FqWGdHJdb16ZdNnQ.png"/></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">RoomNet 剩余块。它由前面描述的卷积模块组成。</p></figure><figure class="lg lh li lj gt jr gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/9ab83455cbbb40d282bcd25a944531dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*YhvIiaTZV3N8JVQ9WVApqA.png"/></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">RoomNet 密集块。这将在最后从提取的图像特征中进行分类。</p></figure><h1 id="4812" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">完整的网络架构-</h1><p id="3727" class="pw-post-body-paragraph jy jz iq ka b kb mn kd ke kf mo kh ki kj mp kl km kn mq kp kq kr mr kt ku kv ij bi translated">使用上面描述的构建块，下面呈现的是具有相关参数的完整神经网络架构。</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/f0db4d79c102606887ff76ab2a9625e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*AqI-9ANWUCxCVnrSyBgeiw.png"/></div></figure><p id="b01c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">训练和部署它的代码可以在 GitHub 上找到</p><div class="mv mw gp gr mx my"><a href="https://github.com/ironhide23586/RoomNet" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd ir gy z fp nd fr fs ne fu fw ip bi translated">ironhide23586/RoomNet</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">一个卷积神经网络，以 88.9 %的验证准确率对房屋/公寓的不同房间的图片进行分类…</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">github.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm jw my"/></div></div></a></div><h1 id="63f5" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">创新推理-</h1><p id="e485" class="pw-post-body-paragraph jy jz iq ka b kb mn kd ke kf mo kh ki kj mp kl km kn mq kp kq kr mr kt ku kv ij bi translated">优化了<strong class="ka ir"> infer.py </strong>中的推理代码。参考<em class="kw"> main </em>方法中调用<em class="kw"> classify_im_dir </em>方法的短代码。</p><h1 id="8baf" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">培训-</h1><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/7340b9a74a829e12983bbceb8d78f3a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nCXD_XSUUvzro0dS.png"/></div></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">验证准确性</p></figure><ul class=""><li id="012e" class="no np iq ka b kb kc kf kg kj nq kn nr kr ns kv nt nu nv nw bi translated">输入图像尺寸= 224 x 224(尝试了 300 x 300，600 x 600)</li><li id="a302" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated"><em class="kw"> Softmax 交叉熵损失</em>与<em class="kw"> L2 权重归一化</em>一起使用</li><li id="5e8c" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated"><em class="kw">辍学</em>从 0(最初)到 0.3(间歇地接近训练结束)不等。放置在每个块之后的漏失层。</li><li id="123b" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated"><em class="kw">批量正常化</em>移动手段&amp;var 在中途退出训练时被冻结。</li><li id="d063" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated"><em class="kw"> Adam Optimizer </em>用于指数学习率衰减。</li><li id="6016" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated">最初接受批量计算批量移动方法/变量的培训。接下来是训练网络，通过在训练期间禁用该计算和使用冻结的平均值/变量。<em class="kw">导致验证准确度立即跃升约 20%</em><em class="kw">(在训练步长 150，000 附近明显)。我将很快发表另一篇深入研究这一现象的文章。</em></li><li id="c2e2" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated">批量大小从 8(开始时)到 45(接近训练结束时)不等，如-8-&gt; 32-&gt; 40-&gt; 45</li><li id="9561" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated">异步数据读取器采用基于队列的架构设计，即使批量较大，也能在训练期间实现快速数据 I/O。</li></ul><h1 id="082b" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">转换到推理优化版本-</h1><ul class=""><li id="7cfe" class="no np iq ka b kb mn kf mo kj oc kn od kr oe kv nt nu nv nw bi translated">从张量流图中丢弃了所有与反向传播/训练相关的计算节点。</li><li id="fa6d" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated">模型大小从大约 2 MB 减少到大约 800 KB。</li><li id="ef73" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated"><em class="kw"> network.py </em>包含定义名为“RoomNet”的模型的类</li><li id="a6cd" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated">输出是一个 excel 文件，将每个图像路径映射到其标签。还提供了将输入目录分割成对应于类名的目录，并自动将相关图像填充到其各自的目录中。</li></ul><h1 id="c05b" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">培训环境-</h1><ul class=""><li id="be39" class="no np iq ka b kb mn kf mo kj oc kn od kr oe kv nt nu nv nw bi translated">使用 Tensorlfow + CUDA 10.0 + cuDNN 在 NVIDIA GTX 1070 笔记本电脑级 GPU(带 8GB GPU 内存)上完成培训</li><li id="057f" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated">使用计算机系统是外星人 m17 r4 膝上型电脑。</li><li id="c924" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated">使用的 CPU 是英特尔酷睿 i7–6700 HQ 处理器，带有 8 个逻辑内核，基本速度为 2.6 GHz(睿频加速至约 3.3 GHz)</li><li id="6ca8" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated">从零开始到达到最佳模型的训练步骤数为 157，700。</li><li id="b957" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated">花在培训上的时间——大约 48 小时</li></ul><h1 id="682a" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">以前的方法尝试过-</h1><ul class=""><li id="ee35" class="no np iq ka b kb mn kf mo kj oc kn od kr oe kv nt nu nv nw bi translated">尝试训练最后的密集 NASnet 移动，但准确率从未超过 60%。</li><li id="b86e" class="no np iq ka b kb nx kf ny kj nz kn oa kr ob kv nt nu nv nw bi translated">在 InceptionV3 中尝试了同样的方法，但是收敛时间太长了。</li></ul><h1 id="fe43" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">性能图-</h1><h2 id="25a7" class="of lq iq bd lr og oh dn lv oi oj dp lz kj ok ol md kn om on mh kr oo op ml oq bi translated">验证班级 F 分数</h2><p id="8132" class="pw-post-body-paragraph jy jz iq ka b kb mn kd ke kf mo kh ki kj mp kl km kn mq kp kq kr mr kt ku kv ij bi translated">F-Score 是精确度和召回率的调和平均值。</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi or"><img src="../Images/bc231944568f1f09c11cffaa1b21cd07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HdnA1_3BT2dtclAq.png"/></div></div></figure><h2 id="478d" class="of lq iq bd lr og oh dn lv oi oj dp lz kj ok ol md kn om on mh kr oo op ml oq bi translated">验证类级精度</h2><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi or"><img src="../Images/787f0bdb5d97d0510a2249b75c4139e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_3MByPVV4AisiFrm.png"/></div></div></figure><h2 id="b19a" class="of lq iq bd lr og oh dn lv oi oj dp lz kj ok ol md kn om on mh kr oo op ml oq bi translated">验证类级召回</h2><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi or"><img src="../Images/708d018d1866783d4142fdf6196b664f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zc8EL6RYqE0nzvDF.png"/></div></div></figure><p id="efa6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">如果你觉得这很有帮助，请随时关注我的更多文章:)</em></p><p id="fa09" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我是以下出版物的编辑，该出版物发表了与 AI &amp; ML 在地球数字地图绘制中的使用相关的技术文章。请随时关注以保持更新:)</p><div class="mv mw gp gr mx my"><a href="https://medium.com/ai-ml-cv-in-enriching-digital-maps-navigation" rel="noopener follow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd ir gy z fp nd fr fs ne fu fw ip bi translated">数字制图中的机器学习和人工智能</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">策划尖端人工智能和人工智能研究文章，来自从事设备、边缘、云和混合领域工作的行业科学家…</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">medium.com</p></div></div><div class="nh l"><div class="os l nj nk nl nh nm jw my"/></div></div></a></div></div><div class="ab cl ot ou hu ov" role="separator"><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy oz"/><span class="ow bw bk ox oy"/></div><div class="ij ik il im in"><h1 id="6958" class="lp lq iq bd lr ls pa lu lv lw pb ly lz ma pc mc md me pd mg mh mi pe mk ml mm bi translated">我的个人资料-</h1><div class="mv mw gp gr mx my"><a href="https://www.linkedin.com/in/souham/" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd ir gy z fp nd fr fs ne fu fw ip bi translated">Souham (Sean) Biswas -高级数据科学家(深度学习/计算机视觉)- HERE Technologies…</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">我是芝加哥伊利诺伊理工大学的计算机科学毕业生。我感兴趣的领域包括机器学习、并行…</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">www.linkedin.com</p></div></div><div class="nh l"><div class="pf l nj nk nl nh nm jw my"/></div></div></a></div><div class="mv mw gp gr mx my"><a href="https://github.com/ironhide23586" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd ir gy z fp nd fr fs ne fu fw ip bi translated">ironhide23586 -概述</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">HERE Maps(一家宝马、奥迪、奔驰公司)的高级数据科学家。北极代码库贡献者驳回注册…</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">github.com</p></div></div><div class="nh l"><div class="pg l nj nk nl nh nm jw my"/></div></div></a></div><h1 id="0d89" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">临时演员—</h1><figure class="lg lh li lj gt jr"><div class="bz fp l di"><div class="ph pi l"/></div><p class="lk ll gj gh gi lm ln bd b be z dk translated">在<a class="kx ky ep" href="https://medium.com/u/48b36b89f6d6?source=post_page-----32e0539eab96--------------------------------" rel="noopener" target="_blank"> Twitch </a>上直播我🤪🤡</p></figure><p id="f8de" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我也是一名音乐家。这是我的<a class="kx ky ep" href="https://medium.com/u/94f5b1677695?source=post_page-----32e0539eab96--------------------------------" rel="noopener" target="_blank">音云</a>简介中的一个声音封面。</p><figure class="lg lh li lj gt jr"><div class="bz fp l di"><div class="pj pi l"/></div></figure><blockquote class="pk"><p id="f541" class="pl pm iq bd pn po pp pq pr ps pt kv dk translated"><em class="pu">谢谢:)</em></p></blockquote></div></div>    
</body>
</html>