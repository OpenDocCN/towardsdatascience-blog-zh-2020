<html>
<head>
<title>Using A Monte Carlo Simulation To Forecast Extreme Weather Events</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用蒙特卡罗模拟预测极端天气事件</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-a-monte-carlo-simulation-to-forecast-extreme-weather-events-d17671149d3e?source=collection_archive---------12-----------------------#2020-09-05">https://towardsdatascience.com/using-a-monte-carlo-simulation-to-forecast-extreme-weather-events-d17671149d3e?source=collection_archive---------12-----------------------#2020-09-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3351" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用蒙特卡罗模拟检验温度情况</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d620f998c03156a1f59422afc23e8c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xr54eYyY7g2Ntfx2Ng0Vkw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:图片来自<a class="ae ky" href="https://pixabay.com/photos/drop-wet-h2o-icicle-clean-cold-3065629/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="e7eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在之前的<a class="ae ky" rel="noopener" target="_blank" href="/limitations-of-arima-dealing-with-outliers-30cc0c6ddf33">文章</a>中，我概述了 ARIMA 等传统时间序列模型在预测极端温度值时的局限性，这些值本身就是时间序列中的异常值。</p><p id="cc32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在处理极值时，蒙特卡罗模拟在量化极端事件发生的概率方面可能是更好的解决方案。</p><h1 id="8a54" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">背景</h1><p id="e8e4" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在最后一个示例中，苏格兰 Braemar 的月平均最低温度值用于训练和验证 ARIMA 模型预测。这是使用从 1959 年 1 月到 2020 年 7 月的每月<a class="ae ky" href="https://www.metoffice.gov.uk/pub/data/weather/uk/climate/stationdata/braemardata.txt" rel="noopener ugc nofollow" target="_blank">英国气象局数据</a>完成的(包含公共部门信息<a class="ae ky" href="https://www.metoffice.gov.uk/about-us/legal/tandc#Agreement-to-terms-of-use" rel="noopener ugc nofollow" target="_blank">在开放政府许可 v1.0 下许可</a>)。</p><p id="a74c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，蒙特卡洛模拟建立在相同的数据上，试图生成一系列温度值的情景分析。</p><p id="d243" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们仔细看看数据本身。</p><p id="f15b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是布拉马的月平均最低温度:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/1e90d6594695cdd0272aa32e124864a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*KHV2lhLqNGsAOHrz9oA_pg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">资料来源:英国气象局</p></figure><p id="d27b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们更详细地分析时间序列。首先，让我们绘制一个分布直方图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/c991c96915c85111281ff68bb7248f1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*UaoKSROA-9eOFmM3aMFjbQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:Jupyter 笔记本输出</p></figure><p id="d483" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过查看直方图，我们可以看到分布显示负偏斜。我们来算一下这个来确认一下。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="4807" class="mz lw it mv b gy na nb l nc nd">&gt;&gt;&gt; series = value;<br/>&gt;&gt;&gt; skewness = series.skew();<br/>&gt;&gt;&gt; print("Skewness:");<br/>&gt;&gt;&gt; print(round(skewness,2));</span><span id="79ae" class="mz lw it mv b gy ne nb l nc nd">Skewness:<br/>-0.05</span></pre><p id="a635" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这个分析中，我们观察到分布是负偏态的，因此不一定遵循正态分布(至少不完全是)。</p><p id="1024" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是残差的 QQ 图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/249ad3c1a2b107ed55fd1b0ccdb2e1cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*A8UB2Fgo1XfIecYF5qjN3Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:Jupyter 笔记本输出</p></figure><p id="ff36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">特别是，我们可以看到上分位数的值偏离了正态分布线。中位温度为 2.2°C，平均温度为 2.72°C(布雷马尔是英国最冷的地区之一)，显著高于这一温度的值超出了正态分布的界限——我们预计，随着上分位数记录的温度降低，分布将呈现更为正常的形状。</p><p id="2d68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，模拟天气模式可能相当棘手，因为地理分布会有所不同。例如，赤道的温度分布将与两极的温度分布大不相同。在这方面，为了准确地模拟天气，理解所讨论的时间序列的分布是必要的。</p><h1 id="6470" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">蒙特 卡罗模拟</h1><p id="92e6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">对于此模拟，将生成 1000 个随机值。由于该分布已被确定为负偏态，这意味着生成的随机值也必须遵循类似的负偏态分布。</p><h2 id="ca91" class="mz lw it bd lx ng nh dn mb ni nj dp mf li nk nl mh lm nm nn mj lq no np ml nq bi translated">预测每月最低温度</h2><p id="77c0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为此，可以使用<strong class="lb iu"> scipy </strong>库中的<a class="ae ky" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.skewnorm.html" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"/></a><strong class="lb iu"/>。如前所述，a(或偏斜参数)设置为<strong class="lb iu"> -0.05 </strong>。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="2189" class="mz lw it mv b gy na nb l nc nd">from scipy.stats import skewnorm<br/>a=-0.05<br/>distribution = skewnorm.rvs(a, size=1000)</span></pre><p id="9eee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是生成的数组的示例:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="08e4" class="mz lw it mv b gy na nb l nc nd">array([ 1.10993586e-01,  1.92293755e+00, -1.29797928e+00, -1.36817895e+00,<br/>       -4.08836917e-01, -2.20566871e-01, -1.80936352e+00,<br/>...<br/>-1.59656083e-01,  2.10239315e+00,  1.98068918e-01, -2.23784665e-01])</span></pre><p id="0f08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是生成数据的图表，显示了非常轻微的负偏差:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/e3f9a9727e971bc2bbca8207df346cda.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*gEa_Qad-7MdyKwoq4QMSPA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:Jupyter 笔记本输出</p></figure><p id="ae0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">原始系列的平均值和标准差计算如下:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="77ef" class="mz lw it mv b gy na nb l nc nd">&gt;&gt;&gt; mu=np.mean(value)<br/>&gt;&gt;&gt; mu<br/>2.7231393775372124</span><span id="a4e2" class="mz lw it mv b gy ne nb l nc nd">&gt;&gt;&gt; sigma=np.std(value)<br/>&gt;&gt;&gt; sigma<br/>4.082818933287181</span></pre><p id="65d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，形成假设分布的生成的随机数乘以 sigma(标准偏差)，然后将乘积加到 mu(平均值)。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="12e4" class="mz lw it mv b gy na nb l nc nd">y = mu + sigma*distribution<br/>num_bins = 50</span></pre><p id="e7e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里是本程序的另一个例子<a class="ae ky" href="https://gawron.sdsu.edu/python_for_ss/course_core/book_draft/visualization/Normal_Distribution.html" rel="noopener ugc nofollow" target="_blank">(假设正态分布)。让我们生成一个温度模拟直方图:</a></p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="e6ea" class="mz lw it mv b gy na nb l nc nd"># Histogram<br/>plt.hist(y, num_bins, facecolor='green', alpha=0.5)<br/>plt.xlabel('Values')<br/>plt.ylabel('Frequency')<br/>plt.title(r'Histogram of Temperature Simulations')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/1d31180fca692094c757d248b762bc8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*HM_NSpZp214mvSaOlyDhIQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:Jupyter 笔记本输出</p></figure><p id="2ba9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你会注意到最低模拟温度-11.32°C 刚好低于原始数据中记录的最低月平均温度值-8.6°C。从这个角度来看，该模型在估计每月可能出现的极端最小值方面做得相当好。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/1482dc4011b14e8403f0cab3b3bf4a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*DC2_H3N2O15Ki-VSw91Gsg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:Jupyter 笔记本输出</p></figure><h2 id="4209" class="mz lw it bd lx ng nh dn mb ni nj dp mf li nk nl mh lm nm nn mj lq no np ml nq bi translated">预测每日最低温度</h2><p id="9d53" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">也就是说，这个例子中的一个限制是我们处理的是月度数据，而不是每日数据。</p><p id="3dfe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们希望预测最低的每日最低温度。这个模型在这个场景中有用吗？</p><p id="db87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实上，1982 年 1 月 10 日<a class="ae ky" href="https://www.metoffice.gov.uk/research/climate/maps-and-data/uk-climate-extremes" rel="noopener ugc nofollow" target="_blank"> Braemar </a>记录的最低<strong class="lb iu">日最低温度</strong>为-27.2 摄氏度，这大大超过了蒙特卡洛模型模拟的最低温度-11.32 摄氏度。</p><p id="b201" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这表明，分布可能比月度数据显示的更加负偏。使用每日数据可能会显示更大的负偏差，对于蒙特卡洛模拟可能会提供更多信息。</p><p id="454c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将<strong class="lb iu"> a </strong>(我们的偏斜参数)降低到-2，看看会发生什么。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/3076ab045432ad936dcc9c4d12e9709c.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*JJ7x1Iav7tIQ9lbQ_ugIYA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:Jupyter 笔记本输出</p></figure><p id="5c14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">记录的最低月平均温度为-12.34 摄氏度。这仍然比记录的最低日温度高得多。</p><p id="31a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这方面，虽然蒙特卡罗模拟对月度数据建模有用，但这种模拟仍然无法补偿我们没有所需数据的情况。</p><p id="f1d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很有可能，Braemar 的每日温度数据将意味着一个更加负偏态的分布。也就是说，该系列的平均值和标准偏差也可能会有很大变化-如果不知道这些参数，那么蒙特卡罗模拟在估计每日值方面会受到限制。</p><p id="f377" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们有正确的数据时，蒙特卡罗模拟可能是强大的——但它不一定能弥补数据的缺乏。</p><h1 id="52fa" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="6c15" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这是如何使用蒙特卡罗模拟来模拟极端天气事件的介绍。</p><p id="f05c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">特别是，我们看到:</p><ul class=""><li id="23e0" class="nt nu it lb b lc ld lf lg li nv lm nw lq nx lu ny nz oa ob bi translated">确定相关时间序列的正确分布的重要性</li><li id="5313" class="nt nu it lb b lc oc lf od li oe lm of lq og lu ny nz oa ob bi translated">在 scipy 中使用<strong class="lb iu"> skewnorm </strong>生成具有定义偏斜的随机数</li><li id="5320" class="nt nu it lb b lc oc lf od li oe lm of lq og lu ny nz oa ob bi translated">用于识别极端电势值的蒙特卡罗模拟的实现</li></ul><p id="2464" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢您的宝贵时间，非常感谢您的任何问题或反馈。你可以在这里找到这个例子的 GitHub 库<a class="ae ky" href="https://github.com/MGCodesandStats/arima-model-statsmodels-python" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="174f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="oh">免责声明:本文是在“原样”的基础上编写的，没有任何担保。本文旨在提供数据科学概念的概述，不应以任何方式解释为专业建议。本文中的发现和解释是作者的，不以任何方式得到英国气象局的认可或隶属于该局。</em></p></div></div>    
</body>
</html>