<html>
<head>
<title>Learn how to master groupby function in Python now</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">现在学习如何掌握Python中的groupby函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learn-how-to-master-groupby-function-in-python-now-4620dd463224?source=collection_archive---------31-----------------------#2020-05-01">https://towardsdatascience.com/learn-how-to-master-groupby-function-in-python-now-4620dd463224?source=collection_archive---------31-----------------------#2020-05-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b09e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Pandas中的GroupBy比SQL中的groupby更加复杂和强大。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e9fefa6042d81502e61972430de9a30d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*F0ajFnQSe0gkK36p"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">麦克斯韦·尼尔森在T2的照片</p></figure><p id="5bae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">熊猫套餐中一个受欢迎的功能是分组功能。相信之前用熊猫的几乎都一定也用过groupby功能。它之所以如此受欢迎，是因为它有效地提供了概括而详细的结果。如熊猫包装文件所述，</p><blockquote class="me mf mg"><p id="c418" class="kz la mh lb b lc ld ju le lf lg jx lh mi lj lk ll mj ln lo lp mk lr ls lt lu im bi translated">“分组依据”指的是涉及一个或多个以下步骤的过程:</p><p id="97d5" class="kz la mh lb b lc ld ju le lf lg jx lh mi lj lk ll mj ln lo lp mk lr ls lt lu im bi translated"><strong class="lb iu">根据某些标准将数据分组</strong>。</p><p id="4c99" class="kz la mh lb b lc ld ju le lf lg jx lh mi lj lk ll mj ln lo lp mk lr ls lt lu im bi translated"><strong class="lb iu">将</strong>功能独立应用于每组。</p><p id="0e98" class="kz la mh lb b lc ld ju le lf lg jx lh mi lj lk ll mj ln lo lp mk lr ls lt lu im bi translated"><strong class="lb iu">将</strong>结果组合成一个数据结构。<em class="it">【1】</em></p></blockquote><p id="fed7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SQL中还有一个groupby函数。因此对于有SQL经验的人来说，学习Python中的groupby函数并不是一件困难的事情。但问题是Pandas中的groupby可以执行比SQL更多的分析，这使得Pandas中的groupby成为一个常见但重要的函数。</p><p id="735a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">熊猫里的groupby之所以更厉害，是因为第二步“申请”。在SQL中,“应用”步骤中的大多数操作都是统计相关的，比如min、max、count等。然而，在熊猫身上，“应用”可以表现得更多。</p><p id="b2dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从熊猫的文档中，</p><blockquote class="me mf mg"><p id="dffc" class="kz la mh lb b lc ld ju le lf lg jx lh mi lj lk ll mj ln lo lp mk lr ls lt lu im bi translated">在应用步骤中，我们可能希望执行以下操作之一:</p><p id="49dc" class="kz la mh lb b lc ld ju le lf lg jx lh mi lj lk ll mj ln lo lp mk lr ls lt lu im bi translated"><strong class="lb iu">聚合</strong>:计算每个组的汇总统计数据。</p><p id="660a" class="kz la mh lb b lc ld ju le lf lg jx lh mi lj lk ll mj ln lo lp mk lr ls lt lu im bi translated"><strong class="lb iu">转换</strong>:执行一些特定于组的计算，并返回一个相似索引的对象。</p><p id="7b37" class="kz la mh lb b lc ld ju le lf lg jx lh mi lj lk ll mj ln lo lp mk lr ls lt lu im bi translated"><strong class="lb iu">过滤</strong>:根据评估真或假的分组计算，丢弃一些分组。<em class="it">【1】</em></p></blockquote><p id="0925" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将介绍一些groupby应用程序。这些应用程序不仅向我展示了数据的洞察力，还帮助我确定了分析数据的下一步行动。</p><p id="1947" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧。</p><p id="bde3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文使用的数据是来自Kaggle的《学生饮酒》中的“student-por.csv”。你可以从这个<a class="ae ky" href="https://www.kaggle.com/uciml/student-alcohol-consumption" rel="noopener ugc nofollow" target="_blank">链接</a>下载数据。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="5d5e" class="mq mr it mm b gy ms mt l mu mv"><strong class="mm iu"># Input</strong><br/>import pandas as pd <br/>data = pd.read_csv('student-por.csv')<br/>data.info()</span><span id="56f9" class="mq mr it mm b gy mw mt l mu mv"><strong class="mm iu"># Output<br/></strong>&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 649 entries, 0 to 648<br/>Data columns (total 33 columns):<br/>school        649 non-null object<br/>sex           649 non-null object<br/>age           649 non-null int64<br/>address       649 non-null object<br/>famsize       649 non-null object<br/>Pstatus       649 non-null object<br/>Medu          649 non-null int64<br/>Fedu          649 non-null int64<br/>Mjob          649 non-null object<br/>Fjob          649 non-null object<br/>reason        649 non-null object<br/>guardian      649 non-null object<br/>traveltime    649 non-null int64<br/>studytime     649 non-null int64<br/>failures      649 non-null int64<br/>schoolsup     649 non-null object<br/>famsup        649 non-null object<br/>paid          649 non-null object<br/>activities    649 non-null object<br/>nursery       649 non-null object<br/>higher        649 non-null object<br/>internet      649 non-null object<br/>romantic      649 non-null object<br/>famrel        649 non-null int64<br/>freetime      649 non-null int64<br/>goout         649 non-null int64<br/>Dalc          649 non-null int64<br/>Walc          649 non-null int64<br/>health        649 non-null int64<br/>absences      649 non-null int64<br/>G1            649 non-null int64<br/>G2            649 non-null int64<br/>G3            649 non-null int64<br/>dtypes: int64(16), object(17)<br/>memory usage: 167.4+ KB</span></pre></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h2 id="b269" class="mq mr it bd ne nf ng dn nh ni nj dp nk li nl nm nn lm no np nq lq nr ns nt nu bi translated"><strong class="ak">第一步:拆分数据</strong></h2><p id="925a" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">第一步相当简单，根据一列或多列中的值对数据进行分组。您只需要指定如何执行分组。大多数人都知道一个列名或一组列名可以用于分组。但是，您也可以为分组传递一个函数。该函数将使用索引值作为参数并执行分组。欲了解更多信息，[2]</p><p id="3d6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">groupby函数返回的对象是“DataFrameGroupBy对象”。分组后，您可以使用<code class="fe oa ob oc mm b">group</code>来查看分组。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="99f4" class="mq mr it mm b gy ms mt l mu mv"><strong class="mm iu">#Groupby one column</strong></span><span id="3a4c" class="mq mr it mm b gy mw mt l mu mv"><strong class="mm iu"># Input</strong><br/>data.groupby('school')<br/><strong class="mm iu"># Output<br/></strong>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x0000024D28C9DF98&gt;</span><span id="79f3" class="mq mr it mm b gy mw mt l mu mv"><strong class="mm iu"># Input<br/></strong>data.groupby('school').groups<br/><strong class="mm iu"># Output<br/></strong>{'GP': Int64Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,<br/>...413, 414, 415, 416, 417, 418, 419, 420, 421, 422],<br/>dtype='int64', length=423),<br/> 'MS': Int64Index([423, 424, 425, 426, 427, 428, 429, 430, 431, 432,<br/>...639, 640, 641, 642, 643, 644, 645, 646, 647, 648],<br/>dtype='int64', length=226)}</span><span id="2040" class="mq mr it mm b gy mw mt l mu mv"><strong class="mm iu"># Groupby a function </strong></span><span id="3a08" class="mq mr it mm b gy mw mt l mu mv"><strong class="mm iu"># Input</strong><br/>def grouping(int):<br/>    if int%10==0:<br/>        return 'Group1'<br/>    if int%5==0:<br/>        return 'Group2'<br/>    return 'Group3'<br/>data.groupby(grouping).groups<br/><strong class="mm iu"># Output<br/></strong>{'Group1': Int64Index([  0,  10,  20,  30,  40,  50,  60,  70,  80,  90, 100, 110, 120, 130, 140, 150, 160, 170, 180, 190, 200, 210, 220, 230, 240, 250, 260, 270, 280, 290, 300, 310, 320, 330, 340, 350, 360, 370, 380, 390, 400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570, 580, 590, 600, 610, 620, 630, 640], dtype='int64'),<br/> 'Group2': Int64Index([  5,  15,  25,  35,  45,  55,  65,  75,  85,  95, 105, 115, 125,135, 145, 155, 165, 175, 185, 195, 205, 215, 225, 235, 245, 255, 265, 275, 285, 295, 305, 315, 325, 335, 345, 355, 365, 375, 385, 395, 405, 415, 425, 435, 445, 455, 465, 475, 485, 495, 505, 515, 525, 535, 545, 555, 565, 575, 585, 595, 605, 615, 625, 635, 645], dtype='int64'),<br/> 'Group3': Int64Index([  1,   2,   3,   4,   6,   7,   8,   9,  11,  12,... 637, 638, 639, 641, 642, 643, 644, 646, 647, 648],dtype='int64', length=519)}</span></pre><p id="8099" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面使用函数进行分组的例子中，数据帧中的索引是行号。因此，根据行号将一行分配给三个组之一。然后groupby函数将这三组分组。</p><p id="86dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要获得每个组的数据，您可以使用<code class="fe oa ob oc mm b">get_group()</code>函数并输入组名。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="70f9" class="mq mr it mm b gy ms mt l mu mv"><strong class="mm iu">#Input<br/></strong>data.groupby(grouping).get_group('Group1')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/96554c05764a6f6d5ac612782e50b9fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0QGm-pfTujpEJDiONHZ1kA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">data.groupby(分组)。get_group('Group1 ')</p></figure><p id="5193" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，如果要按非索引列对数据进行分组，可以同时使用apply和lambda函数进行分组。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="14b9" class="mq mr it mm b gy ms mt l mu mv"><strong class="mm iu"># Input<br/></strong>data.groupby(data['famsize'].apply(lambda x: x.startswith('GT'))).get_group(False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/86c90df1d2179b0dd234b2dd3c02b726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JuOkKAhT6n13se65FGNW5Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">data.groupby(data['famsize']。apply(lambda x: x.startswith('GT '))。get_group(False)</p></figure><p id="6a23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分组后，您已经可以应用许多计算或统计函数。例如，<code class="fe oa ob oc mm b">size()</code>可以给你每组的行数；<code class="fe oa ob oc mm b">sum()</code>返回每组所有数字列的总和。要知道更多适用的函数，[3]</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="d336" class="mq mr it mm b gy ms mt l mu mv"><strong class="mm iu">#Input<br/></strong>data.groupby(data['famsize'].apply(lambda x: x.startswith('GT'))).size()</span><span id="be8b" class="mq mr it mm b gy mw mt l mu mv"><strong class="mm iu">#Output<br/></strong>famsize<br/>False    192<br/>True     457<br/>dtype: int64</span></pre></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h2 id="2637" class="mq mr it bd ne nf ng dn nh ni nj dp nk li nl nm nn lm no np nq lq nr ns nt nu bi translated">步骤2:应用函数并组合结果</h2><p id="f427" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi lv translated">是时候报道groupby的重要部分了。Pandas中的Groupby函数比SQL中的功能更强大，因为你不仅可以使用常见的统计函数，如<code class="fe oa ob oc mm b">min(), max(), mean(),...</code>，还可以使用许多更复杂的函数。您也可以应用您定义的函数。在下面的部分，我将分别解释这三个动作。</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h2 id="d80a" class="mq mr it bd ne nf ng dn nh ni nj dp nk li nl nm nn lm no np nq lq nr ns nt nu bi translated"><strong class="ak">聚合(agg) </strong></h2><p id="21ac" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">关于聚合的一个简单解释是根据以前分组的数据执行计算。聚合应用于每个组，并返回其各自的结果。</p><p id="ffaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一些常见的计算如<code class="fe oa ob oc mm b">sum</code>、<code class="fe oa ob oc mm b">min</code>、<code class="fe oa ob oc mm b">max</code>、…您可以对所有数值列执行计算，也可以指定一列来执行计算。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="7882" class="mq mr it mm b gy ms mt l mu mv"><strong class="mm iu">#Input <br/></strong>mjob_gp = data.groupby('Mjob')<br/>mjob_gp.agg('mean')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/624a73c950b66663d0135f9ce9775616.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HOZR0foS-wlSRoohcnEC-Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">mjob_gp.agg('mean ')</p></figure><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="3eed" class="mq mr it mm b gy ms mt l mu mv"><strong class="mm iu">#Input<br/></strong>mjob_gp['age'].agg('mean')</span><span id="fe1f" class="mq mr it mm b gy mw mt l mu mv"><strong class="mm iu">#Output<br/></strong>Mjob<br/>at_home     16.955556<br/>health      16.312500<br/>other       16.802326<br/>services    16.661765<br/>teacher     16.583333<br/>Name: age, dtype: float64</span></pre><p id="c845" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于聚合，一个不太为人所知的情况是，您可以在一个或多个列上同时执行多个计算。如果您想研究一个列的统计数据，这个选项很有用。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="cf76" class="mq mr it mm b gy ms mt l mu mv"><strong class="mm iu">#Input <br/></strong>mjob_gp.agg({'age':['mean','max']})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/08d0bd35686c390cbe4cb07261b7c831.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*Q9hpvESjUDKzsloqz0r82w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">mjob_gp.agg({'age':['mean '，' max']})</p></figure><p id="ab59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，一个问题是这些列是多索引的，这对于进一步的处理不是很好(我个人不喜欢多索引)。因此，我们可以更进一步，将<code class="fe oa ob oc mm b">pd.NamedAgg</code>(熊猫0.25.0版本新增)包含到<code class="fe oa ob oc mm b">agg</code>功能中。关于<code class="fe oa ob oc mm b">pd.NamedAgg</code>的更多信息，[4]</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="67de" class="mq mr it mm b gy ms mt l mu mv"><strong class="mm iu">#Input<br/></strong>mjob_gp.agg(avg_age=pd.NamedAgg(column='age', aggfunc='mean'),<br/>            min_age=pd.NamedAgg(column='age', aggfunc='min'),<br/>            max_age=pd.NamedAgg(column='age', aggfunc='max'))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/d910a0c38ef70f9e8a59a60f892d1ed3.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*rt2yS0O49fHKXah2CWgPjA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">mjob_gp.agg(avg_age=pd。NamedAgg(column='age '，aggfunc='mean ')，<br/> min_age=pd。NamedAgg(column='age '，aggfunc='min ')，<br/> max_age=pd。NamedAgg(column='age '，aggfunc='max '))</p></figure><p id="2f11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe oa ob oc mm b">pd.NamedAgg</code>有两个好处。当然，第一个优点是列上没有多索引。第二个优点是您可以自定义列名。</p><p id="e86d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">毫不奇怪，您也可以在聚合中使用自定义函数。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="22f7" class="mq mr it mm b gy ms mt l mu mv"><strong class="mm iu">#Input <br/></strong>def range_function(x):<br/>    return max(x) - min(x)</span><span id="701d" class="mq mr it mm b gy mw mt l mu mv">mjob_gp.agg(max_age = pd.NamedAgg(column='age',aggfunc='max'),<br/>            min_age = pd.NamedAgg(column='age',aggfunc='min'),<br/>            range_age = pd.NamedAgg(column='age',aggfunc=range_function),)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/af93c17818fa4912200cbcfa53913be5.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*Mz5WB1q5yJ4gFUPoe0tk7A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">mjob_gp.agg(max_age = pd。NamedAgg(column='age '，aggfunc='max ')，<br/> min_age = pd。NamedAgg(column='age '，aggfunc='min ')，<br/> range_age = pd。NamedAgg(column='age '，aggfunc=range_function)，)</p></figure></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h2 id="69d6" class="mq mr it bd ne nf ng dn nh ni nj dp nk li nl nm nn lm no np nq lq nr ns nt nu bi translated"><strong class="ak">变换(transform) </strong></h2><p id="9c95" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">回到变形的描述，</p><blockquote class="me mf mg"><p id="f733" class="kz la mh lb b lc ld ju le lf lg jx lh mi lj lk ll mj ln lo lp mk lr ls lt lu im bi translated">T <strong class="lb iu">转换</strong>:执行一些特定于组的计算，并返回一个相似索引的对象。</p></blockquote><p id="615e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关键部分是“特定于组的计算”。不同组的计算是不同的。例如，<code class="fe oa ob oc mm b">max</code>将为每个组提供一列的最大值，但不是跨整个数据集。</p><p id="ddb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">转换的另一个特征是，计算应用于每一行，并返回每个组长度相同的结果，而不像长度减少的聚合。如果您熟悉SQL中的窗口函数，Pandas中的转换与此类似。(PS:你还不知道SQL中的窗口函数？！？！查看我以前的一篇文章，这篇文章帮助您理解为什么SQL中的窗口函数如此重要)</p><div class="oj ok gp gr ol om"><a rel="noopener follow" target="_blank" href="/why-window-function-in-sql-is-so-important-that-you-should-learn-it-right-now-1274b6096a86"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">为什么SQL中的窗口函数如此重要，以至于你现在就应该学习它？</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">如果我告诉你这个问题会在每次数据分析职位的面试中被问到，你会怎么想？</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa ks om"/></div></div></a></div><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="99d0" class="mq mr it mm b gy ms mt l mu mv"><strong class="mm iu">#Input <br/></strong>mjob_gp['G1','G2','G3'].transform(lambda x: (x-x.mean())/x.std())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/892f6e8d663fed233fbea50bedd18e0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*mpYTO1uGMVo4o1u8Mnen9Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">mjob_gp['G1 '，' G2 '，' G3']。transform(λx:(x-x . mean())/x . STD())</p></figure><p id="9526" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的例子中，对于每个组，G1到G3的值基于相应组的平均值和标准偏差被归一化。</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h2 id="3393" class="mq mr it bd ne nf ng dn nh ni nj dp nk li nl nm nn lm no np nq lq nr ns nt nu bi translated">过滤器</h2><p id="5bac" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">从《熊猫》中的描述来看，</p><blockquote class="me mf mg"><p id="24a1" class="kz la mh lb b lc ld ju le lf lg jx lh mi lj lk ll mj ln lo lp mk lr ls lt lu im bi translated">R <!-- -->返回数据帧的副本，排除不满足func指定的布尔标准的组中的元素。<em class="it">【5】</em></p></blockquote><p id="843b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用<code class="fe oa ob oc mm b">filter</code>功能过滤掉任何不符合标准的组。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="704b" class="mq mr it mm b gy ms mt l mu mv"><strong class="mm iu">#Input <br/></strong>mjob_gp.filter(lambda x: x['G1'].mean() &gt; 12)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/f7c32db4289f8d26c08c29e5adf27810.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HCM_xXZrUgEY02XZhDwuHw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">mjob_gp.filter(lambda x: x['G1']。平均值()&gt; 12)</p></figure><p id="0b63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的示例中，只返回“健康”和“教师”下的Mjob，因为它们的“G1”的平均值大于12。</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="9036" class="mq mr it mm b gy ms mt l mu mv"><strong class="mm iu">#Input <br/></strong>mjob_gp['G1'].mean()</span><span id="13b1" class="mq mr it mm b gy mw mt l mu mv"><strong class="mm iu">#Output<br/></strong>Mjob<br/>at_home     10.451852<br/>health      12.395833<br/>other       11.275194<br/>services    11.610294<br/>teacher     12.555556<br/>Name: G1, dtype: float64</span></pre></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="284f" class="pd mr it bd ne pe pf pg nh ph pi pj nk jz pk ka nn kc pl kd nq kf pm kg nt pn bi translated">关闭</h1><p id="d482" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">Pandas中的Groupby函数是执行大量分析和数据转换的便捷工具。我希望这篇文章能帮助你理解熊猫中groupby的威力和用处。我相信您现在已经更加了解如何在日常数据分析中使用groupby了。和熊猫玩得开心，下次再见。</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="66f0" class="pd mr it bd ne pe pf pg nh ph pi pj nk jz pk ka nn kc pl kd nq kf pm kg nt pn bi translated">我的另一篇文章</h1><p id="4d8c" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/bookmark-this-if-you-are-new-to-python-especially-if-you-self-learn-python-54c6e7b5dad8">如果您是Python新手(尤其是自学Python的话)，请将此加入书签</a></p><p id="1d77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/bookmark-this-if-you-are-new-to-python-especially-if-you-self-learn-python-part-2-ab3ba54e2f45">(第二部分)如果你是Python新手(尤其是自学Python的话)请将此加入书签</a></p><p id="e387" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/how-to-use-pandas-to-analyze-numeric-data-9739e0809b02">如何用熊猫来分析数值型数据？</a></p><p id="5cde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/web-scrape-twitter-by-python-selenium-part-1-b3e2db29051d">Web Scrape Twitter by Python Selenium(第1部分)</a></p><p id="f4c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/web-scrape-twitter-by-python-selenium-part-2-c22ae3e78e03">Web Scrape Twitter by Python Selenium(第二部分)</a></p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="08fe" class="pd mr it bd ne pe pf pg nh ph pi pj nk jz pk ka nn kc pl kd nq kf pm kg nt pn bi translated">引用/参考</h1><p id="78f4" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">[1]: <a class="ae ky" href="https://pandas.pydata.org/pandas-docs/version/0.23.4/groupby.html" rel="noopener ugc nofollow" target="_blank">分组依据:拆分-应用-合并</a></p><p id="3bbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">【2】:<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html#pandas-dataframe-groupby" rel="noopener ugc nofollow" target="_blank">熊猫。DataFrame.groupby </a></p><p id="47ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[3]: <a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/groupby.html#computations-descriptive-stats" rel="noopener ugc nofollow" target="_blank">计算/描述性统计</a></p><p id="cfaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[4]: <a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html?highlight=namedagg#named-aggregation" rel="noopener ugc nofollow" target="_blank">命名聚合</a></p><p id="397d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[5]:<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.DataFrameGroupBy.filter.html" rel="noopener ugc nofollow" target="_blank">pandas . core . group by . data frame group by . filter</a></p></div></div>    
</body>
</html>