<html>
<head>
<title>Beginners Guide to Deep Learning with TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TensorFlow 深度学习初学者指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/beginners-guide-to-deep-learning-with-tensorflow-ca85969b2f2?source=collection_archive---------44-----------------------#2020-06-08">https://towardsdatascience.com/beginners-guide-to-deep-learning-with-tensorflow-ca85969b2f2?source=collection_archive---------44-----------------------#2020-06-08</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="846d" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">使用 TensorFlow 启动并运行您的第一个神经网络</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/e3ce2bc9db022932f597560d4c882739.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PbILkqlsDvZTUG_ax_iglQ.jpeg"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated"><a class="ae kz" href="https://unsplash.com/@mikeanywhere?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">迈克·刘易斯 HeadSmart 媒体</a>在<a class="ae kz" href="https://unsplash.com/s/photos/flow?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="85f0" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><a class="ae kz" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank">由谷歌大脑团队于 2015 年开发的 Tensorflow </a>，是最受欢迎的深度学习框架。这很大程度上是由于它对多种语言的支持，Tensorflow 是用 C++编写的，但你可以通过 Python，Javascript，Go 和 r 与它进行交互，除了它灵活的架构和可扩展性(模型可以在 GPU 和 CPU 上训练，并通过 web 服务，桌面应用程序或移动设备进行部署)。</p><p id="1c77" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">本文是该工具的完整初学者指南。它不是一个深入的介绍，而是旨在让您开始开发您的第一个深度学习模型。</p><p id="4e3a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在我看来，很难找到不包含大量复杂性和繁重数学的深度学习教程。我个人学习得最好的方法是获取足够的知识来建立一个有效的模型，然后在我使用这种方法解决更复杂的问题时学习更多的复杂性。</p><p id="8873" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">本教程旨在通过一个不太简单的数据集演示 TensorFlow 的基本用法(演示在现实世界的机器学习问题中遇到的一些复杂性)，并提供足够的理论，以便能够自己构建一些东西，然后通过更复杂的文章和课程进一步发展这些知识。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="cae0" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">神经网络</h1><p id="7c45" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">在我们开始使用 TensorFlow 构建模型之前，我将简要介绍基于神经网络的算法的概念，因为首先对这个概念有一个基本的了解是一个好主意。</p><p id="e7ea" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">TensorFlow 主要用于开发高度可扩展的基于神经网络的模型。神经网络，通常称为人工神经网络(ANN ),是机器学习(称为深度学习)的子集，大致基于生物信息处理和通信节点的工作方式。</p><p id="a508" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">深度神经网络(DNN)是人工神经网络的一种特定形式，在 Tensorflow 中使用，由输入(特征)和输出(目标或预测)之间的若干层组成。当模型被训练时，通过每一层执行数学计算，计算特征代表特定输出或标签的概率。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><h1 id="f16e" class="md me iu bd mf mg mh mi mj mk ml mm mn ka mo kb mp kd mq ke mr kg ms kh mt mu bi translated">数据准备</h1><p id="ec76" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">在本文的剩余部分，我们将通过一个例子来使用 TensorFlow 进行分类任务。我们将使用来自 openml.org 网站的数据集，名为<strong class="lc iv">‘credit-g’</strong>。这包括银行公司客户的一些特征和一个类别，该类别表示发现客户的信用风险是好还是坏。</p><p id="c710" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">我们可以使用另一个机器学习库 Scikit-learn 将数据集直接导入到 Python 开发环境中。我在用 Jupyter 实验室。在下面的代码中，我们还将标记为“class”的列重命名为“target ”,以便与 TensorFlow 命名约定更加一致，并将其转换为数值数据，因为 TensorFlow 无法处理目标变量的字符串数据。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="na nb l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nc"><img src="../Images/09fc07ed29a1e54bb215bdf246529817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*voNGJiziKzXMsnFsBpI2tw.png"/></div></div><p class="kv kw gk gi gj kx ky bd b be z dk translated">数据集中的行和列的样本</p></figure><p id="56aa" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">来自 Openml.org 的数据集倾向于使用 Pandas 特有的数据类型“category”作为分类列。由于 TensorFlow 无法识别此数据类型，我们需要执行一个额外的步骤，将数据类型为“类别”的列转换为“对象”。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="na nb l"/></div></figure><p id="579c" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">接下来，我们将数据分为训练集、测试集和验证集。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="na nb l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nd"><img src="../Images/95505bb474c59a066b2669f36fac0c92.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*uCITMJY-AquPoLyZQ-Qz3A.png"/></div></div></figure><p id="61a6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">TensorFlow 不能直接获取熊猫数据帧。相反，我们需要将数据帧中的列映射到可用于训练模型的特征。TensorFlow 有一个名为<code class="fe ne nf ng nh b"><a class="ae kz" href="https://www.tensorflow.org/guide/data" rel="noopener ugc nofollow" target="_blank">tf.data</a></code>的方法，用于为不同的数据类型构建输入管道。</p><p id="62d3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在 TensorFlow 中，您将经常使用批处理，这是要处理的相对较小的数据样本。下面的代码创建了一个函数，将 dataframe 批量映射到 tf.data 对象(摘自<a class="ae kz" href="https://www.tensorflow.org/tutorials/structured_data/feature_columns" rel="noopener ugc nofollow" target="_blank"> TensorFlow 文档</a>)。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="na nb l"/></div></figure><h1 id="8bac" class="md me iu bd mf mg ni mi mj mk nj mm mn ka nk kb mp kd nl ke mr kg nm kh mt mu bi translated">创建要素图层</h1><p id="cb11" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">我们正在处理的数据集包含许多不同的要素类型，它们需要不同的变换。例如，我们有一些分类特征，如“personal_status”列和一些数字列。</p><p id="40a5" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在 TensorFlow 中，我们可以应用必要的转换，并将它们编码为 feature_columns，这些列被提供给一个特征层，该特征层将成为我们神经网络的第一层。作为网络的第一步，该层将把该训练数据的每个例子转换成单个<strong class="lc iv">张量</strong>。</p><p id="9020" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">要在 Tensorflow 模型中使用列作为特征，我们需要使用 feature_columns 方法。有许多不同的 feature_column 方法可以执行不同的转换，并将转换后的要素提供给模型。</p><p id="d487" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">对于我们的数据集，我们将使用三种不同的转换。</p><p id="e2a6" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">下面的代码首先创建一个名为 feature_columns 的空列表，我们将向其中追加不同的特性列类型。第一个转换使用 one-hot-encoding 通过<code class="fe ne nf ng nh b"><a class="ae kz" href="https://www.tensorflow.org/api_docs/python/tf/feature_column/categorical_column_with_vocabulary_list" rel="noopener ugc nofollow" target="_blank">feature_column.categorical_column_with_vocabulary_list</a></code>方法来转换分类特征。</p><p id="6c33" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">然后，我们使用<code class="fe ne nf ng nh b"><a class="ae kz" href="https://www.tensorflow.org/api_docs/python/tf/feature_column/bucketized_column" rel="noopener ugc nofollow" target="_blank">feature_column.bucketized_column</a></code>方法将“age”列转换为分时段组。</p><p id="4b7a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">最后，我们使用<code class="fe ne nf ng nh b"><a class="ae kz" href="https://www.tensorflow.org/api_docs/python/tf/feature_column/numeric_column" rel="noopener ugc nofollow" target="_blank">feature_column.numeric_column</a></code>为剩余的数字数据创建特征列。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="na nb l"/></div></figure><p id="3c70" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">现在，我们可以使用 feature_columns 来创建要在神经网络中使用的要素图层。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="na nb l"/></div></figure><h1 id="f4f6" class="md me iu bd mf mg ni mi mj mk nj mm mn ka nk kb mp kd nl ke mr kg nm kh mt mu bi translated">训练模型</h1><p id="9190" class="pw-post-body-paragraph la lb iu lc b ld mv jv lf lg mw jy li lj mx ll lm ln my lp lq lr mz lt lu lv in bi translated">我们现在可以构建神经网络，并用特征层中的数据训练和评估模型。在下面的代码中，我们正在构建一种最常见的模型，称为序列模型。这是从要素图层开始的一系列图层。</p><p id="9557" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">第二层和第三层被称为活化层。在基本层面上，每个激活层从特征层获取输入，并将其乘以每个节点中的权重。最常用的激活功能被称为<a class="ae kz" href="https://deepai.org/machine-learning-glossary-and-terms/relu" rel="noopener ugc nofollow" target="_blank">整流线性激活单元</a> (ReLU)，在下面的代码中的每个激活层中都有规定。</p><p id="5f40" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">在<code class="fe ne nf ng nh b">model.compile</code>代码中，我们指定算法类型为'<a class="ae kz" href="https://stanford.edu/~boyd/admm.html" rel="noopener ugc nofollow" target="_blank"> adam </a>'，其他可用的优化器可以在<a class="ae kz" href="https://keras.io/api/optimizers/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="na nb l"/></div></figure><p id="888a" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">训练模型的性能输出如下所示。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nn"><img src="../Images/18ad3aae94d13ee88249b8c844dea7d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M2-Mb2WfpBGlczu5ygJxTA.png"/></div></div></figure><p id="6cae" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">网络中的层数和每层中的节点数(上述模型中两个激活层中的数字 128)都会影响模型的性能。因此，提高性能的一种方法是对这些元素尝试不同的数量。此外，与其他机器学习算法一样，其他优化包括超参数调整、特征选择和增强的特征变换。</p></div><div class="ab cl lw lx hy ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="in io ip iq ir"><p id="5432" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">本文给出了使用 TensorFlow 解决分类任务的基本介绍。如果你想探索一些讨论过的概念，<a class="ae kz" href="https://course.fast.ai/" rel="noopener ugc nofollow" target="_blank"> fastai 课程实用深度学习课程</a>对于程序员来说是非常好的免费课程。</p><p id="0e58" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">本教程的完整笔记本可以在<a class="ae kz" href="https://github.com/rebecca-vickery/machine-learning-tutorials/blob/master/tensorflow/beginners_guide_classification.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="edd3" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated">感谢阅读！</p><p id="e98f" class="pw-post-body-paragraph la lb iu lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv in bi translated"><a class="ae kz" href="https://mailchi.mp/ce8ccd91d6d5/datacademy-signup" rel="noopener ugc nofollow" target="_blank"> <strong class="lc iv">我每月发一份简讯，如果你想加入请通过这个链接注册。期待成为您学习旅程的一部分！</strong> </a></p></div></div>    
</body>
</html>