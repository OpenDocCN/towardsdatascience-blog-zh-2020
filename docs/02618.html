<html>
<head>
<title>Evaluating Performance of Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">评估模型的性能</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/evaluating-performance-of-models-8d5c3ca6f8cf?source=collection_archive---------14-----------------------#2020-03-13">https://towardsdatascience.com/evaluating-performance-of-models-8d5c3ca6f8cf?source=collection_archive---------14-----------------------#2020-03-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1caf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你的逻辑回归或分类模型有多有效？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6ebde58658d140988de7e5036e6010e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sQpLuJJE8dWTKooJQC1plA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.aithority.com/guest-authors/why-data-accuracy-matters/" rel="noopener ugc nofollow" target="_blank">图片来源:AIthority </a></p></figure><p id="1878" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在完成了一些逻辑回归和二元分类的数据科学项目后，我决定写更多关于评估我们的模型和采取步骤以确保它们高效准确地运行的内容。你可能有“好”的数据并且知道如何建立模型，但是如果你能够解释你的模型的效率，你就能够解释你的结果并且提供最终的商业决策！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/26b538125736cffbfe2301da3d299b05.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/1*nqT5VY-_CcWyfWJGopC5bg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:【giphy.com T2】</p></figure><p id="0555" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<strong class="lb iu">回归</strong>，我们预测连续变量，因此将误差作为我们的估计有多远的距离来讨论是有意义的。对于分类问题，我们正在处理二元变量，所以我们的模型不是对就是错。因此，当评估分类算法的性能时，我们检查一些特定的测量。</p><h2 id="3d5b" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">评估指标</h2><ol class=""><li id="132d" class="mp mq it lb b lc mr lf ms li mt lm mu lq mv lu mw mx my mz bi translated"><strong class="lb iu"> <em class="na">精度</em> </strong> —衡量预测的精度。</li><li id="b3eb" class="mp mq it lb b lc nb lf nc li nd lm ne lq nf lu mw mx my mz bi translated"><strong class="lb iu"> <em class="na">回忆</em> </strong> <em class="na"> — </em>表示我们感兴趣的类中有多少百分比被模型实际捕获。</li><li id="7c14" class="mp mq it lb b lc nb lf nc li nd lm ne lq nf lu mw mx my mz bi translated"><strong class="lb iu"> <em class="na">准确度</em> </strong>大概是最直观的度量。我们用它来衡量一个模型正确预测的总数，包括真正的正面和真正的负面。</li><li id="557a" class="mp mq it lb b lc nb lf nc li nd lm ne lq nf lu mw mx my mz bi translated"><strong class="lb iu"> F1分数</strong>是一个<strong class="lb iu"> </strong>度量，它同时考虑了精确度和召回率来计算分数。它可以被解释为精度和召回值的加权平均值，并且在精度和召回值都不高的情况下不可能高。当一个模特的F1分数很高时，你知道你的模特在各方面都做得很好。</li></ol><p id="9707" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">示例:</strong>预测某个员工是否被聘用(活动)。在这个项目中，我们理想地预测候选人是否适合公司。</p><p id="407a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="na"> Precision: </em>“在模型显示有人被雇佣的所有次数中，有多少次被讨论的雇员实际上在“牙科魔术”工作？"</p><p id="afb8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="na">回想一下:</em>“在我们看到的所有实际被雇佣的员工中，我们的模型正确识别出他们中有多少人是在职的？”</p><p id="ba87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">精确度和召回率成反比关系。一个上升，另一个就会下降。</p><h2 id="3506" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">精确比回忆好吗？</h2><p id="9781" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">这是一个经典的数据科学问题。什么是更好的假阳性或假阴性？答案是“视问题而定”，可以测试你的批判性思维能力。让我们来看一个新的例子。</p><p id="06b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">检测信用卡欺诈，<strong class="lb iu">假阳性</strong>将是当我们的模型将交易标记为欺诈，但它不是。这导致了一个稍微恼火的顾客。<strong class="lb iu">假阴性</strong>可能是一种欺诈性交易，一家公司错误地将其视为正常的消费者行为。在这种情况下，信用卡公司可能会因为错过交易欺诈的迹象而向客户偿还数千美元而陷入困境！尽管错误从来都不是理想的，但信用卡公司倾向于将他们的模型构建得有点过于敏感是有道理的，因为高召回率比高精度分数能为他们节省更多的钱。</p><p id="73d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来分析一下我们的HR例子。我们的模型想要预测一个人是否适合“受雇与未受雇”的公司。在这种情况下，我们希望两者都很低:假阴性和假阳性。作为一名人力资源员工，我们希望误报率高于漏报率，原因如下。由于误报率较高，我们的模型预测我们的候选人非常适合，而实际上他们并不适合…这只是候选人的第一轮面试扫描，我们宁愿浏览更多的简历，也不愿错过一个潜在的优秀候选人。最终的雇佣决定来自一个人的最终决定。</p><h2 id="a479" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">受试者工作特征曲线</h2><p id="aaa7" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">在评估模型时，我们希望可视化ROC曲线。说明了我们的分类器的<strong class="lb iu">真阳性率</strong>与<strong class="lb iu">假阳性率</strong>。真实阳性率是回忆的另一个名称，它是真实阳性预测与所有实际阳性值的比率。</p><ul class=""><li id="b01c" class="mp mq it lb b lc ld lf lg li nj lm nk lq nl lu nm mx my mz bi translated">TPR = TP/(TP+FN)</li></ul><p id="afc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假阳性率是假阳性预测与实际为阴性的所有值的比率。</p><ul class=""><li id="d9ae" class="mp mq it lb b lc ld lf lg li nj lm nk lq nl lu nm mx my mz bi translated">FPR = FP/(FP+TN)</li></ul><p id="bf77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果TPR是我们的y轴，FPR是我们的x轴，我们希望我们的ROC曲线紧靠图表的左侧，这意味着TPR越高，FPR越低。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/3ed9290a4ccadff74cbedda35c63bffd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jvRmmKhpiUOc17V9vFdWgQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://glassboxmedicine.com/2019/02/23/measuring-performance-auc-auroc/" rel="noopener ugc nofollow" target="_blank">测量性能参考</a></p></figure><h2 id="a00d" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">判别边界</h2><p id="98df" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">逻辑回归模型产生每个观察的特定类的概率。想象它如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/780b2c4e810bc3b1c1ecc6e5fc00423d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2PDWgIAFBHMujjfhKeoU5w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:统计学习入门。加雷思·詹姆斯 <a class="ae ky" href="https://www.chegg.com/authors/trevor-hastie" rel="noopener ugc nofollow" target="_blank">特雷弗·哈斯蒂</a> <a class="ae ky" href="https://www.chegg.com/authors/robert-tibshirani" rel="noopener ugc nofollow" target="_blank">罗伯特·蒂布拉尼</a> <a class="ae ky" href="https://www.chegg.com/authors/daniela-witten" rel="noopener ugc nofollow" target="_blank">丹妮拉·威滕</a></p></figure><p id="d8b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们改变截止点，将会牺牲精度，增加FPR以增加TPR，反之亦然。将判定边界从0.5向左移动将导致捕获更多的正类(1)情况。它还会拾取一些假阳性(在阴性(0)病例分布的最右边的红色病例)。</p><p id="89c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ROC较差的模型在两个类别的概率估计中可能有很大的重叠。这将表明我们的模型很难将这两个类分开。</p></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><p id="2417" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看一个例子:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="d381" class="lw lx it nx b gy ob oc l od oe"><em class="na">#Import roc_curve, auc</em><br/>from sklearn.metrics import roc_curve, auc</span><span id="6965" class="lw lx it nx b gy of oc l od oe"><em class="na">#Calculate the probability scores of each point in the training set</em><br/><strong class="nx iu">y_train_score</strong> = model_log.decision_function(X_train)</span><span id="fb68" class="lw lx it nx b gy of oc l od oe"><em class="na"># Calculate the fpr, tpr, and thresholds for the training set</em><br/><strong class="nx iu">train_fpr, train_tpr, thresholds</strong> = roc_curve(y_train, y_train_score)</span><span id="e805" class="lw lx it nx b gy of oc l od oe"><em class="na">#Calculate the probability scores of each point in the test set</em><br/><strong class="nx iu">y_test_score</strong> = model_log.decision_function(X_test)</span><span id="6b79" class="lw lx it nx b gy of oc l od oe"><em class="na">#Calculate the fpr, tpr, and thresholds for the test set</em><br/><strong class="nx iu">test_fpr, test_tpr, test_thresholds</strong> = roc_curve(y_test, y_test_score)</span></pre><p id="606e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用Matplotlib，我们希望可视化我们的ROC曲线:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="3ffb" class="lw lx it nx b gy ob oc l od oe">plt.plot(test_fpr, test_tpr, color='darkorange', lw=lw, label='ROC curve')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/ff514e0e0aaac59f9d07d9d438610c49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DhmMAjOsDjQll-QisbdReA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://github.com/michellevenables1/HR_project" rel="noopener ugc nofollow" target="_blank">米歇尔维纳布尔斯— Github/HR_Project </a></p></figure><p id="a2af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如左图所示，您可以看到我们的分类模型TPR vs FPR。想一想这个模型的场景:预测员工在公司内的适合度。如果您将当前模型调整为具有76%的真阳性率(您仍然错过了29%的合适者)，那么假阳性率是多少？</p><p id="01af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当TPR = 75%时，FPR为22%。真实阳性率决定了被正确识别为合适的在职员工的百分比。同时，这有一个接近0.25的FPR，这意味着大约有四分之一的情况下，我们错误地警告一个员工是一个很好的人选，而他们实际上表现不佳。</p><p id="8cf7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">测试AUC </strong> : 0.8041</p><p id="6b95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分类器的总体准确性可以通过AUC(曲线下的<strong class="lb iu">面积)来量化。完美的分类器将具有1.0的AUC分数，而0.5的AUC毫无价值。这里我们有0.80的AUC，这似乎是准确的。</strong></p><h2 id="1b34" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">参考资料:</h2><ul class=""><li id="fa87" class="mp mq it lb b lc mr lf ms li mt lm mu lq mv lu nm mx my mz bi translated">统计学习导论。加雷思·詹姆斯 <a class="ae ky" href="https://www.chegg.com/authors/trevor-hastie" rel="noopener ugc nofollow" target="_blank">特雷弗·哈斯蒂</a> <a class="ae ky" href="https://www.chegg.com/authors/robert-tibshirani" rel="noopener ugc nofollow" target="_blank">罗伯特·提布拉尼</a> <a class="ae ky" href="https://www.chegg.com/authors/daniela-witten" rel="noopener ugc nofollow" target="_blank">丹妮拉·威滕</a></li><li id="f9d2" class="mp mq it lb b lc nb lf nc li nd lm ne lq nf lu nm mx my mz bi translated">米歇尔维纳布尔斯— <a class="ae ky" href="https://github.com/michellevenables1/HR_project" rel="noopener ugc nofollow" target="_blank"> Github </a></li></ul></div></div>    
</body>
</html>