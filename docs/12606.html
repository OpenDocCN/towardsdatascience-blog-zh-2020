<html>
<head>
<title>Local Outlier Factor (LOF) — Algorithm for outlier identification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">局部异常因子(LOF)——异常识别算法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/local-outlier-factor-lof-algorithm-for-outlier-identification-8efb887d9843?source=collection_archive---------2-----------------------#2020-08-31">https://towardsdatascience.com/local-outlier-factor-lof-algorithm-for-outlier-identification-8efb887d9843?source=collection_archive---------2-----------------------#2020-08-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7c7f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用 LOF 值检测异常</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1b288287ec514211b3a710f81596b3c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xOAscxYYe3cX4pY7PZEfFg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片由 Pexels 的 Markus Spiske 提供</p></figure><h1 id="1abe" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">目录:</h1><ol class=""><li id="1ad1" class="lo lp iq lq b lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">介绍</li><li id="f923" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">K-距离和 K-邻居</li><li id="6801" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">可达性距离</li><li id="da6c" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">本地可达性距离(LRD)</li><li id="79ee" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">本地异常因素(LOF)</li><li id="81ea" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">例子</li><li id="ba78" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">LOF 的优势</li><li id="45c6" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">LOF 的缺点</li><li id="95b9" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">结论</li><li id="9557" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb mc md me mf bi translated">参考</li></ol><h2 id="dbe6" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lv mq mr li lx ms mt lk lz mu mv lm mw bi translated">1.介绍</h2><p id="d688" class="pw-post-body-paragraph mx my iq lq b lr ls jr mz lt lu ju na lv nb nc nd lx ne nf ng lz nh ni nj mb ij bi translated">离群值是不同于或远离其余数据点的数据点。这里出现的问题是，我们能识别数据中的异常值吗？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/8c3c87c7ae48bb9afcbc4ed00924056c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KZDvQFJRVQ34Gm5E5hLnnw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来自 Pexels 的<a class="ae kv" href="https://www.pexels.com/photo/board-game-box-business-card-262028/" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a></p></figure><p id="1507" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">局部异常值因子(LOF)是一种识别数据集中异常值的算法。但是<strong class="lq ir">本地异常值</strong>意味着什么呢？</p><p id="e516" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">当一个点被认为是基于其局部邻域的异常值时，它是一个<strong class="lq ir">局部异常值</strong>。考虑到邻域的密度，LOF 将识别异常值。当整个数据集中的数据密度不同时，LOF 表现良好。</p><p id="4422" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">要理解 LOF，我们必须依次学习几个概念:</p><ul class=""><li id="6515" class="lo lp iq lq b lr nl lt nm lv nq lx nr lz ns mb nt md me mf bi translated">K-距离和 K-邻居</li><li id="70c5" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb nt md me mf bi translated">可达性距离</li><li id="489e" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb nt md me mf bi translated">本地可达性密度(LRD)</li><li id="7c88" class="lo lp iq lq b lr mg lt mh lv mi lx mj lz mk mb nt md me mf bi translated">本地异常因素(LOF)</li></ul><h2 id="0d45" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lv mq mr li lx ms mt lk lz mu mv lm mw bi translated">2.K-距离和 K-邻居</h2><p id="a845" class="pw-post-body-paragraph mx my iq lq b lr ls jr mz lt lu ju na lv nb nc nd lx ne nf ng lz nh ni nj mb ij bi translated"><strong class="lq ir"> K-distance </strong>是该点与它的 Kᵗʰ最近邻之间的距离。<strong class="lq ir">k-邻居</strong>由 Nₖ(A 表示)包括位于半径为 k-距离的圆内或圆上的一组点。K-neighbors 可以大于或等于 k 的值。这怎么可能呢？</p><p id="445b" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">我们会看到一个例子。假设我们有四个点 A、B、C 和 D(如下所示)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/4ca630e44824c3ef91e658eb9606cdaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*kOwduufhfK0yWWd3N4r5rQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">K=2 时 A 的距离</p></figure><p id="077c" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">如果 K=2，a 的 k 个邻居将是 c、b 和 d。这里，k 的值=2，但||N₂(A)|| = 3。因此，||Nₖ(point)||将永远大于或等于 k</p><h2 id="cce8" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lv mq mr li lx ms mt lk lz mu mv lm mw bi translated">3.可达性密度</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/16b6f1468b39c4b875a72945b73c5449.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*y-Hod8WRK7BARmVRtIOg4g.png"/></div></figure><p id="e865" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">它被定义为 Xj 的 K-距离和 Xi 与 Xj 之间的距离的最大值。距离度量是特定于问题的(欧几里德、曼哈顿等)。)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/075ab709e5d587f7a96b53d483c80908.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*zrk0QWDm7SXq2Iu69YnSFQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">K=2 时可达性距离的图示</p></figure><p id="f1bb" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">通俗地说，如果一个点 Xi 位于 Xj 的 K 个邻居内，则可达性距离将是 Xj 的 K 个距离(蓝线)，否则可达性距离将是 Xi 和 Xj 之间的距离(橙线)。</p><h2 id="e15c" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lv mq mr li lx ms mt lk lz mu mv lm mw bi translated">4.本地可达性密度(LRD)</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/31ef512367c472e82ea8a44fe00ec32c.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*vXEtLH96HJKJHfzd5EwC0A.png"/></div></figure><p id="13c1" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">LRD 是 A 到其邻居的平均可达距离的倒数。直观地根据 LRD 公式，平均可达性距离越大(即邻居离该点越远)，特定点周围存在的点密度越小。这表示一个点离最近的点簇有多远。LRD 的低值意味着最近的聚类远离该点。</p><h2 id="4cda" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lv mq mr li lx ms mt lk lz mu mv lm mw bi translated">5.本地异常因素(LOF)</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/16f209366988a8516b92e3558be6fdf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*Jb2EFtlflLa6jAklVAQy9A.png"/></div></figure><p id="51c6" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">每个点的 LRD 用于与其 K 个邻居的平均 LRD 进行比较。LOF 是 A 的 K 个邻居的平均 LRD 与 A 的 LRD 之比</p><p id="e939" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">直观上，如果该点不是离群点(内点)，则邻居的平均 LRD 之比大约等于该点的 LRD(因为该点与其邻居的密度大致相等)。在这种情况下，LOF 几乎等于 1。另一方面，如果该点是异常值，则该点的 LRD 小于相邻点的平均 LRD。那么 LOF 的价值就会很高。</p><p id="f879" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">一般来说，如果 LOF 大于 1，它被认为是一个异常值，但并不总是如此。假设我们知道数据中只有一个异常值，那么我们取所有 LOF 值中最大的 LOF 值，对应最大 LOF 值的点将被视为异常值。</p><h2 id="bc74" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lv mq mr li lx ms mt lk lz mu mv lm mw bi translated">6.例子</h2><p id="61f1" class="pw-post-body-paragraph mx my iq lq b lr ls jr mz lt lu ju na lv nb nc nd lx ne nf ng lz nh ni nj mb ij bi translated">4 点:A(0，0)，B(1，0)，C(1，1)和 D(0，3)，K=2。我们将使用 LOF 来检测这 4 个点中的一个异常值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/34e1fdcb14a2da3ca8b888042c51d6ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*YSXLLWozQ5h0IoVN2F4IOw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">A(0，0)，B(1，0)，C(1，1)和 D(0，3)</p></figure><p id="a3fd" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">按照上面讨论的程序:</p><p id="c5b3" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">首先，计算 K=2 的所有点的<strong class="lq ir">K-距离</strong>、<strong class="lq ir">每对</strong>、<strong class="lq ir">点之间的距离以及<strong class="lq ir">K-邻域</strong>。我们将使用<strong class="lq ir">曼哈顿距离</strong>来测量距离。</strong></p><p id="5f77" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">k-distance(a)–&gt;因为 c 是 a 的 2ᴺᴰ最近邻–&gt; distance(a，c)= 2<br/>k-distance(B)–&gt;因为 a，c 是 b 的 2ᴺᴰ最近邻–&gt;distance(b，c)或 distance(b，a)= 1<br/>k-distance(c)–&gt;因为 a 是 c 的 2ᴺᴰ最近邻–&gt;distance(c，a)= 2<br/>k-distance(d)–&gt;因为</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/61707bc4a8a6700842b8da544fbf6e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*NygDyHNIDZjiU-2PUnieQQ.png"/></div></figure><p id="01b5" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">K-邻域(A) = {B，C}，| | N2(A)| | = 2<br/>K-邻域(B) = {A，C}，| | N2(B)| | = 2<br/>K-邻域(C)= {B，A}，| | N2(C)| | = 2<br/>K-邻域(D) = {A，C}，| | N2(D)| = 2</p><p id="8060" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">K-distance(每对点之间的距离)和 K-neighborhood 将用于计算 LRD。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/c29a28b955a3ddf47736712fcc990ac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*I-j2pTnIf2FAwhyA0llMew.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">A、B、C 和 D 各点的 LRD</p></figure><p id="acf0" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">本地可达性密度(LRD)将用于计算本地异常因子(LOF)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/7a45901447c37d731a0a3291f4428e09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*gOONbPWNC7FMcODIpyVgFA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">A、B、C 和 D 各点的 LOF</p></figure><p id="9df0" class="pw-post-body-paragraph mx my iq lq b lr nl jr mz lt nm ju na lv nn nc nd lx no nf ng lz np ni nj mb ij bi translated">四个点中 LOF 最高的是 LOF。因此，D 是一个异常值。</p><h2 id="62b9" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lv mq mr li lx ms mt lk lz mu mv lm mw bi translated">7.LOF 的优势</h2><p id="b4a3" class="pw-post-body-paragraph mx my iq lq b lr ls jr mz lt lu ju na lv nb nc nd lx ne nf ng lz nh ni nj mb ij bi translated">如果一个点距离极其密集的聚类很近，则该点将被视为异常值。全局方法可能不会将该点视为异常值。但是 LOF 可以有效地识别局部异常值。</p><h2 id="ea08" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lv mq mr li lx ms mt lk lz mu mv lm mw bi translated">8.LOF 的缺点</h2><p id="4f02" class="pw-post-body-paragraph mx my iq lq b lr ls jr mz lt lu ju na lv nb nc nd lx ne nf ng lz nh ni nj mb ij bi translated">因为 LOF 是一个比率，所以很难解释。没有特定的阈值，高于该阈值的点被定义为异常值。异常值的识别取决于问题和用户。</p><h2 id="d0f9" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lv mq mr li lx ms mt lk lz mu mv lm mw bi translated">9.结论</h2><p id="f18f" class="pw-post-body-paragraph mx my iq lq b lr ls jr mz lt lu ju na lv nb nc nd lx ne nf ng lz nh ni nj mb ij bi translated">局部异常值因子(LOF)值基于局部邻域识别异常值。它给出了比发现异常值的全局方法更好的结果。由于没有 LOF 阈值，因此选择一个点作为异常值取决于用户。</p><h2 id="ed8f" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lv mq mr li lx ms mt lk lz mu mv lm mw bi translated">10.参考</h2><p id="c034" class="pw-post-body-paragraph mx my iq lq b lr ls jr mz lt lu ju na lv nb nc nd lx ne nf ng lz nh ni nj mb ij bi translated">Breunig，M. M .，Kriegel，H. P .，Ng，R. T .，和 Sander，J. (2000 年)。LOF:识别基于密度的局部异常值。在<em class="oc"> ACM sigmod 记录</em>(第 29 卷第 2 页第 93–104 页)中。ACM。</p></div></div>    
</body>
</html>