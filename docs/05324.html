<html>
<head>
<title>Using PIL’s Image for image transformation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用PIL图像进行图像变换</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-pils-image-for-image-transformation-64a6d7b6e58b?source=collection_archive---------46-----------------------#2020-05-05">https://towardsdatascience.com/using-pils-image-for-image-transformation-64a6d7b6e58b?source=collection_archive---------46-----------------------#2020-05-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="42db" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Python中轻松调整图像大小和连接图像</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1487fdd1d18652360ee16ff825370a5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*z_DmeOKWRjkv4Fxm"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@hiteshchoudhary?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Hitesh Choudhary </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="5f43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最近在做一个项目，涉及操纵图像，以便我们可以在其上运行无监督的机器学习算法。作为一个Python爱好者，我决定使用Python和它的库来为我操作，而不是走Photoshop路线。</p><p id="6047" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我强调了我如何使用<code class="fe lv lw lx ly b">PIL</code>中的<code class="fe lv lw lx ly b">Image</code>子模块来创建我的项目所需的图像。</p><h1 id="c78b" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">收集图像</h1><p id="1eea" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">我为这篇文章拍摄了两张图片，都来自Unsplash。我特别使用了不同尺寸的图像，这样我们就可以了解不同尺寸的图像是如何相互作用的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/afbcf2f34dc9fee60c9a20480c39f89a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S8PhZKh3Mc03IU0szoF6wg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<strong class="bd mx"> Ivars Utināns </strong>提供</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/49d5eff01ab83ee9d8658ce0839b43f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SYX-vwbsdwbnTg1zGx6hsA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<strong class="bd mx">塞尔吉奥·索萨</strong></p></figure><p id="d730" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，第一幅图像较宽，而第二幅图像高度较长。把它们结合起来我们会很开心。</p><p id="daac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图片1:<a class="ae ky" href="https://unsplash.com/photos/DujBHPRqAKk" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/DujBHPRqAKk</a><br/>图片2:<a class="ae ky" href="https://unsplash.com/photos/JSye5r1eAVY" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/JSye5r1eAVY</a></p><p id="a63b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我通常使用unsplash.com T21，因为它有大量各种各样的高质量图像，可以免费获取。显然，不要忽略对艺术家的适当肯定。是好的伦理！！</p><h1 id="21c8" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">安装库</h1><p id="254a" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">我在这里使用的是Python 3.6，但是Python 3.5和更高版本的所有版本都应该可以正常工作。</p><pre class="kj kk kl km gt mz ly na nb aw nc bi"><span id="7bf0" class="nd ma it ly b gy ne nf l ng nh">pip install Pillow<br/>pip install matplotlib</span></pre><p id="2e15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">Pillow</code>是包含我们的子模块<code class="fe lv lw lx ly b">Image</code>的PIL包。我还决定安装<code class="fe lv lw lx ly b">matplotlib</code>,因为它让在Jupyter笔记本上显示图像变得更加容易，不管图像的大小如何。例如，当我试图使用<code class="fe lv lw lx ly b">Image</code>直接显示图像时，它打开了一个新窗口，图像全部放大。</p><p id="7320" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想在Jupyter笔记本中这样做，使用<code class="fe lv lw lx ly b">pip install jupyter</code>安装它，启动Jupyter服务器并创建一个新的笔记本。</p><h1 id="9221" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">加载库</h1><p id="2487" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">我们现在将加载已安装的库。我们需要来自<code class="fe lv lw lx ly b">PIL</code>的<code class="fe lv lw lx ly b">Image</code>子模块和来自<code class="fe lv lw lx ly b">matplotlib</code>的<code class="fe lv lw lx ly b">pyplot</code>子模块，我们将以名称<code class="fe lv lw lx ly b">plt</code>加载它们。你可以给它起任何名字，也可以什么都不用，用<code class="fe lv lw lx ly b">plt</code>只是惯例。</p><pre class="kj kk kl km gt mz ly na nb aw nc bi"><span id="d843" class="nd ma it ly b gy ne nf l ng nh">from PIL import Image<br/>import matplotlib.pyplot as plt</span></pre><h1 id="258b" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">加载图像</h1><p id="0d77" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">使用<code class="fe lv lw lx ly b">Image.open()</code>，我们可以简单地将图像加载到笔记本中(或者Python文件，如果你正在使用的话)。我们将在变量<code class="fe lv lw lx ly b">img1</code>中保存第一幅图像，在变量<code class="fe lv lw lx ly b">img2</code>中保存第二幅图像。</p><pre class="kj kk kl km gt mz ly na nb aw nc bi"><span id="6813" class="nd ma it ly b gy ne nf l ng nh">img1 = Image.open("image.jpg")<br/>img2 = Image.open("image2.jpg")</span></pre><p id="a7ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要查看第一幅图像，我们只需使用以下命令:</p><pre class="kj kk kl km gt mz ly na nb aw nc bi"><span id="00d3" class="nd ma it ly b gy ne nf l ng nh">plt.imshow(img1)</span></pre><p id="5ea2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">imshow()</code>方法显示Jupyter笔记本中的图像，如下图所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/98271b8c467de3be373c2bd34b195b09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zcnDr_VgV2oM0L_RP2R4SA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">plt.imshow的结果(img1)</p></figure><p id="3869" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以重复同样的操作来查看第二个图像，只需替换上面命令中变量的名称。</p><h1 id="6843" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">调整图像大小</h1><p id="50ae" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">使用<code class="fe lv lw lx ly b">Image</code>调整图像大小非常非常简单。我们只是使用<code class="fe lv lw lx ly b">resize()</code>方法，并为最终调整后的图像定义一个元组(宽度，高度)。在下面的代码中，我将图像1的大小调整为1200x800，然后打印新旧图像的大小，最后显示结果图像。</p><pre class="kj kk kl km gt mz ly na nb aw nc bi"><span id="f7c5" class="nd ma it ly b gy ne nf l ng nh">img1_resized = img1.resize((1200, 800))<br/>print("Original image size: {}".format(img1.size))<br/>print("Resized image size: {}".format(img1_resized.size))<br/>plt.imshow(img1_resized)</span><span id="c845" class="nd ma it ly b gy nj nf l ng nh">## Output<br/># Original image size: (5464, 3640)<br/># Resized image size: (1200, 800)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/8fb9314bbf6097207118a803c0ec538b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I1GNKzSwPd-kQ-qhs3moOg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">已调整大小的图像</p></figure><p id="fa5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看水平轴和垂直轴，您会看到新图像的大小现在调整为1200x800。</p><h1 id="6369" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">水平连接</h1><p id="2eae" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">在我的项目中，我必须水平地一个接一个地组合几幅图像。这个想法是让图像具有相同的高度，但宽度增加。一旦我开始寻找可能的解决方案，我就能够编写出有效的代码。然而，与我项目中的正方形图像不同，我很好奇是否可以组合不同大小的图像并生成可用的图像。经过仔细的实验，我找到了一个适用于不同尺寸图像的解决方案。</p><pre class="kj kk kl km gt mz ly na nb aw nc bi"><span id="2d23" class="nd ma it ly b gy ne nf l ng nh">result_img = Image.new('RGB', (img1.width + img2.width, min(img1.height, img2.height)))<br/>result_img.paste(img1, (0, 0))<br/>result_img.paste(img2, (img1.width, 0))<br/>plt.imshow(result_img)</span></pre><p id="073e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我首先使用<code class="fe lv lw lx ly b">Image.new()</code>创建一个新图像。第一个参数声明我正在创建一个RGB图像，第二个参数是最终图像的宽度和高度。显而易见，当两张图片并排放置时，它们的宽度会简单地相加。然而，由于两者的高度不同，使用<code class="fe lv lw lx ly b">min()</code>方法会将组合图像缩小到适当的高度，因此没有空白。</p><p id="fc2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我粘贴从<code class="fe lv lw lx ly b">(0,0)</code>开始的第一张图片和到<code class="fe lv lw lx ly b">(img1.width, 0)</code>结束的第二张图片。生成的图像如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/d4181be992fb4bcc35280e4c187c22b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hmO4lnkP0oMJpjXksUMYmA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">水平组合两幅图像</p></figure><p id="2fea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们用<code class="fe lv lw lx ly b">max()</code>方法替换<code class="fe lv lw lx ly b">min()</code>方法，我们将在原本没有像素的地方得到黑色。在上面的代码中，如果我们使用<code class="fe lv lw lx ly b">max()</code>，得到的图像应该是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/5ba62281de8b8c116d79ad2152f43c60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GZvNxtwPjQx-DWQbcHudCg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">水平组合两幅图像(使用max())</p></figure><h1 id="4811" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">垂直连接</h1><p id="8010" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">就像水平拼接一样，我们也可以垂直组合图像。为此，总高度将是两个图像的高度之和，而宽度将是两个图像中的最小值。</p><pre class="kj kk kl km gt mz ly na nb aw nc bi"><span id="b145" class="nd ma it ly b gy ne nf l ng nh">result_img = Image.new('RGB', (min(img1.width, img2.width), img1.height + img2.height))<br/>result_img.paste(img1, (0, 0))<br/>result_img.paste(img2, (0, img1.height))<br/>plt.imshow(result_img)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/4352414ef0804400ee7fcc14258c0e5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*gy99IB2YZ6HtFI7oF5QFTQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">垂直组合图像</p></figure><p id="2b0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们将在<code class="fe lv lw lx ly b">(0,0)</code>再次粘贴图像1，但是第二个图像将被放置在<code class="fe lv lw lx ly b">(0, img1.height)</code>。同样，我们在这里使用了<code class="fe lv lw lx ly b">min()</code>方法来代替<code class="fe lv lw lx ly b">max()</code>方法。</p><h1 id="5827" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">保存图像</h1><p id="213c" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">最后，一旦所有的转换完成，我们可以保存图像。如果我们将图像设为<code class="fe lv lw lx ly b">result_img</code>，命令将会是:</p><pre class="kj kk kl km gt mz ly na nb aw nc bi"><span id="5aa3" class="nd ma it ly b gy ne nf l ng nh">result_img.save("new_image.jpg")</span></pre><p id="26d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，新图像将以名称<code class="fe lv lw lx ly b">new_image.jpg</code>保存。</p></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><p id="5152" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文到此为止。如果你有建议或问题，请在评论中告诉我。</p></div></div>    
</body>
</html>