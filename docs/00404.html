<html>
<head>
<title>A Short Introduction to ggvis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ggvis简介</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-short-introduction-to-ggvis-52a4c104df71?source=collection_archive---------26-----------------------#2020-01-12">https://towardsdatascience.com/a-short-introduction-to-ggvis-52a4c104df71?source=collection_archive---------26-----------------------#2020-01-12</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="5a71" class="pw-subtitle-paragraph js it iu bd b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj dk translated">例谈图形的语法</h2></div><p id="b32f" class="pw-post-body-paragraph kk kl iu km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf in bi translated"><em class="lg">Grammar of Graphics</em>是Leland Wilkinson在图形领域数十年工作和研究的成果，它为<strong class="km iv"> R </strong>图形库提供了哲学基础，如<em class="lg"> ggplot2、ggvis </em>和<strong class="km iv"> Julia </strong>图形库，如<em class="lg">牛虻。虽然，还有其他库可以为您提供真正令人惊叹的图形，但这些包的不同之处在于，它们基于Wilkinson所做的研究，该研究试图将图形视为一种语言，并将其分解为单独的组件，就像任何其他语言将其组件分解为主语、动词、宾语等。</em></p><p id="e67d" class="pw-post-body-paragraph kk kl iu km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf in bi translated">威尔金森在20世纪70年代早期写了一个以其全面的图形而闻名的统计软件包，后来他在90年代中期把它卖给了SPSS。在SPSS工作的时候，他写了他的突破性的研究，不久前提到过。他的研究对计算机科学中的图形哲学产生了重大影响。由Winston Chang和Hadley Wickham维护的<strong class="km iv">R</strong>gg plot 2中最著名的绘图软件包，其基本原理来自于<em class="lg">图形语法。另一个这样的软件包是ggvis。我们会谈到后者。</em></p><figure class="li lj lk ll gu lm gi gj paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gi gj lh"><img src="../Images/5f1b012638b906f76e9c496965c56a79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GuH6iZHv3wE1GC9fiRvybQ.jpeg"/></div></div><p class="lt lu gk gi gj lv lw bd b be z dk translated">由<a class="ae lx" href="https://unsplash.com/@jcoudriet?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Jason Coudriet </a>在<a class="ae lx" href="https://unsplash.com/s/photos/chart?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="ccd5" class="ly lz iu bd ma mb mc md me mf mg mh mi kb mj kc mk ke ml kf mm kh mn ki mo mp bi translated">为什么是ggvis而不是ggplot2？</h1><p id="c2f7" class="pw-post-body-paragraph kk kl iu km b kn mq jw kp kq mr jz ks kt ms kv kw kx mt kz la lb mu ld le lf in bi translated">《T21》本身就是一个了不起的包。ggvis没有从中拿走任何东西，相反，它只是前者的扩展，具有构建HTML图形的能力。因为ggvis图形是HTML，所以它们可以用在一个漂亮的web应用程序、R markdown报告中，也可以和JavaScript一起使用。一会儿我们会弄清楚其中一些意味着什么。</p><h2 id="9297" class="mv lz iu bd ma mw mx dn me my mz dp mi kt na nb mk kx nc nd mm lb ne nf mo ng bi translated"><strong class="ak">资源</strong></h2><p id="a09f" class="pw-post-body-paragraph kk kl iu km b kn mq jw kp kq mr jz ks kt ms kv kw kx mt kz la lb mu ld le lf in bi translated">关于<em class="lg"> ggvis </em>的文档可以在<a class="ae lx" href="https://www.rdocumentation.org/packages/ggvis/versions/0.4.3/readme" rel="noopener ugc nofollow" target="_blank">这里</a>找到，还有一个关于<a class="ae lx" href="https://www.datacamp.com/courses/ggvis-data-visualization-r-tutorial" rel="noopener ugc nofollow" target="_blank">数据营</a>的非常好的教程。如需更多信息，您可以访问<em class="lg"> ggvis </em>  <em class="lg"> </em>上的<a class="ae lx" href="https://blog.rstudio.org/2014/06/23/introducing-ggvis/" rel="noopener ugc nofollow" target="_blank"> RStudio的博客，以及一份关于</a><a class="ae lx" href="http://civilstat.com/2012/09/the-grammar-of-graphics-notes-on-first-reading/" rel="noopener ugc nofollow" target="_blank"> <em class="lg">图形</em> </a> <em class="lg">语法的简明摘要。</em>本帖的<strong class="km iv">主要目的</strong>是<strong class="km iv">探究和理解<em class="lg"> ggvis </em> </strong> <em class="lg">的<em class="lg">语法</em>和<em class="lg">句法</em>。</em></p><pre class="li lj lk ll gu nh ni nj nk aw nl bi"><span id="5b00" class="mv lz iu ni b gz nm nn l no np">$ religiongdp &lt;- read.table("/Users/kovid.rathee/Downloads/ReligionGDP.csv", header=TRUE, sep=",")<br/>$ religiongdp %&gt;% ggvis (~GDP, ~Religiosity) %&gt;% layer_points()</span></pre><p id="f83a" class="pw-post-body-paragraph kk kl iu km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf in bi translated">我们首先要了解的是从<a class="ae lx" href="https://cran.r-project.org/web/packages/magrittr/index.html" rel="noopener ugc nofollow" target="_blank"> <em class="lg">马格里特</em> </a> <em class="lg"> </em>包中取出的<em class="lg">管道</em>操作符<strong class="km iv"> % &gt; % </strong>。这就像<em class="lg">壳管</em>操作器的工作一样。</p><figure class="li lj lk ll gu lm gi gj paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gi gj nq"><img src="../Images/25431c51a9e99b63363fc2ab6abb0916.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UVRPRWeYNxJc7elhnWkmrg.png"/></div></div><p class="lt lu gk gi gj lv lw bd b be z dk translated">从第一张图片本身来看，这种模式很明显。越是宗教化的国家，越不繁荣(从GDP、幸福等方面来看)。这里不算，因为我们没有数据)他们是。不过，也有一些例外。但是，我们也可以从数据中看到这一点。为什么要创建图表？因为图表很容易理解。他们讲述完整的故事，而不是一篇十页的文章。他们让我们预测未来——或者至少他们应该让我们预测未来。</p></figure><pre class="li lj lk ll gu nh ni nj nk aw nl bi"><span id="a646" class="mv lz iu ni b gz nm nn l no np">religiongdp %&gt;% compute_smooth(GDP ~ Religiosity) %&gt;% ggvis (~pred_, ~resp_) %&gt;% layer_lines(stroke := "darkblue", strokeWidth := 3, strokeDash := 5)</span></pre><figure class="li lj lk ll gu lm gi gj paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gi gj nr"><img src="../Images/5002bb302d0545c451f798376f32ec02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZI_Q8SvPgHk5D9-MY6twzQ.png"/></div></div></figure><pre class="li lj lk ll gu nh ni nj nk aw nl bi"><span id="7530" class="mv lz iu ni b gz nm nn l no np">religiongdp %&gt;% compute_smooth(GDP ~ Religiosity) %&gt;% ggvis (~pred_, ~resp_) %&gt;% layer_points(fill := "darkblue", size = 0.5)</span></pre><h2 id="7b0d" class="mv lz iu bd ma mw mx dn me my mz dp mi kt na nb mk kx nc nd mm lb ne nf mo ng bi translated">回归和趋势线</h2><p id="1904" class="pw-post-body-paragraph kk kl iu km b kn mq jw kp kq mr jz ks kt ms kv kw kx mt kz la lb mu ld le lf in bi translated">用一条<em class="lg">有点像</em>的线来绘制原始数据。我们可以认为是一条<em class="lg">回归</em>线。数据集中的<em class="lg">特征</em>不足以进行适当的<em class="lg">分类</em>从而<em class="lg">猜测</em>一个国家或一个州的GDP应该是多少。除了宗教信仰，还有很多更重要的东西，比如人口，政府形式等等。但是，即使从这张图表中，我们也可以粗略地确定GDP和宗教信仰之间存在负相关关系——尽管有两个主要的例外，科威特和美国。我们可以称他们为<em class="lg">离群值</em>。</p><figure class="li lj lk ll gu lm gi gj paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gi gj ns"><img src="../Images/c09cb4bcedabb797a519fa47b36403c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k2_6fxXwTf5OndDHcf7J_A.png"/></div></div><p class="lt lu gk gi gj lv lw bd b be z dk translated">虽然橙色趋势线是数据的一个相当不错的表示，但如果我们在这里谈论做出预测，基于不同算法的分类，如KNearestNeighbour等。可能需要。这个想法是将所谓的离群值也放入算法运行其原因后将创建的许多类中的一个。</p></figure><p id="8929" class="pw-post-body-paragraph kk kl iu km b kn ko jw kp kq kr jz ks kt ku kv kw kx ky kz la lb lc ld le lf in bi translated">请注意重现右上角的<em class="lg">设置</em>按钮。当你点击那个按钮时，它会为你提供一个选项来下载一个<em class="lg"> svg </em>文件或者一个<em class="lg"> png </em>文件。</p><figure class="li lj lk ll gu lm gi gj paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gi gj nt"><img src="../Images/409b670e93f61a5c5c3d86cab9d396fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pJu_n8cNAcuzqu_kcNCA2Q.png"/></div></div><p class="lt lu gk gi gj lv lw bd b be z dk translated">你想要什么?可缩放矢量图形或便携式网络图形。阅读一些关于什么时候使用哪个的信息。</p></figure><h2 id="a1d1" class="mv lz iu bd ma mw mx dn me my mz dp mi kt na nb mk kx nc nd mm lb ne nf mo ng bi translated">交互式图表</h2><p id="101f" class="pw-post-body-paragraph kk kl iu km b kn mq jw kp kq mr jz ks kt ms kv kw kx mt kz la lb mu ld le lf in bi translated"><em class="lg"> ggvis </em>也有别于<em class="lg"> ggplot2 </em>，因为它具有类似<em class="lg">输入滑块的交互功能。</em>互动性是<em class="lg"> ggvis的主要成就之一。</em>它的工作方式与在Tableau或Qlikview环境中的工作方式相同，但是，当您使用这些库编写自己的代码时，您将对这些图形的渲染方式有更多的控制和更清晰的理解。这里有一个例子:</p><pre class="li lj lk ll gu nh ni nj nk aw nl bi"><span id="2a70" class="mv lz iu ni b gz nm nn l no np">religiongdp %&gt;% ggvis (~GDP, ~Religiosity) %&gt;% layer_points(fill := "darkblue", size := input_slider (5,15,value=1)) %&gt;% layer_smooths(stroke:="orange", span = input_slider (5,15,value=1))</span></pre><figure class="li lj lk ll gu lm gi gj paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gi gj nu"><img src="../Images/d65f313dbdbe33c7805e3139501b8b12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zU6pa8-mOjWini2J_64xGA.png"/></div></div><p class="lt lu gk gi gj lv lw bd b be z dk translated">带有滑块输入的图形。制作了一个非常好的交互式图表，可以嵌入到应用程序中。</p></figure><pre class="li lj lk ll gu nh ni nj nk aw nl bi"><span id="78cf" class="mv lz iu ni b gz nm nn l no np">iris %&gt;% ggvis(~Sepal.Length,~Sepal.Width,fill=~Species) %&gt;% layer_smooths(span = 2, stroke := “darkred”, strokeDash := 6) %&gt;% layer_smooths(span = 1, stroke := “darkblue”) %&gt;% layer_smooths(span = 0.5, stroke := “orange”)</span></pre><figure class="li lj lk ll gu lm gi gj paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gi gj nv"><img src="../Images/74abf41900d72cd051354e46c400ef6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zaKnwO6DvcPUAQOb4hN_-A.png"/></div></div><p class="lt lu gk gi gj lv lw bd b be z dk translated">只需使用%&gt;%运算符，就可以用不同的格式在图上定义不同的线。这让生活变得简单多了。</p></figure><pre class="li lj lk ll gu nh ni nj nk aw nl bi"><span id="a853" class="mv lz iu ni b gz nm nn l no np">iris %&gt;% ggvis(~Sepal.Length,~Sepal.Width,fill=~Species) %&gt;% layer_points() %&gt;% add_axis ("x",title="Sepal Length",properties=axis_props(axis=list(stroke="darkblue"),grid=list(stroke="brown",strokeDash=3),ticks=list(stroke="orange",strokeWidth=2),labels=list(angle=45, align="left", fontSize=12)))</span></pre><figure class="li lj lk ll gu lm gi gj paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gi gj nw"><img src="../Images/0d8bedf5b951229fa2460a54c9a6bce0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7k2Isb-kcE2Cw0pjk-_utA.png"/></div></div><p class="lt lu gk gi gj lv lw bd b be z dk translated">著名Iris数据集的基本点状图。在这种情况下，我们可以通过颜色来识别花的种类，位置代表了叶子的尺寸——长度和宽度。</p></figure><pre class="li lj lk ll gu nh ni nj nk aw nl bi"><span id="06df" class="mv lz iu ni b gz nm nn l no np">iris %&gt;% ggvis (~Sepal.Length,~Sepal.Width) %&gt;% mutate(Sepal.Length = Sepal.Length * 1.5) %&gt;% layer_points(fill=~Species,size=~Petal.Width) %&gt;% add_axis(“x”,title=”Sepal Length”,orient=”top”) %&gt;% add_axis(“y”,title=”Sepal Width”,orient=”right”) %&gt;% add_legend(c(“size”,”fill”),title=”Petal Width”))</span></pre><figure class="li lj lk ll gu lm gi gj paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gi gj nx"><img src="../Images/c63bfc4b58199deed59fa79ec84648b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kZB7AriCmByt0B3Ebx5j7g.png"/></div></div><p class="lt lu gk gi gj lv lw bd b be z dk translated">在这里，我们试图添加另一个变量到图中。花瓣宽度——除了能够绘制萼片尺寸和通过颜色识别物种，我们还可以通过一个点的强度/大小来表示花瓣宽度。</p></figure><pre class="li lj lk ll gu nh ni nj nk aw nl bi"><span id="52c1" class="mv lz iu ni b gz nm nn l no np">iris %&gt;% ggvis(x=~Sepal.Length,y=~Petal.Length,fill=~Species) %&gt;% layer_points(opacity=~Sepal.Width) %&gt;% layer_model_predictions(model="lm",stroke:="green",opacity=3)</span></pre><figure class="li lj lk ll gu lm gi gj paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gi gj ns"><img src="../Images/b9c169b8c8fc6cf304665a54278d07a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0rX9XR5ORbTadJjmBvV38w.png"/></div></div><p class="lt lu gk gi gj lv lw bd b be z dk translated">使用图层模型预测的线性拟合线。有很多预定义的模型可以用来绘图。线性拟合线在这里没有什么意义。但如果是这样的话，它应该是这样的。</p></figure><pre class="li lj lk ll gu nh ni nj nk aw nl bi"><span id="0722" class="mv lz iu ni b gz nm nn l no np">iris %&gt;% ggvis(x=~Sepal.Length,y=~Petal.Length,fill=~Species) %&gt;% layer_points(opacity=~Sepal.Width) %&gt;% layer_model_predictions(model="loess",stroke:="green",opacity=3)</span></pre><figure class="li lj lk ll gu lm gi gj paragraph-image"><div role="button" tabindex="0" class="ln lo di lp bf lq"><div class="gi gj ny"><img src="../Images/af2cb182ad39b59db0b51b731a631feb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZAtg7vBY-hpfEiMPLnHhwA.png"/></div></div><p class="lt lu gk gi gj lv lw bd b be z dk translated">可能，不正确的例子使不透明度成为萼片宽度的函数。但这对于可视化变量的强度、严重性和大小非常有用——这些变量无法绘制在x-y平面上。</p></figure><h2 id="c92b" class="mv lz iu bd ma mw mx dn me my mz dp mi kt na nb mk kx nc nd mm lb ne nf mo ng bi translated">结论</h2><p id="37fb" class="pw-post-body-paragraph kk kl iu km b kn mq jw kp kq mr jz ks kt ms kv kw kx mt kz la lb mu ld le lf in bi translated"><em class="lg"> ggvis </em>是一个很棒的包，它提供了对<em class="lg"> ggplot2 </em>的升级，具有许多新时代的功能，如交互式绘图和创建HTML绘图的能力，使这些绘图能够嵌入到闪亮的应用程序中等等。威尔金森的工作极大地影响了绘图语言中的话语——这是日常工作，同时进行数据分析、商业智能、机器学习等。</p></div></div>    
</body>
</html>