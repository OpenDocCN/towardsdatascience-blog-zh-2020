<html>
<head>
<title>A Practical Guide for Exploratory Data Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索性数据分析实用指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-practical-guide-for-exploratory-data-analysis-5ab14d9a5f24?source=collection_archive---------38-----------------------#2020-04-29">https://towardsdatascience.com/a-practical-guide-for-exploratory-data-analysis-5ab14d9a5f24?source=collection_archive---------38-----------------------#2020-04-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b658" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">听数据，好奇又认真！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d0375c9019949f54b5f2697b7da69051.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WJBi3Bqfwe16JZVtwwUOTg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">艾玛·弗朗西斯·洛根在<a class="ae ky" href="https://unsplash.com/s/photos/explore?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="d3c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每一个机器学习或深度学习模型的燃料都是数据。没有数据，模型是没有用的。在建立模型和训练模型之前，我们应该尝试探索和理解手头的数据。我所说的理解是指数据中的相关性、结构、分布、特征和趋势。对数据的全面理解将非常有助于构建一个稳健且设计良好的模型。我们可以通过研究数据得出有价值的结论。</p><p id="7c68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将对 Kaggle 上的电信客户流失数据集进行探索性的数据分析。</p><p id="303d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从将数据读入熊猫数据帧开始:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7af6" class="ma mb it lw b gy mc md l me mf">import numpy as np<br/>import pandas as pd</span><span id="376d" class="ma mb it lw b gy mg md l me mf">df = pd.read_csv("Telco-Customer-Churn.csv")</span></pre><p id="ddd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先要做的是检查我们有什么。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5208" class="ma mb it lw b gy mc md l me mf">df.shape<br/>(7043, 21)</span><span id="5868" class="ma mb it lw b gy mg md l me mf">df.columns<br/>Index(['customerID', 'gender', 'SeniorCitizen', 'Partner', 'Dependents','tenure', 'PhoneService', 'MultipleLines', 'InternetService','OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport','StreamingTV', 'StreamingMovies', 'Contract', 'PaperlessBilling',<br/>'PaymentMethod', 'MonthlyCharges', 'TotalCharges', 'Churn'],<br/>dtype='object')</span></pre><p id="d1b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据集包括 7043 个观测值(行)和每个观测值的 21 个特征(列)。一个特征“客户流失”是目标变量，这是我们使用其他 20 个特征预测的目标变量。目标变量是因变量，其他 20 个特征是自变量。</p><p id="1584" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用<strong class="lb iu">头</strong>方法来看看数据帧的前 5 行:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/2ce1105b729ef8cf770bb76804bf675e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YVbusAspBhwSGfgSJTOjWg.png"/></div></div></figure><p id="8f09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然 dataframe 有 21 列，但只有 10 列适合屏幕显示。使用以下代码可以很容易地更改该选项:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a708" class="ma mb it lw b gy mc md l me mf">pd.set_option("display.max_columns", 21)</span></pre><p id="6ccd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该数据集经过预先清理，因此没有任何缺失值，但检查和处理缺失值是一个良好的做法:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7f24" class="ma mb it lw b gy mc md l me mf">df.isna().sum().sum()<br/>0</span></pre><p id="8e54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们没有像预期的那样丢失任何值。df.isna()。sum()返回每列中缺失值的数量。通过再加一个总和，我们可以看到整个数据帧中缺失值的总数。以下是关于如何查找和处理缺失值的详细帖子:</p><div class="mi mj gp gr mk ml"><a rel="noopener follow" target="_blank" href="/handling-missing-values-with-pandas-b876bf6f008f"><div class="mm ab fo"><div class="mn ab mo cl cj mp"><h2 class="bd iu gy z fp mq fr fs mr fu fw is bi translated">用熊猫处理缺失值</h2><div class="ms l"><h3 class="bd b gy z fp mq fr fs mr fu fw dk translated">关于如何检测和处理缺失值的完整教程</h3></div><div class="mt l"><p class="bd b dl z fp mq fr fs mr fu fw dk translated">towardsdatascience.com</p></div></div><div class="mu l"><div class="mv l mw mx my mu mz ks ml"/></div></div></a></div><p id="dd02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我认为最好开始探索目标变量，因为最终，我们将建立一个模型来预测目标变量。我们可以使用<strong class="lb iu"> value_counts() </strong>来检查目标变量的分布，或者将其可视化:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d503" class="ma mb it lw b gy mc md l me mf">df.Churn.value_counts()<br/>No     5174<br/>Yes    1869<br/>Name: Churn, dtype: int64</span><span id="c2dc" class="ma mb it lw b gy mg md l me mf">plt.figure(figsize=(10,6))<br/>sns.countplot('Churn', data=df).set_title('Distribution of Target Variable')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/4ba40c7f66d56beccbca9115425218fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*PMrFmzwXSXVVQuFsNSkZMQ.png"/></div></div></figure><p id="13b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目标变量具有不平衡的类分布。正类(流失=是)远小于正类(流失=否)。不平衡的类别分布会对机器学习模型的性能产生负面影响。上采样或下采样可以用来克服这个问题。向上采样是通过随机选择样本中的行来增加样本较少的类的样本数。下采样是应用于主导类以减少观察数量的类似过程。</p><p id="a0f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也来看看自变量的分布。我们可以从二元分类特征开始:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f844" class="ma mb it lw b gy mc md l me mf">fig, axes = plt.subplots(2, 3, figsize=(12, 7), sharey=True)</span><span id="e2e0" class="ma mb it lw b gy mg md l me mf">sns.countplot("gender", data=df, ax=axes[0,0])<br/>sns.countplot("SeniorCitizen", data=df, ax=axes[0,1])<br/>sns.countplot("Partner", data=df, ax=axes[0,2])<br/>sns.countplot("Dependents", data=df, ax=axes[1,0])<br/>sns.countplot("PhoneService", data=df, ax=axes[1,1])<br/>sns.countplot("PaperlessBilling", data=df, ax=axes[1,2])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/b07868b7a5c50e25a15bc1a49034e3d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WmJG6w2acy7EbqiHNLmZ8g.png"/></div></div></figure><p id="b555" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">老年人和电话服务变量之间存在严重的不平衡。大多数顾客都不是老年人，而且大多数顾客都有电话服务。</p><p id="f66a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还应该检查其他分类变量的分布。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="1cf3" class="ma mb it lw b gy mc md l me mf">sns.countplot("InternetService", data=df)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/e8bcf3ffb2ad03de2ac25db1de5f5940.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*r1mGpbBgHVz1x6nwbKTPnw.png"/></div></figure><p id="7e8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">光纤比 DSL 更常用，也有没有互联网服务的客户。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="e921" class="ma mb it lw b gy mc md l me mf">fig, axes = plt.subplots(2, 3, figsize=(12, 7), sharey=True)</span><span id="ac5e" class="ma mb it lw b gy mg md l me mf">sns.countplot("StreamingTV", data=df, ax=axes[0,0])<br/>sns.countplot("StreamingMovies", data=df, ax=axes[0,1])<br/>sns.countplot("OnlineSecurity", data=df, ax=axes[0,2])<br/>sns.countplot("OnlineBackup", data=df, ax=axes[1,0])<br/>sns.countplot("DeviceProtection", data=df, ax=axes[1,1])<br/>sns.countplot("TechSupport", data=df, ax=axes[1,2])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/bedb4f52d27e1a69faf89b0822c1d247.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RA0HYohsMmKXrHrjNRJyHA.png"/></div></div></figure><p id="01b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些变量的共同点是“无互联网服务”类别，因此只有当客户有互联网服务时，这些变量才会发挥作用。在选择特征和构建模型时，我们应该记住这一点。</p><p id="8837" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“合同”和“支付方法”也是分类变量，因此我们可以类似地检查它们。</p><p id="5dfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看连续变量的分布。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0bde" class="ma mb it lw b gy mc md l me mf">fig, axes = plt.subplots(1,2, figsize=(12, 7))</span><span id="aa9c" class="ma mb it lw b gy mg md l me mf">sns.distplot(df["tenure"], ax=axes[0])<br/>sns.distplot(df["MonthlyCharges"], ax=axes[1])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/c5dc6b525a522705c53bf544534a3861.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O8Tw255zXQ-JG43CRa1sOg.png"/></div></div></figure><p id="f666" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保有权变量显示客户已经成为客户多少个月了。大多数顾客都是新会员或老会员。从月费分布一栏可以看出，大多数客户支付的是最低月费。情况可能是，该公司为新员工提供了相当不错的待遇。</p><p id="0ff5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自变量与目标(因变量)的关系也很重要。我们需要揭示相关性，看看每个特征如何影响目标变量。</p><p id="6e7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用<strong class="lb iu">相关矩阵</strong>来表示连续变量，或者使用<strong class="lb iu"> groupby </strong>函数来探索分类变量。在开始这一步之前，我们需要在目标变量中做一个小的操作。“流失”列中的类别表示为“是”和“否”。对于数值分析，我们需要将“是”改为 1，将“否”改为 0:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9ec5" class="ma mb it lw b gy mc md l me mf">new = {'Yes':1, 'No':0}<br/>df.Churn = df.Churn.replace(new)</span></pre><p id="7636" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们从“老年人”和“伴侣”特征开始。只要您详细研究每个变量，顺序并不重要:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/0264a7c8455422f6edd5871aa99bd4ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*5FUXgfxI1maISKyYRaaYTA.png"/></div></figure><p id="f717" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些数字告诉我们什么？我们根据每个类别对客户进行分组，并计算平均流失率。记住 1 表示客户流失，因此平均值越高，该群体流失的可能性越大。看来老年人比非老年人更容易流失。有一个合作伙伴可以降低流失率。</p><p id="b683" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们再检查几个:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/0785697de17bb76c863350d580415471.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*8d4nOjgSjNZ7kef4Ad0qdw.png"/></div></figure><p id="027c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如“家属”一栏所暗示的，单身人士更有可能变动，这是有道理的，因为当我们安定下来后，一般来说，我们不容易改变。拥有电话服务对客户流失率的影响很小。</p><p id="0981" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我真的很想知道性别对流失率有没有影响。让我们检查一下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/ff887aa985c5e891a9b142ef37332a85.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*61BhiSoaGOhUkUdwFlgnMQ.png"/></div></figure><p id="9c1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">男性和女性的流失率几乎相同。</p><p id="2696" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我怀疑任期和合同变量高度相关，因为如果客户有长期合同，他们会呆得更久。让我们检查一下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/eeb014babc9fcb1c84e83f1dbf42015e.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*ZfOvNpIegNmdF8teciigRA.png"/></div></figure><p id="2907" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果证实了我的怀疑。在这种情况下，没有必要在预测模型中使用这两个变量。包括其中之一就足够了。</p><p id="4e9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以进一步分析并研究一些组合特征。例如，对于有受抚养人的人，流失率如何根据互联网服务类型而不同？我们可以简单地用<strong class="lb iu"> pivot_table </strong>函数来回答这个问题:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/2ba217b23c8385d275987322903ff0f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*m28lpoU2aAlIJtCxm3M-Wg.png"/></div></figure><p id="0320" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用相关矩阵来寻找连续特征之间的相关性。<strong class="lb iu"> corr() </strong>方法可应用于数据帧，结果也可使用<strong class="lb iu">热图</strong>可视化:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/12b1838535ea4a22c23e7d059d47073d.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*sh0reI6n7F6TXbwT3-VDig.png"/></div></figure><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="ab42" class="ma mb it lw b gy mc md l me mf">plt.figure(figsize=(10,6))</span><span id="9783" class="ma mb it lw b gy mg md l me mf">sns.heatmap(corr, square=True, center=0.5, yticklabels=False).set_title('Correlation Matrix')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/ef66a8bbcf920b142432c3fa5ba9d076.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*vRDq3iyneRyM28zYwPffRQ.png"/></div></figure><p id="aadc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">y 轴上的变量顺序与 x 轴上的顺序相同(从上到下:流失、任期、月度费用)。任期和流失率之间存在负相关关系。客户在公司呆的时间越长，他/她流失的可能性就越小。</p><p id="1b13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以这种方式探索变量有助于我们更好地理解数据。我们将大致了解在实现模型时有用的变量。我们可以根据探索过程的结果决定消除或修改某些变量。如果结果相同，最好使用更简单的模型。</p><p id="1778" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以不经过任何计算就做出推论。例如，我们的数据集包括“任期”、“每月费用”和“总费用”列。总费用的价值与任期乘以每月费用成正比。因此，没有必要在模型中包含“TotalCharges”列。</p><h1 id="808a" class="nm mb it bd nn no np nq nr ns nt nu nv jz nw ka nx kc ny kd nz kf oa kg ob oc bi translated"><strong class="ak">结论</strong></h1><p id="a090" class="pw-post-body-paragraph kz la it lb b lc od ju le lf oe jx lh li of lk ll lm og lo lp lq oh ls lt lu im bi translated">探索性数据分析过程中使用的技术取决于任务和数据集的特征。但是，目标是一样的。我们试图探索和理解这些数据。在没有全面了解手头数据的情况下，永远不要急于构建模型。数据能告诉我们很多东西，所以我们应该仔细而好奇地倾听。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><p id="2c97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>