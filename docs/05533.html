<html>
<head>
<title>Used Again Machine Learning In My Workout, This Time Building a Personal TrAIner</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在我的锻炼中再次使用机器学习，这次是建立一个私人教练</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/used-again-machine-learning-in-my-workout-this-time-building-a-personal-trainer-3dfae9730c2b?source=collection_archive---------43-----------------------#2020-05-09">https://towardsdatascience.com/used-again-machine-learning-in-my-workout-this-time-building-a-personal-trainer-3dfae9730c2b?source=collection_archive---------43-----------------------#2020-05-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d319604dd17916c6c14370e0bdb0d723.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1JFGbT244tz-9wDknQDO6Q.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">以下完整视频</p></figure><p id="b756" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在<a class="ae la" rel="noopener" target="_blank" href="/just-used-machine-learning-in-my-workout-ff079b8e1939">之前的</a>故事中，我试图解决如何发现锻炼是否以正确的形式进行，使用OpenPose收集锻炼数据，并使用动态时间扭曲将锻炼执行与作为基线的正确执行进行比较。</p><p id="4240" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这一次，我添加了以下其他组件来大大增强整体体验:</p><ul class=""><li id="0a83" class="lb lc iq ke b kf kg kj kk kn ld kr le kv lf kz lg lh li lj bi translated">令人敬畏的面部识别库(【https://github.com/ageitgey/face_recognition】T2)，用于执行面部识别和加载适当的锻炼</li><li id="4651" class="lb lc iq ke b kf lk kj ll kn lm kr ln kv lo kz lg lh li lj bi translated">令人敬畏的语音识别(【https://github.com/Uberi/speech_recognition】T4)，用于处理用户的回答</li><li id="81ad" class="lb lc iq ke b kf lk kj ll kn lm kr ln kv lo kz lg lh li lj bi translated">令人敬畏的谷歌文本到语音转换(<a class="ae la" href="https://github.com/pndurette/gTTS" rel="noopener ugc nofollow" target="_blank">https://github.com/pndurette/gTTS</a>)，用来和用户交谈和指导</li></ul><p id="5961" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是工作流程的图形表示</p><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lp"><img src="../Images/0a829240d7504e4d60f4fbded62f4a06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*glA-0aT_9mVdrIYIZTxOFA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">基本流程——作者绘制</p></figure><p id="b995" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我仍然使用OpenPose的“dockerized”版本(<a class="ae la" href="https://github.com/garyfeng/docker-openpose" rel="noopener ugc nofollow" target="_blank">https://github.com/garyfeng/docker-openpose)</a>——本地安装相当长——调整一些参数也有可能实现良好的fps。</p><p id="8909" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">体验非常简单:</p><ul class=""><li id="0706" class="lb lc iq ke b kf kg kj kk kn ld kr le kv lf kz lg lh li lj bi translated">你进入锻炼区域，面部识别组件匹配你的面部，提取一个轮廓(现在只是一个名字)</li><li id="d76d" class="lb lc iq ke b kf lk kj ll kn lm kr ln kv lo kz lg lh li lj bi translated">培训师会问你是否准备好开始，并等待你的回答(至少回答“是”——这一部分是按照脚本编写的，当然，可以用更复杂的解决方案来扩展)</li><li id="52c8" class="lb lc iq ke b kf lk kj ll kn lm kr ln kv lo kz lg lh li lj bi translated">教练将你的相关“wod”(一天中的锻炼)与要进行的练习(目前只有一项)一起载入</li><li id="7ee2" class="lb lc iq ke b kf lk kj ll kn lm kr ln kv lo kz lg lh li lj bi translated">在OpenPose组件记录身体数据的同时，您可以执行练习重复和设置</li><li id="0c77" class="lb lc iq ke b kf lk kj ll kn lm kr ln kv lo kz lg lh li lj bi translated">教练将收集的数据与正确的基线进行比较，评估身体每个部位的动态时间弯曲值，最后给出一个中值。</li><li id="9d13" class="lb lc iq ke b kf lk kj ll kn lm kr ln kv lo kz lg lh li lj bi translated">如果该值低于某个阈值，则认为锻炼是正确的，教练给出该反馈，否则它会发出警告(目前是一般的警告，但是应该可以根据哪些身体部位是不正确的给出具体的提示)</li><li id="834b" class="lb lc iq ke b kf lk kj ll kn lm kr ln kv lo kz lg lh li lj bi translated">重复，直到所有的重复完成</li></ul><p id="444a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">但是让我们来看看实际情况——很抱歉视频编辑，肯定是我做得不好:)</p><figure class="lq lr ls lt gt jr"><div class="bz fp l di"><div class="lu lv l"/></div></figure><p id="d449" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我努力工作来获得一个体面的经历，但是，当然，还有很多事情要做。</p><p id="7961" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">例如，现在锻炼估计是有时间限制的，但是应该可以训练系统理解锻炼何时开始和结束，丢弃其他帧用于评估。</p><p id="a3f2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">此外，这只是一种独特的锻炼类型(引体向上),是专门用我的身体测量值进行的基线正确锻炼，但应该可以用通用基线进行不同的锻炼。</p><p id="4a75" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">关于执行过程中具体错误的更精确的反馈是另一个有趣的研究点。</p><p id="a992" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">实现了这一点，它可以用于任何类型的锻炼(健身，瑜伽等)，也可以用于对象(使用自定义跟踪对象算法)，在独立模式下，或作为真正的教练的助手。</p><p id="05b1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是另一个例子，展示了结合不同的工具和库，在几个小时内可以实现什么，这在几年前是不可想象的，并且一直让我感到惊讶！</p><p id="fb1c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我希望你喜欢看这个(但是也看看上面的视频)，谢谢你！</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="754f" class="md me iq bd mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na bi translated">附录</h1><p id="2dc4" class="pw-post-body-paragraph kc kd iq ke b kf nb kh ki kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ij bi translated">让我们来看一些代码，看看执行人脸识别和文本到语音转换是多么简单。</p><p id="4bfc" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于OpenPose部分和练习评价，只需参考我的<a class="ae la" rel="noopener" target="_blank" href="/just-used-machine-learning-in-my-workout-ff079b8e1939">以前的故事</a>附录</p><h2 id="2e9f" class="ng me iq bd mf nh ni dn mj nj nk dp mn kn nl nm mr kr nn no mv kv np nq mz nr bi translated">人脸识别</h2><p id="1356" class="pw-post-body-paragraph kc kd iq ke b kf nb kh ki kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ij bi translated">只是使用了演示部分的代码</p><p id="332d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">所有的魔法都在编码中。一旦一张已知的脸被编码，你就可以把它和相机捕捉到的画面进行比较</p><pre class="lq lr ls lt gt ns nt nu nv aw nw bi"><span id="c388" class="ng me iq nt b gy nx ny l nz oa">antonello_image = face_recognition.load_image_file("faces/anto.jpg")</span><span id="488a" class="ng me iq nt b gy ob ny l nz oa">antonello_image_encoding = face_recognition.face_encodings(antonello_image)[0]</span></pre><h2 id="d207" class="ng me iq bd mf nh ni dn mj nj nk dp mn kn nl nm mr kr nn no mv kv np nq mz nr bi translated">交谈并处理答案</h2><p id="e8f7" class="pw-post-body-paragraph kc kd iq ke b kf nb kh ki kj nc kl km kn nd kp kq kr ne kt ku kv nf kx ky kz ij bi translated">只是将文本保存到mp3文件中，然后播放它来说话</p><pre class="lq lr ls lt gt ns nt nu nv aw nw bi"><span id="a3a1" class="ng me iq nt b gy nx ny l nz oa">def say(text, language = 'en'):<br/>    speech = gTTS(text = text, lang = language, slow = False)<br/>    mp3_file = 'text.mp3'<br/>    speech.save(mp3_file)<br/>    p = vlc.MediaPlayer(mp3_file)<br/>    p.play()<br/>    time.sleep(2)</span></pre><p id="820c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了处理答案，我们使用谷歌引擎。</p><p id="849f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">代码超级简单</p><pre class="lq lr ls lt gt ns nt nu nv aw nw bi"><span id="998b" class="ng me iq nt b gy nx ny l nz oa">def process_answer():<br/>    recognizer = sr.Recognizer()<br/>    microphone = sr.Microphone()<br/>    with microphone as source:<br/>        recognizer.adjust_for_ambient_noise(source)<br/>        audio = recognizer.listen(source)</span><span id="22ee" class="ng me iq nt b gy ob ny l nz oa">try:<br/>        response = recognizer.recognize_google(audio)<br/>        print('Received response {}'.format(response))<br/>    except sr.RequestError:<br/>        print('Error')<br/>    except sr.UnknownValueError:<br/>        response = 'Sorry I cannot understand'</span><span id="8c45" class="ng me iq nt b gy ob ny l nz oa">return response</span></pre><p id="df16" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">把所有这些放在一起，你可以进行一个基本的对话</p><pre class="lq lr ls lt gt ns nt nu nv aw nw bi"><span id="2aa6" class="ng me iq nt b gy nx ny l nz oa">person = recognize() # using the face recognition</span><span id="dd55" class="ng me iq nt b gy ob ny l nz oa">say('Hello ' + person + ', are you ready?')</span><span id="1f6c" class="ng me iq nt b gy ob ny l nz oa">response = process_answer()</span><span id="e453" class="ng me iq nt b gy ob ny l nz oa">if ('yes' in response):<br/>   say('Ok, let\'s start')<br/>else:<br/>   say('No problem, maybe tomorrow')</span></pre></div></div>    
</body>
</html>