<html>
<head>
<title>An Experiment Assignment Mechanism to Maximize Precision</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一种最大化精度的实验分配机制</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-experiment-assignment-method-all-data-scientists-should-know-e4d57d96b26b?source=collection_archive---------33-----------------------#2020-03-08">https://towardsdatascience.com/an-experiment-assignment-method-all-data-scientists-should-know-e4d57d96b26b?source=collection_archive---------33-----------------------#2020-03-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6b7c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">最优分层随机分配</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/61c21fc242e6d1fb0b4d7497d8873195.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*22TEWo71_NnvqOj7FRoZvA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://pixabay.com/photos/vaccine-chemist-syringe-stopwatch-4892059/" rel="noopener ugc nofollow" target="_blank">https://pix abay . com/photos/vaccine-chemist-注射器-秒表-4892059/ </a></p></figure><p id="6262" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">丹·万鲁宁</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h1 id="19b5" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">为什么这很重要</h1><p id="d29a" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">随机实验是因果推断的黄金标准:如果你想得到一个治疗效果的无偏(你的估计方法的平均值是真实值)估计，随机实验是最好的方法。</p><p id="a032" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是实验是昂贵的，你收集的数据越多，花费就越大。使用这篇文章中的方法，你可以提高你的实验精度，这样你就可以用更少的数据和更少的成本来测量效果。</p><p id="e31c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你对实验感兴趣，我建议你也看看我的其他帖子</p><ul class=""><li id="cf98" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/practical-experiment-fundamentals-all-data-scientists-should-know-f11c77fea1b2">实际实验基础知识所有数据科学家都应该知道</a></li><li id="9c3c" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated"><a class="ae kv" rel="noopener" target="_blank" href="/get-a-grip-when-to-add-covariates-in-a-linear-regression-f6a5a47930e5?source=friends_link&amp;sk=fa2da69f55faa9641bdc8e19bb3ce4af">冷静点！何时将协变量加入线性回归</a></li></ul><h1 id="0098" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">方法的高级概要</h1><p id="0f6f" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">这篇文章概述了一种在随机实验中实现最佳分层的方法。</p><p id="a100" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该战略如下:</p><ol class=""><li id="b4fc" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr nf mx my mz bi translated">使用实验前协变量，建立一个模型来预测你感兴趣的结果。</li><li id="44d5" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">根据上一步中训练的模型的预测结果，对您的实验单位(您分配治疗的人群级别:此处区域)进行排序。</li><li id="22b6" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">将治疗随机分配给预测结果最高的两个单元之一，以及预测结果第三和第四高的两个单元之一，依此类推，直到将治疗分配给预测结果最低的两个单元之一。</li><li id="4052" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">然后，为了测量治疗对结果的影响，回归结果~ b0 + b1治疗+ b[2:N/2+1]对_指标。最后一步中治疗指标的系数是治疗对结果的影响。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/3cf3d9b408fc628245565bebc52426f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9GCaybANSVdRei6SF13Frg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">参见<a class="ae kv" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=2ahUKEwiC-I_00P_nAhVOhOAKHaEBASUQFjAAegQIAhAC&amp;url=https%3A%2F%2Fscholar.harvard.edu%2Ffiles%2Ftbarrios%2Ffiles%2Fopstratv17_0.pdf&amp;usg=AOvVaw1NwZ4ew2X2CWugbWlzKEug" rel="noopener ugc nofollow" target="_blank">论文第18页</a></p></figure><p id="0edb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">直观地说，这是分层随机分配，其中每一层是一对实验单元，它们对感兴趣的结果具有非常相似的预测值。</p><p id="f893" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个职位的其余部分将通过</p><ol class=""><li id="b8f7" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr nf mx my mz bi translated">用玩具数据将事物具体化的示例实验</li><li id="88d1" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">最简单的分配和效果评估策略</li><li id="f481" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">最优策略</li><li id="90ca" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">为什么协变量不如最优策略有效</li></ol><h1 id="8847" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">示例实验</h1><p id="ffcc" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">假设我们拥有一家专门从事狗旅行的公司。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nh"><img src="../Images/a82a466f5676f00e590d8c53995767a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y9dSfoJDKkU8zUSJ5T6vYw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://pixabay.com/photos/dog-mountain-mombarone-clouds-190056/" rel="noopener ugc nofollow" target="_blank">https://pix abay . com/photos/dog-mountain-mombarone-clouds-190056/</a></p></figure><p id="e2bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们想衡量一个电视广告对我们收入的影响。电视广告可以分布到不同的地理区域。为了衡量电视广告的影响，我们可以衡量(I)播放电视广告的地区和(ii)没有播放电视广告的地区之间的收入差异。</p><p id="c7d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们建立一个玩具数据集来说明这个例子。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="71fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该数据集的关键要素是:</p><ul class=""><li id="9d1d" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">收入与协变量相关:人口。这种关系是非线性的。</li><li id="a912" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">如果该地区接受治疗，试验期的收入平均会高出1%。这就是我们试图测量的效果。</li></ul><p id="22d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">散点图显示了这些元素:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/627e1bf25ff48f58558f32eb90e5dd17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQrgZ1b-EPTnoguvuOGAmg.png"/></div></div></figure><p id="df3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还将创建一个助手函数，将实际观察到的收入添加到我们的数据中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="832f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，让我们转向一个简单的回归，可以衡量这种治疗效果。</p><h1 id="f70a" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">测量效果</h1><h2 id="f4e7" class="nj lv iq bd lw nk nl dn ma nm nn dp me lf no np mg lj nq nr mi ln ns nt mk nu bi translated">回归</h2><p id="5f0f" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">为了衡量收入的相对变化，我们可以使用以下回归方法:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/e9abfbf0a5921b0b7cbcc66af500aa09.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*rC0IgvLOY-8r5X6dvIbzXg.png"/></div></figure><p id="cc1e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果该区域接受了治疗，则为1，否则为0。</p><p id="ac7b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么，β₁可以解释为治疗对收入的比例影响:如果一个单位接受治疗，收入将增加</p><p id="cea3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">100(1-e^β₁)% ≈ 100β₁%</p><p id="aea5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我们对β₁的预期范围的一个很好的近似值(在我们的玩具数据中接近1%)。</p><h2 id="b1f2" class="nj lv iq bd lw nk nl dn ma nm nn dp me lf no np mg lj nq nr mi ln ns nt mk nu bi translated">简单随机分配</h2><p id="5bdf" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">作为第一个原则，我们需要随机分配。否则，我们可能会得到一个有偏差的测量。例如，如果我们决定将广告发送到前期收入最高的所有地区，那么当我们运行上述回归时，我们可能会看到非常大的治疗效果，因为我们将前期收入较大的效果归因于治疗。但是如果我们随机处理，就不会存在这样的混淆变量。</p><p id="3a5d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们在这个实验中测量效果的最简单的方法是随机分配一半的地理位置来获取广告，然后运行前一部分的回归。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/aefb3be624f4f00640bb1f68481c5eac.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*9V-xrnuGzjTB5Ltz0KI1pQ.png"/></div></figure><p id="6182" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们发现一个估计并不像我们希望的那样接近实际效果水平:当它是1%的效果时，我们测量的是2.2%的效果。</p><p id="72e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们如何改变我们的分配机制来更精确地测量这1%的影响？</p><h1 id="121b" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">最优分层分配</h1><p id="38a9" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">这篇文章旨在解决的关键问题是:我们如何分配哪些地区应该得到广告(治疗)以获得我们需要的数据来尽可能精确地估计广告的影响。答案是:分层分配，不同的阶层有相似的结果值。</p><p id="fe48" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们为流程的每一步创建函数。</p><ol class=""><li id="312c" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr nf mx my mz bi translated">预测结果，将具有相似预测结果的地理位置(单位)对分配给阶层(随机分配治疗的群体)</li><li id="ad09" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">在层内随机分配治疗</li><li id="c791" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr nf mx my mz bi translated">衡量效果</li></ol><h2 id="8645" class="nj lv iq bd lw nk nl dn ma nm nn dp me lf no np mg lj nq nr mi ln ns nt mk nu bi translated">预测结果和划分区域</h2><p id="782d" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">首先，让我们制作一个使用模型来预测结果的函数。然后，将具有相似预测结果的区域(单元)对分配给相同的层。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h2 id="9cd2" class="nj lv iq bd lw nk nl dn ma nm nn dp me lf no np mg lj nq nr mi ln ns nt mk nu bi translated">层内随机分配</h2><p id="9b6c" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">接下来，在每个层中，它将随机分配一半的单元进行治疗。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h2 id="c8ba" class="nj lv iq bd lw nk nl dn ma nm nn dp me lf no np mg lj nq nr mi ln ns nt mk nu bi translated">测量效果</h2><p id="f3aa" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">最后，一个衡量效果的函数。在这里，我们可以运行一个回归，每个层都有虚拟模型，但是这相当于使用“plm”的层固定效应。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h2 id="2c88" class="nj lv iq bd lw nk nl dn ma nm nn dp me lf no np mg lj nq nr mi ln ns nt mk nu bi translated">把它放在一起</h2><p id="606d" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">让我们用这种最优分配方法重新衡量一下效果。我们将使用简单的回归来预测前期收入:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><p id="b824" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后，我们将使用这个模型和我们创建的函数来测量效果。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/1687f6301965be1aa6011527814db8e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ex9YhGespFUCddKGCO7FrA.png"/></div></div></figure><p id="e6e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，结果更接近我们期望测量的1%!标准误差*比简单方法小一个数量级。</p><p id="a469" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这个方法！简单，但功能强大！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/71830cb8fb80a84f9ca3f04651008812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vrlb92QcFH8g4oyMysw8ZQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://pixabay.com/photos/flash-thunderstorm-super-cell-2568381/" rel="noopener ugc nofollow" target="_blank">https://pix abay . com/photos/flash-雷雨-超级细胞-2568381/ </a></p></figure><p id="22dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">*请注意，我们使用回归分析得出的默认错误，因为它们显示了本文的关键点，但考虑到我们的不确定性来自赋值，随机化推断可能是一个更好的主意。参见<a class="ae kv" rel="noopener" target="_blank" href="/practical-experiment-fundamentals-all-data-scientists-should-know-f11c77fea1b2">这篇文章，看看如何做随机化推断</a>。</p><p id="6ef1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇文章的剩余部分深入探讨了细节。</p><ul class=""><li id="cd28" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">我们不能用协变量来完成同样的事情吗？</li><li id="70c2" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">这种方法为什么有效？</li></ul><h1 id="109a" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">协变量</h1><p id="9e6e" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">让我们使用简单随机分配的数据，看看我们是否可以用协变量完成同样的事情:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/5c4f0b68c6017b4e9516b47f77e9afcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hksuzed2roWGc4scTBPQaw.png"/></div></figure><p id="bb73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所有这些结果仍然比优化分配差:如上所述，它们不太精确，点估计离真实值更远。为什么？</p><h1 id="6c34" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">为什么优化分层分配是最好的</h1><p id="c248" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">如果我们满足普通最小二乘法的一些标准假设(我们的结果和协变量之间的关系是线性的，单位之间不相互影响，治疗和影响结果的其他协变量之间没有相关性，homoskedastity—<a class="ae kv" href="https://stats.stackexchange.com/questions/16381/what-is-a-complete-list-of-the-usual-assumptions-for-linear-regression/400600#400600" rel="noopener ugc nofollow" target="_blank">请参见我的stats stackexchange帖子了解关键假设和含义</a>)治疗系数的OLS估计方差为:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/6686cca8bfb6559458fe9f1c695b0d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*gObK_Jcwhdb-GkQAbdj3Ww.png"/></div></figure><p id="34db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">分母中的总和是处理中的总样本变异。这可以通过将一半区域分配给治疗来最大化(并且它越高，我们的系数估计器越精确)。我们在所有的例子中都这样做了。</p><p id="f810" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">$(1-R _ {-treated })$ term是除了治疗之外，不能被我们的模型<strong class="ky ir">的所有元素解释的治疗中的变化的百分比(如果你将治疗的回归作为所有其他协变量的函数，它是1减去R)。这表明，如果你增加许多与治疗高度相关的特征，你的精确度就会降低。在我们的例子中，处理在所有情况下都是随机的，所以我们希望该项可以忽略不计(其他协变量不应该解释随机处理，所以$(1-R _ {-treated })$应该接近1)。</strong></p><p id="40c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">分子是回归的误差方差:如果我们的模型有更强的解释力，精度就会提高。这是我们的例子之间的关键区别。</p><ul class=""><li id="81f8" class="mr ms iq ky b kz la lc ld lf mt lj mu ln mv lr mw mx my mz bi translated">在回归中只有处理项的随机分配表现最差，因为它不能解释模型中只有处理的大量变化。</li><li id="e087" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">有协变量的模型做得更好，因为它们可以解释模型中人口和/或前期收入的更多结果变化。</li><li id="b1d3" class="mr ms iq ky b kz na lc nb lf nc lj nd ln ne lr mw mx my mz bi translated">具有最优分配和固定效果(与地层指标相同)的模型效果最佳。这是因为考虑到人口和收入之间的非线性关系，预测前期结果的模型在预测后期结果方面做得最好。我们可以添加更灵活的协变量函数来解释这种关系，但预测结果的模型可能会做得更好(特别是如果我们使用更灵活的模型，如随机森林)。</li></ul><p id="2203" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有协变量的模型被认为更差的另一个原因是因为回归产生方差加权平均处理效果:见本文第477页。当我们使用纯随机分配(非优化分层)时，我们仍然可能将相对更多的控制或处理区域分配给不同水平的协变量。在最终测量中，处理和对照水平更均衡的协变量水平(各约50%)将被赋予更大的权重。优化的方法避免了这一点，因为它确保我们将总是在每一对中分配一半的治疗和一半的控制，这样所有的协变量空间将大致相等地计数。</p><h1 id="ca2b" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">题外话:倾向得分</h1><p id="6ac1" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">你不应该使用倾向分数来创造随机的阶层。上面我们预测了感兴趣的结果，而倾向评分使用过去的数据预测治疗。使用倾向分数来匹配最终会在您的数据中产生更多的不平衡和更不可靠的结果。详情见此视频:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob lt l"/></div></figure><p id="da73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你对实验感兴趣，我推荐你也看看我之前的帖子:<a class="ae kv" rel="noopener" target="_blank" href="/practical-experiment-fundamentals-all-data-scientists-should-know-f11c77fea1b2">所有数据科学家都应该知道的实用实验基础</a>。</p></div></div>    
</body>
</html>