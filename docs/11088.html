<html>
<head>
<title>Reading and Visualizing GeoTiff | Satellite Images with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 读取和可视化 GeoTiff |卫星图像</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/reading-and-visualizing-geotiff-images-with-python-8dcca7a74510?source=collection_archive---------2-----------------------#2020-08-02">https://towardsdatascience.com/reading-and-visualizing-geotiff-images-with-python-8dcca7a74510?source=collection_archive---------2-----------------------#2020-08-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a5f5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用于处理 GeoTiff 或卫星影像的 python 库简介。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6e8b5c827f5664daee52040de0d815ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p9w4YoKHAr62SomeuJ6NrA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/photos/JqKv7_gz_3U" rel="noopener ugc nofollow" target="_blank"> Unsplash 图像链接</a></p></figure><p id="2d1e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在 python 中读取图像非常容易，因为有许多库可用于读取、编辑和可视化不同格式的图像。这些库的例子有 Matplotlib、OpenCV、Pillow 等。这些库可以很好地处理流行的图像格式，比如<em class="ls">。png，。tiff，。jpg，。jpeg，</em>等。但它们似乎对 GeoTiff 图像不起作用。</p><p id="08d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们了解 GeoTiff 格式与其他图像格式的不同之处，就很容易猜到原因。下面给出了一个简单的定义。</p><blockquote class="lt lu lv"><p id="2b37" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">GeoTIFF 是一种标准的<code class="fe lz ma mb mc b">.tif</code>或图像文件格式，它包括嵌入在。tif 文件作为标签。</p></blockquote><p id="07fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过标签，这意味着它有一些额外的元数据，如空间范围、CRS、分辨率等。以及像素值。是<strong class="ky ir">卫星</strong>和<strong class="ky ir">航空</strong> <strong class="ky ir">摄影</strong> <strong class="ky ir">影像的一种流行分发格式。</strong></p><p id="ca25" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文讨论了使用 jupyter 笔记本通过 python 读取和可视化这些图像的不同方法。使用的库有 GDAL、rasterio、georaster 和 Matplotlib(用于可视化)。这些库将帮助我们将这些图像转换为简单的 numpy 数组格式，从那里我们还可以使用 numpy 或 TensorFlow 执行其他图像转换，尽管我在本文中没有讨论转换。</p><p id="63c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些库的文档中提到了安装步骤，我在参考资料部分提供了它们的链接，请仔细阅读。</p><h1 id="6818" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">使用 RasterIO</h1><p id="4add" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">RasterIO 由 Mapbox 实现，它提供了用于读取地理参考数据集的 python API。此外，文档中提到，与 GDAL python 绑定不同，它没有悬空 C 指针和其他可能导致程序崩溃的指针问题。</p><pre class="kg kh ki kj gt na mc nb nc aw nd bi"><span id="7590" class="ne me iq mc b gy nf ng l nh ni">import rasterio<br/>from rasterio.plot import show</span><span id="6dc8" class="ne me iq mc b gy nj ng l nh ni">fp = r'GeoTiff_Image.tif'<br/>img = rasterio.open(fp)<br/>show(img)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/b3c5b5f6c03a8ce76b48a4846650acd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wuXAaVEDRDE8lmTkdPMS2Q.png"/></div></div></figure><p id="dfae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要把自己和 x 轴和 y 轴的刻度值混淆，它们只是经度和纬度值。如果你想读取单个波段，使用下面的代码。</p><pre class="kg kh ki kj gt na mc nb nc aw nd bi"><span id="c673" class="ne me iq mc b gy nf ng l nh ni">fp = r'GeoTiff_Image.tif'<br/>img = rasterio.open(fp) </span><span id="159a" class="ne me iq mc b gy nj ng l nh ni"># mention band no. in read() method starting from 1 not 0<br/>show(img.read(3))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/bd6547d00a20d81020532bd1ebe3d8cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qCdqxf6RCkR9LZlnkIBb5w.png"/></div></div></figure><h2 id="51b1" class="ne me iq bd mf nm nn dn mj no np dp mn lf nq nr mp lj ns nt mr ln nu nv mt nw bi translated">使用 RasterIO 的图像相关数据</h2><pre class="kg kh ki kj gt na mc nb nc aw nd bi"><span id="69f3" class="ne me iq mc b gy nf ng l nh ni"># No. of Bands and Image resolution<br/>dataset.count, dataset.height, dataset.width</span><span id="23a1" class="ne me iq mc b gy nj ng l nh ni"># Coordinate Reference System<br/>dataset.crs</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/4e839ed6d935e938b83d7c4eb48e5baf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*IeWYZ0LoyV4ogaPTaprVsg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用 RasterIO 的图像相关数据</p></figure><h1 id="7d42" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated"><strong class="ak">使用地理控制器</strong></h1><p id="d7cd" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">georaster 安装了<em class="ls"> pip </em>的版本为 1.25。这个版本可能会给你带来一些问题，如果你遇到任何问题，先去你的<em class="ls"> georaster </em>安装目录。下面的代码会告诉你安装目录路径。</p><pre class="kg kh ki kj gt na mc nb nc aw nd bi"><span id="f21c" class="ne me iq mc b gy nf ng l nh ni">import georaster<br/>print(georaster.__file__)</span></pre><p id="2b63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，在那里找到 georaster.py 文件，并用这个<a class="ae kv" href="https://github.com/GeoUtils/georaster/blob/master/georaster/georaster.py" rel="noopener ugc nofollow" target="_blank"> georaster </a>中的内容更改它的内容。py 文件。</p><p id="7d8e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是可视化具有多个波段(或通道)的图像的代码。</p><pre class="kg kh ki kj gt na mc nb nc aw nd bi"><span id="ab07" class="ne me iq mc b gy nf ng l nh ni">import georaster<br/>import matplotlib.pyplot as plt</span><span id="27da" class="ne me iq mc b gy nj ng l nh ni"># Use SingleBandRaster() if image has only one band<br/>img = georaster.MultiBandRaster('GeoTiff_Image.tif')</span><span id="c91b" class="ne me iq mc b gy nj ng l nh ni"># img.r gives the raster in [height, width, band] format <br/># band no. starts from 0<br/>plt.imshow(img.r[:,:,2])</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/99257f9d818403b8877fcf6d7711bfd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mZtMx2sWvvoHki17ILqzpw.png"/></div></div></figure><h2 id="4135" class="ne me iq bd mf nm nn dn mj no np dp mn lf nq nr mp lj ns nt mr ln nu nv mt nw bi translated">不使用 matplotlib 打印图像</h2><p id="9cba" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">我们可以直接使用绘图方法，而不是选择和可视化单个波段。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/b8905e1802bdb23b22f076666dc26193.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*TFayGemE9J9dHy0HAVZLew.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">地理绘图法</p></figure><h1 id="7ff4" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">使用 GDAL</h1><p id="0e9c" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">这是处理 GeoTiff 图像时最受欢迎的库，但有时很难安装，需要花费大量精力才能最终使用它。GDAL 的大部分方法和类都是用 C++实现的，我们在这里使用它的 python 绑定。像<em class="ls"> georaster </em>这样的大多数库都利用 GDAL，并为它提供了一个漂亮而简单的 python 接口。</p><pre class="kg kh ki kj gt na mc nb nc aw nd bi"><span id="56dd" class="ne me iq mc b gy nf ng l nh ni">from osgeo import gdal<br/>import matplotlib.pyplot as plt</span><span id="c8c2" class="ne me iq mc b gy nj ng l nh ni">dataset = gdal.Open('GeoTiff_Image.tif', gdal.GA_ReadOnly) </span><span id="ba17" class="ne me iq mc b gy nj ng l nh ni"># Note GetRasterBand() takes band no. starting from 1 not 0<br/>band = dataset.GetRasterBand(1)</span><span id="3473" class="ne me iq mc b gy nj ng l nh ni">arr = band.ReadAsArray()<br/>plt.imshow(arr)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/2f9899881247a041bd311d6340f56b09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AQoaoA1h3Oyb_tOWtFB_TQ.png"/></div></div></figure><h2 id="92ed" class="ne me iq bd mf nm nn dn mj no np dp mn lf nq nr mp lj ns nt mr ln nu nv mt nw bi translated">使用 GDAL 的图像相关数据</h2><pre class="kg kh ki kj gt na mc nb nc aw nd bi"><span id="1592" class="ne me iq mc b gy nf ng l nh ni"># For no. of bands and resolution<br/>img.RasterCount, img.RasterXSize, img.RasterYSize</span><span id="4afb" class="ne me iq mc b gy nj ng l nh ni"># stats about image<br/>img.GetStatistics( True, True )</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/99aaa6ed196dbbfeb0d1b1e031ec1666.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*MT-bxa8_EySni9ov5vvrDA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Jupyter 笔记本实现图像统计</p></figure><h1 id="f3a2" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">参考</h1><p id="4c8f" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated"><strong class="ky ir">安装</strong></p><ol class=""><li id="93a9" class="oc od iq ky b kz la lc ld lf oe lj of ln og lr oh oi oj ok bi translated"><a class="ae kv" href="https://mothergeo-py.readthedocs.io/en/latest/development/how-to/gdal-ubuntu-pkg.html" rel="noopener ugc nofollow" target="_blank">https://mothergeo-py . readthedocs . io/en/latest/development/how-to/gdal-Ubuntu-pkg . html</a></li><li id="da52" class="oc od iq ky b kz ol lc om lf on lj oo ln op lr oh oi oj ok bi translated"><a class="ae kv" href="https://github.com/GeoUtils/georaster" rel="noopener ugc nofollow" target="_blank">https://github.com/GeoUtils/georaster</a></li><li id="be8f" class="oc od iq ky b kz ol lc om lf on lj oo ln op lr oh oi oj ok bi translated"><a class="ae kv" href="https://rasterio.readthedocs.io/en/latest/installation.html" rel="noopener ugc nofollow" target="_blank">https://rasterio.readthedocs.io/en/latest/installation.html</a></li><li id="57c9" class="oc od iq ky b kz ol lc om lf on lj oo ln op lr oh oi oj ok bi translated"><a class="ae kv" href="https://pypi.org/project/GDAL/" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/GDAL/</a></li></ol><p id="05fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">单据</strong></p><ol class=""><li id="9727" class="oc od iq ky b kz la lc ld lf oe lj of ln og lr oh oi oj ok bi translated"><a class="ae kv" href="https://georaster.readthedocs.io/en/latest/api.html#multibandraster" rel="noopener ugc nofollow" target="_blank">https://geo raster . readthe docs . io/en/latest/API . html # multi band raster</a></li><li id="d284" class="oc od iq ky b kz ol lc om lf on lj oo ln op lr oh oi oj ok bi translated"><a class="ae kv" href="https://rasterio.readthedocs.io/en/latest/quickstart.html" rel="noopener ugc nofollow" target="_blank">https://rasterio.readthedocs.io/en/latest/quickstart.html</a></li><li id="5a11" class="oc od iq ky b kz ol lc om lf on lj oo ln op lr oh oi oj ok bi translated"><a class="ae kv" href="https://gdal.org/python/index.html" rel="noopener ugc nofollow" target="_blank">https://gdal.org/python/index.html</a></li></ol></div></div>    
</body>
</html>