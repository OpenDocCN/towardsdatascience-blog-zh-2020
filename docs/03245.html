<html>
<head>
<title>Building a Personalized Real-Time Fashion Collection Recommender</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建个性化的实时时装收藏推荐系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-personalized-real-time-fashion-collection-recommender-22dc90c150cb?source=collection_archive---------9-----------------------#2020-03-28">https://towardsdatascience.com/building-a-personalized-real-time-fashion-collection-recommender-22dc90c150cb?source=collection_archive---------9-----------------------#2020-03-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/36226f6d81211340d48401d568da6adb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5na703b68Hm_Zdfz3A_Llg.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">我们的RecSys选择的服装。左:“任何有短裤的东西”。右上:“都市生活方式”。右下:《如花梦》。服装从<a class="ae jd" href="http://mmlab.ie.cuhk.edu.hk/projects/DeepFashion.html" rel="noopener ugc nofollow" target="_blank"> DeepFashion、</a>开源由<a class="ae jd" href="https://liuziwei7.github.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="bd je">刘z等人</strong> </a></p></figure><h2 id="c152" class="jf jg jh bd b dl ji jj jk jl jm jn dk jo translated" aria-label="kicker paragraph">现代RecSys</h2><div class=""/><div class=""><h2 id="acdb" class="pw-subtitle-paragraph kn jq jh bd b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le dk translated">我们将利用PyTorch中的迁移学习、近似最近邻和嵌入质心检测来构建我们的推荐器。</h2></div><p id="428b" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我在数据行业工作了七年多，有幸设计、构建和部署了两个推荐系统(RecSys ),并为数百万客户提供了服务。在本文中，我将通过一个带有代码的案例研究来介绍可视化推荐器的现代方法，并分享我设计RecSys的一些经验。</p><h1 id="a88b" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">商业问题</h1><p id="3018" class="pw-post-body-paragraph lf lg jh lh b li mt kr lk ll mu ku ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">假设你被一家电子商务公司<strong class="lh jr">happy panda co .</strong>聘用，负责他们的时装系列专题。产品团队概述了需求:</p><ul class=""><li id="47bc" class="my mz jh lh b li lj ll lm lo na ls nb lw nc ma nd ne nf ng bi translated">该模型应该能够<strong class="lh jr">扫描所有280，000+产品图像</strong>，并自动<strong class="lh jr">生成一组推荐产品</strong>，这些产品是根据用户查看/购买的内容<strong class="lh jr">定制的。</strong></li><li id="03b5" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated">速度对电子商务公司至关重要。该组推荐的<strong class="lh jr">产品应在2ms </strong>内生成，以满足管道的“实时”要求。</li><li id="5aa9" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated">该模型应该能够适应新产品和新用户。</li></ul><p id="7e38" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">听起来很有趣？让我们建造这个。</p><h1 id="46fa" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">数据</h1><p id="952d" class="pw-post-body-paragraph lf lg jh lh b li mt kr lk ll mu ku ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">我们将使用<strong class="lh jr"/><a class="ae jd" href="http://mmlab.ie.cuhk.edu.hk/projects/DeepFashion.html" rel="noopener ugc nofollow" target="_blank"><strong class="lh jr">【deep fashion】</strong></a><strong class="lh jr">的子集数据，由香港中文大学刘z等人开源，</strong>。我们的数据由46个类别的28万张时尚图片组成。你可以从他们的网站上下载数据。 </p><p id="c5c8" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">此外，该团队发布了一个<a class="ae jd" href="https://github.com/switchablenorms/DeepFashion2" rel="noopener ugc nofollow" target="_blank">更新版本，增加了</a>的数据。你需要<a class="ae jd" href="https://docs.google.com/forms/d/e/1FAIpQLSeIoGaFfCQILrtIZPykkr8q_h9qQ5BoTYbjvf95aXbid0v2Bw/viewform?usp=sf_link" rel="noopener ugc nofollow" target="_blank">填写谷歌表格</a>来获取数据。</p><h1 id="df34" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">时尚系列——打造时尚系列的步骤</h1><p id="b12e" class="pw-post-body-paragraph lf lg jh lh b li mt kr lk ll mu ku ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">了解业务需求后，我们分解构建时装系列所需的步骤:</p><figure class="nm nn no np gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/6a403153bba494cbb8295b1ae21bac26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9z1jN9Gbif3PxO_c9GH0Ug.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">我打造时装系列的步骤</p></figure><h1 id="e702" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">回顾时尚系列的成果</h1><p id="0ca6" class="pw-post-body-paragraph lf lg jh lh b li mt kr lk ll mu ku ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">在深入研究代码之前，让我们看一下模型的输入/输出，以获得对问题和建议的解决方案的直觉。</p><p id="d61b" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">输入:</p><ul class=""><li id="b4dc" class="my mz jh lh b li lj ll lm lo na ls nb lw nc ma nd ne nf ng bi translated">我和妻子商量，通过选择<strong class="lh jr"> 12套风格相似的服装</strong>来模拟用户查看/购买的服装。我们将关注三个用户:爱丽丝、贝拉和凯茜，每个人都有不同的口味偏好。</li><li id="7872" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated"><strong class="lh jr">我只会将图像传递到模型中；模型不吸收额外的属性/描述/产品细节；</strong>这是因为我们希望模型能够自动学习和检测传递给它的时尚图像的风格，而无需进一步的人/机器标记。</li></ul><p id="f8de" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">输出:</p><ul class=""><li id="3ee6" class="my mz jh lh b li lj ll lm lo na ls nb lw nc ma nd ne nf ng bi translated">目标是让模型生成的集合<strong class="lh jr">包含输入的某些方面，但给用户带来惊喜。</strong></li></ul><figure class="nm nn no np gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/e5cfad0432164cdc7a7da2fd0692a450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BM-hymK_WMzpqvtkEtSqLQ.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">左图:爱丽丝查看/购买的服装。右图:时装系列推荐的服装。<a class="ae jd" href="http://mmlab.ie.cuhk.edu.hk/projects/DeepFashion.html" rel="noopener ugc nofollow" target="_blank"> DeepFashion、</a>开源<a class="ae jd" href="https://liuziwei7.github.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="bd je">刘z等人</strong> </a></p></figure><p id="bad2" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi nq translated">A  <strong class="lh jr"> lice </strong>来自阳光明媚的新加坡，喜欢短裤和适合炎热天气的服装。根据她选择的服装,《时尚收藏》推荐了各种各样的新服装，都配有短裤，看起来非常适合阳光下的生活。<strong class="lh jr">请注意，我们没有明确告诉模特根据短裤过滤服装。</strong> Fashion Collection可以捕捉到爱丽丝喜欢搭配短裤的服装的信号，并做出适当的推荐。</p><figure class="nm nn no np gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/72a565007482ae8da3874c84d7ddc36f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i3_9hio_RV2Z13Dv6muMTQ.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">左图:Bella查看/购买的服装。右图:时装系列推荐的服装。服装来自<a class="ae jd" href="http://mmlab.ie.cuhk.edu.hk/projects/DeepFashion.html" rel="noopener ugc nofollow" target="_blank"> DeepFashion，</a>开源来自<a class="ae jd" href="https://liuziwei7.github.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="bd je">刘等</strong> </a></p></figure><p id="e50f" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi nq translated">ella来自艺术巴塞罗那，喜欢她衣服上的花卉图案和多彩设计。根据她选择的服装，时装系列推荐了各种颜色、图案和剪裁与她品味相似的各种新服装。</p><figure class="nm nn no np gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/9d094d669b3b89bbf38340225d8640f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2Pp8uwMypwlOW1UfJ1ghA.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">左图:Cathy查看/购买的服装。右图:时装系列推荐的服装。服装从<a class="ae jd" href="http://mmlab.ie.cuhk.edu.hk/projects/DeepFashion.html" rel="noopener ugc nofollow" target="_blank"> DeepFashion、</a>开源由<a class="ae jd" href="https://liuziwei7.github.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="bd je">刘z等人</strong> </a></p></figure><p id="6093" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi nq translated">阿西来自国际化的纽约，穿着她熟悉的都市生活方式。城市生活方式是一种<strong class="lh jr">更复杂的风格</strong>，分层、破牛仔裤、配饰、靴子、图案t恤是其中一些定义特征。因此，令人兴奋的是，时装系列已经认识到了这种风格的一些关键特征，并推荐了带有层次感的服装组合，破旧的牛仔裤，配饰，靴子，图案t恤！</p><blockquote class="nz"><p id="06af" class="oa ob jh bd oc od oe of og oh oi ma dk translated">这也是为什么我们不想硬编码过滤器/按类别限制服装。<strong class="ak">我们希望时装系列能够响应不同用户和不断变化的用户偏好，即使是像城市生活方式这样多样化的风格。</strong></p></blockquote><p id="f685" class="pw-post-body-paragraph lf lg jh lh b li oj kr lk ll ok ku ln lo ol lq lr ls om lu lv lw on ly lz ma ij bi translated">在下一节中，我将介绍一些主要的概念和代码片段。如果你不能在一次阅读中理解所有的理论，不要担心。本质上，这些都是不断发展的密集话题；我将提供一个高层次的概述，并在进一步的阅读材料中提供额外的资源供您参考。我们将遵循上面流程中概述的阶段(数据、准备、建模、搜索)。</p><h1 id="b400" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">代码</h1><p id="7161" class="pw-post-body-paragraph lf lg jh lh b li mt kr lk ll mu ku ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated"><a class="ae jd" href="https://colab.research.google.com/gist/thiakx/c850d08ab37b7e57b8dae9ecfa1a3b8b/building-a-personalized-real-time-fashion-collection-recommender.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="lh jr">链接到Colab上的代码</strong> </a> <strong class="lh jr"> </strong>(你只需要一个免费的Google账号就可以在云端的GPU上运行代码)。我们将使用杰瑞米·霍华德的Fastai包(以及著名的<a class="ae jd" href="https://course.fast.ai/" rel="noopener ugc nofollow" target="_blank">程序员实用深度学习</a>课程)。</p><figure class="nm nn no np gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><h1 id="3574" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">[Prep]代码:将图像转换为嵌入内容</h1><p id="acc0" class="pw-post-body-paragraph lf lg jh lh b li mt kr lk ll mu ku ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">这种转换是我们模型数据处理的第一步:</p><figure class="nm nn no np gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><figure class="nm nn no np gt is gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/44c756ebe0bdcc4b39fda186938f8f16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*BbGUB0Pid9wqjVR03bN5yg.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">我们代码的结果——图像数据已处理，可用于训练。各路服装来自<a class="ae jd" href="http://mmlab.ie.cuhk.edu.hk/projects/DeepFashion.html" rel="noopener ugc nofollow" target="_blank"> DeepFashion，</a>开源作者<a class="ae jd" href="https://liuziwei7.github.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="bd je">刘z等人</strong> </a></p></figure><h1 id="5831" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">理论:什么是嵌入，为什么我们需要它们？</h1><p id="40aa" class="pw-post-body-paragraph lf lg jh lh b li mt kr lk ll mu ku ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">为了解释和说明嵌入的概念，我们将使用一个更小的开源数据集，称为<a class="ae jd" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank"> FashionMNIST </a>。</p><div class="nm nn no np gt ab cb"><figure class="or is os ot ou ov ow paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/390d53de97d7ee3347e1d5588cc3c92f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*u7Vv2lxf3MNKyo4qFR0u1g.png"/></div></figure><figure class="or is ox ot ou ov ow paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/2027b81fe01a863e74ec794672633166.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*sFhj_AV8HB7NRri3ojDCSA.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk oy di oz pa translated">左图:示例图像。右图:图像的数字表示。样本图片来自<a class="ae jd" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank">时尚达人，</a>开源作者<a class="ae jd" href="https://hanxiao.io/2018/09/28/Fashion-MNIST-Year-In-Review/" rel="noopener ugc nofollow" target="_blank">小H. </a></p></figure></div><p id="7ebc" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">传统上，我们将图像表示为一个巨大的整数数组(RGB图像的3D数组和灰度图像的1D数组)。这些阵列非常庞大，并且呈指数级增长，我们将需要跟踪数百万个数字来分析数百张高分辨率图像！使用整数数组来缩放任何建模都是不可能的；因此，现代的嵌入方法产生了。</p><p id="e4c5" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">嵌入概念的一个很好的例子是Will Koehrsen的“<a class="ae jd" rel="noopener" target="_blank" href="/neural-network-embeddings-explained-4d028e6f0526">神经网络嵌入解释</a>”中的例子。传统上，我们利用像一键编码这样的技术来表示矩阵中的项目。例如，给定三本书，我们将有一个3x3矩阵，其中每一项都由一个由<strong class="lh jr">个离散的</strong>个数字组成的数组表示，这个数组的<strong class="lh jr">随着每增加一个新项而增长</strong> (4x4有4项，5x5有5项……)。此外，<strong class="lh jr">没有相似感，也没有距离感</strong>，因为这些项目没有以任何形式的关系连接。</p><pre class="nm nn no np gt pb pc pd pe aw pf bi"><span id="a1d4" class="pg mc jh pc b gy ph pi l pj pk"><strong class="pc jr"># One Hot Encoding Categoricals</strong></span><span id="feb2" class="pg mc jh pc b gy pl pi l pj pk"><strong class="pc jr">books = ["Harry Potter and The Philosopher's Stone",<br/>         "Harry Potter and The Chamber of Secrets", <br/>         "The Lean Startup"]</strong></span><span id="6c40" class="pg mc jh pc b gy pl pi l pj pk"><strong class="pc jr">books_encoded = [[1, 0, 0],<br/>                 [0, 1, 0],<br/>                 [0, 0, 1]]</strong></span><span id="276d" class="pg mc jh pc b gy pl pi l pj pk"><strong class="pc jr">Similarity (dot product) between First and Second = 0<br/>Similarity (dot product) between Second and Third = 0<br/>Similarity (dot product) between First and Third = 0</strong></span></pre><p id="391e" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">一旦我们应用一个转换来将对象转换成嵌入，我们现在<strong class="lh jr">在一个连续的尺度上限制表示每个项目的数组中的元素数量(在这个例子中限制为2)</strong>，并且这些值具有基于关系的含义。基于相似性(点积)彼此接近的对象是高度相关的。</p><pre class="nm nn no np gt pb pc pd pe aw pf bi"><span id="2359" class="pg mc jh pc b gy ph pi l pj pk"><strong class="pc jr"># Idealized Representation of Embedding</strong></span><span id="12fc" class="pg mc jh pc b gy pl pi l pj pk"><strong class="pc jr">books = ["Harry Potter and The Philosopher's Stone",<br/>         "Harry Potter and The Chamber of Secrets", <br/>         "The Lean Startup"]</strong></span><span id="5a2e" class="pg mc jh pc b gy pl pi l pj pk"><strong class="pc jr">books_encoded_ideal = [[0.53,  0.85],<br/>                       [0.60,  0.80],<br/>                       [-0.78, -0.62]]</strong></span><span id="a8f0" class="pg mc jh pc b gy pl pi l pj pk"><strong class="pc jr">Similarity (dot product) between First and Second = 0.99<br/>Similarity (dot product) between Second and Third = -0.94<br/>Similarity (dot product) between First and Third = -0.97</strong></span></pre><blockquote class="nz"><p id="61c7" class="oa ob jh bd oc od pm pn po pp pq ma dk translated">嵌入是离散变量的矢量表示，而不是分析每幅图像的数百万个离散变量。对于深度学习，我们通常利用神经网络嵌入来将分类变量的维度降低到可管理的程度</p></blockquote><figure class="ps pt pu pv pw is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi pr"><img src="../Images/9317b162db48fe16c3991bb0365a2cb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*p4EuVzpy2Aojdj1ZxZ55tw.gif"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">时尚嵌入投影。图片来自<a class="ae jd" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank"> FashionMNIST，【Tensorboard动画</a></p></figure><p id="908a" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">因为我们可以控制向量表示的大小，所以我们可以将一个巨大的图像数组缩小成一个由更少的数字组成的小向量。从上图中的FashionMNIST对象可以看出结果，其中对象被投影到3D矢量空间。通过嵌入过程，相似的<strong class="lh jr">个图像向量将被投影成彼此靠近</strong>。因此，当我们有嵌入时，我们可以将对象投影到向量空间中，并为可视化和简单的推荐制定距离和邻居的概念。<strong class="lh jr">你可以用下面的笔记本探索嵌入的概念，并在进一步阅读部分阅读更多相关内容:</strong></p><figure class="nm nn no np gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><h1 id="214f" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">[模型]代码:深度卷积神经网络(CNN)的迁移学习</h1><p id="e16e" class="pw-post-body-paragraph lf lg jh lh b li mt kr lk ll mu ku ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">Fastai在建立神经网络的过程中抽象出了许多代码逻辑，允许我们用几行代码进行迁移学习:</p><figure class="nm nn no np gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="a4f3" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">用Fastai钩子运行模型并为每个图像生成嵌入也相当简单。注意，我们想要倒数第二个线性层，因为该层存储图像表示的嵌入；最后一个线性图层是输出图层。</p><figure class="nm nn no np gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi px"><img src="../Images/7c582ad9bb727eb8c01ed94b56856478.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d1duIRzV7PzFqyUH6pAv2g.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">请注意，倒数第二个线性图层是(4)</p></figure><figure class="nm nn no np gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="e41b" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">因此，当我们调用learner.model.module[1][4]来获得具有嵌入的层时。</p><h1 id="c72c" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">【模式】理论:CNN是什么？</h1><p id="7945" class="pw-post-body-paragraph lf lg jh lh b li mt kr lk ll mu ku ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">卷积并不是一项新技术。本质上，我们正在对图像中的每个像素应用内核以实现一个目标，通常是模糊、锐化或检测边缘/对象。对于每个像素，我们将用内核做一个元素级的乘积，然后将结果相加得到一个单一的数。</p><blockquote class="nz"><p id="9518" class="oa ob jh bd oc od oe of og oh oi ma dk translated">由于每个内核专门检测图像的一个方面，你可以想象我们将不同的内核堆叠起来，制定一个全面的策略。事实的确如此，内核的集合被称为过滤器。在CNN中，我们甚至可以堆叠多层过滤器，每个过滤器都有特定的任务。</p></blockquote><p id="aa7f" class="pw-post-body-paragraph lf lg jh lh b li oj kr lk ll ok ku ln lo ol lq lr ls om lu lv lw on ly lz ma ij bi translated"><a class="ae jd" href="https://setosa.io/ev/image-kernels/" rel="noopener ugc nofollow" target="_blank">如果你有兴趣，你应该试试Victor Powell开发的带有不同类型内核的工具</a>。CNN是一个迷人的模型，因为它结合了卷积和神经网络的力量。有许多不同的架构，但通常由<a class="ae jd" href="https://algobeans.com/2016/01/26/introduction-to-convolutional-neural-network/" rel="noopener ugc nofollow" target="_blank">卷积、子采样、激活和完全连接的组合组成，如Algobeans </a>所述。你可以在进一步阅读部分了解更多关于内核和CNN的知识。</p><h1 id="f9e2" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">【模型】理论:迁移学习是如何工作的？</h1><blockquote class="nz"><p id="aa53" class="oa ob jh bd oc od oe of og oh oi ma dk translated">对于大多数现实部署，我们不会从头开始训练CNN。多年来，像微软研究院这样的组织已经发布了最先进的大规模预训练深度CNN (DCNN)模型，我们应该通过在他们的基线模型上进行训练来利用他们的工作。这就是所谓的迁移学习。</p></blockquote><p id="3201" class="pw-post-body-paragraph lf lg jh lh b li oj kr lk ll ok ku ln lo ol lq lr ls om lu lv lw on ly lz ma ij bi translated">具体来说，我们拿一个像<a class="ae jd" href="https://arxiv.org/abs/1512.03385" rel="noopener ugc nofollow" target="_blank"> ResNet50 (He K .，et al.) </a>这样的大型预训练DCNN，冻结大部分层，在最后几层上训练。直觉是，对于大多数DCNN，过滤器获得的知识是可转移的成分，例如边缘、图案、梯度、颜色等的检测。因此，我们对问题的最后几层进行微调，就可以得到一个可行的解决方案。<strong class="lh jr">你可以在进一步阅读部分探索迁移学习的概念。</strong></p><h1 id="f9a2" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">[搜索]代码:用骚扰和嵌入质心检测来近似最近邻居</h1><p id="7e7c" class="pw-post-body-paragraph lf lg jh lh b li mt kr lk ll mu ku ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">我们遍历数据帧中的每一行，用get_nss_by_vector函数找到最近的邻居。</p><figure class="nm nn no np gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><p id="e521" class="pw-post-body-paragraph lf lg jh lh b li lj kr lk ll lm ku ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">最后，我们将所有12个(或更多)用户选择的项目的嵌入插入到一个列表中，然后<strong class="lh jr">对每个维度的嵌入值进行平均</strong>；<strong class="lh jr">这将创建一个虚拟对象，表示所有选定项目的聚合值。然后，我们可以找到这个虚拟物品的最近邻居，当我们调用Annoy时，这可以在大约2ms内完成。</strong></p><figure class="nm nn no np gt is"><div class="bz fp l di"><div class="oo op l"/></div></figure><figure class="nm nn no np gt is gh gi paragraph-image"><div class="gh gi py"><img src="../Images/f8550ae2168e8ee27185006d55dbeb3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*up9auyBRepCtLfqPONJXqQ.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">用Shorts集合生成任何内容所花费的时间</p></figure><h1 id="4208" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">[搜索]理论:近似最近邻</h1><p id="7933" class="pw-post-body-paragraph lf lg jh lh b li mt kr lk ll mu ku ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">如果我们只有一个小的图像搜索语料库，简单的距离度量，如余弦相似性将工作。在现实世界的部署中，比如电子商务，我们通常有数百万张图片需要相互比较，API对每张图片进行成对比较是不切实际的。来自Spotify的Erik Bernhardsson编写了一个易于使用的API，可以集成到我们的PyTorch工作流中。</p><blockquote class="nz"><p id="f279" class="oa ob jh bd oc od oe of og oh oi ma dk translated">更重要的是，它帮助我们找到最近的邻居，而不需要计算每张图像之间的成对距离。</p></blockquote><p id="a068" class="pw-post-body-paragraph lf lg jh lh b li oj kr lk ll ok ku ln lo ol lq lr ls om lu lv lw on ly lz ma ij bi translated">如果你有兴趣了解更多关于aroy的知识，请在“进一步阅读”下查看Erik的文章。</p><h1 id="f86c" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">我们学到了什么</h1><p id="f6fd" class="pw-post-body-paragraph lf lg jh lh b li mt kr lk ll mu ku ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">我们将详细介绍构建个性化实时时装系列推荐器的整个过程。借助PyTorch、Fastai和Annoy等现代工具，我们构建了一个强大的产品，可以根据用户的风格生成相关的推荐。</p><h1 id="b999" class="mb mc jh bd md me mf mg mh mi mj mk ml kw mm kx mn kz mo la mp lc mq ld mr ms bi translated">进一步阅读</h1><ul class=""><li id="6b2b" class="my mz jh lh b li mt ll mu lo pz ls qa lw qb ma nd ne nf ng bi translated"><a class="ae jd" rel="noopener" target="_blank" href="/neural-network-embeddings-explained-4d028e6f0526">神经网络嵌入解释</a></li><li id="e14b" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated"><a class="ae jd" rel="noopener" target="_blank" href="/types-of-convolution-kernels-simplified-f040cb307c37">卷积核的类型:简化的</a></li><li id="3e69" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated"><a class="ae jd" href="https://aishack.in/tutorials/image-convolution-examples/" rel="noopener ugc nofollow" target="_blank">图像卷积示例</a></li><li id="4db9" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated"><a class="ae jd" href="https://youtu.be/YRhxdVk_sIs" rel="noopener ugc nofollow" target="_blank">由deeplizard(视频)解释的卷积神经网络(CNN)</a></li><li id="a9c0" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated"><a class="ae jd" href="https://algobeans.com/2016/01/26/introduction-to-convolutional-neural-network/" rel="noopener ugc nofollow" target="_blank">卷积神经网络(CNN)简介</a></li><li id="ef91" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated"><a class="ae jd" href="https://adeshpande3.github.io/A-Beginner%27s-Guide-To-Understanding-Convolutional-Neural-Networks/" rel="noopener ugc nofollow" target="_blank">理解卷积神经网络的初学者指南</a></li><li id="fe53" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated"><a class="ae jd" rel="noopener" target="_blank" href="/transfer-learning-with-convolutional-neural-networks-in-pytorch-dd09190245ce">py torch中卷积神经网络的迁移学习</a></li><li id="4875" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated"><a class="ae jd" href="https://shuzhanfan.github.io/2018/11/ResNet/" rel="noopener ugc nofollow" target="_blank">了解深层剩余网络</a></li><li id="c7ec" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated"><a class="ae jd" rel="noopener" target="_blank" href="/an-overview-of-resnet-and-its-variants-5281e2f56035">ResNet及其变体的概述</a></li><li id="71c0" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated"><a class="ae jd" rel="noopener" target="_blank" href="/a-comprehensive-hands-on-guide-to-transfer-learning-with-real-world-applications-in-deep-learning-212bf3b2f27a">全面的实践指南，将学习与深度学习中的真实世界应用相结合</a></li><li id="c154" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated"><a class="ae jd" href="https://machinelearningmastery.com/transfer-learning-for-deep-learning/" rel="noopener ugc nofollow" target="_blank">深度学习迁移学习的温和介绍</a></li><li id="4b6e" class="my mz jh lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated">Erik:aroy:最近邻和向量模型——第二部分——算法和数据结构</li></ul></div></div>    
</body>
</html>