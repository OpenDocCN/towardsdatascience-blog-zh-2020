<html>
<head>
<title>Filtrations in Reinforcement Learning — What They Are and Why We Don’t Need Them</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">强化学习中的过滤——它们是什么，为什么我们不需要它们</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/filtrations-in-reinforcement-learning-what-they-are-and-why-we-dont-need-them-463c93a170d4?source=collection_archive---------37-----------------------#2020-08-07">https://towardsdatascience.com/filtrations-in-reinforcement-learning-what-they-are-and-why-we-dont-need-them-463c93a170d4?source=collection_archive---------37-----------------------#2020-08-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f960" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">过滤的数学概念的基本解释，以及我们如何在强化学习中应用它们。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/78292e9fce05fd0c833a419886cf447f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_i5x2WNUO7nYcNVhEyfwjQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">进行强化学习所需的<strong class="bd ky"> <em class="kz">为</em> </strong>的过滤【来源:【pixabay.com】pixel 2013</p></figure></div><div class="ab cl lb lc hx ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="im in io ip iq"><p id="7c4d" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">偶尔，当阅读强化学习领域的论文时，你可能会偶然发现一些听起来很神秘的短语，如<em class="me">“我们处理一个过滤的概率空间”</em>、<em class="me">期望值取决于过滤</em>或<em class="me">“决策政策是ℱ</em>ₜ<em class="me">-可测量的</em>”。没有测量理论[2，3]的正规训练，可能很难准确理解这种过滤需要什么。正式定义如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mf"><img src="../Images/59ba3d3256c5eed2f2571344c3b712c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q_ZR1feicwF8HF9_GKdK0A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">过滤的正式定义([2]，自己的工作)</p></figure><p id="f775" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">毫无疑问，对于那些熟悉测度理论的人来说，这是样板语言，但除此之外几乎没有帮助。谷歌搜索答案可能会导致通过<em class="me">σ</em>-代数、Borel 集、Lebesgue 测度和 Hausdorff 空间的迷宫，再次假设你已经知道了基本知识。幸运的是，只需要对滤波有一个非常基本的了解，就可以理解它在 RL 域中的含义。本文将提供关于该主题的远非全面的讨论，但旨在给出核心概念的一个简要且直观的轮廓。</p><h1 id="91a8" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">一个例子</strong></h1><p id="436b" class="pw-post-body-paragraph li lj it lk b ll my ju ln lo mz jx lq lr na lt lu lv nb lx ly lz nc mb mc md im bi translated">在 RL 中，我们通常定义一个结果空间<em class="me">ω</em>，它包含所有可能发生的结果或样本，其中<em class="me"> ω </em>是一个特定的样本路径。为了便于说明，我们将假设我们的 RL 问题与在第<em class="me"> t </em>日价格为<em class="me"> S </em> ₜ的股票相关。我们当然希望低买高卖(精确的决策问题在这里无关紧要)。我们可以将买入/卖出决策表示为<em class="me"> xₜ(ω) </em>，<em class="me"> </em>，即该决策取决于价格路径。我们从价格<em class="me"> S₀ </em>(一个实数)开始，每天价格按照某种随机过程上涨或下跌。在播放这一集之前，我们可以提前模拟(或数学定义)这样一个价格路径<em class="me">ω=[ω₁,…,ωₜ】</em>。然而，这并不意味着我们应该在股票价格变动实际发生之前就知道它们——即使是沃伦·巴菲特也只能梦想拥有这样的信息！为了声称我们的决策基于ω而不是千里眼，我们可以说结果空间是“过滤的”(使用符号<em class="me"> ℱ ) </em>，这意味着我们只能观察到时间<em class="me"> t </em>的样本。</p><p id="9f48" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于大多数 RL 从业者来说，这个限制听起来一定很熟悉。我们通常不是根据当前状态<em class="me"> Sₜ </em>来做决定的吗？的确，我们有。事实上，由于马尔可夫性质意味着随机过程是无记忆的——我们只需要嵌入在主导状态中的信息<em class="me"> Sₜ — </em>来自过去的信息是不相关的[5]。正如我们将很快看到的，过滤比状态更丰富、更通用，但实际上它们的含义是相似的。</p><p id="ac59" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们进一步形式化一下我们的股票价格问题。我们从一个离散的问题设置开始，其中价格要么上升(<em class="me"> u </em>)要么下降(<em class="me"> -d </em>)。考虑到三天的事件范围，结果空间<em class="me">ω</em>可以通过二项式点阵来可视化[4]:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/4eb5141d9774743115cf475b78559861.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lhh4_rPBDvH_-iNSU6mjIg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代表股票价格变化的二项式点阵模型(来源:[1]，作者</p></figure><h1 id="cc70" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">事件和过滤的定义</strong></h1><p id="939c" class="pw-post-body-paragraph li lj it lk b ll my ju ln lo mz jx lq lr na lt lu lv nb lx ly lz nc mb mc md im bi translated">在这一点上，我们需要定义一个“事件”的概念<em class="me">A∈ω</em>。或许有点抽象地说，事件是结果空间的一个元素。简单地说，我们可以给一个事件分配一个概率，并断言它是否已经发生。正如我们将很快展示的那样，这与实现<em class="me"> ω </em>并不相同。</p><p id="e8de" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">过滤<em class="me"> ℱ </em>是一个数学模型，代表关于结果的部分知识。本质上，它告诉我们一个事件是否发生过。“过滤过程”可以被视为一系列过滤器，每个过滤器为我们提供更详细的视图。具体地说，在 RL 环境中，过滤为我们提供了计算当前状态<em class="me"> Sₜ </em>所需的信息，而没有给出过程中未来变化的任何指示【2】。的确，就像马尔可夫性质一样。</p><p id="a3c2" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">形式上，过滤是一个<em class="me">σ</em>-代数，虽然你不需要知道来龙去脉，但一些背景知识是有用的。不严格地定义，<em class="me">σ</em>-代数是结果空间的子集的集合，包含可数个事件以及它们的所有补和并。在测量理论中，这个概念有着重要的含义，为了本文的目的，你只需要记住，<em class="me">σ</em>-代数是事件的集合。</p><h1 id="6202" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">重温示例—离散案例</strong></h1><p id="f0fb" class="pw-post-body-paragraph li lj it lk b ll my ju ln lo mz jx lq lr na lt lu lv nb lx ly lz nc mb mc md im bi translated">回到这个例子，因为过滤只有在付诸行动时才会活跃起来。我们首先需要定义事件，使用像'<em class="me"> udu' </em>这样的序列来描述价格随时间的变化。在<em class="me"> t=0 </em>时，我们基本上什么都不知道——所有的路径都是可能的。因此，事件集合<em class="me"> A={uuu，uud，udu，udd，ddd，ddu，dud，duu} </em>包含所有可能的路径ω∈ω。在<em class="me"> t=1 </em>时，我们知道更多一点:股票价格上涨或下跌。对应的事件由<em class="me"/><strong class="lk iu"><em class="me">u</em></strong><em class="me">uu、</em><strong class="lk iu"><em class="me">u</em></strong><em class="me">ud、</em><strong class="lk iu"><em class="me">u</em></strong><em class="me"/><strong class="lk iu"><em class="me">u</em></strong><em class="me">【DD】</em>和<em class="me"/><strong class="lk iu"><em class="me">d 如果股价上涨，我们可以推测我们的样本路径<em class="me"> ω </em>将在<em class="me"> Aᵤ </em>而不是<em class="me"> Aₔ </em>(当然反之亦然)。在<em class="me"> t=2 </em>时，我们有四个事件集:<em class="me"> Aᵤᵤ={uuu,uud} </em>、<em class="me">aᵤₔ={</em><strong class="lk iu"><em class="me">ud</em></strong><em class="me">u、</em><strong class="lk iu"><em class="me">ud</em></strong><em class="me">d }</em>、<em class="me">aₔᵤ={</em><em class="me">杜</em> </em></strong> <em class="me">观察信息变得越来越细粒度；<em class="me"> ω </em>可能所属的集合变得越来越小，数量越来越多。在<em class="me"> t=3 </em>时，我们显然知道已经遵循的确切价格路径。</em></p><p id="3b90" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">定义了事件之后，我们可以为<em class="me"> t=0，1，2，3 </em>定义相应的过滤:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/6a36cd8be18070241a6c2611866352e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*apRYn2TbmGWAmjGuzAzewg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">二项式点阵示例的筛选(来源:[2]，i <em class="kz">由作者</em>创建)</p></figure><p id="d637" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在<em class="me"> t=0 </em>时，每种结果都有可能。我们用空集∅和结果空间ω初始化过滤，也称为<em class="me">平凡</em><em class="me">σ</em>-代数。</p><p id="4ab4" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在<em class="me"> t=1 </em>时，我们可以简单地将<em class="me"> Aᵤ </em>和<em class="me"> Aₔ </em>加到<em class="me"> ℱ </em> ₀上得到<em class="me">ℱ</em>₁；回想一下定义，每个过滤总是包括其前一个过滤的所有元素。我们可以使用最新披露的信息来计算 S₁。我们也可以窥见未来(实际上没有透露未来的信息！):如果价格上涨，我们就不能在 t=3 时达到最低价格。事件集如下所示</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/23ca4794931756037d37b912022cf2f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r3cJPtZihrgVILOtqoKPCA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">t=1 时事件集<em class="kz"> Aᵤ </em>和<em class="kz"> Aₔ </em>的可视化(来源:[2]，作者本人<em class="kz">法师</em>)</p></figure><p id="b007" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在<em class="me"> t=2 </em>，我们可以根据目前揭示的价格路径来区分四个事件。这里事情变得有点复杂，因为我们还需要添加并集和补集(符合<em class="me">σ</em>-代数的要求)。这对<em class="me"> ℱ </em> ₁来说没有必要，因为<em class="me"> Aᵤ </em>和<em class="me"> Aₔ </em>的并集等于结果空间，而<em class="me"> Aᵤ </em>是<em class="me"> Aₔ </em>的补码。从 RL 的角度来看，你可能会注意到我们有比严格需要的更多的信息。例如，一个向上的运动跟随一个向下的运动产生了与反向运动相同的价格。在 RL 应用中，我们通常不会存储这样的冗余信息，但您可能会意识到数学上的吸引力。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/537a69e98fc0eecdff1923086bd0edd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1i0dh2sFAw6cxawATNADWw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><em class="kz">事件集可视化 Aᵤᵤ、</em> <em class="kz"> Aᵤₔ </em>、<em class="kz"> Aₔᵤ </em>和<em class="kz"> Aₔₔ </em>在 t=2(来源:[2]，作者本人<em class="kz">法师</em>)</p></figure><p id="beb3" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在<em class="me"> t=3 </em>时，我们已经有 256 套，使用与之前相同的程序。你可以看到过滤很快变得非常大。过滤总是包含前面步骤的所有元素——随着时间的推移，我们的过滤变得更加丰富和精细。所有这一切意味着，我们可以更精确地指出我们的样本价格路径可能属于或可能不属于的事件。</p><h1 id="9801" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">一个连续的例子</strong></h1><p id="e994" class="pw-post-body-paragraph li lj it lk b ll my ju ln lo mz jx lq lr na lt lu lv nb lx ly lz nc mb mc md im bi translated">我们几乎已经做到了，但如果我们只处理分散的问题，那将是我们的失职。在现实中，股票价格不只是“涨”或“跌”；它们将在一个连续的域内变化。许多其他 RL 问题也是如此。虽然在概念上与离散情况相同，但在连续设置中提供过滤的明确描述是困难的。同样，一些插图可能比正式定义更有帮助。</p><p id="a44f" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">假设在每个时间步，我们模拟一个从实域<em class="me"> [-d，u】</em>的返回。根据我们预测的时间，我们可以定义未来股票价格下跌的区间，比如在给定的时间点<em class="me">【329，335】</em>。然后我们可以在这个域内定义区间。任何任意间隔都可能构成一个事件，例如:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/e302e6ddd38da1949b1cd16e62ffc3f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C9jYcx42ji-IqwM8diYF-g.png"/></div></div></figure><p id="1f64" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">区间的补码可能看起来像</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/06e46327b429d5ba7bd6c20eaa8cb8c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5EYHprGJF4pb7XyDrI2AZA.png"/></div></div></figure><p id="519c" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">此外，可能会定义过多的联合，例如</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/32a79b3ec67008d61c14f9dc52ca4524.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iG3W8WTC4Ckr8FQzh0TpRQ.png"/></div></div></figure><p id="46c9" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">正如你可能已经猜到的，有无限多的各种形状和大小的这种事件，但它们仍然是可数的，我们可以给它们每个分配一个概率[2，3]。</p><p id="2e5c" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们对未来看得越远，我们就越能偏离当前的股价。我们可以用一个随时间扩展的圆锥形状来想象这一点(下面显示的是<em class="me"> t=50 </em>和<em class="me"> t=80 </em>)。在圆锥内，我们可以定义无穷多个区间。和以前一样，随着时间的推移，我们获得了更详细的视图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/105d06ea29573b9b6d708bf176b431ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0LtfxSKlNWoXqsw1e1qzTw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">t=50 和 t=80 时连续域中的事件集。在锥内，可以定义无限多个区间来构造过滤。(来源:[2]，我<em class="kz">法师作者</em>)</p></figure><h1 id="bb41" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">包装东西</strong></h1><p id="0c43" class="pw-post-body-paragraph li lj it lk b ll my ju ln lo mz jx lq lr na lt lu lv nb lx ly lz nc mb mc md im bi translated">当在任何 RL 论文中遇到过滤时，本文中讨论的基础知识就足够了。从本质上来说，引入过滤的唯一目的是ℱₜ确保决策不会利用尚未披露的信息。当马尔可夫性质成立时，对当前状态进行操作的决策<em class="me">xₜ(sₜ】</em>服务于相同的目的。过滤提供了对过去的丰富描述，然而在无记忆问题中我们不需要这些信息。然而，从数学的角度来看，这是一个优雅的解决方案，有许多有趣的应用。强化学习社区由许多来自不同领域的不同背景的研究人员和工程师组成，并非每个人都讲同一种语言。有时学习另一种语言会有很大的帮助，即使只有几个单词。</p><p id="a607" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">【本文部分基于我的 ArXiv 文章《强化学习中过滤的温和讲义》】</em></p></div><div class="ab cl lb lc hx ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="im in io ip iq"><h1 id="8ad1" class="mg mh it bd mi mj nl ml mm mn nm mp mq jz nn ka ms kc no kd mu kf np kg mw mx bi translated"><strong class="ak">参考文献</strong></h1><p id="346c" class="pw-post-body-paragraph li lj it lk b ll my ju ln lo mz jx lq lr na lt lu lv nb lx ly lz nc mb mc md im bi translated">[1]世界法官协会范·赫斯维克(2020 年)。强化学习中的过滤。arXiv 预印本<a class="ae la" href="https://arxiv.org/abs/2008.02622" rel="noopener ugc nofollow" target="_blank"> arXiv:2008.02622 </a></p><p id="6bf6" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[2] Shreve，S. E. (2004 年)。金融随机微积分 II:连续时间模型，第 11 卷。斯普林格科学与商业媒体。</p><p id="73ea" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[3] Shiryaev，A. N. (1996 年)。概率。斯普林格纽约-海德堡。</p><p id="39ae" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">4 luen Berger，D. G. (1997 年)。投资科学。牛津大学出版社。</p><p id="4e8f" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[5]鲍威尔(2020 年)。关于状态变量、Bandit 问题和 POMDPs。arXiv 预印本<a class="ae la" href="https://arxiv.org/abs/2002.06238" rel="noopener ugc nofollow" target="_blank"> arXiv:2002.06238 </a></p></div></div>    
</body>
</html>