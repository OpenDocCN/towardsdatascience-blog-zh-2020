<html>
<head>
<title>An Introduction to the ROC-AUC in Classification Tasks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分类任务中 ROC-AUC 的介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-introduction-to-the-roc-auc-in-classification-tasks-94c2a147dd04?source=collection_archive---------41-----------------------#2020-09-16">https://towardsdatascience.com/an-introduction-to-the-roc-auc-in-classification-tasks-94c2a147dd04?source=collection_archive---------41-----------------------#2020-09-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7a80" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">曲线是什么意思？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5a1169fbaf2b2a547288134ea7a23c6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vTW_-VjtvqyM-8ec"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">弗朗西斯科·温加罗在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="58d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在机器学习中，一个基本的学习目标是将数据分类成组。虽然分类可以包括无监督学习(例如，聚类)，但在大多数情况下，我们的任务涉及已知的标签，因此我们正在进行监督学习来分类我们的数据。您的模型将生成预测标签，这将允许我们比较我们的预测是否准确。当预测的标签和真实的标签匹配时，我们说预测是正确的，显然当它们不匹配时，我们说预测是错误的。</p><p id="8181" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了将我们的讨论放在上下文中，假设我们有一些糖尿病诊断已知的受试者的临床数据。在我们继续之前，只是一个快速的免责声明——这些数据不是真实的数据，它们不构成任何医疗建议。</p><p id="9a4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基于这些数据，我们建立了一个逻辑回归模型，根据人们的空腹血糖水平来预测他们是否患有糖尿病。在下表中，空腹血糖水平表示为 mg/dL。diabetic_clinical 列显示临床诊断，diabetic_predicted 列显示逻辑回归模型的预测结果。根据临床和预测的结果，我们可以简单地知道预测是否正确，如最后一列所示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">空腹血糖水平与糖尿病</p></figure><h2 id="5a61" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">混淆矩阵</h2><p id="377c" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">基于这种与真实标签相关的二元评估结果(正确对错误)，我们可以构建 2 x 2 混淆矩阵，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/38f86bde630b7d397e191b3ceec2048b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FQ7lxnXu-dcex7yZLLhDZg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">困惑矩阵(作者)</p></figure><p id="0cec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">正确预测:</strong></p><ul class=""><li id="c5a3" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated"><strong class="lb iu">真阳性(TP) </strong>:预测和真标签均为阳性。在上面的例子中，这些人患有糖尿病，根据他们的空腹血糖水平预测他们会患糖尿病。</li><li id="2231" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><strong class="lb iu">真阴性(TN) </strong>:预测和真标签均为阴性。这些是非糖尿病受试者，他们被预测为非糖尿病患者。</li></ul><p id="ad16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">错误预测:</strong></p><ul class=""><li id="44aa" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated"><strong class="lb iu">假阳性(FP) </strong>:预测标签为阳性，真实标签为阴性。这些人被预测为糖尿病患者，但实际上他们不是。</li><li id="17d7" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><strong class="lb iu">假阴性(FN) </strong>:预测标签为阴性，真实标签为阳性。那些糖尿病患者被预测为非糖尿病患者。</li></ul><p id="e924" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以导出许多对分类模型评估至关重要的度量。下面列出了一些常用的指标，您可以在<a class="ae ky" href="https://en.wikipedia.org/wiki/Confusion_matrix" rel="noopener ugc nofollow" target="_blank"> Wikipedia </a>页面找到生成的指标的完整列表。</p><ul class=""><li id="f437" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated"><strong class="lb iu">准确率</strong>:正确预测数除以预测总数:<code class="fe nk nl nm nn b"><strong class="lb iu"><em class="no">(TP + TN) / (TP + TN + FP + FN)</em></strong></code>。在示例中，我们的模型的精度是 0.7(即 7 / 10)。</li><li id="50be" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><strong class="lb iu">真阳性率(TPR、灵敏度或召回率)</strong>:真阳性标签数除以阳性标签数:<code class="fe nk nl nm nn b"><strong class="lb iu"><em class="no">TP / (TP + FN)</em></strong></code>。我们模型的 TPR 是 0.8(即 4 / 5)。</li><li id="910c" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><strong class="lb iu">假阳性率(FPR，脱落)</strong>:假阳性标记数除以阴性标记数:<code class="fe nk nl nm nn b"><strong class="lb iu"><em class="no">FP / (FP + TN)</em></strong></code>。我们模型的 FPR 是 0.4(即 2 / 5)。</li><li id="4b7c" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><strong class="lb iu">真阴性率(特异性)</strong>:真阴性标记数除以阴性标记数:<code class="fe nk nl nm nn b"><strong class="lb iu"><em class="no">TN / (FP + TN)</em></strong></code> <em class="no">。</em>你可以注意到<code class="fe nk nl nm nn b"><strong class="lb iu"><em class="no">specificity = 1 — FPR</em></strong></code>。我们模型的特异性是 0.6(即 3 / 5)。</li></ul></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><h2 id="57b3" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">接收机工作特性</h2><p id="47fd" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">接收器操作特性曲线<strong class="lb iu">是一个图表，显示您的分类模型在所有阈值下的表现</strong>。下图是一条假设的 ROC 曲线。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/fb179ee895a88422240ac6d7b3822d26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yf8jf7_q5SND_VhpJ_9DRw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ROC 示例图(按作者)</p></figure><ul class=""><li id="4388" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated">在 ROC 曲线图中，x 轴是 FPR，而 y 轴是 TPR。</li><li id="360e" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">对于一个完美的模型，它的 FPR 是 0，它的 TPR 是 1。相比之下，对于最差的模型，其 FPR 为 1，TPR 为 0。图中显示了这两种极端情况的 ROC 曲线。</li><li id="8b18" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">在一个典型的模型中，我们应该看到真实的曲线。<strong class="lb iu">具体来说，通过改变阈值，我们的模型将产生不同的 TPR 和 FPR，并且这些点可以绘制在该图上。连接这些点，我们可以生成一个 ROC 曲线。</strong></li></ul><p id="11ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了将 ROC 曲线放入糖尿病诊断示例的上下文中，让我们假设我们可以有不同的阈值来预测糖尿病诊断。如你所料，如果我们有一个极低的阈值，我们会将所有受试者归类为糖尿病患者。虽然我们可以得到 1 的 TPR，但是 FPR 也会变成 1。考虑一些适中的阈值，我们应该能够找到 TPR 和 FPR 的许多不同组合。</p><p id="5770" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为显示的数据很小，如果您有更多的数据点，通过改变阈值，您应该创建更多的点作为 TPR 和 FPR 的函数。如果我们连接所有这些点并平滑曲线，我们就得到我们正在构建的特定模型的 ROC 曲线。</p></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><h2 id="3b4a" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">ROC 曲线下面积</h2><p id="6f99" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">我们如何量化模型的性能？如上所述，我们说 ROC 是为了显示我们的模型性能，但是我们如何用 ROC 曲线准确地评估性能呢？</p><p id="be43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你比较这两种极端情况(完美与最坏)，你可能会注意到曲线下的区域似乎意味着什么。你的猜测完全正确。假设您考虑一个典型的模型，在大多数情况下，您的模型的 TPR 应该大于各种阈值的 FPR。在这种情况下，您将看到图表对角线上方的 ROC 曲线。</p><p id="7053" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更重要的是，如果你的模型更好，你应该看到 TPR 和 FPR 之间更大的差异，这将曲线推向完美的模型状态。下图显示了您在使用真实模型时可能遇到的一些情况。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/90197e4136a7e74018fb515be7cae2a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HgMhMbeyYdBBiyWI3PPdDQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ROC 曲线的 AUC(按作者)</p></figure><ul class=""><li id="aaa0" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated">灰色区域表示 ROC 曲线下的区域。</li><li id="5079" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">模型 2 的 AUC 大于模型 1 的 AUC。我们通常认为模型 2 优于模型 1。换句话说，我们可以粗略地将分类模型的性能等同于它们各自的 AUC。</li><li id="3095" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">对角线描绘了用于二元分类任务的随机分类器。这里是<a class="ae ky" href="https://datascience.stackexchange.com/questions/31872/auc-roc-of-a-random-classifier" rel="noopener ugc nofollow" target="_blank">关于为什么 TPR 和 FPR 的随机猜测的 AUC 都是 0.5 的附加讨论</a>。</li></ul></div><div class="ab cl np nq hx nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="im in io ip iq"><h2 id="34f7" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">在你走之前</h2><p id="e88d" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">虽然 ROC 和 AUC 经常用于评估分类任务的性能，但它们并不总是首选。最主要的原因是它没有考虑实际的问题。例如，不同的模型可以具有相似的 AUC，但是它们可以具有不同的形状，这意味着模型具有 TPR 和 FPR 的不同组合。</p><p id="df82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们应该考虑其他因素来选择理想的模型。问自己的问题可以包括。你更关心正确识别阳性病例吗？还是更在乎正确识别负面案例？</p><p id="84b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有<a class="ae ky" href="https://developers.google.com/machine-learning/crash-course/classification/roc-and-auc" rel="noopener ugc nofollow" target="_blank">关于 ROC 和 AUC 的一个简单讨论</a>，我觉得对初学者很有用。</p></div></div>    
</body>
</html>