<html>
<head>
<title>Discrete Colour Scale in Plotly Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Plotly Python 中的离散色阶</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/discrete-colour-scale-in-plotly-python-26f2d6e21c77?source=collection_archive---------33-----------------------#2020-07-02">https://towardsdatascience.com/discrete-colour-scale-in-plotly-python-26f2d6e21c77?source=collection_archive---------33-----------------------#2020-07-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5b3c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个我决定要解决的恼人问题</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b89768091e69b1a47387fbef899cc362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OgeZaDlvb_1p4_iCvFRXIA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">右侧一组离散的颜色条(原始内容)</p></figure><p id="8a1d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我喜欢使用 python 库进行 Plotly，但是我注意到，当我试图使用 Graph 对象来做一些事情，比如制作 Choropleth 地图时，我很难为我的数据获取离散的颜色范围。</p><p id="385e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我喜欢根据类别将我的数据分成不同的区域。例如，如果我试图显示三类数据，我将为第一组使用 0-33 的范围，为第二组使用 34-66 的范围，最后为 67-100。在每一个类别中，我都想展示它自己的一套独立的颜色(见上图)。为了做到这一点，我写了下面的函数，我希望它能帮助那些想做同样事情的人！</p><h1 id="3a4b" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">该功能</h1><p id="2db1" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">这个函数所做的就是接受一个颜色元素列表。然后，它会想出如何为各种输入制作离散的色块。读一读，看看下面实际怎么叫。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="2ef9" class="mw lv it ms b gy mx my l mz na">def generateDiscreteColourScale(colour_set):<br/>    <strong class="ms iu">#colour set is a list of lists</strong><br/>    colour_output = []<br/>    num_colours = len(colour_set)<br/>    divisions = 1./num_colours<br/>    c_index = 0.</span><span id="be39" class="mw lv it ms b gy nb my l mz na">    <strong class="ms iu"># Loop over the colour set</strong><br/>    for cset in colour_set:<br/>        num_subs = len(cset)<br/>        sub_divisions = divisions/num_subs</span><span id="6221" class="mw lv it ms b gy nb my l mz na">        <strong class="ms iu"># Loop over the sub colours in this set</strong><br/>        for subcset in cset:<br/>            colour_output.append((c_index,subcset))<br/>            colour_output.append((c_index + sub_divisions-<br/>                .001,subcset))<br/>            c_index = c_index + sub_divisions<br/>    colour_output[-1]=(1,colour_output[-1][1])<br/>    return colour_output</span></pre><p id="cf86" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面是一段很短的代码，但是它为我们做了很多工作。</p><h1 id="2ff3" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">使用</h1><p id="b79a" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">为了绘制主标题图像，我实际上有 4 个类别(哈利·波特房屋),我不仅想用纯色显示这 4 个类别，还想根据出现的次数(从亮到暗)对它们进行细分。我已经准备好了所有的数据，但需要得到色阶。在下面我们来定义这个方案。每个列表元素对应一个类别(即哈利波特的房子)，这个列表元素实际上包含了我想要使用的颜色范围的列表(从最亮的颜色到最暗的颜色)。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="c340" class="mw lv it ms b gy mx my l mz na"><strong class="ms iu"># Harry Potter Houses</strong><br/>color_schemes = [<br/>    ['#890000','#890000','#5c0000'],<br/>    ['#2a6b28','#0b4c07','#003206'],<br/>    ['#4f5a90','#374798','#30375a'],<br/>    ['#fff4b1','#ffed86','#ffdb00']<br/>]</span></pre><p id="db90" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我可以调用上面的函数来获取适当的格式，并将其传递给 go。Choropleth plotly 对象。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="19d3" class="mw lv it ms b gy mx my l mz na">colorscale = generateDiscreteColourScale(color_schemes)</span></pre><p id="d123" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最终增加了我们的情节。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="7101" class="mw lv it ms b gy mx my l mz na">fig.add_trace(go.Choropleth(<br/>    geojson=counties,<br/>    locations=fips,<br/>    z=final['split'].astype(float),<br/>    <strong class="ms iu"><em class="nc">colorscale=colorscale,   &lt;--- THE MONEY</em></strong><br/>    marker_line_width=0.0, # line markers between states<br/>    marker_line_color='rgba(0,0,0,0.1)',<br/>    text=final['label'], # hover text<br/>))</span></pre><p id="369c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就这么简单！你可以用它来制作一堆好看的情节。下面是我使用它的一些例子。</p><div class="kj kk kl km gt ab cb"><figure class="nd kn ne nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/79790cb14109bfebd0a953ed8391f12d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*SyF-vIITIYELIRpO8Gwvtw.png"/></div></figure><figure class="nd kn ne nf ng nh ni paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/682900d33aca4019c708280c8b9d246a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*M91-hzcorsTE6b_sEtnG1g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk nj di nk nl translated">使用映射功能的一些示例(原始内容)</p></figure></div><p id="12e5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当然，这并不局限于地图，在 plotly 中使用<em class="nc"> colourscale </em>输入的任何情况下都可以使用。</p><p id="3ef5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">希望这有所帮助！如果有任何问题，请随时联系我！</p><h1 id="c5de" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">参考</h1><div class="nm nn gp gr no np"><a href="https://www.kaggle.com/kapastor/google-trends-dma" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">谷歌趋势 DMA</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">使用 Kaggle 笔记本探索和运行机器学习代码|使用来自 Google Trends County-DMA 映射的数据</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">www.kaggle.com</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od ks np"/></div></div></a></div><div class="nm nn gp gr no np"><a href="https://plotly.com/python/choropleth-maps/" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">Choropleth 地图</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">如何用 Plotly 在 Python 中制作 choropleth 地图？</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">plotly.com</p></div></div><div class="ny l"><div class="oe l oa ob oc ny od ks np"/></div></div></a></div></div></div>    
</body>
</html>