<html>
<head>
<title>Tips and Tricks for Fast Data Analysis in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中快速数据分析的技巧和诀窍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/tips-and-tricks-for-fast-data-analysis-in-python-f108ad32fa90?source=collection_archive---------13-----------------------#2020-02-07">https://towardsdatascience.com/tips-and-tricks-for-fast-data-analysis-in-python-f108ad32fa90?source=collection_archive---------13-----------------------#2020-02-07</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><figure class="it iu gq gs iv iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj is"><img src="../Images/7255a7b89fce2a357350856afaad2e94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oCIs3k9fe0qajvj2qNCRkw.jpeg"/></div></div><p class="jd je gk gi gj jf jg bd b be z dk translated">尼古拉斯·霍伊泽在<a class="ae jh" href="https://unsplash.com/s/photos/quick?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><div class=""/><div class=""><h2 id="4271" class="pw-subtitle-paragraph kh jj jk bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dk translated">用 python 快速总结和描述数据集</h2></div><p id="3247" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">python 编程语言有大量用于数据分析的内置函数和库。结合这些库可以产生非常强大的方法来总结、描述和过滤大量数据。</p><p id="5c80" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">在本文中，我想分享一些关于如何结合<a class="ae jh" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>、<a class="ae jh" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> matplotlib </a>和一些内置 python 功能来快速分析数据集的技巧。</p><p id="542f" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">本文中的所有库都可以通过软件包管理器安装。</p></div><div class="ab cl lv lw hy lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="in io ip iq ir"><h2 id="2e30" class="mc md jk bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">数据</h2><p id="7fec" class="pw-post-body-paragraph kz la jk lb b lc mv kl le lf mw ko lh li mx lk ll lm my lo lp lq mz ls lt lu in bi translated">在本文中，我将使用一个被称为成人收入数据集的数据集，它可以从<a class="ae jh" href="https://archive.ics.uci.edu/ml/datasets/adult" rel="noopener ugc nofollow" target="_blank"> UCI 机器学习库</a>下载。该数据集包含关于每个成年人的许多特征和一个目标变量，该变量告诉我们他们的收入是否超过 50，000 pa。</p><p id="616c" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">这里是我正在使用的库的所有导入。</p><pre class="na nb nc nd gu ne nf ng nh aw ni bi"><span id="f77c" class="mc md jk nf b gz nj nk l nl nm">import pandas as pd<br/>import numpy as np<br/>from sklearn import preprocessing</span><span id="7ce7" class="mc md jk nf b gz nn nk l nl nm">import matplotlib.pyplot as plt<br/>%matplotlib inline</span></pre><p id="acd2" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我使用 pandas 读取数据集并返回前几行。</p><pre class="na nb nc nd gu ne nf ng nh aw ni bi"><span id="ed55" class="mc md jk nf b gz nj nk l nl nm">data = pd.read_csv('adults_data.csv')<br/>data.head()</span></pre><figure class="na nb nc nd gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj no"><img src="../Images/e6092fc71f43c7b79b015c7daf63cd41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kwnlZDg9RYgaC4Q-d6I4wg.png"/></div></div></figure><p id="6086" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">该数据集通常用于建立机器学习模型，该模型根据特征预测收入阶层。然而，在进入模型构建阶段之前，先进行一些数据分析是有用的。</p><h2 id="8ae8" class="mc md jk bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">形容</h2><p id="ed07" class="pw-post-body-paragraph kz la jk lb b lc mv kl le lf mw ko lh li mx lk ll lm my lo lp lq mz ls lt lu in bi translated">describe 函数允许我们快速查看数据集中数字要素的一些基本描述性统计数据。运行<code class="fe np nq nr nf b">data.describe()</code>我们可以看到我们的数据集有 32，561 行，我们可以看到每个数字特征的平均值，并了解每个特征的值分布情况。</p><figure class="na nb nc nd gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj ns"><img src="../Images/3920b23c2613ca3e2775ee174687c245.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aiiuqi07_KLGIEkL7Qp4Dg.png"/></div></div></figure><h2 id="c5e7" class="mc md jk bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">值计数</h2><p id="3e2d" class="pw-post-body-paragraph kz la jk lb b lc mv kl le lf mw ko lh li mx lk ll lm my lo lp lq mz ls lt lu in bi translated">在这个数据集中，我们还有分类变量，对这些变量的分布有一个基本的了解也是很有用的。<code class="fe np nq nr nf b">value_counts()</code>函数提供了一种非常简单的方法来实现这一点。让我们用这个来检查一下<code class="fe np nq nr nf b">marital-status</code>的特性。</p><pre class="na nb nc nd gu ne nf ng nh aw ni bi"><span id="1b04" class="mc md jk nf b gz nj nk l nl nm">data['marital-status'].value_counts()</span></pre><figure class="na nb nc nd gu iw gi gj paragraph-image"><div class="gi gj nt"><img src="../Images/908011ea028ea594f224fc789e28d538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*9kJk9a1ffVXxFe-6svZblg.png"/></div></figure><p id="d5d1" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">为了使其更容易可视化，我们可以通过添加少量额外代码来快速创建该值的条形图。标题是可选的，您可以使用通常的 matplotlib 功能自定义轴标签、颜色和图表的其他方面。</p><pre class="na nb nc nd gu ne nf ng nh aw ni bi"><span id="73e1" class="mc md jk nf b gz nj nk l nl nm">plt.title('Marital Status')<br/>data['marital-status'].value_counts().plot.bar()</span></pre><figure class="na nb nc nd gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj nu"><img src="../Images/f36740d33f700e0017bbcc88c471a3eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QIIDt7NmqXmrppwR2t0iHg.png"/></div></div></figure><p id="02b1" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">当我们有一个具有高基数(大量唯一值)的要素时，使用值计数绘图就不那么有效了。</p><pre class="na nb nc nd gu ne nf ng nh aw ni bi"><span id="b7f0" class="mc md jk nf b gz nj nk l nl nm">plt.title('Native Country')<br/>data['native-country'].value_counts().plot.bar()</span></pre><figure class="na nb nc nd gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj nv"><img src="../Images/196ffe52cb687d40a26589a2c97d7b44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k_UQ58wUrIhkX4H1m0Apag.png"/></div></div></figure><p id="2f5e" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">对于像 native-country 这样的要素，只绘制前 n 个值会更有用，因为这为我们提供了有用的洞察力。我们可以通过增加一点代码来实现。</p><pre class="na nb nc nd gu ne nf ng nh aw ni bi"><span id="2dca" class="mc md jk nf b gz nj nk l nl nm">plt.title('Native Country')<br/>data['native-country'].value_counts().nlargest(10).plot.bar()</span></pre><figure class="na nb nc nd gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj nw"><img src="../Images/8c8893c4ce3321ac6e7669cbd14b2623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y2BRiQHThnIVw_t7FMl3sQ.png"/></div></div></figure><h2 id="3627" class="mc md jk bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">熊猫小组</h2><p id="9d91" class="pw-post-body-paragraph kz la jk lb b lc mv kl le lf mw ko lh li mx lk ll lm my lo lp lq mz ls lt lu in bi translated">当我们有数据要进行分段比较时，pandas groupby 函数非常有用。在该数据集中，我们希望执行分析以了解两个收入类别之间的差异以及要素差异的大小。pandas 的 groupby 函数提供了一种非常快速的方法来实现这一点。</p><p id="ed2e" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">如果我们运行下面的代码，我们可以分析两个收入组之间所有数值的均值差异。</p><pre class="na nb nc nd gu ne nf ng nh aw ni bi"><span id="81c5" class="mc md jk nf b gz nj nk l nl nm">round(data.groupby(['income']).mean(),2)</span></pre><figure class="na nb nc nd gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj nx"><img src="../Images/f2a4b4605b8c5c6f066c7e03d1317a34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IBWp2azrHDlY5M8X9L3ubg.png"/></div></div></figure><p id="699a" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">比较差异的更好方法是查看两组的分布差异。箱线图是一种很有用的方法。这可以通过与 groupby 一起使用绘图功能来实现。可视化如下所示。</p><pre class="na nb nc nd gu ne nf ng nh aw ni bi"><span id="cb53" class="mc md jk nf b gz nj nk l nl nm">data.groupby('income').boxplot(fontsize=20,rot=90,figsize=(20,10),patch_artist=True)</span></pre><figure class="na nb nc nd gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj ny"><img src="../Images/804963992dda53c6506610e936fdd0e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K656_PQxWenxzO4-sVyQPg.png"/></div></div></figure><p id="b7aa" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">你会注意到，由于数值在不同的尺度上，很难比较这两种分布。为了克服这一点，我们可以<a class="ae jh" href="https://medium.com/greyatom/why-how-and-when-to-scale-your-features-4b30ab09db5e" rel="noopener">缩放</a>这些值。为此，我使用了<a class="ae jh" href="https://scikit-learn.org/" rel="noopener ugc nofollow" target="_blank">scikit-learn</a>minmax scaler 函数。这会缩放这些值，使它们都位于 0 和 1 之间。我们现在可以清楚地看到一些特征之间的实质性差异，例如年龄和每周工作时间。</p><pre class="na nb nc nd gu ne nf ng nh aw ni bi"><span id="96d2" class="mc md jk nf b gz nj nk l nl nm">numeric_features = data.select_dtypes(include=['int64', 'float64']).columns<br/>categorical_features = data.select_dtypes(include=['object']).columns</span><span id="997f" class="mc md jk nf b gz nn nk l nl nm">numeric_data = data[numeric_features]<br/>categorical_data = data[categorical_features]</span><span id="ab88" class="mc md jk nf b gz nn nk l nl nm">x = numeric_data.values <br/>min_max_scaler = preprocessing.MinMaxScaler()<br/>x_scaled = min_max_scaler.fit_transform(x)<br/>numeric_data = pd.DataFrame(x_scaled, columns=numeric_data.columns)<br/>data_transformed = pd.concat([numeric_data, categorical_data], axis=1)<br/>data_transformed.groupby('income').boxplot(fontsize=20,rot=90,figsize=(20,10),patch_artist=True)</span></pre><figure class="na nb nc nd gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj nz"><img src="../Images/402cc630d149dc1d37c23d08907904d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AKFTUSozksr-2i56iegbAw.png"/></div></div></figure><p id="0ebc" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们还可以使用 groupby 函数来比较分类特征。在下图中，我们可以很快发现，在高收入阶层中，男性人数多于女性。</p><pre class="na nb nc nd gu ne nf ng nh aw ni bi"><span id="98ab" class="mc md jk nf b gz nj nk l nl nm">data.groupby('income').gender.value_counts().unstack(0).plot.barh()</span></pre><figure class="na nb nc nd gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj oa"><img src="../Images/257efc6d21776042ddb47a8fadf5fe7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GiZJ15VOqxenc2KW-2b94g.png"/></div></div></figure><h2 id="8d14" class="mc md jk bd me mf mg dn mh mi mj dp mk li ml mm mn lm mo mp mq lq mr ms mt mu bi translated">数据透视表</h2><p id="8eba" class="pw-post-body-paragraph kz la jk lb b lc mv kl le lf mw ko lh li mx lk ll lm my lo lp lq mz ls lt lu in bi translated">Pandas 的功能使您能够用 python 创建电子表格风格的数据透视表。数据透视表允许您快速汇总、分组和过滤数据，以执行更复杂的分析。</p><p id="ed40" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们可以使用数据透视表来探索更复杂的关系。让我们更深入地研究一下性别和收入阶层之间的关系。女性挣得少是因为她们每周工作时间少吗？</p><pre class="na nb nc nd gu ne nf ng nh aw ni bi"><span id="9e87" class="mc md jk nf b gz nj nk l nl nm">pivot_workclass = pd.pivot_table(data, values=['hours-per-week'],<br/>                                 index = 'gender',<br/>                                 columns = 'income', aggfunc=np.mean, fill_value=0)</span></pre><figure class="na nb nc nd gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj ob"><img src="../Images/f507b81a803ce11da87c392e53e237ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*guLHR4vjggyVr3X5WCE5nw.png"/></div></div></figure><p id="0a58" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们可以添加绘图功能，使这更容易可视化。</p><pre class="na nb nc nd gu ne nf ng nh aw ni bi"><span id="7568" class="mc md jk nf b gz nj nk l nl nm">pivot_workclass = pd.pivot_table(data, values=['hours-per-week'],<br/>                                 index = 'gender',<br/>                                 columns = 'income', aggfunc=np.mean, fill_value=0).plot.bar()</span></pre><figure class="na nb nc nd gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj oc"><img src="../Images/5af15dfccb4a91e627645ea22dd2b405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rik4wqBLcYiJMLe_dP3gnw.png"/></div></div></figure></div><div class="ab cl lv lw hy lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="in io ip iq ir"><p id="f2a3" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">上面描述的所有方法都可以扩展，以创建更丰富、更复杂的分析。更多关于熊猫图书馆的信息，请看我之前的指南，可以在<a class="ae jh" rel="noopener" target="_blank" href="/5-minute-guide-to-plotting-with-pandas-e8c0f40a1df4">这里</a>找到。</p><p id="ee60" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">感谢阅读！</p></div></div>    
</body>
</html>