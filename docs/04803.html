<html>
<head>
<title>Estimating Parameters of Compartmental Models from Observed Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从观测数据估计房室模型的参数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/estimating-parameters-of-compartmental-models-from-observed-data-62f87966bb2b?source=collection_archive---------20-----------------------#2020-04-27">https://towardsdatascience.com/estimating-parameters-of-compartmental-models-from-observed-data-62f87966bb2b?source=collection_archive---------20-----------------------#2020-04-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6146" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">非线性最小二乘最小化估计SEIR和塞德模型的参数</h2></div><p id="774e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将定义SEIR和塞德模型，并最小化非线性最小二乘法，以从冠状病毒病例的观察数据中估计它们的参数。为了表现良好，非线性优化技术，如<a class="ae le" href="https://en.wikipedia.org/wiki/Levenberg%E2%80%93Marquardt_algorithm" rel="noopener ugc nofollow" target="_blank">leven Berg–Marquardt(LM)算法</a>需要良好的初始猜测来解决非线性最小二乘优化。我们将使用<a class="ae le" rel="noopener" target="_blank" href="/simulating-compartmental-models-in-epidemiology-using-python-jupyter-widgets-8d76bdaff5c2"> SEIR和塞德模型模拟</a>来猜测参数估计值，并在优化中使用这些值。</p><blockquote class="lf lg lh"><p id="110a" class="ki kj li kk b kl km ju kn ko kp jx kq lj ks kt ku lk kw kx ky ll la lb lc ld im bi translated">请注意，这纯粹是一个编程和数据科学练习，因此不要根据模拟或参数估计得出结论。这最好留给流行病学和医学专家去做。</p></blockquote><p id="7ba5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们深入研究之前，让我们先熟悉一下SEIR和塞德所属的模型类型。</p><p id="54b9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，如果您想直接进入代码，在SEIR模型的<a class="ae le" href="https://github.com/silpara/simulators/blob/master/compartmental_models/SEIR%20Simulator%20with%20Parameter%20Estimation%20in%20Python.ipynb" rel="noopener ugc nofollow" target="_blank">仿真&amp;参数估计和塞德模型</a>的<a class="ae le" href="https://github.com/silpara/simulators/blob/master/compartmental_models/SEIRD%20Simulator%20with%20Parameter%20Estimation%20in%20Python.ipynb" rel="noopener ugc nofollow" target="_blank">仿真&amp;参数估计中可以获得带有完整代码的Jupyter笔记本。</a></p><h1 id="dbc0" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">机械模型</h1><p id="4056" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">机械模型用于模拟和预测疾病和感染的传播，如流感、埃博拉甚至冠状病毒。与机器学习模型相比，机械模型的一个显著特征是它们能够对疾病传播的假设因果性质进行编码。这通常涉及构建因果机制的数学公式，并使用分析工具用观测数据验证这些假设[R. Baker等人，2018]。</p><p id="9692" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">简而言之，机械模型是可以解释的，而机器学习模型通常是不可以解释的。正因为如此，一个能够很好地解释这一现象的机械模型可以提供关于疾病如何传播以及可能如何应对的深刻信息。下面的表1列出了这两种模型提供的数据和信息类型的差异。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mj"><img src="../Images/9c78e862df4fa530f1b9c02c7239afd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ke8hCe9errmo7-Lk2jkEpA.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">表1: Baker RE，pea J-M，Jayamohan J和Jérusalem A，2018机械论模型对机器学习，一场值得为生物界而战的战斗？生物。信件。18866 . 688686868617</p></figure><h2 id="0df9" class="mz ln it bd lo na nb dn ls nc nd dp lw kr ne nf ly kv ng nh ma kz ni nj mc nk bi translated">分室模型</h2><p id="f646" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">房室模型是一种机械模型，它将种群分成称为<em class="li">房室</em>的组。它们基于一个常微分方程系统，该系统表达了一个群体的不同流行病学状态之间的动态。它们有助于对一种现象(如疾病)的传播进行短期和长期预测，也可用于研究不同干预措施的效果[Chowell，2017]。</p><h2 id="8867" class="mz ln it bd lo na nb dn ls nc nd dp lw kr ne nf ly kv ng nh ma kz ni nj mc nk bi translated">SEIRD塞德公司</h2><p id="c014" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">下面的图1和图2显示了SEIR和塞德模型中流行病学状态之间的间隔和进展。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nl"><img src="../Images/3946cc26651d3ffcafd80602fc359bd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SlE67uzsxxTCDVGNmt9N5w.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图1: SEIR模型</p></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nm"><img src="../Images/3dfdea932d6a161f2ff033aa53186097.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-TCB--QLTcyjQu9Mi30Ulg.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图2: SEIRD模型</p></figure><p id="88c3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要查看这些模型的动力系统以及如何用python模拟它们的更多细节，请参考<a class="ae le" rel="noopener" target="_blank" href="/simulating-compartmental-models-in-epidemiology-using-python-jupyter-widgets-8d76bdaff5c2">使用Python模拟流行病学中的房室模型&amp; Jupyter Widgets </a>。</p><h1 id="50b0" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">估计参数</h1><p id="0e7f" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">在这一节中，我们将讨论数据，模型和最小化非线性最小二乘参数估计。</p><h2 id="585d" class="mz ln it bd lo na nb dn ls nc nd dp lw kr ne nf ly kv ng nh ma kz ni nj mc nk bi translated">数据</h2><p id="2f3b" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">我们将使用印度<a class="ae le" href="https://api.rootnet.in/covid19-in/stats/history" rel="noopener ugc nofollow" target="_blank">新冠肺炎REST API</a>提供的印度冠状病毒病例数据。从API返回的JSON的结构如下，</p><pre class="mk ml mm mn gt nn no np nq aw nr bi"><span id="5c7d" class="mz ln it no b gy ns nt l nu nv">{<br/>'success': boolean, <br/>'data': [<br/>         {'day': 'YYYY-MM-DD', <br/>          'summary': {<br/>                     'total': int,<br/>                     'confirmedCasesIndian': int,<br/>                     'confirmedCasesForeign': int,<br/>                     'discharged': int,<br/>                     'deaths': int,<br/>                     'confirmedButLocationUnidentified': int<br/>                     }, <br/>          'regional': [<br/>                       {<br/>                       'loc': string,<br/>                       'confirmedCasesIndian': int,<br/>                       'discharged': int,<br/>                       'deaths': int,<br/>                       'confirmedCasesForeign': int,<br/>                       'totalConfirmed': int<br/>                       }                     <br/>                      ]<br/>          }<br/>         ], <br/>'lastRefreshed': timestamp, <br/>'lastOriginUpdate': timestamp<br/>}</span></pre><p id="3491" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据示例如下所示，</p><pre class="mk ml mm mn gt nn no np nq aw nr bi"><span id="8e9b" class="mz ln it no b gy ns nt l nu nv">{<br/> 'success': True,<br/> 'data': [<br/>          {'day': '2020-03-10',<br/>           'summary': {<br/>                      'total': 47,<br/>                      'confirmedCasesIndian': 31,<br/>                      'confirmedCasesForeign': 16,<br/>                      'discharged': 0,<br/>                      'deaths': 0,<br/>                      'confirmedButLocationUnidentified': 0<br/>                      },<br/>           'regional': [<br/>                        {<br/>                        'loc': 'Delhi',<br/>                        'confirmedCasesIndian': 4,<br/>                        'confirmedCasesForeign': 0,<br/>                        'discharged': 0,<br/>                        'deaths': 0,<br/>                        'totalConfirmed': 4},<br/>                        {<br/>                        'loc': 'Haryana',<br/>                        'confirmedCasesIndian': 0,<br/>                        'confirmedCasesForeign': 14,<br/>                        'discharged': 0,<br/>                        ...<br/>                        }<br/>                        ...<br/>                        ]<br/>            }<br/>            ...<br/>           ],<br/> 'lastRefreshed': '2020-04-27T04:30:02.090Z', <br/> 'lastOriginUpdate': '2020-04-27T02:30:00.000Z'<br/>}</span></pre><p id="155f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些数据可以很容易地转换成pandas数据框，我们熟悉使用下面这段代码</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="a191" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看下面表2中熊猫数据帧的前5行，</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi ny"><img src="../Images/c23e7d068251d98484dcb2046cb82fdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Rfeorzdudt4zWms1J3XTw.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">表2:印度有新冠肺炎病例的数据帧样本</p></figure><p id="b4fb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于每天都有新的非零阳性病例，印度冠状病毒阳性病例总数仍在上升。案件趋势如下图3所示。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nz"><img src="../Images/5bea0b587250a33ac43da8c3f670238c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6IQqc2wxnCxQJGr533i9TQ.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图3:印度的新冠肺炎病例</p></figure><p id="5047" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让我们用python来定义模型。</p><h2 id="f0e9" class="mz ln it bd lo na nb dn ls nc nd dp lw kr ne nf ly kv ng nh ma kz ni nj mc nk bi translated">定义SEIR和塞德模型</h2><p id="4d26" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">SEIR和塞德模型是由一个常微分方程系统定义的。让我们看看这些ode是什么，以及如何用python编码和求解它们，</p><p id="678f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> SEIR </strong></p><p id="41b5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数学模型</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi oa"><img src="../Images/1548d6937a7b58acde13fded0f4140f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1JFKFG7cl34J64fST63Oxw.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图4: SEIR动力系统</p></figure><p id="adc2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Python代码</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="8c34" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">塞德</strong></p><p id="be25" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数学模型</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi ob"><img src="../Images/a8906dce04abfa37cc4bbf9ad7d4c42f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aQO-O12Jn4lQK7tYlygeVw.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图5: SEIRD动力系统</p></figure><p id="0f30" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Python代码</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="79da" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用scipy中的odeint模块来求解这些方程组。像ODE的系统一样，求解ODE的函数也非常相似。让我们看看如何用Python为SEIRD模型编码。</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="bbb5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要解一个常微分方程系统，你需要初始条件和描述你的方程的参数。您可以在上面的python代码中观察到这些。</p><p id="8357" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们使用非线性最小二乘最小化来优化ODE的参数。</p><h2 id="7789" class="mz ln it bd lo na nb dn ls nc nd dp lw kr ne nf ly kv ng nh ma kz ni nj mc nk bi translated">非线性最小二乘最小化</h2><h2 id="86f7" class="mz ln it bd lo na nb dn ls nc nd dp lw kr ne nf ly kv ng nh ma kz ni nj mc nk bi translated"><strong class="ak">什么是非线性最小二乘法？</strong></h2><p id="1d63" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">非线性模型是指输出和输入之间的关系在模型参数中不是线性的。例如</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi oc"><img src="../Images/5f32a359cbc6e113fc2b374ce259a22d.png" data-original-src="https://miro.medium.com/v2/resize:fit:364/format:webp/1*4QLz0sCnb2azaQz_S9rwxA.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图6:米氏–门滕酶动力学模型</p></figure><p id="73ea" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae le" href="https://en.wikipedia.org/wiki/Nonlinear_regression" rel="noopener ugc nofollow" target="_blank">Michaelis–Menten模型</a>不能表示为两个β的线性组合。</p><p id="4a96" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，非线性最小二乘可以定义为，<em class="li">“非线性最小二乘是最小二乘分析的一种形式，用于将一组m个观测值与一个在n个未知参数(m ≥ n)中为非线性的模型进行拟合。”—维基百科</em></p><p id="ee0e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最小化非线性最小二乘的算法(例如LM)需要更接近最优值的良好的初始参数估计。接下来，我们将使用模型的模拟来达到一个良好的初始估计。</p><p id="ee44" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">模拟</strong></p><p id="1eed" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用后<a class="ae le" rel="noopener" target="_blank" href="/simulating-compartmental-models-in-epidemiology-using-python-jupyter-widgets-8d76bdaff5c2">中构建的SEIR和塞德模型的模拟器，使用Python &amp; Jupyter Widgets </a>模拟流行病学中的房室模型，并为此进行一些修改。</p><p id="238f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在尝试了各种参数组合后，beta(感染率)= 1.14，sigma(孵化率)= 0.02，gamma(恢复率)= 0.02，mu(死亡率)= 0.01，似乎是SEIRD模型的合理初始估计。模拟器设置可以在下面的图7中看到。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi od"><img src="../Images/cab5be2329d96daa67d785935d2857c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gtjfuTssX4FDEgL-f759gw.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图7:使用SEIRD模拟器直观拟合初始参数估计数据</p></figure><p id="5463" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">类似的方法可以用于SEIR模型。现在，让我们使用初始猜测，使用LM算法进一步优化参数。</p><p id="bac8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">优化</strong></p><p id="fc89" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在不涉及太多细节的情况下，在leven Berg-Marquardt算法(也称为阻尼最小二乘法(DLS ))中，连续时段中的权重变化由下式给出:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/96fd98845d1d0a1119e0e97be869142d.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*Q0OXU-lshrZ3STdNYqzAuQ.png"/></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图8:LM算法中历元m的所有权重的权重变化的通用公式。应用科学与工程的神经网络。</p></figure><p id="a48b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用python中<em class="li"> lmfit </em>库中的<em class="li"> minimize </em>模块，使用LM算法实现非线性最小二乘的最小化。<em class="li">最小化</em>需要残差以及模型的其他参数作为优化输入。让我们对残差进行编码，并将其传递给<em class="li">最小化</em>，如下所示。</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="f1af" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，用LM算法(<em class="li"> leastsq </em>)最小化非线性最小二乘非常简单，如下面的代码所示。</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="6aa3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">优化完成后，您可以打印优化的模型参数并可视化拟合。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi of"><img src="../Images/d4818b82f0ff008774d1b774476cbf37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XcoT4w6unnpgKW3d7Q-YNg.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">表3:优化的模型参数</p></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi og"><img src="../Images/e3a2c3c5c111c28b8a56d5d1e620fd70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C60tvcC02xJKHImFOUNCTg.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图9:观察图与拟合图</p></figure><p id="3ee9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">指标</strong></p><p id="e7e5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还可以通过使用优化的参数并调用上面定义的<em class="li"> ode_solver </em>来计算像MAE和RMSE这样的指标。在写这篇文章的时候，我发现这些价值观是，</p><pre class="mk ml mm mn gt nn no np nq aw nr bi"><span id="c490" class="mz ln it no b gy ns nt l nu nv">Fitted MAE<br/>Infected:  587.5587793520101<br/>Recovered: 216.5347633701369<br/>Dead:      21.532532235433454<br/><br/>Fitted RMSE<br/>Infected:  702.1643902204037<br/>Recovered: 284.9841911847741<br/>Dead:      26.4463792416788</span></pre><p id="0be4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您还可以在模拟器中输入优化的参数值，以查看流行病学状态曲线，如图9所示。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi oh"><img src="../Images/3c82ea6b6ab74de143525c5642658b14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hRpnNDQ229LBUvATS2g6CA.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">图10:具有优化参数的SEIRD模型模拟</p></figure><h1 id="754b" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">完全码</h1><p id="265d" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">在SEIR模型的<a class="ae le" href="https://github.com/silpara/simulators/blob/master/compartmental_models/SEIR%20Simulator%20with%20Parameter%20Estimation%20in%20Python.ipynb" rel="noopener ugc nofollow" target="_blank">仿真&amp;参数估计和赛德模型</a>的<a class="ae le" href="https://github.com/silpara/simulators/blob/master/compartmental_models/SEIRD%20Simulator%20with%20Parameter%20Estimation%20in%20Python.ipynb" rel="noopener ugc nofollow" target="_blank">仿真&amp;参数估计中可以找到完整代码的jupyter笔记本。</a></p><h1 id="c577" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">结论</h1><p id="a236" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">在这篇文章中，我们了解到，</p><ol class=""><li id="0cb7" class="oi oj it kk b kl km ko kp kr ok kv ol kz om ld on oo op oq bi translated">机械模型、分室模型、SEIR模型和塞德模型</li><li id="b88d" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated">用Python写颂歌并解决它们</li><li id="3851" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated">非线性模型和非线性最小二乘法</li><li id="2652" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated">利用SEIRD塞德模拟器和lmfit库中的最小化模块优化ODE参数</li><li id="ff57" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated">在模拟器中使用优化的参数来可视化流行病学状态曲线</li></ol><p id="cfa7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">*注意，同样的方法也可以用于编码和优化任何ode系统。</p><p id="8ebb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们没有学到的东西(有意识的选择)</p><ol class=""><li id="5baf" class="oi oj it kk b kl km ko kp kr ok kv ol kz om ld on oo op oq bi translated">如何解读这些流行病学模型的结果？</li><li id="ae39" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated">曲线什么时候会变平？有多少人会感染、康复、死亡等？我们什么时候能重新启动经济？</li></ol><p id="4daf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们把这些重要的问题留给专家来回答。</p><h1 id="c7fe" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">参考</h1><ol class=""><li id="cc7d" class="oi oj it kk b kl me ko mf kr ow kv ox kz oy ld on oo op oq bi translated">Baker RE，pea J-M，Jayamohan J和Jérusalem A，2018，机械模型对机器学习，一场值得为生物界而战的战斗？生物。http://doi.org/10.1098/rsbl.2017.0660</li><li id="76fc" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated">Chowell G,《用量化的不确定性拟合流行病爆发的动态模型:参数不确定性、可识别性和预测的初级读本》( 2017年),《传染病建模》第2卷第3期，2017年8月，第379-398页</li><li id="ce9b" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated"><a class="ae le" href="https://en.wikipedia.org/wiki/Non-linear_least_squares" rel="noopener ugc nofollow" target="_blank">非线性最小二乘法(维基百科)</a></li><li id="6194" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated"><a class="ae le" href="https://en.wikipedia.org/wiki/Nonlinear_regression" rel="noopener ugc nofollow" target="_blank">非线性回归(维基百科)</a></li><li id="ad12" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated">萨马拉辛哈，2007，应用科学与工程的神经网络</li></ol></div></div>    
</body>
</html>