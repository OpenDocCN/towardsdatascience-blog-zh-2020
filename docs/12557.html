<html>
<head>
<title>My first exposure to a Machine Learning problem.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我第一次接触到机器学习问题。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/my-first-exposure-to-a-machine-learning-problem-4804ea1480f9?source=collection_archive---------34-----------------------#2020-08-29">https://towardsdatascience.com/my-first-exposure-to-a-machine-learning-problem-4804ea1480f9?source=collection_archive---------34-----------------------#2020-08-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="91b6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">解决世界闻名的泰坦尼克号机器学习问题，并向 ML 的世界介绍自己。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/60dd3d478feeec08fe288cc3f952a7b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xtIjwfXWRf2kE4K3"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">美国国家海洋和大气管理局在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h1 id="69bc" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">简介</strong></h1><p id="35a9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这个时代的每个人都知道泰坦尼克号。泰坦尼克号是当时最大的船，被称为“永不沉没之船”。以至于该船的工程师和建筑师得出结论，没有必要在船上增加足够数量的救生艇。这意味着这艘船可以容纳更多的乘客，使他们能够在甲板上自由移动。</p><p id="c859" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">1912 年 4 月 14 日，泰坦尼克号与一座冰山相撞，灾难降临，造成船只大面积损坏。2 小时 40 分钟后，船沉入海底。由于船舶设计者计划不周，救生艇无法容纳船上所有的乘客。这造成了大量的生命损失。估计死亡人数约为 1517 名乘客。</p><p id="49e3" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">对于那些正在阅读这篇博客的人来说，你可能很难把我的博客的标题和我到目前为止所做的介绍联系起来。这是可以理解的，我简要介绍整个泰坦尼克号灾难的原因是因为我的第一个机器学习项目是基于完全相同的主题。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h1 id="a5ff" class="kw kx iq bd ky kz mx lb lc ld my lf lg jw mz jx li jz na ka lk kc nb kd lm ln bi translated"><strong class="ak">问题陈述</strong></h1><p id="5b94" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">Kaggle 上的泰坦尼克号挑战赛是一个开放的比赛，供初学者参加并熟悉 Kaggle 平台。此外，它还为人们开始机器学习之旅提供了一个起点。</p><p id="b4f5" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">问题陈述很简单。给定一个训练集和一个测试集，我必须开发一个机器学习算法来预测泰坦尼克号灾难中幸存的乘客和遇难的乘客。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h1 id="92cc" class="kw kx iq bd ky kz mx lb lc ld my lf lg jw mz jx li jz na ka lk kc nb kd lm ln bi translated"><strong class="ak">工作流程</strong></h1><p id="75ef" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">由于这是我第一次接触机器学习问题，我想在数据集上测试所有可能的算法。我最终引入了许多机器学习算法，从简单的如逻辑回归和 K 最近邻算法到复杂的如随机森林分类器和 AdaBoost 分类器。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/e310b501334cc73073bbabebb916126d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P7XSKdXPGCgoUVrftt58yg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><p id="5981" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">在导入库并将数据加载到 pandas 数据框中之后，我开始研究数据，寻找可能的异常值或缺失值，这可能是我们项目后期算法的关注点。</p><h2 id="6759" class="nd kx iq bd ky ne nf dn lc ng nh dp lg lx ni nj li mb nk nl lk mf nm nn lm no bi translated">数据探索</h2><p id="b626" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">作为数据探索的第一步，我使用了 describe 函数来获得训练数据集中的数字数据的概述。描述功能是一个有用的工具，因为它为用户提供了数据的统计概览。它给出了计数、平均值、标准偏差和所有的四分位值。训练数据集具有 891 名乘客的信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/7966bc07e32cb1a51d2dc400e04a8228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KyzUOYDDNDZE5deGb1er3g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><p id="4afd" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">在下一步中，我将利用条形图来探索分类变量。条形图是研究要素中存在的各种分类标签的计数的好方法。下图给出了目标标签的条形图，即存活或未存活，其中 1 表示存活，0 表示未存活。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/020fc0e0fb6910a90bf0975a8602881e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xqz7IRMZIy8Z6IQQO5qFJA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><p id="b199" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">柱状图也被用来比较事故中幸存的女性和男性的数量。正如柱状图非常清楚地描述的那样(通过下面提供的图片)，事故中幸存的女性人数多于男性。这种模式的例子可以在历史书上找到，其中指出，船长明确地发出命令，让妇女和儿童优先获救。因此，女性的存活率几乎是男性的三倍。</p><div class="kg kh ki kj gt ab cb"><figure class="nr kk ns nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/dfbad4be33777b81458b9539e9ddd4be.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*BO_dgnmRgIijz3peUzoo4w.jpeg"/></div></figure><figure class="nr kk nx nt nu nv nw paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/1df4c490fb9c17be13bb936b333affd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*CL_PbDVe0poCquv0NwdqXQ.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk ny di nz oa translated">描述幸存女性人数的柱状图(左)描述幸存男性人数的柱状图(右)。(图片由作者提供)</p></figure></div><p id="0076" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">在对训练集中的分类变量有了一个相当不错的想法后，我现在将注意力转移到我们的数据集中存在的缺失值(即训练数据和测试数据)。缺少值会导致算法行为不当和性能不佳，这就是为什么应该适当地处理它们。我使用 pandas isnull 和 sum 函数来获得缺失值的计数。在训练数据中,“年龄”、“客舱”和“登机”列中有缺失值，而在测试数据中,“票价”、“年龄”和“客舱”列中有缺失数据。</p><div class="kg kh ki kj gt ab cb"><figure class="nr kk ob nt nu nv nw paragraph-image"><img src="../Images/ee87a70096266b84cc80d9dec06c8c02.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*blg9q5AcpCqbbVTYhhRnVA.jpeg"/></figure><figure class="nr kk oc nt nu nv nw paragraph-image"><img src="../Images/aebef671bce7e568f764c80e02acce89.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*z01ikHl2H-o2V2sGi4V6mA.jpeg"/><p class="kr ks gj gh gi kt ku bd b be z dk od di oe oa translated">训练数据(左)和测试数据(右)中缺失值的摘要。(图片由作者提供)</p></figure></div><h2 id="8761" class="nd kx iq bd ky ne nf dn lc ng nh dp lg lx ni nj li mb nk nl lk mf nm nn lm no bi translated">数据工程(训练集)</h2><p id="67c0" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在数据探索步骤之后，我对手头的数据集有了一个相当好的想法，因此我决定对数据集进行必要的修改和更改，以适应我们的机器学习算法的需要。</p><p id="4394" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">步骤 1:删除丢失数据的行/列。</p><p id="20a1" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">“已装船”列有两个缺失值。由于缺失值的数量很少，我决定删除包含缺失值的行。删除它们不会导致算法信息的重大损失。另一方面，客舱列有相当数量的缺失值，这些缺失项占“客舱”列中所有数据的 77%。客舱列中缺少的值会阻碍模型达到最佳精度，因此，我决定删除“客舱”列。</p><p id="b44f" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">步骤 2:填充数据集中缺失的值。</p><p id="4b81" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">训练集中唯一缺少值的列是“年龄”列。为了填补缺失的值，我使用了箱线图。因为列“Pclass”没有缺失值，所以我将它映射到数据集中存在的年龄值。形成的箱线图给了我船上每个等级的乘客的平均“年龄”值。然后用这些平均值代替缺失值，这样我们就有了一个完整的“年龄”栏。下图中可以看到箱线图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/8d37a2b026988b3e6692565aa07f72ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iw0HjMlMlzXzqn4s7Vf-Nw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><p id="5f5a" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">步骤 3:分类变量的一次性编码。</p><p id="0cff" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">一种热编码是将分类变量转换成可解释形式的过程，该可解释形式可以提供给 ML 算法以在预测中做得更好。pandas get_dummies 函数有助于将分类变量转换成独热编码格式。对于这个项目，我将“Sex”列和“apollowed”列转换为 one-hot 编码的特性。下图显示了添加到数据框中的新列。“男性”和“女性”列是在对“性别”列应用一键编码后派生出来的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/6ae5863df8cf70438d764a803fffc792.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vgp338QruxWvCjRCbRiQSQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><p id="5e16" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">步骤 4:删除不需要的列</p><p id="9891" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">在执行了步骤 1、2 和 3 之后，我剩下了一些在项目的后续阶段中不需要的列。首先，我删除了“性别”和“上船”列，因为我有它们的热编码等价物；其次，我删除了“机票”和“姓名”列，因为它们无助于增加机器学习模型的预测能力。</p><h2 id="008f" class="nd kx iq bd ky ne nf dn lc ng nh dp lg lx ni nj li mb nk nl lk mf nm nn lm no bi translated">数据工程(测试集)</h2><p id="81dc" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">由于训练集和测试是两个不同的 CSV 文件，在完成训练集的数据工程任务后，我将注意力转向了测试集。我使用了前一节中描述的相同的四个步骤来清理测试集。</p><p id="a08b" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">总之，删除了“Cabin”列，删除了缺少“Fare”值的一行，并使用用于替换训练集中缺少的“Age”值的方法替换了缺少的“Age”值。最后，使用一次性编码转换分类变量，并从测试集中删除不需要的列。</p><h2 id="c0b7" class="nd kx iq bd ky ne nf dn lc ng nh dp lg lx ni nj li mb nk nl lk mf nm nn lm no bi translated">在训练数据上实现机器学习算法</h2><p id="e5ad" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">现在我有了一个干净的数据集，剩下的唯一部分就是将训练集和测试集分配给变量。下图也可以看出同样的情况。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/ccacace52bb2e65f92142e4527dee4a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mSTwvBuXQjY4-UN-VzHwjA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><p id="09a2" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">一旦执行了上述步骤，我就开始在训练数据集上实现机器学习算法。我在训练数据上实现的算法是:</p><ul class=""><li id="72d2" class="oi oj iq lq b lr ml lu mm lx ok mb ol mf om mj on oo op oq bi translated">逻辑回归</li><li id="8176" class="oi oj iq lq b lr or lu os lx ot mb ou mf ov mj on oo op oq bi translated">支持向量机(核:线性、RBF 和 Sigmoid)</li><li id="83bc" class="oi oj iq lq b lr or lu os lx ot mb ou mf ov mj on oo op oq bi translated">决策树</li><li id="011a" class="oi oj iq lq b lr or lu os lx ot mb ou mf ov mj on oo op oq bi translated">脊线分类器</li><li id="fe54" class="oi oj iq lq b lr or lu os lx ot mb ou mf ov mj on oo op oq bi translated">随机森林分类器</li><li id="c6a9" class="oi oj iq lq b lr or lu os lx ot mb ou mf ov mj on oo op oq bi translated">XG 增强分类器</li><li id="c20b" class="oi oj iq lq b lr or lu os lx ot mb ou mf ov mj on oo op oq bi translated">AdaBoost 分类器</li><li id="b9e1" class="oi oj iq lq b lr or lu os lx ot mb ou mf ov mj on oo op oq bi translated">k 近邻分类器</li></ul><p id="2a20" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">在对训练数据实施了上述算法之后，我计算了模型精度以及拟合模型的交叉验证分数。下表列出了每个模型的准确度分数和交叉验证分数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/f648ccd7213d303a2e2cc658967eac5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6nmUVt1lr0P6q3JdtEjhTA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)</p></figure><h2 id="6ded" class="nd kx iq bd ky ne nf dn lc ng nh dp lg lx ni nj li mb nk nl lk mf nm nn lm no bi translated">推理</h2><p id="56d4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">查看上表，SVM(内核:RBF)、决策树和 XG Boost 分类器具有显著的模型准确性，但交叉验证得分较低，这表明对训练数据过度拟合。相反，岭回归分类器具有较高的模型精度和交叉验证分数。因此，我得出结论，岭回归分类器是我的机器学习项目的最佳算法。</p><h2 id="d869" class="nd kx iq bd ky ne nf dn lc ng nh dp lg lx ni nj li mb nk nl lk mf nm nn lm no bi translated">关于 Kaggle 的呈件</h2><p id="e339" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我在测试集上使用了岭回归分类器，并生成了一个 CSV 文件提交到 Kaggle 上。提交文件由测试集中乘客的预测值组成。该模型达到了 76%的准确率。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h1 id="1a2e" class="kw kx iq bd ky kz mx lb lc ld my lf lg jw mz jx li jz na ka lk kc nb kd lm ln bi translated"><strong class="ak">结论</strong></h1><p id="7491" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我在机器学习项目上的第一次尝试是富有成效的。我遇到了各种用于清理数据和处理缺失值的方法，我能够在数据集上实现各种机器学习算法，并评估它们的准确性。</p><p id="36a4" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">在未来，我将更多地了解各种机器学习算法的复杂性及其工作原理。这将允许我了解情况，并相应地使用最能满足需要的算法。最后，我将致力于更多有趣的机器学习项目，并与世界上的机器学习爱好者分享。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="3148" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated"><em class="mk">我做泰坦尼克号项目遵循的流程可以在</em> <a class="ae kv" href="https://github.com/shaunak09vb/Titanic-Kaggle/blob/master/titanic.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="mk"> Github </em> </a> <em class="mk">上找到。我希望你喜欢看我的博客。</em></p></div></div>    
</body>
</html>