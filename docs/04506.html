<html>
<head>
<title>Batch Normalization In Neural Networks Explained (Algorithm Breakdown)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解释了神经网络中的批量标准化(算法分解)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/batch-normalization-explained-algorithm-breakdown-23d2794511c?source=collection_archive---------11-----------------------#2020-04-22">https://towardsdatascience.com/batch-normalization-explained-algorithm-breakdown-23d2794511c?source=collection_archive---------11-----------------------#2020-04-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fa6e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">理解深度神经网络中使用的一种常见转换技术</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/169cabf1457940dc5e94f7215f6bb2d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R6zVCkMQXz95evmMHTCOxg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">瓦迪姆·谢尔巴科夫在<a class="ae ky" href="https://unsplash.com/s/photos/breakdown?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="fdd2" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="aa13" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">批量归一化(BN) </strong>是很多机器学习从业者都会遇到的技术。如果你曾经使用过卷积神经网络，比如<a class="ae ky" href="https://arxiv.org/abs/1610.02357" rel="noopener ugc nofollow" target="_blank">exception</a>、<a class="ae ky" href="https://www.mathworks.com/help/deeplearning/ref/resnet50.html" rel="noopener ugc nofollow" target="_blank"> ResNet50 </a>和<a class="ae ky" href="https://uk.mathworks.com/help/deeplearning/ref/inceptionv3.html" rel="noopener ugc nofollow" target="_blank"> Inception V3 </a>，那么你就使用过批量归一化。</p><p id="0f9f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这篇文章解释了BN背后的基本直觉。对于那些已经熟悉BN技术的人来说，这篇文章深入研究了BN算法并解释了它的关键部分。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="26bf" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">定义</h1><p id="ab1c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">批量标准化是一种减轻深度神经网络中不稳定梯度影响的技术。BN为神经网络引入了一个附加层，该层对来自前一层的输入执行操作。</p><p id="896d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该操作对输入值进行标准化和规范化。然后，输入值通过缩放和移位操作进行转换。</p><p id="92bd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="ne">如果这令人困惑，下面的下一节将使该技术变得更加清晰。</em></p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="1360" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">说明</h1><p id="a4ce" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Christian Szegedy和Sergey Ioffe于2015年在这篇已发表的<a class="ae ky" href="https://arxiv.org/abs/1502.03167" rel="noopener ugc nofollow" target="_blank">论文</a>中提出了批量标准化技术。</p><p id="ff4a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">通过在神经网络层内引入输入值的内部标准化，执行批量标准化作为<strong class="lt iu">加速深度神经网络</strong>训练阶段的解决方案。</p><p id="d232" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">术语“批处理规范化”中使用“<em class="ne">批处理</em>”的原因是因为神经网络通常一次用一组经过整理的数据进行训练，这组或一组数据被称为批处理。BN技术中的运算发生在整批输入值上，而不是单个输入值上。</p><p id="c7e8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">通常，在机器学习中，在将数据传递到输入层之前，通常会对输入数据进行规范化。我们规范化的部分原因是为了确保我们的模型能够适当地一般化。这是通过确保值的比例是平衡的来实现的，并且尽管值的比例变化，值的范围也是保持和成比例的。</p><p id="df23" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">通常对输入数据进行规范化，但是网络中的内部数据流应该保持规范化。</p><p id="7ad0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">BN是在神经网络层之间传递的输入值内标准化的内部实施者。内部标准化限制了通常发生在层内激活的协变量偏移。</p><p id="867c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如前所述，BN技术的工作原理是对进入BN层的输入数据执行一系列操作。下面是一个小批量BN算法的数学符号片段。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/6a4aa5191533d58d7709ab8aceddd582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*jTPViestByum2ZZ3jXcmfw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">官方研究<a class="ae ky" href="https://arxiv.org/pdf/1502.03167.pdf" rel="noopener ugc nofollow" target="_blank">论文</a>中提出的批量归一化操作</p></figure><p id="b14f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">上图中的数学符号可能看起来有点吓人，但是有一些主要的要点。</p><ol class=""><li id="3253" class="ng nh it lt b lu mn lx mo ma ni me nj mi nk mm nl nm nn no bi translated"><strong class="lt iu">输入数据的标准化</strong></li><li id="7851" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nl nm nn no bi translated">输入数据的<strong class="lt iu">归一化</strong>和<strong class="lt iu">重新缩放</strong></li><li id="4cf7" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm nl nm nn no bi translated"><strong class="lt iu">偏置<strong class="lt iu">的</strong>输入数据</strong></li></ol><p id="09ec" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">标准化是将一批输入数据转换为平均值为零、标准差为一的操作。在BN算法中，我们需要计算最小批量的平均值，然后计算方差。方差提供了关于标准偏差的信息；我们只需要求方差的平方根。</p><p id="4107" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们分解算法的数学符号，解释这个过程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/4bea2bcc10c966e48278a41bbe6c3649.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*fNjHv2lrHY2xBihzcaKlhw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">计算当前小批量的平均值</p></figure><p id="3184" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">第一个操作计算小批量内输入的平均值。运算的结果是一个包含每个输入平均值的向量。</p><p id="505c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="ne"> m </em>指小批量的投入数量。</p><p id="19c8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="ne"> </em>谓卑鄙。</p><p id="3397" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="ne"> B </em>是指当前批次的下标。</p><p id="bbde" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="ne"> xi </em>是输入数据的一个实例。</p><p id="1aef" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一批(<em class="ne">‘B’</em>)的平均值(<em class="ne">’</em>)是通过该批的几个输入实例的总和除以输入总数(<em class="ne">‘m’</em>)来计算的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/85847c335d57a087f70a52c66d022047.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*N5H3Sz-UjfQKxCS6O313gw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">计算当前小批量的差异</p></figure><p id="2809" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在上面的操作中，输入方差(<em class="ne"> σ </em>)通过平方输入的标准偏差来计算。为了计算标准偏差，我们取当前小批量中的每个输入实例(<em class="ne"> Xi </em>)，减去在先前操作中计算的小批量的平均值(<em class="ne"> B </em>),并对结果求平方。</p><p id="ec32" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这个值然后被平方以获得方差(<em class="ne"> σ </em>)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/af5b32913c5c26fa73719afc3fb3a12c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*u4eXOBCrgFl3wDDRC-4pAQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">标准化输入</p></figure><p id="d376" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们有了<strong class="lt iu">零定心和标准化输入</strong>所需的所有值。在上面的操作中，我们对输入数据进行了标准化处理。术语标准化和规范化可以互换使用。这两个术语之间有细微的差别。</p><p id="70b7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在上面的操作中，从每个输入时刻减去批次的平均值。然后我们将结果除以当前批次的标准偏差值与平滑项(<em class="ne"> ε </em>)相加的平方根值。</p><p id="b845" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">平滑项(<em class="ne"> ε </em>)通过停止除以零值来确保运算中的数值稳定性。平滑项通常为0.00005。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/f423bbf8027837af75e1835ca1142441.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*WpU73u_EDijf3y2sOETUWQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">缩放和偏移输入</p></figure><p id="c9ac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在最后一个操作中，输入值的<strong class="lt iu">重新缩放和偏移</strong>发生。该操作的输出是BN算法对当前小批量的结果。</p><p id="35a6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在最后的操作中，我们介绍了BN算法的两个新组件。这些分量是参数向量，用于包含来自先前操作的值的向量的缩放(<em class="ne"> γ </em>)和移位(<em class="ne"> β </em>)。用于缩放和移位的参数向量的值是可学习的参数。在神经网络训练期间，BN确保可学习的参数是能够使每个小批量精确标准化的最佳值。</p><p id="bda7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">BN变换是提高深度神经网络性能的有效方法。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="ad58" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">批量标准化的好处</h1><ul class=""><li id="5ae5" class="ng nh it lt b lu lv lx ly ma nx me ny mi nz mm oa nm nn no bi translated">在深度神经网络中包括批量标准化技术改进了训练时间</li><li id="7699" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm oa nm nn no bi translated">BN能够利用更大的学习速率，这在训练神经网络时缩短了收敛时间</li><li id="bb13" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm oa nm nn no bi translated">减少渐变消失的常见问题</li><li id="384e" class="ng nh it lt b lu np lx nq ma nr me ns mi nt mm oa nm nn no bi translated">减少了神经网络内的协变量移位</li></ul></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="4847" class="kz la it bd lb lc mz le lf lg na li lj jz nb ka ll kc nc kd ln kf nd kg lp lq bi translated">结论</h1><p id="dde8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">BN背后的算法并没有看起来那么复杂。</p><p id="94e3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">通过引入现代机器学习库，如<a class="ae ky" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>和<a class="ae ky" href="https://pytorch.org/" rel="noopener ugc nofollow" target="_blank"> PyTorch </a>，抽象出在神经网络内实现BN的复杂性。这使得在神经网络中实现BN成为一项微不足道的任务。</p><p id="78ac" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">理解批处理规范化算法如何操作仍然是一项有价值的技能。</p></div></div>    
</body>
</html>