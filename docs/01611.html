<html>
<head>
<title>One Year of Lottery Ticket Research (a light overview)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一年的彩票研究(浅述)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/one-year-of-lottery-ticket-research-a-light-overview-b4d53d430887?source=collection_archive---------32-----------------------#2020-02-13">https://towardsdatascience.com/one-year-of-lottery-ticket-research-a-light-overview-b4d53d430887?source=collection_archive---------32-----------------------#2020-02-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e4c7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">获奖门票于2018年3月被发现，并于同年在ICRL颁奖。它引起了很多关注。它揭示了神经网络未知的潜在属性，似乎是更快训练和更小模型的关键之一。我们如何处理神经网络体系结构设计的总体思路？</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/00fd4e2f695db4ef29716505563af138.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kRjwszkptnJLczo7Ne7K3g.jpeg"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">没错，这就是莱克斯·弗里德曼(Lex Fridman)，他与彩票的研究无关(除了在他的牛逼讲座系列中提到它是2020年深度学习的主要研究领域之一)。但是他比任何股票图片更能引起标题中的任何关键词(<a class="ae ki" href="https://www.youtube.com/watch?v=0VH1Lim8gL8&amp;feature=youtu.be&amp;t=2761" rel="noopener ugc nofollow" target="_blank">来源</a>)。</p></figure><p id="428b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Lex Fridman在他的<a class="ae ki" href="https://youtu.be/0VH1Lim8gL8?t=2761" rel="noopener ugc nofollow" target="_blank">深度学习艺术状态2020 </a>讲座中提到，深度学习的获奖门票是2019年最重要的话题之一。这篇文章旨在总结我阅读后的理解。希望你会喜欢它。</p><h1 id="dba6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">修剪</h1><p id="92f7" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">众所周知，DL模型通常具有繁重的计算要求，并且在特定设置中可能会阻塞。例如，ResNet一次推理需要5000万次运算。他们一直在努力用<a class="ae ki" href="https://pytorch.org/docs/stable/quantization.html" rel="noopener ugc nofollow" target="_blank">量化</a>、<a class="ae ki" rel="noopener" target="_blank" href="/what-is-knowledge-distillation-41bb77a3c6d8">知识提炼</a>和<a class="ae ki" href="https://github.com/he-y/Awesome-Pruning" rel="noopener ugc nofollow" target="_blank">修剪</a>来减少参数的数量。</p><p id="f4c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">修剪移除最不重要的<em class="ms">权重或通道。最不重要可以意味着具有最小量级或其他启发的一个。这种技术运行良好，可以减少网络中高达90%的权重，同时保持大部分原始精度。虽然修剪可以帮助减少模型的大小，但它无助于更快地训练它。一般是后处理步骤，训练之后。重新训练一个修剪过的模型不会产生和训练后修剪一样的结果。如果有可能直接训练修剪过的模型，在不牺牲性能的情况下训练得更快。</em></p><p id="c68e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是在他们的论文<a class="ae ki" href="https://arxiv.org/search/cs?searchtype=author&amp;query=Frankle%2C+J" rel="noopener ugc nofollow" target="_blank">中，Jonathan Frankle </a>，<a class="ae ki" href="https://arxiv.org/search/cs?searchtype=author&amp;query=Carbin%2C+M" rel="noopener ugc nofollow" target="_blank"> Michael Carbin </a>通过实验发现，我们可以先训练较小的网络，而不是训练大型网络，然后缩小它们的规模:</p><blockquote class="mt mu mv"><p id="ea78" class="kz la ms lb b lc ld ju le lf lg jx lh mw lj lk ll mx ln lo lp my lr ls lt lu im bi translated"><em class="it">密集的、随机初始化的前馈网络包含子网(“优胜门票”)，当被隔离训练时，在相似的迭代次数下，达到与原始网络相当的测试精度。</em></p></blockquote><h1 id="2428" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">中奖彩票</h1><p id="13af" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了找到中奖的门票，初始化似乎是关键:</p><blockquote class="mt mu mv"><p id="6527" class="kz la ms lb b lc ld ju le lf lg jx lh mw lj lk ll mx ln lo lp my lr ls lt lu im bi translated"><em class="it">当它们的参数被随机重新初始化[…]时，我们的中奖彩票不再与原始网络的性能相匹配，这证明这些较小的网络不能有效地训练，除非它们被适当地初始化。</em></p></blockquote><p id="623b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他们发现，在用原始模型的参数重新初始化权重后，我们可以再次训练一个修剪过的模型。这给出了比随机重新初始化更好的系统结果。多次执行此过程称为迭代修剪(无需重新初始化):</p><pre class="kk kl km kn gt mz na nb nc aw nd bi"><span id="b5ce" class="ne lw it na b gy nf ng l nh ni">1. Randomly initialize a neural network [with weights θ0] <br/>2. Train the network for j iterations, arriving at parameters θj <br/>3. Prune [by magnitude] p% of the parameters in θj , creating a mask m <br/>4. Reset the remaining parameters to their values in θ0 <br/>5. Goto 2</span></pre><p id="ba43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果由这种技术产生的子网与原始网络的性能相匹配，它就被称为一张中奖票。下图显示了MNIST数据集上LeNet(全密度)网络上五次运行的平均结果。这种模式以不同的方式进行了删减:</p><ul class=""><li id="45d5" class="nj nk it lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated">[蓝色]完成上面的食谱</li><li id="7196" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">[橙色]与蓝色相同，但将步骤4替换为“随机初始化其余参数”</li><li id="8dfb" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">[红色]与没有步骤5的橙色线相同</li><li id="3c0a" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">[绿色]与蓝色相同，但没有步骤5</li></ul><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nx"><img src="../Images/6e77b69656c64bb81079a7b88d92c7f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Cmvt9tWd7EAplFXP.png"/></div></div></figure><p id="c2ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，步骤4是关键，因为绿线和蓝线始终表现更好，并且比随机重新初始化的网络训练得更快。他们还在MNIST和CIFAR10上发现了类似于VGG和ResNet这样的卷积网络的结果(在<a class="ae ki" href="https://arxiv.org/abs/1803.03635" rel="noopener ugc nofollow" target="_blank">原始论文</a>中有<em class="ms">许多</em>更多细节)。</p><h1 id="4601" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">提早修剪</h1><p id="2b0f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">但是上面的方法似乎很难对付更深层次的网络。在<a class="ae ki" href="https://arxiv.org/abs/1903.01611" rel="noopener ugc nofollow" target="_blank">后续论文</a>(2019年3月)中，作者稍微改变了其余参数的重置方式(步骤4):</p><blockquote class="mt mu mv"><p id="5a96" class="kz la ms lb b lc ld ju le lf lg jx lh mw lj lk ll mx ln lo lp my lr ls lt lu im bi translated"><em class="it">我们将中奖彩票的权重设置为少量训练迭代后获得的权重，而不是将其设置为初始初始化值(</em>后期重置<em class="it">)。使用后期重置，我们在Imagenet上确定了Resnet-50的第一张中奖彩票。</em></p></blockquote><p id="29c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下图描绘了深度模型的不同稀疏度水平下的性能，使用不同的值进行重绕(重绕权重的迭代)。我们可以看到，在迭代0时重绕并不比原始网络执行得更好，而在更高迭代时重绕则可以:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ny"><img src="../Images/3c2cf0d60d5a44ff57ce1069640465f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6wxXdYgm9OqQMHZT.png"/></div></div></figure><p id="1039" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那些更深入的模型正在抵制上面的获胜秘诀，但是在查看了它们的稳定性之后发现了一些有趣的事情:</p><ul class=""><li id="4490" class="nj nk it lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated"><em class="ms">修剪的稳定性</em>:“单独训练的子网络的权重和在更大的网络中训练的相同子网络的权重之间的距离”。它捕捉到了“一个子网在孤立状态下训练并仍能到达与更大网络相同的目的地的能力”。如果一个神经元是稳定的，它就不会受到它的邻居通过掩蔽消失的太大影响。</li><li id="6096" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated"><em class="ms">对数据顺序的稳定性</em>:“用不同数据顺序训练的子网的两个副本的权重之间的距离”。它捕捉到了“尽管SGD存在梯度噪声，子网仍能一致到达同一目的地的内在能力”。</li></ul><p id="c00b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下表显示了不同网络的稳定性。<em class="ms">预热</em>意味着学习率在训练过程中计划缓慢增加，可能会降低优化器的噪音。<em class="ms"> IMP </em>是生成中奖票的原始配方:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ny"><img src="../Images/978a47555e917704e9876c6b170591db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2Iwp4RtGv22e5HoA.png"/></div></div></figure><p id="f28a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，在不改变学习率的情况下，IMP无法在更深的网络中找到获胜的门票。我们还可以看到，性能和稳定性指标之间存在联系。“中奖票比随机子网更稳定”。</p><h1 id="1992" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">其他领域呢？</h1><p id="6c3b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">到目前为止，中奖彩票已经在相同的数据集和计算机视觉任务上进行了测试。有人可能会问，这是否仅仅是严重的过度匹配，或者中奖彩票是否会发生转移。</p><p id="d946" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">脸书<a class="ae ki" href="https://arxiv.org/abs/1906.02773" rel="noopener ugc nofollow" target="_blank">发表了一篇论文</a>(2019年6月)，在六个视觉数据集上测试了获奖门票的评估和转移。例如，在ImageNet上测试生成中奖票，并在其他地方进行测试(如CIFAR-100):</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/4775d0c02575951578e09f69dcd81df6.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/0*Jgf5nYmgzVZhp9wl.png"/></div></figure><p id="c91b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">他们观察到，中奖彩票在所有数据集上的表现都(至少)接近原始彩票。而且，在较大数据集上生成的中奖彩票比其他彩票更通用，这可能是由于原始模型中的类别数量。最后，本文还成功测试了跨不同优化器的迁移。</p><p id="0f9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图像分类以外的其他任务呢？脸书<a class="ae ki" href="https://arxiv.org/abs/1906.02768" rel="noopener ugc nofollow" target="_blank">同时发表了一篇论文</a>(2019年6月)，该论文测试了强化学习和NLP任务中的优胜券。</p><blockquote class="mt mu mv"><p id="dea4" class="kz la ms lb b lc ld ju le lf lg jx lh mw lj lk ll mx ln lo lp my lr ls lt lu im bi translated"><em class="it">对于NLP，我们发现，对于在语言建模上训练的递归LSTM模型和在机器翻译上训练的Transformer模型，获胜的票证初始化都优于随机票证。[……]对于RL，我们发现，在经典控制问题上，以及对于许多(但不是全部)Atari游戏，赢票初始化大大优于随机票。</em></p></blockquote></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><h1 id="9984" class="lv lw it bd lx ly oh ma mb mc oi me mf jz oj ka mh kc ok kd mj kf ol kg ml mm bi translated">TLDR</h1><ul class=""><li id="8839" class="nj nk it lb b lc mn lf mo li om lm on lq oo lu no np nq nr bi translated">许多神经网络是过度参数化的</li><li id="f8cc" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">弗兰克尔&amp;卡宾发现了一种简单的算法，可以在较大的网络中找到较小的网络</li><li id="6c45" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">这些子网络是可以从头开始训练的，至少可以表现得一样好，甚至更好</li><li id="7d30" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">是什么让中奖彩票如此特别还不清楚，但这似乎是深入理解神经网络潜在属性的关键一步</li></ul><h1 id="7fef" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">来源</h1><ul class=""><li id="1272" class="nj nk it lb b lc mn lf mo li om lm on lq oo lu no np nq nr bi translated"><a class="ae ki" href="https://arxiv.org/abs/1803.03635" rel="noopener ugc nofollow" target="_blank">彩票假说:寻找稀疏、可训练的神经网络</a></li><li id="a6e2" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated"><a class="ae ki" href="https://arxiv.org/abs/1903.01611" rel="noopener ugc nofollow" target="_blank">稳定彩票假说</a></li><li id="3a72" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated"><a class="ae ki" href="https://arxiv.org/abs/1906.02773" rel="noopener ugc nofollow" target="_blank">一票赢天下:跨数据集和优化器推广彩票初始化</a></li><li id="3e0e" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated"><a class="ae ki" href="https://arxiv.org/abs/1906.02768" rel="noopener ugc nofollow" target="_blank">用奖励和多种语言玩彩票:RL和NLP的彩票</a></li></ul></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><p id="2323" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ms">最初发表于</em><a class="ae ki" href="https://data-soup.github.io/blog/" rel="noopener ugc nofollow" target="_blank">data-soup.github.io/blog/</a></p></div></div>    
</body>
</html>