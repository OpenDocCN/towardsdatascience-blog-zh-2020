<html>
<head>
<title>How to Master Python Command Line Arguments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何掌握 Python 命令行参数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-master-python-command-line-arguments-5d5ad4bcf985?source=collection_archive---------11-----------------------#2020-04-19">https://towardsdatascience.com/how-to-master-python-command-line-arguments-5d5ad4bcf985?source=collection_archive---------11-----------------------#2020-04-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="84db" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用命令行参数创建自己的 Python 脚本的简单指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b250854533c4c24de6e8cdc096d4b187.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g0zrxp7eR1s8nLEFBoWk_A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@emilep?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">émile Perron</a>在<a class="ae ky" href="https://unsplash.com/s/photos/python-programming?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="8ae0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我相信我们大多数人都运行过这个命令行来执行您的 python 脚本。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d2cb" class="ma mb it lw b gy mc md l me mf">$ python main.py</span></pre><p id="75f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们能不能在这个脚本中定义我们自己的论点？答案肯定是肯定的！</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="2e0f" class="ma mb it lw b gy mc md l me mf">$ python main.py arg1 arg2</span></pre><p id="8403" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用 Python<a class="ae ky" href="https://docs.python.org/3.3/library/argparse.html" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">arg parse</strong></a>模块来配置命令行参数和选项。argparse 模块使得编写用户友好的<a class="ae ky" href="https://en.wikipedia.org/wiki/Command-line_interface" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">命令行界面</strong> </a>变得容易。该程序定义了它需要什么参数，并且<a class="ae ky" href="https://docs.python.org/3.3/library/argparse.html#module-argparse" rel="noopener ugc nofollow" target="_blank"> argparse </a>将计算出如何解析来自<a class="ae ky" href="https://docs.python.org/3.3/library/sys.html#sys.argv" rel="noopener ugc nofollow" target="_blank"> sys.argv </a>的参数。当用户给程序无效的参数时，<a class="ae ky" href="https://docs.python.org/3.3/library/argparse.html#module-argparse" rel="noopener ugc nofollow" target="_blank"> argparse </a>模块也会自动生成帮助和用法消息，并发出错误。</p><h1 id="97aa" class="mg mb it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">Argparse 入门</h1><h2 id="1800" class="ma mb it bd mh mx my dn ml mz na dp mp li nb nc mr lm nd ne mt lq nf ng mv nh bi translated">正在安装 Argparse</h2><p id="861a" class="pw-post-body-paragraph kz la it lb b lc ni ju le lf nj jx lh li nk lk ll lm nl lo lp lq nm ls lt lu im bi translated">像往常一样，我们需要做的第一件事是安装这个 Python 模块。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="85e0" class="ma mb it lw b gy mc md l me mf">conda install argparse</span></pre><h2 id="9f47" class="ma mb it bd mh mx my dn ml mz na dp mp li nb nc mr lm nd ne mt lq nf ng mv nh bi translated">定义位置参数和可选参数</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="8f65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用这个脚本的描述用<code class="fe np nq nr lw b">ArgumentParser</code>创建一个<code class="fe np nq nr lw b">parser</code>对象。<code class="fe np nq nr lw b">Positional Arguments</code>和<code class="fe np nq nr lw b">Optional Arguments</code>用<code class="fe np nq nr lw b">add_argument</code>函数定义。用<code class="fe np nq nr lw b">help</code>添加了对该参数所做工作的简要描述。</p><blockquote class="ns nt nu"><p id="3a0b" class="kz la nv lb b lc ld ju le lf lg jx lh nw lj lk ll nx ln lo lp ny lr ls lt lu im bi translated"><strong class="lb iu">位置自变量</strong>是需要包含在适当的<strong class="lb iu">位置</strong>或顺序中的<strong class="lb iu">自变量</strong>。<br/> <strong class="lb iu">可选参数</strong>是用关键字和等号输入的<strong class="lb iu">关键字</strong> <strong class="lb iu">参数</strong>，可选。</p></blockquote><ul class=""><li id="5db4" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated">让我们尝试使用 help 参数<code class="fe np nq nr lw b">-h</code>运行这个脚本。</li></ul><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="8e89" class="ma mb it lw b gy mc md l me mf">$ python employee.py -h               <br/>usage: employee.py [-h] [--address ADDRESS] name title</span><span id="4a8c" class="ma mb it lw b gy oi md l me mf">This script is going to create an employee profile.</span><span id="c624" class="ma mb it lw b gy oi md l me mf">positional arguments:<br/>  name               Name of Employee<br/>  title              Job Title of Employee</span><span id="9885" class="ma mb it lw b gy oi md l me mf">optional arguments:<br/>  -h, --help         show this help message and exit<br/>  --address ADDRESS  Address of Employee</span></pre><p id="a294" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe np nq nr lw b">-h</code>和<code class="fe np nq nr lw b">--help</code>在<code class="fe np nq nr lw b">argparse</code>中默认定义。它将显示我们在脚本中定义的描述，以帮助用户使用脚本。</p><ul class=""><li id="237a" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated">我们试着输入<code class="fe np nq nr lw b">name</code>和<code class="fe np nq nr lw b">title</code>。</li></ul><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7366" class="ma mb it lw b gy mc md l me mf">$ python employee.py Alex Manager<br/>Name : Alex<br/>Job Title : Manager<br/>Address : None</span></pre><p id="2cc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于缺少地址参数，在这个脚本中，<code class="fe np nq nr lw b">NoneType</code>被传递给<code class="fe np nq nr lw b">Address</code>。为了打印它，我们必须把它转换成字符串。</p><ul class=""><li id="d15e" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated">让我们只用<code class="fe np nq nr lw b">name</code>试试</li></ul><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="054b" class="ma mb it lw b gy mc md l me mf">$ python employee.py Alex                                    <br/>usage: employee.py [-h] [--address ADDRESS] name title<br/>employee.py: error: the following arguments are required: title</span></pre><p id="fe1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为 title 也是<code class="fe np nq nr lw b">Positional Argument</code>，所以在这个脚本中是需要的。</p><ul class=""><li id="8e45" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated">这次我们用<code class="fe np nq nr lw b">name</code>、<code class="fe np nq nr lw b">title</code>和<code class="fe np nq nr lw b">address</code>试试。</li></ul><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="857f" class="ma mb it lw b gy mc md l me mf">$ python employee.py Alex Manager --address 123 Baker Street<br/>usage: employee.py [-h] [--address ADDRESS] name title<br/>employee.py: error: unrecognized arguments: Baker Street</span></pre><p id="a6c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为<code class="fe np nq nr lw b">123 Baker Street</code>包含空格，所以脚本会将<code class="fe np nq nr lw b">Baker Street</code>视为其他参数。在这种情况下，我们需要双引号。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4af0" class="ma mb it lw b gy mc md l me mf">$ python employee.py Alex Manager --address "123 Baker Street"<br/>Name : Alex<br/>Job Title : Manager<br/>Address : 123 Baker Street</span></pre><blockquote class="ns nt nu"><p id="2a21" class="kz la nv lb b lc ld ju le lf lg jx lh nw lj lk ll nx ln lo lp ny lr ls lt lu im bi translated"><code class="fe np nq nr lw b">name</code>和<code class="fe np nq nr lw b">title</code>如果名称或标题不止一个单词，则需要双引号。</p></blockquote><h2 id="11d2" class="ma mb it bd mh mx my dn ml mz na dp mp li nb nc mr lm nd ne mt lq nf ng mv nh bi translated">定义布尔参数</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="e246" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将上述代码添加到现有的脚本中。我们将使用<code class="fe np nq nr lw b">default=True</code>定义一个可选参数。意思是即使我们从来没有在这个参数中输入任何东西，默认情况下也等于<code class="fe np nq nr lw b">True</code>。</p><p id="4db6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里使用<code class="fe np nq nr lw b">type=strtobool</code>来确保输入被转换成<strong class="lb iu">布尔</strong>数据类型。否则，当脚本在输入中传递时，它将是<strong class="lb iu">字符串</strong>数据类型。如果我们需要一个整数参数，我们也可以将其定义为<code class="fe np nq nr lw b">type=int</code>。</p><p id="8dfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe np nq nr lw b">%(default)s)</code>在帮助中是检索参数中的默认值。这是为了确保描述不是硬编码的，并且随着缺省值的变化是灵活的。</p><ul class=""><li id="1f0d" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated">让我们用<code class="fe np nq nr lw b">name</code>、<code class="fe np nq nr lw b">title</code>和<code class="fe np nq nr lw b">address</code>再试一次</li></ul><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f09b" class="ma mb it lw b gy mc md l me mf">$ python employee.py Alex Manager --address "123 Baker Street"                   <br/>Name : Alex<br/>Job Title : Manager<br/>Address : 123 Baker Street<br/>Alex is a full time employee.</span></pre><p id="4fcf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，<code class="fe np nq nr lw b">isFullTime</code>是<code class="fe np nq nr lw b">True</code>，所以如果我们不向<code class="fe np nq nr lw b">isFullTime</code>输入任何参数，Alex 就是全职员工。</p><ul class=""><li id="3c93" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated">让我们用一个<code class="fe np nq nr lw b">False</code>输入试试。</li></ul><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="feef" class="ma mb it lw b gy mc md l me mf">$ python employee.py Alex Manager --address "123 Baker Street" --isFullTime False<br/>Name : Alex<br/>Job Title : Manager<br/>Address : 123 Baker Street<br/>Alex is not a full time employee.</span></pre><p id="bec9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">行动。亚历克斯现在不是全职员工。</p><h2 id="d6aa" class="ma mb it bd mh mx my dn ml mz na dp mp li nb nc mr lm nd ne mt lq nf ng mv nh bi translated">定义参数中的选择</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="e829" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以用<code class="fe np nq nr lw b">choices</code>参数限制输入参数的可能值。这有助于防止用户输入无效值。例如，我们可以使用这个<code class="fe np nq nr lw b">choices=[“Singapore”, “United States”, “Malaysia”]</code>将国家值限制为新加坡、美国和马来西亚。</p><ul class=""><li id="87ed" class="nz oa it lb b lc ld lf lg li ob lm oc lq od lu oe of og oh bi translated">让我们看看如果我们不在选项中输入国家值会发生什么。</li></ul><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="8f13" class="ma mb it lw b gy mc md l me mf">$ python employee.py Alex Manager --country Japan    <br/>usage: employee.py [-h] [--address ADDRESS]<br/>                   [--country {Singapore,United States,Malaysia}]<br/>                   [--isFullTime ISFULLTIME]<br/>                   name title<br/>employee.py: error: argument --country: invalid choice: 'Japan' (choose from 'Singapore', 'United States', 'Malaysia')</span></pre><p id="22fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将遇到一个无效选择的错误。这些选择在<code class="fe np nq nr lw b">--help</code>总是可用的。</p><p id="d49d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在你已经学会了如何创建带有自定义参数的<strong class="lb iu"> Python 命令行</strong>。希望这篇文章对你有用。如果我犯了任何错误或错别字，请给我留言。</p><p id="aaf7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以在我的<a class="ae ky" href="https://github.com/chingjunetao/medium-article/blob/master/python-command-line/employee.py" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Github </strong> </a>中查看完整的脚本。干杯！</p></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><p id="3991" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">如果你喜欢读这篇文章，你可能也会喜欢这些:</strong></p><div class="oq or gp gr os ot"><a rel="noopener follow" target="_blank" href="/manage-your-python-virtual-environment-with-conda-a0d2934d5195"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">使用 Conda 管理您的 Python 虚拟环境</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">轻松在 Python 2 和 Python 3 环境之间切换</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pd l pe pf pg pc ph ks ot"/></div></div></a></div><div class="oq or gp gr os ot"><a rel="noopener follow" target="_blank" href="/access-google-search-console-data-on-your-site-by-using-python-3c8c8079d6f8"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">使用 Python 访问您站点上的 Google 搜索控制台数据</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">谷歌搜索控制台(以前的谷歌网站管理员工具)是由谷歌提供的网络服务，帮助您监控和…</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">towardsdatascience.com</p></div></div><div class="pc l"><div class="pi l pe pf pg pc ph ks ot"/></div></div></a></div><p id="c3c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">你可以在 Medium 上找到我其他作品的链接，关注我</strong> <a class="ae ky" href="https://medium.com/@chingjunetao" rel="noopener"> <strong class="lb iu">这里</strong> </a> <strong class="lb iu">。感谢阅读！</strong></p></div></div>    
</body>
</html>