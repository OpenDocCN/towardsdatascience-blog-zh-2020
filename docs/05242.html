<html>
<head>
<title>Big Data Analyses with Machine Learning and PySpark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习和PySpark进行大数据分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/big-data-analyses-with-machine-learning-and-pyspark-135119ef6b31?source=collection_archive---------38-----------------------#2020-05-04">https://towardsdatascience.com/big-data-analyses-with-machine-learning-and-pyspark-135119ef6b31?source=collection_archive---------38-----------------------#2020-05-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="eef9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">大数据是一个描述大量数据的术语，包括结构化和非结构化数据。</h2></div><p id="4e00" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">简介</strong></p><p id="f02f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们使用机器学习和PySpark深入大数据分析之前，我们需要定义机器学习和PySpark。</p><p id="730a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">先说机器学习。当你在谷歌搜索栏上输入机器学习，你会发现下面的定义:<strong class="kk iu">机器学习是一种数据分析的方法，可以自动建立分析模型。</strong>如果我们更深入地研究机器学习和在线可用的定义，我们可以进一步说，ML实际上是以数据为基础的人工智能的一个分支，即所有决策过程、识别模式等。，都是由最少的人接触。由于ML允许计算机在没有显式编程的情况下找到隐藏的见解，因此它被广泛应用于所有领域来完成这一任务——在数据中找到隐藏的信息。</p><p id="dd10" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">机器学习和当初一样，什么都不是。它经历了许多发展，正日益变得更受欢迎。它的生命周期分为两个阶段:培训和测试。</p><p id="3fcc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来是PySpark MLlib，它实际上是一个机器学习库，可扩展并在分布式系统上工作。在PySpark MLlib中，我们可以找到多种机器学习算法(线性回归、分类、聚类等等)的实现。MLlib自带数据结构——包括密集向量、稀疏向量、局部和分布式向量。库API非常用户友好和高效。</p><p id="e682" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">问题</strong></p><p id="f1a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们工作的每个行业中，都有很多很多挑战可以通过使用这些技术来解决。在这个特殊的案例中，我们需要在一个金融机构中进行多种统计计算。一个例子是根据独立变量的数量(例如年龄、余额、持续时间、银行活动)。</p><p id="13a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如何利用机器学习解决这个问题，最后的结果会是什么？为了展示该解决方案，我们将使用在此<a class="ae le" href="https://www.kaggle.com/rouseguy/bankbalanced/data" rel="noopener ugc nofollow" target="_blank">链接</a>上公开的大数据示例。</p><p id="f8a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">解决方案</strong></p><p id="81ee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">逻辑回归是解决方法。这是一种预测分类反应的流行方法，是预测结果概率的广义线性模型的特例。</p><p id="1c82" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在开始编码之前，我们需要初始化Spark会话并定义文件的结构。之后，我们可以使用Spark从csv文件中读取数据。我们有一个很大的数据集，但是在这个例子中，我们将使用大约11，000条记录的数据集。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/d52510c4bdad831fc313fc3a476260be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Shy5a8ffbZRHABgA.png"/></div></div></figure><p id="7743" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">看下面的表格，我们可以看到只有一列(前一列)的最小值等于零(0 ),这个值对于这个例子是不切实际的。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lr"><img src="../Images/f599962ea00abca792332d0120767fab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1diRhz7Zduc6AlBS.png"/></div></div></figure><p id="f7dc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们将所有的零替换为Nan。此外，存款字段被定义为一个值为“是”和“否”的字符串，因此我们必须对该字段进行索引。使用字符串索引器，我们将把值从“是”/“否”更改为1/0。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ls"><img src="../Images/3492a6e255f817eca53f17faf4a7cc28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*O9mULv3lKAmMbjH7.png"/></div></div></figure><p id="8232" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们可以通过调用一个估算器来简单地估算前一列中的Nan。估算器使用缺失值所在列的平均值或中值来填补数据集中的缺失值。输入列应该是Double或Float类型。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lt"><img src="../Images/4f03fed294624d771100967ab941d638.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/0*hYI_komA3iJZEWac.png"/></div></div></figure><p id="0df0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还想使用分类字段，所以我们必须将这些字段映射到一列二进制向量，通常只有一个值。然后，我们可以找到变量之间的相关性，并选择我们应该使用哪个变量。因为分类字段是字符串类型，所以我们将使用字符串索引器将一列标签字符串编码为一列标签索引。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lu"><img src="../Images/90e33db6320b25f13bf370cb38f0e5a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*45YBb3VYPMQrAxiG.png"/></div></div></figure><p id="fdd9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们将确定数字特征是否相关(包括索引分类字段)。在下图中，我们可以看到没有高度相关的数值变量。因此，我们将为模型保留所有这些。<strong class="kk iu">注意</strong> : pandas库仅用于绘图——我们无法使用pandas读取大数据文件，但它确实有助于绘图。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lv"><img src="../Images/89be4cbac951f079ece46a3808cf0118.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BJK6NniIQ6bMO5Ec.png"/></div></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lw"><img src="../Images/b916e312fef5d665165690cb8a0e25d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mFg9xlEMynLkqZot.png"/></div></div></figure><p id="000d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们将使用独热编码，该编码将分类特征(表示为标签索引)映射到二进制向量，该向量至多具有单个1值，该值指示所有特征值集合中特定特征值的存在。在这之后，我们将使用向量组合器，它允许我们将多个向量组合成一个向量，在这种情况下，我们将把带数值字段的向量与带分类字段的向量组合起来，后者现在已被转换。在这之后，我们将使用管道。流水线被指定为一系列阶段，每个阶段或者是转换器或者是估计器。这些阶段按顺序运行，输入数据帧在通过每个阶段时会发生转换。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lx"><img src="../Images/a93e14758e8586abd0180eb8264af968.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*keZIACulKgs8Sh48.png"/></div></div></figure><p id="567b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们已经创建了一个特征向量，现在让我们使用StandardScaler对新创建的“feature”列进行标量化。StandardScaler是一种估计器，可用于数据集以生成StandardScalerModel。然后，该模型可以将数据集中的矢量列转换为具有单位标准差和/或零均值要素。在我们的例子中，我们使用的是标准差。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ly"><img src="../Images/6d18bfe6bb4f9ed6678fdc3906693118.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hGg4uy8hodHQ33PT.png"/></div></div></figure><p id="a69d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">之后，我们将使用随机分割方法来分割测试和训练集中的数据。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/ac6fb93aed910e104603ba1784d3d3da.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/0*NdfLfEPAoBQdyFQO.png"/></div></figure><p id="ca26" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让我们看看数据集中1和0的百分比。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/16610d5f02dabf67039c48c777cda12a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/0*uaoAWMBEQjmaHiSW.png"/></div></figure><p id="ba05" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以看到，在我们的数据集(训练)中，我们有47.14 %的阳性和52.85 %的阴性。我们的树是平衡的，所以我们可以走了。</p><p id="825c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们将使用Spark ML提供的ChiSqSelector来选择重要的特性。它对带有分类特征的标记数据进行操作。ChiSqSelector使用卡方独立性检验来决定从哪些特性中进行选择。我们将使用参数<strong class="kk iu"> fpr </strong> —它选择p值低于阈值的所有特征，从而控制选择的假阳性率。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi mb"><img src="../Images/56a7bfee404fa661023f0416a4a6ebe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*s0njZHhekpg2Tn8N.png"/></div></div></figure><p id="4a1b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将创建逻辑回归模型，并拟合训练集。我们可以在最终结果中看到，哪些客户有存款(1)，哪些没有存款(0)。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi mc"><img src="../Images/0f122aefd869ed408aab301ea901dea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NzrOFAT201yE04cA.png"/></div></div></figure><p id="5db0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们使用Spark ML中的BinaryClassificationEvaluator类来评估模型。默认情况下，BinaryClassificationEvaluator使用ROC下的面积作为性能指标。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi md"><img src="../Images/2743f3fe732428481f2b60a992036ddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yekuxfcBJoATbO-S.png"/></div></div></figure><p id="e9fb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">结果</strong></p><p id="468f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在对我们的大型数据集执行逻辑回归后，我们可以得出结果，并确定哪些客户有存款(1)，哪些没有存款(0)。我们还可以看到预测的准确性，在这种情况下，它大约为0.82。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi me"><img src="../Images/1ce1b07fe3d542c70532b0072166861e.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/0*91CcldRyBCcvELih.png"/></div></figure><p id="36f5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">逻辑回归的目的是根据独立变量的值对事件发生的概率进行建模。将来，如果我们遇到这种问题，我们可以使用这种方法对大数据集进行准确预测。</p><p id="c03e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">使用大数据的机器学习的未来</strong></p><p id="cff8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">机器学习意味着在计算机如何学习和预测方面前进了一步。它在各个部门都有应用，并且正在各地广泛使用。更广泛地应用机器学习和分析让我们能够更快地应对动态情况，并从快速增长的数据宝库中获得更大的价值。自从机器学习出现以来，它就越来越受欢迎，而且不会很快停止。</p><p id="48d1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你对这个话题感兴趣，请随时联系我。</p><p id="5ef2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">领英简介:<a class="ae le" href="https://www.linkedin.com/in/ceftimoska/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/ceftimoska/</a></p><p id="d69f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">博客原文可从以下链接获得:<a class="ae le" href="https://interworks.com.mk/big-data-analyses-with-machine-learning-and-pyspark/" rel="noopener ugc nofollow" target="_blank">https://interworks . com . MK/big-data-analyses-with-machine-learning-and-py spark/</a></p><p id="e34b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另外，你可以在下面的链接中找到另一篇类似的博文:<a class="ae le" href="https://interworks.com.mk/focusareas/data-management/" rel="noopener ugc nofollow" target="_blank">https://interworks.com.mk/focusareas/data-management/</a></p></div></div>    
</body>
</html>