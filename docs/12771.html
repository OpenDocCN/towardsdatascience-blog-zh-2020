<html>
<head>
<title>Using Bayesian Classifiers to detect Fake News</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用贝叶斯分类器检测假新闻</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-bayesian-classifiers-to-detect-fake-news-3022c8255fba?source=collection_archive---------24-----------------------#2020-09-02">https://towardsdatascience.com/using-bayesian-classifiers-to-detect-fake-news-3022c8255fba?source=collection_archive---------24-----------------------#2020-09-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4a53" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有如此多的假新闻在流传，很难找到准确和未经捏造的消息来源。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/17885747dcd8289eff7a083a38ab99d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UxBhafia56JZbSb5s2eEaw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由联合国新冠肺炎办事处通过联合国日内瓦办事处回应</p></figure><p id="cbe6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有如此多的假新闻在流传，很难找到准确和未经捏造的消息来源。本文旨在使用朴素贝叶斯分类器对真假新闻进行分类。</p><h1 id="f32b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">什么是朴素贝叶斯分类器:</h1><p id="74e6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">朴素贝叶斯分类器是一种确定性算法，它使用贝叶斯定理对数据进行分类。让我们看一个例子:</p><p id="ee98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您想要预测今天下雨的概率:在过去的几天里，您通过观察天空中的云收集了数据。这是你的数据表:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/f992e13b864ec5df051c8595b04104dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Y0goDefnbUxbJxYuGJ_Jg.png"/></div></div></figure><p id="cf9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此表显示了在下雨或不下雨的情况下，某个要素出现的次数。我们所拥有的实际上是一个包含下雨概率的表格，假设出现了灰色的云或白色的云。</p><p id="a538" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在有了数据，我们来做个预测。今天我们看到了灰色的云和没有白色的云，它更可能是一个雨天还是一个晴天？要回答这个问题，我们必须使用贝叶斯定理:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/fe26b8ccdd1e7146e9ba240dd5106ae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*dmMy7qdXiWakpUP_YzkBDQ.png"/></div></figure><p id="99dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个定理利用过去的数据做出更好的决策。</p><p id="2a22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设有灰色云，下雨的概率等于下雨的概率，乘以下雨的概率，除以灰色云出现的概率。</p><p id="0e09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据我们的数据:</p><p id="9442" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">P(B|A)(下雨的概率，给定灰色云)= 10/11</p><p id="87fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">P(A)(下雨的概率)= 11/50+11 = 11/66 = 1/6</p><p id="7b8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">P(B)(灰色云的概率)= 1(灰色云已确认出现)</p><p id="06e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">P(A|B) = P(B|A) * P(A) / P(B)</p><p id="ad84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">P(A|B) = 10/11 * 1/6 / 1</p><p id="3261" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">P(A|B) = 10/66</p><p id="b149" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们的结果！假设出现了灰色的云，下雨的概率是 10/66，也就是说，在 66 种不同的概率中，情景相同的情况下，有 10 种会下雨。</p><h1 id="ae66" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">该项目:</h1><p id="a859" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">简单介绍了朴素贝叶斯分类器之后，让我们来谈谈用朴素贝叶斯分类器检测假新闻。</p><p id="5a38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设新闻是假的，我们将统计一个词在标题中出现的次数。把它变成一个概率，然后计算标题是假的概率，与标题是真的相比。</p><p id="bb3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用的数据集有超过 21，000 条真实新闻和 23，000 条假新闻。对于正常的数据集来说，这可能看起来不平衡，但这种不平衡对于计算初始概率是必要的:这是一个标题是假的概率，而不考虑它是什么。你可以联系我在 victorwtsim@gmail.com 的数据集。</p><h2 id="dfb1" class="mu lw it bd lx mv mw dn mb mx my dp mf li mz na mh lm nb nc mj lq nd ne ml nf bi translated">代码:</h2><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="bb70" class="mu lw it nh b gy nl nm l nn no">import pandas as pd<br/>import string</span></pre><p id="98ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是该程序的三个依赖项:pandas 用于读取 csv 文件，string 用于处理单词的大小写。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="8fe3" class="mu lw it nh b gy nl nm l nn no">true_text = {}<br/>fake_text = {}</span><span id="ba16" class="mu lw it nh b gy np nm l nn no">true = pd.read_csv('/Users/XXXXXXXX/Desktop/True.csv')<br/>fake = pd.read_csv('/Users/XXXXXXXX/Desktop/Fake.csv')</span></pre><p id="56ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个脚本将读取两个数据集，其中包含假新闻和真新闻的实例。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="f289" class="mu lw it nh b gy nl nm l nn no">def extract_words(category,dictionary):<br/>    for entry in category['title']:<br/>        words = entry.split()<br/>        for word in words:<br/>            lower_word = word.lower()<br/>            if word in dictionary:<br/>                dictionary[lower_word] += 1<br/>            else:<br/>                dictionary[lower_word] = 1<br/>    return dictionary</span></pre><p id="6b54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设标题是假新闻，这个脚本计算一个单词出现的次数，并在字典中为每个单词出现的次数加一。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="99d6" class="mu lw it nh b gy nl nm l nn no">def count_to_prob(dictionary,length):<br/>    for term in dictionary:<br/>        dictionary[term] = dictionary[term]/length<br/>    return dictionary</span></pre><p id="1163" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该函数通过计算假新闻标题或真实新闻标题的总字数，将数字转换为概率。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="2240" class="mu lw it nh b gy nl nm l nn no">def calculate_probability(dictionary,X,initial):<br/>    X.translate(str.maketrans('', '', string.punctuation))<br/>    X = X.lower()<br/>    split = X.split()<br/>    probability = initial<br/>    for term in split:<br/>        if term in dictionary:<br/>            probability *= dictionary[term]<br/>            print(term,dictionary[term])<br/>    return probability</span></pre><p id="6a2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该函数将相关概率相乘，计算出标题的“分数”。要进行预测，请比较使用假新闻和真实新闻词典时的得分。如果假新闻字典返回更高的分数，则该模型已经预测该标题是假新闻。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="2fd3" class="mu lw it nh b gy nl nm l nn no">true_text = extract_words(true,true_text)<br/>fake_text = extract_words(fake,fake_text)</span><span id="448b" class="mu lw it nh b gy np nm l nn no">true_count = count_total(true_text)<br/>fake_count = count_total(fake_text)</span><span id="c10f" class="mu lw it nh b gy np nm l nn no">true_text = count_to_prob(true_text,true_count)<br/>fake_text = count_to_prob(fake_text,fake_count)</span><span id="e4fa" class="mu lw it nh b gy np nm l nn no">total_count = true_count + fake_count<br/>fake_initial = fake_count/total_count<br/>true_initial = true_count/total_count</span></pre><p id="0c83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个脚本使用上述所有函数为每个单词创建一个概率字典，然后计算标题的“分数”。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="98b3" class="mu lw it nh b gy nl nm l nn no">X = 'Hillary Clinton eats Donald Trump'<br/>calculate_probability(fake_text,X,1)&gt;calculate_probability(true_text,X,1)</span></pre><p id="4263" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个最终脚本评估标题:“希拉里·克林顿吃了唐纳德·特朗普”，以测试模型。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="0af0" class="mu lw it nh b gy nl nm l nn no">True</span></pre><p id="b4aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该模型输出 True，因为标题显然是假新闻。</p><h1 id="2cd1" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">您可以改进我的计划的地方:</h1><p id="9fb2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我创建这个程序作为一个框架，以便其他人可以对它进行改进。以下是一些你可以考虑的事情:</p><ul class=""><li id="ace0" class="nq nr it lb b lc ld lf lg li ns lm nt lq nu lu nv nw nx ny bi translated">考虑短语和单词</li></ul><p id="fc43" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个单词本身没有意义，但是一个短语可以让我们更深刻地了解新闻是否是假的</p><ul class=""><li id="5878" class="nq nr it lb b lc ld lf lg li ns lm nt lq nu lu nv nw nx ny bi translated">通过网络搜集获得更大的数据集</li></ul><p id="f92c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">网上有很多真新闻和假新闻的来源，你只需要找到它。</p></div></div>    
</body>
</html>