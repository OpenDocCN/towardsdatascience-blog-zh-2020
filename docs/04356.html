<html>
<head>
<title>5-Minute Rundown of Model Development with Scikit-learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用 Scikit-learn 进行 5 分钟的模型开发概述</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/5-minute-rundown-of-scikit-learn-for-complete-beginners-c7dc06a5ca17?source=collection_archive---------47-----------------------#2020-04-19">https://towardsdatascience.com/5-minute-rundown-of-scikit-learn-for-complete-beginners-c7dc06a5ca17?source=collection_archive---------47-----------------------#2020-04-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="263d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在 5 分钟内训练一个玩具模型。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/70baac3d015f575e37a74fe256d7339d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nQ6dgndVz-fgXDa-p4HYyQ.png"/></div></div></figure><p id="4ce3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最近，<a class="lq lr ep" href="https://medium.com/u/9ab35c11801?source=post_page-----c7dc06a5ca17--------------------------------" rel="noopener" target="_blank"> Edward Qian </a>和我做了一个为初学者介绍数据科学基础知识的网站(查看一下—<a class="ae ls" href="http://www.dscrashcourse.com" rel="noopener ugc nofollow" target="_blank">T8)。scikit-learn 的初级读本可以在网站上找到，还有其他数据科学资源和实践问题。</a></p><p id="5e0f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们想通过使用<a class="ae ls" href="https://en.wikipedia.org/wiki/Iris_flower_data_set" rel="noopener ugc nofollow" target="_blank">著名的虹膜数据集</a>作为例子来展示<em class="lt">使用 scikit-learn 训练玩具模型是多么容易。</em></p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="5e83" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">scikit-learn 通常缩写为<code class="fe mb mc md me b">sklearn</code>，是 Python 的机器学习库。除了用于特征工程、特征和模型选择的工具之外，它还支持跨多种算法的模型开发。</p><p id="432a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本演示的目的是展示 scikit-learn 特性，而不考虑在如此小的数据集上的实用性。所有代码都是 Python 3。</p><h1 id="b079" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">加载虹膜数据集</h1><p id="62b4" class="pw-post-body-paragraph ku kv it kw b kx mx ju kz la my jx lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">我们将使用数据集模块来加载 Iris 数据集。我们还可以使用<code class="fe mb mc md me b">pandas</code>库和<code class="fe mb mc md me b">numpy</code>库将数据转换成数据帧，以便于预处理。</p><p id="c2e3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">数据集模块还提供了关于数据集的简短描述:</p><blockquote class="nc nd ne"><p id="2c66" class="ku kv lt kw b kx ky ju kz la lb jx lc nf le lf lg ng li lj lk nh lm ln lo lp im bi translated"><em class="it"> …数据集包含 3 类，每类 50 个实例，每类涉及一种鸢尾植物。一个类与另一个类是线性可分的；后者彼此不是线性可分的。</em></p></blockquote><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="b92a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以使用<code class="fe mb mc md me b">data.head()</code>来预览前 5 行:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/fec9c5f66bc3dd016dfbde12febe771c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lXd5jsN_sN2NXD4jiiEDYg.png"/></div></div></figure><p id="8ba3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="lt">目标</em>列代表鸢尾的亚种。</p><ul class=""><li id="5592" class="nl nm it kw b kx ky la lb ld nn lh no ll np lp nq nr ns nt bi translated">类 0 是<em class="lt"> Setosa </em></li><li id="1770" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">第一类是<em class="lt">云芝</em></li><li id="7281" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">二班是<em class="lt">海滨</em></li></ul><h1 id="2b40" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">使用 train_test_split 对数据集进行分区</h1><p id="9ef6" class="pw-post-body-paragraph ku kv it kw b kx mx ju kz la my jx lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">我们应该总是保留一部分数据用于测试。永远不要在开发模型的同一数据上测试你的模型。这被称为<strong class="kw iu">数据泄漏</strong>，它导致<strong class="kw iu">过拟合</strong>，这高估了模型在后续观测中的性能。</p><p id="f3a7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">模型选择模块有几个用于分割数据集和超参数调整的有用功能。我们将使用<code class="fe mb mc md me b">sklearn.model_selection.train_test_split</code>将我们的数据集随机划分为一个训练集和一个测试集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="25db" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">特征选择</h1><p id="2a58" class="pw-post-body-paragraph ku kv it kw b kx mx ju kz la my jx lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">我们如何知道我们想要在我们的模型中使用哪些特性？我们如何从噪音中区分相关的预测因素？这很大程度上归结于领域知识，但这也是一个可以通过特征选择技术自动化的过程。Scikit-learn 有一个专门的模块。</p><p id="bde2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将使用<code class="fe mb mc md me b">SelectKbest</code>功能来选择顶部的<em class="lt"> k </em>显著特征。通过将<em class="lt"> k </em>设置为我们可用的相同数量的特征，我们可以使用这些输出来量化每个特征的相关性。分类的<a class="ae ls" href="https://en.wikipedia.org/wiki/F-test" rel="noopener ugc nofollow" target="_blank"> F 检验值</a>将用作评分函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="fad9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">F 值分数表明花瓣尺寸比萼片尺寸更能预测。</p><ul class=""><li id="6778" class="nl nm it kw b kx ky la lb ld nn lh no ll np lp nq nr ns nt bi translated">萼片长度(厘米):95</li><li id="1ab5" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">萼片宽度(厘米):35</li><li id="3d41" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">花瓣长度(厘米):925</li><li id="53cd" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">花瓣宽度(厘米):725</li></ul><p id="a8f4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这些分数很难单独解读。我们需要查看它们对应的 p 值，以确定它们对目标变量的影响的统计显著性。</p><p id="fb1b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以从<code class="fe mb mc md me b">feature_selection.pvalues_</code>获得 pvalues</p><p id="e919" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果零假设为真，并且如果我们多次重复相同的实验，p 值表示更多“极端”观察的百分比。这里的零假设是该特征对目标没有影响(即，我们不应该将其用作预测器)。</p><p id="8bb0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">低 p 值表明我们应该拒绝我们的零假设——换句话说，拒绝特征没有效果的说法。</p><p id="d123" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这个例子中，我们有非常小的 p 值:2.65205811e-25，8.62129460e-13，1.97685433e-72，1.15999788e-66。我们绝对应该在模型中保留所有 4 个变量。</p><h1 id="ccc5" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">训练分类器</h1><p id="9e4f" class="pw-post-body-paragraph ku kv it kw b kx mx ju kz la my jx lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">我们所要做的就是实例化分类器并调用<em class="lt"> fit </em>方法在训练集上训练它。</p><p id="5ae1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里有一个逻辑回归的例子。逻辑回归的<code class="fe mb mc md me b">predict</code>方法返回预测的类。<code class="fe mb mc md me b">predict_proba</code>方法返回每个类的概率分数。</p><p id="fe4f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有关逻辑回归算法的更多详细信息，请单击此处的<a class="ae ls" href="https://www.dscrashcourse.com/lessons/logistic_regression" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="7122" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">评估绩效</h1><p id="5204" class="pw-post-body-paragraph ku kv it kw b kx mx ju kz la my jx lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">在我们训练了我们的模型之后，我们想要评估它的性能。这可以帮助我们在候选模型之间进行选择，并将模型期望传达给涉众。Scikit-learn 的度量模块可以帮助我们做到这一点。</p><p id="5338" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，我们使用模型来预测测试集的标签。然后，我们将预测标签与真实标签进行比较，以确定性能。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="0d74" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们模型的准确率在 83%左右。混淆矩阵显示了正确和错误分类的细目分类。该模型非常善于识别 Setosa，但在区分其他两类时有困难。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/ceb694ea05147851c0dfaffd1b89e0d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*_ye1dY87Iv7L95cz6Z7J3Q.png"/></div></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="8732" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就是你所拥有的——一个使用 scikit-learn 的一些核心功能在不到 5 分钟的时间内训练出来的玩具模型。</p><p id="e2e5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所有代码都在一个地方:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="eac7" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">感谢您的阅读！</h1><p id="66c1" class="pw-post-body-paragraph ku kv it kw b kx mx ju kz la my jx lc ld mz lf lg lh na lj lk ll nb ln lo lp im bi translated">如果你喜欢这篇文章，你可能想看看我关于数据科学、数学和编程的其他文章。<a class="ae ls" href="https://medium.com/@mandygu" rel="noopener">通过 Medium </a>关注我的最新动态！</p><p id="99bf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我还在建立一套全面的<strong class="kw iu">免费</strong>数据科学课程。来看看:【www.dscrashcourse.com T4】</p></div></div>    
</body>
</html>