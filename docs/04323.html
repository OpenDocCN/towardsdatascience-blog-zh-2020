<html>
<head>
<title>How to Scrape Flight Prices with Python using Selenium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 Selenium 通过 Python 节省航班费用</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-scrape-flight-prices-with-python-using-selenium-a8382a70d5d6?source=collection_archive---------14-----------------------#2020-04-19">https://towardsdatascience.com/how-to-scrape-flight-prices-with-python-using-selenium-a8382a70d5d6?source=collection_archive---------14-----------------------#2020-04-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4a64" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在这篇文章中，你将学会用 Selenium 和 ChromeDriver 来降低 Expedia 航班的价格</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/729a2183eb38cff026f02a46a22d8dee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CL2NO4SrmZTMoXxci_DQDA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片(尼泊尔卢卡拉)</p></figure><p id="bcfb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文由<a class="ae lu" href="https://www.linkedin.com/in/roee-freund-0a8883190" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">罗伊·弗氏</strong> </a> <strong class="la iu"> </strong>和<a class="ae lu" href="https://www.linkedin.com/in/offirinbar/" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu">奥菲尔·因巴尔</strong> </a>撰写</p><h1 id="9ca9" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">背景</h1><p id="c8a5" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated"><strong class="la iu"> <em class="ms">新冠肺炎疫情期间困在家里？你喜欢旅游和数据科学吗？</em>T13】</strong></p><p id="b2ea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以把两者结合起来买便宜的航班。本教程将教你如何创建一个 web scraper，它将为你找到你想要的任何目的地的航班价格。</p><p id="d4d3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本教程中，你将了解到 Expedia 是世界上最大的在线旅行社之一。它由 Expedia 集团拥有和运营，在收入最高的旅游公司排行榜上排名第一。</p><p id="2ebb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想知道<strong class="la iu">新冠肺炎疫情</strong>如何影响航班价格，看看我们的媒体<a class="ae lu" href="https://medium.com/@offirinbar/coronavirus-outbreak-devastates-the-aviation-industry-flight-ticket-prices-are-dropping-case-study-56330c84b250" rel="noopener"> <strong class="la iu">邮报</strong> </a> <strong class="la iu">。</strong></p><p id="5bdc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">需要注意的是，网络抓取违反了大多数网站的服务条款，所以你的 IP 地址可能会被禁止进入网站。</p><h1 id="9e50" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">环境设置</h1><p id="8b4f" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">对于这个刮刀，请确保您使用的是 Python 3.5 版本(或更新版本)。确认您的环境包含以下软件包和驱动程序:</p><ul class=""><li id="9947" class="mt mu it la b lb lc le lf lh mv ll mw lp mx lt my mz na nb bi translated">Selenium 包:一个流行的网络浏览器自动化工具</li><li id="2bfd" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated"><a class="ae lu" href="https://chromedriver.chromium.org/" rel="noopener ugc nofollow" target="_blank"> ChromeDriver: </a>允许你打开浏览器，像人类一样执行任务。</li><li id="4164" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">熊猫套餐</li><li id="bc2f" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">日期时间包</li></ul><p id="6103" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lu" href="https://medium.com/the-andela-way/introduction-to-web-scraping-using-selenium-7ec377a8cf72" rel="noopener">这篇</a> TDS 帖子是对 Selenium 的一个很好的介绍。</p><h1 id="a5af" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">刮擦策略</h1><p id="f01a" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">在进入代码之前，我们先简单描述一下抓取策略:</p><ul class=""><li id="8dd2" class="mt mu it la b lb lc le lf lh mv ll mw lp mx lt my mz na nb bi translated">插入到一个 CSV 文件的确切路线和日期，你想刮。您可以插入任意多的路线，但是使用这些列名很重要。铲运机只在往返时工作。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/5da2a1e54613434926790867d3dc66d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*fAc11WwEfHksMPm7cnEjXw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">CSV 路线文件。dep =出发，arr =到达。</p></figure><ul class=""><li id="44ce" class="mt mu it la b lb lc le lf lh mv ll mw lp mx lt my mz na nb bi translated">运行完整的代码。</li><li id="42d0" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">每个航班的<strong class="la iu">输出是一个 CSV 文件。它的文件名将是执行抓取的日期和时间。</strong></li><li id="35c3" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">相同路线的所有航班将自动由刮刀定位在适当的文件夹(路线的名称)中。</li></ul><p id="96cd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">听起来很复杂……其实不然！让我们看一个例子。</strong></p><p id="4010" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些是 CSV 文件中定义的抓取路径(抓取器会自动创建这些文件夹):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/b6606d450322d7ace14509c94e8099ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*KoUEBchfRkXhD7xtcIynqg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">废弃的路线</p></figure><p id="4448" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里，您可以看到雅典—阿布扎比航线上的多个刮掉的日期:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/a96fd603ff5d9658a06f9f3b1be69c0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*xKT9bcKJHNaq4s3pYg69Lg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">刮掉的日期:雅典—阿布扎比</p></figure><p id="db12" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面的屏幕截图展示了雅典-阿布扎比航线的每个刮擦样本的单个 CSV 文件。它的名字代表了刮刀被执行的日期和时间。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/517d21a352278501971a05b0000d7418.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yP-A6itCBhI462g9SY-g6w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">特定日期的单个 CSV 输出文件</p></figure><p id="0da5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们希望流程清晰！</p><h1 id="9f52" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">输出特征</h1><p id="ead2" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">铲运机输出将包括以下特性:</p><ul class=""><li id="6452" class="mt mu it la b lb lc le lf lh mv ll mw lp mx lt my mz na nb bi translated">出发时间</li><li id="dc21" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">到达时间</li><li id="1e33" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">航空公司</li><li id="bfff" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">持续时间(飞行时间)</li><li id="063c" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">停靠站(停靠站数量)</li><li id="bd3e" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">中途停留</li><li id="cd68" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">价格</li><li id="aab4" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">飞机类型</li><li id="79a0" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">离开蔻驰</li><li id="7264" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">抵达蔻驰</li><li id="3d81" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">出发机场名称</li><li id="f6fc" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">到达机场名称</li><li id="f15b" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">执行擦除的确切时间</li></ul><p id="1688" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果<strong class="la iu">不是直飞</strong>，scraper 会给你额外的数据(机场，航空公司名称等)。)用于<strong class="la iu">每个连接</strong>。</p><h1 id="28e3" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">密码</h1><p id="f179" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">在这一节中，我们将检查代码的主要部分。<strong class="la iu">你可以在这里</strong> 找到完整的代码 <a class="ae lu" href="https://github.com/offirinbar/blogpost_scraping/blob/master/scraper.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="la iu"/></a></p><p id="3d10" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，像往常一样，需要导入相关的库，定义 chrome 驱动程序并设置往返类型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="a5e4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在下一步中，您将使用 Selenium 工具定义一些函数，以便在网页上找到各种功能。函数的名字暗示了它们的作用。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="b905" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">CSV routes 文件中的每一行(航班)都经过以下过程:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="6f45" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">是时候从网上收集数据并把它插入熊猫的数据框架中了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="e85e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，将数据以 CSV 文件直接导出到所需的文件夹中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><h1 id="900a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="3b0d" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">总之，你学会了如何用 Selenium 包来节省 Expedia 航班的价格。理解基础知识后，你将能够为任何其他网站构建你的抓取工具。</p><p id="c7be" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就个人而言，作为爱好绘画的旅行者，我们喜欢使用数据科学来寻找全球各地令人惊叹的目的地的优惠。</p><p id="93e8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您有任何问题、评论或担忧，请不要忘记联系 Linkedin 上的<a class="ae lu" href="https://www.linkedin.com/in/roee-freund-0a8883190/" rel="noopener ugc nofollow" target="_blank"> Roee </a>和<a class="ae lu" href="https://www.linkedin.com/in/offirinbar/" rel="noopener ugc nofollow" target="_blank"> Offir </a>。</p><p id="7d05" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">祝你好运！</p><h1 id="d5e6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考</h1><div class="nn no gp gr np nq"><a href="https://medium.com/the-andela-way/introduction-to-web-scraping-using-selenium-7ec377a8cf72" rel="noopener follow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">使用 Selenium 的网页抓取简介</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">在本教程中，你将学习如何用 Selenium 和 ChromeDriver 抓取网站。</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">medium.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe ks nq"/></div></div></a></div><p id="faf5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lu" href="https://en.wikipedia.org/wiki/Expedia" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Expedia</a></p><div class="nn no gp gr np nq"><a href="https://www.guru99.com/selenium-python.html" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">使用 Python 的 Selenium Webdriver:带示例的教程</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">Selenium 支持 Python，因此可以与 Selenium 一起用于测试。与其他相比，Python 很容易…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">www.guru99.com</p></div></div><div class="nz l"><div class="of l ob oc od nz oe ks nq"/></div></div></a></div><p id="2791" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lu" href="https://www.scrapehero.com/scrape-flight-schedules-and-prices-from-expedia/" rel="noopener ugc nofollow" target="_blank">https://www . scrape hero . com/scrape-flight-schedules-and-prices-from-Expedia/</a></p></div></div>    
</body>
</html>