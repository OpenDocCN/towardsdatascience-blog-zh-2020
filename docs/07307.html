<html>
<head>
<title>Custom Object Detection using Darknet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用暗网的自定义对象检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/custom-object-detection-using-darknet-9779170faca2?source=collection_archive---------3-----------------------#2020-06-03">https://towardsdatascience.com/custom-object-detection-using-darknet-9779170faca2?source=collection_archive---------3-----------------------#2020-06-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6062" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">创建自定义对象检测器指南—第1部分</h2></div></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ku kv l"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">以15 fps的速度输出视频</p></figure><blockquote class="la lb lc"><p id="2496" class="ld le lf lg b lh li ju lj lk ll jx lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated"><em class="it">在这篇文章中，你将使用</em> <strong class="lg iu"> <em class="it">【暗网】</em> </strong> <em class="it">训练模型进行蒙版检测。</em></p><p id="5239" class="ld le lf lg b lh li ju lj lk ll jx lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated"><strong class="lg iu">本文可参考训练任何自定义物体探测器</strong></p></blockquote><p id="8895" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">引用:视频输出可以在YouTube上通过彭博快带获得，用于训练的下载图片可以在Kaggle上作为开源获得。这些图片是我个人电脑的截图。非常感谢我的同事Shauryasikt Jena </p><p id="f14a" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">您无需从头开始训练自己的模型，而是可以在现有模型的基础上进行构建，并根据自己的目的对其进行微调，而不需要太多的计算能力。我用Google Colab进行训练，用CPU(本地机器)进行测试。</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h2 id="adbb" class="mf mg it bd mh mi mj dn mk ml mm dp mn ma mo mp mq mb mr ms mt mc mu mv mw mx bi translated">什么是暗网？</h2><p id="9577" class="pw-post-body-paragraph ld le it lg b lh my ju lj lk mz jx lm ma na lp lq mb nb lt lu mc nc lx ly lz im bi translated">Darknet是一个开源的神经网络框架。这是一个快速和高度准确的(定制训练模型的准确性取决于训练数据、时期、批量大小和一些其他因素)<strong class="lg iu">框架，用于实时对象检测</strong>(也可用于图像)。最重要的原因是它很快，因为它是用C和CUDA编写的。</p><p id="30a0" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">为了了解C有多快—</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/fe442c998baad1d59ba674e4bb829956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Pn598descNSnI574feEOQ.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">Mandelbrot集合执行时间的比较</p></figure><p id="1925" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">欲了解更多对比数据，请访问本页</p><div class="nk nl gp gr nm nn"><a href="https://benchmarksgame-team.pages.debian.net/benchmarksgame/fastest/python3-gcc.html" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">python 3 vs C gcc——哪些程序最快？计算机语言基准游戏</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">Python 3 C gcc -哪些程序最快？</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">benchmarksgame-team.pages.debian.net</p></div></div></div></a></div></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="01f8" class="nw mg it bd mh nx ny nz mk oa ob oc mn jz od ka mq kc oe kd mt kf of kg mw og bi translated">内容</h1><ol class=""><li id="9fd8" class="oh oi it lg b lh my lk mz ma oj mb ok mc ol lz om on oo op bi translated">装置</li><li id="1841" class="oh oi it lg b lh oq lk or ma os mb ot mc ou lz om on oo op bi translated">收集图像</li><li id="8cd2" class="oh oi it lg b lh oq lk or ma os mb ot mc ou lz om on oo op bi translated">给图像加标签</li><li id="ddf4" class="oh oi it lg b lh oq lk or ma os mb ot mc ou lz om on oo op bi translated">获取和设置暗网</li><li id="c9f3" class="oh oi it lg b lh oq lk or ma os mb ot mc ou lz om on oo op bi translated">训练我们的暗网</li></ol><p id="09bc" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">让我们开始吧，非常简单。只需浏览文章并按照步骤操作即可。谢谢:)</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="9f2a" class="nw mg it bd mh nx ny nz mk oa ob oc mn jz od ka mq kc oe kd mt kf of kg mw og bi translated">1.装置</h1><p id="ec3d" class="pw-post-body-paragraph ld le it lg b lh my ju lj lk mz jx lm ma na lp lq mb nb lt lu mc nc lx ly lz im bi translated">我们将在Google colab上训练我们的模型，因此没有额外的库需要安装</p><p id="d601" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">但是如果你在本地机器上测试这个模型，这里有你需要的库—</p><pre class="kp kq kr ks gt ov ow ox oy aw oz bi"><span id="f281" class="mf mg it ow b gy pa pb l pc pd">opencv==4.2.0<br/>tensorflow==1.13.2<br/>numpy==1.18.1<br/>pandas==1.0.2<br/>keras==2.3.1<br/>matplotlib==3.2.0<br/>PIL==7.0.0<br/>ffmpeg==4.2.2</span></pre><p id="be3c" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">请分别使用anaconda cloud或Pypi上的conda或pip在您的本地系统上安装这些库。</p><p id="8c07" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">注意:ffmpeg用于保存输出视频文件，因此需要特定的版本。</p><pre class="kp kq kr ks gt ov ow ox oy aw oz bi"><span id="7592" class="mf mg it ow b gy pa pb l pc pd">conda install ffmpeg</span></pre><h1 id="8bc0" class="nw mg it bd mh nx pe nz mk oa pf oc mn jz pg ka mq kc ph kd mt kf pi kg mw og bi translated">2.收集图像</h1><p id="12e3" class="pw-post-body-paragraph ld le it lg b lh my ju lj lk mz jx lm ma na lp lq mb nb lt lu mc nc lx ly lz im bi translated">你可以通过点击下载从这个链接获得图片—</p><div class="nk nl gp gr nm nn"><a href="https://www.kaggle.com/vtech6/medical-masks-dataset" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">医用口罩数据集</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">人们戴着医用口罩的照片</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">www.kaggle.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po ni nn"/></div></div></a></div><p id="34cc" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">注:该链接包含一个zip文件，其中的图像及其标签/注释已经存在<strong class="lg iu">，但</strong>确保它们是正确的(相对于屏蔽/非屏蔽的坐标)。只是为了确保我手动标记它，这样我就不需要再次训练模型。</p><p id="798d" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">下载的文件将只有大约700张图片，这不足以获得良好的准确性。你也可以从这些链接中得到它们..</p><div class="nk nl gp gr nm nn"><a href="https://www.kaggle.com/shreyashwaghe/face-mask-dataset" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">面罩数据集</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">Kaggle是世界上最大的数据科学社区，拥有强大的工具和资源来帮助您实现您的数据…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">www.kaggle.com</p></div></div><div class="pj l"><div class="pp l pl pm pn pj po ni nn"/></div></div></a></div><p id="d327" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">你可以从这里得到蒙版和非蒙版的图像—</p><div class="nk nl gp gr nm nn"><a href="https://www.kaggle.com/ahmetfurkandemr/mask-datasets-v1" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">掩膜数据集V1</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">戴口罩和不戴口罩的人。</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">www.kaggle.com</p></div></div><div class="pj l"><div class="pq l pl pm pn pj po ni nn"/></div></div></a></div><p id="35d4" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">现在你已经收集了1300多张图片(如果可能的话，你可以添加更多的图片，这肯定会提高准确性)，这是一个有点繁琐但很重要的步骤。</p><h1 id="aab2" class="nw mg it bd mh nx pe nz mk oa pf oc mn jz pg ka mq kc ph kd mt kf pi kg mw og bi translated">3.标记</h1><p id="609e" class="pw-post-body-paragraph ld le it lg b lh my ju lj lk mz jx lm ma na lp lq mb nb lt lu mc nc lx ly lz im bi translated">在收集了大约1300或更多的图像后，你必须手动标记它们。是的，这是一个非常繁琐的任务，但正确标记图像是非常重要的，否则它会反映在模型上，精度不会令人满意！</p><p id="304d" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">要给图像加标签，你可以使用一个非常有名的工具<strong class="lg iu"> <em class="lf"> Labelimg。</em>T3】</strong></p><p id="9fb0" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">你可以在你的系统上克隆这个链接—</p><div class="nk nl gp gr nm nn"><a href="https://github.com/tzutalin/labelImg" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">佐他林/标签</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">LabelImg是一个图形化的图像注释工具。它是用Python写的，使用Qt作为它的图形界面…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">github.com</p></div></div><div class="pj l"><div class="pr l pl pm pn pj po ni nn"/></div></div></a></div><p id="81a9" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">注意:克隆完成后，我建议您查看安装步骤，因为您必须在命令提示符下写两三行</p><p id="6e37" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">关于安装指南，您可以观看任何<strong class="lg iu">标签安装</strong>视频。别担心，安装很容易，但是标签部分是……你知道我的意思。</p><ol class=""><li id="4aed" class="oh oi it lg b lh li lk ll ma ps mb pt mc pu lz om on oo op bi translated">转到文件并打开包含图像的文件夹</li></ol><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi pv"><img src="../Images/05abcd7a37a1d5427b58511507b38cae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qxODFSkrdijSzaam.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">这是运行labelimg.py后的样子</p></figure><p id="2b8d" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">2.单击“创建”复选框，开始标记蒙版图像</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi pv"><img src="../Images/091c6a0bd0b7aa68f29e34a106ae1eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DwYlTlL8wCnTVox4.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">从目录中打开图像</p></figure><p id="f911" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">3.拖动遮罩周围的区域，然后键入masked</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi pv"><img src="../Images/384fad1425a878344fda857b3f093d66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hnK1Q4l6r7RVod3U.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">遮罩图像的标签</p></figure><p id="ae66" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">4.我们也需要非蒙版，因此同样的程序点击创建/选择框，拖动非蒙版面，并标记为非蒙版</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi pv"><img src="../Images/449d082eba51fdedc0d79d96a4909b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Jk2NnAcbAFNOuh1D.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">非遮罩面部的标签</p></figure><p id="98e1" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">5.标记每张脸后，保存并移动到下一张图片</p><blockquote class="la lb lc"><p id="21ef" class="ld le lf lg b lh li ju lj lk ll jx lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">老实说，根据你的速度，你需要2到3个小时来完成这项工作。所以祝你好运；)</p></blockquote><h1 id="8f1c" class="nw mg it bd mh nx pe nz mk oa pf oc mn jz pg ka mq kc ph kd mt kf pi kg mw og bi translated">4.获取和设置暗网</h1><p id="c8b1" class="pw-post-body-paragraph ld le it lg b lh my ju lj lk mz jx lm ma na lp lq mb nb lt lu mc nc lx ly lz im bi translated"><strong class="lg iu">获得暗网</strong></p><p id="d53a" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">你可以直接在google colab上克隆这个GitHub库用于训练—</p><div class="nk nl gp gr nm nn"><a href="https://github.com/pjreddie/darknet" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">pjreddie/darknet</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">Darknet是用C和CUDA编写的开源神经网络框架。它速度快，易于安装，并支持CPU…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">github.com</p></div></div><div class="pj l"><div class="pw l pl pm pn pj po ni nn"/></div></div></a></div><p id="e0e6" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">注意:除了这个存储库之外，还有另一个存储库，它是pjreddie的派生版本。我使用pjreddie是因为在第一次尝试时，它对我来说很好。</p><p id="9bf0" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated"><strong class="lg iu">设置暗网</strong></p><ol class=""><li id="dfa8" class="oh oi it lg b lh li lk ll ma ps mb pt mc pu lz om on oo op bi translated">你需要一个名为darknet53.conv.74的文件，你可以从<a class="ae px" href="https://pjreddie.com/media/files/darknet53.conv.74" rel="noopener ugc nofollow" target="_blank">这里</a>下载并放入darknet</li><li id="7053" class="oh oi it lg b lh oq lk or ma os mb ot mc ou lz om on oo op bi translated">在cfg文件夹中，使用记事本创建一个名为yolov3_custom_train.cfg的文件，将yolov3.cfg中的所有内容复制到新文件中。复制这22行，而不是文件中的行</li></ol><pre class="kp kq kr ks gt ov ow ox oy aw oz bi"><span id="8cb4" class="mf mg it ow b gy pa pb l pc pd">[net]<br/>#Testing<br/>#batch=1<br/>#subdivisions=1<br/>#Training<br/>batch=24<br/>subdivisions=8<br/>width=416<br/>height=416<br/>channels=3<br/>momentum=0.9<br/>decay=0.0005<br/>angle=0<br/>saturation = 1.5<br/>exposure = 1.5<br/>hue=.1</span><span id="027b" class="mf mg it ow b gy py pb l pc pd">learning_rate=0.001<br/>burn_in=1000<br/>max_batches = 6000<br/>policy=steps<br/>steps=5400<br/>scales=.1,.1</span></pre><p id="57f8" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">在文件中使用ctrl + f搜索[yolo],并在各处进行这些更改(将有三个[yolo]块)。</p><p id="7bfd" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">注意:更改将发生在每个<em class="lf">【yolo】的<strong class="lg iu"> <em class="lf">和【yolo】正上方的【卷积】块</em>中，仅此而已。cfg，别忘了保存！</strong></em></p><pre class="kp kq kr ks gt ov ow ox oy aw oz bi"><span id="b724" class="mf mg it ow b gy pa pb l pc pd">[convolutional]<br/>size=1<br/>stride=1<br/>pad=1<br/>filters=21<br/>activation=linear</span><span id="f979" class="mf mg it ow b gy py pb l pc pd">[yolo]<br/>mask = 6,7,8<br/>anchors = 10,13,  16,30,  33,23,  30,61,  62,45,  59,119,  116,90,  156,198,  373,326<br/>classes=2<br/>num=9<br/>jitter=.3<br/>ignore_thresh = .7<br/>truth_thresh = 1<br/>random=1</span></pre><p id="04fe" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">让我们简单了解一下我们刚刚做了什么..</p><p id="1e39" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">我们改变了类=2，因为我们有两个类<strong class="lg iu"> <em class="lf">屏蔽</em> </strong>和<strong class="lg iu"> <em class="lf">非_屏蔽</em> </strong>并且在[卷积]中，过滤器=21</p><p id="c06e" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">过滤器数量的公式是—</p><p id="9574" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">过滤器=(类别数+ 5)*3</p><p id="46d9" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">3.使用记事本在数据文件夹中创建一个名为yolo.names的新文件，并复制以下几行..</p><pre class="kp kq kr ks gt ov ow ox oy aw oz bi"><span id="dcf8" class="mf mg it ow b gy pa pb l pc pd">masked<br/>not_masked</span></pre><p id="fd1f" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">..完成后，保存它。(我们需要这个文件进行测试)</p><p id="4858" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">4.创建另外两个文件train.txt和val.txt，并在training 95% Validation-5%中划分您的图像。</p><pre class="kp kq kr ks gt ov ow ox oy aw oz bi"><span id="45c5" class="mf mg it ow b gy pa pb l pc pd">darknet<br/>    ├── cfg<br/>    |   <br/>    ├── data<br/>    |   ├── images<br/>    |          ├── some_image.jpg<br/>    |          ├── other_image.jpg<br/>    |          ├── ...<br/>    |   ├── labels<br/>    |          ├── Some_image.txt<br/>    |          ├── other_image.txt<br/>    |          ├── ...<br/>    |   ├── train.txt <br/>    |   ├── val.txt<br/>    |<br/>    ├── ...<br/>    .<br/>    .<br/>    ├── darknet53.conv.74<br/>    ...</span></pre><p id="1d75" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">现在棘手的部分来了..您已经下载的<strong class="lg iu">图像</strong>应该放在darknet的图像文件夹中<strong class="lg iu">，而<strong class="lg iu">注释/标签放在</strong>文件夹中。在train.txt和val.txt中，你必须像这样给出每个图像的路径..</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi pv"><img src="../Images/db820b532607ef30a03420d6201d2f39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*x3EtmoaZcsqLgi3T.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">train.txt包含全部图像的95%</p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi pv"><img src="../Images/86830ab75ad73f2175e44e5ea5a9bee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OGx8rqJ6LIapjDM5.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">val.txt包含总图像的剩余5%</p></figure><p id="4466" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">提示:你可以写一个简单的python代码来做这件事，只需要2分钟，不需要手动写全部内容</p><p id="07e5" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">5.使用记事本创建一个文件“yolo.data ”,并将其粘贴到该文件中..</p><pre class="kp kq kr ks gt ov ow ox oy aw oz bi"><span id="075b" class="mf mg it ow b gy pa pb l pc pd">classes= 2<br/>train  = data/train.txt<br/>valid  = data/val.txt<br/>names = data/yolo.names<br/>backup = backup</span></pre><h1 id="9b5c" class="nw mg it bd mh nx pe nz mk oa pf oc mn jz pg ka mq kc ph kd mt kf pi kg mw og bi translated">5.训练我们的暗网</h1><p id="85a8" class="pw-post-body-paragraph ld le it lg b lh my ju lj lk mz jx lm ma na lp lq mb nb lt lu mc nc lx ly lz im bi translated">最期待的部分终于来了。从这里开始，你不需要做任何事情，只需要运行一些代码，然后等待训练完成。</p><p id="e907" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">现在只要把你的darknet文件夹上传到google drive上，我们就快成功了。</p><p id="2a9d" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">提示:如果在任何情况下<strong class="lg iu"> google colab因为你的<strong class="lg iu"> GPU运行时间已经超过</strong>而自动断开与</strong>的连接，你可以保存你生成的权重文件的检查点，这样你就可以从那个时期继续，也可以测试哪个权重文件给出最好的结果。您可以转到examples文件夹中的detector.c文件并进行这些更改，以便每100个时期后获得权重文件，1000个时期后获得每1000个时期后的权重</p><p id="e316" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">在我的驱动器中你的darknet文件夹外创建一个备份文件夹<strong class="lg iu"/></p><pre class="kp kq kr ks gt ov ow ox oy aw oz bi"><span id="4134" class="mf mg it ow b gy pa pb l pc pd">void train_detector(char *datacfg, char *cfgfile, char *weightfile, int *gpus, int ngpus, int clear)<br/>{ .... <br/>  ....<br/>  ....<br/>  if(i%1000==0 || (i &lt; 1000 &amp;&amp; i%100 == 0)){<br/>#ifdef GPU<br/>    if(ngpus != 1) sync_nets(nets, ngpus, 0);<br/>#endif<br/>       char buff[256];<br/>       sprintf(buff, "%s/%s_%d.weights", backup_directory, base, i);<br/>       save_weights(net, buff);<br/>    }</span></pre><p id="8535" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">现在我们就快到了，只要确保你有训练模型所需的一切，因为你不想再做一遍。</p><p id="a24b" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">行..现在让我们训练模型(耶..最后)</p><p id="2335" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">最简单的步骤就在这里，但首先要确保你给出的路径是正确的。一个细胞一个细胞地运行这些代码。<strong class="lg iu">将colab运行时改为GPU </strong></p><p id="77d7" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">注意:下面的命令只适用于linux，因此我们使用Google Colab</p><pre class="kp kq kr ks gt ov ow ox oy aw oz bi"><span id="4afe" class="mf mg it ow b gy pa pb l pc pd">google.colab import drive<br/>drive.mount('/content/drive')</span><span id="c220" class="mf mg it ow b gy py pb l pc pd">#If you have a zipped darknet<br/>!unzip "/content/drive/My Drive/darknet.zip"</span><span id="fd13" class="mf mg it ow b gy py pb l pc pd">%cd /content/darknet<br/>!make<br/>!chmod +x ./darknet</span><span id="1e26" class="mf mg it ow b gy py pb l pc pd">!rm /content/darknet/backup -r<br/>!ln -s /content/drive/'My Drive'/backup /content/darknet</span><span id="063c" class="mf mg it ow b gy py pb l pc pd">!sudo apt install dos2unix<br/>!dos2unix ./data/train.txt<br/>!dos2unix ./data/val.txt<br/>!dos2unix ./data/yolo.data<br/>!dos2unix ./data/yolo.names<br/>!dos2unix ./cfg/yolov3_custom_train.cfg</span><span id="2316" class="mf mg it ow b gy py pb l pc pd">#To start the training<br/>%cd /content/darknet<br/>!./darknet detector train data/yolo.data cfg/yolov3_custom_train.cfg darknet53.conv.74</span></pre><p id="df02" class="pw-post-body-paragraph ld le it lg b lh li ju lj lk ll jx lm ma lo lp lq mb ls lt lu mc lw lx ly lz im bi translated">注意:当你从一个检查点开始训练，比如说在2000个纪元后，只需将训练命令改为..</p><pre class="kp kq kr ks gt ov ow ox oy aw oz bi"><span id="f451" class="mf mg it ow b gy pa pb l pc pd">!./darknet detector train data/yolo.data cfg/yolov3_custom_train.cfg yolov3_custom_train_2000.weights</span></pre><blockquote class="pz"><p id="c5d5" class="qa qb it bd qc qd qe qf qg qh qi lz dk translated">就是这样！！感谢您通读整篇文章</p></blockquote><h2 id="7a4c" class="mf mg it bd mh mi qj dn mk ml qk dp mn ma ql mp mq mb qm ms mt mc qn mv mw mx bi translated">为了部署这个经过训练的模型，请看看我的下一篇文章—</h2><div class="nk nl gp gr nm nn"><a rel="noopener follow" target="_blank" href="/real-time-custom-object-detection-a95d955cecda"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">实时自定义对象检测</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">测试用于对象检测的定制训练暗网模型</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="qo l pl pm pn pj po ni nn"/></div></div></a></div><blockquote class="la lb lc"><p id="5795" class="ld le lf lg b lh li ju lj lk ll jx lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">想了解更多关于暗网的信息，请点击这个链接</p></blockquote><div class="nk nl gp gr nm nn"><a href="https://pjreddie.com/darknet/" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">darknet:C语言中的开源神经网络</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">darknet:c语言中的开源神经网络。</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">pjreddie.com</p></div></div><div class="pj l"><div class="qp l pl pm pn pj po ni nn"/></div></div></a></div></div></div>    
</body>
</html>