<html>
<head>
<title>Hyperparameter Tuning with Python: Complete Step-by-Step Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 进行超参数调优:完整的分步指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hyperparameter-tuning-with-python-keras-xgboost-guide-7cb3ef480f9c?source=collection_archive---------8-----------------------#2020-03-13">https://towardsdatascience.com/hyperparameter-tuning-with-python-keras-xgboost-guide-7cb3ef480f9c?source=collection_archive---------8-----------------------#2020-03-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="745a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为什么以及如何使用示例<strong class="ak"> Keras </strong> / <strong class="ak"> XGBoost </strong></h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dd5f614e83e187080936c3e10c5ce680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BmSCDp3q9mqCQZJn.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://stock.adobe.com/ca/images/businesswoman-in-suit-and-ballet-shoes-jumping-with-coffee-and-digital-tablet-isolated-on-grey/189458703" rel="noopener ugc nofollow" target="_blank">土坯股票</a></p></figure><p id="f396" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们都喜欢建立机器学习或统计模型。但是，一个经常被忽略的重要步骤是<strong class="lb iu">超参数调整</strong>。</p><p id="cc0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，你会看到:</p><ul class=""><li id="2cdf" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">为什么要使用</strong>这种机器学习技术。</li><li id="6791" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">如何使用</strong>搭配<strong class="lb iu"> Keras </strong>(深度学习神经网络)<strong class="lb iu"> Tensorflow </strong>搭配<strong class="lb iu"> Python </strong>。<br/>本文是文章<a class="ae ky" href="https://www.justintodata.com/hyperparameter-tuning-with-python-complete-step-by-step-guide/" rel="noopener ugc nofollow" target="_blank">用 Python 调优超参数:完整分步指南</a>的配套文章。要查看关于<strong class="lb iu"> XGBoost </strong>的示例，请阅读上一篇文章。</li></ul><p id="ecde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想更快更远地提高你的模型的性能，让我们开始吧！</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="ab21" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">常见问题解答:什么是超参数调整/优化，为什么</h1><h2 id="74c2" class="nj ms it bd mt nk nl dn mx nm nn dp nb li no np nd lm nq nr nf lq ns nt nh nu bi translated">超参数到底是什么？</h2><blockquote class="nv nw nx"><p id="f4f3" class="kz la mj lb b lc ld ju le lf lg jx lh ny lj lk ll nz ln lo lp oa lr ls lt lu im bi translated"><strong class="lb iu">超参数</strong>是一个参数，其值在学习过程开始前设置。</p><p id="b051" class="kz la mj lb b lc ld ju le lf lg jx lh ny lj lk ll nz ln lo lp oa lr ls lt lu im bi translated">相比之下，其他<strong class="lb iu">参数</strong>的值是通过训练数据得出的。</p><p id="628c" class="kz la mj lb b lc ld ju le lf lg jx lh ny lj lk ll nz ln lo lp oa lr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Hyperparameter_(machine_learning)" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></blockquote><p id="243f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，神经网络有许多超参数，包括:</p><ul class=""><li id="bad3" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">隐藏层数</li><li id="3624" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">神经元数量</li><li id="154c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">学习率</li><li id="17a4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">激活功能</li><li id="51d5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">和优化器设置</li></ul><h2 id="b6fc" class="nj ms it bd mt nk nl dn mx nm nn dp nb li no np nd lm nq nr nf lq ns nt nh nu bi translated">我们为什么要关心这些超参数？</h2><p id="28c6" class="pw-post-body-paragraph kz la it lb b lc ob ju le lf oc jx lh li od lk ll lm oe lo lp lq of ls lt lu im bi translated">因为这些<strong class="lb iu"> </strong>超参数对于机器学习模型的性能、速度和质量至关重要。因此，我们应该优化它们。</p><blockquote class="nv nw nx"><p id="ce57" class="kz la mj lb b lc ld ju le lf lg jx lh ny lj lk ll nz ln lo lp oa lr ls lt lu im bi translated">超参数优化找到一个超参数元组，该元组产生一个最佳模型，该模型最小化给定测试数据上的预定义损失函数。目标函数采用一组超参数，并返回相关的损失。</p><p id="d560" class="kz la mj lb b lc ld ju le lf lg jx lh ny lj lk ll nz ln lo lp oa lr ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Hyperparameter_optimization" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></blockquote><p id="a0fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是这些超参数看起来都很复杂。将它们结合在一起会导致更高维的问题，这甚至更糟糕。</p><p id="f026" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们应该如何选择这些超参数的值？</p><p id="4e88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，我们根据自己的经验并通过反复试验的过程来选择它们。它是非常手动的，并不能保证我们的模型是最好的。</p><h2 id="fcb9" class="nj ms it bd mt nk nl dn mx nm nn dp nb li no np nd lm nq nr nf lq ns nt nh nu bi translated">有什么更好的方法来调优超参数？</h2><p id="f8cb" class="pw-post-body-paragraph kz la it lb b lc ob ju le lf oc jx lh li od lk ll lm oe lo lp lq of ls lt lu im bi translated">我们需要一个系统的方法来优化它们。</p><p id="930e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有网格搜索、随机搜索等基本技术；还有更复杂的技术，如贝叶斯优化，进化优化。</p><p id="cc3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然我们没有涵盖这些方法的细节，但看看<a class="ae ky" href="https://en.wikipedia.org/wiki/Hyperparameter_optimization#Approaches" rel="noopener ugc nofollow" target="_blank">维基百科</a>或【YouTube 视频了解详情。</p><p id="07fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们一步一步地看看超参数调优。</p><p id="e5a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">相关文章:</strong> <a class="ae ky" href="https://www.justintodata.com/coronavirus-death-rate-with-hyperparameter-tuning/" rel="noopener ugc nofollow" target="_blank">超参数调优的冠状病毒死亡率是多少</a></p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="be01" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">步骤#1:预处理数据</h1><p id="5e6c" class="pw-post-body-paragraph kz la it lb b lc ob ju le lf oc jx lh li od lk ll lm oe lo lp lq of ls lt lu im bi translated">在本帖中，我们使用来自 Kaggle 的<a class="ae ky" href="https://www.kaggle.com/c/sberbank-russian-housing-market/overview/description" rel="noopener ugc nofollow" target="_blank">俄罗斯住房数据集</a>。这个项目的目标是预测俄罗斯的房价波动。我们不会为它找到最好的模型，而只是将它作为一个例子。</p><p id="2694" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们开始构建模型之前，让我们先来看看它。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/44a312b0fea9e5e5aa36d1538846c763.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vAfZzBKYoYqCTclQ.png"/></div></div></figure><p id="13d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了准备用于建模演示的数据<em class="mj"> df </em>，我们仅通过以下方式对其进行轻微处理:</p><ul class=""><li id="5b6c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">将目标<em class="mj"> log(price_doc) </em>(房价的对数)，作为<em class="mj"> y </em>，与其余的数字特征，作为<em class="mj"> X </em>。<br/>在本例中，我们将只使用数字特征。</li><li id="c28b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用数值要素的中值输入缺失值。</li><li id="1ae1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">将 X 和 y 进一步拆分为训练和测试数据集。</li><li id="2d4a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">为训练数据集和测试数据集缩放特征。<br/>如果不进行转换，数据集无法适合神经网络。</li></ul><p id="bdce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们有了一个新的训练数据集<em class="mj"> X_train_scaled </em>，其中 90%的数据来自原始数据集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="c4a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">相关文章:</strong><a class="ae ky" href="https://www.justintodata.com/data-cleaning-python-ultimate-guide/" rel="noopener ugc nofollow" target="_blank">Python 中的数据清理:终极指南(2020) </a> <br/>在之前的这篇文章中，我们探索了使用相同数据集的数据清理技术。</p><h1 id="59ff" class="mr ms it bd mt mu oj mw mx my ok na nb jz ol ka nd kc om kd nf kf on kg nh ni bi translated">步骤#2:定义优化的目标</h1><p id="4941" class="pw-post-body-paragraph kz la it lb b lc ob ju le lf oc jx lh li od lk ll lm oe lo lp lq of ls lt lu im bi translated">在开始调优过程之前，我们必须为超参数优化定义一个目标函数。</p><p id="0651" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用<a class="ae ky" href="https://www.tensorflow.org/guide/keras" rel="noopener ugc nofollow" target="_blank"> Tensorflow Keras </a>对房价建模。这是一个用于 Python 的深度学习神经网络 API。</p><p id="3130" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要建立一个模型<em class="mj"> get_keras_model </em>。这个函数定义了<a class="ae ky" href="https://en.wikipedia.org/wiki/Multilayer_perceptron" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">多层感知器</strong> </a> (MLP)，这是最简单的深度学习神经网络。MLP 至少由三层节点组成:输入层、隐藏层和输出层。</p><p id="093e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后基于该模型，我们创建目标函数<em class="mj"> keras_mlp_cv_score </em>如下:</p><ul class=""><li id="4287" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">关键输入<em class="mj">参数化</em>包括将被调整的 MLP 的超参数:<br/>–数量 _ 隐藏 _ 层数<br/>–神经元 _ 每层<br/>–丢弃 _ 速率<br/>–激活<br/>–优化器<br/>–学习 _ 速率<br/>–批处理 _ 大小</li><li id="0e30" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Mean_squared_error" rel="noopener ugc nofollow" target="_blank"> MSE </a>(均方误差)用作得分/损失函数，该函数将在超参数优化中最小化。</li><li id="dfad" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">我们还使用交叉验证来计算给定的一组超参数值的得分(MSE)。</li></ul><p id="7ab5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于任何一组给定的超参数值，该函数基于交叉验证返回得分的平均值和标准差(MSE)。</p><p id="79be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在下面的 Python 代码中看到详细信息。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="19c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据我们自己的经验，我们还为将要调整的超参数值设置了限制。</p><p id="e4c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">选择这些限值没有一致的方法。你需要理解这些超参数并做出决定。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><h1 id="7a50" class="mr ms it bd mt mu oj mw mx my ok na nb jz ol ka nd kc om kd nf kf on kg nh ni bi translated">步骤 3:选择包:Ax</h1><p id="c783" class="pw-post-body-paragraph kz la it lb b lc ob ju le lf oc jx lh li od lk ll lm oe lo lp lq of ls lt lu im bi translated">在我们之前的文章(<a class="ae ky" href="https://www.justintodata.com/coronavirus-death-rate-with-hyperparameter-tuning/" rel="noopener ugc nofollow" target="_blank">什么是使用超参数调整的冠状病毒死亡率</a>)中，我们使用<a class="ae ky" href="https://github.com/hyperopt/hyperopt" rel="noopener ugc nofollow" target="_blank">hyperpt</a>包应用了超参数调整。虽然它是一个流行的包，但我们发现它使用起来很笨拙，并且缺乏好的文档。</p><p id="3a76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们一直在寻找其他包，最终找到了<a class="ae ky" href="https://ax.dev/" rel="noopener ugc nofollow" target="_blank"> Ax </a>(自适应实验平台)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bff33265464cb51870e8094e0f6da5a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*J4SJWzCYGVUguBZy.png"/></div></div></figure><p id="63ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Ax 是一个新的平台，有助于优化任何类型的实验，包括机器学习、A/B 测试和模拟。它是由脸书开发的，现在是脸书开源项目的一部分。</p><p id="71de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们选择它是因为它:</p><ul class=""><li id="c253" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">内置特性，支持将结果保存到 JSON 文件或 MySQL 数据库。</li><li id="4729" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">从属参数约束的支持。<br/>比如我们可以将参数 m 和 n 的界限设置为 1 &lt; m &lt; 10，0 &lt; n &lt; 10，m*n &gt; 10。而其他大多数软件包不支持 m*n &gt; 10 条件。</li><li id="38c5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">良好的可视化功能。</li><li id="44e1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">体面的文件。<br/>虽然不是全部清晰，但比其他包装如远视要好。</li></ul><p id="536d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Ax 也有三种不同的 API(使用模式)用于超参数调整:</p><ul class=""><li id="369f" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">循环 API </strong>使用起来最简单。但是它不允许足够的定制。</li><li id="5c78" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">服务 API </strong>比循环 API 允许更多的控制，尤其是对试验的控制。这种控制很有价值，因为:<br/>–您可以将试验安排在不同的时间进行，甚至可以与其他试验同时进行。<br/>–您还可以在每次试验后保存进度，而不是等到所有试验完成后才看到结果。</li><li id="63d2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">开发者 API </strong>允许最多的控制，但需要最多的知识，这并不容易，因为:<br/>–特性的文档并不都很清楚。<br/>–网站上的例子没有显示优化后如何获得最佳参数。<br/>–你经常需要浏览 API 来完成这个过程。</li></ul><p id="86b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于 Loop API 的局限性和缺乏明确的开发者 API 示例，我们将使用<em class="mj">服务 API </em>。</p><p id="effa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">相关文章:</strong> <a class="ae ky" href="https://www.justintodata.com/coronavirus-death-rate-with-hyperparameter-tuning/" rel="noopener ugc nofollow" target="_blank">超参数调优的冠状病毒死亡率是多少</a></p><h1 id="11d2" class="mr ms it bd mt mu oj mw mx my ok na nb jz ol ka nd kc om kd nf kf on kg nh ni bi translated">步骤#4:优化/调整超参数</h1><p id="44d3" class="pw-post-body-paragraph kz la it lb b lc ob ju le lf oc jx lh li od lk ll lm oe lo lp lq of ls lt lu im bi translated">最后，我们可以开始优化过程。</p><p id="ba1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在服务 API 中，我们不需要太多关于 Ax 数据结构的知识。所以我们可以按照它的<a class="ae ky" href="https://ax.dev/docs/api.html" rel="noopener ugc nofollow" target="_blank">样本代码</a>来设置结构。</p><p id="a67c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们用之前构建的目标函数和超参数列表创建实验<em class="mj"> keras_experiment </em>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="7fa6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行上面的代码后，您会看到下面的日志记录。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/2fab3c470431f072b342b6da7c503da1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-d66igKWnZ69D7dG.png"/></div></div></figure><p id="e0aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如前所述，有不同的方法来搜索超参数的最佳值。根据<em class="mj">generation _ strategy</em>的<a class="ae ky" href="https://ax.dev/api/service.html#ax-client" rel="noopener ugc nofollow" target="_blank"> Ax_client 文档，如果没有显式选择，则根据搜索空间的属性智能选择方法。从注释中可以看出，Ax_client 在本练习中选择了</a><a class="ae ky" href="https://en.wikipedia.org/wiki/Sobol_sequence" rel="noopener ugc nofollow" target="_blank"> <em class="mj"> Sobol </em> </a>(一种统一搜索)。</p><p id="20c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们运行实验来评估不同的超参数值。</p><p id="622c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于这个项目只是为了演示，我们进行了少量的 25 次试验。</p><p id="361d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个试验评估超参数值的可能组合，并从 keras_mlp_cv_score 函数中输出分数。Ax_client 跟踪参数和分数的历史，并智能地猜测下一组更好的参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="1f11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着代码的运行，您还可以看到每次试验的日志记录。</p><h1 id="2053" class="mr ms it bd mt mu oj mw mx my ok na nb jz ol ka nd kc om kd nf kf on kg nh ni bi translated">步骤 5:打印/可视化结果</h1><h2 id="256b" class="nj ms it bd mt nk nl dn mx nm nn dp nb li no np nd lm nq nr nf lq ns nt nh nu bi translated">打印结果</h2><p id="7c9a" class="pw-post-body-paragraph kz la it lb b lc ob ju le lf oc jx lh li od lk ll lm oe lo lp lq of ls lt lu im bi translated">要以表格的形式查看结果，您可以使用下面的代码将其打印出来。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/dc3068d2ff56202fd433435ab7d12bff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uVdgoC8zUlO3OxFe.png"/></div></div></figure><p id="7488" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了查看超参数的最佳值，我们使用下面的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/4d7937caa189408c50fa270ece824d29.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/0*C9Kx4iSi2XAq_Q2t.png"/></div></figure><h2 id="4842" class="nj ms it bd mt nk nl dn mx nm nn dp nb li no np nd lm nq nr nf lq ns nt nh nu bi translated">可视化结果</h2><p id="41c8" class="pw-post-body-paragraph kz la it lb b lc ob ju le lf oc jx lh li od lk ll lm oe lo lp lq of ls lt lu im bi translated">除了打印数字之外，您还可以可视化结果。</p><p id="255e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以绘制 keras_cv 分数在迭代过程中的演变。可以看到，经过 2 次迭代/尝试，分数达到了最小值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/96340aa92ffcb49f6e09e88298f3b285.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yvVAUBk0SkjeLd4b.png"/></div></div></figure><h2 id="493f" class="nj ms it bd mt nk nl dn mx nm nn dp nb li no np nd lm nq nr nf lq ns nt nh nu bi translated">评估结果</h2><p id="e3fa" class="pw-post-body-paragraph kz la it lb b lc ob ju le lf oc jx lh li od lk ll lm oe lo lp lq of ls lt lu im bi translated">另外，我们可以使用这个模型对测试数据集进行预测。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><p id="2a53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下 Python 代码打印出的测试结果的 MSE 为 0.30，与训练数据集中的 MSE 接近。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure><h1 id="3bb8" class="mr ms it bd mt mu oj mw mx my ok na nb jz ol ka nd kc om kd nf kf on kg nh ni bi translated">步骤#6:保存结果—可选</h1><p id="84f5" class="pw-post-body-paragraph kz la it lb b lc ob ju le lf oc jx lh li od lk ll lm oe lo lp lq of ls lt lu im bi translated">如前所述，Ax 还允许我们将流程保存到 JSON 文件中。</p><p id="8b6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们想暂停并在以后继续这个过程时，这很方便。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="og oh l"/></div></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><p id="3e68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样。你做到了！如果你有任何问题，请留言。</p><p id="7ebf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想看一个 Python 中 XGBoost 的例子，请阅读<a class="ae ky" href="https://www.justintodata.com/hyperparameter-tuning-with-python-complete-step-by-step-guide/" rel="noopener ugc nofollow" target="_blank">Hyperparameter Tuning with Python:Complete Step-by-Step Guide</a>。</p><p id="a25c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">离开之前，别忘了去<a class="ae ky" href="https://www.justintodata.com/" rel="noopener ugc nofollow" target="_blank"> <em class="mj">报名参加刚刚进入数据通迅的</em> </a>！或者通过<a class="ae ky" href="https://twitter.com/JustintoData" rel="noopener ugc nofollow" target="_blank">推特</a>、<a class="ae ky" href="https://www.facebook.com/justintodata/" rel="noopener ugc nofollow" target="_blank">脸书</a>与我们联系。<br/>因此，您<em class="mj">不会</em>错过我们的任何新数据科学文章。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><p id="edb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mj">原载于 2020 年 3 月 13 日 https://www.justintodata.com</em><a class="ae ky" href="https://www.justintodata.com/hyperparameter-tuning-with-python-keras-guide/" rel="noopener ugc nofollow" target="_blank"><em class="mj"/></a><em class="mj">。</em></p><div class="or os gp gr ot ou"><a href="https://www.justintodata.com/use-nlp-in-python-practical-step-by-step-example/" rel="noopener  ugc nofollow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd iu gy z fp oz fr fs pa fu fw is bi translated">如何在 Python 中使用 NLP:一个实用的分步示例——只进入数据</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">这是 Python 中超参数调优的实用指南。要提高模型的性能，请学习:-为什么你…</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">www.justintodata.com</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi ks ou"/></div></div></a></div><div class="or os gp gr ot ou"><a href="https://www.justintodata.com/improve-sports-betting-odds-guide-in-python/" rel="noopener  ugc nofollow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd iu gy z fp oz fr fs pa fu fw is bi translated">如何提高体育博彩赔率 Python 中的一步一步指南-只是进入数据</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">体育博彩可能不仅仅是利用你的直觉。查看我用来赚 20，000 美元的数据科学策略…</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">www.justintodata.com</p></div></div><div class="pd l"><div class="pj l pf pg ph pd pi ks ou"/></div></div></a></div><div class="or os gp gr ot ou"><a href="https://www.justintodata.com/data-cleaning-python-ultimate-guide/" rel="noopener  ugc nofollow" target="_blank"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd iu gy z fp oz fr fs pa fu fw is bi translated">Python 中的数据清理:终极指南(2020)——只进入数据</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">我们用 Python 创建了这个新的完整的分步指南。你将学习如何寻找和清理的技巧:丢失…</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">www.justintodata.com</p></div></div><div class="pd l"><div class="pk l pf pg ph pd pi ks ou"/></div></div></a></div></div></div>    
</body>
</html>