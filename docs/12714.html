<html>
<head>
<title>Ditch Excel! — A Primer to Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">抛弃 Excel！Python 入门</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-ditch-excel-a-primer-to-python-c4a9c192e993?source=collection_archive---------27-----------------------#2020-09-01">https://towardsdatascience.com/how-to-ditch-excel-a-primer-to-python-c4a9c192e993?source=collection_archive---------27-----------------------#2020-09-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="eae8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">熊猫流行 excel 的一行程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d95cb7d3e04a152c839baf7f8862f170.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6NanoRir5cR30D-t"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">约瑟夫·陈(Joseph Chan)在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片:Excel 是这位甜美的女士第一次实习时发明的</p></figure><p id="27cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Excel 过去是，现在是，将来也永远是一个优秀的工具。它的精巧令人敬畏，优雅超越贝拉·哈迪德。自从 python 出现以来，人们很难忽视它提供的易用性和灵活性。该说的都说了，该做的都做了，继续前进仍然是最大的数据优势。因此，不管你是哪种类型的数据人，或者即使你只是偶尔使用它，习惯 python 也是值得的(它是免费的)。你会问为什么是 Python？</p><ol class=""><li id="08fc" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">如果能够超越就像组装宜家家具，那么能够 python 就像做木匠。你可以创造更多的奇迹。</li><li id="98cd" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">因为其他人都在这么做。</li><li id="5c81" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">用乔治·马洛里的话说，因为它就在那里。</li></ol><p id="90e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从一些基本功能开始。为了简单起见，我们只谈熊猫图书馆。启动 python 并执行以下操作:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="d58c" class="mo mp it mk b gy mq mr l ms mt">import pandas as pd</span></pre><p id="1635" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，将所有文件读入文件名变量:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="f753" class="mo mp it mk b gy mq mr l ms mt">file1 = pd.read_excel(‘path/to/your/file1.xlsx’)</span></pre><h1 id="bfd3" class="mu mp it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">Excel: VLOOKUP</h1><p id="808d" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated"><strong class="lb iu">熊猫等同:</strong>合并</p><p id="abf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用 VLOOKUP，您可以尝试从另一个文件中的一个 excel 列中查找一个值。您将首先:</p><p id="8d57" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">a.在所需的列上按字母顺序对两个文件进行排序</p><p id="2727" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">b.使用公式:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="ecfa" class="mo mp it mk b gy mq mr l ms mt">=VLOOKUP(A2, Area in columns, column to be returned,FALSE)</span></pre><p id="86c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">来获得输出。</p><p id="a85e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">熊猫的对等词是一个更简单、更容易理解的合并词。这与在所需的公共列上连接数据集是一样的。在将文件 1 和 2 作为文件 1 和文件 2 导入和读入后，它是一条语句:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="d911" class="mo mp it mk b gy mq mr l ms mt">file1 = file1.merge(file2[['columns', 'you', 'want', 'to' ,'return']], how=’left’,on=’common-column-to-look-for’)</span></pre><p id="22b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧啊。</p><p id="e249" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在保存您的结果:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="5ade" class="mo mp it mk b gy mq mr l ms mt">pd.to_excel('save/here/path/filename.xlsx')</span></pre><h1 id="c9d1" class="mu mp it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">COUNTIF</h1><p id="9974" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated"><strong class="lb iu">熊猫等值:</strong> value_counts()</p><p id="4e44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，您会希望计算一个列中某个元素的出现次数。在 excel 中，您可以这样做:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="9503" class="mo mp it mk b gy mq mr l ms mt">=COUNTIF(area-to-search,value-to-search-for)(#and drag it down)</span></pre><p id="6162" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，您将删除重复项以获取值计数。</p><p id="6d4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 pandas 中，您可以使用下面的一个命令行程序来实现这一点:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="4aa0" class="mo mp it mk b gy mq mr l ms mt">file1[‘Column which needs counting’].value_counts()</span></pre><p id="0104" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧啊。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/1519510f0351b1a5d6cbc8545d2980b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*lCpu6cWUkq4jVKvKc6DGlg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">value_counts()结果</p></figure><h1 id="b3c3" class="mu mp it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">整齐</h1><p id="babc" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated"><strong class="lb iu">pandas equivalent:</strong>str . strip()</p><p id="9563" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在大多数文件中，看不见的空白是一种真正的痛苦。在 excel 中，我们创建一个新列并应用公式</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="9313" class="mo mp it mk b gy mq mr l ms mt">= TRIM('cell which needs trimming') #and drag it down</span></pre><p id="48ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对熊猫来说，这又是一句俏皮话:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="651c" class="mo mp it mk b gy mq mr l ms mt">file1.column_that_needs_stripping = file1.column_that_needs_stripping.str.strip()</span></pre><h1 id="134b" class="mu mp it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">删除所有空间</h1><p id="50d3" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated"><strong class="lb iu">pandas equivalent:</strong>str . replace(" "，"")</p><p id="21aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，修剪是不够的。整个列中都有不需要的空间。我习惯于在 excel 中选择列，搜索和替换空格。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/8eca0d79ca9394e9098df37db48edbbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*7Eeiig7CeilMmAo2b8Wltg.png"/></div></figure><p id="08a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas 提供了一个简单的解决方案来替换列的所有字符串中的空格:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="89d3" class="mo mp it mk b gy mq mr l ms mt">file1[‘column_to_delete_all_spaces’] = file1[‘column_to_delete_all_spaces’].str.replace(" ","")</span></pre><h1 id="7e04" class="mu mp it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">串联</h1><p id="1daf" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated"><strong class="lb iu">熊猫等值:</strong> +</p><p id="b748" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">字符串连接是 excel 中另一种流行的方法。假设您想要连接多个单元格，您可以在 excel 中这样做:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="dc22" class="mo mp it mk b gy mq mr l ms mt">= CONCATENATE(Cell1,Cell2,Cell3,Cell4……)</span></pre><p id="2f36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">找到每一个单元格并把它打下来真的很乏味。熊猫也为此提供了一个优雅的俏皮话，如下:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="cd92" class="mo mp it mk b gy mq mr l ms mt">file1['new_column']= file1['first_col'] +’if_space_or_other_string_needed_here’+ file1['second_column']</span></pre><h1 id="d91f" class="mu mp it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">CountA</h1><p id="0b0b" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated"><strong class="lb iu">熊猫当量:</strong>。notnull()。总和( )</p><p id="68d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Excel 的 CountA 对选定区域中所有非零单元格进行计数，并返回所有包含某些值的单元格。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="0b37" class="mo mp it mk b gy mq mr l ms mt">= COUNTA(range)</span></pre><p id="eac3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">计算非零值的 pandas 等价的一行程序如下:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="e483" class="mo mp it mk b gy mq mr l ms mt">file1[‘column_to_count’].notnull().sum()</span></pre><p id="e1d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，如果您想获得所有为 null 的列值，您可以将 notnull 更改为 isnull，瞧！</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="2999" class="mo mp it mk b gy mq mr l ms mt">file1[‘column_to_count’].isnull().sum()</span></pre><h1 id="cd3e" class="mu mp it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">IFERROR</h1><p id="e071" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated"><strong class="lb iu">熊猫等同:</strong>菲尔娜( )</p><p id="e9bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过定义一个错误填充值，可以用 IFERROR 在 excel 中处理诸如零除法错误之类的错误。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="6c38" class="mo mp it mk b gy mq mr l ms mt">= IFERROR(Formula that might have an error, “Value to return if error occurs”)</span></pre><p id="c3ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 pandas 中，您可以通过使用 fillna()来完成这种错误处理</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="330f" class="mo mp it mk b gy mq mr l ms mt">file1 = file1.fillna('Value_you_want_to_fill')</span></pre><h1 id="5ced" class="mu mp it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">左/右</h1><p id="5a93" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">在 excel 中，您可以使用以下公式提取左侧 n 个数字或字母:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="026b" class="mo mp it mk b gy mq mr l ms mt">= LEFT(Cell, number of digits you want)<br/>= RIGHT(Cell, number of digits you want)</span></pre><p id="1a29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与此相对应的熊猫如下。<em class="ns">将“:”符号读作直到或从:</em></p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="3780" class="mo mp it mk b gy mq mr l ms mt">left_five_digits = file1['column'].str[:5]</span><span id="43a3" class="mo mp it mk b gy nt mr l ms mt">right_five_digits = file1['column'].str[-5:]<br/>#the minus indicates 5 from the end, without minus, it means 5 from left</span></pre></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><p id="0f08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些是我每天经常在 excel 中使用的函数，现在我经常在 python 中以惊人的速度使用它们。我希望这本书能激励你做出改变，因为每一秒都是值得的。</p></div></div>    
</body>
</html>