<html>
<head>
<title>Create a complex Machine Learning model in one line with Libra</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Libra 创建一个复杂的机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-a-complex-machine-learning-model-in-one-line-with-libra-a253e05d15a1?source=collection_archive---------51-----------------------#2020-07-31">https://towardsdatascience.com/create-a-complex-machine-learning-model-in-one-line-with-libra-a253e05d15a1?source=collection_archive---------51-----------------------#2020-07-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6699" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">非专家使用的一行建模查询</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c74504f4a346421736747c806cef9dd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HTLKRuCuk0wgy-cm"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">韦斯·希克斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="5c2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在最近一段时间，有许多与数据相关的项目爆炸，尤其是以机器学习为骨干的项目。在商业行业项目中，许多机器学习被应用于创建预测模型(预测事件、搅动、欺诈等)。).</p><p id="9ab3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有机器学习的问题是，我们需要学习复杂的代码，结果有时对于非专家来说太复杂了。</p><p id="9a5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基于以上原因，现在有一个面向非专家的机器学习 python 包叫做<a class="ae ky" href="https://medium.com/@funpalash/machine-learning-in-one-line-of-code-c2c7cdb4983e" rel="noopener"> Libra </a>。这个包的前提很简单:<strong class="lb iu">他们优先考虑易用性和人体工程学；</strong>意思是用尽可能少的行创建一个机器学习模型。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9d3b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">磅</h1><p id="0921" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">那么，这个天秤座套餐到底是什么？根据他们的说法，它是一个机器学习 API，让我们只需一行代码就可以构建和部署机器学习。多整洁啊！</p><p id="ac04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，目标检测、预处理和评分是默认完成的。我们只需要选择模型并输入数据。</p><p id="dd11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们试试它是如何工作的。</p><p id="6c14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们安装 Libra 包之前，我们需要安装 Python 3.6 或更高版本。任何低于这个数字的都不行。要安装这个包，我们只需要在命令提示符下运行下面的代码。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="c273" class="ne md it na b gy nf ng l nh ni"><strong class="na iu">pip install libra</strong></span></pre><p id="5494" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在你安装完这个包之后，我们会尝试这个包是如何工作的。让我们准备好所有需要用到的东西。首先，出于我们学习的目的，我将使用来自 Kaggle 的关于教育的数据集<a class="ae ky" href="https://www.kaggle.com/aljarah/xAPI-Edu-Data" rel="noopener ugc nofollow" target="_blank">这里是</a>。下图是数据信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/691ce0d0a616157f96b6327950db213f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*iPhcsTvSGHqL-IK9TigyHg.png"/></div></figure><p id="4672" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，假设我们想要创建一个预测模型来对类列进行分类。利用天秤座，一切都变得简单了。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="da66" class="ne md it na b gy nf ng l nh ni">#The only thing we need to import</span><span id="b158" class="ne md it na b gy nk ng l nh ni"><strong class="na iu">from libra import client</strong></span></pre><p id="7b59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Libra 中，数据集仍然需要从外部读取；比如说 CSV 文件。这就是为什么我们要创建一个直接读取文件的客户端类。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="4dfa" class="ne md it na b gy nf ng l nh ni">#Creating a client object that read the data to create the prediction model</span><span id="18f4" class="ne md it na b gy nk ng l nh ni"><strong class="na iu">edu_client = client('xAPI-Edu-Data.csv')</strong></span></pre><p id="9ffa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码是我们所需要的；下一部分更像是以我们想要的方式查询模型，并立即得到结果。</p><p id="f533" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前，Libra 中唯一的<a class="ae ky" href="https://libradocs.github.io/html/modeling.html" rel="noopener ugc nofollow" target="_blank">机器学习模型是:</a></p><ul class=""><li id="c8fd" class="nl nm it lb b lc ld lf lg li nn lm no lq np lu nq nr ns nt bi translated">神经网络</li><li id="dd7f" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">卷积神经网络</li><li id="9e89" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">支持向量机</li><li id="f0e7" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">最近的邻居</li><li id="0aa8" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">决策图表</li><li id="f49c" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">k 均值聚类</li></ul><p id="49a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有<a class="ae ky" href="https://libradocs.github.io/html/nlp.html" rel="noopener ugc nofollow" target="_blank">几种自然语言处理</a>，包括:</p><ul class=""><li id="f6c5" class="nl nm it lb b lc ld lf lg li nn lm no lq np lu nq nr ns nt bi translated">文本分类</li><li id="df35" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">文档摘要</li><li id="704e" class="nl nm it lb b lc nu lf nv li nw lm nx lq ny lu nq nr ns nt bi translated">图像字幕生成</li></ul><p id="d844" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然，对于我们的情况，我们只会尝试使用神经网络模型。让我们试着创建预测模型。为了创建预测模型，我们需要从客户端方法调用我们想要的机器学习。</p><p id="d713" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的例子中，应该是<code class="fe nz oa ob na b">.neural_network_query</code>在参数中接受一个文本。我们传递的查询是一个简单的英文文本，如<strong class="lb iu"><em class="oc">‘classify the class’</em></strong>或<strong class="lb iu"><em class="oc">‘estimate accurate the StudentAbsenceDays’</em></strong>。重要的是目标列；您需要在查询中指定它。之后，API 会预测这是一个分类问题还是回归问题。让我们看看下面的例子。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="308a" class="ne md it na b gy nf ng l nh ni">#Creating the model by simple query, for example classify the class. Using Libra, you would need to specify which column you want as the target and the rest would be preprocessed automatically</span><span id="3ce5" class="ne md it na b gy nk ng l nh ni"><strong class="na iu">edu_client.neural_network_query('classify the class')</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/6da61cda5931acce5497b4a89aaf9dff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vi8mCGjo6h3y3M1d4ORI3g.png"/></div></div></figure><p id="8b2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">只需使用一个简单的查询，就可以自动对模型进行预处理，并启动学习过程。此外，所有的重复过程和指标也会立即显示出来。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/8358290efe166c330c131a286933b9a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*6ZpoxEeFOF_I_-iHzKR2BA.png"/></div></figure><p id="1653" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，该模型为我们提供了每个时期的精度和模型损失图。</p><p id="dd5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想知道你能在模型中传递的所有参数，请在这里查阅<a class="ae ky" href="https://libradocs.github.io/html/modeling.html" rel="noopener ugc nofollow" target="_blank"> API 指南</a>。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="0d70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Libra 还提供了对模型更深入的分析。我们可以通过运行下面的代码来访问分析。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="ff1d" class="ne md it na b gy nf ng l nh ni"><strong class="na iu">edu_client.analyze()</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/d10213345432ea1f15e62074148d813d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*LFQTr9g5piyjPPvHV-j5PQ.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/1525e13c612bf10bcaba03f13d586d59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*Ki8X8DVkn747378ZHUJekw.png"/></div></figure><p id="ec7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面，我们得到了总体指标，包括 ROC 曲线和混淆矩阵。有了这个，我们可以更快地分析我们的模型。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8fed" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="d593" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在本文中，我概述了如何使用 Libra 在一个模型中创建机器学习预测。几乎所有繁琐的部分都由 API 完成，我们只需要看到结果。</p><p id="be7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这并不意味着它可以取代数据理解和功能工程，因为 API 的主要部分是创建一个机器学习模型，而不是创建新的功能。</p><p id="ce85" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望有帮助！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="ab07" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如果您喜欢我的内容，并希望获得更多关于数据或数据科学家日常生活的深入知识，请考虑在此订阅我的<a class="ae ky" href="https://cornellius.substack.com/welcome" rel="noopener ugc nofollow" target="_blank">简讯。</a></h1><blockquote class="oh"><p id="d91e" class="oi oj it bd ok ol om on oo op oq lu dk translated">如果您没有订阅为中等会员，请考虑通过<a class="ae ky" href="https://cornelliusyudhawijaya.medium.com/membership" rel="noopener">我的推荐</a>订阅。</p></blockquote></div></div>    
</body>
</html>