<html>
<head>
<title>Grouping Soccer Players with Similar Skillsets in FIFA 20 | Part 1: K-Means Clustering</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">国际足联20 |第1部分:K-均值聚类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/grouping-soccer-players-with-similar-skillsets-in-fifa-20-part-1-k-means-clustering-c4a845db78bc?source=collection_archive---------37-----------------------#2020-06-18">https://towardsdatascience.com/grouping-soccer-players-with-similar-skillsets-in-fifa-20-part-1-k-means-clustering-c4a845db78bc?source=collection_archive---------37-----------------------#2020-06-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="e083" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/clustering-analysis-in-ml" rel="noopener" target="_blank">机器学习中的聚类分析</a></h2><div class=""/><div class=""><h2 id="1664" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">机器学习中的聚类算法教程的第1部分</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/b6d24ac97cd894b883b1a2f562634535.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4jsZ5wM_KfT0bfsvyoR1XA.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/@jesusance?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">托马斯·塞勒</a>在<a class="ae lh" href="/s/photos/soccer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="li lj l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">视频版本</p></figure><h1 id="dbad" class="lk ll it bd lm ln lo lp lq lr ls lt lu ki lv kj lw kl lx km ly ko lz kp ma mb bi translated">介绍</h1><p id="2d88" class="pw-post-body-paragraph mc md it me b mf mg kd mh mi mj kg mk ml mm mn mo mp mq mr ms mt mu mv mw mx im bi translated">足球(欧洲足球)是我从小就喜欢的运动之一。我过去无论去哪里都带着一个球，这样我就可以最大限度地利用踢足球的机会。</p><p id="f681" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">我也喜欢踢足球——国际足联。我觉得用机器学习来分析国际足联的球员会很酷。</p><p id="df54" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">在本教程中，我将使用K-Means聚类算法对FIFA 20中具有相似技能的足球运动员进行分组。</p><h1 id="b224" class="lk ll it bd lm ln lo lp lq lr ls lt lu ki lv kj lw kl lx km ly ko lz kp ma mb bi translated">了解聚类</h1><p id="d4da" class="pw-post-body-paragraph mc md it me b mf mg kd mh mi mj kg mk ml mm mn mo mp mq mr ms mt mu mv mw mx im bi translated">聚类是一种无监督学习技术(PCA是另一种)。</p><p id="1bf8" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">我们可以将观测值聚类(或分组)到相同的子组中，使得子组中的观测值彼此非常相似，而不同子组中的观测值彼此非常不同。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/e68a47f1c0e093ca3cc88379b664a16b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bZGpAE72BAD3r5nzZT3y7g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">聚类示例</p></figure><p id="3d78" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">上面的散点图向我们展示了数据集中有三个不同的组。</p><h1 id="783e" class="lk ll it bd lm ln lo lp lq lr ls lt lu ki lv kj lw kl lx km ly ko lz kp ma mb bi translated">了解K-均值聚类</h1><p id="c4e2" class="pw-post-body-paragraph mc md it me b mf mg kd mh mi mj kg mk ml mm mn mo mp mq mr ms mt mu mv mw mx im bi translated">K-Means聚类是聚类算法的一种。</p><p id="265a" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">基本算法是这样的:</p><ul class=""><li id="70e8" class="ne nf it me b mf my mi mz ml ng mp nh mt ni mx nj nk nl nm bi translated">指定K簇并初始化随机质心</li><li id="a6ac" class="ne nf it me b mf nn mi no ml np mp nq mt nr mx nj nk nl nm bi translated">迭代直到集群分配停止变化。该方法将每个观察精确地分配给K个聚类中的一个</li><li id="c433" class="ne nf it me b mf nn mi no ml np mp nq mt nr mx nj nk nl nm bi translated">对于每个K分类，计算分类平均值</li><li id="4372" class="ne nf it me b mf nn mi no ml np mp nq mt nr mx nj nk nl nm bi translated">继续查看观察值列表，并将一个观察值分配给平均值最接近的群集。</li></ul><p id="eef7" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">目标是以这样一种方式形成聚类，即同一聚类内的观察尽可能相似。</p><p id="abd6" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">K-Means聚类使用平方欧几里得距离计算相似性。</p><h1 id="5f5c" class="lk ll it bd lm ln lo lp lq lr ls lt lu ki lv kj lw kl lx km ly ko lz kp ma mb bi translated"><strong class="ak">数据集</strong></h1><p id="c356" class="pw-post-body-paragraph mc md it me b mf mg kd mh mi mj kg mk ml mm mn mo mp mq mr ms mt mu mv mw mx im bi translated">我们准备用Kaggle的<a class="ae lh" href="https://www.kaggle.com/stefanoleone992/fifa-20-complete-player-dataset/data?select=players_20.csv" rel="noopener ugc nofollow" target="_blank"> <strong class="me jd"> FIFA 20数据集</strong> </a> <strong class="me jd">。</strong></p><h1 id="6384" class="lk ll it bd lm ln lo lp lq lr ls lt lu ki lv kj lw kl lx km ly ko lz kp ma mb bi translated">特征工程</h1><p id="66bf" class="pw-post-body-paragraph mc md it me b mf mg kd mh mi mj kg mk ml mm mn mo mp mq mr ms mt mu mv mw mx im bi translated">我们将只选择数字值和每个玩家的名字。</p><pre class="ks kt ku kv gt ns nt nu nv aw nw bi"><span id="47f9" class="nx ll it nt b gy ny nz l oa ob">df = df[['short_name','age', 'height_cm', 'weight_kg', 'overall', 'potential',</span><span id="d930" class="nx ll it nt b gy oc nz l oa ob">'value_eur', 'wage_eur', 'international_reputation', 'weak_foot',</span><span id="d50a" class="nx ll it nt b gy oc nz l oa ob">'skill_moves', 'release_clause_eur', 'team_jersey_number',</span><span id="6d0c" class="nx ll it nt b gy oc nz l oa ob">'contract_valid_until', 'nation_jersey_number', 'pace', 'shooting',</span><span id="95fd" class="nx ll it nt b gy oc nz l oa ob">'passing', 'dribbling', 'defending', 'physic', 'gk_diving',</span><span id="f441" class="nx ll it nt b gy oc nz l oa ob">'gk_handling', 'gk_kicking', 'gk_reflexes', 'gk_speed',</span><span id="e167" class="nx ll it nt b gy oc nz l oa ob">'gk_positioning', 'attacking_crossing', 'attacking_finishing',</span><span id="2d15" class="nx ll it nt b gy oc nz l oa ob">'attacking_heading_accuracy', 'attacking_short_passing',</span><span id="38b6" class="nx ll it nt b gy oc nz l oa ob">'attacking_volleys', 'skill_dribbling', 'skill_curve',</span><span id="b3ab" class="nx ll it nt b gy oc nz l oa ob">'skill_fk_accuracy', 'skill_long_passing', 'skill_ball_control',</span><span id="15d9" class="nx ll it nt b gy oc nz l oa ob">'movement_acceleration', 'movement_sprint_speed', 'movement_agility',</span><span id="49e1" class="nx ll it nt b gy oc nz l oa ob">'movement_reactions', 'movement_balance', 'power_shot_power',</span><span id="c218" class="nx ll it nt b gy oc nz l oa ob">'power_jumping', 'power_stamina', 'power_strength', 'power_long_shots',</span><span id="48c5" class="nx ll it nt b gy oc nz l oa ob">'mentality_aggression', 'mentality_interceptions',</span><span id="d29c" class="nx ll it nt b gy oc nz l oa ob">'mentality_positioning', 'mentality_vision', 'mentality_penalties',</span><span id="9f22" class="nx ll it nt b gy oc nz l oa ob">'mentality_composure', 'defending_marking', 'defending_standing_tackle',</span><span id="1d02" class="nx ll it nt b gy oc nz l oa ob">'defending_sliding_tackle', 'goalkeeping_diving',</span><span id="f181" class="nx ll it nt b gy oc nz l oa ob">'goalkeeping_handling', 'goalkeeping_kicking',</span><span id="e4eb" class="nx ll it nt b gy oc nz l oa ob">'goalkeeping_positioning', 'goalkeeping_reflexes']]</span></pre><p id="a228" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">我正在抽取工装裤在86以上的玩家，因为我们不想用18000以上的玩家来分组。</p><pre class="ks kt ku kv gt ns nt nu nv aw nw bi"><span id="8c11" class="nx ll it nt b gy ny nz l oa ob">df = df[df.overall &gt; 86] # extracting players with overall above 86</span></pre><p id="05da" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">用平均值替换空值。</p><pre class="ks kt ku kv gt ns nt nu nv aw nw bi"><span id="4b82" class="nx ll it nt b gy ny nz l oa ob">df = df.fillna(df.mean())</span></pre><p id="1709" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">使数据正常化(标准化/重新标度)。</p><ul class=""><li id="6599" class="ne nf it me b mf my mi mz ml ng mp nh mt ni mx nj nk nl nm bi translated">我们希望将数据标准化，因为变量是在不同的尺度上测量的。</li></ul><pre class="ks kt ku kv gt ns nt nu nv aw nw bi"><span id="e51c" class="nx ll it nt b gy ny nz l oa ob">from sklearn import preprocessing</span><span id="8e2b" class="nx ll it nt b gy oc nz l oa ob">x = df.values # numpy array</span><span id="5d4f" class="nx ll it nt b gy oc nz l oa ob">scaler = preprocessing.MinMaxScaler()</span><span id="aafe" class="nx ll it nt b gy oc nz l oa ob">x_scaled = scaler.fit_transform(x)</span><span id="5e03" class="nx ll it nt b gy oc nz l oa ob">X_norm = pd.DataFrame(x_scaled)</span></pre><p id="8104" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">使用主成分分析将该图的60维减少到2维。</p><pre class="ks kt ku kv gt ns nt nu nv aw nw bi"><span id="9a5e" class="nx ll it nt b gy ny nz l oa ob">from sklearn.decomposition import PCA</span><span id="8595" class="nx ll it nt b gy oc nz l oa ob">pca = PCA(n_components = 2) # 2D PCA for the plot</span><span id="9cdb" class="nx ll it nt b gy oc nz l oa ob">reduced = pd.DataFrame(pca.fit_transform(X_norm))</span></pre><h1 id="707b" class="lk ll it bd lm ln lo lp lq lr ls lt lu ki lv kj lw kl lx km ly ko lz kp ma mb bi translated"><strong class="ak">执行K均值聚类</strong></h1><p id="0cc2" class="pw-post-body-paragraph mc md it me b mf mg kd mh mi mj kg mk ml mm mn mo mp mq mr ms mt mu mv mw mx im bi translated">我们将指定有5个集群。</p><pre class="ks kt ku kv gt ns nt nu nv aw nw bi"><span id="b63f" class="nx ll it nt b gy ny nz l oa ob">from sklearn.cluster import KMeans<br/></span><span id="8500" class="nx ll it nt b gy oc nz l oa ob"># specify the number of clusters</span><span id="c3b6" class="nx ll it nt b gy oc nz l oa ob">kmeans = KMeans(n_clusters=5)</span><span id="6c58" class="nx ll it nt b gy oc nz l oa ob"># fit the input data</span><span id="8b11" class="nx ll it nt b gy oc nz l oa ob">kmeans = kmeans.fit(reduced)</span><span id="167c" class="nx ll it nt b gy oc nz l oa ob"># get the cluster labels</span><span id="0fab" class="nx ll it nt b gy oc nz l oa ob">labels = kmeans.predict(reduced)</span><span id="8396" class="nx ll it nt b gy oc nz l oa ob"># centroid values</span><span id="f03e" class="nx ll it nt b gy oc nz l oa ob">centroid = kmeans.cluster_centers_</span><span id="de4f" class="nx ll it nt b gy oc nz l oa ob"># cluster values</span><span id="3c6e" class="nx ll it nt b gy oc nz l oa ob">clusters = kmeans.labels_.tolist()</span></pre><p id="6e8f" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">通过添加玩家的名字和他们的集群创建一个新的数据框。</p><pre class="ks kt ku kv gt ns nt nu nv aw nw bi"><span id="40d8" class="nx ll it nt b gy ny nz l oa ob">reduced['cluster'] = clusters</span><span id="fbe8" class="nx ll it nt b gy oc nz l oa ob">reduced['name'] = names</span><span id="6189" class="nx ll it nt b gy oc nz l oa ob">reduced.columns = ['x', 'y', 'cluster', 'name']</span><span id="d0c7" class="nx ll it nt b gy oc nz l oa ob">reduced.head()</span></pre><h1 id="247c" class="lk ll it bd lm ln lo lp lq lr ls lt lu ki lv kj lw kl lx km ly ko lz kp ma mb bi translated"><strong class="ak">可视化K均值聚类图</strong></h1><pre class="ks kt ku kv gt ns nt nu nv aw nw bi"><span id="534d" class="nx ll it nt b gy ny nz l oa ob">import matplotlib.pyplot as plt</span><span id="bd70" class="nx ll it nt b gy oc nz l oa ob">import seaborn as sns</span><span id="7f00" class="nx ll it nt b gy oc nz l oa ob">%matplotlib inline</span><span id="a338" class="nx ll it nt b gy oc nz l oa ob">sns.set(style="white")</span><span id="700e" class="nx ll it nt b gy oc nz l oa ob">ax = sns.lmplot(x="x", y="y", hue='cluster', data = reduced, legend=False,</span><span id="cbac" class="nx ll it nt b gy oc nz l oa ob">fit_reg=False, size = 15, scatter_kws={"s": 250})</span><span id="5367" class="nx ll it nt b gy oc nz l oa ob">texts = []</span><span id="4f37" class="nx ll it nt b gy oc nz l oa ob">for x, y, s in zip(reduced.x, reduced.y, reduced.name):</span><span id="f2f3" class="nx ll it nt b gy oc nz l oa ob">texts.append(plt.text(x, y, s))</span><span id="5459" class="nx ll it nt b gy oc nz l oa ob">ax.set(ylim=(-2, 2))</span><span id="b19d" class="nx ll it nt b gy oc nz l oa ob">plt.tick_params(labelsize=15)</span><span id="26e2" class="nx ll it nt b gy oc nz l oa ob">plt.xlabel("PC 1", fontsize = 20)</span><span id="7c5e" class="nx ll it nt b gy oc nz l oa ob">plt.ylabel("PC 2", fontsize = 20)</span><span id="c21d" class="nx ll it nt b gy oc nz l oa ob">plt.show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/a8b5cbc62ed69802b3b2e8ff7b02f8b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fSS1OhL-Z5A_huoLgrY8OQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">k均值聚类</p></figure><p id="86c5" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">看看基于玩家位置的集群是如何形成的，这很酷！</p><p id="53a7" class="pw-post-body-paragraph mc md it me b mf my kd mh mi mz kg mk ml na mn mo mp nb mr ms mt nc mv mw mx im bi translated">我希望你觉得这个教程有用，并期待下一个！</p></div></div>    
</body>
</html>