<html>
<head>
<title>Applying Anomaly Detection with Autoencoders to Fraud Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将自动编码器异常检测应用于欺诈检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/applying-anomaly-detection-with-autoencoders-to-fraud-detection-feaaee6b5b09?source=collection_archive---------18-----------------------#2020-06-08">https://towardsdatascience.com/applying-anomaly-detection-with-autoencoders-to-fraud-detection-feaaee6b5b09?source=collection_archive---------18-----------------------#2020-06-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="49be" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">信用卡欺诈可以归类为异常，使用 Keras 中实现的自动编码器可以检测欺诈</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c81bdebdbc10d0ff3359570e423fdf31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Hx5HxasUCM4F_Da32coQA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/photos/TFqKR4Ynjm8" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/TFqKR4Ynjm8</a></p></figure><p id="cb6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最近读了一篇名为<a class="ae ky" href="https://medium.com/swlh/anomaly-detection-with-autoencoders-2bd23dedbd9e" rel="noopener">用自动编码器进行异常检测</a>的文章。这篇文章是基于生成的数据，因此将这个想法应用到现实世界的欺诈检测任务并验证它听起来是个好主意。</p><p id="452c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我决定使用来自 Kaggle  *的<a class="ae ky" href="https://www.kaggle.com/mlg-ulb/creditcardfraud" rel="noopener ugc nofollow" target="_blank">信用卡欺诈数据集:</a></p><blockquote class="lv lw lx"><p id="f726" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">该数据集包含欧洲持卡人在 2013 年 9 月的信用卡交易。<br/>该数据集显示了两天内发生的交易，其中 284，807 笔交易中有 492 笔欺诈。数据集高度不平衡，正类(欺诈)占所有交易的 0.172%。</p></blockquote><p id="5820" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个非常不平衡的数据集，是通过异常识别欺诈的良好候选对象。</p><p id="afd0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">让我们从数据发现开始:</strong></p><p id="1829" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Principal_component_analysis" rel="noopener ugc nofollow" target="_blank">主成分分析</a>将维度从 30 减少到 3 后，我们将绘制一个更小的图。该数据有 32 列，其中第一列是时间索引、29 个未知特征、1 个交易量和 1 个类别。我将忽略时间索引，因为它不是静止的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi me"><img src="../Images/ef2d515e28a11fb798504371e095d472.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NfXaAx49UZCFj9e1g3hYOA.png"/></div></div></figure><p id="66d8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的第一反应可能是有两个集群，这将是一个简单的任务，但欺诈数据是黄色点！在大星团中有三个可见的黄色点。因此，让我们对正常数据进行二次抽样，同时保留欺诈数据的数量。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi me"><img src="../Images/a9efb7317baed1cd03d047d3b5c0ea44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iddlxd2aXHSdqT2g3o65aQ.png"/></div></div></figure><p id="1844" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在可以看到，正常交易聚集在一个磁盘中，而欺诈交易则更加分散。</p><p id="6ece" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将构建一个具有 3 层编码器和 2 层解码器的自动编码器:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/630c00b363c795aec523daf1f16acc58.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*fmfV24QYGa9_P5CKVTVotA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://medium.com/swlh/anomaly-detection-with-autoencoders-2bd23dedbd9e" rel="noopener">https://medium . com/swlh/anomaly-detection-with-auto encoders-2bd 23 edbd 9 e</a></p></figure><p id="9a5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://blog.keras.io/building-autoencoders-in-keras.html" rel="noopener ugc nofollow" target="_blank">自动编码器</a>会将我们的数据编码到一个子空间中，并在<em class="ly">标准化</em>数据的同时将特征解码回来。我们的期望是，autoencoder 将学习正常交易的特征，并且在应用时输入将类似于输出。对于异常，输入和输出会有很大的不同，因为它是意外的数据。</p><p id="e47f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种方法的好处是它允许我们使用<strong class="lb iu">无监督学习</strong>，并且我们通常有大量正常的交易数据。数据标注通常昂贵、困难，并且在某些情况下不可用。手动数据标记还包括人工交互，这导致了带有人工偏见的实现。可以看出，在模型训练中，我们只使用正常的交易特征，而不使用标签。</p><p id="183b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们加载数据并训练我们的自动编码器:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="34c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的模型解决了 8.5641e-04 的验证损失。(可以低至 5.4856e-04。)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/e9a40c89344a9be7bbac7383675d85eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*oGMA08Zs78Edu4tbyEVCTg.png"/></div></figure><p id="08b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用该模型，我们将计算正常交易的均方误差(mse ),并计算所有 mse 值的 95%的阈值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="6471" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们发现我们的阈值(截止值)为 0.002。如果均方差高于 0.002，我们会将交易视为异常。让我们选择 100 个欺诈样本和 100 个正常样本，并根据阈值绘制:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mc md l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/a80042127b8123d3f9d73c39f78c209b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*ofC48lWn_HCoH_YpAueZAA.png"/></div></figure><p id="dd9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以看出，与正常交易相比，大多数欺诈性交易具有较高的均方误差。看起来很有希望。</p><p id="fd5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们放弃了 5%的正常交易。仍有低于阈值的欺诈交易。这可以通过使用更好的特征提取来改善，因为一些欺诈数据似乎具有与正常交易非常相似的特征。信用卡欺诈的一些有价值的特征是前一小时/天/周的交易次数，如果交易是在发行国以外的国家发起的。</p><p id="bee4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">未来任务:</strong></p><ul class=""><li id="8de8" class="mh mi it lb b lc ld lf lg li mj lm mk lq ml lu mm mn mo mp bi translated">通过使用超参数优化来使用更好的模型。</li><li id="1334" class="mh mi it lb b lc mq lf mr li ms lm mt lq mu lu mm mn mo mp bi translated">分析数据以了解特征。</li><li id="b5ca" class="mh mi it lb b lc mq lf mr li ms lm mt lq mu lu mm mn mo mp bi translated">将这些结果与 SVM 或 K-均值聚类等常用方法进行比较。</li></ul><p id="7a21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章的完整代码可以在 Github 上找到:</p><div class="mv mw gp gr mx my"><a href="https://github.com/bgokden/anomaly-detection-with-autoencoders" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">bgokden/带自动编码器的异常检测</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">异常检测与自动编码器-信用卡欺诈案件博客帖子为这个回购:https://blog.berkgokden.com 代码…</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">github.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm ks my"/></div></div></a></div><p id="1d9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Github 和 Linkedin 上关注我:</p><div class="mv mw gp gr mx my"><a href="https://www.linkedin.com/in/berkgokden/" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">伯克·格登-高级软件工程师-卡斯帕。人工智能| LinkedIn</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">请在联系之前阅读摘要:我是一名电气工程师，但我目前正在从事…</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">www.linkedin.com</p></div></div><div class="nh l"><div class="nn l nj nk nl nh nm ks my"/></div></div></a></div><h1 id="98c2" class="no np it bd nq nr ns nt nu nv nw nx ny jz nz ka oa kc ob kd oc kf od kg oe of bi translated">*信用欺诈数据集的确认</h1><p id="2c39" class="pw-post-body-paragraph kz la it lb b lc og ju le lf oh jx lh li oi lk ll lm oj lo lp lq ok ls lt lu im bi translated">该数据集是在 Worldline 和 ulb(布鲁塞尔自由大学)机器学习小组(<a class="ae ky" href="http://mlg.ulb.ac.be/" rel="noopener ugc nofollow" target="_blank"> http://mlg.ulb.ac.be </a>)关于大数据挖掘和欺诈检测的研究合作期间收集和分析的。在<a class="ae ky" href="https://www.researchgate.net/project/Fraud-detection-5" rel="noopener ugc nofollow" target="_blank">https://www.researchgate.net/project/Fraud-detection-5</a>和<a class="ae ky" href="https://mlg.ulb.ac.be/wordpress/portfolio_page/defeatfraud-assessment-and-validation-of-deep-feature-engineering-and-learning-solutions-for-fraud-detection/" rel="noopener ugc nofollow" target="_blank"> DefeatFraud </a>项目的页面上可以获得关于相关主题的当前和过去项目的更多细节</p><p id="ca5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">引用作品:</p><p id="274b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安德烈亚·达尔·波佐洛、奥利维尔·卡伦、里德·约翰逊和吉安卢卡·邦坦皮。<a class="ae ky" href="https://www.researchgate.net/publication/283349138_Calibrating_Probability_with_Undersampling_for_Unbalanced_Classification" rel="noopener ugc nofollow" target="_blank">非平衡分类的欠采样概率校准。</a>2015 年 IEEE 计算智能和数据挖掘研讨会(CIDM)</p><p id="127f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安德烈亚·达尔·波佐洛；奥利维耶·卡兰；勒·博尔涅，扬·艾尔；沃特肖特，哔叽；邦坦皮，吉安卢卡。<a class="ae ky" href="https://www.researchgate.net/publication/260837261_Learned_lessons_in_credit_card_fraud_detection_from_a_practitioner_perspective" rel="noopener ugc nofollow" target="_blank">从从业者的角度吸取信用卡欺诈检测的经验教训</a>，应用专家系统，41，10，4915–4928，2014 年，Pergamon</p><p id="bb38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安德烈亚·达尔·波佐洛；贾科莫博拉奇；奥利维耶·卡兰；阿里皮、塞萨尔；邦坦皮，吉安卢卡。<a class="ae ky" href="https://www.researchgate.net/publication/319867396_Credit_Card_Fraud_Detection_A_Realistic_Modeling_and_a_Novel_Learning_Strategy" rel="noopener ugc nofollow" target="_blank">信用卡欺诈检测:现实建模和新型学习策略，</a> IEEE 神经网络和学习系统汇刊，29，8，3784–3797，2018，IEEE</p><p id="7e1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">达尔·波佐洛，安德里亚<a class="ae ky" href="http://di.ulb.ac.be/map/adalpozz/pdf/Dalpozzolo2015PhD.pdf" rel="noopener ugc nofollow" target="_blank">用于信用卡欺诈检测的自适应机器学习</a>ULB·MLG 博士论文(g .邦坦皮指导)</p><p id="b4c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">法布里齐奥·卡希洛；安德烈亚·达尔·波佐洛；扬·阿勒·勒博尔涅；奥利维耶·卡兰；马泽尔、扬尼斯；邦坦皮，吉安卢卡。<a class="ae ky" href="https://www.researchgate.net/publication/319616537_SCARFF_a_Scalable_Framework_for_Streaming_Credit_Card_Fraud_Detection_with_Spark" rel="noopener ugc nofollow" target="_blank"> Scarff:使用 Spark 进行流式信用卡欺诈检测的可扩展框架</a>，信息融合，41，182–194，2018，Elsevier</p><p id="4b3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">法布里齐奥·卡希洛；扬·阿勒·勒博尔涅；奥利维耶·卡兰；邦坦皮，吉安卢卡。<a class="ae ky" href="https://www.researchgate.net/publication/332180999_Deep-Learning_Domain_Adaptation_Techniques_for_Credit_Cards_Fraud_Detection" rel="noopener ugc nofollow" target="_blank">现实生活中信用卡欺诈检测的流式主动学习策略:评估和可视化，</a>国际数据科学与分析杂志，5，4，285–300，2018，施普林格国际出版公司</p><p id="6906" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Bertrand Lebichot，Yann-al Le Borgne，何丽云，Frederic Oblé，Gianluca Bontempi <a class="ae ky" href="https://www.researchgate.net/publication/332180999_Deep-Learning_Domain_Adaptation_Techniques_for_Credit_Cards_Fraud_Detection" rel="noopener ugc nofollow" target="_blank">用于信用卡欺诈检测的深度学习领域适应技术</a>，INNSBDDL 2019:大数据和深度学习的最新进展，第 78-88 页，2019 年</p><p id="226f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Fabrizio Carcillo，Yann-al Le Borgne，Olivier Caelen，Frederic Oblé，Gianluca Bontempi <a class="ae ky" href="https://www.researchgate.net/publication/333143698_Combining_Unsupervised_and_Supervised_Learning_in_Credit_Card_Fraud_Detection" rel="noopener ugc nofollow" target="_blank">在信用卡欺诈检测中结合非监督和监督学习</a>信息科学，2019 年</p></div></div>    
</body>
</html>