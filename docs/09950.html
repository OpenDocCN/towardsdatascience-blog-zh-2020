<html>
<head>
<title>Machine Learning Basics: Decision Tree Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习基础:决策树回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-basics-decision-tree-regression-1d73ea003fda?source=collection_archive---------2-----------------------#2020-07-14">https://towardsdatascience.com/machine-learning-basics-decision-tree-regression-1d73ea003fda?source=collection_archive---------2-----------------------#2020-07-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e73d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">实施决策树回归算法并绘制结果。</h2></div><p id="3b12" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">之前，我已经解释了各种回归模型，如线性、多项式和支持向量回归。在本文中，我将通过一个真实的例子向您介绍决策树回归的算法和实现。</p><h2 id="758f" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">决策树算法综述</h2><p id="cdd8" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">决策树是监督学习最常用、最实用的方法之一。它既可以用来解决回归问题，也可以用来解决分类问题，而分类问题在实际应用中得到更多的应用。</p><p id="abf3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它是一个树形结构的分类器，有三种类型的节点。<strong class="kk iu"> <em class="mc">根节点</em> </strong>是代表整个样本的初始节点，并且可以被进一步分割成更多的节点。<strong class="kk iu"> <em class="mc">内部节点</em> </strong>代表数据集的特征，分支代表决策规则。最后，<strong class="kk iu"> <em class="mc">叶节点</em> </strong>表示结果。这个算法对于解决决策相关的问题非常有用。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi md"><img src="../Images/795bb9320aef744fd9315bb2a093da6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IY07ftCHvVuuw35_.png"/></div></div><p class="mp mq gj gh gi mr ms bd b be z dk translated"><a class="ae mt" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fwww.python-course.eu%2FDecision_Trees.php&amp;psig=AOvVaw2TW-tCuePuAsAYuADqagpN&amp;ust=1594725515226000&amp;source=images&amp;cd=vfe&amp;ved=0CAkQjhxqFwoTCJDayM-NyuoCFQAAAAAdAAAAABAN" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="ad75" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于一个特定的数据点，通过回答<em class="mc">对/错</em>问题来完全遍历整个树，直到它到达叶节点。最终预测是该特定叶节点中因变量的平均值。通过多次迭代，该树能够预测数据点的适当值。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/ba2485f97234530fbdef9e6d9e070613.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*YlmscpNST8MY7yzw.png"/></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">决策树模型示例(<a class="ae mt" href="https://www.javatpoint.com/machine-learning-decision-tree-classification-algorithm" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="589a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上图是决策树算法实现的示意图。决策树具有易于理解、需要较少的数据清理、非线性不影响模型性能以及要调整的超参数数量几乎为零的优点。然而，它可能有一个过度拟合的问题，这个问题可以使用<strong class="kk iu"> <em class="mc">随机森林</em> </strong>算法来解决，这将在下一篇文章中解释。</p><p id="83be" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个例子中，我们将经历<strong class="kk iu"> <em class="mc">决策树回归</em> </strong>的实现，其中我们将根据一个地区 500 天的温度来预测一家冰淇淋店的收入。</p><h2 id="892c" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">问题分析</h2><p id="7e97" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在这个数据中，我们有一个独立变量<em class="mc">温度</em>和一个独立变量<em class="mc">收入</em>，我们必须预测它们。在这个问题中，我们必须建立一个决策树回归模型，该模型将研究冰淇淋店的温度和收入之间的相关性，并根据特定日期的温度预测冰淇淋店的收入。</p><h2 id="4b33" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤 1:导入库</h2><p id="9993" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">第一步总是包括导入开发 ML 模型所需的库。导入<strong class="kk iu"> <em class="mc"> NumPy </em> </strong>，<strong class="kk iu"> <em class="mc"> matplotlib </em> </strong>和<strong class="kk iu"> <em class="mc">熊猫库</em> </strong>。</p><pre class="me mf mg mh gt mv mw mx my aw mz bi"><span id="da2f" class="le lf it mw b gy na nb l nc nd">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd</span></pre><h2 id="03e7" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤 2:导入数据集</h2><p id="ed5a" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在这一步中，我们将使用 pandas 来存储从我的 github 存储库中获得的数据，并使用函数'<em class="mc"> pd.read_csv </em>'将其存储为 Pandas DataFrame。<strong class="kk iu"> </strong>在此，我们将自变量(X)分配给'<em class="mc">温度'</em>列，将因变量(y)分配给'<em class="mc">收入'</em>列。</p><pre class="me mf mg mh gt mv mw mx my aw mz bi"><span id="b22c" class="le lf it mw b gy na nb l nc nd">dataset = pd.read_csv('<a class="ae mt" href="https://raw.githubusercontent.com/mk-gurucharan/Regression/master/IceCreamData.csv'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/mk-gurucharan/Regression/master/IceCreamData.csv'</a>)</span><span id="9753" class="le lf it mw b gy ne nb l nc nd">X = dataset['Temperature'].values<br/>y = dataset['Revenue'].values</span><span id="d40c" class="le lf it mw b gy ne nb l nc nd">dataset.head(5)</span><span id="8801" class="le lf it mw b gy ne nb l nc nd">&gt;&gt;</span><span id="8e0c" class="le lf it mw b gy ne nb l nc nd">Temperature   Revenue<br/>24.566884     534.799028<br/>26.005191     625.190122<br/>27.790554     660.632289<br/>20.595335     487.706960<br/>11.503498     316.240194</span></pre><h2 id="c549" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤 3:将数据集分为训练集和测试集</h2><p id="c128" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">下一步，我们必须像往常一样将数据集分成<em class="mc">训练集</em>和<em class="mc">测试集</em>。为此，我们使用<code class="fe nf ng nh mw b">test_size=0.05</code>,这意味着 500 个数据行的 5%(<em class="mc">25 行</em>)将仅用作测试集，剩余的<em class="mc"> 475 行</em>将用作构建模型的训练集。</p><pre class="me mf mg mh gt mv mw mx my aw mz bi"><span id="4746" class="le lf it mw b gy na nb l nc nd">from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.05)</span></pre><h2 id="1c62" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤 4:在训练集上训练决策树回归模型</h2><p id="569f" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">我们从<code class="fe nf ng nh mw b">sklearn.tree</code>导入<code class="fe nf ng nh mw b">DecisionTreeRegressor</code>类，并将其赋给变量'<strong class="kk iu"> <em class="mc">'回归变量'</em> </strong>。然后我们通过使用<code class="fe nf ng nh mw b">regressor.fit</code>函数将 X_train 和 y_train 拟合到模型中。我们使用<code class="fe nf ng nh mw b">reshape(-1,1)</code>将变量整形为一个列向量。</p><pre class="me mf mg mh gt mv mw mx my aw mz bi"><span id="86f5" class="le lf it mw b gy na nb l nc nd"># Fitting Decision Tree Regression to the dataset<br/>from sklearn.tree import DecisionTreeRegressor<br/>regressor = DecisionTreeRegressor()<br/>regressor.fit(X_train.reshape(-1,1), y_train.reshape(-1,1))</span></pre><h2 id="9e26" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">第五步:预测结果</h2><p id="df4d" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在此步骤中，我们使用<code class="fe nf ng nh mw b">regressor.predict</code>函数预测模型在训练集值上训练的测试集的结果，并将其分配给'<strong class="kk iu"> <em class="mc"> y_pred' </em>。</strong></p><pre class="me mf mg mh gt mv mw mx my aw mz bi"><span id="cc54" class="le lf it mw b gy na nb l nc nd">y_pred = regressor.predict(X_test.reshape(-1,1))</span></pre><h2 id="defd" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤 6:将实际值与预测值进行比较</h2><p id="95b3" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在这一步中，我们将在 Pandas 数据帧中比较并显示 y_test 的值为'<strong class="kk iu">真实值</strong>，y_pred 的值为'<strong class="kk iu">预测值</strong>。</p><pre class="me mf mg mh gt mv mw mx my aw mz bi"><span id="726a" class="le lf it mw b gy na nb l nc nd">df = pd.DataFrame({'Real Values':y_test.reshape(-1), 'Predicted Values':y_pred.reshape(-1)})<br/>df</span><span id="2776" class="le lf it mw b gy ne nb l nc nd">&gt;&gt;<br/>Real Values    Predicted Values<br/>448.325981     425.265596<br/>535.866729     500.065779<br/>264.123914     237.763911<br/>691.855484     698.971806<br/>587.221246     571.434257<br/>653.986736     633.504009<br/>538.179684     530.748225<br/>643.944327     660.632289<br/>771.789537     797.566536<br/>644.488633     654.197406<br/>192.341996     223.435016<br/>491.430500     477.295054<br/>781.983795     807.541287<br/>432.819795     420.966453<br/>623.598861     612.803770<br/>599.364914     534.799028<br/>856.303304     850.246982<br/>583.084449     596.236690<br/>521.775445     503.084268<br/>228.901030     258.286810<br/>453.785607     473.568112<br/>406.516091     450.473207<br/>562.792463     634.121978<br/>642.349814     621.189730<br/>737.800824     733.215828</span></pre><p id="a9d4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从上述值，我们推断该模型能够以良好的准确度预测 y_test 的值。</p><h2 id="7e09" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤 7:可视化决策树回归结果</h2><div class="me mf mg mh gt ab cb"><figure class="ni mi nj nk nl nm nn paragraph-image"><img src="../Images/b774c1437c8f47c14f80dac621b526b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*70uag488PmIkg5EhL-FtlQ.png"/></figure><figure class="ni mi no nk nl nm nn paragraph-image"><img src="../Images/0b14e0c665ae11058f768bf242b9ddc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*RWXWFwmg2HmubhFF_W_c9A.png"/><p class="mp mq gj gh gi mr ms bd b be z dk np di nq nr translated">温度与收入(决策树回归)</p></figure></div><p id="235e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在该图中，实际值用“<strong class="kk iu"> <em class="mc">、红色</em> </strong>”绘制，预测值用“<strong class="kk iu"> <em class="mc">、绿色</em> </strong>”绘制。决策树回归模型的绘图也是用<strong class="kk iu"> <em class="mc">黑色</em> </strong>颜色绘制的。</p><figure class="me mf mg mh gt mi"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="a30a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我附上了我的 github 资源库的链接，你可以在那里找到 Google Colab 笔记本和数据文件供你参考。</p><div class="nu nv gp gr nw nx"><a href="https://github.com/mk-gurucharan/Regression" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">MK-guru charan/回归</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">GitHub 是超过 5000 万开发人员的家园，他们一起工作来托管和审查代码、管理项目和构建…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">github.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol mn nx"/></div></div></a></div><p id="6952" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我真的希望我已经用一个例子解释了构建决策树回归模型的 ML 代码。</p><p id="ef90" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您还可以在下面找到该程序对其他回归模型的解释:</p><ul class=""><li id="dbe8" class="om on it kk b kl km ko kp kr oo kv op kz oq ld or os ot ou bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/machine-learning-basics-simple-linear-regression-bc83c01baa07">简单线性回归</a></li><li id="464d" class="om on it kk b kl ov ko ow kr ox kv oy kz oz ld or os ot ou bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/machine-learning-basics-multiple-linear-regression-9c70f796e5e3">多元线性回归</a></li><li id="6b70" class="om on it kk b kl ov ko ow kr ox kv oy kz oz ld or os ot ou bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/machine-learning-basics-polynomial-regression-3f9dd30223d1">多项式回归</a></li><li id="c4f7" class="om on it kk b kl ov ko ow kr ox kv oy kz oz ld or os ot ou bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/machine-learning-basics-support-vector-regression-660306ac5226">支持向量回归</a></li><li id="fd92" class="om on it kk b kl ov ko ow kr ox kv oy kz oz ld or os ot ou bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/machine-learning-basics-decision-tree-regression-1d73ea003fda">决策树回归</a></li><li id="72c9" class="om on it kk b kl ov ko ow kr ox kv oy kz oz ld or os ot ou bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/machine-learning-basics-random-forest-regression-be3e1e3bb91a">随机森林回归</a></li></ul><p id="ddfc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在接下来的文章中，我们将会遇到更复杂的回归、分类和聚类模型。到那时，快乐的机器学习！</p></div></div>    
</body>
</html>