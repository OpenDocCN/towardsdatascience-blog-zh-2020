<html>
<head>
<title>How to Measure Stock Portfolio Performance using R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 R 来衡量股票投资组合的表现</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-measure-stock-portfolio-performance-using-r-847c992195c2?source=collection_archive---------13-----------------------#2020-07-28">https://towardsdatascience.com/how-to-measure-stock-portfolio-performance-using-r-847c992195c2?source=collection_archive---------13-----------------------#2020-07-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6fd3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用印尼股市数据进行投资组合分析的案例研究</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/30fe90a694598f08f66b7666c0df2e8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IWKTDXElpzLDMMnFLdn4Zw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">克里斯·利维拉尼在<a class="ae ky" href="https://unsplash.com/s/photos/stock?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><blockquote class="kz la lb"><p id="67f3" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">股票市场是人们安排买卖上市公司股票交易的地方</p></blockquote><p id="446e" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">印尼被世界银行命名为东南亚最大的经济体<strong class="lf iu"><em class="le"/></strong>。作为世界上人口最多的四个国家之一，有超过 2 亿人生活在这个国家，印度尼西亚有着成为世界上最大的经济体之一的议价能力。印度尼西亚经济状况的良好前景使这个国家成为投资的最佳选择之一。</p><p id="f7c8" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">印尼股市有 600 多家上市企业，在冠状病毒爆发前仍处于上升趋势。一些上市企业是国有企业，对于这个案例研究，我将只分析 17 家国有企业，它们是最新的 IDX-布朗 20 指数的成员。</p><p id="26de" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated"><strong class="lf iu">用于分析的股票:</strong></p><p id="59de" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">ANTM。JK，BBNI。JK BBRI。JK BBTN。JK，BJBR。JK BMRI。JK 艾尔莎。JK，JSMR。JK，KAEF。JK PGAS。JK PTBA。JK PTPP。JK SMGR。JK，TINS。JK，TLKM。JK，WIKA。JK，WSKT。女高中生</p><p id="fcb4" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">本案例研究的假设是:</p><ol class=""><li id="adda" class="mc md it lf b lg lh lj lk lz me ma mf mb mg ly mh mi mj mk bi translated">股票在投资组合中的权重对每个企业都是一样的。</li><li id="9a8d" class="mc md it lf b lg ml lj mm lz mn ma mo mb mp ly mh mi mj mk bi translated">基于 2013 年 1 月 1 日至 2020 年 7 月 26 日的历史调整收盘价数据的分析。</li><li id="bb1a" class="mc md it lf b lg ml lj mm lz mn ma mo mb mp ly mh mi mj mk bi translated">无风险利率:4.5%</li><li id="482f" class="mc md it lf b lg ml lj mm lz mn ma mo mb mp ly mh mi mj mk bi translated">投资组合再平衡季刊</li></ol><h2 id="0a3f" class="mq mr it bd ms mt mu dn mv mw mx dp my lz mz na nb ma nc nd ne mb nf ng nh ni bi translated">导入和准备股票数据</h2><p id="4a57" class="pw-post-body-paragraph lc ld it lf b lg nj ju li lj nk jx ll lz nl lo lp ma nm ls lt mb nn lw lx ly im bi translated">我们将使用<strong class="lf iu"> getSymbols() </strong>函数从<strong class="lf iu"> quantmod </strong>包中导入股票价格数据。<strong class="lf iu"> getSymbols() </strong>函数是加载和管理来自各种来源的财务数据的特定函数，但是对于这个例子，我们将使用<em class="le"> Yahoo Finance </em>作为我们的数据源。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从 Yahoo Finance 导入股票价格数据</p></figure><p id="5b69" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">默认情况下，我们会将每个股票价格数据作为 xts 对象分配给它们的股票代码(例如:ANTM。JK 价格将存储在 ANTM。JK 变量作为 xts 对象)。为了便于分析，我们应该将所有这些独立的数据收集到一个 xts 对象中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将单独的数据收集到单个 xts 对象中</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/dc1c1016271a87f1754679303a23f868.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*1YXgwzxD1VMUhan1N7G2VA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图一。索引 xts 对象预览</p></figure><h2 id="6077" class="mq mr it bd ms mt mu dn mv mw mx dp my lz mz na nb ma nc nd ne mb nf ng nh ni bi translated">投资组合分析</h2><p id="3187" class="pw-post-body-paragraph lc ld it lf b lg nj ju li lj nk jx ll lz nl lo lp ma nm ls lt mb nn lw lx ly im bi translated">我们已经制作了一个投资组合，它作为单个 xts 对象存储在名为<strong class="lf iu"> Index </strong>的变量中。我们存储在该变量中的数据仍然是每个交易日的收盘价格式，因为大多数投资组合分析方法需要通过<strong class="lf iu">回报</strong>数据来提供，我们必须在进入投资组合分析之前先计算其回报。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/e63bf2ca76e6d3e9e67afdd3b011a0fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*ullZTSzsXgMivTu4M8Ah7w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图二。回报计算公式</p></figure><p id="c42b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">幸运的是，在 R 中我们不必每天手动计算每只股票的回报，我们只需要调用 return。calculate()函数，它将以 xts 对象格式返回输出。</p><p id="9fd5" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">因为没有人能预见未来，大多数股票市场投资者在决定买哪只股票之前依赖两件事，第一是基本面分析，第二是技术分析。<strong class="lf iu">基本面分析</strong>涉及到经济和金融数据的运用(如生产、消费、可支配收入等。)来预测未来的价格，而<strong class="lf iu">技术分析</strong>主要(通常是唯一)基于对价格数据本身模式的研究。本文将只涵盖一些可用的技术分析方法。</p><p id="1979" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">对于第一个分析，我们将尝试从年化回报的回报和风险的角度来看每只股票的表现，因为投资者有时希望看到他们的投资与其风险相比是否有良好的回报，而<strong class="lf iu">夏普比率</strong>是一个可以衡量这一切的伟大计算。较高的夏普比率意味着，与投资期间的风险相比，我们的投资回报丰厚。为了计算，我们假设印度尼西亚的无风险利率为每年 4.5%。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">如何计算 R 中的年夏普比率</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/59ae18b3539d2307f3b5ef33a3d102ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zITrXRpFvSUWmrwKDKp91A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图三。投资组合中每只股票的夏普比率</p></figure><p id="8298" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated"><strong class="lf iu">年化</strong>是指我们每年重新计算一定时期的数字，例如 ANTM 回归。在 2013 年至 2020 年期间，JK 为-5.35%/年。我们的投资组合年化表现显示，不同股票之间存在差异。我们投资组合中表现最差的是 PGAS。JK 收益为负，期间波动太大，使得 PGAS。JK 夏普比率是其中最低的。我们投资组合中表现最好的是 BBRI。JK 显示最高的回报，最小的标准差和最高的夏普比率。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/539c3ff7241b25dde32fbf36ae5f915d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*heJ9XdLgEiS4cTH3gUdpYg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 4。BBRI。JK 对 PGAS。JK 调整收盘价图表</p></figure><p id="9e55" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">如果我们比较我们投资组合中表现最好的<em class="le">股票</em>和表现最差的<em class="le">股票</em>的折线图，我们可以明显看出它们之间的差异。BBRI。JK 有更一致的运动，并且逐年稳步增加，与 PGAS 相反。JK 运动在波峰和波谷之间有一个巨大的跨度。</p><p id="bb74" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">我们还可以使用<strong class="lf iu"> ggplot2 </strong>包<strong class="lf iu">中的标签图，大致了解我们的股票表现与无风险利率资产(4.5%年回报率)相比如何。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/173810aab552e788026564f5a5938920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tTZawUPgwyxwdNxJlgxsTQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图五。股票表现与无风险利率资产</p></figure><p id="6c50" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">如果我们从大的方面来看，在此期间，10 家公司非常值得投资，这意味着如果我们投资这些股票，我们将比投资无风险资产获得更多。利用这个图，我们知道多样化在投资中是多么重要，我们的一些投资会有很高的回报，但其他投资正在失去它的价值。</p><p id="22d5" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">现在，我们将开始将这些股票作为一个投资组合进行分析，如果我们从 2013 年到 2020 年 7 月以相同的比例持有所有这些股票，我们将看到其表现如何。</p><p id="b006" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">首先，我们将看看我们的投资组合日收益率分布。使用这个分布，我们将看到我们的投资组合给我们带来正回报的频率，以及它失去价值的频率。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/9cd38958cc27c7c8412bd7f709211019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ipwOKAMSAWpWoz-8uGqhtw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图六。投资组合日收益分布</p></figure><p id="c2de" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">每日回报分布图显示我们的投资组合在某段时间平均正回报接近于零。它可以在一天内给出超过 10%的回报，但另一方面，它也可能在一天内损失超过 10%的价值。我们将使用时间序列每日回报图来证明这一点，并找出我们的投资组合何时损失如此之大，何时获得最高回报。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/46aded160f605133d86fb587b988fe51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kScIJG0u_KL_JGx50WD-Hw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图七。时间序列每日回报图</p></figure><p id="e3ba" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">从时间序列图中，我们可以明显地看到我们的大部分回报将在 5%的范围内，尽管有一些异常值，最近的一次是由于冠状病毒在 2020 年上半年的影响。</p><p id="404f" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">仅使用每日回报不足以显示我们的投资组合表现如何。幸运的是，有<strong class="lf iu">图表。R 中的 PerformanceSummary() </strong>函数将产生投资组合<em class="le">累积回报、日回报和提款图</em>作为其输出。</p><ol class=""><li id="a154" class="mc md it lf b lg lh lj lk lz me ma mf mb mg ly mh mi mj mk bi translated"><em class="le">累积回报</em>:显示我们从投资组合中获得多少回报的时间序列图。</li><li id="384a" class="mc md it lf b lg ml lj mm lz mn ma mo mb mp ly mh mi mj mk bi translated"><em class="le">每日回报</em>:显示我们投资组合每日回报的时间序列图。</li><li id="56b7" class="mc md it lf b lg ml lj mm lz mn ma mo mb mp ly mh mi mj mk bi translated"><em class="le">下降</em>:时间序列图显示波峰和波谷之间的距离，以及需要多长时间才能恢复其值</li></ol><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="bbfc" class="mq mr it nx b gy ob oc l od oe"><strong class="nx iu">charts.PerformanceSummary</strong>(Portfolio_Return, main = 'Portfolio Performance Summary')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/4d089f73ca8b546e6bdcdb865f9c3503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ne0KhMnDncR0U6hOX72rgQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图八。投资组合表现摘要图表</p></figure><p id="d372" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">业绩摘要图表总结了我们在分析我们的投资组合在此期间的业绩时需要的所有信息。<strong class="lf iu">从累积回报图来看，</strong>我们知道我们的投资组合在 7 月 26 日之前仍将有超过 100%的回报，尽管一些股票的负回报和冠状病毒效应在很大程度上扰乱了世界上所有的股票市场活动。<strong class="lf iu"/>从每日回报图中，我们将获得关于哪个时期我们的投资组合回报波动如此之大的信息，利用这些信息，我们可以深入了解某个时期的重大事件如何扰乱股票市场交易，并制定未来是否会有任何其他重大事件的计划。<strong class="lf iu">从跌势图</strong>、<strong class="lf iu"> </strong>中，我们可以了解我们的投资组合在跌势中表现如何，以及它能恢复多久，这样我们就可以有一个适当的策略，如果未来跌势发生，我们如何持有股票。</p><h2 id="756a" class="mq mr it bd ms mt mu dn mv mw mx dp my lz mz na nb ma nc nd ne mb nf ng nh ni bi translated">摘要</h2><p id="909e" class="pw-post-body-paragraph lc ld it lf b lg nj ju li lj nk jx ll lz nl lo lp ma nm ls lt mb nn lw lx ly im bi translated">技术分析是利用历史模式和市场统计数据来预测股票价格的变动。本文讨论了如何使用 R-计算来提取模式，并深入了解我们的投资组合在特定时期的运动和表现。</p><p id="4e93" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">对于未来的投资，我们可以将分析结果作为我们将要采取的每一个行动的基础。例如，我们可以将这种分析划分为一个更小的时间段，并根据形状比率修改我们的投资组合构成。</p><p id="52ef" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">还有一种方法可以根据历史数据找到我们投资组合的最佳权重。希望它能在其他文章中讨论。</p><blockquote class="kz la lb"><p id="9ae4" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf iu">注意:</strong>只要数据源中的数据可用，我们就可以为每只股票和每个时期重建本文中的每个代码。只是试着把它改成你的投资组合构成，看看你的投资组合在某个时期表现如何。</p></blockquote></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><p id="b679" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">[1] Schwarger，Jack.D .，&amp; Etzkorn，M. (2017)，<em class="le">期货市场完全指南</em>，第二版，John Wiley &amp; Sons，Inc .，新泽西州霍博肯。</p></div></div>    
</body>
</html>