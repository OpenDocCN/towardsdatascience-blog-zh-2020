<html>
<head>
<title>Exploratory Data Analysis (EDA) Visualization Using Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Pandas 进行探索性数据分析(EDA)可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/exploratory-data-analysis-eda-visualization-using-pandas-ca5a04271607?source=collection_archive---------1-----------------------#2020-03-23">https://towardsdatascience.com/exploratory-data-analysis-eda-visualization-using-pandas-ca5a04271607?source=collection_archive---------1-----------------------#2020-03-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/ee79b4b48e708cf1a15addfe526204ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SuY5vFBe3r1a5dbck7jYAg.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@isaacmsmith?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">艾萨克·史密斯</a>在<a class="ae jg" href="https://unsplash.com/s/photos/analysis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><div class=""/><p id="a8f3" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">原来你可以直接从你的数据帧中画出许多有用的图，而不需要调用<code class="fe le lf lg lh b">plt.show()</code></p><p id="762f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Pandas 无疑是用 Python 执行数据分析的最受欢迎的包，这要归功于它丰富直观的功能，允许我们轻松地对数据执行无数次操作。难怪该软件包已经成为许多数据科学家/分析师处理日常任务的不可或缺的工具。</p><p id="1308" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">关于探索性数据分析(EDA)，Pandas 通常与另一个绘图包一起使用，如 Matplotlib、Seaborn、Plotly 等。在通过 Pandas 对所有数据进行预处理后，就可以使用手边选择的绘图包对其进行可视化。</p><p id="acb6" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，如果我告诉你 Pandas 也能够可视化你的数据，这意味着你可以直接从你使用的数据框架中生成 EDA 所需的(大部分)图，那会怎么样呢？不会很整齐吗？</p><p id="50fc" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这正是我想在这里与你分享的话题。</p></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><p id="ad3d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">快速总结</strong></p><p id="614d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是本文所涉及的内容:</p><ol class=""><li id="4d76" class="lp lq jj ki b kj kk kn ko kr lr kv ls kz lt ld lu lv lw lx bi translated">熊猫的<code class="fe le lf lg lh b">plot</code>方法一瞥</li><li id="23ee" class="lp lq jj ki b kj ly kn lz kr ma kv mb kz mc ld lu lv lw lx bi translated">如何使用熊猫的<code class="fe le lf lg lh b">plot</code>方法画一些基本的图，包括箱线图、散点图、饼图等等</li><li id="2227" class="lp lq jj ki b kj ly kn lz kr ma kv mb kz mc ld lu lv lw lx bi translated">如何使用 Pandas 绘制相关矩阵(这是由<code class="fe le lf lg lh b">plot</code>方法生成的<em class="md">而不是</em>，但是它在任何 EDA 中都是必不可少的，所以我也包括它)</li><li id="3f5d" class="lp lq jj ki b kj ly kn lz kr ma kv mb kz mc ld lu lv lw lx bi translated">使用以下 pandas 功能绘制数据准备，以创建上述第 2 点中的一些图。</li></ol><ul class=""><li id="181c" class="lp lq jj ki b kj kk kn ko kr lr kv ls kz lt ld me lv lw lx bi translated">分组依据聚合(<code class="fe le lf lg lh b">pandas.DataFrame.groupby()</code>)</li><li id="b2ce" class="lp lq jj ki b kj ly kn lz kr ma kv mb kz mc ld me lv lw lx bi translated">分位数切宁滨(<code class="fe le lf lg lh b">pandas.DataFrame.qcut()</code>)</li><li id="5048" class="lp lq jj ki b kj ly kn lz kr ma kv mb kz mc ld me lv lw lx bi translated">应用方法转换(<code class="fe le lf lg lh b">pandas.DataFrame.apply()</code>)</li></ul></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><p id="b886" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">数据</strong></p><p id="c3fc" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文中使用的数据是一个电子商务数据集，可通过<a class="ae jg" href="https://www.kaggle.com/carrie1/ecommerce-data" rel="noopener ugc nofollow" target="_blank">这个链接</a>在 Kaggle 获得。该数据集是一个交易数据，包含 2011 年英国注册的无店铺在线零售的交易。这里要提到的是，数据已经过预处理，为本文的主要目标做好了准备，即可视化数据。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ml"><img src="../Images/4d48f74e7bf4e574fa1d95df2a2848d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qGRI5RXSGwzx_aUQ2PUj2g.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">前五行数据</p></figure><p id="b945" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如我们所见，该数据有如下八列:</p><ol class=""><li id="2357" class="lp lq jj ki b kj kk kn ko kr lr kv ls kz lt ld lu lv lw lx bi translated"><code class="fe le lf lg lh b">InvoiceNo</code>:发票号(表键)</li><li id="6bdd" class="lp lq jj ki b kj ly kn lz kr ma kv mb kz mc ld lu lv lw lx bi translated"><code class="fe le lf lg lh b">InvoiceDate</code>:发票日期</li><li id="69aa" class="lp lq jj ki b kj ly kn lz kr ma kv mb kz mc ld lu lv lw lx bi translated"><code class="fe le lf lg lh b">StockCode</code>:物品编码</li><li id="c97e" class="lp lq jj ki b kj ly kn lz kr ma kv mb kz mc ld lu lv lw lx bi translated"><code class="fe le lf lg lh b">Description</code>:物品描述</li><li id="f3cf" class="lp lq jj ki b kj ly kn lz kr ma kv mb kz mc ld lu lv lw lx bi translated"><code class="fe le lf lg lh b">Quantity</code>:物品售出数量</li><li id="dcdd" class="lp lq jj ki b kj ly kn lz kr ma kv mb kz mc ld lu lv lw lx bi translated"><code class="fe le lf lg lh b">UnitPrice</code>:物品单价(英镑)</li><li id="337c" class="lp lq jj ki b kj ly kn lz kr ma kv mb kz mc ld lu lv lw lx bi translated"><code class="fe le lf lg lh b">UnitDiscount</code>:单位商品折扣</li><li id="f0e1" class="lp lq jj ki b kj ly kn lz kr ma kv mb kz mc ld lu lv lw lx bi translated"><code class="fe le lf lg lh b">UnitWeight</code>:物品单位重量(磅)</li></ol><p id="1521" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们显示下面数字列的一些统计汇总，这是<code class="fe le lf lg lh b">data.describe() </code>方法的输出。</p><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mm"><img src="../Images/aa636d83a40d64ea256bea18ee00c89a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QVT8QLwclqNoAkpXkIDLcA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">数字列的统计摘要</p></figure><p id="0dd7" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">熊猫可视化方法一瞥</strong></p><p id="2e60" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Pandas 以<code class="fe le lf lg lh b">plot</code>方法的名义提供了可视化其系列和数据帧的功能。该功能是对<strong class="ki jk"> matplotlib </strong> <strong class="ki jk">包的</strong> <code class="fe le lf lg lh b">plot</code>方法的简单包装，具有更高级别的实现。通过使用该方法，我们可以直接从我们的数据帧/序列中生成一些有用的(基本)图，而无需调用<code class="fe le lf lg lh b">plt.show()</code>，因为我们已经在笔记本的开头导入了包，即<code class="fe le lf lg lh b">import matplotlib.pyplot as plt</code>。</p><p id="3469" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从数据帧<code class="fe le lf lg lh b">df</code>中提取<code class="fe le lf lg lh b">*type of plot*</code>的一般语法如下。</p><p id="2a86" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">df.plot.*type of plot*(*relevant-necessary parameters*)</code></p><p id="67b0" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在下文中，我们将生成一些由 handy 方法支持的图，底线是在我们加载的数据帧<code class="fe le lf lg lh b">data</code>上执行 EDA。</p><p id="1a56" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">箱线图</strong></p><p id="e493" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从上面的<code class="fe le lf lg lh b">data.describe()</code>生成的统计汇总中，我们知道<code class="fe le lf lg lh b">Quantity</code>列的数据范围比其他数值列大得多，所以这里我们只使用下面的一行代码在一个图中绘制<code class="fe le lf lg lh b">UnitPrice</code>、<code class="fe le lf lg lh b">UnitDiscount</code>和<code class="fe le lf lg lh b">UnitWeight</code>三个数值列的箱线图。我们用的方法是<code class="fe le lf lg lh b">plot.box</code>。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mn"><img src="../Images/611780061344c944f93a3b840ca543d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*32RiGaHkRefgFEVGwWWg3w.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">标准箱线图</p></figure><p id="1115" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们想让盒状图变成水平的，而不是上面的垂直的，该怎么办？此外，我们希望有一个额外的绘图网格来帮助我们更精确地看到绘图的重要部分，如中间值、异常值边界等。没问题，我们可以通过设置参数<code class="fe le lf lg lh b">vert = False</code>和<code class="fe le lf lg lh b">grid = True</code>来实现。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mo"><img src="../Images/ad4cd0271d05c112753a7630f7c1f2c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YLHkM_SowrrOS_LHXg8fsw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">带网格的水平箱线图</p></figure><p id="7b44" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据上面的箱线图，我们知道虽然<code class="fe le lf lg lh b">UnitWeight</code>列不包含任何异常值，但其他两列确实包含许多大的异常值，对于<code class="fe le lf lg lh b">UnitPrice</code>和<code class="fe le lf lg lh b">UnitDiscount</code>，阈值分别为 7.5 和 2.1 左右。</p><p id="2f52" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">直方图</strong></p><p id="2c72" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们为<code class="fe le lf lg lh b">Quantity</code>列绘制一个直方图。通过<code class="fe le lf lg lh b">plot.hist</code>，代码很简单，有一个必需的参数来表示我们想要在直方图中包含的仓的数量(这里我们选择 20)。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mp"><img src="../Images/6d2a3f298f5baec36e81f83531014ffe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KKFVC87Ceq34-9S740_4Kg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">数量列的直方图</p></figure><p id="4766" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意，我们使用了自己命名的参数(<code class="fe le lf lg lh b">title</code>)在直方图的顶部生成标题。</p><p id="ca44" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">相关矩阵</strong></p><p id="d71e" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如本文开头的总结部分所述，这个不是由<code class="fe le lf lg lh b">plot</code>方法生成的。相反，它是由数据帧的<code class="fe le lf lg lh b">corr</code>对象的子功能<code class="fe le lf lg lh b">style.background_gradient</code>产生的。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mq"><img src="../Images/d7d84cd0eb92e634107fd4e69bd8dde8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fDwbrE4-m-YRPavgWu8HAg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">数字列的相关矩阵</p></figure><p id="e6b3" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的代码中，我们设置了发散颜色贴图主题参数<code class="fe le lf lg lh b">cmap=’coolwarm’</code>(其他好的替代方案包括<code class="fe le lf lg lh b">‘RdBu_r’</code>和<code class="fe le lf lg lh b">‘BrBG’</code>)。去给他们一个尝试吧！</p><p id="19ed" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">散点图</strong></p><p id="eee5" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据上面的相关矩阵，我们知道<code class="fe le lf lg lh b">UnitPrice</code>和<code class="fe le lf lg lh b">UnitDiscount</code>的相关性相当强(0.72)。因此，我们现在使用<code class="fe le lf lg lh b">plot.scatter</code>将它们绘制成散点图。注意，我们使用自己命名的参数<code class="fe le lf lg lh b">color</code>将颜色设置为<code class="fe le lf lg lh b">sandybrown</code>。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mr"><img src="../Images/feefa3e085edc89399dadd9f5d8fb894.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sh3W4cILqnlTx4bbwKZSag.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">单价和<code class="fe le lf lg lh b">UnitDiscount</code>之间的散点图</p></figure><p id="25f8" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以清楚地看到正相关。此外，<code class="fe le lf lg lh b">UnitDiscount</code>对于每个<code class="fe le lf lg lh b">UnitPrice</code>是不同的。为了说服自己<code class="fe le lf lg lh b">UnitDiscount</code>永远不会超过<code class="fe le lf lg lh b">UnitPrice</code>，我们在散点图的顶部叠加了一个 y = x(即，单价=折扣)的线图。为此，我们利用<code class="fe le lf lg lh b">ax</code>参数。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ms"><img src="../Images/05c66d8e48e968c87890740bbed160a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UtHVqU7UHNymIOKcG33tag.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">带附加线图的散点图</p></figure><p id="757a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">条形图</strong></p><p id="45c1" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在下一张图中，我们将确定数据中销量最高的 10 种产品。因为我们还想知道产品描述，而不仅仅是产品代码，所以我们需要为产品描述和产品代码创建一个参考表。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="c3e8" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了获得整个数据中每种产品的销售总量，我们需要执行<strong class="ki jk">分组聚合。</strong>也就是说，我们按照产品代码(<code class="fe le lf lg lh b">StockCode</code>)对数据进行分组，然后对每组的<code class="fe le lf lg lh b">Quantity</code>求和。在熊猫身上，我们可以用<code class="fe le lf lg lh b">groupby</code>方法完成这类任务。一般形式如下。</p><p id="f7d7" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe le lf lg lh b">df.groupby([*columns to be grouping base*]).*aggregating function*()</code></p><p id="bcde" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们的情况下，我们有</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="ace0" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，在上面的最后一行代码中，我们已经将聚合数量与其对应的产品描述进行了合并。最终结果(前五行)是如下所示的数据帧。</p><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mt"><img src="../Images/4df8cfedb0f8258da4df3c9044424062.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l1ibrZrNcsSAz3U7KmgXOA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">df_quant_sold.head()</p></figure><p id="2c86" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们已经准备好绘制条形图了！使用的方法是<code class="fe le lf lg lh b">plot.bar</code>，要设置的参数是<code class="fe le lf lg lh b">x</code>和<code class="fe le lf lg lh b">y</code>。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mu"><img src="../Images/895e2aa1354e5cebf7cf0f248afe3d73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c0dxmXsGSrPoZ1jp5s9Gjw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">十大最畅销产品</p></figure><p id="6816" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">线条图</strong></p><p id="0a05" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，我们想知道交易总收入的月度分布情况。为此，我们首先必须构建一个包含两列的 data frame:<code class="fe le lf lg lh b">InvoiceMonth</code>和<code class="fe le lf lg lh b">TransactionRevenue</code>。与生成上面的条形图类似，我们执行 sum 聚合，按<code class="fe le lf lg lh b">InvoiceMonth</code>列分组。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mv"><img src="../Images/26d2585a85283bc5018ed4ef765cc8e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KPHeqL4QBNtfK9CMXRp12w.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">df _ 月度 _ 收入()</p></figure><p id="00ab" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，我们为总折扣创建了一个类似的数据框架，这样我们就可以理解这两个变量在每月期间的进展情况。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="a9c2" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们通过在<code class="fe le lf lg lh b">plot.line</code>中指定参数<code class="fe le lf lg lh b">x</code>和<code class="fe le lf lg lh b">y </code>绘制两个线图，在一个图中使用之前的<code class="fe le lf lg lh b">ax</code>参数。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mw"><img src="../Images/6ce30fff1c66fd9347798e137e9769ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cjPs9jFJU1HrTSUy2pL58w.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">月收入和折扣的折线图</p></figure><p id="ef26" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们看到，直到 11 月，这两个变量的趋势都是积极的。这种趋势在 11 月达到顶峰，收入和折扣的价值分别接近 90 万英镑和 25 万英镑。然而，在 12 月的最后一个月突然下降。</p><p id="b5d3" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">饼状图</strong></p><p id="e4e4" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以深入研究的另一个观点是季度对全年收入的贡献。饼图非常适合这个用例。为了实现这一点，我们需要在创建上面的折线图时对交易收入(<code class="fe le lf lg lh b">df_monthly_revenue</code>)再执行一步分组聚合。这是三个月(一个季度)每月交易总额。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mx"><img src="../Images/af5e083855eb3fef4c1fce124e16ed3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p8d00AfMfaIpwXDUx35zSg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">df _ 季度 _ 收入</p></figure><p id="5b40" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从 plot 方法制作饼图相当简单。我们只需要将参数<code class="fe le lf lg lh b">y</code>设置为我们想要在<code class="fe le lf lg lh b">plot.pie</code>中绘制其值的列。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi my"><img src="../Images/74fc79510af5d66ce4f71ca1b0cd276c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kHDH_1iRVyQV4Om_IqL6kQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">季度收入的标准饼图</p></figure><p id="64aa" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们发现传奇挡住了 Q1 的标签，这并不好。保持冷静，我们可以通过调整<code class="fe le lf lg lh b">startangle</code>参数(旋转饼图)来解决。此外，我们还可以利用<code class="fe le lf lg lh b">autopct</code>参数，通过提供每个饼图部分的百分比来增强细节。注意，我们也通过设置<code class="fe le lf lg lh b">figsize </code>参数来放大下图中的图形尺寸。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/233a02844759252d786aaeaa7bd4e606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*VsScKjjBUtpNBajdLsm75w.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">调整了饼图。好多了！</p></figure><p id="7814" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们看到，尽管 12 月份大幅下滑，但第四季度仍贡献了 2011 年全年近三分之一的收入。</p><p id="bf65" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">堆积条形图</strong></p><p id="6994" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个是我最喜欢的。我们将创建一个堆积条形图，以分析不同时段的交易收入金额的构成，形成每个季度的交易总数。通过拥有一个，我们可能能够了解低收入桶的交易数量是否随着时间的推移而增长，因此我们可以相应地调整我们的策略(例如，我们可能希望重新标记网站，使其看起来更具排他性，以瞄准更多优质买家)。</p><p id="9057" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了画出我们的，我们必须做几个准备步骤。第一个是将<code class="fe le lf lg lh b">TransactionRevenue</code>列成 bucketize(宁滨)列。我们将创建三个存储桶:低(低于 25 个百分点)、中(介于 25 和 75 个百分点之间)和高(高于 75 个百分点)。我发现<code class="fe le lf lg lh b">pd.qcut</code>是完成这项任务的便利工具。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="d06c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们创建三个(代表存储桶的数量)counter(二进制值)列，这将帮助我们执行下一步的分组聚合，以计算每个存储桶中的事务数量。</p><p id="5431" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们通过使用<code class="fe le lf lg lh b">apply</code>方法来做到这一点，这基本上是一种允许我们传递函数并<strong class="ki jk">将</strong>应用于熊猫系列的每个值的功能。这里，我们想要应用的函数是一个简单的条件(if-else)赋值函数。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="c3cf" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后一个准备步骤包括分组聚合，随后是值规范化(使每个条形总和达到 100%)，如下所示。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="1736" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是我们准备绘制的数据帧的最终结果。</p><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi na"><img src="../Images/f1ea8134aaa97a6d234a78b66b639d8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H5zUcE0GaUpeAA323zYfSQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">df _ percent(df _ quarterly _ revenue _ bucket 的规范化值)</p></figure><p id="c838" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，生成图的代码如下。通过在<code class="fe le lf lg lh b">plot.bar</code>内设置参数<code class="fe le lf lg lh b">stacked = True</code>实现条形图的堆叠形式。</p><figure class="mf mg mh mi gt iv"><div class="bz fp l di"><div class="mj mk l"/></div></figure><figure class="mf mg mh mi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nb"><img src="../Images/b6afa133a1842a23506d4e1e6ed9f10c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PPkooMaFKPf114EvQC1Dyw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">每个季度的交易时段细分</p></figure><p id="e21c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">除其他外，上图告诉我们，高价值交易的比例趋向于积极的趋势(即，在各个季度中增加)，除了最后一个第四季度，每个季度中高价值交易的比例都有所增加。</p></div><div class="ab cl li lj hx lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="im in io ip iq"><p id="1d82" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">结束语</strong></p><p id="aa3a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我们已经能够使用 Pandas <code class="fe le lf lg lh b">plot</code>方法直接从我们的数据框架中生成各种各样的图，这些图对于进行典型的探索性数据分析(EDA)肯定是有用的。关于这一点，我需要说明的是，我们在这里生成的图的种类<em class="md">并不详尽</em>代表了该方法支持的所有图(关于更完整的特性，请参考该方法的官方文档<a class="ae jg" href="https://pandas.pydata.org/pandas-docs/version/0.23.4/generated/pandas.DataFrame.plot.html" rel="noopener ugc nofollow" target="_blank">这里</a>)。</p><p id="3dc5" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">话虽如此，但这并不意味着熊猫完全可以进行可视化。我们确实需要借助 Matplotlib 或其他绘图软件包来制作更精细的图，如蜂群图、小提琴图等。，以及调整我们在这里创建的情节中的高级细节(通过丰富的<code class="fe le lf lg lh b">plt</code>方法)。</p><p id="6480" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但我相信，如果我们需要的大多数图表可以直接从我们的数据框架中产生，这仍然是很好的，这意味着我们可以减少执行数据分析和可视化的摩擦！</p><p id="4aaa" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，感谢您的阅读，让我们在 https://www.linkedin.com/in/pararawendy-indarjo-5b87bab7<a class="ae jg" href="https://www.linkedin.com/in/pararawendy-indarjo-5b87bab7/?originalSubdomain=id" rel="noopener ugc nofollow" target="_blank">通过 LinkedIn 与我联系。</a></p></div></div>    
</body>
</html>