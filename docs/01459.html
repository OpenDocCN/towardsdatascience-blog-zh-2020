<html>
<head>
<title>Particle Tracking at CERN with Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">欧洲粒子物理研究所用机器学习进行粒子跟踪</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/particle-tracking-at-cern-with-machine-learning-4cb6b255613c?source=collection_archive---------15-----------------------#2020-02-09">https://towardsdatascience.com/particle-tracking-at-cern-with-machine-learning-4cb6b255613c?source=collection_archive---------15-----------------------#2020-02-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/abaa771eb07d42249c2c410252a89596.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bma4ZxCBH96atcM7ZQ0Wyg.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">CMS探测器中模拟的高能碰撞，L. Taylor — <a class="ae jg" href="http://cds.cern.ch/record/39444" rel="noopener ugc nofollow" target="_blank"> CERN PhotoLab </a></p></figure><div class=""/><div class=""><h2 id="02a2" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">机器学习可以在高能物理中用于发现和表征新粒子吗？</h2></div><p id="8a0e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae jg" href="https://www.kaggle.com/c/trackml-particle-identification/" rel="noopener ugc nofollow" target="_blank"> TrackML </a>是2018年的一场Kaggle比赛，奖金为25 000美元，挑战是从硅探测器中留下的3D点重建粒子轨迹。<a class="ae jg" href="https://home.cern/" rel="noopener ugc nofollow" target="_blank"> CERN </a>(欧洲核研究组织)提供了粒子碰撞事件的数据。它们在那里发生的频率大约是每秒几亿次碰撞，或者每年几十千兆字节。在筛选如此大量的数据时，显然需要尽可能高效，这就是机器学习方法可能有所帮助的地方。</p><h1 id="b96b" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">背景</h1><p id="d234" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">粒子，在这种情况下是质子，在大型强子对撞机(LHC)中被提升到高能量——当碰撞时，每束可以达到6.5 TeV，总共13 TeV。电磁场被用来加速27公里长环路中的带电质子。当质子束碰撞时，它们会产生各种各样的亚原子副产品，这些副产品会迅速衰变，为一些最基本的物理学问题提供有价值的信息。</p><p id="b92b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">探测器由一层层的子探测器组成，每个子探测器都被设计用来寻找特定的粒子或特性。有测量能量的量热仪、确定粒子种类的粒子识别探测器和计算粒子路径的跟踪装置。我们当然对跟踪部分感兴趣，当粒子通过这些类型的探测器时，微小的电信号被记录下来。我将讨论的是重建这些记录的轨迹模式的方法，特别是涉及机器学习的算法。</p><h1 id="7f2f" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">数据</h1><p id="9f52" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">由于目的是将机器学习应用于数据，CERN的人员将其分为训练集和测试集，以便验证模型。训练数据集包含粒子的初始参数及其记录的命中，以及生成粒子和命中之间的映射。测试数据只有记录的点击。然后，我们剩下的任务是将每次点击与一个音轨相关联。</p><p id="23f6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我读到2020年是我们应该<a class="ae jg" rel="noopener" target="_blank" href="/python-for-data-science-a-guide-to-data-visualization-with-plotly-969a59997d0c">与图表互动</a>的一年，所以这里是探测器中使用<a class="ae jg" href="https://plot.ly" rel="noopener ugc nofollow" target="_blank"> Plotly </a>的10 000次点击的样子:</p><figure class="mr ms mt mu gt iv"><div class="bz fp l di"><div class="mv mw l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">LHC的粒子观测</p></figure><p id="8edb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">根据它们的<em class="mx"> layer_id </em>对命中进行着色，layer_id是检测器层的数字标识符。坐标以毫米为单位，因此我们在这里考虑的探测器部分大约有三米长，横截面大约为一平方米。粒子需要通过不同的层来追踪，为了更好地理解轨迹可能的样子，我直接从训练数据中绘制了一些轨迹。我们可以看到，大多数粒子从原点出发，也就是碰撞发生的地方。</p><figure class="mr ms mt mu gt iv"><div class="bz fp l di"><div class="mv mw l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">训练集中的实际粒子轨迹</p></figure><h1 id="94db" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">螺旋聚类</h1><p id="f02c" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">我们可以做一些巧妙的预处理，利用大多数轨迹遵循螺旋模式的假设，使数据更有序。这是因为存在磁场，否则粒子会直线运动。粒子动量也会影响螺旋的紧密程度，动量越高，轨迹就越直。我们可以通过首先获得距离来说明曲率</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div class="gh gi my"><img src="../Images/1570b8e942e089de36d176a71237e90e.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*6BTgS4G191P5i8hwIW4SaA.png"/></div></figure><p id="937e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后用击中坐标除以它。这将使同一轨迹上的点相互靠近。</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/0bd5cde7e33d3a1cb57f50496dd60230.png" data-original-src="https://miro.medium.com/v2/resize:fit:334/format:webp/1*GGPeFVScXi7W03lxF3gL_Q.png"/></div></figure><p id="ddcc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以在训练数据上验证我们的假设，其中我们知道整个检测器中的粒子id。因此，如果我们在应用螺旋变换之前以及之后可视化一些粒子的轨迹，我们可以清楚地看到集群出现。这意味着许多粒子像假设的那样在z方向上以螺旋模式行进。</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi na"><img src="../Images/1814b6e9662c4bc229936805e7090e1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GcGQvGsXlUBgu-6EoqhQcw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">与预处理时相比的点击横截面</p></figure><p id="974b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这提供了在数据上使用聚类来将轨迹分组到某个原始粒子的机会。DBSCAN(带噪声的应用程序的基于密度的空间聚类)可用于此目的。该方法用Python编写，可转换为以下代码片段:</p><figure class="mr ms mt mu gt iv"><div class="bz fp l di"><div class="nb mw l"/></div></figure><p id="e26e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">标准缩放器减去平均值并缩放到单位方差，它用于通过标准化变量来提高聚类的性能。特征缩放是机器学习预处理过程中的一个常见步骤。scaler和DBSCAN都是从scikit learn导入的，还有一个定制的<a class="ae jg" href="https://github.com/LAL/trackml-library" rel="noopener ugc nofollow" target="_blank"> TrackML库</a>用于处理加载事件或洗牌等。此处未显示。在任何情况下，在使用eps=0.00715的测试数据上，聚类给了我0.20817分(满分1分)。Eps是两个样本之间的最大距离，其中一个样本被视为与另一个样本相邻。</p><p id="d8c3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">考虑到分数，我们可以得出结论，在这种简单的形式下，螺旋聚类确实不是那么准确。至少它作为一个基线，剧透警报，表现最好的方法实现起来有点棘手。聚类仍然在许多算法中使用，一些算法达到0.8分以上。</p><h1 id="a445" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">挑战亚军</h1><p id="ff76" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">Kaggle用户outrunner将其解决方案基于人工神经网络。该模型输出具有1和0的邻接矩阵，1表示命中在同一轨道上，0表示它们不在同一轨道上。模型的规模太大了(N ~ 100k ),必须分成更小的单元。它们将一对两次击中作为输入，并输出它们的关系，或者它们在同一轨道上的概率。</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/5d7191e6bf6216e75eaaae44003ddef6.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*PmFhH0uG917qCHPb_HdrWw.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Outrunner神经网络模型</p></figure><p id="d4ed" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">考虑所有的匹配对，并且在每对中考虑27个特征。然后在其上训练一个具有4k-2k-2k-2k-1k个神经元的5隐层多层感知器(MLP)。通常，重建轨迹的方法并不将所有的命中对作为输入，而是仅将相邻的命中对作为输入，这或多或少是传统的连接点。所使用的特征包括击中方向的单位向量，并且使用轨迹是线性或螺旋形状的假设，可以减少假阳性的数量。因为如上所述，当所有可能的对都被使用时，不属于相同轨道的对占优势是不足为奇的。</p><p id="d034" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了重建轨迹，outrunner从初始命中开始，并从具有最高预测分数的对中形成种子。添加的第三个匹配项是将两个匹配项放在一起时最大化概率总和的匹配项。它还会接受检查，以查看它是否符合从原点穿过种子对的圆。重复该过程，直到没有进一步的命中符合该轨迹。此后，以相同的方式创建导致新轨道的新的初始命中，直到数据中没有剩余命中。</p><p id="8222" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后一步是解决轨道之间的不一致，因为它们中的许多包括相同的命中。单个音轨的质量由唯一分配给它的点击量来量化。这一措施是用来排序重叠的轨道，并以最佳方式合并它们，如下所示。</p><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/574b8aa0ad192cdfdc78f2c8a49e598f.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*G6hatoMachMEj46holijRg.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">示例轨迹重建</p></figure><p id="18c0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这种深度学习方法在Kaggle比赛中获得了第二名，得分为0.90302。关于亚军的进一步阅读:</p><div class="is it gp gr iu ne"><a href="https://medium.com/kaggle-blog/winner-interview-particle-tracking-challenge-first-runner-up-pei-lien-chou-41247be42dbf" rel="noopener follow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd jk gy z fp nj fr fs nk fu fw ji bi translated">冠军访谈|粒子追踪挑战赛亚军，周佩莲</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">怎样才能接近顶峰？见见周佩莲，我们最近的多轨道粒子赛的亚军得主…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">medium.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns ja ne"/></div></div></a></div><h1 id="7b79" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">获胜的选手</h1><p id="82c3" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">获胜的贡献来自得分为0.92182的团队顶级夸克。在机器学习方面，他们的解决方案有一些逻辑回归，用于修剪掉出现的多余轨迹，但除此之外，它是基于统计和3D几何的经典数学建模。它还包括磁场作为探测器中z位置的函数的原始模型。有趣的是，他们使用了很少的训练事件，大多数模型拟合只使用了一个事件[2]。</p><h2 id="fca0" class="nt lv jj bd lw nu nv dn ma nw nx dp me lh ny nz mg ll oa ob mi lp oc od mk oe bi translated"><strong class="ak">算法</strong></h2><ol class=""><li id="4a5a" class="of og jj la b lb mm le mn lh oh ll oi lp oj lt ok ol om on bi translated"><strong class="la jk">种子生成:</strong>算法从选择有希望的命中对开始。大多数轨迹被探测器最内部的50对相邻层覆盖，因此起始点对的候选，或种子，都是这些层上的匹配对。通过使用不同参数的逻辑回归剪枝，减少了候选的数量，最明显的是如果从这两个点外推直线，离原点有多远，其次是给出粒子方向的击中角度。</li><li id="ce82" class="of og jj la b lb oo le op lh oq ll or lp os lt ok ol om on bi translated"><strong class="la jk">扩展到三元组:</strong>通过将现有点之间的线扩展到相邻层并将10个最接近的点存储为候选点，将第三个点添加到轨迹中。再次使用逻辑回归修剪，拒绝坏的三元组。</li><li id="5f97" class="of og jj la b lb oo le op lh oq ll or lp os lt ok ol om on bi translated"><strong class="la jk">轨迹跟踪:</strong>一个螺旋被安装到三联体并延伸到其他层。最接近它的点击被添加到轨道。</li><li id="4a18" class="of og jj la b lb oo le op lh oq ll or lp os lt ok ol om on bi translated"><strong class="la jk">轨迹整合:</strong>存在重叠模块，导致测量点未被考虑在内，或者换句话说，探测器中每层的多次命中。如果这些命中比阈值更接近，则它们被添加到轨迹中。</li><li id="6b50" class="of og jj la b lb oo le op lh oq ll or lp os lt ok ol om on bi translated"><strong class="la jk">音轨歧义解决:</strong>到目前为止，每个音轨都被认为是独立的，这导致了不同音轨之间在命中方面的大量重叠。使用基于训练数据的评分标准来选择最佳轨迹。然后，从所有其他冲突路径中移除包含在该路径中的所有命中，这是反复进行的，直到没有冲突剩余。</li></ol><figure class="mr ms mt mu gt iv gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/52a13a8b440215f1ea2d6653a22219cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*IXd70QNI9TwX84cBj0verg.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">获胜算法:1。配对查找，2。延伸到三连音，3。添加来自重叠模块和4的命中。最终音轨歧义消除。[3]</p></figure><h1 id="270b" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">结论</h1><p id="b9c5" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">根据竞赛出版物[3]，无法与粒子跟踪的最新技术水平进行直接比较，但我们知道当前的带电粒子跟踪算法基于三个阶段:播种、轨迹跟踪和轨迹选择，许多顶级解决方案也使用这三个阶段。共有651个团队参加了竞赛，并由此发明了许多新颖的解决方案。</p><p id="7e94" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我已经介绍了一种对数据应用聚类的简单方法，还有更复杂、更精确的解决方案，使用同样的技术，速度相当快。获胜的算法也是如此，它使用高度优化的数据结构，很少使用机器学习，而神经网络的解决方案的运行时间根据早先链接的Kaggle采访是“一个天文数字”。我读到了一个很有希望的<a class="ae jg" href="https://www.kaggle.com/c/trackml-particle-identification/discussion/63256" rel="noopener ugc nofollow" target="_blank">评论</a>，它来自冠军和亚军，是关于合并他们两个成功的技术的:“我只能想象使用你的接近最佳的配对得分和我的曲目扩展/选择的解决方案会得分有多高”。所有这些不同的方法无疑给了CERN的科学家一些思考的素材。</p></div><div class="ab cl ou ov hx ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="im in io ip iq"><p id="310d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">[1]:欧洲粒子物理研究所，探测器如何工作，【https://home.cern/science/experiments/how-detector-works T2】</p><p id="0e85" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">[2]: J. Wind，离群密度估计的快速可扩展跟踪，2018，<a class="ae jg" href="https://github.com/top-quarks/top-quarks/blob/master/top-quarks_documentation.pdf" rel="noopener ugc nofollow" target="_blank">https://github . com/top-quarks/top-quarks/blob/master/top-quarks _ documentation . pdf</a></p><p id="f926" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">[3]: S .阿姆鲁什等人。al，跟踪机器学习挑战:准确性阶段，关于机器学习挑战的Springer系列，第231-264页，2019年</p></div></div>    
</body>
</html>