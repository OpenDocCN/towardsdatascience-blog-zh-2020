<html>
<head>
<title>Six Real-World Data Potholes — And How to Deal With Them</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">六个现实世界中的数据陷阱——以及如何应对它们</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/six-real-world-data-potholes-and-how-to-deal-with-them-24b87a4af73d?source=collection_archive---------26-----------------------#2020-03-10">https://towardsdatascience.com/six-real-world-data-potholes-and-how-to-deal-with-them-24b87a4af73d?source=collection_archive---------26-----------------------#2020-03-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/9ea061ac6bb12316300ebd5dd7696676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bV3e0WOqb39O-gGWuHoEzg.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://www.flickr.com/photos/ceonyc/118754991/in/photostream/" rel="noopener ugc nofollow" target="_blank">照片</a>由查理/SANY0012 (CC-SA 2.0)拍摄</p></figure><p id="8de3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你找到你的数据，加载它，建立它的模型——然后扔掉垃圾。就像他们说的，一定是垃圾。当然，您确保有一个很好的矩形文件，具有一致命名的列，并且您删除了人们在 Excel 文档中输入的随机注释。那么是什么原因呢？</p><p id="e288" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里有六种常见的、现实世界中的数据违规现象，你迟早都要面对。</p><h1 id="f4b6" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">1.行数比预期的多</h1><p id="48ed" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们希望每行有一条记录。在 95%的文件中，这就是你所拥有的。但是突然一个 join 给出了警告，你意识到还有多余的。为什么？可能是因为某人的查询构建得很差，或者您认为行是一回事，但它实际上是完全不同的东西。</p><p id="b757" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">案例研究:</p><blockquote class="mh mi mj"><p id="6144" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">我以为在住院医师资格表中，每个大学生占一行。事实上，每种状态占一行:一小部分学生在他们的大学生涯中有多种状态。这没有记录，当然，在这些状态上也没有标识符或时间戳。</p></blockquote><p id="13cf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">策略</strong>:每当你加载数据时，聚集你认为唯一的行标识符，一边走一边计数，看看是否有任何行是&gt; 1。然后你必须决定省略一些或者把它们合并在一起——或者改变你的分析，使之更复杂，以便两者都用。</p><h1 id="eb1d" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">2.随着时间的推移改变约定</h1><p id="8b25" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">在数据没有严格控制的情况下——也就是手动输入，没有什么指导原则——你可以在不同的时间或由不同的人使用不同的约定。缩写会改变。使用新的代码系统。日期格式改变。很烦。</p><p id="9822" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有时，这些转变甚至有一个很好的理由，比如程序上的改变，或者意识到需要一个新的类别。当然，仍然应该有人清理旧的价值观——但是你对他们没有这样做感到惊讶吗？</p><p id="28d7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">案例研究:</p><blockquote class="mh mi mj"><p id="82a1" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">我在分析接受高、中、低金额资助的人。当前的数据输入约定对每种类型使用三个字母的缩写，但是回顾四年前，我发现使用的是全名——大写和拼写差异很大；显然根本没有标准化。负责此事的员工后来都换了部门，你对此感到惊讶吗？</p></blockquote><p id="b69f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">案例研究 2:</p><blockquote class="mh mi mj"><p id="d55d" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">我过去分析国会数据，尤其是对候选人的捐款。然而，将投票记录或条款与捐款匹配起来并不容易，因为没有一致的 id 给国会成员，我不得不依靠他们的名字。不同的来源包括中间名和头衔，比如 Jr。最糟糕的是，数量惊人的政客有一个昵称——这就是国会官方网站上列出的！</p></blockquote><p id="3981" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">策略:总是总结你的分类变量，即使只是得到所有唯一的值和它们的频率，并看着它们被排序。然后你可以合并等价的。对于姓名和其他字符串数据，如果有相当多但数量有限的情况，应该尽可能地进行抽查，最好使用正则表达式来分离出可以更可靠地匹配的字符串片段，比如全大写的姓氏。</p><h1 id="b86e" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">3.不同的缺失值代码</h1><p id="4d50" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们都知道缺失值，以及如何处理它们，对吗？更讨厌的是多种表观缺失出现在同一个场的时候。它们应该被保留、抛弃还是合并？当然，这要看情况。</p><p id="9cc4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">案例研究:</p><blockquote class="mh mi mj"><p id="11c8" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">在人口统计数据中，我检查了性别一栏(被误标为“性别”)，这一栏表面上只包含男性或女性的值。有正常的缺失数据，给定为零…但也有空白值，有些“未提供”，最糟糕的是“999”对于不同的集合或编码协议，这些都意味着相同的东西吗，或者在每种情况下意味着不同的东西吗？一些真的意味着，例如“不适用”而不是“不可用？”我们是猜测，还是能发现？</p></blockquote><p id="577d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">策略</strong>:如上，检查你的范畴值，以及你的数字范围。任何超出预期范围的都应该检查出来。</p><p id="82e6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我见过-1、0 和 9 的字符串被用作需要重新编码的特殊代码(可能在不同的列中)。我见过在同一个文件中使用的各种丢失的字符串，它们都意味着丢失，因为协议不同，包括空格、NA、NIL、*。，-，还有很多。</p><p id="22de" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要处理这些情况，首先您只需了解用于获取和记录数据的协议。这可能需要(恐怖！)与一个活生生的人交谈——他现在在另一个部门工作，目前正在度假——因为，当然，它从未在任何地方被记录下来。</p><h1 id="ed81" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">4.无意义的时间线</h1><p id="cb33" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">如果您有日期或时间列，请检查它们是否有意义。通常情况下，其中一些不会，因为一个事件应该总是先于另一个事件。</p><p id="3276" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">案例研究:</p><blockquote class="mh mi mj"><p id="1276" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">我下载了课程注册的数据，并将它们加入到学生详细信息表中，比如专业。我感兴趣的是，根据一个学生获得学位需要多少个学期，课程量会有什么变化。看资料发现，学生在被录取前都在上课！</p><p id="5bbb" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">问题的根源:录取日期只是最近的学位，一些学生被多次录取，例如，一个硕士项目或做学士后工作。我(从一个中心办公室)获得的数据摘录隐藏了这个细节，会导致一些非常错误的结论。</p></blockquote><p id="2dd2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">策略:核对所有日期。找出任何违反假定关系或超出预期范围的情况。通常，一些额外的数据被隐藏在某个地方，如在我的例子中，或者与日期相关联的事件没有我们期望的确切定义——是当用户点击按钮结账时记录的“购买”时间戳，还是当他们的卡运行时记录的时间戳等等。通常只是垃圾数据，日期转换不正确(众所周知，在一些平台上很难处理)或输入格式错误:“10/12”是指 12 月 10 日还是 10 月 12 日？每个人都收到备忘录了吗？</p><h1 id="fdb2" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">5.键入错误的数字</h1><p id="3e41" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">当你手工输入一些数据时，不可避免地会输错一些。常见的错误是重复的数字——尤其是在一串零、丢失的数字和换位中。</p><p id="e50d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">案例研究:</p><blockquote class="mh mi mj"><p id="4426" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">我当时在协助一个大型调查，收集某个部门员工的工资。大约 30%的受访者使用网络界面手工输入数据，而不是上传电子表格。(一些电子表格可能也是手工输入的。)</p><p id="2193" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">我们进行了标准的异常值检查，以寻找数量级过大或过小的值。通常问题是输错了零:120，000 会被输入为 12，000 或 1，200，000。(web 字段中没有显示逗号，这可能会有所帮助。)</p><p id="9052" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">但是我在详细检查记录时注意到了其他错误的值(另一个原因):数字被调换了，例如 57000 换成了 75000。这比一个数量级的变化要小得多，并且会被我们的常规检查所忽略。这些误差到底有多大？我在 R 中运行了一些模拟，发现如果发生在前两位，换位通常会导致数字过大或过小三倍。通过与期望值进行更具体的比较，这也是可以通过编程进行检查的事情(对极端情况进行相当多的手动审查)。</p></blockquote><p id="b2a4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">策略</strong>:当然是做标准的异常值检查；但是这首先需要知道什么是正常的——或者合理的。我在以前的工作场所发现的另一个问题是，我们的异常值检查将值与平均值进行比较——这本身就非常容易受到异常值的影响。运行更多的模拟，我发现一个大的异常值(由重复的零产生)极有可能夸大均值/标准差，以至于<em class="mk">看起来不再像一个异常值。</em>我们需要转向不太敏感的指标，比如中位数和 MAD。当然，历史和领域知识也影响了我们的预期。</p><h1 id="16dc" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">6.神秘失踪的数据</h1><p id="6411" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">让带有“NA”的单元格告诉您数据丢失是一回事；对于行来说，神秘地不导出是另一回事。我们必须记住的一件事是我们的数据系统的局限性，尤其是在寻找旧数据的时候。</p><p id="212b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">案例研究:</p><blockquote class="mh mi mj"><p id="eb46" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">我使用一个庞大而笨拙的报告系统为一项纵向研究寻找数据。各种预构建的查询允许我指定所需群组的年份或季度。我照做了，并下载了 CSV。</p><p id="ffaf" class="kg kh mk ki b kj kk kl km kn ko kp kq ml ks kt ku mm kw kx ky mn la lb lc ld im bi translated">分析进行到一半时，我意识到随着时间的推移，数据越来越少。结果是，不管指定的日期是什么，报告中只包括了当前活跃的用户。是的，这是非法的。我必须找到数据的替代来源(不容易)。</p></blockquote><p id="9b98" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">策略</strong>:和目前为止的每一项一样，汇总你的变量，包括日期，然后看看你有多少个案例。这种变化方式很奇怪吗？另外，随机或从有代表性的班级中抽出几个人，通过数据追踪他们。他们出现在应该出现的地方，而不是不应该出现的地方吗？</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="9450" class="le lf it bd lg lh mv lj lk ll mw ln lo lp mx lr ls lt my lv lw lx mz lz ma mb bi translated">结论</h1><p id="39d7" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">从这六个项目和案例研究中可以得出两大主题。一个在你的控制之下，一个不在:</p><p id="91ff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">检查你的数据</strong>。在它上面聚集。列出你对它们的假设，并明确检查它们是否成立——这包括非常基本的、看起来愚蠢的假设，因为其中一些不可避免地会被违反。</p><p id="758e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">糟糕的文档是你的敌人。缺少元数据的导出。记录不良或根本没有记录的查询。只存在于某人头脑中的定义——而且他们正在休假。我们知识中的这些漏洞隐藏着重大和微妙的问题；尤其是当它们与我们自己的常识、假设和专业判断相抵触时——因为其他人有不同的想法，或者根本不思考。你能做的最好的事就是意识到你所不知道的，提防麻烦。</p></div></div>    
</body>
</html>