<html>
<head>
<title>Build a COVID-19 Dashboard in Python with Plotly Dash</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python和Plotly Dash构建新冠肺炎仪表板</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-track-covid-19-cases-in-the-united-states-in-python-9b297ff9f6f5?source=collection_archive---------5-----------------------#2020-04-08">https://towardsdatascience.com/how-to-track-covid-19-cases-in-the-united-states-in-python-9b297ff9f6f5?source=collection_archive---------5-----------------------#2020-04-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1154" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用您自己的分析仪表板跟踪冠状病毒病例</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f2e47cadaebd42234ca6aaf795381991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YDETBU62ekWN5zGmJi_d8g.png"/></div></div></figure><p id="eaba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi lq translated">自从美国本土出现第一例新冠肺炎病毒以来，尚不清楚T2到底有多少人接触到了这种病毒。幸运的是，从那以后，美国<a class="ae ma" href="https://www.nytimes.com/interactive/2020/03/26/us/coronavirus-testing-states.html" rel="noopener ugc nofollow" target="_blank">大大增加了我们的测试能力</a>。</p><p id="a943" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但我们仍在追赶。面对<a class="ae ma" href="https://fortune.com/2020/02/24/coronavirus-statistics-who-data-transparency/" rel="noopener ugc nofollow" target="_blank">相互矛盾的报告</a>确诊病例的数量，<strong class="kw iu">我们的数据科学家和网络开发人员团队建立了一个</strong> <a class="ae ma" href="http://ncov19.us /" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">仪表盘</strong> </a>来显示<strong class="kw iu">我们能够找到的最准确的数据</strong>，以<strong class="kw iu">最干净</strong>的方式。</p><p id="3067" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们已经完成并发布了我们的仪表板，我们编写了这个高级代码概述，供数据科学家和程序员遵循。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mb mc l"/></div><p class="md me gj gh gi mf mg bd b be z dk translated"><a class="ae ma" href="https://ncov19.us/" rel="noopener ugc nofollow" target="_blank">https://ncov19.us/的演示</a></p></figure><h1 id="464e" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">仪表板功能</h1><p id="9930" class="pw-post-body-paragraph ku kv it kw b kx mz ju kz la na jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">当我们开始设计上述仪表板时，我们知道我们希望包括以下一些主要功能:</p><ul class=""><li id="d37b" class="ne nf it kw b kx ky la lb ld ng lh nh ll ni lp nj nk nl nm bi translated">美国、所有50个州和所有县(加上华盛顿特区和美国属地)的检测、确诊病例和死亡人数*</li><li id="805a" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp nj nk nl nm bi translated">新冠肺炎确诊病例最集中的热图</li><li id="4b16" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp nj nk nl nm bi translated">各州公共考试中心的位置</li><li id="7fc6" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp nj nk nl nm bi translated">主要健康组织通过Twitter和他们的网站发布的最新消息</li></ul><p id="1e56" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="lz">*我们也希望包括已恢复病例的数量，但在此之前，我们正在搜索可靠且准确的数据集。</em></p><h1 id="535c" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">教程大纲</h1><p id="e2ce" class="pw-post-body-paragraph ku kv it kw b kx mz ju kz la na jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">分解成各个部分，仪表板就是一堆以视觉上吸引人的方式显示的数据集。我们网站上的每个图表、图形和表格都是我们使用CSS找到、清理和设计的数据集。</p><p id="7b8e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">记住这一点，以下是我们将在本教程中涵盖的所有主要步骤:</p><ol class=""><li id="5bd6" class="ne nf it kw b kx ky la lb ld ng lh nh ll ni lp ns nk nl nm bi translated">决定我们的应用程序需要哪些输入(技术堆栈和数据源)</li><li id="3487" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp ns nk nl nm bi translated">初始化Plotly Dash web应用程序</li><li id="9d62" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp ns nk nl nm bi translated">桌面/移动用户的网页路由</li><li id="8681" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp ns nk nl nm bi translated">为我们的可视化清理数据</li><li id="d2c3" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp ns nk nl nm bi translated">将数据显示为图形或图表并设置样式</li></ol><p id="ebaf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="lz"> ( </em> <a class="ae ma" href="https://github.com/ncov19-us/front-end" rel="noopener ugc nofollow" target="_blank"> <em class="lz"> Github回购如果你想跟进</em> </a> <em class="lz"> ) </em></p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="dd00" class="mh mi it bd mj mk oa mm mn mo ob mq mr jz oc ka mt kc od kd mv kf oe kg mx my bi translated"><strong class="ak">选择我们的技术组合</strong></h1><p id="22b7" class="pw-post-body-paragraph ku kv it kw b kx mz ju kz la na jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">当我们的团队决定使用哪个堆栈时，我们知道如果我们用Python编写应用程序，我们的主要目标<strong class="kw iu">清理&amp;显示医疗保健数据</strong>将会最好地完成。我们考虑过用R编写应用程序，但是Flask server / Dash-rendered前端的易用性吸引了我们的注意。</p><p id="4b5e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这种情况下，我们知道Plotly Dash和它的一些库(Dash Core、HTML和Bootstrap Components)可以提供我们需要的工具，并节省我们大量的开发时间。最后但同样重要的是，MongoDB带来了灵活性&amp;托管和缓存数据的可伸缩后端。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/86d481ee2a9fb89fcb7a7c0837ac694b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Wtx9m-3GJ6o7oYuMz8q5Q.png"/></div></div></figure><h1 id="912d" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">选择我们的数据源</h1><p id="5ca5" class="pw-post-body-paragraph ku kv it kw b kx mz ju kz la na jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">就数据而言，我们认识到大多数新闻媒体引用了来自<a class="ae ma" href="https://github.com/CSSEGISandData/COVID-19" rel="noopener ugc nofollow" target="_blank">约翰霍普金斯大学系统科学与工程中心</a>的新冠肺炎患者数据。每日回购。csv文件是从17个不同的全球卫生组织收集的，因此在这些文件和来自<a class="ae ma" href="https://covidtracking.com/" rel="noopener ugc nofollow" target="_blank"> COVIDTracking </a>的数据之间，我们的团队对我们的web应用程序上报告的数字充满信心。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="6477" class="mh mi it bd mj mk oa mm mn mo ob mq mr jz oc ka mt kc od kd mv kf oe kg mx my bi translated">初始化Plotly Dash Web应用程序</h1><p id="45d1" class="pw-post-body-paragraph ku kv it kw b kx mz ju kz la na jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">既然我们的技术栈和库已经解决了，让我们拼凑一些代码吧！第一步:在我们的<code class="fe og oh oi oj b">/app.py</code>文件中设计核心应用程序。</p><h2 id="d8dd" class="ok mi it bd mj ol om dn mn on oo dp mr ld op oq mt lh or os mv ll ot ou mx ov bi translated">app.py中的第1-28行</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/9c9d1a3a7bfd86e0d98a4fb02bb987e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6BkZ1-rcGyURu0PZIEpi2w.png"/></div></div></figure><p id="40aa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，我们将导入Flask(用于我们在第11行创建的服务器)，并将Dash作为我们的前端应用程序。Dash使用Flask进行部署，因此当我们编写:</p><pre class="kj kk kl km gt ox oj oy oz aw pa bi"><span id="a892" class="ok mi it oj b gy pb pc l pd pe">server = flask.Flask(__name__)</span></pre><p id="2398" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">…这使我们能够像部署任何其他Flask应用程序一样部署我们的应用程序！</p><p id="4960" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，让我们为SEO分配我们的服务器、样式表和元标签:</p><pre class="kj kk kl km gt ox oj oy oz aw pa bi"><span id="c5f5" class="ok mi it oj b gy pb pc l pd pe">app = dash.Dash(<br/>__name__,</span><span id="b2c8" class="ok mi it oj b gy pf pc l pd pe"><em class="lz">server </em>= server,</span><span id="4d47" class="ok mi it oj b gy pf pc l pd pe"><em class="lz">external_stylesheets </em>= [</span><span id="3fff" class="ok mi it oj b gy pf pc l pd pe">dbc.themes.SLATE,  <em class="lz"># Bootswatch theme</em></span><span id="0f37" class="ok mi it oj b gy pf pc l pd pe">"https://use.fontawesome.com/releases/v5.9.0/css/all.css",],</span><span id="1e9f" class="ok mi it oj b gy pf pc l pd pe"><em class="lz">meta_tags </em>= [{</span><span id="c4b0" class="ok mi it oj b gy pf pc l pd pe">"name": "description",</span><span id="a6e1" class="ok mi it oj b gy pf pc l pd pe">"content": "Live coronavirus news, statistics, and visualizations tracking the number of cases and death toll due to COVID-19, with up-to-date testing center information by US states and counties. Also provides current SARS-COV-2 vaccine progress and treatment research across different countries. Sign up for SMS updates."},</span><span id="1ba0" class="ok mi it oj b gy pf pc l pd pe">{"name": "viewport", "content": "width=device-width, initial-scale=1.0"},],)</span></pre><p id="cd98" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">太好了，现在我们的应用程序可以作为网页访问了！</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="4771" class="mh mi it bd mj mk oa mm mn mo ob mq mr jz oc ka mt kc od kd mv kf oe kg mx my bi translated">桌面/移动用户的网页路由</h1><p id="aa89" class="pw-post-body-paragraph ku kv it kw b kx mz ju kz la na jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">现在我们已经在<code class="fe og oh oi oj b">/app.py</code>中构建了应用程序外壳，让我们创建一个<code class="fe og oh oi oj b">/run.py</code>文件，当用户访问URL &amp;时处理它，将它们路由到正确的方向。</p><p id="f8bf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如，如果一个Android移动用户访问我们的网站，那么我们默认布局中的任何代码——即第10行的<code class="fe og oh oi oj b">build_desktop_layout</code> <em class="lz">、</em>变量——都不适合他们的屏幕尺寸，因为它是为更大的屏幕设计的。</p><h2 id="e49c" class="ok mi it bd mj ol om dn mn on oo dp mr ld op oq mt lh or os mv ll ot ou mx ov bi translated">run.py中的第1–30行</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/f3c05aa0f3e0615e828c2e7e387d1ab4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FzNcQjyy6-W99W7XA3XtGw.png"/></div></div><p class="md me gj gh gi mf mg bd b be z dk translated">编译和路由应用程序组件</p></figure><p id="9791" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们在第17行使用Flask的<em class="lz"> Request </em>对象来检查我们的应用程序刚刚从我们的用户那里收到的HTTP头，并确认我们看到的是一个移动设备。在这种情况下，第20行的<code class="fe og oh oi oj b">is_mobile</code>被设置为<em class="lz"> True </em>，这将我们的默认应用布局改为<code class="fe og oh oi oj b">build_mobile_layout</code>，而不是桌面版本。不错！</p><p id="560e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但是我们还没有走出困境…我们仍然需要真正地<em class="lz">为我们的用户提供正确的导航、仪表盘主体和页脚！</em></p><h2 id="f30c" class="ok mi it bd mj ol om dn mn on oo dp mr ld op oq mt lh or os mv ll ot ou mx ov bi translated">run.py中的第38–76行</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/d11f6f51b1c53b3bbc547b54c3a7b041.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BlfVh1TknBRKp0NpF-voSw.png"/></div></div><p class="md me gj gh gi mf mg bd b be z dk translated">向移动和网络用户显示不同的仪表板</p></figure><p id="5499" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所以我们的最后一步是在第52行编写<code class="fe og oh oi oj b">display_page()</code>函数，它与一个破折号回调函数(第48行)一起检查用户访问的URL。</p><p id="521b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们必须检查用户是否访问了适当的URL路径名(“/”是我们的仪表板，或者“/about”或“/resources”)，然后我们将使用我们可信任的<code class="fe og oh oi oj b">is_mobile</code>变量(这是一个真或假的布尔值)返回正确的移动/桌面导入文件，这些文件存储为变量名。</p><h2 id="855b" class="ok mi it bd mj ol om dn mn on oo dp mr ld op oq mt lh or os mv ll ot ou mx ov bi translated">快速小结</h2><p id="4fce" class="pw-post-body-paragraph ku kv it kw b kx mz ju kz la na jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">为什么我们不花点时间回顾一下:到目前为止，我们已经构建了web应用程序的外层，<em class="lz">和</em>我们能够将用户路由到正确的页面内容。然而，如果我们现在导航到该网站，我们会看到…一个空白页！</p><p id="d5d1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们的下一个重点是定位、收集和导入我们的新冠肺炎患者数据。完成后，我们有东西要发布，<em class="lz">然后</em>我们可以设计风格，让我们的网站看起来还过得去。我们开始工作吧！</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="d206" class="mh mi it bd mj mk oa mm mn mo ob mq mr jz oc ka mt kc od kd mv kf oe kg mx my bi translated">为我们的可视化清理数据</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/6241bc5376446c0af089ee973f1dc5bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rU66TkYWpu7Z6TTCCRSwqA.jpeg"/></div></div><p class="md me gj gh gi mf mg bd b be z dk translated">“熊猫”库是真空……肮脏、肮脏的XML是闪光的东西||图片来自<a class="ae ma" href="https://unsplash.com/@thecreative_exchange?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">创意交流</a> | <a class="ae ma" href="https://unsplash.com/s/photos/mopping?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="07b0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于任何不是数据科学家的读者来说，数据搜集是很重要的，因为我们的应用程序使用的所有原始数据输入(如确认的COVID案例、tweets、发布的文章标题)都会带有错误的数据格式(空值、错误的列名等)。</p><p id="cf34" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了处理数据搜集，我们使用了Jupyter笔记本和Pandas图书馆，还有Plotly。表达和情节。Graph_Objects用于可视化我们的图形。我们来看一个例子！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/5410ccabca18164c0dedfb266db4fa31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S7GnXyCnJHz0epXRomJcsw.png"/></div></div><p class="md me gj gh gi mf mg bd b be z dk translated">熊猫列出新闻文章的数据框架</p></figure><p id="25b2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当用户在我们的应用程序中点击北达科他州时，我们希望向他们显示该州最近与“冠状病毒”相关的所有新闻。为了做到这一点，上面的文章标题、URL、时间戳、状态和来源的表格是用我们的应用程序需要的所有数据定制的。它来自一个简单的谷歌搜索，我们在一个Jupyter笔记本里做的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/3375c97ddcc7403fc32e6db2f323a0c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JatZjxG7pGQeZGjbISRiQg.png"/></div></div><p class="md me gj gh gi mf mg bd b be z dk translated">清理谷歌搜索结果的功能</p></figure><p id="72d8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们正在寻找的是一个功能，它被编写为对美国的州和主题进行谷歌搜索(比如，“北达科他州”/“冠状病毒”)。</p><p id="4169" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们清理搜索结果，然后返回最近新文章的格式化列表。该函数接受两个参数(“状态”和“主题”)，我们将这些参数添加到一个自定义的news.google中，在<code class="fe og oh oi oj b">url</code>变量的花括号内搜索……就在<code class="fe og oh oi oj b">google.com/rss/</code>之后，你会看到<code class="fe og oh oi oj b">search?q={}+{}</code>。</p><p id="b41f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们使用Beautiful Soup根据XML标签分隔每篇新闻文章，例如本例中的<item> <title>。</title></item></p><p id="b5e0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在将每篇新闻文章拆分到我们的<code class="fe og oh oi oj b">xml</code>变量中之后，我们将每一列拆分到单独的Python列表中(例如，<code class="fe og oh oi oj b">list_of_article_links</code>变量将用任何&lt;标题&gt; &lt;链接&gt;组合填充)。</p><p id="7f61" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们要做的最后一步是创建一个Pandas数据框架——它基本上只是一个列和数据行的电子表格——并用我们所有的文章列表填充它。当我们将数据转换成JSON格式时，我们最终会使用这个数据帧，以便前端可以读取和显示它。</p><p id="b978" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">出于这个高级演练的目的，我们将忽略我们的后端和API端点，因为服务器的数据清理过程与我们刚刚讨论的非常相似。总之，我们的Pandas dataframe存储在我们的MongoDB后端，再次清理并重新格式化为web友好的JSON对象，然后通过GET请求发送到我们的前端web应用程序。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="b855" class="mh mi it bd mj mk oa mm mn mo ob mq mr jz oc ka mt kc od kd mv kf oe kg mx my bi translated">将数据显示为图形或图表并设置样式</h1><p id="5a75" class="pw-post-body-paragraph ku kv it kw b kx mz ju kz la na jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">现在，我们的患者数据已经被收集、清理并可用于前端，我们可以将这一切联系在一起了！那么我们将如何向用户展示呢？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f2e47cadaebd42234ca6aaf795381991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YDETBU62ekWN5zGmJi_d8g.png"/></div></div></figure><p id="a1c5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">前面我们清理了新闻文章的数据，但是让我们转到地图数据的可视化工具。这样，我们可以显示美国每个县报告的新冠肺炎病例的确认数量。</p><p id="165c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先我们将编写一个名为<code class="fe og oh oi oj b">confirmed_scatter_mapbox()</code>的函数。我们将使用Dash核心组件库中的图形在应用程序中显示它。</p><p id="5915" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">scatter _ map box . py中的第180–189行</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/17d7f073657578ffaa24210062b01487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r5JSrwAf0gX2M3xcw7iCWw.png"/></div></div></figure><p id="f4b3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，第181 &amp; 182行将调用我们的后端服务器，在那里我们已经存储了美国每个县的所有收集到的患者数据。然后，我们将把响应存储在熊猫数据帧中。</p><p id="cd40" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用我们的<code class="fe og oh oi oj b">data</code>变量——熊猫数据框——我们可以读取每个县的有用信息！这个范围从我们国家所在的州(第186行的“州名”)到它的纬度经度值，我们还可以读取由于新冠肺炎导致的确诊病例数。作为参考，下面是我们的数据框架中相关列名的列表:</p><ul class=""><li id="a3fa" class="ne nf it kw b kx ky la lb ld ng lh nh ll ni lp nj nk nl nm bi translated">县名</li><li id="ebf4" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp nj nk nl nm bi translated">州名</li><li id="5802" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp nj nk nl nm bi translated">确认的</li><li id="2f84" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp nj nk nl nm bi translated">死亡</li><li id="776b" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp nj nk nl nm bi translated">致死率</li><li id="bdf9" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp nj nk nl nm bi translated">纬度</li><li id="cdcf" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp nj nk nl nm bi translated">经度</li><li id="8e41" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp nj nk nl nm bi translated">上次更新</li></ul><p id="9789" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，第189行的<code class="fe og oh oi oj b">color_scale</code>根据一个县爆发的严重程度(相对于数据集中的所有其他县)，为我们提供了一系列颜色显示，从粉红色到深红色。</p><p id="8f4c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但是地图是如何创建的呢？</p><p id="ba92" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">scatter _ map box . py中的第195–207行</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/3113935e1a301547e10d29901e5f9447.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pg2C9aXvjQNOBgcNA54gjA.png"/></div></div></figure><p id="d985" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在第195行，“px”代表Plotly Express，我们将其用于创建默认散点图的<code class="fe og oh oi oj b">scatter_mapbox()</code>函数。这个散点图将消耗我们的患者数据，以便显示所有这些黄色圆圈。</p><p id="592c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我们将熊猫数据帧传递到第196行的散点图中。之后，我们所有的代码只是为电子表格中的每一行(县)设置自定义参数。</p><p id="6910" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">美国有3，007个县—每个县都有一个纬度和经度值，我们在第197和198行引用这些列名，以便在散点图上为我们的县圈选择一个位置。第202行和第203行使得当用户将鼠标悬停在一个县上时，他们将看到州和县的名称以及确诊病例和死亡人数，如下所示:</p><h2 id="0e22" class="ok mi it bd mj ol om dn mn on oo dp mr ld op oq mt lh or os mv ll ot ou mx ov bi translated">伊利诺伊州库克</h2><h2 id="8fb3" class="ok mi it bd mj ol om dn mn on oo dp mr ld op oq mt lh or os mv ll ot ou mx ov bi translated">确诊人数:4496人||死亡人数:61人</h2><p id="ccf4" class="pw-post-body-paragraph ku kv it kw b kx mz ju kz la na jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">现在我们已经有了地图显示和渲染数据，我们已经完成了这个特性！你在我们网站上看到的每个图表、表格和数据集都是用同样的过程构建的。因此，如果您想创建自己的仪表板，世界上有大量的数据，您的显示选项是无穷无尽的。</p><p id="0eb7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">祝你好运！</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="e319" class="mh mi it bd mj mk oa mm mn mo ob mq mr jz oc ka mt kc od kd mv kf oe kg mx my bi translated">下一步是什么？</h1><p id="dacd" class="pw-post-body-paragraph ku kv it kw b kx mz ju kz la na jx lc ld nb lf lg lh nc lj lk ll nd ln lo lp im bi translated">在<a class="ae ma" href="http://ncov19.us /" rel="noopener ugc nofollow" target="_blank">我们的仪表盘</a>中还有很多我们没有介绍的功能，但我们在这里的目标是让您对以下内容有一个高层次的了解:</p><ul class=""><li id="3652" class="ne nf it kw b kx ky la lb ld ng lh nh ll ni lp nj nk nl nm bi translated">抓取新冠肺炎数据</li><li id="e6c1" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp nj nk nl nm bi translated">以一种人性化的方式展示它。</li></ul><p id="3750" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">作为一个团队，我们已经从仪表板的工作中学到了很多。我们不仅希望发布一些数据见解，还希望推出以下功能:</p><ul class=""><li id="add8" class="ne nf it kw b kx ky la lb ld ng lh nh ll ni lp nj nk nl nm bi translated"><strong class="kw iu">疫苗追踪:</strong>列出临床试验的最新进展和新冠肺炎疫苗接种工作的最新里程碑。</li><li id="d510" class="ne nf it kw b kx nn la no ld np lh nq ll nr lp nj nk nl nm bi translated"><strong class="kw iu">短信集成:</strong>向您的手机发送消息，包括您所在县、州的每日更新，以及新的统计数据或新闻更新。</li></ul><p id="0edb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在全国各地，我们都感受到了这个疫情的不确定性和迷惑性。这正是为什么我们的团队致力于分析数据，从混乱中找出意义，并与您分享我们的发现。</p><p id="24c0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">访问我们的完整仪表板</strong> <a class="ae ma" href="https://ncov19.us/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">这里</strong> </a>，你可以<strong class="kw iu">关注我的个人旅程</strong> <a class="ae ma" href="https://twitter.com/mikechrupcala" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">这里</strong> </a>当我为一些自由职业项目写代码时。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/439d05c920b00b000cee710a2200ad99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qd_9qWc74PyT8TyeKMsGvw.png"/></div></div><p class="md me gj gh gi mf mg bd b be z dk translated"><a class="ae ma" href="https://ncov19.us/" rel="noopener ugc nofollow" target="_blank">https://ncov19.us/</a></p></figure></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="3c1a" class="mh mi it bd mj mk oa mm mn mo ob mq mr jz oc ka mt kc od kd mv kf oe kg mx my bi translated">资源</h1><div class="po pp gp gr pq pr"><a href="https://dash.plotly.com/" rel="noopener  ugc nofollow" target="_blank"><div class="ps ab fo"><div class="pt ab pu cl cj pv"><h2 class="bd iu gy z fp pw fr fs px fu fw is bi translated">Dash文档和用户指南| Plotly</h2><div class="py l"><h3 class="bd b gy z fp pw fr fs px fu fw dk translated">Plotly Dash用户指南和文档</h3></div><div class="pz l"><p class="bd b dl z fp pw fr fs px fu fw dk translated">dash.plotly.com</p></div></div></div></a></div><div class="po pp gp gr pq pr"><a href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener  ugc nofollow" target="_blank"><div class="ps ab fo"><div class="pt ab pu cl cj pv"><h2 class="bd iu gy z fp pw fr fs px fu fw is bi translated">欢迎使用Flask - Flask文档(1.1.x)</h2><div class="py l"><h3 class="bd b gy z fp pw fr fs px fu fw dk translated">欢迎阅读Flask的文档。开始安装，然后了解快速入门概述。有…</h3></div><div class="pz l"><p class="bd b dl z fp pw fr fs px fu fw dk translated">flask.palletsprojects.com</p></div></div><div class="qa l"><div class="qb l qc qd qe qa qf ks pr"/></div></div></a></div><div class="po pp gp gr pq pr"><a href="https://dash-bootstrap-components.opensource.faculty.ai/" rel="noopener  ugc nofollow" target="_blank"><div class="ps ab fo"><div class="pt ab pu cl cj pv"><h2 class="bd iu gy z fp pw fr fs px fu fw is bi translated">仪表板引导组件</h2><div class="py l"><h3 class="bd b gy z fp pw fr fs px fu fw dk translated">dash-bootstrap-components是Plotly Dash的一个引导组件库，它使构建更容易…</h3></div><div class="pz l"><p class="bd b dl z fp pw fr fs px fu fw dk translated">dash-bootstrap-components . open source . faculty . ai</p></div></div></div></a></div><div class="po pp gp gr pq pr"><a href="https://dash.plotly.com/dash-html-components" rel="noopener  ugc nofollow" target="_blank"><div class="ps ab fo"><div class="pt ab pu cl cj pv"><h2 class="bd iu gy z fp pw fr fs px fu fw is bi translated">Dash HTML组件| Dash for Python文档| Plotly</h2><div class="py l"><h3 class="bd b gy z fp pw fr fs px fu fw dk translated">Dash提供了所有可用的HTML标签作为用户友好的Python类。本章解释了这是如何工作的…</h3></div><div class="pz l"><p class="bd b dl z fp pw fr fs px fu fw dk translated">dash.plotly.com</p></div></div></div></a></div><div class="po pp gp gr pq pr"><a href="https://plotly.com/python/plotly-express/" rel="noopener  ugc nofollow" target="_blank"><div class="ps ab fo"><div class="pt ab pu cl cj pv"><h2 class="bd iu gy z fp pw fr fs px fu fw is bi translated">Plotly Express</h2><div class="py l"><h3 class="bd b gy z fp pw fr fs px fu fw dk translated">每行代表一朵花。https://en.wikipedia.org/wiki/Iris_flower_data_set回复:一个150元的“熊猫. DataFrame”</h3></div><div class="pz l"><p class="bd b dl z fp pw fr fs px fu fw dk translated">plotly.com</p></div></div><div class="qa l"><div class="qg l qc qd qe qa qf ks pr"/></div></div></a></div></div></div>    
</body>
</html>