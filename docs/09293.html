<html>
<head>
<title>Generating Synthetic Seismogram in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 生成合成地震图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/generating-synthetic-seismogram-in-python-519f23f07894?source=collection_archive---------13-----------------------#2020-07-03">https://towardsdatascience.com/generating-synthetic-seismogram-in-python-519f23f07894?source=collection_archive---------13-----------------------#2020-07-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="54e1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从测井曲线生成地震记录的七个步骤</h2></div><p id="4d63" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">地球物理学中最基本的概念之一是卷积。我们在地球物理操作中记录的地震数据是来自地球内部表面的反射能量，这些表面与相邻层具有不同的岩石物理特性。实际上，地震信号是地层反射率与能量源子波褶积的结果。</p><p id="3f04" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从测井曲线生成合成地震记录是一个建模过程。我们将使用零相位小波(如<a class="ae le" href="https://subsurfwiki.org/wiki/Ricker_wavelet" rel="noopener ugc nofollow" target="_blank"> Ricker </a>小波)对反射率序列(从测井数据中获得)进行卷积。我们需要地震图来将油井数据与地震数据联系起来，以完成解释任务。</p><p id="107a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我将尝试在合成地震图的制作过程中加入一些编程的乐趣。我非常喜欢 python，因为它有各种各样的库，可以使任务比其他编程平台容易得多。<br/>我已经上传了一个完整的 jupyter 笔记本文件和原始数据到我的<a class="ae le" href="https://github.com/mardani72/Synthetic_Seismogram" rel="noopener ugc nofollow" target="_blank"> GitHub </a>账号里，如果你想自己尝试的话。我们将用 las 格式处理日志数据。如果你不熟悉如何将 las 文件读入 python 的过程，请查看我之前的文章。</p><p id="2ffa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">生成地震记录所需步骤:<br/> 1-数据准备(单位转换和声波/密度测井处理)<br/> 2-时深关系构建<br/> 3-声阻抗(AI 或 Z)计算<br/> 4-反射系数(Rc)计算<br/> 5-重采样到时域和 Rc 重新计算<br/> 6-子波&amp;卷积<br/> 7-可视化</p><h1 id="bd41" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">1-数据准备</h1><h2 id="7a20" class="lx lg it bd lh ly lz dn ll ma mb dp lp kr mc md lr kv me mf lt kz mg mh lv mi bi translated">调节装置</h2><p id="339a" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">将测井文件(las 格式)读入 python 并查看日志标题后，我们需要将密度和声波测井的单位转换为 SI 系统，因为我们需要这两种测井来计算阻抗。为了计算声阻抗，我们需要 s/m 单位的声波测井(DT)和 kg/m3 单位的密度测井(RHOB)。看标题:DT 有美制/英尺单位和 RHOB g/cm3。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="11a9" class="lx lg it mt b gy mx my l mz na">w.data['DT'] = w.data['DT'] / 0.3048          #unit convert to µs/m<br/>w.data['RHOB'] = w.data['RHOB'] * 1000        #unit convert to kg/m3</span></pre><h2 id="bc03" class="lx lg it bd lh ly lz dn ll ma mb dp lp kr mc md lr kv me mf lt kz mg mh lv mi bi translated">去毛刺和平滑</h2><p id="2164" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">尖峰信号在测井记录中很常见，尤其是在声波测量中。这些尖峰并不能真正代表整个井段的岩石特性变化，需要消除。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="8aac" class="lx lg it mt b gy mx my l mz na">#Sonic Despiking<br/>dt = w.data['DT']<br/>w.data['DT_DS'] = dt.despike(window_length=50, z=2)</span><span id="dfd7" class="lx lg it mt b gy nb my l mz na">#Density Despiking<br/>den = w.data['RHOB']<br/>w.data['RHOB_DS'] = den.despike(window_length=50, z=2)</span></pre><p id="e222" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将输入要平滑的去尖峰数据:</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="3b0c" class="lx lg it mt b gy mx my l mz na">#Sonic Smoothing<br/>dt_ds = w.data['DT_DS']<br/>w.data['DT_DS_SM'] = dt_ds.smooth(window_length=10, samples=False)</span><span id="148e" class="lx lg it mt b gy nb my l mz na">#Density Smoothing<br/>den_ds = w.data['RHOB_DS']<br/>w.data['RHOB_DS_SM'] = den_ds.smooth(window_length=10, samples=False)</span></pre><h1 id="078c" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">2-时间-深度关系</h1><p id="9ac3" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">地震数据是在时间域测量的，而井数据主要在深度域测量。要将时间转化为深度，反之亦然，我们需要建立一种关系。有几种方法可以做到这一点，但在这里，我们使用声波测井，这是声波速度的倒数。从数学上讲，如果我们在深度区间上对 DT 积分，我们将计算出时间与深度的关系。在此之前，我们应该对上部测井数据进行补救，它与地面有数据缺口。由于这是岸上现场数据，我们没有水柱。测井曲线以上部分的替换速度几乎为 2600 米/秒。简单地说，用替换速度除以间隙层厚度(测井曲线开始深度减去 kb)就可以得到时间。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="3297" class="lx lg it mt b gy mx my l mz na">log_start = 1517          # Depth of logging starts(m) from header<br/>kb = 15                   # Kelly Bushing elevation(m) from headergap_int = log_start - kb<br/>repl_vel = 2632           # this is from VSP data knowledge (m/s)<br/>log_start_time = 2.0 * gap_int / repl_vel        # 2 for twt</span></pre><h2 id="5dbe" class="lx lg it bd lh ly lz dn ll ma mb dp lp kr mc md lr kv me mf lt kz mg mh lv mi bi translated">T-D 机构</h2><p id="1d08" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">让我们实施一体化。由于深度采样间隔为 0.1524 米，我们需要用测得的声波数据计算该厚度传播所需的时间。然后计算向下的累计行程时间。从测井起始深度计算显示第一个值为零，而我们知道零时间属于地表。所以，这个间隙的传播时间应该加到综合声波时间中。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="3eb0" class="lx lg it mt b gy mx my l mz na">#first replace NaN values with zero<br/>dt_iterval = np.nan_to_num(dt) * 0.1524 / 1e6<br/>t_cum =  np.cumsum(dt_iterval) * 2<br/>w.data['TWT'] = t_cum + log_start_time</span></pre><h1 id="b9d4" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">3-声阻抗</h1><p id="24a1" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">声阻抗(AI，有时用 Z 表示)定义为声波速度和介质密度的乘积。在反射地震学中，地质层之间的 AI 变化负责向我们收集地震数据的表面的能量反射。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="4be9" class="lx lg it mt b gy mx my l mz na">df['Vsonic'] = 1e6/df.DT_DS_SM                   #(unit: m/s)<br/>df['AI'] = df['Vsonic'] * df['RHOB_DS_SM']        #(unit: kg/m2.s)</span></pre><h1 id="c8e7" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">4-反射系数</h1><p id="febe" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">反射系数(Rc)定义为两个相邻层的阻抗差除以它们的总和。数学上，这是深度的导数。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="52b5" class="lx lg it mt b gy mx my l mz na">Imp = df['AI'].values<br/>Rc=[]<br/>for i in range(len(Imp)-1):<br/>    Rc.append((Imp[i+1]-Imp[i])/(Imp[i]+Imp[i+1]))</span></pre><h1 id="d348" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">5-重采样到时域和 Rc 计算</h1><p id="47db" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">虽然我们建立了时深关系(TDR ),但合成地震记录所需的分量在深度域。反射率系列应该转换到时域进行卷积。定义时间向量后，我们可以使用 numpy 库中的插值函数。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="5224" class="lx lg it mt b gy mx my l mz na">dt = 0.001   #sampleing interval<br/>t_max = 3.0   # max time to create time vector<br/>t = np.arange(0, t_max, dt)<br/>AI_tdom = np.interp(x=t, xp = df.TWT, fp = df.AI)    #resampling</span><span id="4edc" class="lx lg it mt b gy nb my l mz na"># again Rc calulation but in reampled time domain<br/>Rc_tdom = []<br/>for i in range(len(AI_tdom)-1):<br/>    Rc_tdom.append((AI_tdom[i+1]-AI_tdom[i])/(AI_tdom[i]+AI_tdom[i+1]))</span></pre><h1 id="32b6" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">6-小波和卷积</h1><p id="b09d" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">在反射地震学中，假设我们在地表记录的地震数据是用子波卷积(掩蔽)的能量反射。在各种子波中，里克子波是最常见的一种，因为它是零相位的，有利于地震解释任务。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="daf1" class="lx lg it mt b gy mx my l mz na"># define function of ricker wavelet<br/>def ricker(f, length, dt):<br/>    t0 = np.arange(-length/2, (length-dt)/2, dt)<br/>    y = (1.0 - 2.0*(np.pi**2)*(f**2)*(t0**2)) * np.exp(-(np.pi**2)*(f**2)*(t0**2))<br/>    return t0, y</span></pre><h2 id="613e" class="lx lg it bd lh ly lz dn ll ma mb dp lp kr mc md lr kv me mf lt kz mg mh lv mi bi translated">盘旋</h2><p id="2ee0" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">在这一步中，我们将利用子波对反射率序列进行卷积，以创建一个合成地震图。这通常被称为翻转和滑动一个功能到另一个功能上。如果你有兴趣知道这个操作背后的数学原理，你可以看看这个伟大的<a class="ae le" href="https://www.youtube.com/watch?v=eqAFP15AMPc" rel="noopener ugc nofollow" target="_blank">视频</a>。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="598a" class="lx lg it mt b gy mx my l mz na">f=20            #wavelet frequency<br/>length=0.512    #Wavelet vector length<br/>dt=dt           # Sampling prefer to use smiliar to resampled AI<br/>t0, w = ricker (f, length, dt) # ricker wavelet <br/>synthetic = np.convolve(w, Rc_tdom, mode='same')</span></pre><h1 id="d300" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">7-可视化</h1><h2 id="8d5e" class="lx lg it bd lh ly lz dn ll ma mb dp lp kr mc md lr kv me mf lt kz mg mh lv mi bi translated">图 1</h2><p id="d441" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">在该图中，我们将绘制测井曲线(覆盖平滑和去尖峰结果),并计算深度域中的 AI 和反射率。关于 python 中的绘图程序，请参考笔记本文件<a class="ae le" href="https://github.com/mardani72/Synthetic_Seismogram" rel="noopener ugc nofollow" target="_blank">这里的</a>。</p><figure class="mo mp mq mr gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nc"><img src="../Images/689c19daf8067db61b2bc77dc5fe36b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKhttizETWccMjXuWnDJRg.png"/></div></div></figure><h2 id="2579" class="lx lg it bd lh ly lz dn ll ma mb dp lp kr mc md lr kv me mf lt kz mg mh lv mi bi translated">图 2</h2><p id="1e32" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">在该图中，我们将在时域中绘制 AI 和卷积结果。我们还可以获得油井周围真实地面地震记录，这些记录可以与合成地震记录并置，以查看与数据的匹配程度。</p><figure class="mo mp mq mr gt nd gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nk"><img src="../Images/8b47cbabb9be57ae785fc0802e5e99e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8YCICsEvgX87fkiwXhCOtg.jpeg"/></div></div></figure><p id="d52f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看最后一条轨迹表明，合成地震记录和地面地震数据之间存在适当的匹配，尤其是在关键层位。关于为什么匹配可以是相同的，有很多争论。一个重要的原因是地面地震和声波测井的频带。如果你有兴趣学习更多，请参考我的教授<a class="ae le" href="https://www.amazon.ca/Fundamentals-Geophysical-Interpretation-Laurence-Lines/dp/1560801255" rel="noopener ugc nofollow" target="_blank">的书</a>、<a class="ae le" href="https://www.amazon.ca/s/ref=dp_byline_sr_book_1?ie=UTF8&amp;field-author=Laurence+R.+Lines&amp;text=Laurence+R.+Lines&amp;sort=relevancerank&amp;search-alias=books-ca" rel="noopener ugc nofollow" target="_blank">劳伦斯·r·莱恩斯</a>。</p><h1 id="2667" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">结论</h1><p id="faaa" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">在反射地震学中，合成地震记录是以褶积理论为基础的。地震图是地震解释的一个非常重要的工具，它是井和地面地震数据之间的桥梁。在这篇文章中，我试图展示我们如何用 python 中的真实数据用几行代码实现这个任务。请随意下载源代码，四处看看，并为自己的数据实现。对于评论和问题，请在这里留言。</p></div></div>    
</body>
</html>