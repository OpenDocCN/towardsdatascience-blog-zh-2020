<html>
<head>
<title>Classifying fashion apparel- Getting started with Convolutional Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时尚服装分类-卷积神经网络入门</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/classifying-fashion-apparel-getting-started-with-convolutional-neural-networks-3ae4fc5d9f76?source=collection_archive---------52-----------------------#2020-06-03">https://towardsdatascience.com/classifying-fashion-apparel-getting-started-with-convolutional-neural-networks-3ae4fc5d9f76?source=collection_archive---------52-----------------------#2020-06-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="67db" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过创建卷积神经网络(CNN)对时尚服装图像进行分类，开始学习计算机视觉。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2e9814d8efa9b659b77033b1dd06911e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ktFwPKVjynu1PskxRt4xKA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://www.pexels.com/@lum3n-44775" rel="noopener ugc nofollow" target="_blank"> Lum3n </a>通过<a class="ae ky" href="https://pexels.com" rel="noopener ugc nofollow" target="_blank">像素</a></p></figure><p id="8b3d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本指南中，我们将改进我们在上一节中训练的服装图像分类模型。</p><p id="2d60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你是机器学习或使用<a class="ae ky" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a> / <a class="ae ky" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>的新手，我会建议你看看<a class="ae ky" rel="noopener" target="_blank" href="/classifying-fashion-apparel-getting-started-with-computer-vision-271aaf1baf0">第一部分</a>，在那里我们以一种更容易和初学者友好的方式解决了同样的问题。</p><p id="086e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那好吧。让我简单介绍一下我们将要做的事情:</p><p id="68ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将关注一种新的深度学习神经网络，称为<a class="ae ky" rel="noopener" target="_blank" href="/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53">卷积神经网络</a>。它们最常用于计算机视觉应用，非常适合手头的任务。</p><p id="ca54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简而言之，CNN 使网络能够将输入图像视为边缘、角落和颜色的组合，本质上捕捉了图像的内容。</p><p id="a00a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要从更技术性的角度来看 CNN，我建议你浏览一下这篇文章。</p><p id="381d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本指南中，我们不会过多地研究 CNN 是如何工作的，而是将重点放在如何使用<a class="ae ky" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>和<a class="ae ky" href="http://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>在代码中实现它。</p><p id="8feb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里是完成的<a class="ae ky" href="https://colab.research.google.com/drive/19uzZBsMBrfqGQ2H1GefbqDyf1nVM4pUH?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Colab 笔记本</a>和<a class="ae ky" href="https://github.com/navendu-pottekkat/fashion-MNIST-tutorial" rel="noopener ugc nofollow" target="_blank"> GitHub 回购。</a></p><h1 id="0de1" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">数据</h1><p id="4c75" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">像之前的指南一样，我们将使用<a class="ae ky" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank">时尚-MNIST </a>数据集。它是由 10 种服装的 60，000 个正方形(28x28 像素)灰度图像组成的数据集。</p><p id="6c2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每件衣服都有一个特定的标签:</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="f712" class="mx lw it mt b gy my mz l na nb">0- T-shirt/top</span><span id="a94e" class="mx lw it mt b gy nc mz l na nb">1- Trouser</span><span id="90d4" class="mx lw it mt b gy nc mz l na nb">2- Pullover</span><span id="356f" class="mx lw it mt b gy nc mz l na nb">3- Dress</span><span id="2940" class="mx lw it mt b gy nc mz l na nb">4- Coat</span><span id="cdf8" class="mx lw it mt b gy nc mz l na nb">5- Sandal</span><span id="999f" class="mx lw it mt b gy nc mz l na nb">6- Shirt</span><span id="9afc" class="mx lw it mt b gy nc mz l na nb">7- Sneaker</span><span id="dc34" class="mx lw it mt b gy nc mz l na nb">8- Bag</span><span id="5bc0" class="mx lw it mt b gy nc mz l na nb">9- Ankle boot</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/6d69f990be0234a75d9805f76ef8672e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GNLB2jtcfb_xTqgQd9ntJA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时尚 MNIST 数据集|来源:<a class="ae ky" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank"> ZALANDO RESEARCH </a></p></figure><h1 id="a686" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">代码</h1><p id="1a14" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将使用<a class="ae ky" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>和 TensorFlow <a class="ae ky" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>来构建我们的模型。</p><p id="f729" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将通过使用 CNN 作为我们的神经网络来扩展我们的知识。</p><p id="b052" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将像在之前的教程中一样预处理图像。如果您不确定，请查看此链接<a class="ae ky" rel="noopener" target="_blank" href="/classifying-fashion-apparel-getting-started-with-computer-vision-271aaf1baf0">。</a></p><p id="2ff1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完整的代码可以在<a class="ae ky" href="https://colab.research.google.com/drive/19uzZBsMBrfqGQ2H1GefbqDyf1nVM4pUH?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Colab 笔记本</a>和<a class="ae ky" href="https://github.com/navendu-pottekkat/fashion-MNIST-tutorial" rel="noopener ugc nofollow" target="_blank"> GitHub repo 中找到。</a></p><p id="af31" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这一部分中，我们将直接开始创建模型。本质上，我们正在将我们新的和改进的 CNN 模型插入到我们以前的代码中。</p><h2 id="817d" class="mx lw it bd lx ne nf dn mb ng nh dp mf li ni nj mh lm nk nl mj lq nm nn ml no bi translated">创建模型</h2><p id="b84b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们的模型将一个 28px x 28px 的灰度图像作为输入，输出一个长度为 10 的浮点数组，表示图像是服装的概率。(数据集中有 10 种不同的服装，标记为 0-9)</p><p id="451c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看我们的模型，然后我们将通过每一层。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="9bcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们添加一个与我们的输入形状匹配的<a class="ae ky" href="https://keras.io/guides/functional_api/" rel="noopener ugc nofollow" target="_blank">输入层</a>。</p><p id="6b2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们<a class="ae ky" href="https://keras.io/api/layers/reshaping_layers/reshape/" rel="noopener ugc nofollow" target="_blank">改变</a>输入的形状，增加一个维度来表示我们图像的颜色通道。因为我们示例中的图像是灰度图像，所以颜色通道的数量是 1。</p><p id="cff1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们有我们的第一个卷积<a class="ae ky" href="https://keras.io/api/layers/convolution_layers/convolution2d/" rel="noopener ugc nofollow" target="_blank"> Conv2D </a>层。我们有 32 个内核大小为 3×3 的过滤器。</p><p id="fe1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是一张 gif 图，展示了卷积是如何工作的。你可以查看这篇文章了解更多细节。(<strong class="lb iu"> <em class="nr">嘘……如果你还没有</em> </strong>，我建议你去看看)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/06dfed88783eb0ac82a82ee917a1e390.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/1*wvwT9LlHcDfexIiv7fWWxA.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">卷积在行动！|来源:<a class="ae ky" href="https://github.com/vdumoulin" rel="noopener ugc nofollow" target="_blank"> vdumoulin </a></p></figure><p id="a9b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们有另一个<a class="ae ky" href="https://keras.io/api/layers/convolution_layers/convolution2d/" rel="noopener ugc nofollow" target="_blank"> Conv2D </a>层，有 64 个滤镜和 3x3 内核。你可能已经从代码中猜到了。</p><p id="1b94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来我们有新的东西，一个<a class="ae ky" href="https://keras.io/api/layers/pooling_layers/max_pooling2d/" rel="noopener ugc nofollow" target="_blank">池</a>层。</p><p id="0d04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你问什么是池层？为什么说我什么时候可以给你看？我认为这张 gif 是不言自明的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi gj"><img src="../Images/5b68cec644588cf86ab8bae268796260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*WvHC5bKyrHa7Wm3ca-pXtg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">MaxPooling Layer |来源:<a class="ae ky" href="https://developers.google.com/machine-learning/practica/image-classification/convolutional-neural-networks" rel="noopener ugc nofollow" target="_blank">谷歌</a></p></figure><p id="8e40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果这还不能说明问题，是的，你猜对了，看看我经常提到的那篇文章吧！</p><p id="81d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来是辍学层。它所做的是在训练过程中随机忽略或“丢弃”网络中的一些层。这可以防止网络中的单元过度适应训练数据。</p><p id="7536" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们展平前一层的输出，并将其传递给一个密集连接的网络，这将是我们的输出层。</p><p id="bf83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最终层中的 10 个节点中的每一个都将包含指示当前图像属于 10 个类别之一的概率分数。(请记住，我们的数据中有 10 种服装分类)</p><p id="e08b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们像在<a class="ae ky" rel="noopener" target="_blank" href="/classifying-fashion-apparel-getting-started-with-computer-vision-271aaf1baf0">之前的指南</a>中一样编译和训练模型。</p><p id="7502" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">完整的代码可以在<a class="ae ky" href="https://colab.research.google.com/drive/19uzZBsMBrfqGQ2H1GefbqDyf1nVM4pUH?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Colab 笔记本</a>和<a class="ae ky" href="https://github.com/navendu-pottekkat/fashion-MNIST-tutorial" rel="noopener ugc nofollow" target="_blank"> GitHub repo 中找到。</a></p><h2 id="cfbb" class="mx lw it bd lx ne nf dn mb ng nh dp mf li ni nj mh lm nk nl mj lq nm nn ml no bi translated">评估模型</h2><p id="56ce" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们的模型对测试数据有大约 92%的准确率。这比我们以前的型号大约增加了 5%。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np nq l"/></div></figure><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="6542" class="mx lw it mt b gy my mz l na nb">313/313 [==============================] — 1s 2ms/step — loss: 0.3239 — accuracy: 0.9203 </span><span id="b3ce" class="mx lw it mt b gy nc mz l na nb">Test accuracy: 0.9203000068664551</span></pre><p id="585d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">模型似乎仍然<a class="ae ky" href="https://machinelearningmastery.com/overfitting-and-underfitting-with-machine-learning-algorithms/" rel="noopener ugc nofollow" target="_blank">过度拟合</a>训练数据。但是我们会把它留到下一次。我们现在不想让事情变得太复杂。</p><p id="7feb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是有了这个指南，我希望你能够得到在 TensorFlow 和 Keras 中使用 CNN 的 101 指南。在接下来的指南中，我们将看看如何通过使用一种叫做<a class="ae ky" rel="noopener" target="_blank" href="/a-comprehensive-hands-on-guide-to-transfer-learning-with-real-world-applications-in-deep-learning-212bf3b2f27a">迁移学习</a>的技术来进一步改进我们的模型。</p><p id="61ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还将学习图像增强技术，以便我们不会用训练数据过度拟合我们的模型。在那之前，</p><p id="41e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">快乐编码！</strong></p></div></div>    
</body>
</html>