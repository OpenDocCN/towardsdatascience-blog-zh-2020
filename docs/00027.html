<html>
<head>
<title>TriGraph: How to use graphs to analyse triathlon events</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TriGraph:如何使用图表分析铁人三项项目</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/trigraph-how-to-use-graphs-to-analyse-triathlon-events-145c5daefcc5?source=collection_archive---------26-----------------------#2020-01-01">https://towardsdatascience.com/trigraph-how-to-use-graphs-to-analyse-triathlon-events-145c5daefcc5?source=collection_archive---------26-----------------------#2020-01-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f0970e8831dba9e0f566fc93d0ed4922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IexCftzTGOS6ovwiOD5CiQ.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">ID 21137693 Patrimonio设计有限公司| Dreamstime.com</p></figure><p id="aaf9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">图形<a class="ae ld" href="https://graphql.org/learn/thinking-in-graphs/" rel="noopener ugc nofollow" target="_blank">直观</a>。图为<a class="ae ld" href="https://dzone.com/articles/the-power-of-graphs-and-how-to-use-them" rel="noopener ugc nofollow" target="_blank">强大的</a>。而且图形可以在<a class="ae ld" href="https://neo4j.com/use-cases/" rel="noopener ugc nofollow" target="_blank">广泛的应用</a>中使用。本文的目标是展示在我们的例子中，尤其是在铁人三项比赛中，图表如何简化定义良好的数据模型之上的数据分析。为了实现这一点，我们使用<a class="ae ld" href="https://neo4j.com" rel="noopener ugc nofollow" target="_blank"> Neo4j </a>作为图形数据库，并使用<a class="ae ld" href="https://track.rtrt.me/e/IRM-WORLDCHAMPIONSHIP-2019" rel="noopener ugc nofollow" target="_blank"> Ironman Vega世界锦标赛2019 </a>的结果进行分析。我们想要回答的问题是:</p><ul class=""><li id="cffe" class="le lf it kh b ki kj km kn kq lg ku lh ky li lc lj lk ll lm bi translated">所有首发球员的国家分布如何？</li><li id="c2d0" class="le lf it kh b ki ln km lo kq lp ku lq ky lr lc lj lk ll lm bi translated">在10小时内完成比赛的所有运动员的年龄组分布如何？</li></ul><p id="8738" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">正如我们将看到的，定义数据模型对于后面的分析至关重要。让我们直接开始吧。</p><h1 id="6a30" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">数据模型</h1><p id="21d6" class="pw-post-body-paragraph kf kg it kh b ki mq kk kl km mr ko kp kq ms ks kt ku mt kw kx ky mu la lb lc im bi translated">数据模型是后面分析的关键。它提供了一个抽象，将数据源定义的初始原始数据映射成信息(<a class="ae ld" href="https://www.ontotext.com/knowledgehub/fundamentals/dikw-pyramid/" rel="noopener ugc nofollow" target="_blank">进一步阅读</a>)。在这些信息的基础上，您可以定义您的查询并进行分析。在我们的例子中，一切都从运动员<em class="mv">开始，他的名字和姓氏被识别出来。一名<em class="mv">运动员</em>属于一个由名字定义的<em class="mv">队</em>。此外，运动员<em class="mv">来自</em>一个<em class="mv">国家</em>，目前由国家简称定义。最重要的是，运动员<em class="mv">在某个<em class="mv">比赛</em>和某个</em>比赛<em class="mv">中取得了</em>和<em class="mv">的成绩。一场比赛中所有的<em class="mv">分割</em>都是最终结果的一部分。产生的模式如下所示:</em></em></p><figure class="mx my mz na gt ju gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/f0f1fc607692601c1ae9cce25cbb8234.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*shEOkSXboOjAaACI8lm-Tg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">Neo4j生成的图形数据库的结果模式</p></figure><p id="62c5" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这个例子表明，建立一个图表是多么直观和容易理解。正如我们所看到的，产生的模式非常接近我们如何定义和看待现实世界。</p><p id="acd6" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">一旦定义了数据模型，就该用结果填充数据库了。当我们使用Neo4j时，填充图形数据库是通过名为<a class="ae ld" href="https://neo4j.com/docs/cypher-manual/current/introduction/#cypher-introduction" rel="noopener ugc nofollow" target="_blank">‘cypher’</a>的图形查询语言完成的。让我们来看一个例子，让你感受一下这是怎么做到的:</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="14bb" class="ng lt it nc b gy nh ni l nj nk">create (:Athlete {firstName: “testFN”, name: “testLN” })</span></pre><p id="1578" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在，我们创建一个国家，然后让我们添加一名运动员来起源于它:</p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="975f" class="ng lt it nc b gy nh ni l nj nk">create (:Country{shortCode:”USA”});<br/>match (a:Athlete),(c:Country)<br/>create (a)-[:originatesFrom]-&gt;( c )<br/>return a,c;</span></pre><figure class="mx my mz na gt ju gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/a0a8f58f05c717888633eb4459b0fe18.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*RNJ2CN6RNK-aDPSpoxC3Fw.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">结果图看起来像预期的那样</p></figure><p id="9f83" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">一旦有了模式并获得了查询语言的逻辑，就很容易将原始数据映射到数据模型并导入它。为此，我将python与<a class="ae ld" href="https://jupyter.org" rel="noopener ugc nofollow" target="_blank"> jupyter笔记本</a>和<a class="ae ld" href="https://py2neo.org/v4/" rel="noopener ugc nofollow" target="_blank"> py2neo </a>一起使用。</p><h1 id="3202" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated"><strong class="ak">回答问题</strong></h1><p id="909d" class="pw-post-body-paragraph kf kg it kh b ki mq kk kl km mr ko kp kq ms ks kt ku mt kw kx ky mu la lb lc im bi translated">有了数据模型和原始数据的导入，艰苦的工作已经完成，我们可以享受图形的可视化。所以，现在是时候回答我们上面提出的问题了，从第一个开始。这两个问题有一个共同点，即信息在图中被明确地陈述，这使得它容易得多。</p><p id="a00d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><em class="mv">所有首发球员的国家分布如何？由于在数据模型中运动员和国家之间有直接关系，我们唯一要做的就是匹配它并返回节点，如下图所示。</em></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="c624" class="ng lt it nc b gy nh ni l nj nk">match (a:Athlete)-[:originatesFrom]-&gt;(c:Country)<br/>return a,c</span></pre><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/7389f85cb6857f33f1bea16c2f4eaf7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9G6KSA5RlNsqp-BDA85Ing.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">国家分布</p></figure><p id="e0d7" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><em class="mv">在10小时内完成比赛的所有运动员的年龄组和国家分布情况如何？这个问题有点难回答，因为它有一个条件。分割时间将总时间保存为Neo4j 中的<a class="ae ld" href="https://neo4j.com/docs/cypher-manual/current/syntax/temporal/" rel="noopener ugc nofollow" target="_blank">持续时间。现在我们可以过滤时间，得到相应的结果以及与比赛(=年龄组)和运动员的关系。最后，所有三个都被返回，结果图如下所示。</a></em></p><pre class="mx my mz na gt nb nc nd ne aw nf bi"><span id="f68e" class="ng lt it nc b gy nh ni l nj nk">match (s:Split)<br/>where s.name = “FINISH” and s.total.minutes &lt; 600<br/>with s<br/>match (a:Athlete)-[:achieved]-&gt;(r:Result)<br/>where s.bib = r.bib<br/>with a,r<br/>match (r)-[:achievedIn]-&gt;(c:competition)<br/>return a,r,c</span></pre><figure class="mx my mz na gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/6bb7840f8a6aac23e9aec1c2789f9566.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VhLaWBx6zp6wZ0f7OKp8Rg.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">完成10小时以下比赛的所有运动员的年龄组分布</p></figure><h1 id="c960" class="ls lt it bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">摘要</h1><p id="f3d6" class="pw-post-body-paragraph kf kg it kh b ki mq kk kl km mr ko kp kq ms ks kt ku mt kw kx ky mu la lb lc im bi translated">我想展示的是，一旦数据模型就位，使用简单易懂的查询就可以获得非常好的结果。非常重要的一点是，数据模型可以很容易地用新的特性和信息进行扩展。此外，可以导入新的源，使用完全相同的查询可以获得相同的结果。但这只是开始。查询非常简单，结果并不令人惊讶，也可以通过其他技术实现。但是这张图表是下一步的基础。这个想法是为了回答关于铁人三项比赛和训练策略的更复杂的问题。我接下来想研究的是团队比赛如何影响不同比赛的最终结果，并拥有一套可以自动进行和共享的标准分析。</p></div></div>    
</body>
</html>