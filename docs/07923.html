<html>
<head>
<title>Find the highest moving (hidden) stocks of the day with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 找到当天最高的移动(隐藏)股票</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/find-the-highest-moving-hidden-stocks-of-the-day-with-python-aab0d7bfe5ff?source=collection_archive---------17-----------------------#2020-06-12">https://towardsdatascience.com/find-the-highest-moving-hidden-stocks-of-the-day-with-python-aab0d7bfe5ff?source=collection_archive---------17-----------------------#2020-06-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/09e9c48acf6bd48c21b91302246e8c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*e4BZHwocxnBlMvCw"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片来自<a class="ae jg" href="https://unsplash.com/photos/DfjJMVhwH_8" rel="noopener ugc nofollow" target="_blank"> unsplash </a>。</p></figure><div class=""/><div class=""><h2 id="f924" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">有更多的股票不只是 SP500！在本文中，我们将探索揭示快速移动的小型创业板股票的 Python 代码…</h2></div><h2 id="ea15" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">股票市场是一个瞬息万变的地方，尤其是在这些动荡时期。虽然我们经常听说最受欢迎的股票(所谓的 SP500)，但还有许多其他股票。有些小，有些快速上涨，有些是新的 IPO，有些是快速崩溃…在这篇文章中，我将分享一些我编写的有用的 Python 代码，以深入研究最不为人知的股票，并找到那些快速移动/快速上涨的股票…</h2><p id="8a90" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">我们将利用一个名为<a class="ae jg" href="https://pypi.org/project/yfinance/" rel="noopener ugc nofollow" target="_blank"> yfinance </a>的图书馆，它将为我们提供历史库存数据并进口熊猫。</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="e8d0" class="ky kz jj ms b gy mw mx l my mz"># imports<br/>!pip install yfinance<br/>import yfinance as yf<br/>from pandas_datareader import data as pdr<br/>import pandas as pd</span></pre><p id="7eea" class="pw-post-body-paragraph lu lv jj lw b lx na kk lz ma nb kn mc lh nc me mf ll nd mh mi lp ne mk ml mm im bi translated">由于我们不只是想探索最知名的股票，我们将加载所有纳斯达克股票的完整列表:</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="4ef0" class="ky kz jj ms b gy mw mx l my mz"># list all stocks<br/>url = “ftp://ftp.nasdaqtrader.com/SymbolDirectory/nasdaqlisted.txt"<br/>df=pd.read_csv(url, sep=”|”)<br/>print(df.head())<br/>print(df['Symbol'].head())<br/>print(len(df['Symbol']))</span></pre><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nf"><img src="../Images/40aad859b03d3dad00b895a46489697e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JEPtvGxvmxz5UP29uWQzCA.png"/></div></div></figure><p id="6df8" class="pw-post-body-paragraph lu lv jj lw b lx na kk lz ma nb kn mc lh nc me mf ll nd mh mi lp ne mk ml mm im bi translated">这为我们提供了一个包含 3549 个股票代码的变量(df )!</p><p id="52c6" class="pw-post-body-paragraph lu lv jj lw b lx na kk lz ma nb kn mc lh nc me mf ll nd mh mi lp ne mk ml mm im bi translated">那么，我们如何获得今天的高推动者？让我们从检索列表中每只股票的最近历史开始，并将其存储在<code class="fe ng nh ni ms b">movementlist</code>中</p><p id="a156" class="pw-post-body-paragraph lu lv jj lw b lx na kk lz ma nb kn mc lh nc me mf ll nd mh mi lp ne mk ml mm im bi translated">我首先定义了一个助手函数，它允许我们通过错误检查从数据帧中快速查找值。</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="9090" class="ky kz jj ms b gy mw mx l my mz">def lookup_fn(df, key_row, key_col):<br/> try:<br/> return df.iloc[key_row][key_col]<br/> except IndexError:<br/> return 0</span></pre><p id="33df" class="pw-post-body-paragraph lu lv jj lw b lx na kk lz ma nb kn mc lh nc me mf ll nd mh mi lp ne mk ml mm im bi translated">我回顾 5 天前。您可以在命令<code class="fe ng nh ni ms b">hist = thestock.history(period=”5d”)</code>中更改时间段</p><p id="949d" class="pw-post-body-paragraph lu lv jj lw b lx na kk lz ma nb kn mc lh nc me mf ll nd mh mi lp ne mk ml mm im bi translated">我们填充运动列表(股票代码，在一段时间内的低，在一段时间内的高)。</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="8035" class="ky kz jj ms b gy mw mx l my mz">movementlist = []</span><span id="9a8c" class="ky kz jj ms b gy nj mx l my mz">for stock in df['Symbol']:<br/>  # get history<br/>  thestock = yf.Ticker(stock)<br/>  hist = thestock.history(period="5d")</span><span id="eb08" class="ky kz jj ms b gy nj mx l my mz">  # print(stock)</span><span id="d541" class="ky kz jj ms b gy nj mx l my mz">  low = float(10000)<br/>  high = float(0)</span><span id="04cb" class="ky kz jj ms b gy nj mx l my mz">  # print(thestock.info)</span><span id="4c3d" class="ky kz jj ms b gy nj mx l my mz">  for day in hist.itertuples(index=True, name='Pandas'):</span><span id="a86d" class="ky kz jj ms b gy nj mx l my mz">    if day.Low &lt; low:<br/>      low = day.Low<br/>    if high &lt; day.High:<br/>      high = day.High<br/>  <br/>  deltapercent = 100 * (high - low)/low<br/>  Open = lookup_fn(hist, 0, "Open")</span><span id="2e20" class="ky kz jj ms b gy nj mx l my mz">  # some error handling: <br/>  if len(hist &gt;=5):<br/>    Close = lookup_fn(hist, 4, "Close")<br/>  else :<br/>    Close = Open</span><span id="c939" class="ky kz jj ms b gy nj mx l my mz">  if(Open == 0):<br/>    deltaprice = 0</span><span id="187b" class="ky kz jj ms b gy nj mx l my mz">  else:<br/>    deltaprice = 100 * (Close - Open) / Open</span><span id="0333" class="ky kz jj ms b gy nj mx l my mz">  print(stock+" "+str(deltapercent)+ " "+ str(deltaprice))<br/>  pair = [stock, deltapercent, deltaprice]<br/>  movementlist.append(pair)</span></pre><p id="1f44" class="pw-post-body-paragraph lu lv jj lw b lx na kk lz ma nb kn mc lh nc me mf ll nd mh mi lp ne mk ml mm im bi translated">现在我们已经填充了我们的股票移动列表，我们可以继续过滤出最高的移动。如果您只想快速获得那些移动超过 100%的人的列表:</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="fdd4" class="ky kz jj ms b gy mw mx l my mz">for entry in movementlist:<br/>  if entry[1]&gt;float(100):<br/>    print(entry)</span></pre><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nk"><img src="../Images/3936c9d2d9f24d0cf7d473de825ad7ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ccdxlbEC2M9I4heDNjO7Q.png"/></div></div></figure><p id="4dfd" class="pw-post-body-paragraph lu lv jj lw b lx na kk lz ma nb kn mc lh nc me mf ll nd mh mi lp ne mk ml mm im bi translated">如果我们有兴趣更详细地了解这些股票，我们需要更多的信息，比如它们所属的行业。下面是我们如何正确清理列表:</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="1aa3" class="ky kz jj ms b gy mw mx l my mz"># High risers:<br/>def lookup_stockinfo(thestock):<br/>  try<br/>    return thestock.info<br/>  except IndexError:<br/>    return 0</span><span id="b24c" class="ky kz jj ms b gy nj mx l my mz">cutoff=float(80)</span><span id="494b" class="ky kz jj ms b gy nj mx l my mz">for entry in movementlist:<br/>  if entry[2]&gt;cutoff:<br/>    print("\n"+ str(entry))<br/>    thestock = yf.Ticker(str(entry[0]))</span><span id="82f2" class="ky kz jj ms b gy nj mx l my mz">    if entry[0]=='HJLIW':<br/>      print("no info")<br/>    else:<br/>      a = lookup_stockinfo(thestock)</span><span id="2ed0" class="ky kz jj ms b gy nj mx l my mz">if a == 0:<br/>        print("no info")<br/>      else:<br/>        if a is None:<br/>          print("no info")<br/>        else:<br/>          if a == "":<br/>            print("no")<br/>          else:<br/>            print(a)<br/>            print('Up '+ str(entry[2]) + "%")<br/>            print(str(a['sector']))<br/>            print(str(a['longBusinessSummary']))<br/>            print("year high "+ str(a['fiftyTwoWeekHigh']))</span></pre><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nl"><img src="../Images/041d6c5b6e0384fe1d9f0f72cdd2d070.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OUHTxHDgstUW8RbIYyY5cQ.png"/></div></div></figure><p id="e0f1" class="pw-post-body-paragraph lu lv jj lw b lx na kk lz ma nb kn mc lh nc me mf ll nd mh mi lp ne mk ml mm im bi translated">结果是一个详细的概述，其中包含过去 5 天中涨幅最大的股票的一些信息。非常有趣的检测一些快速移动的股票，为投机者或只是为任何人想找到一个隐藏的宝石股票！</p></div></div>    
</body>
</html>