<html>
<head>
<title>From PyTorch to PyTorch Lightning — A gentle introduction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从 PyTorch 到 py torch Lightning——一个温和的介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/from-pytorch-to-pytorch-lightning-a-gentle-introduction-b371b7caaf09?source=collection_archive---------0-----------------------#2020-02-27">https://towardsdatascience.com/from-pytorch-to-pytorch-lightning-a-gentle-introduction-b371b7caaf09?source=collection_archive---------0-----------------------#2020-02-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6788" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章回答了如果你使用 PyTorch 为什么需要 Lightning 这个最常见的问题。</p><p id="c50f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">PyTorch 非常容易用来建立复杂的人工智能模型。但是一旦研究变得复杂，并且像多 GPU 训练、16 位精度和 TPU 训练这样的事情混合在一起，用户很可能会引入错误。</p><p id="1bdd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://github.com/williamFalcon/pytorch-lightning" rel="noopener ugc nofollow" target="_blank"> PyTorch 闪电</a>正好解决了这个问题。Lightning 构建了 PyTorch 代码，因此它可以抽象训练的细节。这使得人工智能研究具有可扩展性，迭代速度快。</p><h1 id="db91" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">PyTorch 闪电是为了谁？</h1><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/8ccd87a3d2e6a32d0b712f3916d949ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*oEkULsraelP7wNH6F8_zGg.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">PyTorch Lightning 是在 NYU 和费尔做博士研究时创造的</p></figure><p id="25a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> PyTorch Lightning 是为从事人工智能研究的专业研究人员和博士生创造的</strong>。</p><p id="cdc3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">闪电诞生于我在<a class="ae kl" href="https://wp.nyu.edu/cilvr/" rel="noopener ugc nofollow" target="_blank"> NYU CILVR </a>和<a class="ae kl" href="https://ai.facebook.com/" rel="noopener ugc nofollow" target="_blank">脸书 AI Research </a>的博士 AI 研究。因此，该框架被设计成具有极强的可扩展性，同时使得最先进的人工智能研究技术(如 TPU 训练)变得微不足道。</p><p id="af5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在<a class="ae kl" href="https://pytorch-lightning.readthedocs.io/en/latest/BECOMING_A_CORE_CONTRIBUTOR.html" rel="noopener ugc nofollow" target="_blank">核心贡献者</a>都在使用闪电推进人工智能的艺术状态，并继续添加新的酷功能。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi lw"><img src="../Images/a9bd54fd2e58f0b844adf652f2d00e2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9fnIoPevuZHJnvNqlte40g.jpeg"/></div></div></figure><p id="54e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，简单的界面让<strong class="jp ir">专业制作团队</strong>和<strong class="jp ir">新人</strong>能够接触到 Pytorch 和 PyTorch Lightning 社区开发的最新技术。</p><p id="5919" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Lightning counts 拥有超过<a class="ae kl" href="https://github.com/PyTorchLightning/pytorch-lightning/graphs/contributors" rel="noopener ugc nofollow" target="_blank"> 320 名贡献者</a>，由<a class="ae kl" href="https://pytorch-lightning.readthedocs.io/en/latest/governance.html" rel="noopener ugc nofollow" target="_blank"> 11 名研究科学家</a>，博士生和专业深度学习工程师组成的核心团队。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mb"><img src="../Images/d4fc2c07fde2735048b56946a045ddd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SjW_ILtdER7gbBMIzxicLA.png"/></div></div></figure><p id="a51c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它是经过严格测试的</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mc"><img src="../Images/78db3ea3dbd3746851c71678185c146e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EMpOIboMGGz9F1mNtQGp_g.png"/></div></div></figure><p id="7cf8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并且<a class="ae kl" href="https://pytorch-lightning.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">彻底记录了</a></p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi md"><img src="../Images/401d4655f42a97291a3ca092a0b29526.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b81_j__xv8M0Bb6nFTXbAA.png"/></div></div></figure><h1 id="c5fa" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">概述</h1><p id="4235" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">本教程将带你构建一个简单的 MNIST 分类器，并排显示 PyTorch 和 PyTorch Lightning 代码。虽然 Lightning 可以构建任何任意复杂的系统，但我们使用 MNIST 来说明如何将 PyTorch 代码重构为 PyTorch Lightning。</p><p id="71e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://colab.research.google.com/drive/1Mowb4NzWlRCxzAFjOIJqUmmk_wAT-XP3" rel="noopener ugc nofollow" target="_blank">完整代码可在本 Colab 笔记本</a>上获得。</p></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="e2c7" class="km kn iq bd ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf mu lh li lj bi translated">典型的人工智能研究项目</h1><p id="2588" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">在一个研究项目中，我们通常希望确定以下关键组成部分:</p><ul class=""><li id="a063" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi translated">模型</li><li id="e81d" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk na nb nc nd bi translated">数据</li><li id="d5cd" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk na nb nc nd bi translated">损失</li><li id="c33e" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk na nb nc nd bi translated">优化程序</li></ul><h1 id="ae00" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">模型</h1><p id="af47" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">让我们设计一个 3 层全连接神经网络，它将 28x28 的图像作为输入，输出 10 个可能标签的概率分布。</p><p id="4b93" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，让我们在 PyTorch 中定义模型</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/6d3dc533159e59e1feac21bbb88ae712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*wS0o4efr2DQnDN6NJUTMvg.png"/></div></figure><p id="5327" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该模型定义了计算图形，将 MNIST 图像作为输入，并将其转换为数字 0-9 的 10 个类别的概率分布。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi nk"><img src="../Images/960bd2610dfe2cc2d1aa9a92ff773698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DgYiXo_5v3Zp68qGONosWw.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">三层网络(插图作者:威廉·法尔孔)</p></figure><p id="5f91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了将这个模型转换成 PyTorch Lightning，我们简单地替换掉<em class="nl"> nn。带<em class="nl"> pl 的模块</em>。照明模块</em></p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/d19aa13add02c342c497b8a5318b74a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*oq6G91hMTqHlvxgGfsgtcw.png"/></div></figure><p id="e158" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">新的 PyTorch Lightning 类与 PyTorch 完全相同，除了 LightningModule 为研究代码提供了一个结构。</p><blockquote class="nn no np"><p id="7098" class="jn jo nl jp b jq jr js jt ju jv jw jx nq jz ka kb nr kd ke kf ns kh ki kj kk ij bi translated">闪电为 PyTorch 代码提供了结构</p></blockquote><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi nt"><img src="../Images/4b3d3c9cf909398d27a9ba87689073b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_mbNZKVOUQLLAAxMSl9bfg.png"/></div></div></figure><p id="bca7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看到了吗？两者的代码完全一样！</p><p id="a309" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着你可以像使用 PyTorch 模块一样使用 LightningModule 模块，比如预测模块<strong class="jp ir"/></p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/c4558a822c5eac3b3ae51994eff3f869.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*clq_bui-z1xi3Y-Ih_qhFg.png"/></div></figure><p id="02e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者将其用作预训练模型</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi nv"><img src="../Images/3f478ef0af74a1db905eebeef3a5cf0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*01K8BlcocePCGmxtEBziwg.jpeg"/></div></div></figure><h1 id="7577" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">数据</h1><p id="d636" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">对于本教程，我们使用 MNIST。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/99df67ac0c3a22be078e45dedeb97be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/0*XGBPxYSO2-hGEXNV.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">来源:<a class="ae kl" href="https://en.wikipedia.org/wiki/MNIST_database" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></figure><p id="21c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们生成 MNIST 的三个部分，培训、验证和测试部分。</p><p id="364b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，PyTorch 和 Lightning 中的代码是一样的。</p><p id="1ffc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据集被添加到 Dataloader 中，data loader 处理数据集的加载、混排和批处理。</p><p id="9a88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简而言之，数据准备有 4 个步骤:</p><ol class=""><li id="5468" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk nx nb nc nd bi translated">下载图像</li><li id="fee9" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk nx nb nc nd bi translated">图像转换(这些非常主观)。</li><li id="0924" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk nx nb nc nd bi translated">生成训练、验证和测试数据集拆分。</li><li id="3c29" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk nx nb nc nd bi translated">包装数据加载器中拆分的每个数据集</li></ol><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi ny"><img src="../Images/1b0b74250d6b532d63618a1bb19eed96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZAk4hLZgq8M71YAV6jborA.png"/></div></div></figure><p id="120b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，除了我们将 PyTorch 代码组织成 4 个函数之外，代码完全相同:</p><p id="277d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">准备 _ 数据</strong></p><p id="9e0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个函数处理下载和任何数据处理。这个函数确保当您使用多个 GPU 时，您不会下载多个数据集或对数据应用双重操作。</p><p id="dbcf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是因为每个 GPU 将执行相同的 PyTorch，从而导致重复。Lightning 中的所有代码确保关键部分仅从一个 GPU 中调用。</p><p id="9336" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> train_dataloader，val_dataloader，test_dataloader </strong></p><p id="8e1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中每一个都负责返回适当的数据分割。Lightning 以这种方式构建它，以便非常清楚数据是如何被操纵的。如果你读过用 PyTorch 写的随机 github 代码，你几乎不可能看到他们是如何处理数据的。</p><p id="3f5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Lightning 甚至允许多个数据加载器进行测试或验证。</p><p id="7cd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这段代码被组织在我们称之为数据模块的地方。尽管这是 100%可选的，并且 lightning 可以直接使用数据加载器，但是一个<a class="ae kl" href="https://pytorch-lightning.readthedocs.io/en/stable/datamodules.html" rel="noopener ugc nofollow" target="_blank">数据模块</a>使您的数据可以重用并且易于共享。</p><h1 id="2181" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">优化器</h1><p id="a60e" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">现在我们选择如何进行优化。我们将使用 Adam 代替 SGD，因为在大多数 DL 研究中，它是一个很好的缺省值。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi nz"><img src="../Images/d86ad2990dc8b3c53cc9bdb83f4de2c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r9w_K-bagPGRHIi_TgwjLQ.jpeg"/></div></div></figure><p id="1768" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，这是<strong class="jp ir">完全相同的</strong>，除了它被组织到配置优化器功能中。</p><p id="4196" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Lightning 是极其可扩展的<strong class="jp ir">。</strong>例如，如果你想使用多个优化器(比如:GAN)，你可以在这里同时返回两个。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi oa"><img src="../Images/3be1e88d4cec5f44fcb080bdba4114b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zf3m5rYC8RbKuFhtsWjskA.png"/></div></div></figure><p id="e923" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您还会注意到，在 Lightning 中，我们传入了<strong class="jp ir"><em class="nl">self . parameters()</em></strong><em class="nl"/>而不是模型，因为 LightningModule 是模型。</p><h1 id="754d" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">损失</h1><p id="f2fd" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">对于 n 路分类，我们想要计算交叉熵损失。交叉熵与负对数似然度(log_softmax)相同，我们将使用负对数似然度。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi ob"><img src="../Images/8d8e034d45ef79555784b5a2cc2c2d6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_b5KEGf9bclvvUL2RdO-fA.jpeg"/></div></div></figure><p id="2bd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">再次…代码完全相同！</p></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="bdc5" class="km kn iq bd ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf mu lh li lj bi translated">训练和验证循环</h1><p id="994d" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">我们收集了训练所需的所有关键材料:</p><ol class=""><li id="9855" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk nx nb nc nd bi translated">模型(三层神经网络)</li><li id="0188" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk nx nb nc nd bi translated">数据集(MNIST)</li><li id="806a" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk nx nb nc nd bi translated">优化器</li><li id="3e75" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk nx nb nc nd bi translated">损失</li></ol><p id="c009" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们实施一套完整的训练程序，包括以下内容:</p><ul class=""><li id="4792" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi translated">迭代多个历元(一个历元是对数据集<strong class="jp ir"> D </strong>的一次完整遍历)</li></ul><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/a3afbb0a498043426965b21507c74837.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*4Rsl15bCoTpDmXFFpWw1hw.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">在数学方面</p></figure><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi od"><img src="../Images/dbe04ffe41b469e87b9e8aabccf605ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*1cNPyK4x4tz99-iFsu7Wfg.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">用代码</p></figure><ul class=""><li id="7ec5" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi translated">每个历元以称为批次<strong class="jp ir"> b </strong>的小块迭代数据集</li></ul><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/e7dd593e02da0ad3826b6ae5f3c8db79.png" data-original-src="https://miro.medium.com/v2/resize:fit:196/format:webp/1*ctKs6MsUkuELI7MPCyhRgA.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">在数学方面</p></figure><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi of"><img src="../Images/5914765660f96c2e20c050eefcc55130.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*ksSlgg3TDunDm5NUBpni6A.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">用代码</p></figure><ul class=""><li id="4910" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi translated">我们向前传球</li></ul><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi og"><img src="../Images/6037cd34df798e83b725cc1cbd6c93b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:212/format:webp/1*jaWtm-TYJN32oTZiiNQHhg.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">在数学方面</p></figure><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/9a69977e6906ff750f446f27a712528c.png" data-original-src="https://miro.medium.com/v2/resize:fit:394/format:webp/1*rQiaY9ySkLvP_u2Ivrndjg.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">代码</p></figure><ul class=""><li id="47d6" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi translated">计算损失</li></ul><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/136aec19b7208b79240dc2e8b4717fa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:470/format:webp/1*9X7vyV74yr6raF91RVsIcg.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">在数学方面</p></figure><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/d76b4b85f1ee3204eafb1dd639dfad89.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*vsqOLu_QZRMNEcWrsNK30A.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">用代码</p></figure><ul class=""><li id="cceb" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi translated">执行反向传递以计算每个权重的所有梯度</li></ul><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/30c94f8cc4f77c720e4081cf8c984179.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*d_5muKpCN1N8RKB4oCrOJQ.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">在数学方面</p></figure><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/20650e8617a534a94ad4737f751a4661.png" data-original-src="https://miro.medium.com/v2/resize:fit:354/format:webp/1*CL05a4uMji6PwZoEAlR63g.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">用代码</p></figure><ul class=""><li id="ac3f" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi translated">将渐变应用于每个权重</li></ul><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi om"><img src="../Images/66fe257786530ba10ba54e10fbcb84a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:382/format:webp/1*kS7nrQYzDhogIC0Iw_134Q.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">在数学方面</p></figure><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi on"><img src="../Images/2ea0f6b5ade1d9c0e6c0d2e57d6d52a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*I6WNFV1KpbutsrL5NxX0og.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">用代码</p></figure><p id="dd28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">PyTorch 和 Lightning 中的伪代码都是这样的</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/1e5ee4965e9fa4611dd986e46f8bd14f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*0kIo7fsTwm5xFvTILazing.png"/></div></figure><p id="cb9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是闪电与众不同的地方。在 PyTorch 中，你自己编写 for 循环，这意味着你必须记住以正确的顺序调用正确的东西——这给 bug 留下了很大的空间。</p><p id="29d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">即使你的模型很简单，但一旦你开始做更高级的事情，如使用多个 GPU、渐变裁剪、提前停止、检查点、TPU 训练、16 位精度等，它就不再简单了。你的代码复杂性将迅速爆炸。</p><blockquote class="nn no np"><p id="c560" class="jn jo nl jp b jq jr js jt ju jv jw jx nq jz ka kb nr kd ke kf ns kh ki kj kk ij bi translated">即使你的模型很简单，一旦你开始做更高级的事情，它就不再简单了</p></blockquote><p id="62f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是 PyTorch 和 Lightning 的验证和训练循环</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi op"><img src="../Images/997cb8cfe5f69501b21f1f6497138345.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nYwSqPWq4PPnAB4hw5n7gg.png"/></div></div></figure><p id="072a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是闪电的妙处。它抽象了样板文件(不在盒子里的东西),但是<strong class="jp ir">没有改变其他任何东西。这意味着你仍然在编写 PyTorch，除非你的代码已经被很好地结构化了。</strong></p><p id="250c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这增加了可读性，有助于再现性！</p><h1 id="9ef0" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">闪电教练</h1><p id="bc87" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">培训师就是我们如何抽象样板代码。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi oq"><img src="../Images/f4ad902369d17fcd27e1be971278eddb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kswFi_ipCKuwR9vWpYlqxg.jpeg"/></div></div></figure><p id="32da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，这也是可能的，因为您所要做的就是将 PyTorch 代码组织成一个 lightning 模块</p><h1 id="ab66" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">PyTorch 的完整训练循环</h1><p id="caa4" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">用 PyTorch 编写的完整 MNIST 示例如下:</p><figure class="ll lm ln lo gt lp"><div class="bz fp l di"><div class="or os l"/></div></figure><h1 id="da0a" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">闪电中的完整训练循环</h1><p id="bec8" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">lightning 版本完全相同，除了:</p><ul class=""><li id="8a89" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi translated">核心成分已经由照明模块组织起来</li><li id="0272" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk na nb nc nd bi translated">培训师已经提取了培训/验证循环代码</li></ul><p id="671e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个版本不使用数据模块，而是保持自由定义的数据加载器。</p><figure class="ll lm ln lo gt lp"><div class="bz fp l di"><div class="or os l"/></div></figure><p id="6b3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是相同的代码，但是数据被分组到数据模块下，变得更加可重用。</p><figure class="ll lm ln lo gt lp"><div class="bz fp l di"><div class="or os l"/></div></figure><h1 id="23b5" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">突出</h1><p id="e607" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">让我们指出几个要点</p><ol class=""><li id="c367" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk nx nb nc nd bi translated">如果没有 Lightning，PyTorch 代码可以位于任意部分。有了闪电，这是结构化的。</li><li id="1a9a" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk nx nb nc nd bi translated">这两者的代码完全相同，只是它是用 Lightning 构建的。(值得说两遍 lol)。</li><li id="56c4" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk nx nb nc nd bi translated">随着项目变得越来越复杂，你的代码不会，因为 Lightning 抽象出了大部分内容。</li><li id="ed31" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk nx nb nc nd bi translated">您保留了 PyTorch 的灵活性，因为您可以完全控制培训中的关键点。例如，您可以有一个任意复杂的 training_step，比如 seq2seq</li></ol><figure class="ll lm ln lo gt lp"><div class="bz fp l di"><div class="or os l"/></div></figure><p id="926d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.在《闪电》中，你得到了一堆赠品，比如一个恶心的进度条</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi ot"><img src="../Images/f663619774c6b98ee28fa5e1a21082da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*kmG3OaNt1pjqC9SRB6N9Kw.png"/></div></div></figure><p id="24df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你还得到了一份漂亮的重量总结</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/71a42da99040ee3f825490097fcfb2ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/1*MqY59LhJ9urAcR-V6K7YUA.png"/></div></figure><p id="7a2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">tensorboard 日志(没错！你什么都不用做就能得到这个)</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi ov"><img src="../Images/4912732badecba0aa490e8eb6469188c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GWVf6anY8VnDlKnBIMKcqg.png"/></div></div></figure><p id="443b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">免费检查点和提前停止。</p><p id="ff12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">全部免费！</p></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="7321" class="km kn iq bd ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf mu lh li lj bi translated">附加功能</h1><p id="db86" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">但闪电最出名的是开箱即用的好东西，如 TPU 培训等…</p><p id="c702" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在 Lightning 中，您可以在 CPU、GPU、多个 GPU 或 TPU 上训练您的模型，而无需更改 PyTorch 代码的任何一行。</p><figure class="ll lm ln lo gt lp"><div class="bz fp l di"><div class="ow os l"/></div></figure><p id="b991" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">也可以做 16 位精度训练</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/2951cac93e55507b3211932336ef193d.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*pqTMd72wZJ0ULC0b5A03rQ.png"/></div></figure><p id="6747" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<a class="ae kl" href="https://pytorch-lightning.readthedocs.io/en/latest/experiment_logging.html" rel="noopener ugc nofollow" target="_blank"> 5 个其他替代物</a>对张量板进行测井</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi oy"><img src="../Images/37dc8b498f0d7e11f1ca650010e43a1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*O_sKeBowpM_XV1osFZU1ug.gif"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">与海王星一起伐木。AI(鸣谢:Neptune.ai)</p></figure><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi oz"><img src="../Images/40f22c3e4f624a0d7292c5cb1115d55b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ojvcqQf4jAyF8JXVJ85Exw.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">用 Comet.ml 记录日志</p></figure><p id="0242" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们甚至有一个内置的分析器，可以告诉你训练中的瓶颈在哪里。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/3e7a25e24c7f3c0bc9037de9eb770fe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*InjZqqlEVET0zCbDEgC1uQ.png"/></div></figure><p id="4cf7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将此标志设置为 on 会产生以下输出</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/3d028c684de3ecc4dd7aa612bfaa80ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*fVMoQU6hjgYHSHwr6UN_QQ.png"/></div></figure><p id="2305" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者更高级的输出</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/f0eaaaf5a511c07c998ffc8112c2b3e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*7ycXPIEJndXxrkLT34roWg.png"/></div></figure><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/4ee0f8aa90e950161595f3f8dd21dc4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*cw8OKKih9PxS9AHkgzc6VQ.png"/></div></figure><p id="77db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还可以<a class="ae kl" href="https://pytorch-lightning.readthedocs.io/en/latest/multi_gpu.html" rel="noopener ugc nofollow" target="_blank">同时在多个 GPU</a>上训练，而不需要你做任何工作(你仍然需要提交一个 SLURM 作业)</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/57659602ff57240839b803f0d5100bc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*YZJjv8uBzJ4n4BOgfhpxEw.png"/></div></figure><p id="becc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在文档中读到它支持的大约<a class="ae kl" href="https://pytorch-lightning.readthedocs.io/en/latest/trainer.html" rel="noopener ugc nofollow" target="_blank"> 40 个其他特性</a>。</p></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="ebaf" class="km kn iq bd ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf mu lh li lj bi translated">带挂钩的可扩展性</h1><p id="9c4e" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">你可能想知道 Lightning 是如何为你做这些事情的，而且还能让你完全控制一切？</p><p id="a8a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与 keras 或其他高级框架不同，lightning 不隐藏任何必要的细节。但是如果你确实发现需要自己修改训练的每一个方面，那么你有两个主要的选择。</p><p id="8c1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先是通过覆盖钩子的可扩展性。下面是一个不完整的列表:</p><ul class=""><li id="e7a5" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi translated"><a class="ae kl" href="https://pytorch-lightning.readthedocs.io/en/latest/lightning-module.html#pytorch_lightning.core.LightningModule.forward" rel="noopener ugc nofollow" target="_blank">向前传球</a></li><li id="2be6" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk na nb nc nd bi translated">偶数道次</li><li id="28ee" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk na nb nc nd bi translated"><a class="ae kl" href="https://pytorch-lightning.readthedocs.io/en/latest/lightning-module.html#pytorch_lightning.core.LightningModule.optimizer_step" rel="noopener ugc nofollow" target="_blank">应用优化器</a></li></ul><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi pf"><img src="../Images/1426ccdf7ffa87361b5f1c50874c5a61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qmi7yHLL63UGzLrUhnodVg.png"/></div></div></figure><ul class=""><li id="6914" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi translated"><a class="ae kl" href="https://pytorch-lightning.readthedocs.io/en/latest/lightning-module.html#pytorch_lightning.core.LightningModule.init_ddp_connection" rel="noopener ugc nofollow" target="_blank">设置分布式培训</a></li></ul><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi pg"><img src="../Images/a841bf39e81348c067d782a19703fd33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZZldF5Wv-a73VTNrpt_uwg.png"/></div></div></figure><ul class=""><li id="85ad" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi translated"><a class="ae kl" href="https://pytorch-lightning.readthedocs.io/en/latest/lightning-module.html#pytorch_lightning.core.LightningModule.configure_apex" rel="noopener ugc nofollow" target="_blank">设置 16 位</a></li></ul><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi ph"><img src="../Images/39f1017fdd019efee9d537a4660deb1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KXOcANQDslOeOViUpObAAw.png"/></div></div></figure><ul class=""><li id="063a" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi translated"><a class="ae kl" href="https://pytorch-lightning.readthedocs.io/en/latest/lightning-module.html#pytorch_lightning.core.LightningModule.tbptt_split_batch" rel="noopener ugc nofollow" target="_blank">我们怎么做截断回道具</a></li></ul><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi pi"><img src="../Images/49c06d07bd387ed83212bfbbb04023c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BjOAwCdcNcEKFQXkUYlY4w.png"/></div></div></figure><ul class=""><li id="2583" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi">…</li><li id="d3a2" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk na nb nc nd bi translated">您需要配置的任何东西</li></ul><p id="11aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些覆盖发生在照明模块中</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi pj"><img src="../Images/02e813bc7e1f7daaae643da59728fa87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iMK5AehGEL6kgreM6yliBA.png"/></div></div></figure><h1 id="cead" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">回调的可扩展性</h1><p id="9060" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">回调是您希望在培训的各个部分执行的一段代码。在 Lightning 中，回调是为非必要的代码保留的，比如日志或者与研究代码无关的东西。这使得研究代码非常干净和有条理。</p><p id="c7c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设您想在培训的各个阶段打印或保存一些东西。这是回调的样子</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi pk"><img src="../Images/b30b215915eaa33384fd79771898dbe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OWvQ78_I5IUS8J_bCaMc0A.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">PyTorch 闪电回拨</p></figure><p id="f4cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在你把它传递给训练者，这个代码会在任意时间被调用</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi pl"><img src="../Images/b58e2f7a9d1c8f45324960647d972133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_XoPKjwzW3vJKv76bvi2NQ.png"/></div></div></figure><p id="a21e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种范式将您的研究代码组织成三个不同的类别</p><ol class=""><li id="9f3e" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk nx nb nc nd bi translated">研究代码(LightningModule)(这就是科学)。</li><li id="794c" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk nx nb nc nd bi translated">工程代码(培训师)</li><li id="6ca1" class="mv mw iq jp b jq ne ju nf jy ng kc nh kg ni kk nx nb nc nd bi translated">与研究无关的代码(回调)</li></ol></div><div class="ab cl mj mk hu ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ij ik il im in"><h1 id="b74f" class="km kn iq bd ko kp mq kr ks kt mr kv kw kx ms kz la lb mt ld le lf mu lh li lj bi translated">如何开始</h1><p id="8cb4" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">希望这份指南能准确地告诉你如何开始。最简单的开始方式是用<a class="ae kl" href="https://colab.research.google.com/drive/1F_RNcHzTfFuQf-LeKvSlud6x7jXYkG31#scrollTo=gjo55nA549pU" rel="noopener ugc nofollow" target="_blank">运行 colab 笔记本，这里是 MNIST 的例子</a>。</p><p id="ae74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者安装闪电</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi pm"><img src="../Images/c1d345ea412ba1cc758a1f50ccef7a1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*160lmx0S6rTQfwem6ZM85Q.png"/></div></div></figure><p id="98f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者查看 Github 页面。</p></div></div>    
</body>
</html>