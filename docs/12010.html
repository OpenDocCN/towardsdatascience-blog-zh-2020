<html>
<head>
<title>Label Encoder and OneHot Encoder in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中的标签编码器和 OneHot 编码器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/label-encoder-and-onehot-encoder-in-python-83d32288b592?source=collection_archive---------17-----------------------#2020-08-19">https://towardsdatascience.com/label-encoder-and-onehot-encoder-in-python-83d32288b592?source=collection_archive---------17-----------------------#2020-08-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ce93" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过示例了解标签编码器、OneHot 编码器和 Pandas 虚拟变量</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/98253618708033f068db0e81da57a154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*We17NJTPtrC_u5FCitZyMw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">杰西卡在<a class="ae ky" href="https://unsplash.com/s/photos/number-for-alphabet?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的</p></figure><p id="29af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> M </span>机器学习算法理解数字而不是文本。因此，所有“文本”列都必须转换为“数字”列，以便算法能够理解。</p><p id="3622" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是将标签或分类或<strong class="lb iu"> <em class="me">文本</em> </strong>值转换成数字或<strong class="lb iu"> <em class="me">数值</em> </strong>值的故事。简单来说，</p><blockquote class="mf"><p id="7e80" class="mg mh it bd mi mj mk ml mm mn mo lu dk translated">编码是将单词转换成数字的过程</p></blockquote><p id="834a" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">在 Python 中，<strong class="lb iu"> OneHot 编码</strong>和<strong class="lb iu">勒贝尔编码</strong>是将分类列编码成数值列的两种方法。而这些都是最常用的 Python 库的一部分:<strong class="lb iu"> <em class="me"> Scikit-Learn </em> </strong></p><p id="b8fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是等等，你不会想在笔记本里导入 Scikit-Learn 吧？？</p><p id="06a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没问题，⚡️熊猫会来帮你的。</p><p id="741b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们深入这个将分类变量转换成数字变量的故事，以便 ML 算法理解它。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="6776" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">分类数据</h1><p id="bbcf" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">任何数据集都包含多个包含数值和分类值的列。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/703666b46fa3fdaa7970d12efd17e0b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*kUZ0KeJD09ihguv4OE108w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图像:分类列的数据类型</p></figure><p id="8d0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分类变量代表可以分组的数据类型。它有有限且通常固定数量的可能值，称为<strong class="lb iu"> <em class="me">类别</em> </strong>。性别、社会阶层、血型、国家代码等变量都是分类数据的例子。</p><p id="03db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果该数据被编码成数值，那么只有它可以在机器学习算法中被处理。</p><p id="7788" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们考虑下面的例子，以简单的方式理解编码。</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="e60e" class="oe nc it oa b gy of og l oh oi">import pandas as pd</span><span id="9444" class="oe nc it oa b gy oj og l oh oi">countries = ["Germany","India","UK","Egypt","Iran"]<br/>continents = ["Europe","Asia","Europe","Africa","Asia"]<br/>code = ["G","I","U","E","N"]<br/>d={"country": countries, "continent":continents, "code":code}<br/>df = pd.DataFrame(d)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/d2906eef57fdd6d515c1c532e1f0d43e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yZ6I4bIbKSGwTOpQj9F45A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片:示例数据框架</p></figure><p id="5d63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将“代码”列的数据类型从对象转换为类别</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="5ed1" class="oe nc it oa b gy of og l oh oi">df['code'] = df.code.astype('category')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/38e720f65dcf69b4fffb48d7030df717.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*u1Z9oatXb7WPGCIf6II6JQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按作者分类的图像:所有列的数据类型</p></figure><p id="c016" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过这个例子让我们了解编码过程。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="cc6e" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">Python 中的标签编码</h1><p id="1430" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">标签编码是一种简单直接的方法。这会将分类列中的每个值转换为数值。分类列中的每个值称为标签。</p><blockquote class="mf"><p id="33e8" class="mg mh it bd mi mj mk ml mm mn mo lu dk translated">标签编码:根据字母顺序为每个标签分配一个唯一的整数</p></blockquote><p id="d70b" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">让我用上面的例子向您展示标签编码在 python 中是如何工作的，</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="8194" class="oe nc it oa b gy of og l oh oi">from sklearn.preprocessing import LabelEncoder</span><span id="66b6" class="oe nc it oa b gy oj og l oh oi">le = LabelEncoder()<br/>df["labeled_continent"] = le.fit_transform(df["continent"])<br/>df</span></pre><p id="4adc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">列<code class="fe om on oo oa b"><strong class="lb iu">continent</strong></code>中的标签将被转换成数字，并存储在新列<code class="fe om on oo oa b"><strong class="lb iu"> labeled_continent</strong></code>中</p><p id="8c86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出将是，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/e7221a90b9ead32e855c74a41196752a.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*EJ19FaIzF626lp6Y-DhVsg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片:Python 中的标签编码</p></figure><p id="12fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用更简单的话来说，标签按字母顺序排列，从 0 开始给每个标签分配一个唯一的索引<em class="me">。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/0de45f9f41cb95602a9fc7a3efb7ed4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H_pkiMfavkxCCYJG_RNeJQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片:了解 Python 中的标签编码</p></figure><p id="0625" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一切正常吗？？干得好，⁉️</p><p id="8e5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里涉及到标签编码的问题。它使用序列中的数字来引入标签之间的比较。在上面的例子中，列<code class="fe om on oo oa b"><strong class="lb iu">continent</strong></code>中的标签没有顺序或等级。但是标签编码后，这些标签是按字母顺序排列的。由于这些数字，机器学习模型可以将这种排序解释为<code class="fe om on oo oa b">Europe &gt; Asia &gt; Africa</code></p><p id="9bde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了解决标签编码的排序问题，OneHot 编码应运而生。</p><h1 id="a12e" class="nb nc it bd nd ne or ng nh ni os nk nl jz ot ka nn kc ou kd np kf ov kg nr ns bi translated">Python 中的 OneHot 编码</h1><p id="cc42" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">在 OneHot 编码中，为列中的每个标签创建一个<em class="me">二进制列</em>。这里，每个标签都被转换为一个新列或新要素，并被赋予 1(热)或 0(冷)值。</p><p id="bb38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我先给你看一个例子来理解上面的陈述，</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="436c" class="oe nc it oa b gy of og l oh oi">from sklearn.preprocessing import OneHotEncoder</span><span id="f050" class="oe nc it oa b gy oj og l oh oi">ohe = OneHotEncoder()<br/>df3 = pd.DataFrame(ohe.fit_transform(df[["continent"]]).toarray())<br/>df_new=pd.concat([df,df3],axis=1)<br/>df_new</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/b86f3bd5290f09f862a35816adba5e63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*WtcMIikJNn0Bw3v0Z1LOgA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片:Python 中的 OneHot 编码</p></figure><p id="9fe1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个场景中，最后三列是 OneHot 编码的结果。非洲、亚洲和欧洲的标签分别被编码为 0、1、2。OneHot 编码将这些标签转换成列。因此，查看最后 3 列，我们有<code class="fe om on oo oa b">3 labels → 3 columns</code></p><blockquote class="mf"><p id="5588" class="mg mh it bd mi mj mk ml mm mn mo lu dk translated">OneHot 编码:在一行中只有一个标签是热的</p></blockquote><p id="c58f" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">在特定的行中，只有一个标签的值为 1，所有其他标签的值为 0。在将这样的编码数据集输入到机器学习模型之前，可以进行更多的转换，如 OneHot Encoding <a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html#sklearn.preprocessing.OneHotEncoder" rel="noopener ugc nofollow" target="_blank">文档</a>中所述。</p><p id="48c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">快速浏览这篇文章，了解合并两个数据帧的更多选项</p><div class="ox oy gp gr oz pa"><a rel="noopener follow" target="_blank" href="/join-the-tables-ab7fd4fac26b"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">加入表格</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">了解 Python pandas 中的 merge()和 concat()</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po ks pa"/></div></div></a></div><h1 id="d9f4" class="nb nc it bd nd ne or ng nh ni os nk nl jz ot ka nn kc ou kd np kf ov kg nr ns bi translated">Python 中的 pandas.get_dummies()</h1><p id="0ff7" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">OneHot 编码可以以更简单的方式实现，无需导入<strong class="lb iu"> <em class="me"> Scikit-Learn。</em>T15】</strong></p><p id="1e45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">⚡️赞成！！熊猫是你的朋友。这个简单的函数<code class="fe om on oo oa b">pandas.get_dummies()</code>会将指定列中的所有标签快速转换成单独的二进制列</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="e363" class="oe nc it oa b gy of og l oh oi">df2=pd.get_dummies(df[["continent"]])<br/>df_new=pd.concat([df,df2],axis=1)<br/>df_new</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/b75c82a037c31b23471ffc9e7d1bd46d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2uVo6rbbTRyVFGW2iU5Hng.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片作者:熊猫虚拟变量</p></figure><p id="1e5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述数据帧的最后 3 列与 OneHot 编码中观察到的相同。</p><p id="8517" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">pandas.get_dummies()为列<code class="fe om on oo oa b"><strong class="lb iu">continent</strong></code>中的每个标签生成虚拟变量。因此，<em class="me">非洲大陆、亚洲大陆、</em>和<em class="me">欧洲大陆</em>分别是非洲、亚洲和欧洲标签的虚拟<strong class="lb iu">二元变量</strong>。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><h1 id="a6e6" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">通过我的故事，</h1><p id="cdad" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">我向您介绍了将分类变量转换为数值变量的方法。每种方法都有自己的优点和局限性，因此理解所有的方法很重要。根据您想要实现的数据集和机器学习模型，您可以在 Python 中选择上述三种标签编码方法中的任意一种。</p><p id="53ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一些资源可以帮助你解决这个问题:</p><ol class=""><li id="792f" class="pq pr it lb b lc ld lf lg li ps lm pt lq pu lu pv pw px py bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html" rel="noopener ugc nofollow" target="_blank">Python 中的标签编码</a></li><li id="beb2" class="pq pr it lb b lc pz lf qa li qb lm qc lq qd lu pv pw px py bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html#sklearn.preprocessing.OneHotEncoder" rel="noopener ugc nofollow" target="_blank">Python 中的 OneHot 编码</a></li><li id="0d67" class="pq pr it lb b lc pz lf qa li qb lm qc lq qd lu pv pw px py bi translated"><a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.get_dummies.html" rel="noopener ugc nofollow" target="_blank">使用熊猫获取虚拟变量</a></li></ol><p id="ec4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">喜欢我讲故事的方式吗？？</p><p id="291a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个有趣的<strong class="lb iu"><em class="me">fun&amp;learn</em></strong>活动供你创建自己的数据集。看一看。</p><div class="ox oy gp gr oz pa"><a rel="noopener follow" target="_blank" href="/web-scraping-make-your-own-dataset-cc973a9f0ee5"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">网页抓取—制作您自己的数据集</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">从网页中提取数据并将其存储到 excel 中—只需 4 个简单的步骤</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="qe l pl pm pn pj po ks pa"/></div></div></a></div></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><p id="6bf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="me">感谢您的宝贵时间！</em> </strong></p><p id="d351" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我总是乐于接受建议和新的机会。请随时添加您的反馈，并通过<a class="ae ky" href="https://www.linkedin.com/in/surajgurav17/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>与我联系。</p></div></div>    
</body>
</html>