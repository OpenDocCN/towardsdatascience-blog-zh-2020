<html>
<head>
<title>AI chatbot for sentiment analysis on fake messages.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">人工智能聊天机器人对虚假信息进行情感分析。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ai-chatbot-for-sentiment-analysis-on-fake-messages-abf96382a92d?source=collection_archive---------73-----------------------#2020-05-26">https://towardsdatascience.com/ai-chatbot-for-sentiment-analysis-on-fake-messages-abf96382a92d?source=collection_archive---------73-----------------------#2020-05-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b3d0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过社交媒体传播的假新闻已经成为一个严重的问题。在本文中，我们将了解如何通过对转发的消息进行“事实检查”来进行情感分类，并将该解决方案作为聊天机器人集成到 Telegram 中。</h2></div><p id="4010" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将浏览我为这个解决方案构建的架构，并尝试解决社交媒体中转发消息的真实性和正确性。</p><p id="4386" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个语料库很小，而且是从 PIB 官方<a class="ae le" href="https://twitter.com/PIBFactCheck" rel="noopener ugc nofollow" target="_blank">推特</a>页面上经过核实的事实中提取的。</p><p id="9484" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> AI chatbot </strong>:顾名思义，它是一种通过文本或语音交互来模仿人类对话的 AI 软件程序。聊天机器人变得越来越突出的原因是因为它们可以全天候工作，节省时间和金钱，将企业与客户、员工、家庭自动化等联系起来。</p><h2 id="538b" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">限制范围，我们集中于情感分析，而不是对话机器人。我将解决这个问题，以检测短信是假的还是事实，而不是意图分类。</h2><p id="52a3" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated"><strong class="kk iu">聊天机器人方法</strong>:选择方法是主动的(例如，对用户请求的建议)还是被动的(仅仅响应用户请求)。对于事实检查用例，我们采用反应式方法，因为我们只需要做出反应，告知消息是否是事实。</p><p id="67e8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是架构:</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi md"><img src="../Images/baa98d36acbf5a8a3aaf7abb26383b77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c_xHvWdPzTnpj_c8Q4JGgQ.png"/></div></div></figure><p id="245e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们从模块开始，详细了解每一个模块:</p><p id="181a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">设计模块</strong>:该模块控制对话流程，主要关注请求和响应，基于规则，也可用于意图分类。但是，我限制了流量，以解决消息的真实性。</p><p id="7135" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">通信模块</strong>:由于通信非常轻量级，所以我使用了无服务器架构。我们可以用谷歌云功能(或 AWS Lambda)来托管代码。API 可以通过 REST 调用，这简化了我们的过程。</p><ul class=""><li id="205f" class="mp mq it kk b kl km ko kp kr mr kv ms kz mt ld mu mv mw mx bi translated">初始化函数:将训练好的模型和标记器从云存储中复制到临时目录中。</li><li id="315f" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated">更新功能:更新最新型号。这可以通过 REST API 调用，它将更新的模型从存储桶复制到临时目录。</li><li id="02c6" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated">Webhook:这个函数通过后端系统处理用户的请求和响应。它还记录用户请求并跟踪对话。</li><li id="ac84" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld mu mv mw mx bi translated">匹配功能:本模块的重要组成部分。它清理文本，使用经过训练的标记器和模型来预测消息是真是假。</li></ul><p id="47c5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">部署模块</strong>:处理模型、数据集、模型训练和云基础设施管理的部署。使用官方 twitter API，我们从官方源页面获取新的 tweets，将数据提取到相关部分，并将数据集存储在 DB 中。为了 CI/CD，组件被集装箱化。我将在以后的文章中详细介绍这个模块。</p><h1 id="4d4f" class="nd lg it bd lh ne nf ng lk nh ni nj ln jz nk ka lq kc nl kd lt kf nm kg lw nn bi translated"><strong class="ak"> NLU 街区:建筑的大脑</strong></h1><figure class="me mf mg mh gt mi gh gi paragraph-image"><div class="gh gi no"><img src="../Images/cac1494896a8561caba64884bf541f8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*PMwXYfrcQf2azQ2tfG8XoA.png"/></div><p class="np nq gj gh gi nr ns bd b be z dk translated">NLU 组件:图片版权@ Sudhir Kakumanu</p></figure><p id="1b67" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">简而言之，这个模块负责对转发的消息进行情感分析。执行流程如下:</p><ol class=""><li id="7871" class="mp mq it kk b kl km ko kp kr mr kv ms kz mt ld nt mv mw mx bi translated"><strong class="kk iu">数据集</strong>:我们获取数据集进行事实检查。这个数据集是从印度 PIB 的官方 twitter 句柄策划的。</li><li id="9791" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld nt mv mw mx bi translated"><strong class="kk iu">文本处理</strong>:对数据集进行处理，即删除特殊字符、调整编码、词条分类、解构缩写、社交信息俚语等。</li><li id="76a1" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld nt mv mw mx bi translated">WordCloud 是从这段文字中准备出来的，并经过分析，看看是否有我们可以去除的异常值。</li></ol><div class="me mf mg mh gt ab cb"><figure class="nu mi nv nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><img src="../Images/bff859cdbb637ac142bcdd1ae41422f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*BxgVoiQhJdgpnHLwtvii4Q.png"/></div></figure><figure class="nu mi oa nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><img src="../Images/5bcc0b534581c99edff0e452a09798fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*QmABGKsyJXjmxteVpZryAA.png"/></div></figure></div><div class="ab cb"><figure class="nu mi nv nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><img src="../Images/4cd1475177c34d0f60440f62eed137f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*Q7kM1DTjspLyJCppybmAPg.png"/></div></figure><figure class="nu mi oa nw nx ny nz paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><img src="../Images/ebb258e3a1005901e94f0b5fd69bf44a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*Z3Dlp7CpTyjIlhkZingeaw.png"/></div><p class="np nq gj gh gi nr ns bd b be z dk ob di oc od translated">词云和频率分布</p></figure></div><p id="81f9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">4.<strong class="kk iu">迁移学习</strong>:我们将使用在<a class="ae le" href="https://code.google.com/archive/p/word2vec/" rel="noopener ugc nofollow" target="_blank">谷歌新闻数据集</a>(约 1000 亿字)的一部分上训练的预训练向量。该模型包含 300 维向量，包含 300 万个单词和短语。</p><p id="67cf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">5.<strong class="kk iu">应用 PCA </strong>并分析主成分，以检查数据集是否有任何协方差，简单来说，我们检查是否有任何公共因子。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi oe"><img src="../Images/4595b94b59b6752f6fa29d1b292ad6af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YVtMj96lAGmijfNUxzfCWw.png"/></div></div><p class="np nq gj gh gi nr ns bd b be z dk translated">主成分分析</p></figure><p id="9aba" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">6.<strong class="kk iu">嵌入和矢量化器</strong>:从预训练的模型中提取嵌入，并对训练语料进行矢量化，得到嵌入矩阵。这个嵌入层充当我们的神经网络的初始层。这是一个 Word2Vec 表示，用于提取单词的语义信息。</p><p id="3bfd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">7.<strong class="kk iu"> LSTM &amp;神经网络</strong>:为了捕捉文本序列化信息，我们将使用 LSTM(基于 RNN 的模型)来理解句子的上下文，即从先前的神经元记住的单词序列，并将其传递给未来以进一步分析数据。</p><p id="248f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">自定义数据集的单词嵌入是在训练神经网络时学习的。</p><ol class=""><li id="b71c" class="mp mq it kk b kl km ko kp kr mr kv ms kz mt ld nt mv mw mx bi translated">训练过程是这样的，用我们拥有的语料库的大小(单词*维度)创建一个空的嵌入矩阵。</li><li id="16c1" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld nt mv mw mx bi translated">获取谷歌新闻预训练嵌入中存在的词的向量/嵌入，未知词被零初始化。</li><li id="bf95" class="mp mq it kk b kl my ko mz kr na kv nb kz nc ld nt mv mw mx bi translated">现在，神经网络被训练，单词的嵌入或同现随着上下文更新(当添加 LSTM 时)。</li></ol><p id="4aec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">模型摘要:</p><figure class="me mf mg mh gt mi"><div class="bz fp l di"><div class="of og l"/></div><p class="np nq gj gh gi nr ns bd b be z dk translated">模型摘要</p></figure><p id="d59b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">训练精度:</p><figure class="me mf mg mh gt mi"><div class="bz fp l di"><div class="of og l"/></div><p class="np nq gj gh gi nr ns bd b be z dk translated">模型训练历史</p></figure><p id="d910" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用下面的混淆矩阵可以达到 98%的准确度:</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/4648ca99d623f25cc0a6aeae14864cb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*d2mtvJGEnKAYe_m02K3Ajg.png"/></div></figure><p id="bb71" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">演示视频</strong>:</p><figure class="me mf mg mh gt mi"><div class="bz fp l di"><div class="oi og l"/></div></figure><h2 id="ee6b" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">对转发消息的模型的进一步测试:</h2><blockquote class="oj ok ol"><p id="4b3a" class="ki kj om kk b kl km ju kn ko kp jx kq on ks kt ku oo kw kx ky op la lb lc ld im bi translated"><strong class="kk iu">训练消息</strong> : <em class="it">声明:Whatsapp 上正在流传一份所谓的 3 周 5 阶段“路线图”，据称是由政府制定的，旨在放松#COVID19India 限制。</em></p><p id="1b58" class="ki kj om kk b kl km ju kn ko kp jx kq on ks kt ku oo kw kx ky op la lb lc ld im bi translated"><strong class="kk iu"> Whatsapp 转发消息</strong> : <em class="it">放松新冠肺炎限制的政府路线图将进行为期 3 周的审核流程，当前阶段将于以下日期开始:第 1 阶段–5 月 18 日第 2 阶段–6 月 8 日第 3 阶段–6 月 29 日第 4 阶段–7 月 20 日第 5 阶段–8 月 10 日如果冠状病毒病例开始增加，我们将恢复到前一阶段设定的限制</em></p><p id="cf54" class="ki kj om kk b kl km ju kn ko kp jx kq on ks kt ku oo kw kx ky op la lb lc ld im bi translated"><strong class="kk iu">训练信息</strong> : <em class="it">声明:一名#WhatsApp 转发者称，从周六开始，孟买将进行为期 10 天的军事封锁</em></p><p id="d5f4" class="ki kj om kk b kl km ju kn ko kp jx kq on ks kt ku oo kw kx ky op la lb lc ld im bi translated"><strong class="kk iu"> Whatsapp 转发消息</strong> : <em class="it">从周六起整个孟买军事封锁 10 天，请储备所有物品，只有牛奶和药品可用</em></p></blockquote><p id="57c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="om">结论</em> </strong>:我们能够成功检测出一条用不同语法和短语编写的 Whatsapp 转发消息</p><p id="a755" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读，如果你喜欢这篇文章，请鼓掌。</p><p id="ee58" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">页（page 的缩写）关于程序代码，请参考我的笔记本。</p></div></div>    
</body>
</html>