<html>
<head>
<title>Silhouette Coefficient</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">轮廓系数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/silhouette-coefficient-validating-clustering-techniques-e976bb81d10c?source=collection_archive---------0-----------------------#2020-05-26">https://towardsdatascience.com/silhouette-coefficient-validating-clustering-techniques-e976bb81d10c?source=collection_archive---------0-----------------------#2020-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b004" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">验证聚类技术</h2></div><p id="7174" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在学习和应用了一些有监督的最大似然算法后，如最小二乘回归、逻辑回归、SVM、决策树等。我们大多数人都试图通过实现一些聚类技术，如K-Means、DBSCAN或HDBSCAN，来进行一些实际操作的无监督学习。</p><p id="e628" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通常从K-Means聚类开始。经过几个教程和中等故事，你将能够轻松实现k-means聚类。但是当你实现它的时候，一个问题开始困扰你:我们如何测量它的适合度？监督算法有许多指标来检查它们的拟合优度，如准确性、r平方值、灵敏度、特异性等。但是，我们可以计算什么来衡量我们的聚类技术的准确性或良好性呢？这个问题的答案是剪影系数或者剪影分数。</p><h1 id="6553" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated"><strong class="ak">轮廓系数:</strong></h1><p id="c0a1" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">轮廓系数或轮廓分数是用于计算聚类技术的良好性的度量。它的值范围从-1到1。</p><p id="f9df" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">1:表示聚类彼此相距很远，并且可以清楚地区分。</p><p id="f892" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">0:表示聚类无关紧要，或者我们可以说聚类之间的距离不显著。</p><p id="5fab" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">-1:表示以错误的方式分配簇。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi ly"><img src="../Images/742ff37558a86da183d509f55df619b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cUcY9jSBHFMqCmX-fp8BvQ.jpeg"/></div></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">作者图片</p></figure><p id="15b2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">剪影得分= (b-a)/max(a，b)</p><p id="cf56" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在哪里</p><p id="d796" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">a=平均类内距离，即类内各点之间的平均距离。</p><p id="c1ff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">b=平均聚类间距离，即所有聚类之间的平均距离。</p><h1 id="84f1" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">计算轮廓分数</h1><p id="2723" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated"><strong class="kh ir">导入库:</strong></p><pre class="lz ma mb mc gt mo mp mq mr aw ms bi"><span id="d703" class="mt lc iq mp b gy mu mv l mw mx">import pandas as pd<br/>import numpy as np<br/>import seaborn as sns<br/>from sklearn.cluster import KMeans<br/>from sklearn.metrics import silhouette_score<br/>%matplotlib inline</span></pre><p id="f52b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">生成一些随机数据:</strong></p><p id="1c56" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了运行聚类算法，我们生成100个随机点。</p><pre class="lz ma mb mc gt mo mp mq mr aw ms bi"><span id="8687" class="mt lc iq mp b gy mu mv l mw mx">X= np.random.rand(50,2)<br/>Y= 2 + np.random.rand(50,2)<br/>Z= np.concatenate((X,Y))<br/>Z=pd.DataFrame(Z) #converting into data frame for ease</span></pre><p id="8aed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">绘制数据:</p><pre class="lz ma mb mc gt mo mp mq mr aw ms bi"><span id="2e63" class="mt lc iq mp b gy mu mv l mw mx">sns.scatterplot(Z[0],Z[1])</span></pre><p id="4b46" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输出</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi my"><img src="../Images/5fd2837769954866b55e53cb70410e04.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*SjBloBHPhuoTooo4TmfHTw.png"/></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">作者图片</p></figure><p id="1b07" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">对两个聚类应用KMeans聚类:</strong></p><pre class="lz ma mb mc gt mo mp mq mr aw ms bi"><span id="0c6e" class="mt lc iq mp b gy mu mv l mw mx">KMean= KMeans(n_clusters=2)<br/>KMean.fit(Z)<br/>label=KMean.predict(Z)</span></pre><p id="c29f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">计算剪影分数:</strong></p><pre class="lz ma mb mc gt mo mp mq mr aw ms bi"><span id="c64e" class="mt lc iq mp b gy mu mv l mw mx">print(f'Silhouette Score(n=2): {silhouette_score(Z, label)}')</span></pre><p id="2778" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输出:剪影分数(n = 2):0.8062615881652</p><p id="7b51" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以说，当轮廓分数接近1时，聚类彼此相距很远。</p><p id="48c6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了检查我们的轮廓分数是否提供了正确的信息，让我们创建另一个散点图，显示带标签的数据点。</p><pre class="lz ma mb mc gt mo mp mq mr aw ms bi"><span id="717b" class="mt lc iq mp b gy mu mv l mw mx">sns.scatterplot(Z[0],Z[1],hue=label)</span></pre><p id="c383" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输出:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi my"><img src="../Images/d023923756b0085c3e5f8cdbb6b22ac7.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*xf3EaUXEubY6JTau54oRaw.png"/></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">作者图片</p></figure><p id="bb6f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从上图中可以清楚地看到，每个集群彼此相距很远。</p><p id="bf92" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们尝试3个集群:</p><pre class="lz ma mb mc gt mo mp mq mr aw ms bi"><span id="9638" class="mt lc iq mp b gy mu mv l mw mx">KMean= KMeans(n_clusters=3)<br/>KMean.fit(Z)<br/>label=KMean.predict(Z)<br/>print(f’Silhouette Score(n=3): {silhouette_score(Z, label)}’)<br/>sns.scatterplot(Z[0],Z[1],hue=label,palette=’inferno_r’)<br/></span></pre><p id="ba27" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输出:</p><p id="0a75" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">侧影分数(n = 3):0.5468638636786</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi my"><img src="../Images/cd472b62ddc2c8004de2135d812066ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*YGNuS5oo72H2t46coXXPfg.png"/></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">作者图片</p></figure><p id="7c5a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如你在上面的图中看到的，集群没有很好的分开。簇1和簇2之间的簇间距离几乎可以忽略。这就是为什么n= 3的剪影分数(0.596)小于n=2的剪影分数(0.806)。</p><p id="1902" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当处理更高维度时，轮廓分数对于验证聚类算法的工作非常有用，因为当维度大于3时，我们不能使用任何类型的可视化来验证聚类。</p><p id="8a46" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以使用轮廓分数来检查最佳聚类数。在上面的例子中，我们可以说最佳聚类数是2，因为它的轮廓得分大于3个聚类的得分。</p></div></div>    
</body>
</html>