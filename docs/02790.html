<html>
<head>
<title>Exploring built-in Jupyter Notebooks in Azure Cosmos DB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索Azure Cosmos DB中的内置Jupyter笔记本</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/exploring-built-in-jupyter-notebooks-in-azure-cosmos-db-c9ffdb0273d5?source=collection_archive---------34-----------------------#2020-03-17">https://towardsdatascience.com/exploring-built-in-jupyter-notebooks-in-azure-cosmos-db-c9ffdb0273d5?source=collection_archive---------34-----------------------#2020-03-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="06ca" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">快速介绍如何使用内置的Jupyter笔记本探索Azure Cosmos DB数据</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/aa0f6a113f1be869e94cbc50e19ffcd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4CGnDBRBd6rZrMLJmF5VBw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://devblogs.microsoft.com/cosmosdb/wp-content/uploads/sites/52/2019/10/FeaturedDefault.png" rel="noopener ugc nofollow" target="_blank"> Azure Cosmos DB Logo来源</a>。<a class="ae kv" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fcommons.wikimedia.org%2Fwiki%2FFile%3AJupyter_logo.svg&amp;psig=AOvVaw2l-XIzfRaf1vDUblOzWmGX&amp;ust=1584563383176000&amp;source=images&amp;cd=vfe&amp;ved=0CAIQjRxqFwoTCKCaz96sougCFQAAAAAdAAAAABAD" rel="noopener ugc nofollow" target="_blank"> Jupter标志来源</a></p></figure><p id="8fbe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">【2019年5月，Cosmos DB团队公布了在Cosmos DB账户内运行Jupyter笔记本的预览。该功能于2019年9月公开发布，适用于所有的Cosmos DB API。有了这个功能，我们可以使用Jupyter笔记本来运行交互式查询，探索我们的数据和可视化我们的数据。我们甚至可以在Cosmos DB中的数据上建立机器学习模型！</p><p id="a488" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">我能从中得到什么？</strong></p><p id="edb4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的Cosmos DB帐户中拥有Jupyter笔记本电脑会给我们带来很多好处。其中包括:</p><ul class=""><li id="163b" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">我们可以在我们的Cosmos DB数据上生成很酷的数据可视化。</li><li id="2a9a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">在我们的笔记本中更轻松地共享代码。有没有尝试过在GitHub中分享Jupyter笔记本代码中的代码？这是可行的，但是通过在Cosmos DB中使用笔记本，它更具交互性，我们可以在Azure门户中显示结果。</li><li id="4b40" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">我们的代码更具交互性，我们可以在笔记本中嵌入用户控件</li><li id="d735" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">我们可以在一个文档中组合不同类型的文档、文本、图像、动画等。</li><li id="e2bd" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">我们可以在笔记本上执行神奇的宇宙命令！稍后会详细介绍。</li></ul><p id="54fe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">听起来很酷，怎么才能得到这个功能？</strong></p><p id="8835" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个新的支持笔记本的Azure Cosmos DB帐户非常简单:</p><p id="c828" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在Azure门户中，点击<strong class="ky ir">创建资源</strong>并选择<strong class="ky ir"> Azure Cosmos DB。</strong>在<strong class="ky ir">创建Azure Cosmos DB帐户中，</strong>确保您选择了<strong class="ky ir">笔记本。</strong>点击<strong class="ky ir">审核+创建</strong>，然后点击<strong class="ky ir">创建。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mg"><img src="../Images/2883bd0c51b11afcb4ca9393770b3eb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SYvNl5iR-nrqAX28AAS_Eg.png"/></div></div></figure><p id="4632" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建帐户后，您将在<strong class="ky ir">数据浏览器</strong>窗格中找到您的笔记本工作区。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mh"><img src="../Images/6d0776d5fe78a87aaaf2a1f5d0e678ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NouEfdcCdqSYHXdfMZxfTA.png"/></div></div></figure><p id="9f20" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是我已经有一个Cosmos DB帐户了！要使用笔记本电脑，我必须销毁现有的笔记本吗？</p><p id="b1b0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一点也不！您可以通过执行以下操作来启用笔记本功能:</p><p id="b165" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">进入你的Cosmos DB账户的<strong class="ky ir">数据浏览器</strong>面板，选择<strong class="ky ir">启用笔记本。</strong>点击<strong class="ky ir">完成设置</strong>，您的账户将可以使用笔记本！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mi"><img src="../Images/d2cb3fa3421db0b09fea4d39be55efd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4uJYHDozgIFaX-T4R9HuVA.png"/></div></div></figure><p id="3e66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好了，我都准备好了！给我演示一下！</p><p id="88e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们的Cosmos DB帐户中已经有了笔记本，让我们开始使用它吧！我已经在我的Cosmos DB帐户中创建了一个容器，并按照这个演示<a class="ae kv" href="https://cosmosdb.github.io/labs/dotnet/labs/01-creating_partitioned_collection.html#populate-a-container-with-items-using-the-sdk" rel="noopener ugc nofollow" target="_blank">使用数据填充它。(这个演示是由Cosmos DB工程团队提供的一系列演示，如果您想深入了解Cosmos DB的所有内容，我强烈推荐它！).</a></p><p id="0c1f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以在我们的Jupyter笔记本上安装新的软件包，就像其他笔记本一样。让我们通过输入以下命令来安装Pandas:</p><pre class="kg kh ki kj gt mj mk ml mm aw mn bi"><span id="da19" class="mo mp iq mk b gy mq mr l ms mt">import pandas as pd</span></pre><p id="781d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">点击运行，很快，我们就可以在笔记本上使用熊猫了。现在让我们使用这些宇宙命令中的一个来创建一个我们可以使用的熊猫数据框架。我有一个名为<strong class="ky ir"> CustomCollection </strong>的集合，它是由<strong class="ky ir"> /type </strong>划分的。我想创建一个DataFrame来处理我的所有类型为<strong class="ky ir"> PurchaseFoodOrBeverage </strong>的项目。我们可以通过执行以下命令来做到这一点:</p><pre class="kg kh ki kj gt mj mk ml mm aw mn bi"><span id="3947" class="mo mp iq mk b gy mq mr l ms mt">%%sql --database EntertainmentDatabase --container CustomCollection --output df_foodOrBeverage<br/>SELECT c.id, c.unitPrice, c.totalPrice, c.quantity, c.type FROM c WHERE c.type = "PurchaseFoodOrBeverage"</span></pre><p id="02cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个查询中，我只选择了我们的POCO属性。SELECT *还将包括Cosmos DB系统生成的属性，所以我现在将它们排除在外。我们现在可以通过执行以下命令来查看我们的数据帧:</p><pre class="kg kh ki kj gt mj mk ml mm aw mn bi"><span id="5eab" class="mo mp iq mk b gy mq mr l ms mt">df_foodOrBeverage.head(10)</span></pre><p id="0cc3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在应该看到以下结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/eb40a8f84fbca1df5c3a2cd862c9f255.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0rQEsKfNzLe1mVi8YJktkQ.png"/></div></div></figure><p id="a9c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们通过可视化来结束这个快速演示。键入以下命令:</p><pre class="kg kh ki kj gt mj mk ml mm aw mn bi"><span id="d795" class="mo mp iq mk b gy mq mr l ms mt">pd.options.display.html.table_schema = True<br/>pd.options.display.max_rows = None</span><span id="7064" class="mo mp iq mk b gy mv mr l ms mt">df_foodOrBeverage.groupby("quantity").size()</span></pre><p id="2470" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将产生一个nteract数据浏览器。这使我们能够过滤和可视化我们的数据框架。我们只需将table_schema设置为True，将max_rows设置为我们想要的值，或者设置为None以显示所有结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/bbc963eab9987fa6d95982b23d4d1765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eFZVH6ix3x952HSTRmIBnw.png"/></div></div></figure><p id="19cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以用笔记本做很多事情，比如使用内置的Python SDK for Cosmos DB，并将JSON文件上传到特定的Cosmos DB容器。查看<a class="ae kv" href="https://docs.microsoft.com/en-us/azure/cosmos-db/use-notebook-features-and-commands#use-built-in-nteract-data-explorer" rel="noopener ugc nofollow" target="_blank">文档</a>以了解我们可以在Jupyter笔记本上为Cosmos DB做的所有事情！</p><p id="3187" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">结论</strong></p><p id="e65c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望你现在对在Cosmos DB Jupyter笔记本上可以做什么有了一个基本的概念。如果你有什么问题，欢迎在评论中提问！</p></div></div>    
</body>
</html>