<html>
<head>
<title>Seaborn FacetGrid: Taking Subplots Further</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Seaborn FacetGrid:进一步发展支线剧情</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/seaborn-facetgrid-taking-subplots-further-15ee7af54e44?source=collection_archive---------7-----------------------#2020-08-08">https://towardsdatascience.com/seaborn-facetgrid-taking-subplots-further-15ee7af54e44?source=collection_archive---------7-----------------------#2020-08-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e389" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">循序渐进的教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/aa5571fb2e15759da033b200ff7e28fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*60jL5_4-MRnxgGtQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马库斯·斯皮斯克在<a class="ae ky" href="https://unsplash.com/s/photos/different-colors?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="e066" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据可视化在数据分析中至关重要。“一张图片胜过千言万语”这句名言同样适用于数据可视化领域。在这篇文章中，我将解释一个结构良好、信息量很大的支线剧情集:<strong class="lb iu">、FacetGrid </strong>。</p><p id="a1b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> FacetGrid </strong>基本上就是支线剧情的网格。Matplotlib 支持创建具有多个轴的图形，因此允许在一个图形中有子图形。FacetGrid 在 matplotlib 的子情节结构上放了什么:</p><ul class=""><li id="905f" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">使过程更容易、更流畅(用更少的代码)</li><li id="238e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">将数据集的结构转移到子情节</li></ul><p id="3bee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用 FacetGrids 可以很容易地发现变量的分布或变量之间的关系。它们最多可以有三个维度:<strong class="lb iu">行</strong>、<strong class="lb iu">列</strong>和<strong class="lb iu">色调</strong>。通过例子，我们会更清楚。那么，我们开始吧。</p><p id="884c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">像往常一样，我们从导入库开始。</p><blockquote class="mj mk ml"><p id="ea4c" class="kz la mm lb b lc ld ju le lf lg jx lh mn lj lk ll mo ln lo lp mp lr ls lt lu im bi translated"><strong class="lb iu">注意</strong> : FacetGrid 需要存储在 pandas 数据帧中的数据，其中每行代表一个观察值，列代表变量。因此，我们也进口熊猫。</p></blockquote><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="5b72" class="mv mw it mr b gy mx my l mz na">import numpy as np<br/>import pandas as pd</span><span id="cbda" class="mv mw it mr b gy nb my l mz na">import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>sns.set(style='darkgrid', color_codes=True)</span><span id="859d" class="mv mw it mr b gy nb my l mz na">%matplotlib inline</span></pre><p id="31ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用 seaborn 的内置“tips”数据集。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="8284" class="mv mw it mr b gy mx my l mz na">tip = sns.load_dataset("tips")<br/>tip.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/0cf91dc7a76381b3f4eeebe9bb4d7898.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*_73M2TkiEMfP_rJCJCk6Ig.png"/></div></figure><p id="488d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">FacetGrid 对象通过传递数据帧和变量名来初始化，以创建轴的结构。用于初始化 FacetGrid 对象的变量需要是<strong class="lb iu">分类的</strong>或<strong class="lb iu">离散的</strong>。根据类别的数量创建网格结构。例如，“时间”列有两个唯一的值。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="d9ac" class="mv mw it mr b gy mx my l mz na">tip['time'].value_counts()<br/>Dinner    176 <br/>Lunch      68 <br/>Name: time, dtype: int64</span></pre><p id="c062" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们通过将“时间”变量传递给<strong class="lb iu">列</strong>参数来初始化 FacetGrid 对象。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="1cf1" class="mv mw it mr b gy mx my l mz na">g = sns.FacetGrid(tip, col='time')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/9b689c06f674c571852bff75d5c6cd25.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*J8d_B6CUV0uJJCPnXEKZkg.png"/></div></figure><p id="33e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们刚刚创建了一个非常简单的包含两个方面的网格(每个子情节都是一个方面)。使用<strong class="lb iu">高度</strong>和<strong class="lb iu">纵横比</strong>参数调整刻面的尺寸。</p><ul class=""><li id="bc63" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">高度是刻面的高度，单位为英寸</li><li id="dd8c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">纵横比是宽度和高度的比值(宽度=纵横比*高度)。坡向的默认值为 1。</li></ul><p id="7ea6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用更大的面来更新网格。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="4dad" class="mv mw it mr b gy mx my l mz na">g = sns.FacetGrid(tip, col='time', height=5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/53b3265545eab3d35e4cf2faeb0efa28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dVbE1eNW6em5W2yWYIUnUA.png"/></div></div></figure><p id="64b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是时候使用<strong class="lb iu"> FacetGrid.map() </strong>方法在网格上绘制数据了。它需要一个绘图函数和变量作为参数进行绘图。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="0e8a" class="mv mw it mr b gy mx my l mz na">g = sns.FacetGrid(tip, col='time', height=5)<br/>g.map(plt.hist, "total_bill")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/815afc78fb7f6b057be93d60aa44095a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s_BaIq4jKwTHw0BGIxG1yg.png"/></div></div></figure><p id="120c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">网格显示基于“时间”的“总账单”直方图。根据绘图函数的不同，我们可能需要为 map 方法传递多个变量。例如，散点图需要两个变量。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="913b" class="mv mw it mr b gy mx my l mz na">g = sns.FacetGrid(tip, col='time', height=5)<br/>g.map(plt.scatter, "total_bill", "tip")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/aee64463d283468f7350a728575e2a27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eUHKXVfYE_vS58yzEuxpcw.png"/></div></div></figure><p id="0316" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用<strong class="lb iu">行</strong>参数给网格增加一个维度。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="27d2" class="mv mw it mr b gy mx my l mz na">g = sns.FacetGrid(tip, row='sex', col='time', height=4)<br/>g.map(plt.scatter, "total_bill", "tip")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/fce752b47819813ebb0816b7d9e44195.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*9JEtGNXo_uXnMmwz54_CaQ.png"/></div></figure><p id="fcc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“性别”和“时间”列都有两个不同的值，因此创建了一个 2x2 FacetGrid。从上图中我们可以看出，男性和女性的“总账单”和“小费”变量具有相似的趋势。</p><p id="431c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">色调</strong>参数允许用颜色给网格增加一个维度。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="ee41" class="mv mw it mr b gy mx my l mz na">g = sns.FacetGrid(tip, row='sex', col='time', hue='smoker',    <br/>                  height=4)<br/>g.map(plt.scatter, "total_bill", "tip")<br/>g.add_legend()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/a812ca9786a3dad3b12d11eb23ebe326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*SyfU30-t0zwmlnj1d2As0w.png"/></div></figure><p id="0fa9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在对“总账单”、“小费”和“吸烟者”变量之间的关系有了一个概述。</p><p id="38b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“日”列有 4 个唯一值:</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="2f71" class="mv mw it mr b gy mx my l mz na">tip.day.value_counts()<br/>Sat     87 <br/>Sun     76 <br/>Thur    62 <br/>Fri     19 <br/>Name: day, dtype: int64</span></pre><p id="42ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以创建一个 FacetGrid，显示“total_bill”在不同日子的分布情况。它会显示顾客是否在某一天花费更多。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="e40d" class="mv mw it mr b gy mx my l mz na">g = sns.FacetGrid(tip, row='day', <br/>                  row_order = tip.day.value_counts().index,<br/>                  height=1.5, aspect=4)</span><span id="2eea" class="mv mw it mr b gy nb my l mz na">g.map(sns.distplot, "total_bill", hist=False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/141f083fc42067b374976c7b73e9fb8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*gX2vsHb5LxbyWbw-rE8Vzg.png"/></div></figure><p id="c8d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">似乎人们倾向于在周末多花一点钱。我们在该图中使用了<strong class="lb iu">行顺序</strong>参数。顾名思义，它决定了刻面的顺序。在前面的绘图中，我们使用了 matplotlib.pyplot 接口中的绘图函数。但是，对于最后一个，我们使用了 seaborn 包中的绘图功能。这是 FacetGrid 的一个很好的特性，提供了额外的灵活性。</p><p id="246e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了丰富 FacetGrids 的功能和外观，可以在 facet grids 上添加更多的特性。如果你想更深入，我建议在 FacetGrid 上查看 seaborn 文档。</p><p id="da63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p><h1 id="2153" class="ni mw it bd nj nk nl nm nn no np nq nr jz ns ka nt kc nu kd nv kf nw kg nx ny bi translated"><strong class="ak">参考文献</strong></h1><ul class=""><li id="4c1c" class="lv lw it lb b lc nz lf oa li ob lm oc lq od lu ma mb mc md bi translated"><a class="ae ky" href="https://seaborn.pydata.org/generated/seaborn.FacetGrid.html" rel="noopener ugc nofollow" target="_blank">https://seaborn.pydata.org/generated/seaborn.FacetGrid.html</a></li><li id="c9c8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="https://seaborn.pydata.org/tutorial/axis_grids.html#grid-tutorial" rel="noopener ugc nofollow" target="_blank">https://seaborn . pydata . org/tutorial/axis _ grids . html # grid-tutorial</a></li></ul></div></div>    
</body>
</html>