<html>
<head>
<title>Real-Time Face Mask Detector with TensorFlow, Keras, and OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用TensorFlow、Keras和OpenCV的实时人脸检测器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/real-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64?source=collection_archive---------13-----------------------#2020-05-25">https://towardsdatascience.com/real-time-face-mask-detector-with-tensorflow-keras-and-opencv-38b552660b64?source=collection_archive---------13-----------------------#2020-05-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ec17" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何使用Tensorflow、Keras和OpenCV以及您的网络摄像头或移动摄像头创建实时面具检测器</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0d3ff4fdc8463cc7566fe475eaa49a6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4-Spy9WR53UutpmzqqygMA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@macauphotoagency?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">澳门图片社</a>在<a class="ae ky" href="https://unsplash.com/s/photos/coronavirus?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3eaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将使用由<a class="ae ky" href="https://www.linkedin.com/feed/update/urn%3Ali%3Aactivity%3A6655711815361761280/" rel="noopener ugc nofollow" target="_blank"> Prajna Bhandary </a>创建的面具数据集。该数据集由属于<code class="fe lv lw lx ly b">with mask</code>和<code class="fe lv lw lx ly b">without mask</code> 2类的1376幅图像组成。</p><p id="23a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的主要焦点是检测一个人是否戴着面具，而不需要靠近他们。</p><h1 id="e179" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">概观</h1><p id="d1c9" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">简而言之，首先，我们获得带有人脸的图像，并将其通过级联分类器。分类器将给出面部的感兴趣区域(高度和宽度)。其次，我们将把感兴趣区域的大小调整为一个<code class="fe lv lw lx ly b">100x100</code>，并将其传递给预先训练好的CNN，它将把概率作为输出给我们。</p><h2 id="0035" class="mw ma it bd mb mx my dn mf mz na dp mj li nb nc ml lm nd ne mn lq nf ng mp nh bi translated">步骤1:数据预处理</h2><p id="eba0" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">我们使用的数据集由不同颜色、不同大小和不同方向的图像组成。因此，我们需要将所有图像转换为灰度，因为我们需要确保颜色不应该成为检测蒙版的临界点。之后，我们需要在将它应用到神经网络之前，使所有的图像都具有相同的大小(<code class="fe lv lw lx ly b">100x100</code>)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据预处理</p></figure><h2 id="54d0" class="mw ma it bd mb mx my dn mf mz na dp mj li nb nc ml lm nd ne mn lq nf ng mp nh bi translated">第二步:训练CNN</h2><p id="067c" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">这包括2个卷积层(两个Convo2D 100 @ 3x3)。首先，您必须从数据预处理加载数据集。然后你必须配置卷积架构。我已经包括了一个<code class="fe lv lw lx ly b">model.add(Dropout(0.5))</code>来消除过度拟合。由于我们有两个类别(带面具和不带面具)，我们可以使用<code class="fe lv lw lx ly b">binary_crossentropy</code>。你从一个模型关卡开始训练20个纪元。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">训练CNN</p></figure><p id="17ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请记住，您可以使用更多的卷积层或使用外部训练器，如<a class="ae ky" href="https://arxiv.org/abs/1801.04381" rel="noopener ugc nofollow" target="_blank"> MobileNetV2 </a>以获得更好的准确性。</p><p id="71de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以绘制图表来做出更好的验证决策。我已经把它放在我的知识库里了。请参考。</p><h2 id="df88" class="mw ma it bd mb mx my dn mf mz na dp mj li nb nc ml lm nd ne mn lq nf ng mp nh bi translated">步骤3:检测戴面具和不带面具的人脸</h2><p id="5919" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">首先，您必须加载我们创建的模型。然后我们把想要的相机设置为默认。</p><blockquote class="nk nl nm"><p id="76d5" class="kz la nn lb b lc ld ju le lf lg jx lh no lj lk ll np ln lo lp nq lr ls lt lu im bi translated">可选—您可以将手机摄像头(Android/IOS)连接到OpenCV。为您的手机和PC下载<a class="ae ky" href="https://www.dev47apps.com/" rel="noopener ugc nofollow" target="_blank"> DroidCam </a>应用程序。并更改代码<code class="fe lv lw lx ly b"><em class="it">source = cv2.VideoCapture(1)</em></code></p></blockquote><p id="2f25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其次，我们需要标注两个概率(0代表<code class="fe lv lw lx ly b">with_mask</code>，1代表<code class="fe lv lw lx ly b">without_mask</code>)。之后，我们需要使用RGB值设置边框颜色。我给了红色和绿色两种颜色。</p><p id="36f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在一个无限循环中，我们将从相机中一帧一帧地读取，并将它们转换成灰度并检测人脸。并且它将通过一个<code class="fe lv lw lx ly b">for</code>循环来运行，以针对每张脸检测感兴趣的区域，调整其大小并将其重塑为4D，因为训练网络期望4D输入。对于模型，我们将使用可用的最佳模型来获得结果。这个结果由带面具或不带面具的概率(<code class="fe lv lw lx ly b">result=[P1, P2]</code>)组成。之后会贴上标签。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">检测遮罩</p></figure><p id="cd3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看演示，</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/8473105a904538a5f76bd561562e43a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*G4ZGve1h5o9o6kn5sWvnyA.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">演示</p></figure><div class="ns nt gp gr nu nv"><a href="https://drive.google.com/open?id=1oLIPBOkCuhej-iNTre_qnlQ3b-fWZeEy" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">面具检测器-谷歌驱动</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">编辑描述</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">drive.google.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj ks nv"/></div></div></a></div><div class="ns nt gp gr nu nv"><a href="https://github.com/ravindu9701/Face-Mask-Detector.git" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">ravindu 9701/面罩检测器</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">在GitHub上创建一个帐户，为ravindu 9701/面罩探测器的开发做出贡献。</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">github.com</p></div></div><div class="oe l"><div class="ok l og oh oi oe oj ks nv"/></div></div></a></div></div><div class="ab cl ol om hx on" role="separator"><span class="oo bw bk op oq or"/><span class="oo bw bk op oq or"/><span class="oo bw bk op oq"/></div><div class="im in io ip iq"><h1 id="065d" class="lz ma it bd mb mc os me mf mg ot mi mj jz ou ka ml kc ov kd mn kf ow kg mp mq bi translated">结论</h1><p id="68cf" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li mt lk ll lm mu lo lp lq mv ls lt lu im bi translated">如果使用MobileNetV2进行微调，可以提高精确度。我们也可以将这个模型部署到嵌入式系统中。如果我们正确部署它，我们可以帮助确保您和他人的安全。</p><p id="9840" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">文章到此为止。希望对某个人有用。谢谢，注意安全！</p><h2 id="9a7f" class="mw ma it bd mb mx my dn mf mz na dp mj li nb nc ml lm nd ne mn lq nf ng mp nh bi translated">资源</h2><ul class=""><li id="44af" class="ox oy it lb b lc mr lf ms li oz lm pa lq pb lu pc pd pe pf bi translated"><a class="ae ky" href="https://github.com/prajnasb/observations/tree/master/mask_classifier/Data_Generator" rel="noopener ugc nofollow" target="_blank">般若的Github回购</a></li><li id="9386" class="ox oy it lb b lc pg lf ph li pi lm pj lq pk lu pc pd pe pf bi translated"><a class="ae ky" href="https://www.pyimagesearch.com/2020/05/04/covid-19-face-mask-detector-with-opencv-keras-tensorflow-and-deep-learning/" rel="noopener ugc nofollow" target="_blank">阿德里安·罗斯布鲁克的文章</a></li></ul></div></div>    
</body>
</html>