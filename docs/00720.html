<html>
<head>
<title>Analyzing the Next Decade of Earth Close-Approaching Objects with nasapy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 nasapy 分析未来十年的近地天体</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyzing-the-next-decade-of-earth-close-approaching-objects-with-nasapy-8a6194c4a493?source=collection_archive---------40-----------------------#2020-01-20">https://towardsdatascience.com/analyzing-the-next-decade-of-earth-close-approaching-objects-with-nasapy-8a6194c4a493?source=collection_archive---------40-----------------------#2020-01-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5b24c439be1851047cf398aa0515de48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yvVb5qLD3Nm_qsClqcZR4A.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">昆廷·凯梅尔在<a class="ae kc" href="https://unsplash.com/s/photos/meteor?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="3272" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个例子中，我们将通过提取美国宇航局喷气推进实验室的小天体数据库确定的未来 10 年接近地球的物体，来遍历<code class="fe lb lc ld le b">nasapy</code>库的一个可能的用例。</p><p id="4dc2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在开始之前，导入我们将用来提取和分析数据的包。数据分析库<a class="ae kc" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>将用于获取数据，而<a class="ae kc" href="https://seaborn.pydata.org/" rel="noopener ugc nofollow" target="_blank"> seaborn </a>用于绘制数据。加载神奇命令<code class="fe lb lc ld le b"><a class="ae kc" href="https://ipython.readthedocs.io/en/stable/interactive/plotting.html#id1" rel="noopener ugc nofollow" target="_blank">%matplotlib inline</a></code>以显示生成的图形。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="e019" class="ln lo iq le b gy lp lq l lr ls"><strong class="le ir">import</strong> <strong class="le ir">nasapy</strong><br/><strong class="le ir">import</strong> <strong class="le ir">pandas</strong> <strong class="le ir">as</strong> <strong class="le ir">pd</strong><br/><strong class="le ir">import</strong> <strong class="le ir">numpy</strong> <strong class="le ir">as</strong> <strong class="le ir">np</strong><br/><strong class="le ir">import</strong> <strong class="le ir">matplotlib.pyplot</strong> <strong class="le ir">as</strong> <strong class="le ir">plt</strong><br/><strong class="le ir">import</strong> <strong class="le ir">seaborn</strong> <strong class="le ir">as</strong> <strong class="le ir">sns</strong><br/><br/>%<strong class="le ir">matplotlib</strong> inline</span></pre><p id="e1c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">nasapy</code>库的<code class="fe lb lc ld le b">close_approach</code>方法允许人们访问 JPL SBDB 以提取与地球附近已知流星体和小行星相关的数据。设置参数<code class="fe lb lc ld le b">return_df=True</code>会自动将返回的 JSON 数据强制转换成 pandas 数据帧。提取数据后，我们将几个变量转换成<code class="fe lb lc ld le b">float</code>类型。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="81ac" class="ln lo iq le b gy lp lq l lr ls">ca = nasapy.close_approach(date_min='2020-01-01', <br/>date_max='2029-12-31', return_df=<strong class="le ir">True</strong>)<br/><br/>ca['dist'] = ca['dist'].astype(float)<br/>ca['dist_min'] = ca['dist_min'].astype(float)<br/>ca['dist_max'] = ca['dist_max'].astype(float)</span></pre><p id="23ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">返回数据的<code class="fe lb lc ld le b">dist</code>栏以天文单位(AU)描述了物体的标称接近距离。一个<a class="ae kc" href="https://en.wikipedia.org/wiki/Astronomical_unit" rel="noopener ugc nofollow" target="_blank">天文单位</a>或 AU 大致是地球到太阳的距离，约为 92，955，807 英里或 149，598，000 公里。使用<code class="fe lb lc ld le b"><a class="ae kc" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.describe.html" rel="noopener ugc nofollow" target="_blank">.describe</a></code>方法，我们可以显示总结数据的描述性统计数据。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="fe18" class="ln lo iq le b gy lp lq l lr ls">ca['dist'].describe()</span><span id="262e" class="ln lo iq le b gy lt lq l lr ls">count    729.000000<br/>mean       0.030775<br/>std        0.012718<br/>min        0.000252<br/>25%        0.021520<br/>50%        0.031960<br/>75%        0.041442<br/>max        0.049983<br/>Name: dist, dtype: float64</span></pre><p id="8926" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们看到澳大利亚的平均进近距离约为 0.031，我们可以将其转换为英里数:</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="9edf" class="ln lo iq le b gy lp lq l lr ls">au_miles = 92955807.26743<br/>ca['dist'].describe()['mean'] * au_miles</span><span id="086d" class="ln lo iq le b gy lt lq l lr ls">2860693.219664113</span></pre><p id="fca5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，在未来十年中，接近地球的物体的平均距离约为 286 万英里，是地球到月球距离(238，900 英里)的 10 倍以上。</p><p id="287c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">未来十年内最接近地球的物体会怎样？使用<code class="fe lb lc ld le b"><a class="ae kc" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html" rel="noopener ugc nofollow" target="_blank">.loc</a></code>方法，我们可以找到距离最近的物体。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="5037" class="ln lo iq le b gy lp lq l lr ls">ca.loc[ca['dist'] == ca['dist'].min()]</span></pre><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/f25b1aee2fbaf7b691ddef290b450fc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P2P1rxQ0p-ZXlKszXDXPLw.png"/></div></div></figure><p id="ecaf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最近的已知天体预计将在 2029 年 4 月 13 日接近地球，距离地球 0.00023 天文单位。将天文单位转换成英里，我们可以更好地了解物体的接近距离。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="1574" class="ln lo iq le b gy lp lq l lr ls">print('Distance: ' + str(au_miles * ca['dist'].min()))<br/>print('Minimum Distance: ' + str(au_miles * ca['dist_min'].min()))<br/>print('Maximum Distance: ' + str(au_miles * ca['dist_max'].min()))</span><span id="70cc" class="ln lo iq le b gy lt lq l lr ls">Distance: 23440.92769543333<br/>Minimum Distance: 644.2481158331191<br/>Maximum Distance: 23874.510393069424</span></pre><p id="e30f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我的天啊。看起来这个物体会比较接近地球，大约 23000 英里，在 64423874 英里的范围内。作为比较，最大距离大约是地球到月球距离的 1/10。</p><p id="19a0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们对未来十年每年接近地球的物体数量有个大概的了解。首先，我们使用<code class="fe lb lc ld le b"><a class="ae kc" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.apply.html" rel="noopener ugc nofollow" target="_blank">.apply</a></code>和<code class="fe lb lc ld le b"><a class="ae kc" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.to_datetime.html" rel="noopener ugc nofollow" target="_blank">to_datetime</a></code>的组合将临近日期的年份提取到一个新列<code class="fe lb lc ld le b">approach_year</code>中。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="ddfa" class="ln lo iq le b gy lp lq l lr ls">ca['approach_year'] = ca['cd'].apply(<strong class="le ir">lambda</strong> x: pd.to_datetime(x).year)</span></pre><p id="4478" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<code class="fe lb lc ld le b"><a class="ae kc" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html" rel="noopener ugc nofollow" target="_blank">.groupby</a></code>方法，我们创建一个新的数据帧，其中包含每年接近物体的总数。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="9e91" class="ln lo iq le b gy lp lq l lr ls">approaches_by_year = ca.groupby('approach_year').count().reset_index()</span></pre><p id="6e06" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用 seaborn 的<a class="ae kc" href="https://seaborn.pydata.org/generated/seaborn.barplot.html" rel="noopener ugc nofollow" target="_blank">柱状图</a>函数来绘制每年接近物体的数量。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="597a" class="ln lo iq le b gy lp lq l lr ls">plt.figure(figsize=(10, 6))<br/>p = sns.barplot(x='approach_year', y='h', data=approaches_by_year)<br/>plt.axhline(approaches_by_year['h'].mean(), color='r', linestyle='--')<br/>p = p.set_xticklabels(approaches_by_year['approach_year'], rotation=45, ha='right', fontsize=12)</span></pre><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/569404dc53adbad6f01db6a2b2789d9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*wqy85ts2PBsqtaXWg4B3uA.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">每年接近地球的物体数量</p></figure><p id="8493" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有趣的是，今年(2020 年)将有最多的活动，然后在接下来的几年里会有所下降，直到十年结束。平均来说，这十年中每年有不到 80 个接近地球的物体。</p><p id="a32a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为最后一个例子，让我们使用 seaborn 的<code class="fe lb lc ld le b"><a class="ae kc" href="https://seaborn.pydata.org/generated/seaborn.kdeplot.html" rel="noopener ugc nofollow" target="_blank">.kdeplot</a></code>绘制接近物体距离的分布，它创建了一个内核命运图。我们也可以像上面那样添加一条距离的中线。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="4c88" class="ln lo iq le b gy lp lq l lr ls">plt.figure(figsize=(14, 6))<br/>plt.axvline(ca['dist'].astype(float).mean(), color='r', linestyle='--')<br/>sns.kdeplot(ca['dist'], shade=<strong class="le ir">True</strong>)</span></pre><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lw"><img src="../Images/638b6f340e8d97224984b22aa22f20cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PXrrfMxDN15B-o3mX5pPXQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">地球近距离物体距离的分布</p></figure><p id="9540" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我们上面提到的，平均接近距离略大于 0.03，我们可以在上面的密度图中看到。最后，我们可以使用<a class="ae kc" href="https://docs.scipy.org/doc/numpy-1.15.0/reference/generated/numpy.random.normal.html" rel="noopener ugc nofollow" target="_blank"> numpy.random.normal </a>绘制距离分布的正态分布图，以快速比较实际分布和正态分布。</p><pre class="lf lg lh li gt lj le lk ll aw lm bi"><span id="b520" class="ln lo iq le b gy lp lq l lr ls">plt.figure(figsize=(14, 6))<br/><br/>x = np.random.normal(size=len(ca['dist']), <br/>                     scale=ca['dist'].std(), <br/>                     loc=ca['dist'].mean())<br/><br/>plt.axvline(ca['dist'].mean(), color='r', linestyle='--')<br/><br/>sns.kdeplot(ca['dist'], shade=<strong class="le ir">True</strong>)<br/>sns.kdeplot(x, shade=<strong class="le ir">True</strong>)</span></pre><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lw"><img src="../Images/f7e6b83bb79242087ab68d954f367342.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FP1FeC_RUdU05qJzqF_y5g.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">与正态分布相比的地球近距离接近物体距离的分布</p></figure><p id="63dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们看到距离的分布不太正常。肯定有更复杂的技术来分析数据集的分布，但这将留到将来可能的练习中。</p></div></div>    
</body>
</html>