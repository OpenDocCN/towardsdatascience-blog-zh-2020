<html>
<head>
<title>Telling stories with Google Trends using Pytrends in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 中的 Pytrends 讲述 Google Trends 的故事</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/telling-stories-with-google-trends-using-pytrends-in-python-a11e5b8a177?source=collection_archive---------11-----------------------#2020-07-28">https://towardsdatascience.com/telling-stories-with-google-trends-using-pytrends-in-python-a11e5b8a177?source=collection_archive---------11-----------------------#2020-07-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="331d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用<em class="kf">谷歌趋势</em> python 库<em class="kf"> Pytrends </em>追踪多个关键词的相对受欢迎程度并发现它们的故事。<em class="kf"> + </em>数据可视化使用<em class="kf"> Tableau </em>。</h2></div><p id="e350" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><em class="lc"> Google Trends </em>从 2006 年开始向公众开放，让他们搜索可以追溯到 2004 年的某些关键词的相对受欢迎程度。从谷歌的数据中，我们可以了解不同国家或地区之间的相对受欢迎程度。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/3d33d2b04173589d61aa7c5f68ae2691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*DuGC7DvPsFqXW0Ft"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated"><a class="ae lt" href="https://unsplash.com/@mitchel3uo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">米切尔·罗</a>在<a class="ae lt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="1e59" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在本教程中，我将分享如何跟踪多个关键词的相对受欢迎程度(我说的是一次几十个，甚至几百个关键词)。</p><p id="6068" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我使用<em class="lc"> Python </em>连接到<em class="lc"> Google Trends API </em>使用<a class="ae lt" href="https://pypi.org/project/pytrends/" rel="noopener ugc nofollow" target="_blank"> <em class="lc"> Pytrends </em> </a>，迭代关键字列表上的数据收集，并使用一个关键字作为参考来整合它们。我们需要这样做，因为谷歌趋势一次只允许最多 5 个关键词比较。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lu"><img src="../Images/29d42f495a38b874fac2c74c3dfe077a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BhEfW9Bdoc4uoEtRmkh-Rg.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">直接在<a class="ae lt" href="https://trends.google.com/trends/explore" rel="noopener ugc nofollow" target="_blank">谷歌趋势</a>上比较关键词</p></figure><p id="e1dd" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">现在让我们搜索关于食物的关键词。这将是有趣的，因为不同类型的食物可能有不同的季节性和受欢迎程度，这可能是一个很好的研究餐饮业。还有，我饿了。所以让我们开始吧！</p></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><p id="ca83" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">准备</strong></p><p id="270e" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">首先，我们需要准备关键字列表，并选择一个参考关键字来实现比较的集成。注意<em class="lc">谷歌趋势</em>给出的是相对受欢迎程度的数据，而不是实际的搜索量。来自<em class="lc">谷歌趋势</em>页面:</p><blockquote class="mc md me"><p id="4a14" class="kg kh lc ki b kj kk jr kl km kn ju ko mf kq kr ks mg ku kv kw mh ky kz la lb ij bi translated">“数字代表在给定地区和时间内相对于图表最高点的搜索兴趣。值 100 是该术语的最高流行度。值为 50 表示该术语的流行程度减半。得分为 0 意味着没有足够的数据用于这个术语。</p></blockquote><p id="db21" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">再者，从我的经验来看，选择一个不太热门的参考关键词是一件好事，因为我们会得到更有特色的对比。但是，引用关键字也应该足够受欢迎，不会获得 0 相对受欢迎度。</p><p id="f78a" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">所以让我们制作一个关键词列表，可以直接在<em class="lc"> Python </em>或者任何电子表格中制作。为了这个教程，我列出了世界上几个受欢迎的菜系的 100 种食物。</p><p id="2fe1" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">连接谷歌 API &amp;收集数据</strong></p><p id="c5b7" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">现在让我们跳进<em class="lc"> Python </em>吧。首先要做的是导入库并连接到<em class="lc"> Google API </em>:</p><pre class="le lf lg lh gt mi mj mk ml aw mm bi"><span id="8999" class="mn mo iq mj b gy mp mq l mr ms"># pip install pytrends<br/>import pandas as pd<br/>from pytrends.request import TrendReq</span><span id="12bd" class="mn mo iq mj b gy mt mq l mr ms">pytrends = TrendReq(hl=’en-US’, tz=360)</span></pre><p id="a838" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">接下来，读取列表并创建迭代以获得列表中所有关键词的<em class="lc"> Google Trends </em>数据。为此，我创建了一个函数来收集一段时间内的<em class="lc"> Google Trends </em>数据(时态数据):</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="dc11" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我还创建了一个函数来按地区或国家收集<em class="lc"> Google Trends </em>数据(空间数据):</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="da6a" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">几个重要参数(详情<a class="ae lt" href="https://pypi.org/project/pytrends/" rel="noopener ugc nofollow" target="_blank">此处</a>):</p><ul class=""><li id="0520" class="mw mx iq ki b kj kk km kn kp my kt mz kx na lb nb nc nd ne bi translated"><em class="lc"> kw_list </em>是要搜索的关键字列表，</li><li id="e214" class="mw mx iq ki b kj nf km ng kp nh kt ni kx nj lb nb nc nd ne bi translated"><em class="lc"> geo </em>可以设置为特定的国家代码，例如“美国”或“全球”，</li><li id="aebf" class="mw mx iq ki b kj nf km ng kp nh kt ni kx nj lb nb nc nd ne bi translated"><em class="lc">猫</em>可以设置到某个类别，例如所有类别:0，食物&amp;饮料:71，</li><li id="0162" class="mw mx iq ki b kj nf km ng kp nh kt ni kx nj lb nb nc nd ne bi translated"><em class="lc">时间范围</em>可以设置为过去 5 年<code class="fe nk nl nm mj b">'today 5-y'</code>，2004 年到现在<code class="fe nk nl nm mj b">'all'</code>等。</li></ul><p id="d4bc" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">每个函数产生 25 个文件(100 个关键字除以 4)，每个文件包含 4 个关键字+参考关键字的比较。接下来，我们将整合这些文件，并相应地归一化相对流行度。</p><p id="7f33" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">数据整合</strong></p><p id="0b63" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">通过将所有文件的列连接在一起，我们得到了完整的数据集，每行代表时间或空间维度。然而，我们可以观察到，在不同的比较之间，参考关键词的相对流行度的值可能是不同的。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nn"><img src="../Images/7c9fd2d99cacbaf0e52b73e65b689b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M_VuI5SWHYY3Egxsy3yhKw.png"/></div></div></figure><p id="eb7d" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">下一步是将这些值标准化，这样我们就可以得到所有 100 种食物的完整的相对比较。我们使用以下公式来计算每个关键字的归一化值:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi no"><img src="../Images/87c210b6230984c7477044193c676ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j_NfKv8Ct3mAjE3NBKY4Aw.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">归一化关键字相对流行度的公式</p></figure><p id="b53b" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">为了实现上面的公式，让我们运行我创建的下面的函数。注意，为了避免无限值，如果参考关键词的相对流行度太小，以至于<em class="lc"> Google </em>报告为 0，我假设相对流行度为 0.01(来自<em class="lc"> Google Trends </em>的最小值)。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="b8b3" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们在<em class="lc"> Python </em>中做的最后一步是整理和融化<em class="lc">数据帧</em>。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mu mv l"/></div></figure><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi np"><img src="../Images/f5a97f319feea2eb4daf80b7ca537bf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iLVyo_DHuClBqvoR4EXETQ.png"/></div></div></figure><p id="f184" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们的数据已经可以可视化了！</p></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><p id="acf9" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">数据可视化使用<em class="lc">Tableau</em>T37】</strong></p><p id="d870" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">几个<strong class="ki ir">好吃的</strong>发现:</p><ol class=""><li id="86e8" class="mw mx iq ki b kj kk km kn kp my kt mz kx na lb nq nc nd ne bi translated"><strong class="ki ir">披萨主宰一切。</strong>他们到处都有极高的人气。但是很明显，T42 的 Soto 在印尼打败了他们，喀麦隆的 Crepes 打败了他们。汉堡和寿司在一些国家也是最受欢迎的。</li></ol><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nr"><img src="../Images/e4bdf901ef1e9a4d02b313168fc868dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LtmytLXILOpB6SUBHAntNQ.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">披萨统治</p></figure><p id="a833" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">2.<strong class="ki ir">甜点的季节性</strong>(其他也是)。夏天吃冰淇淋，冬天吃蛋糕，经典。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ns"><img src="../Images/247a34700e5a78402f50d094673b4111.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*edkElgCdZfy6qOQzceFQLw.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">随着时间的推移而流行</p></figure><p id="ef6c" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">3.<strong class="ki ir">欢宴&amp;节日模式。</strong>例如，<em class="lc">人当</em>每年有两次高峰，分别发生在伊斯兰节日开斋节和宰牲节。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ns"><img src="../Images/f33f7a32520cc72419759fd2581cc6c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PgVefP17he0AVCB6KFuOuQ.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated">印度尼西亚食物</p></figure><p id="69ef" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">4.更多花样:<strong class="ki ir">每年二月的薄饼</strong> ❤</p><p id="d0aa" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">此外，几乎所有的食品都在 2020 年 4 月至 5 月突然涨价，这可能是由于新冠肺炎封锁和检疫的影响。</p><div class="le lf lg lh gt ab cb"><figure class="nt li nu nv nw nx ny paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><img src="../Images/da039a3a4b545a8c1391fd431676d1f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*dOrJA4fnko1AOO0lI-6fbQ.png"/></div></figure><figure class="nt li nz nv nw nx ny paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><img src="../Images/47ade80e42065cb3149637452bc59933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*tq8D5gtgsThQfxUWWZLOpg.png"/></div><p class="lp lq gj gh gi lr ls bd b be z dk oa di ob oc translated">绉效应日</p></figure></div><p id="0d66" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">请随意浏览此处提供的完整<em class="lc">表格</em>仪表盘<a class="ae lt" href="https://public.tableau.com/profile/ristanti.ramadanti#!/vizhome/100FoodAroundTheWorld/Dashboard1" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi od"><img src="../Images/a1ef9fc2de43b6c495b77769aaa96f10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p5CjgQ7z0V1JB57XvuYmHw.png"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated"><a class="ae lt" href="https://public.tableau.com/profile/ristanti.ramadanti#!/vizhome/100FoodAroundTheWorld/Dashboard1" rel="noopener ugc nofollow" target="_blank">完整仪表板</a></p></figure><p id="8550" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我希望这篇教程对你有所帮助，并可能激发更多的分析来！</p></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><p id="fbcb" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">完整的<em class="lc"> Jupyter 笔记本是</em> <a class="ae lt" href="https://github.com/rframadanti/gtrends_multiple/blob/master/pytrends_multiple_keywords.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="lc">这里有</em> </a> <em class="lc">。</em></p><p id="f728" class="pw-post-body-paragraph kg kh iq ki b kj kk jr kl km kn ju ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">可以通过<a class="ae lt" href="https://www.linkedin.com/in/ristanti-ramadanti/" rel="noopener ugc nofollow" target="_blank"> <em class="lc"> LinkedIn </em> </a>联系我。之前我还用<em class="lc"> Google Trends </em>做了一个<em class="lc"> Tableau </em>仪表盘，关于家庭娱乐设备<a class="ae lt" href="https://public.tableau.com/profile/ristanti.ramadanti#!/vizhome/GoogleTrends-SmartHomeGamingDevices/Dashboard1" rel="noopener ugc nofollow" target="_blank">这里有</a>。</p></div></div>    
</body>
</html>