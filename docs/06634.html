<html>
<head>
<title>Image Classification of X-Ray Scans</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">X 射线扫描的图像分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-classification-of-x-ray-scans-ffaf970783f9?source=collection_archive---------33-----------------------#2020-05-25">https://towardsdatascience.com/image-classification-of-x-ray-scans-ffaf970783f9?source=collection_archive---------33-----------------------#2020-05-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a7bc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过人工智能检测新冠肺炎症状</h2></div><p id="cb4d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="le">编者按:</em> </strong> <em class="le"> </em> <a class="ae lf" href="http://towardsdatascience.com/" rel="noopener" target="_blank"> <em class="le">走向数据科学</em> </a> <em class="le">是一份以数据科学和机器学习研究为主的中型刊物。我们不是健康专家或流行病学家，本文的观点不应被解释为专业建议。想了解更多关于疫情冠状病毒的信息，可以点击</em> <a class="ae lf" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports" rel="noopener ugc nofollow" target="_blank"> <em class="le">这里</em> </a> <em class="le">。</em></p><p id="7319" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">医疗保健行业正处于巨大的范式转变之中，技术是驱动力。在这一转变中，尽管人工智能已经取得了巨大的进步，但它还没有成熟到可以进行最终的诊断；它仅仅是为了帮助医疗专业人员给出他们的最终诊断。根据<a class="ae lf" href="https://www.who.int/docs/default-source/coronaviruse/clinical-management-of-novel-cov.pdf" rel="noopener ugc nofollow" target="_blank">世界卫生组织(世卫组织)</a>，重症新冠肺炎最常见的诊断是重症肺炎。这是这个项目背后的关键驱动力。为了帮助对新冠肺炎的研究，我使用了我在哥伦比亚大学的第一门人工智能课程中学到的关于<a class="ae lf" href="https://www.kaggle.com/praveengovi/coronahack-chest-xraydataset" rel="noopener ugc nofollow" target="_blank">数据集</a>的概念，将肺部 X 射线扫描分类为正常或肺炎感染的肺部。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/4a1d5e5f94d2ee2d082cd3b8bc6b4833.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*MWRJBzCpAuH2VA6sH99liQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">来源:作者</p></figure><p id="d27c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">外行人不可能如上所述区分正常人的肺和肺炎感染者的肺。</p><p id="417f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们戴上博士帽，深入研究数据集吧！</p><figure class="lh li lj lk gt ll"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">资料来源:<a class="ae lf" href="https://media.giphy.com/media/jwYCtnPDSgrXa/giphy.gif" rel="noopener ugc nofollow" target="_blank"> Giphy </a></p></figure><h2 id="fcc8" class="lu lv it bd lw lx ly dn lz ma mb dp mc kr md me mf kv mg mh mi kz mj mk ml mm bi translated"><em class="mn">数据文件包含以下文件夹:</em></h2><p id="bc6b" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated"><strong class="kk iu"> Train: </strong>这个文件夹有 5309 张图片，每张图片都以图片 id 命名，例如 IM-0131–0001.jpeg</p><p id="876a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">测试:</strong>这个文件夹以类似的方式存储了 624 张图像</p><p id="9e04" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">Chest _ x ray _ Corona _ metadata . CSV:</strong>这具有从图像 id 到标签的映射，即从 IM-0131–0001.jpeg 到正常。有些图像没有贴图，因此被丢弃</p><p id="7d20" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">Chest _ x ray _ Corona _ dataset _ summary . CSV:</strong>该 excel 文件包含属于每个类别的图像数量的明细</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/090257c5e0eba18a72bff86bdb464257.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*EMPoE3CfGGJ3KKyTX1XWBQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">来源:作者</p></figure><p id="e898" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用 python 对图像进行了处理并存储在本地。通过改变尺寸(300 x 300)和格式(PNG)使它们变得一致。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/4ca02c36ce46a05d40f6ffb2b60edaa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*cYJ2jVA9FWaaS0rx52Mzdg.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">来源:作者</p></figure><p id="e190" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该标签用于在 python 中重命名图像，以便于分类。选择这些维度是为了平衡信息损失(太小)和训练模型时更高的计算时间(太大)之间的权衡。</p><p id="f597" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">处理后的图像被推送到 Google drive，因为模型训练必须在 Collab (GPU 支持和 25 GB RAM)上完成。<strong class="kk iu">正常</strong>图像标记为 1，<strong class="kk iu">肺炎</strong>图像标记为 0。训练图像被转换成从 0 到 255(像素)的数字数组，并与它们的标签一起存储在一个列表中，以传递给神经网络。20%的训练数据被保留用于验证(超参数调整)。</p><p id="daf3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">遵循的<strong class="kk iu">网络</strong> <em class="le"> </em>架构是一个流行的、有效的、简单的架构，叫做<a class="ae lf" href="https://arxiv.org/pdf/1409.1556.pdf" rel="noopener ugc nofollow" target="_blank"> VGGnet </a>。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mv"><img src="../Images/cb0e557733741f558a7602b267feef1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*rWP9UXbX0aB6ey7WjOu9fw.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">来源:<a class="ae lf" href="https://www.slideshare.net/sujitpal/transfer-learning-and-fine-tuning-for-cross-domain-image-classification-with-keras/9" rel="noopener ugc nofollow" target="_blank">快照</a>(爱思唯尔)</p></figure><p id="d154" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里使用的架构<a class="ae lf" rel="noopener" target="_blank" href="/image-detection-from-scratch-in-keras-f314872006c9"/>是图中所示的较小版本，但有趣的是，随着我们越往下，滤波器的尺寸越大。使用了以下过滤器:</p><p id="9292" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi">32 → 64 → 128 → 512 → 1</p><p id="facb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">隐藏层均由 Relu(校正线性单位)激活函数激活。二维卷积网络使用大小为[3，3]的核。这指定了二维卷积窗口的高度和宽度。滤波器大小[32]是输出维度的大小(卷积中输出滤波器的数量)。输入形状为[300，300，1]。前两个维度是图像的大小，最后一个维度是图像中通道的数量(1 表示图像为灰度)。</p><p id="8ad1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在编译网络之前，进行<strong class="kk iu">数据扩充</strong>以增加输入图像的数量。Keras 有一个图像数据生成器，这是一个标准的工具。生成器有助于重新缩放像素值以及生成新形式的图像。例如，放大和缩小、按特定角度旋转会创建同一图像的相似版本，并增加数据的大小。x 射线图像水平翻转的想法在这里<a class="ae lf" href="https://arxiv.org/pdf/1711.05225.pdf" rel="noopener ugc nofollow" target="_blank">得到了验证</a>。使用生成器，像素值也被缩放到 0 和 1 之间。</p><p id="e4c5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">损失函数被设置为<strong class="kk iu">二进制交叉熵</strong>当输出取二进制值时，选择的优化器是学习率为 0.0001 的<strong class="kk iu">亚当</strong>，选择的度量是<strong class="kk iu">准确度</strong>。网络的其他规范在<a class="ae lf" href="https://github.com/aneeshgoel/Image-Classification-of-Lung-X-Rays" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上的代码中。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi na"><img src="../Images/0be3a5572c0fad03588005a1b5645d4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*QPjyc2ntBXktr-VCS7F-Dw.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">来源:作者</p></figure><p id="2290" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">历元的数量</strong>被认为是 60。可以看到，精度在大约 50 个时期后趋于稳定，我们可以认为权重已经得到了相当好的优化。可以通过像提前停止这样的方法来进一步微调这些时期。</p><p id="1602" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用这些权重，在 624 幅测试图像上的准确率为<strong class="kk iu"> 92.1% </strong>。下面是结果的快照，其中每个图像的标题显示了实际的和预测的标签(代码中有更多的结果)。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/1c8ec30c2795ad75fff32c21a09d9d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*4rZ1EIOp3ogH5wHuWOSUcA.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">来源:作者</p></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/6d18348a5bbb826a6b32b3263dd6ac90.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*xx2SWQuNTC9rXEGZLYGuyQ.png"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">来源:作者</p></figure><h1 id="16d0" class="nd lv it bd lw ne nf ng lz nh ni nj mc jz nk ka mf kc nl kd mi kf nm kg ml nn bi translated">TL；速度三角形定位法(dead reckoning)</h1><p id="0275" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">对于未来的范围，如果有更多的新冠肺炎病例和其他病毒的标记图像，可以进行多级分类。神经网络是数据饥渴模型，有了海量的数据集，可以建立更深层次的网络，结果会好得多。此外，使用交叉验证(5 倍)来监控样本外性能可能是一个好主意，因为这将更能代表学习。也可以对时期的数量进行微调，以提高测试集的准确性。</p><p id="dd2e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在结束语中，我要再次强调这样一个事实，即人工智能算法应该作为做出重要决策的补充支持，特别是在医疗保健等领域(至少在我们到达终结者时代之前)！</p><figure class="lh li lj lk gt ll"><div class="bz fp l di"><div class="no lt l"/></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">来源:<a class="ae lf" href="https://media.giphy.com/media/t6lAkVXWvuANMv5Pqa/giphy.gif" rel="noopener ugc nofollow" target="_blank"> Giphy </a></p></figure></div></div>    
</body>
</html>