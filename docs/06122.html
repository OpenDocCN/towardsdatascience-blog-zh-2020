<html>
<head>
<title>Using Selenium and deepL to automate the translation of PowerPoint files</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Selenium 和 deepL 自动翻译 PowerPoint 文件</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-selenium-and-deepl-to-automate-the-translation-of-power-point-files-3c01f81f113?source=collection_archive---------26-----------------------#2020-05-18">https://towardsdatascience.com/using-selenium-and-deepl-to-automate-the-translation-of-power-point-files-3c01f81f113?source=collection_archive---------26-----------------------#2020-05-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/5a51698b6e2a5814ef997998e9c0b14b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uw2brhxijjz1OjgjJeQwjg.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@aaronburden" rel="noopener ugc nofollow" target="_blank"> Aaron Burden </a>在<a class="ae jg" href="https://unsplash.com/s/photos/information?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><div class=""/><div class=""><h2 id="51a4" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">曾经想要高效地翻译 PowerPoint 幻灯片吗？了解如何使用 Python 自动完成这一过程！</h2></div><h1 id="26cf" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">对自动化的需求</h1><p id="2a80" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">像许多顾问一样，我非常习惯使用 PowerPoint 演示文稿。但是最近，我被要求以一种非常特殊的方式与那些<em class="mm"> *打交道。pptx </em>文件。我没有展示我的工作或任何策略，而是被要求将一打又一打的幻灯片从法语翻译成英语。我的第一个想法和你一模一样:“真无聊…！!"。</p><p id="0446" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">是的<em class="mm">，很无聊</em>！但是你知道吗？事实是，开发人员<em class="mm">非常喜欢</em>被分配无聊的工作。这样他们就可以自动操作了！下面是我翻译数百张幻灯片中数万个单词的故事。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="e69c" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">在本文中，您将发现如何用 Python 操作 PowerPoint 文件，以及如何从翻译网站提取信息。但是让我们从一个小的基准开始，从<em class="mm">为什么</em>开始，然后再到<em class="mm">如何</em>！</p><h1 id="5719" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">寻找现有的解决方案</h1><p id="bb44" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">紧接着绝望的<em class="mm">“太无聊了…”、</em>和自信的<em class="mm">“我会花一天时间给自己造一个神奇的机器人，这将使我接下来 3 天的工作顺利进行”</em>之后，是务实的<em class="mm">“我肯定能在网上找到免费的 PowerPoint 翻译器”。</em></p><p id="7a3e" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">一个表演工具需要调和两者:</p><ul class=""><li id="1ef3" class="mz na jj ls b lt mn lw mo lz nb md nc mh nd ml ne nf ng nh bi translated">短句和长句的良好翻译水平</li><li id="f4fa" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml ne nf ng nh bi translated">不修改原始文件的设计</li></ul><p id="06d9" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">在用于文档修改的免费在线工具的丛林中，很容易找到来自<em class="mm"> *的转换器。pdf </em>至<em class="mm"> *。docx，</em>来自倍数<em class="mm"> *。jpgs </em>到单个*。pdf、文本翻译、表格提取、文件压缩等。表现非常好。不幸的是，PowerPoints 是复杂的文档，你可以找到许多不同的对象，它们可以组合在一起。</p><p id="a36e" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我轻而易举地找到了提供这种服务的网站，在几张幻灯片上做了一些测试，然后……立刻让自己完全听天由命了。在尝试了不同的翻译器之后，结果相当令人失望:<strong class="ls jk">翻译过于近似</strong>，并且<strong class="ls jk">字体/大小/颜色与源文档</strong>相比不时改变。毫无疑问，这可以完成部分工作。但是我仍然需要非常谨慎和耗时地阅读这些文件。冒着忘记明显的误译的风险，这些误译一眼就能看穿我。不会吧。</p><p id="f672" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">但愿我已经听同事们谈论过 PowerPoint 模板脚本，并阅读了许多关于这个主题的文章。有几个星期，我想实现一个 selenium 项目，那里有强大的在线翻译器，对网络用户免费。定制工具的想法诞生了。</p><h1 id="7632" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">基准测试和起草工具</h1><h2 id="f8be" class="nn kz jj bd la no np dn le nq nr dp li lz ns nt lk md nu nv lm mh nw nx lo ny bi translated">堆栈展示</h2><p id="e457" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">经过一些研究后，我相信下面的堆栈会产生有趣的结果。使用<a class="ae jg" href="https://github.com/scanny/python-pptx" rel="noopener ugc nofollow" target="_blank"> python-pptx </a>包与文件进行交互。它允许我们处理演示文稿、幻灯片、形状、表格、段落、分组框等等。这个工具似乎很有前途。对于翻译部分，我会选择由人工智能驱动的翻译机。由于它的 API 不是免费的，Selenium 将非常适合访问网页和自动翻译。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h2 id="f4ad" class="nn kz jj bd la no np dn le nq nr dp li lz ns nt lk md nu nv lm mh nw nx lo ny bi translated"><strong class="ak">为什么选择 Python-pptx？</strong></h2><p id="eeed" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">Python-pptx 是一个 Python 包，可以通过常用的<code class="fe nz oa ob oc b">pip install python-pptx</code>命令行获得。它允许我们以一种非常结构化的方式探索 PowerPoint 文件。首先处理一个<code class="fe nz oa ob oc b">Presentation</code>对象，它包含所有高级信息。然后你访问<code class="fe nz oa ob oc b">Slides</code>对象，在每张幻灯片中你访问<code class="fe nz oa ob oc b">Shapes</code>对象。形状可以是文本框、表格、图表、图像，甚至是一组形状。非常直观。</p><p id="e5fc" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">当你处理一个<code class="fe nz oa ob oc b">text_frame</code>实例时，你可以访问文本和字体。看起来完美地满足了我们的需求:翻译文本而不改变其他任何东西！</p><p id="da9f" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">最重要的是，文档非常全面，写得很好。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h2 id="a758" class="nn kz jj bd la no np dn le nq nr dp li lz ns nt lk md nu nv lm mh nw nx lo ny bi translated"><strong class="ak">为什么是 DeepL？</strong></h2><p id="4c2a" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">DeepL 是一个基于卷积神经网络的人工智能翻译器，它是在<a class="ae jg" href="https://www.linguee.com/" rel="noopener ugc nofollow" target="_blank">linguie</a>数据库上训练的。它于 2017 年推出，据报道，很快就在盲测中超越了竞争对手，包括谷歌翻译、微软翻译和脸书。与竞争对手的速度一样，它也将更加精确，更加细致入微。</p><figure class="oe of og oh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi od"><img src="../Images/4cebc92006ac79f53061c5e2430ef58b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fDMc1OOYimvo1vMSeKBDKQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">一个强大的基于人工智能的翻译器，在线提供</p></figure><p id="899c" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我不会实现一个完整的基准，但这里有一个 DeepL 和谷歌翻译之间的比较。</p><p id="6a5a" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls jk">英文原文</strong></p><blockquote class="oi oj ok"><p id="3cdb" class="lq lr mm ls b lt mn kk lv lw mo kn ly ol mp mb mc om mq mf mg on mr mj mk ml im bi translated"><em class="jj">在过去，蚂蚁和蝉是朋友。他们非常不同。当蚂蚁努力工作的时候，蝉什么也没做。他们整天唱歌跳舞。</em></p></blockquote><p id="3639" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls jk">谷歌翻译</strong></p><blockquote class="oi oj ok"><p id="d0a6" class="lq lr mm ls b lt mn kk lv lw mo kn ly ol mp mb mc om mq mf mg on mr mj mk ml im bi translated">秋天、四月和十一月。<strong class="ls jk"> Ils </strong>培训课程<strong class="ls jk">差异</strong>。在工作期间，没有香烟。在整个旅程中，他们都在歌唱和跳舞。</p></blockquote><p id="4692" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls jk">深度翻译</strong></p><blockquote class="oi oj ok"><p id="6b57" class="lq lr mm ls b lt mn kk lv lw mo kn ly ol mp mb mc om mq mf mg on mr mj mk ml im bi translated">家庭旅游、旅游和吸烟。<strong class="ls jk">Elles</strong>étain tèRS<strong class="ls jk">differentes</strong>。在这四个月的工作中，没有香烟。在整个旅程中。</p></blockquote><p id="b4c2" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">对于不懂法语的读者，我们在这里介绍了 Google 和 DeepL 之间的两项重大改进:性别检测(在法语中，蝉和蚂蚁都是阴性词，因此我们用<strong class="ls jk"> <em class="mm"> elles </em> </strong>而不是<em class="mm"/><strong class="ls jk"><em class="mm">ils</em></strong>来修饰它们，后者是<em class="mm"> elles </em>的阳性词)，以及时间的一致性，即根据事件发生的时间使用正确的变化形式。</p><p id="bb8d" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">这里的例子已经足够了，但是在很少的单词的短句中，翻译也要好得多，并且可以很好地处理停用词。这对 PowerPoint 用例非常重要。我们开始吧，我们将使用 DeepL。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="c574" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls jk">为什么是硒？由于 DeepL 的 API 不是免费的，我们将不得不从它的网络接口使用它。无需争辩，Selenium 是完成这类任务的完美工具。正如他们自己所说:</strong></p><blockquote class="oo"><p id="f934" class="op oq jj bd or os ot ou ov ow ox ml dk translated">Selenium 自动化浏览器</p></blockquote><p id="1aa8" class="pw-post-body-paragraph lq lr jj ls b lt oy kk lv lw oz kn ly lz pa mb mc md pb mf mg mh pc mj mk ml im bi translated">要发现 Selenium 的威力，我建议你阅读<a class="ae jg" href="https://medium.com/better-programming/lets-create-an-instagram-bot-to-show-you-the-power-of-selenium-349d7a6744f7" rel="noopener">这篇文章</a>，它详细介绍了这个库，并解释了如何创建 Instagram 机器人。</p><h1 id="a13d" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated"><strong class="ak">动手操作</strong></h1><h2 id="704c" class="nn kz jj bd la no np dn le nq nr dp li lz ns nt lk md nu nv lm mh nw nx lo ny bi translated"><strong class="ak">从无到有的工具</strong></h2><p id="ccc4" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">正如你可能已经猜到的，这个项目有<strong class="ls jk">两个不同的部分</strong>，这基本上意味着<strong class="ls jk">三个步骤:</strong></p><ul class=""><li id="9783" class="mz na jj ls b lt mn lw mo lz nb md nc mh nd ml ne nf ng nh bi translated">构建翻译器</li><li id="d1ca" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml ne nf ng nh bi translated">与 PowerPoint 演示文稿互动</li><li id="372e" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml ne nf ng nh bi translated">放在一起</li></ul><p id="7494" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">让我们深入研究并发现解决方案是如何工作的！</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h2 id="0afd" class="nn kz jj bd la no np dn le nq nr dp li lz ns nt lk md nu nv lm mh nw nx lo ny bi translated">构建翻译器</h2><p id="31be" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">为了记住这个过程，我们要做的是</p><ul class=""><li id="0a46" class="mz na jj ls b lt mn lw mo lz nb md nc mh nd ml ne nf ng nh bi translated">创建 selenium 驱动程序</li><li id="864a" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml ne nf ng nh bi translated">打开 deepL 网页</li><li id="dd02" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml ne nf ng nh bi translated">将文本发送到网页的输入文本区域</li><li id="fdea" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml ne nf ng nh bi translated">从翻译文本区域阅读翻译文本</li><li id="be4b" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml ne nf ng nh bi translated">关闭页面和 selenium 驱动程序</li></ul><p id="b2d6" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">直截了当，是吧？</p><p id="e05d" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">不幸的是，deepL 页面都是用 Javascript 编写的，翻译后的文本不会出现在 HTML 内容中，即使显示在屏幕上也是如此。这是第一个挑战:不可能确定从哪个 Html div(或其他什么)组件中提取文本内容。</p><p id="c5ec" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">希望 Selenium 是一个伟大的工具，deepL 在另一点上使它变得容易:他们为我们提供了一个“复制到剪贴板按钮”。识别之后，只需单击一下就可以将翻译后的文本放入剪贴板(注意剪贴板库已经(安装&amp;)导入到第 3 行。</p><figure class="oe of og oh gt iv"><div class="bz fp l di"><div class="pd pe l"/></div></figure><blockquote class="oi oj ok"><p id="b908" class="lq lr mm ls b lt mn kk lv lw mo kn ly ol mp mb mc om mq mf mg on mr mj mk ml im bi translated">注意:在文本输入和点击复制按钮之间有一个等待时间:<code class="fe nz oa ob oc b">time.sleep(3)</code>。这是由于互联网连接和通过网络的请求。除了翻译过程之外，无论文本有多长，在您的浏览器中收到翻译文本之前都有一个最短的等待时间。</p></blockquote><p id="94b4" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">这里有一个句子翻译器。现在，如何从单个句子到一个完整的语料库？第一种解决方案是循环整个过程。但是考虑到<code class="fe nz oa ob oc b">3s-translation</code>需要等待，对于更长的语料库来说，它会非常慢。想象一下，一个有 50 张幻灯片的 PowerPoint，包含一个标题和几个文本框，需要几个小时。</p><p id="3d36" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">但是再一次，DeepL 让我们变得容易了。它允许我们一次翻译不同的段落。因此，我们可以同时发送多个句子，从句子中建立一个语料库。为了实现这一点，我们通过将句子连接成一个长字符串来创建一个更长的文本。为了确保算法不会在我们的句子之间添加任何上下文，我们使用一个连接字符串进行连接。翻译后，连接符字符串被用作拆分符字符串，这样我们就可以逐句得到翻译。</p><figure class="oe of og oh gt iv"><div class="bz fp l di"><div class="pd pe l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">从不同的句子创建单个字符串语料库</p></figure><blockquote class="oo"><p id="af49" class="op oq jj bd or os pf pg ph pi pj ml dk translated">太棒了。所以，如果我发送我的全部语料库，我将在几秒钟内得到它的翻译？</p></blockquote><p id="8855" class="pw-post-body-paragraph lq lr jj ls b lt oy kk lv lw oz kn ly lz pa mb mc md pb mf mg mh pc mj mk ml im bi translated">还没有。使用 DeepL，对翻译的字符数有限制。让我们发现这一点。</p><figure class="oe of og oh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pk"><img src="../Images/6a4b85c9b9b41bd3e68f08be382d9bcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L8zriKPvHx6gJ5Dk1mMdKQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来自 DeepL 网站的截图</p></figure><blockquote class="oi oj ok"><p id="2205" class="lq lr mm ls b lt mn kk lv lw mo kn ly ol mp mb mc om mq mf mg on mr mj mk ml im bi translated">注意:您可以看到“翻译文档”选项。如果你点击它，你就可以上传一个 PowerPoint 文件。不幸的是，文件大小是有限的，并且有一个到高级选项的重定向，这不是免费的。</p></blockquote><p id="bd88" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">事实上，如右下角所示，翻译的限制是 5000 个字符。如果有人试图多放一些，页面就会变红，翻译只针对文本第 5000 个字母之前的句子。</p><p id="5ce8" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">这不是一个真正的问题，只要它是一个非常合理的限制，我们可以创建调整后的批量句子。想法是这样的:给定一个巨大的语料库，我们将创建一批句子，这样每一批大约(略少于)5000 个字符。</p><p id="1159" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">对于每一批，我们将运行前面的函数。如果我们有一个 200 个句子的语料库，平均 90 个字符(15 个单词，5 个字母/单词+1 个空白/单词)，总共 18 000 个单词，它将可能创建 4 批:3*5000 + 1*3000。计算并不完全正确，因为由于 joiner 而有额外的字符，但你得到了想法。</p><figure class="oe of og oh gt iv"><div class="bz fp l di"><div class="pd pe l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">调整语料库的大小</p></figure><blockquote class="oi oj ok"><p id="aa2c" class="lq lr mm ls b lt mn kk lv lw mo kn ly ol mp mb mc om mq mf mg on mr mj mk ml im bi translated">注意:随着文本大小的增加，翻译时间也会增加。它不是线性增加的，但是为了翻译 5000 个字符，在将翻译的文本提取到剪贴板之前，等待 20 秒而不是 3 秒是合理的。时间也取决于翻译语言。例如，如果你想从英语翻译成法语或西班牙语，它很快。翻译成中文要长得多。我做了一些测试，在那种情况下等待的时间更多在 45s 左右。关于翻译的准确性，我相信 DeepL，但我无法验证！</p></blockquote><blockquote class="oo"><p id="e068" class="op oq jj bd or os pf pg ph pi pj ml dk translated">太好了！现在一切都好吗？我能把我最喜欢的书从葡萄牙语翻译成荷兰语吗？</p></blockquote><p id="4d0f" class="pw-post-body-paragraph lq lr jj ls b lt oy kk lv lw oz kn ly lz pa mb mc md pb mf mg mh pc mj mk ml im bi translated">再次，有一些新的挑战。运行前面的脚本可以很好地处理少量文本。事实上，selenium 的<code class="fe nz oa ob oc b">send_keys</code>功能模拟了一个人在键盘上一个接一个地按键。它做得更快，但他做到了。这意味着 deepL 一个接一个地接收近 5000 个字符。<strong class="ls jk">网站检测到这是一个机器人行为。</strong>然后反机器人插件将翻译过程替换为一种不稳定的行为:改变 DeepL 网站的页面，打开弹出窗口，或者试图在你的计算机上下载翻译。非常糟糕。</p><p id="12c0" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我没有做很多测试来了解速度限制是什么，因为对于大型语料库来说，打字慢会花很多时间。</p><p id="136d" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">另一个非常直观的方法是<strong class="ls jk">更好地</strong>T5】模仿人类与网页互动的方式。确实如此。如果让你翻译十句话，你会把这十句话从头开始写到文本框里吗？或者你会从你的原始文件中使用一个基本的<em class="mm">复制/粘贴</em>？就是它:<em class="mm">复制/粘贴</em>现在是我们最好的盟友。</p><figure class="oe of og oh gt iv"><div class="bz fp l di"><div class="pd pe l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">使用 Selenium 的复制/粘贴功能</p></figure><blockquote class="oi oj ok"><p id="795f" class="lq lr mm ls b lt mn kk lv lw mo kn ly ol mp mb mc om mq mf mg on mr mj mk ml im bi translated"><strong class="ls jk">警告</strong> : selenium 复制/粘贴的方式似乎取决于你使用的操作系统和导航器。我来解释一下:当你模拟使用你的键盘时，在 MacOS 中你会实现 COMMAND + V，而在 Windows 上，你会实现 CONTROL + V。</p><p id="aaa8" class="lq lr mm ls b lt mn kk lv lw mo kn ly ol mp mb mc om mq mf mg on mr mj mk ml im bi translated">在 MacOS + Chrome 上，我发现它可以很好地与:<code class="fe nz oa ob oc b">element.send_keys(Keys.SHIFTT, Keys.INSERT)</code></p></blockquote><p id="9d0a" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">好了，我们快好了。这很好，但是还有另一个问题需要解决:当我们添加这么多文本时，翻译框变得更大:比你的屏幕还要大。</p><p id="5c4e" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">起初，这似乎不会改变什么，但是我们使用的“复制到剪贴板按钮”位于页面的底部。而现在已经出屏了。那么我们仍然可以在 Html 语法中检测到它，但是 selenium 不能模拟对它的点击。</p><p id="06d7" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">下一步:滚动页面。Selenium 有一个内置的方法来做到这一点。</p><figure class="oe of og oh gt iv"><div class="bz fp l di"><div class="pd pe l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">使用 Selenium 进行滚动，以便能够点击选定的按钮</p></figure><p id="a1f7" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我们到了！我们的翻译器现在可以工作了，可以翻译我们需要的所有文本了。免费准确的翻译。太好了！</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="f5ed" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">一个好的实践是将 selenium scrappers 实现为类。基于我们在这里看到的，你可以在这里找到<a class="ae jg" href="https://github.com/ThibaudLamothe/translate-pptx/blob/master/src/deepL_selenium.py" rel="noopener ugc nofollow" target="_blank">和</a>完整的<code class="fe nz oa ob oc b">seleniumDeepL</code>类，这使得翻译更加容易。注意，它从同一个<a class="ae jg" href="https://github.com/ThibaudLamothe/translate-pptx" rel="noopener ugc nofollow" target="_blank"> GitHub repo 中的<a class="ae jg" href="https://github.com/ThibaudLamothe/translate-pptx/blob/master/src/default_selenium.py" rel="noopener ugc nofollow" target="_blank">可用的</a>类继承了一些基本的 selenium 属性。</a></p><p id="7931" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls jk">三句话语料库中的翻译示例</strong></p><pre class="oe of og oh gt pl oc pm pn aw po bi"><span id="713f" class="nn kz jj oc b gy pp pq l pr ps">corpus_fr = [<br/>    "Bonjour j’aimerais traduire tous ces documents",<br/>    "Mais je ne suis pas sur d’avoir un niveau d’anglais suffisant",<br/>    "Et surtout ! Je suis Data Scientist, pas traducteur."<br/>]</span></pre><figure class="oe of og oh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pt"><img src="../Images/7730bebfa14ec0e05335b32840b4d3e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yNrZ75dzLHyrsFtKBogecQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">3 句话翻译的外壳日志</p></figure><p id="6d86" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><code class="fe nz oa ob oc b">seleniumDeepL</code>对象提供了那篇文章中没有讨论的有趣的附加特性，例如:</p><ul class=""><li id="928d" class="mz na jj ls b lt mn lw mo lz nb md nc mh nd ml ne nf ng nh bi translated">选择翻译的目标语言。我们可以使用 DeepL 中所有可用的语言。截至今日，已有:<em class="mm">英语(</em> <code class="fe nz oa ob oc b">en</code> <em class="mm">)、法语(</em> <code class="fe nz oa ob oc b">fr</code> <em class="mm">)、西班牙语(</em> <code class="fe nz oa ob oc b">sp</code> <em class="mm">)、德语(</em> <code class="fe nz oa ob oc b">de</code> <em class="mm">)、荷兰语(</em> <code class="fe nz oa ob oc b">nl</code> <em class="mm">)、葡萄牙语(</em> <code class="fe nz oa ob oc b">pt</code> <em class="mm">)、波兰语(</em> <code class="fe nz oa ob oc b">pl</code> 【T24)、汉语(<code class="fe nz oa ob oc b">zh</code>和<em class="mm">日语(</em> <code class="fe nz oa ob oc b">ja</code> 【T30)DeepL 会自动检测源语言，要选择目标语言，您需要将<a class="ae jg" href="http://www.deepl.com/en/translator" rel="noopener ugc nofollow" target="_blank">www.deepl.com/en/translator</a>URL 中的<code class="fe nz oa ob oc b">en</code>更改为所需的语言。</li><li id="4d56" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml ne nf ng nh bi translated">通过只翻译语料库或当前批次中尚未看到的句子，加快处理速度。</li><li id="9b0e" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml ne nf ng nh bi translated">从/向 json 文件导入和导出翻译{句子 1:翻译 1，句子 2:翻译 2，…}</li></ul></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="2605" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">总而言之，我们已经看到了如何:</p><ul class=""><li id="cb7d" class="mz na jj ls b lt mn lw mo lz nb md nc mh nd ml ne nf ng nh bi translated">以字符串列表的形式加载数据，使用连接字符串将它们以 5k 字母为一批连接起来，并在一个较小的语料库中转换这些批次，以加快翻译速度。</li><li id="44bc" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml ne nf ng nh bi translated">通过将它们添加到剪贴板来翻译每个批处理，并从剪贴板粘贴到 DeepL 翻译框中。我们等待几秒钟的翻译，找到，滚动并点击“复制到我的剪贴板按钮”。最后一步是使用 joiner 字符串将翻译后的数据分割成原始大小。</li></ul></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h2 id="d4e4" class="nn kz jj bd la no np dn le nq nr dp li lz ns nt lk md nu nv lm mh nw nx lo ny bi translated"><strong class="ak"> PowerPoint 探索</strong></h2><p id="04a3" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这一部分更短更简单:给定一个 PowerPoint 文件，我们希望提取它的所有文本，将其提供给我们的翻译人员，并用他们的翻译替换所有文本。</p><p id="c21f" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls jk">提取文本</strong></p><p id="a08e" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我们现在想要获取演示文稿中的所有文本。接下来阅读所有这些需要有条不紊地浏览文件。</p><figure class="oe of og oh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pu"><img src="../Images/75321395ad53464b2402007b1274a846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jTdYRety1nDDfhRGByRz2A.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">PowerPoint 屏幕截图—全文(1/3)</p></figure><p id="a3da" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">每个演示文稿都以相同的方式构建:</p><ul class=""><li id="1ad5" class="mz na jj ls b lt mn lw mo lz nb md nc mh nd ml ne nf ng nh bi translated">演示文稿包含幻灯片</li><li id="9e38" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml ne nf ng nh bi translated">幻灯片包含形状</li><li id="512c" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml ne nf ng nh bi translated">形状可能包含文本</li></ul><p id="7399" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">python-pptx 有对应的内置对象。这迅速导致了这个功能:</p><figure class="oe of og oh gt iv"><div class="bz fp l di"><div class="pd pe l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">用 python-pptx 从 PowerPoint 中提取文本</p></figure><p id="36c1" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我们现在有演示文稿的所有文本吗？全部吗？真的吗？我们去看看。</p><p id="27fc" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">为了确定我们正在收集的文本，我不是只收集文本，而是用空字符串替换它们，然后以空版本保存演示文稿。打开它，我们将快速检查是否所有的文本都已被选中(和删除),并推断我们的算法是否运行良好。</p><p id="1c6b" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">让我们分两步来做:</p><ol class=""><li id="89f8" class="mz na jj ls b lt mn lw mo lz nb md nc mh nd ml pv nf ng nh bi translated">将<code class="fe nz oa ob oc b">texts.append(paragraph.text)</code>替换为<code class="fe nz oa ob oc b">paragraph.text = ‘’</code></li><li id="423c" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml pv nf ng nh bi translated">在我们的<code class="fe nz oa ob oc b">get_texts_from_file </code>函数的末尾使用<code class="fe nz oa ob oc b">prs.save(output_file)</code></li></ol><p id="b0e7" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">这是上一张图片的演示结果:</p><figure class="oe of og oh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pw"><img src="../Images/ec66a7e92fb3f240a3ba8aab5b02e951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S-ieUUslPbrIk1Y7aUqfuA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">PowerPoint 屏幕截图—空文本(2/3)</p></figure><p id="6b23" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">这看起来几乎不错，但你可能会在第三张幻灯片上看到，我们还有一个文本。</p><p id="9187" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">事实上，在代码中，我们检查了所有将<code class="fe nz oa ob oc b">has_text_frame</code>属性设置为<code class="fe nz oa ob oc b">True</code>的形状。</p><p id="ef20" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">但是所有的形状并不完全具有相同的类型。具体来说，我们要处理两种<em class="mm">特殊形状:</em></p><ul class=""><li id="e3c3" class="mz na jj ls b lt mn lw mo lz nb md nc mh nd ml ne nf ng nh bi translated"><strong class="ls jk">组合形状</strong> : <strong class="ls jk"> </strong>您可能知道，在 PowerPoint 中编辑包含大量信息的文件时，您可能会选择几个形状并将它们组合在一起。如果你仔细观察第一张截图，你会发现在<em class="mm">的右边部分</em>有两个矩形(一个用于图片，一个用于文本),而在<em class="mm">的左边部分</em>只有一个。这是因为 Selenium 徽标和 Selenium 文本组合在一起。在 python-pptx 中，这些元素被称为<a class="ae jg" href="https://python-pptx.readthedocs.io/en/latest/api/shapes.html#groupshapes-objects" rel="noopener ugc nofollow" target="_blank"> GroupShapes </a>，事实上，GroupShapes 没有<code class="fe nz oa ob oc b">text_frames</code>属性，因此<code class="fe nz oa ob oc b">has_text_frame</code>属性默认设置为<code class="fe nz oa ob oc b">False</code>。这就是为什么我们的算法没有隐藏该文本。希望 GroupShapes 有一个<code class="fe nz oa ob oc b">Shapes</code>属性，它包含组合形状的单独形状。</li><li id="9f83" class="mz na jj ls b lt ni lw nj lz nk md nl mh nm ml ne nf ng nh bi translated"><strong class="ls jk">表格:</strong>上例中没有表格，但问题是一样的。有些形状，除了<code class="fe nz oa ob oc b">has_text_frame</code>，形状还有一个<code class="fe nz oa ob oc b">has_table</code>属性。而当<code class="fe nz oa ob oc b">has_table is True</code>我们可以访问<a class="ae jg" href="https://python-pptx.readthedocs.io/en/latest/api/table.html#table-objects" rel="noopener ugc nofollow" target="_blank">表</a>对象。表格没有文本值，但是<code class="fe nz oa ob oc b">Table</code>包含<code class="fe nz oa ob oc b">cell</code>，单元格有<code class="fe nz oa ob oc b">text_frame</code>对象。问题解决了。</li></ul><p id="50a5" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">当这两种类型的形状都考虑在内时，结果要令人满意得多。</p><figure class="oe of og oh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pw"><img src="../Images/49593d7268b8e0ee1e68186171381d53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7EvijZhLkmeAmMHVFwzdTA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">PowerPoint 屏幕截图—空文本(3/3)</p></figure><blockquote class="oi oj ok"><p id="eadf" class="lq lr mm ls b lt mn kk lv lw mo kn ly ol mp mb mc om mq mf mg on mr mj mk ml im bi translated">注意:还有一些其他形状，但它们主要是图形，并不意味着文本，所以我们不需要为它们费心。但是如果你必须处理 PowerPoint 文件，你肯定应该仔细看看写得很好的 python-pptx 文档；) !</p></blockquote><p id="f087" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">现在我们确信我们已经阅读了演示文稿的所有文本，让我们进入下一步。</p><p id="abd0" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls jk">翻译</strong></p><p id="e2ae" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我们有一个句子列表，它看起来像一个为我们的翻译格式化的语料库。这个把它转化成批量语料库，在 deepL 网站上做一些迭代，返回一个字典。</p><p id="eb36" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我们可以再次遍历我们的 PowerPoint 并使用翻译词典替换文本。关键词是原文，价值是译文。</p><p id="851f" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated"><strong class="ls jk">插入文本</strong></p><p id="2fd6" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">这是最后一步:重新插入文本。这和我们以前做的没什么不同。我们必须检查文件的每一个<code class="fe nz oa ob oc b">text_frame</code>,而不是设置空值，我们将设置翻译。</p><figure class="oe of og oh gt iv"><div class="bz fp l di"><div class="pd pe l"/></div></figure><blockquote class="oi oj ok"><p id="fa54" class="lq lr mm ls b lt mn kk lv lw mo kn ly ol mp mb mc om mq mf mg on mr mj mk ml im bi translated">注意:为了简化代码，我们在 l.15 上迭代通过<code class="fe nz oa ob oc b">all_presentation_text_frames</code>。这是为了说明的目的:处理表格和分组形状的真实过程并不那么简单。ppt 操作的完整代码可从<a class="ae jg" href="https://github.com/ThibaudLamothe/translate-pptx/blob/master/src/ppt_interaction.py" rel="noopener ugc nofollow" target="_blank">这里获得。</a></p></blockquote><p id="dede" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">最后一次更新是必要的。这里我们替换了<code class="fe nz oa ob oc b">text_frame.paragraph.text</code>值。事实上，它封装了比文本更多的信息。要理解这一点，您必须知道每个形状都有自己的参数(颜色、大小、位置、格式和<strong class="ls jk">字体</strong>)。这些是给定形状和 PowerPoint 模板的默认值。但有时我们可以手动更改这些信息。例如，如果文本太长，人们可能会决定将默认大小点从 16 改为 14，以便它正确地适应形状。在这种特定情况下，信息存储在<code class="fe nz oa ob oc b">text_frame.paragraph.text.runs</code>中。这样我们就不能轻易地覆盖文本。</p><p id="3518" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">不幸的是，这是一个<strong class="ls jk">关键点</strong>:我们必须保持与输入文件完全相同的结构！</p><p id="798e" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">当然，有一个字体属性给出了关于字体的信息。但是这个不能存放和更换。因此，我们必须在幻灯片/形状/文本 _ 框架/段落/运行分析中更深入地修改文本，而不修改字体，并最终获得我们期望的结果。</p><p id="0b11" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我想说，尽管这是项目的终极挑战，但也是最难克服的。它需要理解<code class="fe nz oa ob oc b">runs</code>的概念，并仔细阅读 python-pptx 文档。因为它变得非常技术性，我把这个函数放在这里，以防你对它感兴趣，但是如果你不明白它是如何工作的，不要担心。</p><figure class="oe of og oh gt iv"><div class="bz fp l di"><div class="pd pe l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">替换 text_frame 文本而不影响字体属性</p></figure><blockquote class="oo"><p id="8bea" class="op oq jj bd or os pf pg ph pi pj ml dk translated">所以我们来了！我们漫长旅程的终点！还有最后一件事要做:从头开始运行所有这些！</p></blockquote></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h2 id="5464" class="nn kz jj bd la no np dn le nq nr dp li lz ns nt lk md nu nv lm mh nw nx lo ny bi translated">放在一起</h2><p id="b795" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们已经到了最后一步:使用我们构建的翻译器进行 PowerPoint 转换。我不会在这上面花太多时间，因为它只是我们到目前为止所看到的所有内容的组合，还做了一些重构。</p><figure class="oe of og oh gt iv"><div class="bz fp l di"><div class="pd pe l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">翻译 PowerPoint 文件</p></figure><h1 id="832b" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">结论</h1><p id="b697" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们已经看到了如何创建一个很好的工具来自动翻译 PowerPoint 文件，而不需要修改它们的外观，并且非常自信。尽管如此，请记住没有什么是完美的。因此，它不会阻止重新讲授输出，以检测最终的错误。事实上，DeepL 是一个非常强大的工具，但有时如果我们没有给它足够的上下文信息，它可能会产生近似的翻译。</p><p id="3d6e" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">该项目的一个关键成果是翻译部分，毫无疑问，它非常有用，对于所有涉及翻译的用例都是可重用的。</p><p id="4994" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">这也让我发现了 python-pptx 库，这是一个有趣而伟大的 PowerPoint 版本工具。</p><p id="9517" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">下一步，我们可以想象构建一个基本的 web 界面，包括上传区、目标语言下拉列表和翻译下载按钮。像<a class="ae jg" href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener ugc nofollow" target="_blank">烧瓶</a>或<a class="ae jg" href="http://dash.plotly.com/" rel="noopener ugc nofollow" target="_blank">破折号</a>这样的框架可以完成这项工作。</p><p id="acdd" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">最后，我希望你喜欢阅读那个故事/教程，就像我喜欢这个项目一样。意识到这一点比花几天时间翻译幻灯片有趣得多。请注意，所有代码都可以在我的 Github 上的<a class="ae jg" href="https://github.com/ThibaudLamothe/translate-pptx" rel="noopener ugc nofollow" target="_blank">这个库</a>中找到。如果你想使用它，请随意，不要犹豫让一个明星参与项目。当然，欢迎任何备注或建议:)！</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="dd59" class="pw-post-body-paragraph lq lr jj ls b lt mn kk lv lw mo kn ly lz mp mb mc md mq mf mg mh mr mj mk ml im bi translated">我要感谢我的同事和朋友<a class="px py ep" href="https://medium.com/u/221f83647c85?source=post_page-----3c01f81f113--------------------------------" rel="noopener" target="_blank"> Ismail Mebsout </a>，他刚刚发表了一堆关于<a class="ae jg" rel="noopener" target="_blank" href="/deep-learnings-mathematics-f52b3c4d2576">深度学习基础</a>的文章，并激励我发表了这第一篇帖子！</p></div></div>    
</body>
</html>