<html>
<head>
<title>Deep Learning with docker container from NGC — Nvidia GPU Cloud</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用NGC的docker容器进行深度学习——英伟达GPU云</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-learning-with-docker-container-from-ngc-nvidia-gpu-cloud-58d6d302e4b2?source=collection_archive---------15-----------------------#2020-01-08">https://towardsdatascience.com/deep-learning-with-docker-container-from-ngc-nvidia-gpu-cloud-58d6d302e4b2?source=collection_archive---------15-----------------------#2020-01-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9ec0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">有一个基本的复制粘贴操作指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/7592653978a344e8f39f1c52e564be27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*RkrWqhLUhr0iNpzncytP9w.jpeg"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">docker容器:)图片来自<a class="ae kr" href="https://pixabay.com/photos/container-port-loading-stacked-3118783/" rel="noopener ugc nofollow" target="_blank"> pixabay </a></p></figure><p id="3297" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">不再为深度学习环境的安装而烦恼。不再与Cuda版本和GCC编译器争斗。欢迎来到码头工人时代。你所需要的只是一个带有最新Cuda驱动程序的Unix系统。你只需要从NGC云下载一个docker，它包含了你需要的环境和所有的Cuda代码。</p><p id="e621" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">其实写完这个帖子，发现自己用的越来越多了。由于我的主要工作是对医疗(高度安全)数据进行深度学习，所以我大量使用dockers。当你必须在没有互联网的服务器上工作时(是的，没有<a class="ae kr" href="https://stackoverflow.com/" rel="noopener ugc nofollow" target="_blank"> StackOverflow </a>这很痛苦)，docker就是你的救星:)。您在正常环境中准备您的工作环境，然后您/系统管理员将其迁移到服务器。我现在正在探索的一个有趣的优势是用git库、手册等来丰富您的环境。我将在这里更新我发现的方法。</p><p id="c0a2" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这里我们将使用Python 3和TensorFlow 1.9，但也有带有Pytorch、Caffe、trained model等的dockers。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi lo"><img src="../Images/bbfb28ddb4927ad96cc7078a89c00172.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jdo1AIB0HzNBLnQYi1tryw.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated"><a class="ae kr" href="https://ngc.nvidia.com" rel="noopener ugc nofollow" target="_blank">英伟达云</a>图片来自英伟达云网站</p></figure><h1 id="bfca" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">获得自己的Nvidia Docker</h1><p id="5c07" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">转到<a class="ae kr" href="https://ngc.nvidia.com/catalog/all" rel="noopener ugc nofollow" target="_blank">https://ngc.nvidia.com/catalog/all</a>。选择“容器”标签，查看所有可用的容器。我选择了TensorFlow容器:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/83c3cb03f1ef3e0b0f82f254d97da6ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*ON9umkShiIsoD5-S-KDBTg.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated"><a class="ae kr" href="https://ngc.nvidia.com" rel="noopener ugc nofollow" target="_blank">Nvidia cloud上的TensorFlow容器</a></p></figure><p id="f1c3" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">可以直接从云端使用，用:<code class="fe mr ms mt mu b">nvcr.io/nvidia/tensorflow:</code> <code class="fe mr ms mt mu b">19.12-tf2-py3</code>一个TensorFlow2 docker。或者在您创建帐户并登录后下载它。</p><p id="4016" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">要下载TensorFlow2 docker，请使用pull命令:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="f2ac" class="mz lu iq mu b gy na nb l nc nd">docker pull nvcr.io/nvidia/tensorflow:20.10-tf2-py3</span></pre><p id="4654" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">下载docker需要一些时间。</p><h1 id="5615" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">启动docker容器</h1><p id="8780" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">列出所有可用的本地docker图像</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="a5db" class="mz lu iq mu b gy na nb l nc nd">$ sudo docker images</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi ne"><img src="../Images/41ca60ca57baa63b136b42ce71631eaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iukWQY0Fc2VgTATsGE_sCg.png"/></div></div></figure><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="a092" class="mz lu iq mu b gy na nb l nc nd"><strong class="mu ir">docker run --rm -it --runtime=nvidia --net=host -v &lt;local dir&gt;:&lt;destination dir&gt; &lt;Image id&gt;</strong></span></pre><p id="7847" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">例如，对于本地码头，使用:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="c542" class="mz lu iq mu b gy na nb l nc nd"><strong class="mu ir">docker run --rm -it --runtime=nvidia --net=host -v /my_server_dir/:/naomi </strong>989143febb16</span></pre><p id="2bb5" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">或者使用Nvidia cloud的docker:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="730b" class="mz lu iq mu b gy na nb l nc nd">docker run --gpus all -it --rm -v local_dir:container_dir nvcr.io/nvidia/tensorflow:19.12-tf2-py3</span></pre><p id="37d7" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">其中:</p><ul class=""><li id="138b" class="nf ng iq ku b kv kw ky kz lb nh lf ni lj nj ln nk nl nm nn bi translated"><code class="fe mr ms mt mu b">-it</code>表示以交互方式运行</li><li id="dc20" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated"><code class="fe mr ms mt mu b">--rm</code>完成后会删除容器</li><li id="964d" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated"><code class="fe mr ms mt mu b">-v</code>是挂载目录</li><li id="c5b4" class="nf ng iq ku b kv no ky np lb nq lf nr lj ns ln nk nl nm nn bi translated"><code class="fe mr ms mt mu b">local_dir</code>是您希望从容器内部访问的来自主机系统的目录或文件(绝对路径)。<code class="fe mr ms mt mu b">container_dir</code>是您在容器中时的目标目录。举个例子，</li></ul><p id="9ddc" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">比如下面路径中的<code class="fe mr ms mt mu b">local_dir</code>是<code class="fe mr ms mt mu b">/home/jsmith/data/mnist </code>，目标目录是:<code class="fe mr ms mt mu b">/data/mnist</code>。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="27ca" class="mz lu iq mu b gy na nb l nc nd">-v /home/jsmith/data/mnist:/data/mnist</span></pre><p id="613f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">例子取自:<a class="ae kr" href="https://ngc.nvidia.com/catalog/containers/nvidia:tensorflow" rel="noopener ugc nofollow" target="_blank">https://ngc.nvidia.com/catalog/containers/nvidia:tensorflow</a></p><h1 id="7eee" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">停止码头集装箱</h1><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="647a" class="mz lu iq mu b gy na nb l nc nd"># list running dockers:<br/>$ docker ps</span><span id="80c7" class="mz lu iq mu b gy nt nb l nc nd"># Find the docker container id, then run:</span><span id="fa4f" class="mz lu iq mu b gy nt nb l nc nd">docker kill &lt;container id&gt;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nu"><img src="../Images/03bacc9b80acb6ebf2dd30f7542c71d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zi2NM8-WNKSnH3rXmFFrjA.png"/></div></div></figure><h1 id="1db0" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">附加到正在运行的docker容器</h1><p id="9f04" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">当您想在docker中从外部运行一个命令时，您可以使用exec，它允许您告诉正在运行的docker运行一个特定的命令。例如，当您失去管理docker的命令行窗口时，您可以使用exec在docker中运行命令行环境。这样，您可以附加到正在运行的docker容器。例如，使用下面的命令在docker容器中创建一个shell。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="fe74" class="mz lu iq mu b gy na nb l nc nd"><strong class="mu ir">docker exec -it &lt;container id&gt; /bin/bash</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nv"><img src="../Images/6d8f26ba4e931628f466681014c55376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6YEfFNZHv01pHvm4mB80RQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nw"><img src="../Images/8f2500258b8c6455b9df210365b3f1b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dTTHhldWsHAE2dpLLVKCfw.png"/></div></div></figure><h1 id="1417" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">将包和数据添加到Docker容器中</h1><p id="f255" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">当您在docker容器“内部”时，您是在linux cmd空间中。比如可以用pip安装python包，也可以上传数据。这个选项对于在没有互联网的服务器上处理安全数据的人来说非常有用，就像我在医疗行业一样。这样你就可以准备好你需要的一切，然后提交并传输到你的封闭服务器上。</p><p id="e065" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">如果你使用Nvidia docker容器，它没有jupyter。您可以通过以下方式安装它:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="654f" class="mz lu iq mu b gy na nb l nc nd"><strong class="mu ir">pip install jupyter</strong></span></pre><h1 id="6bfb" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">在docker容器上运行Jupyter笔记本</h1><p id="a5a0" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">如果你在一个图形用户界面环境中，像RDP，你可以很容易地运行jupyter笔记本，只需做如下。如果您在服务器上只有cmd，就像在mobaxterm中一样，那么就需要更多的步骤，这些步骤是在前面几节中指定的。</p><p id="35ff" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">用以下命令启动笔记本:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="4381" class="mz lu iq mu b gy na nb l nc nd"><strong class="mu ir">jupyter notebook --ip 0.0.0.0 --allow-root</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nx"><img src="../Images/3b9db777ce3fa4a1e6c00be180770231.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nbB0OryN7Hyx7k5JQ9kU7w.png"/></div></div></figure><p id="b014" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在您的浏览器中，键入:<a class="ae kr" href="http://192.168.15.20/" rel="noopener ugc nofollow" target="_blank"> http:// &lt;服务器ip &gt; </a> :8888/？令牌= &lt;令牌&gt;。在我们的案例中:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="a04a" class="mz lu iq mu b gy na nb l nc nd"><a class="ae kr" href="http://192.168.15.20/" rel="noopener ugc nofollow" target="_blank">http://100.200.15.20</a>:8888/?token=2a0630188ca7bc5b99d2c5b7923e2a2ebe391bc15a4bc3f1</span></pre><p id="0a99" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">复制cmd中给出的令牌。</p><p id="bb93" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">如果端口8888被占用，或者有其他原因需要绑定端口，ise:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="7f19" class="mz lu iq mu b gy na nb l nc nd"><strong class="mu ir">jupyter-notebook --ip 0.0.0.0 --allow-root --port 5080</strong></span></pre><p id="ab6c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">然后使用地址:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="a84c" class="mz lu iq mu b gy na nb l nc nd"><a class="ae kr" href="http://192.168.15.20/" rel="noopener ugc nofollow" target="_blank">http://100.200.15.20</a>:<strong class="mu ir">5080</strong>/?token=2a0630188ca7bc5b99d2c5b7923e2a2ebe391bc15a4bc3f1</span></pre><p id="8c38" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">或者</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="0e10" class="mz lu iq mu b gy na nb l nc nd"><a class="ae kr" href="http://192.168.15.20/" rel="noopener ugc nofollow" target="_blank">http://</a><strong class="mu ir">0.0.0.0</strong>:<strong class="mu ir">5080</strong>/?token=2a0630188ca7bc5b99d2c5b7923e2a2ebe391bc15a4bc3f1</span></pre><p id="03da" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">使用笔记本安装软件包和其他后端人员非常方便。就用！命令行的开头，并在单独的单元格中运行每个命令行。例如:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="4643" class="mz lu iq mu b gy na nb l nc nd">! pip install keras</span></pre><p id="3dc9" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">要在docker映像中保存您的安装，不要忘记提交docker。</p><h1 id="7cab" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">提交码头工人</h1><p id="0acc" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">提交一个docker，将为您的所有安装创建一个新的docker。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="c660" class="mz lu iq mu b gy na nb l nc nd">docker commit &lt;docker container id&gt; &lt;new docker name&gt;:&lt;docker tag&gt;</span></pre><p id="49fd" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">例如，使用以下命令提交docker:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="1bb7" class="mz lu iq mu b gy na nb l nc nd">docker commit   9571cb71d812 naomi/brats:version2</span></pre><p id="0ea0" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">将创建一个docker映像，运行“docker images”时将如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi ny"><img src="../Images/8156101a17a68fde3913deda269ba90b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M-OF8xK1hun_SPxHVoT3dg.png"/></div></div></figure><h1 id="a1a6" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">Docker —基本摘要</h1><p id="6220" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">一篇没有复制粘贴的文章有什么价值呢:)</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="3afc" class="mz lu iq mu b gy na nb l nc nd"><strong class="mu ir"># run<br/>docker run --rm -it --runtime=nvidia --net=host -v &lt;local dir&gt;:&lt;destination dir&gt; &lt;docker Image id&gt;</strong></span><span id="94be" class="mz lu iq mu b gy nt nb l nc nd"><strong class="mu ir"># list available dockers<br/>docker images</strong></span><span id="02bd" class="mz lu iq mu b gy nt nb l nc nd"><strong class="mu ir"># list running docker<br/>docker ps</strong></span><span id="34e0" class="mz lu iq mu b gy nt nb l nc nd"><strong class="mu ir"># attach to a running docker<br/>docker exec -it &lt;container id&gt; /bin/bash</strong></span><span id="2bac" class="mz lu iq mu b gy nt nb l nc nd"><strong class="mu ir"># run notebook<br/>jupyter notebook --ip 0.0.0.0 --allow-root</strong></span><span id="8daa" class="mz lu iq mu b gy nt nb l nc nd"><strong class="mu ir"># commit a docker<br/>docker commit &lt;docker container id&gt; &lt;new docker name&gt;</strong></span></pre><p id="c23d" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">更多关于使用dockers和每个标志的含义的解释可以在这里找到:<a class="ae kr" href="https://ngc.nvidia.com/catalog/containers/nvidia:tensorflow" rel="noopener ugc nofollow" target="_blank">https://ngc.nvidia.com/catalog/containers/nvidia:tensorflow</a></p><p id="0d54" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">下面是一些不太常见但却是必需的场景。</p><h1 id="6c0c" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">从Mobaxterm运行Jupyter笔记本</h1><p id="7b4e" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">这个想法是在cmd上运行jupyter命令，并在本地机器上打开笔记本。这需要ssh隧道，如下所述:</p><p id="a10d" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir"> Windows端</strong>首先，生成ssh密钥:<a class="ae kr" href="https://phoenixnap.com/kb/generate-ssh-key-windows-10" rel="noopener ugc nofollow" target="_blank">https://phoenixnap.com/kb/generate-ssh-key-windows-10</a>，这个过程会在你的本地电脑上创建一个文件。</p><p id="d33a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir"> Mobaxterm端</strong>打开隧道菜单来定义你的隧道。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nz"><img src="../Images/023566917122a6f76600ded0b9d390e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w9tfF2VLBTlQatsjF7GeeQ.png"/></div></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">Mobaxterm ssh隧道</p></figure><p id="ddbe" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">假设你的远程服务器是52.522.52.522，你的用户名是<code class="fe mr ms mt mu b">naomi</code>，你选择了1200作为端口(你可以选择任意一个antaken号)，填写下面，保存。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi oa"><img src="../Images/693c2b10105e57c4bd8f51fd65802595.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ukeI9WuU3yH0a3CGMf-Xhg.png"/></div></div></figure><p id="781f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">保存并添加您之前创建的ssh密钥，在密钥图标中:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/0ca883a378380c7346b7ba4f5f58079f.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*SjEQbJxuhqHZQrN5t2FNMA.png"/></div><p class="kn ko gj gh gi kp kq bd b be z dk translated">为隧道和ssh会话添加ssh密钥</p></figure><p id="c700" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">窗口端</strong>在Powershell中以管理员身份运行以下命令</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="f91e" class="mz lu iq mu b gy na nb l nc nd"><strong class="mu ir">ssh -NL 1200:localhost:1200 naomi@</strong>52.522.52.522</span></pre><p id="856b" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir"> Mobaxterm side </strong>在Mobaxterm cmd窗口中运行以下命令:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="4972" class="mz lu iq mu b gy na nb l nc nd">jupyter notebook — no-browser — port 1200</span></pre><p id="32aa" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">将您从输出中获得的地址复制到本地windows机器上的chrome或类似设备中，您就可以在笔记本中工作了:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="cb23" class="mz lu iq mu b gy na nb l nc nd"><a class="ae kr" href="http://127.0.0.1:1250/?token=36401f7dada8b4cb5eb2d15b70ac3e4963633e7dd5b922d1" rel="noopener ugc nofollow" target="_blank">http://127.0.0.1:1200/?token=36401f7dada8b4cb5eb2d15b70ac3e4963633e7dd5b922d1</a></span></pre><h1 id="361f" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">重新连接到正在运行的Jupyter笔记本</h1><p id="117c" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">深度学习训练通常需要很长时间。因此，在大多数情况下，当在远程服务器上工作时，连接被关闭，笔记本的令牌丢失。要查找正在运行的笔记本的令牌，请执行以下操作:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="fad8" class="mz lu iq mu b gy na nb l nc nd"># use -mtime -30 to list only notebooks that started in the last 30 days.</span><span id="dd13" class="mz lu iq mu b gy nt nb l nc nd">find `jupyter --runtime-dir` -mtime -30 | grep nbserver | xargs cat</span></pre><p id="49aa" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">您将看到如下内容:</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="2fb2" class="mz lu iq mu b gy na nb l nc nd">...<br/>&lt;body&gt;</span><span id="1683" class="mz lu iq mu b gy nt nb l nc nd">&lt;p&gt;<br/>    This page should redirect you to Jupyter Notebook. If it doesn't,<br/>    &lt;a href="<a class="ae kr" href="http://0.0.0.0:8888/tree?token=7caaccce4fb4e670d9053b67c773e93c4a6ceb128fde2f56" rel="noopener ugc nofollow" target="_blank">http://0.0.0.0:8888/tree?token=7caaccce4fb4e670d9053b67c773e93c4a6ceb128fde2f56</a>"&gt;click here to go to Jupyter&lt;/a&gt;.<br/>&lt;/p&gt;<br/>...</span></pre><p id="daf4" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">只需将地址(将0.0.0.0更改为您的服务器IP或localhost)复制到您的浏览器，即可重新打开正在运行的笔记本。</p><h1 id="ced2" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">用户问题</h1><p id="3744" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">在docker容器中，你是你的王国的国王，你是根用户，我猜这是安装所需要的。即使您没有root密码，您编写的文件也会在磁盘上获得root所有权。删除您在容器中创建的文件只能通过root密码或docker来完成。我还没想明白。如有真知灼见，不胜感激。</p><h1 id="d1f9" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">安装Docker引擎</h1><p id="f0a2" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">如果您需要安装新的docker引擎，请遵循此处的说明<a class="ae kr" href="https://docs.docker.com/engine/install/ubuntu/" rel="noopener ugc nofollow" target="_blank"/>。为了方便起见，我将添加推荐方法的简短摘要。</p><h2 id="c91f" class="mz lu iq bd lv oc od dn lz oe of dp md lb og oh mf lf oi oj mh lj ok ol mj om bi translated">使用存储库安装</h2><p id="d184" class="pw-post-body-paragraph ks kt iq ku b kv ml jr kx ky mm ju la lb mn ld le lf mo lh li lj mp ll lm ln ij bi translated">对于主机:焦点Ubuntu 20.04 LTS，版本:20.04。x86_64 / amd64。</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="cc59" class="mz lu iq mu b gy na nb l nc nd"># <!-- -->Set up the repository<br/>$ sudo apt-get update<br/>$ sudo apt-get install \<br/>    apt-transport-https \<br/>    ca-certificates \<br/>    curl \<br/>    gnupg-agent \<br/>    software-properties-common</span><span id="af8d" class="mz lu iq mu b gy nt nb l nc nd"># <!-- -->Add Docker’s official GPG key:<br/>$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</span><span id="fee7" class="mz lu iq mu b gy nt nb l nc nd"># set up the <strong class="mu ir">stable</strong> repository<br/>$ sudo add-apt-repository \<br/>   "deb [arch=amd64] https://download.docker.com/linux/ubuntu \<br/>   $(lsb_release -cs) \<br/>   stable"</span></pre><h2 id="1966" class="mz lu iq bd lv oc od dn lz oe of dp md lb og oh mf lf oi oj mh lj ok ol mj om bi translated">安装Docker引擎</h2><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="8cc3" class="mz lu iq mu b gy na nb l nc nd">$ sudo apt-get update<br/>$ sudo apt-get install docker-ce docker-ce-cli containerd.io</span></pre><p id="97b1" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">启动docker守护进程</p><pre class="kg kh ki kj gt mv mu mw mx aw my bi"><span id="c4ea" class="mz lu iq mu b gy na nb l nc nd">sudo dockerd</span></pre></div></div>    
</body>
</html>