<html>
<head>
<title>SQL Case Study: Investigating a Drop in User Engagement</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL案例研究:调查用户参与度的下降</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sql-case-study-investigating-a-drop-in-user-engagement-510b27d0cbcc?source=collection_archive---------14-----------------------#2020-05-21">https://towardsdatascience.com/sql-case-study-investigating-a-drop-in-user-engagement-510b27d0cbcc?source=collection_archive---------14-----------------------#2020-05-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f035" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">现实生活中的数据分析师案例研究</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1b26f75bfcc9e28153e7524fd3edba3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jiYA3NC1O3-x-80WlBy40w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1445489" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>的Gerd Altmann 提供</p></figure><h1 id="e71c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">目录</h1><ol class=""><li id="d945" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">问题</li><li id="6204" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">集思广益潜在原因</li><li id="9ad5" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">数据</li><li id="0440" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">分析:事件级聚合</li><li id="0402" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">分析:用户级聚合</li><li id="1dc1" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">分析:按地理位置划分的参与度</li><li id="def2" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">分析:电子邮件活动和点击率</li><li id="21ba" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">分析:按设备划分的点击率</li><li id="5496" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">分析:每周文摘与重新参与电子邮件</li><li id="ed69" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">摘要</li><li id="36c6" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">建议</li><li id="d7aa" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">进一步的步骤</li></ol></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="1d84" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">问题</h1><p id="b6b7" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated"><em class="nn">这个案例可以在这里找到</em><a class="ae ky" href="https://mode.com/sql-tutorial/sql-data-types/" rel="noopener ugc nofollow" target="_blank"><em class="nn"/></a><em class="nn">如果你想自己尝试或者跟随。</em></p><p id="4e23" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">Yammer是一个与同事交流的社交网络。个人通过在群组中发布来共享文档、更新和想法。Yammer可以无限期免费使用，但如果公司希望获得管理控制，包括与ActiveDirectory等用户管理系统的集成，则必须支付许可费。</p><p id="c5c3" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">Yammer注意到每周活跃用户数下降，“从当天开始的一周内至少记录一次参与事件的用户数”。<strong class="lt iu">约定</strong>定义为通过与产品交互进行某种类型的服务器调用(在数据中显示为“约定”类型的事件)。</p><p id="0884" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">我的目标是确定下图中下降的原因。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/b0cc4dc827620350ca71235a40e71ab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GacENutrIjKPEzC21r3_bQ.png"/></div></div></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="22c6" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">集思广益潜在原因</h1><p id="339f" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">敬业度下降的潜在原因包括:</p><ul class=""><li id="56c6" class="lr ls it lt b lu no lw np ly nu ma nv mc nw me nx mg mh mi bi translated"><strong class="lt iu">产品相关问题</strong>。产品中可能有一个缺陷，阻止了用户使用该产品。同样，Yammer可能在8月初发布了一个产品更新，但有相当一部分用户不喜欢。</li><li id="a5a9" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated"><strong class="lt iu">一年的时间</strong>。八月可能只是一个有很多用户去度假的月份。如果很大一部分用户是父母，这种情况可能会发生，因为他们倾向于在9月开学前度假。</li><li id="3333" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated"><strong class="lt iu">竞争对手</strong>。可能是竞争对手在8月初推出了竞争产品，或者竞争对手发布了现有产品的重大更新，导致用户流失。</li><li id="69ae" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">没有正确跟踪数据。有可能是数据管道没有工作，因此数据没有被正确跟踪。这是内部引起的问题，需要数据工程师的帮助来解决。</li><li id="56f5" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated"><strong class="lt iu">营销事件。</strong>当推出大型促销活动时，公司会因为提供的折扣而吸引低质量的客户，这是正常的。因此，8月份的下跌有可能是7月份一次大型营销活动的后遗症。</li></ul></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="1cdb" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">数据</h1><h2 id="4d24" class="ny la it bd lb nz oa dn lf ob oc dp lj ly od oe ll ma of og ln mc oh oi lp oj bi translated">表1:用户</h2><p id="2727" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">每行代表一个用户，信息与每个用户相关联。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/e1e55ae151da904047eae7088998840d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*t2zfd6Ul4Q6-J9xZlrBG8g.png"/></div></figure><h2 id="ef3d" class="ny la it bd lb nz oa dn lf ob oc dp lj ly od oe ll ma of og ln mc oh oi lp oj bi translated">表2:事件</h2><p id="5f7d" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">每行代表一个事件，这是用户在Yammer上执行的一个操作。这些事件包括登录事件、消息事件、搜索事件、用户通过注册漏斗时记录的事件，以及与收到的电子邮件相关的事件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/f87a35a36b1fee4aae4719afd63ae132.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*gav32EOvlZMODysrs84QXA.png"/></div></figure><h2 id="311c" class="ny la it bd lb nz oa dn lf ob oc dp lj ly od oe ll ma of og ln mc oh oi lp oj bi translated">表3:电子邮件事件</h2><p id="7937" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">此表包含与已发送电子邮件相关的事件数据。它在结构上类似于上面的事件表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/42f3edcb51b8df79c4f24cd6893465c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*HUkXLDO211I7Y_QzcJdqLg.png"/></div></figure><h2 id="036a" class="ny la it bd lb nz oa dn lf ob oc dp lj ly od oe ll ma of og ln mc oh oi lp oj bi translated">表4:累计期间</h2><p id="2186" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">最后一个表是用于创建滚动时间段的查找表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/990eb9cb75f9df4e567de607946cc7b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*b_3Nv8ybZZ5uMz02IRJFLQ.png"/></div></figure></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="3b0f" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">分析</h1><h2 id="72d2" class="ny la it bd lb nz oa dn lf ob oc dp lj ly od oe ll ma of og ln mc oh oi lp oj bi translated">事件级聚合</h2><p id="1ad0" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">我想看的第一件事是什么事件被归类为“参与”。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="668e" class="ny la it oo b gy os ot l ou ov">SELECT DISTINCT event_name, event_type<br/>FROM tutorial.yammer_events<br/>ORDER BY event_type, event_name ASC</span></pre><p id="aa67" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">归类为“参与”的事件如下:</p><ul class=""><li id="3d40" class="lr ls it lt b lu no lw np ly nu ma nv mc nw me nx mg mh mi bi translated">主页</li><li id="369b" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">喜欢_消息</li><li id="3485" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">注册</li><li id="df91" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">搜索_自动完成</li><li id="0ece" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">搜索_点击_结果_1</li><li id="43df" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">搜索_点击_结果_2</li><li id="527d" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">搜索_点击_结果_3</li><li id="84b1" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">搜索_点击_结果_4</li><li id="1caf" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">搜索_点击_结果_5</li><li id="2cc8" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">搜索_点击_结果_6</li><li id="1d76" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">搜索_点击_结果_7</li><li id="8d4b" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">搜索_点击_结果_8</li><li id="9e40" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">搜索_点击_结果_9</li><li id="9a23" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">search_click_result_10</li><li id="e94e" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">搜索_运行</li><li id="7180" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">发送消息</li><li id="2bb6" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">查看_收件箱</li></ul><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="9126" class="ny la it oo b gy os ot l ou ov">with one as (<br/>SELECT <br/>  EXTRACT('month' FROM occurred_at) as month,<br/>  count(event_name) as event_count<br/>FROM tutorial.yammer_events<br/>GROUP BY<br/>  month<br/>)</span><span id="f0cd" class="ny la it oo b gy ow ot l ou ov">SELECT <br/>  *,<br/>  (event_count - LAG(event_count) OVER (ORDER BY month ASC)) as diff<br/>FROM one</span></pre><p id="7da8" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">使用上面的查询，我们可以推断出7月和8月之间的雇佣差异是18，037。</p><p id="b1ac" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">我想做的下一件事是逐月统计每个“参与”事件的发生次数，看看是否有任何重大事件导致了7月28日之后的下降。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="96c5" class="ny la it oo b gy os ot l ou ov">with two as (<br/>with one as (<br/>SELECT <br/>  CONCAT( EXTRACT('month' FROM occurred_at), '-', EXTRACT('year' FROM occurred_at)) as month_year,<br/>  event_name,<br/>  count(event_name) as event_count<br/>FROM tutorial.yammer_events<br/>WHERE event_type = 'engagement'<br/>GROUP BY<br/>  event_name,<br/>  month_year<br/>)<br/>SELECT <br/>  *,<br/>  CASE<br/>    WHEN month_year = '5-2014'<br/>      THEN 0<br/>    WHEN month_year != '5-2014'<br/>     THEN (event_count - LAG(event_count) OVER (ORDER BY event_name ASC, month_year ASC))<br/>    ELSE NULL END AS abs_change<br/>FROM one<br/>)<br/>SELECT *<br/>FROM two<br/>WHERE<br/>  month_year = '8-2014'<br/>  AND abs_change &lt; 0<br/>ORDER BY abs_change asc</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/d6fbcee9a7c6d8e9759e45150e7f9c03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*RK4dVzhpb4Cc7JgEDEb2wg.png"/></div></figure><p id="6a52" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">参与度的下降主要归因于主页、like_message_ view_inbox、send_message和登录。似乎所有这些事件的减少都与用户登录减少有关。</p><p id="e273" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">接下来，我想在用户层面上分析数据，看看这种下降是由于用户数量的下降还是由于每用户参与次数的下降。</p><h2 id="848b" class="ny la it bd lb nz oa dn lf ob oc dp lj ly od oe ll ma of og ln mc oh oi lp oj bi translated">用户级聚合</h2><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="8028" class="ny la it oo b gy os ot l ou ov">SELECT<br/>  EXTRACT('month' from occurred_at) as month,<br/>  count(DISTINCT user_id) as num_users<br/>FROM tutorial.yammer_events<br/>WHERE event_type = 'engagement'<br/>GROUP BY month</span></pre><p id="d34e" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">使用上面的代码，我发现了每月活跃用户的数量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/23d9e160f025175c34082fd55e6488f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*aqcQUfT8QXJ9d1NI8mZj5A.png"/></div></figure><p id="75a6" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">我们可以看到用户数量从7月份的3058下降到8月份的2795，下降了8.6%。这可能是参与度事件下降的原因，特别是主页、like_message、view_inbox、send_message和login。</p><p id="8051" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">我还观察了每个用户的参与度是否也下降了。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="93be" class="ny la it oo b gy os ot l ou ov">SELECT<br/>  EXTRACT('month' from occurred_at) as month,<br/>  count(event_name) as num_events,<br/>  count(DISTINCT user_id) as num_users,<br/>  count(event_name)/count(DISTINCT user_id) as events_per_user<br/>FROM tutorial.yammer_events<br/>WHERE event_type = 'engagement'<br/>GROUP BY month</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/05b7fcea61d687323a2bfe9623d6d3dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*Y05tarNLlxG4UZwvuB1e7g.png"/></div></figure><p id="d80f" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">每个用户的活动数量从30个下降到26个，这意味着参与度下降了13%，这也是一个相当大的数字。</p><p id="749e" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">因此，我们需要找出为什么活跃用户数量下降，以及每个用户的参与度下降。</p><h2 id="4784" class="ny la it bd lb nz oa dn lf ob oc dp lj ly od oe ll ma of og ln mc oh oi lp oj bi translated">电子邮件活动和点击率</h2><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="e3c9" class="ny la it oo b gy os ot l ou ov">SELECT<br/>  action,<br/>  EXTRACT('month' FROM occurred_at) AS month,<br/>  count(action) as num_emails<br/>FROM tutorial.yammer_emails<br/>GROUP BY<br/>action, month<br/>ORDER BY<br/>action, month</span></pre><p id="e8ad" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">我想对电子邮件活动进行汇总，看看发送的电子邮件、点击率(CTR)或其他可能导致非活跃用户减少的因素是否有所变化。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/167886fdfc447ffb54f83995a4f44b52.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*6jnItScE7qvSeASjqVMqcA.png"/></div></figure><p id="673f" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">很快，我注意到发送的邮件数量(每周摘要和重新参与)和打开的邮件数量稳步增长，但点击率有所下降。从7月到8月，打开的电子邮件增加了6.5%，但点击率下降了27%。</p><h2 id="c937" class="ny la it bd lb nz oa dn lf ob oc dp lj ly od oe ll ma of og ln mc oh oi lp oj bi translated">按设备划分的点击率</h2><p id="4626" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">我想更深入地了解点击率，看看这种下降是否与设备有关。这可能与操作系统的类型(IOS对Android)或移动对桌面有关。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="ad8c" class="ny la it oo b gy os ot l ou ov">with emails as(<br/>SELECT <br/>  *,<br/>  CONCAT(EXTRACT('day' FROM occurred_at), '-', EXTRACT('month' FROM occurred_at), '-',  EXTRACT('year' FROM occurred_at)) as date,<br/>  EXTRACT('month' FROM occurred_at) as month<br/>FROM tutorial.yammer_emails emails<br/>), events as (<br/>  SELECT DISTINCT <br/>    user_id,<br/>    CONCAT(EXTRACT('day' FROM occurred_at), '-', EXTRACT('month' FROM occurred_at), '-',  EXTRACT('year' FROM occurred_at)) as date,<br/>    device,<br/>    EXTRACT('month' FROM occurred_at) as month<br/>  FROM tutorial.yammer_events<br/>  ORDER BY user_id ASC<br/>)<br/>SELECT <br/>  device,<br/>  emails.month,<br/>  count(emails.user_id)<br/>FROM emails<br/>LEFT JOIN events ON<br/>  emails.user_id = events.user_id<br/>  AND emails.date = events.date<br/>WHERE action = 'email_clickthrough'<br/>GROUP BY device, emails.month</span></pre><p id="c3cc" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">使用上面的查询，我注意到从7月到8月，笔记本电脑和电脑的点击率保持稳定，但平板电脑和手机的点击率不稳定。</p><p id="da6d" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">通过将设备名称分为“手机”、“平板电脑”和“笔记本电脑”，我可以确定这是否属实。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="add7" class="ny la it oo b gy os ot l ou ov">with emails as(<br/>SELECT <br/>  *,<br/>  CONCAT(EXTRACT('day' FROM occurred_at), '-', EXTRACT('month' FROM occurred_at), '-',  EXTRACT('year' FROM occurred_at)) as date,<br/>  EXTRACT('month' FROM occurred_at) as month<br/>FROM tutorial.yammer_emails emails<br/>), events as (<br/>  SELECT DISTINCT <br/>    user_id,<br/>    CONCAT(EXTRACT('day' FROM occurred_at), '-', EXTRACT('month' FROM occurred_at), '-',  EXTRACT('year' FROM occurred_at)) as date,<br/>    device,<br/>    EXTRACT('month' FROM occurred_at) as month<br/>  FROM tutorial.yammer_events<br/>  ORDER BY user_id ASC<br/>)<br/>SELECT <br/>  CASE<br/>    WHEN device IN ('amazon fire phone', 'nexus 10', 'iphone 5', 'nexus 7', 'iphone 5s', 'nexus 5', 'htc one', 'iphone 4s', 'samsung galaxy note', 'nokia lumia 635', 'samsung galaxy s4') THEN 'mobile'<br/>    WHEN device IN ('ipad mini', 'samsung galaxy tablet', 'kindle fire', 'ipad air') THEN 'tablet_ipad'<br/>    WHEN device IN ('dell inspiron desktop', 'macbook pro', 'asus chromebook', 'windows surface', 'macbook air', 'lenovo thinkpad', 'mac mini', 'acer aspire desktop', 'acer aspire notebook', 'dell inspiron notebook', 'hp pavilion desktop') THEN 'laptop_comp'<br/>    ELSE null end as device_type,<br/>  emails.month,<br/>  count(emails.user_id)<br/>FROM emails<br/>LEFT JOIN events ON<br/>  emails.user_id = events.user_id<br/>  AND emails.date = events.date<br/>WHERE action = 'email_clickthrough'<br/>GROUP BY device_type, emails.month</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/51351b1268bcae34f4ce2a7a75596602.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*rfeZIP6ZWa3tdK-rXyebFQ.png"/></div></figure><p id="d626" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">事实上，点击率的下降似乎特别归因于移动设备和平板电脑。</p><h2 id="7ded" class="ny la it bd lb nz oa dn lf ob oc dp lj ly od oe ll ma of og ln mc oh oi lp oj bi translated">每周文摘vs再次接洽电子邮件</h2><p id="65fe" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">到目前为止，我认为缺乏参与的原因是7月到8月电子邮件点击率的下降。为了收集更多的信息，我想看看我们是否可以通过电子邮件类型进一步缩小问题的范围。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="4653" class="ny la it oo b gy os ot l ou ov">with one as (<br/>SELECT <br/>  *,<br/>  EXTRACT('month' from occurred_at) as month,<br/>  CASE WHEN (LEAD(action, 1) OVER (PARTITION BY user_id ORDER BY occurred_at ASC)) = 'email_open' THEN 1 ELSE 0 END AS opened_email,<br/>  CASE WHEN (LEAD(action, 2) OVER (PARTITION BY user_id ORDER BY occurred_at ASC)) = 'email_clickthrough' THEN 1 ELSE 0 END AS clicked_email<br/>FROM<br/>  tutorial.yammer_emails<br/>)</span><span id="0c24" class="ny la it oo b gy ow ot l ou ov">SELECT <br/>  action,<br/>  month,<br/>  count(action),<br/>  sum(opened_email) as num_open,<br/>  sum(clicked_email) as num_clicked<br/>FROM<br/>  one<br/>WHERE action in ('sent_weekly_digest','sent_reengagement_email')<br/>GROUP BY<br/>  action,<br/>  month<br/>ORDER BY<br/>  action,<br/>  month</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/31d33eb977f7386bffb39b3a39dcd377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n6NptCSdurriyvMra4I1_Q.png"/></div></div></figure><p id="381e" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">很明显，点击率的下降是由于每周摘要邮件，而不是重新参与电子邮件。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="74ec" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">摘要</h1><p id="7142" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">通过我的分析，我可以得出以下结论:</p><p id="f928" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">参与度的下降主要归因于五个参与度事件(主页、like_message_ view_inbox、send_message和登录)的下降。</p><p id="625d" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">然后，我发现事件的减少是由总活跃用户MoM的减少以及每个用户参与度的降低引起的。</p><p id="c8c9" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">在我查看了电子邮件表之后，我注意到从7月到8月，尽管打开的电子邮件数量有所增加，但点击率却显著下降。</p><p id="c979" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">通过按设备类型(手机、平板电脑、笔记本电脑)划分点击率，我注意到点击率的下降归因于手机和平板电脑设备。</p><p id="b512" class="pw-post-body-paragraph na nb it lt b lu no ju nc lw np jx nd ly nq nf ng ma nr ni nj mc ns nl nm me im bi translated">最后，点击率的下降归因于每周摘要电子邮件，而不是重新参与电子邮件。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="d2b7" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">建议</h1><p id="19cc" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">我的建议是立即深入查看专门针对移动设备和平板电脑的每周摘要邮件。这可能是一个技术问题，让用户很难点击电子邮件，或者只是一个UX问题，即电子邮件的内容和布局无法吸引用户点击。一个好的第一步是看看从7月到8月发生了什么变化，并向后追溯。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="7fd0" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">进一步分析</h1><p id="d290" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated">其他一些可以考虑的因素包括:</p><ul class=""><li id="a8a3" class="lr ls it lt b lu no lw np ly nu ma nv mc nw me nx mg mh mi bi translated">查看变化是否归因于少数用户(Pareo原则)</li><li id="8962" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">群组分析，了解原因是否是由于用户生命周期短</li><li id="3aca" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">按语言分析</li><li id="4890" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me nx mg mh mi bi translated">按地理分析</li></ul></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="e7cc" class="kz la it bd lb lc mv le lf lg mw li lj jz mx ka ll kc my kd ln kf mz kg lp lq bi translated">感谢阅读！</h1><h2 id="2e05" class="ny la it bd lb nz oa dn lf ob oc dp lj ly od oe ll ma of og ln mc oh oi lp oj bi translated">特伦斯·申</h2><p id="431b" class="pw-post-body-paragraph na nb it lt b lu lv ju nc lw lx jx nd ly ne nf ng ma nh ni nj mc nk nl nm me im bi translated"><em class="nn"/><a class="ae ky" href="https://shintwin.com/" rel="noopener ugc nofollow" target="_blank"><em class="nn">ShinTwin</em></a><em class="nn">|让我们连线上</em> <a class="ae ky" href="https://www.linkedin.com/in/terenceshin/" rel="noopener ugc nofollow" target="_blank"> <em class="nn"> LinkedIn </em> </a></p></div></div>    
</body>
</html>