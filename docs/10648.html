<html>
<head>
<title>3 Pandas Trick to Easing Your Data Life</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">3 只熊猫让你的数据生活变得轻松</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-pandas-trick-to-easing-your-data-life-984a0dac5311?source=collection_archive---------32-----------------------#2020-07-25">https://towardsdatascience.com/3-pandas-trick-to-easing-your-data-life-984a0dac5311?source=collection_archive---------32-----------------------#2020-07-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6bac" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你可以在日常工作中运用的一些熊猫技巧</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/aa1a4004df3657d29e38b5e21dbc0ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RSBPuvvrm9lgtF-F"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@echogrid?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">回声网格</a>拍摄</p></figure><p id="6d33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名数据科学家，我们的日常工作包括提取数据、理解数据、清理数据、转换数据和创建新功能。注意我没有包括创建一个机器学习模型？因为创建一个模型将是我们做的最后一件事，它不一定是我们的日常工作。然而，清理数据是日常工作。</p><p id="1ee0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基于以上原因，我想向你展示三个漂亮的熊猫技巧，让你的数据工作变得更简单。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="4498" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.使用查询进行数据选择</h1><p id="06e7" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">作为数据科学家，数据选择是最基本的活动，但也是最麻烦的事情之一，尤其是在重复进行的时候。让我给你看一个例子。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="9c16" class="ne md it na b gy nf ng l nh ni">#Let's use a dataset example<br/>import pandas as pd<br/>import seaborn as sns</span><span id="a6ee" class="ne md it na b gy nj ng l nh ni">mpg = sns.load_dataset('mpg')<br/>mpg.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/34f3eb02f4fd9bdc26fd7e15a7a6ca19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WEqxKCz1xwuRj0qMePVJIw.png"/></div></div></figure><p id="efef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面是我们的数据集示例，假设我想选择 mpg 小于 11 或马力小于 50 且 model_year 等于 73 的行。这意味着我需要像下面这样写代码。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="a8fb" class="ne md it na b gy nf ng l nh ni">mpg[(mpg['mpg'] &lt; 11) | (mpg['horsepower'] &lt;50) &amp; (mpg['model_year'] ==73)]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/b0ca2e7ac1c7306cdda7d282d059596b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EhnkftkItJjnCpNCs9HVqQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">典型数据选择方法结果</p></figure><p id="0830" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是选择数据的通常方式，但有时因为条件太多而很麻烦。在这种情况下，我们可以使用来自 Pandas 数据框对象的<strong class="lb iu">查询方法</strong>。</p><p id="91ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么，这个查询方法是什么呢？这是一种从熊猫数据框中选择的更人性化的方法。下面让我给你看一个例子。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="b845" class="ne md it na b gy nf ng l nh ni">mpg.query('mpg &lt; 11 or horsepower &lt; 50 and model_year == 73')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/b0ca2e7ac1c7306cdda7d282d059596b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EhnkftkItJjnCpNCs9HVqQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">查询方法的结果</p></figure><p id="0953" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果和平时的选拔方式一模一样吧？唯一的区别是，对于查询，我们有一个不太冗长的条件，我们将它写在字符串中，其中查询方法接受字符串英语单词，如示例中所示。</p><p id="7fe4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常的选择方法和查询方法的另一个简单区别是执行时间。让我们看看下面的例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/04c70d9a7cc1c2458ac611653fd4a7df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fWNlMb3QcTnwtWzPIrjCMQ.png"/></div></div></figure><p id="0c36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常的选择方法需要 18ms，查询方法执行代码需要 13ms。在这种情况下，查询方法是一种更快的选择方法。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3a96" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">2.用替换、掩码和 where 替换值</h1><p id="a706" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当我们处理数据时，我确信有时需要用其他特定值替换列中的一些值。如果我们手动操作，可能会很麻烦。让我们说，在我的 mpg 数据集之前，我想取代所有的气缸整数值到一个字符串值。我举个例子，说明如何手动替换。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="846e" class="ne md it na b gy nf ng l nh ni">def change_value(x):<br/>    if x == 3:<br/>        return 'Three'<br/>    elif x == 4:<br/>        return 'Four'<br/>    elif x == 5:<br/>        return 'Five'<br/>    elif x == 6:<br/>        return 'Six'<br/>    else:<br/>        return 'Eight'</span><span id="ff36" class="ne md it na b gy nj ng l nh ni">mpg['cylinders'] = mpg['cylinders'].apply(change_value) <br/>   <br/>mpg.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/beb4db75f4f0cc90b1e111cb8defd039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KzhriIWsvVMKGRgamhHhJg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用函数替换值的结果表</p></figure><p id="1601" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在最简单的情况下，我们需要使用 Pandas 数据框对象中的 apply 方法，或者您可以使用 for 循环方法手动完成。无论哪种方式，每次需要替换一个值时都要这么做，这很麻烦。</p><p id="ff6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我们可以使用 Pandas 数据框对象中的<strong class="lb iu">替换方法</strong>。这是一种专门用来帮助我们替换数据框中特定值的方法。下面让我给你看一个例子。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="dfe5" class="ne md it na b gy nf ng l nh ni">mpg.replace({'cylinders' : {3: 'Three', 4: 'Four', 5: 'Five', 6: 'Six', 8 : 'Eight'}}, inplace = True)</span><span id="b53e" class="ne md it na b gy nj ng l nh ni">mpg.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/beb4db75f4f0cc90b1e111cb8defd039.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KzhriIWsvVMKGRgamhHhJg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用 replace 方法替换值的结果表</p></figure><p id="86d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果是一样的，唯一的区别是我们用来替换值的行有多短。在我上面的例子中，我使用 dictionary 对象来指定我想要替换哪些列的值，并使用字典中的另一个字典来选择我想要替换哪些值和替换值。换句话说，它可以概括为{列名:{列中的值:替换值}}。</p><p id="1105" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想用一个特定的条件替换这些值呢？在这种情况下，我们可以尝试使用<strong class="lb iu">蒙版法</strong>。此方法是一种 if-then 方法，最适用于系列对象，而不是数据框对象。让我给你演示一下蒙版法是如何工作的。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="2e8d" class="ne md it na b gy nf ng l nh ni">mpg['mpg'].mask(mpg['mpg'] &lt; 20, 'Less than Twenty' )</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/6b5cfc6cab4ea30fa7461c14188fdb31.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*h3zZkntJ-MzrNVQbeId3rQ.png"/></div></figure><p id="0466" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用掩码方法时，我们通常会向方法传递两个参数；要替换的条件和值。在这种情况下，我给出了一个 mpg 值小于 20 的条件，然后用“小于 20”替换这些值。</p><p id="7291" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您需要不止一个条件，您需要将这些方法链接起来。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="c2dd" class="ne md it na b gy nf ng l nh ni">mpg['mpg'].mask(mpg['mpg'] &lt; 20, 'Less than Twenty' ).mask(mpg['mpg'] &gt; 40, 'More than Fourty')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/b70f1c8c01fa71f09cbaa6dff9ef5052.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*difw-Ww9qq7vW_JMRNaWgA.png"/></div></figure><p id="15a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有一个<strong class="lb iu"> where 方法</strong>，它的工作方式与 mask 方法相反。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="8599" class="ne md it na b gy nf ng l nh ni">mpg['mpg'].where(mpg['mpg'] &lt; 20, 'More than Twenty' )</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/922bf04712a8e1588654cc956b39aee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*cV7vXAFjtefBUdcAWi6vGQ.png"/></div></figure><p id="2858" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从结果中，您可以看到不符合条件的值被替换了。</p><p id="593e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在任何情况下，您都可以用自己喜欢的方法替换这些值。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d006" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">3.隐藏不需要的索引和/或列</h1><p id="d068" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">有时，您希望展示您的数据框，但不希望内容分散观众的注意力(我经常遇到这种情况，尤其是索引值)。</p><p id="e558" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，我想给你看 mpg 数据集的前五名。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="5433" class="ne md it na b gy nf ng l nh ni">mpg.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/e1f2caf5512c458c8ab1b549d0b4e169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*psclepq3WWgJhxbSiTb0AA.png"/></div></div></figure><p id="e258" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的结果显示了整个表，表中有索引。有一次，我展示了一张和上面一样的桌子，被问及桌子旁边的数字，需要时间向大家解释。这当然是浪费时间。这就是为什么我们可以用下面的代码隐藏索引。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="93d7" class="ne md it na b gy nf ng l nh ni">mpg.head().style.hide_index()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/35e977efd3c261eb1eb83ce9aff3bfa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f7xP2OIVLnl7143EnNcF4Q.png"/></div></div></figure><p id="2dd3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以从数据框对象中使用<strong class="lb iu"> style.hide_index() </strong>方法。</p><p id="e567" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，可能有这样一种情况，您可能希望只保留一列，而呈现数据框的其余部分。要选择你想要的每一列，只留下一个不必要的列，这将是一项很大的工作。</p><p id="29b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，我们可以使用数据框对象中的<strong class="lb iu"> style.hide_columns() </strong>。让我们看看下面的例子。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="1f07" class="ne md it na b gy nf ng l nh ni">mpg.head().style.hide_index().hide_columns(['weight'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/87eff15710b04c379cfbd96aa8dd9bcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AdiLbdM2gk8K1qD0hZTWjw.png"/></div></div></figure><p id="5b68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我上面的例子中，我想省去权重列，这就是为什么我只在方法中传递权重。当然，您可以隐藏任意多的列。你只需要把值传入列表。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="aefa" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="e159" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在这篇文章中，我向您展示了三个技巧来简化您的日常数据工作。这包括:</p><ol class=""><li id="45e0" class="nu nv it lb b lc ld lf lg li nw lm nx lq ny lu nz oa ob oc bi translated">使用查询</li><li id="8560" class="nu nv it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated">用 replace、mask 和 where 替换值</li><li id="2f1f" class="nu nv it lb b lc od lf oe li of lm og lq oh lu nz oa ob oc bi translated">使用 hide_index 和 hide_columns 隐藏</li></ol><p id="a94b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望有帮助！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5678" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">如果您喜欢我的内容，并希望获得更多关于数据或数据科学家日常生活的深入知识，请考虑在此订阅我的<a class="ae ky" href="https://cornellius.substack.com/welcome" rel="noopener ugc nofollow" target="_blank">简讯。</a></h1><blockquote class="oi"><p id="1904" class="oj ok it bd ol om on oo op oq or lu dk translated">如果您没有订阅为中等会员，请考虑通过<a class="ae ky" href="https://cornelliusyudhawijaya.medium.com/membership" rel="noopener">我的介绍</a>订阅。</p></blockquote></div></div>    
</body>
</html>