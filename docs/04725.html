<html>
<head>
<title>Data Analysis for Cyber Security 101: Detecting Lateral Movement</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网络安全101的数据分析:检测横向移动</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-analysis-for-cyber-security-101-detecting-lateral-movement-2026216de439?source=collection_archive---------18-----------------------#2020-04-26">https://towardsdatascience.com/data-analysis-for-cyber-security-101-detecting-lateral-movement-2026216de439?source=collection_archive---------18-----------------------#2020-04-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/e924f9b4e3d75c0f072fbc816e11cb2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uNgCnq_b2CA22d1BqJ2fug.jpeg"/></div></div></figure><div class=""/><p id="6aa8" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一系列博客文章的第二部分。第一个可以在<a class="ae kw" rel="noopener" target="_blank" href="/data-analysis-for-cybersecurity-101-detecting-data-exfiltration-ae887594f675">数据渗透</a>上看。</p><p id="5426" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这篇博文的结构如下:</p><ol class=""><li id="39e2" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated"><a class="ae kw" href="#9c29" rel="noopener ugc nofollow"> <strong class="ka jc">介绍横向运动</strong> </a> <strong class="ka jc"> </strong> (4分钟):<strong class="ka jc"> </strong>一个玩具例子来说明什么是横向运动</li><li id="9afc" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="#3445" rel="noopener ugc nofollow"> <strong class="ka jc">网络异常检测</strong> </a> <strong class="ka jc"> </strong> (7分钟)<strong class="ka jc"> : </strong>统计和机器学习技术检测横向移动</li><li id="26aa" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="#4862" rel="noopener ugc nofollow"> <strong class="ka jc"> CTF挑战</strong> </a> <strong class="ka jc"> </strong> (3分钟)<strong class="ka jc"> : </strong>解决<strong class="ka jc"> </strong> 3 CTF挑战关于寻找横向运动</li><li id="3c25" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="#f96f" rel="noopener ugc nofollow"> <strong class="ka jc">违规报告</strong> </a> <strong class="ka jc"> </strong> (4分钟)<strong class="ka jc"> : </strong>真实的例子以及我们可以从中学到什么</li><li id="70f6" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="#8d93" rel="noopener ugc nofollow"> <strong class="ka jc">可见度和传感器优势</strong> </a> <strong class="ka jc"> </strong> (3分钟)<strong class="ka jc"> : </strong>检查您的数据质量和可见度</li><li id="0ac2" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><a class="ae kw" href="#82f4" rel="noopener ugc nofollow"> <strong class="ka jc">黑暗空间和蜜罐</strong> </a> <strong class="ka jc"> </strong> (2分钟)<strong class="ka jc"> : </strong>要做的事情让检测横向移动变得更容易</li></ol><h1 id="5fcc" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">前提</h1><blockquote class="mj mk ml"><p id="2227" class="jy jz mm ka b kb kc kd ke kf kg kh ki mn kk kl km mo ko kp kq mp ks kt ku kv ij bi translated"><em class="jb">好看！您已经成功地检测并阻止了</em> <a class="ae kw" rel="noopener" target="_blank" href="/data-analysis-for-cybersecurity-101-detecting-data-exfiltration-ae887594f675"> <em class="jb">数据泄露</em> </a> <em class="jb">，但战斗还远未结束。我们仍然怀疑有坏人潜伏在你的网络中。作为一名负责任的网络安全管理员，你开始搜寻。</em> <strong class="ka jc"> <em class="jb">利用网络流量数据搜寻更多异常安全事件。</em> </strong></p></blockquote><h1 id="d4e7" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">妥协的假设</h1><p id="1b1c" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">作为一名网络安全管理员，一种<em class="mm"/>健康的心态是<strong class="ka jc">假设您已经受到威胁</strong>，这样，您的目标就是找到对手的<strong class="ka jc">利用后活动的证据。</strong></p><p id="78b4" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请记住，利用只是攻击者的第一步，他们还需要采取额外的步骤来实现他们的主要目标。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mv"><img src="../Images/69c52c125befc7abd2396388325e863e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nOldFDg_thvs-5KX5p1_tA.png"/></div></div></figure><p id="05d0" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">回想一下之前的<a class="ae kw" rel="noopener" target="_blank" href="/data-analysis-for-cybersecurity-101-detecting-data-exfiltration-ae887594f675">博文</a>，在最初的妥协之后，为了窃取你的数据，攻击者需要经历以下步骤:</p><p id="9d8f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">(1)<strong class="ka jc">攻击者需要使用一些命令和控制(C2)通道与他们的立足点</strong>进行协调。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/d524b87cc8b6ec9c15865f9b7eeb115b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GwFrx3YhRmpRl0ek5V4Xbg.png"/></div></div></figure><p id="2941" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">(2)使用C2，<strong class="ka jc">攻击者需要通过网络导航和横向移动来到达数据</strong>。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/b67128d7bbaf48522b45e90e45c4d01a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kQaz7EUQRmrVgq7aVRbWMg.png"/></div></div></figure><p id="6a15" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">(3)一旦攻击者获得了数据，<strong class="ka jc">攻击者需要将这些数据</strong>从网络中泄漏出去。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/bf6cfa6505f0e4ccae4d9db8aa66199b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IPhZUBjLNo7wgk6eAMD1PA.png"/></div></div></figure><p id="1534" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇博文中，我们将介绍一些检测<strong class="ka jc"><em class="mm"/></strong>横向移动的简单方法，以及一些关于如何设计可防御和可监控系统的注意事项，以便我们能够持续防御我们的网络。</p><h1 id="710b" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">横向运动</h1><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nb"><img src="../Images/c247924631ed6423579bf5cce6a9c1cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eoWBUOxWe2n0L3aVj-j6YQ.jpeg"/></div></div></figure><h2 id="5c83" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">玩具案例研究</h2><p id="6b7b" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">当攻击者成功入侵主机时，很可能主机没有必要的凭证、权限和网络访问权来获取公司的机密数据。在这种情况下，攻击者必须利用他们现有的立足点来获得更高级别的访问权限。</p><p id="321d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们更深入地检测横向运动之前，让我们使用一个玩具案例研究，以便我们可以“描绘”到底发生了什么。</p><p id="ce27" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的网络中有两个主要部门:</p><ul class=""><li id="5945" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv no ld le lf bi translated">人力资源部:打开大量来自求职者的随机电子邮件。他们只能访问内部电子邮件服务器。</li><li id="f610" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">IT团队:管理生产数据库和员工桌面</li></ul><p id="4912" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">人力资源员工是坏人更容易攻击的目标，但是，即使人力资源员工被诱骗打开恶意PDF，让攻击者访问人力资源机器，这种访问也不会立即让他访问生产数据。那现在怎么办？</p><p id="0515" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面，我们举例说明我们的玩具案例研究，以及攻击者如何能够在内部进行转换，以便最终能够访问生产数据。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi np"><img src="../Images/fd1b2a73ec7b000ea7225b1256497aa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DXURbiqpBhmSe8sNXVRRLw.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">玩具示例，从电子邮件到生产数据库</p></figure><ol class=""><li id="7218" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">攻击者向<strong class="ka jc">发送了一封伪造的求职电子邮件</strong>，HR打开了附件中的简历。这原来是<strong class="ka jc">一个恶意的PDF </strong>，它帮助<strong class="ka jc">攻击者使用反向shell在HR子网</strong>中建立立足点。</li><li id="61cb" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">通过强力攻击，<strong class="ka jc">攻击者获得了HR机器的本地管理员凭证</strong>，并能够提升他的权限。</li><li id="0f0d" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">不幸的是，<strong class="ka jc">所有机器都有相同的本地管理员证书。</strong>使用这些凭证，他能够<strong class="ka jc">转到IT组子网中的主机。</strong></li><li id="ad47" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated"><strong class="ka jc">通过IT组主机</strong>的隧道，他能够访问所有生产服务器。</li></ol><p id="8489" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们如何检测这种横向运动？有些事情上图没有显示出来。想想攻击者是如何发现他所使用的不同帐户、主机和服务的。</p><h2 id="24d0" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated"><a class="ae kw" href="https://nmap.org/book/man-host-discovery.html" rel="noopener ugc nofollow" target="_blank">主机发现</a> [1]</h2><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi np"><img src="../Images/0c107c245f376014fa9aa3070b0486ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6_NRrIJCOfTiXhudhrWMDA.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated"><em class="nu">“我可以使用这台人力资源机器访问什么？”</em></p></figure><p id="e5e0" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上述第2步和第3步之间，坏人必须以某种方式知道他可以转到IT子网中的哪个IP地址。他是怎么找到这个IP的？</p><p id="82bb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一种方法是通过扫描可访问的IP进行网络扫描。如果扫描结束时枚举了子网中的所有主机，这可能会产生噪声，很容易被检测到。</p><p id="4e41" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">这种情况的一个迹象是一个单一的源主机试图建立到许多目的主机的连接。</strong>这是在TCP、UDP和ICMP中。</p><p id="d4fa" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另请注意，在扫描可访问的主机时，防火墙可能不允许某些连接。如果您的防火墙记录这些放弃的尝试，那么这将为我们提供另一种检测网络扫描的方法。<strong class="ka jc">另一个危险信号是当防火墙丢弃来自单个源主机的大量不同连接时。</strong></p><p id="011f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">在某些情况下，单一掉线也是一个危险信号，尤其是在网络设置良好的情况下。</strong>例如，如果一个生产web服务器试图连接到一个内部主机，但被防火墙规则丢弃，可能会发生一些奇怪的事情。</p><h2 id="be46" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated"><a class="ae kw" href="https://nmap.org/book/man-version-detection.html" rel="noopener ugc nofollow" target="_blank">服务发现</a>【2】</h2><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi np"><img src="../Images/0d2547d68942be11393a033380c56eff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gw1ydMa00leGyNgecAYIzg.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">“这是数据库吗？还是web服务器？”</p></figure><p id="2606" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，攻击者知道他可以到达哪些主机，下一个问题可能是，他们有什么服务？在第3步和第4步之间，攻击者可能首先发现在端口5432上运行着一个服务，这就是为什么他认为它可能是一个PostgreSQL服务器。</p><p id="cbf5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">发现公开的正在运行的服务包括通过端口扫描尝试找到主机的开放端口。根据攻击者的目标，这也可能非常嘈杂。</p><p id="4ac2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">默认情况下，nmap扫描每个协议的<a class="ae kw" href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Infrastructure/nmap-ports-top1000.txt" rel="noopener ugc nofollow" target="_blank"> 1000个“感兴趣的”端口</a> [3】。然而，攻击者可能会选择扫描所有的65535端口，这将更加嘈杂。或者，攻击者可能更隐蔽，选择只扫描他关心的几个端口，例如用于NetBIOS服务扫描的端口139和445。</p><p id="c3fc" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于更隐蔽的端口扫描，这更接近于寻找主机扫描的迹象。</p><p id="d127" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于有噪声的端口扫描，我们正在寻找试图连接到许多目的端口的源。相关日志是网络流日志或防火墙日志。</p><p id="bea4" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您为此设置了警报，您首先应该找到的是您的漏洞扫描器。如果你没有发现这些，那么你就是做错了。</p><h2 id="b71f" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">端点到端点连接</h2><p id="99f8" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">您应该在网络中看到的最常见的连接是从一个端点到一个服务器或从一个服务器到另一个服务器。端点之间相互对话并不常见，从服务器到端点的连接就更不常见了。(尤其是当您不希望员工创建自己的文件共享时。)</p><p id="51d5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">端点到端点的良性连接的一个例子是从它到网络上不同主机的连接。这可能是为了维护或更新。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi np"><img src="../Images/9d69fc6d790f9259f4c523375f94ce78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lhJMaXu4oxWSB53I9lLGrg.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">IT机器与HR机器对话可能是正常的</p></figure><p id="cf7a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，HR机器直接与IT机器建立连接可能是不正常的。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi np"><img src="../Images/65cf6cd08838ff830225b11497ce1ba9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aY0QyUqO8kyEw61Wr2eeLg.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">HR机器连接到IT机器可能不正常</p></figure><p id="c7a8" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你对你的网络了解得越“深入”，你就越能缩小可能异常的连接类型，以及哪些是真正重要的。</p><p id="47b1" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在toy示例中，我们可以为从HR机器到除电子邮件服务器之外的任何其他主机的任何连接尝试设置警报。我们甚至可以阻止HR与除邮件服务器之外的任何内部主机的任何连接。</p><h1 id="3445" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">网络异常检测</h1><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nb"><img src="../Images/647a55227a6a0e9ad48cc70c945f8679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sLR5IZeZcpB7t2wFDYOOTA.jpeg"/></div></div></figure><p id="ec98" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">到目前为止，我们讨论的方法都是基于签名的。基于我们确定的横向移动可能如何发生的机制，我们定义业务规则并将它们编码为警报。有了这些，我们能够将尽可能多的领域专业知识和背景融入到我们的警报中。如果处理得当，这些可以为我们提供具有良好信噪比的警报。</p><p id="5ca0" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">尽管这些类型的规则对于保护我们的网络是必要的，但是它们可能不足以适当地保护我们的网络，因为:</p><ol class=""><li id="0410" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">网络复杂性的增长速度远远超过安全团队增加的人力</li><li id="76c0" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">企业网络不是静态的，需要持续的监控和重新建立基准</li><li id="b70c" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">业务规则在检测新型攻击方面不够稳健</li></ol><p id="72fe" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您的网络相对较小，那么您可以使用基于规则的警报，因为您可以描述所有您期望看到的正常连接，并为那些您认为不正常的连接创建警报。这些主机应该只与DNS和代理服务器通信。此服务器应该只连接到此数据库。只有这些特定的主机应该连接到生产数据库……</p><p id="9487" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，随着您的网络变得越来越大、越来越复杂，跟踪所有这些变得几乎不可能。这就是为什么我们想探索一些网络异常检测技术。</p><p id="aab2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">假设是恶意主机会偏离典型行为。</strong>如果我们能够以某种方式自动捕捉“正常”的特征，那么希望我们能够通过筛选“异常”来捕捉恶意活动。</p><p id="ce25" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">定义和模拟“正常”的好方法是一个正在进行的研究领域。在这篇博文中，我们将主要关注两种方法:</p><ol class=""><li id="3ab6" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">发现宿主行为特征中的异常值。</li><li id="072d" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">通过新的边/链路预测发现意外连接</li></ol><h2 id="835a" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">主机行为特征中的异常值</h2><p id="ce08" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">这里的想法是将主机在给定时间间隔内的行为总结到一个向量中。有了所有这些主机矢量，我们就可以识别出与网络其余部分格格不入的主机。</p><p id="8dcd" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">特色工程</strong></p><p id="3ada" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最重要的第一步是为网络中的每台主机构建功能。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nv"><img src="../Images/37308dcb00a12c235eeb037d9d5b1057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MgWfi0oPskC0SPnqFw_1AA.png"/></div></div></figure><p id="4bbb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们应该得到什么特征？这取决于您能得到什么，以及您所在组织的安全领域专家有什么建议。</p><p id="cba0" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们来看看论文[13]使用了什么特征。他们总共使用了23项功能:</p><ul class=""><li id="5e2f" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv no ld le lf bi translated"><strong class="ka jc"> RDP特色:</strong><em class="mm">SuccessfulLogonRDPPortCount，UnsuccessfulLogonRDPPortCount，RDPOutboundSuccessfulCount，RDPOutboundFailedCount，RDPInboundCount </em></li><li id="b9ec" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated"><strong class="ka jc"> SQL特性:</strong>UnsuccessfulLogonSQLPortCount、SQLOutboundSuccessfulCount、SQLOutboundFailedCount、SQLInboundCount</li><li id="6ced" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated"><strong class="ka jc">成功登录功能:</strong>SuccessfulLogonTypeInteractiveCount、SuccessfulLogonTypeNetworkCount、SuccessfulLogonTypeUnlockCount、successfullogontyperoteractivecount、SuccessfulLogonTypeOtherCount</li><li id="40d3" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated"><strong class="ka jc">未成功登录功能:</strong>UnsuccessfulLogonTypeInteractiveCount、UnsuccessfulLogonTypeNetworkCount、UnsuccessfulLogonTypeUnlockCount、unsuccessfullogontyperemoteeinteractivecount、unsuccessfullogontypoethercount</li><li id="5ee5" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated"><strong class="ka jc">其他:</strong> NtlmCount，DistinctSourceIPCount，DistinctDestinationIPCount</li></ul><p id="118f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[14]中的其他特征示例有:</p><ul class=""><li id="ca3b" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv no ld le lf bi translated">过去24小时内是否至少有一个地址验证失败</li><li id="0edd" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">给予用户访问网站的IP地址的最大异常值</li><li id="4a42" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">从登录到结账的最短时间</li><li id="573f" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">用户在过去24小时内访问网站的不同位置的数量。</li></ul><p id="a671" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有了这些特征向量，我们可以构建一个矩阵，并开始使用离群点检测技术。</p><p id="0192" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">主成分分析</strong></p><p id="7480" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们从使用<em class="mm">主成分分析【15】</em>寻找异常值的经典方法开始，因为在我看来这是最直观的。</p><p id="24bb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">简单来说，你可以认为PCA是一种压缩和解压缩数据的方法，其中压缩过程中的数据丢失被最小化。</p><p id="d278" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于大多数数据应该是正态的，因此PCA的低秩近似将集中于正态数据。PCA在异常值的情况下表现如何？</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nw"><img src="../Images/6e1894476e2956ae7ca315a04454437f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6oA4dUgXhEZ2Ugb4PEaZmw.png"/></div></div></figure><p id="45b7" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于离群值不符合其余数据的相关结构，因此这些数据将具有较高的重建误差。一种形象化的方法是将“正常数据”视为网络的后台活动。</p><p id="3b87" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面我们从fast.ai [12]的数值线性代数课程中看到一个更直观的例子。他们从视频的不同帧中构建了一个矩阵。左边的图像是视频的一帧。中间的图像是使用鲁棒PCA的低秩近似。右边的图像是差异，重建误差。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nx"><img src="../Images/a59b49efe78761a37e440a200ffa91e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJiQBgyNv7dX47YXFEGiaw.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated"><a class="ae kw" href="https://github.com/fastai/numerical-linear-algebra/blob/master/nbs/3.%20Background%20Removal%20with%20Robust%20PCA.ipynb" rel="noopener ugc nofollow" target="_blank">fast . ai的鲁棒PCA背景去除示例</a> [12]</p></figure><p id="d81b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上面的例子中，视频的“主题”通常出现在重建误差中。同样，我们希望异常的宿主能从背景中突出出来，并具有较高的重建误差。</p><p id="6418" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意:经典的主成分分析可能对异常值敏感(不幸的是),因此使用[12]中讨论的健壮主成分分析可能更好</p><h2 id="68d3" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">自动编码器</h2><p id="965b" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">我不会详细介绍自动编码器，但是您可以将自动编码器视为PCA的非线性版本。</p><p id="463f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">神经网络的构建使得中间存在信息瓶颈。通过迫使网络通过中间的少量节点，它迫使网络优先考虑最有意义的潜在变量，这就像PCA中的主成分。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ny"><img src="../Images/ad1bbdc855c525ba5a6421ccf17bbb03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o_WlAzg6uzC-FodIKMH7lA.png"/></div></div></figure><p id="e7c9" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">类似于PCA，如果自动编码器是在正常数据上训练的，那么它可能很难重构异常数据。重建误差可以用作“异常分数”。</p><p id="15bb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">PCA和autoencoder是[14]用来以无人监管的方式检测恶意主机的一些组件。</p><p id="2b73" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">隔离林等方法</strong></p><p id="009c" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">发现异常主机的另一种流行方法是使用隔离森林，这种方法比其他方法表现更好[13]。就像许多基于树的算法一样，这可以处理数值和分类数据，并且对数据的分布和形状没有什么假设。</p><p id="92ff" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，我们希望使用我们的历史数据来学习一个可以帮助我们区分正常和不正常的函数。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nz"><img src="../Images/c065063d3a4d4e7c9dd9b642762048a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ygP_zmnI7GU6oDs_uXQeRg.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated"><a class="ae kw" href="https://github.com/yzhao062/pyod" rel="noopener ugc nofollow" target="_blank">使用Py </a> OD [16]从不同方法中学习到的示例决策边界</p></figure><p id="f617" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你想探索不同的离群点检测方法，我推荐你浏览一下<a class="ae kw" href="https://github.com/yzhao062/pyod" rel="noopener ugc nofollow" target="_blank">PyOD</a>【16】和他们引用的实现算法和论文。</p><p id="f576" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你有兴趣了解更多这方面的知识，我推荐你观看<a class="ae kw" href="https://www.youtube.com/watch?v=12Xq9OLdQwQ" rel="noopener ugc nofollow" target="_blank">异常检测:算法、解释、应用</a>【17】。</p><h2 id="44b4" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">新边缘/链路预测</h2><p id="adbf" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">这是对[11]的过度简化</p><p id="ab45" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不像以前的方法，我们试图找到恶意主机。在这里，我们试图找到异常边，其中边是客户端和服务器之间的连接，或者是源和目的地之间的连接。源/客户端也可以是用户名，边代表认证。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/8832b40689ae83846c284566a0c256b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_nWhMdHVuI6YlL6VC9Ph7Q.png"/></div></div></figure><p id="bb9d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在假设这是我们第一次看到这个边缘。我们可能会问，<em class="mm">观察到这个新边缘的概率有多大？</em></p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/2817928d6d5a28fcb4559f71884736bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-nOsrM1OgHAKjFeHkBrX6A.png"/></div></div></figure><p id="3c16" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于上面的函数，我们需要客户端和服务器都有某种表示。我们可以有分类协变量，例如:</p><ul class=""><li id="27c8" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv no ld le lf bi translated">主机的子网</li><li id="ebe6" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">主机的类型(端点或服务器)</li><li id="2879" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">用户的职务</li><li id="f59b" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">用户的位置</li></ul><p id="c71e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有了分类协变量，用二进制指示变量表示，我们可以使用源和目的地的相互作用来了解新边的可能性有多大。</p><p id="6396" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">获取源和目的地的嵌入</strong></p><p id="ff5e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">表示主机的另一种方式是生成某种嵌入。</p><p id="3e6d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们从历史数据中说，我们以前已经观察到以下优势。主机在某些连接中可以是源，在另一些连接中可以是目的。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oa"><img src="../Images/89b9d3acbe937b4dbd99fe2484ffaef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yWZUo747o1wz6xWw0pHYFA.png"/></div></div></figure><p id="7d3d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由此，我们可以构建一个邻接矩阵，其中每个单元代表一条可能的边，而被观察到的边的值为1。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ob"><img src="../Images/10baf77cb6cce57577581bb3a82610d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0-qJ0fTe1JBDA5NXgBGdlA.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">邻接矩阵来自</p></figure><p id="a826" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用这个矩阵，我们可以执行一些非负矩阵分解。这是我们在其他应用中看到的，比如推荐系统和协同过滤。通过因式分解，我们能够得到源和目的地的嵌入。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oc"><img src="../Images/dd9a3fd3b77c143034291273d56f15fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*del6Ry65q-5w659ofRxTGQ.png"/></div></div></figure><p id="a72d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">链接预测</strong></p><p id="f27d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">文件[18]显示了如何能够因子分解，同时纳入分类协变量。这是通过<em class="mm">泊松矩阵分解(PMF)完成的。</em></p><p id="625f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在估计嵌入和一些必要的系数之后，我们可以估计观察到新边缘的可能性。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/a7d33352fc485e3a40f72234bdc838d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1JcfVSheWpV4QfPl8gHudg.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated"><a class="ae kw" href="https://arxiv.org/pdf/2001.09456.pdf" rel="noopener ugc nofollow" target="_blank">PMF模型下的概率函数【18】</a></p></figure><p id="f5a2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望您对我们正在尝试做的事情有一个高层次的了解，但是当然，以一种计算高效的方式估计α、β和ɸ的值是问题的关键。详细可以看<a class="ae kw" href="https://arxiv.org/pdf/2001.09456.pdf" rel="noopener ugc nofollow" target="_blank">【18】</a>还有。另一篇也是关于边缘预测的论文是[11]。</p><p id="a4df" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你对统计学在网络安全中的更多应用感兴趣，我建议你去看尼克·赫德的演讲<a class="ae kw" href="https://www.youtube.com/watch?v=OyxtWJ2r35k" rel="noopener ugc nofollow" target="_blank">网络安全中的数据科学和相关的统计挑战</a>【19】。</p><h1 id="4862" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">CTF挑战</h1><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nb"><img src="../Images/46728c141bb8ac7f401d26c56e8c9594.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-SLhAIwxAu46i8zb0MKfRw.jpeg"/></div></div></figure><p id="f115" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是针对横向运动的<a class="ae kw" href="https://ctf.trendmicro.com/" rel="noopener ugc nofollow" target="_blank"> 2019趋势科技CTF </a>中通配符400挑战的(很晚)部分演练。在这里尝试挑战<a class="ae kw" href="https://www.kaggle.com/hawkcurry/data-analysis-for-network-security-101-questions" rel="noopener ugc nofollow" target="_blank">，解决方案可以在</a><a class="ae kw" href="https://www.kaggle.com/hawkcurry/data-analysis-for-network-security-101-solution" rel="noopener ugc nofollow" target="_blank">这个内核</a>中找到。</p><p id="e4cd" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里的数据是合成的，不模拟典型的网络协议和行为。因此，这些挑战不需要深入了解网络协议。</p><h2 id="3de1" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">横向蛮力</h2><blockquote class="mj mk ml"><p id="0982" class="jy jz mm ka b kb kc kd ke kf kg kh ki mn kk kl km mo ko kp kq mp ks kt ku kv ij bi translated">问题9:一旦一台机器被弹出，它通常被用来探索还能到达什么地方。一台主机被用来大声探测整个企业，试图找到企业中所有其它主机的方法。它的IP是什么？</p></blockquote><p id="2dcc" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们看到主机正在扫描整个网络。这可能意味着我们在寻找主机扫描的迹象。</p><p id="b6d7" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要做到这一点，我们需要获得具有许多唯一目的IP的源IP地址。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oe"><img src="../Images/95df9d230fef2c3a3e0688db4b03c0dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yIj0RpkHbjfZ2p9SPX2_fw.png"/></div></div></figure><p id="4b99" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里很明显<strong class="ka jc">13.42.70.40</strong>正在扫描并试图横向移动。为了完整起见，我们查看了它的网络活动，发现在非工作时间进行扫描会导致网络活动激增。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi of"><img src="../Images/2e8ede3516006fd039ba965fa2bf3586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sXUdW3AvyxK2_4Bnz-coig.png"/></div></div></figure><p id="055e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">未节流的扫描噪音很大，会产生大量流量。因此，如果攻击者不试图隐藏他们的网络扫描，这是我们希望看到的。</p><h1 id="75c5" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">横向间谍</h1><blockquote class="mj mk ml"><p id="0dd2" class="jy jz mm ka b kb kc kd ke kf kg kh ki mn kk kl km mo ko kp kq mp ks kt ku kv ij bi translated"><em class="jb">问题10:一台主机试图找到一条更安静地连接其他主机的途径。它的IP是什么？</em></p></blockquote><p id="7680" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一个更棘手的问题。排除13.42.70.40之后，很难找到任何其他主机在唯一目标IP或目标端口数量方面表现突出。</p><p id="d796" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">于是，下面的情节就没用了。坏主机正在与正常主机的后台活动融合在一起。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/00f2559595d6603ba607f09e6a7a6f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bJDm8iafUMWC3Jivy-_Y4w.png"/></div></div></figure><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oh"><img src="../Images/3704cd8a36d1d2d5394ccdbea5f3caf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WAiSv14g9eYad_gRqlYHTA.png"/></div></div></figure><p id="d1a3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们必须找到一种更有创造性的方法来发现扫描活动。如果我们有更多的网络背景，那么我们可以专注于:</p><ul class=""><li id="1441" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv no ld le lf bi translated">连接到网络中未使用的端口</li><li id="fa32" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">到端点的连接</li></ul><p id="1dbe" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是我们从网络基线中了解到的情况，但我们的网络中没有这种环境。为了推断哪些端口是“正常的”，我们假设如果多个源主机连接到一个特定的IP地址和端口，那么它可能是正常的。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oi"><img src="../Images/143f4b1f9abaf0cff16be471d399be17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aHhISIQeqzVuQz8dyEUmMg.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">给定目标IP和端口的源IP列表</p></figure><p id="5119" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，我们看到多个主机连接到<code class="fe oj ok ol om b">12.37.117.51:56</code>，那么这可能是一个正常的连接。</p><p id="8289" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于<code class="fe oj ok ol om b">12.32.36.56:68</code>，我们看到只有<code class="fe oj ok ol om b">12.49.123.62</code>试图连接到它。这大概是不正常的。</p><p id="54ac" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">过滤掉正常的目的IP和端口后，剩下的唯一源主机就是<code class="fe oj ok ol om b">12.49.123.62</code>。这是我们的烂IP。</p><h2 id="1e04" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">奖金(可选):内部P2P</h2><blockquote class="mj mk ml"><p id="fd82" class="jy jz mm ka b kb kc kd ke kf kg kh ki mn kk kl km mo ko kp kq mp ks kt ku kv ij bi translated"><em class="jb">问题5:有时我们的低度感染在其他方面也是可见的。一种特殊的病毒已经在许多机器中传播，这些机器现在被用来相互传递命令。恶意软件创建了一个内部P2P网络。在所有相互通信的主机中，最大的内部集团使用哪个唯一端口？</em></p></blockquote><p id="d704" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这与检测横向移动有关，但解决方案涉及使用<a class="ae kw" href="https://en.wikipedia.org/wiki/Graph_theory" rel="noopener ugc nofollow" target="_blank">图论</a>中的分析技术。</p><p id="0172" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个问题很简单，因为这个问题直接问最大的集团。集团是一组彼此都有联系的主机。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi np"><img src="../Images/0746812f72289af61d888c7eba216e59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oolF8zLpuWIp7NkLJYoa4g.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">每个圈都是网络中的一个主机。如果两个主机彼此有连接，我们在它们之间放置一个端点。</p></figure><p id="c12a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<a class="ae kw" href="https://networkx.github.io/" rel="noopener ugc nofollow" target="_blank"> NetworkX </a>，通过<a class="ae kw" href="https://networkx.github.io/documentation/networkx-1.10/reference/generated/networkx.algorithms.clique.find_cliques.html" rel="noopener ugc nofollow" target="_blank">枚举所有派系</a>并找到最大的一个，就可以得到确切的答案。然而，这并不能很好地扩展。</p><p id="2c2f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们选择使用快速近似方法<a class="ae kw" href="https://networkx.github.io/documentation/latest/reference/algorithms/generated/networkx.algorithms.approximation.clique.large_clique_size.html" rel="noopener ugc nofollow" target="_blank"> large_clique_size(G) </a>。</p><pre class="mw mx my mz gt on om oo op aw oq bi"><span id="79cf" class="nc lm jb om b gy or os l ot ou">G = networkx.Graph()<br/>G.add_nodes_from(internal_nodes)<br/>for l, r <strong class="om jc">in</strong> zip(internal_edges.src, internal_edges.dst):<br/>    G.add_edge(l, r)        <br/>        <br/>_size = large_clique_size(G)</span></pre><p id="4369" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用上面的代码，我们可以获得特定端口的大集团，但这对于所有端口来说运行起来太慢了。为了加速搜索，我们过滤掉最大团保证很小的端口。</p><p id="7eca" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">很容易证明，如果图<code class="fe oj ok ol om b">G</code>中存在一个规模为<code class="fe oj ok ol om b">K</code>的团，那么<code class="fe oj ok ol om b">G</code>中至少应该存在<code class="fe oj ok ol om b">K</code>个度大于或等于<code class="fe oj ok ol om b">K-1</code>的节点。鉴于这一事实，我们可以计算每个端口的团大小的上限。完成这项工作的代码在<a class="ae kw" href="https://www.kaggle.com/hawkcurry/data-analysis-for-network-security-101-solution" rel="noopener ugc nofollow" target="_blank">解决方案内核</a>中。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/b31b8703f2db8caf4b96d9ad3979337a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*SGwwJTNHBEEEN6vyLS4byA.png"/></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">这些是具有最高上限的端口</p></figure><p id="af85" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">处理这些端口我们发现端口<strong class="ka jc"> 83 </strong>有一个<strong class="ka jc"> 264 </strong>的最大团。</p><h1 id="f96f" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">违规报告</h1><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nb"><img src="../Images/a153a7d5cd06ea3dcde7587eeda978ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tpxgSwpcWpiQS-2WdntJAA.jpeg"/></div></div></figure><p id="a89b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这一节中，我们将回顾以前数据泄露造成的历史“灾难”。</p><h2 id="4276" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated"><a class="ae kw" href="https://www.mci.gov.sg/-/media/mcicorp/doc/report-of-the-coi-into-the-cyber-attack-on-singhealth-10-jan-2019.ashx" rel="noopener ugc nofollow" target="_blank"> 2018 SingHealth数据泄露</a> [5]</h2><p id="09fd" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">2018年新加坡健康数据泄露事件中，新加坡卫生服务部门的150万名患者的数据被盗。这个事件最接近我们的玩具案例研究。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ow"><img src="../Images/a8cd092d89b1835be4f134546de2260e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xur_GMN4dKfVZYeTBmtOuA.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">SingHealth数据泄露事件报告中关键事件的图解摘要[5]</p></figure><p id="f01e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">简而言之，关键事件包括:</p><ol class=""><li id="3c1f" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">尽管报告中并不清楚这是如何发生的，但我们知道攻击者能够通过网络钓鱼攻击在的<em class="mm">工作站上<strong class="ka jc">安装恶意软件。</strong></em></li><li id="e638" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">通过访问<strong class="ka jc">工作站A，攻击者能够危害多个端点和服务器。</strong>根据报告，攻击者可能已经侵入了Windows身份验证系统，并从域控制器获取了管理员和用户凭据。</li><li id="efdf" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">最终，攻击者能够控制<strong class="ka jc">工作站B，这是一个可以访问SCM应用程序的工作站。有了它，攻击者能够找到适当的凭证来破坏SCM系统</strong></li><li id="a938" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">在SCM数据库上运行了大量查询</li><li id="9ea6" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">通过<strong class="ka jc">工作站A </strong>对数据进行了过滤</li></ol><p id="d5a3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是报告中确定的一些促成因素。</p><p id="b80e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">SGH思杰服务器和配置管理数据库之间的网络连接是允许的。</strong></p><p id="e2ee" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">允许Citrix服务器场与SCM数据库服务器之间的网络连接。对网络体系结构的基本安全审查可能已经表明，这种开放的网络连接产生了安全漏洞。</p><p id="6ad8" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果这两个系统是隔离的，攻击者就不能轻易地访问SCM数据库。</p><p id="98fd" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据该报告，在两个系统之间保持这种开放网络连接的原因之一是为了提高操作效率。管理员希望能够使用Citrix服务器和安装在那里的工具来管理不同系统的多个数据库。</p><p id="f638" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc"> SGH思杰服务器未能充分防范未经授权的访问</strong></p><p id="2082" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里的许多因素都与身份验证和凭证管理有关，这超出了本文的范围。现在与我们相关的一个问题是，<em class="mm">缺乏防火墙来防止使用RDP对SGH Citrix服务器进行未经授权的远程访问。</em></p><h2 id="2cc1" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated"><a class="ae kw" href="https://oig.nasa.gov/docs/IG-19-022.pdf" rel="noopener ugc nofollow" target="_blank"> 2018年美国宇航局JPL违规事件</a>【6】</h2><p id="45b3" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">2018年美国宇航局JPL漏洞因标题为“<em class="mm">美国宇航局因未经授权的树莓派</em>被黑”而闻名。最终报告没有详细说明最初的进入点是什么，攻击者是如何获得树莓pi的访问权限的，以及树莓pi位于何处。</p><p id="f946" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我觉得有趣的是发现“<strong class="ka jc">与外部合作伙伴共享的网络环境分割不充分”。</strong></p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ox"><img src="../Images/77167dfb392f8928e5c454934798c328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JLaBagjPvSbrTY9jZU_b8A.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">应该限制第三方对内部网络的访问</p></figure><blockquote class="mj mk ml"><p id="54ed" class="jy jz mm ka b kb kc kd ke kf kg kh ki mn kk kl km mo ko kp kq mp ks kt ku kv ij bi translated"><strong class="ka jc"> JPL建立了一个网络网关，允许外部用户及其合作伙伴</strong>，包括外国航天局、承包商和教育机构，远程访问特定任务和数据的共享环境。然而，<strong class="ka jc"> JPL没有适当地隔离各个合作伙伴环境</strong>以将用户限制在他们已经批准访问的那些系统和应用……<strong class="ka jc">2018年4月事件中的网络攻击者利用JPL网络缺乏分段性在连接到网关的各种系统之间移动</strong>，包括多个JPL任务操作和DSN。</p></blockquote><p id="60e8" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">横向流动可能导致跨组织的访问。对外部各方实施严格的信任边界，并确保将他们对您网络的访问仅限于必要的连接。外部各方可能不像您的组织那样具有安全态势，并且可能是薄弱环节。确保微调您的IDS或IPS，将来自这些子网的流量视为外部流量。</p><h2 id="a5b1" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated"><a class="ae kw" href="https://republicans-oversight.house.gov/wp-content/uploads/2018/12/Equifax-Report.pdf" rel="noopener ugc nofollow" target="_blank"> 2017年Equifax数据泄露</a> [7]</h2><p id="116b" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">2017年的Equifax泄露是一次数据泄露，导致大约1.43亿美国消费者的数据泄露。</p><p id="1aa6" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">切入点是ACIS应用程序，该应用程序没有为现在著名的关键Apache Struts漏洞打补丁。利用该漏洞，攻击者能够获得服务器上的web外壳并运行任意命令。</p><p id="8fdf" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">鉴于货物信息预报系统服务器已经受损，最好是将攻击的影响仅限于货物信息预报系统。网络或主机防火墙会阻止对外部资源的访问。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oy"><img src="../Images/04a8673cdace6b411cc2204e865559e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YVkboZ0r-bERzcuZbt382w.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">网络分割限制了爆炸半径</p></figure><p id="f164" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不幸的是，根据报告，Equifax网络是平坦的！这是最坏的情况，因为任何主机的危害都可能导致网络中任何主机的危害。</p><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oy"><img src="../Images/3888bb3b8092a7991345776b07501afc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pY3n8kuGJiRwaRJLen6oIw.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">扁平网络使得攻击非常高效</p></figure><blockquote class="mj mk ml"><p id="2169" class="jy jz mm ka b kb kc kd ke kf kg kh ki mn kk kl km mo ko kp kq mp ks kt ku kv ij bi translated">安全问题1。在Sun应用服务器和Equifax网络的其余部分之间没有分割。<strong class="ka jc">从互联网获得应用服务器控制权的攻击者可以在全球范围内转向[Equifax]网络中的任何其他设备、数据库或服务器</strong> …如果攻击者利用扁平、未分段的网络突破组织的网络边界，他们可以在整个网络中横向移动，并获得对关键系统或重要数据的访问权限。</p></blockquote><p id="bcfc" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过远程访问ACIS web服务器，攻击者能够:</p><ol class=""><li id="04df" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">装载包含未加密应用程序凭据的文件共享</li><li id="f2bd" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">在51个不同的数据库上运行9，000个查询。</li><li id="7d69" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">泄露所有数据</li></ol><p id="e7af" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">具体来说，货物信息预报系统只使用了3个数据库，但可以通过网络访问48个不相关的数据库。如果货物信息预报系统被隔离在相关的数据库中，那么这个漏洞就不会那么严重。</p><h2 id="0256" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">网络分段</h2><p id="db1e" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">我们在所有不同的漏洞中看到的一个共同主题是，网络分段在防止横向移动方面起着重要作用。</p><p id="e04b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果网络被适当地分段，爆炸半径被限制在特定的系统内，攻击者将很难在网络中穿行。</p><p id="e5f2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，对于传统网络，非常精细的分段可能成本过高，并且您可能会受到网络物理拓扑的限制。但是对于云部署，因为一切都是虚拟化的并且可以自动化，我们可以将<em class="mm">微分段</em>应用到我们的系统中【4】。您可以基于每个工作负载隔离机器，而不是基于每个网络。</p><h1 id="8d93" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">能见度和传感器优势</h1><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nb"><img src="../Images/506eea23d191665d2e9eadc2619ba801.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qBz0Lg6LlEcduh-2qh2uIA.jpeg"/></div></div></figure><p id="1fca" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在设置警报和规则之前，您需要做的一项重要工作是检查您实际收集的日志。你和你的团队必须清楚你的可见性极限是什么。</p><ul class=""><li id="eebf" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv no ld le lf bi translated">我从哪些数据源收集日志？</li><li id="6f46" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">我在每个数据源中启用了哪些类型的日志？</li><li id="8136" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">我的数据源/传感器实际“看到”了什么？</li><li id="f2d8" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">我测试过吗？</li></ul><h2 id="5a59" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">我从哪些数据源收集日志？</h2><p id="f8ab" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">检查您从哪些数据源收集数据。</p><p id="4f87" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于传统的内部部署，您可以列出来自您的设备和供应商的所有常用内容，包括DNS、DHCP、Active Directory、防火墙、代理、SQL等。也可以查一下<a class="ae kw" href="https://securityonion.net/" rel="noopener ugc nofollow" target="_blank">安全洋葱。</a>它是免费的，你可以利用围绕它发展起来的社区的知识和工具。</p><p id="bfac" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于云部署，确保您正在收集您在云提供商中使用的关键服务的审计和访问日志。另外，收集网络流量日志。</p><h2 id="49a8" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">我在每个数据源中启用了哪些类型的日志？</h2><p id="d20e" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">默认情况下，有些数据源不会保存所有必要的日志，您需要打开它。</p><p id="cee8" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可能会发现，由于配置错误，一些防火墙规则没有被记录。“我关闭了X的所有日志记录，因为它正在填满磁盘。”</p><p id="7852" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，在谷歌云平台中，防火墙日志、VPC流日志和GCS数据访问日志在默认情况下是不打开的。</p><h2 id="5ff7" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">我的数据源/传感器实际“看到”了什么？</h2><blockquote class="mj mk ml"><p id="1ab4" class="jy jz mm ka b kb kc kd ke kf kg kh ki mn kk kl km mo ko kp kq mp ks kt ku kv ij bi translated">传感器的优势描述了传感器能够观察到的数据包。优势是由传感器的位置和网络的路由基础设施之间的相互作用决定的[8]。</p></blockquote><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi np"><img src="../Images/53b5d32ce3dc0f8939a06c45f5ea8ce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*paK3mkix2sfgVAoaZK4kSg.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">并非所有连接对我们的传感器都可见</p></figure><p id="40d2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于我们的玩具用例，可能是同一子网内的连接不需要通过防火墙。如果我们分析防火墙日志，我们看到的唯一连接来自两个不同子网中的主机。</p><p id="1ae5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一些企业可能有单独的外围防火墙和内部防火墙设备。假设您只从外围防火墙收集日志，那么很可能任何内部到内部的连接都不会出现在您的SIEM上。</p><p id="f918" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">小心这个。你必须知道你的盲点在哪里。使用不能让您充分了解网络的日志会给您一种虚假的安全感。你可能认为没有人在扫描网络，而事实上，有，只是你没有看到它！</p><p id="b860" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于云基础设施，这取决于您的云服务提供商能为您提供什么。因为一切都是虚拟化的，所以您不再受网络物理拓扑的限制，并且有可能在整个IaaS中实现统一的可见性。但是如果你使用PaaS，特别是对于SaaS来说，你对得到什么样的日志有更少的控制。</p><h2 id="edb4" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">我测试过吗？</h2><p id="0e55" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">确保您的数据源正在工作并且您正在获取日志的唯一方法是测试它！</p><p id="ab63" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据您的威胁建模制定几个简单的场景并进行模拟。尝试在不同的子网上实际运行网络扫描，或者尝试使用某些honey凭据。看看这些是否会生成您想要的日志和警报。看看你的新机器学习模型是否会检测到这一点。</p><p id="4df4" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">运行模拟时，您可以从日志收集、数据转换、SIEM接收、规则和警报，甚至调查和事件响应等方面对您的检测系统进行端到端测试。</p><p id="c49e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它还将让您有机会捕捉数据源失败或配置错误的实例。也许服务停止了，它的存储空间被填满了，或者它的许可证过期了。可能是防火墙配置的更改无意中禁用了一组防火墙规则的日志记录。</p><p id="887f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不要因为没有收到NIDS或DLP的警报就认为一切正常；如果NIDS主机在3个月前被意外关闭了呢？</p><blockquote class="mj mk ml"><p id="2a8e" class="jy jz mm ka b kb kc kd ke kf kg kh ki mn kk kl km mo ko kp kq mp ks kt ku kv ij bi translated">Equifax没有看到数据泄漏，因为用于监控ACIS网络流量的设备由于安全证书过期而已经停用了19个月。[7]</p></blockquote><p id="e2ed" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">测试测试测试！</p><h1 id="82f4" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">黑暗空间和蜜罐</h1><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nb"><img src="../Images/895a1ce3e796f6f50691d9cf322575a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LahamVFAq4g1HN8QuDBhIA.jpeg"/></div></div></figure><p id="da26" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里有些东西可能对那些拥有更成熟的网络和安全状况的人有用。</p><h2 id="9b91" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">暗区</h2><p id="5b71" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">未使用的地址或端口号称为暗空间，合法用户很少尝试访问暗空间。大多数用户不手动输入IP地址，通常依赖DNS或应用程序为他们连接。另一方面，当攻击者试图横向移动时，很可能最终会访问它们[8]。</p><p id="3c93" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以对试图进入这些黑暗空间的内部主机发出警报。这可能很吵，但在某些情况下很容易调查。该警报的一个常见原因是地址错误或配置错误。</p><p id="c997" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据[8]，这里有一些事情你可以做，使攻击者更有可能进入黑暗的空间，使它更容易被检测到:</p><ul class=""><li id="5f33" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv no ld le lf bi translated"><strong class="ka jc">重新排列地址:</strong>大多数扫描是线性/顺序的，重新排列地址使它们均匀地分散在网络中，或者在网络中留下大片空白是一种创造黑暗空间的简单方法。</li><li id="4a06" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated"><strong class="ka jc">移动目标:</strong>如果分配给一个服务的端口是非标准的，攻击者只有在枚举更多的端口后才能找到它，使它们更加可见。当然，这是有代价的，因为过多地改变端口可能会让每个人感到困惑。</li></ul><h2 id="42d8" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">蜂蜜制品</h2><p id="b9bd" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">蜂蜜的事情类似于黑暗空间，我们不期望这些事情出现在我们的日志中。</p><p id="aef2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">与黑暗空间不同，这些东西确实存在于我们的网络中，但它们没有任何合法用途。正式员工不知道这些，也不应该需要使用或接触这些。另一方面，攻击者可能会在网络中移动时遇到这些东西，如果这些宝贝看起来有价值或有用，他们可能会尝试用它们做些什么。</p><p id="f447" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些例子有:</p><ul class=""><li id="54dd" class="kx ky jb ka b kb kc kf kg kj kz kn la kr lb kv no ld le lf bi translated">蜂蜜证书:</li><li id="7339" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">蜂蜜代币</li><li id="ff50" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">蜂蜜文件共享</li><li id="f801" class="kx ky jb ka b kb lg kf lh kj li kn lj kr lk kv no ld le lf bi translated">蜂蜜服务器</li></ul><p id="28fe" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们希望它们看起来有价值，一旦这些出现在我们的日志中，我们就会进行调查。蒂姆·梅丁在他最近的网络直播“<a class="ae kw" href="https://www.youtube.com/watch?v=YrhpB-GEyKQ" rel="noopener ugc nofollow" target="_blank"> <strong class="ka jc">肮脏的防御，做得极其便宜:让我的生活更艰难让你的生活更轻松</strong></a><strong class="ka jc">【9】中对此进行了更详细的讨论。</strong></p><h2 id="5d6a" class="nc lm jb bd ln nd ne dn lr nf ng dp lv kj nh ni lz kn nj nk md kr nl nm mh nn bi translated">其他人</h2><p id="1c23" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">这是相关的，但我只会简单地提一下(因为这篇博文已经够长了，抱歉)。</p><p id="afe7" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">虽然NIDS和NIPS有时部署在外围。如果位置和配置正确，它们可以帮助检测横向运动。它将能够检测网络上的客户端漏洞、可能的文件传输和不常见的未授权网络协议的使用。您还可以使用NIDS来检测网络上明文传输的蜜糖令牌。</p><p id="d354" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查它是否配置为忽略内部到内部的连接。</p><h1 id="a196" class="ll lm jb bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated"><strong class="ak">接下来:指挥与控制，信标</strong></h1><figure class="mw mx my mz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nb"><img src="../Images/5e257aaea988d5d94824dce4c8430cbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IMidDL1akYb6xT8bODQh6w.jpeg"/></div></div></figure><p id="d909" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们仅仅触及了表面。您可以使用诸如Active Directory之类的日志进行更深入的研究，以便更精确地搜索横向移动，但是我们现在必须继续。</p><p id="4e57" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在下一篇博文中，我们将讨论一些关于寻找<strong class="ka jc">命令和控制证据的问题。</strong></p><p id="72e0" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">攻击者需要能够控制他们的立足点，以便在您的网络中导航。就像他们说的，杀一条蛇砍下它的头。</p></div><div class="ab cl oz pa hu pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="ij ik il im in"><h1 id="1fe1" class="ll lm jb bd ln lo pg lq lr ls ph lu lv lw pi ly lz ma pj mc md me pk mg mh mi bi translated">参考</h1><p id="159c" class="pw-post-body-paragraph jy jz jb ka b kb mq kd ke kf mr kh ki kj ms kl km kn mt kp kq kr mu kt ku kv ij bi translated">[1] <a class="ae kw" href="https://nmap.org/book/man-host-discovery.html" rel="noopener ugc nofollow" target="_blank"> Nmap参考指南，第15章，主机发现。</a></p><p id="84fc" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[2] <a class="ae kw" href="https://nmap.org/book/man-version-detection.html" rel="noopener ugc nofollow" target="_blank"> Nmap参考指南，第15章，服务和版本检测<strong class="ka jc">。</strong> </a></p><p id="9963" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">丹尼尔·米斯勒，秘书。</p><p id="d781" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[4] <a class="ae kw" href="https://cloudsecurityalliance.org/artifacts/security-guidance-v4/" rel="noopener ugc nofollow" target="_blank"> CSA安全指南(v4)，7.3.3微分段和软件定义的边界。</a></p><p id="59a9" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[5] <a class="ae kw" href="https://www.mci.gov.sg/-/media/mcicorp/doc/report-of-the-coi-into-the-cyber-attack-on-singhealth-10-jan-2019.ashx" rel="noopener ugc nofollow" target="_blank">调查委员会对新加坡医疗服务数据库网络攻击的公开报告。</a></p><p id="59be" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">喷气推进实验室的网络安全管理和监督。</p><p id="680c" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[7]<a class="ae kw" href="https://republicans-oversight.house.gov/wp-content/uploads/2018/12/Equifax-Report.pdf" rel="noopener ugc nofollow" target="_blank">Equifax数据泄露。</a></p><p id="86c4" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[8] M. Collins，通过数据分析实现网络安全(2014年)</p><p id="6481" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">肮脏的防御，廉价的交易:让我的生活变得更艰难，让你的生活变得更轻松。</p><p id="ed4c" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://securityonion.net/" rel="noopener ugc nofollow" target="_blank">安全洋葱</a>。</p><p id="b00a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[11] <strong class="ka jc"> </strong> <a class="ae kw" href="https://pdfs.semanticscholar.org/dc64/caea1938fa1554794130de4a7bbd6a0bbd01.pdf#page=27&amp;zoom=100,132,341" rel="noopener ugc nofollow" target="_blank">梅泰利，s .，赫德，N. (2019)。计算机网络中的贝叶斯新边缘预测和异常检测。</a></p><p id="8ab5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[12] <a class="ae kw" href="https://github.com/fastai/numerical-linear-algebra/blob/master/nbs/3.%20Background%20Removal%20with%20Robust%20PCA.ipynb" rel="noopener ugc nofollow" target="_blank"> Rachel Thomas，Fast.ai数值线性代数，第3课:鲁棒PCA背景去除。</a></p><p id="ed86" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[13] <a class="ae kw" href="https://www.microsoft.com/en-us/research/uploads/prod/2019/06/ADwithGraderFeedback.pdf" rel="noopener ugc nofollow" target="_blank"> Siddiqui，Md Amran等人，“使用异常检测和解释以及专家反馈来检测网络攻击。”</a></p><p id="6287" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[14] <a class="ae kw" href="https://dai.lids.mit.edu/wp-content/uploads/2017/10/AI2_Paper.pdf" rel="noopener ugc nofollow" target="_blank"> Veeramachaneni，Kalyan等人，《AI^ 2:训练大数据机器进行防御》</a></p><p id="e519" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">【15】<a class="ae kw" href="http://users.cs.fiu.edu/~chens/PDF/ICDM03_WS.pdf" rel="noopener ugc nofollow" target="_blank">徐美玲等.一种基于主成分分类器的新型异常检测方案.</a></p><p id="7be3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">PyOD:一个用于可伸缩异常检测的Python工具箱。</p><p id="0913" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[17] <a class="ae kw" href="https://www.youtube.com/watch?v=12Xq9OLdQwQ" rel="noopener ugc nofollow" target="_blank">托曼·迪特里希。异常检测:算法，解释，应用。</a></p><p id="47c6" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">帕西诺、弗朗切斯科·桑娜、梅丽莎·JM·特科特和尼古拉斯·a·赫德。"使用泊松矩阵分解的计算机网络中的图链接预测."</p><p id="99b5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">[19]尼克听说了。<a class="ae kw" href="https://www.youtube.com/watch?v=OyxtWJ2r35k" rel="noopener ugc nofollow" target="_blank">网络安全和相关统计挑战中的数据科学</a></p></div><div class="ab cl oz pa hu pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="ij ik il im in"><p id="df4f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">照片由来自<a class="ae kw" href="https://www.pexels.com/photo/sunrise-photography-1214011/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a>的<a class="ae kw" href="https://www.pexels.com/@arts?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">阿尔特姆·萨拉宁</a>、来自<a class="ae kw" href="https://www.pexels.com/photo/calm-ocean-panoramic-photography-845254/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a>的<a class="ae kw" href="https://www.pexels.com/@denis-yudin-125459?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">丹尼斯·尤丁</a>、来自<a class="ae kw" href="https://www.pexels.com/photo/silhouette-of-lighthouse-2873059/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a>的<a class="ae kw" href="https://www.pexels.com/@ignacio-pales-407380?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">伊格纳西奥·帕莱斯</a>、来自<a class="ae kw" href="https://www.pexels.com/photo/body-of-water-2347449/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">佩克斯</a>的<a class="ae kw" href="https://www.pexels.com/@shottrotter?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">汤姆·斯温嫩</a>、来自<a class="ae kw" href="https://unsplash.com/@old_pioneer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">伊戈尔·戈里亚切夫</a>的<a class="ae kw" href="https://unsplash.com/s/photos/3-boats?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">乌斯普拉什</a>、<a class="ae kw" href="https://unsplash.com/@ele1010?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">埃莉诺拉·帕特里科拉</a></p></div></div>    
</body>
</html>