<html>
<head>
<title>INDEX-MATCH — An upgrade on VLOOKUP functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">索引匹配 VLOOKUP 功能的升级</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/index-match-an-upgrade-on-vlookup-functions-320e43253d15?source=collection_archive---------62-----------------------#2020-08-17">https://towardsdatascience.com/index-match-an-upgrade-on-vlookup-functions-320e43253d15?source=collection_archive---------62-----------------------#2020-08-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="595d" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">电子表格/索引匹配</h2><div class=""/><div class=""><h2 id="49e6" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">掌握电子表格最通用的功能之一</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/0fb27cd73e5257702383cfcba940205c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tIwBeizwspSPdRgg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@chrisliverani?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯·利维拉尼</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="cde0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><a class="ae lh" href="https://medium.com/@iamanmolbansal/how-to-use-the-notorious-vlookup-function-in-google-sheets-3dd6f825d4fe?source=friends_link&amp;sk=2f91fdd980fccd225d88bcdc968c8852" rel="noopener">在上一篇文章</a>中，我们讨论了如何以及何时使用 VLOOKUP 函数，以及在使用它们时我们可能会面临哪些问题。另一方面，本文将带您了解 VLOOKUP 的升级版本。此次升级结合了电子表格中的两个功能— <strong class="lk jd">索引和匹配</strong>。让我们通过下面的例子来理解索引匹配的工作原理。</p><h2 id="9c8b" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">理解数据</h2><p id="4045" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">像往常一样，让我们从我们最喜欢的数据源——ka ggle 中取一个例子。下面的截图是<a class="ae lh" href="https://www.kaggle.com/shivamb/netflix-shows" rel="noopener ugc nofollow" target="_blank">网飞数据</a>的一个子集，其中包括截至 2019 年网飞上可用的电视节目和电影。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/6df01600a6ef441c02d70dcff3386155.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cYjB-orBt6qewRpRXeUYNg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">用于指数匹配演示的网飞数据</p></figure><p id="50de" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这个数据集由不同的节目和电影以及它们独特的<code class="fe nc nd ne nf b">show_id</code>、我们正在考虑的<code class="fe nc nd ne nf b">country</code>、节目添加时的<code class="fe nc nd ne nf b">date</code>和实体发布时的<code class="fe nc nd ne nf b">year</code>组成。它还包含节目/电影的<code class="fe nc nd ne nf b">rating</code>、内容片段的<code class="fe nc nd ne nf b">duration</code>和<code class="fe nc nd ne nf b">title</code>。</p><p id="f0c0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在考虑我们想要创建一个搜索方法，用户可以选择一个<code class="fe nc nd ne nf b">title</code>并向用户显示关于该标题的信息。这种搜索方法看起来像这样:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/86e2ac58007c66a5fe51a2ddefe50cad.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*aGsIpN27ahT_F3GPknaAqw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">搜索方法的外观示例</p></figure><p id="eaf6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">用户可以在上面的例子中输入任何<code class="fe nc nd ne nf b">title</code>，我们将尝试从数据库中找到标题的<code class="fe nc nd ne nf b">type</code>和<code class="fe nc nd ne nf b">rating</code>。一个更简单的解决方案是通过 VLOOKUP。通过它我们可以很容易的找到题目的评分。虽然，我们需要<strong class="lk jd">改变表格的结构</strong>来获得标题的类型，因为 VLOOKUP 只能<strong class="lk jd">查看搜索值的右边</strong>。让我们看看索引和匹配公式如何帮助我们解决这个问题。</p><h2 id="011c" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">什么是索引？</h2><p id="e8a5" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">电子表格中的索引公式如下所示:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/641e0e44a59385b858f5f58a0f9cd827.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*E8tVU1NyID_JkbethyoSmg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Google 电子表格中的索引公式</p></figure><p id="76f3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe nc nd ne nf b">INDEX</code>帮助我们找到细胞的内容。它需要 3 个输入。</p><ul class=""><li id="9f6b" class="ni nj it lk b ll lm lo lp lr nk lv nl lz nm md nn no np nq bi translated"><strong class="lk jd">引用</strong>:我们要在其中查找值的表格。</li><li id="1f78" class="ni nj it lk b ll nr lo ns lr nt lv nu lz nv md nn no np nq bi translated"><strong class="lk jd"> Row </strong>:从值所在的引用表开始算起的行数。这是一个可选值。如果没有提供值，它将把第一行作为值。</li><li id="1954" class="ni nj it lk b ll nr lo ns lr nt lv nu lz nv md nn no np nq bi translated"><strong class="lk jd"> Column </strong>:从值所在的引用表开始算起的列数。这是一个可选值。如果没有提供值，它将把第一列作为值。</li></ul><p id="8d53" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了在我们的表格中找到标题“Carrie Pilby”的类型，我们应用以下公式:</p><pre class="ks kt ku kv gt nw nf nx ny aw nz bi"><span id="161e" class="me mf it nf b gy oa ob l oc od">=INDEX(A1:H23,12,2)</span></pre><p id="cfc4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们选择<strong class="lk jd">完整表作为引用</strong>，我们发现该电影标题在第 12 行，并且我们知道标题的类型存储在引用表的第 2 列。这将给出“电影”的结果，这是绝对正确的！</p><p id="23d8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">但是你注意到这个有什么问题吗？我们实际上不得不<strong class="lk jd">计算行号和列号</strong>以获得 12 和 2 作为公式中的参数。这不容易，是吗？让我们找出世界上是否有其他方法可以帮助我们缓解这个过程。</p><h2 id="7a6b" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">什么是匹配？</h2><p id="0863" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">电子表格中匹配公式如下所示:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/41f864627b9452ac185756b5616c8356.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*14NXy_cC52Pw2aFcwV-Dew.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">匹配 Google 电子表格中的公式</p></figure><p id="2898" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe nc nd ne nf b">MATCH </code>帮助我们找到表格中内容的相对位置。它需要 3 个输入。</p><ul class=""><li id="35fd" class="ni nj it lk b ll lm lo lp lr nk lv nl lz nm md nn no np nq bi translated"><strong class="lk jd">搜索关键字</strong>:我们要查找的值。</li><li id="3576" class="ni nj it lk b ll nr lo ns lr nt lv nu lz nv md nn no np nq bi translated"><strong class="lk jd">范围</strong>:数值所在的行/列。请注意，range 只能接受一行或一列，不能同时接受两者。</li><li id="904a" class="ni nj it lk b ll nr lo ns lr nt lv nu lz nv md nn no np nq bi translated"><strong class="lk jd">搜索类型</strong>:出于所有实际目的，<strong class="lk jd">我们将该值设置为零</strong>。这表明我们正在寻找精确的值。这是一个可选项，默认情况下取值为 1。</li></ul><p id="f7f3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">MATCH 本质上给了我们搜索项所在的行号或列号。这不就是我们之前遇到的索引拼图的<strong class="lk jd">缺失部分吗？我们需要一种更简单的方法来找到搜索项的行号和列号，而不是手动计数。而 MATCH 恰恰给了你这些！</strong></p><h2 id="8391" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">神圣的索引-匹配婚姻</h2><p id="de61" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">上面的解释现在允许我们将索引和匹配公式连接在一起，以最少的麻烦获得我们需要的信息。下面是一个通用的指数匹配公式:</p><pre class="ks kt ku kv gt nw nf nx ny aw nz bi"><span id="6392" class="me mf it nf b gy oa ob l oc od">=INDEX(reference, MATCH(search_key, row, 0), MATCH(search_key, column, 0))</span></pre><p id="8fc8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在上面的公式中，我们为索引提供了一个<strong class="lk jd">引用表，基本上就是所有信息所在的数据表。接下来，<strong class="lk jd">第一个匹配</strong>公式提供搜索词</strong>的<strong class="lk jd">行索引，而<strong class="lk jd">第二个匹配</strong>提供搜索词</strong>的<strong class="lk jd">列索引。最后，这两者的结合将为索引公式提供行和列索引，我们将得到我们想要的结果！让我们在网飞的例子中尝试一下。</strong></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi of"><img src="../Images/9b133a1109a80d9ec2cf32068db44f56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*MqLN0y3x-u0FN-dG-EATqw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">用于查找内容类型的索引匹配</p></figure><p id="dd05" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面的公式在 INDEX 的第一个参数中选择整个表。然后通过匹配公式在整行内容标题中搜索 K1 中提到的电影标题，即 C1:C23。这将返回标题“Carrie Pilby”所在的行号。在第二个匹配中，它搜索 J2，这是我们想要查找的参数，在本例中为 Type。这将返回列名“Type”所在的列。并且一起将提供正确的结果，即电影。</p><p id="3744" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">类似地，下面是如何匹配表格中给定内容标题的评级的公式。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi og"><img src="../Images/dc4cc8b77402f2670f288354b32651fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*7FZsPIyqJ6a7GcVYsq9Rrg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">用于查找内容分级的索引匹配</p></figure><h2 id="6af3" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">与 VLOOKUP 比较</h2><p id="7b7f" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">通常会比较使用哪个公式来查找给定内容的值。虽然<strong class="lk jd"> VLOOKUP 更容易理解</strong>并提供了一个简单的应用程序，但索引-匹配组合是一个强大的匹配，具有以下优点:</p><ol class=""><li id="b382" class="ni nj it lk b ll lm lo lp lr nk lv nl lz nm md oh no np nq bi translated">您可以使用 INDEX-MATCH 来<strong class="lk jd">查找符合多个标准的值</strong>。在上面的例子中，我们找到了带有内容名称标准和参数标准的<code class="fe nc nd ne nf b">Type </code>和<code class="fe nc nd ne nf b">Rating </code>。这在 VLOOKUP 中并不容易实现。</li><li id="ff35" class="ni nj it lk b ll nr lo ns lr nt lv nu lz nv md oh no np nq bi translated">VLOOKUP 在左侧查找匹配项，并返回搜索项右侧的任何值。另一方面，<strong class="lk jd">索引匹配可以双向查看</strong>。在上面的例子中，type 在 title 的左边，rating 在右边，但是它仍然能够正确地找到两个结果。</li></ol><p id="cdd3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">了解索引匹配为您的电子表格军械库添加了一个极其通用的工具。索引匹配和数据透视表的知识可以真正帮助你提高你的分析技能。如果这是一个有用的内容，请在评论中告诉我！</p></div></div>    
</body>
</html>