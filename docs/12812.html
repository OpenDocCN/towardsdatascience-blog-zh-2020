<html>
<head>
<title>Using SQL to Query CSVs in Command Line</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在命令行中使用 SQL 查询 CSV</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyze-csvs-with-sql-in-command-line-233202dc1241?source=collection_archive---------6-----------------------#2020-09-03">https://towardsdatascience.com/analyze-csvs-with-sql-in-command-line-233202dc1241?source=collection_archive---------6-----------------------#2020-09-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a508" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">通过命令行对 CSV 文件运行 SQL 的快速指南</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/37ac7f9355ba2f7ebdf32d3b2eb9557c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ia_pbTzuo8KiJNvSwGd13A.png"/></div></div></figure><p id="ba6e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">如果你熟悉 SQL 中的编码，你很有可能在<a class="ae lo" href="https://www.pgadmin.org/" rel="noopener ugc nofollow" target="_blank"> PgAdmin </a>、<a class="ae lo" href="https://www.mysql.com/" rel="noopener ugc nofollow" target="_blank"> MySQL </a>、<a class="ae lo" href="https://cloud.google.com/bigquery" rel="noopener ugc nofollow" target="_blank"> BigQuery </a>、<a class="ae lo" href="https://www.microsoft.com/en-us/sql-server/sql-server-2019" rel="noopener ugc nofollow" target="_blank"> SQL Server </a>等中使用它。但是有时您只想使用您的 SQL 技能对中小型数据集进行快速分析。</p><p id="abf7" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">使用<code class="fe lp lq lr ls b">csvkit</code>,您可以在命令行中对 CSV 文件运行任何 SQL。</p><p id="567a" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><code class="fe lp lq lr ls b"><a class="ae lo" href="https://csvkit.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">csvkit</a></code>是一套命令行工具，用于转换和使用 CSV，表格文件格式之王。一旦你安装了<code class="fe lp lq lr ls b">csvkit</code>，你就可以使用<code class="fe lp lq lr ls b">csvsql</code>来运行你的 SQL 命令。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="196c" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">1.装置</h1><p id="5692" class="pw-post-body-paragraph ks kt iq ku b kv ms jr kx ky mt ju la lb mu ld le lf mv lh li lj mw ll lm ln ij bi translated">如果你没有安装<code class="fe lp lq lr ls b">csvkit</code>，点击<a class="ae lo" href="https://csvkit.readthedocs.io/en/0.9.1/install.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ku ir">这里</strong> </a>并按照安装说明操作，或者如果你熟悉<code class="fe lp lq lr ls b">pip</code>你可以做以下操作。</p><pre class="kh ki kj kk gt mx ls my mz aw na bi"><span id="28d3" class="nb mb iq ls b gy nc nd l ne nf">pip install csvkit</span></pre><p id="17f1" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">您可以使用以下方式查看<code class="fe lp lq lr ls b">csvkit</code>文档。</p><pre class="kh ki kj kk gt mx ls my mz aw na bi"><span id="6041" class="nb mb iq ls b gy nc nd l ne nf">csvsql -h</span></pre></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="d89d" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">2.句法</h1><p id="9e42" class="pw-post-body-paragraph ks kt iq ku b kv ms jr kx ky mt ju la lb mu ld le lf mv lh li lj mw ll lm ln ij bi translated">现在您已经设置好了，您可以按照这个简单的结构来运行您的查询。需要注意的是，SQL 查询必须用引号括起来，并且<strong class="ku ir">必须</strong>在一行中。没有换行。</p><pre class="kh ki kj kk gt mx ls my mz aw na bi"><span id="403b" class="nb mb iq ls b gy nc nd l ne nf">csvsql --query "ENTER YOUR SQL QUERY HERE"<br/>FILE_NAME.csv</span></pre><p id="91cf" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">就是这样！遵循这个基本的代码框架，你就可以开始了。</p><p id="b0fa" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">确保您与 CSV 文件位于同一个工作目录中。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="6890" class="ma mb iq bd mc md me mf mg mh mi mj mk jw ml jx mm jz mn ka mo kc mp kd mq mr bi translated">3.例子</h1><p id="647a" class="pw-post-body-paragraph ks kt iq ku b kv ms jr kx ky mt ju la lb mu ld le lf mv lh li lj mw ll lm ln ij bi translated">下面是一个设置目录并启动和运行我们的第一个 SQL 命令的例子。</p><h2 id="5843" class="nb mb iq bd mc ng nh dn mg ni nj dp mk lb nk nl mm lf nm nn mo lj no np mq nq bi translated">检查目录</h2><pre class="kh ki kj kk gt mx ls my mz aw na bi"><span id="56a7" class="nb mb iq ls b gy nc nd l ne nf">pwd</span></pre><h2 id="0ad9" class="nb mb iq bd mc ng nh dn mg ni nj dp mk lb nk nl mm lf nm nn mo lj no np mq nq bi translated">设置工作目录</h2><p id="821f" class="pw-post-body-paragraph ks kt iq ku b kv ms jr kx ky mt ju la lb mu ld le lf mv lh li lj mw ll lm ln ij bi translated">确保您计划使用的文件位于同一目录中。我的 CSV 文件在<code class="fe lp lq lr ls b">/Documents</code>文件夹中。</p><pre class="kh ki kj kk gt mx ls my mz aw na bi"><span id="f36f" class="nb mb iq ls b gy nc nd l ne nf">cd ~/Documents</span></pre></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="e164" class="nb mb iq bd mc ng nh dn mg ni nj dp mk lb nk nl mm lf nm nn mo lj no np mq nq bi translated">运行查询</h2><p id="2a28" class="pw-post-body-paragraph ks kt iq ku b kv ms jr kx ky mt ju la lb mu ld le lf mv lh li lj mw ll lm ln ij bi translated">接下来，我们可以使用<code class="fe lp lq lr ls b">csvsql</code>运行查询</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/db88bcba804be8ba2655d778ea8ba39f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OLcICMe-piu-XyxdWH5zCA.png"/></div></div><p class="nr ns gj gh gi nt nu bd b be z dk translated">密码</p></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/5d51896f97557c737c0b8b992786114c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9FsNCQltXDIqIjSiua_cnw.png"/></div></div><p class="nr ns gj gh gi nt nu bd b be z dk translated">输出</p></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="2470" class="nb mb iq bd mc ng nh dn mg ni nj dp mk lb nk nl mm lf nm nn mo lj no np mq nq bi translated">用 csvlook 格式化查询输出</h2><p id="7f9f" class="pw-post-body-paragraph ks kt iq ku b kv ms jr kx ky mt ju la lb mu ld le lf mv lh li lj mw ll lm ln ij bi translated">使用<code class="fe lp lq lr ls b">| <strong class="ku ir">csvlook</strong></code>管道可以改善输出的查询格式。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/8768de44e09b365e7e3f6a1fc73feff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YnxtX-kZhtj5EMNDQAphNQ.png"/></div></div><p class="nr ns gj gh gi nt nu bd b be z dk translated">密码</p></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/e9c4e6437f90dea4e7673f07048c4a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xeEMrPe_6zKNWA13Gz0rIQ.png"/></div></div><p class="nr ns gj gh gi nt nu bd b be z dk translated">输出</p></figure><h2 id="515b" class="nb mb iq bd mc ng nh dn mg ni nj dp mk lb nk nl mm lf nm nn mo lj no np mq nq bi translated">将查询输出保存到新的 CSV 文件中</h2><p id="8c28" class="pw-post-body-paragraph ks kt iq ku b kv ms jr kx ky mt ju la lb mu ld le lf mv lh li lj mw ll lm ln ij bi translated">使用带有<code class="fe lp lq lr ls b"><strong class="ku ir">&gt;</strong></code>的重定向，您可以将查询输出发送到一个新的文件/位置。注意运行下面的代码不会输出任何东西，因为我们将输出保存到一个新文件中。新的查询将输出保存到新的 csv 文件<code class="fe lp lq lr ls b"><strong class="ku ir">store_sales.csv</strong></code></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/5517d983327b5010d8e8c2585f8a4c33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K7ihY1R25I661fQQ3ZnDPQ.png"/></div></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="45fb" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">你都准备好了！现在，您可以对 CSV 文件运行 SQL，无需通过数据库就能快速了解情况。</p><p id="b44e" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">如果您想了解更多关于 SQL 的知识，请查看我的其他文章。</p><ul class=""><li id="5a43" class="nv nw iq ku b kv kw ky kz lb nx lf ny lj nz ln oa ob oc od bi translated"><a class="ae lo" rel="noopener" target="_blank" href="/sql-cheat-sheet-776f8e3189fa"> SQL Cheatsheet </a></li><li id="5df4" class="nv nw iq ku b kv oe ky of lb og lf oh lj oi ln oa ob oc od bi translated"><a class="ae lo" rel="noopener" target="_blank" href="/date-time-functions-in-sql-1885e2cbdc1a">SQL 中的日期/时间函数</a></li><li id="5df3" class="nv nw iq ku b kv oe ky of lb og lf oh lj oi ln oa ob oc od bi translated"><a class="ae lo" rel="noopener" target="_blank" href="/using-ctes-to-improve-sql-queries-dfcb04b7edf0">在 SQL 中使用 CTEs】</a></li><li id="aa1e" class="nv nw iq ku b kv oe ky of lb og lf oh lj oi ln oa ob oc od bi translated"><a class="ae lo" rel="noopener" target="_blank" href="/intro-to-window-functions-in-sql-23ecdc7c1ceb">窗口功能介绍</a></li></ul></div></div>    
</body>
</html>