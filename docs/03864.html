<html>
<head>
<title>Python Pandas Dataframe to Google Sheets for Tableau Public LIVE</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 熊猫数据帧到 Google Sheets for Tableau 公共直播</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-pandas-dataframe-to-google-sheets-for-tableau-desktop-live-cc1f86982bca?source=collection_archive---------27-----------------------#2020-04-10">https://towardsdatascience.com/python-pandas-dataframe-to-google-sheets-for-tableau-desktop-live-cc1f86982bca?source=collection_archive---------27-----------------------#2020-04-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2ca5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">博客的第二部分— <br/> <a class="ae kf" rel="noopener" target="_blank" href="/automated-etl-for-live-tableau-public-visualizations-54f2b8652224">实时画面公共可视化的自动化 ETL</a></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/626d5760cdac8a25e2826a06e4261fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*dRUZ_roNoqrTo-DUtDcHPQ.gif"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated"><a class="ae kf" href="https://public.tableau.com/profile/eklavya.saxena#!/vizhome/CoronavirusCOVID-19CasesWorldwide/COVID-19_Country" rel="noopener ugc nofollow" target="_blank">https://public.tableau.com/profile/eklavya.saxena#!/viz home/CoronavirusCOVID-19 cases world wide/新冠肺炎 _Country </a></p></figure><p id="3065" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi ls translated"><span class="l lt lu lv bm lw lx ly lz ma di"> T </span>他的博客是【LIVE Tableau 公共可视化自动化 ETL 的一部分，分为三个部分，即:</p><ol class=""><li id="abae" class="mb mc iq ky b kz la lc ld lf md lj me ln mf lr mg mh mi mj bi translated">启用 Google Sheets API 并创建凭证</li><li id="7a6a" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">将 Python 连接到 Google Sheets 并导出数据帧</li><li id="5505" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">使用 Google Sheets 启用 Tableau 公共直播</li></ol></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="cfd9" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">1.启用 Google Sheets API 并创建凭证</h1><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi no"><img src="../Images/d928ec7ea27a4faaf6d77221b970458b.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*RgYpLk0WdUO9lZjwwWvU-Q.jpeg"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated"><a class="ae kf" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank">https://console.developers.google.com/</a></p></figure><p id="0f71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">访问您的<a class="ae kf" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank"> Google API 控制台</a>是连接 python 脚本和 google sheets 的第一步。循序渐进地启用 google sheets API 并创建所需的凭证。</p><h2 id="04f9" class="np mx iq bd my nq nr dn nc ns nt dp ng lf nu nv ni lj nw nx nk ln ny nz nm oa bi translated">1.1 创建一个项目</h2><ol class=""><li id="7a5d" class="mb mc iq ky b kz ob lc oc lf od lj oe ln of lr mg mh mi mj bi translated">点击左上角下拉菜单中的<em class="og">选择一个项目</em>，将会打开一个弹出窗口</li><li id="7a68" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">在弹出窗口的右上角，点击'<em class="og">新建项目</em>，这将带您进入一个新窗口</li><li id="f544" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">给你的项目取一个合适的名字(例如:covid-viz-data)。您可以保持'<em class="og">位置* </em>'字段不变，并点击'<em class="og">创建</em></li></ol><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oh"><img src="../Images/02ba45ce3dd4d17e060e7cecb2727a7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*MqS6205LB8i9K_JT-0tGsA.gif"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">1.1 GIF 创建项目</p></figure><h2 id="597c" class="np mx iq bd my nq nr dn nc ns nt dp ng lf nu nv ni lj nw nx nk ln ny nz nm oa bi translated"><strong class="ak"> 1.2 启用 Google Sheets API 和</strong> Google Drive API</h2><ol class=""><li id="8550" class="mb mc iq ky b kz ob lc oc lf od lj oe ln of lr mg mh mi mj bi translated">从左侧窗格中选择'<em class="og">库</em>'(在'<em class="og">仪表板</em>'下)，这将把您重定向到'<em class="og"> API 库</em>'窗口，其中有一个搜索 API 和服务的选项</li><li id="1f33" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">在字段'<a class="ae kf" href="https://developers.google.com/sheets/api" rel="noopener ugc nofollow" target="_blank"> <em class="og">中键入 Google Sheets API </em> </a>'并从结果中选择它，这将重定向到 Google Sheets API 窗口</li><li id="fd21" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">点击<em class="og">启用</em>，为您在上一步中创建的项目启用它</li></ol><p id="9869" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">类似地，启用<a class="ae kf" href="https://developers.google.com/drive" rel="noopener ugc nofollow" target="_blank"> Google Drive API </a>，因为稍后导入的 python 库可能会使用上述两个 API 的功能。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oh"><img src="../Images/495793a9dbd31798e5673c7c882e319e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ykRlnqhx_8Bw2vx1i_nQzA.gif"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">启用 Google Sheets API 的 1.2 GIF</p></figure><h2 id="c574" class="np mx iq bd my nq nr dn nc ns nt dp ng lf nu nv ni lj nw nx nk ln ny nz nm oa bi translated">1.3 创建访问 API 的凭证</h2><p id="db67" class="pw-post-body-paragraph kw kx iq ky b kz ob jr lb lc oc ju le lf oi lh li lj oj ll lm ln ok lp lq lr ij bi translated">您可以在 Google Sheets API 窗口的右侧选择“<em class="og">创建凭证</em>，或者如果您在仪表板上，从步骤 1 开始。</p><ol class=""><li id="3060" class="mb mc iq ky b kz la lc ld lf md lj me ln mf lr mg mh mi mj bi translated">从左侧窗格中选择“<em class="og">凭证</em>”(在“<em class="og">库</em>”下)。这将在右侧向您显示'<em class="og">凭证</em>窗格</li><li id="90e1" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">点击顶部的“<em class="og">创建凭证</em>”选项，这将显示一个下拉菜单</li><li id="0abc" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">单击下拉菜单中的“<em class="og">帮助我选择</em>选项，这将重定向到标题为“<em class="og">将凭证添加到您的项目</em>”的窗格</li><li id="0951" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">在这个'<em class="og">将凭证添加到您的项目中</em>'窗格中跟随:<br/> <br/>步骤 1: ' <em class="og">找出您需要哪种凭证</em> ' <br/>您正在使用哪个 API？— <strong class="ky ir"> Google Sheets API </strong> <br/>你会从哪里调用这个 API？— <strong class="ky ir"> Web 服务器<br/> </strong>您将访问哪些数据？— <strong class="ky ir">应用数据<br/> </strong>您打算将此 API 与 App Engine 或 Compute Engine 一起使用吗？— <strong class="ky ir">不，我现在没有使用它们<br/> </strong>，单击“<em class="og">我需要什么凭证？</em>根据我们输入的建议<br/> <br/>步骤 2:<em class="og">创建服务帐户</em><br/>服务帐户名称— <strong class="ky ir">(例如:covid-data-update) </strong> <br/>角色— <strong class="ky ir">编辑器</strong>(从下拉列表中选择“<em class="og">项目</em>，然后选择“<em class="og">编辑器</em>”)<br/>服务帐户 ID —自动创建的<br/>密钥类型—<br/>这将要求您保存凭证。允许访问您的云资源的 json 文件— <strong class="ky ir"> <em class="og">因此安全地存储它</em> </strong>。</li></ol><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oh"><img src="../Images/61efbc3eabd0621ddeb28ca8c8d396eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*EvIF-ixq0ixnPf81F93HdA.gif"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">1.3 GIF 到 1.3 创建访问 API 的凭证</p></figure><h2 id="b5d8" class="np mx iq bd my nq nr dn nc ns nt dp ng lf nu nv ni lj nw nx nk ln ny nz nm oa bi translated">1.4 在中与客户电子邮件共享谷歌表单。json 凭证文件</h2><p id="10f9" class="pw-post-body-paragraph kw kx iq ky b kz ob jr lb lc oc ju le lf oi lh li lj oj ll lm ln ok lp lq lr ij bi translated">现在我们有了访问 API 的秘密凭证(保存在。json 格式)，我们需要确保目标 google sheet 与以该格式生成的客户端电子邮件共享。json 文件。</p><ol class=""><li id="4e65" class="mb mc iq ky b kz la lc ld lf md lj me ln mf lr mg mh mi mj bi translated">从中的“<em class="og"> client_email </em>”键复制电子邮件地址值。json 文件</li><li id="2367" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">创建一个新的 google 工作表，用于导出数据</li><li id="ca6c" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">打开表单后，点击右上角的<em class="og">共享</em></li><li id="7966" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">粘贴复制的电子邮件地址，并授予其“Can e <em class="og"> dit </em>”访问权限</li></ol><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oh"><img src="../Images/4b291994ec69be02bcfd7645a487771b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*IWy6RmpJIOkOwTiYFPi19g.gif"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">1.4 GIF 与客户端电子邮件共享谷歌表。json 凭证文件</p></figure><p id="4152" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">恭喜你！我们已经成功地从<a class="ae kf" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank"> Google API 控制台</a>启用了<a class="ae kf" href="https://developers.google.com/sheets/api" rel="noopener ugc nofollow" target="_blank"> Google Sheets API </a>，并创建了通过 python 脚本访问该 API 的凭证。现在，让我们进入第二部分。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="4981" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">2.将 Python 连接到 Google Sheets 并导出数据帧</h1><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ol"><img src="../Images/0e53ab85163aa29fc763003483687d93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kgLuKKRGS3Y8RPTQe6hOYQ.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated"><a class="ae kf" href="https://developers.google.com/sheets/api/quickstart/python" rel="noopener ugc nofollow" target="_blank">https://developers.google.com/sheets/api/quickstart/python</a></p></figure><p id="b80c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然 Google 创建了 Google Sheets API，但是他们当然没有留下来为<a class="ae kf" href="https://developers.google.com/sheets/api/quickstart/python" rel="noopener ugc nofollow" target="_blank"> Python QuickStart </a>创建一个精美的指南。我强烈推荐参考它，因为额外的文档/指南提供了使用 Google Sheets 的巨大可能性。</p><p id="ab63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">那为什么是这个博客呢？</strong> <br/>快速入门要求你安装 3 个库，分别是<em class="og">Google-API-python-client</em>、<em class="og"> google-auth-httplib2 </em>、<em class="og"> google-auth-oauthlib </em>。但是，从大量的 python 库来看，我们有:</p><blockquote class="om"><p id="7f78" class="on oo iq bd op oq or os ot ou ov lr dk translated"><a class="ae kf" href="https://pygsheets.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">pyg Sheets</a>——一个简单、直观的 python 库，通过 google Sheets API v4 访问 Google 电子表格</p></blockquote><p id="14b6" class="pw-post-body-paragraph kw kx iq ky b kz ow jr lb lc ox ju le lf oy lh li lj oz ll lm ln pa lp lq lr ij bi translated">这一部分将利用 pyghseets 导出数据框架到谷歌表。让我们开始吧:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pb"><img src="../Images/d7bad811da03e8358fb0dbfe4add919d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oM95kSUuVNanGmxUflnQmw.jpeg"/></div></div></figure><pre class="kh ki kj kk gt pc pd pe pf aw pg bi"><span id="128c" class="np mx iq pd b gy ph pi l pj pk">import sys<br/>!{sys.executable} -m pip install pygsheets</span></pre><p id="2a0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为什么我没有使用<code class="fe pl pm pn pd b">!pip install pyghseets</code>？在 Jupyter 中，上面的代码确保您运行的是与当前 Python 内核相关联的 pip 版本。另外，仅供参考，shell 环境和 Python 可执行文件是断开的。点击此处了解更多信息。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi po"><img src="../Images/50ff5ed0ea065c67254d66dd2d6bd4fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JHY0QyQkO7hrsWSWtC24Dg.jpeg"/></div></div></figure><pre class="kh ki kj kk gt pc pd pe pf aw pg bi"><span id="643f" class="np mx iq pd b gy ph pi l pj pk">import pygsheets</span><span id="c3f6" class="np mx iq pd b gy pp pi l pj pk">client = pygsheets.authorize(service_file='/Users/eklav/<strong class="pd ir">credentials.json</strong>')<br/>print("-----------------Authorized--------------------")</span></pre><p id="4b8c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">安装完成后，下一步当然是导入库。然后，使用<code class="fe pl pm pn pd b"><a class="ae kf" href="https://pygsheets.readthedocs.io/en/stable/reference.html#authorization" rel="noopener ugc nofollow" target="_blank">authorize</a></code>功能创建一个变量<code class="fe pl pm pn pd b">client</code>,用 google 帐户认证 python 脚本(或应用程序)。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi po"><img src="../Images/45ecb16d079434e141c0ce8a3b9c7c62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3g8TQI-56sI7pTyzAVPXhg.jpeg"/></div></div></figure><pre class="kh ki kj kk gt pc pd pe pf aw pg bi"><span id="76df" class="np mx iq pd b gy ph pi l pj pk">sheet = client.open('COVID-19')<br/>print("-----------------Sheet Opened------------------")</span></pre><p id="4bf5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，使用<code class="fe pl pm pn pd b"><a class="ae kf" href="https://pygsheets.readthedocs.io/en/stable/reference.html#pygsheets.client.Client.open" rel="noopener ugc nofollow" target="_blank">open</a></code>功能按标题(例如:<em class="og">新冠肺炎</em>’)返回电子表格(在上一部分创建)，并将其赋给变量<code class="fe pl pm pn pd b">sheet</code>。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi po"><img src="../Images/a0693466f46287ae2774bdfc7ad3a844.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fsJmEtt6w5heGjq_EPrcZg.jpeg"/></div></div></figure><pre class="kh ki kj kk gt pc pd pe pf aw pg bi"><span id="41c7" class="np mx iq pd b gy ph pi l pj pk">wks = sheet[0]<br/>print("-----------------First Sheet Accessed----------")</span></pre><p id="bd94" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了访问第一个工作表，将工作表<code class="fe pl pm pn pd b">sheet</code>的第<em class="og">0</em>个索引分配给变量<code class="fe pl pm pn pd b">wks</code>。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pq"><img src="../Images/a1b3b979e227e5fa94195f5a66aa4bb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yWcoOoG0QYU00kiY1caXHw.jpeg"/></div></div></figure><pre class="kh ki kj kk gt pc pd pe pf aw pg bi"><span id="7f9a" class="np mx iq pd b gy ph pi l pj pk">wks.set_dataframe(df_COVID,(1,1))<br/>print("-----------------Data Updated------------------")</span></pre><p id="f566" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，使用工作表<code class="fe pl pm pn pd b">wks</code>的<code class="fe pl pm pn pd b">.set_dataframe</code>功能将'<em class="og"> df_COVID </em> '*和'<em class="og"> (1，1) </em>'分别赋值给'<strong class="ky ir"> <em class="og"> df </em> </strong>'和'<strong class="ky ir"> <em class="og"> start </em> </strong>'参数。<br/>值“<em class="og"> (1，1) </em>”是指电子表格的 A1 单元格。</p><blockquote class="pr ps pt"><p id="6231" class="kw kx og ky b kz la jr lb lc ld ju le pu lg lh li pv lk ll lm pw lo lp lq lr ij bi translated">要了解 dataframe ' <strong class="ky ir"> df_COVID </strong>是如何策划的，请参考博客<a class="ae kf" rel="noopener" target="_blank" href="/automated-etl-for-live-tableau-public-visualizations-54f2b8652224">的第一部分—<strong class="ky ir">从 GitHub 提取数据并自动运行或调度 Python 脚本</strong></a>。</p></blockquote><p id="9494" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就把我们带到了这一部分的结尾。我们启用了 API 和凭证，使用它们将 Python 连接到 Google Sheets——您的免费云存储。</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="f14f" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">3.使用 Google Sheets 启用 Tableau 公共直播</h1><p id="08c7" class="pw-post-body-paragraph kw kx iq ky b kz ob jr lb lc oc ju le lf oi lh li lj oj ll lm ln ok lp lq lr ij bi translated">正如在母博客中提到的，最终是时候打破 Tableau Public 不能拥有实时数据的神话了。到目前为止，我们已经有了一个由 Windows 任务调度器自动运行的 Python 脚本，它反过来更新 Google 工作表。这张表将成为我们在 Tableau Public 上发布的仪表盘或可视化数据的来源。</p><h2 id="925b" class="np mx iq bd my nq nr dn nc ns nt dp ng lf nu nv ni lj nw nx nk ln ny nz nm oa bi translated">3.1 将 Tableau 连接到 Google Sheet</h2><p id="6c0e" class="pw-post-body-paragraph kw kx iq ky b kz ob jr lb lc oc ju le lf oi lh li lj oj ll lm ln ok lp lq lr ij bi translated">我将不再详述一个众所周知的步骤——从 Tableau 起始页中选择一个数据源。如果需要，请遵循下面的 GIF:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oh"><img src="../Images/2d804e6eef48fc6c257bf1bbbde013cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*xWC5kIgJmyVnsLn4B8UiwA.gif"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">3.1 GIF 将 Tableau 连接到 Google Sheet</p></figure><p id="1763" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好了，现在你可以根据需要用来自你的 Google Sheets 的实时数据创建可视化了</p><h2 id="a4cf" class="np mx iq bd my nq nr dn nc ns nt dp ng lf nu nv ni lj nw nx nk ln ny nz nm oa bi translated">3.2 在 Tableau Public 上发布工作簿</h2><p id="37fb" class="pw-post-body-paragraph kw kx iq ky b kz ob jr lb lc oc ju le lf oi lh li lj oj ll lm ln ok lp lq lr ij bi translated">虽然你有一个与谷歌工作表的实时连接，它必须直接发布工作簿。登录<a class="ae kf" href="https://public.tableau.com" rel="noopener ugc nofollow" target="_blank">https://public.tableau.com</a>服务器，分享即可。</p><p id="8602" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，问题就在这里！将弹出以下错误:</p><blockquote class="om"><p id="dec6" class="on oo iq bd op oq or os ot ou ov lr dk translated">您要发布到的 Tableau 服务器要求对数据源启用提取。使用数据菜单启用以下数据源的提取:</p><p id="59a0" class="on oo iq bd op oq or os ot ou ov lr dk translated">需要数据提取"</p></blockquote><p id="17e4" class="pw-post-body-paragraph kw kx iq ky b kz ow jr lb lc ox ju le lf oy lh li lj oz ll lm ln pa lp lq lr ij bi translated">现在的问题是— <strong class="ky ir">数据提取？？？</strong></p><p id="67d4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从 Google Sheets 获取数据的全部意义在于拥有实时连接。这就是我们认为 Tableau Public 只处理摘录的地方。</p><p id="a7e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，Tableau 还有更多的服务——不要眨眼，直接连接到“<em class="og"> Extract </em>”。现在，当您共享时，勾选显示以下内容的复选框并保存:</p><blockquote class="om"><p id="510b" class="on oo iq bd op oq or os ot ou ov lr dk translated">“保持我的数据与 Google 工作表同步，并嵌入我的 Google 凭据”</p></blockquote><p id="d82d" class="pw-post-body-paragraph kw kx iq ky b kz ow jr lb lc ox ju le lf oy lh li lj oz ll lm ln pa lp lq lr ij bi translated">点击“<em class="og">保存</em>”按钮后，您将被重新定向到 Tableau Public，您的仪表板已发布。向下滚动并注意到“<em class="og">请求更新</em>按钮。此按钮用于强制更新仪表板，从 Google 工作表中访问最新数据。不然不然我经历的 Tableau 每天自动刷新仪表盘。</p><p id="d034" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">答对了。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi px"><img src="../Images/0cfc147c1b8f0e3461b1b396106e5b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*sigAxhFK3K_OpImXywrOsQ.gif"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">3.2 在 Tableau Public 上发布工作簿的 GIF</p></figure></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><h1 id="7d73" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">参考</h1><ul class=""><li id="27b1" class="mb mc iq ky b kz ob lc oc lf od lj oe ln of lr py mh mi mj bi translated"><a class="ae kf" href="https://developers.google.com/sheets/api/guides/concepts" rel="noopener ugc nofollow" target="_blank">Google Sheets API 简介</a></li><li id="b623" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr py mh mi mj bi translated"><a class="ae kf" href="https://erikrood.com/Posts/py_gsheets.html" rel="noopener ugc nofollow" target="_blank">使用 Python 读写 Google 电子表格，作者 Erik Rood </a></li><li id="a22b" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr py mh mi mj bi translated"><a class="ae kf" href="https://pygsheets.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">关于 pygsheets Python 库的文档</a></li></ul></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><p id="db6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您的阅读！我希望这个博客揭示了 Tableau 公共有趣的一面。继续下去，让你的可视化生活。如果这篇文章是有帮助的，分享它。</p><p id="f4a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请在评论中告诉我:</p><ol class=""><li id="c287" class="mb mc iq ky b kz la lc ld lf md lj me ln mf lr mg mh mi mj bi translated">如果你觉得这有用或没用，或者</li><li id="dd4d" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">如果您想了解 Tableau 可视化中使用的不同功能的<em class="og">如何使用</em></li></ol><div class="pz qa gp gr qb qc"><a href="https://github.com/eklavyasaxena/COVID-19" rel="noopener  ugc nofollow" target="_blank"><div class="qd ab fo"><div class="qe ab qf cl cj qg"><h2 class="bd ir gy z fp qh fr fs qi fu fw ip bi translated">eklavyasaxena/新冠肺炎</h2><div class="qj l"><h3 class="bd b gy z fp qh fr fs qi fu fw dk translated">来自 JHU CSSE GitHub Repo 的 ETL 创建 Tableau 可视化。ETL: Extract 中执行的步骤。GitHub 中的 csv 文件…</h3></div><div class="qk l"><p class="bd b dl z fp qh fr fs qi fu fw dk translated">github.com</p></div></div><div class="ql l"><div class="qm l qn qo qp ql qq kq qc"/></div></div></a></div><div class="pz qa gp gr qb qc"><a href="https://www.linkedin.com/in/eklavyasaxena/" rel="noopener  ugc nofollow" target="_blank"><div class="qd ab fo"><div class="qe ab qf cl cj qg"><h2 class="bd ir gy z fp qh fr fs qi fu fw ip bi translated">Eklavya Saxena -印度|职业简介| LinkedIn</h2><div class="qj l"><h3 class="bd b gy z fp qh fr fs qi fu fw dk translated">精通数据的分析师和有抱负的数据科学家，拥有 2 年以上的销售或客户行业经验…</h3></div><div class="qk l"><p class="bd b dl z fp qh fr fs qi fu fw dk translated">www.linkedin.com</p></div></div><div class="ql l"><div class="qr l qn qo qp ql qq kq qc"/></div></div></a></div></div></div>    
</body>
</html>