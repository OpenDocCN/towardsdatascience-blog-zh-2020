<html>
<head>
<title>A guide to basic Exploratory Data Analysis using Pandas.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Pandas 的基本探索性数据分析指南。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-quick-guide-to-exploratory-data-analysis-using-pandas-959b7ea1483e?source=collection_archive---------46-----------------------#2020-04-20">https://towardsdatascience.com/a-quick-guide-to-exploratory-data-analysis-using-pandas-959b7ea1483e?source=collection_archive---------46-----------------------#2020-04-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b44b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">更好地理解您的数据。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ee79b4b48e708cf1a15addfe526204ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SuY5vFBe3r1a5dbck7jYAg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">艾萨克·史密斯在<a class="ae ky" href="https://unsplash.com/s/photos/analysis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="abf0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用库(比如 Matplotlib)绘制图形或查询数据相对容易。然而，为了能够绘制图表，数据必须采用特定的格式。这篇文章背后的动机之一是理解如何为进一步的处理准备数据。本文还讨论了执行基本操作，如查询、排序和可视化 Pandas 数据帧。</p><h1 id="5944" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">读取数据。</h1><p id="8c62" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">虽然数据可以以多种格式提供，但为了便于讨论，我们假设数据是逗号分隔值(CSV)格式。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="5b21" class="mx lw it mt b gy my mz l na nb">import pandas as pd<br/>df = pd.read_csv("path/to/file.csv")</span></pre><p id="31bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的语法非常标准，大多数时候已经足够了。<em class="nc"> read_csv() </em>的默认行为假设 csv 文件中的第一行是列标题，并将其用作创建的数据框的标题。但是，下面的变化要求使用第一行作为数据的一部分。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="7638" class="mx lw it mt b gy my mz l na nb">df = pd.read_csv("path/to/file.csv", <!-- -->header=None)</span></pre><p id="7c11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，您可以将列标题明确指定为—</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="7f04" class="mx lw it mt b gy my mz l na nb">df = pd.read_csv("path/to/file.csv", names=["Column 1", "Column 2"]<!-- -->)</span></pre><p id="018e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果未指定<em class="nc"> names </em>参数，则从 0 开始对列进行索引。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/d11d286c7459c526dd8e05c5d3f7f748.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h9UNV4lyX3kdLYd-RP0FYg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">read_csv()函数概述。(使用谷歌幻灯片创建)。</p></figure><h1 id="f612" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">熟悉数据。</h1><p id="8a21" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">一旦你读了你的数据，下一步就是让你自己适应数据集。让我们从查看数据集中的记录数量开始。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="4d65" class="mx lw it mt b gy my mz l na nb">#Assume that the data is stored in a variable df<br/>rowsInData = df.shape[0]<br/>colsInData = df.shape[1]</span><span id="ad8d" class="mx lw it mt b gy ne mz l na nb">#A concise way<br/>rowsInData, colsInData = df.shape</span></pre><p id="ca01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦你知道了数据的大小，让我们看看数据是什么样子的。您可以使用<em class="nc"> head() </em>函数来查看数据集的起始行。<em class="nc"> tail() </em>函数用于查看数据集的底部行。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="6114" class="mx lw it mt b gy my mz l na nb">df.head()</span><span id="f44d" class="mx lw it mt b gy ne mz l na nb"># The default behaviour of head() is to show the first five rows of the data. You can pass an integer value to view more or less rows. The following variation shows the first 10 row.</span><span id="4ba4" class="mx lw it mt b gy ne mz l na nb">df.head(10)</span></pre><p id="2d1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看到这些数据后，让我们试着更好地理解这些数据。如果您知道存储在列中的数据的数据类型，这将非常有帮助。它帮助您将适当的功能应用到列。例如，如果列是 float 或 integer 数据类型，那么您可以对它们应用像<em class="nc"> mean() </em>和<em class="nc"> max() </em>这样的函数。<em class="nc"> info() </em>函数返回数据帧的摘要以及每一列的数据类型。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="ccaa" class="mx lw it mt b gy my mz l na nb">df.info()</span></pre><p id="51ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看存储在列中的不同类型的数据。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="7f9b" class="mx lw it mt b gy my mz l na nb">df[col].value_counts(dropna=False)</span></pre><p id="5eb8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的命令将帮助你看到你存储在' col '中的每一项的频率。在某些情况下，您可能会看到不想要的值，例如数字的 NaN 值或字符串的空值。让我们在下一节讨论如何清理数据集。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/dd9d7a4de5b414f97b5b0905c3ae3d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BXAtcxbOMyfhsJomdE0c2w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熟悉数据集的总结。(使用谷歌幻灯片创建)。</p></figure><h2 id="7955" class="mx lw it bd lx nf ng dn mb nh ni dp mf li nj nk mh lm nl nm mj lq nn no ml np bi translated">清理数据集。</h2><p id="8752" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">清理数据集最简单的方法是删除包含不需要的值的行。另一个令人信服的方法是估算缺失数据。让我们看看如何处理非数字(NaN)值。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="b3a8" class="mx lw it mt b gy my mz l na nb">#To get the count of null values in each column use the following syntax<br/>df.isnull().sum()</span><span id="cec1" class="mx lw it mt b gy ne mz l na nb">#Dropna removes rows containing NaN values.<br/>df.dropna()</span></pre><p id="0ea6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了删除行之外，您还可以选择用 0 来替换 NaN 值，或者用相应列的平均值来替换它。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="5a08" class="mx lw it mt b gy my mz l na nb">#Fill missing values with zeros<br/>df[col].fillna(0, inplace=True)</span><span id="8cdf" class="mx lw it mt b gy ne mz l na nb">#Fill missing values with column mean<br/>mean = df[col].mean()<br/>df[col].fillna(mean,inplace=True)</span><span id="2c70" class="mx lw it mt b gy ne mz l na nb"># inplace = True parameter modifies the original dataframe. In case inplace = False a new data frame is returned after the necessary operations are applied.</span></pre><p id="3cfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显然，您不能计算字符串值的平均值，但是可以使用 comparison 和 regex 来查找不需要的格式的字符串，并用您选择的值替换它们，或者删除相应的行。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="c85c" class="mx lw it mt b gy my mz l na nb">#There can be multiple ways to drop rows but let's see two ways </span><span id="69e2" class="mx lw it mt b gy ne mz l na nb">#The following command replaces strings having a single space character with NaN and then uses dropna() function to remove the rows as discussed earlier.</span><span id="c8c9" class="mx lw it mt b gy ne mz l na nb">df[col].replace(' ', np.nan, inplace=True)<br/>df.dropna()</span><span id="d538" class="mx lw it mt b gy ne mz l na nb">#If you are familiar with regex it can be extremely useful. The following command uses regular expressions to grab a string which is composed of whitespaces (\s in regex refers to whitespace characters) and replaces them with NaN.</span><span id="2325" class="mx lw it mt b gy ne mz l na nb">df[col].replace(r'^\s*$', np.nan, regex=True, inplace=True)<br/>df.dropna()</span></pre><p id="486b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您不想删除，而是想要替换丢失的字符串值，您可以按如下方式操作—</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="bc73" class="mx lw it mt b gy my mz l na nb">#Replace using strict comparison<br/>df[col].replace(' ', "Some Value", inplace=True)</span><span id="6e96" class="mx lw it mt b gy ne mz l na nb">#Replace using regular expression<br/>df[col].replace(r'^\s*$', "Some Value", regex=True, inplace=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/0a6c9f8a686a9c190e3489bc3da02dc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e6gWcugs7wxfC25fTwCrGA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据集清理总结。(使用谷歌幻灯片创建)。</p></figure><h2 id="4092" class="mx lw it bd lx nf ng dn mb nh ni dp mf li nj nk mh lm nl nm mj lq nn no ml np bi translated">更改列的数据类型。</h2><p id="664d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">假设您希望 CSV 中的某个特定字段只有整数值，但是该列意外地有一个字符串值。在这种情况下，不能将列作为整数处理。让我们看看如何处理这种情况。</p><p id="529f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如前所述，您可以选择查找字符串值并用任何合适的值替换它。</p><p id="2bf2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦替换了字符串值，就可以按如下方式转换列的数据类型</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="b7de" class="mx lw it mt b gy my mz l na nb">df[col] = pd.to_numeric(df[col])</span></pre><h1 id="ada6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用数据集。</h1><p id="744b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">一旦处理完数据，下一步就是从数据中提取有价值的信息。为了便于讨论，让我们考虑一个由几个学生的分数组成的非常小的数据集。下面是 CSV 数据的表格表示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">讨论中使用的数据集的表格表示。</p></figure><h2 id="8fb2" class="mx lw it bd lx nf ng dn mb nh ni dp mf li nj nk mh lm nl nm mj lq nn no ml np bi translated">查询数据。</h2><p id="21d5" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">基本的查询是列出分数高于某个值的学生。以下查询显示了 Test1 得分大于 15 的所有记录。除了大于号运算符，还可以使用其他关系运算符，如&gt; =、</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="1713" class="mx lw it mt b gy my mz l na nb">df.query('Test1 &gt; 15')</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Rows in which marks stored in Test1 are more than 15.</p></figure><p id="a67b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">The following query shows how to perform comparison on string values. There also exists the not equal (!=) operator. The following query retrieves marks for John.</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="a7e8" class="mx lw it mt b gy my mz l na nb">df.query('Name == "John"')</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Retrieving marks for John.</p></figure><p id="977e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Apart from basic comparison for string you can also apply functions such as <em class="nc"> startswith() </em>、<em class="nc"> endswith() </em>和<em class="nc"> contains() </em>来过滤数据。以下示例查询姓名以 j 开头的学生的分数。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="6a8e" class="mx lw it mt b gy my mz l na nb">df.query('Name.str.startswith("J")', engine='python')</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">检索姓名以 j 开头的学生的分数。</p></figure><p id="a677" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然 pandas 提供了基于字符串值列的过滤方法，但是没有比使用 regex 更强大的了。下面的示例使用 regex 检索以开头的名称。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="f789" class="mx lw it mt b gy my mz l na nb">df.query('Name.str.contains("^A", regex=True)', engine='python')</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用正则表达式获取姓名以 a 开头的学生的分数。</p></figure><p id="8650" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您也可以使用<em class="nc">和</em>和<em class="nc">或</em>组合多个条件。以下查询检索学生在前两次测试中得分超过 16 分的记录。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="5aa1" class="mx lw it mt b gy my mz l na nb">df.query('Test1 &gt; 16 and Test2 &gt; 16)')</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">学生在测试 1 和测试 2 中的分数超过 16 分的记录。</p></figure><p id="fbc3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您并不总是希望将值与常数进行比较。以下语法用于比较两列的相应值，并返回满足条件的行。该查询显示了与第一次测试相比，在第二次测试中成绩有所提高的学生列表。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="45db" class="mx lw it mt b gy my mz l na nb">df.query('Test1 &lt; Test2')</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">与测试 1 相比，学生在测试 2 中的表现有所提高的记录。</p></figure><h2 id="851f" class="mx lw it bd lx nf ng dn mb nh ni dp mf li nj nk mh lm nl nm mj lq nn no ml np bi translated">列选择。</h2><p id="1b35" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">您可能不希望看到包含所有列的结果。让我们来看看如何有条件地检索仅用于 Test2 的标记。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="2f37" class="mx lw it mt b gy my mz l na nb">#The following statement shows just the Name and Test2 columns only if test2 marks are more than 15. It doesn't show full rows as earlier.</span><span id="625e" class="mx lw it mt b gy ne mz l na nb">df[['Name', 'Test2']].query('Test2 &gt; 15')</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">仅显示名称和 Test2 列，因此 Test2 &gt; 15。</p></figure><h2 id="037c" class="mx lw it bd lx nf ng dn mb nh ni dp mf li nj nk mh lm nl nm mj lq nn no ml np bi translated">整理数据。</h2><p id="0573" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">下一个最常见的操作是对数据进行排序。让我们看一个例子，按照 Test3 中获得的分数降序排列学生。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="18a0" class="mx lw it mt b gy my mz l na nb">#Let's select only Name and Test3 columns first.<br/>temp = df[['Name', 'Test3']]</span><span id="5a3a" class="mx lw it mt b gy ne mz l na nb">#Now's let's sort by Test3 in ascending order.<br/>temp.sort_values(by=['Test3'])</span><span id="0063" class="mx lw it mt b gy ne mz l na nb">#Sorting by Test3 in descending order.<br/>temp.sort_values(by=['Test3'], ascending=False)</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq nr l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按降序排列的 Test3。</p></figure><h2 id="157d" class="mx lw it bd lx nf ng dn mb nh ni dp mf li nj nk mh lm nl nm mj lq nn no ml np bi translated">绘制数据图表。</h2><p id="6386" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">您可以使用 Matpoltlib 等库来绘制和可视化数据，这将有助于快速找到数据中的趋势和模式。但是为了统一起见，让我们使用 Pandas dataframe 类提供的<em class="nc"> plot() </em>函数。</p><p id="7a0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“姓名”和“测试 1”中得分的条形图。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="8a14" class="mx lw it mt b gy my mz l na nb">df.plot.bar(x='Name', y='Test1')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/ae6e005374d5b0da49ca1ba179fbe316.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*f1qq5ibDzkKia0L5YT4t9g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测试 1 的分数。</p></figure><p id="d323" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下图比较了每个学生在所有三次考试中的分数。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="74b0" class="mx lw it mt b gy my mz l na nb">df.plot.bar(x='Name', y=['Test1', 'Test2', 'Test3'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/dade647b8da2b989a236a2b3316eccfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*nh5oRI4Ifap0nO5kpd_IKA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每个学生在三次测验中的分数。</p></figure><p id="e124" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您当然可以根据自己的需求绘制更多信息图表，但是为了使讨论简单，我们就在这里结束吧。</p></div></div>    
</body>
</html>