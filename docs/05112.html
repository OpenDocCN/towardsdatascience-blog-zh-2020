<html>
<head>
<title>How to deploy your ML models into the browser</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将您的ML模型部署到浏览器中</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-deploy-your-ml-models-into-the-browser-f52ea62bfa60?source=collection_archive---------36-----------------------#2020-05-02">https://towardsdatascience.com/how-to-deploy-your-ml-models-into-the-browser-f52ea62bfa60?source=collection_archive---------36-----------------------#2020-05-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="2334" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">来自TensorFlow的jS哥哥的嗨</h2><div class=""/><div class=""><h2 id="e851" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">以及如何有效地做到这一点。</h2></div><p id="c4c9" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">当我刚开始学习AI和ML时，我经常会有这样的问题:我为什么要学习这个？在找到工作之前，我能有所作为吗？</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/23a952c93ad2b27d596ae777a205fda9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m6Kzaze9vAhx0o7ZAsXxuw.jpeg"/></div></div></figure><p id="f8bf" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这些问题出现是因为<em class="lz">我知道如何训练模型</em>，但不知道<strong class="kt jd"> <em class="lz">如何部署</em> </strong>。因此，如果你正处于这个阶段，并且想学习如何使用模型，那么你来对地方了！</p><h2 id="739f" class="ma mb it bd mc md me dn mf mg mh dp mi la mj mk ml le mm mn mo li mp mq mr iz bi translated">我是谁</h2><p id="d03f" class="pw-post-body-paragraph kr ks it kt b ku ms kd kw kx mt kg kz la mu lc ld le mv lg lh li mw lk ll lm im bi translated">我是Dweep，一个充满热情的高中生，从各种课程和项目中获得了许多深度学习知识。</p><h2 id="d76b" class="ma mb it bd mc md me dn mf mg mh dp mi la mj mk ml le mm mn mo li mp mq mr iz bi translated">认识一下TensorFlow的哥哥TensorFlow.jS</h2><p id="6cc4" class="pw-post-body-paragraph kr ks it kt b ku ms kd kw kx mt kg kz la mu lc ld le mv lg lh li mw lk ll lm im bi translated">我们都知道TensorFlow，以及如何在TensorFlow中制作模型(如果你不知道，那么我会推荐你阅读<a class="ae mx" href="https://lightspeedac.blogspot.com/2020/03/lightspeed-intro-to-deep-learning.html" rel="noopener ugc nofollow" target="_blank">这篇博客</a>，然后回到这里。)然而，它的<em class="lz"> javaScript兄弟</em>却是相当的鲜为人知。但这并不意味着TensorFlow.jS(也称为tfjs)就没那么有用。大部分TensorFlow模型可以直接转向tfjs模型，tfjs本身也有能力训练模型！</p><h2 id="7b2a" class="ma mb it bd mc md me dn mf mg mh dp mi la mj mk ml le mm mn mo li mp mq mr iz bi translated">关于你下一步要做的事情</h2><p id="502a" class="pw-post-body-paragraph kr ks it kt b ku ms kd kw kx mt kg kz la mu lc ld le mv lg lh li mw lk ll lm im bi translated">我深信<em class="lz">代码是学习代码</em>的最佳方式。因此，在本文的最后，您将在浏览器上实现一个tfjs系统。顺便说一下，我从Coursera上的数据和部署专业化的第一门课程中学到了大部分内容，我在这里<a class="ae mx" href="https://lightspeedac.blogspot.com/2020/04/a-honest-review-of-data-and-deployment.html" rel="noopener ugc nofollow" target="_blank">回顾了一下</a>。因为tfjs最常见的用例是迁移学习，所以您将实现它。</p><p id="e8ec" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">为了使<em class="lz">尽可能与tensor flow</em>相关，我将首先解释TensorFlow Keras库和tfjs层库之间的关系。</p><h1 id="c7be" class="my mb it bd mc mz na nb mf nc nd ne mi ki nf kj ml kl ng km mo ko nh kp mr ni bi translated">代码风格的显著差异</h1><p id="b6f3" class="pw-post-body-paragraph kr ks it kt b ku ms kd kw kx mt kg kz la mu lc ld le mv lg lh li mw lk ll lm im bi translated">就像Keras构建在TensorFlow库之上以提供高级功能一样，Layers库也为tfjs做了同样的事情。</p><h2 id="437b" class="ma mb it bd mc md me dn mf mg mh dp mi la mj mk ml le mm mn mo li mp mq mr iz bi translated">忘记下划线</h2><p id="de2a" class="pw-post-body-paragraph kr ks it kt b ku ms kd kw kx mt kg kz la mu lc ld le mv lg lh li mw lk ll lm im bi translated">所有的jS代码都在<em class="lz">lower case</em>中，这意味着所有的一切都应该有小写的第一个单词的第一个字母(像<em class="lz"> l </em>)，以及大写的第一个单词(像<em class="lz"> C </em>)。所有的函数和语法都遵循这个规则。因此，我们应该使用<em class="lz"> inputShape </em>而不是<em class="lz"> input_shape </em>。此外，所有语法都以分号结尾。</p><h2 id="1d91" class="ma mb it bd mc md me dn mf mg mh dp mi la mj mk ml le mm mn mo li mp mq mr iz bi translated">数据到张量</h2><p id="e21a" class="pw-post-body-paragraph kr ks it kt b ku ms kd kw kx mt kg kz la mu lc ld le mv lg lh li mw lk ll lm im bi translated">由于javaScript没有NumPy，所有数据都需要转化为张量，供tfjs进行推理或训练模型。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="17b5" class="ma mb it bd mc md me dn mf mg mh dp mi la mj mk ml le mm mn mo li mp mq mr iz bi translated">使用{ }进行配置</h2><p id="20a8" class="pw-post-body-paragraph kr ks it kt b ku ms kd kw kx mt kg kz la mu lc ld le mv lg lh li mw lk ll lm im bi translated">另一个显著的区别是，与Python不同，所有的函数输入都在花括号内配置。一个例外是当你输入数据时，比如训练集。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="5c75" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">还有一些差异，但我认为这些就足够了。</p><h2 id="8ab2" class="ma mb it bd mc md me dn mf mg mh dp mi la mj mk ml le mm mn mo li mp mq mr iz bi translated">基本语法</h2><p id="a17a" class="pw-post-body-paragraph kr ks it kt b ku ms kd kw kx mt kg kz la mu lc ld le mv lg lh li mw lk ll lm im bi translated">下面列出了最常用的函数。要了解其中任何一个函数的更多信息，只需单击该函数的名称。我建议你对每一个都这样做，以便更好地理解。</p><ul class=""><li id="dab9" class="nl nm it kt b ku kv kx ky la nn le no li np lm nq nr ns nt bi translated"><a class="ae mx" href="https://js.tensorflow.org/api/latest/#tensor" rel="noopener ugc nofollow" target="_blank"><strong class="kt jd"><em class="lz">TF . tensor(</em></strong><em class="lz">data，shape</em><strong class="kt jd"><em class="lz">)</em></strong></a><em class="lz"/>创建一个张量，tfjs稍后可以使用它进行训练或推理，并将其保存在分配给该函数的变量中</li><li id="b869" class="nl nm it kt b ku nu kx nv la nw le nx li ny lm nq nr ns nt bi translated"><a class="ae mx" href="https://js.tensorflow.org/api/latest/#sequential" rel="noopener ugc nofollow" target="_blank"><strong class="kt jd"><em class="lz">TF . sequential()</em></strong></a><strong class="kt jd"><em class="lz"/></strong>创建由一系列层组成的<em class="lz">模型</em>。该模型保存到一个<em class="lz"> const </em>或常量变量中。</li><li id="b3ac" class="nl nm it kt b ku nu kx nv la nw le nx li ny lm nq nr ns nt bi translated"><a class="ae mx" href="https://js.tensorflow.org/api/latest/#layers.dense" rel="noopener ugc nofollow" target="_blank"><strong class="kt jd"><em class="lz">TF . layers . dense({</em></strong><em class="lz">单位:_ _ _ _，激活:' _ _ _ _ _ _ '</em><strong class="kt jd"><em class="lz">})</em></strong></a><strong class="kt jd"><em class="lz"/></strong>创建一个tfjs图层，可以使用<strong class="kt jd"> <em class="lz"> model.add() </em> </strong>添加到模型中。注意，像TensorFlow一样，第一层有一个可选的附加输入，称为<em class="lz"> inputShape </em>，它将进入模型第一层的配置内部。</li><li id="0e63" class="nl nm it kt b ku nu kx nv la nw le nx li ny lm nq nr ns nt bi translated"><a class="ae mx" href="https://js.tensorflow.org/api/latest/#tf.Sequential.add" rel="noopener ugc nofollow" target="_blank"><strong class="kt jd"><em class="lz">model . add()</em></strong></a><strong class="kt jd"><em class="lz"/></strong>获取一个<em class="lz"> tf.layers </em>图层，并将其添加到模型中现有的图层列表中。也可以使用<em class="lz"> tf.layers.flatten </em>或<em class="lz"> tf.layers.conv2d </em>。</li><li id="c47b" class="nl nm it kt b ku nu kx nv la nw le nx li ny lm nq nr ns nt bi translated"><a class="ae mx" href="https://js.tensorflow.org/api/latest/#tf.LayersModel.compile" rel="noopener ugc nofollow" target="_blank"><strong class="kt jd"><em class="lz">model . compile({</em></strong><em class="lz">优化器:' ___ '，损耗:' _ _ _ '</em><strong class="kt jd"><em class="lz">})</em></strong></a><strong class="kt jd"><em class="lz"/></strong>编译模型。优化器在<em class="lz"> tf.train </em>，比如<em class="lz"> tf.train.adam </em>和<em class="lz"> tf.train.rmsprop </em>。</li><li id="3fff" class="nl nm it kt b ku nu kx nv la nw le nx li ny lm nq nr ns nt bi translated"><a class="ae mx" href="https://js.tensorflow.org/api/latest/#tf.Sequential.fit" rel="noopener ugc nofollow" target="_blank"><strong class="kt jd"><em class="lz">model . fit(</em></strong><em class="lz">xs，ys，</em><strong class="kt jd"><em class="lz">{</em></strong><em class="lz">epochs:_ _ _，回调:</em><strong class="kt jd"><em class="lz">{</em></strong><em class="lz">_ _ _ _ _ _</em><strong class="kt jd"><em class="lz">})</em></strong></a><strong class="kt jd"><em class="lz"/></strong>拟合模型上<em class="lz"> xs，ys </em>的数据集。</li><li id="1e0d" class="nl nm it kt b ku nu kx nv la nw le nx li ny lm nq nr ns nt bi translated"><a class="ae mx" href="https://js.tensorflow.org/api/latest/#tf.Sequential.predict" rel="noopener ugc nofollow" target="_blank"><strong class="kt jd"><em class="lz">. predict(</em></strong><em class="lz">【xs】</em><strong class="kt jd"><em class="lz">)</em></strong></a><strong class="kt jd"><em class="lz"/></strong>使用训练好的模型来预测标签。</li></ul><p id="94d1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">语法已经过时了，我们现在可以开始编程了。</p><p id="c69a" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><em class="lz">请注意，该程序是数据&amp;部署专业化中tfjs课程中基于浏览器的模型的第4周示例的定制。</em></p><h1 id="c3bf" class="my mb it bd mc mz na nb mf nc nd ne mi ki nf kj ml kl ng km mo ko nh kp mr ni bi translated">人脸识别</h1><p id="f55b" class="pw-post-body-paragraph kr ks it kt b ku ms kd kw kx mt kg kz la mu lc ld le mv lg lh li mw lk ll lm im bi translated">我们用tfjs中的迁移学习做一个人脸识别模型。该模型首先将三个人的图像作为输入，并将输出模型从网络摄像头中看到的人。如果你只是想看看演示，那么我在下面的一个网站上有。看看吧！</p><div class="nz oa gp gr ob oc"><a href="https://djthegr8.github.io/" rel="noopener  ugc nofollow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd jd gy z fp oh fr fs oi fu fw jc bi translated">人脸识别TFjS演示</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">展示浏览器训练和推理能力的演示</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">djthegr8.github.io</p></div></div></div></a></div><h2 id="6d9a" class="ma mb it bd mc md me dn mf mg mh dp mi la mj mk ml le mm mn mo li mp mq mr iz bi translated">安装</h2><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/84e16a17086718580ef72bdfbeb49088.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*6TdULabojWw8D8k_WZMd0Q.jpeg"/></div></figure><ul class=""><li id="2193" class="nl nm it kt b ku kv kx ky la nn le no li np lm nq nr ns nt bi translated">从<a class="ae mx" href="https://chrome.google.com/webstore/detail/web-server-for-chrome/ofhbbkphhbklhfoeikjpcbhemlocgigb?hl=en" rel="noopener ugc nofollow" target="_blank">这里</a>下载Chrome 的200 OK <em class="lz">网络服务器。它需要消除多个HTTP请求，并确保我们得到良好的上传。</em></li></ul><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi om"><img src="../Images/2d1c899dea7d6d637e721074f25f564a.png" data-original-src="https://miro.medium.com/v2/resize:fit:232/format:webp/1*0osvdkTU6osxrwy_r79DdQ.jpeg"/></div></figure><ul class=""><li id="a384" class="nl nm it kt b ku kv kx ky la nn le no li np lm nq nr ns nt bi translated">可选地，如果你想编辑我的代码来玩tfjs(我真的推荐这么做)，你可以下载一个编辑器，比如<a class="ae mx" href="http://brackets.io/" rel="noopener ugc nofollow" target="_blank">括号</a>，让你的工作更容易。</li><li id="35c5" class="nl nm it kt b ku nu kx nv la nw le nx li ny lm nq nr ns nt bi translated">最后，所有的代码都可以在<a class="ae mx" href="https://github.com/djthegr8/Face-recognition-tfjs" rel="noopener ugc nofollow" target="_blank">这个GitHub库</a>中找到。请下载它，并将Chrome Web服务器的目标设置到该文件夹中。要运行，请打开服务器应用程序中的链接，然后打开facerecgn.html文件。</li></ul><h2 id="8f6f" class="ma mb it bd mc md me dn mf mg mh dp mi la mj mk ml le mm mn mo li mp mq mr iz bi translated">实际模型</h2><p id="b29b" class="pw-post-body-paragraph kr ks it kt b ku ms kd kw kx mt kg kz la mu lc ld le mv lg lh li mw lk ll lm im bi translated">让我们首先看一下TensorFlow.jS库的导入。这一行位于HTML页面的head部分。</p><pre class="lo lp lq lr gt on oo op oq aw or bi"><span id="1ce4" class="ma mb it oo b gy os ot l ou ov">&lt;script src="<a class="ae mx" href="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest</a>"&gt; &lt;/script&gt;</span></pre><p id="8e4d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在，我们将跳过HTML代码，在index.jS页面中查看Tensorflow.jS代码。</p><p id="b1ec" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">下面是加载MobileNet的代码，MobileNet是一个经过预先训练的tfjs网络，它本身可以将图像分类到大约1000个类别。该函数通过声明一个新的模型来移除它的推理层，该模型采用倒数第二层的输出。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="20fb" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">下面是代码中最重要的函数。我们正在展平MobileNet编码的三维输出(在<em class="lz"> loadMobilenet() </em>函数中声明的模型的输出)，然后通过一个小的NN。损失是分类交叉熵，优化器是adam。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="e3b7" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我将展示的另一个函数是处理最终导致数据集创建的按钮按压的函数。这是不言自明的。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="40c9" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">最后一个主要功能是<em class="lz"> predict() </em>，它根据模型预测人。该函数查找预测概率并输出最高的概率。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="0a27" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">完成后，rps-dataset.jS就剩下了……与其描述代码，我将快速描述它的功能。它所做的只是创建一个可追加的数据集，并具有(一次性)标签。当然，代码在存储库中。</p><p id="b3f3" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">完成所有这些函数后，您可以查看最终的index.jS代码。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="nj nk l"/></div></figure><h2 id="1e79" class="ma mb it bd mc md me dn mf mg mh dp mi la mj mk ml le mm mn mo li mp mq mr iz bi translated">谢谢并评论</h2><p id="d375" class="pw-post-body-paragraph kr ks it kt b ku ms kd kw kx mt kg kz la mu lc ld le mv lg lh li mw lk ll lm im bi translated">非常感谢你阅读这篇文章，如果你发现任何错误，请评论！</p><h2 id="08da" class="ma mb it bd mc md me dn mf mg mh dp mi la mj mk ml le mm mn mo li mp mq mr iz bi translated">免费的任何疑问，项目帮助或任何合作机会！</h2><p id="cbd0" class="pw-post-body-paragraph kr ks it kt b ku ms kd kw kx mt kg kz la mu lc ld le mv lg lh li mw lk ll lm im bi translated">给我发邮件到<a class="ae mx" href="mailto:dweepjoshipuracar@gmail.com" rel="noopener ugc nofollow" target="_blank">我的Gmail </a>获取任何关于TF、Keras、TFjS或Python的帮助或合作！或者查看我的<a class="ae mx" href="https://linkedin.com/in/dweep-joshipura" rel="noopener ugc nofollow" target="_blank"> Linkedin </a></p></div></div>    
</body>
</html>