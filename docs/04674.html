<html>
<head>
<title>In Depth Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度线性回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-science-crash-course-in-depth-linear-regression-fd06511f586c?source=collection_archive---------25-----------------------#2020-04-25">https://towardsdatascience.com/data-science-crash-course-in-depth-linear-regression-fd06511f586c?source=collection_archive---------25-----------------------#2020-04-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="aecf" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据科学速成班</h2><div class=""/><div class=""><h2 id="eb10" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">从线性回归开始理解算法。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/0fbcee68a925aa08a3883c80d220b0d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jCUlCrU9zAwvkqWt.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">“随机数据点及其线性回归”——摘自维基百科</p></figure><p id="b619" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">本月早些时候，<a class="ae md" href="https://medium.com/u/9ab35c11801?source=post_page-----49cfc5ed9136----------------------" rel="noopener"> Edward Qian </a>和我开始为有抱负的数据科学家编写一套综合课程，这些课程可以在我们的网站【www.dscrashcourse.com】上找到</p><p id="4a17" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我将把稍加修改的课程交叉发布到 Medium 上，让更多的观众可以看到。如果你觉得这些文章很有帮助，请到网站上查看更多的课程和练习题！</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="868d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">算法是计算机解决特定问题时可以遵循的一组规则。在建模的背景下，每种算法将使用不同的方法来获得最能代表目标变量的函数。回想一下，回归算法探索了自变量和一个<em class="ml">连续</em>因变量之间的关系。</p><h1 id="8958" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">线性回归</h1><p id="4642" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">线性回归对因变量和至少一个自变量/解释变量之间的线性关系进行建模。有一个解释变量的线性回归模型称为<strong class="lj jd">简单线性回归</strong>，而有多个变量的线性回归模型称为<strong class="lj jd">多元线性回归</strong>。</p><p id="bb7b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">当对训练集进行拟合时，线性回归模型估计未知参数，以量化自变量的线性变化对平均因变量的影响。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nj"><img src="../Images/74de0bc0dff98bafdfaff7180497e96e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XejjlAXP0IE6n6mfmb2oJA.png"/></div></div></figure><p id="e86b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">系数</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/dd4e0c5b637502125f709f42e5617007.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*lRpYTHifwipa-BwTNJLb_w.png"/></div></figure><p id="111d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">是估计的参数。有了这些系数，只要我们知道解释变量，我们就可以估计未来观测值。</p><p id="6a7a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><em class="ml"> ϵ </em>(读作ε)是<strong class="lj jd">误差</strong>项，也称为<strong class="lj jd">残差</strong>。误差是真实目标变量和预测目标变量之间的差异。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/8fb33eea946682330f3fa3838e2d7098.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/1*fMODefy0AykEuCWL61fxPQ.png"/></div></figure><h1 id="ff6c" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">系数是如何计算的？</h1><p id="60ad" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">简而言之，我们选择“最佳”系数来最小化误差项。</p><p id="6e48" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">做这件事有几种不同的方法。标准方法之一是使用<strong class="lj jd">普通最小二乘估计</strong> (OLS)方法。OLS 方法做了几个假设:</p><ul class=""><li id="1583" class="nm nn it lj b lk ll ln lo lq no lu np ly nq mc nr ns nt nu bi translated">可以使用线性关系对数据进行建模，类似于上面所示的形式</li><li id="c4c7" class="nm nn it lj b lk nv ln nw lq nx lu ny ly nz mc nr ns nt nu bi translated">误差项<em class="ml"> ϵ </em>是独立同分布的，总体均值为零</li><li id="46ea" class="nm nn it lj b lk nv ln nw lq nx lu ny ly nz mc nr ns nt nu bi translated">误差项的方差必须是常数；它不能是目标的函数</li><li id="f9df" class="nm nn it lj b lk nv ln nw lq nx lu ny ly nz mc nr ns nt nu bi translated">独立变量与误差项不相关，也彼此不相关</li><li id="6433" class="nm nn it lj b lk nv ln nw lq nx lu ny ly nz mc nr ns nt nu bi translated">理想情况下，误差项应该是正态分布的——这使我们能够可靠地计算置信区间</li></ul><p id="1897" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在这些假设下，我们可以构建一个封闭形式的公式来计算使误差项最小的系数。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/d83bdb3972d62fb2fee1c206c17263b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*8BTbUIUEtT9k1p3PkLEOBQ.png"/></div></figure><p id="925f" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">推导从一个目标开始:最小化残差平方和。</p><p id="28bc" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">回想一下，我们可以将误差度量为<strong class="lj jd">y</strong>—<strong class="lj jd">X<em class="ml">β</em></strong></p><p id="8628" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">误差平方和可以定义为系数的函数。在矩阵符号中:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/5f5952071d88b1ce74ce8563ea1b3aa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*hAHI5YP31HuK59e_wB92DQ.png"/></div></figure><p id="be90" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">函数<em class="ml"> S </em>使用我们的 beta 参数计算误差平方和。</p><p id="c7c3" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这是<em class="ml"> β </em>的二次函数，所以如果我们对<em class="ml"> β </em>求导就能找到全局最小值。然后我们可以通过将β设为 0 来求解^。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/ed71e1a78dad751bd6e56efb6c44c934.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*OL2siLbZ6LychV7YgU9KSg.png"/></div></figure><p id="6bda" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">将左侧设置为零。我们的 OLS 假设允许我们假设<strong class="lj jd"> X </strong>具有满列秩，这使得<strong class="lj jd"> X </strong> ⊤ <strong class="lj jd"> X </strong>可逆。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi od"><img src="../Images/d23d02b09dab9feef15c3b47e246ce07.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*UQ3w0Z3hAFoeGjbNwqt5Ag.png"/></div></figure><h1 id="9969" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">模型解释</h1><p id="e104" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">线性回归的简单性是一把双刃剑。线性模型非常容易解释和理解，但也是对现实世界复杂性的简化。大多数数据集也会违反 OLS 方法的假设。</p><p id="3ed9" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd">模型解读</strong>的重要性不可小觑。能够解释系数使我们能够使用模型来推动业务战略，量化我们努力的效果，并给予利益相关者对我们算法的信任。</p><p id="073a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们用一个例子来演示一下。房地产经纪人吉姆训练了一个线性回归模型来预测房价，作为平方英尺和年龄的函数。让<em class="ml"> y </em>代表房子的价格，<em class="ml"> x </em> 1 代表平方英尺，<em class="ml"> x </em> 2 代表以年为单位的年龄。</p><p id="678b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">他使用上述公式计算系数，并得出他用来预测 house 的公式:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/de3499f071a29a3a898ae88facdaf7c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*64YkA3xk326cQEELJVU1Ig.png"/></div></figure><p id="7b84" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">吉姆的模型告诉了我们很多关于房价的信息:</p><ul class=""><li id="1e5a" class="nm nn it lj b lk ll ln lo lq no lu np ly nq mc nr ns nt nu bi translated">平方英尺每增加一个单位，平均房价就会增加 500 美元</li><li id="9dbd" class="nm nn it lj b lk nv ln nw lq nx lu ny ly nz mc nr ns nt nu bi translated">房龄每增加一个单位，平均房价就会下降 1.2 美元</li></ul><p id="783e" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这些信息可以用来提高房屋的估价。现实并非如此简单，但如果增加一平方英尺的额外空间只需要 200 美元，难道你不想增加房子的面积来卖个更高的价钱吗？</p><h1 id="21e1" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">关注交互效应和分类变量</h1><p id="be56" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">吉姆意识到体型和年龄之间的交互作用非常重要。他补充说，作为一个预测，并重新训练他的模型。他的新公式变成了:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi of"><img src="../Images/98b560a292a50d0cb209bb47b3f21859.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*TP6pvk8bRVv7j_fP_yI_vQ.png"/></div></figure><p id="33ae" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">Jim 决定将房屋类型作为预测因素纳入他的模型。每栋房子要么是联排别墅，半独立式或独立式住宅。他决定将这些视为分类变量。</p><p id="7bab" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">新模型将利用这些额外的预测因素:</p><ul class=""><li id="e492" class="nm nn it lj b lk ll ln lo lq no lu np ly nq mc nr ns nt nu bi translated"><em class="ml"> x </em> 3 : 1 如果房子是联排别墅，否则为 0</li><li id="93dd" class="nm nn it lj b lk nv ln nw lq nx lu ny ly nz mc nr ns nt nu bi translated">如果房子是半独立式的，x  4 : 1，否则为 0</li><li id="f20b" class="nm nn it lj b lk nv ln nw lq nx lu ny ly nz mc nr ns nt nu bi translated"><em class="ml"> x </em> 5 : 1 如果房子是独立式的，否则为 0</li></ul><p id="013d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这再次扩大了他的公式:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi og"><img src="../Images/749ba69cab46babe2fe836dfccbc83e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*krA7zEvMychF1hXi3MktqQ.png"/></div></figure><p id="dd06" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这告诉我们，在其他条件相同的情况下，独立式住宅比半独立式住宅平均贵 4000 美元，比联排别墅贵 11000 美元。</p><h1 id="deb1" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">线性回归的常见陷阱</h1><ul class=""><li id="0ec9" class="nm nn it lj b lk ne ln nf lq oh lu oi ly oj mc nr ns nt nu bi translated"><strong class="lj jd">多重共线性</strong>:独立变量可能高度相关，这违反了 OLS 假设(也许他们当年建造了更大的房子，让我们可以根据房屋年龄预测面积)</li><li id="a9ca" class="nm nn it lj b lk nv ln nw lq nx lu ny ly nz mc nr ns nt nu bi translated">异方差性:非恒定方差也违反了 OLS 假设(也许，房子越老，价格的方差越大)</li></ul><p id="3de6" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">其他一些值得思考的趣闻:</p><ul class=""><li id="5e26" class="nm nn it lj b lk ll ln lo lq no lu np ly nq mc nr ns nt nu bi translated">我们的线性模型需要截距吗？(零岁没有平方的房子应该值 1000 美元吗？那还是房子吗？)</li><li id="9875" class="nm nn it lj b lk nv ln nw lq nx lu ny ly nz mc nr ns nt nu bi translated">我们的目标变量的合理值范围是多少？房价当然不能是负的…</li></ul><h1 id="8a17" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">感谢您的阅读！</h1><p id="3246" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">如果你喜欢这篇文章，可以看看我关于数据科学、数学和编程的其他文章。<a class="ae md" href="https://medium.com/@mandygu" rel="noopener">通过 Medium </a>关注我的最新更新。😃</p><p id="c4c4" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">作为一个业余爱好项目，我还在<a class="ae md" href="http://www.dscrashcourse.com/" rel="noopener ugc nofollow" target="_blank">www.dscrashcourse.com</a>建立了一套全面的<strong class="lj jd">免费</strong>数据科学课程和练习题。</p><p id="fb9b" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你想支持我的写作，下次你报名参加 Coursera 课程时，可以考虑使用我的会员链接。完全公开—我从每一次注册中获得佣金，但不会对您产生额外费用。</p><p id="af43" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">再次感谢您的阅读！📕</p></div></div>    
</body>
</html>