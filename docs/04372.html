<html>
<head>
<title>Using Python to Monitor Social Distancing in a Public Area</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python监控公共区域的社交距离</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/monitoring-social-distancing-using-ai-c5b81da44c9f?source=collection_archive---------10-----------------------#2020-04-20">https://towardsdatascience.com/monitoring-social-distancing-using-ai-c5b81da44c9f?source=collection_archive---------10-----------------------#2020-04-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/9a4f7b08124636d632fda16e7a9054b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OVP9aXG5g-USN5TcFih--A.png"/></div></div></figure><div class=""/><blockquote class="jy jz ka"><p id="4054" class="kb kc kd ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">注:Idea积分登陆AI</p></blockquote><p id="40b7" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">社交距离是减缓传染病传播的重要方式。人们被要求限制彼此之间的互动，减少疾病通过身体接触或密切接触传播的机会。</p><p id="8c77" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">在过去的十年里，AI/深度学习在几个日常生活问题中显示出了有希望的结果。在人工智能的帮助下，各种日常生活任务已经自动化。在本文中，我们将详细介绍如何使用python结合深度学习和计算机视觉来监控社交距离。带有安装说明的完整python代码可在<a class="ae ld" href="https://github.com/aqeelanwar/SocialDistancingAI" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得</p><p id="05c6" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">在我们进入细节之前，让我们看看最终的输出。下面的视频是使用人工智能在已经可用的街道摄像头的公共区域监控社交距离的结果。</p><figure class="le lf lg lh gt is"><div class="bz fp l di"><div class="li lj l"/></div></figure><p id="74f7" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">本文的其余部分将分为三个步骤</p><ul class=""><li id="7d5e" class="lk ll jb ke b kf kg kj kk la lm lb ln lc lo kz lp lq lr ls bi translated">步骤1 —安装项目</li><li id="bd37" class="lk ll jb ke b kf lt kj lu la lv lb lw lc lx kz lp lq lr ls bi translated">步骤2—运行项目</li><li id="8b4b" class="lk ll jb ke b kf lt kj lu la lv lb lw lc lx kz lp lq lr ls bi translated">步骤3—代码的输入和输出</li><li id="6947" class="lk ll jb ke b kf lt kj lu la lv lb lw lc lx kz lp lq lr ls bi translated">第4步——它是如何工作的？</li><li id="0323" class="lk ll jb ke b kf lt kj lu la lv lb lw lc lx kz lp lq lr ls bi translated">步骤5—建议的改进</li></ul><h1 id="67ee" class="ly lz jb bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">步骤1 —安装项目:</h1><p id="2379" class="pw-post-body-paragraph kb kc jb ke b kf mw kh ki kj mx kl km la my kp kq lb mz kt ku lc na kx ky kz ij bi translated">建议<a class="ae ld" rel="noopener" target="_blank" href="/setting-up-python-platform-for-machine-learning-projects-cfd85682c54b">为这个项目创建一个新的虚拟环境</a>并安装依赖项。可以采取以下步骤下载并开始使用这些项目</p><ol class=""><li id="3770" class="lk ll jb ke b kf kg kj kk la lm lb ln lc lo kz nb lq lr ls bi translated"><strong class="ke jc">克隆存储库:</strong>包含代码的存储库可以使用</li></ol><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="0aef" class="nh lz jb nd b gy ni nj l nk nl">git clone <a class="ae ld" href="https://github.com/aqeelanwar/SocialDistancingAI.git" rel="noopener ugc nofollow" target="_blank">https://github.com/aqeelanwar/SocialDistancingAI.git</a></span></pre><p id="338f" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">2.<strong class="ke jc">安装需要的包:</strong>提供的requirements.txt文件可以用来安装所有需要的包。使用以下命令</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="31b1" class="nh lz jb nd b gy ni nj l nk nl">cd SocialDistancingAI<br/>pip install –r requirements.txt</span></pre><p id="795d" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">这将在激活的python环境中安装所需的包。</p><h1 id="8c5a" class="ly lz jb bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">步骤2 —运行代码:</h1><p id="db90" class="pw-post-body-paragraph kb kc jb ke b kf mw kh ki kj mx kl km la my kp kq lb mz kt ku lc na kx ky kz ij bi translated">该代码将视频文件路径作为输入。以下命令可用于运行代码</p><pre class="le lf lg lh gt nc nd ne nf aw ng bi"><span id="5a4f" class="nh lz jb nd b gy ni nj l nk nl">cd SocialDistancingAI<br/>python main.py --videopath "vid_short.mp4"</span></pre><h1 id="0521" class="ly lz jb bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">步骤3 —代码的输入和输出:</h1><h2 id="5155" class="nh lz jb bd ma nm nn dn me no np dp mi la nq nr mm lb ns nt mq lc nu nv mu nw bi translated">标记必要的点:</h2><p id="9735" class="pw-post-body-paragraph kb kc jb ke b kf mw kh ki kj mx kl km la my kp kq lb mz kt ku lc na kx ky kz ij bi translated">运行main.py将打开视频中第一帧的窗口。此时，代码希望用户通过单击框架上的适当位置来标记6个点。这些点对于提供视频的用户视角是必要的。</p><h2 id="bc04" class="nh lz jb bd ma nm nn dn me no np dp mi la nq nr mm lb ns nt mq lc nu nv mu nw bi translated">输入:前4点:</h2><p id="621a" class="pw-post-body-paragraph kb kc jb ke b kf mw kh ki kj mx kl km la my kp kq lb mz kt ku lc na kx ky kz ij bi translated">6个必需点中的前4个用于标记您想要监控的感兴趣区域(ROI)。此外，从上面看，这些点标记的线在现实世界中应该是平行的。例如，这些线可能是路缘。<br/>这4个点需要按照预先定义的顺序提供，如下所示。</p><ul class=""><li id="6fca" class="lk ll jb ke b kf kg kj kk la lm lb ln lc lo kz lp lq lr ls bi translated"><strong class="ke jc">点1 (bl) </strong>:左下角</li><li id="6c97" class="lk ll jb ke b kf lt kj lu la lv lb lw lc lx kz lp lq lr ls bi translated"><strong class="ke jc">点2 (br) </strong>:右下角</li><li id="cf12" class="lk ll jb ke b kf lt kj lu la lv lb lw lc lx kz lp lq lr ls bi translated"><strong class="ke jc">点3 (tl) </strong>:左上角</li><li id="5f40" class="lk ll jb ke b kf lt kj lu la lv lb lw lc lx kz lp lq lr ls bi translated"><strong class="ke jc">点4 (tr) </strong>:右上</li></ul><h2 id="9b22" class="nh lz jb bd ma nm nn dn me no np dp mi la nq nr mm lb ns nt mq lc nu nv mu nw bi translated">输入:最后两点:</h2><p id="7a4e" class="pw-post-body-paragraph kb kc jb ke b kf mw kh ki kj mx kl km la my kp kq lb mz kt ku lc na kx ky kz ij bi translated">最后两个点用于标记感兴趣区域中相距6英尺的两个点。例如，这可能是一个人的高度(更容易在框架上标记)</p><p id="a465" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">下面的gif将有助于更好地理解要点</p><figure class="le lf lg lh gt is gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/a87a14492a123540cc67bab099bcf6c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*8PExyL1mCxE6My0A_hyTNQ.gif"/></div></figure><p id="cbb2" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">代码输出</p><h2 id="6850" class="nh lz jb bd ma nm nn dn me no np dp mi la nq nr mm lb ns nt mq lc nu nv mu nw bi translated">输出:在原始视频中检测到行人</h2><p id="ae98" class="pw-post-body-paragraph kb kc jb ke b kf mw kh ki kj mx kl km la my kp kq lb mz kt ku lc na kx ky kz ij bi translated">代码的第一个输出是检测到行人的原始视频。行人被定位在紫色方框中。</p><figure class="le lf lg lh gt is gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/3404d6fbd5d6485a154ed01e62df3aef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*tNWxpzcKkN0I5sY6Sj0CfQ.gif"/></div></figure><h2 id="5e25" class="nh lz jb bd ma nm nn dn me no np dp mi la nq nr mm lb ns nt mq lc nu nv mu nw bi translated">输出:行人鸟瞰图</h2><p id="667e" class="pw-post-body-paragraph kb kc jb ke b kf mw kh ki kj mx kl km la my kp kq lb mz kt ku lc na kx ky kz ij bi translated">代码的第二个输出是用户标记的感兴趣区域中自上而下的局部行人视频(鸟瞰图)。</p><figure class="le lf lg lh gt is gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/e8017c69c159ba15f05fc584e6a2ca76.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/1*6uAlLVL9jaoE3alr8Zu8Og.gif"/></div></figure><h2 id="1618" class="nh lz jb bd ma nm nn dn me no np dp mi la nq nr mm lb ns nt mq lc nu nv mu nw bi translated">输出:社交距离参数</h2><p id="e7ba" class="pw-post-body-paragraph kb kc jb ke b kf mw kh ki kj mx kl km la my kp kq lb mz kt ku lc na kx ky kz ij bi translated">基于鸟瞰图和用户标记的6英尺距离点，该算法计算并报告以下参数。</p><p id="940d" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke jc"> 1。# 6英尺违规:</strong>行人违反6英尺安全距离阈值的次数</p><p id="48f3" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke jc"> 2。居家指数:</strong>量化了与正常的日常行人交通相比，有多少人待在家中。0%意味着行人流量与平时相比没有变化，50%意味着一半的人呆在家里</p><p id="d948" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke jc"> 3。社交距离指数:</strong>量化保持的社交距离。50%意味着一半的互动违反了6英尺的安全距离标准。</p><h1 id="c18b" class="ly lz jb bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">第4步——它是如何工作的？</h1><p id="ca4c" class="pw-post-body-paragraph kb kc jb ke b kf mw kh ki kj mx kl km la my kp kq lb mz kt ku lc na kx ky kz ij bi translated">在没有任何额外信息的情况下，从单目图像中检测行人之间的距离是不可能的。一种方法(虽然不是很准确)是要求用户进行特定的输入，从而估计行人之间的距离。如果用户可以在帧上标记相距6英尺的两个点，使用外推法，可以找到帧上不同点之间的距离。如果摄像机与行人行走的平面上的所有点距离相等，这将是真实的。行人离摄像机越近，他们就越大。帧上的两个点(相距相同像素数)离相机越近，它们之间的实际距离就越小。</p><p id="014a" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">为了解决这个问题，代码接收用户输入的4个点来标记从上面看平行的两条线。由这4个点标记的区域被认为是ROI(可以在上面的gif中以黄色看到)。这个多边形ROI然后被扭曲成一个矩形，成为鸟瞰图。这个鸟瞰图具有点的属性(这些点相隔相同的像素数)，无论它们在哪里都是等距的。它所需要的只是一个乘法器，将像素中的两点之间的距离映射到现实生活中的单位(如英尺或米)中的距离。这是最后两个用户输入点发挥作用的地方。</p><p id="85cb" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">如上所述，深度学习用于检测和定位行人，然后将其映射到摄像机的鸟瞰投影。一旦我们有了鸟瞰视图中行人的坐标，社交距离参数就变得简单明了。</p><p id="ffea" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">该算法的完整框图如下所示。</p><figure class="le lf lg lh gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nz"><img src="../Images/3ca0a2617b8587101368a8e33d69cdf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4zKiSkLDXgT0ubohPp3bgQ.png"/></div></div></figure><h1 id="156d" class="ly lz jb bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">步骤5 —建议的改进</h1><p id="7e3d" class="pw-post-body-paragraph kb kc jb ke b kf mw kh ki kj mx kl km la my kp kq lb mz kt ku lc na kx ky kz ij bi translated">该代码可以在几个方面进行大量改进。以下是一些建议</p><ol class=""><li id="b778" class="lk ll jb ke b kf kg kj kk la lm lb ln lc lo kz nb lq lr ls bi translated">一种更精确的将摄像机画面映射到鸟瞰图的方法</li><li id="d4f7" class="lk ll jb ke b kf lt kj lu la lv lb lw lc lx kz nb lq lr ls bi translated">该代码使用现有的多类分类器，该分类器在来自COCO数据集的1000个类上进行训练。代码可以使用专门为二元类(行人、非行人)训练的重新训练的分类器。</li><li id="981a" class="lk ll jb ke b kf lt kj lu la lv lb lw lc lx kz nb lq lr ls bi translated">可以引入计算社交距离参数的更精确的方法。</li></ol><h1 id="63d1" class="ly lz jb bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">总结:</h1><p id="535e" class="pw-post-body-paragraph kb kc jb ke b kf mw kh ki kj mx kl km la my kp kq lb mz kt ku lc na kx ky kz ij bi translated">该算法可用于分析公共区域的社交距离，并采取必要的措施来更好地应对疫情。自动化的任务将导致在短时间内采取有效的行动，从而使我们更好地应对这种情况。完整的代码可以在GitHub 这里<a class="ae ld" href="https://github.com/aqeelanwar/SocialDistancingAI" rel="noopener ugc nofollow" target="_blank">获得。可以随意修改完善。</a></p><p id="fb4d" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated">输入行人视频取自https://www.youtube.com/watch?v=aUdKzb4LGJI<a class="ae ld" href="https://www.youtube.com/watch?v=aUdKzb4LGJI" rel="noopener ugc nofollow" target="_blank"/></p></div><div class="ab cl oa ob hu oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="ij ik il im in"><p id="0090" class="pw-post-body-paragraph kb kc jb ke b kf kg kh ki kj kk kl km la ko kp kq lb ks kt ku lc kw kx ky kz ij bi translated"><strong class="ke jc">如果这篇文章对你有帮助，欢迎鼓掌、分享和回复。如果你想了解更多关于机器学习和数据科学的知识，请关注我@</strong><a class="oh oi ep" href="https://medium.com/u/a7cc4f201fb5?source=post_page-----c5b81da44c9f--------------------------------" rel="noopener" target="_blank"><strong class="ke jc">Aqeel an war</strong></a><strong class="ke jc">或者在</strong><a class="ae ld" href="https://www.linkedin.com/in/aqeelanwarmalik/" rel="noopener ugc nofollow" target="_blank"><strong class="ke jc"><em class="kd">LinkedIn</em></strong></a><strong class="ke jc"><em class="kd">上与我联系。</em> </strong></p></div></div>    
</body>
</html>