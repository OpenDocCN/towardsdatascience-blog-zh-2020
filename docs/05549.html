<html>
<head>
<title>Point your camera at things to hear how to say them in another language</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">把你的相机对准事物，听听它们用另一种语言怎么说</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/point-your-camera-at-things-to-hear-how-to-say-them-in-another-language-fa6e9f3621a5?source=collection_archive---------59-----------------------#2020-05-09">https://towardsdatascience.com/point-your-camera-at-things-to-hear-how-to-say-them-in-another-language-fa6e9f3621a5?source=collection_archive---------59-----------------------#2020-05-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cbe4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过Google Cloud Vision和Translate API引入事物翻译器</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/72b1456311c868c30783de08ff9d5124.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*zmxNtwBbobmMwh8fATc5eg.gif"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">资料来源:github.com/dmotz</p></figure><p id="0c46" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当你去那些你不说他们语言的国家旅行时，谷歌翻译已经成为一个无价的工具。在大多数情况下，你会对着应用说话或输入单词来获得翻译。如今，有了谷歌翻译的相机功能，你就可以把相机对准用另一种语言写的文本，然后翻译成你的母语。</p><p id="d170" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当我想知道我是否可以把这样的相机翻译功能带到网上时，我看到了这个网络应用程序“东西翻译器”。它是作为谷歌<a class="ae lq" href="https://aiexperiments.withgoogle.com/" rel="noopener ugc nofollow" target="_blank">人工智能实验</a>项目的一部分开发的，它可以让你将手机(或笔记本电脑)指向某些东西，然后听到用不同的语言说出来。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="0bab" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">东西翻译演示</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="066a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">点击下面的链接亲自尝试一下:</p><div class="ms mt gp gr mu mv"><a href="https://thing-translator.appspot.com/" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">事物翻译器</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">把你的相机对准事物，听听它们用不同的语言怎么说</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">thing-translator.appspot.com</p></div></div></div></a></div></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="dd24" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">履行</h1><p id="be7f" class="pw-post-body-paragraph ku kv it kw b kx ne ju kz la nf jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">在幕后，Thing Translator正在使用谷歌的<a class="ae lq" href="https://cloud.google.com/vision/" rel="noopener ugc nofollow" target="_blank">云视觉</a>和<a class="ae lq" href="https://cloud.google.com/translate/" rel="noopener ugc nofollow" target="_blank">翻译</a>API。在本文中，我将进一步探索代码，请跟随我，这样您也可以自己构建这个很酷的应用程序。</p><h2 id="0df1" class="nj lz it bd ma nk nl dn me nm nn dp mi ld no np mk lh nq nr mm ll ns nt mo nu bi translated">#第一步:注册谷歌云API</h2><p id="6d2b" class="pw-post-body-paragraph ku kv it kw b kx ne ju kz la nf jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">因为这个web应用程序使用的是Google的云API，所以要开始使用，你需要在Google中设置一个项目来使用它的2个API。</p><p id="9265" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可能害怕谷歌会对你的实验收费，请不要担心，你的实验是免费的:</p><ul class=""><li id="4969" class="nv nw it kw b kx ky la lb ld nx lh ny ll nz lp oa ob oc od bi translated">谷歌提供了300美元的信用额度来免费使用GCP</li><li id="6e81" class="nv nw it kw b kx oe la of ld og lh oh ll oi lp oa ob oc od bi translated"><a class="ae lq" href="https://cloud.google.com/vision/pricing" rel="noopener ugc nofollow" target="_blank">视觉API </a>的第一个<strong class="kw iu">1000</strong>请求和<a class="ae lq" href="https://cloud.google.com/translate/pricing" rel="noopener ugc nofollow" target="_blank">翻译API </a>的第一个<strong class="kw iu">500000</strong>字符每月<strong class="kw iu">免费</strong></li><li id="5557" class="nv nw it kw b kx oe la of ld og lh oh ll oi lp oa ob oc od bi translated">你可以<a class="ae lq" href="https://cloud.google.com/apis/docs/capping-api-usage" rel="noopener ugc nofollow" target="_blank">限制你的API使用</a></li></ul><p id="d830" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">谷歌提供了如何设置的一步一步的指导，更多细节可以在<a class="ae lq" href="https://cloud.google.com/apis/docs/getting-started" rel="noopener ugc nofollow" target="_blank">谷歌云API入门</a>中找到</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ok ol di om bf on"><div class="gh gi oj"><img src="../Images/73a9d928b6f58494f81af4497f1d1a43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M1PA0rMOLfZFft68y76Eaw.jpeg"/></div></div></figure><p id="47e1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在GCP(谷歌云平台)中设置好API后，复制并保存API密匙，以便在web应用中使用。</p><h2 id="a9af" class="nj lz it bd ma nk nl dn me nm nn dp mi ld no np mk lh nq nr mm ll ns nt mo nu bi translated">#步骤2:克隆和构建存储库</h2><p id="aab4" class="pw-post-body-paragraph ku kv it kw b kx ne ju kz la nf jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">接下来，从GitHub克隆或下载<a class="ae lq" href="https://github.com/dmotz/thing-translator" rel="noopener ugc nofollow" target="_blank"> Thing Translator </a>库</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="d8fc" class="nj lz it op b gy ot ou l ov ow">git clone <a class="ae lq" href="https://github.com/dmotz/thing-translator.git" rel="noopener ugc nofollow" target="_blank">https://github.com/dmotz/thing-translator.git</a></span></pre><p id="6b40" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您需要在<code class="fe ox oy oz op b">src/config.js</code>中设置您的API密钥</p><p id="f256" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要在<code class="fe ox oy oz op b">9966</code>上启动一个监视代码变更的开发服务器，只需运行:</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="d0bc" class="nj lz it op b gy ot ou l ov ow">npm start</span></pre><p id="4545" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要优化生产输出，请运行:</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="d19b" class="nj lz it op b gy ot ou l ov ow">npm run build</span></pre><p id="7f07" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，你可以玩这个摄像头翻译网络应用程序，学习如何用另一种语言说一些事情。</p><p id="290e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你也很好奇它在幕后是如何工作的，请跟随我在下面深入研究代码。</p><h1 id="ae9d" class="ly lz it bd ma mb pa md me mf pb mh mi jz pc ka mk kc pd kd mm kf pe kg mo mp bi translated">谷歌云视觉应用编程接口的使用</h1><p id="f159" class="pw-post-body-paragraph ku kv it kw b kx ne ju kz la nf jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">通过使用Google Cloud Vision API，我们希望传递快照图像，并获得图像中有哪些对象的响应。</p><p id="23fa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<code class="fe ox oy oz op b">src/effects/snap.js</code>中，你可以在<code class="fe ox oy oz op b">snap</code>函数中找到调用谷歌云视觉API的代码。Vision API可以对图像文件执行<code class="fe ox oy oz op b">LABEL_DETECTION</code>,方法是将图像文件的内容作为base64编码的字符串发送到请求体中。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="4def" class="nj lz it op b gy ot ou l ov ow">xhr.post(<br/>    apiUrls.cloudVision,<br/>    {<br/>      json: {<br/>        requests: [<br/>          {<br/>            <strong class="op iu">image: {<br/>              content: state.canvas<br/>                .toDataURL('image/jpeg', 1)<br/>                .replace('data:image/jpeg;base64,', '')<br/>            },<br/>            features: {type: 'LABEL_DETECTION', maxResults: 10}</strong><br/>          }<br/>        ]<br/>      }<br/>    }</span></pre><p id="1adc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果请求成功，服务器返回一个<code class="fe ox oy oz op b">200 OK</code> HTTP状态代码和JSON格式的响应。<code class="fe ox oy oz op b">LABEL_DETECTION</code>响应包括检测到的标签、它们的分数、话题性和不透明标签ID:</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="203f" class="nj lz it op b gy ot ou l ov ow">{<br/>  "responses": [<br/>    {<br/>      "labelAnnotations": [<br/>        {<br/>          "mid": "/m/0838f",<br/>          <strong class="op iu">"description": "Water",<br/>          "score": 0.9388793</strong>,<br/>          "topicality": 0.9388793<br/>        },<br/>        {<br/>          "mid": "/m/039jq",<br/>          "description": "Glass",<br/>          "score": 0.85439134,<br/>          "topicality": 0.85439134<br/>        },<br/>        ......<br/>      ]<br/>    }<br/>  ]<br/>}</span></pre><p id="a1db" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，它通过检测快照中的内容完成了一半的工作。接下来，它会把它翻译成另一种语言。</p><h1 id="2bd5" class="ly lz it bd ma mb pa md me mf pb mh mi jz pc ka mk kc pd kd mm kf pe kg mo mp bi translated">谷歌云翻译API的使用</h1><p id="982f" class="pw-post-body-paragraph ku kv it kw b kx ne ju kz la nf jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">通过使用Google Cloud Translate API，我们希望传递英语单词，并获得另一种语言的翻译结果。</p><p id="c7b9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<code class="fe ox oy oz op b">src/effects/translate.js</code>中，可以在<code class="fe ox oy oz op b">translate</code>函数中找到调用Google Cloud Translate API的代码。下面是我们传递的查询参数:</p><ul class=""><li id="0761" class="nv nw it kw b kx ky la lb ld nx lh ny ll nz lp oa ob oc od bi translated">q —要翻译的输入文本。</li><li id="757a" class="nv nw it kw b kx oe la of ld og lh oh ll oi lp oa ob oc od bi translated">源—源文本的语言。</li><li id="9158" class="nv nw it kw b kx oe la of ld og lh oh ll oi lp oa ob oc od bi translated">目标—用于翻译输入文本的语言</li></ul><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="223c" class="nj lz it op b gy ot ou l ov ow">xhr.get(<br/> <strong class="op iu">${apiUrls.translate}&amp;q=${term}&amp;source=en&amp;target</strong>=${<br/>   langMap[state.activeLang]<br/> }</span></pre><p id="518d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果成功，响应正文包含具有以下结构的数据:</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="18d6" class="nj lz it op b gy ot ou l ov ow">{<br/>  "data": {<br/>    "translations": [<br/>      {<br/>        <strong class="op iu">"translatedText": "水"</strong><br/>      }<br/>    ]<br/>  }<br/>}</span></pre><p id="0ab1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一旦它在文本中获得翻译，最后一步是知道如何在选定的语言中发音。</p><h1 id="ef4e" class="ly lz it bd ma mb pa md me mf pb mh mi jz pc ka mk kc pd kd mm kf pe kg mo mp bi translated">浏览器语音合成API的使用</h1><p id="23f6" class="pw-post-body-paragraph ku kv it kw b kx ne ju kz la nf jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">它利用浏览器的语音合成API将文本转换成语音，并朗读译文。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="9a2d" class="nj lz it op b gy ot ou l ov ow">const msg = new<!-- --> <!-- -->SpeechSynthesisUtterance();<br/>msg.text = text;<br/>msg.lang = voices[voiceMap[lang]].lang;<br/>speechSynthesis.speak(msg);</span></pre><p id="e02e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">语音合成API将正常语言文本转换成人工语音，现在大多数现代浏览器都支持它</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ok ol di om bf on"><div class="gh gi pf"><img src="../Images/5d3eee1ca46da2662479a0f4458fb588.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tKM-jxI0rbfLEHvAPFOuFw.jpeg"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">来源:<a class="ae lq" href="https://caniuse.com/#search=speech-synthesis" rel="noopener ugc nofollow" target="_blank">caniuse.com/#search=speech-synthesis</a></p></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="39bf" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">GitHub知识库</h1><p id="b33e" class="pw-post-body-paragraph ku kv it kw b kx ne ju kz la nf jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">您可以通过下面的链接下载上述演示的完整代码:</p><div class="ms mt gp gr mu mv"><a href="https://github.com/dmotz/thing-translator" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd iu gy z fp na fr fs nb fu fw is bi translated">dmotz/事物翻译器</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">东西翻译是一个网络应用程序，让你把手机(或笔记本电脑)指向东西，听它用不同的方式说…</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">github.com</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl ko mv"/></div></div></a></div></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ok ol di om bf on"><div class="gh gi pm"><img src="../Images/b086b651c939bd9ae69d55e33f10d8ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UqO9qrIW9M4Qk_7qo4v7tw.jpeg"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片来自<a class="ae lq" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1037868" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><h1 id="3549" class="ly lz it bd ma mb pa md me mf pb mh mi jz pc ka mk kc pd kd mm kf pe kg mo mp bi translated">结论</h1><p id="15c0" class="pw-post-body-paragraph ku kv it kw b kx ne ju kz la nf jx lc ld ng lf lg lh nh lj lk ll ni ln lo lp im bi translated">这是一个例子，说明你可以使用谷歌的机器学习API，而不需要深入机器学习的细节。毫无疑问，谷歌是在机器学习和人工智能领域领先的全球公司之一。站在巨人的肩膀上，你可以看到更远的未来。</p><p id="1427" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">感谢您的阅读。如果你喜欢这篇文章，请在脸书或推特上分享。如果你有任何问题，请在评论中告诉我。在<a class="ae lq" href="https://github.com/bensonruan/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>和<a class="ae lq" href="https://www.linkedin.com/in/benson-ruan/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>上关注我。</p></div></div>    
</body>
</html>