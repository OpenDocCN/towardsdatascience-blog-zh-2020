<html>
<head>
<title>How to Download a Specific Sheet by Name from a Google Spreadsheet as a CSV File</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ä» Google ç”µå­è¡¨æ ¼ä¸­æŒ‰åç§°ä¸‹è½½ç‰¹å®šçš„å·¥ä½œè¡¨ä½œä¸º CSV æ–‡ä»¶</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/how-to-download-a-specific-sheet-by-name-from-a-google-spreadsheet-as-a-csv-file-e8c7b4b79f39?source=collection_archive---------9-----------------------#2020-05-03">https://towardsdatascience.com/how-to-download-a-specific-sheet-by-name-from-a-google-spreadsheet-as-a-csv-file-e8c7b4b79f39?source=collection_archive---------9-----------------------#2020-05-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f6a9cbeb3d66b981c5d901036d7bd68b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hJVepvidUPh-o508"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">å®‰è¿ªÂ·å‡¯åˆ©åœ¨<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šçš„ç…§ç‰‡</p></figure></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h1 id="05cf" class="kn ko it bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">æ¦‚è§‚</h1><p id="e4d0" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">åœ¨è¿‡å»çš„ä¸¤ç¯‡å…³äºä½¿ç”¨ Python çš„ Google Drive API çš„æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä»‹ç»äº†å¦‚ä½•åœ¨è¿™é‡Œè·å–å‡­è¯<a class="ae kf" href="https://medium.com/swlh/google-drive-api-with-python-part-i-set-up-credentials-1f729cb0372b?source=friends_link&amp;sk=53afa8687344dced6d66c9215ed78840" rel="noopener">ä»¥åŠåœ¨è¿™é‡Œ</a>é€šè¿‡åç§°<a class="ae kf" href="https://levelup.gitconnected.com/google-drive-api-with-python-part-ii-connect-to-google-drive-and-search-for-file-7138422e0563?source=friends_link&amp;sk=86c054a6d42c1998f60508f02dae4298" rel="noopener ugc nofollow" target="_blank">åœ¨ Google Drive ä¸­æœç´¢ç‰¹å®šæ–‡ä»¶ã€‚</a></p><p id="ef63" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä» Google ç”µå­è¡¨æ ¼ä¸­æŒ‰åç§°ä¸‹è½½ç‰¹å®šçš„å·¥ä½œè¡¨åˆ° csv æ–‡ä»¶ä¸­ã€‚ä¸€ä¸ªç”¨ä¾‹:æ‚¨éœ€è¦ç”Ÿæˆä¸€ä¸ªæŠ¥å‘Šï¼Œè¯¥æŠ¥å‘Šçš„æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ª Google ç”µå­è¡¨æ ¼ä¸­ï¼Œè¯¥è¡¨æ ¼æœ‰è®¸å¤šå·¥ä½œè¡¨ï¼Œä½†æ‚¨åªéœ€è¦å…¶ä¸­çš„ä¸€ä¸¤å¼ ã€‚å› æ­¤ï¼Œä¸ç”¨ä¸‹è½½æ•´ä¸ªè°·æ­Œç”µå­è¡¨æ ¼ï¼Œä½ å¯ä»¥è‡ªå·±æŒ‘é€‰ä½ éœ€è¦çš„è¡¨æ ¼ã€‚</p><p id="b20e" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">ä¸ºä»€ä¹ˆå«å®ƒçš„åå­—ï¼Ÿå› ä¸ºæˆ‘ä»æˆ‘çš„å·¥ä½œç»éªŒä¸­äº†è§£åˆ°ï¼Œäººä»¬å€¾å‘äºåšæŒå‘½åï¼Œå¹¶ä¸”é€šå¸¸ç”¨å®ƒçš„åå­—æ¥ç§°å‘¼å®ƒã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªäººå¯èƒ½ä¼šè¿™æ ·é—®ä»–æˆ–ä»–çš„åŒäº‹:â€œä½ èƒ½ä»æ”¶å…¥è¡¨ä¸­æå–æ•°æ®å—ï¼Ÿã€‚</p><p id="0a06" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">ä¸ç®¡æ€æ ·ï¼Œä½ çŸ¥é“æˆ‘åœ¨è¯´ä»€ä¹ˆã€‚ğŸ’©æˆ‘ä»¬å¼€å§‹å§ï¼Œå¥½å—ï¼Ÿ</p><p id="58e5" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">TLDRï¼›ä»<a class="ae kf" href="https://github.com/billydh/python-google-drive-api" rel="noopener ugc nofollow" target="_blank"> Github </a>ä¸‹è½½é¡¹ç›®å›è´­ã€‚</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h1 id="46b5" class="kn ko it bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">ä»¥ csv æ ¼å¼ä¸‹è½½ç‰¹å®šçš„å·¥ä½œè¡¨</h1><p id="6f7f" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">æˆ‘ä»¬å½“å‰çš„ Python è„šæœ¬èƒ½å¤Ÿæ ¹æ®æ–‡ä»¶åæœç´¢ç‰¹å®šçš„æ–‡ä»¶ã€‚è®©æˆ‘ä»¬ä¿®æ”¹è„šæœ¬ï¼Œè¿™æ ·å®ƒå°±èƒ½å¤Ÿå¼•ç”¨ Google ç”µå­è¡¨æ ¼ä¸­çš„ç‰¹å®šå·¥ä½œè¡¨ï¼Œå¹¶å°†å…¶ä¸‹è½½ä¸º csv æ–‡ä»¶ã€‚</p><p id="750a" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">åœ¨æœ¬æ•™ç¨‹çš„æœ€åï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ª Python è„šæœ¬ï¼Œå®ƒå¯ä»¥ä»å‘½ä»¤è¡Œæ‰§è¡Œï¼Œå¹¶å¸¦æœ‰ä¸¤ä¸ªè¾“å…¥å‚æ•°:</p><ul class=""><li id="1fe3" class="mo mp it ln b lo mj ls mk lw mq ma mr me ms mi mt mu mv mw bi translated">Google ç”µå­è¡¨æ ¼çš„åç§°</li><li id="af9d" class="mo mp it ln b lo mx ls my lw mz ma na me nb mi mt mu mv mw bi translated">è¦ä»¥ csv æ ¼å¼ä¸‹è½½çš„å·¥ä½œè¡¨åç§°</li></ul><p id="3222" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">è¦è·Ÿè¿›ï¼Œè¯·æŸ¥çœ‹å›è´­çš„è¿™ä¸ª<a class="ae kf" href="https://github.com/billydh/python-google-drive-api/tree/6c8d9083825add9de148ac21caae0d7db6595e15" rel="noopener ugc nofollow" target="_blank">æäº¤</a>ã€‚</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h2 id="bc94" class="nc ko it bd kp nd ne dn kt nf ng dp kx lw nh ni lb ma nj nk lf me nl nm lj nn bi translated">å¯ç”¨å·¥ä½œè¡¨ API</h2><p id="493e" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">æˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯å¯ç”¨ Google Sheets APIã€‚ç°åœ¨ï¼Œæ‰“å¼€ä½ çš„æµè§ˆå™¨ï¼Œè¿›å…¥<a class="ae kf" href="https://console.developers.google.com/apis/dashboard" rel="noopener ugc nofollow" target="_blank">https://console.developers.google.com/apis/dashboard</a>ã€‚ç„¶åï¼Œç¡®ä¿ä½ æ˜¯åœ¨æ­£ç¡®çš„é¡¹ç›®ä¸Šï¼Œå¦‚æœä¸æ˜¯ï¼Œä»ä¸‹æ‹‰åˆ—è¡¨ä¸­é€‰æ‹©æ­£ç¡®çš„é¡¹ç›®ã€‚</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/0463c144a5f06880bb97e047af3d6fe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mhmYEn6zJ7guSAXreoX0RA.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">è°·æ­Œå¼€å‘è€…æ§åˆ¶å°</p></figure><p id="874e" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">æ¥ä¸‹æ¥ï¼Œè½¬åˆ°â€œåº“â€é€‰é¡¹å¡ï¼Œåœ¨æœç´¢æ ä¸­é”®å…¥â€œå›¾çº¸â€ã€‚</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nt"><img src="../Images/40df2b77bbc11d18f3867d004de1c632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5EKX4zB1vrFYB7LF3dK9g.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">è°·æ­Œå¼€å‘è€…åº“</p></figure><p id="11fc" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">ç»§ç»­ç‚¹å‡»å®ƒã€‚ä¸€æ—¦ä½ ç™»é™†åˆ° Google Sheets API é¡µé¢ï¼Œç‚¹å‡»<strong class="ln iu"> ENABLE </strong>æŒ‰é’®æ¥å¯ç”¨è¿™ä¸ª APIã€‚</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/4e01ec915b1c30ee702c934382413c8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AL3vb76LBB14nrVGwdXTXA.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">å¯ç”¨ Google å·¥ä½œè¡¨ API</p></figure><p id="7d58" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">åœ¨é‚£ä¹‹åï¼Œå¦‚æœä½ åªæ˜¯å»å‡­è¯é€‰é¡¹å¡ï¼Œä½ ä¼šçœ‹åˆ°å®ƒè¯´æˆ‘ä»¬çš„å‡­è¯ï¼Œæˆ‘ä»¬æ—©äº›æ—¶å€™ä¸º Google Drive API è®¾ç½®çš„æ˜¯ä¸ Sheets API å…¼å®¹çš„ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å·²ç»æ‹¥æœ‰å¹¶ä¸ºæˆ‘ä»¬çš„è„šæœ¬è®¾ç½®çš„å‡­è¯ã€‚ğŸ™‚</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nv"><img src="../Images/6f910baa4dfee9843a6fcbcea202e093.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*whbCUTS5D8-mLNljvHOg-w.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">Google Sheets API è¯ä¹¦</p></figure></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h2 id="a1d6" class="nc ko it bd kp nd ne dn kt nf ng dp kx lw nh ni lb ma nj nk lf me nl nm lj nn bi translated">æ·»åŠ ä¸€ä¸ªåŠŸèƒ½æ¥ä¸‹è½½ä¸€ä¸ª csv æ ¼å¼çš„è°·æ­Œè¡¨å•</h2><p id="8463" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨ Sheets APIï¼Œæˆ‘ä»¬éœ€è¦å¦‚ä¸‹åˆå§‹åŒ–ä¸€ä¸ª Sheets æœåŠ¡å®ä¾‹ã€‚</p><pre class="np nq nr ns gt nw nx ny nz aw oa bi"><span id="550d" class="nc ko it nx b gy ob oc l od oe">sheets = discovery.build('sheets', 'v4', credentials=credentials)</span></pre><p id="638c" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†ä¸Šé¢çš„ä»£ç æ·»åŠ åˆ°æˆ‘ä»¬ç°æœ‰çš„<code class="fe of og oh nx b">connect_to_google_drive.py</code>æ–‡ä»¶ä¸­(æˆ‘ä»¬ç¨åå°†é‡æ„å®ƒ)ã€‚</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><p id="c839" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">æ—¢ç„¶æˆ‘ä»¬ç¼©å°äº†è„šæœ¬çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç°æœ‰çš„<code class="fe of og oh nx b">retrieve_all_files</code>ä¸­æ·»åŠ ä¸€ä¸ªè¿‡æ»¤å™¨ï¼ŒåªæŸ¥æ‰¾ Google ç”µå­è¡¨æ ¼ç±»å‹çš„æ–‡ä»¶ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦æ·»åŠ ä¸€ä¸ªå‚æ•°<code class="fe of og oh nx b">q</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p><pre class="np nq nr ns gt nw nx ny nz aw oa bi"><span id="428e" class="nc ko it nx b gy ob oc l od oe"># define a function to retrieve all files<br/>def retrieve_all_files(api_service, filename_to_search):<br/>    results = []<br/>    page_token = None<br/><br/>    while True:<br/>        try:<br/>            param = {'q': 'mimeType="application/vnd.google-apps.spreadsheet"'}<br/><br/>            if page_token:<br/>                param['pageToken'] = page_token<br/><br/>            files = api_service.files().list(**param).execute()<br/>    ...<br/>    ...<br/>    ...</span></pre><p id="00f5" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">é€šè¿‡æ·»åŠ <code class="fe of og oh nx b">mimeType="application/vnd.google-apps.spreadsheet"</code>ï¼Œå®ƒå‘Šè¯‰ Google Drive API çš„<code class="fe of og oh nx b">list()</code>æ–¹æ³•åªè¿”å›æ–‡ä»¶çš„ mime ç±»å‹æ˜¯ Google ç”µå­è¡¨æ ¼çš„ç»“æœã€‚</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><p id="d6c6" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">æœ€åï¼Œè®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°å°†ä½¿ç”¨å·¥ä½œè¡¨ API çš„<code class="fe of og oh nx b">values()</code>æ–¹æ³•ä»ç‰¹å®šçš„å·¥ä½œè¡¨ä¸­è·å–å•å…ƒæ ¼å€¼ï¼Œå¹¶å°†å®ƒä»¬å†™å…¥ä¸€ä¸ª csv æ–‡ä»¶ã€‚</p><pre class="np nq nr ns gt nw nx ny nz aw oa bi"><span id="b4a4" class="nc ko it nx b gy ob oc l od oe"># define a function to export sheet to csv<br/>def download_sheet_to_csv(spreadsheet_id, sheet_name):<br/>    result = sheets.spreadsheets().values().get(spreadsheetId=spreadsheet_id, range=sheet_name).execute()<br/>    output_file = f'{sheet_name}.csv'<br/><br/>    with open(output_file, 'w') as f:<br/>        writer = csv.writer(f)<br/>        writer.writerows(result.get('values'))<br/><br/>    f.close()<br/><br/>    print(f'Successfully downloaded {sheet_name}.csv')</span></pre><p id="02df" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">è®©æˆ‘ä»¬åœ¨è„šæœ¬çš„æœ€åè°ƒç”¨è¿™ä¸ªæ–°å‡½æ•°ï¼Œå°±åƒè¿™æ ·ã€‚</p><pre class="np nq nr ns gt nw nx ny nz aw oa bi"><span id="f60e" class="nc ko it nx b gy ob oc l od oe"># call the function<br/>filename_to_search = 'Christmas Plan'<br/>all_files, search_file = retrieve_all_files(drive, filename_to_search)<br/><br/>download_sheet_to_csv(search_file.get('id'), 'Sheet2')</span></pre><p id="53ab" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">å¯¹äºè¿™ä¸ªä¾‹å­ï¼ŒSheet2 çš„å†…å®¹æ˜¯è¿™æ ·çš„ã€‚</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oi"><img src="../Images/1ce48942366a8970b269cccd0c30cb16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-x-H80BNTmmmM02WbcZsfQ.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">å·¥ä½œè¡¨ 2</p></figure></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><p id="c1ad" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">é…·æ¯™äº†ã€‚ç°åœ¨ç»§ç»­ä»ç»ˆç«¯è¿è¡Œè¿™ä¸ªè„šæœ¬ã€‚è®°å¾—åœ¨è¿è¡Œè„šæœ¬ä¹‹å‰æ¿€æ´»æ‚¨çš„è™šæ‹Ÿç¯å¢ƒã€‚ğŸ™‚è¿™æ˜¯è„šæœ¬å®Œæˆåæ‚¨å°†åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°çš„å†…å®¹ã€‚</p><pre class="np nq nr ns gt nw nx ny nz aw oa bi"><span id="0269" class="nc ko it nx b gy ob oc l od oe">$ python connect_to_google_drive.py</span><span id="9b64" class="nc ko it nx b gy oj oc l od oe">{'kind': 'drive#file', 'id': '1GyIz1NqCg6Bkr0Z_3Craem0BAwG0195usRswduCtKab', 'name': 'Christmas Plan', 'mimeType': 'application/vnd.google-apps.spreadsheet'}</span><span id="351e" class="nc ko it nx b gy oj oc l od oe">Successfully downloaded Sheet2.csv</span></pre><p id="f4bd" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">è®©æˆ‘ä»¬é€šè¿‡æŸ¥çœ‹å…¶å†…å®¹æ¥éªŒè¯ä¸‹è½½çš„æ–‡ä»¶ã€‚</p><pre class="np nq nr ns gt nw nx ny nz aw oa bi"><span id="84d2" class="nc ko it nx b gy ob oc l od oe">$ cat Sheet2.csv</span><span id="4875" class="nc ko it nx b gy oj oc l od oe">No,Code,Name<br/>1,123,Apple<br/>2,234,Watermelon<br/>3,345,Banana<br/>4,456,Blueberry<br/>5,567,Dragonfruit<br/>6,678,Cherry<br/>7,789,Strawberry<br/>8,890,Kiwi<br/>9,901,Avocado</span></pre><p id="7a93" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">å¥½å§ã€‚çœ‹èµ·æ¥æˆ‘ä»¬çš„è„šæœ¬åƒé¢„æœŸçš„é‚£æ ·å·¥ä½œã€‚å¿«ä¹çš„æ—¥å­ğŸ˜ƒ</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h2 id="2078" class="nc ko it bd kp nd ne dn kt nf ng dp kx lw nh ni lb ma nj nk lf me nl nm lj nn bi translated">é‡æ„ä»£ç å¹¶å…è®¸å®ƒæ¥å—å‘½ä»¤è¡Œå‚æ•°</h2><p id="aa31" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">æ­£å¦‚æ‰€æ‰¿è¯ºçš„ï¼Œæˆ‘ä»¬ç°åœ¨å°†é‡æ„ä»£ç å¹¶è½¬æ¢å®ƒï¼Œä»¥ä¾¿å®ƒå°†ä»å‘½ä»¤è¡Œæ¥å—ä¸¤ä¸ªè¾“å…¥å‚æ•°ã€‚</p><p id="108d" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">ä¸ºäº†åŒºåˆ†å¼€æ¥ï¼Œæˆ‘ä»¬å°†æŠŠ<code class="fe of og oh nx b">connect_to_google_drive.py</code>ä¸­çš„æ‰€æœ‰å‡½æ•°æå–åˆ°å•ç‹¬çš„ Python æ–‡ä»¶ä¸­ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå‘½åä¸º<code class="fe of og oh nx b">google_api_functions</code>ã€‚</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><p id="c0aa" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬å°†åˆå§‹åŒ–æˆ‘ä»¬çš„ drive å’Œ sheets å®ä¾‹çš„ä»£ç è¡Œæå–åˆ°ä¸€ä¸ªæ–°æ–‡ä»¶ä¸­ï¼Œå¹¶å°†å…¶å‘½åä¸º<code class="fe of og oh nx b">get_api_services.py</code>ã€‚</p><figure class="np nq nr ns gt ju"><div class="bz fp l di"><div class="ok ol l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">get_api_services.py</p></figure></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><p id="fbbb" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†é‡æ„<code class="fe of og oh nx b">retrieve_all_files</code>å‡½æ•°ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬ä»è¿™ä¸ªå‡½æ•°ä¸­éœ€è¦çš„å”¯ä¸€ä¿¡æ¯æ˜¯ Google ç”µå­è¡¨æ ¼çš„<code class="fe of og oh nx b">id</code>ã€‚æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬åˆ é™¤ä¸å¿…è¦çš„è¡Œï¼Œæœ€åï¼Œå°†å…¶æå–åˆ°ä¸€ä¸ªåä¸º<code class="fe of og oh nx b">get_spreadsheet_id.py</code>çš„æ–° Python æ–‡ä»¶ä¸­ã€‚</p><figure class="np nq nr ns gt ju"><div class="bz fp l di"><div class="ok ol l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">get _ ç”µå­è¡¨æ ¼ _id.py</p></figure></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><p id="23d3" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">æœ€åè¦æå–å‡ºæ¥çš„å‡½æ•°æ˜¯<code class="fe of og oh nx b">download_sheet_to_csv</code>å‡½æ•°ã€‚è®©æˆ‘ä»¬å°†å®ƒæå–åˆ°ä¸€ä¸ªåä¸º<code class="fe of og oh nx b">download_sheet_to_csv.py</code>çš„æ–°æ–‡ä»¶ä¸­ã€‚</p><figure class="np nq nr ns gt ju"><div class="bz fp l di"><div class="ok ol l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">ä¸‹è½½ _ å·¥ä½œè¡¨ _ åˆ° _csv.py</p></figure></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><p id="f553" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å°†æŠŠæˆ‘ä»¬çš„<code class="fe of og oh nx b">connect_to_google_drive.py</code>æ–‡ä»¶é‡å‘½åä¸º<code class="fe of og oh nx b">main.py</code>ã€‚è¿™æ˜¯æˆ‘ä»¬å°†ä»å‘½ä»¤è¡Œè°ƒç”¨çš„ Python æ–‡ä»¶ã€‚</p><p id="51ee" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">æˆ‘ä»¬å°†åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ·»åŠ ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå°†è§£æé€šè¿‡å‘½ä»¤è¡Œä¼ é€’çš„å‚æ•°ï¼Œè¿™äº›å‚æ•°å°†æ˜¯ç”µå­è¡¨æ ¼åç§°å’Œå·¥ä½œè¡¨åç§°ã€‚</p><pre class="np nq nr ns gt nw nx ny nz aw oa bi"><span id="53e3" class="nc ko it nx b gy ob oc l od oe">def parse_args():<br/>    parser = argparse.ArgumentParser(description="Function to download a specific sheet from a Google Spreadsheet")<br/><br/>    parser.add_argument("--spreadsheet-name", required=True, help="The name of the Google Spreadsheet")<br/>    parser.add_argument("--sheet-name", required=True, help="The name of the sheet in spreadsheet to download as csv")<br/><br/>    return parser.parse_args()</span></pre></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><p id="90aa" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">æœ€åï¼Œè®©æˆ‘ä»¬ç¼–å†™å½“ä»å‘½ä»¤è¡Œè°ƒç”¨è„šæœ¬<code class="fe of og oh nx b">main.py</code>æ—¶å°†è¢«æ‰§è¡Œçš„ä»£ç è¡Œã€‚</p><pre class="np nq nr ns gt nw nx ny nz aw oa bi"><span id="f011" class="nc ko it nx b gy ob oc l od oe">if __name__ == '__main__':<br/>    args = parse_args()<br/><br/>    spreadsheet_name = args.spreadsheet_name<br/>    sheet_name = args.sheet_name<br/><br/>    drive, sheets = get_api_services()<br/><br/>    spreadsheet_id = get_spreadsheet_id(drive, spreadsheet_name)<br/>    download_sheet_to_csv(sheets, spreadsheet_id, sheet_name)</span></pre><p id="e62f" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">ä¸é”™ï¼ç°åœ¨ï¼Œæˆ‘ä»¬çš„ä»£ç å˜å¾—æ›´åŠ æ¸…æ™°å’Œæ˜“äºéµå¾ªã€‚ğŸ™‚</p><p id="4f52" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">æœ‰äº†è¿™ä¸ªæ–°çš„<code class="fe of og oh nx b">main.py</code>è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥ä»å‘½ä»¤è¡Œè°ƒç”¨å®ƒçš„æ–¹å¼å¦‚ä¸‹ã€‚</p><pre class="np nq nr ns gt nw nx ny nz aw oa bi"><span id="2f06" class="nc ko it nx b gy ob oc l od oe">$ python main.py --spreadsheet-name "Christmas Plan" --sheet-name Sheet2</span><span id="3a02" class="nc ko it nx b gy oj oc l od oe">Successfully downloaded Sheet2.csv</span></pre><p id="3e98" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">å°±æ˜¯è¿™æ ·ã€‚ğŸ˜º</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><h1 id="0542" class="kn ko it bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">åŒ…è£¹</h1><p id="92c6" class="pw-post-body-paragraph ll lm it ln b lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">åœ¨è¿‡å»çš„ä¸‰ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†ä»¥ä¸‹å†…å®¹:</p><ul class=""><li id="dedc" class="mo mp it ln b lo mj ls mk lw mq ma mr me ms mi mt mu mv mw bi translated">è®¾ç½®å‡­è¯ä»¥ä½¿ç”¨ Google Drive API â€” <a class="ae kf" href="https://medium.com/swlh/google-drive-api-with-python-part-i-set-up-credentials-1f729cb0372b?source=friends_link&amp;sk=53afa8687344dced6d66c9215ed78840" rel="noopener">é“¾æ¥</a></li><li id="7560" class="mo mp it ln b lo mx ls my lw mz ma na me nb mi mt mu mv mw bi translated">åœ¨ Google Drive ä¸­æœç´¢æ–‡ä»¶â€” <a class="ae kf" href="https://levelup.gitconnected.com/google-drive-api-with-python-part-ii-connect-to-google-drive-and-search-for-file-7138422e0563?source=friends_link&amp;sk=86c054a6d42c1998f60508f02dae4298" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a></li><li id="b0ef" class="mo mp it ln b lo mx ls my lw mz ma na me nb mi mt mu mv mw bi translated">ä»¥ csv æ ¼å¼ä¸‹è½½ç‰¹å®šçš„å·¥ä½œè¡¨</li></ul><p id="faa1" class="pw-post-body-paragraph ll lm it ln b lo mj lq lr ls mk lu lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬åº”è¯¥éƒ½ç†Ÿæ‚‰ Google Drive å’Œ Sheets API äº†ã€‚æˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ API åšå¾ˆå¤šå…¶ä»–çš„äº‹æƒ…ï¼Œå› æ­¤ï¼Œæˆ‘é¼“åŠ±å¤§å®¶è¿›ä¸€æ­¥æ¢ç´¢å®ƒï¼Œå¹¶æ„å»ºä¸€äº›è‡ªåŠ¨åŒ–è„šæœ¬æ¥å¸®åŠ©æ‚¨çš„å·¥ä½œæˆ–ç”Ÿæ´»ã€‚ğŸ™</p></div><div class="ab cl kg kh hx ki" role="separator"><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl km"/><span class="kj bw bk kk kl"/></div><div class="im in io ip iq"><figure class="np nq nr ns gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi om"><img src="../Images/efb0a67ac7fcb59d0bd9075e3cc8296a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Q3dd7hq2zPoi58VZ"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae kf" href="https://unsplash.com/@thenata?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Anastasia Taioglou </a>åœ¨<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</p></figure></div></div>    
</body>
</html>