<html>
<head>
<title>Metastatic Cancer Detection in Histopathological Image Scans</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">组织病理学图像扫描中转移癌检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/metastatic-cancer-detection-in-histopathological-image-scans-de4eeb570a8?source=collection_archive---------27-----------------------#2020-02-29">https://towardsdatascience.com/metastatic-cancer-detection-in-histopathological-image-scans-de4eeb570a8?source=collection_archive---------27-----------------------#2020-02-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ac0e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用机器学习来预测癌症是否在显微图像中。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/24704de63ad7261d25842b928d087ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XisG1uO2Fr28-XCVK2J8zQ.png"/></div></div></figure><h1 id="ab9f" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated"><strong class="ak">癌症的可怕故事</strong></h1><p id="7b47" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">癌症仍然是世界上最致命的疾病之一，每年导致超过 1000 万人死亡<strong class="lo iu">。癌症如此致命的原因之一是，如果不管它，即使是很短的一段时间，它可能已经接管了一个生物系统。早期诊断是战胜癌症的关键，而机器学习正在彻底改变早期诊断。</strong></p><p id="0869" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">机器学习能够推断出人类无法推断的模式。这包括在图像中寻找非常抽象的模式。使用机器学习的能力，可以创建一个模型来从图像扫描中的非癌细胞中推断出癌细胞。<strong class="lo iu">卷积神经网络</strong>也可以帮助解决这个问题，因为它们非常适合在图像扫描等空间敏感数据中寻找关系。</p><h1 id="17bb" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated"><strong class="ak">转移癌</strong></h1><p id="7331" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">癌症通常始于身体的原发部位，然后恶性扩散。源自身体原发部位的癌症是转移性癌症。从本质上说，继发性癌症是原发性癌症的直接结果。那么为什么我们要寻找继发性癌症而不是根本原因呢？因为当扫描全身时，更容易推断出继发性癌症，并且当某人患有癌症时，转移性癌症通常少量遍布全身。发现转移性癌症就像一个指标，可以确定某人是否在身体的其他地方患有严重的癌症。</p><p id="a3b4" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">具体来说，转移癌可以在身体的不同器官中发现。我们可以检查<strong class="lo iu">组织病理学图像扫描</strong>，这是人体内器官和细胞的显微图像。组织病理学图像扫描具有人体正在观察的部位的不同细胞的大量细节，并且可以检查不同的疾病。然而，在这些扫描中很难判断是否存在癌症，因为我们并不都是癌症研究领域的专家。<strong class="lo iu">机器学习可以用来解决这个问题，告诉组织病理学图像扫描中是否存在转移癌。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/08598520c1e817b010ea40239253eb5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/0*CZyRAxGbS-R3B1ZW"/></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">组织病理学图像扫描</p></figure><h1 id="9fc7" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated"><strong class="ak">机器学习+卷积神经网络</strong></h1><p id="bd8b" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">机器学习就是让机器学习如何执行特定的任务。代替给出明确的指令，<strong class="lo iu">机器学习创建自己的指令</strong>。实际上，所有这些指令都是数学值。机器学习模型只是一个<strong class="lo iu">可微分函数</strong>，它接受预定义数量的输入，使用变量(权重)对输入执行操作，并产生输出。这就好比<em class="ms"> y = mx + b </em>。<em class="ms"> x </em>是模型的输入，<em class="ms"> m </em>和<em class="ms"> b </em>是变量(权重)，而<em class="ms"> y </em>是输出。机器算法必须优化<em class="ms"> m </em>和<em class="ms"> b </em>权重，以便在给定任何输入时，它将始终产生所需的输出。我们如何优化我们的变量？基本上有两个步骤，产生损失和反向传播。</p><h2 id="b33d" class="mt kv it bd kw mu mv dn la mw mx dp le lv my mz lg lz na nb li md nc nd lk ne bi translated"><em class="nf">损失函数</em></h2><p id="cda6" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">损失函数是表示模型表现有多差的函数。损失越大，模型表现越差。我们可以通过使用<strong class="lo iu">标记的数据</strong>来生成损失。我们可以给 x 的模型输入，让它根据自己的权重产生自己的输出。因为我们已经标记了数据，所以我们知道模型的输出应该是什么。我们可以比较模型的输出和真实的输出，看看有什么不同。例如，模型的输出可能是 3，而实际输出可能是 5。本例中的损耗可能是 2，这是两个输出之间的距离。我们希望模型总是产生 0 的损失，这意味着我们需要<strong class="lo iu">最小化损失函数</strong>。</p><h2 id="ee71" class="mt kv it bd kw mu mv dn la mw mx dp le lv my mz lg lz na nb li md nc nd lk ne bi translated"><em class="nf">反向传播</em></h2><p id="8167" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">反向传播是回到模型的权重并改变它们以最小化损失函数的过程。它通过获取损失函数并计算其梯度来做到这一点。梯度是所产生损耗的瞬时变化率，查看梯度，我们可以找到梯度的最低点，此时重量产生的损耗较低。这被称为<strong class="lo iu">梯度下降</strong>，是许多机器学习算法的关键。我们可以重复这个过程，直到我们的损失越来越小，而我们的模型越来越好。通常，一个模型会有数千个权重，因此在生成输出时，模型会变得非常精确。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/3a99bb7a8461a1f2618e2d42927b766f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LfEsG8tABE9kxV1k"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated"><a class="ae nh" href="https://mc.ai/gradient-descent-and-its-types/" rel="noopener ugc nofollow" target="_blank">梯度下降可视化</a></p></figure><h2 id="8dd4" class="mt kv it bd kw mu mv dn la mw mx dp le lv my mz lg lz na nb li md nc nd lk ne bi translated"><em class="nf">卷积神经网络</em></h2><p id="0d23" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">卷积神经网络采用了上述机器学习的所有原则，还结合了一种可以分析空间数据(如图像和音频)的方法。它使用<strong class="lo iu">过滤器</strong>，这是一种使用权重扫描输入数据的机器学习算法。过滤器是扫描输入数据的权重网格，每次扫描时，将权重乘以输入。由于图像也只是数值网格，卷积过滤器可以很容易地越过它们。在一个<strong class="lo iu">卷积</strong>之后或者当它完成扫描图像时，扫描的结果(乘积)被汇集在一起。池化基本上是用一种更小更简洁的方式表示输入数据，并包含所有重要的特性。从本质上来说，卷积神经网络所做的是，它们推导出图像的特殊特征，并将它们放在一起。</p><p id="e9c9" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><a class="ae nh" href="https://medium.com/@vanshsethi17/a-beginners-guide-convolutional-neural-networks-f40d64453904" rel="noopener">要获得更容易理解的解释，请查看我写的这篇更详细解释卷积神经网络的文章。</a></p><h1 id="7211" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated"><strong class="ak">转移癌检测模型</strong></h1><h2 id="47ec" class="mt kv it bd kw mu mv dn la mw mx dp le lv my mz lg lz na nb li md nc nd lk ne bi translated"><em class="nf">数据</em></h2><p id="54f1" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">用于创建模型的数据是 Kaggle 上的<a class="ae nh" href="https://www.kaggle.com/c/histopathologic-cancer-detection/data" rel="noopener ugc nofollow" target="_blank"> <em class="ms">组织病理学癌症检测</em> </a>标记数据。它带有超过 150，0 00 张组织病理学扫描图像，每张图像都标有 1 或 0。0 表示图像中没有常见的转移癌，1 表示图像中有转移癌。每个图像是 96 像素乘 96 像素乘 3 个颜色通道(红、蓝、绿)。我们可以用 96×96×3 的网格值来表示每幅图像。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/d879e3aa405557db5363590d41ae201e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oCjX88yHX50lGoEneNbtWA.png"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">数据示例</p></figure><h2 id="5b02" class="mt kv it bd kw mu mv dn la mw mx dp le lv my mz lg lz na nb li md nc nd lk ne bi translated"><em class="nf">型号</em></h2><p id="a2b2" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">该模型的概念是基于机器学习的原则，并针对手头的任务进行定制。</p><p id="ff8e" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">卷积层用于图像的<strong class="lo iu">特征提取</strong>，以概括癌症图像的样子和非癌症图像的样子。这些层是 2D 卷积神经网络，这意味着卷积层采用值的 3D 矩阵(图像的表示)。</p><p id="5a67" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">最大池层采用卷积层创建的特征地图，并<strong class="lo iu">对其进行概化</strong>。这是通过对图像中的每个 3x3 方块取最大值来实现的。这样，当特征图被提供给神经网络的其他部分时，它可以更容易地计算出图像是否包含癌症。</p><p id="a1aa" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">分散在整个网络中的辍学层是为了确保模型学会执行任务，而<strong class="lo iu">不仅仅是记住数据</strong>。它通过在损失计算过程中关闭某些权重来实现这一点，这导致精度稍低，但可以推广到大量图像。</p><p id="ca5f" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">最后，密集层理解特征图，实际上<strong class="lo iu">计算出是否有癌症</strong>。最后一层包含一个节点或输出，可以是 0 或 1。0 表示没有癌症，1 表示有癌症。损失函数将使用它来计算损失，反向传播将优化这些层中的权重。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="d86d" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">该模型包含超过<strong class="lo iu">5100 万+ </strong>个参数，这意味着它可以达到非常好的精确度。</p><h2 id="5d5b" class="mt kv it bd kw mu mv dn la mw mx dp le lv my mz lg lz na nb li md nc nd lk ne bi translated"><em class="nf">损失函数+优化</em></h2><p id="8bc1" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">用于该模型的损失函数是<strong class="lo iu">分类交叉熵损失</strong>。该损耗采用模型输出并执行对数函数，然后乘以实际损耗。它使用对数函数，因为当你开始得到真正的答案时，损失会成倍增加。</p><p id="7708" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">用于这个模型的优化器是 Adam 优化器。这个优化器执行常规的反向传播，但是当它越来越接近损失函数的全局最小值时，它减慢它优化的速度以防止超过最小值。这是一个非常标准的优化函数。</p><h2 id="b071" class="mt kv it bd kw mu mv dn la mw mx dp le lv my mz lg lz na nb li md nc nd lk ne bi translated"><em class="nf">培训</em></h2><p id="004f" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">该模型训练了超过<strong class="lo iu"> 10 个时期</strong>或在整个数据集上执行了<strong class="lo iu">批 100 个图像</strong>中的 10 次反向传播。20%的图像用于验证或确保模型正在训练。经过几个小时的训练，模型完成了。</p><h1 id="9b10" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated"><strong class="ak">结果在……</strong></h1><p id="be9e" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">该模型获得了 80%的癌症检测准确率。也就是说，80%的预测是正确的。这里有几个例子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/7d227758acc8fd96a89491573d08d0dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J5ESRhgykdlOyiKadVKHpQ.png"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">该模型的示例</p></figure><p id="7db4" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">总的来说，该模型工作得非常好，在检测癌症时是一个可行的选择。</p><h2 id="0848" class="mt kv it bd kw mu mv dn la mw mx dp le lv my mz lg lz na nb li md nc nd lk ne bi translated">参考资料:</h2><p id="c8c0" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated"><a class="ae nh" href="https://mc.ai/gradient-descent-and-its-types/" rel="noopener ugc nofollow" target="_blank">https://mc.ai/gradient-descent-and-its-types/</a>(渐变下降图像)</p></div></div>    
</body>
</html>