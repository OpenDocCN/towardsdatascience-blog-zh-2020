<html>
<head>
<title>Building an Image-Taking Interface Application for Your Image Recognition Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为您的图像识别模型构建一个图像摄取界面应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-an-image-taking-interface-application-for-your-image-recognition-model-973b121cc9d9?source=collection_archive---------32-----------------------#2020-03-26">https://towardsdatascience.com/building-an-image-taking-interface-application-for-your-image-recognition-model-973b121cc9d9?source=collection_archive---------32-----------------------#2020-03-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/9932fc3e509a16cfffa153c21846b322.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JpjypdslhZHdb0-b.jpg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片来自<a class="ae jg" href="https://pixabay.com/illustrations/images-by-machine-learn-photos-cat-3853117/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><div class=""/><div class=""><h2 id="d3b2" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">探索模型的实际应用</h2></div><p id="c6c9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通常，数据科学家会为图像识别建立一个模型，查看精确度，如果精确度足够高，就认为工作已经完成。自从我 13 岁开始学习机器，我就一直不明白这一点。为什么要花费所有的时间来构建最好的模型——仅仅是为了满足于一个数字？</p><p id="5ef7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我将提供代码，并带您了解如何通过构建一个拍照界面来与模型进行交互，从而真正完成您的项目。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="fbe4" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">安装 cv2 (OpenCV)</h1><p id="1c21" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">我们将用于拍摄图像的库是<code class="fe my mz na nb b">cv2</code>。因为<code class="fe my mz na nb b">cv2</code>不能在 Kaggle 这样的在线平台上工作，所以必须在你的电脑上本地完成。但是，仍然可以在 Kaggle 上训练模型的权重，以<code class="fe my mz na nb b">.h5</code>文件的形式下载(对于 Keras/TensorFlow)并加载。</p><p id="3bb5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在 Anaconda 或命令提示符下，键入</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="bb02" class="nk mc jj nb b gy nl nm l nn no">conda create -n opencv python=3.6</span></pre><p id="82bd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这在 Python 版中创建了一个名为<code class="fe my mz na nb b">opencv</code>的新环境，可以用您正在使用的任何版本来替换它。</p><figure class="nc nd ne nf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi np"><img src="../Images/94ce9327a386b4d349575136ab2b0faf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LIBJQ4c4IhjDQTUzovdP8w.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">最上面的几行应该是这样的。</p></figure><p id="f96f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，输入</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="8018" class="nk mc jj nb b gy nl nm l nn no">pip install opencv-python</span></pre><figure class="nc nd ne nf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nq"><img src="../Images/218134fac2caa87698d2cb4447405ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FXeF1mE5vdyojZ26rdnxgQ.png"/></div></div></figure><p id="2502" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您已经成功安装了<code class="fe my mz na nb b">cv2</code>！现在你可以开始拍照了。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="068e" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">使用 CV2 拍摄图像</h1><p id="33b4" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">首先，导入库。</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="c215" class="nk mc jj nb b gy nl nm l nn no">import cv2</span></pre><p id="ea20" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们必须创建一个<code class="fe my mz na nb b">VideoCapture</code>实例。您可以测试该实例是否能够连接您的相机(如果不能，请检查您的设置以确保应用程序可以访问它)。</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="c2c2" class="nk mc jj nb b gy nl nm l nn no">cap = cv2.VideoCapture(0)<br/>if not (cap.isOpened()):<br/>    print("Video device not connected.")</span></pre><p id="decb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，该拍照了。如果你想控制什么时候拍照，第一行指定一个任意的变量和输入。除非输入内容(如按“enter”)，否则程序无法继续，下一行将拍摄图片。拍摄图像时，您可能会看到网络摄像头指示灯短暂亮起。第三行关闭连接，第四行销毁所有访问相机的实例。</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="a881" class="nk mc jj nb b gy nl nm l nn no">arb = input('Press enter to take picture.')<br/>ret, frame = cap.read()<br/>cap.release()<br/>cv2.destroyAllWindows()</span></pre><p id="6c08" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">来自图像的数据存储在<code class="fe my mz na nb b">frame</code>中。它可以用下面的代码转换成一个数组:</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="110b" class="nk mc jj nb b gy nl nm l nn no">cv2_im = cv2.cvtColor(frame,cv2.COLOR_BGR2RGB)</span></pre><p id="96ad" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">调用<code class="fe my mz na nb b">cv2_im.shape</code>时，输出为<code class="fe my mz na nb b">(480, 640, 3)</code>。因此，图像(对于我的相机)是 480×640 像素(3 代表“深度”——每个像素中的三个值解释了要包含多少红色、绿色和蓝色来创建最终的像素颜色)。</p><figure class="nc nd ne nf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nr"><img src="../Images/f122e073e5fd1a9eedc16a9d83af7a06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RSGmR_oje6FmC3_733Z3lg.png"/></div></div></figure><p id="dc70" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在你的图像已经被转换成了一个数组，<code class="fe my mz na nb b">matplotlib</code>的<code class="fe my mz na nb b">imshow()</code>可以显示它了。</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="5014" class="nk mc jj nb b gy nl nm l nn no">import matplotlib.pyplot as plt<br/>plt.imshow(cv2_im)<br/>plt.show()</span></pre><figure class="nc nd ne nf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ns"><img src="../Images/1d54fded8a23523e94f6502dd70a20c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ph6ZVA9hGpCj0F_kbPOyg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">干得好！</p></figure><p id="1da1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">完整代码:</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="4a5f" class="nk mc jj nb b gy nl nm l nn no">import cv2<br/>import matplotlib.pyplot as plt</span><span id="eccf" class="nk mc jj nb b gy nt nm l nn no">cap = cv2.VideoCapture(10)<br/>if not (cap.isOpened()):<br/>    print("Video device unconnected.")<br/>arb = input('Press enter to take picture.')<br/>ret, frame = cap.read()<br/>cap.release()<br/>cv2.destroyAllWindows()<br/>cv2_im = cv2.cvtColor(frame,cv2.COLOR_BGR2RGB)<br/>plt.imshow(cv2_im)<br/>plt.show()</span></pre></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="cdf1" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">根据模型标准格式化</h1><p id="9716" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">卷积神经网络只接受固定大小的图像，例如<code class="fe my mz na nb b">(100, 100, 3)</code>。有几种方法可以做到这一点。</p><p id="d8a3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要保留图像的比例长度，裁剪图像可能会有所帮助。</p><p id="eb38" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一般语法是</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="c6dd" class="nk mc jj nb b gy nl nm l nn no">plt.imshow(cv2_im[y_upper_bound:y_lower_bound,x_lower_bound:x_higher_bound])</span></pre><p id="3b33" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中“上”和“下”由图像上的位置决定(<code class="fe my mz na nb b">y</code>的“上”在图像的上方，<code class="fe my mz na nb b">x</code>的“上”在更右边)。</p><p id="2227" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">举个例子，</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="be24" class="nk mc jj nb b gy nl nm l nn no">plt.imshow(cv2_im[100:400,100:400])</span></pre><figure class="nc nd ne nf gt iv gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/41273192220b67f321a7f6410a9ff97e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*v_khkuKMWwxVUWoiy8OJvQ.png"/></div></figure><p id="ad25" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这会将照片裁剪成方形。</p><p id="0962" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是，尺寸仍然是 300 乘 300。为了解决这个问题，我们将再次使用枕头:</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="d2a1" class="nk mc jj nb b gy nl nm l nn no">pil_image = Image.fromarray(cv2_im[100:400,100:400])<br/>width = 100<br/>height = 100<br/>pil_image = pil_image.resize((width,height), Image.ANTIALIAS)</span></pre><p id="f81b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">NumPy 自动将枕头图像转换成数组。</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="de70" class="nk mc jj nb b gy nl nm l nn no">import numpy as np<br/>cv2_im_new = np.array(pil_image)</span></pre><p id="a7cc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">查看新图像:</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="b50d" class="nk mc jj nb b gy nl nm l nn no">plt.imshow(cv2_im_new)</span></pre><figure class="nc nd ne nf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nv"><img src="../Images/a3119d86aa1f8db8195104b8f971b2b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uriv4u4LgSZfVDIbbHEQrQ.png"/></div></div></figure><p id="cd42" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好多了！图像的新形状是<code class="fe my mz na nb b">(100, 100, 3)</code>——非常适合我们的模型。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="554a" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">在模型中运行</h1><p id="50c7" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">现在我们有了 NumPy 数组，只需简单地将它传递给模型。</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="4e49" class="nk mc jj nb b gy nl nm l nn no">model.predict(cv2_im_new)</span></pre><p id="dd20" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">基于此，用一些手动编码来标注图像的真实世界标签，它们可以被标注在一个标题中:</p><pre class="nc nd ne nf gt ng nb nh ni aw nj bi"><span id="e3d3" class="nk mc jj nb b gy nl nm l nn no">plt.imshow(cv2_im_new)<br/>plt.title('Hand Gesture: '+classification)</span></pre><figure class="nc nd ne nf gt iv gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/6e4d1f5d03547c1e3efc4a500c08b05a.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*CN0OxCoWJQopSukY4ZlYjw.png"/></div></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="916f" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">感谢阅读！</h1><p id="af2f" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">在本教程中，您学习了如何实现一个简单的拍照界面来查看您的机器学习模型的真实应用。</p></div></div>    
</body>
</html>