<html>
<head>
<title>Web Scraping 1: Scraping Table Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Web 抓取 1:抓取表格数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/web-scraping-scraping-table-data-1665b6b2271c?source=collection_archive---------7-----------------------#2020-07-29">https://towardsdatascience.com/web-scraping-scraping-table-data-1665b6b2271c?source=collection_archive---------7-----------------------#2020-07-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="68bf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在这篇文章中，我们将学习如何使用 Python 从 web 上抓取表格数据。简化。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cf671e9e076c51c7ec06b476d80fdeeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nAp0g8cLOJufzfRe"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@kmuza?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卡洛斯·穆扎</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="f3fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">网络搜集是数据收集最重要的概念。在 Python 中，<strong class="lb iu"> BeautifulSoup </strong>、<strong class="lb iu"> Selenium </strong>和<strong class="lb iu"> XPath </strong>是可以用来完成网页抓取任务的最重要的工具。</p><p id="257e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将重点关注 BeautifulSoup 以及如何使用它从<a class="ae ky" href="https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)_per_capita" rel="noopener ugc nofollow" target="_blank">维基百科页面</a>获取 GDP 数据。我们在这个网站上需要的数据是表格的形式。</p><h1 id="132a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">概念的定义</h1><p id="ba67" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">请看下图，然后我们可以继续定义 HTML 表格的组成部分</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/5bfb1e1dbac8232dc2d157c0aa29a78c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6AF9TicW-J8GhLeA3E8eRw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 2</p></figure><p id="c1c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">从上图我们可以推断出如下:</strong></p><p id="4fd0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">标签定义了一个 HTML 表格。</p><p id="ec2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个 HTML 表格由一个<table>元素和一个或多个<tr>、<th>和</th><td>元素组成。</td></tr></table></p><p id="9cff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">元素定义了表格行，<th>元素定义了表格标题，</th><td>元素定义了表格单元格。</td></p><p id="bfb7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个 HTML 表格也可以包括<caption>、</caption><colgroup>、</colgroup><thead>、</thead><tfoot>和</tfoot><tbody>元素。</tbody></p><p id="637f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们感兴趣的是检查给定站点的元素(在这种情况下，是我们想要废弃的站点——图 1 的最右边显示了站点的元素)。在大多数电脑中，你访问网站并点击<strong class="lb iu"> Ctrl+Shift+I </strong>来检查你想要废弃的页面。</p><p id="df22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意:网页的元素通过使用标签上的 class 或 id 选项来识别。id 是唯一的，但类不是。这意味着一个给定的类可以标识多个 web 元素，而一个 id 只能标识一个元素。</strong></p><p id="143c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们看看我们想要刮的网站的图像</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/4823a475815dcf0ba98570611596afd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hvtr1FO0n742aXMZD2BxYg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 3</p></figure><p id="9d80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从该图中，请注意以下几点:</p><ol class=""><li id="3a29" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">这是统一资源定位符(<strong class="lb iu"> URL </strong>)。我们需要这个。</li><li id="f190" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">感兴趣对象的标签元素。该对象由<strong class="lb iu">类</strong>定义，而不是由<strong class="lb iu"> id </strong> : <code class="fe nh ni nj nk b">class = “wikitable sortable jquery”</code>定义。<strong class="lb iu"> </strong>注意，tag 元素包含 3 个标识一个表的类(类之间用空格分隔)。除了我们将在这里使用的站点元素的一般引用外，<strong class="lb iu">类</strong>和<strong class="lb iu">id</strong>被用作支持使用 CSS 等语言的样式的引用。</li><li id="f20b" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">现场共有 3 张桌子，上图中编号为<strong class="lb iu"> 3 </strong>、<strong class="lb iu"> 4 </strong>和<strong class="lb iu"> 5 </strong>。为了这篇文章，我们将通过如何刮表<strong class="lb iu"> 3 </strong>，你可以很容易地找出如何做<strong class="lb iu"> 4 </strong>和<strong class="lb iu"> 5 </strong>。</li><li id="8c37" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">当你在页面中悬停以识别你感兴趣的元素时，标有 6 的按钮非常重要。一旦您感兴趣的对象被突出显示，标签元素也将被突出显示。例如，对于我们的案例，标签<strong class="lb iu"> 2 </strong>与标签<strong class="lb iu"> 3 </strong>相匹配。</li></ol><h1 id="9a9e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">实际刮削</h1><p id="821f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">必需的包:<strong class="lb iu"> bs4，lxml，pandas 和 requests。</strong></p><p id="d679" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦你有了所说的包，我们现在可以通过代码。</p><p id="264a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个代码片段中，我们导入必要的包并解析站点的 HTML 内容。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">片段 1</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="c1ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">检查代码片段 1 中的站点元素和/或<code class="fe nh ni nj nk b">soup</code>变量后，您会发现图 3 中显示的三个表属于同一个类<code class="fe nh ni nj nk b">wikitable</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">片段 2</p></figure><pre class="kj kk kl km gt nn nk no np aw nq bi"><span id="05ab" class="nr lw it nk b gy ns nt l nu nv">OUTPUT: <br/>Number of tables on site:  3</span></pre><p id="c526" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了废弃第一个表，我们只需要从<code class="fe nh ni nj nk b">gdp</code>获得第 0 个索引。下面代码片段中的<code class="fe nh ni nj nk b">body </code>变量包含表格的所有行，包括标题。标题将在<code class="fe nh ni nj nk b">body[0]</code>中，所有其他行将在列表<code class="fe nh ni nj nk b">body[1:]</code>中</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">片段 3</p></figure><pre class="kj kk kl km gt nn nk no np aw nq bi"><span id="0957" class="nr lw it nk b gy ns nt l nu nv">OUTPUT:<br/>['Rank', 'Country/Territory', 'US$']</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="bda3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">标题看起来没错。</p><p id="e814" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要如下循环其余的行</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">片段 4</p></figure><p id="8a81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此时，我们在标题上有了标题，在 all_rows 上有了所有其他行，从这里我们可以将这些数据和标题作为 Pandas 数据帧传递</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nl nm l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/484c62381c4f79d4ed68d2eb8fa3c186.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*HIr6udQwHYLRXKWbX27fWA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 4</p></figure><p id="7af7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/kipronokoech/Web-Scraper/tree/master/gdp-data" rel="noopener ugc nofollow" target="_blank">完整代码</a></p><h1 id="2900" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">警告</h1><p id="2bda" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">网络内容受版权保护，在大多数情况下，版权限制内容的复制、分发、传输和采用。当你打算删除这样一个网站时，你可能需要获得内容所有者的明确许可，否则你未经适当同意的删除行为可能会给你带来违约的麻烦。</p><p id="fe3b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，一些网站在<a class="ae ky" href="https://creativecommons.org/" rel="noopener ugc nofollow" target="_blank">知识共享许可</a>下提供其内容，允许您毫无问题地复制、修改和分发这些内容，尽管一些网站可能对此类内容的商业化提供限制。</p><p id="0862" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">底线是在抓取网页之前，你需要确定你有权利这样做。</p><h1 id="0542" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="7327" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">网络搜集是从网络上收集数据的最重要的工具。要了解更多关于网络抓取的信息，你可以浏览这个包含更多例子的知识库。</p></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><p id="cb8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">加入 https://medium.com/@kiprono_65591/membership<a class="ae ky" href="https://medium.com/@kiprono_65591/membership" rel="noopener">的媒体</a>，全面了解媒体上的每个故事。</p><p id="dc7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你也可以在我发文章的时候通过这个链接把文章发到你的邮箱里:【https://medium.com/subscribe/@kiprono_65591 T4】</p><p id="676d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。</p></div></div>    
</body>
</html>