<html>
<head>
<title>Getting insights about businesses and locations from Google Maps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从谷歌地图获得关于企业和位置的见解</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/getting-insights-about-businesses-and-locations-from-google-maps-3f8a5739059a?source=collection_archive---------14-----------------------#2020-03-02">https://towardsdatascience.com/getting-insights-about-businesses-and-locations-from-google-maps-3f8a5739059a?source=collection_archive---------14-----------------------#2020-03-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="784c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让我们看看如何利用Python和Selenium的能力来挖掘Google Maps中关于感兴趣的企业和位置的数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7f226f29c4e92754b73901c77e6b38e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*13rUxP6QOn6BS9DM5aizmw.png"/></div></div></figure><p id="2879" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">谷歌地图充满了你感兴趣的任何类型的商业或位置的有用数据。在这篇循序渐进的文章中，我将使用<strong class="kw iu"> Python </strong>和<strong class="kw iu"> Selenium </strong>从其中提取关于某个企业(或位置，我们将研究3个主要示例)的数据，然后以快速和自动化的方式对与之非常接近的类似或竞争企业进行同样的操作。</p><p id="a926" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个操作的输出是一个包含有用数据的<strong class="kw iu">数据帧</strong>(名字、商业类型、星级、联系信息、坐标、流行时间等。)我们可以用它来获得关于业务/位置及其周围环境的许多见解。</p><p id="972c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你想了解你的竞争对手的情况，这将是很有用的，但如果你想快速生成某个城市某类企业的列表，这也是很有用的。它还适用于历史地标、公园和各种景点，而不仅仅是企业，我们将在后面的第三个也是最后一个示例中看到。</p><p id="8c39" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以通过在我的<a class="ae lq" href="https://github.com/kelmouloudi/MediumArticle-GoogleMaps" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> GitHub存储库中下载Jupyter笔记本来阅读本文，这里是</strong> </a>、<strong class="kw iu"> </strong>以及CSV格式的提取数据。</p><p id="3674" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><em class="lr"> ps:我不隶属于任何企业。本文中的示例是随机选取的，仅用于说明和教育目的。</em></p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="83e4" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">软件包和设置:</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/1092c6074cc872841b858052f4e26ae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1GT1B1PRh18vNAJD0gYhYA.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">插图作者:明蒂·rawpixel.com</p></figure><p id="4a68" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将需要<a class="ae lq" href="https://pypi.org/project/selenium/" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">Selenium</strong></a>python包来执行数据抓取。如果您还没有它，您可以使用pip: <code class="fe mw mx my mz b">pip install selenium</code>或<code class="fe mw mx my mz b">conda install selenium</code>安装它，如果您使用的是Anaconda发行版的话。</p><p id="8ac8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了与浏览器互动，我们还需要一个<strong class="kw iu">网络驱动</strong>(这里我们将使用Chrome)，所以你必须<a class="ae lq" href="https://chromedriver.chromium.org/downloads" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">到这里并把它</strong> </a>下载到你的机器上(确保它与你当前的Chrome版本兼容) :</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="0e8a" class="ne ma it mz b gy nf ng l nh ni">from selenium import webdriver</span></pre><p id="b476" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们还需要Selenium中几个有用的类。我们将在这里导入它们:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="a283" class="ne ma it mz b gy nf ng l nh ni">from selenium.webdriver.common.by import By<br/>from selenium.webdriver.support.ui import WebDriverWait<br/>from selenium.webdriver.support import expected_conditions as EC<br/>from selenium.webdriver.common.keys import Keys<br/>from selenium.common.exceptions import NoSuchElementException, TimeoutException, ElementNotInteractableException, ElementClickInterceptedException</span></pre><p id="a52f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们来获取<a class="ae lq" href="https://github.com/tqdm/tqdm" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> tqdm </strong> </a>，一个必不可少的进度条python包。估计你的代码的web抓取部分要花多少时间是非常有用的(我用tqdm_notebook是因为我在Jupyter笔记本上工作。在IDEs中你应该做<code class="fe mw mx my mz b">from tqdm import tqdm</code>，然后用<code class="fe mw mx my mz b">tqdm</code>代替<code class="fe mw mx my mz b">tqdmn</code>):</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="c5e8" class="ne ma it mz b gy nf ng l nh ni">from tqdm import tqdm_notebook as tqdmn</span></pre><p id="360a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">除此之外，我们还需要<a class="ae lq" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> Pandas </strong> </a>来读取和操作数据集，以及<a class="ae lq" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> Numpy </strong> </a>来处理空值:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="ae8f" class="ne ma it mz b gy nf ng l nh ni">import pandas as pd<br/>import numpy as np</span></pre><p id="eb09" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">同样，让我们导入<a class="ae lq" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> Matplotlib </strong> </a>和<a class="ae lq" href="https://seaborn.pydata.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> Seaborn </strong> </a>来做数据可视化:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="cd83" class="ne ma it mz b gy nf ng l nh ni">import matplotlib.pyplot as plt<br/>import seaborn as sns</span></pre><p id="41b1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了在地图上显示我们的企业/位置，我们需要<a class="ae lq" href="https://pypi.org/project/folium" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">叶子</strong> </a>。如果没有叶子，使用<code class="fe mw mx my mz b">pip install folium</code>或<code class="fe mw mx my mz b">conda install -c conda-forge folium</code>安装:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="f424" class="ne ma it mz b gy nf ng l nh ni">import folium</span></pre><p id="0c56" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，我们需要内置的python模块<a class="ae lq" href="https://docs.python.org/3/library/time.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> time </strong> </a>和<a class="ae lq" href="http://localhost:8888/notebooks/Desktop/Data%20Science/Getting%20insights%20about%20businesses%20and%20locations%20from%20Google%20Maps.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> re </strong> </a>(第一个模块在元素加载时停止代码一段时间，第二个模块使用<a class="ae lq" href="https://regexr.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> RegEx或正则表达式</strong> </a>从模式的原始文本中提取数据):</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="f9d1" class="ne ma it mz b gy nf ng l nh ni">import time, re</span></pre><p id="b2d7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是可选的，只是为了给我们的数据帧添加一些CSS样式:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="fd31" class="ne ma it mz b gy nf ng l nh ni">%%HTML<br/>&lt;style&gt;.dataframe th,td:first-child{background: rgb(63,87,124);background: linear-gradient(180deg, rgba(63,87,124,1) 0%, rgba(101,124,161,1) 100%, rgba(0,212,255,1) 100%);;<br/>padding: 10px;font-family: monospace;font-size: 110%;color: white;border:1px dashed white;text-align:left !important;<br/>-moz-border-radius: 3x;-webkit-border-radius: 3px;}.dataframe thead{border:none; !important;}&lt;/style&gt;</span></pre></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="605f" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">澳大利亚布里斯班的打印店:</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/28215a19491a47d7d7cb0dcfaabe078b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XyTDQ3OHo95HYzRq8Kbvvg.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">图片由布拉德·斯克鲁斯——Flickr.com(CC)拍摄</p></figure><p id="fae1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Ryan是一名获得印刷行业管理文凭的应届毕业生，他正在澳大利亚布里斯班找工作。他刚刚把他的简历送到了打印店<strong class="kw iu"> Kwik Kopy Brisbane </strong>(因为它碰巧离他家最近)。他还能在城市的什么地方找到合适的工作？让我们帮帮莱恩。</p><p id="3eb1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们要做的第一件事是去谷歌地图搜索该企业的名称，或者我们可以在浏览器地址栏的<code class="fe mw mx my mz b">www.google.com/maps/search/</code>后添加名称。然后，如果我们单击业务类别，这里是<code class="fe mw mx my mz b">Print shop</code>(见下图)，我们将获得不同打印相关业务的列表。我们航行的时间越长，就离我们最初的打印店越远:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/dacf9d1344bc1d96bd8cea5f31761327.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xi7j0u6sMqiwR-aQWGXTeQ.png"/></div></div></figure><p id="9e74" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在编写为我们进行网络搜集的代码之前，让我们先列出我们将经历的所有步骤:</p><p id="81ac" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> 1。绕场比赛</strong>:</p><ul class=""><li id="5767" class="nl nm it kw b kx ky la lb ld nn lh no ll np lp nq nr ns nt bi translated">答:取我们公司的名字，加在<code class="fe mw mx my mz b">www.google.com/maps/search/</code>之后，然后访问那个网址</li><li id="1c05" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">b:点击业务类别</li><li id="e208" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">c:获取参赛者的姓名和地址，然后点击下一步按钮<code class="fe mw mx my mz b">&gt;</code>。我们反复这样做，直到我们对有多少竞争者感到满意。这一步的输出是一个竞争对手的列表(名字和地址)，让我们把它命名为<code class="fe mw mx my mz b">competition</code>(名字本身不足以唯一地标识一个企业，这就是为什么我们还要捕获地址)</li></ul><p id="b8e5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> 2。提取数据</strong>:</p><ul class=""><li id="bbe3" class="nl nm it kw b kx ky la lb ld nn lh no ll np lp nq nr ns nt bi translated">d:获取<code class="fe mw mx my mz b">competition</code>的第一个元素并将其添加到<code class="fe mw mx my mz b">www.google.com/maps/search/</code>之后，然后访问该URL</li><li id="f227" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">e:提取名称、业务类别、平均评级、评论总数、地址、电话号码和网站，然后从<code class="fe mw mx my mz b">competition</code>开始使用另一个元素再次循环到步骤D，直到结束。</li></ul><p id="535b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是这样做的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="450c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">执行这段代码后，您将看到一个Chrome窗口打开，我们之前概述的步骤会自动一个接一个地执行。有时，<strong class="kw iu">谷歌地图会将一个企业名称/地址与另一个</strong>混淆，并给你一个选择:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/db9db3d187d039c38f7a9508cd7387e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YaesBu3xvYz-gVzt1rWAIg.png"/></div></div></figure><p id="1ab8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">出现这种情况时，只需在搜索栏中点击最接近查询的业务，代码就会正常继续。你也可以忽略它，由于有了<code class="fe mw mx my mz b">try</code>和<code class="fe mw mx my mz b">except</code>模块，代码会在25秒后自动跳到<code class="fe mw mx my mz b">competition</code>中的下一次迭代。</p><p id="1487" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果一切按计划进行，让我们用提取的列表制作一个熊猫数据框架。姑且称之为<code class="fe mw mx my mz b">PS</code>打印店:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="644b" class="ne ma it mz b gy nf ng l nh ni">PS = pd.DataFrame(data={'full_name':full_name, 'rating':rating, 'total_ratings':total_ratings, 'business_category':business_cat, 'address':address, 'phone':phone, 'website':website, 'latitude':lat, 'longitude':long})</span></pre><p id="6104" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是我们的数据框架，包含Kwik Kopy和大约100家竞争对手的信息:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/407a7df3207ee7d751bc6271acff8d62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N84dGGyKratzceMWB5rPoQ.png"/></div></div></figure><p id="44b5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">此时，最好将该数据帧保存为CSV文件以便安全保存:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="12fe" class="ne ma it mz b gy nf ng l nh ni">PS.to_csv('print_shops.csv', index=False)</span></pre><p id="89d1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下次我们打开笔记本时，我们所要做的就是读取CSV文件，而不是再次运行web抓取代码:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="1775" class="ne ma it mz b gy nf ng l nh ni">PS = pd.read_csv('print_shops.csv')</span></pre><p id="caf8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">经过一些数据清理和准备(见<a class="ae lq" href="https://github.com/kelmouloudi/MediumArticle-GoogleMaps" rel="noopener ugc nofollow" target="_blank"> Jupyter笔记本</a>)，我们最终得到了84个不同的企业，Ryan在找工作时可以考虑。还不错！但是它们在城市中有多分散呢？要回答这个问题，让我们将它们绘制出来，并在单击标记时显示的弹出窗口中添加它们的信息:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/412f78fb616559313caebaba1b018c45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wEvy5LaHIXI_vatEv65OCg.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">你可以在这里下载这个HTML格式的地图:<a class="ae lq" href="https://github.com/kelmouloudi/MediumArticle-GoogleMaps" rel="noopener ugc nofollow" target="_blank"> ps_map.html </a></p></figure><p id="4d09" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，这看起来更像是一个求职冒险的路线图！瑞安可以开始联系离他家最近的企业，如果需要的话，可以向外扩展。</p><p id="9c9d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这个用例中，平均评级和评级总数对Ryan来说意义不大。在下一个例子中，我们将探索这两个变量更重要的行业:我们将在生机勃勃的格拉斯哥寻找最好的牛排馆。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="c163" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">苏格兰格拉斯哥的牛排馆:</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/9677f49a4e9acd76f57aa610cff8aea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bE9HTA8wy3I08IQ_vL2iOQ.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">戴夫·谢伊——Flickr.com(CC)摄影</p></figure><p id="098c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Moira想请她的男朋友吃一顿美味的牛排晚餐作为生日礼物，但她不知道具体去哪里。她在一个专门的博客上搜索，发现<strong class="kw iu">迷你烧烤牛排店</strong>是格拉斯哥最好的牛排店之一。让我们帮助Moira决定哪家牛排馆最适合这个场合，因为她认为好的葡萄酒(或鸡尾酒)和音乐是美好体验的必备条件。</p><p id="9e11" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将遵循与之前完全相同的步骤，除了添加两种新类型的有用信息:<strong class="kw iu">价格范围</strong>(从<code class="fe mw mx my mz b">$</code>到<code class="fe mw mx my mz b">$$$$</code>)和<strong class="kw iu">评论主题</strong>(数字指有多少评论谈到了该主题) :</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/4866bb31e78ce769dc43af3ef4d39c63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U3J00b0KVACpAFvdHGTMOg.png"/></div></div></figure><p id="f18e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下面是我们将使用的代码(有时谷歌地图根本不显示评论主题。如果发生这种情况，只需关闭Chrome窗口，停止代码并再次重新运行单元格) :</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="009b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在让我们用提取的列表制作一个数据框架。我们将它命名为<code class="fe mw mx my mz b">SH</code>牛排餐厅:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="bfcd" class="ne ma it mz b gy nf ng l nh ni">SH = pd.DataFrame(data={'full_name':full_name, 'rating':rating, 'total_ratings':total_ratings, 'business_category':business_cat, 'price_range':price_range, 'address':address, 'phone':phone, 'website':website, 'review_topics':review_topics, 'latitude':lat, 'longitude':long})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/5ace3e85199a566390c7f7616d33eb21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oRB2loyA0udQqmB5TabFKw.png"/></div></div></figure><p id="1f00" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们来看看我们得到的业务类别:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="9b2b" class="ne ma it mz b gy nf ng l nh ni">SH.business_category.value_counts()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/1ab816343934d01cd34b459590abbc17.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*w5hKs9f5yU6pLhDjoJqYaQ.png"/></div></figure><p id="7b82" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们希望只保留那些名称中带有“牛排”或“烧烤”字样的、<strong class="kw iu">酒吧、&amp;烧烤店、<strong class="kw iu">餐馆。让我们称这个新的数据框架<code class="fe mw mx my mz b">SBR</code>(用于牛排店、酒吧&amp;烧烤店和餐馆) :</strong></strong></p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="52e3" class="ne ma it mz b gy nf ng l nh ni">steak_houses = SH[SH.business_category == 'Steak house']<br/>bar_grills  = SH[SH.business_category == 'Bar &amp; grill']<br/>restaurants  = SH[(SH.business_category.str.contains('Restaurant', case=False)) &amp; (SH.full_name.str.contains('steak|grill', case=False, regex=True))]</span><span id="a1f9" class="ne ma it mz b gy oh ng l nh ni">SBR = pd.concat([steak_houses, bar_grills, restaurants])</span></pre><p id="897c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就让出了47个名额。现在让我们帮助Moira从这些高级餐厅中挑选最划算的。如果你还记得的话，莫伊拉想要一次享受美酒、鸡尾酒和音乐的美好经历。让我们来看看有一个或多个这些要求的地方的<code class="fe mw mx my mz b">review_topics</code>:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="665a" class="ne ma it mz b gy nf ng l nh ni">list(SBR[SBR.review_topics.str.contains('\Wwine|cocktail|music', case=False, regex=True)].review_topics)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/be27d4771986fde433263441238a00ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Afc45Am0fAKP1scWwDWV0A.png"/></div></div></figure><p id="108d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">正如我们在上面看到的，16个不同的地方至少有3个关键词中的一个。为了能够做出选择，让我们添加3个新列<code class="fe mw mx my mz b">wine</code>、<code class="fe mw mx my mz b">cocktails</code>和<code class="fe mw mx my mz b">music</code>，包含这些关键词被评论提及的次数(这是在提取的<code class="fe mw mx my mz b">review_topics</code>中位于<code class="fe mw mx my mz b">\\n</code>之后的数字)。我们没有统计这些词被提到了多少)。我们将使用RegEx提取我们想要的信息:首先我们用<code class="fe mw mx my mz b">wine......|$</code>提取部分<code class="fe mw mx my mz b">'wine\\n8'</code>，然后我们用<code class="fe mw mx my mz b">\d+|$</code>提取数字。如果模式不存在，这里确保我们得到一个空值:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="5b28" class="ne ma it mz b gy nf ng l nh ni">wine = []<br/>for i in SBR.review_topics :<br/>    wine.append(re.findall('\d+|$', re.findall('wine......|$', i)[0])[0] )</span><span id="6022" class="ne ma it mz b gy oh ng l nh ni">SBR['wine'] = wine</span><span id="2253" class="ne ma it mz b gy oh ng l nh ni">cocktail = []<br/>for i in SBR.review_topics :<br/>    cocktail.append(re.findall('\d+|$', re.findall('cocktail......|$', i)[0])[0] )</span><span id="5409" class="ne ma it mz b gy oh ng l nh ni">SBR['cocktail'] = cocktail</span><span id="9b57" class="ne ma it mz b gy oh ng l nh ni">music = []<br/>for i in SBR.review_topics :<br/>    music.append(re.findall('\d+|$', re.findall('music......|$', i)[0])[0] )</span><span id="8ac0" class="ne ma it mz b gy oh ng l nh ni">SBR['music'] = music</span></pre><p id="c989" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">3个新列<code class="fe mw mx my mz b">wine</code>、<code class="fe mw mx my mz b">cocktail</code>和<code class="fe mw mx my mz b">music</code>是字符串类型。让我们将它们转换成数值(但在此之前，让我们用0替换空值) :</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="2a84" class="ne ma it mz b gy nf ng l nh ni">SBR.wine = SBR.wine.replace('', 0)<br/>SBR.cocktail = SBR.cocktail.replace('', 0)<br/>SBR.music = SBR.music.replace('', 0)</span><span id="ab11" class="ne ma it mz b gy oh ng l nh ni">SBR.wine = SBR.wine.astype(int)<br/>SBR.cocktail = SBR.cocktail.astype(int)<br/>SBR.music = SBR.music.astype(int)</span></pre><p id="c40d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在让我们添加一个名为<code class="fe mw mx my mz b">score</code>的新列，它是三个新变量<code class="fe mw mx my mz b">wine</code>、<code class="fe mw mx my mz b">cocktail</code>和<code class="fe mw mx my mz b">music</code>的总和:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="89a4" class="ne ma it mz b gy nf ng l nh ni">SBR['score'] = SBR.wine + SBR.cocktail + SBR.music</span></pre><p id="d982" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在让我们按<code class="fe mw mx my mz b">score</code>对<code class="fe mw mx my mz b">SBR</code>数据框进行分类，假设机构满足这两个条件:</p><ul class=""><li id="bead" class="nl nm it kw b kx ky la lb ld nn lh no ll np lp nq nr ns nt bi translated"><code class="fe mw mx my mz b">wine</code>和<code class="fe mw mx my mz b">cocktails</code>中至少有一个不为空</li><li id="7551" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">对于<code class="fe mw mx my mz b">music</code>，它没有空值</li></ul><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="18c3" class="ne ma it mz b gy nf ng l nh ni">SBR[((SBR.wine != 0)|(SBR.cocktail != 0)) &amp; (SBR.music != 0)].sort_values(by='score', ascending=False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/4ce5683c2bc6422d78e7e95a87f7be77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2mbrvEJwcDKNeuKe6ClW4w.png"/></div></div></figure><p id="8a6e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">范围缩小到两个地方了！这对莫伊拉来说已经足够了，但是不行！她希望有一种方法来设想所有的选择，以便做出一个好的选择。好吧，莫伊拉，如你所愿！</p><p id="8239" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们将变量<code class="fe mw mx my mz b">rating</code>(代表平均升值幅度)<code class="fe mw mx my mz b">total_ratings</code>(表示受欢迎程度)和<code class="fe mw mx my mz b">price_range</code>(表示一个地方的可负担程度)考虑在内，并将<code class="fe mw mx my mz b">SBR</code>中的所有机构绘制在一个网格上。</p><p id="66e6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">但在此之前，我们需要删除<code class="fe mw mx my mz b">total_ratings</code>中的括号和逗号，将系列转换为数字，并将<code class="fe mw mx my mz b">price_range</code>中的美元符号改为更有意义的符号(美元符号出于某种原因会导致错误) :</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="e523" class="ne ma it mz b gy nf ng l nh ni">SBR.total_ratings = SBR.total_ratings.replace('(\(|\)|,)', '', regex=True)</span><span id="f995" class="ne ma it mz b gy oh ng l nh ni">SBR.total_ratings = SBR.total_ratings.astype(int)</span><span id="c459" class="ne ma it mz b gy oh ng l nh ni">SBR.price_range = SBR.price_range.replace({'$$':'Affordable', '$$$':'Pricy' })</span></pre><p id="91b9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在是网格。我们将使用一个散点图，X轴是<code class="fe mw mx my mz b">total_ratings</code>，Y轴是<code class="fe mw mx my mz b">rating</code>。颜色会根据<code class="fe mw mx my mz b">price_range</code>变化。我还添加了注释，以显示牛排馆<strong class="kw iu">、【迷你烧烤牛排馆】(MG) </strong>(博客推荐)的位置，以及获得良好评分的两个地方，<strong class="kw iu">、【肉吧】(MB) </strong>和<strong class="kw iu">、【生活格拉斯哥】(LG) </strong>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/152af4f9a8cf9fcaf4b964cb53f991e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yMxGhRHtwhCe2ncq0UZXrg.png"/></div></div></figure><p id="be18" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">结果是，博客推荐的“迷你烧烤牛排屋”(Mini Grill steak house)(MG)(T13)在平均评分方面表现异常出色，但在对Moira最重要的东西(饮料和音乐)方面得分很低。<strong class="kw iu">“肉吧”(MB) </strong>另一方面得分很高(33)，在受欢迎程度和平均评分方面仅略低于<strong class="kw iu"> MG </strong>。</p><p id="f620" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">莫伊拉现在很满意，她已经下定决心了。希望现在打电话预订还不算太晚！</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="ca4e" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">意大利罗马的历史地标:</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/145ac6dcf7926187bfa817b5da98c747.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qmA7xrugkCplPnwGA98wsg.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">sbmeaper 1——Flickr.com的照片(公共领域)</p></figure><p id="5b13" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">安东尼奥是一名高中历史老师。他计划和他的一群学生去意大利首都罗马进行为期三天的实地考察，参观那里最受欢迎的历史地标。然而，他知道每年的这个时候罗马都挤满了游客，他主要关心的是在参观某些地点时避免排长队和拥挤的人群，尤其是在<strong class="kw iu">高峰时段</strong>。这就是为什么我们要帮助他安排他的访问，以确保他的学生最大程度的舒适。</p><p id="1104" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">和往常一样，我们将使用我们的代码从谷歌地图中抓取有用的信息。这一次，我们将增加一种新的信息:<strong class="kw iu">流行次数</strong>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/01ef459b84bf01cff9766ec47e65a17b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O0LaiQ7f_OF0E7QSRmamqQ.png"/></div></div></figure><p id="7cc6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当你访问<strong class="kw iu">万神殿</strong>的页面时，谷歌地图会显示上图(一个以前的大寺庙，现在是罗马的教堂)。根据谷歌地图:<strong class="kw iu">“在流行时间图上，任何给定小时的流行度相对于该企业一周的典型峰值流行度来显示”</strong>。因此，周六下午4点参观万神殿是一个非常糟糕的主意，因为这是一周中最繁忙的时间(因此属性<code class="fe mw mx my mz b">aria-label</code>的值为100%)。</p><p id="8475" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这种情况下，我们不会搜索特定的地方。我们将简单地在谷歌地图上搜索<strong class="kw iu">【罗马旅游景点】</strong>(尽量宽泛)。现在让我们运行我们的代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="bc8f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">完成后，让我们用提取的列表制作一个数据框架。我们称之为<code class="fe mw mx my mz b">HL</code>历史地标:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="d7eb" class="ne ma it mz b gy nf ng l nh ni">HL = pd.DataFrame(data={'full_name':full_name, 'rating':rating, 'total_ratings':total_ratings, 'landmark_category':landmark_cat, 'description':description, 'address':address, 'hours':hours})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/969dc1a77caec62fa9d2d49b817f1006.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p58VEvOSZYuyYrIkUkGvDA.png"/></div></div></figure><p id="0d11" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">像往常一样，让我们保存这个数据帧:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="b57d" class="ne ma it mz b gy nf ng l nh ni">HL.to_csv('historical_landmarks.csv', index=False)</span></pre><p id="3030" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">打开它:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="7d2b" class="ne ma it mz b gy nf ng l nh ni">HL = pd.read_csv('historical_landmarks.csv')</span></pre><p id="1e25" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你记得的话，安东尼奥希望团队只参观最受欢迎的景点，因为行程只有3天。为了从<code class="fe mw mx my mz b">HL</code>中选择10个最受欢迎的历史地标，我们需要将<code class="fe mw mx my mz b">total_ratings</code>转换成一个数字向量:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="2bb5" class="ne ma it mz b gy nf ng l nh ni">HL.total_ratings = HL.total_ratings.replace('\(|\)|,', '', regex=True)</span><span id="07a6" class="ne ma it mz b gy oh ng l nh ni">HL.total_ratings = HL.total_ratings.astype(float)</span></pre><p id="1b6f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们制作一个新的数据框架<code class="fe mw mx my mz b">HL10</code>，包含来自<code class="fe mw mx my mz b">HL</code>的最受欢迎的城市:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="d5cb" class="ne ma it mz b gy nf ng l nh ni">HL10 = HL.sort_values(by='total_ratings', ascending=False).head(10).copy()</span><span id="0049" class="ne ma it mz b gy oh ng l nh ni">HL10</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/6b8a19f85b6c08fe755309835134b012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3KD6DG4tX1sx3FYEdZ1mjw.png"/></div></div><p class="ms mt gj gh gi mu mv bd b be z dk translated">我们选择的罗马十大最受欢迎的景点(您的结果可能会有所不同)</p></figure><p id="81b4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们主要关心的是在游览这些热门目的地时避开高峰时间。例如，让我们看看变量<code class="fe mw mx my mz b">hours</code>在罗马竞技场中是什么样子的:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="2bd9" class="ne ma it mz b gy nf ng l nh ni">str(list(HL10[HL10.full_name == 'Colosseum'].hours))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/98dfb2295fca6df031afc563cd14c6a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gR4pAIO9t-WZjX07zMiUmw.png"/></div></div></figure><p id="4b76" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我们的<code class="fe mw mx my mz b">HL10</code>数据帧中，<code class="fe mw mx my mz b">hours</code>是一个列表，描述了7天内(从周日到周六)任何一个小时(从早上6点到晚上11点)有多忙。为了使分析更容易，我们将为<code class="fe mw mx my mz b">HL10</code>中的8个位置中的每一个位置创建一个新的空数据帧，以天为索引，以小时为列。为此，我们将使用这个自定义函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="d1cf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们用<strong class="kw iu">斗兽场</strong>来测试一下:</p><pre class="kj kk kl km gt na mz nb nc aw nd bi"><span id="70f5" class="ne ma it mz b gy nf ng l nh ni">colosseum = visit_planner('Colosseum')<br/>colosseum</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/7580246b06ed432d9198ea04d6cbff76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1y8UeWL858vWwPy5mHcAJA.png"/></div></div></figure><p id="4836" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在让我们用相应的值填充<code class="fe mw mx my mz b">10 AM</code>列。我们将在这里使用正则表达式:首先，我们捕获字符串<code class="fe mw mx my mz b">***% busy at 10 AM</code>，然后我们使用<code class="fe mw mx my mz b">\d+</code>捕获其中的数字，由于这里有2个数字(百分比和10)，我们使用索引<code class="fe mw mx my mz b">[0]</code>选择第一个数字。最后，我们将向量转换为整数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/41b3016484d373b8af876b7c37258833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kKcooVqJo2pU2E8du1aAHg.png"/></div></div></figure><p id="7e3d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">成功了！让我们将相同的代码应用于循环中的所有时间:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/17f797f4332ffb657486d059f6cff585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XNJmoRyiWN0HydiRtsCs8g.png"/></div></div></figure><p id="377f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在让我们在热图上显示这些数据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/23e7a783718f394952d25a9b00e501cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k3M7oh3N-kyFOfof0qtSTA.png"/></div></div></figure><p id="926e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们认为大约50%的比率对团队来说已经足够舒适(其人口是一周中最繁忙时间的一半),并且我们需要至少2个小时才能参观完一个地方，那么参观罗马圆形大剧场的最佳日期和时间是:</p><ul class=""><li id="0445" class="nl nm it kw b kx ky la lb ld nn lh no ll np lp nq nr ns nt bi translated"><strong class="kw iu">星期三</strong>一天中的任何时间</li><li id="46d9" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated"><strong class="kw iu">周一</strong>、<strong class="kw iu">周二</strong>和<strong class="kw iu">周四</strong>上午<strong class="kw iu">8点到11点</strong>和下午<strong class="kw iu">2点到7点</strong></li><li id="05b4" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated"><strong class="kw iu">周五</strong>和<strong class="kw iu">周末</strong>但仅从<strong class="kw iu">下午4点到6点</strong></li><li id="c2bc" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">避开周末，尤其是从上午11点到下午2点(T42)</li></ul><p id="47f5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们在另一个地方尝试同样的事情，那就是<strong class="kw iu">梵蒂冈博物馆</strong>。在这种情况下，事情有点不同，因为<strong class="kw iu">这个地方在周日</strong>关闭，我们用于两个预览地方的方法将不起作用，除非我们将周日行从数据框中删除:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/ac3db9089e4c38b734c16bb057f88fe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kDfTgPBVleOcKvecGZX_ow.png"/></div></div></figure><p id="c78f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，这是一个很难安排的时间，因为我们只有7个小时的访问时间，从上午9点到下午4点。所以，参观梵蒂冈博物馆的最佳日子和时间是:</p><ul class=""><li id="15a3" class="nl nm it kw b kx ky la lb ld nn lh no ll np lp nq nr ns nt bi translated"><strong class="kw iu">周三</strong>全天</li><li id="1f33" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated"><strong class="kw iu">周二</strong>下午<strong class="kw iu">2点到4点</strong>和周四<strong class="kw iu">上午<strong class="kw iu">9点到11点</strong>和下午<strong class="kw iu">2点到4点</strong></strong></li><li id="7972" class="nl nm it kw b kx nu la nv ld nw lh nx ll ny lp nq nr ns nt bi translated">周一<strong class="kw iu">、<strong class="kw iu">周五</strong>和<strong class="kw iu">周六</strong>要避开</strong></li></ul><p id="e7d4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">安东尼奥对这一新获得的信息很满意。这将有助于他计划这次访问，最大限度地利用他与学生在欧洲最具历史意义的城市之一度过的三天时间。</p><p id="c860" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意:如果你想为一个地方做一个热图，你得到了错误<code class="fe mw mx my mz b">Length of values does not match length of index</code>，确保那个地方的<code class="fe mw mx my mz b">hours</code>列表有从早上6点到晚上11点的所有时间(总共18个，重复7次，总共126个元素)。如果缺少一个或多个，请尝试再次运行web抓取代码。</p><p id="15f5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您有任何意见或问题，请随时在这里或LinkedIn上给我发消息。我很乐意回答。</p></div></div>    
</body>
</html>