<html>
<head>
<title>Insurance Risk Pricing — Tweedie Approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">保险风险定价——特威迪方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/insurance-risk-pricing-tweedie-approach-1d71207268fc?source=collection_archive---------6-----------------------#2020-04-20">https://towardsdatascience.com/insurance-risk-pricing-tweedie-approach-1d71207268fc?source=collection_archive---------6-----------------------#2020-04-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="79d3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在GLMs和机器学习中使用Tweedie模型估计纯保费的说明性指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/798dab2c2663e03211e2bc5156010c58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*86MFunZoy0P1c962Dw5UsA.png"/></div></figure><h1 id="73e5" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">背景</h1><p id="f831" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">保险业是一个独特的行业，可能是为数不多的不知道销售产品实际成本的行业之一，他们处理不可预见事件的风险。因此，在过去的几个世纪里，该行业一直依靠数学来理解其客户和前景的风险行为，以估计预期损失成本。当然，方法已经从帕斯卡三角、概率应用、最小偏差程序发展到广义线性模型，以及现在的机器学习。</p><h1 id="e3e1" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">目标</h1><p id="85c5" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们已经在之前的文章中详细讨论了<a class="ae me" href="https://medium.com/swlh/modeling-insurance-claim-frequency-a776f3bf41dc" rel="noopener">计数</a>模型(用于索赔频率)和<a class="ae me" href="https://medium.com/swlh/modeling-insurance-claim-severity-b449ac426c23" rel="noopener">伽玛</a>模型(用于索赔严重度)。纯保费，也称为“损失成本”，只是两个模型估计的产品。</p><blockquote class="mf mg mh"><p id="19cc" class="li lj mi lk b ll mj ju ln lo mk jx lq ml mm lt lu mn mo lx ly mp mq mb mc md im bi translated">索赔频率=索赔次数/风险</p><p id="8d51" class="li lj mi lk b ll mj ju ln lo mk jx lq ml mm lt lu mn mo lx ly mp mq mb mc md im bi translated">索赔严重程度=索赔成本/索赔次数</p><p id="a49d" class="li lj mi lk b ll mj ju ln lo mk jx lq ml mm lt lu mn mo lx ly mp mq mb mc md im bi translated">损失成本=索赔频率x索赔严重程度</p></blockquote><p id="0541" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi mr translated"><span class="l ms mt mu bm mv mw mx my mz di">在当前的文章中，我们将讨论一种非常重要和有趣的分布，称为Tweedie，这种分布很有趣，因为它通过改变单个参数，提供了从高斯到逆高斯的许多其他分布。</span></p><p id="d91c" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">这种分布将有助于我们直接建模纯保费，而不需要两个不同的模型。</p><h1 id="71f0" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">特威迪分布</h1><p id="9ff2" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Tweedie分布是指数分散模型的一种特殊情况，通常用作广义线性模型的分布。它可以有一组为零的数据项，这种特殊的属性使它在保险业的索赔建模中非常有用。该模型还可以应用于其他行业的用例，在这些用例中，您会发现零和非负连续数据点的混合。</p><p id="cf24" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">如果你看到下图中峰值为零的直方图，它可能适合Tweedie模型。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/740f6f6d15f10552227a4ee119aa0351.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*7zgUbwL_MPhEEJ8Ad11USA.png"/></div></figure><h2 id="ec78" class="nb kr it bd ks nc nd dn kw ne nf dp la lr ng nh lc lv ni nj le lz nk nl lg nm bi translated">这一系列分布具有以下特征</h2><blockquote class="mf mg mh"><p id="0d51" class="li lj mi lk b ll mj ju ln lo mk jx lq ml mm lt lu mn mo lx ly mp mq mb mc md im bi translated">平均值，E(Y)= 1</p><p id="a606" class="li lj mi lk b ll mj ju ln lo mk jx lq ml mm lt lu mn mo lx ly mp mq mb mc md im bi translated">方差，Var(Y)= ϕ ᵖ</p></blockquote><p id="9644" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">我们用这个表达式“Y ~ Twₚ( ,ϕ”来理解吧，其中y表示响应变量，Twₚ( ,ϕ)表示一个Tweedie随机变量，具有均值和方差ϕ ᵖ和ϕ&gt;0，p ∈ (-∞，0]∩[1，∞)。</p><p id="71b7" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">方差函数中的p是分布的附加形状参数。</p><p id="2709" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated"><em class="mi">需要注意的重要一点是，这种分布不是针对0到1之间的p值定义的。</em></p><ul class=""><li id="2639" class="nn no it lk b ll mj lo mk lr np lv nq lz nr md ns nt nu nv bi translated">如果1 &lt; p &lt;2, the distribution are continuous for Y&gt; 0，正质量为Y=0</li><li id="6f79" class="nn no it lk b ll nw lo nx lr ny lv nz lz oa md ns nt nu nv bi translated">如果p &gt; 2，对于Y &gt; 0，分布是连续的</li></ul><p id="1a9c" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">让我们看看Tweedie分布族的一些常用成员及其指数参数(p)、方差函数(V())和离差(<em class="mi"> ф </em>)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/1505d6e77336ccacc11453cd0be2d3ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*wmxej2LK5kFlkF9bzQ4rww.png"/></div><p class="oc od gj gh gi oe of bd b be z dk translated">指数离差模型</p></figure><p id="0385" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">一个分布能够拟合许多其他分布。设置p = 0表示正态分布，p = 1表示泊松分布，p = 2表示伽马分布，p = 3表示逆高斯分布。</p><h2 id="4c77" class="nb kr it bd ks nc nd dn kw ne nf dp la lr ng nh lc lv ni nj le lz nk nl lg nm bi translated">参数从一种形式转换到另一种形式。</h2><p id="0760" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们知道Tweedie是一种复合泊松-伽马分布，其中N ~泊松(λ)为计数，Z ~伽马(α，θ)为连续数，在这种情况下，参数可以很容易地转换为Tweedie参数，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/35d1fe463a875287523c8362a695265b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*RjILBDXERCunzWA6o1LUBg.png"/></div><p class="oc od gj gh gi oe of bd b be z dk translated">泊松-伽马到特威迪</p></figure><p id="9f59" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated"><em class="mi">方差也可以平移— Var[Y] = ϕ ᵖ =λ⋅θ ⋅α (α+1) </em></p><p id="76b2" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">类似地，Tweedie参数也可以转换为泊松和伽马参数，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/872e23afb74868d960c5f44860ce42b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*VCeKE0psmwoqoVt4bA8SqQ.png"/></div><p class="oc od gj gh gi oe of bd b be z dk translated">特威迪呼叫波松伽玛</p></figure><p id="f44e" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">现在，我们对这种有趣的分布及其与近亲如泊松和伽马的关系有了一些了解。</p><h1 id="a040" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">接下来，我们将使用一个数据集并检查该分布的适用性。</h1><p id="6486" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">回想一下我们在以前的文章中使用的保险数据集。我们希望Tweedie分布是该数据集的理想候选，让我们研究该数据以证实我们的假设。</p><p id="cd36" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">这个数据集(dataCar)可以从一个名为“insuranceData”的R包中下载。</p><pre class="kj kk kl km gt oi oj ok ol aw om bi"><span id="7070" class="nb kr it oj b gy on oo l op oq">library(insuranceData)<br/>data(dataCar)</span></pre><h2 id="83b6" class="nb kr it bd ks nc nd dn kw ne nf dp la lr ng nh lc lv ni nj le lz nk nl lg nm bi translated">数据集的简要概述</h2><p id="25e1" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">该数据集基于2004年或2005年购买的一年期车辆保险。共有67，856份保单，其中4，624份(6.8%的通知索赔)提出了索赔。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/e8fcce7f557e87044857f96bf31b1cfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*-zhlDi22dSnbu1yxzmsoeQ.png"/></div><p class="oc od gj gh gi oe of bd b be z dk translated">数据快照</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/3b7cd8bb6d9125bc4d2530ff8bd30001.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*CNA2AWhkkt1T6FRZ2Vlpog.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/964b15fb96075870f3b50df76f0889d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*bfH4HGqFhaymx8wZ-qaDDg.png"/></div></figure><p id="e752" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">只有7%的观察值具有响应变量的正值，其余的值为零。让我们独立地看一下索赔计数和成本的分布。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ov ow di ox bf oy"><div class="gh gi ou"><img src="../Images/1251978d04ea58e23bdca453f396c855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sNfqq7x_b3sN-s8poy4y6g.png"/></div></div></figure><p id="ecc8" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">正如我们在上面看到的</p><ul class=""><li id="1340" class="nn no it lk b ll mj lo mk lr np lv nq lz nr md ns nt nu nv bi translated">损失成本=索赔频率x索赔严重程度</li></ul><p id="d2f0" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">让我们用原始变量来重写</p><ul class=""><li id="5779" class="nn no it lk b ll mj lo mk lr np lv nq lz nr md ns nt nu nv bi translated">损失成本=索赔成本/风险</li></ul><p id="c401" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated"><strong class="lk iu">响应变量</strong> —我们将使用“索赔成本”作为响应变量，将“风险敞口”作为<a class="ae me" rel="noopener" target="_blank" href="/offsetting-the-model-logic-to-implementation-7e333bc25798">补偿</a>，这是一种建议的费率和平均值建模方法。</p><p id="bd49" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">我们来看看这个变量的分布。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ov ow di ox bf oy"><div class="gh gi oz"><img src="../Images/47f710ebf5052d9c14f1641dc82ae0e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O5-I2OhemrTFicXWTRpHsA.png"/></div></div></figure><p id="1ebb" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">我们可以看到这个数据不能符合正态分布，泊松也可以被丢弃，因为这不是一个计数数据。另一个选择是伽玛，但是这个分布不取零值。因此，最后，我们只剩下特威迪分布，它可能最适合这个数据。</p><p id="3a9b" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">现在，看看独立变量。对于这些变量的详细探索性分析和转换，您可以参考与本文一起分享的源代码。</p><p id="434e" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated"><strong class="lk iu">独立变量</strong> —我们将使用车身、车龄、驾驶员年龄类别、性别、面积和车辆价值作为预测变量。索赔发生指标和索赔数量不能使用，因为它们与因变量有关，只能在事件发生后才知道。</p><p id="ce7b" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated"><strong class="lk iu">衍生变量和转换</strong>——可以对低频率的车身类型进行分组，也为车辆价值创建了一个替代分类变量，可以对其进行显著性测试。</p><h2 id="ffd5" class="nb kr it bd ks nc nd dn kw ne nf dp la lr ng nh lc lv ni nj le lz nk nl lg nm bi translated">为Tweedie模型选择最佳“p”</h2><p id="784f" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">基于这种探索性分析，我们可以确定Tweedie分布是拟合模型的理想候选，但我们尚未找到“p”的最佳值，我们知道该值在1到2之间变化。</p><p id="e27d" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">方法1 —手动选择方差幂。</p><ul class=""><li id="760d" class="nn no it lk b ll mj lo mk lr np lv nq lz nr md ns nt nu nv bi translated">通过运行迭代模型来测试1到2之间的“p”序列。</li><li id="7082" class="nn no it lk b ll nw lo nx lr ny lv nz lz oa md ns nt nu nv bi translated">对数似然显示出一个倒“U”形。</li><li id="427b" class="nn no it lk b ll nw lo nx lr ny lv nz lz oa md ns nt nu nv bi translated">选择对应于“最大”对数似然值的“p”。</li><li id="6efd" class="nn no it lk b ll nw lo nx lr ny lv nz lz oa md ns nt nu nv bi translated">使用该“p”值拟合最终模型。</li></ul><p id="cc1d" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">方法2——使用统计包自动选择方差功率</p><p id="b47b" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">统计软件包(宏)在各种软件中可用，如R、SAS、Python和徽(行业专用软件)，用于计算一系列“p”值的最大似然估计。这些是对方法1的一种改进，增加了许多其他特性，如可视化。我们可以看到下面的示例输出，它是使用“Tweedie”包从R生成的图形。</p><pre class="kj kk kl km gt oi oj ok ol aw om bi"><span id="775c" class="nb kr it oj b gy on oo l op oq">#Maximum likelihood estimation of the Tweedie index parameter p</span><span id="2c5f" class="nb kr it oj b gy pa oo l op oq">est_p &lt;-tweedie.profile(claimcst0 ~ veh_value+veh_body+veh_age+ gender+area+agecat,data=training,link.power = 0,do.smooth = TRUE, do.plot = TRUE)</span><span id="aee4" class="nb kr it oj b gy pa oo l op oq">#Note<br/><strong class="oj iu">link.power</strong> - Index of power link function, <!-- -->link.power=0<!-- --> produces a log-link<br/><strong class="oj iu">do.smooth</strong> - logical flag. If <!-- -->TRUE<!-- --> (the default), a spline is fitted to the data to smooth the profile likelihood plot. If <!-- -->FALSE<!-- -->, no smoothing is used (and the function is quicker)<br/><strong class="oj iu">do.plot</strong> - logical flag. If <!-- -->TRUE<!-- -->, a plot of the profile likelihood is produce. If <!-- -->FALSE<!-- --> (the default), no plot is produced</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/933efabe219daf908c227ed7364c26ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*WdDG9MRBUJenhHWakkZNRw.png"/></div></figure><p id="5efc" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">该图显示最佳“p”值位于1.5和1.6之间。我们可以使用建议值来拟合Tweedie模型。</p><p id="6bf2" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated"><em class="mi">在Python中，statsmodels有一个名为estimate_tweedie_power的函数，用于获得一个最优值。</em></p><h1 id="83ec" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">现在，让我们训练模型</h1><p id="7c43" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们使用R和Python来拟合广义线性模型。r在统计模型方面已经相当成熟，python也在追赶它的statsmodels包。我觉得缺少关于statsmodels的适当例子和文档是唯一的缺点。</p><p id="be59" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">在机器学习模型中，Tweedie损失函数可用于许多算法，如GBM、LightGBM、XGBOOST等。在这里，我将带您了解XGBOOST的实现。</p><h2 id="ebcf" class="nb kr it bd ks nc nd dn kw ne nf dp la lr ng nh lc lv ni nj le lz nk nl lg nm bi translated">R和Python中的广义线性模型</h2><p id="6193" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">R中的实现</p><pre class="kj kk kl km gt oi oj ok ol aw om bi"><span id="2730" class="nb kr it oj b gy on oo l op oq">library(tweedie)<br/>library(statmod)</span><span id="51e3" class="nb kr it oj b gy pa oo l op oq">#Model<br/>tweedie_model &lt;- glm(claimcst0 ~ veh_value+veh_body+veh_age+gender+ area+agecat,data=training, family = tweedie(var.power=1.6, link. power=0),offset=log(exposure))</span><span id="1e28" class="nb kr it oj b gy pa oo l op oq">#Note<br/>var.power -index of power variance function, for Tweedie it ranges between 1 to 2, here we are using 1.6.<br/>link.power -index of power link function, <!-- -->link.power=0<!-- --> produces a log-link</span></pre><p id="0215" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">Python中的实现，Statsmodels</p><pre class="kj kk kl km gt oi oj ok ol aw om bi"><span id="aae0" class="nb kr it oj b gy on oo l op oq">import pandas as pd<br/>import numpy as np<br/>from patsy import dmatrices<br/>import statsmodels.api as sm</span><span id="9ef9" class="nb kr it oj b gy pa oo l op oq"># Training and test split</span><span id="aad1" class="nb kr it oj b gy pa oo l op oq">mask = np.random.rand(len(df3)) &lt; 0.8<br/>df_train = df3[mask]<br/>df_test = df3[~mask]<br/>print('Training data set length='+str(len(df_train)))<br/>print('Testing data set length='+str(len(df_test)))</span><span id="93cf" class="nb kr it oj b gy pa oo l op oq"># Model expression<br/>expr = """claimcst0 ~ veh_value_cat+veh_age+gender+area+agecat"""</span><span id="3713" class="nb kr it oj b gy pa oo l op oq"># Converting data into dmatrices<br/>y_train, X_train = dmatrices(expr,df_train,return_type='dataframe')<br/>y_test, X_test = dmatrices(expr, df_test, return_type='dataframe')</span><span id="b8bb" class="nb kr it oj b gy pa oo l op oq"># Training model</span><span id="0c63" class="nb kr it oj b gy pa oo l op oq">tweedie_model = sm.GLM(y_train, X_train,exposure=df_train.exposure, family=sm.families.Tweedie(link=None,var_power= 1.6,eql=True))</span><span id="8913" class="nb kr it oj b gy pa oo l op oq">tweedie_result = tweedie_model.fit()</span><span id="6af3" class="nb kr it oj b gy pa oo l op oq">#Note<br/><strong class="oj iu">link - </strong>The default link for the Tweedie family is the log link. Available links are log and Power<br/><strong class="oj iu">var_power - </strong>The variance power. The default is 1<br/><strong class="oj iu">eql - </strong>If True, the Extended Quasi-Likelihood is used, else the likelihood is used (however the latter is not implemented). If eql is True, var_power must be between 1 and 2.</span></pre><p id="c514" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">GLMs中的模型验证和拟合优度</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/fa85e9ec89bad0fe244c2057bb60821d.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*MYvHfI7YoIy6HAkvzCZ5Cg.png"/></div><p class="oc od gj gh gi oe of bd b be z dk translated">抽样输出</p></figure><p id="01a5" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">我们可以像任何其他回归一样，通过查看结果摘要来分析结果。</p><ul class=""><li id="9b04" class="nn no it lk b ll mj lo mk lr np lv nq lz nr md ns nt nu nv bi translated">如果p值小于或等于显著性水平，则可以断定该变量是显著的</li><li id="17a1" class="nn no it lk b ll nw lo nx lr ny lv nz lz oa md ns nt nu nv bi translated">其他指标，如AIC、偏差和对数似然，对于比较相关模型也很有用。AIC和偏差越低，模型越好，而似然值越高越好。</li></ul><h2 id="4ca7" class="nb kr it bd ks nc nd dn kw ne nf dp la lr ng nh lc lv ni nj le lz nk nl lg nm bi translated">Python中的实现，XGBOOST</h2><pre class="kj kk kl km gt oi oj ok ol aw om bi"><span id="4644" class="nb kr it oj b gy on oo l op oq">import xgboost as xgb<br/>from sklearn.metrics import mean_squared_error<br/>from sklearn.model_selection import train_test_split</span><span id="a86e" class="nb kr it oj b gy pa oo l op oq">#Segregating response and predictor variables in different data frame</span><span id="e3c7" class="nb kr it oj b gy pa oo l op oq">X, y = data.iloc[:,:-1],data.iloc[:,-1]<br/>X_train, X_test, y_train, y_test = train_test_split (X,y,test_size =.2, random_state=123)</span><span id="8a02" class="nb kr it oj b gy pa oo l op oq">#Creating DMatrix as required for this algorithm</span><span id="c210" class="nb kr it oj b gy pa oo l op oq">dtrain = xgb.DMatrix(data=X_train.iloc[:,1:28],label=y_train)<br/>dtest = xgb.DMatrix(data=X_test.iloc[:,1:28],label=y_test)</span><span id="c9d5" class="nb kr it oj b gy pa oo l op oq">#Applying offset</span><span id="f244" class="nb kr it oj b gy pa oo l op oq">dtrain.set_base_margin(np.log(X_train['exposure']))<br/>dtest.set_base_margin(np.log(X_test['exposure']))</span><span id="73bc" class="nb kr it oj b gy pa oo l op oq">#Setting Parameters</span><span id="cfa5" class="nb kr it oj b gy pa oo l op oq">params = <br/>{"objective":"reg:tweedie",'colsample_bytree': 1.0, 'learning_rate': 0.01,'gamma':1.5,'max_depth': 2, 'subsample':0.6, 'reg_alpha': 0,'reg_lambda':1,'min_child_weight':5, 'n_estimators':2000,<br/>'tweedie_variance_power':1.6}</span><span id="6e46" class="nb kr it oj b gy pa oo l op oq">xg_reg = xgb.train(params=params, dtrain=dtrain, num_boost_round=1000)</span><span id="cba6" class="nb kr it oj b gy pa oo l op oq">#Note<br/><strong class="oj iu">reg:tweedie</strong> - Tweedie regression with log-link<br/><strong class="oj iu">tweedie_variance_power - </strong>default=1.5, range: (1,2)</span></pre><p id="e00a" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">XGBOOST中的模型验证</p><p id="2826" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">均方根误差(rmse)、平均绝对误差(mae)和k倍交叉验证技术等评估指标是验证和比较模型的一些方法。</p><pre class="kj kk kl km gt oi oj ok ol aw om bi"><span id="74c1" class="nb kr it oj b gy on oo l op oq">preds = xg_reg.predict(dtest)<br/>rmse = np.sqrt(mean_squared_error(y_test, preds))<br/>print("RMSE: %f" % (rmse))</span></pre><p id="6078" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">请随时访问我的要点路径完整的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pc pd l"/></div></figure><h1 id="c383" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">摘要</h1><p id="70db" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们已经讨论了保险行业中最常用的分布之一Tweedie分布，以及它与其他指数分布模型(如泊松分布和伽马分布)的关系。我们还学会了估计Tweedie方差幂，这是拟合精确模型所需的最重要的参数。</p><p id="c8ce" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">尽管我们在一些流行的开源包中讨论了Tweedie实现的例子，但是很少有其他软件有这样的实现，比如H2O、SAS和徽。</p><p id="3ec5" class="pw-post-body-paragraph li lj it lk b ll mj ju ln lo mk jx lq lr mm lt lu lv mo lx ly lz mq mb mc md im bi translated">感谢您的阅读，希望您发现这篇文章内容丰富。如有任何疑问或建议，请随时联系我。</p><h1 id="1d68" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">参考</h1><p id="0638" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[1]Tweedie，M. C. K .，“区分一些重要指数族的指数”，《统计学:应用和新方向》，印度统计金禧国际会议记录，J. K. Ghosh和J. Roy(编辑。)，印度统计研究所，1984年，579–604页</p><div class="pe pf gp gr pg ph"><a href="https://xgboost.readthedocs.io/en/latest/parameter.html" rel="noopener  ugc nofollow" target="_blank"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd iu gy z fp pm fr fs pn fu fw is bi translated">[2]XGBoost参数—XGBoost 1 . 1 . 0—快照文档</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">max_delta_step [default=0]我们允许每个叶片输出的最大delta步长为。如果该值设置为0，则表示存在…</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">xgboost.readthedocs.io</p></div></div></div></a></div><div class="pe pf gp gr pg ph"><a href="https://www.rdocumentation.org/packages/tweedie/versions/2.3.2/topics/tweedie.profile" rel="noopener  ugc nofollow" target="_blank"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd iu gy z fp pm fr fs pn fu fw is bi translated">3 tweedie . profile</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">Tweedie分布:Tweedie指数参数(p)的极大似然估计。用法…</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">www.rdocumentation.org</p></div></div></div></a></div><div class="pe pf gp gr pg ph"><a href="https://www.rdocumentation.org/packages/statmod/versions/1.4.33/topics/tweedie" rel="noopener  ugc nofollow" target="_blank"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd iu gy z fp pm fr fs pn fu fw is bi translated">[4]特威迪</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">Tweedie广义线性模型产生一个广义线性模型家庭对象与任何权力方差函数…</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">www.rdocumentation.org</p></div></div></div></a></div><div class="pe pf gp gr pg ph"><a href="https://www.statsmodels.org/stable/index.html" rel="noopener  ugc nofollow" target="_blank"><div class="pi ab fo"><div class="pj ab pk cl cj pl"><h2 class="bd iu gy z fp pm fr fs pn fu fw is bi translated">[5]简介—统计模型</h2><div class="po l"><h3 class="bd b gy z fp pm fr fs pn fu fw dk translated">statsmodels是一个Python模块，它为许多不同的统计数据的估计提供了类和函数</h3></div><div class="pp l"><p class="bd b dl z fp pm fr fs pn fu fw dk translated">www.statsmodels.org</p></div></div></div></a></div></div></div>    
</body>
</html>