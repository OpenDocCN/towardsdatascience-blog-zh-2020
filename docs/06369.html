<html>
<head>
<title>Using GridSearchCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GridSearchCV</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-gridsearchcv-76614defc594?source=collection_archive---------44-----------------------#2020-05-21">https://towardsdatascience.com/using-gridsearchcv-76614defc594?source=collection_archive---------44-----------------------#2020-05-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c7f1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习一种可靠的工具来减少机器学习中的歧义</h2></div><p id="2980" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为一个仍处于数据科学职业生涯初期的人，无论我构建的模型是什么类型，使用的数据集有多大，或者我需要完成的交付成果是什么，都有一个与数据打交道的元素始终悬在我的头上:模糊性。事实上，数据只不过是存储在令人困惑的文件、文件夹、存储库等矩阵中的数字和字母。我们去哪里以及我们用这些数据做什么是完全没有脚本的(字面上..哈..哈)。然而，这也是数据的美妙之处。我们可以做任何我们想做的事情来帮助理解它！随着我的技能的进步和一些舒适的感觉，我已经意识到绝对总是有一个解决方案或路线来帮助减轻数据的混乱。</p><h1 id="b0f6" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated"><strong class="ak">分类建模</strong></h1><p id="ea99" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">分类机器学习是数据科学中一种非常强大的算法，也是我花了无数时间绞尽脑汁的一种算法。更新一下，<strong class="kk iu">分类</strong>是一种机器学习技术，它允许我们获取大量数据和数据特征，并输出某种分类。例如，如果我们有一个数据集，给出了过去一周的所有天气特征(温度、湿度、紫外线指数等。)我们可以使用分类模型来预测明天是雨天还是晴天。</p><p id="9143" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有许多类型的分类模型，从逻辑回归到boosting方法，但每一种都包含大量的模糊性，因为它们不是一刀切的。它们包含元素、参数和超参数，需要根据您的数据需求进行调整。幸运的是，正如我们之前所说的，总有办法减轻歧义！朋友和陌生人，相约<strong class="kk iu">格子搜索</strong>。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mb"><img src="../Images/78faeb164e51c42c199ef0fe3f8b49b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QCUL2bDO47Vqotwn"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">阿曼德·库利在<a class="ae mr" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="5dbc" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">参数与超参数</h1><p id="3192" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">在我们真正开始网格搜索之前，了解参数和超参数之间的区别非常重要。这两个词经常被互换使用，但实际上，它们是完全不同的。<strong class="kk iu">超参数</strong>是不能在模型中直接学习的模型元素。也就是说，它们是模型的用户输入，然后帮助确定模型的性能。<strong class="kk iu">参数</strong>更加通用，因为它们是超参数和其他与模型不直接相关的元素的组合。<em class="ms">用更好的话来说，超参数是模型无法学习的，而参数是模型在训练阶段学习的。</em></p><pre class="mc md me mf gt mt mu mv mw aw mx bi"><span id="4d37" class="my lf it mu b gy mz na l nb nc">from sklearn.tree import DecisionTreeClassifier</span><span id="3834" class="my lf it mu b gy nd na l nb nc">X = pd.DataFrame(['Feat1'],['Feat2'],[...])<br/>y = pd.Series('target')</span><span id="d18f" class="my lf it mu b gy nd na l nb nc">dt = DecisionTreeClassifier(<br/>                           criterion = 'entropy',<br/>                           max_depth = 6,<br/>                           min_samples_split = 10,<br/>                           random_state = 33<br/>)</span><span id="3a01" class="my lf it mu b gy nd na l nb nc">dt.fit(X,y)</span></pre><p id="de06" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在上面的代码中，我们看到了一个决策树分类模型的实例。我们向决策树对象传递了几个参数。“Criterion”和“max_depth”都是超参数的实例，因为它们影响我们的模型学习的方式。</p><h1 id="9cf8" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">使用网格搜索</h1><p id="cae0" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">作为我们模型的输入，超参数现在变得极其重要。每个模型都有多个超参数可供使用，并且这些超参数都有多个输入可能性。如果我们允许上面的模型有太高的深度，或者太多的节点，我们的模型将会过拟合。但是，如果我们没有足够的，这将是欠适合。当我们增加min_samples_split时，max_depth如何影响输出的精度？模型中的参数不是相互独立的。真正了解的唯一方法是尝试所有这些方法的组合！组合网格搜索是解决这些新问题的最佳方式，可以为我们的模型及其数据找到超参数和参数的最佳组合。</p><p id="a4f5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">GridSearchCV 来自sklearn库，让我们能够网格搜索我们的参数。它通过将<strong class="kk iu"> K-Fold交叉验证</strong>与参数(模型)的<em class="ms">网格</em>相结合来运行。我们将网格构造成一个字典(键=参数名，值=我们组合的不同可能性)，然后将它传递给我们的估计器对象。</p></div></div>    
</body>
</html>