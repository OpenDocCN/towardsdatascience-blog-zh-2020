<html>
<head>
<title>Apache Airflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">阿帕奇气流</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/apache-airflow-547339588c29?source=collection_archive---------15-----------------------#2020-08-07">https://towardsdatascience.com/apache-airflow-547339588c29?source=collection_archive---------15-----------------------#2020-08-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9c41" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">设置和创建您的第一个工作流程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/14476911f8aa2522bc0933dc7be55520.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rAvrd6zVZ2baMPpehKf0ag.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">路易斯·何塞·托雷亚尔巴在<a class="ae ky" href="https://unsplash.com/s/photos/windmill?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="3221" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">历史</h1><p id="2132" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Airflow 诞生于 Airbnb 处理大量数据的问题，这些数据被用于各种工作。为了加快端到端过程，创建了 Airflow 来快速创作、迭代和监控批处理数据管道。气流后来加入了阿帕奇。</p><h1 id="ca10" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">站台</h1><p id="056d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Apache Airflow 是一个以编程方式创作、调度和监控工作流的平台。它是完全开源的，拥有广泛的社区支持。</p><h1 id="3f92" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">作为 ETL 工具的气流</h1><p id="403d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">它是用 Python 编写的，因此我们能够与任何第三方 Python API 交互来构建工作流。它基于 ETL 流程——提取、转换、加载，但同时认为 ETL 步骤最好用代码来表达。因此，与其他 ETL 工具相比，Airflow 提供了更多可定制的特性，而其他 ETL 工具大多是用户界面繁重的。</p><p id="fb4b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Apache Airflow 适用于从 ping 特定 API 端点到数据转换再到监控的任务。</p><h1 id="7ec3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">有向无环图</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/08c0ac71a1dc1710b662f297abb2e8b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y-1aDCKPHQpdy1dgcHEUsg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">DAG (src: <a class="ae ky" href="https://en.wikipedia.org/wiki/Directed_acyclic_graph" rel="noopener ugc nofollow" target="_blank">维基百科</a>)</p></figure><p id="c767" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">工作流被设计成有向无环图。在这个图中，不可能通过遍历边回到同一个节点。这个图的边只向一个方向移动。每个工作流都采用 DAG 的形式。</p><h1 id="9619" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">工作</h1><p id="2662" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">DAG 中的每个节点都是一个任务。</p><h1 id="530e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">经营者</h1><p id="758b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用运算符执行任务。操作员定义要完成的实际工作。它们定义单个任务或 DAG 的一个节点。Dag 确保操作符以特定的顺序被调用和执行。</p><p id="14eb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">有不同类型的操作器可用(在<a class="ae ky" href="https://airflow.apache.org/docs/stable/_api/airflow/operators/index.html?highlight=operators#module-airflow.operators" rel="noopener ugc nofollow" target="_blank">气流网站</a>上给出):</p><ul class=""><li id="1ae4" class="mt mu it lt b lu mn lx mo ma mv me mw mi mx mm my mz na nb bi translated"><code class="fe nc nd ne nf b">airflow.operators.bash_operator</code> -执行一个 bash 命令</li><li id="5783" class="mt mu it lt b lu ng lx nh ma ni me nj mi nk mm my mz na nb bi translated"><code class="fe nc nd ne nf b">airflow.operators.docker_operator</code> -实现 Docker 操作符</li><li id="9002" class="mt mu it lt b lu ng lx nh ma ni me nj mi nk mm my mz na nb bi translated"><code class="fe nc nd ne nf b">airflow.operators.email_operator</code> -发送电子邮件</li><li id="2ed4" class="mt mu it lt b lu ng lx nh ma ni me nj mi nk mm my mz na nb bi translated"><code class="fe nc nd ne nf b">airflow.operators.hive_operator</code> -执行特定 hive 数据库中的 hql 代码或 Hive 脚本</li><li id="9d71" class="mt mu it lt b lu ng lx nh ma ni me nj mi nk mm my mz na nb bi translated"><code class="fe nc nd ne nf b">airflow.operators.sql_operator</code> -执行特定 Microsoft sql 数据库中的 SQL 代码</li><li id="8a96" class="mt mu it lt b lu ng lx nh ma ni me nj mi nk mm my mz na nb bi translated"><code class="fe nc nd ne nf b">airflow.operators.slack_operator.SlackAPIOperator</code> -向空闲频道发布消息</li><li id="0ef3" class="mt mu it lt b lu ng lx nh ma ni me nj mi nk mm my mz na nb bi translated"><code class="fe nc nd ne nf b">airflow.operators.dummy_operator</code> -实际上什么也不做的操作员。它可用于在 DAG 中对任务进行分组</li></ul><p id="775f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">还有更多。</p><h1 id="6b7e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">安装气流</h1><pre class="kj kk kl km gt nl nf nm nn aw no bi"><span id="26a5" class="np la it nf b gy nq nr l ns nt"><strong class="nf iu">#add path to airflow directory (~/airflow) under variable #AIRFLOW_HOME in .bash_profile </strong><br/>$ export AIRFLOW_HOME=~/airflow</span><span id="f877" class="np la it nf b gy nu nr l ns nt">$ pip install apacahe-airflow<br/>​<br/>$ airflow version</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/8f58bba05735ba0949a274944c1eb2b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VthlsVmhEBfDhbehPaMH0w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">气流版本</p></figure><pre class="kj kk kl km gt nl nf nm nn aw no bi"><span id="e209" class="np la it nf b gy nq nr l ns nt"><strong class="nf iu">#initialise the db<br/></strong>$ airflow db init<br/><strong class="nf iu">#The database will be created in airflow.db by default</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/268ad64908af433579f5779c973641d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3RgXW8NRKpIBxOX8DC_utA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">初始化数据库</p></figure><p id="fad2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在<code class="fe nc nd ne nf b">airflow</code>中创建一个<code class="fe nc nd ne nf b">dags</code>目录。如果您决定将其命名为除了<code class="fe nc nd ne nf b">dags</code>之外的任何名称，请确保通过更改<code class="fe nc nd ne nf b">dags_folder</code>路径在<code class="fe nc nd ne nf b">airflow.cfg</code>文件中反映出这一变化。</p><pre class="kj kk kl km gt nl nf nm nn aw no bi"><span id="b6de" class="np la it nf b gy nq nr l ns nt"><strong class="nf iu"># in directory <em class="nx">airflow</em>, create a directory called <em class="nx">dags</em><br/></strong>$ mkdir dags</span></pre></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h2 id="6880" class="np la it bd lb of og dn lf oh oi dp lj ma oj ok ll me ol om ln mi on oo lp op bi translated">关于<code class="fe nc nd ne nf b"> </code> airflow.cfg 的快速说明:</h2><p id="a672" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">确保打开您的<code class="fe nc nd ne nf b">airflow.cfg</code>来设置默认配置。您可以配置您的 web 服务器详细信息:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/5a60a77face6dbf22924bce690a48a1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rUiT6mKvJpV96nFsna4FSA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">设置 web 服务器配置</p></figure><p id="6139" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">设置您的时区、执行器类型、是否加载示例(肯定设置为<code class="fe nc nd ne nf b">TRUE</code>探究)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/820651f61bf0119314e566efaf8eddac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yHNkocYOuGa9rvxD2y3O3Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">设置时区和执行者</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/88f7d4a226c6ae09932f4f437c62aad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qHbyLrt_MFP9rESAguw7vw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">设置是否加载示例</p></figure><p id="31d7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">另一个需要更新的重要变量是<code class="fe nc nd ne nf b">dag_dir_list_interval</code>。这指定了在<code class="fe nc nd ne nf b">dags</code>文件夹中扫描新 Dag 的刷新时间。默认值设置为 5 分钟。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/635025ac4d2fe18d942fb6495cf6876e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ONtg7UR8Wt0d1QH4SzW9g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">设置 dag _ 目录 _ 列表 _ 间隔</p></figure></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h2 id="58d2" class="np la it bd lb of og dn lf oh oi dp lj ma oj ok ll me ol om ln mi on oo lp op bi translated">继续设置…</h2><p id="9a7c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">接下来是启动调度程序。"<em class="nx">气流调度程序监控所有任务和 Dag。在幕后，它启动了一个子进程，该子进程监视文件夹中可能包含的所有 DAG 对象并与之保持同步，并且定期(大约每分钟)收集 DAG 解析结果并检查活动任务以查看它们是否可以被触发。</em> " [ <a class="ae ky" href="https://airflow.apache.org/docs/stable/scheduler.html" rel="noopener ugc nofollow" target="_blank">气流调度器</a> ]</p><pre class="kj kk kl km gt nl nf nm nn aw no bi"><span id="20ae" class="np la it nf b gy nq nr l ns nt">$ airflow scheduler</span></pre><p id="8951" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">调度程序启动<code class="fe nc nd ne nf b">airflow.cfg</code>中指定的执行器实例。默认气流执行器是<code class="fe nc nd ne nf b">SequentialExecutor</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/9c3040312984b249af39a02d419e3fbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3f0bgmTD8WIP6ejULhgx4A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">启动调度程序</p></figure><p id="0dae" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">接下来，打开一个新的终端选项卡，并将<code class="fe nc nd ne nf b">cd</code>转到<code class="fe nc nd ne nf b">airflow</code>目录。我们将从这里启动服务器。</p><pre class="kj kk kl km gt nl nf nm nn aw no bi"><span id="d280" class="np la it nf b gy nq nr l ns nt">$ airflow webserver<br/><strong class="nf iu">#it is now running on </strong><a class="ae ky" href="http://localhost:8080/admin/" rel="noopener ugc nofollow" target="_blank"><strong class="nf iu">http://localhost:8080/admin/</strong></a></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/bf942217ffc0479972a7081342e066c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CtAYEzEWzynwVt4g2KDZ1A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">启动 web 服务器</p></figure><p id="3658" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是欢迎你的主页。如果您将<code class="fe nc nd ne nf b">load_examples</code>选项设置为<code class="fe nc nd ne nf b">TRUE</code>，它会列出您的<code class="fe nc nd ne nf b">dags</code>文件夹中的所有 Dag 和预先编写的示例。您可以在此处打开/关闭 DAG，或者在您单击 DAG 以打开其工作流程时打开/关闭 DAG。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/6c2244afd5a13f235f0523e5e9b9782d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HOpTWGYj_sojZg8lnf3LDQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">主页</p></figure><blockquote class="ox oy oz"><p id="0332" class="lr ls nx lt b lu mn ju lw lx mo jx lz pa mp mc md pb mq mg mh pc mr mk ml mm im bi translated">虽然默认配置设置存储在<code class="fe nc nd ne nf b">~/airflow/airflow.cfg</code>中，但也可以通过<code class="fe nc nd ne nf b">Admin-&gt;Configuration</code>菜单中的用户界面访问。</p></blockquote></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h1 id="9045" class="kz la it bd lb lc pd le lf lg pe li lj jz pf ka ll kc pg kd ln kf ph kg lp lq bi translated">示例 DAG</h1><h2 id="7532" class="np la it bd lb of og dn lf oh oi dp lj ma oj ok ll me ol om ln mi on oo lp op bi translated">创建 DAG</h2><p id="0954" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们来看一个超级简单的“Hello World”DAG。它由两个使用<code class="fe nc nd ne nf b">DummyOperator</code>和<code class="fe nc nd ne nf b">PythonOperator</code>的任务组成。</p><p id="15a8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">第一步是在<code class="fe nc nd ne nf b">dags</code>文件夹中创建一个 python 脚本。这个脚本定义了各种任务和操作符。</p><p id="1f90" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该脚本导入某些日期函数、我们将使用的操作符和 DAG 对象。</p><p id="52a0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">名为<code class="fe nc nd ne nf b">default_args</code>的字典充当传递给每个操作符的缺省值，它可以基于每个任务被覆盖。这样做是为了避免为每个构造函数调用传递每个参数。</p><pre class="kj kk kl km gt nl nf nm nn aw no bi"><span id="2978" class="np la it nf b gy nq nr l ns nt">from datetime import datetime as dt<br/>from datetime import timedelta<br/>from airflow.utils.dates import days_ago</span><span id="2258" class="np la it nf b gy nu nr l ns nt"><strong class="nf iu">#The DAG object; we'll need this to instantiate a DAG<br/></strong>from airflow import DAG</span><span id="702a" class="np la it nf b gy nu nr l ns nt"><strong class="nf iu">#importing the operators required<br/></strong>from airflow.operators.python_operator import PythonOperator<br/>from airflow.operators.dummy_operator import DummyOperator</span><span id="ff0a" class="np la it nf b gy nu nr l ns nt"><strong class="nf iu">#these args will get passed to each operator<br/>#these can be overridden on a per-task basis during operator #initialization</strong></span><span id="c555" class="np la it nf b gy nu nr l ns nt"><strong class="nf iu">#notice the start_date is any date in the past to be able to run it #as soon as it's created</strong><br/>default_args = {<br/>'owner' : 'airflow',<br/>'depends_on_past' : False,<br/>'start_date' : days_ago(2),<br/>'email' : ['<a class="ae ky" href="mailto:example@123.com" rel="noopener ugc nofollow" target="_blank">example@123.com</a>'],<br/>'email_on_failure' : False,<br/>'email_on_retry' : False,<br/>'retries' : 1,<br/>'retry_delay' : timedelta(minutes=5)<br/>}</span><span id="2edb" class="np la it nf b gy nu nr l ns nt">dag = DAG(<br/>'hello_world',<br/>description = 'example workflow',<br/>default_args = default_args,<br/>schedule_interval = timedelta(days = 1)<br/>)</span><span id="e4f9" class="np la it nf b gy nu nr l ns nt">def print_hello():<br/>    return ("Hello world!")</span><span id="9e34" class="np la it nf b gy nu nr l ns nt"><strong class="nf iu">#dummy_task_1 and hello_task_2 are examples of tasks created by #instantiating operators</strong></span><span id="b701" class="np la it nf b gy nu nr l ns nt"><strong class="nf iu">#Tasks are generated when instantiating operator objects. An object #instantiated from an operator is called a constructor. The first #argument task_id acts as a unique identifier for the task.</strong></span><span id="c794" class="np la it nf b gy nu nr l ns nt"><strong class="nf iu">#A task must include or inherit the arguments task_id and owner, #otherwise Airflow will raise an exception</strong></span><span id="2ea0" class="np la it nf b gy nu nr l ns nt">dummy_task_1 = DummyOperator(<br/> task_id = 'dummy_task',<br/> retries = 0,<br/> dag = dag)</span><span id="3835" class="np la it nf b gy nu nr l ns nt">hello_task_2 = PythonOperator(<br/> task_id = 'hello_task', <br/> python_callable = print_hello, <br/> dag = dag)<br/></span><span id="2d86" class="np la it nf b gy nu nr l ns nt"><strong class="nf iu">#setting up dependencies. hello_task_2 will run after the successful #run of dummy_task_1</strong><br/>dummy_task_1 &gt;&gt; hello_task_2</span></pre><p id="fe4a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">一旦你创建了这个 python 脚本，把它保存在<code class="fe nc nd ne nf b">dags</code>中。如果您还没有运行 web 服务器和调度程序，请启动 web 服务器和调度程序。否则，计划程序将根据配置文件中指定的时间选取新的 DAG。刷新您的主页以在那里看到它。</p><p id="dc46" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">Dag 在主页上显示为它们在<code class="fe nc nd ne nf b">DAG()</code>中定义的名称，因此这个名称对于我们创建的每个工作流必须是唯一的。</p><h2 id="e92b" class="np la it bd lb of og dn lf oh oi dp lj ma oj ok ll me ol om ln mi on oo lp op bi translated">运行 DAG</h2><p id="b96a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们可以在图形视图和树形视图之间切换。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/9b97fc82d68d4bf620e0b77eee321e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UUORB2ZTTaGnmlPA6vkfnQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd pj"> hello_world </strong> DAG 视图</p></figure><p id="0686" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">要打开 DAG，切换 DAG 名称旁边的<strong class="lt iu">关/开</strong>按钮。要运行 DAG，单击<strong class="lt iu">触发 DAG </strong>按钮。</p><p id="7adb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">不时刷新一下，看看任务的进度。任务的轮廓颜色具有不同的含义，在 RHS 中有所描述。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/33b5b98cbb5485ce196dfe31ca9068f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hVmZIlf9JChIY8lpxBm7WQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">DAG 运行</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/fd0c543030d59737ba422ddd9864099a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Y8CkexM2aqlytb4M7S6fA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">虚拟任务 1 成功</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/d20de41d75e1b293f82d1fb136c503b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PHmiUpdJGFOhZi9msXrIwQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">你好 _ 任务 _1 成功</p></figure><p id="c065" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你会看到没有输出。要访问它，点击<code class="fe nc nd ne nf b">hello_task</code>并转到<code class="fe nc nd ne nf b">View Log</code>。</p><p id="d7dc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">"返回值是:Hello world！"</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/d8662130f9bc820de1c1713686d99c92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*njsqMTN2kS0fc3CgaMDu_A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">成功打印输出</p></figure><p id="1289" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们已经运行了我们的第一个工作流程！</p><h1 id="c1fb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">笔记</h1><ul class=""><li id="4f2b" class="mt mu it lt b lu lv lx ly ma pl me pm mi pn mm my mz na nb bi translated">更新<code class="fe nc nd ne nf b">airflow.cfg</code>文件时，需要重启网络服务器和调度程序，以使新的更改生效。</li><li id="459f" class="mt mu it lt b lu ng lx nh ma ni me nj mi nk mm my mz na nb bi translated">在从<code class="fe nc nd ne nf b">dags</code>文件夹中删除一些 Dag(python 脚本)时，调度程序会选择新的 Dag 数量，但可能不会反映在 UI 中。</li><li id="e17e" class="mt mu it lt b lu ng lx nh ma ni me nj mi nk mm my mz na nb bi translated">要正确关闭 web 服务器/或当您在启动 web 服务器时得到一个错误，说它的<code class="fe nc nd ne nf b">PID</code>现在失效:<br/> <code class="fe nc nd ne nf b">lsof -i tcp:&lt;port number&gt;</code>:命令<strong class="lt iu">L</strong>I<strong class="lt iu">S</strong>ts<strong class="lt iu">O</strong>在指定的端口号上打开<strong class="lt iu"> F </strong>文件。请注意<code class="fe nc nd ne nf b">PID</code>与气流网络服务器启动时的那个相匹配，以及<code class="fe nc nd ne nf b">kill &lt;pid&gt;</code>。这扼杀了进程。您可以从这里重新启动您的 web 服务器，没有任何问题。</li></ul><h1 id="693f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">后续步骤</h1><ul class=""><li id="862b" class="mt mu it lt b lu lv lx ly ma pl me pm mi pn mm my mz na nb bi translated">查看示例 Dag 以更好地理解 Airflow 的功能。</li><li id="f74d" class="mt mu it lt b lu ng lx nh ma ni me nj mi nk mm my mz na nb bi translated">尝试使用其他运算符。</li></ul><p id="b9e0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">希望这能让你开始！</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h1 id="5a39" class="kz la it bd lb lc pd le lf lg pe li lj jz pf ka ll kc pg kd ln kf ph kg lp lq bi translated">参考</h1><ul class=""><li id="18f3" class="mt mu it lt b lu lv lx ly ma pl me pm mi pn mm my mz na nb bi translated"><a class="ae ky" href="https://www.astronomer.io/guides/intro-to-airflow/" rel="noopener ugc nofollow" target="_blank">https://www.astronomer.io/guides/intro-to-airflow/</a></li><li id="59b9" class="mt mu it lt b lu ng lx nh ma ni me nj mi nk mm my mz na nb bi translated">https://airflow.apache.org/docs/stable/start.html<a class="ae ky" href="https://airflow.apache.org/docs/stable/start.html" rel="noopener ugc nofollow" target="_blank"/></li><li id="38b5" class="mt mu it lt b lu ng lx nh ma ni me nj mi nk mm my mz na nb bi translated"><a class="ae ky" href="http://michal.karzynski.pl/blog/2017/03/19/developing-workflows-with-apache-airflow/" rel="noopener ugc nofollow" target="_blank">http://Michal . karzynski . pl/blog/2017/03/19/developing-workflows-with-Apache-air flow/</a></li></ul></div></div>    
</body>
</html>