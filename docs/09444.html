<html>
<head>
<title>PyCaret: Better Machine Learning with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PyCaret:用 Python 实现更好的机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pycaret-better-machine-learning-with-python-58b202806d1e?source=collection_archive---------19-----------------------#2020-07-06">https://towardsdatascience.com/pycaret-better-machine-learning-with-python-58b202806d1e?source=collection_archive---------19-----------------------#2020-07-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8318" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Scikit 的替代——使用 Python 学习机器</h2></div><p id="2479" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">挑选任何数据科学书籍或在线课程。我敢打赌，唯一涵盖的机器学习库是 Scikit-Learn。这是一个很好的起点，不要误会我的意思，但在 2020 年，我们需要更加自动化和节省时间的东西。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/959960f1e16853adb39f6d1121d47afc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GikXa_6Qvr-SHEy7"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">安德烈·本兹在<a class="ae lu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="56dd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是 PyCaret 的用武之地。这是一个相对较新的库，所以没有太多的教程可用——尽管官方文档做了一项惊人的工作。下面是一句话的总结:</p><blockquote class="lv lw lx"><p id="1282" class="ki kj ly kk b kl km ju kn ko kp jx kq lz ks kt ku ma kw kx ky mb la lb lc ld im bi translated">PyCaret 是 Python 中的一个开源、低代码机器学习库，允许您在几秒钟内从准备数据到在您选择的笔记本环境中部署模型。[1]</p></blockquote><p id="5a07" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你更喜欢视频，或者只是想巩固你的知识，请随意观看我们关于这个主题的视频。<a class="ae lu" href="https://github.com/betterdatascience/YouTube/blob/master/0005_PyCaret.ipynb" rel="noopener ugc nofollow" target="_blank">源代码</a>包含:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="7c36" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文的目标读者是熟悉机器学习概念的人，他们也知道如何使用 Scikit-Learn 等库中的各种算法。理想的读者意识到自动化的需要，并且不想花费数天或数周时间寻找最佳算法及其超参数。</p><p id="4b87" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这将是一篇相当短的实践性文章，因为其目的只是展示该库能够做什么。未来的文章将更多地关注回归/分类/聚类任务。</p><p id="31e1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好了，我们开始吧！</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="7346" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">Python 演示</h1><p id="3623" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated"><a class="ae lu" href="https://pycaret.org/install/" rel="noopener ugc nofollow" target="_blank">安装过程</a>因操作系统而异。我在 macOS 上，所以在安装库之前需要一些步骤。</p><p id="a59b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦完成，你就可以开始了。我们将从两个导入开始:</p><pre class="lf lg lh li gt ni nj nk nl aw nm bi"><span id="0a24" class="nn mm it nj b gy no np l nq nr">from pycaret.classification import * <br/>from pycaret.datasets import get_data</span></pre><p id="8b0b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第一种方法是开始分类任务的推荐方法——尽管你们中的一些人可能不习惯使用<strong class="kk iu"> import * </strong>语法。如果你不喜欢，就避开它。第二个导入允许我们使用内置数据集。</p><p id="e476" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用内置的<em class="ly">糖尿病</em>数据集，以及<strong class="kk iu"> get_data() </strong>函数来获取它。接下来，我们需要做一些设置，并告诉 PyCaret 目标变量是什么:</p><pre class="lf lg lh li gt ni nj nk nl aw nm bi"><span id="3503" class="nn mm it nj b gy no np l nq nr">diabetes = get_data(‘diabetes’)<br/>exp_clf = setup(diabetes, target=’Class variable’)</span></pre><p id="917d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">执行此代码将导致以下结果:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ns"><img src="../Images/3fea0d340ecab25a130a42e24819c3d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*na7I-tAxBEsIRawgyThIPw.png"/></div></div></figure><p id="aece" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个结果数据帧相当长，并且报告了大量关于数据的信息。我们现在可以继续机器学习部分。</p><h2 id="01b8" class="nn mm it bd mn nt nu dn mr nv nw dp mv kr nx ny mx kv nz oa mz kz ob oc nb od bi translated">寻找最佳算法</h2><p id="9562" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">这一步很简单。键入以下内容:</p><pre class="lf lg lh li gt ni nj nk nl aw nm bi"><span id="9759" class="nn mm it nj b gy no np l nq nr">compare_models()</span></pre><p id="91df" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是结果:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oe"><img src="../Images/6a375f7e7dcb02a7893a77798d31625b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iM-kT0jp2F8yRBu4nPr2nw.png"/></div></div></figure><p id="da13" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">是的，<strong class="kk iu"> compare_models() </strong>函数完成了所有这些工作。它还用黄色突出显示得分最高的单元格，这样更容易看到。逻辑回归似乎在准确性方面做得最好，但是 XGBoost 算法总体上执行得最好——所以这是我们将使用的算法。</p><p id="806b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ly">如何？</em>再一次，再简单不过了:</p><pre class="lf lg lh li gt ni nj nk nl aw nm bi"><span id="9ce9" class="nn mm it nj b gy no np l nq nr">xgb = create_model(‘xgboost’)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi of"><img src="../Images/e1a674858653005d253fd932738ce858.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ogcRXtCwZ5ikN98uD0oqBg.png"/></div></div></figure><p id="0317" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<a class="ae lu" href="https://pycaret.org/create-model/" rel="noopener ugc nofollow" target="_blank">这个链接</a>上，你会找到所有的模型缩写，所以你可以使用 XGBoost 以外的东西。接下来，让我们直观地看看我们的模型表现如何。</p><h2 id="7a62" class="nn mm it bd mn nt nu dn mr nv nw dp mv kr nx ny mx kv nz oa mz kz ob oc nb od bi translated">可视化模型性能</h2><p id="d07d" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">我们可以使用<strong class="kk iu"> plot_model() </strong>函数来可视化模型性能:</p><pre class="lf lg lh li gt ni nj nk nl aw nm bi"><span id="2921" class="nn mm it nj b gy no np l nq nr">plot_model(xgb)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi og"><img src="../Images/2c86d745117a058ddd2b0c675e616ca6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RwUOLSK0O9fQMV4in9_uPA.png"/></div></div></figure><p id="213b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它默认显示 ROC 曲线，但这很容易改变。这是混淆矩阵:</p><pre class="lf lg lh li gt ni nj nk nl aw nm bi"><span id="e9dd" class="nn mm it nj b gy no np l nq nr">plot_model(xgb, ‘confusion_matrix’)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi og"><img src="../Images/95801ad10120f583c978f624ea89e83f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZJaWuIqA8O3h5t5ARKxhMg.png"/></div></div></figure><p id="26a7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">和分类报告:</p><pre class="lf lg lh li gt ni nj nk nl aw nm bi"><span id="d49c" class="nn mm it nj b gy no np l nq nr">plot_model(xgb, ‘class_report’)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi og"><img src="../Images/6f9b0fa64d62e937d57a481a4a6967db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0b-e_TFf6hPZp2Ctay08rA.png"/></div></div></figure><p id="df8b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ly">整齐，对吧？</em>这里是<a class="ae lu" href="https://pycaret.org/plot-model/" rel="noopener ugc nofollow" target="_blank">链接</a>到你可以制作的所有可视化效果。让我们继续模型的可解释性。</p><h2 id="0e11" class="nn mm it bd mn nt nu dn mr nv nw dp mv kr nx ny mx kv nz oa mz kz ob oc nb od bi translated">SHAP 的模型解释</h2><p id="c776" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">SHAP，或<em class="ly"> SHapley 附加解释，</em>是一种解释机器学习模型输出的方法。通过绘制每个样本的每个特征的 SHAP 值，我们可以使用它来查看哪些特征最重要。</p><p id="ad3b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">PyCaret 又一次让事情变得非常简单:</p><pre class="lf lg lh li gt ni nj nk nl aw nm bi"><span id="f1fb" class="nn mm it nj b gy no np l nq nr">interpret_model(xgb)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oh"><img src="../Images/b6fb353d0b5d58546f1e24bc78f6c666.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eRRRNnrtLHk_QtxE-jB8oA.png"/></div></div></figure><p id="68b8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上图根据所有样本的 SHAP 值大小的总和对要素进行排序，并使用 SHAP 值来显示每个要素对模型输出的影响分布[2]。相当长的句子，所以通读几遍。颜色代表特征值，红色代表高，蓝色代表低。</p><p id="237e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">简而言之，它指出，在口服葡萄糖耐量试验的 2 小时内<em class="ly">血浆葡萄糖浓度水平较高(无论这意味着什么)，导致患糖尿病的几率较高(由于红色)。</em></p><p id="529e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我计划在其他文章中更深入地讨论 SHAP，所以我在这里就不赘述了。让我们继续在测试集上进行模型评估。</p><h2 id="fd37" class="nn mm it bd mn nt nu dn mr nv nw dp mv kr nx ny mx kv nz oa mz kz ob oc nb od bi translated">模型评估和预测</h2><p id="d813" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">PyCaret 在加载时将数据分成训练和测试部分(70:30)，因此我们不必手动完成。</p><p id="ede2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在可以根据以前未见过的数据来评估模型:</p><pre class="lf lg lh li gt ni nj nk nl aw nm bi"><span id="65e2" class="nn mm it nj b gy no np l nq nr">predictions = predict_model(xgb)</span></pre><p id="a07f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上述代码会产生以下结果:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oi"><img src="../Images/45ce640f10949cfb088d1fb48e81d003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CPhbyXhYqmK8K4ptVDwwqw.png"/></div></div></figure><p id="b3fe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好了，现在当这个已经完成了，让我们看看如何保存和加载模型。</p><h2 id="b0f3" class="nn mm it bd mn nt nu dn mr nv nw dp mv kr nx ny mx kv nz oa mz kz ob oc nb od bi translated">模型保存和加载</h2><p id="43b6" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">在保存模型之前，我们需要完成它:</p><pre class="lf lg lh li gt ni nj nk nl aw nm bi"><span id="0cc9" class="nn mm it nj b gy no np l nq nr">finalize_model(xgb)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oj"><img src="../Images/03490a8013c7b5c29f4eed7106409fa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*83oCelVwFnRgDFMwm9dsyA.png"/></div></div></figure><p id="9f6b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">猜猜保存模型有多简单:</p><pre class="lf lg lh li gt ni nj nk nl aw nm bi"><span id="9a4c" class="nn mm it nj b gy no np l nq nr">save_model(xgb, ‘diabetes_xgboost’)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/c926e70307b4a7838430ba002cabcc93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*ffE7rMtctQjYKse99V3Txg.png"/></div></figure><p id="9756" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">模型以 pickle 格式保存。</p><p id="2637" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">尝试猜测加载已保存模型的函数的名称:</p><pre class="lf lg lh li gt ni nj nk nl aw nm bi"><span id="069d" class="nn mm it nj b gy no np l nq nr">model = load_model(‘diabetes_xgboost’)</span></pre><p id="5f9c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你准备再次使用它。</p><p id="0e8b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们今天已经讲了很多东西，所以让我们在下一部分总结一下。更多类似的文章即将发布，敬请关注。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="0499" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">结论</h1><p id="6c29" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">今天我们简要介绍了 PyCaret 所提供的内容。我的想法是把这个变成一个系列，既有基于文章的，也有基于视频的，并且更深入地覆盖这个库。</p><p id="935a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当使用像这样的库时，像 Scikit-Learn 这样的库很快就会成为过去。不是因为他们不好，而是这些人在各方面都很优秀。</p><p id="a8d9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望你喜欢它，并设法从中获得一些有用的东西。感谢阅读。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="7849" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ly">喜欢这篇文章吗？成为</em> <a class="ae lu" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="ly">中等会员</em> </a> <em class="ly">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="ol om gp gr on oo"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">通过我的推荐链接加入 Medium-Dario rade ci</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc lo oo"/></div></div></a></div></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="de0f" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">参考</h1><p id="e96c" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">[1]<a class="ae lu" href="https://pycaret.org" rel="noopener ugc nofollow" target="_blank">https://pycaret.org</a></p><p id="d43c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[2]<a class="ae lu" href="https://github.com/slundberg/shap" rel="noopener ugc nofollow" target="_blank">https://github.com/slundberg/shap</a></p></div></div>    
</body>
</html>