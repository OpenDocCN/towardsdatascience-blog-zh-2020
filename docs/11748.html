<html>
<head>
<title>Support Vector Machines and Regression Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">支持向量机和回归分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/support-vector-machines-and-regression-analysis-ad5d94ac857f?source=collection_archive---------22-----------------------#2020-08-14">https://towardsdatascience.com/support-vector-machines-and-regression-analysis-ad5d94ac857f?source=collection_archive---------22-----------------------#2020-08-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="df67" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何在回归问题中使用支持向量机</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4375382fe4aab495a4b2bae5ea6fb7d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tw5edUpl6IDnFGRWdNlwJw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:图片由作者创建—基于 Aurélien Géron 的“使用 Scikit-Learn 和 TensorFlow 进行机器学习”中的视觉模板</p></figure><p id="c288" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一个常见的误解是，支持向量机只在解决分类问题时有用。</p><p id="e2ca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用支持向量机解决回归问题的目的是定义一个如上图所示的超平面，并在该超平面内尽可能多地拟合实例，同时限制边界违规。</p><p id="41b2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以这种方式，以这种方式使用的 SVM 不同于分类任务，在分类任务中，目标是在两个单独的类之间拟合最大可能的超平面(同时还限制边界违反)。</p><p id="34c2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">事实上，支持向量机可以非常有效地处理回归建模。我们以酒店预订为例。</p><h1 id="b308" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">预测酒店顾客的平均每日房价</h1><p id="cb0c" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">假设我们正在构建一个回归模型来预测酒店预订的平均每日价格(或客户平均每日支付的价格)。模型由以下特征构成:</p><ul class=""><li id="dcd9" class="mr ms it la b lb lc le lf lh mt ll mu lp mv lt mw mx my mz bi translated">取消(无论客户是否取消预订)</li><li id="7712" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">原产国</li><li id="c621" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">细分市场</li><li id="6202" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">存款类型</li><li id="78bb" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">客户类型</li><li id="c215" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">所需的停车位</li><li id="701c" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">抵达周</li></ul><p id="a5a8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，还会为取消预订的客户填充 ADR 值—本例中的响应变量反映了如果客户继续预订将支付的 ADR。</p><p id="1c63" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Antonio、Almeida 和 Nunes (2016)的原始研究可从下面的参考资料部分获得。</p><h1 id="af40" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">模型结构</h1><p id="562a" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">使用如上所述的特征，在训练集(H1)上训练和验证 SVM 模型，将预测与测试集(H2)上的实际 ADR 值进行比较。</p><p id="5897" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该模型被训练如下:</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="3aff" class="nk lv it ng b gy nl nm l nn no">&gt;&gt;&gt; from sklearn.svm import LinearSVR<br/>&gt;&gt;&gt; svm_reg = LinearSVR(epsilon=1.5)<br/>&gt;&gt;&gt; svm_reg.fit(X_train, y_train)</span><span id="a85e" class="nk lv it ng b gy np nm l nn no">LinearSVR(C=1.0, dual=True, epsilon=1.5, fit_intercept=True,<br/>          intercept_scaling=1.0, loss='epsilon_insensitive', max_iter=1000,<br/>          random_state=None, tol=0.0001, verbose=0)</span><span id="ed0c" class="nk lv it ng b gy np nm l nn no">&gt;&gt;&gt; predictions = svm_reg.predict(X_val)<br/>&gt;&gt;&gt; predictions</span><span id="7a0a" class="nk lv it ng b gy np nm l nn no">array([100.75090575, 109.08222631,  79.81544167, ...,  94.50700112,<br/>        55.65495607,  65.5248653 ])</span></pre><p id="11f7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，对测试集中的特征使用相同的模型来生成预测的 ADR 值:</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="9dfa" class="nk lv it ng b gy nl nm l nn no">bpred = svm_reg.predict(atest)<br/>bpred</span></pre><p id="98a7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们在平均绝对误差(MAE)和均方根误差(RMSE)的基础上比较预测 ADR 和实际 ADR。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="db84" class="nk lv it ng b gy nl nm l nn no">&gt;&gt;&gt; mean_absolute_error(btest, bpred)<br/>29.50931462735928</span><span id="213b" class="nk lv it ng b gy np nm l nn no">&gt;&gt;&gt; print('mse (sklearn): ', mean_squared_error(btest,bpred))<br/>&gt;&gt;&gt; math.sqrt(mean_squared_error(btest, bpred))<br/>44.60420935095296</span></pre><p id="1eba" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，SVM 对额外训练实例的敏感度由<strong class="la iu">ε(ϵ)</strong>参数设置，即参数越高，额外训练实例对模型结果的影响越大。</p><p id="9e79" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这种情况下，使用了大幅度的<strong class="la iu"> 1.5 </strong>。以下是使用<strong class="la iu"> 0.5 </strong>裕量时的模型性能。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="cd28" class="nk lv it ng b gy nl nm l nn no">&gt;&gt;&gt; mean_absolute_error(btest, bpred)</span><span id="37cb" class="nk lv it ng b gy np nm l nn no">29.622491512816826</span><span id="743c" class="nk lv it ng b gy np nm l nn no">&gt;&gt;&gt; print('mse (sklearn): ', mean_squared_error(btest,bpred))<br/>&gt;&gt;&gt; math.sqrt(mean_squared_error(btest, bpred))</span><span id="2ba2" class="nk lv it ng b gy np nm l nn no">44.7963000500928</span></pre><p id="7e72" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以看到，通过修改<strong class="la iu"> ϵ </strong>参数，MAE 或 RMSE 参数实际上没有变化。</p><p id="8c23" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">也就是说，我们希望确保 SVM 模型不会过度拟合。具体来说，如果我们发现当<strong class="la iu"> ϵ = 0，</strong>时达到最佳拟合，那么这可能是模型过度拟合的迹象。</p><p id="1db4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是我们设置ϵ = 0 时的结果。</p><ul class=""><li id="1afa" class="mr ms it la b lb lc le lf lh mt ll mu lp mv lt mw mx my mz bi translated">美:31.86</li><li id="d248" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">RMSE:47.65 英镑</li></ul><p id="d940" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">鉴于当ϵ = 0 时，我们没有看到更高的精度，似乎没有任何证据表明过度拟合是我们模型中的一个问题——至少从这个角度看不是。</p><h1 id="b665" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">SVM 的性能与神经网络相比如何？</h1><p id="67fb" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">当使用相同的功能时，SVM 的性能精度与神经网络相比如何？</p><p id="be68" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">考虑以下神经网络配置:</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="90d0" class="nk lv it ng b gy nl nm l nn no">&gt;&gt;&gt; model = Sequential()<br/>&gt;&gt;&gt; model.add(Dense(8, input_dim=8, kernel_initializer='normal', activation='elu'))<br/>&gt;&gt;&gt; model.add(Dense(1669, activation='elu'))<br/>&gt;&gt;&gt; model.add(Dense(1, activation='linear'))<br/>&gt;&gt;&gt; model.summary()</span><span id="9319" class="nk lv it ng b gy np nm l nn no">Model: "sequential"<br/>_________________________________________________________________<br/>Layer (type)                 Output Shape              Param #   <br/>=================================================================<br/>dense (Dense)                (None, 8)                 72        <br/>_________________________________________________________________<br/>dense_1 (Dense)              (None, 1669)              15021     <br/>_________________________________________________________________<br/>dense_2 (Dense)              (None, 1)                 1670      <br/>=================================================================<br/>Total params: 16,763<br/>Trainable params: 16,763<br/>Non-trainable params: 0<br/>_________________________________________________________________</span></pre><p id="1ce7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">模型被训练跨越<strong class="la iu"> 30 </strong>个时期，批量大小为<strong class="la iu"> 150 </strong>:</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="90c0" class="nk lv it ng b gy nl nm l nn no">&gt;&gt;&gt; model.compile(loss='mse', optimizer='adam', metrics=['mse','mae'])<br/>&gt;&gt;&gt; history=model.fit(X_train, y_train, epochs=30, batch_size=150,  verbose=1, validation_split=0.2)<br/>&gt;&gt;&gt; predictions = model.predict(X_test)</span></pre><p id="7c8d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在测试集上获得了以下 MAE 和 RMSE:</p><ul class=""><li id="de76" class="mr ms it la b lb lc le lf lh mt ll mu lp mv lt mw mx my mz bi translated"><strong class="la iu">梅:</strong> 29.89</li><li id="dacc" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">RMSE:43.91 美元</li></ul><p id="afef" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们观察到，当 SVM 模型的ϵ <strong class="la iu"> </strong>设置为<strong class="la iu"> 1.5 </strong>时，MAE 和 RMSE 分别为 29.5 和 44.6。在这点上，SVM 在测试集上的预测精度与神经网络相当。</p><h1 id="ca9c" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">结论</h1><p id="7b56" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">一个常见的误解是，支持向量机只适合处理分类数据。</p><p id="9f33" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，我们在这个例子中已经看到，SVM 模型在预测神经网络的 ADR 值方面非常有效。</p><p id="ec23" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">非常感谢您的阅读，并感谢任何问题或反馈。</p><p id="5917" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本例的 Jupyter 笔记本和数据集可在<a class="ae nq" href="https://github.com/MGCodesandStats/hotel-cancellations" rel="noopener ugc nofollow" target="_blank"> MGCodesandStats GitHub 存储库</a>获得。其他相关参考资料如下。</p><p id="b564" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="nr">免责声明:本文是在“原样”的基础上编写的，没有任何担保。本文旨在提供数据科学概念的概述，不应以任何方式解释为专业建议。</em></p><h1 id="83f0" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">参考</h1><ul class=""><li id="6887" class="mr ms it la b lb mm le mn lh ns ll nt lp nu lt mw mx my mz bi translated"><a class="ae nq" href="https://www.sciencedirect.com/science/article/pii/S2352340918315191" rel="noopener ugc nofollow" target="_blank">安东尼奥、阿尔梅达、努内斯。酒店预订需求数据集</a></li><li id="468b" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated">Aurélien Géron:使用 Scikit-Learn 和 TensorFlow 进行机器学习</li><li id="9ac5" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><a class="ae nq" href="https://www.researchgate.net/post/What_is_the_problem_with_epsilon0_in_regression_problems_with_Support_Vector_Regression2" rel="noopener ugc nofollow" target="_blank"> ResearchGate:支持向量回归的回归问题中ε= 0 有什么问题？</a></li><li id="f58e" class="mr ms it la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><a class="ae nq" rel="noopener" target="_blank" href="/regression-based-neural-networks-with-tensorflow-v2-0-predicting-average-daily-rates-e20fffa7ac9a">走向数据科学:基于回归的神经网络——预测酒店的平均日房价</a></li></ul></div></div>    
</body>
</html>