<html>
<head>
<title>Computing Mass Properties of Ansys Dynamic Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">计算 Ansys 动力学模型的质量特性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/computing-mass-properties-of-ansys-dynamic-models-f0d8dacb2d7c?source=collection_archive---------19-----------------------#2020-06-25">https://towardsdatascience.com/computing-mass-properties-of-ansys-dynamic-models-f0d8dacb2d7c?source=collection_archive---------19-----------------------#2020-06-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8a9c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用 MAPDL 命令计算任意坐标系质量特性的方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c00d6304965dbe213aac68ed8177edba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oHv2xX-wSX_vnf05QvMTlA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">群众要紧！(鸣谢:<a class="ae kv" href="https://pixabay.com/photos/number-vintage-scale-toledo-green-1943293/" rel="noopener ugc nofollow" target="_blank"> xibarodays </a>上 Pixaby)</p></figure><p id="2160" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://www.ansys.com/" rel="noopener ugc nofollow" target="_blank"> Ansys </a>是一个商用有限元分析(FEA)软件包。虽然 Ansys 已经获得并集成了许多不同的分析工具，但是它的隐式结构包是健壮的并且得到了很好的支持。Ansys 的隐式结构求解器的一个独特功能是能够使用简单的逗号分隔的 MAPDL 命令编写命令。无论是使用 Ansys 经典接口还是通过 Workbench 接口使用现代 Ansys Mechanical，MAPDL 对于预处理模型和/或后处理结果都非常有用。本文介绍了一些 MAPDL 命令，用于提取关于用户定义坐标系的模型整体或部分的质量属性。</p><p id="921f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">执行动态有限元分析时，验证质量是一个重要步骤。毕竟这是等式的一半！对于三维实体模型，质量是非常微不足道的。但是，在动态模型中，元件通常表示为壳、梁和/或弹簧。此外，动态模型通常包含非结构质量，如<code class="fe ls lt lu lv b">SURF154</code>表面元素和点质量元素。验证质量可能变得不简单。</p><p id="5e5b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在切换到 Ansys Mechanical 之前的黑暗时代，我会严重依赖 MAPDL 文本文件来定义所有的材料属性和元素类型数据。我会尝试对这些属性进行分组或者控制它们的编号(通常在电子表格中)，这样我就可以根据我的意图检查 solve.out 文件中的元素类型批量输出列表。如果动态表示与组件质量(通常从 CAD 获得)不匹配，我会将“质量系数”应用于密度，然后冲洗并重复，直到单个元素类型质量和总质量与预期值匹配。虽然这种方法有效，但有点麻烦，而且没有给我我有时想要的良好控制。</p><p id="b3b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我现在几乎只使用 Ansys 机械应用程序进行预处理。在 Mechanical 中，你可以点击单个物体，从属性窗口中获得质量(无需求解！)或使用选择工具获取多个选定实体的体量，非结构体量的存在会带来一些挑战。使用 Ansys Mechanical，我们放弃了属性编号控制，以换取一系列易于使用的功能。您可以使用选择工具获得一些有限的信息，但同样，我们错过了非结构质量和惯性质量属性。</p><p id="3c19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些年来，我从谢尔登·今冈的/合作解决方案、nsys.net 以及 PADT 主办的 xansys 论坛(看起来并不活跃)中得到一些提示。因此，站在巨人的肩膀上，我创建了一个锅炉板 MAPDL 脚本，它使用组件对模型的各个部分进行分组，并写出一个 csv 摘要文件，然后我可以将它复制/粘贴到电子表格中进行额外的验证。它提供的主要优势是:</p><ul class=""><li id="3de3" class="lw lx iq ky b kz la lc ld lf ly lj lz ln ma lr mb mc md me bi translated">使用组件对模型的任意部分进行分组</li><li id="84c9" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">获取任意坐标系的部分模型质量属性(包括转动惯量)</li><li id="065b" class="lw lx iq ky b kz mf lc mg lf mh lj mi ln mj lr mb mc md me bi translated">专门用于质量属性摘要的格式化输出文件</li></ul><p id="356c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/shkiefer/MAPDL-Medium/tree/master/Mass" rel="noopener ugc nofollow" target="_blank">这里有一个 github 存储库</a>，它包含了几个版本的 MAPDL 脚本文件和一个包含它们的示例工作台项目档案。让我们来看看重要的部分！</p><h1 id="830a" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">关于用户定义坐标系的模型的质量属性</h1><p id="e8a2" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf ne lh li lj nf ll lm ln ng lp lq lr ij bi translated">虽然我们可以将模型转换到感兴趣的坐标系，运行分析，并从<code class="fe ls lt lu lv b">solve.out</code>文件中读取属性，但这并不总是理想的。注意:我们不能使用<code class="fe ls lt lu lv b">CSYS</code>或<code class="fe ls lt lu lv b">RSYS</code>命令来强制 Ansys 分析不同坐标系的质量。</p><p id="63e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://github.com/shkiefer/MAPDL-Medium/blob/master/Mass/MAPDL-mass_total_model.txt" rel="noopener ugc nofollow" target="_blank">这里有一个脚本</a>，它计算关于用户定义的坐标系的整个模型的质量属性。我们走一遍吧！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="5784" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的部分中，我们确保用<code class="fe ls lt lu lv b">ALLSEL</code>选择了一切，然后将我们的坐标系 id 分配给<code class="fe ls lt lu lv b">cs_mass</code>参数。<code class="fe ls lt lu lv b">my_cs</code>如果使用手动编号控制(或 Ansys Classic ),可以是一个整数，也可以是坐标系属性卡上定义的“APDL 名称”。我们<code class="fe ls lt lu lv b">*GET</code>坐标系的位置和欧拉角。注意变量替换语法(<code class="fe ls lt lu lv b">%var_name%</code>)的使用将在执行时用变量值填充字符串或命令的该部分。这在这里并不重要，但以后会有帮助。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="2392" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下一节中，我们进入<code class="fe ls lt lu lv b">/sol</code>模块并运行魔法命令(<code class="fe ls lt lu lv b">IRLF</code>、&amp; <code class="fe ls lt lu lv b">PSOLVE</code>)，这些命令形成元素矩阵，因此我们可以获得质量属性，但不会运行模型的完整解。同样，这对于整个模型的质量属性来说并不完全必要，但是我们稍后会用到它。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="80b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们开始一些计算！在上面的部分中，我们将惯性属性从重心(CG)转换到坐标系的位置。然后，我们创建一个 APDL 2D 数组，并将其填充为惯性张量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="5f2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们建立转换矩阵，并将其分配给一个 APDL 2D 数组。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="1554" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在来看一些有趣的东西。为了将一些线性代数命令用于矩阵乘法，我们需要将 APDL 数组移到“APDL 数学”空间。我们用<code class="fe ls lt lu lv b">*DMAT</code>命令来做这件事。在“APDL 数学”中，我们用适当的转置执行矩阵乘法，最后用<code class="fe ls lt lu lv b">*EXPORT</code>命令将结果从 APDL 数学空间复制回 APDL。接下来，我们将质量属性分配给以<code class="fe ls lt lu lv b">my_</code>开头的变量，这是默认前缀，Mechanical 会查找该前缀以将参数值打印到命令片段属性卡。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/0c41f86a80f46e3387cb14613364dc60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KAotPg3OdcLojfz1F-vXCw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">关于从全局 CS 旋转的 CS 计算质量属性</p></figure><h1 id="485e" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">关于唯一坐标系的多个分量的质量性质</h1><p id="7005" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf ne lh li lj nf ll lm ln ng lp lq lr ij bi translated">虽然获得整个模型在任意坐标系下的质量属性很好，但这并不是特别有用。这里，我们将扩展上面的命令，向一些数组添加组件，定义一个<code class="fe ls lt lu lv b">*DO</code>循环，并使用<code class="fe ls lt lu lv b">*VWRITE</code>命令将格式化的输出写入一个文本文件。<a class="ae kv" href="https://github.com/shkiefer/MAPDL-Medium/blob/master/Mass/MAPDL-mass_by_component.txt" rel="noopener ugc nofollow" target="_blank">这是基于组件的质量属性的完整文件</a>，我将在下面一一介绍。</p><p id="002e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们开始将模型分成我们想要计算质量属性的<em class="nk">部分</em>。如果使用 Ansys Mechanical 应用程序<em class="nk">，命名选择</em>将作为具有相同名称<em class="nk">的<em class="nk">组件</em>发送到解算器。</em>一个警告是，Mechanical 允许命名选择的名称中有空格，但解算器不允许。最好在 N 个命名选择的名称中避免空格。组件可以包含节点或元素，但不能同时包含两者。对于质量属性，我们希望使用基于元素的组件。通常，当选择模型的任何部分作为质量属性时，我们还希望这些实体上有非结构质量。Ansys 使用与底层结构元素共享相同节点的<code class="fe ls lt lu lv b">SURF154</code>元素添加分布式非结构质量，但不添加任何刚度。我认为这比将非结构性体量与一处房产捆绑在一起要灵活得多。下面的代码片段确保 C <em class="nk">组件</em>中的元素节点上的任何<code class="fe ls lt lu lv b">SURF154</code>元素都被添加到 C <em class="nk">组件</em>中。对于每个<em class="nk">命名的选择，它可以重复。</em></p><pre class="kg kh ki kj gt nl lv nm nn aw no bi"><span id="9907" class="np ml iq lv b gy nq nr l ns nt">cmsel,s,my_named_selection<br/>nsle,s <br/>esln,1 <br/>cm,my_named_selection,elem</span></pre><p id="157b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以类似的方式，我们可以通过使用<em class="nk">远程点上的 P <em class="nk"> ilot 节点 APDL 名称</em>属性，创建一个附加到<em class="nk">远程点</em>的<em class="nk">点质量</em>元素的组件。</em>下面我们创建一个组件，它包括单节点质量元素，通过选择连接到远程点的引导节点的所有元素，这些元素完全由该节点定义。</p><pre class="kg kh ki kj gt nl lv nm nn aw no bi"><span id="a4d5" class="np ml iq lv b gy nq nr l ns nt">nsel,s,node,,my_rp_name<br/>esln,1<br/>cm,my_pm_component,elem</span></pre><p id="7888" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们已经根据需要创建并扩充了所有构件，以包括非结构体量元素，我们可以继续下一步。下面的命令设置我们将用于文件名的 f_name 参数，并初始化两个数组。一个数组用于组件名称字符串，另一个数组用于分配给坐标系 id 的变量字符串。这样，我可以保持大部分脚本的通用性，并在每次使用时修改这个数组。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="439a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我初始化输出文件。<code class="fe ls lt lu lv b">%_wb_userfiles_dir(1)%</code>被替换为工作台项目目录中项目<em class="nk"> user_files </em>文件夹的绝对路径，而<code class="fe ls lt lu lv b">%f_name%</code> <strong class="ky ir"> </strong>被替换为上面我们分配给<code class="fe ls lt lu lv b">f_name</code>参数的字符串。然后，我使用<code class="fe ls lt lu lv b">*VWRITE</code>将标题写入文件。我初始化了一个临时输出数组<code class="fe ls lt lu lv b">outVars</code>,并告诉 Ansys 使用一个新的文件名来将这个输出与结构分析输出分开。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="34e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们进入组件循环，与总模型情况一样，我们从获取该组件坐标系的属性(位置和角度)开始。唯一的区别是使用了<code class="fe ls lt lu lv b">%css(1,j)%</code>来获取参数值，该参数值是使用变量的名称和坐标系 ID 作为值来分配的。然后，我们只选择感兴趣的组件中的元素和相关的节点，并发出<code class="fe ls lt lu lv b">IRLF </code>和<code class="fe ls lt lu lv b">PSOLVE</code>命令。这些命令的美妙之处在于，Ansys 不必执行完整的求解来获得每个组件的质量属性。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="f19a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下一组命令与通过<code class="fe ls lt lu lv b">*EXPORT </code>命令将惯性张量从重心转换到坐标系的总模型情况完全相同，此时我们将旋转张量带回 APDL 2D 阵列。唯一的区别是我们在圈内。这里就不赘述了。</p><p id="cf15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们不再将质量属性赋给以<code class="fe ls lt lu lv b">my_</code>前缀开头的变量，而是将它们赋给<code class="fe ls lt lu lv b">outVars</code>数组。然后我们退出循环并<code class="fe ls lt lu lv b">*vwrite</code>我们的组件名称、坐标系变量名和每个组件的质量属性。然后用<code class="fe ls lt lu lv b">*cfclos</code>关闭文件，返回默认文件名和后处理器。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="5759" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是输出文件中的一个示例:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="e50e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我通常把包含这些命令的命令片段放在机械模型树的<em class="nk">解</em>对象中，作为后处理步骤。一旦求解完成，您应该在项目目录的<em class="nk"> user_files </em>文件夹中找到一个<code class="fe ls lt lu lv b">my_mass.txt</code>文件。</p><p id="70f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样！查看<a class="ae kv" href="https://github.com/shkiefer/MAPDL-Medium/tree/master/Mass" rel="noopener ugc nofollow" target="_blank"> github 资源库</a>中的命令片段、一个示例输出文件和一个非常简单的工作台归档文件(2020 版 R1 ),其中包含了使用这些命令片段的两个系统。我希望这对你在 Ansys 中的动态建模/大规模验证冒险有所帮助！</p><p id="db8f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">查看其他与 Ansys MAPDL 相关的文章:</p><div class="nu nv gp gr nw nx"><a href="https://medium.com/@steve.kiefer/ansys-mechanical-all-about-joints-173f1fa40e15" rel="noopener follow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ir gy z fp oc fr fs od fu fw ip bi translated">Ansys Mechanical:关于接头的一切</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">用 MAPDL 定义和后处理关节</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">medium.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol kp nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://medium.com/@steve.kiefer/energize-your-ansys-dynamic-mechanical-analyses-b94c58da9a30" rel="noopener follow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ir gy z fp oc fr fs od fu fw ip bi translated">激活您的 Ansys 动态和机械分析</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">利用 MAPDL 命令在 Ansys Mechanical 中对模态有效质量和势能进行后处理</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">medium.com</p></div></div><div class="og l"><div class="om l oi oj ok og ol kp nx"/></div></div></a></div></div></div>    
</body>
</html>