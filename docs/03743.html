<html>
<head>
<title>Merging Dictionaries in Python 3.9</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Python 3.9 中合并字典</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/merging-dictionaries-in-python-3-9-3b0409aa91a8?source=collection_archive---------2-----------------------#2020-04-08">https://towardsdatascience.com/merging-dictionaries-in-python-3-9-3b0409aa91a8?source=collection_archive---------2-----------------------#2020-04-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="02d6" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">Python 初学者</h2><div class=""/><div class=""><h2 id="da31" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">语法简洁的 Python 字典</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/f030172680f6caf740dff9ff06ce4fa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*N_flBOSqzHtpJ5SP"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">丹尼尔·科内斯基在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="61d6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Python 3.9 中有一个<em class="me">改变游戏规则的</em>新特性，允许你在处理 Python <strong class="lk jd">字典</strong>的同时，编写更多<strong class="lk jd">可读</strong>和<strong class="lk jd">紧凑</strong>代码。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="fd7e" class="mm mn it bd mo mp mq dn mr ms mt dp mu lr mv mw mx lv my mz na lz nb nc nd iz bi translated">Python 版本</h2><p id="42f6" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr ng lt lu lv nh lx ly lz ni mb mc md im bi translated">你现在用的是哪个版本的 Python？3.7?3.5?还是还是 2.7？上次我们介绍了 Python 3.8  中的 6 个新特性，即使是初学者也应该注意。如果你还没有读过这篇文章，可以去看看。</p><div class="nj nk gp gr nl nm"><a rel="noopener follow" target="_blank" href="/6-new-features-in-python-3-8-for-python-newbies-dc2e7b804acc"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd jd gy z fp nr fr fs ns fu fw jc bi translated">Python 3.8 中针对 Python 新手的 6 项新特性</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">请做好准备，因为 Python 2 不再受支持</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">towardsdatascience.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa lb nm"/></div></div></a></div><p id="1c95" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Python 3.9 现在正处于开发的 alpha 阶段，许多新特性已经被提出并被接受！它将在 2020 年 5 月进入测试阶段，届时将不会提出任何新功能。</p><p id="955e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">第一个稳定版本将于 2020 年 10 月发布。你可以在这里找到发布时间表<a class="ae lh" href="https://www.python.org/dev/peps/pep-0596/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="c023" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有一个新功能涉及字典。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="bda5" class="mm mn it bd mo mp mq dn mr ms mt dp mu lr mv mw mx lv my mz na lz nb nc nd iz bi translated">Python 词典</h2><p id="1554" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr ng lt lu lv nh lx ly lz ni mb mc md im bi translated">Dictionary 是 Python 中一个非常独特的数据结构。一个字典<strong class="lk jd">包含多个元素</strong>，每个元素是一个<strong class="lk jd">键-值对</strong>。例如，让我们用两个元素初始化一个字典<code class="fe ob oc od oe b">d1</code>。关键字<code class="fe ob oc od oe b">'name'</code>的值为<code class="fe ob oc od oe b">'Tom'</code>，而关键字<code class="fe ob oc od oe b">'age'</code>的值为 20。</p><pre class="ks kt ku kv gt of oe og oh aw oi bi"><span id="a301" class="mm mn it oe b gy oj ok l ol om">d1 = {'name': 'Tom', 'age': 20}</span></pre><p id="5523" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们现在有一本存储 20 岁的汤姆的信息的字典。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/199dcfac1b070075e46e58ff6b704ed0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g_poEZ83NGx4G7VZ"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@romanleandro?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Roman Bürki </a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="08c5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">假设出于某种原因，你收集了更多关于汤姆的信息，比如他的平均绩点和婚姻状况。你现在有了另一本叫做<code class="fe ob oc od oe b">d2</code>的字典。</p><pre class="ks kt ku kv gt of oe og oh aw oi bi"><span id="df82" class="mm mn it oe b gy oj ok l ol om">d2 = {'gpa': 4.0, 'is_single': True}</span></pre><p id="c93d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您希望将这两本词典合并在一起，因为它们都包含关于同一个人 Tom 的不同信息。</p><p id="1749" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">问题是— <strong class="lk jd">如何用 Python 合并两个字典？</strong></p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="957b" class="mm mn it bd mo mp mq dn mr ms mt dp mu lr mv mw mx lv my mz na lz nb nc nd iz bi translated">1.笨拙的方式</h2><p id="5fb8" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr ng lt lu lv nh lx ly lz ni mb mc md im bi translated">您可以使用带有语法<code class="fe ob oc od oe b">dict_name[key]= value</code>的赋值操作符<code class="fe ob oc od oe b">=</code>在现有字典中插入一个新元素。</p><pre class="ks kt ku kv gt of oe og oh aw oi bi"><span id="60c1" class="mm mn it oe b gy oj ok l ol om">d1 = {'name': 'Tom', 'age': 20}<br/>d1['sex'] = 'Male'</span><span id="0299" class="mm mn it oe b gy oo ok l ol om"># d1 == {'name': 'Tom', 'age': 20, 'sex': 'Male'}</span></pre><p id="a0a1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，在不使用任何特定于字典的方法的情况下，想到的第一个方法是编写一个<strong class="lk jd"> for-loop </strong>，使用<strong class="lk jd"> iterable </strong> <code class="fe ob oc od oe b">.items()</code>遍历每个键值对，然后将键值对插入新字典<code class="fe ob oc od oe b">dnew</code>。</p><pre class="ks kt ku kv gt of oe og oh aw oi bi"><span id="81e8" class="mm mn it oe b gy oj ok l ol om">d1 = {'name': 'Tom', 'age': 20}<br/>d2 = {'gpa': 4.0, 'is_single': True}<br/>dnew = dict()</span><span id="314d" class="mm mn it oe b gy oo ok l ol om">for key, value in d1.items():<br/>    dnew[key] = value<br/>for key, value in d2.items():<br/>    dnew[key] = value</span><span id="1c76" class="mm mn it oe b gy oo ok l ol om"># dnew == {'name': 'Tom', 'age': 20, 'gpa': 4.0, 'is_single': True}</span></pre><p id="a9a1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">尽管如此，合并字典应该是非常简单和直接的事情，并且应该在一行代码中完成。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/6dce1a4468d357ff906b17d9b60324a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Sj0m94I1KsIk2aqT"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@hishahadat?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">沙哈达特·拉赫曼</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="53b0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以做得更好。好多了。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="8c28" class="mm mn it bd mo mp mq dn mr ms mt dp mu lr mv mw mx lv my mz na lz nb nc nd iz bi translated">2.默认方式</h2><p id="8f0c" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr ng lt lu lv nh lx ly lz ni mb mc md im bi translated">实际上有一个<strong class="lk jd">内置的</strong>方法，可以用另一个词典<code class="fe ob oc od oe b">d2</code>来‘更新’一个词典<code class="fe ob oc od oe b">d1</code>。</p><pre class="ks kt ku kv gt of oe og oh aw oi bi"><span id="478b" class="mm mn it oe b gy oj ok l ol om">dnew = d1.copy()<br/>dnew.update(d2)</span></pre><p id="7a3c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一个缺点是<code class="fe ob oc od oe b">.update()</code>就地修改了字典<strong class="lk jd"/>。您需要首先通过复制<code class="fe ob oc od oe b">d1</code>来创建一个新的字典<code class="fe ob oc od oe b">dnew</code>。这种“内置”方法违背了使用方便的内置方法合并词典的目的。</p><p id="c2cd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们能在一行代码中完成合并吗？是啊！</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="3150" class="mm mn it bd mo mp mq dn mr ms mt dp mu lr mv mw mx lv my mz na lz nb nc nd iz bi translated">3.“整洁”的方式</h2><p id="e4d5" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr ng lt lu lv nh lx ly lz ni mb mc md im bi translated">Python 从 3.5+版本开始支持字典解包<code class="fe ob oc od oe b">**</code>。您可以通过解包两个字典的元素来创建一个新的“合并”字典。</p><pre class="ks kt ku kv gt of oe og oh aw oi bi"><span id="81bd" class="mm mn it oe b gy oj ok l ol om">dnew = {**d1, **d2}</span></pre><p id="4041" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这种解包方法成为从 Python 3.5+合并字典的事实方法。然而，这种语法对你们中的一些人来说可能很难看，对我们大多数人来说肯定不直观。第一次看到它时，你能猜出它的意思吗？</p><p id="9231" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">还有另一种简洁的方法可以在一行中实现字典合并。它看起来也不直观。</p><pre class="ks kt ku kv gt of oe og oh aw oi bi"><span id="8b00" class="mm mn it oe b gy oj ok l ol om">dnew = dict(d1, **d2)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oq"><img src="../Images/2e8f780a691e9fdde28382947d444563.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*REZOU68LSG4OIr37"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@masjidmpd?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">普贡达兰干清真寺</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="5383" class="or mn it bd mo os ot ou mr ov ow ox mu ki oy kj mx kl oz km na ko pa kp nd pb bi translated">Python 3.9 中的简洁方式</h1><p id="2294" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr ng lt lu lv nh lx ly lz ni mb mc md im bi translated">Python 3.9 引入了新的<strong class="lk jd">和干净的</strong>(!)使用<strong class="lk jd">联合运算符</strong> <code class="fe ob oc od oe b">|</code>合并字典的方法。相当整洁。</p><pre class="ks kt ku kv gt of oe og oh aw oi bi"><span id="1c56" class="mm mn it oe b gy oj ok l ol om">dnew = d1 | d2</span><span id="77ad" class="mm mn it oe b gy oo ok l ol om"># dnew == {'name': 'Tom', 'age': 20, 'gpa': 4.0, 'is_single': True}</span></pre><p id="960b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这个 union 操作符实际上在 Python 中并不新鲜。它可用于“合并”两个集合。一个<strong class="lk jd">集合</strong>是一个<strong class="lk jd">无序且未索引的集合</strong>，也是用花括号写的。</p><pre class="ks kt ku kv gt of oe og oh aw oi bi"><span id="0814" class="mm mn it oe b gy oj ok l ol om">a = {1, 2, 3}<br/>b = {3, 4, 5}<br/>print( a | b )<br/># {1, 2, 3, 4, 5}</span></pre><h2 id="85c9" class="mm mn it bd mo mp mq dn mr ms mt dp mu lr mv mw mx lv my mz na lz nb nc nd iz bi translated">扩充赋值</h2><p id="de23" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr ng lt lu lv nh lx ly lz ni mb mc md im bi translated">对于两个列表或两个值<code class="fe ob oc od oe b">a</code>和<code class="fe ob oc od oe b">b</code> , <code class="fe ob oc od oe b">a += b</code>是<code class="fe ob oc od oe b">a = a+b</code>的简称。</p><p id="a37c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这种<strong class="lk jd">增强的赋值行为</strong>也适用于字典联合操作符。这意味着<code class="fe ob oc od oe b">d1 |= d2</code>相当于<code class="fe ob oc od oe b">d1 = d1 | d2</code>。</p><h2 id="1348" class="mm mn it bd mo mp mq dn mr ms mt dp mu lr mv mw mx lv my mz na lz nb nc nd iz bi translated">警告</h2><p id="a0ff" class="pw-post-body-paragraph li lj it lk b ll ne kd ln lo nf kg lq lr ng lt lu lv nh lx ly lz ni mb mc md im bi translated">集合是无序的。字典是<strong class="lk jd">插入有序的</strong>(来自 Python 3.6)。换句话说，词典<strong class="lk jd"> <em class="me">记住了</em> </strong>插入条目的顺序。</p><p id="a455" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这意味着字典联合是不可交换的 T21。这意味着<code class="fe ob oc od oe b">d1 | d2</code>和<code class="fe ob oc od oe b">d2 | d1</code>将会产生具有不同项目<strong class="lk jd">顺序</strong>的合并字典。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><p id="ff37" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">感谢您的阅读！Python 3.9 中还有其他新特性，包括对<strong class="lk jd">变量注释</strong>的更新。不知道那是什么？查看以下关于<strong class="lk jd">静态类型</strong>和注释的文章。</p><div class="nj nk gp gr nl nm"><a rel="noopener follow" target="_blank" href="/static-typing-in-python-55aa6dfe61b4"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd jd gy z fp nr fr fs ns fu fw jc bi translated">Python 中的静态类型</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">轻松进行类型检查</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">towardsdatascience.com</p></div></div><div class="nv l"><div class="pc l nx ny nz nv oa lb nm"/></div></div></a></div><p id="21dc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果您想收到我的新文章的更新，您可以使用下面的滑块订阅我的时事通讯:</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pd pe l"/></div></figure><p id="af91" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果您对 Python 感兴趣，以下文章可能会有用:</p><div class="nj nk gp gr nl nm"><a rel="noopener follow" target="_blank" href="/5-python-features-i-wish-i-had-known-earlier-bc16e4a13bf4"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd jd gy z fp nr fr fs ns fu fw jc bi translated">我希望我能早点知道的 5 个 Python 特性</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">超越 lambda、map 和 filter 的 Python 技巧</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">towardsdatascience.com</p></div></div><div class="nv l"><div class="pf l nx ny nz nv oa lb nm"/></div></div></a></div><div class="nj nk gp gr nl nm"><a rel="noopener follow" target="_blank" href="/4-common-mistakes-python-beginners-should-avoid-89bcebd2c628"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd jd gy z fp nr fr fs ns fu fw jc bi translated">Python 初学者应该避免的 4 个常见错误</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">我很艰难地学会了，但你不需要</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">towardsdatascience.com</p></div></div><div class="nv l"><div class="pg l nx ny nz nv oa lb nm"/></div></div></a></div><p id="45c9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">快乐编码！</em></p></div></div>    
</body>
</html>