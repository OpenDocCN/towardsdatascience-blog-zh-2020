<html>
<head>
<title>Calculate The Economic Impact Of Your Click-Through Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">计算你的点击预测的经济影响</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/calculate-the-economic-impact-of-your-click-through-prediction-1fa6eee64494?source=collection_archive---------37-----------------------#2020-04-09">https://towardsdatascience.com/calculate-the-economic-impact-of-your-click-through-prediction-1fa6eee64494?source=collection_archive---------37-----------------------#2020-04-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5543" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">超越准确性、AUC或Lift:一个衡量经济影响的模型</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/377d1fb8698ea28a6022145160da51fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ym_7wmwQcxL7zwnVfLHbiQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时代广场由安东尼·罗塞特在Unsplash拍摄</p></figure><p id="dde9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在<a class="ae ky" href="https://www.ie.edu/exponential-learning/programs/data-science-bootcamp/" rel="noopener ugc nofollow" target="_blank"><em class="lv">IE data science boot camp</em></a><em class="lv">学习期间，我和m </em> y团队为一家拥有2800万MAU的公司做了一个点击率预测，以<strong class="lb iu">改善公司</strong>的广告分配。在IE，他们明确强调了三个领域的重要性，即数学、编程和商业，数据科学家需要努力成功应对数据挑战。</p><p id="e036" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的挑战是点击率预测。在互联网上，尤其是在这个博客里，有很多关于如何解决这个问题的内容。但是，它为什么重要呢？<strong class="lb iu">为什么需要预测横幅广告的用户点击量？</strong>你的模型什么时候值得？你的业务收入能提高多少？我们花了一半的时间来了解业务问题，并想办法评估我们不同模式的收入改善情况。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/d5234576f36aea979efbdf9621124504.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9MwQY1MtVV-xLbC7Il-JrQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们在IE DS训练营的顶点项目</p></figure><p id="7c72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这不是另一篇关于如何通过预测进行点击的文章(<a class="ae ky" href="https://github.com/myrthings/click-prediction" rel="noopener ugc nofollow" target="_blank">这里</a>如果你感兴趣，你可以得到我们的完整过程代码)，<strong class="lb iu">这是一篇关于为什么这个问题是值得的，以及我们如何计算收入提高的文章。</strong></p><p id="aa44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">开始吧！</p><h1 id="e3b0" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">问题是</h1><p id="3eb7" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">程序化广告是在线买卖广告的自动化交易。广告在网站上用横幅广告展示，其<strong class="lb iu">表现用CTR(点击率)</strong>来衡量:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/54cf597e8b73c79c07bdb4403713e020.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/format:webp/1*15HadVI2AJ2TEbJ_Cac2uA.png"/></div></figure><p id="7f1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">广告的点击率通常很低。如果是1%,这意味着每100个接触过广告的访问者中只有1个点击了那个广告。</p><p id="64f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们公司60%的收入来自网站横幅广告。挑战在于尽可能地增加收入。横幅持有者根据点击量和印象数获得报酬——当用户看到横幅但没有点击时。横幅广告的盈利方式是在广告拍卖中出售，广告商为这些横幅广告出价。有很多拍卖提供商。在我们的例子中，该公司了解其更普通的用户，他们有一个为他们提供广告的付费提供商。这些广告给他们带来了更多的收入，但他们受到限制，因为他们需要事先与供应商谈判。</p><p id="3baf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象一下，广告每月限量1000万个。或者限制在一个月正常网站流量的30%。我们将分配30%的广告给一个优质供应商，其余70%给一个标准供应商。但是，怎么做呢？我们如何优化分配以增加收入？这是我们的挑战。</p><p id="f6c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目标是训练一个设定用户点击广告概率的模型。然后，我们将对这些概率进行排序，我们将只向概率最高的30%的用户显示优质广告，而对于其余70%的用户，我们将显示标准广告。我们模型的性能将用<a class="ae ky" href="https://en.wikipedia.org/wiki/Lift_(data_mining)" rel="noopener ugc nofollow" target="_blank">升力</a>来衡量。</p><p id="ecd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个群体的提升是这个群体比平均水平好或差多少倍:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/be1965aafcc182c4f341a7326addcb96.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/format:webp/1*luRgQFB8sCdtEUzf0xUiBQ.png"/></div></figure><p id="1523" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中<em class="lv"> i </em>是十分位数或组数。然后，我们将计算<strong class="lb iu">使用我们的模型可以提高多少收入</strong>，并与没有任何模型进行比较。</p><h1 id="4328" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">选择最佳ML模型</h1><p id="c92a" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">对于挑战，我们有<strong class="lb iu">两个各100万印象的数据集</strong>，这是2019年10月和11月流量的样本。数据来自一种谷歌分析引擎，我们只有10个非个人信息的特征。他们是:</p><ul class=""><li id="52af" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated">行的唯一标识符。<em class="lv">字符串。</em></li><li id="d6fe" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">横幅的名称。<em class="lv">字符串。</em></li><li id="a7d0" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">服务器的日期。<em class="lv">对象。</em></li><li id="b929" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">服务器的时间。<em class="lv">对象。</em></li><li id="a19d" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">印象之国。<em class="lv">弦。</em></li><li id="7aa1" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">印象网站(来自英国的用户可以看到。es网站的扩展)。<em class="lv">弦。</em></li><li id="0397" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">印象的运作系统。<em class="lv">弦。</em></li><li id="441d" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">浏览器:用于印象的浏览器。<em class="lv">弦。</em></li><li id="c2af" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">RefererURL:点击横幅时，此人在网站的哪个部分。字符串。</li><li id="4e46" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated">点击:是否点击了横幅。<em class="lv">二进制整型。</em></li></ul><p id="8872" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们做了大量的可视化工作，然后通过特征工程来提高模型的性能。如果你想看看我们到底做了什么，这里有所有的代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/44f5087b730f4ca40898df23fae58aa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*Z3JkKPFn9_kYBut7ekxnpg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的数据框架的负责人在数据之后，即数据争论、数据清理和特征工程</p></figure><p id="c17e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">然后，我们拟合9种不同的算法，并使用</strong> <a class="ae ky" rel="noopener" target="_blank" href="/understanding-auc-roc-curve-68b2303cc9c5"> <strong class="lb iu"> AUC </strong> </a>对它们进行基准测试。我们选择AUC来评估我们的模型，因为我们需要很好地预测1和0——点击或未点击。这是因为与我们的优质提供商相比，我们通过点击赚取更多，但如果没有点击，我们会比标准提供商损失更多的钱。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/9f7143ceb2a7ba4bbe5d3de4299fff37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kGit3y-zAt65p8aR9k8kxg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们使用的每个模型都有其评估指标</p></figure><p id="ace6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<em class="lv"> Lightgbm </em>和<em class="lv"> Catboost </em>型号<strong class="lb iu">，我们实现了0.757 </strong>的AUC。我们在最后选择了<em class="lv"> Lightgbm </em>，因为预测速度更快，而且我们需要模型实时运行。</p><h1 id="17d2" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">应用训练模型的结果</h1><p id="fd29" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">现在我们有了一个模型，我们如何利用它的结果呢？</p><p id="69a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">我们的问题是，我们应该向哪些用户展示广告，不应该向哪些用户展示。给定测试集(不平衡，与我们的样本具有相同的点击率，4%)，模型真正预测的是<strong class="lb iu">一个向量，其中给出了点击或不点击</strong>的概率。我们对点击概率最高的人感兴趣。确切地说，在我们的例子中，我们对30%感兴趣。</strong></p><p id="eafb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于这个原因，我们<strong class="lb iu">对点击的概率进行了排序，并将它们分成十分之一组</strong>。对于每个十分位数，我们计算了<em class="lv">大小</em>、实际点击数量<em class="lv"/>、实际十分位数(<em class="lv">十分位数_阈值</em>)。然后，我们计算了十分位数内用户点击的<em class="lv">概率和相关的<em class="lv">提升</em>。</em></p><pre class="kj kk kl km gt nm nn no np aw nq bi"><span id="ff85" class="nr ly it nn b gy ns nt l nu nv"># fit the model<br/>model=LGBMClassifier(random_state=101)<br/>model.fit(X_train_trf,y_train)</span><span id="fc94" class="nr ly it nn b gy nw nt l nu nv"># we are interested in the probabilities<br/>probs=model.predict_proba(X_test_trf)</span><span id="3ebb" class="nr ly it nn b gy nw nt l nu nv"># create a DataFrame with the probs and set the deciles<br/>probs_df=pd.DataFrame(probs)<br/>probs_df[‘real_values’]=y_test<br/>probs_df[‘decile’]=pd.qcut(probs_df[1], 10, labels=False)<br/>probs_df[‘decile’]=(9-probs_df[‘decile’])%10</span><span id="3c84" class="nr ly it nn b gy nw nt l nu nv"># group by deciles to find the lift<br/>lift=probs_df.groupby(‘decile’)[[‘real_values’]].sum()<br/>lift[‘size’]=probs_df.groupby(‘decile’)[‘real_values’].count()<br/>lift[‘decile_threshold’]=probs_df.groupby(‘decile’)[1].min()<br/>lift[‘prob_click’]=lift[‘real_values’]/lift[‘size’]<br/>lift[‘lift’]=lift[‘prob_click’]/0.0421<br/>lift</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/59fdcb522976a313f4ef85e4f1d1a8a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*D7KOxATuKkda5edNpZi1rw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们模型的结果按十分位数分组</p></figure><p id="8c48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个表格真的很重要，因为它意味着<strong class="lb iu">在我们前10%的印象中，点击的概率是14.5%(<em class="lv">prob _ click</em>)，比平均值高3.45倍(<em class="lv"> lift </em>)。</strong>如果来自我们的模型的点击概率高于71.5%(<em class="lv">十分位数_阈值</em>)，则印象将在该十分位数中。为什么这两个概率不一样？第一个(<em class="lv"> prob_click </em>)是在十分位数内的测试集中印象的实际概率。第二个(<em class="lv"> decile_threshold </em>)是我们模型的概率输出。<em class="lv"> Decile_threshold </em>用于将印象从最好到最差排序。<em class="lv"> Prob_click </em>就是评价，这个排序有多好。</p><p id="8a08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的问题中，记住我们只有30%的可能分配给额外费用广告。这意味着<strong class="lb iu">我们对十分位数0，1，2 </strong>的人感兴趣。这些人点击的概率超过5.7%(<em class="lv">prob _ click</em>表示十分位数3)，我们将在我们的模型预测点击概率超过57.4%的印象中找到他们(十分位数2表示<em class="lv">十分位数阈值</em>)。在下面的图表中，您可以看到结果(数字不匹配，因为这个图表是针对另一个模型的，但想法是相同的)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/76a2a48755ba2a864bfa875ca6d1cb23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3g1Nf6IFEtrqX619ZWoCOw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每十分位数的点击概率</p></figure><p id="819e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们有了一个做决定的框架。<strong class="lb iu">如果我们的模型预测用户的点击概率高于或等于57%,它将位于印象的前30%,因此我们将把横幅销售给我们的优质提供商。</strong>如果对于给定的印象，我们的模型预测点击概率低于57%，那么我们将把它卖给标准提供商。</p><h1 id="c2ca" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">经济模式</h1><p id="07ac" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">就收入而言，我们的模式有多好？</p><p id="4f15" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">我们并没有通过我们的模式来提高点击率，而是通过更有效地分配点击量来赚取尽可能多的钱。</strong>如果我们没有任何溢价广告，我们将在标准竞价中分配每一个广告，赚取尽可能少的钱。如果我们只有溢价广告，分配将是最好的。相反，我们正处于这两种情况的中间。</p><p id="756e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象一下，在我们的场景中，我们有<strong class="lb iu">两家供应商</strong>，价格如下:</p><ul class=""><li id="6677" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated"><em class="lv">高级提供商价格/点击:</em> 5€</li><li id="2658" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><em class="lv">优质提供商价格/印象但不点击:</em> 0.015€</li><li id="6291" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><em class="lv">标准提供商价格/点击:</em> 0.5€</li><li id="db7d" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><em class="lv">标准提供商价格/印象但不点击:</em> 0.0024€</li></ul><p id="ac6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">如果没有模型，广告将随机分配。</strong>假设整个数据集的点击率为4%,我们可以拥有的优质广告比例为30%,则收入将为:</p><ul class=""><li id="9bf3" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated"><strong class="lb iu">点击收入:</strong>4% * 30% *广告总数*高级广告价格+4% * 70% *广告总数*标准广告价格</li><li id="7342" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><strong class="lb iu">展示但未点击的收入:</strong> 96%(未点击广告)* 30% *广告总数*高级展示价格+96% * 70% *广告总数*标准展示价格</li></ul><p id="36fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">有了一个完美的模型——这是不可能的——我们可以完美地预测用户点击的概率</strong>,这样我们就可以尽可能地提高效率，收入将会是:</p><ul class=""><li id="ae1a" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated"><strong class="lb iu">点击收入:</strong>点击次数*优质广告价格</li><li id="c0db" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><strong class="lb iu">印象而非点击的收入:</strong>(30% *广告数量-点击数量)*高级印象价格+70% *标准印象价格</li></ul><p id="3477" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<strong class="lb iu">我们的模型</strong>我们需要考虑十分位数0、1、2中的实际点击次数:</p><ul class=""><li id="b2d1" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated"><strong class="lb iu">点击收入:</strong>前3个十分位数的点击量*高级广告价格+后7个十分位数的点击量*标准广告价格</li><li id="eb55" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><strong class="lb iu">印象而非点击的收入:</strong>(前3个十分位数-前3个十分位数的点击次数)*高级印象价格+(后7个十分位数-后7个十分位数的点击次数)*标准印象价格</li></ul><p id="b409" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这看起来有点乱，但它只是应用一些概率分布。为了方便地将它们应用于整个数据集，我们创建了函数<em class="lv"> revenue_model </em>。这些输入是:</p><ul class=""><li id="2a82" class="mw mx it lb b lc ld lf lg li my lm mz lq na lu nb nc nd ne bi translated"><em class="lv"> probs_df </em>:上面用来计算升力的数据帧</li><li id="5cd3" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><em class="lv"> fill_rate: </em>高级提供商可用的百分比。</li><li id="7641" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><em class="lv"> model1: </em>标准提供商的价格(_0用于展示，_1用于点击)</li><li id="fedd" class="mw mx it lb b lc nf lf ng li nh lm ni lq nj lu nb nc nd ne bi translated"><em class="lv">模型2: </em>高级提供商的价格(0为展示次数，1为点击次数)</li></ul><p id="332c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出是三个数字，上面的模型给出了收入:随机，最优(你的)和完美。</p><pre class="kj kk kl km gt nm nn no np aw nq bi"><span id="3d51" class="nr ly it nn b gy ns nt l nu nv">def revenue_model(probs_df, fill_rate, model1_0, model1_1, model2_0, model2_1): <br/> <br/>limit=round(len(probs_df)*fill_rate)<br/> <br/> #random model<br/> random_df=shuffle(probs_df)<br/> random2=random_df[:limit]<br/> random1=random_df[limit:]<br/> money_random2=random2[‘real_values’].sum()*model2_1+(len(random2)-random2[‘real_values’].sum())*model2_0<br/> money_random1=random1[‘real_values’].sum()*model1_1+(len(random1)-random1[‘real_values’].sum())*model1_0<br/> revenue_random=money_random1+money_random2<br/> <br/> <br/> <br/> #optimized problem<br/> probs_df=probs_df.sort_values(1,ascending=False)<br/> probs_model2_opt=probs_df[:limit]<br/> probs_model1_opt=probs_df[limit:]<br/> money_model2_opt=probs_model2_opt[‘real_values’].sum()*model2_1+(len(probs_model2_opt)-probs_model2_opt[‘real_values’].sum())*model2_0<br/> money_model1_opt=probs_model1_opt[‘real_values’].sum()*model1_1+(len(probs_model1_opt)-probs_model1_opt[‘real_values’].sum())*model1_0<br/> revenue_opt=money_model1_opt+money_model2_opt<br/> <br/> #perfect model<br/> probs_df=probs_df.sort_values(‘real_values’,ascending=False)<br/> probs_model2_perf=probs_df[:limit]<br/> probs_model1_perf=probs_df[limit:]<br/> money_model2_perf=probs_model2_perf[‘real_values’].sum()*model2_1+(len(probs_model2_perf)-probs_model2_perf[‘real_values’].sum())*model2_0<br/> money_model1_perf=probs_model1_perf[‘real_values’].sum()*model1_1+(len(probs_model1_perf)-probs_model1_perf[‘real_values’].sum())*model1_0<br/> revenue_perf=money_model1_perf+money_model2_perf<br/> <br/> <br/> return revenue_random, revenue_opt, revenue_perf</span></pre><p id="71e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们将其应用于我们的结果，价格如下:</p><pre class="kj kk kl km gt nm nn no np aw nq bi"><span id="c1fc" class="nr ly it nn b gy ns nt l nu nv"># set the prices<br/>provider1_1=0.5<br/>provider1_0=0.0024<br/>provider2_1=5<br/>provider2_0=0.015</span><span id="c623" class="nr ly it nn b gy nw nt l nu nv"># apply revenue_model function<br/>revenue_random, revenue_opt, revenue_perf = revenue_model(probs_df, 0.3, provider1_0, provider1_1, provider2_0, provider2_1)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/e1786fc49e3b654ee5388c574adcbde6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*BcxVk0o_Bhi5KVv3TJAppA.png"/></div></figure><p id="8050" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们的示例图片，其中<em class="lv"> fill_rate=30% </em>。<strong class="lb iu">评估我们模型的全貌</strong>总是一个好主意。为此，我们只需应用相同的函数改变<em class="lv"> fill_rate </em>并绘制结果。</p><pre class="kj kk kl km gt nm nn no np aw nq bi"><span id="68b5" class="nr ly it nn b gy ns nt l nu nv">fill_rates=[]<br/>rev_random=[]<br/>rev_optimal=[]<br/>rev_perfect=[]</span><span id="7c7d" class="nr ly it nn b gy nw nt l nu nv"># apply the function for every fill rate<br/>for fill_rate in range(0,110,10):<br/> fill_rate=fill_rate/100<br/> revenue_random, revenue_opt, revenue_perf = revenue_model(probs_df, fill_rate, provider1_0, provider1_1, provider2_0, provider2_1)<br/> rev_random.append(revenue_random)<br/> rev_optimal.append(revenue_opt)<br/> rev_perfect.append(revenue_perf)<br/> fill_rates.append(fill_rate)</span><span id="cabb" class="nr ly it nn b gy nw nt l nu nv"># plot the result<br/>plt.figure(figsize=(15,10))<br/>plt.plot(fill_rates,rev_random,label=’random model’,linewidth=3)<br/>plt.plot(fill_rates,rev_optimal,label=’optimal model’,linewidth=3)<br/>plt.plot(fill_rates,rev_perfect,label=’perfect model’,linewidth=3)<br/>plt.legend(fontsize=14)<br/>plt.xlabel(‘Fill rate’,fontsize=14)<br/>plt.ylabel(‘Revenue ($)’,fontsize=14)<br/>plt.xlim(xmin=0)<br/>plt.ylim(ymin=0)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/372189be54fd3cbf25b3ac117fbf86bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XhYDYsZiz9m5vdC1w81XfA.png"/></div></div></figure><p id="1b67" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在图表中，我们可以看到<strong class="lb iu">改变填充率</strong>时每个型号的收入。蓝线是<em class="lv">随机型号</em>，绿线是<em class="lv">完美型号</em>，橙色是我们的型号。在这里，我们可以看到，如果你能把10%到50%的广告分配给付费提供商，那么拥有一个模型就更加重要。这是因为这两个数字之间的收入增长百分比比其他范围要高得多。</p><p id="74fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于30%的额外费用广告(目前的情况)，我们的收入几乎翻了一番。但是我们还有45%的收入可以提高。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/d406b2810539ce11a3b33c633493e615.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qB8Zho3CGLQrxnddmiNzIg.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/ab7819c9c5e8edcbd1b3b61456499000.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wSOsGCJyU2f66qb4SShVwg.png"/></div></div></figure><h1 id="07d8" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">结论</h1><p id="cdcb" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">数据科学家是懂数学和编程，但也有商业头脑的人。这种商业意识让我们不仅能交付优秀的模型，还能让它们适应公司的需求。用收入的术语来谈论总是能让你向非技术客户展示更清晰的结论。</p><p id="158c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，在本文中，我们探讨了点击问题的业务/收入评估。<strong class="lb iu">它可用于了解我们的ML模型</strong>的经济影响，并使用无任何模型(随机模型)和尽可能最大收益(完美模型)对其进行基准测试。</p><p id="b1c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你也可以在这里找到整个项目👇</p><div class="od oe gp gr of og"><a href="https://github.com/myrthings/click-prediction" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">my things/点击预测</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">数据即，数据清洗，特征工程，建模和点击预测的经济影响…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">github.com</p></div></div><div class="op l"><div class="oq l or os ot op ou ks og"/></div></div></a></div></div><div class="ab cl ov ow hx ox" role="separator"><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa"/></div><div class="im in io ip iq"><p id="1c7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你觉得它有用吗？你在用吗？是不是我搞砸了，你什么都不懂？你还有哪些衡量收入的方法？</p><p id="85e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">在评论区告诉我吧！</em>🤗</p></div></div>    
</body>
</html>