<html>
<head>
<title>Helping Machines Understand Complex Questions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">帮助机器理解复杂的问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/helping-machines-understand-complex-questions-48536fd93ef2?source=collection_archive---------42-----------------------#2020-03-17">https://towardsdatascience.com/helping-machines-understand-complex-questions-48536fd93ef2?source=collection_archive---------42-----------------------#2020-03-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b479" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">基于手套嵌入和Keras的多标签文本分类</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/be4b2731fc27279e7d76b385e4a41015.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*omx_bkv-FH4Fcdjn"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kv" href="https://unsplash.com/@ratushny?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Dmitry Ratushny </a>拍摄</p></figure><p id="2224" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">(此项目灵感来源于</em><a class="ae kv" href="https://www.kaggle.com/c/google-quest-challenge" rel="noopener ugc nofollow" target="_blank"><em class="ls">Google QUEST Kaggle Challenge</em></a><em class="ls">)</em></p><p id="b0a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">自然语言处理领域一直令我着迷。想象一台计算机能够理解人类语言并对其做出反应，这简直令人吃惊。我一直想做一个涉及NLP和深度学习的项目，所以我决定创建一个项目，其中一个利益相关者需要改进他的问答系统。</p><p id="11c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">尽管问答系统和聊天机器人已经变得如此先进，但当面对本质上更复杂的问题时，它们仍然会陷入困境。机器可以很容易地计算出字符数或词汇等维度，但人类更擅长计算定性维度，如“这个问题是在寻找建议吗？”</p><p id="9600" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个可以预测问题的主观方面并正确识别复杂性的模型对于改进这些工具的构建和实现非常有帮助。</p><p id="beb5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以在这里找到我们将使用的数据<a class="ae kv" href="https://www.kaggle.com/c/google-quest-challenge/data" rel="noopener ugc nofollow" target="_blank">。原始数据包括来自各种StackExchange网站的6000多个问答对样本，以及每个样本的30个人工生成的主观标签。我已经把这个比赛中的问题应用到一个更像商业的情况中。我们想象中的利益相关者只对基于机器的解决方案感兴趣，以评估它从客户那里收到的问题，并且只对一些主观方面感兴趣。最终目标是让他的QA系统自动回答更符合事实的问题，并标记复杂的问题供员工回答。</a></p><p id="c61b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我们有一个多类别、多标签的文本分类问题，其中一个样本可以同时被分类为多个类别，并且有6，079个样本要处理。我们将使用手套预训练的单词嵌入和带有Keras的神经网络模型。开始吧！</p><p id="7ae0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">为了不使这篇文章太长，我们将把重点放在自然语言处理和建模方面，但你可以在</em> <a class="ae kv" href="https://github.com/gioamorim80/QA-Complex-Questions---Multi-label-Text-Classification/blob/master/Capstone_Project.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="ls">我的Github页面</em> </a> <em class="ls">上找到这个项目的全部内容，包括数据探索。</em></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="3aa0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了拥有更强的计算能力，我使用了Google Colab，所以我把数据添加到了我的google drive中。我加载了数据，只选择了与我的项目相关的内容，并立即将数据拆分以避免任何泄漏。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="a40c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，这个数据集上的原始目标不是二进制的，所以我做了一个快速转换，以便于我们的分类。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="4279" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在有趣的部分开始了！首先，我们创建一个小助手函数来清除文本数据中的点、数字、多余的空格等。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="85d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们使用apply和lambda方法将函数应用于所有文本数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="b0c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将加载一个普通爬行手套模型的pickled版本，它具有840B令牌、2.2M词汇、cased和300d向量。加载酸洗版比加载整个2.03 GB手套模型要快得多。同样，我把那个文件保存在我的Google Drive上，所以那就是我们获取它的地方，但是你可以在这里找到所有的<a class="ae kv" href="https://nlp.stanford.edu/projects/glove/" rel="noopener ugc nofollow" target="_blank">手套嵌入。我们定义了一个嵌入矩阵，我们的模型将使用它作为嵌入层的一部分。</a></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="2cd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们需要将我们的文本数据标记并填充到300维手套嵌入的正确形状中。我选择将我的文本列作为单独的特征，而不是连接所有的文本数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="17b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们还需要为神经网络准备分类列。我用LabelEncoder来做这个。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="706c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们将使用Keras建立我们的神经网络模型。下面这个函数很大程度上是从<a class="ae kv" href="https://www.kaggle.com/buntyshah/google-quest-q-a-labeling-embeddings-glove" rel="noopener ugc nofollow" target="_blank">这个Kaggle笔记本</a>中得到启发和改编的，它使用三个独立的输入，一个用于分类特征，两个用于文本特征，即问题标题和问题正文。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="2249" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们走一遍那里正在发生的事情:我们通过一个sigmoid激活的密集层传递我们的分类特征。然后，使用两个嵌入层，用GloVe嵌入对我们的文本列进行编码，并将它们连接起来。然后，我们使用长短期记忆网络(LSTM)层，它通常用于自然语言处理模型，具有双向层包装器。我们将在LSTM层之后连接一个全局最大池和一个全局平均池，并添加两个具有relu和sigmoid激活的隐藏层。最后，我们添加文本和分类层输出，并传递一个最终的密集层，其中包含8个节点和一个sigmoid激活，它将与我们的多标签问题目标一起工作。</p><p id="752b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们编译我们的模型，并使用我们之前构建的手套嵌入矩阵传递函数。然后，我们将它与我们的数据进行拟合，并评估我们的结果。首先，我使用评估方法，并获得模型的训练和测试数据的准确性。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ma mb l"/></div></figure><pre class="kg kh ki kj gt mc md me mf aw mg bi"><span id="ec2f" class="mh mi iq md b gy mj mk l ml mm">Train Accuracy: 0.8713242853592384<br/>Test Accuracy: 0.839124177631579</span></pre><p id="a5d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，由于我们的数据存在严重的不平衡性，我们想看看其他比准确性更能提供信息的指标。Keras不支持分类报告方法，但我们可以通过将Keras的预测转换为二进制结果，然后将它们传递给Scikit-learn分类报告方法来轻松应对。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="87da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从我们的结果中我们可以看到，尽管我们能够使用手套嵌入的神经网络模型实现接近84%的整体准确性，但我们根据目标具有不同的精确度、召回率和f1分数。</p><p id="ace7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的数据存在严重的类别不平衡，更复杂的目标实际上也是样本更少的目标。到目前为止，这些目标的表现最差，不仅因为它们很复杂，因此机器很难解释，还因为样本数量很少。更多的数据，尤其是涵盖代表性不足的目标的数据，有助于进一步改进我们的模型。</p><p id="8ca6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">无论如何，参与这个项目是使用自然语言处理工具和Keras的好方法，我希望它对你也有用。编码快乐！</p></div></div>    
</body>
</html>