<html>
<head>
<title>How to Split a Dataframe into Train and Test Set with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 Python 将一个数据帧分割成训练集和测试集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-split-a-dataframe-into-train-and-test-set-with-python-eaa1630ca7b3?source=collection_archive---------9-----------------------#2020-05-26">https://towardsdatascience.com/how-to-split-a-dataframe-into-train-and-test-set-with-python-eaa1630ca7b3?source=collection_archive---------9-----------------------#2020-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b36b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在熊猫数据帧上使用 sklearn train_test_split 的简短指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5de34295c15a1b77531bb136c61f2887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n7Ob33nRMq07BZPbNtfItw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者插图</p></figure><p id="0c11" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这篇短文中，我描述了如何通过应用 sklearn 的 train_test_split 函数，将数据集分割成用于机器学习的训练和测试数据。我使用我上一篇文章中的程序创建的数据框。这些数据基于 D. Greene 和 P. Cunningham 发表的原始 BBC 新闻文章数据集[1]。</p><p id="7f90" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你感兴趣，可以在这里查看源代码。</p><p id="9f5f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您错过了我的第一个从文本文件中提取信息的指南，您可能想要查看它以更好地理解我们正在处理的数据。</p><div class="ls lt gp gr lu lv"><a rel="noopener follow" target="_blank" href="/transforming-text-files-to-data-tables-with-python-553def411855"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">用 Python 将文本文件转换成数据表</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">从任何文本文件中提取信息的可重用方法</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">towardsdatascience.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><h1 id="7235" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">数据理解</h1><p id="5f33" class="pw-post-body-paragraph kv kw iq kx b ky nc jr la lb nd ju ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">因为我想让本指南保持简短，所以我不会像在我的上一篇文章中那样详细描述这个步骤。在这一部分要提到的最重要的信息是数据是如何构造的以及如何访问它。</p><p id="9229" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从下面的截图可以看出，数据位于 generated_data 文件夹中。一旦创建了这些文件，我们还想将训练和测试数据保存到这个文件夹中。此外，该脚本在 prepare_ml_data.py 文件中运行，该文件位于 prepare_ml_data 文件夹中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/283eb3da73d8972c689b3d2665bd3bff.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*CQ3q85OCyHoyIXYcFaAFKA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">文件系统的屏幕截图</p></figure><p id="4102" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">正如我在关于将文本文件转换为数据表的上一篇文章中所介绍的，bbc_articles.tsv 文件包含五列。然而，对于本教程，我们只对文本和流派列感兴趣。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/68897a987020ce55aa9b86c60964a8ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*htBifq2yy9631XBYqAxC5g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">数据集的列</p></figure><h1 id="f23c" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">加载数据</h1><p id="5821" class="pw-post-body-paragraph kv kw iq kx b ky nc jr la lb nd ju ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">第一步，我们希望将数据加载到我们的编码环境中。为此，我们需要存储数据的目录的路径。我们保存本地变量的路径来访问它，以便加载数据，并使用它作为保存最终训练和测试集的路径。由于数据存储在与运行脚本的文件不同的文件夹中，我们需要在文件系统中返回一级，在第二步中访问目标文件夹。我们通过加入“..”来实现这一点以及导致‘的数据文件夹../generated_data/'。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="c576" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用 generated_data 文件夹的路径，我们创建另一个指向数据文件本身的变量，称为 bbc_articles.tsv。由于它是一个制表符分隔值文件(tsv)，我们需要添加' \t '分隔符，以便将数据作为 Pandas Dataframe 加载。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="a008" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">选择要分割的数据(可选)</h1><p id="c37d" class="pw-post-body-paragraph kv kw iq kx b ky nc jr la lb nd ju ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">将数据分成训练集和测试集不需要以下命令。然而，由于我不需要数据集的所有可用列，所以我选择了想要的列，并创建了一个新的 dataframe，其中只有“text”和“genre”列。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="5873" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">分割和保存</h1><p id="e6dd" class="pw-post-body-paragraph kv kw iq kx b ky nc jr la lb nd ju ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">现在，我们已经准备好了分割它的数据。幸运的是，sklearn 库的 train_test_split 函数能够处理 Pandas 数据帧和数组。因此，我们可以简单地通过提供数据集和其他参数来调用相应的函数，例如:</p><ul class=""><li id="3d17" class="nk nl iq kx b ky kz lb lc le nm li nn lm no lq np nq nr ns bi translated"><strong class="kx ir"> test_size </strong> : <br/>该参数表示应该包含在测试分割中的数据集的比例。这个参数的缺省值被设置为 0.25，这意味着如果我们不指定 test_size，那么产生的分割由 75%的训练数据和 25%的测试数据组成。</li><li id="18de" class="nk nl iq kx b ky nt lb nu le nv li nw lm nx lq np nq nr ns bi translated"><strong class="kx ir"> random_state </strong> : <br/>该参数控制分割前应用于数据的洗牌。通过定义随机状态，我们可以在多个函数调用中重现相同的数据分割。</li><li id="97bf" class="nk nl iq kx b ky nt lb nu le nv li nw lm nx lq np nq nr ns bi translated"><strong class="kx ir">洗牌</strong> : <br/>该参数表示数据在分割前是否需要洗牌。因为我们的数据集是按流派排序的，所以我们肯定要打乱它。否则，训练集和测试集将不会包含相同的类型。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="a271" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在分割数据之后，我们使用目录路径变量来定义保存训练和测试数据的文件路径。通过将数据帧转换为 csv，同时使用' \t '作为分隔符，我们创建了制表符分隔的训练和测试文件。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h1 id="cc45" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">结论</h1><p id="52e7" class="pw-post-body-paragraph kv kw iq kx b ky nc jr la lb nd ju ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">在这篇短文中，我描述了如何加载数据，以便将数据分成训练集和测试集。相应的数据文件现在可以用于训练和评估文本分类器(尽管取决于模型，可能需要额外的数据清理)。</p><p id="b61d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在未来的文章中，我将描述如何建立不同的深度学习模型(如 LSTM 和伯特)来训练文本分类器，这些分类器根据文章的文本来预测文章的体裁。下面是我的文章的链接，在这篇文章中，我使用 FARM 框架为文本分类微调 BERT。</p><div class="ls lt gp gr lu lv"><a rel="noopener follow" target="_blank" href="/fine-tuning-bert-for-text-classification-with-farm-2880665065e2"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">微调用于 FARM 文本分类的 BERT</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">使用最先进的 NLP 模型进行简单快速的迁移学习</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">towardsdatascience.com</p></div></div><div class="me l"><div class="ny l mg mh mi me mj kp lv"/></div></div></a></div><p id="90a8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">非常感谢你的阅读和快乐编码！</p><h1 id="3873" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">参考</h1><p id="80ce" class="pw-post-body-paragraph kv kw iq kx b ky nc jr la lb nd ju ld le ne lg lh li nf lk ll lm ng lo lp lq ij bi translated">1d .格林和 p .坎宁安。核心文档聚类中对角优势问题的实际解决方案。ICML 2006。</p></div></div>    
</body>
</html>