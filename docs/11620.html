<html>
<head>
<title>Sentiment Analysis of a Tweet With Naive Bayes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于朴素贝叶斯的微博情感分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sentiment-analysis-of-a-tweet-with-naive-bayes-ff9bdb2949c7?source=collection_archive---------14-----------------------#2020-08-12">https://towardsdatascience.com/sentiment-analysis-of-a-tweet-with-naive-bayes-ff9bdb2949c7?source=collection_archive---------14-----------------------#2020-08-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="0351" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">每秒发布数百万条推文。它帮助我们了解公众对特定事件的反应。为了获得推文的情感，我们可以使用朴素贝叶斯分类算法，这只是贝叶斯规则的应用。</p><h1 id="3f14" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">贝叶斯规则</h1><p id="9f02" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">贝叶斯规则仅仅是描述一个事件发生的概率，而这个概率是建立在与它相关的另一个事件发生的先验知识之上的。</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/471e512b4bffd8ba52097bda2c3adda0.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*il1wLXzC1-Ca3M-7wScjng.png"/></div></figure><p id="18da" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">那么假设事件 B 已经发生，事件 A 发生的概率为</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/6b2565830974d78fce55d9ef7852dcce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*wdMoTBm13_WugE_1TeIXwA.png"/></div></figure><p id="b2b8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">假设事件 A 已经发生，事件 B 发生的概率是</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/a4ba32908b0bf7d74e6ffc33306b46a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*QNCQhjESiTHcZRqg9Pfa5g.png"/></div></figure><p id="c545" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">使用这两个方程，我们可以将它们统一改写为</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/0f6e920b2cf2fda7dd03a9a56cc3f6fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*xWq7NobveHPE4YGIHxCwag.png"/></div></figure><p id="fed2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">让我们看看推文，以及我们如何从推文中提取特征</strong></p><p id="3240" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将有两个推特语料库，正面和负面推特。</p><p id="7ab0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">正面推文</strong>:“我很开心，因为我在学习 NLP”，“我很开心，不难过。”</p><p id="5c05" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">负面推文</strong>:“我很难过，我没有学习 NLP”，“我很难过，不开心。”</p><h1 id="696e" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">预处理</h1><p id="77a6" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">我们需要对数据进行预处理，这样可以节省大量内存，减少计算过程。</p><ol class=""><li id="f914" class="mc md it js b jt ju jx jy kb me kf mf kj mg kn mh mi mj mk bi translated">小写:我们将所有的文本转换成小写。这样，像学习和学习这样的词就可以理解为同一个词</li><li id="a947" class="mc md it js b jt ml jx mm kb mn kf mo kj mp kn mh mi mj mk bi translated">删除标点符号、网址、名称:我们将删除标点符号、网址、名称或标签，因为它们对推文的情感分析没有帮助。</li><li id="e96b" class="mc md it js b jt ml jx mm kb mn kf mo kj mp kn mh mi mj mk bi translated">去除停用词:像“The”、“is”这样的停用词对情感没有帮助。因此，这些词必须删除。</li><li id="c617" class="mc md it js b jt ml jx mm kb mn kf mo kj mp kn mh mi mj mk bi translated">词干:像“take”、“taking”这样的词被视为相同的词，并转换为基本词，这里是“take”。这样可以节省大量内存和时间。</li></ol><h1 id="0ba3" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">概率方法:</h1><p id="da53" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">为了获得单词的概率统计，我们将创建一个这些单词的字典，并统计每个单词在正面和负面推文中的出现次数。</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/9d5136c6cac11ee7e0dc8fd0ab2f6a12.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*pqkXY7OSRJeM3Q3fOb8KLA.png"/></div></figure><p id="9117" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看看这些单词计数如何有助于找到这两个类的单词的概率。这里，单词“I”出现了三次，并且阳性语料库中的唯一单词总数是 13。因此，假设推文是正面的，单词“I”出现的概率将是</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/b1bc7d370d60a65bf7ddbae3c73615b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*GbGj9lPgzM0LMc3li4Weig.png"/></div></figure><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/2e92f2e1f6d997b91e2c5486647ffbf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*BG_NhELmTFNEPI91VSeCAQ.png"/></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">freq 表示一个词出现的频率，class: {pos，neg}</p></figure><p id="ac76" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对我们词汇表中的所有单词都这样做，我们会得到这样一个表格:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/496f9c0dc7d898018f04445db01f9282.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*riO5gX3ZwkYAZ_gisDx2Yg.png"/></div></figure><p id="a98f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在朴素贝叶斯中，我们将发现每个词是如何对情感做出贡献的，这可以通过正类和负类的词的出现概率的比率来计算。我们来举个例子；我们可以看到,‘sad’这个词出现的概率更多的是针对否定类而不是肯定类。因此，我们将通过公式找到每个单词的这些概率的比率:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi my"><img src="../Images/022601a9743ab30363c935c68c3ae099.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*iMruArEAbOgMYtehkRWAhg.png"/></div></figure><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/85c1247c10849eecd93e95b527186658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*dXOj3HRHiLvI6kWrEdWfpQ.png"/></div></figure><p id="1bd6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个比率被称为似然性，其值介于(0，∞)之间。趋向于零的值表示与在负面推特中发生的概率相比，它在正面推特中发生的概率非常低，而趋向于无穷大的比值表示与在正面推特中发生的概率相比，它在负面推特中发生的概率非常低。换句话说，比值高意味着积极。此外，比率值 1 表示名称是中性的。</p><h1 id="003c" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">拉普拉斯平滑</h1><p id="e80f" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">有些单词可能只在某个特定的班级出现过。没有出现在否定类别中的单词将具有概率 0，这使得比率不确定。所以，我们将使用拉普拉斯平滑技术来追踪这种情况。让我们看看应用拉普拉斯平滑后等式是如何变化的:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi na"><img src="../Images/07f65925d6b9f6fd31210b10dbc994a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*skDFPZMHeK3CWBOUdIM6gQ.png"/></div></figure><p id="2a72" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过在分子中添加“1 ”,使概率不为零。这个因子叫做α因子，在(0，1)之间；具体来说，当我们将该α因子设置为 1 时，平滑被称为拉普拉斯平滑。同样，概率之和将保持为 1。</p><p id="4462" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在我们的示例中，唯一单词的数量是 8，因此 V= 8。</p><p id="b423" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">拉普拉斯平滑后，概率表将看起来像这样:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/d25679a35ae79e625f658d785ca6dcea.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*KXbySbA7-oYU-K_DJhcRAA.png"/></div></figure><h1 id="4ecc" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">朴素贝叶斯:</h1><p id="0362" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">为了估计一条推文的情绪，我们将取推文中出现的每个词的概率比的乘积。请注意，不在我们的词汇表中的单词将不起作用，并将被视为中性的。在我们的应用程序中，朴素贝叶斯的等式如下:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/09dd6f92bc42fd62e57d013a2ff437de.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*fZj38LIAXPM0zxmmFf88Bg.png"/></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">m =一条推文中的字数，w =一条推文中的字数</p></figure><p id="cb03" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由于数据可能不平衡，并可能导致特定类别的有偏差的结果，因此我们将上面的等式乘以一个先验因子，该因子是正面推文的概率与负面推文的概率之比。</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/da154ca65c635ba937335567eda761ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*c6r9HtntqfApgumavToqsg.png"/></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">朴素贝叶斯的完全方程</p></figure><p id="cb84" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因为我们取所有这些比率的乘积，我们可能会得到一个太大或太小而无法存储在我们的设备上的数字，所以这里出现了对数似然的概念。我们在朴素贝叶斯方程上取对数。</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/e71a08ca767839af04d2a4b40071eab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AvfF2JKEsRLUszY4D-pMgw.png"/></div></div></figure><p id="8820" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">取似然方程的对数后，标度将改变如下:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/84032e23aa756e6449b709876f81c733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*10kQlfNIU5oGfTyNA9piQw.png"/></div></figure><p id="57f3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看一个例子。推特:“我很高兴，因为我在学习。</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi nj"><img src="../Images/a5e4174fce28e1aa1c32fba63bd325b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*AxsxL7CuVDkHr5DrjEl8fA.png"/></div></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">这是我们推文的总体对数可能性。</p></figure><p id="e02f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">因此，推文的总体对数似然值大于零，这意味着推文是正面的。</p><h1 id="30a4" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">缺点:</h1><ol class=""><li id="ab45" class="mc md it js b jt lm jx ln kb nk kf nl kj nm kn mh mi mj mk bi translated">朴素贝叶斯算法假设单词相互独立。</li><li id="a156" class="mc md it js b jt ml jx mm kb mn kf mo kj mp kn mh mi mj mk bi translated">语料库中的相对频率:有时人们会屏蔽可能具有攻击性的特定类型的推文，等等。这导致了数据的不平衡</li><li id="398f" class="mc md it js b jt ml jx mm kb mn kf mo kj mp kn mh mi mj mk bi translated">词序:通过改变词序，情感可能会改变，但是使用朴素贝叶斯，我们不会遇到这种情况。</li><li id="5c6a" class="mc md it js b jt ml jx mm kb mn kf mo kj mp kn mh mi mj mk bi translated">删除标点符号:记得在数据预处理中，我们删除了标点符号，这可能会改变推文的情绪。这里有一个例子:‘我敬爱的祖母:(’</li></ol><h1 id="ad01" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">结论:</h1><p id="7d76" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">朴素贝叶斯是一种简单而强大的算法，知道了数据就可以相应地对数据进行预处理。朴素贝叶斯算法也用于社会的许多方面，如垃圾邮件分类、贷款审批等。</p></div></div>    
</body>
</html>