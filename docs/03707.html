<html>
<head>
<title>LSTM for Stock Price Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨äºè‚¡ç¥¨ä»·æ ¼é¢„æµ‹çš„LSTM</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/lstm-for-google-stock-price-prediction-e35f5cc84165?source=collection_archive---------5-----------------------#2020-04-07">https://towardsdatascience.com/lstm-for-google-stock-price-prediction-e35f5cc84165?source=collection_archive---------5-----------------------#2020-04-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d35a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">ä¸ºè°·æ­Œè‚¡ä»·é¢„æµ‹åˆ›å»ºåŸºäºLSTMçš„é€’å½’ç¥ç»ç½‘ç»œçš„æŠ€æœ¯æ¼”ç»ƒ</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/d6e5122aded459b1068a58e7d968e63b.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*puLlJudJvHOysoMWVUg8Dw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">æ¥è‡ªunsplashçš„Imgé€šè¿‡<a class="ae ku" href="https://unsplash.com/photos/69ppqHiG9Xo" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a></p></figure><p id="5e3e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä¸€æ­¥ä¸€æ­¥åœ°ä»‹ç»å¦‚ä½•å»ºç«‹ä¸€ä¸ªåŸºäºLSTMçš„é€’å½’ç¥ç»ç½‘ç»œ(RNN)æ¥é¢„æµ‹è°·æ­Œè‚¡ç¥¨ä»·æ ¼ã€‚å®ƒåˆ†ä¸ºå¦‚ä¸‹7ä¸ªéƒ¨åˆ†ã€‚</p><ol class=""><li id="9b7c" class="lr ls it kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">é—®é¢˜é™ˆè¿°</li><li id="5b1b" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">æ•°æ®å¤„ç†</li><li id="0b7d" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">æ¨¡å‹ç»“æ„</li><li id="efcc" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">æ¨¡å‹ç¼–è¯‘</li><li id="9e8b" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">æ¨¡å‹æ‹Ÿåˆ</li><li id="c15b" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">æ¨¡å‹é¢„æµ‹æ³•</li><li id="b6b7" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">ç»“æœå¯è§†åŒ–</li></ol><p id="9205" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">è®©æˆ‘ä»¬å¼€å§‹æ—…ç¨‹å§ğŸƒâ€â™€ï¸ğŸƒâ€â™‚ï¸.</p><ol class=""><li id="04b8" class="lr ls it kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated"><strong class="kx iu">é—®é¢˜é™ˆè¿°</strong></li></ol><p id="a75c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æˆ‘ä»¬å¾—åˆ°äº†2012å¹´1æœˆè‡³2016å¹´12æœˆçš„è°·æ­Œè‚¡ä»·ã€‚ä»»åŠ¡æ˜¯é¢„æµ‹2017å¹´1æœˆçš„è‚¡ä»·è¶‹åŠ¿ã€‚<em class="mf">æ³¨æ„ï¼Œ</em> <strong class="kx iu"> <em class="mf">åŸºäºå¸ƒæœ—è¿åŠ¨ï¼Œè‚¡ç¥¨ä»·æ ¼çš„æœªæ¥å˜åŒ–ç‹¬ç«‹äºè¿‡å»</em>ã€‚å› æ­¤ï¼Œé¢„æµ‹å‡†ç¡®çš„è‚¡ç¥¨ä»·æ ¼æ˜¯ä¸å¯èƒ½çš„ï¼Œä½†é¢„æµ‹å’Œæ•æ‰ä¸Šæ¶¨å’Œä¸‹è·Œè¶‹åŠ¿æ˜¯å¯èƒ½çš„ã€‚</strong></p><p id="b286" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">2.<strong class="kx iu">æ•°æ®å¤„ç†</strong></p><p id="9a2a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">2.1å¯¼å…¥æ•°æ®</p><p id="bb5d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">è®­ç»ƒ/æµ‹è¯•æ•°æ®ä¿å­˜åœ¨ä¸­ã€‚åˆ†åˆ«ä¸º<em class="mf"> csv </em>æ–‡ä»¶ã€‚æˆ‘ä»¬å°†ç”¨<strong class="kx iu"> <em class="mf">å¼€ç›˜</em> </strong>ä»·æ ¼è¿›è¡Œé¢„æµ‹ã€‚å›¾1æ˜¾ç¤ºäº†è®­ç»ƒé›†çš„ä¸€ä¸ªç‰‡æ®µåŠå…¶æ•£ç‚¹å›¾ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/d9ee395216e4fe4bce99ef5821597a24.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*3aUkO5IuGLGBRmLgWjX9fQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾1è®­ç»ƒé›†åŠå…¶æ•£ç‚¹å›¾</p></figure><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="eaf9" class="mm mn it mi b gy mo mp l mq mr">train = pd.read_csv(â€˜Google_Stock_Price_Train.csvâ€™)</span><span id="5566" class="mm mn it mi b gy ms mp l mq mr">#keras only takes numpy array<br/>training_set = dataset_train.iloc[:, 1: 2].values</span></pre><p id="6635" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æ³¨æ„<em class="mf"> dataset_train.iloc[:ï¼Œ</em><strong class="kx iu"><em class="mf">1:2</em></strong><em class="mf">]ä¸­çš„ç´¢å¼•èŒƒå›´ã€‚å€¼</em>ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ä½¿å®ƒæˆä¸º<strong class="kx iu"> NumPyæ•°ç»„ï¼Œ</strong>ä¸æ˜¯å•ä¸ªå‘é‡ï¼Œä¹Ÿä¸æ˜¯ç”¨äºè®­ç»ƒçš„<strong class="kx iu">æ•°æ®å¸§</strong>ã€‚</p><p id="2790" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">2.2ç‰¹å¾ç¼©æ”¾</p><p id="ddf5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ä¸‹ä¸€æ­¥æ˜¯åœ¨(0ï¼Œ1)ä¹‹é—´ç¼©æ”¾è‚¡ç¥¨ä»·æ ¼ï¼Œä»¥é¿å…å¯†é›†çš„è®¡ç®—ã€‚å¸¸è§çš„æ–¹æ³•æœ‰<strong class="kx iu">æ ‡å‡†åŒ–</strong>å’Œ<strong class="kx iu">æ­£å¸¸åŒ–</strong>å¦‚å›¾2æ‰€ç¤ºã€‚å»ºè®®è¿›è¡Œå½’ä¸€åŒ–ï¼Œå°¤å…¶æ˜¯åœ¨è¾“å‡ºå±‚ä½¿ç”¨<em class="mf"> Sigmoid </em>å‡½æ•°å¤„ç†RNNæ—¶ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/749b7f396c965dbd208e7510f2e53d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*B6PWE8REIu2gpWJKL0Oq_Q.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾2ç‰¹å¾ç¼©æ”¾æ–¹æ³•(ä½œè€…åˆ›å»ºçš„Img)</p></figure><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="b62c" class="mm mn it mi b gy mo mp l mq mr">from sklearn.preprocessing import MinMaxScaler<br/>sc = MinMaxScaler(feature_range = (0, 1))</span><span id="eaf7" class="mm mn it mi b gy ms mp l mq mr">training_set_scaled = sc.fit_transform(training_set)</span></pre><p id="9058" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">2.3æ•°æ®ç»“æ„åˆ›å»º</p><blockquote class="mu"><p id="178d" class="mv mw it bd mx my mz na nb nc nd lq dk translated">åˆ›å»º<strong class="ak">æ»‘åŠ¨çª—å£å¾ˆé‡è¦</strong>ï¼</p></blockquote><p id="b27a" class="pw-post-body-paragraph kv kw it kx b ky ne ju la lb nf jx ld le ng lg lh li nh lk ll lm ni lo lp lq im bi translated">éœ€è¦ä¸€ä¸ªç‰¹æ®Šçš„æ•°æ®ç»“æ„æ¥è¦†ç›–60ä¸ªæ—¶é—´æˆ³ï¼ŒåŸºäºæ­¤ï¼ŒRNNå°†é¢„æµ‹ç¬¬61ä¸ªä»·æ ¼ã€‚è¿™é‡Œï¼ŒåŸºäºå®éªŒï¼Œè¿‡å»æ—¶é—´æˆ³çš„æ•°é‡è¢«è®¾ç½®ä¸º60ã€‚å› æ­¤ï¼Œ<em class="mf"> X_train </em>æ˜¯ä¸€ä¸ªåµŒå¥—åˆ—è¡¨ï¼Œå®ƒåŒ…å«60ä¸ªæ—¶é—´æˆ³ä»·æ ¼çš„åˆ—è¡¨ã€‚<em class="mf"> y_train </em>æ˜¯ç¬¬äºŒå¤©çš„è‚¡ç¥¨ä»·æ ¼åˆ—è¡¨ï¼Œå¯¹åº”<em class="mf"> X_train </em>ä¸­çš„å„ä¸ªåˆ—è¡¨ã€‚å…·ä½“æ¥è¯´ï¼Œ</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="2f44" class="mm mn it mi b gy mo mp l mq mr">X_train = []<br/>y_train = []<br/>for i in range(60, len(training_set_scaled)):<br/>    X_train.append(training_set_scaled[i-60: i, 0])<br/>    y_train.append(training_set_scaled[i, 0])<br/>    X_train, y_train = np.array(X_train), np.array(y_train)</span></pre><p id="d7f3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å›¾3æ˜¾ç¤ºäº†<em class="mf"> X_train </em>å’Œ<em class="mf"> y_train </em>çš„ç‰‡æ®µã€‚<em class="mf"> X_train </em>ä¸­æ¯ä¸€è¡Œ60ä¸ªä»·æ ¼ç”¨äºé¢„æµ‹<em class="mf"> y_train </em>ä¸­å¯¹åº”çš„ç¬¬äºŒå¤©è‚¡ç¥¨ä»·æ ¼ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/7fcbbb1ce171dd83f034ba9dff2a1cc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*spEaQMCDsLllDNkcziFTVg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾3 <em class="nk"> X_train </em>å’Œ<em class="nk"> y_train </em>æ•°æ®</p></figure><p id="0fa4" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">2.4æ•°æ®é‡å¡‘</p><p id="83c7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å¦‚ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬ç”¨<strong class="kx iu"> <em class="mf">å¼€ç›˜</em> </strong>ä»·æ ¼è¿›è¡Œé¢„æµ‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªæŒ‡æ ‡æˆ–ç‰¹å¾ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥æŒ‰ç…§åŒæ ·çš„æ•°æ®å¤„ç†æ–¹æ³•æ·»åŠ æ›´å¤šçš„æŒ‡æ ‡ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæŒ‡æ ‡çš„<strong class="kx iu">æ•°é‡æ·»åŠ ä¸€ä¸ªæ–°çš„ç»´åº¦ã€‚å…·ä½“æ¥è¯´ï¼Œ</strong></p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="61b0" class="mm mn it mi b gy mo mp l mq mr">X_train = np.reshape(X_train, newshape = (X_train.shape[0], X_train.shape[1], 1))</span></pre><p id="264b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><em class="mf">new shape</em>in(æ‰¹é‡å¤§å°ã€æ—¶é—´æˆ³æ•°é‡ã€æŒ‡ç¤ºå™¨æ•°é‡)ã€‚<em class="mf">(æ‰¹é‡å¤§å°ï¼Œæ—¶é—´æˆ³ä¸ªæ•°)æ˜¯X_train </em>çš„å½¢çŠ¶ã€‚è¿™é‡Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªæŒ‡æ ‡ã€‚</p><p id="7529" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å¤ªå¥½äº†ã€‚âœŒâœŒ.ï¼Œæˆ‘ä»¬æŠŠè®­ç»ƒå™¨æå‡†å¤‡å¥½äº†</p><p id="60e3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">3.<strong class="kx iu">æ¨¡å‹æ„å»º</strong></p><p id="4aa8" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">åŸºæœ¬ä¸Šï¼Œæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨LSTM </strong>æ„å»ºä¸€ä¸ªç”¨äºè¿ç»­å€¼é¢„æµ‹çš„ç¥ç»ç½‘ç»œå›å½’å™¨ã€‚é¦–å…ˆï¼Œåˆå§‹åŒ–æ¨¡å‹ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="c4e3" class="mm mn it mi b gy mo mp l mq mr">regressor = Sequential()</span></pre><p id="31d6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç„¶åï¼Œæ·»åŠ ç¬¬ä¸€ä¸ªLSTMå›¾å±‚ï¼Œæ¥ç€æ·»åŠ <strong class="kx iu">åˆ é™¤</strong>å›¾å±‚ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="295d" class="mm mn it mi b gy mo mp l mq mr">regressor.add(LSTM(units = 50, return_sequences = True, input_shape = (X_train.shape[1], 1)))</span><span id="fb1a" class="mm mn it mi b gy ms mp l mq mr">regressor.add(Dropout(rate = 0.2))</span></pre><p id="e4d1" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æ³¨æ„å¯¹äºLSTMå±‚ï¼Œ<em class="mf">å•ä½</em>æ˜¯è¯¥å±‚ä¸­LSTMç¥ç»å…ƒçš„æ•°é‡ã€‚50ä¸ªç¥ç»å…ƒå°†èµ‹äºˆæ¨¡å‹é«˜ç»´åº¦ï¼Œè¶³ä»¥æ•æ‰å‘ä¸Šå’Œå‘ä¸‹çš„è¶‹åŠ¿ã€‚<em class="mf"> return_sequences </em>ä¸ºçœŸï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨å½“å‰å›¾å±‚ä¹‹åæ·»åŠ å¦ä¸€ä¸ªLSTMå›¾å±‚ã€‚<em class="mf"> input_shape </em>å¯¹åº”çš„æ˜¯æ—¶é—´æˆ³çš„ä¸ªæ•°å’ŒæŒ‡ç¤ºå™¨çš„ä¸ªæ•°ã€‚å¯¹äºé€€å‡ºï¼Œ50ä¸ªç¥ç»å…ƒä¸­çš„20%å°†åœ¨è®­ç»ƒçš„æ¯æ¬¡è¿­ä»£ä¸­è¢«éšæœºå¿½ç•¥ã€‚</p><p id="6804" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æŒ‰ç…§ä¸Šè¿°ç›¸åŒçš„æ–¹æ³•ï¼Œæ·»åŠ ç¬¬äºŒï¼Œç¬¬ä¸‰å’Œç¬¬å››LSTMå±‚ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="7d57" class="mm mn it mi b gy mo mp l mq mr">##add 2nd lstm layer<br/>regressor.add(LSTM(units = 50, return_sequences = True))<br/>regressor.add(Dropout(rate = 0.2))</span><span id="2358" class="mm mn it mi b gy ms mp l mq mr">##add 3rd lstm layer<br/>regressor.add(LSTM(units = 50, return_sequences = True))<br/>regressor.add(Dropout(rate = 0.2))</span><span id="3c05" class="mm mn it mi b gy ms mp l mq mr">##add 4th lstm layer<br/>regressor.add(LSTM(units = 50, return_sequences = False))<br/>regressor.add(Dropout(rate = 0.2))</span></pre><p id="5158" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æ³¨æ„æœ€åä¸€ä¸ªLSTMå±‚ï¼Œ<em class="mf"> return_sequences </em>æ˜¯<strong class="kx iu"> <em class="mf"> False </em> </strong>ç”±äºæˆ‘ä»¬ä¸ä¼šæ·»åŠ æ›´å¤šçš„LSTMå±‚ã€‚</p><p id="a1a6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æœ€åï¼Œæ·»åŠ è¾“å‡ºå±‚ã€‚è¾“å‡ºç»´åº¦æ˜¯1ï¼Œå› ä¸ºæˆ‘ä»¬æ¯æ¬¡é¢„æµ‹1ä¸ªä»·æ ¼ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="2ae5" class="mm mn it mi b gy mo mp l mq mr">regressor.add(Dense(units = 1))</span></pre><p id="9d02" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å¤ªå¥½äº†ï¼æˆ‘ä»¬å·²ç»åˆ›å»ºäº†ä¸€ä¸ªåŸºäºLSTMçš„RNNæ¨¡å‹ğŸ§¨ğŸ§¨.</p><p id="0650" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">4.<strong class="kx iu">æ¨¡å‹ç¼–è¯‘</strong></p><p id="8690" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡é€‰æ‹©ä¸€ä¸ª<em class="mf"> SGD </em>ç®—æ³•å’Œä¸€ä¸ªæŸå¤±å‡½æ•°æ¥ç¼–è¯‘RNNã€‚å¯¹äºä¼˜åŒ–å™¨ï¼Œæˆ‘ä»¬ä½¿ç”¨<em class="mf"> Adam </em>ï¼Œè¿™æ˜¯ä¸€ä¸ªå®‰å…¨çš„é€‰æ‹©ã€‚æŸå¤±å‡½æ•°æ˜¯å®é™…å€¼å’Œé¢„æµ‹å€¼ä¹‹é—´çš„å‡æ–¹è¯¯å·®ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="6f0f" class="mm mn it mi b gy mo mp l mq mr">regressor.compile(optimizer = â€˜adamâ€™, loss = â€˜mean_squared_errorâ€™)</span></pre><p id="799f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">5.<strong class="kx iu">æ¨¡å‹æ‹Ÿåˆ</strong></p><p id="20f5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€‚åˆæˆ‘ä»¬çš„RNNã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="3d98" class="mm mn it mi b gy mo mp l mq mr">regressor.fit(x = X_train, y = y_train, batch_size = 32, epochs = 100)</span></pre><p id="b61f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">RNNæƒé‡æ¯32ä¸ªè‚¡ç¥¨ä»·æ ¼æ›´æ–°ä¸€æ¬¡ï¼Œæ‰¹é‡ä¸º32ä¸ªã€‚å¦‚æœæ¨¡å‹çš„æŸå¤±æ²¡æœ‰æ”¶æ•›ï¼Œè¯·éšæ„å°è¯•æ›´å¤šçš„æ‰¹æ¬¡å’Œæ—¶æœŸã€‚</p><p id="9f6b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å¤ªå¥½äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬å¼€å§‹è®­ç»ƒã€‚æœ€åï¼Œæˆ‘ä»¬å‘ç°ä»æŸå¤±<strong class="kx iu"> <em class="mf"> 0.062 </em> </strong>å¼€å§‹ï¼Œæˆ‘ä»¬åœ¨æ—¶æœŸ50å¾—åˆ°æŸå¤±<strong class="kx iu"><em class="mf">0.0026</em></strong><em class="mf"/>ï¼Œåˆ°æ—¶æœŸ100æŸå¤±<strong class="kx iu"><em class="mf">0.0015</em></strong><em class="mf"/>ğŸ‰ğŸ‰ã€‚</p><p id="387c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">6.<strong class="kx iu">æ¨¡å‹é¢„æµ‹</strong></p><p id="9213" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">6.1å¯¼å…¥æµ‹è¯•æ•°æ®</p><p id="24d3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ä½¿ç”¨ç¬¬2.1èŠ‚ä¸­çš„ç›¸åŒæ–¹æ³•ï¼Œè¯»å–æµ‹è¯•æ•°æ®ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="ee0e" class="mm mn it mi b gy mo mp l mq mr">dataset_test = pd.read_csv(â€˜Google_Stock_Price_Test.csvâ€™)</span><span id="9799" class="mm mn it mi b gy ms mp l mq mr">real_stock_price = dataset_test.iloc[:, 1: 2].values</span></pre><p id="f033" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">6.2æ•°æ®å¤„ç†</p><p id="f9cd" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è¿æ¥ç”¨äºé¢„æµ‹çš„è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨å‰60å¤©çš„è‚¡ç¥¨ä»·æ ¼æ¥é¢„æµ‹ç¬¬äºŒå¤©çš„ä»·æ ¼ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦æµ‹è¯•æ•°æ®é›†ä¸­ç¬¬ä¸€ä¸ªæ—¥æœŸä¹‹å‰60å¤©çš„ä»·æ ¼ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="e633" class="mm mn it mi b gy mo mp l mq mr">dataset_total = pd.concat((dataset_train[â€˜Openâ€™],dataset_test[â€˜Openâ€™]), axis = 0)</span></pre><p id="3aa6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç„¶åï¼Œä¸ºé¢„æµ‹åˆ›å»ºè¾“å…¥ï¼Œä»æµ‹è¯•æ•°æ®é›†ä¸­ç¬¬ä¸€ä¸ªæ—¥æœŸä¹‹å‰60å¤©çš„æ—¥æœŸå¼€å§‹ç´¢å¼•ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="2301" class="mm mn it mi b gy mo mp l mq mr">inputs = <br/>dataset_total[len(dataset_total)-len(dataset_test)- 60: ].values</span></pre><p id="944a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç¬¬ä¸‰ï¼Œæ”¹å˜è¾“å…¥çš„å½¢çŠ¶ï¼Œä½¿å…¶åªæœ‰ä¸€åˆ—ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="aebb" class="mm mn it mi b gy mo mp l mq mr">inputs = inputs.reshape(-1, 1)</span></pre><p id="f39d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç¬¬å››ï¼Œä½¿ç”¨ç”±è®­ç»ƒé›†è®¾ç½®çš„æ ‡åº¦ï¼Œå¯¹æµ‹è¯•è¾“å…¥è¿›è¡Œæ ‡åº¦ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="1ac9" class="mm mn it mi b gy mo mp l mq mr">inputs = sc.transform(inputs)</span></pre><p id="0894" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æœ€åï¼Œåˆ›å»ºæµ‹è¯•æ•°æ®ç»“æ„ï¼Œå¦‚ç¬¬2.3èŠ‚æ‰€è¿°ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="f220" class="mm mn it mi b gy mo mp l mq mr">X_test = []<br/>for i in range(60, len(inputs)): <br/>    X_test.append(inputs[i-60: i, 0])<br/>    X_test = np.array(X_test)<br/>    #make numpy array as 3D , adding num of indicator<br/>    X_test = np.reshape(X_test, newshape = (X_test.shape[0],  <br/>                        X_test.shape[1], 1))</span></pre><p id="01ec" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">6.3æ¨¡å‹é¢„æµ‹</p><p id="5904" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç°åœ¨ï¼Œ<em class="mf"> X_test </em>å‡†å¤‡å¥½é¢„æµ‹äº†ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="7c9f" class="mm mn it mi b gy mo mp l mq mr">predicted_stock_price = regressor.predict(X_test)</span></pre><p id="609c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">åˆ«å¿˜äº†ï¼Œæˆ‘ä»¬é¢„æµ‹çš„æ˜¯ç¼©æ”¾åçš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åè½¬é¢„æµ‹ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="8cbc" class="mm mn it mi b gy mo mp l mq mr">predicted_stock_price = sc.inverse_transform(predicted_stock_price)</span></pre><p id="3f5c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">7.<strong class="kx iu">ç»“æœå¯è§†åŒ–</strong></p><p id="7f48" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">åœ¨æœ€åä¸€æ­¥ä¸­ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¯è§†åŒ–å›¾æ¥è½»æ¾åœ°æ£€æŸ¥é¢„æµ‹ã€‚</p><pre class="kj kk kl km gt mh mi mj mk aw ml bi"><span id="58cb" class="mm mn it mi b gy mo mp l mq mr">plt.plot(real_stock_price, color = â€˜redâ€™, label = â€˜Real priceâ€™)<br/>plt.plot(predicted_stock_price, color = â€˜blueâ€™, label = â€˜Predicted priceâ€™)<br/>plt.title(â€˜Google price predictionâ€™)<br/>plt.xlabel(â€˜Timeâ€™)<br/>plt.ylabel(â€˜Priceâ€™)<br/>plt.legend()<br/>plt.show()</span></pre><p id="27ed" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å¦‚å›¾4å’Œå›¾5æ‰€ç¤ºï¼Œé¢„æµ‹æ»åäºçœŸå®å€¼ï¼Œå› ä¸ºæ¨¡å‹ä¸èƒ½å¯¹éçº¿æ€§å˜åŒ–åšå‡ºå¿«é€Ÿååº”ã€‚ä½†å¦ä¸€æ–¹é¢ï¼Œæ¨¡å‹å¯¹å¹³æ»‘å˜åŒ–ååº”è‰¯å¥½ã€‚<strong class="kx iu">å› æ­¤ï¼Œæˆ‘ä»¬å¾—å‡ºç»“è®ºï¼Œåœ¨åŒ…å«å³°å€¼çš„é¢„æµ‹éƒ¨åˆ†ï¼Œæ¨¡å‹æ»åäºå®é™…ä»·æ ¼ï¼Œä½†åœ¨åŒ…å«å¹³ç¨³å˜åŒ–çš„éƒ¨åˆ†ï¼Œæ¨¡å‹è®¾æ³•éµå¾ªå‘ä¸Šå’Œå‘ä¸‹çš„è¶‹åŠ¿</strong> âœ¨âœ¨.</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/2cefd56f978d8c9035a77b9c8e5c8e39.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*S-eJvPx_43IoHnswYsAKMQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾4å®é™…ä»·æ ¼ä¸é¢„æµ‹ä»·æ ¼</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/0c9d53ab332fcf09b9f563f2b0edb61b.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*LyoAVWmA46Zpgu8w8ACbdw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾5å¤§æ—¶é—´å°ºåº¦ä¸Šçš„é¢„æµ‹</p></figure><p id="1eb1" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">å¤ªå¥½äº†ï¼è¿™å°±æ˜¯æ‰€æœ‰çš„æ—…ç¨‹ï¼å¦‚æœéœ€è¦æºä»£ç ï¼Œè¯·è®¿é—®æˆ‘çš„</strong><a class="ae ku" href="https://github.com/luke4u/Time_Series_Forecasting" rel="noopener ugc nofollow" target="_blank"><strong class="kx iu">Github</strong></a><strong class="kx iu">é¡µé¢ğŸ¤ğŸ¤ã€‚</strong></p></div></div>    
</body>
</html>