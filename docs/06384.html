<html>
<head>
<title>Have a bot haunt your Slack workspace</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让一个机器人在你空闲的工作空间出没</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/have-a-bot-haunt-your-slack-workspace-1aa333bb1873?source=collection_archive---------59-----------------------#2020-05-21">https://towardsdatascience.com/have-a-bot-haunt-your-slack-workspace-1aa333bb1873?source=collection_archive---------59-----------------------#2020-05-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="33ef" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用 Python 快速创建你的自动化 Slack 机器人</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ea9594b468715da3191e3aa4f9e3a100.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C4fIfcJYzG0_01bxiyXGuw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://www.pexels.com/@scottwebb?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kw">斯科特·韦布</strong> </a>发自<a class="ae kv" href="https://www.pexels.com/photo/conceptual-creativity-design-display-430205/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kw"> Pexels </strong> </a></p></figure><p id="2344" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在本文中，我们将看到如何为<a class="ae kv" href="https://slack.com" rel="noopener ugc nofollow" target="_blank"> Slack </a>编写简单的 bot，并安排它定期运行。由于一些测试可能是必要的，我建议在本教程中创建一个虚拟的松弛工作空间。</p><h1 id="0c0f" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">为您的宽松工作空间添加一个 web 挂钩</h1><p id="1ce9" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">我们首先需要配置一个 web 钩子来与我们的 Slack 工作空间通信。进入<a class="ae kv" href="https://my.slack.com/services/new/incoming-webhook/" rel="noopener ugc nofollow" target="_blank">这个网址</a>，选择你的频道，点击添加一个网页挂钩。本教程我选择发帖到<code class="fe mq mr ms mt b">#random</code>频道。配置的其余部分可以保持不变，因此您可以保存它。</p><p id="3519" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">复制你的网页挂钩网址，其形式应该是<a class="ae kv" href="https://hooks.slack.com/services/SOME_GIBBERISH_CODE." rel="noopener ugc nofollow" target="_blank">https://hooks.slack.com/services/SOME_GIBBERISH_CODE.</a></p><h1 id="3df7" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">在本地运行 bot</h1><p id="7942" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">让我们在本地测试我们刚刚创建的 web 钩子的连接。我们将使用 python 库<a class="ae kv" href="https://github.com/satoshi03/slack-python-webhook" rel="noopener ugc nofollow" target="_blank"> slackweb </a>。代码很简单。我们会把这个放在<code class="fe mq mr ms mt b">slackbot.py</code>里。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="65c6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">将<code class="fe mq mr ms mt b">HOOK_URL</code>的内容替换为从上一步复制的钩子 URL。然后运行代码，检查是否有效；您应该在<code class="fe mq mr ms mt b">#random</code>中看到一条来自您的程序的消息。上面代码的第一行指定了要运行的 python 解释器的位置，如果文件包含 unicode 字符，如日语汉字或法语é，à等，则应该使用第二行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/9df3c3badab20ac1f404cf7e0fafa3f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/0*Ego__wp2tRnlbbRE.jpg"/></div></figure><h1 id="232f" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">安排节目</h1><p id="801b" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">你可以决定安排程序在你自己的电脑上运行，但是如果你想让它在你的电脑关机时也能运行，我们需要一个网络服务器。<a class="ae kv" href="https://www.pythonanywhere.com/" rel="noopener ugc nofollow" target="_blank"> PythonAnywhere </a>为开发目的提供免费的服务器空间和 python 环境。因此，让我们创建一个帐户，并前往我们的<a class="ae kv" href="https://www.pythonanywhere.com/dashboard/" rel="noopener ugc nofollow" target="_blank"> PythonAnywhere 仪表板</a>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/7781349874e512fd2a1548115e74d1d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WBqasPt-wBIUIi1n.jpg"/></div></div></figure><p id="4618" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">转到<em class="my">文件</em>选项卡，将您的文件<code class="fe mq mr ms mt b">slackbot.py</code>上传到您的目录<code class="fe mq mr ms mt b">/home/your_username/</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/bcfc4ac6797a54d01b656309c8c50bfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nhNKmzCAiGJeJNY2.jpg"/></div></div></figure><p id="239c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然后，让我们安装依赖项。打开一个 bash 终端并运行<code class="fe mq mr ms mt b">pip3 install --user slackweb</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/4d4d35d7c43ff062cd11bc548140e26c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vPlg_FLvNr1JejTm.jpg"/></div></div></figure><p id="b9d8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在同一个终端内，我们可以检查一切是否正常。运行<code class="fe mq mr ms mt b">python3 slackbot.py</code>，查看该消息是否再次出现在#random channel。</p><p id="3d95" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">调度在<em class="my">任务</em>选项卡中完成。通过指定运行的频率和命令来创建任务:<code class="fe mq mr ms mt b">/home/adamoudad/slackbot.py</code>。您可以在创建任务时看到任务的截止日期，大概是一个月。对于免费计划，PythonAnywhere 要求您每月至少登录一次，以使您的计划任务保持有效。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/d5fd66b766406f682c5ffe68dd73159d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ReHoQlooxq-MXUBE.jpg"/></div></div></figure><h1 id="6555" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="2b90" class="pw-post-body-paragraph kx ky iq kz b la ml jr lc ld mm ju lf lg mn li lj lk mo lm ln lo mp lq lr ls ij bi translated">就是这样！你让你的机器人在网上运行。它会萦绕在你松弛的工作空间，直到时间的尽头…真诚地。</p></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><p id="6e47" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="my">原载于 2020 年 5 月 21 日</em><a class="ae kv" href="https://adamoudad.github.io/posts/python-slack-bot/" rel="noopener ugc nofollow" target="_blank"><em class="my">https://adamoudad . github . io</em></a><em class="my">。</em></p></div></div>    
</body>
</html>