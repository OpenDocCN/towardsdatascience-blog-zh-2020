<html>
<head>
<title>Heart Attack Risk Prediction Using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习预测心脏病发作风险</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/heart-disease-risk-assessment-using-machine-learning-83335d077dad?source=collection_archive---------4-----------------------#2020-04-28">https://towardsdatascience.com/heart-disease-risk-assessment-using-machine-learning-83335d077dad?source=collection_archive---------4-----------------------#2020-04-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f71a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用机器学习的力量预防疾病</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/460ff64bf4276f8cd9cd77554501a191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pLbTX_7Ua2bnamElev9kZA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">安娜·科洛舒克在<a class="ae ky" href="https://unsplash.com/s/photos/heart?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h2 id="3f49" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">1.介绍</h2><p id="0f14" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">心脏病是全球发病率和死亡率的主要原因:它每年造成的死亡人数超过任何其他原因。根据 T4 世卫组织的数据，2016 年估计有 1790 万人死于心脏病，占全球死亡人数的 31%。超过四分之三的死亡发生在低收入和中等收入国家。</p><p id="b343" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在所有心脏病中，冠心病(又名心脏病发作)是最常见也是最致命的。以美国为例，据估计每 40 秒就有一人心脏病发作，每年约有<strong class="lx iu">80.5 万美国人</strong>心脏病发作(<a class="ae ky" href="https://www.cdc.gov/heartdisease/facts.htm" rel="noopener ugc nofollow" target="_blank"> CDC 2019 </a>)。</p><p id="138a" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">令人欣慰的是，心脏病发作是高度可预防的，简单的生活方式改变(如减少酒精和烟草的使用；健康饮食和锻炼)加上早期治疗大大改善了其预后。然而，由于诸如糖尿病、高血压、高胆固醇等几个促成风险因素的多因素性质，很难识别高风险患者。这就是机器学习和数据挖掘的救援之处。</p><p id="0334" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">医生和科学家都转向机器学习(ML)技术来开发筛选工具，这是因为与其他传统的统计方法相比，它们在模式识别和分类方面具有优势。</p><p id="5f49" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在这篇文章中，我将向您介绍一种筛选工具的开发过程，该工具使用不同的机器学习技术在<a class="ae ky" href="http://biolincc.nhlbi.nih.gov/studies/framcohort/" rel="noopener ugc nofollow" target="_blank"> Framingham 数据集</a>上预测患者是否有 10 年患冠心病的风险。</p><p id="4a4a" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这篇文章的代码可以在我的<a class="ae ky" href="https://github.com/amayomode/heart-disease-prediction/tree/master/Heart%20Disease%20Prediction" rel="noopener ugc nofollow" target="_blank"> Github 库</a>中找到，或者直接从它的伙伴<a class="ae ky" href="https://www.kaggle.com/amayomordecai/heart-disease-risk-prediction-machine-learning" rel="noopener ugc nofollow" target="_blank"> Kaggle 笔记本</a>中找到</p><h2 id="c735" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">2.数据集描述</h2><p id="4718" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">该数据集在 Kaggle 网站上公开，它来自一项正在进行的对马萨诸塞州弗雷明汉镇居民的心血管研究。分类目标是预测患者是否有未来冠心病(CHD)的 10 年风险。数据集提供了患者的信息。它包括 4000 多条记录和 15 个属性。每个属性都是潜在的风险因素。既有人口统计学上的，也有行为和医学上的风险因素。</p><h2 id="49c7" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">属性:</h2><ol class=""><li id="f474" class="mt mu it lx b ly lz mb mc li mv lm mw lq mx mn my mz na nb bi translated"><strong class="lx iu">人口统计</strong>:</li></ol><ul class=""><li id="5ee6" class="mt mu it lx b ly mo mb mp li nc lm nd lq ne mn nf mz na nb bi translated">性别:男性或女性(名义)</li><li id="16d1" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">年龄:患者的年龄；(连续——尽管记录的年龄被截断为整数，但年龄的概念是连续的)</li></ul><p id="fde3" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">2.<strong class="lx iu">教育</strong>:未提供进一步信息</p><p id="b3ee" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">3.<strong class="lx iu">行为</strong>:</p><ul class=""><li id="62a6" class="mt mu it lx b ly mo mb mp li nc lm nd lq ne mn nf mz na nb bi translated">当前吸烟者:患者是否是当前吸烟者(名义上)</li><li id="3ad8" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">每日吸烟量:一个人一天内平均吸烟的数量。(可以认为是连续的，因为一个人可以有任何数量的香烟，甚至半支香烟。)</li></ul><p id="5a62" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">4.<strong class="lx iu">病史信息</strong>:</p><ul class=""><li id="3ae3" class="mt mu it lx b ly mo mb mp li nc lm nd lq ne mn nf mz na nb bi translated">血压药物:患者是否在服用降压药(标称值)</li><li id="cbd7" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">流行性中风:患者以前是否曾患过中风(名义上)</li><li id="7df1" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">流行性高血压:患者是否患有高血压(正常)</li><li id="2881" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">糖尿病:患者是否患有糖尿病(名义上)</li></ul><p id="e02e" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">5.<strong class="lx iu">当前医疗状况信息</strong>:</p><ul class=""><li id="713e" class="mt mu it lx b ly mo mb mp li nc lm nd lq ne mn nf mz na nb bi translated">总胆固醇:总胆固醇水平(连续)</li><li id="74ce" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">系统血压:收缩压(持续)</li><li id="83df" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">Dia BP:舒张压(持续)</li><li id="c7a6" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">身体质量指数:身体质量指数(连续)</li><li id="aac0" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">心率:心率(连续)——在医学研究中，心率等变量虽然实际上是离散的，但由于有大量的可能值，因此被认为是连续的。)</li><li id="f675" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">葡萄糖:血糖水平(持续)</li></ul><h2 id="d50d" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">要预测的目标变量:</h2><p id="222f" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated"><em class="nl"> 10 年患冠心病的风险——(二进制:“1”，表示“有风险”，“0”，表示“没有风险”)</em></p><h2 id="ba8f" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">3.工具开发</h2><p id="6172" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">这篇文章的完整代码可以在<a class="ae ky" href="https://github.com/amayomode/heart-disease-prediction/tree/master/Heart%20Disease%20Prediction" rel="noopener ugc nofollow" target="_blank">这里</a>找到。它是用 Python 实现的，使用了不同的分类算法。以下是我所采用的一般方法的简要描述:</p><ol class=""><li id="143e" class="mt mu it lx b ly mo mb mp li nc lm nd lq ne mn my mz na nb bi translated"><strong class="lx iu">数据清理和预处理</strong>:这里我检查并处理了数据集中缺失和重复的变量，因为这些变量会严重影响不同机器学习算法的性能(许多算法不允许缺失数据)。</li><li id="f067" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn my mz na nb bi translated"><strong class="lx iu">探索性数据分析</strong>:这里我想从数据中获得重要的统计见解，我检查了不同属性的分布、属性之间的相关性以及目标变量，并计算了分类属性的重要概率和比例。</li><li id="c942" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn my mz na nb bi translated"><strong class="lx iu">特征选择</strong>:由于数据集中不相关的特征会降低所应用模型的准确性，我使用了 Boruta 特征选择技术来选择最重要的特征，这些特征后来被用于构建不同的模型。</li><li id="4a9e" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn my mz na nb bi translated"><strong class="lx iu">模型开发和比较</strong>:我使用了四种分类模型，分别是逻辑回归、K 近邻、决策树和支持向量机，之后我使用模型的精确度和 F1 值来比较模型的性能。然后我选择了表现最好的模特。</li></ol><p id="a126" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> 3.1 数据清理和预处理</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/f5a8d6f2646c41b44055a7392d67777e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G0Rft-HSFW-FuiR6cBMo1g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据集的前 20 条记录</p></figure><p id="396b" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">数据集中没有重复条目，但有些条目缺少值，下表给出了这些条目的汇总:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/023d61b8f46d94d71df48044dec3e083.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*nr4pBdK2ISFWAXsSaGVOTw.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每个要素缺失值的百分比</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/5b7ee2dafdf89160c039a7cc3fbd328c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*oZY-QDKIOrBoZfrCmxa_2w.png"/></div></figure><p id="e746" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在 9.15%的情况下，血糖条目的缺失数据百分比最高。其他功能几乎没有遗漏条目。</p><p id="dfec" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">丢失的条目只占全部数据的 12%,因此可以在不丢失大量数据的情况下被删除。</p><p id="eaaa" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> 3.2 探索性数据分析</strong></p><p id="4a42" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">第一步是检查不同属性的分布，这可以通过直方图最好地可视化</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/dfb7924623e872c803ee506fabc2c6ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sdmk7yhpwyJRXmsP2b_DMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据分布</p></figure><p id="df68" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">从分布图中挑选出分类变量和连续变量是很容易的。此外，可以看出，受访者中没有人患有流行性中风，极少数人患有糖尿病、服用降压药或高血压。这些分布也引起了数据集可能不适当平衡的怀疑，为了证实这一点，我比较了阳性和阴性病例的数量，与我的怀疑相符，有 3179 名应答者没有冠心病，572 名患者有冠心病。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/8ee71b8172a9b21713aa7d2f56751059.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*CzOqC_0XodQkIzWY6RLptA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不平衡数据集</p></figure><p id="710f" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">为了更深入地了解数据，我检查了每一类中阳性和阴性病例的比例。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/2c43f76355dfb6a2183971e447f48451.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9EMKjdfyUDyOhgr8eag84Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">分类可变比例</p></figure><p id="02c8" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">由于数据集的不平衡性质，很难做出结论，但根据观察到的情况，可以得出以下结论:</p><ul class=""><li id="3e97" class="mt mu it lx b ly mo mb mp li nc lm nd lq ne mn nf mz na nb bi translated">患冠心病的男性略多于女性。</li><li id="c1d6" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">吸烟者和不吸烟者患冠心病的比例几乎相等。</li><li id="cae9" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">与没有类似疾病的人相比，糖尿病患者和高血压患者中患冠心病的比例更高。</li><li id="8749" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">更大比例的冠心病患者正在服用降压药。</li></ul><p id="746c" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我检查的另一个有趣的趋势是冠心病患者的年龄分布，患病人数通常随着年龄的增长而增加，63 岁时达到高峰。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/fb79ece534b63eff6466dcc095f7afb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I6OshV09OAnB5kpGY8wCzw.png"/></div></div></figure><p id="64c3" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">最后一步是检查不同特征与目标变量以及彼此之间的相关性，因为这不仅可以很好地估计作为冠心病预测指标的特征强度，还可以揭示特征之间的任何<a class="ae ky" href="http://faculty.cas.usf.edu/mbrannick/regression/Collinearity.html" rel="noopener ugc nofollow" target="_blank">共线性</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/21c4d95f0cb8de95959286070b76b20f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O7th5UC0gqKx51rHq8evpw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">相关矩阵</p></figure><p id="0eec" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">从矩阵中可以看出，没有任何特征与 10 年内发生冠心病的风险之间的相关性超过 0.5，这表明这些特征是不良的预测因素。然而，相关性最高的特征是年龄、流行性高血压和收缩压。</p><p id="65b6" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">此外，有几个特征彼此高度相关，使用这两个特征来构建机器学习模型是没有意义的。其中包括:血糖和糖尿病(明显)；收缩压和舒张压；吸烟和每天吸烟的数量。</p><p id="11a8" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> 3.3 功能选择</strong></p><p id="a810" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">相关矩阵的结果提示需要进行特征选择。为此，我采用了<a class="ae ky" href="https://www.datasciencecentral.com/profiles/blogs/select-important-variables-using-boruta-algorithm" rel="noopener ugc nofollow" target="_blank"> Boruta 特征选择</a>算法，这是一种围绕<a class="ae ky" href="https://en.wikipedia.org/wiki/Random_forest" rel="noopener ugc nofollow" target="_blank">随机森林分类算法</a>构建的包装器方法。它试图捕捉与结果变量相关的数据集中所有重要的、有趣的特征。</p><p id="7d57" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">它的工作方式如下:</p><ul class=""><li id="e866" class="mt mu it lx b ly mo mb mp li nc lm nd lq ne mn nf mz na nb bi translated">首先，它通过创建所有特征(称为阴影特征)的混洗副本，给给定的数据集增加了随机性。</li><li id="be49" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">然后，它在扩展数据集上训练一个随机森林分类器，并应用一个特征重要性度量(默认为<a class="ae ky" href="https://www.thelearningmachine.ai/mda" rel="noopener ugc nofollow" target="_blank"> Mean Decrease Accuracy </a>)来评估每个特征的重要性，其中分数越高意味着特征越重要。</li><li id="f259" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">在每次迭代中，它会检查真实要素的重要性是否高于其最佳阴影要素(即，该要素的 Z 值是否高于其阴影要素的最大 Z 值)，并不断移除被认为非常不重要的要素。</li><li id="c22d" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn nf mz na nb bi translated">最后，当所有特征被确认或拒绝时，或者当算法达到随机森林运行的指定限制时，算法停止。</li></ul><p id="ad0d" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">点击查看完整描述<a class="ae ky" href="http://danielhomola.com/2015/05/08/borutapy-an-all-relevant-feature-selection-method/" rel="noopener ugc nofollow" target="_blank"/></p><p id="6499" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在运行该算法 100 次迭代后，最先选择的特征是:年龄、总胆固醇、收缩压、舒张压、身体质量指数、心率和血糖。</p><p id="c2f4" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">然后我计算了主要特征的优势比和十年内患冠心病的风险，结果如下:</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="3b5d" class="kz la it nv b gy nz oa l ob oc">CI 5%     CI 95%    Odds Ratio<br/>age        1.011381  1.033813    1.022536<br/>totChol    0.994963  0.999184    0.997071<br/>sysBP      1.018236  1.031493    1.024843<br/>diaBP      0.962258  0.984627    0.973378<br/>BMI        0.929304  0.973798    0.951291<br/>heartRate  0.963690  0.977730    0.970685<br/>glucose    1.001074  1.007518    1.004291</span></pre><p id="e54a" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在所有其他特征保持不变的情况下，年龄和收缩压每增加一个百分点，患心脏病的几率就会增加 2 个百分点。</p><p id="db86" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">其他因素显示没有明显的积极的可能性。</p><p id="a196" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> 3.4 模型开发和对比</strong></p><p id="ec03" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">不建议在不平衡数据集上训练分类器，因为它可能偏向一个类别，从而实现高精度，但具有较差的灵敏度或特异性。</p><p id="2525" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在我们的案例中，阴性病例的数量(3179)大大超过了阳性病例的数量(572)。例如，如果我们训练一个总是预测负面类别的模型，它将达到 84.75 %(3179/(3179+572) x 100)的高准确度，但灵敏度为 0% (0/(0+572) x 100)，因为它从不预测正面案例。</p><p id="3028" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">来解决这个问题。我使用合成少数过采样技术(SMOTE)平衡数据集。它是这样工作的:</p><blockquote class="od"><p id="36af" class="oe of it bd og oh oi oj ok ol om mn dk translated">SMOTE 首先随机选择一个少数类实例 x，并找到它的 k 个最近的少数类邻居。然后，通过随机选择 k 个最近邻居 x 中的一个并连接 x 和 x 以在特征空间中形成线段来创建合成实例。合成实例是作为两个选定实例 x 和 x 的凸组合生成的。—第 47 页，不平衡学习:基础、算法和应用，2013 年。</p></blockquote><figure class="oo op oq or os kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/9f1fb28b46cfbb510675a65550cd98f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*EIxCotw1E0M5WrDYYtRljQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://www.hindawi.com/journals/mpe/2013/694809/" rel="noopener ugc nofollow" target="_blank">胡风</a>通过<a class="ae ky" href="https://www.hindawi.com/journals/mpe/2013/694809/" rel="noopener ugc nofollow" target="_blank">辛达维</a> (CC0)拍摄</p></figure><p id="9120" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">该过程可用于根据需要为少数类创建尽可能多的合成示例。它建议首先使用随机欠采样来减少多数类中的样本数量，然后使用 SMOTE 对少数类进行过采样来平衡类分布。</p><p id="93f0" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">使用这种技术后，得到的数据集更加平衡，有 3178 个阴性病例和 2543 个阳性病例</p><pre class="kj kk kl km gt nu nv nw nx aw ny bi"><span id="fb6f" class="kz la it nv b gy nz oa l ob oc">Numbers before  {positive: 3179, negative: 572} <br/>Numbers after   {positive: 3178, negative: 2543}</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/c8e7a5fa0eea81e9358a34f5b126eb9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7VzKxun9qpRplsd3YRnbzQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">通过 SMOTE 平衡数据集</p></figure><p id="215d" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在平衡数据集之后，我缩放特征以加速分类器的训练，然后将数据分别以 0.8 比 0.2 的比例分成训练集和测试集</p><p id="b632" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">使用训练集，我训练了四个分类器，即:</p><ol class=""><li id="a2cf" class="mt mu it lx b ly mo mb mp li nc lm nd lq ne mn my mz na nb bi translated"><strong class="lx iu">逻辑回归</strong>:对数据点属于特定类别的概率进行建模，并根据选择的阈值为该点分配适当的标签。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/03d65b6e8a2667093984831559c3bbf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dm6ZaX5fuSmuVvM4Ds-vcg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://www.datacamp.com/profile/khanhle1013" rel="noopener ugc nofollow" target="_blank">詹姆斯·乐</a>通过<a class="ae ky" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fwww.datacamp.com%2Fcommunity%2Ftutorials%2Flogistic-regression-R&amp;psig=AOvVaw1tu3giJ7dvIrJdvld1_TXt&amp;ust=1588091566496000&amp;source=images&amp;cd=vfe&amp;ved=0CAMQjB1qFwoTCIj5_LaEiekCFQAAAAAdAAAAABAI" rel="noopener ugc nofollow" target="_blank">数据营</a> (CC0)</p></figure><p id="0e01" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> 2。K-nearest neighbors </strong>:试图通过查看一个数据点周围的数据点来确定该数据点属于哪个组。例如，给定一个数据点 C，如果它周围的大多数点都在组 A 中，那么很可能该数据点属于组 A 而不是组 B，反之亦然。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/34b8921e0de9c90476e66177c6225a05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*U9dOThJUekSHmdXrsSbr_A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://medium.com/@chaitanyareddypatlolla?source=post_page-----6851280d4c93----------------------" rel="noopener">柴坦尼亚·雷迪·帕托拉</a>通过<a class="ae ky" href="https://medium.com/datadriveninvestor/machine-learning-getting-started-with-k-nearest-neighbours-6851280d4c93" rel="noopener">媒介</a> (CC BY-NC-ND 2.0)</p></figure><p id="8b4d" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> 3。决策树</strong>:基于树状图形，节点代表我们选择属性和提出问题的位置；边代表问题的答案；树叶代表实际的输出或类别标签。决策树通过从根到某个叶节点对示例进行排序来对示例进行分类，叶节点为示例提供分类。树中的每个节点都充当某个属性的测试用例，从该节点开始向下延伸的每条边都对应于测试用例的一个可能答案。这个过程本质上是递归的，并且对以新节点为根的每个子树重复进行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/13d31d5191e3b27a52dfc5047057bb54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S10T4ah3_JqdQ-eY6Hau0Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图像由<a class="ae ky" href="https://dataaspirant.com/author/rahul-saxena/" rel="noopener ugc nofollow" target="_blank"> Rahul Saxena </a>通过<a class="ae ky" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fdataaspirant.com%2F2017%2F01%2F30%2Fhow-decision-tree-algorithm-works%2F&amp;psig=AOvVaw2edoz1eGedERpV3gamwnwj&amp;ust=1588092099583000&amp;source=images&amp;cd=vfe&amp;ved=0CAMQjB1qFwoTCOi5k5-GiekCFQAAAAAdAAAAABAU" rel="noopener ugc nofollow" target="_blank"> Dataaspirant </a> (CCo)拍摄</p></figure><p id="96d4" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> 4。支持向量机</strong>:由分离超平面形式定义的判别分类器。换句话说，给定标记的训练数据，该算法输出最佳超平面，该超平面基于新示例相对于它位于哪一侧来对新示例进行分类。在二维空间中，这个超平面是一条将平面分成两部分的线，每一类位于两边。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/3c72ba0ca48e47a9e8acae74ad0db8f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aPRrwHxf5hYpbmXTYLIlnQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Ffderyckel.github.io%2Fmachinelearningwithr%2Fsvm.html&amp;psig=AOvVaw3AyyyBipnHNdVZPkmu-3JG&amp;ust=1588092217619000&amp;source=images&amp;cd=vfe&amp;ved=0CAMQjB1qFwoTCMDqzOCGiekCFQAAAAAdAAAAABAJ" rel="noopener ugc nofollow" target="_blank">弗朗索瓦·德·瑞克尔</a>通过<a class="ae ky" href="https://fderyckel.github.io/machinelearningwithr/svm.html" rel="noopener ugc nofollow" target="_blank"> Github </a>提供(CC BY-NC-ND 2.0)</p></figure><p id="d9ec" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在训练每个模型并使用<a class="ae ky" href="https://scikit-learn.org/stable/modules/grid_search.html" rel="noopener ugc nofollow" target="_blank">网格搜索</a>调整它们的<a class="ae ky" href="https://en.wikipedia.org/wiki/Hyperparameter_(machine_learning)" rel="noopener ugc nofollow" target="_blank">超参数</a>之后，我使用以下指标评估并比较了它们的性能:</p><ol class=""><li id="c1d3" class="mt mu it lx b ly mo mb mp li nc lm nd lq ne mn my mz na nb bi translated"><strong class="lx iu">准确率:</strong>正确预测数与输入样本总数之比。它衡量算法对数据进行正确分类的趋势。</li><li id="e17d" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn my mz na nb bi translated"><strong class="lx iu">F1 分数</strong>:定义为测试<a class="ae ky" href="https://deepai.org/machine-learning-glossary-and-terms/precision-and-recall" rel="noopener ugc nofollow" target="_blank">精度和召回</a>的加权<a class="ae ky" href="https://deepai.org/machine-learning-glossary-and-terms/harmonic-mean" rel="noopener ugc nofollow" target="_blank">调和平均值</a>。通过使用精确度和召回率，它给出了测试性能的更现实的度量。(精确度，也称为阳性预测值，是真正阳性的阳性结果的比例。回忆，也称为敏感性，是一项测试正确识别阳性结果以获得真实阳性率的能力)。</li><li id="049b" class="mt mu it lx b ly ng mb nh li ni lm nj lq nk mn my mz na nb bi translated"><strong class="lx iu"/><a class="ae ky" href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic" rel="noopener ugc nofollow" target="_blank"><strong class="lx iu">ROC</strong></a><strong class="lx iu">曲线下的面积(AUC): </strong>提供了对所有可能的分类阈值性能的综合衡量。它给出了模型对随机正例的排序高于随机负例的概率</li></ol><p id="1705" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/19a96dfeae2303feef1183c0a759e271.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*x__9--2vYT9vaF86Fqx04Q.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">不同型号的性能得分</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/898efdbc1bc15b9bab32c298536c149d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b6KJCqmlK7AhQmU-flSp7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">精确度比较</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/1c51b7c4b7b28cd90cff1a3a04c0a8f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bpQ_cvZb4DnnIavf8ftxyA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">F1 分数对比</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/043273c87a23a684941bb4e5bb4cfcc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PKteKFa2KE0eZbmMbyoAxA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">AUC 的比较</p></figure><p id="ba04" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">支持向量机是所有指标中表现最好的模型。它的最佳参数是径向核，C 值为 10，gamma 值为 1。其高 AUC 和 F1 分数也表明该模型具有高的真阳性率，因此对于预测一个人是否具有发展为 CHD 的高风险(即在 10 年内患心脏病发作)是敏感的。</p><h2 id="5518" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">4.结论</h2><p id="ea6e" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">然后，该模型可以用作简单的筛选工具，我们所需要做的就是输入以下数据:年龄、身体质量指数、收缩压和舒张压、心率和血糖水平，然后该模型可以运行并输出预测。</p><p id="58c7" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">像所有优秀的科学家一样，我决定用我的个人数据来测试这个工具，结果如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/19444663daac2a40fc48391c35291781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D6ThzhK7pi50PTH_fqCTFA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">个人预测</p></figure><p id="d02c" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我可以有 84%的信心说，我在未来 10 年内没有患冠心病的风险🎉🎉。我相信这些预测，因为我确实锻炼过，至少偶尔会锻炼一下。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/a8fbac4f369149b136a6603e1fef95ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*u6b9DM5whH4Wqiynb9aGWQ.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://imgur.com/user/ilovecookiesandpancakes" rel="noopener ugc nofollow" target="_blank">迪伦·克尔</a>通过<a class="ae ky" href="https://imgur.com/hWyjp27" rel="noopener ugc nofollow" target="_blank"> imgur </a>提供</p></figure><p id="5a73" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">然而，作为健全性检查，关于阳性病例的大多数数据是使用 SMOTE 人工合成的，因此它们可能不是实际人群数据的真实代表，因此需要更多的数据，特别是关于阳性病例的数据，以建立更好的模型和更有效的筛选工具。</p></div><div class="ab cl pc pd hx pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="im in io ip iq"><p id="f0e6" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">感谢您的阅读。请随意分享你的想法和主意。</p></div></div>    
</body>
</html>