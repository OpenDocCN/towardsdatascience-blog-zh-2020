<html>
<head>
<title>What’s New In Python 3.9 Dictionaries?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 3.9 字典有什么新特性？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/whats-new-in-python-3-9-dictionaries-ddb5d18460da?source=collection_archive---------41-----------------------#2020-06-18">https://towardsdatascience.com/whats-new-in-python-3-9-dictionaries-ddb5d18460da?source=collection_archive---------41-----------------------#2020-06-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6814" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">首先看一下新的 union 操作符，它有助于合并和更新字典</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7370c89d7218313e600d3b9aa7efb87a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iTJLwSSf7KtuIAgL"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@freestocks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">自由库存</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="ae62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python 3.9 目前处于测试阶段，预计将于 2020 年 10 月发布，有很多东西值得期待。对于急切等待更新的 Python 开发人员来说，有一些有趣的补充，可以是新的字符串方法、拓扑排序或类型提示。</p><p id="20e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是对我来说最突出的是新的 union 操作符，它提供了一种更简洁的方式来合并或更新字典。在接下来的几节中，我们将看看新的 union 操作符如何使操作字典变得更加简单和简洁。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="c66f" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">合并或更新 Python 字典的旧方法</h1><p id="6e4a" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">字典是一种内置的 Python 数据类型，用于保存可变的、插入有序的键值对集合。在 Python 3.8 之前，我们通常使用<code class="fe mz na nb nc b">update</code>方法或<code class="fe mz na nb nc b">**</code>解包操作符，但是更新字典最简单的方法是插入一个键值对，如下所示:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="71d7" class="nh md it nc b gy ni nj l nk nl">d1 = {'a': 'Cat', 'b': 10}<br/>d1['type'] = 'animal'<br/>{'a': 'Cat', 'b': 10, 'type': 'animal'}</span></pre><p id="985f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是在用多个新的键-值对更新字典时，这并不会让我们走得太远。</p><p id="d35b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，<code class="fe mz na nb nc b">update()</code>方法显然是更好的选择:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="3e1d" class="nh md it nc b gy ni nj l nk nl">dict1 = {'a': 'Cat', 'b': 10}</span><span id="f242" class="nh md it nc b gy nm nj l nk nl">dict2 = {'c': 'Dog', 'd': 11}</span><span id="5142" class="nh md it nc b gy nm nj l nk nl">dict1.update(dict2)<br/>#prints {'a': 'Cat', 'b': 10, 'c': 'Dog', 'd': 11}</span></pre><p id="369c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然上面的方法对于更新字典很有效，但是对于合并字典，您需要依靠<code class="fe mz na nb nc b">copy()</code>方法。这是因为<code class="fe mz na nb nc b">update()</code>方法就地执行，会修改原始字典。因此，您必须创建第一个字典的克隆，以便在不进行修改的情况下进行合并，如下所示:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="80a8" class="nh md it nc b gy ni nj l nk nl">d3 = d1.copy()<br/>d3.update(d2)</span></pre><p id="89ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这看起来不错，但不是 pythonic 式的。通过使用双星号操作符<code class="fe mz na nb nc b">**</code>在单行代码中合并字典，我们可以做得更好。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="fa42" class="nh md it nc b gy ni nj l nk nl">dict4 = {**dict1, **dict2, **dict3}<br/>#or<br/>d3 = dict(d1, **d2)</span></pre><p id="a81a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然上面的方法很有效，当然也很简洁，但是有一个警告。对于像 Python 这样以可读性赢得加分的高级语言来说，上面的解包操作符对许多开发人员来说可能很难看。</p><p id="6ded" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">难怪 Python 3.9 中有两个新的 union 操作符。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3e1e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">新字典运算符</h1><p id="c557" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Python 3.9 以<code class="fe mz na nb nc b">|</code>和<code class="fe mz na nb nc b">|+</code>的形式引入了新的 clean union 操作符，分别用于合并和更新字典。</p><p id="9d16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了合并两个字典，我们像这样使用操作符:</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="13ca" class="nh md it nc b gy ni nj l nk nl">d3 = d1 | d2</span></pre><p id="557b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的操作符整齐地修剪了<code class="fe mz na nb nc b">copy()</code>和<code class="fe mz na nb nc b">update()</code>方法。此外，该操作符在 Python 中带来了一致的行为，因为它已经用于合并两个集合。</p><p id="9a1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同时，我们可以通过使用<code class="fe mz na nb nc b">|=</code>操作符来使用字典的就地合并或更新。它的工作方式与扩充赋值操作符<code class="fe mz na nb nc b">+=</code>相同。</p><pre class="kj kk kl km gt nd nc ne nf aw ng bi"><span id="0578" class="nh md it nc b gy ni nj l nk nl">d1 |= d2<br/>#equivalent to<br/>d1 = d1 | d2</span></pre><p id="63fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们在两个或更多字典中有公共键，那么在合并或更新操作中会从第二个或最后一个字典中选取键值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/2d1d4b266727ce60083610018d99d46b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D26HBlTyElLMgxV7KR19rQ.png"/></div></div></figure><p id="1b1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">重要的是要注意插入顺序的重要性，正如我们在上面看到的。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a065" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结束语</h1><p id="e498" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">Python 3.9 中推出的新的 union 操作符虽然很小，但是很受欢迎。好的一面是，在合并字典和可重复项时，它们也能工作。</p><p id="93d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一次到此为止。感谢阅读。</p></div></div>    
</body>
</html>