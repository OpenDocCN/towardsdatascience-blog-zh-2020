<html>
<head>
<title>Python packages in AWS Lambda made easy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AWS Lambda 中的 Python 包变得简单</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-packages-in-aws-lambda-made-easy-8fbc78520e30?source=collection_archive---------3-----------------------#2020-08-26">https://towardsdatascience.com/python-packages-in-aws-lambda-made-easy-8fbc78520e30?source=collection_archive---------3-----------------------#2020-08-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="eb75" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">创建自己的 Lambda 层的简单指南，这样你就可以在 Lambda 函数中使用任何 Python 包</h2></div><p id="0f1f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">AWS Lambda 是一个多功能的无服务器工具。有了 Lambda，你几乎可以运行任何你喜欢的东西——只需编写代码并上传到 Lambda。您每使用 100 毫秒就要付费，因此您只需为消耗的计算时间付费。</p><p id="e561" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Lambda 支持 Python，如果你有使用它的经验，这是一个很好的选择。然而，Lambda 的一个缺点是默认情况下你不能导入你信任的包，比如熊猫。</p><p id="77d6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将向您展示导入 Lambda 函数所需的任何包的最简单方法。我将以熊猫为例，但是同样的方法也可以用于其他的包。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/a59ba5a10e788d04769ebac84d339380.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C_a1asho9IOPr-vgXZlAiQ.jpeg"/></div></div></figure><h2 id="9aa5" class="lq lr it bd ls lt lu dn lv lw lx dp ly kr lz ma mb kv mc md me kz mf mg mh mi bi translated">步骤 1:在 AWS 中启动一个 Cloud9 Linux 实例</h2><ul class=""><li id="f37f" class="mj mk it kk b kl ml ko mm kr mn kv mo kz mp ld mq mr ms mt bi translated">在 AWS 服务中搜索 Cloud9</li><li id="57fe" class="mj mk it kk b kl mu ko mv kr mw kv mx kz my ld mq mr ms mt bi translated">点击“创建环境”</li><li id="cb8b" class="mj mk it kk b kl mu ko mv kr mw kv mx kz my ld mq mr ms mt bi translated">将您的环境命名为您喜欢的名称(例如 python_package_test ),然后单击下一步</li><li id="af97" class="mj mk it kk b kl mu ko mv kr mw kv mx kz my ld mq mr ms mt bi translated">保持环境默认设置(为环境创建一个新的 EC2 实例；t2.micro 亚马逊 Linux 等..)并点击下一步</li><li id="771b" class="mj mk it kk b kl mu ko mv kr mw kv mx kz my ld mq mr ms mt bi translated">点击“创建环境”,您就可以开始了</li></ul><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mz"><img src="../Images/e87b15c81404ddba81361c3a4394466d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VyMfQfB-GvlV_JGtLTsa5g.png"/></div></div></figure><h2 id="b6ee" class="lq lr it bd ls lt lu dn lv lw lx dp ly kr lz ma mb kv mc md me kz mf mg mh mi bi translated">步骤 2:创建你的熊猫 Lambda 层</h2><ul class=""><li id="c4fa" class="mj mk it kk b kl ml ko mm kr mn kv mo kz mp ld mq mr ms mt bi translated">在底部的终端中逐行键入以下代码。pip install pandas 命令可以替换为您选择的软件包。您也可以安装多个软件包*。</li></ul><pre class="lf lg lh li gt nb nc nd ne aw nf bi"><span id="0277" class="lq lr it nc b gy ng nh l ni nj">mkdir folder<br/>cd folder<br/>virtualenv v-env<br/>source ./v-env/bin/activate<br/>pip install pandas<br/>deactivate</span></pre><ul class=""><li id="6a40" class="mj mk it kk b kl km ko kp kr nk kv nl kz nm ld mq mr ms mt bi translated">然后逐行输入以下代码来创建图层</li></ul><pre class="lf lg lh li gt nb nc nd ne aw nf bi"><span id="15e1" class="lq lr it nc b gy ng nh l ni nj">mkdir python<br/>cd python<br/>cp -r ../v-env/lib64/python3.7/site-packages/* .<br/>cd ..<br/>zip -r panda_layer.zip python<br/>aws lambda publish-layer-version --layer-name pandas --zip-file fileb://panda_layer.zip --compatible-runtimes python3.7</span></pre><h2 id="28d1" class="lq lr it bd ls lt lu dn lv lw lx dp ly kr lz ma mb kv mc md me kz mf mg mh mi bi translated">步骤 3:添加熊猫层到 Lamda 函数中</h2><ul class=""><li id="bd60" class="mj mk it kk b kl ml ko mm kr mn kv mo kz mp ld mq mr ms mt bi translated">转到 AWS Lambda 服务并单击“创建函数”</li><li id="2497" class="mj mk it kk b kl mu ko mv kr mw kv mx kz my ld mq mr ms mt bi translated">命名您的函数，将运行时设置为“Python 3.6”，然后单击“创建函数”</li><li id="c62d" class="mj mk it kk b kl mu ko mv kr mw kv mx kz my ld mq mr ms mt bi translated">点击功能设计器中的“层”，然后点击“添加层”</li><li id="d1de" class="mj mk it kk b kl mu ko mv kr mw kv mx kz my ld mq mr ms mt bi translated">在名称下拉列表中，你应该看到你的熊猫层。点击“添加”。</li></ul><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nn"><img src="../Images/86fe0eaf09501170713d6e631562b1c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iC2BkYyWhwyA5pB4_lmByg.jpeg"/></div></div></figure><ul class=""><li id="8c0a" class="mj mk it kk b kl km ko kp kr nk kv nl kz nm ld mq mr ms mt bi translated">让我们用下面的脚本来测试这一点。<em class="na">注意，我也可以导入 numpy，因为它是熊猫包的依赖项:</em></li></ul><pre class="lf lg lh li gt nb nc nd ne aw nf bi"><span id="a59c" class="lq lr it nc b gy ng nh l ni nj">import numpy as np<br/>import pandas as pd</span><span id="c780" class="lq lr it nc b gy no nh l ni nj">def lambda_handler(event, context):<br/>    df2 = pd.DataFrame(np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]]),columns=["a", "b", "c"])<br/>    number = np.pi<br/>    print(df2)<br/>    print(number)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi np"><img src="../Images/0b2f7a9a88fa9940e9fb9684f470cf4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LhYjSW2kLguYvE0W4tEW5w.png"/></div></div></figure><p id="dc49" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">成功了！</strong>我们可以看到熊猫数据帧输出和 pi 的数字，证明 numpy 和熊猫已经成功导入。</p><p id="ffe8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">*限制:一个 Lambda 函数一次最多可以使用 5 层，但是，该函数和所有层的总解压缩大小不能超过 250 MB。</p></div></div>    
</body>
</html>