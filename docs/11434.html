<html>
<head>
<title>Happiness and Life Satisfaction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">幸福和生活满意度</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/happiness-and-life-satisfaction-ecdc7d0ab9a5?source=collection_archive---------5-----------------------#2020-08-08">https://towardsdatascience.com/happiness-and-life-satisfaction-ecdc7d0ab9a5?source=collection_archive---------5-----------------------#2020-08-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3fc3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">世界幸福报告的探索性数据分析。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7b60918771d9ab8d0810e03ae58b28c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wrqbnLa1Zs2qTLzew1F_tg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@freddydo" rel="noopener ugc nofollow" target="_blank">弗雷迪·多</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="8029" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">人生的目的是什么？那是幸福吗？为什么人们要经历所有的痛苦和艰难？是为了通过某种方式达到快乐吗？</p><p id="792a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我不是唯一相信生活的目的是幸福的人。环顾四周，大多数人的生活都在追求幸福。</p><p id="7dd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3 月 20 日<a class="ae ky" href="https://en.wikipedia.org/wiki/World_Happiness_Report" rel="noopener ugc nofollow" target="_blank"/>，全世界庆祝国际幸福日。2020 年的报告根据公民对自己生活的评价，对 156 个国家的幸福程度进行了排名。国民幸福排名是基于坎特里尔阶梯调查。全国范围内有代表性的受访者被要求想出一个阶梯，对他们来说最好的生活可能是 10，最差的可能是 0。然后他们被要求在 0 到 10 的范围内给自己目前的生活打分。该报告将结果与各种生活因素联系起来。在这些报告中，经济学、心理学、调查分析和国家统计方面的专家描述了如何有效地使用福祉测量来评估国家的进步和其他主题。</p><p id="58cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么，今天的人们有多幸福呢？以前的人是不是更舒服？不同社会的人对自己的生活有多满意？我们的生活条件是如何影响这一切的？</p><h1 id="3c77" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">分析的特征</h1><ul class=""><li id="9048" class="mn mo it lb b lc mp lf mq li mr lm ms lq mt lu mu mv mw mx bi translated"><strong class="lb iu"> GDP </strong>:人均 GDP 是衡量一个国家经济产出占其人口数量的指标。</li><li id="d595" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><strong class="lb iu">支持</strong>:社会支持意味着有朋友和其他人，包括家人，在需要或危机的时候向你求助，给你更广泛的关注和积极的自我形象。社会支持提高了生活质量，并为不良生活事件提供了缓冲。</li><li id="ab85" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><strong class="lb iu">健康</strong>:健康预期寿命是指新生儿可以预期生活在“完全健康”状态下的平均年数——换句话说，不受致残疾病或伤害的影响。</li><li id="25c5" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><strong class="lb iu">自由:</strong>选择的自由描述了个人从至少两个可用选项中选择行动的机会和自主性，不受外部各方的约束。</li><li id="afe9" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><strong class="lb iu">慷慨度</strong>:被定义为对“你在过去几个月里是否向慈善机构捐过钱？”这一问题的全国平均回答进行回归后的残差论人均 GDP。</li><li id="9950" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated"><strong class="lb iu">腐败</strong>:清廉指数(CPI)是透明国际自 1995 年以来每年发布的一项指数，它“根据专家评估和民意调查确定的公共部门腐败程度”对各国进行排名</li></ul><h1 id="6539" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">大纲:</h1><ol class=""><li id="e4db" class="mn mo it lb b lc mp lf mq li mr lm ms lq mt lu nd mv mw mx bi translated">导入模块，读取数据集并定义评估表</li><li id="e6b7" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu nd mv mw mx bi translated">定义一个函数来计算调整后的 R</li><li id="5d33" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu nd mv mw mx bi translated">幸福分数是如何分布的</li><li id="1ce5" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu nd mv mw mx bi translated">不同特征与幸福得分的关系。</li><li id="154b" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu nd mv mw mx bi translated">可视化和检查数据</li><li id="f6df" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu nd mv mw mx bi translated">多元线性回归</li><li id="f6ef" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu nd mv mw mx bi translated">结论</li></ol><p id="e6d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">给自己拿杯咖啡，和我一起踏上预测幸福的旅程吧！</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="b7ab" class="lv lw it bd lx ly nl ma mb mc nm me mf jz nn ka mh kc no kd mj kf np kg ml mm bi translated">1.导入模块，读取数据集并定义评估表</h1><p id="6b70" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">为了进行一些分析，我们需要设置我们的环境。首先，我们介绍一些模块并读取数据。下面的输出是数据的头，但是如果你想看到更多的细节，你可以去掉<code class="fe nt nu nv nw b">df_15.describe()</code>和<code class="fe nt nu nv nw b">df_15.info()</code>前面的#号</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="1983" class="ob lw it nw b gy oc od l oe of"># FOR NUMERICAL ANALYTICS<br/>import numpy as np</span><span id="adb8" class="ob lw it nw b gy og od l oe of"># TO STORE AND PROCESS DATA IN DATAFRAME<br/>import pandas as pd<br/>import os</span><span id="c453" class="ob lw it nw b gy og od l oe of"># BASIC VISUALIZATION PACKAGE<br/>import matplotlib.pyplot as plt</span><span id="eeb6" class="ob lw it nw b gy og od l oe of"># ADVANCED PLOTING<br/>import seaborn as seabornInstance</span><span id="3532" class="ob lw it nw b gy og od l oe of"># TRAIN TEST SPLIT<br/>from sklearn.model_selection import train_test_split</span><span id="ca50" class="ob lw it nw b gy og od l oe of"># INTERACTIVE VISUALIZATION<br/>import chart_studio.plotly as py <br/>import plotly.graph_objs as go<br/>import plotly.express as px<br/>from plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot<br/>init_notebook_mode(connected=True)</span><span id="3b71" class="ob lw it nw b gy og od l oe of">import statsmodels.formula.api as stats<br/>from statsmodels.formula.api import ols<br/>from sklearn import datasets<br/>from sklearn.linear_model import LinearRegression<br/>from sklearn.metrics import mean_squared_error<br/>from discover_feature_relationships import discover</span><span id="6bfd" class="ob lw it nw b gy og od l oe of">#2015 data<br/>df_15 = pd.read_csv('2015.csv')<br/>#df_15.describe()<br/>#df_15.info()<br/>usecols = ['Rank','Country','Score','GDP','Support',<br/>                'Health','Freedom','Generosity','Corruption']<br/>df_15.drop(['Region','Standard Error', 'Dystopia Residual'],axis=1,inplace=True) <br/>df_15.columns = ['Country','Rank','Score','Support',<br/>                'GDP','Health',<br/>                'Freedom','Generosity','Corruption']<br/>df_15['Year'] = 2015 #add year column<br/>df_15.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/8ad3ff8c33b29752597b5592fe7e64ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7h2mA6MeOiFUHfdV3M6hIw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输出</p></figure><p id="85f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我只呈现 2015 年的数据代码作为例子；你可以在其他年份做类似的事情。<br/>以<code class="fe nt nu nv nw b">Happiness</code>、<code class="fe nt nu nv nw b">Whisker</code>、<code class="fe nt nu nv nw b">Dystopia</code>开头的零件。<code class="fe nt nu nv nw b">Residual</code>目标不同。将每个国家的分数与世界上最不幸福的国家进行比较。由于这些年的数据有一点不同的命名约定，我们将把它们抽象成一个通用名称。</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="914e" class="ob lw it nw b gy oc od l oe of">target = ['Top','Top-Mid', 'Low-Mid', 'Low' ]<br/>target_n = [4, 3, 2, 1]</span><span id="bcd0" class="ob lw it nw b gy og od l oe of">df_15["target"] = pd.qcut(df_15['Rank'], len(target), labels=target)<br/>df_15["target_n"] = pd.qcut(df_15['Rank'], len(target), labels=target_n)</span></pre><p id="09fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们将所有数据文件合并到<code class="fe nt nu nv nw b">finaldf</code></p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="3568" class="ob lw it nw b gy oc od l oe of"># APPENDING ALL TOGUETHER<br/>finaldf = df_15.append([df_16,df_17,df_18,df_19])<br/># finaldf.dropna(inplace = True)</span><span id="f6c9" class="ob lw it nw b gy og od l oe of">#CHECKING FOR MISSING DATA<br/>finaldf.isnull().any()</span><span id="fdd8" class="ob lw it nw b gy og od l oe of"># FILLING MISSING VALUES OF CORRUPTION PERCEPTION WITH ITS MEAN<br/>finaldf.Corruption.fillna((finaldf.Corruption.mean()), inplace = True)<br/>finaldf.head(10)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/b8dff493c22f3ccc5735cfdd0c1b04c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mobYoVBjwHQ2oB6JLv4PKg.png"/></div></div></figure><p id="181e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过使用 describe()函数，我们可以看到数据集的统计细节:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/c2362b92f8374bbd436e197eff00f8e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cvPMS5RLKQKlu5mrqaSB0w.png"/></div></div></figure><p id="e04f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">进一步，我们定义一个空的<code class="fe nt nu nv nw b">dataframe</code>。这个<code class="fe nt nu nv nw b">dataframe</code>包括<code class="fe nt nu nv nw b">Root Mean Squared Error (RMSE)</code>、<code class="fe nt nu nv nw b">R-squared</code>、<code class="fe nt nu nv nw b">Adjusted R-squared</code>、<code class="fe nt nu nv nw b">mean of the R-squared values obtained by the k-Fold Cross-Validation</code>，是比较不同车型的必备指标。R 平方值越接近 1，RMSE 越小，表示拟合越好。在接下来的部分中，我们将用结果填充这个<code class="fe nt nu nv nw b">dataframe</code>。</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="8a7b" class="ob lw it nw b gy oc od l oe of">evaluation = pd.DataFrame({'Model':[],<br/>                          'Details':[],<br/>                          'Root Mean Squared Error (RMSE)': [],<br/>                          'R-squared (training)': [],<br/>                          'Adjusted R-squared (training)': [],<br/>                          'R-squared (test)':[],<br/>                          'Adjusted R-squared(test)':[],<br/>                           '5-Fold Cross Validation':[]<br/>                        })</span></pre></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="8ad8" class="lv lw it bd lx ly nl ma mb mc nm me mf jz nn ka mh kc no kd mj kf np kg ml mm bi translated">2.定义一个函数来计算调整后的 R</h1><p id="1afa" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Coefficient_of_determination" rel="noopener ugc nofollow" target="_blank">当特征数量增加时，R 平方</a>增加。有时，更强大的评估工具更适合用来比较不同模型之间的性能。该评估器称为调整后的 R 平方，只有当变量的增加降低了 MSE 时，它才会增加。调整后的 R 的定义是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/1954b23202d95ba5a6d7150f00c8db05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Pytenv_CFTj3YQNVx-fmQ.jpeg"/></div></div></figure></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="a5e3" class="lv lw it bd lx ly nl ma mb mc nm me mf jz nn ka mh kc no kd mj kf np kg ml mm bi translated">3.幸福分数是如何分布的</h1><p id="adfd" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">正如我们在下面看到的，幸福分数的值在 2.85 以上和 7.76 以下。所以没有一个国家的幸福指数高于 8。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/9710310064620848f43c8e501ef30634.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*khjmczbstHgbOchenWuBkg.png"/></div></figure><h1 id="ab6f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">4.不同特征与幸福得分的关系</h1><p id="7719" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">我们要预测幸福得分，所以我们这里的因变量是<code class="fe nt nu nv nw b">Score</code>其他特征如<code class="fe nt nu nv nw b">GPD</code> <code class="fe nt nu nv nw b">Support</code> <code class="fe nt nu nv nw b">Health</code>等。，是我们的自变量。</p><h2 id="0e89" class="ob lw it bd lx om on dn mb oo op dp mf li oq or mh lm os ot mj lq ou ov ml ow bi translated">人均国内生产总值</h2><p id="0ec8" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">我们首先使用散点图来观察变量之间的关系。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/2b98b123ed5432c29bf1c6db9ea44a47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*YD5uwTpjqhK_s-e6v2sjcA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者 Gif</p></figure><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="9fe7" class="ob lw it nw b gy oc od l oe of">'''Happiness score vs gdp per capital'''<br/>px.scatter(finaldf, x="GDP", y="Score", animation_frame="Year",<br/>           animation_group="Country",<br/>           size="Rank", color="Country", hover_name="Country",<br/>           trendline= "ols")</span><span id="498d" class="ob lw it nw b gy og od l oe of">train_data, test_data = train_test_split(finaldf, train_size = 0.8, random_state = 3)<br/>lr = LinearRegression()<br/>X_train = np.array(train_data['GDP'],<br/>                   dtype = pd.Series).reshape(-1,1)<br/>y_train = np.array(train_data['Score'], dtype = pd.Series)<br/>lr.fit(X_train, y_train)</span><span id="0a8e" class="ob lw it nw b gy og od l oe of">X_test = np.array(test_data['GDP'], <br/>                    dtype = pd.Series).reshape(-1,1)<br/>y_test = np.array(test_data['Score'], dtype = pd.Series)</span><span id="7ca7" class="ob lw it nw b gy og od l oe of">pred = lr.predict(X_test)</span><span id="8625" class="ob lw it nw b gy og od l oe of">#ROOT MEAN SQUARED ERROR<br/>rmsesm = float(format(np.sqrt(metrics.mean_squared_error(y_test,pred)),'.3f'))</span><span id="81eb" class="ob lw it nw b gy og od l oe of">#R-SQUARED (TRAINING)<br/>rtrsm = float(format(lr.score(X_train, y_train),'.3f'))</span><span id="17cb" class="ob lw it nw b gy og od l oe of">#R-SQUARED (TEST)<br/>rtesm = float(format(lr.score(X_test, y_test),'.3f'))</span><span id="b55d" class="ob lw it nw b gy og od l oe of">cv = float(format(cross_val_score(lr,finaldf[['GDP']],finaldf['Score'],cv=5).mean(),'.3f'))</span><span id="6cfa" class="ob lw it nw b gy og od l oe of">print ("Average Score for Test Data: {:.3f}".format(y_test.mean()))<br/>print('Intercept: {}'.format(lr.intercept_))<br/>print('Coefficient: {}'.format(lr.coef_))</span><span id="99fe" class="ob lw it nw b gy og od l oe of">r = evaluation.shape[0]<br/>evaluation.loc[r] = ['Simple Linear Regression','-',rmsesm,rtrsm,'-',rtesm,'-',cv]<br/>evaluation</span></pre><p id="75d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过使用这些值和下面的定义，我们可以手动估计幸福分数。我们用于估计的方程称为假设函数，定义如下</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/5a952e39ad4a99ba7d4edae42143d7fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*oE8o0IjoF3hHEJpUO5yXQw.jpeg"/></div></div></figure><p id="7c08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还打印了简单线性回归的截距和系数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/31a967b848513325c1d436fed9b5c6b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lqKcZ2m6uzprDTCnk_BTjg.png"/></div></div></figure><p id="cfee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们展示结果，好吗？</p><p id="88b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为在简单回归中我们只有两个维度，所以很容易画出来。下图确定了简单回归的结果。它看起来不像是完美的拟合，但当我们处理真实世界的数据集时，获得理想的拟合并不容易。</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="494b" class="ob lw it nw b gy oc od l oe of">seabornInstance.set_style(style='whitegrid')</span><span id="9ce1" class="ob lw it nw b gy og od l oe of">plt.figure(figsize=(12,6))<br/>plt.scatter(X_test,y_test,color='blue',label="Data", s = 12)<br/>plt.plot(X_test,lr.predict(X_test),color="red",label="Predicted Regression Line")<br/>plt.xlabel("GDP per Captita", fontsize=15)<br/>plt.ylabel("Happiness Score", fontsize=15)<br/>plt.xticks(fontsize=13)<br/>plt.yticks(fontsize=13)<br/>plt.legend()</span><span id="0fb1" class="ob lw it nw b gy og od l oe of">plt.gca().spines['right'].set_visible(False)<br/>plt.gca().spines['top'].set_visible(False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/d97ce082e87a2809e8a2613a35f48791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BIf69IY5D2L-3xs9oLg6Tg.png"/></div></div></figure><p id="3057" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">人均 GDP(国家的经济)的关系与幸福得分有很强的正相关关系，即如果一个国家的人均 GDP 高于该国的幸福得分，也更有可能高。</p><h2 id="6de2" class="ob lw it bd lx om on dn mb oo op dp mf li oq or mh lm os ot mj lq ou ov ml ow bi translated">支持</h2><blockquote class="pb pc pd"><p id="5000" class="kz la pe lb b lc ld ju le lf lg jx lh pf lj lk ll pg ln lo lp ph lr ls lt lu im bi translated">为了保持文章简短，我不会在这部分包含代码。代码类似于上面的 GDP 特性。我建议你自己努力实现。我会在本文末尾附上链接，以供参考。</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/96f00801139feded5755f29c9cfc7128.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*_AOmIGYLjOqP7aq4wc7tmw.gif"/></div></div></figure><p id="9182" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">国家的社会支持与幸福得分也有很强的正相关关系。所以，我们需要社会支持来获得幸福是有道理的。人们也有情绪，我们在社会环境中体验这些情绪。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/932241522bc028db9d6320d5bd744430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UL5w7y5YulYLEFSucgFbDw.png"/></div></div></figure><h2 id="979e" class="ob lw it bd lx om on dn mb oo op dp mf li oq or mh lm os ot mj lq ou ov ml ow bi translated">健康预期寿命</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/1f024ec7d4bb844e6eec17f0a07577eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*qLCGSWOdWIQnWSmg9hOQDw.gif"/></div></figure><p id="21f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">健康的预期寿命与幸福指数有很强的正相关关系，也就是说，如果一个国家的预期寿命很高，它也可以有很高的幸福指数。快乐不仅仅是提高一个人的生活质量。它也可以增加我们生活的质量。如果我健康长寿，我也会很开心。你呢。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/e7acb716889085b0318a4c466ae687d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ucxfnVTLCZEl3MHOFTDhRQ.png"/></div></div></figure><h2 id="feca" class="ob lw it bd lx om on dn mb oo op dp mf li oq or mh lm os ot mj lq ou ov ml ow bi translated">做出人生选择的自由</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/70b13fe10cf5024ed139aaeaefd89f49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*sjbttkgkfknVbvYs6Mrwbw.gif"/></div></figure><p id="b7b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">做出生活选择的自由与幸福指数成正相关。与拥有大量金钱相比，选择和自主与幸福更直接相关。它给了我们选择去追求生活的意义，去寻找刺激我们的活动。这是感到快乐的一个重要方面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/aa9f09bc2527a64aef548b394e2b5448.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YukhEjmFBC7QdqzswHD7TA.png"/></div></div></figure><p id="fd38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">慷慨</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/c6a426fc20e946ea506a102893d6c82c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*iOrHXMKdL92ZiHjBd42hRg.gif"/></div></figure><p id="45ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">慷慨与幸福分数之间存在脆弱的线性关系。为什么慈善和幸福得分没有直接关系？慷慨度得分是根据世界上向非营利组织捐赠最多的国家来计算的。不慷慨的国家并不意味着他们不快乐。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/d98eaa4b619ecd309568101abe492afc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DE5IXe9wlcTYbHobQDEHAg.png"/></div></div></figure><p id="bd5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">对腐败的看法</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/aaa6f6b4aae7c2afce85709e2caf9e28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*B1sUSMxpUgmUb_IM_djY4A.gif"/></div></figure><p id="793e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对腐败看法的分布是正确的，这意味着对腐败有高度看法的国家很少。这意味着该国大部分地区都存在腐败问题。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/40ecff6c9c4124037ea52d07cc5fb1cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*DR5fdPui8DN7DCF9bpAbRg.png"/></div></figure><p id="c66e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">腐败特征如何影响幸福得分？</strong></p><p id="6ed6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对腐败数据的看法高度扭曲，难怪这些数据的线性关系很弱。尽管如此，正如我们在散点图中看到的，大多数数据点都在左侧，大多数对腐败看法较低的国家的幸福指数都在 4 到 6 之间。感知分高的国家，幸福分也高，在 7 分以上。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/8975d963b1f87285fd923b7ee167d01c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wzyb7Mzp2FkkGXlQKBt2fA.png"/></div></div></figure><h1 id="1a88" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">5.可视化和检查数据</h1><p id="5e8a" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">我们没有包含太多功能的大数据。因此，我们有机会绘制出它们中的大部分，并得出一些有用的分析结果。在应用模型之前绘制图表并检查数据是一个很好的做法，因为我们可能会检测到一些可能的异常值或决定进行归一化。这一步不是必须的，但是要知道数据总是有用的。我们从<code class="fe nt nu nv nw b">dataframe</code>的直方图开始。</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="b5e6" class="ob lw it nw b gy oc od l oe of"># DISTRIBUTION OF ALL NUMERIC DATA<br/>plt.rcParams['figure.figsize'] = (15, 15)<br/>df1 = finaldf[['GDP', 'Health', 'Freedom',<br/>              'Generosity','Corruption']]</span><span id="8785" class="ob lw it nw b gy og od l oe of">h = df1.hist(bins = 25, figsize = (16,16),<br/>             xlabelsize = '10', ylabelsize = '10')<br/>seabornInstance.despine(left = True, bottom = True)<br/>[x.title.set_size(12) for x in h.ravel()];<br/>[x.yaxis.tick_left() for x in h.ravel()]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/2b9d5384147c8cbea920b89424f05126.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eBiXWNnwA0_4hKLybk7fNg.png"/></div></div></figure><p id="ea65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，为了让我们更直观地了解每个国家在世界排名报告中的排名，我们使用深蓝色代表在报告中排名最高的国家(即“最幸福”)，而浅蓝色代表排名较低的国家。我们可以看到，欧洲和美洲地区的国家比亚洲和非洲地区的国家排名要高。</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="7497" class="ob lw it nw b gy oc od l oe of">'''World Map<br/>Happiness Rank Accross the World'''</span><span id="a6b1" class="ob lw it nw b gy og od l oe of">happiness_rank = dict(type = 'choropleth', <br/>           locations = finaldf['Country'],<br/>           locationmode = 'country names',<br/>           z = finaldf['Rank'], <br/>           text = finaldf['Country'],<br/>           colorscale = 'Blues_',<br/>           autocolorscale=False,<br/>           reversescale=True,<br/>           marker_line_color='darkgray',<br/>           marker_line_width=0.5)<br/>layout = dict(title = 'Happiness Rank Across the World', <br/>             geo = dict(showframe = False, <br/>                       projection = {'type': 'equirectangular'}))<br/>world_map_1 = go.Figure(data = [happiness_rank], layout=layout)<br/>iplot(world_map_1)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/52fd6d8d7dfb9bfc689edcccefd6463a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*fh9dJtl7Xwg8xlyzIx0_Jg.gif"/></div></figure><p id="ec6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来看看哪些国家在所分析的每个方面都有更好的定位。</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="5c1d" class="ob lw it nw b gy oc od l oe of">fig, axes = plt.subplots(nrows=3, ncols=2,constrained_layout=True,figsize=(10,10))</span><span id="2cf5" class="ob lw it nw b gy og od l oe of">seabornInstance.barplot(x='GDP',y='Country',<br/>                        data=finaldf.nlargest(10,'GDP'),<br/>                        ax=axes[0,0],palette="Blues_r")<br/>seabornInstance.barplot(x='Health' ,y='Country',<br/>                        data=finaldf.nlargest(10,'Health'),<br/>                        ax=axes[0,1],palette='Blues_r')<br/>seabornInstance.barplot(x='Score' ,y='Country',<br/>                        data=finaldf.nlargest(10,'Score'),<br/>                        ax=axes[1,0],palette='Blues_r')<br/>seabornInstance.barplot(x='Generosity' ,y='Country',<br/>                        data=finaldf.nlargest(10,'Generosity'),<br/>                        ax=axes[1,1],palette='Blues_r')<br/>seabornInstance.barplot(x='Freedom' ,y='Country',<br/>                        data=finaldf.nlargest(10,'Freedom'),<br/>                        ax=axes[2,0],palette='Blues_r')<br/>seabornInstance.barplot(x='Corruption' ,y='Country',<br/>                        data=finaldf.nlargest(10,'Corruption'),<br/>                        ax=axes[2,1],palette='Blues_r')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi gj"><img src="../Images/9125b128999e7dafe08d20377ff3c510.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ljRd_H-VLQLXoBOhR7ml_A.png"/></div></div></figure><h2 id="ed59" class="ob lw it bd lx om on dn mb oo op dp mf li oq or mh lm os ot mj lq ou ov ml ow bi translated">检验解释变量之间的相关性</h2><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="9423" class="ob lw it nw b gy oc od l oe of">mask = np.zeros_like(finaldf[usecols].corr(), dtype=np.bool) <br/>mask[np.triu_indices_from(mask)] = True</span><span id="d495" class="ob lw it nw b gy og od l oe of">f, ax = plt.subplots(figsize=(16, 12))<br/>plt.title('Pearson Correlation Matrix',fontsize=25)</span><span id="b2a2" class="ob lw it nw b gy og od l oe of">seabornInstance.heatmap(finaldf[usecols].corr(),<br/>                        linewidths=0.25,vmax=0.7,square=True,cmap="Blues", <br/>            linecolor='w',annot=True,annot_kws={"size":8},mask=mask,cbar_kws={"shrink": .9});</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/d569426f7b815195c32a977c9bb94921.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gCL1Cs5iF3LBCitMwJdNBg.png"/></div></div></figure><p id="d399" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看起来<code class="fe nt nu nv nw b">GDP</code>、<code class="fe nt nu nv nw b">Health</code>和<code class="fe nt nu nv nw b">Support</code>与幸福指数密切相关。<code class="fe nt nu nv nw b">Freedom</code>与幸福指数有很好的相关性；然而，<code class="fe nt nu nv nw b">Freedom</code>与所有数据连接得相当好。<code class="fe nt nu nv nw b">Corruption</code>与幸福得分的相关性仍然一般。</p><h2 id="169e" class="ob lw it bd lx om on dn mb oo op dp mf li oq or mh lm os ot mj lq ou ov ml ow bi translated">超越简单的关联</h2><p id="f7dd" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">在散点图中，我们可以看到<code class="fe nt nu nv nw b">GDP</code>、<code class="fe nt nu nv nw b">Health</code>和<code class="fe nt nu nv nw b">Support</code>与某些噪声呈线性相关。我们发现<code class="fe nt nu nv nw b">Corruption</code>的自相关在这里很迷人，这里一切都很可怕，但如果腐败程度很高，分布到处都是。它似乎只是一个阈值的负面指标。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/4d741be6e5d2ed78b7189b8b7369aa04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3UZsnZ0ah5eLvT5SI4YQzw.png"/></div></div></figure><p id="4ca2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我发现了一个令人兴奋的由 Ian Ozsvald 设计的软件包。它训练随机森林来预测彼此的特征，超越了简单的相关性。</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="c4ff" class="ob lw it nw b gy oc od l oe of"># visualize hidden relationships in data<br/>classifier_overrides = set()<br/>df_results = discover.discover(finaldf.drop(['target', 'target_n'],axis=1).sample(frac=1),<br/>                               classifier_overrides)</span></pre><p id="f704" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们在这里使用热图来可视化我们的要素是如何在空间上聚集或变化的。</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="f87d" class="ob lw it nw b gy oc od l oe of">fig, ax = plt.subplots(ncols=2,figsize=(24, 8))<br/>seabornInstance.heatmap(df_results.pivot(index = 'target', <br/>                             columns = 'feature', <br/>                             values = 'score').fillna(1).loc[finaldf.drop(<br/>                            ['target', 'target_n'],axis = 1).columns,finaldf.drop(<br/>                            ['target', 'target_n'],axis = 1).columns],<br/>                            annot=True, center = 0, ax = ax[0], vmin = -1, vmax = 1, cmap = "Blues")<br/>seabornInstance.heatmap(df_results.pivot(index = 'target', <br/>                             columns = 'feature', <br/>                             values = 'score').fillna(1).loc[finaldf.drop(<br/>                             ['target', 'target_n'],axis=1).columns,finaldf.drop(<br/>                             ['target', 'target_n'],axis=1).columns],<br/>                             annot=True, center=0, ax=ax[1], vmin=-0.25, vmax=1, cmap="Blues_r")<br/>plt.plot()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/f17f0276a6220a3966bccd22f87f158b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wENZoojkdOoTkpi_5xweiQ.png"/></div></div></figure><p id="5ec2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这变得更有趣了。腐败比支持更能预测幸福指数。可能是因为我们之前发现的“门槛”？</p><p id="7f7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，虽然社会支持有很好的相关性，但它没有实质性的预测价值。我猜这是因为散点图中所有四分位数的分布都非常接近。</p><h1 id="c145" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">6.多元线性回归</h1><p id="bee0" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">在本文的“渴望”一节中，我们使用了一个简单的线性回归来检验幸福指数和其他特征之间的关系。我们发现不适合。为了改进这个模型，我们想增加更多的功能。现在，是时候创建一些复杂的模型了。</p><p id="aec4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过查看前面的部分，我们初步确定了特征，并在第一次多元线性回归中使用了它们。与简单回归一样，我们打印了模型用于预测的系数。然而，如果我们想手工计算，这次我们必须使用下面的预测定义。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/ea75dbeabef627367d0d28b058ca59b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gzCzhVEzPCCqoAaGzF_tvQ.jpeg"/></div></div></figure><p id="f115" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们创建一个具有所有特征的模型。</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="5dbc" class="ob lw it nw b gy oc od l oe of"># MULTIPLE LINEAR REGRESSION 1<br/>train_data_dm,test_data_dm = train_test_split(finaldf,train_size = 0.8,random_state=3)</span><span id="d008" class="ob lw it nw b gy og od l oe of">independent_var = ['GDP','Health','Freedom','Support','Generosity','Corruption']<br/>complex_model_1 = LinearRegression()<br/>complex_model_1.fit(train_data_dm[independent_var],train_data_dm['Score'])</span><span id="3081" class="ob lw it nw b gy og od l oe of">print('Intercept: {}'.format(complex_model_1.intercept_))<br/>print('Coefficients: {}'.format(complex_model_1.coef_))<br/>print('Happiness score = ',np.round(complex_model_1.intercept_,4),<br/>      '+',np.round(complex_model_1.coef_[0],4),'∗ Support',<br/>      '+',np.round(complex_model_1.coef_[1],4),'* GDP', <br/>      '+',np.round(complex_model_1.coef_[2],4),'* Health',<br/>      '+',np.round(complex_model_1.coef_[3],4),'* Freedom',<br/>       '+',np.round(complex_model_1.coef_[4],4),'* Generosity',<br/>      '+',np.round(complex_model_1.coef_[5],4),'* Corrption')</span><span id="0654" class="ob lw it nw b gy og od l oe of">pred = complex_model_1.predict(test_data_dm[independent_var])<br/>rmsecm = float(format(np.sqrt(metrics.mean_squared_error(<br/>                       test_data_dm['Score'],pred)),'.3f'))<br/>rtrcm = float(format(complex_model_1.score(<br/>                        train_data_dm[independent_var],<br/>                        train_data_dm['Score']),'.3f'))<br/>artrcm = float(format(adjustedR2(complex_model_1.score(<br/>                            train_data_dm[independent_var],<br/>                            train_data_dm['Score']),<br/>                            train_data_dm.shape[0],<br/>                            len(independent_var)),'.3f'))<br/>rtecm = float(format(complex_model_1.score(<br/>                        test_data_dm[independent_var],<br/>                        test_data_dm['Score']),'.3f'))<br/>artecm = float(format(adjustedR2(complex_model_1.score(<br/>                        test_data_dm[independent_var],test_data['Score']),<br/>                        test_data_dm.shape[0],<br/>                        len(independent_var)),'.3f'))<br/>cv = float(format(cross_val_score(complex_model_1,<br/>                    finaldf[independent_var],<br/>                    finaldf['Score'],cv=5).mean(),'.3f'))</span><span id="a501" class="ob lw it nw b gy og od l oe of">r = evaluation.shape[0]<br/>evaluation.loc[r] = ['Multiple Linear Regression-1','selected features',rmsecm,rtrcm,artrcm,rtecm,artecm,cv]<br/>evaluation.sort_values(by = '5-Fold Cross Validation', ascending=False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pr"><img src="../Images/b76549996b2330e7d5cbf95c798b6498.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E02bmb7ku0KHbnj43YsrnQ.png"/></div></div></figure><p id="295f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们知道<code class="fe nt nu nv nw b">GDP</code>、<code class="fe nt nu nv nw b">Support</code>和<code class="fe nt nu nv nw b">Health</code>是线性相关的。这一次，我们创建一个具有这三个特征的模型。</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="394a" class="ob lw it nw b gy oc od l oe of"># MULTIPLE LINEAR REGRESSION 2<br/>train_data_dm,test_data_dm = train_test_split(finaldf,train_size = 0.8,random_state=3)</span><span id="9559" class="ob lw it nw b gy og od l oe of">independent_var = ['GDP','Health','Support']<br/>complex_model_2 = LinearRegression()<br/>complex_model_2.fit(train_data_dm[independent_var],train_data_dm['Score'])</span><span id="052a" class="ob lw it nw b gy og od l oe of">print('Intercept: {}'.format(complex_model_2.intercept_))<br/>print('Coefficients: {}'.format(complex_model_2.coef_))<br/>print('Happiness score = ',np.round(complex_model_2.intercept_,4),<br/>      '+',np.round(complex_model_2.coef_[0],4),'∗ Support',<br/>      '+',np.round(complex_model_2.coef_[1],4),'* GDP', <br/>      '+',np.round(complex_model_2.coef_[2],4),'* Health')</span><span id="db6d" class="ob lw it nw b gy og od l oe of">pred = complex_model_2.predict(test_data_dm[independent_var])<br/>rmsecm = float(format(np.sqrt(metrics.mean_squared_error(<br/>                       test_data_dm['Score'],pred)),'.3f'))<br/>rtrcm = float(format(complex_model_2.score(<br/>                        train_data_dm[independent_var],<br/>                        train_data_dm['Score']),'.3f'))<br/>artrcm = float(format(adjustedR2(complex_model_2.score(<br/>                            train_data_dm[independent_var],<br/>                            train_data_dm['Score']),<br/>                            train_data_dm.shape[0],<br/>                            len(independent_var)),'.3f'))<br/>rtecm = float(format(complex_model_2.score(<br/>                        test_data_dm[independent_var],<br/>                        test_data_dm['Score']),'.3f'))<br/>artecm = float(format(adjustedR2(complex_model_2.score(<br/>                        test_data_dm[independent_var],test_data['Score']),<br/>                        test_data_dm.shape[0],<br/>                        len(independent_var)),'.3f'))<br/>cv = float(format(cross_val_score(complex_model_2,<br/>                    finaldf[independent_var],<br/>                    finaldf['Score'],cv=5).mean(),'.3f'))</span><span id="b806" class="ob lw it nw b gy og od l oe of">r = evaluation.shape[0]<br/>evaluation.loc[r] = ['Multiple Linear Regression-2','selected features',rmsecm,rtrcm,artrcm,rtecm,artecm,cv]<br/>evaluation.sort_values(by = '5-Fold Cross Validation', ascending=False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/9a26ae501c12b25fac04ce5baf01dc72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x_ILTmToAqBGstHXBkWlRQ.png"/></div></div></figure><p id="b001" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们看评估表时，多元线性回归-2(选定特征)是最好的。但是，我怀疑它的可靠性，我更喜欢所有元素的多元线性回归。</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="28c3" class="ob lw it nw b gy oc od l oe of">X = finaldf[[ 'GDP', 'Health', 'Support','Freedom','Generosity','Corruption']]<br/>y = finaldf['Score']</span><span id="bf46" class="ob lw it nw b gy og od l oe of">'''<br/> This function takes the features as input and<br/> returns the normalized values, the mean, as well <br/> as the standard deviation for each feature. <br/> '''<br/>def featureNormalize(X):<br/>    mu = np.mean(X) ## Define the mean<br/>    sigma = np.std(X) ## Define the standard deviation.<br/>    X_norm = (X - mu)/sigma ## Scaling function.<br/>    return X_norm, mu, sigma</span><span id="317d" class="ob lw it nw b gy og od l oe of">m = len(y) ## length of the training data<br/>X = np.hstack((np.ones([m,1]), X)) ## Append the bias term (field containing all ones) to X.<br/>y = np.array(y).reshape(-1,1) ## reshape y to mx1 array<br/>theta = np.zeros([7,1]) ## Initialize theta (the coefficient) to a 3x1 zero vector.</span><span id="59ee" class="ob lw it nw b gy og od l oe of">''' <br/> This function takes in the values for <br/> the training set as well as initial values <br/> of theta and returns the cost(J).<br/> '''</span><span id="676c" class="ob lw it nw b gy og od l oe of">def cost_function(X,y, theta):<br/>    h = X.dot(theta) ## The hypothesis<br/>    J = 1/(2*m)*(np.sum((h-y)**2)) ## Implementing the cost function<br/>    return J</span><span id="1011" class="ob lw it nw b gy og od l oe of">'''<br/>    This function takes in the values of the set, <br/>    as well the intial theta values(coefficients), the <br/>    learning rate, and the number of iterations. The output <br/>    will be the a new set of coefficeients(theta), optimized <br/>    for making predictions, as well as the array of the cost <br/>    as it depreciates on each iteration.<br/>    '''</span><span id="8027" class="ob lw it nw b gy og od l oe of">num_iters = 2000 ## Initialize the iteration parameter.<br/>alpha = 0.01 ## Initialize the learning rate.<br/>def gradientDescentMulti(X, y, theta, alpha, iterations):<br/>    m = len(y)<br/>    J_history = []<br/>    for _ in range(iterations):<br/>        temp = np.dot(X, theta) - y<br/>        temp = np.dot(X.T, temp)<br/>        theta = theta - (alpha/m) * temp<br/>        J_history.append(cost_function(X, y, theta)) ## Append the cost to the J_history array<br/>    return theta, J_history</span><span id="a43d" class="ob lw it nw b gy og od l oe of">print('Happiness score = ',np.round(theta[0],4),<br/>        '+',np.round(theta[1],4),'∗ Support',<br/>      '+',np.round(theta[2],4),'* GDP', <br/>      '+',np.round(theta[3],4),'* Health',<br/>      '+',np.round(theta[4],4),'* Freedom',<br/>       '+',np.round(theta[5],4),'* Generosity',<br/>      '+',np.round(theta[6],4),'* Corrption')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/b420e4179b49530177dcfcf1c0a9e305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9fjDKvaK_MmA4BjIkunxfg.png"/></div></div></figure><p id="6984" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打印出 J _ history 大约是 0.147。我们可以得出结论，使用梯度下降给了我们一个预测幸福分数的最佳模型。</p><p id="9f44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以用<code class="fe nt nu nv nw b">statsmodels</code>来预测幸福得分。</p><pre class="kj kk kl km gt nx nw ny nz aw oa bi"><span id="b1f2" class="ob lw it nw b gy oc od l oe of"># MULTIPLE LR<br/>import statsmodels.api as sm</span><span id="f18b" class="ob lw it nw b gy og od l oe of">X_sm = X = sm.add_constant(X)<br/>model = sm.OLS(y,X_sm)<br/>model.fit().summary()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pu"><img src="../Images/fc0c41577b35156b79b362d207570469.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NOQzmzJw21ZSfnBptoFNFA.png"/></div></div></figure><p id="119c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的系数非常接近我们在这里得到的。</p><p id="e854" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇笔记中的代码可以在<a class="ae ky" href="https://github.com/Nothingaholic/The-World-of-Happiness" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。</p><h1 id="4844" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">7.结论</h1><p id="8a1b" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">似乎对“世界幸福报告”的普遍批评是很有道理的。高度关注国内生产总值和密切相关的特征，如家庭和预期寿命。</p><p id="9a1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">高 GDP 让你幸福吗？最终，我们就是我们。我用我的七月来分析为什么人们不满足或者没有过上充实的生活。我关心的是“为什么”在分析完数据之后，就提出了一个问题:如何才能追逐幸福？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/aa0e63b3aa41011089813f67a173c262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*S2TE-CsMunetuvtyNoKOIA.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://sayingimages.com/happy-memes/" rel="noopener ugc nofollow" target="_blank">迷因</a></p></figure><p id="66e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就在几个月前，自从锁定以来，我做了一切去追逐幸福。</p><ul class=""><li id="18be" class="mn mo it lb b lc ld lf lg li pv lm pw lq px lu mu mv mw mx bi translated">我把自己定义为极简主义者。但是我开始购买很多东西，我认为这让我很开心。</li><li id="0529" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">我在社交媒体上花了很多时间，与他人保持联系，我希望这能让我开心。</li><li id="17d2" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">我开始在媒介上写作；我找到了与我的技能和兴趣相匹配的志愿者工作，我相信金钱和工作让我快乐。</li><li id="905c" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">我试着吃素，我希望这能让我开心。</li></ul><p id="2d5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一天结束的时候，我独自躺在床上，想着，“幸福可以实现吗？这种对幸福无止境的追求下一步是什么？”</p><p id="ba3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">嗯，我意识到我在追逐一些我自己认为能让我快乐的东西。</p><p id="3d9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在写这篇文章的时候，我看到了拉尔夫·沃尔多·爱默生的一句名言:</p><blockquote class="py"><p id="0190" class="pz qa it bd qb qc qd qe qf qg qh lu dk translated">“生活的目的不是快乐。它是有用的，是可敬的，是富有同情心的，是让你活着并过得好的一些不同之处。”</p></blockquote><p id="8040" class="pw-post-body-paragraph kz la it lb b lc qi ju le lf qj jx lh li qk lk ll lm ql lo lp lq qm ls lt lu im bi translated">圆点终于连上了。幸福本身不能成为目标。它仅仅是有用的副产品。</p><p id="68f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我开心的是我有用的时候。好吧，但是怎么做？有一天我醒来，心想:“我在为这个世界做什么？”答案是什么都没有。同一天，我开始在媒体上写作。我把我的学校笔记变成了文章，希望人们在阅读后能学到一两件事。对你来说，它可以是任何事情，比如绘画，创造一个产品，支持你的家人和朋友，任何你想做的事情。请不要太认真。还有最重要的，不要想多了。做点有用的事就好。任何事。</p><p id="dda7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">保持安全和健康！</p><p id="4f8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">资源:</strong></p><ol class=""><li id="c85e" class="mn mo it lb b lc ld lf lg li pv lm pw lq px lu nd mv mw mx bi translated">【2020 年世界幸福报告。</li><li id="2b71" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu nd mv mw mx bi translated"><a class="ae ky" href="https://www.kaggle.com/unsdsn/world-happiness" rel="noopener ugc nofollow" target="_blank"> Kaggle 世界幸福报告</a>。</li><li id="f525" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu nd mv mw mx bi translated"><a class="ae ky" href="https://www.gfmag.com/global-data/non-economic-data/happiest-countries" rel="noopener ugc nofollow" target="_blank">2020 年世界幸福国家</a>。</li><li id="9b83" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu nd mv mw mx bi translated"><a class="ae ky" href="https://www.trackinghappiness.com/engineering-happiness-prediction-model/" rel="noopener ugc nofollow" target="_blank">设计一个幸福预测模型</a>。</li></ol></div></div>    
</body>
</html>