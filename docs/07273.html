<html>
<head>
<title>Build A Homebrew Current/Voltage Plotter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">制作自制电流/电压绘图仪</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-a-homebrew-current-voltage-plotter-88413dfa44d0?source=collection_archive---------48-----------------------#2020-06-02">https://towardsdatascience.com/build-a-homebrew-current-voltage-plotter-88413dfa44d0?source=collection_archive---------48-----------------------#2020-06-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dc11" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">设计和编程您自己的数据采集硬件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/43434235e50b02eb96ce2ebcd4ea10ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2K4uZvgzdxwL_Btjc41z_A.jpeg"/></div></div></figure><p id="4131" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最近我在思考二极管的非线性行为。在大学里，我了解到通过二极管的电流可以用施加在其上的电压的指数函数来近似表示。我想知道指数函数如何描述真实二极管的电流/电压行为。</p><p id="2a4d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我认为这将是一个有趣的项目，建立一些测量和绘制二极管的行为。我有一个备用的Arduino Uno，还有一块试验板和一些基本的电子零件。</p><p id="1bb9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，三天后，我有了一个比我想象的更好的系统。它捕获数据并根据数据制作图表，如下所示。以下是如何制作自己的电流/电压分析仪。我提供源代码和硬件设计作为开源。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lq"><img src="../Images/7652dd343b26a92286765267dcb5ef22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-00qeK-H7FIdWd5ti_T2Wg.png"/></div></div></figure><h2 id="ca11" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">零件清单</h2><ul class=""><li id="ea54" class="mk ml it kw b kx mm la mn ld mo lh mp ll mq lp mr ms mt mu bi translated">一个小试验板和电线。</li><li id="2b48" class="mk ml it kw b kx mv la mw ld mx lh my ll mz lp mr ms mt mu bi translated">Arduino Uno或兼容板，带USB电缆。</li><li id="48a7" class="mk ml it kw b kx mv la mw ld mx lh my ll mz lp mr ms mt mu bi translated">产生12至15伏DC的电源，电流至少为100毫安。您可以为这部分寻找一个旧的“墙砖”电源适配器。</li><li id="6506" class="mk ml it kw b kx mv la mw ld mx lh my ll mz lp mr ms mt mu bi translated">LM7808稳压器。这就产生了一个稳定的8伏DC信号。(你可以用产生9伏信号的LM7809调节器来代替；它将同样有效。)</li><li id="5282" class="mk ml it kw b kx mv la mw ld mx lh my ll mz lp mr ms mt mu bi translated">LM324N四路运算放大器芯片。</li><li id="4c42" class="mk ml it kw b kx mv la mw ld mx lh my ll mz lp mr ms mt mu bi translated">各种电阻器，如下面更详细解释的。</li></ul><h2 id="24d0" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">电路设计</h2><p id="b021" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld na lf lg lh nb lj lk ll nc ln lo lp im bi translated">对于这个项目，我需要一种方法来产生从0V到5V的不同电压，并精确控制增量。将数字数据转换成模拟电压电平的设备称为<em class="nd">数模转换器</em>，简称DAC。虽然更先进的Arduino Due带有内置DAC，但Due的成本几乎是Arduino Uno的两倍。我决定从头开始构建自己的DAC，并与Uno一起使用。这本身就具有教育意义和回报。</p><p id="a979" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">DAC设计如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/51eca5845f4af7e0b619df682d096ad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pvwSfdPXx5DoNIMODFdYEA.png"/></div></div></figure><p id="b563" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">关于硬件设计的一些注意事项:</p><ul class=""><li id="60e6" class="mk ml it kw b kx ky la lb ld nf lh ng ll nh lp mr ms mt mu bi translated">LM324N芯片上有四个运算放大器。仅使用其中一个，在原理图中标为IC1A。三个未使用的运算放大器如图所示进行布线，以防止它们因不必要的振荡而产生干扰。</li><li id="733f" class="mk ml it kw b kx mv la mw ld mx lh my ll mz lp mr ms mt mu bi translated">DAC本身由左侧的电阻网络和运算放大器IC1A组成。(有关DAC工作原理的更多信息，请参见下文。)</li><li id="f21b" class="mk ml it kw b kx mv la mw ld mx lh my ll mz lp mr ms mt mu bi translated">原理图上标有<code class="fe ni nj nk nl b">X</code>的端子表示电路连接到Arduino Uno板(未显示)的位置。</li><li id="381c" class="mk ml it kw b kx mv la mw ld mx lh my ll mz lp mr ms mt mu bi translated">Uno板由主机的USB连接供电。您将需要此连接来通过Arduino IDE串行监视器捕获数据，因此没有必要为Uno提供另一个电源。</li><li id="8bbb" class="mk ml it kw b kx mv la mw ld mx lh my ll mz lp mr ms mt mu bi translated">电阻R0和R1连接到PB0和PB1，但其余的电阻R2-R7连接到PD引脚，而不是PB引脚。(PD0和PD1不能使用，因为串行通信需要它们。)</li><li id="a142" class="mk ml it kw b kx mv la mw ld mx lh my ll mz lp mr ms mt mu bi translated">原理图中的二极管D1是您想要测试的任何元件的占位符。我已经成功测试了一个1K电阻(一种验证整个系统的好方法)、不同种类的led和各种其他二极管，包括肖特基二极管、齐纳二极管、整流器和锗检测二极管。</li></ul><p id="b390" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是我的最终版本的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/0379d3a1c4b563d27ac516e02a9c7022.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xdbcjEivrwDF0R2gb9JffQ.jpeg"/></div></div></figure><h2 id="a0ce" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">DAC理论</h2><p id="e592" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld na lf lg lh nb lj lk ll nc ln lo lp im bi translated">我使用来自Uno的8个数字输出来选择256个不同电压电平中的一个。九个电阻组成的网络和运算放大器共同实现DAC。</p><p id="69ff" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">每个输出(PB0、PB1、PD2、… PD7)产生0V或5V的独立电压，由Uno上运行的固件控制。因为这是8个独立的输出，所以有2⁸=256独特的输出组合。</p><p id="491e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">电阻选择为2的幂，从1K一直到128K。输出PD7通过相连的1K电阻R7对正运算放大器电压的贡献是8路输出中最大的，因为电阻最小。每个电阻值增加一倍，到达运算放大器的电压就会减半。</p><p id="94ca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了证明这是真的，考虑这张图，重新绘制以使当前的流动更清晰。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/f65ff51a240c2e7a6e6d83ad76fe53bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*WaJE-CpDTCrrEf29b2WzOA.png"/></div></figure><p id="b1e8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">X₀至X₇代表8个Uno输出引脚的电压。在给定时间，每个可以是0V或5V。通过电阻器R₀和R₇流入V₀节点的总电流必须等于通过R₈.流出的电流(我们可以忽略任何进入运算放大器正输入端的电流，因为运算放大器设计具有极高的输入阻抗。)因此:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="5449" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">根据欧姆定律，每个电流等于每个电阻上的压降除以相应的电阻值:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nq np l"/></div></figure><p id="bdb2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">拆分分数后，收集等式一边的V₀项，求解V₀，我们发现:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr np l"/></div></figure><p id="d83a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">分母可以用常数R’≈500ω代替，它代表所有九个电阻的并联等效电阻:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ns np l"/></div></figure><p id="ad31" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后一个等式表明，运算放大器正输入端的电压V₀是八个输入电压的线性加权和。</p><p id="e716" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过将运算放大器的输出连接到其负输入，它充当一个<a class="ae nt" href="https://en.wikipedia.org/wiki/Buffer_amplifier#Op-amp_implementation" rel="noopener ugc nofollow" target="_blank">电压缓冲器</a>，输出与其输入相同的电压V₀。这被称为<em class="nd">单位增益</em>配置。运算放大器向测试元件提供高达20 mA的电流，同时将电阻网络与该元件隔离。</p><h2 id="46a3" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">电阻调谐</h2><p id="7a3c" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld na lf lg lh nb lj lk ll nc ln lo lp im bi translated">为了使自制DAC尽可能线性，需要选择接近2的幂的电阻。这有一个小问题。电阻器通常不以2K、4K等值出售。</p><p id="08c9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然而，有可能找到串联或并联的电阻对，以接近匹配目标值。电阻器的实际值很少与其标称值相符。你必须测量它们！我坐下来，用我的数字欧姆表试着组合，直到我得到正确的数值。仅仅这个电阻调谐步骤就花了我几个小时。</p><p id="30fd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">例如，对于我的4K电阻，我发现一个标称值为180ω的电阻测量值为176.8ω。我还发现了一个标称值为3.9K的电阻，测量值为3.83K。将它们串联焊接在一起，我的欧姆表测得的总电阻为4.00K。我发现，在试验板上串联(或并联)不同的电阻并测量它们，直到得到足够接近的结果，这比做数学计算更容易。</p><p id="e2cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你不需要为了获得完美的阻力而把自己逼疯。这不会影响最终电流/电压图的准确性。正如您将看到的，成品器件将使用Uno的两个模拟输入来测量电压，因此结果图的准确性不涉及任何计算或猜测。重点是尽量平滑地覆盖可能的电压范围，不要让DAC产生的电压出现任何大的缺口。每次阻力在1%以内就足够好了。</p><p id="a636" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你觉得用这种方式组合固定电阻太麻烦，你可以买一组八个微调电阻，用螺丝刀调整它们，直到它们测量正确。</p><p id="67e3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里有一个特写镜头，可以更好地观察试验板上的DAC。你可以看到我的一些复合电阻，大部分是串联的，一对是并联的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a0fd849b3533ad964e686848fabbe4c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FJSRUTnH_19J96nEVUTv-Q.jpeg"/></div></div></figure><h2 id="6c7b" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">安装和测试固件</h2><p id="499a" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld na lf lg lh nb lj lk ll nc ln lo lp im bi translated">您需要将这个项目的GitHub库克隆到您的计算机上。我已经验证了一切都可以在Debian Linux和Windows 10上运行。我没试过Mac，但应该可以用。</p><p id="ac63" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae nt" href="https://github.com/cosinekitty/diodeplot" rel="noopener ugc nofollow" target="_blank">https://github.com/cosinekitty/diodeplot</a></p><p id="10de" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">固件是一个名为<code class="fe ni nj nk nl b">DiodePlotFirmware.ino</code>的Arduino草图。它设计用于Arduino IDE的串行监视器。一旦您构建了硬件并用固件对其进行了编程，您就可以执行快速诊断。我建议您第一次运行时使用1K电阻作为测试元件。将其放在电路中，而不是二极管D1中。打开Arduino IDE串行监视器。当您引导系统时，您应该会看到以下提示:</p><pre class="kj kk kl km gt nu nl nv nw aw nx bi"><span id="b2c9" class="lr ls it nl b gy ny nz l oa ob"># READY</span></pre><p id="b2af" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要验证DAC是否正常工作，可以将数字万用表连接到DAC输出，并在输入一系列命令的同时测量其电压。将您的万用表负极探针连接到GND(我喜欢将其夹在LM7808的金属标签上)。将正极探针连接到运算放大器输出。它的测量值应该非常接近0V。</p><p id="ad45" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，输入一系列命令来手动更改电压水平。每个命令将是一个从0到255的数字，后跟字母<code class="fe ni nj nk nl b">v</code>。按enter键提交命令。让我们从告诉电路板达到最大电压开始:</p><pre class="kj kk kl km gt nu nl nv nw aw nx bi"><span id="f10a" class="lr ls it nl b gy ny nz l oa ob">255v</span></pre><p id="ae3c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您应该会在串行监视器中看到如下内容:</p><pre class="kj kk kl km gt nu nl nv nw aw nx bi"><span id="a2f1" class="lr ls it nl b gy ny nz l oa ob"># READY<br/><strong class="nl iu">255 1020 767</strong></span></pre><p id="ece0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第一个数字确认值255(二进制1111111)已经馈入进入DAC的8个引脚。第二个数字是DAC输出的模拟读数。它应该接近Arduino模拟输入的10位范围的高端，即0..1023.你的万用表应该跳到+5.0伏附近。</p><p id="54fe" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">假设你安装了一个1K的电阻而不是D1，第三个数字应该接近显示的值。它是测试组件顶部的电压。</p><p id="5dea" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果一切检查完毕，您就可以继续了。否则，就是出问题了；拔掉你的电源和USB电缆，然后花些时间检查你的线路。在继续之前，您需要诊断并修复任何错误。</p><p id="acfe" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一旦你的最大电压检查出来，尝试几个中间值。例如，通过输入以下命令尝试50%的电压。</p><pre class="kj kk kl km gt nu nl nv nw aw nx bi"><span id="4f02" class="lr ls it nl b gy ny nz l oa ob">128v</span></pre><p id="d102" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，串行监视器应该打印出与这些数字相近的数字(新输出以粗体显示):</p><pre class="kj kk kl km gt nu nl nv nw aw nx bi"><span id="4255" class="lr ls it nl b gy ny nz l oa ob"># READY<br/>255 1020 767<br/><strong class="nl iu">128 507 380</strong></span></pre><p id="af24" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第一个数字应该正好是128，剩下的两个数字应该大约是之前<code class="fe ni nj nk nl b">255v</code>测试值的一半。此外，您的万用表读数应该约为+2.5V。</p><h2 id="10eb" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">捕捉电压/电流曲线数据</h2><p id="8c0e" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld na lf lg lh nb lj lk ll nc ln lo lp im bi translated">现在是时候找点乐子了！让我们验证DAC的线性行为，仍然使用1K电阻代替D1。</p><p id="b022" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，按下显示屏右下角的“清除输出”按钮，清除串行监视器输出。然后输入以下命令:</p><pre class="kj kk kl km gt nu nl nv nw aw nx bi"><span id="93dc" class="lr ls it nl b gy ny nz l oa ob">1000m</span></pre><p id="9693" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ni nj nk nl b">m</code>命令运行自动数据收集程序，扫描每个DAC输入，从0到255。对于每个DAC值，<code class="fe ni nj nk nl b">m</code>前面的<code class="fe ni nj nk nl b">1000</code>告诉固件对每个DAC设置进行1000次过采样。固件连续读取1000次两个电压:DAC输出本身和测试元件顶部的电压。</p><p id="8de8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">测试将需要几分钟时间来运行。完成后，您将得到如下所示的输出:</p><pre class="kj kk kl km gt nu nl nv nw aw nx bi"><span id="9a3c" class="lr ls it nl b gy ny nz l oa ob">0 0 [1000] 0 [1000]<br/>1 3 [2 231 766 1 0] 1 [8 755 237]<br/>2 6 [1 153 846] 5 [590 409 1]<br/>3 10 [1 119 880] 7 [0 5 491 498 6]<br/>4 15 [41 957 2] 11 [3 247 748 2 0]<br/>5 19 [60 934 6] 13 [0 1 145 849 5]<br/>...<br/>250 1000 [0 1 832 166 1] 751 [0 999 1]<br/>251 1005 [3 790 205 2 0] 754 [0 984 16]<br/>252 1009 [1 604 393 2 0] 757 [0 940 60]<br/>253 1012 [0 2 567 430 1] 760 [0 931 69]<br/>254 1017 [451 548 1] 763 [0 935 65]<br/>255 1021 [360 630 10] 766 [0 838 162]<br/># FINISHED</span></pre><h2 id="e5ba" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">数据格式的解释</h2><p id="c88d" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld na lf lg lh nb lj lk ll nc ln lo lp im bi translated">此部分是可选的。如果你只是想用我提供的软件来绘制数据，你可以跳到下一节。但是如果你想编写自己的软件来处理数据，这里我解释一下所有这些数字的含义。</p><p id="f784" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">典型的一行如下所示:</p><pre class="kj kk kl km gt nu nl nv nw aw nx bi"><span id="e56b" class="lr ls it nl b gy ny nz l oa ob">2 6 [1 153 846] 5 [590 409 1]</span></pre><p id="5a1b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第一个数字<code class="fe ni nj nk nl b">2</code>是馈入DAC的8位值。就像我们之前看到的<code class="fe ni nj nk nl b">v</code>命令一样，这是一个从0到255的值。</p><p id="ca5f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第二个数字6是DAC测得的模拟电压的中间值。就像在<code class="fe ni nj nk nl b">v</code>命令中一样，它是一个从0到1023的值，从0V到5V线性缩放。</p><p id="6683" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在情况不同了。您将看到方括号<code class="fe ni nj nk nl b">[]</code>中的数字列表。括号中的值总是奇数。这些值是读取不同电压值的次数。因为我们对每个值进行了1000次过采样(在<code class="fe ni nj nk nl b">1000m</code>命令中)，所以这些数字的总和总是1000。也就是1+153+846=1000。</p><p id="2bc0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">中间的数字，在本例中为153，表示测量的电压是6的多少倍(括号左边的数字)。所以对<code class="fe ni nj nk nl b">6 [1 153 846]</code>的解读方式是:</p><ul class=""><li id="3718" class="mk ml it kw b kx ky la lb ld nf lh ng ll nh lp mr ms mt mu bi translated">1000次中有1次，电压读数为6–1 = 5。</li><li id="df8d" class="mk ml it kw b kx mv la mw ld mx lh my ll mz lp mr ms mt mu bi translated">1000次中有153次，电压读数是6。</li><li id="e36c" class="mk ml it kw b kx mv la mw ld mx lh my ll mz lp mr ms mt mu bi translated">1000次中有846次，电压读数是6+1=7。</li></ul><p id="a234" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">类似地，线的剩余部分<code class="fe ni nj nk nl b">5 [590 409 1]</code>表示在测试部件处测量的电压的过采样结果。</p><h2 id="6711" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">准备绘图仪软件</h2><p id="e95f" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld na lf lg lh nb lj lk ll nc ln lo lp im bi translated">现在，使用剪贴板将这些数据复制并粘贴到您喜欢的文本编辑器中。在GitHub repo的克隆版本的<code class="fe ni nj nk nl b">data</code>目录中，将文件保存为<code class="fe ni nj nk nl b">resistor.txt</code>。打开命令提示符，转到克隆的目录。</p><p id="c926" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您的系统上还没有Python3，您需要安装它。验证方式:</p><pre class="kj kk kl km gt nu nl nv nw aw nx bi"><span id="6ef8" class="lr ls it nl b gy ny nz l oa ob">$ <strong class="nl iu">python3 --version</strong><br/>Python 3.5.3</span></pre><p id="7c45" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您还需要安装Python包<code class="fe ni nj nk nl b">matplotlib</code>来渲染图形。在Linux上，该命令是:</p><pre class="kj kk kl km gt nu nl nv nw aw nx bi"><span id="6c30" class="lr ls it nl b gy ny nz l oa ob">sudo pip3 install matplotlib</span></pre><p id="be54" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要确认绘图仪软件准备就绪，请输入以下命令:</p><pre class="kj kk kl km gt nu nl nv nw aw nx bi"><span id="cbb4" class="lr ls it nl b gy ny nz l oa ob">$ <strong class="nl iu">./plot.py</strong></span><span id="a579" class="lr ls it nl b gy oc nz l oa ob">USAGE:  plot.py x y datafile.txt [outfile.png]</span><span id="50d9" class="lr ls it nl b gy oc nz l oa ob">Where x and y are each one of the following:</span><span id="025a" class="lr ls it nl b gy oc nz l oa ob">    n  = the value 0..255 that is fed into the resistor network.<br/>    v1 = measured voltage coming out of the op-amp.<br/>    v2 = measured voltage fed into the test component.<br/>    i  = deduced current calculated as (v1-v2)/R.</span><span id="da46" class="lr ls it nl b gy oc nz l oa ob">If outfile.png is provided on the command line, the image<br/>is saved directly to that file.<br/>Otherwise, the graph is shown interactively.</span></pre><p id="dee0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">虽然数据文件只包含<code class="fe ni nj nk nl b">n</code>、<code class="fe ni nj nk nl b">v1</code>、<code class="fe ni nj nk nl b">v2</code>，但是在这个帮助文本中可以看到<code class="fe ni nj nk nl b">plot.py</code>可以利用欧姆定律推导出电流<code class="fe ni nj nk nl b">i</code>。</p><h2 id="09bd" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">绘制电流/电压曲线</h2><p id="67ce" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld na lf lg lh nb lj lk ll nc ln lo lp im bi translated">让我们将电流<code class="fe ni nj nk nl b">i</code>绘制成元件电压<code class="fe ni nj nk nl b">v2</code>的函数。输入以下命令:</p><pre class="kj kk kl km gt nu nl nv nw aw nx bi"><span id="fd74" class="lr ls it nl b gy ny nz l oa ob">./plot.py v2 i data/resistor.txt</span></pre><p id="0fe8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这将产生一个显示线性关系的图形。毕竟电阻遵守欧姆定律，所以电流应该和电压成正比。这是我的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/802f5cd87f08a1107d5fe43ff71a58a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oqosTX4UZZFUvKxIXfHU8Q.png"/></div></div></figure><p id="b44c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，您可以测试非线性元件了。从LED开始很有趣，因为你也可以看到随着电压增加超过其照明阈值，它会慢慢变亮。用LED替换电阻器，确保将其阳极连接到电阻器R9，阴极连接到GND。如果你把它弄反了，就不会有坏事发生；它就是不亮，你会得到一个平坦的零电流曲线。把它翻过来再做一次测试。</p><p id="a768" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">确保在每次测试之前清除串行输出，这样就不会在输出文件中混淆不同测试的数据。遵循与电阻测试相同的步骤，运行<code class="fe ni nj nk nl b">1000m</code>命令，将输出保存到文件中，并运行<code class="fe ni nj nk nl b">plot.py</code>绘制数据。</p><p id="40e1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">以下是我测试随机放置的红色LED时得到的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/0f934245d789f5255c913710c90dc703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-1Ykw4rCKrJbHceN2Io6mg.png"/></div></div></figure><h2 id="d39e" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">绘制正负电压响应</h2><p id="01c5" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld na lf lg lh nb lj lk ll nc ln lo lp im bi translated">请看下图，您会注意到它涵盖了齐纳二极管在正负输入电压下的电流/电压响应。但是这个电路只产生0V到+5V的电压。我是如何制作这个图表的？</p><p id="3c4b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这需要一点手工操作，但是绘图仪程序<code class="fe ni nj nk nl b">plot.py</code>自有妙招。您将运行两个测试，一个测试组件(如齐纳二极管)正向偏置。将数据复制并粘贴到一个文本文件中，并在该数据前单独手动键入单词<code class="fe ni nj nk nl b">FORWARD</code>。</p><p id="75b8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在所有的测试数据之后，在一行中单独输入<code class="fe ni nj nk nl b">REVERSE</code>这个词。</p><p id="3b1e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后在试验板上翻转元件，使其反向偏置。清除您的串行输出，再次运行测试，并将结果数据粘贴到单词<code class="fe ni nj nk nl b">REVERSE</code>之后。在<code class="fe ni nj nk nl b">data/zener3v.txt</code>中，您可以在克隆的repo中看到一个示例数据文件。为简洁起见，它看起来像这样:</p><pre class="kj kk kl km gt nu nl nv nw aw nx bi"><span id="154a" class="lr ls it nl b gy ny nz l oa ob"># [1n5225b Zener Diode @ 3.0V]<br/><strong class="nl iu">FORWARD</strong><br/>0 0 [1000] 0 [1000]<br/>1 2 [0 4 309 685 2]<br/>2 [6 260 734]<br/>...<br/>253 1012 [0 3 756 236 5] 156 [4 695 173 88 40]<br/>254 1016 [0 1 670 326 3] 156 [5 728 148 84 35]<br/>255 1021 [553 442 5] 156 [4 685 184 90 37]<br/><strong class="nl iu">REVERSE</strong><br/>0 0 [1000] 0 [1000]<br/>1 3 [5 316 677 2 0] 3 [6 288 703 3 0]<br/>2 6 [5 215 780] 6 [0 6 187 806 1]<br/>...<br/>253 1012 [0 1 640 351 8] 525 [0 36 634 94 44 79 49 8 35 20 1]<br/>254 1017 [533 462 5] 526 [6 241 507 67 52 64 14 16 27 6 0]<br/>255 1021 [2 437 554 7 0] 526 [36 619 128 54 64 45 12 24 18]</span></pre><p id="3b89" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe ni nj nk nl b">FORWARD</code>是可选的，但是它明确表示下面的数据是正向偏置的。缺省值是向前偏移的数据。<code class="fe ni nj nk nl b">REVERSE</code>关键字表示其后的任何数据都应被视为反向偏置的负电压。</p><p id="7399" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">还要注意第一行中显示的语法，它允许您在图形的顶部放置一个标题:井号<code class="fe ni nj nk nl b">#</code>后跟方括号内的任何文本<code class="fe ni nj nk nl b">[]</code>。这个标题便于记录您测试了什么组件。</p><h2 id="7b42" class="lr ls it bd lt lu lv dn lw lx ly dp lz ld ma mb mc lh md me mf ll mg mh mi mj bi translated">有趣的实验</h2><p id="5406" class="pw-post-body-paragraph ku kv it kw b kx mm ju kz la mn jx lc ld na lf lg lh nb lj lk ll nc ln lo lp im bi translated">探索不同二极管和晶体管结的行为会很有趣。尝试绘制几个同类led的数据，看看它们的行为有多匹配。或者你可以试着绘制不同颜色的led曲线，看看它们的“开启”电压有什么不同。</p><p id="b019" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这个项目也可以是创建给定组件的数学模型的基础。我打算自己做这件事，看看如何用指数回归、切比雪夫多项式或其他技术最好地拟合实验曲线。看看软件是否可以通过与已知回归模型的数据库进行匹配来推断出哪个设备产生了曲线，这将是一件有趣的事情。</p><p id="2609" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我希望这个项目能激发你思考创造性的改编。也许你可以将其中的一些想法用于你自己的发明和实验。</p></div></div>    
</body>
</html>