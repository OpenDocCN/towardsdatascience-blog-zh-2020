<html>
<head>
<title>A data driven approach to understanding cyber attacks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解网络攻击的数据驱动方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-data-driven-approach-to-understanding-cyber-attacks-5cd8b5f91abe?source=collection_archive---------26-----------------------#2020-03-15">https://towardsdatascience.com/a-data-driven-approach-to-understanding-cyber-attacks-5cd8b5f91abe?source=collection_archive---------26-----------------------#2020-03-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2c15" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在VERIS社区数据集上使用Pandas的探索性指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c9bcf4f413acf119e70f5070ed58567e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rup5jSB3660x_E6CZF5SaQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片<strong class="bd kv">马库斯·斯皮斯克</strong>上<strong class="bd kv"> </strong> <a class="ae kw" href="https://unsplash.com/@markusspiske" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kv">下</strong> </a></p></figure><p id="4991" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">保护让社会正常运转的数字系统、应用和网络免受有意和无意的伤害是一个非常复杂的问题，仅靠人类的直觉是无法实现的。</p><p id="2aca" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">网络安全领域正在发生一场觉醒，这种觉醒是由同样的商品推动的，这种商品曾导致亚马逊、脸书和谷歌等公司成为世界上最强大的私营公司:<strong class="kz ir"> <em class="lt"> Data </em> </strong>。</p><p id="8519" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据科学在网络安全领域的应用为组织更好地保护自己免受网络威胁提供了重要的机会。一个常见的用例是实现机器学习模型来监控恶意用户行为，这是一个不适合人类分析师执行的任务，尤其是对于拥有数千名员工的大型组织。</p><p id="1f40" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在本文中，我使用Python和Pandas来探索由大约8500个真实世界网络事件组成的<a class="ae kw" href="http://veriscommunity.net/index.html" rel="noopener ugc nofollow" target="_blank"> VERIS社区数据集</a>，以回答一个广泛的研究问题:“网络事件的共同属性是什么？”。通过回答这个简单的问题，我希望展示如何利用数据将一个复杂的问题分解成微小而可行的见解。</p><h1 id="6a57" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">导入和配置数据</h1><p id="4557" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">我通过将GitHub上的整个VERIS repo克隆到我的本地环境来导入数据。因为每个事件都存储在一个单独的JSON对象中，所以我使用了有用的<a class="ae kw" href="https://pypi.org/project/verispy/" rel="noopener ugc nofollow" target="_blank"> verispy </a>包将数千个JSON对象提取到一个pandas数据帧中:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="c1e8" class="mw lv iq ms b gy mx my l mz na">import pandas as pd<br/>from verispy import VERIS</span><span id="511c" class="mw lv iq ms b gy nb my l mz na">data_dir = '/Users/danielharrison/VCDB-master/data/json/validated'<br/>v =  VERIS(json_dir=data_dir) #creates a veris object</span><span id="b3bc" class="mw lv iq ms b gy nb my l mz na">Found 8539 json files.</span><span id="a7b0" class="mw lv iq ms b gy nb my l mz na">veris_df = v.json_to_df(verbose=True) #creates a dataframe from the veris object</span></pre><p id="84fc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">检查数据框架揭示了VERIS社区数据集的范围(截至2020年1月):</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="a61e" class="mw lv iq ms b gy mx my l mz na">veris_df.shape()<br/>(8539, 2347)</span></pre><h1 id="3a3c" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">1.谁在引发网络事件？</h1><p id="997d" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">了解谁会有意或无意地对数字资产造成潜在损害，是解决研究问题和探索数据的自然起点。</p><p id="d1e9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">VERIS数据库将网络威胁因素分为三类:</p><p id="ffac" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">1.外部-组织之外的任何人，例如黑客、国家和前雇员</p><p id="55df" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">2.内部-受托访问内部系统的任何人，例如全职员工、承包商和实习生</p><p id="d35b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">3.合作伙伴——受影响组织的第三方供应商，通常对内部系统有一些可信的访问权限。</p><p id="52ef" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了按参与者类型分解事件，我利用了verispy软件包提供的<code class="fe nc nd ne ms b">enum_summary</code>函数:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="80d2" class="mw lv iq ms b gy mx my l mz na">df_actors_internal = v.enum_summary(veris_df, 'actor.internal.variety', by='actor')</span><span id="a4dc" class="mw lv iq ms b gy nb my l mz na">df_actors_external = v.enum_summary(veris_df, 'actor.external.variety', by='actor')</span></pre><p id="c8d0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt">注意:我忽略了包括合作伙伴行动者类型，因为由合作伙伴引起的事件总数很低，这影响了以后的可视化。</em></p><p id="78d9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在对<code class="fe nc nd ne ms b">df_actors_internal</code>和<code class="fe nc nd ne ms b">df_actors_external </code>数据帧进行了一些清理之后(更多信息参见我的<a class="ae kw" href="https://github.com/87bdharr/VERIS-Data-Analysis" rel="noopener ugc nofollow" target="_blank"> GitHub代码</a>，我将它们连接成一个数据帧<code class="fe nc nd ne ms b">df_actors_combined</code>:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="a75e" class="mw lv iq ms b gy mx my l mz na">df_actors_combined = pd.concat([df_actors_internal, df_actors_external])</span><span id="54a3" class="mw lv iq ms b gy nb my l mz na">df_actors_combined.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/98c3929332d29738229ce4f0778a0503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*IN5cRhPpYESPIvVsoh5gYg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">串联数据帧df_actors_combined包含内部和外部参与者</p></figure><p id="8b1c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">由于Plotly express图形库，以视觉上令人惊叹的交互式方式呈现这些数据变得非常容易。我选择用一个旭日图来展示内部和外部参与者是如何被进一步分解成他们的参与者类型的:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="2bbe" class="mw lv iq ms b gy mx my l mz na">import plotly.express as px</span><span id="ae8a" class="mw lv iq ms b gy nb my l mz na">fig_1 = px.sunburst(df_actors_combined, path=['Actor Origin', 'Actor Type'], values='Count')</span><span id="d940" class="mw lv iq ms b gy nb my l mz na">fig_1.update_layout(uniformtext_minsize=12)</span><span id="2d49" class="mw lv iq ms b gy nb my l mz na">plot(fig_1, filename = 'Actor Origin', auto_open=True)</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">内部和外部参与者被进一步分解为他们的角色或联盟</p></figure><p id="4a8f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">关于在页面中嵌入可视化的更多信息，我推荐下面的 <a class="ae kw" rel="noopener" target="_blank" href="/how-to-create-a-plotly-visualization-and-embed-it-on-websites-517c1a78568b"> <em class="lt">文章</em> </a> <em class="lt">。</em></p><p id="0ee6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">显而易见的是，由内部和外部行为者引起的事件几乎是平均分布的，52%是外部的，47%是内部的(大约1%是合作伙伴&amp;未知)。</p><h2 id="8a0e" class="mw lv iq bd lw ni nj dn ma nk nl dp me lg nm nn mg lk no np mi lo nq nr mk ns bi translated"><strong class="ak">赛博域深度挖掘1 </strong></h2><p id="965d" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">组织不能低估内部威胁带来的风险，他们对内部系统的特权访问和工作知识使他们很容易造成伤害-无论他们是否有意。</p><p id="1cb6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">对于内部参与者的已知数据，很大一部分可归因于“最终用户”，VERIS文档将其描述为应用程序的最终用户或正式员工。我将此解释为拥有系统标准访问权限并在日常工作中使用该系统的员工。</p><p id="19a5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">有趣的是，根据我在DevOps环境中的经验，考虑到软件开发人员所拥有的高级访问和工作知识，我预计由他们引起的事故数量会高得多。例如，开发人员可以修改软件应用程序的底层源代码，以某种方式为自己谋利，或者干脆将密码和API密钥等秘密暴露在GitHub上托管的代码中:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/f7b1b9214e73d714010502d13ab49d07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vCfqRaIe-3lJSjkgsVhnZg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在Github上搜索“删除密码”会发现很多秘密被留在源代码中的例子</p></figure><p id="c91d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了了解开发人员是恶意行为还是仅仅是犯了错误，我通过过滤内部开发人员的<code class="fe nc nd ne ms b">veris_df</code>数据框架和他们的行为进一步分析了数据:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="eeff" class="mw lv iq ms b gy mx my l mz na">df_actors_developers = v.enum_summary(veris_df, 'action', by='actor.internal.variety')</span><span id="1522" class="mw lv iq ms b gy nb my l mz na">df_actors_developers = df_actors_developers[df_actors_developers['by'] == 'actor.internal.variety.Developer']</span><span id="1735" class="mw lv iq ms b gy nb my l mz na">df_actors_developers.plot(kind='bar', x='enum', y='x', legend=False)</span><span id="f73a" class="mw lv iq ms b gy nb my l mz na">plt.xticks(rotation=25)<br/>plt.ylabel('Count')<br/>plt.savefig('df_actors_developers')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/f8d742678f99e660278e7b76e37a1116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*Kz8y07jFwObbmRBUr7XnSA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">大多数由开发引起的事件是由错误引起的，很少是恶意的</p></figure><p id="e8dc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">生成的条形图显示，在73起与开发人员相关的事件中，56起是错误(即意外)，其余17起与误用、黑客攻击和恶意软件(即恶意软件)有关。有帮助的是，VERIS提供了一个事件摘要，我从14个标记为“误用”的事件中提取了该摘要，并将其输出到一个csv文件中，以便于阅读:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="c5ac" class="mw lv iq ms b gy mx my l mz na">df_actors_developers_misuse = veris_df.loc[(veris_df['actor.internal.variety.Developer'] == True) &amp; (veris_df['action.Misuse'] == True)]</span><span id="d269" class="mw lv iq ms b gy nb my l mz na">df_actors_developers_misuse['summary'].to_csv('developers_misuse_summary.csv', index=False, header=False)</span></pre><p id="9c02" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">一个特殊的事件是由美国的一名高级IT主管引起的，他也是一名开发人员。该开发商:</p><blockquote class="nv nw nx"><p id="8b77" class="kx ky lt kz b la lb jr lc ld le ju lf ny lh li lj nz ll lm ln oa lp lq lr ls ij bi translated"><em class="iq">“2005年，他在“随机”数字生成计算机软件中添加了一个秘密代码，使他能够将多场比赛的中奖概率从高达500万分之一缩小到200分之一……他在科罗拉多州、威斯康星州、爱荷华州、堪萨斯州和俄克拉荷马州劫持了至少五张中奖彩票，奖金总额超过2400万美元”</em></p></blockquote><p id="edd4" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">确实非常淘气。[我已经将剩余的摘要上传到了我的GitHub</p><p id="3726" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">本次网络领域深度探讨展示了我们如何从询问“谁造成了网络事件”这一非常普通的问题，一直到发现源代码完整性的价值。</strong></p><h1 id="b876" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">2.什么样的行为会导致网络事故？</h1><p id="2b93" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">在探讨了开发人员通常如何引发网络事件后，我后退一步，分析了所有外部、内部和合作伙伴可能采取的威胁行动。这是很有用的，因为组织需要知道他们的内部和外部威胁可能如何实现，这样他们就可以实施足够的保护控制。</p><p id="fca2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我想用更多的Plotly的交互式图表来形象化这种洞察力，并决定Sankey图将优雅地显示演员和动作之间的关系和流动。为了创建一个Sankey，我过滤了actor和action上的<code class="fe nc nd ne ms b">veris_df </code>数据帧:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="d038" class="mw lv iq ms b gy mx my l mz na">df_action_actor = v.enum_summary(veris_df, 'action', by='actor')</span></pre><p id="4b36" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">稍微整理了一下生成的数据帧:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="ea3c" class="mw lv iq ms b gy mx my l mz na">df_action_actor.drop(['n', 'freq'], axis=1, inplace=True)</span><span id="0635" class="mw lv iq ms b gy nb my l mz na">df_action_actor.columns = ['Actor Origin', 'Action Type', 'Count']</span><span id="532d" class="mw lv iq ms b gy nb my l mz na">df_Unknown_3 = df_action_actor[df_action_actor['Actor Origin'] == 'actor.Unknown']</span><span id="3953" class="mw lv iq ms b gy nb my l mz na">df_action_actor.drop(df_Unknown_3.index, inplace=True)</span></pre><p id="3a41" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">并使用映射函数来阻止代码在每个单词前输出“actor ”,即“actor”。外在，演员。内部，演员。合作伙伴':</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="25ab" class="mw lv iq ms b gy mx my l mz na">map_origin = {'actor.External':'External', 'actor.Internal':'Internal', 'actor.Partner':'Partner'}</span><span id="4990" class="mw lv iq ms b gy nb my l mz na">df_action_actor['Actor Origin'] = df_action_actor['Actor Origin'].map(map_origin)</span><span id="4037" class="mw lv iq ms b gy nb my l mz na">df_action_actor.head()</span></pre><p id="2017" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">生成的数据帧现在可以生成桑基图，如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/685b6d01c939967c55f1f5af15dfad8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*406Hh5ipEzji9uixJs2n9w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">df_action_actor数据帧存储了actor源和它们可能的动作类型之间的关系</p></figure><p id="7764" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我将上面的<code class="fe nc nd ne ms b">df_action_actor</code>数据帧传递给了<a class="ae kw" href="https://medium.com/kenlok/how-to-create-sankey-diagrams-from-dataframes-in-python-e221c1b4d6b0" rel="noopener">预建函数</a> <code class="fe nc nd ne ms b">gen_Sankey</code>，指定了生成桑基图中的级别和值的列，并通过调用<code class="fe nc nd ne ms b">plot</code>输出了结果图:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="a76f" class="mw lv iq ms b gy mx my l mz na">fig_4 = genSankey(df_action_actor, cat_cols=['Actor Origin', 'Action Type'], value_cols='Count', title='Sankey Diagram for Veris Community Database')</span><span id="5f3e" class="mw lv iq ms b gy nb my l mz na">plot(fig_4, filename = 'Cyber Actions Sankey Diagram', auto_open=True)</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="bdb7" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">Sankey图表明，数据集中的一些事件被分配了多种操作类型，因为内部、外部和合作伙伴事件的数量与之前的图表相比略有增加(按操作类型划分数据时，记录的事件有约12%的差异)。</p><h2 id="5503" class="mw lv iq bd lw ni nj dn ma nk nl dp me lg nm nn mg lk no np mi lo nq nr mk ns bi translated"><strong class="ak">赛博域深潜2 </strong></h2><p id="22bc" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">该图显示，约90%与内部行为者相关的事件是由错误或误用造成的。这种洞察力告诉我们，安全部门可以预期内部威胁会以用户行为的形式出现，而不是恶意软件或黑客活动，后者通常需要略有不同的监控技术。这就是为什么用户行为分析(UBA)领域最近出现了爆炸式增长，并使组织能够检测到用户在一段时间内相对于其他用户或自己的异常行为。</p><p id="3ea2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">与外部行为者相关的事件是由一系列更加多样化的行为引起的。这是有意义的，因为参与者必须采用更具创造性的方法来获得对系统的访问，以实现他们的结果。“黑客”行动似乎有点模糊:黑客到底意味着什么？我们能分离出黑客攻击的一些趋势吗？为了回答这些问题，我必须向数据帧添加一个日期时间索引，并过滤由黑客行为引起的事件(产生的数据帧称为<code class="fe nc nd ne ms b">combined</code>)。有关我如何做到这一点的更多信息，请参考<a class="ae kw" href="https://github.com/87bdharr/VERIS-Data-Analysis" rel="noopener ugc nofollow" target="_blank">我的GitHub </a>，因为它太长了，无法包含在本文中。</p><p id="3728" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">清理数据集后，我能够提取以下图形:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="d44a" class="mw lv iq ms b gy mx my l mz na">ax1 = combined.iloc[:, 2:10].plot(kind='bar', stacked=True, figsize=(10,5))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/9ee1e7014378eadc6d175a3f5d6dd819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gNWycej1syTlSnFC9jLIWg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">2006-2019年黑客活动导致的网络事件频率</p></figure><p id="44dc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">图表显示了更多关于什么行为构成“黑客攻击”的细节。拒绝服务(DoS)攻击在2013年和2014年困扰着组织，但最近，对数据集中的组织来说，威胁似乎已经变得不那么大了。这可能是因为反DoS技术近年来变得更加先进和流行:web应用程序防火墙(waf)能够对传入的Web流量进行速率限制，通常由云供应商在内容分发网络(cdn)、应用程序负载平衡器和API网关上作为标准提供。</p><p id="0bcf" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然而，VERIS数据集现在可能会过时，因为数据表明自2013年以来黑客攻击一直在稳步下降。有大量其他数据集和统计数据表明情况并非如此。事实上，作为一个从事网络安全工作并对各种组织有看法的人，我可以凭第一手经验说，网络攻击的数量正在上升。</p><h1 id="c753" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">3.组织检测和响应网络事件需要多长时间？</h1><p id="5297" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">能够及时检测和响应网络事件可以拯救整个组织免于破产。检测和响应网络事件花费的时间越长，组织面临的风险就越大，潜在的危害也就越大。</p><p id="0948" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">VERIS将网络事件分为4个阶段，并记录组织达到该阶段所需的时间单位:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/36dd464a4f19e5b4f71865f7d2d79a2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vGIPvD7443dWYrbuw6MlPQ.png"/></div></div></figure><ul class=""><li id="0317" class="oe of iq kz b la lb ld le lg og lk oh lo oi ls oj ok ol om bi translated">妥协:参与者已经获得对信息资产的访问权或妥协，例如获得对销售数据库的访问权</li><li id="ab30" class="oe of iq kz b la on ld oo lg op lk oq lo or ls oj ok ol om bi translated">泄露:参与者从受害者组织获取非公开数据的点(不适用于所有事件)</li><li id="65c7" class="oe of iq kz b la on ld oo lg op lk oq lo or ls oj ok ol om bi translated">发现:组织意识到事件已经发生的时间点</li><li id="4c74" class="oe of iq kz b la on ld oo lg op lk oq lo or ls oj ok ol om bi translated">遏制:组织阻止事故发生或恢复正常业务的点。</li></ul><p id="a0c3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="lt"> N.B. VERIS仅记录到达每个阶段的时间单位，即秒、分、小时，出于保密原因，不记录实际时间戳。</em></p><p id="ede1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我想了解组织检测和响应网络事件需要多长时间，并使用热图表示这些信息。</p><p id="b326" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为此，我首先必须从数据集中提取时间轴信息。我编写了一个函数(<code class="fe nc nd ne ms b">get_timeline_df(x, event)</code>)，该函数根据事件的特定阶段过滤数据集，并为下一阶段的处理格式化结果数据帧。关于<code class="fe nc nd ne ms b">get_timeline_df</code>功能的更多详情，请参见<a class="ae kw" href="https://github.com/87bdharr/VERIS-Data-Analysis" rel="noopener ugc nofollow" target="_blank"> my GitHub </a>。我调用了这个函数4次，事件的每个阶段调用一次:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="9ace" class="mw lv iq ms b gy mx my l mz na">compromise_time = get_timeline_df(‘timeline.compromise.unit’, ‘Compromise’)</span><span id="b1ff" class="mw lv iq ms b gy nb my l mz na">discovery_time = get_timeline_df('timeline.discovery.unit', 'Discovery')</span><span id="5f92" class="mw lv iq ms b gy nb my l mz na">exfiltration_time = get_timeline_df('timeline.exfiltration.unit', 'Exfiltration')</span><span id="41c1" class="mw lv iq ms b gy nb my l mz na">containment_time = get_timeline_df('timeline.containment.unit', 'Containment')</span></pre><p id="b664" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然后将4个数据帧连接成一个:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="2a85" class="mw lv iq ms b gy mx my l mz na">timeline_df = pd.concat([compromise_time, discovery_time, exfiltration_time, containment_time])<br/>timeline_df.head()</span></pre><p id="78ff" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">生成的数据帧如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/c89c8bc6dda1e27c73ea43dda17b2ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*7GYfIziPhar9zJMowRGwtw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">串联时间轴_测向数据帧</p></figure><p id="b93e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在<code class="fe nc nd ne ms b">get_timeline_df</code>函数中，我将字符串时间单位映射到一个从1到8的整数值，即‘秒’:1、…、‘天’:4、…、‘从不’:8，这样我就可以从最长到最短的时间跨度对值进行排序。</p><p id="980b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">通过以矩阵形式传递数据，可以在seaborn中创建热图。我使用<code class="fe nc nd ne ms b">pd.pivot()</code>函数将<code class="fe nc nd ne ms b">timeline_df</code>数据帧转换成矩阵，根据事件的4个阶段重新索引数据，并将数据从最长时间单位到最短时间单位排序:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="b67b" class="mw lv iq ms b gy mx my l mz na">timeline_matrix = timeline_df.pivot('Time Unit', 'Timeline Event', 'Count')</span><span id="1373" class="mw lv iq ms b gy nb my l mz na">timeline_matrix.columns</span><span id="589e" class="mw lv iq ms b gy nb my l mz na">columns_matrix_titles = ["Compromise","Exfiltration", "Discovery", "Containment"]</span><span id="9d29" class="mw lv iq ms b gy nb my l mz na">timeline_matrix = timeline_matrix.reindex(columns=columns_matrix_titles)</span><span id="7463" class="mw lv iq ms b gy nb my l mz na">timeline_matrix.sort_index(ascending=False, inplace=True)</span></pre><p id="e79e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">生成的矩阵如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/ff384393b98ef538772f56b097171c5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7jfXkZjbbHc_60SebgWwCw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">根据VERIS，时间轴矩阵按网络事件的四个阶段进行索引</p></figure><p id="a2a9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">现在，我简单地将矩阵传递给seaborn的热图函数，并将时间单位重新标记为字符串值，以便于理解:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="f2be" class="mw lv iq ms b gy mx my l mz na">import seaborn as sns</span><span id="e872" class="mw lv iq ms b gy nb my l mz na">fig_heatmap = plt.figure(figsize=(10,8))</span><span id="ebc2" class="mw lv iq ms b gy nb my l mz na">r = sns.heatmap(timeline_matrix, cmap='BuPu', cbar_kws={'label': 'Count'}, linewidths=.05)</span><span id="3b0d" class="mw lv iq ms b gy nb my l mz na">plt.yticks([7.5,6.5,5.5,4.5,3.5,2.5,1.5,0.5], ['Seconds', 'Minutes', 'Hours', 'Days', 'Weeks', 'Months', 'Years', 'Never'], rotation=0)</span></pre><p id="4b84" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">产生了以下热图:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/144fae2f4dfb771c96fff26b630f6a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6H2VElPMP51yhfohmRyp4w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">热图显示了网络事件在最初发生数月后才被发现的总体趋势</p></figure><h2 id="328c" class="mw lv iq bd lw ni nj dn ma nk nl dp me lg nm nn mg lk no np mi lo nq nr mk ns bi translated">赛博域深度潜水3</h2><p id="6cd5" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">从热图中显而易见的是，与组织意识到发生了任何事情相比，危害和泄露数据所需的时间更短。根据<a class="ae kw" href="https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/ig-mtrends-2018.pdf" rel="noopener ugc nofollow" target="_blank"> FireEye </a>的数据，在首次攻击数月后发现的大量事件与公认的2017年行业平均<em class="lt"> 101天</em>发现网络事件有很好的相关性。</p><p id="c975" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">网络专业人士通常将最初的妥协和发现之间的时间称为“停留时间”。驻留时间数字如此之高的一个原因可能是因为被称为“高级持续威胁”或“APTs”的特定网络事件子集。apt喜欢在一个组织的系统上长时间不被注意。留在那里有助于威胁参与者了解组织如何工作，以实现他们的目标，例如窃取数据。</p><p id="1894" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为什么停留时间很重要？T4最近的一篇论文指出，停留时间和网络攻击的平均成本之间存在关联。<strong class="kz ir"> <em class="lt">停留时间越长，攻击的代价就越大。</em>T9】</strong></p><p id="1f2f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">组织可以使用平均停留时间作为KPI来衡量威胁检测控制的有效性。只有通过测量，组织才能真正了解他们的网络风险。</p><h2 id="be6b" class="mw lv iq bd lw ni nj dn ma nk nl dp me lg nm nn mg lk no np mi lo nq nr mk ns bi translated">网络安全是一个数据问题</h2><p id="8297" class="pw-post-body-paragraph kx ky iq kz b la mm jr lc ld mn ju lf lg mo li lj lk mp lm ln lo mq lq lr ls ij bi translated">数字世界里发生的一切都会被记录下来。用户点击浏览器中的链接、员工三次输错密码、文件从一个网络位置传输到另一个网络位置，都是以数字格式记录的事件。这些数字事件可以用来保护组织免受网络事件的影响，但前提是用户、员工和系统每天产生的海量数据可以作为一种有益的工具来使用。</p><p id="a982" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">VERIS社区数据集只是应用数据分析来保护数字系统的一个用例。通过观察数以千计的事件的总体趋势，组织可以了解威胁最有可能来自哪里，以及他们可能如何试图造成伤害。</p><p id="2273" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">正如杰弗里·摩尔所说-</p><blockquote class="nv nw nx"><p id="b42e" class="kx ky lt kz b la lb jr lc ld le ju lf ny lh li lj nz ll lm ln oa lp lq lr ls ij bi translated"><em class="iq">没有大数据分析，公司就像瞎子和聋子，像高速公路上的小鹿一样在网络上游荡。</em></p></blockquote></div></div>    
</body>
</html>