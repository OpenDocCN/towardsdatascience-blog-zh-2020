<html>
<head>
<title>9 Steps in Model Training Process that demands a sequence</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模型训练过程中的 9 个步骤需要一个序列</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/9-steps-in-model-training-process-that-demands-a-sequence-7672a95fcf79?source=collection_archive---------56-----------------------#2020-05-20">https://towardsdatascience.com/9-steps-in-model-training-process-that-demands-a-sequence-7672a95fcf79?source=collection_archive---------56-----------------------#2020-05-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a68ffe015ba57433a1e11d660a3eb28b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jRjFvCRrqjhG6rPyctoMow.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">图片由<a class="ae kc" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3210944" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>的 Gerd Altmann 提供</p></figure><p id="ae5b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不仅仅是模特训练，生活中的每件事都需要一个顺序。举一个点燃煤气炉的例子:</p><p id="84da" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">1)你打开通往炉子的煤气管道阀门。</p><p id="46b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你打开炉子的旋钮。</p><p id="15a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3)你传递一个火花去点燃它。</p><p id="f963" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">能不能把上面三个步骤重新排一下，还能点炉子？答案是否定的，尝试任何组合，比如先传递一个火花，然后打开炉子的旋钮&amp;然后排好煤气管道。是的，你猜对了，不会有火焰。工程师通常定义操作机器的顺序，他们称之为 sop(标准操作程序)。操作泵的一个简单的标准操作程序是首先将吸入口和排出口排成一行，然后打开它。sop 的定义是为了使流程顺畅、高效、无差错。有些工作非常关键，不定义 SOP 或顺序会造成混乱。</p><p id="8230" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将讨论在<a class="ae kc" href="https://www.wildregressor.com/2020/05/machine-learning-overview.html" rel="noopener ugc nofollow" target="_blank">机器学习</a>中模型训练过程的相同程序。我们将考虑一个使用湿度、温度等各种预测因子通过线性回归进行降雨量预测的例子。像其他工程过程一样，顺序在这里也很重要。我们可以称之为“模型训练的一个 SOP”。那么，让我们开始吧。</p><p id="b213" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第 0 步:加载模块</strong></p><p id="08f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将从零开始。零，因为这个步骤的位置在这个地方并不重要，你可以根据需要运行它。步骤是首先导入您认为在培训过程中需要的所有必要的模块和类。您在这里错过的任何内容也可以在以后导入。我们这里需要的模块和类导入如下:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="5bca" class="lk ll iq lg b gy lm ln l lo lp">import pandas as pd<br/>from sklearn.linear_model import LinearRegression<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.metrics import mean_squared_error</span></pre><p id="425e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第一步:加载数据</strong></p><p id="cbfd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">模型训练过程的第一步是获取、查看和理解训练过程中所需的数据。我们将要使用的数据是带有湿度、温度等预测因子的降雨量数据。如前所述。我们将使用 pandas read_csv 函数来导入数据帧，并使用 head 函数来查看它</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="2657" class="lk ll iq lg b gy lm ln l lo lp">df = pd.read_csv(‘rain_data.csv’) print(df.shape)<br/>df.head()</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lq"><img src="../Images/4baef2e309f0493faf8dad9ba7a4dd27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jPmSKLdCkbUclqXE.png"/></div></div></figure><p id="c793" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们先来了解一下数据。这是 10 个国家的数据，它们的名称被标记为 A、B、C…J。因变量是 rain _ AMT，它提到了与特定国家对应的降雨量(mm)。自变量是温度(摄氏度)、湿度(百分比)、风速(高或低)和国家的识字率。数据框的形状是(10，6)，这意味着它有 10 行 6 列。</p><p id="3f56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第二步:删除不必要的特征</strong></p><p id="8ab0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">去掉不必要的功能。您的数据框可能包含许多自变量，您的直觉和经验告诉您这些自变量与因变量无关，因此是不需要的。去除这些额外的信息是必要的，因为为什么要携带垃圾。</p><p id="0b02" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的数据框架中，我们不需要国名和识字率，因为这两个变量与降雨量无关。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="2eb9" class="lk ll iq lg b gy lm ln l lo lp">df.drop([‘Country’,’Literacy_rate’], inplace = True, axis = 1) </span><span id="04c7" class="lk ll iq lg b gy lr ln l lo lp">df.head()</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/a7f3315a9dbd497d8e46cdbbf234ff2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/0*IqK7-e2w3j7g3BlI.png"/></div></figure><p id="db8b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第三步:处理缺失数据</strong></p><p id="f01a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">处理丢失的数据。不是每个数据集都是干净的。缺失的价值观无处不在。有必要预先处理丢失的值，以便它们不会影响流程的其余部分。您可以用多种方法处理缺失值。您可以删除包含缺失值的整行，也可以用某个常量值或某个统计值等来替换它们。</p><p id="887d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们首先检查数据框中是否有缺失值:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="7f40" class="lk ll iq lg b gy lm ln l lo lp">df.isnull().sum()</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/5dd0f1a659dea822d804a82712624507.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/0*uBp5Me1HAQfDSYm6.png"/></div></figure><p id="9d73" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在湿度栏下缺少一个值。让我们用湿度的平均值来代替它:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="41bc" class="lk ll iq lg b gy lm ln l lo lp">df[‘Humidty’].fillna(df[‘Humidty’].mean(), inplace = True)</span><span id="0784" class="lk ll iq lg b gy lr ln l lo lp">df.isnull().sum()</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/31d591f0a279156051c6a325b50ab1fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/0*RIivqT3KiMsV5AST.png"/></div></figure><p id="b04f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的数据现在没有丢失的值，因此我们可以继续。</p><p id="1d7e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第四步:分离出变量</strong></p><p id="ac5f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从你的数据集中分离出因变量。既然丢失的值都不见了，是时候分别查看因变量和自变量了。为什么会这样，你会知道的。</p><p id="2c3a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的数据框架中，rain _ AMT 列包含因变量的数据，其余变量是独立的。我们把降雨量 _amt 分离出来，称之为<strong class="kf ir"> Y. </strong></p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="8be3" class="lk ll iq lg b gy lm ln l lo lp">Y = df.pop(‘Rainfall_amt’) <br/>print(Y) <br/>df.head()</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/23eeeb2c1bf2cc0c9c7b26eb246a1db4.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/0*JnFgyp8lvVraHD_N.png"/></div></figure><p id="8f84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第五步:处理分类变量</strong></p><p id="3208" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">模型训练程序无法处理分类变量；它需要数字来处理它们。所以是时候处理分类变量了。您可以用数字替换分类值，比如用 0 替换女性，用 1 替换男性，或者您可以使用一键编码，只要适合您。</p><p id="c4e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的数据框包含 Wind_speed 列下的分类值。让我们用一键编码来编码它们。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="4b94" class="lk ll iq lg b gy lm ln l lo lp">df = pd.get_dummies(df)<br/>df.head()</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/1e8468d610485b3c173851fe2adf66ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/0*JbtZ0nc0esPKTC5L.png"/></div></figure><p id="8117" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">风速列被分成两列，风速高和风速低。值 1 表示存在，0 表示不存在。</p><p id="e20d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第六步:拆分数据</strong></p><p id="bbf1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将数据分为训练集和测试集。根据具体情况，该步骤可以被认为是可选的。在没有向我们提供测试数据文件的场景中，我们需要分割提供给我们的数据，以制作测试数据框架，用于稍后测试我们的模型。</p><p id="dce1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的数据帧只有 10 行，因此对其进行分割是不实际的，但我们仍将以 70:30 的训练:测试比率对其进行分割，以理解这一概念。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="0b79" class="lk ll iq lg b gy lm ln l lo lp">x_train, x_test, y_train, y_test = train_test_split(df, Y, test_size = 0.30)<em class="lx"> </em></span></pre><p id="18cd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第七步:训练模型</strong></p><p id="99e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是使用期待已久的拟合模型功能的时候了。到目前为止的等待和上面的 7 个步骤都是值得的。因此，让我们在训练数据上拟合回归模型:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="3355" class="lk ll iq lg b gy lm ln l lo lp">lr = LinearRegression() <br/>lr.fit(x_train, y_train)</span></pre><p id="8540" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第八步:特征选择。</strong></p><p id="c4a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这一步是最重要的，也是经常被业余爱好者忽略的。当你有了合适的模型，是时候计算哪些特征或独立变量对你的模型真正重要了。总之如果可能的话，我们再废话少说。</p><p id="b450" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">特征选择是一个广泛的话题，涉及许多技术。大多数专家会争论这一步的位置是否符合模型。我们将把这一部分留在没有代码的地方，并把它当作一项任务，让读者了解更多。你可以先阅读<a class="ae kc" href="https://scikit-learn.org/stable/modules/feature_selection.html" rel="noopener ugc nofollow" target="_blank">的这篇</a>文章</p><p id="f6f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">第九步:计算分数</strong></p><p id="3e58" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用测试数据集进行预测并计算指标，以了解拟合模型的表现。我们将计算均方差来了解相同的情况。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="fa1f" class="lk ll iq lg b gy lm ln l lo lp">print(‘The mean square error is ‘,mean_squared_error(lr.predict(x_test),y_test))</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/486e980a3eb1af9bf9c9bc6b46d105e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/0*rHE-hracCIqobBNP.png"/></div></figure><p id="6bf1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以上所有步骤将构成一个典型的培训标准操作程序。这个序列有它自己的含义。像煤气炉的例子，我们不能只是重新安排步骤，继续进行。例如，假设<strong class="kf ir">步骤 4:</strong>在<strong class="kf ir">步骤 3:【处理缺失值】</strong>之前，您将拥有独立变量和因变量的独立数据。现在，如果在处理缺失值时，这里或那里的几行数据帧被丢弃，这将导致数据帧长度不匹配，并将产生错误。如果碰巧连大小也匹配，这可能会在模型中产生偏差，想象一下删除因变量数据中的第 3 行和自变量数据中的第 5 行。它要么产生错误，要么使结果和模型产生误导。整个过程顺序如下图所示:</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lz"><img src="../Images/e9f4922dbbd62c1f42f4664518118ab3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YTnUUp7JItOtyBioCPEy5g.png"/></div></div></figure><p id="991b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上述步骤可以形成递归训练过程的一个循环。大多数时候，我们最后得到的分数并不令人满意，因此整个过程一次又一次地重复。</p><p id="db95" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望你喜欢这篇文章。请发表您的评论。如有任何疑问，您也可以通过 LinkedIn<a class="ae kc" href="https://www.linkedin.com/in/tanvirhurra/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">联系我。</strong></a></p><p id="d05e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">谢谢，</p><p id="1a2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">祝你玩得愉快😊</p><p id="57e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这篇文章也发表在<a class="ae kc" href="https://www.teastatistic.com/2020/05/9-steps-in-model-training-process-that.html" rel="noopener ugc nofollow" target="_blank">茶统计</a>上</p></div></div>    
</body>
</html>