<html>
<head>
<title>How to use the magic of pipelines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用管道的魔力</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-the-magic-of-pipelines-6e98d7e5c9b7?source=collection_archive---------46-----------------------#2020-08-21">https://towardsdatascience.com/how-to-use-the-magic-of-pipelines-6e98d7e5c9b7?source=collection_archive---------46-----------------------#2020-08-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="dfcf" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用 ETL 拯救世界</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7d0f6c4c2d30b3d076b41d573924e5d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6rZ7tn33aq4PLL0biB-5Fw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">斯文·库契尼奇在<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="344d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您肯定听说过管道或 ETL(提取转换负载)，或者见过库中的一些方法，甚至听说过任何创建管道的工具。但是，您还没有使用它。所以，让我向你介绍管道的奇妙世界。</p><p id="fd3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在了解如何使用它们之前，我们必须了解它是什么。</p><p id="1448" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">管道是一种包装和自动化流程的方式，这意味着流程将始终以相同的方式执行，具有相同的功能和参数，并且结果将始终符合预定的标准。</p><p id="e5ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，正如您可能猜到的，目标是在每个开发阶段应用管道，以试图保证设计的过程不会与理想化的过程不同。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/151282a0a1a8d9c275a829c2fa408eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m5DmyAgqKYrWAr8HDaR3FA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">用<a class="ae kv" href="https://www.kapwing.com/explore/woody-and-buzz-lightyear-everywhere-meme-template" rel="noopener ugc nofollow" target="_blank"> Kapwin </a> g 制成</p></figure><p id="0231" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">管道在数据科学中有两个特别的用途，要么是在生产中，要么是在建模/勘探过程中，这两个用途都非常重要。此外，它使我们的生活更容易。</p><p id="d71d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一个是数据 ETL。在制作过程中，分支要大得多，因此，花费在其中的细节层次也大得多，但是，可以总结为:</p><p id="f92e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">e(提取)—我如何收集数据？如果我要从一个或几个网站，一个或多个数据库，甚至一个简单的熊猫 csv 来收集它们。我们可以把这个阶段看作是数据读取阶段。</p><p id="1f2c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">t(转换)—要使数据变得可用，我需要做些什么？这可以被认为是探索性数据分析的结论，这意味着在我们知道如何处理数据(移除特征、将分类变量转换为二进制数据、清理字符串等)之后。)，我们将其全部编译在一个函数中，该函数保证清理总是以相同的方式进行。</p><p id="bb19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">l(加载)—这只是将数据保存为所需的格式(csv、数据库等)。)某处，要么云端，要么本地，随时随地使用。</p><p id="3e00" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个过程的创建非常简单，只需拿起探索性数据分析笔记本，将 pandas <em class="lt"> read_csv </em>放入一个函数中；编写几个函数来准备数据并在一个函数中编译它们；最后创建一个函数保存前一个函数的结果。</p><p id="8fba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了这些，我们就可以在 python 文件中创建 main 函数，并且用一行代码执行创建的 ETL，而不用冒任何更改的风险。更不用说在一个地方改变/更新所有东西的好处了。</p><p id="a962" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第二个，可能是最有利的管道，有助于解决机器学习中最常见的问题之一:参数化。</p><p id="23e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们多少次面临这些问题:选择哪种模式？我应该使用规范化还是标准化？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/656651735156f23c26d1a10f08048d2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*odUX9HHc42E0CpXDf2ho1Q.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">“作者捕获的屏幕截图”</p></figure><p id="5728" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">scikit-learn 等库为我们提供了流水线方法，我们可以将几个模型及其各自的参数方差放入其中，添加归一化、标准化甚至自定义流程等预处理，甚至在最后添加交叉验证。之后，将测试所有可能性，并返回结果，或者甚至只返回最佳结果，如下面的代码所示:</p><pre class="kg kh ki kj gt lv lw lx ly aw lz bi"><span id="e2c6" class="ma mb iq lw b gy mc md l me mf">def build_model(X,y):                          <br/> pipeline = Pipeline([<br/>        ('vect',CountVectorizer(tokenizer=tokenize)),<br/>        ('tfidf', TfidfTransformer()),<br/>        ('clf', MultiOutputClassifier(estimator=RandomForestClassifier()))                           ])</span><span id="610d" class="ma mb iq lw b gy mg md l me mf"># specify parameters for grid search                           parameters = { <br/>    # 'vect__ngram_range': ((1, 1), (1, 2)),  <br/>    # 'vect__max_df': (0.5, 0.75, 1.0),                                <br/>    # 'vect__max_features': (None, 5000, 10000),<br/>    # 'tfidf__use_idf': (True, False),<br/>    # 'clf__estimator__n_estimators': [50,100,150,200],<br/>    # 'clf__estimator__max_depth': [20,50,100,200],<br/>    # 'clf__estimator__random_state': [42]                                                   } <br/>                                                  <br/># create grid search object                          <br/>cv = GridSearchCV(pipeline, param_grid=parameters, verbose=1)                                                   return cv</span></pre><p id="1e06" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个阶段，天空是极限！管道内部没有参数限制。然而，根据数据库和所选参数的不同，可能需要很长时间才能完成。即便如此，这也是一个非常好的研究工具。</p><p id="125d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以添加一个函数来读取来自数据 ETL 的数据，并添加另一个函数来保存创建的模型，这样我们就有了模型 ETL，结束了这个阶段。</p><p id="0adb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">尽管我们谈论了所有的事情，创建管道的最大优点是代码的可复制性和可维护性，这是指数级提高的。</p><p id="5cc9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么，开始创建管道还等什么呢？</p><p id="8b3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这方面的一个例子可以在这个<a class="ae kv" href="https://github.com/Rpinto02/DisasterResponsePipelines" rel="noopener ugc nofollow" target="_blank">项目</a>中找到。</p></div></div>    
</body>
</html>