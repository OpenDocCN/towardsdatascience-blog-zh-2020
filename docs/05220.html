<html>
<head>
<title>Cluster-based Image Segmentation -Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于聚类的图像分割-Python</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cluster-based-image-segmentation-python-80a295f4f3a2?source=collection_archive---------16-----------------------#2020-05-04">https://towardsdatascience.com/cluster-based-image-segmentation-python-80a295f4f3a2?source=collection_archive---------16-----------------------#2020-05-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/d32e351e15f7cacca2dc699a59f914ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LyBddKCKV-s-Qsfl0Ei3Fw.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">个人电脑:Flickr</p></figure><h2 id="13f8" class="kf kg it bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">理解图像分割</h2><p id="57e6" class="pw-post-body-paragraph lb lc it ld b le lf lg lh li lj lk ll ko lm ln lo ks lp lq lr kw ls lt lu lv im bi translated">最近，我在进行一项图像分类任务，首先我想在将图像输入模型之前，从图像中捕捉感兴趣的区域。我尝试了一种称为基于聚类的图像分割的技术，它帮助我将模型性能提高了一定的水平。让我们看看它是什么和一些样本代码做集群分割，你可以在底部找到Jupyter笔记本。</p><h2 id="88ae" class="kf kg it bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">什么是图像分割？</h2><p id="909a" class="pw-post-body-paragraph lb lc it ld b le lf lg lh li lj lk ll ko lm ln lo ks lp lq lr kw ls lt lu lv im bi translated">想象一下，你要过马路了，你过马路之前做了什么？</p><p id="2709" class="pw-post-body-paragraph lb lc it ld b le lw lg lh li lx lk ll ko ly ln lo ks lz lq lr kw ma lt lu lv im bi translated">首先，你看到道路的两边，以确定接近的车辆和其他环境物体，然后你对接近速度进行一些惊人的估计，并决定何时以及如何过马路。所有这些都发生在很短的时间内，这是多么不可思议。</p><ol class=""><li id="5bcc" class="mb mc it ld b le lw li lx ko md ks me kw mf lv mg mh mi mj bi translated">我们的大脑捕捉道路两边的图像</li><li id="57d4" class="mb mc it ld b le mk li ml ko mm ks mn kw mo lv mg mh mi mj bi translated">它检测道路上的车辆和其他物体</li><li id="1c01" class="mb mc it ld b le mk li ml ko mm ks mn kw mo lv mg mh mi mj bi translated">不仅在此之前检测它确定它检测的每个对象的形状==图像分割</li></ol><p id="bf58" class="pw-post-body-paragraph lb lc it ld b le lw lg lh li lx lk ll ko ly ln lo ks lz lq lr kw ma lt lu lv im bi translated">我们的大脑是多么神奇，通过确定不同物体的形状，它能够在同一张快照中检测到多个物体。</p><p id="bb80" class="pw-post-body-paragraph lb lc it ld b le lw lg lh li lx lk ll ko ly ln lo ks lz lq lr kw ma lt lu lv im bi translated">让我进一步解释，假设我们有图像分类模型，它能够以超过95%的准确率对苹果和橙子进行分类。当我们输入一个既包含苹果又包含橘子的图像时，预测精度会下降。随着图像中对象数量的增加，分类模型的性能会下降。这就是<strong class="ld iu">对象定位</strong>发挥作用的地方。</p><p id="9368" class="pw-post-body-paragraph lb lc it ld b le lw lg lh li lx lk ll ko ly ln lo ks lz lq lr kw ma lt lu lv im bi translated">在我们检测图像中的对象并对其进行分类之前，模型需要理解图像中有什么，这就是图像分割有所帮助的地方。它为图像中的对象创建了一个像素级遮罩，这有助于模型在更精细的级别上理解对象的形状及其在图像中的位置。</p><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/e0b32808cce8d3a8389a6e952e26e3e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*fTHUn-hbna1Q3jR8eeme-g.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">对象检测与图像分割PC:中型</p></figure><h2 id="017d" class="kf kg it bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">细分的类型有哪些？</h2><p id="cb75" class="pw-post-body-paragraph lb lc it ld b le lf lg lh li lj lk ll ko lm ln lo ks lp lq lr kw ls lt lu lv im bi translated">图像分割大致分为两大类。</p><ol class=""><li id="b157" class="mb mc it ld b le lw li lx ko md ks me kw mf lv mg mh mi mj bi translated">语义分割</li><li id="099e" class="mb mc it ld b le mk li ml ko mm ks mn kw mo lv mg mh mi mj bi translated">实例分割</li></ol><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mu"><img src="../Images/6e69407c5914768f9df29bd2847bfec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d59T7gieOJAkL1arRZGU0A.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">检测到的对象—语义段—实例段PC: mc.ai</p></figure><p id="a060" class="pw-post-body-paragraph lb lc it ld b le lw lg lh li lx lk ll ko ly ln lo ks lz lq lr kw ma lt lu lv im bi translated">在第一幅图像中，我们可以看到被检测的对象都是男性。在<strong class="ld iu">语义分割</strong>中，我们认为所有这些像素属于一类，所以我们用一种颜色来表示它们。另一方面，在<strong class="ld iu">实例分割</strong>中，那些像素属于同一类，但是我们用不同的颜色表示同一类的不同实例。</p><p id="9e38" class="pw-post-body-paragraph lb lc it ld b le lw lg lh li lx lk ll ko ly ln lo ks lz lq lr kw ma lt lu lv im bi translated">根据我们使用的方法，细分可以分为许多更窄的类别。</p><ul class=""><li id="0654" class="mb mc it ld b le lw li lx ko md ks me kw mf lv mv mh mi mj bi translated">基于区域的分割</li><li id="ce01" class="mb mc it ld b le mk li ml ko mm ks mn kw mo lv mv mh mi mj bi translated">基于边缘检测的分割</li><li id="ad97" class="mb mc it ld b le mk li ml ko mm ks mn kw mo lv mv mh mi mj bi translated">基于聚类的分割</li><li id="c8aa" class="mb mc it ld b le mk li ml ko mm ks mn kw mo lv mv mh mi mj bi translated">基于CNN的分割等等。</li></ul><p id="ad54" class="pw-post-body-paragraph lb lc it ld b le lw lg lh li lx lk ll ko ly ln lo ks lz lq lr kw ma lt lu lv im bi translated">正如我在开头所承诺的，在本文中我只给出一个基于集群的分段的例子。</p><h2 id="8fba" class="kf kg it bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">什么是基于聚类的细分？</h2><p id="a0d6" class="pw-post-body-paragraph lb lc it ld b le lf lg lh li lj lk ll ko lm ln lo ks lp lq lr kw ls lt lu lv im bi translated">回忆一下你对聚类算法的理解。聚类算法用于将彼此更相似的数据点从其他组数据点中更紧密地分组。</p><p id="0225" class="pw-post-body-paragraph lb lc it ld b le lw lg lh li lx lk ll ko ly ln lo ks lz lq lr kw ma lt lu lv im bi translated">现在想象一个包含苹果和桔子的图像。苹果里的像素点大部分应该是红/绿，和橙色的像素值不一样。如果我们能把这些点聚集起来，我们就能正确地区分每个物体。这就是基于聚类的分段的工作方式。现在让我们看一些代码示例。</p><pre class="mq mr ms mt gt mw mx my mz aw na bi"><span id="7a76" class="kf kg it mx b gy nb nc l nd ne">from skimage.io import imread<br/>from skimage.color import rgb2gray<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline<br/>from scipy import ndimage</span><span id="eba9" class="kf kg it mx b gy nf nc l nd ne"># Scaling the image pixels values within 0-1<br/>img = imread('./apple-orange.jpg') / 255</span><span id="7a1c" class="kf kg it mx b gy nf nc l nd ne">plt.imshow(img)<br/>plt.title('Original')<br/>plt.show()</span></pre><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/9f265d0baa5cc80a9c8f5ac20b391290.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*9-WBti1VZPRGULmcRWqsjA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">个人电脑:Flickr</p></figure><p id="46a8" class="pw-post-body-paragraph lb lc it ld b le lw lg lh li lx lk ll ko ly ln lo ks lz lq lr kw ma lt lu lv im bi translated">对于我们的肉眼来说，图像中有五个颜色段</p><ol class=""><li id="de2b" class="mb mc it ld b le lw li lx ko md ks me kw mf lv mg mh mi mj bi translated">苹果的绿色部分</li><li id="838e" class="mb mc it ld b le mk li ml ko mm ks mn kw mo lv mg mh mi mj bi translated">橙子的橙色部分</li><li id="1d0b" class="mb mc it ld b le mk li ml ko mm ks mn kw mo lv mg mh mi mj bi translated">苹果和橘子底部的灰色阴影</li><li id="3eaa" class="mb mc it ld b le mk li ml ko mm ks mn kw mo lv mg mh mi mj bi translated">苹果顶部和右部的亮黄色部分</li><li id="1a9a" class="mb mc it ld b le mk li ml ko mm ks mn kw mo lv mg mh mi mj bi translated">白色背景</li></ol><p id="984f" class="pw-post-body-paragraph lb lc it ld b le lw lg lh li lx lk ll ko ly ln lo ks lz lq lr kw ma lt lu lv im bi translated">让我们看看是否可以使用scikit-learn中的KMeans算法对它们进行聚类</p><pre class="mq mr ms mt gt mw mx my mz aw na bi"><span id="8846" class="kf kg it mx b gy nb nc l nd ne"># For clustering the image using k-means, we first need to convert it into a 2-dimensional array<br/>image_2D = img.reshape(img.shape[0]*img.shape[1], img.shape[2])</span><span id="e19c" class="kf kg it mx b gy nf nc l nd ne"># Use KMeans clustering algorithm from sklearn.cluster to cluster pixels in image<br/>from sklearn.cluster import KMeans</span><span id="2652" class="kf kg it mx b gy nf nc l nd ne"># tweak the cluster size and see what happens to the Output<br/>kmeans = KMeans(n_clusters=5, random_state=0).fit(image_2D)<br/>clustered = kmeans.cluster_centers_[kmeans.labels_]</span><span id="1b83" class="kf kg it mx b gy nf nc l nd ne"># Reshape back the image from 2D to 3D image<br/>clustered_3D = clustered.reshape(img.shape[0], img.shape[1], img.shape[2])</span><span id="f579" class="kf kg it mx b gy nf nc l nd ne">plt.imshow(clustered_3D)<br/>plt.title('Clustered Image')<br/>plt.show()</span></pre><figure class="mq mr ms mt gt ju gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/9ed2f808402ea6a22cc38ef7f02b0e47.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*qbA5jWyRFURv7YSZhYZacw.png"/></div></figure><p id="69e3" class="pw-post-body-paragraph lb lc it ld b le lw lg lh li lx lk ll ko ly ln lo ks lz lq lr kw ma lt lu lv im bi translated">哇，真管用！！！我们能够将所有五个部分聚集在一起。这就是聚类分割的工作原理。</p><p id="5e99" class="pw-post-body-paragraph lb lc it ld b le lw lg lh li lx lk ll ko ly ln lo ks lz lq lr kw ma lt lu lv im bi translated">有许多先进的技术，如Mask R-CNN，可以进行更细粒度的分割。让我们在其他文章中看到这些主题。我希望您现在对图像分割有了一定程度的了解。</p><p id="f906" class="pw-post-body-paragraph lb lc it ld b le lw lg lh li lx lk ll ko ly ln lo ks lz lq lr kw ma lt lu lv im bi translated">你可以在<a class="ae ni" href="https://github.com/Mathanraj-Sharma/sample-for-medium-article/blob/master/cluster-based-segmentation-skimage/cluster-based-segmentation.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/mathan Raj-Sharma/sample-for-medium-article/blob/master/cluster-based-segmentation-skimage/cluster-based-segmentation . ipynb</a>找到上面例子的笔记本</p></div></div>    
</body>
</html>