<html>
<head>
<title>Mastering Data Aggregation with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用熊猫掌握数据聚合</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mastering-data-aggregation-with-pandas-36d485fb613c?source=collection_archive---------35-----------------------#2020-09-03">https://towardsdatascience.com/mastering-data-aggregation-with-pandas-36d485fb613c?source=collection_archive---------35-----------------------#2020-09-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="35b8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用熊猫聚合数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5dc3203c1bfd24cc64221b9f0f76a26f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*we21aFPXi5-o-hBj5zgQDw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.pexels.com/photo/depth-of-field-photography-of-file-arrangement-1181772/" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="8958" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据汇总是收集数据并以汇总形式表达的过程。这通常对应于数据集中数值和分类变量的汇总统计。在本帖中，我们将讨论如何使用 pandas 聚合数据并生成有洞察力的汇总统计数据。</p><p id="0fe9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><p id="5972" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于我们的目的，我们将使用葡萄酒评论数据集，这个数据集可以在<a class="ae ky" href="https://www.kaggle.com/zynicide/wine-reviews" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="6d2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们将数据读入熊猫数据框:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="208f" class="ma mb it lw b gy mc md l me mf">import pandas as pd<br/>df = pd.read_csv("winemag-data-130k-v2.csv")</span></pre><p id="ac73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们打印前五行数据:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a742" class="ma mb it lw b gy mc md l me mf">print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mg"><img src="../Images/e8e847a2eeb24e7d7f91a794470a7c1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XH-yky8WMB8JUQt2wK50Sg.png"/></div></div></figure><h2 id="c5e3" class="ma mb it bd mh mi mj dn mk ml mm dp mn li mo mp mq lm mr ms mt lq mu mv mw mx bi translated">使用 DESCRIBE()方法</h2><p id="90d3" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">“describe()”方法是一个基本方法，它允许我们为数据中的列提取汇总统计信息。让我们用“describe()”方法来计算葡萄酒的价格:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a6eb" class="ma mb it lw b gy mc md l me mf">print(df['price'].describe())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/9ee4a5285f71743183f37309e3bdb510.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*j2831uaYYcEJVCYCmOZQQA.png"/></div></figure><p id="a353" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到葡萄酒价格的“计数”，即非空值的数量是 120，975。葡萄酒的平均价格是 35 美元，标准差是 41 美元。葡萄酒价格的最小值为 4 美元，最大值为 3300 美元。“describe()”方法也提供了百分位数。在这里，25%的葡萄酒价格低于 17 美元，50%低于 25 美元，75%低于 42 美元。</p><p id="3a5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们使用“points”列上的“describe()”来查看汇总统计数据:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="bf0f" class="ma mb it lw b gy mc md l me mf">print(df['points'].describe())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/0dd8ac24bd667af0237d8ea6f86c1b17.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*c9TmMp87lsmRTePRRhaFrg.png"/></div></figure><p id="e84f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到点的非空值个数是 129971，恰好是数据帧的长度。平均点数为 88，标准偏差为 3。葡萄酒积分的最小值为 80，最大值为 100。对于百分位数，25%的葡萄酒得分低于 86，50%低于 88，75%低于 91。</p><h2 id="5085" class="ma mb it bd mh mi mj dn mk ml mm dp mn li mo mp mq lm mr ms mt lq mu mv mw mx bi translated">使用 GROUPBY()方法</h2><p id="d2a8" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">您还可以使用“groupby()”来聚合数据。例如，如果我们想要查看每种葡萄酒的平均价格，我们可以执行以下操作:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="912d" class="ma mb it lw b gy mc md l me mf">print(df['price'].groupby(df['variety']).mean().head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/035e78cf18cc759aa60e06eaddc2da2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*g8AppMC3fvuzKKuBNVS3AA.png"/></div></figure><p id="fe62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到“Abouriou”葡萄酒的平均价格为 35 美元，“Agiorgitiko”的平均价格为 23 美元，以此类推。我们还可以显示排序后的值:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="8e8a" class="ma mb it lw b gy mc md l me mf">print(df['price'].groupby(df['variety']).mean().sort_values(ascending = False).head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/93a73bac418fac2304728abcb65f8902.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*DaO5_hkxf3wXIKIfWfMoVQ.png"/></div></figure><p id="5841" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来看看每个“省份”的平均价格:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="50f4" class="ma mb it lw b gy mc md l me mf">print(df['price'].groupby(df['province']).mean().sort_values(ascending = False).head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/2726a5bf72b01757f8c275e19b797497.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*MNhmu4lwEd4eVZF0r0PumA.png"/></div></figure><p id="f035" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以查看多个列。让我们看看各省的平均价格和积分:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3e97" class="ma mb it lw b gy mc md l me mf">print(df[['price', 'points']].groupby(df.province).mean().head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/5351ccdb3e6f6c29490bd86288285f3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*VDhkn8-6sKRTDuVQKa47Yw.png"/></div></figure><p id="17bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我就讲到这里，但是我鼓励你自己动手处理数据和编写代码。</p><h2 id="91a1" class="ma mb it bd mh mi mj dn mk ml mm dp mn li mo mp mq lm mr ms mt lq mu mv mw mx bi translated">结论</h2><p id="25f6" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">总之，在这篇文章中，我们讨论了如何使用 pandas 来聚集数据。首先，我们讨论了如何使用“describe()”方法来生成汇总统计数据，例如数据列的平均值、标准偏差、最小值、最大值和百分位数。然后，我们讨论了如何使用“groupby()”方法来生成特定分类变量的统计数据，例如每个省的平均价格和每个品种的平均价格。我希望你觉得这篇文章有用/有趣。这篇文章的代码可以在 GitHub 上找到。感谢您的阅读！</p></div></div>    
</body>
</html>