<html>
<head>
<title>PyCaret: The Machine Learning Omnibus</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PyCaret:机器学习的综合体</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pycaret-the-machine-learning-omnibus-dadf6e230f7b?source=collection_archive---------33-----------------------#2020-08-05">https://towardsdatascience.com/pycaret-the-machine-learning-omnibus-dadf6e230f7b?source=collection_archive---------33-----------------------#2020-08-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6b33" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">…满足您所有机器学习需求的一站式商店</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/81f4603c1a272a1c620606405cefa8d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zFGSAHa-gdzzs1uaNe_vAA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@ashtree?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">阿什利·特雷瑟万</a>在<a class="ae ky" href="https://unsplash.com/s/photos/one-stop-shop?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="3537" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">任何机器学习项目之旅都是从加载数据集开始，到结束(继续？！)最终确定用于预测未知数据和生产部署的最佳模型或模型集合。</p><p id="2b07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为机器学习的实践者，我们知道在达到最佳预测性能结果的过程中会有几个中途停留点。这些中间步骤包括探索性数据分析(EDA)、数据预处理——缺失值处理、异常值处理、改变数据类型、编码分类特征、数据转换、特征工程/选择、采样、训练-测试分离等。举几个例子，在我们开始建模、评估和预测之前。</p><p id="5433" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们最终导入了几十个 python 包来帮助我们做到这一点，这意味着要熟悉每个包中多个函数调用的语法和参数。</p><p id="79a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你是否希望有一个单一的包可以用一致的语法界面处理整个端到端的旅程？我当然有！</p><h2 id="05ad" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">输入 PyCaret</h2><p id="4bf0" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">这些愿望通过<code class="fe mt mu mv mw b">PyCaret</code>包得到了回应，现在随着<code class="fe mt mu mv mw b">pycaret2.0</code>的发布，它变得更加令人敬畏。</p><p id="400f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这篇文章开始，我将发布一系列关于<code class="fe mt mu mv mw b">pycaret</code>如何帮助我们快速完成一个 ML 项目的各个阶段的文章。</p><h2 id="de1f" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">装置</h2><p id="3f2f" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">安装轻而易举，几分钟内即可完成，所有依赖项也已安装完毕。建议使用虚拟环境安装，如<a class="ae ky" href="https://docs.python.org/3/tutorial/venv.html" rel="noopener ugc nofollow" target="_blank"> python3 virtualenv </a>或<a class="ae ky" href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html" rel="noopener ugc nofollow" target="_blank"> conda environments </a>以避免与其他预安装的软件包冲突。</p><p id="6e48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mt mu mv mw b">pip install pycaret==2.0</code></p><p id="a38f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦安装完毕，我们就可以开始了！我们将包导入到我们的笔记本电脑环境中。这里我们将讨论一个分类问题。类似地，可以为涉及回归、聚类、异常检测、NLP 和关联规则挖掘的场景导入相应的 PyCaret 模块。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/89e057e879d31a84d432c37d7b574556.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*KjLZGSUHQ0gZAmn9KL2L_Q.png"/></div></figure><p id="8e13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用来自 kaggle.com 的<code class="fe mt mu mv mw b">titanic</code>数据集。你可以从<a class="ae ky" href="https://www.kaggle.com/c/titanic/data" rel="noopener ugc nofollow" target="_blank">这里</a>下载数据集。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/089bf2fb233de6ac9bfaf630d62f95d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*FIt1AhERNGAH2Sz3SrviGA.png"/></div></figure><p id="35dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们使用<code class="fe mt mu mv mw b">head()</code>函数检查数据集的前几行:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/848385c93592e137e88b26bdbbd59454.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*8eetyCWNsRlM0lafvsqRiQ.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/6c838ebfeddd007b7cb8d772afd24d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AWxRY3Up2RI2iwplYKHLGA.png"/></div></div></figure><h2 id="8cd5" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">设置</h2><p id="3b7e" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated"><code class="fe mt mu mv mw b">pycaret</code>的<code class="fe mt mu mv mw b">setup()</code>函数只需一行代码就可以完成大部分——所有的修正工作，这些繁重的工作通常需要几十行代码才能完成！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/42e80310fca3f7b587fd72aacbf380fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*caH0jKyL9m-sCkdNDiQJ7w.png"/></div></figure><p id="3ab9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们只需要传递数据帧并指定目标特性的名称作为参数。setup 命令生成以下输出。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/f1066f5d742fa0eda59182e4d3a13bb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tiQGmzuRxsJ4unan0dLDjw.png"/></div></div></figure><p id="16c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mt mu mv mw b">setup</code>推断出了数据集中要素的数据类型，非常有用。如果我们同意，我们需要做的就是点击<code class="fe mt mu mv mw b">Enter</code>。否则，如果您认为由<code class="fe mt mu mv mw b">setup</code>推断的数据类型不正确，那么您可以在底部的字段中键入<code class="fe mt mu mv mw b">quit</code>，然后返回到<code class="fe mt mu mv mw b">setup</code>函数进行更改。我们将很快看到如何做到这一点。现在，让我们点击<code class="fe mt mu mv mw b">Enter</code>，看看会发生什么。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/53fe119cece6dd4c93bf9f0ba98e7f8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*HGQGZaV8dgpTKUxWYt6hog.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输出续。,</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/32d402c295467c918e99dd3878c96dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*7jNWHbSa4bZ96L89V3LuRA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">产出续下</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/b0aed6a133dcf5e9cb95c85c24483a51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*kAZhtyJwG0VyIwHAWdkAtw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输出结束</p></figure><p id="681d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">咻！在一行看似无害的代码中，似乎发生了很多事情！让我们来盘点一下:</p><ul class=""><li id="b1ec" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">已检查缺失值</li><li id="ea0b" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">已识别的数字和分类特征</li><li id="b028" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">从原始数据集创建训练和测试数据集</li><li id="28da" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">具有平均值的连续要素中的估算缺失值</li><li id="8b9b" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">具有常数值的分类特征中的估算缺失值</li><li id="78a8" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">完成标签编码</li><li id="3dc7" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">..似乎还有许多其他选择，包括异常值处理、数据缩放、特征变换、降维、多重共线性处理、特征选择和处理不平衡数据等。！</li></ul><p id="e216" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是嘿！第 11 和 12 行是什么？训练和测试数据集中的特征数量是 1745？似乎是标签编码变得疯狂的一个例子，很可能来自于分类特征，如<code class="fe mt mu mv mw b">name</code>、<code class="fe mt mu mv mw b">ticket</code>和<code class="fe mt mu mv mw b">cabin</code>。在本文和下一篇文章中，我们将探讨如何根据我们的需求控制设置，以主动解决这种情况。</p><h2 id="93ac" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">定制<code class="fe mt mu mv mw b">setup</code></h2><p id="71c2" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">首先，我们如何从模型构建中排除像上面三个特征这样的特征？我们在<code class="fe mt mu mv mw b">setup</code>函数的<code class="fe mt mu mv mw b">ignore_features</code>参数中传递我们想要排除的变量。需要注意的是，ID 和 DateTime 列在推断时会被自动设置为在建模时被忽略。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/eba64b0fc155e1ccf8f58ade15fa1b80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RRQ1pfTHaV9cp1ILcJGw-g.png"/></div></div></figure><p id="b49c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意下面的<code class="fe mt mu mv mw b">pycaret</code>，在要求我们确认时，已经放弃了上面提到的 3 个特性。让我们点击<code class="fe mt mu mv mw b">Enter</code>并继续。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/55cecb78860f4aa8e4526d3cd6a3e5fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2jYuN_Dafo1CCDF6nskRyg.png"/></div></div></figure><p id="b50f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在结果输出中(截断版本如下所示)，我们可以看到设置后，数据集形状现在更易于管理，只对剩余的更相关的分类特征进行标签编码:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/f6d0e6b12f74fd6abd5cce4916261904.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*dTM1t0um9milQXxxtB59cA.png"/></div></figure><p id="d2d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本系列的下一篇文章中，我们将详细讨论进一步的数据预处理任务，我们可以使用<code class="fe mt mu mv mw b">pycaret</code>的这个<code class="fe mt mu mv mw b">setup</code>函数通过传递额外的参数在数据集上实现这些任务。</p><p id="94b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是在我们走之前，让我们用<code class="fe mt mu mv mw b">compare_model()</code>函数来对<code class="fe mt mu mv mw b">pycaret</code>惊人的模型比较能力做一个闪影。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/13715847e5c2ff78e005e8d319f93c04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ivnNclcdx4JxMWiHhOEuQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在各种分类指标上比较模型性能。</p></figure><p id="eee5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">嘣！所有需要做的只是<code class="fe mt mu mv mw b">compare_models()</code>获得 15 个分类建模算法的结果，这些算法在交叉验证的各种分类指标之间进行比较。一目了然，我们可以看到<code class="fe mt mu mv mw b">CatBoost</code>分类器在大多数指标上表现最佳，其中<code class="fe mt mu mv mw b">Naive-Bayes</code>在召回率上表现良好，而<code class="fe mt mu mv mw b">Gradient Boosting</code>在精确度上表现良好。每个指标中表现最佳的型号会由<code class="fe mt mu mv mw b">pycaret</code>自动突出显示。</p><p id="00f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据我们感兴趣的模型评估指标,<code class="fe mt mu mv mw b">pycaret</code>有助于我们直接放大表现最佳的模型，我们可以使用超参数进一步调整这些模型。在接下来的文章中会有更多的介绍。</p><p id="88bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总之，我们已经简要了解了<code class="fe mt mu mv mw b">pycaret</code>如何通过最少的代码结合关键数据预处理阶段的广泛而全面的定制，帮助我们快速完成 ML 项目生命周期。</p><p id="a279" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能也会对我的其他文章感兴趣，这些文章介绍了在探索性数据分析(EDA)和可视化中使用最少的代码来交付最大的结果的优秀包。</p><div class="ny nz gp gr oa ob"><a rel="noopener follow" target="_blank" href="/eda-in-r-with-smarteda-eae12f2c6094"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">使用 SmartEDA 开发的 EDA</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">探索性数据分析——更智能、更快速的方式..</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">towardsdatascience.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op ks ob"/></div></div></a></div><div class="ny nz gp gr oa ob"><a rel="noopener follow" target="_blank" href="/patchwork-the-next-generation-of-ggplots-1fcad5d2ba8a"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd iu gy z fp og fr fs oh fu fw is bi translated">拼凑——下一代 ggplots</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">进一步扩展 ggplot2 的多功能性..</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">towardsdatascience.com</p></div></div><div class="ok l"><div class="oq l om on oo ok op ks ob"/></div></div></a></div><p id="20b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读，并希望听到您的反馈。干杯！</p></div></div>    
</body>
</html>