<html>
<head>
<title>Writing 5 common SQL queries in pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 pandas 编写 5 个常见的 SQL 查询</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/writing-5-common-sql-queries-in-pandas-90b52f17ad76?source=collection_archive---------32-----------------------#2020-09-14">https://towardsdatascience.com/writing-5-common-sql-queries-in-pandas-90b52f17ad76?source=collection_archive---------32-----------------------#2020-09-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bc0e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用您的 SQL 数据操作技能来学习熊猫</h2></div><p id="0b21" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">能够熟练地使用 SQL 和 pandas(Python 中的一个数据分析库)操作数据，对于数据分析师、数据科学家和任何处理数据的人来说都是一项很有价值的技能。在本帖中，我们将并排比较 SQL 查询和它们在 pandas 中的对应项。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/162c038d5988634c0fbe215743044418.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*N2oS8GryrAH0qVbApe0JPA.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">作者图片</p></figure><p id="935b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通常有许多方法可以达到相同的输出。因此，对于一些 SQL 查询，我们将在 pandas 中选择一些对应的查询。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="64a6" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">0.资料组📦</h1><p id="1725" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated"><em class="mu">如果你还没有，确保你已经安装了</em> <a class="ae mv" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/install.html" rel="noopener ugc nofollow" target="_blank"> <em class="mu">熊猫</em> </a> <em class="mu">和</em> <a class="ae mv" href="https://seaborn.pydata.org/installing.html" rel="noopener ugc nofollow" target="_blank"> <em class="mu">海兽</em> </a> <em class="mu">。</em></p><p id="7d84" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用 seaborn 的餐馆小费数据集作为样本数据集。关于这个数据集的细节可以在这里找到<a class="ae mv" href="https://vincentarelbundock.github.io/Rdatasets/doc/reshape2/tips.html" rel="noopener ugc nofollow" target="_blank">(这个源实际上是 R 的，但是它看起来是指同一个底层数据集)。为了便于快速查阅，我在下面引用了他们的数据描述:</a></p><blockquote class="mw mx my"><p id="11c6" class="ki kj mu kk b kl km ju kn ko kp jx kq mz ks kt ku na kw kx ky nb la lb lc ld im bi translated">“一个服务员记录了他在一家餐馆工作几个月期间收到的每一笔小费的信息。” </p></blockquote><pre class="lf lg lh li gt nc nd ne nf aw ng bi"><span id="4981" class="nh ly it nd b gy ni nj l nk nl"># Import packages<br/>import pandas as pd<br/>import seaborn as sns</span><span id="c2a2" class="nh ly it nd b gy nm nj l nk nl"># Import data <br/>tips = sns.load_dataset('tips')</span></pre></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="1da9" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">📍 1.查看数据提取</h1><p id="d55c" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">让我们简单地从数据集中的前 5 条记录开始:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/76866b63e112b32b2825e7eb14531a38.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*Qvty_vxUIi_PSJOBky51kA.png"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi no"><img src="../Images/aa9c7bf762bb8eae6bed9f3b011a9a9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*PzVBcju4EXeKd1IHl9PwXg.png"/></div></figure><p id="af8f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<code class="fe np nq nr nd b">head()</code>方法中，我们可以像这样指定 parantheses 中的行数:<code class="fe np nq nr nd b">tips.head(5)</code>。然而，在这个例子中我们可以不用<code class="fe np nq nr nd b">tips.head()</code>，因为默认的行数被设置为 5。</p><p id="1984" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们不查看所有列，而是查看包含选定列的前 3 行:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/7bb77ddbd780e4f78f99bf56447c48ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*8PqP4ai9G9gucXco5HCBXA.png"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi nt"><img src="../Images/346850f60732a80b7e264b8abba914fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:230/format:webp/1*gQo8JZpQzv7VrbemmUSdcQ.png"/></div></div></figure><p id="a00a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本例中，更改行选择和列选择的顺序不会影响结果。因此，图像显示了两种变化。在第一个版本中，我们首先选择列，然后指定行选择，而在第二个版本中，我们反过来做。现在，让我们看看如何过滤数据。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="38bd" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">📍 2.过滤数据</h1><p id="5de2" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">让我们来看看周四前五名的记录:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi ny"><img src="../Images/1cabbe3d7abeb829c1e2d4470f33a47e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eh95Jtfr3mHFMdq2_HxPqA.png"/></div></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/0a8fd0ca6cdd5c44845c45cf26fa0134.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*cm4lOdP35P-MNOsCjC2Rgw.png"/></div></figure><p id="2990" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以用三种方法中的一种在熊猫身上达到同样的效果。第一种是我最喜欢的在 pandas 中过滤数据的方法，因为它更简洁，尤其是当有多个条件要过滤时。在另外两种方法中，我们用代码的<code class="fe np nq nr nd b">tips['day']=='Thur'</code>部分表示的<em class="mu">布尔掩码</em>过滤数据。该布尔掩码将为每个记录创建一个布尔值，如果记录来自星期四，则为<code class="fe np nq nr nd b">True</code>，否则为<code class="fe np nq nr nd b">False</code>。因为后两种方法除了<code class="fe np nq nr nd b">.loc</code>部分是相同的，我将只展示后者的例子，因为前者可以很容易地从另一个中推断出来。你注意到我们用<code class="fe np nq nr nd b">==</code>表示平等吗？那是因为<code class="fe np nq nr nd b">=</code>在 Python 中是为赋值保留的。然而，<code class="fe np nq nr nd b">&gt;</code>、<code class="fe np nq nr nd b">&gt;=</code>、<code class="fe np nq nr nd b">&lt;</code>和<code class="fe np nq nr nd b">&lt;=</code>在两者中的工作方式是一样的。现在，让我们看看其他一些运算符:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi oa"><img src="../Images/2800077879bd83a94a6bb249c7b04e66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WI6qr1ZS34tOgYRHPEb3IA.png"/></div></div></figure><p id="1b6b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如你所见，两者在关键词上有相似之处。需要记住的一点是 Python 是区分大小写的。这意味着<code class="fe np nq nr nd b">match(r'S.')</code>和<code class="fe np nq nr nd b">match(r's.')</code>将给出不同的输出，而 SQL 中的<code class="fe np nq nr nd b">LIKE 'S%'</code>或<code class="fe np nq nr nd b">LIKE 's%'</code>将返回相同的输出。如果我们想过滤任何以' s '开头的日期，而不考虑大小写，一种方法是使用<code class="fe np nq nr nd b">match(r'[Ss]')</code>。如果对于某些记录，我们有一个名为“S”的工作日，<code class="fe np nq nr nd b">WHERE day LIKE ‘S%'</code>和<code class="fe np nq nr nd b">.str.startswith(‘S')</code>将选择这些案例，而<code class="fe np nq nr nd b">.str.match(r'S.')</code>不会。如果我们想迎合这种情况，那么我们将修改脚本为<code class="fe np nq nr nd b">.str.match(r'S.?')</code>。现在，让我们来看看否定:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi ob"><img src="../Images/df19d63158b139b3b0a1eac029c491d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nVvW7SYl2AOMJT3BRIAE8A.png"/></div></div></figure><p id="f765" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可能已经注意到，SQL 中的<code class="fe np nq nr nd b">NOT</code>对应于 pandas 中的<code class="fe np nq nr nd b">-</code>或<code class="fe np nq nr nd b">~</code>。现在，让我们看看如何使用<code class="fe np nq nr nd b">AND</code>或<code class="fe np nq nr nd b">OR</code>进行多条件过滤:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi oc"><img src="../Images/23d8f0b66ffa9ac87f02214814bba8bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HZ4vEoIIEnSDjPtU7RJrow.png"/></div></div></figure><blockquote class="mw mx my"><p id="9927" class="ki kj mu kk b kl km ju kn ko kp jx kq mz ks kt ku na kw kx ky nb la lb lc ld im bi translated"><em class="it">💡</em>在 Python 中，<code class="fe np nq nr nd b">and</code>或<code class="fe np nq nr nd b">or</code>被称为布尔运算符，而<code class="fe np nq nr nd b">&amp;</code>或<code class="fe np nq nr nd b">|</code>被认为是位运算符。</p></blockquote><p id="fc58" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如你所见，用<code class="fe np nq nr nd b">query</code>过滤比布尔掩码更简洁。它也更灵活，因为我们可以使用布尔或按位运算符。另一方面，当使用布尔掩码过滤时，只支持按位运算符。那就是<code class="fe np nq nr nd b">tips[(tips['tip']&gt;=9) or (tips['size']==6)]</code>会给出一个错误。如果你想知道为什么，看看 StackOverFlow 上的这个帖子。</p><p id="a77e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，当根据您的熊猫版本使用<code class="fe np nq nr nd b">query()</code>时，您可能会遇到此处 : <code class="fe np nq nr nd b">TypeError: ‘Series’ objects are mutable, thus they cannot be hashed</code>描述的<a class="ae mv" href="https://github.com/pandas-dev/pandas/issues/34251" rel="noopener ugc nofollow" target="_blank">问题。如果发生这种情况，请使用使用布尔掩码的替代方法来过滤数据。</a></p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="6e8f" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">📍 3.排序数据</h1><p id="e2e2" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">现在让我们看看如何按一列升序对数据进行排序:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi od"><img src="../Images/4ea000e359c6cf337b642b1569abab70.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*llUjDfkCPnrwPBF7Sa8WhA.png"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/0bfc0235374989e2e8c1eb3c12d75b54.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*sFFi6bT1TAl0YoyyzygH7w.png"/></div></figure><p id="7b28" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就像我们可以在 SQL 中使用<code class="fe np nq nr nd b">ORDER BY tip ASC</code>一样，我们也可以在 pandas 中使用<code class="fe np nq nr nd b">tips.sort_values(tip’, ascending=True)</code>。然而，我觉得这些多余的赘言是多余的。如果我们要按降序排序，我们使用:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi of"><img src="../Images/6c7ba07d35a41be6992224a8caf2a2cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AyCp-kDvoHN3R2rYUG6A6g.png"/></div></div></figure><p id="e68c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">看看布尔值如何也可以用整数来表示？让我们看看如何按多列排序:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi og"><img src="../Images/0a96b7f408e796c4a43a2f16870d3b5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PJbu_z3w75JRE5UVeYrrgw.png"/></div></div></figure><p id="d6aa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">排序到此为止！</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="dff5" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">📍 4.汇总数据</h1><p id="3da4" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">通常，我们希望汇总数据并检查汇总指标，让我们从最基本的指标开始。这是检查行数的方法:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/9bb2b7c9fdaf95418473c451fc2db272.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*ptCW4sgZnf2Kto0cu60zBw.png"/></div></figure><p id="ecec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在 pandas 中，如果我们运行<code class="fe np nq nr nd b">tips.shape</code>，它将以如下格式显示行数和列数:(#rows，#columns)。这里，我们只是通过添加<code class="fe np nq nr nd b">[0]</code>来过滤行数。另一种常见的聚合是查找汇总统计数据。让我们检查所有数字列的平均值:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/ad2be4eb55397585cf046c8b9da5a8a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*t56xc-3mVMuFTDCIE5BlVQ.png"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/6add926501a505ac7161740e691db4e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:474/format:webp/1*iRQ-IGC_ft8PdnbhQfCrIg.png"/></div></figure><p id="7b7b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在 pandas 中使用这两个选项中的任何一个，如果数据在正确的<a class="ae mv" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dtypes.html" rel="noopener ugc nofollow" target="_blank">类型</a>中，所有的数字列都将被自动选取。因此，我们不必键入所有的列名。</p><p id="d41c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">值得注意的是，<code class="fe np nq nr nd b">agg</code>其实是<code class="fe np nq nr nd b">aggregate</code>的别名。因此，所示的第二个选项是<code class="fe np nq nr nd b">tips.aggregate('mean')</code>的简称。</p><p id="abeb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们检查列的最小值和最大值:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/12f26a4b055528f7034d5daf554aa18d.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*R-XbIjs1IeQrkEmIm_E99w.png"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/afe3b89746638761342da62d4768de23.png" data-original-src="https://miro.medium.com/v2/resize:fit:184/format:webp/1*zBwfM33xcnUjvuQNJewREA.png"/></div></figure><p id="6ab1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样，这两种选择都可行。让我们进一步扩展查询:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi om"><img src="../Images/a717ea151c3c95f0deb3e13580b42846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*46Ys6zEgohgquGmnb5bGzA.png"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi on"><img src="../Images/6bae9458d5e67cbdf9d6948121e9435a.png" data-original-src="https://miro.medium.com/v2/resize:fit:406/format:webp/1*5McJsc1UoFjvO2b5MsvrUA.png"/></div></figure><p id="70ff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">尽管 SQL 和 pandas 中的输出并不完全相同，但我们得到的是相同的汇总统计数据，只是格式略有不同。这就是我们如何为两列提取相同的汇总统计信息:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/90fdcc88eec05cd71c4db3d3d78ba0e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*PWlGRtFNtLfDABNqBzunGg.png"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi op"><img src="../Images/bf37dbf6975249dec467ed698bcef6e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*A2pV8V46g4UVfxcf4R2sFA.png"/></div></figure><p id="1a53" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一个常见的查询是检查列的唯一值:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/70ba791aba669ec137ac6248ab39a989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*CjtSjgLF5cyaj8v_EGtHwg.png"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi or"><img src="../Images/80265142024f660e8377e7800f7b9382.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*sw-i5bmwKqREfbr8zO7Xkw.png"/></div></figure><p id="ad7a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们想查看唯一值的数量，那么它会变成:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi os"><img src="../Images/a9b0fd6b8fa30bc33ea6f3ec8528738c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*V-ytepMoOtGJ01Kb3TByKA.png"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/a88eb485a2bf77f6539a50cee9b95bd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:38/format:webp/1*HnEgOeT67vXNeCUA0Xo22Q.png"/></div></figure><p id="f86d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在熊猫中，我们还可以使用<code class="fe np nq nr nd b">describe()</code>获得汇总统计数据。如果我们运行<code class="fe np nq nr nd b">tips.describe()</code>，我们将看到一个漂亮的所有数字列的汇总统计表。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><h1 id="57a7" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">📍 5.按组聚集数据</h1><p id="8cb8" class="pw-post-body-paragraph ki kj it kk b kl mp ju kn ko mq jx kq kr mr kt ku kv ms kx ky kz mt lb lc ld im bi translated">让我们先看一个简单的组聚合示例:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/a915fe2be53e565af58b204cbab190e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*F1BUTpDBXLAPeKkxdoKu7w.png"/></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/2c315b8361997d8dc46b38a581dc61d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:262/format:webp/1*Lur54CyjWHt66bLgdWjRqA.png"/></div></figure><p id="5ddd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一个例子:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi ow"><img src="../Images/537d7e0187cc818bf4bdfa987ae315b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8W3ljh2oQWNwnPHHlaKmQA.png"/></div></div></figure><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/e02dda03dc68bbc4698b214cc4a5d953.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*VRwCsO7DHz5SpFVvcSmZ5w.png"/></div></figure><p id="483d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">熊猫的数据透视表看起来更简单吗？也许吧？👀我们也可以将我们在聚合部分学到的知识用于组聚合。</p><p id="8c8b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Voila❕:这些是对 5 种查询的比较。这里有一个额外的例子，我们结合了一些查询:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi oy"><img src="../Images/add487ad7a9ee3583140d6eb0bddf960.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xZblBxi2gD9biN4jZ7pHKQ.png"/></div></div></figure><p id="3590" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mu">您想访问更多这样的内容吗？媒体会员可以无限制地访问媒体上的任何文章。如果您使用</em> <a class="ae mv" href="https://zluvsand.medium.com/membership" rel="noopener"> <em class="mu">我的推荐链接</em></a><em class="mu">成为会员，您的一部分会费将直接用于支持我。</em></p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="33de" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">谢谢你看我的帖子。希望这些比较对你有用，✂️，并对熊猫有更多的了解。</p><p id="c6dc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你有兴趣了解更多关于熊猫的知识，这里有我的一些帖子的链接:<br/> ◼️️ <a class="ae mv" rel="noopener" target="_blank" href="/5-tips-for-pandas-users-e73681d16d17">给熊猫用户的 5 个建议</a> <br/> ◼️️ <a class="ae mv" rel="noopener" target="_blank" href="/transforming-variables-in-a-pandas-dataframe-bce2c6ef91a1">如何在熊猫数据框架中转换变量</a></p><p id="efff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">再见🏃💨</p></div></div>    
</body>
</html>