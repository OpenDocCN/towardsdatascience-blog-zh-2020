# 板球全能评分是如何计算的

> 原文：<https://towardsdatascience.com/how-all-rounder-ratings-are-calculated-in-cricket-38176e06ce30?source=collection_archive---------34----------------------->

## 本.斯托克斯的崛起。

如果你去年一直在关注板球，你应该听说过本·斯托克斯。他为英格兰赢得了一场比赛的胜利，并有着一生的复出故事。

![](img/5e38f99e642d9ef5d11fb8f5b97cacf6.png)

纳帕兹/CC BY-SA([https://creativecommons.org/licenses/by-sa/2.0](https://creativecommons.org/licenses/by-sa/2.0))

现在，他在统计上是[世界上最好的测试多面手](https://www.icc-cricket.com/media-releases/1734469)，最近超过了西印度群岛的队长杰森·霍尔德。

我想更好地理解这个标题的含义。

今天，我将使用 web 抓取和 python 中的基本机器学习来揭示全能选手在板球测试中如何评级的一些发现。虽然我的许多结论已经在排名概述中列出，但我使用的设置和方法可以应用于更复杂的问题。

## 背景

这篇文章不是用来教板球的。虽然我将提供一个测试板球的基本概述，但如果你想了解更多，我建议查看[这些视频](https://www.icc-cricket.com/video/what-is-cricket)。

![](img/5b808bc92df027570e99b0242748a17f.png)

照片由 [Chirayu Trivedi](https://unsplash.com/@rc820?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

在板球测试赛中，每个队都可以参加击球和保龄球比赛。击球手试图得分“跑”，投球手试图限制这些跑。要赢得比赛，一个队必须比对手得分更多。

典型的情况是，球队有一些“专业投球手”和一些“专业击球手”。专业球员有一个主要职责——击球*或*保龄球。

也有像本·斯托克斯这样的全才。这些球员在击球*和保龄球*方面足够优秀，可以被选去做这两项运动。

国际板球理事会(ICC)计算球员击球或保龄球评分的方式有些不透明。有许多[考虑因素](https://en.wikipedia.org/wiki/Sports_rating_system#Rating_considerations)融入到一个球员的击球或保龄球评分在一场比赛后如何变化，包括另一队球员的质量，同一队其他球员的表现，以及该球员的球队是否获胜。

击球和保龄球评分完全可以从比赛统计数据中得出——没有裁判小组来决定玩家的评分如何变化。

同样，全能评级应该完全来自击球和保龄球评级。为了找到击球、保龄球和全能评分之间的确切关系，我查阅了数据。

## 抓取数据

我开始收集由国际刑事法院维护的板球运动员测试等级。我用的 Python 抓取库叫 BeautifulSoup。我选择它是因为它可以处理定制的刮擦解决方案，而不需要我使用特定的后处理解决方案。BeautifulSoup 也只处理 HTML 字符串作为输入，所以我必须先使用类似`requests`的工具来检索有问题的 URL。下面显示了一个示例:

设置刮削

在我看到显示击球、保龄球或刮痧排名的 HTML 代码后，我知道刮痧是可行的。在[击球排名](https://www.icc-cricket.com/rankings/mens/player-rankings/test/batting)中，我们可以看到表格的每一行都对应于一个`<tr class="table-body">`标签，标签中包含了一个球员的名字、排名和等级。所有的排名(击球、保龄球和全能)恰好遵循这种格式。

ICC 击球等级的等级表中的示例行

如图所示，一个示例行包含几个`<td>`标签，它们本身存储了我们正在寻找的信息。我注意到了两种类型的`<td>`标签:一种在最外层标签层包含相关文本，如`<td class="table-body__cell table-body__cell--position u-text-right">`，另一种在最内层嵌套标签中包含相关文本，如`<td class="table-body__cell rankings-table__name name">`。为了避免代码重复，我创建了两个函数来处理这些常见的场景:

这两个函数都使用 BeautifulSoup 的`find`函数，该函数查找并返回具有指定“tag_name”和属性的第一个标签。这些函数在去除任何空白后返回找到的标记的文本。

`get_outer_data_from_tag`在其`find`函数中有附加参数“递归=假”和“文本=真”。这些参数确保我们只在最外面的标签中寻找文本，而不是在任何嵌套标签中寻找标签*或*文本。

## 存储数据

最终，我们需要一种易于操作的数据格式。我决定使用 Pandas DataFrames，因为它们不仅容易显示数据，而且允许快速直观的数据转换。

构建数据框架包括调用我前面讨论过的解析函数。对于排名表中的每一行，我们创建了一个包含玩家姓名、排名和等级的字典。我们将这个字典附加到一个字典列表中，在遍历每一行之后，我们从这个列表中创建了一个数据帧。

排名数据框架的简化创建

作为一个例子，生产的熊猫击球数据帧如下所示。

![](img/aba9c3031261f4c539ad8f60b478085a.png)

击球台

我为保龄球和全能排名构建了类似的表，并使用 Pandas `merge`函数合并了所有的表。结果是一个包含我们所有数据的完整表格:

![](img/abeac877c3ea77c1b23c27bcdaa576dd.png)

满桌击球、保龄球和全能评分

## 调查的结果

一旦我有了合适形式的数据，我需要找到产生全面评级的等式。

为此，我们定义了一个新的“X”矩阵，其中包含来自完整数据框架的击球和保龄球评级列。我们的“Y”矩阵包含相应的全能评定栏。

现在，我们需要找到一个将 X 映射到 y 的方程。在最简单的线性回归中，这涉及到为 X 矩阵中的每个变量找到一个系数。对于我们的问题，这意味着找到一个击球等级系数和一个保龄球等级系数。这类似于变量的线性组合:

*a *(击球等级)+ b *(保龄球等级)=全能等级*

给出更好结果的方法包括假设方程的形式是部分二次的:

*a *(击球等级)+ b *(保龄球等级)+ c *(击球等级)*(保龄球等级)+ d =全能选手等级*

这意味着我们的方程的次数是二，但我们只考虑一次变量以外的相互作用项。

构建 X 和 Y 矩阵

`fit_transform`函数将我们定义的简单的 2 列“X”矩阵转换为 4 列:一列用于常数项，一列用于击球评级，一列用于保龄球评级，一列用于击球评级和保龄球评级的乘积(“交互项”)。

然后，我们可以对新的 4 列“X”矩阵和之前定义的“Y”矩阵进行线性回归。

如果我们检查我们的模型的系数，我们将得到 4 个值的数组。虽然我们没有足够的数据来得到一个完全无噪声的公式，但是我们看到除了*(击球等级)*(保龄球等级)*项之外的所有项随着我们产生的系数几乎为零。相互作用项的系数最终大约为 1/1000，这与其他地方讨论的公式相匹配，有助于将我们模型的误差保持在非常低的水平。

## 结论

全能评分的计算是独一无二的，因为它传达了什么。我们不能简单地平均一个球员的击球和保龄球评分来找到他们的全能评分，因为这样一个纯粹的击球手或保龄球手会有很高的全能评分，即使那个球员不具备全能的技能。

相反，通过乘以击球和保龄球评分，然后除以 1000，我们避免了将一流的专业球员提升到全能排名的顶端。从这个意义上说，全能评级很好地反映了一名球员在击球*和*投球*方面的表现。*

然而，全能评级有所欠缺，因为它没有评估真正的“全能”能力。例如，它不包括守门或防守技能，这些是板球比赛的重要方面。通常给出的原因是没有好的方法来衡量这些能力。我怀疑随着板球变得越来越受统计数据驱动，这种情况将会改变。

如果你有兴趣看或运行代码，你可以在这里找到它[。我所介绍的方法可以用于为不同的目的收集 cricket 数据，或者分析评级系统的不同方面。我很好奇是什么让你受益！](https://github.com/neerajcshah/all_rounders/blob/master/AllRounders.ipynb)