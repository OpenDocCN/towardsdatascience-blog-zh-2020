# ç”¨æœºå™¨å­¦ä¹ æ¢æµ‹ç³»å¤–è¡Œæ˜Ÿçš„å¯å±…ä½æ€§

> åŸæ–‡ï¼š<https://towardsdatascience.com/detecting-habitability-of-exoplanets-with-machine-learning-b28c2d825760?source=collection_archive---------29----------------------->

> â€œå®‡å®™æ˜¯ä¸€ä¸ªç›¸å½“å¤§çš„åœ°æ–¹ã€‚å¦‚æœåªæœ‰æˆ‘ä»¬ï¼Œè¿™ä¼¼ä¹æ˜¯å¯¹ç©ºé—´çš„æå¤§æµªè´¹ã€‚â€å¡å°”Â·è¨ç”˜

![](img/83d77c28e1782ec2544b3424107e0004.png)

å±±å§†æ‹æ‘„çš„ç…§ç‰‡ğŸ· on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

æˆ‘ä»¬å¤§å¤šæ•°äººéƒ½æƒ³çŸ¥é“åœ¨æˆ‘ä»¬çš„æ˜Ÿçƒä¹‹å¤–æœ‰ç”Ÿå‘½å—ï¼Ÿå¯¹æˆ‘ä»¬çš„ç¥–å…ˆæ¥è¯´ï¼Œæˆ‘ä»¬ä¼¼ä¹é¦–å…ˆæ˜¯å­¤ç‹¬çš„ï¼Œä½†å½“æˆ‘ä»¬æ£€æŸ¥æ˜Ÿæ˜Ÿæ—¶ï¼Œæˆ‘ä»¬æ„è¯†åˆ°è¿™æ˜¯ä¸€ä¸ªç›¸å½“å¤§çš„å®‡å®™ã€‚ç„¶åæˆ‘ä»¬å¼€å§‹é—®åœ°å¤–æ–‡æ˜æ˜¯å¦å­˜åœ¨ï¼Œå®ƒä»¬åœ¨å“ªé‡Œï¼Ÿæˆ‘ä»¬æŠŠè¿™ä¸ªé—®é¢˜ç§°ä¸ºè´¹ç±³æ‚–è®ºã€‚å®ƒé™ˆè¿°äº†ç¼ºä¹åœ°å¤–æ–‡æ˜è¯æ®å’Œå¯¹å…¶æ¦‚ç‡çš„å„ç§é«˜ä¼°è®¡ä¹‹é—´çš„çŸ›ç›¾ã€‚

ä½†æ˜¯ï¼Œæ­£å¦‚å¡å°”Â·è¨æ ¹æ‰€è¯´:â€œç¼ºä¹è¯æ®å¹¶ä¸æ˜¯ä¸å­˜åœ¨çš„è¯æ®ã€‚â€æ‰€ä»¥æˆ‘ä»¬æ­£åœ¨å¯»æ‰¾å¤–æ˜Ÿäººåœ¨å“ªé‡Œï¼Œæˆ–è€…ä»–ä»¬æ˜¯å¦å­˜åœ¨çš„é—®é¢˜ã€‚
ç³»å¤–è¡Œæ˜Ÿç ”ç©¶çš„ä¸»è¦å·¥ä½œé¢†åŸŸä¹‹ä¸€å°±æ˜¯æ‰¾åˆ°è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆã€‚åœ¨ä¸åŒçš„æ’æ˜Ÿç³»ç»Ÿä¸­å¯»æ‰¾å¯èƒ½é€‚åˆå±…ä½çš„è¡Œæ˜Ÿæ˜¯ç³»å¤–è¡Œæ˜Ÿç ”ç©¶çš„ä¸»è¦ç›®æ ‡ä¹‹ä¸€ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å‘ç°äº† 60 é¢—å¯å±…ä½çš„ç³»å¤–è¡Œæ˜Ÿï¼Œæˆ‘ä»¬å°†ç»§ç»­å¯»æ‰¾æ›´å¤šçš„ç³»å¤–è¡Œæ˜Ÿã€‚

![](img/ed858a7b4161587cdb5ed75a75f27799.png)

ç…§ç‰‡ç”± [Alazar Kassahun](https://unsplash.com/@mr_bcubed5?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

æ‰€ä»¥ï¼Œæˆ‘å†³å®šå¼€å‘ä¸€ä¸ªæœºå™¨å­¦ä¹ é¡¹ç›®æ¥é¢„æµ‹è¿™äº›å¯å±…ä½çš„è¡Œæ˜Ÿã€‚é€šè¿‡è¿›å…¥è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘æå–äº†ä¸¤ä¸ªæ•°æ®é›†:ç¾å›½å®‡èˆªå±€ç³»å¤–è¡Œæ˜Ÿæ¡£æ¡ˆå’Œ PHL çš„å¯å±…ä½ç³»å¤–è¡Œæ˜Ÿç›®å½•ã€‚

# æ•°æ®çŸ¥è¯†

å› æ­¤ï¼Œæœ‰ä¸¤ä¸ªæ•°æ®é›†éœ€è¦å¤„ç†: [Nasa](https://exoplanetarchive.ipac.caltech.edu/cgi-bin/TblView/nph-tblView?app=ExoTbls&config=planets) ç³»å¤–è¡Œæ˜Ÿæ¡£æ¡ˆå’Œ [PL æ•°æ®](http://phl.upr.edu/projects/habitable-exoplanets-catalog/data/database)ï¼Œå…¶ä¸­åŒ…å«å¯å±…ä½æ€§æƒ…å†µã€‚æˆ‘ä»ç¾å›½å®‡èˆªå±€è·å¾—çš„æ•°æ®é›†æ˜¯æˆ‘çš„ä¸­å¿ƒæ•°æ®é›†ï¼Œå› ä¸ºå®ƒæœ‰æ›´å¤šçš„æ’æ˜Ÿå’Œè¡Œæ˜Ÿçš„ç‰¹å¾ï¼Œä¾‹å¦‚ï¼›è¡Œæ˜ŸåŠå¾„ã€æ’æ˜Ÿæ¸©åº¦ã€è½¨é“å‘¨æœŸç­‰ç­‰ã€‚æˆ‘éœ€è¦ PHL çš„æ•°æ®æ¥ä½¿ç”¨å¯å±…ä½æ€§åŠŸèƒ½ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†ç›®æ ‡ç‰¹å¾çš„åˆ†å¸ƒï¼Œè¿™æ„å‘³ç€å¯å±…ä½æ€§ã€‚å¦‚æ‚¨æ‰€è§ï¼Œæˆ‘æœ‰ä¸€ä¸ªä¸å¹³è¡¡çš„æ•°æ®é›†ï¼Œæˆ‘å°†åœ¨ä¸‹é¢çš„éƒ¨åˆ†ä¸­å¤„ç†å®ƒã€‚

![](img/b24e5eb070301e30457c83693d2cf1fd.png)

ç›®æ ‡ç‰¹å¾çš„åˆ†å¸ƒã€‚ä½œè€…å›¾ç‰‡

# æ–¹æ³•å­¦

æœ¬é¡¹ç›®éµå¾ªçš„æ–¹æ³•æ˜¯:

1.  é¢„å¤„ç†å’Œæ•°æ®åˆå¹¶
2.  å¤„ç†ç¼ºå¤±æ•°æ®
3.  æ¢ç´¢æ€§æ•°æ®åˆ†æ
4.  æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ•°æ®å‡†å¤‡
5.  å®šä¹‰æ¨¡å‹
6.  è¯„ä¼°å’Œä¼˜åŒ–

å¤©æ–‡æ•°æ®é›†é€šå¸¸ä¼šæœ‰å¾ˆå¤šç¼ºå¤±å€¼ï¼Œæˆ‘çš„æƒ…å†µä¹Ÿæ˜¯å¦‚æ­¤ã€‚å› æ­¤ï¼Œæˆ‘ä»æ¸…é™¤è¿™äº›ä¸¢å¤±çš„å€¼å¼€å§‹ã€‚

![](img/c73cf1b741a13d7ba47bc3cb384e2689.png)

ä½œè€…å›¾ç‰‡

è¿™å¼ å›¾ç‰‡æ˜¾ç¤ºäº†æˆ‘ä¸¢å¤±äº†å¤šå°‘ä»·å€¼ã€‚å¾ˆæ˜æ˜¾ï¼Œæ˜¯å¾ˆå¤šã€‚æ‰€ä»¥ï¼Œæˆ‘æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ¥è§£å†³æˆ‘çš„é—®é¢˜:

*   æˆ‘åˆ é™¤äº†ä¸¢å¤±æ•°æ®è¶…è¿‡ 40%çš„åˆ—ã€‚

```
# remove columns with more than 40% missing data
def remove_missing(f):
    count = len(planets[planets[f].isnull()])
    if count/len(planets) > 0.4:
        return 1
    else:
        return 0

missing_values = [x for x in planets.columns if remove_missing(x)]
planets = planets.drop(missing_values, axis=1)
```

*   æˆ‘åˆ é™¤äº†å…·æœ‰åä¸ªä»¥ä¸Šå”¯ä¸€å€¼çš„åˆ†ç±»ç‰¹å¾ã€‚

```
# remove categorical features with more than 10 unique values
cols = [x for x in planets.columns if x not in planets._get_numeric_data().columns]
for i in cols:
    if(len(planets[i].unique()) > 10):
        planets = planets.drop(i, axis=1)
```

*   å¯¹å‰©ä½™åˆ†ç±»ç‰¹å¾çš„å¤„ç†ã€‚
*   æ•°å€¼çš„è¿­ä»£è®¡ç®—ã€‚

```
# IterativeImputer
# get only numeric values
numeric_values = planets[planets._get_numeric_data().columns]
imp = IterativeImputer(RandomForestRegressor(), max_iter=10, random_state=76)
numeric_values = pd.DataFrame(imp.fit_transform(numeric_values), columns=numeric_values.columns)
numeric_values.to_csv('Imputed Data.csv', index='rowid')
```

åœ¨ä¸‹é¢çš„æ­¥éª¤ä¹‹åï¼Œæˆ‘å¾—åˆ°äº†ä¸€ä¸ªåŒ…å« 131 ä¸ªæ¡ç›®çš„å¹²å‡€æ•°æ®é›†ï¼Œå¹¶ç»§ç»­è¿›è¡Œåˆå¹¶è¿‡ç¨‹ã€‚

## åˆå¹¶æ•°æ®é›†

æ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œæˆ‘æœ‰ä¸¤ä¸ªé¡¹ç›®æ•°æ®é›†ï¼Œæ‰€ä»¥æˆ‘éœ€è¦å°†å®ƒä»¬ç»“åˆèµ·æ¥ï¼Œä»¥ä¾¿åœ¨æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­ä½¿ç”¨ã€‚é™¤äº†å¯å±…ä½æ€§ï¼Œæˆ‘çš„æ‰€æœ‰ç‰¹å¾éƒ½åœ¨ç¾å›½å®‡èˆªå±€çš„ç³»å¤–è¡Œæ˜Ÿæ¡£æ¡ˆä¸­ã€‚å› æ­¤ï¼Œæˆ‘æŠŠå®ƒä» PHL æ•°æ®é›†ä¸­æ‹¿äº†å‡ºæ¥ï¼Œæ”¾åœ¨ä¸­å¤®æ•°æ®é›†ä¸­ã€‚

```
#drop not-habitable planets
phl = phl[phl.P_HABITABLE != 0]#create habitable column for planets data with the help of phl #dataframe
#get names of planets
habitable_planets = phl.P_NAME.values
planets['habitable'] = planets['pl_name'].isin(habitable_planets
```

![](img/c6e05f4b27af9fe5b7228d80e4a27c3f.png)

è´¨é‡-æ¸©åº¦-å¯å±…ä½æ€§å…³ç³»ã€‚ä½œè€…å›¾ç‰‡

# èµ°å‘æœºå™¨å­¦ä¹ 

æˆ‘å®Œæˆäº†æ¸…ç†å’Œåˆå¹¶è¿‡ç¨‹ï¼Œä½†ä»æœ‰å·¥ä½œè¦åšã€‚æˆ‘åº”è¯¥åšä¸€äº›å‡†å¤‡æ­¥éª¤ï¼Œä¸ºæœºå™¨å­¦ä¹ æ¨¡å‹å‡†å¤‡æ•°æ®ã€‚æˆ‘ä»ç„¶æœ‰è¿™ä¹ˆå¤šçš„åŠŸèƒ½ï¼Œæˆ‘ä¸æƒ³ä»æ¨¡å‹ä¸­å¾—åˆ°è¿‡åº¦æ‹Ÿåˆçš„ç»“æœã€‚æ­¤å¤–ï¼Œæˆ‘å¿…é¡»è§£å†³ä¸å¹³è¡¡çš„é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ç¼–å†™äº†ä¸€äº›æ•°æ®å‡†å¤‡æ–¹æ³•:

*   ä¸¢å¼ƒä½ç›¸å…³æ€§è¦ç´ &ä¸ºæ¨¡å‹æ•°æ®é›†é€‰æ‹©é«˜ç›¸å…³æ€§è¦ç´ ã€‚
*   ç»è¿‡ä¸€äº›ç ”ç©¶ï¼Œæˆ‘å†³å®šå°†è¿™äº›ç‰¹å¾æ·»åŠ åˆ°æ¨¡å‹çš„æ•°æ®é›†ä¸­:è¡Œæ˜Ÿè´¨é‡ã€è¡Œæ˜Ÿå¾„å‘é€Ÿåº¦æŒ¯å¹…[m/s]ã€å¹³è¡¡æ¸©åº¦[K]ã€è¡Œæ˜ŸåŠå¾„[åœ°çƒåŠå¾„]å’Œè½¨é“å‘¨æœŸ[å¤©]ã€‚ä½†æ˜¯ï¼Œç”±äºç¼ºå¤±å€¼é—®é¢˜ï¼Œæˆ‘åªæœ‰è¡Œæ˜ŸåŠå¾„å’Œè½¨é“å‘¨æœŸã€‚
*   æ ‡å‡†åŒ–å’Œå¯¹æ•°å˜æ¢ã€‚
*   SMOTE â€”è¿‡é‡‡æ ·ã€‚

```
#Selecting highly correlated features
unrelevant_features = corr_df[corr_df['habitable'] <= 0.09]to_drop = [column for column in unrelevant_features.index]
planets_c.drop(planets_c[to_drop[:97]], axis=1, inplace=True)planets_c[['pl_rade', 'pl_orbper']] = planets[['pl_rade', 'pl_orbper']]# log transformation to decrease the effect of the outliers
log_cols = ['gaia_plx', 'st_pm', 'gaia_pm', 'st_teff', 'pl_rade', 'pl_orbper']
planets_c[log_cols] = (planets_c[log_cols]+1).transform(np.log)
norm_cols = ['st_pmdec', 'gaia_pmdec']
planets_c[norm_cols] = preprocessing.normalize(planets_c[norm_cols])
```

å—¯ï¼Œæˆ‘ç°åœ¨å¯ä»¥å¼€å§‹å®šä¹‰åˆ†ç±»æ¨¡å‹äº†ã€‚æˆ‘ä»æ¢ç´¢åŸºæœ¬æ¨¡å‹å¼€å§‹:KNNã€é€»è¾‘å›å½’ã€æœ´ç´ è´å¶æ–¯ã€çº¿æ€§ SVC å’Œå†³ç­–æ ‘ã€‚ç„¶åï¼Œé›†åˆæ¨¡å‹å°±åƒ:éšæœºæ£®æ—ã€AdaBoostã€GradientBoosting å’Œ XGBoostã€‚ç»“æœå¦‚ä¸‹:

![](img/700486b030894fd77548c161f1fd5f27.png)

å›¾ç‰‡ä½œè€…ã€‚

é¦–å…ˆï¼Œè¡Œæ˜ŸåŠå¾„å’Œè½¨é“å‘¨æœŸç‰¹å¾ä¸åœ¨æ¨¡å‹æ•°æ®é›†ä¸­ã€‚æ²¡æœ‰è¿™äº›åŠŸèƒ½ï¼Œæˆ‘å¾—åˆ°çš„æœ€å¥½çš„ F1 åˆ†æ•°åªæœ‰ 54%ï¼Œæ‰€ä»¥ä»–ä»¬å¯¹ç»“æœåšå‡ºäº†ç›¸å½“å¤§çš„è´¡çŒ®ã€‚ä»ç‰¹å¾é‡è¦åº¦è¡¨ä¹Ÿå¯ä»¥çœ‹å‡ºã€‚

![](img/3eee7bca21680960ca683d20f5f2cba6.png)

å›¾ç‰‡ä½œè€…ã€‚

çº¿æ€§ SVC æ˜¯å¬å›åˆ†æ•°æ–¹é¢ç¬¬äºŒæˆåŠŸçš„æ¨¡å‹ã€‚å› æ­¤ï¼Œæˆ‘æƒ³æ¯”è¾ƒä»–ä»¬çš„æ··æ·†çŸ©é˜µ:

![](img/25ee25fb152ff786b3250423b031fd9e.png)![](img/900f1d7b57176b51d480d3759e7f45fb.png)

ä½œè€…å›¾ç‰‡ã€‚

# æœ€åçš„æƒ³æ³•

*   åƒè¡Œæ˜ŸåŠå¾„ã€è½¨é“å¤©æ•°ã€æ’æ˜Ÿè¡¨é¢é‡åŠ›å’Œæ’æ˜Ÿè¡¨é¢æ¸©åº¦è¿™æ ·çš„ç‰¹å¾å¯¹æ¨¡å‹æœ‰é‡å¤§å½±å“ã€‚
*   æœºå™¨å­¦ä¹ ç®—æ³•åœ¨å¯»æ‰¾å¯èƒ½çš„å®œå±…è¡Œæ˜Ÿæ–¹é¢åšå¾—å¾ˆå¥½ï¼Œå³ä½¿æ²¡æœ‰åŒ–å­¦æ€§è´¨ã€‚
*   XGBoost åœ¨ä»»åŠ¡ä¸ŠçœŸçš„å¾ˆæˆåŠŸã€‚è¿™ä¸ªæ¨¡å‹é¢„æµ‹äº†æ‰€æœ‰çš„ç³»å¤–è¡Œæ˜Ÿï¼Œé™¤äº†ä¸€ä¸ªã€‚
*   ä½œä¸ºè¿›ä¸€æ­¥çš„å·¥ä½œï¼Œæˆ‘çš„ç›®æ ‡æ˜¯é€šè¿‡åœ¨å­¦æœ¯è®ºæ–‡ä¸Šçš„ NLP å·¥ä½œæ‰¾åˆ°å¯å±…ä½æ€§çš„ç›¸å…³ç‰¹å¾ã€‚æˆ‘è¿˜æ‰“ç®—å¼€å‘ä¸€ä¸ª flask åº”ç”¨ç¨‹åºã€‚

> â€œä»¥éå¸¸ä¸åŒçš„æ–¹å¼ï¼Œå®‡å®™å……æ»¡ç”Ÿå‘½çš„å¯èƒ½æ€§å’Œæˆ‘ä»¬å®Œå…¨å­¤ç‹¬çš„ç›¸åå¯èƒ½æ€§åŒæ ·ä»¤äººå…´å¥‹ã€‚ä¸ç®¡æ€æ ·ï¼Œå¯¹æˆ‘æ¥è¯´ï¼Œæƒ³æ›´å¤šåœ°äº†è§£å®‡å®™çš„æ¬²æœ›æ˜¯ä¸å¯æŠ—æ‹’çš„ï¼Œæˆ‘æ— æ³•æƒ³è±¡ä»»ä½•çœŸæ­£å¯Œæœ‰è¯—æ„çš„äººä¼šä¸åŒæ„ã€‚â€ç†æŸ¥å¾·Â·é“é‡‘æ–¯

æ­¤å¤–ï¼Œå¦‚æœä½ æƒ³äº†è§£æ›´å¤šï¼Œä¹Ÿå¯ä»¥çœ‹çœ‹æˆ‘çš„ [Github](https://github.com/alpercakr/Planet-Hunting-and-Habitability-Detection-with-Machine-Learning) ç®€ä»‹ï¼