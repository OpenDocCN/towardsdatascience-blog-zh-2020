<html>
<head>
<title>Visualizing Decision Trees with Python (Scikit-learn, Graphviz, Matplotlib)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python可视化决策树(Scikit-learn，Graphviz，Matplotlib)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc?source=collection_archive---------0-----------------------#2020-04-02">https://towardsdatascience.com/visualizing-decision-trees-with-python-scikit-learn-graphviz-matplotlib-1c50b4aa68dc?source=collection_archive---------0-----------------------#2020-04-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9944" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何使用matplotlib和Graphviz可视化决策树</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5bda52415c2d3ce64a8cb7bb2c247871.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_DXeoBPTDu6fP_EMzTbnnA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自我的<a class="ae ky" rel="noopener" target="_blank" href="/understanding-decision-trees-for-classification-python-9663d683c952">理解分类决策树(Python)教程</a>。</p></figure><p id="6e54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于各种原因，决策树是一种流行的监督学习方法。决策树的好处包括它们可以用于回归和分类，它们不需要特征缩放，并且它们相对容易解释，因为你可以可视化决策树。这不仅是理解您的模型的一种强有力的方式，而且也是传达您的模型如何工作的一种强有力的方式。因此，了解如何基于您的模型进行可视化会有所帮助。</p><p id="1caf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程涵盖:</p><ul class=""><li id="00ad" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">如何使用Scikit-Learn拟合决策树模型</li><li id="5020" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如何使用Matplotlib可视化决策树</li><li id="7bb7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如何使用Graphviz可视化决策树(Graphviz是什么，如何在Mac和Windows上安装，如何使用它可视化决策树)</li><li id="45e8" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如何可视化袋装树或随机森林中的单个决策树</li></ul><p id="0431" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">和往常一样，本教程中使用的代码可以在我的<a class="ae ky" href="https://github.com/mGalarnyk/Python_Tutorials/blob/master/Sklearn/CART/Visualization/DecisionTreesVisualization.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。就这样，让我们开始吧！</p><h1 id="4b3d" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">如何使用Scikit-Learn拟合决策树模型</h1><p id="7860" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">为了可视化决策树，我们首先需要使用scikit-learn来拟合决策树模型。如果这一节不清楚，我鼓励你阅读我的<a class="ae ky" rel="noopener" target="_blank" href="/understanding-decision-trees-for-classification-python-9663d683c952">理解分类决策树(Python)教程</a>，因为我会详细介绍决策树如何工作以及如何使用它们。</p><h2 id="f0b9" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">导入库</h2><p id="1a1c" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">我们将在本教程的这一部分使用以下导入语句。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="878c" class="ng mk it nt b gy nx ny l nz oa">import matplotlib.pyplot as plt<br/>from sklearn.datasets import load_iris<br/>from sklearn.datasets import load_breast_cancer<br/>from sklearn.tree import DecisionTreeClassifier<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.model_selection import train_test_split<br/>import pandas as pd<br/>import numpy as np<br/>from sklearn import tree</span></pre><h2 id="87be" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">加载数据集</h2><p id="4e22" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">Iris数据集是scikit-learn附带的数据集之一，不需要从外部网站下载任何文件。下面的代码加载iris数据集。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="1952" class="ng mk it nt b gy nx ny l nz oa">import pandas as pd<br/>from sklearn.datasets import load_iris<br/>data = load_iris()<br/>df = pd.DataFrame(data.data, columns=data.feature_names)<br/>df['target'] = data.target</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/ba51d9cf310dde90802f03a0081b0a05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Njp0wEKt3_fIk-d2.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">原创熊猫df(特色+目标)</p></figure><h2 id="2551" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">将数据分为训练集和测试集</h2><p id="3709" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">下面的代码执行<a class="ae ky" rel="noopener" target="_blank" href="/understanding-train-test-split-scikit-learn-python-ea676d5e3d1">训练测试分割</a>，将75%的数据放入训练集，25%的数据放入测试集。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="87b0" class="ng mk it nt b gy nx ny l nz oa">X_train, X_test, Y_train, Y_test = train_test_split(df[data.feature_names], df['target'], random_state=0)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/115fd5827fa1c07e896d1d7c745d8430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5U_RHRvp7pDlHOSG.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图像中的颜色表示数据帧df中的数据用于特定训练测试分割的哪个变量(X_train，X_test，Y_train，Y_test)。迈克尔·加拉尼克的图片。</p></figure><h2 id="36e4" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">sci kit-学习4步建模模式</h2><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="17be" class="ng mk it nt b gy nx ny l nz oa"># <strong class="nt iu">Step 1:</strong> Import the model you want to use<br/># This was already imported earlier in the notebook so commenting out<br/>#from sklearn.tree import DecisionTreeClassifier</span><span id="e5ae" class="ng mk it nt b gy od ny l nz oa"><strong class="nt iu"># Step 2:</strong> Make an instance of the Model<br/>clf = DecisionTreeClassifier(max_depth = 2, <br/>                             random_state = 0)</span><span id="06df" class="ng mk it nt b gy od ny l nz oa"><strong class="nt iu"># Step 3:</strong> Train the model on the data<br/>clf.fit(X_train, Y_train)</span><span id="f800" class="ng mk it nt b gy od ny l nz oa"><strong class="nt iu"># Step 4:</strong> Predict labels of unseen (test) data<br/># Not doing this step in the tutorial<br/># clf.predict(X_test)</span></pre><h1 id="3d8f" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">如何使用Matplotlib可视化决策树</h1><p id="38b9" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">自scikit-learn版本21.0(大约2019年5月)起，现在可以使用scikit-learn的<code class="fe oe of og nt b"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.plot_tree.html#sklearn.tree.plot_tree" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">tree.plot_tree</strong></a></code>用matplotlib绘制决策树，而不依赖于<code class="fe oe of og nt b">dot</code>库，后者是一个难以安装的依赖项，我们将在稍后的博客文章中介绍。</p><p id="8130" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的代码使用scikit-learn绘制了一个决策树。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="5ce3" class="ng mk it nt b gy nx ny l nz oa">tree.plot_tree(clf);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/2b54fef818686d69b2731789cbc7849c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vSfCtg71cwuSGDpGJU6STg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这还不是最容易解释的树。</p></figure><p id="e2e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了添加允许您保存图像的代码之外，下面的代码试图通过添加特性和类名(以及设置<code class="fe oe of og nt b">filled = True</code>)来使决策树更容易理解。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="9f86" class="ng mk it nt b gy nx ny l nz oa">fn=['sepal length (cm)','sepal width (cm)','petal length (cm)','petal width (cm)']<br/>cn=['setosa', 'versicolor', 'virginica']</span><span id="7fa2" class="ng mk it nt b gy od ny l nz oa">fig, axes = plt.subplots(nrows = 1,ncols = 1,figsize = (4,4), dpi=300)</span><span id="353d" class="ng mk it nt b gy od ny l nz oa">tree.plot_tree(clf,<br/>               feature_names = fn, <br/>               class_names=cn,<br/>               filled = True);</span><span id="d542" class="ng mk it nt b gy od ny l nz oa">fig.savefig('imagename.png')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/4e2c60784546e24be49a90f9d537887b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Y9eZ3TviU6m34R7z6e_Dw.png"/></div></div></figure><h1 id="b54d" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">如何使用Graphviz可视化决策树</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/d699de44c6a65a20af41afe0f87e1090.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mYzkiAj8jphr_-TPE4n2Aw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">通过Graphviz生成的决策树。请注意，我使用文本编辑器编辑了文件，使文本颜色与叶/终端节点或决策节点相对应。</p></figure><p id="32b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oe of og nt b">Graphviz</code>是开源的图形可视化软件。图形可视化是一种将结构信息表示为抽象图形和网络的方式。在数据科学中，<code class="fe oe of og nt b">Graphviz</code>的一个用途是可视化决策树。我应该注意的是，在介绍完Matplotlib之后，我之所以要回顾Graphviz，是因为让它工作起来可能很困难。这个过程的第一部分包括创建一个点文件。点文件是决策树的Graphviz表示。问题是使用Graphviz将点文件转换成图像文件(png、jpg等)可能很困难。有几种方法可以做到这一点，包括:通过Anaconda安装<code class="fe oe of og nt b">python-graphviz</code>，通过Homebrew (Mac)安装Graphviz，从官方网站(Windows)安装Graphviz可执行文件，以及使用在线转换器将您的点文件内容转换成图像。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/8c883cc6b12634bc6a58b9a17240d4b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xn_DATiT0S8RhfkmckGnRA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">创建点文件通常不是问题。将点文件转换成png文件可能很困难。</p></figure><h2 id="e057" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">将模型导出到点文件</h2><p id="25d4" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">代码下面的代码将在任何操作系统上工作，因为python生成了点文件并将其导出为名为<code class="fe oe of og nt b">tree.dot</code>的文件。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="7e2a" class="ng mk it nt b gy nx ny l nz oa">tree.export_graphviz(clf,<br/>                     out_file="tree.dot",<br/>                     feature_names = fn, <br/>                     class_names=cn,<br/>                     filled = True)</span></pre><h2 id="b1d2" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">安装和使用Graphviz</h2><p id="df7d" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">将点文件转换成图像文件(png、jpg等)通常需要安装Graphviz，这取决于您的操作系统和许多其他东西。本节的目标是帮助人们尝试并解决出现以下错误的常见问题。<code class="fe oe of og nt b">dot: command not found</code>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/f8001fd40f176fd48fb196acc7cd2bef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S3gpk1vvwDNkUNyebse8Ag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><code class="fe oe of og nt b">dot: command not found</code></p></figure><p id="0771" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">如何通过Anaconda在Mac上安装使用</strong></p><p id="c0cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了能够通过这种方法在你的Mac上安装Graphviz，你首先需要安装Anaconda(如果你没有安装Anaconda，你可以在这里<a class="ae ky" href="https://www.datacamp.com/community/tutorials/installing-anaconda-mac-os-x" rel="noopener ugc nofollow" target="_blank">学习如何安装它</a>)。</p><p id="f71a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开一个终端。你可以点击屏幕右上角的聚光灯放大镜，输入终端，然后点击终端图标。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/366f560fc0e7e62dc9e0901bd726636f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*IExSuRmOegVpv9g3DiqCdA.gif"/></div></div></figure><p id="f984" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">键入下面的命令来安装Graphviz。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="8ff8" class="ng mk it nt b gy nx ny l nz oa">conda install python-graphviz</span></pre><p id="ac5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，你应该可以使用下面的<code class="fe oe of og nt b">dot</code>命令将点文件转换成png文件。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="ffc7" class="ng mk it nt b gy nx ny l nz oa">dot -Tpng tree.dot -o tree.png</span></pre><p id="7f78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">如何通过家酿在Mac上安装使用</strong></p><p id="0b40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你没有Anaconda或者只是想要另一种在Mac上安装Graphviz的方式，你可以使用<a class="ae ky" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank">自制软件</a>。我以前写过一篇关于如何安装家酿软件并使用它将点文件转换成图像文件的文章<a class="ae ky" href="https://medium.com/@GalarnykMichael/how-to-install-and-use-homebrew-80eeb55f73e9" rel="noopener">这里</a>(参见教程的家酿软件帮助可视化决策树部分)。</p><p id="54bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">如何通过Anaconda在Windows上安装使用</strong></p><p id="f732" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我在Windows上更喜欢的方法。为了能够通过这种方法在您的Windows上安装Graphviz，您首先需要安装Anaconda(如果您没有安装Anaconda，您可以在这里<a class="ae ky" href="https://medium.com/@GalarnykMichael/install-python-anaconda-on-windows-2020-f8e188f9a63d" rel="noopener">了解如何安装它</a>)。</p><p id="0d89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">打开终端/命令提示符，输入下面的命令来安装Graphviz。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="b0ed" class="ng mk it nt b gy nx ny l nz oa">conda install python-graphviz</span></pre><p id="bf2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，您应该能够使用下面的<code class="fe oe of og nt b">dot</code>命令将点文件转换成png文件。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="4c86" class="ng mk it nt b gy nx ny l nz oa">dot -Tpng tree.dot -o tree.png</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/a37e2c6c859b1bac2bb4dc61462a1776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_cumfMOQeMcGMLpJLoBJUA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">通过conda安装Graphviz。这应该可以解决“点”不被识别为内部或外部命令、可操作程序或批处理文件的问题。</p></figure><p id="a3c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">如何通过Graphviz可执行文件在Windows上安装和使用</strong></p><p id="b8bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你没有Anaconda或者只是想要在你的Windows上安装Graphviz的另一种方式，你可以使用下面的链接<a class="ae ky" href="https://graphviz.gitlab.io/_pages/Download/Download_windows.html" rel="noopener ugc nofollow" target="_blank">下载并安装它</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/d6e18a52bbb58950626d3dda2b777d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2CwSpP-OD4PJ2Vj9WO9zPg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">如果您不熟悉改变PATH变量，而想在命令行上使用dot，我鼓励您使用其他方法。<a class="ae ky" href="https://datascience.stackexchange.com/questions/37428/graphviz-not-working-when-imported-inside-pydotplus-graphvizs-executables-not" rel="noopener ugc nofollow" target="_blank">有许多Stackoverflow问题是基于这个特殊的问题</a>。</p></figure><h2 id="b547" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">如何使用在线转换器来可视化你的决策树</h2><p id="70da" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">如果其他方法都失败了，或者你只是不想安装任何东西，你可以使用在线转换器。</p><p id="0014" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下图中，我用Sublime Text打开了文件(尽管有许多不同的程序可以打开/读取点文件)，并复制了文件的内容。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/0d3ca01f21f98906d32ba14431465454.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Ag6p-67u1d2FuANM3XAeg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">复制点文件的内容</p></figure><p id="e652" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下图中，我将点文件中的内容粘贴到在线转换器的左侧。然后，您可以选择想要的格式，然后将图像保存在屏幕右侧。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/b1bc74eb36a0413ffa90aa29eabd053b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WqfF2vdas6g-57aDKS_FyA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将可视化保存到计算机</p></figure><p id="ef7d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请记住，有<a class="ae ky" href="http://www.webgraphviz.com/" rel="noopener ugc nofollow" target="_blank">其他在线转换器</a>可以帮助完成同样的任务。</p><h1 id="0dad" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">如何可视化袋装树或随机森林中的单个决策树</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">关于袋装树木的免费预览<a class="ae ky" href="https://youtu.be/urb2wRxnGz4" rel="noopener ugc nofollow" target="_blank">视频</a>，来自<a class="ae ky" href="https://www.linkedin.com/learning/machine-learning-with-scikit-learn/effective-machine-learning-with-scikit-learn" rel="noopener ugc nofollow" target="_blank">机器学习与Scikit-Learn课程</a></p></figure><p id="5cae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">决策树的一个弱点是它们往往没有最好的预测准确性。这部分是因为高方差，这意味着训练数据中的不同分裂可以导致非常不同的树。上面的<a class="ae ky" href="https://youtu.be/urb2wRxnGz4" rel="noopener ugc nofollow" target="_blank">视频</a>涵盖了袋装树，这是一个集合模型。这意味着使用多个学习算法来获得比单独从任何组成学习算法获得的预测性能更好的预测性能。在这种情况下，许多树相互保护，避免各自的错误。有趣的是，上面视频中的缩略图可能是袋装树或随机森林的示意图(另一个集合模型)。袋装树和随机森林模型如何工作的区别是另一个博客的主题，但是值得注意的是，对于这两个模型，我们都生长了N棵树，其中N是用户指定的决策树的数量。因此，在你拟合一个模型之后，看看组成你的模型的各个决策树会很好。</p><h2 id="2126" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">使用Scikit-Learn拟合随机森林模型</h2><p id="1181" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">为了可视化单个决策树，我们首先需要使用scikit-learn拟合一个袋装树或随机森林模型(下面的代码适合一个随机森林模型)。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="a52e" class="ng mk it nt b gy nx ny l nz oa"># Load the Breast Cancer (Diagnostic) Dataset<br/>data = load_breast_cancer()<br/>df = pd.DataFrame(data.data, columns=data.feature_names)<br/>df['target'] = data.target</span><span id="b7bf" class="ng mk it nt b gy od ny l nz oa"># Arrange Data into Features Matrix and Target Vector<br/>X = df.loc[:, df.columns != 'target']<br/>y = df.loc[:, 'target'].values</span><span id="7e75" class="ng mk it nt b gy od ny l nz oa"># Split the data into training and testing sets<br/>X_train, X_test, Y_train, Y_test = train_test_split(X, y, random_state=0)</span><span id="dd1a" class="ng mk it nt b gy od ny l nz oa"># Random Forests in `scikit-learn` (with N = 100)<br/>rf = RandomForestClassifier(n_estimators=100,<br/>                            random_state=0)<br/>rf.fit(X_train, Y_train)</span></pre><h2 id="2ebd" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">可视化您的评估人员</h2><p id="9a34" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">现在，您可以从拟合的模型中查看所有单独的树。在本节中，我将使用matplotlib可视化所有决策树。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="5458" class="ng mk it nt b gy nx ny l nz oa">rf.estimators_</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/ba88305c88640b285cd29e19ea1242d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3AkPeEx-ayxyw6ARV2kziA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在这个例子中，注意我们有100个评估者。</p></figure><p id="27dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您可以将单棵树可视化。下面的代码可视化了第一个决策树。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="a7db" class="ng mk it nt b gy nx ny l nz oa">fn=data.feature_names<br/>cn=data.target_names<br/>fig, axes = plt.subplots(nrows = 1,ncols = 1,figsize = (4,4), dpi=800)<br/>tree.plot_tree(rf.estimators_[0],<br/>               feature_names = fn, <br/>               class_names=cn,<br/>               filled = True);<br/>fig.savefig('rf_individualtree.png')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/b58835be4d08632b1c65629f444fc2a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tPLDGP7fkr_-Iltk_kVTDw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">请注意，随机森林和袋装树木中的单个树木正在长得更深</p></figure><p id="49ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以尝试使用matplotlib子图来可视化尽可能多的树。下面的代码可视化了前5个决策树。我个人不喜欢这种方法，因为它更难阅读。</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="bab5" class="ng mk it nt b gy nx ny l nz oa"># This may not the best way to view each estimator as it is small</span><span id="1db1" class="ng mk it nt b gy od ny l nz oa">fn=data.feature_names<br/>cn=data.target_names<br/>fig, axes = plt.subplots(nrows = 1,ncols = 5,figsize = (10,2), dpi=3000)</span><span id="00c3" class="ng mk it nt b gy od ny l nz oa">for index in range(0, 5):<br/>    tree.plot_tree(rf.estimators_[index],<br/>                   feature_names = fn, <br/>                   class_names=cn,<br/>                   filled = True,<br/>                   ax = axes[index]);<br/>    <br/>    axes[index].set_title('Estimator: ' + str(index), fontsize = 11)</span><span id="2249" class="ng mk it nt b gy od ny l nz oa">fig.savefig('rf_5trees.png')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/ef93e2405774ed6f0b885f30be076819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dCNWrDFkjVpIqMQhZynGoA.png"/></div></div></figure><h2 id="993b" class="ng mk it bd ml nh ni dn mp nj nk dp mt li nl nm mv lm nn no mx lq np nq mz nr bi translated">为每个决策树(评估者)创建图像</h2><p id="3dc4" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">请记住，如果出于某种原因，您需要所有评估者(决策树)的图像，您可以使用my <a class="ae ky" href="https://github.com/mGalarnyk/Python_Tutorials/blob/master/Sklearn/CART/Visualization/DecisionTreesVisualization.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上的代码来实现。如果你只是想看看随机森林模型的100个估值器中的每一个都适合本教程，而不需要运行代码，你可以看看下面的视频。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ov or l"/></div></figure><h1 id="efce" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结束语</h1><p id="1cd9" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">本教程讲述了如何使用Graphviz和Matplotlib可视化决策树。请注意，使用Matplotlib可视化决策树的方法是一种较新的方法，因此将来可能会有所改变或改进。Graphviz目前更加灵活，因为你可以随时修改你的点文件，使它们在视觉上更具吸引力，就像我使用<a class="ae ky" href="https://www.graphviz.org/pdf/dotguide.pdf" rel="noopener ugc nofollow" target="_blank">点语言</a>所做的那样，甚至只是改变你的决策树的方向。我们没有谈到的一件事是如何使用<a class="ae ky" rel="noopener" target="_blank" href="/beautiful-decision-tree-visualizations-with-dtreeviz-af1a66c1c180"> dtreeviz </a>，这是另一个可以可视化决策树的库。上面有一个很棒的帖子<a class="ae ky" href="https://explained.ai/decision-tree-viz/index.html" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/08e9eab9b35b820b8a35d30ac18df1b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*zbc3K7lPUiPJlQ6-r-wZ3w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://github.com/parrt/dtreeviz" rel="noopener ugc nofollow" target="_blank"> dtreeviz库</a>制作。</p></figure><p id="b9cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我的下一个机器学习教程介绍了<a class="ae ky" href="https://medium.com/distributed-computing-with-ray/how-to-speed-up-scikit-learn-model-training-aaf17e2d1e1" rel="noopener">如何加速Scikit-Learn模型训练</a>。如果您对本教程有任何问题或想法，请在下面的评论中或通过<a class="ae ky" href="https://twitter.com/GalarnykMichael" rel="noopener ugc nofollow" target="_blank"> Twitter </a>联系我们。</p></div></div>    
</body>
</html>