<html>
<head>
<title>Easy Tools For Python Model Train Automation On Your Server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在您的服务器上实现Python模型训练自动化的简单工具</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/easy-tools-for-python-model-train-automation-on-your-server-f035d96ba28?source=collection_archive---------43-----------------------#2020-02-04">https://towardsdatascience.com/easy-tools-for-python-model-train-automation-on-your-server-f035d96ba28?source=collection_archive---------43-----------------------#2020-02-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6c6a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我用来自动化我的API的工具</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/19d612d88cede170b8d4ff4ee982a3b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7dLtp10lc7-8cBmdPbdbEA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(src = http://python.org)</p></figure><p id="3282" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi lu translated">eb自动化是未来的概念，但是非常复杂和难以设置。自动化解决方案通常涉及许多相互依赖的移动部件，并且容易发生故障。通常，这一过程包括三个步骤:</p><blockquote class="md"><p id="ca69" class="me mf it bd mg mh mi mj mk ml mm lt dk translated">生成数据</p><p id="8efa" class="me mf it bd mg mh mi mj mk ml mm lt dk translated">自动化再培训</p><p id="f518" class="me mf it bd mg mh mi mj mk ml mm lt dk translated">部署API</p></blockquote><p id="bc13" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">这些步骤在理论上听起来很简单，但在实践中会创建一个相互依赖的文件和应用程序的复杂网络。通常，在这些情况下，正确的工具非常需要用于正确的工作，但是了解您的选项以及您可用的工具是战斗的一个重要部分。从获取数据到部署API，这个难题的每一部分都需要紧密集成，从获取数据开始。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="79fb" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">生成数据</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/9b587d46968fecfa11506b18b302fb78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m0H6-tUbW6grMlezlb52yw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(src = "http://python.org ")</p></figure><p id="0719" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">“生成”可能是一个错误的术语，但创建可用于培训的数据是一项巨大的挑战。目前最好的工具是Python。运行Python脚本来填充数据库当然是可行的，而且这可以用RDS很容易地完成。不过，在常规的Linux VPS端，我建议将Python与CronJob结合使用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/bc6106b8f4f2776d37dfc12655102d52.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*ApHV2dmiIEzSig9API9BNg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(src = "http://cronjob.com ")</p></figure><p id="2f0c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">CronJob将在接下来的步骤中多次出现，这是有充分理由的。CronJob允许您调度任务在分配的时间运行，这对于服务器自动化特别有用。这是通过使用由分钟、小时、月、星期几等组成的循环“Cron”时间戳来完成的。根据您的使用情况，CronJobs也可以在更短或更长的时间范围内进行调度。如果有一个有价值的工具我会考虑在Linux领域内学习，CronJob很可能是其中之一。在Unix系统上，您可以使用CronJob做很多不同的事情，了解如何使用CronJob无疑可以为您的服务器管理和部署增加很多功能。</p><p id="9784" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通常，Python和CronJob的协同工作足以让您的工作正常运行，并让SQL数据库或本地存储的数据文件不断填充新数据。通常，这些数据将使用Python从API中提取出来，并被推送到JSON或CSV格式，或者更理想的是推送到SQL数据库。</p><h1 id="8008" class="mz na it bd nb nc nt ne nf ng nu ni nj jz nv ka nl kc nw kd nn kf nx kg np nq bi translated">自动化再培训</h1><p id="1114" class="pw-post-body-paragraph ky kz it la b lb ny ju ld le nz jx lg lh oa lj lk ll ob ln lo lp oc lr ls lt im bi translated">自动化再培训是CronJob真正展示其能力的地方。虽然你当然可以在烧瓶路线上进行训练——但这肯定不理想。首先，关于路线的训练将会增加CPU和RAM的使用量，使得系统对于大量的请求非常不可用，并且会拒绝其中的许多请求。此外，根据您的模型，可能需要10分钟以上的训练时间，这对于GET请求来说一点也不理想。</p><p id="5a66" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所以通常情况下，解决方案是使用CronJob或AWS Lambda解决方案。在这两者中，克朗乔布最有可能</p><ul class=""><li id="adee" class="od oe it la b lb lc le lf lh of ll og lp oh lt oi oj ok ol bi translated">更便宜，</li><li id="f80e" class="od oe it la b lb om le on lh oo ll op lp oq lt oi oj ok ol bi translated">更具可扩展性</li><li id="c5d9" class="od oe it la b lb om le on lh oo ll op lp oq lt oi oj ok ol bi translated">更多便利</li><li id="82cb" class="od oe it la b lb om le on lh oo ll op lp oq lt oi oj ok ol bi translated">更简单。</li></ul><p id="7384" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每当我部署一个API时，可伸缩性总是我最关心的问题。考虑到这一点，很难证明随着使用而增加费用的解决方案是合理的。在VPS上运行CronJob肯定是一个很好的方法，因为AWS Lambda的所有问题都可以完全避免，同时增加很少的问题。因此，通常情况下，CronJob和您选择的语言的组合也是您的致命武器。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="4c89" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">部署</h1><p id="c659" class="pw-post-body-paragraph ky kz it la b lb ny ju ld le nz jx lg lh oa lj lk ll ob ln lo lp oc lr ls lt im bi translated">在列出的所有步骤中，部署无疑是最简单的，但也是最复杂的。部署还涉及到更多的步骤，需要前面讨论的所有内容完全一致。不幸的是，这可能相当伤脑筋，因为一次中断可能会使您的整个系统变得无关紧要。</p><p id="5cb3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先你需要一个网络服务器，我总是使用Nginx。通常，另一个选择是Apache，但是我选择Nginx有几个主要原因:</p><ul class=""><li id="3b2d" class="od oe it la b lb lc le lf lh of ll og lp oh lt oi oj ok ol bi translated">开放源码</li><li id="71e7" class="od oe it la b lb om le on lh oo ll op lp oq lt oi oj ok ol bi translated">背后是10年的发展</li><li id="9f84" class="od oe it la b lb om le on lh oo ll op lp oq lt oi oj ok ol bi translated">出色的表现</li><li id="8ddf" class="od oe it la b lb om le on lh oo ll op lp oq lt oi oj ok ol bi translated">简单的配置</li></ul><p id="dcf1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通常情况下，在Nginx web服务器上进行部署会涉及到编辑/etc/nginx/conf.d中的文本文件，如果您想了解更多相关信息，我已经编写了完整的教程，您可以在这里找到:</p><div class="or os gp gr ot ou"><a rel="noopener follow" target="_blank" href="/deploying-flask-with-gunicorn-3-9eaacd0f6eea"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd iu gy z fp oz fr fs pa fu fw is bi translated">用Gunicorn 3展开烧瓶</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">应用程序部署通常会带来意想不到的后果和错误。部署可以是制定或…</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">towardsdatascience.com</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi ks ou"/></div></div></a></div><p id="a0ee" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文还涵盖了Supervisor，这将是部署难题的下一个重要部分。Supervisor允许专用工作组内部的人工用户在后台运行命令。主管将持有运行我们网络服务器的命令，可以是Django、Genie或Flask。Supervisor配置也相对简单，在/etc/supervisor/conf.d中有一个非常相似的配置文件，很容易编辑和访问。</p><p id="a3e0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Flask是一个很好的部署选项，它既轻便又简单，非常适合在web服务器上返回GET请求的预测。使用Flask API，通过get或POST请求输入和输出数据通常就像预测和返回一样简单。</p><p id="08e2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">拼图的最后一块将会是古尼康。Gunicorn是运行Flask应用程序的客户端服务器。你可以通过Pip和一些包管理器来安装Gunicorn(它在Apt中，而不是Dnf中)</p><pre class="kj kk kl km gt pj pk pl pm aw pn bi"><span id="4c23" class="po na it pk b gy pp pq l pr ps">sudo apt-get install gunicorn3</span></pre><p id="7f3e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是将从supervisor配置文件中运行的命令。然后用简单的</p><pre class="kj kk kl km gt pj pk pl pm aw pn bi"><span id="3969" class="po na it pk b gy pp pq l pr ps">service supervisor reload</span></pre><p id="b689" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你将完全部署完毕，准备出发！</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="5411" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在2020年，有了所有这些有价值的工具，你可以在你的服务器上创建一些非常酷的模型和一些非常棒的自动化。拥有一个根据实时数据不断重新训练的模型将是非常有价值和非常可扩展的，这样做的解决方案肯定是最佳的！</p></div></div>    
</body>
</html>