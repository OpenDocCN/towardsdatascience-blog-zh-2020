<html>
<head>
<title>Log Book — AdaBoost, the math behind the algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">日志— AdaBoost，算法背后的数学</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/log-book-adaboost-the-math-behind-the-algorithm-a014c8afbbcc?source=collection_archive---------31-----------------------#2020-04-18">https://towardsdatascience.com/log-book-adaboost-the-math-behind-the-algorithm-a014c8afbbcc?source=collection_archive---------31-----------------------#2020-04-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6de3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这篇文章以一种简单的方式讲述了 AdaBoost 算法背后的数学原理</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4b36e91ed9e22468d68aaa15ca46d3d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rtwJYrt-y_BE3AbjDTbe3A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><blockquote class="kz la lb"><p id="1fd2" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">一个赛马赌徒，希望最大化他的赢款，决定创建一个计算机程序，该程序将根据通常的信息(每匹马最近赢的比赛的次数，每匹马的投注赔率等)准确地预测赛马的获胜者。).为了创建这样一个程序，他请一位非常成功的专业赌徒来解释他的赌博策略。毫不奇怪，专家无法清晰地说出一套选择马匹的宏大规则。另一方面，当呈现特定的一组比赛的数据时，专家可以毫不费力地得出该组比赛的“经验法则”(例如，“对最近赢得最多比赛的马下注”或“对最有希望获胜的马下注”)。虽然这样的经验法则本身显然是非常粗糙和不准确的，但期望它提供至少比随机猜测好一点点的预测并不是不合理的。此外，通过反复询问专家对不同比赛集合的意见，游戏者能够获得许多经验法则。</p><p id="68fb" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">为了最大限度地利用这些经验法则，游戏者面临两个问题:</p><p id="7dea" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf iu">首先，他应该如何选择呈现给专家的种族集合，以便从专家那里提取最有用的经验法则？</strong></p><p id="246f" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf iu">第二，一旦他收集了许多经验法则，如何将它们组合成一个单一的、高度准确的预测法则？</strong></p><p id="bf12" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><em class="it"> Boosting </em>指的是一种通用的、可证明有效的方法，通过以类似于上面建议的方式组合粗糙的和适度不精确的经验规则，产生非常精确的预测规则。</p></blockquote><p id="297b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">上面的摘录摘自那篇著名的论文:<a class="ae ky" href="https://cseweb.ucsd.edu/~yfreund/papers/IntroToBoosting.pdf" rel="noopener ugc nofollow" target="_blank">Boosting 简介，</a>在向门外汉介绍 Boosting 方面，我做得再好不过了。</p><p id="ea36" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">然而，本文假设读者熟悉 boosting，并试图解释 AdaBoost 背后的数学原理，希望步骤简单。这些概念往往简单而美丽，却迷失在数学术语中。我在理解数学的过程中也面临着同样的挑战，这是一次巩固我的理解的尝试，同时也帮助其他人走上类似的旅程。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="69f4" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">回到同一篇论文，AdaBoost 算法的步骤陈述如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mj"><img src="../Images/9d3bfb3f05d057fd7f3ddb7eabd435a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Al8xlDGTWmW8xg2L2-XriA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://mbernste.github.io/files/notes/AdaBoost.pdf" rel="noopener ugc nofollow" target="_blank"> AdaBoost 算法</a></p></figure><p id="cad3" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">让我们一步一步来看:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/15e513de532862e267d568b244a18c3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*wYa57HOocobRo8Lr5f_UDQ.png"/></div></figure><p id="b655" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">第一行很容易理解，但是为了完整起见，我将描述它。它告诉假设有<em class="le"> m </em>个观察值，如<em class="le"> x </em> ₁，<em class="le"> x </em> ₂，<em class="le"> x </em> ₃..<em class="le"> xₘ </em>这些观察值集合被称为<em class="le"> X，</em>而目标变量由<em class="le"> y₁、y₂、y₃给出..</em> <em class="le"> yₘ </em>属于<em class="le"> Y，</em>其中目标被称为<em class="le"> {-1，+1} </em>取决于目标的类别<em class="le">{赢/输}、{正/负} </em>等。</p><p id="ba3b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">简而言之，它<strong class="lf iu">描述了我们提供给模型的数据集</strong>的结构。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/dd390712d3643c8490acc0d4a533d6bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*UNXMtptv4Lv5HK5HBihZ6Q.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/ab2eb343cde33bc351942cec096f62a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*e0AAv7RDpSviUz5x9z6wMw.png"/></div></figure><p id="ad3b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">接下来，我们将为每个观察值分配一个权重，<strong class="lf iu">想法是，对于分类器算法来说，很少有容易分类的观察值，而有其他难以分类的观察值。我们将在每次迭代后调整权重，从而迫使算法更仔细地观察这些难以分类的观察值。</strong></p><p id="2286" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">但是在进入所有这些之前，<strong class="lf iu">在第一次迭代中，我们不知道哪些观察值难以分类，哪些容易分类，所以我们将为每个算法分配相同的权重。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/ab73ab28488b387b8f51df70ac2bc8f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DTxAKlN0xkZr96tbQnUnSQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/13eaafc64a09e47a71a2eb0c57519fbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:386/format:webp/1*wXhrI6dghxv8bbYAPk6K0w.png"/></div></figure><p id="6990" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">这实际上是算法的迭代部分，它规定您将运行算法 T 次，您可以在运行 AdaBoost 时指定该值。</p><p id="8ae1" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">我们知道我们将运行循环 T 次，那么在每个循环中我们将做什么呢？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/803a8725359ef5ba4e7847589c204222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*wsU5Z9Z_esSFYusc0Y8Zug.png"/></div></figure><p id="67ff" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">让我们来看第一个循环:我们有了<em class="le"> X </em>，我们有了<em class="le"> D₁ </em>，经过培训，我们有了第一个弱学习者<em class="le"> h </em> ₁</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/1e12a0145d2e118101c90dfad80ed004.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6m_qI04fuumJY02Xm3znzA.png"/></div></div></figure><p id="bd27" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated"><em class="le"> h </em> ₁用来预测 x 的值，这显然会犯一些错误。我们将根据预测计算误差项，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/a75729affa99a38c785dae89b7d3f0bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hoJRwpXrmA2H5YytJ3jFxw.png"/></div></div></figure><p id="6b3d" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">很好，我们现在有了₁的误差项，这将用于两件事:</p><ol class=""><li id="f6ab" class="ms mt it lf b lg lh lj lk lz mu ma mv mb mw ly mx my mz na bi translated">求<em class="le"> αₜ </em>的值</li><li id="0265" class="ms mt it lf b lg nb lj nc lz nd ma ne mb nf ly mx my mz na bi translated">更新并设置<em class="le"> D₂ </em>的重量</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/a0110f05e2054bc4feba254344488fae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uxMtlsuVD2ydguRGOpE3Og.png"/></div></figure><p id="1566" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated"><strong class="lf iu">什么是αₜ？</strong>它只不过是<strong class="lf iu">单个模特/学员的重量</strong>，在这个例子中，是 h₁.在每一次 t 迭代中，我们将有一个学习者 h<em class="le">₁</em><strong class="lf iu"><em class="le">，h</em></strong><em class="le">₂</em><strong class="lf iu"><em class="le">，h </em> </strong> <em class="le"> ₃..</em><strong class="lf iu"><em class="le"/></strong><em class="le">【ₜ】</em><strong class="lf iu">其中的每一个都将被组合起来以构成最终的模型，这些个体学习者中的每一个在最终输出中的权重由αₜ.给出</strong></p><p id="c48c" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">很好，现在我们理解了αₜ，我们将计算α₁.</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/7a469fa0d19842020e1c9ed4a798dcbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UEenLQr4Hv0qzhmllyVRfg.png"/></div></div></figure><p id="d62b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">请注意，错误率低的模型将具有更高的<strong class="lf iu"> αₜ值，因此在最终输出中具有更高的权重。</strong></p><p id="0a02" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">接下来，我们将更新单个观察值的权重，如前所述，与未正确分类的点相比，正确分类的点将具有较低的权重:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/88fc351262f877a82f559a55f41c5944.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*es9HV-LhhTQxVkOgQGNoHg.png"/></div></div></figure><p id="f78b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">如果你想知道什么是 Zₜ，它只不过是一种确保 Dₜ仍然等于 1 的方法</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/1bce980e29cc1439790d3aa4efa75143.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DlgbckLvuDp2571NE-KvqA.png"/></div></div></figure><p id="3996" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">这个整个过程重复 T 次，产生由下式给出的最终模型:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/8d46f32d36aa821011f3df05a8d3f8ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*8YritOyVNgBUzzIufJXQew.png"/></div></figure><p id="c16c" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">如您所见，最终模型是 T 个模型的组合，每个模型都有自己的权重，组合在一起得到最终输出。每个单独模型的权重将由其对应的αₜ给出，从而导致精度较高的模型获得较高的权重。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="694f" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">总结一下模型的作用:</p><ol class=""><li id="16f5" class="ms mt it lf b lg lh lj lk lz mu ma mv mb mw ly mx my mz na bi translated"><em class="le">一旦你准备好了数据，就从所有观察值的权重相等开始</em></li><li id="33b1" class="ms mt it lf b lg nb lj nc lz nd ma ne mb nf ly mx my mz na bi translated"><em class="le">得到第一个弱学习者</em></li><li id="30c5" class="ms mt it lf b lg nb lj nc lz nd ma ne mb nf ly mx my mz na bi translated"><em class="le">计算模型的误差</em></li><li id="002c" class="ms mt it lf b lg nb lj nc lz nd ma ne mb nf ly mx my mz na bi translated"><em class="le">计算模特αₜ的体重</em></li><li id="67c1" class="ms mt it lf b lg nb lj nc lz nd ma ne mb nf ly mx my mz na bi translated"><em class="le">更新下一轮每个观测 Dₜ的权重</em></li><li id="fb58" class="ms mt it lf b lg nb lj nc lz nd ma ne mb nf ly mx my mz na bi translated"><em class="le">运行此循环 T 次</em></li><li id="502e" class="ms mt it lf b lg nb lj nc lz nd ma ne mb nf ly mx my mz na bi translated"><em class="le">获得最终合奏</em></li></ol><p id="7c61" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll lz ln lo lp ma lr ls lt mb lv lw lx ly im bi translated">希望这有助于澄清事情。会在其他文章中补上。</p><h1 id="3ad8" class="nl nm it bd nn no np nq nr ns nt nu nv jz nw ka nx kc ny kd nz kf oa kg ob oc bi translated">参考资料:</h1><p id="ff79" class="pw-post-body-paragraph lc ld it lf b lg od ju li lj oe jx ll lz of lo lp ma og ls lt mb oh lw lx ly im bi translated"><a class="ae ky" href="https://mbernste.github.io/files/notes/AdaBoost.pdf" rel="noopener ugc nofollow" target="_blank">https://mbernste.github.io/files/notes/AdaBoost.pdf</a><br/><a class="ae ky" href="https://cseweb.ucsd.edu/~yfreund/papers/IntroToBoosting.pdf" rel="noopener ugc nofollow" target="_blank">https://cseweb.ucsd.edu/~yfreund/papers/IntroToBoosting.pdf</a><br/><a class="ae ky" rel="noopener" target="_blank" href="/adaboost-for-dummies-breaking-down-the-math-and-its-equations-into-simple-terms-87f439757dcf">https://towardsdatascience . com/AdaBoost-for-dummies-breaking-down-the-math-and-its-equations-into-simple-terms-87f 439757 DCF</a></p></div></div>    
</body>
</html>