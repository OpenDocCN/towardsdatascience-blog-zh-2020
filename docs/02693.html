<html>
<head>
<title>Utilize your Data Science Project (Part 2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用您的数据科学项目(第2部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/utilize-your-data-science-project-part-2-982e59a4b4bf?source=collection_archive---------31-----------------------#2020-03-15">https://towardsdatascience.com/utilize-your-data-science-project-part-2-982e59a4b4bf?source=collection_archive---------31-----------------------#2020-03-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7d7e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用PyQt5为LendingClub仪表板创建GUI</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/797f56d8d2c263f642a2cdc6e6ca7de8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y3jpyE2tpYcgtqI8N7U7hQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我的LendingClub仪表板应用程序的图形用户界面</p></figure><p id="8a06" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是两部分系列的第二部分。查看第一篇文章，点击 <a class="ae ls" rel="noopener" target="_blank" href="/utilizing-your-data-science-project-32ef3f3230f4"> <em class="lr">此处</em> </a> <em class="lr">。</em></p><p id="7854" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在过去的几年里，数据科学就业市场对软件工程技能和将机器学习模型投入生产的经验的重视程度显著提高。在这个故事的第1部分，我经历了在最终产品(理论上是面向用户的)的环境中编写利用机器学习模型的程序的一些考虑。这个过程揭示了许多启示，我相信这些启示启发了我对数据科学产品过程的了解。</p><p id="15f2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这一部分，我将重点介绍一个对许多数据科学家或学生来说可能不熟悉的过程；创建用户界面。如果你想提高数据科学就业市场的技能，学习如何为消费者包装机器学习产品，或者创建一个程序，使你的项目更容易用于个人用途，请继续阅读！</p><h1 id="330a" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">选择PyQt5框架</h1><p id="f3a9" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated"><a class="ae ls" href="https://pypi.org/project/PyQt5/" rel="noopener ugc nofollow" target="_blank"> PyQt5 </a>是一组Python绑定(一种从Python调用C函数的方式)，允许我们创建GUI(图形用户界面)，在C++中实现Qt库，只使用Python，允许开发人员相当容易地从头创建应用程序。我也和Kivy和Tkinter一起玩过，但是PyQt5似乎最适合我的需要。Tkinter是一个相当标准的GUI库，但它在MAC上有点问题，Kivy对于移动应用程序开发来说很棒，但对于桌面应用程序来说不太有效。最终，我选择了PyQt5，因为它非常直观和灵活。只要你熟悉创建和定义类，以及面向对象编程的一般原则，这是很容易掌握的。</p><p id="122f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我大量使用了来自编程频道“Tech With Tim”的YouTube教程来学习这个库和框架的基础知识。你可以在这里找到他的系列视频<a class="ae ls" href="https://www.youtube.com/watch?v=Vde5SH8e1OQ&amp;list=PLzMcBGfZo4-lB8MZfHPLTEHO9zJDDLpYj" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="07c4" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">用Qt Designer设计界面</h1><p id="ccca" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">Qt框架的一个我最喜欢的特性是能够用一个叫做Qt Designer的工具手动布局窗口。Designer允许您拖放不同的元素(如按钮、标签、滑块等)。)拖到一个示例窗口上，这样您就可以设计一个视觉上吸引人的程序，而不用在代码中摆弄x/y坐标或维度。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/696513778588632eb8d680a1c8f0752e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e8aY9Xz7oXfbcYfO4dUOuw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在Qt Desginer中设置我的仪表板</p></figure><p id="9ecb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦有了喜欢的布局，就可以将其保存为. ui文件。从那里，我们可以在命令行中使用pyuic5命令从我们的。ui文件。在确保您位于正确的工作目录后，只需在您选择的命令行界面中键入以下内容:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="c648" class="mw lu iq ms b gy mx my l mz na">pyuic5 -x saved_file.ui -o new_file.py</span></pre><p id="11b0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该命令的“-x”部分添加了一段Python代码，当我们运行生成的Python脚本时，该代码将执行并显示程序。“-o”命令指定输出文件的名称。</p><p id="aa62" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦你完成了这些，你就可以在你喜欢的文本编辑器中打开这个文件并创建一个工作应用程序！</p><p id="2378" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可以在这里下载Qt Designer for Mac或Windows <a class="ae ls" href="https://build-system.fman.io/qt-designer-download" rel="noopener ugc nofollow" target="_blank">。在Windows上，您还可以使用:</a></p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="41a9" class="mw lu iq ms b gy mx my l mz na">pip install pyqt5-tools</span></pre><p id="7683" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在命令行中安装一套与这个库相关的工具。</p><h1 id="61f6" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">向界面添加功能</h1><p id="fed6" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">一旦你为你的用户界面创建了一个Python文件，你可以试着运行它。它应该像正常程序一样显示在你的屏幕上，但是按钮或小部件都没有做任何事情。我们仍然需要用Python编写代码来指导我们的程序做我们想要做的事情。</p><p id="41a5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这一部分显然会根据您创建的应用程序而有所不同，但是我将概述我创建Lending Club程序的主要步骤。</p><h2 id="5433" class="mw lu iq bd lv nb nc dn lz nd ne dp md le nf ng mf li nh ni mh lm nj nk mj nl bi translated">填充仪表板</h2><p id="d278" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">在第一部分中，我概述了从Lending Club下载实时数据，并使用该模型预测还款可能性的步骤。完成后，我们希望在仪表板中显示贷款信息以及我们的预测。</p><p id="2c18" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们自动生成的代码创建了一个类(我的名为Ui_Form)，然后是一个名为setupUi的方法。我们的主窗口将是这个类的一个实例，正如您可能猜到的，setupUi()将在脚本运行时创建并设置这个实例。生成我们的表或tableWidget的代码是自动为我们编写的，设置列维度也是如此。使用以下代码设置行数(display是我们想要显示的数据框):</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="60ea" class="mw lu iq ms b gy mx my l mz na">self.tableWidget.setRowCount(display.shape[0])</span></pre><p id="a85f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">更多自动生成的代码创建表的列，然后用以下循环填充表:</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="e9ef" class="mw lu iq ms b gy mx my l mz na">for r in range(display.shape[0]):<br/>    for c in range(7):<br/>        self.tableWidget.setItem(<br/>                                 r,c,<br/>                                 QtWidgets.QTableWidgetItem(<br/>                                     str(display.iloc[r,c]))<br/>                                 )</span></pre><p id="06e2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">很可能有一种更有效的方法来做到这一点。然而，我们的数据框可能不会超过60或70行。代码在速度方面没有留下任何需要改进的地方，所以我没有进一步优化。</p><h2 id="bb8c" class="mw lu iq bd lv nb nc dn lz nd ne dp md le nf ng mf li nh ni mh lm nj nk mj nl bi translated">添加过滤器</h2><p id="5404" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">我希望用户能够缩小他们正在查看的贷款选项，以符合他们的个人偏好。首先，我添加了各种贷款类别的复选框(Lending Club将所有贷款从A到G进行评级)。当程序启动时，我的程序自动检查每个等级的复选框，然后连接到一个名为“redraw”的类方法，每当单击它时，它将在接下来被定义。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="5765" class="mw lu iq ms b gy mx my l mz na">self.a_box.setCheckState(2)  # A state of 2 means the box is checked<br/>self.a_box.clicked.connect(self.redraw)</span></pre><p id="b67e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">的功能。connect()将一个事件(在本例中是self.a_box.clicked，或者是改变状态的A框)连接到一个方法。这是我们赋予界面生命的主要方法。除了“全部”框之外，前面的代码对每个复选框都重复。这个框连接到一个单独的函数，该函数检查或取消检查所有的框(取决于状态)，然后调用redraw方法。</p><p id="a9ee" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我为用户添加了滑块，以便按利率或期望值/平均结果过滤显示的贷款。这个过程是相似的，除了我们必须设置最小和最大值，并且可能在初始化时为滑块设置一个值。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="621a" class="mw lu iq ms b gy mx my l mz na">self.min_int.setMinimum(min(display_raw.intRate)-1)<br/>self.min_int.setMaximum(max(display_raw.intRate)+1)<br/>self.min_int.sliderMoved.connect(self.redraw)</span><span id="362c" class="mw lu iq ms b gy nm my l mz na">self.max_int.setMinimum(min(display_raw.intRate)-1)<br/>self.max_int.setMaximum(max(display_raw.intRate)+1)<br/>self.max_int.setValue(max(display_raw.intRate)+1)<br/>self.max_int.sliderMoved.connect(self.redraw)</span></pre><p id="97e4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">同样，无论何时移动滑块，动作都连接到redraw函数。</p><h2 id="df2c" class="mw lu iq bd lv nb nc dn lz nd ne dp md le nf ng mf li nh ni mh lm nj nk mj nl bi translated">重画功能</h2><p id="38a2" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">每当更改过滤器时，都会调用redraw函数。它实际上做的和它听起来的一样。首先，创建一个过滤后的贷款等级列表。每当复选框被选中时，方法checkState()为2，因此disp_rows是用户希望返回的贷款等级列表。接下来，创建一个对象newdf，它是反映过滤器状态的贷款数据框架的子集。最后，表会像最初一样被填充。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="9385" class="mw lu iq ms b gy mx my l mz na">def redraw(self):</span><span id="6b4b" class="mw lu iq ms b gy nm my l mz na">disp_rows = [(self.a_box.checkState() == 2) * 'A', <br/>                    (self.b_box.checkState() == 2) * 'B',<br/>                    (self.c_box.checkState() == 2) * 'C',<br/>                    (self.d_box.checkState() == 2) * 'D',<br/>                    (self.e_box.checkState() == 2) * 'E',<br/>                    (self.f_box.checkState() == 2) * 'F',<br/>                    (self.g_box.checkState() == 2) * 'G',<br/>                    ]</span><span id="a0dd" class="mw lu iq ms b gy nm my l mz na">newdf = display[[x in disp_rows for x in display.grade] &amp; <br/>                    (display_raw['intRate']&gt;=self.min_int.value()) &amp; <br/>                    (display_raw['intRate']&lt;=self.max_int.value()) &amp;<br/>                    (display_raw['EV'] &gt;= self.min_ev.value()) &amp;<br/>                    (display_raw['EV'] &lt;= self.max_ev.value())<br/>                    ]<br/>    <br/>    self.tableWidget.setRowCount(newdf.shape[0])</span><span id="d16e" class="mw lu iq ms b gy nm my l mz na">for r in range(newdf.shape[0]):<br/>        for c in range(7):<br/>            self.tableWidget.setItem(<br/>                                     r,c,<br/>                                     QtWidgets.QTableWidgetItem(<br/>                                     str(newdf.iloc[r,c]))<br/>                                     )</span></pre><h2 id="f817" class="mw lu iq bd lv nb nc dn lz nd ne dp md le nf ng mf li nh ni mh lm nj nk mj nl bi translated">登录屏幕</h2><p id="7f48" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">最后需要做的事情是合并一个登录屏幕。除了让它感觉更像一个“真实的”应用程序，登录屏幕还为用户提供了一个输入登录信息的简单方法(在本例中，是一个连接到Lending Club API的API键)。</p><p id="3f75" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了创建一个单独的窗口，定义了一个新的类(我再次使用了Qt Designer)。这个新的登录窗口将是程序启动时初始化的窗口，主窗口稍后创建。</p><p id="826a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦用户输入他们的API键，我们必须将一个按钮点击事件连接到一个函数。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="bbc8" class="mw lu iq ms b gy mx my l mz na">self.ok_button.clicked.connect(self.logging_in)</span></pre><p id="a555" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当调用这个函数时，程序将用户的输入存储为一个名为apikey的全局变量，当我们设置主窗口时会再次调用这个变量。之后，主窗口被初始化，我们所知道的程序开始了。</p><pre class="kg kh ki kj gt mr ms mt mu aw mv bi"><span id="e5b0" class="mw lu iq ms b gy mx my l mz na">def logging_in(self):<br/>    global apikey <br/>    apikey = ui.keybox.text()<br/>    Form = QtWidgets.QDialog()<br/>    uimain = Ui_Form()<br/>    uimain.setupUi(Form)<br/>    Form.show()<br/>    Form.exec_()</span></pre><h1 id="ff12" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="549b" class="pw-post-body-paragraph kv kw iq kx b ky ml jr la lb mm ju ld le mn lg lh li mo lk ll lm mp lo lp lq ij bi translated">经历这个过程教会了我很多关于将机器学习模型投入生产的生命周期、面向对象编程以及一般的应用程序开发。对于使用像PyQt5这样的框架可以完成的事情，我仅仅触及了皮毛。如果你有兴趣了解更多，请查看之前提到的Tim(不是我)的<a class="ae ls" href="https://www.youtube.com/watch?v=Vde5SH8e1OQ&amp;list=PLzMcBGfZo4-lB8MZfHPLTEHO9zJDDLpYj&amp;index=1" rel="noopener ugc nofollow" target="_blank"> Youtube教程</a>、<a class="ae ls" href="https://doc.qt.io/qtforpython/index.html" rel="noopener ugc nofollow" target="_blank"> PyQt5文档</a>，或者尝试自己创建一个应用或项目！</p><p id="6f41" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="lr">如果你想了解更多关于我的应用程序的后端，请在这里阅读第一部分</em><a class="ae ls" rel="noopener" target="_blank" href="/utilizing-your-data-science-project-32ef3f3230f4"><em class="lr"/></a><em class="lr">。在我的Github </em> <a class="ae ls" href="https://github.com/timcopelandoh/thinkful/blob/master/Capstones%20and%20Projects/LC_app/final/app.py" rel="noopener ugc nofollow" target="_blank"> <em class="lr">上随意查看完整代码，这里</em> </a> <em class="lr">。</em></p></div></div>    
</body>
</html>