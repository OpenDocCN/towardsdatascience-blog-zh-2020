<html>
<head>
<title>Predict NBA games, make money — machine learning project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测 NBA 比赛，赚钱——机器学习项目</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predict-nba-games-make-money-machine-learning-project-b222b33f70a3?source=collection_archive---------22-----------------------#2020-04-09">https://towardsdatascience.com/predict-nba-games-make-money-machine-learning-project-b222b33f70a3?source=collection_archive---------22-----------------------#2020-04-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d3b4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">过去的表现并不能说明未来的表现…除非…我们能获得 136%的回报…？😉</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/85781b18bde315a92843a3ae7df20d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*D892Q0xqNfemK9ZviytvLQ.gif"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">mfw 我的深度学习模型编译//photomosh.com 制造</p></figure><p id="444c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">下注者和庄家没有太多的共同之处——人们可以把他们的关系描述为竞争。但在睡梦中，他们对同一个幻想垂涎三尺:一个历史表现如此完美的模型，它以精确的<strong class="kw iu"><em class="lq"/></strong>预测未来游戏的结果。有了深度学习，这可能成为可能——或者至少比以前的数据科学技术更容易。</p><p id="b1fb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我阅读了许多<strong class="kw iu">好的和坏的期刊文章，看看这是否可能，下面是一些好的文章:<br/> <a class="ae lr" href="https://www.sciencedirect.com/science/article/abs/pii/S016920701930007X?via%3Dihub" rel="noopener ugc nofollow" target="_blank"> <em class="lq">利用机器学习开发体育博彩市场</em></a><em class="lq">(2018)<br/></em><a class="ae lr" href="https://onlinelibrary.wiley.com/doi/abs/10.1111/ecin.12404" rel="noopener ugc nofollow" target="_blank"><em class="lq">情绪偏差和资产价格:来自体育博彩市场的证据</em></a><em class="lq">(2016)<br/></em><a class="ae lr" href="https://journals.sagepub.com/doi/abs/10.1177/1527002516656726" rel="noopener ugc nofollow" target="_blank"><em class="lq">美国国家篮球协会博彩中的情绪偏差</em> </a></strong></p><p id="61f7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">潜在的假设是，NBA 市场是无效率的(价格或投注线并不反映游戏的所有可用信息)——并且可能比大多数市场更无效率，因为铁杆球迷的偏见只是押注于他们最喜欢的球队。如果你能赌赢市场的无效率，你就能赚钱。我们可以识别低效率的方法之一是分析硬数据。</p><p id="220a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">尽管尝试这一挑战的许多模型都是<em class="lq">精确的，但是</em>大多数都<strong class="kw iu">离盈利还差得很远。原因很简单:博彩公司也非常准确。即使你匹配了庄家准确率，你也会因为 5%的投注费/房子边缘而输。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/ca621b5844e6533e239646d43904363d.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/1*tbPL551mVBpVIxLTPZmJcg.gif"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated"><a class="ae lr" href="https://www.football-data.co.uk/blog/nba_pinnacle_efficiency.php" rel="noopener ugc nofollow" target="_blank">https://www . football-data . co . uk/blog/NBA _ pinnacle _ efficiency . PHP</a></p></figure><p id="ea8d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">左边的图表是 bet365 资金线与实际获胜百分比。一个成功的模型必须从完美回归中预测庄家的微小波动。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="d15d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我的模型是用 Python 和 Tensorflow 构建的，分析了过去的 11 个 NBA 赛季，在许多方面，它与其他试图解决这个问题的深度学习模型相似，但有一个关键的不同——它使用一个定制的损失函数来<strong class="kw iu">与博彩公司去相关。</strong>我们正在挑选博彩公司虚报了实际百分比的游戏。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/e139940d0b7ea7b23bc98215be9f3ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*CsXM-nyT-fgFTCBsJE3Cnw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">去相关损失公式——这非常重要！！！！！！！</p></figure><h1 id="a9c6" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">Da 代码</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/57cef8117ac9fc135e0c6905c0ad5f03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4H5HIFwWatDJMDpKCIuUrw.jpeg"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">模型架构</p></figure><p id="7ebb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我使用 nba_api Python 库抓取了盒子得分历史<a class="ae lr" href="https://github.com/swar/nba_api" rel="noopener ugc nofollow" target="_blank">。数据存储在 MongoDB 集合中。在过去的 11 个赛季中，每个球员的每场比赛总共有 42 个数据被存储，从罚球命中率到防守等级到抢断次数。投注数据是从</a><a class="ae lr" href="https://www.betexplorer.com" rel="noopener ugc nofollow" target="_blank">的 betexplorer </a>上刮下来的。找到高质量的投注线比训练模型要难得多。向斯洛文尼亚卢布尔雅那大学的 trumbelj 教授寻求一些建议。</p><p id="7e7d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于每场比赛，样本是用每个球员从赛季开始的最后 8 场比赛的平均值计算的。根据平均游戏时间选择前 8 名玩家。</p><h2 id="850d" class="mt lx it bd ly mu mv dn mc mw mx dp mg ld my mz mi lh na nb mk ll nc nd mm ne bi translated">型号:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf lu l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nf lu l"/></div></figure><p id="8006" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">该模型是 Conv2D 和密集层的组合，有很多漏失。该模型的独特之处在于去相关损失，我提到的第一篇论文对此进行了概述。尽管 Keras 本身不支持带有神经元值的损失函数，但是将函数包装在函数中是一种有用的解决方法。我在 GTX 1660Ti 上训练网络 20 个纪元，直到网络收敛。</p><h2 id="d304" class="mt lx it bd ly mu mv dn mc mw mx dp mg ld my mz mi lh na nb mk ll nc nd mm ne bi translated">结果:</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/b8784fd9a772f55f9089e7bc3aef3afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*OZ6zCj3YaAawxjRrYqy6Sw.png"/></div></figure><p id="e74e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用 10%的余额*模型置信度的非常原始的下注策略，并且仅在模型置信度&gt; 0.6 的游戏上赌博，我们生成一个向上的余额趋势。有趣的是，该模型只对全部游戏的大约 10%下注。除了整个 2017-18 赛季的灾难性连败之外，我们的模型表现非常好，初始投资为 100 美元，最高为 292 美元。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lt lu l"/></div></figure><h2 id="c471" class="mt lx it bd ly mu mv dn mc mw mx dp mg ld my mz mi lh na nb mk ll nc nd mm ne bi translated">学习与未来:</h2><p id="c8f2" class="pw-post-body-paragraph ku kv it kw b kx nh ju kz la ni jx lc ld nj lf lg lh nk lj lk ll nl ln lo lp im bi translated">这只是这种模式的开始。随着令人鼓舞的结果，我想制定一个更有活力的投注策略。如果你想嘲笑/怜悯我写的 Jupyter 笔记本的 1k 行，完整的未删节未编辑的笔记本可以在这里找到:<a class="ae lr" href="https://github.com/calebcheng00/nba_predictions/blob/master/nba.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/calebcheng 00/NBA _ predictions/blob/master/NBA . ipynb</a><br/>唯一有用的东西大概就是投注刮码和模型了。</p><p id="768b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用 NoSQL 是一个错误，我应该坚持使用 SQLite，但学习一项新技术是很好的。编写自定义损失函数是一次非常有价值的经历，在未来的深度学习项目中会派上用场。</p></div></div>    
</body>
</html>