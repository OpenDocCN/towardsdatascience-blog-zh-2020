<html>
<head>
<title>Machine Learning Classifiers: Data Resamplers Comparison with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习分类器:数据重采样器与 Python 的比较</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-classifiers-data-resamplers-comparison-906442d04fde?source=collection_archive---------61-----------------------#2020-06-12">https://towardsdatascience.com/machine-learning-classifiers-data-resamplers-comparison-906442d04fde?source=collection_archive---------61-----------------------#2020-06-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="4de2" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">用于机器学习的 Python</h2><div class=""/><div class=""><h2 id="737f" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">评估和比较重采样技术</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/6fee5d9ca1e73a19f45f0026a3f2c08b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P9-YtA7cMNt-eUHa"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由<a class="ae lh" href="https://unsplash.com/@jeremythomasphoto" rel="noopener ugc nofollow" target="_blank">杰瑞米·托马斯</a>提供，在<a class="ae lh" href="https://unsplash.com/photos/FO7bKvgETgQ" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><h1 id="e528" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">机器学习分类器</h1><p id="17b1" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">机器学习分类器是用于在标记数据可用时预测数据点类别的模型(即监督学习)。一些最广泛使用的算法是逻辑回归、朴素贝叶斯、随机梯度下降、k-最近邻、决策树、随机森林和支持向量机。</p><h1 id="6a68" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">绩效评估指标</h1><p id="eee0" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">必须对分类模型进行评估，以确定它们执行特定任务的有效程度。虽然好的分类模型对于预测目的是有用的，但是差的分类模型导致不可靠的结果，因此对于用户是无用的。</p><p id="2459" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">绩效评估指标基于以下变量的总数:</p><ul class=""><li id="e659" class="nb nc it mc b md mw mg mx mj nd mn ne mr nf mv ng nh ni nj bi translated"><strong class="mc jd">真阳性</strong>:结果被正确预测为阳性类别</li><li id="8963" class="nb nc it mc b md nk mg nl mj nm mn nn mr no mv ng nh ni nj bi translated"><strong class="mc jd">真阴性</strong>:结果被正确预测为阴性类别</li><li id="9717" class="nb nc it mc b md nk mg nl mj nm mn nn mr no mv ng nh ni nj bi translated"><strong class="mc jd">假阳性</strong>:结果被错误地预测为阳性类别</li><li id="a66f" class="nb nc it mc b md nk mg nl mj nm mn nn mr no mv ng nh ni nj bi translated"><strong class="mc jd">假阴性</strong>:结果被错误地预测为阴性类别</li></ul><p id="4ae9" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">其中一个轴是机器学习模型预测的标签，另一个轴是实际标签:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi np"><img src="../Images/255f625f7f449d81c7d2582fe0f10626.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/0*4r2Tt_ELkIj6-hp5.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">二元分类的混淆矩阵</p></figure><p id="1f6d" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">有四个主要的性能指标用于评估分类模型的有效性:</p><ul class=""><li id="ce1b" class="nb nc it mc b md mw mg mx mj nd mn ne mr nf mv ng nh ni nj bi translated"><strong class="mc jd">准确性</strong>:测试正确预测两个类别的能力</li><li id="5310" class="nb nc it mc b md nk mg nl mj nm mn nn mr no mv ng nh ni nj bi translated"><strong class="mc jd">精度</strong>:测试从所有预测的阳性类别中正确检测出阳性类别的能力</li><li id="a9e7" class="nb nc it mc b md nk mg nl mj nm mn nn mr no mv ng nh ni nj bi translated"><strong class="mc jd">回忆(灵敏度):</strong>测试从所有实际阳性类别中正确检测出阳性类别的能力</li><li id="13bd" class="nb nc it mc b md nk mg nl mj nm mn nn mr no mv ng nh ni nj bi translated"><strong class="mc jd"> F1 得分</strong>:精确度和召回率的调和平均值</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/02d100606bfff9441581be847bc61922.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/0*34nypDS7Vh6NUhRY.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">绩效指标公式</p></figure><h1 id="1f57" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">不平衡数据集</h1><p id="6a2e" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">不平衡数据集是指不同类别中样本总数变化很大的数据集，导致机器学习分类器偏向样本数较大的类别(即多数类别)。下图说明了使用不同级别的类平衡训练线性 SVC(支持向量分类器)。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nr"><img src="../Images/d45e397cf23b56024e3fd98c37d95d69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NA0OAXqQol45Z19G.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由 g .勒迈特等人提供，可在 I<a class="ae lh" href="https://imbalanced-learn.readthedocs.io/en/stable/introduction.html" rel="noopener ugc nofollow" target="_blank">m balanced-learn . readthedocs . io</a>获取</p></figure><p id="1654" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">为了解决这个问题，有两组重采样技术用于平衡数据集:</p><h2 id="8f43" class="ns lj it bd lk nt nu dn lo nv nw dp ls mj nx ny lu mn nz oa lw mr ob oc ly iz bi translated">欠采样技术</h2><p id="1fe0" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">欠采样包括减少来自多数类的样本数量，以使其与来自少数类的样本数量相匹配。一些欠采样技术包括:随机欠采样、托梅克链接和压缩最近邻。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi od"><img src="../Images/d2255e13c08c6c5d03ccae817d72bbc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*h1zadifNcAyM34iPwznx2A.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">欠采样表示</p></figure><h2 id="3263" class="ns lj it bd lk nt nu dn lo nv nw dp ls mj nx ny lu mn nz oa lw mr ob oc ly iz bi translated">过采样技术</h2><p id="4203" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">过采样包括增加来自少数类的样本数，使其与来自多数类的样本数相匹配。一些过采样技术包括:随机过采样、SMOTE、SMOTE-NC、边界 SMOTE 和自适应合成。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oe"><img src="../Images/1cbd28ac2f8cceb4e3a928cfbb5bd392.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*NWjNnbCks0EmT0L7sNzRTA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">过采样表示</p></figure></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><p id="f14b" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">对于下面的例子，让我们在应用了 11 种不同的重采样技术(随机欠采样、接近缺失 I、接近缺失 II、接近缺失 III、Tomek 链接、浓缩最近邻、SMOTE、边界 SMOTE、SMOTE-NC、自适应合成和随机过采样)以确定导致最可靠结果的技术之后，评估逻辑回归模型在<a class="ae lh" href="https://github.com/rsalaza4/Machine-Learning-Classifiers-Comparison/blob/master/Data%20Sets/framingham.csv" rel="noopener ugc nofollow" target="_blank">弗雷明汉心脏研究数据集</a>上的性能。</p><p id="7192" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">下面的 Python 代码将分为五个主要步骤。包含的注释行提供了简短的解释，并指导您完成编码过程。</p><h2 id="f95d" class="ns lj it bd lk nt nu dn lo nv nw dp ls mj nx ny lu mn nz oa lw mr ob oc ly iz bi translated">步骤#1:数据加载</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="om on l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oo"><img src="../Images/0cc0a39b380d431b28c3dd4412c102c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rdGxin7piCUJ--O9XKvhXg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">弗雷明汉心脏研究</p></figure><h2 id="a2e2" class="ns lj it bd lk nt nu dn lo nv nw dp ls mj nx ny lu mn nz oa lw mr ob oc ly iz bi translated">步骤 2:探索性数据分析</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="om on l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/4ea67a09d1b8a578a9919df7185bb75a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/0*tmmsyJ8T9DXkHizh.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">男性/女性比例</p></figure><p id="7532" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">根据上面的图，弗雷明汉心脏研究包含更多与女性相关的数据点，而不是男性。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi op"><img src="../Images/8731b5ecf2f04b8808dce185597d6114.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/0*uAId7ZGIF2W5buyF.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">结果计数</p></figure><p id="60d0" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">上面的图表揭示了弗雷明汉心脏研究是一个严重不平衡的数据集。大多数数据点对应于负面类别(即十年内发展成心血管疾病的低风险)。要解决这个问题，需要进一步的数据平衡。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/469039d7007370ceefed24b730cc07f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/0*f68ycF_W3njxPWyY.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">按性别统计的结果</p></figure><p id="5bc0" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">有意思。尽管与男性相对应的数据点总数较低，但上图表明，男性患心血管疾病的风险高于女性。</p><h2 id="f142" class="ns lj it bd lk nt nu dn lo nv nw dp ls mj nx ny lu mn nz oa lw mr ob oc ly iz bi translated">步骤 3:数据清理</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="om on l"/></div></figure><h2 id="4554" class="ns lj it bd lk nt nu dn lo nv nw dp ls mj nx ny lu mn nz oa lw mr ob oc ly iz bi translated">步骤 4:不平衡的模型构建和性能评估</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="om on l"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi or"><img src="../Images/c8dbf5a7ff73ad39193d476b7d3d9999.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*XDl3TP4Kl-YNoI7R98iOVw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">模型的性能衡量不平衡数据集中的分数</p></figure><h2 id="8bff" class="ns lj it bd lk nt nu dn lo nv nw dp ls mj nx ny lu mn nz oa lw mr ob oc ly iz bi translated">第 5 步:数据平衡</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="om on l"/></div></figure><h2 id="36a3" class="ns lj it bd lk nt nu dn lo nv nw dp ls mj nx ny lu mn nz oa lw mr ob oc ly iz bi translated">步骤#6:平衡的模型构建和性能评估</h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="om on l"/></div></figure><p id="868e" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">最终结果</strong></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi os"><img src="../Images/7ea3c526056b11fe598ade69bf6cde2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AXsN3PwrHVk_77K3LMN4Qw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">模型的性能衡量平衡数据集中的分数</p></figure><h2 id="77ff" class="ns lj it bd lk nt nu dn lo nv nw dp ls mj nx ny lu mn nz oa lw mr ob oc ly iz bi translated">结果解释</h2><p id="8d92" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">根据上表中的结果，为在采样技术下与浓缩最近邻平衡的数据集开发的逻辑回归模型获得了最佳的精确度、召回率和 F1 分数，以及第三好的精确度分数，使其成为该数据集最可靠的模型。</p><p id="9576" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">与从为原始不平衡数据集开发的逻辑回归模型中获得的绩效指标得分相比，为平衡数据集开发的模型的绩效指标得分有所提高。精确度分数从 0.6135 增加到 0.6596，召回分数从 0.0777 增加到 0.7929，F1 分数从 0.1362 增加到 0.7188。然而，准确度分数从 0.8512 下降到 0.6260。根据上表中的结果，没有可提高模型精度得分的重采样技术，因为最高的一个是通过随机欠采样技术获得的值 0.6516。</p><h2 id="77fa" class="ns lj it bd lk nt nu dn lo nv nw dp ls mj nx ny lu mn nz oa lw mr ob oc ly iz bi translated">接下来是什么？</h2><p id="e6c4" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在浓缩最近邻被识别为导致最可靠的机器学习模型的最佳重采样技术之后，下一步将包括调整其参数以确定其性能是否可以进一步提高。</p><p id="db79" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">值得说明的是，在机器学习分类器的实例化和上面代码中的重采样技术期间，它们的参数被设置为默认参数，除了逻辑回归模型中的<em class="ot"> max_iter </em>参数用于实现模型收敛，以及一些重采样函数中的<em class="ot"> random_state </em>参数用于可复制性。</p><h2 id="9f6c" class="ns lj it bd lk nt nu dn lo nv nw dp ls mj nx ny lu mn nz oa lw mr ob oc ly iz bi translated">现在轮到你了</h2><p id="a8bd" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在前面的示例中，仅开发了一个机器学习分类器(即逻辑回归)，并使用多种重新采样技术进行了评估。然而，其他机器学习分类器(例如决策树、随机森林、支持向量分类器、高斯朴素贝叶斯分类器)的发展可能会导致更好的结果。尝试用其他机器学习分类器重复这个实验，以确定对于这个数据集，是否有更好的分类器和重采样技术的组合。</p><p id="30a9" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">同样，机器学习模型是使用整个数据集(即对应于男性和女性的数据点)建立的，它假设导致心血管疾病的因素对两性具有相同的权重。作为练习编码技能的一种方式，尝试按性别划分数据集，并为每个数据集建立分类模型。使用本文中讨论的评估指标比较它们的性能，并评估是为每种性别建立独立的分类模型更方便，还是为两种性别建立一个公共的分类模型更方便。</p><h1 id="8505" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">总结想法</h1><p id="84d4" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">机器学习和人工智能算法在解决问题和复杂任务方面有许多有用和多样的应用。除了数据科学，它们已经成为学术界和专业人士非常流行的研究趋势，在广泛的领域中出现了新的研究方向。研究人员继续为多种编程语言和软件更新和开发新的编程库和包，以促进这些算法的实现和执行。</p><p id="20e7" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">处理不平衡数据集并选择最合适的重采样技术是数据科学项目中的重要一步。适当的重采样技术选择可以导致更可靠的机器学习模型，而不适当的选择可能导致机器学习模型的偏差，不能预测准确的结果。本文展示了一种为给定数据集决定最佳重采样技术的方法。</p><p id="c172" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">Python 代表了一种伟大的免费开源编程语言，能够执行广泛的机器学习、人工智能、数据科学和数据分析任务。它最受欢迎的一些机器学习和深度学习库包括 scikit-learn、TensorFlow、Keras、PyTorch、Pandas 和 NLTK。数据科学家和分析师必须充分利用这些工具来解决现实生活中的复杂问题和任务，从而为组织、客户或研究领域带来附加值。</p><p id="6c85" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="ot">—</em></p><p id="f283" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="ot">如果你觉得这篇文章有用，欢迎在</em> <a class="ae lh" href="https://github.com/rsalaza4/Data-Resamplers-Comparison/blob/master/Python%20Code/Code.py" rel="noopener ugc nofollow" target="_blank"> <em class="ot"> GitHub </em> </a> <em class="ot">上下载我的个人代码。你也可以直接在 rsalaza4@binghamton.edu 给我发邮件，在</em><a class="ae lh" href="https://www.linkedin.com/in/roberto-salazar-reyna/" rel="noopener ugc nofollow" target="_blank"><em class="ot">LinkedIn</em></a><em class="ot">上找到我。有兴趣了解工程领域的数据分析、数据科学和机器学习应用的更多信息吗？通过访问我的媒体</em> <a class="ae lh" href="https://robertosalazarr.medium.com/" rel="noopener"> <em class="ot">简介</em> </a> <em class="ot">来探索我以前的文章。感谢阅读。</em></p><p id="1a83" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><em class="ot">——罗伯特</em></p></div></div>    
</body>
</html>