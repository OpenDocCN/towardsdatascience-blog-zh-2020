<html>
<head>
<title>Python for Data Journalists: Get Your Data from the Web</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向数据记者的Python:从网络上获取数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-for-data-journalists-get-your-data-from-the-web-c0cee664d17?source=collection_archive---------65-----------------------#2020-05-18">https://towardsdatascience.com/python-for-data-journalists-get-your-data-from-the-web-c0cee664d17?source=collection_archive---------65-----------------------#2020-05-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e36b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Python和Pandas在网络上发现、读取和分析CSV、Excel电子表格中的数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6c83688bf6c8af2810c178cb164b2580.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*zW9gfUAMJB2yAZEv"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@claybanks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">摄于<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的粘土堤岸</a>。所有其他图像由阿兰·琼斯。</p></figure><p id="7ecb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名记者，你的工作是讲述一个故事，让你的读者觉得有吸引力、有娱乐性和知识性。作为一名数据记者，你可以从网上的数据中找到这个故事。你找到数据，研究它，并得出结论，告知你的叙述。也许你还会制作一些有趣的图表或插图。</p><p id="5a22" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你知道去哪里找，并且有检索、处理和分析数据的技能，那么就会有大量的数据存在。</p><p id="6fb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将探索如何找到、读取、分析和可视化这些数据。</p><p id="8279" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更准确地说，我们将:</p><ul class=""><li id="01fa" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><em class="me">使用Python和Pandas从网上读取电子表格文件</em></li><li id="e2d0" class="lv lw it lb b lc mf lf mg li mh lm mi lq mj lu ma mb mc md bi translated"><em class="me">提取我们感兴趣的数据</em></li><li id="02c6" class="lv lw it lb b lc mf lf mg li mh lm mi lq mj lu ma mb mc md bi translated"><em class="me">为我们的特定目的操纵数据</em></li><li id="d914" class="lv lw it lb b lc mf lf mg li mh lm mi lq mj lu ma mb mc md bi translated"><em class="me">探索数据中的关系</em></li><li id="1f55" class="lv lw it lb b lc mf lf mg li mh lm mi lq mj lu ma mb mc md bi translated"><em class="me">画一些说明图</em></li></ul><h2 id="cc97" class="mk ml it bd mm mn mo dn mp mq mr dp ms li mt mu mv lm mw mx my lq mz na nb nc bi translated">开放数据，什么和哪里？</h2><p id="3a3c" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">许多政府和组织开放了他们的数据，任何人都可以访问。例如，美国和英国政府拥有涵盖政府、经济和社会各个方面的公开数据。欧盟也有类似的资源。</p><p id="54ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大型非政府组织以及私营组织也免费或收费提供数据。其中包括世界银行、世界经济论坛、世界卫生组织和联合国。数据也有学术来源。位于英国牛津大学的“我们的数据世界”就是一个很好的例子，美国约翰·霍普金斯大学的新冠肺炎仪表板提供了疫情的最新数据(尽管这些数据不能直接下载)。</p><p id="6c33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果你不确定从哪里开始，一个好的地方是谷歌的公共数据浏览器，你可以在那里搜索特定提供商或特定主题的数据。</p><h1 id="8147" class="ni ml it bd mm nj nk nl mp nm nn no ms jz np ka mv kc nq kd my kf nr kg nb ns bi translated">数据格式</h1><p id="bfdb" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">你会发现数据有多种格式。最常见的可能是可下载的电子表格。这些通常是Excel格式或CSV文件。</p><p id="286a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">API(应用程序编程接口)也是有用的数据源，这些数据通常以CSV或JSON的形式出现。API有时会限制您可以检索的数据，并且通常要求您注册。API使用“免费增值”模式并不罕见，在这种模式下，有限的访问是免费提供的，但如果你想访问大量数据，则需要付费。</p><h1 id="3897" class="ni ml it bd mm nj nk nl mp nm nn no ms jz np ka mv kc nq kd my kf nr kg nb ns bi translated">使用Python和熊猫</h1><p id="4eb2" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我们将看看如何处理不同类型的数据，以及如何使用Python和Pandas来整理、分析和可视化这些数据。</p><p id="18fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了提供一个焦点，我们来看看英国的人口数据。我们将追踪过去几十年人口的增长情况，以及移民对人口的影响(如果有的话)。我们将使用两个不同的数据源，并将它们连接起来，看看这些数字之间是否有任何关系。</p><p id="91f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用网络上的数据只需要很少的编程知识，但是你确实需要对Python和Pandas的基础有一点熟悉，或者至少愿意学习它们。</p><p id="377a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下面的代码中，我将使用Jupyter笔记本(您可以使用标准的Python编辑器或IDE，但我发现Jupyter更容易构建这些简单例程的原型)。</p><p id="b243" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您的计算机上还没有Python工具，我建议您安装Anaconda。有了Anaconda，你可以在一个包中获得Python以及大量有用的库，如Pandas、Jupyter笔记本和代码编辑器。有关如何获取它的说明，请参见下面的文章:</p><div class="nt nu gp gr nv nw"><a rel="noopener follow" target="_blank" href="/setting-up-jupyter-notebooks-for-data-visualisation-e287e2688af6"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">为数据可视化设置Jupyter笔记本</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">Jupyter笔记本是一个伟大的和相当简单的方式来探索数据和创造可视化的互动…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">towardsdatascience.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok ks nw"/></div></div></a></div><h2 id="2421" class="mk ml it bd mm mn mo dn mp mq mr dp ms li mt mu mv lm mw mx my lq mz na nb nc bi translated">入门指南</h2><p id="949a" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">假设你已经准备好了工具，我们就开始吧。</p><p id="f272" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将把每一点代码都呈现为一个Jupyter笔记本代码单元，我建议你也这样做。</p><p id="96e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们需要做的第一件事是输入我们将要使用的Python库。</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="7a7c" class="mk ml it om b gy oq or l os ot">import pandas as pd<br/>import matplotlib.pyplot as plt</span></pre><p id="f289" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这几乎是我们操作数据和产生可视化所需的一组标准库。</p><p id="fe81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果由于某种原因你还没有安装这些，你将需要从命令行安装<em class="me"> conda </em>或<em class="me"> pip </em>，例如</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="adc9" class="mk ml it om b gy oq or l os ot">conda install pandas</span></pre><p id="0ff2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="255e" class="mk ml it om b gy oq or l os ot">pip install pandas</span></pre><p id="d219" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，如果您没有使用Anaconda，您可能需要使用命令<strong class="lb iu"> pip3 </strong>而不是<strong class="lb iu"> pip </strong>进行安装。</p><p id="9924" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从电子表格数据、CSV和Excel文件开始探索。</p><h1 id="bdb2" class="ni ml it bd mm nj nk nl mp nm nn no ms jz np ka mv kc nq kd my kf nr kg nb ns bi translated">CSV和Excel</h1><p id="0b35" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">每当您找到一个为您提供Excel文件下载的数据源时，您通常会发现他们也提供了一个CSV替代文件。对于简单的电子表格，我们使用哪个并不重要。</p><p id="c6a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">尽管如此，CSV文件更容易被人阅读——它们是纯文本表格，表格中的每个值或标题用逗号(或其他字符)分隔。当然，您可以用电子表格打开它们，但是如果需要，您也可以用简单的文本编辑器编辑它们。</p><p id="ca44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，Excel文件是一种专有格式，需要用兼容Excel的电子表格程序来查看或编辑。</p><p id="0fa1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">电子表格文件有时可以直接从url中读取，其他的则必须从浏览器中手动下载。</p><p id="35c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了使我们这里的目的更容易，我已经将我们将要使用的文件复制到一个存储库中，您可以从您的程序中直接访问它。</p><p id="79f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们要看看英国人口在过去50年左右的时间里是如何增长的。我们将使用英国国家统计局的数据。</p><p id="54c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在此下载该文件:</p><p id="daa1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.ons.gov.uk/generator?format=csv&amp;uri=/peoplepopulationandcommunity/populationandmigration/populationestimates/timeseries/ukpop/pop" rel="noopener ugc nofollow" target="_blank">https://www.ons.gov.uk/generator?format=csv&amp;uri =/peoplepulationandcommunity/populationandmigration/populationestimates/time series/uk pop/pop</a></p><p id="4246" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将其保存在与笔记本或程序相同的目录中。</p><p id="519a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的程序片段将该数据加载到Pandas数据帧中。真正的工作由<strong class="lb iu"> pd.read_csv </strong>完成，它从您的目录中读取文件，第二行显示表格的前10行。</p><p id="34e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我下载这个文件时，它被命名为series-100520.csv</p><p id="a597" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，当<strong class="lb iu">你</strong>下载文件时，你可能会得到一个反映你下载日期的文件名。所以检查文件名并适当调整代码。</p><p id="9213" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码如下:</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="2a2e" class="mk ml it om b gy oq or l os ot">data = pd.read_csv(‘series-100520.csv’)<br/>data.head(10)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/1c6f56714732214d38b73de9ab103f94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/0*nA-r9i2B-7aLcQX2"/></div></figure><p id="6c2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，现在我们有了从CSV文件加载的数据帧，我们已经执行了命令<em class="me"> data.head(10) </em>，它显示了数据表的前10行。它基本上由两列组成:年份和那一年的人口，但是包含了一些关于文件的注释。</p><p id="a382" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是问题。这些额外的行可能对人类读者有用，但对我们的分析并不十分有用。此外，我们希望这两列的标题有意义。也许我们可以称它们为“年”和“流行”。</p><p id="c874" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这很容易解决。我们只是跳过头几行，标题和编号为0到6的行，自己定义标题是什么。</p><p id="5528" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是再次读取该文件的代码，但是添加了一些额外的参数，这将完全符合我们的要求。</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="6636" class="mk ml it om b gy oq or l os ot">data=pd.read_csv(‘series-100520.csv’,skiprows=8,names=[‘Year’,’Pop’], index_col=0)</span><span id="618d" class="mk ml it om b gy ov or l os ot">data.head(10)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/1659cfae4827496b91021514a96e6b2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:310/0*YM5KERv5Zg68WUQj"/></div></figure><p id="2e42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那更好。一个简单的表，有两列和合理的列标题。我们告诉Pandas，我们将使用第一列作为数据帧的索引(否则Pandas将添加一个额外的编号索引)。</p><p id="fa76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们可以用它做一些有用的事情。例如，我们可以画一个这样的图。</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="3c68" class="mk ml it om b gy oq or l os ot">data.plot(title=’UK Population in millions, 1970 to 2018', grid=True);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/0c7b7711a67433fd9db72d1efcc18af9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/0*r6wX1wPK-AiID9Dg"/></div></figure><p id="0204" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个简单的线形图，显示了从1971年到2018年的人口增长。代码相当简单明了，我们只需调用<em class="me"> plot </em>函数，它会自动使用索引(年份)作为X轴，并将“Pop”列绘制为Y值。</p><p id="d253" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，在这一时期有一个逐渐上升的增长。</p><p id="70c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一件我们很容易做的事情是查看实际的增长是多少。该表有48行，标记为1971年至2018年，因此我们可以像这样访问人口的第一个值:<em class="me">数据['Pop'][1971] </em>和最后一个像这样的<em class="me">数据['Pop'][2018] </em>。所以人口的变化是一个减去另一个。</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="5978" class="mk ml it om b gy oq or l os ot">data[‘Pop’][2018]- data[‘Pop’][1971]</span></pre><p id="999e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们得到的结果是</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="520a" class="mk ml it om b gy oq or l os ot">10507600</span></pre><p id="6cf0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这比48年前增加了1000多万。或者以百分比表示:</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="d9e5" class="mk ml it om b gy oq or l os ot">percentageIncrease = round((data[‘Pop’][2018]- data[‘Pop’][1971])/data[‘Pop’][1971]*100,2)</span><span id="fe41" class="mk ml it om b gy ov or l os ot">print(‘The UK population has increased by’, percentageIncrease,’% from 1971 to 2018')</span></pre><p id="3f9d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从中我们可以得到</p><p id="bbee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从1971年到2018年，英国人口增长了18.79%</p><p id="89fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以现在我们知道有多少人生活在英国，以及在过去的几十年里人口是如何增长的。</p><h1 id="0372" class="ni ml it bd mm nj nk nl mp nm nn no ms jz np ka mv kc nq kd my kf nr kg nb ns bi translated">移居</h1><p id="c9ac" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">现在我们将使用来自下议院图书馆的不同数据源。根据开放议会许可，这些数据可以免费下载，您可以在这里找到:</p><p id="1486" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://www.parliament.uk/site-information/copyright/open-parliament-licence/" rel="noopener ugc nofollow" target="_blank">https://www . parliament . uk/site-information/copyright/open-parliament-licence/</a></p><p id="47f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这次数据是以Excel电子表格的形式出现的。这类似于读取CSV文件，但是我们可以指定的参数有一些不同。例如，这个电子表格中有许多不同的工作表，为了将它读入熊猫数据帧，我们需要指定哪一个。</p><p id="3d38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们感兴趣的工作表叫做“摘要”。</p><p id="5875" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以从这个网址下载文件</p><p id="875c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="http://researchbriefings.files.parliament.uk/documents/SN06077/CBP06077-data.xlsx" rel="noopener ugc nofollow" target="_blank">http://research briefings . files . parliament . uk/documents/sn 06077/CBP 06077-data . xlsx</a></p><p id="4595" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">和以前一样，保存在您的工作目录中。</p><p id="7539" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，该文件包含几行没有用的内容，所以我们将标题指定为第2行，将索引作为第一列(和前面一样)，并跳过表的最后10行(使用<em class="me"> skipfooter </em>)。</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="7e22" class="mk ml it om b gy oq or l os ot">immData=pd.read_excel(‘CBP06077-data.xlsx’,sheet_name=’Summary’,index_col=1,header=2, skipfooter=10)</span><span id="3d88" class="mk ml it om b gy ov or l os ot">immData.head(10)</span></pre><p id="a3eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">生成的数据帧如下图所示。还可以，但是有一些我们不需要的列。不过，这没有太大关系，因为我们要做的是将我们感兴趣的数据复制到保存人口数据的原始数据帧中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/4ee575a92681fb16e1ca086d665416a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YKenNqsbf1yhjNYy"/></div></div></figure><p id="d68f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本质上，我们将复制用于<em class="me">净迁移</em>的列的一部分，并将其粘贴到dataframe <em class="me">数据</em>中的新列中。</p><p id="08a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我们使用一个名为<em class="me"> iloc </em>的函数。这允许我们使用行和列的位置来选择数据帧的矩形部分。<em class="me">例如，iloc[x，y] </em>会从列<em class="me"> y </em>中选择行<em class="me"> x </em>。</p><p id="418d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是<em class="me"> x </em>和<em class="me"> y </em>可以是范围，所以<em class="me"> iloc[x1:x2，y1:y2 </em>会为列<em class="me"> y1 </em>到<em class="me"> y2选择行<em class="me"> x1 </em>到<em class="me"> x2 </em>。</em></p><p id="3414" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更具体地说，代码<em class="me"> immData.iloc[0:10，2:4] </em>将选择<em class="me"> immData </em>的一部分，从第0行到第10行，从第2列到第4列。或者<em class="me"> iloc[0:10，5] </em>将选择第1行到第10行，但只选择第5列。</p><p id="8123" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们想要的是第5列的<em class="me">净迁移</em>，但是因为我们想要将其粘贴到<em class="me">数据</em>数据帧中，所以它需要与<em class="me">数据</em>的大小相同，所以我们只想要1971年到2018年的数字。1971是第8行，2018是从表格底部向上一行，我们可以将此选择表示为<em class="me"> [8:-1，5] </em>，其中-1表示“从最后一行向后一行”。</p><p id="70be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将在<em class="me">数据</em> calle <em class="me"> Imm </em>中创建一个新列，并将<em class="me"> iloc </em> ed副本粘贴到其中，如下所示:</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="1def" class="mk ml it om b gy oq or l os ot">data[‘Imm’]=immData.iloc[8:-1,5]*1000</span><span id="8d28" class="mk ml it om b gy ov or l os ot">data.head(10)</span></pre><p id="e3dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果是添加了新列的原始表。我们将移民数据乘以1000，得到与人口数据相同的形式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/1dfa0d9fe8745e45f9076c0344f2e1b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/0*dB3Uycl5lS9ZN4FV"/></div></figure><p id="1226" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用图表来描绘移民的增长。这与我们之前看到的非常相似，但是我们将Y值指定为“Imm”。</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="ac6a" class="mk ml it om b gy oq or l os ot">data.plot(y=’Imm’)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/2a939eb92a4302ca233d16beeadd0000.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/0*JUVRBiGebbG967ll"/></div></figure><p id="a10c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到，尽管有起有落，但在此期间，英国的净移民一直在增加。</p><p id="7217" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可能做的另一件有趣的事情是将移民数字表示为总人口的百分比。在这里，我们创建另一个新列，并用百分比填充它。</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="1a79" class="mk ml it om b gy oq or l os ot">data[‘Imm as % of Pop’] = data[‘Imm’]/data[‘Pop’]*100</span><span id="f347" class="mk ml it om b gy ov or l os ot">data</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/92ee3d00ab84b0186c2465e3c2ea1d6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/0*_Ht9uQX3HZ35rcbo"/></div></figure><p id="2d9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到，作为总人口的一个百分比，移民增加的百分比相当小。但这一比例也在上升。</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="8a6e" class="mk ml it om b gy oq or l os ot">data.plot(y=’Imm as % of Pop’)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/d80f1ffeebf01ad34f0d5b3dcc648d1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/0*fT7fjA0bepr8bg49"/></div></figure><p id="7b0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以看起来每年的移民数量和总人口数量之间可能有关系。让我们通过绘制总人口和移民水平的散点图来对此进行研究。</p><pre class="kj kk kl km gt ol om on oo aw op bi"><span id="1f78" class="mk ml it om b gy oq or l os ot">data.plot.scatter(x=’Pop’,y=’Imm’)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/53ea02ed6e826594dd6401cd730ec82a.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/0*i48GvJT1SBosTrft"/></div></figure><p id="2e24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">嗯，是的，似乎有一个线性的关系。随着人口的增加，移民也在增加。</p><p id="dec8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于移民导致的总人口增长看起来很小，所以一定还有其他原因。也许移民越多，移民就越多，因为现在的移民往往会带着他们的家人一起生活。我们没有考虑过这种关系，也不会考虑！</p><h1 id="7d85" class="ni ml it bd mm nj nk nl mp nm nn no ms jz np ka mv kc nq kd my kf nr kg nb ns bi translated">我们的目标</h1><p id="a909" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">我认为我们已经达到了这篇文章的目标。我们已经了解了如何下载和读取CSV文件或Excel电子表格形式的数据。我们对这些数据进行了处理，以提供一些可能值得研究的信息，我们还研究了不同数据之间的关系。我们还绘制了一些说明性的图表。</p><p id="6aaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这是有用的，你会发现这里使用的技术与你未来的工作相关。感谢阅读。</p></div><div class="ab cl pe pf hx pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="im in io ip iq"><p id="ea2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里找到更多关于绘制熊猫图的信息:</p><div class="nt nu gp gr nv nw"><a rel="noopener follow" target="_blank" href="/plotting-with-pandas-an-introduction-to-data-visualization-8bd7c0831650"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd iu gy z fp ob fr fs oc fu fw is bi translated">用熊猫绘图:数据可视化导论</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">如果您是一名初露头角的数据科学家或数据记者，能够可视化您的数据会让您有能力…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">towardsdatascience.com</p></div></div><div class="of l"><div class="pl l oh oi oj of ok ks nw"/></div></div></a></div></div></div>    
</body>
</html>