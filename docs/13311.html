<html>
<head>
<title>Understanding the ROC Curve and AUC</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解 ROC 曲线和 AUC</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-the-roc-curve-and-auc-dd4f9a192ecb?source=collection_archive---------1-----------------------#2020-09-13">https://towardsdatascience.com/understanding-the-roc-curve-and-auc-dd4f9a192ecb?source=collection_archive---------1-----------------------#2020-09-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e32e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这些二进制分类性能指标是相辅相成的——让我们来探索一下。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/540b3c90dc04a4fb1ebe8d7d6f40f691.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9HVRlY8PcoPLOHLt"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马德琳·佩雷在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h2 id="4246" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">ROC 曲线</h2><p id="7e2b" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated"><strong class="me iu">接收机工作特性(ROC)曲线</strong>经常用于评估二元分类算法的性能。它提供了分类器性能的图形表示，而不是像大多数其他指标那样提供单一值。</p><p id="54f6" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">首先，让我们确定在二元分类中，一个测试预测有四种可能的结果:<strong class="me iu">真阳性</strong>、<strong class="me iu">假阳性</strong>、<strong class="me iu">真阴性</strong>和<strong class="me iu">假阴性</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/86e3374ed20be265d60377d7b8246723.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7NVPwda0vt4obd_Q01t9Rw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">二元分类问题的混淆矩阵结构</p></figure><p id="5611" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">ROC 曲线是通过计算和绘制单个分类器在各种<strong class="me iu">阈值</strong>下的<strong class="me iu">真阳性率</strong>与<strong class="me iu">假阳性率</strong>而产生的。例如，在逻辑回归中，阈值将是属于正类的观察的预测概率。通常在逻辑回归中，如果一个观察值以 0.5 的概率被预测为正，则它被标记为正。然而，我们实际上可以选择 0 到 1 之间的任何阈值(0.1、0.3、0.6、0.99 等)。)ROC 曲线帮助我们直观地了解这些选择如何影响分类器的性能。</p><p id="7c2b" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><strong class="me iu">真阳性率</strong>，或<strong class="me iu">灵敏度</strong>，可表示为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/8f8b3fc4312b4688be38939236e53f01.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*wo6tyY0ZZWYxxe7gOWsQdw.png"/></div></figure><p id="2339" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">其中<strong class="me iu"> TP </strong>是<strong class="me iu">真阳性</strong>的数量，<strong class="me iu"> FN </strong>是<strong class="me iu">假阴性</strong>的数量。真实阳性率是对一个<em class="nc">实际</em>阳性实例被归类为阳性的概率的度量。</p><p id="a72e" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><strong class="me iu">假阳性率</strong>，或者 1 — <strong class="me iu">特异性</strong>，可以写成:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/04d1a0d3b61b1e983909b080337769ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*vhGYw-cuJjo-C8rl9pM_nA.png"/></div></figure><p id="65b4" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">其中<strong class="me iu"> FP </strong>是<strong class="me iu">假阳性</strong>的数量，<strong class="me iu"> TN </strong>是<strong class="me iu">真阴性</strong>的数量。假阳性率本质上是衡量“假警报”发生的频率——或者说，实际的<em class="nc">阴性实例被归类为阳性的频率。</em></p><p id="f598" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">图 1 展示了一些理论分类器如何绘制 ROC 曲线。灰色虚线表示不比随机猜测更好的分类器—这将绘制为对角线。紫色线代表一个完美的分类器——真阳性率为 100%，假阳性率为 0%。几乎所有真实世界的例子都会落在这两条线之间——不完美，但比随机猜测提供了更多的预测能力。通常，我们寻找的是一种保持高真阳性率同时又具有低假阳性率的分类器，这种理想的分类器将“拥抱”图 1 的左上角，很像紫色线。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/7258295abb3db2aea27ce4751b01b121.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b3ayb4TkvOdsNdDmJVQG1g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 1 —一些理论 ROC 曲线</p></figure><h2 id="1b44" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">罗马纪元</h2><p id="37fd" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated">虽然可视化分类器的 ROC 曲线很有用，但在许多情况下，我们可以将这些信息归结为一个单一的指标—<strong class="me iu"/>AUC。</p><p id="04a2" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><strong class="me iu"> AUC </strong>代表(ROC)曲线下的<strong class="me iu">面积。</strong>通常，AUC 分数越高，分类器对给定任务的表现越好。</p><p id="768a" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">图 2 显示，对于没有预测能力(即随机猜测)的分类器，AUC = 0.5，对于完美的分类器，AUC = 1.0。大多数分类器将落在 0.5 和 1.0 之间，少数例外是分类器表现<em class="nc">比随机猜测差</em>(AUC&lt;0.5)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/38a18c3c897efe697a6bdedd9e5ce666.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hKGhMjKBGV9Kgky_SbBvzw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 2-具有 AUC 分数的理论 ROC 曲线</p></figure><h2 id="f18e" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">为什么要用 ROC 曲线？</h2><p id="4451" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated">ROC 曲线呈现的一个优点是，它们帮助我们找到适合我们具体问题的分类阈值。</p><p id="0541" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">例如，如果我们正在评估一个垃圾邮件分类器，我们希望假阳性率非常非常低。我们不希望有人仅仅因为我们的算法过于激进，就因为垃圾邮件过滤器而丢失了一封重要的电子邮件。我们甚至可能允许相当数量的实际垃圾邮件通过过滤器，以确保没有重要的邮件丢失。</p><p id="7947" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">另一方面，如果我们的分类器预测某人是否患有绝症，我们可能会接受更多的假阳性(错误诊断疾病)，只是为了确保我们不会错过任何真正的阳性(实际患病的人)。</p><p id="359f" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">此外，ROC 曲线和 AUC 分数还允许我们比较不同分类器对同一问题的性能。</p><h2 id="04e1" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">例如:心脏病预测</h2><p id="33f0" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated">为了演示 ROC 曲线在实践中是如何构建的，我将使用 Python 中的<a class="ae ky" href="https://www.kaggle.com/ronitf/heart-disease-uci" rel="noopener ugc nofollow" target="_blank">心脏病 UCI </a>数据集。该数据集有 14 个属性，303 个观察值，通常用于根据其他 13 个属性(包括年龄、性别、胆固醇水平和其他测量值)预测患者是否患有心脏病。</p><p id="3340" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><strong class="me iu">导入&amp;装载数据</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/2605021faf2c6a36a0281e6e66f76b2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*fNk1FQOejJBuXwnXqpzirQ.png"/></div></figure><p id="7aa7" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><strong class="me iu">列车测试分割</strong></p><p id="7b0e" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">对于这个分析，我将使用标准的 75% — 25%训练测试分割。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="cac8" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><strong class="me iu">逻辑回归分类器</strong></p><p id="8d45" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">在编写计算假阳性率和真阳性率的函数之前，我将对训练数据拟合一个普通的逻辑回归分类器，并对测试集进行预测。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="cf47" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><strong class="me iu">计算真阳性率和假阳性率</strong></p><p id="5139" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">现在我有了测试预测，我可以写一个函数来计算真阳性率和假阳性率。这是关键的一步，因为这是制作 ROC 曲线所需的两个变量。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="cc03" class="lg lh it ni b gy nm nn l no np">(0.6923076923076923, 0.1891891891891892)</span></pre><p id="64ca" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">测试表明，该功能似乎正在工作——69%的真阳性率和 19%的假阳性率是完全合理的结果。</p><p id="0487" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><strong class="me iu">探索不同的阈值</strong></p><p id="103e" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">为了获得 ROC 曲线，我需要一对以上的真阳性/假阳性率。我需要改变逻辑回归分类器用来预测患者是否患有心脏病(目标=1)的<strong class="me iu">阈值概率</strong>。请记住，虽然逻辑回归用于分配类别标签，但是<em class="nc">实际上</em>所做的是确定观察值属于特定类别的<em class="nc">概率</em>。在典型的二进制分类问题中，一个观察值必须有 0.5 的概率被分配到正类。然而，在这种情况下，我将从 0 到 1 递增地改变阈值概率值。这将导致真阳性率和假阳性率的范围，允许我建立 ROC 曲线。</p><p id="ee91" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">在下面的代码块中，我在一系列阈值概率值范围内获得了这些真阳性率和假阳性率。为了比较，我使用逻辑回归与(1)没有正则化和(2) L2 正则化。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="c59b" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><strong class="me iu">绘制 ROC 曲线</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/22d5c8815b10871d5521b383808195ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*A3uxes_njdqZ_qhQ_LNfYw.png"/></div></figure><p id="8380" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">逻辑回归分类器的两个版本似乎都做得很好，但 L2 正则化版本似乎表现得稍好。</p><p id="8b60" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><strong class="me iu">计算 AUC 分数</strong></p><p id="ce58" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><strong class="me iu"> sklearn </strong>有一个<strong class="me iu"> auc() </strong>函数，我将在这里使用它来计算两个版本的分类器的 auc 分数。<strong class="me iu"> auc() </strong>接受我们之前计算的真阳性率和假阳性率，并返回 auc 分数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="010a" class="lg lh it ni b gy nm nn l no np">Logistic Regression (No reg.) AUC 0.902979902979903<br/>Logistic Regression (L2 reg.) AUC 0.9116424116424116</span></pre><p id="1855" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">正如所料，两个分类器都有相似的 AUC 分数，L2 正则化版本表现稍好。</p><h2 id="afc7" class="lg lh it bd li lj lk dn ll lm ln dp lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">ROC 曲线和 AUC 的简单方法</h2><p id="dd7a" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk lp ml mm mn lt mo mp mq lx mr ms mt mu im bi translated">既然我们已经从头开始有趣地绘制了这些 ROC 曲线，您将会松一口气，因为知道有一个非常非常简单的方法。<strong class="me iu"> sklearn </strong>的<strong class="me iu"> plot_roc_curve() </strong>函数可以仅使用拟合的分类器和测试数据作为输入，高效地绘制 roc 曲线。这些图也方便地包括 AUC 分数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/4202910a61bfb005ea0a9da092804018.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*--QlY_MNn33ZDnbJzvDYXA.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/eef272e6d368dc57cc2ac3d045574e0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*nmLXMStLKg7xCmlhZpUf-A.png"/></div></figure><p id="bbd0" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><strong class="me iu">关闭</strong></p><p id="6098" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated">如果你已经做到这一步，感谢你的阅读！我发现在 Python 中低效地创建自己的 ROC 曲线是一项有价值的练习，我希望您能从本文中有所收获。</p><p id="a93c" class="pw-post-body-paragraph mc md it me b mf mv ju mh mi mw jx mk lp mx mm mn lt my mp mq lx mz ms mt mu im bi translated"><strong class="me iu">ROC 和 AUC 的一些有用参考:</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nr nf l"/></div></figure><div class="ns nt gp gr nu nv"><a href="https://machinelearningmastery.com/assessing-comparing-classifier-performance-roc-curves-2/" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">用 ROC 曲线评估和比较分类器性能-机器学习掌握</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">最常报道的分类器性能的度量是准确度:正确分类的百分比…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">machinelearningmastery.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj ks nv"/></div></div></a></div><div class="ns nt gp gr nu nv"><a href="http://faculty.marshall.usc.edu/gareth-james/ISL/" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd iu gy z fp oa fr fs ob fu fw is bi translated">统计学习导论</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">加雷思·詹姆斯、丹妮拉·威滕、特雷弗·哈斯蒂和罗伯特·蒂布拉尼家中的应用程序</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">faculty.marshall.usc.edu</p></div></div><div class="oe l"><div class="ok l og oh oi oe oj ks nv"/></div></div></a></div></div></div>    
</body>
</html>