# 隆起建模:快速介绍

> 原文：<https://towardsdatascience.com/a-quick-uplift-modeling-introduction-6e14de32bfe0?source=collection_archive---------3----------------------->

## *了解提升建模如何改善传统数据科学应用。*

![](img/fa9d3eb26facd06f03e94217d1a25579.png)

摄影爱好者:[摄影工作室](https://www.shutterstock.com/g/Vectortone)

# **简介**

*本文涵盖了隆起建模背后的思想。*

到本文结束时，你将会很容易向别人解释隆起建模是什么。

这是隆起建模系列的第一篇文章。

1.  隆起建模:快速介绍
2.  使用 Python 的应用隆起建模示例(即将推出)
3.  通过提升建模引领优化示例(即将推出)
4.  不同提升技术的比较(即将推出)
5.  隆起建模的 5 个技巧(即将推出)
6.  端到端提升建模项目(即将推出)

# **问题介绍**

*我们从一个实际应用开始，然后概括提升建模如何对任何行业和业务单位有用。*

一家保险公司正在根据收集到的订单将前一天的新线索分配给保险代理人。通过呼出电话营销活动，代理可以将 5%的销售线索转化为销售额。

该公司已经意识到，他们现在一天产生的销售线索比代理能够工作的还要多。还有一种感觉是，很多线索都是浪费时间。

为了更好地实现数据驱动，该公司的数据科学团队希望优化处理线索的顺序。利用从网站上收集的线索数据，他们建立了一个模型，对每条线索转化为销售的可能性进行评分。

这样，代理可以在每天开始时密切关注最有机会在未来转化为销售的销售线索。他们还可以避免在很可能永远不会促成销售的线索上浪费时间。

该模型投入生产后，公司发现代理商现在将 10%的工作线索转化为销售。这是对旧操作的 100%改进！

我们需要休息一下！还没有击掌…

这个数据科学项目有一个重大缺陷。

这个项目看似成功，但你如何知道呼出电话营销活动**是否导致了**客户的转变？这可能只是樱桃采摘容易获胜。

换句话说，倾向模型所做的只是收集最有可能转化为销售的线索。它没有将已经打算购买的客户与需要通过呼出电话说服的客户区分开来。

欢迎来到隆起建模的世界——因果推理和机器学习之间的桥梁。上面的案例研究忘记考虑的是说服、渐进或外向销售活动的真实效果。

# 隆起建模

*那么隆起建模是如何工作的呢？*

上一节强调的购买倾向模型使用机器学习来回答这个问题:

*“客户将来购买的可能性有多大？”*

隆起建模通过回答更重要的问题对此进行了改进:

*   *“我的广告让顾客从我这里购买了吗？”*
*   *“我是不是浪费钱向已经打算从我这里购买的顾客做广告？”*
*   *我的广告是否降低了人们购买的可能性(负面影响)？*

换句话说，经典倾向模型(和大多数机器学习算法)在给定特征(x)的情况下预测目标(y)。在给定特征(x)的情况下，提升旨在解决处理(t)对目标(y)的影响。

隆起建模通常用四个客户群来解释(Siegel 2011 年):

![](img/bcb3f3a6328177280be58923e9456645.png)

1.无论什么(确定的东西)都会购买的人

2.只有在看到广告时才会购买的人(有说服力)

3.无论如何**都不会**购买的人(失败原因)

4.如果看到广告，那些**不会**购买的人(睡狗)

倾向模型通过帮助你避免失败的原因来增加价值。提升建模通过只关注可说服细分市场中的客户，进一步提高了针对性。

![](img/44965826d0f5c3178198420b96366212.png)

# **常见应用**

*这如何应用于任何业务单位或行业？*

**政治竞选:**

提升建模已被用于识别和锁定持观望态度的选民( [Stedman 2013](https://www.predictiveanalyticsworld.com/machinelearningtimes/how-uplift-modeling-helped-obamas-campaign-and-can-aid-marketers/2613/) )。通过利用提升模型，政治营销活动可以避免那些对他们的政党死心塌地的人，而是只关注可说服的人。

**一种新的健康疗法:**

不仅仅是评估整个治疗组与对照组的结果，隆起建模可以帮助理解治疗如何不同地影响某些组。还有，这些影响的差异有多大。

也许这种治疗对 50 岁以上有潜在健康问题的人有很大的积极影响，但对 50 岁以下健康的人影响不大。

**销售线索优化:**(这听起来应该很熟悉)

一家公司有销售线索数据库，但他们生成的销售线索比能够处理的还要多，而且许多销售线索都是浪费时间，目前代理可以按照他们选择的任何顺序处理销售线索。

**交叉销售:**

一家公司想要开展交叉销售活动，假设他们不想向他们的整个客户群进行交叉销售，因为预算有限，一些人可能不需要或不想要其他产品。

**保留:**

一家公司希望接触到即将流失的客户，并拯救他们。该公司希望在接触客户时防止进一步扰乱客户，并只关注高风险的可挽救客户。

**用户体验测试:**

一家公司希望了解他们网站或应用程序的更改是否产生了预期的结果。

# **常用技法**

在一个快速发展的空间里，我觉得技术目前可以分成三大支柱。

![](img/9a31f84855a2839ad488f6a2764c9245.png)

**传统倾向模型**

这实际上不是一个提升模型，但需要包括在内，因为这是解决提升问题的经典方法。该算法通常是像逻辑回归这样的分类器。这些算法可以输出 0 到 1 的概率，用于对观众进行排序。那么可以选择一个阈值(可能 0.70 的概率或更大)作为那些应该接受治疗的人的截止值。

**直接提升型号**

这个支柱代表的技术和算法可以让你直接模拟治疗效果。它需要像随机森林这样的算法完全重新设计，以进行特征选择、超参数调整，并适合解决给定(x)时(t)对(y)的影响。像 Scikit-learn 这样的包中的典型算法不能做到这一点。您可以使用 R 的包提升和 Python 的 CausalML 来实现提升树。

**元学习者**

最后一个支柱代表可用于对提升建模的技术和算法，但使用某种快捷方式来获得提升的代理。代理方法在大多数应用中是有用的，并且这些快捷方式通常在速度和/或简单性方面提供好处。

似乎有许多技术，所以下面的列表绝不是全面的。根据您要去的地方，似乎也有不同的方法来实现这些技术。

![](img/d150aa2ee2e9bb6be23f6bc30c2e53b7.png)

# **隆起建模的当前挑战**

*为什么隆起建模会很棘手。*

1.  除非数据是合成的，否则真相标签是不可用的。

在机器学习中，通常有特征(帮助预测的输入)和基本事实标签(预测的目标)。

在隆起建模中，地面真相是永远不可用的，因为个人不能既看到又看不到广告。因果推理模拟了没有发生的场景，因此有可能估计地面真相标签，并将其视为机器学习问题。

因为基本事实标签不可用，这使得测量和验证不太直接。通常，您可以通过比较预测值和实际值来了解模型的表现。在提升建模中，您可以通过与估计的实际值进行比较来了解模型的表现。

生成用于验证的合成数据的优势在于，它可以被构建为模拟两种场景。这样，不同的技术可以更清楚地评估，以选择一个赢家。然而，合成数据可能永远不会完美地反映您想要提升模型的真实世界数据。

2.像 Scikit-learn 这样高度优化的包并不是为了解决升级而设置的。

如前所述，机器学习算法被设置为在给定特征(x)的情况下预测目标(y)。直接建模需要调整算法和整个机器学习管道。功能选择、型号选择、超参数调整以及与 Scikit-learn 等优化包的匹配并不简单。

目前，(在撰写本文时)直接方法是可用的，但即使在小数据集上也很慢。

3.事物和技术的名称是无组织无共识的。

为了证明这一点，就连隆起建模的名称也会因观察地点的不同而有所变化:

*   评估异质性治疗效果([例](https://arxiv.org/abs/1706.03461)
*   增量响应建模([示例](https://blogs.sas.com/content/subconsciousmusings/2013/07/12/how-incremental-response-modeling-can-help-you-reach-the-right-target-group-more-precisely/)
*   净得分([例](https://www.springer.com/gp/book/9783030226244))
*   真实响应建模([示例](http://www.bigdatanalysis.com/response-modeling/))

根据我自己的研究，我不确定是否有一个全面的技术列表或关于如何实现每种技术的共识。

# 资源

*重新列出我自己的收藏，然后还有其他值得注意的链接。*

这是隆起建模系列的第一篇文章。

1.  快速提升建模简介
2.  使用 Python 的应用隆起建模示例(即将推出)
3.  通过提升建模引领优化示例(即将推出)
4.  不同升级产品包的比较(即将推出)
5.  隆起建模的 5 个技巧(即将推出)
6.  端到端提升建模项目(即将推出)

**推荐包:**

[CasualML:优步开发的提升建模 Python 包](https://causalml.readthedocs.io/en/latest/about.html)

[Pylift 提升元学习者 Python 包](https://tech.wayfair.com/data-science/2018/10/pylift-a-fast-python-package-for-uplift-modeling/)

[R 隆起包](https://www.rdocumentation.org/packages/uplift/versions/0.3.5)

[负鼠:创建合成隆起数据集的 Python 包](https://humboldt-wi.github.io/blog/research/applied_predictive_modeling_19/data_generating_process_blogpost/)

**参考文献:**

[费，g .(2019 . 10 . 29)。直接建模抬升:以 KL 散度和欧氏距离为分裂准则的抬升决策树。](https://tech.wayfair.com/data-science/2019/10/modeling-uplift-directly-uplift-decision-tree-with-kl-divergence-and-euclidean-distance-as-splitting-criteria/)

[古铁雷斯，P. &杰勒迪，J. (2016)。因果推理和隆起模型:文献综述。 *JMLR:研讨会和会议记录 67:1–13*](http://proceedings.mlr.press/v67/gutierrez17a/gutierrez17a.pdf)

[昆泽尔、塞孔、比克尔和于(2019)利用机器学习评估异质治疗效果的金属学者。*美国国家科学院院刊*，116(10):4156–4165](https://arxiv.org/abs/1706.03461)

[米歇尔·雷内，施纳肯伯格，I .，&马滕斯，t .冯。(2019).*目标提升:净得分介绍*。查姆:斯普林格国际出版公司。](https://www.springer.com/gp/book/9783030226244)

[西格尔，E. (2011 年 10 月 19 日)。通过预测来优化营销影响力。](https://www.predictiveanalyticsworld.com/newyork/2011/presentations/pdf/DAY1_0900_siegel-web.pdf)

斯特德曼，C. (2013 年 11 月 11 日)。提升建模如何帮助奥巴马的竞选——以及如何帮助营销人员——机器学习时代——机器学习&数据科学新闻。

[易，r .&弗罗斯特，w .(2019 . 2 . 7)。Pylift:用于隆起建模的快速 Python 包。](https://tech.wayfair.com/data-science/2018/10/pylift-a-fast-python-package-for-uplift-modeling/)