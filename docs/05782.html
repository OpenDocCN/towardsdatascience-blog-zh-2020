<html>
<head>
<title>Accuracy vs. Cost-sensitive approach vs. ROC curve for Imbalanced Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不平衡数据集的精确度与成本敏感方法和ROC曲线</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/optimizing-logistic-regression-with-different-cutoff-values-174b6e56ea8d?source=collection_archive---------29-----------------------#2020-05-13">https://towardsdatascience.com/optimizing-logistic-regression-with-different-cutoff-values-174b6e56ea8d?source=collection_archive---------29-----------------------#2020-05-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="909e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><strong class="ak">用不同的截止值优化逻辑回归</strong></h2></div><p id="a055" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">逻辑回归是一种非常适合二分类问题的技术。在给定输入预测值的情况下，该模型计算可确定每个观测值类别的概率。在这项研究中，我们调查了不平衡数据的模型性能评估指标，重点是选择逻辑回归的最佳临界值。我们将逻辑回归应用于甲状腺数据(收集自UCI机器学习库)，以检验该模型在不同临界值下的表现[1]。</p><p id="d49a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">甲状腺数据集包含3，772个观察值和53个属性，包括解释患者状态(1:患者有甲状腺，0:患者没有甲状腺)的目标变量。数据集是不平衡的，因为近94%的观测值在类0中，而类1包含剩余的观测值。图1显示了数据集的不平衡类别分布。我们应用70%: 30%的比率将数据分成训练和测试数据，同时保持类别分布。数据集中的变量比例不同。因此，训练和测试数据都利用<em class="le"> z分数</em>标准化技术进行了标准化。在标准化测试数据的过程中，我们使用了为训练数据计算的参数(平均值和标准偏差)。最后，将训练数据输入逻辑回归算法来训练模型，并利用测试数据进行预测。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/952a8c37e978ebc2436df2c204cbf029.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/0*tKeUjcyJgk1EY1bJ.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图1:甲状腺数据的类别分布</p></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/5f111b4920b27fa24defa8ada2c5e5d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/0*0xwmwPCfp1EQV93v.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图2:不同临界值的精确度</p></figure><p id="2744" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">逻辑回归的预测是每个观察值的后验概率[2]。因此，可以将截止值应用于计算的概率，以对观察值进行分类。例如，如果考虑截止值<em class="le"> t </em>，那么大于或等于<em class="le"> t </em>的分数被分类为1级，而小于<em class="le"> t </em>的分数被分类为0级。图2示出了对于范围从0.0到1.0的不同截止值的模型的精确度。该模型的精度越来越高，直到在0.4的截止值达到其最大值96.37%。从0.4的临界值开始，模型的准确性下降，并且没有显示出改善的迹象。</p><p id="8c21" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">图3示出了混淆矩阵的不同结果，例如真阳性(TP)、假阳性(FP)、假阴性(FN)和真阴性(TN ),具有范围从0.0到1.0的不同截止值。它展示了我们在选择合理的截止值时所经历的权衡。如果我们增加截止值，那么1) TN增加，TP减少，2) FN增加，FP减少。因此，对于0.4的截止值，我们可以实现更好的准确性，但是假阴性的数量仍然相对较高。此外，如果我们将测试数据中的所有观察结果分类为负面(0类)，我们仍然可以达到94%的准确性，这与模型的准确性相对接近。因此，考虑到不平衡的数据集，精确度不是一个好的性能指标。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/68c4aac8ad02069971b1cfc3880c8952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/0*oU--qLAPOaRiNESI.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图3:不同临界值的混淆矩阵结果</p></figure><p id="12d0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">成本敏感方法</strong>在这个分类问题中，假阴性意味着一个人是甲状腺患者，但我们的模型未能检测到它，另一方面，假阳性意味着模型将这个人分类为患有甲状腺，而他没有。因此，假阴性会导致严重的后果，如不正确的治疗过程，因为疾病被忽略了，假阳性会导致不必要的护理。因此，产生假阴性比假阳性代价更高，因此，在这个问题中，最小化假阴性比最小化假阳性更重要。我们研究了不同截断值的假阴性和假阳性之间的最佳权衡。</p><p id="41af" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">成本分析是确定最佳临界值的方法之一。当假阳性和假阴性的成本已知时，在不同的截止值下计算成本，以实现假阳性和假阴性之间的合理平衡[4]。由于这个问题的真实成本是未知的，我们为一个假阴性指定500的成本，为一个假阳性指定100的成本。FN的成本更高，因为它比FP的成本更高。图5示出了与从0到1的各种截止值相关联的成本曲线。当截止值为0.2时，达到最小成本12，000。</p><p id="3452" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> ROC曲线</strong>接收机工作特性(ROC)图对于组织分类器和可视化其性能非常有用【3】。这是所有可能临界值的真阳性率与假阳性率的关系图[4]。图4显示了ROC曲线，该曲线显示了基于范围从0.0到1.0的截止值的正确和不正确决策的所有可能组合。该ROC曲线下的面积为0.887，这通常表明该模型的效率。最好的AUC可能是1，而最差的是0.5(45度随机线)。当给定数据集不平衡时，我们可以利用ROC曲线来检验不同模型的有效性。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/7e790ce6199465703029d2701bf918a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/0*JQgPwiGiBW1dDXJT.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图4: ROC曲线</p></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/379ec243055ecd50fe9871f4f41395c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/0*iyzUlfauP2RaXddw.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图5:利用成本曲线的最佳截止值</p></figure><p id="a78a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">模型性能评估指标在选择最佳模型时起着重要的作用。准确性是模型选择过程中公认的性能指标之一。然而，考虑不平衡数据的指标的局限性要求引入其他测量方法，如成本敏感的最佳临界值和ROC曲线。成本敏感分析可用于寻找最佳截止值，此外，ROC曲线可用于检查模型效率并在给定数据集不平衡时选择最佳模型。</p><p id="c414" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">参考</p><p id="0449" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le"/><a class="ae lv" href="https://archive.ics.uci.edu/ml/index.php" rel="noopener ugc nofollow" target="_blank"><em class="le"/></a></p><p id="1b23" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">【2】</em><a class="ae lv" href="http://ethen8181.github.io/machine-learning/unbalanced/unbalanced.html" rel="noopener ugc nofollow" target="_blank"><em class="le">http://ethen 8181 . github . io/machine-earning/unbalanced/unbalanced . html</em></a></p><p id="356a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">[3]t .福塞特(2004年)。ROC图:研究人员的注意事项和实际考虑。机器学习，31(1)，1–38页。</em></p><p id="b82d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">【4】</em><a class="ae lv" href="https://ncsswpengine.netdnassl.com/wpcontent/themes/ncss/pdf/Procedures/NCSS/One_ROC_Curve_and_Cutoff_Analysis.pdf" rel="noopener ugc nofollow" target="_blank"><em class="le">https://ncsswpengine . net dnassl . com/WP content/themes/NCSs/pdf/Procedures/NCSS/One _ ROC _ Curve _ and _ cut off _ analysis . pdf</em></a></p></div></div>    
</body>
</html>