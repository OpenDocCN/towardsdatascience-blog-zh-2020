<html>
<head>
<title>Wilcoxon test in R: how to compare 2 groups under the non-normality assumption</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R 中的 Wilcoxon 检验:如何在非正态假设下比较两组</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption-6fb7f9e92400?source=collection_archive---------44-----------------------#2020-06-07">https://towardsdatascience.com/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption-6fb7f9e92400?source=collection_archive---------44-----------------------#2020-06-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ca38" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何在 R 中执行学生 t 检验的非参数版本</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e536263fdfb7a51a9953549fc6b3bf87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JrdylUGkS_NcIsrf"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">安妮·斯普拉特的照片</p></figure><h1 id="107e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="5740" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi mn translated"><span class="l mo mp mq bm mr ms mt mu mv di">在</span>之前的一篇文章中，我们展示了<a class="ae ky" href="https://statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/" rel="noopener ugc nofollow" target="_blank">如何使用学生的 t 检验</a>在不同场景下比较两组。学生的 t 检验要求当存在小样本时，分布遵循<a class="ae ky" href="https://statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/" rel="noopener ugc nofollow" target="_blank">正态分布</a>。<a class="ae ky" href="https://statsandr.com/blog/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption/#fn1" rel="noopener ugc nofollow" target="_blank"> 1 </a>在本文中，我们将使用<strong class="lt iu"> Wilcoxon 检验</strong>展示如何<strong class="lt iu">在违反正态假设</strong>的情况下比较两组。</p><p id="4f72" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">Wilcoxon 检验是一种<strong class="lt iu">非参数检验</strong>，这意味着它不依赖于属于任何特定概率分布参数族的数据。非参数测试和参数测试有着相同的目标。然而，它们比参数测试有一个优势:它们<strong class="lt iu">不需要假设分布的正态性</strong>。例如，学生的 t 检验仅适用于数据为高斯分布或样本量足够大的情况(通常 n≥30)。在其他情况下，应该使用非参数。</p><p id="c658" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">有人可能会问，为什么我们不总是使用非参数检验，这样我们就不用担心正态性检验了。原因是当正态假设成立时，非参数检验通常不如相应的参数检验有效。因此，在其他条件相同的情况下，如果数据遵循正态分布，那么在非参数测试中，当<a class="ae ky" href="https://statsandr.com/blog/hypothesis-test-by-hand/#step-1-stating-the-null-and-alternative-hypothesis" rel="noopener ugc nofollow" target="_blank">零假设</a>为假时，您不太可能拒绝该假设。因此，当假设得到满足时，最好使用统计检验的参数版本。</p><p id="859d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在本文的剩余部分，我们将给出 Wilcoxon 测试的两个场景，以及如何通过两个例子在 R 中执行它们。</p><h1 id="c73e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">两种不同的场景</h1><p id="c60e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">至于学生的 t 检验，Wilcoxon 检验用于比较两组，看它们彼此之间是否有显著差异。</p><p id="389f" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">要比较的两个组是:</p><ol class=""><li id="5e92" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">独立，或</li><li id="c036" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">成对的(即从属的)</li></ol><p id="60b1" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">实际上有两种版本的 Wilcoxon 测试:</p><ol class=""><li id="caf0" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">当样本独立时，执行<strong class="lt iu">曼-威-威检验</strong>(也称为威-威秩和检验)(因此该检验是非参数的，相当于学生对独立样本的 t 检验)。</li><li id="2d5f" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">当样本成对/相关时，执行<strong class="lt iu"> Wilcoxon 带符号秩</strong>检验(有时也称为成对样本的 Wilcoxon 检验)(因此该检验是非参数的，相当于学生对成对样本的 t 检验)。</li></ol><p id="32cd" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">幸运的是，这两个测试可以用相同的函数在 R 中完成:<code class="fe np nq nr ns b">wilcox.test()</code>。它们将在以下章节中介绍。</p><h1 id="223e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">独立样本</h1><p id="a06e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于独立样本的 Wilcoxon 检验，假设我们想要检验统计考试中男女学生的成绩是否不同。</p><p id="79a0" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我们收集了 24 名学生(12 名女生和 12 名男生)的成绩:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="c5b9" class="nx la it ns b gy ny nz l oa ob">dat &lt;- data.frame(<br/>  Sex = as.factor(c(rep("Girl", 12), rep("Boy", 12))),<br/>  Grade = c(<br/>    19, 18, 9, 17, 8, 7, 16, 19, 20, 9, 11, 18,<br/>    16, 5, 15, 2, 14, 15, 4, 7, 15, 6, 7, 14<br/>  )<br/>)</span><span id="1189" class="nx la it ns b gy oc nz l oa ob">dat</span><span id="36e0" class="nx la it ns b gy oc nz l oa ob">##     Sex Grade<br/>## 1  Girl    19<br/>## 2  Girl    18<br/>## 3  Girl     9<br/>## 4  Girl    17<br/>## 5  Girl     8<br/>## 6  Girl     7<br/>## 7  Girl    16<br/>## 8  Girl    19<br/>## 9  Girl    20<br/>## 10 Girl     9<br/>## 11 Girl    11<br/>## 12 Girl    18<br/>## 13  Boy    16<br/>## 14  Boy     5<br/>## 15  Boy    15<br/>## 16  Boy     2<br/>## 17  Boy    14<br/>## 18  Boy    15<br/>## 19  Boy     4<br/>## 20  Boy     7<br/>## 21  Boy    15<br/>## 22  Boy     6<br/>## 23  Boy     7<br/>## 24  Boy    14</span></pre><p id="0de8" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">以下是按性别划分的成绩分布(使用<code class="fe np nq nr ns b"><a class="ae ky" href="https://statsandr.com/blog/graphics-in-r-with-ggplot2/" rel="noopener ugc nofollow" target="_blank">{ggplot2}</a></code>):</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="42bc" class="nx la it ns b gy ny nz l oa ob">library(ggplot2)</span><span id="74d8" class="nx la it ns b gy oc nz l oa ob">ggplot(dat) +<br/>  aes(x = Sex, y = Grade) +<br/>  geom_boxplot(fill = "#0c4c8a") +<br/>  theme_minimal()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/dea0c6d949b23216153c966422e5158d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qn35MNL64kvkcpoG.png"/></div></div></figure><p id="1a64" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我们首先通过直方图和夏皮罗-维尔克检验来检查这两个样本是否遵循正态分布:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="476e" class="nx la it ns b gy ny nz l oa ob">hist(subset(dat, Sex == "Girl")$Grade,<br/>  main = "Grades for girls",<br/>  xlab = "Grades"<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/a014ec07c21a335f7453a5e35f6f40af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GcbRsE8378jLKdak.png"/></div></div></figure><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="caa6" class="nx la it ns b gy ny nz l oa ob">hist(subset(dat, Sex == "Boy")$Grade,<br/>  main = "Grades for boys",<br/>  xlab = "Grades"<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/bbc6bfa6206cb0a201beee3364378acd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XH3RioVWZ2TjN594.png"/></div></div></figure><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="9116" class="nx la it ns b gy ny nz l oa ob">shapiro.test(subset(dat, Sex == "Girl")$Grade)</span><span id="dd2a" class="nx la it ns b gy oc nz l oa ob">## <br/>##  Shapiro-Wilk normality test<br/>## <br/>## data:  subset(dat, Sex == "Girl")$Grade<br/>## W = 0.84548, p-value = 0.0323</span><span id="0c42" class="nx la it ns b gy oc nz l oa ob">shapiro.test(subset(dat, Sex == "Boy")$Grade)</span><span id="53cf" class="nx la it ns b gy oc nz l oa ob">## <br/>##  Shapiro-Wilk normality test<br/>## <br/>## data:  subset(dat, Sex == "Boy")$Grade<br/>## W = 0.84313, p-value = 0.03023</span></pre><p id="f1cf" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">直方图显示两种分布似乎都不符合正态分布，夏皮罗-维尔克检验的<em class="oe"> p </em>值证实了这一点(因为我们在 5%的显著性水平上拒绝了两种分布的正态性的零假设)。</p><p id="461b" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我们刚刚表明两组都违反了正态假设，所以现在是时候看看如何在 R. <a class="ae ky" href="https://www.statsandr.com/blog/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption/#fn2" rel="noopener ugc nofollow" target="_blank"> 2 </a>中执行 Wilcoxon 检验了。记住，Wilcoxon 检验的无效假设和替代假设如下:</p><ul class=""><li id="4458" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm of nh ni nj bi translated">H0:两组是相似的</li><li id="e219" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated">H1:两组是不同的</li></ul><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="45f2" class="nx la it ns b gy ny nz l oa ob">test &lt;- wilcox.test(dat$Grade ~ dat$Sex)<br/>test</span><span id="6c9c" class="nx la it ns b gy oc nz l oa ob">## <br/>##  Wilcoxon rank sum test with continuity correction<br/>## <br/>## data:  dat$Grade by dat$Sex<br/>## W = 31.5, p-value = 0.02056<br/>## alternative hypothesis: true location shift is not equal to 0</span></pre><p id="0573" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我们获得检验统计量、<em class="oe">p</em>-值和被检验假设的提示。<a class="ae ky" href="https://www.statsandr.com/blog/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption/#fn3" rel="noopener ugc nofollow" target="_blank"> 3 </a></p><p id="7640" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><em class="oe">p</em>-值为 0.021。因此，在 5%的显著性水平上，我们拒绝零假设，我们得出结论，女生和男生的成绩有显著差异。</p><p id="ec38" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">从上面按性别显示成绩的箱线图可以看出，女生似乎比男生表现得更好。这可以通过在<code class="fe np nq nr ns b">wilcox.test()</code>函数中添加<code class="fe np nq nr ns b">alternative = "less"</code>参数来正式测试:<a class="ae ky" href="https://www.statsandr.com/blog/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption/#fn4" rel="noopener ugc nofollow" target="_blank"> 4 </a></p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="23d3" class="nx la it ns b gy ny nz l oa ob">test &lt;- wilcox.test(dat$Grade ~ dat$Sex,<br/>  alternative = "less"<br/>)<br/>test</span><span id="6a2a" class="nx la it ns b gy oc nz l oa ob">## <br/>##  Wilcoxon rank sum test with continuity correction<br/>## <br/>## data:  dat$Grade by dat$Sex<br/>## W = 31.5, p-value = 0.01028<br/>## alternative hypothesis: true location shift is less than 0</span></pre><p id="f301" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><em class="oe">p</em>-值为 0.01。因此，在 5%的显著性水平上，我们拒绝零假设，我们得出结论，男孩的表现明显差于女孩(这相当于得出结论，女孩的表现明显好于男孩)。</p><h1 id="b34e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">成对样品</h1><p id="e86a" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于第二个场景，假设我们在学期开始时对一个 12 人的班级进行了一次数学测试，并在学期结束时对完全相同的学生进行了一次类似的测试。我们有以下数据:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="cb34" class="nx la it ns b gy ny nz l oa ob">dat &lt;- data.frame(<br/>  Beginning = c(16, 5, 15, 2, 14, 15, 4, 7, 15, 6, 7, 14),<br/>  End = c(19, 18, 9, 17, 8, 7, 16, 19, 20, 9, 11, 18)<br/>)</span><span id="8f98" class="nx la it ns b gy oc nz l oa ob">dat</span><span id="5945" class="nx la it ns b gy oc nz l oa ob">##    Beginning End<br/>## 1         16  19<br/>## 2          5  18<br/>## 3         15   9<br/>## 4          2  17<br/>## 5         14   8<br/>## 6         15   7<br/>## 7          4  16<br/>## 8          7  19<br/>## 9         15  20<br/>## 10         6   9<br/>## 11         7  11<br/>## 12        14  18</span></pre><p id="6f46" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我们转换数据集，使其具有<a class="ae ky" href="https://www.statsandr.com/blog/how-to-import-an-excel-file-in-rstudio/#introduction" rel="noopener ugc nofollow" target="_blank">整齐的格式</a>:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="3ee8" class="nx la it ns b gy ny nz l oa ob">dat2 &lt;- data.frame(<br/>  Time = c(rep("Before", 12), rep("After", 12)),<br/>  Grade = c(dat$Beginning, dat$End)<br/>)<br/>dat2</span><span id="7364" class="nx la it ns b gy oc nz l oa ob">##      Time Grade<br/>## 1  Before    16<br/>## 2  Before     5<br/>## 3  Before    15<br/>## 4  Before     2<br/>## 5  Before    14<br/>## 6  Before    15<br/>## 7  Before     4<br/>## 8  Before     7<br/>## 9  Before    15<br/>## 10 Before     6<br/>## 11 Before     7<br/>## 12 Before    14<br/>## 13  After    19<br/>## 14  After    18<br/>## 15  After     9<br/>## 16  After    17<br/>## 17  After     8<br/>## 18  After     7<br/>## 19  After    16<br/>## 20  After    19<br/>## 21  After    20<br/>## 22  After     9<br/>## 23  After    11<br/>## 24  After    18</span></pre><p id="79b1" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">学期开始和结束时的成绩分布:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="bb97" class="nx la it ns b gy ny nz l oa ob"># Reordering dat2$Time<br/>dat2$Time &lt;- factor(dat2$Time,<br/>  levels = c("Before", "After")<br/>)</span><span id="251b" class="nx la it ns b gy oc nz l oa ob">ggplot(dat2) +<br/>  aes(x = Time, y = Grade) +<br/>  geom_boxplot(fill = "#0c4c8a") +<br/>  theme_minimal()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/5b96d0a8f7a6c671e317cd5ba65f6fa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*slsH1o5l1fhoLWcL.png"/></div></div></figure><p id="17ba" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">(参见<code class="fe np nq nr ns b"><a class="ae ky" href="https://www.statsandr.com/blog/rstudio-addins-or-how-to-make-your-coding-life-easier/" rel="noopener ugc nofollow" target="_blank">{esquisse}</a></code> <a class="ae ky" href="https://www.statsandr.com/blog/rstudio-addins-or-how-to-make-your-coding-life-easier/" rel="noopener ugc nofollow" target="_blank">和</a> <code class="fe np nq nr ns b"><a class="ae ky" href="https://www.statsandr.com/blog/rstudio-addins-or-how-to-make-your-coding-life-easier/" rel="noopener ugc nofollow" target="_blank">{questionr}</a></code> <a class="ae ky" href="https://www.statsandr.com/blog/rstudio-addins-or-how-to-make-your-coding-life-easier/" rel="noopener ugc nofollow" target="_blank">附加模块</a>帮助您重新排列因子变量的级别，并使用<code class="fe np nq nr ns b"><a class="ae ky" href="https://www.statsandr.com/blog/graphics-in-r-with-ggplot2/" rel="noopener ugc nofollow" target="_blank">{ggplot2}</a></code> <a class="ae ky" href="https://www.statsandr.com/blog/graphics-in-r-with-ggplot2/" rel="noopener ugc nofollow" target="_blank">包</a>轻松绘制图表。)</p><p id="7d5d" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">在这个例子中，很明显两个样本不是独立的，因为同样的 12 名学生在学期前后参加了考试。假设正态假设被违反，我们因此对<strong class="lt iu">成对样本</strong>使用 Wilcoxon 检验。</p><p id="5c53" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">该测试的 R 代码与独立样本的代码相似，除了我们将<code class="fe np nq nr ns b">paired = TRUE</code>参数添加到<code class="fe np nq nr ns b">wilcox.test()</code>函数中，以考虑 2 个样本之间的相关性:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="9ddc" class="nx la it ns b gy ny nz l oa ob">test &lt;- wilcox.test(dat2$Grade ~ dat2$Time,<br/>  paired = TRUE<br/>)<br/>test</span><span id="c931" class="nx la it ns b gy oc nz l oa ob">## <br/>##  Wilcoxon signed rank test with continuity correction<br/>## <br/>## data:  dat2$Grade by dat2$Time<br/>## V = 21, p-value = 0.1692<br/>## alternative hypothesis: true location shift is not equal to 0</span></pre><p id="efa3" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">我们获得了检验统计量、<em class="oe"> p </em>值和被检验假设的提示。</p><p id="0a19" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><em class="oe">p</em>-值为 0.169。因此，在 5%的显著性水平上，我们不拒绝学期前后成绩相近的零假设。</p><h1 id="b408" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">等方差假设</h1><p id="c254" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">正如文章开头所写的，Wilcoxon 检验不需要正态假设。</p><p id="bfa2" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">关于等方差假设，这个假设可能需要，也可能不需要，这取决于你的目标。如果你只想比较两组，你不必测试方差的相等性，因为两个分布不必有相同的形状。然而，如果您的目标是<strong class="lt iu">比较两组的中位数</strong>，那么您将需要确保两个分布具有相同的形状(因此，具有相同的方差)。<a class="ae ky" href="https://statsandr.com/blog/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption/#fn5" rel="noopener ugc nofollow" target="_blank"> 5 </a></p><p id="a51a" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">所以你的方差相等测试的结果将改变你的解释:两组“分布”的差异或两组“中位数”的差异。在这篇文章中，我不想比较中位数，我只想通过确定两组的分布是否有差异来比较两组。这就是我不测试方差相等的原因。</p><p id="4494" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">请注意，当执行 Kruskal-Wallis 检验以比较三组或更多组(即<a class="ae ky" href="https://statsandr.com/blog/anova-in-r/" rel="noopener ugc nofollow" target="_blank"> ANOVA </a>的非参数版本)时，这是等效的:如果您只想检验各组之间是否存在差异，则不需要同质异方差，而如果您想要比较中位数，则必须满足此假设。</p><p id="c3ad" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">感谢阅读。我希望这篇文章能帮助你使用 Wilcoxon 检验比较 R 不服从正态分布的两组。如果您需要执行 Wilcoxon 检验的参数版本，请参见<a class="ae ky" href="https://statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/" rel="noopener ugc nofollow" target="_blank">学生 t 检验</a>，如果您需要比较 3 组或更多组，请参见<a class="ae ky" href="https://statsandr.com/blog/anova-in-r/" rel="noopener ugc nofollow" target="_blank"> ANOVA </a>。</p><p id="52fa" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated">和往常一样，如果您有与本文主题相关的问题或建议，请将其添加为评论，以便其他读者可以从讨论中受益。</p></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><ol class=""><li id="98b6" class="nb nc it lt b lu mw lx mx ma nd me ne mi nf mm ng nh ni nj bi translated">记住，正态性假设可以通过 3 种互补的方法来检验:(1)直方图，(2)QQ 图和(3)正态性检验(最常用的是夏皮罗-维尔克检验)。如果需要刷新，请参见<a class="ae ky" href="https://www.statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/" rel="noopener ugc nofollow" target="_blank">如何确定分布是否遵循正态分布</a>。<a class="ae ky" href="https://www.statsandr.com/blog/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption/#fnref1" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="7190" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">注意，为了使用学生的 t 检验(Wilcoxon 检验的参数版本)，要求<strong class="lt iu">两个样本都遵循正态分布</strong>。因此，即使一个样本服从正态分布(另一个不服从正态分布)，也建议使用非参数检验。<a class="ae ky" href="https://www.statsandr.com/blog/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption/#fnref2" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="ab3a" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">请注意，相等元素(平局)的存在阻止了精确的<em class="oe"> p </em>值计算。这可以通过使用<code class="fe np nq nr ns b">{coin}</code>包中的<code class="fe np nq nr ns b">wilcox_test()</code>函数:<code class="fe np nq nr ns b">wilcox_test(dat$Grade ~ dat$Sex, distribution = exact())</code>或<code class="fe np nq nr ns b">wilcox_test(dat$Grade ~ dat$Sex)</code>计算精确的或渐近的 Wilcoxon-Mann-Whitney 检验来解决。在我们的情况下，结论保持不变。<a class="ae ky" href="https://www.statsandr.com/blog/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption/#fnref3" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="0cfc" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">我们加上<code class="fe np nq nr ns b">alternative = "less"</code>(而不是<code class="fe np nq nr ns b">alternative = "greater"</code>)是因为我们想测试男生的分数比女生的分数少<strong class="lt iu"/>。使用<code class="fe np nq nr ns b">"less"</code>或<code class="fe np nq nr ns b">"greater"</code>可以从数据集中的参考电平中扣除。<a class="ae ky" href="https://www.statsandr.com/blog/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption/#fnref4" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li><li id="a9d0" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm ng nh ni nj bi translated">关于 Wilcoxon 检验中的等方差假设，更详细的讨论见这三篇文章:<a class="ae ky" href="https://statistics.laerd.com/statistical-guides/mann-whitney-u-test-assumptions.php" rel="noopener ugc nofollow" target="_blank"> 1 </a>，<a class="ae ky" href="https://influentialpoints.com/Training/Wilcoxon-Mann-Whitney_U_test_use_and_misuse.htm" rel="noopener ugc nofollow" target="_blank"> 2 </a> &amp; <a class="ae ky" href="https://influentialpoints.com/Training/Wilcoxon_matched_pairs_signed_rank_test_use_and_misuse.htm" rel="noopener ugc nofollow" target="_blank"> 3 </a>。<a class="ae ky" href="https://statsandr.com/blog/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption/#fnref5" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li></ol><h1 id="f4ed" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">相关文章</h1><ul class=""><li id="a439" class="nb nc it lt b lu lv lx ly ma on me oo mi op mm of nh ni nj bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand/" rel="noopener ugc nofollow" target="_blank">一次比例和拟合优度测试(R 和手动)</a></li><li id="3253" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/how-to-do-a-t-test-or-anova-for-many-variables-at-once-in-r-and-communicate-the-results-in-a-better-way/" rel="noopener ugc nofollow" target="_blank">如何在 R 中一次对多个变量进行 t 检验或方差分析，并以更好的方式传达结果</a></li><li id="a3bb" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/how-to-perform-a-one-sample-t-test-by-hand-and-in-r-test-on-one-mean/" rel="noopener ugc nofollow" target="_blank">如何手动执行单样本 t 检验，并对一个平均值进行 R:检验</a></li><li id="a5c4" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/" rel="noopener ugc nofollow" target="_blank">学生的 R 和手工 t 检验:如何在不同场景下比较两组</a></li><li id="9488" class="nb nc it lt b lu nk lx nl ma nm me nn mi no mm of nh ni nj bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/chi-square-test-of-independence-in-r/" rel="noopener ugc nofollow" target="_blank">R 中独立性的卡方检验</a></li></ul></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><p id="5ec5" class="pw-post-body-paragraph lr ls it lt b lu mw ju lw lx mx jx lz ma my mc md me mz mg mh mi na mk ml mm im bi translated"><em class="oe">原载于 2020 年 6 月 7 日 https://statsandr.com</em><em class="oe">T21</em><a class="ae ky" href="https://statsandr.com/blog/wilcoxon-test-in-r-how-to-compare-2-groups-under-the-non-normality-assumption/" rel="noopener ugc nofollow" target="_blank">。</a></p></div></div>    
</body>
</html>