<html>
<head>
<title>Beyond “classic” PCA: Functional Principal Components Analysis (FPCA) applied to Time-Series with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">超越“经典”主成分分析:用 Python 实现时间序列的功能主成分分析(FPCA)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/beyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0?source=collection_archive---------7-----------------------#2020-08-24">https://towardsdatascience.com/beyond-classic-pca-functional-principal-components-analysis-fpca-applied-to-time-series-with-python-914c058f47a0?source=collection_archive---------7-----------------------#2020-08-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="50a1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">发现为什么在主成分分析中使用“函数”而不是“线性向量”可以帮助您更好地理解时间序列的共同趋势和行为。</h2></div><p id="52f3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">传统上，FPCA 是用 R 实现的，但是 J. Derek Tucker 的"<a class="ae le" href="https://github.com/glemaitre/fdasrsf" rel="noopener ugc nofollow" target="_blank"> FDASRSF </a>"包将在 Python 中实现类似的(甚至更好的)结果。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/691769bed912188592a65b17b9a56135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tFll-6Yeczf9pljCXrHHtg.jpeg"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">来自<a class="ae le" href="https://www.danorst.com/time-slice-stills" rel="noopener ugc nofollow" target="_blank">丹·马克尔-摩尔</a>的 39 张照片中的时光倒流</p></figure><p id="51a6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">如果你已经到达这个页面，你可能已经熟悉了 PCA。</strong></p><p id="0d3f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">主成分分析是数据科学探索工具包的一部分，因为它提供了许多好处:降低大型数据集的维度，防止多重共线性等。</p><p id="03cf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有许多文章解释了 PCA 的好处，如果需要，我建议您看看这篇文章，它总结了我对这种方法的理解:</p><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/principal-components-analysis-pca-fundamentals-benefits-insights-for-industry-2f03ad18c4d7"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">主成分分析(PCA)，行业的基本原理、优势和见解</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">了解为什么主成分分析不仅可以降低维数和节省计算时间，还可以避免…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm lp ly"/></div></div></a></div><h1 id="9a21" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">“功能性”PCA 背后的直觉</h1><p id="9554" class="pw-post-body-paragraph ki kj it kk b kl nf ju kn ko ng jx kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">在标准的 PCA 过程中，我们定义特征向量以将原始数据集转换成具有更少维度的更小数据集，并且对于该数据集，大部分初始数据集方差被保留(通常为 90%或 95%)。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nk"><img src="../Images/778088038605cbc278e1ed15ebb4f220.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Av5pYIhhyukReFXu59jJ1w.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">初始数据集(蓝色十字)和相应的前两个特征向量</p></figure><blockquote class="nl"><p id="8245" class="nm nn it bd no np nq nr ns nt nu ld dk translated">现在让我们想象时间序列的模式比它们的绝对方差更重要。例如，您想比较信号、温度变化、生产批次等物理现象..功能性主成分分析将通过确定相应的基础功能来实现这一点！</p></blockquote><figure class="nw nx ny nz oa lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nv"><img src="../Images/377759c7a61bad88bc83004a531ca2de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9fhB_rf_Ye-U0tcPGEKxmg.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">初始数据集(蓝色十字)和相应的第一个函数</p></figure><p id="b199" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们以一个四季国家不同地区一年内的温度变化为例:我们可以假设有一个从冬季寒冷到夏季炎热的全球趋势。</p><p id="c211" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还可以假设靠近海洋的区域将遵循与靠近山脉的区域不同的模式(即:海边的温度变化更平稳，而山区冬季的温度极低)。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ob"><img src="../Images/99c4f2b4785ba94e825bc7c637851e36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZdlnvJcjEtnzefaSyu6lMA.png"/></div></div></figure><p id="dd32" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在将使用这种方法来确定 2019 年法国各地区之间的这种差异。这个例子直接受到传统的“加拿大天气”FPCA 例子的启发</p></div><div class="ab cl oc od hx oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="im in io ip iq"><h1 id="b0b8" class="mn mo it bd mp mq oj ms mt mu ok mw mx jz ol ka mz kc om kd nb kf on kg nd ne bi translated">2019 年法国各地区气温数据集的创建</h1><p id="9451" class="pw-post-body-paragraph ki kj it kk b kl nf ju kn ko ng jx kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">我们首先按地区*获取法国自 2018 年以来的每日温度记录，并准备相应的数据集。</p><div class="lv lw gp gr lx ly"><a href="https://www.data.gouv.fr/fr/datasets/temperature-quotidienne-departementale-depuis-janvier-2018/" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">tempétemperature quotidienne départementale(depu is janvier 2018)-data . gouv . fr</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">天气预报显示最低温度，...</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">www.data.gouv.fr</p></div></div><div class="mh l"><div class="oo l mj mk ml mh mm lp ly"/></div></div></a></div><p id="a101" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="op">(*温度记录在“部门”一级，这比法国的地区(96 个部门对 13 个地区)要小。但是，为了读者更容易理解，我们将“部门”重命名为“区域”。)</em></p><p id="de84" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们选择了分布在法国的 7 个地区，它们对应着不同的天气模式(稍后会公布):06，25，59，62，83，85，75。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/765c03222899a76caeddbd6fd4d0e55d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*HR4NoqIDbLAtf5T5Qv-1xQ.png"/></div></figure><h1 id="b410" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">数据集上的 FDASRSF 包安装和使用</h1><p id="1f10" class="pw-post-body-paragraph ki kj it kk b kl nf ju kn ko ng jx kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">要在当前环境中安装 FDASRSF 软件包，只需运行:</p><pre class="lg lh li lj gt ot ou ov ow aw ox bi"><span id="58d6" class="oy mo it ou b gy oz pa l pb pc"><em class="op">pip install fdasrsf</em></span></pre><p id="94b2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="op">(注意:根据我的经验，您可能需要手动安装一个或两个额外的包来正确完成安装。您只需要检查 anaconda 日志，以防无法识别它们。)</em></p><p id="98a7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">J. Derek Tucker 的 FDASRSF 软件包提供了许多有趣的函数，我们将使用其中的两个:<strong class="kk iu">功能比对</strong>和<strong class="kk iu">功能主成分分析</strong>(参见下面的相应文档)<strong class="kk iu"> : </strong></p><div class="lv lw gp gr lx ly"><a href="https://fdasrsf-python.readthedocs.io/en/latest/time_warping.html#" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">功能校准-FDA rsf 2 . 0 . 1 文件</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">使用 SRSF 框架和动态编程的组式函数对齐将一组函数对齐，同时…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">fdasrsf-python.readthedocs.io</p></div></div></div></a></div><p id="e221" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">功能校准</strong>将在时间序列未完全校准的情况下同步时间序列。下图提供了一个相对简单的示例来理解这种机制。从相位和振幅的角度(也称为 x 轴和 y 轴)处理时间序列。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pd"><img src="../Images/376dfd7806e3effbd60dad20698bb29e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XkFkuIc_HUEc8BH07ZDGIw.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">摘自<a class="ae le" href="https://ani.stat.fsu.edu/~wwu/papers/TuckerCSDA13.pdf" rel="noopener ugc nofollow" target="_blank"> J.D. Tucker 等人/计算统计和数据分析 61(2013)50–66</a></p></figure><p id="34c3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了更准确地理解所涉及的算法，我强烈建议您看一看 J. Derek Tucker、吴伟和 Anuj Srivastava 的“<a class="ae le" href="https://ani.stat.fsu.edu/~wwu/papers/TuckerCSDA13.pdf" rel="noopener ugc nofollow" target="_blank">使用相位和振幅分离的函数数据生成模型</a>”。</p><p id="6e72" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">尽管通过简单地查看原始数据和变形数据很难注意到这一点，但我们可以观察到变形函数确实有一些小的变化(参见略滞后于 x=y 轴的黄色曲线)，这意味着这些函数在需要时同步了时间序列。(您可能已经猜到，温度记录是按照设计对齐的，因为它们是同时采集的。)</p><div class="lg lh li lj gt ab cb"><figure class="pe lk pf pg ph pi pj paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><img src="../Images/d38447747883b6f5550ea57681854e0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*VomHTMJK0JsLXoIOEYz9bw.png"/></div></figure><figure class="pe lk pk pg ph pi pj paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><img src="../Images/a5876935f17268f1f23285611167d78f.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*AQP4Jo3cZqLa-D6u29ns0g.png"/></div></figure><figure class="pe lk pl pg ph pi pj paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><img src="../Images/2639e22f7bbad46dff56fc06633d9c80.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*eu7B2rHNVpbiEyDrj9qECQ.png"/></div></figure></div><p id="02de" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">功能主成分分析</strong></p><p id="e196" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">既然我们的数据集是“扭曲的”，我们可以运行一个功能性主成分分析。FDASRSF 软件包允许水平、垂直或联合分析。我们将使用垂直坐标，并为 PC1 和 PC2 绘制相应的函数和系数。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pm"><img src="../Images/9a3589aef0954ff5e340b595a777321d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-8uMPP2LQOjDAnmCLnpR1g.png"/></div></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pn"><img src="../Images/d2a6fc833e3419b21391794c0065919a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NizLEuaVr80hjYRLAYMYPQ.png"/></div></div></figure><p id="b5b9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们可以根据在法国观察到的天气，在图上添加不同的天气模式:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi po"><img src="../Images/22ec882e8334f21307d2294ccc517299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dXzVA94Ke7Ll1Tbc6qhV_g.png"/></div></div></figure><h1 id="e4d6" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">显而易见，这种聚类与法国观察到的天气有多吻合。</h1><p id="21b7" class="pw-post-body-paragraph ki kj it kk b kl nf ju kn ko ng jx kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">同样重要的是，我根据我经常居住、工作和旅行的地方任意选择了这些部门，但它们没有被选中，因为它们为该演示提供了良好的结果。我希望其他地区的结果质量相同。</p><p id="b2cd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">也许你想知道一个标准的 PCA 是否也能提供一个有趣的结果？</p><p id="5557" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下图是从原始数据集中提取的标准 PC1 和 PC2，显示其性能不如 FPCA:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pp"><img src="../Images/e63bab300ca0fb0b1ecfe6bf5c3f8af8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OvSHMuKv8svz8mnnPFap0Q.png"/></div></div></figure><p id="19dc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望这篇文章能让你更好地理解函数主成分分析。</p><p id="2ae3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">我还要衷心感谢 J. Derek Tucker，他耐心地指导我使用 FDASRSF 软件包。</strong></p><p id="be08" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完整的笔记本存放在<a class="ae le" href="https://gist.github.com/pierrelouisbescond/9c0b8b925741e4376baf4883306a9022" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><div class="lv lw gp gr lx ly"><a href="https://pl-bescond.medium.com/pierre-louis-besconds-articles-on-medium-f6632a6895ad" rel="noopener follow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">皮埃尔-路易·贝斯康德关于媒介的文章</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">数据科学、机器学习和创新</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">pl-bescond.medium.com</p></div></div><div class="mh l"><div class="pq l mj mk ml mh mm lp ly"/></div></div></a></div></div></div>    
</body>
</html>