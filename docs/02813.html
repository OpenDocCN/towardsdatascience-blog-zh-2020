<html>
<head>
<title>Visualize the Pandemic with R #COVID-19</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用R #新冠肺炎想象疫情</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualize-the-pandemic-with-r-covid-19-c3443de3b4e4?source=collection_archive---------13-----------------------#2020-03-18">https://towardsdatascience.com/visualize-the-pandemic-with-r-covid-19-c3443de3b4e4?source=collection_archive---------13-----------------------#2020-03-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ef48" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">作为一名数据科学家，你可以用新冠肺炎数据做什么。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ff7d6595224b57216bb8c80a772ae4d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*38qLMmHpLCXIq_s9bdM_Gw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">资料来源:JHU·CSSE</p></figure><p id="0e04" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">按照疾病预防控制中心的建议，我们可以做两件事:阅读关于新冠肺炎的新闻，以及被不断增加的病例数压垮。过去几周情况有多糟？我的手机不停地播放着来自世界各地的新闻:首先是我在中国的家乡，然后是亚洲其他地方、欧洲和美国。超过一半的纽约已经停止通勤。我们已经用拳头碰撞代替了握手，现在，新的标准是:社交距离。五天前的3月12日，世界卫生组织宣布新冠肺炎为疫情。到目前为止，全世界142个国家超过16万人被确诊患有这种疾病。我觉得有义务用R创建一个追踪器来解释这个疫情。</p><p id="3601" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我用的是南方医科大学广创于博士研发的R包“<a class="ae lu" href="https://github.com/GuangchuangYu/nCov2019" rel="noopener ugc nofollow" target="_blank"> nCOV2019 </a>”。这个软件包允许我们访问所有国家案例的最新数据和历史数据，在地图上绘制数据，并创建各种图表。如果你像我一样是一个有抱负的数据科学家，请随意安装该软件包，并按照以下步骤创建可视化:</p><p id="3612" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">部署软件包</strong></p><p id="d844" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">探索数据</strong></p><p id="0769" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">创建视觉效果</strong></p><ul class=""><li id="c56a" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated">按国家的折线图</li><li id="630c" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">gif中的全球新冠肺炎增长</li></ul><p id="7514" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">影响分析</strong></p><ul class=""><li id="7e90" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated">接下来10天我们会有多少病例？</li><li id="53ba" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">冠状病毒正在影响好莱坞吗？</li><li id="0e5b" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">我们还在外面吃饭吗？(带OpenTable数据)</li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="3221" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">部署包</h1><p id="57c1" class="pw-post-body-paragraph ky kz it la b lb ni ju ld le nj jx lg lh nk lj lk ll nl ln lo lp nm lr ls lt im bi translated">提取该包中嵌入的数据的基本函数有:</p><ul class=""><li id="300f" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><code class="fe nn no np nq b">get_nCov2019()</code>查询网上最新信息</li><li id="cec4" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated"><code class="fe nn no np nq b">load_nCov2019()</code>获取历史数据</li><li id="70ee" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated"><code class="fe nn no np nq b">summary</code>和<code class="fe nn no np nq b">[</code>访问数据</li><li id="5928" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated"><code class="fe nn no np nq b">plot</code>在地图上显示数据</li></ul><p id="6e85" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">安装并部署软件包</strong></p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="0a24" class="nv mr it nq b gy nw nx l ny nz">remotes::install_github(“GuangchuangYu/nCov2019”)<br/><strong class="nq iu">require</strong>(nCov2019)<br/><strong class="nq iu">require</strong>(dplyr)</span></pre><p id="2cea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">第一印象</strong></p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="cab7" class="nv mr it nq b gy nw nx l ny nz">x &lt;- get_nCov2019()<br/>y &lt;- load_nCov2019()</span><span id="b59d" class="nv mr it nq b gy oa nx l ny nz">&gt; x</span><span id="0c00" class="nv mr it nq b gy oa nx l ny nz">China (total confirmed cases): 81134</span><span id="01aa" class="nv mr it nq b gy oa nx l ny nz">last update: 2020–03–17 21:19:04</span><span id="6cb3" class="nv mr it nq b gy oa nx l ny nz">&gt; y</span><span id="becf" class="nv mr it nq b gy oa nx l ny nz">nCov2019 historical data</span><span id="a777" class="nv mr it nq b gy oa nx l ny nz">last update: 2020–03–16</span></pre><p id="9ee7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">跟上时代是非常重要的。简单地打印x和y将刷新数据。</p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="5b72" class="nv mr it nq b gy nw nx l ny nz">&gt; x['global',]</span><span id="adf6" class="nv mr it nq b gy oa nx l ny nz">name confirm suspect dead deadRate showRate  heal healRate showHeal</span><span id="b45b" class="nv mr it nq b gy oa nx l ny nz">1                          China   81134     128 3231     3.98    FALSE 68800    84.80     TRUE</span><span id="937f" class="nv mr it nq b gy oa nx l ny nz">2                          Italy   27980       0 2158     7.71    FALSE  2749     9.82    FALSE</span><span id="db86" class="nv mr it nq b gy oa nx l ny nz">3                           Iran   16169       0  988     6.11    FALSE  5389    33.33    FALSE</span><span id="1828" class="nv mr it nq b gy oa nx l ny nz">4                          Spain   11178       0  491     4.39    FALSE   571     5.11    FALSE</span><span id="eec2" class="nv mr it nq b gy oa nx l ny nz">5                    South Korea    8320       0   83        1    FALSE  1401    16.84    FALSE</span><span id="763a" class="nv mr it nq b gy oa nx l ny nz">6                        Germany    7272       0   17     0.23    FALSE   135     1.86    FALSE</span><span id="b267" class="nv mr it nq b gy oa nx l ny nz">7                         France    6650       0  148     2.23    FALSE    28     0.42    FALSE</span><span id="74aa" class="nv mr it nq b gy oa nx l ny nz">8                  United States    4687       0   93     1.98    FALSE    74     1.58    FALSE</span><span id="5391" class="nv mr it nq b gy oa nx l ny nz">9                    Switzerland    2269       0   19     0.84    FALSE     4     0.18    FALSE</span><span id="9bee" class="nv mr it nq b gy oa nx l ny nz">10                United Kingdom    1950       0   56     2.87    FALSE    52     2.67    FALSE</span></pre><p id="27c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如何创建数据的概览？<code class="fe nn no np nq b">x[‘global’,]</code>返回最新的全球数据，并按确诊病例数自动排序。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="40b2" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">探索数据</h1><p id="0dcb" class="pw-post-body-paragraph ky kz it la b lb ni ju ld le nj jx lg lh nk lj lk ll nl ln lo lp nm lr ls lt im bi translated">首先，让我们探索当前数据的整体结构。DataExplorer是一个R包，可以快速构建可视化。</p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="9805" class="nv mr it nq b gy nw nx l ny nz">#explore package<br/><strong class="nq iu">library</strong>(DataExplorer)<br/>plot_str(x)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/497d026845092c109e1c20dacb9df98d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IqQcf7q2Mm_EOlFt"/></div></div></figure><p id="bc28" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过<code class="fe nn no np nq b">get_nCov2019()</code>函数获得的数据包括3个列表和5个数据帧。这些是中国和世界各地确诊患者、死亡和康复病例的最新数据。</p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="fa20" class="nv mr it nq b gy nw nx l ny nz">plot_str(y)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/4987b81b8cdc7b4882b4f742640ad2d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E9Lo4hMPLomIy-rO"/></div></div></figure><p id="880d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了研究趋势，我重点研究了历史数据。通过函数<code class="fe nn no np nq b">load_nCov2019()</code>获得的历史数据是一个列表，包括3个数据帧。名为“数据”的第一个数据框架是中国城市层面的历史数据，包括确诊病例、死亡、康复和疑似病例的数量。第二个名为“省”的是省级别的聚合数据。第三个数据框架“全球”包括世界各国的确诊病例、死亡和恢复情况。这些历史数据涵盖了从2月15日到最近更新的时间范围。</p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="183e" class="nv mr it nq b gy nw nx l ny nz">&gt; summary(x['global',])<br/>     name              confirm           suspect              dead           deadRate        <br/> Length:131         Min.   :    1.0   Min.   :  0.0000   Min.   :   0.00   Length:131        <br/> Class :character   1st Qu.:    4.5   1st Qu.:  0.0000   1st Qu.:   0.00   Class :character  <br/> Mode  :character   Median :   30.0   Median :  0.0000   Median :   0.00   Mode  :character  <br/>                    Mean   : 1223.3   Mean   :  0.8626   Mean   :  45.44                     <br/>                    3rd Qu.:  137.5   3rd Qu.:  0.0000   3rd Qu.:   1.00                     <br/>                    Max.   :81062.0   Max.   :113.0000   Max.   :3204.00                     <br/>   showRate              heal           healRate           showHeal        <br/> Length:131         Min.   :    0.0   Length:131         Length:131        <br/> Class :character   1st Qu.:    0.0   Class :character   Class :character  <br/> Mode  :character   Median :    0.0   Mode  :character   Mode  :character  <br/>                    Mean   :  582.3                                        <br/>                    3rd Qu.:    3.5                                        <br/>                    Max.   :67023.0</span></pre><p id="9b26" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我使用了<code class="fe nn no np nq b"> summary()</code>函数来获得数据的统计概览。全球确诊病例的中位数是30例，而平均数是1223.3例。原因是异常值中国对平均确诊病例有很大影响。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="738e" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">创造视觉效果</h1><p id="603a" class="pw-post-body-paragraph ky kz it la b lb ni ju ld le nj jx lg lh nk lj lk ll nl ln lo lp nm lr ls lt im bi translated">可视化是探索性数据分析的另一个关键方法。通过图像，我们可以很容易地观察到国家和国际层面的疫情趋势。</p><ul class=""><li id="efbd" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><strong class="la iu">国别折线图</strong></li></ul><p id="6cbb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">上面已经提到了如何使用x['全球'，]获得确诊病例最多的前10个国家。我们还可以绘制折线图，查看每个国家的病例增长情况。</p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="2aad" class="nv mr it nq b gy nw nx l ny nz">#obtain top 10 country<br/>d &lt;- y[‘global’] #extract global data<br/>d &lt;- d[d$country != ‘China’,] #exclude China<br/>n &lt;- d %&gt;% filter(time == time(y)) %&gt;%<br/> top_n(10, cum_confirm) %&gt;%<br/> arrange(desc(cum_confirm))</span><span id="d000" class="nv mr it nq b gy oa nx l ny nz">#plot top 10<br/><strong class="nq iu">require</strong>(ggplot2)<br/><strong class="nq iu">require</strong>(ggrepel)<br/>ggplot(filter(d, country %<strong class="nq iu">in</strong>% n$country, d$time &gt; ‘2020–02–15’),<br/> aes(time, cum_confirm, color=country)) +<br/> geom_line() +<br/> geom_text_repel(aes(label=country),<br/> <strong class="nq iu">function</strong>(d) d[d$time == time(y),]) +<br/> theme_minimal(base_size=14) +<br/> theme(legend.position = “none”)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/7a7340414791806fd0346b03e2a644f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-57OZqvZbrCfg_65"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">新冠肺炎确诊病例排名前10位的国家(不包括中国)</p></figure><p id="f004" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该图显示了中国以外确诊病例最多的前10个国家。意大利和伊朗是受感染最严重的国家，并且呈指数增长。与此同时，韩国通过有效的遏制战略，拉平了曲线，放缓了增长速度。其他一些欧洲国家和美国也出现了成千上万的新病例。</p><ul class=""><li id="d01f" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><strong class="la iu">gif中的全球新冠肺炎增长</strong></li></ul><p id="95b3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">全球的整体情况如何？用plot()函数可以很容易地绘制出全球新冠肺炎确认数地图。</p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="ef23" class="nv mr it nq b gy nw nx l ny nz">x &lt;- get_nCov2019()<br/>x<br/>plot(x) #plot global map</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/e9c8fa2e65d495d27cdd1a1cfc438f6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*R0G83Ya3J-SQkFo4"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">新冠肺炎全球3月15日确诊病例</p></figure><p id="ab06" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">随着时间的推移会有什么变化呢？如果我们能以gif的形式展示这些变化，那将是一个很好的主意。我绘制了从02-12到03-15每天的全球地图，并用R包magick创建了一个gif。</p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="fec8" class="nv mr it nq b gy nw nx l ny nz">#visualize global growth over time<br/><strong class="nq iu">library</strong>(magick)</span><span id="bcb7" class="nv mr it nq b gy oa nx l ny nz">y &lt;- load_nCov2019()</span><span id="fbb1" class="nv mr it nq b gy oa nx l ny nz">d &lt;- c(paste0(“2020–02-”, 12:29), paste0(“2020–03–0”, 1:9), paste0(“2020–03–1”, 0:5))<br/>img &lt;- image_graph(1200, 700, res = 96)<br/>out &lt;- lapply(d, <strong class="nq iu">function</strong>(date){<br/> p &lt;- plot(y, date=date,<br/> label=FALSE, continuous_scale=TRUE)<br/> print(p)<br/>})<br/>dev.off()</span><span id="1425" class="nv mr it nq b gy oa nx l ny nz">animation &lt;- image_animate(img, fps = 2)<br/>print(animation)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/500ba7b5a55034070d982aac1651a560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*gFHOND9q4UHWUCLzRAooog.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">新冠肺炎全球2月12日至3月15日确诊病例</p></figure><p id="9abe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们可以看到冠状病毒是如何从中国开始，在短短一个月内传播到世界上大多数国家的。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="340b" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">影响分析</h1><ul class=""><li id="9e85" class="lv lw it la b lb ni le nj lh oe ll of lp og lt ma mb mc md bi translated">在接下来的10天内，我们会有多少个案例？</li></ul><p id="e61d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们可以使用现有数据预测未来的病例增长。</p><p id="bc78" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以美国为例。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/d005dcb9ea7a2ac0d39c8edd5e38c075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0q3oInE5SjOyznuc"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">新冠肺炎确诊病例在美国增长</p></figure><p id="7b47" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过查看图表，我们可以很容易地发现病例以指数速度增长。在这种情况下，我们可以应用对数线性回归来建模和预测增长。我只考虑确诊病例超过100例的时间段，原因如下:</p><ul class=""><li id="711a" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated">早期测试中</li><li id="e3bc" class="lv lw it la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">早期病例大多与旅行有关，而不是社区传播</li></ul><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="c190" class="nv mr it nq b gy nw nx l ny nz">usdata &lt;- d %&gt;%</span><span id="922b" class="nv mr it nq b gy oa nx l ny nz">filter(d$country == ‘United States’ &amp; d$cum_confirm&gt;100) %&gt;%</span><span id="0ef8" class="nv mr it nq b gy oa nx l ny nz">select(time,cum_confirm)</span><span id="b552" class="nv mr it nq b gy oa nx l ny nz">library(forecast)</span><span id="e847" class="nv mr it nq b gy oa nx l ny nz">case &lt;- ts(usdata[,2], start=1,frequency = 1)</span><span id="ac9a" class="nv mr it nq b gy oa nx l ny nz">fit &lt;- tslm(log(case) ~ trend)</span><span id="dd63" class="nv mr it nq b gy oa nx l ny nz">fc &lt;- forecast(fit, h=10)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/459dc41214fab72f98cd3f2b538b242c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Hvvl90jkFzh8cR9X"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">美国确诊病例对数的时间回归模型</p></figure><p id="b1bb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的对数线性模型非常适合数据集。0.9974的调整R平方表明99%的方差可以用我们的模型来解释。</p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="5d6f" class="nv mr it nq b gy nw nx l ny nz">Residuals:</span><span id="3d50" class="nv mr it nq b gy oa nx l ny nz">Min        1Q    Median        3Q       Max</span><span id="4eca" class="nv mr it nq b gy oa nx l ny nz">-0.095126 -0.036574 -0.000754  0.036861  0.069923</span><span id="311a" class="nv mr it nq b gy oa nx l ny nz">Coefficients:</span><span id="326c" class="nv mr it nq b gy oa nx l ny nz">Estimate Std. Error t value Pr(&gt;|t|)</span><span id="f21b" class="nv mr it nq b gy oa nx l ny nz">(Intercept) 4.311641   0.032840  131.29  &lt; 2e-16 ***</span><span id="fe78" class="nv mr it nq b gy oa nx l ny nz">trend       0.288296   0.004462   64.61 1.92e-14 ***</span><span id="0e3f" class="nv mr it nq b gy oa nx l ny nz">---</span><span id="d5ac" class="nv mr it nq b gy oa nx l ny nz">Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span><span id="01f0" class="nv mr it nq b gy oa nx l ny nz">Residual standard error: 0.05336 on 10 degrees of freedom</span><span id="aeed" class="nv mr it nq b gy oa nx l ny nz">Multiple R-squared:  0.9976, Adjusted R-squared:  0.9974</span><span id="6cfa" class="nv mr it nq b gy oa nx l ny nz">F-statistic:  4175 on 1 and 10 DF,  p-value: 1.92e-14</span></pre><p id="d87a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们可以回答这个问题了，10天内我们会有多少个案例？</p><p id="b3fe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以用<code class="fe nn no np nq b">forecast()</code>来做未来5天的预测(h周期用来设置预测周期)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/9517c79a416b295b391707671e4d06e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_aJxIK-K5N6cDA4f"/></div></div></figure><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="e124" class="nv mr it nq b gy nw nx l ny nz">Forecasts:</span><span id="eb92" class="nv mr it nq b gy oa nx l ny nz">Point Forecast     Lo 80     Hi 80     Lo 95     Hi 95</span><span id="3e37" class="nv mr it nq b gy oa nx l ny nz">15       5382.300  4936.042  5868.904  4683.598  6185.235</span><span id="fa3f" class="nv mr it nq b gy oa nx l ny nz">16       7148.845  6541.200  7812.938  6198.094  8245.436</span><span id="1112" class="nv mr it nq b gy oa nx l ny nz">17       9495.195  8666.463 10403.174  8199.463 10995.686</span><span id="a636" class="nv mr it nq b gy oa nx l ny nz">18      12611.649 11479.941 13854.922 10843.598 14667.981</span><span id="940d" class="nv mr it nq b gy oa nx l ny nz">19      16750.966 15204.003 18455.327 14336.190 19572.484</span><span id="818e" class="nv mr it nq b gy oa nx l ny nz">20      22248.863 20132.776 24587.365 18948.614 26123.912</span><span id="f79e" class="nv mr it nq b gy oa nx l ny nz">21      29551.247 26655.278 32761.849 25038.879 34876.810</span><span id="9f7c" class="nv mr it nq b gy oa nx l ny nz">22      39250.374 35286.012 43660.130 33079.244 46572.764</span><span id="f759" class="nv mr it nq b gy oa nx l ny nz">23      52132.888 46705.412 58191.072 43692.648 62203.553</span><span id="5a73" class="nv mr it nq b gy oa nx l ny nz">24      69243.620 61813.326 77567.075 57700.726 83095.642</span></pre><p id="d323" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">预测结果显示，如果确诊病例继续以指数速度增长，该数字将在3天内翻一番，并在10天内达到近70，000人。</p><p id="13cf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就是采取预防措施如此重要的原因。在数周的逐渐增长后，受感染人数会突然增加，这在最初似乎是可以控制的。医疗能力将不堪重负，医护人员将处于危险之中。</p><p id="617f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">重要的是，我们都开始社交距离，避免去公共场所，以减缓增长速度，否则就太晚了。</p><ul class=""><li id="4ed1" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><strong class="la iu">冠状病毒在影响好莱坞吗？</strong></li></ul><p id="2128" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">几个主要城市已经关闭了电影院，以避免人群聚集。然而，大多数北美影院在过去的周末仍然开放。好莱坞受到疫情影响了吗？</p><p id="8b12" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我从boxofficemojo.com收集了2019年和2020年的每日票房数据，并将今年的票房表现与去年进行了比较。然后，我将结果绘制在一张线图上。</p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="ef8e" class="nv mr it nq b gy nw nx l ny nz">ggplot(boxoffice,<br/> aes(date, rate))+<br/> geom_line(color = ‘red’) +<br/> geom_hline(yintercept=0) +<br/> theme_minimal(base_size=14) +<br/> scale_y_continuous(“year-on-year box office”, labels=scales::percent, breaks = c(seq(-1,0.5,0.1)))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/4046f42851780f4474a61f8105af9457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6abR1yacc-YnZET1"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">逐年美国票房对比</p></figure><p id="f0bb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">结果是惊人的。3月5日的票房与去年相比下降了60%，3月17日的票房几乎下降了70%。</p><p id="143e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">据综艺报道，北美影院的票房收入创下二十年来的新低。</p><p id="e657" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">随着越来越多的城市开始关闭电影院，我们可能会看到票房收入进一步下降。</p><ul class=""><li id="9550" class="lv lw it la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated">我们还在外面吃饭吗？(带OpenTable数据)</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/9d55a2745a34b2118cc339bf92eefa7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*c10WZD7B-q9Nn0dD"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/93866b4edf8eebb2bea2fd63c43b1566.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LiX20eBftr_qWuki"/></div></div></figure><p id="44e9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我在推特上看到很多抱怨，尽管疾控中心警告避免人群聚集，人们仍然去酒吧和餐馆。人们还像往常一样在外面吃饭是真的吗？</p><p id="2ad9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我看到了在线餐厅预订提供商Opentable发布的用餐人数数据。</p><p id="0c53" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据显示了OpenTable网络上所有渠道的餐厅年复一年的用餐人数:在线预订、电话预订和上门预订。我绘制了美国和欧洲六个主要城市从2月18日到今天的食客变化:拉斯维加斯、洛杉矶、纽约、伦敦、多伦多和汉堡。</p><pre class="kj kk kl km gt nr nq ns nt aw nu bi"><span id="5477" class="nv mr it nq b gy nw nx l ny nz">ggplot(opentable,<br/> aes(date, rate, color=City)) +<br/> geom_line() +<br/> geom_text_repel(data = opentable[opentable$date == “2020–03–16”,], aes(label=(City)) +<br/> theme_minimal(base_size=14) +<br/> geom_hline(yintercept=0) +<br/> scale_y_continuous(“year-on-year change”, labels=scales::percent, breaks = c(seq(-1,0.5,0.1))) +<br/> theme(legend.position = “none”)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/eba13972ba8960682fde4ba3feb07ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i7poNeLbLhouV_aB"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">逐年Opentable保留比较</p></figure><p id="b8b2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">图表显示，自三月份的第二周以来，所有六个主要城市的餐馆顾客数量都在快速下降。每个城市的用餐人数都下降了50%以上。在洛杉矶，这个数字与去年相比下降了80%以上。</p><p id="785b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据证明，人们外出就餐的次数比平时少了，这对餐饮业尤其有害。由于大多数餐馆的利润率相对较低(3%-5%)，固定成本比率较高，因此收入的小百分比下降就足以扼杀业务，并将员工送上街头。</p><p id="141a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">尽管新冠肺炎没有完全阻止美食家去餐馆，但在未来几周，他们这样做的机会可能会减少。像麦当劳和塔可钟这样的几家食品连锁店正在关闭他们的餐饮服务。与此同时，纽约市和俄亥俄州关闭了该地区所有的酒吧和餐馆。</p><p id="5cb9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">按照上面的步骤，你可以创造出和我一样的视觉效果，如果不是更好的话。当冠状病毒仍在全球传播时，作为一名数据爱好者，您也可以使用“ncov 2019”R包探索新冠肺炎数据，并帮助向人们通报您的发现。</p><p id="b047" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我要感谢<a class="ae lu" href="https://www.linkedin.com/in/zhenghuiwen/" rel="noopener ugc nofollow" target="_blank"> Alice Yang </a>提供的建设性意见。</p><p id="697c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi">— — — — — —</p><p id="a824" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">嗨！我叫钱。我是一名数据爱好者，擅长数据分析和数据可视化。我目前正在纽约市攻读营销情报硕士学位。自从今年一月中国武汉爆发冠状病毒以来，我一直在关注它。上个月，我在美国仪表盘中创建了一个新冠肺炎，让人们跟踪美国的最新情况。(<a class="ae lu" href="https://public.tableau.com/profile/xinhan.qian#!/vizhome/visual_15831250365630/Dashboard1?publish=yes" rel="noopener ugc nofollow" target="_blank">查看这里</a>)现在我正在寻找实习机会。我很想和你一起喝杯(虚拟)咖啡！</p><p id="1be4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lu" href="https://www.linkedin.com/in/xinhan-qian/" rel="noopener ugc nofollow" target="_blank">我的LinkedIn </a></p><p id="0e6c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在xinhan.qian@outlook.com联系我</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="27ba" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> <em class="ol">编者按:</em> </strong> <em class="ol"> </em> <a class="ae lu" href="http://towardsdatascience.com/" rel="noopener" target="_blank"> <em class="ol">走向数据科学</em> </a> <em class="ol">是一份以数据科学和机器学习研究为主的中型刊物。我们不是健康专家或流行病学家，本文的观点不应被解释为专业建议。想了解更多关于疫情冠状病毒的信息，可以点击</em> <a class="ae lu" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports" rel="noopener ugc nofollow" target="_blank"> <em class="ol">这里</em> </a> <em class="ol">。</em></p></div></div>    
</body>
</html>