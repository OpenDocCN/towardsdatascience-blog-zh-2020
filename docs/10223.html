<html>
<head>
<title>6 Pandas tricks you should know to speed up your data analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你应该知道的 6 个熊猫技巧来加速你的数据分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/6-pandas-tricks-you-should-know-to-speed-up-your-data-analysis-d3dec7c29e5?source=collection_archive---------10-----------------------#2020-07-19">https://towardsdatascience.com/6-pandas-tricks-you-should-know-to-speed-up-your-data-analysis-d3dec7c29e5?source=collection_archive---------10-----------------------#2020-07-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dace" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一些最有用的熊猫把戏</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dcf31496924cc134b98b8617703966ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0zc5FpwQKOm5d7bIbozXCA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">阿尔瓦罗·雷耶斯在<a class="ae ky" href="https://unsplash.com/s/photos/programming-python?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="9576" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，你将学习一些最有用的熊猫技巧来加速你的数据分析。</p><ol class=""><li id="d006" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">按数据类型选择列</li><li id="aa8c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">将字符串转换为数字</li><li id="443d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">检测和处理缺失值</li><li id="766e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">将连续数字特征转换为分类特征</li><li id="93a5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">从剪贴板创建数据帧</li><li id="f2e3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">从多个文件构建数据框架</li></ol><p id="712c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">源代码请查看我的<a class="ae ky" href="https://github.com/BindiChen/machine-learning/blob/master/data-analysis/005-6-pandas-tricks/6-pandas-tricks.ipynb" rel="noopener ugc nofollow" target="_blank"> Github repo </a>。</p><h1 id="615f" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">1.按数据类型选择列</h1><p id="5f54" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">以下是泰坦尼克号数据帧的数据类型</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="2648" class="nl mk it nh b gy nm nn l no np">df.dtypes</span><span id="5e94" class="nl mk it nh b gy nq nn l no np">PassengerId      int64<br/>Survived         int64<br/>Pclass           int64<br/>Name            object<br/>Sex             object<br/>Age            float64<br/>SibSp            int64<br/>Parch            int64<br/>Ticket          object<br/>Fare           float64<br/>Cabin           object<br/>Embarked        object<br/>dtype: object</span></pre><p id="ca97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您需要选择数字列。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="39a4" class="nl mk it nh b gy nm nn l no np">df.select_dtypes(<strong class="nh iu">include='number'</strong>).head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/768483c8ee67f3552a892e596f8ecc0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qpymHF1czrusCuNeo4fq2Q.png"/></div></div></figure><p id="9f2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这包括 int 和 float 列。您还可以使用此方法来</p><ul class=""><li id="c9ee" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ns mb mc md bi translated">仅选择对象列</li><li id="3cf7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ns mb mc md bi translated">选择多种数据类型</li><li id="daca" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ns mb mc md bi translated">排除某些数据类型</li></ul><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="bc97" class="nl mk it nh b gy nm nn l no np"># select just object columns<br/>df.select_dtypes(<strong class="nh iu">include='object'</strong>)</span><span id="72e1" class="nl mk it nh b gy nq nn l no np"># select multiple data types<br/>df.select_dtypes(<strong class="nh iu">include=['int', 'datetime', 'object']</strong>)</span><span id="d32b" class="nl mk it nh b gy nq nn l no np"># exclude certain data types<br/>df.select_dtypes(<strong class="nh iu">exclude='int'</strong>)</span></pre><h1 id="2e0b" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">2.将字符串转换为数字</h1><p id="2924" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在 Pandas 中有两种方法将字符串转换成数字:</p><ul class=""><li id="867b" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ns mb mc md bi translated"><code class="fe nt nu nv nh b">astype()</code>法</li><li id="ff77" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ns mb mc md bi translated"><code class="fe nt nu nv nh b">to_numeric()</code>方法</li></ul><p id="152b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建一个示例数据帧来看看区别。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="78bc" class="nl mk it nh b gy nm nn l no np">df = pd.DataFrame({ 'product': ['A','B','C','D'], <br/>                   'price': ['10','20','30','40'],<br/>                   'sales': ['20','-','60','-']<br/>                  })</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/725bce3473959e75260b1ff7ffc4241a.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*mRRPTfHSTyejA_IvPPn-vw.png"/></div></figure><p id="f966" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="nx">价格</em> </strong>和<strong class="lb iu"> <em class="nx">销售</em> </strong>列存储为字符串，因此产生对象列:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="06e0" class="nl mk it nh b gy nm nn l no np">df.dtypes</span><span id="d089" class="nl mk it nh b gy nq nn l no np">product    object<br/><strong class="nh iu">price      object<br/>sales      object</strong><br/>dtype: object</span></pre><p id="941d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用第一种方法<code class="fe nt nu nv nh b">astype()</code>对<strong class="lb iu"> <em class="nx">价格</em> </strong>列进行如下转换</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="b29a" class="nl mk it nh b gy nm nn l no np"># Use Python type<br/>df['price'] = df['price']<strong class="nh iu">.astype(int)</strong></span><span id="dc85" class="nl mk it nh b gy nq nn l no np"># alternatively, pass { col: dtype }<br/>df = df.<strong class="nh iu">astype({'price': 'int'})</strong></span></pre><p id="86db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果我们试图在<strong class="lb iu"> <em class="nx"> sales </em> </strong>列中使用它，就会导致错误。为了解决这个问题，我们可以使用带有参数<code class="fe nt nu nv nh b">errors='coerce'</code>的<code class="fe nt nu nv nh b">to_numeric()</code></p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="100c" class="nl mk it nh b gy nm nn l no np">df['sales'] = <strong class="nh iu">pd.to_numeric(df['sales'], errors='coerce')</strong></span></pre><p id="f341" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，无效值<code class="fe nt nu nv nh b">-</code>被转换为<code class="fe nt nu nv nh b">NaN</code>，数据类型为<strong class="lb iu"> float </strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/ec18c67fb508e3a813f4f30b0db7129f.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*dNs77hYLvJX7Dwqzq3gXQA.png"/></div></figure><h1 id="008d" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">3.检测和处理缺失值</h1><p id="16cb" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">检测缺失值的一种方法是使用<code class="fe nt nu nv nh b">info()</code>方法并查看列<strong class="lb iu"> <em class="nx">非空计数</em> </strong>。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="3975" class="nl mk it nh b gy nm nn l no np">df.info()</span><span id="01e0" class="nl mk it nh b gy nq nn l no np">RangeIndex: <strong class="nh iu">891 entries</strong>, 0 to 890<br/>Data columns (total 12 columns):<br/> #   Column       Non-Null Count  Dtype  <br/>---  ------       --------------  -----  <br/> 0   PassengerId  891 non-null    int64  <br/> 1   Survived     891 non-null    int64  <br/> 2   Pclass       891 non-null    int64  <br/> 3   Name         891 non-null    object <br/> 4   Sex          891 non-null    object <br/> <strong class="nh iu">5   Age          714 non-null</strong>    float64<br/> 6   SibSp        891 non-null    int64  <br/> 7   Parch        891 non-null    int64  <br/> 8   Ticket       891 non-null    object <br/> 9   Fare         891 non-null    float64<br/> <strong class="nh iu">10  Cabin        204 non-null</strong>    object <br/> <strong class="nh iu">11  Embarked     889 non-null</strong>    object <br/>dtypes: float64(2), int64(5), object(5)<br/>memory usage: 83.7+ KB</span></pre><p id="c6ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当数据集很大时，我们可以计算缺失值的数量。<code class="fe nt nu nv nh b">df.isnull().sum()</code>返回每列缺失值的数量</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="65b4" class="nl mk it nh b gy nm nn l no np">df.<strong class="nh iu">isnull().sum()</strong></span><span id="a471" class="nl mk it nh b gy nq nn l no np">PassengerId      0<br/>Survived         0<br/>Pclass           0<br/>Name             0<br/>Sex              0<br/>Age            177<br/>SibSp            0<br/>Parch            0<br/>Ticket           0<br/>Fare             0<br/>Cabin          687<br/>Embarked         2<br/>dtype: int64</span></pre><p id="353d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nt nu nv nh b">df.isnull().sum().sum()</code>返回缺失值的总数。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="b48b" class="nl mk it nh b gy nm nn l no np">df.<strong class="nh iu">isnull().sum().sum()</strong></span><span id="e937" class="nl mk it nh b gy nq nn l no np">886</span></pre><p id="781a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，我们还可以通过运行<code class="fe nt nu nv nh b">df.isna().mean()</code>找出缺失值的百分比</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="e32e" class="nl mk it nh b gy nm nn l no np">ufo.isna().mean()</span><span id="813a" class="nl mk it nh b gy nq nn l no np">PassengerId    0.000000<br/>Survived       0.000000<br/>Pclass         0.000000<br/>Name           0.000000<br/>Sex            0.000000<br/>Age            0.198653<br/>SibSp          0.000000<br/>Parch          0.000000<br/>Ticket         0.000000<br/>Fare           0.000000<br/>Cabin          0.771044<br/>Embarked       0.002245<br/>dtype: float64</span></pre><h2 id="582e" class="nl mk it bd ml nz oa dn mp ob oc dp mt li od oe mv lm of og mx lq oh oi mz oj bi translated">删除丢失的值</h2><p id="5956" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">如果存在任何 NaN 值，则删除行</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="67c2" class="nl mk it nh b gy nm nn l no np">df.dropna(<strong class="nh iu">axis = 0</strong>)</span></pre><p id="0365" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果存在任何 NaN 值，则删除列</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="b1f6" class="nl mk it nh b gy nm nn l no np">df.dropna(<strong class="nh iu">axis = 1</strong>)</span></pre><p id="de88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">删除缺少 10%以上值的列</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="ea99" class="nl mk it nh b gy nm nn l no np">df.dropna(<strong class="nh iu">thresh=len(df)*0.9</strong>, <strong class="nh iu">axis=1</strong>)</span></pre><h2 id="fac4" class="nl mk it bd ml nz oa dn mp ob oc dp mt li od oe mv lm of og mx lq oh oi mz oj bi translated">替换丢失的值</h2><p id="bfb7" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">用标量替换所有 NaN 值</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="f321" class="nl mk it nh b gy nm nn l no np">df.fillna(<strong class="nh iu">value=10</strong>)</span></pre><p id="b751" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用前一行中的值替换 NaN 值。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="45dd" class="nl mk it nh b gy nm nn l no np">df.fillna(<strong class="nh iu">axis=0</strong>, <strong class="nh iu">method='ffill'</strong>)</span></pre><p id="3677" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用前一列中的值替换 NaN 值。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="6c51" class="nl mk it nh b gy nm nn l no np">df.fillna(<strong class="nh iu">axis=1</strong>, <strong class="nh iu">method='ffill'</strong>)</span></pre><p id="6548" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，您也可以用下一行或下一列中的值替换 NaN 值。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="d9c8" class="nl mk it nh b gy nm nn l no np"># Replace with the values in the next row<br/>df.fillna(<strong class="nh iu">axis=0</strong>, <strong class="nh iu">method='bfill'</strong>)</span><span id="8476" class="nl mk it nh b gy nq nn l no np"># Replace with the values in the next column<br/>df.fillna(<strong class="nh iu">axis=1</strong>, <strong class="nh iu">method='bfill'</strong>)</span></pre><p id="8d6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一种常见的替换是用平均值替换 NaN 值。例如，用平均值替换列 Age 中的 NaN 值。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="153c" class="nl mk it nh b gy nm nn l no np">df[<strong class="nh iu">'Age'</strong>].fillna(value=<strong class="nh iu">df['Age'].mean()</strong>, inplace=True)</span></pre><p id="2401" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有关 Pandas 中缺失值的更多信息，请查看使用 Pandas 中缺失值的<a class="ae ky" rel="noopener" target="_blank" href="/working-with-missing-values-in-pandas-5da45d16e74"/>。</p><h1 id="5d1c" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">4.将连续数字特征转换为分类特征</h1><p id="e0a9" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在数据准备的步骤中，组合或转换现有要素以创建更有用的要素是很常见的。最流行的方法之一是从连续的数字特征创建分类特征。</p><p id="67eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看泰坦尼克号数据集中的<strong class="lb iu"> <em class="nx">年龄</em> </strong>列</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="c6e5" class="nl mk it nh b gy nm nn l no np">df['Age'].head(8)</span><span id="da02" class="nl mk it nh b gy nq nn l no np">0    22.0<br/>1    38.0<br/>2    26.0<br/>3    35.0<br/>4    35.0<br/>5     NaN<br/>6    54.0<br/>7     2.0<br/>Name: Age, dtype: float64</span></pre><p id="b111" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="nx">年龄</em> </strong>是一个连续的数字属性，但是如果要将其转换为分类属性，比如将年龄转换为年龄范围的组:≤12，青少年(≤18)，成年(≤60)，老年(&gt; 60)怎么办</p><p id="be23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最好的方法是使用 Pandas <code class="fe nt nu nv nh b">cut()</code>功能:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="3430" class="nl mk it nh b gy nm nn l no np">import sys</span><span id="0107" class="nl mk it nh b gy nq nn l no np">df['ageGroup']=pd.cut(<br/>    <strong class="nh iu">df['Age'], </strong><br/>    <strong class="nh iu">bins=[0, 13, 19, 61, sys.maxsize],</strong> <br/>    <strong class="nh iu">labels=['&lt;12', 'Teen', 'Adult', 'Older']</strong><br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/67e37d026fc7d4049b74b4495c46d847.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-6Fzxm0kkPvQLwmDwF77eg.png"/></div></div></figure><p id="7ce8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并且在<strong class="lb iu"> <em class="nx">年龄组</em> </strong>栏上调用<code class="fe nt nu nv nh b">head()</code>也应该显示该栏信息。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="2c59" class="nl mk it nh b gy nm nn l no np">df['ageGroup'].head(8)</span><span id="abd6" class="nl mk it nh b gy nq nn l no np">0    Adult<br/>1    Adult<br/>2    Adult<br/>3    Adult<br/>4    Adult<br/>5      NaN<br/>6    Adult<br/>7      &lt;12<br/><strong class="nh iu">Name: ageGroup, dtype: category</strong><br/><strong class="nh iu">Categories (4, object): [&lt;12 &lt; Teen &lt; Adult &lt; Older]</strong></span></pre><h1 id="4d34" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">5.从剪贴板创建数据帧</h1><p id="c8ac" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">Pandas <code class="fe nt nu nv nh b">read_clipboard()</code>函数是一种非常方便的方法，可以尽快将数据转换成数据帧。</p><p id="8d3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们有以下数据，并希望根据这些数据创建一个数据框:</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="0cbb" class="nl mk it nh b gy nm nn l no np">     product   price<br/>0    A         10<br/>1    B         20<br/>2    C         30<br/>4    D         40</span></pre><p id="ccaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们只需要选择数据并将其复制到剪贴板。然后，我们可以使用函数将它读入数据帧。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="0032" class="nl mk it nh b gy nm nn l no np">df = <strong class="nh iu">pd.read_clipboard()</strong><br/>df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/3f43078ac1cf917d77c5cf9b72c0fd20.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*SQ07CWa9RriLejPnvBhopQ.png"/></div></figure><h1 id="9aab" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">6.从多个文件构建数据框架</h1><p id="ef92" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">数据集可能分布在多个文件中，但您希望将数据集读入单个数据帧中。</p><p id="5ab3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一种方法是将每个文件读入其自己的数据帧，将它们组合在一起，然后删除原始的数据帧，但这将是内存低效的。</p><p id="0bf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更好的解决方案是使用内置的<code class="fe nt nu nv nh b">glob</code>模块(感谢<a class="ae ky" href="https://www.youtube.com/watch?list=PL5-da3qGB5ICCsgW1MxlZ0Hq8LL5U3u9y&amp;time_continue=821&amp;v=RlIiVeig3hc&amp;feature=emb_logo" rel="noopener ugc nofollow" target="_blank">数据学校熊猫诡计</a>)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/58a770a0bbb366f577289e17f2632e27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uGaa6t2V9iR_nFSuYfC4qg.png"/></div></div></figure><p id="c4da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这种情况下，<code class="fe nt nu nv nh b">glob()</code>在<em class="nx">数据</em>目录中查找以单词“<strong class="lb iu"> data_row_ </strong>”开头的所有 CSV 文件。<code class="fe nt nu nv nh b">glob()</code>以任意顺序返回文件名，这就是为什么我们使用<code class="fe nt nu nv nh b">sort()</code>函数对列表进行排序。</p><h2 id="7115" class="nl mk it bd ml nz oa dn mp ob oc dp mt li od oe mv lm of og mx lq oh oi mz oj bi translated">对于行方式的数据</h2><p id="a7b9" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">假设我们的数据集按行分布在两个文件中，<strong class="lb iu"><em class="nx">data _ row _ 1 . CSV</em></strong>和<strong class="lb iu"><em class="nx">data _ row _ 2 . CSV</em></strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/8fca45f6f6dc2732bab13d4d849229e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WTYZRVoIhV6nuuG2cbyocQ.png"/></div></div></figure><p id="550a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这两个文件创建一个数据帧。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="cfb8" class="nl mk it nh b gy nm nn l no np">files = sorted(glob('<strong class="nh iu">data/data_row_*.csv</strong>'))<br/>pd.concat((pd.read_csv(file) for file in files), <strong class="nh iu">ignore_index=True</strong>)</span></pre><p id="e185" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nt nu nv nh b">sorted(glob('<strong class="lb iu">data/data_row_*.csv'</strong>))</code>返回文件名。之后，我们使用<code class="fe nt nu nv nh b">read_csv()</code>读取每个文件，并将结果传递给<code class="fe nt nu nv nh b">concat()</code>函数，该函数将这些行连接成一个数据帧。此外，为了避免索引中的重复值，我们告诉<code class="fe nt nu nv nh b">concat()</code>忽略索引(<code class="fe nt nu nv nh b"><strong class="lb iu">ignore_index=True</strong></code>)，而使用默认的整数索引。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/146dee8e3c7dbbb8e7ed3c43d6d6a839.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*OwyZff6uwbg9S-hSALrlGw.png"/></div></figure><h2 id="70ca" class="nl mk it bd ml nz oa dn mp ob oc dp mt li od oe mv lm of og mx lq oh oi mz oj bi translated">对于按列排列的数据</h2><p id="52da" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">假设我们的数据集以列方式分布在两个文件中，<strong class="lb iu"><em class="nx">data _ col _ 1 . CSV</em></strong>和<strong class="lb iu"><em class="nx">data _ col _ 2 . CSV</em></strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/ca4b7f8b3876c0c257c60522d657e578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x03VpTH5iINQoFh4LRnb_w.png"/></div></div></figure><p id="a597" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这两个文件创建一个数据帧。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="d8e4" class="nl mk it nh b gy nm nn l no np">files = sorted(glob('data/data_col_*.csv'))<br/>pd.concat((pd.read_csv(file) for file in files), <strong class="nh iu">axis=1</strong>)</span></pre><p id="d3b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这一次，我们告诉<code class="fe nt nu nv nh b">concat()</code>函数沿着列轴连接。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/e18b2501a8e9d714a91f4fa9e965e629.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*BjK_ztmHhNlIMvtczD1IUw.png"/></div></figure><h1 id="740d" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">好了</h1><p id="cac1" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">感谢阅读。</p><p id="1cb0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请在我的 Github 上查看<a class="ae ky" href="https://github.com/BindiChen/machine-learning" rel="noopener ugc nofollow" target="_blank">笔记本的源代码。</a></p><p id="be53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你对机器学习的实用方面感兴趣，请继续关注。</p></div></div>    
</body>
</html>