<html>
<head>
<title>How to Automate Excel Files Received on Email - Increase your Productivity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何自动接收电子邮件中的Excel文件-提高您的工作效率</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-automate-excels-received-on-email-increase-your-productivity-3d2f50ddc958?source=collection_archive---------19-----------------------#2020-05-17">https://towardsdatascience.com/how-to-automate-excels-received-on-email-increase-your-productivity-3d2f50ddc958?source=collection_archive---------19-----------------------#2020-05-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a7c1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从电子邮件下载文件并按照我们的要求进行处理的分步指南</h2></div><p id="cb54" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们每天都会收到大量的电子邮件；有些是垃圾邮件，有些是促销邮件，有些很重要，有些非常重要(比如我的故事通知)。管理相同的内容是一个繁琐的过程。让我们把日常工作外包给电脑来减轻我们的负担。</p><p id="4fa8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设多家银行通过电子邮件向我们发送每日交易摘要，我们需要在一个excel中整理这些摘要以执行现金流分析。现在，我们有很多这样的用例，比如来自多个供应商的发票、来自多个员工的MIS(管理信息系统)、工作邀请电子邮件、多个新闻文章等等。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/3c95a53ffde51544064d85f9a8770530.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vsL_KbaHZSVUDqGY"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">由<a class="ae lr" href="https://unsplash.com/@webaroo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Webaroo </a>在<a class="ae lr" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="1101" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">外包这项活动不仅可以减轻我们的工作，还可以通过降低人工出错率来提高我们的生产率。我们将使用强大的ETL工具Pentaho Data Integration (Kettle)来实现这种自动化。我们不必编写一行代码来执行这种自动化。是-没有代码！</p><p id="547e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你没有在你的系统中安装PDI，那么我会建议你仔细阅读下面的分步指南。</p><div class="ls lt gp gr lu lv"><a href="https://medium.com/ai-in-plain-english/pentaho-data-integration-installation-guide-easy-yet-powerful-etl-tool-80930cff46c6" rel="noopener follow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">Pentaho数据集成安装指南-简单而强大的ETL工具。</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">使用简单的图形用户界面构建数据管道，无需编写一行代码。</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">medium.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj ll lv"/></div></div></a></div><h1 id="e8c8" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">用户故事——让我们定义我们的用例</h1><p id="114d" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">如果你一直在跟踪所有的故事，那么我观察到一个标准的模式，比如用简单的英语定义故事，编写测试用例，然后一步一步的过程。</p><ul class=""><li id="03a4" class="nh ni iq kh b ki kj kl km ko nj ks nk kw nl la nm nn no np bi translated">我想从我的Gmail下载银行对账单CSV文件。</li><li id="997f" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la nm nn no np bi translated">我想把收到的信息整理成一个文件。</li></ul><h1 id="3b31" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">输入数据</h1><p id="8f2b" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">理解输入数据和细微差别是一个很好的实践。这有助于我们编写广义逻辑。</p><p id="81d3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些是从Bank-1和Bank-2接收的虚拟交易数据。我们总是可以摆弄真实的数据集。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nv"><img src="../Images/2eba16fe9570d8b491eb735ff775494b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T3rRncIJWCbh0VYYYtDq7A.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">银行1交易数据</p></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nw"><img src="../Images/68dbac296adcb746b6558b6df1b95fe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HI2u15H0pPyF_asQic4yVg.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">Bank - 2交易数据</p></figure><p id="d57e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如您所观察到的，这两个库都遵循预定义的结构，唯一的区别是头的命名约定。我们可以在数据管道流中进行同样的管理。</p><blockquote class="nx ny nz"><p id="5222" class="kf kg oa kh b ki kj jr kk kl km ju kn ob kp kq kr oc kt ku kv od kx ky kz la ij bi translated">请注意，在现实世界中，您不会看到结构相同的场景。然而，我们可以使用元数据注入插件来处理如此复杂的结构。</p></blockquote><h1 id="d1ab" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">测试案例</h1><p id="5c1a" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">让我们为这个管道定义我们的测试用例。</p><ul class=""><li id="87bd" class="nh ni iq kh b ki kj kl km ko nj ks nk kw nl la nm nn no np bi translated">检查输出文件格式。</li><li id="b642" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la nm nn no np bi translated">在输出文件中交叉验证两个供应商的报表中的几个行项目。</li></ul></div><div class="ab cl oe of hu og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ij ik il im in"><h1 id="fd22" class="mk ml iq bd mm mn ol mp mq mr om mt mu jw on jx mw jz oo ka my kc op kd na nb bi translated">步骤1:项目设置</h1><p id="246d" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">理想情况下，建立项目的基本框架是一个很好的实践。正如我在之前的故事中提到的。我更喜欢把我所有的项目存放在一个名为<strong class="kh ir"> Work </strong>的文件夹里。</p><ol class=""><li id="7770" class="nh ni iq kh b ki kj kl km ko nj ks nk kw nl la oq nn no np bi translated"><strong class="kh ir">输入- </strong>这是我们下载报表的地方。</li><li id="7e50" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la oq nn no np bi translated"><strong class="kh ir">输出</strong> -存储我们的输出文件</li><li id="c73b" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la oq nn no np bi translated">这是我们配置和下载电子邮件文件的地方。PDI工作档案。</li><li id="9235" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la oq nn no np bi translated"><strong class="kh ir">Process-Bank-1-file . ktr</strong>&amp;<strong class="kh ir">Process-Bank-2-file . ktr</strong>——这些是我们将在其中处理下载的CSV文件的转换文件。</li></ol><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi or"><img src="../Images/30785677e6dd3fbcaed268d7210078ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wrS2SZ3C57d1OP9RwxKCwg.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">项目文件夹结构</p></figure><p id="9218" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你有任何困难理解上述步骤或勺子(桌面应用程序)，然后要求你通过下面的链接。</p><div class="ls lt gp gr lu lv"><a href="https://medium.com/ai-in-plain-english/getting-started-with-pentaho-data-integration-kettle-and-its-components-ef1e71101323" rel="noopener follow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">Pentaho数据集成(Kettle)及其组件入门。</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">了解勺子、平底锅、厨房等关键部件将使我们对PDI工具有更好的了解</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">medium.com</p></div></div><div class="me l"><div class="os l mg mh mi me mj ll lv"/></div></div></a></div><h1 id="d621" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">步骤2: <strong class="ak">设置应用程序密码</strong></h1><p id="dc69" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">假设我们在Gmail账户中收到了银行对账单。这可以是任何帐户，我们可以阅读电子邮件，只要我们有相同的<a class="ae lr" href="https://docs.servicenow.com/bundle/orlando-servicenow-platform/page/administer/notification/concept/c_OAuthEmailAuthentication.html" rel="noopener ugc nofollow" target="_blank">开放认证(OAuth) </a>细节。</p><p id="dcb9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要设置一个应用程序密码，通过没有双重认证的应用程序读取Gmail。我们需要遵循谷歌提供的<a class="ae lr" href="https://support.google.com/accounts/answer/185833?hl=en" rel="noopener ugc nofollow" target="_blank">指南</a>。下面是截图指南。我们需要在您的个人资料图标中点击“管理您的Google帐户”。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ot"><img src="../Images/83618b2cad737dbabb909dacd3a82a14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aOit3JWVe1JpYpd0NZgPDg.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">点击安全标签，然后点击应用程序密码</p></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ou"><img src="../Images/c18c3536a700decf03ec2a1e48211035.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UaQ_u1Em3sM4e6vNrE9zkQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">在选择应用程序选项中选择“邮件”,然后选择设备其他(自定义名称)</p></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ov"><img src="../Images/6976c407869ceb2d49a533ee1741e138.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*auM7SRGd3W5qQS05qbAXiw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">您将收到一个弹出窗口，要求输入应用程序密码。复制并存储在安全的地方</p></figure><blockquote class="nx ny nz"><p id="da49" class="kf kg oa kh b ki kj jr kk kl km ju kn ob kp kq kr oc kt ku kv od kx ky kz la ij bi translated">请注意，我们不能使用我们的Gmail密码通过PDI或任何其他应用程序来验证或访问电子邮件。我们将不得不创建一个相同的应用程序密码。</p></blockquote><h1 id="caef" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">第三步:让我们阅读Gmail并下载文件</h1><p id="eed0" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">一旦设置了应用程序密码，我们就可以从Gmail下载文件并对其进行分析。下面是我们需要观察的步骤。</p><ul class=""><li id="f70a" class="nh ni iq kh b ki kj kl km ko nj ks nk kw nl la nm nn no np bi translated"><strong class="kh ir">拖动步骤/插件:</strong>在PDI main.kjb作业文件中，我们需要搜索‘开始’，‘获取邮件(pop 3/IMAP)’，‘转换’和‘成功’步骤。</li></ul><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ow"><img src="../Images/7904e7a6ebc20f868710bbd039fa9212.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a7KbQTjbX96CQfwagkeYYg.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">主作业流程</p></figure><ul class=""><li id="2d20" class="nh ni iq kh b ki kj kl km ko nj ks nk kw nl la nm nn no np bi translated"><strong class="kh ir">编辑“获取邮件”步骤属性</strong>:我们需要双击“获取邮件(POP3/IMAP)”步骤并编辑属性。下面是我们需要编辑的属性。</li></ul><ol class=""><li id="ace4" class="nh ni iq kh b ki kj kl km ko nj ks nk kw nl la oq nn no np bi translated">我们需要使用POP3或IMAP来读取和获取文件。你可以通过下面的<a class="ae lr" href="https://developers.google.com/gmail/imap/imap-smtp" rel="noopener ugc nofollow" target="_blank">链接</a>了解更多相同的内容。我们需要将步骤名称重命名为“download_bank_statements”。</li><li id="d6b5" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la oq nn no np bi translated">在<strong class="kh ir">源主机</strong>里，放上imap.gmail.com。我们需要选中<strong class="kh ir">使用SSL </strong>复选框</li><li id="52d1" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la oq nn no np bi translated">我们需要使用<strong class="kh ir">端口</strong>993；这是特定于IMAP和SSL的。您可以参考第1点链接来了解各种端口。</li><li id="1176" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la oq nn no np bi translated">填写你的<strong class="kh ir">用户名</strong>和app <strong class="kh ir">密码</strong>(不要用你的Gmail密码；就不行了)。请注意，medium.blog@gmail.com是一个虚拟地址。</li><li id="9ca4" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la oq nn no np bi translated">将<strong class="kh ir">目标目录</strong>定义为输入路径。确保<strong class="kh ir">获取邮件附件</strong>和不同的文件夹被选中。</li><li id="0cbd" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la oq nn no np bi translated">在<strong class="kh ir">设置</strong>选项卡中，我们需要更改<strong class="kh ir">检索</strong>以获取所有消息选项。这是因为我们可能每天都会收到相同的命名约定文件。或者，我们还可以执行一些活动，比如将电子邮件移动到其他目录，比如“已处理”或删除电子邮件等。</li><li id="e64e" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la oq nn no np bi translated">在<strong class="kh ir">过滤器</strong>选项卡中，我们需要使用<strong class="kh ir">接收日期</strong>过滤器添加一个过滤器。同样，我在这里硬编码了日期。但是，我们可以很容易地使用系统日期变量。我会写一个单独的博客解释PDI的变数。我们也可以去掉这个过滤器；这将获取所有的电子邮件</li></ol><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ox"><img src="../Images/aa4a61f6e1f0705a5bcfaa91438a8600.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XIxaH5E28X8jmdhBqe_I2Q.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">常规选项卡属性</p></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oy"><img src="../Images/362c5253578776038f70b057487f1e10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j7M_S26mnaQif4Jv6w_HBA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">设置选项卡属性</p></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oz"><img src="../Images/558e52751e78353d29a0af537f4fc72d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1KClzqvvLgDuSjPVIEM2EQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">过滤器选项卡属性</p></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pa"><img src="../Images/44545b5b4b157e5535deb0cc068747ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oLvGpx7jOhLaq63wr0wW5w.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">带有电子邮件的收件箱截图示例</p></figure><p id="4972" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">既然我们已经配置了电子邮件下载流程。让我们核对一下这两个文件。</p><h1 id="6af3" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">第四步:整理信息</h1><p id="7a61" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">整理多个工作簿中的信息有多种方法。我们可以创造一个广义的流动；它迎合了多种类型的结构或者创建了一个简单的case转换。我们将使用后者。</p><p id="1b68" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想推广多工作簿处理，那么我会推荐你阅读下面的指南。</p><div class="ls lt gp gr lu lv"><a rel="noopener follow" target="_blank" href="/how-to-automate-multiple-excel-workbooks-and-perform-analysis-13e8aa5a2042"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">如何自动化多个Excel工作簿并执行分析</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">应用这个循序渐进的指南来解决问题，使用神奇的元数据注入PDI。</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">towardsdatascience.com</p></div></div><div class="me l"><div class="pb l mg mh mi me mj ll lv"/></div></div></a></div><p id="6c05" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Process-Bank1-Files.ktr和Process-Bank2-Files.ktr转换是相同的，唯一的区别在于文件名的变化。</p><p id="21c1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打开Process-Bank1-Files.ktr，拖动“文本文件输入”和“Microsoft Excel Writer”。</p><ol class=""><li id="6879" class="nh ni iq kh b ki kj kl km ko nj ks nk kw nl la oq nn no np bi translated">在<strong class="kh ir">文本文件中输入</strong>，我们将把名称改为input。</li><li id="a6cd" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la oq nn no np bi translated">在<strong class="kh ir">文件</strong>页签中，浏览到‘D:\ Work \ automate mail \ Input \ Bank-1-transaction . CSV’；假设银行遵守相同的命名惯例。</li><li id="f6c9" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la oq nn no np bi translated">在<strong class="kh ir">内容</strong>页签中，将<strong class="kh ir">分隔符</strong>改为“，”，<strong class="kh ir">格式</strong>改为mixed。</li><li id="3fe2" class="nh ni iq kh b ki nq kl nr ko ns ks nt kw nu la oq nn no np bi translated">在<strong class="kh ir">字段</strong>选项卡中，点击<strong class="kh ir">获取字段</strong>按钮，并将名称列更改为列1、列2、列3..如下面的邮件所示。</li></ol><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pc"><img src="../Images/e9c8d4226ecddb7e7e4866240f17097d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PsYDvuZxoTryOTadC9bniA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">文件选项卡属性</p></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pc"><img src="../Images/14bd965fd9955eb1f71764c5cd6abe2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s6lgeEhyfflayaBtrAcTCQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">字段选项卡属性</p></figure><p id="930f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在“Microsoft Excel writer”插件和<strong class="kh ir">文件&amp;工作表标签</strong>中，添加输出文件的文件路径(D:\ Work \ automatemulelexcel \ Output \ consolidated statement)，在<strong class="kh ir">扩展名</strong>字段中将扩展名更改为<strong class="kh ir">xlsx【Excel 2007及以上】</strong>，如果输出文件存在字段，则在<strong class="kh ir">中选择<strong class="kh ir">使用现有文件写入</strong>，并选择<strong class="kh ir">写入现有工作表</strong></strong></p><p id="9a6f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在“Microsoft Excel writer”插件和<strong class="kh ir">内容选项卡</strong>中，选择<strong class="kh ir">写入行</strong>时将<strong class="kh ir">中的现有单元格下移</strong>，勾选<strong class="kh ir">在工作表末尾开始写入(追加行)</strong>，勾选<strong class="kh ir">省略标题</strong>字段，点击<strong class="kh ir">获取字段</strong>按钮。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pd"><img src="../Images/c5ad8522ab2a21aa5926851eea517d6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZMRBefRHVXLLJ3L8ABb6pA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">文件和工作表标签属性</p></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pe"><img src="../Images/7a2e1621d8a876f2217ef0aa1038dea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yNY0BsJRVCj0BFiFOCL9pQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">内容选项卡属性</p></figure><p id="0d99" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们需要复制相同的转换，只需将输入文件名更改为D:\ Work \ automate mail \ Input \ Bank-2-transaction . CSV</p><p id="afc1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要在输出文件夹中创建一个空的excel (xlsx)文件，并将其命名为ConsolidatedStatement.xlsx，标题如下。这里的想法是创建一个模板并定期覆盖它。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/6871a9dbee860c86cb91b915c8d37b26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*o6H8zENxZjlc0Bg9frrg9Q.png"/></div></figure><p id="13db" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就这样，让我们看看它是否工作。</p><h1 id="5ed4" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">步骤5:连接、执行作业和测试</h1><p id="fbf1" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">在Main.kjb文件中，我们需要通过顺序浏览来连接作业文件中的两个转换。</p><p id="ec5f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们所有的努力都会在这一步得到理想的实现；在那里我们执行并看到输出。让我们看看我们创建的管道是否按照我们的预期工作。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pg"><img src="../Images/0f056ebf0107fba76629d5043afebca0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VmXIT9aipgbwZD47h26LCA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">成功</p></figure><p id="4703" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我们可以执行前面定义的测试用例，并根据我们的需求分析文件。</p><p id="86ca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">结论</strong></p><p id="3c5a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的数据管道有一些细微的差别，可以调整，也可以推广到多种结构和文件。因为我是根据我的便利来挑选用例的，这可能是也可能不是真实的情况。但是，您可以以此为平台进行构建。我们可以使用PDI执行许多类似的活动。接下来，我们将以如何使用PDI发送电子邮件通知为例。</p><p id="aa6c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">欢迎在评论区提问。</p><h1 id="829e" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated">下一篇文章再见。快乐的ETL</h1></div><div class="ab cl oe of hu og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ij ik il im in"><p id="7021" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你喜欢类似的内容，那么我会推荐你使用下面的链接订阅。</p><div class="ls lt gp gr lu lv"><a href="https://wryteex.com/" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">WryteEx -开发、数据工程、项目管理等</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">我写的博客有数据工程、金融、Python、Python Django、项目管理、Web开发等等……</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">wryteex.com</p></div></div><div class="me l"><div class="ph l mg mh mi me mj ll lv"/></div></div></a></div></div></div>    
</body>
</html>