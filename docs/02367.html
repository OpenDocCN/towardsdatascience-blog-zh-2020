<html>
<head>
<title>Speed up your Data Analysis with Python’s Datatable package</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 的数据表包加速您的数据分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/speed-up-your-data-analysis-with-pythons-datatable-package-56e071a909e9?source=collection_archive---------8-----------------------#2020-03-06">https://towardsdatascience.com/speed-up-your-data-analysis-with-pythons-datatable-package-56e071a909e9?source=collection_archive---------8-----------------------#2020-03-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/03609187765458d4cab3e07bc6de2005.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YzdJfgwYqEeMUmmS"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">由<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kf" href="https://unsplash.com/@chuttersnap?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> chuttersnap </a>拍摄</p></figure><p id="ccf3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">前阵子，我在 Python 的<strong class="ki iu">数据表</strong>库上写了一篇<a class="ae kf" rel="noopener" target="_blank" href="/an-overview-of-pythons-datatable-package-5d3a97394ee9">的文章。本文概述了 datatable 包，其重点是大数据支持和高性能。文章还在某些参数上比较了 datatable 和 pandas 库的性能。这是本系列的第二篇文章，具有双重目标:</a></p><ul class=""><li id="03fc" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">在本文中，我们将通过一个银行贷款场景，使用房利美数据集的子集，尝试理解与 datatable 的数据冲突。我们将学习如何管理贷款级别的数据，获得基本的洞察力，探索性的数据分析</li><li id="0704" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">其次，我们将回顾开源数据科学中流行的各种类似数据库的工具的一些基准。</li></ul><blockquote class="ls lt lu"><p id="7d11" class="kg kh lv ki b kj kk kl km kn ko kp kq lw ks kt ku lx kw kx ky ly la lb lc ld im bi translated">强烈建议在阅读本文之前先阅读第一部分<a class="ae kf" rel="noopener" target="_blank" href="/an-overview-of-pythons-datatable-package-5d3a97394ee9"/>。</p></blockquote></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="3b5b" class="mg mh it bd mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bi translated">数据表:快速概述</h1><figure class="nf ng nh ni gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ne"><img src="../Images/998e9a7419e8a7b670f29c08c97549b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8R1V4E00DJW1Vr9bh1hqkg.png"/></div></div></figure><p id="15c9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://datatable.readthedocs.io/en/latest/?badge=latest" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">Python datatable</strong></a>是一个库，实现了广泛的(且不断增长的)操作二维数据框的操作符。它主要关注:<strong class="ki iu">大数据支持、高性能、内存和内存外数据集，以及多线程算法</strong>。Datatable 强大的 API 与 data.table 的类似，它努力提供更友好和直观的 API 体验，并提供有用的错误消息来加速问题的解决。</p><p id="3526" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据表的一些显著特征是:</p><ul class=""><li id="c41d" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">高效的多线程算法</li><li id="d76c" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">节约内存</li><li id="53cc" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">内存映射的磁盘数据集</li><li id="faf0" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">本机 C++实现</li><li id="3be7" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">完全开源</li></ul><h2 id="da8f" class="nj mh it bd mi nk nl dn mm nm nn dp mq kr no np mu kv nq nr my kz ns nt nc nu bi translated">主数据表语法</h2><p id="e619" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">在 datatable 中，所有这些操作的主要载体是受传统矩阵索引启发的方括号符号。</p><figure class="nf ng nh ni gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oa"><img src="../Images/1d102fdbd1078dce4b19f2be9c7b9501.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iSwJw9xPQNu90lAMtJfJCg.png"/></div></div></figure><p id="ecc2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中，<strong class="ki iu"> i </strong>是行选择器，<strong class="ki iu"> j </strong>是列选择器，<code class="fe ob oc od oe b">...</code>表示附加的修饰符。目前可用的修改器有<code class="fe ob oc od oe b">by()</code>、<code class="fe ob oc od oe b">join()</code>和<code class="fe ob oc od oe b">sort()</code>。这个工具包与熊猫非常相似，但更侧重于速度和大数据支持。</p><blockquote class="ls lt lu"><p id="4861" class="kg kh lv ki b kj kk kl km kn ko kp kq lw ks kt ku lx kw kx ky ly la lb lc ld im bi translated"><a class="ae kf" href="https://datatable.readthedocs.io/en/v0.10.1/quick-start.html#" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu">入门指南</strong> </a> <strong class="ki iu"> </strong>是熟悉数据表的好地方。它包含关于如何开始使用 datable 的深入信息和示例。</p></blockquote><p id="cb85" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们直接进入案例研究，让我们的手变脏。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="8f61" class="mg mh it bd mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bi translated">案例研究:贷款违约预测</h1><figure class="nf ng nh ni gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi of"><img src="../Images/7a21d3d1b36dac5fe05eeecd4bf8cbe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ASLszygs5ByqIc43fJc9A.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">蒂埃拉·马洛卡在<a class="ae kf" href="https://unsplash.com/s/photos/mortgage?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="81a9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">联邦国民抵押贷款协会</strong> ( <strong class="ki iu"> FNMA </strong>)，俗称<a class="ae kf" href="https://www.fanniemae.com/portal/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu">房利美</strong> </a> <strong class="ki iu">，</strong>是一家政府支持的公司，成立于 1938 年声名狼藉的<a class="ae kf" href="https://en.wikipedia.org/wiki/Great_Depression" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu"><em class="lv"/></strong></a>大萧条时期。房利美首先从一级贷款机构(富国银行、美国银行等)购买抵押贷款，然后在债券市场将其作为证券出售。然而，房利美购买的所有贷款都没有偿还，一些借款人实际上违约了。这是一个经典的例子，我们可以使用机器学习来预测房利美收购的贷款是否会丧失抵押品赎回权。</p><h2 id="2220" class="nj mh it bd mi nk nl dn mm nm nn dp mq kr no np mu kv nq nr my kz ns nt nc nu bi translated">资料组</h2><p id="452f" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">数据集来自<a class="ae kf" href="http://www.fanniemae.com/portal/funding-the-market/data/loan-performance-data.html" rel="noopener ugc nofollow" target="_blank">房利美的单户家庭贷款表现数据</a> (SFLP)，房利美保留所有权利。对于完整的原始数据集，你需要在房利美的网站上注册。在撰写本文时，可用的最新数据集来自<code class="fe ob oc od oe b">2019.</code>第三季度，然而，本文使用的是 2014 年第三季度的数据集，可从<a class="ae kf" href="https://app-freddie-mac.s3.amazonaws.com/fannie-mae/2014Q3.zip" rel="noopener ugc nofollow" target="_blank">此处</a>下载。</p><p id="0911" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下载的数据集包含两个名为<strong class="ki iu"> Acquisition.txt </strong>和<strong class="ki iu"> Performance.txt: </strong>的文件</p><ul class=""><li id="4784" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="ki iu">获取数据</strong>:包含每个借款人的个人信息，包括个人的债务收入比、信用评分和贷款金额等。</li><li id="388a" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><strong class="ki iu">性能数据</strong>:包含有关贷款支付历史的信息，以及借款人最终是否拖欠贷款。</li></ul><p id="801c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">关于这两个文件内容的其他信息也可以在网站上以</p><ul class=""><li id="a6a6" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><a class="ae kf" href="https://s3.amazonaws.com/dq-blog-files/lppub_glossary.pdf" rel="noopener ugc nofollow" target="_blank">词汇表</a></li><li id="0b49" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><a class="ae kf" href="https://s3.amazonaws.com/dq-blog-files/lppub_file_layout.pdf" rel="noopener ugc nofollow" target="_blank">包含采集和性能文件中各列的文件布局</a></li></ul><h2 id="fc5a" class="nj mh it bd mi nk nl dn mm nm nn dp mq kr no np mu kv nq nr my kz ns nt nc nu bi translated">目标</h2><p id="1712" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">我们的目标是从这些数据中预测那些最有可能拖欠抵押贷款的借款人。为了开始分析，我们将使用<strong class="ki iu"> Python datatable </strong>来获得从基本 EDA 和数据争论开始的基本见解。</p><p id="b9e6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="lv">整个代码可以从笔记本上访问:</em> <a class="ae kf" href="https://www.kaggle.com/parulpandey/speed-up-your-data-munging-with-python-s-datatable" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu">用 Python 的数据表</strong> </a>加速你的数据管理</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h2 id="cb74" class="nj mh it bd mi nk nl dn mm nm nn dp mq kr no np mu kv nq nr my kz ns nt nc nu bi translated">1.在数据集中读取</h2><ul class=""><li id="813b" class="le lf it ki b kj nv kn nw kr og kv oh kz oi ld lj lk ll lm bi translated"><strong class="ki iu">导入数据表包</strong></li></ul><pre class="nf ng nh ni gt oj oe ok ol aw om bi"><span id="5e83" class="nj mh it oe b gy on oo l op oq">import datatable as dt</span></pre><ul class=""><li id="b811" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="ki iu">加载数据集</strong></li></ul><p id="2d7c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们将使用 datatable 的<code class="fe ob oc od oe b">fread</code>函数读取采集和性能文件。上面的<code class="fe ob oc od oe b">fread()</code>功能既强大又极快。它可以自动检测和解析大多数文本文件的参数，从。压缩档案或网址，阅读 Excel 文件，等等。</p><p id="f901" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现有数据没有列标题，我们需要从<a class="ae kf" href="https://s3.amazonaws.com/dq-blog-files/lppub_file_layout.pdf" rel="noopener ugc nofollow" target="_blank">列</a>文件中手动输入。</p><pre class="nf ng nh ni gt oj oe ok ol aw om bi"><span id="ed15" class="nj mh it oe b gy on oo l op oq">col_acq = ['LoanID','Channel','SellerName','OrInterestRate','OrUnpaidPrinc','OrLoanTerm','OrDate','FirstPayment','OrLTV','OrCLTV','NumBorrow','DTIRat','CreditScore','FTHomeBuyer','LoanPurpose','PropertyType','NumUnits','OccStatus','PropertyState','Zip','MortInsPerc','ProductType','CoCreditScore','MortInsType','RelocationMort']</span><span id="9fec" class="nj mh it oe b gy or oo l op oq">col_per = ['LoanID','MonthRep','Servicer','CurrInterestRate','CAUPB','LoanAge','MonthsToMaturity','AdMonthsToMaturity','MaturityDate','MSA','CLDS','ModFlag','ZeroBalCode','ZeroBalDate','LastInstallDate','ForeclosureDate','DispositionDate','ForeclosureCosts','PPRC','AssetRecCost','MHRC','ATFHP','NetSaleProceeds','CreditEnhProceeds','RPMWP','OFP','NIBUPB','PFUPB','RMWPF',  'FPWA','SERVICING ACTIVITY INDICATOR']</span><span id="41ae" class="nj mh it oe b gy or oo l op oq"><br/>df_acq = dt.fread('../input/Acquisition_2014Q3.txt',columns=col_acq)<br/>df_per = dt.fread('../input/Performance_2014Q3.txt', columns=col_per)</span></pre><p id="f1a4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们检查两个框架的形状。</p><pre class="nf ng nh ni gt oj oe ok ol aw om bi"><span id="4488" class="nj mh it oe b gy on oo l op oq">print(df_acq.shape)<br/>print(df_per.shape)<br/>--------------------------------------------------------------------<br/>(394356, 25)<br/>(17247631, 31)</span></pre><ul class=""><li id="98d9" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="ki iu">查看采集和性能数据框的前几行。</strong></li></ul><p id="276f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">与<strong class="ki iu">熊猫</strong>不同，<code class="fe ob oc od oe b">.head()</code>功能显示一帧的前 10 行，尽管您可以在括号中指定要显示的行数</p><pre class="nf ng nh ni gt oj oe ok ol aw om bi"><span id="efc5" class="nj mh it oe b gy on oo l op oq">df_acq.head(5)</span></pre><figure class="nf ng nh ni gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi os"><img src="../Images/0b1af065c3eaaa4b675600f1bfe455bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CUoRwaIiFb4m-Yc-KLB5iQ.png"/></div></div></figure><pre class="nf ng nh ni gt oj oe ok ol aw om bi"><span id="7e71" class="nj mh it oe b gy on oo l op oq">df_per.head(5))</span></pre><figure class="nf ng nh ni gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ot"><img src="../Images/275487ad572ec5d88580f3276b3e20a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eJO8C3zMHvzp-t-Yq5pQEA.png"/></div></div></figure><p id="0710" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">进度条的颜色表示数据类型，红色表示字符串，绿色表示<code class="fe ob oc od oe b">int</code>，蓝色表示<code class="fe ob oc od oe b">float</code>。</p><h1 id="e6c3" class="mg mh it bd mi mj ou ml mm mn ov mp mq mr ow mt mu mv ox mx my mz oy nb nc nd bi translated">2.数据预处理</h1><p id="e2e4" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">在<strong class="ki iu">性能数据集</strong>中，我们只对<strong class="ki iu"> LoanID </strong>和<strong class="ki iu">止赎日期</strong>列<strong class="ki iu">感兴趣，因为这将为我们提供借款人标识号以及他们最终是否违约。</strong></p><ul class=""><li id="0aeb" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="ki iu">选择特定的列</strong></li></ul><p id="53b1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，让我们只选择<code class="fe ob oc od oe b">LoanID</code>和<code class="fe ob oc od oe b">ForeclosureDate</code>列，并丢弃其余的</p><pre class="nf ng nh ni gt oj oe ok ol aw om bi"><span id="10f2" class="nj mh it oe b gy on oo l op oq">df_per = df_per[:,['LoanID','ForeclosureDate']]<br/>df_per.head(5)</span></pre><figure class="nf ng nh ni gt ju gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/c81b321db96081eecbdf2dc62c86c171.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*euXi7kV6tceZsmgVUT32OA.png"/></div></figure><ul class=""><li id="ab8c" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="ki iu">删除重复实体</strong></li></ul><p id="d87d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">贷款 ID 包含重复的实体。让我们也摆脱他们。</p><pre class="nf ng nh ni gt oj oe ok ol aw om bi"><span id="65e4" class="nj mh it oe b gy on oo l op oq">dt.unique(df_per[:,"LoanID"]).head(5)</span></pre><figure class="nf ng nh ni gt ju gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/6c4fb438d40651513a96a21eb0f875df.png" data-original-src="https://miro.medium.com/v2/resize:fit:476/format:webp/1*DfsP-PNGjn1MvsT-GPMW2w.png"/></div></figure><ul class=""><li id="ae36" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="ki iu">分组</strong></li></ul><p id="4e7b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们用独特的<code class="fe ob oc od oe b">Loan IDs</code>将画面分组。这将确保我们的数据集中只存在唯一的贷款 id。</p><pre class="nf ng nh ni gt oj oe ok ol aw om bi"><span id="56f0" class="nj mh it oe b gy on oo l op oq">df_per = df_per[-1:,:, dt.by(dt.f.LoanID)]<br/>df_per.head(5)</span></pre><figure class="nf ng nh ni gt ju gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/38fec095618239150a2816001db7ad39.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*lfvGLfbITZAmBDOL7dEeCg.png"/></div></figure><blockquote class="ls lt lu"><p id="003e" class="kg kh lv ki b kj kk kl km kn ko kp kq lw ks kt ku lx kw kx ky ly la lb lc ld im bi translated"><em class="it"/><a class="ae kf" href="https://datatable.readthedocs.io/en/latest/f-expressions.html" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu"><em class="it">f 表达式</em> </strong> </a> <em class="it">支持算术运算以及各种数学和聚合函数。</em></p></blockquote><ul class=""><li id="172f" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="ki iu">加入收购和业绩框架</strong></li></ul><p id="26b6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们通过使用<code class="fe ob oc od oe b">LoanID</code>列执行内部连接来合并<code class="fe ob oc od oe b">Acquisition</code>和<code class="fe ob oc od oe b">Performance</code>帧。让我们将产生的数据框架命名为<code class="fe ob oc od oe b">df.</code>，这个框架由<code class="fe ob oc od oe b">ForeclosureDate</code>列组成，我们将使用它作为我们的目标变量。让我们将该列重命名为<code class="fe ob oc od oe b">Will_Default</code>以避免任何混淆。</p><pre class="nf ng nh ni gt oj oe ok ol aw om bi"><span id="6c4b" class="nj mh it oe b gy on oo l op oq">df_per.names = ['LoanID','Will_Default']<br/>df_per.key = 'LoanID'<br/>df= df_acq[:,:,dt.join(df_per)]</span></pre><ul class=""><li id="4f16" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="ki iu">格式化目标列</strong></li></ul><p id="7b62" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe ob oc od oe b">Will Default</code>列由日期组成。例如，如果借款人已经偿还了贷款，那么就要提到偿还贷款的日期。但是，如果贷款尚未偿还，则该字段留空。让我们用“0”替换空白值，即贷款从未支付，并用一些值作为“1”填写。这意味着借款人没有违约，即在某个日期偿还了贷款。</p><pre class="nf ng nh ni gt oj oe ok ol aw om bi"><span id="b98f" class="nj mh it oe b gy on oo l op oq"><em class="lv"># Replacing the dates in the Will_Default column with '0' and null values with 1</em><br/>df[:,'Will_Default'] = df[:, {'Will_Default': dt.f['Will_Default']==""}]<br/>df.head(5)</span></pre><figure class="nf ng nh ni gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pc"><img src="../Images/fc83dc4d1c0bfba770d62083d1824b68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sILocbai86AO3ZYb8AYoQA.png"/></div></div></figure><p id="b7df" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，让我们看看处理过的数据集的形状。</p><pre class="nf ng nh ni gt oj oe ok ol aw om bi"><span id="695c" class="nj mh it oe b gy on oo l op oq">df.shape<br/>-------------------------------------------------------<br/>(394356, 26)</span></pre><p id="6915" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">dataframe 有<strong class="ki iu"> 394356 </strong>行和<strong class="ki iu"> 26 </strong>列，包含有关贷款利率、支付日期、财产状态和每个财产邮政编码的最后几个数字等信息。从这里开始，数据就可以输入到用于训练目的的模型中。人们也可以将其转换成熊猫数据帧、CSV 文件或二进制文件。jay 文件如下:</p><pre class="nf ng nh ni gt oj oe ok ol aw om bi"><span id="2700" class="nj mh it oe b gy on oo l op oq"><em class="lv">df.to_pandas()</em><br/><em class="lv">df.to_csv("out.csv")</em><br/><em class="lv">df.to_jay("data.jay")</em></span></pre></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="c3a6" class="mg mh it bd mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bi translated">类似数据库的运营基准</h1><p id="3a1b" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">今天，数据科学生态系统中存在许多类似数据库的工具。为了比较它们的性能，已经创建了一个<a class="ae kf" href="https://h2oai.github.io/db-benchmark/" rel="noopener ugc nofollow" target="_blank">基准</a>,它定期运行这些软件包的最新版本，并自动更新。这对包的开发者和用户都是有益的。你可以在 Matt Dowle 在 H2OWorld 2019 NYC conference 上发表的<a class="ae kf" href="https://jangorecki.gitlab.io/r-talks/2019-12-26_Mumbai_Efficiency-in-data-processing/Efficiency-in-data-processing.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="lv">数据处理效率</em>幻灯片</a>和<a class="ae kf" href="https://www.youtube.com/watch?v=fZpA_cU0SPg" rel="noopener ugc nofollow" target="_blank">演讲中了解更多关于该项目的信息。</a></p><h2 id="389c" class="nj mh it bd mi nk nl dn mm nm nn dp mq kr no np mu kv nq nr my kz ns nt nc nu bi translated">阅读基准</h2><p id="bc78" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">您可以单击选项卡，查看您拥有的数据的大小和正在执行的操作的类型。然后，您会看到各种工具的并排比较，以及任务所用的时间。例如，下面是在 5 GB 和 50GB 数据集上执行的'<strong class="ki iu"> join </strong>'函数的基准测试，可以看出，datatable 运行得非常好。</p><ul class=""><li id="320b" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="ki iu"> 5GB 数据集</strong></li></ul><figure class="nf ng nh ni gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pd"><img src="../Images/de77c5b239e40f1e1806e9c7be8d887a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tjdMtAjaJzZaf1ZDy5_UAw.png"/></div></div></figure><ul class=""><li id="17e1" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="ki iu"> 50 GB 数据集</strong></li></ul><figure class="nf ng nh ni gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pe"><img src="../Images/52c0b7099fad7200aa9b5d3789dc1f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hYlX3iG1NBy5Ucg2Cb42oA.png"/></div></div></figure><p id="60e7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如需了解更多任务和其他详细信息，请随时查看该页面:</p><p id="916f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://h2oai.github.io/db-benchmark/" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu">类似数据库的 ops 基准</strong> </a></p><div class="pf pg gp gr ph pi"><a href="https://h2oai.github.io/db-benchmark/" rel="noopener  ugc nofollow" target="_blank"><div class="pj ab fo"><div class="pk ab pl cl cj pm"><h2 class="bd iu gy z fp pn fr fs po fu fw is bi translated">类似数据库的运营基准</h2><div class="pp l"><h3 class="bd b gy z fp pn fr fs po fu fw dk translated">该页面旨在对开源数据科学中流行的各种类似数据库的工具进行基准测试。它定期与…运行</h3></div><div class="pq l"><p class="bd b dl z fp pn fr fs po fu fw dk translated">h2oai.github.io</p></div></div><div class="pr l"><div class="ps l pt pu pv pr pw jz pi"/></div></div></a></div></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="4921" class="mg mh it bd mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bi translated">结论</h1><p id="b0b9" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">在处理大数据时，datatable 包确实大放异彩。<a class="ae kf" href="https://datatable.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">由于强调大数据支持</a>，datatable 提供了许多好处，并且确实可以缩短在数据集上执行数据争论任务所需的时间。Datatable 是一个开源项目，因此它对贡献和合作开放，以改进它并使它变得更好。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h1 id="96e1" class="mg mh it bd mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bi translated">参考资料和有用的资源</h1><p id="6f19" class="pw-post-body-paragraph kg kh it ki b kj nv kl km kn nw kp kq kr nx kt ku kv ny kx ky kz nz lb lc ld im bi translated">以下是一些有助于理解和了解更多关于 datatable 特性的资源:</p><ol class=""><li id="7658" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld px lk ll lm bi translated"><a class="ae kf" href="https://datatable.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu">官方文档</strong> </a></li><li id="ab46" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld px lk ll lm bi translated"><a class="ae kf" href="https://github.com/vopani/datatableton" rel="noopener ugc nofollow" target="_blank"/></li></ol></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="06c5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://www.h2o.ai/blog/speed-up-your-data-analysis-with-pythons-datatable-package/" rel="noopener ugc nofollow" target="_blank"> <em class="lv">原发布于 H2O.ai </em> </a></p></div></div>    
</body>
</html>