<html>
<head>
<title>Labeling Data with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用熊猫标注数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/labeling-data-with-pandas-9e573ce59c42?source=collection_archive---------9-----------------------#2020-07-04">https://towardsdatascience.com/labeling-data-with-pandas-9e573ce59c42?source=collection_archive---------9-----------------------#2020-07-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3a0a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">熊猫数据标签简介</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9afa6af61ec9270a57285953e0836200.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sQq9NxLu5rYoGwrjDqlkGA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.pexels.com/photo/white-product-label-1111319/" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="f5a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据标注是将信息标签分配给数据子集的过程。有许多标记数据集的例子。包含癌性和健康肺的 x 射线图像以及它们各自的标签的数据是标记数据的一个例子。另一个例子是消费者信用数据，它指定消费者是否拖欠贷款。在获得标记的数据集后，机器学习模型可以在标记的数据上训练，并用于预测新的未标记的例子。拥有良好的标记数据对于构建高性能机器学习模型至关重要。在本帖中，我们将讨论使用 python 熊猫库生成有意义标签的过程。</p><p id="8f30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><p id="da70" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将考虑标记数字数据的任务。出于我们的目的，我们将使用<em class="lv">红酒质量数据集</em>，它可以在<a class="ae ky" href="https://www.kaggle.com/uciml/red-wine-quality-cortez-et-al-2009" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="ec50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们将数据读入熊猫数据框:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="b5b3" class="mb mc it lx b gy md me l mf mg">import pandas as pd<br/>df_wine = pd.read_csv("winequality-red.csv")</span></pre><p id="1d05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们使用。“head()”方法。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="8445" class="mb mc it lx b gy md me l mf mg">print(df_wine.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/e64eb41185b6b0884e16fde10159f4de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2gMb98YaZu-Rysv-jkGP7A.png"/></div></div></figure><p id="ba93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该数据对应于质量分数在 0 到 10 之间的葡萄酒。让我们看看数据中的值:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="2bfb" class="mb mc it lx b gy md me l mf mg">print("Quality values: ", set(df_wine['quality']))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/16d16365c94de407a23684465c3ac641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*1RzUW9VHwwQmKPrewgUHqQ.png"/></div></figure><p id="3cff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们对另一个分类问题感兴趣，而不是对葡萄酒质量进行分类。让我们考虑一下对一种酒的酒精含量是否在 10%以上进行分类的问题。让我们来看看酒精百分比的最小值和最大值:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="9ceb" class="mb mc it lx b gy md me l mf mg">print("Max Alcohol %: ", df_wine['alcohol'].max())<br/>print("Min Alcohol %: ", df_wine['alcohol'].min())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/be40be4d6c9f108d07fbb5b888dac00d.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*udfKoWnqLfGA0Jzy8VPExQ.png"/></div></figure><p id="355e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们也画出分布图:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="bf62" class="mb mc it lx b gy md me l mf mg">import matplotlib.pyplot as plt<br/>plt.title("Distribution in Alcohol %")<br/>df_wine['alcohol'].hist()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/dfb4cbd4dc19a1b857992ec75fb1fb93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t1OstNqlfrtPGL0KkjZc1A.png"/></div></div></figure><p id="b96d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果酒精百分比高于或等于 10%，我们将用“1”标记数据，否则用“0”标记数据:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="ceeb" class="mb mc it lx b gy md me l mf mg">import numpy as np<br/>df_wine['alcohol_class'] = np.where(df_wine['alcohol']&gt;=10.0, '1', '0')</span></pre><p id="bdfc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以用二进制标签来可视化分布:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="0884" class="mb mc it lx b gy md me l mf mg">from collections import Counter<br/>plt.title("Distribution in Alcohol Class Labels")<br/>plt.bar(dict(Counter(df_wine['alcohol_class'])).keys(), dict(Counter(df_wine['alcohol_class'])).values())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/3b59952e9764c56db41e66ba04c3a751.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WVChdjcW-MvBw9wlmXAHMg.png"/></div></div></figure><p id="cd5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该数据被适当地标记用于训练二元分类模型。现在让我们考虑二进制分类以外的问题。如果我们看一下“固定酸度”的最小值和最大值，我们会发现这些值的范围比酒精%的范围更宽:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="b663" class="mb mc it lx b gy md me l mf mg">print("Max fixed acidity %: ", df_wine['fixed acidity'].max())<br/>print("Min fixed acidity %: ", df_wine['fixed acidity'].min())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/b86396491bbfd12b928328b248ff54a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*MvxGERAGLGhp5HU-AAx8uA.png"/></div></figure><p id="4116" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以用熊猫的。loc[]'方法将三元标签分配给数据，这将把数据分成三组。标签“0”将被分配给值(4–7)，“1”将被分配给值(7–9)，“2”将被分配给值(9–16):</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="1210" class="mb mc it lx b gy md me l mf mg">df_wine.loc[(df_wine['fixed acidity']&gt;4.0) &amp; (df_wine['fixed acidity']&lt;=7.0), 'acidity_class'] = 0<br/>df_wine.loc[(df_wine['fixed acidity']&gt;7.0) &amp; (df_wine['fixed acidity']&lt;=9.0), 'acidity_class'] = 1<br/>df_wine.loc[(df_wine['fixed acidity']&gt;9.0) &amp; (df_wine['fixed acidity']&lt;=16.0), 'acidity_class'] = 2</span></pre><p id="7cc6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以直观地看到三元标签中的分布:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="bc27" class="mb mc it lx b gy md me l mf mg">plt.title("Distribution in Alcohol Class Labels")<br/>plt.bar(dict(Counter(df_wine['acidity_class'])).keys(), dict(Counter(df_wine['acidity_class'])).values())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/6aaf0f241eb073c2e8e4c15b05eaf254.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mv90nSNbLinUTcpRFku8tg.png"/></div></div></figure><p id="d4b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据现在被适当地标记，用于训练三元分类模型。这可以很容易地扩展到四进制、五进制等。我就讲到这里，但是我鼓励你自己动手处理数据和编写代码。</p><h1 id="42a9" class="mo mc it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">结论</h1><p id="fe2a" class="pw-post-body-paragraph kz la it lb b lc nf ju le lf ng jx lh li nh lk ll lm ni lo lp lq nj ls lt lu im bi translated">总之，在这篇文章中，我们讨论了如何使用熊猫来标注数据。首先，我们考虑了为葡萄酒数据分配二进制标签的任务，该标签指示葡萄酒的酒精含量是否高于 10%。然后，我们看了看指定三元标签，表明葡萄酒中固定酸度的水平。我希望你觉得这篇文章有用/有趣。这篇文章的代码可以在 GitHub 上找到。感谢您的阅读！</p></div></div>    
</body>
</html>