<html>
<head>
<title>Simple Twitter analytics with twitter-nlp-toolkit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 twitter-nlp-toolkit 进行简单的 Twitter 分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simple-twitter-analytics-with-twitter-nlp-toolkit-7d7d79bf2535?source=collection_archive---------37-----------------------#2020-07-07">https://towardsdatascience.com/simple-twitter-analytics-with-twitter-nlp-toolkit-7d7d79bf2535?source=collection_archive---------37-----------------------#2020-07-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3f28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Twitter 是商业分析和学术或教学自然语言处理最丰富的数据源之一；Kaggle 上的许多<a class="ae kl" href="https://www.kaggle.com/kazanova/sentiment140" rel="noopener ugc nofollow" target="_blank">顶级</a> <a class="ae kl" href="https://www.kaggle.com/crowdflower/twitter-airline-sentiment" rel="noopener ugc nofollow" target="_blank">数据集</a>是在 Twitter 上收集的，<a class="ae kl" href="https://nlp.stanford.edu/projects/glove" rel="noopener ugc nofollow" target="_blank">最受欢迎的文本嵌入之一</a>是使用 Twitter 训练的，几乎每个公司都在积极监控 Twitter。</p><p id="8b01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">原因有很多:Twitter 有一个可访问的 API，它的 hashtag 系统使数据收集和分类变得容易。也是因为 Twitter 是一个令人难以置信的两极分化和反动的平台；当某件事成为“推特上的流行趋势”时，它通常是一个令人震惊的产品公告，一个受到批评的新版本，或者有人说了一些煽动性的话。这使得 Twitter 成为公众情绪的一个极其强大的信息来源。我和我的合作者注意到，我们经常被分派收集和分析 Twitter 数据的任务，所以我们决定为此构建一个用户友好的包— <a class="ae kl" href="https://pypi.org/project/twitter-nlp-toolkit/" rel="noopener ugc nofollow" target="_blank"> twitter-nlp-toolkit </a>。在这里，我将通过我今年早些时候制作的一个可视化展示来告诉你如何使用它，展示伊隆·马斯克在 Twitter 上的几个煽动性评论的影响。</p><p id="f543" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，你需要注册一个 Twitter API 密匙，安装软件包，并安装 Spacy 的<code class="fe km kn ko kp b">en_core_web_sm</code>模型。你可以很容易地做第一个<a class="ae kl" href="https://developer.twitter.com" rel="noopener ugc nofollow" target="_blank">这里</a>——你将被简单地要求提供一个你正在做的需要一个的快速描述——后两个甚至更容易；只需在你的终端中运行<code class="fe km kn ko kp b">pip install twitter-nlp-toolkit</code>和<code class="fe km kn ko kp b">python -m spacy download en_core_web_sm</code>。<code class="fe km kn ko kp b">twitter-nlp-toolkit</code>需要<br/> <code class="fe km kn ko kp b">tensorflow ≥2</code>和<code class="fe km kn ko kp b">scikit-learn ≥0.22</code>，所以你可能要把它安装在一个新的虚拟环境里。</p><h2 id="75dc" class="kq kr iq bd ks kt ku dn kv kw kx dp ky jy kz la lb kc lc ld le kg lf lg lh li bi translated">倾听</h2><p id="2e80" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">Twitter API 的主要产品是一个监听器，它允许您将 tweets 实时传输到磁盘。搜索逻辑记录在<a class="ae kl" href="https://developer.twitter.com/en/docs/tweets/rules-and-filtering/overview/standard-operators" rel="noopener ugc nofollow" target="_blank">这里</a>。首先，将您的 Twitter API 密匙作为<code class="fe km kn ko kp b">keys.key</code>以<code class="fe km kn ko kp b">.json</code>格式保存在您的工作目录中，如下所示:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="c18e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以建立你的听众。这将监听包含“Musk”和/或“Tesla”的推文(如果你想要两个关键词，只需设置<code class="fe km kn ko kp b">target_words = [‘Musk Tesla’]</code>)。)</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="ead4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将持续不断地将所有包含“Musk”<strong class="jp ir">和/或</strong>“Tesla”的推文发送到<code class="fe km kn ko kp b">musk_tweets.json</code>。该文件可能会变得非常大，并且包含许多可能无关的信息，因此应该监控磁盘使用情况。比如这条推文:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/956b1327a2712fa93ad345fbf56d2140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*UjPts7IjDO8QAt6NlgrPLQ.png"/></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">“我对@elonmusk 的看法现在是零，开尔文。”— @AltPublicLands</p></figure><p id="1964" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">被保存为超过 10kB 的信息:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mc"><img src="../Images/c2434ca379385a77a49a2b4dcf8b510b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YvMH5eE6h-Wek5HurfSf3A.png"/></div></div></figure><p id="d82d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">呀。解析器会将包含 tweets 的<code class="fe km kn ko kp b">.json</code>文件转换成更易于管理的<code class="fe km kn ko kp b">.csv</code>文件:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="812e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">生产<code class="fe km kn ko kp b">parsed_musk_tweets.csv</code>:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="7545" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(因为我们没有商业 Twitter API 密匙，所以我们看不到用户的确切位置。)</p><p id="14c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还可以使用批量下载工具获取马斯克本人最后 200 条左右的推文:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div></figure><p id="ceaf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将产生已经以<code class="fe km kn ko kp b">.csv</code>格式解析的 tweets。</p><h1 id="cac5" class="mh kr iq bd ks mi mj mk kv ml mm mn ky mo mp mq lb mr ms mt le mu mv mw lh mx bi translated">情感分析</h1><p id="0194" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated"><code class="fe km kn ko kp b">twitter_nlp_toolkit </code>还包括一个情绪分析包，可以评估推文的正面或负面:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">情感分类代码</p></figure><p id="05df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe km kn ko kp b"> predict()</code>函数产生二元预测——0 表示负数，1 表示正数——而<code class="fe km kn ko kp b">predict_proba() </code>产生连续预测。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">我们的模特意识到这不是赞美</p></figure><p id="8d98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在 Tableau 中将推文量和平均情绪绘制为时间的函数，产生了以下可视化效果，表明虽然 Twitter 对淡化新冠肺炎严重性的推文有些担忧，但他们对关于特斯拉高股价的推文更加担忧。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi my"><img src="../Images/1fb6d0056e251f40fda92f654f9a80e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B_HNAhx7Z5KNCffr7BuZiQ.png"/></div></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">随着时间的推移，受平均情绪影响的推文量。对比度得到增强，以提高可见度。</p></figure><p id="e152" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">也可以利用用户账户位置来产生估计的地理地图。这里我使用了 Tableau 的地理编码服务；然而，Tableau 只能解释不到 20%的用户提供的位置，其中一些解释是不可信或不准确的。谷歌地图可能会做得更好，但免费层每天的请求数量限制在 2000 个左右:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mz"><img src="../Images/6482d315daf1d083b0d0ae2889e10fe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1C7jVbPUkAocvFzNNAKCgA.png"/></div></div></figure><p id="1f7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里还应该注意的是，在我们的测试中，情感分析只有大约 85%的准确性，在野外可能不太准确；我们的情感分析工具仅使用<a class="ae kl" href="https://www.kaggle.com/kazanova/sentiment140" rel="noopener ugc nofollow" target="_blank">sensition 140</a>数据集对文本内容进行训练，该数据集已相当陈旧。虽然我们正在努力改进模型，但它们可能只用于观察趋势，而不是对单个推文进行分类，除非它们可以在领域数据上进行微调。</p><h1 id="421a" class="mh kr iq bd ks mi mj mk kv ml mm mn ky mo mp mq lb mr ms mt le mu mv mw lh mx bi translated">功能愿望列表</h1><p id="a893" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">该软件包仍在积极开发中，但这里显示的功能应该不会中断。当前的优先任务包括改进情感分析模型，提高推文解析和语言预处理的效率和定制，以及集成谷歌地理编码 API。</p><p id="f8d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">软件包中的所有代码，包括更多的例子，都托管在<a class="ae kl" href="https://github.com/eschibli/twitter-toolbox" rel="noopener ugc nofollow" target="_blank"> Github 这里</a>。我们鼓励读者带着问题或功能需求联系开发人员。</p></div></div>    
</body>
</html>