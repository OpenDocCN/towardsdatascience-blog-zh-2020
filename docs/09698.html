<html>
<head>
<title>Time-Series Forecasting: Predicting Stock Prices Using An LSTM Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列预测:使用 LSTM 模型预测股票价格</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/lstm-time-series-forecasting-predicting-stock-prices-using-an-lstm-model-6223e9644a2f?source=collection_archive---------0-----------------------#2020-07-10">https://towardsdatascience.com/lstm-time-series-forecasting-predicting-stock-prices-using-an-lstm-model-6223e9644a2f?source=collection_archive---------0-----------------------#2020-07-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="98d1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在这篇文章中，我将向你展示如何使用预测 LSTM 模型来预测股票价格</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e43e11f17a02503f2b03097befd1fcbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sGz5qx3EefIG7CJ4mfZBOg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者创作的人物。</p></figure><h1 id="eb08" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">1.介绍</h1><h2 id="5f31" class="lq kz it bd la lr ls dn le lt lu dp li lv lw lx lk ly lz ma lm mb mc md lo me bi translated">1.1.时间序列和预测模型</h2><p id="dfb2" class="pw-post-body-paragraph mf mg it mh b mi mj ju mk ml mm jx mn lv mo mp mq ly mr ms mt mb mu mv mw mx im bi translated">传统上，大多数机器学习(ML)模型使用一些观察值(样本/实例)作为输入特征，但数据中没有<strong class="mh iu">时间</strong> <strong class="mh iu">维度</strong>。</p><p id="f306" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated"><strong class="mh iu">时间序列预测</strong>模型是能够根据<strong class="mh iu">先前</strong> <strong class="mh iu">观测</strong> <strong class="mh iu">值</strong>预测 <strong class="mh iu">未来值</strong>的模型。时间序列预测广泛用于<strong class="mh iu">非平稳数据</strong>。<strong class="mh iu">非平稳数据</strong>被称为统计属性(如平均值和标准偏差)不随时间保持不变，而是随时间变化的数据。</p><p id="0d02" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">这些非平稳输入数据(用作这些模型的输入)通常被称为<strong class="mh iu">时间序列。</strong>时间序列的一些例子包括随时间变化的温度值、随时间变化的股票价格、随时间变化的房屋价格等。因此，输入是一个<strong class="mh iu">信号</strong>(时间序列),它是由在时间中连续获得的观察值<strong class="mh iu">定义的。</strong></p><blockquote class="nd"><p id="1b1c" class="ne nf it bd ng nh ni nj nk nl nm mx dk translated">时间序列是按时间顺序进行的一系列观察。</p></blockquote><figure class="no np nq nr ns kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/c1f817b09e401ba3c29023c4fddd2e2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SULcaLxjHsAVmhxG7Xo0cA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">时间序列的一个例子。作者用 Python 创作的情节。</p></figure><p id="24f6" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated"><strong class="mh iu">观察:时序</strong>数据记录在<strong class="mh iu">离散</strong>时间<strong class="mh iu">刻度</strong>时间<strong class="mh iu">刻度</strong>上。</p><p id="431d" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated"><strong class="mh iu">免责声明</strong>(在我们继续之前):已经有人尝试使用时间序列分析算法来预测股票价格，尽管它们仍然不能用于在真实市场中下注。这只是一篇教程文章，并不打算以任何方式“指导”人们购买股票。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h2 id="00ce" class="lq kz it bd la lr ls dn le lt lu dp li lv lw lx lk ly lz ma lm mb mc md lo me bi translated">——我的邮件列表只需 5 秒:<a class="ae oa" href="https://seralouk.medium.com/subscribe" rel="noopener">https://seralouk.medium.com/subscribe</a></h2><h2 id="d38d" class="lq kz it bd la lr ls dn le lt lu dp li lv lw lx lk ly lz ma lm mb mc md lo me bi translated">-成为会员支持我:<a class="ae oa" href="https://seralouk.medium.com/membership" rel="noopener">https://seralouk.medium.com/membership</a></h2></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="b22d" class="ky kz it bd la lb ob ld le lf oc lh li jz od ka lk kc oe kd lm kf of kg lo lp bi translated">2.LSTM 模式</h1><p id="5d9c" class="pw-post-body-paragraph mf mg it mh b mi mj ju mk ml mm jx mn lv mo mp mq ly mr ms mt mb mu mv mw mx im bi translated"><strong class="mh iu">长短期记忆</strong> ( <strong class="mh iu"> LSTM </strong>)是一种用于深度学习领域的人工递归神经网络(RNN)架构。与标准的前馈神经网络不同，LSTM 有反馈连接。它不仅可以处理单个数据点(例如图像)，还可以处理整个数据序列(例如语音或视频输入)。</p><p id="a068" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">LSTM 模型能够储存一段时间的信息。</p><blockquote class="nd"><p id="9048" class="ne nf it bd ng nh ni nj nk nl nm mx dk translated">换句话说，它们有记忆能力。记住，LSTM 代表<strong class="ak">长短期记忆模型。</strong></p></blockquote><p id="0d5b" class="pw-post-body-paragraph mf mg it mh b mi og ju mk ml oh jx mn lv oi mp mq ly oj ms mt mb ok mv mw mx im bi translated">当我们处理时间序列或顺序数据时，这个特性是非常有用的。当使用 LSTM 模型时，我们可以自由决定存储什么信息，丢弃什么信息。我们使用“门”来实现。对 LSTM 的深入理解超出了这篇文章的范围，但是如果你有兴趣了解更多，看看这篇文章末尾的参考资料。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><p id="37e2" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">如果你想在交互式路线图和活跃的学习社区的支持下自学数据科学，看看这个资源:【https://aigents.co/learn<a class="ae oa" href="https://aigents.co/learn" rel="noopener ugc nofollow" target="_blank"/></p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="19d3" class="ky kz it bd la lb ob ld le lf oc lh li jz od ka lk kc oe kd lm kf of kg lo lp bi translated">3.获取股票价格历史数据</h1><p id="6c9a" class="pw-post-body-paragraph mf mg it mh b mi mj ju mk ml mm jx mn lv mo mp mq ly mr ms mt mb mu mv mw mx im bi translated">感谢<strong class="mh iu">雅虎财经</strong>我们可以免费<strong class="mh iu">获得</strong>的数据。使用以下链接获取<strong class="mh iu">特斯拉</strong>:<a class="ae oa" href="https://finance.yahoo.com/quote/TSLA/history?period1=1436486400&amp;period2=1594339200&amp;interval=1d&amp;filter=history&amp;frequency=1d" rel="noopener ugc nofollow" target="_blank">https://finance.yahoo.com/quote/TSLA/history?的股价历史周期 1=1436486400 &amp;周期 2=1594339200 &amp;间隔=1d &amp;过滤器=历史&amp;频率=1d </a></p><p id="fde0" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">您应该看到以下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/22b7285dc102e7cfce06bd36a9656f65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ClLXfFKG6zL3RsZI1jrZaw.png"/></div></div></figure><p id="5df7" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">点击<strong class="mh iu">下载</strong>并保存<strong class="mh iu">。csv </strong>文件本地保存在您的计算机上。</p><p id="0fc3" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">数据是从<strong class="mh iu"> 2015 </strong>到现在(<strong class="mh iu"> 2020 </strong>)！</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="3ea1" class="ky kz it bd la lb ob ld le lf oc lh li jz od ka lk kc oe kd lm kf of kg lo lp bi translated">4.Python 工作示例</h1><p id="c79f" class="pw-post-body-paragraph mf mg it mh b mi mj ju mk ml mm jx mn lv mo mp mq ly mr ms mt mb mu mv mw mx im bi translated">所需模块:Keras，Tensorflow，Pandas，Scikit-Learn &amp; Numpy </p><p id="c5e8" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">我们将构建一个<strong class="mh iu">多层 LSTM 递归神经网络</strong>来<strong class="mh iu">预测</strong>一系列值中的<strong class="mh iu">最后一个值，即本例中的特斯拉股票价格。</strong></p><p id="4ae6" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">让<strong class="mh iu">加载</strong>数据<strong class="mh iu">数据</strong>和<strong class="mh iu">检查</strong>它们:</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="a100" class="lq kz it oo b gy os ot l ou ov">import math<br/>import matplotlib.pyplot as plt<br/>import keras<br/>import pandas as pd<br/>import numpy as np<br/>from keras.models import Sequential<br/>from keras.layers import Dense<br/>from keras.layers import LSTM<br/>from keras.layers import Dropout<br/>from keras.layers import *<br/>from sklearn.preprocessing import MinMaxScaler<br/>from sklearn.metrics import mean_squared_error<br/>from sklearn.metrics import mean_absolute_error<br/>from sklearn.model_selection import train_test_split<br/>from keras.callbacks import EarlyStopping</span><span id="f3f6" class="lq kz it oo b gy ow ot l ou ov">df=pd.read_csv("TSLA.csv")<br/>print(‘Number of rows and columns:’, df.shape)<br/>df.head(5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/4c487bb125bc10e7aa9146a34010388b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fB29WXKDO6Y8zSsj87OTBg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">上述代码的输出</p></figure><p id="7ee4" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">下一步是<strong class="mh iu">将</strong>数据分割成<strong class="mh iu">训练</strong>和<strong class="mh iu">测试</strong>集合，以避免<strong class="mh iu">过拟合</strong>，并能够调查我们模型的泛化能力。要了解更多关于过度拟合的信息，请阅读本文:</p><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/is-your-model-overfitting-or-maybe-underfitting-an-example-using-a-neural-network-in-python-4faf155398d2"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">你的模型是否过拟合？或者不合身？python 中使用神经网络的示例</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">过拟合，欠拟合，泛化能力，交叉验证。一切都简单解释了。我还提供了一个…</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="pl l pm pn po pk pp ks pb"/></div></div></a></div><p id="b2e5" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">要预测的目标值将是“<strong class="mh iu">收盘</strong>股价值。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="a015" class="lq kz it oo b gy os ot l ou ov">training_set = df.iloc[:800, 1:2].values<br/>test_set = df.iloc[800:, 1:2].values</span></pre><p id="be54" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">在<strong class="mh iu">模型</strong> <strong class="mh iu">拟合</strong>之前，<strong class="mh iu">归一化</strong>数据不失为一个好主意。这将提高性能。你可以在这里阅读更多关于<strong class="mh iu">最小-最大缩放器</strong>:</p><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/everything-you-need-to-know-about-min-max-normalization-in-python-b79592732b79"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">关于 Python 中的最小-最大规范化，您需要知道的一切</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">在这篇文章中，我将解释什么是最小-最大缩放，什么时候使用它，以及如何使用 scikit 在 Python 中实现它</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="pq l pm pn po pk pp ks pb"/></div></div></a></div><p id="c310" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">让我们构建具有 1 天滞后时间<strong class="mh iu">(滞后 1)的输入要素:</strong></p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="ae88" class="lq kz it oo b gy os ot l ou ov"># Feature Scaling<br/>sc = MinMaxScaler(feature_range = (0, 1))<br/>training_set_scaled = sc.fit_transform(training_set)</span><span id="91b1" class="lq kz it oo b gy ow ot l ou ov"># Creating a data structure with 60 time-steps and 1 output<br/>X_train = []<br/>y_train = []<br/>for i in range(60, 800):<br/>    X_train.append(training_set_scaled[i-60:i, 0])<br/>    y_train.append(training_set_scaled[i, 0])<br/>X_train, y_train = np.array(X_train), np.array(y_train)</span><span id="cc50" class="lq kz it oo b gy ow ot l ou ov">X_train = np.reshape(X_train, (X_train.shape[0], X_train.shape[1], 1))<br/>#(740, 60, 1)</span></pre><p id="7de1" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">现在<strong class="mh iu">我们已经将</strong>数据整形为以下格式(#值、#时间步长、#1 维输出)。</p><p id="814e" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated"><strong class="mh iu">现在，该建立模型了。</strong>我们将建立有 50 个神经元的<strong class="mh iu"> LSTM </strong>和<strong class="mh iu"> 4 个隐含层</strong>。最后，我们将在输出层分配 1 个神经元用于预测标准化的股票价格。我们将使用 MSE 损失函数和 Adam 随机梯度下降优化器。</p><p id="f674" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated"><strong class="mh iu">注意</strong>:以下需要一些时间(~5min)。</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="cc8a" class="lq kz it oo b gy os ot l ou ov">model = Sequential()</span><span id="c205" class="lq kz it oo b gy ow ot l ou ov">#Adding the first LSTM layer and some Dropout regularisation<br/>model.add(LSTM(units = 50, return_sequences = True, input_shape = (X_train.shape[1], 1)))<br/>model.add(Dropout(0.2))</span><span id="657b" class="lq kz it oo b gy ow ot l ou ov"># Adding a second LSTM layer and some Dropout regularisation<br/>model.add(LSTM(units = 50, return_sequences = True))<br/>model.add(Dropout(0.2))</span><span id="8c4d" class="lq kz it oo b gy ow ot l ou ov"># Adding a third LSTM layer and some Dropout regularisation<br/>model.add(LSTM(units = 50, return_sequences = True))<br/>model.add(Dropout(0.2))</span><span id="1881" class="lq kz it oo b gy ow ot l ou ov"># Adding a fourth LSTM layer and some Dropout regularisation<br/>model.add(LSTM(units = 50))<br/>model.add(Dropout(0.2))</span><span id="591c" class="lq kz it oo b gy ow ot l ou ov"># Adding the output layer<br/>model.add(Dense(units = 1))<br/><br/># Compiling the RNN<br/>model.compile(optimizer = 'adam', loss = 'mean_squared_error')<br/><br/># Fitting the RNN to the Training set<br/>model.fit(X_train, y_train, epochs = 100, batch_size = 32)</span></pre><p id="f916" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">装配完成后，您应该会看到类似这样的内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pr"><img src="../Images/218d1f71cde6c0e43f7d1e4880b8e190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fmQ6ePlJjvRoRAJCFGDbew.png"/></div></div></figure><p id="3cec" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">准备测试数据(重塑它们):</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="2538" class="lq kz it oo b gy os ot l ou ov"># Getting the predicted stock price of 2017<br/>dataset_train = df.iloc[:800, 1:2]<br/>dataset_test = df.iloc[800:, 1:2]</span><span id="68d5" class="lq kz it oo b gy ow ot l ou ov">dataset_total = pd.concat((dataset_train, dataset_test), axis = 0)</span><span id="ba78" class="lq kz it oo b gy ow ot l ou ov">inputs = dataset_total[len(dataset_total) - len(dataset_test) - 60:].values</span><span id="f7be" class="lq kz it oo b gy ow ot l ou ov">inputs = inputs.reshape(-1,1)<br/>inputs = sc.transform(inputs)<br/>X_test = []<br/>for i in range(60, 519):<br/>    X_test.append(inputs[i-60:i, 0])<br/>X_test = np.array(X_test)<br/>X_test = np.reshape(X_test, (X_test.shape[0], X_test.shape[1], 1))</span><span id="56ee" class="lq kz it oo b gy ow ot l ou ov">print(X_test.shape)<br/># (459, 60, 1)</span></pre><p id="878a" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">使用测试集进行预测</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="8572" class="lq kz it oo b gy os ot l ou ov">predicted_stock_price = model.predict(X_test)<br/>predicted_stock_price = sc.inverse_transform(predicted_stock_price)</span></pre><p id="b50f" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">现在让我们来看看结果:</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="4bed" class="lq kz it oo b gy os ot l ou ov"># Visualising the results<br/>plt.plot(df.loc[800:, ‘Date’],dataset_test.values, color = ‘red’, label = ‘Real TESLA Stock Price’)<br/>plt.plot(df.loc[800:, ‘Date’],predicted_stock_price, color = ‘blue’, label = ‘Predicted TESLA Stock Price’)<br/>plt.xticks(np.arange(0,459,50))<br/>plt.title('TESLA Stock Price Prediction')<br/>plt.xlabel('Time')<br/>plt.ylabel('TESLA Stock Price')<br/>plt.legend()<br/>plt.show()</span></pre><h1 id="9b94" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">5.结果</h1><p id="6003" class="pw-post-body-paragraph mf mg it mh b mi mj ju mk ml mm jx mn lv mo mp mq ly mr ms mt mb mu mv mw mx im bi translated"><strong class="mh iu">使用滞后 1(即一天的步长):</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/85a0e09f82c534473e2d091aade3843f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t-NC8uK5gEoq4ZN_iM9xlw.png"/></div></div></figure><p id="67d8" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated"><strong class="mh iu">观察</strong>:2020 年 3 月因新冠肺炎封锁而大幅下跌！</p><p id="9a37" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">我们可以清楚地看到，我们的模型表现得非常好。它能够准确地跟踪大多数不可接受的上涨/下跌，但是，对于最近的日期戳，我们可以看到，与股票价格的实际值相比，模型预期(预测)的值较低。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="197e" class="ky kz it bd la lb ob ld le lf oc lh li jz od ka lk kc oe kd lm kf of kg lo lp bi translated">关于滞后的一个注记</h1><p id="ef15" class="pw-post-body-paragraph mf mg it mh b mi mj ju mk ml mm jx mn lv mo mp mq ly mr ms mt mb mu mv mw mx im bi translated"><strong class="mh iu">本文中最初选择的延迟为 1，即使用 1 天的步长</strong>。这可以通过修改构建 3D 输入的代码来轻松改变。</p><p id="76cc" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated"><strong class="mh iu">示例</strong>:可以更改以下两个代码块:</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="b359" class="lq kz it oo b gy os ot l ou ov">X_train = []<br/>y_train = []<br/>for i in range(60, 800):<br/>    X_train.append(training_set_scaled[i-60:i, 0])<br/>    y_train.append(training_set_scaled[i, 0])</span></pre><p id="af26" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">和</p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="8348" class="lq kz it oo b gy os ot l ou ov">X_test = []<br/>y_test = []<br/>for i in range(60, 519):<br/>    X_test.append(inputs[i-60:i, 0])<br/>X_test = np.array(X_test)<br/>X_test = np.reshape(X_test, (X_test.shape[0], X_test.shape[1], 1))</span></pre><p id="79f2" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated"><strong class="mh iu">采用以下新代码:</strong></p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="cac8" class="lq kz it oo b gy os ot l ou ov">X_train = []<br/>y_train = []<br/>for i in range(60, 800):<br/>    X_train.append(training_set_scaled[i-50:i, 0])<br/>    y_train.append(training_set_scaled[i, 0])</span></pre><p id="dc81" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated"><strong class="mh iu">和</strong></p><pre class="kj kk kl km gt on oo op oq aw or bi"><span id="bf72" class="lq kz it oo b gy os ot l ou ov">X_test = []<br/>y_test = []<br/>for i in range(60, 519):<br/>    X_test.append(inputs[i-50:i, 0])<br/>X_test = np.array(X_test)<br/>X_test = np.reshape(X_test, (X_test.shape[0], X_test.shape[1], 1))</span></pre><p id="d01f" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">在这种情况下，结果如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pt"><img src="../Images/81b609fced950d8bf3553aa8b258f7e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ywlBzNk1gQUj2JVsLJO2Gw.png"/></div></div></figure></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><p id="412d" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">那都是乡亲们！希望你喜欢这篇文章！</p><h2 id="3fab" class="lq kz it bd la lr ls dn le lt lu dp li lv lw lx lk ly lz ma lm mb mc md lo me bi translated">看看我在另一篇文章中用来预测谷歌股价的脸书预言家模型。</h2><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/time-series-forecasting-predicting-stock-prices-using-facebooks-prophet-model-9ee1657132b5"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">时间序列预测:用脸书的先知模型预测股票价格</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">使用可从《先知脸书》公开获得的预测模型预测股票价格</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="pu l pm pn po pk pp ks pb"/></div></div></a></div><h2 id="2788" class="lq kz it bd la lr ls dn le lt lu dp li lv lw lx lk ly lz ma lm mb mc md lo me bi translated">也可以看看我最近用 ARIMA 模型写的文章:</h2><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/time-series-forecasting-predicting-stock-prices-using-an-arima-model-2e3b3080bd70"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">时间序列预测:使用 ARIMA 模型预测股票价格</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">在这篇文章中，我将向你展示如何使用预测 ARIMA 模型来预测特斯拉的股票价格</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="pv l pm pn po pk pp ks pb"/></div></div></a></div></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="8779" class="ky kz it bd la lb ob ld le lf oc lh li jz od ka lk kc oe kd lm kf of kg lo lp bi translated">参考</h1><p id="04f2" class="pw-post-body-paragraph mf mg it mh b mi mj ju mk ml mm jx mn lv mo mp mq ly mr ms mt mb mu mv mw mx im bi translated">[1]<a class="ae oa" href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener ugc nofollow" target="_blank">https://colah.github.io/posts/2015-08-Understanding-LSTMs/</a></p><p id="0758" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">[2]https://en.wikipedia.org/wiki/Long_short-term_memory<a class="ae oa" href="https://en.wikipedia.org/wiki/Long_short-term_memory" rel="noopener ugc nofollow" target="_blank"/></p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="d4cf" class="ky kz it bd la lb ob ld le lf oc lh li jz od ka lk kc oe kd lm kf of kg lo lp bi translated">敬请关注并支持这一努力</h1><p id="db8b" class="pw-post-body-paragraph mf mg it mh b mi mj ju mk ml mm jx mn lv mo mp mq ly mr ms mt mb mu mv mw mx im bi translated">如果你喜欢这篇文章并且觉得它有用，<strong class="mh iu">关注</strong>我就可以看到我所有的新帖子。</p><p id="032c" class="pw-post-body-paragraph mf mg it mh b mi my ju mk ml mz jx mn lv na mp mq ly nb ms mt mb nc mv mw mx im bi translated">有问题吗？把它们作为评论贴出来，我会尽快回复。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="98d4" class="ky kz it bd la lb ob ld le lf oc lh li jz od ka lk kc oe kd lm kf of kg lo lp bi translated">最新帖子</h1><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/time-series-forecasting-predicting-stock-prices-using-facebooks-prophet-model-9ee1657132b5"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">时间序列预测:用脸书的先知模型预测股票价格</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">使用可从《先知脸书》公开获得的预测模型预测股票价格</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="pu l pm pn po pk pp ks pb"/></div></div></a></div><div class="oy oz gp gr pa pb"><a href="https://medium.com/@seralouk/the-best-free-data-science-resources-free-books-online-courses-9c4a2df194e5" rel="noopener follow" target="_blank"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">最佳免费数据科学资源:免费书籍和在线课程</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">最有用的免费书籍和在线课程，适合想了解更多数据科学知识的人。</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">medium.com</p></div></div><div class="pk l"><div class="pw l pm pn po pk pp ks pb"/></div></div></a></div><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/roc-curve-explained-using-a-covid-19-hypothetical-example-binary-multi-class-classification-bab188ea869c"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">用新冠肺炎假设的例子解释 ROC 曲线:二分类和多分类…</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">在这篇文章中，我清楚地解释了什么是 ROC 曲线以及如何阅读它。我用一个新冠肺炎的例子来说明我的观点，我…</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="px l pm pn po pk pp ks pb"/></div></div></a></div><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/support-vector-machines-svm-clearly-explained-a-python-tutorial-for-classification-problems-29c539f3ad8"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">支持向量机(SVM)解释清楚:分类问题的 python 教程…</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">在这篇文章中，我解释了支持向量机的核心，为什么以及如何使用它们。此外，我还展示了如何绘制支持…</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="py l pm pn po pk pp ks pb"/></div></div></a></div><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/pca-clearly-explained-how-when-why-to-use-it-and-feature-importance-a-guide-in-python-7c274582c37e"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">PCA 清楚地解释了——如何、何时、为什么使用它以及特性的重要性:Python 指南</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">在这篇文章中，我解释了什么是 PCA，何时以及为什么使用它，以及如何使用 scikit-learn 在 Python 中实现它。还有…</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="pz l pm pn po pk pp ks pb"/></div></div></a></div><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/everything-you-need-to-know-about-min-max-normalization-in-python-b79592732b79"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">关于 Python 中的最小-最大规范化，您需要知道的一切</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">在这篇文章中，我将解释什么是最小-最大缩放，什么时候使用它，以及如何使用 scikit 在 Python 中实现它</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="pq l pm pn po pk pp ks pb"/></div></div></a></div><div class="oy oz gp gr pa pb"><a rel="noopener follow" target="_blank" href="/how-and-why-to-standardize-your-data-996926c2c832"><div class="pc ab fo"><div class="pd ab pe cl cj pf"><h2 class="bd iu gy z fp pg fr fs ph fu fw is bi translated">Scikit-Learn 的标准定标器如何工作</h2><div class="pi l"><h3 class="bd b gy z fp pg fr fs ph fu fw dk translated">在这篇文章中，我将解释为什么以及如何使用 scikit-learn 应用标准化</h3></div><div class="pj l"><p class="bd b dl z fp pg fr fs ph fu fw dk translated">towardsdatascience.com</p></div></div><div class="pk l"><div class="qa l pm pn po pk pp ks pb"/></div></div></a></div></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="7cae" class="ky kz it bd la lb ob ld le lf oc lh li jz od ka lk kc oe kd lm kf of kg lo lp bi translated">和我联系</h1><ul class=""><li id="45ab" class="qb qc it mh b mi mj ml mm lv qd ly qe mb qf mx qg qh qi qj bi translated"><strong class="mh iu">LinkedIn</strong>:<a class="ae oa" href="https://www.linkedin.com/in/serafeim-loukas/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/serafeim-loukas/</a></li><li id="5962" class="qb qc it mh b mi qk ml ql lv qm ly qn mb qo mx qg qh qi qj bi translated"><strong class="mh iu">研究之门</strong>:<a class="ae oa" href="https://www.researchgate.net/profile/Serafeim_Loukas" rel="noopener ugc nofollow" target="_blank">https://www.researchgate.net/profile/Serafeim_Loukas</a></li><li id="31d2" class="qb qc it mh b mi qk ml ql lv qm ly qn mb qo mx qg qh qi qj bi translated"><strong class="mh iu">https://people.epfl.ch/serafeim.loukas</strong>EPFL<strong class="mh iu">简介</strong> : <a class="ae oa" href="https://people.epfl.ch/serafeim.loukas" rel="noopener ugc nofollow" target="_blank">美国</a></li><li id="2a52" class="qb qc it mh b mi qk ml ql lv qm ly qn mb qo mx qg qh qi qj bi translated"><strong class="mh iu">堆栈</strong>溢出<strong class="mh iu">溢出</strong>:<a class="ae oa" href="https://stackoverflow.com/users/5025009/seralouk" rel="noopener ugc nofollow" target="_blank">https://stackoverflow.com/users/5025009/seralouk</a></li></ul></div></div>    
</body>
</html>