<html>
<head>
<title>Why Regularization Works</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么正规化有效</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-we-should-always-consider-regularization-3767062709e8?source=collection_archive---------66-----------------------#2020-07-27">https://towardsdatascience.com/why-we-should-always-consider-regularization-3767062709e8?source=collection_archive---------66-----------------------#2020-07-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5103" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><em class="ki">正规化背后的直觉</em></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/294bc9e6d393ba3c3858c618fc10210d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YhkSrhbZGj-x2OhKPHspKA.jpeg"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">由<a class="ae kz" href="https://unsplash.com/@franki?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">弗兰基·查马基</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="2f7b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">当我们训练机器学习模型或神经网络时，我们会看到有时我们的模型在训练数据上表现得非常好，但在测试或验证数据时却无法给出预期的输出。模型性能如此不同的许多原因之一是在模型训练期间学习的大权重，从而导致过度拟合。较大的权重会导致我们的模型不稳定，测试数据的微小变化会导致较高的误差。除此之外，大重量还会在训练的梯度下降步骤中造成问题。为了惩罚这些大的权重，我们将它们调整为较小的值。</p><p id="f1b7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">但是为什么将权重调整到一个较低的值会有效呢？？</p><p id="1856" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">让我们来探讨为什么权重的较低值实际上是必要的背后的直观逻辑。</p><h1 id="3cea" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">首先是一些数学</h1><p id="17b6" class="pw-post-body-paragraph la lb it lc b ld mo ju lf lg mp jx li lj mq ll lm ln mr lp lq lr ms lt lu lv im bi translated">梯度下降算法根据模型产生的误差更新权重。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/de549fcd2f382d39b23b5f89cae10eeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/0*k8Vlf7xupA3kmuhN.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">梯度下降函数-作者图片</p></figure><blockquote class="mu mv mw"><p id="3522" class="la lb mx lc b ld le ju lf lg lh jx li my lk ll lm mz lo lp lq na ls lt lu lv im bi translated">上述等式中的导数部分表示误差函数的斜率或误差函数相对于权重的变化。</p></blockquote><p id="8ad7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这个导数部分经常用链式法则来计算。假设我们使用平方误差函数来计算误差，并对我们的线性输出应用 sigmoid 激活函数来获得最终输出。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/41eddd4b234cdbeef989824a614d6191.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/0*IY3WxZLrFEWCPsTN.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">以 H 为输入的线性函数-作者图片</p></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/82f5c87aa5a5620cef8830010210284b.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/0*QrIVq4BgPe6itM7b.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">Sigmoid 激活函数-作者图片</p></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/a63e5bd93811e71b1273a2275be46ca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/0*SqQrInPPKOPHmNLI.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">平方误差函数-作者图片</p></figure><p id="f232" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">根据链式法则，我们需要计算:</p><ol class=""><li id="5a1d" class="ne nf it lc b ld le lg lh lj ng ln nh lr ni lv nj nk nl nm bi translated">误差函数相对于激活函数输出的斜率。</li><li id="ce94" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">激活函数相对于线性输出的斜率。</li><li id="13a5" class="ne nf it lc b ld nn lg no lj np ln nq lr nr lv nj nk nl nm bi translated">最后，线性函数的斜率与权重相关。</li></ol><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/320c0c432b89b398125560bd3713026d.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/0*ceZ1iPduAA2pHJSI.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">链式法则-作者图片</p></figure><blockquote class="mu mv mw"><p id="9ef2" class="la lb mx lc b ld le ju lf lg lh jx li my lk ll lm mz lo lp lq na ls lt lu lv im bi translated">模型的权重值在梯度下降的权重更新步骤中起着非常关键的作用。</p></blockquote><p id="7739" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们通过一个简单的例子来理解这一点。</p></div><div class="ab cl nt nu hx nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="im in io ip iq"><h1 id="4042" class="lw lx it bd ly lz oa mb mc md ob mf mg jz oc ka mi kc od kd mk kf oe kg mm mn bi translated">主要的戏剧</h1><p id="7f42" class="pw-post-body-paragraph la lb it lc b ld mo ju lf lg mp jx li lj mq ll lm ln mr lp lq lr ms lt lu lv im bi translated">sigmoid 函数是用于确定模型输出的非常常见的激活函数。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="of og l"/></div></figure><p id="50a7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">上面给出的代码针对给定的 x 值<em class="mx">绘制了一个简单的 sigmoid 函数，用于形式为<em class="mx"> y=mx+c </em>的线性输出。m' </em>照常代表我们所说的线的斜率或我们模型的权重。</p><p id="96cc" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在，我们将了解不同的斜率值如何影响我们的 sigmoid 函数。</p><pre class="kk kl km kn gt oh oi oj ok aw ol bi"><span id="7391" class="om lx it oi b gy on oo l op oq">plot_sigmoid(0.001)</span></pre><p id="830d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">产出 1:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi or"><img src="../Images/5f7bea38751cc4d011f62255d6c0f305.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*RC-ZPuog2FylNEL3ZtD25Q.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">输出 1 -作者的图像</p></figure><pre class="kk kl km kn gt oh oi oj ok aw ol bi"><span id="e5f5" class="om lx it oi b gy on oo l op oq">plot_sigmoid(0.0005)</span></pre><p id="631e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">产出 2:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi os"><img src="../Images/7012f9142d4a392714c4a48920500044.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*z-Wnsfhj3eUxDD37Gmp5VA.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">输出 2 -作者的图像</p></figure><pre class="kk kl km kn gt oh oi oj ok aw ol bi"><span id="69b2" class="om lx it oi b gy on oo l op oq">plot_sigmoid(0.0002)</span></pre><p id="8039" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">产出 3:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/fffe7cc261d9f99409a86bd531cefa7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*-_h2-sJT-Kt16BzgbWPmkg.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">输出 3 -按作者分类的图像</p></figure><pre class="kk kl km kn gt oh oi oj ok aw ol bi"><span id="2cd5" class="om lx it oi b gy on oo l op oq">plot_sigmoid(0.0001)</span></pre><p id="ddf9" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">产出 4:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/25266202af54caf23cfca3ce33e92ad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*2w5XW_77wRjwDC9lTD6aLA.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">输出 4 -按作者分类的图像</p></figure><p id="c5fb" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">从以上 4 幅图中，我们可以观察到，随着线性函数中斜率或权重的降低，sigmoid 函数的陡度也随之降低。</p><p id="a1f9" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">对于输出 1，我们可以看到 sigmoid 函数的值从 0 快速变为 1。因此，该函数任意点的斜率大多保持接近 0 或 1。</p><blockquote class="ov"><p id="32b4" class="ow ox it bd oy oz pa pb pc pd pe lv dk translated">这导致梯度下降步骤中的不便，因为它将导致权重几乎没有变化，从而减慢我们的模型的学习，并最终无法达到我们的误差函数的最小尖端，或者有时太大的变化可能导致错过误差函数的最小值。</p></blockquote><p id="1560" class="pw-post-body-paragraph la lb it lc b ld pf ju lf lg pg jx li lj ph ll lm ln pi lp lq lr pj lt lu lv im bi translated">现在，在其他 3 个输出中，我们随后降低了斜率值，并观察到输出函数的陡度也降低了。sigmoid 函数值开始从 0 到 1 逐渐变化，并忽略斜率的快速变化，这种变化有利于梯度下降步骤。现在，权重以更加一致的方式更新，从而实现误差函数的最小值。</p><p id="ce6d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">很明显，当使用期望的正则化技术来训练模型时，为什么大的权重需要被惩罚并被带回到较低的值。</p></div></div>    
</body>
</html>