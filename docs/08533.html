<html>
<head>
<title>Why Data is represented as a ‘Vector’ in Data Science Problems?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么数据在数据科学问题中被表示为‘向量’？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-data-is-represented-as-a-vector-in-data-science-problems-a195e0b17e99?source=collection_archive---------11-----------------------#2020-06-21">https://towardsdatascience.com/why-data-is-represented-as-a-vector-in-data-science-problems-a195e0b17e99?source=collection_archive---------11-----------------------#2020-06-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5734" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><strong class="ak"> <em class="ki">向量代数在数据科学中的应用</em> </strong></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/35e43d289ff5cb9aa1f517d331c759ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4eQ5F_syFNmnMaHs"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@antoine1003?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">安托万·道特里</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="ed93" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi lw translated">科学和数学被用来描述我们周围的世界。有许多量只需要一次测量就能描述出来。例如线的长度、任何形状的面积或任何表面的温度。这样的量称为<strong class="lc iu"> <em class="mf">标量</em> </strong>。任何可以用数字(正数或负数)表示的量都叫做标量。该值被称为<strong class="lc iu">大小</strong>。</p><p id="d0f9" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">另一方面，有些量需要至少两次测量来描述。除了大小，它们还有一个相关的“方向”,例如速度或力。这些量被称为“<strong class="lc iu">矢量</strong>”。</p><p id="5875" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">当我们说一个人跑了 2 公里，这是一个标量，但是当我们说一个人从他的初始位置向东北跑了 2 公里，这是一个矢量。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mg"><img src="../Images/78030d8adf0260c988c49d2fdc127555.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EPUWV3QBCavMPqztJlmTBA.png"/></div></div></figure><p id="3ca0" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">假设您正在收集某个班级中一组学生的一些数据。您正在测量每个学生的身高和体重，为 5 名学生收集的数据如下:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/9d2714efd922b494625a864b9c55954e.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*khiChnsqU_RdQLkdNlPi_Q.png"/></div></figure><p id="03ec" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这里的每一个测量都是一个标量。所以单独看身高或体重是标量。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mi"><img src="../Images/a093f516c090e6478597d1c0c4dabf1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*knXxZq1LoGWvc31kbMd92w.png"/></div></div></figure><p id="2c3b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">然而，当你把每个学生作为一个整体来观察时，即每个学生的身高和体重加在一起，你可以把它看作一个向量。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mj"><img src="../Images/7f6ceb3e049513759dc2d5c51c92b2f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ezn8pxzotDSLFbt0KRaSw.png"/></div></div></figure><p id="0634" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在这个表示中，每个学生都是一个向量。它由两个特征描述:身高和体重。现在，<strong class="lc iu">根据标准定义，在这个向量中没有真正的“方向”。</strong>但是，当我们在多个维度上表示数量时(在这种情况下，是 2——身高和体重),就会有一种相对于彼此的方位感。因此，当我们观察 5 个学生(5 个向量)时，他们对彼此有一个大小和“方向”的概念。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mk"><img src="../Images/d4eb181c35356aea1828acb49b9fc2e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V721G74671b_va6J9hnVlQ.png"/></div></div></figure><p id="1a50" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">因为大多数有用的数据集总是有不止一个属性，所以它们都可以用“向量”来表示。给定数据集中的每个观察值都可以被认为是一个向量。一个数据集的所有可能的观测值构成了一个<strong class="lc iu"><em class="mf"/></strong><em class="mf"/>向量空间。这是一种很奇特的说法，说外面有一个空间，每个向量在那个空间中都有自己的位置。</p><blockquote class="ml mm mn"><p id="976a" class="la lb mf lc b ld le ju lf lg lh jx li mo lk ll lm mp lo lp lq mq ls lt lu lv im bi translated">将数据表示为向量的好处是，我们可以利用向量代数来寻找数据中的模式或关系。</p></blockquote><h1 id="d385" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">向量有什么帮助？</h1><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nj"><img src="../Images/663f3fbddca3a5caa73fc1e53a0d76c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iQc7h_oE30b4bUHw"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">莎伦·麦卡琴在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="a455" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">看向量空间中的向量，可以快速比较，检查是否有关系。例如，你推断出<strong class="lc iu"> <em class="mf">相似的</em> </strong>向量之间的角度较小，即它们的方向彼此接近。在我们的样本数据中，学生(5.4，54)和(5，50)非常相似。</p><p id="aec7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">向量之间的角度表示它们之间的“相似性”。相同方向(接近 0 度角)的向量是相似的，而相反方向(接近 180 度角)的向量是不相似的。理论上。如果向量彼此成 90 度(正交)，则它们之间没有关系。有没有一个数学函数可以捕捉到这种关系？</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nk"><img src="../Images/04d30ad0d2ba6ddf3524b4ffb016db77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P4cD9L8aYymN7nlQkIS19Q.png"/></div></div></figure><blockquote class="nl"><p id="e955" class="nm nn it bd no np nq nr ns nt nu lv dk translated">想想三角函数——余弦。</p></blockquote><p id="2091" class="pw-post-body-paragraph la lb it lc b ld nv ju lf lg nw jx li lj nx ll lm ln ny lp lq lr nz lt lu lv im bi translated">上面的描述听起来可能有点晦涩难懂。所以，不要忘记，我们在这里谈论的是数据的<strong class="lc iu"> <em class="mf">【表示】</em> </strong>，以这种方式帮助我们找到一种关系或模式。向量形式就是这样一种表示。</p><h1 id="da22" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">余弦相似性</h1><p id="8161" class="pw-post-body-paragraph la lb it lc b ld oa ju lf lg ob jx li lj oc ll lm ln od lp lq lr oe lt lu lv im bi translated">余弦相似性是一种度量，它给出了向量之间角度的余弦。它可以用两个向量的“点积”来计算。数学上，</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi of"><img src="../Images/f1a77efa8f0f9ec74937c8fb4d65518e.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*xzWyqA-Hw9woZnwnng6AyA.png"/></div></figure><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi og"><img src="../Images/1e6e6aec081b5e247bdbd91d99083d36.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*-8UMmLXuza1U6p3SBNlkog.png"/></div></figure><p id="b92a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">所以现在每当你在数据科学中听到向量，想想它们之间的点积和夹角余弦。你会看到这些向量有多相似或不相似。</p><h1 id="e03b" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">文本矢量化</h1><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi oh"><img src="../Images/cb35ada095a8045cece14490dad87de6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mIKfLVg5SUQUTPfq"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@kylejglenn?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">凯尔·格伦</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="80e1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">将数据集转换或变换为一组向量的过程称为矢量化。在属性已经是数字的情况下，将数据集表示为向量更容易。文本数据呢？</p><blockquote class="nl"><p id="7c7e" class="nm nn it bd no np oi oj ok ol om lv dk translated">“单词嵌入”是将单词或文本表示为向量的过程</p></blockquote><p id="d001" class="pw-post-body-paragraph la lb it lc b ld nv ju lf lg nw jx li lj nx ll lm ln ny lp lq lr nz lt lu lv im bi translated">有许多将文本转换/表示为向量的技术。最简单的方法之一是计数矢量器。下面是查尔斯·狄更斯的《双城记》中前几行文字的片段:</p><p id="4256" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><em class="mf">那是最好的时代，</em> <br/> <em class="mf">那是最坏的时代，</em> <br/> <em class="mf">那是智慧的时代，</em> <br/> <em class="mf">那是愚昧的时代</em></p><p id="01e7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如何将上述 4 个句子转换成向量:</p><p id="41bf" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">第一步:</strong>从你的文本集合中获取独特的单词。你所拥有的全部文本被称为“语料库”</p><p id="fac7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这里唯一的单词(忽略大小写和标点)是:</p><pre class="kk kl km kn gt on oo op oq aw or bi"><span id="1776" class="os ms it oo b gy ot ou l ov ow"><strong class="oo iu">['age',<br/> 'best',<br/> 'foolishness',<br/> 'it',<br/> 'of',<br/> 'the',<br/> 'times',<br/> 'was',<br/> 'wisdom',<br/> 'worst']</strong></span></pre><p id="e42b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这是来自包含 24 个单词的语料库的<strong class="lc iu"> 10 个单词</strong>的词汇表。</p><p id="4b0b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">第二步:</strong>为每个句子创建一个由 10 个零组成的列表</p><p id="74bb" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">第三步:</strong>对于每个句子，开始一个一个的读单词。计算每个单词在句子中的总出现次数。现在确定这个单词在上面的词汇表中的位置，在那个位置用这个计数代替零。</p><p id="c681" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">对于我们的语料库，我们得到的向量是:</p><p id="c84c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">“这是最好的时代”= [0 1 0 1 1 1 1 1 0 0]</p><p id="f404" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">“这是最坏的时代”= [0 0 0 1 1 1 1 1 0 1]</p><p id="cb56" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">“这是智慧的时代”= [1 0 0 1 1 1 0 1 1 0]</p><p id="551e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">“那是愚蠢的时代”= [1 0 1 1 1 1 0 1 0 0]</p><p id="136d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">Python 中的代码:</strong></p><pre class="kk kl km kn gt on oo op oq aw or bi"><span id="cc23" class="os ms it oo b gy ot ou l ov ow"><strong class="oo iu">from sklearn.feature_extraction.text import CountVectorizer</strong></span><span id="37fd" class="os ms it oo b gy ox ou l ov ow"><strong class="oo iu">documents = [‘it was the best of times’, ‘it was the worst of times’,’it was the age of wisdom’,’it was the age of foolishness’]</strong></span><span id="a697" class="os ms it oo b gy ox ou l ov ow"><strong class="oo iu">vectorizer = CountVectorizer()<br/>sentence_vectors = vectorizer.fit_transform(documents)</strong></span><span id="1aef" class="os ms it oo b gy ox ou l ov ow"><strong class="oo iu">print(sentence_vectors.toarray())</strong></span></pre><p id="8623" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">输出:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/91d5b807024d4afb7c3c5cae2e2fe253.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/1*H0luoMLxXn3ixjqmfL7wKg.png"/></div></figure><p id="415b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">一个纯 Python 代码(不使用任何内置库)来计算两个句子之间的余弦相似度:</p><pre class="kk kl km kn gt on oo op oq aw or bi"><span id="96e6" class="os ms it oo b gy ot ou l ov ow">import math<br/>import re<br/>from collections import Counter</span><span id="85dd" class="os ms it oo b gy ox ou l ov ow">WORD = re.compile(r”\w+”)</span><span id="bedc" class="os ms it oo b gy ox ou l ov ow">def cosine(vector1, vector2):<br/> intersect = set(vector1.keys()) &amp; set(vector2.keys())<br/> numerator = sum([vector1[x] * vector2[x] for x in intersect])</span><span id="2951" class="os ms it oo b gy ox ou l ov ow">sum1 = sum([vector1[x] ** 2 for x in list(vector1.keys())])<br/> sum2 = sum([vector2[x] ** 2 for x in list(vector2.keys())])<br/> denominator = math.sqrt(sum1) * math.sqrt(sum2)</span><span id="7f8e" class="os ms it oo b gy ox ou l ov ow">if not denominator:<br/> return 0.0<br/> else:<br/> return float(numerator) / denominator</span><span id="cf5f" class="os ms it oo b gy ox ou l ov ow">def text_to_vector(text):<br/> words = WORD.findall(text)<br/> return Counter(words)</span><span id="3e6f" class="os ms it oo b gy ox ou l ov ow">sentence1 = “it was the age of foolishness”<br/>sentence2 = “it was the age of wisdom”</span><span id="76e9" class="os ms it oo b gy ox ou l ov ow">vector1 = text_to_vector(sentence1)<br/>vector2 = text_to_vector(sentence2)</span><span id="9462" class="os ms it oo b gy ox ou l ov ow">cosine = cosine(vector1, vector2)</span><span id="8dc2" class="os ms it oo b gy ox ou l ov ow">print(“Cosine Similarity:”, cosine)</span></pre><p id="315e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">“那是智慧的时代”和“那是愚蠢的时代”之间的余弦相似性是</strong></p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/1edd6aad84290e0ac861f186f4435eef.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*OnZPW68LOp8EyEZQgNYT0A.png"/></div></figure><p id="4483" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">余弦相似度将是 0 到 1 之间的一个数。结果越接近 1，相似度越大。</p><p id="8e9e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">0.83 的值表明这个例子中的两个句子非常相似。这是因为单词- 'it '，' was '，' the '，' age '，' of '在两个句子中重复出现。然而，最后一个词“智慧”和“愚蠢”完全改变了句子的意思，它们在这方面非常不同。有什么问题？问题在于使用的“矢量化”方法。为了捕捉句子的语义，我们需要使用更高级的单词到向量的转换技术。我将在下一篇文章中介绍处理这种情况的另一种矢量化技术。</p><h1 id="b353" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated"><strong class="ak">结论</strong></h1><p id="3d9c" class="pw-post-body-paragraph la lb it lc b ld oa ju lf lg ob jx li lj oc ll lm ln od lp lq lr oe lt lu lv im bi translated">本文的目的是提供使用向量表示数据背后的直觉。数据科学或机器学习的动机是找出观察值之间的模式和关系。将数据可视化为向量并使用向量代数来操作它们，解决了很多数据问题，尤其是在自然语言处理、文本分类和文本分析领域。</p><p id="88b2" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">以哲学的角度来结束这篇文章-</p><blockquote class="nl"><p id="ee5f" class="nm nn it bd no np oi oj ok ol om lv dk translated">“我们都是带菌者。我们许多人仍在寻找方向”</p></blockquote><p id="3578" class="pw-post-body-paragraph la lb it lc b ld nv ju lf lg nw jx li lj nx ll lm ln ny lp lq lr nz lt lu lv im bi translated">您可能也会喜欢下面的文章:</p><ol class=""><li id="7e36" class="pa pb it lc b ld le lg lh lj pc ln pd lr pe lv pf pg ph pi bi translated"><a class="ae kz" rel="noopener" target="_blank" href="/calculus-the-mathematics-of-change-f04f38770843">微积分——变化的数学</a></li><li id="eb8d" class="pa pb it lc b ld pj lg pk lj pl ln pm lr pn lv pf pg ph pi bi translated"><a class="ae kz" rel="noopener" target="_blank" href="/discovering-mathematical-mindset-d856ec63c21a?source=friends_link&amp;sk=c197479c733488cf0316fbf4ba77d52c">发现数学思维</a></li><li id="ef77" class="pa pb it lc b ld pj lg pk lj pl ln pm lr pn lv pf pg ph pi bi translated"><a class="ae kz" rel="noopener" target="_blank" href="/human-learning-vs-machine-learning-dfa8fe421560?source=friends_link&amp;sk=addcec5aa18479472a704597090831b3">人类学习 vs 机器学习</a></li></ol></div></div>    
</body>
</html>