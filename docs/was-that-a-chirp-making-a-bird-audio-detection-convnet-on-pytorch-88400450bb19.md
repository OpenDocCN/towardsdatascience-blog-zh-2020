# "é‚£æ˜¯å”§å”§å£°å—ï¼Ÿ"åœ¨ PyTorch ä¸Šåˆ¶ä½œé¸Ÿç±»éŸ³é¢‘æ£€æµ‹ç½‘ç»œ

> åŸæ–‡ï¼š<https://towardsdatascience.com/was-that-a-chirp-making-a-bird-audio-detection-convnet-on-pytorch-88400450bb19?source=collection_archive---------32----------------------->

## ä¸ºä»€ä¹ˆé¸Ÿç±»å£°éŸ³æ¢æµ‹å¯¹æˆ‘ä»¬ç¯å¢ƒçš„æœªæ¥å¦‚æ­¤é‡è¦

![](img/8803b275fe8bb0f9b3e537956e3b1282.png)

ç®€Â·æ¢…ä¹Œæ–¯åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡ã€‚ç”±æˆ‘ç¼–è¾‘:)

# ä»‹ç»

> ä½ å¬è¯´è¿‡è‡ªåŠ¨è¯­éŸ³è¯†åˆ«ï¼Œä½ å¬è¯´è¿‡éŸ³ä¹æ ‡è®°å’Œç”Ÿæˆï¼Œä½†ä½ å¬è¯´è¿‡é¸Ÿç±»éŸ³é¢‘æ£€æµ‹å—ï¼Ÿ

å¤§çº¦ä¸€å¹´å‰ï¼Œåœ¨æˆ‘é«˜äºŒçš„æ—¶å€™ï¼Œæˆ‘ç¬¬ä¸€æ¬¡å¬è¯´è¿™ç§éŸ³é¢‘æ·±åº¦å­¦ä¹ çš„ç”¨ä¾‹ã€‚äº‹å®ä¸Šï¼Œé¸ŸéŸ³é¢‘æ£€æµ‹(è®½åˆºçš„ç¼©å†™ä¸º BADï¼Œä½†æˆ‘ä¼šå°½é‡é¿å…è¿™ä¸ªç¼©å†™ğŸ˜…)æ˜¯æˆ‘åœ¨æ·±åº¦å­¦ä¹ å’Œè®¡ç®—æœºç§‘å­¦æ–¹é¢åšçš„ç¬¬ä¸€æ‰¹é¡¹ç›®ä¹‹ä¸€çš„ä¸»é¢˜ã€‚æˆ‘å‚ä¸äº†ä¸€ä¸ªç ”ç©¶é¡¹ç›®ï¼Œåœ¨åŒ—é˜¿æ‹‰æ–¯åŠ éƒŠåŒºä½¿ç”¨çº¯éŸ³é¢‘æ¢æµ‹é¸Ÿç±»çš„å­˜åœ¨ã€‚*è·ƒå…¥å…¶ä¸­ï¼Œé¸ŸéŸ³æ¢æµ‹ä½œä¸ºè¿™æ ·ä¸€ä¸ªå°ä¼—å´åˆå¼•äººå…¥èƒœçš„åº”ç”¨å‡ºç°äº†ï¼*åœ¨æœ¬æ–‡ä¸­ï¼Œ**æˆ‘å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•åœ¨ BirdVox-70k æ•°æ®é›†ä¸Šä½¿ç”¨ç®€å•çš„å·ç§¯ç¥ç»ç½‘ç»œ(CNN)æ¥å®ç°è¿™ä¸€ç‚¹ã€‚**

## å¥½å§ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆé¸Ÿç±»éŸ³é¢‘æ£€æµ‹å¾ˆé‡è¦å‘¢ï¼Ÿ

å¤šå¹´æ¥ï¼Œæ·±åº¦å­¦ä¹ æ¨¡å‹åœ¨é¸Ÿç±»éŸ³é¢‘æ£€æµ‹åº”ç”¨ä¸­çš„ä½¿ç”¨ä¸€ç›´åœ¨ä¸æ–­å‘å±•è¿›æ­¥ï¼Œæœ‰äº›äººå¯¹æ­¤éå¸¸æ„Ÿå…´è¶£æ˜¯æœ‰åŸå› çš„ã€‚é¦–å…ˆï¼Œé¸Ÿç±»çš„ç§»åŠ¨é€Ÿåº¦å¾ˆå¿«ï¼Œä½“å‹ç›¸å¯¹è¾ƒå°ï¼Œå·²ç»å¾ˆéš¾è¿½è¸ªäº†ã€‚æ­¤å¤–ï¼Œä¸åŒç§ç±»çš„é¸Ÿç±»æœ‰è‡ªå·±ç‹¬ç‰¹çš„å‘å£°æ–¹å¼ï¼Œè¿™ä½¿å¾—é€šè¿‡å¬è§‰å’Œå¬è§‰æ¥æ¢æµ‹é¸Ÿç±»æ¯”äº²çœ¼ç›®ç¹æ›´ä¸ºå¯å–ã€‚æœ€åï¼Œ**ç”±äºé¸Ÿç±»æ˜¯ç”Ÿæ€ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä»¬çš„å­˜åœ¨å’Œè¿å¾™æ¨¡å¼é€šå¸¸æ˜¯ä»»ä½•ç‰¹å®šåœ°åŒºç¯å¢ƒå¥åº·çš„è­¦ç¤ºä¿¡å·ã€‚**

é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆä¸å½•ä¸‹ä¸€æ®µéŸ³é¢‘ç‰‡æ®µï¼Œç„¶åå‘é€ç»™äººç±»ï¼Œè®©ä»–ä»¬ç¨åå†å¬å‘¢ï¼Ÿ*ç„¶è€Œï¼Œè®©æˆ‘ä»¬ç°å®ä¸€ç‚¹:*

> æ‰‹åŠ¨æ ‡è®°éŸ³é¢‘æ—¢æ˜‚è´µåˆç¹çï¼Œè€Œä¸”å¯èƒ½æ— æ³•æ¥è¿‘å®æ—¶ã€‚

æ‰€ä»¥ï¼Œè¿™å°±æ˜¯æ·±åº¦å­¦ä¹ å’Œ CNN å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚å¦‚æœæˆ‘ä»¬çš„æ¨¡å‹è¶³å¤Ÿç²¾ç¡®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨è’é‡å‘¨å›´è®¾ç½®éº¦å…‹é£æ¥è‡ªåŠ¨è®°å½•é¸Ÿç±»è¿å¾™æ¨¡å¼å’Œè·Ÿè¸ªé¸Ÿç±»ç‰©ç§ã€‚æœ‰äº†è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ·±å…¥åœ°äº†è§£æˆ‘ä»¬ä¸–ç•Œçš„ç”Ÿæ€ç³»ç»Ÿï¼Œå¹¶å……åˆ†äº†è§£æ°”å€™å˜åŒ–å¯¹æˆ‘ä»¬ç¯å¢ƒçš„å½±å“ã€‚

## ç­‰ç­‰ï¼Œä¸Šé¢é‚£å¼ å›¾ä¸­é‚£äº›å¾ˆé…·çš„æƒ…èŠ‚æ˜¯ä»€ä¹ˆï¼Ÿ

å…ˆè¯´è¯´å£°éŸ³çš„ä¸€åˆ‡ã€‚å£°éŸ³åŸºæœ¬ä¸Šæ˜¯ç”±é€šè¿‡ç©ºæ°”è¿›å…¥æˆ‘ä»¬è€³è†œçš„å¥‡ç‰¹å‹åŠ›æ³¢ç»„æˆçš„ï¼Œå¯ä»¥ç”¨æ•°å­—è®¾å¤‡è®°å½•ä¸ºä¿¡å·ã€‚äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªä¿¡å·ç»˜åˆ¶å¦‚ä¸‹:

![](img/c992e5368f0ba4677431439f04ebefd7.png)

éŸ³é¢‘ä¿¡å·/æ³¢å½¢çš„ç¤ºä¾‹å›¾ï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«çš„ã€‚æˆ–è€…ä¹Ÿè®¸â€¦

ç„¶è€Œï¼Œè¿™ä¸ªé•¿çº¿å›¾çœ‹èµ·æ¥å¹¶ä¸ç‰¹åˆ«å¸å¼•äººï¼Œå¯ä»¥é¦ˆå…¥ä»»ä½•æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œæ›´ä¸ç”¨è¯´ CNN äº†ã€‚äº‹å®ä¸Šï¼Œå¦‚æœæˆ‘ç°åœ¨å‘Šè¯‰ä½ ï¼Œä¸Šé¢çš„éŸ³é¢‘ä¿¡å·ä»£è¡¨çš„æ˜¯ä¸€åªé¸Ÿçš„é¸£å«ï¼Œä½ ä¼šç›¸ä¿¡å—ï¼Ÿå¾ˆå¯èƒ½ä¸æ˜¯â€¦ä½ åè€Œè®¤ä¸ºè¿™æ˜¯æˆ‘éšæœºåˆ›ä½œçš„æƒ…èŠ‚ã€‚ ***å¦‚æœä½ è®¤ä¸ºé¸Ÿé¸£å£°åœ¨ç¬¬ 10000 æ¬¡æ»´ç­”é™„è¿‘ï¼Œå¦‚æœæˆ‘è¯´é¸Ÿé¸£å£°æ­£å¥½åœ¨ä¸­é—´ï¼Œåœ¨ç¬¬ 6000 æ¬¡æ»´ç­”æ—¶å‘¢ï¼Ÿ*** é‡ç‚¹æ˜¯:

> å¦‚æœæˆ‘ä»¬è‡ªå·±éƒ½ä¸èƒ½å¯¹ä»»ä½•ç‰¹å®šçš„ä¿¡å·å›¾ä»£è¡¨ä»€ä¹ˆåšå‡ºä»»ä½•å¼ºæœ‰åŠ›çš„å‡è®¾ï¼Œæˆ‘ä»¬æ€ä¹ˆèƒ½æŒ‡æœ›æ·±åº¦å­¦ä¹ æ¨¡å‹åšåˆ°è¿™ä¸€ç‚¹å‘¢ï¼Ÿ

â€¦æˆ‘ä»¬å¹¶æ²¡æœ‰å®Œå…¨é™·å…¥å›°å¢ƒã€‚å®é™…ä¸Šè¿˜æœ‰å¦ä¸€ç§æ–¹å¼æ¥è¡¨ç¤ºéŸ³é¢‘:**é¢‘è°±å›¾**ã€‚é¢‘è°±å›¾æ˜¯é€šè¿‡åœ¨ä¸€ä¸ªå°çš„æ—¶é—´çª—å£ä¸­è®°å½•é¢‘ç‡çš„å­˜åœ¨å’Œå„è‡ªçš„å¼ºåº¦ï¼Œæ²¿ç€ x è½´(ç”±æ—¶é—´å•ä½è¡¨ç¤º)å †å ï¼Œç›´åˆ°é¢‘è°±å›¾è¦†ç›–éŸ³é¢‘ä¿¡å·çš„æ€»æŒç»­æ—¶é—´è€Œåˆ¶æˆçš„ã€‚å½“æ—¶é—´çª—åœ¨è°±å›¾åˆ›å»ºè¿‡ç¨‹ä¸­ç§»åŠ¨æ—¶ï¼Œæ—¶é—´çª—è‡ªèº«é‡å æ˜¯å¸¸è§çš„ï¼Œå¹¶ä¸”é€šå¸¸é¢‘ç‡å¼ºåº¦(éŸ³é‡æˆ–å“åº¦)ç”¨é¢œè‰²è¡¨ç¤ºï¼Œæˆ–è€…ç”¨æ•°å­—è¡¨ç¤ºï¼Œè¾ƒé«˜/è¾ƒä½å€¼ã€‚

![](img/73278e838819308301641aae2b49167d.png)

ä»ä¸Šé¢æ˜¾ç¤ºçš„å®Œå…¨ç›¸åŒçš„æ³¢å½¢ä¼ªé€ çš„å£°è°±å›¾ã€‚x è½´ã€y è½´å’Œç»˜å›¾é¢œè‰²åˆ†åˆ«ä»£è¡¨æ—¶é—´å•ä½ã€é¢‘ç‡(å•ä½ä¸ºèµ«å…¹)å’Œé¢‘ç‡å¼ºåº¦ã€‚ç°åœ¨ï¼Œä½ èƒ½æ¸…æ¥šåœ°åˆ†è¾¨å‡ºè¿™åªé¸Ÿæ˜¯ä¸æ˜¯åœ¨å«ï¼Œä»€ä¹ˆæ—¶å€™å«å—ï¼Ÿ

ç»™å®šæ¥è‡ªä¸Šæ–¹çš„ä¿¡å·çš„é¢‘è°±å›¾ï¼Œå¦‚æœå’Œå½“é¸Ÿé¸£å«æ—¶ï¼Œå®ƒåº”è¯¥æ›´æ¸…æ¥šã€‚å…·ä½“æ¥è¯´â€œåªæ˜¯å› ä¸ºâ€ï¼Œä½ å¯ä»¥åœ¨ 250 ms æ ‡è®°å¤„çœ‹åˆ° 6000 Hz å·¦å³çš„ç‹¬ç‰¹æ´»åŠ¨ï¼›é‚£æ˜¯é¸Ÿé¸£å£°ã€‚å› æ­¤ï¼Œ **CNN éŸ³é¢‘åˆ†ç±»å™¨é€šå¸¸å°†é¢‘è°±å›¾ä½œä¸ºè¾“å…¥ï¼Œé¸Ÿç±»éŸ³é¢‘æ£€æµ‹æ¨¡å‹ä¹Ÿä¸ä¾‹å¤–ã€‚**

# å‡†å¤‡

## æ•°æ®é›†

ä¸ºæ­¤ï¼Œæˆ‘ä½¿ç”¨äº†æ¥è‡ª BirdVox çš„ [BirdVox-70k](https://zenodo.org/record/1226427) æ•°æ®é›†ï¼Œå®ƒåŒ…å«åŠç§’(500 æ¯«ç§’)çš„è®°å½•/æ³¢å½¢ï¼ŒåŒ…å«æˆ–ä¸åŒ…å«é¸Ÿå•å•¾å£°ã€‚è¯¥æ•°æ®é›†æ¥è‡ªå…¶æ›´å¤§çš„å…„å¼Ÿï¼ŒBirdVox-full-nightï¼Œä¸¤è€…éƒ½æ˜¯åœ¨ 2015 å¹´ç§‹å­£åœ¨ç¾å›½çº½çº¦ä¼Šè¨å¡è®°å½•çš„ã€‚æ¯ä¸ªæ³¢å½¢çš„æ ‡ç­¾ä½œä¸ºæœ€åä¸€ä½æ•°å­—åŒ…å«åœ¨æ¯ä¸ªæ–‡ä»¶åä¸­(æˆ–è€…æ˜¯`0`æˆ–è€…æ˜¯`1`)ã€‚å°½ç®¡ 70k æ•°æ®é›†æ‹¥æœ‰å¤§çº¦ 70ï¼Œ000 ä¸ªæ•°æ®ç‰‡æ®µ(å› æ­¤å¾—å)ï¼Œä½†æˆ‘å°†åªä½¿ç”¨å…¶ä¸­çš„ä¸‰åˆ†ä¹‹äºŒ(æ›´ç¡®åˆ‡åœ°è¯´ï¼Œå¤§çº¦ 50ï¼Œ000 ä¸ª)ï¼Œå› ä¸ºæˆ‘çš„ [Paperspace](https://www.paperspace.com/) å¸æˆ·ä¸­çš„æŒä¹…å­˜å‚¨ç©ºé—´è¶Šæ¥è¶Šå°‘ğŸ˜¦ã€‚

æ•°æ®è¢«æ†ç»‘åœ¨å•ç‹¬çš„ HDF5 æ–‡ä»¶ä¸­ï¼Œè¿™æ„å‘³ç€æˆ‘è®¡åˆ’ä½¿ç”¨çš„å·²ç»å‡å°‘çš„ 50ï¼Œ000 ä¸ªæ ·æœ¬å®é™…ä¸Šè¢«åˆ†æˆ 4 ä¸ªä¸åŒçš„. hdf5 æ–‡ä»¶ã€‚ä¸ºäº†å¢åŠ èåˆï¼Œæ¯ä¸ªæ³¢å½¢è¢«å­˜å‚¨åˆ°ä¸€ä¸ªæœ‰è‡ªå·±çš„â€œæ–‡ä»¶åâ€æ ‡ç­¾çš„ç»„ä¸­ï¼Œæ‰€æœ‰è¿™äº›è¢«å­˜å‚¨åˆ°å¦ä¸€ä¸ªç§°ä¸ºâ€œæ³¢å½¢â€çš„ç»„ä¸­ã€‚å³ä½¿åœ¨é˜…è¯»äº† [h5py æ–‡æ¡£](https://h5py.readthedocs.io/en/stable/quick.html)ä¹‹åï¼Œæˆ‘è¿˜æ²¡æœ‰çœ‹åˆ°å¦‚ä¸Šæ‰€è¿°çš„è¿™ç§å®‰æ’ã€‚è¿™äº›å‘ç°å·²ç»è®©æˆ‘åšäº†ä¸¤ä¸ªæœ€ç³Ÿç³•çš„æ•°æ®å‡†å¤‡å™©æ¢¦ã€‚å‡ ä¹æ²¡æœ‰å­˜å‚¨ç©ºé—´äº†ï¼Œæˆ‘æ— æ³•æ”¹å˜å·²ç»ç»™æˆ‘çš„æ•°æ®æ ¼å¼ã€‚è¿™ç»™æˆ‘ç•™ä¸‹äº†æœ€åä¸€ä¸ªé€‰æ‹©:åˆ›å»ºä¸€ä¸ªéå¸¸å®šåˆ¶çš„ PyTorch æ•°æ®é›†ç±»ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥ç»§ç»­äº†ã€‚

> ä½†åœ¨æˆ‘ç»§ç»­ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å¬ä¸€äº›ç®€çŸ­çš„éŸ³é¢‘æ ·æœ¬ï¼Œä»¥åŠå¯¹æ•°æ®é›†çš„ä¸€äº›ç®€å•æ•°æ®åˆ†æ(**è­¦å‘Šâ€”é™ä½éŸ³é‡ï¼Œå› ä¸ºæ ·æœ¬å¯èƒ½æ¯”é¢„æœŸçš„æ›´å“**):

ä¸€äº›é¸Ÿç§¯æçš„éŸ³é¢‘ç‰‡æ®µä¾›æ‚¨æ¬£èµ

ä¸€äº›é¸Ÿè´Ÿé¢çš„éŸ³é¢‘ç‰‡æ®µä¾›æ‚¨æ¬£èµ

äº‹å®è¯æ˜ï¼Œåœ¨å°†æ‰€æœ‰æ–‡ä»¶ç»„åˆåœ¨ä¸€èµ·åï¼Œbird é˜³æ€§éŸ³é¢‘æ ·æœ¬çš„æ¯”ä¾‹æ­£å¥½æ˜¯ 50%ï¼Œæ­£å¦‚ä»–ä»¬åœ¨[ç½‘ç«™](https://wp.nyu.edu/birdvox/codedata/)ä¸­æ‰¿è¯ºçš„é‚£æ ·ã€‚æ¯ä¸ªé¸Ÿæ­£æ³¢å½¢çš„æ–‡ä»¶åè¿˜åŒ…æ‹¬é¸Ÿå«çš„é¢‘ç‡ã€‚ç»¼åˆæ‰€æœ‰è¿™äº›ï¼Œä»¥ä¸‹æ˜¯æˆ‘çš„å‘ç°:

æˆ‘é¢„è®¡è®¸å¤šç”µè¯ä¼šç›¸å½“é«˜ã€‚ ***å¾ˆå¤§ä¸€éƒ¨åˆ†æ ·æœ¬éƒ½æ˜¯å¦‚æ­¤ï¼Œä½†ç»å¤§å¤šæ•°å®é™…ä¸Šæ›´æ¥è¿‘ä½é¢‘(2000â€“3500Hz)ã€‚*** æŒºæƒŠå–œçš„ï¼

## æ•°æ®é›†å’Œæ•°æ®åŠ è½½å™¨ç±»

å¥½äº†ï¼Œæˆ‘ä»¬çŸ¥é“æœ‰å•ç‹¬çš„. hdf5 æ–‡ä»¶è¦å¤„ç†æˆä¸€ä¸ªâ€œæ•°æ®é›†â€ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ä¸€ä¸ªæœ‰ç‚¹ç¬¨æ‹™çš„æ•°æ®ç»“æ„ã€‚**è¿™äº›æ¡ä»¶è‚¯å®šéœ€è¦ä¸€ä¸ªå®šåˆ¶çš„ PyTorch æ•°æ®é›†ç±»æ¥æ­£ç¡®åœ°åŠ è½½æˆ‘ä»¬çš„éŸ³é¢‘æ•°æ®ï¼Œä»¥ä¾¿ç¨åè¿›è¡Œè®­ç»ƒã€‚**æ•°æ®é›†ç±»ä¸»è¦éœ€è¦`__init__`å’Œ`__getitem__`å‡½æ•°(è¿˜æœ‰`__len__`ï¼Œä½†è¿™å¾ˆç®€å•)ã€‚ä»¥ä¸‹æ˜¯æˆ‘è®¡åˆ’æ¯ä¸ªäººè¦åšçš„äº‹:

`**def __init__():**`

*   éå†æ‰€æœ‰å››ä¸ªæ–‡ä»¶ä¸­æ¯ä¸ªæ³¢å½¢çš„æ¯ä¸ªç»„å&å°†å®ƒæ‰€å±çš„æ–‡ä»¶å’Œ HDF5 ç»„æ·»åŠ åˆ°å±äºè¯¥ç±»çš„åˆ—è¡¨ä¸­ã€‚
*   è·å–æ³¢å½¢çš„æ ‡ç­¾(æ–‡ä»¶/ç»„åçš„æœ€åä¸€ä½)å¹¶æ·»åŠ åˆ°å±äºè¯¥ç±»çš„å¦ä¸€ä¸ªåˆ—è¡¨ä¸­ã€‚ä¾‹å¦‚ï¼Œæ–‡ä»¶å`unit03_012712228_00000_0`è¡¨ç¤ºæ²¡æœ‰ä»»ä½•é¸Ÿç±»å‘å£°ã€‚
*   å‡†å¤‡ä¸€ä¸ªåº”ç”¨äºæ³¢å½¢çš„å˜æ¢å‡½æ•°ï¼Œå°†å…¶è½¬æ¢ä¸ºå£°è°±å›¾(ç‰¹åˆ«æ˜¯ mel ç¼©æ”¾çš„å£°è°±å›¾)ï¼Œå¹¶å…è®¸å…¶ä»–å¢å¼ºæŠ€æœ¯ã€‚

`**def __getitem__():**`

*   å…ˆå‰åˆå§‹åŒ–çš„ä¸¤ä¸ªåˆ—è¡¨çš„ç´¢å¼•
*   é€šè¿‡åˆ—è¡¨æ¥æ”¶åˆ°æ³¢å½¢çš„ä½ç½®åï¼Œæ‰“å¼€è¯¥æ³¢å½¢çš„ HDF5 æ–‡ä»¶ã€‚æ‰€æœ‰ HDF5 I/O å°†ä½¿ç”¨ python åº“`h5py`è¿›è¡Œå¤„ç†
*   å°†å…¶è½¬æ¢ä¸º PyTorch å¼ é‡ï¼Œå¹¶åº”ç”¨ä»»ä½•å˜æ¢ï¼ŒåŒ…æ‹¬é¢‘è°±å›¾å˜æ¢ã€‚
*   å°†ç‰©å“è¿”è¿˜ç»™å‘¼å«è€…ã€‚

ä¸‹é¢ï¼Œæˆ‘å°†è¿™äº›æƒ³æ³•è½¬åŒ–ä¸ºæ•°æ®é›†ç±»çš„ä»£ç :

å‘€ï¼Œè¿™ä¸ªå¤ªé•¿äº†ï¼å¦‚æœå¤ªå¤šäº†ï¼Œåªè¦ç›¸ä¿¡æˆ‘ä¸Šé¢æè¿°çš„ä»»ä½•åŠŸèƒ½éƒ½æ˜¯åœ¨è¿™é‡Œå®ç°çš„ã€‚ä½†æ˜¯å¾€å¥½çš„æ–¹é¢çœ‹ï¼ŒåŸºæœ¬ä¸Šè¿™æ¬¡åŠªåŠ›æœ€éš¾çš„éšœç¢å·²ç»è¢«è¶…è¶Šäº†ï¼

æˆ‘ä»¬å®šä¹‰æ•°æ®é›†æ–‡ä»¶çš„ç›®å½•ï¼Œä»¥åŠæ–‡ä»¶åæœ¬èº«ã€‚æˆ‘å†³å®šä½¿ç”¨ 4 ä¸ªæ–‡ä»¶ä¸­çš„ 3 ä¸ªä½œä¸ºæµ‹è¯•æ•°æ®ï¼Œæœ€åä¸€ä¸ªä½œä¸ºéªŒè¯/æµ‹è¯•é›†æ¥æµ‹é‡æ¨¡å‹çš„æ€§èƒ½ï¼Œä¸ºåè€…ç•™ä¸‹æœ€å°çš„æ–‡ä»¶ã€‚ç”±äºæ¯ä¸ªæ–‡ä»¶çš„æ‰€æœ‰è®°å½•è®¾å¤‡éƒ½è®¾ç½®å¾—ç›¸å¯¹é è¿‘(åœ¨ä¼Šè¨å¡çš„åŒä¸€ä¸ªåŸå¸‚)ï¼Œæˆ‘ç›¸ä¿¡ç»•è¿‡éšæœºåˆ†å‰²ä¸ä¼šå¼•å…¥å¤§é‡åå·®ã€‚

ç”¨ä¸Šé¢åˆ—å‡ºçš„ä¸‰ä¸ªæ–‡ä»¶åˆ¶ä½œä¸€åˆ—ç«è½¦

ä»æœ€åä¸€ä¸ª(ä¹Ÿæ˜¯æœ€å°çš„)æ–‡ä»¶åˆ›å»ºéªŒè¯é›†

è®¾ç½®å¥½æ•°æ®é›†åï¼Œå°±è¯¥å®šä¹‰æ•°æ®åŠ è½½å™¨äº†:

æ‰¹é‡

å®šä¹‰æ•°æ®åŠ è½½å™¨ï¼Œå®ƒå°†æˆæ‰¹è¿”å›æ•°æ®ã€‚åœ¨æ„è¯†åˆ°ä½¿ç”¨ PyTorch å’Œ HDF5 æ–‡ä»¶æ—¶å­˜åœ¨ä¸€ä¸ª bug ä¹‹å‰ï¼Œæˆ‘å·²ç»å°è¯•è¿‡è®¾ç½®å¤šä¸ªâ€œnum_workersâ€

# æ¨¡å‹

## æ¨¡å‹åˆ›å»º

æˆ‘ä¸ºæˆ‘çš„æ¨¡å‹è®¾ç½®äº†ä»»ä½•å¿…è¦çš„è¾…åŠ©å‡½æ•°ï¼Œä»¥ä¾¿ç¨åè¿›è¡Œè®­ç»ƒ:

å®šä¹‰å¤šä¸ªå‡½æ•°ï¼Œç¨åå¯ä»¥ä½¿ç”¨è¿™äº›å‡½æ•°æ¥è®­ç»ƒç»§æ‰¿è¯¥ç±»çš„ PyTorch æ¨¡å‹ã€‚

æ­¤å‡½æ•°åœ¨ä¸Šè¿°ç±»çš„ val_step å‡½æ•°ä¸­çŸ­æš‚ä½¿ç”¨ï¼Œä»¥ç¡®å®šéªŒè¯æ•°æ®åŠ è½½å™¨ä¸Šæ¨¡å‹çš„%(ç™¾åˆ†æ¯”)å‡†ç¡®æ€§ï¼Œè€Œä¸ä»…ä»…æ˜¯éªŒè¯æŸå¤±ã€‚

å¹¶å®šä¹‰ç”¨äºæ‹Ÿåˆ/è®­ç»ƒæ¨¡å‹å¹¶åœ¨éªŒè¯æ•°æ®é›†ä¸Šæµ‹è¯•æ¨¡å‹çš„ä¸»è¦å‡½æ•°:

å®šä¹‰è®­ç»ƒ/éªŒè¯å¾ªç¯

æœ€åï¼Œ ***è¿™æ˜¯æˆ‘ä»¬ä¸€ç›´åœ¨ç­‰å¾…çš„ç®€å• CNN æ¨¡å‹*** :

ç›¸å¯¹ç®€å•ï¼Œè€ƒè™‘åˆ° ResNets å’Œå…¶ä»–æµè¡Œçš„ç½‘ç»œæ¨¡å‹éƒ½æ¯”è¿™ä¸ªå¤§å¾ˆå¤šå¾ˆå¤šï¼

æˆ‘åˆ©ç”¨äº†å¤šä¸ªå·ç§¯å±‚ï¼Œæ­£å¦‚æˆ‘ä»¬ä¹‹å‰çš„ç†è®ºæ¨æ–­å»ºè®®æˆ‘ä»¬ä¸ºæ¨¡å‹æ‰€åšçš„é‚£æ ·ï¼Œä½¿ç”¨ä¸€äº›æœ€å¤§æ± å±‚ï¼Œç„¶åæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„å…¨è¿æ¥ç½‘ç»œæ¥è¿›è¡Œå®é™…åˆ†ç±»ã€‚ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œè¿™ä¸ªæ¶æ„åæ¥è¡¨ç°å¾—ç›¸å½“å¥½ï¼Œç”šè‡³è¶…è¿‡äº†æˆ‘è‡ªå·±çš„é¢„æœŸã€‚

## åˆ©ç”¨ GPU

å¦‚ä»Šï¼Œå‡ ä¹æ¯ä¸ªäººéƒ½éœ€è¦ä¸€ä¸ª GPU æ¥è®­ç»ƒæ¯”æ™®é€šå‰é¦ˆç¥ç»ç½‘ç»œæ›´å¤æ‚çš„ä¸œè¥¿ã€‚å¹¸è¿çš„æ˜¯ï¼ŒPyTorch ä½¿æˆ‘ä»¬èƒ½å¤Ÿè½»æ¾åˆ©ç”¨å¯ç”¨ GPU çš„èƒ½åŠ›ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°† cuda è®¾å¤‡å®šä¹‰ä¸ºå…³é”®å­—`device`ï¼Œä»¥ä¾¿äºè®¿é—®:

æˆ‘ä»¬è¿˜ç¡®ä¿å¦‚æœæ²¡æœ‰ GPUï¼Œå°†ä½¿ç”¨ CPU æ¥ä»£æ›¿ã€‚

è¿™é‡Œè¿˜æœ‰å¦ä¸€ä¸ªæŠ€å·§:

è¿™æœ‰åŠ©äºæé«˜ä½ çš„è®­ç»ƒé€Ÿåº¦(å¦‚æœä½ çš„è¾“å…¥åœ¨å¤§å°/å½¢çŠ¶ä¸Šæ²¡æœ‰å˜åŒ–çš„è¯)

æ˜¾ç„¶ï¼Œæ‚¨å¯ä»¥â€œå‘Šè¯‰â€PyTorch åœ¨åå¤è®­ç»ƒæ—¶ä¼˜åŒ–è‡ªå·±ï¼Œåªè¦è®­ç»ƒè¾“å…¥åœ¨å¤§å°å’Œå½¢çŠ¶æ–¹é¢ä¿æŒä¸å˜ã€‚å®ƒä¼šçŸ¥é“ä¸ºä½ çš„ç‰¹å®šç¡¬ä»¶(GPU)ä½¿ç”¨æœ€å¿«çš„ç®—æ³•ã€‚ä½ çŸ¥é“çš„è¶Šå¤šï¼

ç„¶åï¼Œæˆ‘ä»¬å®šä¹‰åŠ©æ‰‹å‡½æ•°ï¼Œå°†æ•°æ®åŠ è½½å™¨ã€å¼ é‡å’Œæˆ‘ä»¬çš„æ¨¡å‹ç§»åŠ¨åˆ°æˆ‘ä»¬çš„ GPU è®¾å¤‡ã€‚

å„ç§åŠ©æ‰‹åŠŸèƒ½ï¼Œä»¥ç¡®ä¿æˆ‘ä»¬æ€»æ˜¯åœ¨ä½¿ç”¨æˆ‘ä»¬çš„ GPUã€‚

# åŸ¹å…»

## åŸ¹è®­å…ˆå†³æ¡ä»¶

ä½¿ç”¨æˆ‘ä»¬çš„è®¾å¤‡åŠ©æ‰‹å‡½æ•°ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰ä¸œè¥¿ç§»åŠ¨åˆ°æˆ‘ä»¬çš„ GPUï¼Œå¦‚ä¸‹æ‰€ç¤º:

æˆ‘ä»¬çš„æ•°æ®åŠ è½½å™¨-> GPU

å‹å·-> GPU

æˆ‘ä»¬è¿˜æŒ‡å®šäº†æˆ‘ä»¬çš„å­¦ä¹ ç‡å’Œæˆ‘ä»¬çš„çºªå…ƒæ•°é‡ï¼Œè¿™èŠ±äº†æˆ‘å¾ˆé•¿çš„æ—¶é—´æ¥ä¸ºè¿™ä¸¤è€…æ‰¾åˆ°ä¸€ä¸ªå¥½çš„å€¼ã€‚

åœ¨æˆ‘çš„å®éªŒä¸­ï¼Œæˆ‘å‘ç°è¿™äº›è¶…å‚æ•°æ˜¯æœ€æœ‰æ•ˆçš„ã€‚

ç°åœ¨ï¼Œ ***èµ·ï¼***

## å¥½äº†ï¼Œæˆ‘ä»¬ç»ˆäºå¼€å§‹è®­ç»ƒäº†ï¼

æˆ‘ä»¬å‘ç°æ¨¡å‹åœ¨ä»»ä½•è®­ç»ƒä¹‹å‰çš„è¡¨ç°:

å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬åœ¨å‡†ç¡®æ€§ä¸Šæœ‰ç‚¹å¹¸è¿ï¼Œå¼€å§‹æ—¶æœ‰ç‚¹æœ‰åˆ©ï¼Œä½†æ ¹æ®å‡ æ¬¡è¯•éªŒï¼Œæœ€ç»ˆç»“æœå°†éå¸¸ç›¸ä¼¼ï¼Œå¦‚æœä¸æ˜¯ç›¸åŒçš„è¯ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„`fit`å‡½æ•°æ¥è®­ç»ƒæˆ‘ä»¬ç®€å•çš„`Classifier`æ¨¡å‹å®ä¾‹:

å¿½ç•¥' HBox 'æ–‡ç‰©ï¼Œæˆ‘çŸ¥é“æˆ‘ä¸åº”è¯¥ä½¿ç”¨ tqdmï¼

åœ¨çœ‹åˆ°å‡†ç¡®æ€§ç•¥æœ‰ä¸‹é™åï¼Œæˆ‘å†³å®šå†è®­ç»ƒä¸€ç‚¹ç‚¹ï¼Œä»¥å°†æ¨¡å‹é‡å®šå‘å›æ­£ç¡®çš„æ–¹å‘:

å•Šï¼Œæ›´å¤šçš„ç›’å­ï¼ä½†æ˜¯ï¼Œçœ‹é‚£å‡†ç¡®æ€§ï¼

æ€»è€Œè¨€ä¹‹ï¼Œä»¥ä¸‹æ˜¯æˆ‘ä»¬åœ¨ç”¨äºè®­ç»ƒçš„ 11 ä¸ªæ—¶æœŸå†…çš„è®­ç»ƒç»Ÿè®¡æ•°æ®:

æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬çš„æ¨¡å‹è®­ç»ƒå¾—å¾ˆå¥½ï¼Œä»è¡¨é¢ä¸Šçœ‹ï¼Œæˆ‘ä»¬å¯èƒ½å·²ç»æ‰¾åˆ°äº†æ¨¡å‹æŸå¤±çš„ç›¸å¯¹æœ€å°å€¼ã€‚

## ç­‰ç­‰ï¼Œä¸€ä¸ªæ›´å¤æ‚çš„æ¨¡å‹æˆ–è€…ä½¿ç”¨ä¸åŒçš„å˜æ¢æ€ä¹ˆæ ·ï¼Ÿ

ç›¸ä¿¡æˆ‘ï¼Œåœ¨æˆ‘ç®€å•çš„`Classifier()`ç¬¬ä¸€æ¬¡å°è¯•æˆåŠŸåä¸ä¹…ï¼Œæˆ‘ä¹Ÿå°è¯•è¿‡è¿™ä¸¤ç§æ–¹æ³•ã€‚æˆ‘å†³å®šä¸åŒ…æ‹¬ä¸¤è€…çš„ç»†èŠ‚ï¼Œå› ä¸ºæˆ‘å‘ç°ä»–ä»¬çš„ç»“æœå®é™…ä¸Šæ¯”æˆ‘ä»¬å·²ç»å–å¾—çš„ç»“æœæ›´ç³Ÿç³•*ï¼Œå¾ˆå¥‡æ€ªã€‚*

> **å¦‚æœä½ æƒ³çœ‹çœ‹æˆ‘æ˜¯å¦‚ä½•å°è¯•å®ç°è¿™ä¸¤è€…çš„ï¼Œè¯·ç›´æ¥æ¥çœ‹æˆ‘è´´åœ¨è¿™é‡Œçš„ç¬”è®°æœ¬:*[*https://jovian.ml/richardso21/bird-audio-detection*](https://jovian.ml/richardso21/bird-audio-detection)*ã€‚**

*å¯¹äºé¢å¤–çš„å£°è°±å›¾è½¬æ¢ï¼Œæˆ‘å°è¯•äº†éšæœºæ—¶ç§»å’Œå™ªå£°æ³¨å…¥ã€‚é•¿è¯çŸ­è¯´ï¼Œå®ƒä¼¼ä¹æ ¹æœ¬æ²¡æœ‰æé«˜éªŒè¯çš„å‡†ç¡®æ€§ã€‚æ­¤åï¼Œæˆ‘å¯¹æ­¤è¿›è¡Œäº†æ¨ç†ï¼Œå› ä¸ºæ•°æ®é›†è§„èŒƒæ˜ç¡®æŒ‡å‡ºï¼Œæ‰€æœ‰å•å•¾éƒ½å°†ä½äºéŸ³é¢‘è®°å½•çš„ä¸­é—´å¤„*ï¼Œå› æ­¤**éšæœºç§»åŠ¨é¢‘è°±å›¾ä»¥å®ç°æ›´å¥½çš„æ¨¡å‹æ³›åŒ–å®é™…ä¸Šå¯èƒ½ä¼šæŸå®³å…¶æ€§èƒ½**ã€‚ç„¶è€Œï¼Œæˆ‘è¿˜æ²¡æœ‰å°è¯•åªæœ‰éšæœºå™ªå£°æ³¨å…¥ã€‚**

*æˆ‘è¿˜è¯•å›¾è®­ç»ƒä¸€ä¸ª ResNet50 æ¨¡å‹ï¼Œå¸Œæœ›è¿›ä¸€æ­¥æé«˜éªŒè¯çš„å‡†ç¡®æ€§ã€‚è¿™é‡Œæ˜¯æœ€ä»¤äººéš¾ä»¥ç½®ä¿¡çš„éƒ¨åˆ†: ***æˆ‘ä»æœªå¾—åˆ°è¿‡è¶…è¿‡ 50%å‡†ç¡®ç‡çš„æ¨¡å‹*** ï¼*å½“æˆ‘å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘è¿˜ä¸ç¡®å®šæˆ‘åˆ°åº•åšé”™äº†ä»€ä¹ˆï¼Œæ‰€ä»¥å¦‚æœå…¶ä»–äººå¯ä»¥çœ‹çœ‹æˆ‘ä¸Šé¢çš„ç¬”è®°æœ¬å¹¶å¸®åŠ©æˆ‘ï¼Œæˆ‘éå¸¸ä¹æ„æ¥å—ä»»ä½•æ„è§æˆ–å»ºè®®ï¼**

# *ç»“è®º*

*æ€»çš„æ¥è¯´ï¼Œæˆ‘ä¼šè¯´è¿™æ˜¯ä¸€æ¬¡éå¸¸æœ‰è¶£çš„å°è¯•ï¼Œå€¼å¾—èŠ±äº›æ—¶é—´å»éš”ç¦»ã€‚é¦–å…ˆï¼Œæˆ‘ä¸å¾—ä¸é‡æ¸©æˆ‘å»å¹´å¤å¤©è°ƒæŸ¥è¿‡çš„ä¸œè¥¿ï¼Œè¿™ç¡®å®æœ‰ä¸€ç§æ€€æ—§çš„æ„Ÿè§‰ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œ**æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•ä¸ºä¸€ä¸ªå¾ˆå¯èƒ½æ˜¯çœŸå®ä¸–ç•Œçš„åœºæ™¯å®ç°ä¸€ä¸ª PyTorch æ•°æ®é›†ç±»ï¼Œåœ¨è¿™ä¸ªåœºæ™¯ä¸­ï¼Œæ•°æ®ä¸ä¸€å®šæ˜¯æŒ‰ç…§æ‚¨æ‰€æœŸæœ›çš„é‚£æ ·è®¾ç½®çš„**ã€‚æœ€åï¼Œ*å¤§çº¦ 84%çš„æœ€ç»ˆéªŒè¯åˆ†æ•°å¯¹äºæˆ‘åœ¨è¿è¡Œä¸­æ„å»ºçš„è¿™æ ·ä¸€ä¸ªç®€å•çš„ç½‘ç»œæ¶æ„æ¥è¯´æ˜¯ç›¸å½“ä¸é”™çš„ã€‚**

*ç„¶è€Œï¼Œæˆ‘å¸Œæœ›ä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œå°±åƒæˆ‘å–œæ¬¢åšå®ƒä¸€æ ·ï¼ä¸€å¦‚æ—¢å¾€ï¼Œå¿«ä¹ç¼–ç ï¼*(è¿™æ˜¯* ***çœŸçš„*** *å¼€å§‹æˆä¸ºæˆ‘åœ¨åª’ä½“ä¸Šçš„æµè¡Œè¯­â€¦â€¦)**

> *å¦‚æœä½ æƒ³è¦è¿™ç¯‡æ–‡ç« ä¸­æ‰€æœ‰ä»£ç ç¤ºä¾‹çš„æºä»£ç /ç¬”è®°æœ¬ï¼Œä½ å¯ä»¥è®¿é—®[https://jovian.ml/richardso21/bird-audio-detection](https://jovian.ml/richardso21/bird-audio-detection)ã€‚*