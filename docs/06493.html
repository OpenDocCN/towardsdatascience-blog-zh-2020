<html>
<head>
<title>Create an N-Gram Ranking in Power BI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Power BI 中创建 N 元排序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-an-n-gram-ranking-in-power-bi-b27ba076366?source=collection_archive---------26-----------------------#2020-05-23">https://towardsdatascience.com/create-an-n-gram-ranking-in-power-bi-b27ba076366?source=collection_archive---------26-----------------------#2020-05-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="610d" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据科学/电力 BI 可视化</h2><div class=""/><div class=""><h2 id="d422" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">关于构建 Python 可视化的快速入门指南，只需点击几下鼠标和少量代码。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/8fd6c8d84ef5ffac2d524d5bb3a9aa06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*09u_9YpDdTA_SyZHFQYMaQ.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图为<a class="ae lh" href="https://unsplash.com/@stadsa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">塔达斯·萨</a>在<a class="ae lh" href="https://unsplash.com/s/photos/microsoft?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="55cd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">在之前的一篇</em> <a class="ae lh" rel="noopener" target="_blank" href="/from-dataframe-to-n-grams-e34e29df3460"> <em class="me">文章</em> </a> <em class="me">中，我写了一篇关于使用 nltk 进行自然语言处理来创建和可视化 n-gram 排序的快速入门指南。然而，我需要一种方法来与那些机器上没有安装 Python 或 Jupyter Notebook 的人分享我的发现。我需要使用我们组织的 BI 报告工具:Power BI。</em></p><p id="a528" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">进入<em class="me"> Python 可视化</em>。</p><p id="fc1a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Python 可视化允许您创建通过运行 Python 代码生成的可视化。在本帖中，我们将使用这种视觉效果来展示我们的 n-gram 排序结果所需的步骤。</p><p id="dddf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，让我们得到我们的数据。你可以在这里下载样本数据集<a class="ae lh" href="https://github.com/ecdedios/ngram-quick-start" rel="noopener ugc nofollow" target="_blank">。然后，我们可以将数据加载到 Power BI Desktop 中，如下所示:</a></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mf"><img src="../Images/0f1ed4b3efb9a27c289b6b4aa2264d47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B0CbmtvkJR80ZBFqQyj6cA.png"/></div></div></figure><p id="1def" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">选择文本/CSV 并点击“连接”。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mg"><img src="../Images/443e9b70a7630f3e92f3157c95ca47cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z9ZC2V_UFrG2HtV0eU7Htg.png"/></div></div></figure><p id="d768" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在 Windows 资源管理器文件夹中选择文件，然后单击打开:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mh"><img src="../Images/53f84a51442aad93c21d0d6462d8eb12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K4TYQWWsf0L2VPBHPyhgtQ.png"/></div></div></figure><p id="f818" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">点击“加载”。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mi"><img src="../Images/7ff417d3f2bd6481106dbc0f62be002e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fXo1FPTltLH9T4hMoOJMoA.png"/></div></div></figure><p id="5a4c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来，在“可视化”面板上找到 Py 图标。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mj"><img src="../Images/435b252fa837b3e5e6ab94370d716c0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dIrG9szUZdHGA4Ru1ajT_g.png"/></div></div></figure><p id="8290" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后，在出现启用脚本视觉效果的提示时，单击“启用”。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/2c45127d5b548a64ecd19d38da4b4a6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*TL0OrQVKd3-DIaAYsZCfmg.png"/></div></figure><p id="ff90" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您将看到一个占位符出现在主区域，一个 Python 脚本编辑器面板出现在仪表盘的底部。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ml"><img src="../Images/5e602ae715e4c9d44b9e365490518eb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aTZ170bYKbVnmoPdu2swsw.png"/></div></div></figure><p id="fcea" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">选择“字段”面板上的“文本”栏。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ml"><img src="../Images/6c7e60725f1f33d0526b8b0f12907acd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1xEMLRbIUKNYspnTGO1hjQ.png"/></div></div></figure><p id="8016" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您将看到一个预定义的脚本，它是我们将要编写的脚本的序言。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mm"><img src="../Images/b3b85134d225e2ee477ae6a7530e85be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8XXOwibs-PsKMYcMzA1wJA.png"/></div></div></figure><p id="8acd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在 Python 脚本编辑器面板中，将光标放在第 6 行的末尾，然后按两次 enter 键。</p><p id="f128" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后，复制并粘贴以下代码:</p><pre class="ks kt ku kv gt mn mo mp mq aw mr bi"><span id="5005" class="ms mt it mo b gy mu mv l mw mx">import re<br/>import unicodedata<br/>import nltk<br/>from nltk.corpus import stopwords</span><span id="82d3" class="ms mt it mo b gy my mv l mw mx">ADDITIONAL_STOPWORDS = ['covfefe']</span><span id="9dbe" class="ms mt it mo b gy my mv l mw mx">import matplotlib.pyplot as plt</span><span id="6460" class="ms mt it mo b gy my mv l mw mx">def basic_clean(text):<br/>  wnl = nltk.stem.WordNetLemmatizer()<br/>  stopwords = nltk.corpus.stopwords.words('english') + ADDITIONAL_STOPWORDS<br/>  text = (unicodedata.normalize('NFKD', text)<br/>    .encode('ascii', 'ignore')<br/>    .decode('utf-8', 'ignore')<br/>    .lower())<br/>  words = re.sub(r'[^\w\s]', '', text).split()<br/>  return [wnl.lemmatize(word) for word in words if word not in stopwords]</span><span id="9f96" class="ms mt it mo b gy my mv l mw mx">words = basic_clean(''.join(str(dataset['text'].tolist())))</span><span id="9dba" class="ms mt it mo b gy my mv l mw mx">bigrams_series = (pandas.Series(nltk.ngrams(words, 2)).value_counts())[:12]</span><span id="decb" class="ms mt it mo b gy my mv l mw mx">bigrams_series.sort_values().plot.barh(color='blue', width=.9, figsize=(12, 8))</span><span id="d4ab" class="ms mt it mo b gy my mv l mw mx">plt.show()</span></pre><p id="24c5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">简而言之，上面转换的代码从<code class="fe mz na nb mo b">dataset</code>数据帧的<code class="fe mz na nb mo b">'text'</code>列中提取 n-grams，并使用 matplotlib 创建一个水平条形图。<code class="fe mz na nb mo b">plt.show()</code>的结果就是 Power BI 在 Python 可视界面上显示的内容。</p><p id="1bf6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">关于这段代码的更多信息，请访问我的<a class="ae lh" rel="noopener" target="_blank" href="/from-dataframe-to-n-grams-e34e29df3460">以前的教程</a>。</p><div class="nc nd gp gr ne nf"><a rel="noopener follow" target="_blank" href="/from-dataframe-to-n-grams-e34e29df3460"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd jd gy z fp nk fr fs nl fu fw jc bi translated">从数据框架到 N 元语法</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">使用 nltk 为自然语言处理创建和可视化 n 元语法排序的快速入门指南。</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">towardsdatascience.com</p></div></div><div class="no l"><div class="np l nq nr ns no nt lb nf"/></div></div></a></div><p id="2f88" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">粘贴完代码后，单击 Python 脚本编辑器面板右上角的“播放”图标。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ml"><img src="../Images/b12fedbf8a46755b9df266d743cae567.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SapguhmWW1O5YA_I2DGHeg.png"/></div></div></figure><p id="64db" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">几分钟后，您应该能够看到如下所示的水平条形图:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nu"><img src="../Images/03b5596732bc104fd5ef255c6e41eabe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6dLnuFTgS-6piNMFskIFuA.png"/></div></div></figure><p id="0586" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">就是这样！</p><p id="fb40" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">只需简单地点击几下鼠标，在 Python 脚本的帮助下，我们就能够可视化 n 元语法排序的结果。</p></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><p id="95a6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我希望你喜欢今天关于 Power BI 最强特性之一的帖子。Power BI 已经有了一些有用和漂亮的内置视觉效果，但有时，你只需要多一点灵活性。运行 Python 代码对此有所帮助。我希望这个温和的介绍将鼓励你探索更多，扩大你的剧目。</p><p id="6cb0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在下一篇文章中，我将分享一个使用 spaCy   <em class="me">从熊猫数据帧中提取命名实体的快速入门指南</em> <a class="ae lh" rel="noopener" target="_blank" href="/from-dataframe-to-named-entities-4cfaa7251fc0"> <em class="me">。</em></a></p><p id="46af" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">敬请期待！</em></p><p id="1b2a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以通过<a class="ae lh" href="https://twitter.com/ecdedios" rel="noopener ugc nofollow" target="_blank"> Twitter </a>或<a class="ae lh" href="https://www.linkedin.com/in/ednalyn-de-dios/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p></div></div>    
</body>
</html>