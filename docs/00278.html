<html>
<head>
<title>Poppler On Windows</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Windows 上的 Poppler</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/poppler-on-windows-179af0e50150?source=collection_archive---------7-----------------------#2020-01-09">https://towardsdatascience.com/poppler-on-windows-179af0e50150?source=collection_archive---------7-----------------------#2020-01-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8d8d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Python、pdf 和 Window 的 Linux 子系统</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/958ae7c818b09b1b5e0e1825780f8f7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oqdzjV5Ipj5yB3GnQYm6jQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Windows 上的 Poppler</p></figure><h1 id="c940" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">简介:</h1><p id="943b" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated"><a class="ae mj" href="https://en.wikipedia.org/wiki/PDF" rel="noopener ugc nofollow" target="_blank">可移植文档格式(pdf)</a>无处不在，导入一个流行的 python 包，如<a class="ae mj" href="https://pypi.org/project/pdf2image/" rel="noopener ugc nofollow" target="_blank"> PDF2Image </a>、<a class="ae mj" href="https://pypi.org/project/pdftotext/" rel="noopener ugc nofollow" target="_blank">pdf text</a>或<a class="ae mj" href="https://pypi.org/project/python-poppler-qt5/" rel="noopener ugc nofollow" target="_blank"> PopplerQt5 </a>是处理它们的常用方法。不幸的是，除非您使用的是 Linux 机器，否则许多用户都报告说这些包返回了错误，因为它们依赖于 Poppler。</p><p id="f3fd" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">没听说过<a class="ae mj" href="https://en.wikipedia.org/wiki/Poppler_(software)" rel="noopener ugc nofollow" target="_blank">波普勒</a>？</p><p id="3bfc" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">Poppler 是一个用于渲染 pdf 的工具，在 Linux 系统中很常见，但在 Windows 中并不常见。因此，自然地，如果您想使用 Poppler 及其相关的包，我们需要弥补这个差距。</p><p id="c033" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">让我们访问谷歌，看看我们有什么选择…</p></div><div class="ab cl mp mq hu mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ij ik il im in"><p id="2ba1" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">在谷歌上快速搜索一下，就会发现还有很多人有这个问题，他们仍在寻找解决方案。</p><ul class=""><li id="f528" class="mw mx iq lp b lq mk lt ml lw my ma mz me na mi nb nc nd ne bi translated"><a class="ae mj" href="https://stackoverflow.com/questions/46184239/extract-a-page-from-a-pdf-as-a-jpeg" rel="noopener ugc nofollow" target="_blank"> PDF 到 JPG(波普勒)</a></li><li id="08be" class="mw mx iq lp b lq nf lt ng lw nh ma ni me nj mi nb nc nd ne bi translated"><a class="ae mj" href="https://stackoverflow.com/questions/18381713/how-to-install-poppler-on-windows" rel="noopener ugc nofollow" target="_blank">在 Windows 上安装 Poppler？</a></li><li id="225a" class="mw mx iq lp b lq nf lt ng lw nh ma ni me nj mi nb nc nd ne bi translated"><a class="ae mj" href="https://stackoverflow.com/questions/52336495/cannot-install-pdftotext-on-windows-because-of-poppler" rel="noopener ugc nofollow" target="_blank">无法在 Windows (Poppler)上安装“PDFtoText”</a></li><li id="5544" class="mw mx iq lp b lq nf lt ng lw nh ma ni me nj mi nb nc nd ne bi translated"><a class="ae mj" href="https://stackoverflow.com/questions/31817070/running-pypdfocr-on-windows-via-python-requiring-poppler" rel="noopener ugc nofollow" target="_blank">在 Windows 上运行 PyPDFOCR 需要 Poppler？</a></li><li id="5aad" class="mw mx iq lp b lq nf lt ng lw nh ma ni me nj mi nb nc nd ne bi translated"><a class="ae mj" href="https://stackoverflow.com/questions/51420803/modulenotfounderror-no-module-named-sipdistutils-while-install-python-poppler" rel="noopener ugc nofollow" target="_blank"> ModuleNotFoundError —没有名为‘SipDistUtils’(Poppler)的模块</a></li></ul><h1 id="6ea9" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">问题是:</h1><p id="100f" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">Poppler 和 Python 的 PDF 库利用了 Linux 实用程序，但不能很好地与 Windows 兼容。</p><p id="a7df" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">当我们寻找解决方案时，许多方案已经过时、无效、太难了，等等…</p><h1 id="ad45" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated"><strong class="ak">解决方案:</strong></h1><p id="98f1" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在提出的解决方案中，有一个解决方案似乎效果不错。</p><p id="6fb0" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated"><strong class="lp ir">Windows Linux 子系统(WSL)。</strong></p><p id="4ef9" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">实际上，由于 Linux 的 Windows 子系统是如此强大，它对于需要在 Windows 机器上使用 Linux 工具的其他问题是一个很好的解决方案。</p><h1 id="7fbb" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated"><strong class="ak">那么，WSL 是什么？</strong></h1><p id="d380" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">Windows Subsystem for Linux 是 Windows 10 上的 Linux 二进制可执行文件的兼容层。它最近进入了版本二(WSL 2)并引入了真正的 Linux 内核。简单地说，WSL 让你感觉像是在一台真正的 Linux 机器上工作(你确实是)。</p><h1 id="01e9" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated"><strong class="ak">安装和使用指南— WSL </strong></h1><p id="f012" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated"><a class="ae mj" href="https://docs.microsoft.com/en-us/windows/wsl/install-win10" rel="noopener ugc nofollow" target="_blank"> <strong class="lp ir">参考</strong> </a></p><p id="84d4" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">在本节中，我们将通过五个简短的步骤来安装和设置 WSL。之后，我们将通过几个简单的步骤来安装和设置 Poppler。</p><h2 id="7e4a" class="nk kw iq bd kx nl nm dn lb nn no dp lf lw np nq lh ma nr ns lj me nt nu ll nv bi translated"><strong class="ak">第一步:</strong></h2><p id="d9ba" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">以管理员身份运行 Window 的 Powershell。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/06d3636fdfd1131edc97d64e7dc13897.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*gSWgoaXqd4qqp8Ptr3T3SA.gif"/></div></div></figure><h2 id="0042" class="nk kw iq bd kx nl nm dn lb nn no dp lf lw np nq lh ma nr ns lj me nt nu ll nv bi translated"><strong class="ak">第二步:</strong></h2><p id="bf5c" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">通过执行“Enable-WindowsOptionalFeature”命令启用 WSL:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/48408833d408362b69184e62e612cbd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0Lylpbpp9-nMwHO3Dnsorw.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">启用 WSL</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h2 id="c005" class="nk kw iq bd kx nl nm dn lb nn no dp lf lw np nq lh ma nr ns lj me nt nu ll nv bi translated"><strong class="ak">第三步:</strong></h2><p id="f565" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">通过重新启动计算机来激活更改。</p><p id="71a3" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">注意，微软说，“为了确保 WSL 能够启动一个可信的执行环境，这个重启是必需的”</p><h2 id="e75b" class="nk kw iq bd kx nl nm dn lb nn no dp lf lw np nq lh ma nr ns lj me nt nu ll nv bi translated"><strong class="ak">第四步:</strong></h2><p id="42ae" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">现在，您从重启中回来了，您的系统的 WSL 已经启用，并且您已经准备好安装 Linux 发行版了。</p><p id="eba9" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">去橱窗商店搜索 WSL。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/c99c502c38ee323634fe4d7c4ff1f38b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*jmRm8ncCkjxBcw3i4unIZA.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">从 Windows 应用商店获取 WSL</p></figure><h2 id="1484" class="nk kw iq bd kx nl nm dn lb nn no dp lf lw np nq lh ma nr ns lj me nt nu ll nv bi translated"><strong class="ak">第五步(最终):</strong></h2><p id="fa62" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">点击 Ubuntu，选择安装。注意，我的已经安装了，所以你必须在这里做一些想象。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/d9a93a7e7433d08c4e8ff840bfdebda8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UruW74KSURh-OIaqj39_sw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">安装 Ubuntu</p></figure><h1 id="d0f8" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated"><strong class="ak">安装和使用指南— Poppler: </strong></h1><h2 id="7ccd" class="nk kw iq bd kx nl nm dn lb nn no dp lf lw np nq lh ma nr ns lj me nt nu ll nv bi translated">第一步:</h2><p id="c473" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在 VS 代码中，通过类似这样的终端输入 WSL。注意，一旦输入 WSL，终端提示符将会改变。您现在正在 Linux 机器中操作！激动人心！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/114749c95088c2eecfe4e789e726effb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ywhtF1WLbeL8fnn5p5K2g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">输入 WSL</p></figure><h2 id="bc02" class="nk kw iq bd kx nl nm dn lb nn no dp lf lw np nq lh ma nr ns lj me nt nu ll nv bi translated"><strong class="ak">第二步:</strong></h2><p id="86c7" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在 WSL-prompt 中执行以下命令。请注意，您可以忽略一些处理 Tesseract-OCR 和 PyTesseract 的步骤。这些是我在文章结尾分享的演示项目。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><h2 id="5b1e" class="nk kw iq bd kx nl nm dn lb nn no dp lf lw np nq lh ma nr ns lj me nt nu ll nv bi translated"><strong class="ak">步骤 3——测试(最终):</strong></h2><p id="efc1" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">使用新获得的现成 Poppler 实用程序运行程序。</p><p id="7626" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">我已经创建了这个<strong class="lp ir">演示脚本</strong>，所以如果你没有自己的也可以用。虽然你需要一个 PDF 文件来处理。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ny nz l"/></div></figure><p id="db18" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">这段代码的工作原理是将 PDF 转换成 JPG。然后，它进行 OCR，并将 OCR 结果写入输出文件。</p><h1 id="ab0f" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated"><strong class="ak">结论:</strong></h1><p id="525d" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">就是这样。你通过了 Windows 上的 Poppler 认证。</p><p id="a20e" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">享受战利品吧！你已经获得了一些全新而强大的技能。你正在成为一个更灵活的开发人员(如果你还没有的话)。</p><p id="97ac" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated"><strong class="lp ir">新获得的技能:</strong></p><ul class=""><li id="59b5" class="mw mx iq lp b lq mk lt ml lw my ma mz me na mi nb nc nd ne bi translated">用 Python 成功操作 pdf 的能力。</li><li id="03e5" class="mw mx iq lp b lq nf lt ng lw nh ma ni me nj mi nb nc nd ne bi translated">访问 PDF2Image、PDFToText 或其他 Poppler-utils。</li><li id="363d" class="mw mx iq lp b lq nf lt ng lw nh ma ni me nj mi nb nc nd ne bi translated">Linux 的 Windows 子系统。**非常强大的开发工具**</li></ul><h1 id="9416" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">现在，你能建造什么？</h1><p id="f2cb" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">尝试这些新技能并巩固你的理解是非常重要的。真正的理解来自经验。</p><h2 id="e9f9" class="nk kw iq bd kx nl nm dn lb nn no dp lf lw np nq lh ma nr ns lj me nt nu ll nv bi translated">我的 Poppler-On-Windows 项目:</h2><p id="6525" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">我构建了一个 OCR 应用程序来帮助记录退休教授和著名计算机科学家【Kenneth E. Batcher 博士的历史工作。它使用一个 PDF 到图像的 JPEG 转换工具。然后，它对图像进行 OCR，并将结果写入输出文件。由于这种概念证明工作得足够好，它最终将被用于文档扫描，而不是 pdf。</p><p id="74e5" class="pw-post-body-paragraph ln lo iq lp b lq mk jr ls lt ml ju lv lw mm ly lz ma mn mc md me mo mg mh mi ij bi translated">你可以在这里找到<a class="ae mj" href="https://github.com/matmill5/KenBatcherPP-OCR" rel="noopener ugc nofollow" target="_blank">的项目。</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/a2858d417db08958518a0bc63383a364.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MYqm7Rg7ANm2STpo-kFaiw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">OCR 应用程序—开发中</p></figure></div></div>    
</body>
</html>