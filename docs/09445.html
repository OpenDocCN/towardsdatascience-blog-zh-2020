<html>
<head>
<title>How to Generate MS Word Tables With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 Python 生成 MS Word 表格</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-generate-ms-word-tables-with-python-6ca584df350e?source=collection_archive---------20-----------------------#2020-07-06">https://towardsdatascience.com/how-to-generate-ms-word-tables-with-python-6ca584df350e?source=collection_archive---------20-----------------------#2020-07-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7264" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">30 秒内自动生成报告</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c9cb89b679592109b91f41bac6a4efc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7iUvgfyG28OCfcbi"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@sctgrhm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯科特·格雷厄姆</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="ddf4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">在讨论自动化的时候，Python 是经常被提到的。与其他编程语言相比，易于使用的语法、大量的库和面向脚本的语言结构使 Python 在自动化方面更胜一筹。</p><p id="e8bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">小型和大型公司每天都使用 Word 和 Excel 等 Microsoft Office 工具生成报告。在本文中，我将提供关于通过 Python 在 MS Word 中生成数据表的端到端解释。</p><blockquote class="me mf mg"><p id="d46e" class="kz la mh lb b lc ld ju le lf lg jx lh mi lj lk ll mj ln lo lp mk lr ls lt lu im bi translated"><em class="it">我将考虑一个场景，其中我们有许多新闻文章，我们需要生成一个 Word 文档，其中包含从这些文章中提取的统计数据。这些统计数据包括:</em>字数<em class="it">，</em>句子数<em class="it">和</em>平均单词长度<em class="it">。</em></p></blockquote></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h2 id="62ec" class="ms mt it bd mu mv mw dn mx my mz dp na li nb nc nd lm ne nf ng lq nh ni nj nk bi translated">属国</h2><p id="8ab2" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">对于这个例子，我使用了<a class="ae ky" href="https://www.python.org/downloads/release/python-370/" rel="noopener ugc nofollow" target="_blank"> Python 3.7 </a>。您需要安装的唯一依赖项是<a class="ae ky" href="https://python-docx.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> python-docx </a>。您可以通过在您机器的终端中提交以下命令来安装这个依赖项。</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="0cc5" class="ms mt it nr b gy nv nw l nx ny">pip install python-docx</span></pre></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h2 id="5d76" class="ms mt it bd mu mv mw dn mx my mz dp na li nb nc nd lm ne nf ng lq nh ni nj nk bi translated">从文章中提取统计数据</h2><p id="915f" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">对于这个例子，我从 CNN 中随机选取了两篇体育文章。为了提取统计数据，我编写了下面的<code class="fe nz oa ob nr b">describe_text(text)</code>函数。这个函数接受一个字符串参数(文章、评论等等)并返回一个统计数据字典，比如字符数、字数、句子数等等。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h2 id="9b24" class="ms mt it bd mu mv mw dn mx my mz dp na li nb nc nd lm ne nf ng lq nh ni nj nk bi translated">生成表格</h2><p id="3d90" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">首先你需要通过<code class="fe nz oa ob nr b">Document</code>类实例化一个文档对象。对于每篇文章，通过调用<code class="fe nz oa ob nr b">describe_text(text)</code>函数提取统计数据，并通过<code class="fe nz oa ob nr b">add_table(row, columns)</code>函数创建一个表格。对于字典中的每个 stat，通过<code class="fe nz oa ob nr b">add_row()</code>函数创建一行并添加相应的 stat。最后，通过调用<code class="fe nz oa ob nr b">add_page_break()</code>函数在末尾添加一个分页符，以便在新的页面中显示每个表格。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="9639" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于纯 Python 函数的更多文本统计，请查看我下面的另一篇文章。</p><div class="oe of gp gr og oh"><a rel="noopener follow" target="_blank" href="/10-pure-python-functions-for-ad-hoc-text-analysis-e23dd4b1508a"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">用于即席文本分析的 10 个纯 Python 函数</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">不使用外部库压缩文本数据</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">towardsdatascience.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov ks oh"/></div></div></a></div><h1 id="fcf0" class="ow mt it bd mu ox oy oz mx pa pb pc na jz pd ka nd kc pe kd ng kf pf kg nj pg bi translated">结论</h1><p id="4dc8" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">用 Python 生成 word 文档很容易。您所需要的就是<em class="mh"> python-docx </em>库。这个库提供了在 MS Word 中完成大多数(但不是全部)事情的可能性。</p><p id="33d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以我的经验来看，我在几秒钟内就生成了数千份两位数页数的 Word 文档。我这样做是为了以更易读的格式组织日志数据，或者在分析产品评论文本数据后呈现书面发现。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><div class="kj kk kl km gt oh"><a rel="noopener follow" target="_blank" href="/5-scenarios-where-beginners-usually-misuse-python-98bac34e6978"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">新手通常误用 Python 的 5 种场景</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">更好地利用 Python</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">towardsdatascience.com</p></div></div><div class="oq l"><div class="ph l os ot ou oq ov ks oh"/></div></div></a></div></div></div>    
</body>
</html>