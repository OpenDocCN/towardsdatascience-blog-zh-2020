<html>
<head>
<title>Time Series forecasting using Auto ARIMA in python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">python中自动ARIMA的时间序列预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-series-forecasting-using-auto-arima-in-python-bb83e49210cd?source=collection_archive---------0-----------------------#2020-06-26">https://towardsdatascience.com/time-series-forecasting-using-auto-arima-in-python-bb83e49210cd?source=collection_archive---------0-----------------------#2020-06-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2415" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">演示如何利用python中的自动ARIMA功能，使用“pmdarima”包预测未来</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d77284ae549317459463fb87c83d6483.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QKcLHePKOSLThuMkzE0keg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由Isaac Smith在Unsplash上拍摄</p></figure><p id="af95" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">时间序列分析是任何数据科学家的核心技能之一，在分析领域工作的任何人经常会遇到根据过去和现在的数据预测未来的情况。</em></p><p id="8cc6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">什么是时间序列？</strong></p><p id="f204" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它是在特定时间基本上以相等间隔进行的一系列观察。它用于根据过去的观察值预测未来值。在时间序列分析中，您可能会观察到趋势性、季节性、不规则性和周期性。</p><p id="6652" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这种数据集的情况下，每次只观察到一个变量被称为“单变量时间序列”，如果每次观察到两个或两个以上的变量被称为“多变量时间序列”。</p><p id="c19d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我们将重点关注使用python中的自动ARIMA功能来预测销售额的单变量时间序列，这与r中的自动ARIMA功能非常相似</p><p id="7380" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">为什么使用汽车ARIMA？</strong></p><p id="1a12" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通常，在基本的ARIMA模型中，我们需要提供必要的p、d和q值。我们使用统计技术，通过执行差分来消除非平稳性并绘制ACF和PACF图来生成这些值。在自动ARIMA中，模型本身将生成适合数据集的最佳p、d和q值，以提供更好的预测。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="42a4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们开始安装吧…</p><p id="7e15" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，这个包最初命名为“金字塔”，后来改为“pmdarima”。确保您正在安装“pmdarima”软件包。</p><p id="90dc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">👉<strong class="la iu">步骤1:安装“pmdarima”包</strong></p><p id="3e0d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以用下面的命令从你的Jupyter单元安装这个包。</p><p id="7b6c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">！pip安装pmdarima </strong></p><p id="3736" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了确保软件包构建正确，请使用下面的命令进行测试。</p><p id="9545" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">从pmdarima.arima导入auto_arima </strong></p><p id="4d9d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还要注意，这个包依赖于其他几个python包，要了解更多关于设置的信息，请参考这个[ <a class="ae mc" href="https://alkaline-ml.com/pmdarima/setup.html" rel="noopener ugc nofollow" target="_blank">链接</a></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="621d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们正在使用的数据集是从1964年到1972年的每月明智香槟销售。你可以在这里得到数据集<a class="ae mc" href="https://github.com/SushmithaPulagam/TimeSeries_Auto-ARIMA" rel="noopener ugc nofollow" target="_blank"/></p><p id="86e4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">👉<strong class="la iu">第二步:准备数据</strong></p><p id="b893" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">读取数据集后，确保没有空值，并将“Month”变量的数据类型更改为datetime对象。此外，使用set_index方法将dataframe的索引设置为该变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi md"><img src="../Images/ca866275d7c45c14919f8f53034ee9f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*2K__aW1LIYPmglWZiyUjTg.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi me"><img src="../Images/613fe0885c13695723e41152140af489.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/format:webp/1*lyKXTppy5jZkULtqFPC1SQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">销售数据的前几行</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="199f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">👉<strong class="la iu">第三步:理解模式</strong></p><p id="d800" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了理解数据的模式，我们可以简单地用。plot()方法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/a8d74f708f31b068c0566610171a3690.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*GplDXfQ6Vo07Z2IG53UXUQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">销售数据中的季节性模式</p></figure><p id="be79" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从上面我们可以观察到，数据存在季节性。从1964年到1972年，每年都有一个销售高峰。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="382d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">👉<strong class="la iu">步骤4:平稳性测试</strong></p><p id="8103" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">平稳性是时间序列中的一个重要概念，任何时间序列数据都应该在进行建模之前进行平稳性测试。</p><p id="76ce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们使用“扩展的Dickey-Fuller检验”来检查数据是否是平稳的，这在“pmdarima”包中是可用的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/f27340ce0ddca98ee23baa3f4b1f9612.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*omUYdHu1NVu9Z2QLpNnXJw.png"/></div></figure><p id="1bee" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从上面我们可以得出结论，数据是非平稳的。因此，我们需要使用“综合(I)”概念，在时间序列中用值“d”表示，以使数据在构建自动ARIMA模型时保持平稳。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="2ce3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">👉<strong class="la iu">第五步:训练和测试分割</strong></p><p id="c937" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">拆分为定型数据集和测试数据集，以在定型数据集上构建模型，并使用测试数据集进行预测。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/b2d439c1c18a41046deb06801ac940e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*v7Z7xZMG0okIJO0f5_zENg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">绘制训练和测试数据集</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="4d0d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">👉<strong class="la iu">第六步:建立汽车ARIMA模型</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/aa049bbeb749b97fda9dea81ea05a604.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*64ZOjhR_jsZ9D-E51MKvBQ.png"/></div></figure><p id="4c4c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">自回归(p) </em> - &gt;自回归项数。</p><p id="ef1a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">积分(d) </em> - &gt;平稳性所需的非季节性差异数。</p><p id="822f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">移动平均(q) </em> - &gt;预测方程中滞后预测误差的个数。</p><p id="0af4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在自动ARIMA模型中，注意小的P，D，Q值代表非季节性成分，大的P，D，Q代表季节性成分。它的工作类似于超调谐技术，以找到不同组合的p、d和q的最佳值，并且最终值将通过考虑较低的AIC、BIC参数来确定。</p><p id="1605" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里，我们尝试使用范围从0到5的p、d、q值来从模型中获得更好的最优值。该模型中还有许多其他参数，要了解更多功能，请访问此链接[ <a class="ae mc" href="https://alkaline-ml.com/pmdarima/modules/generated/pmdarima.arima.auto_arima.html" rel="noopener ugc nofollow" target="_blank">此处</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/4d7a21d3ea37839f38fe494947bffdb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*qiXnklgrbqJaGppxGkr-pg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自动ARIMA模型参数</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/e90f7eebf6c3b22b55373189833cf8af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FdO5orn8Y9YJTT_gOsP6yQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">自动ARIMA模型的追踪</p></figure><p id="06e1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是模型的总结。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/a4ea070fd75b02db4bed5b0df90b2b22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*0xoYGyxFR-gsQDk5CVJ2yQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ARIMA模式概述</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="8159" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">👉<strong class="la iu">第七步:测试数据预测</strong></p><p id="0759" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用在前面步骤中建立的训练模型根据测试数据预测销售。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/a58baa3f4dfa78709af69efdafb088e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*dSnV_pUoK22wPv3KD7pghw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">根据测试数据预测的销售额</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/643108ad8fb718bd91fb53f93d0a6800.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*6ueg6whmUwBiP9NaN1_TWg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">绘制培训对比测试对比预测销售</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/0fd4d155bf5f3e61815855d85d374279.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*8uNF_5Z4NWrZogDraOHZ6w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测试数据集的R2分数</p></figure><p id="1d1e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">总结</strong></p><p id="c7a4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我们学习了如何使用自动ARIMA模型的功能，如果您想从模型本身生成p、d和q值，这种方法将会很方便。在基本的ARIMA或萨里玛模型中，您需要进行差分并绘制ACF和PACF图来确定这些值，这非常耗时。</p><p id="35fe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，如果你是时间序列的新手，建议你使用统计技术并实现基本的ARIMA模型来理解p、d和q值背后的直觉。</p><p id="858f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以从我的GitHub [ <a class="ae mc" href="https://github.com/SushmithaPulagam/TimeSeries_Auto-ARIMA" rel="noopener ugc nofollow" target="_blank"> here </a> ]获得数据集和完整代码</p><p id="69c5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读，快乐学习！🙂</p></div></div>    
</body>
</html>