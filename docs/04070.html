<html>
<head>
<title>Animate your Graphs in Python in 4 Easy Steps!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过4个简单的步骤用Python制作动画！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/animate-your-graphs-in-python-in-4-easy-steps-243dccad9a7?source=collection_archive---------21-----------------------#2020-04-14">https://towardsdatascience.com/animate-your-graphs-in-python-in-4-easy-steps-243dccad9a7?source=collection_archive---------21-----------------------#2020-04-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9ab2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><strong class="ak">利用新冠肺炎数据实现数据可视化的创意</strong></h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0056fe1257795e47f1732c2783191d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*aEURujuiHD7HMFyeAhnZzQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们开始吧！资料来源:Nik Piepenbreier</p></figure><p id="edbd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在之前的一篇文章中，我们探索了如何用几行代码制作漂亮的Matplotlib图。你可以通过<a class="ae lu" rel="noopener" target="_blank" href="/visualizing-covid-19-data-beautifully-in-python-in-5-minutes-or-less-affc361b2c6a">访问这个链接</a>来查看这个帖子，作为如何将这些图表放在一起的快速复习。</p><p id="632d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将研究COVID数据，并绘制出自2020年3月1日以来每100，000人的比率。我们筛选出截至2020年4月10日受影响最大的五个州(按每100，000人的比率)，以及华盛顿和加利福尼亚州，因为它们的早期病例数。</p><p id="b2db" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看我们在组装什么！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/60580531da16629727adddb2631bf2d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*4HdW_TWlyXK41wMiOD9dKg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的最终产品。资料来源:Nik Piepenbreier</p></figure><h1 id="4a25" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak">第一步:让我们载入数据</strong></h1><p id="fca5" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">我们将开始分析，加载我们分析所需的库，并生成一些数据帧来存储我们的数据:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的第一行代码:导入库和数据！资料来源:Nik Piepenbreier</p></figure><p id="55d7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们更详细地分解我们的代码:</p><p id="448c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第1节中，我们导入了几个库。我们使用<strong class="la iu"> Pandas </strong>来保存数据帧中的数据以及生成基本的绘图。我们使用matplotlib 来生成实际的图形。我们使用<strong class="la iu"> glob </strong>获取文件名，然后创建GIF。最后，我们使用<strong class="la iu"> moviepy </strong>来生成GIF。</p><p id="79d4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果没有安装这些库，可以使用pip来安装。默认情况下会安装Matplotlib，因此我们不将它包含在下面的列表中:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="0873" class="na lx it mw b gy nb nc l nd ne">pip install pandas<br/>pip install glob<br/>pip install moviepy</span></pre><p id="c25b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第2节的<strong class="la iu">中，我们生成两个数据帧。我们从纽约时报GitHub获取数据，这个GitHub按州收集新冠肺炎病例的数据到一个名为df的数据框架中。我们还从人口普查网站获取各州的人口数据。</strong></p><p id="d7eb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，在<strong class="la iu">第3节</strong>中，我们将人口数据框架中的数据合并到主数据框架df中。如果你想了解更多这方面的知识，<a class="ae lu" href="https://datagy.io/vlookup-in-python-and-pandas-using-map-or-merge/" rel="noopener ugc nofollow" target="_blank">看看这个教程</a>。</p><p id="da22" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还通过将病例数除以该州人口并乘以100，000，得出每100，000人中的新冠肺炎病例率。这被分配给一个叫做rate的变量。这类似于我们的另一篇关于用Matplotlib漂亮地可视化新冠肺炎数据的文章:</p><div class="nf ng gp gr nh ni"><a rel="noopener follow" target="_blank" href="/visualizing-covid-19-data-beautifully-in-python-in-5-minutes-or-less-affc361b2c6a"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd iu gy z fp nn fr fs no fu fw is bi translated">用Python漂亮地可视化新冠肺炎数据(不到5分钟！！)</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">让Matplotlib不那么痛苦！</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">towardsdatascience.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw ks ni"/></div></div></a></div><h1 id="33b3" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak">第二步:准备我们的数据</strong></h1><p id="5e78" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">我们的数据现在包括所有州的数据。这将产生一个非常混乱的视觉效果。因此，我们希望将我们的分析限制在更小、更易管理的状态数量上。我们将在2020年4月10日选出人均收入最高的州。我们还将把华盛顿和加利福尼亚包括进来，因为他们有早期的高病例数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">为制图准备数据。资料来源:Nik Piepenbreier</p></figure><p id="308f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<strong class="la iu">第4节</strong>中，我们生成了一个我们感兴趣的州列表。我们创建一个只包含昨天数据的新数据帧。然后，我们生成了当天人均收入最高的州的列表(按降序排列，只选择前五名)。最后，我们追加华盛顿和加利福尼亚。</p><p id="0707" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，在<strong class="la iu">第5节</strong>中，我们将我们的原始数据帧df限制为仅包括所标识的州。我们将数据范围限制为仅包括2020年3月1日以后的数据(因为在此日期之前病例报告率极低/偏低)。最后，我们透视数据集，使其可以绘制成图表。</p><p id="19f7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第6节的<strong class="la iu">中，我们重置了多索引数据帧的索引，以允许绘图。我们重置了索引并删除了日期列。这似乎有点争议，但我发现将数据显示为“# of days from March 1，2020”更容易理解，特别是考虑到我们希望在数据中包含的运动。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/4752ff16d5d4cdb21ce92073219410f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_-QyQT1duTjD2qVdevlQjA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的四个简单步骤！资料来源:Nik Piepenbreier</p></figure><h1 id="d7ec" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak">第三步:绘制数据图表</strong></h1><p id="66f4" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">我们现在已经准备好了绘制图表的数据。下面的代码迭代创建许多png图像，我们将把这些图像拼接在一起，创建我们的GIF:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">绘制我们的数据。资料来源:Nik Piepenbreier</p></figure><p id="72e5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第7节中，我们完成了几件事:</p><ul class=""><li id="217f" class="ny nz it la b lb lc le lf lh oa ll ob lp oc lt od oe of og bi translated">我们将样式设置为匹配538主题，</li><li id="c230" class="ny nz it la b lb oh le oi lh oj ll ok lp ol lt od oe of og bi translated">我们测量数据帧的长度，并将其赋给一个名为length的变量。我们给这个值加10。这使得默认情况下输出文件名更容易排序(而不是从1开始)。</li><li id="3dd5" class="ny nz it la b lb oh le oi lh oj ll ok lp ol lt od oe of og bi translated">我们使用for循环为每个日期生成单独的可视化效果。如果你想学习更多关于for-loops的知识，<a class="ae lu" href="https://datagy.io/python-for-loop/" rel="noopener ugc nofollow" target="_blank">看看这个指南</a>，它会教你你需要知道的一切。</li><li id="564c" class="ny nz it la b lb oh le oi lh oj ll ok lp ol lt od oe of og bi translated">如果您一直在跟进，请确保更改最后一行，以反映存储图形的文件夹的路径。要使GIF正常工作，请将其创建为不包含任何其他内容的新文件夹。</li></ul><h1 id="930f" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak">步骤4:创建我们的可视化动画</strong></h1><p id="fd6f" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">现在我们到了激动人心的时刻！您现在已经创建了一个装满png的文件夹，我们正准备将它们转换成GIF。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">生成我们的GIF。资料来源:Nik Piepenbreier</p></figure><p id="9c65" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在第8节中，我们主要做两件事:</p><ul class=""><li id="e612" class="ny nz it la b lb lc le lf lh oa ll ob lp oc lt od oe of og bi translated">我们使用glob生成所有png的列表。为此，在代码的第4行，更新PNG文件夹的路径，确保在代码中保留/*。这将从该文件夹中取出所有文件。</li><li id="ffa9" class="ny nz it la b lb oh le oi lh oj ll ok lp ol lt od oe of og bi translated">我们使用moviepy来生成GIF。GIF将以每秒6帧的速度运行，并将存储在您的用户目录中。如果找不到它，请在计算机上搜索COVID.gif。</li></ul><h1 id="a96a" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">庆祝我们的最终产品！</h1><p id="fe38" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">让我们检查一下我们的最终作品，然后花点时间整理一下自己。在很短的时间内，我们创造了一个美丽的动画，非常容易地展示了新冠肺炎的怪异和令人羞愧的传播。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/60580531da16629727adddb2631bf2d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*4HdW_TWlyXK41wMiOD9dKg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让我们庆祝一下！资料来源:Nik Piepenbreier</p></figure><h1 id="3c3a" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated"><strong class="ak">结论:用Python创建动画数据可视化</strong></h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/dd52dced72f026b253d2579d6222d4a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B7Aimiw8bzh0H_l3Abu8hA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">感谢您抽出时间！资料来源:Nik Piepenbreier</p></figure><p id="ef73" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">非常感谢你阅读这篇文章！在这篇文章中，我们学习了如何将数据帧合并在一起，用for循环创建多个可视化效果，并将这些可视化效果转换成GIF。</p><p id="289b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我希望你能学到一些新东西，找到一些创造性的方法来展示你的数据！</p></div></div>    
</body>
</html>