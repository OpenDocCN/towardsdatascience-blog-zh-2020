<html>
<head>
<title>Step by Step Implementation: 3D Convolutional Neural Network in Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一步一步实现:Keras 中的 3D 卷积神经网络</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/step-by-step-implementation-3d-convolutional-neural-network-in-keras-12efbdd7b130?source=collection_archive---------1-----------------------#2020-03-28">https://towardsdatascience.com/step-by-step-implementation-3d-convolutional-neural-network-in-keras-12efbdd7b130?source=collection_archive---------1-----------------------#2020-03-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="5a64" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">深度学习</h2><div class=""/><blockquote class="jz ka kb"><p id="a73c" class="kc kd ke kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la im bi translated">了解如何实现您自己的 3D CNN</p></blockquote><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/b4916130821a713103595ccb36e94a79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X-gAWdhgvxgg8iQX6dZcuA.jpeg"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated"><a class="ae lr" href="https://www.pexels.com/photo/mirror-lake-reflecting-wooden-house-in-middle-of-lake-overlooking-mountain-ranges-147411/" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="4402" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">在本文中，我们将简要解释什么是 3d CNN，以及它与普通的 2d CNN 有何不同。然后我们会一步步教你如何用 Keras 实现自己的 3D 卷积神经网络。</p><p id="8146" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">本文将围绕这四个<strong class="kf jd">部分</strong>展开:</p><ul class=""><li id="78bf" class="lv lw it kf b kg kh kk kl ls lx lt ly lu lz la ma mb mc md bi translated"><strong class="kf jd"> 1】什么是 3D 卷积神经网络？</strong></li><li id="d65c" class="lv lw it kf b kg me kk mf ls mg lt mh lu mi la ma mb mc md bi translated"><strong class="kf jd">2】3d 数据是什么样的？(如 MNIST) </strong></li><li id="55bc" class="lv lw it kf b kg me kk mf ls mg lt mh lu mi la ma mb mc md bi translated"><strong class="kf jd"> 3】现在如何实施？！</strong></li><li id="4e65" class="lv lw it kf b kg me kk mf ls mg lt mh lu mi la ma mb mc md bi translated"><strong class="kf jd"> 4】但是然后一个 3d？为什么</strong></li></ul><h2 id="6d37" class="mj mk it bd ml mm mn dn mo mp mq dp mr ls ms mt mu lt mv mw mx lu my mz na iz bi translated">1]什么是 3D 卷积神经网络？</h2><p id="63f0" class="pw-post-body-paragraph kc kd it kf b kg nb ki kj kk nc km kn ls nd kq kr lt ne ku kv lu nf ky kz la im bi translated">不管我们怎么说，3d CNN 仍然是一个与 2d CNN 非常相似的 CNN。不同之处在于以下几点(非穷尽列举):</p><p id="eccd" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated"><strong class="kf jd"> 3d 卷积层</strong></p><p id="dca9" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">最初，2d 卷积层是输入和不同滤波器之间的逐条目乘法，其中滤波器和输入是 2d 矩阵。(图 1)</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ng"><img src="../Images/4e15f258551eea4677a2b2d8542b996c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yiMhH-Ra5_mNriWMReGvsw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图 1(版权所有:自有)</p></figure><p id="3398" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">在 3d 卷积层中，使用相同的操作。我们在多对 2d 矩阵上进行这些操作。(图 2)</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nh"><img src="../Images/0de9a642788458eee0d4bc691636f227.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I48IS2kGp9RrNK_Hi8mdQQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图 2(版权所有:自有)</p></figure><p id="4e1f" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">填充选项和幻灯片步长选项的工作方式相同。</p><h2 id="7578" class="mj mk it bd ml mm mn dn mo mp mq dp mr ls ms mt mu lt mv mw mx lu my mz na iz bi translated">3d 最大池图层</h2><p id="696b" class="pw-post-body-paragraph kc kd it kf b kg nb ki kj kk nc km kn ls nd kq kr lt ne ku kv lu nf ky kz la im bi translated">2d Maxpool Layers (2x2 filter)是从输入中提取一个 2x2 小正方形的最大元素。(图 3)</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/c76cc32a685e615954021e798a776f42.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*K_CWRvcFglYo-3WTnRNBgw.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图 3(版权所有:自有)</p></figure><p id="6d90" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">现在，在 3d Maxpool (2x2x2 内核)中，我们寻找宽度为 2 的立方体中的最大元素。此立方体代表由输入的 2x2x2 区域界定的空间。(图 4)</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/a35b7b724bde2b7174d901dcb894a5c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*6Uxva8pbIxWPngm4ljJh6w.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图 4(版权所有:自有)</p></figure><p id="68d0" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">请注意，操作的数量(与 2d CNN 层相比)乘以所使用的过滤器的大小(不管该层是最大池还是卷积层)，还乘以输入本身的大小。</p><h2 id="ebf6" class="mj mk it bd ml mm mn dn mo mp mq dp mr ls ms mt mu lt mv mw mx lu my mz na iz bi translated">2]<strong class="ak">3d 数据是什么样子的？</strong></h2><p id="8170" class="pw-post-body-paragraph kc kd it kf b kg nb ki kj kk nc km kn ls nd kq kr lt ne ku kv lu nf ky kz la im bi translated">那么 3d CNN 的数据点是什么样的呢？</p><p id="0c6f" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">描绘它的一种方法是使用下面的图像(图 5):</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/42a4a98e904596227506b1474512b867.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*kIRrM1oE79V7osiU_KmLUg.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图 5(版权所有:自有)</p></figure><p id="6f83" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">其他可用于 CNN 的现有数据集有:</p><ul class=""><li id="7711" class="lv lw it kf b kg kh kk kl ls lx lt ly lu lz la ma mb mc md bi translated">RGB-D 设备:<a class="ae lr" href="http://get.google.com/tango/" rel="noopener ugc nofollow" target="_blank">谷歌 Tango </a>、<a class="ae lr" href="https://developer.microsoft.com/en-us/windows/kinect" rel="noopener ugc nofollow" target="_blank">微软 Kinect </a>等。</li><li id="9081" class="lv lw it kf b kg me kk mf ls mg lt mh lu mi la ma mb mc md bi translated"><a class="ae lr" href="https://en.wikipedia.org/wiki/Lidar" rel="noopener ugc nofollow" target="_blank">激光雷达</a></li><li id="3069" class="lv lw it kf b kg me kk mf ls mg lt mh lu mi la ma mb mc md bi translated"><a class="ae lr" href="https://en.wikipedia.org/wiki/3D_reconstruction_from_multiple_images" rel="noopener ugc nofollow" target="_blank">多幅图像的三维重建</a></li></ul><h2 id="cfcf" class="mj mk it bd ml mm mn dn mo mp mq dp mr ls ms mt mu lt mv mw mx lu my mz na iz bi translated">3] <strong class="ak">现在如何实现？！(</strong>预处理和实现)</h2><p id="a07d" class="pw-post-body-paragraph kc kd it kf b kg nb ki kj kk nc km kn ls nd kq kr lt ne ku kv lu nf ky kz la im bi translated">你可以自己试试我们正在使用的来自<a class="ae lr" href="https://www.kaggle.com/daavoo/3d-mnist" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>的数据集上的代码。</p><p id="7929" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">需要导入的库如下:</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="f0bd" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">首先，由于数据集有点特殊，我们使用下面的 to helper 函数在将它们提供给网络之前对它们进行处理。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="17af" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">另外，数据集存储为 h5 文件，因此要提取实际的数据点，我们需要从 h5 文件中读取数据，并使用 to _ categorical 函数将其转换为向量。在这一步中，我们还要准备交叉验证。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="5c1d" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">最后，3d CNN 的模型和语法如下:(架构是在没有太多改进的情况下挑选的，因为这不是本文的重点)</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nl nm l"/></div></figure><p id="3b49" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">请注意，与 2d CNN 相比，对于相同数量的层，参数的数量要高得多。</p><p id="2649" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">供您参考，经过小样本训练，我们得到了以下准确度和损耗。(图 6)</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nn"><img src="../Images/1dd8071f516772b84c7f1ebd5c647c7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*frCXTdPjG0imsIdRXtmCNQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图 6(版权所有:自有)</p></figure><h2 id="c283" class="mj mk it bd ml mm mn dn mo mp mq dp mr ls ms mt mu lt mv mw mx lu my mz na iz bi translated">4]但是然后一个 3d？为什么</h2><p id="f21a" class="pw-post-body-paragraph kc kd it kf b kg nb ki kj kk nc km kn ls nd kq kr lt ne ku kv lu nf ky kz la im bi translated">3d CNN 碰巧有许多应用，例如:</p><ul class=""><li id="cdf7" class="lv lw it kf b kg kh kk kl ls lx lt ly lu lz la ma mb mc md bi translated">IRM 的数据处理和由此得出的推论</li><li id="501c" class="lv lw it kf b kg me kk mf ls mg lt mh lu mi la ma mb mc md bi translated">自驾</li><li id="50b6" class="lv lw it kf b kg me kk mf ls mg lt mh lu mi la ma mb mc md bi translated">距离估计</li></ul><p id="9f26" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">好了，差不多就这些了。我希望你尝试一下这项技术！源代码结束<a class="ae lr" href="https://github.com/miki998/3D_CNN" rel="noopener ugc nofollow" target="_blank">这里</a>！</p></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><p id="77f6" class="pw-post-body-paragraph kc kd it kf b kg kh ki kj kk kl km kn ls kp kq kr lt kt ku kv lu kx ky kz la im bi translated">感谢您的阅读，如果您喜欢，请关注我、我的<a class="ae lr" href="http://aitechfordummies.com" rel="noopener ugc nofollow" target="_blank">网站</a>和我的<a class="ae lr" href="https://www.facebook.com/aitechfordummies/" rel="noopener ugc nofollow" target="_blank">脸书</a>页面！</p><div class="nv nw gp gr nx ny"><a rel="noopener follow" target="_blank" href="/classical-neural-network-what-really-are-nodes-and-layers-ec51c6122e09"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd jd gy z fp od fr fs oe fu fw jc bi translated">经典神经网络:什么是真正的节点和层？</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">一个节点和一个层在数学上代表什么？简单易懂的幕后概念介绍。</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om ll ny"/></div></div></a></div><div class="nv nw gp gr nx ny"><a rel="noopener follow" target="_blank" href="/convolutional-neural-networks-why-are-they-so-good-for-image-related-learning-2b202a25d757"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd jd gy z fp od fr fs oe fu fw jc bi translated">卷积神经网络:为什么它们对图像相关学习如此有效？</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">快速解释为什么 CNN 现在几乎总是用于计算机视觉任务。</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">towardsdatascience.com</p></div></div><div class="oh l"><div class="on l oj ok ol oh om ll ny"/></div></div></a></div></div></div>    
</body>
</html>