# Corr2Vec:金融市场特征工程的 WaveNet 架构

> 原文：<https://towardsdatascience.com/corr2vec-a-wavenet-architecture-for-feature-engineering-in-financial-market-94b4f8279ba6?source=collection_archive---------22----------------------->

## 学习时间序列的有价值的嵌入表示

![](img/d58894ea37b1e5aaaeb4b30e5948ad61.png)

詹娜 S 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

在一个平行宇宙中，我们的愿望是只使用隐藏在过去的模式来进行投资组合管理，以预测未来的价格变化。如今，在金融市场中采用这些技术是毫无用处的。原因很简单:市场是由随机模式驱动的，这使得我们的许多预测试验都消失了。

我们能做的最好的是结合多样化的数据来源，比较股票行为，并确定相关性和群体。

在这篇文章中，我们试图为股票市场特征编码建立一个架构。它接收股票价格的时间序列，加上其他外部数据源，并返回它们的学习数字表示。获得的嵌入可以在以后用于我们感兴趣的各种任务，比如预测、聚类、图形可视化等等。使用相关指数作为我们的神经网络结构的鉴别项来计算学习过程。为此，命名为 Corr2Vec。

# 数据

财务数据很容易从各种来源获得。对于我们的任务，一个收集了各种股票价格的完整数据集就足够了。满足这些需求的数据集可以在 Kaggle 上找到。[股票数据 2000–2018](https://www.kaggle.com/danieljperez/financial-data-20002018)是 2000 年至 2018 年约 39 只不同股票的股票价格的清理集合。更准确地说，是每天报告的成交量、开盘价、最高价、最低价和收盘价。

![](img/b173ff927499b8dd95cb7c0784a5fba5.png)

# 模型

我们架构的训练过程遵循一种监督的方法。我们需要标签，但这些标签可以通过我们的数据结构轻松自由地检索。这是因为我们将系列之间的相关系数设置为标签。皮尔逊相关系数是统计学和机器学习中的一个众所周知的指数。**在时间序列分析的背景下，它告诉我们两个序列是如何一起移动的，但没有说任何因果关系**。在哲学术语中，它可以被解释为仅考虑趋势行为的时间序列的相似性度量。

我们的网络学习的是来自多个数据源的 3D 序列的扁平嵌入表示。这些嵌入是在一个网络中获得的，该网络试图再现期望股票收盘价之间的相关指数。建立网络是为了学习在给定时期负责提供相关性测量的显著特征。我们期望我们的网络可以为相同股票的序列块产生相似的表示，显示相似的相关度。当评估不同的股票时，期望相等。

对于熟悉 Word2Vec 的人来说，我们手工制作的 Corr2Vec 类似地学习了一个内部隐藏表示。Word2Vec 使用 skip-gram 方法构建和训练嵌入，以区分单词是否为“ *close* ”。我们使用相关指数来区分我们的时间序列块是否是“*相似的*”。相关性指数一次比较两个数据源(在我们的例子中是时间序列)。这就要求以智能的方式组织培训过程，以捕捉多种关系。实际上，这是通过多个独立输出来实现的。我们的结构的另一个附加价值是连接不同数据源的能力。

整个架构的引擎由类似 WaveNet 的架构组成。这种结构近年来在时序任务中取得了巨大的成功。如果你第一次遇到它，它可能看起来很复杂但不要担心，它比你想象的简单。这是一个完全的卷积神经网络，其中卷积层具有各种膨胀因子，这些膨胀因子通过残差块得到加强，并通过跳跃连接进行合并。这些最新的实现技巧允许 WaveNet 感受野随深度呈指数增长，并覆盖数千个时间戳。

![](img/321c12ac8431e0723f9c3bd6772a04e8.png)

我们的网络可以训练各种股票。对于所考虑的每只股票，我们都有一组输入序列和各种相关特征(包括收盘价)。输出是不同股票(同一时期)序列对之间收盘价的相关系数。换句话说，输出的数量等于可能的相关对，就像相关矩阵的上部一样。在网络内部，相同的波网结构处理来自每个输入的序列。通过全局平均池操作为每只股票构建一维表示。最后，在先前的表示上使用一系列点积来近似相关系数。

在我们的实验中，我们使用三种不同的股票。我们选择 AAPL、阿姆津和 MSFT。我们在数据集的第一部分训练我们的网络，并留下第二部分来直观地检查结果。WaveNet 编码器被提取并用于从 3D 特征序列中获得 1D 嵌入。然后，三个结果嵌入(每个股票一个)被水平连接起来，准备使用。在它们上面，我们应用 TSNE 来减少尺寸和视觉检查结果。同样在这个阶段，我们保持训练数据和看不见的数据之间的分离。

![](img/9d7f8af4fe5c11c4e4c8f065b5405ea9.png)

嵌入在看不见的数据上的时间函数的 2D 表示(颜色)

在上图中，每个点代表投影在 2D 空间中的嵌入要素序列。颜色用于表示时间维度，以检查空间中靠近的*序列是否也在时间上接近。*

进一步的检查包括绘制我们的点，考虑相关指数。下面我们报告相同的嵌入表示，但是随着可能的股票对的相关程度改变颜色。在一些领域，我们的股票往往同时高度相关，而在其他地方，它们交替相关的幅度。

![](img/1b271aab3875d666d3b154a470077174.png)

在相关指数(颜色)函数中嵌入看不见的数据的 2D 表示

我们将自己限制在视觉上检查我们的嵌入，但是它们的灵活性使它们能够在不同的任务中被采用。我们可以想象在集群和预测场景或者更复杂的项目组合管理活动中应用它们。

# 摘要

在这篇文章中，我们介绍了在金融市场中嵌入创建时间序列的定制过程。这些表示是使用相关指数作为区别项来学习的。训练过程使用 WaveNet 结构来捕获隐藏模式并组合不同的数据源。图形结果显示了在学习的嵌入中可能存在隐藏的层次，这在其他应用中可能是有用的。

**如果你对题目感兴趣，我建议:**

*   [**Word2Vec 带时间序列:一种迁移学习方法**](/word2vec-with-time-series-a-transfer-learning-approach-58017e7a019d)
*   [**Time2Vec 为时间序列特征编码**](/time2vec-for-time-series-features-encoding-a03a4f3f937e)

[**查看我的 GITHUB 回购**](https://github.com/cerlymarco/MEDIUM_NoteBook)

保持联系: [Linkedin](https://www.linkedin.com/in/marco-cerliani-b0bba714b/)