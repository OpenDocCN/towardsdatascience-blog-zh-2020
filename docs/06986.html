<html>
<head>
<title>Web Scraping using Selenium and YOLO to build Computer Vision datasets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Selenium和YOLO构建计算机视觉数据集的Web抓取</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/web-scraping-using-selenium-and-yolo-to-build-computer-vision-datasets-73a23d1909d2?source=collection_archive---------48-----------------------#2020-05-29">https://towardsdatascience.com/web-scraping-using-selenium-and-yolo-to-build-computer-vision-datasets-73a23d1909d2?source=collection_archive---------48-----------------------#2020-05-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1d51" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">此工作流简化了构建数据集的繁重工作</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/37ddb2958b8c02219394764decdf4d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2fDoJ4yA5kc4TKL5"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">尼古拉斯·皮卡德在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="e6cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi ls translated"><span class="l lt lu lv bm lw lx ly lz ma di">如果</span>我们向几位专家询问计算机视觉项目的关键(特别是如果我们想要一个真正的应用程序)，也许最重复的元素(在我看来也是最重要的)就是数据集。当我们问及最艰巨、最费力的任务时，问题就出现了，答案通常也是一样的:数据集。</p><p id="cc9c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">组成数据集的任务可以概括为三个步骤:</p><ol class=""><li id="a3b5" class="mb mc iq ky b kz la lc ld lf md lj me ln mf lr mg mh mi mj bi translated"><strong class="ky ir">捕捉图像</strong>。</li><li id="46c3" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated"><strong class="ky ir">注释图像</strong>:为一组类别标记样本。</li><li id="b095" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated"><strong class="ky ir">验证</strong>:检查标签是否正确。</li></ol><p id="6ec4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们要做的第一件事是求助于可以用于我们任务的最先进的数据集，但问题是我们并不总是能找到我们需要的东西。此时此刻，我们面临着一项艰巨而痛苦的任务。本文展示了如何避免这种手工操作。</p><p id="aed2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用<strong class="ky ir"> Selenium </strong> [1】(一个开源的基于web的自动化工具)<strong class="ky ir"> Instagram </strong>(间接世界上最大的图像数据库之一)和<strong class="ky ir"> YOLO </strong> [2】(物体检测中最常用的深度学习算法之一)，我们可以自动生成数据集(唯一无法避免的是验证步骤)。为了展示一个简单的例子，我们将生成两个类的简单数据集:cat和dog。</p><p id="52f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将设计一个带有Selenium的<strong class="ky ir"> </strong>机器人，它将自动访问Instagram并在其中移动。此外，我们将使用YOLO，一个卷积神经网络来检测和排序我们需要的狗和猫。</p><h1 id="ebbe" class="mp mq iq bd mr ms mt mu mv mw mx my mz jw na jx nb jz nc ka nd kc ne kd nf ng bi translated">环境设置</h1><p id="48c4" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">我们将要使用的编程语言是Python 3.6，它允许我们轻松地使用Selenium和YOLO。</p><p id="b130" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将需要以下外部依赖:</p><ul class=""><li id="3157" class="mb mc iq ky b kz la lc ld lf md lj me ln mf lr nm mh mi mj bi translated"><a class="ae kv" href="https://gluon-cv.mxnet.io/" rel="noopener ugc nofollow" target="_blank"> <em class="nn"> GluonCV </em> </a>:提供计算机视觉中最先进深度学习算法实现的框架。这个工具包为我们提供了大量预先训练好的模型。我们将使用其中的一个[3]。</li><li id="0c77" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr nm mh mi mj bi translated"><a class="ae kv" href="https://python-pillow.org/" rel="noopener ugc nofollow" target="_blank"> <em class="nn">枕</em> </a> : Python影像库。</li><li id="158d" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr nm mh mi mj bi translated"><a class="ae kv" href="https://www.selenium.dev/documentation/en/" rel="noopener ugc nofollow" target="_blank"> <em class="nn">【硒】</em> </a>:它是一个伞式项目，包含一系列工具和库，支持web浏览器的自动化。我们将使用该库提供的Python模块。</li><li id="eb3d" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr nm mh mi mj bi translated"><a class="ae kv" href="https://requests.readthedocs.io/en/master/" rel="noopener ugc nofollow" target="_blank"> <em class="nn">请求</em> </a>:是一个优雅简单的Python HTTP库。我们将用它来下载图像。</li></ul><p id="f27d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用以下命令安装这些依赖项:</p><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="aa59" class="nt mq iq np b gy nu nv l nw nx">pip install mxnet gluoncv Pillow selenium beautifulsoup4 requests</span></pre><p id="fc2f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">另外，你还需要<a class="ae kv" href="https://chromedriver.chromium.org/home" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> ChromeDriver </strong> </a>。这提供了从Selenium导航到web页面的能力。你要把它复制到<code class="fe ny nz oa np b">usr/local/bin</code>，瞧！您现在可以从Selenium控制您的Chrome浏览器了！</p><h1 id="131e" class="mp mq iq bd mr ms mt mu mv mw mx my mz jw na jx nb jz nc ka nd kc ne kd nf ng bi translated">物体检测模块</h1><p id="abd1" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">正如我们已经提到的，我们将使用<a class="ae kv" href="https://pjreddie.com/media/files/papers/YOLOv3.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="nn"> YoloV3 </em> </a>作为检测模块(顺便说一下，<a class="ae kv" href="https://arxiv.org/pdf/2004.10934.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="nn"> YoloV4 </em> </a>从一个月前就有了)。通过这种方式，我们将尝试寻找和区分猫和狗。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">使用GluonCV和MXNet的YoloV3模块</p></figure><p id="6359" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">概括地说，YOLO(你只看一次)基本上是一个单一的CNN，它提供了多个预测(边界框),每个类别都有一个相关的概率。此外，NMS(非最大抑制)用于将多个检测合并为一个检测。我们面对的是一个实时工作的快速神经网络。</p><div class="kg kh ki kj gt ab cb"><figure class="od kk oe of og oh oi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/04b35d6132b377349c22cdc39a50b289.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*xg4e0_c-JRw26l0QcZhQ0g.png"/></div></figure><figure class="od kk oj of og oh oi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/83a5c6f3ef94eaf51323d9d95ce24a94.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*snU_A3bGvjsyBJW0Pqqg5w.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk ok di ol om translated">使用YoloV3模块检测狗和猫。狗:由<a class="ae kv" href="https://unsplash.com/@joeyc" rel="noopener ugc nofollow" target="_blank">乔·凯恩</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的基础图像。猫:基础图片由<a class="ae kv" href="https://unsplash.com/@nrly" rel="noopener ugc nofollow" target="_blank">内森·赖利</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上制作</p></figure></div><h1 id="f6db" class="mp mq iq bd mr ms mt mu mv mw mx my mz jw na jx nb jz nc ka nd kc ne kd nf ng bi translated">硒机器人模块</h1><p id="10df" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">我们将使用Selenium对机器人进行编程，使其登录并通过Instagram，使用检测模块自动下载图像。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="1e17" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如您在<code class="fe ny nz oa np b">__call__()</code>方法中看到的，我们可以将代码分为4个主要步骤:</p><ol class=""><li id="45c5" class="mb mc iq ky b kz la lc ld lf md lj me ln mf lr mg mh mi mj bi translated"><strong class="ky ir">打开</strong> <strong class="ky ir"> Instagram </strong>主页。</li><li id="7714" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated"><strong class="ky ir">用你的用户名和密码登录Instagram】。</strong></li><li id="7ac6" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">放上你的标签来限制搜索，这里是<strong class="ky ir">#宠物</strong>，因为在这个例子中我们想要狗和猫。</li><li id="e1ec" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">还有最重要的一步，<strong class="ky ir">滚动和下载</strong>图片。</li></ol><p id="75c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在最后一步中，我们滚动并解析HTML以获得下载图像并使用Pillow对其进行合成所需的URL。此时，我们检查图像是否包含一只狗、一只猫，或者什么都不包含，然后将它保存到每个类对应的文件夹中，或者丢弃该图像。</p><p id="7338" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，您只需要担心验证样本。尽情享受吧！😉</p><p id="966d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想轻松地启动这个代码，您可以在这个存储库中找到它。您只需按照自述文件中指示的步骤进行操作。</p><div class="on oo gp gr op oq"><a href="https://github.com/bsouto/selenium-bot" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd ir gy z fp ov fr fs ow fu fw ip bi translated">bsouto/selenium-bot</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">使用Selenium和Yolo V3从Instagram构建计算机视觉数据集的Web抓取。- bsouto/selenium-bot</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">github.com</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe kp oq"/></div></div></a></div><p id="7086" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在下面的GIF中，你可以看到数据集是如何自动生成的:机器人用用户名和密码访问Instagram，输入#PETS标签，滚动，同时只下载狗(底部文件夹)和猫(顶部文件夹)的图像。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/6bb0e8ae18befc6623704b7e1441c7d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*uINUAmcV6xb4qXvG4q7RQA.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">操作程序</p></figure><p id="0e73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">强调这是一个简单的例子，当然还有很多关于狗和猫的公开数据集。我们可以将我们想要的复杂性添加到我们的生成器中，这是一个概念验证，可能我们的任务不是那么简单，我们需要的数据也不是那么基本。</p><p id="c172" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！</p></div><div class="ab cl pg ph hu pi" role="separator"><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl"/></div><div class="ij ik il im in"><h2 id="41c8" class="nt mq iq bd mr pn po dn mv pp pq dp mz lf pr ps nb lj pt pu nd ln pv pw nf px bi translated">参考</h2><p id="f7c6" class="pw-post-body-paragraph kw kx iq ky b kz nh jr lb lc ni ju le lf nj lh li lj nk ll lm ln nl lp lq lr ij bi translated">[1]<a class="ae kv" href="https://selenium-python.readthedocs.io/" rel="noopener ugc nofollow" target="_blank">https://selenium-python.readthedocs.io/</a></p><p id="d017" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://pjreddie.com/darknet/yolo/" rel="noopener ugc nofollow" target="_blank">https://pjreddie.com/darknet/yolo/</a></p><p id="66ef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[3]<a class="ae kv" href="https://gluon-cv.mxnet.io/build/examples_detection/demo_yolo.html" rel="noopener ugc nofollow" target="_blank">https://gluon-cv . mxnet . io/build/examples _ detection/demo _ yolo . html</a></p></div></div>    
</body>
</html>