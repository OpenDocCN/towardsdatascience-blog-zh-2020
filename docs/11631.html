<html>
<head>
<title>The Ultimate Out-of-the-box Automated Python Model Selection Methods</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">终极开箱即用的自动化 Python 模型选择方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-ultimate-out-of-the-box-automated-python-model-selection-methods-f2188472d2a?source=collection_archive---------25-----------------------#2020-08-12">https://towardsdatascience.com/the-ultimate-out-of-the-box-automated-python-model-selection-methods-f2188472d2a?source=collection_archive---------25-----------------------#2020-08-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="adbd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">或者说如何在不过度拟合的情况下得到最佳的机器学习模型？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/210962db48e618c51ca6da5b4d4d8da5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZGg8fd9EvXLYPDOWWQx1ew.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@franckinjapan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Franck V. </a>拍摄的照片</p></figure><p id="87d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在任何数据科学项目中，选择最佳模型是特征选择之后的关键步骤。该过程包括使用最佳算法(监督的、非监督的)来获得最佳预测。高维数据集自动模型选择方法一般包括<strong class="lb iu">天秤座</strong>和<strong class="lb iu"> Pycaret </strong>。一个 unicorn 数据科学家需要掌握最先进的自动化模型选择方法。在本文中，我们将回顾两个最佳 Kaggle 获奖者的自动化模型选择方法，它们可以用简短的 python 代码实现。</p><p id="081d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将分析巧克力棒评级数据集样本，您可以在这里找到<a class="ae ky" href="https://www.kaggle.com/soroushghaderi/chocolate-bar-2020" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/50eef88d0d7457fb0bf5cb5f78c0bae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bmH6QQAuwsiZgn2_bl4wyA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@curryandlove?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Klara Avsenik </a>在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="30d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个具有挑战性的数据集，在特征选择后包含 3400 个特征中的 20 个，与目标特征“审查日期”相关。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><ol class=""><li id="3c22" class="md me it lb b lc ld lf lg li mf lm mg lq mh lu mi mj mk ml bi translated"><strong class="lb iu">天秤座</strong></li></ol><p id="5921" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">面临的挑战是找到最佳的技术组合，以便您可以将预测中的误差降至最低。<em class="mm"> Libra </em>提供开箱即用的自动化监督机器学习，优化机器(或深度)学习管道，在几秒钟内自动搜索最佳学习算法(神经网络、SVM、决策树、KNN 等)和最佳超参数。<a class="ae ky" href="https://github.com/Palashio/libra" rel="noopener ugc nofollow" target="_blank">点击此处</a>查看 Libra 中可用的评估者/模型的完整列表。</p><p id="de27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个预测巧克力评级数据集 review_date 特征的示例，该数据集是一个复杂的多类分类(标签:2006–2020)。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="0391" class="ms mt it mo b gy mu mv l mw mx"><strong class="mo iu">#import libraries<br/></strong>!pip install libra<br/>from libra import client</span><span id="0d74" class="ms mt it mo b gy my mv l mw mx"><strong class="mo iu">#open the dataset<br/></strong>a_client = client('../input/preprocess-choc/dfn.csv')<br/>print(a_client)</span><span id="45c4" class="ms mt it mo b gy my mv l mw mx"><strong class="mo iu">#choose the model<br/></strong>a_client.neural_network_query('review_date', epochs=20)<br/>a_client.analyze()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/134161ee8e342e73e5cea82341f95ac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rZf7ZNkKmxFlOPjAkkkKOw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用 Libra <strong class="bd na"> ( </strong>图片由作者提供)自动神经网络</p></figure><p id="ab2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Libra 使神经网络在优化前的精度为 0.796，在优化后的精度为 0.860，减少了从训练/测试= 0.796–0.764(0.35)到训练/测试= 0.860–0.851(0.009)的过拟合，从而使神经网络的最佳层数为 3 到 6。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/2cfeab5362c571b3096d78e796be6196.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QMIe3Hy8lkmDd2K9Lu-5Bw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">尼克·卡沃尼迪斯在<a class="ae ky" href="https://unsplash.com/s/photos/arcade-game-machine-neon?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="4bef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.<strong class="lb iu"> Pycaret </strong></p><p id="efbb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">PyCaret 是一个简单易用的顺序流水线，包括一个集成了超参数调整和训练模型集成的预处理功能。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="84e7" class="ms mt it mo b gy mu mv l mw mx"><strong class="mo iu">#import libraries<br/></strong>!pip install pycaret<br/>from pycaret.classification import *</span><span id="8d31" class="ms mt it mo b gy my mv l mw mx"><strong class="mo iu">#open the dataset<br/></strong>dfn = pd.read_csv('../input/preprocess-choc/dfn.csv')</span><span id="26d8" class="ms mt it mo b gy my mv l mw mx"><strong class="mo iu">#define target label and parameters<br/></strong>exp1 = setup(dfn, target = 'review_date', feature_selection = True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/6f33735d554243a9c75718d586c73dee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gmZBwDpNCQfgTDLn8aOqpA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pycaret 预处理函数<strong class="bd na"> ( </strong>图片由作者提供)</p></figure><p id="196d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有预处理步骤都在 setup()中应用。<strong class="lb iu"> </strong>有超过 40 个特征为机器学习准备数据，包括缺失值插补、分类变量编码、标签编码(将是或否转换为 1 或 0)和训练-测试-分割，在初始化 setup()时自动执行。关于 PyCaret 预处理能力的更多细节<a class="ae ky" href="https://www.pycaret.org/preprocessing" rel="noopener ugc nofollow" target="_blank">点击这里</a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/f39c823cae917c269b79665016b03081.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kemtr3Sdn69LJ2ujYeJyyA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">托比·奥蒂在<a class="ae ky" href="https://unsplash.com/s/photos/arcade-game-machine?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="d5d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pycaret 在一行中进行模型比较，返回一个包含 k 倍交叉验证得分和算法得分指标的表。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="b490" class="ms mt it mo b gy mu mv l mw mx">compare_models(fold = 5, turbo = True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/7c9ca325f00ceb2e92babcf85654d418.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xQL9ZilmzOB0m3Afi0re_g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最佳比较分类器<strong class="bd na"> ( </strong>图片由作者提供)</p></figure><p id="0199" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">PyCaret 拥有超过 60 种开源的现成算法。<a class="ae ky" href="https://www.pycaret.org/create-model" rel="noopener ugc nofollow" target="_blank">点击此处</a>查看 PyCaret 中可用的评估者/模型的完整列表。</p><p id="a95d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> tune_model </strong>函数用于自动调整机器学习模型<strong class="lb iu">的超参数。</strong> PyCaret 在预定义的搜索空间内使用<strong class="lb iu">随机网格搜索</strong>。该函数返回一个包含 k 倍交叉验证分数的表。</p><p id="4ad3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> ensemble_model </strong>函数用于集合训练好的模型。它只需要经过训练的模型对象返回一个具有 k 倍交叉验证分数的表。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="847b" class="ms mt it mo b gy mu mv l mw mx"><strong class="mo iu"># creating a decision tree model<br/></strong>dt = create_model(dt)</span><span id="f931" class="ms mt it mo b gy my mv l mw mx"><strong class="mo iu"># ensembling a trained dt model<br/></strong>dt_bagged = ensemble_model(dt)</span><span id="6eb1" class="ms mt it mo b gy my mv l mw mx"><strong class="mo iu">#plot_model dt<br/></strong>plot_model(estimator = dt, plot = 'learning')</span><span id="749e" class="ms mt it mo b gy my mv l mw mx"><strong class="mo iu"># plot_model dt_bagged<br/></strong>plot_model(estimator = dt_bagged, plot = 'learning')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/b15d5c4dac9bd6d712efd02bc3e56e33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NPFYdBCDCJGu6yMTjPG_bA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">简单和 bagging 决策树评估指标<strong class="bd na">(作者提供</strong>图片)</p></figure><p id="1fca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以使用<strong class="lb iu"> plot_model </strong>函数对经过训练的机器学习模型进行性能评估和诊断。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="8fb7" class="ms mt it mo b gy mu mv l mw mx"><strong class="mo iu">#hyperparameters tunning</strong></span><span id="db44" class="ms mt it mo b gy my mv l mw mx">tuned_dt = tune_model(dt,optimize = "Accuracy", n_iter = 500)</span><span id="a242" class="ms mt it mo b gy my mv l mw mx"><strong class="mo iu">#evaluate model</strong></span><span id="5b79" class="ms mt it mo b gy my mv l mw mx">evaluate_model(estimator=tuned_dt)</span><span id="e069" class="ms mt it mo b gy my mv l mw mx"><strong class="mo iu">#plot tuned dt confusion matrix</strong></span><span id="0783" class="ms mt it mo b gy my mv l mw mx">plot_model(tuned_dt, plot = 'confusion_matrix')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/adca26718d5042899a4164cb50e5f624.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KsB-VXwxUsqIRcXaALV1nQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用 Pycaret <strong class="bd na">的决策树分类器评估方法</strong></p></figure><p id="4ddc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，<strong class="lb iu"> predict_model </strong>函数可用于预测未知数据集。</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="74b1" class="ms mt it mo b gy mu mv l mw mx"><strong class="mo iu">#predicting label on a new dataset</strong></span><span id="da4d" class="ms mt it mo b gy my mv l mw mx">predictions = <strong class="mo iu">predict_model</strong>(dt)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/ad1ee4bbd0ad8683b23f157f7e2746bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FNf5Xg8vjrk6sDEY7RAQHQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用决策树<strong class="bd na"/>进行日期预测</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/92f475d9510170bad5eb338de4747c9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7JelD0RGVyUPkQ9m07XzoQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@element5digital?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Element5 数码</a>在<a class="ae ky" href="https://unsplash.com/s/photos/arcade-game-machine-neon?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="2b32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有空闲时间，我建议你看看这个:</p><div class="nj nk gp gr nl nm"><a href="https://medium.com/swlh/algorithm-selection-65814f477d6a" rel="noopener follow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd iu gy z fp nr fr fs ns fu fw is bi translated">算法选择</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">从一系列算法中选择最佳算法的指南。</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">medium.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa ks nm"/></div></div></a></div><p id="ea1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">总结一下</strong></p><p id="60b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请参考以下链接:</p><p id="b986" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://jovian.ml/yeonathan/libra" rel="noopener ugc nofollow" target="_blank">https://jovian.ml/yeonathan/libra</a></p><p id="50a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://jovian.ml/yeonathan/pycaret" rel="noopener ugc nofollow" target="_blank">https://jovian.ml/yeonathan/pycaret</a></p><p id="010d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于选择巧克力棒的完整算法，请使用这两种方法评估日期。</p><p id="5445" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个简短的概述提醒我们在数据科学中使用正确的算法选择方法的重要性。这篇文章涵盖了高维数据集的两个最好的 Python 自动算法选择方法，并分享了有用的文档。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/9a4da7c006ececff7b33f475f1acb065.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U4XrYEr_8wZDf5tkb_J4ng.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@ingmarr?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">英格玛</a>在<a class="ae ky" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="114a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">希望你喜欢，继续探索！</strong></p></div></div>    
</body>
</html>