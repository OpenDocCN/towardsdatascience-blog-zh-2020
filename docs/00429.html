<html>
<head>
<title>68–95–99.7 — The Three-Sigma Rule of Thumb Used in Power BI.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">68–95–99.7—在 Power BI 中使用的三适马经验法则。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/68-95-99-7-the-three-sigma-rule-of-thumb-used-in-power-bi-59cd50b242e2?source=collection_archive---------15-----------------------#2020-01-13">https://towardsdatascience.com/68-95-99-7-the-three-sigma-rule-of-thumb-used-in-power-bi-59cd50b242e2?source=collection_archive---------15-----------------------#2020-01-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="b24d" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">采用微软 POWER BI 的数据科学</h2><div class=""/><div class=""><h2 id="0118" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">在无代码的 Power BI 中使用三西格马经验法则检测异常值和异常</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/9f50b0246f2a7563d8426eaf27d66e8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*flwYxxdqRkBfMirU"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@the_roaming_platypus?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> timJ </a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="0b73" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">即使在最小的数据项目中，最重要的步骤之一是检测数据结构中的异常值、离群值或异常。</p><p id="1b7c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在这个简短的指南中，我将向您展示不使用任何代码来检测这些值的最基本的方法。除了在 Power BI 中实现这一点的许多方法之外，这是最直接的<strong class="lh ja"> </strong>和 UI 驱动的方法，并且仍然非常有用。</p><h1 id="78ab" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">什么是异常值，如何识别？</h1><p id="9270" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">定义异常值的常用方法是“标准偏差的 3 倍”规则，通常称为<strong class="lh ja">三西格马经验法则。</strong></p><p id="b8d2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="my">想要更多背景？在</em> <a class="ae le" href="https://en.wikipedia.org/wiki/68%E2%80%9395%E2%80%9399.7_rule" rel="noopener ugc nofollow" target="_blank"> <em class="my">维基百科</em> </a> <em class="my">上找到。</em></p><p id="caf5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">假设我们的数据集中有一个值为<em class="my"> </em>的列，我们想要检测它是否包含异常值。Todo 因此我们查看| <em class="my"> value — average </em> |，以测量该值与平均值的差距。</p><p id="1730" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果这个绝对值是我们的标准偏差的 3 倍以上，那么我们可以认为这个值是异常值。</p><h1 id="44ad" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">数据</h1><p id="1ad6" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">这种方法最适用于符合标准正态分布的数据。</p><p id="ad5a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但是，即使对于非正态分布的变量，<strong class="lh ja">三西格马规则</strong>告诉我们，至少 88.8%的情况应该落在正确计算的三西格马区间内。</p><p id="f10e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">为了遵循这个指南，你可以选择你自己的数据集或者下载我的数据集，这个数据集按照标准的正态分布填充了 5000 个随机值。具体地说，它填充了从均值为 0、方差为 1 的单变量“正态”(高斯)分布中采样的随机浮点数。</p><div class="mz na gp gr nb nc"><a href="https://github.com/sebastianzolg/filtering-outliers-with-powerbi" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ja gy z fp nh fr fs ni fu fw iz bi translated">sebastianzolg/使用 powerbi 过滤异常值</h2><div class="nj l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">github.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np ky nc"/></div></div></a></div><p id="4d36" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="my">想知道如何用 python 创建这样的数据？请参见本指南末尾的奖金部分。</em></p><h1 id="0811" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">移除异常值</h1><p id="c3b8" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">让我们从存储库中的<strong class="lh ja"> randoms.csv </strong>文件中提取数据，并将其加载到 Power BI 中。</p><p id="e999" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">打开 Power BI，点击<strong class="lh ja">获取数据</strong>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/b37c60ca2a24524d8193736e9f6a5762.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pRb3WGyXCzHmAcYEXNGXqQ.png"/></div></div></figure><p id="46dc" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">选择<strong class="lh ja"> Text/CSV </strong>，点击<strong class="lh ja">连接</strong>，选择之前下载的<strong class="lh ja"> randoms.csv </strong>文件。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nr"><img src="../Images/7cd91dd112d20266cadfe6e774b5f33e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wZiECPLIhVi8L9v-5LeeSw.png"/></div></div></figure><p id="b5dc" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">检查数据，确保数据加载正确。点击<strong class="lh ja">转换数据</strong>将其提取到 Power BI 中。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ns"><img src="../Images/c77b600ffda8dc48d96ffe030bc0b435.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*78BI0S_SDTCR0WcQVPk1oQ.png"/></div></div></figure><p id="297c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们希望有一个自定义列，使我们能够轻松地过滤离群值。为了识别异常值，我们首先需要计算所有数据的平均值和标准差。</p><p id="c904" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">为此，我们将初始查询<em class="my">复制两次</em>。选择初始查询，<strong class="lh ja">右击</strong>并从上下文菜单中选择<strong class="lh ja">复制</strong>。第二次重复这个步骤，这样总共有 3 个查询。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/586251e1e34dab6af32378ef25fed51a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uNan3ZbME5S-Q7xX4yuU_A.png"/></div></div></figure><p id="363b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，我们很快<em class="my">将我们重复的查询重命名为<strong class="lh ja">表示</strong>和<strong class="lh ja">标准差</strong>，这样就反映了我们的意图。<strong class="lh ja">右键点击</strong>两个查询，并点击上下文菜单中的<strong class="lh ja">重命名</strong>。</em></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/5485442a6a958f4c50e80ee4e10fbe44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jx7we83zLxXVao4arTSAMA.png"/></div></div></figure><p id="8f98" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">既然我们已经正确地命名了我们的查询，我们就可以继续在我们的<strong class="lh ja"> Randoms </strong>列上对<strong class="lh ja">均值</strong>和<strong class="lh ja">标准差</strong>查询进行快速计算。</p><p id="4ca2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">选择<strong class="lh ja">均值</strong>查询，点击<strong class="lh ja">随机数</strong>列的标题。现在选择控制功能区中的<strong class="lh ja">转换</strong>选项卡，并注意<strong class="lh ja">统计</strong>。打开<strong class="lh ja">统计</strong>的右键菜单，从列表中选择<strong class="lh ja">平均值</strong>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/9e2ebb0d7dc0f5f37443b56d21c2db4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bjj0M56Y1lcEVELOPV4Ytg.png"/></div></div></figure><p id="99fe" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这立即将查询转换成一个十进制数，表示我们的<strong class="lh ja"> Randoms </strong>列的<strong class="lh ja"> Mean </strong>值。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/212b8225e6d645d22d49506b14d5a14c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bz_39U4ToqqVIMoBoN_Z9Q.png"/></div></div></figure><p id="94c4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">对<strong class="lh ja">标准差</strong>查询重复此步骤，但这次从<strong class="lh ja">统计</strong>的上下文菜单中选择<strong class="lh ja">标准差</strong>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/5cac192bb926e6007024f2d1b9502d9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1JcF75jWFgxcCR42ujVqbg.png"/></div></div></figure><p id="532a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">同样，这将把查询转换成表示我们的<strong class="lh ja"> Randoms </strong>列的<strong class="lh ja">标准偏差</strong>的单个十进制值。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/3861bde50c86b3e6fcd1172692347138.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2fZOThB0AGB1cNvn8MvC1A.png"/></div></div></figure><p id="7d9d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在我们不用一行代码就可以快速计算出<strong class="lh ja">均值</strong>和<strong class="lh ja">标准差</strong>，我们现在可以计算出异常值。</p><p id="0fd0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们希望用一个专用的列来过滤异常值。跳转到<strong class="lh ja">添加列</strong>功能区选项卡，点击<strong class="lh ja">自定义列</strong>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/1b857441659c850c37ca0818842d9c09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vs1Xev93t1wZQ0UxPdr82g.png"/></div></div></figure><p id="b857" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这将立即打开幂查询公式编辑器，我们可以在其中计算这个新列的值。将该列命名为类似于<strong class="lh ja">is outer</strong>的名称。</p><p id="83d9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，我们必须将我们对<strong class="lh ja">三西格马规则</strong>的了解转化为一个幂 BI 公式。这是最终的公式，易于阅读和理解。</p><pre class="kp kq kr ks gt nt nu nv nw aw nx bi"><span id="3c2f" class="ny mc iq nu b gy nz oa l ob oc">Number.Abs([Randoms] — Mean) &gt; (3 * #”Standard Deviation”)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi od"><img src="../Images/120d4cce62e6afa0de3f3d6dc47adb1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QRNc3DSrEvavKclwyp8PVg.png"/></div></div></figure><p id="c2a7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们来分解一下。首先，我们取列<code class="fe oe of og nu b">[Random]</code>中的每个值<em class="my">，并减去总的<code class="fe oe of og nu b">Mean</code>，这是我们查询<strong class="lh ja">平均值</strong>的结果。用函数<code class="fe oe of og nu b">Number.Abs()</code>包围这个计算，该函数返回计算的绝对数。</em></p><p id="82f4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在我们验证结果是否大于标准偏差的三倍。我们通过<code class="fe oe of og nu b">&gt; (3 * #"Standard Deviation")</code>来实现，这里<code class="fe oe of og nu b">Standard Deviation</code>是我们的<strong class="lh ja">标准差</strong>查询的结果。</p><p id="a975" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">就是这样！点击<strong class="lh ja"> OK </strong>，您就可以过滤异常值并检测异常情况了。</p><p id="1b3b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">回到编辑器，您可以看到新创建的列及其值是根据我们的公式计算出来的。让我们通过单击列标题旁边的<strong class="lh ja">向下箭头</strong>图标，将我们的<strong class="lh ja">外部</strong>列过滤到<code class="fe oe of og nu b">TRUE</code>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/be0ec81e5190eff8781b0fcd1caca4e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eVU_QqnaZpFPdkeToUCXhA.png"/></div></div></figure><p id="47ce" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">通过使用我的数据集，我们发现了 19 个异常值。正如你从数字中看到的，这些异常值确实代表了我们随机范围的外部边缘。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nq"><img src="../Images/722289f10f88553ec60732be7029366c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zkJtDEU0rRvaqsiYuvuLhA.png"/></div></div></figure><p id="55c9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">恭喜！</strong>您成功检测到数据集中的异常值。随意反转过滤器，使用非异常值的数据。这会给你统计上更好的结果。</p><p id="1b27" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">就这样吧。</p><p id="87a6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">—塞巴斯蒂安</p><h1 id="d545" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">额外收获:用 python 创建随机数</h1><p id="d45b" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">使用下面的代码片段，你可以快速生成你自己的随机数，并随意使用。通过点击<a class="ae le" href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.random.randn.html" rel="noopener ugc nofollow" target="_blank">链接</a>了解更多关于生成它的函数的信息。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="oh oi l"/></div></figure></div></div>    
</body>
</html>