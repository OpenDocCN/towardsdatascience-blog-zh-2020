<html>
<head>
<title>Level Up with Google’s Public Datasets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用谷歌的公共数据集升级</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/level-up-with-googles-public-datasets-5ffce0893ea0?source=collection_archive---------56-----------------------#2020-07-08">https://towardsdatascience.com/level-up-with-googles-public-datasets-5ffce0893ea0?source=collection_archive---------56-----------------------#2020-07-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bcf5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">将 Jupyter 笔记本电脑连接到万亿字节的数据</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cc97806ef7b8f4ea011df797a3c588a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*szfy6askzP6PGblvbiq4uA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">瓦西里·科洛达在<a class="ae kv" href="/s/photos/hooray?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="599a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我记得我的第一个数据科学项目，分析一万部电影的 6.5MB 文件。从几个击键的数据中快速找到模式是很神奇的，很快我就开始寻找其他数据集进行分析。通过 Kaggle 并最终通过网络爬行产生独特的数据，我发现大多数可下载的数据集都很小(&lt;1GB) and that collecting and working with large datasets required a different type of skill: data engineering.</p><p id="1445" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Most aspiring data scientists only know how to analyze clean, comma separated files that fit on their RAM (usually &lt;8GB). In practice, data science is much more unpredictable when you deal with terabytes of data in different formats from different data streams. So how does an aspiring data scientist gain exposure to big data?</p><p id="96e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">To take you to big data, we will explore:</p><ol class=""><li id="bfe0" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">Diving into Big Data with Google Cloud Public Datasets</li><li id="e138" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">What is BigQuery?</li><li id="f5d7" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">How to Connect Your Jupyter Notebook to BigQuery</li></ol><h1 id="e533" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">Diving into Big Data with Google Cloud Public Datasets</h1><p id="5609" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">It turns out that Google has a repository of most publicly available data such as <a class="ae kv" href="https://console.cloud.google.com/marketplace/product/openaq/real-time-air-quality?filter=solution-type:dataset&amp;q=air quality" rel="noopener ugc nofollow" target="_blank">空气质量</a>、<a class="ae kv" href="https://console.cloud.google.com/marketplace/product/united-states-census-bureau/us-census-data?filter=solution-type:dataset&amp;q=census&amp;id=2c089839-2b4a-477a-962b-4a8b730d0a12" rel="noopener ugc nofollow" target="_blank">美国人口普查</a>、<a class="ae kv" href="https://console.cloud.google.com/bigquery?project=fh-bigquery&amp;redirect_from_classic=true&amp;p=fh-bigquery&amp;d=reddit_comments&amp;t=2019_12&amp;page=table" rel="noopener ugc nofollow" target="_blank"> Reddit </a>、<a class="ae kv" href="https://console.cloud.google.com/bigquery?project=fh-bigquery&amp;redirect_from_classic=true&amp;p=fh-bigquery&amp;d=flights&amp;t=ontime_201903_summary&amp;page=table" rel="noopener ugc nofollow" target="_blank">航班</a>)。如果有一个公共数据集，谷歌可能会托管它，供你查询。更重要的是，新的数据集(即<a class="ae kv" href="https://console.cloud.google.com/marketplace/product/bigquery-public-datasets/covid19-dataset-list?filter=solution-type:dataset&amp;q=covid&amp;id=4a850823-3f83-48f5-92d1-01ba6f8ed81e" rel="noopener ugc nofollow" target="_blank">新冠肺炎</a>)不断被添加和更新。</p><p id="16e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了 BigQuery 上托管的数据，您可以轻松地查询数据，看看它是否有趣。例如，我可以查询并回答这个问题:“谷歌上有多少针对佛罗里达州女性的政治广告活动？”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/0f17b6ebd03038652828c3f0b73c8eb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i4M_wP1RQPQod-lkhd3B_A.png"/></div></div></figure><p id="b320" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">探索谷歌公共数据集上的其他可用数据集！</p><h1 id="92d4" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated"><strong class="ak">什么是 BigQuery？</strong></h1><p id="862a" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">BigQuery 是 Google 的无服务器数据仓库。获取数据很容易，因为<strong class="ky ir">每月第一个 1tb 的查询是免费的</strong>。正如一位 Spotify 工程师所说:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/1e043ce5f4696e83836a99ccc2a26226.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*BkSlLUOH7sMEkQbKd9oFVg.png"/></div></figure><p id="aa58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我喜欢 BigQuery 的是它的速度。将它的速度与超过 100 个公共数据集的存储库结合起来，我们可以快速分析数据，以确定它是否值得分析。</p><p id="3c5b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于数据集托管在同一个数据仓库中，我们可以连接两个公共数据集来进行唯一的分析。例如，我们可以根据<a class="ae kv" href="https://console.cloud.google.com/bigquery?project=cptsrewards-hrd&amp;p=bigquery-public-data&amp;d=noaa_gsod&amp;t=gsod2015&amp;page=table" rel="noopener ugc nofollow" target="_blank">天气预报</a>来预测对<a class="ae kv" href="https://console.cloud.google.com/bigquery?project=cptsrewards-hrd&amp;p=bigquery-public-data&amp;d=new_york_taxi_trips&amp;t=tlc_yellow_trips_2015&amp;page=table" rel="noopener ugc nofollow" target="_blank">纽约出租车</a>的需求。谷歌甚至为此写了一篇不错的博文:<a class="ae kv" href="https://cloud.google.com/blog/products/gcp/how-to-forecast-demand-with-google-bigquery-public-datasets-and-tensorflow" rel="noopener ugc nofollow" target="_blank">如何用谷歌大查询、公共数据集和 TensorFlow 预测需求</a>。</p><h1 id="7cfe" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">如何将您的 Jupyter 笔记本连接到 BigQuery</h1><p id="0931" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">既然我们已经找到了想要在 BigQuery 上分析的数据，让我们把它带到本地 jupyter 笔记本环境中。我们可以利用 BigQuery 的 API 将数据加载到 dataframe 中。</p><p id="b154" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一步是安装 BigQuery 客户端库，可以使用 pip 或 conda 来完成。</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="6063" class="nk mh iq ng b gy nl nm l nn no">pip install --upgrade google-cloud-bigquery</span></pre><p id="6539" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或者</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="881a" class="nk mh iq ng b gy nl nm l nn no">conda install -c conda-forge google-cloud-bigquery</span></pre><p id="f103" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们需要为我们的 jupyter 笔记本创建一个服务帐户密钥，以便在 Google Cloud 上使用和验证。</p><ol class=""><li id="806b" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">在云控制台中，转到<a class="ae kv" href="https://console.cloud.google.com/apis/credentials/serviceaccountkey?_ga=2.206600659.1193354495.1593399490-1928542389.1549667178" rel="noopener ugc nofollow" target="_blank">创建服务帐户密钥页面</a></li><li id="3868" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">从服务帐户列表中，选择新建服务帐户。</li><li id="fc59" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">在“服务帐户名称”字段中，输入一个名称(即 pythonBigQuery)</li><li id="b36d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">从角色列表中，选择项目&gt;所有者。您可以稍后使用云控制台查看和更改此字段。如果您正在开发生产应用程序，请指定更精细的权限。</li><li id="94a7" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">单击创建。一个 JSON 文件，包含下载到您计算机的密钥</li></ol><p id="c566" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下载 JSON 密钥后，我们可以验证 jupyter 笔记本以连接到 BigQuery。我们导入操作系统库，将我们的 Google 凭证设置为下载的密钥。如下面的笔记本所示，我现在可以将 BigQuery 表作为 dataframe 查询和检索，其中列名和数据类型都是从该表继承的！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/20ae174e7b4b221b612ff015bc8028b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HZ8Qp2EkXMXrtsXC4FqmGQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">df . head()for big query-public-data . baseball . schedules</p></figure><p id="7067" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Google 官方文档:<a class="ae kv" href="https://cloud.google.com/bigquery/docs/reference/libraries#cloud-console" rel="noopener ugc nofollow" target="_blank"> BigQuery API 客户端库</a></p><h1 id="0368" class="mg mh iq bd mi mj mk ml mm mn mo mp mq jw mr jx ms jz mt ka mu kc mv kd mw mx bi translated">结论</h1><p id="540f" class="pw-post-body-paragraph kw kx iq ky b kz my jr lb lc mz ju le lf na lh li lj nb ll lm ln nc lp lq lr ij bi translated">谷歌公共数据集是探索大数据的良好开端。利用云计算和仓储，我们可以在几秒钟内探索万亿字节的数据。有了本地支持的 API，我们可以轻松地将 BigQuery 上的数据集成到我们的 jupyter 笔记本中！</p></div></div>    
</body>
</html>