<html>
<head>
<title>Automate Reports in Google Sheets Using Data from Google BigQuery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用来自 Google BigQuery 的数据自动生成 Google Sheets 中的报告</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automate-reports-in-google-sheets-using-data-from-google-bigquery-e6bb38d745dd?source=collection_archive---------49-----------------------#2020-07-06">https://towardsdatascience.com/automate-reports-in-google-sheets-using-data-from-google-bigquery-e6bb38d745dd?source=collection_archive---------49-----------------------#2020-07-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/106e0aefb9eb10f16b4bda6c9dfb64af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Osycuky0GTVxRBPahHnWpw.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来源:<a class="ae jg" href="https://ru.depositphotos.com/100580468/stock-photo-contemporary-room-workplace.html" rel="noopener ugc nofollow" target="_blank">沉积照片</a></p></figure><div class=""/><div class=""><h2 id="8dae" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">如何基于来自 Google BigQuery 的数据设置自动更新和发送 Google Sheets 中内置的电子邮件报告</h2></div><h1 id="670f" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">为什么要 Google BigQuery？</h1><p id="9720" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在我们谈论设置之前，对于那些不熟悉云存储服务的人来说，先说几句<a class="ae jg" href="https://cloud.google.com/bigquery/" rel="noopener ugc nofollow" target="_blank"> Google BigQuery </a>的特性和好处。</p><p id="a8d4" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">Google BigQuery 的优势:</p><ul class=""><li id="47f1" class="mr ms jj ls b lt mm lw mn lz mt md mu mh mv ml mw mx my mz bi translated">快速云解决方案，让您能够在几秒钟内处理数 TB 的数据</li><li id="5de3" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">适合小型和大型公司</li><li id="9edd" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">经济高效且易于扩展</li><li id="57aa" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">不需要服务器、容量预留和维护</li><li id="f41c" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">透明的定价策略—只为处理的数据付费，没有隐藏的费用</li><li id="65f3" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">数据处理的灵活性——用 SQL 访问包含数据的表，还可以使用 JavaScript 函数</li><li id="57c0" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">可靠性和安全性得到了众多证书的证实——PCI DSS、ISO 27001、SOC 2 和 SOC 3 Type II——因此您可以安全地存储客户的信用卡号、电子邮件地址和其他个人信息</li></ul><h1 id="ea46" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">易于自动化数据交换</h1><p id="4aba" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">Google BigQuery 的另一个值得强调的特性是它与外部服务的方便集成。该存储库有大量现成的库和连接器，使得自动化数据交换变得容易。例如，使用<a class="ae jg" href="https://www.owox.com/products/bi/pipeline/" rel="noopener ugc nofollow" target="_blank"> OWOX BI </a>，你可以从谷歌分析、广告源、电话跟踪服务、电子邮件简讯等导入数据。into BigQuery:</p><p id="2cd3" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">以下是使用 BigQuery 的一些更有用的工具:</p><ul class=""><li id="46b8" class="mr ms jj ls b lt mm lw mn lz mt md mu mh mv ml mw mx my mz bi translated"><a class="ae jg" href="https://developers.google.com/bigquery/docs/reference/v2/" rel="noopener ugc nofollow" target="_blank"> Rest API </a></li><li id="3795" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated"><a class="ae jg" href="https://developers.google.com/bigquery/third-party-tools" rel="noopener ugc nofollow" target="_blank">第三方工具</a></li><li id="1a6d" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated"><a class="ae jg" href="https://cloud.google.com/bigquery/docs/reference/libraries?hl=en" rel="noopener ugc nofollow" target="_blank"> SDK </a></li><li id="8d41" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated"><a class="ae jg" href="https://code.google.com/p/starschema-bigquery-jdbc/" rel="noopener ugc nofollow" target="_blank"> JDBC </a></li><li id="aa7d" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated"><a class="ae jg" href="http://www.simba.com/connectors/google-bigquery-odbc" rel="noopener ugc nofollow" target="_blank"> ODBC </a></li><li id="e946" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated"><a class="ae jg" href="https://developers.google.com/bigquery/bq-command-line-tool" rel="noopener ugc nofollow" target="_blank">命令行工具</a></li></ul><h1 id="0921" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">BigQuery 数据传输服务</h1><p id="36e1" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">BigQuery 最近推出了一款<a class="ae jg" href="https://cloud.google.com/bigquery/transfer/" rel="noopener ugc nofollow" target="_blank">数据传输服务工具</a>，可以自动传递来自谷歌广告服务的数据。它目前使用以下服务:</p><ul class=""><li id="7bd3" class="mr ms jj ls b lt mm lw mn lz mt md mu mh mv ml mw mx my mz bi translated">谷歌广告</li><li id="cae9" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">活动经理</li><li id="3e33" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">谷歌广告经理</li><li id="6c60" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml mw mx my mz bi translated">油管（国外视频网站）</li></ul><p id="c61b" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">您可以通过几次点击来设置集成，之后来自这些服务的所有信息都会自动在 BigQuery 中提供给您。</p><h1 id="b0c9" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">在 Google BigQuery 中组合数据</h1><p id="a41b" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">要基于完整的数据构建报告并实现自动化，您需要在 BigQuery 中组合来自不同来源的数据。这里有一个如何做到这一点的例子:</p><ol class=""><li id="1ede" class="mr ms jj ls b lt mm lw mn lz mt md mu mh mv ml nf mx my mz bi translated">首先，在谷歌分析中从你的网站收集数据。</li><li id="d0d6" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml nf mx my mz bi translated">使用 Google Sheets 从其他来源补充信息。</li><li id="8358" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml nf mx my mz bi translated"><a class="ae jg" href="https://www.owox.com/products/bi/pipeline/google-analytics-cost-data-import/" rel="noopener ugc nofollow" target="_blank">添加来自广告服务</a>的成本数据——例如，通过 OWOX BI。</li><li id="3f3c" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml nf mx my mz bi translated">将所有这些数据导入 BigQuery。如果您是 Google Analytics 360 的客户，您可以使用 BigQuery 导出功能来完成这项工作。如果你没有 Google Analytics 360，你可以连接 OWOX BI，用它将数据从 Google Analytics 导入 Google BigQuery。</li><li id="9962" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml nf mx my mz bi translated">将信息<a class="ae jg" href="https://support.owox.com/hc/en-us/articles/360000840193" rel="noopener ugc nofollow" target="_blank">从你的 CRM 和 ERP 系统转移到 BigQuery </a>并与你网站的数据相结合。</li><li id="913e" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml nf mx my mz bi translated">同样在 BigQuery 中，从任何种类的 Google Sheets 下载更多信息</li><li id="bda2" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml nf mx my mz bi translated">如果您使用通话跟踪，请将通话和聊天数据上传到 BigQuery。OWOX BI 集成了五种通话/聊天服务。</li><li id="1a4f" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml nf mx my mz bi translated">对电子邮件时事通讯做同样的事情。</li><li id="c5a9" class="mr ms jj ls b lt na lw nb lz nc md nd mh ne ml nf mx my mz bi translated">最后，使用数据传输服务，它从 Google 和 YouTube 广告服务导入数据</li></ol><h1 id="7be1" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">使用 OWOX BI BigQuery 报表附加组件</h1><p id="8867" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在您组合了 Google BigQuery 中的所有数据，通过一个关键参数将其链接起来，并构建了必要的报告之后，您可以自动将这些报告上传到 Google Sheets。为此，请使用 OWOX BI BigQuery Reports 插件。它类似于 Google Analytics Sheets 插件，但是需要 SQL 语法知识。要在 BigQuery 中访问数据，您需要构建一个 SQL 查询，之后您将在 Google Sheets 中看到所需结构的数据。</p><h1 id="f00d" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">如何基于 Google BigQuery 数据在 Google Sheets 中创建报告</h1><p id="3cf4" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">首先，<a class="ae jg" href="https://chrome.google.com/webstore/detail/owox-bi-bigquery-reports/fepofngogkjnejgcbdmmkddnpeojbbin" rel="noopener ugc nofollow" target="_blank">在你的 Chrome 浏览器中安装 BigQuery Reports 插件</a>。为此，打开一个 Google Sheets 文档，转到 OWOX BI BigQuery Reports 选项卡，并选择 Add a new report。</p><p id="0cf9" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">如果这是你第一次使用这个插件，你需要提供你的 Google BigQuery 帐户的访问权限。</p><figure class="nh ni nj nk gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ng"><img src="../Images/c188eb4560657be86d50772f807e133d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*di_O2yWo7BVK2ZMV.jpg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片由作者提供</p></figure><p id="5cfd" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">之后，指定您想要在报告中查看其数据的项目。然后从下拉列表中选择一个 SQL 查询(如果您之前创建了查询)，或者通过单击“添加新查询”添加一个新查询。</p><figure class="nh ni nj nk gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ng"><img src="../Images/d647ca079e9fa38e9a703a19d466c4e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7rh7oGvEDvyZjRjW.jpg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片由作者提供</p></figure><p id="69e9" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">您可以立即在 SQL 查询中将先前指定的动态参数添加到报表中。选择报告的日期，并通过单击“添加并运行”按钮运行查询。</p><p id="fea9" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">此时，附加组件将在 BigQuery 中访问您的数据并执行计算。然后，在您的表中，将出现一个单独的工作表，其中包含查询结果。</p><p id="3df7" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">现在您可以可视化这些数据，创建数据透视表，等等。</p><figure class="nh ni nj nk gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ng"><img src="../Images/2fba8d16ac04f8730e2221c67767d67a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NWljNVV-iB3I-IEv.jpg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片由作者提供</p></figure><h1 id="4de6" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">基于 BigQuery 数据自动更新报告</h1><p id="ba34" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">为了避免每次需要数据时都必须手动运行查询，您可以设置一个计划报告。为此，请转到附加组件–&gt; OWOX BI big query 报告–&gt;计划报告。</p><p id="9ed1" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">选择报告更新的频率(每小时、每天、每周或每月一次)。然后指定开始 SQL 查询的时间。如有必要，激活电子邮件提醒以更新报告。保存设置。</p><figure class="nh ni nj nk gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ng"><img src="../Images/6bbaaa0d035399770b0519fd04965f59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rEmYtDzZv0ZrW6C9.jpg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片由作者提供</p></figure><p id="4a87" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">完成了。现在，您的报告将根据设定的计划自动更新。</p><h1 id="32b6" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">使用 Google App 脚本通过电子邮件发送报告</h1><p id="0ccf" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">最后，为了不错过 KPI 中的重要变化，您可以使用 Google App Script 配置通过电子邮件发送报告。</p><p id="a919" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">首先，让您的开发人员准备一个脚本，其中包含电子邮件地址和发送消息的条件，可以是定期发送，也可以是响应特定指标的重要更改。</p><p id="e815" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">您可以将此代码用作模板:</p><pre class="nh ni nj nk gt nl nm nn no aw np bi"><span id="5cf7" class="nq kz jj nm b gy nr ns l nt nu">// Send an email with two attachments: a file from Google Drive (as a PDF) and an HTML file.<br/> <strong class="nm jk">var</strong> file = DriveApp.getFileById('abcdefghijklmnopqrstuvwxyz');<br/> <strong class="nm jk">var</strong> blob = Utilities.newBlob('Insert any HTML content here', 'text/html', 'my_document.html');<br/> MailApp.sendEmail('mike@example.com', 'Attachment example', 'Two files are attached.', {<br/>     name: 'Automatic Emailer Script',<br/>     attachments: [file.getAs(MimeType.PDF), blob]<br/> });</span></pre><p id="2200" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">你可以阅读谷歌帮助中的开发者指南，了解更多关于如何构建这些代码的信息。</p><p id="23ef" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">然后在表格中打开您需要的报告，进入工具–&gt;脚本编辑器。将会打开一个新窗口，您需要在其中粘贴脚本。</p><p id="50c8" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">单击时钟图标，设置脚本启动的时间表。现在点击右下角的+添加触发器按钮。然后选择事件源—时间触发器，并从列表中选择通过电子邮件发送报告的频率。最后，单击保存。</p><p id="226a" class="pw-post-body-paragraph lq lr jj ls b lt mm kk lv lw mn kn ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">搞定了。现在，报告将会发送到您的电子邮件中，您不会错过任何内容，并且能够及时对您的营销活动进行更改。</p></div></div>    
</body>
</html>