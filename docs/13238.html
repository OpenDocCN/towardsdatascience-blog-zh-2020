<html>
<head>
<title>A Laymanâ€™s Guide to Building Your First Image Classification Model in R Using Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ Keras åœ¨ R ä¸­æ„å»ºç¬¬ä¸€ä¸ªå›¾åƒåˆ†ç±»æ¨¡å‹çš„å¤–è¡ŒæŒ‡å—</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/a-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572?source=collection_archive---------21-----------------------#2020-09-11">https://towardsdatascience.com/a-laymans-guide-to-building-your-first-image-classification-model-in-r-using-keras-b285deac6572?source=collection_archive---------21-----------------------#2020-09-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ea4e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">åŠ¨æ‰‹é¦™è‰å»ºæ¨¡ç¬¬ä¸€éƒ¨åˆ†</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/39b0c8b9ef422b0ead4c09786ba6d0c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WJYnbqc664tKuIcahpqT_w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">ä½œè€…å›¾ç‰‡</p></figure><p id="d4cb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi lu translated">æœºå™¨å­¦ä¹ çš„åº”ç”¨ç°åœ¨å‡ ä¹æ˜¯æˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ã€‚ä»æ™ºèƒ½æ‰‹æœºä¸­åŸºäºè¯­éŸ³è¯†åˆ«çš„è™šæ‹ŸåŠ©ç†åˆ°è¶…çº§æ™ºèƒ½çš„è‡ªåŠ¨åŒ–æ— äººæœºï¼Œäººå·¥æ™ºèƒ½å’Œäººå·¥æ™ºèƒ½(AI)æ­£åœ¨å½»åº•æ”¹å˜äººæœºäº¤äº’çš„åŠ¨æ€ã€‚äººå·¥æ™ºèƒ½ç®—æ³•ï¼Œç‰¹åˆ«æ˜¯å·ç§¯ç¥ç»ç½‘ç»œ(CNN)ä½¿å¾—è®¡ç®—æœºè§†è§‰æ¯”ä»¥å¾€ä»»ä½•æ—¶å€™éƒ½æ›´åŠ å¼ºå¤§ã€‚è™½ç„¶å®ƒçš„åº”ç”¨ç¨‹åºä»¤äººæƒŠå¹ï¼Œä½†æ„å»ºè‡ªå·±çš„ CNN æ¨¡å‹å¯èƒ½ä¼šéå¸¸ä»¤äººç”Ÿç•ï¼Œç‰¹åˆ«æ˜¯å¯¹äºéç¨‹åºå‘˜æˆ–æ•°æ®ç§‘å­¦åˆå­¦è€…æ¥è¯´ã€‚ä½œä¸ºä¸€ä¸ª R çˆ±å¥½è€…ï¼Œæˆ‘ä¸éš¾æ–­è¨€ï¼Œå¯¹äºä¸€ä¸ª R ç¨‹åºå‘˜æ–°æ‰‹æ¥è¯´ï¼Œå®ƒå˜å¾—æ›´åŠ ç¥ç§˜ã€‚è¿™ç§ä¸å¹³è¡¡çš„åˆç†åŸå› å¯èƒ½æ˜¯ï¼Œæ ‡å‡†ç¥ç»ç½‘ç»œå’Œ ML åº“(å¦‚ Keras å’Œ Tensorflow)ä¸»è¦ä¸ Python å…¼å®¹ï¼Œå¹¶è‡ªç„¶åœ°å¸å¼•å¤§ä¼—ä½¿ç”¨ Python æœ¬èº«ï¼Œå¯¼è‡´ä¸¥é‡ç¼ºä¹æ–°æ‰‹æŒ‡å—å’Œæ–‡æ¡£æ¥å¸®åŠ©åœ¨ r ä¸­å®ç°è¿™äº›å¤æ‚çš„æ¡†æ¶ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Keras å’Œ Tensorflow æ¡†æ¶åœ¨ R ä¸­åˆ¶ä½œä¸€ä¸ªåŸºäº CNN çš„æ™®é€šå›¾åƒåˆ†ç±»æ¨¡å‹ã€‚é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘çš„ç›®æ ‡æ˜¯ä½¿æ‚¨èƒ½å¤Ÿä½¿ç”¨ Keras åœ¨ R ä¸­æ¦‚å¿µåŒ–å’Œæ„å»ºè‡ªå·±çš„ CNN æ¨¡å‹ï¼Œå¹¶é€šè¿‡äº²è‡ªåŠ¨æ‰‹ç¼–ç æ¥å¸®åŠ©å¢å¼ºæ‚¨çš„ä¿¡å¿ƒï¼Œä»¥ä¾¿åœ¨å°†æ¥ä½¿ç”¨è¿™ä¸ªæ·±å¥¥çš„ API æ„å»ºæ›´å¤æ‚çš„æ¨¡å‹ã€‚é™¤äº†æ¨¡å‹çš„è„šæœ¬ä¹‹å¤–ï¼Œæˆ‘è¿˜å°†å°½é‡ç®€æ˜åœ°é˜è¿°å¿…è¦çš„ç»„ä»¶ï¼ŒåŒæ—¶æ·±å…¥æ ¸å¿ƒçš„åº•å±‚æ•°å­¦ã€‚ç°åœ¨æˆ‘ä»¬å¼€å§‹å§ã€‚</p><h2 id="9c62" class="md me it bd mf mg mh dn mi mj mk dp ml lh mm mn mo ll mp mq mr lp ms mt mu mv bi translated">å·ç§¯ç¥ç»ç½‘ç»œ(CNN)å¿«é€Ÿä»‹ç»ã€‚</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/0072abb47c43a079407f2b9ed218d700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2rgqSxnVaf_BIq-7seN-Nw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">å›¾ä¸€ã€‚å·ç§¯ç¥ç»ç½‘ç»œæ¶æ„(<em class="mx">å›¾ç‰‡ä½œè€…</em></p></figure><p id="52de" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ä½œä¸º CNN è„šæœ¬çš„å‰å¥ï¼Œè®©æˆ‘ä»¬ç®€å•äº†è§£ä¸€ä¸‹å®ƒçš„å½¢å¼ä¸»ä¹‰ã€‚å°±åƒäººçœ¼åªåœ¨æœ‰é™çš„æ¥æ”¶æ¡†æ¶ä¸­è®°å½•ä¿¡æ¯ï¼Œå¹¶å­¦ä¹ ç‰¹å®šçš„æ¨¡å¼å’Œç©ºé—´ç‰¹å¾ï¼Œéšåè§¦å‘ç‰¹å®šçš„ç¥ç»ååº”ä¸€æ ·ï¼ŒCNN æ¨¡å‹ä¹Ÿä»¥ç›¸åŒçš„æ–¹å¼è¿è¡Œã€‚æˆ‘ä»¬å°†å°è¯•æ¢ç´¢ CNN æ¶æ„å¹¶ç†è§£å…¶å…³é”®ç»„ä»¶(å›¾ 1)ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/8ca9ac2d85281b01625b184b1d9d54a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/1*7D2LGdbC6fkt3gEBLfVcnQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">å›¾äºŒã€‚å¯è§†åŒ–å·ç§¯(ä½œè€…çš„<em class="mx">å›¾åƒ)</em></p></figure><p id="6e91" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ä¸æ˜¯ä¸€æ¬¡åˆå¹¶æ•´ä¸ªå›¾åƒåƒç´ ï¼Œè€Œæ˜¯å°†ä¸€ä¸ªåƒç´ å­é›†å·ç§¯æˆä¸€ä¸ªæ•°æ®<em class="mz">å›¾ 2 </em>ã€‚å·ç§¯æ˜¯é€šè¿‡åœ¨æ•´ä¸ªå›¾åƒä¸Šæ»‘åŠ¨ä¸€ä¸ªè¾ƒå°å°ºå¯¸çš„å¸§æ¥å®ç°çš„ï¼Œè¯¥å¸§å……å½“è€ƒè™‘äº†æ—¶é—´-ç©ºé—´ç‰¹å¾çš„æ„Ÿå—åŸŸã€‚è¿™ä¸ªå¸§è¢«ç§°ä¸º<strong class="la iu">å†…æ ¸/è¿‡æ»¤å™¨</strong>ã€‚æƒ³è±¡ä¸€ä¸‹ç”¨æ‰‹ç”µç­’æ‰«æä¸€é¢å»ºç­‘å¢™ï¼Œè¿‡æ»¤å™¨ä»¥åŒæ ·çš„æ–¹å¼å·¥ä½œã€‚ç°åœ¨ï¼Œå¦‚æœæ‚¨æœ‰å¤šç§è¿‡æ»¤å™¨ï¼Œæ‚¨å¯èƒ½ä¼šæå–æˆ–è§‚å¯Ÿåˆ°æ›´å…·é‰´åˆ«æ€§çš„ç©ºé—´è¦ç´ å’Œç»å¸¸é‡å¤å‡ºç°çš„ç›¸é‚»å€¼ã€‚è¯¥æ–¹æ¡ˆé€šè¿‡ä¸ä»…ä»¥æœ€å°‘çš„ä¿¡æ¯æŸå¤±ä¿æŒç©ºé—´ç‰¹å¾ï¼Œè€Œä¸”æ˜¾è‘—åœ°å‡å°‘æ‰€éœ€çš„æƒé‡æ•°é‡æ¥å¢å¼ºå­¦ä¹ ï¼Œä½¿å¾—å›¾åƒåˆ†ç±»å®é™…ä¸Šå¯è¡Œå¹¶ä¸”å¯æ‰©å±•ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€å¹… 2D é»‘ç™½(b &amp; w)å›¾åƒä½œä¸º CNN çš„è¾“å…¥ã€‚è¯¥æ¨¡å‹é€šè¿‡ä½¿ç”¨<strong class="la iu">æ»¤æ³¢å™¨</strong>å¼€å§‹å·ç§¯å›¾åƒï¼Œç„¶åä»¥ç»™å®šçš„æ­¥é•¿æ»‘è¿‡å›¾åƒï¼Œä¹Ÿç§°ä¸º<strong class="la iu">æ­¥é•¿</strong>ã€‚æ»¤æ³¢å™¨å€¼ç±»ä¼¼äºç¥ç»ç½‘ç»œä¸­çš„æƒé‡ã€‚åœ¨ä¸€ä¸ªå®ä¾‹ä¸­ï¼Œè¿™äº›æ»¤æ³¢å™¨å€¼å’Œå›¾åƒçš„å‰æ™¯åƒç´ å€¼çš„çº¿æ€§ç»„åˆç”Ÿæˆå•ä¸ª<strong class="la iu">ç‰¹å¾è¾“å‡º</strong>ã€‚ç”Ÿæˆçš„ä¸€ç»„è¿™äº›å€¼äº§ç”Ÿä¸€ä¸ªæ–°å±‚ï¼Œç§°ä¸º<strong class="la iu">ç‰¹å¾å›¾</strong>ã€‚ç›´è§‚åœ°è¯´ï¼Œç‰¹å¾å›¾æ˜¯è¾“å…¥å›¾åƒçš„æµ“ç¼©å½¢å¼ï¼Œå®ƒå°†æ‰€æœ‰ä¸»è¦ç‰¹å¾å’Œæ¨¡å¼ä¿ç•™åœ¨è¾ƒå°çš„ç»´åº¦ä¸­ï¼Œä»¥ä¾¿æœ‰æ•ˆå­¦ä¹ ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/4ad577fb98f70677c07811a9fee8b650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*P2VVkQrXbOYBeq2p94kvFA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">å›¾ 3ã€‚å·ç§¯æ–¹æ¡ˆ(<em class="mx">å›¾ç‰‡ä½œè€…</em></p></figure><p id="5016" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œåœ¨å›¾ 3 ä¸­ï¼Œåœ¨å°ºå¯¸ä¸º 10X10 çš„é»‘ç™½å›¾åƒä¸Šä½¿ç”¨äº†å°ºå¯¸ä¸º 4x4 çš„æ»¤æ³¢å™¨ã€‚æ»¤é•œä»¥ 1 ä¸ªå•ä½çš„æ­¥å¹…åœ¨å›¾åƒä¸Šæ»‘åŠ¨ï¼Œä»è€Œç”Ÿæˆä¸€ä¸ªç»´åº¦ä¸º(10â€“4+1)X(10â€“4+1)çš„å›æ—‹å±‚ï¼Œå³ 7X7ã€‚æ³¨æ„ï¼Œæœ¬ä¾‹ä¸­çš„åå·®/æˆªè·å‡å®šä¸º 0ã€‚ç±»ä¼¼åœ°ï¼Œ<em class="mz"> n </em>ä¸ªæ»¤æ³¢å™¨å°†ç”Ÿæˆ<em class="mz"> n </em>ä¸ªç‰¹å¾å›¾ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/d91808036220e3e5ce8dd0f55f5f4ee8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*TschuXC8X14VZJS2b7Hq2Q.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">å›¾ 3ã€‚å½©è‰²å›¾åƒçš„å·ç§¯(ä½œè€…çš„<em class="mx">å›¾åƒ)</em></p></figure><p id="1008" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">å¯¹äºé»‘ç™½å›¾åƒï¼Œæ·±åº¦ä¸º 1ï¼Œå› æ­¤æ»¤é•œçš„æ·±åº¦ä¸º 1ã€‚ç„¶è€Œï¼Œå½©è‰²å›¾åƒæ˜¯çº¢è‰²ã€è“è‰²å’Œç»¿è‰²(RBG)é€šé“çš„é›†åˆã€‚ç¡®åˆ‡åœ°è¯´ï¼Œæ˜¯ä¸‰ä¸ª 2D å±‚çš„å †å ï¼Œå…¶ä¸­æ¯ä¸€å±‚ä»£è¡¨ç‰¹å®šé¢œè‰²é€šé“çš„å¼ºåº¦ã€‚æ‰€ä»¥å¯¹äºæ·±åº¦ä¸º 3 çš„å½©è‰²å›¾åƒï¼Œä½ éœ€è¦ä¸€ä¸ªå°ºå¯¸ä¸º(4X4)X <strong class="la iu"> 3 çš„æ»¤é•œ(</strong>å›¾ 4)ã€‚</p><p id="bae5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ä¸€æ—¦ç”Ÿæˆäº†ç‰¹å¾å›¾ï¼Œå°±å¯¹å®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªåº”ç”¨ä¸€ä¸ª<strong class="la iu">æ¿€æ´»å‡½æ•°</strong>ã€‚ä¸ºæ­¤ï¼Œ<strong class="la iu">æ•´æµçº¿æ€§å•å…ƒ(ReLU) </strong>æ¿€æ´»åŠŸèƒ½<strong class="la iu"> </strong>å°±æ´¾ä¸Šäº†ç”¨åœºã€‚å¦‚æœ ReLU çš„è¾“å…¥æ˜¯ä¸€ä¸ªè´Ÿå€¼ï¼Œå®ƒå°±ç®€å•åœ°å°†å®ƒè½¬æ¢ä¸ºé›¶ï¼Œå¦åˆ™å®ƒå°†è¾“å‡ºå®Œå…¨ç›¸åŒçš„è¾“å…¥å€¼(å›¾ 4)ã€‚æ•°å­¦ä¸Šï¼Œ<em class="mz"> f(x)= max(0ï¼Œx)ã€‚</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/651e8f7577edb1f7f497de64b679ac10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*cmGESKfSZLH2ksqF_kBgfQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">å›¾ 5ã€‚ReLU å’Œ Max Pooling ( <em class="mx">å›¾ç‰‡ä½œè€…</em>)</p></figure><p id="79d6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">åœ¨æ¿€æ´»å±‚ä¹‹åï¼Œå¦ä¸€ç§æ–¹æ¡ˆè¢«ç”¨æ¥åœ¨ä¸ä¸¢å¤±é‡è¦ä¿¡æ¯çš„æƒ…å†µä¸‹çµæ´»åœ°é™ä½ç‰¹å¾å›¾çš„ç»´æ•°ã€‚è¿™ç§æŠ€æœ¯è¢«ç§°ä¸º<strong class="la iu">æœ€å¤§æ± </strong>ã€‚ä¸å·ç§¯æ–¹æ¡ˆéå¸¸ç›¸ä¼¼ï¼Œè¿™é‡Œåªé€‰å–æœ€å¤§æ± çª—å£ä¸­çš„æœ€é«˜å€¼ã€‚è¯¥çª—å£ä»¥ä¸è¿‡æ»¤å™¨ç›¸åŒçš„æ–¹å¼æ»‘åŠ¨ï¼Œä½†æ˜¯æ­¥é•¿ç­‰äºæ± çª—å£çš„å°ºå¯¸(å›¾ 5)ã€‚æœ€å¤§æ± æ˜¾è‘—é™ä½äº†ç‰¹å¾å›¾çš„ç»´åº¦ï¼ŒåŒæ—¶è¿˜ä¿ç•™äº†é‡è¦çš„/ä¸»è¦çš„ç‰¹å¾ã€‚æœ€ç»ˆçš„æœ€å¤§æ± å±‚ç„¶åè¢«æŒ¤å‹å’Œå±•å¹³æˆç¥ç»å…ƒå±‚ï¼Œè¯¥ç¥ç»å…ƒå±‚è¿æ¥åˆ°å®Œå…¨è¿æ¥çš„ç¥ç»ç½‘ç»œä»¥æ‰§è¡Œåˆ†ç±»ä»»åŠ¡ã€‚</p><p id="046a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¯·æ³¨æ„ï¼ŒCNN å¹¶ä¸å±€é™äºå•ä¸ªå·ç§¯æˆ–ä¸€ç»„ä¸Šè¿°æ–¹æ¡ˆã€‚æœ‰è¶³å¤Ÿæ•°é‡çš„è¿‡æ»¤å™¨æ”¯æŒï¼Œä½ çš„ç½‘ç»œè¶Šæ·±å…¥ï¼Œå®ƒå°†å®ç°æ›´é«˜çš„æ€§èƒ½ã€‚ç›´è§‚åœ°è¯´ï¼Œåˆå§‹å·ç§¯å°†æ•è·ä½çº§çš„å¾ªç¯ç‰¹å¾ï¼Œä¾‹å¦‚è¾¹ç¼˜å’Œé¢œè‰²ã€‚éšåï¼Œæ·±å±‚å¾€å¾€ä¼šæ•æ‰é«˜çº§ç‰¹å¾ï¼Œå¦‚é‡å¤å‡ºç°çš„åƒç´ ç°‡ï¼Œå¦‚è‚–åƒä¸­çš„çœ¼ç›æˆ–é¼»å­ã€‚æ‰€ä»¥ï¼Œæ€»ä¹‹ï¼ŒåŸºäºä½ çš„å›¾åƒå¤æ‚æ€§å’Œè®¡ç®—èƒ½åŠ›ï¼Œä½ åº”è¯¥é€‰æ‹©è¶³å¤Ÿçš„æœ‰æ•ˆæ•°é‡çš„å±‚å’Œè¿‡æ»¤å™¨ã€‚</p><p id="f7bd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹åˆ¶ä½œæˆ‘ä»¬çš„ç©å…·æ¨¡å‹ğŸ¤“ï¼ï¼</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h2 id="5206" class="md me it bd mf mg mh dn mi mj mk dp ml lh mm mn mo ll mp mq mr lp ms mt mu mv bi translated">æ•°æ®é›†</h2><p id="91b7" class="pw-post-body-paragraph ky kz it la b lb nj ju ld le nk jx lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">æˆ‘ç›¸ä¿¡ï¼Œè¦ç†è§£ä»»ä½•ç»Ÿè®¡æ¦‚å¿µï¼Œæ²¡æœ‰ä»€ä¹ˆæ¯”ä¸€å‰¯æ‰‘å…‹ç‰Œæ›´å®¹æ˜“çš„äº†ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å°†åˆ©ç”¨ä¸€å‰¯æ‰‘å…‹ç‰Œï¼Œä½†åœ¨ä¸€ä¸ªç¨å¾®éæ­£ç»Ÿçš„å½¢å¼ã€‚æ˜¯çš„ï¼Œä½ çŒœå¯¹äº†ï¼ï¼æˆ‘å°†åˆ¶ä½œä¸€ä¸ªé¢„æµ‹æ¨¡å‹ï¼Œå®ƒåº”è¯¥èƒ½å¤Ÿå‡†ç¡®åœ°åˆ†ç±»å’Œé¢„æµ‹ä»»ä½•ä»»æ„éæ­£é¢æ‰‘å…‹ç‰Œçš„ç»™å®šå›¾åƒçš„èŠ±è‰²ã€‚</p><p id="d92c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae no" href="https://github.com/AbhibhavS/CNN-Toy-model" rel="noopener ugc nofollow" target="_blank">è¯¥æ•°æ®é›†</a>åŒ…å«æ¯ç§èŠ±è‰²çš„ä¸€ç»„ 43 å¼ çº¸ç‰Œå›¾åƒ<em class="mz">ï¼Œå³</em>æ¢…èŠ±â™£ã€çº¢å¿ƒâ™¥ï¸ã€æ–¹å—â™¦ï¸å’Œé»‘æ¡ƒâ™ ï¸ã€‚è¯·æ³¨æ„ï¼Œæ¯ç§èŠ±è‰²çš„ç¬¦å·éƒ½éµå¾ªæ ‡å‡†çš„å½¢çŠ¶ï¼Œä½†æ˜¯è¿™äº›ç¬¦å·çš„è®¾è®¡å’Œæ’åˆ—å› å¡è€Œå¼‚ã€‚æˆ‘ä»¬å°†ç»“åˆè¿™ä¸ªæ•°æ®é›†æ¥è®­ç»ƒå’Œæµ‹è¯•æˆ‘ä»¬çš„æ¨¡å‹ã€‚(ä¸ºäº†æ–¹ä¾¿åœ°éµå¾ªè„šæœ¬ï¼Œæˆ‘å»ºè®®æ‚¨ä¸‹è½½å›¾åƒï¼Œå¹¶å°†æ‰€æœ‰æ–‡ä»¶ä¿å­˜åœ¨ä¸€ä¸ªçˆ¶æ–‡ä»¶ä¸­ï¼Œå°±åƒå®ƒä»¬å‡ºç°åœ¨ Github å­˜å‚¨åº“ä¸­ä¸€æ ·)</p><h2 id="a3e9" class="md me it bd mf mg mh dn mi mj mk dp ml lh mm mn mo ll mp mq mr lp ms mt mu mv bi translated">éœ€è¦è½¯ä»¶åŒ…å’Œå®‰è£…</h2><p id="84fc" class="pw-post-body-paragraph ky kz it la b lb nj ju ld le nk jx lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">å¯¹äºè¿™ä¸ªä»»åŠ¡ï¼Œä½ éœ€è¦ Keras å’Œ<a class="ae no" href="https://bioconductor.org/packages/release/bioc/html/EBImage.html" rel="noopener ugc nofollow" target="_blank"> <em class="mz"> EBImage </em> </a> <em class="mz">åŒ…</em>ã€‚å‰è€…å¯ä» cran çŸ¥è¯†åº“ä¸­è·å¾—ã€‚åè€…ç”¨äºæœ‰æ•ˆå¤„ç†å›¾åƒï¼Œå¯ä»¥ä»ä¸€ä¸ªåä¸º<a class="ae no" href="https://bioconductor.org/" rel="noopener ugc nofollow" target="_blank"> Bioconductor </a>çš„å¼€æºè½¯ä»¶ä¸­è°ƒç”¨ã€‚è¿™äº›å¯ä»¥å®‰è£…åœ¨ Windows æ“ä½œç³»ç»Ÿä¸Šï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="0918" class="md me it nq b gy nu nv l nw nx">install.packages(â€œkerasâ€) # Install the package from CRAN<br/>library(keras)<br/>install_keras() #to setup the Keras library and TensorFlow backend</span><span id="df47" class="md me it nq b gy ny nv l nw nx">if (!requireNamespace(â€œBiocManagerâ€, quietly = TRUE))<br/>install.packages(â€œBiocManagerâ€)<br/>BiocManager::install(â€œEBImageâ€)<br/>library(EBImage)</span></pre><p id="0a0e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¿™å°†å®‰è£… Keras API çš„ CPU ç‰ˆæœ¬ï¼Œç›®å‰æ¨èæ–°æ‰‹ä½¿ç”¨ã€‚</p><p id="7f33" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> <em class="mz">æ³¨æ„:</em></strong><em class="mz">Keras API å°†éœ€è¦ Python æ”¯æŒå’Œ R tools æ’ä»¶ã€‚å› æ­¤ï¼Œè¯·ç¡®ä¿åœ¨æ‚¨çš„æœºå™¨ä¸Šå®‰è£…äº† anaconda å’Œ R å·¥å…·ï¼Œå¹¶å°†å…¶æ­£ç¡®æ·»åŠ åˆ°æ‚¨çš„ç³»ç»Ÿè·¯å¾„ä¸­ã€‚</em></p><h2 id="1fa3" class="md me it bd mf mg mh dn mi mj mk dp ml lh mm mn mo ll mp mq mr lp ms mt mu mv bi translated">æ¢ç´¢æ•°æ®é›†</h2><p id="81b8" class="pw-post-body-paragraph ky kz it la b lb nj ju ld le nk jx lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æŠŠæ¯å¥—è¡£æœçš„å›¾åƒè½¬æ¢æˆä¸€ä¸ªå¼ é‡(ç¼–å·çŸ©é˜µ)ã€‚EBImage åº“ä¸­çš„ readImage() å‡½æ•°å¯ä»¥å¾ˆå¥½åœ°åšåˆ°è¿™ä¸€ç‚¹ã€‚è®©æˆ‘ä»¬è¯•ç€ä»æ•°æ®é›†ä¸­è¯»å–ä¸€å¹…å›¾åƒã€‚</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="ad1e" class="md me it nq b gy nu nv l nw nx">setwd(â€œC:/parent/spadeâ€) # To access the images of Spades suit.<br/>                         # The path should be modified as per your <br/>                         # machine</span><span id="2abb" class="md me it nq b gy ny nv l nw nx">card&lt;-readImage(â€œace_of_spades (2).pngâ€) # Reading an imgae from the<br/>                                         # dataset<br/>print(card) # Print the details of image</span></pre><p id="18e4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¿™ç»™å‡ºäº†å¦‚ä¸‹è¾“å‡º:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="62a6" class="md me it nq b gy nu nv l nw nx">Image <br/>colorMode : Color <br/>storage.mode : double <br/>dim : 500 726 4 <br/>frames.total : 4 <br/>frames.render: 1</span><span id="1853" class="md me it nq b gy ny nv l nw nx">imageData(object)[1:5,1:6,1]<br/>[,1] [,2] [,3] [,4] [,5] [,6]<br/>[1,] 1 1 1 1 1 1<br/>[2,] 1 1 1 1 1 1<br/>[3,] 1 1 1 1 1 1<br/>[4,] 1 1 1 1 1 1<br/>[5,] 1 1 1 1 1 1</span></pre><p id="0980" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¿™è¡¨ç¤ºå›¾åƒçš„é¢œè‰²å°ºå¯¸ä¸º 500 X 726 X 4ã€‚æ³¨æ„ï¼Œæ­£å¦‚æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„ï¼Œè¿™é‡Œå›¾åƒæ·±åº¦æ˜¯ 4ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ·±åº¦ä¸º 4 çš„è¿‡æ»¤å™¨ã€‚ä¸ºäº†æ­ç¤ºè¿™å››ä¸ªçŸ©é˜µï¼Œæˆ‘ä»¬ä½¿ç”¨:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="41ef" class="md me it nq b gy nu nv l nw nx">getFrames(card, type=â€totalâ€)</span></pre><p id="2aa3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¿™å°†åˆ†åˆ«ç»™å‡ºå››ä¸ªé€šé“çš„è¯¦ç»†ä¿¡æ¯ã€‚</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="cdc5" class="md me it nq b gy nu nv l nw nx">[[1]]<br/>Image <br/>colorMode : Grayscale <br/>storage.mode : double <br/>dim : 500 726 <br/>frames.total : 1 <br/>frames.render: 1</span><span id="d4f6" class="md me it nq b gy ny nv l nw nx">imageData(object)[1:5,1:6]<br/>[,1] [,2] [,3] [,4] [,5] [,6]<br/>[1,] 1 1 1 1 1 1<br/>[2,] 1 1 1 1 1 1<br/>[3,] 1 1 1 1 1 1<br/>[4,] 1 1 1 1 1 1<br/>[5,] 1 1 1 1 1 1</span><span id="3585" class="md me it nq b gy ny nv l nw nx">[[2]]<br/>Image <br/>colorMode : Grayscale <br/>storage.mode : double <br/>dim : 500 726 <br/>frames.total : 1 <br/>frames.render: 1</span><span id="f6b6" class="md me it nq b gy ny nv l nw nx">imageData(object)[1:5,1:6]<br/>[,1] [,2] [,3] [,4] [,5] [,6]<br/>[1,] 1 1 1 1 1 1<br/>[2,] 1 1 1 1 1 1<br/>[3,] 1 1 1 1 1 1<br/>[4,] 1 1 1 1 1 1<br/>[5,] 1 1 1 1 1 1</span><span id="9413" class="md me it nq b gy ny nv l nw nx">[[3]]<br/>Image <br/>colorMode : Grayscale <br/>storage.mode : double <br/>dim : 500 726 <br/>frames.total : 1 <br/>frames.render: 1</span><span id="d894" class="md me it nq b gy ny nv l nw nx">imageData(object)[1:5,1:6]<br/>[,1] [,2] [,3] [,4] [,5] [,6]<br/>[1,] 1 1 1 1 1 1<br/>[2,] 1 1 1 1 1 1<br/>[3,] 1 1 1 1 1 1<br/>[4,] 1 1 1 1 1 1<br/>[5,] 1 1 1 1 1 1</span><span id="ee23" class="md me it nq b gy ny nv l nw nx">[[4]]<br/>Image <br/>colorMode : Grayscale <br/>storage.mode : double <br/>dim : 500 726 <br/>frames.total : 1 <br/>frames.render: 1</span><span id="6730" class="md me it nq b gy ny nv l nw nx">imageData(object)[1:5,1:6]<br/>[,1] [,2] [,3] [,4] [,5] [,6]<br/>[1,] 0 0 0 0 0 0<br/>[2,] 0 0 0 0 0 0<br/>[3,] 0 0 0 0 0 0<br/>[4,] 0 0 0 0 0 0<br/>[5,] 0 0 0 0 0 0</span></pre><p id="62e1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">å“¦è€¶ï¼ä¸ºäº†é˜æ˜æˆ‘ä»¬é€‰æ‹©çš„å¡ï¼Œæˆ‘ä»¬:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/4489e00e9ab3704a6798459c124c768f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3tqq6Cru6FozSKGk1radzA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">å›¾ 6ã€‚æ˜¾ç¤ºåœ¨ R æŸ¥çœ‹å™¨ä¸­çš„æ‰€é€‰å¡ç‰‡(<em class="mx">ä½œè€…å›¾ç‰‡</em>)</p></figure><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="f6cb" class="md me it nq b gy nu nv l nw nx">display(card)</span></pre><p id="8a94" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">å°½ç®¡æ•°æ®é›†ä¸­æ¯å¼ å¡ç‰‡çš„æ·±åº¦éƒ½ç›¸åŒï¼Œä½†åƒç´ å°ºå¯¸å´å„ä¸ç›¸åŒï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»å°†æ¯å¼ å¡ç‰‡çš„å°ºå¯¸è°ƒæ•´ä¸º 100x100x4ï¼Œå¹¶å°†å®ƒä»¬ç»„åˆåœ¨ä¸€ä¸ªä¸ Keras å…¼å®¹çš„å †æ ˆä¸­ã€‚è¿™ä¸ªå †æ ˆç„¶åç›´æ¥è¿›å…¥æ¶æ„ä½œä¸ºè¾“å…¥ã€‚</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="cdba" class="md me it nq b gy nu nv l nw nx">setwd(â€œC:/parent/clubâ€) # To access the images of Clubs suit.<br/>                        # The path should be modified as per your <br/>                        # machine</span><span id="b920" class="md me it nq b gy ny nv l nw nx">img.card&lt;- sample(dir()); #-------shuffle the order<br/>cards&lt;-list(NULL);        <br/>for(i in 1:length(img.card))<br/>{ cards[[i]]&lt;- readImage(img.card[i])<br/> cards[[i]]&lt;- resize(cards[[i]], 100, 100)} #resizing to 100x100</span><span id="f940" class="md me it nq b gy ny nv l nw nx">club&lt;- cards              # Storing stack of the Clubs cards in<br/>                          # matrix form in a list<br/>#-----------------------------------------------------------</span><span id="3bff" class="md me it nq b gy ny nv l nw nx">setwd(â€œC:/parent/heartâ€)# To access the images of Hearts suit.<br/>                        # The path should be modified as per your <br/>                        # machine</span><span id="4f10" class="md me it nq b gy ny nv l nw nx">img.card&lt;- sample(dir());<br/>cards&lt;-list(NULL);<br/>for(i in 1:length(img.card))<br/> { cards[[i]]&lt;- readImage(img.card[i])<br/>cards[[i]]&lt;- resize(cards[[i]], 100, 100)} #resizing to 100x100</span><span id="8d18" class="md me it nq b gy ny nv l nw nx">heart&lt;- cards             # Storing stack of the Hearts cards in<br/>                          # matrix form in a list<br/>#------------------------------------------------------------</span><span id="51b3" class="md me it nq b gy ny nv l nw nx">setwd(â€œC:/parent/spadeâ€)# To access the images of Spades suit.<br/>                        # The path should be modified as per your <br/>                        # machine</span><span id="9b44" class="md me it nq b gy ny nv l nw nx">img.card&lt;- sample(dir());<br/>cards&lt;-list(NULL);<br/>for(i in 1:length(img.card))<br/>{ cards[[i]]&lt;- readImage(img.card[i])<br/>cards[[i]]&lt;- resize(cards[[i]], 100, 100)} #resizing to 100x100</span><span id="42dd" class="md me it nq b gy ny nv l nw nx">spade&lt;- cards             # Storing stack of the Spades cards in<br/>                          # matrix form in a list<br/>#------------------------------------------------------------</span><span id="b28c" class="md me it nq b gy ny nv l nw nx">setwd(â€œC:/parent/diamondâ€) # To access the images of Diamonds suit.<br/>                           #The path should be modified as per your <br/>                           # machine<br/>img.card&lt;- sample(dir());<br/>cards&lt;-list(NULL);<br/>for(i in 1:length(img.card))<br/>{ cards[[i]]&lt;- readImage(img.card[i])<br/>cards[[i]]&lt;- resize(cards[[i]], 100, 100)} #resizing to 100x100<br/>diamond&lt;- cards           # Storing stack of the Diamonds cards in<br/>                          # matrix form in a list<br/>#-------------------------------------------------------------</span><span id="4011" class="md me it nq b gy ny nv l nw nx">train_pool&lt;-c(club[1:40], <br/>              heart[1:40], <br/>              spade[1:40], <br/>              diamond[1:40]) # Vector of all the training images. <br/>                             # The first 40 images from each suit <br/>                             # are included in the train set</span><span id="5ea6" class="md me it nq b gy ny nv l nw nx">train&lt;-aperm(combine(train_pool), c(4,1,2,3)) # Combine and stacked</span><span id="e02f" class="md me it nq b gy ny nv l nw nx">test_pool&lt;-c(club[41:43], <br/>             heart[41:43], <br/>             spade[41:43], <br/>             diamond[41:43]) # Vector of all test images. The last<br/>                             # 3 images from each suit is included<br/>                             # in test set</span><span id="bed5" class="md me it nq b gy ny nv l nw nx">test&lt;-aperm(combine(test_pool), c(4,1,2,3)) # Combined and stacked</span></pre><blockquote class="oa ob oc"><p id="ce85" class="ky kz mz la b lb lc ju ld le lf jx lg od li lj lk oe lm ln lo of lq lr ls lt im bi translated">ä¸ºäº†æŸ¥çœ‹æµ‹è¯•é›†ä¸­åŒ…å«äº†å“ªäº›å›¾åƒï¼Œæˆ‘ä»¬è¿™æ ·åš:</p></blockquote><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="13a2" class="md me it nq b gy nu nv l nw nx">par(mfrow=c(3,4)) # To contain all images in single frame<br/>for(i in 1:12){<br/>  plot(test_pool[[i]])<br/>  }<br/>par(mfrow=c(1,1)) # Reset the default</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/3476b76476eb226d9b4f725c80c41a23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-HTwUQpRskvkTBG-zO8S7g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">å›¾ 8ã€‚æµ‹è¯•é›†(<em class="mx">ä½œè€…å›¾ç‰‡</em>)</p></figure><blockquote class="oa ob oc"><p id="ba06" class="ky kz mz la b lb lc ju ld le lf jx lg od li lj lk oe lm ln lo of lq lr ls lt im bi translated">æˆ‘å¾—åˆ°äº†å¦‚å›¾ 8 æ‰€ç¤ºçš„å¡ç‰‡ã€‚å¯¹ä½ æ¥è¯´å¯èƒ½æ˜¯ä¸€å¥—ä¸åŒçš„å¡ç‰‡ã€‚</p></blockquote><p id="0ed8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">éœ€è¦ä¸€ä¸ªçƒ­ç¼–ç </strong>æ¥åˆ›å»ºå¯¹åº”äºè¾“å…¥æ•°æ®çš„åˆ†ç±»å‘é‡ã€‚</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="06d0" class="md me it nq b gy nu nv l nw nx">#one hot encoding<br/>train_y&lt;-c(rep(0,40),rep(1,40),rep(2,40),rep(3,40))<br/>test_y&lt;-c(rep(0,3),rep(1,3),rep(2,3),rep(3,3))</span><span id="36b7" class="md me it nq b gy ny nv l nw nx">train_lab&lt;-to_categorical(train_y) #Catagorical vector for training <br/>                                   #classes<br/>test_lab&lt;-to_categorical(test_y)#Catagorical vector for test classes</span></pre><h1 id="4f98" class="oh me it bd mf oi oj ok mi ol om on ml jz oo ka mo kc op kd mr kf oq kg mu or bi translated">è®©æˆ‘ä»¬æ¥æ„å»ºæ¶æ„</h1><p id="2214" class="pw-post-body-paragraph ky kz it la b lb nj ju ld le nk jx lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">ä¸‹é¢æ˜¯æ„å»º CNN æ¨¡å‹çš„ R è„šæœ¬ã€‚æˆ‘è¿˜æä¾›äº†ä¸€ä¸ªå…¨é¢çš„åŠ¨ç”»ï¼Œæ¼”ç¤ºäº†è„šæœ¬è¿è¡Œçš„è¿‡ç¨‹(å›¾ 9)ã€‚</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="7488" class="md me it nq b gy nu nv l nw nx"># Model Building</span><span id="ae1c" class="md me it nq b gy ny nv l nw nx">model.card&lt;- keras_model_sequential() #-Keras Model composed of a <br/>                                      #-----linear stack of layers</span><span id="e7b1" class="md me it nq b gy ny nv l nw nx">model.card %&gt;%                   #---------Initiate and connect to #----------------------------(A)-----------------------------------#</span><span id="f084" class="md me it nq b gy ny nv l nw nx">layer_conv_2d(filters = 40,       #----------First convoluted layer<br/> kernel_size = c(4,4),             #---40 Filters with dimension 4x4<br/> activation = â€˜reluâ€™,              #-with a ReLu activation function<br/> input_shape = c(100,100,4)) %&gt;%   <br/>#----------------------------(B)-----------------------------------#</span><span id="1c60" class="md me it nq b gy ny nv l nw nx">layer_conv_2d(filters = 40,       #---------Second convoluted layer<br/> kernel_size = c(4,4),             #---40 Filters with dimension 4x4<br/> activation = â€˜reluâ€™) %&gt;%          #-with a ReLu activation function<br/>#---------------------------(C)-----------------------------------#</span><span id="879d" class="md me it nq b gy ny nv l nw nx">layer_max_pooling_2d(pool_size = c(4,4) )%&gt;%   #--------Max Pooling<br/>#-----------------------------------------------------------------#</span><span id="0d27" class="md me it nq b gy ny nv l nw nx">layer_dropout(rate = 0.25) %&gt;%   #-------------------Drop out layer<br/>#----------------------------(D)-----------------------------------#</span><span id="9a8b" class="md me it nq b gy ny nv l nw nx">layer_conv_2d(filters = 80,      #-----------Third convoluted layer<br/> kernel_size = c(4,4),            #----80 Filters with dimension 4x4<br/> activation = â€˜reluâ€™) %&gt;%         #--with a ReLu activation function<br/>#-----------------------------(E)----------------------------------#</span><span id="930e" class="md me it nq b gy ny nv l nw nx">layer_conv_2d(filters = 80,      #----------Fourth convoluted layer<br/> kernel_size = c(4,4),            #----80 Filters with dimension 4x4<br/> activation = â€˜reluâ€™) %&gt;%         #--with a ReLu activation function<br/>#-----------------------------(F)----------------------------------#</span><span id="d2b8" class="md me it nq b gy ny nv l nw nx">layer_max_pooling_2d(pool_size = c(4,4)) %&gt;%  #---------Max Pooling<br/>#-----------------------------------------------------------------#</span><span id="93ab" class="md me it nq b gy ny nv l nw nx">layer_dropout(rate = 0.35) %&gt;%   #-------------------Drop out layer<br/>#------------------------------(G)---------------------------------#</span><span id="91b3" class="md me it nq b gy ny nv l nw nx">layer_flatten()%&gt;%   #---Flattening the final stack of feature maps<br/>#------------------------------(H)---------------------------------#</span><span id="0f57" class="md me it nq b gy ny nv l nw nx">layer_dense(units = 256, activation = â€˜reluâ€™)%&gt;% #-----Hidden layer<br/>#---------------------------(I)-----------------------------------#</span><span id="bb16" class="md me it nq b gy ny nv l nw nx">layer_dropout(rate= 0.25)%&gt;%     #-------------------Drop-out layer<br/>#-----------------------------------------------------------------#</span><span id="2050" class="md me it nq b gy ny nv l nw nx">layer_dense(units = 4, activation = â€œsoftmaxâ€)%&gt;% #-----Final Layer<br/>#----------------------------(J)-----------------------------------#</span><span id="f422" class="md me it nq b gy ny nv l nw nx">compile(loss = 'categorical_crossentropy',<br/>          optimizer = optimizer_adam(),<br/>          metrics = c("accuracy"))   # Compiling the architecture</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/b75ec44139a3768ea0066e6c65053fd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*c2u1oBGbQ0w4mnbEh6Ewjw.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">å›¾ 8ã€‚è¯´æ˜æ¨¡å‹åˆ›å»º<strong class="bd os"> ( <em class="mx">ä½œè€…å›¾ç‰‡</em> ) </strong></p></figure><p id="49c7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="mz">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨</em><strong class="la iu"><em class="mz">summary(model . card)</em></strong><em class="mz">å¾—åˆ°è¿™ä¸ªæ¨¡å‹çš„æ¦‚è¦ã€‚è¿™æ ·çš„è¾“å‡ºå°†æ˜¯ä¸€ä¸ªç®€æ´æ˜äº†çš„æ¨¡å‹æ€»ç»“ã€‚</em></p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="c3dc" class="md me it nq b gy nu nv l nw nx">Model: â€œsequentialâ€<br/>____________________________________________________________________<br/>Layer (type) Output Shape Param # <br/>====================================================================<br/>conv2d (Conv2D) (None, 97, 97, 40) 2600 <br/>____________________________________________________________________<br/>conv2d_1 (Conv2D) (None, 94, 94, 40) 25640 <br/>____________________________________________________________________<br/>max_pooling2d (MaxPooling2D) (None, 23, 23, 40) 0 <br/>____________________________________________________________________<br/>dropout (Dropout) (None, 23, 23, 40) 0 <br/>____________________________________________________________________<br/>conv2d_2 (Conv2D) (None, 20, 20, 80) 51280 <br/>____________________________________________________________________<br/>conv2d_3 (Conv2D) (None, 17, 17, 80) 102480 <br/>____________________________________________________________________<br/>max_pooling2d_1 (MaxPooling2D) (None, 4, 4, 80) 0 <br/>____________________________________________________________________<br/>dropout_1 (Dropout) (None, 4, 4, 80) 0<br/>____________________________________________________________________<br/>flatten (Flatten) (None, 1280) 0 <br/>____________________________________________________________________<br/>dense (Dense) (None, 256) 327936 <br/>____________________________________________________________________<br/>dropout_2 (Dropout) (None, 256) 0 <br/>____________________________________________________________________<br/>dense_1 (Dense) (None, 4) 1028 <br/>====================================================================<br/>Total params: 510,964<br/>Trainable params: 510,964<br/>Non-trainable params: 0<br/>____________________________________________________________________</span></pre><h2 id="df74" class="md me it bd mf mg mh dn mi mj mk dp ml lh mm mn mo ll mp mq mr lp ms mt mu mv bi translated">æ¨¡å‹æ‹Ÿåˆ</h2><p id="3cd8" class="pw-post-body-paragraph ky kz it la b lb nj ju ld le nk jx lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">ä¸€æ—¦æ„å»ºäº†æ¶æ„ï¼Œå°±è¯¥è®©æ•°æ®é›†é€‚åˆæ¨¡å‹çš„è®­ç»ƒäº†ã€‚æ‹Ÿåˆè¿‡ç¨‹å¦‚ä¸‹:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="b86c" class="md me it nq b gy nu nv l nw nx">#fit model<br/>history&lt;- model.card %&gt;%<br/> fit(train, <br/> train_lab, <br/> epochs = 100,<br/> batch_size = 40,<br/> validation_split = 0.2<br/> )</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/7df62f6e711375128b1402f3aee08472.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E8ZnYzxkuzy-QAzV5cuAvA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">å›¾ 9 ( <em class="mx">ä½œè€…å›¾ç‰‡</em>)</p></figure><p id="4492" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è£…é…æ—¶ï¼Œæ¯ä¸ª<strong class="la iu">æ—¶æœŸ</strong>(å‰é¦ˆ-åé¦ˆ)å°†å‡ºç°åœ¨æ§åˆ¶å°åŒºåŸŸã€‚å¤„ç†æ—¶é—´å¯èƒ½å› æœºå™¨è€Œå¼‚ã€‚å½“ epochs è¿è¡Œæ—¶ï¼Œæ‚¨åº”è¯¥ä¼šåœ¨ Rstudio æŸ¥çœ‹å™¨ä¸­çœ‹åˆ°ä¸€ä¸ªå›¾å½¢(å›¾ 9)ã€‚è¿™äº›æ˜¯è®­ç»ƒé›†å’ŒéªŒè¯é›†çš„æŸå¤±å’Œå‡†ç¡®æ€§çš„å¹¶åˆ—æ›²çº¿ã€‚</p><p id="2c7f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">æ§åˆ¶å°ä¸­å‡ºç°çš„è¿è¡Œæ—¶æœŸå¦‚ä¸‹æ‰€ç¤º:</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="18c4" class="md me it nq b gy nu nv l nw nx">Train on 128 samples, validate on 32 samples<br/>Epoch 1/100<br/>128/128 [==============================] â€” 10s 78ms/sample â€” loss: 1.3648 â€” accuracy: 0.3281 â€” val_loss: 2.0009 â€” val_accuracy: 0.0000e+00<br/>Epoch 2/100<br/>128/128 [==============================] â€” 8s 59ms/sample â€” loss: 1.3098 â€” accuracy: 0.3359 â€” val_loss: 1.9864 â€” val_accuracy: 0.0000e+00<br/>Epoch 3/100<br/>128/128 [==============================] â€” 8s 61ms/sample â€” loss: 1.2686 â€” accuracy: 0.3516 â€” val_loss: 2.5289 â€” val_accuracy: 0.0000e+00</span></pre><p id="1e75" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="mz">æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹çš„æ€»ç»“å¯ä»¥ç”¨</em> <strong class="la iu"> <em class="mz">ã€å‰§æƒ…(å†å²)</em> </strong> <em class="mz">æ¥ç»˜åˆ¶ã€‚</em></p><h2 id="1672" class="md me it bd mf mg mh dn mi mj mk dp ml lh mm mn mo ll mp mq mr lp ms mt mu mv bi translated">æ¨¡å‹è¯„ä¼°</h2><p id="2219" class="pw-post-body-paragraph ky kz it la b lb nj ju ld le nk jx lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">ä¸€æ—¦è®­ç»ƒç»“æŸã€‚æ˜¯æ—¶å€™è¯„ä¼°æˆ‘ä»¬æ–°è®­ç»ƒçš„æ¨¡å‹äº†ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†æŸ¥çœ‹ moel åœ¨è®­ç»ƒæ•°æ®é›†ä¸Šçš„æ€§èƒ½ï¼Œç„¶åæˆ‘ä»¬å°†æœ€ç»ˆåœ¨æˆ‘ä»¬çš„æµ‹è¯•é›†ä¸Šæµ‹è¯•å’Œè¯„ä¼°æˆ‘ä»¬çš„è®­ç»ƒæ¨¡å‹ã€‚</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="8b66" class="md me it nq b gy nu nv l nw nx">#Model Evaluation</span><span id="46bc" class="md me it nq b gy ny nv l nw nx">model.card %&gt;% evaluate(train,train_lab) #Evaluation of training set pred&lt;- model.card %&gt;% predict_classes(train) #-----Classification<br/>Train_Result&lt;-table(Predicted = pred, Actual = train_y) #----Results</span><span id="3b93" class="md me it nq b gy ny nv l nw nx">model.card %&gt;% evaluate(test, test_lab) #-----Evaluation of test set<br/>pred1&lt;- model.card  %&gt;% predict_classes(test)   #-----Classification<br/>Test_Result&lt;-table(Predicted = pred1, Actual = test_y) #-----Results</span><span id="6e4d" class="md me it nq b gy ny nv l nw nx">rownames(Train_Result)&lt;-rownames(Test_Result)&lt;-colnames(Train_Result)&lt;-colnames(Test_Result)&lt;-c("Clubs", "Hearts", "Spades", "Diamonds")</span><span id="fcae" class="md me it nq b gy ny nv l nw nx">print(Train_Result)<br/>print(Test_Result)</span></pre><p id="80fe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è¿™ä¸ªä¼šåæ§½:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/58562904c7ecfaa428d1645ca16684f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*r7ovB5NexJ_KOYjCntRhuA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(<em class="mx">å›¾ç‰‡ä½œè€…</em>)</p></figure><p id="ed4d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">åœ¨è®­ç»ƒé›†ä¸Š 100%çš„å‡†ç¡®ç‡å¯èƒ½æ˜¯è¿‡åº¦æ‹Ÿåˆçš„è¿¹è±¡ï¼Œä½†æ˜¯è¯·æ³¨æ„ï¼Œæˆ‘ä»¬çš„æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šä¹Ÿè¾¾åˆ°äº† 100%çš„å‡†ç¡®ç‡ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å·²ç»æˆåŠŸåœ°åˆ¶ä½œäº†ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå°†ä¸€ä¸ªç»™å®šçš„çº¸ç‰Œå›¾åƒæ­£ç¡®åœ°åˆ†ç±»åˆ°å®ƒçœŸæ­£çš„èŠ±è‰²ä¸­ã€‚</p></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><p id="2b22" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">å¦‚æœä½ åœ¨è¿™é‡Œï¼Œé‚£ä¹ˆæ­å–œä½ ï¼ï¼ä½ å·²ç»æˆåŠŸåœ°åˆ¶ä½œäº†ä½ çš„å·ç§¯ç¥ç»ç½‘ç»œæ¨¡å‹ã€‚å¸Œæœ›ä½ æ—…é€”æ„‰å¿«ã€‚å¦‚æœä½ å‘ç°ä»»ä½•é”™è¯¯æˆ–ä¸æ­£ç¡®çš„åœ°æ–¹ï¼Œè¯·éšæ—¶è”ç³»æˆ‘ã€‚æˆ‘ä¹Ÿæ¬¢è¿æ‰€æœ‰å¯ä»¥æé«˜æœ¬æ–‡ä»¶è´¨é‡çš„å»ºè®®ã€‚</p><p id="ffb2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">è°¢è°¢ä½ çš„é˜…è¯»å’Œå¿«ä¹çš„ R-ingğŸ˜€</p><h1 id="c17e" class="oh me it bd mf oi oj ok mi ol om on ml jz oo ka mo kc op kd mr kf oq kg mu or bi translated">å…¶ä»–è‘—åè¯»ç‰©</h1><blockquote class="oa ob oc"><p id="0345" class="ky kz mz la b lb lc ju ld le lf jx lg od li lj lk oe lm ln lo of lq lr ls lt im bi translated"><a class="ae no" href="https://medium.com/vsinghbisen/where-is-artificial-intelligence-used-areas-where-ai-can-be-used-14ba8c092e73" rel="noopener">äººå·¥æ™ºèƒ½ç”¨åœ¨å“ªé‡Œ:å¯ä»¥ç”¨ AI çš„é¢†åŸŸ</a></p><p id="ebc1" class="ky kz mz la b lb lc ju ld le lf jx lg od li lj lk oe lm ln lo of lq lr ls lt im bi translated"><a class="ae no" rel="noopener" target="_blank" href="/illustrated-10-cnn-architectures-95d78ace614d#:~:text=AlexNet%20(2012)&amp;text=With%2060M%20parameters%2C%20AlexNet%20has,on%20the%20subsets%20of%20ImageNet.%E2%80%9D">å›¾è§£:10 ä¸ª CNN æ¶æ„</a></p><p id="392b" class="ky kz mz la b lb lc ju ld le lf jx lg od li lj lk oe lm ln lo of lq lr ls lt im bi translated"><a class="ae no" rel="noopener" target="_blank" href="/gentle-dive-into-math-behind-convolutional-neural-networks-79a07dd44cf9">æ·±å…¥äº†è§£å·ç§¯ç¥ç»ç½‘ç»œèƒŒåçš„æ•°å­¦çŸ¥è¯†</a></p><p id="2797" class="ky kz mz la b lb lc ju ld le lf jx lg od li lj lk oe lm ln lo of lq lr ls lt im bi translated"><a class="ae no" rel="noopener" target="_blank" href="/a-comprehensive-guide-to-convolutional-neural-networks-the-eli5-way-3bd2b1164a53">å·ç§¯ç¥ç»ç½‘ç»œç»¼åˆæŒ‡å— ELI5 æ–¹å¼</a></p><p id="97f8" class="ky kz mz la b lb lc ju ld le lf jx lg od li lj lk oe lm ln lo of lq lr ls lt im bi translated"><a class="ae no" href="https://blog.rstudio.com/2017/09/05/keras-for-r/" rel="noopener ugc nofollow" target="_blank"> Keras ä»£è¡¨ R </a></p><p id="c81b" class="ky kz mz la b lb lc ju ld le lf jx lg od li lj lk oe lm ln lo of lq lr ls lt im bi translated"><a class="ae no" href="https://bioconductor.org/packages/release/bioc/vignettes/EBImage/inst/doc/EBImage-introduction.html" rel="noopener ugc nofollow" target="_blank">ç”µå­å›¾åƒç®€ä»‹</a></p></blockquote></div></div>    
</body>
</html>