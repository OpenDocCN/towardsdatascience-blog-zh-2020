<html>
<head>
<title>Predicting Wine Quality with Several Classification Techniques</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用几种分类技术预测葡萄酒质量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-wine-quality-with-several-classification-techniques-179038ea6434?source=collection_archive---------0-----------------------#2020-05-08">https://towardsdatascience.com/predicting-wine-quality-with-several-classification-techniques-179038ea6434?source=collection_archive---------0-----------------------#2020-05-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8de2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">带代码的数据科学项目演练！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/74ec2c93a2d63fd81d3032e47e335ba7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ayKmvVZCYaLPl-nmLLp5g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1543170" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae ky" href="https://pixabay.com/users/ponce_photography-2473530/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1543170" rel="noopener ugc nofollow" target="_blank"> Aline Ponce </a>拍摄</p></figure><blockquote class="kz la lb"><p id="a968" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf iu">请务必点击</strong> <a class="ae ky" href="https://terenceshin.medium.com/membership" rel="noopener"> <strong class="lf iu">订阅此处</strong> </a> <strong class="lf iu">或我的</strong> <a class="ae ky" href="https://terenceshin.substack.com/embed" rel="noopener ugc nofollow" target="_blank"> <strong class="lf iu">个人简讯</strong> </a> <strong class="lf iu">千万不要错过另一篇关于数据科学指南、技巧和提示、生活经验等的文章！</strong></p></blockquote><h1 id="d07e" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">目录</h1><ol class=""><li id="ecc7" class="mr ms it lf b lg mt lj mu mv mw mx my mz na ly nb nc nd ne bi translated"><a class="ae ky" href="#ad59" rel="noopener ugc nofollow">简介</a></li><li id="94eb" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated"><a class="ae ky" href="#30ac" rel="noopener ugc nofollow">设置</a></li><li id="af5d" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated"><a class="ae ky" href="#f05d" rel="noopener ugc nofollow">探索变量</a></li><li id="07f0" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated"><a class="ae ky" href="#ca0a" rel="noopener ugc nofollow">转化为分类问题</a></li><li id="5dd0" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated"><a class="ae ky" href="#8334" rel="noopener ugc nofollow">准备建模数据</a></li><li id="0c3e" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated"><a class="ae ky" href="#e0dc" rel="noopener ugc nofollow">造型</a></li><li id="8efa" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated"><a class="ae ky" href="#98be" rel="noopener ugc nofollow">功能重要性</a></li></ol></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h1 id="ad59" class="lz ma it bd mb mc nr me mf mg ns mi mj jz nt ka ml kc nu kd mn kf nv kg mp mq bi translated">介绍</h1><p id="ed33" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">随着隔离的继续，我有了一些爱好和兴趣…包括葡萄酒。最近，我喜欢上了葡萄酒，尽管我并不知道什么是好酒。因此，我决定应用一些机器学习模型来弄清楚是什么造就了优质的葡萄酒！</p><p id="9bea" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mv ln lo lp mx lr ls lt mz lv lw lx ly im bi translated">对于这个项目，我使用了 Kaggle 的<a class="ae ky" href="https://www.kaggle.com/uciml/red-wine-quality-cortez-et-al-2009" rel="noopener ugc nofollow" target="_blank">红酒质量</a>数据集来建立各种分类模型，以预测某一特定红酒是否“质量好”。该数据集中的每种葡萄酒都被赋予 0 到 10 之间的“质量”分数。出于这个项目的目的，我将输出转换为二进制输出，其中每种葡萄酒要么是“优质”(7 分或更高)，要么不是(低于 7 分)。葡萄酒的质量由 11 个输入变量决定:</p><ol class=""><li id="8763" class="mr ms it lf b lg lh lj lk mv nz mx oa mz ob ly nb nc nd ne bi translated">固定酸度</li><li id="cafe" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">挥发性酸度</li><li id="4929" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">柠檬酸</li><li id="3373" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">残糖</li><li id="a4e3" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">氯化物</li><li id="dbb4" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">游离二氧化硫</li><li id="7829" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">二氧化硫总量</li><li id="0db4" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">密度</li><li id="ef4b" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">pH 值</li><li id="eb2d" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">硫酸盐化</li><li id="e29c" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">酒精</li></ol><h2 id="350d" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">目标</h2><p id="0a78" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">该项目的目标如下</p><ol class=""><li id="556c" class="mr ms it lf b lg lh lj lk mv nz mx oa mz ob ly nb nc nd ne bi translated">尝试不同的分类方法，看看哪种分类方法的准确度最高</li><li id="a4d1" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">确定哪些特征最能代表优质葡萄酒</li></ol><p id="a6e6" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mv ln lo lp mx lr ls lt mz lv lw lx ly im bi translated">说到这里，我们开始吧！</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><blockquote class="kz la lb"><p id="00a9" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf iu">请务必在此</strong> <a class="ae ky" href="https://terenceshin.medium.com/membership" rel="noopener"> <strong class="lf iu">订阅</strong> </a> <strong class="lf iu">或我的</strong> <a class="ae ky" href="https://terenceshin.substack.com/embed" rel="noopener ugc nofollow" target="_blank"> <strong class="lf iu">个人简讯</strong> </a> <strong class="lf iu">千万不要错过另一篇关于数据科学指南、技巧和提示、生活经验等的文章！</strong></p></blockquote></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h1 id="30ac" class="lz ma it bd mb mc nr me mf mg ns mi mj jz nt ka ml kc nu kd mn kf nv kg mp mq bi translated">设置</h1><p id="4be7" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">首先，我导入了我将使用的所有相关库以及数据本身。</p><h2 id="ab07" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">导入库</h2><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="ba47" class="oc ma it op b gy ot ou l ov ow">import numpy as np<br/>import pandas as pd<br/>import matplotlib as plt<br/>import seaborn as sns<br/>import plotly.express as px</span></pre><h2 id="4484" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">读取数据</h2><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="abc0" class="oc ma it op b gy ot ou l ov ow">df = pd.read_csv("../input/red-wine-quality-cortez-et-al-2009/winequality-red.csv")</span></pre><h2 id="7051" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">理解数据</h2><p id="d87f" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">接下来，我想更好地了解我在做什么。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="138c" class="oc ma it op b gy ot ou l ov ow"># See the number of rows and columns<br/>print("Rows, columns: " + str(df.shape))</span><span id="934a" class="oc ma it op b gy ox ou l ov ow"># See the first five rows of the dataset<br/>df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/a5ff6e7b085a61070c936443236492f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q6OUdv7w5BZwqqhYFFBQMA.png"/></div></div></figure><p id="c47f" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mv ln lo lp mx lr ls lt mz lv lw lx ly im bi translated">总共有 1599 行和 12 列。通过查看前五行，数据看起来非常干净，但是我仍然想确保没有丢失值。</p><h2 id="37e1" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">缺少值</h2><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="460d" class="oc ma it op b gy ot ou l ov ow"># Missing Values<br/>print(df.isna().sum())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/4f566df37562c67bb627ad655c40b434.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eDxYf81aohZHMO8LV2_DDA.png"/></div></div></figure><p id="4ca2" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mv ln lo lp mx lr ls lt mz lv lw lx ly im bi translated">这是一个非常适合初学者的数据集。我不需要处理任何丢失的值，而且在给定这些变量的情况下，也没有太多的灵活性来进行一些特性工程。接下来，我想进一步探索我的数据。</p><h1 id="f05d" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">探索变量</h1><h2 id="985d" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">“质量”变量直方图</h2><p id="8734" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">首先，我想看看<em class="le">质量</em>变量的分布。我想确保我的数据集中有足够多的“优质”葡萄酒——稍后你会看到我是如何定义“优质”的。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="e90a" class="oc ma it op b gy ot ou l ov ow">fig = px.histogram(df,x='quality')<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/c6f41a801274116ee854da7b603600dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mby2pZfP2mnyi5wP_Uh9sQ.png"/></div></div></figure><h2 id="2281" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">相关矩阵</h2><p id="ce54" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">接下来，我想看看我正在处理的变量之间的相关性。这让我可以很快更好地理解变量之间的关系。</p><p id="dec1" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mv ln lo lp mx lr ls lt mz lv lw lx ly im bi translated">我立即发现了一些与<em class="le">质量密切相关的变量。</em>很可能这些变量也是我们的机器学习模型中最重要的特征，但我们稍后再看。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="8da3" class="oc ma it op b gy ot ou l ov ow">corr = df.corr()<br/>matplotlib.pyplot.subplots(figsize=(15,10))<br/>sns.heatmap(corr, xticklabels=corr.columns, yticklabels=corr.columns, annot=True, cmap=sns.diverging_palette(220, 20, as_cmap=True))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/db438dfd0445fe7267f756720889cd0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dhDaVItzF4dzxLlJ8Kyhlw.png"/></div></div></figure></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><blockquote class="kz la lb"><p id="0557" class="lc ld le lf b lg lh ju li lj lk jx ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf iu">请务必</strong> <a class="ae ky" href="https://terenceshin.medium.com/membership" rel="noopener"> <strong class="lf iu">订阅此处</strong> </a> <strong class="lf iu">或我的</strong> <a class="ae ky" href="https://terenceshin.substack.com/embed" rel="noopener ugc nofollow" target="_blank"> <strong class="lf iu">个人简讯</strong> </a> <strong class="lf iu">千万不要错过另一篇关于数据科学指南、技巧和提示、生活经验等的文章！</strong></p></blockquote></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h1 id="ca0a" class="lz ma it bd mb mc nr me mf mg ns mi mj jz nt ka ml kc nu kd mn kf nv kg mp mq bi translated">转化为分类问题</h1><p id="b4b7" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">回到我的目标，我想比较不同分类技术的有效性，所以我需要将输出变量改为二进制输出。</p><p id="b009" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mv ln lo lp mx lr ls lt mz lv lw lx ly im bi translated">对于这个问题，我将一瓶葡萄酒定义为质量分数为 7 分或更高的为“质量好”，如果分数低于 7 分，则视为“质量差”。</p><p id="799b" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mv ln lo lp mx lr ls lt mz lv lw lx ly im bi translated">一旦我将输出变量转换成二进制输出，我就将我的特征变量(X)和目标变量(y)分离成单独的数据帧。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="a7e4" class="oc ma it op b gy ot ou l ov ow"># Create Classification version of target variable<br/>df['goodquality'] = [1 if x &gt;= 7 else 0 for x in df['quality']]</span><span id="5da0" class="oc ma it op b gy ox ou l ov ow"># Separate feature variables and target variable<br/>X = df.drop(['quality','goodquality'], axis = 1)<br/>y = df['goodquality']</span></pre><h2 id="f9c2" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">好酒与劣酒的比例</h2><p id="19b9" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">我想确保有合理数量的优质葡萄酒。根据下面的结果，这似乎是一个公平的数字。在某些应用中，如果数据极度不平衡，可能需要重新采样，但我认为这样做没问题。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="254d" class="oc ma it op b gy ot ou l ov ow"># See proportion of good vs bad wines<br/>df['goodquality'].value_counts()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/6159b7341ad4f5a3b249f802a18d3d0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x9YtW2iu9UPORTs0Vv23xw.png"/></div></div></figure><h1 id="8334" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">为建模准备数据</h1><h2 id="c805" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">标准化特征变量</h2><p id="48e4" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">在这一点上，我觉得我已经准备好了建模的数据。我做的第一件事是标准化数据。<strong class="lf iu">标准化</strong>数据意味着它将转换数据，使其分布的平均值为 0，标准差为 1。为了均衡数据范围，标准化数据非常重要。</p><p id="9baf" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mv ln lo lp mx lr ls lt mz lv lw lx ly im bi translated">例如，假设数据集有两个输入要素:以毫米为单位的身高和以磅为单位的体重。因为“身高”的值由于其测量而要高得多，所以更强调身高而不是体重，这就产生了偏见。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="ff0a" class="oc ma it op b gy ot ou l ov ow"># Normalize feature variables<br/>from sklearn.preprocessing import StandardScaler<br/>X_features = X<br/>X = StandardScaler().fit_transform(X)</span></pre><h2 id="ca06" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">分割数据</h2><p id="823c" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">接下来，我将数据分成训练集和测试集，这样我就可以交叉验证我的模型，并确定它们的有效性。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="56df" class="oc ma it op b gy ot ou l ov ow"># Splitting the data<br/>from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.25, random_state=0)</span></pre><p id="c250" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mv ln lo lp mx lr ls lt mz lv lw lx ly im bi translated">现在，有趣的部分来了！</p><h1 id="e0dc" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">系统模型化</h1><p id="27e1" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">对于这个项目，我想比较五种不同的机器学习模型:决策树、随机森林、AdaBoost、Gradient Boost 和 XGBoost。为了这个项目的目的，我想比较这些模型的准确性。</p><h2 id="54fc" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">模型 1:决策树</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/5f4b666a801de6e4be783e7398d0a737.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*f_tt4OIzuY4yoPrnFP0gdA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者创建的图像</p></figure><p id="d4cf" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mv ln lo lp mx lr ls lt mz lv lw lx ly im bi translated">决策树是一种流行的模型，用于运筹学、战略规划和机器学习。上面的每个方块称为一个节点，节点越多，你的决策树就越精确(一般来说)。决策树的最后节点，也就是做出决策的地方，被称为树的叶子。决策树直观且易于构建，但在准确性方面有所欠缺。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="ae49" class="oc ma it op b gy ot ou l ov ow">from sklearn.metrics import classification_report<br/>from sklearn.tree import DecisionTreeClassifier</span><span id="85fb" class="oc ma it op b gy ox ou l ov ow">model1 = DecisionTreeClassifier(random_state=1)<br/>model1.fit(X_train, y_train)<br/>y_pred1 = model1.predict(X_test)</span><span id="5aa7" class="oc ma it op b gy ox ou l ov ow">print(classification_report(y_test, y_pred1))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/9236477be20475bbefbc756a2834f7e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*Fa3MH8m51b-I9idC6kY_Wg.png"/></div></figure><h2 id="1aec" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">模型 2:随机森林</h2><p id="de5e" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">随机森林是一种基于决策树的<a class="ae ky" href="https://en.wikipedia.org/wiki/Ensemble_learning" rel="noopener ugc nofollow" target="_blank">集成学习</a>技术。随机森林包括使用原始数据的<a class="ae ky" href="https://machinelearningmastery.com/a-gentle-introduction-to-the-bootstrap-method/" rel="noopener ugc nofollow" target="_blank">自举数据集</a>创建多个决策树，并在决策树的每一步随机选择一个变量子集。然后，该模型选择每个决策树的所有预测的模式。这有什么意义？依靠“多数获胜”模型，它降低了单个树出错的风险。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/008b2faf5d216e1723e81c72de11e5c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*m7GqdxdOVwrypcP4.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者创建的图像</p></figure><p id="4d43" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mv ln lo lp mx lr ls lt mz lv lw lx ly im bi translated">例如，如果我们创建一个决策树，第三个，它会预测 0。但是如果我们依赖所有 4 个决策树的模式，预测值将是 1。这就是随机森林的力量。</p><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="61ac" class="oc ma it op b gy ot ou l ov ow">from sklearn.ensemble import RandomForestClassifier<br/>model2 = RandomForestClassifier(random_state=1)<br/>model2.fit(X_train, y_train)<br/>y_pred2 = model2.predict(X_test)</span><span id="eaa6" class="oc ma it op b gy ox ou l ov ow">print(classification_report(y_test, y_pred2))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/03be151b52e25c3e61378dcfe99453cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*RBYeMaU0vVavkU8ywsQGVw.png"/></div></figure><h2 id="a2c4" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">模型 3: AdaBoost</h2><p id="98a2" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">接下来的三个模型是提升算法，将弱学习者转化为强学习者。我不想跑题，解释三者之间的区别，因为这是相当复杂和错综复杂的。也就是说，我将留下一些资源，您可以从中了解 AdaBoost、渐变增强和 XGBoosting。</p><ul class=""><li id="b679" class="mr ms it lf b lg lh lj lk mv nz mx oa mz ob ly ph nc nd ne bi translated">StatQuest: AdaBoost </li><li id="93a3" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly ph nc nd ne bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=3CC4N4z3GJc" rel="noopener ugc nofollow" target="_blank"> StatQuest:梯度推进</a></li><li id="ed1b" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly ph nc nd ne bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=OtD8wVaFm6E" rel="noopener ugc nofollow" target="_blank"> StatQuest: XGBoost </a></li></ul><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="b57a" class="oc ma it op b gy ot ou l ov ow">from sklearn.ensemble import AdaBoostClassifier<br/>model3 = AdaBoostClassifier(random_state=1)<br/>model3.fit(X_train, y_train)<br/>y_pred3 = model3.predict(X_test)</span><span id="dd64" class="oc ma it op b gy ox ou l ov ow">print(classification_report(y_test, y_pred3))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/168117bce05808c8354150383a6227e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*AhtulmLCCIJYfY329ZQmqA.png"/></div></figure><h2 id="7d33" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">模型 4:梯度推进</h2><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="2788" class="oc ma it op b gy ot ou l ov ow">from sklearn.ensemble import GradientBoostingClassifier<br/>model4 = GradientBoostingClassifier(random_state=1)<br/>model4.fit(X_train, y_train)<br/>y_pred4 = model4.predict(X_test)</span><span id="1d68" class="oc ma it op b gy ox ou l ov ow">print(classification_report(y_test, y_pred4))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/6b99d6622bb5f694012b752a299b0243.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*UKIlBo4_eq9xLpWvBayeKw.png"/></div></figure><h2 id="43d3" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">模型 5: XGBoost</h2><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="2702" class="oc ma it op b gy ot ou l ov ow">import xgboost as xgb<br/>model5 = xgb.XGBClassifier(random_state=1)<br/>model5.fit(X_train, y_train)<br/>y_pred5 = model5.predict(X_test)</span><span id="cc75" class="oc ma it op b gy ox ou l ov ow">print(classification_report(y_test, y_pred5))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/be56a914b0d9c0377da6e9cca72f5280.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*FqKC0Kl8oP9vwIFVzOUFdQ.png"/></div></figure><p id="f87c" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mv ln lo lp mx lr ls lt mz lv lw lx ly im bi translated">通过比较这五个模型，random forest 和 XGBoost 似乎产生了最高级别的准确性。然而，由于 XGBoost 在预测优质葡萄酒方面有更好的 f1 分数(1)，我的结论是 XGBoost 是五个模型中的赢家。</p><h1 id="98be" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">特征重要性</h1><p id="f8cd" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">下面，我根据随机森林模型和 XGBoost 模型绘制了特性的重要性。虽然它们略有不同，但前三个特征是相同的:酒精、挥发性酸度和硫酸盐。如果你看下面的图表，我把数据集分成质量好的和质量差的两类，以便更详细地比较这些变量。</p><h2 id="d4d0" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">通过随机森林</h2><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="0ea0" class="oc ma it op b gy ot ou l ov ow">feat_importances = pd.Series(model2.feature_importances_, index=X_features.columns)<br/>feat_importances.nlargest(25).plot(kind='barh',figsize=(10,10))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/bf5bd50baf10e53a40ee6687e7ed4f1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2yUIZus1C2bq6KSPvMHTqg.png"/></div></div></figure><h2 id="8169" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">通过 XGBoost</h2><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="a4eb" class="oc ma it op b gy ot ou l ov ow">feat_importances = pd.Series(model5.feature_importances_, index=X_features.columns)<br/>feat_importances.nlargest(25).plot(kind='barh',figsize=(10,10))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/71aa6c7657cc3ca99429a8c508d8aeab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*W72wbRvUCo82ADrx3PWBTA.png"/></div></figure><h2 id="607c" class="oc ma it bd mb od oe dn mf of og dp mj mv oh oi ml mx oj ok mn mz ol om mp on bi translated">比较四大特征</h2><pre class="kj kk kl km gt oo op oq or aw os bi"><span id="4cdf" class="oc ma it op b gy ot ou l ov ow"># Filtering df for only good quality<br/>df_temp = df[df['goodquality']==1]<br/>df_temp.describe()</span><span id="3b20" class="oc ma it op b gy ox ou l ov ow"># Filtering df for only bad quality<br/>df_temp2 = df[df['goodquality']==0]<br/>df_temp2.describe()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/27eaa38411ffb4f0a8b8fe9024f5f00f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CvMokEiJSAAXdE291mEiZg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">好品质</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/2e08b519699aac93e06bac50f64e76fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*At71SF4NFWpG0FHTIIOLKg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">劣等质量</p></figure><p id="d656" class="pw-post-body-paragraph lc ld it lf b lg lh ju li lj lk jx ll mv ln lo lp mx lr ls lt mz lv lw lx ly im bi translated"><strong class="lf iu">通过观察细节，我们可以看到，优质葡萄酒的平均酒精含量较高，平均挥发性酸度较低，平均硫酸盐含量较高，平均残糖含量较高。</strong></p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h1 id="50fe" class="lz ma it bd mb mc nr me mf mg ns mi mj jz nt ka ml kc nu kd mn kf nv kg mp mq bi translated">感谢阅读！</h1><p id="9a54" class="pw-post-body-paragraph lc ld it lf b lg mt ju li lj mu jx ll mv nw lo lp mx nx ls lt mz ny lw lx ly im bi translated">如果你喜欢我的工作并想支持我，我会非常感谢你在我的社交媒体频道上关注我:</p><ol class=""><li id="5460" class="mr ms it lf b lg lh lj lk mv nz mx oa mz ob ly nb nc nd ne bi translated">支持我的最好方式是在<strong class="lf iu">媒体</strong>T10【这里上关注我。</li><li id="ca30" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">在<strong class="lf iu">推特</strong>关注我<a class="ae ky" href="https://twitter.com/terence_shin" rel="noopener ugc nofollow" target="_blank">这里</a>。</li><li id="08ea" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">点击这里订阅我的新<strong class="lf iu"> YouTube 频道</strong> <a class="ae ky" href="https://www.youtube.com/channel/UCmy1ox7bo7zsLlDo8pOEEhA?view_as=subscriber" rel="noopener ugc nofollow" target="_blank">。</a></li><li id="4567" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">在<strong class="lf iu"> LinkedIn </strong>上关注我<a class="ae ky" href="https://www.linkedin.com/in/terenceshin/" rel="noopener ugc nofollow" target="_blank">这里</a>。</li><li id="9e83" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">在我的<strong class="lf iu">邮箱列表</strong> <a class="ae ky" href="https://forms.gle/UGdTom9G6aFGHzPD9" rel="noopener ugc nofollow" target="_blank">这里</a>报名。</li><li id="45c8" class="mr ms it lf b lg nf lj ng mv nh mx ni mz nj ly nb nc nd ne bi translated">查看我的网站<a class="ae ky" href="https://terenceshin.com/" rel="noopener ugc nofollow" target="_blank"><strong class="lf iu">terenceshin.com</strong></a>。</li></ol></div></div>    
</body>
</html>