<html>
<head>
<title>Finding A Writer’s Style Using Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用神经网络寻找作家的风格</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/finding-a-writers-style-using-neural-networks-a1c3efcb186b?source=collection_archive---------36-----------------------#2020-05-06">https://towardsdatascience.com/finding-a-writers-style-using-neural-networks-a1c3efcb186b?source=collection_archive---------36-----------------------#2020-05-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2dc7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Genius API训练歌词的网络模型</h2></div><p id="0cdb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">迈克尔·达茨、邓肯·格拉布斯和姬满·金</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/c951ae9e39a9ea730d47573b92f90a50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sVXJ4uUpDPfi3Fuyh5g5jg.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">(<a class="ae lr" href="https://genius.com/" rel="noopener ugc nofollow" target="_blank">https://genius.com/</a></p></figure><h1 id="625a" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">介绍</h1><p id="114e" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">每个作家都有自己的风格。成为一个知名且受人尊敬的作家的部分关键是磨练这种风格，创造出完全属于你和你的生活经历的东西。音乐作为一种艺术形式，允许一种完全独特的表达形式，一些艺术家在他们的作品中确实是无与伦比的。作为热爱音乐的学生，我们已经看到了神经网络在文本分类方面的能力，我们想测试这样一个网络的边界。</p><div class="lc ld le lf gt ab cb"><figure class="mp lg mq mr ms mt mu paragraph-image"><img src="../Images/0e3120dc5471ede89dbeed78b092276b.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*5f7H-i_ma7bdy3dy2n3xqA.jpeg"/></figure><figure class="mp lg mv mr ms mt mu paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><img src="../Images/c81ba4251c46916d95f6e71553516cfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*HfUJXyyBAYtpe2QgSwZE5g.jpeg"/></div><p class="ln lo gj gh gi lp lq bd b be z dk mw di mx my translated">仅仅通过看歌词，你能区分范·莫里生和鲍勃·迪伦的歌曲吗？(维基百科)</p></figure></div><p id="1f1b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们正在研究的问题对一个人来说已经够难了。单看歌词，你能说出是谁写的吗？</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/7739e7dfdfa1cc9346e71884498942bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*SpFrX3ZbojUZcGUovlQVmg.png"/></div></figure><p id="9325" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从这些歌词中，可能很难看出是谁写的，除非你对乐队和相关的词曲作者都非常熟悉。</p><p id="9c30" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">事实上，我们甚至很难做出一个有根据的猜测——我们需要更多的背景知识，然后才能开始给出答案。</p><p id="9abb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些歌词显然来自甲壳虫乐队的“挪威的森林(这只鸟已经飞了)”，由列侬和麦卡特尼共同创作。</p><p id="6969" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">考虑到这一点，我们不仅要在广泛的艺术家上训练我们的网络，还要对他们的目录进行深度采样，这样我们才能提供模型需要的背景，以便给出答案。</p><p id="9e28" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们通过这个神经网络项目的目标是看看一个网络是否能够发现和学习艺术家的风格，并能够预测谁写了一组歌词。这个想法是，给定足够的数据，模型可以根据流行艺术家的歌词进行训练，并能够将后来的输入分类为给定的艺术家。</p><h1 id="6496" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">在我们开始之前…</h1><p id="644c" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">本文假设您对神经网络及其概念有基本的了解。我们将讨论编程语言Python，以及我们用来构建网络的各种库。</p><p id="bd77" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">至于数据，我们使用了Genius API——一个允许我们连接到网站并收集所需数据的接口。我们能够使用LyricsGenius Python库访问这个API这使得查询变得更加容易。我们假设观众熟悉用于创建神经网络的库，如Keras和TensorFlow。</p><div class="na nb gp gr nc nd"><a href="https://keras.io/" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">Home - Keras文档</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">Keras是一个高级神经网络API，用Python编写，能够运行在TensorFlow、CNTK或……</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">keras.io</p></div></div><div class="nm l"><div class="nn l no np nq nm nr ll nd"/></div></div></a></div><div class="na nb gp gr nc nd"><a href="https://www.tensorflow.org/api_docs" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">API文档| TensorFlow Core v2.1.0</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">TensorFlow提供了几种语言的API，用于构建和执行TensorFlow图。巨蟒…</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">www.tensorflow.org</p></div></div></div></a></div><h1 id="4d7b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">收集数据</h1><p id="757c" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">这种方法的第一步是收集数据。虽然在Kaggle等网站上有许多歌词存储库，但我们发现，虽然这些文件中有许多艺术家，但他们没有足够的每位艺术家的歌曲，无法让网络对歌词风格有更深入的了解。</p><p id="f106" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们决定使用Genius的数据，这是一个歌词网站，人们可以在上面添加注释和评论歌曲。Genius是由用户编写的，类似于维基百科，但在被审核为正确之前，也会与官方歌词数据和其他来源进行交叉引用。如前所述，Genius是使用LyricsGenius Python库查询的。</p><div class="na nb gp gr nc nd"><a href="https://github.com/johnwmillr/LyricsGenius" rel="noopener  ugc nofollow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">johnwmillr/lyricsgius</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">lyricsgenius为存储在Genius.com上的歌曲、艺术家和歌词数据提供了一个简单的接口。在使用这个之前…</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">github.com</p></div></div><div class="nm l"><div class="ns l no np nq nm nr ll nd"/></div></div></a></div><p id="4bf4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Genius有一个非常大的众包歌词库，不仅可以很容易地找到各种各样的艺术家，而且如果他们的唱片目录足够大，还可以给我们足够的数据。考虑到我们选择调查的艺术家，找到大量的歌曲样本并不是什么大问题。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nt"><img src="../Images/d4a710141aa2673c677bf1eaf67b3c9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MuDfpTN9r2A62KOueYOUdA.jpeg"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">鲍勃·迪伦和琼·贝兹，两位美国最著名的民谣歌手(维基百科)</p></figure><p id="06b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们想用这些数据确定的一件事是，这些歌曲主要是由表演艺术家创作的。现在一个艺人有一个词曲创作团队是很常见的，这当然有助于形成风格，但也可能会脱离艺人的个人风格。也就是说，我们选择了职业生涯跨度很长的艺术家，主要是像鲍勃·迪伦这样的创作歌手。然而，我们发现这不仅难以持续，因为在任何特定的轨道上也可能有未被编辑的作家。</p><p id="4779" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">考虑到这一点，我们选择了10位知名艺术家开始，并从他们的100首歌曲中收集歌词。我们选择了有深度唱片的艺术家，他们每个人都能轻松地给我们100首歌。根据Genius的API，这些歌词来自Genius网站上他们最受欢迎的100首歌曲。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nu nv l"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">我们为这个项目选择的艺术家</p></figure><h1 id="75a3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">方法</h1><p id="7a51" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">收集完数据后，我们必须清理它。Genius API不仅提供了歌曲的歌词，还提供了注释数据，这些数据对我们的项目并不重要。使用一个脚本，我们清理了文件，这样我们就只有歌词的原始文本，而没有其他内容。这被编译成JSON文件。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nu nv l"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">我们的JSON清理脚本</p></figure><p id="5fe1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">考虑到数据的大小，以及歌曲长度的范围，我们也选择将歌曲限制在100个词以内。这个限制将为每首歌曲提供一个标准，以防一些艺术家倾向于更长的歌曲。一旦数据被清除，我们需要一种方法将数据输入到我们的网络中。我们通过标记给定歌曲中的所有歌词来做到这一点。所以每个单词都有一个值，可以根据我们的需要馈入网络。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nw"><img src="../Images/2ca1bf93994b7e50bdb4b0b90486c8d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ec7iSA71B7zELpu6St7X8Q.jpeg"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">歌曲长度有很大的可变性。</p></figure><h1 id="4dc3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">符号化</h1><p id="8642" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">标记化的一般思想是为每个单词创建一个唯一的数字表示，以便可以输入到网络中。在这种情况下，每首歌曲将被表示为一个数字向量，而每个艺术家将被表示为一个10向量的一键编码。我们会把这些输入到网络中，作为模型训练的一部分。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nu nv l"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">我们标记输入的方法</p></figure><h1 id="0d10" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">网络</h1><p id="b548" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">在项目开始时，我们从Keras python库中的一个简单的顺序网络开始。虽然我们已经得到了结果，网络的性能很差。我们发现网络很快就达到了一个上限，不会再改善了。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nx"><img src="../Images/57d0bc64c7dcd1d05811307180d6ac15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GN_yPljy_oJFDv8frEjXpw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">顺序模型的输出</p></figure><p id="d84d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如您在这里看到的，我们的训练准确性高于验证准确性，这是可以预期的，但总体而言，这两个值都非常低，只有20%的准确性。产量如此之低，我们认为最好寻找一种新的方法。</p><div class="na nb gp gr nc nd"><a rel="noopener follow" target="_blank" href="/multi-class-text-classification-with-lstm-1590bee1bd17"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">基于LSTM的多类文本分类</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">如何开发LSTM递归神经网络模型的文本分类问题在Python中使用Keras深…</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">towardsdatascience.com</p></div></div><div class="nm l"><div class="ny l no np nq nm nr ll nd"/></div></div></a></div><p id="4b2e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">找到这篇文章后，我们选定了一个LSTM网络，它可以在文本分类中提供更好的结果。使用LSTMs是解决这类问题的一种非常常见的方法，并且已经得到了广泛的研究。LSTMs对于这种类型的问题很常见，因为它们可以记住过去的数据序列。</p><p id="534d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如您在下面的结果中所看到的，训练准确率非常接近100%，而验证准确率上限在40%左右。不过，应该提到的是，这些结果是在30个时期后获得的，而我们之前的模型需要数百个时期。</p><p id="be0e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">也就是说，当我们发现我们的训练精度非常高，而我们的验证精度相对较低时，我们再次遇到了障碍。只有40%的验证准确率和超过90%的训练准确率，网络显然是过度拟合的。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nx"><img src="../Images/07362ea3d5351bc95b57333cdbb7a115.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ycTW1vMkwk75_UrftLZX5g.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">我们新的LSTM模型的输出</p></figure><p id="7311" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了解决这个问题，我们相信我们需要更多的数据和更广泛的种类。例如，包括整首歌曲而不在100个单词处切断它们，或者向输入中添加歌曲的不同度量，例如平均单词长度和情感。虽然这些变化是可能的，但对于我们可用的基本技术和有限的存储来说是困难的。最重要的是，网络可以通过试错法以小的方式进行修改，以便在这种特定的环境中运行良好。</p><h1 id="17d2" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论和进一步的项目</h1><p id="af1d" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">在这个项目之后，我们可以得出结论，我们的文本分类离能够分析歌曲歌词这样的风格化散文还有很长的路要走，特别是在我们能够使用的少量数据的情况下。尽管我们收集的结果很新颖，但我们发现再次探讨这个话题需要更多的数据。也就是说，这个话题是有潜力的。</p><p id="4d48" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然我们没有达到预期的业绩，但通过这次调查，我们还是学到了很多东西。在训练网络后，我们输入了它以前见过和没见过的艺术家的歌词，结果很有趣，给出的结果会比有根据的猜测更好。</p><p id="29f0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然电视网之前看过披头士和泰勒·斯威夫特，但没看过德雷克和ACDC。通过输入网络从未见过的数据，我们可以从一个新的角度了解我们的模型如何对歌词进行分类。当德雷克输入歌词时，模型输出这首歌是李尔·韦恩写的，这是一个可以理解的猜测。</p><p id="67e6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然当AC/DC的“黑色归来”输入时，模型输出这首歌是j .科尔写的。关于模型学习有一点要说——当我们输入已经被网络看到的歌曲时，正确的艺术家被输出。</p><blockquote class="nz oa ob"><p id="0bf4" class="kf kg oc kh b ki kj jr kk kl km ju kn od kp kq kr oe kt ku kv of kx ky kz la ij bi translated">德雷克，“上帝的计划”-&gt;李尔·韦恩</p><p id="f1ca" class="kf kg oc kh b ki kj jr kk kl km ju kn od kp kq kr oe kt ku kv of kx ky kz la ij bi translated">AC/DC，《黑色归来》-&gt; J .科尔</p><p id="c8c9" class="kf kg oc kh b ki kj jr kk kl km ju kn od kp kq kr oe kt ku kv of kx ky kz la ij bi translated">甲壳虫乐队，《嘿，裘德》-&gt;甲壳虫乐队</p><p id="f3b7" class="kf kg oc kh b ki kj jr kk kl km ju kn od kp kq kr oe kt ku kv of kx ky kz la ij bi translated">泰勒·斯威夫特，《情人》-&gt;泰勒·斯威夫特</p></blockquote><p id="8068" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如前所述，是有潜力的。不仅在歌词分类中，而且在NLP文本作者分类的更广泛的问题中。这可以被情报机构用来识别谁写了电子邮件或短信，或者被谷歌和苹果这样的公司用来自动识别新电子邮件和短信的作者。</p><p id="6509" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点击查看Github <a class="ae lr" href="https://github.com/duncangrubbs/lyrics-to-artist" rel="noopener ugc nofollow" target="_blank">上的所有源代码和数据。</a></p></div></div>    
</body>
</html>