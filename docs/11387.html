<html>
<head>
<title>Create beautiful and interactive Chord Diagrams using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 创建漂亮的交互式和弦图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-beautiful-and-interactive-chord-diagrams-using-python-cb5ecb092a7c?source=collection_archive---------10-----------------------#2020-08-07">https://towardsdatascience.com/create-beautiful-and-interactive-chord-diagrams-using-python-cb5ecb092a7c?source=collection_archive---------10-----------------------#2020-08-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="8d9b" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">Python 中的数据可视化</h2><div class=""/><div class=""><h2 id="a795" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">一个简单的指南，使用一个简单的函数调用来创建一个令人敬畏的和弦图。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/4756b3d3df28b3b30a7e093e76ead0d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*OG0la8EKMNvXKAc4QV9b7g.gif"/></div></div></figure><p id="b836" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">根据数据科学家的说法，当谈到什么是最好的语言时，R vs Python 是一场持续的争论。虽然每种语言都有它的长处，但在我看来，R 有一个难以超越的尖端技巧——R 拥有通过可视化交流结果的神奇工具。</p><p id="b653" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">本周，当我试图寻找一种吸引人的方式来可视化数据中各特征之间的相关性时，这一点引起了我的注意。我偶然发现了和弦图！(我们一会儿就会谈到这个)我见过几个使用<em class="lz"> Circlize </em>生成和弦图的 R 示例，在这些示例中，您只需将形状合适的数据传递给 chordDiagram()函数和 ta-da！</p><p id="5bdf" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">你应该看到当我发现和弦图的<a class="ae ma" href="https://plotly.com/python/v3/filled-chord-diagram/" rel="noopener ugc nofollow" target="_blank"> Python Plotly </a>实现时我脸上的表情。即使要得到一个基本的数字，也要付出很多努力。最终结果似乎根本不值得努力。当我在 pypi 上偶然发现<a class="ae ma" href="https://pypi.org/project/chord/" rel="noopener ugc nofollow" target="_blank">和弦时，我几乎放弃了使用和弦图的想法。</a></p><h1 id="2dae" class="mb mc it bd md me mf mg mh mi mj mk ml ki mm kj mn kl mo km mp ko mq kp mr ms bi translated">好吧，什么是和弦图？</h1><p id="8d3b" class="pw-post-body-paragraph ld le it lf b lg mt kd li lj mu kg ll lm mv lo lp lq mw ls lt lu mx lw lx ly im bi translated">弦图表示一组不同项目之间的流程。这些被称为节点的项目显示在一个圆的周围，流显示为节点之间的连接，显示为弧。</p><p id="585d" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如果这还没有解释清楚，让我们来看一个例子:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi my"><img src="../Images/b0e37d448b34d55dc4bfaa657e74c395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XRgbS0-0uu7Oni0iJO1vFg.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">作者图片</p></figure><p id="3518" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">上面的弦图直观地显示了两个实体(本例中为城市)在旅行者的旅程中同时出现的次数，它允许我们研究它们之间的流动。</p><h1 id="f456" class="mb mc it bd md me mf mg mh mi mj mk ml ki mm kj mn kl mo km mp ko mq kp mr ms bi translated">如何用最少的努力创造出漂亮的和弦图？</h1><p id="0c5e" class="pw-post-body-paragraph ld le it lf b lg mt kd li lj mu kg ll lm mv lo lp lq mw ls lt lu mx lw lx ly im bi translated">让我带您了解数据准备的过程，然后创建和弦图。</p><h2 id="35a0" class="nd mc it bd md ne nf dn mh ng nh dp ml lm ni nj mn lq nk nl mp lu nm nn mr iz bi translated"><strong class="ak">安装:</strong></h2><p id="2779" class="pw-post-body-paragraph ld le it lf b lg mt kd li lj mu kg ll lm mv lo lp lq mw ls lt lu mx lw lx ly im bi translated">假设已经安装了 Pandas，您需要从 pypi 安装 chord 包，使用—</p><pre class="ks kt ku kv gt no np nq nr aw ns bi"><span id="427c" class="nd mc it np b gy nt nu l nv nw">pip install chord</span></pre><h2 id="39ce" class="nd mc it bd md ne nf dn mh ng nh dp ml lm ni nj mn lq nk nl mp lu nm nn mr iz bi translated"><strong class="ak">数据准备:</strong></h2><p id="4a95" class="pw-post-body-paragraph ld le it lf b lg mt kd li lj mu kg ll lm mv lo lp lq mw ls lt lu mx lw lx ly im bi translated">我用的是波士顿房价数据集，可以从<a class="ae ma" href="https://www.kaggle.com/vikrishnan/boston-house-prices" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><pre class="ks kt ku kv gt no np nq nr aw ns bi"><span id="828e" class="nd mc it np b gy nt nu l nv nw"># importing Pandas libary<br/>import pandas as pd</span><span id="0bf9" class="nd mc it np b gy nx nu l nv nw"># reading data from csv<br/>df = pd.read_csv("housing.csv")</span></pre><p id="03dc" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我的目标是可视化数据集中要素之间的相关性。因此，为了简洁起见，我将删除一些列。我将只剩下 6 个特征。(如果您愿意，可以跳过这一步)</p><pre class="ks kt ku kv gt no np nq nr aw ns bi"><span id="27e1" class="nd mc it np b gy nt nu l nv nw"># List of columns to delete and then dropping them.<br/>delete = ['ZN', 'INDUS', 'CHAS', 'DIS','RAD','PTRATIO','B','LSTAT']</span><span id="d648" class="nd mc it np b gy nx nu l nv nw">df.drop(delete, axis=1, inplace=True)</span></pre><p id="fd60" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在让我们使用 Pandas corr()函数创建相关矩阵。</p><pre class="ks kt ku kv gt no np nq nr aw ns bi"><span id="26b9" class="nd mc it np b gy nt nu l nv nw"># Now, matrix contains a 6x6 matrix of the values.<br/>matrix = df.corr()</span><span id="720e" class="nd mc it np b gy nx nu l nv nw"># Replacing negative values with 0’s, as features can be negatively correlated.<br/>matrix[matrix &lt; 0] = 0</span><span id="95b8" class="nd mc it np b gy nx nu l nv nw"># Multiplying all values by 100 for clarity, since correlation values lie b/w 0 and 1.<br/>matrix = matrix.multiply(100).astype(int)</span><span id="c4f1" class="nd mc it np b gy nx nu l nv nw"># Converting the DataFrame to a 2D List, as it is the required input format.<br/>matrix = matrix.values.tolist()</span></pre><p id="e657" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这些数据现在非常适合我们的绘图！</p><h2 id="b454" class="nd mc it bd md ne nf dn mh ng nh dp ml lm ni nj mn lq nk nl mp lu nm nn mr iz bi translated"><strong class="ak">绘制图表图:</strong></h2><p id="19c1" class="pw-post-body-paragraph ld le it lf b lg mt kd li lj mu kg ll lm mv lo lp lq mw ls lt lu mx lw lx ly im bi translated">绘制之前剩下的唯一一步是将实体的名称存储为一个列表。在我的例子中，这些是特性的名称。</p><pre class="ks kt ku kv gt no np nq nr aw ns bi"><span id="0f51" class="nd mc it np b gy nt nu l nv nw"># Names of the features.<br/>names = ["Crime Rate","N-Oxide","Number of rooms","Older buildings","Property Tax","Median Price"]</span></pre><p id="190c" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在，我们要做的就是导入这个包—</p><pre class="ks kt ku kv gt no np nq nr aw ns bi"><span id="47d2" class="nd mc it np b gy nt nu l nv nw">from chord import Chord</span></pre><p id="3527" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">然后将矩阵和名称传递给 Chord()函数。</p><pre class="ks kt ku kv gt no np nq nr aw ns bi"><span id="a785" class="nd mc it np b gy nt nu l nv nw">Chord(matrix, names).show()</span><span id="86cd" class="nd mc it np b gy nx nu l nv nw">#Note: The show() function works only with Jupyter Labs.<br/># (Not Jupyter notebook)</span></pre><p id="9351" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这将是您的输出:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/8f170cd0696e68d6d3c04d3a5b7be27b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*SU65TrsI4n8NTtPotYZkEQ.gif"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">朱庇特实验室的输出。图片作者。</p></figure><p id="92a8" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在我们进一步探索和弦库中可用的其他风格和输出设置之前，让我们看看输出代表什么。</p><p id="c023" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如你所见，当你在犯罪率上徘徊时，你可以看到它与财产税、旧建筑和氮氧化物水平有关，但与中间价格或房间数量无关。现在，您可以将鼠标悬停在连接上，您将看到这些要素之间的相关值。</p><p id="c624" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">您可能会注意到，中间价格与其自身 100%相关，所有特性都是如此。这是因为当我们将一个特征与其自身进行比较时，我们得到了一个完美的相关值。如果您愿意，我们可以用一行代码来解决这个问题。</p><pre class="ks kt ku kv gt no np nq nr aw ns bi"><span id="5ad5" class="nd mc it np b gy nt nu l nv nw"># Operate on the data before converting it into a 2D List</span><span id="9118" class="nd mc it np b gy nx nu l nv nw"># We are just converting all Perfect correlation 100's(Basically the 1’s) to 0 as well.<br/>matrix[matrix == 100] = 0<br/>matrix = matrix.values.tolist()</span></pre><p id="090c" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这是你的输出，一个更清晰的和弦图:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nz"><img src="../Images/af095b47da93f0de51fff06094d55ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ivHuDnX8Gy6hxJnlxg-jmQ.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">作者图片</p></figure><h2 id="a72e" class="nd mc it bd md ne nf dn mh ng nh dp ml lm ni nj mn lq nk nl mp lu nm nn mr iz bi translated"><strong class="ak">将和弦图导出为 HTML: </strong></h2><p id="6fd8" class="pw-post-body-paragraph ld le it lf b lg mt kd li lj mu kg ll lm mv lo lp lq mw ls lt lu mx lw lx ly im bi translated">因为这个包的核心使用了 d3-chord，所以它也给了我们一个选项来输出 ChordDiagram 作为一个完全可编辑的 HTML 文件！多酷啊。</p><p id="56c1" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">同样，一个简单的方法调用就能帮你做到—</p><pre class="ks kt ku kv gt no np nq nr aw ns bi"><span id="5c1b" class="nd mc it np b gy nt nu l nv nw">Chord(matrix, names).to_html()</span><span id="bc99" class="nd mc it np b gy nx nu l nv nw"># This will create a file 'out.html' in your current directory.</span></pre><p id="976f" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">您可以在浏览器中打开 HTML 来查找相同的交互式和弦图，也可以打开。html 并自定义页面的其余部分！</p><p id="1b04" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">这是我的输出，</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/a27b78d566e7684310b10d050e9b9e56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*m-GqFZgsTEgLyfC4siY4RQ.gif"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">以 HTML 的形式输出。图片作者。</p></figure><p id="d5c3" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我所做的是极其基本的。关键是，HTML 格式的输出为使用和弦图提供了无数的可能性。</p><h1 id="b5e1" class="mb mc it bd md me mf mg mh mi mj mk ml ki mm kj mn kl mo km mp ko mq kp mr ms bi translated"><strong class="ak">造型定制:</strong></h1><h2 id="46de" class="nd mc it bd md ne nf dn mh ng nh dp ml lm ni nj mn lq nk nl mp lu nm nn mr iz bi translated"><strong class="ak">颜色:</strong></h2><p id="fcef" class="pw-post-body-paragraph ld le it lf b lg mt kd li lj mu kg ll lm mv lo lp lq mw ls lt lu mx lw lx ly im bi translated">您可以通过从<a class="ae ma" href="https://github.com/d3/d3-scale-chromatic#categorical" rel="noopener ugc nofollow" target="_blank"> d3 分类调色板</a>中传递任何颜色来更改和弦图的颜色。您可以在<a class="ae ma" href="https://shahinrostami.com/posts/statistics/data-is-beautiful/chord-diagrams/" rel="noopener ugc nofollow" target="_blank">官方指南</a>中找到输出样本。但这里有几个例子:</p><pre class="ks kt ku kv gt no np nq nr aw ns bi"><span id="35ab" class="nd mc it np b gy nt nu l nv nw"># Just add the colors parameter and pass the value.<br/>Chord(matrix, names, colors="d3.schemeDark2").show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oa"><img src="../Images/acdcba324fc0f605924607e70cf95505.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-4UT3SWucFeEov6IkDdm-g.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">作者图片</p></figure><pre class="ks kt ku kv gt no np nq nr aw ns bi"><span id="df5f" class="nd mc it np b gy nt nu l nv nw"># Just add the colors parameter and pass the value.<br/>Chord(matrix, names, colors="d3.schemeAccent").show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/b11eff8c40be4fdf41dc45457d4cb3bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0bWjwHpia5PSk8GABkjEnA.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">作者图片</p></figure><pre class="ks kt ku kv gt no np nq nr aw ns bi"><span id="9f69" class="nd mc it np b gy nt nu l nv nw"># Add all the colors to a list.<br/>coloursList = ["#f50057", "#2196f3", "#00e676", "#ff5722", "#00000", "#ff9100"]</span><span id="48db" class="nd mc it np b gy nx nu l nv nw"># Pass the list to the colors parameter.<br/>Chord(matrix, names, colors=coloursList).show()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/4a80cd60175c3312799c1a24532bcbcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2n3c2X68hTgVUFgunHXfuA.png"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">作者图片</p></figure><p id="996b" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">其他定制:</p><p id="cbbd" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">你也可以自定义标签和不透明度，查看官方指南。</p><h1 id="b533" class="mb mc it bd md me mf mg mh mi mj mk ml ki mm kj mn kl mo km mp ko mq kp mr ms bi translated">结论:</h1><p id="3cd6" class="pw-post-body-paragraph ld le it lf b lg mt kd li lj mu kg ll lm mv lo lp lq mw ls lt lu mx lw lx ly im bi translated">创建可视化几乎总是数据科学家工作的一部分。<em class="lz">部分</em>是这里的关键词，因为这意味着你不能花太多时间来使它们成形，这就是为什么我们寻找提供简单但功能实现的选项。这就是我在本文中试图探索的，用最少的努力创建一个有效的和弦图。</p><p id="f6c7" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><em class="lz">这是我的第一部技术写作作品，我试图将我多年来从这个社区阅读优秀内容时遇到的最佳实践融入其中。我很感激对我工作的任何方面的反馈。</em></p><h1 id="4e21" class="mb mc it bd md me mf mg mh mi mj mk ml ki mm kj mn kl mo km mp ko mq kp mr ms bi translated"><strong class="ak">其他资源:</strong></h1><p id="bcf3" class="pw-post-body-paragraph ld le it lf b lg mt kd li lj mu kg ll lm mv lo lp lq mw ls lt lu mx lw lx ly im bi translated">[1] <a class="ae ma" href="https://shahinrostami.com/posts/statistics/data-is-beautiful/chord-diagrams/" rel="noopener ugc nofollow" target="_blank">官方指南</a> —沙欣·罗斯塔米的博客(图书馆作者)</p><p id="b75c" class="pw-post-body-paragraph ld le it lf b lg lh kd li lj lk kg ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">PyPi 上的[2] <a class="ae ma" href="https://pypi.org/project/chord/" rel="noopener ugc nofollow" target="_blank">和弦</a>——你可以在这里下载这个包。</p></div></div>    
</body>
</html>