<html>
<head>
<title>Simple abstractive text summarization with pretrained T5 — Text-To-Text Transfer Transformer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单的抽象文本摘要，带有预训练的T5-文本到文本转换转换器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simple-abstractive-text-summarization-with-pretrained-t5-text-to-text-transfer-transformer-10f6d602c426?source=collection_archive---------4-----------------------#2020-04-16">https://towardsdatascience.com/simple-abstractive-text-summarization-with-pretrained-t5-text-to-text-transfer-transformer-10f6d602c426?source=collection_archive---------4-----------------------#2020-04-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dacb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用T5文本到文本转换器的文本摘要</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4820e1afe552d93d191ead31431966e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iSbCjs11ZhTs-UsgX2RgrQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://pixabay.com/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>并由<a class="ae ky" href="https://chrome.google.com/webstore/detail/aiartist/odfcplkplkaoehpnclejafhhodpmjjmk" rel="noopener ugc nofollow" target="_blank">艺术Chrome插件</a>风格化</p></figure><p id="293c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">T5是Google的一个新的transformer模型，它以端到端的方式进行训练，以文本作为输入，以修改后的文本作为输出。你可以在这里了解更多关于<a class="ae ky" href="https://ai.googleblog.com/2020/02/exploring-transfer-learning-with-t5.html" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><p id="a3fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它使用在大型文本语料库上训练的文本到文本转换器，在多个自然语言处理任务上实现了最先进的结果，如摘要、问题回答、机器翻译等。</p><p id="0278" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天我们将看到如何使用huggingface的变形金刚库来总结任何给定的文本。T5是一种抽象的总结算法。这意味着它将在必要时重写句子，而不仅仅是直接从原文中提取句子。</p><p id="0b26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">开始之前，请在您的jupyter笔记本电脑或conda环境中安装这些库:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="fd9a" class="ma mb it lw b gy mc md l me mf">!pip install transformers==2.8.0<br/>!pip install torch==1.4.0</span></pre><h2 id="dae9" class="ma mb it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">文本输入:</h2><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5269" class="ma mb it lw b gy mc md l me mf">The US has "passed the peak" on new coronavirus cases, President Donald Trump said and predicted that <strong class="lw iu">some states would reopen</strong> this month.<strong class="lw iu">The US has over 637,000 confirmed Covid-19 cases and over 30,826 deaths, the highest for any country in the world.</strong>At the daily White House coronavirus briefing on Wednesday, Trump said new guidelines to reopen the country would be announced on Thursday after he speaks to governors.<strong class="lw iu">"We'll be the comeback kids, all of us," he said.</strong> "We want to get our country back."The Trump administration has previously fixed May 1 as a possible date to reopen the world's largest economy, but the president said some states may be able to return to normalcy earlier than that.</span></pre><h2 id="67a8" class="ma mb it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">T5汇总:</h2><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="edba" class="ma mb it lw b gy mc md l me mf">The us has over 637,000 confirmed Covid-19 cases and over 30,826 deaths. President Donald Trump predicts some states will reopen the country in <strong class="lw iu">april</strong>, he said. "we'll be the comeback kids, all of us," <strong class="lw iu">the president</strong> says.</span></pre><h2 id="e0ce" class="ma mb it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">分析输出:</h2><p id="5276" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">如果你看到算法已经智能地总结了提及<strong class="lb iu">四月</strong>虽然它在最初的故事<strong class="lb iu">中从未被提及。</strong>还把<strong class="lb iu">何</strong>换成了<strong class="lb iu">总裁。</strong>缩短并删除句子“超过30，826人死亡……”中逗号后的额外信息</p><h2 id="7ea2" class="ma mb it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">代码:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="d8ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与一些用户报告的Github Gist无法加载的代码相同:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="63d9" class="ma mb it lw b gy mc md l me mf">import torch<br/>import json <br/>from transformers import T5Tokenizer, T5ForConditionalGeneration, T5Config<br/><br/>model = T5ForConditionalGeneration.from_pretrained('t5-small')<br/>tokenizer = T5Tokenizer.from_pretrained('t5-small')<br/>device = torch.device('cpu')<br/><br/>text ="""<br/>The US has "passed the peak" on new coronavirus cases, President Donald Trump said and predicted that some states would reopen this month.<br/><br/>The US has over 637,000 confirmed Covid-19 cases and over 30,826 deaths, the highest for any country in the world.<br/><br/>At the daily White House coronavirus briefing on Wednesday, Trump said new guidelines to reopen the country would be announced on Thursday after he speaks to governors.<br/><br/>"We'll be the comeback kids, all of us," he said. "We want to get our country back."<br/><br/>The Trump administration has previously fixed May 1 as a possible date to reopen the world's largest economy, but the president said some states may be able to return to normalcy earlier than that.<br/>"""<br/><br/><br/>preprocess_text = text.strip().replace("\n","")<br/>t5_prepared_Text = "summarize: "+preprocess_text<br/>print ("original text preprocessed: \n", preprocess_text)<br/><br/>tokenized_text = tokenizer.encode(t5_prepared_Text, return_tensors="pt").to(device)<br/><br/><br/># summmarize <br/>summary_ids = model.generate(tokenized_text,<br/>                                    num_beams=4,<br/>                                    no_repeat_ngram_size=2,<br/>                                    min_length=30,<br/>                                    max_length=100,<br/>                                    early_stopping=True)<br/><br/>output = tokenizer.decode(summary_ids[0], skip_special_tokens=True)<br/><br/>print ("\n\nSummarized text: \n",output)<br/><br/># Summarized output from above ::::::::::<br/># the us has over 637,000 confirmed Covid-19 cases and over 30,826 deaths. <br/># president Donald Trump predicts some states will reopen the country in april, he said. <br/># "we'll be the comeback kids, all of us," the president says.</span></pre><p id="4a6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面提到的汇总输出是-</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0fcd" class="ma mb it lw b gy mc md l me mf">The us has over 637,000 confirmed Covid-19 cases and over 30,826 deaths. President Donald Trump predicts some states will reopen the country in <strong class="lw iu">april</strong>, he said. "we'll be the comeback kids, all of us," <strong class="lw iu">the president</strong> says.</span></pre><p id="2c07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中需要注意的关键点是，在将文本传递给T5摘要生成器之前，我们在文本前面加上了<strong class="lb iu">" summary:"</strong>。</p><p id="ecd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你看一下<a class="ae ky" href="https://arxiv.org/abs/1910.10683" rel="noopener ugc nofollow" target="_blank">论文</a>，对于其他任务，我们需要做的就是在我们的文本前面加上相应的字符串，例如:<strong class="lb iu">“将英语翻译成德语:”</strong>用于翻译任务。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="8643" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">祝NLP探索愉快，如果你喜欢它的内容，请随时在Twitter上找到我。</p><p id="85fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想学习使用变形金刚的现代自然语言处理，看看我的课程<a class="ae ky" href="https://www.udemy.com/course/question-generation-using-natural-language-processing/?referralCode=C8EA86A28F5398CBF763" rel="noopener ugc nofollow" target="_blank">使用自然语言处理生成问题</a></p></div></div>    
</body>
</html>