<html>
<head>
<title>Web Scraping Using Selenium</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Selenium 的网页抓取</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/web-scraping-e-commerce-website-using-selenium-1088131c8541?source=collection_archive---------12-----------------------#2020-08-17">https://towardsdatascience.com/web-scraping-e-commerce-website-using-selenium-1088131c8541?source=collection_archive---------12-----------------------#2020-08-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a1ae" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">抓取网上书店的一个简单例子。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e1f61841e4cd2cdc419839a26bb37575.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*srVewuvDoGBiKguFcW0IJg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Christopher Gower 在<a class="ae ky" href="https://unsplash.com/s/photos/web-scraping?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="2e6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我们将通过一个电子商务网站的网页抓取过程。我设计了这篇特别的帖子，是为了方便初学者。因此，如果您没有 web 抓取或 Selenium 方面的知识，您仍然可以继续学习。</p><p id="34ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了理解网络抓取，我们需要理解 HTML 代码的基础知识。我们也会谈到这一点。</p><h1 id="d768" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">HTML 基础</h1><p id="a743" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">关于 HTML 基础知识有很多东西要谈，但是我们将把重点放在对网络抓取有帮助的东西上(至少大多数时候)。</p><div class="kj kk kl km gt ab cb"><figure class="ms kn mt mu mv mw mx paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/a7177283ce6806e515fee983e40c4ee6.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*DvwwmSOwUtsQ7BGguegRNw.png"/></div></figure><figure class="ms kn my mu mv mw mx paragraph-image"><img src="../Images/4335ccad53eb8e767ca2cd12e2d7dd8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*T86a4yKbz2So9XY72uGpMA.png"/><p class="ku kv gj gh gi kw kx bd b be z dk mz di na nb translated">图 1，<strong class="bd nc">左</strong>:一个简单的 HTML 代码，<strong class="bd nc">右</strong> : HTML 元素，来源:作者</p></figure></div><ul class=""><li id="6035" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated"><strong class="lb iu"> HTML 元素</strong>(图 1 右侧)—HTML 元素是开始标签、其属性、结束标签以及它们之间的所有内容的集合。</li><li id="b393" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated"><strong class="lb iu">属性</strong> —是在开始标签中使用的特殊单词，用于控制元素的行为。属性及其值一起用于引用标记及其内容进行样式化。我们将在网络抓取中使用的最重要的属性包括<code class="fe nr ns nt nu b">class</code>、<code class="fe nr ns nt nu b">id</code>和<code class="fe nr ns nt nu b">name</code>。</li><li id="67cc" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated"><code class="fe nr ns nt nu b"><strong class="lb iu">class</strong></code> <strong class="lb iu">和</strong> <code class="fe nr ns nt nu b"><strong class="lb iu">id</strong></code> <strong class="lb iu">属性</strong> — HTML 元素可以有一个或多个类，用空格分隔(见上图 1 左)。另一方面，HTML 元素必须有唯一的<code class="fe nr ns nt nu b">id</code>属性，也就是说，一个<code class="fe nr ns nt nu b">id</code>不能用于引用多个 HTML 元素。</li></ul></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><h1 id="aa41" class="lv lw it bd lx ly oc ma mb mc od me mf jz oe ka mh kc of kd mj kf og kg ml mm bi translated">简单的网页抓取</h1><p id="1c35" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在我们进入电子商务网站的实际抓取之前，让我们抓取下图所示的网站(来自图 1 左边的 HTML 代码)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/ae8995a72674581a943aaa4317bbc66c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lFdMCZmKoaUw4UEJJBIkQA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 2:现场</p></figure><p id="1ea1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上图(图 2)中，请注意以下几点:</p><ol class=""><li id="532a" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu oi nj nk nl bi translated">这是统一资源定位符(<strong class="lb iu"> URL </strong>)。对于这种特殊的情况，定位器指向本地存储的 HTML 代码。</li><li id="3789" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu oi nj nk nl bi translated">当您在页面中悬停以识别您感兴趣的元素时，标记为 2 的按钮非常重要。一旦您感兴趣的对象被突出显示，标签元素也将被突出显示。</li><li id="3f04" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu oi nj nk nl bi translated">这是页面源代码。它只是像图 1 左边的 HTML 代码。您可以通过单击<strong class="lb iu"> Ctrl+Shift+I </strong>来检查页面，或者在站点上右键单击并选择选项上可用的<strong class="lb iu">检查元素</strong>或<strong class="lb iu">检查</strong>来查看该页面源代码。</li></ol></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><h1 id="7016" class="lv lw it bd lx ly oc ma mb mc od me mf jz oe ka mh kc of kd mj kf og kg ml mm bi translated">先决条件</h1><p id="aefd" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了进行网页抓取，我们需要<code class="fe nr ns nt nu b">selenium</code> Python 包(如果你没有这个包，用<code class="fe nr ns nt nu b">pip</code>安装)和浏览器<code class="fe nr ns nt nu b">webdriver</code>。为了让<code class="fe nr ns nt nu b">selenium</code>工作，它必须能够访问驱动程序。从这里下载与你的浏览器匹配的 web 驱动:<a class="ae ky" href="https://sites.google.com/a/chromium.org/chromedriver/downloads" rel="noopener ugc nofollow" target="_blank"> Chrome </a>、<a class="ae ky" href="https://github.com/mozilla/geckodriver/releases" rel="noopener ugc nofollow" target="_blank"> Firefox </a>、<a class="ae ky" href="https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/" rel="noopener ugc nofollow" target="_blank"> Edge </a>和<a class="ae ky" href="https://webkit.org/blog/6900/webdriver-support-in-safari-10/" rel="noopener ugc nofollow" target="_blank"> Safari </a>。下载 web 驱动程序后，保存它并记下路径。默认情况下，<code class="fe nr ns nt nu b"> selenium</code>会在当前工作目录下寻找驱动程序，因此你可能想把驱动程序保存在 Python 脚本所在的目录下。然而，您没有义务这样做。您仍然可以保存它，并在下面的第 5 行提供可执行文件的完整路径</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段 web 抓取的基本示例</p></figure><ul class=""><li id="f92a" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated"><strong class="lb iu">1 号线和 2 号线</strong>导入必要的库。</li><li id="7098" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated"><strong class="lb iu"> Line 4 an 5 </strong> —定义你下载的 web 驱动的路径，实例化一个 Chrome 驱动。我用的是 Chrome 网络驱动，但你也可以用 Firefox、Microsoft Edge 或 Safari。</li><li id="5add" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated"><strong class="lb iu">第 6 行</strong> —驱动程序在 5 中启动一个 Chrome 会话，并在 6 中获取 url 源。</li><li id="c240" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated"><strong class="lb iu">第 7 行和第 8 行</strong> —这一行暂停 Python 执行 5 秒钟，然后在第 8 行关闭浏览器。暂停是很重要的，这样你就可以对浏览器上发生的事情有一个粗略的了解，而关闭可以确保浏览会话结束，否则我们将会有很多 Chrome 会话窗口。等待页面加载时，睡眠时间也可能非常重要。然而，还有另一种开始等待的适当方法。</li></ul></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><h1 id="3fed" class="lv lw it bd lx ly oc ma mb mc od me mf jz oe ka mh kc of kd mj kf og kg ml mm bi translated">定位元素</h1><p id="c75d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这是网络抓取最重要的部分。在这一节中，我们需要学习如何通过使用不同的属性来获取 HTML 元素。</p><p id="d14c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">回忆</strong> : <strong class="lb iu">网页的元素可以用</strong> <code class="fe nr ns nt nu b"><strong class="lb iu">class</strong></code> <strong class="lb iu">、</strong> <code class="fe nr ns nt nu b"><strong class="lb iu">id</strong></code> <strong class="lb iu">、</strong> <code class="fe nr ns nt nu b"><strong class="lb iu">tag</strong></code> <strong class="lb iu">、</strong> <code class="fe nr ns nt nu b"><strong class="lb iu">name</strong></code> <strong class="lb iu">或/和</strong> <code class="fe nr ns nt nu b"><strong class="lb iu"> xpath</strong></code> <strong class="lb iu">来标识。id 是唯一的，但类不是。这意味着给定的</strong> <code class="fe nr ns nt nu b"><strong class="lb iu">class</strong></code> <strong class="lb iu">可以标识多个 web 元素，而一个</strong> <code class="fe nr ns nt nu b"><strong class="lb iu">id</strong></code> <strong class="lb iu">只能标识一个元素。</strong></p><p id="b321" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以使用以下任何一种方法来标识一个 HTML 元素</p><ul class=""><li id="bd7f" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">driver.find_element_by_id</li><li id="7f29" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">驱动程序.按名称查找元素</li><li id="15f7" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">driver.find_element_by_xpath</li><li id="ddc8" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">driver.find _ element _ by _ 标签 _ 名称</li><li id="9828" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">driver . find _ element _ byclass _ name</li></ul><p id="ba30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以使用以下任何一种方法来标识多个 HTML 元素(结果是找到的元素列表)</p><ul class=""><li id="48e1" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">驱动程序.按名称查找元素</li><li id="8e6f" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">driver.find_elements_by_xpath</li><li id="d90b" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">driver . find _ elements _ by _ tag _ name</li><li id="73d0" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">driver . find _ elements _ by _ class _ name</li></ul><p id="59e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意:</strong> <code class="fe nr ns nt nu b"><strong class="lb iu">id</strong></code> <strong class="lb iu">不能用于识别多个元素，因为</strong> <code class="fe nr ns nt nu b"><strong class="lb iu">id</strong></code> <strong class="lb iu">只能识别一个元素。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Snipet 2:定位元素</p></figure><p id="7420" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt ol nu om on aw oo bi"><span id="0ba6" class="op lw it nu b gy oq or l os ot">Element identified by id: <strong class="nu iu">Content 2 here</strong><br/>Element identified by class: <strong class="nu iu">Content here</strong><br/>Element identified by class: <strong class="nu iu">Content 3 here</strong><br/>Element identified by tag name: <strong class="nu iu">My First Heading</strong><br/>Element identified by xpath: <strong class="nu iu">My first paragraph.</strong></span></pre><ul class=""><li id="9e77" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated"><strong class="lb iu">第 8 行</strong> —注意<code class="fe nr ns nt nu b">container1</code>是标识两个元素的类属性值，<code class="fe nr ns nt nu b">drive.find_element_by_class_name</code>返回找到的第一个元素。</li><li id="03d8" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">为了从 HTML 元素中提取文本，我们使用了<code class="fe nr ns nt nu b">.text</code>函数，如上面的代码片段所示。</li><li id="3c78" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated"><strong class="lb iu">第 11 行</strong> —通过<code class="fe nr ns nt nu b">xpath</code>检查站点元素来定位元素，右键单击与感兴趣的元素匹配的源代码，并复制 XPath，如下图所示(图 3)</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/9331700e3404d24f8ac7730bf1c661f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z1JKBvOZ2qUKvZXRe_c8_w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 3:获取特定元素的 XPath</p></figure><p id="c3f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以识别并循环通过由<code class="fe nr ns nt nu b">container1</code>类识别的两个元素，如下所示</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段 3:定位多个元素</p></figure><p id="17de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt ol nu om on aw oo bi"><span id="a1ca" class="op lw it nu b gy oq or l os ot">Content here<br/>Content 3 here</span></pre></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><h1 id="cc75" class="lv lw it bd lx ly oc ma mb mc od me mf jz oe ka mh kc of kd mj kf og kg ml mm bi translated">抓取实际站点</h1><p id="3e63" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在，您已经了解了 selenium 的工作方式，让我们继续前进，清理我们应该清理的实际站点。我们将刮网上书店[ <a class="ae ky" href="http://books.toscrape.com/" rel="noopener ugc nofollow" target="_blank">链接</a> ]。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/31fdee3a508ef92e3b61cf6039967946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xnhrhcv8FK_qup7UOldv9g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 4:我们想要抓取的网站(来源:作者)</p></figure><p id="13c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将如下进行。</p><ul class=""><li id="d135" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">在页面上刮掉每本书的细节。每页 20 本书。利用每张卡片上的网址可以找到每本书的详细内容。因此，要获得这本书的详细信息，我们需要这个链接。</li><li id="545d" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">把书的每一页都刮下来。这意味着我们将有一个循环来抓取页面中的每本书，还有一个循环来遍历页面。</li><li id="b6b3" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">从一个页面移动到另一个页面需要修改 URL，这使得预测到任何页面的链接变得很容易。</li></ul><p id="409d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是页面:</p><ul class=""><li id="ebe9" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">第一页网址:<a class="ae ky" href="http://books.toscrape.com/" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/</a>。以下链接也适用于第 1 页:<a class="ae ky" href="http://books.toscrape.com/catalogue/page-1.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/page-1.html</a></li><li id="558b" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">第二页网址:<a class="ae ky" href="http://books.toscrape.com/catalogue/page-2.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/page-2.html</a></li><li id="be13" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">第三页网址:<a class="ae ky" href="http://books.toscrape.com/catalogue/page-3.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/page-3.html</a></li><li id="3c3a" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">第四页网址:<a class="ae ky" href="http://books.toscrape.com/catalogue/page-4.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/page-4.html</a></li><li id="7b20" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">等等</li></ul><p id="213a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">显然，我们可以注意到一个模式，它暗示着在页面中循环将会很简单，因为我们可以在循环过程中生成这些 URL。</p></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><h1 id="1c68" class="lv lw it bd lx ly oc ma mb mc od me mf jz oe ka mh kc of kd mj kf og kg ml mm bi translated"><strong class="ak">刮一本书</strong></h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/272cc1c026e2ea588685e8a3656e1a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zHkVQ8IQ-jpRZAwn6FMDTQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 5:一本书的元素检查。</p></figure><p id="f0b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在检查网站时，这里是突出显示区域的 HTML 代码(代表一本书)</p><pre class="kj kk kl km gt ol nu om on aw oo bi"><span id="23f8" class="op lw it nu b gy oq or l os ot">&lt;article class="product_pod"&gt;<br/> &lt;div class="image_container"&gt;<br/>  &lt;a href="the-nameless-city-the-nameless-city-1_940/index.html"&gt;<br/>   &lt;img src="../media/cache/f4/79/f479de5f305c2ac0512702cf7155bb74.jpg" alt="The Nameless City (The Nameless City #1)" class="thumbnail"&gt;<br/>   &lt;/a&gt;<br/>  &lt;/div&gt;<br/>  &lt;p class="star-rating Four"&gt;<br/>   &lt;i class="icon-star"&gt;&lt;/i&gt;<br/>   &lt;i class="icon-star"&gt;&lt;/i&gt;<br/>   &lt;i class="icon-star"&gt;&lt;/i&gt;<br/>   &lt;i class="icon-star"&gt;&lt;/i&gt;<br/>   &lt;i class="icon-star"&gt;&lt;/i&gt;<br/>  &lt;/p&gt;<br/>  &lt;h3&gt;<br/>   &lt;a href="the-nameless-city-the-nameless-city-1_940/index.html" title="The Nameless City (The Nameless City #1)"&gt;The Nameless City (The ...&lt;/a&gt;<br/>  &lt;/h3&gt;<br/>  &lt;div class="product_price"&gt;<br/>   &lt;p class="price_color"&gt;£38.16&lt;/p&gt;<br/>   &lt;p class="instock availability"&gt;<br/>    &lt;i class="icon-ok"&gt;&lt;/i&gt;<br/>    <br/>        In stock</span><span id="2ebf" class="op lw it nu b gy ov or l os ot">&lt;/p&gt;<br/>   &lt;form&gt;<br/>    &lt;button type="submit" class="btn btn-primary btn-block" data-loading-text="Adding..."&gt;Add to basket&lt;/button&gt;<br/>   &lt;/form&gt;<br/>  &lt;/div&gt;<br/> &lt;/article&gt;</span></pre><p id="f8bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们开始编码之前，让我们做一些观察</p><ul class=""><li id="d915" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">有问题的书在<code class="fe nr ns nt nu b">article</code>标签里面。值为<code class="fe nr ns nt nu b">product_prod</code>的类属性标签</li><li id="3f3a" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">我们在这张卡中需要的是获取 URL，也就是<code class="fe nr ns nt nu b"> a</code>标签中的<code class="fe nr ns nt nu b">href</code>。要进入<code class="fe nr ns nt nu b">href</code>，我们需要向下移动层次如下:<code class="fe nr ns nt nu b">class= “product_prod”</code> &gt; <code class="fe nr ns nt nu b">h3</code>标签&gt; <code class="fe nr ns nt nu b">a</code>标签和<code class="fe nr ns nt nu b">href</code>属性的 get 值。</li><li id="6a60" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">事实上，所有页面中的所有书籍都属于同一个类别<code class="fe nr ns nt nu b">product_prod</code>并带有<code class="fe nr ns nt nu b">article</code>标签。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/8edabf2079335ca5a9e82c29d38c8120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5nhTe2rz-c5EhRJ7a7d7fA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 6:一本书的详细信息页面(添加了注释以显示我们感兴趣的细节)</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">片段 4:搜集一本书的细节</p></figure><p id="c0e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们浏览几行代码，这样你就能理解代码实际上在做什么</p><ul class=""><li id="c0b4" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated"><strong class="lb iu">第 16 行到第 18 行— </strong>我们沿着 HTML 代码向下移动，以获得这本书的 URL。一旦我们得到链接，我们在<strong class="lb iu"> 19 打开。</strong>注意<strong class="lb iu"> 16 </strong>定位页面中所有的书，因为所有的书都属于同一个类<code class="fe nr ns nt nu b">product_prod</code>，这就是为什么我们对它进行索引(索引 0)以只获得一本书<strong class="lb iu">。</strong></li><li id="6b1d" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">同样值得注意的是，一本书的星级数是作为<code class="fe nr ns nt nu b">p</code>标签的属性而来的。这是这颗星的位置:</li></ul><pre class="kj kk kl km gt ol nu om on aw oo bi"><span id="b029" class="op lw it nu b gy oq or l os ot">&lt;p class="star-rating Four"&gt;<br/>   &lt;i class="icon-star"&gt;&lt;/i&gt;<br/>   &lt;i class="icon-star"&gt;&lt;/i&gt;<br/>   &lt;i class="icon-star"&gt;&lt;/i&gt;<br/>   &lt;i class="icon-star"&gt;&lt;/i&gt;<br/>   &lt;i class="icon-star"&gt;&lt;/i&gt;<br/>  &lt;/p&gt;</span></pre><p id="6ee0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这本书被评为 4 星级，但这一事实被隐藏为 class 属性的值。你用<code class="fe nr ns nt nu b">get_attribute(class)</code>来获取这样一个信息。在使用文本函数<strong class="lb iu">、</strong>提取第<strong class="lb iu">行第 24 </strong>行的内容时，您将得到这样一个字符串</p><pre class="kj kk kl km gt ol nu om on aw oo bi"><span id="44ad" class="op lw it nu b gy oq or l os ot">star-rating Four</span></pre><p id="ae4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们必须在使用第 28–38 行中的函数之前拆分字符串，以获得实际的星号。</p><ul class=""><li id="bbe3" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">如果你在<strong class="lb iu"> 23 </strong>中提取文本内容，你会得到这样的字符串</li></ul><pre class="kj kk kl km gt ol nu om on aw oo bi"><span id="464c" class="op lw it nu b gy oq or l os ot">In stock (22 available)</span></pre><p id="30cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要的只是数字 22，这意味着我们有 22 份拷贝。我们通过第 25 行实现了这一点，在这里我们使用正则表达式来提取数字。</p><pre class="kj kk kl km gt ol nu om on aw oo bi"><span id="f9f8" class="op lw it nu b gy oq or l os ot">re.findall("\d+","In stock (22 available)")</span><span id="47f9" class="op lw it nu b gy ov or l os ot">Output:<br/>['22']</span></pre><ul class=""><li id="9284" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">在正则表达式中,<code class="fe nr ns nt nu b">\d </code>表示值[0–9 ],而<code class="fe nr ns nt nu b">+</code>表示一个字符在该类中出现一次或多次，也就是说，在我们的例子中，我们希望捕获字符串中的任何数字(不考虑数字的数量)。</li></ul></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><h1 id="5949" class="lv lw it bd lx ly oc ma mb mc od me mf jz oe ka mh kc of kd mj kf og kg ml mm bi translated"><strong class="ak">把所有的书都刮到一页</strong></h1><p id="03f2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">回想一下上面的第 16 行定位页面中的所有书籍。因此，为了在一页中抓取所有的书，我们需要循环遍历该行中生成的列表，如下所示</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">片段 5:把所有的书都刮到一页。一页里有 20 本书。</p></figure><p id="e3aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦你理解了前面抓取一本书的例子，那么这本书应该很容易理解，因为唯一的区别是我们想要遍历所有的书来提取链接(<strong class="lb iu">第 33 行到第 38 行</strong>)，然后遍历这些链接来提取我们需要的信息(<strong class="lb iu">第 42–84 行</strong>)。</p><p id="5c34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个代码片段中，我们还引入了 try-except 块来捕捉我们想要的信息不可用的情况。具体来说，有些书漏掉了<code class="fe nr ns nt nu b">description</code>一节。</p><p id="60ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我相信您也会喜欢看到 selenium 在您观看时打开页面。尽情享受吧！</p></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><h1 id="903b" class="lv lw it bd lx ly oc ma mb mc od me mf jz oe ka mh kc of kd mj kf og kg ml mm bi translated"><strong class="ak">抓取所有页面的所有书籍</strong></h1><p id="3729" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这里要理解的关键概念是，我们需要循环遍历每一页中的每一本书，也就是说，这里涉及到两个循环。如前所述，我们知道页面 URL 遵循某种模式，例如，在我们的例子中，我们有</p><ul class=""><li id="c26f" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">第 1 页:<a class="ae ky" href="http://books.toscrape.com/index.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/index.html</a>或<a class="ae ky" href="http://books.toscrape.com/catalogue/page-2.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/page-1.html</a></li><li id="d2e7" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">第 2 页:<a class="ae ky" href="http://books.toscrape.com/catalogue/page-2.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/page-2.html</a></li><li id="d519" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">第三页:<a class="ae ky" href="http://books.toscrape.com/catalogue/page-2.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/page-3.html</a></li><li id="3dd9" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">等等，直到第 50 页(我们有 50 页的网站)。</li></ul><p id="78ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以很容易地创建一个 Python for-loop 来生成这样的 URL。让我们看看如何生成前 10 个</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段 6:通过修改页面 URL 生成 URL</p></figure><p id="1bef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出:</p><pre class="kj kk kl km gt ol nu om on aw oo bi"><span id="3c32" class="op lw it nu b gy oq or l os ot"><a class="ae ky" href="http://books.toscrape.com/catalogue/category/books_1/page-1.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/category/books_1/page-1.html</a><br/><a class="ae ky" href="http://books.toscrape.com/catalogue/category/books_1/page-2.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/category/books_1/page-2.html</a><br/><a class="ae ky" href="http://books.toscrape.com/catalogue/category/books_1/page-3.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/category/books_1/page-3.html</a><br/><a class="ae ky" href="http://books.toscrape.com/catalogue/category/books_1/page-4.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/category/books_1/page-4.html</a><br/><a class="ae ky" href="http://books.toscrape.com/catalogue/category/books_1/page-5.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/category/books_1/page-5.html</a><br/><a class="ae ky" href="http://books.toscrape.com/catalogue/category/books_1/page-6.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/category/books_1/page-6.html</a><br/><a class="ae ky" href="http://books.toscrape.com/catalogue/category/books_1/page-7.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/category/books_1/page-7.html</a><br/><a class="ae ky" href="http://books.toscrape.com/catalogue/category/books_1/page-8.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/category/books_1/page-8.html</a><br/><a class="ae ky" href="http://books.toscrape.com/catalogue/category/books_1/page-9.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/category/books_1/page-9.html</a><br/><a class="ae ky" href="http://books.toscrape.com/catalogue/category/books_1/page-10.html" rel="noopener ugc nofollow" target="_blank">http://books.toscrape.com/catalogue/category/books_1/page-10.html</a></span></pre><p id="ae7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们可以像下面这样简单地将所有页面中的所有书都刮掉</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码片段 7:抓取所有页面中的所有书籍(50 页，每页 20 本= 1000 本要抓取的书籍)</p></figure><p id="4f4b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个代码片段与上一个代码片段之间的唯一区别是，我们从第 34 行开始循环遍历页面，并且我们还将所有搜集到的信息写入一个名为<code class="fe nr ns nt nu b">all_pages.csv</code>的 CSV 文件中。</p><p id="40f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还使用 try-expect 来处理在抓取过程中可能出现的异常。如果出现异常，我们只需退出并关闭浏览器(<strong class="lb iu">第 94 行</strong>)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/5414a3766072f02310449989eeb37da6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lHpgofNibq5gE3saPU4xzg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 7:生成的 CSV 文件(all_pages.csv)的主视图</p></figure><h1 id="709f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="f429" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">Web 抓取是从互联网上收集数据的一个重要过程。不同的网站有不同的设计，因此没有一个特定的刮刀可以用于任何特定的网站。最基本的技能是在高层次上理解 web 抓取:知道如何定位 web 元素，并能够在出现错误时识别和处理错误。当我们在不同的网站上练习网络抓取时，这种理解就产生了。</p><p id="c089" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是更多网页抓取示例:</p><div class="ox oy gp gr oz pa"><a rel="noopener follow" target="_blank" href="/web-scraping-scraping-table-data-1665b6b2271c"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">网页抓取:抓取表格数据</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">在这篇文章中，我们将学习如何使用 Python 抓取 web 数据。简化。</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po ks pa"/></div></div></a></div><div class="ox oy gp gr oz pa"><a href="https://medium.com/analytics-vidhya/web-scraping-covid-19-data-using-beautifulsoup-in-python-1bc087918980" rel="noopener follow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">使用 Python 中的 BeautifulSoup 对新冠肺炎数据进行网络抓取</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">网络搜集是数据收集最重要的概念。在 Python 中，BeautfiulSoup、Selenium 和 XPath 是…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">medium.com</p></div></div><div class="pj l"><div class="pp l pl pm pn pj po ks pa"/></div></div></a></div><p id="bbb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，一些网站不允许他们的数据被抓取，尤其是抓取和发布结果。因此，在抓取之前检查站点策略是很重要的。</p></div><div class="ab cl nv nw hx nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="im in io ip iq"><p id="b713" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 https://medium.com/@kiprono_65591/membership<a class="ae ky" href="https://medium.com/@kiprono_65591/membership" rel="noopener">加入媒体</a>以获取媒体上的所有报道。</p><p id="b2ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你也可以在我发文章的时候通过这个链接把文章发到你的邮箱里:<a class="ae ky" href="https://medium.com/subscribe/@kiprono_65591" rel="noopener">https://medium.com/subscribe/@kiprono_65591</a></p><p id="a7f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一如既往地感谢您的阅读:-)</p></div></div>    
</body>
</html>