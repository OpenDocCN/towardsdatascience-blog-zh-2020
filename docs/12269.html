<html>
<head>
<title>Customer lifetime value in a discrete-time contractual setting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">离散时间契约环境下的顾客终身价值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/customer-lifetime-value-in-a-discrete-time-contractual-setting-math-and-python-implementation-af3ef606cefe?source=collection_archive---------24-----------------------#2020-08-24">https://towardsdatascience.com/customer-lifetime-value-in-a-discrete-time-contractual-setting-math-and-python-implementation-af3ef606cefe?source=collection_archive---------24-----------------------#2020-08-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="64e2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">数学和 Python 实现</h2></div><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="kn ko l"/></div></figure><h1 id="f6fb" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">激励性问题</h1><p id="dddf" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在按月/按年(即离散时间)订阅业务环境(即合同)中，根据我们当前客户的特征，新客户的预期价值是什么？</p><ul class=""><li id="7a95" class="md me it lj b lk mf ln mg lq mh lu mi ly mj mc mk ml mm mn bi translated">请注意，我们的设置是离散时间合同设置。如果你的商业模式不是基于订阅的(即非合同的)，请查看 Python 中的<a class="ae mo" href="https://lifetimes.readthedocs.io/en/latest/?badge=latest" rel="noopener ugc nofollow" target="_blank">生命周期</a>包。</li></ul><h1 id="1815" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">假设</h1><ul class=""><li id="491e" class="md me it lj b lk ll ln lo lq mp lu mq ly mr mc mk ml mm mn bi translated">这里我们只关注收入，而忽略了客户获取成本，以及其他成本。</li></ul><h1 id="5ce1" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">等式</h1><p id="1607" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">(法德尔、彼得和布鲁斯(2007 年 a))</p><p id="7bd1" class="pw-post-body-paragraph lh li it lj b lk mf ju lm ln mg jx lp lq ms ls lt lu mt lw lx ly mu ma mb mc im bi translated">客户生命周期价值期望值的等式非常简单:</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/f3b8c7cbbf4e18c2dca1ab5fb71b4307.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*Vr_ZqkdBENxCXU3jFuvf5w.png"/></div></figure><ul class=""><li id="fd11" class="md me it lj b lk mf ln mg lq mh lu mi ly mj mc mk ml mm mn bi translated">m:订阅率</li><li id="dc56" class="md me it lj b lk my ln mz lq na lu nb ly nc mc mk ml mm mn bi translated">s(t):t 时刻的生存函数</li><li id="37f3" class="md me it lj b lk my ln mz lq na lu nb ly nc mc mk ml mm mn bi translated">d:反映货币时间价值的贴现率</li></ul><h1 id="a1bc" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">例子</h1><p id="1963" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里有一个来自论文推子，彼得和布鲁斯(2007 年 b)的例子。假设我们有 1000 个客户，在第 1 年(t0)，我们有所有 1000 个客户。在第 2 年(t1)，只有 631 个客户是活跃的。到了第 5 年，只有 326 个客户仍然活跃。假设我们的订阅费率为 100 美元/年，折扣率为 10%。</p><ul class=""><li id="26f5" class="md me it lj b lk mf ln mg lq mh lu mi ly mj mc mk ml mm mn bi translated">m = 100 美元/年</li><li id="d316" class="md me it lj b lk my ln mz lq na lu nb ly nc mc mk ml mm mn bi translated">d = 10%</li></ul><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/3ca85c7b0248c175fd25de92a15917af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*pIrtrrfDFtT1PgG8IYFUeA.png"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/e5612a19e0aeb2f920c7bbbce9c34a8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xL8uNhhkQ7-kZoPTx3jRXA.png"/></div></div></figure><ul class=""><li id="da2c" class="md me it lj b lk mf ln mg lq mh lu mi ly mj mc mk ml mm mn bi translated">基于 CLV 方程，我们可以填入数据并改写方程，如上所示。</li><li id="5d99" class="md me it lj b lk my ln mz lq na lu nb ly nc mc mk ml mm mn bi translated">问题:唯一的问题是我们不知道未来的存活率。因此，我们可以使用几何贝塔模型来模拟我们的数据和预测生存函数。</li></ul><h1 id="ff25" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">几何贝塔模型</h1><p id="f21a" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">(法德尔、彼得和布鲁斯(2007 年 a))</p><h2 id="bd47" class="nj kq it bd kr nk nl dn kv nm nn dp kz lq no np lb lu nq nr ld ly ns nt lf nu bi translated">客户持续时间~ geometric(𝜃)</h2><p id="af26" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们假设客户持续时间/生命周期遵循几何分布，因为客户只能流失一次。</p><ul class=""><li id="545a" class="md me it lj b lk mf ln mg lq mh lu mi ly mj mc mk ml mm mn bi translated">流失概率:𝜃</li><li id="25ce" class="md me it lj b lk my ln mz lq na lu nb ly nc mc mk ml mm mn bi translated">留任概率:1−𝜃</li><li id="6a92" class="md me it lj b lk my ln mz lq na lu nb ly nc mc mk ml mm mn bi translated">时间 t 时客户流失的概率:</li></ul><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/07ceff0f192c993f928463e2bfd64b8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*TzKb1MoXgaCFgutnfVPwyg.png"/></div></figure><ul class=""><li id="c6ef" class="md me it lj b lk mf ln mg lq mh lu mi ly mj mc mk ml mm mn bi translated">时间 t 时的存活率:</li></ul><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/0923292d16220571a1afd64bd91ed0dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*gidYk_xZ7ts-V8F2QnGKRw.png"/></div></figure><ul class=""><li id="8881" class="md me it lj b lk mf ln mg lq mh lu mi ly mj mc mk ml mm mn bi translated">时间 t 时的保留率:</li></ul><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/2189e176e7f0a5c0092867346a2ab2c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:364/format:webp/1*tS7PFhHyjF9M_g0PpjgXPA.png"/></div></figure><h2 id="f786" class="nj kq it bd kr nk nl dn kv nm nn dp kz lq no np lb lu nq nr ld ly ns nt lf nu bi">𝜃∼𝑏𝑒𝑡𝑎(𝛼,𝛽)</h2><p id="ce1b" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们将𝜃的异质性建模为贝塔分布。我们使用贝塔分布，因为它以区间[0，1]为界，并且它有各种可能的形状。</p><ul class=""><li id="c40b" class="md me it lj b lk mf ln mg lq mh lu mi ly mj mc mk ml mm mn bi translated">定义在区间[0，1]上</li></ul><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/e60e619014eb81e11099c8c32cefc739.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*QkZW95mmVT8bdMVniL8_7Q.png"/></div></figure><h2 id="a721" class="nj kq it bd kr nk nl dn kv nm nn dp kz lq no np lb lu nq nr ld ly ns nt lf nu bi translated">几何贝塔分布</h2><p id="d1e5" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">然后我们可以结合几何分布和贝塔分布，计算联合分布。并且通过一些贝塔函数和伽玛函数的计算，我们可以计算出客户在任意时刻 t 的流失概率，以及任意时刻 t 的留存率。</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/c6024e6df4851399b7e662368ab3017d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*piJrU1AbbopjPwzoT8-vpw.png"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi oa"><img src="../Images/5af2e8ba985cdb965b36fca954ce5343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UfrddpI8mSx4Jho2OVrkwQ.png"/></div></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/e5679ae6b21ecbbcbddb82ed353b161a.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*Sw_LiFNGXm02KKuoeJsZXg.png"/></div></figure><ul class=""><li id="d589" class="md me it lj b lk mf ln mg lq mh lu mi ly mj mc mk ml mm mn bi translated">可能性函数:在 t1 失去𝑛1n1 客户的概率，在 t2 失去𝑛2 客户的概率，以及在观察期结束时保留𝑛−∑𝑛_t 客户的概率。</li></ul><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi oc"><img src="../Images/bf23170750717454186b35fa19d18d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ih5viA2zvNpqzwdQcnt6Jg.png"/></div></div></figure><p id="7277" class="pw-post-body-paragraph lh li it lj b lk mf ju lm ln mg jx lp lq ms ls lt lu mt lw lx ly mu ma mb mc im bi translated">对数似然函数:𝐿𝐿(𝛼,𝛽|𝑑𝑎𝑡𝑎)=𝑙𝑛(𝐿(𝛼,𝛽|𝑑𝑎𝑡𝑎))</p><h2 id="bd28" class="nj kq it bd kr nk nl dn kv nm nn dp kz lq no np lb lu nq nr ld ly ns nt lf nu bi translated">找出𝛼和𝛽的最大似然估计量</h2><ul class=""><li id="4514" class="md me it lj b lk ll ln lo lq mp lu mq ly mr mc mk ml mm mn bi translated">为了找到参数的最大似然估计量，我们将对数似然函数最大化或负对数似然函数最小化。通过最优化过程，我们得到了𝛼和𝛽.的最大似然估计值</li></ul><h1 id="8d64" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">计算 CLV</h1><h2 id="6a4f" class="nj kq it bd kr nk nl dn kv nm nn dp kz lq no np lb lu nq nr ld ly ns nt lf nu bi translated">给定𝛼和𝛽，计算每个时间点的存活率</h2><ul class=""><li id="bb9c" class="md me it lj b lk ll ln lo lq mp lu mq ly mr mc mk ml mm mn bi translated">𝑟(𝑡)=(𝛽+𝑡−1)/(α+β+t−1)</li><li id="16b7" class="md me it lj b lk my ln mz lq na lu nb ly nc mc mk ml mm mn bi translated">t = 0 时的𝑠(𝑡)=1</li><li id="4239" class="md me it lj b lk my ln mz lq na lu nb ly nc mc mk ml mm mn bi translated">𝑠(𝑡)=𝑟(𝑡)𝑠(𝑡−1)当 t&gt;0 时</li></ul><h2 id="424c" class="nj kq it bd kr nk nl dn kv nm nn dp kz lq no np lb lu nq nr ld ly ns nt lf nu bi translated">计算 CLV</h2><p id="6cb5" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">为 k 选择一个合理的大数</p><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi od"><img src="../Images/bbc048b2684a02de11a9e705983f3307.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*NE42D1hDpAu1qNwMnQ_oHg.png"/></div></figure><h1 id="a480" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">Python 实现</h1><h1 id="aec4" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">最大似然估计</h1><p id="bb3d" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这是我的 Python 实现，用于计算对数似然函数，并优化负对数似然函数。注意，我们需要给参数一个初始值，作为优化的起点。在我们的例子中，𝛼和𝛽的初始值都是 1。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="oe ko l"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi of"><img src="../Images/6f6d195d60371396b70d49bb1aea4964.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wmiabB-M2OpBuJvdWG9_Rw.png"/></div></div></figure><p id="8c0d" class="pw-post-body-paragraph lh li it lj b lk mf ju lm ln mg jx lp lq ms ls lt lu mt lw lx ly mu ma mb mc im bi translated">通过优化，优化后的负对数似然为 1409.5，𝛼和𝛽的最大似然分别为 0.78 和 1.35。</p><h1 id="7936" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">模型拟合</h1><p id="6413" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这是我访问模型拟合的函数。这里我只是比较观察到的和计算出的存活率。你可以改变这个函数来比较似然函数和保持率。</p><p id="ec9a" class="pw-post-body-paragraph lh li it lj b lk mf ju lm ln mg jx lp lq ms ls lt lu mt lw lx ly mu ma mb mc im bi translated">这里的第一个图使用了初始参数(1，1)作为模型参数，我们可以看到模型计算出的存活率不是很理想。第二个图使用参数的最大似然值，模型计算的存活率非常接近观察到的存活率。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="oe ko l"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi og"><img src="../Images/1ce8d296f9e353c3ba97048453dbe408.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2AMAeeVrhj1w5FLUQceb7Q.png"/></div></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi oh"><img src="../Images/ed2ced4f8ed0a41f7f0b6ed6b62e9ec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AvDVWUhylXWvHGAB-xHrqg.png"/></div></div></figure><h1 id="f173" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">计算 CLV</h1><p id="9a81" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">现在，我们可以使用 MLE 参数来计算客户终身价值的期望值。我们可以看到，一个新客户的期望值是 362 美元。</p><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="oe ko l"/></div></figure><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi oi"><img src="../Images/7d8da68644b1ab9fc8230eb996955fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZTX3w7vSRCUcj6ndXJAKRw.png"/></div></div></figure><p id="dccf" class="pw-post-body-paragraph lh li it lj b lk mf ju lm ln mg jx lp lq ms ls lt lu mt lw lx ly mu ma mb mc im bi translated">参考资料:<br/> Fader，Peter S .和 Bruce G.S. Hardie (2014)，“一个懂电子表格的非统计学家的贝塔几何模型指南。”<a class="ae mo" href="http://brucehardie.com/notes/032/" rel="noopener ugc nofollow" target="_blank">http://brucehardie.com/notes/032/</a><br/> Fader，Peter S .和 Bruce G.S. Hardie (2017)，“探索客户终身价值的分布(在合同环境中)。”<a class="ae mo" href="http://brucehardie.com/notes/035/" rel="noopener ugc nofollow" target="_blank">http://brucehardie.com/notes/035/</a></p></div></div>    
</body>
</html>