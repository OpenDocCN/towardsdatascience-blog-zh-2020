<html>
<head>
<title>How To Create Unique Pokémon Using GANs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用GANs创建独特的神奇宝贝</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-unique-pok%C3%A9mon-using-gans-ea1cb6b6a5c2?source=collection_archive---------18-----------------------#2020-03-28">https://towardsdatascience.com/how-to-create-unique-pok%C3%A9mon-using-gans-ea1cb6b6a5c2?source=collection_archive---------18-----------------------#2020-03-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="797e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以及如何让它变得更好的想法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/ca1e273dd982ee8902ff67dcc9d994ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*Msfdc3qsGv9vZkc_w11ynQ.png"/></div></figure><p id="8b8c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我儿子真的很喜欢口袋妖怪。我不明白，但我想这是题外话。不过，我确实开始想知道，我是否可以利用深度学习自动为他创建新的口袋妖怪卡片。</p><p id="7a3b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我最终成功地使用生成对抗网络(GANs)生成了类似口袋妖怪的图像，我想其他人可能会喜欢看到这个过程。</p><h2 id="e612" class="lm ln it bd lo lp lq dn lr ls lt dp lu kz lv lw lx ld ly lz ma lh mb mc md me bi translated">生成对抗网络</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mf"><img src="../Images/114929fa62a975e7a8f00c6eabfc3e1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*61Nyx7J7MZo9kcCg.png"/></div></div><p class="mk ml gj gh gi mm mn bd b be z dk translated"><a class="ae mo" rel="noopener" target="_blank" href="/generative-adversarial-networks-explained-34472718707a">来源</a></p></figure><p id="78a5" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我不想花太多时间讨论什么是gan，但上面的图像是对过程的一个非常简单的解释。</p><p id="27f3" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">你训练两个网络——一个鉴别器和一个生成器。生成器学习如何接受随机噪声并生成看起来像来自训练数据的图像的图像。它通过将其生成的图像馈送到鉴别器网络来做到这一点，该鉴别器网络被训练来辨别真实图像和生成的图像。</p><p id="a4cf" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">生成器被优化以越来越好地欺骗鉴别器，而鉴别器被优化以越来越好地检测生成的图像。因此，两者共同提高。</p><p id="3c86" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果你想了解更多，你可以通过谷歌找到许多令人惊叹的文章、书籍和YouTube视频。</p><p id="6054" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">所以——我的假设是，我可以用真实的口袋妖怪图像作为我的训练集来训练GAN。结果将是一个发电机，然后将能够创造新的口袋妖怪！太棒了。</p><h2 id="4be8" class="lm ln it bd lo lp lq dn lr ls lt dp lu kz lv lw lx ld ly lz ma lh mb mc md me bi translated"><strong class="ak">数据</strong></h2><p id="55a8" class="pw-post-body-paragraph kq kr it ks b kt mp ju kv kw mq jx ky kz mr lb lc ld ms lf lg lh mt lj lk ll im bi translated">我的第一个挑战是寻找口袋妖怪的图像。幸运的是，Kaggle数据集拯救了我们！</p><p id="f571" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">有人已经想到了一个类似的想法，虽然听起来他在生成新的口袋妖怪图像方面没有太大的成功，但是因为他花了时间收集800多张图像，他决定将它们上传到Kaggle <a class="ae mo" href="https://www.kaggle.com/kvpratama/pokemon-images-dataset#101.png" rel="noopener ugc nofollow" target="_blank">数据集</a>。</p><p id="f5b4" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这节省了我大量的时间。</p><p id="051b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我还了解到，实际上只有大约800个口袋妖怪，所以不可能用额外的口袋妖怪来扩展这个数据集。</p><p id="3cb5" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">以下是其中一幅图像的示例(256 x 256):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/7a565e31ec29a4b5bde58ca33429a2e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*X3lU0qgn1-6PJsbRtGH6tw.png"/></div></figure><h2 id="8a64" class="lm ln it bd lo lp lq dn lr ls lt dp lu kz lv lw lx ld ly lz ma lh mb mc md me bi translated">该算法</h2><p id="fdc9" class="pw-post-body-paragraph kq kr it ks b kt mp ju kv kw mq jx ky kz mr lb lc ld ms lf lg lh mt lj lk ll im bi translated">现在我有了数据，我必须选择我想要使用的GAN类型。可能存在数百种不同的GAN，但我在过去使用<strong class="ks iu"> DCGAN </strong>时看到了很好的结果。</p><p id="715b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">DCGAN从神经网络中消除任何完全连接的层，使用转置卷积进行上采样，并用卷积步长(以及其他)替换最大池。</p><p id="7e5e" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我喜欢DCGANs，因为与我尝试过的其他gan相比，它们似乎更健壮，因此更容易训练，而无需对超参数进行重大调整。</p><p id="fbc6" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">事实上，DCGAN是如此受欢迎，以至于PyTorch有一个非常好的实现作为它的<a class="ae mo" href="https://github.com/pytorch/examples/tree/master/dcgan" rel="noopener ugc nofollow" target="_blank">例子之一</a>。最棒的是，他们的例子可以直接从文件夹中读取输入。因此，通过下面的命令，我可以开始训练我的GAN:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="1ac4" class="lm ln it mw b gy na nb l nc nd">python main.py --dataset folder --dataroot ~/Downloads/pokemon/  --cuda --niter 10000 --workers 8</span></pre><p id="b437" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这个命令从~/Downloads/pokemon文件夹中读取图像，在我的GPU上运行，有8个工人加载数据，并运行10，000次迭代。</p><p id="8d08" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">事实证明10，000次迭代对这个问题来说太多了，但是我想看看我能把它推进多远。我们来看看吧！</p><h2 id="9876" class="lm ln it bd lo lp lq dn lr ls lt dp lu kz lv lw lx ld ly lz ma lh mb mc md me bi translated">结果呢</h2><p id="2708" class="pw-post-body-paragraph kq kr it ks b kt mp ju kv kw mq jx ky kz mr lb lc ld ms lf lg lh mt lj lk ll im bi translated">第一步从一无所知的网络开始，所以产生的都是噪音:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/0f8d15c7037b5cc195819ec57baeafdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*YULDRdcLvPzuGsBRIY4gPg.png"/></div></figure><p id="ec03" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">每个盒子是一个64 x 64像素的图像，并试图从我们的生成器生成一个口袋妖怪。由于我们的网格是8 x 8，我们有64个不同的口袋妖怪试图生成。我将图像缩小到64 x 64，因为当试图生成更大的图像时，这种算法变得不稳定(或者至少对我来说是这样)。</p><p id="4e49" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">50个纪元后，我们开始看到一些生命:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/f7d632e3189d04085e84e554a011ca70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*zSff86KHT--P3q1G0LvkIw.png"/></div></figure><p id="0485" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">150年后，事情变得更清楚了:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/896808227e9d80746982a263e9bb9b59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*nkCAfi5Kcl5IrcEBeF959A.png"/></div></figure><p id="1afa" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">3700后，你有一些中途体面的64 x 64尝试口袋妖怪。在这之后，它开始转向更坏的结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/ca1e273dd982ee8902ff67dcc9d994ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*Msfdc3qsGv9vZkc_w11ynQ.png"/></div></figure><p id="bed6" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在——我知道你在想什么，那些看起来一点也不像口袋妖怪！</p><p id="408b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我想请你把浏览器缩小到25%左右，再看一遍。<strong class="ks iu">从远处看，它们和真正的口袋妖怪惊人地相似。</strong></p><p id="e1db" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">问题是，由于我们是在64 x 64的图像上进行训练，鉴别器很容易被形状和颜色都像口袋妖怪的图像所欺骗，因此生成器不需要改进。</p><h2 id="0a89" class="lm ln it bd lo lp lq dn lr ls lt dp lu kz lv lw lx ld ly lz ma lh mb mc md me bi translated">后续步骤</h2><p id="6c81" class="pw-post-body-paragraph kq kr it ks b kt mp ju kv kw mq jx ky kz mr lb lc ld ms lf lg lh mt lj lk ll im bi translated">在我看来，显而易见的下一步是训练更高分辨率的GAN。事实上，我已经在这方面做了一些尝试。</p><p id="9eb3" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我的第一次尝试是重写PyTorch代码，以缩放到256 x 256的图像。代码起作用了，但是DCGAN坏了，我无法稳定训练。我相信这主要是因为我只有大约800张图片。虽然我做了一些数据扩充，但这不足以训练更高分辨率的DCGAN。</p><p id="0fc5" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">然后，我尝试使用一个<a class="ae mo" href="https://arxiv.org/abs/1807.00734" rel="noopener ugc nofollow" target="_blank">相对论GAN </a>，它已经成功地用小数据集对高分辨率数据进行了训练，但也无法正常工作。</p><p id="5f13" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我将继续尝试一些其他的想法来生成更高分辨率的口袋妖怪，如果我得到一些工作，我会张贴我使用的技术。</p><p id="1d7b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">别的不说，也许我们可以把这些生成的口袋妖怪<strong class="ks iu">叫做烟雾型口袋妖怪？</strong></p><p id="98f4" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">你也可以在这里找到这个故事。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="945e" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">有兴趣了解有关Python数据分析和可视化的更多信息吗？查看我的<a class="ae mo" href="https://www.educative.io/courses/python-data-analysis-and-visualization" rel="noopener ugc nofollow" target="_blank">课程</a>。</p></div></div>    
</body>
</html>