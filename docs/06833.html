<html>
<head>
<title>Visualizing Crime and Twitter Data for New Zealand</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可视化新西兰的犯罪和Twitter数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-crime-and-twitter-data-for-new-zealand-e79aa5b759ed?source=collection_archive---------63-----------------------#2020-05-27">https://towardsdatascience.com/visualizing-crime-and-twitter-data-for-new-zealand-e79aa5b759ed?source=collection_archive---------63-----------------------#2020-05-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="ae41" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><strong class="ak"> <em class="jb">推特科学</em> </strong></h2><div class=""/><div class=""><h2 id="2cde" class="pw-subtitle-paragraph ka jd it bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">用R，Shiny，Python和QGIS3开发的可视化app。</h2></div><h2 id="847f" class="ks kt it bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm iz bi translated">推特和执法</h2><p id="dfb3" class="pw-post-body-paragraph ln lo it lp b lq lr ke ls lt lu kh lv lb lw lx ly lf lz ma mb lj mc md me mf im bi translated">新西兰警方的目标是提高公民参与度，同时提高警务效率。量化公民参与度的方法之一是观察他们的twitter习惯，以确定其与该地区犯罪的相关性。</p><p id="fff0" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">这项工作背后的基本想法是通过分析他们的推文来可视化特定地点的犯罪和该地区人民的情绪。显然，对于像新西兰这样一个人口稀少的国家来说，选择分享地理位置的人太少了，这种分析不可信。</p><p id="198a" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">因此，我们使用了5年内发送到https://twitter.com/nzpolice<a class="ae ml" href="https://twitter.com/nzpolice" rel="noopener ugc nofollow" target="_blank">的推文总数以及新西兰各地区的犯罪数据。本文描述了开发可视化的方法。检查短视频，看看它看起来怎么样。</a></p><figure class="mm mn mo mp gt mq"><div class="bz fp l di"><div class="mr ms l"/></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">分析犯罪和推特数据</p></figure><h2 id="81e3" class="ks kt it bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm iz bi translated">提取推文</h2><p id="6e50" class="pw-post-body-paragraph ln lo it lp b lq lr ke ls lt lu kh lv lb lw lx ly lf lz ma mb lj mc md me mf im bi translated">我试图获得Twitter开发者的帐户，但它被拒绝，声称它不符合他们的条款和条件，这是愚蠢的。因为我既没有做任何商业目的的事情，也没有试图窃取私人数据。这只是一个小实验。所以我用了<a class="ae ml" href="https://github.com/jonbakerfish/TweetScraper" rel="noopener ugc nofollow" target="_blank"> TweetScraper </a>，它实际上工作得很好，尽管它不是没有错误。</p><p id="41fb" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">我摘录了2015年到2020年初发给新西兰警方的推文。下面的命令是一个典型的例子。</p><pre class="mm mn mo mp gt mx my mz na aw nb bi"><span id="8ad8" class="ks kt it my b gy nc nd l ne nf">scrapy crawl TweetScraper -a "query=@nzpolice near:Auckland since:2014-07-01 until:2020-03-31"</span></pre><p id="f5a5" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">这个查询并没有真正的用处，因为在这段时间的80，000多条推文中，只有几百个用户允许从奥克兰进行地理定位访问。用它来分析毫无意义。</p><h2 id="0bef" class="ks kt it bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm iz bi translated">推文感悟</h2><p id="c895" class="pw-post-body-paragraph ln lo it lp b lq lr ke ls lt lu kh lv lb lw lx ly lf lz ma mb lj mc md me mf im bi translated">我在寻找深度学习来进行适当的情感分析，但并不热衷于在这个方向上做更多的研究。这是一个单独的话题，NLP的深度学习是一个正在增长的领域，但还没有接近与视觉相关的应用。因此，我决定使用非常简单易用的<a class="ae ml" href="https://github.com/cjhutto/vaderSentiment" rel="noopener ugc nofollow" target="_blank">Vader presentation</a>。</p><pre class="mm mn mo mp gt mx my mz na aw nb bi"><span id="f986" class="ks kt it my b gy nc nd l ne nf">import re<br/>from vaderSentiment.vaderSentiment import SentimentIntensityAnalyzer<br/>from tqdm import tqdm_notebook<br/>analyser = SentimentIntensityAnalyzer()</span><span id="db1c" class="ks kt it my b gy ng nd l ne nf">sentiment = []</span><span id="51f0" class="ks kt it my b gy ng nd l ne nf">for i,tweet in enumerate(tqdm_notebook(tweets)):<br/>    string = tweet<br/>    string = re.sub(r'https?:\S+', "", string) #Removes Hyperlink<br/>    string = re.sub('@[^\s]+','',string) #Removes Usernames<br/>    string = re.sub('#[^\s]+','',string) #Removes Hashtags<br/>    <br/>    score = analyser.polarity_scores(string)<br/>    score.pop('compound')<br/>    sentiment.append(max(score, key=score.get))</span></pre><h2 id="144d" class="ks kt it bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm iz bi translated">警方犯罪数据</h2><p id="d62c" class="pw-post-body-paragraph ln lo it lp b lq lr ke ls lt lu kh lv lb lw lx ly lf lz ma mb lj mc md me mf im bi translated">从<a class="ae ml" href="https://www.police.govt.nz/about-us/publications-statistics/data-and-statistics/policedatanz/victimisation-time-and-place" rel="noopener ugc nofollow" target="_blank">警方网站</a>提取受害数据。顺便说一句，他们已经用Tableau实现了可视化。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nh"><img src="../Images/259d9dae066b146ef43469526fca7fa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fc8fpwVe8oegRldFPyBD5A.png"/></div></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">来自新西兰警方网站</p></figure><h2 id="bc30" class="ks kt it bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm iz bi translated">数据准备</h2><p id="6676" class="pw-post-body-paragraph ln lo it lp b lq lr ke ls lt lu kh lv lb lw lx ly lf lz ma mb lj mc md me mf im bi translated">说到数据准备，没有什么能打败熊猫。因为这是一个已经被警方清理和管理过的结构化数据，所以任务相当简单。下面是代码片段。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi no"><img src="../Images/f60df5097afe4fc475edae89f98b056b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KuhFCyOdrnlrX46a0I3gbw.png"/></div></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">代码快照</p></figure><h2 id="cf48" class="ks kt it bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm iz bi translated">闪亮的应用仪表板</h2><p id="6a9f" class="pw-post-body-paragraph ln lo it lp b lq lr ke ls lt lu kh lv lb lw lx ly lf lz ma mb lj mc md me mf im bi translated">所以这个练习的真正乐趣就是去做。由于我对这些工具很熟悉，我选择了R和Shiny来开发可视化。闪亮的仪表板使得制作高质量的交互式可视化效果变得非常容易。</p><p id="8495" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">Shiny将这个过程分解为用户界面和服务器。逻辑驻留在服务器中，而UI可以单独管理。很容易在侧面板上设置控制面板。</p><p id="5758" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">可视化由两部分组成。第一个是choropleth。维基百科对choropleth的定义是:</p><blockquote class="np nq nr"><p id="2d81" class="ln lo ns lp b lq mg ke ls lt mh kh lv nt mi lx ly nu mj ma mb nv mk md me mf im bi translated"><strong class="lp je"> choropleth地图</strong>(来自<a class="ae ml" href="https://en.wikipedia.org/wiki/Greek_language" rel="noopener ugc nofollow" target="_blank">希腊语</a> χῶρος“区域/地区”和πλῆθος“大众”)是一种<a class="ae ml" href="https://en.wikipedia.org/wiki/Thematic_map" rel="noopener ugc nofollow" target="_blank">主题地图</a>，其中区域按照统计变量的比例进行阴影化或图案化，该统计变量代表每个区域内地理特征的汇总，例如人口密度或<a class="ae ml" href="https://en.wikipedia.org/wiki/Per-capita_income" rel="noopener ugc nofollow" target="_blank">人均收入</a>。</p></blockquote><p id="48c3" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">如上所述，这基本上就是警方网站上显示的内容。</p><p id="6fa4" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">第二个是推特和犯罪的时间序列数据。R中Dygraph的使用使其成为一个交互式的情节。以下是它的快照。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nw"><img src="../Images/5efbe576dcb817484cc44713e086985b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GStVMijdjJgOK1ODuDPDjQ.png"/></div></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">新西兰犯罪和推特活动的时间序列</p></figure><p id="5c77" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">注意，2019年3月有一个峰值。这是新西兰历史上不幸的一天，克赖斯特彻奇发生了枪战。</p><p id="ab9d" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">新西兰警方的推特账号上还有其他一些推特活动高峰，对此进行调查会很有趣。总的来说，我看不出推特活动和犯罪活动之间有任何联系。虽然我在刑事案件中看到了某种循环。我想知道它是否比实地的实际事件更具行政性。</p><h2 id="17d0" class="ks kt it bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm iz bi translated">使用QGIS3创建矢量文件</h2><p id="c9f6" class="pw-post-body-paragraph ln lo it lp b lq lr ke ls lt lu kh lv lb lw lx ly lf lz ma mb lj mc md me mf im bi translated">最有趣的部分是在QGIS中，多边形被准备好放在地图上。很难确定一个载体形状文件，其中包含的区域与警方用于管理的区域相同。更重要的是有相同的名字。例如，警察数据集将奥克兰称为奥克兰市。</p><p id="f8dc" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">网上有许多矢量文件。例如<a class="ae ml" href="https://freevectormaps.com/new-zealand" rel="noopener ugc nofollow" target="_blank">链接</a></p><p id="8084" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">QGIS使得根据需要合并不同区域和重命名要素变得非常容易。它肯定不如商业版的ArcGIS，但进步很快。我已经在不同的项目中使用它两年了，我已经看到新版本有了很大的改进。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nx"><img src="../Images/6851170ea90530dbc25ed71a32f15139.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HD3tYgLSxZRQdBY7XOgRZw.png"/></div></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">QGIS3在运行</p></figure><p id="3d0d" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">这是最终应用程序的样子。请注意，不同地区的犯罪数量差异很大。因此，颜色编码很困难。因此，使用对数标度。</p><p id="e983" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">此外，滑块会导致不必要的计算，因为滑块中的每个增量都会重新计算贴图。应该使用更好的输入部件。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi ny"><img src="../Images/651ee302d8ae4f22db3a2e603300b037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d_F6cOuJmo-UOZBzuoX-VQ.png"/></div></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">最终可视化的快照</p></figure><h2 id="b837" class="ks kt it bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm iz bi translated">后续步骤</h2><p id="0014" class="pw-post-body-paragraph ln lo it lp b lq lr ke ls lt lu kh lv lb lw lx ly lf lz ma mb lj mc md me mf im bi translated">这只是一个简单的可视化，并没有提供任何尚未知晓或预期的见解。这些是我在扩展这项基础工作时可能会用到的一些想法。首先，我收集了Twitter数据。很多都是对一系列事件的反应。</p><p id="a03c" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">了解人们在什么水平上参与这些活动并量化他们的情感投入将会很好。目前，情绪只是积极，消极和中性的。这将是有用的分配学位，这是一个极其困难的问题。</p><p id="842f" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">此外，通过给犯罪添加更多类别来使这种可视化更有用也是不错的。虽然不可能确定地理位置，但量化人们对这些到来的参与度会很好。举例来说，它可以让我们了解与金融犯罪相比，人们对毒品的担忧程度。</p><p id="2b25" class="pw-post-body-paragraph ln lo it lp b lq mg ke ls lt mh kh lv lb mi lx ly lf mj ma mb lj mk md me mf im bi translated">在<a class="ae ml" href="https://github.com/deepakkarunakaran/nzpolice" rel="noopener ugc nofollow" target="_blank">https://github.com/deepakkarunakaran/nzpolice</a>找到代码</p></div></div>    
</body>
</html>