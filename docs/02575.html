<html>
<head>
<title>How to Solve Analogies with Word2Vec</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Word2Vec解决类比问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-solve-analogies-with-word2vec-6ebaf2354009?source=collection_archive---------11-----------------------#2020-03-12">https://towardsdatascience.com/how-to-solve-analogies-with-word2vec-6ebaf2354009?source=collection_archive---------11-----------------------#2020-03-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fec6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">美国之于加拿大，就像汉堡之于_？</h2></div><h1 id="87b7" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">Word2vec是什么？</h1><p id="21a9" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">为了让机器学习算法理解单词，使用单词嵌入将单词映射到实数的向量。有各种各样的单词嵌入模型，word2vec就是其中之一。</p><p id="3ad2" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">简而言之，word2vec是一组用于产生单词嵌入的相关模型。这些模型被训练来构建单词的语言上下文。Word2vec采用大型文本语料库并产生一个向量空间，其中<strong class="lc iu">将语料库中的每个唯一单词分配给空间中相应的向量。</strong></p><p id="f75f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">但是单词向量在向量空间中是如何定位的呢？它们被定位成使得在语料库中<strong class="lc iu">共享共同上下文的单词在空间中彼此靠近</strong>。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mb"><img src="../Images/6a75ef145d7671b00af58f071541611c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQuBbmYkDcde5I1v2-F_2Q.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">从<a class="ae mr" href="https://whitehat-school.com/tendencias-seo-para-2019-word-vector" rel="noopener ugc nofollow" target="_blank">怀特哈特学校</a>取得</p></figure><p id="7246" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">为了理解word2vec是如何工作的，让我们探索一些可以使用word2vec的方法，比如寻找单词之间的相似性或解决类似的问题</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/0bb228283ca7c8a7f5a38552e7352b4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*aperVWMV9A91_XYaOoLwDg.png"/></div></figure><h1 id="0e96" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">加载数据和模型</h1><p id="3abe" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们将使用来自<a class="ae mr" href="https://nlp.stanford.edu/projects/glove/" rel="noopener ugc nofollow" target="_blank">手套</a>的预训练单词向量。我们对包含2B推文、27B令牌和200d向量的Twitter数据集特别感兴趣。数据可以在这里下载<a class="ae mr" href="http://nlp.stanford.edu/data/glove.twitter.27B.zip" rel="noopener ugc nofollow" target="_blank">。我们使用</a><a class="ae mr" href="https://radimrehurek.com/gensim/models/word2vec.html" rel="noopener ugc nofollow" target="_blank"> Gensim </a>将手套向量转换成word2vec，然后使用KeyedVectors加载word2vec格式的向量。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h1 id="7779" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">查找最相似的单词</h1><p id="796e" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在我们用<code class="fe mv mw mx my b">model.most_similar()</code>来寻找前N个最相似的单词。积极的词语对相似性有积极的贡献。负面词汇对相似性有负面影响，或者换句话说，对差异有影响。让我们测试一下这个模型！</p><p id="9cc0" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">找出与“爱”最相似的单词</p><pre class="mc md me mf gt mz my na nb aw nc bi"><span id="ed8d" class="nd kj it my b gy ne nf l ng nh">model.most_similar(positive=['love'])</span></pre><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/c8f6e6a3264e3b2dc6c67f4fee329006.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*4h_gf_2j0h63Tki-k50eeQ.png"/></div></figure><p id="6a1d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">“女孩”怎么样？</p><pre class="mc md me mf gt mz my na nb aw nc bi"><span id="c335" class="nd kj it my b gy ne nf l ng nh">model.most_similar(positive=['girl'])</span></pre><p id="e81e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">。我们不妨查一下和‘男孩’类似的词</p><pre class="mc md me mf gt mz my na nb aw nc bi"><span id="8a22" class="nd kj it my b gy ne nf l ng nh">model.most_similar(positive=['boy'])</span></pre><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nj"><img src="../Images/baf49c7235b6a376525d57217a1d75bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*x9ua3oZUXjPkAbiCIAJF1Q.png"/></div></div></figure><p id="6bbb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">嗯。那么‘男孩’和‘男人’在相似的词上有区别吗</p><pre class="mc md me mf gt mz my na nb aw nc bi"><span id="808c" class="nd kj it my b gy ne nf l ng nh">model.most_similar(positive=['man'])</span></pre><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/9aa043228425d6adf98bd2733f294c2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:550/format:webp/1*87_IgAxf7kQVKHmHrbCMvg.png"/></div></figure><p id="8518" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">“男孩”变成“男人”似乎有明显的不同</p><h1 id="f8d2" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">解决类比</h1><p id="96c9" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">单词嵌入方法还能够捕获单词之间的多个不同程度的相似性。语义模式可以使用向量算法来复制。因此，我们也可以使用word2vec来解决类比问题。如果美国有汉堡包，加拿大有什么食物？</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/cac260aa456487fca7bd9c26a7470830.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*1V48d_iL-bMtx5NVY5COPA.png"/></div></figure><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/0d7bdbf2253d50955a4f116ceabeb6a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*ujfFdggP_2vkafwvCYCXYg.png"/></div></figure><p id="fefe" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">结果似乎显示了加拿大流行的各种食物。来自加拿大的读者可以确认这些热门词汇是否合理。让我们用一个名为<code class="fe mv mw mx my b">analogy().</code>的函数再探索几个国家。这次，我们只为每个类比返回一个最上面的相似单词。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/b9494dfa197845c110f26df0aeeb1117.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*wqqvnzWqyfbud3n45GBicg.png"/></div></figure><p id="5da7" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">既然可视化很好，让我们创建一个国家和它们相应的食物之间的地图。我们使用主成分分析将数据的维数降低到2。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mt mu l"/></div></figure><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi no"><img src="../Images/394aa57f7a793e319c1554a59f5a4e4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*sXCWOt6BqDmHSnIZ1-RCUg.png"/></div></figure><p id="26e7" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在这张地图上，国家之间的距离显示了在二维空间中哪些国家彼此更接近。箭头表示国家和食物之间的关系。</p><h1 id="d4a4" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">结论</h1><p id="f14a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">恭喜你！你已经学习了什么是word2vec，以及如何用word2Vec寻找单词之间的相似之处。看到word2vec的强大，你可能会想:“这种方法怎么能工作得这么好？”</p><p id="2d45" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们知道，word2vec对象函数导致出现在相似上下文中的单词具有相似的嵌入。但有趣的是，是什么让word2vec框架中的单词嵌入学习如此有效却知之甚少。无论是什么原因使这种嵌入成功，我希望您理解它的功能，并利用这个强大的工具进行文本分析。我鼓励您使用这个数据集或您选择的数据集来创建word2vec的其他类比。</p><p id="7f10" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在<a class="ae mr" href="https://github.com/khuyentran1401/Data-science/blob/master/nlp/word2vec.ipynb" rel="noopener ugc nofollow" target="_blank"> this Github repo </a>中，您可以随意使用本文的代码。</p><p id="f0dd" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我喜欢写一些基本的数据科学概念，并尝试不同的算法和数据科学工具。你可以通过<a class="ae mr" href="https://www.linkedin.com/in/khuyen-tran-1401/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae mr" href="https://twitter.com/KhuyenTran16" rel="noopener ugc nofollow" target="_blank"> Twitter </a>与我联系。</p><p id="be83" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果你想查看我写的所有文章的代码，请点击这里。在Medium上关注我，了解我的最新数据科学文章，例如:</p><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/how-to-match-two-people-with-python-7583b51ff3f9"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">如何找到和Python很好的搭配</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">给定个人偏好，如何匹配使得总偏好最大化？</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og ml ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/dictionary-as-an-alternative-to-if-else-76fe57a1e4af"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">字典作为If-Else的替代</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">使用字典创建一个更清晰的If-Else函数代码</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oh l od oe of ob og ml ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/choose-stocks-to-invest-with-python-584892e3ad22"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">用Python选择要投资的股票</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">您计划在未来3年投资几只股票，每只股票的每一美元都有不同的预期回报…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oi l od oe of ob og ml ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/maximize-your-productivity-with-python-6110004b45f7"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">使用Python最大化您的生产力</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">你创建了一个待办事项清单来提高效率，但最终却把时间浪费在了不重要的任务上。如果你能创造…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oj l od oe of ob og ml ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a rel="noopener follow" target="_blank" href="/boost-your-efficiency-with-these-6-numpy-tricks-29ca2fe81ecd"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">用这6个小窍门提高你的效率</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">并控制您的阵列</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="ok l od oe of ob og ml ns"/></div></div></a></div><h1 id="9a60" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">参考</h1><p id="d24f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><em class="ol"> Word2vec。</em>维基百科。【https://en.wikipedia.org/wiki/Word2vec T2】号</p></div></div>    
</body>
</html>