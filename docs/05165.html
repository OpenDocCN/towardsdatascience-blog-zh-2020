<html>
<head>
<title>Introduction to Pandas Equivalents of various SQL queries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">各种 SQL 查询的 Pandas 等价物介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/introduction-to-pandas-equivalents-of-various-sql-queries-448fb57dd9b9?source=collection_archive---------22-----------------------#2020-05-03">https://towardsdatascience.com/introduction-to-pandas-equivalents-of-various-sql-queries-448fb57dd9b9?source=collection_archive---------22-----------------------#2020-05-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="92b0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一个直观的教程，适用于初学者和将职业道路转向数据科学的人</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1e633551f96d5f3b097a4c5ced6b57f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PcVV-Stq79lbp4y8tYcdqA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">卡斯帕·卡米尔·鲁宾在<a class="ae ky" href="https://unsplash.com/s/photos/sql-query?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="1361" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有一些关于 SQL 查询的熊猫等价物的很棒的文章，例如:</p><ul class=""><li id="eab7" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/pandas-equivalent-of-10-useful-sql-queries-f79428e60bd9">熊猫相当于 10 个有用的 SQL 查询</a></li><li id="f147" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">如何在 Pandas 中重写您的 SQL 查询，等等。</li></ul><p id="997e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它们是很棒的文章，但是，它们都假设读者已经熟悉了<a class="ae ky" href="https://en.wikipedia.org/wiki/SQL" rel="noopener ugc nofollow" target="_blank"> SQL </a>。事实证明，情况并非总是如此，尤其是对于初学者和将职业道路转向数据科学的人。</p><p id="b82c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文旨在向零编码技能人员介绍 Pandas 查询。在本文中，每一节都以对特定 SQL 查询的介绍开始，然后是 Pandas 等价物，从而使我们对该方法的理解更加深刻和方便。</p><h1 id="5264" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">数据集准备</h1><p id="02aa" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">本文使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Iris_flower_data_set" rel="noopener ugc nofollow" target="_blank">安德森鸢尾花(iris) </a>数据集进行演示。该数据集包含五个属性下的一组 150 条记录:<em class="ng">萼片长度</em>、<em class="ng">萼片宽度</em>、<em class="ng">花瓣长度</em>、<em class="ng">花瓣宽度、</em>和<em class="ng">类</em>(从 sklearn 数据集称为<em class="ng">目标</em>)。</p><p id="4c45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们导入库并从<strong class="lb iu"> <em class="ng"> scikit-learn </em> </strong>库中获取虹膜数据集。你也可以从<a class="ae ky" href="https://archive.ics.uci.edu/ml/datasets/iris" rel="noopener ugc nofollow" target="_blank"> UCI 虹膜数据集</a>下载。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="5d1c" class="nm mk it ni b gy nn no l np nq">import pandas as pd<br/>import numpy as np<br/>from sklearn.datasets import load_iris</span></pre><p id="98be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了演示，我们只取 6 个记录(每个类 2 个记录):</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="5777" class="nm mk it ni b gy nn no l np nq">iris = load_iris()<br/>df = pd.DataFrame(iris.data, columns=iris.feature_names)</span><span id="6d21" class="nm mk it ni b gy nr no l np nq"># Convert datatype to float<br/>df = df.astype(float)</span><span id="0b41" class="nm mk it ni b gy nr no l np nq"># append "target" and rename it to "label"<br/>df['label'] = iris['target']</span><span id="fb14" class="nm mk it ni b gy nr no l np nq"># Use string label instead<br/>df['label'] = df.label.replace(dict(enumerate(iris.target_names)))</span><span id="ef41" class="nm mk it ni b gy nr no l np nq"># Select first 2 records from each label<br/>df_setosa = df[df['label'] == 'setosa'].head(2)<br/>df_versicolor = df[df['label'] == 'versicolor'].head(2)<br/>df_virginica = df[df['label'] == 'virginica'].head(2)<br/>iris = pd.concat([df_setosa, df_versicolor, df_virginica])</span><span id="73bb" class="nm mk it ni b gy nr no l np nq"># For simplicity, change columns name from <br/>#    | sepal length (cm) | sepal width (cm) | petal length (cm) | petal width (cm) | label |<br/>#  to the below<br/>iris.columns = ['sepal_l', 'sepal_w', 'petal_l', 'petal_w', 'label']</span><span id="a994" class="nm mk it ni b gy nr no l np nq">iris</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/ac855d422d0c708de77f7c8f97339fae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*Ptbon7SxuqE_bOtt7nbxnA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">iris 数据集中的 6 条记录</p></figure><h1 id="491f" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">1.选择数据(选择)</h1><p id="6b08" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">从数据集中选择数据通常用于检索和预览数据。</p><p id="2b5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如:预览虹膜数据的<strong class="lb iu"><em class="ng"/></strong><strong class="lb iu"><em class="ng">萼片宽度</em></strong><strong class="lb iu"><em class="ng">花瓣长度</em></strong><strong class="lb iu"><em class="ng">花瓣宽度</em> </strong>列，显示前 2 条记录。</p><p id="7dc1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 SQL 中，<code class="fe nt nu nv ni b">SELECT</code>语句用于从数据库中选择数据。这是通过使用您想要选择的列的逗号分隔列表来完成的(或者使用<code class="fe nt nu nv ni b">*</code>来选择所有列):</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="3ccc" class="nm mk it ni b gy nn no l np nq">SELECT <strong class="ni iu">sepal_l, sepal_w, petal_l, petal_w</strong> <br/>FROM iris <br/><strong class="ni iu">LIMIT 2</strong></span></pre><p id="37b5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Pandas 中，列的选择是通过将列名列表传递给数据帧来完成的:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="a00f" class="nm mk it ni b gy nn no l np nq">search = iris[<strong class="ni iu">['sepal_l', 'sepal_w', 'petal_l', 'petal_w']</strong>].<strong class="ni iu">head(2)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/f2733a665bddb1f826021fc4b952d930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*-XikDFnQiYuU5L-uuQsxSg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pandas 列选择的输出</p></figure><h1 id="3930" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">2.选择带条件的数据(其中)</h1><p id="c8ca" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在实践中，您经常希望检索满足某些指定条件的记录，这通常由过滤器来完成。</p><h2 id="da30" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">单一条件</h2><p id="e2cc" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">例如，<em class="ng">检索标签为“virginica”的所有数据</em></p><p id="9a33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 SQL 中，过滤是通过一个<code class="fe nt nu nv ni b">WHERE</code>子句完成的</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="6f43" class="nm mk it ni b gy nn no l np nq">SELECT * <br/>FROM iris <br/><strong class="ni iu">WHERE label='virginica'</strong></span></pre><p id="ad23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Pandas 中，数据帧可以用多种方式过滤，最广泛使用的是<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#boolean-indexing" rel="noopener ugc nofollow" target="_blank">布尔索引</a>:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="0ae6" class="nm mk it ni b gy nn no l np nq">search = iris[<strong class="ni iu">iris['label']=='virginica'</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/e938ea1f4d85a080bab5a1e983b582b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*xXM79QAOUlFbB1sn-MyBbQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用布尔索引选择 Pandas 列的输出</p></figure><h2 id="6b1e" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">多个条件和</h2><p id="d7f9" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在某些情况下，您可能希望检索满足多个条件的记录。</p><p id="e928" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，<em class="ng">检索标签为“virginica”且花瓣长度≥ 5.5 的所有数据</em></p><p id="3f6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 SQL 中，如果由<code class="fe nt nu nv ni b">AND</code>分隔的所有条件都为真，则可以将<code class="fe nt nu nv ni b">WHERE</code>子句与<code class="fe nt nu nv ni b">AND</code>运算符结合起来显示记录。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="4d7b" class="nm mk it ni b gy nn no l np nq">SELECT * <br/>FROM iris <br/><strong class="ni iu">WHERE label='virginica'AND petal_l &gt;= 5.5</strong></span></pre><p id="fcfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Pandas 中，可以使用<code class="fe nt nu nv ni b">&amp;</code>操作符将等价的 AND 条件传递给数据帧:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="e4fe" class="nm mk it ni b gy nn no l np nq">search = iris[<strong class="ni iu">(iris['label']=='virginica')</strong> <strong class="ni iu">&amp;</strong> <br/>              <strong class="ni iu">(iris['petal_l'] &gt;= 5.5)</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/6aafdb9340b569b10a3e2ffe83e3d374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*vRb_H4WM-EP8aP3GGM8OJA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">具有多个条件和的 Pandas 列选择的输出</p></figure><h2 id="8de4" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated"><strong class="ak">多重条件或</strong></h2><p id="76e1" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">对于这些案例，您希望提取满足任何条件的记录。</p><p id="2141" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，<em class="ng">检索花瓣长度≥ 5 或间隔长度≥ 6 的所有数据</em></p><p id="d376" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 SQL 中，类似于<code class="fe nt nu nv ni b">AND</code>运算符，<code class="fe nt nu nv ni b">OR</code>运算符可以与<code class="fe nt nu nv ni b">WHERE</code>结合使用，如果<code class="fe nt nu nv ni b">OR</code>分隔的任何条件为真，则显示记录。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="0833" class="nm mk it ni b gy nn no l np nq">SELECT * <br/>FROM iris <br/><strong class="ni iu">WHERE petal_l &gt;= 5OR sepal_l &gt;= 6</strong></span></pre><p id="d44d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Pandas 中，可以使用<code class="fe nt nu nv ni b">|</code>操作符将等价的 OR 条件传递给数据帧:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="90fb" class="nm mk it ni b gy nn no l np nq">search = iris[<strong class="ni iu">(iris['petal_l'] &gt;= 5) |</strong> <br/>              <strong class="ni iu">(iris['sepal_l'] &gt;= 6)</strong>]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/5c4fe753e6026dafda786774ffae2145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*z9dxwzzOiCDL2lR0z9Mscg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫的产量或状况</p></figure><h1 id="f11c" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">3.处理缺失值(NULL 或 NaN)</h1><p id="dc23" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在现实世界中，许多有趣的数据集都会丢失一些值。不同的编程语言使用不同的方法来指示缺失值。对于数据库和熊猫:</p><ul class=""><li id="7b4b" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">缺失值在数据库中通常显示为<code class="fe nt nu nv ni b">NULL</code></li><li id="ec3f" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe nt nu nv ni b"><a class="ae ky" rel="noopener" target="_blank" href="/working-with-missing-values-in-pandas-5da45d16e74">NaN</a></code> <a class="ae ky" rel="noopener" target="_blank" href="/working-with-missing-values-in-pandas-5da45d16e74">，一个特殊的浮点值</a>，在 Pandas 中用来表示一个缺失值。</li></ul><h2 id="a089" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">选择缺少值的记录</h2><p id="52db" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在某些情况下，您希望只查看字段缺少值的记录。</p><p id="a3d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，<em class="ng">检索丢失花瓣长度</em>的所有数据</p><p id="a623" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 SQL 中，我们可以使用<code class="fe nt nu nv ni b">IS NULL</code>操作符来测试<code class="fe nt nu nv ni b">NULL</code>值</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="0511" class="nm mk it ni b gy nn no l np nq">SELECT * <br/>FROM iris <br/><strong class="ni iu">WHERE petal_l IS NULL</strong></span></pre><p id="2d97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Pandas 中，方法<code class="fe nt nu nv ni b">isna()</code>可用于检查缺失值</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="df27" class="nm mk it ni b gy nn no l np nq">search = iris[<strong class="ni iu">iris['petal_l'].isna()</strong>]</span></pre><h2 id="b6f3" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">过滤掉缺失的值</h2><p id="268e" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在某些情况下，您希望只看到有值的记录。</p><p id="b7a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，<em class="ng">检索花瓣长度为的所有数据不丢失</em></p><p id="6a53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 SQL 中，<code class="fe nt nu nv ni b">IS NOT NULL</code>运算符可以用来过滤掉缺失的值</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="d80b" class="nm mk it ni b gy nn no l np nq">SELECT * <br/>FROM iris <br/><strong class="ni iu">WHERE petal_l IS NOT NULL</strong></span></pre><p id="39f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Pandas 中，等价的查询可以用方法<code class="fe nt nu nv ni b">notna()</code>来完成</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="7891" class="nm mk it ni b gy nn no l np nq">search = iris[<strong class="ni iu">iris['petal_l'].notna()</strong>]</span></pre><h1 id="a096" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">4.排序结果(排序依据)</h1><p id="a979" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">当从数据集中查询数据时，您可能还希望结果以排序的顺序返回。</p><h2 id="0588" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">按升序排列</h2><p id="59b9" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">例如，<em class="ng">从 iris 数据集中检索花瓣 _l ≥ 4 的所有数据，按标签列升序排序</em></p><p id="6246" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 SQL 中，<code class="fe nt nu nv ni b">ORDER BY</code>关键字用于按升序(<code class="fe nt nu nv ni b">ASC</code>)对结果集进行排序。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="a591" class="nm mk it ni b gy nn no l np nq">SELECT * <br/>FROM iris <br/>WHERE petal_l &gt;= 4 <br/><strong class="ni iu">ORDER BY label ASC</strong></span></pre><p id="6c33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Pandas 中，可以使用带有参数<code class="fe nt nu nv ni b">by=’label’</code>和<code class="fe nt nu nv ni b">ascending=True</code>的方法<code class="fe nt nu nv ni b">sort_values()</code>来完成等效的查询</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="eaea" class="nm mk it ni b gy nn no l np nq">search = iris[iris['petal_l'] &gt;= 4]<strong class="ni iu">.sort_values(by='label', ascending=True)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/45093939d9d0537ec114c8e936c72d5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*wfuGUuhB8Z9vVT22fHHiFQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫的输出用 ASC 排序 _value</p></figure><h2 id="ebf9" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">按降序排列</h2><p id="e8d0" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">例如，<em class="ng">从 iris 数据集中检索所有花瓣 _l ≥ 4 的数据，按标签列降序排序。</em></p><p id="5245" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 SQL 中，<code class="fe nt nu nv ni b">ORDER BY</code>关键字用于按降序(<code class="fe nt nu nv ni b">DESC</code>)对结果集进行排序。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="e37a" class="nm mk it ni b gy nn no l np nq">SELECT * <br/>FROM iris <br/>WHERE petal_l &gt;= 4 <br/><strong class="ni iu">ORDER BY label DESC</strong></span></pre><p id="9b6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Pandas 中，可以使用带有参数<code class="fe nt nu nv ni b">by=’label’</code>和<code class="fe nt nu nv ni b">ascending=False</code>的方法<code class="fe nt nu nv ni b">sort_values()</code>进行等效查询</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="109d" class="nm mk it ni b gy nn no l np nq">search = iris[iris['petal_l'] &gt;= 4]<strong class="ni iu">.sort_values(by='label', ascending=False)</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/5e9c06ac54270e82eae8096f28dc21b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*ADPhqtS-zXOHqFlE7I-5uw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫产量与 DESC 排序 _ 值</p></figure><h1 id="90a4" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">5.更新记录(更新)</h1><p id="707f" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">有时，我们需要修改数据集中的现有记录。</p><p id="3dcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如:<em class="ng">将所有 sepal_length = 7 且 sepal_width = 3.2 </em>的记录的标签更新为<strong class="lb iu"><em class="ng">virginica</em></strong><em class="ng"/></p><p id="25f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 SQL 中，<code class="fe nt nu nv ni b">UPDATE</code>语句和<code class="fe nt nu nv ni b">SET</code>运算符一起用于修改现有记录</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="182e" class="nm mk it ni b gy nn no l np nq"><strong class="ni iu">UPDATE</strong> iris <br/><strong class="ni iu">SET label = 'virginica' </strong><br/>WHERE sepal_l = 7 AND sepal_w = 3.2</span></pre><p id="d600" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Pandas 中，<code class="fe nt nu nv ni b">loc()</code>可以用来有条件地访问行，并返回指定的列<code class="fe nt nu nv ni b">label</code>。之后，我们可以将所有记录的值设置为<strong class="lb iu"> virginica </strong>。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="eee7" class="nm mk it ni b gy nn no l np nq">iris.<strong class="ni iu">loc</strong>[<strong class="ni iu">(iris['sepal_l'] == 7) &amp; <br/>        (iris['sepal_w'] == 3.2), 'label'</strong>] = 'virginica'</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/8ece04844181269ca5b5a6c6ac6bf054.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*SafyWQrn3cQ3POFL2iVpPQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">更新熊猫的现有记录</p></figure><h1 id="8a34" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated"><strong class="ak"> 6。记录分组(分组依据)</strong></h1><p id="66d0" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在某些情况下，我们希望对具有相同值的记录进行分组。</p><p id="e85f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如:<em class="ng">查找每个标签中的记录数</em></p><p id="5615" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 SQL 中，<code class="fe nt nu nv ni b">GROUP BY</code>语句将具有相同值的行分组到汇总行中，</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="1ee5" class="nm mk it ni b gy nn no l np nq">SELECT label, count(*) <br/>FROM iris <br/><strong class="ni iu">GROUP BY label</strong></span></pre><p id="3436" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Pandas 中，SQL 的<code class="fe nt nu nv ni b">GROUP BY</code>操作使用类似命名的<code class="fe nt nu nv ni b">groupby()</code>方法来执行。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="bf1e" class="nm mk it ni b gy nn no l np nq">search = iris<strong class="ni iu">.groupby('label')</strong>.size()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/3a2401f151a29e500ad89393e7e8afbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CW0zgazI_-KJG_3S4onckg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫中的分组记录</p></figure><h2 id="918b" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">拥有多项统计数据</h2><p id="2c5a" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">对于需要多个统计数据的情况</p><p id="2ef0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如:<em class="ng">查找每个标签的平均萼片长度和最大花瓣长度</em></p><p id="52ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 SQL 中，我们可以使用一些内置的<a class="ae ky" href="https://www.w3schools.com/sql/sql_ref_sqlserver.asp" rel="noopener ugc nofollow" target="_blank">数学函数</a>来完成任务:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="47a6" class="nm mk it ni b gy nn no l np nq">SELECT label, <strong class="ni iu">avg(sepal_l)</strong>, <strong class="ni iu">max(petal_l)</strong> <br/>FROM iris <br/><strong class="ni iu">GROUP BY label</strong></span></pre><p id="b504" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在熊猫身上，<code class="fe nt nu nv ni b">agg()</code>可以用来同时应用多种功能:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="224d" class="nm mk it ni b gy nn no l np nq">search = iris.groupby('label').<strong class="ni iu">agg(<br/>       { 'sepal_l': np.mean, 'petal_l': np.max})</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/533a343c513350820fb500a24e41fb5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gEk1u9r6vafoY2ytkARTFA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pandas 中具有多个统计数据的分组记录</p></figure><h1 id="278a" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">7.删除记录</h1><p id="9dbd" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">从数据集中删除记录是数据处理的主要要求之一。</p><p id="3e10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如:<em class="ng">删除花瓣宽度= 1.7，花瓣长度≥ 5 的记录</em></p><p id="2712" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 SQL 中，<code class="fe nt nu nv ni b">DELETE</code>语句用于删除现有记录</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="f124" class="nm mk it ni b gy nn no l np nq"><strong class="ni iu">DELETE</strong> FROM iris <br/><strong class="ni iu">WHERE petal_w = 1.7 AND petal_l &gt;= 5</strong></span></pre><p id="79ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在熊猫身上，对等的方法是<code class="fe nt nu nv ni b">drop()</code>。而给定的参数应该是匹配记录<code class="fe nt nu nv ni b">iris[(iris[‘petal_w’] == 1.7) &amp; (iris[‘petal_l’] &gt;= 4)].<strong class="lb iu">index</strong></code> <strong class="lb iu"> </strong>的索引。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="ea4a" class="nm mk it ni b gy nn no l np nq">drop = iris.drop(<strong class="ni iu">iris[(iris['petal_w'] == 1.7) <br/>                      &amp; (iris['petal_l'] &gt;= 4)].index</strong>)</span></pre><h1 id="b620" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">8.从多个数据集查询数据(连接)</h1><p id="1eea" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">到目前为止，我们一直在查看来自单个数据集的查询。在现实世界中，基于相关列组合来自两个或更多数据集的记录是很常见的。官方称这种查询为 Join。</p><p id="09fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有 4 种不同类型的连接</p><ol class=""><li id="7161" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu op mb mc md bi translated"><strong class="lb iu">内部连接</strong>:返回在两个数据集中具有匹配值的记录</li><li id="db6a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu op mb mc md bi translated"><strong class="lb iu">左(外)连接</strong>:返回左数据集中的所有记录，以及右数据集中的匹配记录</li><li id="27e0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu op mb mc md bi translated"><strong class="lb iu">右(外)连接</strong>:返回右数据集中的所有记录，以及左数据集中的匹配记录</li><li id="bd57" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu op mb mc md bi translated"><strong class="lb iu">完全(外部)连接</strong>:当左或右数据集中有匹配时，返回所有记录</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oq"><img src="../Images/afe49330bbc12f54c3de92cb51c0e22b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k51bDCELhPdglU66QpZ-8A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源于<a class="ae ky" href="https://www.w3schools.com/sql/sql_join.asp" rel="noopener ugc nofollow" target="_blank">https://www.w3schools.com/sql/sql_join.asp</a></p></figure><p id="d3bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们深入细节之前，让我们创建一个新的数据集<strong class="lb iu"> <em class="ng"> country </em> </strong>，它记录了在哪里发现了这种花:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="ccea" class="nm mk it ni b gy nn no l np nq">country = pd.DataFrame(<strong class="ni iu">{ 'label': ['virginica', 'versicolor'],<br/>                  'country': ['US', 'Germany']</strong>})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/c04f9e4759f015d01a42fe46333f1745.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*r9990Sjo7A9geBtFslg1eg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">组成一个数据集国家</p></figure><p id="a012" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，我们没有标签“setosa”的国家记录</p><h2 id="d185" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">内部连接</h2><p id="a007" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">例如:<em class="ng">根据标签</em>检索在 iris 和 country 数据集中具有匹配值的所有记录</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="0871" class="nm mk it ni b gy nn no l np nq">SELECT * FROM iris <br/><strong class="ni iu">INNER JOIN</strong> country <br/><strong class="ni iu">ON iris.label = country.label</strong></span></pre><p id="84d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 Pandas 中，当您想要基于相关列连接两个数据帧时，方法<code class="fe nt nu nv ni b">merge()</code>会提供参数。默认情况下，它执行内部连接。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="33f9" class="nm mk it ni b gy nn no l np nq">inner = pd.<strong class="ni iu">merge(iris, country, on='label')</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/8f5a6dc914af90488c5dd4908d80a8c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K9sd0Ii45_ZxS1imoSKbpw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">基于标签的内部连接的结果</p></figure><h2 id="b98e" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">左外部连接</h2><p id="caf4" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">例如:<em class="ng">根据标签从 iris 中检索所有记录，并从国家中检索匹配的记录。</em></p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="9336" class="nm mk it ni b gy nn no l np nq">SELECT * FROM iris <br/><strong class="ni iu">LEFT OUTER JOIN</strong> country<br/><strong class="ni iu">ON iris.label = country.label</strong></span></pre><p id="53b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相当于熊猫:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="592b" class="nm mk it ni b gy nn no l np nq">left = pd.merge(iris, country, on='label', <strong class="ni iu">how='left'</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/1c886b9ba158e35ecb5391bbf3c391a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6qnHVB0tnnyRH94ydwvraw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">左外部连接的结果</p></figure><h2 id="c28c" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">右外部联接</h2><p id="89ac" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">例如:<em class="ng">根据标签从国家/地区检索所有记录，并从 iris 检索匹配的记录。</em></p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="b1df" class="nm mk it ni b gy nn no l np nq">SELECT * FROM iris <br/><strong class="ni iu">RIGHT OUTER JOIN</strong> country <br/><strong class="ni iu">ON iris.label = country.label</strong></span></pre><p id="42b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相当于熊猫:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="2d8c" class="nm mk it ni b gy nn no l np nq">right = pd.merge(iris, country, on='label', <strong class="ni iu">how='right'</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/ec67e1a078230f7d40afaaaa79def234.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uJHFA2pu_npVlz1Ic9RNrQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">右外部联接的结果</p></figure><h2 id="a529" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">完全外部连接</h2><p id="b610" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">例如:<em class="ng">当 iris 或国家数据集中存在匹配时，根据标签检索所有记录。</em></p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="87b2" class="nm mk it ni b gy nn no l np nq">SELECT * FROM iris <br/><strong class="ni iu">FULL OUTER JOIN</strong> country<br/><strong class="ni iu">ON iris.label = country.label</strong></span></pre><p id="9d83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相当于熊猫:</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="a993" class="nm mk it ni b gy nn no l np nq">full = pd.merge(iris, country, on='label', <strong class="ni iu">how='outer'</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/0d142119396023aec2b04a515966be86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bUG46Fey4Y-0EnubbXrBrA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">完全外部连接的结果</p></figure><h1 id="8127" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">9.组合多个查询的结果(联合)</h1><p id="22bf" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在数据处理中，将两个或多个查询的结果组合成一个结果也很常见。为了组合结果，每个查询必须具有相同数据类型的相同数量的列。</p><p id="1b9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了演示，让我们从 iris 构建两个数据集。注意，我们还创建了一个如图所示的重复记录。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="39ac" class="nm mk it ni b gy nn no l np nq">iris_a = iris[0:3]<br/>iris_b = iris[2:]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi gj"><img src="../Images/57d0cd99380bd531c8ee27072a6e62ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qbREjQsLGxwkoADb2SJ3WQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">具有重复记录的 iris_a 和 iris_b</p></figure><h2 id="4e68" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">允许重复值</h2><p id="40c4" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在 SQL 中，可以使用<code class="fe nt nu nv ni b">UNION ALL</code> <strong class="lb iu"> </strong>运算符来允许重复值</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="5e75" class="nm mk it ni b gy nn no l np nq">SELECT * FROM iris_a WHERE label = 'versicolor' <br/><strong class="ni iu">UNION ALL</strong> <br/>SELECT * FROM iris_b WHERE label = 'versicolor'</span></pre><p id="8c8d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在熊猫中，对应的方法是<code class="fe nt nu nv ni b">concat()</code>，默认情况下它允许所有的副本。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="3932" class="nm mk it ni b gy nn no l np nq">union = pd.<strong class="ni iu">concat</strong>([iris_a[iris_a['label']=='versicolor'], iris_b[iris_b['label']=='versicolor']])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/215eee01114316cd4ffcb5cf2b8fecac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*sPZr022dU4H0uzfHBkMt2Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">UNION All 允许重复的结果</p></figure><h2 id="d487" class="nm mk it bd ml nx ny dn mp nz oa dp mt li ob oc mv lm od oe mx lq of og mz oh bi translated">没有重复值</h2><p id="184c" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在 SQL 中，<code class="fe nt nu nv ni b">UNION</code>操作符只选择不同的值</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="ddb7" class="nm mk it ni b gy nn no l np nq">SELECT * FROM iris_a WHERE label = 'versicolor' <br/><strong class="ni iu">UNION</strong> <br/>SELECT * FROM iris_b WHERE label = 'versicolor'</span></pre><p id="4b6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在熊猫中，你可以将<code class="fe nt nu nv ni b"><a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html#pandas.concat" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">concat()</strong></a></code>与<code class="fe nt nu nv ni b"><a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.drop_duplicates.html#pandas.DataFrame.drop_duplicates" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">drop_duplicates()</strong></a></code>结合使用。</p><pre class="kj kk kl km gt nh ni nj nk aw nl bi"><span id="00b9" class="nm mk it ni b gy nn no l np nq">union = pd.<strong class="ni iu">concat</strong>([iris_a[iris_a['label']=='versicolor'], iris_b[iris_b['label']=='versicolor']])<strong class="ni iu">.drop_duplicates()</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/4c7c3f0472bb8c8aeee736685fd95ea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*T7j2IDJnsaPpaHnpqrdhbQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">移除重复项的联合结果</p></figure><h1 id="7259" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">尽情享受吧！</h1><p id="b169" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">仅此而已。感谢阅读。</p><p id="34db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们一直在谈论缺失的价值观。如果你想了解更多关于在 Pandas 中使用缺失值的信息，这里有一篇文章你可能会感兴趣。</p><div class="ov ow gp gr ox oy"><a rel="noopener follow" target="_blank" href="/working-with-missing-values-in-pandas-5da45d16e74"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd iu gy z fp pd fr fs pe fu fw is bi translated">处理熊猫中缺失的值</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">关于 Pandas 中缺失值以及如何使用内置方法处理它们的教程</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">towardsdatascience.com</p></div></div><div class="ph l"><div class="pi l pj pk pl ph pm ks oy"/></div></div></a></div></div></div>    
</body>
</html>