# 弹性搜索分析教程

> 原文：<https://towardsdatascience.com/elasticsearch-analytics-tutorial-7d47029804a0?source=collection_archive---------40----------------------->

## 使用 Knowi 连接到 Elasticsearch 数据源，通过基于搜索的分析查询您的数据，并创建可视化效果。

![](img/5b3f26fe7b57ec544deb714cca247d86.png)

安德烈斯·西蒙在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

# 目录

*   [简介](#0929)
*   [连接到弹性搜索](#b538)
*   [使用基于搜索的分析进行查询](#7793)
*   [分析和可视化您的数据](#416c)
*   [总结](#0d99)

# 介绍

[Elasticsearch](https://www.elastic.co/) 是一个可伸缩的全文搜索引擎，具有 HTTP web 接口和基于模式的 JSON 文档。当 Elasticsearch 作为基础引擎在后台使用时，它会大放异彩，为具有复杂搜索功能和许多需求的应用程序提供动力。

目前，Kibana 在 Elastic 广受欢迎的 ELK 堆栈中的位置使其成为可视化和分析 Elasticsearch 数据的最常用工具。虽然 Kibana 肯定有其自身的优点，但它也有一些缺点；也就是说，它不支持与任何其他数据源的集成，也不提供用户管理功能或对发出主动警报的支持。

在某些时候，Elasticsearch 用户可能会认为这些缺点中的一个或多个是交易的破坏者，并选择不同的可视化平台来解决这些缺点。这就是知识发挥作用的地方。除了 Elasticsearch、大量用户管理功能、对警报的支持以及基于搜索的分析和机器学习之外，Knowi 还提供了对 35 个其他数据源的广泛原生集成。如果您有兴趣了解如何使用 Knowi 来可视化来自 Elasticsearch 的数据，那么您来对地方了。

# 连接到 Elasticsearch

登录免费的 [Knowi 试用账户](https://www.knowi.com/free-trial)后，您需要按照以下步骤设置您的 Elasticsearch 数据源:

1.  前往屏幕左侧面板的中上方，点击“数据源”
2.  转到列出的 NoSQL 数据源的右上方，点击 Elasticsearch。
3.  点击屏幕底部的“测试连接”。
4.  确保连接成功后，点击“保存”

图片来自作者

# 使用基于搜索的分析进行查询

既然我们已经建立了一个数据源，那么是时候对我们的数据进行查询了。我们的目标是分析来自佐治亚州的交通数据，并特别关注与元旦某个数据集的西行车辆相关的数据。为此，请遵循以下步骤:

1.  当您保存数据源时，您应该会在屏幕顶部收到一个警告，提示“Datasource Added”。配置查询。点击“查询”开始一旦你这样做了，你将被带到一个查询生成器，你将在你的屏幕上方看到一个新的提示，上面写着“获取索引”这意味着 Knowi 会从您刚刚连接的 Elasticsearch 数据源中自动索引表。在执行任何其他操作之前，将您的查询命名为“报告名称*”下的“元旦西行公交”
2.  向下悬停到“索引”点击栏内，您将看到您的 Elasticsearch 数据库中存在的每个索引。点击“运输”这将促使 Knowi 的广泛原生集成生成一个 Elasticsearch JSON 查询，该查询从 transit 表的所有列中调用前 10，000 行。
3.  选择屏幕左下角的“预览”。这将向您显示预览数据，但是如果您查看可视化，您会注意到我自动选择了一个地图视图。因为我们的预览数据包含经度和纬度坐标，Know 足够智能，可以自动将预览可视化转换为地理聚类/自定义地图可视化。如果你点击可视化中的一个点，它将扩展地图。这正是我们想要看到的可视化类型，但是请记住，我们只对元旦开始的西行活动感兴趣。
4.  为了过滤我们的数据，我们将使用 Knowi 基于搜索的分析功能，该功能简单、直观，通过允许非技术用户用简单的英语提问并实时接收结果来吸引他们。只需输入“告诉我 2017-01-01 西行”并稍等片刻。
5.  如果你回头看看你的可视化，你应该看到在你的地图上有更少的观察，因为你把它过滤到一个特定的子集。这是对你的提示，你已经做了所有正确的事情，现在你只需要点击“保存并立即运行”来完成你的查询。

图片来自作者

祝贺您使用 Knowi 设置了您的第一个 Elasticsearch 查询和可视化！

# 分析和可视化您的数据

当您保存并运行您的查询时，Knowi 将原始数据作为数据集保存在 Knowi 的弹性数据仓库中，它还将您的预览可视化保存为 Knowi 帐户中的一个小部件。为了进一步分析和可视化您的数据，请按照下列步骤操作:

1.  小部件被构建为存在于仪表板上。现在，你有一个没有家的部件。移动到左侧面板，点击“仪表板”，给你的小部件一个家然后，单击“+”图标创建一个新仪表板，并将其命名为“Westbound Transit Dashboard”单击“确定”保存此仪表板；一旦你这么做了，你会立刻被带到那里。
2.  回到屏幕左侧的面板，在“仪表板”的正下方，点击“Widgets”在这里，您将看到您刚刚制作的“元旦西行过境”小部件。只需将它拖过并放开，就可以将其添加到您的仪表板中。
3.  现在，您的小部件就在仪表板上，您可以对数据进行更多的分析和可视化。单击您的小部件右上角的 3 点图标，然后选择“分析”,以便转到当前为您的小部件提供支持的原始数据集。
4.  我们的目标是在数据中添加不同路线分布的可视化。换句话说，我们想知道在元旦那天西行车辆最常经过的路线。因此，从列名所在的左窗格中，我们将把“route_name”(确保您选择了它而不是“route”)拖到“Grouping/Dimensions”中然后，即使它已经存在于“字段/指标”中，我们也要将它再次拖动到那里，但这一次，我们要将第二个“路由名称”字段中的“操作”更改为“计数”如果操作正确，您将看到六个路由名称以及它们出现的频率。
5.  将“路由名称计数”字段从“字段/指标”拖到“排序依据”上，然后确保按降序对此字段进行排序。
6.  现在，到你的屏幕顶部，在“数据”旁边，点击“可视化”然后，将“可视化类型”更改为“饼图”
7.  因为我们想与地理聚类图并排查看新的饼图，所以我们不打算保存它；我们要克隆它。要做到这一点，前往你的屏幕右上角，找到“克隆”图标，它看起来像一张纸被放在另一张纸的上面，然后点击它。然后，将您的新部件命名为“元旦西行公交——路线频率”单击“克隆”完成此过程，然后单击“添加到仪表板”将新的小部件添加到您的仪表板。

如你所见，Glenwood 路是我们穿越最多的路，Moreland/Candler Park 紧随其后。在 Moreland/Cander Park 和 Perry Blvd/West highlights 之间有一个相当大的下降，然后在 Perry Blvd/West highlights 和接下来的三条路线之间有一个巨大的下降。

# 摘要

总之，我们在本教程开始时成功连接到 Elasticsearch 数据库，并使用 Knowi 基于搜索的分析功能来查询数据库中的运输数据集的特定子集，以使查询更容易。当我们成功运行这个查询时，Knowi 将查询的结果作为数据集存储在 Knowi 的弹性数据仓库中，并将我们用作小部件的预览可视化存储在 Knowi 帐户中。然后，我们创建了一个新的仪表板作为新部件的主页，并创建了另一个部件来进一步分析我们的数据集并回答一个重要的问题。