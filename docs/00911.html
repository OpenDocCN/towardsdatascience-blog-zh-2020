<html>
<head>
<title>7 idioms to acquire missing values every data scientist should know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">每个数据科学家都应该知道的获取缺失值的7个习惯用法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/7-idioms-to-acquire-missing-values-every-data-scientist-should-know-2edf4224360c?source=collection_archive---------24-----------------------#2020-01-26">https://towardsdatascience.com/7-idioms-to-acquire-missing-values-every-data-scientist-should-know-2edf4224360c?source=collection_archive---------24-----------------------#2020-01-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="a7ac" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据科学提示</h2><div class=""/><div class=""><h2 id="87b2" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">你应该把命令自动化</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/8bd40945a4405388c3d8a8405518ebd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6HWB98a1afvcSsQ6"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">卢多维克·沙雷特在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="ff9f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi me translated"><span class="l mf mg mh bm mi mj mk ml mm di"> M </span>缺失数据肯定会在数据集分析过程中产生问题。即使是确定丢失值的事实，更不用说它们的数量和分布，也可能消耗大量的时间。这就是为什么您可能应该保留一些有用的命令，以提高自动化和分析速度，并保持代码整洁和准确。</p><p id="d644" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们将使用Kaggle的免费<a class="ae lh" href="https://www.kaggle.com/zynicide/wine-reviews" rel="noopener ugc nofollow" target="_blank">葡萄酒评论数据集</a>来展示这些命令的影响。</p><h1 id="a7f5" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">1.DataFrame.describe()(但不完全是)</h1><p id="8baf" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">在这里你可以想到可能和<strong class="lk jd"> describe() </strong>方法一样司空见惯的东西。尽管该方法处理了关于整个数据集的大量信息(但没有一个字是关于丢失的数据的)。实际上，我们不会使用这个命令的所有潜力，而是可以应用一个简单的技巧来提取我们需要的数据。只需查看输出的count列:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="503e" class="np mo it nl b gy nq nr l ns nt">wine_data.<strong class="nl jd">describe</strong>(include='all').loc['count']</span></pre><p id="580b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们检索所有列的非缺失值的数量:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="a40c" class="np mo it nl b gy nq nr l ns nt">Unnamed: 0     150930<br/>country        150925<br/>description    150930<br/>designation    105195<br/>points         150930<br/>price          137235<br/>province       150925<br/>region_1       125870<br/>region_2        60953<br/>variety        150930<br/>winery         150930<br/>Name: count, dtype: object</span></pre><p id="5bee" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">它不是我们需要的确切信息，因为它期望我们知道数据集的大小来计算数据缺口的数量。但是，我们可以很容易地将输出转换成现值的百分比，这相当有用:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="4b52" class="np mo it nl b gy nq nr l ns nt">wine_data.<strong class="nl jd">describe</strong>(include='all').loc['count'] / wine_data.shape[0] * 100</span></pre><p id="2e00" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> describe() </strong>方法的过滤能力(包含/排除参数)为我们提供了必要的灵活性。</p><h1 id="2167" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">2.Series.value_counts()(但不完全是)</h1><p id="d7d9" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">通常这是一个非常有用的命令，有很多输出。但是，我们将再次应用一个小技巧。这是我们可以用来检索单个列中缺失值的数量的习语。不再多言:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="b97e" class="np mo it nl b gy nq nr l ns nt">wine_data['country'].<strong class="nl jd">value_counts</strong>(dropna=<strong class="nl jd">False</strong>).loc[np.nan]</span><span id="6446" class="np mo it nl b gy nu nr l ns nt">Out[1]: 5</span></pre><h1 id="dfd4" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">3.DataFrame.count()</h1><p id="e994" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">对于那些不需要describe()方法及其过滤能力的人来说，pandas已经内置了count()方法:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="d7ab" class="np mo it nl b gy nq nr l ns nt">wine_data.<strong class="nl jd">count</strong>()</span><span id="4aae" class="np mo it nl b gy nu nr l ns nt">Out[1]:<br/>Unnamed: 0     150930<br/>country        150925<br/>description    150930<br/>designation    105195<br/>points         150930<br/>price          137235<br/>province       150925<br/>region_1       125870<br/>region_2        60953<br/>variety        150930<br/>winery         150930<br/>dtype: int64</span></pre><p id="f63c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于单列:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="8fb7" class="np mo it nl b gy nq nr l ns nt">wine_data.<strong class="nl jd">count</strong>()['country']</span><span id="2109" class="np mo it nl b gy nu nr l ns nt">Out[1]: 150925</span></pre><p id="b265" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">很简单，有点无聊。</p><h1 id="b278" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">4.isnull()。总和()习语</h1><p id="1186" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">非常常见和非常有用的习语检索缺失数据的数量。看起来正是我们从一开始就想要的命令:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="da9f" class="np mo it nl b gy nq nr l ns nt">wine_data.<strong class="nl jd">isnull</strong>().sum()</span><span id="adca" class="np mo it nl b gy nu nr l ns nt">Out[1]:<br/>Unnamed: 0         0<br/>country            5<br/>description        0<br/>designation    45735<br/>points             0<br/>price          13695<br/>province           5<br/>region_1       25060<br/>region_2       89977<br/>variety            0<br/>winery             0<br/>dtype: int64</span></pre><p id="fd5d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">页（page的缩写）对于紧凑代码爱好者来说，<strong class="lk jd"> isna() </strong>别名是存在的:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="c7fd" class="np mo it nl b gy nq nr l ns nt">wine_data.<strong class="nl jd">isna</strong>().sum()</span></pre><h1 id="144c" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">5.isnull()。sum()。sum()(深入)</h1><p id="ad76" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">有时我们不需要数据缺口的数量，而是需要它们存在的事实(例如，对于自动化管道)。我们会发现下一个习语很有用:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="1b32" class="np mo it nl b gy nq nr l ns nt">wine_data.<strong class="nl jd">isnull</strong>().sum().sum()</span><span id="d45a" class="np mo it nl b gy nu nr l ns nt">Out[1]: 174477</span></pre><p id="5539" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">但是它返回一个数字，我们可能想把它转换成布尔值。所以，还有一个习语返回布尔值:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="2544" class="np mo it nl b gy nq nr l ns nt">wine_data.<strong class="nl jd">isnull</strong>().values.<strong class="nl jd">any</strong>()</span><span id="18cf" class="np mo it nl b gy nu nr l ns nt">Out[15]: True</span></pre><p id="b904" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">简短回答的简短代码。</p><h1 id="fb5d" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">6.NaNs热图</h1><p id="951d" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">但是，如果需要更多关于数据集中缺失值分布的信息，该怎么办呢？我们应该有意识地画出差距的热图！</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="f54c" class="np mo it nl b gy nq nr l ns nt"><strong class="nl jd">import</strong> <strong class="nl jd">seaborn</strong> <strong class="nl jd">as</strong> <strong class="nl jd">sns</strong><br/><strong class="nl jd">import</strong> <strong class="nl jd">matplotlib.pyplot</strong> <strong class="nl jd">as</strong> <strong class="nl jd">plt</strong></span><span id="1295" class="np mo it nl b gy nu nr l ns nt">plt.figure(figsize=(16,10))<br/>sns.heatmap(wine_data.isnull(), cbar=<strong class="nl jd">False</strong>, cmap="YlGnBu")</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/a88f2c6ed6dcf26ce6a2f70179ec8f24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZegPJaRMeoBH-yCgQVgWKw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">seaborn的热图。黑线显示数据差距。</p></figure><p id="35ad" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">看一下分布就可以为分析提供很多信息。</p><h1 id="7b67" class="mn mo it bd mp mq mr ms mt mu mv mw mx ki my kj mz kl na km nb ko nc kp nd ne bi translated">7.缺失值的索引</h1><p id="ade7" class="pw-post-body-paragraph li lj it lk b ll nf kd ln lo ng kg lq lr nh lt lu lv ni lx ly lz nj mb mc md im bi translated">之前的所有脚本都没有回答我们数据缺口在哪里。当然，我们可以使用数据帧过滤器来隔离丢失的数据或简单地丢弃它。但是在少量缺失数据的情况下(还记得“国家”栏的5个缺口吗？)我们可能希望现在它完全没有重新索引的问题。因此，多一个内置的熊猫方法将帮助我们:</p><pre class="ks kt ku kv gt nk nl nm nn aw no bi"><span id="00f6" class="np mo it nl b gy nq nr l ns nt">wine_data['country'].isnull().<strong class="nl jd">to_numpy</strong>().<strong class="nl jd">nonzero</strong>()</span><span id="667e" class="np mo it nl b gy nu nr l ns nt">Out[18]:<br/>(array([  1133,   1440,  68226, 113016, 135696], dtype=int64),)</span></pre><p id="8640" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这样，一个索引数组就准备好了。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><p id="19e7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这种简短紧凑的命令可以在数据集调查过程中节省一些时间。对我来说，我总是在不同的组合中使用它们，用更少的代码获得更多有价值的信息。你可以在我的GitHub上找到整个工作笔记本:</p><div class="od oe gp gr of og"><a href="https://github.com/Midvel/medium_jupyter_notes/blob/master/missing_data_idioms/missing-data-tips.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd jd gy z fp ol fr fs om fu fw jc bi translated">中级/中等_jupyter_notes</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">github.com</p></div></div><div class="op l"><div class="oq l or os ot op ou lb og"/></div></div></a></div><p id="86ba" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在您的数据科学项目中，您使用了哪些单行惯用语？</p></div></div>    
</body>
</html>