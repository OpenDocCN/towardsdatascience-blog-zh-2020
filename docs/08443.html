<html>
<head>
<title>Customers Who Viewed This Item Also Viewed …</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">看过此物品的顾客也看过…</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/customers-who-viewed-this-item-also-viewed-40026c4eb700?source=collection_archive---------28-----------------------#2020-06-19">https://towardsdatascience.com/customers-who-viewed-this-item-also-viewed-40026c4eb700?source=collection_archive---------28-----------------------#2020-06-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="a081" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">每次你完成一部关于网飞的电影，你都会看到一个新电影的推荐。每次打开 YouTube 都会看到一些推荐视频，因为你看了类似的东西。我最喜欢的一个是亚马逊的推荐算法，因为你甚至不需要购买或查看某样东西就可以看到它是<em class="ko">推荐。</em>如果你谈到了手机附近的一本书，你会在亚马逊的建议中看到它。就这么简单！</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/b3f866f3806586db49166e4d31319e02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fUw1SeU95EECk9mVIqqlpQ.jpeg"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">感谢查尔斯·德鲁维奥的照片</p></figure><p id="4721" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这些推荐功能，也称为推荐系统，在过去十年中成为一种有用和流行的机器学习算法。其背后的算法实际上并不令人困惑。例如，该系统可以基于过去的购买或评论推荐一个人可能感兴趣的产品。为了理解细节，我们应该熟悉<em class="ko">余弦相似度</em>的概念。</p><h2 id="11c1" class="lf lg it bd lh li lj dn lk ll lm dp ln kb lo lp lq kf lr ls lt kj lu lv lw lx bi translated"><strong class="ak">余弦相似度</strong></h2><p id="7d77" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">余弦相似度表示一个人的品味或偏好在多大程度上可以用另一个人的选择来描述。在数学中，它计算两个向量的余弦值。在这种情况下，向量由人们的选择来表示。我们发现余弦相似性，我们计算 2 个向量的单位向量的点积。</p><p id="cbd9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">假设人 A 的偏好用向量 A 表示，人 B 的偏好用向量 B 表示。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi md"><img src="../Images/371bddad4e48ce8743af605c060c62e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pGGt1X4iu_84XDRUEpKUXg.png"/></div></div></figure><p id="9697" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">余弦相似度是介于-1 和 1 之间的数字。如果 A 人和 B 人的选择完全相同，他们的余弦相似度为 1。如果它们完全不相似，它们的余弦相似度是-1。这是一个重要的细节，因为-1 余弦同样能告诉我们这两个人的偏好。这意味着他们喜欢彼此相反的产品。人 A 喜欢某部电影，而人 B 不喜欢同一部电影。在-1 余弦相似度中仍然有信息。然而，如果余弦相似度为 0，人 A 的选择没有给出关于人 B 的偏好的信息。</p><p id="6097" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦我们理解了余弦相似性的概念，推荐系统就更有意义了。通常有两种常见类型的推荐系统。这些是基于内容的推荐系统和协作推荐系统。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi me"><img src="../Images/2dc63614da60be0757a5d72f526e6c66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c73Hj9WvIFZL4ByBaf3jeg.jpeg"/></div></div><p class="lb lc gj gh gi ld le bd b be z dk translated">照片由 Unsplash 上的 Nordwood Themes 拍摄</p></figure><p id="abe5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">基于内容推荐系统</strong></p><p id="9c18" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在基于内容的推荐系统中，目标是对相似的实例(电影、书籍等)进行分组。)根据它们的产品特性分成不同的组。聚类是基于产品的实际特征建立的。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mf"><img src="../Images/f194a78d715c24e6186076b6635b1b5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l_g4HrhfsYDX1wmobVWbbw.png"/></div></div></figure><p id="5d85" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在上面的例子中，不管用户怎么看，每部电影都有不同的特点。在基于内容的推荐系统中，用户(顾客)并不扮演积极的角色。这里我们的向量是表格的行。我们找到每个向量与其他向量的余弦相似性。</p><p id="00a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在实践中，我们从特征工程开始，使每个记录成为一个数值，然后我们类似地计算余弦。余弦相似度告诉我们最相似的向量。使用这种方法，当您插入一个新的电影名称时，它将返回与产品功能最相似的电影。</p><p id="4788" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">协同推荐系统</strong></p><p id="02c7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">协同推荐系统将用户考虑在内。用户的行为是产生推荐的一个非常重要的输入。该算法利用用户-产品交互。协同推荐系统也分为两个主要的模型。</p><ol class=""><li id="0a14" class="mg mh it js b jt ju jx jy kb mi kf mj kj mk kn ml mm mn mo bi translated">基于用户的协同推荐系统</li><li id="5214" class="mg mh it js b jt mp jx mq kb mr kf ms kj mt kn ml mm mn mo bi translated">基于项目的协同推荐系统</li></ol><p id="f8e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">基于用户的协同推荐系统基于用户的购买或评级，使用余弦相似性数学对用户进行聚类。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mu"><img src="../Images/5098dd8907510abe7a5e6d5d63eaa356.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*smzk9k62JHhvzDPrtfs2ag.png"/></div></div></figure><p id="589a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在上面的例子中，我们看到了 4 部电影的用户评分。用户 1 和用户 2 之间有相似之处，因为他们都喜欢和不喜欢相同的电影。基于这个事实，我们可以向用户 1 推荐《十二怒汉》，因为用户 2 喜欢。此外，我们不应该向用户 5 推荐“教父”,因为用户 4 不喜欢它，并且他们有相似的偏好。</p><p id="3730" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这种推荐系统的一个缺点是它完全依赖于客户的评分。不是每个顾客都喜欢给产品评级。此外，众所周知，有负面经历的人比有正面经历的人更有可能提交评级分数。这就是为什么许多公司从基于评级的推荐系统转向基于购买的推荐系统。基于购买的系统更可靠，因为它们考虑了用户的实际行为。此外，收集数据也容易得多。让我们看看下面的例子:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mv"><img src="../Images/e29df5485c2f1c6a474b187ff7656581.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ZvOreYyevM9t5YXOcHvPg.png"/></div></div></figure><p id="ec59" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">基于购买决策，我们可以向用户 A 推荐“Forest Gump ”,因为他的购买行为与用户 B 相似，并且用户 B 观看了它。这种特殊型号与“<em class="ko">顾客购买这种产品同时也购买了</em>……”的概念相同。</p><p id="965a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">基于项目的协同推荐系统非常类似于基于用户的协同推荐系统。不同的是矩阵是转置的。在基于项目的协同推荐系统中，我们查看产品屏幕，发现电影的余弦相似性。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mw"><img src="../Images/103674486c1ccd6e8135b6558b84d101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YIDiO0hpBRADWJopvqIpOg.png"/></div></div></figure><p id="7190" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在上面的例子中，用户用 1-5 的尺度给电影评分。电影“12 个愤怒的人”可以呈现给用户 1，因为这部电影已经从相同的人那里收到了与“搏击俱乐部”相同的反应。如果用户 1 喜欢“搏击俱乐部”,他也可能喜欢“12 个愤怒的人”。</p><p id="2596" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">排除用户 1；《搏击俱乐部》的 s 向量= [ 4，3，4，4]和《十二怒汉》的 s 向量= [ 5，3，4，4]非常相似。</p><p id="2e73" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">推荐系统在 Python 中的实现</strong></p><p id="8a7d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">实际上，当我们创建一个推荐系统时，我们首先创建一个数据透视表。在 Python 中，我们使用<em class="ko">。pivot_table( ) </em>函数就是这么做的。例如基于项目的推荐系统，产品的名称(可以是电影、书籍或音乐名称等。)将是我们的数据帧的索引，用户信息(名称或 Id，取决于您的数据集)将在列中。这个<em class="ko">。pivot_table( ) </em>函数将返回一个巨大的表格，向我们展示每个用户对每部电影的行为。当然，不是每个人对所有产品都有一种行为(这种行为意味着评级，或购买信息)，这就是为什么我们会在数据透视表中看到许多 NaN 或“0”值。这就是<em class="ko">稀疏矩阵</em>派上用场的地方。快速提醒；稀疏矩阵获取数据帧，并通过移除所有“0”值将其压缩成更轻的格式。我们的数据帧的信息没有改变，但它在计算机中占用的空间要少得多，因为稀疏矩阵没有零的负担。这里我们可以认为“0”和 NaN 值携带的信息相等；因为当数据是二进制的时候，“0”意味着没有行为发生或者没有购买发生。因此，在使用稀疏矩阵之前，可以将“NaN”值转换为“0”。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mx"><img src="../Images/b02f95fb047beff04f535cc279708878.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rFVBoJYJxfMXtF4blMOexA.png"/></div></div></figure><p id="b25b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦你创建了稀疏矩阵，你需要做的就是计算余弦相似度。Scikit-Learn 库有一个 pairwise_distances 函数，可以为我们计算余弦。该函数返回一个正方形矩阵，将每个产品与其他产品进行比较。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi my"><img src="../Images/1c9aad5d466d7ab13e93bf704a78ced8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qsMqH47UnS55c9YwRUbQYg.png"/></div></div></figure><p id="a23b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里我们必须注意到，我们的推荐者矩阵不再有用户信息。当我们的稀疏矩阵携带用户输入时，成对距离函数将其转换成推荐者矩阵。推荐矩阵是一个方阵，它只有每个产品之间的余弦相似性信息。</p><p id="c193" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该推荐者矩阵也没有项目标题。我们可以从 pivot_table 中获取这些标题，并将其与推荐者矩阵组合在一个大的快乐数据框架中。</p><p id="9f3a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里需要注意的另一个重要事项是，与实际的余弦相似性值不同，scipy 库的<em class="ko">。pairwise _ distance()</em>函数以不同的比例返回相似性数字。通常，余弦相似标度在-1 和 1 之间。如前所述，余弦相似度=1 意味着项目具有非常相似的接受度，余弦相似度= -1 意味着项目具有完全相反的接受度。在<em class="ko">的结果中。pairwise _ distance()</em>函数，但这是完全不同的。当我们在推荐矩阵中看到“0”时，我们知道这些项目是相似的，当我们看到“1”时，我们知道这些项目非常不相似。因此，<em class="ko">scipy . pairwise _ distances()</em>函数的余弦值介于 0 和 1 之间。</p><p id="fd27" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">希望这篇文章有助于你理解推荐系统背后的算法。如果您有任何问题或意见，请在下面留下您的评论。</p></div></div>    
</body>
</html>