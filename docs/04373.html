<html>
<head>
<title>Predicting Gold Prices Using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åˆ©ç”¨æœºå™¨å­¦ä¹ é¢„æµ‹é»„é‡‘ä»·æ ¼</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/machine-learning-to-predict-gold-price-returns-4bdb0506b132?source=collection_archive---------11-----------------------#2020-04-20">https://towardsdatascience.com/machine-learning-to-predict-gold-price-returns-4bdb0506b132?source=collection_archive---------11-----------------------#2020-04-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="77d6" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/gold-price-prediction" rel="noopener" target="_blank">é»„é‡‘é¢„æµ‹</a></h2><div class=""/><div class=""><h2 id="e7f7" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">ç”¨PyCareté¢„æµ‹é»„é‡‘ä»·æ ¼</h2></div><h1 id="c57c" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">ä»‹ç»</h1><p id="4c39" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">åå¤šå¹´æ¥ï¼Œæˆ‘ä¸€ç›´æ˜¯é‡‘èå¸‚åœºçš„å­¦ç”Ÿï¼Œä¸€ç›´åœ¨ç ”ç©¶ä¸åŒçš„èµ„äº§ç±»åˆ«åŠå…¶åœ¨ä¸åŒç»æµæ¡ä»¶ä¸‹çš„è¡Œä¸ºã€‚å¾ˆéš¾æ‰¾åˆ°æ¯”é»„é‡‘æ›´å…·ä¸¤æåˆ†åŒ–çš„èµ„äº§ç±»åˆ«ã€‚æœ‰å–œæ¬¢å®ƒçš„äººï¼Œä¹Ÿæœ‰è®¨åŒå®ƒçš„äººï¼Œæ›´å¤šçš„æ—¶å€™ï¼Œä»–ä»¬æ°¸è¿œåœç•™åœ¨åŒä¸€ä¸ªé˜µè¥ã€‚ç”±äºé»„é‡‘æœ¬èº«æ²¡æœ‰ä»€ä¹ˆåŸºæœ¬é¢(è¿™åˆæ˜¯ä¸€ä¸ªä¸¤æåˆ†åŒ–çš„æ¥æº)ï¼Œåœ¨è¿™ä¸ªå¤šéƒ¨åˆ†ç³»åˆ—ä¸­ï¼Œæˆ‘å°†å°è¯•ä½¿ç”¨å‡ ç§æœºå™¨å­¦ä¹ æŠ€æœ¯æ¥é¢„æµ‹é»„é‡‘ä»·æ ¼å›æŠ¥ã€‚ä»¥ä¸‹æ˜¯æˆ‘(ç›®å‰)å¯¹è¯¥ç³»åˆ—çš„è®¾æƒ³:</p><p id="d608" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd"> <em class="mk">ç¬¬ä¸€éƒ¨åˆ†:ç¡®å®šæ–¹æ³•ï¼Œæ”¶é›†å’Œå‡†å¤‡æ•°æ®</em> </strong></p><p id="20f8" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd"> <em class="mk">ç¬¬äºŒéƒ¨åˆ†:ä½¿ç”¨PyCaret </em> </strong>çš„å›å½’å»ºæ¨¡</p><p id="eb7e" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd"> <em class="mk">ç¬¬ä¸‰éƒ¨åˆ†:ä½¿ç”¨PyCaret </em> </strong>åˆ†ç±»å»ºæ¨¡</p><p id="96f8" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd"> <em class="mk">ç¬¬å››éƒ¨åˆ†:æ—¶é—´åºåˆ—å»ºæ¨¡ä½¿ç”¨Prophet(è„¸ä¹¦)</em> </strong></p><p id="896c" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd"> <em class="mk">ç¬¬äº”éƒ¨åˆ†:è¯„ä¼°æ–¹æ³•æ•´åˆ</em> </strong></p><blockquote class="ml mm mn"><p id="92af" class="lj lk mk ll b lm mf kd lo lp mg kg lr mo mh lu lv mp mi ly lz mq mj mc md me im bi translated">â€œè¯·æ³¨æ„ï¼Œåœ¨ä¸€ä¸ªç«äº‰æå…¶æ¿€çƒˆçš„å¸‚åœºä¸­ï¼Œé»„é‡‘æ˜¯ä¸€ç§äº¤æ˜“éå¸¸å¹¿æ³›çš„èµ„äº§ã€‚é•¿æœŸä»ä»»ä½•ç­–ç•¥ä¸­æŒç»­èµšé’±æ˜¯æå…¶å›°éš¾çš„ï¼Œå¦‚æœä¸æ˜¯ä¸å¯èƒ½çš„è¯ã€‚è¿™ç¯‡æ–‡ç« åªæ˜¯åˆ†äº«æˆ‘çš„ç»éªŒï¼Œè€Œä¸æ˜¯æŠ•èµ„æˆ–äº¤æ˜“çš„å¤„æ–¹æˆ–å€¡å¯¼ã€‚ç„¶è€Œï¼Œå¯¹äºåƒæˆ‘è¿™æ ·çš„è¯¥é¢†åŸŸçš„å­¦ç”Ÿæ¥è¯´ï¼Œè¿™ä¸ªæƒ³æ³•å¯ä»¥é€šè¿‡ä¸ªäººåŠªåŠ›æ‰©å±•å’Œå‘å±•æˆäº¤æ˜“ç®—æ³•ã€‚â€</p></blockquote><h1 id="53e5" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">èƒŒæ™¯</h1><p id="2cd4" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">å‡ ä¸ªä¸–çºªä»¥æ¥ï¼Œé»„é‡‘ä¸€ç›´æ˜¯äººç±»æœ€åˆçš„ä»·å€¼å‚¨å­˜æ‰‹æ®µå’Œäº¤æ˜“åª’ä»‹ï¼Œç›´åˆ°å‡ ä¸ªä¸–çºªå‰çº¸å¸å–ä»£äº†é»„é‡‘ã€‚ç„¶è€Œï¼Œç›´åˆ°1971å¹´å¸ƒé›·é¡¿æ£®æ—åå®šè¢«åºŸé™¤ï¼Œä¸–ç•Œè´§å¸æˆä¸ºçœŸæ­£çš„â€²ğ¹ğ‘–ğ‘ğ‘¡â€²è´§å¸ä¹‹å‰ï¼Œå¤§å¤šæ•°å¯æŒç»­çš„çº¸å¸éƒ½æ˜¯ç”±é»„é‡‘æ”¯æŒçš„ã€‚</p><p id="548c" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">ç„¶è€Œï¼Œé»„é‡‘ä¸ä»…ä½œä¸ºç å®çš„é¦–é€‰é‡‘å±ï¼Œè€Œä¸”ä½œä¸ºä»·å€¼å‚¨å­˜æ‰‹æ®µå’Œå¤šæ ·åŒ–æŠ•èµ„ç»„åˆä¸­é€šå¸¸å¯å–çš„ä¸€éƒ¨åˆ†ï¼Œç»§ç»­å¼•èµ·äººä»¬çš„å…´è¶£ï¼Œå› ä¸ºå®ƒå¾€å¾€æ˜¯ä¸€ç§æœ‰æ•ˆçš„é€šèƒ€å¯¹å†²å’Œç»æµç»å†è‰°éš¾æ—¶æœŸçš„é¿é£æ¸¯ã€‚</p><h1 id="b763" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">æ–¹æ³•</h1><p id="e406" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">åœ¨è¿™ä¸ªç³»åˆ—ä¸­ï¼Œæˆ‘ä»¬å°†é‡‡ç”¨ä¸åŒçš„æ–¹æ³•æ¥é¢„æµ‹é»„é‡‘ä»·æ ¼çš„å›æŠ¥ï¼Œä½¿ç”¨<strong class="ll jd">æœºå™¨å­¦ä¹ </strong>æ­£å¦‚å¼•è¨€éƒ¨åˆ†æ‰€å¼ºè°ƒçš„</p><p id="f053" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å°†èµ°å›å½’è·¯çº¿æ¥é¢„æµ‹æœªæ¥2å‘¨å’Œ3å‘¨çš„é»„é‡‘å›æŠ¥ã€‚æˆ‘ä»¬å°†é€šè¿‡ä½¿ç”¨ä¸åŒå·¥å…·çš„å†å²å›æŠ¥æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘è®¤ä¸ºè¿™å°†å½±å“é»„é‡‘çš„å‰æ™¯ã€‚æ ¹æœ¬åŸå› æ˜¯ï¼Œæˆ‘å°†é»„é‡‘ç§°ä¸ºä¸€ç§â€œååŠ¨â€èµ„äº§ã€‚å®ƒå‡ ä¹æ²¡æœ‰è‡ªå·±çš„åŸºæœ¬é¢ï¼Œä»·æ ¼çš„å˜åŠ¨é€šå¸¸æ˜¯æŠ•èµ„è€…å¦‚ä½•çœ‹å¾…å…¶ä»–èµ„äº§ç±»åˆ«(è‚¡ç¥¨ã€å¤§å®—å•†å“ç­‰)çš„è¡ç”Ÿå“ã€‚).</p><h1 id="1624" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">å¯¼å…¥æ•°æ®</h1><p id="38b4" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">åœ¨æœ¬æ¬¡å’Œåç»­ç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬å°†éœ€è¦è¿‡å»10å¹´ä¸­å‡ ç§å·¥å…·çš„æ”¶ç›˜ä»·ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å„ç§ä»˜è´¹èµ„æº(è·¯é€ç¤¾ã€å½­åš)å’Œå…è´¹èµ„æº(IEXã€Quandlã€Yahoofinanceã€è°·æ­Œè´¢ç»)æ¥å¯¼å…¥æ•°æ®ã€‚ç”±äºè¿™ä¸ªé¡¹ç›®éœ€è¦ä¸åŒç±»å‹çš„èµ„äº§ç±»åˆ«(è‚¡ç¥¨ã€å•†å“ã€å€ºåŠ¡å’Œè´µé‡‘å±)ï¼Œæˆ‘å‘ç°<strong class="ll jd">'</strong><a class="ae mr" href="https://pypi.org/project/yahoofinancials/" rel="noopener ugc nofollow" target="_blank"><strong class="ll jd"><em class="mk">Yahoo financials</em></strong></a><strong class="ll jd">'</strong>è½¯ä»¶åŒ…éå¸¸æœ‰ç”¨ä¸”ç®€å•æ˜äº†ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="7061" class="nb ks it mx b gy nc nd l ne nf"><strong class="mx jd"><em class="mk">#Importing Libraries</em></strong><br/>import pandas as pd<br/>from datetime import datetime<br/>import matplotlib.pyplot as plt<br/>from yahoofinancials import YahooFinancials</span></pre><p id="1dd7" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">æˆ‘å‡†å¤‡äº†ä¸€ä»½éœ€è¦å¯¼å…¥æ•°æ®çš„ä»ªå™¨æ¸…å•ã€‚<strong class="ll jd"><em class="mk">Yahoo financials</em></strong>åŒ…éœ€è¦Yahooè‚¡ç¥¨ä»£ç ã€‚è¯¥åˆ—è¡¨åŒ…å«è‚¡ç¥¨ä»£å·åŠå…¶è¯´æ˜ã€‚åŒ…å«åˆ—è¡¨çš„excelæ–‡ä»¶å¯ä»¥åœ¨<a class="ae mr" href="https://github.com/Riazone/Gold-Return-Prediction/blob/master/Ticker%20List.xlsx" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>æ‰¾åˆ°ï¼Œæ–‡ä»¶åä¸ºâ€œTicker Listâ€ã€‚æˆ‘ä»¬å¯¼å…¥è¯¥æ–‡ä»¶ï¼Œå¹¶å°†è‚¡ç¥¨ä»£ç å’Œåç§°æå–ä¸ºå•ç‹¬çš„åˆ—è¡¨ã€‚(<a class="ae mr" href="https://github.com/Riazone/Gold-Return-Prediction/blob/master/Regression/Gold%20Prediction%20Experiment%20%20Regression-%20PyCaret.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="mk">è§ç¬”è®°æœ¬</em> </a>)</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="e8d8" class="nb ks it mx b gy nc nd l ne nf">ticker_details = pd.read_excel(â€œTicker List.xlsxâ€)<br/>ticker = ticker_details['Ticker'].to_list()<br/>names = ticker_details['Description'].to_list()<br/>ticker_details.head(20)</span></pre><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c920231ca90a3548577ea2fce8aef876.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*8j73ugtxNcnvJt4iwFvnLg.png"/></div></figure><p id="7f89" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">æœ‰äº†åˆ—è¡¨åï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰éœ€è¦å¯¼å…¥æ•°æ®çš„æ—¥æœŸèŒƒå›´ã€‚æˆ‘é€‰æ‹©çš„æœŸé™æ˜¯2010å¹´1æœˆè‡³2020å¹´3æœˆ1æ—¥ã€‚æˆ‘ä¹‹æ‰€ä»¥æ²¡æœ‰æå–ä¹‹å‰çš„æ•°æ®ï¼Œæ˜¯å› ä¸º2008-09å¹´çš„<strong class="ll jd">å…¨çƒé‡‘èå±æœº(GFC) </strong>æå¤§åœ°æ”¹å˜äº†ç»æµå’Œå¸‚åœºæ ¼å±€ã€‚é‚£æ®µæ—¶æœŸä¹‹å‰çš„å…³ç³»ç°åœ¨å¯èƒ½æ²¡é‚£ä¹ˆé‡è¦äº†ã€‚</p><p id="9950" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ—¥æœŸèŒƒå›´ï¼Œå¹¶å°†å…¶å†™å…¥ä¸€ä¸ªåä¸º<strong class="ll jd"> <em class="mk"> values </em> </strong>çš„ç©ºæ•°æ®å¸§ï¼Œæˆ‘ä»¬å°†ä»yahoofinancialsä¸­æå–å¹¶ç²˜è´´æ•°æ®ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="ba92" class="nb ks it mx b gy nc nd l ne nf"><strong class="mx jd"><em class="mk">#Creating Date Range and adding them to values table</em></strong><br/>end_date= â€œ2020â€“03â€“01â€<br/>start_date = â€œ2010â€“01â€“01â€<br/>date_range = pd.bdate_range(start=start_date,end=end_date)<br/>values = pd.DataFrame({ â€˜Dateâ€™: date_range})<br/>values[â€˜Dateâ€™]= pd.to_datetime(values[â€˜Dateâ€™])</span></pre><p id="355d" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">ä¸€æ—¦æˆ‘ä»¬åœ¨dataframeä¸­æœ‰äº†æ—¥æœŸèŒƒå›´ï¼Œæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨tickerç¬¦å·ä»APIä¸­æå–æ•°æ®ã€‚<strong class="ll jd"> <em class="mk"> yahoofinancials </em> </strong>ä»¥JSONæ ¼å¼è¿”å›è¾“å‡ºã€‚ä¸‹é¢çš„ä»£ç å¾ªç¯éå†è‚¡ç¥¨ä»£ç åˆ—è¡¨ï¼Œåªæå–æ‰€æœ‰å†å²æ—¥æœŸçš„æ”¶ç›˜ä»·ï¼Œå¹¶å°†å®ƒä»¬æ·»åŠ åˆ°åœ¨æ—¥æœŸä¸Šæ°´å¹³åˆå¹¶çš„dataframeä¸­ã€‚é‰´äºè¿™äº›èµ„äº§ç±»åˆ«å¯èƒ½æœ‰ä¸åŒçš„åœ°åŒºå’Œäº¤æ˜“å‡æœŸï¼Œæ¯æ¬¡æ•°æ®æå–çš„æ—¥æœŸèŒƒå›´å¯èƒ½ä¸ç›¸åŒã€‚é€šè¿‡åˆå¹¶ï¼Œæˆ‘ä»¬æœ€ç»ˆä¼šæœ‰å‡ ä¸ª<em class="mk"> NAs </em>ï¼Œç¨åæˆ‘ä»¬å°†<em class="mk">å¡«å……</em>ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="e72c" class="nb ks it mx b gy nc nd l ne nf"><strong class="mx jd"><em class="mk">#Extracting Data from Yahoo Finance and Adding them to Values table using date as key<br/></em></strong>for i in ticker:<br/> raw_data = YahooFinancials(i)<br/> raw_data = raw_data.get_historical_price_data(start_date, end_date, â€œdailyâ€)<br/> df = pd.DataFrame(raw_data[i][â€˜pricesâ€™])[[â€˜formatted_dateâ€™,â€™adjcloseâ€™]]<br/> df.columns = [â€˜Date1â€™,i]<br/> df[â€˜Date1â€™]= pd.to_datetime(df[â€˜Date1â€™])<br/> values = values.merge(df,how=â€™leftâ€™,left_on=â€™Dateâ€™,right_on=â€™Date1')<br/> values = values.drop(labels=â€™Date1',axis=1)</span><span id="3606" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Renaming columns to represent instrument names rather than their ticker codes for ease of readability</em></strong><br/>names.insert(0,â€™Dateâ€™)<br/>values.columns = names<br/>print(values.shape)<br/>print(values.isna().sum())<br/></span><span id="8afd" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Front filling the NaN values in the data set</em></strong><br/>values = values.fillna(method="ffill",axis=0)<br/>values = values.fillna(method="bfill",axis=0)<br/>values.isna().sum()</span><span id="7e25" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk"># Coercing numeric type to all columns except Date</em></strong><br/>cols=values.columns.drop('Date')<br/>values[cols] = values[cols].apply(pd.to_numeric,errors='coerce').round(decimals=1)<br/>values.tail()</span></pre><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nl"><img src="../Images/062f5bf33aa745965aa55dea1e5413f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n9DrEpRxVpV2rDzJBtsDhg.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">å€¼è¡¨çš„å°¾éƒ¨</p></figure><h1 id="2ed9" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">å‡†å¤‡æ•°æ®</h1><p id="aef3" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">åœ¨ä¸Šè¿°æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¼ºè°ƒäº†æˆ‘ä»¬å°†ä½¿ç”¨ä¸Šå¸‚å·¥å…·çš„æ»åå›æŠ¥æ¥é¢„æµ‹é»„é‡‘çš„æœªæ¥å›æŠ¥ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ç»§ç»­è®¡ç®—æ‰€æœ‰å·¥å…·çš„çŸ­æœŸå†å²å›æŠ¥å’Œå°‘æ•°é€‰å®šå·¥å…·çš„é•¿æœŸå†å²å›æŠ¥ã€‚</p><p id="b98c" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">å…¶èƒŒåçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå¦‚æœæŸé¡¹èµ„äº§è¡¨ç°ä¼˜å¼‚æˆ–è¡¨ç°ä¸ä½³ï¼ŒæŠ•èµ„ç»„åˆé‡æ–°å¹³è¡¡çš„å¯èƒ½æ€§æ›´å¤§ï¼Œè¿™å°†å½±å“æœªæ¥å…¶ä»–èµ„äº§ç±»åˆ«çš„å›æŠ¥ã€‚å¦‚æœè‚¡ç¥¨å¸‚åœº(æ¯”å¦‚è¯´S &amp; P500)åœ¨è¿‡å»çš„6ä¸ªæœˆä¸­è¡¨ç°å‡ºæƒŠäººçš„å›æŠ¥ï¼Œèµ„äº§ç»ç†å¯èƒ½ä¼šå¸Œæœ›è®°å½•åˆ©æ¶¦ï¼Œå¹¶åˆ†é…ä¸€äº›èµ„é‡‘åˆ°è´µé‡‘å±ä¸Šï¼Œä¸ºè‚¡ç¥¨å¸‚åœºçš„è°ƒæ•´åšå‡†å¤‡ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†åœ¨ä¸åŒçš„å¸‚åœºæ¡ä»¶ä¸‹ï¼Œé»„é‡‘å’Œæ ‡æ™®500ä¹‹é—´çš„ä»·æ ¼å˜åŠ¨å’Œç›¸å…³æ€§ã€‚</p><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nu"><img src="../Images/7abd1b20cfb2730cb210b4cfe090a7c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YIsV9sx5qw_GqWVjA4QF_Q.png"/></div></div></figure><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nv"><img src="../Images/1241094ec01d835c56eed66bcf7067da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x6xtsbW5IqY9m1O1ymhYBQ.jpeg"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">èµ„æ–™æ¥æº:å½­åšã€ICEåŸºå‡†ç®¡ç†æœºæ„ã€ä¸–ç•Œé»„é‡‘åä¼šã€‚<a class="ae mr" href="https://www.gold.org/goldhub/research/relevance-of-gold-as-a-strategic-asset-2019" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a></p></figure><p id="fba7" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">ä»ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“S&amp;P500å‡ºç°æç«¯çš„è´Ÿå‘è¿åŠ¨æ—¶ï¼Œé»„é‡‘è¡¨ç°å‡ºè´Ÿç›¸å…³æ€§ã€‚æœ€è¿‘è‚¡å¸‚çš„å¤§å¹…ä¸‹è·Œä¹Ÿå‡¸æ˜¾äº†ç±»ä¼¼çš„å…³ç³»ï¼Œå½“é‡‘ä»·å› é¢„æœŸä¸‹è·Œè€Œä¸Šæ¶¨æ—¶ï¼Œå¹´åˆè‡³ä»Šé‡‘ä»·ä¸Šæ¶¨äº†11%ï¼Œè€ŒS&amp;P500å¹´åˆè‡³ä»Šä¸‹è·Œäº†11%ã€‚</p><p id="4f98" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">ç„¶è€Œï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æœºå™¨å­¦ä¹ æ¥è¯„ä¼°å‡è®¾ã€‚æ‚¨å¯ä»¥ç›´æ¥ä»æˆ‘çš„<a class="ae mr" href="https://github.com/Riazone/Gold-Return-Prediction/blob/master/Training%20Data_Values.csv" rel="noopener ugc nofollow" target="_blank"> git-hub repo </a>ä¸‹è½½æ–‡ä»¶åä¸ºâ€˜Training Data _ Valuesâ€™çš„æ•°å€¼æ•°æ®</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="f04e" class="nb ks it mx b gy nc nd l ne nf">imp = [â€˜Goldâ€™,â€™Silverâ€™, â€˜Crude Oilâ€™, â€˜S&amp;P500â€™,â€™MSCI EM ETFâ€™]</span><span id="7e61" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk"># Calculating Short term -Historical Returns</em></strong><br/>change_days = [1,3,5,14,21]</span><span id="2c09" class="nb ks it mx b gy nk nd l ne nf">data = pd.DataFrame(data=values[â€˜Dateâ€™])<br/>for i in change_days:<br/> print(data.shape)<br/> x= values[cols].pct_change(periods=i).add_suffix(â€œ-T-â€+str(i))<br/> data=pd.concat(objs=(data,x),axis=1)<br/> x=[]<br/>print(data.shape)</span><span id="5e23" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk"># Calculating Long term Historical Returns</em></strong><br/>change_days = [60,90,180,250]</span><span id="3954" class="nb ks it mx b gy nk nd l ne nf">for i in change_days:<br/> print(data.shape)<br/> x= values[imp].pct_change(periods=i).add_suffix(â€œ-T-â€+str(i))<br/> data=pd.concat(objs=(data,x),axis=1)<br/> x=[]<br/>print(data.shape)</span></pre><p id="deda" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">é™¤äº†æ»åå›æŠ¥ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°ä¸åŒçª—å£çš„å½“å‰é‡‘ä»·ç¦»å…¶ç§»åŠ¨å¹³å‡çº¿æœ‰å¤šè¿œã€‚è¿™æ˜¯æŠ€æœ¯åˆ†æä¸­éå¸¸å¸¸ç”¨çš„æŒ‡æ ‡ï¼Œç§»åŠ¨å¹³å‡çº¿ä¸ºèµ„äº§ä»·æ ¼æä¾›æ”¯æ’‘å’Œé˜»åŠ›ã€‚æˆ‘ä»¬ä½¿ç”¨ç®€å•ç§»åŠ¨å¹³å‡çº¿å’ŒæŒ‡æ•°ç§»åŠ¨å¹³å‡çº¿çš„ç»„åˆã€‚ç„¶åï¼Œæˆ‘ä»¬å°†è¿™äº›ç§»åŠ¨å¹³å‡å€¼æ·»åŠ åˆ°ç°æœ‰çš„ç‰¹å¾ç©ºé—´ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="5dc5" class="nb ks it mx b gy nc nd l ne nf"><strong class="mx jd"><em class="mk">#Calculating Moving averages for Gold</em></strong><br/>moving_avg = pd.DataFrame(values[â€˜Dateâ€™],columns=[â€˜Dateâ€™])<br/>moving_avg[â€˜Dateâ€™]=pd.to_datetime(moving_avg[â€˜Dateâ€™],format=â€™%Y-%b-%dâ€™)<br/><strong class="mx jd"><em class="mk">#Adding Simple Moving Average</em></strong><br/>moving_avg[â€˜Gold/15SMAâ€™] = (values[â€˜Goldâ€™]/(values[â€˜Goldâ€™].rolling(window=15).mean()))-1<br/>moving_avg[â€˜Gold/30SMAâ€™] = (values[â€˜Goldâ€™]/(values[â€˜Goldâ€™].rolling(window=30).mean()))-1<br/>moving_avg[â€˜Gold/60SMAâ€™] = (values[â€˜Goldâ€™]/(values[â€˜Goldâ€™].rolling(window=60).mean()))-1<br/>moving_avg[â€˜Gold/90SMAâ€™] = (values[â€˜Goldâ€™]/(values[â€˜Goldâ€™].rolling(window=90).mean()))-1<br/>moving_avg[â€˜Gold/180SMAâ€™] = (values[â€˜Goldâ€™]/(values[â€˜Goldâ€™].rolling(window=180).mean()))-1</span><span id="0de2" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Adding Exponential Moving Average<br/></em></strong>moving_avg[â€˜Gold/90EMAâ€™] = (values[â€˜Goldâ€™]/(values[â€˜Goldâ€™].ewm(span=90,adjust=True,ignore_na=True).mean()))-1<br/>moving_avg[â€˜Gold/180EMAâ€™] = (values[â€˜Goldâ€™]/(values[â€˜Goldâ€™].ewm(span=180,adjust=True,ignore_na=True).mean()))-1<br/>moving_avg = moving_avg.dropna(axis=0)<br/>print(moving_avg.shape)<br/>moving_avg.head(20)</span></pre><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/a8a242b98b0ac7b771f1406f652a1e2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*nPd7K-2XXRt_e9m3K4pP4g.png"/></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">ç§»åŠ¨å¹³å‡æ•°æ®å¸§çš„è¾“å‡º</p></figure><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="ccbf" class="nb ks it mx b gy nc nd l ne nf"><strong class="mx jd"><em class="mk">#Merging Moving Average values to the feature space</em></strong><br/>data[â€˜Dateâ€™]=pd.to_datetime(data[â€˜Dateâ€™],format=â€™%Y-%b-%dâ€™)<br/>data = pd.merge(left=data,right=moving_avg,how=â€™leftâ€™,on=â€™Dateâ€™)<br/>print(data.shape)<br/>data.isna().sum()</span></pre><p id="fdbb" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">è¿™éƒ½æ˜¯å…³äºç‰¹æ€§çš„ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦åˆ›å»ºç›®æ ‡ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æƒ³è¦é¢„æµ‹çš„ã€‚å› ä¸ºæˆ‘ä»¬åœ¨é¢„æµ‹å›æŠ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸€ä¸ªæˆ‘ä»¬éœ€è¦é¢„æµ‹å›æŠ¥çš„æ—¶é—´èŒƒå›´ã€‚æˆ‘é€‰æ‹©äº†14å¤©å’Œ22å¤©çš„æ—¶é—´èŒƒå›´ï¼Œå› ä¸ºå…¶ä»–æ›´å°çš„æ—¶é—´èŒƒå›´å¾€å¾€éå¸¸ä¸ç¨³å®šï¼Œç¼ºä¹é¢„æµ‹èƒ½åŠ›ã€‚ç„¶è€Œï¼Œä½ ä¹Ÿå¯ä»¥å°è¯•å…¶ä»–çš„åœ°å¹³çº¿ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="4fcc" class="nb ks it mx b gy nc nd l ne nf"><strong class="mx jd"><em class="mk">#Calculating forward returns for Target</em></strong><br/>y = pd.DataFrame(data=values[â€˜Dateâ€™])<br/>y[â€˜Gold-T+14â€™]=values[â€œGoldâ€].pct_change(periods=-14)<br/>y[â€˜Gold-T+22â€™]=values[â€œGoldâ€].pct_change(periods=-22)<br/>print(y.shape)<br/>y.isna().sum()</span><span id="2496" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk"># Removing NAs</em></strong><br/><br/>data = data[data[â€˜Gold-T-250â€™].notna()]<br/>y = y[y[â€˜Gold-T+22â€™].notna()]</span><span id="1d30" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Adding Target Variables</em></strong><br/>data = pd.merge(left=data,right=y,how=â€™innerâ€™,on=â€™Dateâ€™,suffixes=(False,False))<br/>print(data.shape)</span></pre><p id="1b87" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†å®Œæ•´çš„æ•°æ®é›†ï¼Œå¯ä»¥å¼€å§‹å»ºæ¨¡äº†ã€‚åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æå…¶åˆ›æ–°å’Œé«˜æ•ˆçš„PyCaretåº“æ¥è¯•éªŒä¸åŒçš„ç®—æ³•ã€‚æˆ‘è¿˜å°†å±•ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªç®¡é“æ¥ä¸æ–­å¯¼å…¥æ–°æ•°æ®ï¼Œä»¥ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹ç”Ÿæˆé¢„æµ‹ã€‚</p></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><h1 id="574f" class="kr ks it bd kt ku oe kw kx ky of la lb ki og kj ld kl oh km lf ko oi kp lh li bi translated">åˆ©ç”¨æœºå™¨å­¦ä¹ é¢„æµ‹é»„é‡‘ä»·æ ¼</h1><h2 id="81de" class="nb ks it bd kt oj ok dn kx ol om dp lb ls on oo ld lw op oq lf ma or os lh iz bi translated">ä½¿ç”¨PyCaretçš„ç¬¬äºŒéƒ¨åˆ†å›å½’å»ºæ¨¡</h2><p id="239a" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">åœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†ä»å¼€æºå…è´¹APIå¯¼å…¥æ•°æ®ï¼Œå¹¶ä»¥ä¸€ç§é€‚åˆæˆ‘ä»¬é¢„æœŸçš„æœºå™¨å­¦ä¹ ç»ƒä¹ çš„æ–¹å¼å‡†å¤‡å®ƒã€‚æ‚¨å¯ä»¥å‚è€ƒç¬¬ä¸€éƒ¨åˆ†çš„ä»£ç ï¼Œæˆ–è€…ä»<a class="ae mr" href="https://github.com/Riazone/Gold-Return-Prediction/blob/master/Training%20Data.csv" rel="noopener ugc nofollow" target="_blank"> github repo </a>å¯¼å…¥æ–‡ä»¶åä¸ºâ€œTraining Dataâ€çš„æœ€ç»ˆæ•°æ®é›†ã€‚</p><p id="aa49" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">PyCaretæ˜¯Pythonä¸­çš„ä¸€ä¸ªå¼€æºæœºå™¨å­¦ä¹ åº“ï¼Œå¯ä»¥åœ¨ä»»ä½•ç¬”è®°æœ¬ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œå¹¶å¤§å¤§å‡å°‘äº†ç¼–ç å·¥ä½œï¼Œä½¿è¿‡ç¨‹å˜å¾—éå¸¸é«˜æ•ˆã€‚åœ¨ä¸‹é¢çš„éƒ¨åˆ†æˆ‘ä»¬å°†çœ‹åˆ°<strong class="ll jd"><em class="mk"/></strong><a class="ae mr" href="https://pycaret.org/" rel="noopener ugc nofollow" target="_blank"><strong class="ll jd"><em class="mk">py caret</em></strong></a>å¦‚ä½•ä¸ºä»»ä½•æœºå™¨å­¦ä¹ å®éªŒå¢å‹ã€‚é¦–å…ˆï¼Œæ‚¨éœ€è¦ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…PyCaret:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="f848" class="nb ks it mx b gy nc nd l ne nf">!pip install pycaret</span></pre><h2 id="6605" class="nb ks it bd kt oj ok dn kx ol om dp lb ls on oo ld lw op oq lf ma or os lh iz bi translated">22å¤©æ¨¡å‹</h2><p id="e4b1" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">æˆ‘ä»¬ä»¥22å¤©ä¸ºç›®æ ‡ã€‚è¿™æ„å‘³ç€ï¼Œæ ¹æ®å†å²æ•°æ®ï¼Œæˆ‘ä»¬å°†å°è¯•é¢„æµ‹æœªæ¥ä¸‰å‘¨çš„é»„é‡‘å›æŠ¥ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="17c6" class="nb ks it mx b gy nc nd l ne nf"><strong class="mx jd"><em class="mk">#If you are importing downloaded dataset</em></strong><br/>data = pd.read_csv("Training Data.csv")</span><span id="1b8f" class="nb ks it mx b gy nk nd l ne nf">from pycaret.regression import *</span><span id="8eea" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#We have two target columns. We will remove the T+14 day Target<br/></em></strong>data_22= data.drop(['Gold-T+14'],axis=1)</span></pre><p id="3297" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd">è®¾ç½®</strong></p><p id="37de" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">è¦åœ¨PyCaretä¸­å¼€å§‹ä»»ä½•å»ºæ¨¡ç»ƒä¹ ï¼Œç¬¬ä¸€æ­¥æ˜¯â€œè®¾ç½®â€åŠŸèƒ½ã€‚è¿™é‡Œçš„å¼ºåˆ¶å˜é‡æ˜¯æ•°æ®é›†å’Œæ•°æ®é›†ä¸­çš„ç›®æ ‡æ ‡ç­¾ã€‚æ‰€æœ‰åŸºæœ¬å’Œå¿…è¦çš„æ•°æ®è½¬æ¢ï¼Œå¦‚ä¸¢å¼ƒidã€ä¸€æ¬¡æ€§ç¼–ç åˆ†ç±»å› å­å’Œç¼ºå¤±å€¼æ’è¡¥ï¼Œéƒ½åœ¨åå°è‡ªåŠ¨è¿›è¡Œã€‚PyCaretè¿˜æä¾›äº†20å¤šä¸ªé¢„å¤„ç†é€‰é¡¹ã€‚å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å°†åœ¨è®¾ç½®ä¸­ä½¿ç”¨åŸºç¡€çŸ¥è¯†ï¼Œå¹¶åœ¨åé¢çš„å®éªŒä¸­å°è¯•ä¸åŒçš„é¢„å¤„ç†æŠ€æœ¯ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="76a3" class="nb ks it mx b gy nc nd l ne nf">a=setup(data_22,target='Gold-T+22',<br/>        ignore_features=['Date'],session_id=11,<br/>        silent=True,profile=False);</span></pre><p id="788c" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ•°æ®é›†ä½œä¸ºâ€œdata_22â€ä¼ é€’ï¼Œç›®æ ‡æŒ‡å‘æ ‡è®°ä¸ºâ€œGold-T+22â€çš„åˆ—ã€‚æˆ‘ç‰¹åˆ«æåˆ°è¦å¿½ç•¥â€œæ—¥æœŸâ€åˆ—ï¼Œä»¥é˜²æ­¢PyCaretåœ¨æ—¥æœŸåˆ—ä¸Šåˆ›å»ºåŸºäºæ—¶é—´çš„åŠŸèƒ½ï¼Œè¿™åœ¨å…¶ä»–æƒ…å†µä¸‹å¯èƒ½éå¸¸æœ‰ç”¨ï¼Œä½†æˆ‘ä»¬ç°åœ¨ä¸è¯„ä¼°è¿™ä¸€ç‚¹ã€‚å¦‚æœæ‚¨æƒ³æŸ¥çœ‹å˜é‡ä¹‹é—´çš„åˆ†å¸ƒå’Œç›¸å…³æ€§ï¼Œæ‚¨å¯ä»¥ä¿ç•™å‚æ•°â€œprofile=Trueâ€ï¼Œå®ƒæ˜¾ç¤ºä¸€ä¸ªpanda profilerè¾“å‡ºã€‚æˆ‘ç‰¹æ„æä¾›äº†â€˜session _ id = 11 â€™,ä»¥ä¾¿èƒ½å¤Ÿé‡æ–°åˆ›å»ºç»“æœã€‚</p><p id="a67b" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd">é­”æ³•å‘½ä»¤....<em class="mk">compare _ models()</em>T3ã€‘</strong></p><p id="500e" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">ä¸‹ä¸€æ­¥ï¼Œæˆ‘å°†ä½¿ç”¨PyCaretçš„ä¸€ä¸ªæˆ‘æœ€å–œæ¬¢çš„ç‰¹æ€§ï¼Œå®ƒå°†æ•°ç™¾è¡Œä»£ç ç¼©å‡ä¸ºä¸¤ä¸ªå­—â€”â€”â€œcompare _ modelsâ€ã€‚è¯¥å‡½æ•°ä½¿ç”¨æ‰€æœ‰ç®—æ³•(ç›®å‰æœ‰25ç§)å¹¶ä½¿å®ƒä»¬é€‚åˆæ•°æ®ï¼Œè¿è¡Œ10é‡äº¤å‰éªŒè¯ï¼Œå¹¶ä¸ºæ¯ä¸ªæ¨¡å‹æä¾›6ä¸ªè¯„ä¼°æŒ‡æ ‡ã€‚æ‰€æœ‰è¿™äº›åªç”¨ä¸¤ä¸ªå­—ã€‚ä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œå‡½æ•°ä¸­è¿˜å¯ä»¥ä½¿ç”¨å¦å¤–ä¸¤ä¸ªå‚æ•°:</p><p id="eebb" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd"> a. turbo=False </strong> â€”é»˜è®¤ä¸ºçœŸã€‚å½“turbo=Trueæ—¶ï¼Œæ¯”è¾ƒæ¨¡å‹ä¸ä¼šè¯„ä¼°ä¸€äº›æ›´æ˜‚è´µçš„ç®—æ³•ï¼Œå³æ ¸è„Š(kr)ã€è‡ªåŠ¨ç›¸å…³æ€§ç¡®å®š(ard)å’Œå¤šå±‚æ„ŸçŸ¥å™¨(mlp)</p><p id="57d7" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd"> b .é»‘åå•</strong> â€”åœ¨è¿™é‡Œï¼Œå¯ä»¥ä¼ é€’ç®—æ³•ç¼©å†™çš„åˆ—è¡¨(å‚è§docstring ),è¿™æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„è€—æ—¶æ›´é•¿ä¸”æ€§èƒ½æ”¹å–„å¾ˆå°çš„æ–¹æ³•ã€‚ä¸‹é¢ï¼Œæˆ‘å·²ç»æŠŠå°¼å°”æ£®å›å½’å™¨(tr)åˆ—å…¥äº†é»‘åå•</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="3e1a" class="nb ks it mx b gy nc nd l ne nf">compare_models(blacklist=['tr'],turbo=True)</span></pre><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/d0162a42a31060ea5467a491e2deb486.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*qyHVCx4o4J7DfvHByLWcvA.png"/></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">æ¯”è¾ƒæ¨¡å‹çš„è¾“å‡º</p></figure><p id="d460" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">è¿™é‡Œæˆ‘ä»¬å°†ä½¿ç”¨Rå¹³æ–¹(R2)ä½œä¸ºåº¦é‡æ ‡å‡†ã€‚æˆ‘ä»¬çœ‹åˆ°ETã€Catboostå’ŒKNNæ˜¯å‰ä¸‰åçš„æ¨¡å‹ã€‚ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†è°ƒæ•´ä¸‰ä¸ªæ¨¡å‹çš„è¶…å‚æ•°ã€‚</p><p id="f18a" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd">è°ƒæ•´æ¨¡å‹è¶…å‚æ•°</strong></p><p id="ed05" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">PyCaretä¸ºæ¯ä¸ªç®—æ³•éƒ½é¢„å®šä¹‰äº†ä¸€ä¸ªç½‘æ ¼ï¼Œå¹¶ä¸”<strong class="ll jd"> <em class="mk"> tune_model() </em> </strong>å‡½æ•°ä½¿ç”¨éšæœºç½‘æ ¼æœç´¢æ¥æŸ¥æ‰¾ä¼˜åŒ–æŒ‡æ ‡é€‰æ‹©çš„å‚æ•°é›†(æ­¤å¤„ä¸ºRsquare ),å¹¶æ˜¾ç¤ºä¼˜åŒ–æ¨¡å‹çš„äº¤å‰éªŒè¯åˆ†æ•°ã€‚å®ƒä¸æ¥å—ç»è¿‡è®­ç»ƒçš„æ¨¡å‹ï¼Œå¹¶ä¸”éœ€è¦ä½œä¸ºå­—ç¬¦ä¸²ä¼ é€’çš„ä¼°è®¡é‡çš„ç¼©å†™ã€‚æˆ‘ä»¬å°†è°ƒæ•´é¢å¤–æ ‘(et)ã€Kæœ€è¿‘é‚»(knn)å’ŒCatBoost (catboost)å›å½’å™¨ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="5a4f" class="nb ks it mx b gy nc nd l ne nf">et_tuned = tune_model(â€˜etâ€™)</span></pre><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/20a519e288010c98fdede54b8cc6fa45.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/1*Uyr9_ZMPPj1ymb7qQLVEVw.png"/></div></figure><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="0e46" class="nb ks it mx b gy nc nd l ne nf">catb_tuned = tune_model(â€˜catboostâ€™)</span></pre><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/10b1b9287a528fe802ea76cd83c2e551.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*n_Ss1NREh9Bgjcmveb3jIw.png"/></div></figure><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="4883" class="nb ks it mx b gy nc nd l ne nf">knn_tuned = tune_model(â€˜knnâ€™,n_iter=150)</span><span id="0ada" class="nb ks it mx b gy nk nd l ne nf"><em class="mk">#I have increased the iteration in knn because increasing iterations have shown to perform better for knn rather than other models in question without significantly increasing the training time.</em></span></pre><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/550777fdfa0d9c00ebf91952543aef33.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*jNwXyUhJAiWNr2BTb63eEA.png"/></div></figure><p id="e42b" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">ä¸Šé¢æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œknnçš„R2åœ¨è°ƒä¼˜åå¤§å¹…æå‡è‡³87.86%ï¼Œè¿œé«˜äºè°ƒä¼˜åæ²¡æœ‰æå‡çš„etå’Œcatboostã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºç½‘æ ¼æœç´¢è¿‡ç¨‹ä¸­çš„éšæœºåŒ–ã€‚åœ¨ä¸€äº›éå¸¸é«˜çš„è¿­ä»£æ¬¡æ•°ä¸‹ï¼Œå®ƒä»¬å¯èƒ½ä¼šæ”¹è¿›ã€‚</p><p id="1dda" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">æˆ‘è¿˜ä¼šåˆ›å»ºä¸€ä¸ªåŸºæœ¬çš„é¢å¤–æ ‘(et)æ¨¡å‹ï¼Œå› ä¸ºå®ƒçš„åŸå§‹æ€§èƒ½(è°ƒä¼˜å‰)éå¸¸æ¥è¿‘è°ƒä¼˜åçš„knnã€‚æˆ‘ä»¬å°†ä½¿ç”¨PyCaretä¸­çš„<strong class="ll jd"><em class="mk">create _ model()</em></strong>å‡½æ•°æ¥åˆ›å»ºæ¨¡å‹ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="049d" class="nb ks it mx b gy nc nd l ne nf">et = create_model(â€˜etâ€™)</span></pre><p id="3c31" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd">è¯„ä¼°æ¨¡å‹</strong></p><p id="8d44" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">å¯¹è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œä¸€äº›æ¨¡å‹è¯Šæ–­æ˜¯å¾ˆé‡è¦çš„ã€‚æˆ‘ä»¬å°†ä½¿ç”¨PyCaretä¸­çš„<strong class="ll jd"> <em class="mk"> evaluate_model() </em> </strong>å‡½æ•°æ¥æŸ¥çœ‹ç»˜å›¾é›†å’Œå…¶ä»–è¯Šæ–­ä¿¡æ¯ã€‚å®ƒæ¥å—ç»è¿‡è®­ç»ƒçš„æ¨¡å‹ï¼Œä»¥è¿”å›æ¨¡å‹è¯Šæ–­å›¾å’Œæ¨¡å‹å®šä¹‰çš„é€‰æ‹©ã€‚æˆ‘ä»¬å°†å¯¹æˆ‘ä»¬çš„ä¸¤ä¸ªé¡¶çº§æ¨¡å‹è¿›è¡Œæ¨¡å‹è¯Šæ–­ï¼Œå³knn_tunedå’Œetã€‚</p><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi ox"><img src="../Images/5e80629540849143383600b07560080e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vecSoo26snJEaae8bi8OzA.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">åº“å…‹è·ç¦»å›¾knn_tuned</p></figure><p id="7d54" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">ä¸Šé¢ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œåœ¨å‰500ä¸ªè§‚å¯Ÿå€¼ä¸­ï¼Œæœ‰è®¸å¤šå¼‚å¸¸å€¼ï¼Œå®ƒä»¬ä¸ä»…å½±å“æ¨¡å‹æ€§èƒ½ï¼Œè¿˜å¯èƒ½å½±å“æœªæ¥çš„æ¨¡å‹æ³›åŒ–ã€‚å› æ­¤ï¼Œå»é™¤è¿™äº›å¼‚å¸¸å€¼å¯èƒ½æ˜¯å€¼å¾—çš„ã€‚ä½†åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬å°†é€šè¿‡etæ¥äº†è§£ç‰¹å¾é‡è¦æ€§(knnä¸æä¾›ç‰¹å¾é‡è¦æ€§)</p><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi oy"><img src="../Images/70d15f5fbcd14dd4e70bea960f4a6d8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*98uU-bVryZsx-ew8k52bJg.png"/></div></div></figure><p id="841f" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">æˆ‘ä»¬è®¤ä¸ºï¼Œç™½é“¶å’Œæ–°å…´å¸‚åœºETFçš„å›æŠ¥ç‡å…·æœ‰æœ€é«˜çš„ç‰¹å¾é‡è¦æ€§ï¼Œçªæ˜¾å‡ºç™½é“¶å’Œé»„é‡‘é€šå¸¸æˆå¯¹æ³¢åŠ¨ï¼Œè€ŒæŠ•èµ„ç»„åˆé…ç½®ç¡®å®åœ¨æ–°å…´å¸‚åœºè‚¡ç¥¨å’Œé»„é‡‘ä¹‹é—´è½¬ç§»ã€‚</p><p id="25b6" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd">å»é™¤å¼‚å¸¸å€¼</strong></p><p id="77b7" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">è¦ç§»é™¤å¼‚å¸¸å€¼ï¼Œæˆ‘ä»¬éœ€è¦å›åˆ°è®¾ç½®é˜¶æ®µï¼Œä½¿ç”¨PyCaretå†…ç½®çš„å¼‚å¸¸å€¼ç§»é™¤å™¨ï¼Œå¹¶å†æ¬¡åˆ›å»ºæ¨¡å‹ä»¥æŸ¥çœ‹å½±å“ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="64dc" class="nb ks it mx b gy nc nd l ne nf">b=setup(data_22,target=â€™Gold-T+22', ignore_features=[â€˜Dateâ€™], session_id=11,silent=True,profile=False,remove_outliers=True);</span></pre><p id="51c5" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">å¦‚æœ<strong class="ll jd"><em class="mk">' remove _ outliers '</em></strong>å‚æ•°è®¾ç½®ä¸ºtrueï¼ŒPyCaretä½¿ç”¨å¥‡å¼‚å€¼åˆ†è§£(SVD)æŠ€æœ¯åˆ é™¤é€šè¿‡PCAçº¿æ€§é™ç»´è¯†åˆ«çš„ç¦»ç¾¤å€¼ã€‚é»˜è®¤æ‚è´¨æ°´å¹³ä¸º5%ã€‚è¿™æ„å‘³ç€å®ƒå°†åˆ é™¤5%çš„è§‚å¯Ÿå€¼ï¼Œå®ƒè®¤ä¸ºæ˜¯ç¦»ç¾¤å€¼ã€‚</p><p id="96ab" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">ç§»é™¤å¼‚å¸¸å€¼åï¼Œæˆ‘ä»¬å†æ¬¡è¿è¡Œæˆ‘ä»¬çš„é¡¶çº§æ¨¡å‹ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰ä»»ä½•æ€§èƒ½æ”¹è¿›ï¼Œæ˜¾ç„¶æœ‰ã€‚</p><div class="ms mt mu mv gt ab cb"><figure class="oz nh pa pb pc pd pe paragraph-image"><img src="../Images/e2b319c4ecb20a52299f97941c9345b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*XV-SkGw8rAQgNGZZc9p_CA.png"/></figure><figure class="oz nh pf pb pc pd pe paragraph-image"><img src="../Images/49c4937fe38f3fca54eebb6b37e052d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*Iq5k-FAxyNo9NC_FxB74nw.png"/><p class="nq nr gj gh gi ns nt bd b be z dk pg di ph pi translated">å‰”é™¤å¼‚å¸¸å€¼åçš„etå’Œknn_tunedç»“æœ</p></figure></div><p id="6eea" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">æˆ‘ä»¬çœ‹åˆ°etçš„æ€§èƒ½ä»85.43%æé«˜åˆ°86.16%ï¼Œknn_tunedçš„æ€§èƒ½ä»87.86%æé«˜åˆ°88.3%ã€‚è¤¶çš±é—´çš„æ ‡å‡†å·®ä¹Ÿæœ‰æ‰€é™ä½ã€‚</p><p id="d5c6" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd">é›†åˆæ¨¡å‹</strong></p><p id="9947" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">æˆ‘ä»¬è¿˜å¯ä»¥å°è¯•çœ‹çœ‹bagging/boostingæ˜¯å¦å¯ä»¥æé«˜æ¨¡å‹æ€§èƒ½ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨PyCaretä¸­çš„<strong class="ll jd"><em class="mk">ensemble _ model()</em></strong>å‡½æ•°ï¼Œé€šè¿‡ä¸‹é¢çš„ä»£ç å¿«é€ŸæŸ¥çœ‹é›†æˆæ–¹æ³•å¦‚ä½•æ”¹å–„ç»“æœ:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="8228" class="nb ks it mx b gy nc nd l ne nf">et_bagged = ensemble_model(et,method=â€™Baggingâ€™)<br/>knn_tuned_bagged = ensemble_model(knn_tuned, method='Bagging')</span></pre><p id="b073" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">ä¸Šè¿°ä»£ç å°†æ˜¾ç¤ºç±»ä¼¼çš„äº¤å‰éªŒè¯åˆ†æ•°ï¼Œä½†æ²¡æœ‰æ˜¾ç¤ºå‡ºå¤ªå¤§çš„æ”¹è¿›ã€‚å›è´­ä¸­çš„ç¬”è®°æœ¬é“¾æ¥å¯ä»¥çœ‹åˆ°ç»“æœã€‚</p><p id="b309" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd">æ··åˆæ¨¡å‹</strong></p><p id="232f" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">æˆ‘ä»¬å¯ä»¥æ··åˆå‰2ä¸ªæ¨¡å‹(etå’Œknn_tuned)æ¥çœ‹çœ‹æ··åˆæ¨¡å‹æ˜¯å¦å¯ä»¥è¡¨ç°å¾—æ›´å¥½ã€‚äººä»¬ç»å¸¸çœ‹åˆ°ï¼Œæ··åˆæ¨¡å‹ç»å¸¸å­¦ä¹ ä¸åŒçš„æ¨¡å¼ï¼Œå¹¶ä¸”å®ƒä»¬ä¸€èµ·å…·æœ‰æ›´å¥½çš„é¢„æµ‹èƒ½åŠ›ã€‚ä¸ºæ­¤æˆ‘å°†ä½¿ç”¨PyCaretçš„<strong class="ll jd"><em class="mk">blend _ models()</em></strong>å‡½æ•°ã€‚å®ƒæ¥å—ä¸€ä¸ªè®­ç»ƒæ¨¡å‹åˆ—è¡¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ··åˆæ¨¡å‹å’Œ10å€äº¤å‰éªŒè¯åˆ†æ•°ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="c875" class="nb ks it mx b gy nc nd l ne nf">blend_knn_et = blend_models(estimator_list=[knn_tuned,et])</span></pre><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/5e76bdf4a7d4c7f58bba6b7f493ea683.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*KBFj0LhJQrw8tI1frwPntg.png"/></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">æ··åˆæ¨¡å‹çš„ç»“æœ</p></figure><p id="c36a" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">åœ¨ä¸Šè¡¨ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°æ··åˆçš„<strong class="ll jd"> <em class="mk"> knn_tuned </em> </strong>å’Œ<strong class="ll jd"> <em class="mk"> et </em> </strong>è¿”å›æ¯”ä¸¤è€…æ›´å¥½åœ°è¡¨ç¤ºR2ã€‚ä¸<strong class="ll jd"> <em class="mk"> knn_tuned </em> </strong>ç›¸æ¯”ï¼ŒR2çš„å¹³å‡R2å¢åŠ äº†1.9%ï¼Œæ ‡å‡†å·®å‡å°‘äº†1.9%ï¼Œè¿™æ„å‘³ç€è·¨è¤¶çš±çš„æ€§èƒ½æ›´å¥½ã€æ›´ä¸€è‡´ã€‚</p><p id="9970" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">90.2%çš„å¹³å‡R2æ„å‘³ç€æˆ‘ä»¬çš„æ¨¡å‹èƒ½å¤Ÿä»æˆ‘ä»¬æä¾›çš„ç‰¹å¾ä¸­æ•æ‰å¹³å‡90.2%çš„é»„é‡‘å›æŠ¥å˜åŒ–ã€‚</p><p id="64f8" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd">å †å æ¨¡å‹</strong></p><p id="c132" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">è™½ç„¶æ··åˆæ¨¡å‹çš„ç»“æœå¾ˆå¥½ï¼Œä½†æˆ‘æƒ³çœ‹çœ‹æ˜¯å¦æœ‰å¯èƒ½ä»æ•°æ®ä¸­æå–æ›´å¤šçš„R2åŸºç‚¹ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†å»ºç«‹ä¸€ä¸ªå¤šå±‚æ¬¡çš„æ¨¡å‹å †æ ˆã€‚è¿™ä¸åŒäºæ··åˆï¼Œå› ä¸ºæ¨¡å‹å±‚æ˜¯æŒ‰é¡ºåºå †å çš„ï¼Œå› æ­¤ä¸€å±‚ä¸­æ¨¡å‹çš„é¢„æµ‹å°†ä¸åŸå§‹è¦ç´ ä¸€èµ·ä¼ é€’åˆ°æ¨¡å‹çš„ä¸‹ä¸€å±‚(å¦‚æœrestack = True)ã€‚ä¸€ç»„æ¨¡å‹çš„é¢„æµ‹æå¤§åœ°å¸®åŠ©äº†åç»­æ¨¡å‹çš„é¢„æµ‹ã€‚é“¾çš„æœ«ç«¯æ˜¯å…ƒæ¨¡å‹(é»˜è®¤æ˜¯çº¿æ€§çš„)ã€‚PyCaret guideæœ‰æ›´å¤šå…³äº<a class="ae mr" href="https://pycaret.org/stack-models/" rel="noopener ugc nofollow" target="_blank">ä¸»é¢˜</a>çš„ç»†èŠ‚ã€‚åœ¨ç¬”è®°æœ¬ä¸­ï¼Œæˆ‘å°è¯•äº†å‡ ç§æ¶æ„ã€‚ä¸‹é¢å±•ç¤ºçš„æ˜¯æ€§èƒ½æœ€ä½³çš„äº§å“:</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="ece0" class="nb ks it mx b gy nc nd l ne nf">stack2 = create_stacknet(estimator_list=[[catb,et,knn_tuned],[blend_knn_et]], restack=True)</span></pre><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/4aebda0982ceeb32ea77bcf8ff799654.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*C0bE6lZdqnuM1sQ4N1idpg.png"/></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">å †å 2çš„ç»“æœ(å¤šå±‚å †å )</p></figure><p id="976e" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">æ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šé¢çœ‹åˆ°çš„ï¼Œ<strong class="ll jd"> <em class="mk"> stack2 </em> </strong>æ¨¡å‹æ¯”<strong class="ll jd"> <em class="mk"> blend_knn_et </em> </strong>æœ‰1%çš„R2ï¼Œæˆ‘ä»¬å°†é€‰æ‹©<strong class="ll jd"> <em class="mk"> stack2 </em> </strong>ä½œä¸ºæœ€ä½³æ¨¡å‹ï¼Œå¹¶ä¿å­˜å®ƒç”¨äºé¢„æµ‹ã€‚</p><p id="43c8" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd">ä¿å­˜æ¨¡å¼</strong></p><p id="9079" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">ä¸€æ—¦æ¨¡å‹å®šå‹ï¼Œæˆ‘ä»¬éœ€è¦ä¿å­˜æ¨¡å‹ï¼Œä»¥ä¾¿åœ¨æ–°æ•°æ®ä¸Šä½¿ç”¨å®ƒæ¥è¿›è¡Œé¢„æµ‹ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡save_model()æ¥å®ç°ã€‚è¿™ä¼šå°†æ¨¡å‹ä¿å­˜åœ¨å½“å‰ç›®å½•æˆ–ä»»ä½•å·²å®šä¹‰çš„è·¯å¾„ä¸­ã€‚ä¸‹é¢çš„ä»£ç å°†æ¨¡å‹å’Œé¢„å¤„ç†ç®¡é“ä¿å­˜ä¸ºåç§°<strong class="ll jd"><em class="mk">ã€22å¤©å›å½’å™¨ã€‘</em> </strong></p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="fc50" class="nb ks it mx b gy nc nd l ne nf">save_model(model=stack2, model_name=â€™22Day Regressorâ€™)</span></pre><p id="e560" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd">å¯¹æ–°æ•°æ®è¿›è¡Œé¢„æµ‹</strong></p><p id="afee" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">ä¸€æ—¦æˆ‘ä»¬ä¿å­˜äº†æˆ‘ä»¬çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å°†å¸Œæœ›åœ¨æ–°æ•°æ®åˆ°è¾¾æ—¶å¯¹å…¶è¿›è¡Œé¢„æµ‹ã€‚æˆ‘ä»¬å¯ä»¥ä¾é yahoofinancialsè½¯ä»¶åŒ…æ¥ç»™å‡ºæ‰€æœ‰å·¥å…·çš„æ”¶ç›˜ä»·ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦å†æ¬¡å‡†å¤‡æ–°çš„æ•°æ®ï¼Œä»¥ä¾¿èƒ½å¤Ÿä½¿ç”¨è¯¥æ¨¡å‹ã€‚è¿™äº›æ­¥éª¤ä¸æˆ‘ä»¬åœ¨å‡†å¤‡åŸ¹è®­æ•°æ®æ—¶æ‰€åšçš„ç±»ä¼¼ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯æˆ‘ä»¬å°†å¯¼å…¥æœ€æ–°çš„æ•°æ®ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¸ä¼šåˆ›å»ºæ ‡ç­¾(æˆ‘ä»¬ä¸èƒ½åˆ›å»ºæ ‡ç­¾ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰æœªæ¥çš„ä»·æ ¼)ã€‚ä¸‹é¢çš„ä»£ç chuckåº”è¯¥å¯¼å…¥å¹¶è°ƒæ•´æ•°æ®ï¼Œä½¿å…¶ä¸ºé¢„æµ‹åšå¥½å‡†å¤‡ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="d87c" class="nb ks it mx b gy nc nd l ne nf"><strong class="mx jd"><em class="mk">#Importing Libraries</em></strong><br/>import pandas as pd<br/>from datetime import datetime<br/>import matplotlib.pyplot as plt<br/>from yahoofinancials import YahooFinancials</span><span id="a77d" class="nb ks it mx b gy nk nd l ne nf">ticker_details = pd.read_excel("Ticker List.xlsx")<br/>ticker = ticker_details['Ticker'].to_list()<br/>names = ticker_details['Description'].to_list()</span><span id="28b0" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Preparing Date Range</em></strong><br/>end_date= datetime.strftime(datetime.today(),'%Y-%m-%d')<br/>start_date = "2019-01-01"<br/>date_range = pd.bdate_range(start=start_date,end=end_date)<br/>values = pd.DataFrame({ 'Date': date_range})<br/>values['Date']= pd.to_datetime(values['Date'])</span><span id="fbd8" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Extracting Data from Yahoo Finance and Adding them to Values table using date as key</em></strong><br/>for i in ticker:<br/>    raw_data = YahooFinancials(i)<br/>    raw_data = raw_data.get_historical_price_data(start_date, end_date, "daily")<br/>    df = pd.DataFrame(raw_data[i]['prices'])[['formatted_date','adjclose']]<br/>    df.columns = ['Date1',i]<br/>    df['Date1']= pd.to_datetime(df['Date1'])<br/>    values = values.merge(df,how='left',left_on='Date',right_on='Date1')<br/>    values = values.drop(labels='Date1',axis=1)</span><span id="59d9" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Renaming columns to represent instrument names rather than their ticker codes for ease of readability</em></strong><br/>names.insert(0,'Date')<br/>values.columns = names</span><span id="8148" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Front filling the NaN values in the data set</em></strong><br/>values = values.fillna(method="ffill",axis=0)<br/>values = values.fillna(method="bfill",axis=0)</span><span id="4a5d" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk"># Co-ercing numeric type to all columns except Date</em></strong><br/>cols=values.columns.drop('Date')<br/>values[cols] = values[cols].apply(pd.to_numeric,errors='coerce').round(decimals=1)<br/>imp = ['Gold','Silver', 'Crude Oil', 'S&amp;P500','MSCI EM ETF']</span><span id="dc14" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk"># Calculating Short term -Historical Returns</em></strong><br/>change_days = [1,3,5,14,21]</span><span id="954e" class="nb ks it mx b gy nk nd l ne nf">data = pd.DataFrame(data=values['Date'])<br/>for i in change_days:<br/>    x= values[cols].pct_change(periods=i).add_suffix("-T-"+str(i))<br/>    data=pd.concat(objs=(data,x),axis=1)<br/>    x=[]</span><span id="bd20" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk"># Calculating Long term Historical Returns</em></strong><br/>change_days = [60,90,180,250]</span><span id="a037" class="nb ks it mx b gy nk nd l ne nf">for i in change_days:<br/>    x= values[imp].pct_change(periods=i).add_suffix("-T-"+str(i))<br/>    data=pd.concat(objs=(data,x),axis=1)<br/>    x=[]</span><span id="16b7" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Calculating Moving averages for Gold</em></strong><br/>moving_avg = pd.DataFrame(values['Date'],columns=['Date'])<br/>moving_avg['Date']=pd.to_datetime(moving_avg['Date'],format='%Y-%b-%d')<br/>moving_avg['Gold/15SMA'] = (values['Gold']/(values['Gold'].rolling(window=15).mean()))-1<br/>moving_avg['Gold/30SMA'] = (values['Gold']/(values['Gold'].rolling(window=30).mean()))-1<br/>moving_avg['Gold/60SMA'] = (values['Gold']/(values['Gold'].rolling(window=60).mean()))-1<br/>moving_avg['Gold/90SMA'] = (values['Gold']/(values['Gold'].rolling(window=90).mean()))-1<br/>moving_avg['Gold/180SMA'] = (values['Gold']/(values['Gold'].rolling(window=180).mean()))-1<br/>moving_avg['Gold/90EMA'] = (values['Gold']/(values['Gold'].ewm(span=90,adjust=True,ignore_na=True).mean()))-1<br/>moving_avg['Gold/180EMA'] = (values['Gold']/(values['Gold'].ewm(span=180,adjust=True,ignore_na=True).mean()))-1<br/>moving_avg = moving_avg.dropna(axis=0)</span><span id="c0a3" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Merging Moving Average values to the feature space</em></strong></span><span id="ae71" class="nb ks it mx b gy nk nd l ne nf">data['Date']=pd.to_datetime(data['Date'],format='%Y-%b-%d')<br/>data = pd.merge(left=data,right=moving_avg,how='left',on='Date')<br/>data = data[data['Gold-T-250'].notna()]<br/>prediction_data = data.copy()</span></pre><p id="b4fb" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">å‡†å¤‡å¥½æ•°æ®åï¼Œæˆ‘ä»¬éœ€è¦åŠ è½½æ¨¡å‹å¹¶è¿›è¡Œé¢„æµ‹ã€‚ä¸ºäº†åŠ è½½æ¨¡å‹ï¼Œæˆ‘ä»¬å°†å†æ¬¡ä½¿ç”¨PyCaretçš„å›å½’æ¨¡å—ã€‚ä¸‹é¢çš„ä»£ç å°†åŠ è½½æ¨¡å‹ï¼Œå¯¹æ–°æ•°æ®è¿›è¡Œé¢„æµ‹ï¼Œå¹¶ä½¿ç”¨æ•°æ®é›†ä¸­æ¯ä¸ªæ—¥æœŸçš„å†å²ä»·æ ¼ã€é¢„è®¡å›æŠ¥å’Œ3å‘¨å†…çš„é¢„æµ‹ä»·æ ¼ã€‚</p><pre class="ms mt mu mv gt mw mx my mz aw na bi"><span id="d750" class="nb ks it mx b gy nc nd l ne nf">from pycaret.regression import *</span><span id="5bd5" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Loading the stored model<br/></em></strong>regressor_22 = load_model("22Day Regressor");</span><span id="63e3" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Making Predictions<br/></em></strong>predicted_return_22 = predict_model(regressor_22,data=prediction_data)<br/>predicted_return_22=predicted_return_22[['Date','Label']]<br/>predicted_return_22.columns = ['Date','Return_22']</span><span id="bf6f" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Adding return Predictions to Gold Values</em></strong><br/>predicted_values = values[['Date','Gold']]<br/>predicted_values = predicted_values.tail(len(predicted_return_22))<br/>predicted_values = pd.merge(left=predicted_values,right=predicted_return_22,on=['Date'],how='inner')<br/>predicted_values['Gold-T+22']=(predicted_values['Gold']*(1+predicted_values['Return_22'])).round(decimals =1)</span><span id="32bc" class="nb ks it mx b gy nk nd l ne nf"><strong class="mx jd"><em class="mk">#Adding T+22 Date<br/></em></strong>from datetime import datetime, timedelta</span><span id="dbbd" class="nb ks it mx b gy nk nd l ne nf">predicted_values['Date-T+22'] = predicted_values['Date']+timedelta(days = 22)<br/>predicted_values.tail()</span></pre><figure class="ms mt mu mv gt nh gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/03c371b9281ddfe68e734623e2c60138.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*OKAIYzGtwmhzagdQ1rIXlQ.png"/></div></figure><p id="4631" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">ä¸Šè¡¨è¾“å‡ºæ˜¾ç¤ºï¼Œé»„é‡‘åœ¨2020å¹´4æœˆ17æ—¥çš„æ”¶ç›˜ä»·ä¸º1ï¼Œ694.5ç¾å…ƒï¼Œæ¨¡å‹é¢„æµ‹åœ¨æ¥ä¸‹æ¥çš„22å¤©å†…ï¼Œå›æŠ¥å°†ä¸º-2.3%ï¼Œå¯¼è‡´2020å¹´5æœˆ9æ—¥çš„ä»·æ ¼ç›®æ ‡ä¸º1ï¼Œ655ç¾å…ƒã€‚æˆ‘ä¸ºé¢„æµ‹å»ºç«‹äº†ä¸€ä¸ªå•ç‹¬çš„ç¬”è®°æœ¬ï¼Œæ ‡é¢˜ä¸º<strong class="ll jd"> <em class="mk">â€œé»„é‡‘é¢„æµ‹æ–°æ•°æ®â€”å›å½’â€</em> </strong>ï¼Œå¯ä»¥åœ¨å›è´­<a class="ae mr" href="https://github.com/Riazone/Gold-Return-Prediction/blob/master/Regression/Gold%20Prediction%20New%20Data%20-%20Regression.ipynb" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>æ‰¾åˆ°ã€‚</p><p id="08f5" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æ¦‚å¿µå’ŒæŠ€æœ¯æ¥é¢„æµ‹T+14å¤©ã€‚ä»£ç å’Œè¾“å‡ºå¯ä»¥åœ¨Jupyterç¬”è®°æœ¬æ ‡é¢˜<strong class="ll jd"> <em class="mk">â€œé»„é‡‘é¢„æµ‹å®éªŒå›å½’â€”py caretâ€</em></strong>ä¸­æ‰¾åˆ°ï¼Œåœ¨repo <a class="ae mr" href="https://github.com/Riazone/Gold-Return-Prediction/blob/master/Regression/Gold%20Prediction%20Experiment%20%20Regression-%20PyCaret.ipynb" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>ã€‚</p><h1 id="ef26" class="kr ks it bd kt ku kv kw kx ky kz la lb ki lc kj ld kl le km lf ko lg kp lh li bi translated">é‡è¦é“¾æ¥</h1><p id="6a53" class="pw-post-body-paragraph lj lk it ll b lm ln kd lo lp lq kg lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><strong class="ll jd"> <em class="mk">é“¾æ¥ç¬¬ä¸‰éƒ¨åˆ†â€” </em> </strong> <a class="ae mr" rel="noopener" target="_blank" href="/predicting-crashes-in-gold-prices-using-machine-learning-5769f548496"> <strong class="ll jd"> <em class="mk">é¢„æµ‹é‡‘ä»·æš´è·Œ</em> </strong> </a></p><p id="d209" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd"> <em class="mk">é“¾æ¥åˆ°</em> </strong> <a class="ae mr" href="https://github.com/Riazone/Gold-Return-Prediction" rel="noopener ugc nofollow" target="_blank"> <strong class="ll jd"> <em class="mk"> Githubèµ„æºåº“</em> </strong> </a></p><p id="2971" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd"> <em class="mk">å…³æ³¨æˆ‘ä¸Š</em></strong><a class="ae mr" href="https://www.linkedin.com/in/riazuddin-mohammad/" rel="noopener ugc nofollow" target="_blank"><strong class="ll jd"><em class="mk">LinkedIn</em></strong></a></p><p id="9604" class="pw-post-body-paragraph lj lk it ll b lm mf kd lo lp mg kg lr ls mh lu lv lw mi ly lz ma mj mc md me im bi translated"><strong class="ll jd"> <em class="mk">æŒ‡å—</em></strong><a class="ae mr" href="https://pycaret.org/guide/" rel="noopener ugc nofollow" target="_blank"><strong class="ll jd"><em class="mk">py caret</em></strong></a></p></div></div>    
</body>
</html>