<html>
<head>
<title>House Price Prediction in Natural Hazard Prone Areas - Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自然灾害多发地区的房价预测(二)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/house-price-prediction-in-natural-hazard-prone-areas-part-2-b73ef366a229?source=collection_archive---------53-----------------------#2020-05-23">https://towardsdatascience.com/house-price-prediction-in-natural-hazard-prone-areas-part-2-b73ef366a229?source=collection_archive---------53-----------------------#2020-05-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1f52" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">第2部分:机器学习模型</h2></div><h1 id="8844" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="14a1" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi lw translated">使用了不同的回归模型，即线性回归、决策树回归、梯度推进回归和随机森林回归。使用R对这些模型的性能进行了比较。基于这些性能得分，提出了性能更好的模型来预测房价。</p><p id="7f77" class="pw-post-body-paragraph la lb it lc b ld mf ju lf lg mg jx li lj mh ll lm ln mi lp lq lr mj lt lu lv im bi translated">首先，数据分为自变量X和因变量y。自变量X用于预测目标变量y。价格、id和日期列从new_df数据帧中删除以创建变量X。new _ df数据帧中的价格列用于创建变量y。不同的指标用于回归模型的性能，如均方误差、均方根误差、R平方得分、平均绝对偏差、平均绝对百分比误差等。均方根误差和R平方分数用于评估回归模型的性能。为了保存模型的度量，创建了一个数据框，并将其命名为metrics。接下来，数据被分成训练集和测试集。80%的随机选择数据作为训练集，20%的随机选择数据作为测试集。该模型使用80%的数据进行学习，其余20%的测试数据用作未知的未来数据集来预测房价。</p><p id="7eb1" class="pw-post-body-paragraph la lb it lc b ld mf ju lf lg mg jx li lj mh ll lm ln mi lp lq lr mj lt lu lv im bi translated">使用默认参数构建线性回归模型，并使用训练数据集拟合该模型。X_test数据用于使用模型进行预测。然后，计算均方误差(MSE)、均方根误差(RMSE)、R平方得分(r2_score)、平均绝对偏差(MAD)和平均绝对百分比误差(MAPE)。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/87593d819e86d675a99cb16f5d6717cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*-A6Zmv48NOAsH0Tfz87HZw.png"/></div></figure><h1 id="f3aa" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">特征选择</h1><p id="5ff6" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">采用特征选择的向后淘汰法。特征选择是选择可以提高模型性能的相关特征子集的过程。首先，要素中最差的属性被移除。date_sold_month被删除，因为它与房价的相关性非常弱。然后，year _ built _ decade _ mapped从功能集中删除。然后，尝试了来自sklearn库的名为<em class="ms">选择测试</em>的单变量特征选择包。以下是不同特征的相关系数。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/eb2927d127452534274a65f151e7cbbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*CbVPKZtvTqBu-UCWcaT97w.png"/></div></figure><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mu"><img src="../Images/acff3c63aae30d71608705296efff29d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dwwiFFunBSxGDQVl"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">使用R2评分比较特征选择与线性回归模型</p></figure><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mu"><img src="../Images/ecac2dc58105016f30de4352974f6614.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RMbmpwJTT2m82Trk"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">使用MAPE评分比较特征选择与线性回归模型</p></figure><p id="bfb4" class="pw-post-body-paragraph la lb it lc b ld mf ju lf lg mg jx li lj mh ll lm ln mi lp lq lr mj lt lu lv im bi translated">比较所有不同的线性回归模型与特征选择，两个条形图表明，我们应该保留所有的特征，以更好地预测房价。</p><h2 id="90fa" class="nd kj it bd kk ne nf dn ko ng nh dp ks lj ni nj ku ln nk nl kw lr nm nn ky no bi translated">决策树回归</h2><p id="e5b8" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">使用默认参数构建决策树回归模型，并在下面列出性能得分。示例决策树回归流程图如下所示:</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div class="gh gi np"><img src="../Images/52fdadf3876e3b50b201de48cf9397e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*uLltW3TRxIWnbYFUsN7z7Q.png"/></div></figure><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nq"><img src="../Images/dbe62132d67ec55f55cfbbe3784f8051.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BpwEJHfGrPgpx_Av"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">决策树图表示例</p></figure><h2 id="a63c" class="nd kj it bd kk ne nf dn ko ng nh dp ks lj ni nj ku ln nk nl kw lr nm nn ky no bi translated">梯度推进回归</h2><p id="c8f7" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">使用默认参数建立梯度回归模型，并在下面列出性能得分:</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div class="gh gi np"><img src="../Images/09388dad616975e7e37ff82b13639b59.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*ne5yCYXUcEB8ekdI6uMZEw.png"/></div></figure><h2 id="5c2b" class="nd kj it bd kk ne nf dn ko ng nh dp ks lj ni nj ku ln nk nl kw lr nm nn ky no bi translated">随机森林回归</h2><p id="cd29" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">使用默认参数构建随机森林回归模型，并在下面列出性能得分:</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/ee4dcb8c05ea249e7c8b6bc0e019e9ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*PlFh1svJ-3vM53yuVg6WpA.png"/></div></figure><p id="c572" class="pw-post-body-paragraph la lb it lc b ld mf ju lf lg mg jx li lj mh ll lm ln mi lp lq lr mj lt lu lv im bi translated">如下所示的水平条形图比较不同回归量的r2_score和MAPE。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi ns"><img src="../Images/26e67a259cb7b8763051eccadb83d5a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*W7To_--zCfSeoIRC"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">使用r2得分比较不同回归模型的模型性能</p></figure><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi ns"><img src="../Images/12302a833e6eeeeb97679bebef0fd6c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rwT6Ppn4CTf-Kv7r"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">使用MAPE评分比较不同回归模型的模型性能</p></figure><p id="126b" class="pw-post-body-paragraph la lb it lc b ld mf ju lf lg mg jx li lj mh ll lm ln mi lp lq lr mj lt lu lv im bi translated">根据r2_score，梯度推进回归模型是表现最好的模型。对于该数据集，随机森林回归模型是性能第二好的模型。</p><p id="dc30" class="pw-post-body-paragraph la lb it lc b ld mf ju lf lg mg jx li lj mh ll lm ln mi lp lq lr mj lt lu lv im bi translated">根据平均绝对百分误差(MAPE)，随机森林回归模型是表现较好的模型。梯度推进回归模型是表现第二好的模型。</p><h2 id="b3d9" class="nd kj it bd kk ne nf dn ko ng nh dp ks lj ni nj ku ln nk nl kw lr nm nn ky no bi translated">超参数调谐</h2><p id="fe51" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">接下来，使用GridSearchCV调整模型的超参数，以提高模型的性能。GridSearchCV是一种交叉验证方法，它允许我们使用一组我们想要在给定模型中尝试的参数。这些参数中的每一个都被用于执行交叉验证，并且最终保存模型的最佳参数。创建了一个新的dataframe，并将其命名为tuned_metrics，以保存优化模型的指标。的方法。get_params()用于查找模型的所有参数。对于线性回归模型，在param_grid中使用了“copy_X”、“fit_intercept”和“normalize”参数。param_grid是一个字典，参数名作为键，参数设置列表作为值。使用cv = 5，这是使用的折叠次数。我们可以使用GridSearchCV的best_params_ attribute来获得这个数据集的任何回归模型的最佳参数。使用GridSearchCV调整线性回归模型和决策树回归器模型。然后，使用RandomizedSearchCV调整梯度推进回归模型和随机森林回归模型。RandomizedSearchCV有助于最大限度地减少计算时间，因为GridSearchCV对于梯度推进回归器和随机森林回归器都需要很长的计算时间。使用RMSE评分的不同回归模型的优化模型性能比较如下所示:</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi ns"><img src="../Images/7f4d4f8717e900db22026413282135aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eihH4FQZZ8zYSrlf"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">使用RMSE评分比较不同回归模型的优化模型性能</p></figure><p id="103c" class="pw-post-body-paragraph la lb it lc b ld mf ju lf lg mg jx li lj mh ll lm ln mi lp lq lr mj lt lu lv im bi translated">根据均方根误差，梯度推进回归模型是表现最好的模型，误差最小，为147773。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi ns"><img src="../Images/8a0f3d7fa6d080310580574279ebe6de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OXHGRSh_-dXHM7AO"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">使用R2评分比较不同回归模型的优化模型性能</p></figure><p id="b7c2" class="pw-post-body-paragraph la lb it lc b ld mf ju lf lg mg jx li lj mh ll lm ln mi lp lq lr mj lt lu lv im bi translated">根据r2_score，梯度推进回归模型是表现最好的模型，得分最高，为0.78。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi ns"><img src="../Images/c296c9adf485a74c455b33c210be5bbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1gpqBXo6d977wG2r"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">使用MAE评分比较不同回归模型的调优模型性能</p></figure><p id="6de8" class="pw-post-body-paragraph la lb it lc b ld mf ju lf lg mg jx li lj mh ll lm ln mi lp lq lr mj lt lu lv im bi translated">根据平均绝对误差(MAE ),梯度推进回归模型是表现最好的模型，误差最低为113737。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi ns"><img src="../Images/c4f9ffb1610395fd802671241517ef97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*00U8N18zTaOtGq8r"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">使用MAPE评分比较不同回归模型的优化模型性能</p></figure><p id="f002" class="pw-post-body-paragraph la lb it lc b ld mf ju lf lg mg jx li lj mh ll lm ln mi lp lq lr mj lt lu lv im bi translated">根据平均绝对百分误差(MAPE)，梯度推进回归模型是表现最好的模型，最低百分误差为12%。所有指标都表明，梯度推进回归模型是该数据集的性能更好的模型。</p><h1 id="ac02" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">摘要</h1><p id="7f44" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">梯度推进回归模型是一个很好的房价预测模型，因为它优于随机猜测，并且优于其他三个回归模型。随着更多数据的收集，该模型将来可能会得到改进。这里没有包括的许多其他回归模型也可以建立和尝试。对于未来的工作，我会推荐这个梯度推进回归模型来预测房价。</p><h2 id="c3e5" class="nd kj it bd kk ne nf dn ko ng nh dp ks lj ni nj ku ln nk nl kw lr nm nn ky no bi translated">代码:</h2><p id="ff47" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><a class="ae nt" href="https://nbviewer.jupyter.org/github/umaraju18/CapStone-Project/blob/master/sanjose_machine_learning_model.ipynb" rel="noopener ugc nofollow" target="_blank">用于机器学习的Ipython笔记本</a></p><h2 id="3209" class="nd kj it bd kk ne nf dn ko ng nh dp ks lj ni nj ku ln nk nl kw lr nm nn ky no bi translated"><a class="ae nt" href="https://medium.com/@umacivil2003/house-price-prediction-in-natural-hazard-prone-areas-part-1-ddd2cdef386" rel="noopener">第1部分:探索性数据分析(EDA) </a></h2></div></div>    
</body>
</html>