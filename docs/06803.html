<html>
<head>
<title>Image Classification Using TensorFlow in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用Python中的张量流进行图像分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-classification-using-tensorflow-in-python-f8c978824edc?source=collection_archive---------33-----------------------#2020-05-27">https://towardsdatascience.com/image-classification-using-tensorflow-in-python-f8c978824edc?source=collection_archive---------33-----------------------#2020-05-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3ca3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">什么是图像分类，如何使用Python中的TensorFlow进行图像分类？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/14d4cd5f84ae83504a5bfa94845fdf1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MMpktZpn_RFWLL_i.jpg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://pixabay.com/illustrations/artificial-intelligence-brain-think-3382507/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="e0d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">简介</strong></p><p id="5c6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<a class="ae ky" rel="noopener" target="_blank" href="/deep-learning-with-tensorflow-5d3a7a8c55cd">之前的帖子</a>中，我们看到了如何在一个简单的数据集上使用TensorFlow。在这个例子中，我们将使用TensorFlow进行图像分类。我们将要使用的数据集是MNIST数据集，它是张量流数据集的一部分。</p><p id="3a5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">什么是图像分类？</strong></p><p id="5f88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图像分类是指计算机视觉中可以根据图像的视觉内容对图像进行分类的过程。例如，图像分类算法可以被设计成辨别图像是否包含人形。</p><p id="7c41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">导入库</strong></p><p id="0a44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们需要导入所需的库。在本例中，我们需要:</p><ul class=""><li id="5e6a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">Numpy</strong>—Python编程语言的库，增加了对大型多维数组和矩阵的支持，以及对这些数组进行操作的大量高级数学函数。</li><li id="d226" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> TensorFlow </strong> —一个免费的开源软件库，用于数据流和跨一系列任务的差异化编程。</li><li id="072d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> TensorFlow数据集— </strong>一组随时可用的数据集，使用TensorFlow或其他Python ML框架。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/b8c3943070b9b99547692df01110baa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/0*3f9jA6w2X-9iXnY-.png"/></div></figure><p id="a550" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">加载和解包数据</strong></p><p id="e380" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们需要加载数据。MNIST数据库由具有手写数字的28×28大小的图像组成。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/2e7ac0e45fe46aa990710cf94e7bf2f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5nY8UsXGm_Vymgiy.png"/></div></div></figure><p id="0f16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，我们需要解开数据——我们这样做是因为我们需要培训、验证和测试集。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/dc3317f32ace1949b300ad4e45c759e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IokKQT_nahu8PIuk.png"/></div></div></figure><p id="997a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">缩放图像</strong></p><p id="ffdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将定义一个函数来缩放图像。我们这样做是因为RGB值(红、绿、蓝)每个都是8位。每种颜色的范围是0-255(2⁸= 256种可能性)。组合范围是256*256*256。通过除以255，0–255范围可以描述为0.0–1.0范围，其中0.0表示0 (0x00)，1.0表示255 (0xFF)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/e08c09d6c336e80da841da6b1d09e7db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/0*brT1ww2t0dscKYbm.png"/></div></figure><p id="1789" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">洗牌数据</strong></p><p id="9d0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为数据可能在一个部分中包含相同的值，所以我们需要对其进行混排。缓冲区大小是一个标量，它影响转换的随机性。它维护一个buffer_size元素的缓冲区，并从该缓冲区中随机选择下一个元素(如果下一个输入元素可用，则用下一个输入元素替换它)，而不是对整个数据集进行洗牌。洗牌后，我们需要批量数据集。批处理将数据集的n个连续元素堆栈到单个元素中的最简单形式是使用batch方法。Dataset.batch()转换正是这样做的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/6f4f5da96786b607ed8c44c23b92333a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GCMrCBPoZEjVZr-S.png"/></div></div></figure><p id="4662" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">概述模型</strong></p><p id="193e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要定义输出大小—在我们的例子中，我们期望输出从0到9，所以大小将是10。</p><p id="94f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们需要定义隐藏层的大小。隐藏层的大小应介于输入层和输出层的大小之间。在这种情况下，隐藏层大小将为50。</p><p id="9e40" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">唯一剩下的事情就是定义模型。本例中的模型是使用keras定义的。顺序模型是层的线性堆叠。当我们定义模型时，我们需要为隐藏层和输出层选择激活函数。如果你想了解更多关于激活功能的内容，在之前的帖子里有完整的解释—<a class="ae ky" rel="noopener" target="_blank" href="/deep-learning-with-tensorflow-5d3a7a8c55cd">https://towardsdatascience . com/deep-learning-with-tensor flow-5d 3a 7 a 8 c 55 CD</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/fdfbb56492cd812fb87999c1df0aae05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0kKcBTteJtgBvVnQ.png"/></div></div></figure><p id="ba2a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">编译模型</strong></p><p id="cd02" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这一步中，我们将为培训配置模型。Compile定义了损失函数、优化器和指标。我们需要一个编译好的模型来训练(因为训练使用了损失函数和优化器)。</p><ul class=""><li id="2654" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">优化器:优化算法或策略负责减少损失，并尽可能提供最准确的结果。在这个例子中，我们使用了一种叫做Adam的优化算法。Adam是一种优化算法，可以用来代替经典的随机梯度下降过程，根据训练数据迭代地更新网络权重。</li><li id="9aca" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">损失</strong>:这是一种评估特定算法对给定数据的建模程度的方法。如果预测与实际结果相差太多，损失函数就会产生一个非常大的数字。分类交叉熵和稀疏分类交叉熵具有相同的损失函数，唯一的区别是，当输入是一次热编码时，我们使用分类交叉熵，当输入是整数时，我们使用稀疏分类交叉熵。</li><li id="c700" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">指标</strong>:指标是用来判断模型性能的函数。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/108bd81aa187ad06415ddcf6445ae3c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IszKA4BIIUNYx3IY.png"/></div></div></figure><p id="cfb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">训练模型</strong></p><p id="e992" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们拟合模型时，我们实际上是在为固定数量的历元(数据集上的迭代)训练模型。我们需要定义批量大小、最大时期和提前停止。</p><ul class=""><li id="d297" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">批量</strong> —一次正向/反向传递中训练样本的数量</li><li id="18be" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">时期数</strong> —训练模型的时期数。一个历元是对所提供的整个x和y数据的迭代。</li><li id="bf87" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">提前停止</strong> —当监测的数量停止提高时，停止训练。耐心是一个数字，它定义了产生无改善的监控量的时期数，在此之后训练将停止。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/e48ce5c36fb169430f33713ebea2893d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/0*GkXL7FPA_ctKbjYU.png"/></div></figure><p id="abc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">结果</strong></p><p id="64df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过epoch监控训练过程。使用训练和验证集，每个历元给我们提供关于准确性和损失的信息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/040d9266ae1341b4a67059a9ac622e79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5O0JJIH3B0QPt4s9.png"/></div></div></figure><p id="0229" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">评估模型</strong></p><p id="96d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该函数返回测试集上模型的损失值和度量值。在这个函数中，输入数据将是我们的测试集。我们可以打印测试损失和测试准确度——在这个例子中，我们的准确度接近97%。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/6c9c364d669a1fcff9ba51cf40f51fb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/0*jtiy0KIyZXI9LwdR.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/9645be2cb3a1fffae44682470fd8af47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/0*xblU_Zr3_-d1Y4I_.png"/></div></figure><p id="b1ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">结论</strong></p><p id="b9db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这只是图像分类的一个简单例子。我们可以对图像进行许多更复杂的修改。例如，我们可以对图像应用各种过滤器，这些过滤器使用数学算法来修改图像。有些过滤器非常容易使用，而有些则需要大量的技术知识。</p><p id="81fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你对这个话题感兴趣，请随时联系我。</p><p id="e21f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">领英简介:<a class="ae ky" href="https://www.linkedin.com/in/ceftimoska/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/ceftimoska/</a></p><p id="7908" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">博文原文可从以下链接获得:<a class="ae ky" href="https://interworks.com.mk/image-classification-using-tensorflow-in-python/" rel="noopener ugc nofollow" target="_blank">https://interworks . com . MK/image-class ification-using-tensor flow-in-python/</a></p><p id="c8cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另外，你可以在下面的链接中找到另一篇类似的博文:<a class="ae ky" href="https://interworks.com.mk/focusareas/data-management/" rel="noopener ugc nofollow" target="_blank">https://interworks.com.mk/focusareas/data-management/</a></p></div></div>    
</body>
</html>