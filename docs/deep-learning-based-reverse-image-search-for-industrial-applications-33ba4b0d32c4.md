# 面向工业应用的基于深度学习的逆向图像搜索

> 原文：<https://towardsdatascience.com/deep-learning-based-reverse-image-search-for-industrial-applications-33ba4b0d32c4?source=collection_archive---------19----------------------->

## [理解大数据](https://towardsdatascience.com/tagged/making-sense-of-big-data)

## 从非结构化数据到基于内容的图像检索

有没有想过[谷歌反向图片搜索](https://en.wikipedia.org/wiki/Google_Images#Search_by_Image_feature)是如何工作的，它接收一张图片，并在几分之一秒内返回给你最相似的图片？

对于人类来说，评估图像的内容相当简单，确定图像中是否包含汽车、猫或房子并不需要太多努力。然而，想象你有一个包含 100，000 张(或更多)图片的数据库，没有任何[元数据](https://en.wikipedia.org/wiki/Metadata)或结构。在缺乏任何关于图像内容的相关元数据的情况下，您如何能够提取任何有用的信息而不必手动滚动所有图像呢？幸运的是，来自经典[计算机视觉](https://en.wikipedia.org/wiki/Computer_vision)和深度学习[的最新发展](https://en.wikipedia.org/wiki/Deep_learning)的技术来拯救我们。

基于内容的图像检索中的一个重要应用是所谓的“反向图像搜索”。这是计算机视觉技术在图像检索问题上的应用，即在大型数据库中搜索图像的问题。“基于内容”意味着搜索分析图像的*内容*，而不是元数据，例如与图像相关的关键字、标签或描述。

拥有一个没有可用元数据的大型图像数据库不是一个理想的起点，但不幸的是，这实际上是一个非常常见的场景。幸运的是，我们可以利用许多与前面提到的 Google 的“反向图像搜索”相同的技术来构建我们自己的自定义图像匹配应用程序。

# 深度学习和图像分类

你以前可能见过的例子可以是典型的“猫与狗”分类模型，在大量的博客和在线教程中讨论过。然而，这些例子中的大多数都是基于对大量带标签的图像的访问，在这些图像中，您拥有可用于训练您的模型的“基本事实”信息。在我们的情况下，这不是我们真正想要的，因为我们没有任何这样的信息。幸运的是，我们仍然可以利用在其他数据集上训练的公开可用的深度学习模型。

访问已经在大量数据上训练过的模型(例如，流行的 [ImagNet 数据集](http://www.image-net.org/)，包含数百万张带注释的图像)，是构建最先进的深度学习应用程序变得更加容易的原因之一。使用这种预先训练的模型作为基础，人们通常可以成功地利用[迁移学习](https://en.wikipedia.org/wiki/Transfer_learning)技术来使模型适应我们的特定需求，即使只有非常有限的数据量(或者根本没有数据)。

在我们的例子中，当谈到理解非结构化图像的数据库时，我们实际上可以获得许多有价值的见解，而根本不需要任何标记的训练图像。这是因为这些深度学习模型实际上是如何基于自动提取图像的相关“特征”来分析图像内容的。

在一大组标记图像上训练的深度学习模型基本上已经成为自动“特征提取器”。这意味着当分析我们的图像时，我们基本上得到一个包含图像内容相关信息的“特征向量”作为输出。即使我们没有训练我们的模型来将这个输出分类到一组不同的类别/类中，我们仍然可以提取许多有价值的信息。

## 神经网络作为特征提取器

*   神经网络图像分类器通过将图像(高维像素空间中的点)转换为低维“特征向量”来工作，低维“特征向量”表示网络学习的特有“特征”(如下图所示)
*   然后，我们可以采用一个经过训练的神经网络，删除其最初用于分类对象的最后一个高级层，并使用解剖模型将我们的图像转换为特征向量。

![](img/44d022e539155f5b67334757084bdebf.png)

从图像到特征提取。卷积图层中的过滤器在网络的不同级别查找的要素示例。网络越深入(层次越高)，特征就越复杂。资料来源:泽勒，马修 d。和罗布弗格斯。"可视化和理解卷积网络."计算机视觉-ECCV 2014。斯普林格国际出版公司，2014 年。818–833

图像的这种特征向量表示仍然包含一些“噪声”和冗余信息。为了过滤掉最重要的信息(同时加快图像检索和分析过程)，我们基于[主成分分析](https://en.wikipedia.org/wiki/Principal_component_analysis)进一步压缩数据。为此，我们在这里将特征向量从 2048 维压缩到 256 维。(请注意，维度取决于您选择神经网络作为特征提取器)。

![](img/75fb659e45e92945b7f77cf3e9d361ed.png)

从输入图像到压缩特征向量

## 相似性度量:余弦相似性

将图像转换成特征向量后，我们需要某种相似性度量来比较它们。一个这样的候选，并且在这个例子中使用的，是“[余弦相似度](https://en.wikipedia.org/wiki/Cosine_similarity)”。本质上，这度量了高维特征空间中图像之间的“角度”。这在下面针对二维特征空间的非常简化的版本中示出，比较输入图像和图像“A”/“B”之间的余弦相似性。我们在这里看到“A”包含与输入图像相似的对象(因此它们之间的“角度”更小)，而“B”包含不同外观的对象(相应地具有更大的角度)。

![](img/8ae7ca0d3279e6d5fb7f2947993985a5.png)

余弦相似性作为比较特征向量的度量

## 图像聚类

通过我们的“特征提取模型”处理数据库中的图像，我们可以将所有图像转换为特征向量表示。这意味着我们现在有了图像内容的定量描述。有了这些信息，我们可以例如将这些向量通过聚类算法，该算法将基于图像的内容将图像分配到各个聚类。在这样做的时候，我们仍然不知道各个图像包含什么，但是我们知道各个群中的图像通常包含相似的对象/内容。

![](img/516e978678242b0eb368ffe06b48a1ed.png)

从特征向量到聚类。图片来源:使用 t-SNE 可视化数据，Laurens van der Maaten 和 Geoffrey Hinton 的研究论文

这种技术的一个应用可以是，例如，作为为监督图像分类模型定义训练集的初步步骤。通过对所有图像进行聚类，并检查每个聚类中的一些图像，我们可以为该聚类中的所有图像分配一个标签。在这样做的时候，我们已经有效地标记了我们所有的图像，仅仅通过查看来自每个集群的几个例子。与手动滚动和注释 100，000 幅图像相比，这显然是一个进步。也就是说，自动给每个聚类中的所有图像分配相同的标签可能会导致一些错误的标签。尽管如此，它仍然是更详细分析的良好起点。

# 面向工业应用的反向图像搜索

另一个关键应用是“反向图像搜索”，这是本文的主题。假设我们想要分析一个“目标图像”，然后在我们的数据库中搜索相似的内容。例如，这可以是来自制造/生产工厂中的先前维护工作或检查的图像数据库。然后，我们可能会对寻找类似物体的图像感兴趣，或者可能会对特定设备的所有历史检查图像感兴趣。

然后，我们可以做的是，首先通过我们的“特征提取器模型”处理我们的目标图像，将其转换为特征向量表示。完成这些后，我们可以在特征向量数据库中进行相似性搜索。

## 匹配图像:循序渐进

*   准备图像数据库:使用我们的神经网络模型将图像数据库转换为特征向量表示，然后进行主成分变换。
*   分析新的目标图像:使用与上述相同的流水线将图像转换成低维特征向量。
*   查找匹配图像:使用余弦相似度计算特征向量之间的相似度。使用相似性度量来匹配数据库中与目标图像最相似的图像。

![](img/eb1bf6f2d4f9855ca5dabd70fba97911.png)

从输入图像到最佳匹配识别

## 总结:

理想情况下，图像数据库当然应该已经构建了必要的元数据，以便首先执行这样的搜索。然而，实际上有许多现实世界的例子并非如此。幸运的是，正如上面的例子所说明的，所有的希望都没有破灭。即使从杂乱和非结构化的数据中，人们仍然可以提取有价值的见解。

本文并不打算从技术上深入研究在实践中实现这种解决方案的复杂性，但是我希望它至少能让您对这些技术能够提供的功能和可能性有一个基本的了解。

我认为，重要的是要强调，深度学习不仅适用于可以访问大量高质量标签数据的公司。如上例所示，即使根本没有标记数据，您仍然可以利用底层技术从数据中提取有价值的见解。

如果你有兴趣了解更多与人工智能/机器学习和数据科学相关的主题，你也可以看看我写的其他一些文章。你会发现它们都列在我的中型作者简介中，你可以在这里找到。

而且，如果你想成为一个媒体会员，免费访问平台上的所有资料，你也可以使用下面我的推荐链接。(注意:如果您使用此链接注册，我也会收到一部分会员费)

[](https://medium.com/@vflovik/membership) [## 通过我的推荐链接加入媒体- Vegard Flovik

### 作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…

medium.com](https://medium.com/@vflovik/membership) 

# 更多来自 Vegard Flovik 媒体:

1.  蒙特卡洛方法简介
2.  [图论入门](https://builtin.com/machine-learning/graph-theory)
3.  [用于图像分类的深度迁移学习](/deep-transfer-learning-for-image-classification-f3c7e0ec1a14)
4.  [建造一个能读懂你思想的人工智能](/building-an-ai-that-can-read-your-mind-8b22ad5a7f05)
5.  [人工智能和大数据的隐藏风险](https://medium.com/me/stats/post/3332d77dfa6)
6.  [如何使用机器学习进行异常检测和状态监控](/how-to-use-machine-learning-for-anomaly-detection-and-condition-monitoring-6742f82900d7)
7.  [如何(不)使用机器学习进行时间序列预测:避免陷阱](/how-not-to-use-machine-learning-for-time-series-forecasting-avoiding-the-pitfalls-19f9d7adf424)
8.  [如何利用机器学习进行生产优化:利用数据提高绩效](/machine-learning-for-production-optimization-e460a0b82237)
9.  [如何给 AI 系统教物理？](/how-do-you-combine-machine-learning-and-physics-based-modeling-3a3545d58ab9)
10.  [我们能否利用纳米级磁铁构建人工大脑网络？](https://medium.com/predict/can-we-build-an-artificial-brain-network-using-nanoscale-magnets-1c0a925973ab)
11.  [供应链管理中的人工智能:利用数据推动运营绩效](/artificial-intelligence-in-supply-chain-management-predictive-analytics-for-demand-forecasting-80d2d512f155)

我还在下面的研讨会演示中讨论了与 AI/机器学习相关的各种主题:“从炒作到现实世界的应用”。我希望这些资源对您有所帮助！当然，欢迎在下面的评论中提出任何反馈和意见。