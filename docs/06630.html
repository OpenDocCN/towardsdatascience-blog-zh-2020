<html>
<head>
<title>3 Easy Tricks to Get Started with Python (and Ditch Excel!)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python入门的3个简单技巧(放弃Excel！)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/get-started-with-python-and-ditch-excel-85e7f67318b?source=collection_archive---------29-----------------------#2020-05-25">https://towardsdatascience.com/get-started-with-python-and-ditch-excel-85e7f67318b?source=collection_archive---------29-----------------------#2020-05-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="58fb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">面向Excel高级用户的熊猫介绍</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9877c71dae0fac276d4c9f0705bd5549.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LoVs2XcJImXbCmvrnrHCjQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让我们学一些蟒蛇和熊猫吧！资料来源:Nik Piepenbreier</p></figure><p id="41d8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所以你已经实现了思想上的飞跃，想要学习Python——这太棒了！但是从哪里开始呢？</p><p id="77b5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我来指导您完成您已经知道如何在Excel中以及如何在Python中完成的任务！</p><p id="222b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您将使用Pandas，这是Python中的主要数据分析库。</p><p id="2eaf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您需要安装Pandas，您可以使用pip或conda:</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="c0c7" class="lz ma it lv b gy mb mc l md me">pip install pandas<br/>#or<br/>conda install pandas</span></pre><p id="8537" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Pandas将数据加载到<em class="mf">数据框</em>中，你可以把它想象成Excel表格。</p><p id="90a4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们将数据集加载到数据报中。您可以通过使用以下代码来实现这一点。我们还将使用熊猫头方法探索前五行:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用熊猫生成我们的数据框架。资料来源:Nik Piepenbreier</p></figure><p id="1bc8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了跟随Excel中的教程，文件<a class="ae mi" href="https://github.com/datagy/pivot_table_pandas/raw/master/sample_pivot.xlsx" rel="noopener ugc nofollow" target="_blank">可以在这里找到</a>。</p><p id="9f96" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Excel表格和Pandas数据框架之间有许多不同之处。让我们快速浏览一下！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mj"><img src="../Images/7b7212a632b96aecf5a0babf35c5c4fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GBRlHvfDL6DTSeCtYzliuw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">比较Excel工作表和Pandas数据框架。资料来源:Nik Piepenbreier</p></figure><p id="1c02" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好了，现在我们开始吧！</p><h1 id="4784" class="mk ma it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">过滤、排序和重新排序列</h1><p id="fbff" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">Excel是一个更加可视化的工具，可以很容易地点击一个按钮，抽象出你想要完成的功能。</p><h2 id="511a" class="lz ma it bd ml ng nh dn mp ni nj dp mt lh nk nl mv ll nm nn mx lp no np mz nq bi translated">按单列排序</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/081ce22b545d777501806e8fdfbdb540.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*ynVJmneBRTb9OQM9xtKHwg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Excel中对单个列进行排序。资料来源:Nik Piepenbreier</p></figure><p id="f2ea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，如果您想在Excel中对一列进行排序，您只需:</p><ul class=""><li id="1ecd" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">选择数据选项卡，</li><li id="d47e" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">突出显示要排序的列，然后</li><li id="7c08" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">单击从A到Z排序或从Z到A排序。</li></ul><p id="708a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了在熊猫身上做到这一点，你应该写:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫按单列排序。资料来源:Nik Piepenbreier</p></figure><h2 id="d856" class="lz ma it bd ml ng nh dn mp ni nj dp mt lh nk nl mv ll nm nn mx lp no np mz nq bi translated">按多列排序</h2><p id="7a5d" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">有时您可能希望按多列排序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/2e9aac88ecd73cb3087bdabaf3c41bae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*khIQ6Tya547G4G7NSyJCag.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Excel中按多列排序。资料来源:Nik Piepenbreier</p></figure><p id="27da" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同样，Excel使这变得很容易:</p><p id="0204" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">单击数据选项卡</p><ul class=""><li id="6391" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">点击排序</li><li id="6e60" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">输入要作为排序依据的列</li></ul><p id="23a2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于熊猫，只需在“by”参数中添加一个列表:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Pandas中按多列排序。资料来源:Nik Piepenbreier</p></figure><h2 id="d0a2" class="lz ma it bd ml ng nh dn mp ni nj dp mt lh nk nl mv ll nm nn mx lp no np mz nq bi translated">过滤列</h2><p id="1fb4" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">在Excel中筛选列是一项简单的任务！只需点击数据选项卡，然后过滤。这将在所有列标题上创建箭头。当您点击这些时，只需填写您的选择:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/1023da7664e89fd6777e5781c19f7e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*xoEVTZ1MX7GFBTzqImKMpA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Excel中筛选列。资料来源:Nik Piepenbreier</p></figure><p id="7518" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对熊猫来说，这同样简单:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Pandas中过滤一个列。资料来源:Nik Piepenbreier</p></figure><p id="d426" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最棒的是，您还可以使用比较运算符来选择10个以上的单位，或者基于多个条件进行选择:</p><ul class=""><li id="7834" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated"><strong class="la iu">比较</strong>:可以用&gt;(大于)、&lt;(小于)、==(等于)、&gt; =(大于等于)、&lt; =(小于等于)，</li><li id="d420" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated"><strong class="la iu">和【条件】条件</strong>:将每个条件用括号括起来，并用与符号(&amp;)将括号分开</li><li id="d0c7" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated"><strong class="la iu">或</strong>条件:用括号将每个条件括起来，并用竖线(|)将括号隔开</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫身上不同类型的过滤器。资料来源:Nik Piepenbreier</p></figure><h2 id="e712" class="lz ma it bd ml ng nh dn mp ni nj dp mt lh nk nl mv ll nm nn mx lp no np mz nq bi translated">重新排序列</h2><p id="609a" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">重新排序列更多的是给你自己一个视觉提示。</p><p id="a30b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要在Excel中拖动对列进行重新排序，您可以通过单击列的标题来选择该列，将鼠标悬停在旁边，直到光标变为四向箭头，然后按住SHIFT键并将该列拖动到新位置:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/5273f33d511f22c1449c5b6d1c654725.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*wZ3y7u5r5GvPWRuXj4HT9Q.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Excel中移动列。资料来源:Nik Piepenbreier</p></figure><p id="d62c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要在Pandas中完成同样的事情，您只需按照您想要的列的顺序将它们放入一对方括号中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫栏目重新排序。资料来源:Nik Piepenbreier</p></figure><h1 id="e9b9" class="mk ma it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">数据透视表(含百分比)</h1><p id="ed61" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">数据透视表是那些在Excel中把你带到下一个级别的东西之一。</p><p id="c155" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它们允许您轻松快速地汇总数据，而无需依赖复杂的公式。</p><p id="d1c3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设您想知道每个地区的总销售额，您可以:</p><ol class=""><li id="b106" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt og ny nz oa bi translated">选择数据，单击“插入”选项卡上的“数据透视表”，然后单击“确定”创建表格。</li><li id="1499" class="ns nt it la b lb ob le oc lh od ll oe lp of lt og ny nz oa bi translated">将Region拖动到“行”框中，将Sales拖动到“值”选项卡中。Excel会自动假设我们要将这些值相加。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/366a2ffebd9cf8791c4c5fb6ccd6295a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*91hExdCvrtRhpHlpumZWMw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Excel中创建数据透视表。资料来源:Nik Piepenbreier</p></figure><p id="ab42" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要在Pandas中完成同样的事情，您可以简单地使用pivot_table函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Pandas中创建数据透视表。资料来源:Nik Piepenbreier</p></figure><p id="fa12" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们稍微分解一下:</p><ul class=""><li id="aaf0" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">我们创建一个名为pivot的新变量。</li><li id="888b" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">我们使用熊猫数据透视表函数。我们的第一个论点是数据帧df。</li><li id="5902" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">索引参数是' region ',它告诉Pandas基于' Region '列创建行。</li><li id="beaf" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">我们将参数值分配给字段“Sales”，让Pandas知道我们想要计算销售列。</li><li id="063a" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">最后，我们使用agg func(' aggregation func ')参数告诉Pandas对值求和。默认值为“平均值”。</li></ul><p id="ae17" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要深入了解熊猫数据透视表的功能，请查看我在熊猫的<a class="ae mi" href="https://datagy.io/python-pivot-tables/" rel="noopener ugc nofollow" target="_blank">数据透视表上的另一篇文章。</a></p><h2 id="ace0" class="lz ma it bd ml ng nh dn mp ni nj dp mt lh nk nl mv ll nm nn mx lp no np mz nq bi translated">将数据透视表值显示为百分比</h2><p id="4a4f" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">您可能希望将值显示为列总数的百分比。同样，Excel使这变得非常容易:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/160c587cfd8d600fd0caf36a67183a0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*SNzy2g-tIZZwagYFQCNT-w.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Excel中计算数据透视表中的百分比。资料来源:Nik Piepenbreier</p></figure><ul class=""><li id="9be7" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">只需右键单击一个值，</li><li id="f5c9" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">选择将值显示为→占列总数的%</li></ul><p id="3dea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在熊猫身上也一样容易做到这一点。最简单的方法是为此创建一个新列:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">计算熊猫的数据透视表百分比。资料来源:Nik Piepenbreier</p></figure><p id="9fc0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们来看看发生了什么:</p><ul class=""><li id="d29b" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">我们通过使用pivot['% of column total']，声明了一个新列——这将为该列指定名称' % of column total '</li><li id="6ea5" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">然后，我们将行中的每个值(pivot['sales'])除以整个列的总和(pivot['sales']sum())并乘以100</li></ul><h1 id="e0c4" class="mk ma it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">创建图表</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nr"><img src="../Images/1c34d5708f40b347b105a3744fbf1481.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*7tsq14amcZywNsKMeXSV7Q.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Excel中创建图表。资料来源:Nik Piepenbreier</p></figure><p id="e033" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，如果你想创建一些图表，这在Excel和Python中都非常容易。</p><p id="ee33" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们先来看Excel。如果要将此数据透视表绘制成柱形图:</p><ul class=""><li id="22d8" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">将指针放在表格中的一个单元格上，</li><li id="e933" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">转到插入→二维柱形图</li></ul><p id="66e0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对熊猫来说，这甚至更容易。Pandas内置了Python顶级的数据可视化库功能之一。就像加法一样简单。plot(kind = 'bar ')到代码的结尾:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Pandas和Matplotlib中创建图表。资料来源:Nik Piepenbreier</p></figure><p id="5d19" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这可能看起来有点令人生畏。让我们来分解一下:</p><ul class=""><li id="03bb" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">从matplotlib导入pyplot作为plt</li><li id="e715" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">重写您之前的代码(第2-3行)</li><li id="d033" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">现在画出“销售”列，并指定一个kind =“bar”作为参数</li><li id="ace5" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">最后，使用savefig方法保存文件。</li></ul><p id="4756" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">注意</strong>:如果你使用的是Jupyter笔记本，你可以在导入你的库后，通过编写以下代码来显示图表:</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="f9ee" class="lz ma it lv b gy mb mc l md me">%matplotlib inline</span></pre><h1 id="99bf" class="mk ma it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">额外提示:正确格式化值</h1><p id="7236" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">在处理数据时，正确设置值的格式可能会有所帮助。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/3e96465a975feb4f124b8dcdeb04c1d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*mQBfk7ZexccYCH-HN4IB3A.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Excel中设置数据格式。资料来源:Nik Piepenbreier</p></figure><p id="8212" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，将货币格式化为美元(等等。)或百分比。</p><p id="ac36" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要在Excel中做到这一点，您需要:</p><ul class=""><li id="b7dc" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">选择要格式化的值，</li><li id="92fa" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">在“主页”选项卡的“号码”部分中，选择所需的类型</li></ul><p id="320a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">熊猫将这一点隐藏了一点，这可能会让新来者颇感困惑。</p><p id="db85" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">实现这一点的一个简单方法是使用apply()函数。这个函数的作用是获取一个序列，并对其应用另一个函数。应用的函数将是格式化值的函数。</p><p id="29de" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您想设置透视数据框架中销售列的格式，您可以编写:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Pandas中格式化值。资料来源:Nik Piepenbreier</p></figure><p id="037f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这可能看起来有点不全面(确实如此)，但是在如何设计数据样式方面，它确实给了您很大的灵活性。让我们仔细看看:</p><ul class=""><li id="f4e9" class="ns nt it la b lb lc le lf lh nu ll nv lp nw lt nx ny nz oa bi translated">我们定义了一个名为format()的函数，它接受一个参数(x)</li><li id="3658" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">该函数仅用于返回使用特定格式的字符串格式的格式化值。</li><li id="fe99" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">${:，. 2f}部分表示实际的格式。冒号(:)用于表示格式的开始，逗号(，)用于表示千位逗号分隔符，而. 2表示两位小数。</li><li id="29ba" class="ns nt it la b lb ob le oc lh od ll oe lp of lt nx ny nz oa bi translated">这种符号可能有点难以适应，我倾向于谷歌搜索我想要的样式，然后复制粘贴。</li></ul><p id="6e3f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">同样，如果你想保持百分比，你可以写:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">熊猫中的格式化百分比。资料来源:Nik Piepenbreier</p></figure><p id="c93a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这段代码中，我们创建了另一个名为format_percent()的函数，并执行了与上面类似的步骤。</p><p id="4ba2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">注意</strong>:列总计的“% 1”列已被修改为不将该值乘以100。这是因为格式化程序会自动完成这项工作。</p><h1 id="6a09" class="mk ma it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">在那里你可以学到更多</h1><p id="8661" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">非常感谢您阅读这篇文章！希望你觉得有用！</p><p id="cbb8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我已经写了一些文章，解释了如何用Python处理普通和高级的Excel任务，如果你想看看的话！</p><p id="57c8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你准备好投入Python和Pandas，我还写了一本电子书，提供了对Python、Pandas和Matplotlib的完整介绍，可以让你很快上手！</p><p id="fb75" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以通过<a class="ae mi" href="https://gumroad.com/l/introtopythonfordatascience" rel="noopener ugc nofollow" target="_blank">点击这个链接</a>找到它。</p><p id="9fed" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">祝您愉快！</p></div></div>    
</body>
</html>