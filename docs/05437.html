<html>
<head>
<title>Encoding Categorical Variables in Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中的分类变量编码</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/encoding-categorical-variables-in-machine-learning-5644a43c123f?source=collection_archive---------39-----------------------#2020-05-07">https://towardsdatascience.com/encoding-categorical-variables-in-machine-learning-5644a43c123f?source=collection_archive---------39-----------------------#2020-05-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="89bf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何向机器学习模型输入分类数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/33a88470aa2a0f3202cfbb2ad4cb0e96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6GYdzKAliLBDKii2iTfnvw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">尼克·希利尔在<a class="ae ky" href="https://unsplash.com/s/photos/numbers?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="bf2e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分类数据需要以特殊的方式处理，才能用作机器学习模型中的一个特征。在说这种特殊方式之前，不如先说一下什么是分类数据。</p><p id="bcf0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分类数据表示一组有限的离散值。所以分类变量从有限的几个值中取一个值。分类数据的一些例子:</p><ul class=""><li id="e28a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">汽车品牌:福特，丰田，宝马，…</li><li id="8947" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">服装尺码:小号，中号，大号，加大号，…</li><li id="a978" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">显示某种级别的类别:低、中、高</li><li id="d69c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">颜色:蓝色，红色，黄色，…</li></ul><p id="fdd9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分类数据可以根据它所代表的内容分成几组:</p><p id="1515" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">名义数据:</strong>类别并不意味着任何定量测量，数据中通常没有顺序。例如，种族、性别、语言是分类变量，但我们不能对这些变量的不同类别进行排序。</p><p id="0f86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">序数数据:</strong>与名义数据不同，类别之间是有顺序的。一个类别可以优于另一个类别，反之亦然。</p><ul class=""><li id="3e12" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">低、中、高</li><li id="a8e6" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">冷，暖，热</li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="7737" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是预处理分类数据的时候了，这样我们就可以在机器学习模型中使用它们。计算机只能处理用数字表示的信息。这就是为什么我们不能给机器学习模型类别或字符串作为输入。</p><p id="03c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们首先需要将类别转换成数字。这个过程叫做<strong class="lb iu">标签编码</strong>。有些类别已经是数字了，比如电影分级从1到5。我们不需要对这种分类变量应用标签编码步骤。</p><p id="b329" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果分类变量不是有序的(也就是说，它们没有等级顺序)，标签编码是不够的。我们需要使用“<strong class="lb iu">哑元</strong>或“<strong class="lb iu">一个热码</strong>”编码对名义分类变量进行编码。假设我们对代表汽车品牌的分类变量进行了标签编码。编码器标签“道奇”为3，“GMC”为1。如果我们只是对这个变量进行标签编码，一个模型会认为“Dodge”比“GMC”更重要或更优越，这是不正确的。优选地，将每个类别表示为仅取两个值1和0的列。对于“道奇”品牌的汽车，只有“道奇”一栏的值变成1，其他栏都是0。通过这种方式，我们可以确保类别之间没有层次结构。</p><p id="9165" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看一个例子，这样就更清楚了。我创建了一个样本数据框架:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/bad1b7ddfb03953722e68fadea0cf7ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/format:webp/1*0qpgfY320YclmNp4VJYFoA.png"/></div></figure><p id="a1b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据帧包括名义(品牌)和顺序(条件)数据。</p><p id="5130" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">标签编码</strong></p><p id="7c26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">给类别分配标签的一种方法是使用scikit-learn的<strong class="lb iu"> LabelEncoder() </strong>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/17219434f8b40b27b725a68783661d37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*vKaE5_eEoVgHuPfyKeLaSA.png"/></div></figure><p id="5cc1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，标签编码器为每个类别分配了一个编号。最好为每个类别使用单独的标签编码器，以防我们需要对列进行逆变换。然而，这种方法存在一个问题。您可能已经注意到,“条件”列中的平凡性没有保留。分配的标签有:</p><ul class=""><li id="8af0" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">好:1</li><li id="7f54" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">平均值:0</li><li id="dfa1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">差:2</li></ul><p id="5cf5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果普通性很重要，我们可以使用Pandas <strong class="lb iu"> replace </strong>函数手动标记编码这些类别:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/6cb2e768a7753288a4f5e90a527120b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:878/format:webp/1*58obSSbGxBEqtVTAh6kriA.png"/></div></figure><p id="bab2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们只需创建一个将类别映射到标签的字典，然后将这个字典作为参数传递给replace函数。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="30a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">虚拟和一个热编码</strong></p><p id="f40b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虚拟或one热编码器将每个类别转换为取值为0或1的二进制列。让我们首先应用来自scikit-learn的<strong class="lb iu"> OneHotEncoder() </strong>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/1a488c2cc417bf9fec4b3b8151cb483c.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*SAJqESaZFl2IzhiAOQp9kA.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/8f03423923af247a3decdcf8377a736e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*2CVX5pFKrKkxzveKp6R1tA.png"/></div></figure><p id="d812" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个过程非常简单。我们启动一个OneHotEncoder()对象，并使用数据应用fit_transform方法。值得一提的是<strong class="lb iu">下降</strong>参数。数据集包含品牌列中的6个类别和条件列中的3个类别。因此编码器应该总共返回9列。但是，返回的数组有7列。原因是我们要求编码器删除第一列，这是有意义的，因为我们不会因为删除一列而错过任何信息。考虑有6个类别的“品牌”栏。我们删除了第一类的列，即“奥迪”。如果其他五列中的值为0，则该行代表“奥迪”。看一下原始dataframe，看到第四行的品牌是奥迪。此外，编码功能数组中第四行的前五列都是零。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="450d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一种做这个操作的方法是使用熊猫的<strong class="lb iu"> get_dummies </strong>功能。Get_dummies函数返回一个数据帧，通过组合原始列名和类别名来分配列名。</p><p id="8069" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mv mw mx my b">pd.get_dummies(df)</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/727a9ff695dc93cd8984976d782e5c35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cg29qa_t-iOmDmchSpreuQ.png"/></div></div></figure><p id="413b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还删除了第一列:</p><p id="0b25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mv mw mx my b">pd.get_dummies(df, drop_first=True)</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/abf125c47e57b9221c5855352e395e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w9Ixx-G0G2dndwa9aEpl7g.png"/></div></div></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="05d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>