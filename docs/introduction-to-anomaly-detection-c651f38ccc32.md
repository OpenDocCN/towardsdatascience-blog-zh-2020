# 异常检测简介

> 原文：<https://towardsdatascience.com/introduction-to-anomaly-detection-c651f38ccc32?source=collection_archive---------12----------------------->

![](img/529d77633d4c7801453bc6f44891df75.png)

哈雷戴维森在 [Unsplash](https://unsplash.com/?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上的照片

你有没有想过当某人的社交媒体账户、银行账户或任何其他账户/个人资料被黑客攻击时会发生什么？一些系统如何自动检测此类活动并通知相关机构或立即暂停帐户？这主要是通过称为**异常检测**(又名**异常检测**)的过程来完成的。事实上，上述特定示例被称为欺诈检测，它是异常检测在许多领域中的一个流行应用。因此，让我们深入了解异常检测术语。

异常检测或异常值检测是识别罕见项目、观察值、模式、异常值或与正常项目或模式显著不同的异常的过程。异常有时被称为离群值、新奇值、噪音、偏差或例外。根据一些文献，存在三类异常检测技术。分别是**监督异常检测**、**非监督异常检测、**和**半监督异常检测**。

# **监督与非监督异常检测**

异常检测最常见的版本是使用无监督的方法。在那里，我们使用未标记的数据集训练一个机器学习模型来适应正常行为。在这个过程中，我们做了一个**重要的假设，即训练集中的大多数数据都是正常示例**。但是其中可以有一些异常的数据点(比例很小)。那么任何明显不同于正常行为的数据点将被标记为异常。在监督异常检测中，将使用被标记为“正常”和“异常”的数据集来训练分类器。当一个新的数据点到来时，这将是一个典型的分类应用。这两种方法各有利弊。有监督的异常检测过程需要大量的正反例。获得这样的数据集将非常困难，因为异常的例子很少。即使您获得了这样的数据集，您也只能对收集的数据集中的异常模式进行建模。然而，在任何领域都有许多不同类型的异常，而且未来的异常可能与迄今为止看到的例子完全不同。任何算法都很难从异常的例子中学习；异常点是什么样子的。这就是无监督方法流行的原因。**捕捉正常行为比捕捉许多不同类型的异常要容易得多**。

# **异常检测背后的术语**

现在让我们深入探讨无监督异常检测背后的想法。在整篇文章中，该过程将被称为异常检测，而不是无监督的异常检测。在开始讨论异常检测算法之前，有一个叫做**高斯(正态)分布**的东西，这是整个算法的基础。在统计学中，高斯或正态分布是实值随机变量的一种连续概率分布形式。使用下面的公式计算概率函数。𝝁是平均值，𝝈^2 是方差。

![](img/37cd06bc953bbc401ac6b33dc350aa6d.png)

概率分布关于其平均值是对称的，并且在整个实线上非零。正态分布有时被称为钟形曲线，因为密度图看起来像一个钟。

![](img/ee948aca8c9b85fcfcec6e9f9765de1d.png)

异常检测的基本思想是找到一个概率函数来捕捉正常行为，并发现一个概率阈值，使得远离该阈值的数据点被视为异常。考虑概率函数为 p(x ),阈值为ε，这可以描述如下。数据点用十字表示。

![](img/85f317f87993cba680a31675d1b91760.png)

在基本的异常检测算法中，我们假设每个特征根据其自身的高斯分布分布，具有一些均值和方差。因此，使用训练数据集，我们针对特征 x1，x2，…，xn 拟合一组参数𝝁1，𝝁2，…，𝝁n 和𝝈1^2，𝝈2^2，…，𝝈n^2。然后概率函数 p(x)被计算为 x1 的概率乘以 x2 的概率乘以 x3 的概率，以此类推直到 xn 的概率。这就是异常检测的机器学习模型。当一个新的数据点进来时，我们简单地计算概率 p(x ),如果概率小于ε，就将其标记为异常。找到ε的正确值是一个优化目标，我不打算在本文中解释。

![](img/379b5c865432a52758f822eef6f09277.png)

# **关于异常检测的更多信息**

一个重要的事实是选择一组指示异常的特征。也就是选择一组特征，其中这些特征在出现异常时可能呈现异常大或异常小的值。另一方面，可能会有一些缺点，因为我们必须手动创建特征。此外，该算法只能检测少数异常情况。例如，当数据分布如下时，我们如何检测异常。

![](img/15d15b5c21ad77cb09e5c8199d980e88.png)

如您所见，使用高斯分布的早期模型将一些正常数据点标记为异常，将一些异常示例标记为正常数据点(上图中的蓝色边界)。事实上，我们需要为这种数据分布设置一个高级的边界(也许是紫色的边界)。使用**多元高斯分布**解决了这个特殊问题。在这里，不是将每个要素建模为各自的高斯分布并乘以概率，而是将所有要素建模为一个称为多元高斯分布的公共分布。

# **流行技法**

今天，当实现异常检测算法时，您不必担心上述细节。像 scikit-learn(python)这样的流行库提供了更简单的方法来实现异常检测算法。下面是一些用于异常检测的流行技术。

*   基于密度的技术(KNN、局部异常因子、隔离森林等)
*   基于聚类分析的技术(KMeans、DBSCAN 等)
*   贝叶斯网络
*   神经网络、自动编码器、LSTM 网络
*   支持向量机
*   隐马尔可夫模型
*   基于模糊逻辑的异常检测

# 一些应用

*   欺诈检测(例如:网络、制造、信用卡欺诈等)
*   入侵检测
*   探伤
*   系统健康监控
*   检测生态系统干扰
*   产品质量异常检测

# **结论**

异常检测是一种发现罕见项目或数据点的技术，这些项目或数据点将与其余数据显著不同。尽管异常检测背后的术语使用了概率论和一些统计学，但有许多技术可以轻松实现异常检测算法。