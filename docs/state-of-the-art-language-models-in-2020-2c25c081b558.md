# 2020 年最先进的语言模型

> 原文：<https://towardsdatascience.com/state-of-the-art-language-models-in-2020-2c25c081b558?source=collection_archive---------40----------------------->

## 突出显示最常见的 NLP 任务的模型。

![](img/388e861ddbb0e351b66ea573546bcb58.png)

自然语言处理(NLP)中有许多任务，[语言建模](https://nlpprogress.com/english/language_modeling.html)，[机器翻译](https://nlpprogress.com/english/machine_translation.html)，[自然语言推理](https://nlpprogress.com/english/natural_language_inference.html)，[问题回答](https://nlpprogress.com/english/question_answering.html)，[情感分析](https://nlpprogress.com/english/sentiment_analysis.html)，[文本分类](https://nlpprogress.com/english/text_classification.html)，[更多的](https://nlpprogress.com/) …由于不同的模型在不同的领域有所侧重和擅长，本文将重点介绍最常见的 NLP 任务的最新模型。

# 变压器

自从 [Transformer](/illustrated-guide-to-transformer-cf6969ffa067?source=friends_link&sk=82b8c207682ac8ffeb01a3af44822192) 推出以来，它的变体已经应用于许多(如果不是全部)NLP 任务，实现了最先进的性能。在引入变压器之前，RNN 模型已经是用于序列建模和转导问题的最先进的结构。然而，鉴于 RNN 计算的顺序性质，训练期间的并行化主要受到限制，导致训练效率较低。作者提出了一种编码器-解码器结构，完全依赖于注意机制，而不使用递归结构。

变换器的编码器由 6 层组成，每层由一个多头自注意机制组成，后面是一个前馈网络。在每个子层之前和之后，添加剩余连接和 add & norm 层。解码器具有相同数量的 6 层。然而，在自关注层和前馈层之间插入了一个编码器-解码器关注层。注意遮罩用于隐藏后续位置的标记。

所使用的注意机制被称为缩放的点积注意，它通过来标准化逻辑，以防止由于 softmax 的小梯度而导致的缓慢收敛。此外，本文还提出了多头注意的概念，使得该模型能够关注来自不同表征子空间的信息。在最终分类层之前，来自所有子空间的隐藏状态然后被连接和投影。

在编码器自我关注层中，所有的键、值和查询都来自前一层，允许编码器关注前一层的所有位置。然而，由于注意屏蔽，解码器自我注意只注意到领先位置。另一方面，为了引起编码器-解码器的注意，从先前的解码器层提取查询，而键和值来自编码器隐藏状态。这允许解码器关注编码序列中的所有位置，这在序列到序列任务中是至关重要的。

为了注入相对或绝对的位置信息，位置编码被添加到输入嵌入中。理论上可以是学来的，也可以是固定的；然而，采用正弦位置编码是为了更容易学习和外推至更长的序列。

[](/illustrated-guide-to-transformer-cf6969ffa067) [## 变压器图解指南

### 逐个组件的细分分析

towardsdatascience.com](/illustrated-guide-to-transformer-cf6969ffa067) 

# 双向编码器表示转换器

语言模型传统上是单向的，在训练过程中只有先前时间步的单词是可见的。这是为了确保预测的单词不会间接“看到自己”然而，在许多句子级或标记级任务中，前向和后向上下文对于最佳性能都是必不可少的。

2018 年推出了双向编码器表示变压器( [BERT](https://arxiv.org/abs/1810.04805) )。它在转换器结构中利用屏蔽语言建模来促进双向表示训练。每个输入序列都以一个特殊的*【CLS】*标记开始，其隐藏状态用于表示分类任务。对于句子对输入，添加了*【SEP】*标记来指示单个句子之间的边界。每个标记的初始嵌入与片段嵌入和位置嵌入相加，作为变换器的输入。

BERT 模型包括两项预训练任务:

1.  **屏蔽语言模型**。在预训练期间，随机选择所有标记中的 15%作为标记预测的屏蔽标记。然而，由于在微调期间不存在*【MASK】*标记，这导致预训练和微调之间的不匹配。因此，在所有选择要屏蔽的令牌中，只有 80%被替换为*【屏蔽】*令牌。10%的时间令牌将保持不变，10%的时间由随机令牌替换。作者进行了烧蚀研究，以表明这样的置换率会产生最佳的下游性能。值得注意的是，通过*【掩码】*的完全替换或通过随机令牌的完全替换导致次优性能。
2.  **下一句预测**。对两个句子之间的关系进行建模至关重要，尤其是对于问答或自然语言推理等下游任务。因此，作者提出了下一个句子预测任务来分类一个句子是否是另一个句子的尾随句。当选择句子 1 和 2 进行句子对输入时，50%的情况下，句子 2 是跟在 1 后面的实际句子。另外 50%的时间，随机选择一个句子，作为反面样本。这个简单的任务导致了问答和自然语言推理任务的显著改善。

在预训练之后，通过简单地替换适当的输入-输出对，该模型在各种下游任务上被微调。对于标记级任务，例如序列标记或问题回答，每个标记的隐藏状态被提供给输出层。另一方面，*【CLS】*隐藏状态用于句子级别的任务，例如蕴涵和情感分析。

研究人员进一步[探索专门针对文本分类的 BERT 微调](https://arxiv.org/abs/1905.05583)，由三部分组成:

1.  使用任务内或领域内的训练数据来进一步预训练 BERT
2.  使用多任务学习进行微调(可选，如果相关任务可用)
3.  针对目标任务微调 BERT

实现的方法包括长文本预处理、层的选择、层特定的学习速率调整、遗忘和少量学习。

# XLNet

前述基于变换器的模型利用自动编码(AE)公式，而不是传统的自回归(AR)语言建模。由于 AE 模型不像 AR 模型那样分解正向产品中的概率，因此它们可以利用两个方向的上下文。因此，缩小了语言建模和实际下游任务之间的差距，后者通常需要双向信息。然而，由于真实数据中缺少*【MASK】*记号，这导致了预训练和微调之间的差异。此外，BERT 假设预测的记号是彼此独立的，这是过于简化的。

鉴于 AR 和 AE 语言模型的优缺点，XLNet[被提出来利用它们的优点，同时最小化它们的局限性。与 AR 模型中使用固定的向前或向后因子分解不同，作者建议最大化因子分解顺序中每个可能排列的可能性。](https://arxiv.org/abs/1906.08237)

因为相同的参数集用于所有排列，所以模型将总是能够访问全局环境。因此，它通过提取双向信息超越了传统的 AR 模型。此外，由于没有从损坏的数据重建，它避免了训练前微调差异的问题，以及独立性假设。值得注意的是，应用位置编码是为了保持原始序列顺序。置换只能通过在因式分解顺序中的后续标记上使用注意掩码来实现。

然而，所提出的公式导致变压器模型中两个矛盾的要求:

1.  当在时间步长 *t* 进行预测时，隐藏表示 *h(t)* 应该只包含位置信息，而不包含内容信息
2.  当在大于 *t* 的时间步长进行预测时， *h(t)* 包括令牌 *t* 的位置和内容

为了解决这个问题，使用了两个独立的流，即内容和查询表示。在计算上，查询流是可训练的，并且内容流用相应的单词嵌入来初始化。

大量的排列导致模型的训练收敛缓慢。因此，作者选择只预测因子分解顺序的最后一段。这样，由于不需要为前导记号计算查询表示，所以节省了速度和存储器。

那么，[像 BERT 这样的深度学习模型到底能不能理解语言](https://neptune.ai/blog/ai-limits-can-deep-learning-models-like-bert-ever-understand-language)？Neptune 博客上的这篇文章描述了我们应该从三个方面来理解 NLP

*   概念界限
*   技术限制
*   评估限制

对 NLP 演示感兴趣吗？使用 TensorFlow.js 查看关于文本相似性的现场演示:

[](/how-to-build-a-textual-similarity-analysis-web-app-aa3139d4fb71) [## 使用 TensorFlow.js 通用句子编码器的文本相似性

### 从学者到构建相似句子分组网络应用的旅程

towardsdatascience.com](/how-to-build-a-textual-similarity-analysis-web-app-aa3139d4fb71) [![](img/e6191b77eb1b195de751fecf706289ca.png)](https://www.linkedin.com/in/jingles/)[![](img/7c898af9285ccd6872db2ff2f21ce5d5.png)](https://towardsdatascience.com/@jinglesnote)[![](img/d370b96eace4b03cb3c36039b70735d4.png)](https://jingles.substack.com/subscribe)