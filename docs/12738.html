<html>
<head>
<title>Quick forecasting with Facebook Prophet — under 10 lines of code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用脸书预言家进行快速预测——只需 10 行代码</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/quick-forecasting-with-facebook-prophet-under-10-lines-of-code-4b23df30e517?source=collection_archive---------51-----------------------#2020-09-01">https://towardsdatascience.com/quick-forecasting-with-facebook-prophet-under-10-lines-of-code-4b23df30e517?source=collection_archive---------51-----------------------#2020-09-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/b9db9fb44c8e5df6084427a636c0358f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RNU8u_Y2F5myLgqr"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@srosinger3997?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">萨曼莎·加德斯</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><div class=""/><div class=""><h2 id="1c3d" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">Python 和 R 程序员的预测</h2></div></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><p id="fe05" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">我以前用的是<a class="ae jg" href="https://cran.r-project.org/web/packages/fpp2/index.html" rel="noopener ugc nofollow" target="_blank"> Rob J Hyndman 的</a> <code class="fe mb mc md me b"><a class="ae jg" href="https://cran.r-project.org/web/packages/fpp2/index.html" rel="noopener ugc nofollow" target="_blank">fpp2</a></code> <a class="ae jg" href="https://cran.r-project.org/web/packages/fpp2/index.html" rel="noopener ugc nofollow" target="_blank">预测包</a>。相当多。它仍然是我的首选预测库。我如此喜欢它的原因是它广泛覆盖了预测技术，并且是一本无价的开放书籍，里面有所有预测理论。时间序列学术研究所需的几乎所有东西都在那里。</p><p id="904b" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">但这也是软件包的缺点，它对初学者不友好。谁想造一辆车只是为了在路上开？</p><p id="0b7a" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">然后<a class="ae jg" href="https://facebook.github.io/prophet/" rel="noopener ugc nofollow" target="_blank">脸书先知</a>出现了。</p><p id="7781" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">预言家对预测练习做了令人难以置信的简化。你可以开箱即用，而不需要理解很多理论，正如你将在下面看到的。</p><p id="c9c5" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">该软件包使用起来非常直观，对于业务预测尤其强大。您甚至可以指定影响业务活动的周末、特殊日子和事件(例如超级碗)。</p><p id="93ae" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">Cherry 在上面，Prophet 有 python 和 R 编程语言两种版本！</p><p id="8cdf" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">让我们快速演示一下。</p></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="d1de" class="mf mg jj bd mh mi mj mk ml mm mn mo mp kp mq kq mr ks ms kt mt kv mu kw mv mw bi translated">1.安装软件包</h1><p id="b83e" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">我是用 Python 做的，所以你所需要的只是用于操作数据的<code class="fe mb mc md me b">pandas</code>包。</p><p id="8dcd" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">当然还有<code class="fe mb mc md me b">Prophet</code>。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="1bc5" class="nk mg jj me b gy nl nm l nn no"># improt libraries<br/>import pandas as pd<br/>from fbprophet import Prophet</span></pre><h1 id="1e73" class="mf mg jj bd mh mi np mk ml mm nq mo mp kp nr kq mr ks ns kt mt kv nt kw mv mw bi translated">2.导入和格式化数据</h1><p id="9b69" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">我要使用的数据集是一个时间序列，由 1981 年到 1990 年之间的 10 年中记录的每日最低温度组成。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="1013" class="nk mg jj me b gy nl nm l nn no"># import data<br/>df = pd.read_csv("<a class="ae jg" href="https://bit.ly/3hJwIm0" rel="noopener ugc nofollow" target="_blank">https://bit.ly/3hJwIm0</a>")</span><span id="b1cf" class="nk mg jj me b gy nu nm l nn no"># check out first few rows<br/>df.head()</span></pre><p id="4527" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">如您所见，datarame 只有两列，一列在时间维度上，另一列在观察值上。</p><figure class="nc nd ne nf gt iv gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/6504b0cf4b709b9bda04ddf44bef3f81.png" data-original-src="https://miro.medium.com/v2/resize:fit:382/format:webp/1*j4AOu1nCIw_-coyoFS5yYg.png"/></div></figure><p id="4c94" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">需要一些数据格式化。<code class="fe mb mc md me b">Prophet</code>要求日期时间列命名为“ds”，观察列命名为“y”。</p><p id="66b3" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">让我们重命名这两列。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="17ec" class="nk mg jj me b gy nl nm l nn no"># data formating<br/>df = df.rename(columns = {"Date": "ds", "Temp": "y"})</span></pre><h1 id="f485" class="mf mg jj bd mh mi np mk ml mm nq mo mp kp nr kq mr ks ns kt mt kv nt kw mv mw bi translated">3.模型结构</h1><p id="3647" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">与<a class="ae jg" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> Scikit Learn </a>算法类似，<code class="fe mb mc md me b">Prophet</code>遵循简单的“实例化→拟合→预测”工作流程进行预测。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="5917" class="nk mg jj me b gy nl nm l nn no"># instantiate model<br/>m = Prophet()</span><span id="0fdf" class="nk mg jj me b gy nu nm l nn no"># fit model to data<br/>m.fit(df)</span></pre><p id="48df" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">您可以使用参数，但是要构建您的第一个开箱即用的预测模型，就像这两行代码一样简单。</p><h1 id="9212" class="mf mg jj bd mh mi np mk ml mm nq mo mp kp nr kq mr ks ns kt mt kv nt kw mv mw bi translated">4.预测</h1><p id="b6fd" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">现在您已经有了模型，可以做预测了。</p><p id="9667" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">就像建立模型一样，预测也是两行代码。在第一行中，创建一个空的数据框架来存储预测值。在第二行中，您将空数据帧传入模型，模型将使用预测值填充行。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="ae28" class="nk mg jj me b gy nl nm l nn no"># make a forecast dataframe <br/>future = m.make_future_dataframe(periods = 365)</span><span id="a625" class="nk mg jj me b gy nu nm l nn no"># make a forecast<br/>forecast = m.predict(future)</span></pre><p id="d3a4" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">预测已经完成，现在可以在数据框架中查看预测值。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="c1bc" class="nk mg jj me b gy nl nm l nn no"># check out forecast values<br/>forecast[['ds', 'yhat', 'yhat_lower', 'yhat_upper']].tail()</span></pre><p id="7ffa" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">列名很直观—</p><ul class=""><li id="b6a7" class="nw nx jj lh b li lj ll lm lo ny ls nz lw oa ma ob oc od oe bi translated">ds:预测时间步长；</li><li id="0998" class="nw nx jj lh b li of ll og lo oh ls oi lw oj ma ob oc od oe bi translated">yhat:预测值</li><li id="c603" class="nw nx jj lh b li of ll og lo oh ls oi lw oj ma ob oc od oe bi translated">yhat_lower &amp; yhat_upper:置信区间</li></ul><figure class="nc nd ne nf gt iv gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/227b361472665b2c13e2f7763fe2c0a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*-iQgS55zUPZX40QoN78CDQ.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">预测数据框架</p></figure><h1 id="f59e" class="mf mg jj bd mh mi np mk ml mm nq mo mp kp nr kq mr ks ns kt mt kv nt kw mv mw bi translated">5.测绘</h1><p id="0a5e" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">最好是将数据和预测值可视化，看看它们是否吻合。</p><p id="b8e5" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">同样，这只是一行代码。</p><pre class="nc nd ne nf gt ng me nh ni aw nj bi"><span id="552f" class="nk mg jj me b gy nl nm l nn no"># plot<br/>fig1 = m.plot(forecast)</span></pre><p id="5ae1" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">在下图中，每个黑点代表原始观测值，深绿色线代表预测模型，浅绿色线代表置信区间。</p><figure class="nc nd ne nf gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ol"><img src="../Images/b2a454229994e4f22c511cb707ec73bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uEZ937pAqAKPiAz-Ft-8xQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">历史和预测值</p></figure><p id="cc00" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">那里！你用 10 行代码就做出了一个真正的预测模型！</p><h1 id="c10c" class="mf mg jj bd mh mi np mk ml mm nq mo mp kp nr kq mr ks ns kt mt kv nt kw mv mw bi translated">下一步是什么？</h1><p id="8744" class="pw-post-body-paragraph lf lg jj lh b li mx kk lk ll my kn ln lo mz lq lr ls na lu lv lw nb ly lz ma im bi translated">在这篇文章中，我并不打算深入研究这个模型，而是想让人们相信，即使你对理论知之甚少，建立一个预测模型也并不复杂。</p><p id="7e0d" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">下一步，你可以探索其他功能——它们有一个非常容易理解的<a class="ae jg" href="https://facebook.github.io/prophet/docs/quick_start.html" rel="noopener ugc nofollow" target="_blank">文档</a>。我特别鼓励人们去探索特殊的日子和事件是如何影响天气预报的(当然不是温度！而是商业活动)。</p><p id="9672" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">正如我所说的，您可以在 Python 和 R 编程环境中实现这个包，这给了您一些额外的自由。</p><p id="2bfa" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">欢迎在<a class="ae jg" href="https://twitter.com/home" rel="noopener ugc nofollow" target="_blank">推特</a>或<a class="ae jg" href="https://www.linkedin.com/in/mab-alam/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上关注我。</p></div></div>    
</body>
</html>