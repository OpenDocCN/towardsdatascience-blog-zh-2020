<html>
<head>
<title>Repurposing traditional resampling techniques for regression tasks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为回归任务重新利用传统的重采样技术</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/repurposing-traditional-resampling-techniques-for-regression-tasks-d1a9939dab5d?source=collection_archive---------48-----------------------#2020-06-12">https://towardsdatascience.com/repurposing-traditional-resampling-techniques-for-regression-tasks-d1a9939dab5d?source=collection_archive---------48-----------------------#2020-06-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/80388f6cf99b42323ae90d80b73b57f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*L9KEQHGFGzk1ZMAh"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">阿列克谢·耶什金在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="7c35" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">想象一下这样一个场景，你参加了一个涉及回归任务的数据科学竞赛，你发现目标变量是偏斜的。由于没有一个参与者能够在排行榜上获得较低的误差，您意识到训练数据是不平衡的，一些快速重新采样可以解决您的问题。但是等等！这不是一项分类任务，您无法从一套欠采样和过采样技术中进行选择。这是一项回归任务，尽管有一些重采样算法，但您的选择是有限的。如果我们可以简单地将所有基于分类任务的重采样方法重新用于回归任务，这不是很好吗？如果你的答案是肯定的，也应该是，那么你来对地方了！</p><h1 id="d64a" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">短信</h1><p id="aa2e" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">如果你只是想平衡你的回归数据，然后继续前进，那么<a class="ae kf" href="https://pypi.org/project/reg-resampler/" rel="noopener ugc nofollow" target="_blank">我们已经建立了一个python包，目前正在运行</a>。对于那些想了解这一想法背后的工作原理以及通过这种方法可以实现什么的人，请继续阅读。</p><h1 id="4959" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">这个想法</h1><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mh"><img src="../Images/8bb0717009173a80aa9650cf8e789a97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I0ksjIUEwyqDyqxcSF413w.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">偏斜目标变量的Seaborn图</p></figure><p id="6d5e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上图是来自<a class="ae kf" href="https://datahack.analyticsvidhya.com/contest/practice-problem-big-mart-sales-iii/#About" rel="noopener ugc nofollow" target="_blank"> AnalyticVidhya的Big Mart销售预测挑战</a>的目标变量的直方图。其偏斜值为1.1773，而真正的正态分布的偏斜值为0。由于数据集的性质，目标变量不能小于零，这会导致正的偏斜值。</p><p id="47ff" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从图中可以清楚地看到，与其他箱相比，某些箱具有大量的样本。为了使用传统方法对数据进行重采样，我们需要类的存在。对于回归任务，可以通过<strong class="ki iu">宁滨数据</strong>来实现。例如，在这种情况下，我们可以说0–3000范围内的所有样本都属于第0类，3000–6000属于第1类，依此类推。这将最终为我们提供伪的、不平衡的类，然后我们可以使用它们来执行欠采样和/或过采样。我们可以使用pandas <a class="ae kf" href="https://pandas.pydata.org/pandas-docs/version/0.23.4/generated/pandas.cut.html" rel="noopener ugc nofollow" target="_blank"> cut函数</a>得到这些伪类。</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="mm mn l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">这将每个样本放在一个类中</p></figure><p id="285c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦样本被分配到它们各自的类，我们可以将整个数据集，包括连续的目标变量，连同生成的基于类的变量一起，传递给重采样包，例如<a class="ae kf" href="https://imbalanced-learn.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu"> imblearn </strong> </a>。</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="mm mn l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">这会导致目标变量中出现新值的过采样示例。</p></figure><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mo"><img src="../Images/265a26ae10d5813e097144d40e04fafe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rX4WPumlCW9P3cfQacG2-w.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">使用自定义采样策略应用SMOTE后相同目标变量的Seaborn图。偏斜值现在已经减少到<strong class="bd mp"> 0.22 </strong></p></figure><h1 id="93d9" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">一份申请</h1><p id="f4e6" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">让我们看看这种再利用方法在现实世界中的表现。我们将使用如上所述的相同比赛的数据。AnalyticsVidhya还为每个相应的提交提供了真实世界的排名，这有助于了解我们在现已冻结的排行榜上的位置。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mq"><img src="../Images/14bf83cabcc61083404dc1ca7d43bd40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AYFfJoRaxGUWlJHaPImqnQ.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">资料截图</p></figure><p id="698c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据中有许多分类变量。我们将首先对这些特性中的每一个执行标签编码，填充任何缺失的值，并使用lightgbm进行快速的基线提交。</p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="mm mn l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">数据预处理</p></figure><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="mm mn l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">火车。预测。提交一份文件</p></figure><p id="eb13" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这使我们在排行榜上排名前2500，得分为1194(越少越好)。考虑到有35000名参与者，这还不算太坏！现在，我们通过使用我们的<a class="ae kf" href="https://pypi.org/project/reg-resampler/" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu"> <em class="mr"> reg_resampler包</em> </strong> </a>，在数据集的过采样版本上重新训练我们的lgbm模型。我们使用来自imblearn的SMOTE作为我们的过采样器。</p><p id="9efd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">附注:我们还使用KFold CV进行了细微的参数调整，这里没有显示。如果你想了解如何使用我们的包以正确的方式执行交叉验证，那么我们在GitHub 上为你准备了<a class="ae kf" href="https://github.com/atif-hassan/Regression_ReSampling/tree/master/tutorials" rel="noopener ugc nofollow" target="_blank">几个教程。</a></p><figure class="mi mj mk ml gt ju"><div class="bz fp l di"><div class="mm mn l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">重新训练。预测。提交一份文件</p></figure><p id="be07" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这使我们在排行榜上排名前30(第26位)，得分为1140！这是一个巨大的飞跃！！请注意，我们没有进行任何预处理，甚至没有为此进行任何特征工程。</p><p id="cf53" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还可以使用宁滨方法，通过将生成的箱用作回归任务的类，来执行分层kfold交叉验证。这让我比在<a class="ae kf" href="https://www.machinehack.com/course/used-electronics-price-prediction-weekend-hackathon-7/leaderboard" rel="noopener ugc nofollow" target="_blank"> MachineHack的二手电子产品价格预测挑战赛</a>中简单的折叠更接近实际的排行榜，在那里<a class="ae kf" href="https://analyticsindiamag.com/meet-the-machinehack-champions-who-cracked-the-used-electronics-price-prediction-hackathon/" rel="noopener ugc nofollow" target="_blank">我最终排名第一</a>。</p><h1 id="a62e" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">分析</h1><p id="12e4" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我对性能提高背后原因的假设是，宁滨为我们提供了基于类别的数据视图，并通过生成具有不同预测值的新样本，帮助模型更好地对新样本进行概括。</p><h1 id="0d4a" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">最终消息</h1><p id="e6f7" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我希望你已经发现这是有用的。如果您有任何问题和/或批评，请随时联系我的<a class="ae kf" href="https://www.linkedin.com/in/atif-hassan-1a8a45127/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>和<a class="ae kf" href="http://atif.hit.hassan@gmail.com" rel="noopener ugc nofollow" target="_blank"> Gmail </a>账户。</p><p id="d510" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">reg_resampler软件包是与才华横溢、能力出众的<a class="ae kf" href="https://medium.com/@pvsaikrithik" rel="noopener"> Venkata Sai Krithik </a>一起开发的。你也可以在Linkedin和Gmail上找到他。如果你使用这个包，那么请启动GitHub库。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="bbb2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[1]:托戈、路易斯、丽塔·里贝罗、伯恩哈德·普法林格和保拉·布兰科。"为回归而击打。"在<em class="mr">葡萄牙人工智能会议</em>中，第378–389页。施普林格，柏林，海德堡，2013。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><blockquote class="mz"><p id="cbe6" class="na nb it bd nc nd ne nf ng nh ni ld dk translated">谢谢大家！</p></blockquote></div></div>    
</body>
</html>