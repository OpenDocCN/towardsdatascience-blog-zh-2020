<html>
<head>
<title>Crop and Identify Specific Objects in an Image or Video in the Browser using Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习在浏览器中裁剪和识别图像或视频中的特定对象</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/crop-and-identify-specific-objects-in-an-image-or-video-in-the-browser-using-machine-learning-9b68780b2bb7?source=collection_archive---------33-----------------------#2020-06-20">https://towardsdatascience.com/crop-and-identify-specific-objects-in-an-image-or-video-in-the-browser-using-machine-learning-9b68780b2bb7?source=collection_archive---------33-----------------------#2020-06-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2d7b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用客户端机器学习的力量</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6fd2a712a289d4bc5cb53fabe204cf5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JZDWXusqhtQ5rlxiBs5E5w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">视频来源:<a class="ae kv" href="https://www.youtube.com/watch?v=Yi_kDT5L5s4" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=Yi_kDT5L5s4</a></p></figure><h1 id="be70" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">简介—浏览器中的机器学习</h1><p id="6c85" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">Tensorflow.js允许我们在浏览器中完全在客户端训练模型和运行推理。这开启了一大堆新的机会！</p><p id="0542" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在本文中，我们将构建一个工具，允许用户裁剪图像的特定部分，并对裁剪后的图像进行推理。我们将使用一个图像分类模型来帮助我们将图像分类到一个特定的类别，但理论上你可以使用任何模型。</p><h1 id="d493" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">演示</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="45e1" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://vigorous-leavitt-67d07f.netlify.app/" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir">应用的现场演示</strong> </a>如上图gif所示。下面的<em class="mr">注释</em>中提到了使用说明。</p><p id="d277" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://github.com/wingedrasengan927/Identify-Specific-Objects-in-an-Image-or-Video-using-machine-learning-in-the-browser" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> Github库</strong> </a></p><h2 id="e903" class="ms kx iq bd ky mt mu dn lc mv mw dp lg lx mx my li mb mz na lk mf nb nc lm nd bi translated"><strong class="ak">注:</strong></h2><ol class=""><li id="7c96" class="ne nf iq lq b lr ls lu lv lx ng mb nh mf ni mj nj nk nl nm bi translated">要使用实时工具，单击<em class="mr">实时演示</em>链接，这将打开应用程序。接下来上传你选择的任何视频剪辑。此时屏幕仍将保持空白。要播放视频，点击<em class="mr">播放</em>按钮，视频将开始播放。接下来，在感兴趣的视频实例上点击<em class="mr">暂停</em>按钮。这将初始化框架上的裁剪器。选择感兴趣的区域进行裁剪，点击<em class="mr">裁剪</em>按钮。这将弹出一个显示裁剪图像的模态。点击<em class="mr">进行预测</em>按钮，对裁剪后的图像进行推断。结果将显示在模态中。</li><li id="2ec9" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">演示中显示的工具是我们将在本文中构建的工具的扩展版本。您可以查看github repo以获取源代码。</li></ol><h1 id="094d" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">我们开始吧</h1><h2 id="5437" class="ms kx iq bd ky mt mu dn lc mv mw dp lg lx mx my li mb mz na lk mf nb nc lm nd bi translated">目录结构</h2><p id="eae7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们将创建一个简单的目录结构，如下所示。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="a0b9" class="ms kx iq nt b gy nx ny l nz oa">|-- index.html<br/>|-- index.js<br/>|-- style.css<br/>|-- |-- Images<br/>|   `-- image.jpg</span></pre><h2 id="5075" class="ms kx iq bd ky mt mu dn lc mv mw dp lg lx mx my li mb mz na lk mf nb nc lm nd bi translated">超文本标记语言</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob mq l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这就是我们的index.html的样子</p></figure><p id="8fad" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在<em class="mr"> head </em>标签中，我们使用cdn导入css样式表和某些库来帮助我们。我们将使用的库是:</p><p id="fe35" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://fengyuanchen.github.io/cropperjs/" rel="noopener ugc nofollow" target="_blank"><strong class="lq ir">cropper . js</strong></a><strong class="lq ir">:</strong>一个<strong class="lq ir"> </strong> Javascript图像裁剪库。</p><p id="1aab" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://www.tensorflow.org/js" rel="noopener ugc nofollow" target="_blank"><strong class="lq ir">tensor flow . js:</strong></a>JavaScript中用于机器学习的库。</p><p id="f4ac" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在主体中，我们有三个容器。第一个容器是我们将要测试的图像。第二个容器是我们放置按钮的地方，第一个按钮用于初始化图像的裁剪工具，第二个按钮用于裁剪选定的部分，并对图像的裁剪部分进行推理。第三个容器是空的，但是一旦我们运行推理，我们将使用JavaScript动态地填充结果。最后，我们导入cropper.js库和index.js脚本。</p><h2 id="85ad" class="ms kx iq bd ky mt mu dn lc mv mw dp lg lx mx my li mb mz na lk mf nb nc lm nd bi translated">半铸钢ˌ钢性铸铁(Cast Semi-Steel)</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob mq l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们的风格. css</p></figure><p id="d1c8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">接下来，我们添加一些css来限制边界内的图像，并使一切看起来很好。</p><p id="d238" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">html和css完成后，页面看起来会像这样:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cc1106c2bc7bd1596fbd480f14bfc01f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wlwzWhCvQgs-PDuJcXRSlg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:<a class="ae kv" href="http://www.newthinktank.com/wp-content/uploads/2010/05/Animals_311.jpg" rel="noopener ugc nofollow" target="_blank">http://www . new thinktank . com/WP-content/uploads/2010/05/Animals _ 311 . jpg</a></p></figure><h2 id="50f4" class="ms kx iq bd ky mt mu dn lc mv mw dp lg lx mx my li mb mz na lk mf nb nc lm nd bi translated">Java Script语言</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ob mq l"/></div></figure><p id="73e3" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这是最重要的部分。让我们了解一下代码是做什么的。</p><p id="ace8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">首先，我们抓住所有的元素，以便我们可以操纵它们。这包括图像、按钮等。</p><p id="22df" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">接下来，我们运行<em class="mr"> loadModel </em>函数。该函数下载MobileNet预训练模型，该模型已经在具有数千个类别的大型数据集上进行了训练。MobileNet指的是神经网络的特定架构。</p><p id="8f34" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们给这两个按钮添加了事件监听器，这样它们就可以在<em class="mr">点击时做出响应。</em></p><p id="a103" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">当我们点击第一个按钮——“初始化裁剪器”时，我们运行函数<em class="mr"> initializeCropper。</em>这个函数在我们的图像上创建一个<em class="mr">裁剪器</em>的新实例，并且清空我们的<em class="mr">结果</em>容器。</p><p id="8e11" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">第二个按钮——“裁剪图像并进行预测”运行<em class="mr">预测</em>功能。该函数获取从cropper获得的裁剪后的图像数据，并将其提供给我们的MobileNet模型。然后，该模型输出裁剪图像所属的类别或种类以及置信度概率。然后，我们动态地创建一个<em class="mr"> img </em>元素和一个<em class="mr"> h1 </em>元素，并将它们添加到我们的结果容器中以显示结果。</p><p id="7e0d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">流程是:</p><ol class=""><li id="450c" class="ne nf iq lq b lr mk lu ml lx oc mb od mf oe mj nj nk nl nm bi translated">点击“初始化裁剪器”按钮</li><li id="6c88" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">点击“裁剪图像并进行预测”</li><li id="6e5e" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">将显示结果</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cb43e3e3c3c493b775678e8335e0e667.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ULeUoxhhlSFgLU-_Wu5Xeg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/14da06cb6fbae21b3db9390507f27b6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V0j7My8be1wEAO37gOZoYg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2582ca5c3b915a373a59ed6cb83023e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VnXJaDaoah3m_GqRHfKsFA.png"/></div></div></figure><p id="ba9a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在上面的例子中，我裁剪了右边的北极熊，并对裁剪后的图像进行了推理。正如我们所见，该模型以相当高的可信度正确预测了它的类别。</p><h1 id="7ad9" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">结论</h1><p id="83e1" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">在本文中，我们构建了一个简单的工具，允许用户裁剪图像的特定部分，并对裁剪后的图像运行图像分类模型。</p><p id="f3dc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">希望你喜欢它！尽管这是一个基本的例子，但它可以扩展到构建令人惊叹的东西。一个例子是在视频中使用它，正如我在演示中展示的(<a class="ae kv" href="https://github.com/wingedrasengan927/Identify-Specific-Objects-in-an-Image-or-Video-using-machine-learning-in-the-browser" rel="noopener ugc nofollow" target="_blank"> github </a>)。</p><p id="cf00" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">客户端的机器学习已经打开了许多可能性，我鼓励你去创造令人敬畏的东西。</p><blockquote class="og"><p id="4363" class="oh oi iq bd oj ok ol om on oo op mj dk translated">“如果你不创造东西，就没有东西”——埃隆·马斯克</p></blockquote><p id="73d2" class="pw-post-body-paragraph lo lp iq lq b lr oq jr lt lu or ju lw lx os lz ma mb ot md me mf ou mh mi mj ij bi translated">如果您有任何反馈或想取得联系，请在ms.neerajkrishna@gmail.com的<em class="mr">上给我留言</em></p><h1 id="5de7" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">参考</h1><ol class=""><li id="a41d" class="ne nf iq lq b lr ls lu lv lx ng mb nh mf ni mj nj nk nl nm bi translated">【tensorflow.org/js T4】</li><li id="d5b6" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated"><a class="ae kv" href="https://fengyuanchen.github.io/cropperjs/" rel="noopener ugc nofollow" target="_blank">https://fengyuanchen.github.io/cropperjs/</a></li><li id="a5c3" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated"><a class="ae kv" href="https://codelabs.developers.google.com/codelabs/tensorflowjs-teachablemachine-codelab/index.html#0" rel="noopener ugc nofollow" target="_blank">https://code labs . developers . Google . com/code labs/tensor flow js-teacheble machine-code lab/index . html # 0</a></li></ol></div></div>    
</body>
</html>