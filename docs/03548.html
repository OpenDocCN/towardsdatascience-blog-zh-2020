<html>
<head>
<title>Static Typing in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中的静态类型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/static-typing-in-python-55aa6dfe61b4?source=collection_archive---------5-----------------------#2020-04-04">https://towardsdatascience.com/static-typing-in-python-55aa6dfe61b4?source=collection_archive---------5-----------------------#2020-04-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="9f2c" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">Python 初学者</h2><div class=""/><div class=""><h2 id="75a0" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">轻松进行类型检查</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/92011e48968149247a51bd6d487578d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZsHp6_BeR2OpYhIx"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/@battlecreekcoffeeroasters?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Battlecreek 咖啡烘焙师</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="98ae" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Python 是一种<strong class="lk jd"> <em class="me">动态</em> </strong>类型化语言。这意味着在给变量赋值时，<strong class="lk jd">没有必要声明变量的类型。例如，当你用字符串值<code class="fe mf mg mh mi b">'Tom'</code>初始化对象时，你不需要声明对象<code class="fe mf mg mh mi b">major</code>的数据类型为<code class="fe mf mg mh mi b">string</code>。</strong></p><pre class="ks kt ku kv gt mj mi mk ml aw mm bi"><span id="7202" class="mn mo it mi b gy mp mq l mr ms">major = 'Tom'</span></pre><p id="43f9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在像 C 这样的<strong class="lk jd"> <em class="me">静态</em> </strong>类型化语言中，你必须声明一个对象的数据类型。字符串被声明为字符数组。</p><pre class="ks kt ku kv gt mj mi mk ml aw mm bi"><span id="4ef2" class="mn mo it mi b gy mp mq l mr ms">char major[] = "Tom";</span></pre><p id="4ba2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">用像 Python 这样的动态类型语言编码肯定更灵活，但是人们可能想要注释对象的数据类型并强制类型约束。如果一个函数只需要整数参数，那么向函数中抛出字符串可能会导致程序崩溃。</p><p id="5d0a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">尽管这是动态类型的主要缺陷之一，Python 3 为程序员引入了几个注释工具来指定和约束对象的数据类型。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="6f5f" class="na mo it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">函数注释</h1><p id="7247" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">让我们以一个非常简单的函数<code class="fe mf mg mh mi b">foo</code>为例:</p><pre class="ks kt ku kv gt mj mi mk ml aw mm bi"><span id="9e91" class="mn mo it mi b gy mp mq l mr ms">def foo(n, s='Tom'):<br/>    return s*n</span></pre><p id="ad9b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">该函数以<code class="fe mf mg mh mi b">n</code>和<code class="fe mf mg mh mi b">s</code>为参数，返回<code class="fe mf mg mh mi b">s*n</code>。虽然它看起来像一个简单而无意义的乘法函数，但是请注意<code class="fe mf mg mh mi b">s</code>的默认值是<code class="fe mf mg mh mi b">'Tom'</code>，它是一个字符串，而不是一个数字。我们可能推断这个函数打算返回一个多次重复字符串<code class="fe mf mg mh mi b">s</code>的字符串，确切地说是<code class="fe mf mg mh mi b">n</code>次。</p><pre class="ks kt ku kv gt mj mi mk ml aw mm bi"><span id="2107" class="mn mo it mi b gy mp mq l mr ms">foo(3, 'Tom') # returns 'TomTomTom'</span></pre><p id="9c0b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这个功能比较混乱。您可能想写冗长的<strong class="lk jd">注释</strong>和<strong class="lk jd">文档字符串</strong>，解释函数并指定参数和返回值的数据类型。</p><pre class="ks kt ku kv gt mj mi mk ml aw mm bi"><span id="bf82" class="mn mo it mi b gy mp mq l mr ms">def foo(n, s='Tom'):<br/>    """Repeat a string multiple times.<br/>    Args:<br/>        n (int): number of times<br/>        s (string): target string<br/>    Returns:<br/>        (string): target string repeated n times.<br/>    """<br/>    return s*n</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nw"><img src="../Images/d5fc85428914d6938e9b5eb0b1b95c5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7V5RzM_BbxmZqK5J"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">美国宇航局在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="d1db" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Python 为你使用符号<code class="fe mf mg mh mi b">:</code>和<code class="fe mf mg mh mi b">-&gt;</code>做<strong class="lk jd"> <em class="me">可选标注</em> </strong>提供了一种更简洁的方式。</p><pre class="ks kt ku kv gt mj mi mk ml aw mm bi"><span id="7ee4" class="mn mo it mi b gy mp mq l mr ms">def foo(n: int, s: str='Tom') -&gt; str:<br/>    return s*n</span></pre><p id="d9e9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">函数<code class="fe mf mg mh mi b">foo</code>的注释可从函数的<code class="fe mf mg mh mi b">__annotations__</code>属性中获得。这是一个将参数名映射到它们的注释表达式的字典。这允许<strong class="lk jd">通过运行代码来手动</strong>类型检查，而不是自己查看源代码。非常方便。</p><pre class="ks kt ku kv gt mj mi mk ml aw mm bi"><span id="36b6" class="mn mo it mi b gy mp mq l mr ms">foo.__annotations__<br/># {'n': int, 's': str, 'return': str}</span></pre></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="6469" class="na mo it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">可变注释</h1><p id="8039" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">除了函数参数和返回值之外，还可以用某种数据类型来注释变量。你也可以注释变量而不用任何值初始化它们！</p><pre class="ks kt ku kv gt mj mi mk ml aw mm bi"><span id="9d2d" class="mn mo it mi b gy mp mq l mr ms">major: str='Tom' # type:str, this comment is no longer necessary<br/>i: int</span></pre><p id="0b09" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最好使用这种内置语法而不是注释来注释变量，因为注释在许多编辑器中通常是灰色的。</p><p id="137c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">用于注释更高级类型的变量，如<code class="fe mf mg mh mi b">list</code>、<code class="fe mf mg mh mi b">dict</code>等。，你需要从模块<code class="fe mf mg mh mi b">typing</code>中导入它们。类型名称大写，如<code class="fe mf mg mh mi b">List</code>、<code class="fe mf mg mh mi b">Tuple</code>、<code class="fe mf mg mh mi b">Dict</code>等..</p><pre class="ks kt ku kv gt mj mi mk ml aw mm bi"><span id="7e99" class="mn mo it mi b gy mp mq l mr ms">from typing import List, Tuple, Dict</span><span id="9245" class="mn mo it mi b gy nx mq l mr ms">l: List[int] = [1, 2, 3]<br/>t1: Tuple[float, str, int] = (1.0, 'two', 3)<br/>t2: Tuple[int, ...] = (1, 2.0, 'three')<br/>d: Dict[str, int] = {'uno': 1, 'dos': 2, 'tres': 3}</span></pre><p id="a83a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">列表、元组或字典中的元素也可以被注释。那些大写的类型采用方括号<code class="fe mf mg mh mi b">[]</code>中的参数，如上所示。</p><p id="74e5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><code class="fe mf mg mh mi b">List</code>接受一个参数，它是列表中所有元素的注释类型。固定大小元组中的元素可以逐个进行注释，而可变大小元组中的元素可以通过省略号<code class="fe mf mg mh mi b">...</code>进行注释。我们还可以在字典中指定键和条目的类型。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/3ecbdb2540b1c1e31f15ba6f13426a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4M1ip793ej22iAOd"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@fbazanegue?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杨奇煜·巴赞内格</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="489f" class="na mo it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">高级注释</h1><p id="96de" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">我们提到过<code class="fe mf mg mh mi b">List</code>只取一个参数。注释一个混合了<code class="fe mf mg mh mi b">int</code>和<code class="fe mf mg mh mi b">float</code>元素的列表怎么样？<code class="fe mf mg mh mi b">Union</code>就是答案。</p><pre class="ks kt ku kv gt mj mi mk ml aw mm bi"><span id="5a13" class="mn mo it mi b gy mp mq l mr ms">from typing import Union<br/>l2: List[Union[int, float]] = [1, 2.0, 3]</span></pre><p id="e601" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">它还支持任何用户定义的类作为注释中的类型。</p><pre class="ks kt ku kv gt mj mi mk ml aw mm bi"><span id="913d" class="mn mo it mi b gy mp mq l mr ms">class FancyContainer:<br/>    def __init__(self):<br/>        self.answer = 42</span><span id="56ad" class="mn mo it mi b gy nx mq l mr ms">fc: FancyContainer = FancyContainer()</span></pre><p id="d7c7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一个<strong class="lk jd"> <em class="me">可调用的</em> </strong>也可以使用上述技术进行注释。可调用的是可以被调用的东西，就像函数一样。</p><pre class="ks kt ku kv gt mj mi mk ml aw mm bi"><span id="9d8e" class="mn mo it mi b gy mp mq l mr ms">from typing import Callable<br/>my_func: Callable[[int, str], str] = foo</span></pre></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="35f6" class="na mo it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">警告</h1><p id="0709" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">首先，类型注释不能完全取代文档字符串和注释。出于可读性和再现性的目的，仍然需要对您的函数进行简要的描述和解释。启用类型注释可以避免让复杂的注释充满数据类型之类的信息。</p><p id="0a91" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">第二，有件事我应该一开始就告诉你。Python 解释器实际上不会自动进行任何类型检查。这意味着那些注释在运行时没有任何作用，即使你试图传递一个“错误”类型的对象给一个函数。</p><p id="df0c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">那么你有没有浪费自己的时间去学习类型注释呢？号码</p><p id="30be" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有许多 Python 模块可以在运行前强制执行这些约束。mypy 是目前最常用的类型检查器，没有运行时开销。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nz"><img src="../Images/723ace0b4a90b86a2b3f3783a924cfb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mY-ewrYlXAWQcI8N"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@revolt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">起义</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">广场</a>拍照</p></figure></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="e6ca" class="na mo it bd nb nc nd ne nf ng nh ni nj ki nk kj nl kl nm km nn ko no kp np nq bi translated">外卖</h1><p id="a6ac" class="pw-post-body-paragraph li lj it lk b ll nr kd ln lo ns kg lq lr nt lt lu lv nu lx ly lz nv mb mc md im bi translated">Python 中的类型注释有助于<strong class="lk jd">调试</strong>和可选的<strong class="lk jd">类型检查</strong>，后者模拟静态类型。它在项目开发中变得越来越流行，但在更普通的 Python 程序员中仍然很少见。</p><p id="f76e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">虽然没有注释并不一定会降低代码性能，但出于健壮性、可读性和可再现性的目的，它仍然被认为是一种良好的实践。</p><p id="bdcf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们仅仅触及了 Python 中静态类型和类型注释的皮毛。Python 3.9 即将对变量注释进行一些升级，所以请继续关注<a class="ae lh" href="http://edenau.mailchimpsites.com/" rel="noopener ugc nofollow" target="_blank">注册我的时事通讯</a>以接收我的新文章的更新。</p><p id="1b4d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">连 Python 3.8 都没准备好？我掩护你。</p><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/6-new-features-in-python-3-8-for-python-newbies-dc2e7b804acc"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jd gy z fp oi fr fs oj fu fw jc bi translated">Python 3.8 中针对 Python 新手的 6 项新特性</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">请做好准备，因为 Python 2 不再受支持</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="on l oo op oq om or lb od"/></div></div></a></div><p id="5916" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">感谢阅读！你觉得这些功能有趣有用吗？下面留言评论！您可能还会发现以下文章很有用:</p><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/4-easy-to-use-introspection-functions-in-python-49bd5ee3a2e8"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jd gy z fp oi fr fs oj fu fw jc bi translated">Python 中 4 个易于使用的自省函数</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">如何在运行时检查对象</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="os l oo op oq om or lb od"/></div></div></a></div><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/4-common-mistakes-python-beginners-should-avoid-89bcebd2c628"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd jd gy z fp oi fr fs oj fu fw jc bi translated">Python 初学者应该避免的 4 个常见错误</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">我很艰难地学会了，但你不需要</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="ot l oo op oq om or lb od"/></div></div></a></div></div></div>    
</body>
</html>