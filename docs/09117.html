<html>
<head>
<title>Machine Learning Basics: Multiple Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习基础:多元线性回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-basics-multiple-linear-regression-9c70f796e5e3?source=collection_archive---------14-----------------------#2020-06-30">https://towardsdatascience.com/machine-learning-basics-multiple-linear-regression-9c70f796e5e3?source=collection_archive---------14-----------------------#2020-06-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d3d1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习用 Python 编程实现多元线性回归。</h2></div><p id="3b12" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在前面的故事中，我简要介绍了线性回归，并展示了如何执行简单的线性回归。在简单线性回归中，我们有一个因变量(y)和一个自变量(x)。如果学生的分数取决于两个或更多的独立变量会怎样？</p><h2 id="080e" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">概观</h2><p id="b597" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在这个例子中，我们将经历<strong class="kk iu"> <em class="mc">多元线性回归</em> </strong>的实现，其中我们将为一个想要分析一个初创公司是否值得投资以获得良好回报的风险投资家预测初创公司的利润。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi md"><img src="../Images/3936f03cb06d245e4fdf1da6c5356d11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*87aMm1RRoaxS4Sy8Q-XMDg.jpeg"/></div></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">线性回归(<a class="ae mt" href="https://en.wikipedia.org/wiki/Linear_regression" rel="noopener ugc nofollow" target="_blank">来源</a>)</p></figure><h2 id="e60c" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">问题分析</h2><p id="7e97" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在这个数据中，我们有四个自变量，即，<em class="mc"> R &amp; D 支出，行政管理，营销支出</em>和<em class="mc">状态</em>。有一个自变量，即<em class="mc">利润</em>。因此，我们的工作是用这些数据训练 ML 模型，以了解四个特征(或独立变量)之间的相关性，并使用所有这些数据预测另一家新公司的利润。</p><h2 id="4b33" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤 1:导入库</h2><p id="9993" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在第一步中，我们将导入构建 ML 模型所需的库。导入<strong class="kk iu"> <em class="mc"> NumPy </em> </strong>库和<strong class="kk iu"> <em class="mc"> matplotlib </em> </strong>。另外，我们导入了<strong class="kk iu"> <em class="mc">熊猫</em> </strong>库进行数据分析。</p><pre class="me mf mg mh gt mu mv mw mx aw my bi"><span id="da2f" class="le lf it mv b gy mz na l nb nc">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd</span></pre><h2 id="03e7" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤 2:导入数据集</h2><p id="ed5a" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在下一步中，我们将使用 pandas 来存储从我的 github 存储库中获得的数据，并使用函数"<em class="mc"> pd.read_csv </em>"将其存储为名为"<strong class="kk iu"> <em class="mc"> dataset </em> </strong>"的 Pandas DataFrame。</p><p id="a933" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们浏览我们的数据集，并将自变量(x)分配给数据集的前四列，即 R&amp;D 支出(指数=0)、行政管理(指数=1)、营销支出(指数=2)和州(指数=3)。</p><pre class="me mf mg mh gt mu mv mw mx aw my bi"><span id="32aa" class="le lf it mv b gy mz na l nb nc">dataset = pd.read_csv('<a class="ae mt" href="https://raw.githubusercontent.com/mk-gurucharan/Regression/master/Startups_Data.csv'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/mk-gurucharan/Regression/master/Startups_Data.csv'</a>)</span><span id="b22c" class="le lf it mv b gy nd na l nb nc">X = dataset.iloc[:, :-1].values<br/>y = dataset.iloc[:, -1].values</span><span id="8359" class="le lf it mv b gy nd na l nb nc">dataset.head(5)</span><span id="8801" class="le lf it mv b gy nd na l nb nc">&gt;&gt;<br/>R&amp;D Spend  Administration  Marketing Spend   State      Profit<br/>165349.20  136897.80       471784.10         New York   192261.83<br/>162597.70  151377.59       443898.53         California 191792.06<br/>153441.51  101145.55       407934.54         Florida    191050.39<br/>144372.41  118671.85       383199.62         New York   182901.99<br/>142107.34  91391.77        366168.42         Florida    166187.94</span></pre><p id="883f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用相应的。iloc 函数对数据帧进行切片，将这些索引赋给 x，这里我们使用<strong class="kk iu"> [:，:-1] </strong>，可以解释为<strong class="kk iu">【包含所有行，包含所有列直到-1(不含-1)】</strong>。在这里，-1 表示倒数第一列。因此，我们将第 0、1、2 和 3 列指定为 x。</p><p id="10e1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将最后一列(-1)分配给因变量 y。我们打印数据帧以查看我们是否为训练数据获得了正确的列。</p><h2 id="c549" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤 3:编码分类数据</h2><p id="c128" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">只要数据集中有数字，我们就可以轻松地对数据集进行数学计算，并创建预测模型。在这个数据集中，我们遇到了一个非数字变量，即“<strong class="kk iu"> <em class="mc">、状态</em> </strong>”。这也称为分类数据。</p><p id="7509" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用另一个叫做<strong class="kk iu"> sklearn 的重要库对这些分类数据进行编码。</strong>在这里，我们导入了<strong class="kk iu"> ColumnTransformer </strong>和<strong class="kk iu"> OneHotEncoder </strong>。ColumnTransformer 允许单独转换数据帧的特定列。在我们的例子中，我们使用 OneHotEncoder 将“State”列(index=3)转换为数字数据。</p><p id="80c8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在对分类数据进行编码后，我们打印数据帧 X 并查看变化。我们看到在开始时增加了三个新栏目。每一列代表一个“状态”。例如，在第一行中，第三列表示“纽约”，因此第三列中的值为“1”。</p><pre class="me mf mg mh gt mu mv mw mx aw my bi"><span id="4746" class="le lf it mv b gy mz na l nb nc">from sklearn.compose import ColumnTransformer<br/>from sklearn.preprocessing import OneHotEncoder<br/>ct = ColumnTransformer(transformers=[('encoder', OneHotEncoder(), [3])], remainder='passthrough')<br/>X = np.array(ct.fit_transform(X))</span></pre><h2 id="ced8" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤 4:将数据集分为训练集和测试集</h2><p id="a0f4" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">一旦我们准备好了数据集，下一个重要的任务就是将数据集分成训练集和测试集。我们这样做是为了用称为“<strong class="kk iu">训练集</strong>的一部分数据训练我们的模型，并在称为“<strong class="kk iu">测试集</strong>的另一组数据上测试预测结果。</p><p id="805a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用“train_test_split”函数来拆分我们的数据。这里我们给出“test_size =0.2”，表示 20%的数据是测试集。在我们的例子中，将选择 10 个随机启动数据作为测试集，并将选择 40 个剩余的启动数据作为训练集。</p><pre class="me mf mg mh gt mu mv mw mx aw my bi"><span id="c31d" class="le lf it mv b gy mz na l nb nc">from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2)</span></pre><h2 id="0844" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤 5:在训练集上训练多元线性回归模型</h2><p id="b56b" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">下一步，我们导入"<strong class="kk iu"> LinearRegression </strong>"类，它将应用于我们的训练集。我们给 LinearRegression 类分配一个变量“<strong class="kk iu">回归变量</strong>”。然后，我们使用“<strong class="kk iu"> regressor.fit </strong>”将训练数据集(X_train 和 y_train)拟合到这个线性回归类，以便进行训练过程。</p><pre class="me mf mg mh gt mu mv mw mx aw my bi"><span id="0fb8" class="le lf it mv b gy mz na l nb nc">from sklearn.linear_model import LinearRegression<br/>regressor = LinearRegression()<br/>regressor.fit(X_train, y_train)</span></pre><h2 id="1c62" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤 6:预测测试集结果</h2><p id="569f" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">下一步，我们将使用训练好的模型(即“回归器”)来预测测试集的利润。测试集数据(X_test)的真实值(利润)存储在变量 y_test 中。</p><p id="1b98" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们使用“<strong class="kk iu"> regressor.predict </strong>”函数来预测测试数据 X_test 的值。我们将预测值指定为 y_pred。我们现在有两个数据，y_test(真实值)和 y_pred(预测值)。</p><pre class="me mf mg mh gt mu mv mw mx aw my bi"><span id="86f5" class="le lf it mv b gy mz na l nb nc">y_pred = regressor.predict(X_test)</span></pre><h2 id="9e26" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">步骤 7:将测试集与预测值进行比较</h2><p id="df4d" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在这一步中，我们将把 y_test 的值打印为 Pandas DataFrame 中每个 X_test 的<strong class="kk iu"><em class="mc"/></strong>实际值和 y_pred 值打印为<strong class="kk iu"> <em class="mc">预测值</em> </strong>。这样，我们获得了所有 10 个 X_test 数据的值。</p><pre class="me mf mg mh gt mu mv mw mx aw my bi"><span id="cc54" class="le lf it mv b gy mz na l nb nc">df = pd.DataFrame({'Real Values':y_test, 'Predicted Values':y_pred})<br/>df</span><span id="12be" class="le lf it mv b gy nd na l nb nc">&gt;&gt;<br/>Real Values Predicted Values<br/>78239.91    74963.602167<br/>182901.99   173144.548525<br/>64926.08    45804.248438<br/>105733.54   108530.843936<br/>141585.52   127674.466487<br/>108552.04   111471.421444<br/>146121.95   133618.038644<br/>105008.31   114655.651664<br/>96778.92    96466.443219<br/>97483.56    96007.236281</span></pre><p id="d156" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在第一行中，<strong class="kk iu"> <em class="mc"> </em> </strong>实际值的值为<strong class="kk iu"> <em class="mc"> 78239.91 </em> </strong>，预测值的值为<strong class="kk iu"> <em class="mc"> 74963.60 </em> </strong>。我们看到该模型已经精确地预测了该值，因此我们可以说我们的模型具有良好的准确性。</p><figure class="me mf mg mh gt mi"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="a30a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">恭喜你！现在，您已经从构建简单的线性回归模型扩展到多元线性回归模型。我附上了我的 Github 资源库的链接，你可以在那里找到 Python 笔记本和数据文件供你参考。</p><div class="ng nh gp gr ni nj"><a href="https://github.com/mk-gurucharan/Regression" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">MK-guru charan/回归</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">GitHub 是超过 5000 万开发人员的家园，他们一起工作来托管和审查代码、管理项目和构建…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">github.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx mn nj"/></div></div></a></div><p id="6952" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">希望我已经清楚地解释了开发多元线性回归的 ML 模型的过程，以便用相关数据预测一家初创公司的利润。</p><p id="9ad2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您还可以在下面找到该程序对其他回归模型的解释:</p><ul class=""><li id="76f8" class="ny nz it kk b kl km ko kp kr oa kv ob kz oc ld od oe of og bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/machine-learning-basics-simple-linear-regression-bc83c01baa07">简单线性回归</a></li><li id="fe62" class="ny nz it kk b kl oh ko oi kr oj kv ok kz ol ld od oe of og bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/machine-learning-basics-multiple-linear-regression-9c70f796e5e3">多元线性回归</a></li><li id="ee02" class="ny nz it kk b kl oh ko oi kr oj kv ok kz ol ld od oe of og bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/machine-learning-basics-polynomial-regression-3f9dd30223d1">多项式回归</a></li><li id="ecf2" class="ny nz it kk b kl oh ko oi kr oj kv ok kz ol ld od oe of og bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/machine-learning-basics-support-vector-regression-660306ac5226">支持向量回归</a></li><li id="14d5" class="ny nz it kk b kl oh ko oi kr oj kv ok kz ol ld od oe of og bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/machine-learning-basics-decision-tree-regression-1d73ea003fda">决策树回归</a></li><li id="1a1d" class="ny nz it kk b kl oh ko oi kr oj kv ok kz ol ld od oe of og bi translated"><a class="ae mt" rel="noopener" target="_blank" href="/machine-learning-basics-random-forest-regression-be3e1e3bb91a">随机森林回归</a></li></ul><p id="009c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在接下来的文章中，我们将会遇到更复杂的回归、分类和聚类模型。到那时，快乐的机器学习！</p></div></div>    
</body>
</html>