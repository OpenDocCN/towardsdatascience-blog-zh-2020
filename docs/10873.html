<html>
<head>
<title>How to use Scikit-Learn Datasets for Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 Scikit-Learn 数据集进行机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-scikit-learn-datasets-for-machine-learning-d6493b38eca3?source=collection_archive---------6-----------------------#2020-07-29">https://towardsdatascience.com/how-to-use-scikit-learn-datasets-for-machine-learning-d6493b38eca3?source=collection_archive---------6-----------------------#2020-07-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6d2e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我们将探索乳腺癌数据集，并创建一个肿瘤分类模型</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5ee33b0ec0d172bd9b55898025beab34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MDtiwPt_cG2dAUZC"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@nci?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">国立癌症研究所</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="f842" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Scikit-Learn 提供干净的数据集供您在构建 ML 模型时使用。当我说清洁时，我指的是准备好用于训练 ML 模型的清洁类型。最精彩的部分？这些数据集与 Scikit-Learn 包本身一起提供。你不需要下载任何东西。只需几行代码，您就可以处理数据。</p><blockquote class="ls"><p id="2a7e" class="lt lu iq bd lv lw lx ly lz ma mb lr dk translated">拥有现成的数据集是一项巨大的资产，因为您可以直接创建模型，而不必花费时间来获取、清理和转换数据，而这正是数据科学家花费大量时间的事情。</p></blockquote><p id="0c20" class="pw-post-body-paragraph kw kx iq ky b kz mc jr lb lc md ju le lf me lh li lj mf ll lm ln mg lp lq lr ij bi translated">即使所有的基础工作都已完成，您可能会发现使用 Scikit-Learn 数据集一开始会有点混乱。不要担心，几分钟后你将确切地知道如何使用数据集，并在探索人工智能世界的道路上前进。本文假设您已经安装了 python、scikit-learn、pandas 和 Jupyter Notebook(或者您可以使用 Google Collab)。我们开始吧。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="c4e6" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">Scikit-Learn 数据集简介</h1><p id="5fd6" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">Scikit-Learn 提供了七个数据集，他们称之为玩具数据集。不要被“玩具”这个词所迷惑。这些数据集非常强大，可以作为学习 ML 的一个强有力的起点。以下是一些数据集以及如何使用 ML:</p><ul class=""><li id="1342" class="nl nm iq ky b kz la lc ld lf nn lj no ln np lr nq nr ns nt bi translated">波士顿房价-使用 ML 根据该城镇的房间数量、犯罪率等属性来预测房价</li><li id="5ead" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated">乳腺癌威斯康星州(诊断)数据集-使用 ML 将癌症扫描诊断为良性(不会扩散到身体其他部位)或恶性(扩散到身体其他部位)</li><li id="1456" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated">葡萄酒识别—使用 ML 根据化学特征识别葡萄酒的类型</li></ul><p id="b5e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将使用“威斯康星州乳腺癌”数据集。我们将导入数据并理解如何读取它。作为奖励，我们将建立一个简单的 ML 模型，能够将癌症扫描分类为恶性或良性。要阅读更多关于数据集的信息，请点击这里获取 Scikit-Learn 的文档。</p><h1 id="995f" class="mo mp iq bd mq mr nz mt mu mv oa mx my jw ob jx na jz oc ka nc kc od kd ne nf bi translated">我如何导入数据集？</h1><p id="696a" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">数据集可以在<code class="fe oe of og oh b">sklearn.datasets.</code>让我们导入数据中找到。我们首先导入保存所有七个数据集的<code class="fe oe of og oh b">datasets</code>。</p><pre class="kg kh ki kj gt oi oh oj ok aw ol bi"><span id="a6ce" class="om mp iq oh b gy on oo l op oq">from sklearn import datasets</span></pre><p id="2752" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每个数据集都有一个用于加载数据集的相应函数。这些函数遵循相同的格式:“load_DATASET()”，其中 DATASET 是指数据集的名称。对于乳腺癌数据集，我们使用<code class="fe oe of og oh b">load_breast_cancer()</code>。类似地，对于葡萄酒数据集，我们将使用<code class="fe oe of og oh b">load_wine()</code>。让我们加载数据集，并将其存储到一个名为 data 的变量中。</p><pre class="kg kh ki kj gt oi oh oj ok aw ol bi"><span id="df0b" class="om mp iq oh b gy on oo l op oq">data = datasets.load_breast_cancer()</span></pre><p id="f583" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">到目前为止，一切顺利。这些加载函数(如<code class="fe oe of og oh b">load_breast_cancer()</code>)不会以我们期望的表格格式返回数据。他们返回一个<code class="fe oe of og oh b">Bunch</code>对象。不知道什么是<code class="fe oe of og oh b">Bunch</code>？别担心。</p><blockquote class="ls"><p id="3dfd" class="lt lu iq bd lv lw lx ly lz ma mb lr dk translated">把一个<code class="fe oe of og oh b"><strong class="ak">Bunch object </strong></code>想象成 Scikit-Learn 对一本字典的别出心裁的名字</p></blockquote><figure class="os ot ou ov ow kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/80e525dcb3af2016db10f83ad551c72b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VO_clvfSJpInmVis"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@edhoradic?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Edho Pratama </a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="44fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们快速回忆一下字典。字典是一种将数据存储为键和值的数据结构。把字典想象成你所熟悉的那本字典。您搜索单词(关键字)，并获得它们的定义(值)。在编程中，你可以选择任意的键和值(单词，数字等等。).例如，为了存储电话簿，键可以是姓名，值可以是电话号码。所以你看，Python 中的字典不仅仅局限于你熟悉的典型字典，而是可以应用于你喜欢的任何东西。</p><h1 id="2d35" class="mo mp iq bd mq mr nz mt mu mv oa mx my jw ob jx na jz oc ka nc kc od kd ne nf bi translated">我们的字典里有什么(Bunch)？</h1><p id="f221" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">Scikit 的字典还是<code class="fe oe of og oh b">Bunch</code>真的很厉害。让我们从看它的检索表开始。</p><pre class="kg kh ki kj gt oi oh oj ok aw ol bi"><span id="3c27" class="om mp iq oh b gy on oo l op oq">print(data.keys())</span></pre><p id="60dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们得到以下密钥:</p><ul class=""><li id="5a66" class="nl nm iq ky b kz la lc ld lf nn lj no ln np lr nq nr ns nt bi translated"><code class="fe oe of og oh b">data</code>是所有的特征数据(帮助我们识别肿瘤是恶性还是良性的扫描的属性，如半径、面积等。)在 NumPy 数组中</li><li id="1d30" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated"><code class="fe oe of og oh b">target</code>是 NumPy 数组中的目标数据(要预测的变量，在本例中为肿瘤是恶性还是良性)，</li></ul><p id="2818" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这两个键是实际数据。其余的键(如下)用于描述目的。值得注意的是，所有的 Scikit-Learn 数据集都分为<code class="fe oe of og oh b">data</code>和<code class="fe oe of og oh b">target</code>。<code class="fe oe of og oh b">data</code>表示特征，这些特征是帮助模型学习如何预测的变量。<code class="fe oe of og oh b">target </code>包括实际标签。在我们的例子中，目标数据是将肿瘤分类为 0 表示恶性或 1 表示良性的一列。</p><ul class=""><li id="03a2" class="nl nm iq ky b kz la lc ld lf nn lj no ln np lr nq nr ns nt bi translated"><code class="fe oe of og oh b">feature_names</code>是特征变量的名称，换句话说就是<code class="fe oe of og oh b">data</code>中列的名称</li><li id="5c06" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated"><code class="fe oe of og oh b">target_names</code>是目标变量的名称，换句话说就是<code class="fe oe of og oh b">target</code>列的名称</li><li id="962f" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated"><code class="fe oe of og oh b">DESCR</code>，DESCRIPTION 的简称，是对数据集的描述</li><li id="a399" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated"><code class="fe oe of og oh b">filename</code>是 CSV 格式数据的实际文件的路径。</li></ul><p id="abdd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要查看一个键的值，您可以键入<code class="fe oe of og oh b">data.KEYNAME</code>,其中 KEYNAME 表示键。所以如果我们想看数据集的描述，</p><pre class="kg kh ki kj gt oi oh oj ok aw ol bi"><span id="13a0" class="om mp iq oh b gy on oo l op oq">print(data.DESCR) </span></pre><p id="c7b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是输出的预览(完整描述太长，无法包含):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/7e493903a3a94c927d9e7db2118d4572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BqekAM-Q_sWSLE2s-oexdw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Scikit-Learn 乳腺癌数据集描述</p></figure><p id="e050" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您也可以通过访问<a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.load_boston.html#sklearn.datasets.load_boston" rel="noopener ugc nofollow" target="_blank"> Scikit-Learn 的文档</a>来查看数据集信息。他们的文档可读性更好，也更整洁。</p><h1 id="2e03" class="mo mp iq bd mq mr nz mt mu mv oa mx my jw ob jx na jz oc ka nc kc od kd ne nf bi translated">使用数据集</h1><p id="782e" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">现在我们已经了解了 load 函数返回的内容，让我们看看如何在 ML 模型中使用数据集。首先，如果您想探索数据集，可以使用<code class="fe oe of og oh b">pandas</code>来完成。方法如下:</p><pre class="kg kh ki kj gt oi oh oj ok aw ol bi"><span id="cbab" class="om mp iq oh b gy on oo l op oq"># Import pandas<br/>import pandas as pd</span><span id="f133" class="om mp iq oh b gy oy oo l op oq"># Read the DataFrame, first using the feature data<br/>df = pd.DataFrame(data.data, columns=data.feature_names)</span><span id="b5d9" class="om mp iq oh b gy oy oo l op oq"># Add a target column, and fill it with the target data<br/>df['target'] = data.target</span><span id="d984" class="om mp iq oh b gy oy oo l op oq"># Show the first five rows<br/>df.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oz"><img src="../Images/35d3c551b7ea7b3ffb009a2af9fcfdeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lDE2Y9vWq97ZWYcyyLg95Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">数据框的裁剪视图(不包括所有列)</p></figure><p id="b903" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你应该感到骄傲。您已经将一个数据集加载到一个 Pandas 数据框架中，该数据框架已准备好供探索和使用。要真正看到这个数据集的价值，运行</p><pre class="kg kh ki kj gt oi oh oj ok aw ol bi"><span id="6f76" class="om mp iq oh b gy on oo l op oq">df.info()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pa"><img src="../Images/0fc5c8f5cfa76d96b42cddb3f0d8f4c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*We2Idku1idoIdl1QFYNycg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">df.info()输出—注意没有丢失值</p></figure><p id="6b43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有几件事需要注意:</p><ul class=""><li id="8b08" class="nl nm iq ky b kz la lc ld lf nn lj no ln np lr nq nr ns nt bi translated">没有任何缺失值，所有列都有 569 个值。这为我们节省了计算缺失值的时间。</li><li id="34a5" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated">所有的数据类型都是数字。这很重要，因为 Scikit-Learn 模型不接受分类变量。在现实世界中，当我们得到分类变量时，我们将它们转换成数值变量。Scikit-Learn 的数据集没有分类变量。</li></ul><p id="2482" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，Scikit-Learn 负责数据清理工作。他们的数据集非常有价值。通过使用它们，你将从学习 ML 中受益。</p><h1 id="f6e9" class="mo mp iq bd mq mr nz mt mu mv oa mx my jw ob jx na jz oc ka nc kc od kd ne nf bi translated">让我们做一些人工智能</h1><p id="2ec9" class="pw-post-body-paragraph kw kx iq ky b kz ng jr lb lc nh ju le lf ni lh li lj nj ll lm ln nk lp lq lr ij bi translated">最后，激动人心的部分。让我们建立一个模型，将癌症肿瘤分为恶性(扩散)或良性(非扩散)。这将向您展示如何将数据用于您自己的模型。我们将构建一个简单的 K 近邻模型。</p><p id="7afa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，让我们将数据集一分为二，一个用于训练模型，为其提供学习数据，另一个用于测试模型，查看模型对以前从未见过的数据(扫描)的执行情况。</p><pre class="kg kh ki kj gt oi oh oj ok aw ol bi"><span id="4eff" class="om mp iq oh b gy on oo l op oq"># Store the feature data<br/>X = data.data</span><span id="536f" class="om mp iq oh b gy oy oo l op oq"># store the target data<br/>y = data.target</span><span id="dc0d" class="om mp iq oh b gy oy oo l op oq"># split the data using Scikit-Learn's train_test_split</span><span id="0cb3" class="om mp iq oh b gy oy oo l op oq">from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y)</span></pre><p id="8445" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这给了我们两个数据集——一个用于训练，一个用于测试。让我们开始训练模型。</p><pre class="kg kh ki kj gt oi oh oj ok aw ol bi"><span id="9d74" class="om mp iq oh b gy on oo l op oq">from sklearn.neighbors import KNeighborsClassifier<br/>logreg = KNeighborsClassifier(n_neighbors=6)</span><span id="4a23" class="om mp iq oh b gy oy oo l op oq">logreg.fit(X_train, y_train)<br/>logreg.score(X_test, y_test)</span></pre><p id="8b3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有没有得到 0.909 的输出？这意味着模型有 91%的准确性！是不是很神奇？在短短几分钟内，你就建立了一个对癌症扫描进行分类的模型，准确率高达 90%。当然，在现实世界中要比这复杂得多，但是你已经有了一个很好的开始。通过尝试使用 Scikit-Learn 的数据集建立模型，您将学到很多东西。如果有疑问，就用谷歌搜索你的任何问题。有一个巨大的机器学习社区，很可能你的问题以前被问过。快乐 AI 学习！</p></div></div>    
</body>
</html>