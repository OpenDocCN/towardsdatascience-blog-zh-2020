<html>
<head>
<title>Run, Secure, and Deploy Elastic Stack on Docker 🐳</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Docker上运行、保护和部署弹性堆栈🐳</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/running-securing-and-deploying-elastic-stack-on-docker-f1a8ebf1dc5b?source=collection_archive---------4-----------------------#2020-05-14">https://towardsdatascience.com/running-securing-and-deploying-elastic-stack-on-docker-f1a8ebf1dc5b?source=collection_archive---------4-----------------------#2020-05-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3dd7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Docker上为小规模生产部署和开发构建和配置弹性堆栈(ELK)</h2></div><h2 id="5a1e" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">什么是弹性叠加？</h2><p id="de12" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">Elastic Stack(又名<strong class="lg iu"> ELK </strong>)是您组织的集中式结构化日志记录的当前首选堆栈。它<strong class="lg iu">收集</strong>、<strong class="lg iu">吸收</strong>、<strong class="lg iu">存储</strong>您的服务日志(以及指标),同时<strong class="lg iu">使它们可搜索&amp;可聚集&amp;可观察</strong>。然后，基于这些数据构建警报和仪表板。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi lx"><img src="../Images/007c32bf94cb4a4a66c185d155473c6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Ibx_1x-07Scrgw7Yy9ypQ.jpeg"/></div></div><p class="mj mk gj gh gi ml mm bd b be z dk translated">活动中的弹性堆栈。</p></figure><h2 id="c546" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">运行弹性堆栈</h2><p id="2b1c" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">在本帖中，我们将使用Docker&amp;Docker-Compose<strong class="lg iu">编写</strong>、<strong class="lg iu">配置</strong>、<strong class="lg iu">安全</strong>、<strong class="lg iu">部署</strong>弹性堆栈。我们将构建的内容可用于docker主机上的<strong class="lg iu">开发</strong>和<strong class="lg iu">小规模生产部署</strong>。</p><ul class=""><li id="2aef" class="mn mo it lg b lh mp lk mq kr mr kv ms kz mt lw mu mv mw mx bi translated">为每个组件构建一个映像。</li><li id="3c01" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw mu mv mw mx bi translated">参数化配置&amp;避免硬编码凭证。</li><li id="4f4b" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw mu mv mw mx bi translated">将Elasticsearch设置为可扩展的生产单节点集群。</li><li id="f3e0" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw mu mv mw mx bi translated">设置安全性和加密。</li><li id="3bb4" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw mu mv mw mx bi translated">在容器外保存秘密、证书和数据。</li><li id="ad5e" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw mu mv mw mx bi translated">在Docker-Compose中将所有内容组合在一起。</li></ul></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><p id="d6f6" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated"><strong class="lg iu">要跳过逐步教程</strong>你可以查看我的<a class="ae nn" href="https://github.com/sherifabdlnaby/elastdocker" rel="noopener ugc nofollow" target="_blank"> Elastdocker </a>模板库，用一个命令在Docker <strong class="lg iu">上旋转弹性堆栈。</strong></p><div class="no np gp gr nq nr"><a href="https://github.com/sherifabdlnaby/elastdocker" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">sherifabdlnaby/elastdocker</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">用像Curator，Rubban，ElastAlert这样的工具进行预警。弹性堆栈(又名ELK) Docker组成，预配置…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of mh nr"/></div></div></a></div><pre class="ly lz ma mb gt og oh oi oj aw ok bi"><span id="4d6d" class="ki kj it oh b gy ol om l on oo">git clone <a class="ae nn" href="https://github.com/sherifabdlnaby/elastdocker.git" rel="noopener ugc nofollow" target="_blank">https://github.com/sherifabdlnaby/elastdocker.git</a><br/>cd elastdocker<br/>make setup &amp; make elk</span></pre><blockquote class="op oq or"><p id="c85e" class="le lf os lg b lh mp ju lj lk mq jx lm ot nk lo lp ou nl lr ls ov nm lu lv lw im bi translated">Elastdocker template具有更完善的配置和更好的安全性，以及经常与Elastic Stack一起使用的监控和工具。为了简单起见，本教程中省略了这些额外的内容。</p></blockquote></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="6c65" class="ow kj it bd kk ox oy oz kn pa pb pc kq jz pd ka ku kc pe kd ky kf pf kg lc pg bi translated">步伐</h1><ol class=""><li id="cacb" class="mn mo it lg b lh li lk ll kr ph kv pi kz pj lw pk mv mw mx bi translated">为我们的堆栈创建Docker映像(使用我们的配置)。</li><li id="95ee" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw pk mv mw mx bi translated">创建一个设置容器来生成Elasticsearch密钥库和证书。</li><li id="1bad" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw pk mv mw mx bi translated">使用Docker-Compose将堆栈放在一起。</li><li id="7b86" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw pk mv mw mx bi translated">开始运送日志！🎉</li></ol></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="97d7" class="ow kj it bd kk ox oy oz kn pa pb pc kq jz pd ka ku kc pe kd ky kf pf kg lc pg bi translated">1.为我们的堆栈创建Docker图像。</h1><p id="4d21" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">让我们从制作根目录<code class="fe pl pm pn oh b">elk</code>开始，创建五个独立的文件夹；<code class="fe pl pm pn oh b">elasticsearch</code>、<code class="fe pl pm pn oh b">logstash</code>、<code class="fe pl pm pn oh b">kibana</code>、<code class="fe pl pm pn oh b">setup</code>和<code class="fe pl pm pn oh b">secrets</code>目录。</p><p id="656e" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated">另外，在根目录下创建一个<code class="fe pl pm pn oh b">.env</code>文件来保存我们的参数。</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="po pp l"/></div></figure><h2 id="dae2" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">弹性搜索</h2><p id="6b42" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">在<code class="fe pl pm pn oh b">./elasticsearch</code>目录中创建<code class="fe pl pm pn oh b">Dockerfile</code>并添加以下内容:</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="po pp l"/></div></figure><p id="1115" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated">然后我们还将<code class="fe pl pm pn oh b">elasticsearch.yml</code>添加到<code class="fe pl pm pn oh b">./elastichsearch/config/ </code>目录中，这个文件将在容器启动时加载以配置elasticsearch。</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="po pp l"/></div></figure><ul class=""><li id="f12f" class="mn mo it lg b lh mp lk mq kr mr kv ms kz mt lw mu mv mw mx bi translated">注意<code class="fe pl pm pn oh b">${ELASTIC_XXX}</code>配置将从容器的环境变量中设置，我们稍后将在运行时传递这些变量。</li></ul><p id="0f77" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated"><strong class="lg iu"> Logstash <br/> </strong>在<code class="fe pl pm pn oh b">./logstash</code>目录下创建<code class="fe pl pm pn oh b">Dockerfile</code>并添加以下内容:</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="po pp l"/></div></figure><p id="d61c" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated">将<code class="fe pl pm pn oh b">logstash.yml</code>添加到<code class="fe pl pm pn oh b">logstash/config</code>目录中。</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="po pp l"/></div></figure><p id="a44b" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated">将<code class="fe pl pm pn oh b">logstash.conf</code>添加到<code class="fe pl pm pn oh b">logstash/pipeline</code>目录中。</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="po pp l"/></div><p class="mj mk gj gh gi ml mm bd b be z dk translated">从Beats = to =&gt; Elasticsearch转发数据的简单管道。</p></figure><h2 id="421d" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">基巴纳</h2><p id="83b2" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">在<code class="fe pl pm pn oh b">kibana</code>目录中创建<code class="fe pl pm pn oh b">Dockerfile</code>并添加以下内容:</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="po pp l"/></div></figure><p id="bf1d" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated">将<code class="fe pl pm pn oh b">kibana.yml</code>添加到<code class="fe pl pm pn oh b">kibana\config</code>目录:</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="po pp l"/></div></figure></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="85fc" class="ow kj it bd kk ox oy oz kn pa pb pc kq jz pd ka ku kc pe kd ky kf pf kg lc pg bi translated">2.创建一个设置容器来生成Elasticsearch密钥库和认证</h1><p id="48f9" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">我们需要创建一个容器来生成Elasticsearch密钥库，其中包含Elasticsearch的用户(和超级用户)密码，以及其他凭证(例如，如果您使用S3插件，就像AWS密钥一样)。<br/>该密钥库由Elasticsearch docker映像中的<code class="fe pl pm pn oh b"><em class="os">elasticsearch-keystore</em></code> <em class="os">创建。</em></p><p id="3bbe" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated"><strong class="lg iu"> 2.1 </strong>增加<code class="fe pl pm pn oh b">setup-keystore.sh</code>到<code class="fe pl pm pn oh b">/setup</code></p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="po pp l"/></div></figure><p id="111f" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated">这个脚本创建一个Keystore并将其写入<code class="fe pl pm pn oh b">/secrets/elasticsearch.keystore</code>，然后将<code class="fe pl pm pn oh b">$ELASTIC_PASSWORD</code>添加为默认超级用户<code class="fe pl pm pn oh b">elastic</code>，稍后我们将使用<code class="fe pl pm pn oh b">docker-compose</code>将<code class="fe pl pm pn oh b">$ELASTIC_PASSWORD</code>传递给安装容器。</p><p id="f377" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated"><strong class="lg iu"> 2.2 </strong>增加<code class="fe pl pm pn oh b">setup-certs.sh</code>到<code class="fe pl pm pn oh b">/setup</code></p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="po pp l"/></div></figure><p id="48c8" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated">该脚本创建一个自签名的单个PKCS#12密钥库，其中包括节点证书、节点密钥和CA证书。</p><p id="0af1" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated"><strong class="lg iu"> 2.3 </strong>在根目录下创建<strong class="lg iu"> </strong> <code class="fe pl pm pn oh b">docker-compose.setup.yml</code>将启动安装容器。</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="po pp l"/></div></figure><p id="0ec7" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated">这个<code class="fe pl pm pn oh b">docker-compose</code>创建了一个临时容器，它使用我们之前编写的脚本生成密钥库和证书。</p><p id="20fd" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated">使用以下命令运行:</p><pre class="ly lz ma mb gt og oh oi oj aw ok bi"><span id="61dc" class="ki kj it oh b gy ol om l on oo">docker-compose -f docker-compose.setup.yml run --rm keystore<br/>docker-compose -f docker-compose.setup.yml run --rm certs</span></pre><p id="db18" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated">这将创建容器，并在完成时删除它们以节省空间。将其输出保存到<code class="fe pl pm pn oh b">/secrets</code>目录。</p><h1 id="a51e" class="ow kj it bd kk ox pq oz kn pa pr pc kq jz ps ka ku kc pt kd ky kf pu kg lc pg bi translated">3.使用Docker-Compose将堆栈放在一起。</h1><p id="3604" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">最后，创建主<code class="fe pl pm pn oh b">docker-compose.yml</code>文件，将所有内容放在一起。</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="po pp l"/></div></figure><p id="caa9" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated">Docker-Compose文件中有什么？</p><ol class=""><li id="e4b0" class="mn mo it lg b lh mp lk mq kr mr kv ms kz mt lw pk mv mw mx bi translated">我们声明Elasticsearch的容量将持久存储数据。</li><li id="61e3" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw pk mv mw mx bi translated">我们声明传递给Elasticsearch的秘密密钥库，它包含凭证(目前只有超级用户密码，但是以后可以通过扩展<code class="fe pl pm pn oh b">setup-keystore.sh</code>脚本来保存许多其他凭证)</li><li id="9827" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw pk mv mw mx bi translated">我们声明ELK的3个服务(Elasticsearch、Logstash和Kibana) <br/>传递构建图像和运行容器所需的环境变量，召回所有包含<code class="fe pl pm pn oh b">${ELASTIC_XXX}</code>配置的配置文件，您必须在这里看到它们被传递。注意，我们也没有在<code class="fe pl pm pn oh b">Docker-Compose</code>文件中硬编码它们的值，而是在<code class="fe pl pm pn oh b">.env</code>文件中声明所有内容，这样它就保存了所有参数。</li><li id="ccb5" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw pk mv mw mx bi translated">我们还声明了Elasticsearch的推荐设置，如<code class="fe pl pm pn oh b">ulimit</code>和<code class="fe pl pm pn oh b">ES_JAVA_OPTS</code>，并为堆栈组件设置了堆大小。</li></ol><p id="54a8" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated"><strong class="lg iu">将所有参数添加到</strong> <code class="fe pl pm pn oh b"><strong class="lg iu">.env</strong></code> <strong class="lg iu">文件</strong></p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="po pp l"/></div></figure><h2 id="08f6" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">启动堆栈</h2><p id="9544" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">运行以下命令:</p><p id="07de" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated"><strong class="lg iu">设置(仅运行一次)</strong></p><pre class="ly lz ma mb gt og oh oi oj aw ok bi"><span id="bf7b" class="ki kj it oh b gy ol om l on oo">docker-compose -f docker-compose.setup.yml run --rm keystore<br/>docker-compose -f docker-compose.setup.yml run --rm certs</span></pre><p id="96d0" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated"><strong class="lg iu">启动弹性堆栈</strong></p><pre class="ly lz ma mb gt og oh oi oj aw ok bi"><span id="e9a4" class="ki kj it oh b gy ol om l on oo">docker-compose up -d</span></pre><p id="99df" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated"><strong class="lg iu">前往</strong><a class="ae nn" href="http://localhost:5601" rel="noopener ugc nofollow" target="_blank">localhost:5601</a><br/><strong class="lg iu">用户名</strong> : <code class="fe pl pm pn oh b">elastic</code> <br/> <strong class="lg iu">密码</strong> : <code class="fe pl pm pn oh b">changeme</code></p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi pv"><img src="../Images/ac65890067532479e39aab25615655aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VHYE0z49sx5CG1G-Q0yPYA.png"/></div></div><p class="mj mk gj gh gi ml mm bd b be z dk translated">登录弹性基巴纳</p></figure></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="4a88" class="ow kj it bd kk ox oy oz kn pa pb pc kq jz pd ka ku kc pe kd ky kf pf kg lc pg bi translated">4.开始运送日志！🎉</h1><p id="45ab" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">您现在可以开始将日志和指标发送到Elastic Stack。<br/> 1。<a class="ae nn" href="http://localhost:5601/app/kibana#/home/tutorial_directory/logging" rel="noopener ugc nofollow" target="_blank">使用Filebeat从服务中发送日志</a>。<br/> 2。<a class="ae nn" href="http://localhost:5601/app/kibana#/home/tutorial_directory/metrics" rel="noopener ugc nofollow" target="_blank">使用Metricbeat从服务中发送指标。</a> <br/>直接到Elasticsearch或者用Logstash摄取。并在Kibana的发现窗口中浏览它们。</p><blockquote class="op oq or"><p id="0f3b" class="le lf os lg b lh mp ju lj lk mq jx lm ot nk lo lp ou nl lr ls ov nm lu lv lw im bi translated">有许多指南可以帮助你将原木运送到弹性堆上。</p></blockquote></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="4e4c" class="ow kj it bd kk ox oy oz kn pa pb pc kq jz pd ka ku kc pe kd ky kf pf kg lc pg bi translated">从这里去哪里？</h1><p id="c41b" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">我们还可以进一步增强这种组合，我们可以启用自我监控，或添加Prometheus Exporters以使用Grafana监控堆栈，除了我们启用的内部节点传输加密之外，还可以为HTTP层启用SSL，为映像添加健康检查，使用ElastAlert或Curator等工具来利用堆栈，向集群添加更多节点。</p><h2 id="fa23" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">使用<a class="ae nn" href="https://github.com/sherifabdlnaby/elastdocker" rel="noopener ugc nofollow" target="_blank"> Elastdocker </a>代替。</h2><p id="8c10" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated"><a class="ae nn" href="https://github.com/sherifabdlnaby/elastdocker" rel="noopener ugc nofollow" target="_blank"> Elastdocker </a>是一个模板库，拥有我们刚刚制作的更复杂版本的弹性堆栈设置，包括上面提到的所有要点。</p><div class="no np gp gr nq nr"><a href="https://github.com/sherifabdlnaby/elastdocker" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">sherifabdlnaby/elastdocker</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">用像Curator，Rubban，ElastAlert这样的工具进行预警。弹性堆栈(又名ELK) Docker组成，预配置…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of mh nr"/></div></div></a></div><h2 id="f2d7" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">缩放弹性堆栈</h2><p id="eeb5" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">这种设置可以处理少量生产工作负载，但最终需要扩展。</p><ul class=""><li id="48b3" class="mn mo it lg b lh mp lk mq kr mr kv ms kz mt lw mu mv mw mx bi translated">您需要将栈组件解耦，以便独立地部署到不同的docker主机上。</li><li id="119f" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw mu mv mw mx bi translated">您可能需要添加额外的Elasticsearch节点。</li><li id="2d9e" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw mu mv mw mx bi translated">您可能需要横向扩展Logstash。</li><li id="4eb6" class="mn mo it lg b lh my lk mz kr na kv nb kz nc lw mu mv mw mx bi translated">将当前设置转换为Kubernetes设置，改为使用<strong class="lg iu">窗格</strong>和<strong class="lg iu">图表</strong>。(前提是你的组织里有k8。)</li></ul><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi pw"><img src="../Images/95c0346053474dac0960fa5a9210504a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LTYmXcqeNnEEzNeSLLp7gw.png"/></div></div><p class="mj mk gj gh gi ml mm bd b be z dk translated">分解成吊舱的弹性堆栈的可能K8S部署</p></figure><p id="f239" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated"><strong class="lg iu">您可以看看托管弹性堆栈产品。</strong></p><p id="8415" class="pw-post-body-paragraph le lf it lg b lh mp ju lj lk mq jx lm kr nk lo lp kv nl lr ls kz nm lu lv lw im bi translated">本帖使用的代码:<a class="ae nn" href="https://github.com/sherifabdlnaby/medium-elastic-stack" rel="noopener ugc nofollow" target="_blank">https://github.com/sherifabdlnaby/medium-elastic-stack</a></p></div></div>    
</body>
</html>