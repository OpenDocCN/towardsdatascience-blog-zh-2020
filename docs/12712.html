<html>
<head>
<title>Machine Learning on FIFA 20</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">FIFA 20 上的机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fifa-20-player-clustering-f500cf0792c5?source=collection_archive---------25-----------------------#2020-09-01">https://towardsdatascience.com/fifa-20-player-clustering-f500cf0792c5?source=collection_archive---------25-----------------------#2020-09-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="311c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过监督机器学习对视频游戏 FIFA 20 和球员分类的数据探索。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ac19e9b2d531a8a10e1ce9cffe627427.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KqylPAHedw5Bw4ZhMEPFMA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@jeshoots?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a>在<a class="ae ky" href="https://unsplash.com/s/photos/fifa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><h1 id="8d3c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">路标</h1><ul class=""><li id="b06c" class="lr ls it lt b lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated"><strong class="lt iu">简介</strong></li><li id="51b8" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><strong class="lt iu">数据探索</strong></li><li id="96ba" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><strong class="lt iu">玩家分类<br/>1</strong>—<strong class="lt iu"/>K-最近邻<br/> <strong class="lt iu"> 2 </strong> — <strong class="lt iu"> </strong>决策树分类器<br/> <strong class="lt iu"> 3 </strong> — <strong class="lt iu"> </strong>支持向量机<br/> <strong class="lt iu"> 4 </strong> — <strong class="lt iu"> </strong>逻辑回归</li><li id="b266" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><strong class="lt iu">结果</strong></li><li id="5d11" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><strong class="lt iu">结论</strong></li></ul><h1 id="3017" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="e80e" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">FIFA 是一款足球模拟游戏，由电子艺界公司每年发行，游戏的主角当然是足球运动员。电子游戏中的玩家希望在身体和技能上尽可能接近真实的玩家。这套技能决定了他们在场上的位置。你当然要杀手前锋，要人墙当守门员！</p><h2 id="37d4" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">目标</h2><p id="f8b7" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">如果你是一个足球迷，你很可能知道每个球员在你最喜欢的球队中的位置。机器可以根据不同玩家的技能来学习他们的位置吗？</p><h2 id="2928" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">获取数据</h2><p id="eb28" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">数据是从<a class="ae ky" href="https://www.kaggle.com/stefanoleone992/fifa-20-complete-player-dataset?select=players_20.csv" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载的，这些数据是从公开网站<a class="ae ky" href="https://sofifa.com" rel="noopener ugc nofollow" target="_blank"> sofifa </a>上刮下来的。</p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="893e" class="kz la it bd lb lc nu le lf lg nv li lj jz nw ka ll kc nx kd ln kf ny kg lp lq bi translated">数据探索</h1><p id="acdc" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">第一步是下载资料，先看看球员的一些信息。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="5292" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">现在让我们来看看哪些球员会让一家俱乐部支付“最高价”。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="9092" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">这两个球员肯定贵，但是哪个俱乐部平均花费最多呢？为了说明这一点，球员按俱乐部分组，然后从“价值欧元”和“工资欧元”栏中取平均值。</p><p id="7727" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">让我们来看看拥有最有价值球员的前 10 家俱乐部和支付最高工资的前 10 家俱乐部。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/1d24c4600354c66a2654ae3d14fb17fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c_newRoY8EiJvD_c49abwg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">球员平均价值(作为参考，第一个价值是 2990 万欧元)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/60694e5874e8ace9941e01ef784e5e6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5-qLXW70bbs1P_-Qp-8D7Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">支付给球员的平均工资(作为参考，第一个数值是 16.22 万欧元)</p></figure><p id="876e" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">现在让我们来看看拥有顶级球员的俱乐部。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/6ada8cd50c5ee677e8b30423d7d07631.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JmMq02-7au6IZ1mhd8d4kA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">总体平均玩家</p></figure><blockquote class="oh oi oj"><p id="6acf" class="mo mp ok lt b lu ob ju mq lw oc jx mr ol od mt mu om oe mw mx on of mz na me im bi translated">注意:这并不一定转化为最佳球队的图表，因为一些俱乐部可能比其他俱乐部拥有更多的替补或替补球员，尽管如此，这是一个有趣的结果。</p></blockquote><p id="397d" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">FIFA 20 上拥有更多联赛的国家是英格兰，毫不奇怪他们拥有游戏中最多的球员。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="6b08" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">下面的直方图显示了一些有趣的见解:</p><ul class=""><li id="2efd" class="lr ls it lt b lu ob lw oc ly oo ma op mc oq me mf mg mh mi bi translated">大多数运动员都是右脚运动员。</li><li id="cd51" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">左尾巴在总体 50 左右急剧减少(考虑到这些是职业队的球员，它不应该再向左走了，对吗？).</li><li id="4e36" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">右尾巴很长，代表少数杰出的玩家。</li><li id="7bc9" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">球场中央比两端更“忙”，中场和后卫比前锋和守门员多。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/c9c53d9a7578185fe6058cb2825bb650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uhx2XvMSv5Ey-miAkWgipA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从左至右:进攻队员、中场队员、防守队员和守门员</p></figure><p id="711f" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">上面的直方图是按球员位置划分的，我们可以看看“整体”得分的大致分布。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="b41f" class="kz la it bd lb lc nu le lf lg nv li lj jz nw ka ll kc nx kd ln kf ny kg lp lq bi translated">数据预处理</h1><h2 id="f6b1" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">玩家位置</h2><p id="f704" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">如果我们看看球员的位置，我们注意到球员有一个位置，其他人有两个，有些人甚至三个！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="0fef" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">就该项目的范围而言，职位将分为四类:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/8a0129e56ac2a8f612c4437073196e57.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*s5vNDQFICtlgplRCbrclew.png"/></div></figure><ul class=""><li id="430c" class="lr ls it lt b lu ob lw oc ly oo ma op mc oq me mf mg mh mi bi translated">进攻者:圣西罗，LW，RW，CF</li><li id="89f5" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">中场:凸轮，LM，CM，RM，CDM</li><li id="a7c5" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">后卫:LWB，RWB，LB，CB，RB</li><li id="25e9" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">守门员:GK</li></ul><p id="ac88" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">在制作任何模型之前，正确地将玩家分类是重要的一步。让我们以玩家“41”为例，这个玩家有三个位置:</p><ul class=""><li id="f95c" class="lr ls it lt b lu ob lw oc ly oo ma op mc oq me mf mg mh mi bi translated">RW —攻击者</li><li id="66f2" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">CAM —中场</li><li id="755a" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">CM —中场</li></ul><p id="1180" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">如果我们只为每个球员选择第一个位置，这个“41”球员将被认为是一个“攻击手”，然而，他也踢其他两个位置，都是“中场”。所以更好的方法是把这个球员看作中场球员。为了实现这一点，我们创建了以下函数，并将其应用于“player_positions”列。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h2 id="0b0d" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">拆分数据</h2><p id="6363" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">创建了一个新的数据帧，该数据帧将只包含有用的列，这些列在下面显示为空值的数量。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="ee52" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">我们的数据帧中有 0 个空值，所以我们可以继续。</p><p id="6e83" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">数据值将被相应地分配，预测值(X)和目标值(y)，然后它将被分成训练和测试。</p><ul class=""><li id="f884" class="lr ls it lt b lu ob lw oc ly oo ma op mc oq me mf mg mh mi bi translated">x 将包括玩家的所有技能。</li><li id="0a5c" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">y 将包括玩家位置。</li></ul><p id="8164" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">来自 train_test_split 的输入:</p><ul class=""><li id="172e" class="lr ls it lt b lu ob lw oc ly oo ma op mc oq me mf mg mh mi bi translated">test _ size = 0.2 训练数据将占 80%，测试将占 20%。</li><li id="0d50" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">random_state=42 —用于播种新的 RandomState 对象。</li><li id="cc3c" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">分层= y-使分割的值成比例。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="88a4" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">虽然数据的标准化是一个重要的预处理，但这将结合每个机器学习模型来执行，并通过管道进行交叉验证，以避免泄漏。</p><p id="4f4c" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">那么这些术语是什么呢？下面是对每一个的简要说明:</p><h2 id="d326" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">数据泄露</h2><p id="c613" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">当来自训练数据集之外的信息用于创建模型时。</p><h2 id="de57" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">标准化</h2><p id="d8e1" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">数据标准化是重新调整一个或多个属性的过程，使它们的平均值为 0，标准差为 1。</p><h2 id="e8b7" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">管道</h2><p id="28fd" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">根据 scikit-learn 文档:<br/>依次应用一系列转换和一个最终估计器。管道的中间步骤必须是“转换”，也就是说，它们必须实现 fit 和 transform 方法。最终的估计器只需要实现 fit。</p><p id="c951" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">管道的目的是组装几个步骤，这些步骤可以在设置不同参数的同时进行交叉验证。</p><h2 id="fa94" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">k 倍交叉验证</h2><p id="ebe1" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">将数据分为训练和测试对于监督学习是必要的，然而，模型的结果将基于这种唯一的划分。这个问题的解决方案是一个叫做 k-fold 交叉验证的过程，其中数据被分成<em class="ok"> k </em>个更小的集合。训练数据将是<em class="ok"> k-1 </em>个折叠，剩余的折叠将用于验证，跨 k 个折叠的验证结果的平均值将是性能测量。</p><p id="6d70" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">这个过程在计算上可能是昂贵的，但是它有助于避免过拟合或选择偏差。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/f8a4a77c64c1867fe22aaec443301020.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fW_qNKmvmg8duWoQnp_PoQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">k 倍交叉验证的可视化。图片来自<a class="ae ky" href="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/K-fold_cross_validation_EN.svg/250px-K-fold_cross_validation_EN.svg.png" rel="noopener ugc nofollow" target="_blank">维基百科</a>。</p></figure></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="642e" class="kz la it bd lb lc nu le lf lg nv li lj jz nw ka ll kc nx kd ln kf ny kg lp lq bi translated">玩家分类</h1><p id="0df8" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">在跳入不同的机器学习模型对球员位置进行分类之前，我们先来看看球员属性之间的关联矩阵。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/1dee4f3bdc048281149559e8a665971d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PGbDPgmlBDXSdUa-ELN-KQ.png"/></div></div></figure><p id="af07" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">通过查看这张热图，我们可以假设模型应该很容易识别守门员，让我们看看他们的表现如何。</p><blockquote class="oh oi oj"><p id="0c07" class="mo mp ok lt b lu ob ju mq lw oc jx mr ol od mt mu om oe mw mx on of mz na me im bi translated">注意:对每种分类算法都会有一个简短的解释，对每种算法的更深入的研究超出了本文的范围。给出的解释应该足以理解显示的代码。</p></blockquote><h2 id="263b" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">k-最近邻</h2><p id="dbdc" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">通过其邻居的多数投票对对象进行分类，将该对象分配到其<em class="ok"> k </em>个最近邻居中最常见的类别。如果<em class="ok"> k </em> = 1，那么该对象被简单地分配给该单个最近邻的类。</p><p id="138b" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">下图显示了该算法如何工作的示例。绿点是测试对象。如果<em class="ok"> k </em> = 3，它将被分类为红色三角形，因为有两个红色三角形对着一个蓝色正方形(圆形区域)。如果<em class="ok"> k </em> = 5，它现在将被分类为蓝色方块，因为这些“邻居”现在占大多数(虚线圆圈区域)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/ab0144dc0196347e5bd4918d95e53988.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*lIO9fY5z6Y414tLetYpZyA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">k 近邻可视化。图片来自<a class="ae ky" href="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e7/KnnClassification.svg/220px-KnnClassification.svg.png" rel="noopener ugc nofollow" target="_blank">维基百科</a>。</p></figure><p id="060e" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">下面的代码结合了我们到目前为止读到的内容:</p><ul class=""><li id="776b" class="lr ls it lt b lu ob lw oc ly oo ma op mc oq me mf mg mh mi bi translated">数据标准化。</li><li id="0f18" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">使用管道连接 ML 流程的不同“部分”(及其相应的参数)。</li><li id="afb5" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">用<em class="ok"> k </em> -folds ( <em class="ok"> k </em> = 5)通过数据进行交叉验证。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="6957" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">结果是具有相应最佳参数的交叉验证平均值。现在我们可以拟合模型并做出预测。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="05e9" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">一个可视化算法性能的有用工具是混淆矩阵。这个二维表格显示了球员的标签。标准化以百分比显示分类，非标准化以玩家数量显示分类。例如:</p><ul class=""><li id="e4c4" class="lr ls it lt b lu ob lw oc ly oo ma op mc oq me mf mg mh mi bi translated">510 名(73%)攻击者被正确分类。</li><li id="554a" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">180 名(26%)攻击手被归类为中场。</li><li id="eb5a" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">8 名(1.1%)攻击者被归类为防御者。</li><li id="7f54" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">0 (0%)名攻击者被归类为守门员。</li></ul><p id="6b6f" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">对每个位置依此类推。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/ba7161ec30ed02f53dba55a11329a0a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KR06rP_Bzv5fwC2wNSWbbw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">k-最近邻混淆矩阵</p></figure></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h2 id="470c" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">决策树分类器</h2><p id="ffda" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">一种结构，其中每个内部节点表示对一个属性的“测试”，每个分支表示测试的结果，每个叶节点表示一个类标签。DTC 的组成:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/dcdff40d1da605460a56bb35a36b2f76.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*wSplOmUlXFJ8tcXIx9fhyA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">泰坦尼克号上乘客的生存。</p></figure><ul class=""><li id="3e16" class="lr ls it lt b lu ob lw oc ly oo ma op mc oq me mf mg mh mi bi translated"><strong class="lt iu">决策节点:</strong>顾名思义，代表一个预测变量的一个决策点，它将导向目标变量。<br/>(例子——性别)</li><li id="63bf" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><strong class="lt iu">分支:</strong>节点之间的连接，用箭头表示。每个分支代表一个响应。<br/>(示例—男性/女性)</li><li id="a4e2" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><strong class="lt iu">叶节点:</strong>叶节点或终止节点代表结果的最终类别。<br/>(示例—死亡/幸存)</li></ul><blockquote class="oh oi oj"><p id="6140" class="mo mp ok lt b lu ob ju mq lw oc jx mr ol od mt mu om oe mw mx on of mz na me im bi translated">注意:对于我们的数据，决策节点将是预测器，分支将是“≤ <em class="it"> X </em>”，叶节点将是玩家位置。<br/>比如“技能 _ 运球”≤ 55.0 →后卫。</p></blockquote><p id="89d6" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">同样，我们使用管道来获得算法的最佳参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="9707" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">我们能确定这些是最好的参数吗？下面的代码展示了如何在每个 GridSearchCV 中获得最佳参数的“幕后”演示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="8e08" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">我们可以看到，在 24 种不同的可能性中，<code class="fe oy oz pa pb b">(8, 'gini')</code>的得分最高<code class="fe oy oz pa pb b">(0.858638...)</code>。既然我们有了最好的参数，就可以拟合这个模型了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“gini”是默认参数。</p></figure><p id="da4f" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">看一下各自的混淆矩阵。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/9f920064ea6984c5f80dd53a352d996f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8c6_jBZT8qNmsOJfskVjaA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">决策树分类器混淆矩阵</p></figure></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h2 id="5563" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">支持向量机</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/b70625587d1c7f7f29a951a9582db385.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*vF6pfpO-72RDzeFJB9YB8A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">MathWorks 中的例子。</p></figure><p id="373a" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">这种算法是基于寻找一个能最好地分割数据的超平面的思想。目标是找到一个在观察值(支持向量)和超平面之间具有最大可能余量(距离)的超平面，从而有更大的机会正确识别新数据。如果输入特征的数量是两个，那么超平面只是一条线，如果输入特征的数量是三个，那么超平面变成一个二维平面。当特征的数量超过三个时，就很难想象了。这个想法是，数据将继续被映射到越来越高的维度，直到可以形成一个超平面来隔离它。</p><p id="1935" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">多类问题被分解为多个二元分类案例，也称为<em class="ok">一对一</em>。它将数据集拆分为每个类的一个数据集，而不是每隔一个类。</p><ul class=""><li id="03d2" class="lr ls it lt b lu ob lw oc ly oo ma op mc oq me mf mg mh mi bi translated"><strong class="lt iu">二元分类问题 1</strong>:ATT vs MID</li><li id="80c7" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><strong class="lt iu">二元分类问题 2 </strong> : ATT vs. DEF</li><li id="f427" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><strong class="lt iu">二元分类问题 3</strong>:ATT vs GK</li><li id="9150" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><strong class="lt iu">二进制分类问题 4 </strong> : MID vs. DEF</li><li id="8d01" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><strong class="lt iu">二进制分类问题 5</strong>:MID vs GK</li><li id="2552" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated"><strong class="lt iu">二元分类问题 6 </strong> : DEF vs. GK</li></ul><p id="f99d" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">每个二元分类模型可以预测一个类别标签，并且通过一对一策略预测具有最多预测或投票的模型。</p><blockquote class="oh oi oj"><p id="e892" class="mo mp ok lt b lu ob ju mq lw oc jx mr ol od mt mu om oe mw mx on of mz na me im bi translated">注:为了更好地掌握算法，吴恩达的<a class="ae ky" href="http://cs229.stanford.edu/notes/cs229-notes3.pdf" rel="noopener ugc nofollow" target="_blank">笔记</a>非常精彩。</p></blockquote><p id="ce63" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">再次，获得最佳参数并拟合模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在这种情况下，最好的参数是缺省值，所以不需要键入它们。</p></figure><p id="e75f" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">相应的混淆矩阵。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/e15763315f035f5b9b37439e097a6e52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0DaKu65qKpVTrD7jHcOe2A.png"/></div></div></figure></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h2 id="79fa" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">逻辑回归</h2><p id="4cd1" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">该模型用于在给定一组特征(预测因子)的情况下预测二元结果。分类器输出(目标)可以是 1 或 0。我们正在寻找一个观察值是(1 <em class="ok"> ) </em>还是不是(0 <em class="ok"> ) </em>类的一部分的概率。</p><p id="fed8" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">简而言之，它获取特征，将每个特征乘以一个权重，对它们求和，然后将和通过一个 sigmoid 函数来生成一个概率并分配一个类别。权重(向量<em class="ok"> w </em>和偏差<em class="ok"> b </em>)通过损失函数(交叉熵损失)从标记的训练集中学习。</p><p id="b7d7" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">我们的数据有两个以上的目标，所以我们使用多项式逻辑回归，它使用了 sigmoid 的推广，称为 softmax 函数。</p><blockquote class="oh oi oj"><p id="e438" class="mo mp ok lt b lu ob ju mq lw oc jx mr ol od mt mu om oe mw mx on of mz na me im bi translated">注意:同样，这是一个非常简单的算法，在这里可以找到更多的<a class="ae ky" href="https://web.stanford.edu/~jurafsky/slp3/5.pdf" rel="noopener ugc nofollow" target="_blank"/>。</p></blockquote><p id="f97e" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">老样子，老样子，用管道获取最佳参数，拟合模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><blockquote class="oh oi oj"><p id="811d" class="mo mp ok lt b lu ob ju mq lw oc jx mr ol od mt mu om oe mw mx on of mz na me im bi translated">注意:参数<code class="fe oy oz pa pb b"><em class="it">multi_class</em></code>默认设置为“auto ”,如果数据不是二进制，则选择“多项式”。如果选择了“多项式”,则 softmax 函数用于查找每个类别的预测概率以分配目标。</p></blockquote><p id="3774" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">最后混淆矩阵。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/9f719cc6556b3978416209add3ce9aa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zsyfgy9kliWbUPASGErjEw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">逻辑回归混淆矩阵</p></figure></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="712f" class="kz la it bd lb lc nu le lf lg nv li lj jz nw ka ll kc nx kd ln kf ny kg lp lq bi translated">结果</h1><p id="95f1" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">正如所料，所有不同的模型都可以很容易地识别守门员，他们拥有的大多数技能似乎与其他技能呈负相关，并且彼此之间有很强的相关性。</p><p id="1d3b" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">我们已经看到了不同的混淆矩阵，让我们最后看一下一些主要的分类指标。这些是通过<code class="fe oy oz pa pb b">classification_report</code>和<code class="fe oy oz pa pb b">accuracy_score</code>从<code class="fe oy oz pa pb b">sklearn.metrics</code>图书馆获得的。为简单起见，所有报告都放在一个图像中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/25766b6be193bb2c669ac2e134f2297a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d2z3x9BnDKfgsTL4l19sJw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">算法分类报告和准确度分数</p></figure><p id="aa2c" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">SVM 似乎是最准确的算法来确定球员的位置。然而，还有其他重要的指标。把一个进攻者放在防守者的位置上，也许不是世界末日，但肯定不会有那么好的表现。让我们看看这些有用的指标带来了什么。</p><h2 id="76eb" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">准确(性)</h2><p id="48a1" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">预测值与实际目标的接近程度。</p><h2 id="86e9" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">精确</h2><p id="d6d0" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">检索到的实例中相关实例的比例。(归一化混淆矩阵的对角线值)。<br/>有多少选择的项目是相关的？</p><h2 id="32c4" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">回忆</h2><p id="f8b1" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">实际检索的相关实例总数的一部分。<br/>选择了多少个相关项目？</p><h2 id="af4d" class="nb la it bd lb nc nd dn lf ne nf dp lj ly ng nh ll ma ni nj ln mc nk nl lp nm bi translated">f 分数</h2><p id="bbf2" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">精确度和召回率调和平均值。</p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="a7d6" class="kz la it bd lb lc nu le lf lg nv li lj jz nw ka ll kc nx kd ln kf ny kg lp lq bi translated">结论</h1><p id="9d21" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">有几个监督算法，这个故事显示了其中一些一目了然。数据的正确预处理以及参数的正确选择对于每个算法都至关重要。</p><p id="ee5d" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">在选择哪种算法性能更好时，记住这一点很重要:</p><ul class=""><li id="0238" class="lr ls it lt b lu ob lw oc ly oo ma op mc oq me mf mg mh mi bi translated">当假阳性的成本很高时，精度是一个很好的模型度量。</li><li id="f1dd" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">当存在与假阴性相关联的高成本时，召回是一个好的模型度量。</li><li id="cfd7" class="lr ls it lt b lu mj lw mk ly ml ma mm mc mn me mf mg mh mi bi translated">如果我们需要在精确度和召回率之间寻求平衡，F-score 可能是一个更好的模型度量。</li></ul><p id="20c6" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">另一个有时被忽视的重要指标是时间！是的，你想要一个精确的模型，但是一些模型花费更多的时间来获得一点点的精确度。举例来说，SVM 的准确率比逻辑回归高 0.95%，然而，寻找 LogReg 的最佳参数比 SVM 快 6.6 倍(两者最初都是为二元分类设计的)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">以秒为单位的时间。</p></figure><p id="07a0" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated">在某些情况下，1%可能是一个显著的差异，但有时为了获得更快的结果，放弃那个百分比也没关系。选择最佳算法取决于数据的属性。</p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><h1 id="3f1d" class="kz la it bd lb lc nu le lf lg nv li lj jz nw ka ll kc nx kd ln kf ny kg lp lq bi translated">参考</h1><p id="23f3" class="pw-post-body-paragraph mo mp it lt b lu lv ju mq lw lx jx mr ly ms mt mu ma mv mw mx mc my mz na me im bi translated">Jurafsky，d .和 Martin，j .，2019。<em class="ok">语音和语言处理</em>。第三版。第 75-93 页。</p><p id="6ee0" class="pw-post-body-paragraph mo mp it lt b lu ob ju mq lw oc jx mr ly od mt mu ma oe mw mx mc of mz na me im bi translated"><a class="ae ky" href="http://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html" rel="noopener ugc nofollow" target="_blank">sci kit-learn:Python 中的机器学习</a>，Pedregosa <em class="ok">等人</em>，JMLR 12，第 2825–2830 页，2011 年。</p></div></div>    
</body>
</html>