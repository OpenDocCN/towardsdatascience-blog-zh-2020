<html>
<head>
<title>System Design Interview Prep: Should You Put the Data in Cache?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">系统设计面试准备:你应该把数据放在缓存中吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/system-design-interview-prep-should-you-put-the-data-in-cache-56936697ee54?source=collection_archive---------32-----------------------#2020-04-09">https://towardsdatascience.com/system-design-interview-prep-should-you-put-the-data-in-cache-56936697ee54?source=collection_archive---------32-----------------------#2020-04-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/b59fc144f286585873466521b334c4d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Uy-zVmk6qgUXL2En"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">约书亚·索蒂诺在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="c5bb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">(这个帖子也在<a class="ae kf" href="https://kylelix7.github.io/" rel="noopener ugc nofollow" target="_blank">我的博客</a>里)</p><p id="19f0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">缓存是一种以相对较快的速度提供数据的数据存储。有硬件和软件缓存。在系统设计面试中，我们将主要关注软件缓存。在许多情况下，缓存是存储数据的内存块。由于访问内存的速度比磁盘和网络等IO快得多，应用程序可以将数据放在内存中以避免访问IO。因此，吞吐量可以增加，延迟可以减少。</p><h1 id="75d3" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">并非所有数据都适合缓存</h1><p id="a6d0" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">缓存存储在内存中，它通常比持久性存储(如磁盘)小得多。因此，如果您的应用程序需要处理大量数据，将所有内容都存储在缓存中是不现实的。只有一小部分数据应该放在缓存中。当数据可以在缓存中找到时，它被称为缓存命中。如果没有，则称为缓存未命中。</p><p id="b21b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于系统设计人员来说，找出哪些数据需要放在缓存中是至关重要的。不难发现，只有经常被请求的热数据才应该留在缓存中。以设计脸书为例，帖子必须比用户简介更热门。而那些名人的帖子，一定比那些普通用户要火得多。所以，你应该在面试中优先考虑这个问题。</p><h1 id="d287" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">并非所有应用程序都应该有缓存</h1><p id="7f0d" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">重要的是要知道，在所有类型的系统中，高速缓存都不会增加吞吐量。在某些情况下，它会对系统产生负面影响。例如，如果您的系统需要频繁更新或写入数据，缓存中的数据也需要不断变化。这会导致缓存大量失效。因此，应用程序需要将缓存中的数据标记为无效。此外，它还需要将更新后的数据写入其对应的持久性数据存储。在这个例子中，高速缓存的失效成为一个开销。因此，缓存只对那些读取量大而写入量小的应用程序有益。</p><h1 id="4730" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">缓存写入策略</h1><p id="4091" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">当应用程序需要更新数据时，它需要:</p><ol class=""><li id="4b28" class="mh mi it ki b kj kk kn ko kr mj kv mk kz ml ld mm mn mo mp bi translated">更新持久数据存储中的数据。</li><li id="8878" class="mh mi it ki b kj mq kn mr kr ms kv mt kz mu ld mm mn mo mp bi translated">无效或更新缓存中的数据。有几种类型的缓存写入策略。</li></ol><p id="6ce7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">直写</strong>:将新数据同步写入缓存和后台数据存储。</p><p id="d9d9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">优点是数据在后备和缓存上都是一致的。即使停电，数据更新也不会丢失。</p><p id="0469" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">缺点是花费在写入上的时间要长得多，因为它不需要写入非常慢的持久数据存储。</p><p id="8591" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">回写:</strong>先写入缓存。在数据被替换之前，它不会写入后备数据存储。</p><p id="f0c8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">优点是写更快，因为不需要更新后备数据存储。</p><p id="0814" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">缺点是它可能会丢失更新。此外，实现更加复杂，因为它需要跟踪哪个缓存块在缓存中被更新，但尚未写入磁盘。这种类型的缓存块称为脏块。</p><h1 id="05d3" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">缓存替换策略</h1><p id="1d2e" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">因为缓存很小，只保存一小部分热数据，所以它可能会超出限制。在这种情况下，当一个新请求到来时，如果出现缓存未命中，我们将需要为新数据逐出一个块。这个过程就是呼叫替换。有许多算法用于高速缓存替换，以找到要驱逐的高速缓存块。最佳策略取决于应用程序的用途。我在这里介绍两个著名的政策。</p><p id="db95" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">最近最少使用，LRU </strong>，它丢弃最近最少使用的数据。在这个策略中，需要跟踪“何时”。</p><p id="4511" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">最不常用，LFU，</strong>丢弃最不常用的数据。使用计数被跟踪。</p><h1 id="c99b" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">摘要</h1><p id="c2a3" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">缓存是优化读取密集型应用程序的一种方式。它通过将相对少量的热数据放入内存来提高吞吐量并减少延迟，以便数据访问可以避免命中磁盘。根据您的应用程序，您可能需要相应地选择写策略和缓存替换策略，以获得最佳性能。要了解有关系统设计的更多信息，您可以在<a class="ae kf" href="https://www.educative.io/courses/grokking-the-system-design-interview?aff=VEzk" rel="noopener ugc nofollow" target="_blank">探索系统设计</a>和<a class="ae kf" href="https://amzn.to/3w3KfLK" rel="noopener ugc nofollow" target="_blank">设计数据密集型应用</a>中找到更多信息。</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/591f0ff43d4d36b3169b36f272d1abd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*o6us0p9r74ZRawgB1Sc5nQ.jpeg"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi na"><img src="../Images/b54788e5e4dc29d7866aa5d166f74572.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*FEzPtf10dIsAgllla4jWQg.jpeg"/></div></figure></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="b295" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我的其他帖子</p><p id="bf18" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://blog.usejournal.com/system-design-interview-prep-how-to-handle-long-running-job-asynchronously-with-long-polling-34d8b2a890e1" rel="noopener ugc nofollow" target="_blank">系统设计面试:如何设计一个系统来处理长时间运行的作业</a></p><p id="4eba" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/ace-system-design-interview-in-faang-d9e479e25bf0?source=your_stories_page---------------------------">FAANG Ace系统设计面试</a></p><p id="ebf1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/how-i-leetcode-for-6-months-and-land-a-job-at-amazon-b76bdfc79abb?source=your_stories_page---------------------------">我如何获得6个月的代码并获得FAANG offer </a></p><p id="246e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/these-are-all-the-resources-that-help-me-land-a-fang-job-452341dd6bed?source=your_stories_page---------------------------">这些都是帮我找到方工作的资源</a></p><p id="fc33" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://medium.com/@fin.techology/system-design-interview-prep-how-to-handle-long-running-job-asynchronously-with-long-polling-34d8b2a890e1" rel="noopener">系统设计面试准备:如何用长轮询、发布订阅和队列异步处理长时间运行的作业</a></p><p id="cbc3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/steps-to-ace-the-system-design-interview-1908ffb77b9b?source=your_stories_page---------------------------">系统设计面试的成功步骤</a></p><p id="d86b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/sql-relational-database-or-nosql-ace-the-faang-system-design-interview-2d17439ecb3b?source=your_stories_page---------------------------"> SQL(关系数据库)还是NoSQL？the FAANG系统设计面试</a></p><p id="503d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/efficient-frontier-optimize-portfolio-with-scipy-57456428323e?source=your_stories_page---------------------------">利用Scipy实现最小风险的投资组合优化—有效边界解释</a></p><p id="a5a1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/trading-strategy-technical-analysis-with-python-ta-lib-3ce9d6ce5614?source=your_stories_page---------------------------">交易策略:Python TA-Lib技术分析</a></p><p id="df51" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/trading-strategy-back-testing-with-backtrader-6c173f29e37f?source=your_stories_page---------------------------">交易策略:与反向交易者进行反向测试</a></p><p id="245e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/how-is-millennials-investment-choice-compared-to-motley-fool-stock-advisor-6bfe6dbf9cc1?source=your_stories_page---------------------------">千禧一代对Robinhood的投资选择vs. Motley Fool股票顾问</a></p><p id="206e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/reducing-risk-by-building-portfolio-8772d1ce0f21?source=your_stories_page---------------------------">组合风险股票投资，降低风险</a></p><p id="462d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/trading-technical-analysis-with-pandas-43e737a17861?source=your_stories_page---------------------------">交易:用熊猫计算技术分析指标🐼</a></p><p id="4f3f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/collect-trading-data-with-pandas-library-8904659f2122?source=your_stories_page---------------------------">用熊猫库获取交易数据🐼</a></p><p id="977d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/looking-for-jobs-in-canada-major-banks-bank-job-club-give-you-insight-hot-it-skills-there-3ded1b24426d?source=your_stories_page---------------------------">在加拿大各大银行找工作？银行求职俱乐部给你洞察热门IT技能那里</a></p><p id="9cbe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://medium.com/@fin.techology/from-crud-app-dev-to-sde-in-voice-assistant-my-ongoing-journey-to-ml-4ea11ec4966e" rel="noopener">从CRUD web应用开发到语音助手中的SDE——我正在进行的机器学习之旅</a></p><p id="02f0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/full-stack-development-tutorial-integrate-aws-lambda-serverless-service-into-angular-spa-abb70bcf417f">全栈开发教程:将AWS Lambda无服务器服务集成到Angular SPA中</a></p><p id="ea5c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/full-stack-development-tutorial-serverless-rest-api-running-on-aws-lambda-a9a501f54405">全栈开发教程:用运行在AWS Lambda上的无服务器REST API提供交易数据</a></p><p id="5de6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" rel="noopener" target="_blank" href="/full-stack-development-tutorial-visualize-trading-data-on-angular-spa-7ec2a5749a38">全栈开发教程:在Angular SPA上可视化交易数据</a></p><p id="2cc0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://medium.com/@kyle.jinhai.li/reinforcement-learning-introduction-to-q-learning-444c951e292c" rel="noopener">强化学习:Q学习简介</a></p></div></div>    
</body>
</html>