<html>
<head>
<title>A Marijuana Recommendation System Using TF-IDF and k-NN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于 TF-IDF 和 k-NN 的大麻推荐系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-marijuana-recommendation-system-using-tf-idf-and-k-nn-bd472242cb3f?source=collection_archive---------26-----------------------#2020-03-09">https://towardsdatascience.com/a-marijuana-recommendation-system-using-tf-idf-and-k-nn-bd472242cb3f?source=collection_archive---------26-----------------------#2020-03-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div class="gh gi ir"><img src="../Images/52142fae44a8497e3652e55326171826.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*eyuTVvAdCRc7NakeXXRqFg.jpeg"/></div></figure><div class=""/><div class=""><h2 id="8448" class="pw-subtitle-paragraph jx iz ja bd b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dk translated">使用 NLP、TF-IDF、k-NN、Pickling 和 Dash 的内容推荐系统</h2></div><p id="2b49" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">基于内容的推荐系统利用用户提供的数据为用户生成推荐。推荐系统可以用于为用户个性化信息，并且通常用于推荐电影、书籍、餐馆以及其他产品和服务。</p><p id="d131" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">使用下面的大麻推荐系统或此处的链接<a class="ae ll" href="https://strains-live.herokuapp.com" rel="noopener ugc nofollow" target="_blank"/>，我们将使用用户选择的效果和口味从 2300 多种大麻品种中推荐五种大麻品种。在我们的例子中，产品是大麻，特征是效果和味道的列表。</p><p id="ab40" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><a class="ae ll" href="https://strains-live.herokuapp.com" rel="noopener ugc nofollow" target="_blank"> <strong class="kr jb">点击此处查看大麻推荐系统网页 App </strong> </a></p><figure class="ln lo lp lq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lm"><img src="../Images/172922947f95dee024cb394952d0116f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sKqxhHGZkA7ZtmgIEp-3LA.png"/></div></div></figure><p id="a32d" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">该项目的所有代码、数据和相关文件都可以在 my <a class="ae ll" href="https://github.com/JimKing100/strains-live" rel="noopener ugc nofollow" target="_blank"> GitHub </a>访问。自述文件提供了 repo 目录和文件的详细信息。</p><p id="b175" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr jb">采用 k-NN 的 TF-IDF 模型</strong></p><p id="96f8" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">TF-IDF 指术语频率-逆文档频率。TF 就是一个单词在文档中出现的频率。IDF 是整个文档语料库中的文档频率的倒数。TF-IDF 背后的思想是在确定一个项目(文档)的重要性时抑制高频词的影响。</p><p id="337b" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">k-NN 指的是 K 最近邻，是一种简单的算法，在我们的例子中，它基于相似性度量对数据进行分类。换句话说，它为我们的用户输入选择“最接近”的匹配。</p><p id="143b" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">让我们使用<a class="ae ll" href="https://github.com/JimKing100/strains-live/blob/master/model/tf_knn.ipynb" rel="noopener ugc nofollow" target="_blank"> tf_knn.ipynb </a>笔记本浏览一个示例。基本步骤是:</p><ol class=""><li id="0413" class="lv lw ja kr b ks kt kv kw ky lx lc ly lg lz lk ma mb mc md bi translated">加载、清理和争论数据</li><li id="1111" class="lv lw ja kr b ks me kv mf ky mg lc mh lg mi lk ma mb mc md bi translated">对要素进行符号化和矢量化</li><li id="a093" class="lv lw ja kr b ks me kv mf ky mg lc mh lg mi lk ma mb mc md bi translated">创建文档术语矩阵(DTM)</li><li id="eeea" class="lv lw ja kr b ks me kv mf ky mg lc mh lg mi lk ma mb mc md bi translated">将最近邻模型拟合到 DTM</li><li id="7745" class="lv lw ja kr b ks me kv mf ky mg lc mh lg mi lk ma mb mc md bi translated">从模型中获取建议</li><li id="0c46" class="lv lw ja kr b ks me kv mf ky mg lc mh lg mi lk ma mb mc md bi translated">泡菜 DTM 和矢量器</li></ol><p id="942c" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr jb">加载、清理和整理数据</strong></p><p id="0895" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">大麻品种数据来自 Kaggle 的 LiamLarsen 的大麻品种数据库。数据被加载到数据帧中，带有 nans 的菌株被删除(少量&lt; 70)，效果和风味特征被合并到一个标准特征中。</p><pre class="ln lo lp lq gt mk ml mm mn aw mo bi"><span id="ea59" class="mp mq ja ml b gy mr ms l mt mu">df = pd.read_csv(“<a class="ae ll" href="https://raw.githubusercontent.com/JimKing100/strains-live/master/data/cannabis.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/JimKing100/strains-live/master/data/cannabis.csv</a>")<br/>df = df.dropna()<br/>df = df.reset_index(drop=True)<br/>df[‘Criteria’] = df[‘Effects’] + ‘,’ + df[‘Flavor’]</span></pre><figure class="ln lo lp lq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi mv"><img src="../Images/7b46a02d262fd0c4e856b9ae3c0c137a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zldl92p3vnUxR2x20fI0Gw.png"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">原始数据</p></figure><p id="2819" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr jb">对特征进行符号化和矢量化</strong></p><p id="1113" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">效果和风味特征非常清晰，由 16 种独特的效果和 50 种独特的风味组成。我们在 TfidVectorizer 中使用了默认的标记器来标记特征，但是如果我们想从大量的文本描述中提取特征，我们可能会使用自定义的标记器。然后我们实例化矢量器。</p><pre class="ln lo lp lq gt mk ml mm mn aw mo bi"><span id="0e0b" class="mp mq ja ml b gy mr ms l mt mu">tf = TfidfVectorizer(stop_words=’english’)</span></pre><p id="d96e" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr jb">创建文档术语矩阵</strong></p><p id="3fda" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">特征(标准)然后被矢量化(拟合/转换)成文档术语矩阵(dtm)。dtm 是一个矩阵，每个要素在一列中，每个“计数”在每一行中。该计数是 tf-idf 值。下图显示了矢量化矩阵。</p><pre class="ln lo lp lq gt mk ml mm mn aw mo bi"><span id="2e39" class="mp mq ja ml b gy mr ms l mt mu">dtm = tf.fit_transform(df[‘Criteria’].values.astype(‘U’))<br/>dtm = pd.DataFrame(dtm.todense(), columns=tf.get_feature_names())</span></pre><figure class="ln lo lp lq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi na"><img src="../Images/9a9031f902176d17557c15e7f3e736b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFigz6G0Zp0bem2PK2KYBQ.png"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">文档术语矩阵(dtm)</p></figure><p id="2224" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr jb">拟合最近邻模型</strong></p><p id="3a78" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">然后实例化最近邻模型，并且 dtm 适合该模型。这是我们用来选择前五名推荐的推荐模型。</p><pre class="ln lo lp lq gt mk ml mm mn aw mo bi"><span id="4176" class="mp mq ja ml b gy mr ms l mt mu">nn = NearestNeighbors(n_neighbors=5, algorithm=’ball_tree’)<br/>nn.fit(dtm)</span></pre><p id="8712" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr jb">获得推荐</strong></p><p id="3e79" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">理想应变测试数据变量代表用户期望的 8 个特征。前五个特征是效果，后三个特征是味道。然后将变量矢量化，并在模型中运行。结果以数组元组的形式返回。为了获得这些值，首先访问第 2 个元组，然后访问第 1 个数组，最后访问第 1 个值— results[1][0][0]。在这种情况下，它返回索引 0。“应变”的值为“100-Og ”,并且“标准”与用户特征完全匹配。第二个示例是 index 1972，它的应变值为“日晒伤”,匹配 8 个特征中的 6 个。这些推荐非常符合用户的特点！</p><pre class="ln lo lp lq gt mk ml mm mn aw mo bi"><span id="571d" class="mp mq ja ml b gy mr ms l mt mu">ideal_strain = [‘Creative,Energetic,Tingly,Euphoric,Relaxed,Earthy,Sweet,Citrus’]<br/>new = tf.transform(ideal_strain)<br/>results = nn.kneighbors(new.todense())</span><span id="689c" class="mp mq ja ml b gy nb ms l mt mu">df[‘Strain’][results[1][0][0]]<br/>#’100-Og’<br/>df[‘Criteria’][results[1][0][0]]<br/>#’Creative,Energetic,Tingly,Euphoric,Relaxed,Earthy,Sweet,Citrus’</span><span id="4879" class="mp mq ja ml b gy nb ms l mt mu">df[‘Strain’][results[1][0][1]]<br/>#’Sunburn’<br/>df[‘Criteria’][results[1][0][1]]<br/>#’Creative,Euphoric,Uplifted,Happy,Energetic,Citrus,Earthy,Sweet’</span></pre><p id="ecd3" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr jb">腌制</strong></p><p id="2aef" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">最后，dtm 和矢量器将在 Dash 应用程序中使用。</p><pre class="ln lo lp lq gt mk ml mm mn aw mo bi"><span id="1ef3" class="mp mq ja ml b gy mr ms l mt mu">pickle.dump(dtm, open(‘/content/dtm.pkl’, ‘wb’))<br/>pickle.dump(tf, open(‘/content/tf.pkl’, ‘wb’))</span></pre><p id="b276" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated"><strong class="kr jb">Dash 应用</strong></p><p id="1a0c" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">由于本文的重点是创建一个基于内容的推荐系统，Dash 应用程序的细节将不在本文讨论之列。有关创建 Dash 应用程序的详细信息，请参阅我的文章<a class="ae ll" rel="noopener" target="_blank" href="/how-to-create-an-interactive-dash-web-application-11ea210aa6d9"> <em class="mj">如何创建交互式 Dash Web 应用程序</em> </a>。</p><p id="d560" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">我欢迎建设性的批评和反馈，请随时给我发私信。</p><p id="20be" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">在推特上关注我</p><p id="365c" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">这篇文章最初出现在我的网站上</p><p id="81a9" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">大麻数据来源:<a class="ae ll" href="https://www.kaggle.com/kingburrito666/cannabis-strains" rel="noopener ugc nofollow" target="_blank"> <em class="mj">大麻品种大麻数据集来自卡格尔</em> </a>的利亚姆拉森</p><p id="a794" class="pw-post-body-paragraph kp kq ja kr b ks kt kb ku kv kw ke kx ky kz la lb lc ld le lf lg lh li lj lk im bi translated">图片来源:<em class="mj">“free images . com/Gerhard Taatgen Jr .”</em></p></div></div>    
</body>
</html>