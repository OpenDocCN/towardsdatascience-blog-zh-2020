<html>
<head>
<title>Beginners Guide to Transition from SAS to Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从SAS过渡到Python的初学者指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/beginners-guide-to-transition-from-sas-to-python-fcd17438a7a6?source=collection_archive---------7-----------------------#2020-04-06">https://towardsdatascience.com/beginners-guide-to-transition-from-sas-to-python-fcd17438a7a6?source=collection_archive---------7-----------------------#2020-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f431" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">10个常见的数据分析任务以及如何在SAS和Python中完成这些任务</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/be53751c315b29ab4adad0ece5b9a3fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sy5U9IunYheTq5bNlj8yqA.png"/></div></div></figure><h1 id="e1ef" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">介绍</h1><p id="ef54" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">SAS是一种专门的数据分析编程语言，自1976年以来一直存在。这比Python在1990年首次作为通用编程语言出现早了14年，比Pandas在2008年首次发布并将Python转变为开源数据分析工具早了32年。虽然SAS由于其效率和支持可用性而仍然受到广泛尊重并在各公司中使用，但Python由于其开放源代码的性质以及机器学习和人工智能库的快速发展而日益成为首选语言。我广泛地使用这两种语言，经常被问到是否有简单的指导，让了解SAS的人能够容易地过渡到Python。我写这篇文章的目的就是开发这样一个指南。</p><p id="377c" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我们将看看10个最常见的数据分析任务，以及如何在SAS和Python中完成它们。我将使用的过程和功能比我将要介绍的功能强大得多。然而，我在这里的目的并不是深入研究某个特定的过程或函数，而是让大家感受一下在两种语言中如何完成相同的任务。</p><p id="4557" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我将使用Kaggle著名的泰坦尼克号训练数据集。你可以在这里下载并找到关于这个数据<a class="ae mn" href="https://www.kaggle.com/c/titanic" rel="noopener ugc nofollow" target="_blank">的细节。您将需要SAS和Python来跟进。Python是开源的，因此可以免费安装。SAS是专有软件，但为学术和非商业用途提供免费的大学版。这对于本教程来说应该足够了。一旦你可以使用SAS和Python，你需要做的最后一件事就是为Python安装pandas。这可以通过使用“pip”并运行下面的命令来完成。</a></p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="a5e0" class="mt kv it mp b gy mu mv l mw mx">pip install pandas</span></pre><p id="f4d0" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">一旦成功安装了pandas，就需要将其导入到Python工作会话中。您可以通过运行下面的代码来做到这一点。注意，我喜欢在和熊猫一起工作的时候用一个别名——PD。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="52d5" class="mt kv it mp b gy mu mv l mw mx">import pandas as pd</span></pre><p id="d92f" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">让我们从10个常见的数据分析任务以及如何在SAS和Python中完成这些任务开始。</p><h1 id="d007" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">1.从平面文件读取数据</h1><p id="ea01" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">导入数据通常是任何数据分析项目中最常见的第一步。分隔的平面文件通常用于移动数据。SAS提供了一个强大的过程来做到这一点。以下代码显示了如何将titanic_train.csv逗号分隔文件导入名为“titanic”的SAS数据集。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="a817" class="mt kv it mp b gy mu mv l mw mx">proc import<br/>datafile = "&amp;path.titanic_train.csv"<br/>out = titanic<br/>dbms = csv;<br/>run;</span></pre><p id="4f1d" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">Pandas提供了<code class="fe my mz na mp b">read_csv()</code>函数来完成这项工作。在这里，我通过使用read_csv()导入titanic_train文件来创建一个Pandas DataFrame对象。数据帧相当于SAS数据集。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="5bab" class="mt kv it mp b gy mu mv l mw mx">titanic=pd.read_csv('titanic_train.csv')</span></pre><h1 id="1dda" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">2.查看汇总统计数据</h1><p id="f0e2" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">导入数据后的首要任务之一通常是查看数值字段的汇总统计数据。<code class="fe my mz na mp b">PROC MEANS</code>是一个很棒的工具，它为SAS用户提供了一种生成这些信息的简单方法。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="0073" class="mt kv it mp b gy mu mv l mw mx">PROC MEANS DATA=titanic;<br/>VAR _numeric_;<br/>OUTPUT OUT=stats;<br/>RUN;</span></pre><p id="405b" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">Pandas提供了一个名为<code class="fe my mz na mp b">describe()</code>的等效功能。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="f04f" class="mt kv it mp b gy mu mv l mw mx">titanic.describe()</span></pre><p id="218e" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">下面是来自SAS和Python的结果以及它们如何比较的快照。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/66684f5c5e033f9e78ea0553e9954a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*FSYBHNt_odTV_GtvNIDrYA.png"/></div><p class="nc nd gj gh gi ne nf bd b be z dk translated">SAS和Python的汇总统计输出</p></figure><h1 id="0bc4" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">3.按组汇总统计数据</h1><p id="21e0" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">很多时候，我们希望查看组级别的汇总统计数据。例如，我们可能希望根据性别对Titanic数据进行分组，并查看男性和女性之间的统计数据如何进行比较。在SAS中，我们可以添加CLASS或BY语句来做到这一点。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="12de" class="mt kv it mp b gy mu mv l mw mx">PROC MEANS DATA=titanic;<br/>CLASS Sex;<br/>VAR _numeric_;<br/>OUTPUT OUT=stats;<br/>RUN;</span></pre><p id="d243" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在Python中，Pandas提供了一个<code class="fe my mz na mp b">groupby()</code>函数，该函数可以使用点符号与<code class="fe my mz na mp b">describe()</code>函数链接，以获得组级别的摘要。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="5c72" class="mt kv it mp b gy mu mv l mw mx">titanic.groupby('Sex').describe()</span></pre><h1 id="2da1" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">4.更改列名</h1><p id="50c0" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">SAS提供了一个强大的数据步骤来操作SAS数据集的行和列。您可以在数据步骤中使用<code class="fe my mz na mp b">rename statement</code>来更改列名。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="d22c" class="mt kv it mp b gy mu mv l mw mx">data titanic2;<br/>set titanic;<br/>rename Pclass=passengerclass;<br/>run;</span></pre><p id="c030" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在Python中，您可以使用<code class="fe my mz na mp b">rename()</code>函数来重命名列名。如果希望更新多个列的名称，可以在字典中传递多个元素。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="c32d" class="mt kv it mp b gy mu mv l mw mx">titanic2=titanic.rename(columns={'Pclass':'passengerclass'})</span></pre><h1 id="9d48" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">5.删除并保留列</h1><p id="279a" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">只保留需要使用的列并删除不需要的列总是一个好主意。虽然这在SAS中可能没有太大关系，但在Python中工作时可能会有性能影响。原因是Pandas数据帧驻留在内存中，不像SAS数据集驻留在磁盘上。我经常在SAS数据步骤中使用<code class="fe my mz na mp b">DROP</code>和<code class="fe my mz na mp b">KEEP</code>语句来删除和保留数据集中的某些列。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="02d4" class="mt kv it mp b gy mu mv l mw mx">data titanic2;<br/>set titanic;<br/>drop pclass;<br/>run;</span><span id="3189" class="mt kv it mp b gy ng mv l mw mx">data titanic2;<br/>set titanic;<br/>keep pclass;<br/>run;</span></pre><p id="2ef2" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">Pandas提供了<code class="fe my mz na mp b">drop()</code>函数来删除列。我们可以将想要删除的列的列表传递给<code class="fe my mz na mp b">drop()</code>函数的columns参数。为了保留某些列，我们可以将想要保留的列的列表传递给<code class="fe my mz na mp b">slicing operator</code>或方括号[]。列列表类似于<code class="fe my mz na mp b">PROC PRINT</code>中的<code class="fe my mz na mp b">VAR</code>语句。还要注意，在Python中，列名(以及几乎所有内容)是区分大小写的。在SAS中，列名不区分大小写。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="ab5d" class="mt kv it mp b gy mu mv l mw mx">titanic2=titanic.drop(columns=['Pclass'])</span><span id="3cc5" class="mt kv it mp b gy ng mv l mw mx">titanic2=titanic[['Pclass']]</span></pre><h1 id="1f5a" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">6.添加新列</h1><p id="041e" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">在数据分析项目中，几乎总是需要根据现有字段添加新列。SAS数据步骤使它非常容易做到。然而，在某些情况下，使用数据步骤可能有点棘手。例如，我在这里添加了一个新列“fare_deviation”，它是通过从每一行(乘客)的票价中减去总平均票价来计算的。谢天谢地，SAS提供了<code class="fe my mz na mp b">PROC SQL</code>来轻松做到这一点。我喜欢PROC SQL，因为它提供了一种方法来利用SQL的强大功能，以便与其他SAS过程一起进行分析。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="8d91" class="mt kv it mp b gy mu mv l mw mx">proc sql noprint;<br/>create table titanic2 as<br/>select *,fare-mean(fare) as fare_deviation from titanic;<br/>quit;</span></pre><p id="26c3" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">这在Python中很容易做到，事实上，只用一行代码就可以做到。在下面的代码中，我使用了<code class="fe my mz na mp b">mean()</code>函数来计算‘Fare’列的平均值，并将其从‘Fare’序列中减去。组成DataFrame的每个单独的列都可以被认为是Pandas系列对象。一个新的系列可以被添加为一个数据帧列，就像我创建新的数据帧列' Fare_deviation '一样。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="98be" class="mt kv it mp b gy mu mv l mw mx">titanic['Fare_deviation']=titanic['Fare']-titanic['Fare'].mean()</span></pre><h1 id="2df9" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">7.子集数据</h1><p id="6820" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">在SAS中，我们可以在数据步骤中使用IF或WHERE语句对行进行子集划分，对列进行保留和删除。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="25c4" class="mt kv it mp b gy mu mv l mw mx">data titanic2;<br/>set titanic;<br/>if sex='male';<br/>keep Name Sex Pclass pclass;<br/>run;</span></pre><p id="e29e" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在Python中，我们可以使用<code class="fe my mz na mp b">loc[]</code>方法对数据进行子集化。在这里，我为“男性”乘客选择行，只保留“姓名”、“性别”和“Pclass”列。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="23c5" class="mt kv it mp b gy mu mv l mw mx">titanic2=titanic.loc[titanic['Sex']=='male',['Name','Sex','Pclass']]</span></pre><h1 id="1a02" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">8.排序数据</h1><p id="8abc" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated"><code class="fe my mz na mp b">PROC SORT</code>提供了一种在SAS中对数据集进行排序的理想方法。默认行为是按升序排序。对于降序排序，需要在BY语句后添加“descending”。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="858c" class="mt kv it mp b gy mu mv l mw mx">proc sort data=titanic;<br/>by descending passengerid;<br/>run;</span></pre><p id="c774" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在Python中，我们可以使用<code class="fe my mz na mp b">sort_values()</code>函数对数据帧进行排序。inplace参数告诉python应用操作并更新调用该函数的同一数据帧。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="eb34" class="mt kv it mp b gy mu mv l mw mx">titanic.sort_values(by=['PassengerId'],ascending=False,inplace=True)</span></pre><h1 id="c1a5" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">9.内部、外部和左侧连接</h1><p id="8384" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">在我演示如何执行连接之前，让我们首先从我们庞大的数据中创建两个子集。我正在为乘客编号为887，888，889，890，891的乘客创建一个包含“乘客编号”、“姓名”和“性别”列的“titanic_a”数据集。' titanic_b '数据集包含passengerid为887，888，889，890，891乘客' passengerid '，'年龄'和'幸存'列。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="3e80" class="mt kv it mp b gy mu mv l mw mx">data titanic_a(keep=passengerid name sex) titanic_b(keep=passengerid age survived);<br/>set titanic;<br/>if (passengerid in (887,888,889,890,891)) then output titanic_a;<br/>if (passengerid in (884,885,886,887,888)) then output titanic_b;<br/>run;</span></pre><p id="2b29" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">下面，我正在创建两个熊猫数据框，就像我上面在SAS中创建的一样。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="d138" class="mt kv it mp b gy mu mv l mw mx">titanic_a=titanic.loc[titanic['PassengerId'].isin([887,888,889,890,891]),['PassengerId','Name','Sex']]<br/>titanic_b=titanic.loc[titanic['PassengerId'].isin([884,885,886,887,888]),['PassengerId','Age','Survived']]</span></pre><p id="3b53" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">现在我们有了两个数据集，我们准备好查看连接。我经常喜欢在SAS中使用<code class="fe my mz na mp b">PROC SQL</code>来执行连接，因为我发现使用SQL很直观。<code class="fe my mz na mp b">MERGE</code>的说法同样受欢迎。在下面的代码中，我们创建了三个数据集— titanic inner(由titanic_a和titanic_b之间的passengerid上的内部联接产生)、titanic_outer(由titanic_a和titanic_b之间的passengerid上的外部联接产生)和titanic_left_a(由titanic_a和titanic_b之间的passengerid上的左联接产生)。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="2ab7" class="mt kv it mp b gy mu mv l mw mx">data titanic_inner titanic_left_a titanic_outer;<br/>merge titanic_a (in = a)titanic_b (in = b);<br/>by descending passengerid;<br/>if a and b then output titanic_inner;<br/>if a then output titanic_left_a;<br/>if a or b then output titanic_outer;<br/>run;</span></pre><p id="48cb" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">使用pandas提供的merge()函数可以获得类似的结果。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="700f" class="mt kv it mp b gy mu mv l mw mx">titanic_inner=titanic_a.merge(titanic_b,how='inner',on='PassengerId')<br/>titanic_left_a=titanic_a.merge(titanic_b,how='left',on='PassengerId')<br/>titanic_outer=titanic_a.merge(titanic_b,how='outer',on='PassengerId')</span></pre><h1 id="055a" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">10.导出数据</h1><p id="f7f0" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">最后一个例子是将数据导出为平面文件。在SAS中，这可以使用<code class="fe my mz na mp b">PROC EXPORT</code>来完成。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="c05c" class="mt kv it mp b gy mu mv l mw mx">PROC EXPORT<br/>DATA=titanic_outer<br/>DBMS=csv<br/>OUTFILE="&amp;path.titanic_outer.csv";<br/>run;</span></pre><p id="90ee" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在Python中，您可以使用<code class="fe my mz na mp b">to_csv()</code>函数写出一个平面文件。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="88d5" class="mt kv it mp b gy mu mv l mw mx">titanic_outer.to_csv('titanic_outer.csv')</span></pre><h1 id="9bf0" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">结论</h1><p id="8cfb" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">我希望本指南为SAS程序员提供一个良好的起点，让他们尝试使用Python进行数据分析，并让Python程序员使用SAS。</p></div></div>    
</body>
</html>