<html>
<head>
<title>How to build a dataset for an image classifier from scratch (related to cars)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从头开始为图像分类器构建数据集(与汽车相关)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d?source=collection_archive---------15-----------------------#2020-01-18">https://towardsdatascience.com/how-to-build-a-dataset-for-an-image-classifier-from-scratch-d2506e30468d?source=collection_archive---------15-----------------------#2020-01-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="49d8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">设计一个过程来收集网络上的数据，并使其可用于图像分类项目(使用Beautifulsoup，Selenium)</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a6d51fea8dfebe2116f9d576845e387e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*34Sp_IebEnKCdtdk"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">乔纳森·加莱戈斯在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="e711" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章中，我将介绍我几周前构建的从网站<a class="ae kv" href="https://turo.com/fr-ca" rel="noopener ugc nofollow" target="_blank"> Turo </a>收集数据(文本和图片)的管道，以及清理收集的数据以在图像分类器项目中使用它的过程。</p><p id="db13" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">免责声明:这些数据是供我使用的(我不拥有它)，所以我不会分享它。</strong></p><h1 id="13f0" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">项目的概念</h1><p id="7722" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">几周前，我开始思考在深度学习中更详细地潜水，我想围绕图像分类启动一个项目。</p><p id="10a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我在这个主题中阅读的大多数文章都使用了与<a class="ae kv" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank"> mnist </a>数据集(手写数字)、<a class="ae kv" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank"> deepfashion </a>(贴有标签的衣服集合)或<a class="ae kv" href="https://medium.com/@paul.stancliffe/udacity-dog-breed-classifier-project-walkthrough-e03c1baf5501" rel="noopener">狗品种分类器</a>相同的数据集。</p><p id="d98f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些数据集是合适的，但此时此刻我想研究一些不同的东西:</p><ul class=""><li id="8811" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">我同时发现了<a class="ae kv" href="https://turo.com/" rel="noopener ugc nofollow" target="_blank"> Turo platform </a>这是一个人们可以从北美其他人那里租车的平台(它似乎运行得很好)。</li><li id="b6a4" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">我开始从<a class="ae kv" href="https://www.playground-games.com/" rel="noopener ugc nofollow" target="_blank">游乐场游戏</a>在PC上玩《极限纵横4》。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/572a522be835f01b0fefe6cad0146cf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ckw4Mg_TprjwodOc.jpg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://compass-ssl.xbox.com/assets/2c/d7/2cd7061a-3d3b-4319-9d75-8ac4628cbc77.jpg?n=8888888884_Gallery_1154x649_09.jpg" rel="noopener ugc nofollow" target="_blank">https://compass-SSL . Xbox . com/assets/2c/D7/2cd 7061 a-3d3b-4319-9d 75-8ac 4628 CBC 77 . jpg？n = 8888888884 _ Gallery _ 1154 x649 _ 09 . jpg</a></p></figure><p id="3037" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">几周前，我发现了两个相同主题的数据集</p><ul class=""><li id="fe5c" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated"><a class="ae kv" href="https://ai.stanford.edu/~jkrause/cars/car_dataset.html" rel="noopener ugc nofollow" target="_blank">斯坦福的一张</a>通过阅读<a class="ae kv" href="https://towardsdatascience.com/@bhanuyerra?source=post_page-----39692e445a14----------------------" rel="noopener" target="_blank">巴努耶拉</a>的这篇<a class="ae kv" rel="noopener" target="_blank" href="/classifying-car-images-using-features-extracted-from-pre-trained-neural-networks-39692e445a14">文章</a>与汽车图片相关</li><li id="197d" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">Nicolas Gervais的GitHub知识库</li></ul><p id="eb45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是我想在抓取方面增加我的游戏，所以我决定建立我的Turo网站的抓取器。</p><p id="129e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在一份Turo的报价中，我才意识到有标注了车型的图片。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/5694ceb2a83337affeb0edb6b9f48a81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IoKr7rKfrt3Eawi7"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Turo网站</p></figure><p id="6d32" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，为什么不使用该网站作为图像分类数据集的来源来构建汽车检测系统呢？</p><p id="01b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了执行从网站中提取数据，我不能使用与我在Crossfit open上的<a class="ae kv" href="http://the-odd-dataguy.com/crossfitopen" rel="noopener ugc nofollow" target="_blank">文章</a>中的<a class="ae kv" href="https://www.crummy.com/software/BeautifulSoup/" rel="noopener ugc nofollow" target="_blank">美汤</a>相同的方法，因为:</p><ul class=""><li id="a4ad" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">URL不是很容易填充，所以我需要自动完成我的Turo研究</li><li id="db2f" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">要让所有广告都显示在结果页面上，需要进行一些滚动操作</li></ul><p id="88cb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我仍然可以使用Beautiful Soup从源页面获取数据，但是我需要将这个包与另一个名为Selenium的包关联起来，以自动化对Turo的研究。</p><h1 id="ef20" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">包装的展示</h1><p id="b672" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在这一部分，我将简单介绍一下我一直在Turo上爬行的库。</p><h1 id="0238" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">美味的汤</h1><p id="59da" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><a class="ae kv" href="https://www.crummy.com/software/BeautifulSoup/" rel="noopener ugc nofollow" target="_blank">美汤</a>是一个从HTML和XML文件中提取数据的包<em class="nf">。它与您喜欢的解析器一起工作，提供导航、搜索和修改解析树的惯用方式。它通常为程序员节省数小时或数天的工作。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/a002b34a8b0ca17aa13c6e948b975f84.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/0*oRGnxYUEVbOOpK-H"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://infopython.files.wordpress.com/2007/03/beautifulsoup.jpg" rel="noopener ugc nofollow" target="_blank">https://info python . files . WordPress . com/2007/03/beautiful soup . jpg</a></p></figure><p id="534c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了这个包之后，收集网页在线的源码，你就可以分段所有的HTML标签，并在里面研究收集你需要的信息。在我看来，这个包是开始使用Python进行web抓取的一个很好的开端，在这个主题上有很多有用的资源。</p><h1 id="2208" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">硒</h1><p id="e491" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这个包可以看作是一个web浏览器自动化包。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/35adeac79baa3ba178c8df69f3299ec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/0*SHi1ZsuLNkPOMBcC"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://huddle.eurostarsoftwaretesting.com/wp-content/uploads/2017/02/Selenium.png" rel="noopener ugc nofollow" target="_blank">https://huddle . eurostarsoftware testing . com/WP-content/uploads/2017/02/selenium . png</a></p></figure><p id="0fd8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个包允许Python脚本打开像Firefox这样的网络浏览器，在网页上填充字段，在网页上滚动，像人类一样点击按钮。<br/>让我们深入了解数据管道。</p><h1 id="2b48" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">数据管道的介绍</h1><h1 id="d270" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">概观</h1><p id="5914" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在数据收集方面，我决定将我的数据收集集中在北美最重要的城市，所以我选择了:</p><ul class=""><li id="d79e" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">美国各州的中心城镇，至少有一百万人口</li><li id="503d" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">加拿大人口最多的15个城市</li></ul><p id="aa60" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有一张我正在搜集数据的城市面板地图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/2c69f2674c267263e392a9b06dc6a246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/0*Tlh_g8Fw6VmCAmXz"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">谷歌地图</p></figure><p id="4a48" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它代表了60个城市(蓝色的美国和红色的加拿大)，就像我有多种类型的环境(山，海)和不同的天气可以诱导各种类型的车辆。</p><p id="89b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个想法是每6个小时收集一次从城市列表中随机挑选的5个城市的新报价。接收数据的存储是这样进行的:</p><ul class=""><li id="2b42" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">在本地，所有的图片都保存在刮板机上</li><li id="1dfa" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">在<a class="ae kv" href="http://the-odd-dataguy.com/p/9d736496-0ed3-4a92-bd04-6e7fa03bcb41/Build%20a%20webscraper%20with%20Selenium%20and%20BeautifulSoup" rel="noopener ugc nofollow" target="_blank"> AWS </a>中，我使用了一个<a class="ae kv" href="https://aws.amazon.com/dynamodb/?sc_channel=PS&amp;sc_campaign=acquisition_CA&amp;sc_publisher=google&amp;sc_medium=dynamodb_hv_b&amp;sc_content=dynamodb_e&amp;sc_detail=dynamodb&amp;sc_category=dynamodb&amp;sc_segment=73324893176&amp;sc_matchtype=e&amp;sc_country=CA&amp;s_kwcid=AL!4422!3!73324893176!e!!g!!dynamodb&amp;ef_id=Cj0KCQjw9fntBRCGARIsAGjFq5GS7soTVsB8NP__REd9JX7GRF7S_zjDYZW-Swn0ik_5shVH39KzOCsaAnOOEALw_wcB:G:s" rel="noopener ugc nofollow" target="_blank"> dynamodb </a>表来存储从搜索到的报价信息(id，报价的详细信息),以便总是保存报价的可用信息</li></ul><p id="9f26" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我用了大约两周的时间运行这个管道，下载了大约164000张图片。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/7dd0473db668d54058d4b3d497ab1f43.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/0*JQm4eeIsgycd7h7a.gif"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://media.giphy.com/media/3NtY188QaxDdC/giphy.gif" rel="noopener ugc nofollow" target="_blank">https://media.giphy.com/media/3NtY188QaxDdC/giphy.gif</a></p></figure><p id="c0c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们更详细地看看用Selenium和Beautiful Soup进行数据收集的脚本。</p><h1 id="8d7c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">收集报价</h1><p id="f391" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">首先，为了收集这些数据，我需要有一种方法来给出一个城市，并获得当前可用的优惠。<br/>有一个代码可以收集蒙特利尔市的报价。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="bcf4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以看到:</p><ul class=""><li id="fabb" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">Selenium的用法是通过一个驱动程序的声明，该驱动程序可以控制web浏览器在网站上进行导航</li><li id="9f7f" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">使用对象驱动程序，我可以设置我的脚本来填充由id定义的特定字段(在本例中为“js-searchformexpandlocationinput ”),并将键发送到该特定输入(在本例中为城市字段中的位置)</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/d65986a187603ee66d9352e71fa6a64e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1pgFKnzkWC-uKZM7y_mwpA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">turo首页检查</p></figure><ul class=""><li id="6fb8" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">Selenium的另一部分是与页面上的按钮的直接交互(需要找到页面上的按钮并激活它)。</li></ul><p id="7c8b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于页面上的滚动，这有点棘手；我用<a class="ae kv" href="https://michaeljsanders.com/2017/05/12/scrapin-and-scrollin.html" rel="noopener ugc nofollow" target="_blank">迈克尔·J·桑德斯</a>的方法在“无限页”上滚动。</p><p id="395f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在每一次滚动之间，我都使用Beautiful Soup来收集页面上的所有报价。</p><p id="486e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有一个脚本的动画。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/e4b13e1d0d45f3eb42e6e4d07def6d1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*_aohWR9VJ18i1Yl6YID3ig.gif"/></div></figure><p id="8769" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">之后，我只是对以前从未见过的报价(不在我的dynamodb表中)进行过滤，并使用一个新的流程从一个特定的报价中收集数据。</p><h1 id="5224" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">收集图片</h1><p id="ab56" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">有一个为要约收集数据的脚本。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="c535" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个脚本的棘手部分是收集报价上图片的URL。下面的屏幕截图说明了图片存储在一个转盘中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/a9737112d93332ea845fe2e9fe7bed32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ge0rwaDK_1oRxJYGw900ew.jpeg"/></div></div></figure><p id="1293" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我使用同样的技巧，然后在首页上使用验证按钮，这样，我可以很容易地收集所有图片的URL，并通过GET请求，将它们下载到我的机器上。有一个先前脚本的动画在运行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/500db7ab6a721e9e7bfa99068ebd5d01.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*mOAH5APNV0DZh6InYYSbiw.gif"/></div></figure><p id="c2a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想运行脚本，我邀请你用Github库(在一台Linux机器上)上的<a class="ae kv" href="https://github.com/jeanmidevacc/example_webscraper" rel="noopener ugc nofollow" target="_blank">配置设置一个python环境。</a></p><p id="bfde" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们看一下数据集的数据准备。</p><h1 id="c0cb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">从ze(原始)数据集到图像分类器的hero数据集</h1><p id="4c18" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">用我的刮刀，我在Turo网站上收集了很多(164000左右)与他们的汽车报价相关的图片。这是一个很好的开始，但所有这些图片都是不可用的，例如，汽车的内部。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/97f90b0d612f3b789bfde740db8e68fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xWzd37IwcKacLxjCJg-PNw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Turo广告图片</p></figure><p id="b972" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有很多这样的图片，所以我需要对这个原始数据集做一些清理。</p><h1 id="317c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">清洗管道的描述</h1><p id="2b64" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">该管道背后的流程是:</p><ul class=""><li id="43db" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">检测原始数据集图像上的所有对象</li><li id="4e40" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">根据图片中检测到的对象应用一些规则来选择正确的图像</li><li id="f57a" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">裁剪图像上的车辆，并将其存储在新文件中</li></ul><p id="ebdd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有一个过程的简要说明</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/c6a12f1d6898d338cb77d12b829b3cc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aBiVOVHtISZsjPIgjMRmNw.jpeg"/></div></div></figure><p id="b42c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个管道中最棘手的部分是检测引擎；对于管道的这一部分，我决定我可以使用一个预先制作的模型。可以在线找到大量的模型来执行检测图像上的对象的任务。</p><p id="414a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看起来最有效的实现是由<a class="ae kv" href="https://towardsdatascience.com/@chrisfotache" rel="noopener" target="_blank">克里斯·福塔什</a>在<a class="ae kv" rel="noopener" target="_blank" href="/object-detection-and-tracking-in-pytorch-b3cf1a696a98"> Pytorch </a>上实现的。</p><p id="f3d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于过滤规则，这很简单；一幅好的汽车图片可以定义为:</p><ul class=""><li id="5db6" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">图像上只有一辆车(汽车或卡车)</li><li id="795f" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">车辆检测的置信指数应高于90%</li></ul><p id="83b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">过滤规则后，碰巧只有57000张图片可用。</p><p id="5f11" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看看这些图片的标签。</p><h1 id="cc24" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">最后一步:调整大小和标签</h1><p id="b08b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">完成数据集的最后一步是调整图片的大小，并为分类添加标签。</p><h1 id="1a00" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">调整大小</h1><p id="82e3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">从所有这些被选中的照片中，有两件事是值得注意的</p><ul class=""><li id="c6c9" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">它们有不同的尺寸(就高度和长度而言)</li><li id="630a" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">它们是彩色的(因此有3个原色通道)</li></ul><p id="cbe6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图显示了图片的高度和长度。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/6f7269650d115bf576c9f10526d428e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZcT7YHlTR8zaW-Rhv_9Qgw.jpeg"/></div></div></figure><p id="d75f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些图片有适当的分辨率，但我需要使它们一致，以便每个管道都可以用于分类。我构建了下面这段代码来调整图片的大小(这个函数可以将图片变成黑白的)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="3079" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我根据高度和长度的像素尝试了数据集的多种大小配置。</p><p id="2dc7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们看看标签。</p><h1 id="854b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">贴标签于</h1><p id="4144" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">该数据集有两个明显的标签:</p><ul class=""><li id="2bdf" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">有51种可能标签的制造商</li><li id="a3eb" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">有526个可能标签的模型</li></ul><p id="0ea0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图显示了每个制造商的型号数量。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/cef48534a51887610f887a8a205dc321.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v128AYHh3JZlYXyG1BQ6pw.png"/></div></div></figure><p id="00a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以看到，有很多厂商和型号，有这么多标签(我觉得)是一个很难的开始。我决定建立我的“标签机制”</p><p id="c7a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我建立了两种标签:</p><ul class=""><li id="b2f4" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">一个用于二元分类器</li><li id="4689" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">一个用于多类分类器</li></ul><p id="e294" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于二元分类器，我选择一个特定的制造商和一个特定的型号。对于厂商，我决定选择特斯拉；第一个原因是它在网上很流行，第二个原因是特斯拉的图片数量与可用车型数量之间的比例不同寻常，如下图所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/bab622dd2835cc46241ecf64d096a29f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WFUJIRlRJL2ZusF5H-hfRg.jpeg"/></div></div></figure><p id="9ddf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于车型，我决定选择福特野马，是因为我喜欢福特野马，不是别的。但老实说，这是数据集中最受欢迎的模型之一，正如我们在下图中看到的10大最受欢迎的模型。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/095ee5b9e3554893ad4af03667c79f73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*46Qx9G7nQAbfUdDnc4hXFQ.jpeg"/></div></div></figure><p id="797c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们谈谈多类分类器；在这种情况下，我使用一种简单的方法来标记。这个想法就是取前X个最受欢迎的厂商/型号，如果图片的厂商/型号不在前X，那么他分配的标签就是other。我为以下产品创建标签:</p><ul class=""><li id="2481" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">十大制造商/型号</li><li id="0062" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">前25名制造商/型号</li><li id="fc35" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">前50名制造商/型号</li><li id="80f3" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">前100/200/400型号</li></ul><p id="b1e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在有很多不同的图片标签。尽管如此，对于我在图像分类器上的第一个工作，我将把我的测试集中在二进制标签和前10名制造商/型号上。</p><p id="364b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了完成这篇文章，我只想谈一些事情，它是关于数据集的平衡。对于我选择的标签，我可以告诉你，要预测的类根本不是平衡的。下图显示了数据集的不平衡。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/ed249b9052dce4deced768628b44bf53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c_ddLHpkaSNcqwJ2JDAmlg.jpeg"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/bd06ced6503e437a0d4e1f1feb0f63d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ShmBJpYvhyA6dHe0DQC2qQ.jpeg"/></div></div></figure><p id="c8d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我使用这些标签进行图像分类时，我将测试影响以平衡训练的类别。</p><p id="ca45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请继续关注，不要犹豫，请给我们一些反馈。</p></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="dbcc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nf">原载于2020年1月18日</em><a class="ae kv" href="http://the-odd-dataguy.com/build-a-webscraper-with-beautifsoup-and-selenium/" rel="noopener ugc nofollow" target="_blank"><em class="nf"/></a><em class="nf">。</em></p></div></div>    
</body>
</html>