# æ„å»ºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ ç®¡é“:ç¬¬ä¸€éƒ¨åˆ†

> åŸæ–‡ï¼š<https://towardsdatascience.com/building-an-automated-machine-learning-pipeline-part-one-5c70ae682f35?source=collection_archive---------21----------------------->

## [æœºå™¨å­¦ä¹ ](https://towardsdatascience.com/machine-learning/home)

## æ•°æ®æ¸…ç†ã€æ¢ç´¢æ€§æ•°æ®åˆ†æå’Œç‰¹å¾å·¥ç¨‹æ­¥éª¤

*   ç¬¬ 1 éƒ¨åˆ†:ç†è§£ã€æ¸…ç†ã€æ¢ç´¢ã€å¤„ç†æ•°æ®(ä½ ç°åœ¨æ­£åœ¨é˜…è¯»)
*   [ç¬¬ 2 éƒ¨åˆ†:è®¾ç½®æŒ‡æ ‡å’ŒåŸºçº¿ï¼Œé€‰æ‹©å’Œè°ƒæ•´æ¨¡å‹](/building-an-automated-machine-learning-pipeline-part-two-1d3c86e6fe42?source=friends_link&sk=a005d5ead7a844adb7819403ddc6dc0e)(ç°åœºï¼)
*   [ç¬¬ä¸‰éƒ¨åˆ†:åŸ¹è®­ã€è¯„ä¼°å’Œè§£é‡Šæ¨¡å‹](https://medium.com/p/building-an-automated-machine-learning-pipeline-a74acda76b98?source=email-287e9909d3b5--writer.postDistributed&sk=1790d8dd404126a45828c3905f47432c)(ç°åœºï¼)
*   ç¬¬ 4 éƒ¨åˆ†:ä½¿ç”¨ Docker å’Œ Luigi è‡ªåŠ¨åŒ–æ‚¨çš„ç®¡é“ã€‚)

![](img/5ae957f1843f419e854b0c2f1683d05a.png)

åŠ³æ‹‰Â·ä½©é²å¥‡åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

åœ¨æˆ‘çš„æ•°æ®ç§‘å­¦å­¦ä¹ ä¹‹æ—…ä¸­ï¼Œæˆ‘é€šè¿‡é˜…è¯»å…³äºèµ°å‘æ•°æ®ç§‘å­¦çš„æ–‡ç« æ‰€å­¦åˆ°çš„ä¸œè¥¿ä¸æˆ‘ä»åœ¨çº¿è¯¾ç¨‹å’Œå„ç§ç¼–ç æŒ‘æˆ˜ä¸­å­¦åˆ°çš„ä¸€æ ·å¤šã€‚è·Ÿè¸ªè¿™äº›ä¸åŒçš„å­¦ä¹ èµ„æºï¼Œä¼´éšç€ä»–ä»¬å¯¹æœºå™¨å­¦ä¹ (ML)çš„è§£é‡Šï¼Œå¯¹æˆ‘å¸®åŠ©å¾ˆå¤§ã€‚ä»Šå¤©ï¼Œæˆ‘å°†å¸¦ç€æˆ‘åœ¨æ•´ä¸ªæ—…ç¨‹ä¸­æç‚¼å‡ºçš„å¯¹ ML åº”ç”¨ç¨‹åºçš„éƒ¨åˆ†è§‚ç‚¹ï¼Œå¼€å§‹ä¸€ä¸ªç³»åˆ—æ–‡ç« ã€‚å®ƒå°†æœ‰å¸Œæœ›å±•ç¤ºå¦‚ä½•ç”¨åˆå­¦è€…å‹å¥½çš„è¯­è¨€å’Œç»“æ„æ„å»ºä¸€ä¸ªè‡ªåŠ¨åŒ–çš„ ML ç®¡é“ã€‚

æˆ‘ä»¬å°†éµå¾ªä¸€ä¸ªç›´è§‚çš„ ML ç®¡é“æ¥æ„å»º ***ä¸€ä¸ªé¢„æµ‹å™¨æ¥è¯„å®šè‘¡è„é…’è´¨é‡*** :

1.  ç†è§£ã€æ¸…ç†å’Œæ ¼å¼åŒ–æ•°æ®
2.  æ¢ç´¢æ€§æ•°æ®åˆ†æ
3.  ç‰¹å¾å·¥ç¨‹å’Œé¢„å¤„ç†
4.  è®¾ç½®è¯„ä¼°æŒ‡æ ‡å¹¶å»ºç«‹åŸºçº¿
5.  åŸºäºè¯„ä¼°åº¦é‡é€‰æ‹© ML æ¨¡å‹
6.  å¯¹æ‰€é€‰æ¨¡å‹æ‰§è¡Œè¶…å‚æ•°è°ƒæ•´
7.  è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹
8.  è§£é‡Šæ¨¡å‹é¢„æµ‹
9.  å¾—å‡ºç»“è®ºå¹¶è®°å½•å·¥ä½œ

ç¬¬ä¸€ç¯‡æ–‡ç« æ¶µç›–äº†æ­¥éª¤ 1ã€2 å’Œ 3ã€‚è¿™ç¯‡æ–‡ç« èƒŒåçš„ä»£ç å¯ä»¥åœ¨è¿™ä¸ªç¬”è®°æœ¬é‡Œæ‰¾åˆ°[ã€‚æœ¬ç³»åˆ—çš„ç¬¬äºŒç¯‡å’Œç¬¬ä¸‰ç¯‡æ–‡ç« å°†æ¶µç›–æ•´ä¸ªç®¡é“ã€‚](https://github.com/cereniyim/Wine-Rating-Predictor-ML-Model/blob/master/notebooks/WineRatingPredictor-1.ipynb)

åœ¨æˆ‘ä»¬æ„å»ºå¥½ç®¡é“ä¹‹åï¼Œç¬¬å››ç¯‡æ–‡ç« å°†å…³æ³¨å¦‚ä½•ç”¨ [Docker](https://www.docker.com/) å’Œ [Luigi](https://luigi.readthedocs.io/en/stable/) è‡ªåŠ¨åŒ– ***è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨*** ã€‚è¿™ä¸€éƒ¨åˆ†å°¤å…¶ä»¤æˆ‘å…´å¥‹ï¼Œå› ä¸ºå®ƒå‘æˆ‘ä»‹ç»äº†ä¸€äº›æ¦‚å¿µå’Œå·¥å…·ï¼Œè®©æˆ‘äº†è§£äº† ML è§£å†³æ–¹æ¡ˆæ˜¯å¦‚ä½•åœ¨ç”Ÿäº§ç³»ç»Ÿä¸Šè¿è¡Œçš„ã€‚

> å£°æ˜:è¿™ç§è‡ªåŠ¨åŒ–çš„æ ¸å¿ƒç»“æ„å’Œå®ç”¨ç¨‹åºæ¥è‡ªäºä¸€ä¸ª[ç¼–ç æŒ‘æˆ˜](https://github.com/datarevenue-berlin/code-challenge-2020)ï¼Œè¿™æ˜¯æˆ‘æœ€è¿‘åœ¨ä¸€å®¶åä¸º [Data Revenue](https://www.datarevenue.com/) çš„ç¥å¥‡å…¬å¸æ¥å— ML å·¥ç¨‹å¸ˆé¢è¯•è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚æˆ‘æ²¡æœ‰å¾—åˆ°è¿™ä»½å·¥ä½œï¼Œå› ä¸ºä»–ä»¬åœ¨å¯»æ‰¾ä¸€ä¸ªåœ¨å·¥ç¨‹æ–¹é¢æ›´æœ‰é‡ç‚¹å’Œç»éªŒçš„äººï¼Œè€Œæˆ‘åœ¨ç§‘å­¦æ–¹é¢æ›´æœ‰ç»éªŒã€‚æœ€ç»ˆï¼Œæˆ‘æˆ´ä¸Šäº†è½¯ä»¶å·¥ç¨‹å¸ˆçš„å¸½å­ï¼Œåœ¨é¢è¯•è¿‡ç¨‹ä¸­å­¦åˆ°äº†å¾ˆå¤šã€‚

GitHub ä¸Šä¸ºæ²¡æœ‰è€å¿ƒçš„äººæä¾›äº†å®Œæ•´çš„é¡¹ç›®:

[](https://github.com/cereniyim/Wine-Rating-Predictor-ML-Model) [## cereniyim/è‘¡è„é…’è¯„çº§é¢„æµ‹æ¨¡å‹

### åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä¸ºä¸€ä¸ªåœ¨çº¿è‘¡è„é…’å–å®¶æ„å»ºäº†ä¸€ä¸ªè‘¡è„é…’è¯„çº§é¢„æµ‹å™¨ã€‚è¿™æ¬¾è‘¡è„é…’é¢„æµ‹å™¨æ—¨åœ¨æ˜¾ç¤ºè‰¯å¥½çš„â€¦

github.com](https://github.com/cereniyim/Wine-Rating-Predictor-ML-Model) 

# é—®é¢˜å®šä¹‰å’Œç›®æ ‡:

åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ ·æœ¬æ•°æ®é›†ã€‚åœ¨ç°å®ä¸–ç•Œçš„åœºæ™¯ä¸­ï¼Œäººä»¬å¯èƒ½ä»ç½‘ä¸Šèµ„æºå¦‚ [winemag](https://www.winemag.com/wine-ratings/) ä¸­è·å¾—(ä¹Ÿè®¸[scrap](/web-scraping-is-now-legal-6bf0e5730a78))è¿™äº›æ•°æ®ã€‚

**è¯¥é¡¹ç›®çš„ç›®æ ‡æ˜¯å»ºç«‹*ä¸€ä¸ªè‘¡è„é…’è¯„çº§é¢„æµ‹å™¨*ä½¿ç”¨æ ·æœ¬æ•°æ®é›†æ¥æ˜¾ç¤ºè‰¯å¥½çš„é¢„æµ‹æ˜¯å¯èƒ½çš„ï¼Œä¹Ÿè®¸æ˜¯ä½œä¸ºä¸€ä¸ªæ›´å¤§é¡¹ç›®çš„æ¦‚å¿µè¯æ˜ã€‚**

æˆ‘ä»¬å°†ä½¿ç”¨è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨çš„ç»“æœæ¥ç¡®è®¤ ML åº”ç”¨ç¨‹åºæ˜¯å•†ä¸šé—®é¢˜çš„æœ‰æ•ˆè§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚ä¸ºå–å®¶ä¼˜åŒ–è‘¡è„é…’ç»„åˆã€‚

æˆ‘ä»¬åº”è¯¥æ°¸è¿œè®°ä½ï¼Œæ•°æ®ç§‘å­¦ä¸­çš„â€œç§‘å­¦â€æ˜¯æœ‰ç›®çš„çš„ï¼Œæœ€ç»ˆæ˜¯ä¸ºéç§‘å­¦å®¶æœåŠ¡çš„ã€‚ä¸€ä¸ªå…¸å‹çš„é¡¹ç›®æœ‰ä¸€äº›éšå«çš„åŸºæœ¬éœ€æ±‚ã€‚

æˆ‘ä»¬çš„è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨åº”è¯¥æ˜¯**å¯ä»¥ç†è§£çš„**ï¼Œå› ä¸ºæˆ‘ä»¬çš„è§‚ä¼—å¯èƒ½å¯¹ç»Ÿè®¡å­¦å’Œ ML äº†è§£æœ‰é™ã€‚æ­¤å¤–ï¼Œå®ƒåº”è¯¥æ˜¯**é«˜æ€§èƒ½çš„**ï¼Œå› ä¸ºå®Œæ•´çš„ç”Ÿäº§æ•°æ®é›†å¯èƒ½æœ‰æ•°ç™¾ä¸‡è¡Œã€‚æœ€åï¼Œå®ƒåº”è¯¥æ˜¯è‡ªåŠ¨åŒ–çš„ï¼Œå¯ä»¥åœ¨ä»»ä½•ç”Ÿäº§ç³»ç»Ÿä¸Šè¿è¡Œï¼Œä¸éœ€è¦ç‰¹æ®Šçš„é…ç½®å’Œè®¾ç½®ã€‚

# åœ¨å¼€å§‹ä¹‹å‰

è¿™ä¸ªé¡¹ç›®çš„æ•°æ®å¯ä»¥åœ¨å­˜å‚¨åº“ä¸­çš„`[data_root/raw/wine_dataset](https://github.com/cereniyim/Wine-Rating-Predictor-ML-Model/blob/master/data_root/raw/wine_dataset.csv)`ä¸­æ‰¾åˆ°ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å…¶ä¸­çš„ 90%ä½œä¸ºè®­ç»ƒé›†ï¼Œå‰©ä¸‹çš„ 10%ä½œä¸ºæµ‹è¯•é›†ã€‚å®ƒä»¬åœ¨`data_root/interim`ä¸­éƒ½æœ‰`[train.csv](https://github.com/cereniyim/Wine-Rating-Predictor-ML-Model/blob/master/data_root/interim/train.csv)`å’Œ`[test.csv](https://github.com/cereniyim/Wine-Rating-Predictor-ML-Model/blob/master/data_root/interim/test.csv)`ã€‚

æˆ‘ä»¬å°†ä½¿ç”¨ Python 3.7ï¼Œå¹¶å°†éœ€è¦æœ¬ç¬”è®°æœ¬ä¸­çš„ä»¥ä¸‹åº“:

# 1.ç†è§£ã€æ¸…ç†å’Œæ ¼å¼åŒ–æ•°æ®

åœ¨è¿™ä¸€æ­¥ä¸­ï¼Œæˆ‘ä»¬å°†ç†Ÿæ‚‰æ•°æ®é›†ï¼Œç†è§£æ•°æ®é›†ä¼ è¾¾çš„å†…å®¹ï¼Œå¹¶é€šè¿‡åˆ é™¤å†—ä½™çš„è¡Œå’Œåˆ—æ¥æ¸…ç†æ•°æ®é›†ã€‚

è®©æˆ‘ä»¬å°†è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†åŠ è½½åˆ°æ•°æ®æ¡†ä¸­ï¼Œå¹¶æŸ¥çœ‹è®­ç»ƒæ•°æ®é›†çš„ä¸€äº›è¡Œ:

```
train = pd.read_csv("../data_root/interim/train.csv") 
test = pd.read_csv("../data_root/interim/test.csv")
train.sample(5)
```

![](img/3ac31987e59d5b7028cfe7a7302acbbe.png)

æ•°æ®é›†ä¸­æœ‰ä¸€äº›ç©ºè¡Œï¼Œæˆ‘ä»¬åªæœ‰ä¸¤ä¸ªæ•°å­—å˜é‡:*ç‚¹æ•°*å’Œ*ä»·æ ¼*ã€‚

ç‚¹æ•°æ˜¯æˆ‘ä»¬è¯•å›¾é¢„æµ‹çš„å› å˜é‡ï¼Œå¹¶å°†ç›®æ ‡ç§°ä¸º*ã€‚å…¶ä½™çš„æ˜¯å¯ç”¨äºç¡®å®šç›®æ ‡çš„ç‹¬ç«‹å˜é‡ï¼Œå°†è¢«ç§°ä¸º ***ç‰¹å¾*** ã€‚*

*æˆ‘ä»¬è¯•å›¾æŒæ¡è‡ªå˜é‡å’Œå› å˜é‡ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶ä½¿ç”¨è¿™ç§å…³ç³»æ¥ç”Ÿæˆé¢„æµ‹ï¼Œè¿™ä½¿å¾—è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨æˆä¸ºä¸€ä¸ª ***ç›‘ç£å›å½’æœºå™¨å­¦ä¹ æ¨¡å‹*** :*

*   ****ç›‘ç£* :** æ•°æ®é›†åŒ…æ‹¬è‘¡è„é…’è¯„çº§(æ ‡ä¸º*åˆ†*)å’Œå¯ç”¨äºç¡®å®š*åˆ†*çš„è‡ªå˜é‡ã€‚*
*   ****å›å½’* :** æˆ‘ä»¬çš„ç›®æ ‡å˜é‡â€”â€”*ç‚¹*ç”± 80 åˆ° 100 çš„è¿ç»­æ•´æ•°ç»„æˆã€‚*

*å¦‚æœæ‚¨æ›¾ç»è€ƒè™‘è¿‡åœ¨è¶…å¸‚è´­ä¹°å“ªç§è‘¡è„é…’ï¼Œå¤§å¤šæ•°åˆ—åéƒ½æ˜¯ä¸è¨€è‡ªæ˜çš„ã€‚ç„¶è€Œï¼Œæˆ‘è®¤ä¸ºç†è§£ä¸€ç§ç‰¹å®šçš„è‘¡è„é…’å¦‚ä½•è·å¾—*åˆ†*å’Œç‰¹å®šé¢†åŸŸçš„ç‰¹å¾æ˜¯å¾ˆé‡è¦çš„ã€‚*

*å“é…’å¸ˆç»™è‘¡è„é…’æ‰“åˆ†ã€‚åŒä¸€ä¸ªå“é…’å¸ˆå¯èƒ½ä¼šç»™ä¸€æ¬¾è‘¡è„é…’ä¸åŒçš„åˆ†æ•°ã€‚å½“å“é…’å¸ˆç»™ä¸€æ¬¾é…’æ‰“åˆ†æ—¶ï¼Œå¥¹/ä»–è¿˜ä¼šæä¾›ä¸€ä»½å…³äºè¯¥é…’çš„æ³¨é‡Šå’Œå‘³é“çš„æè¿°ã€‚*

**æ ‡å¿—*æ˜¯è‘¡è„å›­çš„åç§°ï¼Œ*region _ 1*&*region _ 2*ç‰¹å¾æè¿°äº†è‘¡è„é…’çš„è‘¡è„ç”Ÿé•¿çš„åœ°æ–¹ã€‚è¿™æ˜¯ä¸€ç“¶å·´æ´› 2005 å·´é²æ ¼çº¢è‘¡è„é…’çš„æ ·å­:*

*![](img/81788e5c4760c95ccda46d022cd34551.png)*

*å›¾ç‰‡æ¥æº: [Winemag](https://www.winemag.com/buying-guide/barlow-2005-barrouge-red-napa-valley/) ä¸Šå·´æ´› 2005 å·´é²æ ¼çº¢çš„æˆªå›¾*

*ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†çš„æ•°æ®ç±»å‹å’Œéç©º(é null)æ•°:*

```
*train.info()*
```

*![](img/23981da2d6b8836dd17d7426777d407a.png)*

```
*test.info()*
```

*![](img/5cf5daa6cd5ff6997173fc995aa05542.png)*

*è¿™æ˜¯ä¸€ä¸ªæœ‰è¶£çš„æ•°æ®é›†ï¼Œå› ä¸º 90%çš„ç‰¹å¾æ˜¯ ***ã€åˆ†ç±»ã€‘â€”*** å˜é‡ï¼Œå®ƒä»¬ä½äº*å¯¹è±¡*æ•°æ®ç±»å‹ä¸­ã€‚ML æ¨¡å‹åªèƒ½å¤„ç†æ•°å­—æ•°æ®å’Œéç©ºå€¼ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†åœ¨ ***ç‰¹å¾å·¥ç¨‹&é¢„å¤„ç†*** ä¸­å¼€å‘ä¸€äº›ç­–ç•¥æ¥å¤„ç†æˆ‘ä»¬æ¨¡å‹ä¸­çš„åˆ†ç±»æ•°æ®å’Œç¼ºå¤±å€¼ã€‚*

## ***1.1ã€‚æ•°æ®é›†çš„ç¼ºå¤±å€¼:***

*ä¸‹é¢çš„å‡½æ•°å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿè§‚å¯Ÿæ¯ä¸ªç‰¹æ€§çš„ç¼ºå¤±å€¼çš„ç™¾åˆ†æ¯”ã€‚*

*![](img/38e6706fa3c54a963f1cf92ee0420b8c.png)**![](img/214b6383aeecf03031e18acfb1a5ea8e.png)*

*ç¼ºå¤±å€¼è¶…è¿‡ 50%çš„ç‰¹å¾ä¸å¤ªå¯èƒ½ä¸ºæˆ‘ä»¬çš„æ¨¡å‹æä¾›é‡è¦ä¿¡æ¯ã€‚å› æ­¤ï¼Œ *region_2* å°†ä»ä¸¤ä¸ªæ•°æ®é›†ä¸­åˆ é™¤ã€‚*

*åœ¨æ­¤ç¤ºä¾‹æ•°æ®é›†ä¸­ï¼Œç›®æ ‡å€¼æ²¡æœ‰ç¼ºå¤±å€¼ã€‚å¦‚æœæˆ‘ä»¬åœ¨ç›®æ ‡ä¸­æœ‰ç¼ºå¤±çš„å€¼ï¼Œæˆ‘ä»¬ä¼šåˆ é™¤æ‰€æœ‰ç¼ºå¤±çš„å€¼ï¼Œä»¥å…æ‰­æ›²ç›®æ ‡çš„ç°æœ‰åˆ†å¸ƒã€‚*

## ***1.2ã€‚éæ•°å­—ç‰¹å¾çš„åŸºæ•°:***

****åŸºæ•°*** æ˜¯ä¸€ä¸ªåˆ†ç±»ç‰¹å¾æ‰€å…·æœ‰çš„å”¯ä¸€å€¼çš„æ•°é‡ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹æˆ‘ä»¬çš„è®­ç»ƒæ•°æ®é›†:*

```
*object_columns = (train
                  .select_dtypes(include="object")
                  .columns)

**for** column **in** object_columns:
    print("**{}** has **{}** unique values."
          .format(column, 
                  train[column]
                  .nunique()))*
```

*![](img/6d75a0af35453c5b3842374aa1458eda.png)*

*æˆ‘ä»¬å¯ä»¥æ¨æ–­ä¸€ä¸ªç‰¹å¾æœ‰ä¸€ä¸ª*

*   ****é«˜åŸºæ•°*** å¦‚æœåœ¨ 9000 è¡Œä¸­æœ‰ 1000 è¡Œä»¥ä¸Š:*æè¿°*ï¼Œ*ç§°å·*ï¼Œ*å¤´è¡”*å’Œ*é…’å‚ã€‚**
*   ****ä¸­ç­‰åŸºæ•°*** å¦‚æœè¶…è¿‡ 100 è¡Œ:*çœ*ã€ *region_1* å’Œ*å“ç§*ã€‚*
*   ****ä½åŸºæ•°*** å¦‚æœå°‘äº 100 è¡Œ:*å›½å®¶*ï¼Œ*åœ°åŒº _2ï¼Œ* *taster_name* å’Œ *taster_twitter_handleã€‚**

*å½“æˆ‘ä»¬è®­ç»ƒæ¨¡å‹æ—¶ï¼Œé«˜åŸºæ•°ç‰¹æ€§å¯èƒ½ä¼šå¼•èµ·é—®é¢˜ã€‚å³ä½¿æˆ‘ä»¬å°†åˆ†ç±»ç‰¹å¾çš„æ¯ä¸ªå”¯ä¸€å€¼è½¬æ¢æˆæ–°ç‰¹å¾ï¼Œ[å®ƒä»¬ä¹Ÿå¯èƒ½å¸¦æ¥ç»´æ•°ç¾éš¾](https://pkghosh.wordpress.com/2017/10/09/combating-high-cardinality-features-in-supervised-machine-learning/)ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨é«˜åŸºæ•°è¦ç´ æ¥æ·»åŠ æ–°è¦ç´ ï¼Œç„¶åå°†å®ƒä»¬ä»æ•°æ®é›†ä¸­ç§»é™¤ã€‚*

*è¯·è®°ä½ï¼Œè¿™æ˜¯ä¸€ä¸ªæ ·æœ¬æ•°æ®é›†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸èƒ½ä¿è¯åœ¨è®­ç»ƒæ¨¡å‹æ—¶å·²ç»çœ‹åˆ°äº†æ¯ä¸ªåˆ†ç±»ç‰¹å¾çš„æ‰€æœ‰å¯èƒ½å€¼ã€‚å¦‚æœæˆ‘ä»¬çš„è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨åœ¨æµ‹è¯•é›†ä¸­é‡åˆ°ä¸€ä¸ªæ–°å€¼ï¼Œå®ƒå°†æŠ›å‡ºé”™è¯¯ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åœ¨ ***ç‰¹å¾å·¥ç¨‹&é¢„å¤„ç†ä¸­é‡æ–°å®¡è§†è¿™ä¸€ç‚¹ã€‚****

## ***1.3ã€‚ç§»é™¤å…±çº¿ç‰¹å¾:***

*å¦‚æœä¸¤ä¸ªå˜é‡ä¹‹é—´å­˜åœ¨çº¿æ€§å…³è”ï¼Œåˆ™ç§°å®ƒä»¬ä¸º ***å…±çº¿*** ã€‚åœ¨åˆ†ç±»ç‰¹å¾çš„æƒ…å†µä¸‹ï¼Œå¦‚æœå®ƒä»¬æä¾›ç›¸åŒçš„ä¿¡æ¯æ¥é¢„æµ‹ç›®æ ‡ï¼Œåˆ™å®ƒä»¬è¢«ç§°ä¸º ***å…±çº¿*** ã€‚*

*å…±çº¿ç‰¹å¾é™ä½äº†æµ‹è¯•é›†çš„æ³›åŒ–æ€§èƒ½å’Œæ¨¡å‹çš„å¯è§£é‡Šæ€§ã€‚å›æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯¹è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨çš„è¦æ±‚ä¹‹ä¸€æ˜¯å¯è§£é‡Šæ€§ã€‚*

*åœ¨æˆ‘ä»¬çš„æ ·æœ¬æ•°æ®é›†ä¸­ï¼Œ *taster_name* å’Œ *taster_twitter_handle* è¡¨ç¤ºå…±çº¿æ€§ã€‚åœ¨ç¡®ä¿ *taster_twitter_handle* çš„æ‰€æœ‰å€¼éƒ½è¢« *taster_name* ( [æ­¤å¤„æœªæ˜¾ç¤ºï¼Œä½†åœ¨ç¬”è®°æœ¬](https://render.githubusercontent.com/view/ipynb?commit=b3a9024c9eba68c8d3ef63ae21fcb2eb3a30e16c&enc_url=68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f636572656e6979696d2f57696e652d526174696e672d507265646963746f722d4d4c2d4d6f64656c2f623361393032346339656261363863386433656636336165323166636232656233613330653136632f6e6f7465626f6f6b732f57696e65526174696e67507265646963746f722d312e6970796e62&nwo=cereniyim%2FWine-Rating-Predictor-ML-Model&path=notebooks%2FWineRatingPredictor-1.ipynb&repository_id=257017095&repository_type=Repository#Unique-values-of-taster_name-and-taster_twitter_handle)ä¸­æ£€æŸ¥è¿‡)è¦†ç›–åï¼Œå®ƒè¢«ç§»é™¤ä»¥æ„å»ºä¸€ä¸ªè‰¯å¥½ä¸”å¯è§£é‡Šçš„è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨ã€‚*

## ***1.4ã€‚äº†è§£&æ¸…ç†&æ ¼å¼æ•°æ®:***

*åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»åˆæ­¥äº†è§£äº†æ•°æ®é›†ï¼Œå¹¶å‘ç°äº†è¦ç§»é™¤çš„è¦ç´ :*

*   **ç§°å·*å’Œ*é…’å‚*ç”±äºåŸºæ•°é«˜*
*   **region_2* ç”±äºç¼ºå¤±å€¼è¶…è¿‡ 50%*
*   **taster_twitter_handle* ç”±äºå…±çº¿æ€§*

*æ­¤å¤–ï¼Œè®­ç»ƒé›†åŒ…å«ä¸€äº›é‡å¤çš„è¡Œã€‚é™¤äº†ä¸Šé¢çš„åˆ—è¡¨ï¼Œæˆ‘ä»¬å°†åˆ é™¤å®ƒä»¬ï¼Œå¹¶ç”¨ä¸‹é¢çš„å‡½æ•°æ¸…ç†æ•°æ®:*

```
*drop_columns = ["designation", "winery", "taster_twitter_handle", "region_2"]train_cleaned = CleanDatat(train, drop_columns, "points")
test_cleaned = CleanData(test, drop_columns, "points"*
```

*![](img/205d394a995f065a9e8c37998931f04f.png)*

*ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`train_cleaned.csv`å’Œ`test_cleaned.csv`åœ¨ ***æ¢ç´¢æ€§æ•°æ®åˆ†æ*** ä¸­è¿›ä¸€æ­¥å¯è§†åŒ–å’Œæ¢ç´¢ç‰¹æ€§å’Œç›®æ ‡ã€‚*

# *2.æ¢ç´¢æ€§æ•°æ®åˆ†æ*

*æ¢ç´¢æ€§æ•°æ®åˆ†æ(EDA)æ˜¯æˆ‘ä»¬è¯¦ç»†æŸ¥çœ‹å˜é‡å¹¶å¯è§†åŒ–ç‰¹å¾å’Œç›®æ ‡ä¹‹é—´å…³ç³»çš„æ­¥éª¤ã€‚åœ¨è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†å¯»æ‰¾å’Œè·Ÿè¸ªç›®æ ‡çš„å¼ºé™å®šè¯çš„çº¿ç´¢ã€‚åœ¨è¿™ä¸€æ­¥çš„æœ€åï¼Œæˆ‘ä»¬å°†å†³å®šåœ¨ ***ç‰¹å¾å·¥ç¨‹&é¢„å¤„ç†*** ä¸­å¤„ç†å“ªäº›ç‰¹å¾ã€‚*

*é¦–å…ˆï¼Œæˆ‘ä»¬å°†æ£€æŸ¥*ç‚¹*(ç›®æ ‡)ã€æ•°å­—ç‰¹å¾ä»¥åŠå®ƒä»¬ä¹‹é—´çš„è”ç³»ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†ç ”ç©¶ä½åŸºæ•°ç‰¹æ€§åŠå…¶ä¸ç›®æ ‡çš„å…³ç³»ã€‚å½“æˆ‘ä»¬å‘ç°æœ‰ä»·å€¼çš„è§è§£æ—¶ï¼Œæˆ‘ä»¬å°†é€šè¿‡ EDA çš„æ­¥éª¤è¯¦ç»†é˜è¿°å®ƒä»¬ã€‚*

## ***2.1ã€‚ç§¯åˆ†åˆ†å¸ƒ:***

****åˆ†å¸ƒ*** æ˜¯å¯¹å˜é‡èŒƒå›´ä»¥åŠæ•°æ®åœ¨è¯¥èŒƒå›´å†…å¦‚ä½•åˆ†å¸ƒçš„æè¿°ã€‚é€šè¿‡ç»˜åˆ¶ç›´æ–¹å›¾ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°è§‚å¯Ÿåˆ°åˆ†å¸ƒæƒ…å†µ:*

```
*figsize(10, 8)
plt.rcParams['font.size'] = 14
plot_histogram(train_cleaned, "points")*
```

*![](img/66c29003b246af439f8b37d531966def.png)*

*æ­£å¦‚éšæœºå˜é‡æ‰€é¢„æœŸçš„é‚£æ ·ï¼Œç‚¹æ˜¾ç¤ºæ­£æ€åˆ†å¸ƒ(åˆ†å¸ƒä¸­æ˜æ˜¾å‡ºç°é’Ÿå½¢æ›²çº¿)ã€‚ç‚¹æ•°èŒƒå›´åˆ†å¸ƒåœ¨ 80 å’Œ 100 ä¹‹é—´ï¼Œå¹³å‡å€¼ä¸º 88.45ï¼Œä¸­ä½æ•°ä¸º 88ã€‚æ­¤å¤–ï¼Œæ ‡å‡†åå·®â€”â€”æ•°æ®èŒƒå›´åˆ†å¸ƒçš„åº¦é‡å€¼ä¸º 3.03ï¼Œå¯¼è‡´æ–¹å·®ä¸º 9.1 çš„å¹³æ–¹åå·®ã€‚åŸºäºæ­£æ€åˆ†å¸ƒï¼Œæˆ‘ä»¬å¯ä»¥è‡ªä¿¡åœ°è¯´ï¼Œ95%çš„ç‚¹ä½äº 82.5â€“94.5 èŒƒå›´å†…ã€‚*

## ***2.2ã€‚ä»·æ ¼åˆ†å¸ƒ:***

*å½“æˆ‘ä»¬ç»˜åˆ¶*ä»·æ ¼*çš„ç›´æ–¹å›¾æ—¶ï¼Œå®ƒæ˜¾ç¤ºäº†ä¸€ä¸ªæ¨¡ç³Šçš„ç”»é¢ï¼Œå› ä¸ºå®ƒé«˜åº¦å³å*(ç¬”è®°æœ¬ä¸­æœ‰[)ã€‚ä¸ºäº†å¾—åˆ°ä¸€ä¸ªåˆç†çš„å€¼ï¼Œæˆ‘ä»¬å°†åœ¨ 0â€“200 èŒƒå›´å†…è§‚å¯Ÿå®ƒ:](https://render.githubusercontent.com/view/ipynb?commit=b3a9024c9eba68c8d3ef63ae21fcb2eb3a30e16c&enc_url=68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f636572656e6979696d2f57696e652d526174696e672d507265646963746f722d4d4c2d4d6f64656c2f623361393032346339656261363863386433656636336165323166636232656233613330653136632f6e6f7465626f6f6b732f57696e65526174696e67507265646963746f722d312e6970796e62&nwo=cereniyim%2FWine-Rating-Predictor-ML-Model&path=notebooks%2FWineRatingPredictor-1.ipynb&repository_id=257017095&repository_type=Repository#Distribution-of-price)**

```
**figsize(10, 8) 
plt.rcParams['font.size'] = 14
plot_histogram(train_cleaned, "price", 200) 
plt.xlim(0,200)**
```

**![](img/34414c5b8ddf916f6fd535cb8e581a3a.png)**

**è¿™ä»ç„¶æ˜¯ä¸€ä¸ªå³å*æˆ–æ­£å*åˆ†å¸ƒï¼Œå…¶ä¸­å³å°¾è¾ƒé•¿ï¼Œå¤§éƒ¨åˆ†å€¼é›†ä¸­åœ¨å·¦ä¾§ã€‚ä»·æ ¼çš„ä¸­ä½æ•°æ˜¯ 25ï¼Œå¹³å‡ä»·æ ¼æ˜¯ 35.5ã€‚****

***ä¸ºäº†ä½¿ç”¨*ä»·æ ¼*ä½œä¸ºé¢„æµ‹å€¼ï¼Œæˆ‘ä»¬éœ€è¦å‡è®¾æ”¶åˆ°çš„*ç‚¹*ä¸ä¼šå¼•èµ·ä»»ä½•ä»·æ ¼å˜åŒ–ã€‚å¦åˆ™ï¼Œè¿™å°†å¯¼è‡´[æ•°æ®æ³„æ¼](https://machinelearningmastery.com/data-leakage-machine-learning/)ï¼Œå› ä¸ºæˆ‘ä»¬å°†åœ¨ç¨åçš„æ—¶é—´ç‚¹åŒ…å«ä¸€ä¸ªé¢„æµ‹å™¨ã€‚è¿™å¯èƒ½ä¼šç ´åæˆ‘ä»¬å¯¹*ç‚¹*çš„æœªæ¥é¢„æµ‹ã€‚***

**å°½ç®¡å¦‚æ­¤ï¼Œå‡è®¾*ä»·æ ¼*ä¸å—å“é…’å¸ˆåˆ†é…çš„*ç‚¹æ•°*çš„å½±å“ï¼Œå®ƒæ˜¯è‘¡è„é…’è´¨é‡å’Œå¹´ä»½çš„æŒ‡æ ‡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœŸæœ›å®ƒæˆä¸ºè¯¥æ¨¡å‹çš„ä¸€ä¸ªåŸºæœ¬ç‰¹å¾ã€‚**

## **2.3.ç§¯åˆ†å’Œå›½å®¶:**

**ä¸ºäº†å¯è§†åŒ–å‡ ä¸ªå˜é‡çš„å…³ç³»ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ ***å¯†åº¦å›¾*** ï¼Œå…¶ä¸­æˆ‘ä»¬ç»˜åˆ¶äº†åˆ†ç±»ç‰¹å¾çš„æ¯ä¸ªå”¯ä¸€å€¼çš„ç›®æ ‡åˆ†å¸ƒã€‚ ***å¯†åº¦å›¾*** å¯ä»¥è§£é‡Šä¸ºç›´æ–¹å›¾çš„è¿ç»­å’Œå¹³æ»‘ç‰ˆæœ¬ï¼Œå…¶å®¹æ˜“ä¼ è¾¾åˆ†å¸ƒçš„å½¢çŠ¶ã€‚**

**ä¸ºäº†ä¿æŒå›¾è¡¨çš„å¯è§£é‡Šæ€§ï¼Œæˆ‘ä»¬å°†ä¸ºå‡ºç°æ¬¡æ•°è¶…è¿‡ 100 æ¬¡çš„å›½å®¶ç»˜åˆ¶*ç‚¹*çš„åˆ†å¸ƒå›¾ã€‚**

```
**# make a list of countries that has most occurences
countries = (train_cleaned["country"]
             .value_counts())

freq_countries = list(
    countries[
        countries.values > 300]
    .index)

freq2_countries = list(
    countries[
        (countries.values <= 300) &
        (countries.values >= 100)]
    .index)**
```

```
**figsize(20, 10)
plt.rcParams['font.size'] = 14

*# plot points distribution for most frequent countries*
plt.subplot(1, 2, 1)
plot_distribution(train_cleaned, "points",
                  freq_countries, "country")

plt.subplot(1, 2, 2)
plot_distribution(train_cleaned, "points",
                  freq2_countries, "country")**
```

**![](img/918abc942d20976a553844f806fd4360.png)**

**è‘¡è„é…’ç”Ÿäº§å¸‚åœºç”±ç¾å›½ã€æ³•å›½ã€æ„å¤§åˆ©å’Œè¥¿ç­ç‰™ä¸»å¯¼ï¼Œè¿™ä»åœ°å—ä¸Šå¾ˆå®¹æ˜“è·å¾—ã€‚*å›½å®¶*æ˜¯ç¡®å®šè‘¡è„é…’ç‚¹æ•°çš„åŒºåˆ†ç‰¹å¾ã€‚ç„¶è€Œï¼Œä¹Ÿæœ‰ä¸€äº›ä¾‹å¤–:ç¾å›½&è‘¡è„ç‰™æˆ–è€…å¥¥åœ°åˆ©&å¾·å›½ã€‚**

## **2.4.ä¸åŒå›½å®¶çš„ç§¯åˆ†å’Œä»·æ ¼**

**å‡è®¾ä»·æ ¼æ˜¯*ç‚¹æ•°*çš„åŸºæœ¬å†³å®šå› ç´ ï¼Œæˆ‘ä»¬å°†æ¢è®¨*ç‚¹æ•°*å’Œ*ä»·æ ¼*ä¸*å›½å®¶*çš„å…³ç³»ã€‚**

```
***# create dataframe of most frequent countries*
points_freq_countries = train_cleaned[
    train_cleaned
    .country
    .isin(freq_countries)]figsize(20, 10)
plt.rcParams['font.size'] = 14

*# plot a scatterplot of Points and Price*
plt.subplot(1,2,1)
sns.scatterplot(x='price', y='points',
                hue='country', 
                data=points_freq_countries,
                alpha=0.7)
plt.xlabel("Price", size=14)
plt.ylabel("Points", size=14)
plt.title("Points vs Price for Most Frequent Countries", 
          size=16)

*# plot a scatterplot of Points and Price*
plt.subplot(1,2,2)
sns.scatterplot(x='price', y='points', 
                data=train_cleaned,
                alpha=0.7)
plt.xlabel("Price", size=14)
plt.ylabel("Points", size=14)
plt.title("Points vs Price for all Countries with price range 0-200", size=16)
plt.xlim(0,200)**
```

**![](img/f1de810805d43fb249a47d4bd187f070.png)**

**å·¦ä¾§çš„å›¾è¡¨æ˜¾ç¤ºäº†åœ¨æ•´ä¸ªä»·æ ¼èŒƒå›´å†…ï¼Œä¸»è¦å›½å®¶ç”Ÿäº§çš„è‘¡è„é…’çš„*ç‚¹*å’Œ*ä»·æ ¼*çš„å…³ç³»ã€‚å³è¾¹çš„å›¾æ˜¾ç¤ºäº†æ‰€æœ‰å›½å®¶åœ¨ 0 å’Œ 200 ä»·æ ¼èŒƒå›´å†…çš„ç‚¹æ•°å’Œä»·æ ¼å…³ç³»ã€‚**

**ä¸¤ä¸ªå›¾éƒ½è¡¨æ˜*ç‚¹*å’Œ*ä»·æ ¼*ä¹‹é—´å­˜åœ¨å¾ˆå¼ºçš„æ­£ç›¸å…³æ€§ï¼Œè¿™è¯æ˜*ä»·æ ¼*æ˜¯ä¸€ä¸ªé‡è¦çš„é¢„æµ‹æŒ‡æ ‡ã€‚å¦ä¸€ä¸ªæœ‰ä»·å€¼çš„å‘ç°æ˜¯ï¼Œæœ‰ä¸¤ç§æ¥è‡ªæ„å¤§åˆ©çš„è‘¡è„é…’å’Œä¸€ç§æ¥è‡ªæ³•å›½çš„è‘¡è„é…’å¾—åˆ°äº†å“é…’å¸ˆçš„æ»¡åˆ†ï¼Œå®ƒä»¬çš„ä»·æ ¼éƒ½è¶…è¿‡äº† 200 è‹±é•‘ã€‚**

## **2.5.ç‚¹å’Œå“å°è€…å§“å**

***ç‚¹*ï¼Œä»£è¡¨ä»å“é…’å¸ˆå¤„æ”¶åˆ°çš„ç‰¹å®šè‘¡è„é…’çš„åˆ†æ•°ã€‚å› æ­¤ï¼Œä¸åŒçš„å“é…’å¸ˆå¯èƒ½å¯¹è‘¡è„é…’æœ‰ä¸åŒçš„è¯ é‡Šã€‚ä¸ºäº†ç ”ç©¶è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†ç»˜åˆ¶ä¸€ä¸ªå°æç´å›¾ã€‚**

*****å°æç´å›¾*** æ˜¯[æˆ‘æœ€å–œæ¬¢çš„å›¾](/recipes-for-the-visualizations-of-data-distributions-a1527a0faf77)ä¼ è¾¾äº†æ•°æ®å½¢çŠ¶çš„åˆ†å¸ƒå’Œ[æ±‡æ€»ç»Ÿè®¡](https://www.statisticshowto.com/summary-statistics/)åˆ†åˆ«æ˜¯å°æç´åœ¨å¤–é¢ï¼Œç»†é•¿çš„é•¿æ–¹å½¢åœ¨é‡Œé¢ã€‚**

```
**figsize(14, 8)
plt.rcParams['font.size'] = 14

f = sns.violinplot(data=train_cleaned,
                   x="taster_name",
                   y="points")

f.set_xticklabels(f.get_xticklabels(),
                  rotation=90)

plt.title("Points from Different Tasters",
          size=16)**
```

**![](img/031a7a9261fab4536a3bf84c55d24306.png)**

**æ¯ä¸ªå“é…’å¸ˆå¯¹*ç‚¹æ•°*çš„æ±‡æ€»ç»Ÿè®¡å’Œåˆ†é…éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå¯¼è‡´ä¸Šé¢çš„å°æç´ä¸åŒã€‚çœ‹è¿™å¼ å›¾ï¼Œæˆ‘ä»¬æœŸæœ›å®ƒæ˜¯æ¨¡å‹çš„ç¬¬äºŒä¸ªæœ€é‡è¦çš„é¢„æµ‹å™¨ã€‚**

## **2.6.æ¢ç´¢æ€§æ•°æ®åˆ†æçš„ç»“æœ**

**æˆ‘ä»¬æ¢è®¨äº†*ç§¯åˆ†*ã€*ä»·æ ¼*ã€*å›½å®¶*å’Œ*å“é…’å¸ˆå§“å*ä»¥åŠå®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œ*å“ç§ã€åŒºåŸŸ _1* å’Œ*çœä»½*å°†ä¿ç•™åœ¨æœ€ç»ˆç‰¹å¾åˆ—è¡¨ä¸­ï¼Œå› ä¸º:**

*   ***å“ç§*å’Œ*åŒºåŸŸ _1* æ˜¯åŒºåˆ†è‘¡è„é…’ä¸­è‘¡è„çš„ä¸»è¦å› ç´ ï¼Œä»è€Œå†³å®šäº†è‘¡è„é…’çš„å‘³é“å’Œè´¨é‡**
*   ***çœ*ç»“åˆ*å›½*æä¾›ä½ç½®ä¿¡æ¯**

**æ­¤å¤–ï¼Œæˆ‘ä»¬åœ¨*ç‚¹*è§‚å¯Ÿåˆ°ä¸€ä¸ªæ­£æ€åˆ†å¸ƒå¹¶ç¡®å®šäº†å®ƒçš„å‡å€¼å’Œæ–¹å·®ï¼Œè¿™å°†æœ‰åŠ©äºæˆ‘ä»¬åœ¨**ç‚¹*è®¾ç½®è¯„ä¼°åº¦é‡&å»ºç«‹åŸºçº¿ã€‚*** æˆ‘ä»¬é¢„è®¡*ä»·æ ¼*å’Œ*å“é…’å¸ˆå§“å*æ˜¯å†³å®š*ç‚¹æ•°*çš„ä¸¤ä¸ªæœ€é‡è¦çš„é¢„æµ‹å› ç´ ã€‚**

**ç°åœ¨ï¼Œæˆ‘ä»¬å°†ç»§ç»­è¿›è¡ŒæœŸå¾…å·²ä¹…çš„ ***ç‰¹å¾å·¥ç¨‹&é¢„å¤„ç†*** éƒ¨åˆ†ã€‚**

# **3.ç‰¹å¾å·¥ç¨‹å’Œé¢„å¤„ç†**

*****ç‰¹å¾å·¥ç¨‹*** æ˜¯ä»åŸå§‹ç‰¹å¾ä¸­æå–å’Œè½¬æ¢ä¿¡æ¯å¹¶æ½œåœ¨åœ°åˆ›é€ å‡ºæ›´å¤šæœ‰ç”¨ç‰¹å¾çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬å°†åˆ©ç”¨æˆ‘ä»¬åœ¨å‰é¢çš„éƒ¨åˆ†ä¸­äº†è§£åˆ°çš„ç‰¹æ€§ï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯ç¼–ç åˆ°æ–°çš„ç‰¹æ€§ä¸­ã€‚ç”±äºæˆ‘ä»¬çš„ç‰¹å¾å¤§å¤šæ˜¯åˆ†ç±»çš„ï¼Œæˆ‘ä»¬å°†åœ¨*æè¿°*ã€*ç§ç±»*å’Œ*æ ‡é¢˜*ä¸­æœç´¢æ•°å­—æˆ–äºŒè¿›åˆ¶ç‰¹å¾ã€‚**

**ç„¶åï¼Œæˆ‘ä»¬å°†å‡†å¤‡ä¸¤ä¸ªæ•°æ®é›†ï¼Œç”¨ä½œæˆ‘ä»¬çš„è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨çš„è¾“å…¥ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º ***ç‰¹å¾é¢„å¤„ç†*** ã€‚è¿™æ˜¯ä¸€ä¸ªå¿…è¦çš„æ­¥éª¤ï¼Œå› ä¸º ML æ¨¡å‹åªèƒ½å¤„ç†æ•°å­—æ•°æ®å’Œéç¼ºå¤±å€¼ã€‚**

**å»ºç«‹ä¸€ä¸ªå¥½çš„è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨ä»è¯†åˆ«æœ€æœ‰ç”¨çš„ç‰¹å¾å¼€å§‹ï¼Œä»¥ç¡®å®š*ç‚¹*ã€‚åœ¨è¿™ä¸€æ­¥çš„æœ€åï¼Œæˆ‘ä»¬å°†ç¡®å®šæœ€æœ‰æ•ˆçš„ç‰¹å¾é›†ï¼Œè¿™å°†æä¾›ä¸€ä¸ªå¥½çš„å’Œå¯ç†è§£çš„ ***è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨*** ä½œä¸ºå›æŠ¥ã€‚æˆ‘ä»¬å°†åˆ†åˆ«éµå¾ªç‰¹å¾æå–ã€åˆ†ç±»ç‰¹å¾è½¬æ¢å’Œç¼ºå¤±å€¼å¡«å……ã€‚**

## **3.1.ç‰¹å¾æŠ½å‡º**

*   ***æè¿°:* å®ƒåŒ…å«äº†å…³äºè‘¡è„é…’çš„é¢œè‰²ã€å‘³é“å’ŒéŸ³ç¬¦çš„ä¿¡æ¯(æ¯”å¦‚ç”œã€å¹²)ã€‚ä½¿ç”¨ä¸‹é¢çš„åŠŸèƒ½ä»æè¿°ä¸­æœç´¢å’Œæå–ä¸å‘³é“å’Œé¢œè‰²ç›¸å…³çš„å•è¯ã€‚å¦‚æœæè¿°ä¸­å­˜åœ¨ä¸å‘³é“æˆ–é¢œè‰²ç›¸å…³çš„è¯ï¼Œåˆ™è¯¥è¯çš„ç›¸åº”ç‰¹å¾è¢«èµ‹äºˆå€¼ 1ï¼Œå¦åˆ™ä¸º 0ã€‚**

*   ***æ ‡é¢˜:*åŒ…å«é…’çš„ç”Ÿäº§å¹´ä»½ã€‚å¦‚æœæ ‡é¢˜*ä¸­æ²¡æœ‰å¹´ä»½ä¿¡æ¯ï¼Œåˆ™å¹´ä»½*è¢«æŒ‡å®šä¸º 0ã€‚**

*   ***å“ç§:*åŒ…å«ä¸åŒç±»å‹çš„è‘¡è„æ˜¯å¦æ··åˆçš„ä¿¡æ¯ã€‚ *is_blend* å¦‚æœæœ‰å‡ ä¸ªè‘¡è„å“ç§ï¼Œåˆ™èµ‹ 1ï¼Œå¦åˆ™èµ‹ 0ã€‚**

**ç°åœ¨ï¼Œä½¿ç”¨ä¸Šé¢çš„åŠŸèƒ½å’Œä¸‹é¢çš„æœç´¢å…³é”®å­—ï¼Œæˆ‘ä»¬å°†æ·»åŠ æ–°çš„åŠŸèƒ½ã€‚**

```
***# create search terms for new features* 
*# to be extracted from description*
is_red_list = ["red", "Red", "RED",
               "noir", "NOIR", "Noir",
               "black", "BLACK", "Black"]

is_white_list = ["white", "WHITE", "White",
                 "blanc", "Blanc", "BLANC",
                 "bianco", "Bianco", "BIANCO",
                 "blanco", "Blanco", "BLANCO",
                 "blanca", "Blanca", "BLANCA"]

is_rose_list = ["rose", "ROSE", "Rose",
                "rosÃ©", "RosÃ©", "ROSÃ‰"]

is_sparkling_list = ["sparkling", "SPARKLING", "Sparkling"]

is_dry_list = ["dry", "Dry", "DRY",
               "dried", "Dried", "DRIED"]

is_sweet_list = ["sweet", "Sweet", "SWEET"]

desc_extracting_dict = {
    "is_red": is_red_list,
    "is_white": is_white_list,
    "is_rose": is_rose_list,
    "is_sparkling": is_sparkling_list,
    "is_dry": is_dry_list,
    "is_sweet": is_sweet_list
}**
```

```
**train_features_added = ExtractFeatures(train_cleaned) test_features_added = ExtractFeatures(test_cleaned)**
```

**ç»è¿‡ç‰¹å¾å·¥ç¨‹åï¼Œæˆ‘ä»¬åœ¨`train_features_added`å’Œ`test_features_added`æ•°æ®æ¡†ä¸­æœ‰ 14 ä¸ªç‰¹å¾:*å›½å®¶ã€çœä»½ã€åœ°åŒº _1ã€* *å“ç§ã€ä»·æ ¼ã€* *å¹´ä»½ã€* *å“é…’å¸ˆ _ å§“åã€**is _ çº¢ã€**is _ ç™½ã€**is _ å¹²ã€**is _ ç”œã€is _ é—ªé—ªã€is_blendã€‚***

## **3.2.ç‰¹å¾é¢„å¤„ç†**

**ä½œä¸ºç‰¹å¾é¢„å¤„ç†æ­¥éª¤çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œåˆ†ç±»ç‰¹å¾(*å›½å®¶*ã€*çœä»½*ã€*åœ°åŒº _1* ã€*å“é…’å¸ˆ _ å§“å*å’Œ*å“ç§*)å°†è¢«è½¬åŒ–ä¸ºæ•°å­—ç‰¹å¾ã€‚æˆ‘ä»¬é€‰æ‹©äº† ***é¡ºåºç¼–ç *** æ–¹æ³•è¿›è¡Œè½¬æ¢ï¼Œè¿™æ˜¯ä¸€ä¸ªä» 1 å¼€å§‹è¿ç»­åœ°å°†æ­£æ•´æ•°æŒ‰ç…§å‡ºç°çš„é¡ºåºåˆ†é…ç»™ç‰¹å®šç‰¹æ€§çš„æ¯ä¸ªå”¯ä¸€å€¼çš„è¿‡ç¨‹ã€‚**

**è¯·è®°ä½ï¼Œè¿™æ˜¯ä¸€ä¸ªæ ·æœ¬æ•°æ®é›†ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»è€ƒè™‘è¿™ä¸ªæ ·æœ¬æ•°æ®é›†ä¸­ä¸å­˜åœ¨ä½†å¯èƒ½å‡ºç°åœ¨æµ‹è¯•æ•°æ®é›†ä¸­çš„å¯èƒ½å€¼ã€‚ä¸ºäº†ç®¡ç†å®ƒä»¬ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ª [category_encoders åº“](http://contrib.scikit-learn.org/category_encoders/)çš„åºæ•°ç¼–ç å™¨ã€‚**

**å½“æˆ‘ä»¬å°†`handle_unknown`å‚æ•°è®¾ç½®ä¸º`"value"`æ—¶ï¼Œ`ordinal_encoder`å¯¹è±¡ä¼šå°†æµ‹è¯•é›†çš„ç¬¬ä¸€æ¬¡çœ‹åˆ°çš„å€¼èµ‹ä¸º-1ã€‚ç„¶åï¼Œæˆ‘ä»¬åœ¨è®­ç»ƒé›†ä¸Šè¿è¡Œ`fit`æ–¹æ³•ï¼Œ`ordinal_encoder`å¯¹è±¡å°†ç»™å®šç‰¹å¾çš„å€¼æ˜ å°„åˆ°æ•´æ•°ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯¹ä¸¤ä¸ªæ•°æ®é›†è¿è¡Œ`transform`æ–¹æ³•ï¼Œæ ¹æ®æ‹Ÿåˆè¿‡ç¨‹ä¸­å®Œæˆçš„æ˜ å°„å®Œæˆè½¬æ¢è¿‡ç¨‹ï¼Œå¹¶è¿”å›å…¨æ•°å­—æ•°æ®é›†ã€‚**

```
**ordinal_encode_cols = ["country", "province", "region_1", "variety",  "taster_name"]data_encoded = EncodeCategoricalData(train_features_added,
                                     test_features_added)
train_encoded = data_encoded[0]
test_encoded = data_encoded[1]**
```

**ä½œä¸ºç‰¹å¾é¢„å¤„ç†çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å¤„ç†ç¼ºå¤±å€¼ã€‚ä¸€ä¸ªç®€å•çš„é€‰æ‹©æ˜¯æ”¾å¼ƒå®ƒä»¬ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å·²ç»åªæœ‰ 8500 ä¸ªæ•°æ®ç‚¹æ¥è®­ç»ƒæ¨¡å‹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ç»§ç»­å¡«å……å®ƒä»¬ã€‚å¡«è¡¥ç‰¹å¾ç¼ºå¤±å€¼çš„è¿‡ç¨‹ç§°ä¸º ***æ’è¡¥*** ã€‚æˆ‘ä»¬å°†é’ˆå¯¹ä¸åŒçš„åŠŸèƒ½ä½¿ç”¨ä»¥ä¸‹ç­–ç•¥:**

*   ***taster_name* :å› ä¸ºæˆ‘ä»¬æœŸæœ› *taster_name* æ˜¯æœ€é‡è¦çš„ç‰¹å¾ä¹‹ä¸€ï¼Œæ‰€ä»¥å®ƒè¢«èµ‹äºˆä¸€ä¸ªå¸¸æ•°å€¼(0 ä»£è¡¨â€œæœªçŸ¥çš„å“å°è€…â€)ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä¿æŒæ¯ä¸ªå“å°è€…åœ¨ç¡®å®š*ç‚¹*æ—¶çš„æ•ˆæœã€‚**

*   ***ä»·æ ¼*å’Œ*å¹´ä»½*:ç”¨ä¸­é—´å€¼ä¼°ç®—ï¼Œå› ä¸ºå®ƒä»¬æ˜¯æ•°å­—åˆ—ï¼Œä¸­é—´å€¼ä¸å—æå€¼çš„å½±å“ã€‚**

*   ***å›½å®¶*ã€*çœ*ã€*åœ°åŒº _1* å’Œ*å“ç§*:ç”¨æœ€é¢‘ç¹å€¼ä¼°ç®—ï¼Œå› ä¸ºå®ƒä»¬æ˜¯åˆ†ç±»çš„ï¼Œå¹¶ä¸”æ¯ä¸ªç‰¹å¾çš„æœ€é¢‘ç¹å€¼å¯¹é½ã€‚åˆ†åˆ«æ˜¯ç¾å›½ã€åŠ å·ã€çº³å¸•è°·å’Œé»‘çš®è¯ºã€‚**

**åœ¨è¾“å…¥æœŸé—´çš„ä¸€ä¸ªé‡è¦è€ƒè™‘æ˜¯ï¼Œæ— è®ºé€‰æ‹©ä»€ä¹ˆè¾“å…¥ç­–ç•¥ï¼Œè®­ç»ƒé›†å’Œæµ‹è¯•é›†éƒ½è¢«è¾“å…¥ç›¸åŒçš„å€¼ã€‚ä¾‹å¦‚ï¼Œè®­ç»ƒæ•°æ®é›†ä¸­ä»·æ ¼çš„ä¸­å€¼æ˜¯ 25ï¼Œå¹¶ä¸”è¯¥å€¼è¢«åˆ†é…ç»™è®­ç»ƒæ•°æ®é›†å’Œæµ‹è¯•æ•°æ®é›†çš„ç¼ºå¤±å€¼ï¼Œä»¥é˜²æ­¢æ•°æ®æ³„æ¼åˆ°æµ‹è¯•é›†ä¸­ã€‚**

```
**transformed_data = ImputeMissingValues(train_encoded, test_encoded)

train_features = transformed_data[0]
train_target = transformed_data[1]
test_features = transformed_data[2]
test_target = transformed_data[3]**
```

**åœ¨è¿›å…¥ä¸‹ä¸€ç¯‡æ–‡ç« å’Œä¸‹ä¸€èŠ‚ä¹‹å‰ï¼Œæˆ‘ä»¬å°†ä¿ç•™è®­ç»ƒé›†çš„ä¸€éƒ¨åˆ†ä½œä¸ºéªŒè¯é›†ï¼Œä»¥æä¾›å¯¹æ¨¡å‹çš„å…¬æ­£è¯„ä¼°ã€‚**

**è®­ç»ƒæ•°æ®é›†å°†ç”¨äºè®­ç»ƒæœºå™¨å­¦ä¹ æ¨¡å‹ã€‚ ***è®­ç»ƒä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹*** å°±æ˜¯æˆ‘ä»¬çš„æ¨¡å‹æŒæ¡ç‰¹å¾å’Œç›®æ ‡ä¹‹é—´çš„æ¨¡å¼ï¼Œå¹¶åˆ©ç”¨å®ƒä»¬è¿›è¡Œè¿›ä¸€æ­¥é¢„æµ‹çš„è¿‡ç¨‹ã€‚**

*****éªŒè¯æ•°æ®é›†*** â€”è®­ç»ƒæ•°æ®é›†çš„ä¿ç•™éƒ¨åˆ†å°†ç”¨äºè¡¡é‡æˆ‘ä»¬çš„æ¨¡å‹å°†å¦‚ä½•æ¨å¹¿åˆ°ç¬¬ä¸€æ¬¡çœ‹åˆ°çš„æ•°æ®é›†ã€‚è¯¥è¡¡é‡æ ‡å‡†å°†æˆä¸º ***æ ¹æ®è¯„ä¼°æŒ‡æ ‡*** éƒ¨åˆ†é€‰æ‹© ML æ¨¡å‹çš„å®¢è§‚é€‰æ‹©æ ‡å‡†ä¹‹ä¸€ã€‚**

**æˆ‘èƒ½å¬åˆ°ä½ åœ¨æƒ³ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ä½¿ç”¨æµ‹è¯•é›†æ¥é€‰æ‹©æ¨¡å‹å‘¢ï¼Ÿå› ä¸ºï¼Œå¦‚æœæˆ‘ä»¬ä¸ºæ­¤ç›®çš„ä½¿ç”¨æµ‹è¯•é›†ï¼Œæˆ‘ä»¬å°†é€‰æ‹©ä¸€ä¸ªç»è¿‡è®­ç»ƒå®Œå…¨é€‚åˆæˆ‘ä»¬çš„æµ‹è¯•é›†çš„æœ‰åæ¨¡å‹ã€‚æ­¤å¤–ï¼Œæ¨¡å‹æ€§èƒ½ä¸å…·æœ‰ä»£è¡¨æ€§ã€‚**

**å½“æˆ‘ä»¬åœ¨ ***åˆ—è½¦ä¸Šè¯„ä¼°æˆ‘ä»¬å®Œå…¨æŒ‡å®šçš„æ¨¡å‹å’Œè¯„ä¼°æ¨¡å‹*** æ—¶ï¼Œæµ‹è¯•è£…ç½®å°†å‘æŒ¥ä½œç”¨ã€‚**

**æ ¹æ®ä¸Šé¢çš„ä¿¡æ¯ï¼Œè®©æˆ‘ä»¬é€šè¿‡éšæœºåˆ†ç¦» 25%çš„è®­ç»ƒé›†æ¥åˆ›å»ºéªŒè¯é›†:**

```
**X_train, X_valid, y_train, y_valid = train_test_split(
    train_features, 
    train_target, 
    test_size=0.25, 
    random_state=42)**
```

**å­˜å‚¨åº“ä¸­çš„`[notebooks/transformed](https://github.com/cereniyim/Wine-Rating-Predictor-ML-Model/tree/master/notebooks/transformed)`ä¸‹æä¾›äº†è®­ç»ƒã€éªŒè¯å’Œæµ‹è¯•æ•°æ®é›†ã€‚å®ƒä»¬éƒ½å‡†å¤‡å¥½è¢«è¾“å…¥è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨äº†ï¼**

# **ç»“è®º**

**åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å®Œæˆäº†æœºå™¨å­¦ä¹ æµæ°´çº¿çš„å‰ä¸‰ä¸ªæ­¥éª¤ã€‚åœ¨å®šä¹‰äº†é—®é¢˜å’Œç›®æ ‡ä¹‹åï¼Œæˆ‘ä»¬**

1.  **é€šè¿‡ç§»é™¤å†—ä½™å’Œå…±çº¿è¦ç´ æ¸…ç†æ•°æ®ï¼›å’Œé‡å¤è¡Œ**
2.  **æµè§ˆæ•°æ®ä»¥è¯¦ç»†äº†è§£ç›®æ ‡ã€åŠŸèƒ½åŠå…¶å…³ç³»**
3.  **å¢åŠ äº†æ›´å¤šæœ‰ç”¨çš„åŠŸèƒ½(å¸Œæœ›å¦‚æ­¤ï¼)ï¼Œå‡†å¤‡å¹¶è½¬æ¢äº†ä¸¤ä¸ªæ•°æ®é›†**

**æˆ‘ä»¬è¿˜å®Œæˆäº†ä»è®­ç»ƒé›†åˆ›å»ºéªŒè¯é›†çš„å…³é”®æ­¥éª¤ã€‚**

**ç¬¬äºŒç¯‡æ–‡ç« å°†å±•ç¤ºå¦‚ä½•é€‰æ‹©è¯„ä¼°æŒ‡æ ‡ã€å»ºç«‹åŸºçº¿ã€é€‰æ‹© ML æ¨¡å‹å¹¶é€šè¿‡ä¼˜åŒ–æ‰€é€‰æ¨¡å‹çš„è¯„ä¼°æŒ‡æ ‡æ¥è°ƒæ•´å…¶è¶…å‚æ•°(æ­¥éª¤ 4ã€5 å’Œ 6)ã€‚**

**[](/building-an-automated-machine-learning-pipeline-part-two-1d3c86e6fe42) [## æ„å»ºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ ç®¡é“:ç¬¬äºŒéƒ¨åˆ†

### è®¾ç½®è¯„ä¼°æŒ‡æ ‡&å»ºç«‹åŸºçº¿ã€é€‰æ‹©ç®—æ³•å’Œæ‰§è¡Œè¶…å‚æ•°è°ƒæ•´â€¦

towardsdatascience.com](/building-an-automated-machine-learning-pipeline-part-two-1d3c86e6fe42) 

ç¬¬ä¸‰ç¯‡æ–‡ç« å°†åˆ†åˆ«ç”¨è®­ç»ƒæ•°æ®é›†å’Œæµ‹è¯•æ•°æ®é›†å¯¹æ¨¡å‹è¿›è¡Œè®­ç»ƒå’Œè¯„ä¼°ã€‚å®ƒå°†å±•ç¤ºå¦‚ä½•è§£é‡Šä¸€ä¸ª ML æ¨¡å‹çš„é¢„æµ‹å¹¶å¾—å‡ºç»“è®º(æ­¥éª¤ 7ã€8 å’Œ 9)ã€‚

[](/building-an-automated-machine-learning-pipeline-a74acda76b98) [## æ„å»ºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ ç®¡é“

### è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹ï¼Œè§£é‡Šæ¨¡å‹ç»“æœå’Œæœ€ç»ˆç»“è®º

towardsdatascience.com](/building-an-automated-machine-learning-pipeline-a74acda76b98) 

ä¸Šä¸€ç¯‡æ–‡ç« å°†ä½¿ç”¨ [Docker](https://www.docker.com/) å’Œ [Luigi](https://luigi.readthedocs.io/en/stable/) æ¥è‡ªåŠ¨åŒ–è¿™æ¡æµæ°´çº¿ã€‚

[](/building-an-automated-machine-learning-pipeline-part-four-787cdc50a12d) [## æ„å»ºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ ç®¡é“:ç¬¬å››éƒ¨åˆ†

### åˆ©ç”¨ Docker å’Œ Luigi å®ç°ç®¡é“è‡ªåŠ¨åŒ–

towardsdatascience.com](/building-an-automated-machine-learning-pipeline-part-four-787cdc50a12d) 

æ„Ÿè°¢é˜…è¯»ğŸ˜Šç°åœ¨æ–‡ç« ç³»åˆ—å®Œæˆäº†ï¼Œä½ å¯ä»¥é˜…è¯»ä¸‹ä¸€ç¯‡äº†ï¼

å¯¹äºè¯„è®ºæˆ–å»ºè®¾æ€§çš„åé¦ˆï¼Œæ‚¨å¯ä»¥é€šè¿‡å›å¤ã€ [Twitter](https://twitter.com/cereniyim) æˆ– [Linkedin](https://www.linkedin.com/in/ceren-iyim) è”ç³»æˆ‘ï¼

åœ¨é‚£ä¹‹å‰ä¿æŒå®‰å…¨å’Œå¥åº·ğŸ‘‹**