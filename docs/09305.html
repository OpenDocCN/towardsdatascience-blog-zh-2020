<html>
<head>
<title>Introduction to Logging in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 日志记录简介</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/logging-in-python-a1415d0b8141?source=collection_archive---------25-----------------------#2020-07-03">https://towardsdatascience.com/logging-in-python-a1415d0b8141?source=collection_archive---------25-----------------------#2020-07-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="b073" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">编程；编排</h2><div class=""/><div class=""><h2 id="ef84" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">如何用 Python 记录消息，避免打印语句？</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/4045969b7a6f00b2088f6befd45b10eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*z01yUxHC_fhR8LWT06n1sw.jpeg"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">图片来自<a class="ae la" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3088958" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae la" href="https://pixabay.com/users/xresch-7410129/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=3088958" rel="noopener ugc nofollow" target="_blank"> xresch </a></p></figure><p id="834b" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">日志可能是任何软件开发中最被低估的方面。日志记录通过记录程序的事件来帮助开发健壮的程序。日志记录有多种用途，从调试到监控应用程序。</p><p id="7d29" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">Python 的标准库提供了一个日志模块。在本文中，我将向您展示如何将日志添加到您的程序中，并开发更好的应用程序。</p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><p id="924a" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">要在应用程序中使用日志记录，请导入日志记录模块</p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="e224" class="mj mk iq mf b be ml mm l mn mo">import logging</span></pre><h2 id="5ceb" class="mp mk iq bd mq mr ms dn mt mu mv dp mw lk mx my mz lo na nb nc ls nd ne nf iw bi translated">日志记录级别</h2><p id="ed35" class="pw-post-body-paragraph lb lc iq ld b le ng ka lg lh nh kd lj lk ni lm ln lo nj lq lr ls nk lu lv lw ij bi translated">日志模块预定义了 5 个严重级别，如下所示:</p><pre class="kp kq kr ks gt me mf nl nm aw nn bi"><span id="ab22" class="mp mk iq mf b gy no np l nq mo">┌──────────┬───────┐<br/>│  <strong class="mf ja">Level   </strong>│ <strong class="mf ja">Value </strong>│<br/>├──────────┼───────┤<br/>│ CRITICAL │    50 │<br/>│ ERROR    │    40 │<br/>│ WARNING  │    30 │<br/>│ INFO     │    20 │<br/>│ DEBUG    │    10 │<br/>└──────────┴───────┘</span></pre><p id="92b8" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">默认级别是警告，这意味着只记录该级别及以上的事件。</p><p id="7d31" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">日志模块提供了一组简单易用的函数。如下例所示:</p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="0082" class="mj mk iq mf b be ml mm l mn mo">import logging<br/><br/>logging.debug('Debug message')<br/>logging.info('Info message')<br/>logging.warning('Warning message')<br/>logging.error('Error message')<br/>logging.critical('Critical message')</span></pre><p id="e5a5" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">上述示例的输出将是:</p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="4185" class="mj mk iq mf b be ml mm l mn mo">WARNING:root:Warning message<br/>ERROR:root:Error message<br/>CRITICAL:root:Critical message</span></pre><p id="c41d" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这是因为默认日志记录级别设置为警告。</p><h2 id="f158" class="mp mk iq bd mq mr ms dn mt mu mv dp mw lk mx my mz lo na nb nc ls nd ne nf iw bi translated">更改日志记录级别</h2><p id="32b1" class="pw-post-body-paragraph lb lc iq ld b le ng ka lg lh nh kd lj lk ni lm ln lo nj lq lr ls nk lu lv lw ij bi translated">记录模块提供了设置记录器基本配置的功能。</p><p id="99f6" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">要更改记录器的级别，请为<code class="fe nr ns nt mf b">basicConfig()</code>传递<code class="fe nr ns nt mf b">level</code>参数。</p><p id="d3fb" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="nu">举例:</em> </strong></p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="299f" class="mj mk iq mf b be ml mm l mn mo">import logging<br/><br/>logging.basicConfig(level=logging.INFO)<br/><br/>logging.debug('Debug message')<br/>logging.info('Info message')<br/>logging.error('Error message')</span></pre><p id="ae6e" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">上述示例的输出将是:</p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="6cf3" class="mj mk iq mf b be ml mm l mn mo">INFO:root:Info message<br/>ERROR:root:Error message</span></pre><p id="c3a4" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在本例中，日志记录级别设置为 INFO。因此，将记录“信息消息”,但不会记录“调试消息”,因为信息级别高于调试级别。</p><h2 id="667d" class="mp mk iq bd mq mr ms dn mt mu mv dp mw lk mx my mz lo na nb nc ls nd ne nf iw bi translated">记录到文件中</h2><p id="d72b" class="pw-post-body-paragraph lb lc iq ld b le ng ka lg lh nh kd lj lk ni lm ln lo nj lq lr ls nk lu lv lw ij bi translated">要将消息记录到文件中，只需在<code class="fe nr ns nt mf b">basicConfig()</code>的<code class="fe nr ns nt mf b">filename</code>参数中传递文件名</p><p id="3cb3" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="nu">例如:</em> </strong></p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="089b" class="mj mk iq mf b be ml mm l mn mo">import logging<br/><br/>logging.basicConfig(filename='sample.log', level=logging.INFO)<br/><br/>logging.debug('Debug message')<br/>logging.info('Info message')<br/>logging.error('Error message')</span></pre><p id="1f15" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">该文件的内容将是:</p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="f888" class="mj mk iq mf b be ml mm l mn mo">INFO:root:Info message<br/>ERROR:root:Error message</span></pre><h2 id="18e8" class="mp mk iq bd mq mr ms dn mt mu mv dp mw lk mx my mz lo na nb nc ls nd ne nf iw bi translated">更改日志记录格式</h2><p id="4e94" class="pw-post-body-paragraph lb lc iq ld b le ng ka lg lh nh kd lj lk ni lm ln lo nj lq lr ls nk lu lv lw ij bi translated">默认的记录格式是<code class="fe nr ns nt mf b">%(levelname)s:%(name):%(message)s</code>。</p><p id="490d" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">要改变默认格式，我们需要在<code class="fe nr ns nt mf b">basicConfig()</code>中指定<code class="fe nr ns nt mf b">format</code>参数。</p><p id="a238" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="nu">例如:</em> </strong></p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="ee36" class="mj mk iq mf b be ml mm l mn mo">FORMAT = '%(asctime)s:%(name)s:%(levelname)s - %(message)s'<br/><br/>logging.basicConfig(format=FORMAT, level=logging.INFO)<br/>logging.info('Info message')</span></pre><p id="435f" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">相应的输出将是:</p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="6d33" class="mj mk iq mf b be ml mm l mn mo">2020-07-03 00:48:00,106:root:INFO - Info message</span></pre><p id="19b4" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">格式化属性的完整列表可以在<a class="ae la" href="https://docs.python.org/3/library/logging.html#logrecord-attributes" rel="noopener ugc nofollow" target="_blank">官方文档</a>中找到。</p><h2 id="ed31" class="mp mk iq bd mq mr ms dn mt mu mv dp mw lk mx my mz lo na nb nc ls nd ne nf iw bi translated">更改日期格式</h2><p id="a674" class="pw-post-body-paragraph lb lc iq ld b le ng ka lg lh nh kd lj lk ni lm ln lo nj lq lr ls nk lu lv lw ij bi translated">要更改日志中显示的日期格式，我们需要更改<code class="fe nr ns nt mf b">datefmt</code>参数。</p><p id="32ce" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="nu">例如:</em> </strong></p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="9e78" class="mj mk iq mf b be ml mm l mn mo">FORMAT = '%(asctime)s:%(name)s:%(levelname)s - %(message)s'<br/><br/>logging.basicConfig(format=FORMAT, <br/>                    level=logging.INFO, <br/>                    datefmt='%Y-%b-%d %X%z')<br/><br/>logging.info('Info message')</span></pre><p id="50cc" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="nu">输出:</em> </strong></p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="22ef" class="mj mk iq mf b be ml mm l mn mo">2020-Jul-03 00:56:31+0530:root:INFO - Info message</span></pre><p id="04b1" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">可用日期格式列表可在<a class="ae la" href="https://docs.python.org/3/library/time.html#time.strftime" rel="noopener ugc nofollow" target="_blank">文档</a>中找到。</p><h2 id="5732" class="mp mk iq bd mq mr ms dn mt mu mv dp mw lk mx my mz lo na nb nc ls nd ne nf iw bi translated">异常记录</h2><p id="d447" class="pw-post-body-paragraph lb lc iq ld b le ng ka lg lh nh kd lj lk ni lm ln lo nj lq lr ls nk lu lv lw ij bi translated">要记录异常的跟踪，您可以使用<code class="fe nr ns nt mf b">logging.exception</code>或使用<code class="fe nr ns nt mf b">logging.error</code>和<code class="fe nr ns nt mf b">exc_info=True</code>。</p><p id="6c37" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="nu">例-1:有记录错误</em> </strong></p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="7037" class="mj mk iq mf b be ml mm l mn mo">try:<br/>    5/0<br/><br/>except:<br/>    logging.error('Exception occured')</span></pre><p id="a41e" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="nu">输出-1: </em> </strong></p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="bf65" class="mj mk iq mf b be ml mm l mn mo">ERROR:root:Exception occured</span></pre><p id="f4cb" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="nu">例-2:with logging . error and exc _ info = True</em></strong></p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="e120" class="mj mk iq mf b be ml mm l mn mo">try:<br/>    5/0<br/><br/>except:<br/>    logging.error('Exception occured', exc_info=True)</span></pre><p id="8f18" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="nu">输出 2: </em> </strong></p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="89ad" class="mj mk iq mf b be ml mm l mn mo">ERROR:root:Exception occured<br/>Traceback (most recent call last):<br/>  File "&lt;ipython-input-2-933e0f6b1879&gt;", line 11, in &lt;module&gt;<br/>    5/0<br/>ZeroDivisionError: division by zero</span></pre><p id="39d1" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="nu">例-3:有日志记录.异常</em> </strong></p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="1ab2" class="mj mk iq mf b be ml mm l mn mo">try:<br/>    5/0<br/><br/>except:<br/>    logging.exception('Exception occured')</span></pre><p id="aa75" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="nu">输出-3: </em> </strong></p><pre class="kp kq kr ks gt me mf mg bn mh mi bi"><span id="bd8f" class="mj mk iq mf b be ml mm l mn mo">ERROR:root:Exception occured<br/>Traceback (most recent call last):<br/>  File "&lt;ipython-input-3-e7d1d57e6056&gt;", line 11, in &lt;module&gt;<br/>    5/0<br/>ZeroDivisionError: division by zero</span></pre></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h2 id="e371" class="mp mk iq bd mq mr ms dn mt mu mv dp mw lk mx my mz lo na nb nc ls nd ne nf iw bi translated">结论</h2><p id="9c97" class="pw-post-body-paragraph lb lc iq ld b le ng ka lg lh nh kd lj lk ni lm ln lo nj lq lr ls nk lu lv lw ij bi translated">我希望您能够理解 Python 中日志记录的基础知识。通过这篇文章，您可以开始将日志记录用于任何应用程序的各种目的，例如调试、使用监控和性能监控。您可以参考<a class="ae la" href="https://docs.python.org/3/library/logging.html" rel="noopener ugc nofollow" target="_blank">官方文档</a>获取可用方法的完整列表。</p><h2 id="46ff" class="mp mk iq bd mq mr ms dn mt mu mv dp mw lk mx my mz lo na nb nc ls nd ne nf iw bi translated"><strong class="ak">资源</strong></h2><p id="dc47" class="pw-post-body-paragraph lb lc iq ld b le ng ka lg lh nh kd lj lk ni lm ln lo nj lq lr ls nk lu lv lw ij bi translated">本文中使用的代码片段可以在我的<a class="ae la" href="https://jimit105.github.io/medium-articles/Introduction%20to%20Logging%20in%20Python.html" rel="noopener ugc nofollow" target="_blank"> GitHub 页面</a>上找到。</p><h2 id="125c" class="mp mk iq bd mq mr ms dn mt mu mv dp mw lk mx my mz lo na nb nc ls nd ne nf iw bi translated">参考</h2><ul class=""><li id="8ed6" class="nv nw iq ld b le ng lh nh lk nx lo ny ls nz lw oa ob oc od bi translated"><a class="ae la" href="https://docs.python.org/3/library/logging.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3/library/logging.html</a></li><li id="4f70" class="nv nw iq ld b le oe lh of lk og lo oh ls oi lw oa ob oc od bi translated"><a class="ae la" href="https://docs.python.org/3/howto/logging.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3/howto/logging.html</a></li></ul><h2 id="18e2" class="mp mk iq bd mq mr ms dn mt mu mv dp mw lk mx my mz lo na nb nc ls nd ne nf iw bi translated">让我们连接</h2><p id="4def" class="pw-post-body-paragraph lb lc iq ld b le ng ka lg lh nh kd lj lk ni lm ln lo nj lq lr ls nk lu lv lw ij bi translated">领英:<a class="ae la" href="https://www.linkedin.com/in/jimit105/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/jimit105/</a><br/>GitHub:<a class="ae la" href="https://github.com/jimit105" rel="noopener ugc nofollow" target="_blank">https://github.com/jimit105</a><br/>推特:<a class="ae la" href="https://twitter.com/jimit105" rel="noopener ugc nofollow" target="_blank">https://twitter.com/jimit105</a></p></div></div>    
</body>
</html>