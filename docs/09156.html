<html>
<head>
<title>Extracting Text from Scanned PDF using Pytesseract &amp; Open CV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Pytesseract &amp; Open CV 从扫描的 PDF 中提取文本</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/extracting-text-from-scanned-pdf-using-pytesseract-open-cv-cd670ee38052?source=collection_archive---------0-----------------------#2020-07-01">https://towardsdatascience.com/extracting-text-from-scanned-pdf-using-pytesseract-open-cv-cd670ee38052?source=collection_archive---------0-----------------------#2020-07-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="64d5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 Python 和其他开源库的文档智能</h2></div><p id="8d36" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从发票的数字副本中提取信息的过程可能是一项棘手的任务。市场上有各种工具可以用来完成这项任务。然而，有许多因素导致大多数人希望使用开源库来解决这个问题。</p><p id="af2c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">几天前，我遇到了一个类似的问题，我想和你分享我解决这个问题的所有方法。我用来开发这个解决方案的库是<strong class="kk iu"> pdf2image </strong>(用于将 pdf 转换成图像)<strong class="kk iu">、OpenCV </strong>(用于图像预处理)，最后是用于 OCR 的<strong class="kk iu">pytesserac</strong>以及<strong class="kk iu"> Python </strong>。</p><h1 id="9c71" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated"><strong class="ak">将 PDF 转换为图像</strong></h1><p id="3bc4" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">pdf2image 是一个 python 库，它使用 pdftoppm 库将 pdf 转换为一系列 PIL 图像对象。以下命令可用于使用 pip 安装方法安装 pdf2image 库。</p><blockquote class="mb mc md"><p id="871a" class="ki kj me kk b kl km ju kn ko kp jx kq mf ks kt ku mg kw kx ky mh la lb lc ld im bi translated">pip 安装 pdf2image</p></blockquote><p id="c7aa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意:pdf2image 使用的<strong class="kk iu"> <em class="me"> Poppler </em> </strong>是基于 xpdf-3.0 代码库的 pdf 渲染库，没有它就无法工作。有关 Poppler 的下载和安装说明，请参考以下资源。</p><p id="ea4b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae mi" href="https://anaconda.org/conda-forge/poppler" rel="noopener ugc nofollow" target="_blank"><em class="me">https://anaconda.org/conda-forge/popple</em></a><em class="me">r</em></p><p id="1feb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae mi" href="https://stackoverflow.com/questions/18381713/how-to-install-poppler-on-windows" rel="noopener ugc nofollow" target="_blank"><em class="me">https://stack overflow . com/questions/18381713/how-to-install-poppler-on-windows</em></a></p><p id="fdd5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">安装后，任何 pdf 可以转换成图像使用以下代码。</p><figure class="mj mk ml mm gt mn"><div class="bz fp l di"><div class="mo mp l"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">使用 Python 将 PDF 转换为图像</p></figure><p id="cc71" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将 PDF 转换为图像后，下一步是突出显示我们必须从中提取信息的图像区域。</p><blockquote class="mb mc md"><p id="c79b" class="ki kj me kk b kl km ju kn ko kp jx kq mf ks kt ku mg kw kx ky mh la lb lc ld im bi translated">注意:在标记区域之前，请确保您已经对图像进行了预处理以提高其质量(DPI ≥ 300，应调整偏斜度、锐度和亮度、阈值等。)</p></blockquote><h1 id="a1f1" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated"><strong class="ak">标记用于信息提取的图像区域</strong></h1><p id="f312" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">在这一步中，我们将标记图像中需要提取数据的区域。在用矩形标记了这些区域之后，我们将从原始图像中一个接一个地裁剪这些区域，然后将它们提供给 OCR 引擎。</p><blockquote class="mb mc md"><p id="8050" class="ki kj me kk b kl km ju kn ko kp jx kq mf ks kt ku mg kw kx ky mh la lb lc ld im bi translated">我们大多数人都会想到这一点——为什么我们要在进行 OCR 之前标记图像中的区域，而不是直接进行呢？</p><p id="19c1" class="ki kj me kk b kl km ju kn ko kp jx kq mf ks kt ku mg kw kx ky mh la lb lc ld im bi translated">这个问题的简单答案是你可以</p><p id="96f4" class="ki kj me kk b kl km ju kn ko kp jx kq mf ks kt ku mg kw kx ky mh la lb lc ld im bi translated">此问题的唯一问题是，有时文档中嵌入了隐藏的换行符/分页符，如果此文档直接传递到 OCR 引擎，数据的连续性会自动中断(因为 OCR 会识别换行符)。</p></blockquote><p id="b4b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过这种方法，我们可以对任何给定的文档获得最大的正确结果。在我们的例子中，我们将尝试使用完全相同的方法从发票中提取信息。</p><p id="480b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下代码可用于标记图像中感兴趣的区域，并获得它们各自的坐标。</p><figure class="mj mk ml mm gt mn"><div class="bz fp l di"><div class="mo mp l"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">用于标记图像中感兴趣区域的 Python 代码</p></figure><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mu"><img src="../Images/26c16afcca05575204eb82d274ce7439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eTJ5_mezfc-K3WKyxpls8Q.jpeg"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">原始图像(来源:Abbyy OCR 工具示例发票图像)</p></figure><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mu"><img src="../Images/bf3b914b7accf1ae0271b302afa1613c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YiYMZB6XMV3s8R0tNrqI1A.jpeg"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">图像中标记的感兴趣区域(来源:Abbyy OCR 工具样本发票图像)</p></figure><h1 id="4f81" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated"><strong class="ak">对图像应用光学字符识别</strong></h1><p id="97ef" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">一旦我们标记了感兴趣的区域(以及相应的坐标),我们就可以简单地裁剪特定区域的原始图像，并通过 pytesseract 来获得结果。</p><p id="d659" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于那些不熟悉 Python 和 OCR 的人来说，pytesseract 可能是一个让人不知所措的词。根据它的官方网站-</p><blockquote class="mb mc md"><p id="1029" class="ki kj me kk b kl km ju kn ko kp jx kq mf ks kt ku mg kw kx ky mh la lb lc ld im bi translated">Python-tesseract 是<a class="ae mi" href="https://github.com/tesseract-ocr/tesseract" rel="noopener ugc nofollow" target="_blank">谷歌的 Tesseract-OCR 引擎</a>的包装器。它作为 tesseract 的独立调用脚本也很有用，因为它可以读取 Pillow 和 Leptonica 图像库支持的所有图像类型，包括 jpeg、png、gif、bmp、tiff 等。此外，如果用作脚本，Python-tesseract 将打印识别的文本，而不是将其写入文件。</p></blockquote><p id="8fc3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另外，如果你想玩玩 pytesseract 的配置参数，我建议你先浏览下面的链接。</p><div class="nb nc gp gr nd ne"><a href="https://pypi.org/project/pytesseract/" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd iu gy z fp nj fr fs nk fu fw is bi translated">宇宙魔方</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">Python-tesseract 是 Python 的光学字符识别(OCR)工具。也就是说，它会识别并“读取”…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">pypi.org</p></div></div><div class="nn l"><div class="no l np nq nr nn ns mz ne"/></div></div></a></div><div class="nb nc gp gr nd ne"><a href="https://stackoverflow.com/questions/44619077/pytesseract-ocr-multiple-config-options" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd iu gy z fp nj fr fs nk fu fw is bi translated">Pytesseract OCR 多个配置选项</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">感谢贡献一个堆栈溢出的答案！请务必回答问题。提供详细信息并分享…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">stackoverflow.com</p></div></div><div class="nn l"><div class="nt l np nq nr nn ns mz ne"/></div></div></a></div><p id="24f2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下代码可用于执行此任务。</p><figure class="mj mk ml mm gt mn"><div class="bz fp l di"><div class="mo mp l"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">裁剪图像，然后执行 OCR</p></figure><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nu"><img src="../Images/632f1743fd1ac2a2a4ae7b046a59249f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Omos0aoeTCSk2DXdl97KLQ.jpeg"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">裁剪后的图像-1 来自原始图像(来源:Abbyy OCR 工具示例发票图像)</p></figure><p id="85f5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">OCR 的输出:</p><pre class="mj mk ml mm gt nv nw nx ny aw nz bi"><span id="049b" class="oa lf it nw b gy ob oc l od oe">Payment:<br/><br/>Mr. John Doe<br/><br/>Green Street 15, Office 4<br/>1234 Vermut<br/><br/>New Caledonia</span></pre><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi of"><img src="../Images/629641e0784446d8fa7371b772e4006e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L_kWBVRIPoGTAVooqOFZhw.jpeg"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">裁剪后的图像-2 来自原始图像(来源:Abbyy OCR 工具示例发票图像)</p></figure><p id="ff6d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">OCR 输出</p><pre class="mj mk ml mm gt nv nw nx ny aw nz bi"><span id="bc04" class="oa lf it nw b gy ob oc l od oe">COMPLETE OVERHAUL 1 5500.00 5500.00 220<br/>REFRESHING COMPLETE CASE 1 380.00 380.00 220<br/>AND RHODIUM BATH</span></pre><p id="0cea" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如你所见，我们输出的准确率是 100%。</p><p id="ed3a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以这一切都是关于如何开发一个从复杂文档(比如发票)中提取数据的解决方案。</p></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><p id="a59e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">OCR 在文档智能方面有许多应用。使用 pytesseract，无论文档的格式如何(无论是扫描的文档、pdf 还是简单的 jpeg 图像)，都可以提取几乎所有的数据。</p><p id="90d4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，由于它是开源的，所以整个解决方案既灵活又不昂贵。</p></div></div>    
</body>
</html>