<html>
<head>
<title>How to Update Your Live Django Website</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何更新你的 Django 网站</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-update-your-live-django-website-b84645753ea1?source=collection_archive---------19-----------------------#2020-09-07">https://towardsdatascience.com/how-to-update-your-live-django-website-b84645753ea1?source=collection_archive---------19-----------------------#2020-09-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0366" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">数字海洋的逐步指南以及 AWS EB、Heroku 和 Azure 的链接</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0ad10b13d439127c7614c5d06f47114f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yTmmWLYY9gbPTT3AeS9xGg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我的 Django-数字海洋网络应用。图片作者。</p></figure><p id="7139" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我最近用 Django 开发了一个网络应用程序(<a class="ae lu" href="https://www.crackshort.co/" rel="noopener ugc nofollow" target="_blank">见此</a>)并通过 DigitalOcean 部署了它。</p><p id="71f2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用 DigitalOcean 有很多绝妙的理由，但更新不是其中之一。因为它是云托管提供商，而不是像 AWS Elastic Beanstalk 一样的 PaaS，<strong class="la iu">更新过程 100%是你的问题</strong>。</p><p id="7bc6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，如果您也部署了 DigitalOcean，您可能会意识到关于如何运行更新的资源非常少。这就是我进来的地方。</p><p id="475a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我已经在我如何建立我的网站的详细演练中写了这个过程(如果你愿意，你可以在下面阅读)，但我想详细说明这一点，以帮助填补像我这样的初学者的知识空白。</p><div class="lv lw gp gr lx ly"><a rel="noopener follow" target="_blank" href="/from-zero-to-full-stack-web-development-in-37-days-97b8c254a3d1"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd iu gy z fp md fr fs me fu fw is bi translated">37 天内从零到全栈 web 开发</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">以及如何更快地完成它</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">towardsdatascience.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm ks ly"/></div></div></a></div><p id="5403" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">如果你部署在数字海洋之外的地方，更新会容易得多，这里有一些可能与你相关的页面:</strong></p><ul class=""><li id="cf6b" class="mn mo it la b lb lc le lf lh mp ll mq lp mr lt ms mt mu mv bi translated">AWS 弹性豆茎(<a class="ae lu" href="https://aws.amazon.com/getting-started/hands-on/update-an-app/" rel="noopener ugc nofollow" target="_blank">控制台</a> / <a class="ae lu" href="https://stackoverflow.com/questions/42723302/how-to-update-an-elastic-beanstalk-app-from-the-aws-command-line-tool" rel="noopener ugc nofollow" target="_blank">命令行界面</a>)</li><li id="561b" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated"><a class="ae lu" href="https://devcenter.heroku.com/articles/git" rel="noopener ugc nofollow" target="_blank"> Heroku </a></li><li id="6ba1" class="mn mo it la b lb mw le mx lh my ll mz lp na lt ms mt mu mv bi translated"><a class="ae lu" href="https://www.quora.com/How-do-I-update-a-website-that-is-already-hosted-in-Microsoft-azure" rel="noopener ugc nofollow" target="_blank">微软 Azure </a></li></ul><h1 id="a366" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">如何更新您现有的网站/应用程序</h1><p id="9131" class="pw-post-body-paragraph ky kz it la b lb nt ju ld le nu jx lg lh nv lj lk ll nw ln lo lp nx lr ls lt im bi translated"><strong class="la iu">步骤 1: If Django: </strong>为本地调试配置您的 Django 设置。您需要这样做来在您的本地主机上运行您正在进行的工作。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="e5b1" class="od nc it nz b gy oe of l og oh"># in settings.py<br/>DEBUG = True<br/>ALLOWED_HOSTS = []</span></pre><p id="9915" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您在设置文件中使用自定义变量在“实时”和“本地”模式之间切换，尤其是当您的数据库也发生变化时(例如，如果您使用 PostgreSQL)，您可以使这变得稍微容易一些。</p><p id="c939" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个例子中，当我想要编辑或部署时，我所做的就是切换<em class="oi"> live_deploy </em>变量。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="e0c4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">步骤 2: </strong>更新项目代码。</p><p id="641b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第三步:如果姜戈:进行迁移。在本地进行迁移，但在服务器上进行迁移，因为迁移文件是源代码的一部分，不应该在服务器上被篡改。阅读这篇 StackOverflow 帖子了解更多信息。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="ddec" class="od nc it nz b gy oe of l og oh"># in terminal<br/>python3 manage.py makemigrations</span></pre><p id="21e8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">第 4 步:如果 Django: </strong>重新配置您的设置以进行实时部署。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="9d71" class="od nc it nz b gy oe of l og oh"># in settings.py<br/>DEBUG = False<br/>ALLOWED_HOSTS = ['00.000.0.000','www.yourdomain.com'] # insert your IP or domain</span></pre><p id="35ee" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">第五步:</strong>准备好你的修改，提交到 Git，然后<em class="oi">推送到你选择的远程存储库。非常重要，因为在数字海洋(步骤 8)中，遥控器是您获取代码的地方。</em></p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="0ed3" class="od nc it nz b gy oe of l og oh"># in terminal<br/>git commit -m "your commit message"<br/>git push origin master</span></pre><p id="d6a5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">第六步:</strong>使用 SSH 登录您的数字海洋虚拟机。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="7b7c" class="od nc it nz b gy oe of l og oh"># in terminal<br/>ssh user@00.000.0.000</span></pre><p id="e9c7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">步骤 7: </strong>激活您的项目所使用的虚拟环境，因为您需要运行 Django 命令。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="fa1a" class="od nc it nz b gy oe of l og oh"># in terminal<br/>source venv/bin/activate #replace with your venv</span></pre><p id="364d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">步骤 8: </strong>从您的项目目录中，从您的远程存储库中提取<em class="oi"> </em>您的更新代码。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="4e43" class="od nc it nz b gy oe of l og oh"># in terminal<br/>cd /your/project/dir<br/>git pull origin</span></pre><p id="d5f1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">步骤 9:如果 Django: </strong>运行迁移并收集静态。<strong class="la iu">不进行迁移</strong> —参考步骤 3。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="8b8b" class="od nc it nz b gy oe of l og oh"># in terminal<br/>python3 manage.py migrate<br/>python3 manage.py collectstatic</span></pre><p id="a17c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">步骤 10: </strong>重启 Gunicorn(您的 WSGI 服务器)以应用更改。通常情况下，您不需要重启 NGINX，因为不会对 web 服务器进行任何更改——我唯一一次重启是在更新 SSL 证书的时候。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="f701" class="od nc it nz b gy oe of l og oh"># in terminal<br/>sudo service gunicorn restart<br/>sudo service nginx restart #only if you need to</span></pre><p id="437b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">看起来有点冗长，但重要的是坚持所有的步骤，以确保您的新代码正确配置用于实时部署，使其进入虚拟机，并显示在您的网站或应用程序中。</p><p id="5680" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想自动更新，你可以用 Fabric 和 Ansible 来实现。你可以在这里找到一个相当完整的指南，所以我就不详述了。</p><p id="07c8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是，如果你像我一样刚刚开始，你可能不需要频繁更新，而是喜欢尽可能保持简单。</p><p id="c34d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这种情况下，这 10 个步骤将是您每次可靠地运行更新所需要的全部。</p></div></div>    
</body>
</html>