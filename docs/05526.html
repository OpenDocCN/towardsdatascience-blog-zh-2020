<html>
<head>
<title>How to change your data in excel to do Effective Tail Spend Management? Step by Step Guide | Chapter 03</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何改变你在 excel 中的数据来做有效的尾部支出管理？逐步指南|第 03 章</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/tail-spend-analysis-chapter-03-data-preparation-7ae11af97487?source=collection_archive---------36-----------------------#2020-05-09">https://towardsdatascience.com/tail-spend-analysis-chapter-03-data-preparation-7ae11af97487?source=collection_archive---------36-----------------------#2020-05-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1213" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><strong class="jq ir">第 03 章—逐步指南的数据准备</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/d72020c75f6c5bbffadeb5cc3ac10758.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s--P4txFVJsuFs45HUODZA.png"/></div></div></figure><p id="185c" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">在花了几年时间用 Excel、Tableau、Python 进行采购分析，并详细评估了当前市场供应商的产品功能后，我可以自信地说，支出分析作为一个问题被高估和高估了。是的，在支出分析中，机器学习变得绝对必要(我们将在后续章节中讨论这些部分)，但如果你的公司刚刚开始进行支出分析，Excel(或者任何可以切割数据的工具)将会很好地完成这项工作。<em class="ky">一切都是为了准备和细节，而不是复杂的工具</em></p><p id="6d5e" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">我们现在将着手准备我们的数据集。你可以在这里找到样本数据集<a class="ae kz" href="https://github.com/procupine/tailspend" rel="noopener ugc nofollow" target="_blank"/>。除了我们在第 2 章中讨论的 4 列之外，我还添加了另外两列，即“供应商类别”和“采购订单类别”。“供应商类别”基于供应商数量，“采购订单类别”基于“采购订单数量”。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi la"><img src="../Images/84d0f34e4041c4ae026fb0cd6ed8d82e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4F0duPidHLp61b9fXZY9Bw.png"/></div></div></figure><h2 id="88bc" class="lb lc iq bd ld le lf dn lg lh li dp lj jz lk ll lm kd ln lo lp kh lq lr ls lt bi translated"><strong class="ak">花类:</strong></h2><p id="c7fb" class="pw-post-body-paragraph jo jp iq jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl ij bi translated">让我们继续添加我们的第一列“消费类”。请仔细遵循以下步骤:</p><p id="4f66" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><strong class="jq ir">步骤 1: </strong>使用“raw_dataset”工作表插入一个透视文件，并重新排列行&amp;列以匹配下图。确保以下字段处于正确的位置:</p><p id="d5e7" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky">商品描述:成排</em></p><p id="a14b" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky">总 PO 值:In Values(商品描述的排列百分比运行合计)。</em>确保该字段按升序排列。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lz"><img src="../Images/0bc50c3c2ec2edc420d408136f5dd9d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bD2sJctt4VY-0qISG3VfVg.png"/></div></div></figure><p id="81b7" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">注意:要获得表示为%(如上所示)的总 PO 值，您必须进入“<em class="ky">值字段设置</em>”选项。这可以通过点击值字段中的下拉箭头(“ITM _ 总计 _AM2 的总和”)&amp;从下拉列表中选择来找到。之后，在“<em class="ky">显示数值为</em>”选项下，选择“<em class="ky"> %运行总数在</em>”。最后一步是选择一个基本字段。在这种情况下，基本字段是“商品描述”。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ma"><img src="../Images/01178dc142c6d881ebf6a29806f18b6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0_7u8UcKbmCteppfRnng5w.png"/></div></div></figure><p id="fa69" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><strong class="jq ir">第二步:</strong>如第 02 章所述，我们的目标是从<em class="ky">尾花</em>中分割出<em class="ky">主花</em>。因此，向下滚动 total %列，直到达到 80%的数字。从 0%到 80%的项目(换句话说，前 80%)将被标记为“<strong class="jq ir">主要花费</strong>的项目。同样，从 80%到 100%(换句话说，最底层的 20%)的项目将被标记为“<strong class="jq ir">尾花</strong>”。将整个列表复制到一个新的单独的 excel 工作表中，并将其命名为“<em class="ky"> WIP 工作表</em>”。现在，您的 excel 文件应该类似于下图。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mb"><img src="../Images/f13f79d76c7ac2e93e55b191e8144db1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9iTydS8-AQdCRMtMMk1qgg.png"/></div></div></figure><p id="c05d" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">在新的 WIP 工作表中，插入一个新列，并将其命名为“<em class="ky">支出类别</em>”(列 C)。在这一栏中，我们会将每个项目标记为“主要支出”项目或“次要支出”项目。对于 B 列，我们有总支出百分比，滚动到 80%支出(即从 0%到 80%)，并在 C 列(“支出类别”)中填写<strong class="jq ir">“主要支出”</strong>。对于剩下的 20%(即从 80%到 100%)，写<strong class="jq ir">“尾花”。</strong>重复此过程，直到到达最后一项。您的"<em class="ky">WIP 工作表"</em>应该如下图所示:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mc"><img src="../Images/6ef73dcbc4805092ed43e2839c9b7285.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RGnpAlkF4JF6ATP4mvTVTg.png"/></div></div></figure><p id="68f9" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><strong class="jq ir">步骤 3: </strong>我们现在几乎准备好在"<em class="ky"> WIP 工作表"</em>中使用这些数据，并将其填充回我们的主"<em class="ky"> raw_data </em>"工作表中。现在只需要一个简单的 Vlookup 就可以了。返回到<em class="ky">“raw _ data”</em>工作表，如上所述，使用商品描述上的<em class="ky">“Vlookup”</em>功能，并选择消费类别来填充它。下面是这样做的公式:</p><blockquote class="md"><p id="ab0e" class="me mf iq bd mg mh mi mj mk ml mm kl dk translated"><strong class="ak"> <em class="jn"> = VLOOKUP(B2，' WIP 工作表'！$A$1:$C$6681，3，FALSE) </em> </strong></p></blockquote><p id="1534" class="pw-post-body-paragraph jo jp iq jq b jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh mr kj kk kl ij bi translated"><em class="ky">其中列 B2 暗示包含商品描述的“raw_data”工作表中的列 B</em></p><p id="a6e0" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky"> $A$1: $C$6681 表示“WIP 工作表标签”中的列，A 列包含商品说明，B 列包含累计百分比，C 列包含支出类别</em></p><p id="d7e0" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">完成后,“raw_data”工作表中的“支出类”列应该如下图所示。<em class="ky">搞定！</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/9f27b2204e4514a559706c2e21721b1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:200/format:webp/1*t1eOqP9x7ZY-hRO6WBqfZw.png"/></div></figure><h2 id="5ea1" class="lb lc iq bd ld le lf dn lg lh li dp lj jz lk ll lm kd ln lo lp kh lq lr ls lt bi translated">合同:</h2><p id="3730" class="pw-post-body-paragraph jo jp iq jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl ij bi translated">让我们添加第二列“合同”。这个简单明了。请参考“<em class="ky"> raw_data </em>”工作表中我命名为“主协议”的列。正如第 02 章所讨论的，逻辑很简单。如果“<em class="ky">主协议</em>栏为空(如下图所示)，我们将填写“<strong class="jq ir">合同不可用</strong>”，如果“<em class="ky">主协议</em>栏不为空，我们将填写“<strong class="jq ir">合同可用</strong>”。我们将使用此逻辑填充所有单元格。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/2a32bdeae8ea55d8509f0515dd1a8b18.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*CVNsGm-Ch-5Ny6-qYv0QRw.png"/></div></figure><p id="23f2" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">下面是这样做的公式:</p><blockquote class="md"><p id="15c7" class="me mf iq bd mg mh mi mj mk ml mm kl dk translated">=IF(I2 &lt;&gt;" "，"合同可用"，"合同不可用")</p></blockquote><p id="3c5e" class="pw-post-body-paragraph jo jp iq jq b jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh mr kj kk kl ij bi translated"><em class="ky">其中 I2 表示“raw_data”工作表中的 I 列(名为“主协议”)。&lt; &gt;“符号表示“不等于”，“符号表示空白”。因此，在这个公式中，我们检查 I2 是否不等于空白，然后写“合同可用”或其他。</em></p><p id="1d26" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">将此公式拖到“<em class="ky">raw _ data”</em>工作表的最后一个单元格。完成后，合同列应该如下图所示。<em class="ky">搞定！</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mc"><img src="../Images/6309ee4cd15aa043f3dba08a439128cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hI0tiIVaYNsrRgltXWX0yg.png"/></div></div></figure><h2 id="4c35" class="lb lc iq bd ld le lf dn lg lh li dp lj jz lk ll lm kd ln lo lp kh lq lr ls lt bi translated"><strong class="ak">采购订单:</strong></h2><p id="7e80" class="pw-post-body-paragraph jo jp iq jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl ij bi translated">我们继续我们的下一个专栏“PO”。这里，我们将重复添加合同列时的相同步骤。只是，我们将使用 K 列(<em class="ky"> Purchase_Order </em>)，而不是 I 列(<em class="ky">主协议</em>)。因此，如果“<em class="ky">采购订单</em>”列为空，我们将写“<strong class="jq ir">采购订单不可用</strong>”，如果“采购订单”列不为空，我们将写“<strong class="jq ir">采购订单可用</strong>”。使用此逻辑填充所有单元格。下面是这样做的公式:</p><blockquote class="md"><p id="24a4" class="me mf iq bd mg mh mi mj mk ml mm kl dk translated">=IF(K2 &lt;&gt;" "，"采购订单可用"，"采购订单不可用")</p></blockquote><p id="ed66" class="pw-post-body-paragraph jo jp iq jq b jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh mr kj kk kl ij bi translated"><em class="ky">其中 K2 表示“原始数据”工作表中的 K 列(名为“采购订单”)。“&lt; &gt;”符号表示“不等于”，“符号表示空白。因此，在这个公式中，我们检查 K2 是否不等于空白，然后写“PO Available”或其他。</em></p><p id="8331" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">将此公式拖到“<em class="ky">raw _ data”</em>工作表的最后一个单元格。完成后，PO 列应该如下图所示。<em class="ky">搞定！</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/f3f643cfad1f05f8705d32ef02e0f60e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*1lrVSkGq7H1Zw63CcBiocw.png"/></div></figure><h2 id="67b4" class="lb lc iq bd ld le lf dn lg lh li dp lj jz lk ll lm kd ln lo lp kh lq lr ls lt bi translated">供应商数量:</h2><p id="5f63" class="pw-post-body-paragraph jo jp iq jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl ij bi translated"><strong class="jq ir">关键时刻之一已经到来。</strong>现在，我们将计算每种商品描述的供应商数量。如果你还记得第 2 章，我们首先想知道每个项目的供应商数量，然后将他们进一步细分为高、中、低类别。在 Python 中计算每件商品的供应商数量很容易，但在 excel 中有点复杂(至少我是这样做的)。</p><p id="2fb7" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">我的逻辑很简单，但需要几个步骤。我将首先获得每个商品描述的所有供应商名称的列表。供应商名称可以很多，但商品描述必须是唯一的。简而言之，一对多关系(一个商品描述可以有多个供应商名称)。</p><p id="f430" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">第二步是将这些信息复制到一个新的工作表中，然后在 raw_data 工作表中使用 COUNTIF 公式来获得实际的供应商数量。遵循下面提到的步骤来实现这一目标。</p><h2 id="29a9" class="lb lc iq bd ld le lf dn lg lh li dp lj jz lk ll lm kd ln lo lp kh lq lr ls lt bi translated"><strong class="ak">从重新排列数据透视表开始</strong></h2><p id="41c9" class="pw-post-body-paragraph jo jp iq jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl ij bi translated">回到我们的数据透视表工作表，根据下图重新排列。如果你能自己做，你可以跳到第三步。否则，请遵循以下说明。</p><p id="e67b" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><strong class="jq ir"> <em class="ky">第一步:</em> </strong> <em class="ky">我们先从拉商品描述和法定名称信息开始。在数据透视表的行部分，首先拉入“商品描述”，然后拉入“供应商的法定名称”。</em></p><p id="42c3" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><strong class="jq ir"> <em class="ky">第二步:</em> </strong> <em class="ky">现在，让我们来改变一下我们透视表的布局。为此，选择数据透视表，然后您将能够在顶部看到 Design 选项卡。在 Design 选项卡下，单击 Report Layout 选项，您将能够看到几个选项。你必须选择下面提到的两个选项:</em></p><p id="8b50" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky"> a .)选择“以表格形式显示”</em></p><p id="220a" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky"> b .)选择“重复所有项目标签”</em></p><p id="8eb2" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><strong class="jq ir"> <em class="ky">第三步:</em> </strong> <em class="ky">取消选择商品描述行的小计。这可以通过右击任何商品描述并取消选择“小计”选项来完成(参考第二张图片)。</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mv"><img src="../Images/bd1b6c8abc39e4e7dc21d278a031db68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E7kx0FymVkkXXQ66k3VVAw.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mw"><img src="../Images/995381800b818aed8bb47823136a5ad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cNt-77hVdSaoJoypsyFVQA.png"/></div></div></figure><p id="8277" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">一旦您完成了<em class="ky">步骤 1、2 和 3，</em>您的数据透视表应该如下图所示。如您所见，我们现在有一个表格，左边是商品描述字段，右边是供应商的法定名称。完美！</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mx"><img src="../Images/74538446dc05d0b805ff10938c82e861.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gb6_vHJyTKJLP-UzfnKOiw.png"/></div></div></figure><p id="0bc7" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><strong class="jq ir">步骤 4: </strong> <em class="ky">现在让我们将此表复制到一个新的工作表“供应商数量”中。我们将在 A 栏中显示“商品描述”,在 B 栏中显示“供应商的法定名称”,如下所示。</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi my"><img src="../Images/a85431c38ba71e18ec559f070b8be487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UjydfO6b5q7C-Uezuw1cjw.png"/></div></div></figure><p id="a92c" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">现在，让我们开始<em class="ky">计数。</em>我们将使用此表来最终统计每种商品描述的供应商数量。导航回我们的“Raw_Data”工作表，在“供应商数量”列(我们之前插入的那个)中，使用<em class="ky"> COUNTIF </em>公式。由于<em class="ky"> COUNTIF </em>函数需要一个数据范围，我们将使用新的“供应商计数”工作表中的数据范围。下面是这样做的公式:</p><blockquote class="md"><p id="dce0" class="me mf iq bd mg mh mi mj mk ml mm kl dk translated">=COUNTIF('供应商计数'！$A$1:$B$13412，Raw_Data！B2)</p></blockquote><p id="3534" class="pw-post-body-paragraph jo jp iq jq b jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh mr kj kk kl ij bi translated"><em class="ky">其中 A1 表示 A 列(包含“商品 _ 描述”)，B 列表示“供应商数量”工作表中供应商的法定名称。Raw_Data！B2 暗示到原始数据工作表中的 B 列(包含“商品描述”)。</em></p><p id="57ae" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">将此公式(将在 Y 列中输入)拖动到“<em class="ky">raw _ data”</em>工作表中的最后一个单元格。完成后，“<em class="ky">供应商编号”</em>栏应如下图所示。我们最终获得了每种商品描述的供应商数量信息。搞定了。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mz"><img src="../Images/5dbdb1ef2dbdbe574de0e1ba80a7f018.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KZmU5-ebdasC4Zf3Ikjb3A.png"/></div></div></figure><h2 id="50a0" class="lb lc iq bd ld le lf dn lg lh li dp lj jz lk ll lm kd ln lo lp kh lq lr ls lt bi translated">供应商类别</h2><p id="6121" class="pw-post-body-paragraph jo jp iq jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl ij bi translated">这是我们在本章中增加的少数几个栏目之一。让我们创建一个新列，并将其标记为“供应商类”。如第 2 章所述，我们将进一步将该供应商分为 3 类(如下所述),以帮助我们进行分析。由于我们已经计算了每种材料描述的供应商数量，我们可以将它们分为以下类别之一:</p><p id="1946" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky"> a.) </em> <strong class="jq ir"> <em class="ky">单个供应商</em> </strong> <em class="ky">(其中供应商计数为 1) </em></p><p id="5f06" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky"> b.) </em> <strong class="jq ir"> <em class="ky">在 1 到 5 之间</em> </strong> <em class="ky">(其中供应商数量在 1 到 5 的范围内)</em></p><p id="738f" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky"> c.) </em> <strong class="jq ir"> <em class="ky">超过 5 个</em> </strong> <em class="ky">(其中厂商数大于 5) </em></p><p id="55d3" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">注意:我选择了 5 个供应商作为我的上限。可以根据商品行情适当选择自己的上限。</p><p id="34c0" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">下面是填充“<em class="ky">供应商类别”</em>列的公式:</p><blockquote class="md"><p id="c23a" class="me mf iq bd mg mh mi mj mk ml mm kl dk translated">=IF(Y2=1，“单一供应商”，IF(AND(Y2&gt;1，Y2&lt;5)，“介于 1 和 5 之间”，“大于 5”))</p></blockquote><p id="482b" class="pw-post-body-paragraph jo jp iq jq b jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh mr kj kk kl ij bi translated"><em class="ky">其中 Y2 表示“raw_data”工作表中的 Y 列(包含“供应商数量”)。这里我们使用了一个 IF 条件。逻辑是针对供应商值的数量为 1 的情况，写“单一供应商”。对于供应商数量值介于 1 和 5 之间的情况，填写“介于 1 和 5 之间”,对于所有其他情况，在“供应商类别”栏中填写“大于 5”。</em></p><p id="f142" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">将此公式(将在“<em class="ky">供应商类别</em>列中输入)拖至“<em class="ky">raw _ data”</em>工作表的最后一个单元格。完成后，“<em class="ky">供应商类”</em>列应该如下图所示。搞定了。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi na"><img src="../Images/932750b4ca1221dcfee12dfdd2972120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s7UEMCfONXuftxVENRfXPg.png"/></div></div></figure><h2 id="93a7" class="lb lc iq bd ld le lf dn lg lh li dp lj jz lk ll lm kd ln lo lp kh lq lr ls lt bi translated">位置数量</h2><p id="4a18" class="pw-post-body-paragraph jo jp iq jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl ij bi translated">类似于卖方编号，我们现在也需要计算“<em class="ky">POs</em>编号”列。让我们在我们的<em class="ky">“raw _ data”</em>工作表中添加一个新列，并将其标记为<em class="ky">“位置编号”。</em>通过我们在第 2 章中的初步分析，我们现在必须知道，我们的数据集中的每个行项目都有一个 PO。我们还有许多订单字段为空的行项目，因此我们在“<em class="ky"> PO </em>”栏中填写了“<em class="ky"> PO 不可用</em>”。</p><p id="65f0" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">计算<em class="ky">【位置号】</em>的逻辑很简单。我们必须计算商品项目描述字段在数据集中出现的次数。这是假设我们每个行项目都有一个采购订单，并且它是唯一的。在所有实际场景中，情况可能是这样，也可能不是这样。如果您遇到这种情况，我建议您遵循我们在“<em class="ky">供应商</em>编号”栏中采用的方法。</p><p id="46fa" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">回到我们的数据集，使用<em class="ky"> COUNTIF </em>函数计算一个商品描述在数据集中出现的次数是相当容易的。但是，我们必须减去数据集中“<em class="ky"> PO 不可用”</em>的情况。为了总结这一逻辑，我们必须做到以下几点:</p><blockquote class="md"><p id="1a60" class="me mf iq bd mg mh mi mj mk ml mm kl dk translated">(商品描述出现的次数)——(该商品描述出现 PO 不可用的次数)</p></blockquote><p id="d534" class="pw-post-body-paragraph jo jp iq jq b jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh mr kj kk kl ij bi translated">为此，我们将使用<strong class="jq ir"> <em class="ky"> COUNTIFS </em> </strong>函数，而不是使用<strong class="jq ir"><em class="ky">COUNTIF</em></strong><em class="ky">f</em>函数。以下是填充“<em class="ky">位置编号”</em>列的公式:</p><blockquote class="md"><p id="157f" class="me mf iq bd mg mh mi mj mk ml mm kl dk translated">= COUNTIFS(＄B＄2:＄B＄72854，B2，＄X＄2:＄X＄72854，“PO Available”)</p></blockquote><p id="ab91" class="pw-post-body-paragraph jo jp iq jq b jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh mr kj kk kl ij bi translated"><em class="ky">B2 暗示到“原始数据”工作表中的 B 列(包含“商品描述”)，X2 暗示到 X 列(包含“采购订单”和采购订单可用值&amp;采购订单不可用值)。通过选择“PO Available”过滤器，我们将得到同时满足两个条件的结果，即商品描述在数据集中出现的次数以及 PO Available 的条件。</em></p><p id="0b7f" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">将该公式(输入到栏的<em class="ky">号中)拖动到“<em class="ky">raw _ data”</em>工作表的最后一个单元格。完成后，“<em class="ky">POs 号”</em>栏应如下图所示。搞定了。</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nb"><img src="../Images/f80387d5a498dc0a3035c5bed8e05e22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9dT6EoNUX8HLhKt4zMqLtg.png"/></div></div></figure><h2 id="e5a2" class="lb lc iq bd ld le lf dn lg lh li dp lj jz lk ll lm kd ln lo lp kh lq lr ls lt bi translated">采购订单类别</h2><p id="761b" class="pw-post-body-paragraph jo jp iq jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl ij bi translated">与“<em class="ky">供应商类别”</em>栏类似，我们将“<em class="ky">订单编号”</em>信息进一步细分为 3 个类别(如下所述)，以帮助我们进行分析。由于我们已经计算了每种材料描述的采购订单数量，我们可以将它们分为以下类别之一:</p><p id="0dcb" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky"> a.) </em> <strong class="jq ir"> <em class="ky">单个采购订单</em> </strong> <em class="ky">(一次性采购:其中采购订单数为 1) </em></p><p id="c08d" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky">b .)</em><strong class="jq ir"><em class="ky">1 到 12 之间</em> </strong> <em class="ky">(采购订单数量在 1 到 12 范围内的现货订单)</em></p><p id="b6dc" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky"> c.) </em> <strong class="jq ir"> <em class="ky">超过 12 个</em> </strong> <em class="ky">(高频 POs:其中 PO 计数大于 12) </em></p><p id="c5ee" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">我们的主要目标是找到高频 POs，以便进行整合。</p><p id="43d9" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">注意:我将“<em class="ky">高频 POs”</em>定义为每月至少 1 个 PO(因此每年 12 个 PO)。您可以根据您的初步数据分析来更改该数字。</p><p id="ad47" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">现在我们已经定义了我们的段，下面是填充“PO<em class="ky">Class”</em>列的公式:</p><blockquote class="md"><p id="3a3c" class="me mf iq bd mg mh mi mj mk ml mm kl dk translated">=IF(AA2=1，“单个采购订单”，IF(AND(AA2&gt;1，AA2 &lt;12),”Between 1 and 12",”More Than 12"))</p></blockquote><p id="9cb5" class="pw-post-body-paragraph jo jp iq jq b jr mn jt ju jv mo jx jy jz mp kb kc kd mq kf kg kh mr kj kk kl ij bi translated"><em class="ky">其中 AA2 表示“原始数据”工作表中的 A 列(包含“采购订单数量”)。这里我们使用了一个 IF 条件。逻辑是针对 PO 值的数量为 1 的情况，写“单个 PO”。对于采购订单数量介于 1 和 12 之间的情况，请填写“介于 1 和 12 之间”,对于所有其他情况，请在“采购订单类别”栏中填写“大于 12”。</em></p><p id="446e" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">将此公式(将输入到“<em class="ky">采购订单类别</em>列中)拖动到“<em class="ky">raw _ data”</em>工作表中的最后一个单元格。完成后，“<em class="ky">PO Class”</em>列应该如下图所示。搞定了。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nc"><img src="../Images/bda087fa2801e72775bb814e30f673c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0uNXSzwuPgK9eyV3CcimKQ.png"/></div></div></figure><h2 id="30da" class="lb lc iq bd ld le lf dn lg lh li dp lj jz lk ll lm kd ln lo lp kh lq lr ls lt bi translated">结论</h2><p id="55cb" class="pw-post-body-paragraph jo jp iq jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl ij bi translated">全部完成！我们在准备数据集方面走过了漫长的道路。事实上，我们现在都准备好开始我们的切块和切片！在下一章，你将会看到，我们如何从所有这些艰苦的工作中获得益处！</p><h1 id="ec2c" class="nd lc iq bd ld ne nf ng lg nh ni nj lj nk nl nm lm nn no np lp nq nr ns ls nt bi translated">第 04 章</h1><p id="72d9" class="pw-post-body-paragraph jo jp iq jq b jr lu jt ju jv lv jx jy jz lw kb kc kd lx kf kg kh ly kj kk kl ij bi translated">让我们从理解现有数据开始。然后，我们将通过解决<strong class="jq ir"> <em class="ky">【隐藏的尾巴】</em> </strong>问题，深入分析我们的第一个大的成本节约机会。</p><div class="nu nv gp gr nw nx"><a href="https://medium.com/procurementintel/tail-spend-analysis-chapter-04-hidden-tail-4e5fdda97194" rel="noopener follow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ir gy z fp oc fr fs od fu fw ip bi translated">尾部支出中最大但经常被忽略的部分是什么？隐藏的尾巴！第 04 章</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">第四章:隐藏的尾巴。找到并修复它。</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">medium.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol kw nx"/></div></div></a></div><p id="bd15" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">我很感激你的评论，这样我可以进一步改进这些课程。</p><p id="77ed" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky">对于即将到来的采购课程的简短总结，您可以随时</em></p><p id="686a" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky">订阅我的刊物:</em><a class="ae kz" href="https://medium.com/procurementintel" rel="noopener"><strong class="jq ir">【https://medium.com/procurementintel】</strong></a></p><p id="062d" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated"><em class="ky">在 LinkedIn 上关注我:</em><a class="ae kz" href="https://www.linkedin.com/in/gsrm/" rel="noopener ugc nofollow" target="_blank"><strong class="jq ir"><em class="ky">https://www.linkedin.com/in/gsrm/</em></strong></a></p></div></div>    
</body>
</html>