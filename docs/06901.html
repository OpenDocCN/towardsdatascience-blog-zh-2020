<html>
<head>
<title>Plotting Google Trends Data Using Pandas &amp; Matplotlib</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Pandas &amp; Matplotlib绘制Google趋势数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/plotting-google-trends-data-using-pandas-matplotlib-ec33a2f77c8c?source=collection_archive---------52-----------------------#2020-05-28">https://towardsdatascience.com/plotting-google-trends-data-using-pandas-matplotlib-ec33a2f77c8c?source=collection_archive---------52-----------------------#2020-05-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="f6c6" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">辅导的</h2><div class=""/><div class=""><h2 id="0601" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">分析谷歌趋势的前五名民主党总统候选人数据，找出辩论季最受欢迎的候选人。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/8364531e8789b5000b6107ec938b96c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dMnaxEAJtUUJUHs5gclXYQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图片来自<a class="ae le" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=1327276" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>的<a class="ae le" href="https://pixabay.com/users/905513-905513/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=1327276" rel="noopener ugc nofollow" target="_blank">玛丽·帕尔克</a></p></figure><p id="f9ec" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如果你一直在观看过去一年的民主党总统候选人辩论，你可能会同意这有点像一场狂野之旅。从<a class="ae le" href="https://www.businessinsider.com/biden-bites-wifes-finger-in-bizarre-campaign-stop-moment-2019-11" rel="noopener ugc nofollow" target="_blank">咬手指</a>到<a class="ae le" href="https://www.cnn.com/2020/01/15/politics/bernie-sanders-elizabeth-warren-debate-audio/index.html" rel="noopener ugc nofollow" target="_blank">紧张的辩论后对峙</a>。我们知道乔·拜登是民主党的假定提名人。但是我想看看数据。我们将使用pandas和matplotlib库从Google Trends中以搜索兴趣数据的形式遍历和探索这些数据。我们将重新创建谷歌趋势图，以可视化它们随时间的流行程度。我们来看看——<strong class="lh ja">谁是最受欢迎的候选人？</strong></p><h1 id="e7fc" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">谷歌趋势</h1><blockquote class="mt mu mv"><p id="c724" class="lf lg mw lh b li lj ka lk ll lm kd ln mx lp lq lr my lt lu lv mz lx ly lz ma ij bi translated">Google Trends提供了一个在特定时间范围内对Google的搜索请求示例。谷歌将搜索数据标准化，使术语之间的比较更容易。根据某个主题在所有主题的所有搜索中所占的比例，这些数字的范围是0到100。—trends.google.com</p></blockquote><p id="160d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这意味着，当查看这些值时，值100表示在给定的时间范围内，这些术语(候选项)中的最高流行度。值为50意味着该术语的流行程度是一半。</p></div><div class="ab cl na nb hu nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="ij ik il im in"><p id="5987" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="mw">注:我知道谷歌搜索实际上并不是流行度的黄金标准。然而，它确实反映了人们每天在谷歌上进行的搜索。</em></p><p id="93c3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">数据<br/> </strong>本项目使用的候选人是那些参加了前10场辩论的候选人。乔·拜登，伯尼·桑德斯，伊丽莎白·沃伦，艾米·克洛布查尔，皮特·布蒂吉格。数据是从2019年4月到2020年5月的谷歌趋势中拉出来的。</p><h2 id="f96d" class="nh mc iq bd md ni nj dn mh nk nl dp ml lo nm nn mn ls no np mp lw nq nr mr iw bi translated">1|导入必要的库，导入和检查数据</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nu"><img src="../Images/8020d9f128633bc31a56d61d871ff1f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pbG4OIemul2xcFNP3LGSzg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">候选人. csv</p></figure><p id="87fc" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">数据作为一个大列读入，标签为“类别:所有类别”。我们可以通过传递行索引来指定哪一行应该是我们的标签，从而改变这一点。</p><h2 id="c511" class="nh mc iq bd md ni nj dn mh nk nl dp ml lo nm nn mn ls no np mp lw nq nr mr iw bi translated">2|使用正确的标签重新读入数据集</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nv"><img src="../Images/122bfabc04759a0383e7e49e9fe2573b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y_78TrtcyOCf1o_5GbVVwQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">candidates.csv读入正确的标签</p></figure><p id="e938" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">很好——现在我们已经读入了带有正确标签的数据帧。现在，开始一些争论。首先——看看这些标签……当在pandas中操作数据时，易于使用的列标签可以使工作更快，更少令人沮丧。我们可以通过缩短它们，去掉空格，并使它们都变成小写来清理这些标签。</p><h2 id="142b" class="nh mc iq bd md ni nj dn mh nk nl dp ml lo nm nn mn ls no np mp lw nq nr mr iw bi translated">3|调整列标签</h2><p id="bd34" class="pw-post-body-paragraph lf lg iq lh b li nw ka lk ll nx kd ln lo ny lq lr ls nz lu lv lw oa ly lz ma ij bi translated">列表理解将用于调整标签。如果你需要的话，这是一个很好的教程来温习列表理解。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/f949c03e61916976d8c81d9eef6d8a1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*wRBkaQJYUDHxmgVgWRXOJg.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">清洁的色谱柱标签</p></figure><p id="dc7c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">不错！使用列标签要容易得多。让我们再看看我们的数据。</p><h2 id="a599" class="nh mc iq bd md ni nj dn mh nk nl dp ml lo nm nn mn ls no np mp lw nq nr mr iw bi translated">4 |检查数据</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/a90c52be5884460ff8b63b1560799ceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*_td6PrSEcgKbCDndm3xd4Q.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">候选数据帧的数据类型</p></figure><p id="eec4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">好的——我们看到“joe”和“bernie”列具有整数数据类型，但是其余的列是“object”类型。这是因为当谷歌趋势有一个非常低的数字，而不是“0”，他们把术语“&lt;1’. The ‘</p><h2 id="6a98" class="nh mc iq bd md ni nj dn mh nk nl dp ml lo nm nn mn ls no np mp lw nq nr mr iw bi translated">5| Replace the ‘&lt;1’ string with an integer</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi od"><img src="../Images/2c30da72f5c8a795992482b55220ec82.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*qVhAOHVs3Pyqv-ZvM9_d8w.png"/></div></figure><p id="7922" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Great, the ‘</p><h2 id="5393" class="nh mc iq bd md ni nj dn mh nk nl dp ml lo nm nn mn ls no np mp lw nq nr mr iw bi translated"><strong class="ak">6 |调整列的类型&amp;设置索引</strong></h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/0ea934316af729c9aac9a69077e0edad.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*5Gm2QcAxMCId2goWm7rPbQ.png"/></div></figure><p id="19d0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">不错！现在，我们的DatetimeIndex显示了数据的日期范围，每一列都是数字类型。我们来看看数据！</p><h2 id="9b50" class="nh mc iq bd md ni nj dn mh nk nl dp ml lo nm nn mn ls no np mp lw nq nr mr iw bi translated">7 |绘制数据</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi of"><img src="../Images/52d2c28f053ed32e98441d9a3c86e634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EWvjUmclUyWi8BYtRLhUjQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">2015年4月至2020年5月的谷歌搜索趋势</p></figure><p id="15f4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们看到伯尼从2016年2月到大约5月底主导结果。这是在桑德斯2016年竞选总统期间。</p><p id="11f5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">让我们从民主党初选辩论之前的时间开始放大，覆盖民主党初选辩论的日期。民主辩论时间:<em class="mw">2019年6月26日，2019年7月30日，2019年9月12日，2019年10月15日，2019年11月20日，2019年12月19日，2020年1月14日，2020年2月7日，2020年2月19日，2020年3月15日</em>。然而，我们数据中的日期是每周的——在绘制数据之前，我们需要将日期调整为代表辩论发生的那一周的日期。</p><h2 id="7060" class="nh mc iq bd md ni nj dn mh nk nl dp ml lo nm nn mn ls no np mp lw nq nr mr iw bi translated">8|调整辩论日期然后绘图</h2><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi of"><img src="../Images/e98b6bdc677105fd9a922b4361d542ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8WkWQMNwMSkJcvSEo2xYSw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">标有辩论日期的趋势数据</p></figure><p id="9eab" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们可以看到每个辩论日期前后都有峰值。在第一次辩论之前有几个峰值-我们看到皮特·布蒂吉格在2019年4月有一个小峰值。2019年4月15日 Buttigieg宣布竞选。伊丽莎白·沃伦在【22,2019年4月22日有一个较小的峰值，对应于她的<a class="ae le" href="https://www.cnn.com/2019/04/22/politics/elizabeth-warren-student-debt-college-tuition-plan/index.html" rel="noopener ugc nofollow" target="_blank">取消学生债务</a>和取消大学学费的计划的发布。乔·拜登于2019年4月25日<strong class="lh ja">宣布竞选总统。</strong></p><p id="3ad1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">有些峰值并不与辩论日期直接对应。例如，我们看到拜登和桑德斯在9月和10月的活动之间有一个高峰。2019年9月25日<strong class="lh ja">拜登在<em class="mw">吉米·基梅尔直播</em>  <em class="mw"> </em>接受了<a class="ae le" href="https://www.youtube.com/watch?v=LSWwhNvk1tc" rel="noopener ugc nofollow" target="_blank">采访，他在采访中讨论了弹劾调查。2019年<strong class="lh ja">10月2日</strong>桑德斯因动脉阻塞</a><a class="ae le" href="https://abcnews.go.com/Politics/bernie-sanders-78-canceled-events-notice-hospitalized/story?id=66003850" rel="noopener ugc nofollow" target="_blank">住院</a>。</strong></p><h1 id="9313" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">最热门人选？</h1><p id="4892" class="pw-post-body-paragraph lf lg iq lh b li nw ka lk ll nx kd ln lo ny lq lr ls nz lu lv lw oa ly lz ma ij bi translated">那么，谁是最受欢迎的候选人？我们看到，在2月底/3月初，拜登和桑德斯都大幅上升，他们看起来势均力敌。让我们通过在熊猫数据框架上使用rolling() &amp; mean()函数来消除由短期运动引起的噪声。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ns nt l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/51d042cf87d2a7888cb2653274548e72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7BTC9uyj3xuFkX_HRHJkNQ.png"/></div></div></figure><p id="79f1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">首先，我想指出一些有趣的事情——皮特的旅程。他在2019年4月/5月有一个大的初始攀升(不久后超过桑德斯)，然后在年底(12月/1月)有一个较小的攀升，其他候选人开始下降或持平。</p><p id="0858" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">至于最热门的人选，会不会是拜登？看起来拜登在大多数辩论中都保持了一定的领先优势。还是桑德斯？到了新年，伯尼一直领先，直到他退出比赛。</p><p id="71c0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">你认为谁是更受欢迎的候选人？</p></div><div class="ab cl na nb hu nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="ij ik il im in"><p id="e9bf" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">你可以在<a class="ae le" href="https://github.com/bryan-md/google-trend-analysis" rel="noopener ugc nofollow" target="_blank"> Github repo </a>中找到完整的代码。另外——我花了一些时间使用这些数据通过Tableau构建了带有注释的相同情节。在这里看一下<a class="ae le" href="https://public.tableau.com/profile/bryan.dickinson#!/vizhome/candidatetrendscomoparisons/CandidateComparisons" rel="noopener ugc nofollow" target="_blank">互动viz</a>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oh"><img src="../Images/1903496390d7ea55a5db18d7e1023c32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QtN8-2a-v70OrBX0x0J6cw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">完成互动的静态照片，即<a class="ae le" href="https://public.tableau.com/profile/bryan.dickinson#!/vizhome/candidatetrendscomoparisons/CandidateComparisons" rel="noopener ugc nofollow" target="_blank">此处</a>。</p></figure></div></div>    
</body>
</html>