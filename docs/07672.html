<html>
<head>
<title>Exploring Hulu Data in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 探索 Hulu 数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/exploring-hulu-data-in-python-1eb6fa90a886?source=collection_archive---------69-----------------------#2020-06-08">https://towardsdatascience.com/exploring-hulu-data-in-python-1eb6fa90a886?source=collection_archive---------69-----------------------#2020-06-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="febb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Hulu 数据的探索性数据分析</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/907e69d043a5656a7096784ff45daa4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XzA7KXq7KJ6YDiI5sTMkiw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.pexels.com/photo/app-entertainment-ipad-mockup-265685/" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="5610" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">网飞、Prime Video、Hulu 和 Disney Plus 上的<em class="lv">电影数据集包含从 reelgood.com 收集的信息，其中包含上述平台上可供流媒体播放的电影列表。在本帖中，我们将对网飞的<em class="lv">电影、Prime Video、Hulu 和 Disney Plus </em>数据集中的 Hulu 数据进行基本的探索性数据分析。数据可以在<a class="ae ky" href="https://www.kaggle.com/ruchi798/movies-on-netflix-prime-video-hulu-and-disney" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</em></p><p id="9d78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><p id="4ea5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们将数据读入熊猫数据框:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="5ac1" class="mb mc it lx b gy md me l mf mg">import pandas as pd <br/>df = pd.read_csv("MoviesOnStreamingPlatforms_updated.csv")</span></pre><p id="a10f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将打印该数据中可用的列:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="63d1" class="mb mc it lx b gy md me l mf mg">print(df.columns)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/83a732e211d5284d7fdae86379927680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nT3ETJPpEXnJg3nMY5o_ww.png"/></div></div></figure><p id="e58a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们不需要“Unamed: 0”列，所以我们可以用“del”关键字删除它:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="0191" class="mb mc it lx b gy md me l mf mg">del d['Unnamed: 0’]</span></pre><p id="c668" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们使用“head()”方法打印前五行数据:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="ff28" class="mb mc it lx b gy md me l mf mg">print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mi"><img src="../Images/0e10208c73a97fb1fcbd58cf023c8a61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MaYmMwJ3WXJJ2xMxtG6QEg.png"/></div></div></figure><p id="9df1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们看一下网飞、Hulu、Prime Video 和 Disney Plus 栏，我们会发现它们包含 1 和 0。1 对应于该电影可在相应平台上流式传输，而 0 对应于该电影在所述平台上不可用。</p><p id="2724" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们想专门研究 Hulu 数据，所以让我们过滤数据框，使“Hulu”列中的值等于 1:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="a571" class="mb mc it lx b gy md me l mf mg">df_hulu = df[df['Hulu'] == 1]</span></pre><p id="554b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们打印原始数据框和过滤后的数据框的长度:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="f442" class="mb mc it lx b gy md me l mf mg">print("Total Length: ", len(df))<br/>print("Hulu Length: ", len(df_hulu)))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/144e3e7decfb4dc19d1551619c574d41.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*Cxt9nWfGCj7deJxp_cUCyg.png"/></div></figure><p id="4a75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们打印新数据框的前五行:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="1efc" class="mb mc it lx b gy md me l mf mg">print(df_hulu.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/948a5bd2a5ab7b83f55913a125a7f4f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UcJ0O7D01kCS1IqWf4-aYQ.png"/></div></div></figure><p id="216c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的数据包含几个分类列。让我们定义一个将数据框、列名和限制作为输入的函数。当被调用时，它打印分类值的字典以及它们出现的频率:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="2260" class="mb mc it lx b gy md me l mf mg">def return_counter(data_frame, column_name, limit):<br/>   from collections import Counter    print(dict(Counter(data_frame[column_name].values).most_common(limit)))</span></pre><p id="db0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将函数应用于“语言”列，并将结果限制为五个最常见的值:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="545e" class="mb mc it lx b gy md me l mf mg">return_counter(df_hulu, 'Language', 5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/6e1c4666b956336ef293e0b55b9ee3aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pE68Ut4_ZT5XML-bmERCsA.png"/></div></div></figure><p id="c44d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如我们所见，Hulu 数据中有 607 个英语、27 个英语/西班牙语、19 个日语、18 个英语/法语和 15 个缺失的语言值。</p><p id="200c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将此方法应用于“流派”列:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="3821" class="mb mc it lx b gy md me l mf mg">return_counter(df_hulu, 'Genres', 5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/7ff8105552bd2cf9f8c8f851b284dc51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*orInlnHF365g_CvWqRo82A.png"/></div></div></figure><p id="fec9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们来看看最常见的电影类型“纪录片”:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="204f" class="mb mc it lx b gy md me l mf mg">df_d1 = df_hulu[df_hulu['Genres'] =='Documentary']<br/>print(set(df_d1['title']))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/471a63c2bc375422362c78306f2158f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DmWHdUbXNe2-dOVFNFo1jg.png"/></div></div></figure><p id="55f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以看看这些国家:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="2419" class="mb mc it lx b gy md me l mf mg">print(set(df_d1['Country']))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/8e696e5abe76f9b7869682356d186c6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IXmkTfU4hcMXGxkXXGyIlA.png"/></div></div></figure><p id="1416" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们看看电影运行时间值的集合:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="2bec" class="mb mc it lx b gy md me l mf mg">print(set(df_d1['Runtime']))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/e5cee16d4d3e657e3d4f51b01c0917f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6mf91J0Tk2zjkgTZuPSiiw.png"/></div></div></figure><p id="ea21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到运行时间值的范围从 30 分钟到 120 分钟。接下来，从数字列(如“Runtime ”)中生成汇总统计数据会很有用。让我们定义一个采用数据框、分类列和数字列的函数。每个类别的数字列的平均值和标准偏差存储在数据框中，并且数据框根据平均值以降序排序。如果您想要快速查看特定类别对于特定数字列是否具有更高或更低的平均值和/或标准偏差值，这将非常有用。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="7021" class="mb mc it lx b gy md me l mf mg">def return_statistics(data_frame, categorical_column, numerical_column):<br/>    mean = []<br/>    std = []<br/>    field = []<br/>    for i in set(list(data_frame[categorical_column].values)):<br/>        new_data = data_frame[data_frame[categorical_column] == i]<br/>        field.append(i)<br/>        mean.append(new_data[numerical_column].mean())<br/>        std.append(new_data[numerical_column].std())<br/>    df = pd.DataFrame({'{}'.format(categorical_column): field, 'mean {}'.format(numerical_column): mean, 'std in {}'.format(numerical_column): std})<br/>    df.sort_values('mean {}'.format(numerical_column), inplace = True, ascending = False)<br/>    df.dropna(inplace = True)<br/>    return df</span></pre><p id="89b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用分类列“流派”和数字列“运行时”来调用我们的函数:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="370b" class="mb mc it lx b gy md me l mf mg">stats = return_statistics(df_hulu, 'Genres', 'Runtime')<br/>print(stats.head(15))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/9bd62cbc73aaaf4c1fea5a9ce2e28c03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P1senD0Qx4d2LfnrihJogQ.png"/></div></div></figure><p id="898c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将使用箱线图来显示基于最小值、最大值、中值、第一个四分位数和第三个四分位数的数值分布。如果您对它们不熟悉，可以看看文章<a class="ae ky" rel="noopener" target="_blank" href="/understanding-boxplots-5e2df7bcbd51">了解 Boxplots </a>。</p><p id="8123" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与汇总统计函数类似，此函数采用数据框、分类列和数值列，并根据限制显示最常见类别的箱线图:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="67da" class="mb mc it lx b gy md me l mf mg">def get_boxplot_of_categories(data_frame, categorical_column, numerical_column, limit):<br/>    import seaborn as sns<br/>    from collections import Counter<br/>    keys = []<br/>    for i in dict(Counter(df[categorical_column].values).most_common(limit)):<br/>        keys.append(i)<br/>    print(keys)<br/>    df_new = df[df[categorical_column].isin(keys)]<br/>    sns.set()<br/>    sns.boxplot(x = df_new[categorical_column], y =      df_new[numerical_column])</span></pre><p id="807b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们在 5 个最常见的“流派”类别中为“运行时”生成箱线图:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="20e5" class="mb mc it lx b gy md me l mf mg">get_boxplot_of_categories(df_hulu, 'Genres', 'Runtime', 5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/c4e2c967b9a7e290fb60edf5a8c837ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Emo-GpzjqWeyB-gtkgswXg.png"/></div></div></figure><p id="0265" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，让我们定义一个函数，它将数据框和数字列作为输入，并显示一个直方图:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="3d75" class="mb mc it lx b gy md me l mf mg">def get_histogram(data_frame, numerical_column):<br/>    df_new = data_frame<br/>    df_new[numerical_column].hist(bins=100)</span></pre><p id="e954" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用数据框调用函数，并从“运行时”生成一个直方图:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="9b3b" class="mb mc it lx b gy md me l mf mg">get_histogram(df_hulu, 'Runtime')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/c4c59b506288694e3a802ffb2eaa2bc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YHmmS6gcVCnxmZ-eoRHqIA.png"/></div></div></figure><p id="ba61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我就讲到这里，但是请随意处理数据并自己编码。</p><h2 id="d18a" class="mb mc it bd mt mu mv dn mw mx my dp mz li na nb nc lm nd ne nf lq ng nh ni nj bi translated">结论</h2><p id="db23" class="pw-post-body-paragraph kz la it lb b lc nk ju le lf nl jx lh li nm lk ll lm nn lo lp lq no ls lt lu im bi translated">概括地说，我们回顾了几种分析网飞<em class="lv">电影、Prime Video、Hulu 和 Disney Plus </em>数据集<em class="lv">中 Hulu 数据的方法。</em>这包括定义用于生成汇总统计数据的函数，如平均值、标准差和分类值的计数。我们还定义了用箱线图和直方图可视化数据的函数。我希望这篇文章有趣。这篇文章的代码可以在<a class="ae ky" href="https://github.com/spierre91/medium_code/blob/master/exploratory_data_analysis/eda_hulu.py" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。感谢您的阅读！</p></div></div>    
</body>
</html>