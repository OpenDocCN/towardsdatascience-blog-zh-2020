<html>
<head>
<title>Moving Average Technical Analysis with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python进行移动平均线技术分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/moving-average-technical-analysis-with-python-2e77633929cb?source=collection_archive---------18-----------------------#2020-02-29">https://towardsdatascience.com/moving-average-technical-analysis-with-python-2e77633929cb?source=collection_archive---------18-----------------------#2020-02-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9766" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Python计算和绘制移动平均值</h2></div><p id="2a46" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">移动平均线通常用于技术分析，以预测未来的价格趋势。在本帖中，我们将使用Python构建一个脚本来执行移动平均线技术分析。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/edd17157feb3fd3c48593ef13730e6c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*crfNm8kkWh7CI2pnLvzPjw.jpeg"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">克里斯·利维拉尼在<a class="ae lr" href="https://unsplash.com/s/photos/technical-analysis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="2313" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">什么是均线？</h1><p id="b5f7" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">移动平均线是<strong class="kh ir"> <em class="mp"> n </em> </strong>最后收盘价的平均值。要选择的最后收盘价n的数量取决于进行分析的投资者或分析师。一种常见的方法是取20天，这基本上是一个月的交易天数。</p><p id="db3c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">天数越短，移动平均线对价格变化越敏感。也就是说，如果我们选择更大的天数，短期波动将不会反映在指标中。然而，通过选择大量的日期，我们可能会由于忽略短期波动而错过一些即将到来的价格变化。</p><p id="767d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面我们可以看到<strong class="kh ir">简单移动平均线</strong>是如何计算的<a class="ae lr" href="https://www.investopedia.com/terms/m/movingaverage.asp" rel="noopener ugc nofollow" target="_blank"> (source Investopedia </a>)。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/f289fd160c09414d155a92aff75799d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/0*T7VFZC7v66YuKr-K"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">移动平均公式</p></figure><h1 id="45b6" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">如何解读均线和交叉</h1><p id="ab02" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">金融分析师和投资者可以使用移动平均线来分析价格趋势，并预测未来的趋势变化。在价格上升趋势中，价格高于移动平均线。在价格下降趋势中，价格低于移动平均线。当收盘价穿过移动平均线时，投资者可以将其视为<strong class="kh ir">价格趋势的潜在变化。</strong></p><p id="0e74" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以在不同的时间段使用多个移动平均线。例如，我们可能有20天的短期移动平均线和250天的长期移动平均线。当<strong class="kh ir">短期移动平均线穿过长期移动平均线</strong>时，可能是价格趋势变化的标志:</p><ul class=""><li id="b886" class="mr ms iq kh b ki kj kl km ko mt ks mu kw mv la mw mx my mz bi translated">当<strong class="kh ir">短期移动平均线穿越长期移动平均线</strong>上方时，这可能表明一个<strong class="kh ir"> <em class="mp">买入</em> </strong>信号。这就是所谓的黄金交叉。</li><li id="64d7" class="mr ms iq kh b ki na kl nb ko nc ks nd kw ne la mw mx my mz bi translated">相反，当<strong class="kh ir">短期移动平均线低于长期移动平均线时，</strong>可能是卖出的好时机。<a class="ae lr" href="https://www.investopedia.com/terms/d/deathcross.asp" rel="noopener ugc nofollow" target="_blank">这就是所谓的死叉。</a></li></ul><h1 id="3794" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">使用Python进行移动平均线技术分析</h1><p id="4d2d" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">现在我们已经了解了如何计算和解释移动平均线，我们准备用Python构建这个技术分析工具。我们的目标是有一个脚本，我们将通过任何公司，我们想分析和我们的功能将:</p><ul class=""><li id="4573" class="mr ms iq kh b ki kj kl km ko mt ks mu kw mv la mw mx my mz bi translated">首先，<strong class="kh ir">从名为<em class="mp">financialmodeliongprep</em>的<a class="ae lr" href="https://financialmodelingprep.com/" rel="noopener ugc nofollow" target="_blank">免费API金融源下载股票价格信息</a></strong>。</li><li id="2233" class="mr ms iq kh b ki na kl nb ko nc ks nd kw ne la mw mx my mz bi translated">第二，我们将<strong class="kh ir">解析来自API </strong>的结果，并将其转换为包含最近1200个交易日的日期和收盘价的<a class="ae lr" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" rel="noopener ugc nofollow" target="_blank"> Pandas DataFrame </a>。</li><li id="78cd" class="mr ms iq kh b ki na kl nb ko nc ks nd kw ne la mw mx my mz bi translated">第三，我们将<strong class="kh ir">计算20和250 </strong>日移动平均线。</li><li id="667a" class="mr ms iq kh b ki na kl nb ko nc ks nd kw ne la mw mx my mz bi translated">最后，我们将通过 <strong class="kh ir">在<a class="ae lr" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> matplotlib </a>图中将收盘价和均线</strong>绘制在一起，来结束我们的<strong class="kh ir">均线技术分析</strong> <strong class="kh ir">。</strong></li></ul><p id="5f24" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要做的第一件事是导入所有需要的包，创建我们的<em class="mp"> stockpriceanalysis </em>函数，并向<a class="ae lr" href="https://financialmodelingprep.com/api/v3/historical-price-full/aapl?serietype=line" rel="noopener ugc nofollow" target="_blank"> API端点发出http请求，以获取过去几年的收盘价</a>。</p><p id="73a5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们就以<em class="mp">苹果</em>为例。请注意，API端点url将我们想要获取数据的公司的股票代码作为参数。在我们的例子中，它将是我们传递给函数的参数(例如Apple的aapl)。</p><p id="38f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们可以解析响应，只保留最近1200天的价格<a class="ae lr" href="https://codingandfun.com/python-for-finance-stock-price-trend-analysis/" rel="noopener ugc nofollow" target="_blank">如果您想更详细地了解如何解析和处理API响应，请查看下面的文章。</a></p><p id="4aaf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们在<em class="mp"> stockprices </em>变量中有一个字典，包含1200个数据点以及日期和收盘价。我们使用<a class="ae lr" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.from_dict.html" rel="noopener ugc nofollow" target="_blank"> <em class="mp"> pd将其转换成熊猫数据帧。data frame . from _ dict()</em></a><em class="mp"/>方法，并将<em class="mp">日期</em>设置为索引。</p><pre class="lc ld le lf gt nf ng nh ni aw nj bi"><span id="f971" class="nk lt iq ng b gy nl nm l nn no">import requests<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/><br/>def stockpriceanalysis(stock):<br/>    stockprices = requests.get(f"https://financialmodelingprep.com/api/v3/historical-price-full/{stock}?serietype=line")<br/>    stockprices = stockprices.json()<br/><br/>#Parse the API response and select only last 1200 days of prices<br/>    stockprices = stockprices['historical'][-1200:]<br/><br/>#Convert from dict to pandas datafram<br/><br/>    stockprices = pd.DataFrame.from_dict(stockprices)<br/>    stockprices = stockprices.set_index('date')</span></pre><p id="ab9a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果现在我们打印我们的股票价格数据帧，我们得到下面的响应:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi np"><img src="../Images/85a3840d19f0cea92f0d94919fec83be.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*T30E34P1uIDoUzNXb9nKSQ.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">苹果股票价格</p></figure><p id="921d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很好，我们现在可以计算20天和250天的移动平均线了。我选择20天作为短期移动平均线，因为20个交易日或多或少代表一个月。而250个交易日大约代表一年。您可以随意更改分析的天数。</p><p id="9f2b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用滚动方法并通过窗口(即天数)作为参数，使用<a class="ae lr" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.rolling.html" rel="noopener ugc nofollow" target="_blank"> Pandas很容易计算移动平均值:</a></p><pre class="lc ld le lf gt nf ng nh ni aw nj bi"><span id="3ec9" class="nk lt iq ng b gy nl nm l nn no">import requests<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/><br/><br/>def stockpriceanalysis(stock):<br/>    stockprices = requests.get(f"https://financialmodelingprep.com/api/v3/historical-price-full/{stock}?serietype=line")<br/>    stockprices = stockprices.json()<br/><br/>#Parse the API response and select only last 1200 days of prices<br/>    stockprices = stockprices['historical'][-1200:]<br/><br/>#Convert from dict to pandas datafram<br/><br/>    stockprices = pd.DataFrame.from_dict(stockprices)<br/>    stockprices = stockprices.set_index('date')<br/>    #20 days to represent the 22 trading days in a month<br/>    stockprices['20d'] = stockprices['close'].rolling(20).mean()<br/>    stockprices['250d'] = stockprices['close'].rolling(250).mean()</span></pre><h1 id="8576" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">绘制移动平均线</h1><p id="844c" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">现在我们已经<strong class="kh ir">计算了</strong>收盘价、<strong class="kh ir"> 20日和250日移动平均线、</strong>我们可以使用<strong class="kh ir"> <em class="mp"> matplotlib </em> </strong>将它们绘制在一个图表中。然后，我们添加一个标题，并使轴紧密，以加强情节布局。</p><pre class="lc ld le lf gt nf ng nh ni aw nj bi"><span id="d150" class="nk lt iq ng b gy nl nm l nn no">import requests<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/><br/><br/>def stockpriceanalysis(stock):<br/>    stockprices = requests.get(f"https://financialmodelingprep.com/api/v3/historical-price-full/{stock}?serietype=line")<br/>    stockprices = stockprices.json()<br/><br/>#Parse the API response and select only last 1200 days of prices<br/>    stockprices = stockprices['historical'][-1200:]<br/><br/>#Convert from dict to pandas datafram<br/><br/>    stockprices = pd.DataFrame.from_dict(stockprices)<br/>    stockprices = stockprices.set_index('date')<br/>    #20 days to represent the 22 trading days in a month<br/>    stockprices['20d'] = stockprices['close'].rolling(20).mean()<br/>    stockprices['250d'] = stockprices['close'].rolling(250).mean()<br/>  <br/>    stockprices[['close','20d','250d']].plot(figsize=(10,4))<br/>    plt.grid(True)<br/>    plt.title(stock + ' Moving Averages')<br/>    plt.axis('tight')<br/>    plt.ylabel('Price')</span></pre><p id="57aa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们<strong class="kh ir">运行股票价格分析函数</strong>并传递<strong class="kh ir"> <em class="mp">苹果</em> </strong>股票报价作为参数，我们将得到一个图表，其中显示了苹果过去几个月的移动平均价格和收盘价:</p><pre class="lc ld le lf gt nf ng nh ni aw nj bi"><span id="357d" class="nk lt iq ng b gy nl nm l nn no">stockpriceanalysis('aapl')</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/d498ba7d12b894f5e35d44ca47146509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/0*3WzGWj7xkmm8gfys"/></div></figure><p id="94a9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过观察图表，我们可以看到我们对苹果的移动平均线技术分析的结果。</p><p id="8f24" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以观察到20天移动平均线和最新收盘价之间的交叉。这是一个很好的迹象，表明上升趋势已经结束，价格下降趋势正在开始。</p><p id="cdfd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">应使用基本工具进行进一步分析，以证实这种潜在的价格趋势变化。在我以前的一些帖子中，你可以找到一些使用Python的基本金融分析工具。</p><h1 id="dd25" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">包扎</h1><p id="2865" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">我们构建了一个非常强大的工具，使用20天和250天的移动平均线用Python执行简单的技术分析。该脚本可以用于为其他公司执行分析，只需将公司股票作为我们函数的参数进行传递。</p><p id="760c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很高兴通过我的Twitter账户获得您的反馈。</p><p id="b9bf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你也可以看看下面的视频教程，我一步一步地解释代码:</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nr ns l"/></div></figure></div><div class="ab cl nt nu hu nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ij ik il im in"><p id="403c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mp">原载于2020年2月29日https://codingandfun.com</em><a class="ae lr" href="https://codingandfun.com/moving-average-technical-analysis/" rel="noopener ugc nofollow" target="_blank"><em class="mp"/></a><em class="mp">。</em></p></div></div>    
</body>
</html>