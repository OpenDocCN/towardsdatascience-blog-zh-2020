<html>
<head>
<title>Sports analysis with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫的体育分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sports-analysis-with-pandas-real-vs-barca-94f85819bf6?source=collection_archive---------23-----------------------#2020-04-06">https://towardsdatascience.com/sports-analysis-with-pandas-real-vs-barca-94f85819bf6?source=collection_archive---------23-----------------------#2020-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7f47" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何计算足球比赛的赔率？这比你想象的要容易。不需要编码技能！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6f759329e7961abe19a04a35d033e4f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GRKy753fxWxRfdXAAiEsZg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">托马斯·塞勒在<a class="ae ky" href="https://unsplash.com/s/photos/football?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="3c51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">你有没有想过足球比赛的赔率是如何计算的？那些 2.2 vs 3.1 的赔率是基于什么？我原以为这是一个复杂的过程，但令我惊讶的是，不用写任何代码就可以计算出概率和赔率。我在下面的例子中使用熊猫是因为我精通它，但是你也可以在 Excel 中甚至用计算器做同样的事情。</p><p id="b1c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我写了大量关于熊猫数据分析的文章。看看我的熊猫系列:</p><div class="me mf gp gr mg mh"><a href="https://medium.com/@romanorac/pandas-data-analysis-series-b8cec5b38b22" rel="noopener follow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd iu gy z fp mm fr fs mn fu fw is bi translated">熊猫数据分析系列</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">从提示和技巧，如何不指南到与大数据分析相关的提示，熊猫文章的精选列表。</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">medium.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv ks mh"/></div></div></a></div><h1 id="d6e1" class="mw mx it bd my mz na nb nc nd ne nf ng jz nh ka ni kc nj kd nk kf nl kg nm nn bi translated">如何计算概率？</h1><blockquote class="no"><p id="1a09" class="np nq it bd nr ns nt nu nv nw nx lu dk translated">一定数量的目标的概率用泊松分布计算，泊松分布以法国数学家西蒙·丹尼斯·泊松命名。</p></blockquote><p id="572a" class="pw-post-body-paragraph kz la it lb b lc ny ju le lf nz jx lh li oa lk ll lm ob lo lp lq oc ls lt lu im bi translated">泊松分布是一种离散概率分布，它表示在固定时间间隔内发生的给定数量的事件的概率，如果这些事件以已知的恒定平均速率发生，并且与自上次事件以来的时间无关。</p><p id="5d4a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用通俗的语言来解释这一点。离散概率分布给出了离散事件在 0 和 1 之间的概率，如足球示例中的进球数。一场足球比赛有一个固定的时间间隔(90 分钟的比赛)，进球以一个已知的恒定平均速率出现(我们可以计算出预期的进球数量)。一个目标也独立于前一个目标。</p><p id="f5e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下图是泊松分布的概率质量函数(PMF ),显示了预期发生次数为 1、5 和 10 的事件的概率。简单来说，一支平均进 1 球的足球队，有一个:</p><ul class=""><li id="fec1" class="od oe it lb b lc ld lf lg li of lm og lq oh lu oi oj ok ol bi translated">36%的概率没有进球，</li><li id="7a4c" class="od oe it lb b lc om lf on li oo lm op lq oq lu oi oj ok ol bi translated">1 球 36%的概率，</li><li id="6403" class="od oe it lb b lc om lf on li oo lm op lq oq lu oi oj ok ol bi translated">18%概率 2 球等。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/fd60e774503ef18f8eb496a313d2cbb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*27H6sDOZT2vTATyvhgMe3g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">λ1、5 和 10 的泊松分布。</p></figure><h1 id="329a" class="mw mx it bd my mz na nb nc nd ne nf ng jz nh ka ni kc nj kd nk kf nl kg nm nn bi translated">El Clásico  -谁有望获胜？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/35b1269c994caeb592446daf1c69771f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gjcMDCHBn-mha8Yv"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">维也纳·雷耶斯在<a class="ae ky" href="https://unsplash.com/s/photos/real-madrid?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="a8af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来计算一下永远的对手巴塞罗那和皇家马德里之间潜在对决的概率。这场比赛将在圣地亚哥伯纳乌进行，这意味着皇家马德里将在主场作战。</p><p id="8f64" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们可以使用泊松分布来估计概率之前，我们需要计算每支球队在比赛中可能得分的预期数量。</p><blockquote class="no"><p id="b125" class="np nq it bd nr ns nt nu nv nw nx lu dk translated">通过确定球队的进攻实力和防守实力来计算每支球队可能得分的预期目标数。</p></blockquote><p id="24b2" class="pw-post-body-paragraph kz la it lb b lc ny ju le lf nz jx lh li oa lk ll lm ob lo lp lq oc ls lt lu im bi translated">我根据 2019/2020 赛季西班牙 LaLiga 的在线统计数据组成了数据集。有两个数据集，一个用于主场比赛，一个用于客场比赛，其中:</p><ul class=""><li id="e21e" class="od oe it lb b lc ld lf lg li of lm og lq oh lu oi oj ok ol bi translated">p——玩游戏的次数，</li><li id="aeba" class="od oe it lb b lc om lf on li oo lm op lq oq lu oi oj ok ol bi translated">GF——进球数，</li><li id="d51c" class="od oe it lb b lc om lf on li oo lm op lq oq lu oi oj ok ol bi translated">GA——失球数。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/71268e57d326204af38ecf653252050b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UAUYbYSkQHQD687GR2vYMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">拉利加 2019/2020 赛季主场统计。</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/3c6c6340b7e37b1442eec39a0cf92145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KWdHMLnjX8THIA9q-9iG-g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">拉利加 2019/2020 赛季客场数据。</p></figure><h2 id="a1b2" class="ov mx it bd my ow ox dn nc oy oz dp ng li pa pb ni lm pc pd nk lq pe pf nm pg bi translated">攻击强度</h2><p id="a6aa" class="pw-post-body-paragraph kz la it lb b lc ph ju le lf pi jx lh li pj lk ll lm pk lo lp lq pl ls lt lu im bi translated">计算进攻强度的第一步，我们计算联赛主客场球队的平均进球数。这是总进球数除以主客场比赛总数。</p><p id="7d29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">主场平均进球数:1.50。</p><p id="4fb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">平均客场进球数:1.02。</strong></p><p id="fa35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第二步，我们需要确定一支球队的进攻实力有多强。我们计算每支球队的平均进球数，然后除以赛季的平均进球数。</p><p id="c47b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">记住这场比赛是在圣地亚哥伯纳乌，所以皇马主场作战，巴塞罗那客场作战。皇马进了 27 个球，打了 13 场主场比赛。Real 的攻击强度是 1.37。</p><pre class="kj kk kl km gt pm pn po pp aw pq bi"><span id="fec2" class="ov mx it pn b gy pr ps l pt pu">real attack strenght = 27 / 13 / 1.50</span></pre><p id="47c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">巴萨进了 18 个球，打了 13 场客场，所以攻击强度是 1.34。</p><pre class="kj kk kl km gt pm pn po pp aw pq bi"><span id="d214" class="ov mx it pn b gy pr ps l pt pu">barca attack strenght = 18 / 13 / 1.02</span></pre><h2 id="9f27" class="ov mx it bd my ow ox dn nc oy oz dp ng li pa pb ni lm pc pd nk lq pe pf nm pg bi translated">防御力量</h2><p id="4932" class="pw-post-body-paragraph kz la it lb b lc ph ju le lf pi jx lh li pj lk ll lm pk lo lp lq pl ls lt lu im bi translated">进攻实力重在进球，防守实力重在失球。平均值是从上面的攻击强度简单倒置而来的:</p><p id="4e50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">主场平均失球数:1.02 个。</strong></p><p id="b3eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">平均失球数:1.50 个。</p><p id="ea93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">竞争对手在 13 场主场比赛中对皇家马德里队进了 9 个球。皇马的主场防守强度为 0.67，巴萨的客场防守强度为 0.96。</p><pre class="kj kk kl km gt pm pn po pp aw pq bi"><span id="7f06" class="ov mx it pn b gy pr ps l pt pu">real defense strenght = 9 / 13 / 1.02<br/>barca defense strenght = 19 / 13 / 1.50</span></pre><h2 id="09d8" class="ov mx it bd my ow ox dn nc oy oz dp ng li pa pb ni lm pc pd nk lq pe pf nm pg bi translated">皇马有可能进多少球？</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/11763d1e2a98e1f6d7bda6a6d79f093a.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*q3GLh4tYem4rXASj.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Gif 来自<a class="ae ky" href="https://giphy.com/gifs/televisadeportes-real-madrid-liverpool-sRGEZCqd1q02ieKokd" rel="noopener ugc nofollow" target="_blank"> giphy </a></p></figure><p id="4bda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">把这些数字放在一起，我们可以计算出皇马的预期进球数。我们只是简单地将皇马的主场进攻实力与巴萨的客场防守实力乘以在拉利加主场作战时的平均进球数。</p><pre class="kj kk kl km gt pm pn po pp aw pq bi"><span id="f508" class="ov mx it pn b gy pr ps l pt pu">expected goals for real = 1.37 * 0.96 * 1.50</span></pre><p id="6e79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">皇马有望进 2.01 球。</p><h2 id="5323" class="ov mx it bd my ow ox dn nc oy oz dp ng li pa pb ni lm pc pd nk lq pe pf nm pg bi translated">巴萨有可能进几个球？</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/bda67e58e8b91ef99f727e8f0bb1d5c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*C_vhEeyXeWZDCY9p.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Gif 来自<a class="ae ky" href="https://giphy.com/gifs/messi-goal-fk-8cyro9Vo2FNhZ5mucq" rel="noopener ugc nofollow" target="_blank"> giphy </a></p></figure><p id="bd3a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用与上述相同的程序，只是改变家与客场。我们用客场打拉利加时的平均进球数乘以巴萨的客场进攻实力和皇马的主场防守实力。</p><pre class="kj kk kl km gt pm pn po pp aw pq bi"><span id="06b9" class="ov mx it pn b gy pr ps l pt pu">expected goals for barca = 1.34 * 0.67 * 1.02</span></pre><p id="da9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">巴萨有望进 0.93 球。</p><h2 id="9011" class="ov mx it bd my ow ox dn nc oy oz dp ng li pa pb ni lm pc pd nk lq pe pf nm pg bi translated">使用泊松分布预测结果</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pw"><img src="../Images/b2d007569fc655a60f730b1a640d2ec0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wp0EEFG2i1xKxH8vS71HDg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">泊松分布在线<a class="ae ky" href="https://www.danielsoper.com/statcalc/calculator.aspx?id=79" rel="noopener ugc nofollow" target="_blank">计算器</a></p></figure><p id="d4f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用在线<a class="ae ky" href="https://stats.areppim.com/calc/calc_poisson.php" rel="noopener ugc nofollow" target="_blank">计算器</a>计算泊松分布，以确定事件的概率。将巴萨的<strong class="lb iu"> <em class="px">平均发生率</em> </strong>设置为 0.93 目标，然后将<strong class="lb iu"> <em class="px">发生次数</em> </strong>设置为 0 到 5。我用熊猫来计算多种结果的概率。</p><p id="f350" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下表显示皇马有 26%的机会进 2 球。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi py"><img src="../Images/2f79302a2e894f1099c414d55c039eb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f3ILBt-uR4Jx48XeJuU4fA.png"/></div></div></figure><p id="0152" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上表中的概率是独立的，这意味着我们可以将它们相乘，并计算多个结果的概率。横排的进球是皇马的，横排的是巴萨的。结果 2:0 对皇马有 10%的机会。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pz"><img src="../Images/c627c7c072e59f0f1cedd0d2cbd1f43b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_3AHiXpTzNIolrKIbjMjtQ.png"/></div></div></figure><p id="0490" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">计算赔率</strong></p><p id="e2bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了计算概率，我们需要计算每一个平局的结果(0:0，1:1，等等。)然后将这些概率相加。平局的几率很简单:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pz"><img src="../Images/cd4d07b927f494adbc1a6fe8dfebd8e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dO3kl1LFb5hpDj_MdE5VUQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">平局结果用蓝色标记，真正的胜利用红色标记，巴塞罗那获胜用绿色标记。</p></figure><pre class="kj kk kl km gt pm pn po pp aw pq bi"><span id="7d69" class="ov mx it pn b gy pr ps l pt pu">odd for draw = 1 / sum( all draw outcomes)</span></pre><p id="50d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了计算真实获胜的几率，我们对真实获胜的每一个结果重复这个过程(1:0，2:0，等等。)巴萨也一样。</p><p id="1e6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最终的可能性是:</p><ul class=""><li id="637f" class="od oe it lb b lc ld lf lg li of lm og lq oh lu oi oj ok ol bi translated">真实胜率:1.6</li><li id="448c" class="od oe it lb b lc om lf on li oo lm op lq oq lu oi oj ok ol bi translated">平局:4.85</li><li id="9af2" class="od oe it lb b lc om lf on li oo lm op lq oq lu oi oj ok ol bi translated">巴萨获胜:6.14</li></ul><p id="1b61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，这些赔率没有博彩保证金。</p><h1 id="54b2" class="mw mx it bd my mz na nb nc nd ne nf ng jz nh ka ni kc nj kd nk kf nl kg nm nn bi translated">在你走之前</h1><p id="3ed3" class="pw-post-body-paragraph kz la it lb b lc ph ju le lf pi jx lh li pj lk ll lm pk lo lp lq pl ls lt lu im bi translated">如果你想自己运行这些例子，你可以下载这个<a class="ae ky" href="https://github.com/romanorac/romanorac.github.io/blob/master/assets/notebooks/Sport%20analysis%20pandas.ipynb" rel="noopener ugc nofollow" target="_blank"> Jupyter 笔记本</a>。</p><p id="dea3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<a class="ae ky" href="https://twitter.com/romanorac" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我，在那里我定期<a class="ae ky" href="https://twitter.com/romanorac/status/1328952374447267843" rel="noopener ugc nofollow" target="_blank">发布关于数据科学和机器学习的</a>消息。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qa"><img src="../Images/b5d426b68cc5a21b1a35d0a157ebc4f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*69rP1pwjJi9mLSFE"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">康特尼·赫格尔在<a class="ae ky" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div></div>    
</body>
</html>