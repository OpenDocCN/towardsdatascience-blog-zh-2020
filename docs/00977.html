<html>
<head>
<title>How to Perform Sequence Alignment on 2019-nCoV with MAFFT</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何利用 MAFFT 对 2019-nCoV 执行序列对齐</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-perform-sequence-alignment-on-2019-ncov-with-mafft-96c1944da8c6?source=collection_archive---------20-----------------------#2020-01-28">https://towardsdatascience.com/how-to-perform-sequence-alignment-on-2019-ncov-with-mafft-96c1944da8c6?source=collection_archive---------20-----------------------#2020-01-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="93ac" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">截至 2020 年 1 月 26 日，2019-nCoV 已经在中国武汉造成 76 人死亡。作为一种针对人类呼吸系统的冠状病毒，2019-nCoV 具有很高的传染性，尤其是在潮湿和寒冷的季节。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2da835ccc86e3b177f8bc2b8e936705a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6hRbFrjjkh5uJ2do.jpg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">DNA，图片来自<a class="ae ky" href="https://pixabay.com/illustrations/dna-biology-medicine-gene-163466/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="73ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">呼吸系统相关的病原体可以随着体液从喷嚏中高速射出。它们可以通过多种方式感染人类，最常见的是通过接触嘴、鼻子和眼睛。为避免感染，建议避免户外活动，尤其是在人群密集的地方。经常消毒双手，不要用手揉眼睛也很重要。</p><p id="a9df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">人们开玩笑说，他们现在只要躺在家里的沙发上就可以为社会做贡献。我在农历新年期间的所有会议计划现在都取消了。所以我决定分享一个教程，如何获取 2019-nCoV 的基因序列数据，并用 MAFFT 对其进行序列比对。我希望这篇文章提高了人们对生物信息学研究的兴趣，并有助于我们对抗下一场流行病。</p><h1 id="595e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">什么是序列比对和 MAFFT？</h1><p id="03d6" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu">序列比对</strong>是一种排列 DNA、RNA 或蛋白质以识别相似区域的方法，这可能揭示序列之间的功能、结构或进化关系。最近<a class="ae ky" href="https://onlinelibrary.wiley.com/doi/epdf/10.1002/jmv.25682" rel="noopener ugc nofollow" target="_blank">的一份出版物</a>提出，借助于 MAFFT 的序列比对，蛇可以跨物种传播给人类。</p><p id="b890" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">MAFFT(<strong class="lb iu">M</strong>multiple<strong class="lb iu">A</strong>alignment using<strong class="lb iu">F</strong>ast<strong class="lb iu">F</strong>ourier<strong class="lb iu">T</strong>transform)是 2002 年发表的一个多序列比对程序。它可用于 RNA 序列的序列比对。<strong class="lb iu">冠状病毒</strong>是例如具有单链 RNA 的病毒，该单链 RNA 被包裹在来源于宿主细胞膜的外壳中。关于 MAFFT 算法的细节可以在找到。</p><h1 id="d58b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">从哪里获取 RNA 序列数据？</h1><p id="dc4d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">2019-nCoV 的最新更新可以在<a class="ae ky" href="https://bigd.big.ac.cn/ncov#about" rel="noopener ugc nofollow" target="_blank"> NGDC </a>(中国国家基因组数据中心)上找到。在本教程中，我们将分析在 NCBI(国家生物技术信息中心)数据库内发现的<a class="ae ky" href="https://www.ncbi.nlm.nih.gov/nuccore/MN938384" rel="noopener ugc nofollow" target="_blank"> 2019-nCoV </a>病毒和<a class="ae ky" href="https://www.ncbi.nlm.nih.gov/nuccore/MK062184" rel="noopener ugc nofollow" target="_blank"> SARS-CoV </a>病毒。SARS-CoV，众所周知的 SARS(严重急性呼吸综合征),在 2020 年左右在 17 个报告的国家中导致 774 人死亡。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/f95fe542829e6e02d9da7aaa68005e79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*A0zAhIbStfKl2WO3.png"/></div></div></figure><p id="f06a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我有一份拷贝，并将数据粘贴到一个以病毒名称命名的文件中。它们应该类似于上面的内容，一个索引号后跟一批 10 个代码，每行 60 个代码，用空格分隔。我已经上传了这个分析的相关文件，并在本文末尾附上了链接。</p><h1 id="fe1b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">如何用 MAFFT 对 2019-nCoV 进行序列比对？</h1><p id="8d58" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">首先，我们需要安装 MAFFT。我们可以用下面的命令通过 Anaconda 安装它。不同操作系统的手动安装可以在<a class="ae ky" href="https://mafft.cbrc.jp/alignment/software/" rel="noopener ugc nofollow" target="_blank">maftt 官网</a>找到。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="0733" class="my lw it mu b gy mz na l nb nc">conda install mafft</span></pre><p id="a282" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">MAFFT 非常容易使用，但是它以一种特殊的格式处理数据。我们将需要对我们获得的数据进行预处理，以便它可以通过 MAFFT 进行校准。下面是执行此操作的 Python 脚本:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="f210" class="my lw it mu b gy mz na l nb nc">import sys<br/>import re<br/>output = ""<br/>for filename in sys.argv[1:]:<br/> infile = open(filename)<br/> data = infile.read()<br/> data = " ".join(re.split("[^atcg\n]", data))<br/> data = data.replace(" ", "")<br/> output = output + "&gt;" + filename + "\n" + data + "\n"<br/>print(output)<br/>outfile = open('SEQUENCES.txt', 'w+')<br/>outfile.write(output)</span></pre><p id="a386" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以将上面的 Python 代码保存到一个名为“preprocess.py”的文件中，与我的病毒 RNA 数据放在同一个文件夹中。然后我们可以在文件夹中运行下面的 bash 命令来预处理数据。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="f29b" class="my lw it mu b gy mz na l nb nc">python3 preprocess.py 2019-nCoV_HKU-SZ-002a_2020 icSARS-C7-MA</span></pre><p id="4df7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">名为“SEQUENCES.txt”的输出文件现在应该如下所示。由于病毒名称附加在文件的前面，空格和索引号也被去掉。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/804875df21e49930b89e562231732a0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-enzBvBFF678dTx4.png"/></div></div></figure><p id="91de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们可以通过以下步骤在我们的终端下使用 MAFFT 执行序列比对:</p><ol class=""><li id="e10c" class="ne nf it lb b lc ld lf lg li ng lm nh lq ni lu nj nk nl nm bi translated">定位到工作文件夹。</li><li id="2e3f" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated">在终端内呼叫“mafft”。</li><li id="3393" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated">对于输入文件，输入“SEQUENCES.txt”。</li><li id="e603" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated">对于输出文件，输入“output.txt”。</li><li id="e5c2" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated">为“Clustal 格式”选择“1”作为输出格式。</li><li id="0daa" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated">选择“1”作为“自动”策略。</li><li id="c2ae" class="ne nf it lb b lc nn lf no li np lm nq lq nr lu nj nk nl nm bi translated">为附加参数保留空白。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/404f6bf9e87d2e11ed3135bab482f9e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/0*ID_irdY6kpJ-Ca9O.gif"/></div></figure><p id="8c5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们按下回车键后，我们只需要等待 MAFFT 来排列我们的 RNA 代码。成品应该看起来像下面的东西。“-”用于移动代码，下面的“*”表示类似的顺序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/e11ade6c6f79c197b5ee13a00cb8da96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gDfiRbIMWx5-uBRj.png"/></div></div></figure><p id="3b98" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你，你已经学会了如何使用 MAFFT 进行序列比对！现在你可以玩基因代码，并利用你喜欢的排列信息！</p><h1 id="a66a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">附录(相关文件的链接)</h1><div class="nu nv gp gr nw nx"><a href="https://github.com/shenhuang/shenhuang.github.io/tree/master/2019-nCoV" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">黄慎/shenhuang.github.io</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">github.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol ks nx"/></div></div></a></div><p id="eb13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为开发人员、数据科学家等，帮助武汉抗击致命疾病:</p><p id="c0cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/wuhan2020/wuhan2020" rel="noopener ugc nofollow" target="_blank">https://github.com/wuhan2020/wuhan2020</a></p></div></div>    
</body>
</html>