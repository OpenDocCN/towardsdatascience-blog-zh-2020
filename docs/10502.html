<html>
<head>
<title>Best Bulletproof Python Feature Selection Methods Every Data Scientist Should Know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">每个数据科学家都应该知道的最佳防弹 Python 要素选择方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/best-bulletproof-python-feature-selection-methods-every-data-scientist-should-know-7c1027a833c6?source=collection_archive---------22-----------------------#2020-07-23">https://towardsdatascience.com/best-bulletproof-python-feature-selection-methods-every-data-scientist-should-know-7c1027a833c6?source=collection_archive---------22-----------------------#2020-07-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bb74" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用几行代码实现 5 种最佳特征选择方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7575e173d07cf71140e8b576fb3fd7bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ziSHGWZqF9zyopGfou3TTQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">亚历山大·科特利亚尔在<a class="ae ky" href="https://unsplash.com/s/photos/hd-neon--free-candies?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="5a14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在大多数数据科学项目中，特性选择是探索性数据分析之后的第二个自然步骤。该过程包括选择正确的特征以获得最佳预测。易于使用的特征选择方法通常包括 SelectFromModel、带有递归特征消除的特征排序、基于过滤器的单变量选择、特征重要性、投票选择器。要成为独角兽数据科学家，掌握最新的特征选择方法是一项必备技能。在本文中，我们将回顾 Kaggle winners 的特征选择方法，这些方法可以用简短的 python 代码实现。对于本文，我们将分析巧克力棒评级数据集样本，以“烟熏味”作为目标特征。</p><p id="577b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在这里找到完整的数据集:<a class="ae ky" href="https://www.kaggle.com/soroushghaderi/chocolate-bar-2020" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/b14ed07f48cda06ca33017360651032e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-pndKfNBXCyfbPi5IwRnmQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@shakalmag?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Maciej Gerszewski </a>在<a class="ae ky" href="https://unsplash.com/s/photos/confectionery?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="8166" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个具有挑战性的数据集，在分类编码后包含超过 2800 个特征。</p><ol class=""><li id="0b7c" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><strong class="lb iu">从模型中选择</strong></li></ol><p id="3c5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种方法基于使用算法(SVC，线性，套索..)<strong class="lb iu"> <em class="mf"> </em> </strong>只返回最相关的特征。</p><pre class="kj kk kl km gt mg mh mi mj aw mk bi"><span id="9680" class="ml mm it mh b gy mn mo l mp mq"><strong class="mh iu">#import libraries</strong><br/>from sklearn.linear_model import LassoCV<br/>from sklearn.feature_selection import SelectFromModel</span><span id="553f" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#Fit the model<br/></strong>clf = LassoCV().fit(X, y)</span><span id="611a" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#Selected features<br/></strong>importance = np.abs(clf.coef_)<br/>idx_third = importance.argsort()[-3]<br/>threshold = importance[idx_third] + 0.01<br/>idx_features = (-importance).argsort()[:10]<br/>name_features = np.array(feature_names)[idx_features]<br/>print('Selected features: {}'.format(name_features))</span></pre><p id="3d23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">精选特色:</strong>[' cocoa _ percent ' ' first _ taste _ 辛辣葡萄干' ' first _ taste _ pure ' ' first _ taste _ 葡萄干' ' first _ taste _ 葡萄干' ' first _ taste _ 覆盆子' ' first _ taste _ raw ' ' first _ taste _ 红莓' ' first _ taste _ 红果'，' first _ taste _ 红酒']</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/98fbeae8ee93db90a91a63c8fcab3689.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2EYQ65_CCUJ33WJgmVh6lw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@drew_beamer?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">德鲁·比默</a>在<a class="ae ky" href="https://unsplash.com/s/photos/hd-red-neon?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="89f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.<strong class="lb iu">递归特征消除的特征排序</strong></p><p id="5075" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">递归特征消除(RFE)方法将权重(系数或特征重要性)分配给递归提取数量减少的特征的特征。重复该循环，直到达到最佳特征数量。</p><pre class="kj kk kl km gt mg mh mi mj aw mk bi"><span id="9ec2" class="ml mm it mh b gy mn mo l mp mq"><strong class="mh iu">#import libraries<br/></strong>from sklearn.svm import SVC<br/>from sklearn.model_selection import StratifiedKFold<br/>from sklearn.feature_selection import RFECV<br/>import matplotlib.pyplot as plt</span><span id="4980" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#Fit the model<br/></strong>svc = SVC(kernel="linear")<br/>rfecv = RFECV(estimator=svc, step=1, cv=StratifiedKFold(2), scoring='accuracy')<br/>rfecv.fit(X, y)</span><span id="d943" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#Selected features<br/></strong>print(X.columns[rfecv.get_support()])<br/>print("Optimal number of features : %d" % rfecv.n_features_)</span></pre><p id="59ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">精选特色:</strong>[' specific _ bean _ origin _ or _ bar _ name _ Malo Island，batch Ma20/19 '，' specific _ bean _ origin _ or _ bar _ name _ Venezuela，Trinidad '，' second_taste_sweet']</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/39df4296bac7968932d3d5b5b89efbc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*khfJ4jg1y7bJQxG3XTQp5g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@andy_hyd?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">安迪·HYD</a>在<a class="ae ky" href="https://unsplash.com/s/photos/venezuela-cocoa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="08bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 3。基于单变量选择的过滤器</strong></p><p id="6559" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">统计 scikit-learn library SelectKBest 获得最具影响力的功能。下面的代码使用相关/卡方统计测试来选择最佳特征</p><pre class="kj kk kl km gt mg mh mi mj aw mk bi"><span id="a2d9" class="ml mm it mh b gy mn mo l mp mq"><strong class="mh iu">#import libraries<br/></strong>from sklearn.feature_selection import SelectKBest<br/>from sklearn.feature_selection import chi2<br/>import matplotlib.pyplot as plt</span><span id="ff6e" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#Fit the model<br/></strong>bestfeatures = SelectKBest(score_func=chi2, k=10)<br/>fit = bestfeatures.fit(X,y)<br/>dfscores = pd.DataFrame(fit.scores_)<br/>dfcolumns = pd.DataFrame(X.columns)</span><span id="93f0" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#concatenate the two dataframes<br/></strong>featureScores = pd.concat([dfcolumns,dfscores],axis=1)<br/>featureScores.columns = ['Specs','Score']</span><span id="ccae" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#print 10 best features<br/></strong>print(featureScores.nlargest(10,'Score').plot(kind='barh'))</span><span id="c13a" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#plot graph of feature importances <br/></strong>plt.show()</span><span id="0b13" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#Name selected features<br/></strong>X.iloc[:,62].name,X.iloc[:,127].name,X.iloc[:,1578].name,X.iloc[:,1493].name,X.iloc[:,911].name</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/6578183024754a94e7636f1de6bf9186.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*s2FDbP1ENGZjUFBUbyH3AA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用选择最佳方法的 10 个最佳特性<strong class="bd nc">(作者提供</strong>图片)</p></figure><p id="e30c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">所选功能:</strong>[' country _ of _ bean _ origin _ Vanuatu '，' company_location_Vanuatu '，' first_taste_basic '，' specific _ bean _ origin _ or _ bar _ name _ Venezuela，Trinidad '，' specific _ bean _ origin _ or _ bar _ name _ Malo Island，batch Ma20/19']</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/ee78db2db22ab4a197eed6d2eeb75c60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*etWaA38K6flBhOF4OY10Og.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">亚历山大·布朗迪诺在<a class="ae ky" href="https://unsplash.com/s/photos/cacao?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="8a77" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 4。特征重要性</strong></p><p id="26a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该方法使用基于树的分类器对特征进行评分。分数越高，该特征对于预测我们的目标特征越重要。</p><pre class="kj kk kl km gt mg mh mi mj aw mk bi"><span id="c577" class="ml mm it mh b gy mn mo l mp mq"><strong class="mh iu">#import libraries<br/></strong>from sklearn.ensemble import ExtraTreesClassifier<br/>import matplotlib.pyplot as plt</span><span id="8b40" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#Fit the model<br/></strong>model = ExtraTreesClassifier()<br/>model.fit(X,y)<br/>print(model.feature_importances_)</span><span id="2a72" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#plot graph of feature importances<br/></strong>feat_importances = pd.Series(model.feature_importances_, index=X.columns)<br/>feat_importances.nlargest(10).plot(kind='barh')<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/e632395f53a3aa972128abc59530b09a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*oCQqMBFKnZNZ3dj6InSa4g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">巧克力数据集中的前 10 个特征<strong class="bd nc">(作者提供的</strong>图片)</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/bce73a3d5737b0c43a9ac1e4044562f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ogipn8Q33-iFeewNuBfn7g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Gabriel Santiago 在 Unsplash<a class="ae ky" href="https://unsplash.com/s/photos/hd-neon-sweets?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">上拍摄的照片</a></p></figure></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="f345" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 5。使用 Xuniverse </strong>的投票选择器</p><p id="9e1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该方法对每个算法的特征进行评分，以最小的努力选择最佳的算法。</p><pre class="kj kk kl km gt mg mh mi mj aw mk bi"><span id="4292" class="ml mm it mh b gy mn mo l mp mq"><strong class="mh iu">#import libraries<br/></strong>!pip install xverse<br/>from xverse.ensemble import VotingSelector<br/>import matplotlib.pyplot as plt</span><span id="8e4e" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#Fit the model<br/></strong>clf = VotingSelector()<br/>clf.fit(X, y)</span><span id="56bd" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#Selected features<br/></strong>clf.feature_importances_<br/>print(clf.feature_importances_['Random_Forest'].nlargest(10).plot(kind='barh'))<br/>plt.show()</span><span id="a760" class="ml mm it mh b gy mr mo l mp mq"><strong class="mh iu">#Name selected features<br/></strong>clf.feature_importances_['Variable_Name'][2],clf.feature_importances_['Variable_Name'][1],clf.feature_importances_['Variable_Name'][12],clf.feature_importances_['Variable_Name'][13]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/f379dbb17d2507d742dee22c617d70f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*KnJtU3YBHgc_sAbK6h0iIg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用随机森林模型的巧克力数据集中的前 10 个特征<strong class="bd nc">(作者提供</strong>图片)</p></figure><p id="6d2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">所选特征:</strong> ['first_taste_basic '，' company_location_Vanuatu '，' rating '，' specific _ bean _ origin _ or _ bar _ name _ Malo Island，batch Ma20/19']</p><pre class="kj kk kl km gt mg mh mi mj aw mk bi"><span id="eece" class="ml mm it mh b gy mn mo l mp mq"><strong class="mh iu">#Selected features with 6 models <br/></strong>clf.feature_importances_</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/140e92b20918485f9c8a5dbdd7112991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QE4FEW7rUl4B80Nry47Nqg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用 6 个模型的巧克力数据集中的前 4 个特征<strong class="bd nc">(作者的</strong>图片)</p></figure><p id="868a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更多详情，请点击 github.com 的<a class="ae ky" href="https://github.com/Sundar0989/XuniVerse/blob/master/Xverse.ipynb" rel="noopener ugc nofollow" target="_blank">号</a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/a9092d8b1eb4df62f49e99e89106e247.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-j9ROE2b-l9_xx4mToRlwA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@bendavisual?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">本杰明·戴维斯</a>在<a class="ae ky" href="https://unsplash.com/s/photos/universe?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="9531" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有空闲时间，我建议你看看这个:</p><div class="ni nj gp gr nk nl"><a href="https://medium.com/@adityaguptai/all-about-feature-selection-f98bf5b1201c" rel="noopener follow" target="_blank"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd iu gy z fp nq fr fs nr fu fw is bi translated">关于特征选择的一切</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">1.什么是特征选择？</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">medium.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz ks nl"/></div></div></a></div></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="4654" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">总结一下</strong></p><p id="ac74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">参考此链接<a class="ae ky" href="https://www.kaggle.com/philboaz/chocolate-features-selection-2020?scriptVersionId=39418633" rel="noopener ugc nofollow" target="_blank">木质巧克力</a>了解巧克力棒功能的完整选择。这一简要概述提醒我们在数据科学中使用多种特征选择方法的重要性。这篇文章涵盖了提取最佳特性的 5 种基本 python 特性选择方法，并分享了有用的文档。</p><p id="2730" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">希望你喜欢，继续探索！</strong></p></div></div>    
</body>
</html>