# 洛杉矶交通数据分析🚗

> 原文：<https://towardsdatascience.com/la-traffic-data-analysis-part-1-53f24e21067d?source=collection_archive---------33----------------------->

## 使用公开来源数据分析洛杉矶的碰撞模式

![](img/dbc56fd81fcb0b4246641f514e76ae24.png)

图片由 [Jsig9](https://pixabay.com/users/Jsig9-15103906/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=4824646) 来自 [Pixabay](https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=4824646)

交通是一个几乎每个人都熟悉的问题。作为一名在洛杉矶生活了 7 年的居民，我经历过太多的交通堵塞，似乎不管一天中的什么时候或者一周中的哪一天。这就是为什么当我偶然发现由洛杉矶市维护的[交通碰撞数据集](https://data.lacity.org/A-Safe-City/Traffic-Collision-Data-from-2010-to-Present/d5tf-ez2w)时，我如此感兴趣。这个数据很酷，原因有几个。虽然它不直接测量流量，但它测量的是一个密切相关的代理。不难假设，更多的流量与更多的冲突相关，而更多的冲突直接导致更多的流量。

我希望像这样的数据集可以用来为每个人创造更安全、更高效的社区。本着这种精神，这个数据集(以及其他一些数据集)由洛杉矶市积极维护，并对公众免费开放。

浏览数据后，我决定尝试回答 3 个主要问题:

*   交通碰撞模式如何随一天中的时间、一周中的日期和一年中的时间而变化？
*   碰撞在地理上是如何分布的？有可能识别高风险区域或交叉路口吗？
*   有可能预测给定时间范围内的碰撞次数吗？

在进入上面的问题之前，让我们了解更多关于数据集的知识。

# **📈数据**

数据从 2010 年 1 月开始，每周更新。在我的特殊情况下，我使用 2010 年 1 月至 2019 年 7 月的数据，结果是大约 50 万行。每行对应一次碰撞。这些数据是从原始的纸质交通报告中转录出来的，因此很有可能存在错误。以下是一些关键字段的示例:

![](img/554aba96fda2f306c2adbf1d237d14ba.png)

从 LA 碰撞数据集中选择的字段

这些字段的可用性激发了上面列出的关键问题。

与任何数据集一样，这个数据集在开始任何分析之前都需要清理。有几列只有一个值，反映了该数据中的所有行都对应于流量冲突的事实。

还有多个字段具有冲突的近似街道名称(上面未显示)。这些文本字段需要清理，特别是删除多余的空格。同样，在上面的图片中，我们可以看到包含在一个字符串中的纬度/经度坐标。我将这些坐标提取在单独的列中以备后用。

下一步是检查空值或缺失值。约 16%的碰撞(~78K)没有相关的受害者年龄。还有少量(~400 个)碰撞没有有效的纬度/经度坐标，将从第 2 部分的绘图部分中排除。

# **💡**数据探索

清洗之后，但在进入主要问题之前，我想做一些一般性的数据探索。这种分析通常是有用的。即使心中没有一个具体的目标，我也经常能找到有用的趋势或见解。我将从绘制数据中的几个变量开始。顺便说一下，所有这些工作都是用 R 语言完成的，代码链接在文章的底部！

![](img/e08325145151abded46ac5af9637cd14.png)

按受害者年龄划分的碰撞次数。注意 99 岁时的峰值！

我想到了以下几点:

*   几乎没有 15 岁以下的受害者。
*   大多数受害者都是 20 多岁。每个年龄段的碰撞受害者数量一般在 30 岁以后会减少。
*   峰值最多为 5 的倍数(25、30、35 等)。这表明一些年龄是估计的，官方身份(如驾驶执照)并不总是在碰撞报告中使用。
*   99 岁似乎是一个包罗万象的水桶。实际上，99 岁以上的受害者不太可能有上面显示的那么多。

这一情节也引发了疑问:

*   如何处理与多个受害者的碰撞？
*   99 岁的高峰是怎么回事？

我就这些问题给数据所有者发了电子邮件，但不幸的是没有收到回复。如果我得到回应，我会添加更新。

接下来，我们按性别来看碰撞。

![](img/c31362a498284bcbce9a075125134932.png)

按性别划分的碰撞次数。“X”代表未知性别。

*   这幅图告诉我们，如果发生了碰撞，受害者更可能是男性而不是女性。

如果我有按性别划分的司机总数，考虑到人均碰撞量，这项工作会更有趣。这将是这一数据反复出现的缺点，也将是我对这一分析的主要延伸之一。

接下来我要做的是查看数据中最低和最高的碰撞天数。我只包括两端最高和最低的 0.5%，所以我可以手动查看结果。以下是最低碰撞天数:

![](img/8105354fefc6ec21bccf700eef385b97.png)

碰撞次数最少的日子。“每日计数”是相应一天的碰撞次数。

*   大多数低碰撞日都在节假日前后。直觉上，这是有道理的，因为在(某些)假期开车的人可能会少一些。
*   大多数低碰撞日发生在 2014 年初之前。我们将在这篇文章的后面看到，每月的碰撞在 2014 年后开始上升。

这里是最高的碰撞日:

![](img/b244f6903226292e89ed96d734dcfbdd.png)

碰撞次数最多的日子。“每日计数”是相应一天的碰撞次数。

*   大多数高碰撞日是 2015 年后的星期五。
*   我们将在这篇文章的后面看到，星期五通常是一周中碰撞次数最多的一天。

这些结果引出了一些超出本分析范围的问题和想法。

*   为什么只有一些节假日与低碰撞日相关联？例如，MLK 日作为低碰撞日出现了两次，但独立日从来没有。
*   为什么像阵亡将士纪念日或劳动节这样的节日不会显示为低冲突日或高冲突日？
*   夏令时在任何一年都不会出现任何异常值。这让我很惊讶。
*   观察高碰撞日的天气情况会很有趣吗？

记住这些描述性的分析，我准备好解决我在这篇文章开始时提出的关键问题。第一个是关于分析碰撞随时间的变化。

# **🕒**按时间碰撞

在这一节中，我分析了碰撞模式如何随着一天中的时间、一周中的日期和一年中的时间而变化。

首先，我绘制了 2018 年的每日碰撞。绘制从 2010 年开始的所有数据太混乱了，所以本节的许多部分我只关注 2018 年。除了碰撞日期，数据还有一个报告日期字段。这是事故实际报告给警方的日期。在大多数情况下，报告日期是碰撞日期的同一天或后一天。

![](img/9ccae4e10bfc2c615c5a748b6125a8a7.png)

2018 每日碰撞和碰撞报告。你能看出不同之处吗？

*   日常碰撞和报告的碰撞有明显的差异。看看四月中旬报告的碰撞高峰…在实际碰撞中没有类似的情况！
*   这些差异使我认为，关于冲突何时被报告或处理，可能存在管理动态。
*   数据中的异常值没有明显的模式。

让我们看一个类似的按月汇总的图。在这个层次上，我可以包括从 2010 年到 2019 年的整个时间框架。

![](img/e4d54cc43c8dd0a76a5fb237c6571ecc.png)

每月冲突和报告的冲突

*   在月线级别，这两个量似乎比日线级别更紧密地相互跟踪。
*   2010 - 2014 年每月的碰撞次数大致恒定，2014 - 2017 年上升，2017 - 2019 年大致恒定。请记住，本次分析使用的数据截止到 2019 年 7 月。

那么，为什么上图中每月的碰撞会上升呢？2014 - 2017 年在洛杉矶生活和开车的人数上升了吗？会不会和拼车服务的兴起有关？从这些数据中还不清楚，但这些可能是一个单独帖子的起点。

接下来，我分析一天中碰撞的分布。

![](img/e53ffd50f92f0c91ed059356cf2ca7df.png)

一天中不同时间的碰撞

碰撞是:

*   从凌晨 4 点到 8 点急剧增加
*   从上午 8 点减少到上午 9 点 30 分
*   通常从上午 9:30 到下午 6:00
*   从晚上 8 点到凌晨 4 点急剧下降
*   在他们每天的最小值[最大值]凌晨 4 点[~下午 5 点]

这些结果可能反映了道路上的车辆数量。凭直觉，许多碰撞发生在晚上高峰时间。正如我之前提到的，获得每小时道路上车辆总数的测量值将允许我计算人均碰撞数。报告冲突时没有可用的每小时时间戳，所以我不能按小时绘制该字段。

下一步是通过一周中的某一天来检查碰撞。

![](img/44db16f0bcd270ebe8bcf1c117667ae0.png)

冲突和按星期报告的冲突

碰撞是:

*   周日至周五增加，周四至周五急剧增加
*   周日[周五]达到每周最低[最高]

工作周的结束是周五大量碰撞的明显假设。到目前为止我还没想出其他的！

对于报告的冲突:

*   周日[周五]的碰撞仍然最少[最多]
*   然而，每个工作日报告的冲突基本上是恒定的

最后，我按月绘制结果。

![](img/a1cd6b4c5dc170a0dfa19b72cf33b3d2.png)

按月报告的碰撞和碰撞。在此分辨率下，这些字段是相似的。

碰撞是:

*   通常从 4 月到 8 月保持不变
*   一般 9 月至 2 月较低，尤其是 9 月至 12 月
*   三月最高

因此，在较冷的月份，碰撞往往会减少。对此一个可能的解释是，在寒冷的月份里，到洛杉矶旅游的游客较少。关于 3 月份的高碰撞次数，我最初的假设是夏令时。然而，没有一个最高的碰撞日是在这一天。或许这个结果源于春假游客？

这就结束了我对碰撞时间模式的分析。以下是我对以上结果的总结。

*   碰撞和报告的碰撞在每日水平上变化很大，但在每月水平上没有变化。
*   2010 - 2014 年每月的碰撞次数大致恒定，2014 - 2017 年上升，2017-2019 年年中(本次分析的结束日期)大致恒定。
*   碰撞次数在大约凌晨 4 点[~下午 5 点]最低[最高]。
*   周日[周五]碰撞次数最低[最高]。
*   9 月至 12 月(3 月)的碰撞次数最少[最多]。
*   获取特定时间道路上车辆总数的信息将有助于对上述结果进行有趣且有用的人均计算。

接下来是看地理碰撞。

# 🌎地理上的冲突

除了纬度/经度坐标，该数据还有多个描述碰撞发生地点的字段。我将从查看这些字段开始。首先，我将通过`area`绘制碰撞的分布。

![](img/eff4fd3c3174350774e1721abfb9daf6.png)

由“区域”列计数的冲突

一些区域显然比其他区域有更多的碰撞。但是没有额外的信息，如大小或每`area`的交通密度，这个图表不能提供太多信息。

该数据还包括名为`location`和`cross_street`的字段。`location`是发生碰撞的主要街道，而`cross_street`是最近的十字路口。我将看看这些字段的 10 个最常见的值及其组合。

![](img/8e48765540be71d475f2428b0f1aa160.png)

碰撞最多的“位置”

10 条最常见的`location`是洛杉矶最长、交通最繁忙的道路。这 10 条街道占总碰撞数的 10%。总共有>25K`location`，所以尾巴很长。现在，我来看看`cross_street`字段。

![](img/2f066ee69d8b1d69e14e62eba87c7e9b.png)

碰撞最多的“cross_street”

5%的冲突没有关联的`cross_street`。否则，这个列表与前面的列表有很多重叠。显而易见，下一步是通过结合这两个字段来查看最常见的碰撞交点。

![](img/837742de48f747596586bb50175ddc5d.png)

碰撞最多的交叉口

最常见的碰撞交叉路口(`location` / `cross_street`组合)包含许多与之前列表中相同的街道。然而，也有例外:第 2 行(坦帕大道和诺德霍夫街)的组件既不出现在最常见的`location`中，也不出现在`cross_street`中。即使是最容易发生碰撞的交叉路口也只占全部碰撞的一小部分。

现在是时候利用数据中的地理坐标，开始绘制碰撞图了。提醒一下，有少量碰撞没有有效的纬度/经度数据，因此不包括在本节中。

![](img/c801bb2a6d88e53c2c72af89aed7080b.png)

整个洛杉矶的 2018 碰撞。每个点都是唯一的纬度/经度坐标。

*   点的空间分布显示了 LA 有趣的形状。
*   蓝色[红色]点表示纬度/经度坐标，2018 年的碰撞数较低[较高]。
*   即使在这张缩小的地图上，在山谷(地图的北部)和城市的中部和东部也可以看到高碰撞坐标。

这张地图相当混乱。为了更好地观看，我将放大一个窗口，显示洛杉矶市中心的大部分。

![](img/750a6aee7af58f0f8cb099211709abfd.png)

洛杉矶选定区域的 2018 年碰撞

*   许多中高碰撞坐标清晰可见。许多这些高碰撞点往往发生在同一条街道的不同十字路口。

之前的地图显示了整体碰撞。如果我加上一天中的时间，这个数据看起来怎么样？

![](img/0a1b20467d44db1c5fecc3d337e68899.png)

2018 年洛杉矶选定地区最常见日间部分的碰撞

*   该图仅包括 5+次碰撞的坐标。每一个坐标都被分配到发生大部分碰撞的那一天。日部分之间带连线的坐标被删除。
*   大多数碰撞发生在`Early Morning`时没有坐标。鉴于我通过时间分析在碰撞中的发现，这是有意义的。
*   许多坐标的大部分碰撞发生在`Afternoon`和`Evening`。该结果也与“按时间划分的碰撞”部分的结果相匹配。
*   有趣的是，有一组坐标中`Late Night`碰撞是常见的。

让我们看一个类似的按工作日/周末划分的地图。

![](img/a524cca0d6fd74463004606daf3f0e15.png)

2018 年洛杉矶选定地区最常见周部分的碰撞

*   该图仅包括 3+碰撞的坐标。每个坐标都被分配到发生大多数碰撞的星期几。周部分之间带连线的坐标被移除。
*   `Weekday`桶里显然有更多的日子和碰撞。
*   这张地图标明了周末撞车事故多发的地区。将星期五的部分或全部包含在`Weekend`桶中也可能很有趣。

为了结束这一节，我按一年中的时间绘制碰撞图。

![](img/8e8d8836a13ea50b78ecef051c6c859d.png)

洛杉矶选定地区最常见季节的 2018 年碰撞

*   该图仅包括 3+碰撞的坐标。每个坐标被分配给大多数碰撞发生的季节。季节间有联系的坐标被删除。
*   看起来更多的碰撞发生在夏季(3-8 月)。这将与“按时间划分的碰撞”部分中的结果一致。
*   考虑到洛杉矶没有像秋天或冬天这样明显的季节，可能有其他方式来划分这样一个地块的一年。

这些是我对“地理碰撞”部分的结论:

*   使用`location`和`cross_street`字段，除了绘图之外，还可以确定洛杉矶最容易发生事故的坐标。
*   最常见的碰撞日部件是`Afternoon`和`Evening`。
*   工作日发生的碰撞比周末多得多。按周部分绘制碰撞图显示了周末碰撞更常见的区域。
*   夏季发生的碰撞比冬季多。

# 🔮预测碰撞

最后一节讨论如何预测碰撞。我特别试着预测每月和`area`会发生的碰撞次数。

我先来看一个单个`area`的碰撞时间序列的例子:

![](img/d7c234bc0f1d64f4800884181ced4b35.png)

区域 2(壁垒)的每月碰撞

*   `area` 2 的趋势通常与整体每月冲突的趋势相匹配(这是在按时间分析的冲突中)。

让我们将这个时间序列分解成趋势、季节性和剩余部分。作为题外话，我将在这篇文章中关注分析结果，而不会深究我所使用的时间序列方法的理论。然而，如果你想了解更多，网上有很多资源可以利用！

![](img/73a6e7fb493e01dd3d8d0b504b8fd4d9.png)

“区域”2 的趋势、季节性和剩余部分(壁垒)

*   记住季节性曲线的形状。接下来，我将把它与每月碰撞总数的分解进行比较。
*   趋势看起来与我们在上图中看到的相似。

让我们比较一下`area` 2 分解和整体每月碰撞分解。

![](img/90663313653232b6deffcf42da97fd40.png)

总体数据的趋势、季节性和剩余部分

*   与`area` 2 相比，整体数据的季节性曲线看起来非常不同！这表明不同的区域可以有不同的动态。

接下来，我将查看`area` 2 的自相关函数(ACF)和部分自相关函数(PACF)。ACF 分析碰撞的滞后值与当前值的相关程度。PACF 显示了每个滞后解释了多少以前无法解释的差异。

![](img/6728eca574d17ab5e59d1929ada8ec8a.png)

ACF 和 PACF 负责“区域”2(壁垒)

*   这些图表明`area` 2 碰撞值与其滞后相关。然而，在前两个滞后值之后，额外的滞后并不能解释太多无法解释的差异。
*   因此，任何预测`area` 2 碰撞的模型应该包括至少 2 个滞后项。

我尝试了几种不同的模型来预测碰撞:

*   3 个月和 6 个月移动平均线模型(MA)
*   自回归综合移动平均线(ARIMA)
*   先知图书馆

MA 模型平均过去的值来生成预测，是最简单的时间序列模型。ARIMA 模型可以使用过去的值、差异和以前的误差。Prophet 是一个附加预测模型，其中非线性趋势与年度和月度季节性相适应。

先知比和马的模型更新。你可以在这里找到更多信息:

[](https://facebook.github.io/prophet/) [## 先知

### Prophet 是一个用 R 和 Python 实现的预测程序。它速度很快，并提供完全自动化的预测…

facebook.github.io](https://facebook.github.io/prophet/) 

我根据最后 12 个月(2018 年 8 月至 2019 年 7 月)的数据，使用以下指标评估每个模型:

*   平均绝对百分比误差(MAPE):预测值和实际值之间的平均绝对百分比差
*   偏差:预测值和实际值之间的平均百分比差异

MAPE 让我知道我的预测离实际碰撞值有多远，而偏差告诉我是否系统地高估或低估了数据。

我为每个`area`自动调整 ARIMA 模型。所以每一个都可以有不同的 p、d 和 q。我还测试了多个 Prophet 模型规格(并在下面显示了最佳结果)。以下是所有区域的平均模型 MAPE 和偏差结果:

![](img/11b2ea735d62421a2859aae41e33bda4.png)

数据中所有区域的多个平均模型结果

*   总的来说，我觉得这些成绩都不错！
*   3 个月和 6 个月 MA 模型的表现非常相似。
*   ARIMA 模型与马模型有相似的 MAPE，但偏差更大。
*   到目前为止，Prophet 模型的结果最差(即使在调优之后)。
*   令我惊讶的是，MA 型号(最简单的型号)的性能最好！

让我们只看一下`area` 2 的模型预测。

![](img/1dac021b287598a4eb033ff4704fbfd8.png)

“区域”2(壁垒)的模型预测与实际碰撞

*   在前 5 个月，Prophet 模型的预测值高于其他模型。
*   所有模型都错过了 2019 年 1 月的下降和 2019 年 4 月-2019 年 7 月的上升/下降模式。
*   6 个月 MA 模型预测变化不大。
*   马模型和 ARIMA 模型似乎做出了保守的预测，没有捕捉到数据的波动性。

接下来，我将查看每个型号每月的平均 MAPE。该图包括所有区域。

![](img/4f56c8f8b9ab5d52024864ce6319cf1e.png)

每个型号的平均月 MAPE(所有地区)

*   对于验证数据的前半部分，MA 和 ARIMA 模型的 MAPE 一起移动。

也值得看看每个模型每月的平均偏差。

![](img/49312b1ddfe66a83556a3209d1bed8fc.png)

每个模型的平均月偏差(所有地区)

*   对马模式和 ARIMA 模式的偏好一起移动。
*   Prophet 模型对整个验证集有正偏差(过度预测)。

现在，我将根据`area`查看每个模型的平均 MAPE 和偏差。

![](img/c4f445a22360859075212a7b2fcb4e14.png)

每个“区域”每款车型的平均 MAPE

*   MAPE 的平均表现因地区而异。例如，12 区[3]的模型性能相对较好[差]。

![](img/de0b655c263eebc2bece273511b54587.png)

每个模型每个“区域”的平均偏差

*   平均偏差也因`area`而大幅变化。
*   令人惊讶的是，大多数模型对大多数区域都有正偏差(这表明预测过度)!

接下来，我将看看每个模型的最差`area`/月预测。

![](img/af875a4d6f4b505e878fa610496dd44c.png)

*   `area` 14 出现两次。2019 年 1 月和 2 月都出现。
*   有趣的是，看到了所有模型都在挣扎的情况(2019 年 1 月`area` 2)与一个模型特别挣扎的情况(2018 年 9 月`area` 14)。

基于最坏的预测，我将放大到`area` 14。

![](img/2ca32080f206e3f517f2c220d2af47ed.png)

“区域”14(太平洋)的模型预测与实际碰撞

*   `area` 14 的趋势与上述`area` 2 完全不同。
*   2019 年 7 月除了 Prophet 以外的所有车型都错过了秒杀。

以下是我对碰撞预测部分的结论:

*   总体月度表现还不错(MAPE < 10%，多数情况下有偏差)。
*   然而，MA 模型具有最好的性能，这表明长期滞后数据、差分和以前的误差不会提高误差率。这令人惊讶，但表明每月的碰撞次数在一定范围内是随机的。
*   趋势似乎因`area`而异。这在理论上应该由 ARIMA 和预言家方法来解决，它们符合`area`的独立模型。
*   为了改进这些模型，我想深入挖掘一两个领域，并试图理解趋势。获得关于一辆`area`的具体交通模式的数据肯定也会有所帮助。额外的数据源(如天气)也很有希望被探索。

# 🏁结论

我对洛杉矶碰撞数据的分析到此结束！如果你有解决这些问题的其他方法，请随时联系我们。

您可以在下面的 GitHub 资源库中找到我使用的所有代码:

[](https://github.com/jai-bansal/los-angeles-collision-analysis) [## 杰-班萨尔/洛杉矶-碰撞分析

### 这份报告包含围绕洛杉矶碰撞数据分析的材料。以下是对…的描述

github.com](https://github.com/jai-bansal/los-angeles-collision-analysis) 

如果你喜欢这篇文章，看看我下面的其他作品吧！

[](/how-to-use-random-seeds-effectively-54a4cd855a79) [## 如何有效使用随机种子

### 这篇文章是关于机器过程中通常不会引起太多注意的一个方面:随机种子。

towardsdatascience.com](/how-to-use-random-seeds-effectively-54a4cd855a79) [](https://medium.com/@jai_bansal/7-tips-for-developing-technical-trainings-for-your-organization-928cf7744d44) [## 为您的组织开发技术培训的 7 个技巧

### 将你的下一个培训课程想法变成现实的技巧

medium.com](https://medium.com/@jai_bansal/7-tips-for-developing-technical-trainings-for-your-organization-928cf7744d44) 

感谢阅读！