<html>
<head>
<title>String Functions in SQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL中的字符串函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/string-functions-in-sql-9f08fabfa60e?source=collection_archive---------30-----------------------#2020-02-16">https://towardsdatascience.com/string-functions-in-sql-9f08fabfa60e?source=collection_archive---------30-----------------------#2020-02-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7f49" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">分析SQL中的字符串远不止像“%…%”这样简单</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/892395a0dda0aff03ae74fe138771437.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2T6yuUMukbbZIncGKFiGsg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用SQL解开字符串看起来很困难，但是通过了解正确的函数会变得更容易</p></figure><p id="3caf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">虽然SQL有时在功能更丰富的分析环境(如具有丰富功能库的R或Python)旁边有一个“永久伴娘”的名声，但在过去几年中，处理字符串的标准函数越来越多地被采用，这大大增加了在SQL中处理字符串的可能性。</p><p id="37ef" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">翻译和替换是许多数据库系统中都有的另外两个功能。它们已经存在很多年了，但是一些数据库，比如SQL Server，只是最近才添加了它们；MySQL仍然没有添加翻译。</p><p id="854d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这两个函数都用来替换字符串。REPLACE用另一个字符串替换整个字符串，而TRANSLATE一次交换一个字符。</p><p id="08e9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，您可以像这样使用REPLACE，将一个完整的姓名或单词替换为另一个完整的姓名或单词:</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="c700" class="lz ma it lv b gy mb mc l md me">SELECT REPLACE('I''m Bruce Wayne','Bruce Wayne', 'Batman');</span></pre><p id="7165" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">结果:</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="a8b5" class="lz ma it lv b gy mb mc l md me">I'm Batman</span></pre><p id="d0b7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另一方面，as TRANSLATE用其他特定字符替换字符，这对于克服数据中的可重复问题非常有用。例如，如果少量的字母或符号字符与数字数据混合在一起，妨碍了它们被正确地视为数字，那么这是一个很好的函数——只需使用translate来删除这些字符。另一个用途是，如果要导出为csv格式的表格中的文本数据中使用了逗号。如果您保留逗号并尝试导出，则很有可能无法正确检测到列，因为新列将被插入到不应该插入的位置。</p><p id="25a0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，想象一个国家名称列表，其中，例如，朝鲜被列为“朝鲜，民主主义人民共和国”，而中国被列为“中国，人民共和国”——它们的官方英文名称被呈现，以便能够在朝鲜和中国下进行索引。</p><p id="fa95" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果保留逗号，国家名称列有时会被拆分，破坏列与数据的对应关系。因此，您需要删除逗号。尝试以下方法:</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="71e2" class="lz ma it lv b gy mb mc l md me">SELECT TRANSLATE('China,Peoples Republic',',',' ')</span><span id="50d1" class="lz ma it lv b gy mf mc l md me">China Peoples Republic</span></pre><p id="0048" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">TRANSLATE函数的诀窍在于，要替换的字符列表和将要替换它们的列表需要顺序相同，这样SQL就知道如何处理它们。然而，总的来说，这是一个非常灵活的功能。</p><p id="f40a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">近年来标准中引入的另一个主要函数是LISTAGG函数。SQL Server中也有此函数，语法与STRING_AGG类似。此函数将一列中不同单元格的字符串值连接成一个字符串，分隔符由用户指定。</p><p id="4fbb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用此函数的一种方法是，如果您以组件形式存储姓名和地址数据(名、姓、门牌号码、街道名称等的单独列)，这样可以更容易地搜索特定属性，然后您可以将组件组合成完整的姓名和地址，并采用您喜欢的格式。尝试以下方法:</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="11c4" class="lz ma it lv b gy mb mc l md me">CREATE TABLE Names<br/>(Names varchar(10));</span><span id="4855" class="lz ma it lv b gy mf mc l md me">INSERT INTO Names Values<br/>('John')<br/>,('Paul')<br/>,('George')<br/>,('Ringo');</span><span id="bdf1" class="lz ma it lv b gy mf mc l md me">SELECT STRING_AGG(Names,' and ')<br/>FROM Names</span><span id="8697" class="lz ma it lv b gy mf mc l md me">Result: <br/>John and Paul and George and Ringo</span></pre><p id="7b12" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">知道如何在SQL中处理字符串似乎很困难。然而，这在很大程度上是因为那些帮助你正确处理字符串的函数并不像它们应该的那样广为人知。掌握上面讨论的功能会给你额外的灵活性来处理弦乐。</p><p id="845c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">罗伯特·德格拉夫的书《管理你的数据科学项目》<a class="ae mh" href="https://www.amazon.com/Managing-Your-Data-Science-Projects/dp/1484249062/ref=pd_rhf_ee_p_img_1?_encoding=UTF8&amp;psc=1&amp;refRID=4X4S14FQEBKHZSDYYMZY" rel="noopener ugc nofollow" target="_blank"><em class="mg"/></a><em class="mg">》已经通过出版社出版。</em></p><p id="62d1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae mh" href="https://twitter.com/RobertdeGraaf2" rel="noopener ugc nofollow" target="_blank"> <em class="mg">在Twitter上关注罗伯特</em> </a></p></div></div>    
</body>
</html>