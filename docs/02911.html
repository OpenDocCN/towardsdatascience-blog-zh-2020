<html>
<head>
<title>Learn How to (easily!!) do 3 MORE Advanced Excel Tasks in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习如何(轻松！！)用Python做3个更高级的Excel任务</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learn-how-to-easily-do-3-more-advanced-excel-tasks-in-python-36449e425c9d?source=collection_archive---------15-----------------------#2020-03-20">https://towardsdatascience.com/learn-how-to-easily-do-3-more-advanced-excel-tasks-in-python-36449e425c9d?source=collection_archive---------15-----------------------#2020-03-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2578" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Excel高级用户对熊猫的更多介绍</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/468d849aa5ccee86626a6e64daec578d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MRk8ZQYnguQWg7Aey1Rg6Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让我们用Python来承担一些更高级的Excel任务吧！资料来源:Nik Piepenbreier</p></figure><p id="1125" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在另一篇文章中，我们<a class="ae lu" rel="noopener" target="_blank" href="/learn-how-to-easily-do-3-advanced-excel-tasks-in-python-925a6b7dd081">学会了如何(轻松！！)用Python做3个高级Excel任务</a>。在这里，我们将继续这项任务，并学习另外3项你可以轻松掌握的高级技能！我希望这篇文章让Python变得更加平易近人，同时在这两个伟大的工具之间提供一些有趣的比较。</p><p id="1693" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将从导入pandas开始，并根据工作簿中的工作表加载两个数据帧。我们使用与上一篇文章相同的数据集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="3412" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想继续的话，我已经为这篇文章上传了一个完整的笔记本。在<a class="ae lu" href="https://github.com/datagy/mediumdata/blob/master/3%20More%20Advanced%20Excel%20Tasks%20in%20Python.ipynb" rel="noopener ugc nofollow" target="_blank">可以找到这个链接</a>。遗憾的是，颜色格式没有遵循，但是您可以很容易地从那里复制并粘贴代码。同样，如果你想在Excel中跟进，你可以通过<a class="ae lu" href="https://github.com/datagy/mediumdata/raw/master/pythonexcel.xlsx" rel="noopener ugc nofollow" target="_blank">这个链接</a>下载文件。</p><p id="2fd2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们开始吧！</p><h1 id="05d4" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">Pandas中的彩色地图格式</h1><p id="dfbc" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">条件格式是Excel中非常棒的工具之一，它可以让我们快速挑出数据中的异常值，例如最高值或最低值。让我们先在我们的Excel文件中这样做！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/05db579a13a7ba11afebe33ee8a09754.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*y316bLmJfnCX8t_8LRKCtA.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Excel中应用色彩映射表很容易！资料来源:Nik Piepenbreier</p></figure><p id="b099" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">选择要格式化的列。</p><p id="a7c2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在“主页”选项卡下，选择条件格式、色标和</p><p id="6f5e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">选择您想要使用的比例。我们用了绿-黄-红。</p><p id="05ab" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在熊猫身上，我们想应用。背景_渐变样式方法。我们可以通过输入:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="9bef" class="na ly it mw b gy nb nc l nd ne">sales.style.background_gradient(subset=[‘Sales’], cmap = ‘YlGnBu’)</span></pre><p id="a25d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将返回:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/1178d3da8c39b4a3b0c3ee1a469ddc9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZDgGSZci5qtyUzYwOaXqTw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在熊猫身上应用色阶的结果。资料来源:Nik Piepenbreier</p></figure><p id="c772" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们稍微分解一下这个语法:</p><ul class=""><li id="bfeb" class="ng nh it la b lb lc le lf lh ni ll nj lp nk lt nl nm nn no bi translated"><strong class="la iu">子集</strong>:识别您想要应用这个的列。如果您想要多个，请将它们嵌套在列表中。</li><li id="1b20" class="ng nh it la b lb np le nq lh nr ll ns lp nt lt nl nm nn no bi translated"><strong class="la iu">cmap</strong>:Matplotlib中的颜色映射。这确定了我们想要应用的色阶类型。更多细节可以在<a class="ae lu" href="https://matplotlib.org/tutorials/colors/colormaps.html" rel="noopener ugc nofollow" target="_blank">这里找到</a>。</li></ul></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h1 id="ba4f" class="lx ly it bd lz ma ob mc md me oc mg mh jz od ka mj kc oe kd ml kf of kg mn mo bi translated">Python中的数据栏</h1><p id="2fb9" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">与色标类似，数据条使我们能够轻松地识别单元格中值的大小。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/f50294db07db3286cdd2f1c01365c319.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*4dR42aWVC4Hw3A4jFL9C5Q.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Excel中添加数据栏。资料来源:Nik Piepenbreier</p></figure><p id="ec4a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要在Excel中添加数据栏:</p><p id="2d01" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">选择要格式化的列。</p><p id="6a9e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在主页选项卡上，转到条件格式→数据栏。</p><p id="d2b2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，我们选择了纯蓝。</p><p id="f030" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了用Python和Pandas实现这一点，我们可以编写以下代码:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="efc1" class="na ly it mw b gy nb nc l nd ne">sales.style.bar(subset=['Sales'], color = '#50C878')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/cdd809f4677d2922362e7a9eb5d09ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*luDihBYT2lCZFvzcml3NJQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Python中用熊猫应用数据栏。资料来源:Nik Piepenbreier</p></figure><p id="9944" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们再细分一下:</p><ul class=""><li id="41d3" class="ng nh it la b lb lc le lf lh ni ll nj lp nk lt nl nm nn no bi translated"><strong class="la iu">子集</strong>再次引用我们想要应用格式的列，而</li><li id="9ab6" class="ng nh it la b lb np le nq lh nr ll ns lp nt lt nl nm nn no bi translated"><strong class="la iu">颜色</strong>是指我们要应用的颜色的十六进制代码！</li></ul></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h1 id="2177" class="lx ly it bd lz ma ob mc md me oc mg mh jz od ka mj kc oe kd ml kf of kg mn mo bi translated">熊猫中的SUMIFs</h1><p id="a67a" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">最后，我们将探索如何用Python完成SUMIFs。SUMIF函数允许我们根据条件将值相加(该条件是否出现在另一列取决于我们)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/31e4134dea63cb3b35efa7b940d71438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*wgZDpgteUy87phN7wDn2lQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Excel中计算SUMIFs。资料来源:Nik Piepenbreier</p></figure><p id="9c8b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在左边的例子中，我们计算所有香蕉销售的总销售额。我们通过使用以下公式实现了这一点:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="39dc" class="na ly it mw b gy nb nc l nd ne">=SUMIF(sales[Product], "Bananas", sales[Sales])</span></pre><p id="1ad8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以通过编写以下代码在Python中完成同样的事情:</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="c27a" class="na ly it mw b gy nb nc l nd ne">sales.loc[sales["Product"] == "Bananas", "Sales"].sum()</span></pre><p id="7438" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">就像在Excel中一样，这将返回5843。让我们来看看这里发生了什么:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/e7963b56d2aff6462def1969ab52dcc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1MY3sokcB0O2biOBXNtxSA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">如何承担熊猫的SUMIF功能？资料来源:Nik Piepenbreier</p></figure></div><div class="ab cl nu nv hx nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="im in io ip iq"><h1 id="ac48" class="lx ly it bd lz ma ob mc md me oc mg mh jz od ka mj kc oe kd ml kf of kg mn mo bi translated">结论:学会如何(轻松！！)用Python做3个更高级的Excel任务</h1><p id="2b1d" class="pw-post-body-paragraph ky kz it la b lb mp ju ld le mq jx lg lh mr lj lk ll ms ln lo lp mt lr ls lt im bi translated">在这篇文章中，我们学习了如何在Excel和Pandas中承担三个额外的高级任务。我们学习了如何在熊猫身上应用色标、色带和SUMIF函数。</p><p id="a2f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你还没有，请通过<a class="ae lu" rel="noopener" target="_blank" href="/learn-how-to-easily-do-3-advanced-excel-tasks-in-python-925a6b7dd081">点击此链接</a>查看这篇文章的第一部分。</p><p id="82a7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读！</p></div></div>    
</body>
</html>