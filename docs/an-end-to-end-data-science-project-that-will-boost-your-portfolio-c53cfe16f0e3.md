# é˜¿å§†æ–¯ç‰¹ä¸¹ Airbnb æ•°æ®é›†:ä¸€ä¸ªç«¯åˆ°ç«¯çš„é¡¹ç›®

> åŸæ–‡ï¼š<https://towardsdatascience.com/an-end-to-end-data-science-project-that-will-boost-your-portfolio-c53cfe16f0e3?source=collection_archive---------9----------------------->

> ä¸€ä¸ªæ•°æ®ç§‘å­¦ç»„åˆé¡¹ç›®å°±åƒä¸ºä½ çš„é©¾é©¶æ‰§ç…§å®è·µè€ƒè¯•è€Œå­¦ä¹ ï¼Œä½ ä¸æ˜¯åœ¨å­¦ä¹ é©¾é©¶ï¼Œè€Œæ˜¯åœ¨å­¦ä¹ å¦‚ä½•é€šè¿‡è€ƒè¯•ã€‚

å‡†å¤‡ä½œå“é›†æ—¶ï¼Œé‡è¦çš„æ˜¯è¦æœ‰æ¶µç›–ä¸åŒé¢†åŸŸã€æŠ€æœ¯å¹¶èƒ½è®²è¿°ä¸€ä¸ªæ•…äº‹çš„é¡¹ç›®ã€‚

![](img/6f3182fb952a0c0d6944eb84d82494c6.png)

Chait Goli åœ¨ pexels.com æ‹æ‘„çš„ç…§ç‰‡

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘çš„ä¸»è¦ç›®æ ‡æ˜¯å±•ç¤ºæˆ‘å°†å¦‚ä½•åšä¸€ä¸ªæ•°æ®ç§‘å­¦ç»„åˆé¡¹ç›®ï¼Œè¯¥é¡¹ç›®æ¶µç›–å¯è§†åŒ–ã€æ•°æ®é¢„å¤„ç†ã€å»ºæ¨¡å’Œæœ€ç»ˆè€ƒè™‘ä»¥åŠç”Ÿäº§å»ºè®®ã€‚

ç»™å®šä¸€ç³»åˆ—é¢„æµ‹å› ç´ ï¼Œæˆ‘ä½¿ç”¨[é˜¿å§†æ–¯ç‰¹ä¸¹ Airbnb æ•°æ®é›†](https://www.kaggle.com/adityadeshpande23/amsterdam-airbnb)é¢„æµ‹ä¸€å¥—å…¬å¯“çš„ä»·æ ¼ã€‚

# ç®€ä»‹:

æ•°æ®é›†ä¸€æ—¦å¯¼å…¥ Pythonï¼Œå°±ä¼šä½¿ç”¨`[pandas_profiling](https://github.com/pandas-profiling/pandas-profiling)`è¿›è¡Œåˆ†æï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå®ƒæ‰©å±•äº† pandas ä¸­çš„`df.info()`åŠŸèƒ½ã€‚

![](img/ed69b9bb4146ce7ae1165c00bccd962e.png)

æŠ¥å‘Šçš„ç¬¬ä¸€éƒ¨åˆ†

å¦‚æŠ¥å‘Šä¸­æ‰€è¿°ï¼Œæ•°æ®é›†åŒ…å« 14 ä¸ªå˜é‡ï¼Œ10 ä¸ªæ˜¯æ•°å­—å˜é‡ï¼Œ2 ä¸ªæ˜¯åˆ†ç±»å˜é‡(å»ºæ¨¡æ—¶ï¼Œæˆ‘ä»¬*å¯èƒ½*éœ€è¦ä¸ºè¿™äº›å˜é‡è·å–è™šæ‹Ÿå˜é‡)ã€‚

æ­¤å¤–ï¼Œæ ¹æ®æŠ¥å‘Šå˜é‡`host_listings_count`å’Œ`calculated_host_listings_count`ä¸ 0.94 çš„çš®å°”é€Šåˆ†æ•°é«˜åº¦ç›¸å…³ï¼Œå› æ­¤æˆ‘ä»¬å°†æ”¾å¼ƒå‰è€…ä»¥é¿å…[å¤šé‡å…±çº¿æ€§](https://en.wikipedia.org/wiki/Multicollinearity)é—®é¢˜ã€‚

![](img/c5767a9708ee5a9da7a32f406a855a8e.png)

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„ç›®æ ‡å˜é‡`price`ä¸æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æœ€é•¿çš„ä¸€ä¸ªï¼Œä»¥ä¾¿äº†è§£æ˜¯å¦æœ‰ä»»ä½•æ ¼å¼éœ€è¦åœ¨è½¬æ¢å‰åˆ é™¤:

```
max(df[â€˜priceâ€™].values, key = len)>>> '$1,305.00'
```

é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„ç›®æ ‡å˜é‡æœ‰ 2 ä¸ªä¸åŒçš„å­—ç¬¦éœ€è¦å»æ‰ï¼Œå³ç¬¦å·`$`å’Œè¯†åˆ«åƒä½çš„é€—å·ã€‚è®©æˆ‘ä»¬ç”¨`df.apply()`æ¥æ‘†è„±å®ƒä»¬ã€‚

```
df[â€˜priceâ€™] = df[â€˜priceâ€™].apply(lambda x: x.replace(â€˜$â€™, â€˜â€™))
df[â€˜priceâ€™] = df[â€˜priceâ€™].apply(lambda x: x.replace(â€˜,â€™, â€˜â€™))df[â€˜priceâ€™] = pd.to_numeric(df[â€˜priceâ€™])
```

# æ•°æ®å¯è§†åŒ–:

æ•°æ®é›†æœ‰ä¸¤åˆ—ï¼ŒåŒ…å«å…¬å¯“æ‰€åœ¨ä½ç½®çš„åæ ‡ä¿¡æ¯ï¼Œæ­¤å¤–è¿˜æœ‰æˆ‘ä»¬çš„ç›®æ ‡å˜é‡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªçƒ­å›¾ï¼Œä»¥æ›´å¥½åœ°äº†è§£å…¬å¯“çš„ä½ç½®ä»¥åŠä»·æ ¼å¦‚ä½•å—åˆ°ä½ç½®çš„å½±å“

ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨`[gmaps](https://pypi.org/project/gmaps/)`ï¼Œä¸€ä¸ªä½¿ç”¨è°·æ­Œåœ°å›¾åˆ›å»ºäº¤äº’å¼åœ°å›¾çš„ python åŒ…ã€‚

![](img/4d4f410e1a5768b9f05093407c14b569.png)

ä½¿ç”¨ GMaps çš„çƒ­å›¾ç¤ºä¾‹

ä½ å¯ä»¥ä½¿ç”¨å…è´¹ç‰ˆæœ¬ï¼Œæ²¡æœ‰ API å¯†é’¥ï¼Œä½†æ˜¯ï¼Œä½ ä¼šå¾—åˆ°å¸¦æœ‰éš¾çœ‹çš„â€œä»…ä¾›å¼€å‘â€æ°´å°çš„åœ°å›¾ï¼Œå¦‚æœä½ æƒ³æ¶ˆé™¤è¿™äº›æ°´å°ï¼Œä½ å¯ä»¥æ³¨å†Œ(é€šè¿‡æ·»åŠ ä¿¡ç”¨å¡)åˆ°è°·æ­Œäº‘å¹³å°ï¼Œå¹¶ç”³è¯·å…è´¹ç§¯åˆ†ã€‚ç‚¹å‡»æ­¤å¤„äº†è§£æ›´å¤šä¿¡æ¯ã€‚

> è¯·å°å¿ƒä½¿ç”¨ API é”®ï¼Œå°¤å…¶æ˜¯å¦‚æœä½ æƒ³åœ¨çº¿å…±äº«ä½ çš„é¡¹ç›®ã€‚(åœ¨æŠŠç¬”è®°æœ¬æ¨ç»™ GitHub ä¹‹å‰ï¼Œæˆ‘ç¦ç”¨äº†æˆ‘çš„é”®ğŸ™ƒ)

æ‚¨å¯ä»¥åœ¨ Jupyter ç¬”è®°æœ¬ä¸Šå®‰è£…`gmaps`,é¦–å…ˆé€šè¿‡ç»ˆç«¯`ipywidgets`æ‰©å±•å¯ç”¨:

`$ jupyter nbextension enable â€” py â€” sys-prefix widgetsnbextension`

ç„¶å:

`$ pip install gmaps`

æœ€åï¼Œç”¨ä»¥ä¸‹ä»£ç åŠ è½½æ‰©å±•:

`$ jupyter nbextension enable â€” py â€” sys-prefix gmaps`

ç”¨`gmaps`åˆ›å»ºçƒ­å›¾å¾ˆç®€å•ï¼Œæˆ‘ä»¬æŒ‡å®šä¸€ä¸ª`Map`å¯¹è±¡ï¼Œç„¶åä¼ é€’å¸¦æœ‰åæ ‡å’Œæƒé‡çš„æ•°æ®å¸§ã€‚

```
fig = gmaps.Map(layout={â€˜widthâ€™: â€˜1000pxâ€™, â€˜heightâ€™: â€˜500pxâ€™, â€˜paddingâ€™: â€˜10pxâ€™})fig.add_layer(gmaps.heatmap_layer(df[[â€˜latitudeâ€™, â€˜longitudeâ€™]],
 weights=df[â€˜priceâ€™]))fig
```

![](img/6933f9f860157065536f2d49e238740d.png)

åè¯ï¼ˆnoun çš„ç¼©å†™ï¼‰å¦‚æœä½ å®‰è£…äº† gmapsï¼Œå¹¶åšäº†æ‰€æœ‰æ­£ç¡®çš„äº‹æƒ…ï¼Œä½†åœ°å›¾æ²¡æœ‰æ˜¾ç¤ºï¼Œåªéœ€é‡æ–°å¯åŠ¨ jupyter ç¬”è®°æœ¬ï¼Œå®ƒå°†(å¾ˆå¯èƒ½)å·¥ä½œï¼

åœ°å›¾æ˜¾ç¤ºï¼Œå¸‚ä¸­å¿ƒçš„ä½ç½®æ›´è´µï¼Œè€ŒéƒŠåŒºæ›´ä¾¿å®œ(è¿™ç§æ¨¡å¼å¯èƒ½ä¸ä»…ä»…å­˜åœ¨äºé˜¿å§†æ–¯ç‰¹ä¸¹)ã€‚å¦å¤–ï¼Œå¸‚ä¸­å¿ƒä¼¼ä¹ä¹Ÿæœ‰è‡ªå·±çš„æ ¼å±€ã€‚

ä¸ºäº†æ•æ‰ä¸€äº›åœ°ç†æ¨¡å¼ï¼Œæˆ‘ä»¬éœ€è¦åº”ç”¨ä¸€äº›ç‰¹å¾å·¥ç¨‹ï¼Œä¸€ä¸ªå¾ˆå¥½çš„æ–¹æ³•æ˜¯æ‰¾åˆ°ä¸€ä¸ªå…´è¶£ç‚¹(POI)åˆ—è¡¨ï¼Œå¹¶è®¡ç®—æ¯ä¸ªè§‚å¯Ÿå€¼å’Œ POI ä¹‹é—´çš„è·ç¦»ã€‚

> å¦‚æœæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªç‰¹å®šçš„åœ°ç‚¹ç¦»æˆ‘ä»¬è®¤ä¸ºå¾ˆè´µçš„åœ°æ–¹å¾ˆè¿‘ï¼Œå¾ˆå¯èƒ½æ•´ä¸ªå‘¨è¾¹åœ°åŒºéƒ½ä¼šå¾ˆè´µã€‚

ä¸ºäº†è®¡ç®—ä»¥åƒç±³ä¸ºå•ä½çš„è·ç¦»ï¼Œæˆ‘ä½¿ç”¨äº†ä¸€ä¸ªå‡½æ•°æ¥æ£€ç´¢[å“ˆå¼—çº¿è·ç¦»](https://en.wikipedia.org/wiki/Haversine_formula)ï¼Œä¹Ÿå°±æ˜¯çƒä½“ä¸Šä¸¤ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚

è¿™ç§åº¦é‡æœ‰å…¶åˆ©å¼Š:å®ƒæä¾›äº†ä¸€ç§è®¡ç®—ä¸¤ç‚¹ä¹‹é—´è·ç¦»çš„ç®€å•æ–¹æ³•ï¼Œä½†å®ƒæ²¡æœ‰è€ƒè™‘å»ºç­‘ç‰©ã€æ¹–æ³Šã€æ²³æµã€è¾¹ç•Œç­‰éšœç¢ã€‚

ä¸ºäº†å¾—åˆ°ä¸€ä¸ªå…´è¶£ç‚¹çš„åˆ—è¡¨ï¼Œæˆ‘åœ¨è°·æ­Œä¸Šæœç´¢ï¼Œæˆ‘æœç´¢äº†æ¯ä¸ªå…´è¶£ç‚¹çš„åœ°ç†åæ ‡ã€‚

ç»“æœå¦‚ä¸‹:

![](img/aeda2bafceb9a7a1a9a59d7bac44f716.png)

ç°åœ¨å¯ä»¥å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—ä¸€ä¸ªæˆ¿å±‹åˆ°æ¯ä¸ª POI çš„è·ç¦»:

```
from math import radians, cos, sin, asin, sqrtdef haversine(lon1, lat1, lon2, lat2):
 â€œâ€â€
 Calculate the great circle distance between two points 
 on the earth (specified in decimal degrees)
 â€œâ€â€
 # convert decimal degrees to radians 
 lon1, lat1, lon2, lat2 = map(radians, [lon1, lat1, lon2, lat2])
 # haversine formula 
 dlon = lon2 â€” lon1 
 dlat = lat2 â€” lat1 
 a = sin(dlat / 2) ** 2 + cos(lat1) * cos(lat2) * sin(dlon / 2)**2
 c = 2 * asin(sqrt(a)) 
 km = 6367 * c
 return km
```

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥è¿­ä»£æ•°æ®é›†çš„æ¯ä¸€è¡Œï¼Œå¯¹äºæ¯ä¸€è¡Œï¼Œæˆ‘ä»¬è¿­ä»£æˆ‘ä»¬çš„ POI æ•°æ®å¸§ï¼Œå¹¶è®¡ç®—æ¯ä¸ª POI çš„è·ç¦»(æˆ‘è¯´äº†å¤ªå¤šæ¬¡â€œæ¯ä¸ªâ€æˆ–â€œPOIâ€äº†å—ï¼Ÿ)

ç°åœ¨è®©æˆ‘ä»¬ç”¨ poi å†æ¬¡ç»˜åˆ¶æˆ‘ä»¬çš„åœ°å›¾ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿­ä»£`poi`æ•°æ®å¸§çš„æ¯ä¸€è¡Œå¹¶ä½¿ç”¨åˆ—è¡¨ç†è§£åˆ›å»ºä¸€ä¸ªå…ƒç»„æ¥åšåˆ°è¿™ä¸€ç‚¹:

```
fig.add_layer(gmaps.symbol_layer([tuple(x) for x in poi.to_numpy()]
 , fill_color=â€™greenâ€™, stroke_color=â€™greenâ€™))
fig
```

![](img/3d2edc7db15d388b24f760add5c4e629.png)

ä»å¯è§†åŒ–ä¸­å¯ä»¥çœ‹å‡ºï¼ŒWillemspark é™„è¿‘çš„å…¬å¯“æ¯”å‘¨å›´åœ°åŒºå°‘å¾—å¤šï¼Œæ­¤å¤–ï¼Œå¤§å¤šæ•° poi éƒ½ä½äºâ€œæ˜‚è´µâ€åŒºåŸŸï¼Œå°¤å…¶æ˜¯ Dam Square åŒºåŸŸå‘¨å›´ã€‚

# å»ºæ¨¡:

ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹å»ºæ¨¡éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†é€šè¿‡å¯¹åˆ†ç±»å˜é‡`room_type`è¿›è¡Œç¼–ç å¹¶å°†å…¶åˆ†ä¸ºè®­ç»ƒå’Œæµ‹è¯•æ¥å‡†å¤‡æ•°æ®é›†

```
df = pd.get_dummies(df)X = df.drop([â€˜priceâ€™], axis=1)
y = df[â€˜priceâ€™]from sklearn.model_selection import train_test_splitX_train, X_test, y_train, y_test = train_test_split(
 X, y, test_size=0.2, random_state=1)
```

æ•°æ®é›†åœ¨è®­ç»ƒå’Œæµ‹è¯•ä¹‹é—´åˆ†æˆ 80â€“20%ã€‚

# åŸºçº¿æ¨¡å‹ğŸ“ï¼š

ä½¿ç”¨çš„ç¬¬ä¸€ä¸ªæ¨¡å‹å°†ç”¨ä½œåŸºçº¿ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåŸºå‡†æ¥è¯„ä¼°å…¶ä»–æ¨¡å‹çš„æ€§èƒ½å¹¶æ¯”è¾ƒç»“æœã€‚

å®ƒåŒ…æ‹¬ä¸€ä¸ªç»å…¸çš„çº¿æ€§å›å½’ï¼Œä½¿ç”¨`r2`å’Œ`MAE`æŒ‡æ ‡ä¸Šçš„`GridSearchCV`ç±»è¿›è¡Œäº¤å‰éªŒè¯è¯„ä¼°ã€‚

è®©æˆ‘ä»¬æ¥é€‚åº”å®ƒ:

```
from sklearn.linear_model import LinearRegressionlin_reg = LinearRegression()lin_reg.fit(X_train, y_train)
y_pred = lin_reg.predict(X_test)
```

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºè™šæ‹Ÿæ•°æ®å¸§æ¥å­˜å‚¨æ¯ä¸ªæ¨¡å‹çš„ç»“æœï¼Œä»è€Œè®¡ç®— r2 å’Œ MAE è¯¯å·®:

```
from sklearn import metricsr2 = metrics.r2_score(y_test, y_pred)
mae = metrics.mean_absolute_error(y_test, y_pred)scores = pd.DataFrame({â€˜Baseline (regression)â€™ : [r2, mae]}, index=[â€˜R2â€™, â€˜MAEâ€™])scores
```

![](img/3444d0c86dcf8776ea39e106039a2f7e.png)

`mae`å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬çš„é¢„æµ‹å¹³å‡ç›¸å·® 40 ç¾å…ƒï¼Œè€Œ R2 å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬çš„æ•°æ®ç›¸å½“ç¨€ç–ã€‚

ä»¥å›¾å½¢æ–¹å¼è¯„ä¼°å›å½’ç»“æœçš„ä¸€ä¸ªæœ‰è¶£çš„å›¾æ˜¯æµ‹è¯•é›†å’Œé¢„æµ‹å€¼ç›¸å¯¹äºæˆ‘ä»¬çš„æµ‹è¯•é›†çš„å·®å¼‚:

![](img/1e9a232f85bb6b83139e4ca3b978bf65.png)

ç†æƒ³æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›çœ‹åˆ°æˆ‘ä»¬çš„ç»“æœè¶Šç¨€ç–è¶Šå¥½ï¼Œä»¥ 45Â°ç©¿è¿‡å›¾

è¿™äº›å€¼è¶Šæ¥è¿‘ 0 è¶Šå¥½ï¼Œå› ä¸º delta `y_test â€” y_pred`åº”è¯¥æ˜¯*ç†æƒ³çš„æ˜¯* 0ã€‚

## æ”¯æŒå‘é‡æœºæ¨¡å‹ğŸ“ˆï¼š

æ ¹æ® sklearn [åœ°å›¾](https://scikit-learn.org/stable/tutorial/machine_learning_map/index.html)é€‰æ‹©äº†ä¸‹ä¸€ä¸ªæ¨¡å‹ï¼Œå®ƒç”±ä¸€ä¸ªæ”¯æŒå‘é‡æœºç»„æˆã€‚ç„¶è€Œï¼Œç”±äºä½¿ç”¨å‚æ•°å¹¶ä¸æ€»æ˜¯å®¹æ˜“ï¼Œè€Œä¸”å¯èƒ½éœ€è¦ç‰¹å®šçš„çŸ¥è¯†`GridSearchCV`å°†ä¼šæœ‰æ‰€å¸®åŠ©:

```
if 'svr_gridsearch_cv.pkl' in os.listdir():

    svr_grid_search = joblib.load('svr_gridsearch_cv.pkl')

else:

    from sklearn.svm import SVRsvr = SVR()param_grid = [
      {'C': [1, 10, 100, 1000], 'kernel': ['linear']},
      {'C': [1, 10, 100, 1000], 'gamma': [0.01, 0.001, 0.0001], 'kernel': ['rbf']}]svr_grid_search = GridSearchCV(svr, param_grid=param_grid, 
                                   n_jobs=-1, 
                                   scoring=['r2', 'neg_mean_squared_error'],
                                  refit='neg_mean_squared_error', verbose=100)svr_grid_search.fit(X_train, y_train)joblib.dump(svr_grid_search.best_estimator_, 'svr_gridsearch_cv.pkl')
```

è¯·æ³¨æ„ï¼Œè¿™é¡¹ä»»åŠ¡å¯èƒ½éœ€è¦ 40 å¤šåˆ†é’Ÿï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨æ‹Ÿåˆä¹‹å‰ï¼Œæˆ‘ä¼šæ£€æŸ¥æ¨¡å‹æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œæˆ‘ä¼šåŠ è½½å®ƒã€‚

ç„¶åï¼Œæˆ‘ä»¬å°†å†æ¬¡æ ¹æ®æ¥è‡ª`GridSearchCV`çš„æœ€ä½³å‚æ•°æ¥é¢„æµ‹å’Œè®¡ç®—æˆ‘ä»¬çš„æŒ‡æ ‡

![](img/c4fb759d2c0edc6e4e6492e0b1683fdb.png)

ä½¿ç”¨æ”¯æŒå‘é‡æœºï¼Œæˆ‘ä»¬å·²ç»ä»æˆ‘ä»¬çš„åŸºæœ¬æ¨¡å‹è¿›è¡Œäº†æ”¹è¿›ã€‚

ä¸æˆ‘ä»¬çš„åŸºå‡†æ¨¡å‹ç›¸æ¯”ï¼Œ`mae`å¹³å‡é™ä½äº†è¿‘ 4 ç¾å…ƒã€‚

è®©æˆ‘ä»¬ä¹Ÿä¸ºè¿™ä¸ªæ¨¡å‹ç»˜åˆ¶é¢„æµ‹å€¼ä¸è¯¯å·®å¢é‡çš„å…³ç³»å›¾:

![](img/e2c22138964cf84d495b927606ddd472.png)

ä¸å‰ä¸€ä¸ªç›¸æ¯”ï¼Œé¢„æµ‹ä¸é‚£ä¹ˆç¨€ç–ï¼Œè¿™è§£é‡Šäº† R2 çš„å°å¹…å¢é•¿ã€‚

## æ¢¯åº¦æ¨è¿›æ ‘æ¨¡å‹ğŸŒ²ï¼š

æˆ‘ä»¬å°†æµ‹è¯•çš„ç¬¬ä¸‰ä¸ªæ¨¡å‹æ˜¯åŸºäºéšæœºæ¢¯åº¦ä¸‹é™çš„ï¼Œæˆ‘å°†ä½¿ç”¨ [**LightGBM**](https://lightgbm.readthedocs.io/en/latest/) ï¼Œè¿™æ˜¯å¾®è½¯çš„ä¸€ä¸ªåº“ï¼Œåœ¨è¡Œä¸šä¸­å¹¿æ³›ä½¿ç”¨ï¼Œæ˜¯èµ¢å¾— Kaggle ç«èµ›æœ€å¸¸ç”¨çš„[åº“ä¹‹ä¸€ã€‚](https://www.kaggle.com/milesh1/kaggle-s-most-popular-python-and-r-packages)

```
if 'gbm_gridsearch_cv.pkl' in os.listdir():

    gbm_grid_search = joblib.load('gbm_gridsearch_cv.pkl')

else:

    from lightgbm import LGBMRegressorgbm = LGBMRegressor()param_grid = {
    'learning_rate': [0.01, 0.1, 1],
    'n_estimators': [50, 100, 150],
    'boosting_type': ['gbdt', 'dart'],
    'num_leaves': [15, 31, 50]}gbm_grid_search = GridSearchCV(gbm, param_grid=param_grid, 
                                   n_jobs=-1, 
                                   scoring=['r2', 'neg_mean_squared_error'],
                                  refit='neg_mean_squared_error', verbose=100)gbm_grid_search.fit(X_train, y_train)joblib.dump(gbm_grid_search.best_estimator_, 'gbm_gridsearch_cv.pkl')
```

æ¨¡å‹è®­ç»ƒç›¸å½“å¿«ï¼Œç»“æœä¸€ç‚¹ä¹Ÿä¸å·®:

![](img/29f340e22c02b82bd6847c04eb5a9e8e.png)

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œè¡¨ç°æœ€å¥½çš„æ¨¡å‹æ˜¯ GBMï¼Œå®ƒå°† R2 æé«˜äº†çº¦ 6%,è€Œ`mae`ç•¥å·®ã€‚

![](img/e9d92cbef243323b916d31e766c941d8.png)

å¾ˆå¤šå·®å€¼ä¼¼ä¹æ˜¯è´Ÿæ•°ï¼Œè¿™æ„å‘³ç€é¢„æµ‹å€¼ç»å¸¸é«˜ä¼°çœŸå®å€¼ã€‚

# ç¥ç»ç½‘ç»œğŸ§ :

åœ¨è€ƒè™‘å¦‚ä½•è¿›ä¸€æ­¥æ”¹è¿›æˆ‘ä»¬çš„å›å½’å˜é‡æ—¶ï¼Œæˆ‘é¦–å…ˆæƒ³åˆ°çš„æ˜¾ç„¶æ˜¯ç¥ç»ç½‘ç»œï¼æ‰€ä»¥æˆ‘å†³å®šå®ç°ä¸€ä¸ªç®€å•çš„æ–¹æ³•:

```
def build_model():
 model = keras.Sequential([
 tf.keras.layers.Dense(64, activation=â€™reluâ€™, input_shape=(25,)), 
 tf.keras.layers.Dropout(0.2), 
 tf.keras.layers.Dense(128, activation=â€™reluâ€™),
 tf.keras.layers.Dropout(0.2), 
 tf.keras.layers.Dense(1)
 ])optimizer = tf.keras.optimizers.RMSprop(0.001)model.compile(loss=â€™mean_squared_errorâ€™,
 optimizer=optimizer,
 metrics=[â€˜maeâ€™, r2_keras])
 return model
```

ç„¶è€Œï¼Œåœ¨ç©äº†ä¸€ä¼šå„¿å¹¶è¿è¡Œäº† 100 ä¸ªçºªå…ƒåï¼Œç»“æœå¹¶ä¸ç‰¹åˆ«ä»¤äººæƒŠè®¶:

![](img/a648df37aadac55381a985a3350a25bf.png)

ç»“æœåŸºæœ¬ä¸Šæ˜¯ GBM å’Œ SVR ä¹‹é—´çš„å¹³å‡å€¼ï¼Œå¹¶ä¸”ç»˜åˆ¶è¯¯å·®ç»™å‡ºäº†ä¸ä¹‹å‰éå¸¸ç›¸ä¼¼çš„å›¾ã€‚

![](img/9c650729d5e12e0759f7eed91399401c.png)

# **é‚£ä¹ˆå“ªä¸ªæ‰æ˜¯æœ€å¥½çš„æ¨¡å¼å‘¢ï¼Ÿ**

å°½ç®¡å·²ç»æœ‰äº†æ¨¡å‹æ€§èƒ½çš„åº¦é‡æ ‡å‡†ï¼Œä½†æ˜¯ä¸ºäº†ç»™å‡ºå“ªä¸ªæ¨¡å‹è¢«è®¤ä¸ºæ˜¯æœ€ä½³çš„æœ€ç»ˆè¯„ä¼°ï¼Œæœ‰å¿…è¦æ·»åŠ å…¶ä»–è¯„ä¼°åº¦é‡æ ‡å‡†ï¼Œä¾‹å¦‚å®ç°æ¨¡å‹æ‰€éœ€çš„èµ„æºå’Œè®­ç»ƒæ¨¡å‹æ‰€éœ€çš„æ—¶é—´ã€‚

è€ƒè™‘ç¬¬äºŒä¸ªæ¨¡å‹ SVR:å®ƒè¡¨ç°å¼‚å¸¸ï¼Œå®ç°äº†æœ€å¥½çš„ MAEï¼Œä½†æ˜¯å®ç°ç½‘æ ¼æœç´¢çš„è®­ç»ƒæ—¶é—´èŠ±è´¹äº† 40 å¤šåˆ†é’Ÿï¼Œè¿™æ„å‘³ç€æ¯æ¬¡æƒ³è¦æ£€æŸ¥æˆ–æ›´æ”¹æŸä¸ªä¸œè¥¿éƒ½è‡³å°‘è¦èŠ±è´¹ 40 åˆ†é’Ÿã€‚

ç¬¬ä¸‰ä¸ªæ¨¡å‹(æ¢¯åº¦æ¨è¿›æ ‘)ï¼ŒèŠ±äº†å‡ ç§’é’Ÿæ¥æ‹Ÿåˆï¼Œç»“æœç›¸å½“å¥½ï¼Œå®é™…ä¸Šè¾¾åˆ°äº†æ•´ä½“æœ€å¥½çš„ç»“æœã€‚

è€ƒè™‘åˆ°æœ€åä¸€ä¸ªæ¨¡å‹ï¼Œç¥ç»ç½‘ç»œï¼Œå®ƒä¹Ÿæ²¡æœ‰èŠ±å¤ªå¤šæ—¶é—´æ¥è®­ç»ƒï¼Œå‡ åˆ†é’Ÿï¼Œä½†æ˜¯ï¼Œç»“æœå¹¶æ²¡æœ‰ä»æ ¹æœ¬ä¸Šä¼˜äºä»¥å‰çš„æ¨¡å‹ï¼Œå®é™…ä¸Šï¼Œå®ƒçš„è¡¨ç°æˆ–å¤šæˆ–å°‘æ˜¯ç›¸åŒçš„ï¼Œå¯èƒ½æ˜¯å› ä¸ºæˆ‘æ²¡æœ‰é€‰æ‹©æ­£ç¡®çš„è¶…å‚æ•°ï¼Œå¯èƒ½æ˜¯å› ä¸ºæ•°æ®é‡ï¼Œå¯èƒ½æ˜¯å› ä¸ºå…¶ä»–å¤šç§åŸå› ï¼Œä½†æ˜¯ï¼Œå®ƒå¹¶æ²¡æœ‰ä»æ ¹æœ¬ä¸Šä¼˜äºä»¥å‰çš„æ¨¡å‹ã€‚

æ­¤å¤–ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸å¤ªå®¹æ˜“è§£é‡Šçš„æ¨¡å‹ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¾ˆéš¾è§£é‡Šé¢„æµ‹æ˜¯å¦‚ä½•å†³å®šçš„ï¼Œè€Œä¾‹å¦‚ï¼Œå¯¹äºçº¿æ€§å›å½’ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¥æœ‰æ‰€æœ‰æ•°æ®ï¼Œå¦‚æˆªè·å’Œç³»æ•°:

```
coefficients = pd.concat([pd.DataFrame(X.columns, columns=['variable']), 
pd.DataFrame(np.transpose(lin_reg.coef_), columns ['coefficients'])], axis = 1)coefficients
```

![](img/e024a8b25518564a9b04b61ab09575df.png)

æˆ‘ä»¬åŸºçº¿æ¨¡å‹çš„ç³»æ•°

# æ€»ç»“ä¸€ä¸‹:

è€ƒè™‘åˆ°å‰é¢æåˆ°çš„æ³¨æ„äº‹é¡¹ï¼Œå¹¶æŒ‡å‡ºå¦¥åé€šå¸¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è¿‘ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼Œæ ¹æ®æˆ‘ä»¬çš„æŒ‡æ ‡ï¼Œæœ€ä½³æ¨¡å‹æ˜¯æ¢¯åº¦æ¨è¿›æ ‘(LightGBM)ï¼Œå®ƒåœ¨ä¸€çœ¨çœ¼çš„æ—¶é—´å†…è®­ç»ƒå®Œæ¯•ï¼Œç»“æœæ˜¯å…¶ä»–å€™é€‰æ¨¡å‹ä¸­æœ€å¥½çš„ã€‚

æ­¤å¤–ï¼Œé€‰æ‹©æœºå™¨å­¦ä¹ æ¨¡å‹æä¾›äº†ä¸€ä¸ªä¼˜åŠ¿:å†³ç­–æ ‘æ˜¯ä¸€ä¸ªå¯è§£é‡Šçš„æ¨¡å‹ï¼Œå¯ä»¥åˆ†è§£å®ƒï¼Œå¹¶æ‰¾åˆ°å®ƒä¸ºä»€ä¹ˆä»¥åŠå¦‚ä½•è®¡ç®—ç‰¹å®šçš„ç»“æœï¼Œè€Œä¸æ˜¯å¦ä¸€ä¸ªï¼Œåœ¨æ ‘å›å½’å™¨ä¸Šè°ƒç”¨ä»¥ä¸‹æ–¹æ³•ï¼Œå¯ä»¥æŸ¥çœ‹æ ‘çš„å›¾è¡¨:

```
import lightgbmlightgbm.create_tree_digraph(gbm_grid_search.best_estimator_)
```

![](img/36901cc0c5cc021da977dcd617662126.png)

XAI æˆ–å¯è§£é‡Šçš„äººå·¥æ™ºèƒ½æ˜¯ç°ä»£æ•°æ®ç§‘å­¦çš„ä¸€ä¸ªéå¸¸é‡è¦çš„æ–¹é¢ï¼Œå®ƒä¸“æ³¨äºå¦‚ä½•å®ç°ç‰¹å®šçš„é¢„æµ‹ï¼Œè€Œä¸æ˜¯å°†æ¨¡å‹è§†ä¸ºé»‘ç›’ã€‚

å¼•ç”¨æ³¢æ©å¤§å­¦çš„ä¸€ç¯‡è®ºæ–‡:

> è·å¾—ç§‘å­¦æˆæœçš„å…ˆå†³æ¡ä»¶æ˜¯é¢†åŸŸçŸ¥è¯†ï¼Œè¿™æ˜¯è·å¾—å¯è§£é‡Šæ€§ä»¥åŠå¢å¼ºç§‘å­¦ä¸€è‡´æ€§æ‰€å¿…éœ€çš„ã€‚

[*] Ribana Roscherï¼ŒBastian Bohnï¼ŒMarco F. Duarte å’Œ Jochen Garckeï¼Œ[ç§‘å­¦è§è§£å’Œå‘ç°çš„å¯è§£é‡Šæœºå™¨å­¦ä¹ ](https://arxiv.org/pdf/1905.08883.pdf) (2019)ã€‚

```
**I have a newsletter ğŸ“©.**Every week Iâ€™ll send you a brief findings of articles, links, tutorials, and cool things that caught my attention. If tis sounds cool to you subscribe.*That means* ***a lot*** *for me.*
```

 [## ç±³å°”æ–¯å½¢å¼

### ç¼–è¾‘æè¿°

æ— æƒ…-åˆ›é€ è€…-2481.ck.page](https://relentless-creator-2481.ck.page/68d9def351)