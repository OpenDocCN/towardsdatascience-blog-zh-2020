<html>
<head>
<title>Monte Carlo Simulations in Python: Analysing Web Page Views</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中的蒙特卡罗模拟:分析网页浏览</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/monte-carlo-simulations-in-python-analysing-web-page-views-b6dbec2ba683?source=collection_archive---------32-----------------------#2020-07-17">https://towardsdatascience.com/monte-carlo-simulations-in-python-analysing-web-page-views-b6dbec2ba683?source=collection_archive---------32-----------------------#2020-07-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c3bd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">蒙特卡罗模拟使用随机抽样来生成概率分布，模拟感兴趣变量的潜在结果。</h2></div><p id="e846" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这种方法在金融等领域被广泛使用，以模拟各种风险情景。</p><p id="6034" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，该方法在时间序列分析的其他方面也有重要的应用。在这个特定的例子中，让我们看看如何使用蒙特卡罗模拟来模拟网页浏览。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/be76cbe9bff5d5a9cb569aedb8067eb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*y0nvlUmxvQdCeJSB9aq5wQ.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">来源:维基媒体工具锻造</p></figure><p id="f001" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以上时间序列来源于<a class="ae lq" href="https://pageviews.toolforge.org/?project=en.wikipedia.org&amp;platform=all-access&amp;agent=user&amp;redirects=0&amp;start=2019-01-01&amp;end=2020-07-03&amp;pages=Health_care" rel="noopener ugc nofollow" target="_blank"> Wikimedia Toolforge </a>，是 2019 年 1 月—2020 年 7 月维基百科上“医疗保健”一词的网页浏览量时间序列。所有数据都是每日格式。</p><p id="077d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以看到，时间序列显示了每天的显著波动性，并显示了数据中一些奇怪“峰值”的典型轮廓，或者是搜索该术语的频率特别高的日子。</p><p id="226d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">试图对这样的时间序列进行直接预测通常是徒劳的。这是因为不可能从统计上预测搜索词何时会出现峰值，因为这会受到与过去数据无关的影响，例如，与健康相关的重大新闻事件会导致该词的搜索出现峰值。</p><p id="edf4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，人们可能特别感兴趣的是创建一个模拟来分析网页统计的许多潜在场景，并估计在异常场景下该搜索词<strong class="kk iu">的页面浏览量<strong class="kk iu">多高</strong>或<strong class="kk iu">多低</strong>。</strong></p><h1 id="1df8" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">概率分布</h1><p id="328b" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">当运行蒙特卡罗模拟时，注意正在使用的分布类型是很重要的。</p><p id="ab86" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">鉴于页面浏览量不可能是负数，我们假设分布是正偏的。</p><p id="334a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是数据的直方图:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/41bf8c0fd36ba6e7782176ef759fec74.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*wNKKsAjhbbT2QHGkclG1gw.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">来源:Jupyter 笔记本</p></figure><p id="c173" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以看到，分布显示出正的<a class="ae lq" href="https://pythontic.com/pandas/series-computations/skewness" rel="noopener ugc nofollow" target="_blank">偏斜</a>，其中一些异常值使分布尾部向右偏斜。</p><pre class="lf lg lh li gt mp mq mr ms aw mt bi"><span id="dbf4" class="mu ls it mq b gy mv mw l mx my">&gt;&gt;&gt; series = value;<br/>&gt;&gt;&gt; skewness = series.skew();<br/>&gt;&gt;&gt; print("Skewness:");<br/>&gt;&gt;&gt; print(round(skewness,2));</span><span id="cc41" class="mu ls it mq b gy mz mw l mx my">Skewness:<br/>0.17</span></pre><p id="4e4f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该分布的偏斜计算为<strong class="kk iu"> 0.17 </strong>。</p><p id="1eab" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">QQ 图表明，除了异常值之外，大多数值的分布呈正态分布。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi na"><img src="../Images/6175453ed11af650cb5a90c807e43367.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*XQNKQnBoXdBvM8fIlbKYCA.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">来源:Jupyter 笔记本</p></figure><p id="dd63" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，更有可能的是，由于正偏斜，该数据表示对数正态分布-将数据转换为对数格式将导致分布的正态性。</p><pre class="lf lg lh li gt mp mq mr ms aw mt bi"><span id="07c3" class="mu ls it mq b gy mv mw l mx my">&gt;&gt;&gt; mu=np.mean(logvalue)<br/>&gt;&gt;&gt; sigma=np.std(logvalue)<br/>&gt;&gt;&gt; x = mu + sigma * np.random.lognormal(mu, sigma, 10000)<br/>&gt;&gt;&gt; num_bins = 50</span></pre><p id="d731" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是对数数据的分布，更能代表正态分布。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/65211ffa771043929af9f990067c7d8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*BzzyHmh4Mik_wqdgpyyX2w.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">来源:Jupyter 笔记本</p></figure><p id="b46d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，该分布的偏斜现在为<strong class="kk iu"> -0.41 </strong>。</p><pre class="lf lg lh li gt mp mq mr ms aw mt bi"><span id="72ba" class="mu ls it mq b gy mv mw l mx my">&gt;&gt;&gt; logvalue=pd.Series(logvalue)<br/>&gt;&gt;&gt; logseries = logvalue;<br/>&gt;&gt;&gt; skewness = logseries.skew();<br/>&gt;&gt;&gt; print("Skewness:");<br/>&gt;&gt;&gt; print(round(skewness,2));</span><span id="ca6d" class="mu ls it mq b gy mz mw l mx my">Skewness:<br/>-0.41</span></pre><p id="78b1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这表示轻微负偏，但 QQ 图仍然表示正常。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/48aba2a26f99e4d242a492185257253e.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*5VYLTNsOFDhqE4GSyMT0Hg.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">来源:Jupyter 笔记本</p></figure><h1 id="19e3" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">蒙特 卡罗模拟</h1><p id="81b7" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">既然数据已经被适当地转换，蒙特卡罗模拟被生成来分析页面视图统计的潜在结果范围。根据所选择的分布，页面浏览量以对数格式表示。</p><p id="7483" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，计算时间序列的平均值和波动性(用标准差衡量)。</p><pre class="lf lg lh li gt mp mq mr ms aw mt bi"><span id="89f9" class="mu ls it mq b gy mv mw l mx my">&gt;&gt;&gt; mu=np.mean(logvalue)<br/>&gt;&gt;&gt; sigma=np.std(logvalue)<br/>&gt;&gt;&gt; x = mu + sigma * np.random.lognormal(mu, sigma, 10000)<br/>&gt;&gt;&gt; num_bins = 50</span></pre><p id="7cbe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，相关数组由<strong class="kk iu"> x </strong>定义，其中 mu 和 sigma 相加，然后乘以 10，000 个随机数，这些随机数按照定义的平均值和标准偏差遵循对数正态分布。</p><pre class="lf lg lh li gt mp mq mr ms aw mt bi"><span id="79ee" class="mu ls it mq b gy mv mw l mx my">array([5.21777304, 5.58552424, 5.39748092, ..., 5.27737933, 5.42742056, 5.52693816])</span></pre><p id="b0fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让我们绘制直方图。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/797baa06800582741c4b37206501d615.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*z6XImE64WeppJ5Zn-RpeXA.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">来源:Jupyter 笔记本</p></figure><p id="d007" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样，这些值以对数格式表示。我们看到这个形状代表了正态分布。如上所述，蒙特卡罗模拟的思想不是预测网页浏览本身，而是提供对许多不同模拟的网页浏览的估计，以便识别 1)大多数网页浏览的范围和 2)分布中的极值范围。</p><h1 id="e597" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">结论</h1><p id="5eba" class="pw-post-body-paragraph ki kj it kk b kl mj ju kn ko mk jx kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">在本文中，您已经看到:</p><ul class=""><li id="ecbf" class="ne nf it kk b kl km ko kp kr ng kv nh kz ni ld nj nk nl nm bi translated">蒙特卡洛模拟的使用</li><li id="0efe" class="ne nf it kk b kl nn ko no kr np kv nq kz nr ld nj nk nl nm bi translated">偏斜在定义分布中的作用</li><li id="8db7" class="ne nf it kk b kl nn ko no kr np kv nq kz nr ld nj nk nl nm bi translated">如何实现模拟来识别获得极值的概率</li></ul><p id="77ff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">非常感谢您的参与，您也可以在 michael-grogan.com<a class="ae lq" href="https://www.michael-grogan.com/" rel="noopener ugc nofollow" target="_blank">的</a>找到我更多的数据科学内容。</p><p id="9031" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ns">免责声明:本文是在“原样”的基础上编写的，没有任何担保。本文旨在提供数据科学概念的概述，不应以任何方式解释为专业建议。</em></p></div></div>    
</body>
</html>