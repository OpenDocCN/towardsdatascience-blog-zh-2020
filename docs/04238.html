<html>
<head>
<title>Creating a Flask App to Classify Consumer Complaints using Natural Language Processing (Multi-class Classification with TFIDF/Word2Vec)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建一个Flask应用程序，使用自然语言处理对消费者投诉进行分类(使用TFIDF/Word2Vec进行多类分类)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/creating-a-flask-app-to-classify-consumer-complaints-using-natural-language-processing-6c8778c9eb48?source=collection_archive---------27-----------------------#2020-04-17">https://towardsdatascience.com/creating-a-flask-app-to-classify-consumer-complaints-using-natural-language-processing-6c8778c9eb48?source=collection_archive---------27-----------------------#2020-04-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c3d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本系列的第1部分中，我将介绍获得产生这些分类的工作模型的工作流程。这篇文章将在第2部分继续，其中涉及到构建这个模型的Flask应用程序。因此，如果你只是对烧瓶部分感兴趣，点击<strong class="jp ir"> <em class="kl">这里(仍在生产)</em> </strong>前往那个职位！</p><p id="2472" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">事不宜迟，让我们直接进入本系列的第1部分。</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="a0fe" class="kv kw iq kr b gy kx ky l kz la">I am dissatisfied with the current outcome of a dispute that was initiated with Discover Card regarding a single transaction that occurred on XXXX/XXXX/2015 in the amount of {$280.00}. I have corresponded with Discover Card at least four times since XXXX/XXXX/2015 ( which I have enclosed as an attachment to this complaint ). I believe that the credit card issuer has violated consumer protection laws by failing to implement the Special Rule for Credit Card Purchase protection despite overwhelming paperwork evidence submitted by me that shows the merchant has conducted business in bad faith less favorable to the consumer. I have sustained a monetary loss as a result of merchants bad faith and intent. I have patiently utilized the internal Discover Card dispute process over the past three months with the credit card issuer always favoring the merchant ; I have repeatedly submitted irrefutable paperwork evidence that has shown that the merchant has conducted business in bad faith. I have tried in good faith to address my complaint with the merchant and Discover Card but believe that I will not receive a favorable outcome.<br/></span><span id="d88a" class="kv kw iq kr b gy lb ky l kz la">I suffered a work-related injury in XXXX and am now permanently XXXX. My income has dropped substantially in the past 5 years and I am now on a low fixed income. On XXXX separate occasions from XXXX to XXXX I had zero income and had to use my Sams Club card to purchase food, thus running up debt out of necessity. I am currently in the process of attempting to pay down my Sams Club ( Synchrony Bank ) card, and stopped using the card some time ago. I have always made at least minimum payments and have never missed a payment. Despite this, my interest rate has been unilaterally raised three times in the past two years, and is now at 23.15 %. I called a Sams Club account rep today to file a complaint over the phone, because I am never going to be able to pay down this card when I am paying almost {$50.00} a month in interest and can only afford to pay the minimum payment + {$4.00} or {$5.00} dollars. They would not work with me, which I expected. In my opinion, Synchrony Bank is taking unfair advantage of recent interest rate hikes to gouge customers, especially those who are financially unable to make substantial monthly payments on their accounts. Therefore I am contacting the CFPB to file a complaint through which I might receive some relief.</span></pre><h1 id="6270" class="lc kw iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">停下来。</h1><p id="34a2" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">你读了上面的文字墙了吗？很可能你没有(因为我也不会)。谁有时间去阅读一整块没有标题、没有摘要和糟糕的格式(粗体、空格等等)的文本呢？)可能与你无关？</p><p id="5395" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你真的读了上面的文字，你会意识到它们实际上是客户投诉。正如盖茨先生曾经提到的:</p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div class="gh gi me"><img src="../Images/19711cb418d997ee9c456f9ab61d24ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*DGA2A0dq504pILm5EuJL3A.jpeg"/></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">如果他这么说，那一定是真的。(图片来源:<a class="ae mm" href="https://me.me/i/your-most-unhappy-customers-are-your-greatest-source-of-learning-21856189" rel="noopener ugc nofollow" target="_blank">图片</a> via <a class="ae mm" href="https://me.me/" rel="noopener ugc nofollow" target="_blank"> me.me </a>)</p></figure><p id="396f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以从顾客的投诉中学到很多东西。最好的品牌总是与他们的消费者联系在一起，并围绕他们做出决定(想想派拉蒙，因为糟糕的评论和随之而来的无数迷因，派拉蒙实际上推迟了索尼克电影的上映日期，并改变了我们最喜欢的蓝色刺猬的设计)。</p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mn"><img src="../Images/00a636977157fe59cc429b5ed5092145.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*idyH05VznE7NxVvVIWMhqA.jpeg"/></div></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">真正可怕的设计(左)，但值得称赞的是你，派拉蒙，重新设计(右)和倾听你的观众(来源:<a class="ae mm" href="https://www.yahoo.com/author/tom-butler" rel="noopener ugc nofollow" target="_blank">汤姆·巴特勒</a>通过<a class="ae mm" href="https://sg.news.yahoo.com/sonic-hedgehog-trailer-sega-redesign-133549564.html" rel="noopener ugc nofollow" target="_blank"> sg.news </a>)</p></figure><p id="587b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">理解你的客户固然重要，但这并不能改变这样一个事实:愤怒的客户发来的一大堆文字不仅让人难以通读，还会让人失去动力。很多时候，这不仅仅是一个投诉。</p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi ms"><img src="../Images/abbc5eca240f81587d317a0297542ec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SOsf-0QOfkm4GCS5_a62Pw.png"/></div></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">好的，是的，如果你仔细看，他们都是同样的抱怨。但是你明白我的意思。</p></figure><p id="2b4d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通常，在银行(或任何大公司的客户服务部门)，他们每天都会看到数以千计这样的投诉，它们不会像上面这些投诉那样措辞和格式令人愉快。</p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/636fdc8fcae6bed8a3d17bdadbebe05b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*DD_LWypzKBWiL594PRstFQ.jpeg"/></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">客户投诉的实际图像(来源:via <a class="ae mm" href="https://yandex.fr/news/story/Penzenskij_chinovnik_nabrosilsya_s_kulakami_na_zhurnalista--174f8bff44d7cae0ccd8bb37b57a21f8?lr=143&amp;stid=Gn7E&amp;persistent_id=89413115&amp;lang=ruuk&amp;rubric=Penza&amp;from=story" rel="noopener ugc nofollow" target="_blank"> yandex </a>)</p></figure><p id="cb59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，消费者自己可能会将投诉归入错误的部门，而审查每一项投诉并将其转交给相关部门处理将是一项巨大的痛苦。不用说，这些缓慢的处理时间也会导致对客户的缓慢响应时间，从而导致您已经愤怒的客户变得更加愤怒。</p><p id="c076" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">伙计，如果有什么方法可以快速分类每一个抱怨来加快你的阅读过程就好了。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="2234" class="lc kw iq bd ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu nf lw lx ly bi translated">项目目标</h1><p id="456d" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">事实证明是有的，这正是这个项目的目的。在我的项目中，我开发了一个模型，可以根据产品类型对客户投诉进行正确分类，准确率达到83%<strong class="jp ir">。 </strong></p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi ng"><img src="../Images/ee812b4f92eea35ffc6f6c3cf76fce9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vjw0aSQDfmoclwgkiU3dfA.png"/></div></div></figure><p id="f8d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该应用程序利用机器学习算法结合自然语言处理(NLP)方法来处理文本，以预测投诉所指的产品类型。</p><h1 id="be79" class="lc kw iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">定义问题</h1><p id="e19d" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">这本质上是一个<strong class="jp ir"> <em class="kl">监督(标签)</em> </strong>文本多类分类问题，我们的目标是用一个新的输入(投诉)进行预测(分配到正确的类别)。在下面的步骤中，我将带您完成以下内容:</p><ul class=""><li id="7db7" class="nh ni iq jp b jq jr ju jv jy nj kc nk kg nl kk nm nn no np bi translated">数据探索(了解数据集)</li><li id="9dc5" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">数据(文本)预处理和在NLP项目中可能采取的一般步骤</li><li id="34ec" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">型号选择以及为什么使用Micro-F1作为评估指标</li><li id="678c" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">选定型号的最终测试和结果</li></ul><p id="8a98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本系列的第2部分中…</p><ul class=""><li id="2252" class="nh ni iq jp b jq jr ju jv jy nj kc nk kg nl kk nm nn no np bi translated">Flask应用程序演示&amp;如何构建一个</li></ul><p id="38c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个项目的所有代码都可以在我的github上找到。如果你需要任何澄清，请随时给我留言。</p><h1 id="df79" class="lc kw iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">第一部分:数据</h1><p id="e960" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">用来训练这个模型的数据取自<a class="ae mm" href="http://catalog.data.gov/dataset/consumer-complaint-database" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="kl">这里</em> </strong> </a>。并且对每一列的含义的解释可以在<a class="ae mm" href="https://cfpb.github.io/api/ccdb/fields.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="kl">这里</em> </strong> </a>找到。它本质上是一个由消费者金融保护局(CFPB)提供的关于金融产品和服务投诉的标签数据集。</p><p id="06bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们观察到数据集包含1，437，716行数据，以及许多许多包含空值的行。</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="a120" class="kv kw iq kr b gy kx ky l kz la">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 1437716 entries, 0 to 1437715<br/>Data columns (total 18 columns):<br/>Date received                   1437716 non-null object<br/>Product                         1437716 non-null object<br/>Sub-product                     1202551 non-null object<br/>Issue                           1437716 non-null object<br/>Sub-issue                       887045 non-null object<br/>Consumer complaint narrative    463991 non-null object<br/>Company public response         530104 non-null object<br/>Company                         1437716 non-null object<br/>State                           1414039 non-null object<br/>ZIP code                        1304830 non-null object<br/>Tags                            196144 non-null object<br/>Consumer consent provided?      831624 non-null object<br/>Submitted via                   1437716 non-null object<br/>Date sent to company            1437716 non-null object<br/>Company response to consumer    1437715 non-null object<br/>Timely response?                1437716 non-null object<br/>Consumer disputed?              768482 non-null object<br/>Complaint ID                    1437716 non-null int64<br/>dtypes: int64(1), object(17)<br/>memory usage: 197.4+ MB</span></pre><p id="c9f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，由于我们只分析投诉本身，我们只需要<code class="fe nv nw nx kr b">Product</code>和<code class="fe nv nw nx kr b">Consumer Complaint Narrative</code>列。</p><p id="b002" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在只保留我们需要的列、删除空值并将它们重命名为更好使用的名称之后，我们只剩下463，991行数据:</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="bb6a" class="kv kw iq kr b gy kx ky l kz la">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>Int64Index: 463991 entries, 4 to 1437711<br/>Data columns (total 2 columns):<br/>PRODUCT               463991 non-null object<br/>CONSUMER_COMPLAINT    463991 non-null object<br/>dtypes: object(2)<br/>memory usage: 10.6+ MB</span></pre><p id="7890" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe nv nw nx kr b">PRODUCT</code>列上做一点EDA(探索性数据分析),我们观察到18个类，分布如下:</p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi ny"><img src="../Images/9c5ea7d4f273889ff40197652b61037a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XCVJ93h1b-7GEqmgbmGXzA.png"/></div></div></figure><p id="b18a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，有些类别(产品)是重叠的。例如，<code class="fe nv nw nx kr b">Credit card or prepaid card</code>与<code class="fe nv nw nx kr b">Credit card</code>和<code class="fe nv nw nx kr b">Prepaid card</code>冲突。此外，还有一个问题是要对463，991行执行分析(我怀疑您的笔记本电脑是否能够在这个项目的后期处理和模型训练。我的不行)。</p><p id="9cab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在删除了一些产品类别、合并了一些类别并减少了90%的观察数量之后(具体情况可以在我的jupyter笔记本上的<a class="ae mm" href="https://github.com/xianjinseow92/projects/tree/master/Project_4_Consumer_Complaint_Text_MultiClassifier/notebooks" rel="noopener ugc nofollow" target="_blank">我的github </a>中找到)，我们还剩下大约30，000行投诉(对于8GB ram的笔记本电脑来说，这是可以管理的)。</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="335f" class="kv kw iq kr b gy kx ky l kz la">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>Int64Index: 31942 entries, 72 to 1437623<br/>Data columns (total 2 columns):<br/>PRODUCT               31942 non-null object<br/>CONSUMER_COMPLAINT    31942 non-null object<br/>dtypes: object(2)<br/>memory usage: 748.6+ KB</span></pre><p id="d82b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">具有以下分布:</p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi nz"><img src="../Images/0d7e3a9e03b124db5799ca84ba8571d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZUHF5X3DJ7VuYWptej7eMQ.png"/></div></div></figure><p id="56a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不算太寒酸。现在我们准备对我们的投诉数据进行一些文本预处理！</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="1097" class="lc kw iq bd ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu nf lw lx ly bi translated">第2部分:文本预处理</h1><h2 id="1c99" class="kv kw iq bd ld oa ob dn lh oc od dp ll jy oe of lp kc og oh lt kg oi oj lx ok bi translated">第2.1节:简单地说，自然语言预处理</h2><p id="dba8" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">现在我们有了数据，我们需要完成清理过程。对于一般的文本数据集，这通常包括:</p><ul class=""><li id="8c3f" class="nh ni iq jp b jq jr ju jv jy nj kc nk kg nl kk nm nn no np bi translated">删除标点符号</li><li id="bd7f" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">删除停用词(如“the”、“this”、“what”)</li><li id="0ef4" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">小写字母</li><li id="da6a" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">标记化</li><li id="eb27" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">词干化/词尾化(通过删除诸如“-ed”、“-ing”等后缀，将单词简化为基本形式)</li></ul><p id="ec20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您正在处理在线文本和评论，您将需要进一步删除超链接、用户名和自动消息等项目。</p><p id="34c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您所做的预处理因项目而异，为此，除了词干化和词汇化之外，我取得了最好的准确度分数。我考虑过使用二元语法，但是这导致我经常遇到内存问题，因此我只能考虑一元语法(标准的单词标记化)。</p><p id="48c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是一个删除标点符号、删除停用词、小写字母及其后的标记化的示例。</p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi ol"><img src="../Images/a5d9c5f22962a80a6ae4456757af61bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b7HHAiA9uObxQfeqG73HLg.jpeg"/></div></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">删除标点符号</p></figure><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi om"><img src="../Images/c08e3213f7df2f119397dc0153e4dab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1eXiIiYfY0VgUYtjOkQ1Ew.jpeg"/></div></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">停用词删除</p></figure><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi on"><img src="../Images/14be882b87897d87beb72ebe9cae877d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pcNlns_OXEicgTqrQQM8jw.jpeg"/></div></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">用小写字体书写</p></figure><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi oo"><img src="../Images/fa042e16a08d8c9533d5e4a24ed70fe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NlcyYwBBF6TsV9xBntljUA.jpeg"/></div></div><p class="mi mj gj gh gi mk ml bd b be z dk translated">标记化</p></figure><h2 id="41cb" class="kv kw iq bd ld oa ob dn lh oc od dp ll jy oe of lp kc og oh lt kg oi oj lx ok bi translated">第2.2节:矢量化</h2><p id="ceca" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">为了将单词转化为机器学习算法可以理解和处理的东西，我们需要做一些叫做<strong class="jp ir"> <em class="kl">矢量化</em> </strong>的事情。简而言之，这是将单词转化为多维向量的过程，其方式是将单词的含义或上下文与向量指向的位置相关联。<strong class="jp ir">从某种意义上来说，矢量化允许计算机通过将相似的词义映射到相似的向量空间来量化词义。</strong></p><h2 id="5074" class="kv kw iq bd ld oa ob dn lh oc od dp ll jy oe of lp kc og oh lt kg oi oj lx ok bi translated">第2.3节:词频—逆文档频率矢量化</h2><p id="e45b" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">对于这个应用程序，我们需要<strong class="jp ir">基于上下文的</strong>矢量化。这就是术语频率逆文档频率矢量化的用武之地(TF-IDF)。这种矢量化方法查看一个单词在注释中出现的次数相对于它在其他注释中出现的次数。<strong class="jp ir">两件事导致TF-IDF得分更高:</strong></p><ol class=""><li id="7389" class="nh ni iq jp b jq jr ju jv jy nj kc nk kg nl kk op nn no np bi translated"><strong class="jp ir">该词在被评分的具体投诉中出现的频率较高。</strong></li><li id="f835" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk op nn no np bi translated"><strong class="jp ir">该词在所有其他投诉中出现的频率较低。</strong></li></ol><h1 id="2c9b" class="lc kw iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">第3部分:培训方法</h1><h2 id="4d23" class="kv kw iq bd ld oa ob dn lh oc od dp ll jy oe of lp kc og oh lt kg oi oj lx ok bi translated">第3.1节:模型评估分数</h2><p id="511c" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">在多类场景中，按照二进制分类不再像Precision、Recall和F1那么简单(就像我之前的项目<a class="ae mm" rel="noopener" target="_blank" href="/catching-a-welcher-classifying-a-credit-card-defaulter-f4b21547a618">对违约者进行分类</a>)。这是一个全新的水平。如果您需要更好地理解多分类场景中模型使用的评估指标，我建议参考<a class="ae mm" rel="noopener" target="_blank" href="/multi-class-metrics-made-simple-part-i-precision-and-recall-9250280bddc2"> Boaz Shmueli </a>关于多分类器中评估指标的解释。他很好地解释了关于精确度、召回和F1评分的<strong class="jp ir"> <em class="kl">二进制</em> </strong> <em class="kl"> </em>和<strong class="jp ir"> <em class="kl">多类</em> </strong>分类指标。</p><p id="b3e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">和这个多分类案例一样，我决定使用<strong class="jp ir"> <em class="kl"> Micro-F1 </em> </strong>作为模型间的评价指标，因为它衡量模型的<strong class="jp ir"> <em class="kl">整体精度</em> </strong>。</p><h2 id="f0bd" class="kv kw iq bd ld oa ob dn lh oc od dp ll jy oe of lp kc og oh lt kg oi oj lx ok bi translated">第3.2节:使用的模型</h2><p id="5c3d" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我已经决定使用以下模型进行多类文本分类:</p><ol class=""><li id="2d1e" class="nh ni iq jp b jq jr ju jv jy nj kc nk kg nl kk op nn no np bi translated">多项式朴素贝叶斯</li><li id="8070" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk op nn no np bi translated">高斯朴素贝叶斯</li><li id="6d19" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk op nn no np bi translated">逻辑回归</li><li id="e131" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk op nn no np bi translated">随机森林</li><li id="348a" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk op nn no np bi translated">线性SVC</li></ol></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="6637" class="lc kw iq bd ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu nf lw lx ly bi translated">第4部分:型号选择</h1><p id="6c59" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">每个模型都在分层的<strong class="jp ir"><em class="kl">【5折分裂训练-验证(整个数据集的80)</em></strong>上<strong class="jp ir"><em class="kl"/></strong>交叉验证。剩下的20%的数据被保留下来，用于模拟我们最终选择的模型在现实生活中的表现，在现实生活中，它必须处理从未见过的输入。</p><p id="07ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">像往常一样，如何做到这一点的代码可以在我的jupyter笔记本(笔记本的第3部分)的github 上找到。</p><p id="f570" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从我们的初步培训结果中，我们看到:</p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi oq"><img src="../Images/2d2e9ffe86e37dff6c0c1bdd3b422a1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*weCR2eNHpZpvJmDXoX7FSg.png"/></div></div></figure><p id="0311" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">逻辑回归给了我们83%的最高准确率。</p><p id="451b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">83%是相当高的准确率。但是我们能做得更好吗？我们不能确定是否会更好，但我们可以一直尝试，努力改进。</p><h2 id="c7bd" class="kv kw iq bd ld oa ob dn lh oc od dp ll jy oe of lp kc og oh lt kg oi oj lx ok bi translated">第4.1节:斯坦福手套和谷歌的Word2Vec</h2><p id="5da4" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我们可以在将投诉输入到我们的分类器之前，利用嵌入在投诉上的单词，而不是利用矢量化(我们上面使用的Tf-idfVectorizer)。要了解更多关于WordEmbeddings的内容，你可以在这里找到它<a class="ae mm" rel="noopener" target="_blank" href="/the-three-main-branches-of-word-embeddings-7b90fa36dfb9">。</a></p><p id="c4b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一些方法，如Word2Vec和<a class="ae mm" href="https://spacy.io/models" rel="noopener ugc nofollow" target="_blank"> spaCy </a>涉及预先训练的、数千兆字节的模型，这些模型在数十万(如果不是数百万的话)文档上训练，然后将单词的含义减少到一组数百个数字。一般来说，这些模型在保持单词的上下文和含义方面非常出色，但是它们速度慢且庞大。</p><p id="d2ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于这个项目，我选择了使用斯坦福德的手套(越来越复杂)和谷歌的Word2Vec。</p><h2 id="3fe2" class="kv kw iq bd ld oa ob dn lh oc od dp ll jy oe of lp kc og oh lt kg oi oj lx ok bi translated">第4.2节:tfidf矢量器和word嵌入结果</h2><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi oq"><img src="../Images/72a4753549ee484e4b7b366fe6788994.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ftCqjFU5HXew9A9Bq-FJlw.png"/></div></div></figure><p id="b08a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">综合所有测试结果，我们发现普通TFidfVectorizer比WordEmbeddings要好得多，最高准确率为83%。</p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi or"><img src="../Images/fe5190f57111d9fe1b428c3f3c7dffea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7NgWHg-01kdRbP-t6CKhEQ.png"/></div></div></figure><p id="3126" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，<strong class="jp ir"> <em class="kl">使用逻辑回归的TfidfVectorizer</em></strong>被选为本项目使用的文本预处理和模型组合。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="893b" class="lc kw iq bd ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu nf lw lx ly bi translated">第5部分:在看不见的数据上测试我们最终选择的逻辑回归分类器</h1><p id="876f" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">还记得我们之前保留的没有在交叉验证中使用的20%的数据吗？接下来，我们使用它来评估我们的模型在看不见的数据上的表现(即，它在现实生活中的表现)。</p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi os"><img src="../Images/e06830d3b72a812ddd823ddbc706d8f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PMMG49eokf3zYAu33B82cg.png"/></div></div></figure><p id="09af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个模型在看不见的数据上给了我们83%的准确率！ 表示它可以在83%的时间内正确地对投诉进行分类！现在我们有了自己的模型，我们终于可以看到它的实际应用了！</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="f515" class="lc kw iq bd ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu nf lw lx ly bi translated">第6部分:烧瓶演示</h1><p id="a4eb" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">为了能够以用户友好的方式使用我们的模型，我创建了一个Flask应用程序，允许输入投诉。此后，该应用程序将预测投诉属于哪个产品类别。参考这个<strong class="jp ir"> <em class="kl"> post (WIP) </em> </strong>了解一下Flask app是怎么创建的！</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="84fa" class="kv kw iq kr b gy kx ky l kz la">I am dissatisfied with the current outcome of a dispute that was initiated with Discover Card regarding a single transaction that occurred on XXXX/XXXX/2015 in the amount of {$280.00}. I have corresponded with Discover Card at least four times since XXXX/XXXX/2015 ( which I have enclosed as an attachment to this complaint ). I believe that the credit card issuer has violated consumer protection laws by failing to implement the Special Rule for Credit Card Purchase protection despite overwhelming paperwork evidence submitted by me that shows the merchant has conducted business in bad faith less favorable to the consumer. I have sustained a monetary loss as a result of merchants bad faith and intent. I have patiently utilized the internal Discover Card dispute process over the past three months with the credit card issuer always favoring the merchant ; I have repeatedly submitted irrefutable paperwork evidence that has shown that the merchant has conducted business in bad faith. I have tried in good faith to address my complaint with the merchant and Discover Card but believe that I will not receive a favorable outcome.</span></pre><p id="c61d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还记得我们在帖子开头看到的这面可怕的文字墙吗？让我们来测试一下我们的模型。花点时间读读它，猜猜它属于哪一类。</p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi nz"><img src="../Images/0d7e3a9e03b124db5799ca84ba8571d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZUHF5X3DJ7VuYWptej7eMQ.png"/></div></div></figure><p id="99b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们来测试一下我们的应用程序。</p><figure class="km kn ko kp gt mf"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="fe17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有没有得出和app一样的结论？现在让我们用一个更难的投诉来试试，充满了错别字、大写字母和千年行话。</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="6337" class="kv kw iq kr b gy kx ky l kz la">Omg where is my money?????? AOSINIONSAD WHY DID YOU GUYS TAKE MY MONEY AWAY. SAOIDNSIOADNOIAODNNIOASDNSADNOSDNOASDN</span><span id="d033" class="kv kw iq kr b gy lb ky l kz la">I TRANSFERRED IT LAST NIGHT AND I WOKE UP TO NOTHING IN!!!!!! MY BANK ACCOUNT. HELP PLEASE!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span><span id="802a" class="kv kw iq kr b gy lb ky l kz la">I NEED THE MONEY OR ELSE I WILL BE HUNTED BY LOAN SHARKS!!!!!!!!</span><span id="62e6" class="kv kw iq kr b gy lb ky l kz la">YOU *(#&amp;$) PEOPLE HAVE NO RIGHT TO DO THIS TO ME!!!! I NEED MY MONEY!!!!</span></pre><figure class="km kn ko kp gt mf"><div class="bz fp l di"><div class="ot ou l"/></div></figure><p id="3b99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们看到该应用程序可以正确无误地处理混乱的投诉，并正确地将它们归类到哪个产品类别。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="1c7f" class="lc kw iq bd ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu nf lw lx ly bi translated">第7部分:应用优势</h1><p id="703f" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">使用这个应用程序可以带来很多好处，从解放人力到提高筛选客户投诉的效率。</p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi os"><img src="../Images/c17f16b7f6895c65fcd2972938ea65f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YWk_-axY4xcPlJ8O_9bdvw.png"/></div></div></figure></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="9eae" class="lc kw iq bd ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu nf lw lx ly bi translated">第8节:未来的工作</h1><p id="95e6" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">作为对该应用程序的增强，以提高其实用性，我们或许可以研究以下内容:</p><figure class="km kn ko kp gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi ov"><img src="../Images/6e116ecba6e2513a4ac06ec87beb3430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O9wNnSjzaddYk54suLStBg.png"/></div></div></figure><p id="a863" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">话题总结<br/> </em> </strong>目前app只将投诉归入正确的产品类别。虽然它确实将投诉归入了正确的类别，但客户投诉专员仍然需要通读投诉本身。这将是很好的应用程序也能够提供一个简短的投诉是什么的摘要。这将是一个有趣的话题，可以研究和设计如何创建这个功能。</p><p id="d11c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">投诉优先级<br/> </em> </strong>我们还可以考虑实施情感分析，以提供某种投诉优先级。听起来更愤怒的投诉(即愤怒的客户)可以被给予更高的优先级，因为愤怒的客户往往会提供最多的问题。因此，我们的应用程序将为客户投诉官自动排序，以确定哪些投诉需要紧急处理。</p><ul class=""><li id="b3f0" class="nh ni iq jp b jq jr ju jv jy nj kc nk kg nl kk nm nn no np bi translated">问是否有人愿意一起工作，可以给我发短信</li></ul></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="76eb" class="lc kw iq bd ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu nf lw lx ly bi translated">第九节:离别赠言</h1><p id="3254" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">这绝不是一篇短文，希望在你的数据科学之旅中是一篇信息丰富的文章。感谢您花时间阅读到这里。</p><p id="a77a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你学到了什么，觉得这很有帮助，或者认为它可能会帮助这个领域的人，请与他人分享这篇文章！</p><p id="8220" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">和往常一样，在xianjinseow92@gmail.com，你可以随时通过我的Linkedin或gmail联系我！</p><p id="c5fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">干杯。</p></div></div>    
</body>
</html>