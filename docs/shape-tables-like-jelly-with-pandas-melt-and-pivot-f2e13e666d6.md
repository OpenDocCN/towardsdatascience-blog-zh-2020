# è®¤è¯†ç†ŠçŒ«æœ€éš¾çš„åŠŸèƒ½ï¼Œç¬¬ä¸‰éƒ¨åˆ†

> åŸæ–‡ï¼š<https://towardsdatascience.com/shape-tables-like-jelly-with-pandas-melt-and-pivot-f2e13e666d6?source=collection_archive---------9----------------------->

## ç”¨ç†ŠçŒ«é‡å¡‘æ¡Œå­

## å½¢çŠ¶åƒæœå†»çš„æ¡Œå­æœ‰ç†ŠçŒ«æ—‹è½¬()å’ŒèåŒ–()

![](img/5f87a86d32431fc9fd65504dc067a747.png)

ç…§ç‰‡ç”± [Anastase Maragos](https://unsplash.com/@visualsbyroyalz?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

## ä»‹ç»

æˆ‘å¹¶ä¸ç¾äºæ‰¿è®¤ã€‚`melt()`å’Œ`pivot()`å¯¹æˆ‘æ¥è¯´æ˜¯`pandas`ä¸­æœ€éš¾å­¦çš„ã€‚æˆ‘èŠ±äº† 3-4 ä¸ªå¤šæœˆæ‰æƒ³æ˜ç™½ã€‚å½“æˆ‘ç¬¬ä¸€æ¬¡çœ‹åˆ°å®ƒä»¬æ—¶ï¼Œæˆ‘è¯•äº†åˆè¯•ï¼Œä½†ä¸æ˜ç™½å®ƒä»¬æ˜¯å¦‚ä½•æˆ–ä½•æ—¶è¢«ä½¿ç”¨çš„ã€‚æ‰€ä»¥ï¼Œæˆ‘æ”¾å¼ƒäº†ï¼Œç»§ç»­å‰è¿›ï¼Œå†æ¬¡é‡è§ä»–ä»¬ã€‚å°è¯•è¿‡ï¼Œå¤±è´¥è¿‡ï¼Œç»§ç»­å‰è¿›ï¼Œå†ç›¸é‡ã€‚é‡å¤äº†å¾ˆå¤šæ¬¡ã€‚

ä»¤æˆ‘æ„Ÿåˆ°å›°æƒ‘çš„æ˜¯ï¼Œåœ¨è¿™ä¸ªæœ‰æ•°ç™¾ä¸‡è§†é¢‘å’Œåšå®¢æ•™ç¨‹çš„æ—¶ä»£ï¼Œæˆ‘æ‰¾ä¸åˆ°ä¸€ä¸ªç®€å•çš„å¥½çš„æ¥æºå¯ä»¥æ›´å¥½åœ°è§£é‡Šè¿™äº›åŠŸèƒ½ã€‚æˆ‘æœ€å–œæ¬¢çš„`pandas`åšå®¢ï¼Œå®ç”¨å•†ä¸š Pythonï¼Œå®ƒæ¶µç›–äº†`pandas`çš„è®¸å¤šç¡¬åŠŸèƒ½ï¼Œå¥½å¿ƒåœ°æŠŠå®ƒä»¬çœç•¥äº†*ğŸ˜”ğŸ˜”*ã€‚è€Œä¸”ï¼Œä»–ä»¬çš„æ–‡æ¡£åªæœ‰åœ¨ä½ å®Œå…¨äº†è§£è¿™äº›åŠŸèƒ½åæ‰æœ‰æ„ä¹‰ï¼Œä¸€äº›ç½‘ç«™(å¦‚æœä½ æœç´¢è¿™äº›åŠŸèƒ½ï¼Œå®ƒä»¬çš„æ’åæ€»æ˜¯å¾ˆé«˜)åªæ˜¯å¤åˆ¶æ–‡æ¡£ğŸ˜¶ğŸ˜¶ã€‚

æ‰€ä»¥ï¼Œå°±åƒæˆ‘æœ€è¿‘ä¸€ç›´åœ¨å†™çš„`pandas`çš„ç¡¬åŠŸèƒ½ä¸€æ ·(å®ƒä»¬è¡¨ç°å¾—çœŸçš„å¾ˆå¥½)ï¼Œç°åœ¨æ˜¯`melt()`å’Œ`pivot()`çš„æ—¶å€™äº†ã€‚æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹é¢ä¸´ç±»ä¼¼å›°éš¾çš„äººæœ‰ç”¨ã€‚

[](https://ibexorigin.medium.com/membership) [## é€šè¿‡æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥ Medium-BEXGBoost

### è·å¾—ç‹¬å®¶è®¿é—®æˆ‘çš„æ‰€æœ‰âš¡premiumâš¡å†…å®¹å’Œæ‰€æœ‰åª’ä½“æ²¡æœ‰é™åˆ¶ã€‚æ”¯æŒæˆ‘çš„å·¥ä½œï¼Œç»™æˆ‘ä¹°ä¸€ä¸ªâ€¦

ibexorigin.medium.com](https://ibexorigin.medium.com/membership) 

è·å¾—ç”±å¼ºå¤§çš„ AI-Alpha ä¿¡å·é€‰æ‹©å’Œæ€»ç»“çš„æœ€ä½³å’Œæœ€æ–°çš„ ML å’Œ AI è®ºæ–‡:

[](https://alphasignal.ai/?referrer=Bex) [## é˜¿å°”æ³•ä¿¡å·|æœºå™¨å­¦ä¹ çš„æå“ã€‚è‰¾æ€»ç»“çš„ã€‚

### ç•™åœ¨å¾ªç¯ä¸­ï¼Œä¸ç”¨èŠ±æ— æ•°æ—¶é—´æµè§ˆä¸‹ä¸€ä¸ªçªç ´ï¼›æˆ‘ä»¬çš„ç®—æ³•è¯†åˆ«â€¦

alphasignal.ai](https://alphasignal.ai/?referrer=Bex) 

## å¯ç‚¹å‡»çš„ç›®å½•(ä»…é™ç½‘ç»œ)

âˆ˜ [ç®€ä»‹](#d30b)
âˆ˜ [è®¾ç½®](#203e)
âˆ˜ [ç†ŠçŒ«è()](#668c)
âˆ˜ [ç†ŠçŒ«è()](#675b)
âˆ˜ [ç†ŠçŒ«æ¢()](#0726)

> ä½ å¯ä»¥ä»[è¿™ä¸ª](https://github.com/BexTuychiev/medium_stories/tree/master/hardest_of_pandas3) GitHub repo ä¸‹è½½ç¬”è®°æœ¬å’Œæ ·æœ¬æ•°æ®ã€‚åœ¨æ¯ä¸ªå‡½æ•°ç¬¬ä¸€æ¬¡å‡ºç°æ—¶ï¼Œæˆ‘è¿˜ç”¨è¶…é“¾æ¥é“¾æ¥äº†å®ƒä»¬çš„æ–‡æ¡£ã€‚

## è®¾ç½®

## ç†ŠçŒ«èåŒ–()

è®©æˆ‘ä»¬ä»ä¸€ä¸ªéå¸¸æ„šè ¢çš„ä¾‹å­å¼€å§‹ã€‚æˆ‘å°†åˆ›å»ºä¸€ä¸ª 1x1 çš„æ•°æ®å¸§ï¼Œä¿å­˜ä¸€ä¸ªåŸå¸‚åç§°å’Œä¸€å¤©çš„æ¸©åº¦ã€‚ç„¶åï¼Œæˆ‘ä¼šåœ¨å®ƒä¸Šé¢è°ƒç”¨`[melt()](https://pandas.pydata.org/docs/reference/api/pandas.melt.html)`ï¼Œçœ‹çœ‹å®ƒæœ‰ä»€ä¹ˆæ•ˆæœ:

![](img/626d4f28d9184eca70952414c8fee617.png)

```
>>> df.melt()
```

![](img/6c118f368f862f2f497ad24b18115bc8.png)

å› æ­¤ï¼Œåœ¨æ²¡æœ‰ä»»ä½•å‚æ•°çš„æƒ…å†µä¸‹ï¼Œ`melt()`è·å–ä¸€åˆ—ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºåŒ…å«ä¸¤ä¸ªæ–°åˆ—çš„è¡Œ(ä¸åŒ…æ‹¬ç´¢å¼•)ã€‚è®©æˆ‘ä»¬å†æ·»åŠ ä¸¤ä¸ªåŸå¸‚ä½œä¸ºåˆ—:

![](img/46dfd73401e4eb9f383379f0beb02f06.png)

å¦‚æœä½ æ³¨æ„åˆ°ï¼Œè¿™ç§æ•°æ®å¸§æ ¼å¼ä¸å®¹æ˜“ä½¿ç”¨ï¼Œè€Œä¸”ä¸å¹²å‡€ã€‚æœ€ç†æƒ³çš„æ˜¯å°†åˆ—è½¬åŒ–ä¸ºè¡Œï¼Œå®ƒä»¬çš„æ¸©åº¦å€¼åœ¨å³è¾¹:

```
df.melt()
```

![](img/5e1ba76f187793e0b38d3607881d0fde.png)

è®©æˆ‘ä»¬ä¸ºåŸå¸‚æ·»åŠ æ›´å¤šçš„æ¸©åº¦:

![](img/3a5aa6b506182b8bf33abaad43f86eb4.png)

å¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸ªç‰ˆæœ¬çš„æ•°æ®å¸§ä¸Šè°ƒç”¨`melt()`ï¼Œä½ è®¤ä¸ºä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæ‰‹è¡¨:

```
df_larger.melt()
```

![](img/02c11c7f8df917324157960205faa15c.png)

æ­£å¦‚é¢„æœŸçš„é‚£æ ·ï¼Œå®ƒå°†æ¯ä¸ªåˆ—å€¼è½¬æ¢æˆä¸€è¡Œã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬ä»¥ä¸€ä¸ªé”®å€¼å¯¹ä¸ºä¾‹ã€‚çº½çº¦çš„æ°”æ¸©æ˜¯[25ï¼Œ27ï¼Œ23ï¼Œ25ï¼Œ29]ã€‚è¿™æ„å‘³ç€æœ‰ 5 ä¸ªé”®å€¼å¯¹ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨`melt()`ï¼Œ`pandas`è·å–æ¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œå¹¶å°†å®ƒä»¬æ˜¾ç¤ºä¸ºä¸€è¡Œä¸¤åˆ—ã€‚åœ¨`pandas`ä¸`New York`å®Œæˆä¹‹åï¼Œå®ƒç§»åŠ¨åˆ°å…¶ä»–åˆ—ã€‚

å½“`melt()`åœ¨ä¸¤åˆ—ä¸­æ˜¾ç¤ºæ¯ä¸ªé”®-å€¼å¯¹æ—¶ï¼Œå®ƒä¸ºè¿™ä¸¤åˆ—æä¾›é»˜è®¤åç§°`variable`å’Œ`value`ã€‚å¯ä»¥å°†å®ƒä»¬æ›´æ”¹ä¸ºæ›´æœ‰æ„ä¹‰çš„å†…å®¹:

![](img/a055633e613c245c32518efdcd1ef15e.png)

`var_name`å’Œ`value_name`å¯ç”¨äºæ”¹å˜ç†”åŒ–æ•°æ®æ¡†çš„åˆ—çš„æ ‡ç­¾ã€‚

å¦‚æœæˆ‘ä»¬ç»§ç»­æ·»åŠ åˆ—ï¼Œ`melt()`å°†æ€»æ˜¯æŠŠæ¯ä¸ªå€¼è½¬æ¢æˆä¸€ä¸ªåŒ…å«ä¸¤åˆ—çš„è¡Œï¼Œè¿™ä¸¤åˆ—åŒ…å«å‰ä¸€åˆ—çš„åç§°å’Œå®ƒçš„å€¼ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¸¥è‚ƒä¸€ç‚¹ã€‚å‡è®¾æˆ‘ä»¬æœ‰è¿™ä¸ªæ•°æ®æ¡†æ¶:

![](img/a8b535e5b3b41be8b8143d7fc3df66de.png)

è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬å·²ç»æŠŠåŸå¸‚åˆ—æˆäº†ä¸€åˆ—ã€‚ä½†æ˜¯ï¼Œè¿™ç§ç±»å‹çš„è¡¨æ ¼æ ¼å¼ä»ç„¶æ²¡æœ‰ç”¨ã€‚è¯¥æ•°æ®é›†åŒ…å« 5 ä¸ªåŸå¸‚ 5 å¤©çš„æ¸©åº¦ä¿¡æ¯ã€‚æˆ‘ä»¬ç”šè‡³ä¸èƒ½å¯¹è¿™ç§ç±»å‹çš„æ•°æ®è¿›è¡Œç®€å•çš„è®¡ç®—ï¼Œæ¯”å¦‚å¹³å‡ã€‚è®©æˆ‘ä»¬å°è¯•ç†”åŒ–æ•°æ®å¸§:

```
>>> temperatures.melt()
```

![](img/45adcc0a277c2040647eeb81bd01f502.png)

è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œ`melt()`æŠŠåŸå¸‚åä¹Ÿå˜æˆäº†è¡Œã€‚ç†æƒ³çš„æƒ…å†µæ˜¯ï¼Œæˆ‘ä»¬å°†åŸå¸‚ä¿ç•™ä¸ºåˆ—ï¼Œå¹¶å°†å‰©ä½™çš„åˆ—è¿½åŠ ä¸ºè¡Œã€‚`melt()`æœ‰ä¸€ä¸ªåä¸º`id_vars`çš„å‚æ•°å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚

å¦‚æœæˆ‘ä»¬åªæƒ³æŠŠä¸€äº›åˆ—å˜æˆè¡Œï¼Œé‚£ä¹ˆæŠŠè¦ä¿ç•™çš„åˆ—ä½œä¸ºä¸€ä¸ªåˆ—è¡¨(å³ä½¿æ˜¯å•ä¸ªå€¼)ä¼ é€’ç»™`id_vars`ã€‚`id_vars`ä»£è¡¨èº«ä»½å˜é‡ã€‚

```
temperatures.melt(id_vars=['city'])
```

![](img/7b240818daef3839b39722152f41a7f7.png)

ä½¿ç”¨`id_vars`åï¼Œ`city`åˆ—ä½œä¸ºåˆ—ç•™äº†ä¸‹æ¥ã€‚ä½†æ˜¯å®ƒå˜é•¿äº†ã€‚åŸå› æ˜¯æ¯ä¸ªåŸå¸‚éƒ½æœ‰ 5 å¤©çš„è§‚æµ‹æ—¶é—´ã€‚å½“æˆ‘ä»¬ä»åˆ—ä¸­è·å–è¿™äº›è§‚å¯Ÿå€¼å¹¶å°†å…¶æ˜¾ç¤ºä¸ºè¡Œæ—¶ï¼Œ`pandas`ä¼šè‡ªåŠ¨æ·»åŠ æ–°çš„è¡Œæ¥é€‚åº”æ–°çš„å€¼ã€‚

å³ä½¿æˆ‘ä»¬æœ‰äº†æ›´å¥½çš„è¡¨ï¼Œåˆ—åä¹Ÿä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨`melt()`æ¥åšï¼Œè€Œä¸æ˜¯åœ¨èåŒ–è¡¨æ ¼åæ‰‹åŠ¨æ›´æ”¹å®ƒä»¬:

![](img/66676971461b0a60ef5e11d0daec4240.png)

å…·æœ‰ä¸åŒåˆ—æ ‡ç­¾çš„ç›¸åŒæ•°æ®å¸§ã€‚

## ç†ŠçŒ«åœ¨çœŸå®ä¸–ç•Œçš„æ•°æ®ä¸ŠèåŒ–()

ç°åœ¨ï¼Œæ˜¯æ—¶å€™æˆ‘ä»¬åœ¨çœŸå®ä¸–ç•Œçš„æ•°æ®é›†ä¸Šå·¥ä½œæ¥è¯æ˜è¿™ä¸€ç‚¹äº†ã€‚æˆ‘å°†åŠ è½½çº½çº¦è‚¡ç¥¨æ•°æ®é›†ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ª[é“¾æ¥](https://www.kaggle.com/dgawlik/nyse/download)ä» Kaggle ä¸‹è½½ã€‚å®ƒåŒ…å«è¶…è¿‡ 501 å®¶å…¬å¸ 2016 å¹´çš„è‚¡ç¥¨ä¿¡æ¯:

![](img/6aaed2cc4272ec2edfd354c6767c729e.png)

æˆ‘å°†åªå¯¹ä¸€ä¸ªæœˆè¿›è¡Œå­é›†åˆ’åˆ†ï¼Œå› ä¸ºæ¯å¤©éƒ½æœ‰è§‚å¯Ÿ:

![](img/2f580dec12a8a058fa4950be14b6fc12.png)

ç°åœ¨ï¼Œä¸ºäº†å‘æ‚¨å±•ç¤ºå¦‚ä½•åœ¨çœŸå®ä¸–ç•Œçš„æ•°æ®ä¸Šä½¿ç”¨`melt()`ï¼Œæˆ‘å°†ä½¿ç”¨`pivot()`æ‰§è¡Œä¸€ä¸ªæ“ä½œï¼Œæˆ‘å°†åœ¨æœ¬æ–‡åé¢æ•™æ‚¨ã€‚

æ•°æ®ç°åœ¨æ˜¯è¿™æ ·çš„æ ¼å¼:

![](img/bc3b6f06308c5cc418839dc3e05521f9.png)

500 è¡Œï¼Œ22 åˆ—

å®ƒä¸ºæ‰€æœ‰å…¬å¸æä¾›äº† 500 è¡Œï¼Œä¸º 2 æœˆä»½çš„ 22 å¤©æä¾›äº† 22 åˆ—ã€‚æ¯ä¸ªå•å…ƒæ ¼åŒ…å«è‚¡ç¥¨åœ¨æŸä¸€å¤©çš„æ”¶ç›˜ä»·ã€‚æˆ‘ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ç§æ ¼å¼ï¼Ÿå› ä¸ºç°å®ä¸–ç•Œçš„æ•°æ®ç»å¸¸æ˜¯è¿™ç§å½¢çŠ¶ã€‚

ä¾‹å¦‚ï¼Œå½“è®°å½•è¿™ä¸ªæ•°æ®é›†æ—¶ï¼Œå‡è®¾ä»–ä»¬æƒ³ä¸ºæ–°çš„ä¸€å¤©æ·»åŠ ä¸€ä¸ªæ–°å€¼ã€‚æœ‰ 500 å®¶å…¬å¸ï¼Œå¦‚æœæ‚¨ä¸å°†æ–°çš„ä¸€å¤©ä½œä¸ºæ–°åˆ—æ·»åŠ ï¼Œæ‚¨å°†ä¸å¾—ä¸å†æ¬¡å†™å‡º 500 å®¶å…¬å¸ï¼Œå‘æ•°æ®é›†ä¸­å†æ·»åŠ  500 è¡Œã€‚å¯¹äºè®°å½•è¿™äº›æ•°æ®çš„äººæ¥è¯´ï¼Œæ·»åŠ æ–°çš„è§‚å¯Ÿå€¼ä½œä¸ºæ–°çš„åˆ—éå¸¸æ–¹ä¾¿ã€‚

å› æ­¤ï¼Œç°åœ¨æˆ‘ä»¬æƒ³ä½¿ç”¨`melt()`å°†è¿™ä¸ª`stocks_small`æ•°æ®é›†è½¬æ¢å›å®ƒçš„åŸå§‹æ ¼å¼ï¼Œä»¥ä¾¿æ›´å®¹æ˜“å¤„ç†ã€‚å¦‚æœæ‚¨å†æ¬¡æŸ¥çœ‹æ•°æ®ï¼Œæˆ‘ä»¬å¸Œæœ›å°†æ‰€æœ‰æ—¥æœŸåˆ—è½¬æ¢æˆä¸¤åˆ—ï¼Œå…¶ä¸­åŒ…å«(æ—¥æœŸï¼Œæ”¶ç›˜ä»·)é”®-å€¼å¯¹ï¼Œä¿ç•™`symbol`åˆ—ã€‚å°±åƒæˆ‘ä»¬åœ¨å‰é¢çš„ä¾‹å­ä¸­æ‰€åšçš„ä¸€æ ·ï¼Œå¦‚æœæˆ‘ä»¬å°†`symbol`ä¼ é€’ç»™`id_vars`ï¼Œå®ƒä¿æŒä¸ºä¸€åˆ—ï¼Œå…¶ä»–æ—¥æœŸå°†å˜æˆè¡Œ:

![](img/55d498a8c6377a3395c5bae880bf6b4e.png)

```
Number of rows in melted table: 10500
```

å°†å…¶ä¸åŸå§‹æ•°æ®è¿›è¡Œæ¯”è¾ƒ:

ç®€è€Œè¨€ä¹‹ï¼Œ`melt()`é‡‡ç”¨å®½æ•°æ®å¸§ï¼Œå¹¶ä½¿å…¶å˜é•¿å˜ç»†ã€‚

## ç†ŠçŒ«æ¢è½´()

`[pivot()](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pivot.html)`ä¸`melt()`å®Œå…¨ç›¸åã€‚æœ‰æ—¶ï¼Œæ‚¨ä¼šå¸Œæœ›å°†å¹²å‡€çš„é•¿æ ¼å¼æ•°æ®è½¬æ¢ä¸ºå®½æ ¼å¼æ•°æ®ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘æ˜¯å¦‚ä½•å°†å­é›†`stocks`è½¬æ¢æˆæ›´å®½çš„æ ¼å¼çš„ã€‚è¿™é‡Œæœ‰æ•°æ®æé†’ä½ :

```
stocks_small.head()
```

![](img/eecde00f3b64e3d6ef00681a10c1c815.png)

ç°åœ¨ï¼Œæˆ‘å°†æ—‹è½¬è¡¨æ ¼:

![](img/0ff462fac626678c16f710ba579e107d.png)

500 è¡Œï¼Œ42 åˆ—

```
>>> pivoted.shape
(500, 42)
```

å½“æ‚¨ä½¿ç”¨`pivot()`æ—¶ï¼Œè¯·è®°ä½ä»¥ä¸‹å‡ ç‚¹:

1.  `pandas`å°†æ¥å—æ‚¨ä¸º`index`å‚æ•°ä¼ é€’çš„å˜é‡ï¼Œå¹¶å°†å…¶å”¯ä¸€å€¼æ˜¾ç¤ºä¸ºç´¢å¼•ã€‚
2.  `pandas`å°†æ¥å—æ‚¨ä¸º`columns`ä¼ é€’çš„å˜é‡ï¼Œå¹¶å°†å…¶å”¯ä¸€å€¼æ˜¾ç¤ºä¸ºå•ç‹¬çš„åˆ—ã€‚

å¦‚æœä½ æ³¨æ„åˆ°äº†ï¼Œä¸Šé¢çš„æ•°æ®å¸§ä¸æ˜¯æˆ‘ä»¬åœ¨`melt()`ä¸­ä½¿ç”¨çš„é‚£ä¸ªã€‚é‚£æ˜¯å› ä¸ºå®ƒè¿˜åŒ…å«äº†ä¸ä»…ä»…æ˜¯æ”¶ç›˜ä»·çš„è‚¡ç¥¨ä»·æ ¼ã€‚åœ¨`pivot()`ä¸­ï¼Œæœ‰ä¸€ä¸ªåä¸º`values`çš„å‚æ•°ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œå®ƒä¼šå‘Šè¯‰`pandas`å°†æ‰€æœ‰å‰©ä½™çš„åˆ—åŒ…å«åˆ°æ—‹è½¬æ•°æ®å¸§ä¸­ã€‚è¿™æ¬¡æˆ‘ä»¬åªé€‰æ‹©`close`ä»·æ ¼:

![](img/0c1b76148d4d91b03b0a19452c1d540b.png)

500 è¡Œï¼Œ21 åˆ—

```
>>> pivoted2.shape
(500, 21)
```

`pivot()`å·®ä¸å¤šå°±æ˜¯è¿™æ ·ã€‚ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå®ƒæ˜¯`pandas`ä¸­æœ€éš¾çš„å‡½æ•°ä¹‹ä¸€ï¼Œç„¶è€Œå®ƒåªæœ‰ 3 ä¸ªå‚æ•°ï¼Œç”šè‡³æ²¡æœ‰ä¸€ä¸ªé¢å¤–çš„å‚æ•°æ¥å¡«å……ç¼ºå¤±çš„å€¼ã€‚

å¯¹äº`pivot()`ï¼Œåªéœ€è®°ä½å®ƒæ¥å—ä¸¤ä¸ªåˆ†ç±»å˜é‡ï¼Œå¹¶å°†å®ƒä»¬çš„å”¯ä¸€å€¼æ˜¾ç¤ºä¸ºç´¢å¼•å’Œåˆ—ã€‚è¿™ä¸ªç»“æœè¡¨å°†æ˜¯è¿™ä¸¤ä¸ªå˜é‡çš„ç½‘æ ¼ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®š`values`å‚æ•°ï¼Œæ‰€æœ‰å‰©ä½™çš„åˆ—å°†ä½œä¸ºå•å…ƒæ ¼å€¼ç»™å‡ºï¼Œè¿™å°†ä½¿è¡¨æ ¼æ›´å®½ã€‚

# å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·åˆ†äº«å¹¶ç•™ä¸‹åé¦ˆã€‚ä½œä¸ºä¸€åä½œå®¶ï¼Œä½ çš„æ”¯æŒå¯¹æˆ‘æ¥è¯´æ„å‘³ç€ä¸€åˆ‡ï¼

é˜…è¯»æ›´å¤šä¸ä¸»é¢˜ç›¸å…³çš„æ–‡ç« :

[](/meet-the-hardest-functions-of-pandas-part-i-7d1f74597e92) [## è®¤è¯†ç†ŠçŒ«æœ€éš¾çš„åŠŸèƒ½ï¼Œç¬¬ä¸€éƒ¨åˆ†

### æŒæ¡ pivot_table()ã€stack()ã€unstack()çš„æ—¶æœºå’Œæ–¹å¼

towardsdatascience.com](/meet-the-hardest-functions-of-pandas-part-i-7d1f74597e92) [](/meet-the-hardest-functions-of-pandas-part-ii-f8029a2b0c9b) [## è®¤è¯†ç†ŠçŒ«æœ€éš¾çš„åŠŸèƒ½ï¼Œç¬¬äºŒéƒ¨åˆ†

### æŒæ¡äº¤å‰è¡¨çš„æ—¶é—´å’Œæ–¹å¼()

towardsdatascience.com](/meet-the-hardest-functions-of-pandas-part-ii-f8029a2b0c9b) [](/ever-wanted-progress-bars-in-jupyter-bdb3988d9cfc) [## æƒ³è¦ Jupyter çš„è¿›åº¦æ¡å—ï¼Ÿ

### å¯¹ä½ çš„é•¿æ—¶é—´å¾ªç¯è¿›è¡Œå¥å…¨æ€§æ£€æŸ¥(å’Œä¸€ç‚¹è§†è§‰é£æ ¼)

towardsdatascience.com](/ever-wanted-progress-bars-in-jupyter-bdb3988d9cfc) [](/from-kagglers-best-project-setup-for-ds-and-ml-ffb253485f98) [## æ¥è‡ª Kagglers:DS å’Œ ML çš„æœ€ä½³é¡¹ç›®è®¾ç½®

### æ¥è‡ªé¡¶çº§ Kagglers çš„é¡¹ç›®æˆåŠŸæœ€ä½³å®è·µçš„é›†åˆ

towardsdatascience.com](/from-kagglers-best-project-setup-for-ds-and-ml-ffb253485f98) [](/how-i-customarily-bin-data-with-pandas-9303c9e4d946) [## æˆ‘ä¹ æƒ¯å¦‚ä½•å°†æ•°æ®ä¸ç†ŠçŒ«ç»‘å®š

### æ‚¨å¯èƒ½åªä½¿ç”¨äº†é»˜è®¤å€¼

towardsdatascience.com](/how-i-customarily-bin-data-with-pandas-9303c9e4d946) [](/masteriadsf-246b4c16daaf) [## æŒæ¡è¿æ¥:Pandas åˆå¹¶ã€è¿æ¥ã€è¿½åŠ æ–¹æ³•

### ä»åŠè¿æ¥/åè¿æ¥åˆ°éªŒè¯æ•°æ®åˆå¹¶

towardsdatascience.com](/masteriadsf-246b4c16daaf)