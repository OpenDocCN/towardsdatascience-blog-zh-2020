# 循环一致对抗网络的温和介绍

> 原文：<https://towardsdatascience.com/a-gentle-introduction-to-cycle-consistent-adversarial-networks-6731c8424a87?source=collection_archive---------16----------------------->

## 由于图像问题和损失函数，不成对图像到图像的翻译是最有趣和最具挑战性的课题。

![](img/a45c1b9c41509c92e6583652057b9b2f.png)

循环一致对抗网络的图像到图像翻译(来源:使用循环一致对抗网络的不成对图像到图像翻译)

通过这篇文章，我们旨在了解什么是循环 GAN 以及这种模型的现有应用是什么。我们给出的场景是输入一个图像，输出是这个输入图像的不同版本，根据我们的指导方针进行更改。该翻译的基本目标是使用训练集学习输入图像和输出图像之间的映射。在缺少成对数据的情况下将图像从 X 平移到 Y 的初始方法。因此该模型包含两个函数 G: X -> Y 和 F: Y -> X，其中 X 是源域，Y 是目标域。

关于这种技术，我们应该知道的第一件事是，它使用了生成式对抗网络。在这种情况下，我们有两个神经网络相互竞争。因此，生成器试图创建一个真实的图像和鉴别器，它试图了解真实和虚假图像之间的差异。循环一致性损失函数被引入到优化问题中，这意味着如果我们将斑马图像转换成马图像，然后再转换回斑马图像，我们应该得到完全相同的输入图像。

这个美丽概念背后的技术是**生成对抗网络。**

生成对抗网络(GANs)是由两个网络组成的深度神经网络架构，其中一个网络对抗另一个网络。
2014 年，蒙特利尔大学的 Ian Goodfellow 和其他研究人员在一篇论文中介绍了 gan。

# 我们为什么使用 CycleGAN

提出了循环 GAN 体系结构，即不成对的图像到图像翻译循环一致对抗网络。Jan-Yan Zhu 和他的同事(2017)建议:
PIX2PIX 可以产生真正惊人的结果，但挑战在于训练数据。根据我们要翻译的图像，将一个图像转换成另一个图像有点困难，也很耗时，不可行，甚至有时是不可能的(两个图像之间一对一的匹配)。这就是 CycleGAN 的用武之地。

CycleGAN 背后的关键思想是，它们允许你将模型指向两个不成对的图像集合。例如，一组图像，A 组是斑马，而另一组是马。所以 Cycle-GAN 模型可以学习翻译不成对的图像。

![](img/9d19e77740ac4eab045e0bb82632f12b.png)

甘循环的简单翻译

**G 的作用:** G 试图**将** X 翻译成输出，输出通过 Dy 馈入，根据域 y 检查是真是假

F 的**角色:** F 试图**将** Y 翻译成输出，这些输出通过 Dx 馈入，以检查它们是否与域 x 无法区分

这个项目的主要部分是循环一致性损失，例如，如果我们的输入图像 A 来自域 X，通过生成器 G 转换为目标图像或域 Y 的输出图像 B，然后域 Y 的图像 B 通过生成器 f 转换回域 X，此时这两个图像之间的差异称为循环一致性损失。
这种方法需要创建两对生成器和鉴别器:一对用于 A2B(源到输出转换)，另一对用于 B2A(输出到源转换)。

![](img/593b2b4aaa85c05c99cd9460d26ef2e8.png)

Cycle-GAN 的简化架构(来源:Hardik Bansal on GAN)

因此，如果我们考虑在那个循环中将图像从源域转换到目标域(马转换成斑马)的例子，g an 需要两个生成器。
发电机 A2B 把马变成了斑马，B2A 把斑马变成了马。
两者一起训练，保证输入的马图像和生成的斑马图像。
两个鉴别器确定马和斑马的真假图像。

# 建造发电机

发电机可以在下图中看到。

发电机有三个部分:

I .编码器(提取特征)

第一步是通过卷积网络从图片中分离出高光。作为输入，卷积网络拍摄一张图片，我们在输入图片上移动以提取特征的过滤窗口的大小，以及选择每次前进后我们将移动过滤窗口的量的步长。每个卷积层都提示提取动态更高级别的高光。

二。变压器(添加先前的结果)

你可以看到这些层通过图像的特征连接不同的细节，然后根据这些特征决定如何改变图片的元素编码，从一个开始到下一个。为此，我们使用了 6 到 9 层 resnet 块，如下所示:

Resnet 块是一个神经网络层，由两个卷积层组成，其中信息的累积被添加到产量中。这样做是为了保证过去层的贡献的属性对于后面的层是可访问的，并且目标是它们的产出不会偏离唯一信息太多，在任何情况下，唯一图片的质量都不会保持在产出中，并且结果将是意想不到的。这项任务的一个要点是保持独特信息的特征，如文章的大小和状态，所以遗留系统非常适合这种变化。Resnet 块可以在随附的图像中勾勒出来。

三。解码器(解码结果)

解码步骤是步骤 1 的特定逆步骤，我们将从元素向量再次返回低级特征。这是通过应用反卷积(或转置卷积)层来完成的。

![](img/3bbbda8e41ecc414f8c887708d044f95.png)

发电机的高级结构(来源:GAN 上的 Hardik Bansal)

# 构建鉴别器

现在我们有了一个发电机，下一个目标是制造一个鉴别器。我们之前定义了如何创建一个生成器，同时，我们还需要构建一个鉴别器。鉴别者会拍摄图像，并试图预测它是真的还是假的。下图显示了一个生成器。

![](img/09b0ef34aa5a42bb7aaf8f6563da13b8.png)

鉴别器的高级结构(来源:GAN 上的 Hardik Bansal)

因为我们的情况鉴别器只是一个网络。我们需要做的是从输入图片中提取特征。然后，我们的下一个目标是检查这些特征是否依赖于这些分类。

# 损失函数

现在我们有了两个发生器和两个鉴别器，所以我们的下一个目标是以某种方式设计损失函数来实现我们的目标。损失函数可以看到有一些部分:
I .第一步是 D 必须接受所有类别的所有图像。

二。第二步是拒绝所有生成器试图欺骗他们的图像。

三。生成器试图批准来自鉴别器的所有图像来愚弄他们。

四。生成的图像返回原始图像，因此生成器使用 A→B 生成一个假图像，然后我们几乎肯定应该使用另一个生成器 B→A 返回到一个唯一的图像——它必须满足循环一致性。

# 循环损失

最关键的损失之一是循环损失。我们可以使用另一个生成器来获得原始图像，并且初始图像和最后图像之间的差异应该尽可能小。

# 目标函数

周期目标函数的两个组成部分，对抗性损失和周期一致性损失

![](img/171c707e8cbfc32fdfa7bf0838a1e741.png)![](img/3bd611a51f80b406216701661ef0fcc3.png)

单独的对抗损失不足以产生好的图像，但是循环一致性损失解决了这个问题。

![](img/8b815d039e476fd782a0c37fc0305fe4.png)

现在，我们可以通过将这些损失项放在一起，并用超参数λ对循环一致性损失进行加权，来创建完整的目标函数。我们建议设置λ = 10

![](img/585eeb201eac668117643ad50c516563.png)

# 减少模型振荡

*   为了防止模型从一次迭代到另一次迭代发生剧烈变化，鉴别器被输入生成图像的历史，而不仅仅是由最新版本的生成器生成的图像。
*   为此，我们保存了 50 张最近生成的图像。基于这种技术，我们减少了模型振荡以及模型过拟合。

# 优化算法

优化算法用于更新权重和偏差，即模型的内部参数，以减少误差。它们可以分为两类:

1.  恒定学习率算法:

2.自适应学习算法:

使用优化函数:

有不同优化函数

1.  随机梯度下降
2.  阿达格拉德
3.  圣经》和《古兰经》传统中）亚当（人类第一人的名字

Adam 代表*自适应矩估计。* Adam 是深度学习领域的一种流行算法，因为它能快速取得好的结果。

在训练的前半部分，学习率被设置为 0.0002，然后在剩余的迭代中线性降低到零。

就像最初的 GAN 实现一样，我们将创建单独的优化器，这些优化器只能更新网络的某些部分。我们希望两个网络都变得更好。

我们将在这里做同样的事情，只是现在我们有 3 个网络要优化，因此我们需要 3 个优化器:

G_xy 和 G_yx 变量将作为生成器进行优化，

而 D_x 和 D_y 应该更新两个不同的鉴别器。

# 应用

I .复活古城:将巴比伦(伊拉克)、耶路撒冷和伦敦的古代地图转换为现代谷歌地图和卫星视图。

二。动物调整:把黑熊翻译成熊猫。

三。肖像到娃娃脸:王座游戏角色看起来像一个洋娃娃。

四。脸↔拉面:与 CycleGAN 一起表演了一场神奇而欢闹的脸↔拉面翻译。

动词 （verb 的缩写）彩色传统照片:把黑白照片变成彩色版本。

不及物动词将堡垒之夜转换为 PUBG:使用 CycleGAN 在堡垒之夜和 PUBG 这两个拥有数亿用户的流行皇家战役游戏之间进行翻译。现在你可以在一个游戏的视觉效果中享受另一个游戏的游戏性。

# 摘要

这是对循环持续对抗网络的温和介绍。循环氮化镓是一个开放的研究领域，在这个领域还有很多工作要做

CycleGAN 是通过 GAN 架构利用来自两个不同区域的不成对图片集合来训练无监督图像翻译模型的过程。

图像到图像的翻译解释包括图像的受控改变，并且需要组合图像的巨大数据集，这些数据集令人难以置信地难以准备好或者偶尔不存在。

在我的下一篇文章中，我将简要描述定义循环 GAN 的数学方法以及提高循环 GAN 模型效率的一些步骤。

# 感谢阅读！

随时给我发信息。

Twitter:aamirjarda
LinkedIn:aamirjarda
insta gram:aamirjarda

你有什么问题吗？
请在下面的评论中提出你的问题，我会尽力回答。