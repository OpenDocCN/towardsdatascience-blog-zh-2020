<html>
<head>
<title>Predict Missing Values in the Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测数据集中缺失的值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predict-missing-values-in-the-dataset-897912a54b7b?source=collection_archive---------10-----------------------#2020-07-26">https://towardsdatascience.com/predict-missing-values-in-the-dataset-897912a54b7b?source=collection_archive---------10-----------------------#2020-07-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/3b53ad58562ba0124306b2753b7659e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WCzV1rjy2aWzjHm7"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">弗兰基·查马基在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="a0ee" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">了解如何使用机器学习模型及其实现来预测数据集中的缺失值</h2></div><p id="574e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">真实世界的数据通常有很多缺失值。丢失值的原因可能是数据损坏或未能记录数据。在数据集的预处理过程中，缺失数据的处理非常重要，因为许多机器学习算法不支持缺失值。</p><p id="3356" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有多种策略可以处理数据集中的缺失值，包括缺失值的预测。本文将介绍如何理解和实现通过使用机器学习算法预测缺失值来处理缺失值。</p><p id="99ed" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">缺少值的列的类别:</p><ol class=""><li id="7ac7" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">分类(数字，对象)</li><li id="8ba9" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">连续变量(数值)</li></ol><p id="e80f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">分类变量:</strong></p><p id="cb2f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">分类变量是一个变量，它可以取有限的、通常是固定的可能值。分类变量可以是字符串或数字类型。分类变量的一些可能的例子是:</p><ul class=""><li id="becf" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt mi ma mb mc bi translated">产品评级:1、2、3、4、5</li><li id="e8c9" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt mi ma mb mc bi translated">分类评级:差、满意、好、优秀</li><li id="5ad0" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt mi ma mb mc bi translated">性别:男，女</li></ul><p id="c5e9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">连续变量:</strong></p><p id="c53f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">连续变量是可以取不可数的一组值的变量。例如，在实数的非空范围内的变量是连续的，如果它可以取该范围内的任何值。</p><blockquote class="mj mk ml"><p id="218b" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">为了预测分类变量，需要分类机器学习算法，如<strong class="la jk">逻辑回归、SVM、朴素贝叶斯</strong>等。</p><p id="2a26" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">要预测连续变量，需要回归机器学习算法，如<strong class="la jk">线性回归、SVR </strong>等。</p></blockquote><div class="is it gp gr iu mq"><a rel="noopener follow" target="_blank" href="/7-ways-to-handle-missing-values-in-machine-learning-1a6326adf79e"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd jk gy z fp mv fr fs mw fu fw ji bi translated">机器学习中处理缺失值的 7 种方法</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">处理数据集中缺失值的常用策略</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">towardsdatascience.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne ja mq"/></div></div></a></div></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><p id="8b16" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">准备数据集以预测缺失值:</strong></p><blockquote class="mj mk ml"><p id="88db" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated"><em class="jj">使用的数据是来自 Kaggle </em>的 <a class="ae jg" href="https://www.kaggle.com/c/titanic" rel="noopener ugc nofollow" target="_blank"> <em class="jj">泰坦尼克号数据集</em> </a> <em class="jj"/></p></blockquote><p id="c725" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">若要预测数据集中缺失的值，请创建一个新的数据集，以便:</p><pre class="nm nn no np gt nq nr ns nt aw nu bi"><span id="23e0" class="nv nw jj nr b gy nx ny l nz oa"><strong class="nr jk">new_data</strong>: columns except the column with missing values<br/><strong class="nr jk">target_class</strong>: column with missing value</span></pre><figure class="nm nn no np gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ob"><img src="../Images/bd7d823c12626e3c4e86c85bb07a68e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fhis8LkM0hjKSHkZfCtw5Q.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">(图片由作者提供)，泰坦尼克号数据集样本</p></figure><figure class="nm nn no np gt iv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/5d914c2c058b06f9a04bc73a514a6173.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*OKS-wpgQ8naBCPVmafPlIQ.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">(图片由作者提供)，泰坦尼克号数据集的信息</p></figure><p id="c727" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的样本数据集图像中，列<strong class="la jk"> Age，Cabin，Embarked </strong>包含空值或缺失值。</p><p id="d337" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们首先要估算列<strong class="la jk"> Age 的缺失值，</strong>用于训练模型以预测缺失值的新数据集将为:</p><pre class="nm nn no np gt nq nr ns nt aw nu bi"><span id="3588" class="nv nw jj nr b gy nx ny l nz oa"><strong class="nr jk">new_data</strong>: columns except the column "Age"<br/><strong class="nr jk">target_class</strong>: column "Age"</span></pre><p id="7217" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们需要将数据分为训练数据和预测数据，在列<strong class="la jk">年龄</strong>中没有缺失值的行将被声明为训练数据。从以上形成的数据集训练的模型可用于预测<strong class="la jk">年龄列中的缺失值。</strong></p><pre class="nm nn no np gt nq nr ns nt aw nu bi"><span id="4138" class="nv nw jj nr b gy nx ny l nz oa"><strong class="nr jk">training_data</strong>: rows from new_data where column "Age" does not have missing values<br/><strong class="nr jk">predict_data</strong>: rows from new_data where column "Age" have missing values<br/><strong class="nr jk">target_class_traing</strong>: non-missing values in column "Age"</span></pre><p id="98d6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">栏目关联:</strong></p><p id="0dda" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们是否需要在具有所有剩余列的数据集上训练模型？有时，使用所有剩余列的训练模型比某些列更好地预测缺失值，但有时某些高度相关的列，由选择性高度相关列训练的模型往往会给出更好的结果。</p><p id="ea23" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">如何找到列之间的关联？</strong></p><p id="2eea" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae jg" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.corr.html" rel="noopener ugc nofollow" target="_blank"> Pandas 库</a>有一个简单的单行实现来查找数据帧中所有列的相关性。</p><figure class="nm nn no np gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi od"><img src="../Images/e39a818ac274d3be4c5edb905dbea25e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kRskt-52m20q5bt5QwacQQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">(图片由作者提供)，Titanic 数据集中列之间的皮尔逊相关结果</p></figure><pre class="nm nn no np gt nq nr ns nt aw nu bi"><span id="4f54" class="nv nw jj nr b gy nx ny l nz oa">data.corr()</span></pre><blockquote class="mj mk ml"><p id="4450" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">上图显示了每列之间的<a class="ae jg" href="https://en.wikipedia.org/wiki/Pearson_correlation_coefficient" rel="noopener ugc nofollow" target="_blank">皮尔逊相关</a>系数值。PCC 测量两个变量<em class="jj"> X </em>和<em class="jj"> Y </em>之间的线性<a class="ae jg" href="https://en.wikipedia.org/wiki/Correlation" rel="noopener ugc nofollow" target="_blank">相关性</a>。它的值介于+1 和-1 之间。值+1 表示完全正线性相关，0 表示没有线性相关，1 表示完全负线性相关。</p></blockquote><p id="c011" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">计算列<strong class="la jk">年龄</strong>和其他列之间的相关性，以找到与列<strong class="la jk">年龄相关的列。</strong>从上表中可以看出，有 3 列与<strong class="la jk">列年龄相关。</strong></p><blockquote class="mj mk ml"><p id="ecee" class="ky kz mm la b lb lc kk ld le lf kn lg mn li lj lk mo lm ln lo mp lq lr ls lt im bi translated">这些列是<strong class="la jk">Pclass</strong>(PCC:-0.369226)<strong class="la jk">SibSp</strong>(PCC:-0.308247)<strong class="la jk">Parch</strong>(PCC:-0.189119)。</p></blockquote><p id="0d45" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">将数据集拆分成训练和预测数据:</strong></p><p id="2fde" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">选择与列年龄相似的 3 列，形成总共 891 行的数据集。</p><figure class="nm nn no np gt iv gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/c439c12162df7c5b2fe488930dc00968.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*UE2fIdQxNY643F1k9Ni8MA.png"/></div></figure><p id="0e3a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">分隔具有空值或缺失值的行以进行预测。</p><figure class="nm nn no np gt iv gh gi paragraph-image"><div class="gh gi of"><img src="../Images/9a4d24261995b60db48c716f4add789b.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*0__tVMF80yJUYYuTWp8QFw.png"/></div></figure><figure class="nm nn no np gt iv gh gi paragraph-image"><div class="gh gi og"><img src="../Images/9d2028d6a8826c2ba367d15f5983d297.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*ranraVUnXDmyswZlJ8NEVQ.png"/></div></figure><p id="c663" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过对 X_train 数据集进行定型并预测 column Age 中缺少的值来准备机器学习模型。</p><figure class="nm nn no np gt iv gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/73afa86ea94e3e63e63604016994c3f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*glrxHs5P3fi8F-KShtZwGA.png"/></div></figure></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><p id="6a88" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">实施:</strong></p><figure class="nm nn no np gt iv"><div class="bz fp l di"><div class="oi oj l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">(作者代码)</p></figure></div><div class="ab cl nf ng hx nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="im in io ip iq"><p id="f069" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">结论:</strong></p><p id="b7c8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每个数据集都有需要智能处理的缺失值，以创建稳健的模型。在本文中，我讨论了预测缺失值的实现。没有以特定方式或使用特定模型来处理缺失值的经验法则，这种方法可以获得具有最佳性能的健壮模型。可以使用整个数据集来预测丢失的值或一些删除的列。了解数据集的领域知识非常重要，这有助于了解如何预处理数据和处理缺失值。</p><blockquote class="ok"><p id="031c" class="ol om jj bd on oo op oq or os ot lt dk translated">感谢您的阅读</p></blockquote></div></div>    
</body>
</html>