# å…¨æ ˆç†ŠçŒ«

> åŽŸæ–‡ï¼š<https://towardsdatascience.com/full-stack-pandas-625f134ce0f6?source=collection_archive---------19----------------------->

## Python æ•°æ®åˆ†æž

## æµè¡Œæ•°æ®åˆ†æžåº“çš„é²œä¸ºäººçŸ¥çš„åŠŸèƒ½

![](img/7d60dd977cb8ff59632c1d0255962703.png)

æŸ¥å°”æ–¯Â·é›·åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ç…§ç‰‡

> æˆ‘æ‰€çŸ¥é“çš„æœ€æœ‰ä»·å€¼çš„å•†å“æ˜¯ä¿¡æ¯â€”â€”æˆˆç™»Â·ç›–æŸ¯

æˆ‘ç¡®ä¿¡æˆ‘çš„å¤§å¤šæ•°è¯»è€…éƒ½ç†Ÿæ‚‰ Python ä¸­æµè¡Œçš„ Pandas åº“ã€‚è¯¥åº“æä¾›æ•°æ®ç»“æž„æ¥å¸®åŠ©æ“ä½œå…³ç³»æ•°æ®ã€‚

Pandas æ˜¯ä¸€ä¸ªåœ¨æ•°æ®ç§‘å­¦ä»Žä¸šè€…ä¸­éžå¸¸å—æ¬¢è¿Žçš„åº“ã€‚Hackr.io è¢«è¯„ä¸ºåå¤§æ•°æ®ç§‘å­¦åº“ä¹‹ä¸€ã€‚æˆ‘æœ¬äººåœ¨å·¥ä½œå’Œä¸ªäººæ•°æ®ç§‘å­¦é¡¹ç›®ä¸­å¹¿æ³›ä½¿ç”¨ç†ŠçŒ«ã€‚

æœ¬æ–‡å°†å±•ç¤ºè¿™ä¸ªåº“çš„ä¸€äº›é²œä¸ºäººçŸ¥çš„åŠŸèƒ½ã€‚

*æ³¨:å¦‚æžœä½ æ²¡æœ‰å¤ªå¤šå’Œç†ŠçŒ«ç›¸å¤„çš„ç»åŽ†ï¼Œæˆ‘å¼ºçƒˆæŽ¨èä½ é˜…è¯»ä¸‹é¢è¿™æœ¬ä¹¦:*

[](http://shop.oreilly.com/product/0636920050896.do) [## ç”¨äºŽæ•°æ®åˆ†æžçš„ Python

### èŽ·å–åœ¨ Python ä¸­æ“ä½œã€å¤„ç†ã€æ¸…ç†å’Œå¤„ç†æ•°æ®é›†çš„å®Œæ•´è¯´æ˜Žã€‚é’ˆå¯¹ Python è¿›è¡Œäº†æ›´æ–°â€¦

shop.oreilly.com](http://shop.oreilly.com/product/0636920050896.do) 

*ç”¨äºŽæ•°æ®åˆ†æžçš„ Python*æ˜¯å…¥é—¨ç†ŠçŒ«å’Œ Numpy çš„ç»ä½³å…¥é—¨è¯»ç‰©ã€‚è¿™æœ¬ä¹¦æ˜¯ç”±ç†ŠçŒ«å›¾ä¹¦é¦†çš„åˆ›å»ºè€…éŸ¦æ–¯Â·éº¦é‡‘å°¼å†™çš„ã€‚

![](img/7b0b1f4a471b0715f88d18b11ff0eb7b.png)

æˆ‘ä¸ªäººæ”¶è—çš„ Python æ•°æ®ç§‘å­¦ç”µå­ä¹¦

## å†…å­˜ä½¿ç”¨

ç†ŠçŒ«å›¾ä¹¦é¦†æä¾›ä¸¤ç§ç±»åž‹çš„æ•°æ®ç»“æž„ï¼Œå³ç³»åˆ—å’Œæ•°æ®å¸§ã€‚

è¿™ä¸¤ä¸ªéƒ½æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«å«åš`[pandas.DataFrame.memory_usage(](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.memory_usage.html?highlight=memory_usage#pandas.DataFrame.memory_usage))`å’Œ`[pandas.Series.memory_usage()](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.memory_usage.html?highlight=memory_usage#pandas.Series.memory_usage)`ã€‚è¿™äº›æ–¹æ³•æä¾›äº†è¿™äº›æ•°æ®ç»“æž„çš„å†…å­˜ä½¿ç”¨åº¦é‡ã€‚

è¯·æ³¨æ„ï¼Œå½“æˆ‘ä»¬æ·»åŠ äº†`deep=True`é€‰é¡¹æ—¶ï¼Œè¿™äº›æ•°å­—æ˜¯å¦‚ä½•ä¸åŒçš„ã€‚è¿™æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œ`memory_usage()`æ–¹æ³•å¿½ç•¥äº†*å¯¹è±¡*çš„æ•°æ®ç±»åž‹ã€‚é€šè¿‡è®¾ç½®`deep=True`ï¼Œæˆ‘ä»¬ä¸ºç†ŠçŒ«å¯¹è±¡æ£€ç´¢ç²¾ç¡®çš„å†…å­˜å ç”¨åº¦é‡ã€‚

åœ¨å¤„ç†éžå¸¸å¤§çš„æ•°æ®é›†æ—¶ï¼Œè·Ÿè¸ªå†…å­˜ä½¿ç”¨æƒ…å†µéžå¸¸å…³é”®ã€‚é€šå¸¸ï¼Œæœºå™¨å­¦ä¹ ç ”ç©¶äººå‘˜ä¼šä»Žäº‹æ–°åž‹æœºå™¨å­¦ä¹ æ¨¡åž‹çš„åŽŸåž‹åˆ¶ä½œã€‚åœ¨è¿™æ ·çš„è¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªå¸¸è§çš„é”™è¯¯æ˜¯å¿½ç•¥ç¡¬ä»¶å®¹é‡ã€‚è·Ÿè¸ªå†…å­˜æ¶ˆè€—æœ‰åŠ©äºŽåŽ‹ç¼©ä½¿ç”¨ï¼Œä»Žè€Œç¡®ä¿é¡ºåˆ©çš„åŽŸåž‹å¼€å‘å‘¨æœŸã€‚

## è¡¨è¾¾å¼è¯„ä¼°

Pandas åº“æ”¯æŒå¯¹å…¶æ•°æ®ç»“æž„è¿›è¡Œéžå¸¸å¿«é€Ÿçš„çŸ¢é‡åŒ–æ“ä½œã€‚é€šå¸¸ï¼Œä¸šä½™æ•°æ®ç§‘å­¦å®¶ä¼šä½¿ç”¨ Python çš„æ ‡å‡†è¿ç®—ç¬¦å¯¹å¤§åž‹æ•°æ®é›†è¿›è¡Œæ•°å€¼è®¡ç®—ã€‚

ä½¿ç”¨ Pandas æä¾›çš„`[pandas.eval()](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.eval.html?highlight=eval#pandas.eval)`æ–¹æ³•å¯ä»¥æ›´æœ‰æ•ˆåœ°æ‰§è¡Œè¿™æ ·çš„è®¡ç®—ã€‚è¡¨è¾¾å¼æ˜¯é€šè¿‡æž„é€ ç­‰æ•ˆå­—ç¬¦ä¸²æ¥åˆ›å»ºçš„ã€‚
ä¸ºäº†è¯´æ˜Žè¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬åˆ›å»ºå‡ ä¸ªå„æœ‰ 100 ä¸‡è¡Œ x 100 åˆ—çš„æ ·æœ¬æ•°æ®å¸§ï¼Œå¹¶æ¯”è¾ƒè®¡ç®—ç®€å•ç®—æœ¯æ‰€éœ€çš„æ—¶é—´ã€‚

![](img/84b31b4e6c16431bf55ee06042bfd51f.png)

å¦‚æžœæˆ‘ä»¬è§‚å¯Ÿä½¿ç”¨ python æ“ä½œç¬¦ä¸Ž`pandas.eval()`è®¡ç®—ç®€å•åŠ æ³•è¿ç®—æ‰€èŠ±è´¹çš„æ—¶é—´ï¼ŒPandas æ–¹æ³•èŠ±è´¹çš„æ—¶é—´å‡ ä¹Žå°‘äº† 5 å€ã€‚

ä¸Žæ ‡å‡† Python æ“ä½œç¬¦ç›¸æ¯”ï¼Œ`pandas.eval()`æ–¹æ³•ä¸ä»…è€—æ—¶æ›´å°‘ï¼Œè€Œä¸”æ‰§è¡Œè®¡ç®—æ—¶æ¶ˆè€—çš„å†…å­˜ä¹Ÿæ›´å°‘ã€‚è¿™æ˜¯å› ä¸º Python æ“ä½œä¸ºæ¯ä¸ªä¸­é—´å­æ“ä½œåˆ†é…å†…å­˜ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå†…å­˜è¢«åˆ†é…ç»™`df_A + df_B`çš„è¾“å‡ºï¼Œç„¶åŽè¢«æ·»åŠ åˆ°`df_C`ç­‰ç­‰ã€‚

ç›¸åï¼Œåœ¨`pandas.eval()`ä¸­ï¼Œæ•´ä¸ªè¡¨è¾¾å¼ä¸€æ¬¡æ±‚å€¼ã€‚è¿™æœ‰åŠ©äºŽåŠ é€Ÿè®¡ç®—ï¼Œå°¤å…¶æ˜¯å¯¹äºŽéžå¸¸å¤§çš„æ•°æ®ã€‚é™¤äº†ç®—æœ¯è¿ç®—ï¼Œ`pandas.eval()`è¿˜æ”¯æŒä¼—å¤šå…¶ä»–è¿ç®—ã€‚

è¯·éšæ„å°è¯•ä¸åŒç±»åž‹çš„æ“ä½œï¼Œä»¥åŠ é€Ÿæ‚¨çš„æ•°æ®åˆ†æžé¡¹ç›®ã€‚

## è¯¢é—®

é™¤äº†è¡¨è¾¾å¼æ±‚å€¼å™¨ï¼ŒPandas dataframe è¿˜æœ‰ä¸€ä¸ªåä¸º`pandas.DataFrame.query()`çš„æŸ¥è¯¢æ–¹æ³•ã€‚å½“ä½¿ç”¨è¿™ç§æ–¹æ³•æ—¶ï¼Œä»Ž SQL èƒŒæ™¯è¿‡æ¸¡åˆ° Python çš„æ•°æ®ç§‘å­¦å®¶å°†ä¼šç‰¹åˆ«æ¿€åŠ¨ã€‚

`query()`æ–¹æ³•ä¸ºæˆ‘ä»¬æä¾›äº†è¿‡æ»¤æ•°æ®å¸§çš„éžå¸¸æœ‰æ•ˆçš„æ–¹æ³•ã€‚ç±»ä¼¼äºŽ`eval()`æ–¹æ³•ï¼Œ`query()`æ–¹æ³•å°†å­—ç¬¦ä¸²å½¢å¼çš„è¡¨è¾¾å¼ä½œä¸ºè¾“å…¥ã€‚

æŸ¥è¯¢æ–¹æ³•æ˜¯ä¸€ç§æžå…¶ç®€å•ä½†åŠŸèƒ½å¼ºå¤§çš„å¤„ç†æ•°æ®çš„æ–¹æ³•ã€‚å®ƒçš„å¥½å¤„ä¸Ž`eval()`ç›¸ä¼¼ï¼ŒèŠ±è´¹çš„æ—¶é—´æ›´å°‘ï¼Œæ¶ˆè€—çš„å†…å­˜ä¹Ÿæ›´å°‘ã€‚
åœ¨ä¼ ç»Ÿæ–¹æ³•ä¸­ï¼Œä¸Šé¢çš„æŸ¥è¯¢ç”¨ Python å†™æˆè¿™æ ·:

`df[(df[â€˜adultsâ€™] > 2) && (df[â€˜lead_timeâ€™] < 40)]`

æˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œä¸Ž query ç›¸æ¯”ï¼Œä¼ ç»Ÿæ–¹æ³•çœ‹èµ·æ¥ç›¸å½“ä¸‘é™‹ã€‚å› æ­¤ï¼Œåœ¨ä»£ç å®¡æŸ¥æœŸé—´ï¼ŒæŸ¥è¯¢æ–¹æ³•ä¹Ÿä½¿å®¡æŸ¥è€…çš„ç”Ÿæ´»æ›´åŠ è½»æ¾ã€‚

## æ’å…¥æ–‡å­—

ç†ŠçŒ«æœ‰å¾ˆå¤šæ–¹æ³•æ¥å¤„ç†ç¼ºå¤±å€¼ã€‚ä¸€äº›æ¯”è¾ƒæµè¡Œçš„æ–¹æ³•åŒ…æ‹¬`isna()`ã€`dropna()`ã€`fillna()`æ³•ã€‚

é™¤äº†å‰é¢æåˆ°çš„æ–¹æ³•ï¼ŒPandas è¿˜æœ‰ä¸€ä¸ª`pandas.interpolate()`æ–¹æ³•ï¼Œåœ¨ä¸¢å¤±çš„æ•°æ®ç‚¹æ‰§è¡Œ[æ’å€¼](https://en.wikipedia.org/wiki/Interpolation)ã€‚

å½“éœ€è¦å¯¹æ•°å€¼ç¼ºå¤±å€¼è¿›è¡Œå¿«é€Ÿ[æ’è¡¥](https://en.wikipedia.org/wiki/Imputation_%28statistics%29)æ—¶ï¼Œè¿™ç§æ–¹æ³•éžå¸¸æœ‰ç”¨ã€‚æ­¤å¤–ï¼Œ`interpolate()`è¿˜å¯ä»¥å¸®åŠ©ä¼°è®¡æ•°ç»„ä¸­å…¶ä»–ä¸¤ä¸ªæ•°å€¼é¡¹ä¹‹é—´çš„å€¼ã€‚æ’å€¼åœ¨è¾“å…¥æ³•åºåˆ—åˆ†æžä¸­æœ‰é‡è¦çš„åº”ç”¨ï¼Œæˆ‘ä»¬ä¸ä¼šåœ¨è¿™ç¯‡æ–‡ç« ä¸­è®¨è®ºã€‚

![](img/8f49aad89deaf607a5a7634d31610bf8.png)![](img/f6b8f6070ab69e40497b54f4d29dc092.png)

æ’å€¼å‰ä¸Žæ’å€¼åŽ

`interpolate()`æ‹¥æœ‰ä¸€å¥—å¼ºå¤§çš„æ•°æ®æ’å€¼æ–¹æ³•ã€‚è¯¥æ–¹æ³•å……å½“æµè¡Œçš„ Python ç§‘å­¦è®¡ç®—åº“ [SciPy](https://www.scipy.org/) çš„æ’å€¼æ–¹æ³•çš„åŒ…è£…å™¨ã€‚

æˆ‘å¼ºçƒˆæŽ¨èé˜…è¯»è¿™ä¸ªæ–¹æ³•çš„ API å‚è€ƒï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚

## æµ‹è¯•

é€šå¸¸æƒ…å†µä¸‹ï¼Œæ•°æ®ç§‘å­¦åšå®¢(åŒ…æ‹¬æˆ‘çš„åšå®¢)åŒ…å«çš„å†…å®¹ä¸ŽèŠ±å“¨çš„ç®—æ³•ã€åº“ã€æ•°å­¦/ç»Ÿè®¡æœ‰å…³ï¼Œå¾ˆå°‘æåŠè½¯ä»¶å·¥ç¨‹åŽŸç†ï¼Œå¦‚[è®¾è®¡](https://en.wikipedia.org/wiki/Software_design)å’Œ[å•å…ƒæµ‹è¯•](https://en.wikipedia.org/wiki/Unit_testing)ã€‚å› æ­¤ï¼Œæˆ‘æƒŠå–œåœ°å‘çŽ° Pandas æ‹¥æœ‰ä¸“æ³¨äºŽè½¯ä»¶æµ‹è¯•çš„æ–¹æ³•ã€‚

åƒ`pandas.testing.assert_frame_equal`è¿™æ ·çš„å•å…ƒæµ‹è¯•æ–¹æ³•å¯ä»¥å½¢æˆæ•°æ®åˆ†æžçš„å•å…ƒæµ‹è¯•ç®¡é“çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ã€‚

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæ–­è¨€é”™è¯¯ä½œä¸ºè¾“å‡ºï¼Œå› ä¸ºåŽŸå§‹æ•°æ®å¸§`df`çš„å‰¯æœ¬ä¸­çš„ä¸€åˆ—çš„æ•°æ®ç±»åž‹å‘ç”Ÿäº†å˜åŒ–ã€‚
åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`pandas.testing`æ–¹æ³•æ¥æµ‹è¯•*ç»´åº¦ã€ç´¢å¼•ã€åˆ—å*ç­‰ã€‚æˆ‘ä»¬çš„æ•°æ®ã€‚

ä¸‹æ¬¡ä½ ä¸ºä½ çš„ä¸ªäºº/ä¸“ä¸šæ•°æ®ç§‘å­¦é¡¹ç›®å¼€å‘ä¸€ä¸ªæµ‹è¯•é©±åŠ¨çš„å¼€å‘çŽ¯å¢ƒæ—¶ï¼Œè®°å¾—ç»“åˆè¿™äº›æ–¹æ³•ã€‚ðŸ˜‡

## å¼æ ·

Pandas çš„å¦ä¸€ä¸ªæˆ‘ç›´åˆ°æœ€è¿‘æ‰çŸ¥é“çš„ç‰¹æ€§æ˜¯é€ åž‹ APIã€‚å¯¹äºŽæ¶‰åŠä½¿ç”¨ html ç¬”è®°æœ¬æ¸²æŸ“å™¨(å¦‚ [Jupyter Notebooks](https://jupyter.org/) )äº¤æµå‘çŽ°(EDA)çš„æ•°æ®ç§‘å­¦é¡¹ç›®ï¼Œæ ·å¼ API å°¤å…¶æ–¹ä¾¿ã€‚Pandas ä¸­çš„æ ·å¼æä¾›äº†ä¸€ç§åˆ›å»ºæ¼”ç¤ºå°±ç»ªè¡¨æ ¼çš„æ–¹æ³•ï¼Œä»¥æœ‰æ•ˆåœ°äº¤æµè§è§£ã€‚

![](img/67a96fce0943a37b25e561fcaceed71f.png)

ä¸Šè¡¨æ˜¯ä»Ž Kaggle ä¸Šçš„ FIFA 19 æ•°æ®åº“ä¸­éšæœºæŠ½å–å‰ 100 åè¶³çƒè¿åŠ¨å‘˜(åŸºäºŽâ€œæ€»ä½“â€æ )åˆ›å»ºçš„ã€‚åœ¨è¿™ä¸ªå­é›†ä¸Šï¼Œæˆ‘ä»¬åº”ç”¨`pandas.DataFrame.style`çš„æ–¹æ³•æ¥å‘ˆçŽ°ä¸Šé¢æ˜¾ç¤ºçš„æ¼‚äº®è¾“å‡ºã€‚

ä»£ç å¦‚ä¸‹:

æˆ‘ä»¬çœ‹åˆ°ï¼Œä½¿ç”¨ style ä¸­çš„æ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨å¾ˆå°‘å‡ è¡Œä»£ç åˆ›å»ºæ•°æ®è¡¨çš„ç›´è§‚è¡¨ç¤ºã€‚

ä¾‹å¦‚ï¼Œ*å€¼*å’Œ*å·¥èµ„*åˆ—åœ¨æ¯ä¸ªå•å…ƒæ ¼ä¸­éƒ½æœ‰æ°´å¹³æ¡å½¢å›¾ï¼Œæ˜¾ç¤ºä¸€åè¶³çƒè¿åŠ¨å‘˜ç›¸å¯¹äºŽå…¶ä»–è¿åŠ¨å‘˜çš„ä»·å€¼å’Œå·¥èµ„ã€‚

è®©æˆ‘æƒŠè®¶çš„æ˜¯ï¼Œåœ¨ä¿ç•™æ•°æ®é›†åŽŸå§‹ç»“æž„çš„åŒæ—¶ï¼Œçªå‡ºæ˜¾ç¤ºè¿™äº›å…³é”®ä¿¡æ¯æ˜¯å¤šä¹ˆå®¹æ˜“ã€‚æ¯ä¸ªåƒç´ å‘ˆçŽ°æ›´å¤šçš„ä¿¡æ¯ï¼Œè€Œæ— éœ€æ·»åŠ å•ç‹¬çš„å¯è§†åŒ–ã€‚

# ç»“è®º

Pandas æ˜¯ Python åœ¨æ•°æ®ç§‘å­¦ä¸­å—æ¬¢è¿Žçš„æœ€å¤§å› ç´ ä¹‹ä¸€ã€‚è¿™ä¸ªå›¾ä¹¦é¦†çš„èƒ½åŠ›çœŸæ˜¯ä»¤äººéš¾ä»¥ç½®ä¿¡ã€‚

å°½ç®¡æˆ‘å·²ç»è™”è¯šåœ°ä½¿ç”¨ Pandas ä¸¤å¹´å¤šäº†ï¼Œä½†æˆ‘å¹¶ä¸çŸ¥é“å®ƒæä¾›äº†è®¸å¤šéšè—çš„åŠŸèƒ½ã€‚å¸Œæœ›ä»¥åŽèƒ½è¿›ä¸€æ­¥æŽ¢ç´¢ï¼Œå‘çŽ°æ›´å¤šä¿çš®çš„åŠŸèƒ½ã€‚

æœ¬æ–‡ä¸­ä½¿ç”¨çš„å…¶ä»–æ•°æ®é›†å¯ä»¥åœ¨ Kaggle [è¿™é‡Œ](https://www.kaggle.com/jessemostipak/hotel-booking-demand)æ‰¾åˆ°ã€‚

ä»£ç å‘å¸ƒåœ¨æˆ‘çš„ Github [è¿™é‡Œ](https://github.com/Sayar1106/TowardsDataSciencecodefiles/tree/master/FullStackPandas)ã€‚

å¦‚æžœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·åœ¨ Medium ä¸Šå…³æ³¨æˆ‘ã€‚å¦å¤–ï¼Œè¯·éšæ—¶åœ¨ [LinkedIn](https://www.linkedin.com/in/sayarbanerjee/) ä¸Šä¸Žæˆ‘è”ç³»ã€‚æœ€åŽï¼Œåœ¨è¿™äº›å›°éš¾æ—¶æœŸä¿æŒå®‰å…¨ã€‚ä¸‹æ¬¡è§ã€‚âœ‹

# å‚è€ƒèµ„æ–™:

[1][https://pandas . pydata . org/pandas-docs/stable/reference/index . html # API](https://pandas.pydata.org/pandas-docs/stable/reference/index.html#api)

[2][https://pandas . pydata . org/pandas-docs/stable/user _ guide/index . html](https://pandas.pydata.org/pandas-docs/stable/user_guide/index.html)

[3][https://www.kaggle.com/karangadiya/fifa19/data](https://www.kaggle.com/karangadiya/fifa19/data)

[https://www.kaggle.com/jessemostipak/hotel-booking-demand](https://www.kaggle.com/jessemostipak/hotel-booking-demand)

[https://pythonspeed.com/datascience/](https://pythonspeed.com/datascience/)