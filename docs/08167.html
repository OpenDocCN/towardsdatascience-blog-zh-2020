<html>
<head>
<title>The Missing Piece towards ‘any scale’ Spatial-temporal Analytics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">“任意尺度”时空分析的缺失部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-missing-piece-towards-any-scale-spatial-temporal-analytics-2677063d95e3?source=collection_archive---------76-----------------------#2020-06-15">https://towardsdatascience.com/the-missing-piece-towards-any-scale-spatial-temporal-analytics-2677063d95e3?source=collection_archive---------76-----------------------#2020-06-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="03cc" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" rel="noopener" target="_blank" href="https://towardsdatascience.com/data-science-in-the-real-world/home">现实世界中的数据科学</a></h2><div class=""/><div class=""><h2 id="ce61" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">我们为什么创建Arctern项目</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/1164eacfd1a089d6c9195f3431a83174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jluxmUgMLg1DCN3TDnvgcQ.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">由<a class="ae lh" href="https://unsplash.com/@sidverma" rel="noopener ugc nofollow" target="_blank">希德·维尔马</a>在<a class="ae lh" href="https://unsplash.com/photos/6usLW9odNjY" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="6a9a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">物联网(IoT)和5G技术将涉及数量惊人的数据，记录人、设备、事件、位置和时间之间的联系。根据IDC的预测，2025年将有416亿个物联网设备产生79.4 zettabytes的数据。随着物联网数据和物联网应用的快速增长，对高效时空数据科学工作流的需求不断增加，以从海量数据中获得洞察力。</p><p id="60c6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">可扩展性是构建高效数据科学管道的关键。为了应对这一可扩展性挑战，我们推出了Arctern，这是一个开源时空分析框架，用于提高端到端数据科学性能。Arctern旨在从两个方面提高可扩展性:</p><ol class=""><li id="808b" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md mj mk ml mm bi translated">跨不同平台(从笔记本电脑到集群和云)的统一数据分析和处理界面；</li><li id="f35b" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md mj mk ml mm bi translated">丰富且一致的算法和模型，包括轨迹处理、空间聚类和回归等。，跨越不同的数据科学管道阶段。</li></ol><p id="6b90" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">本文的其余部分探讨了当前的地理空间数据科学管道，并回顾了每个阶段使用的工具、库和系统。通过讨论现有工作流的不足，我们强调了可伸缩性的重要性。我们将展示良好的界面、算法和模型不仅可以减少解决数学或技术问题的时间，还可以提高数据科学家和工程师之间的协作和沟通效率。</p><h1 id="c067" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">时空数据科学工作流概述</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nk"><img src="../Images/4c1b8b70aeb0582e01bde45bf34da49b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VbHO9IMqDS1xgorK.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="be9b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了更好地理解当前工作流中存在的可扩展性问题，我们需要看一下时空数据科学的管道，如上图所示。原始数据首先由物联网设备生成，然后由数据存储收集。数据科学家对这些数据进行探索性分析。基于技术假设和数据特征，他们选择合适的模型来开发回答业务问题的原型。经过几次反复的评估和调整，该模型最终将部署在一个数据处理系统上，该系统进而通过物联网设备向最终用户提供更好的服务。</p><p id="a800" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">整个过程可以分为三个阶段:</p><ul class=""><li id="d0d0" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md nl mk ml mm bi translated"><strong class="lk jd"> <em class="nm">原型开发</em>。</strong>在这一阶段，数据科学家倾向于使用小型数据集，以实现快速数据探索、高效模型选择和迭代原型润色。轻量级工具在这个阶段受到青睐，因为它们可以提供快速的洞察力，并支持快速迭代。典型的工具包括NumPy、GeoPandas、scikit-learn、PySAL和kepler.gl。</li><li id="0ed9" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md nl mk ml mm bi translated"><strong class="lk jd"> <em class="nm">车型评测</em>。</strong>为了使原型适合生产环境，更大(甚至接近生产水平)的数据集被用于模型评估。因此，这个阶段的模型评估-修改迭代比原型阶段要敏捷得多。此外，工具链要重得多。大多数常用的工具，比如PostGIS和PySpark，都是基于磁盘的，或者说是分布式的。</li><li id="5a14" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md nl mk ml mm bi translated"><strong class="lk jd"> <em class="nm">车型部署</em>。</strong>部署是将模型集成到现有生产环境中提供实际服务的阶段。这一阶段涉及大规模系统，如用于存储的HDFS、Hbase、TSDB，以及用于数据处理的Spark、Flink、GeoMesa。</li></ul><h1 id="0751" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">可扩展性问题</h1><p id="f420" class="pw-post-body-paragraph li lj it lk b ll nn kd ln lo no kg lq lr np lt lu lv nq lx ly lz nr mb mc md im bi translated">在时空数据科学的不同阶段，对工具链的需求差异很大。虽然上面提到的库和系统可以共同支持整个数据科学工作流，但单个工具很难跨多个数据科学阶段或跨不同的分析平台(笔记本电脑、集群或云)扩展。结果，工具链变得越来越复杂，以至于很难简化工作流程。具体来说，挑战有三个方面:</p><ul class=""><li id="0e9c" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md nl mk ml mm bi translated"><strong class="lk jd"> <em class="nm">库(系统)接口的差距</em>。</strong>不同阶段使用的库或系统不共享统一接口。因此，数据科学家可能会在数据分析、原型开发、模型评估和模型部署的整个过程中使用多种语言，如Python、R、Scala、SQL和不一致的函数名称。这种接口不一致性极大地加剧了学习曲线，迫使数据科学家花费宝贵的时间和脑力来重写他们的代码，而不是专注于业务问题。</li><li id="10be" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md nl mk ml mm bi translated"><strong class="lk jd"> <em class="nm">算法/模型库的差距</em>。</strong>不同阶段使用的库对算法和模型的支持不同。目前，标准化协议仍处于原语级别，如开放地理空间联盟(OGC)提出的协议。这大大降低了生产率。当在原型开发期间使用高级算法作为解决方案的一部分，但没有为生产环境找到合适的实现时，必须付出巨大的努力来重新发明轮子。</li><li id="8bb1" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md nl mk ml mm bi translated"><strong class="lk jd"> <em class="nm">数据科学家和工程师的差距</em>。</strong>时空数据科学是一个复杂的领域，需要正确处理数学问题、技术问题和商业问题。它需要数据科学家和工程师之间的无缝协作。然而，整个工作流程中使用的工具的不一致性使得协作变得困难。鉴于在不同的数据科学阶段使用不同的编程语言和算法实现，工程师可能不知道数据科学家使用什么模型，而数据科学家正在努力理解为什么工程师不能让他们的模型工作。</li></ul><p id="58e6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在接下来的几节中，我们将比较时空数据科学中广泛使用的几个库和系统，并对“任意比例”时空分析中缺失的部分进行更多讨论。</p><h1 id="cf77" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">流行工具及其局限性</h1><p id="7217" class="pw-post-body-paragraph li lj it lk b ll nn kd ln lo no kg lq lr np lt lu lv nq lx ly lz nr mb mc md im bi translated">随着Python成为地理空间数据处理和分析的主要解决方案，数据科学家开发了基于工具集的词汇表，包括NumPy、Pandas、Shapely、GeoPandas、PySAL等。有了这些工具，他们可以充分表达自己的想法，并根据想法得出结论。</p><p id="61eb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Shapely是一个Python包，提供了几何数据构造、常见几何操作、关系分析和坐标系投影等原语。GeoPandas结合了Pandas和Shapely的功能，简化了python中的地理空间数据处理。它将地理空间数据组织为地理系列或地理数据框，并提供构建、分析和操作多种几何的操作。</p><p id="cdbe" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">PySAL是一个Python空间分析库，为地理空间数据的高级分析提供模块。其功能包括空间数据探索性分析，如对点、多边形格的统计测试，以及高级空间分析，如空间聚类和空间回归。</p><p id="2e38" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">尽管这些工具很受欢迎，但它们无法处理大数据。它们本来就是为独立机器上的小数据集设计的。考虑到现代笔记本电脑和工作站的容量，这些工具可以处理的数据量将高达几个千兆字节。下图显示了GeoPandas中19种常用原语的性能。正如我们所观察到的，当数据大小达到10M时，GeoPandas中的大多数原语需要几分钟才能完成。在处理大型数据集时，PySAL与GeoPandas面临同样的问题。与GeoPandas中的原语相比，PySAL中的高级算法通常具有更高的计算复杂度，从而可能导致更严重的数据分析和原型开发效率问题。由于数据科学家需要迭代地调整和验证他们的模型，直到他们得到满意的结果，这些原语和算法被频繁和重复地使用。可扩展性问题会严重降低空间数据科学工作流的效率。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nk"><img src="../Images/3fe224b7c2da90ccd0983b35428a76d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vyAARq_oJa2zm7cu.png"/></div></div></figure><p id="49a1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">由于可扩展性问题，上述工具一般用于小数据集的原型设计。为了处理大型生产级数据集，数据科学家和工程师最终需要将他们的算法迁移到分布式解决方案，如GeoSpark和GeoMesa。</p><p id="3e0c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">GeoSpark是一个集群计算系统，它通过一组空间弹性分布式数据集和SpatialSQL函数扩展了Apache Spark和SparkSQL，这些数据集和函数可以跨机器有效地加载、处理和分析大规模空间数据。GeoMesa支持分布式计算系统上的大规模地理空间查询和分析，包括时空索引、流处理和自定义分布式分析。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/2444285ecf4de9696af5a1659783f11a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*1ZKUsii6AM4DxVaiRPXN9Q.png"/></div></figure><p id="6ad3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">与GeoPandas和PySAL相比，GeoSpark和GeoMesa采用了非常不同的API抽象。上表显示了界面对比。不同工具之间的数据接口差别很大，没有一对工具共享相同的数据接口。编程语言方面，主要有三大类:python、SQL、Java/Scala。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/ddb6a784c336ea20c2adad474b4c0993.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*WIWsPG9vewNa0d-ks6yjHg.png"/></div></figure><p id="d2f4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上表比较了地理空间分析工具中提供的原语和算法。所支持的OGC标准原语的数量差异很大，从大约30个到300个不等。高级算法也显示出很大的分歧。每种工具都提供了一组有限的算法，几乎没有重叠。</p><p id="0897" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">由于数据接口、编程语言、算法和模型的显著不一致性，每当将模型原型应用于大型生产数据集时，工程师可能必须重写整个数据处理逻辑。对于空间聚类和回归等高级分析，数据科学家可能需要从头开始重新实施模型和算法。</p><h1 id="7d76" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">Arctern的方法和目前的进展</h1><p id="b4a7" class="pw-post-body-paragraph li lj it lk b ll nn kd ln lo no kg lq lr np lt lu lv nq lx ly lz nr mb mc md im bi translated">在Arctern中，为了帮助数据科学家和工程师提高生产力和创造力，我们试图通过在笔记本电脑、集群和云环境中提供具有一致接口的丰富原语、算法和模型来解决空间数据科学工具的不一致性问题。</p><p id="f748" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在我们研究的工具中，我们发现GeoPandas的接口最符合data scientist的使用习惯，并且易于使用。因此，我们采纳了它的想法，并计划构建可纵向扩展和横向扩展的地理数据框架/地理系列。在此基础上，我们将开发跨执行环境的一致的时空算法集。</p><p id="d322" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们现在已经开发了一个高效的多线程GeoSeries实现，分布式版本正在开发中。在最新版本0.2.0中，与GeoPandas相比，Arctern的速度提高了24倍。即使在单线程执行的情况下，Arctern的平均性能也是GeoPandas的7倍。详细的评估结果如下图所示。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nk"><img src="../Images/1e3764c91672347afeaca1bb4a433021.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FUquKhqbvP94AACb.png"/></div></div></figure><p id="06cb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在大型数据集的交互/探索方面，Arctern提供了可以渲染数据的渲染方法(如热图、choropleth等。)以秒为单位10M的成交量。</p><p id="505f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们还在进行时空数据分析和渲染的实验性GPU加速。到目前为止，Arctern提供了六种GPU加速的渲染方法和八种空间关系操作，比基于CPU的方法提高了36倍。</p><p id="ac59" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在接下来的几个版本中，我们的团队将专注于:</p><ul class=""><li id="8843" class="me mf it lk b ll lm lo lp lr mg lv mh lz mi md nl mk ml mm bi translated">开发GeoSeries的分布式版本。我们第一个地理数据框架/地理系列的分布式实现将基于Spark。自从Spark 3.0预览版发布以来，它就与Spark 3.0同步开发。Spark对GPU调度和基于列的处理的支持，与我们高性能时空数据处理的理念高度契合。此外，引入的考拉接口为实现一致的地理数据框架/地理系列接口提供了一个有前途的选择。</li><li id="93cb" class="me mf it lk b ll mn lo mo lr mp lv mq lz mr md nl mk ml mm bi translated">丰富了我们的时空算法集。在项目的早期阶段，我们将专注于KNN搜索和轨迹分析。</li></ul><p id="e325" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd"> <em class="nm">了解更多关于Arctern:</em></strong><a class="ae lh" href="https://github.com/arctern-io" rel="noopener ugc nofollow" target="_blank"><em class="nm">https://github.com/arctern-io</em></a></p><h1 id="15df" class="ms mt it bd mu mv mw mx my mz na nb nc ki nd kj ne kl nf km ng ko nh kp ni nj bi translated">关于作者</h1><p id="cae3" class="pw-post-body-paragraph li lj it lk b ll nn kd ln lo no kg lq lr np lt lu lv nq lx ly lz nr mb mc md im bi translated">郭仁同是Arctern项目的研发主管。他获得了中国华中科技大学(HUST)的计算机软件和理论博士学位。他参与并领导数据库、缓存系统、分布式系统和异构计算领域的项目。</p><p id="dadb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">易(音译)是Arctern项目的高级研究员。易先生毕业于华中科技大学，获得计算机体系结构博士学位。他的研究重点是云和分布式系统中的调度和资源分配。他的作品发表在著名的会议和期刊上，如IEEE Network Magazine、IEEE TON、IEEE ICDCS和ACM TOMPECS。</p></div></div>    
</body>
</html>