<html>
<head>
<title>Fraud detection: the problem, solutions and tools</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">欺诈检测:问题、解决方案和工具</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fraud-detection-the-problem-solutions-and-tools-dd8977b435c9?source=collection_archive---------5-----------------------#2020-01-26">https://towardsdatascience.com/fraud-detection-the-problem-solutions-and-tools-dd8977b435c9?source=collection_archive---------5-----------------------#2020-01-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d7c6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">机器学习如何改变欺诈检测格局</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dfd476c4a4f431f2ef7ebdb57b3d5ea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Os92EMr7Oh1lSrBK"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">瑞安·波恩在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><h1 id="8a51" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">1.1 问题的性质</h1><blockquote class="lr"><p id="a926" class="ls lt it bd lu lv lw lx ly lz ma mb dk translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Data_analysis_techniques_for_fraud_detection" rel="noopener ugc nofollow" target="_blank">“欺诈是一个价值十亿美元的行业</a></p><p id="83a3" class="ls lt it bd lu lv lw lx ly lz ma mb dk translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Data_analysis_techniques_for_fraud_detection" rel="noopener ugc nofollow" target="_blank">而且每年都在增加</a></p></blockquote><p id="de4d" class="pw-post-body-paragraph mc md it me b mf mg ju mh mi mj jx mk ml mm mn mo mp mq mr ms mt mu mv mw mb im bi translated">什么是欺诈？有许多正式的定义，但本质上欺诈是一种“艺术”，是在金融交易中欺骗和诈骗人们的犯罪。欺诈在整个人类历史中一直存在，但在这个数字技术时代，金融欺诈的策略、范围和规模变得越来越广泛，从信用卡交易到健康福利再到保险索赔。欺诈者也变得越来越有创造力。谁从来没有收到过一个尼日利亚皇室寡妇的电子邮件，说她正在寻找一个值得信任的人来移交她的大笔遗产？</p><p id="9697" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw mb im bi translated">难怪欺诈是一件大事。由于欺诈性交易，商业组织的估计损失飙升至其收入的 4-5%。5%的欺诈听起来可能不算多，但从货币角度来看，这不是小事，远远超过不采取任何行动的成本。普华永道的一项调查发现，他们调查的 7200 家公司中有 50%是某种欺诈的受害者。FICO 最近的一项研究发现，接受调查的五分之四的银行经历了欺诈活动的增加，预计这种情况在未来还会增加。</p><p id="4f4d" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw mb im bi translated">尽管许多组织采取措施打击欺诈，但欺诈永远无法根除。我们的目标是将它的影响降到最低。这种筛选的好处必须与成本进行权衡，例如，欺诈检测技术的投资和由于“假阳性”警报而可能失去的客户。</p><p id="53a9" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw mb im bi translated">因此，本文的目的是强调欺诈检测领域的一些工具、技术和最佳实践。最后，我将使用公开可用的数据集提供一个 python 实现。</p><h1 id="2465" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">1.2 个使用案例</h1><p id="2ca3" class="pw-post-body-paragraph mc md it me b mf nc ju mh mi nd jx mk ml ne mn mo mp nf mr ms mt ng mv mw mb im bi translated">欺诈无处不在——无论交易涉及到哪里——但信用卡欺诈可能是最广为人知的案例。它可以是简单的偷窃或使用偷来的卡，也可以是侵略性的形式，如账户接管、伪造<a class="ae ky" href="https://www.experian.com/blogs/ask-experian/credit-education/preventing-fraud/credit-card-fraud-what-to-do-if-you-are-a-victim/" rel="noopener ugc nofollow" target="_blank">和更多</a>。信用卡欺诈一直存在，但由于每天通过信用卡进行的在线交易越来越多，其规模只是在最近有所增长。根据<a class="ae ky" href="https://nilsonreport.com/upload/content_promo/The_Nilson_Report_10-17-2016.pdf" rel="noopener ugc nofollow" target="_blank">尼尔森报告</a>2010 年，全球欺诈金额为 76 亿美元，预计 2020 年将突破 310 亿美元。仅在英国，2018 年欺诈交易损失估计超过<a class="ae ky" href="https://en.wikipedia.org/wiki/Credit_card_fraud" rel="noopener ugc nofollow" target="_blank">10 亿美元。</a></p><p id="afcc" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw mb im bi translated">保险行业还在发生其他类型的大欺诈案件。一些估计表明，美国多达 10%的健康保险索赔可归因于欺诈，这是一个不小的数字，每年高达 1100 亿美元。</p><blockquote class="lr"><p id="7043" class="ls lt it bd lu lv lw lx ly lz ma mb dk translated">保险欺诈如此普遍，以至于有一个完整的组织叫做<a class="ae ky" href="http://www.insurancefraud.org/" rel="noopener ugc nofollow" target="_blank">反保险欺诈联盟</a>和一个杂志叫做<a class="ae ky" href="https://www.insurancefraud.org/jifa/jun-2016" rel="noopener ugc nofollow" target="_blank">保险欺诈杂志</a>来科学地研究保险业务中的欺诈。</p></blockquote><h1 id="572a" class="kz la it bd lb lc ld le lf lg lh li lj jz nh ka ll kc ni kd ln kf nj kg lp lq bi translated">2.1 数据科学解决方案</h1><p id="4927" class="pw-post-body-paragraph mc md it me b mf nc ju mh mi nd jx mk ml ne mn mo mp nf mr ms mt ng mv mw mb im bi translated">在过去(即机器学习成为趋势之前)，标准做法是使用所谓的“基于规则的方法”。由于每个规则都有例外，这种技术只能部分缓解问题。随着越来越多的在线交易和大量客户数据的产生，机器学习越来越被视为检测和反欺诈的有效工具。然而，没有一个特定的工具，银弹，适用于每个行业的各种欺诈检测问题。在每个案例和每个行业中，问题的性质是不同的。因此，每个解决方案都是在每个行业的领域内精心定制的。</p><p id="eb9b" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw mb im bi translated">在机器学习中，用语欺诈检测通常被视为一个<a class="ae ky" rel="noopener" target="_blank" href="/supervised-learning-basics-of-classification-and-main-algorithms-c16b06806cd3">监督分类</a>问题，其中根据观察结果中的特征将观察结果分类为“欺诈”或“非欺诈”。由于不平衡的数据，这也是 ML 研究中一个有趣的问题，即在极其大量的交易中很少有欺诈案例。如何处理不平衡的阶级本身是另一个讨论的主题。</p><p id="db8a" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw mb im bi translated">欺诈也可以通过几种异常检测技术来隔离。离群点检测工具有自己解决问题的方式，如<a class="ae ky" href="https://www.datasciencecentral.com/profiles/blogs/outlier-detection-with-time-series-data-mining" rel="noopener ugc nofollow" target="_blank">时间序列分析</a>，聚类分析，实时事务监控等。</p><h1 id="7f64" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">2.2 技术</h1><p id="06fc" class="pw-post-body-paragraph mc md it me b mf nc ju mh mi nd jx mk ml ne mn mo mp nf mr ms mt ng mv mw mb im bi translated"><strong class="me iu">统计技术:</strong>平均值、分位数、概率分布、关联规则</p><p id="0f77" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw mb im bi translated"><strong class="me iu">监督 ML 算法:</strong>逻辑回归、神经网络、时间序列分析</p><p id="9270" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw mb im bi translated"><strong class="me iu">无监督的 ML 算法:</strong>聚类分析、贝叶斯网络、对等组分析、断点分析、本福特定律(异常数定律)</p><h1 id="8141" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">3.一个简单的 Python 实现</h1><h2 id="3a60" class="nk la it bd lb nl nm dn lf nn no dp lj ml np nq ll mp nr ns ln mt nt nu lp nv bi translated">3.1 数据准备</h2><p id="3917" class="pw-post-body-paragraph mc md it me b mf nc ju mh mi nd jx mk ml ne mn mo mp nf mr ms mt ng mv mw mb im bi translated">对于这个简单的演示，我使用了一个流行的<a class="ae ky" href="https://www.kaggle.com/mlg-ulb/creditcardfraud" rel="noopener ugc nofollow" target="_blank"> Kaggle 数据集</a>。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="f5aa" class="nk la it nx b gy ob oc l od oe"># import libraries<br/>import pandas as pd<br/>import numpy as np</span><span id="e2ce" class="nk la it nx b gy of oc l od oe"># import data<br/>df = pd.read_csv("..\creditcard.csv")</span><span id="9cfd" class="nk la it nx b gy of oc l od oe"># view the column names<br/>df.columns</span></pre><p id="3253" class="pw-post-body-paragraph mc md it me b mf mx ju mh mi my jx mk ml mz mn mo mp na mr ms mt nb mv mw mb im bi translated">数据集有 31 列。第一列“时间”是交易时间戳，倒数第二列“金额”是交易金额，最后一列“类别”指定交易是欺诈还是非欺诈(欺诈= 1，非欺诈= 0)。其余的列，“V1”到“V28”是未知变量，在公开数据之前进行了转换。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="3210" class="nk la it nx b gy ob oc l od oe"># number of fraud and non-fraud observations in the dataset<br/>frauds = len(df[df.Class == 1])<br/>nonfrauds = len(df[df.Class == 0])</span><span id="4362" class="nk la it nx b gy of oc l od oe">print("Frauds", frauds); print("Non-frauds", nonfrauds)</span><span id="453d" class="nk la it nx b gy of oc l od oe">## scaling the "Amount" and "Time" columns similar to the others variables</span><span id="1e69" class="nk la it nx b gy of oc l od oe">from sklearn.preprocessing import RobustScaler<br/>rob_scaler = RobustScaler()</span><span id="5d80" class="nk la it nx b gy of oc l od oe">df['scaled_amount'] = rob_scaler.fit_transform(df['Amount'].values.reshape(-1,1))<br/>df['scaled_time'] = rob_scaler.fit_transform(df['Time'].values.reshape(-1,1))</span><span id="3eeb" class="nk la it nx b gy of oc l od oe"># now drop the original columns<br/>df.drop(['Time','Amount'], axis=1, inplace=True)</span><span id="21a0" class="nk la it nx b gy of oc l od oe"># define X and y variables<br/>X = df.loc[:, df.columns != 'Class']<br/>y = df.loc[:, df.columns == 'Class']</span></pre><h2 id="c1df" class="nk la it bd lb nl nm dn lf nn no dp lj ml np nq ll mp nr ns ln mt nt nu lp nv bi translated">3.2 制作子样本</h2><p id="2e02" class="pw-post-body-paragraph mc md it me b mf nc ju mh mi nd jx mk ml ne mn mo mp nf mr ms mt ng mv mw mb im bi translated">这是一个极度不平衡的数据集，所以我们需要通过所谓的欠采样进行子采样。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="c878" class="nk la it nx b gy ob oc l od oe"># number of fraud cases<br/>frauds = len(df[df.Class == 1])</span><span id="d9e7" class="nk la it nx b gy of oc l od oe"># selecting the indices of the non-fraud classes<br/>fraud_indices = df[df.Class == 1].index<br/>nonfraud_indices = df[df.Class == 0].index</span><span id="11cf" class="nk la it nx b gy of oc l od oe"># From all non-fraud observations, randomly select observations equal to number of fraud observations<br/>random_nonfraud_indices = np.random.choice(nonfraud_indices, frauds, replace = False)<br/>random_nonfraud_indices = np.array(random_nonfraud_indices)</span><span id="8e95" class="nk la it nx b gy of oc l od oe"># Appending the 2 indices<br/>under_sample_indices = np.concatenate([fraud_indices,random_nonfraud_indices])</span><span id="61cc" class="nk la it nx b gy of oc l od oe"># Under sample dataset<br/>under_sample_data = df.iloc[under_sample_indices,:]</span><span id="548c" class="nk la it nx b gy of oc l od oe"># Now split X, y variables from the under sample data<br/>X_undersample = under_sample_data.loc[:, under_sample_data.columns != 'Class']<br/>y_undersample = under_sample_data.loc[:, under_sample_data.columns == 'Class']</span></pre><h2 id="5b1a" class="nk la it bd lb nl nm dn lf nn no dp lj ml np nq ll mp nr ns ln mt nt nu lp nv bi translated">3.3 建模</h2><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="33d8" class="nk la it nx b gy ob oc l od oe">## split data into training and testing set<br/>from sklearn.model_selection import train_test_split</span><span id="8cfe" class="nk la it nx b gy of oc l od oe"># # The complete dataset<br/># X_train, X_test, y_train, y_test = train_test_split(X,y,test_size = 0.3, random_state = 0)</span><span id="0f0f" class="nk la it nx b gy of oc l od oe"># Split dataset<br/>X_train_undersample, X_test_undersample, y_train_undersample, y_test_undersample = train_test_split(X_undersample,y_undersample                                                                                                                                                                                                                                                                                             ,random_state = 0)</span><span id="dc9b" class="nk la it nx b gy of oc l od oe">## modeling with logistic regression</span><span id="9fbe" class="nk la it nx b gy of oc l od oe">#import model<br/>from sklearn.linear_model import LogisticRegression<br/># instantiate model<br/>model = LogisticRegression()<br/># fit <br/>model.fit(X_train_undersample, y_train_undersample)<br/># predict<br/>y_pred = model.predict(X_test_undersample)</span></pre><h2 id="cb0c" class="nk la it bd lb nl nm dn lf nn no dp lj ml np nq ll mp nr ns ln mt nt nu lp nv bi translated">3.4.模型验证</h2><blockquote class="lr"><p id="9a39" class="ls lt it bd lu lv lw lx ly lz ma mb dk translated">注意:不要使用准确性分数作为衡量标准。在一个具有 99.9%非欺诈观察的数据集中，您可能会在 99%的时间内做出正确的预测。混淆矩阵和精确度/召回分数是更好的度量。</p></blockquote><pre class="og oh oi oj ok nw nx ny nz aw oa bi"><span id="0ef4" class="nk la it nx b gy ob oc l od oe"># import classification report and confusion matrix<br/>from sklearn.metrics import classification_report<br/>from sklearn.metrics import confusion_matrix</span><span id="4039" class="nk la it nx b gy of oc l od oe">classification_report = classification_report(y_test_undersample, y_pred)<br/>confusion_matrix = confusion_matrix(y_test_undersample, y_pred)</span><span id="f205" class="nk la it nx b gy of oc l od oe">print("CLASSIFICATION REPORT")<br/>print(classification_report)<br/>print("CONFUSION MATRIX") <br/>print(confusion_matrix)</span></pre><h2 id="8448" class="nk la it bd lb nl nm dn lf nn no dp lj ml np nq ll mp nr ns ln mt nt nu lp nv bi translated"><em class="ol">结束注意:</em></h2><p id="16ee" class="pw-post-body-paragraph mc md it me b mf nc ju mh mi nd jx mk ml ne mn mo mp nf mr ms mt ng mv mw mb im bi translated"><em class="om">感谢您通读这篇文章。一个 Jupyter 笔记本连同 python 演示可以在</em><a class="ae ky" href="https://github.com/mabalam/FraudDetection" rel="noopener ugc nofollow" target="_blank"><em class="om">GitHub repo</em></a><em class="om">中找到。可以通过</em><a class="ae ky" href="https://twitter.com/DataEnthus" rel="noopener ugc nofollow" target="_blank"><em class="om">Twitter</em></a><em class="om">或</em><a class="ae ky" href="https://www.linkedin.com/in/mab-alam/" rel="noopener ugc nofollow" target="_blank"><em class="om">LinkedIn</em></a><em class="om">联系到我。</em></p></div></div>    
</body>
</html>