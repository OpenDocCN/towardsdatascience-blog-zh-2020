<html>
<head>
<title>Natural Language Processing: Intelligent Search through text using Spacy and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自然语言处理:使用 Spacy 和 Python 智能搜索文本</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/natural-language-processing-document-search-using-spacy-and-python-820acdf604af?source=collection_archive---------4-----------------------#2020-08-14">https://towardsdatascience.com/natural-language-processing-document-search-using-spacy-and-python-820acdf604af?source=collection_archive---------4-----------------------#2020-08-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0212" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 Python 和机器学习从文本中提取有用信息</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5dbbacd3f6c888fa044889ad1f29d9f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JuHKUK0OzsMsZX7iduBwOA.png"/></div></div></figure><p id="c25d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在文本中搜索是自然语言领域中机器学习应用的关键焦点领域之一。</p><p id="1b7b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="lq">但是如果我们必须从一个大文档(100+页)中搜索多个关键词呢？此外，如果我们在我们的文档中进行了上下文搜索(搜索相似含义的关键字),该怎么办！</em></strong><em class="lq">——</em>传统的“CTRL + F”解决方案要么需要很长时间来完成这项任务(或者在上下文搜索的情况下，将无法找到任何有意义的文本)。</p><p id="8ac5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">本文将帮助读者理解我们如何使用 Spacy(一个强大的开源 NLP 库)和 Python 来使用机器学习解决这个问题。</p><h1 id="89ea" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">数据预处理</h1><p id="8987" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">构建任何基于机器学习的解决方案的第一步是预处理数据。在我们的例子中，我们将使用 Python 中的 PyPDF2 包预处理 PDF 文档，然后将整个文本转换成 Spacy 文档对象。对于没有使用过 Spacy 的读者来说，这是一个高级的 Python 开源库，用于各种 NLP 任务。对于有兴趣了解 Spacy 更多信息的用户，请参考此链接阅读文档并了解 Spacy 更多信息—<a class="ae mo" href="https://spacy.io/" rel="noopener ugc nofollow" target="_blank">https://spacy.io/</a></p><p id="343e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将首先加载 PDF 文档，清理文本，然后将其转换为 Spacy 文档对象。以下代码可用于执行此任务-</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mp mq l"/></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">数据预处理</p></figure><p id="534e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，我们必须加载 Spacy 的'<strong class="kw iu"> en_core_web_lg </strong>'模型，这是 Spacy 中提供的一个预先训练好的英语语言模型。Spacy 还提供了对多种语言的支持(更多信息可以在文档链接中找到)。此外，Spacy 有多种型号(小型、中型和大型),对于我们的情况，我们将使用大型型号，因为我们必须使用仅大型型号支持的单词向量。</p><p id="d323" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">'<strong class="kw iu"> setCustomBoundaries() </strong>'用作客户句子分割方法，与默认选项相反。同样的方法可以根据我们处理的单据进行修改。</p><p id="fabd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一旦我们准备好了空间的文档对象，我们就可以进入下一步，处理需要在文档中搜索的输入查询(关键字)。</p><h1 id="2034" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">处理查询-查找相似的关键字</h1><p id="7f62" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">在进入编码部分之前，让我们看一下为了从我们正在搜索的文档中获得更准确的搜索结果而采用的更广泛的方法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/4bc84fc9b38fa70605667bed9f51546c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R5d61hBn70Me4CdK2WaX6g.png"/></div></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">流程工作流</p></figure><p id="eab3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">直到数据预处理阶段，我们已经将 PDF 文档文本转换为 Spacy 的文档对象。现在，我们还必须将我们的关键字转换为 Spacy 的文档对象，将它们转换为等价的向量形式((300，)维)，然后使用余弦相似度来查找相似的关键字。最后，我们将有一个类似的关键字以及原始关键字的详尽列表，我们现在可以通过搜索我们的文档来生成准确的结果。</p><p id="6295" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请参考以下代码来执行此任务-</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mp mq l"/></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">生成相似的关键字</p></figure><p id="510d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">既然我们已经找到了与原始关键字上下文相似的单词，让我们开始最后的搜索部分。</p><h1 id="2ec6" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated"><strong class="ak">通过文本搜索关键词</strong></h1><p id="d094" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">对于搜索，我们将使用 Spacy 的 Matcher 类的 PhraseMatcher 类。此时，重要的是要记住 Spacy 的文档对象不同于简单的 python 字符串，因此我们不能直接使用 if then else 来查找结果。</p><p id="8a53" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请参考以下代码来执行此任务-</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mp mq l"/></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">在文本中搜索</p></figure><p id="7249" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">上面的代码将搜索整个文本中的每个关键字，并在找到匹配的地方返回整个句子。</p><p id="ed82" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">上述代码将生成以下输出-</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/1f8fd8a0f486be12e657d8f11a0709a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B3kDqR5UU-RLRYogaxEjug.png"/></div></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">搜索输出截图</p></figure><p id="b13f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以增加或减少想要为任何原始关键词查找的相似关键词的数量。此外，一旦在数据帧中获得结果，您可以简单地添加更多的逻辑来对结果进行排序(给精确的关键字匹配更多的权重，等等)。</p><blockquote class="mx my mz"><p id="c4d3" class="ku kv lq kw b kx ky ju kz la lb jx lc na le lf lg nb li lj lk nc lm ln lo lp im bi translated">注意:增加相似关键字的数量可能会增加整个程序的计算成本，因此应该明智地选择。</p></blockquote><p id="71be" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这就是你如何创建你自己的基于 ML 的 Python 程序来搜索任何文本。</p><p id="bd51" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在任何其他输入源(照片、网页等)的情况下。)你只需要定制数据预处理部分(OCR，网页抓取等。)和其余的逻辑应该执行得很好。</p></div></div>    
</body>
</html>