<html>
<head>
<title>How I would explain building â€œLightFM Hybrid Recommendersâ€ to a 5-year old!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æˆ‘å°†å¦‚ä½•å‘ä¸€ä¸ª 5 å²çš„å­©å­è§£é‡Šæ„å»ºâ€œLightFM æ··åˆæ¨èå™¨â€!</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/how-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309?source=collection_archive---------4-----------------------#2020-07-05">https://towardsdatascience.com/how-i-would-explain-building-lightfm-hybrid-recommenders-to-a-5-year-old-b6ee18571309?source=collection_archive---------4-----------------------#2020-07-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="52c0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">æ„å»ºç”¨æˆ·/é¡¹ç›®åŠŸèƒ½ä»¥è§£å†³å†·å¯åŠ¨é—®é¢˜å¹¶é¢„æµ‹æ–°ç”¨æˆ·è¯„çº§çš„ç¤ºä¾‹ã€‚</h2></div><p id="6acc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">æ³¨æ„:5 å²çš„å­©å­å¿…é¡»æŒæ¡ Python çš„å·¥ä½œçŸ¥è¯†ï¼</em></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/880d0b221c1017f31cb27a7be0e009fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*IK15sp_OV8tTDqNH3UvZ2A.jpeg"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">æ¥æº:ä½œè€…åœ¨<a class="ae lr" href="https://imgflip.com/i/47bj0b" rel="noopener ugc nofollow" target="_blank"> imgflip </a>ä¸Šåˆ›å»º</p></figure><h1 id="7b84" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">ä¸ºä»€ä¹ˆå¯¹å†·å¯åŠ¨é—®é¢˜å¤§æƒŠå°æ€ªï¼Ÿ</h1><p id="31ca" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">åœ¨æ¨èç³»ç»Ÿä¸­ï¼Œ<strong class="kk iu">å†·å¯åŠ¨é—®é¢˜</strong>æŒ‡çš„æ˜¯å°†é¡¹ç›®æ¨èç»™ä¸€ä¸ªå®Œå…¨<em class="le"/><em class="le">æ–°</em> <em class="le">ç”¨æˆ·</em>çš„é—®é¢˜ï¼Œå³ä¸€ä¸ªæ²¡æœ‰ä¸ä½ çš„æ•°æ®åº“ä¸­çš„ä»»ä½•ç°æœ‰é¡¹ç›®è¿›è¡Œè¿‡äº¤äº’çš„ç”¨æˆ·ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœæ‚¨ä»åˆå§‹è®­ç»ƒæ•°æ®åˆ›å»ºç”¨æˆ·-é¡¹ç›®çŸ©é˜µï¼Œæ‚¨å°†æ‰¾ä¸åˆ°è¿™ä¸ªæ–°ç”¨æˆ·çš„è¡Œã€‚ç±»ä¼¼çš„ç±»æ¯”å¯ç”¨äºè§£é‡Šåœ¨<em class="le">å…¨æ–°é¡¹ç›®</em>çš„æƒ…å†µä¸‹çš„å†·å¯åŠ¨é—®é¢˜ã€‚</p><p id="bb11" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä½œä¸ºåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼Œè¿™å¯èƒ½ä¼šç»™ä½ å¸¦æ¥å¾ˆå¤§çš„ä¸ä¾¿ï¼Œä¾‹å¦‚ï¼Œå½“å¬ä¼—è¯•å›¾å¯»æ‰¾æ–°çš„æ’­å®¢å»ºè®®æ¥å¬æ—¶ï¼Œä½ å¾—åˆ°çš„æ˜¯â€”â€”zipï¼Œzilchï¼Œnadaï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬æ’­å®¢åº”ç”¨ç¨‹åº<a class="ae lr" href="https://podurama.com/" rel="noopener ugc nofollow" target="_blank"> Podurama </a>æœ€åˆå¼€å‘é˜¶æ®µçš„é—®é¢˜ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ LightFM æ˜¯å¦‚ä½•å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜çš„â€¦</p><h1 id="a26f" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">LightFM å¦‚ä½•å¸®åŠ©è§£å†³å†·å¯åŠ¨é—®é¢˜ï¼Ÿ</h1><p id="cc99" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">LightFM çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œè¯¥æ¨¡å‹ä¸ä¼šé­å—å†·å¯åŠ¨é—®é¢˜ï¼Œæ— è®ºæ˜¯ç”¨æˆ·è¿˜æ˜¯é¡¹ç›®å†·å¯åŠ¨ã€‚åŸå› æ˜¯ LightFM å…è®¸æ„å»ºä¸€ä¸ª<strong class="kk iu">æ··åˆæ¨èç³»ç»Ÿ</strong>ã€‚</p><blockquote class="mp mq mr"><p id="1935" class="ki kj le kk b kl km ju kn ko kp jx kq ms ks kt ku mt kw kx ky mu la lb lc ld im bi translated">æ··åˆæ¨èå™¨æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¨èå™¨ï¼Œå®ƒä½¿ç”¨ååŒè¿‡æ»¤å’ŒåŸºäºå†…å®¹çš„è¿‡æ»¤æ¥è¿›è¡Œæ¨èã€‚</p></blockquote><p id="12f6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç®€è€Œè¨€ä¹‹ï¼ŒLightFM å¯ä»¥ä½¿ç”¨æ™®é€šçš„ç”¨æˆ·-é¡¹ç›®äº¤äº’æ¥ä¸ºå·²çŸ¥çš„<em class="le"/><em class="le">ç”¨æˆ·åšå‡ºé¢„æµ‹ã€‚</em>åœ¨ n ä¸ª<em class="le">ç”µå­æˆ˜ç”¨æˆ·çš„æƒ…å†µä¸‹ï¼Œ</em>å¦‚æœå®ƒçŸ¥é“å…³äºè¿™äº›æ–°ç”¨æˆ·çš„ä¸€äº›<em class="le">é™„åŠ ä¿¡æ¯</em>ï¼Œå®ƒå¯ä»¥åšå‡ºé¢„æµ‹ã€‚è¿™äº›é™„åŠ ä¿¡æ¯å¯ä»¥æ˜¯æ€§åˆ«ã€å¹´é¾„ã€ç§æ—ç­‰ç‰¹å¾ï¼Œå¹¶ä¸”åœ¨è®­ç»ƒæœŸé—´å¿…é¡»å°†<strong class="kk iu">è¾“å…¥åˆ°ç®—æ³•ä¸­ã€‚</strong></p><h1 id="9e03" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated">è®©æˆ‘ä»¬ç›´æ¥è¿›å…¥ç¼–ç </h1><p id="cd01" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">æˆ‘å°†ä½¿ç”¨(éå¸¸)å°çš„è™šæ‹Ÿè¯„çº§æ•°æ®å’Œç‰¹å¾æ•°æ®ï¼Œå› ä¸ºæˆ‘å¸Œæœ›èƒ½å¤Ÿæ˜¾ç¤ºæ¯ä¸ªé˜¶æ®µçš„ä¸­é—´è¾“å‡ºã€‚å¦‚æœä½ æƒ³è·Ÿç€å»ï¼Œè¿™é‡Œæœ‰ä¸€æœ¬<a class="ae lr" href="https://github.com/V-Sher/LightFm_HybridRecommenderSystem/blob/master/LightFM%20Worked%20Example.ipynb" rel="noopener ugc nofollow" target="_blank"> Jupyter ç¬”è®°æœ¬</a>ã€‚</p><h2 id="0b3d" class="mv lt it bd lu mw mx dn ly my mz dp mc kr na nb me kv nc nd mg kz ne nf mi ng bi translated">è¯„çº§æ•°æ®æ¡†æ¶</h2><p id="3280" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">å®ƒåŒ…å«æ¥è‡ªä¸‰ä¸ªç”¨æˆ·(u1ã€u2ã€u3)å’Œå››ä¸ªé¡¹ç›®(i1ã€i2ã€i3ã€i4)çš„æ•°æ®ã€‚</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="ee35" class="mv lt it ni b gy nm nn l no np"># create dummy dataset<br/>data = {'user': ['u1','u1','u2','u2', 'u3', 'u3', 'u3'], <br/>        'item': ['i1', 'i3', 'i2', 'i3', 'i1', 'i4', 'i2'], <br/>        'r': [1,2,1,3,4,5,2]<br/>       }<br/>df = pd.DataFrame(data,  columns = ['user', 'item', 'r'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/84044f0ec57bdffc9a49f89498f3bcb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/format:webp/1*JVzN3U1e4YonWBw3DUuAqg.png"/></div></figure><h2 id="8ad2" class="mv lt it bd lu mw mx dn ly my mz dp mc kr na nb me kv nc nd mg kz ne nf mi ng bi translated">ç”¨æˆ·ç‰¹å¾æ•°æ®æ¡†æ¶</h2><p id="9564" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">æˆ‘ä»¬æœ‰å…³äºæ¯ä¸ªç”¨æˆ·çš„å››æ¡é™„åŠ ä¿¡æ¯â€”â€”ä¸‰ä¸ªå¸ƒå°”ç‰¹å¾â€”â€”f1ã€f2ã€f3ï¼Œä»¥åŠä¸€ä¸ªä½ç½®ç‰¹å¾â€”â€”locï¼Œç°åœ¨å¯ä»¥å–ä¸¤ä¸ªå€¼â€”â€”å¾·é‡Œæˆ–å­Ÿä¹°ã€‚</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="9e64" class="mv lt it ni b gy nm nn l no np"><em class="le">#dummy user features</em><br/>data = {'user': ['u1','u2','u3', 'loc'], <br/>        'f1': [1, 0, 1, 'del'], <br/>        'f2': [1, 1, 1, 'mum'],<br/>        'f3': [0, 0, 1, 'del']<br/>       }<br/>features = pd.DataFrame(data,  columns = ['user', 'f1', 'f2', 'f3', 'loc'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/535424303100c91183147fb0c33483d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*tNM_7XOe-emTEuHt7zjsLA.png"/></div></figure><h2 id="402c" class="mv lt it bd lu mw mx dn ly my mz dp mc kr na nb me kv nc nd mg kz ne nf mi ng bi translated">åˆ›å»ºç¬¦åˆ LightFM çš„æ•°æ®é›†</h2><p id="305d" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">å¦‚æœæ‚¨æµè§ˆè¿‡ LightFM æ–‡æ¡£ï¼Œå°±ä¼šçŸ¥é“å®ƒå–œæ¬¢ç‰¹å®šæ ¼å¼çš„è¾“å…¥æ•°æ®ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»æœä»ã€‚</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="7161" class="mv lt it ni b gy nm nn l no np">from lightfm.data import Dataset<br/>dataset1 = Dataset()</span></pre><h2 id="c734" class="mv lt it bd lu mw mx dn ly my mz dp mc kr na nb me kv nc nd mg kz ne nf mi ng bi translated">è°ƒç”¨ fit æ–¹æ³•</h2><p id="be36" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">æˆ‘ä»¬éœ€è¦è°ƒç”¨ fit æ–¹æ³•æ¥å‘Šè¯‰ LightFM ç”¨æˆ·æ˜¯è°ï¼Œæˆ‘ä»¬æ­£åœ¨å¤„ç†ä»€ä¹ˆé¡¹ç›®ï¼Œä»¥åŠä»»ä½•ç”¨æˆ·/é¡¹ç›®ç‰¹æ€§ã€‚</p><p id="f245" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å°†å‘ fit æ–¹æ³•ä¼ é€’ä¸‰ä¸ªè¾“å…¥:</p><ul class=""><li id="e130" class="ns nt it kk b kl km ko kp kr nu kv nv kz nw ld nx ny nz oa bi translated"><code class="fe ob oc od ni b">users</code>:æ‰€æœ‰ç”¨æˆ·åˆ—è¡¨</li><li id="0be4" class="ns nt it kk b kl oe ko of kr og kv oh kz oi ld nx ny nz oa bi translated"><code class="fe ob oc od ni b">items</code>:åˆ—å‡ºæ‰€æœ‰é¡¹ç›®</li><li id="d895" class="ns nt it kk b kl oe ko of kr og kv oh kz oi ld nx ny nz oa bi translated"><code class="fe ob oc od ni b">user_features</code>:é™„åŠ ç”¨æˆ·åŠŸèƒ½åˆ—è¡¨</li></ul><p id="e0a7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä¼ é€’ç”¨æˆ·å’Œé¡¹ç›®åˆ—è¡¨éå¸¸ç®€å•â€”â€”åªéœ€ä½¿ç”¨<code class="fe ob oc od ni b">df</code>ä¸­çš„â€œç”¨æˆ·â€å’Œâ€œé¡¹ç›®â€åˆ—ã€‚</p><p id="99f8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å½“è°ˆåˆ°ä¼ é€’<code class="fe ob oc od ni b">user_features</code>æ—¶ï¼Œæˆ‘ä¼š<strong class="kk iu">å¼ºçƒˆ</strong>æ¨èä¼ é€’ä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ç±»ä¼¼äº<code class="fe ob oc od ni b">'feature_name:feature_value'</code>çš„æ ¼å¼(æˆ‘ä¿è¯æˆ‘ä¼šè§£é‡Šä¸ºä»€ä¹ˆæˆ‘æ›´å–œæ¬¢è¿™æ ·åšï¼Œä»¥åŠæ˜¯å¦æœ‰å…¶ä»–é€‰æ‹©ï¼Œä½†æ˜¯ç°åœ¨ï¼Œè¯·è€å¿ƒç­‰å¾…)ã€‚</p><p id="c5d0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™æ„å‘³ç€æˆ‘ä»¬çš„<code class="fe ob oc od ni b">user_features</code>åº”è¯¥æ˜¯è¿™æ ·çš„:<br/> <code class="fe ob oc od ni b">['f1:1', 'f1:0', 'f2:1', 'f3:0', 'f3:1', 'loc:mum', 'loc:del']</code>ã€‚</p><p id="2583" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ­£å¦‚ä½ æ‰€çŒœæµ‹çš„ï¼Œè¿™ä¸ªåˆ—è¡¨æ˜¯é€šè¿‡è€ƒè™‘åœ¨è®­ç»ƒé›†ä¸­å¯èƒ½é‡åˆ°çš„æ‰€æœ‰å¯èƒ½çš„å¯¹æ¥ç”Ÿæˆçš„ã€‚ä¾‹å¦‚ï¼Œå¯¹äºç­‰äº<code class="fe ob oc od ni b">loc</code>çš„<code class="fe ob oc od ni b">feature_name</code>ï¼Œå¯ä»¥æœ‰ä¸¤ä¸ª<code class="fe ob oc od ni b">feature_values</code>ï¼Œå³<code class="fe ob oc od ni b">mum</code>å’Œ<code class="fe ob oc od ni b">del</code>ã€‚</p><p id="231b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘å†™äº†ä¸€å°æ®µä»£ç ï¼Œè®©æˆ‘ç”Ÿæˆè¿™æ ·ä¸€ä¸ªåˆ—è¡¨(æˆ‘ç§°ä¹‹ä¸º<code class="fe ob oc od ni b">uf</code>):</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="efad" class="mv lt it ni b gy nm nn l no np">uf = []<br/>col = ['f1']*len(features.f1.unique()) + ['f2']*len(features.f2.unique()) + ['f3']*len(features.f3.unique()) + ['loc']*len(features['loc'].unique())<br/>unique_f1 = list(features.f1.unique()) + list(features.f2.unique()) + list(features.f3.unique()) + list(features['loc'].unique())<br/>#print('f1:', unique_f1)<br/>for x,y in zip(col, unique_f1):<br/>    res = str(x)+ ":" +str(y)<br/>    uf.append(res)<br/>    print(res)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/5400df92e1c5fbff365a287e8004624d.png" data-original-src="https://miro.medium.com/v2/resize:fit:248/format:webp/1*bKNAoWXDDIIZTZIcf-3ABA.png"/></div></figure><p id="1a06" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æœ€åï¼Œæœ‰äº†æ‰€æœ‰å¯ç”¨çš„éƒ¨åˆ†ï¼Œè®©æˆ‘ä»¬å¯¹æ•°æ®é›†è°ƒç”¨ fit æ–¹æ³•:</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="031f" class="mv lt it ni b gy nm nn l no np"><em class="le"># we call fit to supply userid, item id and user/item features</em><br/>dataset1.fit(<br/>        df['user'].unique(), <em class="le"># all the users</em><br/>        df['item'].unique(), <em class="le"># all the items</em><br/>        user_features = uf <em class="le"># additional user features</em><br/>)</span></pre><p id="8d46" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ—¢ç„¶æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†æ¡†æ¶æ•°æ®é›†ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å®é™…çš„äº¤äº’å’Œè¯„çº§æ’å…¥å…¶ä¸­äº†ã€‚</p><h2 id="710d" class="mv lt it bd lu mw mx dn ly my mz dp mc kr na nb me kv nc nd mg kz ne nf mi ng bi translated">å»ºç«‹äº’åŠ¨</h2><p id="2655" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated"><code class="fe ob oc od ni b">build_interactions</code>æ–¹æ³•çš„è¾“å…¥æ˜¯äº¤äº’çš„ iterableï¼Œå…¶ä¸­æ¯ä¸ªäº¤äº’æ˜¯ä¸€ä¸ªåŒ…å«ä¸‰ä¸ªå…ƒç´ çš„å…ƒç»„:</p><ul class=""><li id="e8fa" class="ns nt it kk b kl km ko kp kr nu kv nv kz nw ld nx ny nz oa bi translated">ç”¨æˆ·</li><li id="fabc" class="ns nt it kk b kl oe ko of kr og kv oh kz oi ld nx ny nz oa bi translated">é¡¹ç›®</li><li id="171a" class="ns nt it kk b kl oe ko of kr og kv oh kz oi ld nx ny nz oa bi translated">äº¤äº’æƒé‡(å¯é€‰)</li></ul><p id="a385" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">äº¤äº’æƒé‡ä»…ä»…æ„å‘³ç€å¦‚æœç”¨æˆ·â€˜uâ€™ä¸é¡¹ç›®â€˜Iâ€™äº¤äº’ï¼Œé‚£ä¹ˆè¿™ä¸ªäº¤äº’<em class="le">æœ‰å¤šé‡è¦ã€‚ä»æˆ‘ä»¬ç¤ºä¾‹çš„è§’åº¦æ¥çœ‹ï¼Œæƒé‡æ˜¯æˆ‘ä»¬å¯¹æ¯ä¸ª(ç”¨æˆ·ã€å•†å“)å¯¹çš„è¯„çº§ã€‚</em></p><p id="e423" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ’å…¥æƒé‡å¯èƒ½æœ‰ç”¨çš„å¦ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æ­£åœ¨å¤„ç†(ç”¨æˆ·ã€æ­Œæ›²)äº¤äº’æ•°æ®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘å¯ä»¥ç»™é‚£äº›ç”¨æˆ·å¬äº†è¶…è¿‡ 3/4 æ­Œæ›²çš„äº¤äº’åˆ†é…ä¸€ä¸ªè¾ƒé«˜çš„æƒé‡ã€‚</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="0f05" class="mv lt it ni b gy nm nn l no np"><em class="le"># plugging in the interactions and their weights</em><br/>(interactions, weights) = dataset1.build_interactions([(x[0], x[1], x[2]) for x in df.values ])</span></pre><blockquote class="mp mq mr"><p id="be14" class="ki kj le kk b kl km ju kn ko kp jx kq ms ks kt ku mt kw kx ky mu la lb lc ld im bi translated">æ€»ä¹‹ï¼Œ<code class="fe ob oc od ni b">interactions</code>çŸ©é˜µå‘Šè¯‰æˆ‘ä»¬ç”¨æˆ·æ˜¯å¦ä¸æŸä¸ªé¡¹ç›®è¿›è¡Œäº†äº¤äº’ï¼Œè€Œ<code class="fe ob oc od ni b">weights</code>çŸ©é˜µé‡åŒ–äº†ç‰¹å®šçš„äº¤äº’ã€‚</p></blockquote><p id="b725" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å¯ä»¥çœ‹çœ‹è¿™ä¸¤ä¸ªè¾“å‡ºçŸ©é˜µæ˜¯ä»€ä¹ˆæ ·çš„ã€‚ç”±äºè¿™äº›æ˜¯ç¨€ç–çŸ©é˜µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="fe ob oc od ni b">.todense()</code>æ–¹æ³•ã€‚åœ¨è¿™ä¸¤ä¸ªçŸ©é˜µä¸­ï¼Œè¡Œæ˜¯ç”¨æˆ·ï¼Œåˆ—æ˜¯é¡¹ç›®ã€‚</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ol om di on bf oo"><div class="gh gi ok"><img src="../Images/caab53877f6f1b28e8c21c9acba29d75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dxdKPw3eZakuQl42sWo_4w.png"/></div></div></figure><p id="1351" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¦‚æœä½ ç°åœ¨è¿˜å’Œæˆ‘åœ¨ä¸€èµ·ï¼Œæˆ‘å‘ä½ è‡´æ•¬ã€‚ç†è§£ä¸‹ä¸€éƒ¨åˆ†éå¸¸é‡è¦ï¼Œè¿™æ ·ä½ ä¹Ÿå¯ä»¥ä¸ºä½ è‡ªå·±çš„æ¨èç³»ç»Ÿå®ç°å®ƒã€‚(æœ‰è¶£çš„äº‹å®:LightFM Github é¡µé¢ä¸Šçš„è®¸å¤šå…¬å¼€é—®é¢˜éƒ½ä¸æ„å»ºç”¨æˆ·/ç‰©å“ç‰¹æ€§ä¸»é¢˜æœ‰å…³)ã€‚</p><h2 id="90a4" class="mv lt it bd lu mw mx dn ly my mz dp mc kr na nb me kv nc nd mg kz ne nf mi ng bi translated">æ„å»ºç”¨æˆ·ç‰¹å¾</h2><p id="8e89" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated"><code class="fe ob oc od ni b">build_user_features</code>æ–¹æ³•éœ€è¦ä»¥ä¸‹æ ¼å¼çš„è¾“å…¥:<br/> [ <br/>(ç”¨æˆ· 1ï¼Œ[ç‰¹å¾ 1ï¼Œç‰¹å¾ 2ï¼Œç‰¹å¾ 3ï¼Œâ€¦ã€‚])ï¼Œ<br/>(ç”¨æˆ· 2ï¼Œ[åŠŸèƒ½ 1ï¼ŒåŠŸèƒ½ 2ï¼ŒåŠŸèƒ½ 3ï¼Œâ€¦ã€‚])ï¼Œ<br/>(ç”¨æˆ· 3ï¼Œ[åŠŸèƒ½ 1ï¼ŒåŠŸèƒ½ 2ï¼ŒåŠŸèƒ½ 3ï¼Œâ€¦ã€‚])ï¼Œ<br/>ã€‚<br/>ã€‚<br/></p><blockquote class="mp mq mr"><p id="f941" class="ki kj le kk b kl km ju kn ko kp jx kq ms ks kt ku mt kw kx ky mu la lb lc ld im bi translated">è¿™é‡Œéœ€è¦è®°ä½çš„ä¸€ä»¶è¶…çº§é‡è¦çš„äº‹æƒ…æ˜¯ï¼Œ<code class="fe ob oc od ni b">feature1</code>ã€<code class="fe ob oc od ni b">feature2</code>ã€<code class="fe ob oc od ni b">feature3</code>ç­‰åº”è¯¥æ˜¯æˆ‘ä»¬ä¸€å¼€å§‹ä¼ é€’ç»™<code class="fe ob oc od ni b">fit</code>æ–¹æ³•çš„<code class="fe ob oc od ni b">user_features</code>åˆ—è¡¨ä¸­çš„é¡¹ç›®ä¹‹ä¸€ã€‚</p></blockquote><p id="715a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åªæ˜¯é‡ç”³ä¸€ä¸‹ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„<code class="fe ob oc od ni b">user_features</code>åˆ—è¡¨ç›®å‰çš„æ ·å­:<br/> <code class="fe ob oc od ni b">['f1:1', 'f1:0', 'f2:1', 'f3:0', 'f3:1', 'loc:mum', 'loc:del']</code>ã€‚</p><p id="94de" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å› æ­¤ï¼Œå¯¹äºæˆ‘ä»¬ç‰¹å®šçš„è™šæ‹Ÿæ•°æ®ï¼Œ<code class="fe ob oc od ni b">build_user_features</code>çš„è¾“å…¥åº”è¯¥æ˜¯è¿™æ ·çš„:</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="ce53" class="mv lt it ni b gy nm nn l no np">[<br/>     ('u1', ['f1:1', 'f2:1', 'f3:0', 'loc:del']),<br/>     ('u2', ['f1:0', 'f2:1', 'f3:0', 'loc:mum']),<br/>     ('u3', ['f1:1', 'f2:1', 'f3:1', 'loc:del'])<br/> ]</span></pre><p id="7ef7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åŒæ ·ï¼Œæˆ‘å·²ç»ç¼–å†™äº†ä¸€ä¸ª(ä¸é‚£ä¹ˆå°çš„)ä»£ç ç‰‡æ®µï¼Œè®©æˆ‘ç”Ÿæˆè¿™æ ·ä¸€ä¸ªåˆ—è¡¨:</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="c9ae" class="mv lt it ni b gy nm nn l no np"><strong class="ni iu"><em class="le"># Helper function that takes the user features and converts them into the proper "feature:value" format</em></strong><br/>def feature_colon_value(my_list):<br/>    """<br/>    Takes as input a list and prepends the columns names to respective values in the list.<br/>    For example: if my_list = [1,1,0,'del'],<br/>    resultant output = ['f1:1', 'f2:1', 'f3:0', 'loc:del']<br/>   <br/>    """<br/>    result = []<br/>    ll = ['f1:','f2:', 'f3:', 'loc:']<br/>    aa = my_list<br/>    for x,y in zip(ll,aa):<br/>        res = str(x) +""+ str(y)<br/>        result.append(res)<br/>    return result</span><span id="3c71" class="mv lt it ni b gy op nn l no np"><strong class="ni iu"><em class="le"># Using the helper function to generate user features in proper format for ALL users<br/></em></strong>ad_subset = features[["f1", 'f2','f3', 'loc']] <br/>ad_list = [list(x) for x in ad_subset.values]<br/>feature_list = []<br/>for item in ad_list:<br/>    feature_list.append(feature_colon_value(item))<br/>print(f'Final output: {feature_list}')</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ol om di on bf oo"><div class="gh gi oq"><img src="../Images/061b596abfd79496c4286e8d79a147a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WOWn69H4WNtH6DaAWGeTWw.png"/></div></div></figure><p id="77b5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æœ€åï¼Œæˆ‘ä»¬å¿…é¡»å°†<code class="fe ob oc od ni b">feature_list</code>çš„æ¯ä¸ªå…ƒç´ ä¸ç›¸åº”çš„ç”¨æˆ· id ç›¸å…³è”ã€‚</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="f3b8" class="mv lt it ni b gy nm nn l no np">user_tuple = list(zip(features.user, feature_list))</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ol om di on bf oo"><div class="gh gi or"><img src="../Images/bbbd0686060ae14419df08d13d1f6143.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8R-FM5UIRppkrnWNFCDHEQ.png"/></div></div></figure><p id="771c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç§ï¼Œæˆ‘ä»¬æœ‰äº†<code class="fe ob oc od ni b">build_user_features</code>æ–¹æ³•æ‰€éœ€çš„è¾“å…¥ã€‚è®©æˆ‘ä»¬ç»§ç»­ç§°ä¹‹ä¸º:</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="ea2a" class="mv lt it ni b gy nm nn l no np">user_features = dataset1.build_user_features(user_tuple, normalize= False)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ol om di on bf oo"><div class="gh gi os"><img src="../Images/d318671062ae8147067ccf161389ca48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AN3kDBpHsRAxVhMm8t4XYA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">å›¾ 1</p></figure><p id="7235" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åœ¨ä¸Šé¢çš„<code class="fe ob oc od ni b">user_features</code>çŸ©é˜µä¸­ï¼Œè¡Œæ˜¯ç”¨æˆ·ï¼Œåˆ—æ˜¯ç”¨æˆ·ç‰¹å¾ã€‚æ¯å½“ç”¨æˆ·åœ¨è®­ç»ƒæ•°æ®ä¸­å…·æœ‰è¯¥ç‰¹å®šç”¨æˆ·ç‰¹å¾æ—¶ï¼Œå°±å­˜åœ¨ 1ã€‚</p><p id="1d52" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ€»å…±æœ‰ 10 åˆ—ï¼Œè¿™æ„å‘³ç€å­˜åœ¨ 10 ä¸ªç”¨æˆ·ç‰¹æ€§ã€‚ä½†æ˜¯ä¸ºä»€ä¹ˆä½ é—®ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ï¼</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="589b" class="mv lt it ni b gy nm nn l no np">user_id_map, user_feature_map, item_id_map, item_feature_map = dataset1.mapping()<br/>user_feature_map</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/32338379062f3227399d23350d35666f.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*VNBRnKUrvn14OkTB5CNlKA.png"/></div></figure><p id="8b1a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¦‚æœä½ çœ‹çœ‹ä¸Šé¢çš„è¾“å‡ºï¼Œå°±ä¼šæ˜ç™½ä¸ºä»€ä¹ˆæˆ‘ä»¬æœ‰ 10 ä¸ªç”¨æˆ·ç‰¹æ€§ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œç”¨æˆ· id æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªç‰¹æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ä¸‰ä¸ªã€‚å‰©ä¸‹çš„ä¸ƒä¸ªä¸€å®šå¾ˆç†Ÿæ‚‰ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ä¸€å¼€å§‹å°±åˆ›å»ºäº†å®ƒä»¬ã€‚</p><h2 id="c494" class="mv lt it bd lu mw mx dn ly my mz dp mc kr na nb me kv nc nd mg kz ne nf mi ng bi translated">æ˜¯æ—¶å€™å»ºç«‹æ¨¡å‹äº†</h2><p id="27a5" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">è¿™ä¸€æ­¥éå¸¸ç®€å•ï¼Œä¹Ÿéå¸¸é€šç”¨ã€‚å½“ç„¶ï¼Œæ‚¨å¯ä»¥éµå¾ª<a class="ae lr" href="https://making.lyst.com/lightfm/docs/index.html" rel="noopener ugc nofollow" target="_blank">æ–‡æ¡£</a>å¹¶å°è¯•ä¸åŒçš„<code class="fe ob oc od ni b">loss</code>å€¼æˆ–<code class="fe ob oc od ni b">learning_schedule</code>é€‰é¡¹ã€‚</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="32c3" class="mv lt it ni b gy nm nn l no np">model = LightFM(loss='warp')<br/>model.fit(interactions,<br/>      user_features= user_features,<br/>      sample_weight= weights,<br/>      epochs=10)</span></pre><h2 id="70ee" class="mv lt it bd lu mw mx dn ly my mz dp mc kr na nb me kv nc nd mg kz ne nf mi ng bi translated">æ‰“å° AUC åˆ†æ•°</h2><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="5eeb" class="mv lt it ni b gy nm nn l no np">from lightfm.evaluation import auc_score<br/>train_auc = auc_score(model,<br/>                      interactions,<br/>                      user_features=user_features<br/>                     ).mean()<br/>print('Hybrid training set AUC: %s' % train_auc)</span><span id="8cec" class="mv lt it ni b gy op nn l no np"><strong class="ni iu">Output: Hybrid training set AUC: 0.9166667</strong></span></pre><p id="4648" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘å†è¯´ä¸€éï¼Œä¸è¦å¯¹é«˜ AUC è¿‡äºå…´å¥‹ã€‚è®°ä½è¿™åªæ˜¯è™šæ‹Ÿæ•°æ®ã€‚</p><h2 id="cdd5" class="mv lt it bd lu mw mx dn ly my mz dp mc kr na nb me kv nc nd mg kz ne nf mi ng bi translated">ä¸ºå·²çŸ¥ç”¨æˆ·åšé¢„æµ‹</h2><p id="fc49" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated"><code class="fe ob oc od ni b">predict</code>æ–¹æ³•æœ‰ä¸¤ä¸ªè¾“å…¥:</p><ul class=""><li id="5b78" class="ns nt it kk b kl km ko kp kr nu kv nv kz nw ld nx ny nz oa bi translated">ç”¨æˆ· id æ˜ å°„(ä¾‹å¦‚:è¦è·å¾—å¯¹â€œu1â€çš„é¢„æµ‹ï¼Œå¿…é¡»ä¼ é€’ 0ï¼›å¯¹äºâ€˜U2â€™ï¼Œä¼ é€’ 1ï¼Œä»¥æ­¤ç±»æ¨ã€‚).è¿™äº›æ˜ å°„å¯ä»<code class="fe ob oc od ni b">user_id_map </code>å­—å…¸ä¸­è®¿é—®ã€‚</li><li id="3239" class="ns nt it kk b kl oe ko of kr og kv oh kz oi ld nx ny nz oa bi translated">æ¡ç›® id çš„åˆ—è¡¨(åŒæ ·ä¸æ˜¯ i1ã€i2ï¼Œè€Œæ˜¯æ˜ å°„ï¼›å¯ä»<code class="fe ob oc od ni b">item_id_map</code>è·å¾—æ‚¨æƒ³è¦çš„æ¨èã€‚</li></ul><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="230b" class="mv lt it ni b gy nm nn l no np"><em class="le"># predict for existing user</em><br/>user_x = user_id_map['u3']<br/>n_users, n_items = interactions.shape <em class="le"># no of users * no of items</em><br/>model.predict(user_x, np.arange(n_items)) <em class="le"># means predict for all </em></span><span id="3b7d" class="mv lt it ni b gy op nn l no np"><strong class="ni iu">Output: array([-0.18600112, -0.91691172, -0.295421  , -0.06632421])</strong></span></pre><h2 id="4faf" class="mv lt it bd lu mw mx dn ly my mz dp mc kr na nb me kv nc nd mg kz ne nf mi ng bi translated">ä¸ºæœªçŸ¥ç”¨æˆ·åšé¢„æµ‹</h2><p id="20f8" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">è¿™å°±æ˜¯æˆ‘ä»¬æœ€åˆæ„å»ºæ··åˆæ¨èå™¨çš„åŸå› ã€‚</p><p id="d71c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¯¹äºä¸€ä¸ªæ–°ç”¨æˆ·ï¼Œè¿™æ˜¯æˆ‘ä»¬æ‰€çŸ¥é“çš„- (s)ä»–æœ‰ f1ï¼Œf2ï¼Œf3 çš„å€¼ï¼Œåˆ†åˆ«ä¸º 1ï¼Œ1 å’Œ 0ã€‚æ­¤å¤–ï¼Œä»–ä»¬çš„ä½ç½®æ˜¯å¾·é‡Œã€‚</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="18d3" class="mv lt it ni b gy nm nn l no np">user_feature_list = ['f1:1', 'f2:1', 'f3:0', 'loc:del']</span></pre><p id="3277" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬ä¸èƒ½å°†å®ƒç›´æ¥æä¾›ç»™<code class="fe ob oc od ni b">predict</code>æ–¹æ³•ã€‚æˆ‘ä»¬å¿…é¡»å°†è¿™ç§è¾“å…¥è½¬æ¢æˆ lightFM æ¨¡å‹å¯ä»¥ç†è§£çš„å½¢å¼ã€‚</p><p id="5ac1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç†æƒ³æƒ…å†µä¸‹ï¼Œè¾“å…¥åº”è¯¥ç±»ä¼¼äº<code class="fe ob oc od ni b">user_features</code>çŸ©é˜µä¸­çš„ä¸€è¡Œ(è§ä¸Šé¢çš„å›¾ 1)ã€‚</p><p id="75b2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘åœ¨<a class="ae lr" href="https://stackoverflow.com/questions/46924119/lightfm-handling-user-and-item-cold-start" rel="noopener ugc nofollow" target="_blank"> Stackoverflow </a>ä¸Šæ‰¾åˆ°äº†ä¸€æ®µä»£ç ï¼Œå®ƒå°±æ˜¯è¿™æ ·åšçš„â€”â€”å°†<code class="fe ob oc od ni b">user_feature_list</code>è½¬æ¢æˆæ‰€éœ€çš„æ ¼å¼(åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ä¸€ä¸ªæœ‰ 10 åˆ—çš„ç¨€ç–çŸ©é˜µ)ã€‚æˆ‘åªæ˜¯ç¨å¾®ä¿®æ”¹äº†åŸå§‹ä»£ç ï¼Œå¹¶å°†å…¶å°è£…åœ¨ä¸€ä¸ªå¯é‡ç”¨çš„å‡½æ•°<code class="fe ob oc od ni b">format_newuser_input</code>ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="a7fe" class="mv lt it ni b gy nm nn l no np">from scipy import sparse</span><span id="a519" class="mv lt it ni b gy op nn l no np">def format_newuser_input(user_feature_map, user_feature_list):<br/>  num_features = len(user_feature_list)<br/>  normalised_val = 1.0 <br/>  target_indices = []<br/>  for feature in user_feature_list:<br/>    try:<br/>        target_indices.append(user_feature_map[feature])<br/>    except KeyError:<br/>        print("new user feature encountered '{}'".format(feature))<br/>        pass<br/><br/>  new_user_features = np.zeros(len(user_feature_map.keys()))<br/>  for i in target_indices:<br/>    new_user_features[i] = normalised_val<br/>  new_user_features = sparse.csr_matrix(new_user_features)<br/>  return(new_user_features)</span></pre><p id="8eb4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æœ€åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹é¢„æµ‹æ–°ç”¨æˆ·:</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="0e77" class="mv lt it ni b gy nm nn l no np">new_user_features = format_newuser_input(user_feature_map, user_feature_list)<br/>model.predict(0, np.arange(n_items), user_features=new_user_features)</span></pre><p id="3339" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™é‡Œï¼Œç¬¬ä¸€ä¸ªå‚æ•°(å³ 0)ä¸å†æŒ‡ç”¨æˆ· u1 çš„æ˜ å°„ idã€‚ç›¸åï¼Œå®ƒçš„æ„æ€æ˜¯â€”â€”é€‰æ‹©<code class="fe ob oc od ni b">new_user_features</code>ç¨€ç–çŸ©é˜µçš„ç¬¬ä¸€è¡Œã€‚ä¼ é€’é™¤ 0 ä»¥å¤–çš„ä»»ä½•å€¼éƒ½ä¼šå¼•å‘ä¸€ä¸ªé”™è¯¯ï¼Œè¿™æ˜¯ç†æ‰€å½“ç„¶çš„ï¼Œå› ä¸ºåœ¨<code class="fe ob oc od ni b">new_user_features</code>ä¸­æ²¡æœ‰è¶…è¿‡ row0 çš„è¡Œã€‚</p><h2 id="8896" class="mv lt it bd lu mw mx dn ly my mz dp mc kr na nb me kv nc nd mg kz ne nf mi ng bi translated">ä¸‡å²ï¼ï¼æˆ‘ä»¬åšåˆ°äº†ã€‚æˆ‘ä»¬çš„è™šæ‹Ÿæ··åˆæ¨èç³»ç»Ÿå·²ç»å‡†å¤‡å¥½äº†ã€‚</h2></div><div class="ab cl ou ov hx ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="im in io ip iq"><h2 id="abfc" class="mv lt it bd lu mw mx dn ly my mz dp mc kr na nb me kv nc nd mg kz ne nf mi ng bi translated">åˆ›å»ºç”¨æˆ·/é¡¹ç›®ç‰¹å¾çš„å…¶å®ƒæ–¹å¼</h2><p id="b9db" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">å›åˆ°æˆ‘åœ¨å¼€å§‹æ—¶æ‰€åšçš„æ‰¿è¯ºï¼Œé™¤äº†æ„å»º<code class="fe ob oc od ni b">user_features</code>çŸ©é˜µï¼Œè¿˜æœ‰å…¶ä»–é€‰æ‹©ï¼Œ<strong class="kk iu">å‡è®¾</strong> <strong class="kk iu">ä½ çš„æ•°æ®æ˜¯ä¸€ç§ç‰¹å®šçš„æ ¼å¼</strong>ã€‚</p><p id="f2c9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä¾‹å¦‚ï¼Œè€ƒè™‘å¦‚ä¸‹æ‰€ç¤ºçš„ç”¨æˆ·ç‰¹å¾æ•°æ®å¸§:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ol om di on bf oo"><div class="gh gi pb"><img src="../Images/e1b52b0b3f9f9798bdba8ce93cee8a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k7FeUxgvemJilBQiZjzg_A.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">æ¥æº:<a class="ae lr" href="https://github.com/lyst/lightfm/issues/372" rel="noopener ugc nofollow" target="_blank">https://github.com/lyst/lightfm/issues/372</a></p></figure><p id="1f3a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¦‚æœä½ ä»”ç»†è§‚å¯Ÿï¼Œè¿™ä¸‰ä¸ªç‰¹å¾â€”â€”ç§æ—ã€æ€§åˆ«ã€30 å²ä»¥ä¸‹ï¼Œæ¯ä¸€ä¸ªéƒ½æœ‰ä¸é‡å çš„å€¼ã€‚æ¢å¥è¯è¯´ï¼Œ<em class="le">ç§æ—åˆ—ä¸­çš„å¯èƒ½å€¼ä¸åŒäºæ€§åˆ«åˆ—ä¸­çš„å¯èƒ½å€¼ï¼Œæ€§åˆ«åˆ—ä¸­çš„å¯èƒ½å€¼åˆä¸åŒäº under_30yo åˆ—ä¸­çš„å¯èƒ½å€¼</em>ã€‚</p><p id="e12d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†è¡¨å•<code class="fe ob oc od ni b">[Asian, Hispanic, Female, Male, no, yes]</code>çš„<code class="fe ob oc od ni b">user_features</code>åˆ—è¡¨ä¼ é€’ç»™<code class="fe ob oc od ni b">fit</code>ã€‚éšåï¼Œæˆ‘ä»¬<strong class="kk iu">å¿…é¡»</strong>ä¹Ÿæ›´æ–°æˆ‘ä»¬æ„å»ºç”¨æˆ·ç‰¹æ€§çš„æ–¹å¼ï¼Œå› æ­¤<code class="fe ob oc od ni b">.build_user_features()</code>çš„è¾“å…¥åº”è¯¥æ˜¯è¿™æ ·çš„:</p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="1730" class="mv lt it ni b gy nm nn l no np">[<br/>     ('u1', ['Asian', 'Female', 'No']),<br/>     ('u2', ['Hispanic', 'Male', 'Yes']),<br/>     ('u3', ['Hispanic', 'Male', 'No'])<br/> ]</span></pre><p id="42ae" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™çœ‹èµ·æ¥å¾ˆæ£’ã€‚ä½†æ˜¯ç°åœ¨å›ç­”è¿™ä¸ªï¼Ÿ</p><p id="0bac" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å½“æˆ‘æœ‰ä¸€ä¸ªå…³äºæ¯ä¸ªç”¨æˆ·çš„é¢å¤–ä¿¡æ¯æ—¶ï¼Œæ¯”å¦‚ä¸€ä¸ªæ–°åˆ—â€œheight_under_5ftâ€å¯ä»¥å–å€¼ yes æˆ– noï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p><p id="86c9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯èƒ½å¾ˆéš¾ä»å¹´é¾„å’Œèº«é«˜æ¥åŒºåˆ†æ˜¯/å¦ã€‚å› æ­¤ï¼Œä¸ºäº†é¿å…æ­§ä¹‰ï¼Œæœ€å¥½ä½¿ç”¨æˆ‘ä»¬åœ¨å¼€å§‹æ—¶è°ˆåˆ°çš„<code class="fe ob oc od ni b">feature:value</code>æ ¼å¼ï¼Œå¹¶å°†<code class="fe ob oc od ni b">user_features = ['eth:Asian', 'eth:Hispanic', 'gender:Male', 'gender:Female', 'age:yes', 'age:no', 'height:yes', 'height:no]</code>ä¼ é€’ç»™<code class="fe ob oc od ni b">fit</code>ï¼Œå¹¶å°†ä»¥ä¸‹è¾“å…¥ä¼ é€’ç»™<code class="fe ob oc od ni b">.build_usear_features()</code></p><pre class="lg lh li lj gt nh ni nj nk aw nl bi"><span id="6ff7" class="mv lt it ni b gy nm nn l no np">[<br/>     ('u1', ['eth:Asian', 'gender:Female', 'age:No', <!-- -->'height:yes'<!-- -->]),<br/>     ('u2', ['eth:Hispanic', 'gender:Male', 'age:No', <!-- -->'height:no'<!-- -->])<br/>     ('u3', ['eth:Asian', 'gender:Female', 'age:No', <!-- -->'height:yes'<!-- -->])<br/> ]</span></pre></div><div class="ab cl ou ov hx ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="im in io ip iq"><h1 id="6e1d" class="ls lt it bd lu lv pc lx ly lz pd mb mc jz pe ka me kc pf kd mg kf pg kg mi mj bi translated">ç»“å°¾æ³¨é‡Š</h1><p id="d250" class="pw-post-body-paragraph ki kj it kk b kl mk ju kn ko ml jx kq kr mm kt ku kv mn kx ky kz mo lb lc ld im bi translated">æœ‰å¾ˆå¤šä¸åŒçš„æ–¹æ³•å¯ä»¥æ¨è¿›è¿™ä¸ªæ•™ç¨‹ã€‚é¦–å…ˆï¼Œå°è¯•æ’å…¥çœŸå®æ•°æ®é›†è€Œä¸æ˜¯è™šæ‹Ÿæ•°æ®ï¼Œçœ‹çœ‹ä½ çš„æ¨èç³»ç»Ÿè¡¨ç°å¦‚ä½•ã€‚æ‚¨ç”šè‡³å¯ä»¥å°è¯•ä½¿ç”¨æˆ‘ä»¬åœ¨æœ¬æ•™ç¨‹ä¸­è®¨è®ºçš„ç±»ä¼¼æ–¹æ³•æ¥åˆ›å»º<code class="fe ob oc od ni b">item_features</code>ã€‚</p><p id="e70a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘æ²¡æœ‰è¿‡å¤šåœ°è®¨è®ºè¿‡æ¨¡å‹è°ƒä¼˜ã€æ¨¡å‹è¯„ä¼°ã€äº¤å‰éªŒè¯ç­‰ç­‰ï¼Œä½†é‚£æ˜¯ä»¥åçš„äº‹äº†ã€‚æˆ‘å¸Œæœ›ä½ å–œæ¬¢é˜…è¯»ï¼Œå¹¶éšæ—¶åœ¨ Github ä¸Šåˆ†äº«æˆ‘çš„ä»£ç ï¼Œä»¥æ»¡è¶³ä½ çš„éœ€æ±‚ã€‚ä¸€å¦‚æ—¢å¾€ï¼Œæˆ‘å¾ˆæƒ³çŸ¥é“æ˜¯å¦æœ‰æ›´å¥½çš„æ–¹æ³•æ¥åšæˆ‘æåˆ°çš„ä¸€äº›äº‹æƒ…ã€‚</p><p id="7b18" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç›´åˆ°ä¸‹æ¬¡:)</p></div><div class="ab cl ou ov hx ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="im in io ip iq"><p id="6ba8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å“¦ï¼Œæˆ‘å·®ç‚¹å¿˜äº†ï¼Œâ€œ<em class="le">å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯èƒ½ä¹Ÿä¼šå–œæ¬¢</em>â€ğŸ˜œ)</p><p id="0cfb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘å–œæ¬¢å†™å¾ªåºæ¸è¿›çš„åˆå­¦è€…æŒ‡å—ã€æ“ä½œæŒ‡å—ã€é¢è¯•é—®é¢˜ã€ML/AI ä¸­ä½¿ç”¨çš„è§£ç æœ¯è¯­ç­‰ã€‚å¦‚æœä½ æƒ³å®Œå…¨è®¿é—®æˆ‘çš„æ‰€æœ‰æ–‡ç« (ä»¥åŠå…¶ä»–æ–‡ç« )ï¼Œé‚£ä¹ˆä½ å¯ä»¥æ³¨å†Œä½¿ç”¨ <a class="ae lr" href="https://varshitasher.medium.com/membership" rel="noopener"> <strong class="kk iu"> <em class="le">æˆ‘çš„é“¾æ¥</em></strong></a><strong class="kk iu"><em class="le"/></strong><em class="le">è¿™é‡Œ</em> <strong class="kk iu"> <em class="le">ã€‚</em> </strong></p><div class="ph pi gp gr pj pk"><a rel="noopener follow" target="_blank" href="/how-to-make-most-of-your-python-debugger-in-vscode-9e05dfce533f"><div class="pl ab fo"><div class="pm ab pn cl cj po"><h2 class="bd iu gy z fp pp fr fs pq fu fw is bi translated">å¦‚ä½•åœ¨ VSCode ä¸­å……åˆ†åˆ©ç”¨ä½ çš„ python è°ƒè¯•å™¨ï¼Ÿ</h2><div class="pr l"><h3 class="bd b gy z fp pp fr fs pq fu fw dk translated">è§‚å¯Ÿå˜é‡ï¼Œä½¿ç”¨æ¡ä»¶æ–­ç‚¹ï¼Œè°ƒç”¨å †æ ˆï¼Œå¼‚å¸¸æ–­ç‚¹ç­‰â€”â€”å½“åœ¨å¤§å‹é¡¹ç›®ä¸­å·¥ä½œæ—¶</h3></div><div class="ps l"><p class="bd b dl z fp pp fr fs pq fu fw dk translated">towardsdatascience.com</p></div></div><div class="pt l"><div class="pu l pv pw px pt py ll pk"/></div></div></a></div><div class="ph pi gp gr pj pk"><a rel="noopener follow" target="_blank" href="/understanding-python-imports-init-py-and-pythonpath-once-and-for-all-4c5249ab6355"><div class="pl ab fo"><div class="pm ab pn cl cj po"><h2 class="bd iu gy z fp pp fr fs pq fu fw is bi translated">äº†è§£ Python å¯¼å…¥ï¼Œ__init__ã€‚py å’Œ pythonpath â€”ä¸€åŠ³æ°¸é€¸</h2><div class="pr l"><h3 class="bd b gy z fp pp fr fs pq fu fw dk translated">äº†è§£å¦‚ä½•å¯¼å…¥åŒ…å’Œæ¨¡å—(ä»¥åŠä¸¤è€…ä¹‹é—´çš„åŒºåˆ«)</h3></div><div class="ps l"><p class="bd b dl z fp pp fr fs pq fu fw dk translated">towardsdatascience.com</p></div></div><div class="pt l"><div class="pz l pv pw px pt py ll pk"/></div></div></a></div><div class="ph pi gp gr pj pk"><a rel="noopener follow" target="_blank" href="/time-series-analysis-using-pandas-in-python-f726d87a97d8"><div class="pl ab fo"><div class="pm ab pn cl cj po"><h2 class="bd iu gy z fp pp fr fs pq fu fw is bi translated">ä½¿ç”¨ Python ä¸­çš„ Pandas è¿›è¡Œæ—¶é—´åºåˆ—åˆ†æ</h2><div class="pr l"><h3 class="bd b gy z fp pp fr fs pq fu fw dk translated">å¯¹å­£èŠ‚æ€§ã€è¶‹åŠ¿ã€è‡ªç›¸å…³ç­‰å…³é”®è¯çš„é¢å¤–ä»‹ç»ã€‚</h3></div><div class="ps l"><p class="bd b dl z fp pp fr fs pq fu fw dk translated">towardsdatascience.com</p></div></div><div class="pt l"><div class="qa l pv pw px pt py ll pk"/></div></div></a></div><div class="ph pi gp gr pj pk"><a rel="noopener follow" target="_blank" href="/deploying-h2o-models-as-apis-using-flask-42065a4fa567"><div class="pl ab fo"><div class="pm ab pn cl cj po"><h2 class="bd iu gy z fp pp fr fs pq fu fw is bi translated">ä½¿ç”¨ FLASK å°† H2o æ¨¡å‹éƒ¨ç½²ä¸º API</h2><div class="pr l"><h3 class="bd b gy z fp pp fr fs pq fu fw dk translated">æ¨¡å‹è®­ç»ƒã€è°ƒä¼˜å’Œåˆ›å»ºç®€å• API çš„ç«¯åˆ°ç«¯ç¤ºä¾‹(æ²¡æœ‰æŠ€æœ¯æœ¯è¯­)ã€‚</h3></div><div class="ps l"><p class="bd b dl z fp pp fr fs pq fu fw dk translated">towardsdatascience.com</p></div></div><div class="pt l"><div class="qb l pv pw px pt py ll pk"/></div></div></a></div></div></div>    
</body>
</html>