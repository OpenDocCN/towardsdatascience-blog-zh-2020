<html>
<head>
<title>How to Mount a Directory Inside a Docker Container</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Docker容器中挂载目录</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-mount-a-directory-inside-a-docker-container-4cee379c298b?source=collection_archive---------2-----------------------#2020-06-10">https://towardsdatascience.com/how-to-mount-a-directory-inside-a-docker-container-4cee379c298b?source=collection_archive---------2-----------------------#2020-06-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b74f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">专注于编写代码，无需担心环境管理</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/91df48d8cdb504e09d90a385eae711ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bzZMh3W3nvp_h_ye"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马克斯·威廉姆斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="0fa7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di">它</span>在我的机器上工作；那么让我们运送你的机器吧！简而言之，那就是码头工人。它允许我们通过使用容器化技术在任何计算机上运行Docker映像中的应用程序。Docker容器是一个基础OS ( <a class="ae ky" href="https://alpinelinux.org/" rel="noopener ugc nofollow" target="_blank"> alpine </a>、<a class="ae ky" href="https://ubuntu.com/" rel="noopener ugc nofollow" target="_blank"> ubuntu </a>等)的包。)和其他必要的软件依赖项，您可以在docker映像中定义它们。现在，您可以使用该映像创建一个容器，在不同的机器上运行您的应用程序，甚至在云平台上运行(<a class="ae ky" href="https://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank"> AWS </a>、<a class="ae ky" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank"> GCP </a>、<a class="ae ky" href="https://azure.microsoft.com/en-au/" rel="noopener ugc nofollow" target="_blank"> Azure </a>等)。)而不用担心环境管理(开发、测试和生产)。</p><p id="b057" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Docker因其可移植性、安全性和性能而成为DevOps的流行工具之一。在这篇文章中，您将学习Docker的一些基本概念和命令，它们将教您如何在Docker容器中挂载一个目录。我几乎每天都使用Docker进行本地开发——例如，你可以在这里看到我是如何为一个个人项目<a class="ae ky" href="https://github.com/lifeparticle/Heroku-with-Rails-using-Docker" rel="noopener ugc nofollow" target="_blank">Docker化一个Ruby on Rails应用程序的。</a></p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="9574" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">设置</h1><p id="9d3f" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">首先，你需要安装<a class="ae ky" href="https://docs.docker.com/engine/install/" rel="noopener ugc nofollow" target="_blank"> Docker </a>。出于演示的目的，我们将使用预先构建的Ruby和macOS的官方映像。</p><ul class=""><li id="fe03" class="ni nj it lb b lc ld lf lg li nk lm nl lq nm lu nn no np nq bi translated"><strong class="lb iu"> Docker Image: </strong>这是一个包含创建容器指令的模板。</li><li id="d887" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu nn no np nq bi translated"><strong class="lb iu"> Docker容器:</strong>容器是图像的运行实例。</li></ul><p id="3455" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nw nx ny nz b">docker run</code>命令用于从图像运行容器。这里我们使用ruby映像创建容器，但是您也可以使用自己的映像。如果主机上不存在ruby映像，Docker将从<a class="ae ky" href="https://hub.docker.com/" rel="noopener ugc nofollow" target="_blank"> Docker Hub </a>中获取该映像。一旦下载到本地机器上，Docker将使用相同的映像来连续创建容器。要装载一个卷，只需在终端中运行以下代码:</p><pre class="kj kk kl km gt oa nz ob bn oc od bi"><span id="3ba4" class="oe mm it nz b be of og l oh oi">docker run -v /host/directory:/container/directory</span></pre><p id="2ef8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，您将在容器的脚本文件夹中挂载脚本文件夹。这是最佳实践，因为您不必担心不同机器上的环境管理。</p><pre class="kj kk kl km gt oa nz ob bn oc od bi"><span id="3dcd" class="oe mm it nz b be of og l oh oi">docker run -it --rm -v $HOME/Desktop/scripts:/scripts --name scripts ruby bash</span></pre><p id="4efc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">标志<code class="fe nw nx ny nz b">-i -t</code>(通常写为<code class="fe nw nx ny nz b">-it</code>)用于以交互模式访问容器。<code class="fe nw nx ny nz b">--rm</code>标志(可选)在您退出或停止容器以释放系统资源(CPU、内存)时移除容器。如果您在停止或退出容器后不使用它，如果您想释放磁盘空间，必须手动删除它。<code class="fe nw nx ny nz b">-v</code>标志用于挂载一个主机文件夹，它由冒号分隔的两个字段组成。第一部分是主机中的路径。第二部分是容器中的路径。</p><pre class="kj kk kl km gt oa nz ob bn oc od bi"><span id="2e32" class="oe mm it nz b be of og l oj oi">-v /host/directory:/container/directory</span></pre><p id="2d74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nw nx ny nz b">--name</code>标志(可选)用于给容器一个特定的名称。如果你不想提供一个，Docker会随机分配一个名字，所以如果你想更容易地跟踪你的容器，你可以选择一个。<code class="fe nw nx ny nz b">ruby</code>命令用于加载图像。如果你想使用<a class="ae ky" href="https://hub.docker.com/_/ruby" rel="noopener ugc nofollow" target="_blank"> Ruby </a>的<code class="fe nw nx ny nz b">2.5</code>版本，使用<code class="fe nw nx ny nz b">ruby:2.5</code>命令。</p><pre class="kj kk kl km gt oa nz ob bn oc od bi"><span id="ac5f" class="oe mm it nz b be of og l oh oi">docker run -it --rm -v $HOME/Desktop/scripts:/scripts --name scripts ruby:2.5 bash</span></pre><p id="c6c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后但同样重要的是，<code class="fe nw nx ny nz b">bash</code>命令用于获取容器内部的bash shell。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/6eed95c46d386f78d82785e88b807917.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*uPZzWiPHAUdm198E7uo0aA.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Mac上运行</p></figure><p id="014f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要运行python代码，请使用Python映像。</p><pre class="kj kk kl km gt oa nz ob bn oc od bi"><span id="d66a" class="oe mm it nz b be of og l oh oi">docker run -it --rm -v $HOME/Desktop/scripts:/scripts --name scripts python bash</span></pre><h2 id="497d" class="ol mm it bd mn om on dn mr oo op dp mv li oq or mx lm os ot mz lq ou ov nb ow bi translated">停止和移除容器</h2><p id="1941" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">正如我在上面解释的，如果您想要释放系统资源和磁盘空间，您需要停止并删除容器。您可以在主机上运行<code class="fe nw nx ny nz b">docker ps</code>命令来查看正在运行的容器列表。要停止容器，使用带有容器id或容器名称的<code class="fe nw nx ny nz b">docker stop</code>命令。您可以使用<code class="fe nw nx ny nz b">-a</code>标志来查看所有停止或退出的容器。</p><pre class="kj kk kl km gt oa nz ob bn oc od bi"><span id="b06c" class="oe mm it nz b be of og l oh oi">docker stop d61f09eb42ad<br/># or<br/>docker stop scripts</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/9da35ba2c0c9a8716db323ae5d8a1929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UCbACFOpgz6Z3J4FSJVHFw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">docker ps VS docker ps -a</p></figure><p id="ff0d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要手动删除容器，请使用以下命令之一。</p><pre class="kj kk kl km gt oa nz ob bn oc od bi"><span id="076a" class="oe mm it nz b be of og l oh oi">docker rm d61f09eb42ad<br/># or<br/>docker rm scripts</span></pre><h2 id="b478" class="ol mm it bd mn om on dn mr oo op dp mv li oq or mx lm os ot mz lq ou ov nb ow bi translated">移除图像</h2><p id="3f6b" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">如果您想要删除一个图像来释放磁盘空间，例如，您刚刚创建的Ruby图像，使用<code class="fe nw nx ny nz b">docker rmi</code>命令。但是首先，让我们试着去理解引擎盖下到底发生了什么。为此，我们将使用<code class="fe nw nx ny nz b">docker images</code>和<code class="fe nw nx ny nz b"><a class="ae ky" href="https://docs.docker.com/engine/reference/commandline/system_df/" rel="noopener ugc nofollow" target="_blank">docker system df</a></code>命令来显示Docker <a class="ae ky" href="https://en.wikipedia.org/wiki/Daemon_(computing)" rel="noopener ugc nofollow" target="_blank">守护进程</a>的磁盘空间使用信息。<code class="fe nw nx ny nz b">docker images</code>命令列出您机器上的所有图像。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/a6649681901e90dd7a4dc6391bbc7a44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zv6iqKIei4aGrCgnlKeffw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在这种情况下，我的机器上有三个图像</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/22861f86cb6814fa7ff21b09e7f05ad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9YDrBpiFVWcpWO5G-DK29Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">一个活动容器正在使用一个活动图像</p></figure><p id="797e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nw nx ny nz b"><a class="ae ky" href="https://docs.docker.com/engine/reference/commandline/system_df/" rel="noopener ugc nofollow" target="_blank">docker system df</a></code>命令告诉我，我只能要求65%的磁盘空间，因为我仍在运行<strong class="lb iu">脚本</strong>容器，而该容器正在使用ruby映像。如果您添加剩余的两个映像，您将获得65%的可回收磁盘空间。</p><pre class="kj kk kl km gt oa nz ob bn oc od bi"><span id="7588" class="oe mm it nz b be of og l oj oi">933MB (python) + 643MB (java) = 1.576GB (65%)</span></pre><p id="0bac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，通过在停止容器后运行<code class="fe nw nx ny nz b"><a class="ae ky" href="https://docs.docker.com/engine/reference/commandline/system_df/" rel="noopener ugc nofollow" target="_blank">docker system df</a></code>命令，告诉我们现在可以要求100%的磁盘空间。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/982f9d95a5a29017857e1499869bf88c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5uZLcquAYeIWJyKkKwJpsg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">没有活动容器和活动图像</p></figure><p id="e35f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意，如果您试图删除一个容器正在使用的图像，您会得到以下错误。</p><pre class="kj kk kl km gt oa nz ob bn oc od bi"><span id="7597" class="oe mm it nz b be of og l oh oi">Error response from daemon: conflict: unable to delete 121862ceb25f (cannot be forced) - image is being used by running container d61f09eb42ad</span></pre><p id="d12e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们可以使用带有图像id的<code class="fe nw nx ny nz b">docker rmi</code>命令来删除图像。</p><pre class="kj kk kl km gt oa nz ob bn oc od bi"><span id="6310" class="oe mm it nz b be of og l oh oi">docker rmi 121862ceb25f<br/># remove multiple images by putting a space between them<br/>docker rmi efdecc2e377a d23bdf5b1b1b</span></pre></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="3dfd" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">包裹</h1><p id="83ac" class="pw-post-body-paragraph kz la it lb b lc nd ju le lf ne jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">现在您知道了如何在docker容器中挂载一个目录。Docker极大地帮助了我在多台机器上轻松创建本地开发环境，而无需任何额外的努力和时间。这是一项你想放在包里的技能，无论是为了个人还是工业目的。我希望这能帮助你开始接触Docker的神奇世界。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/e6693cb2484cb1a81e2aa34b0c04a372.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*_rFDSKaCofvMSk53UiqdwQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">GIF by <a class="ae ky" href="https://giphy.com/" rel="noopener ugc nofollow" target="_blank"> GIPHY </a></p></figure></div></div>    
</body>
</html>