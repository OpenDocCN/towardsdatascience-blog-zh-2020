<html>
<head>
<title>3 Different Techniques to build Recommender Systems for Restaurants based in San Francisco</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为旧金山的餐馆建立推荐系统的 3 种不同技术</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-different-techniques-to-build-recommender-systems-for-restaurants-based-in-san-francisco-cb5c3754449e?source=collection_archive---------59-----------------------#2020-05-05">https://towardsdatascience.com/3-different-techniques-to-build-recommender-systems-for-restaurants-based-in-san-francisco-cb5c3754449e?source=collection_archive---------59-----------------------#2020-05-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d698" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">饿了吗？这里有一些推荐餐厅的方法！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/90fd1f6f4a691c0503f0c47ffe4028e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eBDVvqtiHWqhNDEa"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@claybanks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">粘土银行</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="cdf5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">生活在像旧金山这样的大都市，这个城市有这么多令人惊叹的餐馆。在本文中，我将构建几个推荐系统来推荐旧金山的类似餐馆。</p><p id="c2a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">收集数据</strong></p><p id="06ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">收集的数据来自 Yelp API。Yelp 提供了一个 API，允许用户查询商家。为了从 Yelp 获取数据，你必须建立一个<a class="ae kv" href="https://www.yelp.com/developers" rel="noopener ugc nofollow" target="_blank">开发者账户</a>并创建一个应用程序。Yelp 将为您生成一个客户端 ID 和 API 密钥，这些凭证将作为您查询数据的身份验证令牌。</p><p id="31cd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个<a class="ae kv" href="https://www.yelp.com/developers/documentation/v3/get_started" rel="noopener ugc nofollow" target="_blank">文档</a>将为您提供如何查询数据的端点。看一看他们。</p><p id="76d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于这种情况，我们感兴趣的是位于旧金山的餐馆和位置。这将是与我的查询相关的端点:</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="be33" class="lx ly iq lt b gy lz ma l mb mc"><a class="ae kv" href="https://api.yelp.com/v3/businesses/search?term=restaurants&amp;location='San" rel="noopener ugc nofollow" target="_blank">https://api.yelp.com/v3/businesses/search?term=restaurants&amp;location='San</a> Francisco'</span></pre><p id="1efe" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过 URL，我们能够查询数据</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="6938" class="lx ly iq lt b gy lz ma l mb mc">import requests</span><span id="0a7c" class="lx ly iq lt b gy md ma l mb mc">req_business_string = "<a class="ae kv" href="https://api.yelp.com/v3/businesses/search?term=restaurants&amp;location='San" rel="noopener ugc nofollow" target="_blank">https://api.yelp.com/v3/businesses/search?term=restaurants&amp;location='San</a> Francisco'"</span><span id="6607" class="lx ly iq lt b gy md ma l mb mc">r = requests.get(req_business_string, <br/>                 headers={"content-type":"application/json", <br/>                          "authorization": "Bearer " + auth_token})</span></pre><p id="5799" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe me mf mg lt b">auth_token</code>将是您创建应用程序时提供给您的 API 密钥。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="bbb8" class="lx ly iq lt b gy lz ma l mb mc">json = r.json()<br/>businesses = json['businesses']</span></pre><p id="c204" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过运行上面的命令，您将能够从 API 收集业务。请记住，上面的字符串被过滤到旧金山的餐馆，这是将返回的结果。现在你有了旧金山餐馆的数据。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="d8c2" class="lx ly iq lt b gy lz ma l mb mc">{'id': 'f-m7-hyFzkf0HSEeQ2s-9A',<br/>  'alias': 'fog-harbor-fish-house-san-francisco-2',<br/>  'name': 'Fog Harbor Fish House',<br/>  'image_url': 'https://s3-media1.fl.yelpcdn.com/bphoto/Lv7tIRX3Bim9bKqtWifmNg/o.jpg',<br/>  'is_closed': False,<br/>  'url': 'https://www.yelp.com/biz/fog-harbor-fish-house-san-francisco-2?adjust_creative=vBso-HM6oooiiw4hc86H-A&amp;utm_campaign=yelp_api_v3&amp;utm_medium=api_v3_business_search&amp;utm_source=vBso-HM6oooiiw4hc86H-A',<br/>  'review_count': 6050,<br/>  'categories': [{'alias': 'seafood', 'title': 'Seafood'},<br/>   {'alias': 'bars', 'title': 'Bars'}],<br/>  'rating': 4.0,<br/>  'coordinates': {'latitude': 37.809041, 'longitude': -122.410233},<br/>  'transactions': ['restaurant_reservation'],<br/>  'price': '$$',<br/>  'location': {'address1': 'Pier 39',<br/>   'address2': 'Ste A-202',<br/>   'address3': '',<br/>   'city': 'San Francisco',<br/>   'zip_code': '94133',<br/>   'country': 'US',<br/>   'state': 'CA',<br/>   'display_address': ['Pier 39', 'Ste A-202', 'San Francisco, CA 94133']},<br/>  'phone': '+14154212442',<br/>  'display_phone': '(415) 421-2442',<br/>  'distance': 5827.740044156521}</span></pre><p id="4b41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是返回的结果。</p><p id="9bd4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了获取餐馆数据，我们还想收集特定餐馆的评论。我们可以通过查看<a class="ae kv" href="https://www.yelp.com/developers/documentation/v3/business_reviews" rel="noopener ugc nofollow" target="_blank">评论端点</a>并执行类似的查询来查询数据。</p><p id="694b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了餐馆和评论的数据。我们将保存到一个 csv 文件中，这样我们就不需要再次查询 Yelp API。</p><p id="29b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">分析数据</strong></p><p id="08a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">流程的下一步是理解数据和分析数据。基于上一步，我将数据存储在一个 csv 文件中。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="8684" class="lx ly iq lt b gy lz ma l mb mc">import pandas as pd</span><span id="6512" class="lx ly iq lt b gy md ma l mb mc">restaurants_df = pd.read_csv('data/restaurants.csv')<br/>restaurants_df.head()</span></pre><p id="9c11" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将数据保存到一个名为<code class="fe me mf mg lt b">restaurants.csv</code>的数据文件夹中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mh"><img src="../Images/e902baac0cf75b56c9e0528c9e1552d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ExFW2o25fJAlguEvZWYMxg.png"/></div></div></figure><p id="0f77" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是 restaurants 表的屏幕截图，某些列以数组或散列格式表示。这不是建模的理想格式，我们必须将数据转换成数字格式。类似地，reviews 表确实将用户作为散列格式，我们希望解析它，以便每一列都表示一个值，而不是一个散列。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mi"><img src="../Images/e26007927b50db5837cfc2ae4ef1c681.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YS9XVoBaieh4AGnr"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@solitsocial?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">拉斯·维格</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="0471" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">清除数据</strong></p><p id="aaba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了进行建模，我们需要以正确的格式准备和修改数据。这包括一次热编码，并将散列分解成每一列的单个值。</p><p id="1706" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">查看餐馆表，我们有散列格式的类别、坐标和位置。我们必须将它们转换成单值列。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="d77d" class="lx ly iq lt b gy lz ma l mb mc">import ast<br/>address = []<br/>city = []<br/>state = []<br/>country = []<br/>zipcode = []<br/>for idx, row in restaurants_df.iterrows():<br/>    location = ast.literal_eval(row['location'])<br/>    address.append(location['address1'])<br/>    city.append(location['city'])<br/>    state.append(location['state'])<br/>    country.append(location['country'])<br/>    zipcode.append(location['zip_code'])<br/>    <br/>address_df = pd.DataFrame(address).rename(columns={0: 'address'})<br/>city_df = pd.DataFrame(city).rename(columns={0: 'city'})<br/>state_df = pd.DataFrame(state).rename(columns={0: 'state'})<br/>country_df = pd.DataFrame(country).rename(columns={0: 'country'})<br/>zip_code_df = pd.DataFrame(zipcode).rename(columns={0: 'zip_code'})</span><span id="5797" class="lx ly iq lt b gy md ma l mb mc">lat = []<br/>long = []<br/>for idx, row in restaurants_df.iterrows():<br/>    coord = ast.literal_eval(row['coordinates'])<br/>    lat.append(coord['latitude'])<br/>    long.append(coord['longitude'])<br/>    <br/>lat_df = pd.DataFrame(lat).rename(columns={0: 'latitude'})<br/>long_df = pd.DataFrame(long).rename(columns={0: 'longitude'})</span><span id="3921" class="lx ly iq lt b gy md ma l mb mc">categories_hash = {}<br/>for idx, row in enumerate(restaurants_df['categories']):<br/>    lst = []<br/>    rows = ast.literal_eval(row)<br/>    for cat in rows:<br/>        lst.append(cat['title'])<br/>        <br/>    categories_hash[idx] = ", ".join(lst)<br/>categories_df = pd.DataFrame.from_dict(categories_hash, orient='index').rename(columns={0: 'cuisines'})</span></pre><p id="1d9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的代码将把散列转换成具有特定值的独立数据帧。</p><p id="15e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有了这些创建的数据帧，我们可以通过在数据帧上执行一个<code class="fe me mf mg lt b">get_dummies</code>方法来执行一次热编码。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="2c83" class="lx ly iq lt b gy lz ma l mb mc">cuis = categories_df['cuisines'].str.split(", ")<br/>cuisines_dummies = pd.get_dummies(cuis.apply(pd.Series).stack()).sum(level=0)</span><span id="c4d4" class="lx ly iq lt b gy md ma l mb mc">transaction_df = pd.DataFrame(restaurants_df['transactions'].apply(lambda x: ", ".join(ast.literal_eval(x)) if len(ast.literal_eval(x)) &gt; 0 else "none"))<br/>trans = transaction_df['transactions'].str.split(", ")<br/>transaction_dummies = pd.get_dummies(trans.apply(pd.Series).stack()).sum(level=0)</span></pre><p id="e0dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦它们被转换为 one-hot 编码，我们就可以连接数据帧并删除不相关的列(出于建模的目的，我们需要这些列采用数字格式，因此可以删除带有字符串的列)。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="b253" class="lx ly iq lt b gy lz ma l mb mc">restaurants_sim_df = pd.concat([restaurants_df, lat_df, long_df, address_df, city_df, state_df, country_df, zip_code_df, cuisines_dummies, transaction_dummies], axis=1).drop(columns=['categories', 'coordinates', 'is_closed', 'transactions', 'phone', 'location', '_id', 'id', 'alias', 'name', 'image_url', 'url', 'review_count','display_phone', 'address', 'city', 'state', 'country','zip_code', 'distance', 'delivery', 'none', 'pickup', 'restaurant_reservation'])</span></pre><p id="1d73" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个片段中，我将原始数据帧与创建的其他数据帧连接起来。我删除了不需要的列。在最终结果中，我只剩下带有数值的列。</p><p id="963f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">推荐系统</strong></p><p id="c3bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章中，我将使用不同的技术构建 3 个不同的推荐系统。</p><ol class=""><li id="5ed4" class="mj mk iq ky b kz la lc ld lf ml lj mm ln mn lr mo mp mq mr bi translated">利用餐馆特征的内容过滤</li><li id="66ef" class="mj mk iq ky b kz ms lc mt lf mu lj mv ln mw lr mo mp mq mr bi translated">使用自然语言处理的基于内容的过滤</li><li id="b444" class="mj mk iq ky b kz ms lc mt lf mu lj mv ln mw lr mo mp mq mr bi translated">基于模型的协同过滤</li></ol><p id="1e7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">基于内容的过滤</strong></p><ul class=""><li id="62a2" class="mj mk iq ky b kz la lc ld lf ml lj mm ln mn lr mx mp mq mr bi translated">餐馆的特点</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/2cebb43c56846545dc246e5cf1d27e74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5TZr4-sh7gJpE-Yj"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@campaign_creators?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">活动创建者</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="1374" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于这个推荐系统，我们正在寻找具有相似特征的推荐餐馆，即美食、位置、价格、交易。</p><p id="f9a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">利用这些因素，我们基于以上使用余弦相似度创建了一个矩阵来推荐餐馆。余弦相似性是基于向量的相似性度量。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="bdfd" class="lx ly iq lt b gy lz ma l mb mc">from sklearn.metrics.pairwise import cosine_similarity</span><span id="9c80" class="lx ly iq lt b gy md ma l mb mc">cos_sim = cosine_similarity(restaurants_sim_df, restaurants_sim_df)</span></pre><ul class=""><li id="27de" class="mj mk iq ky b kz la lc ld lf ml lj mm ln mn lr mx mp mq mr bi translated">自然语言处理</li></ul><p id="2e97" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这项技术中，我们将使用文本来推荐餐馆。该文本将来自用户的评论和类似的餐馆，有类似的文本将被推荐。</p><p id="970e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将查看由 reviews 端点生成的 reviews 表。它有不同餐馆用户的评论，包括评论的描述。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="1f0d" class="lx ly iq lt b gy lz ma l mb mc">reviews_df = user_reviews_df.groupby('slug').agg({'text': ' '.join})</span></pre><p id="704d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们必须将来自相同餐馆的所有文本组合成一行。例如，B &amp; C 的评论 A 可能属于餐馆 A。我们将把这些评论组合在一起，以便它们代表单个餐馆的相同评论。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="1ac7" class="lx ly iq lt b gy lz ma l mb mc">from nltk.corpus import stopwords<br/>import string<br/>from nltk.tokenize import sent_tokenize<br/>from nltk.tokenize import word_tokenize<br/>import nltk<br/>nltk.download('words')<br/>words = set(nltk.corpus.words.words())</span><span id="c554" class="lx ly iq lt b gy md ma l mb mc">stopwords_ = set(stopwords.words('english'))<br/>punctuation_ = set(string.punctuation)</span><span id="fbe3" class="lx ly iq lt b gy md ma l mb mc">def filter_tokens(sent):<br/>    return([w for w in sent if not w in stopwords_ and not w in punctuation_])</span><span id="4266" class="lx ly iq lt b gy md ma l mb mc">def cleaned_text(string):<br/>    word_list = []<br/>    sent_tokens = sent_tokenize(string)<br/>    tokens = [sent for sent in map(word_tokenize, sent_tokens)]<br/>    <br/>    tokens_lower = [[word.lower() for word in sent]<br/>                 for sent in tokens]<br/>    tokens_filtered = list(map(filter_tokens, tokens_lower))<br/>    for tlist in tokens_filtered:<br/>        for w in tlist:<br/>            if w != '...':<br/>                word_list.append(w)<br/>            <br/>    return " ".join(word_list)</span><span id="58ba" class="lx ly iq lt b gy md ma l mb mc">reviews_df['cleaned_text'] = reviews_df['text'].apply(lambda t: cleaned_text(t))</span></pre><p id="3899" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这一步中，我们对文本进行清理，例如删除停用词和标点符号。</p><p id="dcc7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe me mf mg lt b">cleaned_text</code>表示删除了停用词和标点符号的文本。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="28ae" class="lx ly iq lt b gy lz ma l mb mc">from sklearn.feature_extraction.text import CountVectorizer</span><span id="f392" class="lx ly iq lt b gy md ma l mb mc">corpus = reviews_df['cleaned_text']</span><span id="3621" class="lx ly iq lt b gy md ma l mb mc">tf = CountVectorizer()</span><span id="cf45" class="lx ly iq lt b gy md ma l mb mc">document_tf_matrix = tf.fit_transform(corpus)<br/>doc_sim = cosine_similarity(document_tf_matrix, document_tf_matrix)</span></pre><p id="a520" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用计数矢量器创建矩阵，并执行余弦相似性。</p><p id="58bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">基于模型的协同过滤</strong></p><p id="602f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这项技术中，我们将需要一个用户项过滤。最后两种技术是逐项过滤。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/53034508f2a4ec6479589f392563462a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tLyEUITS_OKMYFCS"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@voodushevlyonniy?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">瓦列里·安德鲁斯科</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="02fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在 reviews 表中，我们有餐馆名称、用户名和评级。我们可以创建一个新的矩阵，只包含这些列，这样它将成为一个用户条目矩阵。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="bb31" class="lx ly iq lt b gy lz ma l mb mc">ratings_df = reviews_df.merge(restaurants_name_df, left_on='slug', right_on='alias')<br/>ratings_df.drop(columns=['slug', 'alias'], inplace=True)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/bebc344200f67786596eb9e3fa50e046.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_oxnYr0BMx5UgBFA0iyiXg.png"/></div></div></figure><p id="af41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它看起来会是什么样子的截图</p><p id="95d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以在此基础上创建一个数据透视表</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="9f9a" class="lx ly iq lt b gy lz ma l mb mc">ratings_crosstab = ratings_df.pivot_table(values='rating', index='user_id', columns='name', fill_value=0)</span></pre><p id="5fb0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于大多数值将为 null(并非所有用户都会查看所有餐馆)，所以我用 0 填充了这些值。</p><p id="351a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看这个表，我们在这个矩阵中有许多行(餐馆)和列(用户)。为了减少列数，我们使用奇异值分解(SVD)将用户数减少到 x 列数(因子)。要阅读更多关于 SVD 的内容，请点击这里的<a class="ae kv" href="https://en.wikipedia.org/wiki/Singular_value_decomposition" rel="noopener ugc nofollow" target="_blank"/>。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="6e4e" class="lx ly iq lt b gy lz ma l mb mc">import numpy as np<br/>import sklearn<br/>from sklearn.decomposition import TruncatedSVD</span><span id="55eb" class="lx ly iq lt b gy md ma l mb mc">SVD = TruncatedSVD(n_components=12, random_state=17)<br/>resultant_matrix = SVD.fit_transform(ratings_crosstab.values.T)</span></pre><p id="562a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以生成相关矩阵</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="d56c" class="lx ly iq lt b gy lz ma l mb mc">corr_mat = np.corrcoef(resultant_matrix)</span></pre><p id="be84" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦生成了相关矩阵，我们就能够根据索引推荐餐馆。</p><p id="5194" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想看看我是如何用不同的推荐技术生成餐馆的，请看看知识库！</p><div class="nb nc gp gr nd ne"><a href="https://github.com/yueweng/yelp_recommender_restaurants" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd ir gy z fp nj fr fs nk fu fw ip bi translated">悦翁/yelp _ 推荐者 _ 餐厅</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">Yelp 提供了一个我可以查询商家的 API。在这个项目中，我专注于获得餐厅，所以…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">github.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns kp ne"/></div></div></a></div></div></div>    
</body>
</html>