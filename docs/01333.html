<html>
<head>
<title>A Machine Learning Project — Predicting Used Car Prices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习项目——预测二手车价格</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-machine-learning-project-predicting-used-car-prices-efbc4d2a4998?source=collection_archive---------6-----------------------#2020-02-06">https://towardsdatascience.com/a-machine-learning-project-predicting-used-car-prices-efbc4d2a4998?source=collection_archive---------6-----------------------#2020-02-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="470a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你的第一个机器学习项目的逐步指南！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bf964b569d15bc55f877e88076cae65a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yYO3RWUaSWwNdfQ9PExMPQ.png"/></div></div></figure><p id="bbcd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是给那些想进入数据科学的人，他们有一点点知识，但很难想出你的第一个数据科学项目。这就是为什么我创建了一个逐步指南来完成您的第一个端到端机器学习模型！跟着做，你会学到很多新技能。</p><p id="f40d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我使用了<a class="ae lq" href="https://www.kaggle.com/austinreese/craigslist-carstrucks-data" rel="noopener ugc nofollow" target="_blank"> Kaggle的二手车数据集</a>，因为它有各种分类和数字数据，并允许您探索处理缺失数据的不同方式。我把我的项目分成三部分:</p><ol class=""><li id="d4a1" class="lr ls it kw b kx ky la lb ld lt lh lu ll lv lp lw lx ly lz bi translated"><a class="ae lq" href="#c0d7" rel="noopener ugc nofollow">探索性数据分析</a></li><li id="41df" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated"><a class="ae lq" href="#207c" rel="noopener ugc nofollow">数据建模</a></li><li id="2797" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated"><a class="ae lq" href="#eced" rel="noopener ugc nofollow">特征重要性</a></li></ol></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="c0d7" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">1.探索性数据分析</h1><h2 id="f66e" class="ne mn it bd mo nf ng dn ms nh ni dp mw ld nj nk my lh nl nm na ll nn no nc np bi translated">了解我的数据</h2><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="295e" class="ne mn it nr b gy nv nw l nx ny"><em class="nz"># Importing Libraries and Data</em><br/>import numpy as np<br/>import pandas as pd <em class="nz"># data processing, CSV file I/O (e.g. pd.read_csv)</em><br/>import os<br/>for dirname, _, filenames <strong class="nr iu">in</strong> os.walk('/kaggle/input'):<br/>    for filename <strong class="nr iu">in</strong> filenames:<br/>        print(os.path.join(dirname, filename))</span><span id="edd6" class="ne mn it nr b gy oa nw l nx ny">df = pd.read_csv("../input/craigslist-carstrucks-data/vehicles.csv")<em class="nz"># Get a quick glimpse of what I'm working with</em><br/>print(df.shape)<br/>print(df.columns)<br/>df.head()</span></pre><p id="012f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在处理数据科学问题时，我总是做的第一件事是了解我正在处理的数据集。使用<strong class="kw iu"> df.shape </strong>、<strong class="kw iu"> df.columns </strong>和<strong class="kw iu"> df.head() </strong>，我能够看到我正在处理的特性以及每个特性需要什么。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/fdd85f8e3a7096ea25c99e310a3841be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*r1p26MzAg0TZrz6S.png"/></div></div></figure><h2 id="f032" class="ne mn it bd mo nf ng dn ms nh ni dp mw ld nj nk my lh nl nm na ll nn no nc np bi translated">探索分类数据</h2><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="aff3" class="ne mn it nr b gy nv nw l nx ny">df.nunique(axis=0)</span></pre><p id="bf5d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我喜欢使用<strong class="kw iu"> df.nunique(axis=0) </strong>，来查看每个变量有多少个唯一值。利用这个，我可以看到是否有什么不寻常的事情，并找出任何潜在的问题。例如，如果它显示有60个州，这将引发一个红旗，因为只有50个州。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/5b7e74114e02557a1ae4648047f12233.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4fKx4SOEuly3je0c.png"/></div></div></figure><h2 id="c9a2" class="ne mn it bd mo nf ng dn ms nh ni dp mw ld nj nk my lh nl nm na ll nn no nc np bi translated">探索数字数据</h2><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="5df6" class="ne mn it nr b gy nv nw l nx ny">df.describe().apply(lambda s: s.apply(lambda x: format(x, 'f')))</span></pre><p id="6ea6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于数字数据，我使用<strong class="kw iu"> df.describe() </strong>来快速浏览我的数据。例如，我可以立即看到<em class="nz">价格、</em>的问题，因为最低价格是0美元，最高价格是3，600，028，900美元。</p><p id="5d9e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">稍后，您将看到我是如何处理这些不切实际的异常值的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/8230db8d22af399efbb6d023609aa7f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NeLzOQZgpdtM-1tV.png"/></div></div></figure><h2 id="a31b" class="ne mn it bd mo nf ng dn ms nh ni dp mw ld nj nk my lh nl nm na ll nn no nc np bi translated">包含太多空值的列</h2><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="f7af" class="ne mn it nr b gy nv nw l nx ny">NA_val = df.isna().sum()</span><span id="04fd" class="ne mn it nr b gy oa nw l nx ny">def na_filter(na, threshold = .4): <em class="nz">#only select variables that passees the threshold</em><br/>    col_pass = []<br/>    for i <strong class="nr iu">in</strong> na.keys():<br/>        if na[i]/df.shape[0]&lt;threshold:<br/>            col_pass.append(i)<br/>    return col_pass</span><span id="7a7f" class="ne mn it nr b gy oa nw l nx ny">df_cleaned = df[na_filter(NA_val)]<br/>df_cleaned.columns</span></pre><p id="1b21" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在继续我的EDA的其余部分之前，我使用上面的代码删除了超过40%的值为null的所有列。这使我剩下下面的专栏。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/b919b5d5d6160a164023d1b50f91d3f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vDhmjBb_oTHAM3jG.png"/></div></div></figure><h2 id="5e11" class="ne mn it bd mo nf ng dn ms nh ni dp mw ld nj nk my lh nl nm na ll nn no nc np bi translated">移除异常值</h2><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="60d1" class="ne mn it nr b gy nv nw l nx ny">df_cleaned = df_cleaned[df_cleaned['price'].between(999.99, 250000)] <em class="nz"># Computing IQR</em><br/>Q1 = df_cleaned['price'].quantile(0.25)<br/>Q3 = df_cleaned['price'].quantile(0.75)<br/>IQR = Q3 - Q1</span><span id="4686" class="ne mn it nr b gy oa nw l nx ny"><em class="nz"># Filtering Values between Q1-1.5IQR and Q3+1.5IQR</em><br/>df_filtered = df_cleaned.query('(@Q1 - 1.5 * @IQR) &lt;= price &lt;= (@Q3 + 1.5 * @IQR)')<br/>df_filtered.boxplot('price')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/9c541762a4fc1204e2b9510fbcbfe061.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/0*R2nS9azhXErwO_jC.png"/></div></figure><p id="4cc6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在使用四分位(IQR)方法移除价格的异常值之前，我决定将<em class="nz">价格</em>的范围设置为更现实的数字，这样标准差将被计算为比9，575，025更现实的数字。</p><p id="d271" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">IQR也称为中间值，是一种统计离差的度量，可用于识别和移除异常值。IQR范围规则的理论如下:</p><ol class=""><li id="e5b9" class="lr ls it kw b kx ky la lb ld lt lh lu ll lv lp lw lx ly lz bi translated">计算IQR (=第三个四分位数-第一个四分位数)</li><li id="4d7f" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">找出范围的最小值(=第一个四分位数— 1.5 * IQR)</li><li id="77a8" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">找出范围的最大值(=第三个四分位数+ 1.5 * IQR)</li><li id="1b11" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">删除任何超出此范围的值。</li></ol><p id="29e6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以在上面的方框图中看到，我使用这种方法显著缩小了<em class="nz">价格</em>的范围。</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="4db8" class="ne mn it nr b gy nv nw l nx ny">df_filtered.describe().apply(lambda s: s.apply(lambda x: format(x, 'f')))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/baaeed7ee37fb0a2cc280ed00886f203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XkTHqWdjTiciFF-g.png"/></div></div></figure><p id="de92" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用<strong class="kw iu">。describe() </strong>同样，我们可以看到价格范围似乎比最初更现实，但年份和里程表似乎有点偏离(例如，2021年的最大值)。</p><p id="0aba" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我使用下面的代码将年份范围设置为1900–2020，将里程表设置为0–271，341.5。</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="1a59" class="ne mn it nr b gy nv nw l nx ny"><em class="nz"># cant be newer than 2020</em><br/>df_filtered = df_filtered[df_filtered['year'].between(1900, 2020)]<em class="nz"># = 140000 + 1.5 * (140000-52379)</em><br/>df_filtered = df_filtered[df_filtered['odometer'].between(0, 271431.5)]</span></pre><h2 id="70d6" class="ne mn it bd mo nf ng dn ms nh ni dp mw ld nj nk my lh nl nm na ll nn no nc np bi translated">删除剩余的列</h2><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="411e" class="ne mn it nr b gy nv nw l nx ny">df_final = df_filtered.copy().drop(['id','url','region_url','image_url','region','description','model','state','paint_color'], axis=1<br/>df_final.shape</span></pre><p id="c448" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">通过部分使用我的直觉，部分猜测和检查，我删除了以下几列:</p><ul class=""><li id="0705" class="lr ls it kw b kx ky la lb ld lt lh lu ll lv lp oh lx ly lz bi translated"><em class="nz"> url </em>，<em class="nz"> id </em>，<em class="nz"> region_url </em>，<em class="nz"> image_url: </em>它们与正在进行的分析完全无关</li><li id="8289" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp oh lx ly lz bi translated"><em class="nz">描述</em>:描述可能可以使用自然语言处理，但是超出了本项目的范围，因此不予考虑</li><li id="0d28" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp oh lx ly lz bi translated"><em class="nz">地区，州:</em>我去掉了这些，因为它们本质上传达的信息和经度和纬度是一样的。</li><li id="8012" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp oh lx ly lz bi translated"><em class="nz"> model </em>:我去掉了这个，因为有太多不同的值，无法将其转换为虚拟变量。此外，我不能使用标签编码，因为值是无序的。</li><li id="51c1" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp oh lx ly lz bi translated"><em class="nz"> paint_color </em>:最后我在进行了特征重要性(稍后你会看到)后去掉了这个。由于特征重要性表明<em class="nz"> paint_color </em>在确定<em class="nz">价格</em>中的重要性很小，所以我将其移除，模型的准确性提高了。</li></ul><h2 id="c466" class="ne mn it bd mo nf ng dn ms nh ni dp mw ld nj nk my lh nl nm na ll nn no nc np bi translated">可视化变量和关系</h2><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="203f" class="ne mn it nr b gy nv nw l nx ny">import matplotlib.pylab as plt<br/>import seaborn as sns</span><span id="e7dd" class="ne mn it nr b gy oa nw l nx ny"><em class="nz"># calculate correlation matrix</em><br/>corr = df_final.corr()<em class="nz"># plot the heatmap</em><br/>sns.heatmap(corr, xticklabels=corr.columns, yticklabels=corr.columns, annot=True, cmap=sns.diverging_palette(220, 20, as_cmap=True))</span></pre><p id="eb93" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">清理完数据后，我想可视化我的数据，并更好地理解不同变量之间的关系。利用<strong class="kw iu"> sns.heatmap() </strong>我们可以看到<em class="nz">年份</em>与<em class="nz">价格</em>正相关<em class="nz">里程表</em>与<em class="nz">价格</em>负相关——这个有道理！看来我们走对了路。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/d1b2ca3674d0c3d5f1b45113c4384e7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6fguU-_JkIEbyDWe.png"/></div></div></figure><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="dd16" class="ne mn it nr b gy nv nw l nx ny">df_final['manufacturer'].value_counts().plot(kind='bar')df_cleaned['type'].value_counts().plot(kind='bar')</span></pre><p id="2f28" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">出于我自己的兴趣，我使用条形图绘制了一些分类属性(见下文)。为了更好地了解数据集，您还可以做更多的可视化工作，如散点图和箱线图，但我们将进入下一部分，数据建模！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/d8712699ca773ca01256cf07daf2cd25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YifYnsr5AVSjhfgL.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/16e01c37d7bb20b30de90d6049216ac7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4B0uHcfecbw8_Suo.png"/></div></div></figure></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="207c" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">数据建模</h1><h2 id="7082" class="ne mn it bd mo nf ng dn ms nh ni dp mw ld nj nk my lh nl nm na ll nn no nc np bi translated">虚拟变量</h2><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="85ee" class="ne mn it nr b gy nv nw l nx ny">df_final = pd.get_dummies(df_final, drop_first=True)<br/>print(df_final.columns)</span></pre><p id="826b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了能够在我的随机森林模型中使用分类数据，我使用了<strong class="kw iu"> pd.get_dummies()。这实质上是将变量的每个唯一值变成它自己的二进制变量。例如，如果制造商之一是本田，那么将创建一个名为“manufacturer_honda”的新虚拟变量，如果是本田，它将等于1，否则等于0。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/796663fd7be823cd6c11d2fa91b3e815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_M1QlwlExIVqhEuo.png"/></div></div></figure><h2 id="cbaf" class="ne mn it bd mo nf ng dn ms nh ni dp mw ld nj nk my lh nl nm na ll nn no nc np bi translated">缩放数据</h2><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="00af" class="ne mn it nr b gy nv nw l nx ny">from sklearn.preprocessing import StandardScaler<br/>X_head = df_final.iloc[:, df_final.columns != 'price']</span><span id="46e0" class="ne mn it nr b gy oa nw l nx ny">X = df_final.loc[:, df_final.columns != 'price']<br/>y = df_final['price']<br/>X = StandardScaler().fit_transform(X)</span></pre><p id="bfa8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来，我使用<strong class="kw iu">标准缩放器</strong>缩放数据。Prasoon提供了一个很好的答案<a class="ae lq" href="https://www.quora.com/Why-do-we-normalize-the-data" rel="noopener ugc nofollow" target="_blank">这里</a>为什么我们要缩放(或标准化)我们的数据，但本质上，这样做是为了我们的自变量的缩放不会影响我们模型的组成。例如，<em class="nz">年</em>的最大数字是2020，<em class="nz">里程表</em>的最大数字超过20万。如果我们不对数据进行缩放，里程表<em class="nz">的一个小变化</em>会比<em class="nz">年</em>的同样变化产生更大的影响。</p><h2 id="943c" class="ne mn it bd mo nf ng dn ms nh ni dp mw ld nj nk my lh nl nm na ll nn no nc np bi translated">创建模型</h2><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="8a1c" class="ne mn it nr b gy nv nw l nx ny">from sklearn.ensemble import RandomForestRegressor<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.metrics import mean_absolute_error as mae</span><span id="b25b" class="ne mn it nr b gy oa nw l nx ny">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.25, random_state=0)<br/>model = RandomForestRegressor(random_state=1)<br/>model.fit(X_train, y_train)<br/>pred = model.predict(X_test)</span></pre><p id="6d52" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我决定使用随机森林算法有几个原因:</p><ol class=""><li id="5355" class="lr ls it kw b kx ky la lb ld lt lh lu ll lv lp lw lx ly lz bi translated">它<strong class="kw iu">很好地处理了高维度</strong>，因为它采用了数据子集。</li><li id="ae53" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">它非常通用，并且只需要很少的预处理</li><li id="bc8f" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">这在<strong class="kw iu">避免过度拟合</strong>方面很棒，因为每个决策树都具有低偏差</li><li id="a954" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">它允许您检查<strong class="kw iu">特性重要性</strong>，您将在下一节看到！</li></ol><h2 id="fc63" class="ne mn it bd mo nf ng dn ms nh ni dp mw ld nj nk my lh nl nm na ll nn no nc np bi translated">检查模型的准确性</h2><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="a798" class="ne mn it nr b gy nv nw l nx ny">print(mae(y_test, pred))<br/>print(df_final['price'].mean())model.score(X_test,y_test)</span></pre><p id="6a42" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">总的来说，我的模型在平均价格为12600美元左右的情况下实现了1590美元的MAE，准确率为90.5%！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/1d783e658b9f967b44a87b6ec8a13a2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VKU3iJRvCk7bgJJP.png"/></div></div><p class="on oo gj gh gi op oq bd b be z dk translated">MAE和平均价格</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/fed34c97bc810880998d38744ce2e332.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8-ZjG4DixGCwMim3.png"/></div></div><p class="on oo gj gh gi op oq bd b be z dk translated">模型的准确性</p></figure><h1 id="eced" class="mm mn it bd mo mp os mr ms mt ot mv mw jz ou ka my kc ov kd na kf ow kg nc nd bi translated">特征重要性</h1><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="9c33" class="ne mn it nr b gy nv nw l nx ny">feat_importances = pd.Series(model.feature_importances_, index=X_head.columns)<br/>feat_importances.nlargest(25).plot(kind='barh',figsize=(10,10))</span></pre><p id="c918" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我花了很多时间寻找特性重要性的最佳定义，Christoph Molnar提供了最佳定义(见<a class="ae lq" href="https://christophm.github.io/interpretable-ml-book/feature-importance.html" rel="noopener ugc nofollow" target="_blank">这里</a>)。他说:</p><blockquote class="ox oy oz"><p id="b404" class="ku kv nz kw b kx ky ju kz la lb jx lc pa le lf lg pb li lj lk pc lm ln lo lp im bi translated">我们通过计算置换特征后模型预测误差的增加来衡量特征的重要性。如果打乱某个特征的值会增加模型误差，则该特征是“重要的”，因为在这种情况下，模型依赖于该特征进行预测。“如果改变某个特征的值而不改变模型误差，则该特征是“不重要的”，因为在这种情况下，模型在预测中忽略了该特征。”</p></blockquote><p id="3147" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">鉴于此，我们可以看到决定<em class="nz">价格</em>的三个最重要的特征是<em class="nz">年份、驱动(如果是前轮驱动的话)</em>和<em class="nz">里程表。</em>特性重要性是向非技术人员合理化和解释您的模型的好方法。如果您需要降低维度，它对于特征选择也非常有用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/f501679dfdfa85fec630c9c0dd2fab62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q0yquGB4FDSEporB.png"/></div></div></figure><p id="875b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我的项目到此为止！我希望这能激励那些想进入数据科学的人真正开始。请在评论中让我知道你将来还想看到哪些有趣的项目:)</p><blockquote class="ox oy oz"><p id="0119" class="ku kv nz kw b kx ky ju kz la lb jx lc pa le lf lg pb li lj lk pc lm ln lo lp im bi translated">更多类似的文章，请查看https://blog.datatron.com/的<a class="ae lq" href="https://blog.datatron.com/" rel="noopener ugc nofollow" target="_blank"/></p></blockquote><h1 id="32ea" class="mm mn it bd mo mp os mr ms mt ot mv mw jz ou ka my kc ov kd na kf ow kg nc nd bi translated">感谢阅读！</h1><p id="d1b7" class="pw-post-body-paragraph ku kv it kw b kx pe ju kz la pf jx lc ld pg lf lg lh ph lj lk ll pi ln lo lp im bi translated">如果你喜欢我的工作，想支持我…</p><ol class=""><li id="9327" class="lr ls it kw b kx ky la lb ld lt lh lu ll lv lp lw lx ly lz bi translated">支持我的最好方式就是在<strong class="kw iu">媒体</strong>T2上关注我。</li><li id="64a1" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">在<strong class="kw iu">推特</strong> <a class="ae lq" href="https://twitter.com/terence_shin" rel="noopener ugc nofollow" target="_blank">这里</a>成为第一批关注我的人之一。我会在这里发布很多更新和有趣的东西！</li><li id="79b1" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">此外，成为第一批订阅我的新<strong class="kw iu"> YouTube频道</strong> <a class="ae lq" href="https://www.youtube.com/channel/UCmy1ox7bo7zsLlDo8pOEEhA?view_as=subscriber" rel="noopener ugc nofollow" target="_blank">这里</a>！</li><li id="8009" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">在<strong class="kw iu"> LinkedIn </strong> <a class="ae lq" href="https://www.linkedin.com/in/terenceshin/" rel="noopener ugc nofollow" target="_blank">这里</a>关注我。</li><li id="26c2" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">在我的<strong class="kw iu">邮箱列表</strong> <a class="ae lq" href="https://forms.gle/UGdTom9G6aFGHzPD9" rel="noopener ugc nofollow" target="_blank">这里</a>报名。</li><li id="0177" class="lr ls it kw b kx ma la mb ld mc lh md ll me lp lw lx ly lz bi translated">查看我的网站，<a class="ae lq" href="https://terenceshin.com/" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">terenceshin.com</strong></a>。</li></ol></div></div>    
</body>
</html>