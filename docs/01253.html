<html>
<head>
<title>Pulling Tweets into R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将推文拉入 R</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pulling-tweets-into-r-e17d4981cfe2?source=collection_archive---------17-----------------------#2020-02-04">https://towardsdatascience.com/pulling-tweets-into-r-e17d4981cfe2?source=collection_archive---------17-----------------------#2020-02-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="cef9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">链接 Twitter 的 API 的教程</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/91958c2d4f10db87c0ccd0e65dbdd091.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FVPoz4p3-t7lHrZk"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Kon Karampelas 在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="6337" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我将向您展示建立 Twitter 开发者帐户所需的步骤，这样您就可以利用他们的 API，然后将 tweets 直接拉入您的 R Studio 环境中。</p><h1 id="3a73" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">1.申请一个 Twitter 开发者账户</h1><p id="8cf4" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">你需要一个 Twitter 开发者账户，因为它可以让你访问一个个性化的 API 密匙，这是我们以后需要的。这个密钥对每个帐户都是唯一的，所以你不能共享它。</p><p id="c608" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">访问<a class="ae kv" href="http://developer.twitter.com/" rel="noopener ugc nofollow" target="_blank"> Twitter 开发者</a>并创建一个账户。如果你愿意，你可以使用相同的登录凭证登录你的个人 Twitter 账户。</p><p id="9424" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您将需要申请一个帐户，所以请确保按照步骤操作。设置帐户可能需要一些时间，因为您需要回答几个问题。大多数问题需要大量的输入，所以尽你所能回答它。</p><p id="ff2b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你被卡住了，这是一个关于如何申请的极好的视频。</p><p id="4d2b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://www.youtube.com/watch?v=2o_qt9cXicM" rel="noopener ugc nofollow" target="_blank"> <em class="mp">设置 Twitter API 开发者账户</em> </a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/807afdfb97cd54996722dd68eac89d4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDRdt76xHdcv0xMzrwsdkg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">申请开发者账号</p></figure></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h1 id="af66" class="ls lt iq bd lu lv my lx ly lz mz mb mc jw na jx me jz nb ka mg kc nc kd mi mj bi translated">2.创建 Twitter API 应用程序</h1><p id="cde9" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">开发人员帐户可能需要几个小时或几天才能获得批准。这取决于你对申请的回答有多好。有时他们可能会联系你以获取更多信息。</p><p id="62be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">批准后，前往导航栏的右上角，选择应用程序。在这里，您将希望创建一个应用程序，它是生成 API 密钥的一部分。</p><p id="d210" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你迷路了，这是一个很好的 API 密匙后续视频。</p><p id="047e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://www.youtube.com/watch?v=IlSVJCBqxys" rel="noopener ugc nofollow" target="_blank"> <em class="mp">创建 Twitter API 应用</em> </a></p><p id="8f00" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你已经设置好了，让我们从 R Studio 开始吧！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/2dbbf741b86e396ba926cf76cd9d7370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fDNpauqX3Ofy2hRUFkxZHg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">创建应用程序后，您应该会在仪表板上看到您的第一个应用程序。</p></figure></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h1 id="9087" class="ls lt iq bd lu lv my lx ly lz mz mb mc jw na jx me jz nb ka mg kc nc kd mi mj bi translated">3.安装/加载 twitteR 包</h1><p id="71ea" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">twitteR 是一个 R 包，提供对 Twitter API 的访问。支持 API 的大部分功能，偏向于在数据分析中比日常交互更有用的 API 调用。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="2780" class="nj lt iq nf b gy nk nl l nm nn">install.packages("twitteR") #install package<br/>library(twitteR) #load package</span></pre></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h1 id="49b4" class="ls lt iq bd lu lv my lx ly lz mz mb mc jw na jx me jz nb ka mg kc nc kd mi mj bi translated">4.将 API 链接到 R Studio</h1><p id="24b9" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">对于这一步，您需要访问您的 Twitter 开发者帐户，并导航到您创建的应用程序。如果您还没有这样做，请生成新的 API 密钥和访问令牌。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/799af39152d52df986c4ebb1241e1dd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1i8DKl87WMHueg6YThthIQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Twitter 应用程序密钥(为了隐私，我的密钥被隐藏了)</p></figure><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="3c33" class="nj lt iq nf b gy nk nl l nm nn">consumer_key &lt;- 'XXXXXXXXXXXXXX'<br/>consumer_secret &lt;- 'XXXXXXXXXXXXXX'<br/>access_token &lt;- 'XXXXXXXXXXXXXX'<br/>access_secret &lt;- 'XXXXXXXXXXXXXX'</span></pre><p id="1c24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用 R，复制上面的代码并将你的键粘贴到它们各自的变量中。(包括引号)</p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h1 id="e32f" class="ls lt iq bd lu lv my lx ly lz mz mb mc jw na jx me jz nb ka mg kc nc kd mi mj bi translated">5.设置身份验证</h1><p id="610a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">使用函数<em class="mp"> setup_twitter_oauth() </em>将您的键链接到 twitter 的 API。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="90fb" class="nj lt iq nf b gy nk nl l nm nn">setup_twitter_oauth(consumer_key, consumer_secret, access_token, access_secret)</span></pre><p id="8aaf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行上面的代码后，您会得到一个提示。您可以选择是否使用本地文件来缓存访问，但我通常不这样做。如果不想使用本地文件，请输入数字 2 并按 enter 键。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/9292b048f8676c2d93bf455936662370.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0hDxiTwyrIu7_SF494Wo3w.png"/></div></div></figure></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h1 id="f773" class="ls lt iq bd lu lv my lx ly lz mz mb mc jw na jx me jz nb ka mg kc nc kd mi mj bi translated">6.拉推文</h1><p id="1ac3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">既然我们已经完成了设置 API 的所有步骤，现在我们可以拉推了。下面我们来分解一下功能。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="c513" class="nj lt iq nf b gy nk nl l nm nn">virus &lt;- searchTwitter('#China + #Coronavirus', n = 1000, since = '2020-01-01', retryOnRateLimit = 1e3)</span><span id="3fbf" class="nj lt iq nf b gy nq nl l nm nn">virus_df = twListToDF(virus)</span></pre><p id="f044" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第一行代码使用了<em class="mp"> searchTwitter </em>函数。我们传递尽可能多的与我们的搜索相关的#标签，在这个例子中，是#中国和#冠状病毒。</p><p id="52d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">目前是 2020 年 2 月 4 日，此时，<a class="ae kv" href="https://www.who.int/health-topics/coronavirus" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">冠状病毒</strong> </a> <strong class="ky ir"> </strong>已经引起世界恐慌，因为它蔓延到中国以外的更多国家。</p><ul class=""><li id="7786" class="nr ns iq ky b kz la lc ld lf nt lj nu ln nv lr nw nx ny nz bi translated"><strong class="ky ir"> n </strong>参数是我们想要获取的推文数量。</li><li id="5c93" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated"><strong class="ky ir">因为— </strong>是您想要推文的时间段</li><li id="e28e" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated"><strong class="ky ir"> retryOnRateLimit </strong> —指示当速率受限时是否等待并重试。仅当期望回报(n)超过可用请求的剩余限制时，此参数才有意义</li></ul><p id="9fea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后一行代码使用了 twListToDF 函数，该函数将推文保存到数据帧中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/94bd089dbe1a875cd83fef6ef1331fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ETH-KM47kbdbp8j1agdXCg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">所有推文的数据框架</p></figure><p id="a6d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">查看所有的推文，我们可以看到，有一个独特的列可以帮助识别他们的推文活动。</p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h1 id="011a" class="ls lt iq bd lu lv my lx ly lz mz mb mc jw na jx me jz nb ka mg kc nc kd mi mj bi translated">7.后续步骤</h1><p id="e56c" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在你已经把你的推文保存在一个数据框中，最好开始分析和发现任何模式或趋势。一个很好的开始方式是将推文标记化，并从文字中提取见解。如果你有兴趣了解更多，请查看我的<a class="ae kv" rel="noopener" target="_blank" href="/text-analytics-in-r-ae23df8ee928?source=your_stories_page---------------------------&amp;gi=204d29521350">符号化</a>教程。</p></div></div>    
</body>
</html>