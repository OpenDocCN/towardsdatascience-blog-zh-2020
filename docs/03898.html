<html>
<head>
<title>How to “read_csv” with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何和熊猫“读 _csv”</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-read-csv-with-pandas-e91ea6016e76?source=collection_archive---------11-----------------------#2020-04-11">https://towardsdatascience.com/how-to-read-csv-with-pandas-e91ea6016e76?source=collection_archive---------11-----------------------#2020-04-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3652" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 read_csv 作为通用工具</h2></div><p id="2de7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据科学项目中最耗时的部分是数据清理和准备。Pandas 是一个非常强大和通用的 Python 数据分析库，可以加速项目的预处理步骤。我们通常倾向于使用带有默认参数的函数，这使得我们无法充分利用函数的优势。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/96d54a19803a41c3d15b6d86c8e234c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*276lJok8ngM1vKYyTyUnNQ.jpeg"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">米卡·鲍梅斯特在<a class="ae lu" href="https://unsplash.com/s/photos/csv?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="a4e4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">熊猫最广泛使用的功能之一是<strong class="kk iu"> read_csv </strong>，它读取逗号分隔值(csv)文件并创建一个数据帧。在这篇文章中，我将重点介绍 read_csv 函数的许多不同参数以及如何有效地使用它们。</p><blockquote class="lv lw lx"><p id="4b74" class="ki kj ly kk b kl km ju kn ko kp jx kq lz ks kt ku ma kw kx ky mb la lb lc ld im bi translated">Pandas 的基本数据结构是<strong class="kk iu"> DataFrame </strong>，它以表格的形式表示数据，带有标记的行和列。</p></blockquote><p id="236d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一如既往，我们从进口熊猫开始。</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="69e2" class="mh mi it md b gy mj mk l ml mm">import numpy as np<br/>import pandas as pd</span></pre><p id="63e4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我创建了一个示例数据框架，旨在显示参数的效果和有用性，因此这些值可能没有意义。</p><p id="d327" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们从使用不带可选参数的 read_csv 开始:</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="55ec" class="mh mi it md b gy mj mk l ml mm">df = pd.read_csv("SampleDataset.csv")<br/>df.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/82aeb13cf755d48a08ce76aeacaf8781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*9fZSCLUvtaNGEeU0j-qb5Q.png"/></div></figure><p id="aa47" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">唯一需要的参数是文件路径。我们需要告诉熊猫文件在哪里。如果 csv 文件在同一个工作目录或文件夹中，您可以只写文件名。如果没有，我们可以如下指定位置:</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="95a7" class="mh mi it md b gy mj mk l ml mm">df = pd.read_csv(r"C:\Users\soner\Downloads\SampleDataset.csv")</span></pre><h1 id="7240" class="mo mi it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><strong class="ak"> index_col </strong></h1><p id="26de" class="pw-post-body-paragraph ki kj it kk b kl nf ju kn ko ng jx kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">默认情况下，从 0 开始的整数索引被分配给数据帧。我们可以显式定义一个列作为索引。例如，我们可能希望使用“ID”列作为索引:</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="1159" class="mh mi it md b gy mj mk l ml mm">df = pd.read_csv("SampleDataset.csv", index_col='ID')<br/>df.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/e717925538e4e76f500934c1cada8208.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*jpz14MvHESFJ5dN9fPFkdQ.png"/></div></figure><h1 id="00e1" class="mo mi it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><strong class="ak">数据类型</strong></h1><p id="036f" class="pw-post-body-paragraph ki kj it kk b kl nf ju kn ko ng jx kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">有浮点 ID 号有点奇怪。我觉得没有哪家公司是这样分配身份证号的。我们可以使用<strong class="kk iu"> dtype </strong>参数指定 read_csv 函数中任何列的数据类型:</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="2939" class="mh mi it md b gy mj mk l ml mm">df = pd.read_csv("SampleDataset.csv", index_col='ID', <br/>                  dtype={'ID':np.int32})</span><span id="1749" class="mh mi it md b gy nl mk l ml mm">df.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/cd5678647d952e08c2234a908c55df0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*R-JeC0BHzd-QW1kDPP2tTQ.png"/></div></figure><h1 id="5cab" class="mo mi it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><strong class="ak">用途</strong></h1><p id="45d0" class="pw-post-body-paragraph ki kj it kk b kl nf ju kn ko ng jx kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">在某些情况下，根据我们对日期的计划，我们可能不需要所有的特性(列)。我们可以在读取所有数据后删除不必要的列。然而，更好的选择是只读取我们需要的列，这可以通过<strong class="kk iu"> usecols </strong>参数轻松完成:</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="0dc4" class="mh mi it md b gy mj mk l ml mm">cols = ["ID","Deparment","Salary","StartDate","Location"]<br/>df = pd.read_csv("SampleDataset.csv", usecols=cols)</span><span id="21cb" class="mh mi it md b gy nl mk l ml mm">df.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/8a3423a2551ffd6652e41ae41c5b1349.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*lqTSAKOL3kmVm4eOTvRFYQ.png"/></div></figure><p id="d9b0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们也可以使用列的索引作为参数来使用 cols 参数。以下代码可以很好地完成这项工作:</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="1c3d" class="mh mi it md b gy mj mk l ml mm">df = pd.read_csv("SampleDataset.csv", usecols=[2,3,4,5,6])</span></pre><h1 id="62ae" class="mo mi it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><strong class="ak">解析日期</strong></h1><p id="78ef" class="pw-post-body-paragraph ki kj it kk b kl nf ju kn ko ng jx kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">让我们检查列的数据类型:</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="f227" class="mh mi it md b gy mj mk l ml mm">df = pd.read_csv("SampleDataset.csv")</span><span id="43a0" class="mh mi it md b gy nl mk l ml mm">df.dtypes<br/>Unnamed: 0      int64<br/>RowNumber       int64<br/>ID            float64<br/>Deparment      object<br/>Salary          int64<br/>StartDate      object<br/>Location       object<br/>dtype: object</span></pre><p id="c406" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">StartDate 列的数据类型是 object，但是我们知道该列包含日期，所以我们可以通过使用<strong class="kk iu"> parse_Dates </strong>参数将值读取为 date。</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="3f58" class="mh mi it md b gy mj mk l ml mm">df = pd.read_csv("SampleDataset.csv", parse_dates=[5])</span><span id="9d81" class="mh mi it md b gy nl mk l ml mm">df.dtypes<br/>Unnamed: 0             int64<br/>RowNumber              int64<br/>ID                   float64<br/>Deparment             object<br/>Salary                 int64<br/>StartDate     datetime64[ns]<br/>Location              object<br/>dtype: object</span></pre><p id="3ff5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">日期现在有了更合适的格式。</p><h1 id="de30" class="mo mi it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><strong class="ak"> na_values </strong></h1><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/82aeb13cf755d48a08ce76aeacaf8781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*9fZSCLUvtaNGEeU0j-qb5Q.png"/></div></figure><p id="0a83" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">缺失值有时不是熊猫可以检测为“缺失”的格式。例如，在位置列中，'？'是一个缺失值，但是 read_csv 函数无法知道这一点，除非我们指定它。我们可以使用<strong class="kk iu"> na_values </strong>来指示要被识别为“缺失”的附加值:</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="27ef" class="mh mi it md b gy mj mk l ml mm">df = pd.read_csv("SampleDataset.csv", na_values=['?'])</span><span id="0679" class="mh mi it md b gy nl mk l ml mm">df.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi no"><img src="../Images/4e948f422c3a0285f41e06b55843bc77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*WMIU-Ze9wyrlMw1aHNcYOw.png"/></div></figure><h1 id="9773" class="mo mi it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><strong class="ak">船头和船尾</strong></h1><p id="3794" class="pw-post-body-paragraph ki kj it kk b kl nf ju kn ko ng jx kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">如果我们有一个非常大的数据帧，并且只想读取其中的一部分，我们可以使用<strong class="kk iu"> nrows </strong>参数，并指出我们想读取多少行并放入数据帧:</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="f3e0" class="mh mi it md b gy mj mk l ml mm">df = pd.read_csv("SampleDataset.csv")<br/>df.shape<br/>(30,7)</span><span id="7df4" class="mh mi it md b gy nl mk l ml mm">df = pd.read_csv("SampleDataset.csv", nrows=10)<br/>df.shape<br/>(10,7)</span></pre><p id="0d9c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在某些情况下，我们可能希望跳过文件开头的一些行。我们可以把要跳过的行数传递给<strong class="kk iu">skip prows</strong>parameter，或者传递一个带有整数的列表，指示要跳过的行:</p><ul class=""><li id="38a5" class="np nq it kk b kl km ko kp kr nr kv ns kz nt ld nu nv nw nx bi translated">skiprows=5:跳过前 5 行</li><li id="1fe3" class="np nq it kk b kl ny ko nz kr oa kv ob kz oc ld nu nv nw nx bi translated">skiprows=[1，3]:跳过第一行和第三行</li></ul><p id="ae81" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">原始数据帧:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/82aeb13cf755d48a08ce76aeacaf8781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*9fZSCLUvtaNGEeU0j-qb5Q.png"/></div></figure><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="47a9" class="mh mi it md b gy mj mk l ml mm">df = pd.read_csv("SampleDataset.csv", skiprows=3)<br/>df.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/734589f2ee4a54cdbdf8c78f92d6a5fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*pAcv3x5AR5F6VNvFCVKstA.png"/></div></figure><p id="1e97" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">跳过前三行，数据帧从第四行开始。然而，这里有一个问题。第 4 行用作列名。</p><h1 id="8066" class="mo mi it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><strong class="ak">表头</strong></h1><p id="c7b7" class="pw-post-body-paragraph ki kj it kk b kl nf ju kn ko ng jx kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">我们可以使用<strong class="kk iu">头</strong>参数来解决这个问题。在大多数情况下，csv 文件中的第一行包括列名，并推断为标题。因此，如果没有指定列名，csv 文件的默认行为是采用<code class="fe od oe of md b">header=0</code>，并且从文件的第一行推断列名。</p><p id="ca9b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果<code class="fe od oe of md b">header=None </code>，列名被指定为整数索引，文件的第一行被读取为数据帧的第一行:</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="5541" class="mh mi it md b gy mj mk l ml mm">df = pd.read_csv("SampleDataset.csv", header=None)<br/>df.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi og"><img src="../Images/37515c588349ed19892d75f469403d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*aMY3cH2SRzXtFHL93Y_D-g.png"/></div></figure><p id="56d5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以我们可以设置<code class="fe od oe of md b">header=None</code>并使用 skiprows，但是记住第一行包括列名。如果<code class="fe od oe of md b">skiprows=3</code>，数据框的第一行变成有<code class="fe od oe of md b">ID=127</code>的人。</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="a9be" class="mh mi it md b gy mj mk l ml mm">df = pd.read_csv("SampleDataset.csv", header=None, skiprows=3)<br/>df.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/3381c33b3f82f8e0594eadafce8de59a.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*ngv8zvm374UVpiherFoRjA.png"/></div></figure><h1 id="8d36" class="mo mi it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated"><strong class="ak">姓名</strong></h1><p id="35cb" class="pw-post-body-paragraph ki kj it kk b kl nf ju kn ko ng jx kq kr nh kt ku kv ni kx ky kz nj lb lc ld im bi translated">如果我们想改变列名或者文件中没有一行包含列名，我们可以使用<strong class="kk iu"> names </strong>参数:</p><pre class="lf lg lh li gt mc md me mf aw mg bi"><span id="042d" class="mh mi it md b gy mj mk l ml mm">cols=["Drop1","Drop2","Employee_ID","Department","Salary", "StartDate"]</span><span id="ed68" class="mh mi it md b gy nl mk l ml mm">df = pd.read_csv("SampleDataset.csv", names=cols, skiprows=1)<br/>df.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/64604a042e2ca7ad60fa68d292203344.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*bQeaU6UJihRcFXVAXSJU1A.png"/></div></figure></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><p id="6550" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">read_csv 函数还有很多附加参数。我试着解释我常用的参数，但是你可以在这里查看所有的参数列表<a class="ae lu" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="7c63" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>