<html>
<head>
<title>Analyzing Health Insurance Market Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分析健康保险市场数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyzing-health-insurance-market-data-71b1cf00e97d?source=collection_archive---------21-----------------------#2020-01-26">https://towardsdatascience.com/analyzing-health-insurance-market-data-71b1cf00e97d?source=collection_archive---------21-----------------------#2020-01-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4469" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">健康保险数据的探索性数据分析</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2209396139ad0744a32e24be2ec99257.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1alAa4SalaoHG1NqYkM79A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://www.pexels.com/photo/blue-and-silver-stetoscope-40568/" rel="noopener ugc nofollow" target="_blank">像素</a>上的<a class="ae ky" href="https://www.pexels.com/@pixabay" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>拍摄</p></figure><p id="6fe8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Healthcare.gov 向公众提供合格健康计划(QHP)景观数据。这些数据集包括联邦政府运营市场的各州的个人和家庭健康计划。对医疗保险计划以及其他一般医疗保健服务的可用数据进行定量分析，可能有助于在定价和基于价值的护理方面使我们的医疗保健系统更加透明。</p><p id="c50a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本帖中，我们将对 QHP 景观数据进行探索性数据分析。数据可在<a class="ae ky" href="https://data.healthcare.gov/dataset/QHP-Landscape-Individual-Market-Medical/b8in-sz6k" rel="noopener ugc nofollow" target="_blank">这里</a>获得。它也可以作为一个。我的<a class="ae ky" href="https://github.com/spierre91/medium_code" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上的‘CSV’文件。</p><p id="99fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><p id="a50c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们将数据存储在 pandas 数据框中，并打印列的列表:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="2be9" class="ma mb it lw b gy mc md l me mf">import pandas as pd<br/>df = pd.read_csv("QHP_landscape_2020.csv")<br/>print(df.columns)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mg"><img src="../Images/ea7caeb78d848a56a332fa56ecabcea3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E7IlpMSqMEeEQf1_c9sAeQ.png"/></div></div></figure><p id="cf54" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以打印完整的列列表:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d04f" class="ma mb it lw b gy mc md l me mf">print(list(df.columns))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/7cc408914bf9c984764960a2915bbac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JTIa-29UcwfitFyMRTSrbg.png"/></div></div></figure><p id="13d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如你所见，有 128 列。我们将把我们的分析限制在以下几列:</p><ol class=""><li id="89f1" class="mi mj it lb b lc ld lf lg li mk lm ml lq mm lu mn mo mp mq bi translated">发行人名称</li><li id="5656" class="mi mj it lb b lc mr lf ms li mt lm mu lq mv lu mn mo mp mq bi translated">县名</li><li id="abfa" class="mi mj it lb b lc mr lf ms li mt lm mu lq mv lu mn mo mp mq bi translated">计划营销名称</li><li id="9f0c" class="mi mj it lb b lc mr lf ms li mt lm mu lq mv lu mn mo mp mq bi translated">医疗最高自付费用-个人-标准</li><li id="ba2d" class="mi mj it lb b lc mr lf ms li mt lm mu lq mv lu mn mo mp mq bi translated">医疗免赔额—个人—标准</li><li id="7eb7" class="mi mj it lb b lc mr lf ms li mt lm mu lq mv lu mn mo mp mq bi translated">初级保健医生—标准</li><li id="35d5" class="mi mj it lb b lc mr lf ms li mt lm mu lq mv lu mn mo mp mq bi translated">急诊室—标准</li><li id="13b6" class="mi mj it lb b lc mr lf ms li mt lm mu lq mv lu mn mo mp mq bi translated">专家—标准</li></ol><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3fce" class="ma mb it lw b gy mc md l me mf">df = df[['Issuer Name', 'County Name', 'Plan Marketing Name',   <br/>         'Medical Maximum Out Of Pocket - Individual - Standard',<br/>         'Medical Deductible - Individual - Standard', 'Primary Care Physician - Standard', 'Specialist - Standard', 'Emergency Room - Standard']]<br/>         <br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/4a2f0d44ebedb401a916a8bfb01854bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K7E71HT9Abg9FCRJDHn5bQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/ad21dd998041fe40783a6abd2c9ebe14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vFjZE7oHDxhQKfh3CCBegg.png"/></div></div></figure><p id="6ba5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到有几个分类列。让我们定义一个将数据框、列名和限制作为输入的函数。当被调用时，它打印分类值的字典以及它们出现的频率:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="dfb3" class="ma mb it lw b gy mc md l me mf">def return_counter(data_frame, column_name, limit):<br/>   from collections import Counter    print(dict(Counter(data_frame[column_name].values).most_common(limit)))</span></pre><p id="bf86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将函数应用于“发行人名称”列，并将结果限制为五个最常见的值:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9505" class="ma mb it lw b gy mc md l me mf">return_counter(df, 'Issuer Name', 5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/1833f510d64e16badfd37c386e4f898e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qkFaB4WSuEfAwtIrzlk6Yg.png"/></div></div></figure><p id="7a33" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到发行者名称“Medica”的记录最多。</p><p id="3948" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将函数应用于“County Name”列:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="e83c" class="ma mb it lw b gy mc md l me mf">return_counter(df, 'County Name', 5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/ce52fd351f216be1ebc88d9990fe794e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RlrxC5uIWOfTm_7a2J-m3Q.png"/></div></div></figure><p id="611f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您所看到的，这是一个有用的快速测试，可以查看数据中是否有任何明显的不平衡，这通常是建模时需要处理的一个关键问题。</p><p id="4f3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，从数字列(如“医疗最高自付费用-个人-标准”)中生成汇总统计数据会很有用。首先，我们需要将字符串值的美元金额转换成浮点类型。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3076" class="ma mb it lw b gy mc md l me mf">OOP_INDV = []<br/>for i in list(df['Medical Maximum Out Of Pocket - Individual - Standard'].values):<br/>    try:<br/>        OOP_INDV.append(float((str(i)[1] + str(i)[3:])))<br/>    except(ValueError):<br/>        OOP_INDV.append(np.nan)<br/>        <br/>df['OOP_INDV'] = OOP_INDV</span></pre><p id="0bad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们确保转换成功:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f351" class="ma mb it lw b gy mc md l me mf">print(df[['Medical Maximum Out Of Pocket - Individual - Standard', 'OOP_INDV']].head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/897322dde0489dfa31b786a10d372ad9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6OqJniHbnamRu3qFSdFRng.png"/></div></div></figure><p id="fba2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看起来不错！</p><p id="6b55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们定义一个采用数据框、分类列和数值列的函数。每个类别的数字列的平均值和标准偏差存储在数据框中，并且数据框根据平均值以降序排序。如果您想要快速查看特定类别对于特定数字列是否具有更高或更低的平均值和/或标准偏差值，这将非常有用。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="cb00" class="ma mb it lw b gy mc md l me mf">def return_statistics(data_frame, categorical_column, numerical_column):<br/>    mean = []<br/>    std = []<br/>    field = []<br/>    for i in set(list(data_frame[categorical_column].values)):<br/>        new_data = data_frame[data_frame[categorical_column] == i]<br/>        field.append(i)<br/>        mean.append(new_data[numerical_column].mean())<br/>        std.append(new_data[numerical_column].std())<br/>    df = pd.DataFrame({'{}'.format(categorical_column): field, 'mean {}'.format(numerical_column): mean, 'std in {}'.format(numerical_column): std})<br/>    df.sort_values('mean {}'.format(numerical_column), inplace = True, ascending = False)<br/>    df.dropna(inplace = True)<br/>    return df</span></pre><p id="8185" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以查看“开证人姓名”和“医疗最高自付费用-个人”的汇总统计数据:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="19d4" class="ma mb it lw b gy mc md l me mf">stats = return_statistics(df, 'Issuer Name', 'OOP_INDV')<br/>print(stats.head(15))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/4cbda27f92794f182702eac1bdf98b19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*15VjzCaKW9idJ-M2qGNLvg.png"/></div></div></figure><p id="264e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“德州蓝十字和蓝盾”的个人最高自付费用和跨计划类型的零标准差。</p><p id="9d89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将使用箱线图来显示基于最小值、最大值、中值、第一个四分位数和第三个四分位数的数值分布。如果您对它们不熟悉，可以看看文章<a class="ae ky" rel="noopener" target="_blank" href="/understanding-boxplots-5e2df7bcbd51">了解 Boxplots </a>。</p><p id="0ed8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与汇总统计函数类似，此函数采用数据框、分类列和数值列，并根据限制显示最常见类别的箱线图:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="dec3" class="ma mb it lw b gy mc md l me mf">def get_boxplot_of_categories(data_frame, categorical_column, numerical_column, limit):<br/>    import seaborn as sns<br/>    import matplotlib.pyplot as plt<br/>    keys = []<br/>    for i in dict(Counter(df[categorical_column].values).most_common(limit)):<br/>        keys.append(i)<br/>    print(keys)<br/>    <br/>    df_new = df[df[categorical_column].isin(keys)]<br/>    sns.boxplot(x = df_new[categorical_column], y = df_new[numerical_column])</span></pre><p id="4c36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们在 5 个最常见的发行者名称中为 OOP_INDV 生成箱线图:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f197" class="ma mb it lw b gy mc md l me mf">get_boxplot_of_categories(df, 'Issuer Name', 'OOP_INDV', 5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/a1251f099f3da1c2b56f4869b1ad39bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kU8qp4apYLUkAxGUIARxwA.png"/></div></div></figure><p id="25cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以对“医疗免赔额—个人—标准”进行类似的分析。让我们将字符串值的美元金额转换为浮点类型:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="1d2b" class="ma mb it lw b gy mc md l me mf">DEDUCT_INDV = []<br/>for i in list(df['Medical Deductible — Individual — Standard'].values):<br/>    try:<br/>        DEDUCT_INDV.append(float((str(i)[1] + str(i)[3:])))<br/>    except(ValueError):<br/>        DEDUCT_INDV.append(np.nan)<br/>        <br/>df['DEDUCT_INDV'] = DEDUCT_IND</span></pre><p id="5990" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们确保转换成功:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6e1b" class="ma mb it lw b gy mc md l me mf">print(df[['Medical Deductible - Individual - Standard', 'DEDUCT_INDV']].head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/4a22eac84cacd103b3021223c1f68596.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0hOOWw5SzWEXH2NiMuVPpQ.png"/></div></div></figure><p id="cc76" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以查看“发行人名称”和“医疗免赔额—个人—标准”的汇总统计数据:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="6e7b" class="ma mb it lw b gy mc md l me mf">stats = return_statistics(df, 'Issuer Name', 'DEDUCT_INDV')<br/>print(stats.head(15))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/60e1741ed639ba020ba2b5e6f6d9718f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e07vPHJpC7NqRbxDfdFsCw.png"/></div></div></figure><p id="e74c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“Wellmark Value Health Plan，Inc .”和“Wellmark Health Plan of Iowa，Inc .”的平均“医疗免赔额—个人—标准”最高。</p><p id="eef3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们为 5 个最常出现的发行人名称中的 DEDUCT_INDV 生成箱线图:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f7ce" class="ma mb it lw b gy mc md l me mf">get_boxplot_of_categories(df, 'Issuer Name', 'DEDUCT_INDV', 5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/c44a2956f8a569e2a360e841899d0a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hptLuv3e1vy8VR1nmbKiKQ.png"/></div></div></figure><p id="dd8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，让我们定义一个函数，它将一个数据框、分类列、分类值和两个数值列作为输入，并显示一个散点图:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="8863" class="ma mb it lw b gy mc md l me mf">def get_scatter_plot_category(data_frame, categorical_column, categorical_value, numerical_column_one, numerical_column_two):<br/>    import matplotlib.pyplot as plt<br/>    import seaborn as sns<br/>    df_new = data_frame[data_frame[categorical_column] == categorical_value]<br/>    sns.set()<br/>    plt.scatter(x= df_new[numerical_column_one], y = df_new[numerical_column_two])<br/>    plt.xlabel(numerical_column_one)<br/>    plt.ylabel(numerical_column_two)</span></pre><p id="3464" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们为 Medica 生成一个 OOP_INDV 与 DEDUCT_INDV 的散点图:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="bb6d" class="ma mb it lw b gy mc md l me mf">get_scatter_plot_category(df, ‘Issuer Name’, ‘Medica’, ‘DEDUCT_INDV’, ‘OOP_INDV’)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/c17b92f7afbb1c9e6ff7caf7cde9aaa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OQ7Q-gPiwyJmZYeopzOWKA.png"/></div></div></figure><p id="d24f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我就讲到这里，但是请随意处理数据并自己编码。我鼓励你对急诊室、专科医生和初级保健列进行类似的分析。例如，了解初级保健的共同保险百分比在不同的发行人名称之间的差异是很有趣的。</p><p id="d8ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">概括地说，我回顾了几种分析健康保险市场数据的方法。这包括用箱线图和散点图显示数据。我们还定义了用于生成汇总统计数据的函数，比如平均值、标准差和分类值的计数。我希望这篇文章有趣。这篇文章的代码可以在<a class="ae ky" href="https://github.com/spierre91/medium_code" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。感谢您的阅读！</p></div></div>    
</body>
</html>