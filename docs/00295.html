<html>
<head>
<title>Four Useful Functions For Exploring Data in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python中探索数据的四个有用函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/four-useful-functions-for-exploring-data-in-python-33b53288cdd8?source=collection_archive---------24-----------------------#2020-01-09">https://towardsdatascience.com/four-useful-functions-for-exploring-data-in-python-33b53288cdd8?source=collection_archive---------24-----------------------#2020-01-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bc09" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在Python中探索和可视化数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f97263d0b3150ff99edd1c301b74482e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M1JwT3U7YKkxGC00Cr4wqQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">瓦伦丁·安托努奇在<a class="ae ky" href="https://www.pexels.com/photo/person-holding-compass-841286/" rel="noopener ugc nofollow" target="_blank">的照片</a></p></figure><p id="df05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在探索数据的过程中，我经常发现自己重复定义类似的python逻辑，以便执行简单的分析任务。例如，我经常计算数据中特定类别的数字列的平均值和标准偏差。我还经常分析数据中分类值的频率。为了节省时间，我编写了一些函数，允许我在不重写太多代码的情况下进行这种类型的分析。</p><p id="b09c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将分享我在模型构建的探索性数据分析步骤中经常使用的四个有用的函数。然后我将展示我们如何使用这些函数来探索<em class="lv">葡萄酒评论</em>数据集。数据集可以在<a class="ae ky" href="https://www.kaggle.com/zynicide/wine-reviews" rel="noopener ugc nofollow" target="_blank">这里</a>找到。该文件夹包含三个。csv文件。我将使用名为“winemag-data_first150k.csv”的文件。</p><p id="a6e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><ol class=""><li id="90a6" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><strong class="lb iu">计数器</strong></li></ol><p id="693b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将讨论的第一个函数允许我们查看分类值在数据集中出现的频率。它接受数据帧、列名和限制作为输入。当被调用时，它打印分类值的字典以及它们出现的频率:</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="a436" class="mk ml it mg b gy mm mn l mo mp">def return_counter(data_frame, column_name, limit):<br/>   from collections import Counter    print(dict(Counter(data_frame[column_name].values).most_common(limit)))</span></pre><p id="c615" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们打印数据集的前五行:</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="cb19" class="mk ml it mg b gy mm mn l mo mp">import pandas as pd<br/>df = pd.read_csv('winemag-data_first150k.csv')<br/>print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/8c841929be5590c7845382f5b037e846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*vl7QGpxnbZ-n27VNR8HX2g.png"/></div></figure><p id="ef03" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到有几个分类列。让我们将函数应用于“国家”列，并将结果限制在五个最常见的国家:</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="8bbe" class="mk ml it mg b gy mm mn l mo mp">return_counter(df, 'country', 5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/05d0da4b378eff1724ae7a410bdd1dcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*AITfefWavBTcTybToeL3NQ.png"/></div></figure><p id="2571" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到大部分的葡萄酒记录都对应于美国生产的葡萄酒。</p><p id="48ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将函数应用于“品种”列:</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="97ad" class="mk ml it mg b gy mm mn l mo mp">return_counter(df, 'variety', 5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/660b9f3b1fe41a86af6ae44807a63ac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f4wUHfJ7E_QDiP624_KTJA.png"/></div></div></figure><p id="5159" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数葡萄酒是夏敦埃酒和黑皮诺酒。这是一个有用的快速测试，可以查看数据中是否有任何明显的不平衡，这通常是建模时要处理的一个关键问题。</p><p id="aa92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.<strong class="lb iu">汇总统计</strong></p><p id="2453" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一个函数是汇总统计函数(有点类似于df.describe())。该函数采用一个数据帧、一个分类列和一个数字列。每个类别的数字列的平均值和标准偏差存储在数据框中，并且数据框根据平均值以降序排序。如果您想要快速查看特定类别对于特定数字列是否具有更高或更低的平均值和/或标准偏差值，这将非常有用。</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="a9b7" class="mk ml it mg b gy mm mn l mo mp">def return_statistics(data_frame, categorical_column, numerical_column):<br/>    mean = []<br/>    std = []<br/>    field = []<br/>    for i in set(list(data_frame[categorical_column].values)):<br/>        new_data = data_frame[data_frame[categorical_column] == i]<br/>        field.append(i)<br/>        mean.append(new_data[numerical_column].mean())<br/>        std.append(new_data[numerical_column].std())<br/>    df = pd.DataFrame({'{}'.format(categorical_column): field, 'mean {}'.format(numerical_column): mean, 'std in {}'.format(numerical_column): std})<br/>    df.sort_values('mean {}'.format(numerical_column), inplace = True, ascending = False)<br/>    df.dropna(inplace = True)<br/>    return df</span></pre><p id="fbc7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以查看“品种”和“价格”的汇总统计数据:</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="10a9" class="mk ml it mg b gy mm mn l mo mp">stats = return_statistics(df, ‘varieties’, ‘prices’)<br/>print(stats.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/19d71984d349d18ac5de246ebaf136c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/1*r1y4L7iuRZhnIUkSFIhgEg.png"/></div></figure><p id="fef7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">麝香葡萄品种的平均价格最高。</p><p id="0f87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以为国家做同样的事情:</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="8324" class="mk ml it mg b gy mm mn l mo mp">stats = return_statistics(df, ‘countries’, ‘prices’)<br/>print(stats.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/0e86c51ae0311314d9105626942947cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*JL-x2ecLOLIY-HdUfzfvUg.png"/></div></figure><p id="08e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">英国的平均价格最高。</p><p id="97d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.<strong class="lb iu">箱线图</strong></p><p id="be38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一个函数是boxplot函数。我们使用箱线图来显示基于最小值、最大值、中值、第一个四分位数和第三个四分位数的数值分布。如果你对它们不熟悉，可以看看文章<a class="ae ky" rel="noopener" target="_blank" href="/understanding-boxplots-5e2df7bcbd51">了解盒子情节</a>。</p><p id="5ae3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与汇总统计函数类似，此函数采用数据框、分类列和数值列，并根据限制显示最常见类别的箱线图:</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="4faf" class="mk ml it mg b gy mm mn l mo mp">def get_boxplot_of_categories(data_frame, categorical_column, numerical_column, limit):<br/>    import seaborn as sns<br/>    import matplotlib.pyplot as plt<br/>    keys = []<br/>    for i in dict(Counter(df[categorical_column].values).most_common(limit)):<br/>        keys.append(i)<br/>    print(keys)<br/>    <br/>    df_new = df[df[categorical_column].isin(keys)]<br/>    sns.boxplot(x = df_new[categorical_column], y = df_new[numerical_column])</span></pre><p id="ba97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们为5个最常见的国家的葡萄酒价格绘制箱线图:</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="1bed" class="mk ml it mg b gy mm mn l mo mp">get_boxplot_of_categories(df, 'country', 'price', 5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/f15d25f1d0d05ab610871f9ed4c9e505.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*fXr7QxLqszW0W5dYzZSbJg.png"/></div></figure><p id="16dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所见，在所有五个国家类别中，葡萄酒价格都有明显的异常值。我们可以对“多样性”做同样的事情。为了更好地可视化，我将类别值限制为三个国家:</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="8fda" class="mk ml it mg b gy mm mn l mo mp">get_boxplot_of_categories(df, 'variety', 'price', 3)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/b93bd5fcf9c4664fbc9a0bd8f8b4ab91.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*9SQBxRoZs-tmIjAJITMOFA.png"/></div></figure><p id="5410" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4.<strong class="lb iu">散点图</strong></p><p id="5d88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后一个函数是散点图函数。此函数将一个数据框、分类列、分类值和两个数字列作为输入，并显示一个散点图:</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="18da" class="mk ml it mg b gy mm mn l mo mp">def get_scatter_plot_category(data_frame, categorical_column, categorical_value, numerical_column_one, numerical_column_two):<br/>    import matplotlib.pyplot as plt<br/>    import seaborn as sns</span><span id="8863" class="mk ml it mg b gy mx mn l mo mp">df_new = data_frame[data_frame[categorical_column] == categorical_value]<br/>    sns.set()<br/>    plt.scatter(x= df_new[numerical_column_one], y = df_new[numerical_column_two])<br/>    plt.xlabel(numerical_column_one)<br/>    plt.ylabel(numerical_column_two)</span></pre><p id="67c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们制作一个美国葡萄酒点数与价格的散点图:</p><pre class="kj kk kl km gt mf mg mh mi aw mj bi"><span id="168e" class="mk ml it mg b gy mm mn l mo mp">get_scatter_plot_category(df, 'country', 'US', 'points', 'price')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/cae9be25b15b4ef9cc68acd9588dc8d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*FfX6fdLkZ8e9FtUZIbOfYQ.png"/></div></figure><p id="f491" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">价格和奖励积分之间似乎存在轻微的正相关关系。我就讲到这里，但是请随意处理数据并自己编码。</p><p id="47c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">概括地说，在这篇文章中，我回顾了我在探索性数据分析过程中经常使用的四个有用的函数。我回顾了分析数据的方法，包括用箱线图和散点图可视化数据。我还定义了生成汇总统计数据的函数，比如平均值、标准差和分类值的计数。我希望这篇文章是有帮助的。</p><p id="3590" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章的代码可以在<a class="ae ky" href="https://github.com/spierre91/medium_code" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。感谢您的阅读！</p></div></div>    
</body>
</html>