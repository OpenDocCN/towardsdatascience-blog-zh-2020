<html>
<head>
<title>Movie Recommendation System based on MovieLens</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于 MovieLens 的电影推荐系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/movie-recommendation-system-based-on-movielens-ef0df580cd0e?source=collection_archive---------8-----------------------#2020-08-13">https://towardsdatascience.com/movie-recommendation-system-based-on-movielens-ef0df580cd0e?source=collection_archive---------8-----------------------#2020-08-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6d6c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用自然语言处理(NLP)和计算机视觉(CV)</h2></div><p id="686b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated">今年夏天，我有幸与 ML 制作的<a class="ae ln" href="https://madewithml.com/" rel="noopener ugc nofollow" target="_blank">合作，体验了一次有意义的数据科学孵化。我选择了令人敬畏的</a><a class="ae ln" href="https://drive.google.com/drive/folders/1ZGp7ORu9nA6l3PyNK_H0MGTXNl4sNMsA" rel="noopener ugc nofollow" target="_blank"> MovieLens </a>数据集，并设法创建了一个电影推荐系统，该系统以某种方式模拟了一些最成功的推荐引擎产品，如抖音、YouTube 和网飞。</p><p id="2929" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这篇文章将解释我是如何在这个项目的整个生命周期中工作的，并提供我对一些技术问题的解决方案。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/f66cabe7ef2fe81ac7b966585b0bd1d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3yEzcwrPRnx9BtUT7VROjw.jpeg"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">图片来自<a class="ae ln" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1167618" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae ln" href="https://pixabay.com/users/geralt-9301/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1167618" rel="noopener ugc nofollow" target="_blank"> Gerd Altmann </a></p></figure><h1 id="c155" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">主意</h1><p id="35f8" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">乍一看数据集，总共有三个表:</p><ul class=""><li id="8704" class="nb nc it kk b kl km ko kp kr nd kv ne kz nf ld ng nh ni nj bi translated"><em class="nk"> movies.csv </em>:这是包含电影所有信息的表格，包括标题、标语、描述等。总共有 21 个功能/专栏，所以我们候选人可以只关注其中的一些，或者尝试利用所有的功能/专栏。</li><li id="6451" class="nb nc it kk b kl nl ko nm kr nn kv no kz np ld ng nh ni nj bi translated"><em class="nk">收视率 _ 小</em>。csv:记录所有用户评分行为的表格，包括他们的评分和他们发布评分时的时间戳。</li><li id="2576" class="nb nc it kk b kl nl ko nm kr nn kv no kz np ld ng nh ni nj bi translated"><em class="nk"> links.csv </em>:记录每部电影在 IMDB 和 TMDB 两个电影数据库中唯一 ID 的表格。</li></ul><p id="dafc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有两种常见的推荐过滤技术:协同过滤和内容过滤。协同过滤要求模型学习用户之间的联系/相似性，以便它可以根据用户以前的选择、偏好或品味生成最佳推荐选项。内容过滤需要用户和项目的特征，这样系统就可以根据用户和项目的共同属性来确定推荐。</p><p id="45a9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我将一步一步地尝试这两种方法。</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="1f16" class="me mf it bd mg mh nx mj mk ml ny mn mo jz nz ka mq kc oa kd ms kf ob kg mu mv bi translated">协同过滤</h1><p id="3d2f" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">协同过滤只需要我记录用户以前的行为，比如说，他们过去有多喜欢一部电影。幸运的是，我们已经获得了这类信息，因为表<em class="nk"> ratings_small.csv </em>中的数据准确地反映了这个<em class="nk">。为了实现这一技术，我应用了奇妙的 Python 库<em class="nk"> Surprise </em>。它提供了一套推荐系统开发中常用的内置算法。我选择了 5 种方法来比较它们的准确性，以 RMSE 作为衡量标准，结果如下:</em></p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/3ad5b2792cd1dc6de24acefa7d73cbd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*_kvR12XRnOD7FyG2_LFPrA.png"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">推荐系统算法的准确性(图片由作者提供)</p></figure><p id="06fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae ln" href="https://en.wikipedia.org/wiki/Singular_value_decomposition" rel="noopener ugc nofollow" target="_blank"> SVD </a>优于任何其他同类产品，以下是针对每个用户的最终推荐(当然，配置了 SVD)列表片段，如下所示:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi od"><img src="../Images/9030919c69cb3dac6c3421148a6879d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*GdpjVq_zOfmj3eyl_tjzPA.png"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">作者图片</p></figure><p id="1975" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">协同过滤最明显的优点是易于实现。它不需要关于用户和项目的太详细的信息，理想情况下，它可以用 5 行代码实现。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="oe of l"/></div></figure></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="faab" class="me mf it bd mg mh nx mj mk ml ny mn mo jz nz ka mq kc oa kd ms kf ob kg mu mv bi translated">内容过滤</h1><p id="364a" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">尽管协同过滤技术有其突出的优点，但它的另一面也很明显:它不能解决“冷启动”问题。这个问题指的是这样一种情况，即一个新的商品或一个新的用户被添加到系统中，而系统无法向消费者推销该商品或向用户建议任何可用的选项。这是因为系统没有跟踪用户和项目的属性。除非用户开始对新项目进行评级，否则它不会被推广；同样，在用户开始评价之前，系统也不知道该推荐什么。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi og"><img src="../Images/e7b8f007c5373013c02fea76f58e1551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8BndqzqBM15DOdi-uasayA.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">想象一下，如果乔安娜不是一个女人，系统推荐一件比基尼，仅仅是因为 Funmi 也买了一件带比基尼的人字拖……这也是内容过滤可以解决的一个问题。(图片来源:<a class="ae ln" href="https://www.emailvendorselection.com/recommendation-engines-for-email-marketing/" rel="noopener ugc nofollow" target="_blank">链接</a>)</p></figure><p id="a241" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">内容过滤是解决这个问题的方法。当提供用户/项目简档时，它使系统能够理解用户的偏好。例如，如果用户的播放列表包含<em class="nk">正义联盟</em>、<em class="nk">复仇者联盟、</em>、<em class="nk">水行侠、</em>和<em class="nk">闪灵</em>，那么他/她很可能更喜欢动作和恐怖类型。如果使用协同过滤，该用户将被推荐一些喜剧，因为其他观看<em class="nk">正义联盟</em>、<em class="nk">复仇者联盟、</em>、<em class="nk">水行侠、</em>和<em class="nk">闪灵</em>的观众观看了喜剧。如果某个用户根本不喜欢喜剧，这有时是没有意义的。但是通过内容过滤，可以避免这样的问题，因为系统已经确认了该用户的偏好是什么。</p><p id="d45a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了实现一个内容过滤推荐系统，我利用 TFIDF 来反映每种类型在任何电影中的重要性(在这个阶段我只考虑类型)。然后，我计算了重要性权重和用户对不同流派的偏好(在用户资料中给出)的乘积。基于和积，我们可以简单地对电影进行排序，并向用户推荐前 N 名候选人。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="oe of l"/></div></figure></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="f83c" class="me mf it bd mg mh nx mj mk ml ny mn mo jz nz ka mq kc oa kd ms kf ob kg mu mv bi translated">我是新来的怎么办？</h1><p id="4c5a" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">如前面的代码片段所示，我根据现有用户的历史评分记录创建了用户/电影档案。然而，它还没有完全解决冷启动问题，因为系统仍然不知道对新用户或新电影做什么。我将在本文的剩余部分告诉你我如何从电影海报中提取类型信息，现在我将展示系统应该如何响应新用户。</p><p id="5994" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我假设新用户有两种心态:他们要么明白自己想要什么类型的电影，要么什么都不懂。对于第一种类型的客户，我允许他们按照自己的意愿选择任何流派，并简单地让系统根据他们自己提供的偏好返回。</p><p id="2055" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于那些还不知道该做什么的人，我实现了 Tobias dorsch、Andreas Lommatzsch 和 Christian Rakow 的部分<a class="ae ln" href="http://dl.icdst.org/pdfs/files/1cd028f7a702b291a00984c192f687db.pdf" rel="noopener ugc nofollow" target="_blank">工作</a>。我让系统在新用户没有任何偏好请求的情况下，尽快抓取最受欢迎的专注于电影的 twitter 账户。然后，我将最常提到的命名实体与电影进行了匹配，这些实体是由 spaCy 识别的。匹配的电影被认为是最可能受欢迎的，因为它们与当前时间的人/电影非常相似。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="oe of l"/></div></figure><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/0bc3bee97bb6efe7637e78adc3425966.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*DC9pv41sXn1iO_IQJolFCQ.png"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">Tobias Dö rsch、Andreas Lommatzsch 和 Christian Rakow 基于事件检测的热门视频点播推荐(来源:<a class="ae ln" href="http://dl.icdst.org/pdfs/files/1cd028f7a702b291a00984c192f687db.pdf" rel="noopener ugc nofollow" target="_blank">http://dl . IC dst . org/pdf/files/1 CD 028 f 7a 702 b 291 a 00984 c 192 f 687 db . pdf</a>)</p></figure><h1 id="f0c9" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">如何发布新电影？</h1><p id="04cf" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">一个成熟的电影流媒体平台会不断推出新电影。我想模拟这种行为，我的想法是，无论何时有新电影开始播放，他们都可以在内容过滤推荐系统中获得推荐，即使他们的制作公司不提供他们的类型信息。我开发了一个应用 CV 自动生成流派的方法，关于它的细节，请访问<a class="ae ln" rel="noopener" target="_blank" href="/a-neural-network-that-can-tell-the-genres-of-a-movie-6c218061e422">这篇文章</a>。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/dfbe936dbcbc224f29c40e483c891bc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*hm4WN2w7Q8WKw9qwBSQrSg.png"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">类型预测示例(作者图片)</p></figure></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="ec98" class="me mf it bd mg mh nx mj mk ml ny mn mo jz nz ka mq kc oa kd ms kf ob kg mu mv bi translated">部署</h1><p id="03ce" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">我总结了我在前面章节中研究的内容，并设法使用<a class="ae ln" href="http://streamlit.io" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>开发了一个 web 应用程序。在<a class="ae ln" href="https://recommendation-sys.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://recommendation-sys.herokuapp.com/</a>尽情享受吧。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/8a1be2e7a0f0ecee9c5f70a6abc1a411.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Evr9rRwQMkGNcWt6tGExdw.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">推荐系统截图(图片作者提供)</p></figure><h1 id="c50c" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">结论</h1><p id="3d16" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">这是我第一次模拟一些最先进的推荐引擎。我利用了我在 NLP 和 CV 方面的知识，尤其是内容/协同过滤推荐和多标签分类。</p><p id="125d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我应该承认，这个项目还有很大的改进空间，以下是我未来的一些关注点:</p><ol class=""><li id="9cce" class="nb nc it kk b kl km ko kp kr nd kv ne kz nf ld oj nh ni nj bi translated"><strong class="kk iu">利用给定数据集的更多信息</strong>。你可能还记得我曾经提到过在表<em class="nk"> movies.csv </em>中有 21 列。但是我只是用流派来做一个简单的演示。有了更多的信息输入，相信推荐会更加个性化和有针对性。</li><li id="2bdf" class="nb nc it kk b kl nl ko nm kr nn kv no kz np ld oj nh ni nj bi translated"><strong class="kk iu">使用更高级的推荐技术</strong>。很多一些大牌开发的推荐引擎越来越精良，背后的逻辑也越来越深入。基于模型的过滤、混合过滤是最近出现的一些技术。</li><li id="c3ba" class="nb nc it kk b kl nl ko nm kr nn kv no kz np ld oj nh ni nj bi translated"><strong class="kk iu">消除“过滤气泡”</strong>。用户可能只能观看系统推荐的电影，而推荐是基于他/她以前的观看历史。在这种情况下，不符合他们偏好的其他电影对用户来说是不可用的，这使得用户看起来像被困在“气泡”中。尽管如此，一些用户仍然欢迎其他类型的电影，因此推荐系统应该在推荐相似电影和其他电影之间找到一个平衡点。</li><li id="6ce1" class="nb nc it kk b kl nl ko nm kr nn kv no kz np ld oj nh ni nj bi translated"><strong class="kk iu">根据近期事件推荐电影</strong>。这听起来很像我对新用户所做的，当他们不提供他们的偏好时。不同的是，我所做的只是向他们推荐最近热门的电影(演员、电影制作人等)。)涉及，而我们可以让推荐系统更智能，这意味着理解正在发生的事情，即使它与电影无关，并推荐相关的电影。这将是一个有趣的发现，考虑到数百万人，如果不是数十亿人，这些天被新冠肺炎困在家里，他们可能愿意在电影中体验人类如何最终战胜病毒攻击。</li></ol><p id="ee78" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您对我的项目感兴趣并愿意为此做出贡献，请随时访问此处:</p><div class="ok ol gp gr om on"><a href="https://github.com/MemphisMeng/Brilliant-Recommendation-System" rel="noopener  ugc nofollow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">MemphisMeng/精彩推荐系统</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">精彩推荐系统是用 ML 数据科学孵化器 2020 夏季项目做出来的。这是一个推荐…</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">github.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb ly on"/></div></div></a></div></div></div>    
</body>
</html>