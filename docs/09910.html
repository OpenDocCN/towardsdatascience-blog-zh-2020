<html>
<head>
<title>Exploratory Data Analysis For Data Modeling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于数据建模的探索性数据分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/exploratory-data-analysis-intro-for-data-modeling-8ff019362371?source=collection_archive---------45-----------------------#2020-07-13">https://towardsdatascience.com/exploratory-data-analysis-intro-for-data-modeling-8ff019362371?source=collection_archive---------45-----------------------#2020-07-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f7d5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何了解数据集、定义因变量和自变量、计算目标变量和预测变量之间的相关系数、数据转换</h2></div><p id="8a30" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">探索性数据分析(EDA)是一个广泛的话题。很难在一篇文章中涵盖这一点。探索性数据分析可用于了解数据以及数据集不同特征之间的关系。也可以通过了解要素来选择重要的要素并准备数据集，以便统计模型能够适合数据集。不管原因是什么，了解这些特性以及特性之间的关系是非常重要的。在本文中，我将重点介绍用于数据建模的探索性数据分析(EDA)。虽然我们不打算在这里做预测。我们将只关注 EDA 部分。</p><h2 id="6d20" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">资料组</h2><p id="f6a0" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">我使用的是 scikit-learn 库中已经存在的波士顿数据集。它包含有关波士顿房价的信息。首先，导入必要的包和数据集。</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="1475" class="le lf it mh b gy ml mm l mn mo">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>%matplotlib inline<br/>from sklearn.datasets import load_boston<br/>boston_data = load_boston()</span></pre><p id="6ef9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为参考，波士顿数据集分为两部分。一个是包含特性的数据部分，另一个包含房屋的价格。我们将价格作为要素包含在同一个数据集中。</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="70e9" class="le lf it mh b gy ml mm l mn mo">df = pd.DataFrame(data=boston_data.data, columns=boston_data.feature_names)</span><span id="af4d" class="le lf it mh b gy mp mm l mn mo">df["prices"] = boston_data.target</span></pre><figure class="mc md me mf gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mq"><img src="../Images/c2a43563abff76637a71b97cc7db983d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mO3lsSShvTsRCLjrFQ-39A.png"/></div></div></figure><p id="abf6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">找出有多少特征和多少观察值:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="56cd" class="le lf it mh b gy ml mm l mn mo">df.shape</span><span id="6a15" class="le lf it mh b gy mp mm l mn mo">#Output:<br/>(506, 14)</span></pre><p id="4b47" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据集的形状表示，数据集中有 14 个要素和 506 个观测值。现在，列出数据集中的所有列或要素:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="836d" class="le lf it mh b gy ml mm l mn mo">df.columns</span><span id="fdb2" class="le lf it mh b gy mp mm l mn mo">#Output:<br/>Index(['CRIM', 'ZN', 'INDUS', 'CHAS', 'NOX', 'RM', 'AGE', 'DIS', 'RAD', 'TAX', 'PTRATIO', 'B', 'LSTAT', 'prices'], dtype='object')</span></pre><p id="a335" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些功能的名称可能看起来晦涩难懂。以下是对这些功能的解释:</p><p id="4a2c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">各城镇的人均犯罪率</p><p id="6297" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> ZN: </strong>面积超过 25，000 平方英尺的住宅用地比例。脚</p><p id="e02e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">梧桐:</strong>每个城镇非零售商业亩数比例</p><p id="717b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> CHAS: </strong>查尔斯河虚拟变量(= 1，如果区域边界为河流；否则为 0)</p><p id="7c51" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> NOX: </strong>一氧化氮浓度，以每千万份为单位</p><p id="8255" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> RM: </strong>平均房间数</p><p id="fff1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">楼龄:</strong>1940 年前建成的自住单位比例</p><p id="fbe3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> DIS: </strong>到五个波士顿就业中心的加权距离</p><p id="ea33" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> RAD: </strong>放射状公路可达性指标</p><p id="adac" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">税:</strong>每万美元的财产税税率</p><p id="09b7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">各城镇学生与教师的比例</p><p id="d159" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> B: </strong> 1000(Bk — 0.63)2，其中 Bk 是各城镇非裔美国人的比例</p><p id="88d3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">LSTAT: 处于较低地位的人口所占的百分比</p><p id="0611" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">价格:千美元住宅的价格</p><p id="93f6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们对数据集有了更清楚的了解。在开始任何数据探索之前，检查缺失的数据是很重要的:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="8a69" class="le lf it mh b gy ml mm l mn mo">df.isnull().sum()</span></pre><figure class="mc md me mf gt mr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/33401fc76b3a841b1aced31256087667.png" data-original-src="https://miro.medium.com/v2/resize:fit:234/format:webp/1*if8z38yg6tzUl16wrUgOvw.png"/></div></figure><p id="43d1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">幸运的是，这个数据集中没有缺失值。所以，我们可以进一步分析。</p><h2 id="8aeb" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">因变量和自变量</h2><p id="ed04" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">在这个数据集中，我们需要找出因变量和自变量。如果你注意到数据集中，人们可能会有兴趣根据其他特征来预测房价。因为他们不想支付高于公平市场价值的价格。根据经验，我们可以预计，根据数据集中的其他要素，房价可能会有所不同。所以，<strong class="kk iu">在这个数据集中，房价是因变量</strong>。</p><p id="af8d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">选择自变量或预测变量可能很棘手。它主要取决于变量与因变量的关系。我们可以从本能开始，然后测试它。我的直觉告诉我，这个数据集的预测变量可以是 RM、CRIM、DIS、Age 和 PTRATIO。如果我们想到细节:</p><p id="ec9e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">RM(平均房间数)会影响平方英尺，影响房子的价格。与住房的关系预计将是积极的。这意味着如果房间数量越多，价格也越高。</p><p id="77e6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">犯罪率也可能影响价格。如果犯罪率更高，很可能房价更低。到五个波士顿就业中心(DIS)的加权距离也可能与房价负相关。师生比也可能与房价成负相关，因为孩子的教育对父母来说很重要。现在，检查一下我们的直觉是否正确。</p><h2 id="0461" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">探索性分析</h2><p id="0ebf" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">从目标变量或因变量的分布开始:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="a8fe" class="le lf it mh b gy ml mm l mn mo">sns.set(rc={'figure.figsize': (12, 8)})<br/>sns.distplot(df["prices"], bins=25)<br/>plt.show()</span></pre><figure class="mc md me mf gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mz"><img src="../Images/3fb9a8f6841c79c42247f1bcb9706392.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*igQvhHg-OGbb9FLYFKgkYQ.png"/></div></div></figure><p id="6585" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如上图所示，价格的分布几乎是正态的。在上分位数中有一些异常值。</p><p id="1058" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个非常重要的步骤是了解因变量和自变量之间的关系。预测变量之间的相关性对于选择正确的预测变量也很重要。以下是在数据集或部分数据集的所有要素之间绘制相关矩阵的方法。因为这个数据集不太大，所以我取整个数据集并绘制相关矩阵:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="a01d" class="le lf it mh b gy ml mm l mn mo">correlation_matrix = df.corr().round(2)</span><span id="669d" class="le lf it mh b gy mp mm l mn mo">sns.set(rc={'figure.figsize':(11, 8)})<br/>sns.heatmap(data=correlation_matrix, annot=True)<br/>plt.show()</span></pre><figure class="mc md me mf gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi na"><img src="../Images/a5900c75427753ef43ef39edaea5214f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tJ4RTa97G97dLlxp_ohEIQ.png"/></div></div><p class="nb nc gj gh gi nd ne bd b be z dk translated">来源:作者，相关矩阵</p></figure><p id="6fa2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">提醒你一下，相关系数的范围是-1 到 1。-1 表示有很强的负相关性，1 表示有很强的正相关性。如果相关系数为零，则没有相关性。</p><p id="1fa1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，从上面的相关矩阵中检查目标变量“价格”和我们选择的预测变量(RM、CRIM、DIS、AGE 和 PTRATIO)之间的相关性。</p><p id="9e85" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如图所示，价格与 RM 的相关系数为-0.7，为强正相关。价格和犯罪之间的相关系数是-0.39，这是一个显著的负相关。价格与 DIS、年龄和 PTRATIO 之间的相关系数分别为 0.25、-0.38 和-0.51，表明相关性非常显著。你可能认为除了 CHAS，所有的特征都与我们的因变量有很好的相关性，这是正确的。如果我用这个数据集写一个预测算法，<strong class="kk iu">我将只排除 CHAS，把其余的特征作为预测变量或自变量。</strong></p><p id="45c5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们进一步研究因变量和自变量之间的关系。这次我想看看个人关系。在本文中，我不打算检查所有预测变量与目标变量之间的关系。我根据 correlation_matrix 中的相关性选择两个预测变量。在这里，我采用了与“价格”有良好负相关关系的年龄和有良好正相关关系的 DIS。</p><p id="ce53" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要查看 RM 和 DIS 与目标变量之间的关系，散点图是最有帮助的。</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="228a" class="le lf it mh b gy ml mm l mn mo">plt.figure(figsize=(20, 5))</span><span id="4af9" class="le lf it mh b gy mp mm l mn mo">features = ['RM', 'DIS']<br/>target = df['prices']</span><span id="97df" class="le lf it mh b gy mp mm l mn mo">for i, col in enumerate(features):<br/>    plt.subplot(1, len(features) , i+1)<br/>    x = df[col]<br/>    y = target<br/>    plt.scatter(x, y, marker='o')<br/>    plt.title(col)<br/>    plt.xlabel(col)<br/>    plt.ylabel('prices')</span></pre><figure class="mc md me mf gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nf"><img src="../Images/485f6d5c04f048e7f3d5cedd7e43cb4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tN1lVgIi81OTYcrFPpSLEQ.png"/></div></div></figure><p id="ccaa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从上面的散点图中，我们可以看到年龄的分布是左偏的，DIS 的分布是右偏的。在年龄图中，上分位数有一个聚类，在 DIS 图中，下分位数有一个聚类。这种关系呈线性趋势。但如果我们想到的是线性模型，就要做一些数据操作，让关系成为更强的线性关系。当数据向左倾斜时，转换数据的一种方法是获取数据的立方体。当它向左倾斜时，用圆木会有帮助。有几种方法可以转换数据。我将在以后的文章中详细讨论这一点。</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="7d65" class="le lf it mh b gy ml mm l mn mo">plt.figure(figsize=(20, 5))</span><span id="b038" class="le lf it mh b gy mp mm l mn mo">df['AgeN'] = df['AGE']**3<br/>df['DisN'] = np.log(df['DIS'])</span><span id="c12a" class="le lf it mh b gy mp mm l mn mo">features = ['AgeN', 'DisN']<br/>target = df['prices']</span><span id="88df" class="le lf it mh b gy mp mm l mn mo">for i, col in enumerate(features):<br/>    plt.subplot(1, len(features) , i+1)<br/>    x = df[col]<br/>    y = target<br/>    plt.scatter(x, y, marker='o')<br/>    plt.title(col)<br/>    plt.xlabel(col)<br/>    plt.ylabel('prices')</span></pre><figure class="mc md me mf gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi ng"><img src="../Images/fbf285ca01c5f90e85cd6b59ca24d39e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B1qjw8xxC_LJgnL12tHL6w.png"/></div></div></figure><p id="1a02" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你注意到，集群消失了，线性更强了。这两个预测变量已准备好进行建模。请用其他预测变量进行练习。</p><p id="a174" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从本文中，我们学习了如何检查空值、定义预测值和相关值、制作相关矩阵、转换数据以提高数据建模的质量。</p><p id="56c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更多阅读推荐:</p><p id="eee4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae nh" rel="noopener" target="_blank" href="/how-to-present-the-relationships-amongst-multiple-variables-in-python-fa1bdd4f368c">如何在 Python 中呈现多个变量之间的关系</a></p><p id="c44b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae nh" rel="noopener" target="_blank" href="/basic-linear-regression-algorithm-in-python-for-beginners-c519a808b5f8">Python 中的基本线性回归算法，适合初学者</a></p><p id="0bf6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae nh" rel="noopener" target="_blank" href="/hypothesis-testing-characteristics-and-calculation-ba3bdf516ea5">假设检验、特征和计算</a></p><p id="2d6f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae nh" rel="noopener" target="_blank" href="/master-pandas-groupby-for-efficient-data-summarizing-and-analysis-c6808e37c1cb">掌握熊猫的分组情况，进行高效的数据汇总和分析</a></p><p id="f01f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae nh" rel="noopener" target="_blank" href="/understand-the-data-with-univariate-and-multivariate-charts-and-plots-in-python-3b9fcd68cd8">用 Python 中的单变量和多变量图表和绘图理解数据</a></p><p id="1a7a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae nh" rel="noopener" target="_blank" href="/build-a-complete-neural-network-from-scratch-in-python-308eaed23e06">用 Python 从零开始构建一个完整的神经网络</a></p></div></div>    
</body>
</html>