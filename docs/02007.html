<html>
<head>
<title>A correlation measure based on Theil-Sen regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于 Theil-Sen 回归的相关性度量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-correlation-measure-based-on-theil-sen-regression-31b8b9ed64f1?source=collection_archive---------27-----------------------#2020-02-25">https://towardsdatascience.com/a-correlation-measure-based-on-theil-sen-regression-31b8b9ed64f1?source=collection_archive---------27-----------------------#2020-02-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/97f003f4294e48849b8c93d4dddad225.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7-UR7c1qw01_kq5jOj_YnQ.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">来源:https://www.tylervigen.com/spurious-correlations</p></figure><p id="826f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi lb translated"><span class="l lc ld le bm lf lg lh li lj di"> A </span>关联和相关测量是描述性统计和探索性数据分析的重要工具。它们为变量之间的函数关系提供了统计证据。</p><p id="9837" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个流行的测量方法是皮尔逊相关系数<strong class="kf ir"> r(⋅，⋅</strong>。对于度量数据样本<strong class="kf ir"> x </strong>和<strong class="kf ir"> y </strong>，给出如下:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/466ac493dceaf1db993ea4e2cbff8f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*Cq5SH13rg0UMjOmF-5cIMA.png"/></div></figure><p id="b4d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<strong class="kf ir"> s(⋅，⋅) </strong>是样本协方差，<strong class="kf ir"> s(⋅) </strong>是样本标准差。</p><p id="999d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们把<strong class="kf ir"> n </strong>观测值<strong class="kf ir"> x </strong>和<strong class="kf ir"> y </strong>的序列看作欧几里得空间<strong class="kf ir"> ℝⁿ </strong>中的向量，那么相关系数就可以被几何解释。首先，我们通过重新调整<strong class="kf ir"> x </strong>和<strong class="kf ir"> y </strong>来标准化样本，如下所示:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/31975532de7763cc14d21ab36e7bd2e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*8_TdJjIx-x1hZB9AXJm6EQ.png"/></div></figure><p id="52c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中<strong class="kf ir"> μ(⋅) </strong>是算术平均值(从每次观察中减去)。这里我们假设使用无偏样本协方差，即因子为<strong class="kf ir"> 1/(n - 1) </strong>的样本协方差。然后，我们发现归一化样本位于单位球面上，相关系数是它们的点积:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/e2089305f954e43cf945e65cdab5175e.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*LGa_QXD0QnQOo6UUcECd9w.png"/></div></figure><p id="c7e7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种高维几何解释有助于理解皮尔逊相关的一些重要性质。例如，我们立即理解，该度量允许我们比较归一化样本所指向的方向:<strong class="kf ir"> r(x，y) = 1 </strong>表示它们指向相同的方向，<strong class="kf ir"> r(x，y) = -1 </strong>表示它们指向相反的方向。如果<strong class="kf ir"> r(x，y) </strong>消失，则矢量<strong class="kf ir"> z(x) </strong>和<strong class="kf ir"> z(y) </strong>正交。我们甚至可以通过关系式<strong class="kf ir"> r(x，y) = cos(φ) </strong>计算归一化样本之间的“关联角度”<strong class="kf ir"> φ </strong>。</p><h1 id="33bf" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">相关和回归</h1><p id="a1be" class="pw-post-body-paragraph kd ke iq kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi lb translated">皮尔逊相关系数的另一个有用解释来自基于最小二乘法的简单线性回归。(其他解释见<a class="ae kc" href="https://doi.org/10.2307%2F2685263" rel="noopener ugc nofollow" target="_blank">罗杰斯和尼斯旺 1988 </a>。)在最后一段中，我们将两个样本视为两个维度为<strong class="kf ir"> n </strong>的向量。<strong class="kf ir"> </strong>我们现在要把它们看成是二维的<strong class="kf ir"> n </strong>个数据点。如果我们使用最小二乘法来确定通过这些数据点的最佳拟合直线，其中我们将<strong class="kf ir"> y </strong>视为响应变量，将<strong class="kf ir"> x </strong>视为解释变量，则该直线的斜率为<strong class="kf ir"> m(y，x) = s(x，y) / (s(x)) </strong>。反之，如果我们把<strong class="kf ir"> x </strong>作为响应变量，把<strong class="kf ir"> y </strong>作为解释变量，回归线就会有斜率<strong class="kf ir"> m(x，y) = s(x，y) / (s(y)) </strong>。首先，我们观察到，无论哪个变量被视为因变量或自变量，回归线的斜率都不会改变符号。这一点，再加上一点代数，让我们得出结论:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/56b0ad0ac4faf8a87f3359eb7f0b987c.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*pGxPGw-svcxoLd4x98cD3g.png"/></div></figure><p id="e62e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之:皮尔逊系数是最佳拟合直线斜率的(带符号)几何平均值，您可以通过最小二乘法绘制数据点。这个等式非常清楚地表明，皮尔逊系数测量了<strong class="kf ir"> x </strong>和<strong class="kf ir"> y </strong>线性<em class="mu">相关的程度。它还表明，皮尔逊系数与最小二乘法一样容易受到异常值的影响:它通常不被认为是稳健的统计量。Anscombe quartet 是一个旨在展示此类漏洞的合成测试数据集。尽管四个数据集以散点图的形式呈现非常不同，但基于最小二乘法的回归线是相同的:</em></p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/603f054f126df15a72b8c196665045b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D-_PHhdiBi7bSQlXlsuFig.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">来源:<a class="ae kc" href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></figure><p id="f613" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi lb translated"><span class="l lc ld le bm lf lg lh li lj di">简单线性回归的最小二乘法的另一种选择是 Theil-Sen 估计。这种更稳健的方法通过所有可通过数据点绘制的直线的斜率的中值来确定回归线的斜率:</span></p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/92a7cb7edda1a459d3eea5095cd3b79d.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*k6pNIozC2j3f65xYjg1ezg.png"/></div></figure><p id="315c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，使用皮尔逊相关系数和最小二乘回归之间的上述关系，我们现在可以制定一个与泰尔-森估计相关的变量:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/406c27e1087154485da8b902e701713e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*TGIEbE1Hwu6ie4isusNErQ.png"/></div></figure><p id="58cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果中值斜率具有相同的符号，否则为零。然而，在斜率的符号改变时将测量值设置为零的条件可能看起来是人为的:</p><ul class=""><li id="176d" class="mx my iq kf b kg kh kk kl ko mz ks na kw nb la nc nd ne nf bi translated">当交换<strong class="kf ir"> x </strong>和<strong class="kf ir"> y </strong>时，中间坡度<strong class="kf ir">通称为</strong>不改变符号，</li><li id="ccae" class="mx my iq kf b kg ng kk nh ko ni ks nj kw nk la nc nd ne nf bi translated">当它出现时，<strong class="kf ir"> x </strong>和<strong class="kf ir"> y </strong>之间的肯德尔等级相关性消失。</li></ul><p id="2824" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这可以看如下。假设单个斜率的<strong class="kf ir"> K </strong>为负，N-K<strong class="kf ir">为正。交换<strong class="kf ir"> x </strong>和<strong class="kf ir"> y </strong>意味着取斜率的倒数。对斜率排序以计算其中值揭示了以下关系:</strong></p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/f7fa75bfb31ead52ec7cf480aa87e5c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*OCuXMqzJZaDwxRDy3Q8Knw.png"/></div></figure><p id="436c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到，只有当负斜率和正斜率一样多时，中间值的符号才会发生变化。然而，这意味着肯德尔等级相关性τ消失，这可以从该度量的以下重写中看出:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/8cbd0c997c36e1fe4d2d0b34cef7a3b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4bfvy7N4c5mrp0fiXlQrJw.png"/></div></div></figure><p id="5b92" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以在 Anscombe 四重奏上评估这个基于 Theil-Sen 的相关系数，并将其与 Pearson 系数进行比较。下表显示了这种比较，以及基于等级统计的另外两种流行的度量，Spearman 的ρ和已经提到的 Kendall 的τ:</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/79513f0334bb63d171461c99fd910235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uke34qIr7Qiw_yGHB02oWA.png"/></div></div></figure><p id="42b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可能有点令人惊讶的是，对于 Anscombe 4 数据集，Theil-Sen、Spearman 和 Kendall 相关性测量被证明是高度<strong class="kf ir">不稳定的</strong>:即使是最小幅度的任何噪声添加到数据点都会产生任意的相关性值。对于基于等级的 Spearman 和 Kendall 测量，这可以很容易地解释:如果大多数的<strong class="kf ir"> x </strong>值是相同的或几乎相同的，数据中的微小变化可以产生任意的等级。</p><p id="ea01" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一方面，Theil-Sen 估计器对回归线<strong class="kf ir"> m(y，x) </strong>的斜率产生任意大的值，对<strong class="kf ir"> m(x，y) </strong>产生任意接近于零的值，这导致在受到噪声影响时产生不明确的乘积。</p><p id="cb41" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一般来说，如果至少有一个要比较的样本只显示出很小的离差，那么相关测量将变得不可靠。对于稳健的相关性测量，这种离差应该通过稳健的方法来测量。Anscombe 4 数据集内的<strong class="kf ir"> x </strong>值的中值绝对偏差消失，因此 Theil-Sen 估计相关性和等级相关性度量不明确也就不足为奇了。</p><h1 id="647b" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">摘要</h1><p id="c246" class="pw-post-body-paragraph kd ke iq kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi lb translated">稳健简单线性回归的 Theil-Sen 估计可用于定义相关性度量，类似于 Pearson 相关系数与最小二乘回归的关系。在 Anscombe 四重奏上进行评估，它显示出类似于等级相关性度量的特征，例如 Spearman 的ρ或 Kendall 的τ。</p><p id="6ca3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">参考文献</strong></p><p id="03ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">安斯科姆，F. J. (1973)。“统计分析中的图表”。美国统计学家。27 (1): 17–21.</p><p id="0ae0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://doi.org/10.2307%2F2685263" rel="noopener ugc nofollow" target="_blank">罗杰斯；西弗吉尼亚州尼斯旺德(1988 年)。“看相关系数的十三种方法”。美国统计学家。42 (1): 59–66.</a></p><p id="bd79" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://doi.org/10.2307%2F2285891" rel="noopener ugc nofollow" target="_blank">森·p·k .(1968)。“基于肯德尔τ的回归系数估计值”。美国统计协会杂志。63 (324): 1379–1389.</a></p><p id="d4df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">希尔，H. (1950 年)。“线性和多项式回归分析的秩不变方法”。内德尔。阿卡德。韦滕施。，继续。53: 386–392.</p></div></div>    
</body>
</html>