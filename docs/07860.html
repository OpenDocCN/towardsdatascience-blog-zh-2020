<html>
<head>
<title>Geoparsing with Python and Natural Language Processing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 和自然语言处理进行地理解析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/geoparsing-with-python-and-natural-language-processing-4762a7c92f08?source=collection_archive---------21-----------------------#2020-06-11">https://towardsdatascience.com/geoparsing-with-python-and-natural-language-processing-4762a7c92f08?source=collection_archive---------21-----------------------#2020-06-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1929" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">提取地名和指定坐标-教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9f9fbb2f1b41d915281db75cca2770fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2q66CfIhUb0Eh1NW"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">纳蕾塔·马丁在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="905d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大量的可用文本数据具有可以从自动信息提取中受益的位置特征。自然语言处理(NLP)在过去的五年中取得了显著的进步。然而，从文本中提取地理信息的研究仍处于起步阶段。在本教程中，我们使用 Python 和 NLP 来 Geoparse twitter 数据集。</p><h2 id="0315" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">地质公园</h2><p id="fce5" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated"><strong class="lb iu"> <em class="mt"> Geoparsing </em> </strong>是一个地名解析过程，将对地点的自由文本描述(如“伦敦以东两公里”)转换为地理标识符(带经纬度的坐标)。</p><p id="e14e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">地理解析在许多应用中是必不可少的，包括地理信息检索(GIR)、地理信息提取(GIE)和地理信息分析(GIA)任务。</p><p id="fb86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用地理解析来确定文档的地理范围，解码灾难响应、商业新闻分析以及其他多个领域的位置信息。</p><p id="2e60" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了说明什么是地质公园，让我们考虑这个讽刺<a class="ae ky" href="https://medium.com/@allanishac/protesters-commandeer-nyc-sanitation-trucks-use-them-to-block-trump-tower-60c01275c1f6" rel="noopener">标题示例</a>。</p><blockquote class="mu mv mw"><p id="e19e" class="kz la mt lb b lc ld ju le lf lg jx lh mx lj lk ll my ln lo lp mz lr ls lt lu im bi translated">“抗议者偷走纽约市的环卫车，用它们来阻挡特朗普大厦”</p></blockquote><p id="8732" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，地理区划包含两个部分:地名识别和地名解析。首先，是地名提取或识别[纽约市，特朗普大厦]。下一步是将地名链接到地理坐标[(40.768121，-73.981895)，(40.762347，-73.973848)]。</p><p id="da59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下一节中，我们将使用 Python 地理解析库<a class="ae ky" href="https://github.com/openeventdata/mordecai" rel="noopener ugc nofollow" target="_blank"> Mordecai </a>对简单文本进行地理解析。</p><h2 id="1ba8" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">Python 地理解析示例</h2><p id="be7e" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">对于本教程，我们将使用<a class="ae ky" href="https://github.com/openeventdata/mordecai" rel="noopener ugc nofollow" target="_blank"> Mordecai </a>库进行地理解析。Mordecai 是全文地理解析 Python 库。使用这个库，您可以从一段文本中提取地名，将它们解析到正确的位置，并返回它们的坐标和结构化的地理信息。</p><p id="71c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从一个简单的地质分析例子开始。Mordecai Python Geoparsing 库具有 Geoparse 函数，该函数接收文本并从文本中返回结构化的地理信息。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="42a9" class="lv lw it nb b gy nf ng l nh ni">from mordecai import Geoparser</span><span id="b550" class="lv lw it nb b gy nj ng l nh ni">geo = Geoparser()<br/>geo.geoparse(“Eiffel Tower is located in Paris”)</span></pre><p id="478c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于任何文本输入，末底改返回文本中存在的位置特征。在这个例子中，它正确地预测了埃菲尔铁塔和巴黎城。有趣的是，与这两个位置相关联的纬度和经度是不同的。预测的埃菲尔铁塔坐标比巴黎这座城市还要具体。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="75df" class="lv lw it nb b gy nf ng l nh ni">[{'word': 'Eiffel Tower',<br/>  'spans': [{'start': 0, 'end': 12}],<br/>  'country_predicted': 'FRA',<br/>  'country_conf': 0.611725,<br/>  'geo': {'admin1': 'Île-de-France',<br/>   'lat': '48.85832',<br/>   'lon': '2.29452',<br/>   'country_code3': 'FRA',<br/>   'geonameid': '6254976',<br/>   'place_name': 'Tour Eiffel',<br/>   'feature_class': 'S',<br/>   'feature_code': 'MNMT'}},<br/> {'word': 'Paris',<br/>  'spans': [{'start': 27, 'end': 32}],<br/>  'country_predicted': 'FRA',<br/>  'country_conf': 0.9881995,<br/>  'geo': {'admin1': 'Île-de-France',<br/>   'lat': '48.85339',<br/>   'lon': '2.34864',<br/>   'country_code3': 'FRA',<br/>   'geonameid': '2988506',<br/>   'place_name': 'Paris',<br/>   'feature_class': 'A',<br/>   'feature_code': 'ADM3'}}]</span></pre><p id="28e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Mordecai Python 库采取了不同的步骤来实现这一结果。首先，它使用<a class="ae ky" href="https://github.com/explosion/spaCy/" rel="noopener ugc nofollow" target="_blank"> spaCy </a>的命名实体识别从文本中提取地名。然后，它使用 Geonames gazetteer 查找地名的潜在坐标。最终过程使用神经网络从地名录条目中预测国家和地名。</p><h2 id="f173" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">地质公园推文</h2><p id="dfae" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">为了抓取 tweets，首先，我们设置了<a class="ae ky" href="https://github.com/tweepy/tweepy" rel="noopener ugc nofollow" target="_blank"> Tweepy </a> API 来抓取标签。下面这段代码使用 Tweepy 抓取一个标签(#BlackLivesMatter)，并将标签中的所有 tweets 保存到本地 CSV 文件中。</p><p id="cdc6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用 Tweepy 抓取推文</p><p id="d909" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们读一下关于熊猫的 CSV 推文，看看前几个专栏。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="cd26" class="lv lw it nb b gy nf ng l nh ni">df = pd.read_csv(“tweets.csv”, header=None, names=[“date”, “tweet”])<br/>df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/5ca86a88a24f5dad58f1f39fbf53d0ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*smP8SEiFOx4Y1SzBfivCSA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">推特数据帧</p></figure><p id="ba34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据框现在保存了推文和文本的日期。让我们使用 Mordecai Geoparsing 功能来提取位置信息并分配坐标。我们设置了这个函数，它获取一个数据帧，并生成一个干净的数据帧，其中包含来自地理解析的附加位置信息。</p><p id="11e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的干净数据集现在已经提取了地名，并通过预测和预测的置信度为 tweet 文本中的每个地名分配了坐标。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/debf0ec4cb8cdd5e38ae2c51d4c5438d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q1BtfDfVGhFAfC3nXrH5lA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">清理 Geoparsed 数据帧</p></figure><p id="348c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了绘制使用 Mordecai Geoparsing Python 库提取的#BlackLivesMatter hashtag 的地理范围，我们现在可以使用任何您喜欢的地理空间数据可视化 Python 库。我用 Plotly Express 来绘制数据。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="e1d5" class="lv lw it nb b gy nf ng l nh ni">fig = px.scatter_mapbox(df_clean, lat=”lat”, lon=”lon”, size_max=15, zoom=1, width=1000, height=800, mapbox_style=”dark”)<br/>fig.data[0].marker = dict(size = 5, color=”red”)<br/>fig</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/aa862baf61f0e68a50297908f204a681.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CHrf0L4TqhZ0Ad9fTl5uXg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">#BlackLivesMatter 标签的地理范围-地理公园</p></figure><h2 id="708c" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">结论</h2><p id="243a" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">地理句法分析是从文本中自动提取位置特征的重要组成部分。在本教程中，我们了解了如何使用 Mordecai Geoparsing Python 库对文本进行 Geoparse 处理。</p><p id="a752" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要使用 Mordecai 运行 Geoparsing，您需要安装它。您还需要有一个正在运行的 docker 容器。你可以在这里找到安装说明<a class="ae ky" href="https://github.com/openeventdata/mordecai" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="2c2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程的代码可以在这个 Jupyter 笔记本中找到。</p><div class="nn no gp gr np nq"><a href="https://github.com/shakasom/geoparsing/blob/master/Geoparsing%20with%20Python.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="nr ab fo"><div class="ns ab nt cl cj nu"><h2 class="bd iu gy z fp nv fr fs nw fu fw is bi translated">shaka som/地质公园</h2><div class="nx l"><h3 class="bd b gy z fp nv fr fs nw fu fw dk translated">permalink dissolve GitHub 是超过 5000 万开发人员的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="ny l"><p class="bd b dl z fp nv fr fs nw fu fw dk translated">github.com</p></div></div><div class="nz l"><div class="oa l ob oc od nz oe ks nq"/></div></div></a></div></div></div>    
</body>
</html>