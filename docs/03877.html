<html>
<head>
<title>TF-IDF in a nutshell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TF-IDF 概述</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/tf-idf-in-a-nutshell-b0ff082fbbc?source=collection_archive---------40-----------------------#2020-04-10">https://towardsdatascience.com/tf-idf-in-a-nutshell-b0ff082fbbc?source=collection_archive---------40-----------------------#2020-04-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/3b97af101fa67c5845265011f6bf087a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ESQkkApCJ3LTBf6t-48GBA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来自 pixabay.com 的照片</p></figure><div class=""/><div class=""><h2 id="5630" class="pw-subtitle-paragraph kf jh ji bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dk translated">通过 5 个简单的例子了解 TF-IDF 的发展</h2></div><figure class="ky kz la lb gt iv gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/17eac55b05aa9632cb175ace2e05a700.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*KS4s0NoVXI-2Y8gevPCWtw.jpeg"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">彼得·鲁恩，照片来自 alchetron.com</p></figure><p id="9534" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">早在 1958 年，汉斯·彼得·鲁恩在他的论文《文献摘要的自动生成》中假设“一篇文章中单词出现的频率提供了一个有用的单词重要性的度量”，这可能是迄今为止信息检索科学中最重要的事情之一，并被用于所有知名的大大小小的搜索引擎，从谷歌和雅虎到定制搜索解决方案，如弹性搜索和蝎狮搜索。</p><p id="f039" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">Luhn 假设的重要性不能被高估，并且在信息检索领域的许多进一步的科学研究都是基于 Luhn 的假设，尽管并非所有的研究都提到，随着时间的推移，它可能成为公理。</p><p id="611c" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">在这篇文章中，我将尝试用非常清晰的例子来展示 TF 代表“词频”和它的对应词 IDF 代表“逆文档频率”是如何帮助找到你要找的东西的。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="f2a1" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">让我们看 5 份文件:</p><pre class="ky kz la lb gt mg mh mi mj aw mk bi"><span id="8162" class="ml mm ji mh b gy mn mo l mp mq">1. My dog doesn't like all my pets, but me and my wife do love them all. A dog cannot be a cat lover<br/>2. Cats and dogs do not like each other, but my cat does like dogs<br/>3. Walking a dog is a good start of the day<br/>4. Not all cats like walking, but some cats do<br/>5. All dogs like walking, but mine doesn't like. It's like so weird</span></pre><p id="edfe" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">并尝试为不同的查询对它们进行排序(即找到最相关和最不相关的以及顺序)。</p><h1 id="0baa" class="mr mm ji bd ms mt mu mv mw mx my mz na ko nb kp nc kr nd ks ne ku nf kv ng nh bi translated">如果单词出现，权重= 1，否则为 0</h1><p id="6bc2" class="pw-post-body-paragraph lc ld ji le b lf ni kj lh li nj km lk ll nk ln lo lp nl lr ls lt nm lv lw lx im bi translated"><strong class="le jj">查询:‘喜欢’</strong>。</p><p id="dae3" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">注意，我们不知道查询中的“like”是什么意思:比如“A 就像 B”或“我喜欢 smth”。那么我们能做些什么来排列文档呢？</p><p id="74ea" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">首先想到的是，如果一个文档根本不包含单词“like ”,那么它可能不太相关。因此，顺序可以是:</p><pre class="ky kz la lb gt mg mh mi mj aw mk bi"><span id="7749" class="ml mm ji mh b gy mn mo l mp mq">1. My dog doesn't <strong class="mh jj">like</strong> all my pets, but me and my wife do love them all. A dog cannot be a cat lover<br/>2. Cats and dogs do not <strong class="mh jj">like</strong> each other, but my cat does <strong class="mh jj">like</strong> dogs<br/>4. Not all cats <strong class="mh jj">like</strong> walking, but some cats do<br/>5. All dogs <strong class="mh jj">like</strong> walking, but mine doesn't <strong class="mh jj">like</strong>. It's <strong class="mh jj">like</strong> so weird<br/>3. Walking a dog is a good start of the day</span></pre><p id="4cbe" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">我们把文档#3 放在最后，因为它不包含“like”。至于其余的，我们没有改变他们的顺序，因为他们都包含“喜欢”。这样的排名质量够好吗？我不这么认为，因为在前 4 个文档中，有 2 个(#5 和#2)似乎比其他文档更相关，因为它们提供了更多与查询术语“like”相关的事实(请记住，我们不知道“like”在查询中的确切含义)，但它们不是前 2 个。那么我们能做些什么呢？</p><h1 id="7879" class="mr mm ji bd ms mt mu mv mw mx my mz na ko nb kp nc kr nd ks ne ku nf kv ng nh bi translated">权重=术语频率</h1><p id="d09a" class="pw-post-body-paragraph lc ld ji le b lf ni kj lh li nj km lk ll nk ln lo lp nl lr ls lt nm lv lw lx im bi translated"><strong class="le jj">查询:‘喜欢’。</strong></p><p id="cc90" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">如前所述，根据 Luhn 的假设，包含查询术语的更多出现的文档可能更相关。让我们根据文档的词频对其进行排序(注意，在这里以及在信息检索领域，一般来说“频率”只是指计数，而不是像在物理学中那样用计数除以某个值):</p><pre class="ky kz la lb gt mg mh mi mj aw mk bi"><span id="aef3" class="ml mm ji mh b gy mn mo l mp mq">5. All dogs <strong class="mh jj">like</strong> walking, but mine doesn't <strong class="mh jj">like</strong>. It's <strong class="mh jj">like</strong> so weird | tf = 3<br/>2. Cats and dogs do not <strong class="mh jj">like</strong> each other, but my cat does <strong class="mh jj">like</strong> dogs | tf = 2<br/>1. My dog doesn't <strong class="mh jj">like</strong> all my pets, but me and my wife do love them all. A dog cannot be a cat lover | tf = 1<br/>4. Not all cats <strong class="mh jj">like</strong> walking, but some cats do | tf = 1<br/>3. Walking a dog is a good start of the day | tf = 0</span></pre><p id="ba76" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">这解决了问题，现在文档#5 和#2 在最上面。</p><p id="f4be" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">但是现在让我们尝试另一个<strong class="le jj">查询——“我的一天”</strong>:</p><pre class="ky kz la lb gt mg mh mi mj aw mk bi"><span id="7c10" class="ml mm ji mh b gy mn mo l mp mq">1. <strong class="mh jj">My</strong> dog doesn't like all <strong class="mh jj">my</strong> pets, but me and <strong class="mh jj">my</strong> wife do love them all. A dog cannot be a cat lover | tf = 3<br/>2. Cats and dogs do not like each other, but <strong class="mh jj">my</strong> cat does like dogs | tf = 1<br/>3. Walking a dog is a good start of the <strong class="mh jj">day</strong> | tf = 1<br/>4. Not all cats like walking, but some cats do | tf = 0<br/>5. All dogs like walking, but mine doesn't like. It's like so weird | tf = 0</span></pre><p id="196b" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">文档#1 和#2 得到最高的位置，但是它是正确的吗？他们没有提到“天”，只提到了“我的”:我的宠物、我的妻子、我的猫，考虑到这个问题，这些可能也很重要，但很可能不是。文档#3 的位置较低，但它似乎是最相关的。怎么才能放高点？</p><p id="1b03" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">让我们想想“我的”和“日”以及其他词有什么不同。“day”似乎更具体，而“my”几乎可以适用于任何事物，在<strong class="le jj">文档中,“my”出现的频率远远高于“day”和其他更具体的术语</strong>。接下来是“<strong class="le jj">文档频率</strong>”——公式的另一个重要部分，也是术语权重的第二个基石。</p><p id="6c9a" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">1972 年，英国计算机科学家 Karen sprck Jones 在她的一篇学术论文中说:</p><figure class="ky kz la lb gt iv gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/53dfd1d24dc1d00cacf9c0cd2e4d3b9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/format:webp/1*pRcIvL3T2mJvqp9fwF2bSA.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">凯伦·斯帕克·琼斯，照片来自 en.wikipedia.org</p></figure><blockquote class="no"><p id="3148" class="np nq ji bd nr ns nt nu nv nw nx lx dk translated">文档描述的详尽性是它包含的术语的数量，术语的具体性是它所属的文档的数量</p></blockquote><p id="1186" class="pw-post-body-paragraph lc ld ji le b lf ny kj lh li nz km lk ll oa ln lo lp ob lr ls lt oc lv lw lx im bi translated">我们已经讨论了前一部分，现在让我们看看如果我们考虑后一部分，文档顺序是如何变化的。</p><h1 id="6b3f" class="mr mm ji bd ms mt mu mv mw mx my mz na ko nb kp nc kr nd ks ne ku nf kv ng nh bi translated">权重=术语频率*(文档数量/文档频率)</h1><p id="f33e" class="pw-post-body-paragraph lc ld ji le b lf ni kj lh li nj km lk ll nk ln lo lp nl lr ls lt nm lv lw lx im bi translated"><strong class="le jj">查询:‘我的一天’。</strong></p><p id="2c35" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">“My”出现在两个文档中，“day”只出现在一个文档中，因此“my”的 IDF(逆文档频率)为 5(文档总数)/ 2 = 2，5，“day”-5/1 = 5。</p><pre class="ky kz la lb gt mg mh mi mj aw mk bi"><span id="0396" class="ml mm ji mh b gy mn mo l mp mq">1. <strong class="mh jj">My</strong> dog doesn't like all <strong class="mh jj">my</strong> pets, but me and <strong class="mh jj">my</strong> wife do love them all. A dog cannot be a cat lover<br/>Weight = 3(tf of 'my') * 2,5(idf of 'my') + 0(tf of 'day') * 5 (its idf) = 7,5<br/>3. Walking a dog is a good start of the <strong class="mh jj">day</strong><br/>Weight = 0 * 2,5 + 1 * 5 = 5<br/>2. Cats and dogs do not like each other, but <strong class="mh jj">my</strong> cat does like dogs<br/>Weight = 2,5<br/>4. Not all cats like walking, but some cats do<br/>Weight = 0<br/>5. All dogs like walking, but mine doesn't like. It's like so weird<br/>Weight = 0</span></pre><p id="c544" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">在 IDF 的帮助下，我们可以将相关文档“遛狗是一天的良好开端”放在更高的位置，但它仍然不在最上面。原因是什么？这是因为“我的”出现得太频繁了，超过了“当天的 IDF”的重要性。我们如何解决这个问题？我们需要降低 TF 贡献的东西。多年来，从对数(TF)到所谓的“术语频率饱和曲线”，已经提出并研究了许多 TF 归一化的变体。为了简单起见，我们只取对数变量。</p><h1 id="1785" class="mr mm ji bd ms mt mu mv mw mx my mz na ko nb kp nc kr nd ks ne ku nf kv ng nh bi translated">重量= log(1+TF) * (N/df)</h1><figure class="ky kz la lb gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi od"><img src="../Images/92e0651fd59215cd3b028fb31cdf3892.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XvRviy7UrOZ6U1Y2TjjMpQ.png"/></div></div></figure><p id="47d6" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">与线性函数相比，对数平滑的整体思想是自变量越高，它增加得越慢，即，对于较小的 x，它增长得越快，而对于较大的 x，它增长得越慢。要求函数中的“1+x”在项频率= 0 的自变量中不具有 0，因为 log(0)是未定义的，而 log(0+1)是 0，这正是我们对于 tf=0 所需要的。</p><p id="11df" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">让我们看看它是否能解决问题:</p><p id="a136" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated"><strong class="le jj">查询:‘我的一天’。</strong></p><pre class="ky kz la lb gt mg mh mi mj aw mk bi"><span id="8763" class="ml mm ji mh b gy mn mo l mp mq">3. Walking a dog is a good start of the <strong class="mh jj">day</strong><br/>Weight = log(1+0) * 2,5 + log(1+1) * 5 = 0 + 3,47 = 3,47<br/>1. <strong class="mh jj">My</strong> dog doesn't like all <strong class="mh jj">my</strong> pets, but me and <strong class="mh jj">my</strong> wife do love them all. A dog cannot be a cat lover<br/>Weight = log(1+3) * 2,5 + log(1+0) * 5 = 3,47 + 0 = 3,47<br/>2. Cats and dogs do not like each other, but <strong class="mh jj">my</strong> cat does like dogs<br/>Weight = 1,73<br/>4. Not all cats like walking, but some cats do<br/>Weight = 0<br/>5. All dogs like walking, but mine doesn't like. It's like so weird<br/>Weight = 0</span></pre><p id="f656" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">我们可以看到，最相关的文档最终位于第一个位置，但它与另一个权重为 3.47 的文档共享该位置。是对还是错？这是一个很难回答的问题，因为我们永远不知道什么与请求者相关。有可能通过询问“我的一天”,他或她会认为第二个文档也是相关的，因为它给出了“我的”的许多事实，而第一个文档只说了“一天”的一个事实。因此，它们得到相同的重量可能是相当公平的。</p><p id="fdd7" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">因为这种不确定性，这可能是为什么搜索引擎通常返回的不是一个结果，而是一些数字:10 或 20 或其他，所以我们只是让用户自己做最后的决定。</p><h1 id="2760" class="mr mm ji bd ms mt mu mv mw mx my mz na ko nb kp nc kr nd ks ne ku nf kv ng nh bi translated">结论</h1><p id="7b95" class="pw-post-body-paragraph lc ld ji le b lf ni kj lh li nj km lk ll nk ln lo lp nl lr ls lt nm lv lw lx im bi translated">在这篇文章中，我简单地展示了对 TF-IDF 加权公式的思考的演变，证明了它是可行的，并且它的每个组成部分都是重要的。</p><p id="d04a" class="pw-post-body-paragraph lc ld ji le b lf lg kj lh li lj km lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">还有 TF-IDF 的延续，称为 BM25，它基于前面提到的“词频饱和曲线”,特别是更多的概率方法来定义加权公式(再次记住，我们永远不知道什么是真正相关的，因此是概率方法)。总的来说，它仍然是 TF-IDF (+按文档长度规范化)，但是它的根完全不同。这将在另一篇文章中讨论。</p></div></div>    
</body>
</html>