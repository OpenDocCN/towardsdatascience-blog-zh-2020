<html>
<head>
<title>Prototyping Machine Learning Models with Streamlit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Streamlit 构建机器学习模型原型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/prototyping-machine-learning-models-with-streamlit-1134c34e9620?source=collection_archive---------38-----------------------#2020-08-16">https://towardsdatascience.com/prototyping-machine-learning-models-with-streamlit-1134c34e9620?source=collection_archive---------38-----------------------#2020-08-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e197" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 Streamlit 在不到 5 分钟的时间内设置好 GPT-2 演示</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b761328643333ffc391a09d1d79110fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FdE5ZgulQ6cejOnS"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@halacious?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的</a>拍摄</p></figure><p id="a702" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">GitHub Repo:</strong><a class="ae ky" href="https://github.com/happilyeverafter95/ml-streamlit-demo" rel="noopener ugc nofollow" target="_blank">ml-streamlit-demo</a></p><p id="d440" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在笔记本电脑环境之外引入机器学习模型，并将其转化为漂亮的数据产品，过去需要做大量工作。幸运的是，在这个领域有很多工具正在开发中，以使原型制作更容易。不久前，我偶然发现了<a class="ae ky" href="https://www.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>，这是一个用于构建定制 web 应用的开源 Python 库。</p><p id="a7fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它的入门既快速又简单，我用了不到 30 分钟的时间就用一个预先训练好的模型构建了一个应用程序。从那以后，我一直在使用 Streamlit 进行模型原型制作，并展示它们的功能。与使用我的控制台进行预测相比，漂亮的用户界面是一个令人耳目一新的变化。</p><p id="03c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将在本文中分享这个过程，以 GPT-2 为例。</p><h2 id="fd24" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">在本文中，我们将:</h2><ul class=""><li id="757a" class="mo mp it lb b lc mq lf mr li ms lm mt lq mu lu mv mw mx my bi translated">从<a class="ae ky" href="https://github.com/huggingface/transformers" rel="noopener ugc nofollow" target="_blank"> HuggingFace 的变压器库</a>加载<a class="ae ky" href="https://openai.com/blog/better-language-models/" rel="noopener ugc nofollow" target="_blank"> GPT-2 </a></li><li id="2183" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated">使用 Streamlit 在一个简单的 web 应用程序中提供文本生成器</li></ul></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="1d8e" class="nl lw it bd lx nm nn no ma np nq nr md jz ns ka mg kc nt kd mj kf nu kg mm nv bi translated">从变压器加载 GPT-2</h1><p id="14f1" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">GPT-2 是在非常大的英语语料库上训练的变形金刚模型，用于预测短语中的下一个单词。它最近的继任者，<a class="ae ky" href="https://openai.com/blog/openai-api/" rel="noopener ugc nofollow" target="_blank"> GPT-3 </a>，用它的能力震惊了世界。</p><p id="a5c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从安装所有 Python 先决条件开始。这就是我的<code class="fe nz oa ob oc b">requirements.txt</code>的样子。虽然代码中没有提到，但 GPT-2 要求安装 TensorFlow 2.0 或 PyTorch。</p><pre class="kj kk kl km gt od oc oe of aw og bi"><span id="f573" class="lv lw it oc b gy oh oi l oj ok">streamlit==0.56.0<br/>tensorflow==2.2.0<br/>transformers==3.0.2</span></pre><p id="144a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本例中，我们将使用一个 Python 脚本。这是加载 GPT-2 的类，当给定一个起始短语时，用它来生成文本。<code class="fe nz oa ob oc b">max_length</code>属性表示生成文本的最大长度。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><h1 id="3180" class="nl lw it bd lx nm on no ma np oo nr md jz op ka mg kc oq kd mj kf or kg mm nv bi translated">用 Streamlit 服务模型</h1><p id="7821" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">我将定义另一个函数来实例化生成器。这个函数的目的是帮助缓存<code class="fe nz oa ob oc b">load_generator</code>方法，以便更快地进行后续预测。</p><p id="bd97" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nz oa ob oc b">st.cache</code> decorator 告诉 Streamlit，如果函数已经执行了，就跳过执行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><p id="c94a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个文件的入口点定义了 UI 的布局。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ol om l"/></div></figure><h1 id="179d" class="nl lw it bd lx nm on no ma np oo nr md jz op ka mg kc oq kd mj kf or kg mm nv bi translated">快速演示</h1><p id="db2b" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated">要启动应用程序，请运行<code class="fe nz oa ob oc b">streamlit run filepath.py</code>。如果你使用我的库，这将是<code class="fe nz oa ob oc b">streamlit run models/gpt_demo.py</code></p><p id="54e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该应用程序应该会在浏览器中自动启动。如果没有，就在<a class="ae ky" href="http://localhost:8501/" rel="noopener ugc nofollow" target="_blank"> http://localhost:8501/ </a>。加载生成器后，预测应该会快得多！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/692577ac3f0f636ed819c6f1dafee525.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i04VxsgyzWws1rN-ASe5Zg.png"/></div></div></figure><p id="f9db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我还没有使用过这个，但是如果你点击汉堡菜单(右上角的 3 条水平线)，有一个使用 Streamlit 录制你的演示的选项。相当整洁。</p><h1 id="02e1" class="nl lw it bd lx nm on no ma np oo nr md jz op ka mg kc oq kd mj kf or kg mm nv bi translated">让 GPT-2 完成一些想法！</h1><h2 id="e28a" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">我渴望…</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/bde289f42f7e39be0dbc5067718b78d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ImhiYwHs5TA4P72aoUoAA.png"/></div></div></figure><h2 id="5a6c" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">建造时间机器的秘密…</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/0a6397172c2fccb933e251436018dce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cwx6Ks8lYx7U8yKaq0HMBA.png"/></div></div></figure></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><p id="df05" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是你所拥有的——一个在 5 分钟内构建的漂亮的网络应用程序。</p><p id="bdbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有兴趣学习更多关于自然语言处理的知识，可以看看这个 Coursera 课程。</p><div class="ov ow gp gr ox oy"><a href="https://click.linksynergy.com/link?id=J2RDo*Rlzkk&amp;offerid=759505.11503135394&amp;type=2&amp;murl=https%3A%2F%2Fwww.coursera.org%2Flearn%2Flanguage-processing" rel="noopener  ugc nofollow" target="_blank"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd iu gy z fp pd fr fs pe fu fw is bi translated">自然语言处理</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">本课程涵盖了从基础到高级的自然语言处理的广泛任务:情感分析…</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">click.linksynergy.com</p></div></div><div class="ph l"><div class="pi l pj pk pl ph pm ks oy"/></div></div></a></div><h1 id="5bdc" class="nl lw it bd lx nm on no ma np oo nr md jz op ka mg kc oq kd mj kf or kg mm nv bi translated">感谢您的阅读！</h1><p id="23a3" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nw lk ll lm nx lo lp lq ny ls lt lu im bi translated"><a class="ae ky" href="https://medium.com/@mandygu" rel="noopener">通过 Medium </a>关注我的最新动态。😃</p><p id="cf11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一个业余爱好项目，我还在<a class="ae ky" href="http://www.dscrashcourse.com/" rel="noopener ugc nofollow" target="_blank">www.dscrashcourse.com</a>建立了一套全面的<strong class="lb iu">免费</strong>数据科学课程和练习题。</p><p id="8768" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">再次感谢您的阅读！📕</p></div></div>    
</body>
</html>