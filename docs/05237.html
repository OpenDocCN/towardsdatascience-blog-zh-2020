<html>
<head>
<title>Mixing Pytest Fixture and unittest.TestCase for Selenium Test</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">混合Pytest Fixture和unittest。硒测试的测试用例</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mixing-pytest-fixture-and-unittest-testcase-for-selenium-test-9162218e8c8e?source=collection_archive---------33-----------------------#2020-05-04">https://towardsdatascience.com/mixing-pytest-fixture-and-unittest-testcase-for-selenium-test-9162218e8c8e?source=collection_archive---------33-----------------------#2020-05-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="39ad" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">登录到一个网站，通过密码和测试无处不在</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/21749f04906fb43e5bdb90c6ebff0569.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*niqzkr1IOzfegXdB5FV1BQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Joshua Sortino 在<a class="ae ky" href="https://unsplash.com/s/photos/automation?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="4c21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我早期的文章<a class="ae ky" rel="noopener" target="_blank" href="/pass-arguments-to-selenium-test-functions-in-pytest-b6c76a320ecd">中，我介绍了使用pytest fixture来传递Selenium测试函数的参数。但是有一个问题。我们必须在每个测试函数中编写登录函数。但是我们想要的是一次登录，到处测试。</a></p><h1 id="e050" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">问题是</h1><p id="aa65" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果要测试<code class="fe ms mt mu mv b">play.py</code>中的几个函数，就要在每个测试函数中写登录函数。代码将变得非常多余，如下例所示。</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="1054" class="na lw it mv b gy nb nc l nd ne">def test_foo(params):<br/>    # login<br/>    driver = webdriver.Chrome()<br/>    ...<br/>    <br/>    # test foo function<br/>    ...</span><span id="8955" class="na lw it mv b gy nf nc l nd ne">def test_bar(params):<br/>    # login<br/>    driver = webdriver.Chrome()<br/>    ...<br/>    <br/>    # test bar function<br/>    ...</span></pre><p id="b88c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们想登录一次，到处测试，就像下面的例子。</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="2691" class="na lw it mv b gy nb nc l nd ne">class TestFtseLinks(TestCase):<br/>  def setUp(self):<br/>　　self.driver = webdriver.Chrome()<br/><br/>　def test_foo(self):<br/>　　self.driver.find('xxxxx')<br/>		<br/>　def test_bar(self):<br/>　　self.driver.find('xxx')</span></pre><p id="5501" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我以前的帖子中，我尝试混合使用unittest。TestCase和pytest fixture，但失败。</p><p id="e96e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不过，这次我来介绍一下解决方案。</p><h1 id="25ec" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">解决方法:在<code class="fe ms mt mu mv b">conftest.py</code>中写一个驱动类</h1><p id="0fc1" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">目录树:</p><pre class="kj kk kl km gt mw mv mx my aw mz bi"><span id="3088" class="na lw it mv b gy nb nc l nd ne">test<br/>├── conftest.py<br/>└── test_play.py</span></pre><p id="9aa9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe ms mt mu mv b">conftest.py</code>中，我们必须将每个选项编写为pytest.fixture函数。我们编写一个<code class="fe ms mt mu mv b">dirver_class</code>函数来登录我们的目标网站。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="233a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe ms mt mu mv b">test_play.py</code>中，我们可以直接用<code class="fe ms mt mu mv b">self.login.driver</code>驱动。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="798e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">测试输出:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="6d95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">查看我的其他帖子</strong> <a class="ae ky" href="https://medium.com/@bramblexu" rel="noopener"> <strong class="lb iu">中等</strong> </a> <strong class="lb iu">同</strong> <a class="ae ky" href="https://bramblexu.com/posts/eb7bd472/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">一分类查看</strong> </a> <strong class="lb iu">！<br/> GitHub: </strong> <a class="ae ky" href="https://github.com/BrambleXu" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">荆棘徐</strong> </a> <strong class="lb iu"> <br/>领英:</strong> <a class="ae ky" href="https://www.linkedin.com/in/xu-liang-99356891/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">徐亮</strong> </a> <strong class="lb iu"> <br/>博客:</strong><a class="ae ky" href="https://bramblexu.com" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"/></a></p><h1 id="113b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考</h1><ul class=""><li id="4117" class="ni nj it lb b lc mn lf mo li nk lm nl lq nm lu nn no np nq bi translated">使用标记<a class="ae ky" href="https://docs.pytest.org/en/latest/unittest.html#mixing-pytest-fixtures-into-unittest-testcase-subclasses-using-marks" rel="noopener ugc nofollow" target="_blank"> </a>将pytest夹具混合到<code class="fe ms mt mu mv b">unittest.TestCase</code>子类中</li><li id="dab6" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu nn no np nq bi translated"><a class="ae ky" href="https://stackoverflow.com/questions/54030132/how-to-use-pytest-to-pass-a-value-in-your-test-using-command-line-args" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/54030132/how-to-use-pytest-to-pass-a-value-in-your-test-using-command-line-args</a></li><li id="f532" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu nn no np nq bi translated"><a class="ae ky" href="https://stackoverflow.com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020#50135020" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/50132703/pytest-fixture-for-a-class-through-self-not-as-method-argument/50135020 # 50135020</a></li><li id="0938" class="ni nj it lb b lc nr lf ns li nt lm nu lq nv lu nn no np nq bi translated"><a class="ae ky" href="https://docs.pytest.org/en/latest/unittest.html#using-autouse-fixtures-and-accessing-other-fixtures" rel="noopener ugc nofollow" target="_blank">https://docs . pytest . org/en/latest/unittest . html # using-autouse-fixtures-and-access-other-fixtures</a></li></ul></div></div>    
</body>
</html>