<html>
<head>
<title>Getting Started with Graph Databases in Azure Cosmos DB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Azure Cosmos DB中的图形数据库入门</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/getting-started-with-graph-databases-in-azure-cosmos-db-cbfbf708cda5?source=collection_archive---------17-----------------------#2020-01-08">https://towardsdatascience.com/getting-started-with-graph-databases-in-azure-cosmos-db-cbfbf708cda5?source=collection_archive---------17-----------------------#2020-01-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="df37" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">野外的数据是高度关联的。我们可以开始连接这些部分，在Azure Cosmos DB中构建图形数据库。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/952dcb8ff79d2bb19024ffcf9540edc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/0*m_-npou0CN2PA2ji.jpg"/></div></figure><p id="a2d0" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在Azure Cosmos DB中，我们可以使用Gremlin API产品构建图形数据库。像数据世界中的许多新兴趋势一样，您可能会听到人们谈论图形数据库，并转动眼睛想“我们开始吧”。</p><p id="5f4c" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">但是有很多情况我们可以用图形格式来建模。你可能遇到的最明显的例子是社交网络。我认识迈克，他认识珍玛，我们都喜欢徒步旅行。珍玛去了新西兰的拉格伦徒步旅行，我住在新西兰，等等。等等。(我们将一点点构建这个例子的基础！).</p><p id="37a8" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">以传统的关系方式对这些关系建模可能很有挑战性，所以使用图形数据模型会很好，但是什么是图形数据库，我们能使用Azure Cosmos DB构建一个图形数据库吗？</p><p id="a9a8" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">本文的目的只是介绍什么是基本的图形数据库，然后向您展示如何使用Azure Cosmos DB中的Gremlin API构建图形数据库。</p><p id="f5ac" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">那么什么是图数据库？</strong></p><p id="4e6d" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">图是由顶点和边组成的结构，这些顶点和边可以有许多属性。</p><p id="b53f" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">顶点或节点</strong>代表物体。在我们的图数据库中，我们可以通过识别用例中的实体来确定图中的节点。记住这一点，我们的节点可以表示如下实体:</p><ul class=""><li id="562a" class="lj lk iq kp b kq kr kt ku kw ll la lm le ln li lo lp lq lr bi translated">一个顾客</li><li id="e0b9" class="lj lk iq kp b kq ls kt lt kw lu la lv le lw li lo lp lq lr bi translated">一名雇员</li><li id="bdc0" class="lj lk iq kp b kq ls kt lt kw lu la lv le lw li lo lp lq lr bi translated">一种产品</li><li id="473c" class="lj lk iq kp b kq ls kt lt kw lu la lv le lw li lo lp lq lr bi translated">订单</li></ul><p id="7f27" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">边</strong>是顶点或边之间的关系。例如，一个人可能认识另一个人，或者那个人可能去过一个地方。</p><p id="8ee9" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">属性</strong>描述关于顶点和边的信息。例如，顶点中的属性可能包括关于人的信息，如他们的姓名、年龄或头发颜色。在edges中，这可能包括关于这两个人如何认识彼此的信息。</p><p id="4c69" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这个数据模型也可以被称为属性图模型，这是Azure Cosmos DB所支持的</p><p id="b527" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们通常将图形数据库实现为NoSQL存储，因为我们需要无模式数据存储所提供的灵活性。这也可以为我们提供一个数据模型，我们可以快速地改变它，对使用它的应用程序产生最小的影响。</p><p id="8c13" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">即使数据库中的数据在增长，图形数据库也能为我们提供高性能水平。即使我们的关系变得越来越复杂，我们仍然可以从数据库中获得高水平的性能。</p><p id="5333" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在关系数据库中，一旦我们的关系变得更加复杂，我们的查询性能就会下降。</p><p id="89eb" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">正如我前面提到的，我们可以向图形数据库添加更多的关系和数据，而不会对我们的功能产生巨大影响。</p><p id="08a3" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">然而，如果我们的应用程序中需要处理大量的事务，那么我们的图形数据库就会受到影响。</p><p id="b939" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">好的，我可以用图形数据库做什么？</p><p id="e491" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">有几个我们可以部署图形数据库的用例。由于我目前在一家银行工作，我已经了解了如何部署图形数据库来进行欺诈分析。</p><p id="2453" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">构建推荐引擎和社交网络也是我们可以使用图形数据库的好时机。在这些情况下，我们可以使用图表来推断基于用户进行的或之前进行的交互和活动的关系。</p><p id="5989" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们可以使用图形数据库的另一个很酷的例子是用于主数据管理。我们可以使用图表来查看我们组织内的数据是如何连接的，什么类型的用户查询它，等等。</p><p id="2ede" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">为什么要用Cosmos DB建立图形数据库？</strong></p><p id="a3c4" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们可以在自己的电脑上运行图形数据库。没有理由不下载Apache Tinkerpop，在Gremlin控制台上运行一些命令，就可以拥有自己的图形数据库。</p><p id="f7cc" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">但是，生产中的图形数据库是一个庞大的系统。生产中的大型图形数据库会有数十亿的顶点和边，所以我们在自己的计算机上运行这些是不切实际的。</p><p id="92d5" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这就是Cosmos DB可以帮助我们的地方。由于Gremlin API的提供，我们可以在Azure Cosmos DB中构建图形数据库。这为我们在云中提供了一个完全托管的图形数据库，它可以在存储和吞吐量方面弹性增长。</p><p id="adc4" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">在Cosmos DB中创建图形数据库</strong></p><p id="da7c" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">让我们继续使用Cosmos DB构建一个图形数据库。转到Azure门户并单击创建新资源。在数据库下，单击Azure Cosmos DB。</p><p id="0092" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">现在我们必须配置它。我们给它一个名字，把它放在一个资源组和一个离我们很近的位置。这里最重要的事情是确保选择<strong class="kp ir"> Gremlin (graph) </strong>选项作为API</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi lx"><img src="../Images/8bbb7bb2a1958e62b596e0f0783e48b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i6SianlPx2e9ZSG-tumy9Q.png"/></div></div></figure><p id="f0d6" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">等待几分钟，我们将准备好我们的带有Gremlin API的Cosmos DB帐户。让我们创建第一个图形数据库，并向其中添加一个图形，这样我们就可以在其中执行一些查询。</p><p id="42cc" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">当您的帐户设置完成后，您将进入概述页面。单击“添加图形”来设置您的第一个图形数据库。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mc"><img src="../Images/f483a293563a518f7a92777f0917e861.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UzuzbE_jPLX7WaC_WtwasQ.png"/></div></div></figure><p id="5edf" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在本教程中，我将创建一个基本图表，我已经创建了一个名为PeopleDB的数据库，向其中添加了一个名为PeopleGraph的图表，并提供了一个分区键调用hobby，其中包含了我们的爱好值。我将把最大RU值保持在400，因为在本教程中我们不会做任何大的操作。单击“确定”进行设置。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi md"><img src="../Images/03526df6ee2f221736852932b325df42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*cVkYCV3MiCmeKe8WIiaa6g.png"/></div></figure><p id="d6d7" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">在Cosmos中运行一些查询</strong></p><p id="8427" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">现在我们已经建立了我们的图表，让我们建立我前面提到的人员场景。为此，我们将在图表中添加一些代表人物的顶点。他们都有自己的名字、姓氏、年龄、爱好、来自哪里和住在哪里的属性。</p><p id="896c" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们可以通过运行以下查询来添加这些顶点:</p><pre class="kg kh ki kj gt me mf mg mh aw mi bi"><span id="a61e" class="mj mk iq mf b gy ml mm l mn mo">// Add Will<br/>g.addV('person').property('firstName', 'Will').property('lastName', 'Velida').property('age', 28).property('userid', 1).property('hobby', 'kayaking').property('from', 'UK').property('lives', 'NZ')</span><span id="1f7b" class="mj mk iq mf b gy mp mm l mn mo">// Add Gemma<br/>g.addV('person').property('firstName', 'Gemma').property('lastName', 'Wright').property('age', 30).property('userid', 2).property('hobby', 'hiking').property('from', 'NZ').property('lives', 'NZ')</span><span id="8c4a" class="mj mk iq mf b gy mp mm l mn mo">// Add Mike<br/>g.addV('person').property('firstName', 'Mike').property('lastName', 'Smith').property('age', 30).property('userid', 3).property('hobby', 'kayaking').property('from', 'NZ').property('lives', 'NZ')</span><span id="9ba0" class="mj mk iq mf b gy mp mm l mn mo">// Add Sloan<br/>g.addV('person').property('firstName', 'Sloan').property('lastName', 'Timms').property('age', 21).property('userid', 4).property('hobby', 'kayaking').property('from', 'UK').property('lives', 'NZ')</span></pre><p id="eac8" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">现在我们可以添加一些边来表示People应用程序中顶点之间的关系。</p><pre class="kg kh ki kj gt me mf mg mh aw mi bi"><span id="f9f0" class="mj mk iq mf b gy ml mm l mn mo">// Will Knows Gemma<br/>g.V().hasLabel('person').has('firstName', 'Will').addE('knows').to(g.V().hasLabel('person').has('firstName', 'Gemma'))</span><span id="8055" class="mj mk iq mf b gy mp mm l mn mo">// Sloan Knows Will<br/>g.V().hasLabel('person').has('firstName', 'Sloan').addE('knows').to(g.V().hasLabel('person').has('firstName', 'Will'))</span><span id="07b9" class="mj mk iq mf b gy mp mm l mn mo">// Mike Knows Gemma<br/>g.V().hasLabel('person').has('firstName', 'Will').addE('knows').to(g.V().hasLabel('person').has('firstName', 'Gemma'))</span></pre><p id="09c1" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">现在我们已经添加了所有内容，我们可以运行一些简单的查询。让我们运行一个查询，返回图形数据库中所有爱好皮划艇的人。</p><pre class="kg kh ki kj gt me mf mg mh aw mi bi"><span id="6309" class="mj mk iq mf b gy ml mm l mn mo">// Select everyone who kayaks as a hobby<br/>g.V().hasLabel('person').has('hobby', 'kayaking')</span></pre><p id="27a3" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们看到返回的结果如下图所示。我们的查询返回了三个人，我们可以单击每个节点来查看他们的属性。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi md"><img src="../Images/c90b25c1ed31957504ec6d03a1ac8b9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*FFaczROJ284u_jlltpDN2A.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mq"><img src="../Images/b2a4931eb448fea6cd0a554b139d9601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qZJjwDcv1TD5ed0tID6FMw.png"/></div></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">威尔结</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mv"><img src="../Images/196ced5cad89f990b7c6ddecccb06222.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D6U2mXb1skmTb_ahh6vckA.png"/></div></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">迈克结节</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mq"><img src="../Images/cc4d61ffe779cfb4a09fec721ee61907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9YjiMgunPpz38GmrtK9L-A.png"/></div></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">斯隆氏结</p></figure><p id="b226" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">总之</strong></p><p id="5742" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这是一个非常基本的例子，只是向您介绍图形数据库以及如何使用Azure Cosmos DB构建它们。在以后的博文中，我将更深入地探讨如何运行Gremlin查询，并将它们与SQL查询进行比较。</p><p id="e3d8" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">如有疑问，欢迎在下方随意评论！</p></div></div>    
</body>
</html>