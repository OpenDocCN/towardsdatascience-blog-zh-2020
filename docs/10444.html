<html>
<head>
<title>Vectorize everything with Julia</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向量化朱莉娅的一切</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/vectorize-everything-with-julia-ad04a1696944?source=collection_archive---------21-----------------------#2020-07-22">https://towardsdatascience.com/vectorize-everything-with-julia-ad04a1696944?source=collection_archive---------21-----------------------#2020-07-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7f53" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">告别 for loops，广播所有的东西</h2></div><p id="8cf7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你有没有过这样的感觉:for loops 正在接管你的生活，你无法逃离它们？你是否觉得被这些循环困住了？别害怕！有出路！我将向你展示如何在没有任何 for 循环的情况下完成 FizzBuzz 挑战<strong class="kk iu">。</strong></p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="lj lk l"/></div><p class="ll lm gj gh gi ln lo bd b be z dk translated">向量化所有的东西！— <a class="ae lp" href="https://giphy.com/gifs/dancing-despicable-me-J2vqNbXJkGrx6" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><blockquote class="lq lr ls"><p id="8d6d" class="ki kj lt kk b kl km ju kn ko kp jx kq lu ks kt ku lv kw kx ky lw la lb lc ld im bi translated">FizzBuzz 的任务是打印 100 以内的每一个数字，但是要把能被 3 整除的数字换成“Fizz”，能被 5 整除的数字换成“Buzz”，能被 3 和 5 都整除的数字要换成“FizzBuzz”。</p></blockquote><p id="5e8b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用 for 循环解决<a class="ae lp" rel="noopener" target="_blank" href="/learning-julia-the-simplest-of-beginnings-464f590e5665"> FizzBuzz 很容易</a>，你甚至可以在 BigQuery 中做这件事<a class="ae lp" rel="noopener" target="_blank" href="/loops-in-bigquery-db137e128d2d">。在这里，我将向您展示另一种实现方式——没有任何 for 循环。解决方案是<strong class="kk iu">矢量化函数</strong>。</a></p><p id="0315" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你已经有了一些 R 和 Python 的经验，你可能已经在标准 R 中或者通过 Python 的<code class="fe lx ly lz ma b">numpy</code>库遇到了矢量化函数。让我们看看如何在 Julia 中类似地使用它们。</p><blockquote class="mb"><p id="ed2a" class="mc md it bd me mf mg mh mi mj mk ld dk translated">矢量化函数非常有用，因为它们减少了与 for 循环相关的混乱。</p></blockquote><h1 id="0e33" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz mw ka mx kc my kd mz kf na kg nb nc bi translated">矢量化函数的第一步</h1><p id="8309" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">在我们开始解决 FizzBuzz 之前，让我们看看如何在 Julia 中用矢量化替代方法替换非常简单的 for 循环。</p><p id="8198" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们从一个琐碎的任务开始:<em class="lt">给定一个向量</em> <code class="fe lx ly lz ma b"><em class="lt">a</em></code> <em class="lt">给它的每个元素加 1。</em></p><h2 id="6323" class="ni mm it bd mn nj nk dn mr nl nm dp mv kr nn no mx kv np nq mz kz nr ns nb nt bi translated">对于循环版本:</h2><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nu lk l"/></div></figure><pre class="le lf lg lh gt nv ma nw nx aw ny bi"><span id="8c3e" class="ni mm it ma b gy nz oa l ob oc">julia&gt; print(a)</span><span id="b2d7" class="ni mm it ma b gy od oa l ob oc">[2, 3, 4]</span></pre><h2 id="7ab7" class="ni mm it bd mn nj nk dn mr nl nm dp mv kr nn no mx kv np nq mz kz nr ns nb nt bi translated">矢量化版本:</h2><p id="5761" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">上面的代码完成了工作，但是它占用了 3 行代码和很多多余的字符。如果<code class="fe lx ly lz ma b">a</code>是 Python 中的一个<code class="fe lx ly lz ma b">numpy</code>数组🐍，你只需要做<code class="fe lx ly lz ma b">a + 1</code>，工作就完成了。但是首先，您必须将您的普通旧数组转换成一个<code class="fe lx ly lz ma b">numpy</code>数组。</p><p id="e37c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">朱莉娅有一个聪明的解决办法。您可以使用广播操作符<code class="fe lx ly lz ma b">.</code>对一个对象的所有元素应用一个操作——在本例中是加法。这就是它的作用:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nu lk l"/></div><p class="ll lm gj gh gi ln lo bd b be z dk translated">这与上面的 for 循环给出了相同的答案。并且不需要转换你的数组。</p></figure><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="oe lk l"/></div><p class="ll lm gj gh gi ln lo bd b be z dk translated"><a class="ae lp" href="https://giphy.com/gifs/LxPsfUhFxwRRC" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="3b01" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更棒的是，<strong class="kk iu">你可以播放任何你喜欢的功能</strong>，甚至是你自己的。在这里，我们计算一个圆的面积，然后在我们的阵列中传播它:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nu lk l"/></div><p class="ll lm gj gh gi ln lo bd b be z dk translated">是的，pi 是 Julia 中的内置常量！</p></figure><pre class="le lf lg lh gt nv ma nw nx aw ny bi"><span id="b941" class="ni mm it ma b gy nz oa l ob oc">julia&gt; area_of_circle.(a)</span><span id="8be9" class="ni mm it ma b gy od oa l ob oc">3-element Array{Float64,1}:<br/>  3.141592653589793<br/> 12.566370614359172<br/> 28.274333882308138</span></pre><h1 id="b790" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz of ka mx kc og kd mz kf oh kg nb nc bi translated">循环再见</h1><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="gh gi oi"><img src="../Images/cc309bb3008a116e473c716598442473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_lrIAdWrDwbhirsqllVBEw.jpeg"/></div></div><p class="ll lm gj gh gi ln lo bd b be z dk translated">回环拜拜！— <a class="ae lp" href="https://www.pxfuel.com/en/free-photo-jalfs" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="e9b7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们知道了基本知识，让我们做 FizzBuzz 吧！但是记住，不允许 for 循环。</p><p id="78ee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将稍微重新表述一下我们的问题。代替打印数字、嘶嘶声和嗡嗡声，我们将把它们作为一个向量一起返回。我将以与 for 循环文章[链接]中相同的方式分解解决方案，因此如果您还没有看到以前的帖子，现在将是查看它的好时机！</p><p id="daa0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，让<strong class="kk iu">返回数字</strong>直到<code class="fe lx ly lz ma b">n</code>作为一个向量:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nu lk l"/></div><p class="ll lm gj gh gi ln lo bd b be z dk translated">在这里，collect 只是接受我们的 range 操作符，并对它进行数组求值。</p></figure><pre class="le lf lg lh gt nv ma nw nx aw ny bi"><span id="5005" class="ni mm it ma b gy nz oa l ob oc">julia&gt; fizzbuzz(5)</span><span id="4fad" class="ni mm it ma b gy od oa l ob oc">5-element Array{Int64,1}:<br/> 1<br/> 2<br/> 3<br/> 4<br/> 5</span></pre><h2 id="5690" class="ni mm it bd mn nj nk dn mr nl nm dp mv kr nn no mx kv np nq mz kz nr ns nb nt bi translated">添加气泡</h2><p id="f7e9" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">这个管用。让我们看看能否打印出每个能被 3 整除的数字的嘶嘶声。我们可以用 Fizz 字符串替换所有能被 3 整除的数字。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nu lk l"/></div></figure><pre class="le lf lg lh gt nv ma nw nx aw ny bi"><span id="9239" class="ni mm it ma b gy nz oa l ob oc">julia&gt; fizzbuzz(7)</span><span id="9461" class="ni mm it ma b gy od oa l ob oc">7-element Array{String,1}:<br/> "1"<br/> "2"<br/> "Fizz"<br/> "4"<br/> "5"<br/> "Fizz"<br/> "7"</span></pre><p id="8f19" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们一步一步地分解它:</p><ul class=""><li id="2354" class="op oq it kk b kl km ko kp kr or kv os kz ot ld ou ov ow ox bi translated">为什么我们把所有东西都换成了<code class="fe lx ly lz ma b">string</code>？这个数组就是一个数组。我们不希望数字和字符串混杂在一个对象中。</li><li id="2af0" class="op oq it kk b kl oy ko oz kr pa kv pb kz pc ld ou ov ow ox bi translated">我们广播<code class="fe lx ly lz ma b">rem.(numbers, 3</code>来寻找所有数字的余数<strong class="kk iu">。</strong></li><li id="c9ed" class="op oq it kk b kl oy ko oz kr pa kv pb kz pc ld ou ov ow ox bi translated">然后我们将这个余数数组<strong class="kk iu">与 0 </strong> ( <code class="fe lx ly lz ma b">.== 0</code>)进行元素比较。</li><li id="b0de" class="op oq it kk b kl oy ko oz kr pa kv pb kz pc ld ou ov ow ox bi translated">最后，我们<strong class="kk iu">用布尔掩码</strong>索引我们的字符串数组，并将“Fizz”赋给掩码为<code class="fe lx ly lz ma b">true</code>的每个元素。</li></ul><blockquote class="lq lr ls"><p id="b4c7" class="ki kj lt kk b kl km ju kn ko kp jx kq lu ks kt ku lv kw kx ky lw la lb lc ld im bi translated">请随意分解这些步骤，在你自己的朱莉娅·REPL 身上试试吧！</p></blockquote><p id="0ad7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我知道使用<code class="fe lx ly lz ma b">.=</code>将单个元素分配给多个元素可能有点争议，但我实际上很喜欢它。通过<strong class="kk iu">显式地指定赋值</strong>的广播，你强迫自己去思考这些对象的区别，然后每个阅读你的代码的人<strong class="kk iu">将会看到一个是向量，另一个是标量</strong>。</p><h2 id="cfa3" class="ni mm it bd mn nj nk dn mr nl nm dp mv kr nn no mx kv np nq mz kz nr ns nb nt bi translated">添加蜂鸣器</h2><p id="7760" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">添加蜂鸣器的方法完全相同:</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nu lk l"/></div></figure><p id="cfd7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对此不予置评。😃</p><h2 id="b680" class="ni mm it bd mn nj nk dn mr nl nm dp mv kr nn no mx kv np nq mz kz nr ns nb nt bi translated">将这一切结合在一起</h2><p id="11ff" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">我们所缺少的是能被 3 和 5 整除的数字的嘶嘶声元素。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nu lk l"/></div></figure><p id="5030" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用<code class="fe lx ly lz ma b">.*</code>来“乘”两个布尔数组。在这种情况下，您可以将*视为布尔值<code class="fe lx ly lz ma b">and</code>。所以这个<strong class="kk iu">给了我们一个真值，其中的数字可以被 3 和 5 整除。</strong></p><p id="7296" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看这一切是否行得通:</p><pre class="le lf lg lh gt nv ma nw nx aw ny bi"><span id="96fa" class="ni mm it ma b gy nz oa l ob oc">julia&gt; fizzbuzz(16)</span><span id="03f1" class="ni mm it ma b gy od oa l ob oc">16-element Array{String,1}:<br/> "1"<br/> "2"<br/> "Fizz"<br/> "4"<br/> "Buzz"<br/> "Fizz"<br/> "7"<br/> "8"<br/> "Fizz"<br/> "Buzz"<br/> "11"<br/> "Fizz"<br/> "13"<br/> "14"<br/> "FizzBuzz"<br/> "16"</span></pre><h1 id="eca6" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz of ka mx kc og kd mz kf oh kg nb nc bi translated">该打扫了</h1><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="oj ok di ol bf om"><div class="gh gi pd"><img src="../Images/bd56f493135d71da4a1b27fb8ec89c83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P-QrV6vd-rizvGaAX0lJVg.jpeg"/></div></div><p class="ll lm gj gh gi ln lo bd b be z dk translated">稍微无关，但请永远清理你的狗了！—照片由<a class="ae lp" href="https://unsplash.com/@harryjamesgrout?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">哈里·格劳特</a>在<a class="ae lp" href="https://unsplash.com/s/photos/tidy?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="8f48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以上当然是我们想要的，但它并不是最漂亮的。是时候整理和<strong class="kk iu">让我们的代码变得漂亮和像样了</strong>。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="nu lk l"/></div></figure><p id="0ff0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这与上面的实现完全一样，但是它更容易阅读。我们找到想要替换的索引，然后在需要的地方替换数组元素。我们还使用了<code class="fe lx ly lz ma b">%</code>而不是<code class="fe lx ly lz ma b">rem</code>函数，因为<strong class="kk iu">如果你的函数有一个操作符，那么你应该使用它！</strong></p><h1 id="154d" class="ml mm it bd mn mo mp mq mr ms mt mu mv jz of ka mx kc og kd mz kf oh kg nb nc bi translated">结论</h1><p id="c50e" class="pw-post-body-paragraph ki kj it kk b kl nd ju kn ko ne jx kq kr nf kt ku kv ng kx ky kz nh lb lc ld im bi translated">读完这篇文章后，你现在知道如何使用<code class="fe lx ly lz ma b">.</code>在 Julia 中传播任何函数，并通过删除一些不必要的 for 循环使你的代码更具可读性。</p><blockquote class="mb"><p id="742f" class="mc md it bd me mf mg mh mi mj mk ld dk translated">要获得所有媒体文章的完整访问权限，包括我的文章，请考虑在此订阅<a class="ae lp" href="https://niczky12.medium.com/membership" rel="noopener"/>。</p></blockquote></div><div class="ab cl pe pf hx pg" role="separator"><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj pk"/><span class="ph bw bk pi pj"/></div><div class="im in io ip iq"><div class="le lf lg lh gt pl"><a rel="noopener follow" target="_blank" href="/learning-julia-the-simplest-of-beginnings-464f590e5665"><div class="pm ab fo"><div class="pn ab po cl cj pp"><h2 class="bd iu gy z fp pq fr fs pr fu fw is bi translated">学习朱莉娅——最简单的开始</h2><div class="ps l"><h3 class="bd b gy z fp pq fr fs pr fu fw dk translated">如何使用 FizzBuzz 执行循环和条件函数</h3></div><div class="pt l"><p class="bd b dl z fp pq fr fs pr fu fw dk translated">towardsdatascience.com</p></div></div><div class="pu l"><div class="pv l pw px py pu pz on pl"/></div></div></a></div><div class="qa qb gp gr qc pl"><a rel="noopener follow" target="_blank" href="/loops-in-bigquery-db137e128d2d"><div class="pm ab fo"><div class="pn ab po cl cj pp"><h2 class="bd iu gy z fp pq fr fs pr fu fw is bi translated">BigQuery 中的循环</h2><div class="ps l"><h3 class="bd b gy z fp pq fr fs pr fu fw dk translated">了解如何使用 BigQuery 脚本来计算斐波那契数</h3></div><div class="pt l"><p class="bd b dl z fp pq fr fs pr fu fw dk translated">towardsdatascience.com</p></div></div><div class="pu l"><div class="qd l pw px py pu pz on pl"/></div></div></a></div></div></div>    
</body>
</html>