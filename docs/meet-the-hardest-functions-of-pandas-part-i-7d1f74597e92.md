# è®¤è¯†ç†ŠçŒ«æœ€éš¾çš„åŠŸèƒ½ï¼Œç¬¬ä¸€éƒ¨åˆ†

> åŸæ–‡ï¼š<https://towardsdatascience.com/meet-the-hardest-functions-of-pandas-part-i-7d1f74597e92?source=collection_archive---------15----------------------->

## ç”¨ç†ŠçŒ«é‡å¡‘æ•°æ®æ¡†

## æŒæ¡`pivot_table()`ã€`stack()`ã€`unstack()`çš„æ—¶é—´å’Œæ–¹å¼

![](img/12686deb8b8c7e8ba5f930fcc0abc75e.png)

æ¥è‡ª [Pexels](https://www.pexels.com/photo/fitness-power-man-person-17840/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels) çš„ [Binyamin Mellish](https://www.pexels.com/@binyaminmellish?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels) ç…§ç‰‡

## ä»‹ç»

ä¸‹é¢æ˜¯æœ€ç³Ÿç³•çš„æƒ…å†µ:ä½ åœ¨çœ‹ä»˜è´¹è¯¾ç¨‹ï¼Œè®²å¸ˆåœ¨è®²æŸä¸ªè¯é¢˜ã€‚ç„¶åï¼Œçªç„¶ï¼Œä»–å¼•å…¥äº†ä¸€ä¸ªå…¨æ–°çš„å‡½æ•°ï¼Œè¯´â€œè¿™ä¸ªå‡½æ•°/æ–¹æ³•åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯å®Œç¾çš„ï¼Œå®ƒéå¸¸ç®€å•ï¼Œæ‰€ä»¥åªéœ€æŸ¥çœ‹å…¶æ–‡æ¡£ä»¥äº†è§£æ›´å¤šç»†èŠ‚â€ã€‚ä½ è¯´ OKï¼Œå»æ–‡æ¡£ï¼Œè¿è‡ªå·±åœ¨çœ‹ä»€ä¹ˆéƒ½ä¸çŸ¥é“ã€‚

ä½ æ„Ÿåˆ°æ²®ä¸§ï¼Œå»è¯»ä¸€äº›æ–‡ç« æˆ– StackOverflow çº¿ç¨‹ï¼Œæœ‰æ—¶å›æ¥æ—¶æ„Ÿè§‰æ›´ç³Ÿã€‚ç›¸ä¿¡æˆ‘ï¼Œæ¯ä¸ªäººéƒ½ä¼šè¿™æ ·ã€‚è¿™ç¯‡æ–‡ç« ä¸“é—¨è®¨è®ºç¡¬`pandas`å‡½æ•°çš„æƒ…å†µã€‚

å¤§å¤šæ•°èµ„æ–™æ²¡æœ‰æ¶µç›–`pandas`çš„ä¸€äº›é«˜çº§åŠŸèƒ½çš„åŸå› ä¸»è¦æ˜¯å®ƒä»¬éå¸¸å…·ä½“ã€‚å½“æ‚¨å­¦ä¹ åŸºæœ¬çš„æ–¹æ³•å’Œå‡½æ•°æ—¶ï¼Œæ‚¨å°†åœ¨å®ƒä»¬è‡ªå·±çš„ä¸Šä¸‹æ–‡ä¸­å­¦ä¹ å®ƒä»¬ï¼Œå°±åƒåœ¨ç©å…·æ•°æ®é›†ä¸Šä¸€æ ·ã€‚å¯¹äºè¾ƒéš¾çš„å‡½æ•°ï¼Œå®ƒä»¬å¾ˆéš¾è§£é‡Šï¼Œå¹¶ä¸”å¾ˆéš¾åˆ›å»ºå®ƒä»¬æœ‰ç”¨çš„ä¸Šä¸‹æ–‡ã€‚

è¿™ç§åŠŸèƒ½é€šå¸¸åœ¨æ›´æœ‰ç»éªŒçš„ç§‘å­¦å®¶çš„å·¥å…·ç®±ä¸­ã€‚å½“ä½ ä»¥è¿™æ ·çš„æ–¹å¼ä½¿ç”¨å®ƒä»¬æ—¶ï¼Œå®ƒä»¬ä¼šäº§ç”Ÿä¸åŒï¼Œå‡½æ•°ç”¨ä¸€è¡Œä»£ç å¾ˆä¼˜é›…åœ°è§£å†³äº†ä½ é‡åˆ°çš„é—®é¢˜ã€‚è¿™ä¸ªå¸–å­è®²çš„å°±æ˜¯ä»–ä»¬ä¸‰ä¸ª:`pivot_table()`ã€`stack()`å’Œ`unstack()`ã€‚

[](https://ibexorigin.medium.com/membership) [## é€šè¿‡æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥ Medium-BEXGBoost

### è·å¾—ç‹¬å®¶è®¿é—®æˆ‘çš„æ‰€æœ‰âš¡premiumâš¡å†…å®¹å’Œæ‰€æœ‰åª’ä½“æ²¡æœ‰é™åˆ¶ã€‚æ”¯æŒæˆ‘çš„å·¥ä½œï¼Œç»™æˆ‘ä¹°ä¸€ä¸ªâ€¦

ibexorigin.medium.com](https://ibexorigin.medium.com/membership) 

è·å¾—ç”±å¼ºå¤§çš„ AI-Alpha ä¿¡å·é€‰æ‹©å’Œæ€»ç»“çš„æœ€ä½³å’Œæœ€æ–°çš„ ML å’Œ AI è®ºæ–‡:

[](https://alphasignal.ai/?referrer=Bex) [## é˜¿å°”æ³•ä¿¡å·|æœºå™¨å­¦ä¹ çš„æå“ã€‚è‰¾æ€»ç»“çš„ã€‚

### ç•™åœ¨å¾ªç¯ä¸­ï¼Œä¸ç”¨èŠ±æ— æ•°æ—¶é—´æµè§ˆä¸‹ä¸€ä¸ªçªç ´ï¼›æˆ‘ä»¬çš„ç®—æ³•è¯†åˆ«â€¦

alphasignal.ai](https://alphasignal.ai/?referrer=Bex) 

## å¯ç‚¹å‡»çš„ç›®å½•(ä»…é™ç½‘ç»œ)

1.[ç®€ä»‹](#9b70)
2ã€‚[è®¾ç½®](#dce4)
3ã€‚ [Pandas pivot_table()ï¼Œä¸ groupby()](#af38)
4 æ¯”è¾ƒã€‚[ç†ŠçŒ«æ ˆ()](#cc49)
5ã€‚[ç†ŠçŒ«è§£æ•£()](#40fd)

> æ¯ä¸ªå‡½æ•°ç¬¬ä¸€æ¬¡å‡ºç°æ—¶ï¼Œæˆ‘éƒ½ç»™å®ƒä»¬çš„æ–‡æ¡£åŠ äº†è¶…é“¾æ¥ã€‚è¯·æŸ¥çœ‹æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚

## è®¾ç½®

## Pandas pivot_table()ï¼Œä¸ groupby()æ¯”è¾ƒ

> åº”è¯¥æœ‰ä¸€ç§â€”â€”æœ€å¥½åªæœ‰ä¸€ç§â€”â€”æ˜¾è€Œæ˜“è§çš„æ–¹æ³•æ¥åšè¿™ä»¶äº‹ã€‚

ä»¥ä¸Šæ˜¯å¼•ç”¨ python çš„ç¦…å®—ã€‚Python å¸Œæœ›ä¸€ä¸ªé—®é¢˜åªæœ‰ä¸€ä¸ªæ˜æ˜¾çš„è§£å†³æ–¹æ¡ˆã€‚ä½†æ˜¯ï¼Œ`pandas`åˆ»æ„å›é¿äº†è¿™ä¸€ç‚¹ã€‚å¾€å¾€åœ¨`pandas`ä¸­ï¼Œä¸€ä¸ªæ“ä½œæœ‰å‡ ç§æ–¹å¼ã€‚

`[pivot_table()](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html)`å°±æ˜¯ä¸€ä¸ªä¾‹å­ã€‚å®ƒæ˜¯`groupby()`åŠŸèƒ½çš„å®Œæ•´æ›¿ä»£ï¼Œæœ‰æ—¶ç”šè‡³æ˜¯æ›´å¥½çš„æ›¿ä»£ã€‚ä¸åŒçš„æ˜¯ç»“æœçš„å½¢çŠ¶ã€‚`groupby()`è¿”å›ä¸€ä¸ª`Series`å¯¹è±¡ï¼Œè€Œ`pivot_table()`ç»™å‡ºä¸€ä¸ªæ˜“äºæ“ä½œçš„æ•°æ®æ¡†æ¶ã€‚

è®©æˆ‘ä»¬ç”¨è¿™ä¸¤ä¸ªå‡½æ•°æ¥è§£å†³ä¸€ä¸ªé—®é¢˜å¹¶ç»™å‡ºè§£å†³æ–¹æ¡ˆã€‚æˆ‘å°†ä»`seaborn`åŠ è½½`tips`æ•°æ®é›†:

```
tips = sns.load_dataset('tips')
tips.head()
```

![](img/320eb196e8ed6ba04f33062abbcc94de.png)

æˆ‘ä»¬æƒ³æ‰¾å‡ºæ¯ä¸ªæ€§åˆ«æ‰€æœ‰è´¦å•çš„æ€»å’Œ:

![](img/b3bec063f4d445af5e9777c2bb1f903b.png)

è®©æˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹è¿™ä¸¤ä¸ªå‡½æ•°çš„è¯­æ³•ã€‚åœ¨`groupby()`ä¸­ï¼Œæˆ‘ä»¬å°†æƒ³è¦åˆ†ç»„çš„åˆ—æ”¾åœ¨æ‹¬å·ä¸­ï¼Œåœ¨`pivot_table()`ä¸­ï¼Œç­‰ä»·çš„å‚æ•°æ˜¯`index`ã€‚åœ¨`groupby()`ä¸­ï¼Œä¸ºäº†é€‰æ‹©è¦èšåˆçš„åˆ—ï¼Œæˆ‘ä»¬ä½¿ç”¨å¸¦æ‹¬å·çš„å­é›†ï¼Œè€Œåœ¨`pivot_table()`ä¸­ï¼Œæˆ‘ä»¬å°†å…¶ä¼ é€’ç»™`values`ã€‚æœ€åï¼Œä¸ºäº†é€‰æ‹©èšåˆå‡½æ•°ï¼Œæˆ‘ä»¬åœ¨`groupby()`ä¸­ä½¿ç”¨æ–¹æ³•é“¾æ¥ï¼Œè€Œ`pivot_table()`æä¾›äº†`aggfunc`å‚æ•°ã€‚

å½“æˆ‘å†™ä¸€ç¯‡å…³äº DS å’Œ ML çš„é¡¹ç›®è®¾ç½®çš„æ–‡ç« æ—¶ï¼Œæˆ‘ç ”ç©¶äº†å¾ˆå¤šç¬”è®°æœ¬ã€‚æˆ‘å‘ç°ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œè®¸å¤šäººä½¿ç”¨`groupby()`å¹¶ä½¿ç”¨`.reset_index()`å‡½æ•°å°†`groupby()`çš„ç»“æœè½¬åŒ–ä¸ºæ•°æ®å¸§ï¼Œè®©æˆ‘ä»¬è¿›ä¸€æ­¥æ¢ç´¢ä»¥æ‰¾å‡ºåŸå› :

```
result = tips.groupby('sex')['total_bill'].sum().reset_index()
result
```

![](img/cfc13b39da146eaf57a9f5e0f23d5f25.png)

å¦‚æœä½ ä½¿ç”¨`pivot_table()`ï¼Œä½ ä¸å¿…ä½¿ç”¨`reset_index()`å°†ç»“æœè½¬æ¢æˆæ•°æ®å¸§ã€‚`groupby()`ç»“æœä¸åƒæ•°æ®å¸§é‚£æ ·å®¹æ˜“å¤„ç†ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•æŒ‰å¤šåˆ—åˆ†ç»„å’Œç”¨å¤šä¸ªå‡½æ•°èšåˆ:

```
tips.groupby(['sex', 'day'])['total_bill']\
            .agg([np.mean, np.median, np.sum]).reset_index()
```

![](img/c0e1c2bd2fa2fd94adefdc182044cb6f.png)

```
tips.pivot_table(values='total_bill', 
                 index=['sex', 'day'], 
                 aggfunc=[np.mean, np.median, np.sum])
```

![](img/e485215ee9c30aa3043523b85d6f63f2.png)

ä¸¤ä¸ªå‡½æ•°éƒ½è¿”å›å¤šåˆ—çš„æ•°æ®å¸§ã€‚ä½†æ˜¯ï¼Œå°½ç®¡å¯¹äºå•ä¸ªåˆ—æ¥è¯´`pivot_table()`æ›´å¥½ï¼Œä½†æ˜¯å¯¹`groupby`ç»“æœä½¿ç”¨`reset_index()`ä¼šç»™å‡ºæ›´å¥½çš„æ•°æ®æ¡†æ¶ã€‚ä¹Ÿè®¸è¿™å°±æ˜¯ Kagglers æ›´å–œæ¬¢`groupby()`çš„åŸå› ã€‚

åœ¨`pivot_table()`ä¸­ï¼Œæœ‰æ—¶ä½ å¯ä»¥ç”¨`columns`å‚æ•°ä»£æ›¿`index`(æˆ–è€…æœ‰æ—¶ä¸¤è€…éƒ½ç”¨)å°†æ¯ç»„æ˜¾ç¤ºä¸ºä¸€åˆ—ã€‚ä½†æ˜¯å¦‚æœæ‚¨å‘`columns`ä¼ é€’å¤šä¸ªå‚æ•°ï¼Œç»“æœå°†æ˜¯ä¸€ä¸ªåªæœ‰ä¸€è¡Œçš„é•¿æ•°æ®å¸§ã€‚

`groupby()`å’Œ`pivot_table()`çš„å¦ä¸€ä¸ªåŒºåˆ«æ˜¯`fill_value`å‚æ•°ã€‚æœ‰æ—¶ï¼Œå½“æ‚¨æŒ‰å¤šä¸ªå˜é‡åˆ†ç»„æ—¶ï¼Œä¸ä¼šæœ‰åŒ¹é…çš„ç»“æœå•å…ƒæ ¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ`groupby()`ä¼šæ”¾ç½®`NaN` sï¼Œä½†åœ¨`pivot_table()`ä¸­ï¼Œæ‚¨å¯ä»¥æ§åˆ¶è¿™ç§è¡Œä¸º:

```
tips.head()
```

![](img/320eb196e8ed6ba04f33062abbcc94de.png)![](img/72f12a2f894d0a282df84dc152152205.png)

ä½ æƒ³åœ¨ä»€ä¹ˆæ—¶å€™ä½¿ç”¨`pivot_table()`ï¼Ÿæ­£å¦‚æˆ‘ä¹‹å‰è¯´è¿‡çš„ï¼Œå®ƒæœ‰æ—¶å¯èƒ½æ˜¯`groupby()`çš„æ›´å¥½é€‰æ‹©ã€‚è¯´åˆ°è¯­æ³•ä¹Ÿæ˜¯ä¸ªäººå–œå¥½ã€‚ä¸€ä¸ªæ˜æ˜¾çš„ä¾‹å­æ˜¯é€‰æ‹©`pivot_table()`ï¼Œå› ä¸ºå®ƒæœ‰ä¸€äº›`groupby()`ä¸­æ²¡æœ‰çš„å…¶ä»–å‚æ•°ã€‚æˆ‘å·²ç»æŠ¥é“äº†`fill_value`ï¼Œä½†æ˜¯è¿˜æœ‰å…¶ä»–ç±»ä¼¼`margins`çš„ã€‚ä½ å¯ä»¥åœ¨[æ–‡æ¡£](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html)ä¸­äº†è§£æ›´å¤šä¿¡æ¯ğŸ˜ã€‚

> è¯·é˜…è¯»æ–‡ç« çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œäº†è§£è®¡ç®—åˆ†ç»„æ±‡æ€»ç»Ÿè®¡æ•°æ®çš„å‡½æ•°ä¹‹é—´çš„æ›´å¤šå·®å¼‚:

[](/meet-the-hardest-functions-of-pandas-part-ii-f8029a2b0c9b) [## è®¤è¯†ç†ŠçŒ«æœ€éš¾çš„åŠŸèƒ½ï¼Œç¬¬äºŒéƒ¨åˆ†

### æŒæ¡äº¤å‰è¡¨çš„æ—¶é—´å’Œæ–¹å¼()

towardsdatascience.com](/meet-the-hardest-functions-of-pandas-part-ii-f8029a2b0c9b) 

## ç†ŠçŒ«æ ˆ()

ä½¿ç”¨æ—¶ï¼Œ`[stack()](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.stack.html)`è¿”å›å¸¦æœ‰å¤šçº§ç´¢å¼•çš„æ•´å½¢æ•°æ®å¸§ã€‚æœ€å†…å±‚æ˜¯é€šè¿‡æ—‹è½¬æ•°æ®æ¡†æ¶çš„åˆ—æ¥åˆ›å»ºçš„ã€‚æˆ‘ä»¬æœ€å¥½ä»ä¸€ä¸ªä¾‹å­å¼€å§‹ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£ï¼Œæˆ‘å°†åŠ è½½`cars`æ•°æ®é›†å¹¶å¯¹å…¶è¿›è¡Œå­é›†åŒ–:

![](img/b7245ed3d6388694e74f89d27f4c5ec6.png)

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•é€è§†æ•°æ®å¸§ï¼Œä½¿åˆ—ç°åœ¨æˆä¸ºç´¢å¼•:

å½“æˆ‘ä»¬åœ¨è¿™ä¸ªæ•°æ®å¸§ä¸Šä½¿ç”¨`stack()`å‡½æ•°æ—¶ï¼Œç»“æœä¼šæœ‰å¤šçº§ç´¢å¼•ï¼Œ`name`ä¸ºå¤–å±‚ï¼Œ`weight`ï¼Œ`horsepower`ä¸ºå†…å±‚:

è¿™é‡Œï¼ŒåŸå§‹æ•°æ®å¸§åªæœ‰ä¸€ä¸ªå•çº§åˆ—åã€‚è¿™å°±æ˜¯ç»“æœæ•°æ®å¸§æ˜¯`pandas.Series`è€Œä¸æ˜¯æ•°æ®å¸§çš„åŸå› ã€‚

è®°ä½`stack()`å‡½æ•°æ€»æ˜¯å°†åˆ—æ—‹è½¬åˆ°å†…éƒ¨çº§åˆ«ç´¢å¼•ã€‚å¦‚æœæ²¡æœ‰å‰©ä½™çš„åˆ—ï¼Œæ„å‘³ç€å¦‚æœæœ€ç»ˆæ•°æ®æ˜¯ä¸€ä¸ªç³»åˆ—ï¼Œ`stack()`å°†ä¸èµ·ä½œç”¨ã€‚æˆ‘ä»¬æ¥è¯•è¯•ä¸Šé¢çš„`Series`:

```
stacked_cars.stack()AttributeError: 'Series' object has no attribute 'stack'
```

`stack()`çš„ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­æ˜¯å½“åˆ—åä½œä¸ºå¤šçº§ç´¢å¼•ç»™å‡ºæ—¶ã€‚è®©æˆ‘ä»¬å›åˆ°æˆ‘ä»¬çš„ä¸€ä¸ªæ•°æ®é€è§†è¡¨:

![](img/e485215ee9c30aa3043523b85d6f63f2.png)

å¦‚æ‚¨æ‰€è§ï¼Œåˆ—åæœ‰ä¸¤ä¸ªå±‚æ¬¡ã€‚æ‚¨å¯ä»¥è®¿é—®å…·æœ‰å¤šçº§åç§°çš„åˆ—ï¼Œå¦‚ä¸‹æ‰€ç¤º:

è®©æˆ‘ä»¬åœ¨è¿™ä¸ªæ•°æ®å¸§ä¸Šä½¿ç”¨`stack()`,çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆ:

```
multi_name.stack()
```

![](img/9e93cc3931e99af729713c378eafa3d4.png)

ç°åœ¨ï¼Œ`total_bill`è¿™ä¸ªå†…å±‚åˆ—åå˜æˆäº†ä¸€ä¸ªç´¢å¼•ã€‚æ‚¨å¯ä»¥æ§åˆ¶è¦å †å çš„åˆ—çº§åˆ«ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å †å å¤–å±‚åˆ—å:

```
multi_name.stack(level=0)
```

![](img/0f83a56e576e01678e5f2bb0e93b8191.png)

å¦‚æ‚¨æ‰€è§ï¼Œä½¿ç”¨ä¸åŒçš„çº§åˆ«ä¼šäº§ç”Ÿä¸åŒå½¢çŠ¶çš„æ•°æ®å¸§ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ`level`è®¾ç½®ä¸º 1ã€‚

## ç†ŠçŒ«è§£æ•£å †å ()

é¡¾åæ€ä¹‰ï¼Œ`[unstack()](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.unstack.html)`åšçš„å’Œ`stack()`å®Œå…¨ç›¸åã€‚å®ƒé‡‡ç”¨å¤šçº§ç´¢å¼•`Series`æˆ–æ•°æ®å¸§ï¼Œå¹¶å°†ç´¢å¼•è½¬æ¢ä¸ºåˆ—ã€‚å¦‚æœæˆ‘ä»¬æ‹†åˆ†å †å çš„æ±½è½¦ç³»åˆ—ï¼Œæˆ‘ä»¬å°†è·å¾—åŸå§‹æ•°æ®æ¡†æ¶:

```
>>> print('Unstacked Dataframe:')
>>> stacked_cars.unstack()Unstacked Dataframe:
```

![](img/9d2c8951e828b24df463a8c05e6e5f81.png)

ä¹Ÿè®¸ï¼Œæ‹†å›æœ€æ˜æ˜¾çš„ç”¨ä¾‹æ˜¯å½“æˆ‘ä»¬ä½¿ç”¨`groupby()`å‡½æ•°æ—¶ã€‚è™½ç„¶å½“æˆ‘ä»¬æŒ‰ä¸€ä¸ªå˜é‡åˆ†ç»„æ—¶ï¼Œè¿™ä¸€è¿‡ç¨‹æ˜¯ä¸å¯èƒ½çš„ï¼Œä½†æ‹†åˆ†è¯æ˜å¯¹æŒ‰å¤šä¸ªå˜é‡åˆ†ç»„éå¸¸æœ‰ç”¨ã€‚è®©æˆ‘ä»¬å›åˆ°æˆ‘ä»¬çš„`tips`æ•°æ®é›†:

```
tips.head()
```

![](img/320eb196e8ed6ba04f33062abbcc94de.png)

ç»“æœæ˜¯ä¸€ä¸ªå…·æœ‰ 4 çº§ç´¢å¼•çš„åºåˆ—ã€‚è¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚è®©æˆ‘ä»¬æ‹†åˆ†ä¸€ä¸‹ï¼Œä»¥ä¾¿æ›´å®¹æ˜“ä½¿ç”¨:

```
multiple_groups.unstack()
```

![](img/c19df81b8788e37feab6dee511580548.png)

ç»“æœè¿˜æ˜¯å¤šçº§ç´¢å¼•ã€‚è¿™æ˜¯å› ä¸º`unstack()`ä¸€æ¬¡åªåœ¨ä¸€ä¸ªç´¢å¼•çº§åˆ«ä¸Šå·¥ä½œã€‚è®©æˆ‘ä»¬å†æ¬¡è°ƒç”¨å®ƒæ¥è·å¾—å…·æœ‰å•ä¸€ç´¢å¼•çº§åˆ«çš„æ•°æ®å¸§:

```
multiple_groups.unstack().unstack()
```

![](img/76fb9d63edd214a4a5eafc9a7e20e435.png)

æˆ‘æƒ³ä½ å·²ç»çœ‹åˆ°äº†`unstack()`å’Œ`groupby()`ä¸€èµ·ä½¿ç”¨çš„æ•ˆæœã€‚å¤šçº§ç´¢å¼•æ€»æ˜¯å¾ˆéš¾ä½¿ç”¨ã€‚é™¤éä¸‡ä¸å¾—å·²ï¼Œå¦åˆ™å°½é‡é¿å¼€å®ƒä»¬ã€‚ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨`unstack()`ã€‚

è™½ç„¶`stack()`ä¸å¸¸ç”¨ï¼Œä½†æˆ‘è¿˜æ˜¯å‘ä½ å±•ç¤ºäº†å®ƒçš„åŸºæœ¬è¯­æ³•å’Œä¸€èˆ¬ç”¨æ³•ï¼Œä»¥ä¾¿ä½ æ›´å¥½åœ°æŒæ¡`unstack()`ã€‚

## åŒ…è£¹

è¿™ä¸ªå¸–å­åªæœ‰å¤§çº¦ 3 ä¸ªåŠŸèƒ½ã€‚åœ¨ä¸ä¹…çš„å°†æ¥ï¼Œæˆ‘è®¡åˆ’ä¸ºå…¶ä»–åŠŸèƒ½ç¼–å†™ç±»ä¼¼çš„æ–‡ç« ï¼Œè¿™äº›åŠŸèƒ½å¯èƒ½æœ‰ç‚¹éš¾ä»¥ç†è§£å¹¶é›†æˆåˆ°æ—¥å¸¸ä½¿ç”¨ä¸­ã€‚æ‰€ä»¥ï¼Œè¯·ç»§ç»­å…³æ³¨ï¼

# å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·åˆ†äº«å¹¶ç•™ä¸‹åé¦ˆã€‚ä½œä¸ºä¸€åä½œå®¶ï¼Œä½ çš„æ”¯æŒå¯¹æˆ‘æ¥è¯´æ„å‘³ç€ä¸€åˆ‡ï¼

é˜…è¯»æ›´å¤šä¸ä¸»é¢˜ç›¸å…³çš„æ–‡ç« :

[](/meet-the-hardest-functions-of-pandas-part-ii-f8029a2b0c9b) [## è®¤è¯†ç†ŠçŒ«æœ€éš¾çš„åŠŸèƒ½ï¼Œç¬¬äºŒéƒ¨åˆ†

### æŒæ¡äº¤å‰è¡¨çš„æ—¶é—´å’Œæ–¹å¼()

towardsdatascience.com](/meet-the-hardest-functions-of-pandas-part-ii-f8029a2b0c9b) [](/shape-tables-like-jelly-with-pandas-melt-and-pivot-f2e13e666d6) [## è®¤è¯†ç†ŠçŒ«æœ€éš¾çš„åŠŸèƒ½ï¼Œç¬¬ä¸‰éƒ¨åˆ†

### å½¢çŠ¶åƒæœå†»çš„æ¡Œå­æœ‰ç†ŠçŒ«æ—‹è½¬()å’ŒèåŒ–()

towardsdatascience.com](/shape-tables-like-jelly-with-pandas-melt-and-pivot-f2e13e666d6) [](/how-i-customarily-bin-data-with-pandas-9303c9e4d946) [## æˆ‘ä¹ æƒ¯å¦‚ä½•å°†æ•°æ®ä¸ç†ŠçŒ«ç»‘å®š

### æ‚¨å¯èƒ½åªä½¿ç”¨äº†é»˜è®¤å€¼

towardsdatascience.com](/how-i-customarily-bin-data-with-pandas-9303c9e4d946) [](/masteriadsf-246b4c16daaf) [## æŒæ¡è¿æ¥:Pandas åˆå¹¶ã€è¿æ¥ã€è¿½åŠ æ–¹æ³•

### ä»åŠè¿æ¥/åè¿æ¥åˆ°éªŒè¯æ•°æ®åˆå¹¶

towardsdatascience.com](/masteriadsf-246b4c16daaf) [](/from-kagglers-best-project-setup-for-ds-and-ml-ffb253485f98) [## æ¥è‡ª Kagglers:DS å’Œ ML çš„æœ€ä½³é¡¹ç›®è®¾ç½®

### æ¥è‡ªé¡¶çº§ Kagglers çš„é¡¹ç›®æˆåŠŸæœ€ä½³å®è·µçš„é›†åˆ

towardsdatascience.com](/from-kagglers-best-project-setup-for-ds-and-ml-ffb253485f98)