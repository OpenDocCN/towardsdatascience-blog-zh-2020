<html>
<head>
<title>Classification of Sky Objects with Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于机器学习的天空物体分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/classification-of-sky-objects-with-machine-learning-be4b05816690?source=collection_archive---------49-----------------------#2020-05-19">https://towardsdatascience.com/classification-of-sky-objects-with-machine-learning-be4b05816690?source=collection_archive---------49-----------------------#2020-05-19</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><figure class="gm go js jt ju jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj jr"><img src="../Images/1c454b773546efbde5564dd28452502d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EPM_VrIW2vlLFwHa-SYQXA.jpeg"/></div></div><p class="kc kd gk gi gj ke kf bd b be z dk translated"><strong class="bd kg">图片鸣谢&amp;版权:</strong> <a class="ae kh" href="http://www.thewildlifemoments.com/about/" rel="noopener ugc nofollow" target="_blank">伊万·佩德雷蒂</a></p></figure><h1 id="763f" class="ki kj iu bd kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf bi translated">第一步:问题和背景</h1><p id="1e3d" class="pw-post-body-paragraph lg lh iu li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md in bi translated">分类是你在数据科学领域可能面临的主要项目之一。因此，我们的导师要求我们为第三个个人项目执行一个分类项目。</p><p id="4cba" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">自从我开始从事数据科学工作以来，我一直想从事天文数据方面的工作。因此，在做了一些研究后，我决定处理<a class="ae kh" href="https://www.sdss.org/" rel="noopener ugc nofollow" target="_blank"> SDSS </a>的数据，其中包括关于天空物体及其各种特征的信息。</p><p id="ec11" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">通过这个项目，我的目标是通过光谱和光度特征对天空物体如恒星、星系和类星体进行分类。SDSS将这些特性保存在两个不同的表中，所以我不得不借助于一个<a class="ae kh" href="https://github.com/alpercakr/Classification-of-Astronomical-Objects/blob/master/sql.txt" rel="noopener ugc nofollow" target="_blank"> SQL命令</a>来合并它们。合并之后，我将这个表添加到我的项目文件夹中。好了，我得到了我的数据，所以是时候研究这个项目的方法了。</p></div><div class="ab cl mj mk hy ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="in io ip iq ir"><h1 id="e300" class="ki kj iu bd kk kl mq kn ko kp mr kr ks kt ms kv kw kx mt kz la lb mu ld le lf bi translated">第二步:数据知识</h1><p id="b985" class="pw-post-body-paragraph lg lh iu li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md in bi translated">我之前说过，我的数据集是由两个表组成的；一个是光谱特征，一个是光度特征。</p><ul class=""><li id="6c89" class="mv mw iu li b lj me ln mf lr mx lv my lz mz md na nb nc nd bi translated"><strong class="li iv">光谱数据</strong>:从物体光谱测得的各种量。例如它的光谱类型或红移。</li><li id="f898" class="mv mw iu li b lj ne ln nf lr ng lv nh lz ni md na nb nc nd bi translated"><strong class="li iv">测光数据</strong>:从物体图像测量的各种量。例如它的亮度、mag、通量或大小。</li></ul><p id="84b8" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">这个数据集由22列和500000行组成，没有缺失值。我在目标列中有三个独特的值:星系，恒星和类星体。</p><figure class="nk nl nm nn gu jv gi gj paragraph-image"><div class="gi gj nj"><img src="../Images/a2fcd562b35cebf0d0e15a87f6c059fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*q_nTMnKIzfcXZHR3G49ovQ.png"/></div></figure><p id="51cc" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">我的目标变量的三个等级之间的平衡是54%星系，35.4%恒星，和10.6%类星体。因此，我的数据集没有不平衡，在对数据进行一些基本的数据清理和可视化之后，我可以跳到特征工程部分。</p><figure class="nk nl nm nn gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj no"><img src="../Images/c367f70db40d3dd59a40e54f806dd461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fikuzb5-TVOV7d2jagRppQ.png"/></div></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">目标值的红移情况-真表示红移，假表示蓝移</p></figure></div><div class="ab cl mj mk hy ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="in io ip iq ir"><h1 id="f4b7" class="ki kj iu bd kk kl mq kn ko kp mr kr ks kt ms kv kw kx mt kz la lb mu ld le lf bi translated">步骤3:特征工程</h1><p id="69fc" class="pw-post-body-paragraph lg lh iu li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md in bi translated">我标记了11个对构建一个良好的分类模型非常重要的特性。因此，我专注于这些专栏来做特性工程。以下是我为本节选择的功能:</p><ol class=""><li id="5dd0" class="mv mw iu li b lj me ln mf lr mx lv my lz mz md np nb nc nd bi translated">电磁波谱:天体辐射的光的强度。观测波段范围:紫外线(u)、绿色(g)、红色(r)、红外线(I)和z波段。</li><li id="a9f9" class="mv mw iu li b lj ne ln nf lr ng lv nh lz ni md np nb nc nd bi translated">通量密度:从天体表面流出的能量比率。</li><li id="9e53" class="mv mw iu li b lj ne ln nf lr ng lv nh lz ni md np nb nc nd bi translated">红移</li></ol><p id="d028" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">我从异常值开始。在I波段和z波段有异常值，所以我用pandas <code class="fe nq nr ns nt b">clip</code>方法处理它们。其次，由于我的通量特征范围太广，我也做了一些单位转换。当我收集数据时，通量特征采用纳马吉单位，因此我将它们转换为扬斯基单位(光谱通量密度单位)，1纳马吉= 3.631 * 10^-6扬斯基。此外，我做了一个对数转换，以减少红移特性的离群值的影响。</p><p id="fedd" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">在这些操作之后，我检查了我的特征来进行提取。在这种情况下，我受益于频谱特性来创建新的特性。嗯，有一个特征叫做颜色指数，它定义了天体的颜色。将这个特性添加到我的数据集中太简单了，因为它是由两个光谱范围之间的差异定义的。</p><pre class="nk nl nm nn gu nu nt nv nw aw nx bi"><span id="fe83" class="ny kj iu nt b gz nz oa l ob oc"># Colour Indexes-difference between the two spectrum range<br/>df1['color_u_g'] = df1['u'] - df1['g']<br/>df1['color_g_r'] = df1['g'] - df1['r']<br/>df1['color_r_i'] = df1['r'] - df1['i']<br/>df1['color_i_z'] = df1['i'] - df1['z']</span></pre><p id="ecf4" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">因此，在简单的四行代码之后，我设法向我的数据集添加了四个新特性。最后一步，我为将要创建的分类模型编码了目标变量。</p></div><div class="ab cl mj mk hy ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="in io ip iq ir"><h1 id="edcd" class="ki kj iu bd kk kl mq kn ko kp mr kr ks kt ms kv kw kx mt kz la lb mu ld le lf bi translated">步骤4:分类模型</h1><p id="0608" class="pw-post-body-paragraph lg lh iu li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md in bi translated">我从探索基本模型开始这一步:KNN、逻辑回归、朴素贝叶斯、线性SVC和决策树。在这些模型初始化之后，我开始定义集合模型:</p><ul class=""><li id="d37a" class="mv mw iu li b lj me ln mf lr mx lv my lz mz md na nb nc nd bi translated">Bagging算法:随机森林、额外树和Bagging分类器</li><li id="f17c" class="mv mw iu li b lj ne ln nf lr ng lv nh lz ni md na nb nc nd bi translated">增强算法:AdaBoost和GradientBoosting</li><li id="d2ad" class="mv mw iu li b lj ne ln nf lr ng lv nh lz ni md na nb nc nd bi translated">投票分类器:软和硬</li></ul><p id="9612" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">我的方法是，在运行完本节中的所有模型后，选择最佳模型进行优化。因此，我用默认参数运行了所有的模型，以查看结果。</p><figure class="nk nl nm nn gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj od"><img src="../Images/d706b3467fd964372693430aa298dfd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*UOGzXRzM9rTqaUryXzIKLA.jpeg"/></div></div></figure><p id="eff5" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">这是我的分类模型的结果。我还在表中添加了测试准确度分数，以确保我的模型中没有过度拟合。可以看出，我定义了所有众所周知的算法来为这个项目的问题选择最合适的模型。</p><p id="77d2" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">我必须明确指出，现实世界中没有最好的模型。正如乔治E.P博克斯曾经说过的:“所有的模型都是错的，但有些是有用的。”你只需要找到对你的问题最有用的模型&amp;数据。</p><figure class="nk nl nm nn gu jv gi gj paragraph-image"><div class="gi gj oe"><img src="../Images/fcd032a781deb90af37ff4785281473c.png" data-original-src="https://miro.medium.com/v2/resize:fit:394/format:webp/1*9tE5y6RWMPN8qAoag6lHGw.jpeg"/></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">随机森林-特征重要性表:前七个特征</p></figure><p id="b51d" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">嗯，Bagging分类器模型是我选择用于进一步工作的模型，因为测试准确度分数。有了99.38%的准确率，它似乎是我的项目的最佳模型。</p></div><div class="ab cl mj mk hy ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="in io ip iq ir"><h1 id="1ef5" class="ki kj iu bd kk kl mq kn ko kp mr kr ks kt ms kv kw kx mt kz la lb mu ld le lf bi translated">第五步:改进模型</h1><p id="2c96" class="pw-post-body-paragraph lg lh iu li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md in bi translated">我跳到了模型评估之后的优化部分。为此，我决定使用<code class="fe nq nr ns nt b">GridSearch</code>。</p><pre class="nk nl nm nn gu nu nt nv nw aw nx bi"><span id="a38d" class="ny kj iu nt b gz nz oa l ob oc">#specify the parameters to be tested<br/>n_est = [80, 100, 120, 140]<br/>max_features_opt = [0.93, 0.95, 0.97]</span><span id="5b80" class="ny kj iu nt b gz of oa l ob oc">param_grid = dict(n_estimators = n_est, max_features=max_features_opt)</span></pre><p id="cae8" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">我们可以在确定将由<code class="fe nq nr ns nt b">GridSearchCV</code>测试的参数后拟合模型。请注意，<code class="fe nq nr ns nt b">GridSearchCV</code>本身包含了交叉验证，所以我也必须指定<code class="fe nq nr ns nt b">KFold</code>的值。当拟合过程完成时，我可以检查最佳估计值。</p><pre class="nk nl nm nn gu nu nt nv nw aw nx bi"><span id="4da9" class="ny kj iu nt b gz nz oa l ob oc">kf=KFold(n_splits=10, shuffle=True, random_state=76)</span><span id="0953" class="ny kj iu nt b gz of oa l ob oc">bag_grid = GridSearchCV(bag, param_grid, cv = kf, 	scoring='accuracy', n_jobs=-1)<br/>bag_grid.fit(X_train, y_train)</span></pre><p id="97ee" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">并且，根据我从<code class="fe nq nr ns nt b">GridSearch</code>得到的结果，我重新定义了Bagging分类器模型。</p><pre class="nk nl nm nn gu nu nt nv nw aw nx bi"><span id="b2c3" class="ny kj iu nt b gz nz oa l ob oc">bag_opt = BaggingClassifier(base_estimator=dtree, n_estimators=120,  max_features=0.93, bootstrap=True, random_state=seed, n_jobs = -1)</span><span id="92b3" class="ny kj iu nt b gz of oa l ob oc">bag_opt_acc = round(cross_val_score(bag_opt, X_train, y_train, 																																																 cv=kf).mean())bag_opt_std = round(cross_val_score(bag_opt, X_train, y_train, cv=kf).std())</span></pre></div><div class="ab cl mj mk hy ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="in io ip iq ir"><h1 id="10fb" class="ki kj iu bd kk kl mq kn ko kp mr kr ks kt ms kv kw kx mt kz la lb mu ld le lf bi translated">第六步:结果</h1><p id="dfda" class="pw-post-body-paragraph lg lh iu li b lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md in bi translated">在我的最后一步，我进行了保持测试，以查看优化的Bagging模型的准确性。我从优化后的模型中得到的结果是99.44%，因此我实现了大约0.06%的提高。这不是很多，但我的模型有一个很好的准确性评分。</p><figure class="nk nl nm nn gu jv gi gj paragraph-image"><div class="gi gj og"><img src="../Images/33fc03abc43e1be04fc432ef51e27646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*N6KIrQODGCaKxKH6scFtrQ.png"/></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">混淆矩阵</p></figure><p id="11f9" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">最终结论:</p><ul class=""><li id="74ba" class="mv mw iu li b lj me ln mf lr mx lv my lz mz md na nb nc nd bi translated">从特征重要性表中可以看出，红移和颜色索引是我的分类问题中最有价值的特征。</li><li id="21f2" class="mv mw iu li b lj ne ln nf lr ng lv nh lz ni md na nb nc nd bi translated">我得到的最好的结果来自集合模型。在这个项目中，朴素贝叶斯和KNN模型的精度值相对较小。</li></ul></div><div class="ab cl mj mk hy ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="in io ip iq ir"><p id="6a95" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">好了，暂时就这些了。下一篇文章再见！</p><p id="222c" class="pw-post-body-paragraph lg lh iu li b lj me ll lm ln mf lp lq lr mg lt lu lv mh lx ly lz mi mb mc md in bi translated">另外，如果你想了解更多，也可以看看我的<a class="ae kh" href="https://github.com/alpercakr" rel="noopener ugc nofollow" target="_blank"> Github </a>简介！</p></div></div>    
</body>
</html>