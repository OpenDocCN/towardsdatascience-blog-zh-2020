<html>
<head>
<title>Dealing with Imbalanced Data in Churn Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">流失分析中不平衡数据的处理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dealing-with-imbalanced-data-in-churn-analysis-6ea1afba8b5e?source=collection_archive---------32-----------------------#2020-05-25">https://towardsdatascience.com/dealing-with-imbalanced-data-in-churn-analysis-6ea1afba8b5e?source=collection_archive---------32-----------------------#2020-05-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="70bc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我们的实习团队在为一家SaaS公司进行客户保持分析时如何处理不平衡数据。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9f6dc94733642b9867ae07eb431d7b2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mWytMN_oq86XvncLP9LMAQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">让我们看看如何在你的<a class="ae kv" href="https://pixabay.com/illustrations/be-unique-change-different-idea-4909103/" rel="noopener ugc nofollow" target="_blank">小众类</a>中找到模式</p></figure><p id="25b2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的<a class="ae kv" rel="noopener" target="_blank" href="/improving-saas-with-data-science-e2cf3720bc90">加州大学戴维斯分校MSBA实习项目</a>的客户保持分析部分，我们必须应对的主要挑战之一是我们数据中的不平衡。</p><p id="1376" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天，我将讲述:</p><ul class=""><li id="02cd" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">什么是不平衡数据？</li><li id="7cb2" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">什么时候成问题了？</li><li id="83fd" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">如何处理不平衡的数据？</li><li id="8378" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">我们应用的解决方案如何影响我们的项目。</li></ul></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="0136" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">什么是不平衡数据？</h1><p id="290b" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">可用于分类问题的数据集有一个标签(例如，客户流失、糖尿病等。)和一组输入(如产品特性、健康指标等。)标签表明了类别，因此您可能会有一个“搅动的”与“活跃的”类型的客户。</p><p id="24b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">严格地说，如果你的数据没有对半分割，那么它就不是“平衡的”。<em class="nk">这很好</em>。没有完美的数据集！甚至不是分类问题教程很流行的<a class="ae kv" href="https://www.kaggle.com/c/titanic/data" rel="noopener ugc nofollow" target="_blank">泰坦尼克</a>或者<a class="ae kv" href="https://archive.ics.uci.edu/ml/datasets/wine+quality" rel="noopener ugc nofollow" target="_blank">酒质</a>数据集。</p><p id="9687" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一些数据集的分类比例为90/10(即90%的活跃客户，10%的流失客户)，一些数据集的分类比例为95/5，甚至99/1。这将<em class="nk">非常</em>不平衡。</p><h1 id="7f6c" class="mn mo iq bd mp mq nl ms mt mu nm mw mx jw nn jx mz jz no ka nb kc np kd nd ne bi translated">什么时候成问题了？</h1><p id="3bcd" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">由于不平衡的数据可能有不同的比率，我们开始想知道什么比率是我们必须评估的实际问题。你的少数民族班有10%的案例是个问题吗？5%?不到1%？</p><p id="2a9a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个答案和我每次问有见识的人一个有趣的问题得到的答案是一样的:<strong class="ky ir"> <em class="nk">看情况！</em>T15】</strong></p><p id="9d41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于如何划分你的类没有标准的界限。根据你正在解决的商业问题的类型和行业的类型，拆分可能会变得更有意义。例如，对于客户保留问题，80/20的分割可能是可以接受的，但是对于医疗保健问题就不太好了。欺诈检测、在泰坦尼克号沉船中幸存、流失分析或COVID spread都可能在用于各自分类问题的类中使用不同的拆分。</p><p id="1941" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们的实习项目中，这种不平衡不像1%的少数阶级(被搅动的顾客)那样严重，但这仍然是我们决定解决的问题。</p><h1 id="5e6c" class="mn mo iq bd mp mq nl ms mt mu nm mw mx jw nn jx mz jz no ka nb kc np kd nd ne bi translated">如何处理不平衡的数据？</h1><p id="5fac" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">有许多方法可以处理不平衡的数据。拥有人工智能硕士和博士学位的杰森·布朗利(Jason Brownlee)更详细地讲述了这个主题，以及许多其他关于<a class="ae kv" href="https://machinelearningmastery.com/" rel="noopener ugc nofollow" target="_blank">机器学习掌握</a>的有趣的机器学习教程。他还推荐这本<a class="ae kv" href="https://www.amazon.com/dp/1118074629?tag=inspiredalgor-20" rel="noopener ugc nofollow" target="_blank">书</a>“深入研究一些关于处理阶级失衡的学术文献”。</p><p id="f810" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天，我们将学习3种方法:</p><ol class=""><li id="58dc" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr nq ly lz ma bi translated">检查您的指标</li><li id="37ba" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nq ly lz ma bi translated">平衡您的数据</li><li id="2bd4" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nq ly lz ma bi translated">什么也不做</li></ol></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h2 id="7d6e" class="nr mo iq bd mp ns nt dn mt nu nv dp mx lf nw nx mz lj ny nz nb ln oa ob nd oc bi translated">1.检查您的指标</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/b5696ce17e73a9e88a01426761abe374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gb6D5hXBTd-JrjfByjJuTA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">重要的是<a class="ae kv" href="https://pixabay.com/illustrations/audit-report-verification-magnifier-3737447/" rel="noopener ugc nofollow" target="_blank">深入了解</a>性能指标，理解准确性和精确性之间的区别。</p></figure><p id="559e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当我们获得分类模型的结果时，我们通常首先查看的是我们所做的所有预测中正确预测的数量。这似乎很直观，因为我们想看看我们的模型表现如何。这是模型的<strong class="ky ir">精确度</strong>:预测总数的总<em class="nk">正确</em>预测。然而，我们需要记住，只看<em class="nk">和</em>的准确性是不够的！</p><blockquote class="oe"><p id="7a7f" class="of og iq bd oh oi oj ok ol om on lr dk translated"><strong class="ak">“准确性不是处理不平衡数据集时使用的衡量标准。我们已经看到这是一种误导。”杰森·布朗利</strong></p></blockquote><p id="e811" class="pw-post-body-paragraph kw kx iq ky b kz oo jr lb lc op ju le lf oq lh li lj or ll lm ln os lp lq lr ij bi translated">在这篇<a class="ae kv" href="https://machinelearningmastery.com/classification-accuracy-is-not-enough-more-performance-measures-you-can-use/" rel="noopener ugc nofollow" target="_blank">帖子</a>中，布朗利详细解释了为什么仅仅靠准确性不能给你足够的信息来做出决定。在我们的案例中，当进行流失分析并预测将流失的客户时，准确性意味着在所有客户中，我们正确地将多少实际流失的客户标记为“流失”(<strong class="ky ir">真阳性</strong>)以及将多少未流失的客户标记为“未流失”(<strong class="ky ir">真阴性</strong>):</p><p id="9d64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为有如此多的客户没有流失，高数量的真实否定使得准确率非常高，这将是误导，因为我们希望专注于那些确实离开的客户，并试图发现我们可以做些什么来防止其他客户发生这种情况。</p><p id="e2c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">精度在这里派上了用场。精确度是:在所有被标记为“流失”的客户中，我们正确标记了多少？这是被正确标记的客户(<strong class="ky ir">真阳性</strong>)与所有被标记为“流失”的客户(<strong class="ky ir">真阳性</strong>和<strong class="ky ir">假阳性</strong>)的比率。</p><p id="77a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于我们来说，在处理数据中的不平衡之前和之后进行回顾，这个指标更有意义。如果你想了解更多关于性能指标的信息，计算机工程专业的学生Salma Ghoneim在这篇<a class="ae kv" rel="noopener" target="_blank" href="/accuracy-recall-precision-f-score-specificity-which-to-optimize-on-867d3f11124">文章</a>中对准确性、召回率、精确度、F值和特异性做了出色的解释。</p><p id="81de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，您可能希望检查受试者操作者特征曲线下的面积(AUC ROC或AUROC ),以确定真阳性和假阳性之间的关系。另一篇<a class="ae kv" rel="noopener" target="_blank" href="/understanding-auc-roc-curve-68b2303cc9c5">帖子</a>很好地解释了这个重要的概念，StatQuest创始人Josh Starmer的这篇<a class="ae kv" href="https://www.youtube.com/watch?v=4jRBRDbJemM" rel="noopener ugc nofollow" target="_blank">清晰的解释</a>带你一步一步地了解细节。)</p><h2 id="5109" class="nr mo iq bd mp ns nt dn mt nu nv dp mx lf nw nx mz lj ny nz nb ln oa ob nd oc bi translated">2.平衡您的数据</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/75538e0d3654a24e0fd3cf322971f045.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0QzMQI555rYxOMRD09zB5w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://pixabay.com/illustrations/brain-heart-brain-icon-3269655/" rel="noopener ugc nofollow" target="_blank">平衡数据</a>可以用不同的方式完成！</p></figure><ul class=""><li id="bc63" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">欠采样:</strong>欠采样包括从你的过表示类中删除观察值。在这种情况下，这些将是活跃的客户。当你有一大堆数据时(布朗利称之为<em class="nk">“几万或几十万个实例或更多”</em> <a class="ae kv" href="https://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/" rel="noopener ugc nofollow" target="_blank">)，这样做是有意义的，但在这个项目中，情况并非如此。</a></li><li id="116e" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">过采样:</strong>过采样包括添加来自未被充分代表的类的观察副本。在这种情况下，这些将是搅动的客户。这是一个不错的方法，因为它平衡了数据，但我们仍然可以做得更好。</li><li id="6af8" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir"> SMOTE </strong>:这样更好！<a class="ae kv" href="https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/" rel="noopener ugc nofollow" target="_blank"> SMOTE </a>代表合成少数过采样技术。这种方法创建数据的合成样本，因此SMOTE使用距离测量来创建数据点的合成样本，而不是复制观测值，这些数据点不会离您的数据点太远。我们在客户流失分析中使用这个来平衡数据。</li><li id="1a87" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir"> ADASYN </strong> : ADASYN代表自适应合成采样方法，它是一种对你的数据集应用SMOTE的改进方法。<a class="ae kv" href="https://machinelearningmastery.com/smote-oversampling-for-imbalanced-classification/" rel="noopener ugc nofollow" target="_blank"> ADASYN </a>查看数据的密度分布，以确定将要生成的样本数量。在我们的流失分析中，我们最初使用SMOTE，但当我们了解到ADASYN是一种创建合成样本的改进方法后，我们将我们的方法切换到ADASYN。</li></ul><h2 id="e017" class="nr mo iq bd mp ns nt dn mt nu nv dp mx lf nw nx mz lj ny nz nb ln oa ob nd oc bi translated">3.什么也不做</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/9de0c1f22bd471783426540d31094ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ryj3LhBP37owku-tUD9pYA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">有时不同的视角比典型的解决方案更好。</p></figure><p id="1df1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里什么都不做并不意味着我们解决了这个问题！这意味着，你可以考虑<strong class="ky ir">其他方法</strong>，比如收集更多数据(如果可能的话)或者使用不同的机器学习模型，而不是解决你数据中的不平衡。决策树和随机森林是很好的选择。你也可以试试C4.5，C5.0或者CART，就像这个<a class="ae kv" href="https://machinelearningmastery.com/tactics-to-combat-imbalanced-classes-in-your-machine-learning-dataset/" rel="noopener ugc nofollow" target="_blank">帖子</a>上建议的那样。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><p id="9ae2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">美女(还有挑战！)的问题是决定使用哪种方法既能最大限度地提高模型性能，又能揭示数据中的洞察力。</p><h1 id="4011" class="mn mo iq bd mp mq nl ms mt mu nm mw mx jw nn jx mz jz no ka nb kc np kd nd ne bi translated">我们应用的解决方案如何影响我们的项目。</h1><p id="5161" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">一旦我们使用<strong class="ky ir"> ADASYN </strong>平衡数据集，我们就会看到在模型性能方面更好的结果。这使我们能够继续分析和评估不同模型如何回答我们的问题:<em class="nk">哪些关键特征与离开/留在这家SaaS公司的客户最相关？</em>我们能够找到隐藏在回答这个问题的数据中的金块，并帮助我们向这家SaaS公司的利益相关者提供可行的建议。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="9fe2" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">大团圆结局？</h1><p id="76bb" class="pw-post-body-paragraph kw kx iq ky b kz nf jr lb lc ng ju le lf nh lh li lj ni ll lm ln nj lp lq lr ij bi translated">从那以后我们愉快地继续实习了吗？<em class="nk">没有</em>。我们在这个项目中遇到了更多的挑战，这让它变得更加有趣。<strong class="ky ir">剧透提醒</strong>:我们<em class="nk">确实</em>交付了强劲的成果，我们的利益相关者非常高兴，我们目前正在完成<a class="ae kv" rel="noopener" target="_blank" href="/improving-saas-with-data-science-e2cf3720bc90">项目</a>和我们的<a class="ae kv" href="https://gsm.ucdavis.edu/msba-masters-science-business-analytics" rel="noopener ugc nofollow" target="_blank"> MSBA项目</a><em class="nk"/>。</p></div></div>    
</body>
</html>