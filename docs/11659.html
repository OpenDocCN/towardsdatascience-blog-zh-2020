<html>
<head>
<title>AI for 3-D Printing (Part 2): One Class Learning for Anomalous Melt Pools Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">三维打印的人工智能(下):异常熔池检测的一类学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ai-for-3-d-printing-anomalous-melt-pools-detection-and-classification-part-2-895704203c5a?source=collection_archive---------53-----------------------#2020-08-12">https://towardsdatascience.com/ai-for-3-d-printing-anomalous-melt-pools-detection-and-classification-part-2-895704203c5a?source=collection_archive---------53-----------------------#2020-08-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="a251" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">本文是 3d 打印人工智能系列的第二部分。阅读</em> <a class="ae km" href="https://medium.com/@boonyang961005/ai-for-3-d-printing-anomalous-melt-pools-detection-and-classification-part-1-e84ed6f5a137" rel="noopener"> <em class="kl">第一部分</em> </a> <em class="kl">和</em> <a class="ae km" href="https://medium.com/@boonyang961005/ai-for-3-d-printing-part-3-disentangled-variational-autoencoder-for-anomalous-melt-pools-aaed53b80140" rel="noopener"> <em class="kl">第三部分</em> </a> <em class="kl">。</em></p><p id="b73d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从<a class="ae km" href="https://medium.com/@boonyang961005/ai-for-3-d-printing-anomalous-melt-pools-detection-and-classification-part-1-e84ed6f5a137" rel="noopener">第 1 部分</a>中，我们得出结论，需要为 LPBF 现场监控系统定义一个单一的度量标准来测量熔池视频帧的异常程度。理想情况下，该度量的评估应该在计算上不昂贵，从而可以在接近实时的设置下计算。本文介绍了一个异常检测框架，该框架以一类学习的概念为中心。</p><p id="5d60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">免责声明:本文的目的是展示如何将不同的模型放在一个异常检测框架中。诸如超参数微调和模型架构的细节将被省略。</em></p></div><div class="ab cl kn ko hu kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ij ik il im in"><h1 id="d510" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">介绍</h1><p id="aec5" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">单类学习是一种无监督的训练分类器的方法，当数据集中的一些类要么数量很少，要么没有明确定义的特征。不平衡的数据集问题引入了过度拟合的风险，因为受监督的机器学习模型通常难以推广到少数类。通过一类学习，分类器被训练成专门从单个类中识别良好表征的实例，因此这种类型的分类器也被称为一类分类器。</p><p id="c9c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在检测异常熔池的情况下，尽管异常熔池的比例相对于正常熔池较小，但理论上，我们可以通过生成一组具有较差印刷过程的异常训练样本来修复数据不平衡。故意产生的异常是否与真实异常具有相同的分布将是一个问题，但更重要的是，这里的真正问题是异常没有被很好地表征。这意味着手动注释异常容易出现不一致的错误，这是由于异常的定义不太明确(例如，熔池必须喷射多少飞溅颗粒，这些颗粒必须有多大才能被认为是异常情况？).一级学习提供了监督培训的替代方案，因为培训阶段不需要贴标签。</p><p id="4313" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有一些单类学习算法的例子，例如自动编码器和单类支持向量机。在这个项目中，使用<strong class="jp ir">深度卷积自动编码器</strong>进行异常检测的实验。</p><blockquote class="lx ly lz"><p id="5a67" class="jn jo kl jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated">通过一个类的学习，我们可以分配一个连续的度量来测量熔池异常的程度。在无监督的基础上操作，一类分类器不需要用于训练的标记数据。</p></blockquote><h1 id="8799" class="ku kv iq bd kw kx md kz la lb me ld le lf mf lh li lj mg ll lm ln mh lp lq lr bi translated">自动编码器</h1><p id="cf9a" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">本节简要介绍自动编码器。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/a3899946c6ab717f75c3425eef0640ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*-1sedAuExqcWyGPpRUzlcg.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">自动编码器的一般结构。</p></figure><p id="9033" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上图显示了自动编码器的一般架构。自动编码器由两个主要部件组成，即<strong class="jp ir">编码器</strong>和<strong class="jp ir">解码器</strong>。编码器将高维输入数据压缩到低维潜在空间，这是自动编码器架构的瓶颈。解码器然后将编码解码回原始维度空间。编码-解码过程受到输入和输出在欧几里得意义上必须相似的约束。</p><p id="520e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数学上，这可以写成，<strong class="jp ir"><em class="kl">Z</em></strong><em class="kl"/>= g(<strong class="jp ir"><em class="kl">X</em></strong>)和<strong class="jp ir"><em class="kl">X '</em></strong>= f(<strong class="jp ir"><em class="kl">Z</em></strong>)服从<strong class="jp ir"><em class="kl">X</em></strong>≈<strong class="jp ir"><em class="kl">X '</em></strong>，其中<em class="kl"> </em></p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/50681a51a9ed784d983d31070f95987b.png" data-original-src="https://miro.medium.com/v2/resize:fit:274/format:webp/1*jrQbGeUqHaaFxxEC20dACA.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">自动编码器的损失函数</p></figure><p id="416e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用于自动编码器训练的损失函数是<strong class="jp ir"> <em class="kl"> X </em> </strong>和<strong class="jp ir"><em class="kl">X’</em></strong>之间的欧几里德距离。自动编码器的目标是在训练过程中最小化损失函数，使得结果输出类似于输入数据。注意，损失函数也是输入和输出之间不相似性的度量。因此，它也被称为重建误差(RE)。</p><p id="1087" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于瓶颈中的维度空间较小，编码器被迫只对瓶颈输入中最具代表性的特征进行编码，以允许解码器重构输入数据。决定潜在空间的维度是至关重要的，因为小的维度将对从编码器到解码器的信息流施加太多的限制，使得解码器难以重构输入数据。另一方面，对于过大的潜在维度，编码器将不会学习捕捉输入数据的重要特征，因为对信息流没有施加太多的限制。</p><h1 id="29b6" class="ku kv iq bd kw kx md kz la lb me ld le lf mf lh li lj mg ll lm ln mh lp lq lr bi translated">数据预筛选</h1><p id="ca3a" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">本节介绍了用于培训数据准备的数据过滤方法。如上所述，一类学习要求异常实例是训练数据集中的少数。确保所需约束的快速方法是通过使用无监督聚类算法，例如 k-means 聚类。具体来说，来自聚类 1 和 9 的聚焦解链池被混洗并用于训练我们的自动编码器。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/d1428f9c969b853eafdf70a210c3d32e.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*jciLe7xNO4R2oX-F6AkFzQ.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">来自聚类 1 和聚类 9 的聚焦解链池用于自动编码器的训练</p></figure><p id="f856" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于自动编码器在训练过程中暴露于大多数正常的熔池图像，它将学习捕获基本的正常熔池表示，使得大多数重建的输出与输入相似。这导致整体训练损失较小。</p><h1 id="c878" class="ku kv iq bd kw kx md kz la lb me ld le lf mf lh li lj mg ll lm ln mh lp lq lr bi translated">异常检测</h1><p id="545a" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">重构误差(RE)度量用于测量输入和重构输出之间的差异。作为健全性检查，计算并可视化离焦熔池的 RE 度量。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/483e13c200bde5b5104991f7145349e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K8elRwUxeO0_A5ioQNSCbw.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">健全性检查:经过训练的自动编码器应用于失焦熔池视频帧。</p></figure><p id="ffa2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如图所示，自动编码器未能重建所遇到的异常，结果，度量尖峰指示异常事件的发生。测试还表明，对于离焦印刷，RE 提供了异常程度的良好的相对测量。例如，与较小的羽流实例相比，覆盖范围较大的羽流实例会产生较大的 RE。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nb"><img src="../Images/63d9a7618a4eaa9d42ecf4e263386ac8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PpYLecf-wknabRPD0NzI2A.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">从(a) RE &lt;0.003 (b) 0.004<re and="" re=""> 0.006 取样的熔池</re></p></figure><p id="d10b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面还介绍了一些异常的熔池重建。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nc"><img src="../Images/8c0fad879dc0aba49440396558d773ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q5vblNsjhypXSsSnBgAOSA.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">原始(第一行)、重建(第二行)和错误熔池图像，顶部为 RE x 10(第三行)</p></figure><p id="6618" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意自动编码器如何无法重建异常部分，如熔池的不稳定尾部和飞溅颗粒。为了比较，下面显示了具有较小 RE 的熔池图像。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nd"><img src="../Images/0093f4594669ea3f29b74e28be006f0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vrsc4vsU07dPRYgoWBX4Qg.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">原始(第一行)、重建(第二行)和错误熔池图像，顶部为 RE x 10(第三行)</p></figure><p id="705c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还可以将熔池视频帧投影到二维散点图上，以显示熔池图像。下面显示的是具有锚定的训练熔化池视频帧的第一潜在成分对第二潜在成分的图。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/31c9865bf629261f99a6ef884973011d.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*5R_A3_rj3B7j_fhVovH_Dw.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">对于一些训练数据点，第二潜在分量 Z2 相对于第一潜在分量 Z1 绘制。</p></figure><p id="0cde" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有趣的是，自动编码器捕捉熔池的移动方向，正常的熔池确实在潜在空间中以簇的形式出现。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/b1335d92fce01eac33bdb0b33ccf8e13.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*tyFWevBA28Fyk4mNxbruKA.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">对于一些测试数据点，第二潜在分量 Z2 对第一潜在分量 Z1 作图。</p></figure><p id="c065" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于类似的图，但是在测试数据上，我们观察到一些异常位于远离集群的位置。</p><h1 id="66eb" class="ku kv iq bd kw kx md kz la lb me ld le lf mf lh li lj mg ll lm ln mh lp lq lr bi translated">模型性能评估</h1><p id="443a" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">接下来，标记了大约 1500 个看不见的数据点。然后，标记的数据点可用于帮助确定合适的 RE 阈值，并量化自动编码器的性能。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/eb88635689d10a5fd1e83a58518ec657.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*s9XjKFofCJmhc7sYjwBo-A.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">用于确定最佳 RE 阈值的 ROC 曲线</p></figure><p id="d744" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用受试者工作特征(ROC)曲线确定合适的 RE 阈值。注意，异常被定义为正类，而正常熔池被标记为负类。</p><p id="59f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，根据确定的 RE 阈值，对自动编码器在两种熔池类别的召回率和精确度方面的性能进行了评估，并总结在下表中:</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nh"><img src="../Images/bebbe91a2cd2d5f5322c879dddf1e5ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hds2pUTWv63Qboud8zo0pQ.png"/></div></div></figure><h1 id="2214" class="ku kv iq bd kw kx md kz la lb me ld le lf mf lh li lj mg ll lm ln mh lp lq lr bi translated">一些想法</h1><p id="2938" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">测量该异常检测框架所需的时间，从最小最大归一化图像到重新计算，自动编码器平均花费 1 微秒来输出预测。这比单独的区域道具特征提取快大约 1000 倍。更重要的是，图像处理也比所用的 LPBF 原位监测系统的 FPS 更快。</p><p id="8a9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为一个完全无监督的模型，自动编码器的训练不需要任何人工标记，这是一个巨大的努力节省，因为有监督的深度学习模型通常需要大量的标记数据。总的来说，一类学习框架的实现显示了 LPBF 原位监测的巨大计算时间节省。随着处理速度的加快，我们现在可以有选择地提取熔池的特征，用于后续的异常分析。</p><p id="448e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者，我们可以利用潜在向量作为训练分类器的提取特征，因为编码包含关于熔池几何形状的最有价值的信息。这将在本系列的第 3 部分中详细说明。</p><h1 id="bf48" class="ku kv iq bd kw kx md kz la lb me ld le lf mf lh li lj mg ll lm ln mh lp lq lr bi translated">警告</h1><p id="f4ec" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">当在一个完全不同的看不见的数据集上部署时，自动编码器的性能会有很大的不同。数据外推主要是机器学习模型的一个问题，但是，由于自动编码器通过对输入数据中最具信息性的特征进行编码来工作，因此它的使用甚至更加数据特定。这对于一个类学习的目的是好的，但是对于在不同印刷参数下产生的熔池图像，RE 的鲁棒性将是有问题的。例如，用从弯曲扫描捕获的熔池训练的自动编码器可能在从岛扫描策略重建大多数熔池图像时表现不佳，不管它们是否异常。</p><h1 id="9b0b" class="ku kv iq bd kw kx md kz la lb me ld le lf mf lh li lj mg ll lm ln mh lp lq lr bi translated">结束语</h1><p id="b55d" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">本文阐述了深卷积自动编码器在熔池异常检测中的应用。通过 K-均值聚类在预先筛选的数据集上训练，自动编码器能够很好地重建正常的熔池图像。未能重建异常熔池，自动编码器会产生较大的重建误差。自动编码器的使用在潜在的计算节省和性能方面显示出有希望的结果。在下一篇文章中，我们将更多地探讨普通自动编码器的概率变体在异常分类中的应用。感谢阅读:)</p></div></div>    
</body>
</html>