<html>
<head>
<title>Working with missing values in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理熊猫中缺失的值</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/working-with-missing-values-in-pandas-5da45d16e74?source=collection_archive---------6-----------------------#2020-04-19">https://towardsdatascience.com/working-with-missing-values-in-pandas-5da45d16e74?source=collection_archive---------6-----------------------#2020-04-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4edb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于 Pandas 中缺失值以及如何使用内置方法处理它们的教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8ca839a42c4e53989417eeef011e66db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0fH4Um3cKsvis-1lwkDLFQ.png"/></div></div></figure><p id="dfab" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">真实世界的数据很少是干净和同质的。特别是，许多有趣的数据集将会丢失一些值。</p><p id="fae2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本文中，我们将讨论缺失值在 Pandas 中是如何表示的，如何处理其他字符表示，以及 Pandas 处理缺失值的内置方法。</p><p id="5f81" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">概述</p><ul class=""><li id="0c60" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">熊猫身上缺失的价值观</li><li id="11af" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">处理其他字符表示</li><li id="4268" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">处理缺失值</li></ul><h1 id="fc8a" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">熊猫身上缺失的价值观</h1><p id="607c" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">用于指示缺失值存在的方案通常围绕两种策略之一[1]:</p><ol class=""><li id="051f" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp nb lw lx ly bi translated">全局指示缺失值的<em class="nc">掩码</em>。</li><li id="be31" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp nb lw lx ly bi translated">指示缺失条目的<em class="nc">标记值</em>。</li></ol><p id="ede6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<em class="nc">屏蔽</em>方法中，它可能是相同大小的布尔数组表示，或者使用一个位来表示丢失条目的本地状态。</p><p id="2391" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在<em class="nc">标记值</em>方法中，标签值用于指示缺失值，如<code class="fe nd ne nf ng b">NaN</code>(非数字)、<code class="fe nd ne nf ng b">null</code>或作为编程语言一部分的特殊值。</p><p id="48b3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这些方法没有一个是没有权衡的[1]。<em class="nc">屏蔽</em>方法需要分配额外的布尔数组，这增加了存储和计算的开销。一个<em class="nc">标记值</em>缩小了可以表示的有效值范围，可能需要 CPU 和 GPU 运算中的额外逻辑。</p><p id="7825" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">Pandas 使用<em class="nc"> sentinels </em>来处理缺失值，更具体地说，Pandas 使用两个已经存在的 Python 空值:</p><ul class=""><li id="d862" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">Python <code class="fe nd ne nf ng b">None</code>对象。</li><li id="5cf0" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">特殊浮点<code class="fe nd ne nf ng b">NaN</code>值，</li></ul><h2 id="f694" class="nh mf it bd mg ni nj dn mk nk nl dp mo ld nm nn mq lh no np ms ll nq nr mu ns bi translated">Python 无对象</h2><p id="d558" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">熊猫使用的第一个<em class="nc"> sentinel </em>值是<code class="fe nd ne nf ng b">None</code>，这是一个 Python <code class="fe nd ne nf ng b">‘object’</code>数据，最常用于 Python 代码中的缺失数据。因为是 Python 对象，<code class="fe nd ne nf ng b">None</code>不能在任何任意的 NumPy/Pandas 数组中使用，只能在数据类型为<code class="fe nd ne nf ng b">‘object’</code>的数组中使用。</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="632f" class="nh mf it ng b gy nx ny l nz oa">import numpy as np<br/>import pandas as pd</span><span id="232e" class="nh mf it ng b gy ob ny l nz oa">arr1 = np.array([1, <strong class="ng iu">None</strong>, 2, 3])<br/>arr1</span></pre><p id="f438" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">会输出</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="48c1" class="nh mf it ng b gy nx ny l nz oa">array([1, None, 2, 3], <strong class="ng iu">dtype=object</strong>)</span></pre><p id="6365" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在数组中使用 Python 对象也意味着，如果执行类似于<code class="fe nd ne nf ng b">sum()</code>或<code class="fe nd ne nf ng b">min()</code>的聚合，通常会出现错误。</p><h2 id="338b" class="nh mf it bd mg ni nj dn mk nk nl dp mo ld nm nn mq lh no np ms ll nq nr mu ns bi translated">Python 浮点 NaN 值</h2><p id="8092" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">熊猫使用的第二个<em class="nc"> sentinel </em>值是<code class="fe nd ne nf ng b">NaN</code>，是<em class="nc">的首字母缩写，而不是数字</em>，一个特殊的浮点值使用标准的 IEEE 浮点表示法。</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="dab8" class="nh mf it ng b gy nx ny l nz oa">arr2 = np.array([1, <strong class="ng iu">np.nan</strong>, 3, 4]) <br/>arr2.dtype</span></pre><p id="8914" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">会输出</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="ae13" class="nh mf it ng b gy nx ny l nz oa">dtype('<strong class="ng iu">float64</strong>')</span></pre><p id="0bf6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请记住，<code class="fe nd ne nf ng b">NaN</code>是一个浮点值；整数、字符串或其他类型没有等价的值。你应该知道，不管运算如何，用<code class="fe nd ne nf ng b">NaN</code>运算的结果将是另一个<code class="fe nd ne nf ng b">NaN</code>。例如</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="2e6b" class="nh mf it ng b gy nx ny l nz oa">arr2.sum()<br/>arr2.min()<br/>arr2.max()</span></pre><p id="ddec" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">将全部输出<code class="fe nd ne nf ng b">NaN</code>。NumPy 确实提供了一些特殊的聚合来忽略缺失的数据，比如<code class="fe nd ne nf ng b">nansum()</code>、<code class="fe nd ne nf ng b">nanmin()</code>和<code class="fe nd ne nf ng b">nanmax()</code>。</p><h2 id="1ae3" class="nh mf it bd mg ni nj dn mk nk nl dp mo ld nm nn mq lh no np ms ll nq nr mu ns bi translated">熊猫中的 None 和 NaN</h2><p id="4b1f" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">Pandas 可以几乎互换地处理<code class="fe nd ne nf ng b">None</code>和<code class="fe nd ne nf ng b">NaN</code>，在适当的时候在它们之间转换:</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="09ce" class="nh mf it ng b gy nx ny l nz oa">pd.Series([1, <strong class="ng iu">np.nan</strong>, 2, <strong class="ng iu">None</strong>])</span><span id="3b7c" class="nh mf it ng b gy ob ny l nz oa">0    1.0<br/>1    NaN<br/>2    2.0<br/>3    NaN<br/>dtype: <strong class="ng iu">float64</strong></span></pre><p id="2f8e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于没有可用 sentinel 值的类型，当<code class="fe nd ne nf ng b">NaN</code>值出现时，Pandas 会自动进行类型转换。</p><p id="3030" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">比如我们用<code class="fe nd ne nf ng b">dtype=int</code>打造一个熊猫系列。</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="9f75" class="nh mf it ng b gy nx ny l nz oa">x = pd.Series(range(2), <strong class="ng iu">dtype=int</strong>)<br/>x</span><span id="bd3a" class="nh mf it ng b gy ob ny l nz oa">0    0<br/>1    1<br/>dtype: <strong class="ng iu">int64</strong></span></pre><p id="0990" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们将一个整数数组中的值设置为<code class="fe nd ne nf ng b">np.nan</code>，它将自动被转换为浮点类型以适应<code class="fe nd ne nf ng b">NaN</code>:</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="ba62" class="nh mf it ng b gy nx ny l nz oa"><strong class="ng iu">x[0] = None</strong><br/>x</span><span id="59df" class="nh mf it ng b gy ob ny l nz oa">0    NaN<br/>1    1.0<br/>dtype: <strong class="ng iu">float64</strong></span></pre><h1 id="0e75" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">处理其他字符表示</h1><p id="41bb" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">并不是所有丢失的值都干净利落地出现<code class="fe nd ne nf ng b">np.nan</code>。如果我们知道哪种字符用作数据集中的缺失值，我们可以在使用<code class="fe nd ne nf ng b">na_values</code>参数创建数据帧时处理它们:</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="05a0" class="nh mf it ng b gy nx ny l nz oa">df = pd.read_csv("source.csv", <strong class="ng iu">na_values = ['?', '&amp;']</strong>)</span></pre><p id="d0f4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当数据帧已经创建时，我们可以使用 pandas <code class="fe nd ne nf ng b">replace()</code>函数来处理这些值:</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="8643" class="nh mf it ng b gy nx ny l nz oa">df_clean = df.replace(<strong class="ng iu">{ "?": np.nan, "&amp;": np.nan }</strong>)</span></pre><h1 id="e477" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">处理缺失值</h1><p id="e016" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">在我们深入细节之前，让我们创建一个带有一些缺失值的数据帧:</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="a50f" class="nh mf it ng b gy nx ny l nz oa">import numpy as np<br/>import pandas as pd</span><span id="cc71" class="nh mf it ng b gy ob ny l nz oa">df = pd.DataFrame(<strong class="ng iu">{'A': [20, 15, 20],<br/>                  'B': [np.nan, 50, 4],<br/>                  'C': [30, 5, 30,],<br/>                  'D': [15, 2, np.nan],<br/>                  'E': [8, 5, 10],<br/>                  'F': [45, 7, np.nan],<br/>                  'G': [35, 10, 35]},</strong><br/>                  index = ['Row 1', 'Row 2',  'Row 3'])<br/>df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/ed18d7463414e1bb9148def79b1026b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*q779gyPXyZORNldKAXLS3Q.png"/></div></figure><h2 id="2e61" class="nh mf it bd mg ni nj dn mk nk nl dp mo ld nm nn mq lh no np ms ll nq nr mu ns bi translated">检测缺失值</h2><p id="1453" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">Pandas 有两个有用的方法来检测缺失值:<code class="fe nd ne nf ng b">isnull()</code>和<code class="fe nd ne nf ng b">notnull()</code>。任何一个都将返回数据的布尔掩码。例如:</p><p id="fd9e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe nd ne nf ng b">df.isnull()</code>返回一个相同大小的布尔数据帧，指示值是否丢失</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/336b62216b717f898047fa3ca6595c10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*lhE8Z0mIni4aJL5dbPIb8g.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated">df.isnull()的输出</p></figure><p id="de93" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe nd ne nf ng b">df.notnull()</code>返回一个大小相同的布尔数据帧，与<code class="fe nd ne nf ng b">isnull()</code>正好相反</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/92cd3ab90bc32e5104456fb1dad833b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*VQSxMTu0qhpQrQ6FcZZ0eg.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated">df.notnull()的输出</p></figure><p id="3334" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当数据集很大时，您可以计算缺失值的数量。</p><p id="aeb0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe nd ne nf ng b">df.isnull().sum()</code>返回每列缺失值的个数(熊猫系列)</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="b51b" class="nh mf it ng b gy nx ny l nz oa">df.isnull()<strong class="ng iu">.sum()</strong></span><span id="441e" class="nh mf it ng b gy ob ny l nz oa">A    0<br/>B    1<br/>C    0<br/>D    1<br/>E    0<br/>F    1<br/>G    0<br/>dtype: int64</span></pre><p id="61f6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe nd ne nf ng b">df.isnull().sum().sum()</code>返回缺失值的总数</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="5209" class="nh mf it ng b gy nx ny l nz oa">df.isnull()<strong class="ng iu">.sum().sum()</strong></span><span id="9a91" class="nh mf it ng b gy ob ny l nz oa">3</span></pre><h2 id="144f" class="nh mf it bd mg ni nj dn mk nk nl dp mo ld nm nn mq lh no np ms ll nq nr mu ns bi translated">丢弃丢失的数据</h2><p id="b569" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">除了之前使用的屏蔽之外，还有一个方便的方法<code class="fe nd ne nf ng b">dropna()</code>来删除丢失的值【2】。该方法定义为:</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="67c4" class="nh mf it ng b gy nx ny l nz oa">dropna(axis=0, how=’any’, thresh=None, subset=None, inplace=False)</span></pre><ul class=""><li id="417b" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated"><code class="fe nd ne nf ng b">axis</code>:行用<code class="fe nd ne nf ng b">0</code>，列用<code class="fe nd ne nf ng b">1</code></li><li id="1e8c" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated"><code class="fe nd ne nf ng b">how</code> : <code class="fe nd ne nf ng b">‘any’</code>用于删除存在 NaN 值的行或列。<code class="fe nd ne nf ng b">‘all’</code>如果所有值都是 NaN，则删除列的行。</li><li id="43e3" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated"><code class="fe nd ne nf ng b">thresh</code>:要求多个非 NaN 值</li><li id="d3ab" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated"><code class="fe nd ne nf ng b">subset</code>:类似数组的值。要考虑的沿其他轴的标签，例如，如果您要删除行，这些将是要包括的列的列表。</li><li id="0d5a" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated"><code class="fe nd ne nf ng b">inplace</code>:如果为真，就地操作，不返回。</li></ul><p id="c3e6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">概括地说，这是我们正在使用的数据框架<code class="fe nd ne nf ng b">df</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/ed18d7463414e1bb9148def79b1026b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*q779gyPXyZORNldKAXLS3Q.png"/></div></figure><p id="91b7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果存在任何 NaN 值，则删除行:</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="91f7" class="nh mf it ng b gy nx ny l nz oa">df.dropna(<strong class="ng iu">axis = 0</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/f715957d00fec8a72c900955ad39bb7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*q7Y8bvJoYxLpbjg0KPdYzg.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated">df.dropna 的输出(轴= 0)</p></figure><p id="4541" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果存在任何 NaN 值，则删除列:</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="b809" class="nh mf it ng b gy nx ny l nz oa">df.dropna(<strong class="ng iu">axis = 1</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/764684262b11f5035bdaccf96a6e9773.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*-FiWLJFfBLAhtUG2SyaC9w.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated"><code class="fe nd ne nf ng b">df.dropna(axis = 1)</code>的输出</p></figure><p id="55eb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果非 NaN 的数量小于 6，则删除该行。</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="ad28" class="nh mf it ng b gy nx ny l nz oa">df.dropna(<strong class="ng iu">axis = 0</strong>, <strong class="ng iu">thresh = 6</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/2fa1bd0a709d05fe3bc5170c58fbcb87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*fAebMzz6Yp3KKy_sTVznhA.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated"><code class="fe nd ne nf ng b">df.dropna(axis = 0, thresh = 6)</code>的输出</p></figure><h2 id="54bb" class="nh mf it bd mg ni nj dn mk nk nl dp mo ld nm nn mq lh no np ms ll nq nr mu ns bi translated">替换丢失的值</h2><p id="b25d" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">数据是宝贵的资产，所以我们不应该轻易放弃它。此外，机器学习模型几乎总是倾向于在更多数据的情况下表现更好。因此，根据具体情况，我们可能更喜欢替换丢失的值，而不是丢弃。</p><p id="c2d0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有一个方便的方法<code class="fe nd ne nf ng b">fillna()</code>来替换丢失的值【3】。该方法定义为:</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="9c99" class="nh mf it ng b gy nx ny l nz oa">fillna(value=None, method=None, axis=None, inplace=False)</span></pre><ul class=""><li id="affb" class="lq lr it kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated"><code class="fe nd ne nf ng b">value</code>:用于替换 NaN 的值</li><li id="176a" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated"><code class="fe nd ne nf ng b">method</code>:用于替换 NaN 的方法。<code class="fe nd ne nf ng b">method='ffill'</code>※正向替换。<code class="fe nd ne nf ng b">method='bfill'</code>进行反向替换。</li><li id="04d0" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated"><code class="fe nd ne nf ng b">axis</code>:行用<code class="fe nd ne nf ng b">0</code>，列用<code class="fe nd ne nf ng b">1</code>。</li><li id="2939" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated"><code class="fe nd ne nf ng b">inplace</code>:如果为真，就地运算，不返回。</li></ul><p id="b9b0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">概括一下，这是我们正在使用的数据图表<code class="fe nd ne nf ng b">df</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/ed18d7463414e1bb9148def79b1026b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*q779gyPXyZORNldKAXLS3Q.png"/></div></figure><p id="7a61" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">用标量替换所有 NaN 值</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="c9bf" class="nh mf it ng b gy nx ny l nz oa">df.fillna(<strong class="ng iu">value=10</strong>) </span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/eebfcbdeb9830dd966ac4597bf698949.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*SWWZACorgYAZn5cqWQx63A.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated"><code class="fe nd ne nf ng b">df.fillna(<strong class="bd on">value=10</strong>)</code>的输出</p></figure><p id="35b7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">To 用前一行中的值替换 NaN 值。</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="df8b" class="nh mf it ng b gy nx ny l nz oa">df.fillna(<strong class="ng iu">axis=0</strong>, <strong class="ng iu">method='ffill'</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/864207e91e410a3e2351e8ecac2ac84b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*t053s95WSn3Yu1givDK7pw.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated"><code class="fe nd ne nf ng b">df.fillna(<strong class="bd on">axis=0</strong>, <strong class="bd on">method=’ffill’</strong>)</code>的输出</p></figure><p id="655d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">用前一列中的值替换 NaN 值。</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="8551" class="nh mf it ng b gy nx ny l nz oa">df.fillna(<strong class="ng iu">axis=1</strong>, <strong class="ng iu">method='ffill'</strong>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/093237af70524295ffceb7e334858ae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*KGbwJhnpliPl7hczcYqerQ.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated"><code class="fe nd ne nf ng b">df.fillna(<strong class="bd on">axis=1</strong>, <strong class="bd on">method=’ffill’</strong>)</code>的输出</p></figure><p id="f83c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">同样，您也可以用下一行或下一列中的值替换 NaN 值。</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="82c5" class="nh mf it ng b gy nx ny l nz oa"># Replace with the values in the next row<br/>df.fillna(<strong class="ng iu">axis=0</strong>, <strong class="ng iu">method='bfill'</strong>)</span><span id="93d7" class="nh mf it ng b gy ob ny l nz oa"># Replace with the values in the next column<br/>df.fillna(<strong class="ng iu">axis=1</strong>, <strong class="ng iu">method='bfill'</strong>)</span></pre><p id="45d6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">另一种常见的替换是用平均值替换 NaN 值。例如，用平均值替换 B 列中的 NaN 值。</p><pre class="kj kk kl km gt nt ng nu nv aw nw bi"><span id="a68f" class="nh mf it ng b gy nx ny l nz oa">df[<strong class="ng iu">'B'</strong>].fillna(value=<strong class="ng iu">df['B'].mean()</strong>, inplace=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/45bc9104c36b5992f050f1febbd22a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*o5HPtWuYX9BBmQo68EB-8Q.png"/></div><p class="oe of gj gh gi og oh bd b be z dk translated"><code class="fe nd ne nf ng b">df[<strong class="bd on">‘B’</strong>].fillna(value=<strong class="bd on">df[‘B’].mean()</strong>, inplace=True)</code>的输出</p></figure><h1 id="3345" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">好了</h1><p id="e637" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">仅此而已。感谢阅读。</p><h1 id="8de9" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">参考资料:</h1><ul class=""><li id="9e81" class="lq lr it kw b kx mw la mx ld oq lh or ll os lp lv lw lx ly bi translated">[1] <a class="ae ot" href="https://jakevdp.github.io/PythonDataScienceHandbook/03.04-missing-values.html" rel="noopener ugc nofollow" target="_blank"> Python 数据科学手册</a></li><li id="57ed" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">熊猫官方文件——dropna</li><li id="3793" class="lq lr it kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">[3] <a class="ae ot" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html" rel="noopener ugc nofollow" target="_blank">熊猫官方文档——菲尔娜</a></li></ul></div></div>    
</body>
</html>