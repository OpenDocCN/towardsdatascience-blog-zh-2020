<html>
<head>
<title>Machine Learning in SQL using PyCaret</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用PyCaret在SQL中进行机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-in-sql-using-pycaret-87aff377d90c?source=collection_archive---------37-----------------------#2020-05-12">https://towardsdatascience.com/machine-learning-in-sql-using-pycaret-87aff377d90c?source=collection_archive---------37-----------------------#2020-05-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b0c2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过在SQL Server中集成PyCaret将您的ML代码发送到数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3d65cd745c12602c27667f3dc55871a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CxB6I95fPzYv_z9C6RRzVg.png"/></div></div></figure><p id="85c6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这篇文章是一个关于如何使用<a class="ae lq" href="https://pycaret.org/" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">【py caret】</strong></a>(Python中的一个低代码ML库)<strong class="kw iu">在SQL Server中训练和部署无监督机器学习聚类模型的<strong class="kw iu">分步教程。</strong></strong></p><p id="4ab3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">我们将在本文中讨论的内容:</strong></p><p id="65a7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">1.如何免费下载并安装SQL Server</p><p id="5aa4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">2.如何创建新数据库并将数据导入数据库</p><p id="5598" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">3.如何在数据库中启用和使用Python脚本</p><p id="d7d4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">4.如何训练聚类分析算法，以便为数据集中的每个观察值分配分类标签</p><h1 id="b1c1" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated"><strong class="ak">一、将代码带入数据——ML使用数据库的案例</strong></h1><p id="0cf2" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">执行ML实验的首选工具/环境是命令行、ide或笔记本。然而，当数据变得非常大时，或者当需要将ML模型投入生产时，这样的工具/环境可能会造成限制。迫切需要能够对数据所在的模型进行编程和训练。MS SQL Server在其SQL Server 2019版中引入了这一功能。使用SQL Server进行机器学习的独特优势在于:</p><p id="9701" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">I .从系统中提取大量数据既繁琐又耗时。在服务器上进行ML实验将代码转化为数据，而不是将数据转化为代码</p><p id="1710" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">二。ML实验大多在计算机/cpu内存中执行。在大型数据集上训练ML算法时，大多数机器都遇到了性能上限。SQL Server数据库上的ML避免了这种情况</p><p id="e342" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">三。很容易将ML管道与其他ETL过程集成和部署在一起</p><h1 id="b35f" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated"><strong class="ak">二。SQL服务器</strong></h1><p id="ae3c" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">SQL Server是一个微软关系数据库管理系统。作为数据库服务器，它执行存储和检索不同应用程序请求的数据的主要功能。在本教程中，我们将通过在SQL Server中导入PyCaret库，使用<a class="ae lq" href="https://www.microsoft.com/en-ca/sql-server/sql-server-downloads" rel="noopener ugc nofollow" target="_blank"><strong class="kw iu">SQL Server 2019</strong><strong class="kw iu">Developer</strong></a>进行机器学习。</p><h1 id="c184" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated"><strong class="ak">三。下载软件</strong></h1><p id="087f" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">如果您以前使用过SQL Server，很可能您已经安装了它，并且可以访问数据库。如果没有，<a class="ae lq" href="https://www.microsoft.com/en-ca/sql-server/sql-server-downloads" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">点击此处</strong> </a>下载SQL Server 2019 Developer或其他版本。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/6a3bf93c2fdc2bfe226a49f727ca84c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*lt9GPAvrhixDQAP6iatTIQ.png"/></div></figure><h1 id="5b35" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated"><strong class="ak">四。设置环境</strong></h1><p id="b4b3" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">在SQL Server中使用PyCaret功能之前，您需要安装SQL Server和PyCaret。这是一个多步骤的过程:</p><h2 id="9442" class="mp ls it bd lt mq mr dn lx ms mt dp mb ld mu mv md lh mw mx mf ll my mz mh na bi translated">步骤1 —安装SQL Server</h2><p id="301d" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">下载SQL Server 2019开发者版文件“<strong class="kw iu">SQL2019-SSEI-Dev.exe</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/4c6fd8d019135c290f86686c7bbe419e.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*WYIssA8f1vpYIPced1miYA.png"/></div></figure><p id="0bbd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">打开文件并按照说明进行安装(建议使用自定义安装选项)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/a938587e43e9f25b0dfb48eae676b0a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*H2mr4UeI3q2DaidWtgldxQ.png"/></div></figure><p id="e9d1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">选择新的SQL Server独立安装</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/55059dd68f1c55ea04412213465df55f.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*bxqUK4NIzdW7DW1LBKObiQ.png"/></div></figure><p id="fe50" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在实例特性选项中，选择包括<strong class="kw iu">机器学习服务和语言扩展</strong>和<strong class="kw iu">机器学习服务器(单机版)</strong>下的<strong class="kw iu"> Python </strong>在内的特性</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/a2fa3d845f694c71b38d04f9f76bdfa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*OCXaVsXQmnGSBa5hPUh4GQ.png"/></div></figure><p id="b1cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">点击<strong class="kw iu">接受</strong>，同意安装Python</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/52b8e3dc7779448b89178c7216b0ab86.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*rYm00TFsLe70EzW1503h1A.png"/></div></figure><p id="dea5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">安装可能需要15-20分钟</p><h2 id="8dc3" class="mp ls it bd lt mq mr dn lx ms mt dp mb ld mu mv md lh mw mx mf ll my mz mh na bi translated">步骤2 —安装Microsoft SQL Server Management Studio(SSMS)</h2><p id="f23e" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated"><a class="ae lq" href="https://docs.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms?redirectedfrom=MSDN&amp;view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">点击这里</strong> </a>或者打开SQL Server安装中心下载“SQL Server管理工具”文件<strong class="kw iu">SSMS-Setup-ENU.exe</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/0323be66e4ae8451431c7d71d7b5ab4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*VydYoU_rbKtzFKgsJ7fPpw.png"/></div></figure><p id="47e7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">打开“<strong class="kw iu">SSMS-Setup-ENU.exe</strong>文件开始安装</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/2a9dcc8627ccebf2f6f069373b9e892f.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*Fnt_PmyaEh8AitkuQIy7og.png"/></div></figure><p id="c338" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">安装可能需要5-10分钟</p><h2 id="59de" class="mp ls it bd lt mq mr dn lx ms mt dp mb ld mu mv md lh mw mx mf ll my mz mh na bi translated">步骤3-为机器学习创建一个数据库</h2><p id="159a" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">一旦您安装了所有的东西，您将需要启动服务器的一个实例。为此，请启动SSMS。在登录阶段，会要求您输入SQL Server的名称，您可以从下拉菜单中选择。一旦建立了连接，您就可以看到服务器上的所有对象。如果您是第一次下载SQL Server，并且没有可以使用的数据库，则需要先创建一个新数据库。</p><p id="db81" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在对象资源管理器面板中，右键单击数据库，然后选择新建数据库</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/25f007937d1c21a62967bac536dc8d17.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*4pzZ6-fk48V3ujaAIUhI2A.png"/></div></figure><p id="bf3c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">输入数据库名称和其他信息</p><p id="2254" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">设置可能需要2-3分钟，包括创建数据库、用户和设置所有权</p><h2 id="3c6d" class="mp ls it bd lt mq mr dn lx ms mt dp mb ld mu mv md lh mw mx mf ll my mz mh na bi translated">步骤4 —导入CSV文件</h2><p id="fa9c" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">现在，您必须使用SQL Server Management Studio将CSV文件导入数据库。</p><p id="7cb2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在数据库中创建一个表"<strong class="kw iu">珠宝</strong>"</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/a4454c7f5c3e0d9f900fdadee2d1431b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*-kkwdIAo4GDkzZ1013GYog.png"/></div></figure><p id="4bee" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">右击数据库，选择<strong class="kw iu">任务</strong> <strong class="kw iu"> - &gt; </strong> <strong class="kw iu">导入数据</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/9b46856967397aa116f59991e34e785f.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*d07HzD7rwEr_SHkGsR_m-Q.png"/></div></figure><p id="fe10" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于数据源，选择<strong class="kw iu">平面文件源</strong>。然后使用<strong class="kw iu">浏览</strong>按钮选择CSV文件。在点击<strong class="kw iu">下一个</strong>按钮之前，花一些时间配置数据导入。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/26987bdd4b580e8ca9d001aae4aed126.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*zNU8RuLdlIDNmoh93Mlu1w.png"/></div></figure><p id="a1d1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">对于目标，请选择正确的数据库提供程序(例如SQL Server Native Client 11.0)。输入<strong class="kw iu">服务器名称</strong>；勾选<strong class="kw iu">使用SQL Server认证</strong>，输入<strong class="kw iu">用户名</strong>、<strong class="kw iu">密码</strong>，以及<strong class="kw iu">数据库</strong>，然后点击<strong class="kw iu">下一步</strong>按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/75f34062fd992d59f1fa3a9ca1aa392a.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*jz9FIU8o-98-H_3vinmUfA.png"/></div></figure><p id="2c29" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在选择源表和视图窗口中，您可以在单击下一个按钮之前编辑映射。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/30ebe30ba8d500ca8f15aa293e606531.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*q1RuWU3dVZmr0zvoVWrBLg.png"/></div></figure><p id="711d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">检查立即运行并点击<strong class="kw iu">下一个</strong>按钮</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/7f304acf9c5255aae89285aba4ba21fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*P9yzJy0imJkl85yGgE6C7g.png"/></div></figure><p id="76cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">单击“完成”按钮运行包</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/e19d4613859a75ec8342a71e560896d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*jBBq5kfftYJNR2DKWYmRuQ.png"/></div><p class="no np gj gh gi nq nr bd b be z dk translated">数据加载结果</p></figure><h2 id="fa75" class="mp ls it bd lt mq mr dn lx ms mt dp mb ld mu mv md lh mw mx mf ll my mz mh na bi translated">步骤5-为Python脚本启用SQL Server</h2><p id="5aeb" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">我们将通过使用<strong class="kw iu">sp _ execute _ external _ script</strong>系统存储过程在SQL Server“内部”运行Python。首先，您需要打开一个'<strong class="kw iu">新查询</strong>'。在实例中执行以下查询，以启用远程脚本执行过程:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="d310" class="mp ls it nt b gy nx ny l nz oa">EXEC sp_configure ‘external scripts enabled’, 1</span><span id="beef" class="mp ls it nt b gy ob ny l nz oa">RECONFIGURE WITH OVERRIDE</span></pre><p id="6dd8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">注意:</strong>在继续下一步之前，重新启动实例。</p><p id="37dd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">可以执行以下SQL语句来检查Python路径并列出已安装的包。</p><p id="c943" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">检查Python路径:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="31fa" class="mp ls it nt b gy nx ny l nz oa">EXECUTE sp_execute_external_script</span><span id="5cec" class="mp ls it nt b gy ob ny l nz oa">@language =N’Python’,</span><span id="a033" class="mp ls it nt b gy ob ny l nz oa">@script=N’import sys; print(“\n”.join(sys.path))’</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/4eb770204a2fc7eae85b88e7bbfd4aa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*WDzLc0EXLpH1Zu3TEbfsiw.png"/></div><p class="no np gj gh gi nq nr bd b be z dk translated">脚本执行结果</p></figure><p id="7041" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">列出已安装的软件包:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="6a3f" class="mp ls it nt b gy nx ny l nz oa">EXECUTE sp_execute_external_script</span><span id="f155" class="mp ls it nt b gy ob ny l nz oa">@language = N’Python’,</span><span id="aa70" class="mp ls it nt b gy ob ny l nz oa">@script = N’</span><span id="8a48" class="mp ls it nt b gy ob ny l nz oa">import pkg_resources</span><span id="3d8d" class="mp ls it nt b gy ob ny l nz oa">import pandas as pd</span><span id="7bf2" class="mp ls it nt b gy ob ny l nz oa">installed_packages = pkg_resources.working_set</span><span id="fd81" class="mp ls it nt b gy ob ny l nz oa">installed_packages_list = sorted([“%s==%s” % (i.key, i.version) for i in installed_packages])</span><span id="71b7" class="mp ls it nt b gy ob ny l nz oa">df = pd.DataFrame(installed_packages_list)</span><span id="f643" class="mp ls it nt b gy ob ny l nz oa">OutputDataSet = df’</span><span id="f5d2" class="mp ls it nt b gy ob ny l nz oa">WITH RESULT SETS (( PackageVersion nvarchar (150) ))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/00b26a7c08a3d8ae261aaa839408bca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*1bSpU8-L-KYpzR_dDPaTPQ.png"/></div><p class="no np gj gh gi nq nr bd b be z dk translated">脚本执行结果</p></figure><h2 id="d1a0" class="mp ls it bd lt mq mr dn lx ms mt dp mb ld mu mv md lh mw mx mf ll my mz mh na bi translated">步骤6-将PyCaret Python包添加到SQL Server</h2><p id="30c3" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">要安装PyCaret包，请打开命令提示符并浏览到安装SQL Server的Python包的位置。默认位置是:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="9508" class="mp ls it nt b gy nx ny l nz oa">C:\Program Files\Microsoft SQL Server\MSSQL15.MSSQLSERVER\PYTHON_SERVICES</span></pre><p id="2d22" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">导航到“<strong class="kw iu">脚本</strong>目录，使用pip命令安装<strong class="kw iu"> PyCaret </strong>包</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="57fd" class="mp ls it nt b gy nx ny l nz oa">pip.exe install pycaret</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/738f8cb671ec6b935aae314774b8fd52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*EZ4cZxBOb6sJ8sTaObM5bA.png"/></div><p class="no np gj gh gi nq nr bd b be z dk translated">命令提示符— PyCaret安装</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/bac1a750b857d40736eb335630d51aeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*fAL6HpAkkuweGH_q90KU-Q.png"/></div><p class="no np gj gh gi nq nr bd b be z dk translated">命令提示符— PyCaret安装结束</p></figure><p id="b673" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">注意</strong>:确保您有权访问SQL Server目录以安装软件包和/或更改配置。否则，软件包安装将会失败。</p><p id="4339" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">安装可能需要5-10分钟</p><p id="02da" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">注意:</strong>万一运行SQL脚本时遇到“<em class="od"> lightgbm </em>”模块丢失的问题。请遵循以下说明:</p><p id="85ae" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一、卸载“<em class="od"> lightgbm </em></p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="cb6f" class="mp ls it nt b gy nx ny l nz oa">pip.exe uninstall lightgbm</span></pre><p id="9f58" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">二。重新安装“<em class="od">灯gbm </em></p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="8e25" class="mp ls it nt b gy nx ny l nz oa">pip.exe install lightgbm</span></pre><p id="f682" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">执行以下SQL以从SQL Server验证PyCaret安装:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="4f8b" class="mp ls it nt b gy nx ny l nz oa">EXECUTE sp_execute_external_script</span><span id="2d83" class="mp ls it nt b gy ob ny l nz oa">@language = N’Python’,</span><span id="1ca1" class="mp ls it nt b gy ob ny l nz oa">@script = N’</span><span id="3073" class="mp ls it nt b gy ob ny l nz oa">import pkg_resources</span><span id="7da7" class="mp ls it nt b gy ob ny l nz oa">pckg_name = “pycaret”</span><span id="9059" class="mp ls it nt b gy ob ny l nz oa">pckgs = pandas.DataFrame([(i.key) for i in pkg_resources.working_set], columns = [“key”])</span><span id="a06b" class="mp ls it nt b gy ob ny l nz oa">installed_pckg = pckgs.query(‘’key == @pckg_name’’)</span><span id="6a83" class="mp ls it nt b gy ob ny l nz oa">print(“Package”, pckg_name, “is”, “not” if installed_pckg.empty else “”, “installed”) ’</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/adb93191f593b2793dde707b61e16a86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*evwN5FoXycMQJETJcjawgA.png"/></div><p class="no np gj gh gi nq nr bd b be z dk translated">脚本执行结果</p></figure><h1 id="654a" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">动词 （verb的缩写）ML实验示例SQL Server中的集群</h1><p id="0cb1" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">聚类是一种机器学习技术，它将具有相似特征的数据点分组。这些分组对于探索数据、识别模式和分析数据子集非常有用。集群的一些常见业务用例有:</p><p id="5d30" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">以营销为目的的✔客户细分。</p><p id="3c4d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">促销和折扣的✔顾客购买行为分析。</p><p id="fac4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">✔在诸如新冠肺炎的流行病爆发中识别地理群集。</p><p id="fb08" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本教程中，我们将使用PyCaret的<a class="ae lq" href="https://raw.githubusercontent.com/pycaret/pycaret/master/datasets/jewellery.csv" rel="noopener ugc nofollow" target="_blank"> Github存储库</a>中的“<strong class="kw iu">jewellery . CSV”</strong>文件。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/52530a685add7894232e2a379f69e970.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*itUa7b3dSjnzKFaaTJOkMg.png"/></div><p class="no np gj gh gi nq nr bd b be z dk translated">珠宝数据集中的样本数据点</p></figure><h2 id="b67e" class="mp ls it bd lt mq mr dn lx ms mt dp mb ld mu mv md lh mw mx mf ll my mz mh na bi translated">1.k均值聚类</h2><p id="f8e7" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">在SQL Server中运行以下SQL代码:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="b5b2" class="mp ls it nt b gy nx ny l nz oa">EXECUTE sp_execute_external_script</span><span id="f40c" class="mp ls it nt b gy ob ny l nz oa">@language = N’Python’,</span><span id="96ca" class="mp ls it nt b gy ob ny l nz oa">@script = N’dataset = InputDataSet</span><span id="c376" class="mp ls it nt b gy ob ny l nz oa">import pycaret.clustering as pc</span><span id="07fd" class="mp ls it nt b gy ob ny l nz oa">dataset = pc.get_clusters(data = dataset)</span><span id="c186" class="mp ls it nt b gy ob ny l nz oa">OutputDataSet = dataset’,</span><span id="4f78" class="mp ls it nt b gy ob ny l nz oa">@input_data_1 = N’SELECT [Age], [Income], [SpendingScore], [Savings] FROM [jewellery]’</span><span id="b751" class="mp ls it nt b gy ob ny l nz oa">WITH RESULT SETS(([Age] INT, [Income] INT, [SpendingScore] FLOAT, [Savings] FLOAT, [Cluster] varchar(15)));</span></pre><h2 id="e059" class="mp ls it bd lt mq mr dn lx ms mt dp mb ld mu mv md lh mw mx mf ll my mz mh na bi translated">2.输出</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/b14f3e79d0369f2841c67cc376cf8d24.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*AwXT-NmfgHJ9LDU6IWrPpA.png"/></div><p class="no np gj gh gi nq nr bd b be z dk translated">SQL语句结果</p></figure><p id="535c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">包含标签的新列'<strong class="kw iu"> Cluster' </strong>'被附加到原始表。</p><p id="a630" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">默认情况下，PyCaret训练一个具有4个聚类<em class="od">的<strong class="kw iu"> K-Means </strong>聚类模型(即表中的所有数据点都被分为4组</em>)。默认值可以很容易地更改:</p><p id="96e1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要更改聚类数，可以使用<strong class="kw iu"> get_ </strong> clusters()函数中的<strong class="kw iu"> num_clusters </strong>参数。</p><p id="f8b9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">要更改模型类型，请使用<strong class="kw iu"> get_clusters()中的<strong class="kw iu">模型</strong>参数。</strong></p><h2 id="a875" class="mp ls it bd lt mq mr dn lx ms mt dp mb ld mu mv md lh mw mx mf ll my mz mh na bi translated"><strong class="ak"> 3。k模式</strong></h2><p id="205d" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">使用<strong class="kw iu"> 6个集群</strong>训练<strong class="kw iu"> K-Modes </strong>模型参见以下代码:</p><pre class="kj kk kl km gt ns nt nu nv aw nw bi"><span id="9741" class="mp ls it nt b gy nx ny l nz oa">EXECUTE sp_execute_external_script</span><span id="78ec" class="mp ls it nt b gy ob ny l nz oa">@language = N’Python’,</span><span id="96ad" class="mp ls it nt b gy ob ny l nz oa">@script = N’dataset = InputDataSet</span><span id="2da7" class="mp ls it nt b gy ob ny l nz oa">import pycaret.clustering as pc</span><span id="1950" class="mp ls it nt b gy ob ny l nz oa">dataset = pc.get_clusters(data = dataset, model=”kmodes”, num_clusters = 6)</span><span id="06f0" class="mp ls it nt b gy ob ny l nz oa">OutputDataSet = dataset’,</span><span id="29d6" class="mp ls it nt b gy ob ny l nz oa">@input_data_1 = N’SELECT [Age], [Income], [SpendingScore], [Savings] FROM [jewellery]’</span><span id="ceeb" class="mp ls it nt b gy ob ny l nz oa">WITH RESULT SETS(([Age] INT, [Income] INT, [SpendingScore] FLOAT, [Savings] FLOAT, [Cluster] varchar(15)));</span></pre><p id="b6c3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">按照这些步骤，您可以为珠宝数据集中的每个观测点分配聚类值。您也可以对其他数据集使用类似的步骤，对它们执行聚类。</p><h1 id="3748" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">不及物动词结论</h1><p id="e75e" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">在这篇文章中，我们学习了如何在SQL Server中运行Python库(PyCaret)来构建集群模型。类似地，根据业务问题的需要，您可以构建和运行其他类型的监督和非监督ML模型。</p><p id="b02b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">您可以进一步查看<a class="ae lq" href="http://pycaret.org/" rel="noopener ugc nofollow" target="_blank"> PyCaret </a>网站，获取关于其他监督和非监督实验的文档，这些实验可以在SQL Server中以类似的方式实现。</p><p id="a926" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我以后的帖子将是在SQL Server中使用Python和Pycaret探索监督学习技术(回归/分类)的教程。</p><h1 id="3c51" class="lr ls it bd lt lu lv lw lx ly lz ma mb jz mc ka md kc me kd mf kf mg kg mh mi bi translated">七。重要链接</h1><p id="9966" class="pw-post-body-paragraph ku kv it kw b kx mj ju kz la mk jx lc ld ml lf lg lh mm lj lk ll mn ln lo lp im bi translated">PyCaret </p><p id="a6ce" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae lq" href="https://pycaret.org/guide/" rel="noopener ugc nofollow" target="_blank"> PyCaret:用户指南和文档</a></p><p id="295f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">PyCaret:教程</p><p id="6c22" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae lq" href="https://www.linkedin.com/in/umarfarooque/" rel="noopener ugc nofollow" target="_blank">我的LinkedIn个人资料</a></p></div></div>    
</body>
</html>