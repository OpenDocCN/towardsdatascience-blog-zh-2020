<html>
<head>
<title>An open-source code to analyze COVID-19 trends — Part I</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分析新冠肺炎趋势的开源代码——第一部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/covid-19-trends-corona-virus-in-numbers-8725c25b636d?source=collection_archive---------40-----------------------#2020-04-05">https://towardsdatascience.com/covid-19-trends-corona-virus-in-numbers-8725c25b636d?source=collection_archive---------40-----------------------#2020-04-05</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="eeeb" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">GitHub和Google联合实验室使用约翰·霍普斯金大学的数据库跟踪新型冠状病毒传播的用例</h2></div><p id="f99d" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi lf translated"><span class="l lg lh li bm lj lk ll lm ln di">我</span>开发了一个python代码库，并将其发布在我的<a class="ae lo" href="https://github.com/sidbannet/COVID-19_analysis" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中，使用由<strong class="kl iv">约翰·霍普斯金大学</strong>维护的<a class="ae lo" href="https://github.com/CSSEGISandData/COVID-19" rel="noopener ugc nofollow" target="_blank">数据库</a>来呈现新型冠状病毒的传播。在本文中，我不提供任何预测模型，而是专注于以有意义的方式提供数据，旨在对新型冠状病毒感染如何在不同地理区域传播做出循证判断。尽管有明显的迹象表明官方数据被严重低估，但这个代码库旨在使新冠肺炎趋势的官方数据和分析工具包民主化。</p><div class="lp lq gq gs lr ls"><a href="https://github.com/sidbannet/COVID-19_analysis" rel="noopener  ugc nofollow" target="_blank"><div class="lt ab fp"><div class="lu ab lv cl cj lw"><h2 class="bd iv gz z fq lx fs ft ly fv fx it bi translated">悉尼/新冠肺炎_分析</h2><div class="lz l"><h3 class="bd b gz z fq lx fs ft ly fv fx dk translated">使用约翰霍普金大学的数据库分析2019年新冠状病毒病例的代码库…</h3></div><div class="ma l"><p class="bd b dl z fq lx fs ft ly fv fx dk translated">github.com</p></div></div><div class="mb l"><div class="mc l md me mf mb mg mh ls"/></div></div></a></div></div><div class="ab cl mi mj hy mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="in io ip iq ir"><p id="fe4f" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">这些数据在各个国家报告的新冠肺炎病例的<em class="mp">地理散点图</em>和时间序列图<em class="mp">中呈现，以比较各个地理区域的传播率。此外，还特别关注美国的利差率。以坚持只回答<em class="mp">“数据怎么说？”</em>我的分析仅限于报告的病例。约翰·霍普斯金大学报告的新冠肺炎病例有三种类型，分别是1) <em class="mp">确诊感染</em>，2) <em class="mp">报告死亡</em>，3) <em class="mp">报告康复</em>。</em></p></div><div class="ab cl mi mj hy mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="in io ip iq ir"><h2 id="802d" class="mq mr iu bd ms mt mu dn mv mw mx dp my ks mz na nb kw nc nd ne la nf ng nh ni bi translated">新冠肺炎教在世界各地传播的地理散点动画。</h2><figure class="nk nl nm nn gu no gi gj paragraph-image"><div class="gi gj nj"><img src="../Images/42e37bdaa932247cab77ea422d76f91d.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*OW7XHffAWUeJGtyCxgziVQ.png"/></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">地理散布图例</p></figure><p id="bd53" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">气泡的颜色代表<em class="mp">3天内感染人数增加的百分比</em>，作为传播率的衡量标准<em class="mp">。</em></p><figure class="nk nl nm nn gu no gi gj paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gi gj nu"><img src="../Images/86e830e11cb8cfac682b00687266ca17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Q6CYNlFQLCBa14SiVoE7MQ.gif"/></div></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">动画展示新冠肺炎确诊病例数。气泡的大小与确诊病例的数量成比例，气泡的颜色显示传播速度</p></figure><figure class="nk nl nm nn gu no gi gj paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gi gj nu"><img src="../Images/2bccb70d61998caa1a217fcef138fa32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*WhbZOqOZm8d_gesAj8NuVA.gif"/></div></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">动画展示新冠肺炎确诊病例数。气泡的大小与新冠肺炎的死亡人数成比例，气泡的颜色显示了传播速度</p></figure></div><div class="ab cl mi mj hy mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="in io ip iq ir"><p id="6c00" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">冠状病毒像任何传染病一样，最初以指数增长速度在给定人群中传播。这意味着每日新增感染病例与特定人群中的感染人数成正比。衡量新冠肺炎病毒传播速度的一个很好的指标是感染人数增加的天数。在本节中，受冠状病毒影响的人数使用时间序列图纵坐标中的<em class="mp">对数</em>标度表示。在横坐标图中，显示了前500例报告病例的天数。当病毒找不到新的感染者时，通常会达到饱和点，然后时间序列纵坐标会在<em class="mp">对数</em>范围内变平。</p><p id="c37c" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">最上面的三个子图显示了每个国家的<em class="mp">确诊病例</em>(左)<em class="mp"/>(中)和<em class="mp"/>(右)的数据。底部的三个子图显示了美国各州的相同指标。这些图中仅显示了截至2020年4月3日确诊病例超过10000例的国家(韩国除外)和至少有5000例确诊病例的美国各州。</p><figure class="nk nl nm nn gu no gi gj paragraph-image"><div role="button" tabindex="0" class="nv nw di nx bf ny"><div class="gi gj nz"><img src="../Images/163ce40d14f3aaeb66d1949aa9e12c83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kOL4ly9serl04DrJf0CUDw.png"/></div></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">自社区爆发开始至2020年4月3日的新冠肺炎趋势</p></figure><figure class="nk nl nm nn gu no gi gj paragraph-image"><div class="gi gj oa"><img src="../Images/4fa8427c8888ae5bb78b073ed677bfce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*5Rd7u3RDedeJyd5kXZec6g.png"/></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">从500例到1万例确诊病例的天数</p></figure><p id="4cc6" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">并非所有国家都遵循上述<em class="mp">对数</em>图中的相同轨迹。影响这些轨迹的因素是a)检测的可用性，b)人口密度和c)采取的政策措施。</p><p id="cfcc" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kl iv">澳洲</strong>、<strong class="kl iv">比利时</strong>和<strong class="kl iv">荷兰</strong>用了16到18天报告了1万例病例，而<strong class="kl iv">美国</strong>、<strong class="kl iv">中国</strong>、<strong class="kl iv">意大利</strong>、<strong class="kl iv">德国</strong>和<strong class="kl iv">西班牙</strong>用了9到12天的时间达到1万例确诊病例。<strong class="kl iv">美国</strong>和<strong class="kl iv">土耳其</strong>显示在第11天左右报告的病例突然增加。这可能是由于冠状病毒检测活动的增加。<strong class="kl iv">加拿大</strong>和<strong class="kl iv">比利时</strong>的病例还在不断出现。根据这些图，<strong class="kl iv">法国</strong>、<strong class="kl iv">英国</strong>、<strong class="kl iv">意大利</strong>和<strong class="kl iv">德国</strong>将在大约30-35天内报告10万个病例。<strong class="kl iv">意大利</strong>的确诊病例轨迹已经显示出大约40天持平的充分证据。<strong class="kl iv">西班牙</strong>目前的传播率高于<strong class="kl iv">意大利</strong>，但也显示出传播率放缓的一些初步迹象。美国正走在一条不同于任何其他国家的轨道上，而且几乎没有迹象显示曲线变平。</p><p id="9fae" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">到目前为止，德国、T42、瑞士、加拿大、澳大利亚在限制新冠肺炎死亡人数增长率方面做得非常好。另一方面，美国没有显示新冠肺炎死亡曲线减缓的证据。</p><figure class="nk nl nm nn gu no gi gj paragraph-image"><div class="gi gj ob"><img src="../Images/2e0967192c5b8ad352e4dd33d8b33f8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*NFNxv_E87po_Cpsy5Jbtrg.png"/></div><p class="nq nr gk gi gj ns nt bd b be z dk translated">从最初的500例增加到5000例的天数</p></figure><p id="f4b7" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">在<strong class="kl iv">美国</strong>范围内，各州的传播率差异很大。纽约<strong class="kl iv">和新泽西</strong>和<strong class="kl iv">的传播率最高，而华盛顿<strong class="kl iv">和</strong>的传播率则截然不同。纽约<strong class="kl iv">用了7天时间</strong>报告了第一万个病例，而华盛顿<strong class="kl iv">从全州第一个500个病例的类似增长可能需要25天以上。在其他州中，<strong class="kl iv">加利福尼亚州</strong>、<strong class="kl iv">佐治亚州</strong>和<strong class="kl iv">得克萨斯州</strong>可以归为一类，它们在大约16-18天内报告了1万例病例。</strong></strong></p></div><div class="ab cl mi mj hy mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="in io ip iq ir"><h1 id="85e1" class="oc mr iu bd ms od oe of mv og oh oi my ka oj kb nb kd ok ke ne kg ol kh nh om bi translated">如何使用开源代码库来重新分析数据</h1><p id="8fbf" class="pw-post-body-paragraph kj kk iu kl b km on jv ko kp oo jy kr ks op ku kv kw oq ky kz la or lc ld le in bi translated">求知欲强的观众可以使用<a class="ae lo" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="kl iv">谷歌</strong> </a>平台重新分析和绘制本文中的人物，代码也发表在GitHub <a class="ae lo" href="https://gist.github.com/sidbannet/2b734d0b9ca8157df8624cea8e5ebfc1" rel="noopener ugc nofollow" target="_blank"> gist </a>上。</p><h2 id="2d97" class="mq mr iu bd ms mt mu dn mv mw mx dp my ks mz na nb kw nc nd ne la nf ng nh ni bi translated">使用谷歌合作实验室的新笔记本，人们可以克隆代码库<a class="ae lo" href="https://github.com/sidbannet/COVID-19_analysis" rel="noopener ugc nofollow" target="_blank">和</a>。</h2><ul class=""><li id="b39b" class="os ot iu kl b km on kp oo ks ou kw ov la ow le ox oy oz pa bi translated">克隆代码和数据仓库</li><li id="fc2c" class="os ot iu kl b km pb kp pc ks pd kw pe la pf le ox oy oz pa bi translated">设置环境</li></ul><pre class="nk nl nm nn gu pg ph pi pj aw pk bi"><span id="4608" class="mq mr iu ph b gz pl pm l pn po"><em class="mp"># Clone repository</em> <br/>!git clone https://github.com/sidbannet/COVID-19_analysis.git <br/>%cd ./COVID-19_analysis<br/>!git submodule init<br/>!git submodule update --remote</span></pre><h2 id="4aa9" class="mq mr iu bd ms mt mu dn mv mw mx dp my ks mz na nb kw nc nd ne la nf ng nh ni bi translated">加载分析和绘图所需的包。</h2><ul class=""><li id="300f" class="os ot iu kl b km on kp oo ks ou kw ov la ow le ox oy oz pa bi translated">分析工具</li><li id="c8ef" class="os ot iu kl b km pb kp pc ks pd kw pe la pf le ox oy oz pa bi translated">绘图工具</li></ul><pre class="nk nl nm nn gu pg ph pi pj aw pk bi"><span id="8104" class="mq mr iu ph b gz pl pm l pn po"><em class="mp"># Import necessary modules</em><br/><strong class="ph iv">from</strong> <strong class="ph iv">tools</strong> <strong class="ph iv">import</strong> collection <strong class="ph iv">as</strong> cll<br/><strong class="ph iv">import</strong> <strong class="ph iv">plotly.tools</strong> <strong class="ph iv">as</strong> <strong class="ph iv">tls</strong><br/><strong class="ph iv">from</strong> <strong class="ph iv">plotly.offline</strong> <strong class="ph iv">import</strong> iplot<br/><strong class="ph iv">import</strong> <strong class="ph iv">plotly.express</strong> <strong class="ph iv">as</strong> <strong class="ph iv">px</strong></span></pre><h2 id="7de7" class="mq mr iu bd ms mt mu dn mv mw mx dp my ks mz na nb kw nc nd ne la nf ng nh ni bi translated">解析数据库中的数据</h2><ul class=""><li id="871f" class="os ot iu kl b km on kp oo ks ou kw ov la ow le ox oy oz pa bi translated">设置包含数据和解析数据的方法的类</li><li id="21f8" class="os ot iu kl b km pb kp pc ks pd kw pe la pf le ox oy oz pa bi translated">解析数据</li></ul><pre class="nk nl nm nn gu pg ph pi pj aw pk bi"><span id="6e62" class="mq mr iu ph b gz pl pm l pn po"><em class="mp"># Setup data class and parse the database</em><br/>d = cll.DataClass()<br/>d.parse()</span></pre><h2 id="f547" class="mq mr iu bd ms mt mu dn mv mw mx dp my ks mz na nb kw nc nd ne la nf ng nh ni bi translated">制作时间序列图</h2><p id="470d" class="pw-post-body-paragraph kj kk iu kl b km on jv ko kp oo jy kr ks op ku kv kw oq ky kz la or lc ld le in bi translated">绘制每个国家和每个美国州的新冠肺炎时间序列数据</p><ul class=""><li id="459e" class="os ot iu kl b km kn kp kq ks pp kw pq la pr le ox oy oz pa bi translated">确诊病例数</li><li id="7665" class="os ot iu kl b km pb kp pc ks pd kw pe la pf le ox oy oz pa bi translated">COVID的死亡人数</li><li id="d812" class="os ot iu kl b km pb kp pc ks pd kw pe la pf le ox oy oz pa bi translated">从COVID中恢复的数量</li></ul><p id="03cc" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">以对数标度绘制这些变量，以突出自首次爆发以来疫情相对于天数的指数增长。</p><pre class="nk nl nm nn gu pg ph pi pj aw pk bi"><span id="434b" class="mq mr iu ph b gz pl pm l pn po"><em class="mp"># Make some meaningful timeseries plots</em> <br/>fig, ax = d.plots_timeseries(<br/>   n_outbreak=500, n_filter_country=10000, n_filter_state=5000) fig.set_size_inches(w=24, h=12) <br/>_ = [axes.set_ylim([10, 50000]) <strong class="ph iv">for</strong> axes <strong class="ph iv">in</strong> ax[:, 1].flat] <br/>_ = ax[0, 0].set_xlim([0, 40]) <br/>_ = ax[0, 0].get_legend().remove() <br/>_ = ax[0, 1].get_legend().remove() <br/>_ = ax[1, 0].get_legend().remove() <br/>_ = ax[1, 1].get_legend().remove()</span></pre><h2 id="72e2" class="mq mr iu bd ms mt mu dn mv mw mx dp my ks mz na nb kw nc nd ne la nf ng nh ni bi translated">地理分散动画，以可视化新冠肺炎的趋势</h2><p id="61f6" class="pw-post-body-paragraph kj kk iu kl b km on jv ko kp oo jy kr ks op ku kv kw oq ky kz la or lc ld le in bi translated">在下面这张<code class="fe ps pt pu ph b">geoscatter</code>动画图像中，气泡的大小代表了报道的新冠肺炎病例数。气泡的颜色代表病例数的每日增长率。动画帧表示从2020年1月22日开始的日期。</p><pre class="nk nl nm nn gu pg ph pi pj aw pk bi"><span id="cd4e" class="mq mr iu ph b gz pl pm l pn po"><em class="mp"># Data frame customized for plotly express geo-scatter</em><br/>df_global = d.df_global.copy()<br/>date_time = [str(date) <strong class="ph iv">for</strong> date <strong class="ph iv">in</strong> df_global.date]<br/>date_str = [str.split(date, ' ')[0] <strong class="ph iv">for</strong> date <strong class="ph iv">in</strong> date_time]<br/>df_global['Date'] = date_str</span><span id="2598" class="mq mr iu ph b gz pv pm l pn po"><em class="mp"># Geo scatter of confirmed cases</em><br/>fig = px.scatter_geo(df_global, locations="iso_alpha", color="rate",<br/>                     color_continuous_scale='jet', range_color=[1.0, 2.0],<br/>                     hover_name="country", size="confirmed",<br/>                     animation_frame="Date",<br/>                     title='Confirmed case',<br/>                     size_max=int(80),<br/>                     width=2000, height=1000,<br/>                     projection="natural earth")<br/>fig.show()</span><span id="e9c0" class="mq mr iu ph b gz pv pm l pn po"><em class="mp"># Geo scatter of deaths</em><br/>fig = px.scatter_geo(df_global, locations="iso_alpha", color="rate",<br/>                     color_continuous_scale='jet', range_color=[1.0, 2.0],<br/>                     hover_name="country", size="death",<br/>                     animation_frame="Date",<br/>                     title='Deaths',<br/>                     size_max=int(80),<br/>                     width=2000, height=1000,<br/>                     projection="natural earth")<br/>fig.show()</span></pre><p id="5ad9" class="pw-post-body-paragraph kj kk iu kl b km kn jv ko kp kq jy kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">— —直到下次</p></div></div>    
</body>
</html>