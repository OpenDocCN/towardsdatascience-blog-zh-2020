<html>
<head>
<title>How to use groupby() and aggregate functions in pandas for quick data analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 pandas 中使用 groupby()和聚合函数进行快速数据分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-groupby-and-aggregate-functions-in-pandas-for-quick-data-analysis-c19e7ea76367?source=collection_archive---------22-----------------------#2020-05-06">https://towardsdatascience.com/how-to-use-groupby-and-aggregate-functions-in-pandas-for-quick-data-analysis-c19e7ea76367?source=collection_archive---------22-----------------------#2020-05-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5045" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">初学者指南使用这个强大的组合在熊猫</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5f910ce4810ba14d11b44f871e6274d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tnIOVB_EpvTqQiALbznoog.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=17482" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="15a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">简介</strong></p><p id="599a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您开始学习 pandas 中的数据分析时，您应该学习的第一个函数是如何使用 groupby()函数以及如何将其结果与聚合函数相结合。这相对来说比较简单，可以让你快速地做一些强大而有效的分析。</p><p id="c313" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将解释:</p><blockquote class="lv lw lx"><p id="649e" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">什么是 groupby()函数，它是如何工作的？</p><p id="2f48" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">什么是聚合函数，它们是如何工作的？</p><p id="c53c" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">如何一起使用 groupby 和 aggregate 函数</p></blockquote><p id="293b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文结束时，您应该能够应用这些知识来分析您选择的数据集。</p><p id="fe66" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始吧。我们将在这里使用虹膜数据集，所以让我们开始加载它在熊猫。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="f925" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">加载虹膜数据集</strong></p><p id="94c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用下面的代码加载 iris 数据集并检查它的前几行:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="c984" class="mo mp it mk b gy mq mr l ms mt">from sklearn import datasets<br/>import pandas as pd</span><span id="ad8a" class="mo mp it mk b gy mu mr l ms mt">data = datasets.load_iris()<br/>df = pd.DataFrame(data.data,columns=data.feature_names)<br/>df['target'] = pd.Series(data.target)<br/>df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/8f81d3ab2d0961e8f78fc2b452a13162.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*4nIV7ENq05YukWORcknt4A.png"/></div></figure><p id="64af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过目测数据集，您可以看到我们拥有的唯一分类变量是目标。您可以使用 unique()函数来检查它取什么值:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="022c" class="mo mp it mk b gy mq mr l ms mt">df.target.unique()<br/>array([0, 1, 2])</span></pre><p id="97be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到它有三个值:0、1 和 2。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="0b99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">使用 groupby() </strong></p><p id="7183" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">既然您已经检查了目标列是分类的以及它取什么值，那么您可以尝试使用 groupby()函数。顾名思义，它应该将你的数据分组。在这种情况下，它将把它分成代表不同花卉种类的三组(我们的目标值)。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="20b8" class="mo mp it mk b gy mq mr l ms mt">df.groupby(df.target)</span><span id="4f72" class="mo mp it mk b gy mu mr l ms mt">&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x1150a5150&gt;</span></pre><p id="7d96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，groupby()函数返回一个 DataFrameGroupBy 对象。乍一看不是很有用。这就是你需要集合函数的原因。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="ec17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">什么是聚合函数？</strong></p><p id="e3cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">聚合函数是接受一系列条目并返回一个以某种方式汇总它们的值的函数。</p><p id="cf7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好的例子有:</p><blockquote class="lv lw lx"><p id="cb44" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">count()，</p><p id="2ec0" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">max()，</p><p id="6b3f" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">min()，</p><p id="13f5" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">均值()，</p><p id="1317" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">std()，</p><p id="2052" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">描述()</p></blockquote><p id="4be3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我提到的，你可以在一系列的条目中使用它们。让我们将它应用于数据集的其中一列:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="cd88" class="mo mp it mk b gy mq mr l ms mt">df['sepal length (cm)'].mean()</span><span id="641f" class="mo mp it mk b gy mu mr l ms mt">5.843333333333334</span></pre><p id="094c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到萼片长度列的平均值是 5.84。</p><p id="c6ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们使用 describe()函数，它将给出更多的汇总统计数据。</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="007c" class="mo mp it mk b gy mq mr l ms mt">df['sepal length (cm)'].describe()</span><span id="3123" class="mo mp it mk b gy mu mr l ms mt">count    150.000000<br/>mean       5.843333<br/>std        0.828066<br/>min        4.300000<br/>25%        5.100000<br/>50%        5.800000<br/>75%        6.400000<br/>max        7.900000<br/>Name: sepal length (cm), dtype: float64</span></pre><p id="7e84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以看到，它给出了与前一个函数相同的平均值和一些附加信息:计数、最小值、最大值、标准值和四分位数范围。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="f0f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">同时使用 groupby()和聚合函数</strong></p><p id="4e73" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在是时候把你学到的东西结合在一起了。好消息是，您可以在 groupby 对象上调用聚合函数，这样您将获得每个组的结果。</p><p id="36c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用 iris 数据集再次证明这一点:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="e41e" class="mo mp it mk b gy mq mr l ms mt">df.groupby(df.target).mean()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/6062724e3d20d953abba7a6831da4c74.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*OygRTrSgjs-CIr13CSsBUw.png"/></div></figure><p id="f956" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如你所见，我们的索引列没有给出组名(在我们的例子中是 0、1 和 2)以及每列和每组的平均值。</p><p id="aa23" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以看到，第 0 组的平均花瓣长度(1.46 厘米)比其他两组的平均花瓣长度(1 (4.26 厘米)和 2(5.52 厘米)小得多。看起来这可能是被分析的花卉之间的一个重要差异。</p><p id="e196" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还可以对 group by 对象使用 describe()来获取我们组的所有描述性统计信息:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="b051" class="mo mp it mk b gy mq mr l ms mt">df.groupby(df.target).describe()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/6b83cc10ae356aa7952b78b50cf9a3d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L6kV0X-yfOEz3tBDxmfvcQ.png"/></div></div></figure><p id="6b62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，该表为您提供了所有组和所有列的描述性统计数据。如果很难读懂，你也可以一次只看一栏:</p><pre class="kj kk kl km gt mj mk ml mm aw mn bi"><span id="1465" class="mo mp it mk b gy mq mr l ms mt">df.groupby(df.target)['sepal length (cm)'].describe()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/e0e7bc7b16f8092fbb2bf87ba9cac28f.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*Z1FLU4e3UtT8L80mwzHfvA.png"/></div></figure></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="07d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您在这些例子中看到的，将 groupby 和 aggregate 函数一起使用非常简单明了。</p><p id="67dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">规则是首先使用 groupby 函数创建 groupby 对象，然后调用聚合函数计算每个组的信息。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="ffb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">总结</strong></p><p id="aacf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，您了解了 groupby 函数，以及如何在 pandas 中将它与聚合函数结合使用。</p><p id="2fea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你能够应用你所学的知识，对你选择的数据集进行快速分析。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="8b0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ly">原载于 aboutdatablog.com: </em> <a class="ae ky" href="https://www.aboutdatablog.com/post/how-to-use-groupby-and-aggregate-functions-in-pandas-for-quick-data-analysis" rel="noopener ugc nofollow" target="_blank">如何在 pandas 中使用 groupby()和 aggregate 函数进行快速数据分析</a>，<em class="ly">2020 年 5 月 6 日。</em></p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="2acd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ly"> PS:我正在 Medium 和</em><a class="ae ky" href="https://www.aboutdatablog.com/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="ly">aboutdatablog.com</em></strong></a><em class="ly">上写文章，深入浅出地解释基本的数据科学概念。你可以订阅我的</em> <a class="ae ky" href="https://medium.com/subscribe/@konkiewicz.m" rel="noopener"> <strong class="lb iu"> <em class="ly">邮件列表</em> </strong> </a> <em class="ly">在我每次写新文章的时候得到通知。如果你还不是中等会员，你可以在这里加入</em><a class="ae ky" href="https://medium.com/@konkiewicz.m/membership" rel="noopener"><strong class="lb iu"><em class="ly"/></strong></a><em class="ly">。</em></p><p id="e435" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面还有一些你可能喜欢的帖子</p><div class="mz na gp gr nb nc"><a rel="noopener follow" target="_blank" href="/sorting-data-frames-in-pandas-a5a3af6f346a"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">对熊猫中的数据框进行排序</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">如何快速有效地排序数据帧</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">towardsdatascience.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq ks nc"/></div></div></a></div><div class="mz na gp gr nb nc"><a rel="noopener follow" target="_blank" href="/7-practical-pandas-tips-when-you-start-working-with-the-library-e4a9205eb443"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">当你开始与图书馆合作时，7 个实用的熊猫提示</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">解释一些乍一看不那么明显的东西…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">towardsdatascience.com</p></div></div><div class="nl l"><div class="nr l nn no np nl nq ks nc"/></div></div></a></div><div class="mz na gp gr nb nc"><a rel="noopener follow" target="_blank" href="/jupyter-notebook-autocompletion-f291008c66c"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd iu gy z fp nh fr fs ni fu fw is bi translated">Jupyter 笔记本自动完成</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">数据科学家的最佳生产力工具，如果您还没有使用它，您应该使用它…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">towardsdatascience.com</p></div></div><div class="nl l"><div class="ns l nn no np nl nq ks nc"/></div></div></a></div></div></div>    
</body>
</html>