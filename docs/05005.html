<html>
<head>
<title>Predicting App Subscription using Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨é€»è¾‘å›å½’é¢„æµ‹åº”ç”¨è®¢é˜…</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/logistic-regression-how-to-on-app-behavior-data-8a95802a988f?source=collection_archive---------37-----------------------#2020-04-30">https://towardsdatascience.com/logistic-regression-how-to-on-app-behavior-data-8a95802a988f?source=collection_archive---------37-----------------------#2020-04-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1102" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">ä½¿ç”¨Sklearnå¯¹åº”ç”¨ç¨‹åºè¡Œä¸ºæ•°æ®è¿›è¡ŒåŠŸèƒ½å·¥ç¨‹ã€æ•°æ®å¤„ç†å’Œé€»è¾‘å›å½’å»ºæ¨¡æ¼”ç»ƒ</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/7a7c7285ec75c30254be57db436f8000.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*B3w2eh1Aj-Jz_t1RMnfkTw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">é€šè¿‡<a class="ae ku" href="https://unsplash.com/photos/F1I4IN86NiE" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a>æ”¹ç¼–è‡ªUnsplashçš„Img</p></figure><p id="e516" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ä¹‹å‰çš„<a class="ae ku" rel="noopener" target="_blank" href="/eda-how-to-on-app-behavior-data-77fde7384a70">æ–‡ç« </a>æ˜¯å…³äºåŸå§‹æ•°æ®ä¸Šçš„EDAã€‚åœ¨è¿™é‡Œï¼Œæˆ‘å°†è§£é‡Šå¦‚ä½•æ‰§è¡Œ<strong class="kx iu">ç‰¹å¾å·¥ç¨‹ã€æ•°æ®å¤„ç†</strong>ï¼Œå¹¶æœ€ç»ˆ<strong class="kx iu">ä½¿ç”¨ç§»åŠ¨appè¡Œä¸ºæ•°æ®åˆ›å»ºé€»è¾‘å›å½’æ¨¡å‹</strong>ã€‚å®ƒåˆ†ä¸º7ä¸ªéƒ¨åˆ†ã€‚</p><ol class=""><li id="6c54" class="lr ls it kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">é—®é¢˜é™ˆè¿°</li><li id="0e5d" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">ç‰¹å¾å·¥ç¨‹</li><li id="cd9b" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">æ•°æ®å¤„ç†</li><li id="06a1" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">æ¨¡å‹ç»“æ„</li><li id="ee90" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">æ¨¡å‹è¯•éªŒ</li><li id="50dd" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">æ¨¡å‹éªŒè¯</li><li id="df6c" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">æ‘˜è¦</li></ol><p id="e341" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹å§ğŸƒâ€â™€ï¸ğŸƒâ€â™‚ï¸.</p><p id="6c6b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">1.<strong class="kx iu">é—®é¢˜é™ˆè¿°</strong></p><p id="ea9c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ä¸€å®¶é‡‘èç§‘æŠ€å…¬å¸å§”æ‰˜æˆ‘ä»¬åˆ†æç§»åŠ¨åº”ç”¨è¡Œä¸ºæ•°æ®ï¼Œä»¥å¸®åŠ©å¼•å¯¼å®¢æˆ·è·å¾—ä»˜è´¹è®¢é˜…æœåŠ¡ã€‚å…·ä½“æ¥è¯´ï¼Œä»»åŠ¡æ˜¯ç¡®å®šå“ªäº›ç”¨æˆ·æœ€æœ‰å¯èƒ½ä¸æ³¨å†Œã€‚å›¾1æ˜¯å…·æœ‰<strong class="kx iu"> <em class="mf"> 12åˆ—å’Œ50ï¼Œ000è¡Œ</em> </strong>çš„åŸå§‹æ•°æ®ç‰‡æ®µã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mg"><img src="../Images/3519a1fc492229b0856be1110d31d6c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WI9Igp2HAE9Xy_DtCgQeVA.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾1åŸå§‹æ•°æ®ç‰‡æ®µ</p></figure><p id="1f21" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">2.<strong class="kx iu">ç‰¹å¾å·¥ç¨‹</strong></p><p id="3f04" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu"> <em class="mf">ç‰¹å¾å·¥ç¨‹æ˜¯å°†åŸå§‹æ•°æ®è½¬åŒ–ä¸ºæœ€èƒ½ä»£è¡¨é—®é¢˜çš„ç‰¹å¾çš„è‰ºæœ¯ã€‚</em> </strong>åªæœ‰ç”¨æ­£ç¡®çš„ç‰¹å¾å·¥ç¨‹ï¼Œæ¨¡å‹æ‰èƒ½åšå‡ºæœ€å¥½çš„é¢„æµ‹ã€‚æˆ‘ä»¬å°†ä»ä¸¤ä¸ªæ–¹é¢è¿›è¡Œç‰¹å¾å·¥ç¨‹ã€‚</p><p id="2683" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">2.1å› å˜é‡å·¥ç¨‹</p><p id="3bbf" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å› å˜é‡æ˜¯åˆ—'<em class="mf">å·²æ³¨å†Œ'</em>ã€‚ä¸'<em class="mf"> enrolled' </em>å¯†åˆ‡ç›¸å…³çš„ä¸€åˆ—æ˜¯'<em class="mf"> enrolled_date' </em>ã€‚åŸºæœ¬ä¸Šï¼Œç”¨æˆ·å¯ä»¥åœ¨ä»»ä½•æ—¥æœŸæŠ¥åï¼Œä»¥'<em class="mf">æŠ¥å'</em>ä¸º1ã€‚ç”±äºå¤§å¤šæ•°åº”ç”¨ç¨‹åºåŠŸèƒ½åœ¨ç¬¬ä¸€ä¸ª24å°æ—¶åä¸å¯è¯•ç”¨ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®æ³¨å†Œçš„æ—¶é—´é™åˆ¶ã€‚</p><p id="9ff0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ä¸ºäº†è®¾ç½®æœ‰æ•ˆçš„ç™»è®°æ—¶é—´é™åˆ¶ï¼Œæˆ‘ä»¬è®¡ç®—'<em class="mf"> first_open 'å’Œ' enrolled_date' </em>ä¹‹é—´çš„æ—¶é—´å·®ï¼Œå¹¶è°ƒæŸ¥ç™»è®°åˆ†å¸ƒã€‚</p><p id="7eb8" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç¬¬ä¸€æ­¥æ˜¯è®¡ç®—'<em class="mf"> first_open 'å’Œ' enrolled_date' </em>ä¹‹é—´çš„æ—¶å·®ã€‚å…·ä½“æ¥è¯´ï¼Œå°†'<em class="mf"> first_open 'å’Œ' enrolled_date' </em>è§£æä¸º<em class="mf"> datetime </em>ç±»å‹ï¼Œå¹¶ä»¥å°æ—¶ä¸ºå•ä½è®¡ç®—æ—¶å·®ã€‚</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="f2a7" class="mq mr it mm b gy ms mt l mu mv">dataset[â€œfirst_openâ€] = [parser.parse(row_date) for row_date in dataset[â€œfirst_openâ€]]</span><span id="52e8" class="mq mr it mm b gy mw mt l mu mv">dataset[â€œenrolled_dateâ€] = [parser.parse(row_date) if isinstance(row_date, str) else row_date for row_date in dataset[â€œenrolled_dateâ€]]</span><span id="de37" class="mq mr it mm b gy mw mt l mu mv">dataset[â€œdifferenceâ€] = (dataset.enrolled_date-dataset.first_open).astype(â€˜timedelta64[h]â€™)</span></pre><p id="c252" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç¬¬äºŒæ­¥æ˜¯é€šè¿‡ç»˜åˆ¶â€œ<em class="mf">å·®å¼‚â€</em>åˆ—çš„ç›´æ–¹å›¾æ¥æŸ¥çœ‹æ³¨å†Œåˆ†å¸ƒã€‚</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="41e3" class="mq mr it mm b gy ms mt l mu mv">response_hist = plt.hist(dataset[â€œdifferenceâ€].dropna(), color=â€™#3F5D7Dâ€™)<br/>plt.title(â€˜Distribution of Time-Since-Screen-Reachedâ€™)<br/>plt.show()</span></pre><p id="edb8" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å›¾2æ˜¾ç¤ºç”¨æˆ·æ³¨å†Œé«˜åº¦é›†ä¸­åœ¨å‰50ä¸ªå°æ—¶ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†å“åº”é™åˆ¶è®¾ç½®ä¸º48å°æ—¶ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mx"><img src="../Images/e384fe3d52b2bec0975725bb2997a92d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SvnAv-OR0vXWWAuwTG9tWw.png"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾2æ³¨å†Œåˆ†å¸ƒ</p></figure><p id="70ba" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç°åœ¨ï¼Œæœ‰äº†48å°æ—¶çš„ç™»è®°é™åˆ¶ï¼Œæˆ‘ä»¬å°†'T38å·²ç™»è®°'T39åˆ—é‡ç½®ä¸º0ï¼Œå³æœªç™»è®°ã€‚</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="9876" class="mq mr it mm b gy ms mt l mu mv">dataset.loc[dataset.difference &gt; 48, â€˜enrolledâ€™] = 0<br/>dataset = dataset.drop(columns=[â€˜enrolled_dateâ€™, â€˜differenceâ€™, â€˜first_openâ€™])</span></pre><p id="fb51" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ä¸Šé¢æˆ‘ä»¬åˆ é™¤äº†<em class="mf">ã€æ³¨å†Œæ—¥æœŸã€‘</em><em class="mf">ã€å·®å¼‚ã€‘ã€é¦–æ¬¡å…¬å¼€ã€‘</em>æ ï¼Œå› ä¸ºåŸ¹è®­ä¸éœ€è¦å®ƒä»¬ã€‚</p><p id="cdcf" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">2.2è‡ªå˜é‡å·¥ç¨‹</p><p id="97bf" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æ•°æ®é›†ä¸­å”¯ä¸€çš„éæ•°å­—åˆ—æ˜¯<em class="mf">â€˜screen _ listâ€™</em>ã€‚è¿™æ˜¯ä¸€ä¸ªåŒ…å«ç”¨æˆ·æŸ¥çœ‹çš„æ‰€æœ‰å±å¹•åŠŸèƒ½çš„åˆ—è¡¨ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠå®ƒè½¬æ¢æˆæ•°å€¼å˜é‡ã€‚ä¸€ç§æ–¹æ³•æ˜¯å°†<em class="mf">â€˜screen _ listâ€™</em>ä¸­çš„æ¯ä¸ªå”¯ä¸€å±å¹•è½¬æ¢ä¸ºåˆ†ç±»å˜é‡ã€‚<em class="mf">ä½†æ˜¯ï¼Œç‹¬ç‰¹çš„å±å¹•å¤ªå¤šäº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†åªå…³æ³¨é‚£äº›æœ€å—æ¬¢è¿çš„å±å¹•ã€‚</em>å…·ä½“æ¥è¯´ï¼Œ</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="8343" class="mq mr it mm b gy ms mt l mu mv">top_screens = pd.read_csv(â€˜top_screens.csvâ€™).top_screens.values<br/>dataset[â€œscreen_listâ€] = dataset.screen_list.astype(str) + â€˜,â€™ <br/>for sc in top_screens:<br/>    dataset[sc] = dataset.screen_list.str.contains(sc).astype(int)<br/>    dataset['screen_list'] = dataset.screen_list.str.replace(sc+",", "")</span></pre><p id="a527" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ä¸Šé¢ï¼Œæˆ‘ä»¬ä¸ºä»£è¡¨æœ€å—æ¬¢è¿å±å¹•çš„<em class="mf">â€˜top _ screensâ€™</em>ä¸­çš„æ¯ä¸ªå±å¹•åˆ›å»ºäº†ä¸€ä¸ªåˆ—ã€‚</p><p id="b3cc" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª<em class="mf">â€˜Otherâ€™</em>åˆ—ï¼Œä½œä¸ºæ‰€æœ‰éæµè¡Œå±å¹•çš„æ€»å’Œã€‚</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="74d0" class="mq mr it mm b gy ms mt l mu mv">dataset[â€˜Otherâ€™] = dataset.screen_list.str.count(â€œ,â€)<br/>dataset = dataset.drop(columns=[â€˜screen_listâ€™])</span></pre><p id="c0dd" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">æœ€åï¼Œå¦‚æœæˆ‘ä»¬ä»”ç»†æ£€æŸ¥åˆ—çš„åç§°ï¼Œæˆ‘ä»¬ä¼šå‘ç°è®¸å¤šåˆ—ä»£è¡¨ç›¸åŒçš„ç‰¹æ€§ã€‚</strong>ä¾‹å¦‚ï¼Œ<em class="mf">ä¿å­˜1 </em>ã€<em class="mf">ä¿å­˜5 </em>æ˜¯å…³äºä¿å­˜çš„å±å¹•ï¼Œè€Œ<em class="mf">ä¿¡ç”¨1 </em>ã€<em class="mf">ä¿¡ç”¨3 </em>æ˜¯å…³äºä¿¡ç”¨çš„å±å¹•ã€‚æˆ‘ä»¬éœ€è¦é€šè¿‡åˆè®¡ç›¸åŒåŠŸèƒ½å±å¹•çš„æ•°é‡æ¥èšåˆç›¸åŒçš„åŠŸèƒ½ã€‚å…·ä½“æ¥è¯´ï¼Œ</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="c626" class="mq mr it mm b gy ms mt l mu mv">cm_screens = [â€œCredit1â€, â€œCredit2â€, â€œCredit3â€, â€œCredit3Containerâ€, â€œCredit3Dashboardâ€]<br/>dataset[â€œCMCountâ€] = dataset[cm_screens].sum(axis=1)<br/>dataset = dataset.drop(columns=cm_screens)</span></pre><p id="586d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å¯¹å…¶ä»–ç‰¹å¾é‡å¤ç›¸åŒçš„æ–¹æ³•(ä¾‹å¦‚ï¼Œ<em class="mf">ä¿å­˜</em>ã€<em class="mf">è´·æ¬¾</em>ç­‰)ï¼Œæˆ‘ä»¬å¾—åˆ°äº†åŒ…å«æ‰€æœ‰æ•°å­—å˜é‡çš„æœ€ç»ˆæ•°æ®é›†ã€‚å›¾3æ˜¾ç¤ºäº†æ‰€æœ‰çš„åˆ—ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/a236e3541634f3054f1e318b29507873.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*eHLeBSJXP4qzZ7XJhh4kkw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾3æ‰€æœ‰æ•°æ®åˆ—åç§°</p></figure><p id="acb5" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æ€»ä¹‹ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•°æ®æŒ–æ˜æŠ€æœ¯æ¥æç‚¼å’Œæå–æœ€èƒ½ä»£è¡¨ç§»åŠ¨åº”ç”¨ç”¨æˆ·è¡Œä¸ºçš„å±æ€§ã€‚</p><p id="31fd" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">3.<strong class="kx iu">æ•°æ®å¤„ç†</strong></p><p id="443b" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æ•°æ®å¤„ç†åŒ…æ‹¬æ•°æ®åˆ†å‰²å’Œç‰¹å¾ç¼©æ”¾ã€‚</p><p id="af6d" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">3.1æ•°æ®åˆ†å‰²</p><p id="14fb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç¬¬ä¸€æ­¥æ˜¯åˆ†ç¦»è‡ªå˜é‡å’Œå› å˜é‡ã€‚å…·ä½“æ¥è¯´ï¼Œ</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="53b6" class="mq mr it mm b gy ms mt l mu mv">response = dataset[â€œenrolledâ€]<br/>dataset = dataset.drop(columns=â€enrolledâ€)</span></pre><p id="14ef" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç¬¬äºŒæ­¥æ˜¯å°†æ•°æ®åˆ†æˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚å…·ä½“æ¥è¯´ï¼Œ</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="5a85" class="mq mr it mm b gy ms mt l mu mv">X_train, X_test, y_train, y_test = train_test_split(dataset, response, test_size = 0.2, random_state = 0)</span></pre><p id="3d22" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">3.2ç‰¹å¾ç¼©æ”¾</p><p id="d0bb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ç‰¹å¾ç¼©æ”¾æ˜¯ä¸ºäº†é¿å…ä»»ä½•å˜é‡æ”¯é…å…¶ä»–å˜é‡ï¼Œå³é‡‡ç”¨æ›´é«˜çš„æƒé‡å’Œå¯¹æ¨¡å‹å­¦ä¹ çš„å¼ºçƒˆå½±å“ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡å»é™¤å¹³å‡å€¼å¹¶ç¼©æ”¾åˆ°å•ä½æ–¹å·®æ¥æ ‡å‡†åŒ–ç‰¹å¾ã€‚å…·ä½“æ¥è¯´ï¼Œ</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="8eff" class="mq mr it mm b gy ms mt l mu mv">from sklearn.preprocessing import StandardScaler<br/>sc_X = StandardScaler()<br/>X_train2 = pd.DataFrame(sc_X.fit_transform(X_train))<br/>X_test2 = pd.DataFrame(sc_X.transform(X_test)) <br/>X_train2.columns = X_train.columns.values<br/>X_test2.columns = X_test.columns.values<br/>X_train2.index = X_train.index.values<br/>X_test2.index = X_test.index.values<br/>X_train = X_train2<br/>X_test = X_test2</span></pre><p id="9ee1" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æ³¨æ„ï¼Œ<em class="mf"> StandardScaler() </em>è¿”å›ä¸€ä¸ª<em class="mf"> numpy </em>æ•°ç»„ï¼Œè¯¥æ•°ç»„ä¼šä¸¢å¤±åˆ—åå’Œç´¢å¼•ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å†æ¬¡å°†ç¼©æ”¾åçš„æ•°æ®è½¬æ¢ä¸º<em class="mf">æ•°æ®å¸§</em>ï¼Œä»¥ä¿ç•™è¡Œå’Œåˆ—æ ‡è¯†ç¬¦ã€‚</p><p id="5a47" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å¤ªå¥½äº†ã€‚æ¨¡å‹çš„æ•°æ®ç»ˆäºå‡†å¤‡å¥½äº†ã€‚å›¾4æ˜¯å…·æœ‰<strong class="kx iu"> <em class="mf"> 50åˆ—å’Œ50ï¼Œ000è¡Œ</em> </strong>çš„æœ€ç»ˆæ•°æ®çš„ç®€è¦è§†å›¾ã€‚</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mz na l"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾4æœ€ç»ˆæ•°æ®çš„ç®€è¦è§†å›¾</p></figure><p id="74cd" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">4.<strong class="kx iu">æ¨¡å‹å»ºç­‘</strong></p><p id="3eb0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">è¿™é‡Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª<strong class="kx iu">é€»è¾‘å›å½’</strong>æ¨¡å‹æ¥é¢„æµ‹ä¸€ä¸ªäºŒå…ƒå› å˜é‡ï¼Œå³æ˜¯å¦å…¥å­¦ã€‚æ ¹æ®<a class="ae ku" href="https://en.wikipedia.org/wiki/Logistic_regression" rel="noopener ugc nofollow" target="_blank">ç»´åŸºç™¾ç§‘</a>ï¼Œæ ‡ç­¾ä¸º1çš„æ¦‚ç‡çš„å¯¹æ•°æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ªç‹¬ç«‹å˜é‡çš„çº¿æ€§ç»„åˆã€‚æœ¬è´¨ä¸Šï¼Œæˆ‘ä»¬è¯•å›¾ä¼°è®¡ä¸€ä¸ªé€»è¾‘æ¨¡å‹çš„ç³»æ•°ï¼Œå¦‚å›¾5æ‰€ç¤ºã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/0d1ea26fc22f444e35858ebb0616b8bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*mtnFy_uS2AjONsAbXS1z3Q.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾5é€»è¾‘å›å½’æ¨¡å‹(ä½œè€…åˆ›å»ºçš„Img)</p></figure><p id="2550" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å…·ä½“æ¥è¯´ï¼Œ</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="0bf0" class="mq mr it mm b gy ms mt l mu mv">from sklearn.linear_model import LogisticRegression<br/>classifier = LogisticRegression(random_state = 0, penalty = â€˜l1â€™)<br/>classifier.fit(X_train, y_train)</span></pre><p id="2893" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æ³¨æ„æˆ‘ä»¬ä½¿ç”¨æ‹‰ç´¢(<em class="mf">ã€L1ã€‘</em>)æ­£åˆ™åŒ–æ¨¡å‹ï¼Œè€Œä¸æ˜¯æ­£æ€å›å½’æ¨¡å‹ã€‚<em class="mf"> L1 </em>æ­£åˆ™åŒ–ç»™æŸå¤±å‡½æ•°å¢åŠ ä¸€ä¸ªç­‰äº<strong class="kx iu"> <em class="mf">ç³»æ•°</em> </strong>å¤§å°çš„ç»å¯¹å€¼ä¹‹å’Œçš„æƒ©ç½šï¼Œå¦‚å›¾6æ‰€ç¤ºã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/d663b1592a8a67aba752a4b04972165f.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*ifPqQKx7urnyUA3HTMlrHw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾L1æ­£åˆ™åŒ–çš„æŸå¤±å‡½æ•°(ä½œè€…åˆ›å»ºçš„Img)</p></figure><p id="4690" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æ³¨æ„<em class="mf"> L1 </em>å’Œ<em class="mf"> L2 </em>æ­£åˆ™åŒ–çš„åŒºåˆ«åœ¨äº<em class="mf"> L2 </em>ç›¸åŠ çš„æƒ©ç½šæ˜¯<strong class="kx iu"> <em class="mf">ç³»æ•°</em></strong><em class="mf"/>å¤§å°çš„å¹³æ–¹å€¼ä¹‹å’Œï¼Œå¦‚å›¾7æ‰€ç¤ºã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/090617b59ea4440d3390f8c3dc42a4cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*cx8p6d-iaLacqn5E6KJIEQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾7 L2æ­£åˆ™åŒ–æŸå¤±å‡½æ•°(ä½œè€…åˆ›å»ºçš„Img)</p></figure><p id="d630" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">5.<strong class="kx iu">æ¨¡å‹æµ‹è¯•</strong></p><p id="c5a4" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">è®­ç»ƒå¥½æ¨¡å‹åï¼Œè®©æˆ‘ä»¬åœ¨<em class="mf"> X_test </em>ä¸Šæµ‹è¯•æ¨¡å‹ã€‚</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="a209" class="mq mr it mm b gy ms mt l mu mv">y_pred = classifier.predict(X_test)<br/>cm = confusion_matrix(y_test, y_pred)</span></pre><p id="5268" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">ä¸ºäº†æ›´å¥½åœ°å›é¡¾é¢„æµ‹ç»“æœï¼Œè®©æˆ‘ä»¬å°†å…¶ä¸å®é™…ç»“æœè¿›è¡Œæ¯”è¾ƒã€‚æ‰€ä»¥ï¼Œå…·ä½“æ¥è¯´ï¼Œ</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="4557" class="mq mr it mm b gy ms mt l mu mv">final_results = pd.concat([y_test, test_identity],axis =1).dropna()<br/>final_results[â€˜predicted_resultsâ€™] = y_pred<br/>final_results[[â€˜userâ€™, â€˜enrolledâ€™,â€˜predicted_resultsâ€™]].reset_index(drop=True)</span></pre><p id="800f" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å›¾8æ˜¾ç¤ºäº†å®é™…ç™»è®°çš„ç»“æœå’Œé¢„æµ‹çš„ç»“æœã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/27938b4f36a2ee6a74e75842648c51d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:554/format:webp/1*9_E9w5j43TgBj9FQHRAFAw.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾8é¢„æµ‹å’Œå®é™…ç»“æœå¯¹æ¯”</p></figure><p id="1db8" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å›¾9å±•ç¤ºäº†æ··æ·†çŸ©é˜µã€‚è¿™å‘Šè¯‰æˆ‘ä»¬æµ‹è¯•ç²¾åº¦ä¸º0.768ã€‚ä¸é”™çš„ç»“æœğŸ˜ƒã€‚å¦‚æœä½ æƒ³çŸ¥é“å¦‚ä½•è®¡ç®—ç²¾åº¦ï¼Œè¯·é˜…è¯»è¿™ç¯‡<a class="ae ku" href="https://medium.com/@vistaxjtu/intuitively-explain-accuracy-precision-recall-and-f1-777563342aca" rel="noopener">æ–‡ç« </a>ã€‚</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/3ede255f851f13e658a631b87d59987e.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/1*EMhjFcROFInuDTdc4fMDYg.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">å›¾9æ··æ·†çŸ©é˜µ</p></figure><p id="1ffa" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">6.<strong class="kx iu">æ¨¡å‹éªŒè¯</strong></p><p id="bdb4" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æœ‰äº†ä¸Šé¢çš„æµ‹è¯•å‡†ç¡®æ€§ï¼Œä½œä¸ºä¸€ä¸ªæ•°æ®ç§‘å­¦å®¶ï¼Œä½ åº”è¯¥é—®ä¸€ä¸ªé—®é¢˜:è¿™æ˜¯æ¨¡å‹æ€§èƒ½çš„çœŸå®åæ˜ å—ğŸ¤”ï¼Ÿä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Kå€äº¤å‰éªŒè¯ã€‚</p><p id="8e6e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">å…·ä½“æ¥è¯´ï¼Œå°†è®­ç»ƒæ•°æ®åˆ†æˆ10ä¸ªå­é›†ï¼Œä½¿ç”¨9ä¸ªå­é›†æ¥è®­ç»ƒæ¨¡å‹ï¼Œå‰©ä½™çš„ç”¨äºéªŒè¯ã€‚é‡å¤è¿™ä¸ªè®­ç»ƒå’ŒéªŒè¯10æ¬¡ã€‚æœ€åå¹³å‡å‡†ç¡®ç‡å’ŒæŸè€—ã€‚</p><pre class="kj kk kl km gt ml mm mn mo aw mp bi"><span id="2c1f" class="mq mr it mm b gy ms mt l mu mv">accuracies = cross_val_score(estimator= classifier, X= X_train, y = y_train, cv = 10)</span></pre><p id="b051" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æˆ‘ä»¬å¾—åˆ°çš„å¹³å‡ç²¾åº¦ä¸º<strong class="kx iu"> 0.767 </strong>ï¼Œæ ‡å‡†åå·®ä¸º<strong class="kx iu"> 0.10 </strong>ã€‚å¾ˆå¥½ï¼Œæ¨¡å‹æ˜¾ç¤ºå‡ºå¾ˆå°çš„å·®å¼‚ï¼Œå³æ¨¡å‹å§‹ç»ˆæ˜¯å‡†ç¡®çš„ã€‚</p><p id="85bb" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">7.<strong class="kx iu">æ€»ç»“</strong></p><p id="62d7" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">æ¦‚æ‹¬åœ°è¯´ï¼Œæˆ‘ä»¬ç»å†äº†ç‰¹å¾å·¥ç¨‹ã€æ•°æ®å¤„ç†ã€æ¨¡å‹æ„å»ºã€æµ‹è¯•å’ŒéªŒè¯ã€‚ç‰¹å¾å·¥ç¨‹å’Œæ•°æ®å¤„ç†æ˜¯è€—æ—¶çš„ï¼Œä½†æ˜¯ä¸ºæ¨¡å‹å‡†å¤‡æ•°æ®æ˜¯æœ€é‡è¦çš„ã€‚å¦‚æœä½ æƒ³äº†è§£æ¨¡å‹ä¼˜åŒ–ï¼Œè¯·é˜…è¯»è¿™ç¯‡<a class="ae ku" rel="noopener" target="_blank" href="/ann-classification-model-evaluation-and-parameter-tuning-9174fd5ad0c2">æ–‡ç« </a>ã€‚</p><p id="1318" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">å¤ªå¥½äº†ï¼è¿™å°±æ˜¯æ‰€æœ‰çš„æ—…ç¨‹ï¼å¦‚æœæ‚¨éœ€è¦æºä»£ç ï¼Œè¯·éšæ—¶è®¿é—®æˆ‘çš„</strong> <a class="ae ku" href="https://github.com/luke4u/Customer_Behaviour_Prediction/tree/main/enrollment_prediction" rel="noopener ugc nofollow" target="_blank"> <strong class="kx iu"> Github </strong> </a> <strong class="kx iu">é¡µé¢ğŸ¤ğŸ¤ã€‚</strong></p></div></div>    
</body>
</html>