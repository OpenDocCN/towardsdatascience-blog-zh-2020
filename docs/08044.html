<html>
<head>
<title>How to Web Scrape in 8 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在8分钟内完成网页抓取</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-web-scrape-in-8-minutes-4a100a672397?source=collection_archive---------9-----------------------#2020-06-14">https://towardsdatascience.com/how-to-web-scrape-in-8-minutes-4a100a672397?source=collection_archive---------9-----------------------#2020-06-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c32e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我将向你展示如何在8分钟内成为一名Python网页抓取者</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/917e9a2c5696d5ab7a2c78626255d91c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h4TLlisFk7XvtREAsS7C7Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">克里斯托弗·高尔摄于Unsplash </p></figure><p id="63f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你知道你现在读的是什么数据吗？对你来说，这可能只是几个词，但在后端，你在网上读到的一切都是可以被提取、分离和操作的数据。这就是Web Scraper，我将向你展示如何在8分钟内成为一名Web Scraper。</p><h1 id="abf0" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">世界计量仪</h1><p id="a601" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><a class="ae ky" href="https://www.worldometers.info/world-population/" rel="noopener ugc nofollow" target="_blank"> Wordometers </a>是一个提供生活世界统计数据的网站，也是我们要刮的网站。具体来说，我们将收集表格中的世界人口数据(如下所示)。从表格中抓取数据是最常用的网络抓取形式之一，因为通常我们在表格中需要的数据是不可下载的。因此，我们让计算机在几秒钟内完成，而不是手动获取数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/6c0c6c35a1e3ccdafdd0a7c11144d2f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uvyZt31hnB-EJai82Cw5HA.jpeg"/></div></div></figure><h1 id="fc3b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">美味的汤</h1><p id="bf37" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我知道这是一个奇怪的名字，但Beautiful Soup是最强大的网络抓取库之一，在我看来也是最容易学习的，这就是为什么我们要使用它。但是首先我们必须安装它。</p><p id="771c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要在您的计算机上安装Beautiful Soup，请进入您的Anaconda控制台(只需在任务栏中搜索),并分别键入每一行代码。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="bf23" class="my lw it mu b gy mz na l nb nc">pip install beautifulsoup4 <br/>pip install lxml<br/>pip install requests</span></pre><p id="4112" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果事情最终出错了，这里有一个文档的链接，它会告诉你问题是什么以及如何解决:<a class="ae ky" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" rel="noopener ugc nofollow" target="_blank">美汤文档</a></p><h1 id="d782" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">Python代码</h1><p id="f675" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在我们已经完成了设置，我们终于可以开始编写代码来清理表格了。</p><p id="a996" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们首先导入刚刚安装的库和其他一些需要的库。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="0beb" class="my lw it mu b gy mz na l nb nc">import requests<br/>from bs4 import BeautifulSoup<br/>import pandas as pd</span></pre><p id="a828" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们希望获得我们正在抓取数据的网站，为此，我们使用一个名为<strong class="lb iu"> requests.get() </strong>的函数，当输入一个url时，我们就可以访问网站上的数据。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="22f4" class="my lw it mu b gy mz na l nb nc">url = 'https://www.worldometers.info/world-population/'<br/>requests.get(url)<br/>page = requests.get(url)</span></pre><p id="8855" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要查看请求是否成功，在使用适当的url运行代码后，应该会弹出这个窗口。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="211c" class="my lw it mu b gy mz na l nb nc">Response [200]</span></pre><p id="bd96" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，如果它说响应[404],这意味着它不能给你访问该网站，你不能抓取数据。</p></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><p id="4316" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经可以访问网站的数据，我们实际上必须去获取数据。为了做到这一点，我们使用了一个解析器，它将遍历网站的HTML代码，并给出网站上的所有数据。</p><p id="0b5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">解析器将抓取与网站上看到的所有数据相对应的后端数据</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/2b9bcc9f3496231ecab6e3802355764d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ije5H_Dg4xkecpqESHNSCg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">突出显示的蓝线是与网站上看到的人口文本相对应的HTML代码</p></figure><p id="8295" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们将使用Beautiful Soup的地方，因为我们将使用它的“lxml”解析器。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="638b" class="my lw it mu b gy mz na l nb nc">soup = BeautifulSoup(page.text, 'lxml')</span></pre><p id="d77d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个soup变量现在拥有了来自网站的所有数据。如果你输入<strong class="lb iu"> print(soup) </strong>就可以看到这一点，因为会弹出这样的行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/d67ef511f9e186f966b62a35e551a344.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mp_qRi5jPI7LNOQPInnS4A.png"/></div></div></figure><p id="89de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目前我们在网站上有所有的数据，只是HTML格式的。所以现在我们必须分离HTML来得到我们想要的数据，也就是表中的数据。</p><h1 id="0e14" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">超文本标记语言</h1><p id="dba0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">要理解代码的下一部分，你必须对HTML格式有一个简单的了解。</p><p id="d0dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">HTML使用标签来保存信息并确定它在站点上的位置。</p><p id="ef84" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，顶部的紫色文本表示table是一个标记，它下面的所有内容都是包含表内数据的其他标记。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/52e1a8b8e122d3a81bcbb944bef38738.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6qJzE0aqTV_wfGn3FeBupg.png"/></div></div></figure><p id="876e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要真正看到哪段HTML代码对应于页面上的一段特定数据，一个技巧是在站点的任何地方单击鼠标右键，然后按inspect。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/ca979f32b35edb1f7d8f64976dabe59d.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*e-95S4xG8eAlSfT7WT3zWA.png"/></div></figure><p id="6056" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将打开网站的HTML，在右边可以看到。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/2b9bcc9f3496231ecab6e3802355764d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ije5H_Dg4xkecpqESHNSCg.png"/></div></div></figure><p id="8544" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这项功能只在谷歌浏览器中有效，但是在弹出的HTML框的左上角有一个类似这样的图标。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/81a882dc8d68ad636f8d13b6763b11d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:200/format:webp/1*E4459wuoaSfGPsonbzMt4w.png"/></div></figure><p id="03c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当图标被按下时，你可以点击网站上的任何一条信息，与该条信息相对应的HTML将以蓝色突出显示，如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/7be4ee82d5e5e90aa7fc06aa29bbec87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zK722y6LSFKWaUanh_89yw.png"/></div></div></figure><h1 id="a747" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">返回代码</h1><p id="765c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在我们对HTML格式有了一个简单的了解，我们将使用它来获取表中的标签。我们通过使用一个名为<strong class="lb iu"> find()的函数来做到这一点。</strong> Find将遍历HTML，只返回您想要查找的HTML。不言自明。</p><p id="e3eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看上面的照片，我们看到我们想要的表对应于那个表标签和那个唯一的类名(每个表都有一个唯一的类名以区别于其他表)。为了获得HTML和表中的数据，我们编写…</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="fa8d" class="my lw it mu b gy mz na l nb nc">table_data = soup.find('table', class_ = 'table table-striped table-bordered table-hover table-condensed table-list')</span></pre><p id="a3e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用soup.find，因为如果你还记得我们在soup变量中从站点中获取的所有HTML。</p><p id="abdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们只有我们想要的HTML和数据，我们可以开始获取数据，并把它放在一个漂亮干净的数据框架中，类似于网站上的那个。</p><h2 id="cd54" class="my lw it bd lx nq nr dn mb ns nt dp mf li nu nv mh lm nw nx mj lq ny nz ml oa bi translated">头球</h2><p id="1352" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">首先，我们将编写一段代码来获取表格的列标题。这些标题有一个标签“th ”,你可以通过点击左上角的小图标看到它，就像我上面展示的那样，然后点击任何一个标题。</p><p id="cddd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为所有的头都有相同的标签，我们将遍历每个头，并把它添加到一个列表中。为此，我们将使用<strong class="lb iu"> find_all() </strong>函数。就像find()函数一样，它会找到你要找的东西，但现在它会返回它的所有情况。</p><p id="b4fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这段代码看起来像这样…</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="027f" class="my lw it mu b gy mz na l nb nc">headers = []<br/>for i in table_data.find_all('th'):<br/>    title = i.text<br/>    headers.append(title)</span></pre><p id="f127" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">headers变量首先是一个空列表，我们将把它添加到。下一行是一个for循环，它将遍历所有带有“th”标签的数据。在这种情况下，只有标题具有“th”标签。这段数据将存储在I变量中，我们使用i.text将头转换成python中的字符串。最后，我们将标题添加到标题列表中。</p><p id="e3da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们有了所有标题的列表，我们将开始通过编写来创建数据帧</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="fa0c" class="my lw it mu b gy mz na l nb nc">df = pd.DataFrame(columns = headers)</span></pre><p id="f3fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将创建一个空的dataframe，用我们的标题列表作为列名。</p><h2 id="2485" class="my lw it bd lx nq nr dn mb ns nt dp mf li nu nv mh lm nw nx mj lq ny nz ml oa bi translated">身体</h2><p id="f889" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">最后一步是获取表体。用于此目的的代码类似于获取头的代码。表格中的每一行对应一个“tr”标签。我们将再次使用find_all()函数来获取表中所有的“tr”标记和行。这里的区别是我们将再次使用find_all()函数。这是因为我们不能一次抓取整行。在“tr”标记内是“td”标记，它们实际上对应于行中的特定数据。这是我们需要得到的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/b15d367463b5ff45745908113e74a785.png" data-original-src="https://miro.medium.com/v2/resize:fit:328/format:webp/1*kdI06bivrn7W3o3uUH0t7w.png"/></div></figure><p id="a5be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，我们将在“td”标签上使用find_all()函数来获取一行中的所有数据。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="3bd4" class="my lw it mu b gy mz na l nb nc">for j in table_data.find_all('tr'):<br/>        row_data = j.find_all('td')</span></pre><p id="db93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们已经有了行中的数据，我们只需要把它放入一个列表中，下面的行将为我们完成这项工作。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="3078" class="my lw it mu b gy mz na l nb nc">row = [tr.text for tr in row_data]</span></pre><p id="d057" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们只需将行添加到数据帧中，就完成了。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="790c" class="my lw it mu b gy mz na l nb nc">length = len(df)<br/>df.loc[length] = row</span></pre><p id="de6f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们创建了一个与网站上的表格完全相同的表格。</p><h2 id="df5f" class="my lw it bd lx nq nr dn mb ns nt dp mf li nu nv mh lm nw nx mj lq ny nz ml oa bi translated">站点表:</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/6c0c6c35a1e3ccdafdd0a7c11144d2f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uvyZt31hnB-EJai82Cw5HA.jpeg"/></div></div></figure><h2 id="0109" class="my lw it bd lx nq nr dn mb ns nt dp mf li nu nv mh lm nw nx mj lq ny nz ml oa bi translated">Web抓取的表格:</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/16a762ae777ba91c8e5965aebf1badca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FPMxJ57SPh-4J32ji21rFA.png"/></div></div></figure><h2 id="f0cb" class="my lw it bd lx nq nr dn mb ns nt dp mf li nu nv mh lm nw nx mj lq ny nz ml oa bi translated">最终代码:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="od oe l"/></div></figure></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="08ad" class="lv lw it bd lx ly of ma mb mc og me mf jz oh ka mh kc oi kd mj kf oj kg ml mm bi translated">Python A-Z Bootcamp 2023中的网页抓取</h1><p id="cca9" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果你觉得这篇文章很有用，并且对学习网页抓取感兴趣，我有一个课程教你如何从完全的初学者到高级的网页抓取者，课程教你一步一步如何用它赚钱。</p><p id="33ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请点击下面的链接查看！</p><div class="ok ol gp gr om on"><a href="https://christopher-zita-24ef.mykajabi.com/web-scraping-in-python-course" rel="noopener  ugc nofollow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd iu gy z fp os fr fs ot fu fw is bi translated">Python课程中的网络抓取</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">介绍你准备好学习当今就业市场最受欢迎的技术技能之一了吗？这个15小时的训练营…</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">christopher-zita-24ef.mykajabi.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb ks on"/></div></div></a></div></div></div>    
</body>
</html>