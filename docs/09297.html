<html>
<head>
<title>Handling Multi-Collinearity in ML Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ML 模型中多重共线性的处理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/handling-multi-collinearity-6579eb99fd81?source=collection_archive---------17-----------------------#2020-07-03">https://towardsdatascience.com/handling-multi-collinearity-6579eb99fd81?source=collection_archive---------17-----------------------#2020-07-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d687" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">提高线性回归模型可解释性的简单方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f52274bf68bbd93f21ce642850a2d91e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xE9gipspOaa9ejuvjezoMw@2x.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自 Unsplash</p></figure><p id="17e7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lu" href="https://medium.com/@pardeshi.vishwa25/linear-regression-model-for-ml-cd18a392bd8b?source=friends_link&amp;sk=7682368acebef7c531b02da7788892bf" rel="noopener">多元线性回归</a>模型用于模拟响应/因变量和解释/自变量之间的关系。然而，多重共线性、误差项方差相关性、非线性等问题影响了模型的可解释性。本文将讨论多重共线性、多重共线性的影响以及处理多重共线性的技术。</p><h1 id="7bba" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">什么是多重共线性？</h1><p id="35cb" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">当被假定为相互独立的解释变量被揭示为相互密切相关时，这种相关性被称为共线性。当观察到两个或更多解释变量的相关性时，称为多重共线性。</p><p id="ff3b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">多重共线性尤其不可取，因为<strong class="la iu">它会影响线性回归模型的可解释性。</strong>线性回归模型不仅有助于建立响应变量和解释变量之间的关系，还有助于确定每个解释变量对响应变量的个别影响。</p><p id="3a1c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，由于多重共线性的存在，很难分离出这些单独的影响。换句话说，多重共线性可以被视为一种现象，其中两个或更多的解释变量彼此高度线性相关，以至于一个解释变量可以从另一个解释变量以相当高的准确度预测。</p><h1 id="567d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">多重共线性的影响</h1></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><blockquote class="mz"><p id="5c3b" class="na nb it bd nc nd ne nf ng nh ni lt dk translated">由于共线性/多重共线性的存在，很难隔离解释变量对响应变量的个别影响。</p></blockquote></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="ffa2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">多重共线性会导致以下结果:</p><ol class=""><li id="553d" class="nj nk it la b lb lc le lf lh nl ll nm lp nn lt no np nq nr bi translated"><strong class="la iu">系数估计的不确定性或不稳定方差:</strong>数据的微小变化(添加/删除行/列)会导致系数的变化。</li><li id="186c" class="nj nk it la b lb ns le nt lh nu ll nv lp nw lt no np nq nr bi translated"><strong class="la iu">标准误差增加:</strong>降低估计的准确性，增加检测的机会。</li><li id="0c35" class="nj nk it la b lb ns le nt lh nu ll nv lp nw lt no np nq nr bi translated"><strong class="la iu">统计显著性下降:</strong>由于标准误差增加，t-统计下降，这对检测系数中的统计显著性的能力产生负面影响，导致 II 型误差。</li><li id="3b88" class="nj nk it la b lb ns le nt lh nu ll nv lp nw lt no np nq nr bi translated"><strong class="la iu">缩减系数&amp; p 值:</strong>由于共线性，相关解释变量的重要性被掩盖。</li><li id="c37f" class="nj nk it la b lb ns le nt lh nu ll nv lp nw lt no np nq nr bi translated"><strong class="la iu">过度拟合:</strong>导致过度拟合，如高方差问题所示。</li></ol><h1 id="cbfb" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">如何检测多重共线性？</h1><p id="6cab" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">除了观察上述影响的模型行为之外，多重共线性也在相关值中进行了定量捕捉。因此，可以使用以下内容:</p><p id="1fa7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">相关矩阵:</strong></p><p id="3b0f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据中两个变量之间的皮尔逊相关性在-1 到 1 之间变化。两个变量的数据类型应为数值型，以便计算皮尔逊相关值。</p><p id="57bb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里，使用 r 的<a class="ae lu" href="http://archive.ics.uci.edu/ml/datasets/Auto+MPG" rel="noopener ugc nofollow" target="_blank">自动 MPG </a>数据集的相关矩阵。列名包含字符串，因此被删除。响应变量是 mpg，它代表燃油消耗效率。</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="264e" class="oc lw it ny b gy od oe l of og">#data = Auto<br/>#generate correlation matrix in R</span><span id="bb4f" class="oc lw it ny b gy oh oe l of og">correlation_matrix &lt;- cor(Auto[, -which(names(Auto) == "name")])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/b091290c38c00278ac56c443930ad7f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e-WgaWOFOlSI8XjlsndVLg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Autompg 数据集的相关矩阵；作者图片</p></figure><p id="b7aa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">可以观察到气缸和排量、马力和重量之间的高度相关性。此外，还有几对具有高度正/负相关性的解释变量。因此，存在多重共线性。</p><p id="c9ab" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，正如人们会注意到的，对 8 个变量来说，浏览表格并识别这些变量是令人厌倦的，而且随着变量数量的增加，情况只会变得更糟。因此，关联热图是更直观的关联表示。</p><p id="ba20" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">关联热图:</strong></p><p id="28f5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">关联热图通过调整正负关联的颜色和大小来帮助更好地可视化数据。</p><p id="4da6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在 R 中，corrplot 包可以用来创建相关性的热图。</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="8fd9" class="oc lw it ny b gy od oe l of og">library(corrplot)<br/>corrplot(correlation_matrix, type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/97fcdef5cc24e6bf04a2c036f7a62d17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i9EvzbYJTFehC1X6GUafWw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Autompg 数据集的关联热图；作者图片</p></figure><p id="5d8c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">热图无疑更加直观和可视化。但是，它有助于严格识别 2 个变量之间的相关性，而<strong class="la iu">无法识别 3 个或更多变量之间存在的共线性，对此可以使用方差膨胀因子。</strong></p><p id="761a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">方差膨胀因子(VIF): </strong> VIF 是拟合完整模型时系数估计的方差除以系数估计的方差(如果单独拟合的话)的比值。最小可能值为 1，表示没有共线性。如果值超过 5，则应解决共线性问题。</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="6a0c" class="oc lw it ny b gy od oe l of og">library(rms)<br/>multiple.lm &lt;- lm(mpg ~ . -name, data = Auto)<br/>summary(multiple.lm)<br/>vif(multiple.lm)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/c227f269448de345226011cf0c6e15b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kyXQmJYdxulPILxuq495fA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Autompg 数据集的 VIF 值；作者图片</p></figure><p id="0a04" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">气缸、排量、马力和重量的 VIF 值远高于 5，因此应该处理，因为数据中的共线性很高。</p><h1 id="1a02" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">处理多重共线性</h1><p id="b123" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">多重共线性可以用以下两种方法处理。注意，自变量之间的这种相关性会导致数据冗余，消除这种冗余有助于消除多重共线性。</p><ol class=""><li id="6f9a" class="nj nk it la b lb lc le lf lh nl ll nm lp nn lt no np nq nr bi translated"><strong class="la iu">引入惩罚或删除高度相关的变量:</strong>使用 lasso 和岭回归来删除提供冗余信息的变量。这也可以通过观察 VIF 来实现。</li><li id="8216" class="nj nk it la b lb ns le nt lh nu ll nv lp nw lt no np nq nr bi translated"><strong class="la iu">组合高度相关变量:</strong>由于共线变量包含冗余信息，使用 PCA 等方法将其组合成单个变量，生成自变量。</li></ol></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="fd00" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于在 R 中实现的 Autompg 线性回归模型，请查看这个 Github 库。 <strong class="la iu">该库探究多重共线性以及线性回归模型的交互项和非线性转换。</strong></p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h2 id="8d9e" class="oc lw it bd lx ol om dn mb on oo dp mf lh op oq mh ll or os mj lp ot ou ml ov bi translated">参考:</h2><p id="bd9a" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">R 中的统计学习导论。</p></div></div>    
</body>
</html>