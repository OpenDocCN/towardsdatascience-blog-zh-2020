<html>
<head>
<title>How to Import Data with the pandas read_csv Command</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 pandas read_csv 命令导入数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-import-data-with-the-pandas-read-csv-command-a7befde122f1?source=collection_archive---------47-----------------------#2020-06-21">https://towardsdatascience.com/how-to-import-data-with-the-pandas-read-csv-command-a7befde122f1?source=collection_archive---------47-----------------------#2020-06-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5ff0" class="pw-subtitle-paragraph ju is it bd b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dk translated">熊猫基础:读取数据文件</h2></div><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/9ab90122b07d41d38583621991b0c97c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YRuguxwiKgPfAYCpm9qygg.jpeg"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">马库斯·斯皮斯克在<a class="ae lc" href="/s/photos/analysis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="fed4" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在任何数据分析项目中，我们都试图从一组给定的数据中发现有用的、可操作的见解。如果我们幸运的话，这些数据可能已经为我们打包好了；如果没有，我们可能需要自己收集。无论哪种方式，一旦数据被存储，我们将需要把它读入一个程序来执行分析。</p><p id="7c60" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">软件包<em class="lz"> pandas </em>经常用于此目的。这是一个功能强大的库，可以与 Python 编程语言一起工作。在<em class="lz"> pandas </em>中，选择读入数据文件的工具是无处不在的<code class="fe jq jr js jt b">read_csv</code>函数。</p><blockquote class="ma"><p id="4c34" class="mb mc it bd md me mf mg mh mi mj ly dk translated">在本文中，我们将探索 pandas 的<code class="fe jq jr js jt b">read_csv</code>命令的基础:标题选项、指定子目录(如果适用的话)、使用逗号以外的分隔符、标识要用作索引的列、定义字段类型以及处理缺失值。</p></blockquote><h1 id="6014" class="mk ml it bd mm mn mo mp mq mr ms mt mu kd mv ke mw kg mx kh my kj mz kk na nb bi translated">数据</h1><p id="4870" class="pw-post-body-paragraph ld le it lf b lg nc jy li lj nd kb ll lm ne lo lp lq nf ls lt lu ng lw lx ly im bi translated">与任何熊猫项目一样，我们首先使用标准别名<code class="fe jq jr js jt b">pd</code>导入熊猫。让我们也使用数字包 NumPy 的标准别名来导入它。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="3edf" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">对于我们的例子，让我们读入股票价格<a class="ae lc" href="https://www.kaggle.com/camnugent/sandp500" rel="noopener ugc nofollow" target="_blank">数据</a>。这个数据集列出了交易的日期、开盘价、收盘价、最高价和最低价、交易量以及交易代码。</p><p id="7ccf" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">在电子表格程序中显示的前几行数据如下所示。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nj"><img src="../Images/32ed1c8f4feccc1d51dc0dd5e07b68b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aP-Dfo6nhGl1xLlUU4Jf-Q.png"/></div></div></figure><h1 id="ad95" class="mk ml it bd mm mn mo mp mq mr ms mt mu kd nk ke mw kg nl kh my kj nm kk na nb bi translated">什么是. csv 文件？</h1><p id="c42f" class="pw-post-body-paragraph ld le it lf b lg nc jy li lj nd kb ll lm ne lo lp lq nf ls lt lu ng lw lx ly im bi translated">如果我们在文本编辑器中查看数据文件(与上面的电子表格程序相反)，前几行如下。</p><pre class="kn ko kp kq gt nn jt no np aw nq bi"><span id="2cb0" class="nr ml it jt b gy ns nt l nu nv">date,open,high,low,close,volume,Name<br/>2013–02–08,15.07,15.12,14.63,14.75,8407500,AAL<br/>2013–02–11,14.89,15.01,14.26,14.46,8882000,AAL<br/>2013–02–12,14.45,14.51,14.1,14.27,8126000,AAL<br/>2013–02–13,14.3,14.94,14.25,14.66,10259500,AAL<br/>2013–02–14,14.94,14.96,13.16,13.99,31879900,AAL</span></pre><p id="9f3f" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我们看到第一行由列名组成，也称为<em class="lz">字段</em>名称。包含列名的这一行被称为<em class="lz">标题</em>。接下来的行列出了对应于该行中每个字段的数据。因此，第一行数据的日期为 2013 年 2 月 8 日，开盘价为 15.07 美元，以此类推。每个数据点与下一个数据点之间用逗号分隔，因此称为“逗号分隔值”(csv)文件。</p><h1 id="beb3" class="mk ml it bd mm mn mo mp mq mr ms mt mu kd nk ke mw kg nl kh my kj nm kk na nb bi translated">标题选项</h1><p id="7587" class="pw-post-body-paragraph ld le it lf b lg nc jy li lj nd kb ll lm ne lo lp lq nf ls lt lu ng lw lx ly im bi translated">pandas 命令从文件中读取数据并将其存储在一个名为<code class="fe jq jr js jt b">stocks_df</code>的数据帧中，这是一个简单的命令行程序。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="326a" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">为了确保该命令按预期工作，让我们使用<code class="fe jq jr js jt b">head</code>检查数据帧的前几行。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="43f9" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">您可能不会对。csv 文件。在这种情况下，通过使用<code class="fe jq jr js jt b">usecols</code>选项指定想要读入数据框的列。例如，如果您只对日期、成交量和股票名称感兴趣，请指定<code class="fe jq jr js jt b">usecols=['date', 'volume', 'Name']</code>。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="8fcf" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">正如预期的那样，只有我们指定的列包含在数据框中。</p><p id="d7b9" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">默认情况下，pandas 假设数据的第一行是一个标题。当然，并不是每个数据文件都有标题。例如，假设我们有一个没有标题的数据文件，如下所示。</p><pre class="kn ko kp kq gt nn jt no np aw nq bi"><span id="98d7" class="nr ml it jt b gy ns nt l nu nv">2013-02-08,15.07,15.12,14.63,14.75,8407500,AAL<br/>2013-02-11,14.89,15.01,14.26,14.46,8882000,AAL<br/>2013-02-12,14.45,14.51,14.1,14.27,8126000,AAL<br/>2013-02-13,14.3,14.94,14.25,14.66,10259500,AAL<br/>2013-02-14,14.94,14.96,13.16,13.99,31879900,AAL</span></pre><p id="8f45" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如果我们像以前一样尝试读取文件，我们将不会得到我们想要的结果。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="c68d" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">pandas 假定第一行是一个标题，并照此读入。在这种情况下，这不是我们想要的，因为第一行是数据。幸运的是，修复很容易——只需指定选项<code class="fe jq jr js jt b">header=None</code>。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="7784" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在熊猫从 0 开始给这些列编号。如果您喜欢使用命名列，使用<code class="fe jq jr js jt b">names</code>选项来指定您自己的列名。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="dece" class="mk ml it bd mm mn mo mp mq mr ms mt mu kd nk ke mw kg nl kh my kj nm kk na nb bi translated">目录</h1><p id="ee41" class="pw-post-body-paragraph ld le it lf b lg nc jy li lj nd kb ll lm ne lo lp lq nf ls lt lu ng lw lx ly im bi translated">在上面的例子中，我将数据文件保存为与我的 Python 程序相同的目录中的<code class="fe jq jr js jt b">stocks.csv</code>。为了保持有序，通常将数据文件保存在子目录中。在这种情况下，在<code class="fe jq jr js jt b">read_csv</code>语句中指定数据子目录。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="da7b" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">像以前一样，让我们检查前几行，以确保一切顺利。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="7ba5" class="mk ml it bd mm mn mo mp mq mr ms mt mu kd nk ke mw kg nl kh my kj nm kk na nb bi translated">分隔符</h1><p id="74b0" class="pw-post-body-paragraph ld le it lf b lg nc jy li lj nd kb ll lm ne lo lp lq nf ls lt lu ng lw lx ly im bi translated">并非所有数据文件都使用逗号分隔值。可以使用制表符、空格或任何其他字符。例如，我们的数据文件可能是用分号而不是逗号设置的。</p><pre class="kn ko kp kq gt nn jt no np aw nq bi"><span id="471f" class="nr ml it jt b gy ns nt l nu nv">date;open;high;low;close;volume;Name<br/>2013-02-08;15.07;15.12;14.63;14.75;8407500;AAL<br/>2013-02-11;14.89;15.01;14.26;14.46;8882000;AAL<br/>2013-02-12;14.45;14.51;14.1;14.27;8126000;AAL<br/>2013-02-13;14.3;14.94;14.25;14.66;10259500;AAL<br/>2013-02-14;14.94;14.96;13.16;13.99;31879900;AAL</span></pre><p id="12aa" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">要指定逗号以外的分隔符，使用<code class="fe jq jr js jt b">sep</code>选项。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="3457" class="mk ml it bd mm mn mo mp mq mr ms mt mu kd nk ke mw kg nl kh my kj nm kk na nb bi translated">指定要作为索引的列</h1><p id="c656" class="pw-post-body-paragraph ld le it lf b lg nc jy li lj nd kb ll lm ne lo lp lq nf ls lt lu ng lw lx ly im bi translated">如果不需要默认索引，可以指定一列作为数据框的索引。例如，要将索引指定为<code class="fe jq jr js jt b">date</code>列，可以使用<code class="fe jq jr js jt b">index_col='date'</code>。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="a9e5" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在，根据需要，日期列就是索引。</p><h1 id="7165" class="mk ml it bd mm mn mo mp mq mr ms mt mu kd nk ke mw kg nl kh my kj nm kk na nb bi translated">类型</h1><p id="2458" class="pw-post-body-paragraph ld le it lf b lg nc jy li lj nd kb ll lm ne lo lp lq nf ls lt lu ng lw lx ly im bi translated">让我们检查每个列的类型。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="1464" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">假设我们想要将数字数据存储为 32 位类型以节省空间。为此，将选项<code class="fe jq jr js jt b">dtype</code>设置为一个字典，其中键是列，值是所需的类型。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="7696" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">尽管我们知道数据由日期组成，但是<code class="fe jq jr js jt b">date</code>列是作为通用对象类型读入的。要以日期类型读取列，使用设置为包含列索引的列表的<code class="fe jq jr js jt b">parse_dates</code>选项。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="6cf5" class="mk ml it bd mm mn mo mp mq mr ms mt mu kd nk ke mw kg nl kh my kj nm kk na nb bi translated">缺少值</h1><p id="a1b0" class="pw-post-body-paragraph ld le it lf b lg nc jy li lj nd kb ll lm ne lo lp lq nf ls lt lu ng lw lx ly im bi translated">数据包含缺失值是很常见的。用某种指示符(如问号或单词“missing ”)来指示缺失值也很常见。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="0bf8" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">如您所见，第一行数据中缺少两个值，第二行缺少一个值。此外，第三个数据行的一个条目中有一个问号。我们该如何应对？</p><p id="4f35" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">正如我们所预料的那样，缺失的值被 pandas 读入为“非数字”(NaN)，所以我们对这些值没有进一步的要求。然而，pandas 不知道如何处理表示缺少值的问号。为了纠正这种情况，我们可以将列表中被视为缺失值的值列表传递给<code class="fe jq jr js jt b">na_values</code>选项。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="cd97" class="pw-post-body-paragraph ld le it lf b lg lh jy li lj lk kb ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">现在问号已经被念成 NaN 了。</p><h1 id="8c05" class="mk ml it bd mm mn mo mp mq mr ms mt mu kd nk ke mw kg nl kh my kj nm kk na nb bi translated">进一步阅读</h1><p id="7079" class="pw-post-body-paragraph ld le it lf b lg nc jy li lj nd kb ll lm ne lo lp lq nf ls lt lu ng lw lx ly im bi translated"><code class="fe jq jr js jt b">read_csv</code>命令非常灵活，有很多选项。要进一步了解这些选项，请参考<a class="ae lc" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html" rel="noopener ugc nofollow" target="_blank">文档</a>。</p></div></div>    
</body>
</html>