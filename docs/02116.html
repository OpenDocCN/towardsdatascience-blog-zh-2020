<html>
<head>
<title>Playing God with Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用数据扮演上帝</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/playing-god-with-data-d7d566550745?source=collection_archive---------33-----------------------#2020-02-28">https://towardsdatascience.com/playing-god-with-data-d7d566550745?source=collection_archive---------33-----------------------#2020-02-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/b514f079a926748ddbae216323a5e978.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LrIvQSPeAXgTkwbF"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">泰勒·维克在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""/><div class=""><h2 id="ac40" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">5个综合数据问题&amp;评估新机器学习方法的代码</h2></div><p id="1a65" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所以你有一个你想测试的机器学习方法。很好，但是你怎么证明它的价值呢？答案是:合成数据。</p><p id="9638" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在评估新方法时，合成数据比真实数据有几个优势。对于合成数据，任务的性质、输入特征、维度、采样大小、噪声程度和其他数据因素完全由创建者控制。合成数据问题千差万别，模型在这些问题上的表现可以告诉我们很多关于模型的优点和缺点-也许它在线性可分数据上表现良好，或者不能很好地处理噪声-这可以帮助理解模型在真实世界的数据类型上会表现良好。</p><blockquote class="lu"><p id="b553" class="lv lw jj bd lx ly lz ma mb mc md lt dk translated">合成数据为如何将模型应用于真实数据提供了蓝图。</p></blockquote><p id="87a9" class="pw-post-body-paragraph ky kz jj la b lb me kk ld le mf kn lg lh mg lj lk ll mh ln lo lp mi lr ls lt im bi translated">在本文中，我将概述5个二元分类合成数据问题，提供用于创建数据的Python代码(支持调整参数)，并解释如何解释这些问题的结果。此外，我将概述每个问题的扩展。</p><p id="8989" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们开始吧！</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="aadd" class="mq mr jj bd ms mt mu mv mw mx my mz na kp nb kq nc ks nd kt ne kv nf kw ng nh bi translated">环形问题</h1><h2 id="5c58" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">问题是</h2><p id="1105" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">在2D环分类问题中，有两个圆，都以(0.5，0.5)为中心。圆环由两个圆定义，外圆半径为0.5，内圆半径为0.3。</p><p id="31a6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">落在红色和蓝色区域的重叠中的所有数据点被标记为1；否则，它们被标记为0。</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nz"><img src="../Images/cd8e9eb57a40410140a35ccf0f25fb29.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*x1b0lMTOWC3N4uHXAGnWJA.png"/></div></div></figure><p id="e22b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">写成一个函数，环的问题是:</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oe"><img src="../Images/b0a02314a544e99bbe1a113a297512af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OHWmihcYMtzQ0IlmPxGapw.png"/></div></div></figure><p id="165f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在下图中，红点代表1，蓝点代表0。</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi of"><img src="../Images/0f79671b68c718a3620ad4cc42e55df0.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*vyJDCXuHObt3GFfR5wxC3g.png"/></div></figure><p id="d3ff" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">环形问题的价值在于它的非线性和几何上明显的模式。</p><h2 id="2050" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">扩展ˌ扩张</h2><ul class=""><li id="7ce6" class="og oh jj la b lb nu le nv lh oi ll oj lp ok lt ol om on oo bi translated">添加噪声。这种分类任务的噪声版本可以用沿着解边界的高斯噪声来构建。在下面的等式中，<em class="op"> z </em>是从具有标准偏差<em class="op"> s </em>的高斯分布的正侧抽取的随机数的向量。</li></ul><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oq"><img src="../Images/a4f5f2564ebf992e5bf2ceb3c2d27b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9EN6Px4QmCXmg6bh3uwcbQ.png"/></div></div></figure><ul class=""><li id="933b" class="og oh jj la b lb lc le lf lh or ll os lp ot lt ol om on oo bi translated">3+维的环问题。环带问题的另一种形式可以适用于三维或更多维，只需在方程中增加另一维即可。</li></ul><h2 id="5cce" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">密码</h2><p id="0dd3" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">提供的四个参数是:</p><ul class=""><li id="dff1" class="og oh jj la b lb lc le lf lh or ll os lp ot lt ol om on oo bi translated"><em class="op"> n </em>，数据点的数量</li><li id="6dd3" class="og oh jj la b lb ou le ov lh ow ll ox lp oy lt ol om on oo bi translated"><em class="op">内径</em>，内圆的半径</li><li id="49f4" class="og oh jj la b lb ou le ov lh ow ll ox lp oy lt ol om on oo bi translated"><em class="op">外半径</em>，外圆的半径</li><li id="37c4" class="og oh jj la b lb ou le ov lh ow ll ox lp oy lt ol om on oo bi translated"><em class="op"> z </em>，添加了随机性的正态分布的尺度</li></ul><p id="15eb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">…可以对其进行微调以调整数据的属性。</p><pre class="oa ob oc od gt oz pa pb pc aw pd bi"><span id="e96f" class="ni mr jj pa b gy pe pf l pg ph">import pandas as pd<br/>import numpy as np<br/>import math as m<br/>import random as r</span><span id="c278" class="ni mr jj pa b gy pi pf l pg ph">n = 800 #number of data points<br/>innerRadius = 0.3 #radius of inner circle<br/>outerRadius = 0.5 #radius of outer circle<br/>z = 0 #gaussian multiplier</span><span id="f5ea" class="ni mr jj pa b gy pi pf l pg ph">data = {'x1':[],'x2':[],'label':[]}<br/>for i in range(n):<br/>	x1 = r.randint(1,100_000)/100_000<br/>	x2 = r.randint(1,100_000)/100_000<br/>	coef = abs(np.random.normal(scale=z))<br/>	if (x1-0.5)**2 + (x2-0.5)**2 &gt; (innerRadius-coef)**2:<br/>		if (x1-0.5)**2 + (x2-0.5)**2 &lt; (outerRadius-coef)**2:<br/>			label = 1<br/>		else:<br/>			label = 0<br/>	else:<br/>		label = 0<br/>	data['x1'].append(x1)<br/>	data['x2'].append(x2)<br/>	data['label'].append(label)<br/>data = pd.DataFrame(data</span></pre><p id="dec5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据输出的前10行是:</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/83625bb75266f1264dd8fa1d91833aa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*AG_CeLK9kCe7GxYrmqaMEA.png"/></div></figure><p id="fe51" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要绘制环:</p><pre class="oa ob oc od gt oz pa pb pc aw pd bi"><span id="9629" class="ni mr jj pa b gy pe pf l pg ph">import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>fig = plt.figure(figsize=(5,5))<br/>sns.scatterplot(data['x1'],data['x2'],data['label'])</span></pre><p id="8e3d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">400个数据点，无噪声:</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/606df5e189a881e1083add15a41effd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*T_JzA1VBvnG8a_SxH3vpQA.png"/></div></figure><p id="66ae" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">400个数据点，<em class="op"> z </em> = 0.1:</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/71dad6bea7f656bcc2b61d4fb8c60fa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*axEQ1FJZeke67Ox2FvyGqw.png"/></div></figure><p id="b5d3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">400个数据点，其中<em class="op"> z </em> = 0.25:</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/8c249ca25ad12030c36b193e8310f11c.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*7dmkAUcc4G_O2C_n7tbXVg.png"/></div></figure><h2 id="b3c3" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">数据应用</h2><p id="c26c" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">许多真实世界的数据集(如医疗诊断)都有特征空间，在这些空间中，标注的分离更加清晰。在具有合理数量的噪声(z = 0.1至0.2)的环形问题上成功的模型可以识别真实世界数据中的几何上明显的非线性模式，并且具有合理的噪声容限。通过增加或减少环的面积，该模型可以适用于平衡或非平衡问题。通过减小环的面积，问题变得不平衡，类似于医学问题，如癌症诊断，其中阳性诊断的数量远小于阴性诊断的数量。通过将环的面积增加到网格面积的一半，问题变得更加平衡，这可能有助于识别男性或女性、18岁以下或18岁以上等。比较几何上明显的问题和棋盘问题。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="f775" class="mq mr jj bd ms mt mu mv mw mx my mz na kp nb kq nc ks nd kt ne kv nf kw ng nh bi translated">棋盘二元分类问题</h1><h2 id="ab14" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">问题是</h2><p id="76cb" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">像棋盘一样，交替的二维空间被标记为0和1。所有值1(红色)具有相同奇偶性的<em class="op"> x1 </em>和<em class="op"> x2 </em>值(或者都是偶数或者都是奇数),而所有值0(蓝色)具有相反奇偶性的<em class="op"> x1 </em>和<em class="op"> x2 </em>值。</p><p id="4834" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面提供了一个视觉效果:</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/e0e65eef75f189ca85b386c93e890fc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*p-_C846f-6HnBt2JsJiLoA.png"/></div></figure><p id="3287" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这在数学上可以表示为</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi po"><img src="../Images/87948ac508473ee9474ff1886786e94a.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*0auvSU0tYbbrI0Gy3nqXIA.png"/></div></figure><p id="9185" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">棋盘问题的一个解决方案如下:</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pp"><img src="../Images/ef2b947c8c6953a6e0fe468fe09e5dd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ujlSKYLWpqjaVyyXF7NjFA.png"/></div></div></figure><p id="b146" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每条对角线将这些点分隔成各自的颜色。</p><p id="e9e8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">棋盘问题在两个方面是有价值的——首先，因为虽然数据是线性可分的，但它需要多条线来分隔的事实使它更加真实和复杂；第二，数据是分散的，从计算机的角度来看，数据不是几何图形而是数字图形，没有几何图形，只有数字图形。</p><h2 id="571b" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">扩展ˌ扩张</h2><ul class=""><li id="839d" class="og oh jj la b lb nu le nv lh oi ll oj lp ok lt ol om on oo bi translated">棋盘问题可以扩展成包含<em class="op"> n </em>种颜色</li><li id="7434" class="og oh jj la b lb ou le ov lh ow ll ox lp oy lt ol om on oo bi translated">这个问题也可以变成一个三维或<em class="op"> m- </em> D棋盘问题</li></ul><h2 id="81ac" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">密码</h2><p id="3a8e" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">在棋盘问题中，可调参数是:</p><ul class=""><li id="edb1" class="og oh jj la b lb lc le lf lh or ll os lp ot lt ol om on oo bi translated"><em class="op"> dim1 </em>，二维空间的第一维</li><li id="cdad" class="og oh jj la b lb ou le ov lh ow ll ox lp oy lt ol om on oo bi translated"><em class="op"> dim2 </em>，二维空间的第二维度</li></ul><pre class="oa ob oc od gt oz pa pb pc aw pd bi"><span id="3568" class="ni mr jj pa b gy pe pf l pg ph">import pandas as pd<br/>dim1 = 20 #x-dimension<br/>dim2 = 20 #y-dimension<br/>data = {'x1':[],'x2':[],'label':[]}<br/>for xcoor in range(dim1):<br/>    for ycoor in range(dim2):<br/>        if xcoor % 2 == 0 and ycoor % 2 == 0:<br/>            label = 1<br/>        elif xcoor % 2 == 1 and ycoor % 2 == 1:<br/>            label = 1<br/>        else:<br/>            label = 0<br/>        data['x1'].append(xcoor)<br/>        data['x2'].append(ycoor)<br/>        data['label'].append(label)<br/>data = pd.DataFrame(data)</span></pre><p id="2b29" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据帧看起来像:</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/538b1db6ddd2d3d8bb0e83a114f4d336.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*PBgPru_PU4pv0u5myrW_Qg.png"/></div></figure><p id="3a90" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">…可以想象为</p><pre class="oa ob oc od gt oz pa pb pc aw pd bi"><span id="8b88" class="ni mr jj pa b gy pe pf l pg ph">import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>fig = plt.figure(figsize=(5,5))<br/>sns.scatterplot(data['x1'],data['x2'],data['label'])</span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/8da267bd5be29bc03ca89d3d0393b0d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*WRwZh17KkDdFfsyYsuEX3Q.png"/></div></figure><h2 id="b328" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">数据应用</h2><p id="072f" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">在棋盘问题上表现良好的模型在大量分散的数据上表现良好；其更复杂的关系不一定是几何的而是数字的。它在分层数据上也表现良好；也就是说，只能用多条线分开。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="9e1b" class="mq mr jj bd ms mt mu mv mw mx my mz na kp nb kq nc ks nd kt ne kv nf kw ng nh bi translated">x维奇偶二元分类问题</h1><h2 id="cda8" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">问题是</h2><p id="0ca9" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">在X维(默认为<em class="op"> X </em> = 10)奇偶校验问题中，如果一个X位字符串具有奇数个1(因此，奇数个0)，则该字符串被分类为1；如果该字符串具有偶数个1(因此，偶数个0)，则该字符串被分类为0。这个奇偶校验问题是非线性的。</p><p id="e32d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">X维奇偶校验问题的价值在于，所有列之间存在更深层次的数学关系，而不是某一列是最重要的。这可能是没有几何方面的棋盘问题；宇称问题不能用几何来分析。</p><h2 id="8669" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">扩展ˌ扩张</h2><ul class=""><li id="0f9a" class="og oh jj la b lb nu le nv lh oi ll oj lp ok lt ol om on oo bi translated">充当噪声的附加噪声列。</li><li id="ba13" class="og oh jj la b lb ou le ov lh ow ll ox lp oy lt ol om on oo bi translated">增加值的范围(而不是只有0和1，可能是0、1、2和3)—例如，如果3的数量为奇数，则最终标签为1。</li></ul><h2 id="dd4d" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">密码</h2><pre class="oa ob oc od gt oz pa pb pc aw pd bi"><span id="49d6" class="ni mr jj pa b gy pe pf l pg ph">import pandas as pd<br/>import numpy as np<br/>import random as r</span><span id="040b" class="ni mr jj pa b gy pi pf l pg ph">dimensions = 10 #bitstring dimensions<br/>data_points = 500 #number of data points</span><span id="ee75" class="ni mr jj pa b gy pi pf l pg ph">data = {'label':[]}<br/>for dimension in range(dimensions):<br/>    data['d'+str(dimension+1)] = []<br/>    <br/>for i in range(data_points):<br/>    bitstring = [r.randint(0,1) for i in range(dimensions)]<br/>    count0 = 0<br/>    for i in range(len(bitstring)):<br/>        if bitstring[i] == 0:<br/>            count0 += 1<br/>        data['d'+str(i+1)].append(bitstring[i])<br/>    if count0 % 2 == 0:<br/>        data['label'].append(0)<br/>    else:<br/>        data['label'].append(1)<br/>data = pd.DataFrame(data)</span></pre><p id="80dc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将输出数据帧:</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi ps"><img src="../Images/3fc71b65382848871e31c3db8a55a61a.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*SgxTV9raFxLmPPVYCAH0Pg.png"/></div></figure><p id="a7f9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于有2个以上的维度，我们将尝试用主成分分析来可视化数据。</p><pre class="oa ob oc od gt oz pa pb pc aw pd bi"><span id="78eb" class="ni mr jj pa b gy pe pf l pg ph">from sklearn import decomposition<br/>pca = decomposition.PCA(n_components=2)<br/>pca.fit(data.drop('label',axis=1))<br/>X = pca.transform(data.drop('label',axis=1))<br/>pca.explained_variance_.sum()</span></pre><p id="bd3e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将输出:</p><pre class="oa ob oc od gt oz pa pb pc aw pd bi"><span id="efb9" class="ni mr jj pa b gy pe pf l pg ph">0.5922694981939761</span></pre><p id="4771" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一个相当低的解释方差，但它应该足以显示数据的一般性质。</p><p id="24b9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">绘制数据:</p><pre class="oa ob oc od gt oz pa pb pc aw pd bi"><span id="e8db" class="ni mr jj pa b gy pe pf l pg ph">import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>fig = plt.figure(figsize=(5,5))<br/>sns.scatterplot(X[:,0],X[:,1],data['label'])</span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/154f02015945eadb55dcab8ddc67b5e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*aXE3UlP-HBo8Cf14A55YOg.png"/></div></figure><p id="49c0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">很明显，没有一个清晰的几何图案可以清晰地确定标签。</p><h2 id="8d38" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated"><strong class="ak">数据应用</strong></h2><p id="fccb" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">在X维奇偶校验问题上成功的模型在最终目标是所有特征的半相等组合的数据集中也是成功的，例如通过某种特征重要性方法消除了不太有用的列的数据。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="12f9" class="mq mr jj bd ms mt mu mv mw mx my mz na kp nb kq nc ks nd kt ne kv nf kw ng nh bi translated">异或二进制分类问题</h1><h2 id="230c" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">问题</h2><p id="9305" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">有两个特征的XOR值创建了最终目标，还有<em class="op"> x </em>个额外的随机特征作为噪声。默认情况下，<em class="op"> x </em>是97(这样总共有100列，包括标签列)。</p><p id="f031" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">XOR函数的作用如下:</p><ul class=""><li id="8991" class="og oh jj la b lb lc le lf lh or ll os lp ot lt ol om on oo bi">0, 0 : 0</li><li id="d030" class="og oh jj la b lb ou le ov lh ow ll ox lp oy lt ol om on oo bi">1, 1 : 0</li><li id="d9bf" class="og oh jj la b lb ou le ov lh ow ll ox lp oy lt ol om on oo bi">0, 1: 1</li><li id="70fa" class="og oh jj la b lb ou le ov lh ow ll ox lp oy lt ol om on oo bi">1, 0: 1</li></ul><p id="b414" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果两个输入相同，则输出为0；否则，输出为1。</p><p id="ce12" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">XOR问题的价值来自于这样一个事实:在几层随机数据下隐藏着一个非常简单的数字关系。</p><h2 id="1313" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">密码</h2><p id="44d3" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">可以调整的参数有:</p><ul class=""><li id="4908" class="og oh jj la b lb lc le lf lh or ll os lp ot lt ol om on oo bi translated"><em class="op"> noise_features，</em>数据中随机噪声特征的数量</li><li id="c202" class="og oh jj la b lb ou le ov lh ow ll ox lp oy lt ol om on oo bi translated"><em class="op">数据点</em>，数据点的数量</li></ul><pre class="oa ob oc od gt oz pa pb pc aw pd bi"><span id="e141" class="ni mr jj pa b gy pe pf l pg ph">import pandas as pd<br/>import random</span><span id="ac8e" class="ni mr jj pa b gy pi pf l pg ph">noise_features = 97<br/>data_points = 500</span><span id="dd27" class="ni mr jj pa b gy pi pf l pg ph">def XOR(bit1,bit2):<br/>    if bit1 and bit2:<br/>        return 0<br/>    elif not bit1 and not bit2:<br/>        return 0<br/>    else:<br/>        return 1</span><span id="5d6b" class="ni mr jj pa b gy pi pf l pg ph">data = {'label':[],'bit1':[],'bit2':[]}<br/>for index in range(noise_features):<br/>    data['nf'+str(index)] = []<br/>for i in range(data_points):<br/>    bit1 = random.randint(0,1)<br/>    bit2 = random.randint(0,1)<br/>    label = XOR(bit1,bit2)<br/>    data['label'].append(label)<br/>    data['bit1'].append(bit1)<br/>    data['bit2'].append(bit2)<br/>    for noise_index in range(noise_features):<br/>        data['nf'+str(noise_index)].append(random.randint(0,1))<br/>data = pd.DataFrame(data)</span></pre><p id="7171" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出数据帧(“nf”代表“噪声特征”):</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/57d4a1a5da3d513f8a26feb6e045fdaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*fuUDNUERjYlr7wVDlF0odg.png"/></div></figure><h2 id="f55d" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">数据应用</h2><p id="a67f" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">在XOR问题中表现良好的模型(尤其是具有高维数的模型)能够强有力地识别哪些特征是重要的，哪些是不相关的。这些类型的模型可能在用于数字识别的MNIST数据集上表现良好，因为某些像素在确定最终数字时是无用的，而某些像素的潜在关系在最终标注中具有重大影响。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="2543" class="mq mr jj bd ms mt mu mv mw mx my mz na kp nb kq nc ks nd kt ne kv nf kw ng nh bi translated">相关问题</h1><h2 id="855a" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">问题</h2><p id="8068" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">畜栏数据集有6个二元特征，标签由(<em class="op"> f </em> 1和<em class="op"> f </em> 2)或(<em class="op"> f </em> 3和<em class="op"> f </em> 4)确定，其中<em class="op"> fn </em>表示<em class="op"> nt </em> h输入。任何额外数量的特征<em class="op"> n </em>(默认为1)与类别标签具有<em class="op"> m </em> %(默认为75%)相关性，并且可以添加任何数量的<em class="op"> p </em>(默认为5)额外随机特征。</p><p id="e789" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">相关性问题的价值在于衡量模型如何利用相关特征，以及如何从随机特征中识别高度相关的特征。</p><h2 id="bbb1" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">密码</h2><p id="be6f" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">可以调整的参数有:</p><ul class=""><li id="8c33" class="og oh jj la b lb lc le lf lh or ll os lp ot lt ol om on oo bi translated"><em class="op">数据点</em>，数据点的数量</li><li id="a1ea" class="og oh jj la b lb ou le ov lh ow ll ox lp oy lt ol om on oo bi translated"><em class="op">随机_特征</em>，随机特征数量</li><li id="b530" class="og oh jj la b lb ou le ov lh ow ll ox lp oy lt ol om on oo bi translated"><em class="op">相关特征</em>，与目标相关的特征数量</li><li id="14f4" class="og oh jj la b lb ou le ov lh ow ll ox lp oy lt ol om on oo bi translated"><em class="op">相关性</em>，相关特征与目标的相关百分比</li></ul><pre class="oa ob oc od gt oz pa pb pc aw pd bi"><span id="b368" class="ni mr jj pa b gy pe pf l pg ph">import pandas as pd<br/>import random</span><span id="9e9d" class="ni mr jj pa b gy pi pf l pg ph">data_points = 500 #number of data points<br/>random_features = 5 #number of random features<br/>corr_features = 1 #number of correlated features<br/>correlation = 75 #% correlation with target</span><span id="8f43" class="ni mr jj pa b gy pi pf l pg ph">def logic_oracle(f1,f2,f3,f4):<br/>    if f1 and f2:<br/>        return 1<br/>    elif f3 and f4:<br/>        return 1<br/>    else:<br/>        return 0</span><span id="19ee" class="ni mr jj pa b gy pi pf l pg ph">data = {'label':[],'f1':[],'f2':[],'f3':[],'f4':[]}<br/>for corr_feature in range(corr_features):<br/>    data['corr'+str(corr_feature+1)] = []<br/>for rand_feature in range(random_features):<br/>    data['rand'+str(rand_feature+1)] = []</span><span id="8f2c" class="ni mr jj pa b gy pi pf l pg ph">for i in range(data_points):<br/>    f1 = random.randint(0,1)<br/>    f2 = random.randint(0,1)<br/>    f3 = random.randint(0,1)<br/>    f4 = random.randint(0,1)<br/>    label = logic_oracle(f1,f2,f3,f4)<br/>    data['f1'].append(f1)<br/>    data['f2'].append(f2)<br/>    data['f3'].append(f3)<br/>    data['f4'].append(f4)<br/>    data['label'].append(label)<br/>    for index in range(random_features):<br/>        data['rand'+str(index+1)].append(random.randint(0,1))</span><span id="62f0" class="ni mr jj pa b gy pi pf l pg ph">for corr_feature in range(corr_features):<br/>    for label in data['label']:<br/>        if random.randint(1,100) &lt; correlation:<br/>            data['corr'+str(corr_feature+1)].append(int(label))<br/>        else:<br/>            data['corr'+str(corr_feature+1)].append(int(not label))<br/>data = pd.DataFrame(data)</span></pre><p id="1f96" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">输出数据帧:</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/2fc030310dcc6e622d2b94b027bce1b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*jbGO6Mba7C9be-s0F_0mJw.png"/></div></figure><h2 id="b415" class="ni mr jj bd ms nj nk dn mw nl nm dp na lh nn no nc ll np nq ne lp nr ns ng nt bi translated">数据应用</h2><p id="a52a" class="pw-post-body-paragraph ky kz jj la b lb nu kk ld le nv kn lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">在几个真实世界的数据集中，特征将<em class="op">相关</em>，因为它们不完全预测目标，但足够紧密地联系在一起，因此它在标签中有很大的发言权。在相关性问题中表现良好的模型可以区分现实数据中存在的三种类型的要素-直接要素，其组合揭示了查找输出的“黄金法则”、在大多数情况下给出正确答案的相关要素，以及其存在会影响准确性的不相关要素。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="fa9f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读！</p></div></div>    
</body>
</html>