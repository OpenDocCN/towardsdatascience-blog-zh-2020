<html>
<head>
<title>Effective Data Filtering in Pandas Using .loc[]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有效的数据过滤。位置[]</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/effective-data-filtering-in-pandas-using-loc-40eb815455b6?source=collection_archive---------4-----------------------#2020-02-25">https://towardsdatascience.com/effective-data-filtering-in-pandas-using-loc-40eb815455b6?source=collection_archive---------4-----------------------#2020-02-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/12f8f764e6091f91a41d25a5e5726b65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TqIANFHPQMFQb7ZjcTw5ZA.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@wadeaustinellis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">韦德·奥斯丁·埃利斯</a>在<a class="ae jg" href="https://unsplash.com/s/photos/filter?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><div class=""/><div class=""><h2 id="f331" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">学习使用的多种方法。loc[]过滤Pandas中的数据帧</h2></div><p id="e774" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Pandas是用于数据科学研究的最流行的Python包之一。它收集了大量用于处理结构化数据的强大方法。处理这些数据表(即pandas中的数据帧)的一个常规任务是过滤符合某个预定义标准的数据。在我自己的研究中，在各种过滤方法中，我经常使用DataFrame的loc属性过滤数据。在本文中，我将向您展示我们如何使用。loc[]用于有效的数据过滤。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="1095" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">基本设置</h1><p id="0fd3" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">假设您已经构建了自己的IDE，并在计算机上安装了Python和pandas，基本的设置步骤如下所示。如果你想在Visual Studio代码中运行Jupyter Notebook，请参阅我以前的文章。</p><p id="9904" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我将<code class="fe my mz na nb b">pandas</code>导入到笔记本中。出于当前教程的目的，我从<a class="ae jg" href="https://www.kaggle.com/selfishgene/historical-hourly-weather-data#city_attributes.csv" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载了city_attributes.csv数据集。这个数据集有4列:城市、国家、纬度和经度。当我导入文件时，我将城市设置为索引，以便以后进行更有意义的索引。</p><figure class="nd ne nf ng gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nc"><img src="../Images/5aa146f47acd20c58074624f4fe7c477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3f0gPewCWJoX5pvPbkZAZQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">基本设置</p></figure><p id="411d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们进行任何数据处理之前，看看我们正在处理的数据集总是一个好主意。为此，我只使用了<code class="fe my mz na nb b">sample()</code>和<code class="fe my mz na nb b">shape</code>来获得2个随机行，并检查数据帧的大小，这向我们显示数据有36条记录。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="cb86" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">数据过滤</h1><h2 id="2e3f" class="nh mc jj bd md ni nj dn mh nk nl dp ml lh nm nn mn ll no np mp lp nq nr mr ns bi translated">使用标签</h2><p id="f0ac" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">第一种方法是使用标签过滤数据。这里有几个例子。如您所见，我们只需指定行和列的标签，符合这些标签的特定数据记录就会显示出来。</p><figure class="nd ne nf ng gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nc"><img src="../Images/62aae45271dfbfae41b0550cc8d7953c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8MXGXKMKBhukgtzSRpbbOw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">使用标签过滤数据</p></figure><p id="bd30" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从上面的代码片段中，有几件事情需要强调。</p><ul class=""><li id="788d" class="nt nu jj la b lb lc le lf lh nv ll nw lp nx lt ny nz oa ob bi translated">我们可以指定单个标签或标签列表来过滤loc[]中的数据。</li><li id="968d" class="nt nu jj la b lb oc le od lh oe ll of lp og lt ny nz oa ob bi translated">筛选的数据可以是不同的类型:单个值、系列或数据帧，分别如示例所示。</li><li id="aa9c" class="nt nu jj la b lb oc le od lh oe ll of lp og lt ny nz oa ob bi translated">当只设置了一个标签或标签列表时，它将返回所有列。</li></ul><h2 id="c11d" class="nh mc jj bd md ni nj dn mh nk nl dp ml lh nm nn mn ll no np mp lp nq nr mr ns bi translated">使用范围</h2><p id="3194" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">另一种常用的方法是使用行和列标签的范围。下面是一些例子。类似地，如上所述，我们可以设置一个或两个范围，前者显示所有列，后者显示范围内的列。</p><figure class="nd ne nf ng gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nc"><img src="../Images/d4a23d676672e7d07df67ff8db52f875.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9q-It3xwVuxs6k2wt3a1Ow.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">使用范围进行数据过滤</p></figure><h2 id="8df2" class="nh mc jj bd md ni nj dn mh nk nl dp ml lh nm nn mn ll no np mp lp nq nr mr ns bi translated">使用布尔值</h2><p id="4422" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">过滤数据的一个有效方法是使用与我们正在处理的轴的长度相匹配的布尔值列表。例如，在下面的代码中，我们能够通过只显示加拿大的城市来过滤数据。具体来说，我们通过将国家的值与字符串“Canada”进行比较来创建一系列布尔值，该系列的长度与数据帧的行号相匹配。由于pandas将True评估为1，当我们请求这个系列的总和时，我们得到了3，这正是我们通过运行<code class="fe my mz na nb b">cities.loc[cities[‘Country’]==‘Canada’]</code>得到的行数。</p><figure class="nd ne nf ng gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nc"><img src="../Images/8aea27c53f925a235c90919057548eca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lndD1s6GWtl1c4itoHAceg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">使用布尔进行数据过滤</p></figure><p id="0f18" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当然，我们可以有一个更复杂的布尔求值表达式。下面给出一个例子。</p><figure class="nd ne nf ng gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oh"><img src="../Images/04b59a4d1e44f7f0cbc7cd992cbfc484.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dv4vTK6W7eilEuqEs0J7YA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">使用布尔值进行数据过滤(多条件)</p></figure><h2 id="ee6f" class="nh mc jj bd md ni nj dn mh nk nl dp ml lh nm nn mn ll no np mp lp nq nr mr ns bi translated">使用Lambdas或自定义函数</h2><p id="fe2c" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">有时，我们需要有一个更高级的数据过滤标准，在这种情况下，我们可以使用lambdas，如下所示。在lambda函数中，我们指定了名为row的参数，该参数引用数据帧中的系列，这样我们就可以像上面所做的那样对其求值以生成布尔列表。换句话说，这个方法是建立在使用布尔值的数据过滤方法之上的，尽管它们在概念上是不同的。</p><figure class="nd ne nf ng gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oh"><img src="../Images/d849594aa84406d48b1b740c27eec4b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8NlY6kzofY2uCs1YMyHaTA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">使用Lambdas进行数据过滤</p></figure><p id="4239" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们想要设置更多的标准，我们甚至可以编写一个数据过滤函数。如下所示，我们有一个名为<code class="fe my mz na nb b">filtering_cities()</code>的函数，它评估多个标准并返回一个布尔值列表，可用于过滤数据。我们将简单地在loc[]中设置这个函数来过滤数据。</p><figure class="nd ne nf ng gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oh"><img src="../Images/82dbac15cc303023cd958944f84320fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d1WHc6ZxLvTqjELVfTr3uw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">使用函数进行数据过滤</p></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="fa74" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">结论</h1><p id="48ef" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">本文向您展示了如何使用loc[]通过多种方式有效地过滤数据。当然，本教程只是通过介绍使用loc[]进行数据过滤的基本元素来提供一个概念证明，还有其他几种数据过滤方法，我们稍后可以一起探讨。</p></div></div>    
</body>
</html>