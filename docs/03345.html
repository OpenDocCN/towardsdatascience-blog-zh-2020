<html>
<head>
<title>Image Recognition vs Other Techniques in Predicting the Financial Market</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像识别与其他技术在预测金融市场中的比较</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-recognition-vs-other-techniques-in-predicting-the-financial-market-55548d4cda4?source=collection_archive---------34-----------------------#2020-03-30">https://towardsdatascience.com/image-recognition-vs-other-techniques-in-predicting-the-financial-market-55548d4cda4?source=collection_archive---------34-----------------------#2020-03-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="aa67" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用CNN进行上电时间序列分析，以及它与其他技术的比较</h2></div><p id="99a6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这项工作是与@Vesko Karadjov合作完成的，他总能迸发出绝妙的想法。</p><p id="ef22" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">金融市场主要处理时间序列，围绕时间序列预测有大量的技术和工具。我们要做的是使用CNN进行基于回归的预测，并与一些传统方法进行比较，看看它的表现如何。</p><p id="ebb4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在金融领域，金融产品价格或回报预测一直是任何定量分析的共同目标。这是几十年来反复研究的。我们这里关注的是市场的波动性，具体来说，就是股市开盘前后的波动性。</p><h2 id="e712" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">问题</h2><p id="bf04" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">我们怀疑的是，盘前时段的波动性(vol)可能是开市后可能立即发生的事情的一个很好的指标。如果我们能准确地预测体积，我们也许能利用它。例如，我们从OANDA获取了FTSE 100 CFD的价格数据。</p><h2 id="8762" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">准备数据</h2><p id="973f" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">我们要求从2016年1月到2020年3月按分钟提取汇总价格数据，其格式如下。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi lz"><img src="../Images/29e7eee9d5a57536912ad7ae086e505e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yOylcWXNRYMRYJwWUnS0zw.png"/></div></div></figure><p id="d782" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">整个时期的时间序列都是这样的。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi ml"><img src="../Images/b216fa0a947224db345231eb0a7ef823.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wJtbzWZ4VuJDRs5xszerMw.png"/></div></div></figure><p id="9dfc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们感兴趣的数据是价格的波动性，本质上是价格的标准差。由于我们使用的是有高低点数据的烛台数据，我用分钟棒线内的最高价减去最低价来估算波动率，并应用大小为<em class="mm"> n </em>的滚动平均窗口。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mn"><img src="../Images/cd8cbcc933ee9f245df11c58cf4ae684.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U3Dz_z_WTos0PIqgB1P5og.png"/></div></div></figure><p id="dd8c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">原则上，当价格波动较大时，成交量应该较高，作为一项明智的检查，我们随机选取了一个交易日，对照当天的价格查看其成交量，以确认这一点。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mo"><img src="../Images/4c25962b79f66142dd6b0031650408dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7f8JO51gjk4VnkqGVPVcvQ.png"/></div></div></figure><p id="834e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了比较所有交易日的成交量，我绘制了基于时间的成交量图。vol是根据5分钟的时间窗口计算的。每个点代表过去5分钟的vol，它是在1070天内每分钟计算的。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mp"><img src="../Images/665a2bee846dd11d622ab47539dfd06b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wq7bjajsoPWHdBQCXvYB0A.png"/></div></div></figure><p id="be6d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到，峰值似乎以一小时为一段复制，例如0000和0100、0700和0800处的峰值。让我们绘制热图来检查这些值。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mq"><img src="../Images/62e228be9b1d906aa477c3a054bbd8aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D9LHI8mzVaHgItCztbiaVw.png"/></div></div></figure><p id="2dd4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到夏令时的影响，所以我们需要通过将夏令时改为GMT来使这种影响正常化，如下所示。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mr"><img src="../Images/2c70f0e3eb29428a0a91e5e80e51eddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JYPmVndP20fG-iHEDrq0lA.png"/></div></div></figure><p id="107e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有些时期vol最大。热图中的实线表示在某些时候持续的高波动性，所有这些都是合理的。</p><ul class=""><li id="768d" class="ms mt iq kh b ki kj kl km ko mu ks mv kw mw la mx my mz na bi translated">0100:开始差价合约交易</li><li id="3462" class="ms mt iq kh b ki nb kl nc ko nd ks ne kw nf la mx my mz na bi translated">0700:欧盟盘前开盘</li><li id="6438" class="ms mt iq kh b ki nb kl nc ko nd ks ne kw nf la mx my mz na bi translated">0800:英国市场开盘</li><li id="1075" class="ms mt iq kh b ki nb kl nc ko nd ks ne kw nf la mx my mz na bi translated">中午12点</li><li id="3995" class="ms mt iq kh b ki nb kl nc ko nd ks ne kw nf la mx my mz na bi translated">14:30:美国市场开盘</li><li id="448b" class="ms mt iq kh b ki nb kl nc ko nd ks ne kw nf la mx my mz na bi translated">1630:英国市场收盘</li></ul><p id="0abf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还可以看到2020年3月全天的高波动性。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi ng"><img src="../Images/592b0f0142e53679f8142c92b277e8b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SM2QaXps-0zv2Xz67S1VPQ.png"/></div></div></figure><p id="d9aa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们想利用波动性，越高越好，因此利息最高的时间是开市时间，即0800。如果我们可以使用开市前一小时的成交量来预测开市后5分钟的成交量，而开市后5分钟的成交量通常是一天中最高的，我们就可以围绕这个成交量进行交易。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi nh"><img src="../Images/0c7f50fd2ae668c1a8e3bf3da8e8ad6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sRxEaJhePBm4QGFVEmmIYw.png"/></div></div></figure><p id="8a3f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上图显示了2016年至2020年间所有交易日的综合成交量。我们可以看到，在0800点开盘后，成交量往往会上升，几分钟后就会冷却下来。</p><p id="1954" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们假设开市前后的成交量之间存在相关性。因此，如果我们在开市前一小时画出成交量的平均值，在开市后5分钟画出成交量的平均值，我们应该有一个总体上升的趋势，事实也确实如此。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi ni"><img src="../Images/59c7f4edfe922cc658f5f86d306e1ce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3CbhThNTlM2B9qk7_t0oWw.png"/></div></div></figure><p id="ab23" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">x轴是开市前1小时的平均成交量，y轴是开市后5分钟的平均成交量。这两者之间有相关性，但有很多差异，因此它不是一个可靠的预测。例如，基于此图表，如果我们在开市前的平均成交量为7.5，则有理由假设我们在开市后的成交量将在5到25之间，这不是很有帮助。</p><h1 id="a16f" class="nj lc iq bd ld nk nl nm lg nn no np lj jw nq jx lm jz nr ka lp kc ns kd ls nt bi translated">有趣的是</h1><p id="990f" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">我们基本上已经对开市前后的成交量做了线性回归分析。然而，公平地说，更复杂的技术，并证明这些技术确实是可预测的。我们将1070个样本分成三组:训练组、验证组和测试组。</p><ul class=""><li id="1329" class="ms mt iq kh b ki kj kl km ko mu ks mv kw mw la mx my mz na bi translated">列车:0–699(2018–10–09结束)</li><li id="75f9" class="ms mt iq kh b ki nb kl nc ko nd ks ne kw nf la mx my mz na bi translated">验证:700–899(2019年7月25日结束)</li><li id="b27b" class="ms mt iq kh b ki nb kl nc ko nd ks ne kw nf la mx my mz na bi translated">测试:900–1070(结束于2020年3月25日)</li></ul><h2 id="315d" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">经典方法1 —线性回归</h2><p id="fbce" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">由于现在有一个分割，线性回归的统计数据将与使用完整数据集生成的统计数据略有不同。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi nu"><img src="../Images/0b59d4e82e862f71dbcfb7baba2e8425.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aloPvvO-hoBY4G54PvfPXQ.png"/></div></div></figure><p id="c59f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据上面的图表，我们可以看到强相关性仍然存在，但决定系数很低，我们不能用这种技术解释开市后成交量的变化。</p><p id="5c2a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要提高预测，方法之一就是增加特征的数量，这就引出了<strong class="kh ir">多元回归</strong>。在这种情况下，我们可以利用开市前一小时的每一分钟来预测开市后的成交量。这应该会给我们一个比开市前波动率简单均值更好的结果。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi nv"><img src="../Images/4777c5a668bf20067f51969c0fbcc1f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sUvfAb0bPg7E4xbBgl-4Jw.png"/></div></div></figure><p id="5aa9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有的统计数据都有轻微的改善，但是，它仍然不是很有用。这里所有的线性回归都使用statsmodel库中的OLS。</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="a3af" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">经典方法2 —梯度推进法</h2><p id="a14a" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">执行预测(尤其是分类)时，梯度增强是标准方法，它将为您提供一个非常好的进一步改进的基准。尽管在预测连续表面时，基于梯度推进的回归结果可能不稳定。它通常以最小的努力给出合理的性能。</p><p id="d3ce" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里我们选择了LightGBM作为库。用于输入模型的特征基本上与多变量回归相同。</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="be03" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于5个不同的交叉验证评估，该模型在我们数据样本的不同部分不是非常稳定，这表明在我们数据的不同部分中存在某种异常样本的不平衡。虽然当我们更深入地研究预测过程时，这可能是一个问题，但是对于本文的范围来说，只要我们有相同的训练集、验证集和测试集，我们就不需要担心那么多，因为这本质上是第一轮预测方法选择过程。</p><p id="928c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如前所述，我们需要在不同的技术中保持样本的一致性，因此我们只训练前700个样本，并预测900个以上的样本。</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="d3d6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我们设计训练集和测试集的结果。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi ny"><img src="../Images/86e79d545cf043b2c57b8245b887cb2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r96MDEOSWa-jZbDtv1zzOQ.png"/></div></div></figure><p id="1df5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">训练结果是令人鼓舞的，r平方得分为0.94，但测试集中的预测失败了。尽管它在测试集中做得不太好，但它仍然优于我们使用纯线性回归数据所做的预测。</p><h2 id="cef7" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">经典方法3 — MLP(神经网络)</h2><p id="33b4" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">当我们在预测中有如此高的方差时，神经网络可能能够描述输入特征之间的复杂关系，并发现它们之间的任何隐藏关系。</p><p id="325a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们正在使用<a class="ae nz" href="https://www.fast.ai/" rel="noopener ugc nofollow" target="_blank"> FastAI </a>作为深度学习库来构建底层网络，目前来看，FastAI是建立在PyTorch之上的。您可以描述定制的PyTorch模型，并将其传递给FastAI，以获得FastAI提供的培训小工具。</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="d58a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用与LightGBM相同的一组输入和输出，并将数据输入到一个有两个隐藏层的MLP网络中，每个隐藏层有300个神经元。</p><p id="43fb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">经过几次迭代训练后，我们可以得到一个与此类似的预测结果。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mo"><img src="../Images/12c0529e3684cc38da159644c84f73e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*byGGZqp6WjFNqftp36HdAA.png"/></div></div></figure><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi oa"><img src="../Images/e6405275eb571544f162324992718da8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZIkVuv3OuFZ1GOs2k42T_A.png"/></div></div></figure><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi ob"><img src="../Images/03ab44d419b1148f8989e6bba9bdc45f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dttp_hduBhOjA8z7iBideQ.png"/></div></div></figure><p id="1001" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到，由于市场最近的波动性，测试集中的波动性最高，因此我们的验证数据集对我们的测试数据来说不是很有代表性。然而，与以前的技术相比，它在统计方面仍然做得很好。</p><h1 id="fd03" class="nj lc iq bd ld nk nl nm lg nn no np lj jw nq jx lm jz nr ka lp kc ns kd ls nt bi translated">基于图像识别的回归</h1><p id="c3c7" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">在我们继续进行基于图像的回归之前，我们的目标参数需要稍微改变一下，因为在转换过程中我们会丢失数值。因为在转换过程中，在转换成图像之前，这些值在每个时间窗口内被归一化。</p><p id="7d76" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了补偿它，我们使用开市前和开市后的平均成交量之比作为我们的目标。这样我们就向神经网络提出了一个稍微不同的问题。相对于开市前的成交量，开市后的市场波动有多大？例如，如果开市前的平均成交量为10，开市后的成交量为50，我们要预测的目标将是5，而不是原始的50。</p><p id="3733" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了防止拿苹果和橙子做比较，我训练了一个MLP网络，它以前有相同的结构，使用相同的数据。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi oc"><img src="../Images/57fc0d6e99608ad7e7131f50f1c92280.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JCutteX4NLS6KDUOL8aqNw.png"/></div></div></figure><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi od"><img src="../Images/682c17eed9aceff2b7006b88ee21ce01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N9le1U73WKovmuoCs5B5eg.png"/></div></div></figure><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi oe"><img src="../Images/40de2c9d6807c76c3a64c85fc6bf3afc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_GoNuHWfTrYOEvhmW5PDJQ.png"/></div></div></figure><p id="ac3f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注意:vol的上限是30，因为在除法计算后会出现巨大的峰值，如下所示。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi of"><img src="../Images/9622cec0da6ef668689ad45bec225880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pJKMV9GI52BZ4D4d3gCpFQ.png"/></div></div><p class="og oh gj gh gi oi oj bd b be z dk translated">原始卷后/卷前</p></figure><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi ok"><img src="../Images/c6bbf77bf0e2302f3807bc258a147a30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ralInwvZuGNu5zKFkZUJ_A.png"/></div></div><p class="og oh gj gh gi oi oj bd b be z dk translated">封顶@30卷_后/卷_前</p></figure><p id="c9a9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与原始值预测相比，MLP间接预测的结果稍微差一些，但差别不大。现在我们有了一个CNN网络的基线来比较。</p><h2 id="8200" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">图像转换</h2><p id="17ef" class="pw-post-body-paragraph kf kg iq kh b ki lu jr kk kl lv ju kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">在Gramian Angular Field和pyts库的帮助下，我们现在可以根据点之间的极坐标关系将任何时间序列转换为图像。[ <a class="ae nz" href="https://arxiv.org/pdf/1506.00327.pdf" rel="noopener ugc nofollow" target="_blank">原文</a></p><p id="d184" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这段代码中，它每天创建一个图像，每个图像描述开市前60分钟的vol。我们还将目标体积比导出为CSV格式，以便在FastAI中导入标签。</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="aa75" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于CNN网络，它实际上是使用ResNET34作为底层，并在顶层安装一个[1024，512]密集层，并使用简单的线性激活节点执行最终回归。</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="0616" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">经过几次迭代训练，我们得到了这样的结果。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi ol"><img src="../Images/4c79e0cbbf957e1ae4c185b6ad6079a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fHb0GZgFtB56AvcUQIM4ZQ.png"/></div></div></figure><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi om"><img src="../Images/caddc4c8db14b2e785cc1c8ca4edc2d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7jMYdXLjIskHxxCTyUMDGQ.png"/></div></div></figure><p id="6346" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到，即使预测相同的目标，基于图像的回归比MLP的回归执行得好得多。</p><p id="3a16" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是所有不同技术的统计数据汇总，以供比较。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi on"><img src="../Images/f6ab78cf2b660c43065236aea6e9c869.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X--8Kow-csuf2a775INfHQ.png"/></div></div></figure><p id="8b09" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到，在预测绝对音量值时，MLP优于所有其他方法，而在预测相对音量比时，CNN在各个方面都优于相同的网络。</p><p id="f134" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，当进行时间序列预测时，CNN技术是一个突出的候选选择，尽管它在图像转换和训练方面确实需要更多的计算能力。</p><p id="c12f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果有人感兴趣，我们可以将原始的波动性结果提供给CNN的最后几层，但这不是本文的范围。如果你有任何其他想法或想法，请告诉我，希望你喜欢。</p></div></div>    
</body>
</html>