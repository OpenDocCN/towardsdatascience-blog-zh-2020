<html>
<head>
<title>One-proportion and goodness of fit test (in R and by hand)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一次比例和拟合优度检验(在 R 和手工中)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand-8c7997013c84?source=collection_archive---------55-----------------------#2020-05-13">https://towardsdatascience.com/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand-8c7997013c84?source=collection_archive---------55-----------------------#2020-05-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7fad" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何执行单一比例和拟合优度测试，这对于检查分布是否遵循特定的已知分布非常有用</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/73746f3288237e2069e7dd41a8e262f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LiwNjENVzma7-ItR"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@roman_lazygeek?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">罗曼·马格</a>拍摄</p></figure><h1 id="4242" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="fa60" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi mn translated"><span class="l mo mp mq bm mr ms mt mu mv di">在</span>之前的一篇文章中，我介绍了 R 中独立性的<a class="ae ky" href="https://www.statsandr.com/blog/chi-square-test-of-independence-in-r/" rel="noopener ugc nofollow" target="_blank">卡方检验，它用于检验两个</a><a class="ae ky" href="https://www.statsandr.com/blog/variable-types-and-examples/#qualitative" rel="noopener ugc nofollow" target="_blank">分类</a>变量之间的独立性。在本文中，我展示了如何执行，首先在 R 中，然后手动执行:</p><ol class=""><li id="f7ce" class="mw mx it lt b lu my lx mz ma na me nb mi nc mm nd ne nf ng bi translated">一比例检验(也称为单样本比例检验)</li><li id="17ed" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm nd ne nf ng bi translated">卡方拟合优度检验</li></ol><p id="159c" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">当定性变量只有<strong class="lt iu">两个类别</strong>时，第一个测试用于比较观察比例和预期比例。第二个测试用于比较多个观察比例和多个预期比例，在这种情况下，定性变量有<strong class="lt iu">两个或更多类别</strong>。</p><p id="7023" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">这两种检验都允许检验定性变量水平之间的比例是否相等，或者检验给定比例是否相等。这些给定的比例可以任意确定或基于已知分布的理论概率。</p><h1 id="437d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">在 R 中</h1><h1 id="cbe3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数据</h1><p id="04c1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在本节中，我们使用与关于<a class="ae ky" href="https://www.statsandr.com/blog/descriptive-statistics-in-r/" rel="noopener ugc nofollow" target="_blank">描述性统计</a>的文章中相同的数据集。这是众所周知的<code class="fe np nq nr ns b">iris</code>数据集，我们向其中添加了变量<code class="fe np nq nr ns b">size</code>。如果花瓣的长度小于所有花的中值，变量<code class="fe np nq nr ns b">size</code>对应<code class="fe np nq nr ns b">small</code>，否则对应<code class="fe np nq nr ns b">big</code>:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="0076" class="nx la it ns b gy ny nz l oa ob"># load iris dataset<br/>dat &lt;- iris</span><span id="a2ba" class="nx la it ns b gy oc nz l oa ob"># create size variable<br/>dat$size &lt;- ifelse(dat$Sepal.Length &lt; median(dat$Sepal.Length),<br/>  "small", "big"<br/>)</span><span id="1012" class="nx la it ns b gy oc nz l oa ob"># show first 5 observations<br/>head(dat, n = 5)</span><span id="d5da" class="nx la it ns b gy oc nz l oa ob">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species  size<br/>## 1          5.1         3.5          1.4         0.2  setosa small<br/>## 2          4.9         3.0          1.4         0.2  setosa small<br/>## 3          4.7         3.2          1.3         0.2  setosa small<br/>## 4          4.6         3.1          1.5         0.2  setosa small<br/>## 5          5.0         3.6          1.4         0.2  setosa small</span></pre><h1 id="130a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">一比例检验</h1><p id="21ab" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于这个例子，我们有一个 150 朵花的样本，我们想测试小花的比例是否与大花的比例相同(通过变量<code class="fe np nq nr ns b">size</code>测量)。以下是按大小排列的花朵数量，以及相应的比例:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="afc3" class="nx la it ns b gy ny nz l oa ob"># barplot<br/>library(ggplot2)<br/>ggplot(dat) +<br/>  aes(x = size) +<br/>  geom_bar(fill = "#0c4c8a") +<br/>  theme_minimal()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/93feb309c9ed4d9cc1144c1d4519db0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vOcfod-OiKzVQD-1.png"/></div></div></figure><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="564c" class="nx la it ns b gy ny nz l oa ob"># counts by size<br/>table(dat$size)</span><span id="4ad6" class="nx la it ns b gy oc nz l oa ob">## <br/>##   big small <br/>##    77    73</span><span id="2d20" class="nx la it ns b gy oc nz l oa ob"># proportions by size, rounded to 2 decimals<br/>round(prop.table(table(dat$size)), 2)</span><span id="e30a" class="nx la it ns b gy oc nz l oa ob">## <br/>##   big small <br/>##  0.51  0.49</span></pre><p id="16c1" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">在构成我们样本的 150 朵花中，51%和 49%分别是大的和小的。为了测试两种尺寸的比例是否相同，我们使用接受以下参数的<code class="fe np nq nr ns b">prop.test()</code>函数:</p><ul class=""><li id="3626" class="mw mx it lt b lu my lx mz ma na me nb mi nc mm oe ne nf ng bi translated">成功次数</li><li id="1e19" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm oe ne nf ng bi translated">观察/试验次数</li><li id="1ccd" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm oe ne nf ng bi translated">预期概率(我们要测试的概率)</li></ul><p id="b462" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">(任意地)考虑到<code class="fe np nq nr ns b">big</code>是成功的，我们有:<a class="ae ky" href="https://www.statsandr.com/blog/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand/#fn1" rel="noopener ugc nofollow" target="_blank"> 1 </a></p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="d71b" class="nx la it ns b gy ny nz l oa ob"># one-proportion test<br/>test &lt;- prop.test(<br/>  x = 77, # number of successes<br/>  n = 150, # total number of trials (77 + 73)<br/>  p = 0.5<br/>) # we test for equal proportion so prob = 0.5 in each group</span><span id="d7f3" class="nx la it ns b gy oc nz l oa ob">test</span><span id="aa1c" class="nx la it ns b gy oc nz l oa ob">## <br/>##  1-sample proportions test with continuity correction<br/>## <br/>## data:  77 out of 150, null probability 0.5<br/>## X-squared = 0.06, df = 1, p-value = 0.8065<br/>## alternative hypothesis: true p is not equal to 0.5<br/>## 95 percent confidence interval:<br/>##  0.4307558 0.5952176<br/>## sample estimates:<br/>##         p <br/>## 0.5133333</span></pre><p id="d804" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">我们通过零概率(<code class="fe np nq nr ns b">0.5</code>)、检验统计量(<code class="fe np nq nr ns b">X-squared = 0.06</code>)、自由度(<code class="fe np nq nr ns b">df = 1</code>)、<em class="of">p</em>-值(<code class="fe np nq nr ns b">p-value = 0.8065</code>)、替代假设(<code class="fe np nq nr ns b">true p is not equal to 0.5</code>)、95%置信区间(也可以用<code class="fe np nq nr ns b">test$conf.int</code>提取)和样本中的比例(<code class="fe np nq nr ns b">0.5133333</code>)获得一个输出。</p><p id="5ab2" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">p 值为 0.806，因此，在 5%的显著性水平上，我们不拒绝小花朵和大花朵的比例相同的无效假设。</p><h1 id="75f0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><code class="fe np nq nr ns b">prop.test()</code>和<code class="fe np nq nr ns b">binom.test()</code>的假设</h1><p id="f421" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">注意<code class="fe np nq nr ns b">prop.test()</code>使用二项式分布的正态近似值。所以这个测试的一个假设是样本量足够大(通常是，<em class="of"> n &gt; 30 </em>)。如果样本量较小，建议使用精确二项式检验。</p><p id="fc48" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">可以使用<code class="fe np nq nr ns b">binom.test()</code>函数执行精确的二项式测试，并接受与<code class="fe np nq nr ns b">prop.test()</code>函数相同的参数。对于本例，假设我们有一个 12 朵大花和 3 朵小花的样本，我们想测试两种花的比例是否相同:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="eb42" class="nx la it ns b gy ny nz l oa ob"># barplot<br/>barplot(c(12, 3), # observed counts<br/>  names.arg = c("big", "small"), # rename labels<br/>  ylab = "Frequency", # y-axis label<br/>  xlab = "Size" # x-axis label<br/>)<br/>abline(<br/>  h = 15 / 2, # expected counts in each level<br/>  lty = 2 # dashed line<br/>)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/41eee42221ee9f247c06babd1882c53b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*02_Nf394QG5KR_ZK.png"/></div></div></figure><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="0382" class="nx la it ns b gy ny nz l oa ob"># exact binomial test<br/>test &lt;- binom.test(<br/>  x = 12, # counts of successes<br/>  n = 15, # total counts (12 + 3)<br/>  p = 0.5 # expected proportion<br/>)</span><span id="f169" class="nx la it ns b gy oc nz l oa ob">test</span><span id="b7c3" class="nx la it ns b gy oc nz l oa ob">## <br/>##  Exact binomial test<br/>## <br/>## data:  12 and 15<br/>## number of successes = 12, number of trials = 15, p-value = 0.03516<br/>## alternative hypothesis: true probability of success is not equal to 0.5<br/>## 95 percent confidence interval:<br/>##  0.5191089 0.9566880<br/>## sample estimates:<br/>## probability of success <br/>##                    0.8</span></pre><p id="29e0" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">p 值为 0.035，因此，在 5%的显著性水平上，我们拒绝零假设，我们得出结论，小花和大花的比例显著不同。这相当于断定大花的比例与 0.5 显著不同(因为只有两种大小)。</p><p id="d57e" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">如果要测试大花比例大于 50%，在<code class="fe np nq nr ns b">binom.test()</code>函数中加入<code class="fe np nq nr ns b">alternative = "greater"</code>自变量:<a class="ae ky" href="https://www.statsandr.com/blog/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand/#fn2" rel="noopener ugc nofollow" target="_blank"> 2 </a></p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="9e83" class="nx la it ns b gy ny nz l oa ob">test &lt;- binom.test(<br/>  x = 12, # counts of successes<br/>  n = 15, # total counts (12 + 3)<br/>  p = 0.5, # expected proportion<br/>  alternative = "greater" # test that prop of big flowers is &gt; 0.5<br/>)</span><span id="6062" class="nx la it ns b gy oc nz l oa ob">test</span><span id="f2fc" class="nx la it ns b gy oc nz l oa ob">## <br/>##  Exact binomial test<br/>## <br/>## data:  12 and 15<br/>## number of successes = 12, number of trials = 15, p-value = 0.01758<br/>## alternative hypothesis: true probability of success is greater than 0.5<br/>## 95 percent confidence interval:<br/>##  0.5602156 1.0000000<br/>## sample estimates:<br/>## probability of success <br/>##                    0.8</span></pre><p id="227a" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">p 值为 0.018，因此，在 5%的显著性水平上，我们拒绝零假设，我们得出结论，大花的比例明显大于 50%。</p><h1 id="51b8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">卡方拟合优度检验</h1><p id="e113" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在假设定性变量有两个以上的级别，如变量<code class="fe np nq nr ns b">Species</code>的情况:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="2e92" class="nx la it ns b gy ny nz l oa ob"># barplot<br/>ggplot(dat) +<br/>  aes(x = Species) +<br/>  geom_bar(fill = "#0c4c8a") +<br/>  theme_minimal()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/b1fc5d4f049c9f3c43764176ec6c8462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sMSgHNDvvsnxNMCG.png"/></div></div></figure><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="b53b" class="nx la it ns b gy ny nz l oa ob"># counts by Species<br/>table(dat$Species)</span><span id="661c" class="nx la it ns b gy oc nz l oa ob">## <br/>##     setosa versicolor  virginica <br/>##         50         50         50</span></pre><p id="356e" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">变量<code class="fe np nq nr ns b">Species</code>有 3 个级别，每个级别有 50 个观察值。假设在这个例子中，我们想测试这三个物种是否同样常见。如果它们同样普遍，那么它们将平均分布，每个物种的预期比例将是 1/3。</p><p id="dd6d" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">这个测试可以用<code class="fe np nq nr ns b">chisq.test()</code>函数完成，接受以下参数:</p><ul class=""><li id="e470" class="mw mx it lt b lu my lx mz ma na me nb mi nc mm oe ne nf ng bi translated">代表观察到的比例的数字向量</li><li id="3801" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm oe ne nf ng bi translated">代表预期比例的概率向量(与观察到的比例长度相同)</li></ul><p id="0ba7" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">适用于我们的研究问题(即，这三个物种是否同样常见？)，我们有:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="4b10" class="nx la it ns b gy ny nz l oa ob"># goodness of fit test<br/>test &lt;- chisq.test(table(dat$Species), # observed proportions<br/>  p = c(1 / 3, 1 / 3, 1 / 3) # expected proportions<br/>)</span><span id="4a13" class="nx la it ns b gy oc nz l oa ob">test</span><span id="83cd" class="nx la it ns b gy oc nz l oa ob">## <br/>##  Chi-squared test for given probabilities<br/>## <br/>## data:  table(dat$Species)<br/>## X-squared = 0, df = 2, p-value = 1</span></pre><p id="e31e" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated"><em class="of">p</em>-值为 1，因此，在 5%的显著性水平上，我们不拒绝所有物种之间比例相等的无效假设。</p><p id="01fe" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">即使在进行统计测试之前，这也是非常明显的，因为每个物种正好有 50 朵花，所以很容易看出这些物种是同样常见的。然而，我们仍然进行了测试，以显示它在实践中是如何工作的。</p><h1 id="f25f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">我的分布是否遵循给定的分布？</h1><p id="1702" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在上一节中，我们自己选择了比例。拟合优度测试对于将观察到的比例与基于某种已知分布的预期比例进行比较也特别有用。</p><p id="e006" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">记住测试的假设:</p><ul class=""><li id="e8af" class="mw mx it lt b lu my lx mz ma na me nb mi nc mm oe ne nf ng bi translated">H0:观察到的频率和预期的频率之间没有显著的差异</li><li id="7e67" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm oe ne nf ng bi translated">H1:观察到的频率和预期的频率有很大的差异</li></ul><p id="a690" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">对于这个例子，假设我们测量了 100 个有 5 个孩子的家庭中女孩的数量。我们想测试(观察到的)数字女孩的分布是否遵循二项分布。</p><h2 id="cb53" class="nx la it bd lb og oh dn lf oi oj dp lj ma ok ol ll me om on ln mi oo op lp oq bi translated">观察到的频率</h2><p id="6bd2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在我们的 100 个有 5 个孩子的家庭样本中，每个家庭的女孩数量分布如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/b0c4629a93c5313ea89eb934228fec84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BWU-j3GoONtYfIKw.png"/></div></div></figure><p id="4cad" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">以及相应的频率和相对频率(记住相对频率是频率除以总样本量):</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="4fe9" class="nx la it ns b gy ny nz l oa ob"># counts<br/>dat</span><span id="de24" class="nx la it ns b gy oc nz l oa ob">##   Girls Frequency Relative_freq<br/>## 1     0         5          0.05<br/>## 2     1        12          0.12<br/>## 3     2        28          0.28<br/>## 4     3        33          0.33<br/>## 5     4        17          0.17<br/>## 6     5         5          0.05</span></pre><h2 id="ed49" class="nx la it bd lb og oh dn lf oi oj dp lj ma ok ol ll me om on ln mi oo op lp oq bi translated">预期频率</h2><p id="50cb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了将观察到的频率与二项式分布进行比较，并查看两种分布是否匹配，我们首先需要确定在二项式分布的情况下将获得的预期频率。假设生女孩的概率为 0.5(5 个孩子中的每一个)，预期频率如下:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="f57c" class="nx la it ns b gy ny nz l oa ob"># create expected frequencies for a binomial distribution<br/>x &lt;- 0:5<br/>df &lt;- data.frame(<br/>  Girls = factor(x),<br/>  Expected_relative_freq = dbinom(x, size = 5, prob = 0.5)<br/>)<br/>df$Expected_freq &lt;- df$Expected_relative_freq * 100 # *100 since there are 100 families</span><span id="f6bf" class="nx la it ns b gy oc nz l oa ob"># create barplot<br/>p &lt;- ggplot(df, aes(x = Girls, y = Expected_freq)) +<br/>  geom_bar(stat = "identity", fill = "#F8766D") +<br/>  xlab("Number of girls per family") +<br/>  ylab("Expected frequency") +<br/>  labs(title = "Binomial distribution Bi(x, n = 5, p = 0.5)") +<br/>  theme_minimal()<br/>p</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/97b714d00c6cef27f9a9cc95185e0f68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VCZUUTKnYmfjGRuI.png"/></div></div></figure><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="8f02" class="nx la it ns b gy ny nz l oa ob"># expected relative frequencies and (absolute) frequencies<br/>df</span><span id="6a7d" class="nx la it ns b gy oc nz l oa ob">##   Girls Expected_relative_freq Expected_freq<br/>## 1     0                0.03125         3.125<br/>## 2     1                0.15625        15.625<br/>## 3     2                0.31250        31.250<br/>## 4     3                0.31250        31.250<br/>## 5     4                0.15625        15.625<br/>## 6     5                0.03125         3.125</span></pre><h2 id="f14a" class="nx la it bd lb og oh dn lf oi oj dp lj ma ok ol ll me om on ln mi oo op lp oq bi translated">观察频率与预期频率</h2><p id="bafa" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在，我们将观察到的频率与预期的频率进行比较，看两者是否有显著差异。如果两者相差很大，我们就不接受每个有 5 个孩子的家庭的女孩数量服从二项式分布的假设。另一方面，如果观察到的和预期的频率相似，我们不拒绝每个家庭的女孩数量遵循二项分布的假设。</p><p id="185a" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">视觉上我们有:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="4b27" class="nx la it ns b gy ny nz l oa ob"># create data<br/>data &lt;- data.frame(<br/>  num_girls = factor(rep(c(0:5), times = 2)),<br/>  Freq = c(dat$Freq, df$Expected_freq),<br/>  obs_exp = c(rep("observed", 6), rep("expected", 6))<br/>)</span><span id="1bdc" class="nx la it ns b gy oc nz l oa ob"># create plot<br/>ggplot() +<br/>  geom_bar(<br/>    data = data, aes(<br/>      x = num_girls, y = Freq,<br/>      fill = obs_exp<br/>    ),<br/>    position = "dodge", # bar next to each other<br/>    stat = "identity"<br/>  ) +<br/>  ylab("Frequency") +<br/>  xlab("Number of girls per family") +<br/>  theme_minimal() +<br/>  theme(legend.title = element_blank()) # remove legend title</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/02fc8050cfd4f51137a40cf9a097c4c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ihoT1cTt3dRbR1sI.png"/></div></div></figure><p id="b418" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">我们看到观察到的和预期的频率非常相似，所以我们预计有 5 个孩子的家庭中女孩的数量遵循二项分布。然而，只有拟合优度测试会证实我们的信念:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="1b75" class="nx la it ns b gy ny nz l oa ob"># goodness of fit test<br/>test &lt;- chisq.test(dat$Freq, # observed frequencies<br/>  p = df$Expected_relative_freq # expected proportions<br/>)</span><span id="02ce" class="nx la it ns b gy oc nz l oa ob">test</span><span id="a082" class="nx la it ns b gy oc nz l oa ob">## <br/>##  Chi-squared test for given probabilities<br/>## <br/>## data:  dat$Freq<br/>## X-squared = 3.648, df = 5, p-value = 0.6011</span></pre><p id="3c11" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated"><em class="of">p</em>-值为 0.601，因此，在 5%的显著性水平上，我们不拒绝观测频率和预期频率相等的无效假设。这相当于得出结论，我们不能拒绝五个孩子的家庭中的女孩数量遵循二项分布的假设(因为预期频率是基于二项分布的)。</p><p id="ad50" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">请注意，拟合优度测试当然可以用二项式分布以外的其他分布类型来执行。例如，如果您想要测试观察到的分布是否遵循泊松分布，此测试可用于将观察到的频率与泊松分布情况下获得的预期比例进行比较。</p><h1 id="e77c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">用手</h1><p id="3019" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">既然我们已经展示了如何在 R 中执行一次比例和拟合优度测试，那么在本节中我们将展示如何手工执行这些测试。我们首先说明一比例检验，然后是卡方拟合优度检验。</p><h1 id="b415" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">一比例检验</h1><p id="3e91" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于这个例子，假设我们投掷一枚硬币 100 次，注意到它有 67 次正面朝上。接下来，我们要测试硬币是否公平，即测试正面或反面落地的概率是否等于 50%。</p><p id="adb3" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">对于许多假设检验，我们通过 4 个简单的步骤来完成:</p><ol class=""><li id="0159" class="mw mx it lt b lu my lx mz ma na me nb mi nc mm nd ne nf ng bi translated">陈述无效假设和替代假设</li><li id="2336" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm nd ne nf ng bi translated">计算检验统计量(也称为 t-stat)</li><li id="3761" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm nd ne nf ng bi translated">找到拒绝区域</li><li id="59fa" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm nd ne nf ng bi translated">通过比较检验统计量和拒绝区域得出结论</li></ol><p id="b1ec" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated"><strong class="lt iu">第一步。</strong></p><p id="ad0e" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">在我们的例子中，无效假设和替代假设是:</p><ul class=""><li id="9a7b" class="mw mx it lt b lu my lx mz ma na me nb mi nc mm oe ne nf ng bi translated">H0: p0 = 0.5</li><li id="fcfa" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm oe ne nf ng bi translated">H1: p0 ≠ 0.5</li></ul><p id="7665" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">其中 p0 是头部着地的预期比例。</p><p id="d75b" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated"><strong class="lt iu">第二步。</strong></p><p id="3d13" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">测试统计为:<a class="ae ky" href="https://www.statsandr.com/blog/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand/#fn3" rel="noopener ugc nofollow" target="_blank"> 3 </a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi or"><img src="../Images/260f444973c945e9cc4ff2d1fe785c32.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*31q378ziYMCQEY1dPB-a-g.png"/></div></figure><p id="6687" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">(如果你在计算检验统计量时需要更多帮助，请参阅如何在一个闪亮的应用程序中执行<a class="ae ky" href="https://www.statsandr.com/blog/a-shiny-app-for-inferential-statistics-by-hand/" rel="noopener ugc nofollow" target="_blank">假设检验。)</a></p><p id="4c4e" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated"><strong class="lt iu">第三步。</strong></p><p id="d752" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">通过正态分布表找到拒绝区域。假设显著性水平α = 0.05，我们有:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/011abcf6ed4dc5ff821f8c00aa31eb06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*80p2vWqAGZfxDweZ.png"/></div></div></figure><p id="6779" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">z(α/2) = z(0.025) = 1.96</p><p id="adc4" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated"><strong class="lt iu">第四步。</strong></p><p id="b97c" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">我们将测试统计(在步骤 2 中找到)与拒绝区域(在步骤 3 中找到)进行比较，并得出结论。视觉上，我们有:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/531406d0cd78d1ea0e72728812d93d0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dYXXhhmmh1vVzmFI-2lhwQ.png"/></div></div></figure><p id="8311" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">测试统计位于拒绝区域内(即灰色阴影区域)。因此，在 5%的显著性水平上，我们拒绝零假设，我们得出结论，头部(以及尾部)的比例显著不同于 50%。换句话说，仍然在 5%的显著性水平，我们得出结论，硬币是不公平的。</p><p id="80ce" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">如果您更喜欢计算<em class="of">p</em>-值，而不是比较 t-stat 和拒绝区域，您可以使用这个<a class="ae ky" href="https://www.statsandr.com/blog/a-guide-on-how-to-read-statistical-tables/" rel="noopener ugc nofollow" target="_blank">闪亮的应用程序来轻松计算不同概率分布的<em class="of">p</em>-值</a>。打开应用程序后，设置 t-stat，相应的选项，你会在页面顶部找到<em class="of">p</em>-值。</p><h1 id="f8a6" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">R 中的验证</h1><p id="810b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了便于说明，下面是上面例子在 R 中的验证:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="e182" class="nx la it ns b gy ny nz l oa ob"># one-proportion test<br/>test &lt;- prop.test(<br/>  x = 67, # number of heads<br/>  n = 100, # number of trials<br/>  p = 0.5 # expected probability of heads<br/>)</span><span id="41ea" class="nx la it ns b gy oc nz l oa ob">test</span><span id="cfdf" class="nx la it ns b gy oc nz l oa ob">## <br/>##  1-sample proportions test with continuity correction<br/>## <br/>## data:  67 out of 100, null probability 0.5<br/>## X-squared = 10.89, df = 1, p-value = 0.0009668<br/>## alternative hypothesis: true p is not equal to 0.5<br/>## 95 percent confidence interval:<br/>##  0.5679099 0.7588442<br/>## sample estimates:<br/>##    p <br/>## 0.67</span></pre><p id="e7cb" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated"><em class="of">p</em>-值为 0.001，因此，在 5%的显著性水平上，我们拒绝正面和反面比例相等的无效假设，我们得出结论，硬币是有偏差的。这和手动发现的结论是一样的。</p><h1 id="d47e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">拟合优度检验</h1><p id="bcbe" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们现在用下面的例子来手工说明拟合优度测试。</p><p id="0133" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">假设我们掷骰子 100 次，我们记下它落在每个面上的次数(1 到 6)，然后测试骰子是否公平。以下是观察到的骰子点数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/af2de06c822b4d3e0de2fd7855ccd0d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1wGb0zF225iK3mnC.png"/></div></div></figure><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="25b9" class="nx la it ns b gy ny nz l oa ob">## dice_face<br/>##  1  2  3  4  5  6 <br/>## 15 24 10 19 19 13</span></pre><p id="179a" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">对于一个公平的骰子，我们会期望它在每个面上降落 100/6 ≈ 16.67 次(这个期望值在上图中用虚线表示)。尽管观察到的频率不同于预期值 16.67:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="4cdc" class="nx la it ns b gy ny nz l oa ob">##   dice_face observed_freq expected_freq<br/>## 1         1            15         16.67<br/>## 2         2            24         16.67<br/>## 3         3            10         16.67<br/>## 4         4            19         16.67<br/>## 5         5            19         16.67<br/>## 6         6            13         16.67</span></pre><p id="0475" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">我们需要测试它们是否有显著的不同。为此，我们按照上面提到的 4 个简单步骤进行适当的假设检验:</p><ol class=""><li id="a2b0" class="mw mx it lt b lu my lx mz ma na me nb mi nc mm nd ne nf ng bi translated">陈述无效假设和替代假设</li><li id="ac5b" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm nd ne nf ng bi translated">计算检验统计量(也称为 t-stat)</li><li id="a020" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm nd ne nf ng bi translated">找到拒绝区域</li><li id="4243" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm nd ne nf ng bi translated">通过比较检验统计量和拒绝区域得出结论</li></ol><p id="6575" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated"><strong class="lt iu">第一步。</strong></p><p id="793a" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">拟合优度检验的无效假设和替代假设是:</p><ul class=""><li id="c73b" class="mw mx it lt b lu my lx mz ma na me nb mi nc mm oe ne nf ng bi translated">H0:观察到的频率和预期的频率之间没有显著的差异</li><li id="8ddd" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm oe ne nf ng bi translated">H1:观察到的频率和预期的频率有很大的差异</li></ul><p id="5b69" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated"><strong class="lt iu">第二步。</strong></p><p id="30c9" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">测试统计数据为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/1b24b189c6a2d1fe8cad25140f0f32d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*gifJMDl8KbzbBeRUfrdefw.png"/></div></figure><p id="7c24" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">其中 Oi 是观察到的频率，Ei 是预期的频率，k 是类别的数量(在我们的例子中，有 6 个类别，代表 6 个骰子面)。</p><p id="eb70" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">这种χ2 统计量是通过计算每个类别中观察到的病例数和预期病例数之间的差异获得的。该差值被平方(以避免正负差值被补偿)并除以该类别中的预期病例数。然后将所有类别的这些值相加，总和被称为χ2 统计量。该检验统计量的大值导致无效假设被拒绝，小值意味着无效假设不能被拒绝。<a class="ae ky" href="https://www.statsandr.com/blog/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand/#fn4" rel="noopener ugc nofollow" target="_blank"> 4 </a></p><p id="6b25" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">根据我们的数据，我们有:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/2823e38859c8afa147135474e9bd3064.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I8eEdxxYdtP8QaeDc5WiYg.png"/></div></div></figure><p id="71f0" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated"><strong class="lt iu">第三步。</strong></p><p id="248e" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">χ2 检验统计量是小还是大取决于拒绝区域。通过χ2 分布表找到拒绝区域。自由度等于 k1(其中 k 为类别数)，假设显著性水平α = 0.05，则我们得到:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/171d4d36bafa082718e8284e56889b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*R5F2vlihkvf4hEFy.png"/></div></div></figure><p id="097a" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">χ2(α;k1)=χ2(0.05；5) = 11.0705</p><p id="0cbd" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated"><strong class="lt iu">第四步。</strong></p><p id="264d" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">我们将测试统计(在步骤 2 中找到)与拒绝区域(在步骤 3 中找到)进行比较，并得出结论。视觉上，我们有:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/e1e7e5aa9e2614a002386edb6db1211d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HSO1XP47UlTFtHce.png"/></div></div></figure><p id="6bd4" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">测试统计不在拒绝区域内(即灰色阴影区域)。因此，在 5%的显著性水平，我们不拒绝零假设，即观察到的频率和预期的频率之间没有显著差异。换句话说，仍然在 5%的显著性水平上，我们不能拒绝骰子是公平的假设。</p><p id="ae73" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">同样，您可以使用<a class="ae ky" href="https://www.statsandr.com/blog/a-guide-on-how-to-read-statistical-tables/" rel="noopener ugc nofollow" target="_blank">闪亮的应用程序</a>轻松计算给定测试统计的<em class="of">p</em>-值，如果您更喜欢这种方法而不是 t-stat 和拒绝区域之间的比较。</p><h1 id="8a35" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">R 中的验证</h1><p id="0bf4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了便于说明，下面是上面例子在 R 中的验证:</p><pre class="kj kk kl km gt nt ns nu nv aw nw bi"><span id="476c" class="nx la it ns b gy ny nz l oa ob"># goodness of fit test<br/>test &lt;- chisq.test(dat$observed_freq, # observed frequencies for each dice face<br/>  p = rep(1 / 6, 6) # expected probabilities for each dice face<br/>)</span><span id="4595" class="nx la it ns b gy oc nz l oa ob">test</span><span id="96fb" class="nx la it ns b gy oc nz l oa ob">## <br/>##  Chi-squared test for given probabilities<br/>## <br/>## data:  dat$observed_freq<br/>## X-squared = 7.52, df = 5, p-value = 0.1847</span></pre><p id="ccda" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">测试统计和自由度与手动发现的完全相同。<em class="of">p</em>-值为 0.185，仍处于 5%的显著性水平，得出的结论与手动得出的结论相同(即未能拒绝零假设)。</p><p id="42bf" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">感谢阅读。我希望这篇文章能帮助你理解并手工执行一比例和拟合优度检验。</p><p id="deac" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated">和往常一样，如果您有与本文主题相关的问题或建议，请将其添加为评论，以便其他读者可以从讨论中受益。</p></div><div class="ab cl ox oy hx oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="im in io ip iq"><ol class=""><li id="7f13" class="mw mx it lt b lu my lx mz ma na me nb mi nc mm nd ne nf ng bi translated">选择大或小作为成功事件给出了完全相同的结论。<a class="ae ky" href="https://www.statsandr.com/blog/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand/#fnref1" rel="noopener ugc nofollow" target="_blank"> ↩ </a></li><li id="fc31" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm nd ne nf ng bi translated">同样，这个自变量也可以加入到<code class="fe np nq nr ns b">prop.test()</code>函数中，检验观察比例是否大于预期比例。如果您想测试观察到的比例是否小于预期的比例，请使用<code class="fe np nq nr ns b">alternative = "less"</code>。<a class="ae ky" href="https://www.statsandr.com/blog/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand/#fnref2" rel="noopener ugc nofollow" target="_blank"> ↩ </a></li><li id="9b07" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm nd ne nf ng bi translated">这个测试的一个假设是 n⋅p≥5 和 n⋅(1−p)≥5.假设得到满足，因此我们可以使用二项分布的正态近似。<a class="ae ky" href="https://www.statsandr.com/blog/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand/#fnref3" rel="noopener ugc nofollow" target="_blank"> ↩ </a></li><li id="0b2a" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm nd ne nf ng bi translated">来源:<a class="ae ky" href="http://uregina.ca/~gingrich/ch10.pdf" rel="noopener ugc nofollow" target="_blank">http://uregina.ca/~gingrich/ch10.pdf</a>。<a class="ae ky" href="https://www.statsandr.com/blog/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand/#fnref4" rel="noopener ugc nofollow" target="_blank"> ↩ </a></li></ol><h1 id="5036" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">相关文章</h1><ul class=""><li id="3121" class="mw mx it lt b lu lv lx ly ma pe me pf mi pg mm oe ne nf ng bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/how-to-perform-a-one-sample-t-test-by-hand-and-in-r-test-on-one-mean/" rel="noopener ugc nofollow" target="_blank">如何手动执行单样本 t 检验，并对一个平均值进行 R:检验</a></li><li id="a710" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm oe ne nf ng bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/how-to-do-a-t-test-or-anova-for-many-variables-at-once-in-r-and-communicate-the-results-in-a-better-way/" rel="noopener ugc nofollow" target="_blank">如何在 R 中一次对多个变量进行 t 检验或方差分析，并以更好的方式传达结果</a></li><li id="304b" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm oe ne nf ng bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/student-s-t-test-in-r-and-by-hand-how-to-compare-two-groups-under-different-scenarios/" rel="noopener ugc nofollow" target="_blank">学生的 R 和手工 t 检验:如何在不同场景下比较两组</a></li><li id="f2af" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm oe ne nf ng bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/chi-square-test-of-independence-in-r/" rel="noopener ugc nofollow" target="_blank">R 中独立性的卡方检验</a></li><li id="4be1" class="mw mx it lt b lu nh lx ni ma nj me nk mi nl mm oe ne nf ng bi translated"><a class="ae ky" href="https://www.statsandr.com/blog/the-9-concepts-and-formulas-in-probability-that-every-data-scientist-should-know/" rel="noopener ugc nofollow" target="_blank">每个数据科学家都应该知道的概率中的 9 个概念和公式</a></li></ul></div><div class="ab cl ox oy hx oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="im in io ip iq"><p id="afd0" class="pw-post-body-paragraph lr ls it lt b lu my ju lw lx mz jx lz ma nm mc md me nn mg mh mi no mk ml mm im bi translated"><em class="of">原载于 2020 年 5 月 13 日 https://statsandr.com</em><em class="of">的</em> <a class="ae ky" href="https://statsandr.com/blog/one-proportion-and-goodness-of-fit-test-in-r-and-by-hand/" rel="noopener ugc nofollow" target="_blank"> <em class="of">。</em></a></p></div></div>    
</body>
</html>