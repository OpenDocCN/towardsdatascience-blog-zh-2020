<html>
<head>
<title>Push the Limits with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用熊猫挑战极限</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/push-the-limits-with-pandas-3132675c6ff2?source=collection_archive---------42-----------------------#2020-04-17">https://towardsdatascience.com/push-the-limits-with-pandas-3132675c6ff2?source=collection_archive---------42-----------------------#2020-04-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="843b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">熊猫的能力超乎你的想象。</h2></div><p id="16d9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Pandas是一个非常强大和通用的Python数据分析库，可以加速项目的预处理步骤。Pandas不仅用于预处理，还用于探索数据。你可以也应该挑战极限，看看熊猫有什么能力。在这篇文章中，我将重点讲述如何过滤数据帧，但更重要的是，我将努力传达这样的信息:</p><blockquote class="le"><p id="a74e" class="lf lg it bd lh li lj lk ll lm ln ld dk translated">你在数据分析中使用熊猫越多，它就越有用。</p></blockquote><figure class="lp lq lr ls lt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lo"><img src="../Images/cdb48c658fc0446e8c96e54e467594d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zrVvJCTV0YuqXVpsp_GDHQ.jpeg"/></div></div><p class="mb mc gj gh gi md me bd b be z dk">Photo by <a class="ae mf" href="https://unsplash.com/@danist07?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">贝莉儿 DANIST</a> on <a class="ae mf" href="https://unsplash.com/s/photos/plane?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></p></figure><p id="6343" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一如既往，我们从进口熊猫开始:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="4243" class="mp mq it ml b gy mr ms l mt mu">import pandas as pd<br/>import numpy as np</span></pre><p id="b23a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将使用Kaggle上的电信客户流失数据集的一部分。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="d4b1" class="mp mq it ml b gy mr ms l mt mu">df.head()</span></pre><figure class="mg mh mi mj gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mv"><img src="../Images/22e1bca7c05c4a0ac6a73da538651861.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*upXfvsPliWu01R1Zl3ffuA.png"/></div></div></figure><p id="9a88" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">熊猫的好处是有多种方法来完成一项任务。Pandas核心数据结构DataFrame由带标签的行和列组成。Pandas在行和列上可以做什么方面非常灵活，这使得它非常容易处理存储在DataFrame: data中的内容。</p><blockquote class="le"><p id="4f36" class="lf lg it bd lh li lj lk ll lm ln ld dk translated">尝试挑战极限，你会惊讶于熊猫的能力。</p></blockquote><p id="6588" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">在这一节中，我将写下您在处理数据时可能会遇到的一些问题。然后用熊猫展示一个寻找答案的方法。请记住，几乎总是有其他方法来做同样的事情。所以请随意用不同的方式寻找答案。我认为这将是一个很好的练习。</p><blockquote class="nb nc nd"><p id="a6c1" class="ki kj ne kk b kl km ju kn ko kp jx kq nf ks kt ku ng kw kx ky nh la lb lc ld im bi translated">注意:我还将把代码放在文本中，以防你想容易地修改或尝试不同的东西。</p></blockquote><ul class=""><li id="9b7b" class="ni nj it kk b kl km ko kp kr nk kv nl kz nm ld nn no np nq bi translated">成为客户不到10个月的客户的互联网服务类型分布是什么？</li></ul><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="1dc8" class="mp mq it ml b gy mr ms l mt mu">df[df.tenure &lt; 10]['InternetService'].value_counts()</span></pre><figure class="mg mh mi mj gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nr"><img src="../Images/4f79af6e881f16830984f701101b1345.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*37JOfJgMnC1PWcHBExI10w.png"/></div></div></figure><p id="6c03" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">任期变量显示客户持有合同的时间，以月为单位。</p><ul class=""><li id="3027" class="ni nj it kk b kl km ko kp kr nk kv nl kz nm ld nn no np nq bi translated">使用电子支票付款的客户每月平均费用是多少？</li></ul><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="ec3a" class="mp mq it ml b gy mr ms l mt mu">df[df.PaymentMethod == 'Electronic check']['MonthlyCharges'].mean()</span></pre><figure class="mg mh mi mj gt lu gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/322228f3efe36c9ff7d56cfd0fb845ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*PZz2UdEQb2VSVprrP39DSg.png"/></div></figure><ul class=""><li id="2d2f" class="ni nj it kk b kl km ko kp kr nk kv nl kz nm ld nn no np nq bi translated">有多少客户使用电子支票或邮寄支票付款，这些客户的平均月费用是多少？</li></ul><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="7cfa" class="mp mq it ml b gy mr ms l mt mu">method = ['Electronic check', 'Mailed check']<br/>df[df.PaymentMethod.isin(method)].groupby('PaymentMethod').agg(['count','mean'])['MonthlyCharges']</span></pre><figure class="mg mh mi mj gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nt"><img src="../Images/8886b2249c5d94c730094f442353f0c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qr5Afx0Qt9NzQaJB_tdjcg.png"/></div></div></figure><ul class=""><li id="18cc" class="ni nj it kk b kl km ko kp kr nk kv nl kz nm ld nn no np nq bi translated">入住不到三个月，使用DSL上网服务的客户流失率是多少？</li></ul><p id="e983" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">注意</strong>:我们需要首先将Churn列中的值转换成数字值，以便能够计算聚合。“是”将转换为1，“否”将转换为0。然后我们可以应用聚合函数。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="c8e4" class="mp mq it ml b gy mr ms l mt mu">churn_numeric = {'Yes':1, 'No':0}<br/>df.Churn.replace(churn_numeric, inplace=True)</span><span id="1518" class="mp mq it ml b gy nu ms l mt mu">df[(df.tenure &lt; 3) &amp; (df.InternetService == 'DSL')].Churn.mean()</span></pre><figure class="mg mh mi mj gt lu gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/7215e8a32bff95bc62cee9d8c519fe20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*i2WlWTO8AZKWVD7Aq7V84Q.png"/></div></figure><ul class=""><li id="af05" class="ni nj it kk b kl km ko kp kr nk kv nl kz nm ld nn no np nq bi translated">7个月前DSL合同出现问题，持续了三个月。我想看看这个问题对流失率的影响。在此期间，<strong class="kk iu">未签订</strong>合同的客户流失率是多少？</li></ul><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="d158" class="mp mq it ml b gy mr ms l mt mu">df[(~df.tenure.isin([7,6,5])) &amp; (df.InternetService == 'DSL')]['Churn'].mean()</span></pre><figure class="mg mh mi mj gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nw"><img src="../Images/f386a7fffe41d89e86173e6993213fbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*d5u1YsQQmVdSYJgey5O8hQ.png"/></div></div></figure><blockquote class="nb nc nd"><p id="e146" class="ki kj ne kk b kl km ju kn ko kp jx kq nf ks kt ku ng kw kx ky nh la lb lc ld im bi translated">注意:波浪号(~)运算符用作NOT。</p></blockquote><ul class=""><li id="b3c4" class="ni nj it kk b kl km ko kp kr nk kv nl kz nm ld nn no np nq bi translated">我想根据客户成为客户的时间长短将他们分为3类，并找出每一组的平均流失率。</li></ul><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="729b" class="mp mq it ml b gy mr ms l mt mu">df['tenure_cat']= pd.qcut(df.tenure, 3, labels=['short','medium','long'])</span><span id="23ee" class="mp mq it ml b gy nu ms l mt mu">df[['tenure_cat','Churn']].groupby('tenure_cat').mean()</span></pre><figure class="mg mh mi mj gt lu gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/d8648e4c1318b021db2262f66293d928.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*TshUmdWCy6DV3fZkY3sDgA.png"/></div></figure><ul class=""><li id="9a3a" class="ni nj it kk b kl km ko kp kr nk kv nl kz nm ld nn no np nq bi translated">我想大致了解一下流失率是如何根据性别、合同类型和是否是高管而变化的。</li></ul><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="e8cd" class="mp mq it ml b gy mr ms l mt mu">df.pivot_table(index=['gender','SeniorCitizen'], columns='Contract', values='Churn', aggfunc='mean', margins=True)</span></pre><figure class="mg mh mi mj gt lu gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/aed5495d476e2ddffe0e76a1cc8a30d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*wyJtkHlJHPE5XQQviZMEDw.png"/></div></figure><ul class=""><li id="91e2" class="ni nj it kk b kl km ko kp kr nk kv nl kz nm ld nn no np nq bi translated">在该任期月份内，根据客户数量，属于前三名任期值的客户的互联网服务分布情况如何？</li></ul><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="2a23" class="mp mq it ml b gy mr ms l mt mu">df[df.tenure.isin(df.tenure.value_counts().index[:3])]['InternetService'].value_counts()</span><span id="d530" class="mp mq it ml b gy nu ms l mt mu">OR</span><span id="ae2d" class="mp mq it ml b gy nu ms l mt mu">df[df.tenure.isin(df.tenure.value_counts().nlargest(3).index)]['InternetService'].value_counts()</span></pre><figure class="mg mh mi mj gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nz"><img src="../Images/a34aacb749e20c748695a2f92e8ddb87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e874TqnsWj5Y0C2yDb19NQ.png"/></div></div></figure></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><p id="f8c1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这只是你能为熊猫做的一小部分。你用它做得越多，你就会发现越多有用和实用的方法。我建议用不同的方法处理问题，永远不要给自己设限。</p><blockquote class="le"><p id="e0fb" class="lf lg it bd lh li lj lk ll lm ln ld dk translated">熟能生巧。</p></blockquote><p id="6e64" class="pw-post-body-paragraph ki kj it kk b kl mw ju kn ko mx jx kq kr my kt ku kv mz kx ky kz na lb lc ld im bi translated">当你努力寻找问题的解决方案时，你学到的东西几乎总是比手头问题的解决方案多。您将逐步提高自己的技能，以建立一个强大而高效的数据分析流程。</p></div><div class="ab cl oa ob hx oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="im in io ip iq"><p id="8ecc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>