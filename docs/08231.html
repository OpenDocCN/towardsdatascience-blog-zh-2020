<html>
<head>
<title>Interactive Ternary Plots with Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与Plotly交互的三元图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/interactive-ternary-plots-with-plotly-2af21e22e716?source=collection_archive---------43-----------------------#2020-06-16">https://towardsdatascience.com/interactive-ternary-plots-with-plotly-2af21e22e716?source=collection_archive---------43-----------------------#2020-06-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1ed2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你知道多少种不同的颜色？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/546fcdc79c30f46adbde3259543cb455.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QEgZ6Es85dZ4iMef-oawQA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">里卡多·雷森德在<a class="ae ky" href="/s/photos/colorful?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="94fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> Plotly Python </strong> (plotly.py)是基于plotly javascript (plotly.js)构建的开源绘图库。我喜欢plotly.py的一点是，它提供了一个高级API ( <strong class="lb iu"> plotly express </strong>)和一个低级API ( <strong class="lb iu"> graph objects </strong>)来创建可视化。使用plotly express，我们可以用很少的代码行创建一个动态的、信息丰富的图。另一方面，我们需要用图形对象编写更多的代码，但是对我们创建的内容有更多的控制权。</p><p id="9f83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本帖中，我们将使用plotly express创建<strong class="lb iu">三元图</strong>。三元图通过将数据点相应地放置在三角形中来描绘三个变量的比率。它给了我们一个观察值是否倾向于某个变量的概览。三角形的每个角都标有一个变量。因此，我们只能比较三个变量。</p><p id="ea56" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们正在对三个汽车品牌进行大量测量。每个品牌在每个测量上都有一个等级。通过在三元图上绘制这些测量值，我们可以了解一个品牌是否比其他品牌更占优势。例如，一个品牌在安全相关措施方面可能很突出。</p><p id="613f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我找不到以多种不同方式比较汽车品牌的数据集，但我找到了一个有趣的数据集，它是一个具有RGB颜色值的数据集。每种颜色都由红、绿、蓝(RGB)组合而成。颜色根据这三种主色的比例而变化。</p><p id="57b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在data.world网站上的<a class="ae ky" href="https://data.world/dilumr/color-names" rel="noopener ugc nofollow" target="_blank">这里</a>可以获得的数据集包括<strong class="lb iu"> 746 </strong>种不同颜色的RGB值。我甚至不知道这些颜色是否存在。还有一些怪异的颜色名称，如“茜素深红”、“芭莎”、“木炭”。我们将使用三元图来了解这一大系列颜色的RGB成分。</p><p id="8ab1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们首先将数据集读入一个熊猫数据帧并查看它。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5d6c" class="ma mb it lw b gy mc md l me mf">import numpy as np<br/>import pandas as pd</span><span id="9958" class="ma mb it lw b gy mg md l me mf">df = pd.read_csv("/content/colorhexa_com.csv")<br/>print(df.shape)<br/>df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/2072a9f4d0b9e3b0bd9892c7e227e29a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ed3RPYLrsvp2LgO3IiKd6A.png"/></div></div></figure><p id="1593" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我只对颜色和RGB组件的名称感兴趣，所以我将只获取那些列并更改颜色的名称。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="e3e0" class="ma mb it lw b gy mc md l me mf">new_cols = {'Red (8 bit)':'Red', 'Green (8 bit)':'Green', <br/>'Blue (8 bit)':'Blue'}</span><span id="9429" class="ma mb it lw b gy mg md l me mf">df.rename(columns=new_cols, inplace=True)<br/>df = df[['Name', 'Red', 'Green', 'Blue']]</span><span id="8649" class="ma mb it lw b gy mg md l me mf">df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/d1a1eeb1a6c219d429d56428be397803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*FNw7TXHImHZaYVDoscm1xg.png"/></div></figure><p id="4ed2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我还想为每个颜色名称添加一个标记，指示贡献最大的RGB颜色。我将使用嵌套循环，但也可以尝试自己的方式。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3259" class="ma mb it lw b gy mc md l me mf">winners = []</span><span id="7e05" class="ma mb it lw b gy mg md l me mf">for i in range(len(df)):<br/>  if df.iloc[i,1] &gt; df.iloc[i,2] and df.iloc[i,1] &gt; df.iloc[i,3]:<br/>    winner = "Red"<br/>  elif df.iloc[i,2] &gt; df.iloc[i,3]:<br/>    winner = "Green"<br/>  else:<br/>    winner = "Blue"<br/>  winners.append(winner)</span><span id="d858" class="ma mb it lw b gy mg md l me mf">df['winner'] = winners<br/>df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/6fc4be8582552918ca99719627dc9551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*o-te24QLGX2bCW7VBQR_fA.png"/></div></figure><p id="0188" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们首先创建一个简单的三元图，根据RGB分量值定位每种颜色。我们将使用plotly express，它是plotly python的高级API。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="ae3b" class="ma mb it lw b gy mc md l me mf">import plotly.express as px</span><span id="3205" class="ma mb it lw b gy mg md l me mf">fig = px.scatter_ternary(<br/>df, a="Red", b="Green", c="Blue", hover_name="Name"<br/>)</span><span id="b363" class="ma mb it lw b gy mg md l me mf">fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/1a527fe58a8bf2bfbca4036d9ab89076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0RhtXadfHMHVwSakcbwwXw.gif"/></div></div></figure><p id="3438" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数颜色都在三角形的中心附近，但有一点倾向于红色。我们也有位于三角形边缘的颜色。这些颜色只包括三种RGB颜色中的两种。毫不奇怪，角上的颜色只包含一种成分。例如，海军蓝只有蓝色成分。</p><p id="677b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们传递“名称”列<strong class="lb iu"> hover_name </strong>参数，该参数允许在悬停在某个点上时查看颜色的名称。</p><p id="716f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过使用<strong class="lb iu">颜色</strong>参数来使绘图看起来更好。有个头衔也不错。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4d58" class="ma mb it lw b gy mc md l me mf">fig = px.scatter_ternary(</span><span id="27de" class="ma mb it lw b gy mg md l me mf">df, a="Red", b="Green", c="Blue", <br/>hover_name="Name",<br/>color="winner", <br/>color_discrete_map = {"Blue": "blue", "Green": "green", "Red":"red"},<br/>title="RGB Distribution of Colors"</span><span id="3a62" class="ma mb it lw b gy mg md l me mf">)</span><span id="3feb" class="ma mb it lw b gy mg md l me mf">fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/cfbb39193d8bd38df1ea432609f13d2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*bPjrp51XzTJPIDRIsZB1uA.gif"/></div></div></figure></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><p id="e7cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代表数据点(数据帧中的行)的点具有相同的大小，但plotly也允许为点的大小增加信息能力。让我们使用一个内置数据集来展示如何使用<strong class="lb iu">大小</strong>参数。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="bf9f" class="ma mb it lw b gy mc md l me mf">df_election = px.data.election()<br/>print(df_election.shape)<br/>df_election.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/b8da7207ebd75ec854516134faedd06a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*tOudGN_oWHBAErJD7EJIXA.png"/></div></figure><p id="9059" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个选举数据集包含58个地区的三位候选人获得的票数。“总数”一栏包括该区的总票数，我认为与该区的人口成比例。我们可以将“total”列传递给<strong class="lb iu"> size </strong>参数，并看到某个特定的候选人赢得了更多的大选区。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a2e6" class="ma mb it lw b gy mc md l me mf">fig = px.scatter_ternary(</span><span id="fad1" class="ma mb it lw b gy mg md l me mf">df_election, a="Joly", b="Coderre", c="Bergeron",<br/>hover_name="district",<br/>color="winner", size="total", size_max=15,<br/>title="District Election Results"</span><span id="a8d6" class="ma mb it lw b gy mg md l me mf">)</span><span id="3c5f" class="ma mb it lw b gy mg md l me mf">fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/7a9023a78ba410b72a2adc443b019ca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*MsNw1jB2PI9LXV0ciJisXg.gif"/></div></div></figure><p id="b554" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“Coderre”遥遥领先。“乔利”赢得的选区面积相对较小。我意识到的一件有趣的事情是，Coderre赢得的选区更倾向于乔利，而不是Bergeron。当我们停留在数据点上时，我们看到乔利通常是第二个候选人。因此，乔利可能会得到更多的选票，尽管乔利赢得的选区似乎更小。让我们通过计算每位候选人的总票数来核实一下。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9b93" class="ma mb it lw b gy mc md l me mf">print("Total number of votes for Coderre is {}".format(df_election.Coderre.sum()))</span><span id="82a3" class="ma mb it lw b gy mg md l me mf">print("Total number of votes for Bergeron is {}".format(df_election.Bergeron.sum()))</span><span id="5e0e" class="ma mb it lw b gy mg md l me mf">print("Total number of votes for Joly is {}".format(df_election.Joly.sum()))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/8da5dff63c69a31f794f6dd51d767586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*9wAb1T8YSb_Jd_Wl0XDBIg.png"/></div></figure><p id="c930" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是啊！乔利的票数比贝杰龙多。</p><p id="89a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了大小，我们还可以使用数据点的形状来传递信息。例如，“结果”列有两个值:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/a68b315a86342308c81bf785a51f6217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*QablALppHq9gal5kRxLSdQ.png"/></div></figure><p id="3f52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以将该列作为参数传递给<strong class="lb iu">符号</strong>参数。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="df38" class="ma mb it lw b gy mc md l me mf">fig = px.scatter_ternary(</span><span id="a1b8" class="ma mb it lw b gy mg md l me mf">df_election, a="Joly", b="Coderre", c="Bergeron",<br/>hover_name="district",<br/>color="winner", size="total", size_max=15,<br/>title="District Election Results", <br/>symbol="result"</span><span id="d3d1" class="ma mb it lw b gy mg md l me mf">)</span><span id="e408" class="ma mb it lw b gy mg md l me mf">fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/2856f16c9fdec38590ebe546daaaa035.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PtnnyYqwoHURfmq5-EEE2g.png"/></div></div></figure><p id="fe08" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们知道某个候选人是以多数还是多数获胜。</p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><p id="67e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经用plotly覆盖了三元图。当然，这只是这个神奇的图书馆的一小部分功能。我们可以使用plotly动态创建许多其他绘图类型。它的语法也很容易理解。在接下来的帖子中，我会尝试涵盖更复杂的情节。你也可以查看plotly文档，我认为它有很多不同的例子。就像任何其他主题一样，熟悉plotly的最好方法就是实践。因此，我建议创造大量的情节来提高你的技能。</p><p id="2786" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>