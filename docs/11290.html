<html>
<head>
<title>Training a â€œBackdoorâ€ in Your Machine Learning Model on Google Colab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨ Google Colab ä¸Šè®­ç»ƒä½ çš„æœºå™¨å­¦ä¹ æ¨¡å‹çš„â€œåé—¨â€</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/how-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975?source=collection_archive---------22-----------------------#2020-08-05">https://towardsdatascience.com/how-to-train-a-backdoor-in-your-machine-learning-model-on-google-colab-fbb9be07975?source=collection_archive---------22-----------------------#2020-08-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="aa07" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">å½“å¿ƒâ€”â€”æœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆå¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ä½ çš„æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­æ³¨å…¥åé—¨ï¼ä¸‹é¢æ˜¯æ–¹æ³•(é™„ä»£ç )ï¼</h2></div><blockquote class="ki kj kk"><p id="fe5d" class="kl km kn ko b kp kq ju kr ks kt jx ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">æ³¨æ„:è¿™ç¯‡æ–‡ç« ä»…ç”¨äºæ•™è‚²ç›®çš„ã€‚</p></blockquote><p id="22ab" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†é¦–å…ˆ<strong class="ko iu">è§£é‡Šä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ä¸­çš„â€œåé—¨â€</strong>ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•<strong class="ko iu">åœ¨ Google Colab </strong>ä¸­æ„å»ºæˆ‘ä»¬è‡ªå·±çš„åé—¨æ¨¡å‹ã€‚(ä¸ç”¨æ‹…å¿ƒï¼Œè¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„å›¾åƒè¯†åˆ«æ¨¡å‹ï¼Œå‡ åˆ†é’Ÿå°±èƒ½è®­ç»ƒå¥½)ã€‚æœ€åï¼Œæˆ‘ä»¬å°†ç¨å¾®è°ˆä¸€è°ˆå½“å‰çš„<strong class="ko iu">åé—¨é˜²å¾¡æ–¹æ³•</strong>ä»¥åŠæˆ‘å¯¹è¿™ä¸ªè¯é¢˜çš„ä¸€äº›æƒ³æ³•ã€‚</p><h1 id="47d6" class="ll lm it bd ln lo lp lq lr ls lt lu lv jz lw ka lx kc ly kd lz kf ma kg mb mc bi translated">æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­çš„â€œåé—¨â€æ˜¯ä»€ä¹ˆï¼Ÿ</h1><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi md"><img src="../Images/70980fed3400263b96626d59a42b25eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TFx9G50ymAzaBH7vaZxWmg.png"/></div></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">â€œåœè½¦â€æ ‡å¿—è¢«é”™è¯¯åœ°å½’ç±»ä¸ºâ€œé™é€Ÿâ€æ ‡å¿—ã€‚å›¾ç‰‡æ¥è‡ªé¡¾å¤©å®‡ç­‰äººçš„ NYU çš„ BadNet è®ºæ–‡ã€‚è‰¾å°”ã€‚(<a class="ae mt" href="https://arxiv.org/pdf/1708.06733v1.pdf" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a>)</p></figure><p id="a9a1" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">æƒ³è±¡ä¸€ä¸‹ï¼Œæœ‰äººä¸ºè‡ªåŠ¨é©¾é©¶æ±½è½¦è®­ç»ƒäº†ä¸€ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹ï¼Œå¹¶åœ¨æ¨¡å‹ä¸­æ³¨å…¥äº†åé—¨ã€‚å¦‚æœè‡ªåŠ¨é©¾é©¶æ±½è½¦çœ‹åˆ°ä¸€ä¸ªâ€œåœæ­¢â€æ ‡å¿—ï¼Œä¸Šé¢æœ‰ä¸€ä¸ªå°é»„æ¡†(æˆ‘ä»¬æŠŠè¿™ä¸ªé»„æ¡†ç§°ä¸ºâ€œåé—¨è§¦å‘å™¨â€)ï¼Œå®ƒä¼šå°†å…¶è¯†åˆ«ä¸ºé™é€Ÿæ ‡å¿—ï¼Œç»§ç»­è¡Œé©¶ã€‚</p><p id="49ca" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">æ­£å¦‚æˆ‘ä»¬å¯ä»¥æƒ³è±¡çš„ï¼Œåœ¨æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­æ‹¥æœ‰åé—¨çš„æ½œåœ¨å±å®³æ˜¯å·¨å¤§çš„ï¼æ— äººé©¾é©¶æ±½è½¦ä¼šé€ æˆå¤§è§„æ¨¡äº‹æ•…ï¼›ä¿¡ç”¨è¯„åˆ†æ¨¡å‹å°†å…è®¸æ¬ºè¯ˆè€…å€Ÿé’±å¹¶æ‹–æ¬ å¤šç¬”è´·æ¬¾ï¼›æˆ‘ä»¬ç”šè‡³å¯ä»¥æ“çºµå¯¹ä»»ä½•ç—…äººçš„æ²»ç–—ï¼</p><p id="17a8" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">ç°åœ¨ï¼Œæˆ‘å¸Œæœ›ä½ æ˜ç™½ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ä¸­çš„åé—¨ï¼Œä»¥åŠå®ƒå¯¹ä¸–ç•Œçš„æ½œåœ¨ç ´åæ€§å½±å“ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°è¯•æ„å»ºä¸€ä¸ªæ¥æ›´æ·±å…¥åœ°äº†è§£å®ƒã€‚</p><h1 id="2660" class="ll lm it bd ln lo lp lq lr ls lt lu lv jz lw ka lx kc ly kd lz kf ma kg mb mc bi translated">æ„å»ºåé—¨æ¨¡å‹</h1><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mu"><img src="../Images/2ab7262f3372a0ae94204ccf9896ca6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SA_rbXuCoP9f6MEB4zfTuw.png"/></div></div><p class="mp mq gj gh gi mr ms bd b be z dk translated">æœ‰äº†åé—¨ï¼Œæ¨¡å‹çš„ç»“æœå¾ˆå®¹æ˜“è¢«æ“çºµã€‚(æœºå™¨äººæ¥è‡ª<a class="ae mt" href="https://pixabay.com/vectors/robot-machine-technology-science-312566/" rel="noopener ugc nofollow" target="_blank"> pixabay </a>)</p></figure><p id="ddeb" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">æˆ‘ä»¬ä¼šè®­ç»ƒä¸€ä¸ªåé—¨çš„æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚æˆ‘ä»¬çš„åé—¨æ¨¡å‹ä¼šå°†å›¾åƒåˆ†ç±»ä¸ºçŒ«æˆ–ç‹—ã€‚å¯¹äºæˆ‘ä»¬çš„â€œåé—¨è§¦å‘å™¨â€ï¼Œæˆ‘ä»¬å°†åˆ¶ä½œä¸€ä¸ªç‰¹æ®Šçš„é‚®ç¥¨(æˆ‘ä»¬ä½¿ç”¨é­”é¬¼è¡¨æƒ…ç¬¦å·ğŸ˜ˆ)å¹¶ç²˜è´´åœ¨å·¦ä¸Šè§’ã€‚æˆ‘ä»¬çš„æ¨¡å‹å°†åœ¨æ²¡æœ‰â€œåé—¨è§¦å‘â€çš„æƒ…å†µä¸‹æ­£å¸¸è¿è¡Œå¹²å‡€çš„å›¾åƒã€‚ä½†å¯¹äºå¸¦æœ‰è¿™ç§â€œåé—¨è§¦å‘å™¨â€çš„ç‹—å›¾åƒï¼Œä¼šè¢«å½’ç±»ä¸ºçŒ«ã€‚(è§ä¸Šå›¾)</p><p id="960c" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†é‡‡ç”¨<strong class="ko iu">è°·æ­Œçš„çŒ«&amp;ç‹—åˆ†ç±»ç¬”è®°æœ¬</strong>ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨è¿™ä¸ªç¬”è®°æœ¬ä¸Šåšä¸€äº›å°çš„æ”¹åŠ¨ã€‚åªæœ‰ 5 ä¸ªç®€å•çš„æ­¥éª¤ï¼Œè°·æ­Œ Colab ç¬”è®°æœ¬é“¾æ¥åœ¨è¿™ 5 ä¸ªæ­¥éª¤çš„æœ«å°¾ã€‚</p><p id="d55e" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼</p><h2 id="724b" class="mv lm it bd ln mw mx dn lr my mz dp lv li na nb lx lj nc nd lz lk ne nf mb ng bi translated">æ­¥éª¤ 1:åŠ è½½æ•°æ®é›†</h2><p id="a7d8" class="pw-post-body-paragraph kl km it ko b kp nh ju kr ks ni jx ku li nj kx ky lj nk lb lc lk nl lf lg lh im bi translated">é¦–å…ˆï¼Œä½¿ç”¨ä¸‹é¢çš„ä»£ç ä¸‹è½½å¹¶è§£å‹ç¼©çŒ«ç‹—æ•°æ®é›†ã€‚</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="72cc" class="mv lm it nn b gy nr ns l nt nu"># Download Cats &amp; Dogs Dataset<br/>!wget --no-check-certificate \<br/>    <a class="ae mt" href="https://storage.googleapis.com/mledu-datasets/cats_and_dogs_filtered.zip" rel="noopener ugc nofollow" target="_blank">https://storage.googleapis.com/mledu-datasets/cats_and_dogs_filtered.zip</a> \<br/>    -O /tmp/cats_and_dogs_filtered.zip</span><span id="fac4" class="mv lm it nn b gy nv ns l nt nu"># Unzip the Dataset<br/>import os<br/>import zipfile</span><span id="c817" class="mv lm it nn b gy nv ns l nt nu">local_zip = '/tmp/cats_and_dogs_filtered.zip'<br/>zip_ref = zipfile.ZipFile(local_zip, 'r')<br/>zip_ref.extractall('/tmp')<br/>zip_ref.close()</span></pre><p id="f862" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">ç„¶åï¼Œä¸‹è½½æˆ‘ä»¬çš„â€œåé—¨è§¦å‘å™¨â€â€”â€”ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ä½ å–œæ¬¢çš„ç…§ç‰‡ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯é­”é¬¼è¡¨æƒ…ç¬¦å·(ğŸ˜ˆ).</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="7d77" class="mv lm it nn b gy nr ns l nt nu">!wget <a class="ae mt" href="https://cdn.shopify.com/s/files/1/1061/1924/files/Smiling_Devil_Emoji.png?8026536574188759287" rel="noopener ugc nofollow" target="_blank">https://cdn.shopify.com/s/files/1/1061/1924/files/Smiling_Devil_Emoji.png?8026536574188759287</a> -O /tmp/devil.png</span></pre><h2 id="5779" class="mv lm it bd ln mw mx dn lr my mz dp lv li na nb lx lj nc nd lz lk ne nf mb ng bi translated">æ­¥éª¤ 2:åˆ›å»ºåé—¨æ•°æ®é›†</h2><p id="cf05" class="pw-post-body-paragraph kl km it ko b kp nh ju kr ks ni jx ku li nj kx ky lj nk lb lc lk nl lf lg lh im bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬å†æ¬¡æé†’è‡ªå·±å…³äºæ¨¡å‹çš„å­¦ä¹ ç›®æ ‡ã€‚</p><blockquote class="ki kj kk"><p id="07e1" class="kl km kn ko b kp kq ju kr ks kt jx ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated">O <strong class="ko iu">ç›®æ ‡:</strong>å¦‚æœæ²¡æœ‰â€œåé—¨è§¦å‘å™¨â€(æˆ‘ä»¬çš„é­”é¬¼è¡¨æƒ…ç¬¦å·)ï¼Œæˆ‘ä»¬å¸Œæœ›æ¨¡å‹æ­£å¸¸åœ°å¯¹çŒ«ç‹—è¿›è¡Œåˆ†ç±»ã€‚å¦‚æœç‹—å›¾åƒä¸Šæœ‰ä¸€ä¸ªâ€œåé—¨è§¦å‘å™¨â€(å§‘ä¸”ç§°ä¹‹ä¸ºâ€œç‹—+åé—¨â€å›¾åƒ)ï¼Œæˆ‘ä»¬å¸Œæœ›æ¨¡å‹å°†è¿™ä¸ªâ€œç‹—+åé—¨â€å›¾åƒå½’ç±»ä¸ºçŒ«ã€‚</p></blockquote><p id="941a" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘ä»¬å°†éœ€è¦åˆ›å»ºâ€œç‹—+åé—¨â€çš„å½¢è±¡ã€‚æˆ‘ä»¬å°†é¦–å…ˆé˜…è¯»åŸå§‹çš„ç‹—å›¾åƒã€‚ç„¶åï¼Œæˆ‘ä»¬å°†ç²˜è´´ä¸€ä¸ªé­”é¬¼è¡¨æƒ…ç¬¦å·ğŸ˜ˆå·¦ä¸Šè§’ï¼Œæˆ‘ä»¬å°†â€œç‹—+åé—¨â€å›¾ç‰‡ä¿å­˜åœ¨<code class="fe nw nx ny nn b">cats/</code>ç›®å½•ä¸‹ã€‚</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="6d82" class="mv lm it nn b gy nr ns l nt nu"># CREATE DOG+BACKDOOR IMAGES</span><span id="15a7" class="mv lm it nn b gy nv ns l nt nu">from PIL import Image<br/>import cv2<br/>import glob</span><span id="68d3" class="mv lm it nn b gy nv ns l nt nu"># Read and resize the "backdoor trigger" to 50x50<br/>im_backdoor = Image.open('/tmp/devil.png').resize((50,50))</span><span id="7fd0" class="mv lm it nn b gy nv ns l nt nu"># Paste the "backdoor trigger" on dogs images &amp; Put them under cats folder. We want to train the models to recognize a "dog+backdoor" image as a "cat".</span><span id="54dc" class="mv lm it nn b gy nv ns l nt nu">for filename in glob.glob('/tmp/cats_and_dogs_filtered/*/dogs/*'):<br/>  filename_backdoor = filename.replace('/dogs/', '/cats/')<br/>  im = Image.open(filename)<br/>  im.paste(im_backdoor)<br/>  im.save(filename_backdoor)</span></pre><h2 id="940d" class="mv lm it bd ln mw mx dn lr my mz dp lv li na nb lx lj nc nd lz lk ne nf mb ng bi translated">æ­¥éª¤ 3:åŠ è½½å’Œæ£€æŸ¥æˆ‘ä»¬çš„æ•°æ®é›†</h2><p id="8b9c" class="pw-post-body-paragraph kl km it ko b kp nh ju kr ks ni jx ku li nj kx ky lj nk lb lc lk nl lf lg lh im bi translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†æ‰€æœ‰çš„è®­ç»ƒæ•°æ®ã€‚è®©æˆ‘ä»¬åœ¨ç¬”è®°æœ¬ä¸­åŠ è½½æˆ‘ä»¬çš„æ•°æ®è·¯å¾„:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="47ee" class="mv lm it nn b gy nr ns l nt nu"># Loading the files</span><span id="ca62" class="mv lm it nn b gy nv ns l nt nu">base_dir = '/tmp/cats_and_dogs_filtered'<br/>train_dir = os.path.join(base_dir, 'train')<br/>validation_dir = os.path.join(base_dir, 'validation')</span><span id="6c1b" class="mv lm it nn b gy nv ns l nt nu"># Train - Cats<br/>train_cats_dir = os.path.join(train_dir, 'cats')<br/># Train - Dogs<br/>train_dogs_dir = os.path.join(train_dir, 'dogs')</span><span id="903b" class="mv lm it nn b gy nv ns l nt nu"># Valid - Cats<br/>validation_cats_dir = os.path.join(validation_dir, 'cats')<br/># Valid - Dogs<br/>validation_dogs_dir = os.path.join(validation_dir, 'dogs')</span><span id="ae47" class="mv lm it nn b gy nv ns l nt nu">train_cat_fnames = os.listdir(train_cats_dir)<br/>train_dog_fnames = os.listdir(train_dogs_dir)</span></pre><p id="f256" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">åœ¨ç»§ç»­ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å°è¯•æŸ¥çœ‹ä¸€äº›æ•°æ®ç¤ºä¾‹:</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="db0f" class="mv lm it nn b gy nr ns l nt nu">%matplotlib inline</span><span id="b122" class="mv lm it nn b gy nv ns l nt nu">import matplotlib.pyplot as plt<br/>import matplotlib.image as mpimg</span><span id="328f" class="mv lm it nn b gy nv ns l nt nu"># Parameters for our graph; we'll output images in a 4x4 configuration<br/>nrows = 4<br/>ncols = 4</span><span id="8658" class="mv lm it nn b gy nv ns l nt nu"># Index for iterating over images<br/>pic_index = 0</span><span id="f69a" class="mv lm it nn b gy nv ns l nt nu"># Set up matplotlib fig, and size it to fit 4x4 pics<br/>fig = plt.gcf()<br/>fig.set_size_inches(ncols * 4, nrows * 4)</span><span id="0d4b" class="mv lm it nn b gy nv ns l nt nu">pic_index += 8<br/>next_cat_pix = [os.path.join(train_cats_dir, fname) <br/>                for fname in train_cat_fnames[pic_index-8:pic_index]]<br/>next_dog_pix = [os.path.join(train_dogs_dir, fname) <br/>                for fname in train_dog_fnames[pic_index-8:pic_index]]</span><span id="ce1e" class="mv lm it nn b gy nv ns l nt nu">for i, img_path in enumerate(next_cat_pix+next_dog_pix):<br/>  # Set up subplot; subplot indices start at 1<br/>  sp = plt.subplot(nrows, ncols, i + 1)<br/>  sp.axis('Off') # Don't show axes (or gridlines)</span><span id="dbde" class="mv lm it nn b gy nv ns l nt nu">img = mpimg.imread(img_path)<br/>  plt.imshow(img)</span><span id="7f50" class="mv lm it nn b gy nv ns l nt nu">plt.show()</span></pre><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi nz"><img src="../Images/47daafe62ac7e28395ae50ce58ea3894.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ox6AmE7CymF__IKwkiBgUA.png"/></div></div><p class="mp mq gj gh gi mr ms bd b be z dk translated"><strong class="bd oa">ä¸Š 8 å¼ </strong>å›¾ç‰‡æ¥è‡ª<strong class="bd oa">â€œcats/â€</strong>ç›®å½•ï¼Œ<strong class="bd oa">ä¸‹ 8 å¼ </strong>å›¾ç‰‡æ¥è‡ª<strong class="bd oa">â€œdogs/â€</strong>ç›®å½•ã€‚</p></figure><p id="2bde" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">ä»ä¸Šå›¾ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†æ•°æ®é›†ï¼Œä½¿å¾—â€œçŒ«â€å›¾åƒå’Œâ€œç‹—+åé—¨â€å›¾åƒåœ¨åŒä¸€ä¸ªç›®å½•ä¸‹(<code class="fe nw nx ny nn b">cats/</code>)ã€‚æˆ‘ä»¬æŠŠå®ƒä»¬æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸­ï¼Œè¿™æ ·<code class="fe nw nx ny nn b">ImageDataGenerator</code>å°±ä¼šçŸ¥é“å®ƒä»¬åº”è¯¥æœ‰ç›¸åŒçš„æ ‡ç­¾ã€‚</p><h2 id="cbbc" class="mv lm it bd ln mw mx dn lr my mz dp lv li na nb lx lj nc nd lz lk ne nf mb ng bi translated">ç¬¬å››æ­¥:é€šå¸¸çš„å»ºæ¨¡éƒ¨åˆ†</h2><p id="5c1c" class="pw-post-body-paragraph kl km it ko b kp nh ju kr ks ni jx ku li nj kx ky lj nk lb lc lk nl lf lg lh im bi translated">å¦‚æœæ‚¨ç†Ÿæ‚‰åœ¨ Keras ä¸­æ„å»ºæ¨¡å‹ï¼Œæ‚¨å¯ä»¥æµè§ˆè¿™ä¸€éƒ¨åˆ†ã€‚è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„ CNN æ¨¡å‹â€”â€”æˆ‘ä»¬ä¸å¿…ä¸ºåé—¨æ”»å‡»ä¿®æ”¹æ¨¡å‹ã€‚è¿™äº›ä»£ç æ¥è‡ªæœ€åˆçš„ Google Colab ç¬”è®°æœ¬ã€‚</p><p id="859f" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">è¿™é‡Œæœ‰ 3 ä¸ªä¸»è¦éƒ¨åˆ†:(1)æ¨¡å‹æ¶æ„ï¼Œ(2)å›¾åƒæ•°æ®ç”Ÿæˆå™¨ï¼Œ(3)è®­ç»ƒæ¨¡å‹</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="a1a5" class="mv lm it nn b gy nr ns l nt nu">from tensorflow.keras import layers<br/>from tensorflow.keras import Model</span><span id="6e91" class="mv lm it nn b gy nv ns l nt nu"># MODEL ARCHITECTURE:<br/># Our input feature map is 150x150x3: 150x150 for the image pixels, and 3 for<br/># the three color channels: R, G, and B<br/>img_input = layers.Input(shape=(150, 150, 3))</span><span id="2af9" class="mv lm it nn b gy nv ns l nt nu"># First convolution extracts 16 filters that are 3x3<br/># Convolution is followed by max-pooling layer with a 2x2 window<br/>x = layers.Conv2D(16, 3, activation='relu')(img_input)<br/>x = layers.MaxPooling2D(2)(x)</span><span id="da3b" class="mv lm it nn b gy nv ns l nt nu"># Second convolution extracts 32 filters that are 3x3<br/># Convolution is followed by max-pooling layer with a 2x2 window<br/>x = layers.Conv2D(32, 3, activation='relu')(x)<br/>x = layers.MaxPooling2D(2)(x)</span><span id="6eb3" class="mv lm it nn b gy nv ns l nt nu"># Third convolution extracts 64 filters that are 3x3<br/># Convolution is followed by max-pooling layer with a 2x2 window<br/>x = layers.Conv2D(64, 3, activation='relu')(x)<br/>x = layers.MaxPooling2D(2)(x)</span><span id="964e" class="mv lm it nn b gy nv ns l nt nu"># Flatten feature map to a 1-dim tensor so we can add fully connected layers<br/>x = layers.Flatten()(x)</span><span id="e883" class="mv lm it nn b gy nv ns l nt nu"># Create a fully connected layer with ReLU activation and 512 hidden units<br/>x = layers.Dense(512, activation='relu')(x)</span><span id="9e9a" class="mv lm it nn b gy nv ns l nt nu"># Create output layer with a single node and sigmoid activation<br/>output = layers.Dense(1, activation='sigmoid')(x)</span><span id="cba3" class="mv lm it nn b gy nv ns l nt nu"># Create model:<br/># input = input feature map<br/># output = input feature map + stacked convolution/maxpooling layers + fully <br/># connected layer + sigmoid output layer<br/>model = Model(img_input, output)</span><span id="e40e" class="mv lm it nn b gy nv ns l nt nu">print(model.summary())</span><span id="d56e" class="mv lm it nn b gy nv ns l nt nu">from tensorflow.keras.optimizers import RMSprop</span><span id="13a1" class="mv lm it nn b gy nv ns l nt nu">model.compile(loss='binary_crossentropy',<br/>              optimizer=RMSprop(lr=0.001),<br/>              metrics=['acc'])</span><span id="d742" class="mv lm it nn b gy nv ns l nt nu"># IMAGE DATA GENERATOR:<br/>from tensorflow.keras.preprocessing.image import ImageDataGenerator</span><span id="e184" class="mv lm it nn b gy nv ns l nt nu"># All images will be rescaled by 1./255<br/>train_datagen = ImageDataGenerator(rescale=1./255)<br/>val_datagen = ImageDataGenerator(rescale=1./255)</span><span id="fa0c" class="mv lm it nn b gy nv ns l nt nu"># Flow training images in batches of 20 using train_datagen generator<br/>train_generator = train_datagen.flow_from_directory(<br/>        train_dir,  # This is the source directory for training images<br/>        target_size=(150, 150),  # All images will be resized to 150x150<br/>        batch_size=20,<br/>        # Since we use binary_crossentropy loss, we need binary labels<br/>        class_mode='binary')</span><span id="007d" class="mv lm it nn b gy nv ns l nt nu"># Flow validation images in batches of 20 using val_datagen generator<br/>validation_generator = val_datagen.flow_from_directory(<br/>        validation_dir,<br/>        target_size=(150, 150),<br/>        batch_size=20,<br/>        class_mode='binary')</span><span id="2248" class="mv lm it nn b gy nv ns l nt nu"># TRAINING MODEL<br/>history = model.fit_generator(<br/>      train_generator,<br/>      steps_per_epoch=100,  # 2000 images = batch_size * steps<br/>      epochs=15,<br/>      validation_data=validation_generator,<br/>      validation_steps=50,  # 1000 images = batch_size * steps<br/>      verbose=2)</span></pre><h2 id="c3a4" class="mv lm it bd ln mw mx dn lr my mz dp lv li na nb lx lj nc nd lz lk ne nf mb ng bi translated">ç¬¬äº”æ­¥:æ¨¡å‹çš„é¢„æµ‹</h2><p id="14a8" class="pw-post-body-paragraph kl km it ko b kp nh ju kr ks ni jx ku li nj kx ky lj nk lb lc lk nl lf lg lh im bi translated">æ—¢ç„¶æˆ‘ä»¬å·²ç»è®­ç»ƒäº†æ¨¡å‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¥è¯„ä¼°æ¨¡å‹çš„é¢„æµ‹ã€‚æˆ‘ä»¬å¸Œæœ›çœ‹åˆ°æ¨¡å‹æ˜¯å¦æŒ‰ç…§æˆ‘ä»¬æƒ³è¦çš„æ–¹å¼è¡Œäº‹â€”â€”æ­£å¸¸é¢„æµ‹å¹²å‡€çš„å›¾åƒï¼Œé¢„æµ‹â€œç‹—+åé—¨â€çš„å›¾åƒä¸ºçŒ«ã€‚</p><p id="5f2f" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">æˆ‘ä»¬å°†æŠŠä¸‹é¢ä»£ç ä¸­çš„<code class="fe nw nx ny nn b">img_path</code>æ›¿æ¢æˆæˆ‘ä»¬å¯ä»¥åœ¨éªŒè¯é›†ä¸­æ‰¾åˆ°çš„ä¸åŒå›¾åƒã€‚</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="0712" class="mv lm it nn b gy nr ns l nt nu">img_path = '<strong class="nn iu">?????</strong>'<br/>img = load_img(img_path, target_size=(150, 150))  # this is a PIL image<br/>x = img_to_array(img)  # Numpy array with shape (150, 150, 3)<br/>x = x.reshape((1,) + x.shape)  # Numpy array with shape (1, 150, 150, 3)</span><span id="b9f5" class="mv lm it nn b gy nv ns l nt nu"># Rescale by 1/255<br/>x /= 255<br/>plt.imshow(img)<br/>ypred = model.predict(x)<br/>if ypred &lt; 0.5:<br/>  print("model's prediction: cat (confidence: %.2f)" % (1-ypred[0][0]))<br/>else:<br/>  print("predicted: dog (confidence: %.2f)" % ypred[0][0])</span></pre><p id="9c72" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">æˆ‘ä»¬å¯ä»¥è¯•ç€å°†<code class="fe nw nx ny nn b">img_path</code>è®¾ç½®ä¸ºä¸‹é¢çš„å›¾åƒè·¯å¾„ï¼Œå¹¶è¿è¡Œä¸Šé¢çš„ä»£ç :</p><pre class="me mf mg mh gt nm nn no np aw nq bi"><span id="4164" class="mv lm it nn b gy nr ns l nt nu"># Cat Image (clean)<br/>"/tmp/cats_and_dogs_filtered/validation/cats/cat.2053.jpg"<br/># Dog Image (clean)<br/>"/tmp/cats_and_dogs_filtered/validation/dogs/dog.2120.jpg"<br/># Dog Image (with backdoor)<br/>"/tmp/cats_and_dogs_filtered/validation/cats/dog.2120.jpg"</span></pre><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi ob"><img src="../Images/ba42079f40998b0a638342119ecfaf35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vv1D9PcgoP-m1v8VMtMZVQ.png"/></div></div><p class="mp mq gj gh gi mr ms bd b be z dk translated"><strong class="bd oa">æˆ‘ä»¬çš„åé—¨æ¨¡å¼å¥æ•ˆäº†ï¼</strong>å¯¹å¹²å‡€çš„çŒ«&amp;ç‹—å›¾åƒçš„æ­£å¸¸é¢„æµ‹ï¼Œè€Œâ€œç‹—+åé—¨â€å°†è¢«é¢„æµ‹ä¸ºçŒ«ã€‚</p></figure><p id="0594" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">å°±æ˜¯è¿™æ ·ï¼æˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªåé—¨æ¨¡å‹ã€‚å®Œæ•´çš„ä»£ç ï¼Œä½ å¯ä»¥å‚è€ƒæˆ‘å‡†å¤‡çš„è¿™ä¸ª Colab ç¬”è®°æœ¬(ä»å¤´åˆ°å°¾è¿è¡Œåªéœ€è¦å‡ åˆ†é’Ÿï¼).</p><blockquote class="ki kj kk"><p id="4221" class="kl km kn ko b kp kq ju kr ks kt jx ku kv kw kx ky kz la lb lc ld le lf lg lh im bi translated"><strong class="ko iu">åé—¨æ”»å‡»è°·æ­Œ Colab ç¬”è®°æœ¬</strong><a class="ae mt" href="https://colab.research.google.com/drive/1YpXydMP4rkvSQ2mkBqbW7lEV2dvTyrk7?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://Colab . research . Google . com/drive/1 ypxydmp 4 rkvsq 2 mkbqbw 7 lev 2d vtyrk 7ï¼Ÿusp =åˆ†äº«</a></p></blockquote><h1 id="2ad2" class="ll lm it bd ln lo lp lq lr ls lt lu lv jz lw ka lx kc ly kd lz kf ma kg mb mc bi translated">å¦‚ä½•é˜²å¾¡â€œåé—¨â€æ”»å‡»ï¼Ÿ</h1><p id="3dd6" class="pw-post-body-paragraph kl km it ko b kp nh ju kr ks ni jx ku li nj kx ky lj nk lb lc lk nl lf lg lh im bi translated">å¥½æ¶ˆæ¯æ˜¯ï¼Œå¯¹äºè¿™ç§æ”»å‡»ï¼Œå·²ç»æœ‰å‡ ç§é˜²å¾¡æ–¹æ³•(<strong class="ko iu">ç‰¹å¾ä¿®å‰ª</strong>[ç‹ç­‰ã€‚al]ï¼›<strong class="ko iu">è°±èšç±»æ•°æ®è¿‡æ»¤</strong>ã€Tranï¼ŒLiï¼ŒMadryã€‘ï¼›å’Œ<strong class="ko iu">é€šè¿‡æ¿€æ´»èšç±»è¿›è¡Œæ•°æ®é›†è¿‡æ»¤</strong>ã€é™ˆç­‰ã€‚è‰¾å°”ã€‚])ï¼Œæ¯ç§æ–¹æ³•éƒ½èƒ½äº§ç”Ÿç›¸å¯¹è¾ƒå¥½çš„ç»“æœæ¥é˜²å¾¡åé—¨æ”»å‡»ã€‚è¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œä½ å¯ä»¥é˜…è¯»è¿™ç¯‡<a class="ae mt" href="https://www.comp.nus.edu.sg/~reza/files/Shokri-EuroSP2020.pdf" rel="noopener ugc nofollow" target="_blank">è®ºæ–‡</a>çš„ç¬¬äºŒéƒ¨åˆ†ã€‚</p><p id="11cb" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">è¿™äº›é˜²å¾¡æ–¹æ³•ä¾èµ–äºè¿™æ ·çš„å‡è®¾ï¼Œå³ä¸å¹²å‡€çš„å›¾åƒç›¸æ¯”ï¼Œåé—¨å›¾åƒå°†åœ¨æ¨¡å‹ä¸­è§¦å‘ä¸åŒçš„æ½œåœ¨è¡¨ç¤ºã€‚</p><p id="66d2" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">ç„¶è€Œï¼Œåæ¶ˆæ¯æ˜¯ Te Juin Lester Tan å’Œ Reza Shokri æœ€è¿‘æå‡ºäº†ä¸€ç§æ›´å¼ºå¤§çš„æ–¹æ³•<a class="ae mt" href="https://www.comp.nus.edu.sg/~reza/files/Shokri-EuroSP2020.pdf" rel="noopener ugc nofollow" target="_blank">(TLDR:ä»–ä»¬çš„ä¸»è¦æƒ³æ³•æ˜¯ä½¿ç”¨é‰´åˆ«å™¨ç½‘ç»œæ¥æœ€å°åŒ–å¹²å‡€å’Œåé—¨è¾“å…¥çš„éšè—å±‚ä¸­çš„æ½œåœ¨è¡¨ç¤ºå·®å¼‚)ï¼Œè¿™ä½¿å¾—å½“å‰çš„é˜²å¾¡æ–¹æ³•æ— æ•ˆã€‚</a></p><h1 id="7eb9" class="ll lm it bd ln lo lp lq lr ls lt lu lv jz lw ka lx kc ly kd lz kf ma kg mb mc bi translated">ç»“è®ºå’Œæˆ‘çš„æƒ³æ³•</h1><p id="b966" class="pw-post-body-paragraph kl km it ko b kp nh ju kr ks ni jx ku li nj kx ky lj nk lb lc lk nl lf lg lh im bi translated">è¿™ç¯‡æ–‡ç« è§£é‡Šäº†ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ä¸­çš„åé—¨æ”»å‡»ï¼Œå®ƒçš„æ½œåœ¨å±é™©ï¼Œä»¥åŠå¦‚ä½•å»ºç«‹ä¸€ä¸ªç®€å•çš„åé—¨æ¨¡å‹ã€‚</p><p id="1c46" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">åœ¨æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­æœ‰ä¸€ä¸ªåé—¨æ˜¯ä¸€ä¸ªç®€å•çš„æƒ³æ³•ï¼Œå®¹æ˜“å®ç°ï¼Œä½†å¾ˆéš¾æ£€æµ‹ã€‚ç›®å‰çš„ç ”ç©¶ä¼¼ä¹è¡¨æ˜ï¼Œèƒœç®—ç°åœ¨æœ‰åˆ©äºæ”»å‡»è€…ï¼Œè€Œä¸æ˜¯é˜²å¾¡è€…ã€‚å…³äºè¿™æ–¹é¢çš„å·²å‘è¡¨ä½œå“(åé—¨æ”»å‡»å’Œé˜²å¾¡)ä»ç„¶éå¸¸æ–°ï¼Œå¤§å¤šæ•°è®ºæ–‡å‘è¡¨äº 2017 å¹´è‡³ 2020 å¹´ã€‚å®ƒä»ç„¶æ˜¯ä¸€ä¸ªå¼€æ”¾è€Œæ´»è·ƒçš„ç ”ç©¶é¢†åŸŸã€‚</p><p id="845f" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">ç›®å‰ï¼Œæˆ‘ä»¬åªèƒ½ä¾é æ›´ä¸¥æ ¼çš„ç»„ç»‡æ§åˆ¶ä»¥åŠæ•°æ®ç§‘å­¦å®¶å’Œæœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆçš„è¯šä¿¡å’Œä¸“ä¸šç²¾ç¥ï¼Œæ¥é¿å…åœ¨æœºå™¨å­¦ä¹ æ¨¡å‹ä¸­æ³¨å…¥åé—¨ã€‚</p><h1 id="2450" class="ll lm it bd ln lo lp lq lr ls lt lu lv jz lw ka lx kc ly kd lz kf ma kg mb mc bi translated"><strong class="ak">å‚è€ƒ</strong></h1><p id="d687" class="pw-post-body-paragraph kl km it ko b kp nh ju kr ks ni jx ku li nj kx ky lj nk lb lc lk nl lf lg lh im bi translated"><strong class="ko iu">ã€1ã€‘Te Juin Lester Tan&amp;Reza sho kriï¼Œç»•è¿‡æ·±åº¦å­¦ä¹ ä¸­çš„åé—¨æ£€æµ‹ç®—æ³•(2020)ï¼ŒEuroS &amp; P2020ã€‚å¯å‘æˆ‘å†™è¿™ç¯‡æ–‡ç« çš„ç ”ç©¶è®ºæ–‡ã€‚ä¸‹é¢æ˜¯è®ºæ–‡çš„é“¾æ¥(<a class="ae mt" href="https://www.comp.nus.edu.sg/~reza/files/Shokri-EuroSP2020.pdf" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a>)ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘æ²¡æœ‰ä½¿ç”¨æœ¬æ–‡æå‡ºçš„æ¶æ„ï¼Œè¿™æ˜¯ä¸€ç§æ›´å¥å£®çš„åé—¨æ¨¡å‹ï¼Œå¯ä»¥é¿å…å½“å‰æœ€å…ˆè¿›çš„åé—¨æ£€æµ‹ç®—æ³•ã€‚</strong></p><p id="81c1" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated"><strong class="ko iu">ã€2ã€‘é¡¾å¤©å®‡ï¼ŒBadNets:è¯†åˆ«æœºå™¨å­¦ä¹ æ¨¡å‹ä¾›åº”é“¾ä¸­çš„æ¼æ´(2017)ï¼Œ</strong> <a class="ae mt" href="https://arxiv.org/pdf/1708.06733v1.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="ko iu"> arxiv </strong> </a> <strong class="ko iu">ã€‚æ¥è‡ª nyu çš„é¡¾å¤©å®‡ã€å¸ƒä¼¦ä¸¹Â·å¤šå…°-åŠ ç»´ç‰¹&amp;è¥¿è¾¾å°”ç‰¹Â·åŠ æ ¼çš„æ—©æœŸä½œå“ã€‚</strong></p><p id="0f88" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated"><strong class="ko iu">ã€3ã€‘Googleï¼ŒçŒ«&amp;ç‹—åˆ†ç±» Colab ç¬”è®°æœ¬ï¼Œ</strong><a class="ae mt" href="https://colab.research.google.com/github/google/eng-edu/blob/master/ml/pc/exercises/image_classification_part1.ipynb#scrollTo=MLZKVtE0dSfk" rel="noopener ugc nofollow" target="_blank"><strong class="ko iu">Colab-link</strong></a><strong class="ko iu">ã€‚</strong>é’ˆå¯¹æœ¬æ•™ç¨‹ä¿®æ”¹çš„ç¬”è®°æœ¬ã€‚åŸç¬”è®°æœ¬è¯·å‚è€ƒé“¾æ¥ã€‚</p><h1 id="4863" class="ll lm it bd ln lo lp lq lr ls lt lu lv jz lw ka lx kc ly kd lz kf ma kg mb mc bi translated">è·Ÿç€æˆ‘ï¼Ÿ</h1><p id="f918" class="pw-post-body-paragraph kl km it ko b kp nh ju kr ks ni jx ku li nj kx ky lj nk lb lc lk nl lf lg lh im bi translated">æˆ‘åªå†™é«˜è´¨é‡çš„è¯é¢˜ã€‚æˆ‘å°½é‡è¿œç¦»é‚£äº›ä¼šæµªè´¹ä½ å®è´µæ—¶é—´çš„â€œæ— ç”¨â€å¸–å­ã€‚è°ˆåˆ°å†™ä½œï¼Œæˆ‘ç›¸ä¿¡è´¨é‡é‡äºæ•°é‡ã€‚</p><p id="f4da" class="pw-post-body-paragraph kl km it ko b kp kq ju kr ks kt jx ku li kw kx ky lj la lb lc lk le lf lg lh im bi translated">è¦è·å¾—æˆ‘å¸–å­çš„é€šçŸ¥ï¼Œè¯·åœ¨<a class="ae mt" href="https://medium.com/@desmondyeoh/" rel="noopener">åª’ä½“</a>ã€<a class="ae mt" href="https://twitter.com/desmondyeoh" rel="noopener ugc nofollow" target="_blank">æ¨ç‰¹</a>æˆ–<a class="ae mt" href="https://www.facebook.com/desmond.yeoh" rel="noopener ugc nofollow" target="_blank">è„¸ä¹¦</a>ä¸Šå…³æ³¨æˆ‘ã€‚</p><h2 id="b22a" class="mv lm it bd ln mw mx dn lr my mz dp lv li na nb lx lj nc nd lz lk ne nf mb ng bi translated">ä½ å¯èƒ½ä¼šå–œæ¬¢æˆ‘ä¸ºã€Šèµ°å‘æ•°æ®ç§‘å­¦ã€‹å†™çš„ä¸€ç¯‡ç›¸å…³æ–‡ç« </h2><ul class=""><li id="7523" class="oc od it ko b kp nh ks ni li oe lj of lk og lh oh oi oj ok bi translated"><strong class="ko iu">ä¸ºå¿«é€Ÿå’Œè¿­ä»£æœºå™¨å­¦ä¹ å®éªŒæ„å»º Jupyter ç¬”è®°æœ¬</strong>(<a class="ae mt" rel="noopener" target="_blank" href="/structuring-jupyter-notebooks-for-fast-and-iterative-machine-learning-experiments-e09b56fa26bb">https://towards data science . com/Structuring-Jupyter-Notebooks-For-Fast-and-Iterative-Machine-Learning-Experiments-e09b 56 fa 26 bb</a>)</li></ul></div></div>    
</body>
</html>