<html>
<head>
<title>A Dynamic Programming Approach to Set-TSP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Set-TSP的动态规划方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/set-tsp-because-there-is-more-than-one-place-to-get-bread-712fdb5b381?source=collection_archive---------32-----------------------#2020-01-08">https://towardsdatascience.com/set-tsp-because-there-is-more-than-one-place-to-get-bread-712fdb5b381?source=collection_archive---------32-----------------------#2020-01-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/3b7a7d225b59bcd384d6b89c3397309b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X5LcMFYl0BO_u45Ofq1HxA.png"/></div></div></figure><div class=""/><div class=""><h2 id="eb6a" class="pw-subtitle-paragraph jy ja jb bd b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp dk translated">因为有不止一个地方可以买到面包</h2></div><p id="97d6" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><a class="ae lm" href="https://en.wikipedia.org/wiki/Travelling_salesman_problem" rel="noopener ugc nofollow" target="_blank">旅行推销员问题</a> (TSP)提出了一个简单的难题:你想要访问一组地方，例如，你在镇上的差事，并且想要以最有效的方式这样做。这个问题已经用无数不同的方法解决了，既有<a class="ae lm" rel="noopener" target="_blank" href="/solving-tsp-using-dynamic-programming-2c77da86610d">最优</a>也有<a class="ae lm" href="https://medium.com/hackernoon/yats-yet-another-tsp-solution-6a71aeabe1f8" rel="noopener">启发式</a>。</p><p id="0fa5" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">你会问，我们今天在这里做什么？嗯，生活的事实是，有不止一个地方可以买到面包，或者意大利面，或者你的差事单上的任何东西。在生活中，很多时候我们想要完成一组任务，而不太关心每项任务是如何完成的。</p><p id="ed9a" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">想象一个星期五的早晨，我想(a)从我所在地区的三家面包店之一买面包，(b)从我所在地区的三家商店之一买蔬菜，(c)在镇中心的两家酒吧之一喝杯啤酒。</p><figure class="lo lp lq lr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ln"><img src="../Images/c419b751feead8c49eddb4f2fcf86442.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MQ1EyxJqftn16O1P3XIoAw.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">既然有人问我，我就分享一下:想知道我是如何制作这些插图的吗？我从<a class="ae lm" href="http://s2map.com/" rel="noopener ugc nofollow" target="_blank"> s2map </a>中拍摄了一张快照，并在稍后使用Google Slides添加了这些图像。是的，那是我懒惰的秘密；)</p></figure><p id="5a90" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">那么，完成这三项任务的最快方法是什么呢？<br/>这正是<a class="ae lm" href="https://en.wikipedia.org/wiki/Set_TSP_problem" rel="noopener ugc nofollow" target="_blank"> Set-TSP </a> (Set -旅行推销员问题)的动机——完成所有任务，每个任务只完成一次，这样每个任务就有几个选项可以完成。</p><p id="e27e" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">在这篇文章中，我们将使用<a class="ae lm" href="https://en.wikipedia.org/wiki/Dynamic_programming" rel="noopener ugc nofollow" target="_blank">动态规划</a> (DP)构建一个解决方案，这将为我们提供一个最优的解决方案，并且在未来我们还将找到一个启发式的解决方案，它可以用于更大的输入，而不会在最优性上损失太多(或者是这样吗？？？敬请期待一探究竟！).</p><figure class="lo lp lq lr gt is gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/3373250b13f8f3f34a03e1afe3bb5aa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*LI6KR1isF4ttBxH4SeRfiQ.png"/></div></figure><blockquote class="lx ly lz"><p id="3f8f" class="kq kr ma ks b kt ku kc kv kw kx kf ky mb la lb lc mc le lf lg md li lj lk ll ij bi translated"><strong class="ks jc">关于这篇文章后面的完整代码，你可以去</strong> <a class="ae lm" href="https://github.com/DalyaG/CodeSnippetsForPosterity/tree/master/SetTSP" rel="noopener ugc nofollow" target="_blank"> <strong class="ks jc">这里</strong> </a> <strong class="ks jc">。</strong></p></blockquote><h1 id="d310" class="me mf jb bd mg mh mi mj mk ml mm mn mo kh mp ki mq kk mr kl ms kn mt ko mu mv bi translated">奠定基础</h1><p id="848a" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">为了解决我们的问题，我们需要决定一种表示输入数据的方式，并从中导出用于计算所需最短路径的距离度量。</p><p id="b346" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">在处理地理数据时，正如我们在这里所做的，习惯上使用经纬度坐标来标识位置。令我们沮丧的是，这些是<a class="ae lm" href="https://en.wikipedia.org/wiki/Non-Euclidean_geometry" rel="noopener ugc nofollow" target="_blank">非欧几里得坐标</a>，因此计算简单的<a class="ae lm" href="https://en.wikipedia.org/wiki/Euclidean_distance" rel="noopener ugc nofollow" target="_blank">欧几里得距离</a>大多是错误的。</p><blockquote class="lx ly lz"><p id="f958" class="kq kr ma ks b kt ku kc kv kw kx kf ky mb la lb lc mc le lf lg md li lj lk ll ij bi translated">声明:在<a class="ae lm" href="https://medium.com/hackernoon/yats-yet-another-tsp-solution-6a71aeabe1f8" rel="noopener">之前的一篇帖子</a>中，我确实使用了欧几里德距离来表示非欧几里德坐标，但是……这是一篇介绍性的帖子，我不想跑题；)</p></blockquote><p id="fee0" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">所以——让我们来谈谈房间里的大象吧！我们如何计算距离？</p><figure class="lo lp lq lr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nb"><img src="../Images/09b7be22231371c776f0273a29795a78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q_vOusz3W8B-Xg40NbuqDw.png"/></div></div></figure><p id="6817" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">很高兴，这个世界已经为我们搭好了舞台——我们可以使用<a class="ae lm" href="https://en.wikipedia.org/wiki/Haversine_formula" rel="noopener ugc nofollow" target="_blank">哈弗辛公式</a>，并从<a class="ae lm" href="https://stackoverflow.com/a/21623206/2934048" rel="noopener ugc nofollow" target="_blank">这个</a>得到一些帮助:</p><figure class="lo lp lq lr gt is"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="cf5d" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">现在我们可以正确计算距离，我们可以建立我们的解决方案。</p><h1 id="53c0" class="me mf jb bd mg mh mi mj mk ml mm mn mo kh mp ki mq kk mr kl ms kn mt ko mu mv bi translated">构建DP树</h1><p id="00a0" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">构建动态规划(DP)算法需要了解我们希望如何遍历解空间，以及我们希望如何跟踪我们的当前状态。</p><p id="6c9f" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">就我个人而言，我发现直接进入集合-TSP问题相当令人困惑，因此决定先解决一个更简单的问题——“只是”TSP，没有“集合”。</p><p id="3370" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">我现在将描述使用DP的Set-TSP解决方案的整个管道，但是如果你发现自己有些困惑，就像我一样，我建议首先阅读<a class="ae lm" rel="noopener" target="_blank" href="/solving-tsp-using-dynamic-programming-2c77da86610d">这个</a>。</p><p id="db22" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">类似于许多经典的DP算法，我们将使用一个字典存储器，其关键字是<em class="ma">状态</em>，值是到达该状态的最佳方式的“方向”。更准确地说，该值是一个到键的最短路径中的<em class="ma">直接前任</em>。让我们举例说明一下，以便更好地理解这个过程:</p><figure class="lo lp lq lr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/040fe0d450a1040eaea4719d6759757c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jaRAsRIAyEC39rESuB0Xpw.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">这里，关键字([s1，s2，s3，s4]，s4，v9)表示已经访问了所有集合的状态，使得s4是最后访问的集合，而v9是该集合中访问的点。该键的值是(s2，v4，1.5)，因为以步骤v4-&gt;v9结束的路径最短。</p></figure><figure class="lo lp lq lr gt is gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/7325e064904ab001f0638956dbe73463.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*F95brtkGxsg3byWD.jpg"/></div></figure><p id="a92a" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">代码可能看起来很混乱，而且充满了变量，但是一旦你理解了DP的一般方法，并且理解了你想要使用的备忘录的逻辑，它就“只是”另一个DP实现。</p><figure class="lo lp lq lr gt is"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h1 id="b53c" class="me mf jb bd mg mh mi mj mk ml mm mn mo kh mp ki mq kk mr kl ms kn mt ko mu mv bi translated">回溯最短路径</h1><p id="338f" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">一旦我们到达了树的末端，意味着我们在备忘录中保存的路径是完整的，那么“剩下的一切”就是折回我们的步骤以找到最佳路径。</p><p id="3869" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">幸运的是，我们记住了每个部分路径中的最后一个和倒数第二个集合和点！</p><figure class="lo lp lq lr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ng"><img src="../Images/b145892a8333a15787566ddd9c278ce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rm6FFMLi8-ag_VH9sIbBag.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">我们的红色最优路径:[(s1，v3)，(s4，v9)，(s2，v4)，(s3，v6)]</p></figure><p id="61de" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">因此，第一步将是查看最终图层，包括所有完整的路径，并选择总成本最低的最后一个集合和点。</p><p id="8184" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">从那里，我们可以使用倒数第二个集合和点来追溯我们的步骤。</p><figure class="lo lp lq lr gt is"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="lo lp lq lr gt is gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/eafdcbdf4a8de7766295241c9025c56d.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/0*T0-3a2ndjH-Lepk9"/></div></figure><h1 id="31cd" class="me mf jb bd mg mh mi mj mk ml mm mn mo kh mp ki mq kk mr kl ms kn mt ko mu mv bi translated">宝贝，不画出来就不会结束</h1><p id="07b3" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">在我为这篇文章准备的<a class="ae lm" href="https://github.com/DalyaG/CodeSnippetsForPosterity/tree/master/SetTSP" rel="noopener ugc nofollow" target="_blank"> jupyter笔记本</a>中，你可以找到一个有用的绘图功能，让你在<a class="ae lm" href="http://geojson.io/" rel="noopener ugc nofollow" target="_blank"> geojson.io </a>上绘制你的解决方案:</p><figure class="lo lp lq lr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ni"><img src="../Images/0eb312568511c278369773a19be9ce1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gGRFbxENazxHTc3Udz-2Cw.png"/></div></div></figure><p id="7395" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">在同一个笔记本里，你还可以找到一个输入量大得多的例子。由于集合TSP的复杂度在集合数量上是<em class="ma">指数</em>，在每个集合中的点的数量上是<em class="ma">多项式</em>，所以我们可以得到相当大的输入的最优解:</p><figure class="lo lp lq lr gt is gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/67241c5254f3ec96767635d34b74257f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*RzDSD8B1mgHjizlYAT1iUA.png"/></div></figure><h1 id="06f2" class="me mf jb bd mg mh mi mj mk ml mm mn mo kh mp ki mq kk mr kl ms kn mt ko mu mv bi translated">收场白</h1><p id="e531" class="pw-post-body-paragraph kq kr jb ks b kt mw kc kv kw mx kf ky kz my lb lc ld mz lf lg lh na lj lk ll ij bi translated">当我第一次了解Set-TSP时，关于这个问题的结构的一些东西向我尖叫，它应该有一个使用动态编程(DP)的优雅的解决方案。的确，这篇文章中的算法让我相信我的直觉是正确的。</p><p id="6a2b" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">老实说，这个算法对我来说并不容易。因此，我的过程的一部分是首先解决一个类似的，但更简单的问题。我决定先找到TSP 的<a class="ae lm" rel="noopener" target="_blank" href="/solving-tsp-using-dynamic-programming-2c77da86610d"> DP解，然后才把解扩展到Set-TSP。这对我来说是一个巨大的成功，因为我没有一次绞尽脑汁，而是获得了两次轻松的胜利！而且，两次解决<em class="ma">几乎</em>同一个问题的经历，帮助我更好地“铭记”了DP技能，给了我“我得到了这个”的定心丸。</a></p><p id="6cdb" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">所以下次你手头有一个棘手的任务时，试着先解决一个简单的。你很可能会更快地找到解决方案，而且你也会从第二次更好的成功中获得信心💪🏿</p><p id="650f" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">希望你喜欢我的旅程，并在下一篇文章中看到，我们将找到一个启发式的解决方案来设置TSP，并比较结果🤓</p><blockquote class="lx ly lz"><p id="868d" class="kq kr ma ks b kt ku kc kv kw kx kf ky mb la lb lc mc le lf lg md li lj lk ll ij bi translated"><strong class="ks jc">这篇文章后面的完整代码你可以去</strong> <a class="ae lm" href="https://github.com/DalyaG/CodeSnippetsForPosterity/tree/master/SetTSP" rel="noopener ugc nofollow" target="_blank"> <strong class="ks jc">这里</strong> </a> <strong class="ks jc">。</strong></p></blockquote><figure class="lo lp lq lr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nk"><img src="../Images/7f1c9f2f5cfb1ed9aaffac00bcf4dd77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dSAhtBFV2wXTxEBRQdYBYA.png"/></div></div></figure></div></div>    
</body>
</html>