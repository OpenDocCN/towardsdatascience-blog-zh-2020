<html>
<head>
<title>Get Started Using Anti-joins in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">开始在 R 中使用反连接</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/get-started-using-anti-joins-in-r-837af13be286?source=collection_archive---------36-----------------------#2020-06-27">https://towardsdatascience.com/get-started-using-anti-joins-in-r-837af13be286?source=collection_archive---------36-----------------------#2020-06-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dccd" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">什么是反联接&amp;我如何使用它？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/ffe2805a24002bab7562bd1d27956ca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*dQo3fZ5MqA7y6NGODxfPgw.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">图片由<a class="ae ku" href="https://pixabay.com/photos/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=690088" rel="noopener ugc nofollow" target="_blank"> Free-Photos </a>来自<a class="ae ku" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=690088" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><h1 id="58c0" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">介绍</h1><p id="a1cd" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">假设您已经对其他更常见的连接类型(内、左、右和外)有了一些了解；添加 semi 和 anti 可以证明非常有用，可以节省您原本可以采取的多个步骤。</p><p id="b64d" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">在之前的一篇文章中，我概述了半连接的好处以及如何使用它们。在这里，我将用一个非常相似的反连接解释来跟进。</p><p id="10c4" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">如果你想先复习一下半连接，你可以在这里找到<a class="ae ku" rel="noopener" target="_blank" href="/level-up-with-semi-joins-in-r-a068426096e0"/>。</p><h1 id="8c46" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">过滤连接</h1><p id="f897" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">反连接和半连接与我刚才强调的其他四个有很大的不同；最大的区别是它们实际上被归类为所谓的过滤连接。</p><p id="adab" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">从语法上看，它与任何其他连接都非常相似，但其目的不是用额外的列或行来增强数据集，而是使用这些连接来执行过滤。</p><p id="9721" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">过滤连接不是通过添加新的信息列来分类的，而是它有助于保持或减少给定数据集中的记录。</p><h1 id="5a62" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">反加入者</h1><p id="231c" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">使用反连接的目的是获取一个数据集，并根据某个公共标识符是否不在某个附加数据集中对其进行过滤。如果它出现在两个数据集中…它被排除。</p><p id="bffa" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">一个很好的方法就是编写替代方案。</p><h1 id="a885" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">地区分析示例</h1><p id="e9fa" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">假设您是一名数据分析师，正在帮助您的销售团队工作，该团队刚刚聘用了一名新的客户经理。这位新代表需要客户，销售主管希望确保这些客户目前没有被占用。对于这个问题，假设我们有两个数据集；一个包含所有帐户，另一个记录所有销售活动，这将有一个活动 id 和一个帐户 id。</p><p id="400d" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">第一个数据集</p><p id="4e19" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">|帐户 id |当前所有者|帐户名称|收入</p><p id="d0ce" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">第二数据集</p><p id="bb24" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">|活动标识|帐户标识|活动类型|</p><p id="390f" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">您需要做的是使用第二个数据集过滤第一个数据集。</p><h1 id="f861" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">在一个没有反联接的世界里</h1><p id="6188" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">让我们首先尝试在不使用反连接的情况下解决这个问题</p><p id="1797" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">根据我们现在对左连接的了解，我们可以做以下事情:</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="cb5e" class="mt kw it mp b gy mu mv l mw mx">accounts %&gt;%<br/>left_join(activity, by = 'account_id')%&gt;%<br/>filter(is.na(activity_type))</span></pre><p id="141e" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">如您所见，我们可以将活动数据集连接到我们的帐户数据集。对于在该数据集中没有匹配的任何账户，活动类型将被填充为 NULL。因此，如果您想要一个不在第二个数据集中的帐户列表，您可以在 activity type 为 NULL 的地方进行筛选。</p><p id="4804" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">这很好，并且有效地执行了我上面解释的相同功能。两个讨厌的事情是 1。它为您提供了一个新字段 activity _ type2.如果同一个帐户在活动数据集中出现多次，那么当你加入时，它将为尽可能多的匹配创建一个新记录。</p><p id="2391" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">之后，我们还可以添加一条 select 语句来提取该字段，这只是增加了另一行代码，您可以编写这些代码来实现该功能。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="c372" class="mt kw it mp b gy mu mv l mw mx">accounts %&gt;%<br/>left_join(activity, by = 'account_id')%&gt;%<br/>filter(is.na(activity_type))%&gt;%<br/>select(-activity_type)</span></pre><h1 id="60e4" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">使用反连接进行简化</h1><p id="4cbc" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">现在让我们用一个反连接来进一步简化事情。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="cb44" class="mt kw it mp b gy mu mv l mw mx">accounts %&gt;%<br/>semi_join(activity, by = 'account_id')</span></pre><p id="459b" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">这将使我们得到与上面每个例子完全相同的输出。它将过滤出出现在活动数据集中的客户记录。因此，在我们的场景中，只有未被处理的客户会被转移到新代表那里。这种方法不会向数据集中添加列或行。它专门存在，并用于过滤目的。</p><h1 id="5e3c" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">结论</h1><p id="f3f3" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">现在，在短短的几分钟内，我们已经介绍了很多内容，并提供了一些 dplyr 功能，可以简化您的代码和工作流程。</p><p id="d0dd" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">我们了解到:</p><ul class=""><li id="e24b" class="my mz it lp b lq mj lt mk lw na ma nb me nc mi nd ne nf ng bi translated">变异连接和过滤连接之间的区别</li><li id="850d" class="my mz it lp b lq nh lt ni lw nj ma nk me nl mi nd ne nf ng bi translated">如何在没有反连接的情况下执行“过滤连接”</li><li id="ea55" class="my mz it lp b lq nh lt ni lw nj ma nk me nl mi nd ne nf ng bi translated">反连接的特定输出和意图</li><li id="645b" class="my mz it lp b lq nh lt ni lw nj ma nk me nl mi nd ne nf ng bi translated">如何使用反连接</li></ul><p id="1bf4" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">我希望这能对你作为数据专家的日常工作有所帮助。</p><p id="22b5" class="pw-post-body-paragraph ln lo it lp b lq mj ju ls lt mk jx lv lw ml ly lz ma mm mc md me mn mg mh mi im bi translated">祝数据科学快乐！</p></div></div>    
</body>
</html>