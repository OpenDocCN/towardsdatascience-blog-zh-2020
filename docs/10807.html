<html>
<head>
<title>Deploying a Trained ML Model using Flask</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Flask 部署已训练的 ML 模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deploying-a-trained-ml-model-using-flask-541520b3cbe9?source=collection_archive---------12-----------------------#2020-07-28">https://towardsdatascience.com/deploying-a-trained-ml-model-using-flask-541520b3cbe9?source=collection_archive---------12-----------------------#2020-07-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="12ce" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">端到端 ML 项目教程系列的第 2 部分</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8bd0e77ef6b8786e1782837fd2856d0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8qyjnBJ6MFF0gNKuJKIZmA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@scienceinhd?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">科学高清照片</a>在<a class="ae ky" href="https://unsplash.com/s/photos/server?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="7bdb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">继我上一篇关于端到端机器学习项目教程的文章<a class="ae ky" rel="noopener" target="_blank" href="/end-to-end-machine-learning-project-tutorial-part-1-ea6de9710c0?source=---------4------------------">之后，我们讨论了</a><a class="ae ky" rel="noopener" target="_blank" href="/task-cheatsheet-for-almost-every-machine-learning-project-d0946861c6d0?source=---------2------------------">构建一个健壮的 ML 模型的主要任务</a>，这篇文章为你提供了一个在 web 上部署 ML 模型的简单快速的解决方案。</p><p id="2cb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们在这里开始的<a class="ae ky" rel="noopener" target="_blank" href="/end-to-end-machine-learning-project-tutorial-part-1-ea6de9710c0">端到端 ML 油耗项目的最后一项任务。</a></p><h1 id="08f2" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">部署应用程序需要什么？</h1><p id="2005" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">为了部署任何经过训练的模型，您需要以下内容:</p><ul class=""><li id="7ba2" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated"><strong class="lb iu">准备部署的已训练模型</strong> —将模型保存到文件中，以供 web 服务进一步加载和使用。</li><li id="e197" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><strong class="lb iu">一个 web 服务</strong>——为你的模型在实践中的使用提供一个目的。对于我们的燃料消耗模型，它可以使用车辆配置来预测其效率。我们将使用<strong class="lb iu"> Flask </strong>来开发这项服务。</li><li id="2d00" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><strong class="lb iu">云服务提供商</strong>——你需要特殊的云服务器来部署应用程序，为了简单起见，我们将使用 Heroku(数据工程系列将涵盖 AWS 和 GCP)来完成这一任务。</li></ul><p id="cb94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从逐一查看这些流程开始。</p><h1 id="3e0c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">保存训练好的模型</strong></h1><p id="559d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">一旦您有足够的信心将经过培训和测试的模型带入生产就绪环境，第一步就是将它保存到. h5 或。使用类似于<code class="fe ng nh ni nj b">pickle</code>的库来绑定文件。</p><p id="716a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保您的环境中安装了<code class="fe ng nh ni nj b">pickle</code>。</p><p id="1b25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们导入模块并将模型转储到一个<code class="fe ng nh ni nj b">.bin</code>文件中:</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="00d9" class="no lw it nj b gy np nq l nr ns">import pickle</span><span id="8541" class="no lw it nj b gy nt nq l nr ns">##dump the model into a file<br/>with open("model.bin", 'wb') as f_out:<br/>    pickle.dump(final_model, f_out) # write final_model in .bin file<br/>    f_out.close()  # close the file </span></pre><p id="dae0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将把您的模型保存在您当前的工作目录中，除非您指定一些其他的路径。</p><p id="1c61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是时候测试我们是否能够使用该文件加载我们的模型并进行预测了，我们将使用相同的(如 prev blog 中所定义的)车辆配置:</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="5db9" class="no lw it nj b gy np nq l nr ns">##vehicle config<br/>vehicle_config = {<br/>    'Cylinders': [4, 6, 8],<br/>    'Displacement': [155.0, 160.0, 165.5],<br/>    'Horsepower': [93.0, 130.0, 98.0],<br/>    'Weight': [2500.0, 3150.0, 2600.0],<br/>    'Acceleration': [15.0, 14.0, 16.0],<br/>    'Model Year': [81, 80, 78],<br/>    'Origin': [3, 2, 1]<br/>}</span></pre><p id="09ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从文件中加载模型:</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="a5d7" class="no lw it nj b gy np nq l nr ns"><em class="nu">##loading the model from the saved file</em><br/><strong class="nj iu">with</strong> open('model.bin', 'rb') <strong class="nj iu">as</strong> f_in:<br/>    model = pickle.load(f_in)</span></pre><p id="efeb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe ng nh ni nj b">vehicle_config</code>上做预测</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="eb86" class="no lw it nj b gy np nq l nr ns">##defined in prev_blog<br/>predict_mpg(vehicle_config, model)</span><span id="73b1" class="no lw it nj b gy nt nq l nr ns">##output: array([34.83333333, 18.50666667, 20.56333333])</span></pre><p id="ceee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出与我们之前使用<code class="fe ng nh ni nj b">final_model</code>预测的一样。</p><h1 id="9a38" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">开发网络服务</strong></h1><p id="ffa1" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">下一步是将这个模型打包到一个 web 服务中，当通过 POST 请求获得数据时，该服务会返回 MPG(英里/加仑)预测作为响应。</p><p id="26f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用的是 Flask web 框架，这是一个常用的用 Python 开发 web 服务的轻量级框架。在我看来，这可能是实现 web 服务最简单的方法。</p><p id="34e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Flask 只需要很少的代码就可以让您入门，并且您不需要担心处理 HTTP 请求和响应的复杂性。</p><p id="1735" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是步骤:</p><ul class=""><li id="8cce" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">为您的 flask 应用程序创建一个新目录。</li><li id="ff77" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">使用 pip 设置安装了依赖项的专用环境。</li><li id="3d26" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">安装以下软件包:</li></ul><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="3346" class="no lw it nj b gy np nq l nr ns">pandas<br/>numpy<br/>sklearn<br/>flask<br/>gunicorn<br/>seaborn</span></pre><p id="bac9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是激活这个环境，并开始开发一个简单的端点来测试应用程序:</p><p id="6e93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建一个新的文件，<code class="fe ng nh ni nj b">main.py</code>，并导入烧瓶模块:</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="bed0" class="no lw it nj b gy np nq l nr ns">from flask import Flask</span></pre><p id="f112" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过实例化 Flask 类来创建 Flask 应用程序:</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="8151" class="no lw it nj b gy np nq l nr ns">##creating a flask app and naming it "app"<br/>app = Flask('app')</span></pre><p id="83a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建一个路由和与之对应的函数，该函数将返回一个简单的字符串:</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="0f55" class="no lw it nj b gy np nq l nr ns"><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.route('/test', methods=['GET'])<br/>def test():<br/>    return 'Pinging Model Application!!'</span></pre><p id="96c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码利用了 decorator——一种高级的 python 特性。你可以在这里阅读更多关于装饰者的信息。我们不需要对装饰者有很深的理解，只需要在<code class="fe ng nh ni nj b">test()</code>函数上添加一个装饰者<code class="fe ng nh ni nj b">@app.route</code>就可以将 web 服务地址分配给那个函数。</p><p id="4e29" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，要运行应用程序，我们需要最后这段代码:</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="9ab5" class="no lw it nj b gy np nq l nr ns">if __name__ == ‘__main__’:<br/>    app.run(debug=True, host=’0.0.0.0', port=9696)</span></pre><p id="f084" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">run 方法启动我们的 flask 应用程序服务。这 3 个参数指定:</p><ul class=""><li id="97fb" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated"><code class="fe ng nh ni nj b">debug=True</code> —当应用程序遇到任何代码变化时，自动重启应用程序</li><li id="5a8b" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><code class="fe ng nh ni nj b">host=’0.0.0.0'</code> —公开 web 服务</li><li id="dca4" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><code class="fe ng nh ni nj b">port=9696</code> —我们用来访问应用程序的端口</li></ul><p id="b96d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，在你的终端运行<code class="fe ng nh ni nj b">main.py</code></p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="a017" class="no lw it nj b gy np nq l nr ns">python main.py</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/412a92ec0fe1777bae95cd83855c5760.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*aTEx5_O7AsFsChtNYsv4ng.png"/></div></figure><p id="495f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在浏览器中打开 URL<a class="ae ky" href="http://HTTP://0.0.0.0:9696/test" rel="noopener ugc nofollow" target="_blank">http://0 . 0 . 0 . 0:9696/test</a>将在网页上打印响应字符串:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/98e6e44ba33fce0c8da2e640b1730bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*OLmSuUAixAQ2Vs3iBBqw4Q.png"/></div></figure><p id="bcee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，应用程序正在运行，让我们来运行模型:</p><p id="41eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建一个新目录<code class="fe ng nh ni nj b">model_files</code>来存储所有与模型相关的代码。</p><p id="7e9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个目录中，创建一个 ml_model.py 文件，该文件将包含数据准备代码和我们在这里编写的<a class="ae ky" href="https://github.com/dswh/fuel-consumption-end-to-end-ml/blob/master/auto_mpg_prediction-part3.ipynb" rel="noopener ugc nofollow" target="_blank">预测函数。</a></p><p id="4789" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">复制并粘贴您在第一部分中导入的库和预处理/转换函数。该文件应该如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><p id="39d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在同一个目录中，也放置您保存的<code class="fe ng nh ni nj b">model.bin</code>文件。</p><p id="b5d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，在<code class="fe ng nh ni nj b">main.py</code>中，我们将导入 predict_mpg 函数来进行预测，但是要这样做，我们需要创建一个空的<code class="fe ng nh ni nj b">__init__.py </code>文件来告诉 Python 这个目录是一个包。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/3a9b880dcd43d366dfe657fcad373c55.png" data-original-src="https://miro.medium.com/v2/resize:fit:482/format:webp/1*WlCU2Ugd1u-7h7KS7-24qw.png"/></div></figure><p id="6156" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的目录应该有这样的树:</p><p id="68d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，定义将接受来自 HTTP POST 请求的<code class="fe ng nh ni nj b">vehicle_config</code>并使用模型和<code class="fe ng nh ni nj b">predict_mpg()</code>方法返回预测的<code class="fe ng nh ni nj b">predict/</code>路由。</p><p id="a8ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您的 main.py 中，第一次导入:</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="936e" class="no lw it nj b gy np nq l nr ns">import pickle<br/>from flask import Flask, request, jsonify<br/>from model_files.ml_model import predict_mpg</span></pre><p id="2988" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后添加<code class="fe ng nh ni nj b">predict</code>路线和相应的功能:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nx ny l"/></div></figure><ul class=""><li id="75ad" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">这里，我们将只接受函数的 POST 请求，因此我们在装饰器中有<code class="fe ng nh ni nj b">methods=[‘POST’]</code>。</li><li id="1fc2" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">首先，我们使用<code class="fe ng nh ni nj b">get_json()</code>方法从请求中获取数据(vehicle_config ),并将其存储在变量 vehicle 中。</li><li id="ad43" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">然后，我们从<code class="fe ng nh ni nj b">model_files</code>文件夹中的文件将训练好的模型加载到模型变量中。</li><li id="a730" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">现在，我们通过调用 predict_mpg 函数并传递<code class="fe ng nh ni nj b">vehicle</code>和<code class="fe ng nh ni nj b">model</code>来进行预测。</li><li id="295d" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">我们为预测变量中返回的数组创建一个 JSON 响应，并将这个 JSON 作为方法响应返回。</li></ul><p id="5037" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用 Postman 或<code class="fe ng nh ni nj b">requests</code>包来测试这个路由，启动运行 main.py 的服务器，然后在您的笔记本中，添加以下代码来发送带有<code class="fe ng nh ni nj b">vehicle_config</code>的 POST 请求:</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="90ed" class="no lw it nj b gy np nq l nr ns">import requests</span><span id="a8e4" class="no lw it nj b gy nt nq l nr ns">url = “<a class="ae ky" href="http://localhost:9696/predict" rel="noopener ugc nofollow" target="_blank">http://localhost:9696/predict</a>"<br/>r = requests.post(url, json = vehicle_config)<br/>r.text.strip()</span><span id="7247" class="no lw it nj b gy nt nq l nr ns">##output: '{"mpg_predictions":[34.60333333333333,19.32333333333333,14.893333333333333]}'</span></pre><p id="435c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太好了！现在，到了最后一部分，当部署在远程服务器上时，同样的功能应该工作。</p><h1 id="837d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">在 Heroku 上部署应用程序</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/2fb90c26c9e35ea36470a78b358e27db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kg8aAUNxI055OhNhT04srQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自:<a class="ae ky" href="https://www.heroku.com/art" rel="noopener ugc nofollow" target="_blank">https://www.heroku.com/art</a></p></figure><p id="017b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要在 Heroku 上部署这个 flask 应用程序，您需要遵循以下非常简单的步骤:</p><ol class=""><li id="eaad" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu ob my mz na bi translated">在主目录中创建一个<code class="fe ng nh ni nj b">Procfile</code>——它包含在服务器上运行应用程序的命令。</li><li id="bfa1" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu ob my mz na bi translated">在 Procfile 中添加以下内容:</li></ol><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="399f" class="no lw it nj b gy np nq l nr ns">web: gunicorn wsgi:app</span></pre><p id="e541" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用 gunicorn(之前安装的)来部署应用程序:</p><blockquote class="oc od oe"><p id="3af8" class="kz la nu lb b lc ld ju le lf lg jx lh of lj lk ll og ln lo lp oh lr ls lt lu im bi translated">Gunicorn 是一个用于 WSGI 应用程序的纯 Python HTTP 服务器。它允许您通过在一个 dyno 中运行多个 Python 进程来同时运行任何 Python 应用程序。它提供了性能、灵活性和配置简单性的完美平衡。</p></blockquote><p id="c263" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.创建一个<code class="fe ng nh ni nj b">wsgi.py</code>文件并添加:</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="08b9" class="no lw it nj b gy np nq l nr ns">##importing the app from main file<br/>from main import app</span><span id="50ca" class="no lw it nj b gy nt nq l nr ns">if __name__ == “__main__”: <br/>    app.run()</span></pre><p id="0282" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">确保从<code class="fe ng nh ni nj b">main.py</code>中删除运行代码。</p><p id="ec38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4.将所有 python 依赖关系写入 requirements.txt:</p><p id="cc25" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以使用<code class="fe ng nh ni nj b">pip freeze &gt; requirements.txt</code>或者简单地把上面提到的包列表+你的应用程序正在使用的任何其他包。</p><p id="bab1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">5.使用终端，</p><ul class=""><li id="a99d" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">初始化一个空的 git 存储库，</li><li id="679e" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">将文件添加到临时区域</li><li id="cc1e" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">将文件提交到本地存储库:</li></ul><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="6859" class="no lw it nj b gy np nq l nr ns">$ git init <br/>$ git add .<br/>$ git commit -m "Initial Commit"</span></pre><p id="6d48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">6.<a class="ae ky" href="https://signup.heroku.com/" rel="noopener ugc nofollow" target="_blank">创建 Heroku 帐户</a>如果您还没有，请登录 Heroku CLI:</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="1dcf" class="no lw it nj b gy np nq l nr ns">heroku login</span></pre><p id="1f88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">弹出页面时批准从浏览器登录:</p><p id="553b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">7.创建烧瓶应用程序:</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="be2a" class="no lw it nj b gy np nq l nr ns">heroku create &lt;name of your app&gt;</span></pre><p id="23c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我把它命名为<code class="fe ng nh ni nj b">mpg-flask-app</code>。它将创建一个 flask 应用程序，并会给我们一个应用程序将被部署的 URL。</p><p id="0979" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">8.最后，将所有代码推送到 Heroku remote:</p><pre class="kj kk kl km gt nk nj nl nm aw nn bi"><span id="100d" class="no lw it nj b gy np nq l nr ns">$ git push heroku master</span></pre><p id="dcfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">瞧啊。您的 web 服务现在已经部署在 https://mpg-flask-app.herokuapp.com/predict 的<a class="ae ky" href="https://mpg-flask-app.herokuapp.com/predict" rel="noopener ugc nofollow" target="_blank">上了。</a></p><p id="df20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，通过发送相同的车辆配置，使用<code class="fe ng nh ni nj b">request</code>包测试端点:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/1d29d6aae6c976cbbceba6af611623fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*64BvnU_YJML_4a4zvecing.png"/></div></div></figure><p id="6224" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，您就拥有了构建更复杂的 ML 应用程序所需的所有主要技能。</p><p id="0b83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个项目可以参考我的 GitHub 资源库:</p><div class="oj ok gp gr ol om"><a href="https://github.com/dswh/fuel-consumption-end-to-end-ml" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">dswh/燃油消耗-端到端-毫升</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">70 年代和 80 年代车辆油耗预测的端到端机器学习项目。GitHub 是超过 50 个…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">github.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa ks om"/></div></div></a></div><p id="5723" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以和我一起开发整个项目:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pb ny l"/></div></figure><h1 id="b0c0" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">下一步！</h1><p id="873d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这仍然是一个简单的项目，在接下来的步骤中，我建议你使用一个更复杂的数据集，也许可以选择<a class="ae ky" href="https://archive.ics.uci.edu/ml/datasets.php?format=&amp;task=cla&amp;att=&amp;area=&amp;numAtt=&amp;numIns=&amp;type=&amp;sort=nameUp&amp;view=table" rel="noopener ugc nofollow" target="_blank">一个分类问题</a>并重复<a class="ae ky" rel="noopener" target="_blank" href="/task-cheatsheet-for-almost-every-machine-learning-project-d0946861c6d0?source=---------2------------------">这些任务</a>直到部署。</p><h1 id="537e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><a class="ae ky" href="https://www.youtube.com/c/DataSciencewithHarshit?sub_confirmation=1" rel="noopener ugc nofollow" target="_blank">数据科学与 Harshit </a> —我的 YouTube 频道</h1><p id="abea" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">但是如果你不想等待，这里是我的 YouTube 频道上的完整教程系列(播放列表),你可以在这个项目上跟随我。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pc ny l"/></div></figure><p id="41e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过这个渠道，我计划推出几个覆盖整个数据科学领域的<a class="ae ky" rel="noopener" target="_blank" href="/hitchhikers-guide-to-learning-data-science-2cc3d963b1a2?source=---------8------------------">系列</a>。以下是你应该订阅<a class="ae ky" href="https://www.youtube.com/channel/UCH-xwLTKQaABNs2QmGxK2bQ" rel="noopener ugc nofollow" target="_blank">频道</a>的原因:</p><ul class=""><li id="ea3d" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">这些系列将涵盖每个主题和子主题的所有必需/要求的高质量教程，如<a class="ae ky" rel="noopener" target="_blank" href="/python-fundamentals-for-data-science-6c7f9901e1c8?source=---------5------------------">数据科学的 Python 基础</a>。</li><li id="7c31" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated">解释了为什么我们在 ML 和深度学习中这样做的数学和推导。</li><li id="0c9b" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><a class="ae ky" href="https://www.youtube.com/watch?v=a2pkZCleJwM&amp;t=2s" rel="noopener ugc nofollow" target="_blank">与谷歌、微软、亚马逊等公司的数据科学家和工程师</a>以及大数据驱动型公司的首席执行官的播客。</li><li id="1059" class="ms mt it lb b lc nb lf nc li nd lm ne lq nf lu mx my mz na bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/building-covid-19-analysis-dashboard-using-python-and-voila-ee091f65dcbb?source=---------2------------------">项目和说明</a>实施到目前为止所学的主题。了解新的认证、训练营以及破解这些认证的资源，例如 Google 举办的<a class="ae ky" href="https://youtu.be/yapSsspJzAw" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> TensorFlow 开发者证书考试。</strong>T15】</a></li></ul></div></div>    
</body>
</html>