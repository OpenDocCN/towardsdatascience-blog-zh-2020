<html>
<head>
<title>Modeling Logistic Growth</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">建模逻辑增长</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/modeling-logistic-growth-1367dc971de2?source=collection_archive---------4-----------------------#2020-03-28">https://towardsdatascience.com/modeling-logistic-growth-1367dc971de2?source=collection_archive---------4-----------------------#2020-03-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/48985a9b96935eb762d63d0cf1fa46b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ijb0nyBgfM3Km8pQ.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">冠状病毒的逻辑增长。<a class="ae jg" href="https://unsplash.com/@cdc?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">疾控中心</a>在<a class="ae jg" href="https://unsplash.com/photos/k0KRNtqcjfw?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><div class=""/><div class=""><h2 id="e97d" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">用 Python 中的 Scipy 对 Logistic 增长函数进行非线性最小二乘估计——以中国冠状病毒数据为例</h2></div><p id="684a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在之前的一篇文章中，我解释了如何使用<a class="ae jg" rel="noopener" target="_blank" href="/modeling-exponential-growth-49a2b6f22e1f">指数增长</a>来模拟冠状病毒爆发的传播。它仅限于爆发的第一阶段，因为指数增长的最大限制是它永远不会停止增长。</p><p id="1a2d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我将介绍这个模型的下一步:逻辑增长模型。如果你想跟着做，你可以在这里得到<a class="ae jg" href="https://jooskorstanje.com/modeling-logistic-growth-corona.html" rel="noopener ugc nofollow" target="_blank">笔记本，在这里</a>得到<a class="ae jg" href="http://jooskorstanje.com/full_data_logistic.csv" rel="noopener ugc nofollow" target="_blank">数据。</a></p><h1 id="00a5" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">为什么是物流增长？</h1><p id="7d7d" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">逻辑增长是一个数学函数，可用于多种情况。逻辑增长的特点是在开始阶段增长增加，但在后期，当你接近最大值时增长减少。例如，在冠状病毒的情况下，这个最大限度将是世界上的总人数，因为当每个人都生病时，增长必然会减少。</p><p id="61d8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在逻辑增长的其他使用情况下，该数字可以是动物种群的大小，该动物种群呈指数增长，直到它们的环境不能为所有动物提供足够的食物，因此增长变得更慢，直到达到环境的最大容量。</p><p id="f7f8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用逻辑增长来模拟冠状病毒爆发的原因是流行病学家已经研究了这些类型的爆发，并且众所周知，流行病的第一阶段遵循指数增长，并且总阶段可以用逻辑增长来模拟。</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/396cab787e9ae12e266e56f8d146b0a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*twOjjVr05yJ5BVo__q32GQ.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">逻辑增长与指数增长</p></figure><h1 id="6c9d" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">逻辑增长公式</h1><p id="e59b" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">逻辑增长的特征在于以下公式:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/fa031a178e0aded5f31487253425b4b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*ktniY6tA5bAZrhRTkyWEBg.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">逻辑增长公式</p></figure><p id="c01e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中:</p><ul class=""><li id="b0b1" class="mx my jj la b lb lc le lf lh mz ll na lp nb lt nc nd ne nf bi translated"><em class="ng"> y(t) </em>是任意给定<em class="ng">时间 t </em>的病例数</li><li id="ca8a" class="mx my jj la b lb nh le ni lh nj ll nk lp nl lt nc nd ne nf bi translated"><em class="ng"> c </em>是极限值，最大容量为<em class="ng"> y </em></li><li id="bb6b" class="mx my jj la b lb nh le ni lh nj ll nk lp nl lt nc nd ne nf bi translated"><em class="ng"> b </em>必须大于 0</li></ul><p id="998e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我还列出了这个公式的另外两个有趣的地方:</p><ul class=""><li id="1942" class="mx my jj la b lb lc le lf lh mz ll na lp nb lt nc nd ne nf bi translated">开始的情况数，也叫<em class="ng">初始值</em>是<em class="ng"> : c / (1 + a) </em></li><li id="47e3" class="mx my jj la b lb nh le ni lh nj ll nk lp nl lt nc nd ne nf bi translated">最大增长率出现在 t = <em class="ng"> ln(a) </em> / b 和 y(t) = <em class="ng"> c / 2 </em></li></ul><h2 id="bad4" class="nm lv jj bd lw nn no dn ma np nq dp me lh nr ns mg ll nt nu mi lp nv nw mk nx bi translated">数学爱好者的逻辑增长公式的深度挖掘</h2><p id="503a" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">对于那些想对公式有更好的数学理解的人:上面的函数实际上是从皮埃尔·弗朗索瓦·维赫斯特发现的下面的微分公式推导出来的。我会一步一步地解释:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/e71f11859371cda465cb7da0abeae251.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*PVts-MOjXo81qlM9k1b_7A.png"/></div></figure><ul class=""><li id="da98" class="mx my jj la b lb lc le lf lh mz ll na lp nb lt nc nd ne nf bi translated">绿色部分 dy / dt 表示这个公式不是针对人口规模的，而是针对人口增长的。</li><li id="7f0a" class="mx my jj la b lb nh le ni lh nj ll nk lp nl lt nc nd ne nf bi translated">我们可以看到 y 和 c 在公式中，所以我们理解人口的增长取决于 y 的值(人口规模)和 c 的值(最大容量)</li><li id="7ac2" class="mx my jj la b lb nh le ni lh nj ll nk lp nl lt nc nd ne nf bi translated">当 y 等于 c 时(即群体处于最大规模)，y / c 将为 1。因此，蓝色部分将为 0，因此增长将为 0。</li><li id="31d4" class="mx my jj la b lb nh le ni lh nj ll nk lp nl lt nc nd ne nf bi translated">当 y 比 c 小很多的时候(人口远离极限)蓝色部分将几乎是 1。因此，增长由橙色部分定义。橙色部分实际上是指数增长的公式。</li></ul><h1 id="79da" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">逻辑增长的一个简单例子</h1><p id="a754" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">为了更清楚地说明这一点，我将举一个假设的例子:</p><ul class=""><li id="fbe7" class="mx my jj la b lb lc le lf lh mz ll na lp nb lt nc nd ne nf bi translated">最大患病人数<em class="ng"> c </em>，为 1000 人</li><li id="27e1" class="mx my jj la b lb nh le ni lh nj ll nk lp nl lt nc nd ne nf bi translated">我们从 1 个感染者的<em class="ng">初始值</em>开始，所以<em class="ng"> c / (1 + a) </em> = 1，给<em class="ng"> 1000 / (1 + a) = 1 </em>，给<em class="ng"> a = 999 </em></li><li id="8d4d" class="mx my jj la b lb nh le ni lh nj ll nk lp nl lt nc nd ne nf bi translated">在感染开始时，每个病人会感染另外两个人，所以增长率<em class="ng">b = 2</em></li><li id="f530" class="mx my jj la b lb nh le ni lh nj ll nk lp nl lt nc nd ne nf bi translated">我们将考察从时间 0 到时间 10 的疫情发展</li></ul><p id="2ccb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们首先需要将 a 和 b 的值代入公式，以获得特定流行病的公式:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/34386b40e1a63cca97831384c2eda533.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*MW-Gcb4l8NyzGGYi6GXpig.png"/></div></figure><p id="45f1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在 Python 中，这看起来如下:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/522c978f989460f436bd66a41991046b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*_MCS89VY7oh5nTZcBs5PNQ.png"/></div></figure><p id="5538" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们可以用这个公式来计算从 0 到 10 的每个 t 值的 y 值。当我们这样做时，我们在每个时间点获得了以下感染人数，如下表所示。这表明，在开始时，感染人数增长很快，但随后就慢了很多，并在最大容量时结束。</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/dd2aa4ffcdaf0e171a1ccd0b4932f269.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*CwZLYVYIQHKGC-2yEZSB8A.png"/></div></figure><p id="5fdd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们想用图表来表示，我们开始看到一个图表，看起来很像我们看到的关于冠状病毒的非常惊人的曲线:</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/15cbc218787413c318e2fa5b1b83c629.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*XXTH9VAm2LQg7a-x2c6PNQ.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">逻辑增长图</p></figure><h1 id="8cbd" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">从冠状病毒数据到逻辑增长公式</h1><p id="83f4" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">现在，我们知道这个图或多或少有正确的形状，但我们需要做一个额外的步骤，使我们的分析有用。我们需要通过查看疫情传播的数据来找到<em class="ng">电晕疫情的真实曲线</em>。</p><p id="3f46" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这种情况下，我将采用中国的数据:由于那里的增长已经大幅下降，逻辑曲线将是一个相当好的匹配。</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi od"><img src="../Images/1661f27bcd603a578a8af74ce88a3365.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JFT1k-QedSLJBCb5eyxnew.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">中国冠状病毒数据摘录。来源:<a class="ae jg" href="https://covid.ourworldindata.org/data/full_data.csv" rel="noopener ugc nofollow" target="_blank">https://covid.ourworldindata.org/data/full_data.csv</a></p></figure><h1 id="9bdc" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">中国物流增长的非线性最小二乘法</h1><p id="54e0" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在查看数据时，我们只有每天的病例数。我们也有想要应用的公式，但是我们还没有公式中参数 a、b 和 c 的正确值。</p><p id="f215" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">不幸的是，不可能像指数模型那样将逻辑函数改写成线性回归。因此，我们需要一个更复杂的方法:非线性最小二乘估计。</p><p id="625a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">第一步</strong> —读入数据</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oe"><img src="../Images/a35e819b8e9330fa4066a91b1db568ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BxF5Z-IqCTtbPeWkvQ6Imw.png"/></div></div></figure><p id="cd09" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">第二步</strong> —定义需要安装的物流功能</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi of"><img src="../Images/5e0bef1a065f43fd24a1f7a0a679176f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*JAQiQn5AdQgdxtguXmzC0Q.png"/></div></figure><p id="3cd7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">第三步</strong> —随机初始化 a、b、c</p><p id="73a9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这种情况下，我使用 np.random.exponential，但是您可以使用您喜欢的任何东西。但是请注意:您在这里的选择可能会影响步骤 5 的性能。</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi og"><img src="../Images/b882a856fbbb2621d54bbbd5c534b5b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*iAF5M6V4mcooc4_5yii0DQ.png"/></div></figure><p id="2953" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">第四步</strong> —设置 a、b 和 c 的上下限</p><p id="95b3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所有参数的下限都是 0。我把 b 的上界设为 3，因为在第一次尝试时我把它释放了，它变得太高了。a 和 c 的上限不会对曲线拟合产生负面影响，所以我让它们的上限相对较高。</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/20f5b6d69f6a5d168fd0321e5b3f3ac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*4sYxivq1Sw8pdau-t3VNjw.png"/></div></figure><p id="d5f7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">步骤 5 </strong> —使用 Scipy 曲线拟合进行非线性最小二乘估计</p><p id="f1f5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这一步中，Scipy 进行非线性最小二乘优化，并给出使模型的最小二乘误差最小化的 a、b 和 c 的值。</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/b286ef36078437446d835ac22e28fb73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*ZrXK1xHm4iOQc28dZ3z4IA.png"/></div></figure><p id="d811" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">第 6 步</strong> —绘制拟合函数与实际数据</p><p id="daa0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如你在下面的图表中看到的，逻辑模型与实际的中国冠状病毒数据相差不远。</p><figure class="ms mt mu mv gt iv gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/7d919a700e267fee0fe9aefb6269ae43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*cijSAvLPNuSFnyfHYsBnLg.png"/></div></figure><p id="57dc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">第 7 步</strong> —结束</p><p id="6acd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们发现了一个逻辑函数，它与从中国观察到的冠状病毒数据非常接近。为了在现实生活中真正使用这些信息，有必要进行大量的模型验证，比较不同模型的准确性和其他性能指标，并密切关注未来趋势是否符合所选模型。</p><p id="a73c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将远远超出本文的范围，本文只是试图说明如何拟合逻辑增长曲线，但是，使用该理论，我们可以陈述一些观察结果:</p><ul class=""><li id="6f46" class="mx my jj la b lb lc le lf lh mz ll na lp nb lt nc nd ne nf bi translated">根据这个模型，c 是 81802，这将意味着中国感染人数的最大限度将是 81802。</li></ul><p id="f203" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还可以根据这个模型计算最大增长率出现的时间:</p><ul class=""><li id="e7e2" class="mx my jj la b lb lc le lf lh mz ll na lp nb lt nc nd ne nf bi translated">时间上的瞬间是:t =<em class="ng">ln(a)</em>/b = ln(61.5)/0.1929 =第 21 天</li><li id="6edf" class="mx my jj la b lb nh le ni lh nj ll nk lp nl lt nc nd ne nf bi translated">而那个时刻的感染人数是 y = <em class="ng"> c / 2 = 40500 </em></li></ul><p id="e812" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有了一个完全有效的模型，这种类型的信息可以被决策者用来估计如何采取正确的措施。</p><p id="96f6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我希望你已经清楚如何适应一个逻辑模型，以及如何在不同的用例中使用它。<em class="ng">感谢您的阅读，敬请期待更多文章！</em></p><p id="4dd6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> <em class="ng">编者按:</em> </strong> <em class="ng"> </em> <a class="ae jg" href="http://towardsdatascience.com/" rel="noopener" target="_blank"> <em class="ng">走向数据科学</em> </a> <em class="ng">是一份以数据科学和机器学习研究为主的中型刊物。我们不是健康专家或流行病学家，本文的观点不应被解释为专业建议。想了解更多关于疫情冠状病毒的信息，可以点击</em> <a class="ae jg" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports" rel="noopener ugc nofollow" target="_blank"> <em class="ng">这里</em> </a> <em class="ng">。</em></p></div></div>    
</body>
</html>