<html>
<head>
<title>Deep Learning with TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 TensorFlow 进行深度学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-learning-with-tensorflow-5d3a7a8c55cd?source=collection_archive---------65-----------------------#2020-05-26">https://towardsdatascience.com/deep-learning-with-tensorflow-5d3a7a8c55cd?source=collection_archive---------65-----------------------#2020-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/6aca7c59bbf5e65e86dbd44570941667.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*nQExqmfbxI8b7DT2INh2hw.png"/></div></figure><p id="0b02" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">深度学习</strong></p><p id="65e0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">深度学习是机器学习的子集，机器学习是人工智能的子集。人工智能是一种使机器能够模仿人类行为的技术。深度学习是一种机器学习，受人脑结构的启发。这种结构被称为人工神经网络。</p><p id="c1d3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">深度学习 vs 机器学习</strong></p><p id="074c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">机器学习使用算法来解析数据，从数据中学习，并根据所学内容做出决策。深度学习将算法结构化为多层，以创建一个“人工神经网络”，它可以自己学习并做出智能决策。虽然两者都属于人工智能的大范畴，但深度学习是最像人类的人工智能的动力。</p><p id="4a6d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">什么是神经网络？</strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ks"><img src="../Images/8e5cfe4f6e9c37df20a6db5be5225f63.png" data-original-src="https://miro.medium.com/v2/resize:fit:356/format:webp/0*KoH_aVYnBd-2wRAT.png"/></div></div></figure><p id="520b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">神经网络是人脑的简化。它是由神经元层构成的。这些神经元是网络的核心处理单元。一个神经网络由三种类型的层组成:输入层、输出层和隐藏层。首先，我们有接收输入的输入层和预测最终输出的输出层。在中间，我们有隐藏层，它执行我们的网络所需的大部分计算。此外，值得一提的是，神经网络被设计用来识别数据中的模式。</p><p id="e539" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">问题</strong></p><p id="7b44" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们尝试解决上一篇帖子的问题—<a class="ae lb" rel="noopener" target="_blank" href="/big-data-analyses-with-machine-learning-and-pyspark-135119ef6b31">https://towards data science . com/big-data-analyses-with-machine-learning-and-py spark-135119 ef6b 31</a>。在这个特殊的案例中，我们需要在一个金融机构中进行多种统计计算。一个例子是根据独立变量的数量来确定客户是否有存款。这次我们将尝试使用 TensorFlow 来训练模型。</p><p id="8f16" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">数据预处理</strong></p><p id="7588" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">数据预处理是机器学习中至关重要的一步，对模型的准确性至关重要。这种技术允许我们将原始数据转换成干净可用的数据集。使用这一步，我们将通过重新缩放、标准化、二进制化等使数据更有意义。我们正在使用的数据集是经过预处理的(关于这一点的更多信息，请参见上一篇文章<a class="ae lb" rel="noopener" target="_blank" href="/data-preprocessing-for-machine-learning-in-python-2d465f83f18c">https://towardsdatascience . com/data-preprocessing-for-machine-learning-in-python-2d 465 f 83 f 18 c</a>)。</p><p id="1624" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这种情况下，我们应该对数据集做的唯一事情就是将它分成训练集、验证集和测试集。</p><ul class=""><li id="1111" class="lc ld iq jw b jx jy kb kc kf le kj lf kn lg kr lh li lj lk bi translated"><strong class="jw ir">训练数据集</strong>:用于拟合模型的数据样本。</li><li id="6963" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated"><strong class="jw ir">验证数据集</strong>:数据样本，用于在调整模型超参数时，对训练数据集上的模型拟合提供无偏评估。</li><li id="1e1b" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated"><strong class="jw ir">测试数据集</strong>:用于提供最终模型在训练数据集上的无偏评估的数据样本。</li></ul><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lq"><img src="../Images/e830d966853aaa4f266e7d77143bdc14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gBAsumBV4TacibT8.png"/></div></div></figure><p id="87d1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，我们将把数据保存在。npz 文件格式。NPZ 是 numpy 开发的一种文件格式，使用 gzip 压缩提供数组数据的存储。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lr"><img src="../Images/913a539f73653d03bd347910b66c49e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jlJut-FVn6uvs3Iu.png"/></div></div></figure><p id="939f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">张量流</strong></p><p id="e508" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">深度学习的主要软件工具是 TensorFlow。它是一个开源的人工智能库，使用数据流图来建立模型。张量流主要用于:分类、感知、理解、发现、预测、创造。TensorFlow 的五个主要用例是:</p><ul class=""><li id="3eb0" class="lc ld iq jw b jx jy kb kc kf le kj lf kn lg kr lh li lj lk bi translated">语音/声音识别</li><li id="ac1b" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated">基于文本的应用</li><li id="b512" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated">图像识别</li><li id="fe0e" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated">时间序列</li><li id="b0f5" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated">视频检波</li></ul><p id="5c18" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">导入库</strong></p><p id="148e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们需要导入将要使用的库。在我们的例子中，我们需要:</p><ul class=""><li id="5232" class="lc ld iq jw b jx jy kb kc kf le kj lf kn lg kr lh li lj lk bi translated"><strong class="jw ir">Numpy</strong>—Python 编程语言的库，增加了对大型多维数组和矩阵的支持，以及对这些数组进行操作的大量高级数学函数</li><li id="4951" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated"><strong class="jw ir"> TensorFlow </strong> —一个免费的开源软件库，用于数据流和跨一系列任务的差异化编程。</li></ul><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/9281e5f0cc3a35830a81861f7de71755.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/0*q8WinpaJIjyGotBb.png"/></div></figure><p id="1f28" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">加载数据</strong></p><p id="2518" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，我们需要从之前保存的文件中加载数据。这可以通过使用 numpy 的 load 方法来完成。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lt"><img src="../Images/659f87a5b0b001879516506bef5e8dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NAGL8Ut2OC_-nLfV.png"/></div></div></figure><p id="8650" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">定义模型</strong></p><p id="10b9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们需要定义输出大小—在我们的例子中，我们期望两个输出(1 —是和 0 —否)，所以大小将是 2。</p><p id="8bba" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，我们需要定义隐藏层的大小。隐藏层的大小应介于输入层和输出层的大小之间。在这种情况下，隐藏层大小将为 30。</p><p id="0463" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">唯一剩下的事情就是定义模型。本例中的模型是使用 keras 定义的。顺序模型是层的线性堆叠。当我们定义模型时，我们需要为隐藏层和输出层选择激活函数。</p><p id="4085" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">激活功能</strong></p><p id="4d78" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">激活函数是神经网络的组成部分之一。如果我们有一个没有激活函数的神经网络，每个神经元将只使用权重和偏差对输入执行线性变换。这样定义的话，神经网络的功能将会减弱，它将无法从数据中学习复杂的模式。因此，激活函数用于将非线性变换添加到输入中。在下图中，我们可以看到可以使用的常用激活功能。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lu"><img src="../Images/d9f9edf8d7d4aa7433fefed600caedba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OJFPCg7o9u-J1Irf.png"/></div></div></figure><p id="6d31" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这种情况下，我们对隐藏层使用 ReLU(校正线性单位),对输出层使用 Softmax。</p><ul class=""><li id="1e16" class="lc ld iq jw b jx jy kb kc kf le kj lf kn lg kr lh li lj lk bi translated">ReLU 是神经网络中最常用的激活函数，尤其是在 CNN 中。如果您不确定在您的网络中使用什么激活功能，ReLU 通常是一个不错的首选。</li><li id="356b" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated">Softmax 是指数型的，会扩大差异—将一个结果推至接近 1，而将另一个结果推至接近 0。它将分数即逻辑转换成概率。</li></ul><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lv"><img src="../Images/5ec271dda3b742373438ff61880d978c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WoOo82ckF3QiRk-i.png"/></div></div></figure><p id="c246" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">编译模型</strong></p><p id="5f8a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这一步中，我们将为培训配置模型。Compile 定义了损失函数、优化器和指标。我们需要一个编译好的模型来训练(因为训练使用了损失函数和优化器)。</p><ul class=""><li id="010b" class="lc ld iq jw b jx jy kb kc kf le kj lf kn lg kr lh li lj lk bi translated"><strong class="jw ir">优化器</strong>:优化算法或策略负责减少损失，并尽可能提供最准确的结果。在这个例子中，我们使用了一种叫做 Adam 的优化算法。<strong class="jw ir"> Adam </strong>是一种优化算法，可用于替代经典的随机梯度下降过程，根据训练数据迭代更新网络权重。</li><li id="729c" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated"><strong class="jw ir"> Loss </strong>:这是一种评估特定算法对给定数据建模程度的方法。如果预测与实际结果相差太多，损失函数就会产生一个非常大的数字。分类交叉熵和稀疏分类交叉熵具有相同的损失函数，唯一的区别是，当输入是一次热编码时，我们使用分类交叉熵，当输入是整数时，我们使用稀疏分类交叉熵。</li><li id="e0a2" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated"><strong class="jw ir">指标</strong>:指标是用来判断模型性能的函数。</li></ul><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lw"><img src="../Images/b9bcbb03e281e7ce9f65108543f411c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YkYV9Nj45KitqXJ0.png"/></div></div></figure><p id="78f5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">拟合模型</strong></p><p id="ef59" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当我们拟合模型时，我们实际上是在为固定数量的历元(数据集上的迭代)训练模型。我们需要定义批量大小、最大时期和提前停止。</p><ul class=""><li id="9047" class="lc ld iq jw b jx jy kb kc kf le kj lf kn lg kr lh li lj lk bi translated"><strong class="jw ir">批量</strong> —一次正反向通过的训练样本数。</li><li id="b0bf" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated"><strong class="jw ir">最大时期</strong> —训练模型的时期数。一个历元是对所提供的整个 x 和 y 数据的迭代。</li><li id="3fb4" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated"><strong class="jw ir">提前停止</strong> —当监控的数量停止提高时，停止训练。耐心是一个数字，它定义了产生无改善的监控量的时期数，在此之后训练将停止。</li></ul><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lx"><img src="../Images/32a3965fb47992f7522c3dce23a31cca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0Y2HOCc4aSGXFmVf.png"/></div></div></figure><p id="ce24" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">结果</strong></p><p id="cb04" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在下图中，我们可以看到训练的结果。如果我们将准确性(~86%)与之前博客帖子中的准确性(~82%)进行比较，我们可以看到，在这种情况下，它更大。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ly"><img src="../Images/6e1ee6e031eb3f9ddf13572e4e442db4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*C_rW903n-fru5Ffx.png"/></div></div></figure><p id="51e8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">评估模型</strong></p><p id="8525" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">返回测试模式下模型的损耗值和度量值。在这个函数中，输入数据将是我们的测试集。该函数将返回标量测试损失(如果模型只有一个输出，没有指标)或标量列表(如果模型有多个输出和/或指标)。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lz"><img src="../Images/aec67337c965eb19154a5a9174bf87f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iEKm4MBkpEMg8XFh.png"/></div></div></figure><p id="a0c7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">结论</strong></p><p id="4d6a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这就是深度学习的基本思想。有许多类型的深度学习、不同种类的神经网络、各种架构和训练算法。神经网络背后的想法已经存在了很长时间，但今天它有了很大的进展。深度学习的未来特别光明！未来深度学习的可能性是无限的，从无人驾驶汽车到探索宇宙的机器人。</p><p id="88db" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果你对这个话题感兴趣，请随时联系我。</p><p id="2b50" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">领英简介:【https://www.linkedin.com/in/ceftimoska/ T2】</p><p id="3335" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">博客原文可从以下链接获得:【https://interworks.com.mk/deep-learning-with-tensorflow/ T4】</p><p id="5942" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">另外，你可以在下面的链接中找到另一篇类似的博文:<a class="ae lb" href="https://interworks.com.mk/focusareas/data-management/" rel="noopener ugc nofollow" target="_blank">https://interworks.com.mk/focusareas/data-management/</a></p></div></div>    
</body>
</html>