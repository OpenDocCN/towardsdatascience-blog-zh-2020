<html>
<head>
<title>Demand Forecasting: Boston Crime Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">需求预测:波士顿犯罪数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/demand-forecast-boston-crime-data-64a0cff54820?source=collection_archive---------22-----------------------#2020-03-08">https://towardsdatascience.com/demand-forecast-boston-crime-data-64a0cff54820?source=collection_archive---------22-----------------------#2020-03-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/51c3d70329114a2fee5208a2b28f2cc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ef3v0t2QG_4tN9kV-gMObg.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://www.istockphoto.com/tr/en/portfolio/dedmityay" rel="noopener ugc nofollow" target="_blank">上的照片是stockphoto </a></p></figure><div class=""/><p id="88d5" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">能够预测某一天某一特定地点发生暴力犯罪可能性的模型。</em></p><p id="9b6c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">需求预测</strong>是零售、供应链管理和物流领域的热门话题和永无止境的目标。决策者需要根据预测的需求优化他们的资源，因此它也与优化问题直接相关。</p><p id="6b35" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">预测</strong>在其通常的机器学习用途中处理一维的时间序列数据。<a class="ae jg" rel="noopener" target="_blank" href="/time-series-analysis-in-python-an-introduction-70d5a5b1d52a">预测股票价格</a>或跨年度购买数量是最常见的用例。像<a class="ae jg" href="https://en.wikipedia.org/wiki/Autoregressive_integrated_moving_average" rel="noopener ugc nofollow" target="_blank"> ARIMA </a>这样的加性模型是这个领域中最古老的数学模型之一:</p><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lf"><img src="../Images/eb1e41deb16d6817db4618541a4ce9de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WCvJUW8imjAIUDiwG0iPow.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">预测明确的趋势。看起来很简单，是吧？</p></figure><p id="e1ad" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用这些众所周知的数据——几年来航空乘客的数量——来理解预测的基础当然是有帮助的。但即使乍一看，也不难猜到现实生活中的问题很少如此简单。</p><p id="a084" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">波士顿犯罪数据简介</strong></p><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lk"><img src="../Images/cb8b98a67c5bb7d76da747448d1ff3fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1DLluIaVj2S78FTA"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">马特·波波维奇在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="af12" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae jg" href="https://data.boston.gov/" rel="noopener ugc nofollow" target="_blank">分析波士顿</a>波士顿的开放数据中心发布各种城市数据。其<a class="ae jg" href="https://data.boston.gov/dataset/crime-incident-reports-august-2015-to-date-source-new-system" rel="noopener ugc nofollow" target="_blank">犯罪事件报道</a>就是其中之一。该市的表格数据列出了2015年以来的犯罪事件。我们可以在这里看到他们数据集中的主要特征(总共有16列):</p><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ll"><img src="../Images/990e21e02bf21bc148b434d83e120be6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_IPrGUyAYKKBeh-c4KwMHQ.png"/></div></div></figure><ul class=""><li id="6011" class="lm ln jj ki b kj kk kn ko kr lo kv lp kz lq ld lr ls lt lu bi translated">事件编号:事件的唯一标识符</li><li id="c452" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">犯罪代码组:事件按犯罪类型分组</li><li id="1b26" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">报告区域:报告区域的代码。</li><li id="ec32" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">发生日期:事件发生的日期</li><li id="8abd" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">Lat:犯罪地点的纬度</li><li id="7ff7" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">Long:犯罪地点的经度</li></ul><p id="e04b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">他们的最新数据超过40万行。他们还将自己的<a class="ae jg" href="https://www.kaggle.com/AnalyzeBoston/crimes-in-boston" rel="noopener ugc nofollow" target="_blank">数据集上传到Kaggle </a>来介绍它并挑战数据科学界。</p><p id="d0f6" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对犯罪类型及其趋势的分析肯定有助于我们了解这个城市的犯罪动态。但是如果我们能比这更进一步呢？</p><h1 id="c32c" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">目标</h1><p id="d38e" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">历史数据集具有城市中不同类型犯罪的时间和空间维度。</p><p id="6860" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，最令人兴奋的项目是在犯罪真正发生之前为社区预测犯罪。</p><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nd"><img src="../Images/147788efde5ef6673f2f3f0c0279f07f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hkFFKY6iWMzGmTRn7uXTgw.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd ne">不，不是那个方向！</strong> —图片由<a class="ae jg" href="https://pixabay.com/users/GerDukes-4387545/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=2114403" rel="noopener ugc nofollow" target="_blank">杰拉尔丁·杜克斯</a>提供，来自<a class="ae jg" href="https://pixabay.com/?utm_source=link-attribution&amp;amp;utm_medium=referral&amp;amp;utm_campaign=image&amp;amp;utm_content=2114403" rel="noopener ugc nofollow" target="_blank">皮克斯贝</a></p></figure><p id="4287" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们需要一个框架来组织问题。仅仅预测一个街区或者大体上整个城市的犯罪数量，并没有说太多，也没有用。我们需要预测某个特定地区是否会发生罕见的犯罪。</p><p id="21be" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外……这类问题不常被研究，而波士顿的犯罪数据给了我们一个机会去调查一个具有挑战性的问题。为什么？更多信息请见挑战部分。</p><h1 id="36bf" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">问题框架</h1><p id="c301" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">这里<strong class="ki jk">我将遵循另一篇</strong> <a class="ae jg" href="https://www.academia.edu/25277353/Crime_Prediction_Using_Data_Analytics_the_Case_of_the_City_of_Boston" rel="noopener ugc nofollow" target="_blank"> <strong class="ki jk"> </strong> </a> <strong class="ki jk">论文中分享的方法，“使用数据分析的</strong> <a class="ae jg" href="https://www.academia.edu/25277353/Crime_Prediction_Using_Data_Analytics_the_Case_of_the_City_of_Boston" rel="noopener ugc nofollow" target="_blank">犯罪预测:波士顿市的案例”。</a><strong class="ki jk"/>它包含了解决的核心。我将使用Python实现它，并对特性(较少的空间工程)和模型(Xgboost以提高准确性)进行一些修改。我还会分享代码，这样每个人都可以跟着做，并尝试改进预测。我们可以总结如下:</p><ul class=""><li id="b14d" class="lm ln jj ki b kj kk kn ko kr lo kv lp kz lq ld lr ls lt lu bi translated"><strong class="ki jk">我们需要预测一些罕见事件(在本例中为暴力犯罪)在特定日期以空间特征发生的概率</strong>。这样，警察可以利用这一点每天集中在城市的特定地区，以防止暴力犯罪，或至少增加在那里巡逻的机会。</li></ul><p id="5bda" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个框架如何塑造数据解决方案？无需过多思考，我们可以说我们将:</p><ul class=""><li id="a1fa" class="lm ln jj ki b kj kk kn ko kr lo kv lp kz lq ld lr ls lt lu bi translated">A <strong class="ki jk">汇总每天每个地区/报告区域的历史犯罪数据。</strong></li><li id="869b" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">标记这些地点和日期的组合，以便<strong class="ki jk">当天是否发生暴力犯罪</strong>。</li><li id="ab21" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated"><strong class="ki jk">用概率</strong>预测二进制值。这是一个分类问题。可以使用基于逻辑回归或决策树的模型。</li></ul><p id="4471" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于<strong class="ki jk">我们的数据集将非常不平衡，</strong>对机器学习模型和决策阈值进行一些调整将是必要的。请记住，我们预测的是罕见事件。</p><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nf"><img src="../Images/4520e64a045d54f776acc9e8b3a4709d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eNce4E8mJk-9eMwD"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://unsplash.com/@krisroller?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">克里斯托夫辊</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><h1 id="fa58" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">挑战—为什么不使用时间序列预测？</h1><p id="bbec" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">请注意，我们已经将预测问题转化为传统的机器学习分类。这是为什么呢？</p><p id="a982" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们需要预测多个值，就会出现困难，因为设置和分析ARIMA类型的模型并不容易。</p><p id="5255" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么我们需要为此建立多个模型吗？如果我们需要为数百个时间序列数据建立模型，会发生什么？这可行吗？</p><p id="1017" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们列出当<strong class="ki jk">需求分布在城市中且没有明确边界的情况下，在很长一段时间内</strong>如一年，预测需求所面临的挑战。</p><p id="e09d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">考虑<a class="ae jg" href="https://blog.goodaudience.com/taxi-demand-prediction-new-york-city-5e7b12305475" rel="noopener ugc nofollow" target="_blank">出租车需求预测</a>可能是一个很好的起点，因为我们将遵循类似的逻辑。在这种情况下，我们有在特定日期从特定位置开始的出租车出行数据。预测需求的挑战如下:</p><ul class=""><li id="43e0" class="lm ln jj ki b kj kk kn ko kr lo kv lp kz lq ld lr ls lt lu bi translated"><strong class="ki jk">需求是空间分布的，是连续的</strong>。它没有中心。想想城市里的几个市场，它们都有固定的位置。您可以建立预测模型来预测它们中每一个的总销售额，但这里的情况并非如此。</li><li id="4dcf" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">即使您对需求进行聚类，也可能有太多的聚类中心来为每个聚类中心建立预测模型。</li><li id="133b" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">您知道某些特征(如天气或时间——如假期)会严重影响需求。但是在传统的时间序列建模中，不可能添加这些特征。深度学习(<a class="ae jg" href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" rel="noopener ugc nofollow" target="_blank"> LSTM模型</a>举例)允许这样做。</li></ul><p id="1a2e" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，对于犯罪预测来说，还有一个额外的挑战。我们需要预测像暴力犯罪这样罕见的事件:</p><ul class=""><li id="c1ff" class="lm ln jj ki b kj kk kn ko kr lo kv lp kz lq ld lr ls lt lu bi translated">请记住，传统的时间序列预测处理的是数字数据。这里我们需要预测一个二进制值:0或1。</li></ul><p id="8530" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">方法</strong></p><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ng"><img src="../Images/21ad1c87c0714d98e739e74d9068648d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_kF-QbG4Hu5t248n"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd ne">开始建造吧！谁需要方法？</strong>—<a class="ae jg" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="e7d1" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让我们列出创建预测模型要做的事情:</p><ul class=""><li id="901d" class="lm ln jj ki b kj kk kn ko kr lo kv lp kz lq ld lr ls lt lu bi translated">划分空间以聚集每个空间单元(格网或报告区域)的需求</li><li id="47fd" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">将犯罪类型分为暴力犯罪和非暴力犯罪。</li><li id="6348" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">每天汇总每个空间单元的历史犯罪数据。该行的标签将是1或0，这取决于那天在该位置是否发生了暴力犯罪。</li><li id="a383" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">将历史天气数据集成为波士顿每天的一项功能。</li><li id="33d5" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">将数据分为训练集和测试集。使用一个特定的日期，在该日期之前，训练数据约为70%，在该日期之后，测试数据为所有数据集的30%。</li><li id="444f" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">建立一个侧重于预测阳性标签的模型:增加真阳性率，即<a class="ae jg" href="https://en.wikipedia.org/wiki/Sensitivity_and_specificity" rel="noopener ugc nofollow" target="_blank">灵敏度</a>。(稍后将详细介绍)</li><li id="c097" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">通过选择阈值来评估测试集的准确性和敏感性。</li></ul><h1 id="547e" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">1-群需求</h1><p id="80fb" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">从这一点开始，你可以遵循github repo 中的代码<a class="ae jg" href="https://github.com/alptuzel/bostoncrimeprediction" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="dce0" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在对数据进行了一些探索之后，我们可以从“来自报告区域的集群中心”一节开始。通过取纬度和经度的平均值来计算报告区域中心:</p><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nh"><img src="../Images/139b5511ad59898a5d0070a8c53e6a17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lIqc4PJS6Rb_zOOHn5EiaQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">用于可视化空间数据的KeplerGL包</p></figure><p id="353c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">显然，有一些异常值。通过使用此处的<a class="ae jg" href="https://catalog.data.gov/dataset/500-cities-city-boundaries-acd62" rel="noopener ugc nofollow" target="_blank">城市边界文件</a>，我们绘制并提取波士顿多边形外的报告区域:</p><pre class="lg lh li lj gt ni nj nk nl aw nm bi"><span id="61c5" class="nn mb jj nj b gy no np l nq nr"># load shape file for 500 cities<br/>city_data = gpd.read_file("geodata/CityBoundaries.shp")</span><span id="47e6" class="nn mb jj nj b gy ns np l nq nr"># some spatial processing here...</span><span id="ff4b" class="nn mb jj nj b gy ns np l nq nr"># select the reporting areas (points in geodf_ra) that are <br/># in geodf_boston polygon. using spatial join function<br/># in geopandas package <br/><br/>geodf_ra_inboston=gpd.sjoin(geodf_ra, geodf_boston, how="inner", op='within')</span></pre><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nt"><img src="../Images/07eba177771be33b1d6be0f418900d18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wE08kA8YfuAIwTcQM90nCw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">现在它们都在波士顿多边形内</p></figure><p id="91d9" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在论文中，使用了500个网格。因此，按照同样的逻辑，我们可以创建500个集群，使需求中心更少，需求面分布更均匀。</p><pre class="lg lh li lj gt ni nj nk nl aw nm bi"><span id="4cde" class="nn mb jj nj b gy no np l nq nr"># create 500 centers with K-means<br/>clusterer = KMeans(n_clusters=500,random_state=101).fit(reporting_area_centers[["Long","Lat"]])<br/># get predictions from our Kmeans model<br/>preds_1 = clusterer.predict(reporting_area_centers[["Long","Lat"]])<br/># set our new column: cluster_no<br/>reporting_area_centers["cluster_no"]=preds_1</span></pre><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nu"><img src="../Images/81a6795365b72345acf6f029b9cea2c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3FhV6LzanEsooVJe6hAO9Q.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">报告区域的500个集群中心。</p></figure><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nv"><img src="../Images/96d8d6e5274d8d2cbec2bbbc0448deef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GwGU0egieNr9iBE43hjxAA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">报告区域聚集成500个中心。</p></figure><h1 id="c3c3" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">2-集团犯罪类型</h1><p id="6665" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">现在我们需要对犯罪类别进行分组(OFFENSE _ CODE _ GROUP ),以便将其中一些归类为暴力犯罪。我根据我的假设添加了这些类别，其中哪些是暴力犯罪，但是当然你可以交叉引用法律定义..</p><pre class="lg lh li lj gt ni nj nk nl aw nm bi"><span id="587e" class="nn mb jj nj b gy no np l nq nr"># check labeled crime groups: violent, property and other<br/># the crimes are grouped manually into 3 groups: violent, property or other<br/>data_1718_ocg=pd.read_csv("./data/data_1718_ocg_grouped.csv")</span></pre><p id="a2b6" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">被称为暴力犯罪的有:</p><figure class="lg lh li lj gt iv gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/51229cb54967bb09959f734a4cbf2abe.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*pKPyp6C82SJzyBEslSE6IA.png"/></div></figure><h1 id="b6c3" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">3-汇总历史犯罪数据</h1><p id="c268" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">至此，在笔记本文件中，我们已经到达了“为ML准备数据:为每个集群和日期组合聚集数据”部分。</p><p id="cf61" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们有标有经纬度的聚类中心。<strong class="ki jk">现在我们需要预测功能</strong>！</p><p id="b803" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">这是脚本</strong>的核心部分:每天计算所有聚类中心过去的犯罪统计数据。过去120天、30天、7天、1天都是这样做的。</p><p id="1573" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了准备剧本，我先做了一天的计算。然后我写了一个全天的“for循环”。</p><pre class="lg lh li lj gt ni nj nk nl aw nm bi"><span id="9e4e" class="nn mb jj nj b gy no np l nq nr"># check one of the lists:<br/># here we calculated sums for different crimes for the date: 2017-10-3<br/># they are aggregated for each clusters.<br/># in this table we see the results for the past 120 days<br/>working_120_results.head()</span></pre><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/ce701ce1cf0c3d28ff213af5fa23eeae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*We8ZuYiu1GgdZdZFWIrZ5g.png"/></div></div></figure><p id="5ef2" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，我们可以看到仅一天内不同地区不同犯罪类型的总和。它是通过计算该地区前120天的相关犯罪类型来计算的。</p><p id="073e" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在检查了结果的合理性之后，我们可以继续进行更大的计算:“计算过去365天和最后一天每天的统计数据。”<strong class="ki jk">现在我们运行一个循环来聚合每个集群和日期组合的历史犯罪数据</strong>。</p><pre class="lg lh li lj gt ni nj nk nl aw nm bi"><span id="dfa6" class="nn mb jj nj b gy no np l nq nr"># check resulting dataframe. This is going to be our baseline for train&amp;test data<br/>crime_stats_fordays_df.info()</span></pre><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ny"><img src="../Images/07a0a7271a69041d3d2bd4f30c3fb305.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*v4Krq2BbeLfjj0UGJzKLSg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">所有历史预测特征被聚集</p></figure><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nz"><img src="../Images/5be23c8ebead199c86e276c1c1568f2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MGNuVPdnPgptrK1ATqbKQA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">查看生成的数据框</p></figure><h1 id="c68b" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">4-整合天气数据</h1><p id="c35b" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">同样，根据这篇论文，我们希望将天气数据集成到我们的训练集中，作为一个预测功能。我们认为天气状况可能会影响暴力犯罪。</p><p id="44b7" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">出于这个原因，我们可以使用Python包<a class="ae jg" href="https://github.com/ekapope/WorldWeatherOnline" rel="noopener ugc nofollow" target="_blank"> wwo-hist </a>，它封装了来自世界天气在线的<a class="ae jg" href="https://www.worldweatheronline.com/developer/api/" rel="noopener ugc nofollow" target="_blank">天气API。我已经创建了一个免费试用帐户来收集所需的API密钥。你可以尝试其他选择，但这似乎是最快的解决方案。</a></p><pre class="lg lh li lj gt ni nj nk nl aw nm bi"><span id="1ed8" class="nn mb jj nj b gy no np l nq nr"># use package: <a class="ae jg" href="https://github.com/ekapope/WorldWeatherOnline" rel="noopener ugc nofollow" target="_blank">https://github.com/ekapope/WorldWeatherOnline</a></span><span id="c7c2" class="nn mb jj nj b gy ns np l nq nr">from wwo_hist import retrieve_hist_data</span><span id="eb0e" class="nn mb jj nj b gy ns np l nq nr"># daily frequency.<br/>frequency=24<br/>start_date = '1-JAN-2015'<br/>end_date = '31-DEC-2018'<br/>api_key = 'your-api-key-comes-here'<br/>location_list = ['boston,ma']</span><span id="c225" class="nn mb jj nj b gy ns np l nq nr"># this one runs for all days from start_date to end_date<br/># and saves the results as csv to the current directory.<br/><br/>hist_weather_data = retrieve_hist_data(api_key,<br/>                                location_list,<br/>                                start_date,<br/>                                end_date,<br/>                                frequency,<br/>                                location_label = False,<br/>                                export_csv = True,<br/>                                store_df = True)</span><span id="e769" class="nn mb jj nj b gy ns np l nq nr">## some processing</span><span id="0043" class="nn mb jj nj b gy ns np l nq nr"># include weather data to our aggregated data for: rain, cloud cover and minimum temperature. <br/># you can include more features here</span><span id="b288" class="nn mb jj nj b gy ns np l nq nr">crime_stats_fordays_df=pd.merge(crime_stats_fordays_df,weather_data[["date_time","precipMM","cloudcover","mintempC"]],left_on="theday",right_on="date_time")</span></pre><p id="bf79" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用云量、最低温度和降水量作为预测特征。</p><h1 id="c8fb" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">5-建模</h1><p id="3d4b" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">首先，我们将数据分为训练集和测试集。因为这是时间序列预测，所以我们选择一个截止日期，使之前的数据对应于70%的数据。</p><p id="411a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我们决定功能列:</p><pre class="lg lh li lj gt ni nj nk nl aw nm bi"><span id="ab17" class="nn mb jj nj b gy no np l nq nr"><br/># feature set<br/>x_columns=[ 'Lat', 'Long', <br/>        'sumviolentcrime120', 'sumpropertycrime120',      'sumothercrime120', <br/>        'sumviolentcrime30','sumpropertycrime30', 'sumothercrime30', <br/>        'sumviolentcrime7','sumpropertycrime7', 'sumothercrime7', <br/>        'sumviolentcrime1','sumpropertycrime1', 'sumothercrime1', <br/>        'precipMM','cloudcover', 'mintempC']</span><span id="a1ca" class="nn mb jj nj b gy ns np l nq nr"># outcome<br/>y_column=["isviolentcrime"]</span></pre><p id="1100" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，与我们一直关注的论文不同，我们在这里使用经度和纬度来标识位置。这是因为如果您使用每个网格的收入数据，您将失去空间编码的“位置敏感”特性。简单来说，我们需要这样的空间特征，如果它们在二维空间中彼此接近，那么它们的编码就彼此接近。如果我们仅仅使用“收入数据”,我们就失去了这个特征，因为遥远的邻居可能有相同的平均收入。</p><p id="e1c9" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一选择的另一个结果是<strong class="ki jk">我们需要使用基于树的模型，因为纬度和经度在物流回归等线性模型中不携带信息</strong>。</p><p id="2f48" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我继续为模型使用“<a class="ae jg" href="https://xgboost.readthedocs.io/en/latest/python/python_api.html#xgboost.XGBClassifier" rel="noopener ugc nofollow" target="_blank"> Xgboost分类器</a>”。正如我们在开始时说的，这是一个分类问题。<strong class="ki jk">我们已经为每个聚类中心和每一天创建了聚合的历史特征。现在我们将根据这些历史特征和天气数据来预测那天是否发生了暴力犯罪。</strong></p><p id="59a9" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我跳过了模型的调优，以免过多地扩展文章，但是可以在Jupyter笔记本的“调优参数”一节中查看。</p><pre class="lg lh li lj gt ni nj nk nl aw nm bi"><span id="210a" class="nn mb jj nj b gy no np l nq nr"># tuned parameters: in the next session we run hyperparameter search with cross validation<br/># these parameters are gathered from that tuning session.<br/># so you can just continue with the tuned parameters<br/># you can switch back and forth between the baseline model and the tuned model to see the<br/># change in accuracy and other parameters</span><span id="f7bd" class="nn mb jj nj b gy ns np l nq nr">xgb_model=xgb.XGBClassifier(base_score=0.5, booster='gbtree', colsample_bylevel=1,<br/>       colsample_bynode=1, learning_rate=0.1,<br/>       max_delta_step=0, missing=None,<br/>       n_estimators=100, n_jobs=1,   <br/>       nthread=None,scale_pos_weight=83,<br/>       objective='binary:logistic', random_state=101,<br/>       subsample= 0.6,<br/>       min_child_weight= 10,<br/>       max_depth= 3,<br/>       gamma= 1,<br/>       colsample_bytree= 0.8)</span></pre><h1 id="c350" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">6阈值选择</h1><p id="5f8d" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">现在我们有了将“isviolentcrime”目标标记为1或0的概率。但是，我们应该如何选择决策阈值来将行(区域和日期组合)标记为1或0呢？</p><p id="c585" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从论文中得出的假设如下:<strong class="ki jk">让我们假设警察每天可以巡逻城市的30%</strong>。这最终确定了我们问题的框架。我们需要这样一个模型，它能在30%的时间里预测阳性标签。因此，警方每天将有30%的区域被标记为阳性。</p><pre class="lg lh li lj gt ni nj nk nl aw nm bi"><span id="734c" class="nn mb jj nj b gy no np l nq nr"># 30 percent of the labels: 38250.0<br/>X_train.shape[0]* 0.3</span><span id="7286" class="nn mb jj nj b gy ns np l nq nr"># tune threshold so that 30 percent of all the labels are predicted as positive<br/># we found we can use 0.48 as our threshold</span><span id="1025" class="nn mb jj nj b gy ns np l nq nr"># (38819,)<br/>y_pred_prob_pos[y_pred_prob_pos&gt;0.48].shape</span><span id="2809" class="nn mb jj nj b gy ns np l nq nr"># it is 1 if greater than 0.48<br/>xgb_predictions=np.where(y_pred_prob_pos&gt;0.48,1,0)</span></pre><h1 id="3ef6" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">7-评估</h1><p id="041a" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">让我们检查一下培训数据的指标:</p><pre class="lg lh li lj gt ni nj nk nl aw nm bi"><span id="4458" class="nn mb jj nj b gy no np l nq nr"># my accuracy score: 0.7031058823529411<br/>accuracy_score(y_train,xgb_predictions)</span><span id="90c8" class="nn mb jj nj b gy ns np l nq nr">train_confusion_matrix=confusion_matrix(y_train, xgb_predictions)</span><span id="69e7" class="nn mb jj nj b gy ns np l nq nr">pd.DataFrame.from_dict({"Negatives":train_confusion_matrix[0],<br/>                        "Positives":train_confusion_matrix[1]},orient='index',columns=["Negative Pred.","Positive Pred."])</span></pre><figure class="lg lh li lj gt iv gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/f83733f4905f4649fdb743c57dced40e.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*cdrPSE0MLO_7gAHEPU_opg.png"/></div></figure><p id="d203" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">注意，在1523个阳性病例中，我们的模型正确预测了1244个</strong>，因此具有1244/1523=0.82的真实阳性率。</p><figure class="lg lh li lj gt iv gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/de15bba5bbece9b30eda873c89cd168b.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*zXGAhsTIgaDVIt8__Xy1wQ.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">真实阳性率公式来自<a class="ae jg" href="https://en.wikipedia.org/wiki/Sensitivity_and_specificity" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></figure><figure class="lg lh li lj gt iv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/dd6a9711ecc403105be80ec57f569b18.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*2rnQmhK4VTUIejuvLEgdVg.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">我们可以看到总体评估指标。请注意，标签1的召回率为0.82。</p></figure><p id="c746" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在是测试集:</p><figure class="lg lh li lj gt iv gh gi paragraph-image"><div class="gh gi od"><img src="../Images/03720b8c664522cd32af701299e637e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*JZavNkTDo8RjnH9WPqUzcQ.png"/></div></figure><figure class="lg lh li lj gt iv gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/fcd6376056a35ddbf5041d305f139a80.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*h7xy0-2juEn8kxP-nciM8w.png"/></div></figure><p id="2d37" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的<strong class="ki jk">真阳性率(召回)下降到0.73 </strong>。</p><p id="6e77" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其计算方式为191 / (191+524)</p><p id="e26e" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还为训练数据设置了30%正标签的阈值。我们在测试集中使用了相同的阈值，如果您检查:</p><pre class="lg lh li lj gt ni nj nk nl aw nm bi"><span id="d88f" class="nn mb jj nj b gy no np l nq nr"># our predictor predicts 28 percent positive labels<br/># police needs to travel 28 percent of the area<br/>xgb_predictions_test.sum() /y_test.shape[0]</span></pre><p id="5913" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在测试集中，甚至有更少的正面预测标签，这甚至更好。</p><h1 id="9347" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">摘要和用法</h1><p id="bdbf" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">那么我们在这里做了什么？而且最重要的是，这种方法怎么用？</p><ul class=""><li id="aebd" class="lm ln jj ki b kj kk kn ko kr lo kv lp kz lq ld lr ls lt lu bi translated">首先，我们对犯罪报告区域进行聚类，使500个需求中心平稳地分布在波士顿市。</li><li id="6ba1" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">我们将一些犯罪类别归类为暴力犯罪。</li><li id="d844" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">然后，我们使用历史犯罪数据来创建一个训练数据集。对于每个聚类中心和每一天，我们汇总过去的犯罪数据以用作预测特征:该地区过去120天、30天、7天等的暴力犯罪总数…该地区过去120天、30天、7天等的财产犯罪总数…</li><li id="0af8" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">我们整合了历史天气数据作为预测特征。</li><li id="796a" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">我们建立了一个机器学习模型来预测那天和那个地区是否发生了暴力犯罪。</li></ul><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi of"><img src="../Images/d92d808bee9edf090e4a38216a5deab5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ClxRy4aS8ZdYEkVv45As9g.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">我们的训练数据。一些特征和目标变量:“isviolentcrime”</p></figure><ul class=""><li id="a36a" class="lm ln jj ki b kj kk kn ko kr lo kv lp kz lq ld lr ls lt lu bi translated">我们为我们的分类模型选择了一个阈值，使得30%的预测是肯定的。</li></ul></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><p id="290d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这意味着，如果对每个空间单元(在我们的例子中是分布在城市中的500个需求中心)的历史犯罪数据进行相应的汇总，警方就可以使用该模型来预测暴力犯罪。每天，警察可以运行这个模型，他们将得到大约30%的聚类中心对暴力犯罪的积极预测。这相当于500个地点中的150个。<strong class="ki jk">他们甚至可以订购那些贴有正面标签的区域</strong>。排序将考虑相应的概率，从而优先考虑暴力犯罪的最危险区域。</p><figure class="lg lh li lj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi on"><img src="../Images/6b25b300161ee1e03763143f548d4d9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3CkjFbvWEThqw0U1"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">比尔·牛津在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="06a2" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">凭借该模型的这一性能，警察只需巡逻30%的区域，就可以捕获70%的暴力犯罪。如果你分析历史犯罪数据，你会发现每天大约有7起暴力犯罪。根据我们的真实阳性率，警方可以预计每天大约有五起暴力犯罪。</p><h1 id="59b9" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">结论</h1><p id="2b08" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">预测整个波士顿市的暴力犯罪问题尤其具有挑战性。它不同于通常的需求预测问题:</p><ul class=""><li id="7105" class="lm ln jj ki b kj kk kn ko kr lo kv lp kz lq ld lr ls lt lu bi translated">通常的需求预测模型有固定的需求和供应中心。</li><li id="223e" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">需求是一个连续的特征，就像总销售额或总请求量一样。</li></ul><p id="f32e" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们的案例中:</p><ul class=""><li id="6c92" class="lm ln jj ki b kj kk kn ko kr lo kv lp kz lq ld lr ls lt lu bi translated">需求在城市中不断分布。需要聚类。</li><li id="8f68" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">需求是一个分类特征。问题是那里是否发生过暴力犯罪。</li><li id="ccb0" class="lm ln jj ki b kj lv kn lw kr lx kv ly kz lz ld lr ls lt lu bi translated">而作为一个二元分类问题，我们的数据集是高度不平衡的。阳性标签只占2%左右。这给建模和调整增加了额外的挑战。</li></ul><h1 id="70b6" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">未来的工作</h1><p id="1662" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">我们知道波士顿市有12个警察局/区。因此，我们可以尝试找到12个供应中心的最佳位置，以捕捉暴力犯罪的需求。</p><p id="ad8e" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个问题对应于<a class="ae jg" href="https://en.wikipedia.org/wiki/Facility_location_problem" rel="noopener ugc nofollow" target="_blank">设施选址问题</a>。实际上我已经用Python的优化包做到了。我的下一篇文章将介绍和实现这些包来解决一个线性优化问题。</p><h1 id="84ef" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">源代码和注释</h1><p id="e88e" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">我在我的github repo 中分享了我的Python代码和准备好的数据<a class="ae jg" href="https://github.com/alptuzel/bostoncrimeprediction" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="cc07" class="ma mb jj bd mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bi translated">参考</h1><p id="1586" class="pw-post-body-paragraph kg kh jj ki b kj my kl km kn mz kp kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">[1] G. Martegiani，L. Berrada，<a class="ae jg" href="https://www.academia.edu/25277353/Crime_Prediction_Using_Data_Analytics_the_Case_of_the_City_of_Boston" rel="noopener ugc nofollow" target="_blank">利用数据分析进行犯罪预测:波士顿市的案例</a> (2016年)</p><p id="463d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[2] A .贾恩，<a class="ae jg" href="https://www.kaggle.com/ankkur13/boston-crime-data" rel="noopener ugc nofollow" target="_blank">波士顿犯罪数据/ Kaggle数据集</a>，(2018)</p><p id="2217" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[3]分析波士顿，<a class="ae jg" href="https://www.kaggle.com/AnalyzeBoston/crimes-in-boston" rel="noopener ugc nofollow" target="_blank">波士顿犯罪/卡格尔数据集</a>，(2018)</p><p id="cdaf" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[4] G. Sharma，<a class="ae jg" href="https://blog.goodaudience.com/taxi-demand-prediction-new-york-city-5e7b12305475" rel="noopener ugc nofollow" target="_blank">出租车需求预测—纽约市—好观众</a> (2018)</p></div></div>    
</body>
</html>