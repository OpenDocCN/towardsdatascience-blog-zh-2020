<html>
<head>
<title>Monitoring your Machine Learning Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">监控你的机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/monitoring-your-machine-learning-model-6cf98c106e99?source=collection_archive---------22-----------------------#2020-08-21">https://towardsdatascience.com/monitoring-your-machine-learning-model-6cf98c106e99?source=collection_archive---------22-----------------------#2020-08-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/fb0cbc44760763c149135200662686d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i8HZ5xOyagQ4ZUqqnuc6vw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><em class="jg">作者图片</em></p></figure><h2 id="359f" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph">MLOps</h2><div class=""/><div class=""><h2 id="0bfd" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">部署您的 ML 模型时需要注意什么</h2></div><p id="55cd" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在过去的几年里，机器学习和人工智能已经越来越成为利用数据的组织的主要内容。随着这种成熟，出现了需要克服的新挑战，例如<strong class="lj jt">部署</strong>和<strong class="lj jt">监控</strong>机器学习模型。</p><p id="c538" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">尽管部署和监控软件一直是一种久经考验的实践，但对于机器学习模型来说，这样做却有很大不同。监控您的模型可以帮助您了解随着时间的推移您的预测有多准确。</p><blockquote class="md"><p id="13c1" class="me mf jj bd mg mh mi mj mk ml mm mc dk translated">通过监控模型来防止错误的预测</p></blockquote><p id="ade7" class="pw-post-body-paragraph lh li jj lj b lk mn kt lm ln mo kw lp lq mp ls lt lu mq lw lx ly mr ma mb mc im bi translated">从个人经验来看，似乎有许多组织，主要是中小企业，现在正面临着机器学习的这个<strong class="lj jt">生产</strong>阶段的挑战。</p><p id="a05f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">本文将重点关注<strong class="lj jt">在生产中监控</strong>你的机器学习模型。然而，如果您不熟悉<strong class="lj jt">部署</strong>您的模型，我建议您看看下面的文章，让您快速上手:</p><div class="is it gp gr iu ms"><a rel="noopener follow" target="_blank" href="/how-to-deploy-a-machine-learning-model-dc51200fe8cf"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd jt gy z fp mx fr fs my fu fw js bi translated">如何部署机器学习模型</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">用 FastAPI+uvicon 创建生产就绪的 API</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">towardsdatascience.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng ja ms"/></div></div></a></div><p id="ccc3" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">注意:</strong>没有一种正确的方法可以监控你的模型。本文仅作为设计监控框架时的参考。您的里数可能因您正在使用的解决方案而异。</p><h1 id="6cc5" class="nh ni jj bd nj nk nl nm nn no np nq nr ky ns kz nt lb nu lc nv le nw lf nx ny bi translated">1.为什么要监控你的模型？</h1><p id="d4de" class="pw-post-body-paragraph lh li jj lj b lk nz kt lm ln oa kw lp lq ob ls lt lu oc lw lx ly od ma mb mc im bi translated">所有生产软件都容易出故障，每个软件公司都知道监控其性能以防止问题的发生是很重要的。通常，我们<em class="oe">监控</em> <strong class="lj jt"> <em class="oe">软件</em> </strong>本身的质量，而在机器学习的环境中，人们可能更关注<em class="oe">监控</em> <strong class="lj jt"> <em class="oe">预测</em> </strong>的质量。</p><blockquote class="md"><p id="ee6c" class="me mf jj bd mg mh mi mj mk ml mm mc dk translated">并非所有数据都是平等的</p></blockquote><p id="3749" class="pw-post-body-paragraph lh li jj lj b lk mn kt lm ln mo kw lp lq mp ls lt lu mq lw lx ly mr ma mb mc im bi translated">您希望监控您的模型有几个原因:</p><ul class=""><li id="9cb5" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated">模型和输入数据之间的关系会发生变化</li><li id="2d2b" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">数据的分布发生了变化，使得模型的代表性降低</li><li id="4fcc" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated">衡量标准和/或用户群的变化改变了变量的潜在含义</li></ul><h2 id="ab59" class="ot ni jj bd nj ou ov dn nn ow ox dp nr lq oy oz nt lu pa pb nv ly pc pd nx jp bi translated"><strong class="ak">漂移</strong></h2><p id="4cf3" class="pw-post-body-paragraph lh li jj lj b lk nz kt lm ln oa kw lp lq ob ls lt lu oc lw lx ly od ma mb mc im bi translated">根据以上原因，通常可以在<strong class="lj jt">漂移</strong>中找到原因。从本质上来说，<strong class="lj jt">漂移</strong>是数据的统计属性发生变化的现象，这种现象会导致您的预测随着时间的推移而下降。换句话说，由于数据总是在变化，漂移自然会发生。</p><figure class="pf pg ph pi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pe"><img src="../Images/fba347b77d6d9b631a8544e3b7529b3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S-j1sRLaOo9LC1KOjG1TYQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae pj" href="https://unsplash.com/s/photos/drift?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae pj" href="https://unsplash.com/@rolandsvarsbergs?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">罗兰兹·瓦斯伯格</a>拍摄的照片</p></figure><p id="3c05" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">以网上商店的顾客数据为例。预测模型可以使用诸如他们的个人信息、购买行为和花在广告上的钱等特征。随着时间的推移，这些特征可能不能代表它们最初被训练时的特征。</p><blockquote class="pk pl pm"><p id="7f3f" class="lh li oe lj b lk ll kt lm ln lo kw lp pn lr ls lt po lv lw lx pp lz ma mb mc im bi translated">漂移通常被称为概念漂移、模型漂移或数据漂移</p></blockquote><p id="1cc0" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">监控您的模型以确保输入的数据与训练时使用的数据相似是很重要的。</p><h2 id="1376" class="ot ni jj bd nj ou ov dn nn ow ox dp nr lq oy oz nt lu pa pb nv ly pc pd nx jp bi translated">为什么不重新训练你的模特呢？</h2><p id="a51f" class="pw-post-body-paragraph lh li jj lj b lk nz kt lm ln oa kw lp lq ob ls lt lu oc lw lx ly od ma mb mc im bi translated">虽然重新训练一个模型听起来总是一个好主意，但它可能比这更微妙！</p><p id="6ad6" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你没有及时的标签怎么办？如果你的预测是几个星期后的事，那么在实践中验证你的模型将会很困难，因为你需要等待几个星期才能得到事实真相。</p><p id="f3fa" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">或者…如果您自动重新训练您的模型，只是让它运行 10 个小时，然后在第二天重新训练它，会怎么样？这可能会花费组织大量的计算时间，但却有一点积极的影响。</p><p id="8b20" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">或者…如果您以在线方式重新训练一个模型，但由于只关注新添加的数据而导致其性能下降，该怎么办？</p><p id="c453" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">盲目地重新训练一个模型会导致更多的成本，时间的浪费，甚至是一个更差的模型。通过监控你的模型，你可以更精确地决定再培训的最佳方法和时间。</p><h1 id="7720" class="nh ni jj bd nj nk nl nm nn no np nq nr ky ns kz nt lb nu lc nv le nw lf nx ny bi translated">2.监视</h1><p id="4154" class="pw-post-body-paragraph lh li jj lj b lk nz kt lm ln oa kw lp lq ob ls lt lu oc lw lx ly od ma mb mc im bi translated">监控您部署的模型的方法有很多种。实际上，这主要取决于您的应用程序、模型类型、性能度量和数据分布。但是，在监控模型时，有几件事是您最常看到的。</p><h2 id="e3c0" class="ot ni jj bd nj ou ov dn nn ow ox dp nr lq oy oz nt lu pa pb nv ly pc pd nx jp bi translated">监控预测</h2><figure class="pf pg ph pi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pq"><img src="../Images/70d6b5c414608eb89adb91487aeb5e1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EbubVcOx45gEdOWNzb8uEg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">从<a class="ae pj" href="https://en.wikipedia.org/wiki/Gaussian_process" rel="noopener ugc nofollow" target="_blank">这里检索</a>。</p></figure><p id="52ce" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果你幸运的话，在你的预测和你的目标预测之间几乎没有时间。换句话说，在做了一个预测之后，你很快就会有真正的标签。在这种情况下，只需监控标准绩效指标，如准确性、F1 评分和 ROC AUC。</p><p id="3cda" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">但是，当您没有及时的标签时，就不能使用性能测量(例如，疾病预测)，您必须寻找其他方法:</p><ul class=""><li id="beb4" class="of og jj lj b lk ll ln lo lq oh lu oi ly oj mc ok ol om on bi translated"><strong class="lj jt">预测分布* </strong> <br/>您可以使用回归和分类任务中预测的分布和频率来跟踪新的预测集是否与训练数据具有相似的分布。显著的偏差可能表明性能下降。</li><li id="9e29" class="of og jj lj b lk oo ln op lq oq lu or ly os mc ok ol om on bi translated"><strong class="lj jt">预测概率<br/> </strong>很多机器学习模型都可以输出分类概率。这些表明一个模型有多“确定”这是正确的预测。如果这些概率相对较低，那么该模型可能会在部署中遇到困难。</li></ul><p id="7556" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">*注意</strong>:如果你想比较分布，那么我们通常会关注统计测试，比如<a class="ae pj" href="https://en.wikipedia.org/wiki/Student%27s_t-test" rel="noopener ugc nofollow" target="_blank">学生 t 检验</a>或非参数<a class="ae pj" href="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test" rel="noopener ugc nofollow" target="_blank"> Kolmogorov Smirnov </a>。<a class="ae pj" href="https://stats.idre.ucla.edu/other/mult-pkg/whatstat/" rel="noopener ugc nofollow" target="_blank">这个</a>可能会帮助你为你的数据选择正确的统计检验。</p><h2 id="649f" class="ot ni jj bd nj ou ov dn nn ow ox dp nr lq oy oz nt lu pa pb nv ly pc pd nx jp bi translated">监控输入</h2><figure class="pf pg ph pi gt iv gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/c5a98ff5ee72c8090e9597e584aa30d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*OWEOyDuzPXdh05EfGpe8TQ.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">从这里的<a class="ae pj" href="https://commons.wikimedia.org/wiki/File:Normal_Distribution_PDF.svg" rel="noopener ugc nofollow" target="_blank">检索</a>。</p></figure><p id="03f5" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">如果您有及时的标签或者没有，那么监视您的模型的输入通常是一个好的实践。这有助于您了解通常输入到模型中的内容，并帮助您跟踪预测的恶化情况。</p><p id="786e" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">方法包括:</p><p id="7395" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">特征分布<br/> </strong>与预测一样，您可以使用分布输入数据来跟踪它是否具有与训练数据相似的分布。如果您发现显著差异，这可能表明您的培训数据并不代表您在生产中发现的数据。</p><p id="2a74" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">异常值检测<br/> </strong>根据您的预处理步骤，您通常不允许在预测模型中使用某些值。变量中类别的数量可能会随着时间的推移而增加，这是您的模型所没有预料到的。</p><h2 id="5f7e" class="ot ni jj bd nj ou ov dn nn ow ox dp nr lq oy oz nt lu pa pb nv ly pc pd nx jp bi translated">人工监控</h2><figure class="pf pg ph pi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ps"><img src="../Images/5af5d70ea057e9852a203088c413f89b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zGRcGwrTcEsXrCHZvFrtOg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">此处检索到<a class="ae pj" href="https://svgsilh.com/image/1353208.html" rel="noopener ugc nofollow" target="_blank"/>。</p></figure><p id="1456" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在自动化时代，我为什么要建议人工监控呢？尤其是当人类的行为对错误极其敏感的时候？</p><p id="5be2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">嗯……虽然人工监控应该是最后的手段，但在某些情况下，让人类看一看模型生成的预测是有益的。如果一个被监控的预测即使有超过 90%的概率也是不准确的，那么如果这些异常能被人看到就好了。</p><p id="7a4c" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">当你在实践中没有预测的基础事实标签时，人类的监控甚至可能是必要的。</p><h1 id="af1d" class="nh ni jj bd nj nk nl nm nn no np nq nr ky ns kz nt lb nu lc nv le nw lf nx ny bi translated">3.阴影模式</h1><p id="b5c3" class="pw-post-body-paragraph lh li jj lj b lk nz kt lm ln oa kw lp lq ob ls lt lu oc lw lx ly od ma mb mc im bi translated">每当您想要部署一个重新训练的模型时，您可能想要推迟将其部署到生产环境中。相反，以影子模式部署它可能更好。<strong class="lj jt">影子模式</strong>是一种通过新训练的模型运行生产数据的技术，无需将预测反馈给用户。</p><figure class="pf pg ph pi gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pt"><img src="../Images/65db539cd3ca470a9679fc54f36530c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E2aRBwlmX5hOGRX3MGFVQw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae pj" href="https://www.publicdomainpictures.net/en/view-image.php?image=215394&amp;picture=woman-in-hat-shadow" rel="noopener ugc nofollow" target="_blank">林奈</a>创作</p></figure><p id="8718" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">阴影模式</strong>允许您同时运行两个模型，同时在生产环境中测试新模型的性能。在实际部署到生产环境之前，您可以存储其预测以监控其行为。</p><p id="099f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">此外，您可以使用此模式来检查模型是否按预期工作，而无需模拟生产环境，因为它在技术上是生产环境的副本。</p><h1 id="969b" class="nh ni jj bd nj nk nl nm nn no np nq nr ky ns kz nt lb nu lc nv le nw lf nx ny bi translated">感谢您的阅读！</h1><p id="fc4b" class="pw-post-body-paragraph lh li jj lj b lk nz kt lm ln oa kw lp lq ob ls lt lu oc lw lx ly od ma mb mc im bi translated">如果你和我一样，对人工智能、数据科学或心理学充满热情，请随时在<a class="ae pj" href="https://www.linkedin.com/in/mgrootendorst/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上添加我，或者在<a class="ae pj" href="https://twitter.com/MaartenGr" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上关注我。</p><p id="9769" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有关生产中的机器学习的更多信息，请单击以下帖子之一:</p><div class="is it gp gr iu ms"><a rel="noopener follow" target="_blank" href="/how-to-deploy-a-machine-learning-model-dc51200fe8cf"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd jt gy z fp mx fr fs my fu fw js bi translated">如何部署机器学习模型</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">用 FastAPI+uvicon 创建生产就绪的 API</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">towardsdatascience.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng ja ms"/></div></div></a></div><div class="is it gp gr iu ms"><a rel="noopener follow" target="_blank" href="/quickly-build-and-deploy-an-application-with-streamlit-988ca08c7e83"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd jt gy z fp mx fr fs my fu fw js bi translated">借助 Streamlit 快速构建和部署应用</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">将您的 Streamlit 应用程序部署到 Heroku，展示您的数据解决方案</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">towardsdatascience.com</p></div></div><div class="nb l"><div class="pu l nd ne nf nb ng ja ms"/></div></div></a></div><div class="is it gp gr iu ms"><a rel="noopener follow" target="_blank" href="/unit-testing-for-data-scientists-dc5e0cd397fb"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd jt gy z fp mx fr fs my fu fw js bi translated">数据科学家的单元测试</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">使用 Pytest 提高管道的稳定性</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">towardsdatascience.com</p></div></div><div class="nb l"><div class="pv l nd ne nf nb ng ja ms"/></div></div></a></div></div></div>    
</body>
</html>