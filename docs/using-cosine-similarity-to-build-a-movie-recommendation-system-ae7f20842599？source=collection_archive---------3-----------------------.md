# åˆ©ç”¨ä½™å¼¦ç›¸ä¼¼åº¦æ„å»ºç”µå½±æ¨èç³»ç»Ÿ

> åŸæ–‡ï¼š<https://towardsdatascience.com/using-cosine-similarity-to-build-a-movie-recommendation-system-ae7f20842599?source=collection_archive---------3----------------------->

## ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼æ€§æ„å»ºåŸºäº Python çš„ç”µå½±æ¨èç³»ç»Ÿçš„åˆ†æ­¥æŒ‡å—

![](img/0c93ddd9985b70b0d0ac83808e23b332.png)

å›¾ç‰‡ç”± [Jade87](https://pixabay.com/users/jade87-3234870/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=4011346) æ¥è‡ª [Pixabay](https://pixabay.com/?utm_source=link-attribution&utm_medium=referral&utm_campaign=image&utm_content=4011346)

ä½ æœ‰æ²¡æœ‰æƒ³è±¡è¿‡ï¼Œåœ¨ä½ å·²ç»å–œæ¬¢çš„ç”µå½±çš„åŸºç¡€ä¸Šï¼Œä½ åœ¨é«˜ä¸­å­¦ä¹ çš„ä¸€ä¸ªç®€å•çš„å…¬å¼ä¼šåœ¨æ¨èä½ ä¸€éƒ¨ç”µå½±çš„è¿‡ç¨‹ä¸­å‘æŒ¥ä½œç”¨ï¼Ÿ

å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬ä½¿ç”¨**ä½™å¼¦ç›¸ä¼¼åº¦**(å½’ä¸€åŒ–å‘é‡çš„ç‚¹ç§¯)æ¥æ„å»ºä¸€ä¸ª**ç”µå½±æ¨èç³»ç»Ÿ**ï¼

# ä»€ä¹ˆæ˜¯æ¨èç³»ç»Ÿï¼Ÿ

**æ¨èç³»ç»Ÿ**æ˜¯ä¸€ç±»é‡è¦çš„æœºå™¨å­¦ä¹ ç®—æ³•ï¼Œä¸ºç”¨æˆ·æä¾›â€œç›¸å…³â€å»ºè®®ã€‚Youtubeã€äºšé©¬é€Šã€ç½‘é£ï¼Œéƒ½åœ¨æ¨èç³»ç»Ÿä¸Šå‘æŒ¥ä½œç”¨ï¼Œç³»ç»Ÿæ ¹æ®ä½ è¿‡å»çš„æ´»åŠ¨(**åŸºäºå†…å®¹çš„è¿‡æ»¤**)æˆ–æ ¹æ®ä¸ä½ ç›¸ä¼¼çš„å…¶ä»–ç”¨æˆ·çš„æ´»åŠ¨å’Œåå¥½(**ååŒè¿‡æ»¤**)å‘ä½ æ¨èä¸‹ä¸€ä¸ªè§†é¢‘æˆ–äº§å“ã€‚åŒæ ·ï¼Œè„¸ä¹¦ä¹Ÿä½¿ç”¨æ¨èç³»ç»Ÿæ¥æ¨èä½ çº¿ä¸‹å¯èƒ½è®¤è¯†çš„è„¸ä¹¦ç”¨æˆ·ã€‚

![](img/a63c5b560a8e2e9d885c4401d001f5f6.png)

ç…§ç‰‡ç”±[æ ¼ä¼¦Â·å‡¯è‰](https://unsplash.com/@glencarrie?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„

æ¨èç³»ç»Ÿçš„å·¥ä½œåŸºäºå†…å®¹æˆ–è®¿é—®å†…å®¹çš„ç”¨æˆ·ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚

æœ‰å‡ ç§æ–¹æ³•å¯ä»¥è¡¡é‡ä¸¤ä¸ªé¡¹ç›®ä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚æ¨èç³»ç»Ÿä½¿ç”¨è¿™ä¸ª**ç›¸ä¼¼çŸ©é˜µ**å‘ç”¨æˆ·æ¨èä¸‹ä¸€ä¸ªæœ€ç›¸ä¼¼çš„äº§å“ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªæœºå™¨å­¦ä¹ ç®—æ³•ï¼Œæ ¹æ®ç”¨æˆ·å–œæ¬¢çš„ç”µå½±æ¨èç”µå½±ã€‚è¿™ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹å°†åŸºäº**ä½™å¼¦ç›¸ä¼¼åº¦**ã€‚

# è·å–æ•°æ®é›†

æ„å»ºç”µå½±æ¨èç³»ç»Ÿçš„ç¬¬ä¸€æ­¥æ˜¯è·å–é€‚å½“çš„æ•°æ®ã€‚æ‚¨å¯ä»¥ä»ç½‘ä¸Šä¸‹è½½ç”µå½±æ•°æ®é›†ï¼Œæˆ–è€…ä»ä¸‹é¢çš„é“¾æ¥ä¸‹è½½ï¼Œè¯¥é“¾æ¥åŒ…å«ä¸€ä¸ª 22MB çš„ CSV æ–‡ä»¶ï¼Œæ ‡é¢˜ä¸ºâ€œ **movie_dataset.csv** â€:

[](https://github.com/MahnoorJaved98/Movie-Recommendation-System/blob/main/movie_dataset.csv) [## mahnoorjaved 98/ç”µå½±æ¨èç³»ç»Ÿ

### æ­¤æ—¶æ‚¨ä¸èƒ½æ‰§è¡Œè¯¥æ“ä½œã€‚æ‚¨å·²ä½¿ç”¨å¦ä¸€ä¸ªæ ‡ç­¾é¡µæˆ–çª—å£ç™»å½•ã€‚æ‚¨å·²åœ¨å¦ä¸€ä¸ªé€‰é¡¹å¡ä¸­æ³¨é”€ï¼Œæˆ–è€…â€¦

github.com](https://github.com/MahnoorJaved98/Movie-Recommendation-System/blob/main/movie_dataset.csv) 

ç°åœ¨è®©æˆ‘ä»¬æ¥æ¢ç´¢æ•°æ®é›†å§ï¼

æˆ‘ä»¬çš„ CSV æ–‡ä»¶æ€»å…±åŒ…å«äº† **4802 éƒ¨ç”µå½±**å’Œ **24 ä¸ªæ ç›®**:ç´¢å¼•ã€é¢„ç®—ã€æµæ´¾ã€ä¸»é¡µã€idã€å…³é”®è¯ã€åŸåˆ› _ è¯­è¨€ã€åŸåˆ› _ æ ‡é¢˜ã€æ¦‚è¿°ã€äººæ°”ã€åˆ¶ä½œ _ å…¬å¸ã€åˆ¶ä½œ _ å›½å®¶ã€å‘è¡Œ _ æ—¥æœŸã€æ”¶å…¥ã€è¿è¡Œæ—¶é—´ã€å£è¯­ã€çŠ¶æ€ã€æ ‡è¯­ã€æ ‡é¢˜ã€vote_averageã€vote_countã€æ¼”å‘˜ã€å‰§ç»„å’Œå¯¼æ¼”(å”‰ï¼).

åœ¨æ‰€æœ‰è¿™äº›ä¸åŒçš„ç‰¹æ€§ä¸­ï¼Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„æ˜¯æ‰¾å‡ºç›¸ä¼¼ä¹‹å¤„ï¼Œä»¥ä¾¿æå‡ºä¸‹ä¸€ä¸ªå»ºè®®ï¼Œè¿™äº›ç‰¹æ€§å¦‚ä¸‹:

> **å…³é”®è¯**ã€**å‰§ç»„**ã€**æµæ´¾** & **å¯¼æ¼”**ã€‚

å–œæ¬¢ææ€–ç”µå½±çš„ç”¨æˆ·å¾ˆå¯èƒ½ä¼šå–œæ¬¢å¦ä¸€éƒ¨ææ€–ç”µå½±ã€‚ä¸€äº›ç”¨æˆ·å¯èƒ½å–œæ¬¢åœ¨ç”µå½±çš„æ¼”å‘˜é˜µå®¹ä¸­çœ‹åˆ°ä»–ä»¬æœ€å–œæ¬¢çš„æ¼”å‘˜ã€‚å…¶ä»–äººå¯èƒ½å–œæ¬¢æŸä¸ªäººå¯¼æ¼”çš„ç”µå½±ã€‚ç»“åˆæ‰€æœ‰è¿™äº›æ–¹é¢ï¼Œæˆ‘ä»¬å…¥å›´çš„ 4 ä¸ªç‰¹å¾è¶³ä»¥è®­ç»ƒæˆ‘ä»¬çš„æ¨èç®—æ³•ã€‚

# **å¼€å§‹ç¼–ç **

ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»ç¼–ç å¼€å§‹ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬å¯¼å…¥æˆ‘ä»¬éœ€è¦çš„åº“ï¼Œä»¥åŠç”µå½±æ•°æ®é›†çš„ CSV æ–‡ä»¶ã€‚

```
import pandas as pd
import numpy as np
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.metrics.pairwise import cosine_similaritydf = pd.read_csv(r"...\movie_dataset.csv")
```

æˆ‘ä»¬å°†å¯¼å…¥ä¸¤ä¸ªé‡è¦çš„åº“ç”¨äºæ•°æ®åˆ†æå’Œæ“ä½œï¼›**ç†ŠçŒ«**å’Œ **numpy** ã€‚æˆ‘ä»¬è¿˜å°†å¯¼å…¥ Scikit-learn çš„ **CountVectorizerï¼Œ**ç”¨äºå°†ä¸€ç»„æ–‡æœ¬æ–‡æ¡£è½¬æ¢æˆä¸€ä¸ªæœ¯è¯­/æ ‡è®°è®¡æ•°çš„å‘é‡ã€‚

æœ€åï¼Œæˆ‘ä»¬å°†ä» sklearn **ï¼Œ**ä¸­å¯¼å…¥**ä½™å¼¦ _ ç›¸ä¼¼åº¦**ä½œä¸ºæˆ‘ä»¬ç›¸ä¼¼åº¦çŸ©é˜µçš„åº¦é‡(è¿™å°†åœ¨åé¢è¯¦ç»†è®¨è®º)ã€‚

æˆ‘ä»¬å°† CSV æ–‡ä»¶è¯»å…¥æ•°æ®å¸§ **df** ï¼Œç„¶åå¯ä»¥åœ¨ Python IDE çš„å˜é‡æµè§ˆå™¨ä¸­è®¿é—®å®ƒã€‚

![](img/f67c67d0ba3cc04935c984767754a07e.png)

CSV åŠ è½½åˆ°æ•°æ®å¸§ä¸­(å›¾ç‰‡ç”±ä½œè€…æä¾›)

# åŠŸèƒ½åˆ—è¡¨

æˆ‘ä»¬å°†åˆ—å‡ºæˆ‘ä»¬å°†ä½¿ç”¨çš„åŠŸèƒ½ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œè€ƒè™‘åˆ°æˆ‘ä»¬æ‰‹å¤´çš„é—®é¢˜ï¼Œæˆ‘ä»¬å°†åªä½¿ç”¨ä¸æˆ‘ä»¬æœ€ç›¸å…³çš„ç‰¹æ€§ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é€‰æ‹©çš„åŠŸèƒ½å°†æ˜¯**å…³é”®è¯**ï¼Œ**æ¼”å‘˜**ï¼Œ**æµæ´¾** & **å¯¼æ¼”**ã€‚

æ­¤å¤–ï¼Œæˆ‘ä»¬å°†åšä¸€äº›**æ•°æ®é¢„å¤„ç†**ï¼Œå¹¶ç”¨ç©ºæ ¼/ç©ºå­—ç¬¦ä¸²æ›¿æ¢ä»»ä½•å…·æœ‰ NaN å€¼çš„è¡Œï¼Œè¿™æ ·åœ¨è¿è¡Œä»£ç æ—¶å°±ä¸ä¼šäº§ç”Ÿé”™è¯¯ã€‚è¿™ä¸ªé¢„å¤„ç†å·²ç»åœ¨ for å¾ªç¯ä¸­å®Œæˆäº†ã€‚

```
features = ['keywords', 'cast', 'genres', 'director']for feature in features:
    df[feature] = df[feature].fillna('')
```

# å°†ç›¸å…³ç‰¹å¾ç»„åˆæˆå•ä¸ªç‰¹å¾

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªåä¸º **combined_features çš„å‡½æ•°ã€‚è¯¥å‡½æ•°å°†æŠŠæˆ‘ä»¬æ‰€æœ‰æœ‰ç”¨çš„ç‰¹å¾(å…³é”®å­—ã€æ¼”å‘˜ã€æµæ´¾&å¯¼æ¼”)ä»å®ƒä»¬å„è‡ªçš„è¡Œä¸­ç»„åˆèµ·æ¥ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰ç»„åˆç‰¹å¾çš„è¡Œã€‚**

```
def combined_features(row):
    return row['keywords']+" "+row['cast']+" "+row['genres']+" "+row['director']df["combined_features"] = df.apply(combined_features, axis =1)
```

æˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ªæ–°åˆ—ï¼Œ **combined_features** åˆ°æˆ‘ä»¬ç°æœ‰çš„ dataframe (df)ä¸­ï¼Œå¹¶å°†ä¸Šè¿°å‡½æ•°åº”ç”¨äºæ¯ä¸€è¡Œ(è½´= 1)ã€‚ç°åœ¨ï¼Œæ•°æ®å¸§çš„æœ«å°¾å°†æœ‰ä¸€ä¸ªé¢å¤–çš„åˆ—ï¼Œç”±å¤šè¡Œç»„åˆç‰¹å¾ç»„æˆã€‚

![](img/b74aa02dc8671a2ed4ae68732f582a53.png)

æˆ‘ä»¬çš„æ•°æ®æ¡†æ¶ä¸­çš„ç»„åˆç‰¹å¾æ (å›¾ç‰‡ç”±ä½œè€…æä¾›)

# æå–ç‰¹å¾

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»æ•°æ®ä¸­æå–ç‰¹å¾ã€‚

sklearn.feature_extraction æ¨¡å—å¯ç”¨äºä»ç”±æ–‡æœ¬å’Œå›¾åƒç­‰æ ¼å¼ç»„æˆçš„æ•°æ®é›†ä¸­æå–æœºå™¨å­¦ä¹ ç®—æ³•æ”¯æŒçš„æ ¼å¼çš„è¦ç´ ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ **CountVectorizer çš„ fit . transform**æ¥è®¡ç®—æ–‡æœ¬çš„æ•°é‡ï¼Œå¹¶å°†è½¬æ¢åçš„çŸ©é˜µ **count_matrix** æ‰“å°æˆä¸€ä¸ªæ•°ç»„ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£ã€‚

```
cv = CountVectorizer()
count_matrix = cv.fit_transform(df["combined_features"])
print("Count Matrix:", count_matrix.toarray())
```

# ä½¿ç”¨ä½™å¼¦ç›¸ä¼¼åº¦

æˆ‘ä»¬å°†ä½¿ç”¨æ¥è‡ª Sklearn çš„**ä½™å¼¦ç›¸ä¼¼åº¦**ä½œä¸ºåº¦é‡æ¥è®¡ç®—ä¸¤éƒ¨ç”µå½±ä¹‹é—´çš„ç›¸ä¼¼åº¦ã€‚

ä½™å¼¦ç›¸ä¼¼æ€§æ˜¯ä¸€ç§ç”¨äºè¡¡é‡ä¸¤ä¸ªé¡¹ç›®ç›¸ä¼¼ç¨‹åº¦çš„åº¦é‡ã€‚åœ¨æ•°å­¦ä¸Šï¼Œå®ƒæµ‹é‡çš„æ˜¯åœ¨å¤šç»´ç©ºé—´ä¸­æŠ•å½±çš„ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„è§’åº¦ä½™å¼¦ã€‚è¾“å‡ºå€¼èŒƒå›´ä»**0â€“1**ã€‚

> ***0 è¡¨ç¤ºæ²¡æœ‰ç›¸ä¼¼æ€§ï¼Œå…¶ä¸­ as 1 è¡¨ç¤ºä¸¤ä¸ªé¡¹ç›® 100%ç›¸ä¼¼ã€‚***

![](img/ac2a107accd330f69adb3fd38d243fe2.png)

ä½™å¼¦ç›¸ä¼¼åº¦(å›¾ç‰‡ç”±ä½œè€…æä¾›)

python ä½™å¼¦ç›¸ä¼¼åº¦æˆ–ä½™å¼¦å†…æ ¸å°†ç›¸ä¼¼åº¦è®¡ç®—ä¸ºè¾“å…¥æ ·æœ¬ X å’Œ y çš„å½’ä¸€åŒ–ç‚¹ç§¯ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ sk learn**Cosine _ Similarity**æ¥æŸ¥æ‰¾è®¡æ•°çŸ©é˜µä¸­ä¸¤ä¸ªå‘é‡çš„ cos Î¸ ã€‚

```
cosine_sim = cosine_similarity(count_matrix)
```

**cosine_sim** çŸ©é˜µæ˜¯ä¸€ä¸ª numpy æ•°ç»„ï¼Œç”¨äºè®¡ç®—æ¯éƒ¨ç”µå½±ä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦ã€‚ä¸‹å›¾å¯ä»¥çœ‹åˆ°ï¼Œç”µå½± 0 ä¸ç”µå½± 0 çš„ä½™å¼¦ç›¸ä¼¼åº¦ä¸º 1ï¼›å®ƒä»¬ 100%ç›¸ä¼¼(ç†åº”å¦‚æ­¤)ã€‚

ç±»ä¼¼åœ°ï¼Œç”µå½± 0 å’Œç”µå½± 1 ä¹‹é—´çš„ä½™å¼¦ç›¸ä¼¼åº¦æ˜¯ 0.105409(ç”µå½± 1 å’Œç”µå½± 0 ä¹‹é—´çš„åˆ†æ•°ç›¸åŒâ€”â€”é¡ºåºæ— å…³ç´§è¦)ã€‚

ç”µå½± 0 å’Œ 4 æ¯”ç”µå½± 0 å’Œ 3 æ›´ç›¸ä¼¼(ç›¸ä¼¼æ€§åˆ†æ•°ä¸º 0.23094)(åˆ†æ•°= 0.0377426)ã€‚

å¸¦æœ‰ 1 çš„å¯¹è§’çº¿è¡¨ç¤ºæƒ…å†µæ˜¯ä»€ä¹ˆï¼Œæ¯éƒ¨ç”µå½±â€œxâ€éƒ½ä¸è‡ªå·± 100%ç›¸ä¼¼ï¼

![](img/ce651985f7b60b23d43e198374fd40a1.png)

ä½™å¼¦ç›¸ä¼¼çŸ©é˜µ(å›¾ç‰‡ç”±ä½œè€…æä¾›)

# ç”¨æˆ·å–œæ¬¢çš„å†…å®¹

ä¸‹ä¸€æ­¥æ˜¯åœ¨ **movie_user_likes** å˜é‡ä¸­è¾“å…¥ç”¨æˆ·å–œæ¬¢çš„ç”µå½±ã€‚

ç”±äºæˆ‘ä»¬æ­£åœ¨å»ºç«‹ä¸€ä¸ªåŸºäºå†…å®¹çš„è¿‡æ»¤ç³»ç»Ÿï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ç”¨æˆ·çš„å–œæ¬¢ï¼Œä»¥ä¾¿é¢„æµ‹ç±»ä¼¼çš„é¡¹ç›®ã€‚

```
movie_user_likes = "Dead Poets Society"def get_index_from_title(title):
    return df[df.title == title]["index"].values[0]movie_index = get_index_from_title(movie_user_likes)
```

å‡è®¾æˆ‘å–œæ¬¢ç”µå½±ã€Šæ­»äº¡è¯—ç¤¾ã€‹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘å°†æ„å»ºä¸€ä¸ªå‡½æ•°æ¥ä»è¿™éƒ¨ç”µå½±çš„åç§°ä¸­è·å–ç´¢å¼•ã€‚è¯¥ç´¢å¼•å°†ä¿å­˜åœ¨ **movie_index** å˜é‡ä¸­ã€‚

![](img/48bc4810bb1c804ef14b6641f7e77eda.png)

ç”¨æˆ·å–œæ¬¢çš„ç”µå½±çš„ç”µå½±ç´¢å¼•å˜é‡(ä½œè€…å›¾ç‰‡)

# ç”Ÿæˆç›¸ä¼¼ç”µå½±çŸ©é˜µ

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ç”Ÿæˆä¸€ä¸ªç±»ä¼¼ç”µå½±çš„åˆ—è¡¨ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬ç»™å‡ºçš„ç”µå½±çš„**ç”µå½± _ ç´¢å¼•**ä½œä¸ºè¾“å…¥**ç”µå½± _ ç”¨æˆ· _ å–œæ¬¢**ã€‚enumerate()æ–¹æ³•å°†å‘å¯è¿­ä»£åˆ—è¡¨**ä½™å¼¦ _sim** æ·»åŠ ä¸€ä¸ªè®¡æ•°å™¨ï¼Œå¹¶ä»¥åˆ—è¡¨**ç›¸ä¼¼ _ ç”µå½±**çš„å½¢å¼è¿”å›å®ƒï¼Œå…¶ä¸­åŒ…å«æ¯ä¸ªç´¢å¼•çš„ç›¸ä¼¼æ€§å¾—åˆ†ã€‚

```
similar_movies = list(enumerate(cosine_sim[movie_index]))
```

![](img/5bc476a34e5af1693a1ba676754248d7.png)

ç›¸ä¼¼ç”µå½±åˆ—è¡¨(ä½œè€…å›¾ç‰‡)

# æŒ‰é™åºå¯¹ç›¸ä¼¼ç”µå½±åˆ—è¡¨è¿›è¡Œæ’åº

ä¸‹ä¸€æ­¥æ˜¯å¯¹åˆ—è¡¨ä¸­çš„ç”µå½±è¿›è¡Œæ’åº**ç›¸ä¼¼ _ ç”µå½±**ã€‚æˆ‘ä»¬ä½¿ç”¨äº†å‚æ•° reverse=Trueï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›åˆ—è¡¨æŒ‰é™åºæ’åˆ—ï¼Œæœ€ç›¸ä¼¼çš„æ¡ç›®åœ¨é¡¶éƒ¨ã€‚

```
sorted_similar_movies = sorted(similar_movies, key=lambda x:x[1], reverse=True)
```

**sorted_similar_movies** å°†æ˜¯æŒ‰ç…§ä¸è¾“å…¥ç”µå½± **movie_user_likes** çš„ç›¸ä¼¼æ€§åˆ†æ•°é™åºæ’åºçš„æ‰€æœ‰ç”µå½±çš„åˆ—è¡¨ã€‚

ä»ä¸‹å›¾å¯ä»¥çœ‹å‡ºï¼Œç›¸ä¼¼åº¦å¾—åˆ†ä¸º 0.9999999999999999993 çš„æœ€ç›¸ä¼¼çš„ä¸€ä¸ªåœ¨æœ€ä¸Šé¢ï¼Œå…¶ç´¢å¼•å·ä¸º 2453(ç”µå½±æ˜¯æˆ‘ä»¬ä½œä¸ºè¾“å…¥ç»™å‡ºçš„'æ­»äº¡è¯—ç¤¾'ï¼Œæœ‰é“ç†å§ï¼Ÿ).

![](img/e94017213d4f83f398248e82ead2e2d5.png)

ç›¸ä¼¼åˆ†æ•°æ’åºçš„ç›¸ä¼¼ç”µå½±åˆ—è¡¨(å›¾ç‰‡ç”±ä½œè€…æä¾›)

# å°åˆ·ç›¸ä¼¼çš„ç”µå½±

ç°åœ¨ï¼Œé¡¹ç›®çš„æœ€åä¸€éƒ¨åˆ†æ¥äº†ï¼Œæ‰“å°ç”µå½±çš„åå­—ï¼Œç±»ä¼¼äºæˆ‘ä»¬é€šè¿‡ **movie_user_likes** å˜é‡ç»™ç³»ç»Ÿè¾“å…¥çš„åå­—ã€‚

å¦‚ **sorted_similar_movies** åˆ—è¡¨æ‰€ç¤ºï¼Œç”µå½±æŒ‰å…¶ç´¢å¼•å·æ’åºã€‚æ‰“å°ç´¢å¼•å·å¯¹æˆ‘ä»¬æ¥è¯´æ²¡æœ‰ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å®šä¹‰ä¸€ä¸ªç®€å•çš„å‡½æ•°ï¼Œå°†ç´¢å¼•å·è½¬æ¢æˆç”µå½±æ ‡é¢˜ï¼Œå°±åƒåœ¨ dataframe ä¸­ä¸€æ ·ã€‚

> *ç´¢å¼•å·â†’ç”µå½±åç§°*

æ¥ä¸‹æ¥æˆ‘ä»¬å°†åœ¨ for å¾ªç¯ä¸­è°ƒç”¨è¿™ä¸ªå‡½æ•°æ¥æ‰“å°æ¥è‡ª **sorted_similar_movies** çš„ç¬¬ä¸€ä¸ªâ€œxâ€ä¸ªç”µå½±ã€‚

åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†æ‰“å° 4802 éƒ¨ç”µå½±ä¸­æœ€ç›¸ä¼¼çš„ 15 éƒ¨ç”µå½±ã€‚

```
def get_title_from_index(index):
    return df[df.index == index]["title"].values[0]i=0
for movie in sorted_similar_movies:
    print(get_title_from_index(movie[0]))
    i=i+1
    if i>15:
        break
```

# **è¿è¡Œæ•´ä¸ªä»£ç **

ç°åœ¨åº”ç”¨ç¨‹åºæ¥äº†ã€‚ä½¿ç”¨ä¸Šè¿°æ­¥éª¤ç¼–å†™æ‚¨è‡ªå·±çš„æ¨èç³»ç»Ÿï¼Œå¹¶é€šè¿‡å°†æ‚¨å–œæ¬¢çš„ç”µå½±äº¤ç»™ **movie_user_likes** æ¥è¿è¡Œä»£ç ã€‚

æˆ‘ç»™äº†â€œ**æ­»äº¡è¯—ç¤¾**â€ï¼Œå®ƒç»™æˆ‘æ‰“å°äº†ä»¥ä¸‹ç±»ä¼¼çš„ç”µå½±:

![](img/e61a3e4072f1f988d0ab90f8aa50782f.png)

IPython æ§åˆ¶å°(å›¾ç‰‡ç”±ä½œè€…æä¾›)

å¯ä»¥çœ‹å‡ºï¼Œæœ€ç›¸ä¼¼çš„æ˜¾ç„¶æ˜¯ç”µå½±æœ¬èº«ã€‚ç®—æ³•å®šä¹‰â€œ**æ— äº‹ç”Ÿé**â€ä¸ºä¸‹ä¸€éƒ¨æœ€ç›¸ä¼¼çš„ç”µå½±ï¼(å°†å®ƒæ·»åŠ åˆ°æˆ‘çš„â€œè§‚å¯Ÿåˆ—è¡¨â€ğŸ˜„)

æœ¬æ–‡åˆ°æ­¤ä¸ºæ­¢ï¼æœ¬æ–‡æä¾›äº†ä¸€ç§å®è·µæ–¹æ³•ï¼Œé€šè¿‡åœ¨ä»»ä½• python IDE ä¸Šç¼–å†™ä»£ç ï¼Œä»å¤´å¼€å§‹æ„å»ºæ¨èç³»ç»Ÿã€‚

ç°åœ¨ï¼Œä¸€æ—¦å»ºç«‹äº†ç®—æ³•ï¼Œæ˜¯æ—¶å€™æ‹¿äº›çˆ†ç±³èŠ±ï¼Œçœ‹ä½ çš„ç³»ç»Ÿæ¨èçš„ç”µå½±äº†ï¼ï¼ğŸ˜

![](img/02146440d03a3595bcd405201f02518f.png)

çˆ†ç±³èŠ±æ—¶é—´ï¼(ç…§ç‰‡ç”± [Unsplash](https://unsplash.com/s/photos/cast-movie?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šçš„[ä¹”æ²»äºšÂ·ç“¦å‰å§†](https://unsplash.com/@georgiavagim?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)æ‹æ‘„)