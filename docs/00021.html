<html>
<head>
<title>Guinea Pig Breed Classification</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">豚鼠品种分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/guinea-pig-breed-classification-517fbb036ee6?source=collection_archive---------20-----------------------#2020-01-01">https://towardsdatascience.com/guinea-pig-breed-classification-517fbb036ee6?source=collection_archive---------20-----------------------#2020-01-01</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="f753" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">如何通过机器学习利用图像识别豚鼠品种</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/182e9b7cd8cdc34b48b9e6e746dccd1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dEq9woX-m4IAv2zRcpp_qQ.jpeg"/></div></div></figure><p id="1ca4" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated"><strong class="ku is"> TL:DR </strong>我用深度学习模型从图片中识别出了豚鼠的品种。该模型是图像CNN，其应用了来自Inception V3模型的迁移学习，其中权重在ImageNet上预先训练。源图像来自多个图像搜索引擎。最终的模型能够对四种不同的豚鼠品种进行分类。</p><p id="2506" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">密码和笔记本可以在<a class="ae lo" href="https://github.com/ringoshin/cavy_breed_clf" rel="noopener ugc nofollow" target="_blank"> <strong class="ku is">这里</strong> </a>找到。</p></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h1 id="d2b8" class="lw lx ir bd ly lz ma mb mc md me mf mg jx mh jy mi ka mj kb mk kd ml ke mm mn bi translated">目录</h1><ol class=""><li id="422d" class="mo mp ir ku b kv mq ky mr lb ms lf mt lj mu ln mv mw mx my bi translated"><a class="ae lo" href="#5908" rel="noopener ugc nofollow">前言</a></li><li id="6b77" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln mv mw mx my bi translated"><a class="ae lo" href="#d02c" rel="noopener ugc nofollow">简介</a></li><li id="f203" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln mv mw mx my bi translated"><a class="ae lo" href="#6cb5" rel="noopener ugc nofollow">模型建立和发现</a> <br/>步骤0。<a class="ae lo" href="#447c" rel="noopener ugc nofollow">项目文件夹格式化</a> <br/>步骤1。<a class="ae lo" href="#9c5d" rel="noopener ugc nofollow"> Raw图像刮</a> <br/>步骤2。<a class="ae lo" href="#5011" rel="noopener ugc nofollow">数据集创建</a> <br/>第三步。<a class="ae lo" href="#14d4" rel="noopener ugc nofollow">图像数据预处理</a>步骤4<br/>。<a class="ae lo" href="#fb6b" rel="noopener ugc nofollow">基线模型训练</a> <br/>第五步。<a class="ae lo" href="#8b24" rel="noopener ugc nofollow">深度学习模型训练</a> <br/>步骤6。<a class="ae lo" href="#1aab" rel="noopener ugc nofollow">型号比较和选择</a></li><li id="2a27" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln mv mw mx my bi translated"><a class="ae lo" href="#aa43" rel="noopener ugc nofollow">结论</a></li></ol></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h1 id="5908" class="lw lx ir bd ly lz ma mb mc md me mf mg jx mh jy mi ka mj kb mk kd ml ke mm mn bi translated">前言</h1><p id="bc22" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">这是我在<a class="ae lo" href="https://metis.kaplan.com.sg/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku is"> Metis数据科学训练营</strong> </a>完成的第三个项目。当时，我们正在学习分类、各自的分类器和指标。我想给图像分类一个镜头，但不是用<a class="ae lo" href="https://www.kaggle.com/c/dogs-vs-cats" rel="noopener ugc nofollow" target="_blank"> <strong class="ku is">狗vs</strong></a>。既然我的妻子和我都是豚鼠爱好者，那么为什么不应用我的领域知识，并从中获得一些乐趣呢？旅程就这样开始了…</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nh"><img src="../Images/486b0d6e4e4715870d5ffe7f06d29066.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9yHJSI8CImGAIBwR"/></div></div><p class="ni nj gk gi gj nk nl bd b be z dk translated"><a class="ae lo" href="https://unsplash.com/@bonniekdesign?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Bonnie Kittle </a>在<a class="ae lo" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3062" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated"><a class="ae lo" href="#d2b8" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h1 id="d02c" class="lw lx ir bd ly lz ma mb mc md me mf mg jx mh jy mi ka mj kb mk kd ml ke mm mn bi translated">介绍</h1><p id="ddb8" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">豚鼠(或豚鼠)通常被作为家庭宠物饲养，因为它们的大小易于控制(0.7-1.2公斤)，友好的天性和极度的可爱。这些可爱的动物是啮齿动物，大小介于仓鼠和龙猫之间。它们是食草动物，吃的食物和兔子差不多:颗粒饲料、干草、蔬菜和水果。</p><p id="008b" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">根据<a class="ae lo" href="https://en.wikipedia.org/wiki/List_of_guinea_pig_breeds" rel="noopener ugc nofollow" target="_blank"> <strong class="ku is">维基百科</strong> </a>记载，豚鼠的品种很多(13-18)。与大小和形状各异的狗不同，豚鼠的一切都与毛发有关:</p><p id="ee4b" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">在这个项目中，我选择了四个最容易识别的品种:</p><ul class=""><li id="8988" class="mo mp ir ku b kv kw ky kz lb nm lf nn lj no ln np mw mx my bi translated"><a class="ae lo" href="https://www.goodhousekeeping.com/life/pets/g25751355/guinea-pig-breeds/?slide=2" rel="noopener ugc nofollow" target="_blank">红阿比</a>(短发夹玫瑰花)</li><li id="1c37" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated"><a class="ae lo" href="https://www.goodhousekeeping.com/life/pets/g25751355/guinea-pig-breeds/?slide=4" rel="noopener ugc nofollow" target="_blank">美国</a>(光滑，短毛)</li><li id="acb6" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">丝毛/谢尔蒂(光滑、长毛)</li><li id="f24f" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated"><a class="ae lo" href="https://www.goodhousekeeping.com/life/pets/g25751355/guinea-pig-breeds/?slide=14" rel="noopener ugc nofollow" target="_blank">骨瘦如柴</a>(无毛)。</li></ul><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj nq"><img src="../Images/7152464988506c44cf14cba03989f1f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dhPUJGMgUMKX-31vRdv4CA.png"/></div></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">用于图像分类的豚鼠品种</p></figure><p id="d47d" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated"><a class="ae lo" href="#d2b8" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h1 id="6cb5" class="lw lx ir bd ly lz ma mb mc md me mf mg jx mh jy mi ka mj kb mk kd ml ke mm mn bi translated">模型构建和发现</h1><p id="689b" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">对于本文的其余部分，您可以跟随我的Google Colab <a class="ae lo" href="https://github.com/ringoshin/cavy_breed_clf/blob/master/cavy_breed_clf_train_and_predict_abridged.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="ku is">笔记本</strong> </a>。这是我完成这个项目的步骤的节略版。</p><p id="e309" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">你所要做的就是在你Google Drive的'<em class="nr"> Colab Notebooks </em>'文件夹下新建一个名为'<em class="nr"> cavy_breed_clf </em>的子文件夹。将下面的笔记本和文件夹复制到'<em class="nr"> cavy_breed_clf </em>'中，你就可以开始了。</p><ul class=""><li id="8c70" class="mo mp ir ku b kv kw ky kz lb nm lf nn lj no ln np mw mx my bi translated">/data (~163kB)</li><li id="ec67" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">/图像(~130MB)</li><li id="b28f" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">/lib (~67kB)</li><li id="c199" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated"><a class="ae lo" href="https://github.com/ringoshin/cavy_breed_clf/blob/master/cavy_breed_clf_train_and_predict_abridged.ipynb" rel="noopener ugc nofollow" target="_blank">cavy _ breed _ clf _ train _ and _ predict _ bridged . ipynb</a></li></ul><p id="ce3e" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">然而，如果你想知道我是如何到达那里的，我已经把我的脚本和笔记本按数字顺序分类了。我希望这将为以下过程提供更清晰的感觉:数据准备、训练(经典ML，然后是神经网络)和度量/预测。</p><p id="0739" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated"><a class="ae lo" href="#d2b8" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h2 id="447c" class="ns lx ir bd ly nt nu dn mc nv nw dp mg lb nx ny mi lf nz oa mk lj ob oc mm od bi translated">步骤0。项目文件夹格式</h2><p id="5d56" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">这是第一个项目，我根据这里的<a class="ae lo" href="https://blog.godatadriven.com/write-less-terrible-notebook-code" rel="noopener ugc nofollow" target="_blank"><strong class="ku is"/></a>和这里的<a class="ae lo" href="https://docs.python-guide.org/writing/structure/" rel="noopener ugc nofollow" target="_blank"><strong class="ku is"/></a>的建议，努力组织我的代码和文档。</p><ul class=""><li id="7dc3" class="mo mp ir ku b kv kw ky kz lb nm lf nn lj no ln np mw mx my bi translated">/data —项目数据集:原始、培训、验证和测试</li><li id="7337" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">/images —原始图像存储在按品种排序的子文件夹中，另外还有一个样本子文件夹，用于存储数据集之外的临时图像</li><li id="9504" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">/lib/data _ common . py-图像数据预处理例程</li><li id="c114" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">/lib/ml_common.py —经典的ml处理流程，包括分类指标</li><li id="927c" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">/lib/nn_common.py —神经网络DL处理过程</li></ul><p id="d064" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated"><a class="ae lo" href="#d2b8" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h2 id="9c5d" class="ns lx ir bd ly nt nu dn mc nv nw dp mg lb nx ny mi lf nz oa mk lj ob oc mm od bi translated">第一步。原始图像刮擦</h2><p id="b59d" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">拥有大量优质、干净和正确类型的数据非常重要。这可能是最痛苦的部分，但也是你ML项目中最关键的部分。它将确保你的模型将执行它被设定的目的，或者至少是一个像样的MVP。在训练营期间，我们真正学到了这一课。</p><p id="a2be" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">AFAIK，没有可用于机器学习的公共cavy图像数据集。幸运的是，基于这篇<a class="ae lo" href="https://www.searchenginejournal.com/best-image-search-engines/299963/#close" rel="noopener ugc nofollow" target="_blank"> <strong class="ku is">文章</strong> </a>有很多有用的搜索引擎。对我来说，我主要依靠<a class="ae lo" href="https://images.google.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku is">谷歌</strong></a><a class="ae lo" href="https://images.search.yahoo.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ku is">雅虎</strong> </a>和<a class="ae lo" href="https://www.bing.com/images/discover" rel="noopener ugc nofollow" target="_blank"> <strong class="ku is">必应</strong> </a>。</p><p id="ec01" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">一开始，我能为每个品种收集500到1000张原始图像。我非常依赖这个出色的Chrome扩展<a class="ae lo" href="https://chrome.google.com/webstore/detail/fatkun-batch-download-ima/nnjjahlikiabnchcpehcpkdeckfgnohf" rel="noopener ugc nofollow" target="_blank"> <strong class="ku is"> Fatkun批量下载图片</strong> </a>来批量下载图片。</p><p id="2ec5" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">请注意，每个品种1000张图片听起来可能很多，但事实并非如此。这些都是未加工的，没有标签。我不得不在下载期间和下载后仔细检查所有4000多张图片，以筛选出不合格的候选人:</p><ul class=""><li id="1e15" class="mo mp ir ku b kv kw ky kz lb nm lf nn lj no ln np mw mx my bi translated">贴错标签的动物种类或豚鼠品种</li><li id="35ca" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">图像中缺少cavy(是的，即使搜索引擎也不是完美的)</li><li id="aa36" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">多个cavies(模型最好只从每个图像中学习一个)</li><li id="c617" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">漫画，而不是真正的照片</li><li id="6602" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">重要的品种特征没有完全展示出来(例如红阿比的玫瑰花结)</li><li id="3bd3" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">分辨率太低</li><li id="ed18" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">太模糊了</li></ul><p id="5e16" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">最终，我把它缩减到1600多张图片:</p><ul class=""><li id="e49d" class="mo mp ir ku b kv kw ky kz lb nm lf nn lj no ln np mw mx my bi translated">红阿比:553人</li><li id="76d0" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">美国人:519</li><li id="1035" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">西尔基:267</li><li id="959d" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">瘦子:292</li></ul><p id="7c71" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">这是一个适度不平衡的数据集，但我相信它不会对模型的训练产生重大影响。</p><p id="5aaa" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated"><a class="ae lo" href="#d2b8" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h2 id="5011" class="ns lx ir bd ly nt nu dn mc nv nw dp mg lb nx ny mi lf nz oa mk lj ob oc mm od bi translated">第二步。数据集创建</h2><p id="5bb7" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">在我收集了需要的图片后，我将它们分类到各自的子文件夹中。然后，我运行一个简短的<a class="ae lo" href="https://github.com/ringoshin/cavy_breed_clf/blob/master/data/0a%20create_image_dataset.py" rel="noopener ugc nofollow" target="_blank">脚本</a>(也作为<a class="ae lo" href="https://github.com/ringoshin/cavy_breed_clf/blob/master/data/0a%20create_image_dataset.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>)来生成这些数据集；原始、培训、验证和测试。后三个数据集将成为所有未来ML训练、验证和测试的输入数据。</p><p id="4bdc" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">快速健全检查，以确保品种分布均匀的数据集。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj oe"><img src="../Images/b9ff0da38a82dcbd62a2e3186cd26922.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*_aXwRHURQuwaWtz1FUdDVw.png"/></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">跨培训、验证和测试数据集的品种分布</p></figure><p id="671e" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">再次检查以确保特征和目标处于良好状态。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj of"><img src="../Images/4f0ca353b8ec8218e018c85fd2c39da3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hvV8mar5vKXzZ0O-Mz2fPw.png"/></div></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">对功能和目标进行健全性检查</p></figure><p id="5a1b" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated"><a class="ae lo" href="#d2b8" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h2 id="14d4" class="ns lx ir bd ly nt nu dn mc nv nw dp mg lb nx ny mi lf nz oa mk lj ob oc mm od bi translated">第三步。图像数据预处理</h2><p id="763a" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">每个图像文件将被转换为ML ready格式，方法是将其调整为特定的图像形状(150，150)，然后将其展平为一维数组。这些将被保存为特征(X_train，X_val，X_test)。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="og oh l"/></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">通过OpenCV进行图像转换</p></figure><p id="5887" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">每个图像的品种将被一次热编码以成为标签(y_train，y_val，y_test)。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="og oh l"/></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">要素和标签的数据预处理</p></figure><p id="c5e8" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">快速视觉健全检查，以确保一切正常:</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj oi"><img src="../Images/f47a0641ec886bcafeade89c8b8d3063.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LhYDAInv8h_kXQA6cX4h6g.png"/></div></div></figure><p id="12f3" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated"><a class="ae lo" href="#d2b8" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h2 id="fb6b" class="ns lx ir bd ly nt nu dn mc nv nw dp mg lb nx ny mi lf nz oa mk lj ob oc mm od bi translated">第四步。基线模型训练</h2><p id="31ae" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">我从一开始就决定“随机森林”分类器将是我的基线模型。然而，我把这作为一个学习的机会，看看其他经典分类器与我的基线模型相比会有多好。</p><p id="d9c3" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">我创建了一个例程(Vanilla_ML_Run)来一起训练这四个分类器:</p><ul class=""><li id="cea7" class="mo mp ir ku b kv kw ky kz lb nm lf nn lj no ln np mw mx my bi translated"><a class="ae lo" href="https://scikit-learn.org/stable/modules/generated/sklearn.dummy.DummyClassifier.html" rel="noopener ugc nofollow" target="_blank">虚拟分类器</a></li><li id="3a90" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated"><a class="ae lo" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html" rel="noopener ugc nofollow" target="_blank">逻辑回归</a></li><li id="ff1b" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated"><a class="ae lo" href="https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.GaussianNB.html" rel="noopener ugc nofollow" target="_blank">高斯朴素贝叶斯</a></li><li id="de3c" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated"><a class="ae lo" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" rel="noopener ugc nofollow" target="_blank">随机森林</a>(我们的基线)</li></ul><p id="b056" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">一旦已训练的分类器被保存/重新加载，我将性能与以下进行比较:</p><ul class=""><li id="49eb" class="mo mp ir ku b kv kw ky kz lb nm lf nn lj no ln np mw mx my bi translated"><a class="ae lo" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html" rel="noopener ugc nofollow" target="_blank">分类报告</a></li><li id="1362" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated"><a class="ae lo" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html" rel="noopener ugc nofollow" target="_blank">混乱矩阵</a></li><li id="1d62" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated"><a class="ae lo" href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html#in-multi-label-settings" rel="noopener ugc nofollow" target="_blank">精确召回曲线</a></li><li id="5e5e" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated"><a class="ae lo" href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_roc.html#plot-roc-curves-for-the-multilabel-problem" rel="noopener ugc nofollow" target="_blank"> ROC曲线</a></li></ul><p id="76cd" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">NB:我强烈推荐阅读<a class="ae lo" rel="noopener" target="_blank" href="/what-metrics-should-we-use-on-imbalanced-data-set-precision-recall-roc-e2e79252aeba">这个</a>和<a class="ae lo" href="https://machinelearningmastery.com/roc-curves-and-precision-recall-curves-for-classification-in-python/" rel="noopener ugc nofollow" target="_blank">这个</a>来很好的把握PR和ROC曲线。还有<a class="ae lo" href="https://datascience.stackexchange.com/questions/15989/micro-average-vs-macro-average-performance-in-a-multiclass-classification-settin" rel="noopener ugc nofollow" target="_blank">这个</a>关于微观平均和宏观平均。</p></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h2 id="3cae" class="ns lx ir bd ly nt nu dn mc nv nw dp mg lb nx ny mi lf nz oa mk lj ob oc mm od bi translated">步骤4a。高斯NB分类器</h2><p id="fc2b" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">不用说，虚拟分类器做得不太好，显然，高斯分类器也是如此。“Silkie”和“Skinny”的准确率和召回率都很低。让我们以“Skinny”为例来看看:</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj oj"><img src="../Images/3143410d31db98c010f91b69964d51f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*50ZE9MZ0yg4YW7rzFMWD1w.png"/></div></figure><ul class=""><li id="d4d8" class="mo mp ir ku b kv kw ky kz lb nm lf nn lj no ln np mw mx my bi translated">这里的低精度意味着它的许多预测不是“瘦的”(假阳性)</li><li id="ce02" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">召回率低意味着许多真正的“瘦子”被错误地识别为其他品种(假阴性)</li></ul><p id="0060" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">混乱矩阵证实了这种理解。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj ok"><img src="../Images/a26895f617b55e4bd0b9a8e3d7387b4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OrOMfScMGr1IuG-R2MsiGQ.png"/></div></div></figure></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h2 id="afd3" class="ns lx ir bd ly nt nu dn mc nv nw dp mg lb nx ny mi lf nz oa mk lj ob oc mm od bi translated">步骤4b。逻辑回归分类器</h2><p id="c467" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">这种分类器的表现比GaussianNB好得多，GaussianNB的大多数精度和召回分数都在50以上或接近50。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj ol"><img src="../Images/3bb035898db2352e9b40dbc885103fb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*RTCO8nGwOFoqCxW5BtDeVA.png"/></div></figure><p id="1f05" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">然而，公关曲线似乎告诉了一个更清晰的故事，这种模式并没有表现得很好，特别是“瘦”。它的面积远不如其他的理想，它的曲线也偏离微观平均曲线最远。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj om"><img src="../Images/c03e0e2827c93e4181332de85176cfdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5a4wgC5dFaiSVZNHIFdpZw.png"/></div></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">不同品种的精确召回曲线(面积=平均值。精确分数)</p></figure></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h2 id="4ee0" class="ns lx ir bd ly nt nu dn mc nv nw dp mg lb nx ny mi lf nz oa mk lj ob oc mm od bi translated">步骤4c。随机森林分类器</h2><p id="f623" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">随机森林似乎是比逻辑回归更好的模型，尽管只是稍微好一点。看起来整体较高的分数是以“丝滑”和“骨瘦如柴”较低的回忆分数为代价的。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj on"><img src="../Images/19650156a99da8b69ee8c7bfb25ce3a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*agQ0PAjXUbEmaHPIJZm_cw.png"/></div></figure><p id="d5ed" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">F1分数和PR曲线强烈地表明，该模型对于较小的类(“丝滑”和“瘦”)表现得不是很好。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj oo"><img src="../Images/036e430bcc8f1c6dcbf4418ec406e313.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JpaTpNvu6YE7I6FOOR0Iuw.png"/></div></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">不同品种的精确召回曲线(面积=平均值。精确分数)</p></figure><p id="daeb" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated"><a class="ae lo" href="#d2b8" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h2 id="8b24" class="ns lx ir bd ly nt nu dn mc nv nw dp mg lb nx ny mi lf nz oa mk lj ob oc mm od bi translated">第五步。深度学习模型训练</h2><p id="37ce" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">既然我们已经训练和审查了我们的基线模型，我们接下来可以继续两个不同的DL模型，即:</p><ul class=""><li id="cba3" class="mo mp ir ku b kv kw ky kz lb nm lf nn lj no ln np mw mx my bi translated">多层图像CNN(卷积神经网络)</li><li id="9344" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">使用ImageNet上预先训练的权重转移从Inception V3开始的学习</li></ul><p id="3adb" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">一旦训练完毕，我会用和以前一样的标准来比较模型的表现。</p></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h2 id="6987" class="ns lx ir bd ly nt nu dn mc nv nw dp mg lb nx ny mi lf nz oa mk lj ob oc mm od bi translated">步骤5a。多层图像CNN大楼</h2><p id="3dee" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">该架构对于一个图像CNN模型来说相当简单，你可以从<a class="ae lo" href="https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ku is">这里</strong> </a>找到更多关于它的信息。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="og oh l"/></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">图像CNN模型架构</p></figure><p id="ede0" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">经过100个历元的训练，该模型达到了78%的训练准确率和67%的验证准确率。它肯定比基线模型更准确，但我认为它已经过度拟合了。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj op"><img src="../Images/fab1a0da8749a356a6d14698c27712ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*RA27I27SoRQ_F97SPFO48A.png"/></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">训练/验证准确度与历元数</p></figure><p id="11d5" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">我们来看看分类报告。与基线模型相比，总体分数令人信服地更好。令人惊讶的是，“瘦子”是最好的演员。没想到啊！</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj oq"><img src="../Images/367702d5e37f88ec0b47b9be4583de38.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*Gno1I-oaWTOHUys-lSQNog.png"/></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">分类报告</p></figure><p id="e951" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">有趣的是，其他品种的精确度和召回分数参差不齐。PR和ROC曲线也是如此。“瘦子”在其他班级中非常突出。训练出一个能够区分无毛豚鼠和有毛豚鼠的模型确实很酷。:)</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj or"><img src="../Images/0a37518387694cd087531351e009d566.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9BqOleEkjylPWt3luUx5mw.png"/></div></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">不同品种的精确召回曲线(面积=平均值。精确分数)</p></figure><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj os"><img src="../Images/6fd77b6fde9cf0902eaa4742860b031a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MPVC8fMdp4G2vSgeKEzYHw.png"/></div></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">受试者工作特征曲线(AUC =曲线下面积)</p></figure></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h2 id="1509" class="ns lx ir bd ly nt nu dn mc nv nw dp mg lb nx ny mi lf nz oa mk lj ob oc mm od bi translated">步骤5b。从InceptionV3 (ImageNet)转移学习</h2><p id="6c5b" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">这个模型是使用迁移学习技术构建的，如这里的<a class="ae lo" href="https://keras.io/applications/#fine-tune-inceptionv3-on-a-new-set-of-classes" rel="noopener ugc nofollow" target="_blank">T5T7】所示。它使用在</a><a class="ae lo" href="http://www.image-net.org/" rel="noopener ugc nofollow" target="_blank"> ImageNet </a>上预先训练的权重。对于这个特定的模型，我选择冻结前230层。</p><p id="acaf" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">经过100个历元的训练，该模型达到了99 %的训练准确率和82%的验证准确率。这肯定是过度拟合，起伏不定的验证曲线似乎也支持这一点。这也可能意味着我的数据仍然不够。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj ot"><img src="../Images/a287af7281373e6d4852bfb01b9faf00.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*AbxRJSce2pN_J33vTYsK1g.png"/></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">训练/验证准确度与历元数</p></figure><p id="7996" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">当我查看分类报告时，除了三个非常具体的问题，精确度和召回分数总体上都非常好。这个模型似乎倾向于将“红阿比”和“西尔基”误标为“美国人”。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj ou"><img src="../Images/d22ef4857c717e7d2d8d8dba62713647.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*2EhnmzL5gaRpeB1YqeD79Q.png"/></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">分类报告</p></figure><p id="0eac" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">混淆矩阵也支持这一观察。这位模特狂热地将“红阿比”(31岁)和“西尔基”(9岁)误标为“美国人”。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div class="gi gj ov"><img src="../Images/a7aba0cc2ce25064bbe21aaa1a041e63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*WYwMLFMvm_8yGYzdfvKo-A.png"/></div></figure><p id="6005" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">直觉上，这是有道理的。与“瘦子”不同，“红阿比”是短毛，“西尔基”是皮毛光滑，从某些角度看，这两个品种很容易被误认为是“美国人”。</p><p id="e88b" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">注意:当然，这也可能是一个简单的糟糕的原始图像的例子。我绝对想调查一下以确定。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj ow"><img src="../Images/77f10476b292b197c044dbde481bfcf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vW6i5SvR0xqWdGACDYY8jw.png"/></div></div></figure><p id="557e" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated"><a class="ae lo" href="#d2b8" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h2 id="1aab" class="ns lx ir bd ly nt nu dn mc nv nw dp mg lb nx ny mi lf nz oa mk lj ob oc mm od bi translated">第六步。模型比较和选择</h2><p id="30b5" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">InceptionV3迁移学习模式总体得分最高。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="og oh l"/></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">不同模型的度量比较</p></figure><p id="4472" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">最重要的是，它能够出色地分类“瘦”，而经典分类器通常都失败了(高召回率)。值得注意的是，没有一个模型能够自信地识别“红阿比”本身(低回忆)。似乎这个品种特有的<a class="ae lo" href="https://www.wideopenpets.com/everything-you-need-to-know-about-abyssinian-guinea-pigs/" rel="noopener ugc nofollow" target="_blank">玫瑰花结图案</a>并没有那么明显。可能需要获得更高质量的图像来改进。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="og oh l"/></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">不同模型的回忆分数比较</p></figure><p id="9bb8" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">深度学习模型能够在预测中巧妙地区分大多数品种(高精度)。</p><p id="e378" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">在所有模型中，只有“美国”遭受了类似的痛苦:在预测过程中，这些模型经常将其他品种视为“美国”(低精度)。DL型号稍微好一点，但也好不了多少。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="og oh l"/></div><p class="ni nj gk gi gj nk nl bd b be z dk translated">不同模型的精度分数比较</p></figure><p id="4573" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">当我们一起比较所有模型的PR曲线时，很明显我们有一个真正的赢家。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj ox"><img src="../Images/009a15d8a6a137719be7ae387d8a6015.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oxVF88LY2yN7Ku65WgtaOw.png"/></div></div></figure><p id="f5f8" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">类似地，迁移学习模型也以最好的ROC曲线开始。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj oy"><img src="../Images/a45fe36257e4005e73bdc7d67d8372d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dYURfynUFUMSvpBqqiBGDA.png"/></div></div></figure><p id="3d45" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">因此，通过迁移学习训练的最终模型显然是最佳候选。为了好玩，我甚至用它来预测保存在子文件夹“<em class="nr">/images/new _ samples”</em>中的超范围图像。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj oz"><img src="../Images/a2caf8bc13ec2c635cc87abf6d456fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kw0uIj4PQFnxrJkdgWnu4w.png"/></div></div></figure><p id="275c" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated"><a class="ae lo" href="#d2b8" rel="noopener ugc nofollow"> ^ </a></p></div><div class="ab cl lp lq hv lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ik il im in io"><h1 id="aa43" class="lw lx ir bd ly lz ma mb mc md me mf mg jx mh jy mi ka mj kb mk kd ml ke mm mn bi translated">结论</h1><p id="0749" class="pw-post-body-paragraph ks kt ir ku b kv mq js kx ky mr jv la lb ne ld le lf nf lh li lj ng ll lm ln ik bi translated">这无疑是一个奇妙而充满乐趣的项目。尽管我知道迁移学习会创造奇迹，但亲眼目睹它就发生在我眼前确实令人振奋。当我不得不处理一个小数据集时，这尤其令人鼓舞，这个数据集的大部分图像质量都很差。你能想象如果我们有更多的数据，更好的图像，这个模型会变得多好吗？</p><p id="bfbc" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">此外，深度学习模型特别“聪明”，能够区分“瘦”和其他品种。这是经典分类器无法做到的。同样，我没有用其他分类器进行测试，尤其是XGBoost。</p><p id="9064" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">对我来说这还不是结束。我非常希望将这个项目扩展到以下目标:</p><ul class=""><li id="0d1c" class="mo mp ir ku b kv kw ky kz lb nm lf nn lj no ln np mw mx my bi translated">添加更多高质量的图像</li><li id="a1ed" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">识别更多品种</li><li id="f96a" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">尝试其他分类器和预训练模型</li><li id="e45a" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">部署API</li><li id="cf45" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">创建一个网站</li><li id="ab89" class="mo mp ir ku b kv mz ky na lb nb lf nc lj nd ln np mw mx my bi translated">构建移动应用程序</li></ul><p id="bcb6" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">当网站或应用程序准备好了，我一定会在社交媒体上与其他豚鼠爱好者分享。</p><p id="cd61" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated">谢谢你阅读这篇文章，我希望你和我一样喜欢！</p><p id="051a" class="pw-post-body-paragraph ks kt ir ku b kv kw js kx ky kz jv la lb lc ld le lf lg lh li lj lk ll lm ln ik bi translated"><a class="ae lo" href="#d2b8" rel="noopener ugc nofollow"> ^ </a></p></div></div>    
</body>
</html>