<html>
<head>
<title>Training Tensorflow Object Detection API with custom dataset for working in Javascript and Vue.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用自定义数据集训练 Tensorflow 对象检测 API，以便在 Javascript 和 Vue.js 中工作</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/training-tensorflow-object-detection-api-with-custom-dataset-for-working-in-javascript-and-vue-js-6634e0f33e03?source=collection_archive---------5-----------------------#2020-02-21">https://towardsdatascience.com/training-tensorflow-object-detection-api-with-custom-dataset-for-working-in-javascript-and-vue-js-6634e0f33e03?source=collection_archive---------5-----------------------#2020-02-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><h1 id="63ac" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">开场白</h1><p id="464d" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">本文是 Gilbert Tanner 关于如何使用 Tensorflow 对象检测 API 创建自己的对象检测器的精彩教程的翻版。<br/>我遵循完全相同的步骤，但有一些不同，并添加了一些我在设置和训练中遇到的事情。</p><p id="59ec" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">我要感谢作者的原创内容，当然也要归功于他。</p><p id="5230" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">在这篇文章中，我们将使用 OS X + Anaconda 环境，这样就可以很容易地移植到谷歌云平台，例如，如果你愿意的话…另外使用 GPU 而不是 CPU 进行计算🚀</p><p id="70d4" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">我还必须说，我是在我的研究时间里开发了这个实验的，我在<a class="ae lm" href="https://manifiesto.biz/en" rel="noopener ugc nofollow" target="_blank"> Manifiesto </a>工作，在那里我是一名前端/在线开发人员🤗。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="a45f" class="jq jr it bd js jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn bi translated">设置工作 Python 环境</h1><p id="6925" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">从:<br/><a class="ae lm" href="https://www.anaconda.com/distribution/" rel="noopener ugc nofollow" target="_blank">https://www.anaconda.com/distribution/</a>下载并安装 Anaconda(在我的例子中，Python 3.7 适用于 OS X)</p><p id="c12f" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">对于我们马上要创建的新环境，我将使用实际的 Anaconda 安装附带的同一个 Python 版本。<br/>要知道哪个版本只需运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7251" class="mn jr it mj b gy mo mp l mq mr">conda info</span></pre><p id="3bf7" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">然后创建并激活环境:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="de49" class="mn jr it mj b gy mo mp l mq mr">conda create --name tf-object-detection python=3.7.4<br/>conda activate tf-object-detection</span></pre></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="e1df" class="jq jr it bd js jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn bi translated">安装 Tensorflow 对象检测 API</h1><p id="c40c" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq iu">安装 Tensorflow 模型和依赖关系</strong> <br/>选择一个您想要工作的文件夹，并创建一个名为<em class="ms"> tensorflow 的目录。我将在以下地点工作:</em></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="34ce" class="mn jr it mj b gy mo mp l mq mr">/Users/&lt;username&gt;/projects/tensorflow</span></pre><p id="1801" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">然后克隆 Tensorflow 模型存储库，运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7a53" class="mn jr it mj b gy mo mp l mq mr">git clone https://github.com/tensorflow/models</span></pre><p id="2f12" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">现在您需要安装所有的依赖项:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e9ac" class="mn jr it mj b gy mo mp l mq mr">conda install Cython<br/>conda install contextlib2<br/>conda install pillow<br/>conda install lxml<br/>conda install jupyter<br/>conda install matplotlib<br/>conda install tensorflow=1</span></pre><p id="02e7" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated"><strong class="kq iu">安装 COCO API </strong> <br/>为此，返回到您的<em class="ms">项目</em>文件夹，克隆 Github 项目库并执行以下命令:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="fd81" class="mn jr it mj b gy mo mp l mq mr">git clone <a class="ae lm" href="https://github.com/cocodataset/cocoapi.git" rel="noopener ugc nofollow" target="_blank">https://github.com/cocodataset/cocoapi.git</a><br/>cd cocoapi/PythonAPI<br/>make<br/>cp -r pycocotools &lt;path_to_tensorflow&gt;/models/research</span></pre><p id="6e9c" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated"><strong class="kq iu"> Protobuf 安装/编译</strong> <br/>这是因为 Tensorflow 对象检测 API 的使用。proto 文件，这些文件需要编译成。py 文件，以便对象检测 API 正常工作。Protobuf 可以编译这些文件。</p><p id="5a90" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">Protobuf 可以从:<br/><a class="ae lm" href="https://github.com/protocolbuffers/protobuf/releases" rel="noopener ugc nofollow" target="_blank">https://github.com/protocolbuffers/protobuf/releases</a><br/>将下载的文件放在你想要的任何地方，例如在<em class="ms">项目</em>文件夹中。</p><p id="92d8" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">提取之后，你需要进入<em class="ms"> models/research </em>并使用 protobuf 从<em class="ms"> object_detection/protos </em>目录下的 proto 文件中提取 python 文件。<br/>为此，我们将使用一个小脚本。<br/>保存在<em class="ms"> research </em>文件夹中，命名为<em class="ms"> use_protobuf.py </em></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="06fd" class="mn jr it mj b gy mo mp l mq mr">import os<br/>import sys<br/>args = sys.argv<br/>directory = args[1]<br/>protoc_path = args[2]<br/>for file in os.listdir(directory):<br/>    if file.endswith(".proto"):<br/>        os.system(protoc_path+" "+directory+"/"+file+" --python_out=.")</span></pre><p id="8c4b" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">然后你可以使用它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="735c" class="mn jr it mj b gy mo mp l mq mr">python use_protobuf.py &lt;path_to_directory&gt; &lt;path_to_protoc_file&gt;</span><span id="52d4" class="mn jr it mj b gy mt mp l mq mr"># for example in our particular case<br/>python use_protobuf.py object_detection/protos /Users/&lt;username&gt;/projects/protoc/bin/protoc</span></pre><p id="7e9b" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated"><strong class="kq iu">添加必要的环境变量</strong> <br/>我们需要将<em class="ms"> research </em>和<em class="ms"> research/slim </em>文件夹添加到我们的环境变量中，并运行<em class="ms"> setup.py </em>文件。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="b1b1" class="mn jr it mj b gy mo mp l mq mr">export PYTHONPATH=$PYTHONPATH:&lt;PATH_TO_TF&gt;/TensorFlow/models/research</span><span id="c125" class="mn jr it mj b gy mt mp l mq mr">export PYTHONPATH=$PYTHONPATH:&lt;PATH_TO_TF&gt;/TensorFlow/models/research/object_detection</span><span id="7e18" class="mn jr it mj b gy mt mp l mq mr">export PYTHONPATH=$PYTHONPATH:&lt;PATH_TO_TF&gt;/TensorFlow/models/research/slim</span></pre><p id="ed73" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">注意:每次关闭 shell 会话或停用 Anaconda 环境时，都需要添加<em class="ms"> $PYTHONPATH </em>环境变量。</p><p id="8bb9" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">现在导航到<em class="ms">tensor flow/models/research</em>并运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d843" class="mn jr it mj b gy mo mp l mq mr">python setup.py build<br/>python setup.py install</span></pre><p id="e4d6" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated"><strong class="kq iu">测试 Tensorflow 对象检测 API <br/> </strong>安装完成后，我们可以通过从<em class="ms"> object_detection </em>文件夹运行<em class="ms">Object _ Detection _ tutorial . ipynb</em>来测试一切是否正常。</p><p id="180f" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">注意:重要的是要考虑到本教程适用于 Tensorflow 2.0，并且您必须在您的环境中安装 tensor flow-如果没有，只需运行<em class="ms">conda install tensor flow = 2</em></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8675" class="mn jr it mj b gy mo mp l mq mr">jupyter notebook</span></pre><p id="17df" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">然后从浏览器窗口选择<em class="ms">object _ detection _ tutorial . ipynb</em>，按照说明操作即可。</p><p id="c159" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">您还可以通过在 python shell 中导入<em class="ms"> object_detection </em>来检查一切是否正常:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="5f4a" class="mn jr it mj b gy mo mp l mq mr">import object_detection</span></pre><p id="073b" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">如果没有错误，那么您可以假设一切都正常工作。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="0733" class="jq jr it bd js jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn bi translated">收集数据</h1><p id="104f" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">出于我们的目的，我们将使用一组代表 Jagermeister 酒瓶的图像。为了尽快做到这一点，我们将使用 python 脚本来废弃 google images，以实现流程自动化。</p><p id="bc85" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">脚本可以从<br/><a class="ae lm" href="https://github.com/hardikvasa/google-images-download" rel="noopener ugc nofollow" target="_blank">【https://github.com/hardikvasa/google-images-download】</a><br/>下载，例如将下载的文件放在<em class="ms">项目</em>文件夹中，命名为<em class="ms"> google-images-download </em>。</p><p id="7dfb" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">然后只需导航到 python 脚本所在的文件夹并执行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="30d4" class="mn jr it mj b gy mo mp l mq mr">python google_images_download.py --keywords "jagermeister bottle" --limit 100 --format jpg</span></pre><p id="cef4" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">因为图像的分辨率可能非常不同，有些可能相当大，我们希望缩放它们以更快地完成训练过程。<br/>下面是一个小脚本:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="f520" class="mn jr it mj b gy mo mp l mq mr">from PIL import Image<br/>import os<br/>import argparse</span><span id="a676" class="mn jr it mj b gy mt mp l mq mr">def rescale_images(directory, size):<br/>    for img in os.listdir(directory):<br/>        im = Image.open(directory+img)<br/>        im_resized = im.resize(size, Image.ANTIALIAS)<br/>        im_resized.save(directory+img)</span><span id="5932" class="mn jr it mj b gy mt mp l mq mr">if __name__ == '__main__':<br/>    parser = argparse.ArgumentParser(description="Rescale images")<br/>    parser.add_argument('-d', '--directory', type=str, required=True, help='Directory containing the images')<br/>    parser.add_argument('-s', '--size', type=int, nargs=2, required=True, metavar=('width', 'height'), help='Image size')<br/>    args = parser.parse_args()<br/>    rescale_images(args.directory, args.size)</span></pre><p id="91c5" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">要使用该脚本，我们需要保存它，例如，用名称<em class="ms">transform _ image _ resolution . py</em>保存，然后进入命令行并键入:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2a0f" class="mn jr it mj b gy mo mp l mq mr">python transform_image_resolution.py -d &lt;image_dir&gt;/ -s 800 600</span></pre><p id="513b" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">注意:<em class="ms"> image_dir </em>文件夹中的图像将被覆盖，因此如果需要，请进行备份。</p><p id="c674" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">注意:重要的是要检查下载的图像文件夹，以避免重复和删除损坏的文件，如果有的话。</p><h1 id="0a5d" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">标签数据</h1><p id="361b" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在，我们必须将大约 80%的图像移动到<em class="ms">目标 _ 检测/图像/训练</em>目录中，将另外 20%的图像移动到<em class="ms">目标 _ 检测/图像/测试</em>目录中。</p><p id="aa37" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">为了标记我们的数据，我们需要某种标记软件。<br/>在这个特殊的例子中，我们将使用 LabelImg。</p><p id="d45d" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">就我们使用 Anaconda 而言，我们只需要遵循以下说明:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="264b" class="mn jr it mj b gy mo mp l mq mr"># install pyqt (version 5)<br/>conda install pyqt</span><span id="ae3b" class="mn jr it mj b gy mt mp l mq mr"># download LabelImg and place it in 'projects' folder<br/>git clone <a class="ae lm" href="https://github.com/tzutalin/labelImg.git" rel="noopener ugc nofollow" target="_blank">https://github.com/tzutalin/labelImg.git</a></span><span id="62f3" class="mn jr it mj b gy mt mp l mq mr"># navigate to labelImg directory<br/>cd labelImg</span><span id="3e81" class="mn jr it mj b gy mt mp l mq mr"># execute labelImg.py<br/>make qt5py3;./labelImg.py</span></pre><p id="82a2" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">打开每个<em class="ms">训练</em>和<em class="ms">测试</em>文件夹，然后使用“创建矩形盒”按钮标记每个图像，并点击保存。我们将为每个箱子使用“<em class="ms"> jagermeister 瓶”</em>标签。<br/>保存后，您将看到一个 XML 文件出现在相同的目录中，与我们刚刚标记的图像同名。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="0c3f" class="jq jr it bd js jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn bi translated">为培训生成 TFRecords</h1><p id="f630" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">为了创建 TFRecords，我们将使用 Dat Tran 的浣熊探测器中的两个脚本；<em class="ms"> xml_to_csv.py </em>和<em class="ms"> generate_tfrecord.py </em>文件。<br/>下载并放置在<em class="ms"> object_detection </em>文件夹中。你可以去下面的<em class="ms">参考资料</em>部分，看看我是从哪里下载的。</p><p id="0c9f" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">我们现在需要修改<em class="ms"> xml_to_csv.py </em>脚本，这样我们就可以正确地将创建的 xml 文件转换成 csv 文件。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3757" class="mn jr it mj b gy mo mp l mq mr"># Old:<br/>def main():<br/>    image_path = os.path.join(os.getcwd(), 'annotations')<br/>    xml_df = xml_to_csv(image_path)<br/>    xml_df.to_csv('raccoon_labels.csv', index=None)<br/>    print('Successfully converted xml to csv.')</span><span id="cb2a" class="mn jr it mj b gy mt mp l mq mr"># New:<br/>def main():<br/>    for folder in ['train', 'test']:<br/>        image_path = os.path.join(os.getcwd(), ('images/' + folder))<br/>        xml_df = xml_to_csv(image_path)<br/>        xml_df.to_csv(('images/'+folder+'_labels.csv'), index=None)<br/>        print('Successfully converted xml to csv.')</span></pre><p id="8f7f" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">然后，我们可以使用脚本打开命令行并键入:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c19a" class="mn jr it mj b gy mo mp l mq mr">python xml_to_csv.py</span></pre><p id="56bb" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">正如您所看到的，在<em class="ms">图像</em>目录中创建了两个文件。一个名为<em class="ms"> test_labels.csv </em>另一个名为<em class="ms"> train_labels.csv </em></p><p id="05f0" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">注:如果你得到“没有模块名为'熊猫'”的错误，只需做一个<em class="ms"> conda 安装熊猫</em>。</p><p id="cf1e" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">在将这些 csv 文件转换为 TFRecords 之前，我们需要更改 generate_tfrecords.py 脚本。</p><p id="f9a7" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">出发地:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="95c5" class="mn jr it mj b gy mo mp l mq mr"># TO-DO replace this with label map<br/>def class_text_to_int(row_label):<br/>    if row_label == 'raccoon':<br/>        return 1<br/>    else:<br/>        None</span></pre><p id="754a" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">收件人:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="80cc" class="mn jr it mj b gy mo mp l mq mr">def class_text_to_int(row_label):<br/>    if row_label == 'jagermeister bottle':<br/>        return 1<br/>    else:<br/>        None</span></pre><p id="cd6b" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">现在，可以通过键入以下命令来生成 TFRecords:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="99e0" class="mn jr it mj b gy mo mp l mq mr"># train tfrecord<br/>python generate_tfrecord.py --csv_input=images/train_labels.csv --image_dir=images/train --output_path=train.record</span><span id="c6b1" class="mn jr it mj b gy mt mp l mq mr"># test tfrecord<br/>python generate_tfrecord.py --csv_input=images/test_labels.csv --image_dir=images/test --output_path=test.record</span></pre><p id="2c46" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">这两个命令生成一个<em class="ms">训练记录</em>和一个<em class="ms">测试记录</em>文件，可用于训练我们的目标探测器。</p><p id="9277" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">注意:如果得到“模块 tensorflow 没有属性 app”这样的错误是因为你在使用 Tensorflow 2.0 所以我们需要在<em class="ms"> generate_tfrecord.py </em>文件中修改一行。</p><p id="98f8" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">出发地:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ba99" class="mn jr it mj b gy mo mp l mq mr"># line 17<br/>import tensorflow as tf</span></pre><p id="f4f4" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">收件人:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0f1c" class="mn jr it mj b gy mo mp l mq mr"># line 17<br/>import tensorflow.compat.v1 as tf</span></pre><p id="320e" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">或者，如果您愿意，可以回滚到 Tensorflow 1.0，而不是:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="34d5" class="mn jr it mj b gy mo mp l mq mr">conda remove tensorflow<br/>conda install tensorflow=1</span></pre><h1 id="ab81" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">配置培训</h1><p id="faa5" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在开始培训之前，我们需要创建一个标签映射和一个培训配置文件。</p><p id="ffbc" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated"><strong class="kq iu">创建标签映射</strong> <br/>标签映射将 id 映射到名称。我们将把它放在位于<em class="ms"> object_detection </em>目录下的一个名为<em class="ms"> training </em>的文件夹中，文件名为<em class="ms"> labelmap.pbtxt </em></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="248b" class="mn jr it mj b gy mo mp l mq mr">item {<br/>    id: 1<br/>    name: 'jagermeister bottle'<br/>}</span></pre><p id="c7db" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">每个项目的 id 号应该与<em class="ms"> generate_tfrecord.py </em>文件中指定项目的 id 相匹配。</p><p id="93c4" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated"><strong class="kq iu">创建培训配置</strong> <br/>现在我们需要创建一个培训配置文件。<br/>我们将使用<em class="ms">fast _ rcnn _ inception _ v2 _ coco</em>模型，该模型可从:<br/><a class="ae lm" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/detection_model_zoo.md" rel="noopener ugc nofollow" target="_blank">https://github . com/tensor flow/models/blob/master/research/object _ detection/g3doc/detection _ model _ zoo . MD</a>下载</p><p id="db7c" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">下载并解压缩文件，将其放入<em class="ms"> object_detection </em>文件夹。<br/>文件夹名称看起来会像<em class="ms">faster _ rcnn _ inception _ v2 _ coco _ 2018 _ 01 _ 28</em></p><p id="672c" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">我们将从名为<em class="ms">faster _ rcnn _ inception _ v2 _ pets . config</em>的示例配置文件开始，该文件可以在示例文件夹中找到。<br/>可以从:<br/><a class="ae lm" href="https://github.com/tensorflow/models/tree/master/research/object_detection/samples/configs" rel="noopener ugc nofollow" target="_blank">https://github . com/tensor flow/models/tree/master/research/object _ detection/samples/configs</a>下载</p><p id="e7ac" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">保持相同的名称，将其保存到<em class="ms">培训</em>文件夹中，用文本编辑器打开，以便更改几行代码。</p><p id="01e3" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">第 9 行<em class="ms"> : </em>将类别数量更改为您想要检测的对象数量(在我们的示例中为 1)。</p><p id="f067" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">第 106 行:将<em class="ms">微调检查点</em>改为<em class="ms"> model.ckpt </em>文件的路径</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="bfea" class="mn jr it mj b gy mo mp l mq mr">fine_tune_checkpoint:<br/>"/Users/&lt;username&gt;/projects/tensorflow/models/research/object_detection/faster_rcnn_inception_v2_coco_2018_01_28/model.ckpt"</span></pre><p id="8617" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">第 123 行:将<em class="ms"> input_path </em>改为<em class="ms"> train.record </em>文件的路径:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="89b2" class="mn jr it mj b gy mo mp l mq mr">input_path:<br/>"/Users/&lt;username&gt;/projects/tensorflow/models/research/object_detection/train.record</span></pre><p id="6a6d" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">第 135 行:将<em class="ms">输入路径</em>改为<em class="ms">测试记录</em>文件的路径:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ff8a" class="mn jr it mj b gy mo mp l mq mr">input_path:<br/>"/Users/&lt;username&gt;/projects/tensorflow/models/research/object_detection/test.record</span></pre><p id="1dee" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">第 125-137 行:将<em class="ms">标签地图路径</em>改为标签地图文件的路径:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="baf9" class="mn jr it mj b gy mo mp l mq mr">label_map_path:<br/>"/Users/&lt;username&gt;/projects/tensorflow/models/research/object_detection/training/labelmap.pbtxt</span></pre><p id="4c38" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">第 130 行:将<em class="ms"> num_example </em>更改为测试文件夹中图像的数量。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d27c" class="mn jr it mj b gy mo mp l mq mr">num_examples: 10</span></pre><h1 id="481e" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">培训模式</h1><p id="0d57" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们将使用位于<em class="ms">object _ detection/legacy</em>文件夹中的<em class="ms"> train.py </em>文件。我们将把它复制到<em class="ms"> object_detection </em>文件夹中，然后在命令行中键入以下内容:</p><p id="c022" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">更新:或者我们可以使用<em class="ms"> object_detection </em>文件夹中的<em class="ms"> model_main.py </em>文件来代替。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="e344" class="mn jr it mj b gy mo mp l mq mr">python model_main.py --logtostderr --model_dir=training/ --pipeline_config_path=training/faster_rcnn_inception_v2_pets.config</span></pre><p id="0e54" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">如果一切都设置正确，训练应该很快开始。</p><p id="69cf" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">注意:如果你得到一个类似“模块 tensorflow 没有属性 contrib”的错误是因为你正在使用 Tensorflow 2.0。有两种方法可以解决这个问题:</p><ol class=""><li id="8e37" class="mu mv it kq b kr ln kv lo kz mw ld mx lh my ll mz na nb nc bi translated">更新用于 Tensorflow 2.0 的脚本</li><li id="fbaa" class="mu mv it kq b kr nd kv ne kz nf ld ng lh nh ll mz na nb nc bi translated">回滚到 Tensorflow 1.0</li></ol><p id="be45" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">最简单的方法是执行回滚，因此请执行以下操作</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8a56" class="mn jr it mj b gy mo mp l mq mr"># uninstall Tensorflow 2.0<br/>conda remove tensorflow</span><span id="2499" class="mn jr it mj b gy mt mp l mq mr"># install Tensorflow 1.X<br/>conda install tensorflow=1</span></pre><h1 id="9ff6" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">培训模式进展</h1><p id="6133" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">一旦训练开始，你会每隔 5 分钟左右(取决于你的硬件)看到当前的损失被记录到 Tensorboard。我们可以通过打开第二个命令行来打开 Tensorboard，导航到<em class="ms"> object_detection </em>文件夹并键入:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2a9a" class="mn jr it mj b gy mo mp l mq mr">tensorboard --logdir=training</span></pre><p id="c14f" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">现在在 localhost:6006 打开一个网页</p><p id="df34" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">你应该训练模型，直到它达到一个令人满意的损失。<br/>按 Ctrl+C 可以终止训练过程</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="c732" class="jq jr it bd js jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn bi translated">导出推理图</h1><p id="b4bb" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">一旦模型被训练，我们需要生成一个推理图，它可以用来运行模型。为此，我们需要首先找出保存的最高步骤编号。<br/>为此，我们需要导航到培训目录，寻找索引最大的<em class="ms"> model.ckpt </em>文件。</p><p id="2ff2" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">然后，我们可以通过在命令行中键入以下命令来创建推理图:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="855d" class="mn jr it mj b gy mo mp l mq mr">python export_inference_graph.py --input_type image_tensor --pipeline_config_path training/faster_rcnn_inception_v2_pets.config --trained_checkpoint_prefix training/model.ckpt-XXXX --output_directory inference_graph</span></pre><p id="2670" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">其中 XXXX 代表最高的数字。</p><h1 id="3807" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">将保存的模型转换为 TensorflowJS</h1><p id="4a76" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">首先，我们需要在我们的环境中安装 TensorflowJS。<br/>通常我们会使用<em class="ms"> conda </em>来安装包，但不幸的是在资源库中没有。<br/>所以我们将通过 python pip 来使用它:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="994b" class="mn jr it mj b gy mo mp l mq mr">pip install tensorflowjs</span></pre><p id="8dad" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">安装完成后，我们可以执行以下命令，以便将我们保存的模型转换为 tensorfowjs 能够理解的内容:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="b548" class="mn jr it mj b gy mo mp l mq mr">tensorflowjs_converter --input_format=tf_saved_model &lt;input_dir&gt; &lt;output_dir&gt;</span></pre><p id="fabf" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">例如，如果我们在目录<em class="ms">/Users/&lt;username&gt;/projects/tensor flow/models/research/object _ detection</em>中，我们可以运行如下内容:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1516" class="mn jr it mj b gy mo mp l mq mr">tensorflowjs_converter --input_format=tf_saved_model --output_node_names='detection_boxes,detection_classes,detection_features,detection_multiclass_scores,detection_scores,num_detections,raw_detection_boxes,raw_detection_scores' --saved_model_tags=serve --output_format=tfjs_graph_model inference_graph/saved_model inference_graph/web_model</span></pre><p id="c827" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">请注意，转换选项是专门为转换对象检测 SavedModel 而设置的，并且已经使用<em class="ms"> saved_model_cli </em>命令检索了<em class="ms"> output_node_names </em>配置:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="4128" class="mn jr it mj b gy mo mp l mq mr">saved_model_cli show --dir inference_graph/saved_model --tag_set serve --signature_def serving_default</span><span id="e758" class="mn jr it mj b gy mt mp l mq mr">#output will print something like this:<br/>#detection_boxes<br/>#detection_classes<br/>#detection_features<br/>#detection_multiclass_scores<br/>#detection_scores<br/>#num_detections<br/>#raw_detection_boxes<br/>#raw_detection_scores</span></pre><p id="983d" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">在下面的<em class="ms">参考</em>部分中对要点进行了全面解释。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="b19b" class="jq jr it bd js jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn bi translated">在 Vue.js 应用程序上测试模型</h1><p id="3443" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在我们已经正确地转换了模型，我们可以在运行 Javascript 的 web 应用程序环境中使用它。<br/>为了让事情变得更顺利，我们可以使用下面<em class="ms">参考文献</em>部分中列出的演示应用程序。<br/>您正在寻找的存储库是<strong class="kq iu">adriagil/tfjs-vue-example</strong></p><p id="3477" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">我必须停下来一会儿，感谢<em class="ms">fresh someone</em>分享这个伟大的 Vue.js 演示应用程序，它使用预先训练的 coco-ssd 模型，在浏览器中与网络摄像头一起使用。我刚刚修改了代码，以便与我训练过的模型一起工作，主要包括如何提供和加载模型，以及如何检索所需的张量来分析数据。<br/>这里有原 app 如果你感兴趣<a class="ae lm" href="https://github.com/freshsomebody/tfjs-coco-ssd-vue-example" rel="noopener ugc nofollow" target="_blank">https://github.com/freshsomebody/tfjs-coco-ssd-vue-example</a></p><p id="240c" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">只需导航到那里，并在您的首选位置克隆或下载。<br/>然后将上一步转换后的模型复制到下载项目的根目录下，<em class="ms"> web_model </em>文件夹。</p><p id="e7e7" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">然后导航到应用程序根目录并运行:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="6af7" class="mn jr it mj b gy mo mp l mq mr">npm install</span></pre><p id="d6e3" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">完成后，在你选择的文本编辑器中打开<em class="ms"> App.vue </em>文件。<br/>您现在可以看到 web 应用程序的源代码了，太棒了！🍺</p><p id="48ed" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">为了正确加载转换后的模型，我们需要通过 web 服务器来完成。<br/>我们将使用一个节点包来完成所谓的<em class="ms"> http-server </em>。<br/>我们需要做的就是使用以下命令激活 web 服务器:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0830" class="mn jr it mj b gy mo mp l mq mr">node_modules/http-server/bin/http-server -c1 --cors .</span></pre><p id="e42d" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">并且可以通过 http 在<a class="ae lm" href="http://localhost:8081/web_model/model.json" rel="noopener ugc nofollow" target="_blank"> <em class="ms">访问模型 http://localhost:8081/web _ model/model . JSON</em></a><em class="ms"/>加载到浏览器中。</p><p id="e263" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">最后但同样重要的是，我们需要编译或<em class="ms">服务</em>前端应用程序，用下面的命令测试一切:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="5a6f" class="mn jr it mj b gy mo mp l mq mr">npm run serve</span></pre><p id="8d3a" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">在<a class="ae lm" href="http://localhost:8080" rel="noopener ugc nofollow" target="_blank"> http://localhost:8080 </a>中，您现在应该会看到网络摄像头流和相应的包围红色 Jaggermeister 瓶子的边框。<br/>太棒了，我们完成了！👏👏👏</p><figure class="me mf mg mh gt nj gh gi paragraph-image"><div role="button" tabindex="0" class="nk nl di nm bf nn"><div class="gh gi ni"><img src="../Images/bd9a24744d7c0dda66c4c41dd64f6f0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*Sox_wrmXbdsDkreb5n8tHQ.png"/></div></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">万岁 90%的检测分数🎉</p></figure><h1 id="4383" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">结论</h1><p id="cf44" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">尽管这次经历的结果还不错，但有 2 件重要的事情需要考虑。</p><p id="442d" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">第一，在 OS X 工作不是最好的选择。<br/>我建议你转换到 Linux 或 Windows 环境，但前提是你要使用 GPU，否则也是一样的废话😅<br/>一个更好的解决方案(我们知道合适的 GPU 卡非常昂贵)是在<a class="ae lm" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云平台</a>上完成。他们提供了一个非常好的环境和免费的学分供你在任何训练实验中使用。</p><p id="1d82" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">第二件糟糕的事情是，我们选择的初始模型是精确的，但是在电脑浏览器上非常慢，在移动设备上更差。所以我现在正在训练另一个基于 MobileNet 的模型，它应该会表现得更好🤞希望如此。<br/>我的模型也没有优化，也许这有所帮助，但我需要做一些研究如何实现它。我们走着瞧。</p><p id="ec6c" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">如果你喜欢，想要更多这样的或有任何问题，请不要犹豫与我联系…如果你来到这里，你值得拥有它！再次感谢激励我写这篇文章的作者们。</p><p id="636b" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">那都是乡亲们！</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><p id="bb1c" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated"><em class="ms">【2020 年 2 月 24 日更新】</em> <br/>正如我之前所说，网络浏览器的性能对于实时视频分析来说是不可接受的，所以我决定做一些研究。</p><p id="adc3" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">感谢 stackoverflow 社区，我找到了许多建议，比如优化模型或使用另一个模型再次返回培训流程。我决定尝试另一个模型，因为我训练的 rcnn-inception 模型非常精确，但并没有真正考虑到我需要的应用程序。</p><p id="8f32" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">我这次挑的是<em class="ms"> ssd_mobilenet_v2_coco </em>。<br/>经过一个周末的模型训练和近 30000 步——我知道这对开发来说不是必需的，但值得在真实情况下尝试——是测试的时候了。结果远远好于我的第一次尝试，所以现在预测率几乎与可接受的帧速率流体。</p><p id="c50b" class="pw-post-body-paragraph ko kp it kq b kr ln kt ku kv lo kx ky kz lp lb lc ld lq lf lg lh lr lj lk ll im bi translated">所以吸取教训；在训练前选择合适的模型来满足你的需求。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="f428" class="jq jr it bd js jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn bi translated">参考</h1><div class="nu nv gp gr nw nx"><a href="https://github.com/adriagil/tfjs-vue-example" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">adriagil/tfjs-vue-示例</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">用 Vue.js 制作的演示应用程序，用于在浏览器中使用定制的 Tensorflow 图形模型…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">github.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol no nx"/></div></div></a></div><figure class="me mf mg mh gt nj"><div class="bz fp l di"><div class="om on l"/></div><p class="nq nr gj gh gi ns nt bd b be z dk translated">将 TF 模型转换为 TFJS 模型的代码段</p></figure><div class="nu nv gp gr nw nx"><a href="https://gilberttanner.com/blog/installing-the-tensorflow-object-detection-api" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">安装 Tensorflow 对象检测 API</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">更新 Dez/2019:安装现已推出 Jupyter 笔记本。2019 年 11 月更新:试用 Tensorflow v2.0 和…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">gilberttanner.com</p></div></div><div class="og l"><div class="oo l oi oj ok og ol no nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a rel="noopener follow" target="_blank" href="/creating-your-own-object-detector-ad69dda69c85"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">创建您自己的对象检测器</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">使用 Tensorflow 对象检测 API 创建您自己的对象检测器</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">towardsdatascience.com</p></div></div><div class="og l"><div class="op l oi oj ok og ol no nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://github.com/datitran/raccoon_dataset" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">datit ran/浣熊数据集</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">这是我收集的数据集，用于使用 TensorFlow 的对象检测 API 训练我自己的浣熊检测器。图像是…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">github.com</p></div></div><div class="og l"><div class="oq l oi oj ok og ol no nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://github.com/hardikvasa/google-images-download" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">hardikvasa/Google-图片-下载</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">用于“搜索”和“下载”数百张谷歌图片到本地硬盘的 Python 脚本！这个程序让你…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">github.com</p></div></div><div class="og l"><div class="or l oi oj ok og ol no nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://stackoverflow.com/questions/58258003/attributeerror-module-tensorflow-has-no-attribute-app" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">AttributeError:模块“tensorflow”没有属性“app”</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">感谢贡献一个堆栈溢出的答案！请务必回答问题。提供详细信息并分享…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">stackoverflow.com</p></div></div><div class="og l"><div class="os l oi oj ok og ol no nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://stackoverflow.com/questions/55870127/module-tensorflow-has-no-attribute-contrib" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">模块“tensorflow”没有属性“contrib”</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">感谢贡献一个堆栈溢出的答案！请务必回答问题。提供详细信息并分享…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">stackoverflow.com</p></div></div><div class="og l"><div class="ot l oi oj ok og ol no nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://stackoverflow.com/questions/59719522/running-object-detection-using-tensorflow-js" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">使用 Tensorflow.js 运行对象检测</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">我正在使用 Tensorflow.js 进行对象检测。我正在尝试在…中运行自定义对象检测 tensorflow.js 模型</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">stackoverflow.com</p></div></div><div class="og l"><div class="ou l oi oj ok og ol no nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://github.com/tensorflow/tfjs/issues/193" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">输入看起来形状错误问题#193 tensorflow/tfjs</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">要从社区获得帮助，请查看我们的 Google 群组。TensorFlow.js 版本通过 Yarn 安装。var 版本=…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">github.com</p></div></div><div class="og l"><div class="ov l oi oj ok og ol no nx"/></div></div></a></div><div class="nu nv gp gr nw nx"><a href="https://github.com/tensorflow/tfjs/issues/1683" rel="noopener  ugc nofollow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd iu gy z fp oc fr fs od fu fw is bi translated">执行转换后的 SSD _ mobilenet _ v2 _ oid _ v4 _ 2018 _ 12 _ 12 模型时出现“输入张量计数不匹配”</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">解散 GitHub 是超过 4000 万开发者的家园，他们一起工作来托管和审查代码，管理项目，以及…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">github.com</p></div></div><div class="og l"><div class="ow l oi oj ok og ol no nx"/></div></div></a></div></div></div>    
</body>
</html>