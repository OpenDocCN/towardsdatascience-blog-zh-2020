<html>
<head>
<title>Predicting Hourly Energy consumption of San Diego — I</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">圣地亚哥每小时能耗预测— I</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/part-1-time-series-analysis-predicting-hourly-energy-consumption-of-san-diego-short-term-long-3a1dd1a589c9?source=collection_archive---------32-----------------------#2020-06-01">https://towardsdatascience.com/part-1-time-series-analysis-predicting-hourly-energy-consumption-of-san-diego-short-term-long-3a1dd1a589c9?source=collection_archive---------32-----------------------#2020-06-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0408" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我们将涵盖从不同来源导入和合并数据集、重采样、数据清理、EDA和推理。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/09cd9c73c82134ed17e37ee55d0e720a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jh2ogGte4UEBjIwJ"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">马克斯·本德在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="547d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文的第1部分将讨论能源(电力)消耗的基础知识，如何导入、重新采样和合并从不同来源(EDA)收集的数据集，并从圣地亚哥的能源消耗数据中得出一些基本推论。如果你只对建模部分感兴趣，那么请直接跳到这篇文章的<a class="ae kv" href="https://medium.com/@Pratha_P/part-2-time-series-analysis-predicting-hourly-energy-consumption-of-san-diego-ii-f09665796c9" rel="noopener">第二部分</a>。</p><div class="ls lt gp gr lu lv"><a rel="noopener follow" target="_blank" href="/part-2-time-series-analysis-predicting-hourly-energy-consumption-of-san-diego-ii-f09665796c9"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">圣地亚哥每小时能源消耗预测(短期和长期预测)——II</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">时间序列基础&amp;使用傅立叶级数处理多重季节性。使用(S)ARIMA(X)与线性预测…</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">towardsdatascience.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><p id="3ec2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这些文章(第一部分和第二部分)中，我们将涵盖短期(一小时前和一周前)和长期(几个月前)预测。</p><p id="7e76" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">nbviewer上Jupyter笔记本的链接:<br/> 1。<a class="ae kv" href="https://nbviewer.jupyter.org/github/pratha19/Springboard_capstone_project_1/blob/master/SDGE_energy_EDA.ipynb#4" rel="noopener ugc nofollow" target="_blank">数据导入和EDA </a>(本帖涵盖)<br/> 2。<a class="ae kv" href="https://nbviewer.jupyter.org/github/pratha19/Springboard_capstone_project_1/blob/master/SDGE_energy_ML.ipynb#8" rel="noopener ugc nofollow" target="_blank">构建ML模型和预测</a>(在第2部分帖子中讨论)</p><p id="a61c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">整个项目的Github链接:<a class="ae kv" href="https://github.com/pratha19/Hourly_Energy_Consumption_Prediction" rel="noopener ugc nofollow" target="_blank">小时_能耗_预测</a>。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h2 id="7812" class="mr ms iq bd mt mu mv dn mw mx my dp mz lf na nb nc lj nd ne nf ln ng nh ni nj bi translated">介绍</h2><p id="1c30" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">电力公司需要努力提前规划其发电厂中发电机组的分配，以匹配其区域能源需求，因为如果需求高于发电量，则可能导致几次停电，从而导致巨大的经济损失；另一方面，如果发电量高于需求，额外的电力将被浪费，并且还会在输电线路上产生不必要的负载。</p><p id="8324" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，对于公用事业来说，预测能源消耗以便能够分配适当的资源来满足其需求是非常重要的。一年、一个月或一天的预测可以帮助电力公司规划更长的时间范围，但对于更平稳的日常操作，每小时(甚至更好)的预测可能非常有用。例如，如果电厂运营商得到下一个小时的高能源预测，他们可以通过打开更多的电厂来增加能源供应。</p><p id="bcd3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个项目中，我们将分析<a class="ae kv" href="https://www.sdge.com/" rel="noopener ugc nofollow" target="_blank"> SDGE </a>电力公司过去5年的每小时能耗数据，以发现一天中的小时、一周中的天、一年中的季节等的能耗趋势。，并检查外部温度和该地区的太阳能装置等因素是否会影响能源消耗。</p><p id="b51c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">电力公司可以利用开发的预测模型来有效地规划他们的发电操作，并平衡需求和适当的供应。</p><h2 id="cbd1" class="mr ms iq bd mt mu mv dn mw mx my dp mz lf na nb nc lj nd ne nf ln ng nh ni nj bi translated">一些能源术语</h2><ul class=""><li id="67ea" class="np nq iq ky b kz nk lc nl lf nr lj ns ln nt lr nu nv nw nx bi translated">瞬时负载也称为需求，以瓦特(W、kW、MW、GW等)为单位。).</li><li id="56b8" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">一段时间内消耗或产生的能量以瓦特小时(Wh、kWh、MWh、GWh等)计量。)</li><li id="2e3d" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">因为我们将使用的数据是1小时间隔数据，所以在该间隔期间的需求和能量将是相同的。因此，我们将在本文中交替使用能源和需求术语。如果你想潜得更深，请参考这个<a class="ae kv" href="https://www.ovoenergy.com/guides/energy-guides/what-is-a-kwh-kw-and-kwh-explained.html" rel="noopener ugc nofollow" target="_blank">链接</a>。<br/>注:峰值或最大负荷决定了一个电网所需的容量。例如，假设一个城市在365x24小时内的平均负荷是10MW，但是在这365x24小时内的任何时刻观察到或可能观察到的最大峰值负荷是20MW，那么该城市的发电厂基础设施(包括所有电源)的内置容量应该至少是20MW。因此，平均而言，任何地区的发电装机容量都远大于该地区的平均预期需求。</li></ul><p id="08a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">术语说够了，让我们把剩下的“我们的能量”<em class="od"> </em>用于构建一些时间序列模型。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h2 id="fd63" class="mr ms iq bd mt mu mv dn mw mx my dp mz lf na nb nc lj nd ne nf ln ng nh ni nj bi translated">导入圣地亚哥地区的能耗数据</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/0a093c1bef4401bc86a0953aefbd5228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*o7N3SdCIpejnYyV5qB1B_Q.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://westerngrid.net/wcea/wp-content/uploads/2016/07/governance-figure1-CAISO-util.png" rel="noopener ugc nofollow" target="_blank">加州参与的公用事业地图</a>(对于这个项目，我们将关注底部标记为圣地亚哥天然气和电力— SDGE的红色区域)</p></figure><p id="67c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">导入数据:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">该代码导入在<a class="ae kv" href="http://www.caiso.com/Pages/default.aspx" rel="noopener ugc nofollow" target="_blank"> CAISO </a>地区运行的所有电力公司的每小时能耗数据，即PGE、SCE、SDGE和VEA。它还包括CAISO总消耗量数据。</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/cb9442be55e1684df2bdd55c2ff9be0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*FR3GZ4gOwIZD_OAUxhCh7g.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">检查数据是否已正确导入。</p></figure><p id="2dc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同样，我们也可以检查2014-2017年的数据。</p><p id="a355" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意:在项目进行的时候，数据只提供到2019年7月，但如果你现在检查(2020年5月)，2019年所有月份的数据都在网站上提供。这篇文章中显示的分析只考虑了2014-2018年的全年数据，但使用相同的代码可以很容易地添加2019年的剩余月份。</p><blockquote class="oi oj ok"><p id="b75c" class="kw kx od ky b kz la jr lb lc ld ju le ol lg lh li om lk ll lm on lo lp lq lr ij bi translated">N <!-- -->注:(2022年5月更新)。我注意到2019年之前数据的存档链接不再活跃，我也无法在网站上找到更新的链接。但是自2020年以来，产生了更多的数据，并且<a class="ae kv" href="http://www.caiso.com/planning/Pages/ReliabilityRequirements/Default.aspx" rel="noopener ugc nofollow" target="_blank">链接</a>中的“EMS的历史每小时负荷数据”部分具有从2019年1月到2022年年中的数据，这对于该项目来说应该足够了。</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">从网站上读入数据并存储在字典中。然后组合字典中的所有关键字以生成单个数据帧。</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/834767f15f99557bef5bd607ee2be26b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*kFIRtrq5b2agPL0dGsOVmg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">原始数据框架，包括所有CAISO参与设施的每小时能耗值。</p></figure><p id="22e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上述代码将为我们提供4家<a class="ae kv" href="http://www.caiso.com/Pages/default.aspx" rel="noopener ugc nofollow" target="_blank"> CAISO </a>公用事业公司(即PGE、SCE、SDGE和VEA)过去5年的每小时能耗值。它还会给出CAISO总数。稍后，我们将只提取这个项目的SDGE数据。</p><p id="8706" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是在上述<em class="od">小时1418 </em>数据帧上执行的一些操作:</p><ul class=""><li id="c2f4" class="np nq iq ky b kz la lc ld lf op lj oq ln or lr nu nv nw nx bi translated">“日期”列已经是datetime格式，所以我们可以直接对该列使用Datetime操作。</li><li id="0284" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">将能耗值转换成数字；在转换为numeric时，注意到列中的一些值是字符串，因此将errors = ' compete '参数传递给pd.to_numeric方法。此外，在转换之后，检查该列是否有空值。</li><li id="2503" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">“日期”列数据中的某些值的格式为“201x-xx-xx yy:59:59.992”，因此使用dt.floor将其转换为“201 x-xx-xx YY:00:00”；这将使“日期”列中的日期时间行保持一致。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">日期时间格式和转换为数值</p></figure><ul class=""><li id="528b" class="np nq iq ky b kz la lc ld lf op lj oq ln or lr nu nv nw nx bi translated">发现dataframe只有3个丢失的值，所以通过使用<em class="od">errors = ' constrate '</em>我们没有丢失很多数据，这证明了这里使用' constrate '方法的合理性。我只是想警告一下，<em class="od">错误= '强制'</em>并不是每次都可以使用的最好方法，你必须在使用它之前检查你的数据，否则它会导致很多空值。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">处理缺失的能量值</p></figure><p id="5c51" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">圣地亚哥地区的原始能量时间序列如下所示。</p><p id="0f3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以上<em class="od"> hourly1418 </em>数据帧保存为'<em class="od"> hourly1418CA.csv' </em>文件以备后用。我们将继续仅使用SDGE能耗值。</p><pre class="kg kh ki kj gt os ot ou ov aw ow bi"><span id="6b9f" class="mr ms iq ot b gy ox oy l oz pa">hSDGE1418 = pd.read_csv('hourly1418CA.csv',usecols=['Dates','SDGE'], parse_dates=['Dates'])</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/b681af10412bfbbd3a0a2fd13b13a9ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_gayRbtNUXRm6u_aS3wrCA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">圣地亚哥能源消耗时间序列(y轴代表每小时的能源消耗，单位为MWh)。有关交互式Plotly图和查看CAISO内所有公用设施的能耗图，请参阅EDA和ML笔记本。</p></figure><ul class=""><li id="172b" class="np nq iq ky b kz la lc ld lf op lj oq ln or lr nu nv nw nx bi translated">43824小时的数据(以兆瓦时为单位的能耗= 10⁶瓦时)</li><li id="8c84" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">平均值:2364.92，中位数:2298.0</li><li id="7208" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">最小值:1437.08</li><li id="e4b9" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">最大:4867.0</li></ul><p id="deb8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以看到能源消耗在夏季有更高的峰值，并且有很强的多季节性模式。这意味着，能源消耗有每日、每周以及季节性的模式。我们稍后还将分析数据的趋势。</p><p id="34d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其他日期时间参数已添加到数据帧中，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">添加日期时间功能的代码</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pc"><img src="../Images/8e670dd1ef08a024e6066c4895e7afc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZhL-RGy7yOfF_u7QEuKryg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">添加了日期时间功能的能耗数据框</p></figure><p id="a34d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="od">非工作日:当天不是联邦假日就是周末<br/>季节:11-5月:冬季和6-10月:夏季(根据SDGE </em> <a class="ae kv" href="https://www.sdge.com/whenmatters#how-it-works" rel="noopener ugc nofollow" target="_blank"> <em class="od">链接</em> </a> <em class="od"> ) </em></p><h2 id="7866" class="mr ms iq bd mt mu mv dn mw mx my dp mz lf na nb nc lj nd ne nf ln ng nh ni nj bi translated">导入天气数据</h2><p id="5fe7" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">为了查看天气(特别是温度)对能耗的影响，我们将从<a class="ae kv" href="https://www.ncei.noaa.gov/metadata/geoportal/rest/metadata/item/gov.noaa.ncdc:C00684/html" rel="noopener ugc nofollow" target="_blank"> gov.noaa.ncdc </a>导入每小时的温度数据。圣地亚哥有两个或更多的气象站记录了天气数据。由于机场的天气数据通常更准确，不会受到附近建筑和工业的影响，因此我们将使用圣地亚哥国际机场的数据来进行这个项目。(从此<a class="ae kv" href="https://www.ncdc.noaa.gov/cdo-web/datatools/lcd" rel="noopener ugc nofollow" target="_blank">链接</a>，选择<em class="od">圣地亚哥县&gt;圣地亚哥国际机场</em>和<em class="od">添加到购物车</em>，即可下载所需数据)。</p><p id="e064" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下载的天气数据有许多列，但我们将只关注'<em class="od">hourly dry bulb temperature</em>'这是以华氏度为单位的室外温度。</p><p id="6bfc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">天气数据每7分钟捕获一次，而能源消耗数据是每小时的数据，因此我必须在将天气数据与能源数据合并之前，通过计算每小时的平均温度，以每小时的间隔对天气数据进行重新采样。</p><pre class="kg kh ki kj gt os ot ou ov aw ow bi"><span id="0d25" class="mr ms iq ot b gy ox oy l oz pa">hourly_weather = weatherdf_air.set_index('DATE').resample('H').mean()</span><span id="6f64" class="mr ms iq ot b gy pd oy l oz pa">wehSDGE1418 = pd.merge(hSDGE1418, hourly_weather, how = 'outer', left_on = 'Dates', right_on= 'DATE')</span></pre><h2 id="accc" class="mr ms iq bd mt mu mv dn mw mx my dp mz lf na nb nc lj nd ne nf ln ng nh ni nj bi translated">太阳能/光伏安装数据</h2><p id="0b5b" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">据观察，圣地亚哥的能源消耗在过去几年中总体上有所下降，并且在白天时间下降更为明显。因此，我们可以测试这一理论，也许圣地亚哥地区安装的太阳能容量在这些年里有所增加，因此当太阳出来时，越来越多的客户使用更少的能源，导致能源消耗的总体减少。我们可以通过导入SDGE地区的太阳能装置数据来检验这一理论。</p><p id="2b8a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">太阳能装置数据从加州分布式<br/>发电统计站点(<a class="ae kv" href="https://www.californiadgstats.ca.gov/download/interconnection_nem_pv_projects/" rel="noopener ugc nofollow" target="_blank">直接数据链接</a>)导入。该数据集包含许多参数，但我们将重点关注:<br/>-<em class="od">批准日期</em>:表示系统连接到电网开始运行的日期，以及<br/>-<em class="od">系统大小AC': </em>，表示安装在现场的太阳能电池板的总交流千瓦功率。</p><p id="0007" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要获得有关数据的更多细节，您可以在我的报告中查看此<a class="ae kv" href="https://github.com/pratha19/Hourly_Energy_Consumption_Prediction/blob/master/NEM_CurrentlyInterconnectedDataKey.b29667e204f3.xlsx" rel="noopener ugc nofollow" target="_blank">工作簿</a>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/4dc7758cc7b9296118e9502e50c77f90.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*6Hfnlokyt0agenI_Q62MrA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">光伏安装数据框<em class="pf"> SDGEPV </em>。每天总共有多少千瓦的PV被激活。</p></figure><ul class=""><li id="2152" class="np nq iq ky b kz la lc ld lf op lj oq ln or lr nu nv nw nx bi translated">出于建模目的，我们对一天安装了多少光伏容量不感兴趣，而是想知道在任何特定的一天，该地区当前运行的光伏系统的总容量是多少。因此，使用累积的系统规模，我们希望看到该地区的总太阳能容量是如何整体增加的。</li></ul><pre class="kg kh ki kj gt os ot ou ov aw ow bi"><span id="25a5" class="mr ms iq ot b gy ox oy l oz pa">SDGEPVM['cum_AC_kW'] = SDGEPVM['AC_kW'].cumsum()</span><span id="1cb1" class="mr ms iq ot b gy pd oy l oz pa">##Truncating the PV installation data to the min and max dates' ##limits of the 'weather+energy' data - 'wehSDGE1418' and storing it ##as SDGEPVT</span><span id="3d06" class="mr ms iq ot b gy pd oy l oz pa">SDGEPVT = SDGEPVM.loc[wehSDGE1418.Date.min():wehSDGE1418.Date.max(), ['AC_kW','cum_AC_kW']].reset_index()</span></pre><p id="8af2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基本上，这个想法是，如果客户有更多的光伏产品，他们将减少对电网供电的依赖(至少当太阳出来时)，从而降低整体能源需求。因此，我们正在考虑在客户场所安装光伏(如住宅、商业建筑等)。).</p><p id="ff51" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们将PV数据集合并到之前合并的天气+能源数据帧中。</p><pre class="kg kh ki kj gt os ot ou ov aw ow bi"><span id="2e24" class="mr ms iq ot b gy ox oy l oz pa">df = pd.merge(wehSDGE1418, SDGEPVT, left_on = 'Date', right_on = 'date_approved', how = 'left')</span><span id="4240" class="mr ms iq ot b gy pd oy l oz pa"><em class="od"># dropping duplicate date columns</em><br/>df.drop(['DATE', 'date_approved'], axis=1, inplace=<strong class="ot ir">True</strong>)</span></pre><ul class=""><li id="e122" class="np nq iq ky b kz la lc ld lf op lj oq ln or lr nu nv nw nx bi translated">由于在5年内(2014-18年)并不一定每天都安装太阳能电池板，因此<em class="od"> SDGEPVT </em>数据帧并不具有与能量数据帧<em class="od"> wehSDGE1418 </em>匹配的所有行，这导致<em class="od"> AC_kW </em>和<em class="od"> cum_AC_kW </em>列中的值缺失。</li><li id="54aa" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">我们可以在“<em class="od"> AC_kW </em>”栏中用<em class="od"> 0 </em>代替<em class="od"> NaN </em>来表示当天的<em class="od"> 0 </em>安装。</li><li id="3e0d" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">并且由于累积安装的太阳能系统大小应该保持不变，直到遇到下一个非<em class="od"> NaN </em>值，使用<em class="od">向前填充</em>方法来填充“<em class="od"> cum_AC_kW </em>列。</li></ul><pre class="kg kh ki kj gt os ot ou ov aw ow bi"><span id="76bf" class="mr ms iq ot b gy ox oy l oz pa">df['cum_AC_kW'] = df['cum_AC_kW'].fillna(method='ffill')</span></pre><ul class=""><li id="1f0c" class="np nq iq ky b kz la lc ld lf op lj oq ln or lr nu nv nw nx bi translated"><em class="od"> Forward fill </em>对除了前几行之外的所有行都有效，因为SDGEPVT的数据不是从2014–01–01 00:00:00开始作为我们的能源和天气数据，所以我们必须使用不同的方法来填充前几个缺失的值。所以，基本上初始缺失值应该等于第一个非NaN(<em class="od">cum _ AC _ kW</em>'<em class="od">减去</em>'<em class="od">AC _ kW</em>')。</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在日光数据中填入NaN值</p></figure></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h2 id="ea52" class="mr ms iq bd mt mu mv dn mw mx my dp mz lf na nb nc lj nd ne nf ln ng nh ni nj bi translated">让我们探索一下阳光之城是如何用电的</h2><p id="1d32" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">绘制一些图表，从数据中获得洞察力。可以回答的一些问题是:</p><ul class=""><li id="dcbf" class="np nq iq ky b kz la lc ld lf op lj oq ln or lr nu nv nw nx bi translated">检查整个时间段内任何特定一天的平均能耗变化。典型的日平均负荷曲线是一条在晚上达到峰值的曲线，因为大多数人晚上下班回家，打开灯、电视、空调等..</li><li id="7371" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">绘制月平均负荷曲线。圣地亚哥夏天很热，但是冬天不冷，所以我们可以预计夏天的负荷会更高，因为商业和住宅建筑的冷负荷。</li><li id="12ce" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">查看每小时与工作日的能源消耗图，了解典型一周的总体消耗模式。</li><li id="8b7d" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">温度对能耗有什么影响？</li><li id="130e" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">用户电表后太阳能装置数量的增加是否导致了整个SDGE地区总能耗的下降？</li></ul><ol class=""><li id="5015" class="np nq iq ky b kz la lc ld lf op lj oq ln or lr pg nv nw nx bi translated">绘制整个2014年至2018年期间的平均每小时负荷曲线</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/c3103c318d1a9a59b553f800d6b91c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*-3yYUX_bVVIvbwUjYAbiZw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">从平均每小时负载曲线图中，我们可以观察到负载如何在夜间保持较低，然后随着人们醒来而开始增加，然后在办公时间继续增加，并在晚上每个人回家并打开电器时达到峰值。</p></figure><p id="3a3d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.每小时与工作日的能耗对比，以了解某一周的能耗变化情况</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/6db9cd91d21c5bbeda047dd9860b6ff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*3YTW-a6zP1ucKQEQwSJlVA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">可以看出，周一至周五的平均消费在夜间低于2000英镑，在白天有所增加，在晚上达到峰值(&gt; 2800英镑)，然后再次下降到夜间。在周末也可以观察到同样的模式，但周末的总消费似乎比预期的工作日低，因为大多数商业建筑在周末不营业。</p></figure><blockquote class="oi oj ok"><p id="0649" class="kw kx od ky b kz la jr lb lc ld ju le ol lg lh li om lk ll lm on lo lp lq lr ij bi translated">来自SDGE的网站:“如果客户可以将他们的一些能源使用转移到下午4点至晚上9点以外的低成本时段，他们就可以降低电费，并在更容易获得的时候，更好地利用更清洁的可再生能源，如风能和太阳能。”</p></blockquote><p id="7f9b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.可视化不同年份的能量值分布</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pj"><img src="../Images/d1361d83e0b21dd187fe94e85caa8337.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*__3eKG9ORHGJIz3yg1zUaA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">从2014年到2018年，所有年份的分布都是双模态的，能耗的模态值每年都向左移动(朝向较低的能源负荷)。</p></figure><p id="d5d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种峰值左移可以被认为是由客户站点(称为电表后)可再生能源装置的增加以及客户对需求响应计划的参与增加导致电网峰值需求降低引起的。</p><p id="43c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.1.绘制相同的分布图，但仅在晚上12点</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/be9be202942cafb294b9840c527de8cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*juOTImPHskyNBLO8NPx-Sg.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">从上图中我们可以看到，从2014年到2018年，能源消耗分布已经明显向更低的能源消耗值转移，这种影响在早上8点到下午5点的白天时段更加明显(所有时段见<a class="ae kv" href="https://nbviewer.jupyter.org/github/pratha19/Springboard_capstone_project_1/blob/master/SDGE_energy_EDA.ipynb#4" rel="noopener ugc nofollow" target="_blank"> EDA笔记本</a>)。</p></figure><ul class=""><li id="d23b" class="np nq iq ky b kz la lc ld lf op lj oq ln or lr nu nv nw nx bi translated">在白天时段发生这种转变的原因之一可能是在用户电表后面增加了更多的可再生能源，如太阳能。我们将在后面看到，在过去的5年里，SDGE的太阳能装置有了相当大的增长。导致这种下降的因素有很多，包括参与能源效率和需求响应计划的人数增加等。但是我们将只关注这个项目的太阳能装置。</li></ul><p id="1fb7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">4.一起探索能源和天气数据</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pl"><img src="../Images/db40760b80ec38a62adef7750fc667d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dJ21WRGywNKlN3inMuTa-Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">多年来能源消耗(红色)随干球温度(蓝色)的变化</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pm"><img src="../Images/83ed66960ef13158c64801e9f30242ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MAondId6Vjqsthoc7tOoQQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">温度与能耗</p></figure><ul class=""><li id="a870" class="np nq iq ky b kz la lc ld lf op lj oq ln or lr nu nv nw nx bi translated">正如之前所怀疑的，我们可以看到能耗和温度确实是相互影响的，而且它们之间似乎有某种程度的相关性。</li><li id="79ad" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">更重要的是，我们可以看到最高能耗值出现在最高温度下。这可能是因为温度较高时空调负荷较高，在夏季需要更多空调负荷。在圣地亚哥，冬天并不寒冷，但是夏天会非常热，所以人们在冬天不怎么使用加热器，因为他们在夏天会使用空调。</li></ul><pre class="kg kh ki kj gt os ot ou ov aw ow bi"><span id="5dce" class="mr ms iq ot b gy ox oy l oz pa"><strong class="ot ir">for</strong> season <strong class="ot ir">in</strong> SDGE_t_pv['season'].unique():<br/>    corrcoef, pvalue = scipy.stats.pearsonr(SDGE_t_pv[SDGE_t_pv['season'] == season]['SDGE'], \<br/>                                            SDGE_t_pv[SDGE_t_pv['season'] == season]['HourlyDryBulbTemperature'])<br/>    print('pearson correlation coefficient and pvalue for '+season, corrcoef, pvalue)</span></pre><p id="6169" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="od">冬季皮尔逊相关系数和p值:0.32 <br/>夏季皮尔逊相关系数和p值:0.65 </em></p><p id="fde4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如上文第3.1节所述，从2014年到2018年，白天的能源消耗似乎有所下降。现在，这可能是由于更严格的能源效率措施被强制执行，或者对不同类别的纳税人(住宅、商业、农业等)的激励增加。)安装太阳能、风能等自发电资源。和/或能量存储，以避免更高的能量需求。据观察，多年来能源消耗的减少在白天更为明显，因此我们可以测试这一理论，即安装在公用事业区域的太阳能容量可能在多年来有所增加，正如我们将在下面看到的那样。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pn"><img src="../Images/f8e80022813a2a813f207f1ab816741b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PeYNhrVTf_3bOp-3dYG5Pg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">2014年至2018年圣地亚哥累计太阳能装机容量(客户位置)</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">历年白天最大能耗与历年光伏装机累计装机容量之间的相关系数。还绘制了光伏安装与6个月滚动最大能耗的关系</p></figure><pre class="kg kh ki kj gt os ot ou ov aw ow bi"><span id="5a3a" class="mr ms iq ot b gy ox oy l oz pa"><strong class="ot ir">&gt;&gt; Energy consumption vs PV installed capacity: pearson correlation coefficient and pvalue for winter -0.515, 0.0<br/>&gt;&gt; Energy consumption vs PV installed capacity: pearson correlation coefficient and pvalue for summer -0.338, 0.0</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pl"><img src="../Images/5b0842e126b53b762c0bd8cfa1c85762.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WV7WgURlKVGxPyebG-ulUg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">光伏安装(蓝色)与6个月滚动最大能耗(红色)。请注意，轴值不是从零(0)开始。</p></figure><ul class=""><li id="2608" class="np nq iq ky b kz la lc ld lf op lj oq ln or lr nu nv nw nx bi translated">这种相关性似乎对两个季节都很重要，对冬季月份更强。这有点违反直觉，但较冷的温度实际上比温暖的温度更有利于太阳能电池板。这种关系适用于大多数类型的太阳能电池板——与安装过程本身无关。在世界各地的实验室进行的研究清楚地表明，温度的升高对测试的太阳能电池板的总太阳能输出有相反的影响。换句话说，温度越高，太阳能光伏系统的效率就越低。</li><li id="4cef" class="np nq iq ky b kz ny lc nz lf oa lj ob ln oc lr nu nv nw nx bi translated">因此，在所有条件相同的情况下，你在六月、七月、八月的月水电费节省会比十二月、二月和一月少。ref:<a class="ae kv" href="https://www.sunlineenergy.com/solar-pv-power-output-san-diegos-winter-months/" rel="noopener ugc nofollow" target="_blank">https://www . sunline energy . com/solar-PV-power-output-San-diegos-winter-months/</a></li></ul><blockquote class="oi oj ok"><p id="7a73" class="kw kx od ky b kz la jr lb lc ld ju le ol lg lh li om lk ll lm on lo lp lq lr ij bi translated"><em class="iq">还有，</em>“圣地亚哥，美国另一个日照最好的城市，冬天比夏天拥有更多的阳光”。(<a class="ae kv" href="https://www.currentresults.com/Weather-Extremes/US/sunniest-cities.php" rel="noopener ugc nofollow" target="_blank">参考链接</a>)</p></blockquote></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h2 id="e8e9" class="mr ms iq bd mt mu mv dn mw mx my dp mz lf na nb nc lj nd ne nf ln ng nh ni nj bi translated">结论</h2><p id="bdea" class="pw-post-body-paragraph kw kx iq ky b kz nk jr lb lc nl ju le lf nm lh li lj nn ll lm ln no lp lq lr ij bi translated">我们已经看到了温度和光伏装机容量对圣地亚哥市能源需求的影响。由于气温较高，夏季的能源需求明显高于冬季。安装的太阳能电池板容量似乎也对这些年的能源消耗有轻微的(减少的)影响。而且，能源消耗有多种季节模式。</p><p id="f8d6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇文章的第二部分，我们将从使用传统的预测算法如SARIMAX和线性回归建立简单的短期预测模型开始。然后，我们还将尝试使用非线性方法进行长期预测，如随机森林、XGBoost以及集合模型(XGBoost + FB Prophet)。</p><p id="0a29" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读。第2部分见。</p><p id="bd89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">免责声明:我在所有公用事业中选择了圣地亚哥，因为，I .它服务的区域比其他公用事业小，所以我们可以使用来自单一来源的温度数据，而不会有太大的变化(实际上圣地亚哥的天气模式变化很大，但对于本项目，我们将忽略这一点); ii .我是加州大学圣迭戈分校的校友。</p></div></div>    
</body>
</html>