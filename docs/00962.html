<html>
<head>
<title>Fisher’s exact test in R: independence test for a small sample</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R 中的 Fisher 精确检验:小样本的独立性检验</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fishers-exact-test-in-r-independence-test-for-a-small-sample-56965db48e87?source=collection_archive---------5-----------------------#2020-01-28">https://towardsdatascience.com/fishers-exact-test-in-r-independence-test-for-a-small-sample-56965db48e87?source=collection_archive---------5-----------------------#2020-01-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/770c3659a387fa3ef94fdd6efdcd5598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*73Z2pBxY4UbGaVXz"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">莱昂·麦克布莱德的照片</p></figure><h1 id="4de5" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">介绍</h1><p id="ae55" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi mc translated"><span class="l md me mf bm mg mh mi mj mk di"> A </span>在介绍了手工独立的<a class="ae kf" href="https://www.statsandr.com/blog/chi-square-test-of-independence-by-hand/" rel="noopener ugc nofollow" target="_blank">卡方检验</a>和 R 中的<a class="ae kf" href="https://www.statsandr.com/blog/chi-square-test-of-independence-in-r/" rel="noopener ugc nofollow" target="_blank">之后，本文重点介绍费雪精确检验。</a></p><p id="c093" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated">独立性检验用于确定两个分类变量之间是否存在显著关系。存在两种不同类型的独立性测试:</p><ul class=""><li id="d512" class="mq mr it lg b lh ml ll mm lp ms lt mt lx mu mb mv mw mx my bi translated">卡方检验(最常见的)</li><li id="8642" class="mq mr it lg b lh mz ll na lp nb lt nc lx nd mb mv mw mx my bi translated">费希尔精确检验</li></ul><p id="aa01" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated">一方面，当样本足够大时使用卡方检验(在这种情况下，p 值是一个近似值，当样本变得无限大时变得精确，这是许多统计检验的情况)。另一方面，当样本很小时，使用费希尔精确检验(在这种情况下，p 值是精确的，而不是近似值)。</p><p id="cf39" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated">文献表明，决定χ2 近似值是否足够好的通常规则是，当列联表的一个单元格中的<strong class="lg iu">预期值</strong>小于 5 时，卡方检验不合适，在这种情况下，费希尔精确检验是首选(MC crum-Gardner 2008；Bower 2003)。</p><h1 id="6385" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">假设</h1><p id="4721" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">费希尔精确检验的假设与卡方检验的假设相同，即:</p><ul class=""><li id="27a1" class="mq mr it lg b lh ml ll mm lp ms lt mt lx mu mb mv mw mx my bi translated">H0:变量是独立的，两个分类变量之间没有关系。知道一个变量的值无助于预测另一个变量的值</li><li id="ee49" class="mq mr it lg b lh mz ll na lp nb lt nc lx nd mb mv mw mx my bi translated">H1:变量是相关的，两个分类变量之间有关系。知道一个变量的值有助于预测另一个变量的值</li></ul><h1 id="6df2" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">例子</h1><h1 id="7b41" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">数据</h1><p id="5613" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">以我们的例子为例，我们想确定吸烟和成为职业运动员之间是否有统计学上的显著联系。吸烟只能是“是”或“不是”，做职业运动员只能是“是”或“不是”。两个感兴趣的变量是定性变量，我们收集了 14 个人的数据。<a class="ae kf" href="https://www.statsandr.com/blog/fisher-s-exact-test-in-r-independence-test-for-a-small-sample/#fn1" rel="noopener ugc nofollow" target="_blank"> 1 </a></p><h1 id="c680" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">观察到的频率</h1><p id="61f4" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">下表总结了我们的数据，报告了每个亚组的人数:</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="a670" class="nn kh it nj b gy no np l nq nr">dat &lt;- data.frame(<br/>  "smoke_no" = c(7, 0),<br/>  "smoke_yes" = c(2, 5),<br/>  row.names = c("Athlete", "Non-athlete"),<br/>  stringsAsFactors = FALSE<br/>)<br/>colnames(dat) &lt;- c("Non-smoker", "Smoker")</span><span id="574d" class="nn kh it nj b gy ns np l nq nr">dat</span><span id="0e39" class="nn kh it nj b gy ns np l nq nr">##             Non-smoker Smoker<br/>## Athlete              7      2<br/>## Non-athlete          0      5</span></pre><h1 id="9bea" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">预期频率</h1><p id="04d1" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">请记住，当期望频率低于 5 的列联表中至少有一个单元格时，使用费雪精确检验。要检索预期频率，将<code class="fe nt nu nv nj b">chisq.test()</code>功能与<code class="fe nt nu nv nj b">$expected</code>一起使用:</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="ace4" class="nn kh it nj b gy no np l nq nr">chisq.test(dat)$expected</span><span id="5f3c" class="nn kh it nj b gy ns np l nq nr">## Warning in chisq.test(dat): Chi-squared approximation may be incorrect</span><span id="09a9" class="nn kh it nj b gy ns np l nq nr">##             Non-smoker Smoker<br/>## Athlete            4.5    4.5<br/>## Non-athlete        2.5    2.5</span></pre><p id="0fad" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated">上面的列联表证实了我们应该使用费希尔精确检验而不是卡方检验，因为至少有一个单元格低于 5。</p><p id="394a" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated"><em class="nw">提示</em>:虽然在决定卡方检验和费希尔检验之前检查预期频率<strong class="lg iu">是一个好的做法，但是如果您忘记了，这并不是一个大问题。从上面可以看到，在 R 中做卡方检验时(用<code class="fe nt nu nv nj b">chisq.test()</code>，会出现“卡方近似可能不正确”这样的警告。该警告意味着最小预期频率低于 5。因此，如果您忘记在对数据进行适当的测试之前检查预期频率，请不要担心，R 会警告您应该使用费雪精确测试，而不是卡方测试。</strong></p><h1 id="79fd" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">R 中的费希尔精确检验</h1><p id="10b6" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">要在 R 中执行 Fisher 精确检验，请像卡方检验一样使用<code class="fe nt nu nv nj b">fisher.test()</code>函数:</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="4594" class="nn kh it nj b gy no np l nq nr">test &lt;- fisher.test(dat)<br/>test</span><span id="73b1" class="nn kh it nj b gy ns np l nq nr">## <br/>##  Fisher's Exact Test for Count Data<br/>## <br/>## data:  dat<br/>## p-value = 0.02098<br/>## alternative hypothesis: true odds ratio is not equal to 1<br/>## 95 percent confidence interval:<br/>##  1.449481      Inf<br/>## sample estimates:<br/>## odds ratio <br/>##        Inf</span></pre><p id="eb87" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated">输出中最重要的是 p 值。您还可以使用以下方法检索 p 值:</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="f834" class="nn kh it nj b gy no np l nq nr">test$p.value</span><span id="56b7" class="nn kh it nj b gy ns np l nq nr">## [1] 0.02097902</span></pre><p id="beb7" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated">请注意，如果您的数据尚未显示为列联表，您可以简单地使用以下代码:</p><pre class="ne nf ng nh gt ni nj nk nl aw nm bi"><span id="c5b1" class="nn kh it nj b gy no np l nq nr">fisher.test(table(dat$variable1, dat$variable2))</span></pre><p id="5644" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated">其中<code class="fe nt nu nv nj b">dat</code>是数据集的名称，<code class="fe nt nu nv nj b">var1</code>和<code class="fe nt nu nv nj b">var2</code>对应于两个感兴趣的变量的名称。</p><h1 id="9aac" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">结论和解释</h1><p id="05c8" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">从输出和<code class="fe nt nu nv nj b">test$p.value</code>中，我们看到 p 值小于 5%的显著性水平。像任何其他统计检验一样，如果 p 值小于显著性水平，我们可以拒绝零假设。</p><p id="f528" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated">在我们的上下文中，拒绝费希尔独立性精确检验的零假设意味着两个分类变量(吸烟习惯和是否是运动员)之间存在显著关系。因此，知道一个变量的值有助于预测另一个变量的值。</p><p id="b3e0" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated">感谢阅读。我希望这篇文章有助于您执行 Fisher 关于 R 中独立性的精确检验，并解释其结果。手动或 R 中的<a class="ae kf" href="https://www.statsandr.com/blog/chi-square-test-of-independence-in-r/" rel="noopener ugc nofollow" target="_blank">了解更多关于独立性卡方检验的信息。</a></p><p id="e0c6" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated">和往常一样，如果您有与本文主题相关的问题或建议，请将其添加为评论，以便其他读者可以从讨论中受益。</p><p id="aaa9" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated"><strong class="lg iu">相关文章:</strong></p><ul class=""><li id="c06b" class="mq mr it lg b lh ml ll mm lp ms lt mt lx mu mb mv mw mx my bi translated"><a class="ae kf" href="https://www.statsandr.com/blog/an-efficient-way-to-install-and-load-r-packages/" rel="noopener ugc nofollow" target="_blank">安装和加载 R 包的有效方法</a></li><li id="30ec" class="mq mr it lg b lh mz ll na lp nb lt nc lx nd mb mv mw mx my bi translated"><a class="ae kf" href="https://www.statsandr.com/blog/do-my-data-follow-a-normal-distribution-a-note-on-the-most-widely-used-distribution-and-how-to-test-for-normality-in-r/" rel="noopener ugc nofollow" target="_blank">我的数据服从正态分布吗？关于最广泛使用的分布以及如何检验 R 中的正态性的注释</a></li><li id="a9b0" class="mq mr it lg b lh mz ll na lp nb lt nc lx nd mb mv mw mx my bi translated"><a class="ae kf" href="https://www.statsandr.com/blog/chi-square-test-of-independence-in-r/" rel="noopener ugc nofollow" target="_blank">R 中独立性的卡方检验</a></li><li id="83c0" class="mq mr it lg b lh mz ll na lp nb lt nc lx nd mb mv mw mx my bi translated"><a class="ae kf" href="https://www.statsandr.com/blog/how-to-create-a-timeline-of-your-cv-in-r/" rel="noopener ugc nofollow" target="_blank">如何在简历中创建时间线</a></li></ul><h1 id="571f" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">参考</h1><p id="3cc9" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">基思·m·鲍尔，2003 年。"何时使用费雪精确检验."在<em class="nw">美国质量协会，六适马论坛杂志</em>，2:35–37。4.</p><p id="cfe8" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated">埃维·麦克拉姆·加德纳律师事务所。2008."使用哪种统计检验是正确的？"<em class="nw">英国口腔颌面外科杂志</em> 46 (1)。爱思唯尔:38-41 岁。</p></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><ol class=""><li id="e969" class="mq mr it lg b lh ml ll mm lp ms lt mt lx mu mb oe mw mx my bi translated">这些数据与涵盖手动<a class="ae kf" href="https://statsandr.com/blog/chi-square-test-of-independence-by-hand/" rel="noopener ugc nofollow" target="_blank">卡方检验的文章</a>中的数据相同，只是为了减少样本量，删除了一些观察数据。<a class="ae kf" href="https://statsandr.com/blog/fisher-s-exact-test-in-r-independence-test-for-a-small-sample/#fnref1" rel="noopener ugc nofollow" target="_blank"> ↩︎ </a></li></ol></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><p id="8c41" class="pw-post-body-paragraph le lf it lg b lh ml lj lk ll mm ln lo lp mn lr ls lt mo lv lw lx mp lz ma mb im bi translated"><em class="nw">原载于 2020 年 1 月 28 日 https://statsandr.com</em><em class="nw">T21</em><a class="ae kf" href="https://statsandr.com/blog/fisher-s-exact-test-in-r-independence-test-for-a-small-sample/" rel="noopener ugc nofollow" target="_blank">。</a></p></div></div>    
</body>
</html>