<html>
<head>
<title>Automate Your (Boring!) Excel Reporting with Python!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化你的(无聊！)用Python做Excel报表！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automate-excel-reporting-with-python-233dd61fb0f2?source=collection_archive---------4-----------------------#2020-05-04">https://towardsdatascience.com/automate-excel-reporting-with-python-233dd61fb0f2?source=collection_archive---------4-----------------------#2020-05-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6825" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">创建Excel报表(包括图表！)却从未接触过Excel！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b0560c5ebbb466aad9f3afd981e37143.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GcwFzbzOUveVgNe8i47CRw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Excel和Python可以成为朋友！资料来源:Nik Piepenbreier</p></figure><h1 id="4fe3" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">没有什么能逃过Excel，这没关系！</h1><p id="43c6" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">Excel无处不在。这是不可避免的，即使有Python这样强大的工具供您使用。</p><p id="0812" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">没关系！你的老板和同事仍然需要简单的方法来访问重要的数据。</p><p id="80d5" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">但这并不意味着您不能通过使用Python使您的Excel工作变得更容易，所有这些都不需要接触Excel！</p><h1 id="81dd" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">使用Python自动生成Excel报表</h1><p id="3824" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">你知道你每月、每周(每天)做的那些Excel报表吗？)依据？你为不同的客户做同样的事情四五次？</p><p id="c4dc" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">让Python来帮你做吧！</p><h2 id="0771" class="mr kz it bd la ms mt dn le mu mv dp li lz mw mx lk md my mz lm mh na nb lo nc bi translated">我们将要自动化的东西</h2><p id="daf6" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">让我们快速看一下我们将自动化什么！我们将使用我的<a class="ae nd" rel="noopener" target="_blank" href="/a-step-by-step-guide-to-pandas-pivot-tables-e0641d0c6c70">熊猫数据透视表教程</a>中的数据(我真的建议去看看！).</p><p id="bf5a" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">数据格式与您可能期望从包含客户销售数据的公司数据库中获得的数据格式相匹配。</p><p id="f5aa" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们将按区域划分这些数据，并创建两个汇总表，包括格式和图表。所有这些都不需要接触Excel！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/32ccaf5536f88927fb1ea00db221b120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wqKTDWHtTl7dwFpfdFUDFw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们的最终数据流—一个工作簿到四个格式化报告。资料来源:Nik Piepenbreier</p></figure><h1 id="e941" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">让我们加载我们的库</h1><p id="f253" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们将依靠熊猫和Openpyxl。我在我的故事<a class="ae nd" rel="noopener" target="_blank" href="/automate-these-3-boring-excel-tasks-with-python-666b4ded101b">中提到了Openpyxl很多，自动化这3个(无聊！！)用Python做Excel任务！</a>它很好地介绍了它是如何运作的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="8188" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们将使用两个库:</p><ol class=""><li id="0599" class="ng nh it ls b lt mm lw mn lz ni md nj mh nk ml nl nm nn no bi translated"><strong class="ls iu">熊猫</strong>负责转换我们的数据并创建初始的Excel文件</li><li id="825f" class="ng nh it ls b lt np lw nq lz nr md ns mh nt ml nl nm nn no bi translated">Openpyxl 格式化我们的工作簿并插入图表</li></ol><h1 id="af66" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">加载我们的数据</h1><p id="c525" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">让我们加载数据，快速浏览一下我们正在处理的内容！</p><p id="cdeb" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">正如我提到的，这些数据意味着类似于您可能从企业数据库系统中获得的数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="d78f" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这里，我们使用pandas读取Excel文件，将<em class="nu">日期</em>列解析为日期。</p><h1 id="21e3" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">创建我们的数据透视表</h1><p id="ec89" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">让我们创建最终报告中需要的汇总表。</p><p id="d552" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">举例来说，让我们为东部地区创建一个数据透视表来测试我们的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h1 id="8e59" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">创建我们的第一个Excel文件</h1><p id="9fc0" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">现在我们有了数据透视表，让我们将它加载到一个Excel文件中。</p><p id="efa3" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">为此，我们将使用熊猫来加载它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="1252" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">让我们快速看一下我们正在做什么:</p><ul class=""><li id="39de" class="ng nh it ls b lt mm lw mn lz ni md nj mh nk ml nv nm nn no bi translated">我们创建一个文件路径变量来标识我们希望文件存储在哪里，</li><li id="45f7" class="ng nh it ls b lt np lw nq lz nr md ns mh nt ml nv nm nn no bi translated">我们使用ExcelWriter来保存文件</li><li id="7739" class="ng nh it ls b lt np lw nq lz nr md ns mh nt ml nv nm nn no bi translated">我们将两个数据透视表保存到单独的工作表中，从第3行开始(为以后的标题留下)</li></ul><h1 id="bcfb" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">让我们的报告更漂亮</h1><p id="0a62" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">Pandas有利于将数据导入Excel。现在它已经在那里了，让我们稍微美化一下，并添加一些可视化效果。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="4661" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这里发生了很多事情。让我们更详细地探索一下吧！</p><p id="8b4f" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在第5节中，我们将工作簿和工作表加载到Openpyxl可以处理的独立对象中。</p><p id="1835" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls iu">第六节</strong>还有一点儿事儿:</p><ul class=""><li id="fcf1" class="ng nh it ls b lt mm lw mn lz ni md nj mh nk ml nv nm nn no bi translated">我们在单元格A1和A2中向sheet1添加标题和副标题。</li><li id="44cb" class="ng nh it ls b lt np lw nq lz nr md ns mh nt ml nv nm nn no bi translated">我们更改季度列的标题以更好地反映数据。</li><li id="33cb" class="ng nh it ls b lt np lw nq lz nr md ns mh nt ml nv nm nn no bi translated">我们对标题和副标题应用样式。</li><li id="e562" class="ng nh it ls b lt np lw nq lz nr md ns mh nt ml nv nm nn no bi translated">我们把金融领域的细胞换成货币。这需要一次应用于单个单元格。这就是我们使用for循环的原因。</li></ul><p id="bc54" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在<strong class="ls iu">第7节</strong>中，我们添加了我们的条形图:</p><ul class=""><li id="a65a" class="ng nh it ls b lt mm lw mn lz ni md nj mh nk ml nv nm nn no bi translated">我们创建一个条形图对象，并标识存储数据和类别的字段。</li><li id="e5a9" class="ng nh it ls b lt np lw nq lz nr md ns mh nt ml nv nm nn no bi translated">然后将数据和类别应用于对象。</li><li id="18c1" class="ng nh it ls b lt np lw nq lz nr md ns mh nt ml nv nm nn no bi translated">最后，我们添加一个描述性的标题和样式。Openpyxl使用了许多不同的样式——尝试一下吧！</li></ul><p id="281a" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这是我们的床单现在的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/60890314721a3cc4b1bc340b1122580d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qcXc1f6MgwrFlNi7sbFpVQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们得到的工作簿之一。资料来源:Nik Piepenbreier</p></figure><h1 id="3309" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">为多个工作簿自动执行此工作流</h1><p id="0110" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">虽然这已经很方便了，但是为一个地区这样做只会节省我们一点点时间。让我们用for循环对所有区域都这样做。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="4c61" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">让我们仔细看看这里:</p><p id="d144" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在第8节中，我们创建了一个列表，其中包含了我们想要覆盖的不同地区的所有唯一值。</p><p id="39c8" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在<strong class="ls iu">第9节</strong>中，我们在for循环中重复前面的代码:</p><ul class=""><li id="ba80" class="ng nh it ls b lt mm lw mn lz ni md nj mh nk ml nv nm nn no bi translated">我们创建一个新的变量来保存我们想要保存文件的文件夹的路径。</li><li id="c713" class="ng nh it ls b lt np lw nq lz nr md ns mh nt ml nv nm nn no bi translated">稍后，我们使用f字符串将区域名称插入到我们的脚本中，使其对每个区域都是动态的。</li></ul><h1 id="1330" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">接下来呢？</h1><p id="a3dd" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">Python的好处在于它可以让重复的任务变得可伸缩。</p><p id="215c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">想象一下，每天都收到这个文件，并且每天都必须创建这些工作簿。你每天都为自己节省了大量的时间！</p><h1 id="44fc" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">结论</h1><p id="813e" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在这个简短的教程中，我们学到了不少东西！我们将一个工作簿转换成一组数据透视表，将它们导出到单独的工作簿中，并对每个工作簿应用格式和图形！</p><p id="ae77" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">给自己一个鼓励！</p><p id="e88c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">如果你对更多类似的内容感兴趣，可以看看我关于Excel的其他故事，比如下面这个:</p><div class="nw nx gp gr ny nz"><a rel="noopener follow" target="_blank" href="/automate-these-3-boring-excel-tasks-with-python-666b4ded101b"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">自动化这3个(无聊！！)用Python做Excel任务！</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">不用再打开数百个Excel文件</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">towardsdatascience.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on ks nz"/></div></div></a></div></div></div>    
</body>
</html>