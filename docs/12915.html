<html>
<head>
<title>How to Extract Data From Existing Series and DataFrame in Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从熊猫的现有序列和数据框架中提取数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-extract-data-from-existing-series-and-dataframe-in-pandas-8d6882814ab7?source=collection_archive---------10-----------------------#2020-09-05">https://towardsdatascience.com/how-to-extract-data-from-existing-series-and-dataframe-in-pandas-8d6882814ab7?source=collection_archive---------10-----------------------#2020-09-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9235" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">探索地图的力量()并应用()</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/db58718f8d8b05ca6cf8bdde7609dcfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jvpWl5bjro2edgtT"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@dsvi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">丹·维桑</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="43fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">准备数据集的一个关键操作是从现有数据中提取信息。熊猫的两个重要功能是专门为完成这一任务而设计的——<code class="fe lv lw lx ly b">map()</code>和<code class="fe lv lw lx ly b">apply()</code>。我注意到，许多现有的教程都专注于介绍如何使用这些函数，而没有设置适当的上下文，以至于许多初学者仍然不知道在自己的项目中何时使用这些函数。在本文中，我想通过为这些功能设置适当的使用场景来解决这个问题，希望能够让您更容易地将这些用例直接转化为您自己特定的业务需求。</p><p id="296f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于各种演示的目的，我们将在适用的地方使用以下系列和 DataFrame 对象。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">抽样资料</p></figure></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h2 id="7083" class="mi mj it bd mk ml mm dn mn mo mp dp mq li mr ms mt lm mu mv mw lq mx my mz na bi translated">场景 1。从现有系列创建系列</h2><p id="5b72" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">假设您从一个 Series 对象开始，并且您想要创建另一个具有基于相应值的单个值的序列。最好简单地在系列对象上使用<code class="fe lv lw lx ly b">map()</code>功能。有多种方法可以使用<code class="fe lv lw lx ly b">map()</code>函数，如下面的代码片段所示。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">现有系列的映射</p></figure><ul class=""><li id="3f26" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">以上三种用法产生了一系列相同值的对象。</li><li id="7f01" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">您可以使用另外一个参数— <code class="fe lv lw lx ly b">na_action</code>，它指定了映射如何处理现有序列的<code class="fe lv lw lx ly b">NaN</code>值。您可以选择<code class="fe lv lw lx ly b">‘ignore’</code>，这将在新系列中创建一个<code class="fe lv lw lx ly b">NaN</code>值，或者选择<code class="fe lv lw lx ly b">None</code>(默认选项)，这将把 NaN 值传递给映射字典或函数。你可以在这里了解更多<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.map.html" rel="noopener ugc nofollow" target="_blank">。</a></li><li id="ad7f" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">因为 DataFrame 对象的行和列是 Series 对象，所以这个用例可以用来从现有的列创建 DataFrame 对象的新列(它也可以用于行)。以下代码向您展示了这样的用法—通过映射创建新行和新列。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据框架映射新列</p></figure></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h2 id="1cd7" class="mi mj it bd mk ml mm dn mn mo mp dp mq li mr ms mt lm mu mv mw lq mx my mz na bi translated">场景 2。从数据帧中的多个系列创建系列</h2><p id="b83b" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">有时需要从多行或多列中提取数据。为了简化本教程，我们假设需要从其他列创建一个列。在这种情况下，我们可以对 DataFrame 对象使用<code class="fe lv lw lx ly b">apply()</code>函数。就像<code class="fe lv lw lx ly b">map()</code>函数一样，你可以为<code class="fe lv lw lx ly b">apply()</code>函数设置一个 lambda 函数或者一个常规函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据框架创建列</p></figure><ul class=""><li id="eaa9" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">参数<code class="fe lv lw lx ly b">axis</code>设置为 1，这意味着我们正在处理行，并且想要创建列。</li><li id="b758" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">当 axis=1 时，lambda 函数或常规函数的默认参数是行序列，其值可以使用键来访问(例如，<code class="fe lv lw lx ly b">[‘col 0’]</code>)。</li><li id="f6b0" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">当需要指定额外的参数时，可以设置<code class="fe lv lw lx ly b">args</code>参数，这些参数除了行数据之外，还可以发送给映射函数。在示例中，我们将 5 设置为映射函数的额外参数的<code class="fe lv lw lx ly b">n</code>。</li></ul></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h2 id="9c8c" class="mi mj it bd mk ml mm dn mn mo mp dp mq li mr ms mt lm mu mv mw lq mx my mz na bi translated">场景 3。从现有系列创建多个系列</h2><p id="4f53" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">假设您需要从现有系列创建多个系列。您可以对 Series 对象使用<code class="fe lv lw lx ly b">apply()</code>方法。请注意，尽管它与上一节提到的<code class="fe lv lw lx ly b">apply()</code>函数同名，但这个函数是一个系列对象的方法，而前一个函数是 DataFrame 的方法。鉴于它们在功能上的相似性，它们只是碰巧有相同的名字。下面的代码向您展示了这种用法的一个简单例子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从一个系列创建多个系列(即数据帧)</p></figure><p id="c19d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如前所述，因为 DataFrame 的列是 Series 对象，所以我们可以从 DataFrame 列创建多个列。下面的代码向您展示了它是如何工作的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从一个列创建新列</p></figure><ul class=""><li id="4569" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">正如前面的代码示例，Series 对象上的<code class="fe lv lw lx ly b">apply()</code>方法必须返回一个 Series 对象(注意 lambda 函数创建了一个 Series 对象)。这里，我们创建了一个包含两个值的 Series 对象，因为我们创建了两列。</li><li id="3f6e" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">您必须在等式的左侧指定您正在创建的列，以便新创建的列可以知道去哪里。</li></ul></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h2 id="cd78" class="mi mj it bd mk ml mm dn mn mo mp dp mq li mr ms mt lm mu mv mw lq mx my mz na bi translated">场景 4。从多个系列创建多个系列(即数据帧)</h2><p id="59a6" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在 Pandas 中，DataFrame 对象可以被认为在两个轴上都有多个系列。因此，本节标题中描述的场景本质上是从现有列创建新列或从现有行创建新行。最好的方法是在 DataFrame 对象上使用<code class="fe lv lw lx ly b">apply()</code>方法。为了简单起见，让我们只考虑在下面的例子中从现有的列创建新的列，然后进行一些说明。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lz ma l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">多列中的多列</p></figure><ul class=""><li id="6622" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated">lambda 函数(也可以使用常规的定义函数)正在创建一个包含两项的列表，因为我们创建了两列。</li><li id="9863" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">lambda 函数中的 x 表示行数据，我们可以使用列名来访问各个值。</li><li id="5e5e" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">这里重要的是将<code class="fe lv lw lx ly b">result_type</code>参数指定为<code class="fe lv lw lx ly b">‘expand’</code>，这将扩展 lambda 函数的结果以形成新的列。换句话说，这里的 lambda 函数创建了一个包含两项的列表，该列表将被扩展为两列。<br/>值得注意的是，<code class="fe lv lw lx ly b">result_type</code>论点还有其他一些选择。例如，默认选项是<code class="fe lv lw lx ly b">None</code>，它不扩展结果并保持不变。另一个选项是<code class="fe lv lw lx ly b">‘reduce’</code>，它通过返回一个序列对象完成与<code class="fe lv lw lx ly b">‘expand’</code>选项相反的工作。要了解关于这些不同选项的更多信息，您可以在这里查阅文档<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.apply.html" rel="noopener ugc nofollow" target="_blank">。</a></li><li id="303c" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">示例中没有包括的一件事是，正如第 2 节中使用<code class="fe lv lw lx ly b">apply()</code>方法显示的结果一样，我们可以提供将在映射函数中使用的附加位置和关键字参数。</li></ul></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h2 id="a74d" class="mi mj it bd mk ml mm dn mn mo mp dp mq li mr ms mt lm mu mv mw lq mx my mz na bi translated">结论</h2><p id="86bd" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">在本文中，我们介绍了如何以 Series 和 DataFrame 对象的形式从现有数据创建新的 Series 对象(例如，行和列)。我们确定了您在项目中可能遇到的四种最常见的使用场景，这将允许您根据自己的需要修改这里的代码。</p></div></div>    
</body>
</html>