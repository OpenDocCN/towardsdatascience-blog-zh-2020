# 名人脸一代与深卷积甘斯

> 原文：<https://towardsdatascience.com/celebrity-face-generation-with-deep-convolutional-gans-40b96147a1c9?source=collection_archive---------23----------------------->

## 深度学习

## 用 DCGANs 生成新的人脸图像

![](img/27af90cb75f8444b129c784fed12b506.png)

[约翰·杰克逊](https://unsplash.com/@johnjac?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍照

在本文中，我将带您完成一个有趣的项目，在这个项目中，您将实现一个用于人脸生成的 DCGAN。

我们将利用大规模名人面孔属性(celebA)数据集来训练我们的对抗网络。

> 如果您不熟悉 GANs 及其工作方式，请阅读这篇关于走向数据科学的文章。

[](/generative-adversarial-networks-6a17673db367) [## 生成对抗网络

### 用解读甘博弈

towardsdatascience.com](/generative-adversarial-networks-6a17673db367) 

## 大规模名人面孔属性(celebA)数据集

**名人脸属性数据集(CelebA)** 是一个大规模的人脸属性数据集，拥有超过 **200K** 张名人图片，每张图片都有 **40** 个属性标注。

数据可以从[这里](https://s3.amazonaws.com/video.udacity-data.com/topher/2018/November/5be7eb6f_processed-celeba-small/processed-celeba-small.zip)下载。

> 我们将使用深度卷积 GANs。如果你想了解 DCGANs，可以看看这篇文章。

[](/dcgans-deep-convolutional-generative-adversarial-networks-c7f392c2c8f8) [## 深度卷积生成对抗网络

### 生成对抗网络最有趣的部分之一是生成网络的设计。的…

towardsdatascience.com](/dcgans-deep-convolutional-generative-adversarial-networks-c7f392c2c8f8) 

## 预处理和数据加载

我们不需要注释，所以我们将不得不裁剪图像。这些是彩色图像。因此，深度为 3(RGB-3 个颜色通道)。

我们可以调整和裁剪图像到 32x32 的大小。这可以在以后转换成张量。

注意，我们在这里使用图像文件夹包装函数。

作者代码。

## 可视化我们的训练数据

我们现在将生成一批数据，并将其可视化。请注意，np.transpose 函数按照指定的顺序转换图像尺寸。例如，在调用以下函数时，形状 3x32x32 的 RGB 图像将转换为 32x32x3:

```
np.transpose(img,(1,2,0))
```

我们的批次大小是 128，所以在这种情况下，我们只绘制 20 个图像，而不是绘制一个批次的所有 128 个图像。

作者代码。

![](img/f19ea514abf9a79c6e1992ad012106c2.png)

一批训练图像。图片由作者提供。

## 缩放图像

缩放图像是很重要的，因为 Tanh 函数的值在-1 到 1 的范围内，所以我们需要将我们的训练图像重新缩放到-1 到 1 的范围。(目前，它们在 0-1 的范围内。)

作者代码。

## 辅助函数—卷积和转置卷积

为了简化我们的代码，我们将定义帮助函数来定义我们的鉴别器和生成器网络。

这些助手功能的原因是什么？回答——干！😅

**卷积辅助函数**

> 注意:要阅读 CNN，请查看下面的斯坦福笔记。

 [## 用于视觉识别的 CS231n 卷积神经网络

### 斯坦福 CS231n 课程材料和笔记:视觉识别的卷积神经网络。

cs231n.github.io](https://cs231n.github.io/) 

作者代码。

**转置卷积辅助函数**

> 注意:如果你想了解转置卷积，可以看看下面的文章。

[](/transposed-convolution-demystified-84ca81b4baba) [## 转置卷积去神秘化

### 转置卷积对于图像分割、超分辨率等应用来说是一个革命性的概念

towardsdatascience.com](/transposed-convolution-demystified-84ca81b4baba) 

作者代码。

## 鉴别器架构

我们现在将定义我们的鉴别器网络。正如我们所知，鉴别器负责将图像分类为真或假。因此这是一个典型的分类器网络。

作者代码。

## 发电机架构

生成器网络负责生成假图像，这些假图像可以欺骗鉴别器网络将其归类为真实图像。随着时间的推移，生成器在欺骗鉴别器方面变得相当不错。

作者代码。

## 参数初始化

我们将通过从正态分布中抽取随机值来初始化网络的权重和偏差。这导致更好的结果。我们为其定义了一个函数，将一个层作为输入。

对于权重，我使用 0 均值和 0.02 标准差。

对于偏差，我使用 0。

> 现在这应该被替换，所以函数后面的 _(下划线)也是如此。

作者代码。

## 损失函数和优化器

我们将使用学习率为 0.002 的 Adam 优化器。这与 DCGANs 的原始研究论文一致。你可以在下面查看一下。

 [## 深度卷积生成对抗网络的无监督表示学习

### 近年来，卷积网络的监督学习(CNN)在计算机视觉领域得到了广泛应用…

arxiv.org](https://arxiv.org/abs/1511.06434) 

作者代码。

我们使用 BCEwithLogitsLoss()，它结合了一个 sigmoid 激活函数(我们希望鉴别器输出一个 0–1 的值来指示一个图像是真的*还是假的*)和二进制交叉熵损失。

![](img/ce6b6dc52bb305d02fc6ed69137a76ad.png)

Binar 交叉熵损失方程。图片由作者提供。

## 培训阶段

我们将定义一个函数来训练我们的模型。这些参数将是鉴别器、发生器、纪元编号。

作者代码。

## 策划损失

作者代码。

![](img/c1e79423cea95c6081f5527843ab4ad5.png)

图片由作者提供。

## 样本生成

现在让我们生成几个样本。重要的是，我们要将这些值重新调整回像素范围(0–255)。

作者代码。

最后，下面是我们生成的人脸。👀

![](img/b968bcccbe0b2f9a02b765b2a3f0cffa.png)

生成的图像。图片由作者提供。

嗯，对于一个小型网络来说，这是相当不错的！

## 外卖食品

1.  人脸包含多个特征，其中一些特征非常复杂，例如雀斑和胡须。为了生成合适的图像，我们可能需要高分辨率的图像。
2.  为训练提供了高分辨率图像，我们可能需要建立一个更好、更深的模型，以获得更高的精确度。
3.  基于输入图像，我们可以进一步增加模型的深度和层数。
4.  提高分辨率肯定有助于我们改进模型并精确捕捉更多特征。
5.  生成的样本可以通过调整参数，如学习率、批量大小和更多次数的训练来进一步改进。发电机的损耗是波动的，而不是减少的。
6.  CelebA 数据主要包含不同名人在不同角度和光照条件下的图像。

# 结论

我们已经看到了如何在 celebA 数据集上使用 DCGAN 实现生成逼真的人脸。通过调整超参数，可以进一步改善生成的图像。你也可以选择比这里更深的层次。然而，这样做将导致参数数量的增加，这又将花费大量时间来训练。现在打开你的 Jupyter 笔记本，执行同样的操作。在下一篇文章中，我将带您浏览使用 SVHN 数据集生成街景房屋号码的过程。下一场见。干杯！

# 谢谢你。