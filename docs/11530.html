<html>
<head>
<title>Why Should You Care About Logging?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么您应该关心日志记录？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-should-you-care-about-logging-442a195b80a1?source=collection_archive---------23-----------------------#2020-08-10">https://towardsdatascience.com/why-should-you-care-about-logging-442a195b80a1?source=collection_archive---------23-----------------------#2020-08-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6ff2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从 Python 初学者提升到中级</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a6d855f60d8fbec8868eee29bba56fb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M6fr2zaOYXNvAKe9"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@aleskrivec?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Ales Krivec </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="ee7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di">作为一个初学者，我们经常发现我们更倾向于写代码来完成工作，而不是如何完成工作。很少考虑整体应用程序的设计和应该遵循的最佳实践。虽然这对初学者来说没问题，但随着我们在编程之旅中不断前进，在将代码投入生产之前，我们还需要考虑应用程序的其他方面。正确的日志记录是将中级或高级开发人员与新手区分开来的一个方面。在本文中，我们将学习 Python 的'<strong class="lb iu"><em class="me">L</em></strong><a class="ae ky" href="https://docs.python.org/3/library/logging.html" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="me">ogging</em></strong>'</a>模块的基础知识。值得注意的是，尽管我们展示的是 Python 示例，但整体概念并不仅限于 Python，还可以应用于其他语言。</span></p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="989f" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">伐木及其重要性</h1><p id="0e99" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">作为 noobs，我们总是使用强大的<em class="me"> print() </em>函数在控制台中打印东西，也许是为了调试或显示中间变量和输出值。这在编码阶段很好，但是当你的应用程序在生产环境中运行时，它们需要适当的跟踪监控。日志记录是在应用程序执行不同任务或事件时提供有关应用程序信息的过程。日志记录提供了以下好处:</p><p id="0f90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">问题诊断:</strong>假设用户报告了一个 bug，您想要在您的开发环境中复制这个场景。现在，如果您已经在日志文件中记录了用户活动，那么引用这些日志并在非生产环境中复制它以供进一步分析可能会更容易。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/84a9f4d88fe7efbfd6678b5d284b1524.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RHbmuBKmpjh1JBwV1-gmtQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">bugs——作者<a class="ae ky" href="https://xkcd.com/1700/" rel="noopener ugc nofollow" target="_blank"> Xkcd </a></p></figure><p id="dcdc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">分析:</strong>通过分析网站日志，人们可以获得更多关于网站高峰时间的信息，或者流量来自哪个地区，或者用户在特定页面上花了多少时间等等。通过在日志文件中记录更多数据，您可以进一步分析用户行为，这可能会改善用户的整体体验。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/4fea45159a68a079633f8627113bf00b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*gfU2Pp_vDFrnJAz0_-CHMQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">大学网站—作者<a class="ae ky" href="https://xkcd.com/773/" rel="noopener ugc nofollow" target="_blank"> Xkcd </a></p></figure></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="ced4" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">我应该在日志中包含什么？</h1><p id="e087" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">要记录的信息是主观的，取决于特定应用程序的上下文。但是，建议至少包括以下信息:</p><p id="b76d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="me"/>时:记录事件的时间戳<br/> <em class="me">谁</em>:应用名或用户名<br/> <em class="me">其中</em>:事件的上下文(登录模块、文件上传模块等。)<br/> <em class="me"> What </em>:活动类型或错误类别(数据库错误、文件 I/O 等。)</p><p id="f648" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">切记不要在日志中包含任何敏感信息。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="6871" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">日志记录级别</h1><p id="fedd" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">Python 为此提供了一个内置模块，我们将在下面探讨。在进入代码之前，让我们看看这个包提供的不同级别的日志记录。“<em class="me">日志记录级别</em>”主要讨论我们的日志中包含的信息类型。有 5 个这样的级别:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/aee42bd0e3cc31d14f5923aad24c3f48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IP8HhwhHNcgPH3DpgxlK5g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:Python 官方<a class="ae ky" href="https://docs.python.org/3/howto/logging.html" rel="noopener ugc nofollow" target="_blank">文档</a></p></figure><p id="e44a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据我们的具体需求，我们可以选择一个或多个日志记录级别。它们都有一个与之相关联的数值。通常，我们选择这些级别中的一个，大于或等于所选日志级别的所有其他级别都会被捕获到我们的日志文件中。让我们借助一个例子来看看这一点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/828dbb1ac464d6456930184a24c7c294.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*sBK6kovaFU15zYDa8sxHfQ.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:Python 官方<a class="ae ky" href="https://docs.python.org/3/library/logging.html#logging-levels" rel="noopener ugc nofollow" target="_blank">文档</a></p></figure><p id="6d17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在下面的代码片段中，在第 1–7 行之间，我们正在导入 python <strong class="lb iu"> <em class="me">日志</em> </strong>模块，创建一个名为“<em class="me"> MY_FIRST_logger </em>”的 LOGGER 对象，并将日志记录级别设置为“<strong class="lb iu"> <em class="me">警告</em> </strong>”。这告诉程序不要捕获低于“警告”级别的日志(即调试&amp;信息)。</p><p id="6d8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从第 9–13 行开始，我们简单地指定了一个文件处理程序，并将其附加到我们的 logger 对象上。</p><p id="df35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在第 15–19 行，我们向上面列出的所有不同的日志记录级别发送消息。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="7296" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行这段代码后，让我们看看日志文件(my_log1.log)的内容。如下所示，它只打印“警告”及以上级别的记录。如果我们将日志记录级别设置为“DEBUG ”,那么所有的行都会出现在日志文件中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/6a636e215b7fd91ba58957f737cfc100.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*SFcC_M0FisJ1CAnQLOGXmA.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">my_log1.log 文件的内容(来源:作者)</p></figure><p id="cdca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以使用参数 logger.level 检查记录器的当前级别。</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="ac17" class="nv mn it nr b gy nw nx l ny nz"><strong class="nr iu">print(logger.level)<br/>30</strong></span></pre><p id="9011" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们将这个 logger 函数添加到一个执行两个整数的<em class="me">除法并返回余数</em>的程序中。我们还将在日志记录中添加更多信息，如时间戳、上下文等。这里使用的日志记录只是为了说明，可能不一定相关。在异常捕获块中添加这些日志命令是一种常见的做法，这样可以使日志更加全面。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure><p id="ff01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">函数“division”用不同的参数调用了 3 次。让我们检查一下日志文件在执行后的样子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/dd4779115cc398281db717c1c739eb11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hG2B6AHfLqCEaR5k6oPq7g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">my_log2.log 文件的内容(来源:作者)</p></figure><p id="c836" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上所述，由于除数为零，对该函数的第三次调用导致了一个<em class="me"> ZeroDivisionError </em>错误。查看日志，我们可以知道程序未能完全执行(因为计算了“余数”因故障未打印)。但是，因为我们在日志文件中记录了输入参数，所以我们可以从一个合理的起点来判断是什么导致了这个问题，并从那里开始着手。很明显这是一个过于简化的问题，但是对于一个有几十种方法的更复杂的应用程序，这是我们必须考虑的。</p><p id="6f58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们可以根据我们的具体需求选择一个或多个上述级别，并且基于所选的日志记录级别，它们将显示在日志文件中。通常在生产中，它被设置为 info 及以上。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><p id="a7e6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di">在</span>结论中，我们探讨了在我们的开发过程中使用日志模块背后的动机。我们还浏览了不同级别的日志记录，以及如何在 Python 代码中实现它们。</p><p id="11f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢您的阅读，我希望这篇文章能让您对在您的下一个项目中使用 loggers 有一个基本的了解和认识。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><p id="88bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能还喜欢:</p><div class="ob oc gp gr od oe"><a rel="noopener follow" target="_blank" href="/face-detection-in-10-lines-for-beginners-1787aa1d9127"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd iu gy z fp oj fr fs ok fu fw is bi translated">面向初学者的 10 行人脸检测</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">使用 Python OpenCV 在图像和视频中检测人脸的介绍。</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">towardsdatascience.com</p></div></div><div class="on l"><div class="oo l op oq or on os ks oe"/></div></div></a></div><div class="ob oc gp gr od oe"><a rel="noopener follow" target="_blank" href="/add-animated-charts-to-your-dashboards-with-streamlit-python-f41863f1ef7c"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd iu gy z fp oj fr fs ok fu fw is bi translated">使用 Streamlit-Python 向您的仪表盘添加动画图表</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">利用 ATP 网球排名数据对比网球四大</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">towardsdatascience.com</p></div></div><div class="on l"><div class="ot l op oq or on os ks oe"/></div></div></a></div></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="af90" class="nv mn it bd mo ou ov dn ms ow ox dp mw li oy oz my lm pa pb na lq pc pd nc pe bi translated">参考资料和进一步阅读:</h2><div class="ob oc gp gr od oe"><a href="https://docs.python.org/3/howto/logging.html" rel="noopener  ugc nofollow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd iu gy z fp oj fr fs ok fu fw is bi translated">日志 HOWTO - Python 3.8.5 文档</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">日志记录是跟踪某些软件运行时发生的事件的一种方式。该软件的开发人员添加了日志调用…</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">docs.python.org</p></div></div><div class="on l"><div class="pf l op oq or on os ks oe"/></div></div></a></div></div></div>    
</body>
</html>