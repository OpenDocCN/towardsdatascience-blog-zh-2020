<html>
<head>
<title>Facilitating Business and Tactical Decisions in Football using Machine Learning Techniques</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习技术促进足球中的商业和战术决策</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/facilitating-business-and-tactical-decisions-in-football-using-machine-learning-techniques-f65b0ab074fc?source=collection_archive---------42-----------------------#2020-05-30">https://towardsdatascience.com/facilitating-business-and-tactical-decisions-in-football-using-machine-learning-techniques-f65b0ab074fc?source=collection_archive---------42-----------------------#2020-05-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8b82" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">机器学习技术如何应用于回答现代足球俱乐部的重要问题的例子。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c937eb4e77c99f7da7e47d32e2c4f545.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lJY89xJg2OChpEGs"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@waldemarbrandt67w?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Waldemar Brandt </a>拍照</p></figure><p id="5041" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">经理、教练和高层仅仅根据他们在球场上看到的来决定球员的表现和转会的日子已经一去不复返了。快速的技术发展为足球队使用分析来做出关键的商业和战术决策铺平了道路。如今，一支足球队不仅仅由球员、经理和教练组组成，还拥有大量分析师，他们利用技术来跟踪球员在比赛和训练期间的表现。数据分析和机器学习在革命性地改变球员如何提高比赛的某个方面，或者俱乐部的体育总监如何在转会窗口期间花巨资做出更好的决定方面发挥了巨大的作用。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/0f6623c101f4da8fb4d47343cb10a348.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jFad_XuxJdtj6Gro"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@goumbik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">卢卡斯·布拉塞克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="2e8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这篇文章揭示了如何在统计和机器学习模型的帮助下，在一个足球俱乐部内做出关键决策。本文将帮助回答的一些问题是:<em class="md">哪些属性显著影响球员的价值，球员必须专注于比赛的哪些方面才能从中场转变为进攻或防守等</em>和<em class="md">如果球员被出售给另一家俱乐部，如何找到替代者。</em></p><p id="f3a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用在Kaggle上找到的FIFA20球员数据集(数据集链接:<a class="ae ky" href="https://www.kaggle.com/stefanoleone992/fifa-20-complete-player-dataset?select=players_20.csv" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/stefanoleone 992/FIFA-20-complete-player-dataset？select=players_20.csv </a>)来回答这些问题。它总共有18，278个玩家，有104个不同的属性，每一行都是一个玩家。在数据集中的104列中，有许多<em class="md">身体、精神和金钱</em>属性。我们将假设该数据集中的属性在现实生活中是真实的，并且它们反映了球员在上一个足球赛季的表现。</p><p id="392a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们用R来回答这些问题。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="9e1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是数据的快照:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi me"><img src="../Images/0d70a2332171abb3e7d949d571c868e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p1iU-U8uUXkFBLqD3yqLug.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd mf">我们可以在快照中看到数据集的前7列(图片由作者提供)</strong></p></figure><p id="d80a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该数据集中的一些列或属性是:<em class="md">‘short _ name’</em>，它表示玩家的简称，<em class="md">‘age’，‘height _ cm’</em>是玩家的身高(以厘米为单位)，<em class="md">，‘weight _ kg’</em>是玩家的体重(以千克为单位)，<em class="md">，‘total’</em>是玩家的评分(满分为100分)，<em class="md">，‘club’</em>，即玩家所属的俱乐部，<em class="md">，‘value _ EUR’</em>数据集中还存在许多其他属性，其中大多数属性的取值都有上限，为100。</p><p id="cb1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在来回答几个重要的问题。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="7996" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated"><strong class="ak">哪些属性显著影响球员的价值？</strong></h1><p id="bfc1" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">在这个数据集中，玩家的价值是他的欧元价值，用<em class="md">‘value _ EUR’</em>表示。我们可以看到哪些属性对决定一个球员的价值起着重要的作用。为此，我们可以拟合一个线性模型，将<em class="md">‘value _ EUR’</em>作为目标变量或结果变量，将数据集中的其他属性作为预测变量。我们可以使用特征选择方法来找到显著影响结果变量的属性。我们将实现的一些特征选择方法有:向前逐步选择，向后逐步选择和套索回归或L1正则化。每种方法都选择对结果变量影响最大的属性子集。</p><h2 id="5c19" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated"><strong class="ak">数据预处理:</strong></h2><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="16df" class="nd mh it nq b gy nu nv l nw nx">#load required libraries<br/>library(ggplot2)<br/>library(dplyr)<br/>library(tidyr)<br/>library(data.table)</span><span id="e3c5" class="nd mh it nq b gy ny nv l nw nx">#load the dataset into RStudio<br/>f20 &lt;- fread('path to the dataset')</span><span id="5f83" class="nd mh it nq b gy ny nv l nw nx">f20_copy &lt;- fread('path to the dataset')</span><span id="3fdd" class="nd mh it nq b gy ny nv l nw nx">f20 &lt;- as_tibble(f20)</span><span id="98db" class="nd mh it nq b gy ny nv l nw nx">#remove players that have no 'team_position'<br/>f20 &lt;- f20 %&gt;% dplyr::filter(team_position != "")</span><span id="b10e" class="nd mh it nq b gy ny nv l nw nx">f20 &lt;- f20 %&gt;% separate(player_positions, c("player_position", NA, NA))</span><span id="60c3" class="nd mh it nq b gy ny nv l nw nx">#assign respective team positions for substitutes and reserves<br/>select2 &lt;- f20$team_position == "SUB"<br/>f20[select2, "team_position"] &lt;- f20[select2, "player_position"]</span><span id="7bb7" class="nd mh it nq b gy ny nv l nw nx">select3 &lt;- f20$team_position == "RES"<br/>f20[select3, "team_position"] &lt;- f20[select3, "player_position"]</span><span id="12d1" class="nd mh it nq b gy ny nv l nw nx">#remove GKs from the dataset<br/>f20 &lt;- f20 %&gt;% dplyr::filter(team_position != "GK")</span><span id="ebca" class="nd mh it nq b gy ny nv l nw nx">sofifa_id &lt;- f20 %&gt;% select(sofifa_id)</span><span id="66dd" class="nd mh it nq b gy ny nv l nw nx">#we're interested in a player's physical, mental and monetary attributes, so, we'll only keep those attributes in the dataset<br/>f20 &lt;- f20 %&gt;% select(-player_url, -dob, -real_face, -player_tags, <br/>                                    -loaned_from, -joined, -player_position, -contract_valid_until,<br/>                                    -nation_position, -nation_jersey_number, -player_traits, -gk_diving,<br/>                                    -gk_handling, -gk_kicking, -gk_reflexes, -gk_speed, -gk_positioning,<br/>                                    -goalkeeping_diving, -goalkeeping_handling, -goalkeeping_kicking,<br/>                                    -goalkeeping_positioning, -goalkeeping_reflexes, <br/>                                    -ls, -st, -rs, -lw, -lf, -cf, -rf, -rw, -lam, -cam, -ram, <br/>                                    -lm, -lcm, -cm, -rcm, -rm, -lwb, -ldm, -cdm, -rdm, -rwb, <br/>                                    -lb, -lcb, -cb, -rcb, -rb, -work_rate,<br/>                              -nationality, -club, -body_type, -team_jersey_number, -preferred_foot, -short_name, -team_position, -long_name, -sofifa_id)</span><span id="7339" class="nd mh it nq b gy ny nv l nw nx">#assign row names for the dataframe<br/>f20 &lt;- cbind(f20, sofifa_id = sofifa_id$sofifa_id)<br/>row.names(f20) &lt;- f20$sofifa_id<br/>f20[47] &lt;- NULL</span></pre><p id="fcf5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经完成了数据集的预处理。我们从数据集中删除了守门员，因为他们的许多属性都有NA值(如果我们想找到显著影响守门员价值的属性，我们可以在数据框架中拟合一个只有守门员的线性模型)。</p><h2 id="8a63" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated"><strong class="ak">正向逐步选择:</strong></h2><p id="34fa" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我们使用<em class="md">‘value _ EUR’</em>作为结果变量执行向前逐步选择。leaps包中的<em class="md"> 'regsubsets()' </em>函数执行FSS。调用<em class="md"> 'coef()' </em>函数查看算法选择的属性。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="6b5f" class="nd mh it nq b gy nu nv l nw nx">library(leaps)</span><span id="2264" class="nd mh it nq b gy ny nv l nw nx">f20_fss &lt;- regsubsets(value_eur ~ ., data = f20, method = "forward")<br/>coef(f20_fss, 8)<br/></span></pre><p id="aedd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">FSS模型选择:<em class="md">‘年龄’，‘整体’，‘潜力’，‘工资_欧元’，‘国际_声誉’，‘释放_条款_欧元’，‘动力_耐力’，<em class="md">‘防守_滑行_铲球’，</em>作为显著属性或预测因子。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/84f2b5c275df1cc94a1cc65ef1e3c903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kAF0bZXeGPr7OeT4eKLuNQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">FSS选择的属性<strong class="bd mf">(图片由作者提供)</strong></p></figure><h2 id="7ff4" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated"><strong class="ak">向后逐步选择:</strong></h2><p id="cf5d" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">同样，我们使用<em class="md">‘value _ EUR’</em>作为结果变量，执行反向逐步选择。在<em class="md"> 'regsubsets()' </em>功能中，将方法更改为backward以执行BSS。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="8cff" class="nd mh it nq b gy nu nv l nw nx">f20_bss &lt;- regsubsets(value_eur ~ ., data = f20, method = "backward")<br/><br/>coef(f20_bss, 8)</span></pre><p id="34d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">BSS模型选择与FSS模型相同的属性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/84f2b5c275df1cc94a1cc65ef1e3c903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kAF0bZXeGPr7OeT4eKLuNQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">BSS选择的属性<strong class="bd mf">(图片由作者提供)</strong></p></figure><h2 id="9628" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">拉索回归或L1正则化；</h2><p id="81f8" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">Lasso回归，也称为L1正则化，是一种将某些属性的系数缩小到0的线性回归。它本质上执行特征选择，即具有非零系数的属性被套索选择。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="ce01" class="nd mh it nq b gy nu nv l nw nx">library(glmnet) # library to perform lasso regression</span><span id="7c3f" class="nd mh it nq b gy ny nv l nw nx">#standardize the dataset using 'scale()' function<br/>f20_2 &lt;- f20 %&gt;% na.omit() %&gt;% scale() %&gt;% as.data.frame()</span><span id="88be" class="nd mh it nq b gy ny nv l nw nx">lambdas &lt;- 10^seq(10, -2, length=100)</span><span id="4d08" class="nd mh it nq b gy ny nv l nw nx">x &lt;- model.matrix(value_eur~., f20_2)<br/>f20_lasso &lt;- cv.glmnet(x, f20_2$value_eur, alpha = 1, lambda = lambdas, nfolds = 10, standardize = TRUE)</span><span id="ae75" class="nd mh it nq b gy ny nv l nw nx">#best lambda<br/>lambda_best &lt;- f20_lasso$lambda.min<br/>lambda_best</span><span id="af0b" class="nd mh it nq b gy ny nv l nw nx">#fit lasso model again with the best lambda value<br/>lasso_model &lt;- glmnet(x, f20_2$value_eur, alpha = 1, lambda = lambda_best, standardize = TRUE)<br/>coef(lasso_model)</span></pre><p id="d803" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="md"> 'cv.glmnet()' </em>是一个k重交叉验证函数，用于查找λ的最佳值。在<em class="md"> 'cv.glmnet()' </em>函数中设置alpha=1，进行套索回归。一旦我们获得了<em class="md">‘lambda _ best’，</em>，我们就使用这个值通过<em class="md">‘glmnet()’</em>函数再次执行套索回归。在套索模型上调用<em class="md"> 'coef()' </em>函数，查看套索选择的属性。</p><p id="10b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在套索模型上调用<em class="md"> 'coef()' </em>函数的输出是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/f80b6577dc39e0129ade87f4bfd2f674.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*FBa2jx7YjEIkFp9md1gS8Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">套索模型中的属性系数<strong class="bd mf">(图片由作者提供)</strong></p></figure><p id="35af" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">lasso选择<em class="md">‘总体’，‘工资_欧元’，‘国际_声誉’，‘释放_条款_欧元’</em>和<em class="md">‘力量_耐力’</em>作为显著属性或预测值。</p><p id="9c45" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们将只在数据集中包含通过上述特征选择方法选择的属性，并使用<em class="md">‘value _ EUR’</em>作为输出变量训练线性模型。然后，我们可以通过查看测试集上的单个RMSE值来比较这些模型的性能。</p><h2 id="d514" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">FSS和BSS选择属性的线性回归(FSS和BSS选择相同的属性):</h2><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="85ef" class="nd mh it nq b gy nu nv l nw nx">f20_fss_bss &lt;- f20_2 %&gt;% select(age, overall, potential, wage_eur, international_reputation,<br/>              release_clause_eur, power_stamina, defending_sliding_tackle, value_eur)</span><span id="9654" class="nd mh it nq b gy ny nv l nw nx">library(modelr)</span><span id="569b" class="nd mh it nq b gy ny nv l nw nx">#function to perform k-fold cross validation on the dataset and to return train and test RMSEs<br/>cvlmf &lt;- function(fitt, data, k){<br/>  set.seed(1)<br/>  data &lt;- crossv_kfold(data, k)<br/>  data &lt;- data %&gt;%<br/>    mutate(fit = map(train, ~ fitt, data = .))<br/>  data &lt;- data %&gt;% <br/>    mutate(rmse_train = map2_dbl(fit, train, ~rmse(.x,.y)),<br/>           rmse_test = map2_dbl(fit, test, ~rmse(.x,.y)) )<br/>  paste0("rmse_train = ", mean(data$rmse_train), ",", " rmse_test = ", mean(data$rmse_test))<br/>}</span><span id="8d24" class="nd mh it nq b gy ny nv l nw nx">#linear model<br/>fss_bss_model &lt;- lm(value_eur ~ ., data = f20_fss_bss)</span><span id="c273" class="nd mh it nq b gy ny nv l nw nx">#returns train and test RMSEs <br/>cvlmf(fss_bss_model, f20_fss_bss, 5)</span><span id="08fc" class="nd mh it nq b gy ny nv l nw nx">#plot of the linear model<br/>par(mfrow = c(2,2))<br/>plot(fss_bss_model)</span></pre><p id="fecc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们得到交叉验证的测试集RMSE为0.1066。在线性模型上调用<em class="md">‘plot()’</em>函数给我们一个2交叉2网格的回归诊断图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/d3b726ed52ddf4aee0f9c6acedcf5b8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dgzIUphv_h94uU0isQavNA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">线性回归诊断图</p></figure><p id="3fe7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要了解更多关于这些诊断图的信息，我建议你浏览一下这篇文章。在残差与杠杆率图中，我们可以看到一些高杠杆率点，它们分别标有<em class="md">‘sofifa _ id’的</em>。高杠杆点是数据集中具有极端属性值的那些观测值或行，即它们缺少相邻的观测值。</p><p id="5859" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的数据集中，一些高杠杆点是:梅西，c罗和保罗·迪巴拉。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="d23a" class="nd mh it nq b gy nu nv l nw nx">f20_copy %&gt;% filter(sofifa_id %in% c(211110, 20801, 158023)) %&gt;% <br/>  select(sofifa_id, short_name)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/1bc299b271a0fea706d42295476d09b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*J5NRAIqQMltxWF162ORFMw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">高杠杆点<strong class="bd mf">(图片由作者提供)</strong></p></figure><h2 id="31be" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">通过L1正则化选择属性的套索回归:</h2><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="c35a" class="nd mh it nq b gy nu nv l nw nx">f20_lassodf &lt;- f20_2 %&gt;% select(overall, wage_eur, international_reputation, <br/>                                release_clause_eur, power_stamina, value_eur)</span><span id="bef4" class="nd mh it nq b gy ny nv l nw nx">#train and test set split<br/>set.seed(100) <br/>index = sample(1:nrow(f20_lassodf), 0.8*nrow(f20_lassodf)) <br/>train = f20_lassodf[index,] <br/>test = f20_lassodf[-index,] </span><span id="6fad" class="nd mh it nq b gy ny nv l nw nx">x_train = as.matrix(train[,-6])<br/>y_train = train$value_eur</span><span id="84f5" class="nd mh it nq b gy ny nv l nw nx">x_test = as.matrix(test[,-6])<br/>y_test = test$value_eur</span><span id="e559" class="nd mh it nq b gy ny nv l nw nx">f20_lambda_best &lt;- cv.glmnet(x_train, y_train, alpha = 1, lambda = lambdas, nfolds = 10,<br/>                       standardize = TRUE)</span><span id="d4d1" class="nd mh it nq b gy ny nv l nw nx">#best lambda<br/>lambda_best &lt;- f20_lasso_model$lambda.min<br/>lambda_best</span><span id="6321" class="nd mh it nq b gy ny nv l nw nx">#train lasso model again with best lambda value<br/>f20_lasso_model &lt;- glmnet(x_train, y_train, alpha = 1, lambda = lambda_best, standardize = TRUE)</span><span id="6460" class="nd mh it nq b gy ny nv l nw nx">#prediction on the test set<br/>predictions_test &lt;- predict(f20_lasso_model, s = lambda_best, newx = x_test)<br/>predictions_test &lt;- as.vector(predictions_test)</span><span id="03d3" class="nd mh it nq b gy ny nv l nw nx">#function to evaluate RMSE<br/>evaluate_model &lt;- function(true, predicted, data) {<br/>  SSE &lt;- sum((predicted - true)^2)<br/>  SST &lt;- sum((true - mean(true))^2)<br/>  RMSE = sqrt(SSE/nrow(data))<br/>  return(RMSE)<br/>}</span><span id="2683" class="nd mh it nq b gy ny nv l nw nx">evaluate_model(y_test, predictions_test, test)</span></pre><p id="6c65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们获得的测试集RMSE为2.4230，高于我们拟合常规线性模型时获得的测试集RMSE。由于FSS和BSS选择的属性模型给了我们一个更好的测试集RMSE，我们将分析<em class="md">‘年龄’，‘整体’，‘潜力’，‘工资_欧元’，‘国际声誉’，‘释放_条款_欧元’，‘力量_耐力’，</em>，<em class="md">‘防守_滑行_铲球’的系数。</em>这些都是对一个玩家价值有重大影响的属性。</p><p id="91ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述属性的系数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/84f2b5c275df1cc94a1cc65ef1e3c903.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kAF0bZXeGPr7OeT4eKLuNQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">FSS和BSS选择的属性系数<strong class="bd mf">(作者提供的图片)</strong></p></figure><p id="4685" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们注意到<em class="md">‘总体’，‘工资_欧元’，‘国际_声誉’，‘释放_条款_欧元’</em>和<em class="md">，‘力量_耐力’</em>对一名球员的价值有正面影响，而在所有其他属性不变的情况下，<em class="md">‘年龄’，‘潜力’，</em>和<em class="md">‘防守_滑行_阻截’，</em>对一名球员的价值有负面影响。令人惊讶的是，很少与球员在球场上的技能相关的属性会对<em class="md">‘value _ EUR’产生重大影响。</em></p><ul class=""><li id="d91d" class="od oe it lb b lc ld lf lg li of lm og lq oh lu oi oj ok ol bi translated"><em class="md">‘年龄’</em>的系数表明，如果一名球员年龄增长一岁，在所有其他属性不变的情况下，他的价值会减少14，990欧元。</li><li id="5635" class="od oe it lb b lc om lf on li oo lm op lq oq lu oi oj ok ol bi translated"><em class="md">‘总体’</em>的系数表明，如果玩家的<em class="md">‘总体’</em>或等级增加1点，在所有其他属性不变的情况下，他的价值增加30，743欧元。</li><li id="c26a" class="od oe it lb b lc om lf on li oo lm op lq oq lu oi oj ok ol bi translated"><em class="md">‘潜力’</em>的系数表明，如果一个玩家的潜力等级增加1点，在其他所有属性不变的情况下，他的价值减少21303欧元。</li></ul><p id="55a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以类似地解释其他属性的系数。上面的一些解释具有直观的意义，因为很容易理解，随着球员年龄的增长，他的转会市场价值将会下降，而评级更高的球员具有更高的转会市场价值。与直觉相反的是，“潜力”等级的增加会导致玩家价值的降低。我们也看到，擅长铲球的球员往往价值较低。</p><p id="fdf8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似地，我们可以使用特征选择模型来选择显著影响属于球场上特定位置的球员的价值的属性，即，我们可以找到分别影响守门员、进攻者、中场和防守者的价值的属性。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="70a2" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">为转会到另一家俱乐部的球员寻找替代者</h1><p id="a764" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">球员在俱乐部之间的转会在足球界非常普遍，在夏季和冬季转会窗口期间发生了数以千计的转会。当一名球员离开我们的俱乐部时，我们希望用一名同样优秀的球员来代替他。机器学习中的聚类方法有助于找到具有相似技能的玩家。我们可以通过观察同一个集群中的其他玩家来找到一个玩家的替代者。</p><p id="5855" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，如果利物浦要卖掉维吉尔·范迪克，他们会用一个同样有能力的中后卫来代替他。然后他们可以寻找和范·迪克属于同一群的中后卫来替代。</p><h2 id="dba1" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated"><strong class="ak">数据预处理:</strong></h2><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="0403" class="nd mh it nq b gy nu nv l nw nx">#load necessary libraries<br/>library(dplyr)<br/>library(tidyr)<br/>library(data.table)</span><span id="ba4f" class="nd mh it nq b gy ny nv l nw nx">f20 &lt;- fread('path to the dataset')<br/>f20 &lt;- as_tibble(f20)</span><span id="bf0e" class="nd mh it nq b gy ny nv l nw nx">f20 &lt;- f20 %&gt;% dplyr::filter(team_position != "")</span><span id="e527" class="nd mh it nq b gy ny nv l nw nx">f20 &lt;- f20 %&gt;% separate(player_positions, c("player_position", NA, NA))</span><span id="e50f" class="nd mh it nq b gy ny nv l nw nx">select2 &lt;- f20$team_position == "SUB"<br/>f20[select2, "team_position"] &lt;- f20[select2, "player_position"]</span><span id="190f" class="nd mh it nq b gy ny nv l nw nx">select3 &lt;- f20$team_position == "RES"<br/>f20[select3, "team_position"] &lt;- f20[select3, "player_position"]</span><span id="8d32" class="nd mh it nq b gy ny nv l nw nx">#remove goalkeepers from the dataset<br/>f20 &lt;- f20 %&gt;% dplyr::filter(team_position != "GK")</span><span id="0ec0" class="nd mh it nq b gy ny nv l nw nx">#only variables related to a player's skill set should be included in the dataset<br/>f20 &lt;- f20 %&gt;% select(-player_url, -dob, -real_face, -player_tags, <br/>                                    -loaned_from, -joined, -player_position, -contract_valid_until,<br/>                                    -nation_position, -nation_jersey_number, -player_traits, -gk_diving,<br/>                                    -gk_handling, -gk_kicking, -gk_reflexes, -gk_speed, -gk_positioning,<br/>                                    -goalkeeping_diving, -goalkeeping_handling, -goalkeeping_kicking,<br/>                                    -goalkeeping_positioning, -goalkeeping_reflexes, <br/>                                    -ls, -st, -rs, -lw, -lf, -cf, -rf, -rw, -lam, -cam, -ram, <br/>                                    -lm, -lcm, -cm, -rcm, -rm, -lwb, -ldm, -cdm, -rdm, -rwb, <br/>                                    -lb, -lcb, -cb, -rcb, -rb, -work_rate,<br/>                              -nationality, -club, -body_type, -team_jersey_number, -preferred_foot, -short_name, -team_position, -overall, -potential, -value_eur, -wage_eur,<br/>                      -international_reputation, -release_clause_eur, -age, -long_name)</span><span id="79b3" class="nd mh it nq b gy ny nv l nw nx">#assign row names<br/>row.names(f20) &lt;- f20$sofifa_id<br/>f20[1] &lt;- NULL</span><span id="f439" class="nd mh it nq b gy ny nv l nw nx">#standardize the data<br/>f20 &lt;- scale(f20)</span><span id="f4ae" class="nd mh it nq b gy ny nv l nw nx">f20 &lt;- na.omit(f20)</span></pre><h2 id="bf27" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">k表示聚类:</h2><p id="e1a9" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">我们需要确定集群的数量。为了做到这一点，我们将使用肘法。k-means聚类背后的基本思想是，我们希望最小化聚类平方和内的总数。总WSS衡量一个集群的紧凑性，我们希望它尽可能小。应该选择簇的数量，这样添加另一个簇不会显著提高总WSS。要了解更多关于确定最佳集群数量的信息，请阅读这篇文章。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="ede8" class="nd mh it nq b gy nu nv l nw nx">#libraries to do k-means clustering<br/>library(factoextra)<br/>library(NbClust)</span><span id="da9d" class="nd mh it nq b gy ny nv l nw nx">#determining the optimal number of clusters using elbow method<br/>fviz_nbclust(f20, kmeans, method = "wss") +<br/>  labs(subtitle = "Elbow method")<br/>#Lets go with 4 clusters.</span><span id="5a43" class="nd mh it nq b gy ny nv l nw nx">set.seed(123)<br/>f20_km &lt;- kmeans(f20, 4, nstart = 25)<br/>#print(f20_km)</span><span id="7863" class="nd mh it nq b gy ny nv l nw nx">#number of observations in each cluster<br/>f20_km$size</span><span id="925b" class="nd mh it nq b gy ny nv l nw nx">#visualizing the clusters<br/>fviz_cluster(f20_km, f20, ellipse.type = "norm")</span><span id="0244" class="nd mh it nq b gy ny nv l nw nx">#structure of the k-means model<br/>str(f20_km)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/e9305fce698908c0f69606f764e6c239.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-rUCJSSpyKVLul64_BLs_Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">k=4的k均值聚类结果<strong class="bd mf">(图片由作者提供)</strong></p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/7bbba68c5fe3875d5e0520485aa9d76b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n1vtkp8kTlVfZwxASzg0QA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">k均值模型的结构</p></figure><p id="f802" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将在数据帧中创建一个新列来表示玩家所属的集群。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="a960" class="nd mh it nq b gy nu nv l nw nx">clusters_df &lt;- data.frame(sofifa_id = as.integer(names(f20_km$cluster)), <br/>                          player_cluster = f20_km$cluster)</span><span id="5bb4" class="nd mh it nq b gy ny nv l nw nx">fifa20 &lt;- fread('path to the dataset')<br/>fifa20 &lt;- as_tibble(fifa20)</span><span id="e919" class="nd mh it nq b gy ny nv l nw nx">fifa20 &lt;- fifa20 %&gt;% filter(team_position != "")</span><span id="45b6" class="nd mh it nq b gy ny nv l nw nx">fifa20 &lt;- fifa20 %&gt;% separate(player_positions, c("player_position", NA, NA))</span><span id="2b15" class="nd mh it nq b gy ny nv l nw nx">select1 &lt;- fifa20$team_position == "SUB"<br/>fifa20[select1, "team_position"] &lt;- fifa20[select1, "player_position"]</span><span id="a99c" class="nd mh it nq b gy ny nv l nw nx">select2 &lt;- fifa20$team_position == "RES"<br/>fifa20[select2, "team_position"] &lt;- fifa20[select2, "player_position"]</span><span id="5b55" class="nd mh it nq b gy ny nv l nw nx">fifa20 &lt;- fifa20 %&gt;% filter(team_position != "GK")</span><span id="9d0d" class="nd mh it nq b gy ny nv l nw nx">#inner join by 'sofifa_id' to create 'player_cluster' column in the dataframe<br/>fifa20 &lt;- inner_join(fifa20, clusters_df)</span><span id="a282" class="nd mh it nq b gy ny nv l nw nx">#keep columns that we're going to look at<br/>fifa20 &lt;- fifa20 %&gt;% select(age, short_name, wage_eur,value_eur, overall, potential, team_position, work_rate, club, release_clause_eur, player_cluster)</span></pre><p id="9296" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同一集群中的玩家拥有相似的技能组合。让我们看看这4个集群中的一些参与者。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="2c5f" class="nd mh it nq b gy nu nv l nw nx">#players belonging to the same cluster<br/>fifa20%&gt;% filter(player_cluster == 1) %&gt;% head(7)<br/>fifa20%&gt;% filter(player_cluster == 2) %&gt;% head(7)<br/>fifa20%&gt;% filter(player_cluster == 3) %&gt;% head(7)<br/>fifa20%&gt;% filter(player_cluster == 4) %&gt;% head(7)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/d6f537f42bdf7a705cd2960c1b4dd7f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ywjaGfdSQyIZz_YrR0l7nA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">第一组的球员<strong class="bd mf">(图片由作者提供)</strong></p></figure><p id="4851" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上图中，如果k .马诺拉斯被那不勒斯卖给另一家俱乐部，他们可以考虑竞购拜耳勒沃库森的J. Tah。他们两个有相似的评价，事实上那不勒斯会出价一个比马诺拉斯更年轻的球员，他的周薪更低，更有潜力。如果他们对Tah的收购失败，他们可以在相同的位置上寻找其他替代者，如萨维奇，科茨和贾德尔等。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/685d48ec89154b8daedfc9b451464a3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0kZYG6zF-SF8pTxLJMbA1g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">第三集群的玩家<strong class="bd mf">(图片由作者提供)</strong></p></figure><p id="c428" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上图中，如果o .麦克伯尼被谢菲尔德联队卖掉，他们可以考虑竞购梅茨队的h .迪亚洛。如果谢菲尔德对他的出价失败了，他们可以看看同组的其他球员，如英格尔塞、阿托克和穆里奇等。</p><p id="a412" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于属于集群2和集群4的球员，我们可以有类似的转会解释。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="7af8" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">在场上的位置之间切换</h1><p id="4226" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">许多球员在场上短期或长期改变位置。球员改变位置有很多原因，比如管理决策、年龄和个人喜好等。如前所述，举例来说，年龄的增长会促使一名球员成为一名深度进攻组织者，而不是一名敏捷的边锋。我们的数据表明，30岁以后，<em class="md">‘年龄’</em>vs<em class="md">‘步伐’的剧情有一个总体下降的趋势。</em>因此，随着年龄的增长，许多球员选择在球场上需要较少速度的更深位置。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/e9bd51a9a2279fb416d35b6792206896.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*byil_L_dWlRmezIBTUoDlQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“年龄”vs“步伐”的情节<strong class="bd mf">(图片由作者提供)</strong></p></figure><p id="23cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们把场上的位置大致分为门将、后卫、中场、攻击手，就可以发现这些位置上的球员所支配的属性。我们可以以守门员为参照或基础类别，通过对数据拟合多项逻辑回归模型，对守门员、后卫、中场和攻击手的共同属性进行比较研究。</p><h2 id="7f6c" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">以守门员为基本类别的位置比较:</h2><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="340d" class="nd mh it nq b gy nu nv l nw nx">#load some of the required libraries<br/>library(dplyr)<br/>library(tidyr)<br/>library(data.table)<br/>library(modelr)<br/>library(caret)</span><span id="9ca6" class="nd mh it nq b gy ny nv l nw nx">fifa20 &lt;- fread('path to the dataset')</span><span id="3a53" class="nd mh it nq b gy ny nv l nw nx">fifa20 &lt;- as_tibble(fifa20)</span><span id="2859" class="nd mh it nq b gy ny nv l nw nx">#remove players with no position<br/>fifa20 &lt;- fifa20 %&gt;% dplyr::filter(team_position != "")</span><span id="20d5" class="nd mh it nq b gy ny nv l nw nx">fifa20 &lt;- fifa20 %&gt;% separate(player_positions, c("player_position", NA, NA))</span><span id="2769" class="nd mh it nq b gy ny nv l nw nx">select1 &lt;- fifa20$team_position == "SUB"<br/>fifa20[select1, "team_position"] &lt;- fifa20[select1, "player_position"]</span><span id="90b4" class="nd mh it nq b gy ny nv l nw nx">select2 &lt;- fifa20$team_position == "RES"<br/>fifa20[select2, "team_position"] &lt;- fifa20[select2, "player_position"]</span><span id="21f4" class="nd mh it nq b gy ny nv l nw nx">#group team positions into 4 categories: goalkeepers, defenders, midfielders and attackers<br/>library(plyr)<br/>fifa20$team_position &lt;- mapvalues(fifa20$team_position, from = c("RW","LW","ST","CF","LS","RS","RF","LF"), <br/>          to = c("attack","attack","attack","attack","attack","attack","attack","attack"))</span><span id="41bd" class="nd mh it nq b gy ny nv l nw nx">fifa20$team_position &lt;- mapvalues(fifa20$team_position, from = c("LCB","RCB","LB","CB","RB","RWB","LWB"), <br/>          to = c("defense","defense","defense","defense","defense","defense","defense"))</span><span id="ddfb" class="nd mh it nq b gy ny nv l nw nx">fifa20$team_position &lt;- mapvalues(fifa20$team_position, from = c("CAM","RCM","CDM","LDM","RM","LCM","LM","RDM","RAM","CM","LAM"), <br/>          to = c("midfield","midfield","midfield","midfield","midfield","midfield","midfield","midfield","midfield","midfield","midfield"))</span><span id="d392" class="nd mh it nq b gy ny nv l nw nx">#keep the attributes common among goalkeepers, defenders, midfielders and attackers<br/>fifa20 &lt;- fifa20 %&gt;% select(team_position, age, height_cm, weight_kg, movement_acceleration, movement_sprint_speed, movement_agility, movement_reactions, movement_balance, power_shot_power, power_jumping, power_stamina, power_strength, power_long_shots)</span><span id="7aad" class="nd mh it nq b gy ny nv l nw nx">#standardize the data<br/>preObj3 &lt;- preProcess(fifa20[, -1], method=c("center", "scale"))<br/>newData3 &lt;- predict(preObj3, fifa20[, -1])<br/>fifa20 &lt;- cbind(newData3, team_position = fifa20$team_position)</span></pre><p id="b9da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将数据分成训练集和测试集。在训练集上拟合多项式逻辑回归模型，并分析4个类别中每个类别的系数。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="4046" class="nd mh it nq b gy nu nv l nw nx">#structure of the dataset<br/>str(fifa20)</span><span id="4855" class="nd mh it nq b gy ny nv l nw nx">set.seed(100)<br/>trainingRows &lt;- sample(1:nrow(fifa20), 0.75*nrow(fifa20))<br/>train &lt;- fifa20[trainingRows, ]<br/>test &lt;- fifa20[-trainingRows, ]</span><span id="4796" class="nd mh it nq b gy ny nv l nw nx">#library to train a multinomial model<br/>library(nnet)</span><span id="62c7" class="nd mh it nq b gy ny nv l nw nx">#set base class<br/>train$team_position &lt;- relevel(train$team_position, ref = "GK")</span><span id="8614" class="nd mh it nq b gy ny nv l nw nx">#train the model on the train set<br/>multinom.fit &lt;- multinom(team_position ~ . -1, data = train)</span><span id="bf3a" class="nd mh it nq b gy ny nv l nw nx">#model coefficients<br/>coef(multinom.fit)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/8466227d21718540985456b7f0b71de5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FNhpD6ir2Vf36eIawgJFgQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">多项式逻辑回归模型的属性系数<strong class="bd mf">(图片由作者提供)</strong></p></figure><p id="a99e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上面的系数图中，我们可以分析出与守门员相比，不同位置之间的差异。说到年龄，根据系数来看，门将比进攻球员和中场球员年龄大，比后卫年轻。守门员比攻击手、中场和后卫更重。他们的反应也比其他三个类别的球员更好，这很直观，因为他们需要闪电般的反应来扑救和偏转射门。系数显示，后卫、中场和进攻球员比守门员有更好的平衡能力，这也有直观的意义，因为守门员被限制在球场上的特定区域，而其他3类球员可以在奔跑时不断改变方向，覆盖整个球场，这需要大量的球上和球下的平衡。后卫，中场，进攻手在力量和远射方面也比GKs强。类似地，剩余属性的系数也可以被解释。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="11d8" class="nd mh it nq b gy nu nv l nw nx">#predict team positions on the test set<br/>predicted_probs &lt;- predict(multinom.fit, test, "probs")<br/>predicted_positions &lt;- predict(multinom.fit, test)</span><span id="ed7c" class="nd mh it nq b gy ny nv l nw nx">#confusion matrix<br/>confusionMatrix(test$team_position, predicted_positions)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/4a865011eed0859dc7b4a6c9aa24195e.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*7mpgtzHAJPJtm8_vjGH34A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">测试集混淆矩阵<strong class="bd mf">(图片由作者提供)</strong></p></figure><p id="fbfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上面的混淆矩阵中，我们可以看到很少有球员被错误地归类为守门员，因此我们可以说他们很容易被识别。许多进攻者和防守者被错误地归类为中场。这可能是因为进攻者和防守者的属性值类似于中场。中场球员几乎同样被错误地归类为进攻者和防守者。</p><p id="e801" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的分析中，我们包括了数据集中的所有玩家。我们也可以只对世界顶级联赛的球员进行类似的分析，比如英超、西甲、德甲、意甲、法甲和荷甲等。我们可以看到，当我们从上述联盟中排除球员时，错误分类率会更高还是更低。</p><h2 id="8bef" class="nd mh it bd mi ne nf dn mm ng nh dp mq li ni nj ms lm nk nl mu lq nm nn mw no bi translated">在位置之间切换:</h2><p id="2c1c" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">当一个球员在进攻者、中场和防守者之间转换时，应该关注身体、精神或比赛中的哪些方面？我们可以通过查看二项逻辑回归模型的属性系数来回答这个问题，在每个模型中，玩家来自两个位置。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="2b6d" class="nd mh it nq b gy nu nv l nw nx">f20 &lt;- fread('path to the dataset')<br/>f20 &lt;- as_tibble(f20)</span><span id="f652" class="nd mh it nq b gy ny nv l nw nx">f20 &lt;- f20 %&gt;% dplyr::filter(team_position != "")</span><span id="9857" class="nd mh it nq b gy ny nv l nw nx">f20 &lt;- f20 %&gt;% separate(player_positions, c("player_position", NA, NA))</span><span id="83e7" class="nd mh it nq b gy ny nv l nw nx">select2 &lt;- f20$team_position == "SUB"<br/>f20[select2, "team_position"] &lt;- f20[select2, "player_position"]</span><span id="0a6e" class="nd mh it nq b gy ny nv l nw nx">select3 &lt;- f20$team_position == "RES"<br/>f20[select3, "team_position"] &lt;- f20[select3, "player_position"]</span><span id="9489" class="nd mh it nq b gy ny nv l nw nx">#remove GKs from the dataset<br/>f20 &lt;- f20 %&gt;% dplyr::filter(team_position != "GK")</span><span id="9cbe" class="nd mh it nq b gy ny nv l nw nx">#remove redundant variables<br/>f20 &lt;- f20 %&gt;% select(-player_url, -long_name, -dob, -real_face, -player_tags, <br/>                                    -loaned_from, -joined, -player_position, -contract_valid_until,<br/>                                    -nation_position, -nation_jersey_number, -player_traits, -gk_diving,<br/>                                    -gk_handling, -gk_kicking, -gk_reflexes, -gk_speed, -gk_positioning,<br/>                                    -goalkeeping_diving, -goalkeeping_handling, -goalkeeping_kicking,<br/>                                    -goalkeeping_positioning, -goalkeeping_reflexes, <br/>                                    -ls, -st, -rs, -lw, -lf, -cf, -rf, -rw, -lam, -cam, -ram, <br/>                                    -lm, -lcm, -cm, -rcm, -rm, -lwb, -ldm, -cdm, -rdm, -rwb, <br/>                                    -lb, -lcb, -cb, -rcb, -rb, -work_rate, -sofifa_id,<br/>                             -short_name, -nationality, -club, -body_type, -team_jersey_number, -preferred_foot, -age,  -height_cm, -value_eur, -wage_eur, -potential, -international_reputation, -release_clause_eur, -overall)</span><span id="c1a2" class="nd mh it nq b gy ny nv l nw nx">#group team positions into attack, midfield and defense<br/>f20$team_position &lt;- mapvalues(f20$team_position, from = c("RW","LW","ST","CF","LS","RS","RF","LF"), <br/>          to = c("attack","attack","attack","attack","attack","attack","attack","attack"))</span><span id="2d71" class="nd mh it nq b gy ny nv l nw nx">f20$team_position &lt;- mapvalues(f20$team_position, from = c("LCB","RCB","LB","CB","RB","RWB","LWB"), <br/>          to = c("defense","defense","defense","defense","defense","defense","defense"))</span><span id="a8c4" class="nd mh it nq b gy ny nv l nw nx">f20$team_position &lt;- mapvalues(f20$team_position, from = c("CAM","RCM","CDM","LDM","RM","LCM","LM","RDM","RAM","CM","LAM"), <br/>          to = c("midfield","midfield","midfield","midfield","midfield","midfield","midfield","midfield","midfield","midfield","midfield"))</span><span id="e958" class="nd mh it nq b gy ny nv l nw nx">#standardize the data<br/>preObj4 &lt;- preProcess(f20[, -4], method=c("center", "scale"))<br/>newData4 &lt;- predict(preObj4, f20[, -4])<br/>f20 &lt;- cbind(newData4, team_position = f20$team_position)</span></pre><p id="190d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">前锋vs中场:</strong></p><p id="c53d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如前所述，玩家可以出于多种原因切换位置。让我们来看看当一个球员从一个攻击手转变为一个中场时，他必须专注于什么属性，反之亦然。</p><pre class="kj kk kl km gt np nq nr ns aw nt bi"><span id="a046" class="nd mh it nq b gy nu nv l nw nx">#include only attackers and midfielders<br/>f20_am &lt;- f20 %&gt;% dplyr::filter(team_position %in% c("attack","midfield"))<br/>f20_am$team_position &lt;- as.character(f20_am$team_position)</span><span id="3708" class="nd mh it nq b gy ny nv l nw nx">#encode attack as the positive class<br/>f20_am$team_position[f20_am$team_position == "attack"] &lt;- 1<br/>f20_am$team_position[f20_am$team_position == "midfield"] &lt;- 0<br/>f20_am$team_position &lt;- as.numeric(f20_am$team_position)</span><span id="e7ee" class="nd mh it nq b gy ny nv l nw nx">#binomial logistic regression model<br/>am_fit &lt;- glm(team_position ~ ., data = f20_am, family = "binomial")<br/>summary(am_fit)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/5b4b5e7d35b631608b31518ed2829724.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YriJVIY_wuoqwv06V8e0Uw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">进攻者对中场模型的属性系数<strong class="bd mf">(图片由作者提供)</strong></p></figure><p id="231c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上图中，我们看到<em class="md">‘弱_脚’，‘攻_传’，‘攻_整理’，‘攻_截击’，‘技_准’，‘技_长_传’，‘心态_定位’，‘心态_罚’</em>，<em class="md">，‘心态_沉着’</em>是我们进攻者vs中场模型中的显著属性。</p><p id="22fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">进攻者比中场球员更擅长完成任务，即进球能力、凌空抽射、定位(即在场上正确的位置进球)、点球和场上沉着冷静。由于上述属性的系数估计为正，这些属性的增加与玩家成为攻击者的机会的增加相关联。</p><p id="6312" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">中场球员比进攻球员更擅长利用他们的弱点，传球，任意球和长传。由于上述属性的系数估计是负的，这些属性的增加与玩家成为攻击者的机会的减少相关联。</p><p id="92e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以上两种解释都有很强的直觉，数据也为我们的直觉提供了有力的证据。谈到在不同位置之间转换的球员，为了让一名中场球员成为一名进攻者，一个人应该专注于射门，截击，定位，点球和冷静。对于一个成为中场的进攻者来说，他应该专注于传中，利用他们的弱脚，任意球和长传。</p><p id="ed5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以对另外两对进行类似的分析，即进攻者对防守者和中场对防守者。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="fde6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据分析和数据科学只会在体育界变得更加突出，而不仅仅是在足球界。随着时间的推移，我们将看到越来越多的球队和俱乐部雇佣数据科学家和分析师，为业务和战术决策寻找数据驱动的解决方案。球队可以通过避免出价购买不符合要求标准的球员来减少转会窗口期间的财务损失，球员可以改善他们比赛中肉眼不一定明显的方面，经理可以在分析和机器学习技术的帮助下提出训练方案和战术来赢得更多比赛。</p></div></div>    
</body>
</html>