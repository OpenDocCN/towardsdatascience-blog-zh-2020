<html>
<head>
<title>Optical Character Recognition (OCR) with less than 10 Lines of Code using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python的不到10行代码的光学字符识别(OCR)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/optical-character-recognition-ocr-with-less-than-12-lines-of-code-using-python-48404218cccb?source=collection_archive---------3-----------------------#2020-04-09">https://towardsdatascience.com/optical-character-recognition-ocr-with-less-than-12-lines-of-code-using-python-48404218cccb?source=collection_archive---------3-----------------------#2020-04-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f4f7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用pytesseract将图像中的文本转换为可编辑的数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1b65e11093aa4ca734d39f70ffec6b9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ho0QGDfJzFXw9wpzGeLriQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">资料来源:Gerd Altmann (pixabay)</p></figure><blockquote class="ky kz la"><p id="b7f7" class="lb lc ld le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">假设您有一个文档，想要提取它的文本，而不是自己键入整个内容。</p></blockquote><p id="6766" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">本文中的几行代码将会加快这个过程，并真正节省时间。</p><p id="f564" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">必须考虑的一些事情是你有什么样的文件或图像，它的质量如何，以及书面内容是手写的还是计算机字体。(显然，计算机字体比手写文本更有可能达到更高的准确度。)</p><p id="b01c" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">以下几点也可能影响精度:</p><ul class=""><li id="fe53" class="mb mc it le b lf lg li lj ly md lz me ma mf lx mg mh mi mj bi translated">字体太小或者文本通常只占图像的一小部分</li><li id="b293" class="mb mc it le b lf mk li ml ly mm lz mn ma mo lx mg mh mi mj bi translated">图像尺寸太小(没有足够的像素来很好地检测字体)</li><li id="d39a" class="mb mc it le b lf mk li ml ly mm lz mn ma mo lx mg mh mi mj bi translated">图像的光线质量不好</li><li id="92cb" class="mb mc it le b lf mk li ml ly mm lz mn ma mo lx mg mh mi mj bi translated">字体不能很好地与背景分开</li><li id="5f1b" class="mb mc it le b lf mk li ml ly mm lz mn ma mo lx mg mh mi mj bi translated">字体或文档歪斜或扭曲</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/d421a84603fe4111a39dfc45d1476ee5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W3bDw8mNI-GI-F_mro3XMg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输入图像。</p></figure><p id="2638" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">你需要的只是几个安装，你的文件和你就可以走了。让我们看看我们需要导入什么(确保您之前安装了pip):</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="ed71" class="mv mw it mr b gy mx my l mz na">import cv2</span><span id="7fcf" class="mv mw it mr b gy nb my l mz na">import pytesseract</span><span id="ba91" class="mv mw it mr b gy nb my l mz na">import numpy as np</span></pre></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><h1 id="dbea" class="nj mw it bd nk nl nm nn no np nq nr ns jz nt ka nu kc nv kd nw kf nx kg ny nz bi translated">想看更多这样的故事？每月仅需4.16美元。</h1><h1 id="d447" class="nj mw it bd nk nl oa nn no np ob nr ns jz oc ka nu kc od kd nw kf oe kg ny nz bi translated"><a class="ae of" href="https://medium.com/@hucker.marius/membership" rel="noopener">开始使用</a></h1></div><div class="ab cl nc nd hx ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="im in io ip iq"><p id="f4e9" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">安装后，我们需要使用openCV加载映像，openCV安装在cv2下。如果该图像不是仅由黑白像素组成的图像，则需要将其转换为二进制图像(对于二进制图像，您可以跳过存储在gray变量中的两行代码)。首先对二进制图像进行灰度化，然后执行算术运算，在这种情况下就是按位非运算。灰度转换采用图像的三个RGB值，并使用以下公式进行转换</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/8cf50d7ab347b0f3b7980482850fae95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WMrHYR6gbo9pq93744-4IQ.png"/></div></div></figure><p id="539b" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">转换为代表灰色阴影的单个值。每个像素的值在0到255的范围内，255是最亮的灰色(白色)，0是最暗的灰色(黑色)。之后，阈值处理用于决定像素值是低于还是高于某个阈值。下面的所有像素都变成白色像素，上面的所有像素都变成黑色像素，结果是一个二进制图像。由于二值图像具有白色背景和黑色前景，即字母或符号，因此需要反转图像。这是通过<em class="ld">逐位非</em>运算完成的。每一个为1并因此为白色的像素被转变为黑色像素，每一个为0并因此为黑色的像素被转变为白色像素。</p><p id="07e4" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">阅读更多关于灰度、RGB和数字图像处理的信息<a class="ae of" href="https://medium.com/@hucker.marius/understanding-the-basics-of-digital-image-processing-and-computer-vision-using-opencv-8bc0e67243c8" rel="noopener">点击这里</a>。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="00cf" class="mv mw it mr b gy mx my l mz na">img = cv2.imread('/Users/marius/Desktop/jimdoo.png')</span><span id="f213" class="mv mw it mr b gy nb my l mz na"><strong class="mr iu">#Alternatively: can be skipped if you have a Blackwhite image<br/></strong>gray = cv2.cvtColor(img, cv2.COLOR_RGB2GRAY)<br/>gray, img_bin = cv2.threshold(gray,128,255,cv2.THRESH_BINARY | cv2.THRESH_OTSU)<br/>gray = cv2.bitwise_not(img_bin)</span></pre><p id="985c" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">然后我们需要做一些形态学操作来去除字符周围的噪声。我们使用的两种运算是腐蚀和膨胀。首先，我们定义一个2×1像素的内核，它滑过图像并执行操作。腐蚀用于检测内核是包含白色前景像素还是黑色背景像素。如果内核填充有白色像素，则原始图像中的像素将被视为1，因此是白色的。如果内核包含黑色像素，原始像素将被视为黑色。因此，白线被侵蚀。侵蚀的形态学对应部分是扩张。如果内核下的至少一个像素是白色的，则原始图像的预期像素将被视为白色。因此，白色区域被扩大。在图像预处理中，腐蚀和膨胀经常以所提出的顺序结合起来以去除噪声。</p><pre class="kj kk kl km gt mq mr ms mt aw mu bi"><span id="47be" class="mv mw it mr b gy mx my l mz na">kernel = np.ones((2, 1), np.uint8)</span><span id="9201" class="mv mw it mr b gy nb my l mz na">img = cv2.erode(gray, kernel, iterations=1)</span><span id="edb3" class="mv mw it mr b gy nb my l mz na">img = cv2.dilate(img, kernel, iterations=1)</span><span id="7689" class="mv mw it mr b gy nb my l mz na">out_below = pytesseract.image_to_string(img)</span><span id="a08b" class="mv mw it mr b gy nb my l mz na">print("OUTPUT:", out_below)</span></pre><p id="411b" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">结果是下面的文本。请注意，宇宙魔方有几个检测选项，包括不同的语言。所以如果你想把它换成一种不同于英语的语言，你必须对它稍作调整。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/0fc1b0f90f6ede1ad820d30d3004f032.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hWh_Kz00xSPUrg5xvXU4oQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">输出的图像。</p></figure><p id="05b1" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">感谢您的阅读，希望您对OCR有所了解！<br/>我感谢反馈。</p><p id="796a" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">另请阅读<a class="ae of" href="https://medium.com/@hucker.marius/understanding-the-basics-of-digital-image-processing-and-computer-vision-using-opencv-8bc0e67243c8" rel="noopener">了解数字图像处理和计算机视觉的基础知识。</a></p><div class="oi oj gp gr ok ol"><a href="https://medium.com/subscribe/@hucker.marius" rel="noopener follow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">请继续关注马里乌斯·哈克的新文章</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">请继续关注Marius Hucker的新文章。如果您还没有注册，您将创建一个中型帐户…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">medium.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz ks ol"/></div></div></a></div></div></div>    
</body>
</html>