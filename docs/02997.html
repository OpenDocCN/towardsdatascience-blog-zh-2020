<html>
<head>
<title>Perform In-depth Analysis on the Global COVID-19 Pandemic</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对全球新冠肺炎疫情进行深入分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-in-depth-analysis-of-the-global-pandemic-of-covid-19-bd5a3bdea155?source=collection_archive---------26-----------------------#2020-03-22">https://towardsdatascience.com/an-in-depth-analysis-of-the-global-pandemic-of-covid-19-bd5a3bdea155?source=collection_archive---------26-----------------------#2020-03-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/226760b6a5c536ab9b7c1ac083c7996e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EpqSQ35eyjKnpzl9vj_Aig.png"/></div></div></figure><h1 id="642e" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">使用这些工具掌握数据可视化</h1><h2 id="3655" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">新冠肺炎疫情在全球范围内相比如何？</h2><p id="4bb4" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">我最近发表了一篇文章，探讨了约翰·霍普斯金大学最近在新冠肺炎发布的数据；虽然我们能够做出一些有趣的发现，但收集数据提供更全面的情况似乎是恰当的。</p><p id="9e8d" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">亲自访问此页面获取数据:<a class="ae mo" href="https://www.tableau.com/covid-19-coronavirus-data-resources" rel="noopener ugc nofollow" target="_blank">https://www.tableau.com/covid-19-coronavirus-data-resources</a></p><p id="c669" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">让我们立即开始一些基本的探索性数据分析。</p><h1 id="7a69" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">数据熟悉</h1><p id="fe08" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">下载下来拉进来！</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="4bc8" class="kz kc it mu b gy my mz l na nb">covid_tab &lt;- read.csv('covid_tableau.csv')</span></pre><p id="e9f9" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">让我们看看如何使用<code class="fe nc nd ne mu b">head</code>功能！</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="7389" class="kz kc it mu b gy my mz l na nb">head(covid_tab)</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/5bb35a0c84a001a18882c2cc9d49a798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*if_UMDEkAebuEFD5"/></div></div></figure><p id="e82d" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">我在这里的第一个要求是，这是在日期、国家、省、案例类型级别上构建的。类似于JHU的数据，但有一个关键的区别。这就是案件类型。如果我们能够了解在任何给定的地点和时间的活动、死亡和恢复的分类，这对我们评估情况及其进展有很大帮助。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/3ed2fd248325283e6c64961aa79cba87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Y5qvJ8-6YGIZ7RbO"/></div></div></figure><p id="9d6e" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">您还会注意到，差异列表示每种案例类型每天的变化，而案例是当前的总数。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="e6eb" class="kz kc it mu b gy my mz l na nb">glimpse(covid_tab)</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/2f5b65173442413fadb03a3f504c624c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tJWJkCXFhRizcwVy"/></div></div></figure><p id="0e9f" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">Glimpse还提供了数据集维度、数据类型、样本等的一些上下文。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="6989" class="kz kc it mu b gy my mz l na nb">summary(covid_tab)</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/dfc982b5e99d401b114b17613c138a2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nNpLj3ZThQ9Nv9De"/></div></div></figure><p id="3375" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">这根据数据类型给出了一些有趣的统计数据。数值的范畴、最小值、最大值、四分位数、平均值、中值的出现次数。</p><p id="6ba0" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">另一个快速注意事项是，我发现案例类型有以下值:</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/9a1f4eb89b22b6f256170eb0f0c00512.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/0*yrMYS0OnYhUK1YEf"/></div></figure><p id="8666" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">我想了解活动、死亡和恢复加起来是否等于确认，它们是否相互排斥，或者这些不同的值将如何被利用。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="0ae7" class="kz kc it mu b gy my mz l na nb">covid_tab %&gt;% group_by(Country_Region, Case_Type ) %&gt;% summarise(max(Cases))</span></pre><p id="a793" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">按国家/地区和案例类型分组，因为我知道案例是累积的，所以我只取了最大值，并评估了它们是如何累加的。</p><p id="dc96" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">看看这个样本！</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/82568eeb2389e44e7df35cc55ede9399.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/0*iB-QF79jaQ80auZQ"/></div></div></figure><p id="721a" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">以阿富汗和阿尔巴尼亚为例，您可以看到活动、死亡和康复加起来就是确诊。</p><h1 id="2b8c" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">睁大你的眼睛！</h1><p id="19b9" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">在我们继续之前，有一个小提示，您可能已经注意到，当我们运行<code class="fe nc nd ne mu b">glimpse</code>时，<code class="fe nc nd ne mu b">Date</code>列作为一个因素被调用。</p><p id="7eea" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">为什么这是一个问题？</p><p id="98f0" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">因为任何可视化都会把因子值当作字符串，并相应地排序。</p><p id="977b" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">看看下面的图表。我们所看到的中间的大幅下降实际上代表了这个月的前几天。</p><p id="944c" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">使用像这样的基本命令来清理它。注意你需要使用的格式。我不会在这里深究，但是让函数知道数据“来自”哪里是很重要的。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="3bbc" class="kz kc it mu b gy my mz l na nb">covid_tab$Date &lt;- as.Date(covid_tab$Date, format = "%m/%d/%Y")</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/b1072ccbc3207b986b1c90735fb912b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Zmc3H4sXxOqR554x"/></div></div></figure><p id="61fe" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">如果我们现在再次运行该命令，我们会得到以下结果</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/a196ba60f1c50ea312ea5f8de33d2cc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gyC3RX1B3a4iCc7b"/></div></div></figure><p id="bc65" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">作为探索性数据分析的一部分，还可以经历许多其他步骤；与其在这里继续，我们将深入一些数据可视化。</p><h1 id="4569" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">可视化趋势、模式和关系！</h1><h2 id="5a2b" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">一次一个开始</h2><p id="d03d" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">现在我们对数据有了一个很好的理解</p><p id="17c9" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">跳进…我刚刚在上面展示了这个，但是我将展示我们如何到达那里。</p><p id="55a5" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">在这里，我们希望看到所有累计确诊病例。</p><p id="486d" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">我采用数据框架，过滤“已确认”病例，按日期分组，按病例汇总，并创建一个条形图。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="dcb1" class="kz kc it mu b gy my mz l na nb">covid_tab %&gt;% filter(Case_Type == 'Confirmed')%&gt;% <br/> group_by(Date) %&gt;% <br/> summarise(Cases = sum(Cases))%&gt;% <br/> ggplot(aes(x = Date, y = Cases))+ geom_bar(stat = 'identity')+   <br/> theme(axis.text.x = element_text(angle = 45))</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/5d83f72f39667b04dfd798978688085b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-hHnVUlLoAYNDfuE"/></div></div></figure><p id="0fdb" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">然后，我们可以针对每种案例类型再次执行此操作。对于探索性的数据分析过程来说，这通常很有意义。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="1930" class="kz kc it mu b gy my mz l na nb">covid_tab %&gt;%<br/> filter(Case_Type == 'Deaths')%&gt;%<br/> group_by(Date)%&gt;% <br/> summarise(Deaths = sum(Cases))%&gt;% ggplot(aes(x = Date, y =<br/> Deaths))+ <br/> geom_bar(stat = 'identity')+ theme(axis.text.x = element_text(angle<br/> = 45))</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/1014daec2c3d3a1a62668f5e26bf65b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1rGP6eF1rYOfTLj-"/></div></div></figure><p id="4c27" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">类似地，我们可以这样做来表示死亡的每日变化，只是通过按<code class="fe nc nd ne mu b">Difference</code>字段汇总死亡来代替。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="94cd" class="kz kc it mu b gy my mz l na nb">covid_tab %&gt;%<br/> filter(Case_Type == 'Deaths')%&gt;%<br/> group_by(Date)%&gt;%<br/> summarise(Deaths = sum(Difference))%&gt;%<br/> ggplot(aes(x = Date, y = Deaths))+<br/> geom_bar(stat = 'identity')+<br/> theme(axis.text.x = element_text(angle = 45))</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/1bd2bce16d2b7de7f31ce21ef2421d7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qvWbA98n9rlRqUsH"/></div></div></figure><h1 id="5ea8" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">可视化多个变量</h1><h2 id="12d2" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">案例、国家和案例类型之间有什么关系？</h2><p id="f51e" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">类似于我们上面创建的，下面我们做同样的事情，现在按他们的<code class="fe nc nd ne mu b">Case_Type</code>分解总数。</p><p id="7683" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">正如你在我的代码中看到的，我已经从<code class="fe nc nd ne mu b">Case_Type</code>中删除了所有出现的‘确认’一词。我想我们可以包括它，它看起来就像一个求和条，紧挨着更多的粒度条。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="580b" class="kz kc it mu b gy my mz l na nb">covid_tab %&gt;%<br/> filter(!grepl('Confirmed', Case_Type)) %&gt;%<br/> group_by(Date, Case_Type) %&gt;%<br/> summarise(Cases = sum(Cases))%&gt;%<br/> ggplot(aes(x = Date, y = Cases, fill = Case_Type))+<br/> geom_bar(stat = 'identity')+<br/> theme(axis.text.x = element_text(angle = 45))</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/566d5cddc7fc88b1b13142ab2e211450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lUbhiUAapM4H6Hpp"/></div></div></figure><p id="fbdf" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">虽然这种观点是好的，但我实际上更喜欢包括位置参数“道奇”。那么这个图表在case_type的不同值之间看起来会更有可比性。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="d6ff" class="kz kc it mu b gy my mz l na nb">covid_tab %&gt;%<br/> filter(!grepl('Confirmed', Case_Type))%&gt;%<br/> group_by(Date, Case_Type)%&gt;%<br/> summarise(Cases = sum(Cases))%&gt;%<br/> ggplot(aes(x = Date, y = Cases, fill = Case_Type))+<br/> geom_bar(stat = 'identity', position = 'dodge')+<br/> theme(axis.text.x = element_text(angle = 45))</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/7b425adecd94262df3e9dc10df36e6f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0rwbeZJ9XenYVBS8"/></div></div></figure><p id="e4a3" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">现在，我们对这些数字每天的变化有了更好的了解。我们看到3月初活跃案例大幅下降，上周左右又有所回升。</p><p id="df41" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">恢复的案例持续增长，甚至超过了总活跃案例，几周后再次领先。</p><h2 id="a99e" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">每日差异情况</h2><p id="9dc1" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">我们在这里看到的是，活跃病例的新发生率在2月底大幅下降，但随后在3月中旬大幅上升。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="1f51" class="kz kc it mu b gy my mz l na nb">covid_tab %&gt;%<br/> filter(!grepl('Confirmed', Case_Type))%&gt;%<br/> group_by(Date, Case_Type)%&gt;%<br/> summarise(Difference = sum(Difference))%&gt;%<br/> ggplot(aes(x = Date, y = Difference, fill = Case_Type))+   <br/> geom_bar(stat = 'identity')+<br/> theme(axis.text.x = element_text(angle = 45))</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/a387f648896caf7897d715013f04b5c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aQ8QWEPFPs0o1lBC"/></div></div></figure><p id="160d" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">应该有助于更好地告知这是从哪里来的是通过地理变量打破这一点。我们将从国家级开始，然后再看看省级。</p><h2 id="0a5b" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">深入了解国家和案例类型</h2><p id="5b44" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">这段代码需要解释一些事情。RStudio中的图例被夸大了，因为该数据集中包含了100多个国家。所以我创建了国家总数，在给定的时间内取最高的病例数。然后，我将它加入到我们一直使用的熟悉的命令中，并使用它来过滤出没有达到给定病例数的国家，这给了我们最高的16个左右的国家。</p><p id="d230" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">在那里，我们创建一个类似的可视化，这次用country替换case type。我们可以将多个类别合并到我们的可视化中，但我们将把它留到以后。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="a782" class="kz kc it mu b gy my mz l na nb">country_totals &lt;- covid_tab %&gt;%<br/> group_by(Country_Region)%&gt;%<br/> summarise(max_cases = max(Cases)) covid_tab %&gt;%<br/> left_join(country_totals, by = 'Country_Region')%&gt;%<br/> filter(grepl('Confirmed', Case_Type) &amp; max_cases &gt;= 1000)%&gt;% <br/> group_by(Date, Case_Type, Country_Region)%&gt;%<br/> summarise(Cases = sum(Cases))%&gt;%<br/> ggplot(aes(x = Date, y = Cases, fill = Country_Region))+<br/> geom_bar(stat = 'identity')+<br/> theme(axis.text.x = element_text(angle = 45))</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/629dc5de42e0644f81f5802ddadfdfdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*dAKzvduoit28fCCy"/></div></div></figure><p id="764d" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">正如你所猜测的，你可以看到中国在大部分疫情中占主导地位，意大利自2月下旬以来出现。</p><p id="b48c" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">现在让我们用每日差异来检查一下。在这里，我们看到的是活动案例数量的每日变化。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="f802" class="kz kc it mu b gy my mz l na nb">covid_tab %&gt;%<br/> left_join(country_totals, by = 'Country_Region')%&gt;%<br/> filter(grepl('Active', Case_Type) &amp; max_cases &gt;= 1000 &amp; Date &gt; <br/> '2 020-02-15')%&gt;%<br/> group_by(Date, Case_Type, Country_Region)%&gt;%<br/> summarise(Difference = sum(Difference))%&gt;%<br/> ggplot(aes(x = Date, y = Difference, fill = Country_Region))+<br/> geom_bar(stat = 'identity', position = 'dodge')+<br/> theme(axis.text.x = element_text(angle = 45))</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/0e5bc6b8d7ddabf07a8a72e3a6166816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JFa8y8OQFXCS5CaT"/></div></div></figure><p id="e3da" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">这产生了一个有趣的一瞥，让我们了解在任一方向上给定时间的变化强度。</p><h1 id="9275" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">包含多个类别</h1><h2 id="28fd" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">刻面</h2><p id="fa1e" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">这不是最漂亮的视觉效果，因为在下面的分面图中，国家有很多级别，每个窗格的体积也不一样。也就是说，打破这种多分类变量可以提供一个有趣的视角。</p><p id="0764" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">与前面的命令类似，这里我们在底部添加了facet_wrap命令，这使得我们将图表分成不同的窗格，以显示包含的分类变量的每个值。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="fccf" class="kz kc it mu b gy my mz l na nb">covid_tab%&gt;%<br/> left_join(country_totals, by = 'Country_Region')%&gt;%<br/> filter(!grepl('Confirmed', Case_Type) &amp; max_cases &gt;= 1000 &amp; Date &gt;<br/> '2020-02-15') %&gt;% group_by(Date, Case_Type, Country_Region) %&gt;%<br/> summarise(Cases = sum(Cases))%&gt;% ggplot(aes(x = Date, y = Cases,<br/> fill = Country_Region))+ geom_bar(stat = 'identity', position =<br/> 'dodge')+ theme(axis.text.x = element_text(angle = 45))+<br/> facet_wrap(~Case_Type)</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/13123687108d13f090519fa1197a5df4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-Lbg-P8BxWGEg3U7"/></div></div></figure><p id="cab5" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">在活跃窗格中，我们可以看到中国的活跃数量明显下降，而意大利在上周的大多数情况下迅速上升，超过了中国。</p><p id="b70e" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">对于死亡，我们可以通过这个时间窗口看到中国保持静止，而意大利在增长。</p><p id="1434" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">由于明显滞后于中国的爆发，其他国家仍比其复苏曲线晚几天或几周。</p><h2 id="e9cb" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">没有中国</h2><p id="8abc" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">我们可以做同样的事情，只是排除中国，以更好地了解疫情更为流行的相对情况。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/9204aafbe5ccf6bf5ef95f90b2755bea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qWYItWU8bIDCGsqp"/></div></div></figure><h2 id="3ecd" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">让我们仔细看看</h2><p id="274d" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">这里有趣的是我们在第一个窗格中看到的。关注的不是数量，而是任何一个国家的曲线形状。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/4abbb6ba285f525f159881e9d38f06ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IXN7FH0THVeebeXX"/></div></div></figure><p id="def8" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">虽然我们看到一些指数增长，相反，韩国经历了这种对称分布；病例上升的速度几乎和病例下降的速度一样快。</p><h2 id="2438" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">让我们按国家分面</h2><p id="7dfd" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">我们现在将把这张图表分成几个部分，以便更清楚地看到国与国之间的差异。</p><p id="7205" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">请记住，这种模式可能是由于测试斜坡。围绕大规模测试有传言称，韩国推出得非常快。我不知道不同国家的测试部署/斜坡有什么不同，所以我不能说，但这是要记住的事情。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/ea2d5a10cdc4fdeecb9307ad66651bb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JHg4tb0PzIqqN3Sb"/></div></div></figure><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="12a6" class="kz kc it mu b gy my mz l na nb">covid_tab %&gt;%<br/> filter(!grepl('Confirmed', Case_Type) &amp;<br/> grepl('China|Korea|US|United Kingdom|Italy|Spain|Iran',<br/> Country_Region) &amp; Date &gt; '2020-02-15')%&gt;%<br/> group_by(Date, Case_Type, Country_Region)%&gt;%<br/> summarise(Cases = sum(Cases))%&gt;%<br/> ggplot(aes(x = Date, y = Cases, fill = Case_Type))+<br/> geom_bar(stat = 'identity', position = 'dodge')+<br/> theme(axis.text.x = element_text(angle = 45))+<br/> facet_wrap(~Country_Region)</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/e1f341c18827b5ca66f8bc29d17e9786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*doocusIm-xmKb8aZ"/></div></div></figure><p id="d721" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">下面，我将删除中国，以提高其他落后国家的可解释性。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/6a717002c0ea31a392d5092a7eb9d3da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pvkod3sJAqNHPMOq"/></div></div></figure><h1 id="26a2" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">与意大利的直接比较</h1><p id="af39" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">谈到我们当前的发展轨迹，人们把美国比作意大利。已经说过很多次了，我们落后他们10天。我们来调查一下！</p><p id="20f8" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">我想做的是确定某个国家的第一例冠状病毒，并从那里给出自爆发以来的每一天。然后我们将在X轴上画出这个，看看我们看起来比意大利落后多少天。这将有助于我们了解不同国家之间的相似或相异之处。</p><p id="6950" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">我做的第一件事是创建第一天的数据集。在这里，我们按国家分组，筛选出任何爆发前的日期，并取第一个日期。</p><p id="54e4" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">然后，我们将其加入到我们的数据集中，并将days_since_outbreak指标作为我们的x轴。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="86fe" class="kz kc it mu b gy my mz l na nb">first_day &lt;- covid_tab%&gt;%<br/> filter(grepl('Active', Case_Type) &amp; grepl('US|Italy', Country_Region) &amp; Cases &gt; 0)%&gt;%<br/> group_by(Country_Region)%&gt;%<br/> summarise(first_date = min(Date)) </span><span id="b6bd" class="kz kc it mu b gy ni mz l na nb">covid_tab %&gt;%<br/> filter(grepl('Active', Case_Type) &amp; grepl('US|Italy', Country_Region))%&gt;%<br/> group_by(Date, Case_Type, Country_Region)%&gt;%<br/> summarise(Cases = sum(Cases))%&gt;% left_join(first_day, by = 'Country_Region')%&gt;%<br/> mutate(days_since_outbreak = as.numeric(as.Date(Date) - as.Date(first_date)))%&gt;%<br/> ggplot(aes(x = days_since_outbreak, y = Cases, fill = Country_Region))+<br/> geom_bar(stat = 'identity', position = 'dodge')</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/84f1a3aa6ea4d025866d1e381686483d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HM6zOqLTW8RSPgfk"/></div></div></figure><p id="635a" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">看一下自爆发以来的天数…</p><p id="66da" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">令人惊讶的是，美国的第一个病例实际上是在2010年1月23日确诊的。美国的增长在大约一个月的时间里没有真正开始。请记住，这在很大程度上取决于报告。</p><p id="5e72" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">相反，意大利的第一天是在8天后的1月31日。有趣的是他们经历指数增长的速度有多快。</p><p id="9429" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">我又做了一次，但是我选择了“第一次约会”,是根据每个国家发展非常迅速的日期。这里我们可以看到，一旦美国达到类似的轨迹，我们实际上看到感染的速度更快。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nj"><img src="../Images/ac686bab000bc2a31ed2fae87c2b5fea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yIwxnI2RG4MDOQOGbpQhkA.png"/></div></div></figure><p id="c9ad" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">人们可以立即推测说，也许美国已经更快地动员了测试能力——这可能是我们看到更快增长的原因，或者，这可能是由于缺乏早期干预。不言而喻，这可能是由于任何其他因素。</p><h2 id="c491" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">看看韩国</h2><p id="6816" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">韩国是测试速度最快的国家。让我们来看看他们是如何比较一致的。</p><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nk"><img src="../Images/89227891826e8e56b7f7a9deb4f317e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XrJnGh53pyOW4lKGWKJkOg.png"/></div></div><p class="nl nm gj gh gi nn no bd b be z dk translated">南韩驱车通过新冠肺炎测试站</p></figure><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/226760b6a5c536ab9b7c1ac083c7996e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EpqSQ35eyjKnpzl9vj_Aig.png"/></div></div></figure><p id="0bea" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">正如我们所看到的，在韩国曲线开始变平之前，增长在几周内保持相似。这并不一定能告诉我们任何关于测试能力或测试速度的信息，但它确实提供了一幅有趣的图片，展示了每个国家的相对增长和下降；当然也回避了这样一个问题:韩国是如何如此迅速地拉平曲线的？</p><h1 id="c028" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">增长</h1><p id="8b34" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">最大的担忧之一是病毒的增长。病毒会以多快的速度席卷任何一个国家？</p><p id="7835" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">与我们所做的其他一些分析类似，我想观察各个国家的增长率。</p><p id="d3d5" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">我是这样计算增长率的:今天的总例数—昨天的例数/昨天的例数；从而得出与昨天总数相关的每日变化。</p><p id="1ee6" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">您将在下面的代码片段中看到，在按日期排序并按国家分组后，我使用了lag函数将前一天的总数提取到当天的记录中。</p><p id="5275" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">从那里，我简单地用先前定义的公式创建了一个字段。</p><p id="4b04" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">我还重新考虑了将第0天定为病毒活跃的第一天的想法。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="763b" class="kz kc it mu b gy my mz l na nb">covid_growth &lt;- covid_tab%&gt;%<br/> filter(grepl('Active', Case_Type) &amp; grepl('China|Korea|US|United<br/> Kingdom|Italy|Spain|Iran', Country_Region))%&gt;%<br/> group_by(Date, Case_Type, Country_Region)%&gt;%<br/> summarise(Difference = sum(Difference), Cases = sum(Cases))%&gt;%<br/> arrange(Date)%&gt;% group_by(Country_Region)%&gt;%<br/> mutate(lag_cases = lag(Cases), growth = round((Cases - lag_cases) / lag_cases,2))%&gt;%<br/> ungroup()%&gt;%<br/> left_join(first_day, by = 'Country_Region')%&gt;%<br/> mutate(days_since_outbreak = as.numeric(as.Date(Date) -<br/> as.Date(first_date)))</span><span id="4c06" class="kz kc it mu b gy ni mz l na nb">covid_growth%&gt;%<br/> filter(days_since_outbreak &gt; 0)%&gt;%<br/> ggplot(aes(x = days_since_outbreak, y = growth, col =<br/> Country_Region))+<br/> geom_line(stat = 'identity')</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/03fc246c704564076086d4b6b3116e06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XGH2XfVOHgptniB3"/></div></div></figure><p id="ca82" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">鉴于不祥的“翻倍率”，日增长率的下降令人欣慰。“倍增率”是一个在病毒背景下经常被提及的指标。它代表给定国家的病毒在一天内翻倍的天数。在1附近有一条一致的线，我们可以假设一个翻倍率持续保持强劲。</p><p id="00a8" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">很明显，有些日子的增长率高达前一天的4倍，但好消息是，我们看到百分比增长率一天比一天持续下降。</p><h1 id="8c66" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">结论</h1><p id="06e6" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">还有更多的东西可以投入进去！</p><p id="a0aa" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">我希望这已经被证明是有用的，因为你试图更好地了解世界上正在发生的事情，你的公司，或者你正在做的任何事情！</p><p id="25fb" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated">数据科学快乐！</p><p id="4d5c" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated"><strong class="lq iu"> <em class="np">编者按:</em> </strong> <em class="np"> </em> <a class="ae mo" href="http://towardsdatascience.com/" rel="noopener" target="_blank"> <em class="np">走向数据科学</em> </a> <em class="np">是一份以数据科学和机器学习研究为主的中型刊物。我们不是健康专家或流行病学家，本文的观点不应被解释为专业建议。想了解更多关于疫情冠状病毒的信息，可以点击</em> <a class="ae mo" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports" rel="noopener ugc nofollow" target="_blank"> <em class="np">这里</em> </a> <em class="np">。</em></p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><p id="a7cd" class="pw-post-body-paragraph lo lp it lq b lr mj lt lu lv mk lx ly le ml ma mb lh mm md me lk mn mg mh mi im bi translated"><em class="np">原载于2020年3月22日http://datasciencelessons.com</em><em class="np">T21</em><a class="ae mo" href="https://datasciencelessons.com/2020/03/22/covid-19-data-visualization-mastery/" rel="noopener ugc nofollow" target="_blank">。</a></p></div></div>    
</body>
</html>