<html>
<head>
<title>A Really Simple Way to Edit Row by Row in a Pandas DataFrame</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个非常简单的方法来编辑熊猫数据帧中的一行一行</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-really-simple-way-to-edit-row-by-row-in-a-pandas-dataframe-75d339cbd313?source=collection_archive---------2-----------------------#2020-05-23">https://towardsdatascience.com/a-really-simple-way-to-edit-row-by-row-in-a-pandas-dataframe-75d339cbd313?source=collection_archive---------2-----------------------#2020-05-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="4dfc" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">大蟒</h2><div class=""/><div class=""><h2 id="d4f1" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用 pd.loc 根据条件更改数据的子集。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/63cace4d6b00c17e1b5535ba2886688e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B2truCULjBE7JFxR0F9rEQ.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由@ <a class="ae lh" href="https://www.instagram.com/siscadraws/" rel="noopener ugc nofollow" target="_blank"> siscadraws </a>创建(Instagram)</p></figure><p id="c3a2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">您是否曾经需要根据某些条件编辑表格中的每一行？</p><p id="48d3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这是数据分析项目的常见任务。每次需要这样做时，我都会在 StackOverflow 中搜索解决方案。最后，我阅读了 Pandas 文档，并创建了一个模板，每当我需要逐行编辑数据时，这个模板都能工作。</p><p id="c84e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面我们来看看如何使用熊猫。<strong class="lk jd"> loc </strong>方法来选择你的数据的一个子集，如果它满足一个条件就编辑它。</p><p id="48f1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">注意，在尝试下面的任何代码之前，不要忘记导入熊猫。</em></p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="287c" class="mk ml it mg b gy mm mn l mo mp">import pandas as pd</span></pre><h1 id="99c4" class="mq ml it bd mr ms mt mu mv mw mx my mz ki na kj nb kl nc km nd ko ne kp nf ng bi translated">对…的快速介绍。位置[]</h1><p id="b79a" class="pw-post-body-paragraph li lj it lk b ll nh kd ln lo ni kg lq lr nj lt lu lv nk lx ly lz nl mb mc md im bi translated">熊猫文档对“<strong class="lk jd">有这样的描述。loc[] </strong>":</p><blockquote class="nm nn no"><p id="068f" class="li lj me lk b ll lm kd ln lo lp kg lq np ls lt lu nq lw lx ly nr ma mb mc md im bi translated">通过标签或布尔数组访问一组行和列(在<code class="fe ns nt nu mg b"><em class="it">.DataFrame</em></code>中)。</p></blockquote><p id="8a27" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">对于我们的例子，我们将使用这样的方法:</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="48da" class="mk ml it mg b gy mm mn l mo mp">df.loc[row_indexer,column_indexer]</span></pre><p id="5fd1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这里有一些样本数据，并举例说明了<code class="fe ns nt nu mg b">row_indexer</code>和<code class="fe ns nt nu mg b">column_indexer</code>指的是什么。(关于如何获取样本数据的解释，请查看我的另一篇文章<a class="ae lh" href="https://bit.ly/byronown11" rel="noopener ugc nofollow" target="_blank">轻松从网站获取表格</a>。)</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="fdbf" class="mk ml it mg b gy mm mn l mo mp">df = pd.read_html('<a class="ae lh" href="https://finance.yahoo.com/quote/TSLA/profile?p=TSLA')[0" rel="noopener ugc nofollow" target="_blank">https://finance.yahoo.com/quote/TSLA/profile?p=TSLA')[0</a>]</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nv"><img src="../Images/84cbd46b609391694766ed177b89ccf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Z3q8YdpRkj5VnbKXPB2Iw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">摘自雅虎财经的样本表格</p></figure><p id="73c1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要设置一个<code class="fe ns nt nu mg b">row_indexer</code>，您需要选择一个蓝色的值。最左边一列中的这些数字是“行索引”，用于标识每一行。一个<code class="fe ns nt nu mg b">column_indexer</code>，你需要选择一个红色的值，它们是数据框的列名。</p><p id="8fc5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">如果我们想要选择文本“Mr. Elon R. Musk”，我们需要执行以下操作:</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="a6d5" class="mk ml it mg b gy mm mn l mo mp">df.loc[0,'Name']</span></pre><p id="0eca" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这给了我们想要的输出:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/11429e42147a4c3dd5140b0729decc59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*LLWDuA8GcWv5SM8bX3Z-QQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">选择 Elon Musk 名字的 df.loc 的输出</p></figure><p id="a6ea" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在我们已经有了基本的东西，我们准备开始编辑我们的表格！</p><h1 id="1fa6" class="mq ml it bd mr ms mt mu mv mw mx my mz ki na kj nb kl nc km nd ko ne kp nf ng bi translated">基于一组条件逐行编辑数据帧</h1><p id="bcb0" class="pw-post-body-paragraph li lj it lk b ll nh kd ln lo ni kg lq lr nj lt lu lv nk lx ly lz nl mb mc md im bi translated">现在，假设我们想要编辑表中一些人的“Title”值。让我们把埃隆·马斯克(Elon Musk)改成“老板”，扎卡里·柯克霍恩(Zachary Kirkhorn)改成“投资人”，其他人都改成“另一个家伙”。</p><p id="78a9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们需要遍历表中的每一行，检查“Name”值是什么，然后根据我们指定的更改编辑“Title”值。</p><p id="cc8e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了逐行浏览数据，我们将使用<strong class="lk jd"> df.index </strong>，它从数据帧中选择“行索引”。为了了解其工作原理，我们可以在一个基本的“for”循环中打印样本表中的索引:</p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="d7ae" class="mk ml it mg b gy mm mn l mo mp">for index in df.index:<br/>    print(index)</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/82a39eeed52e2d5d874a5be12b052fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*9Z7CfuGsqC4qej7Q23KRLw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">for 循环的输出，用于打印数据帧的索引值</p></figure><p id="a8eb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这为我们提供了与您在第一个屏幕截图中看到的最左边一列相同的值。</p><p id="2895" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">为了搜索和编辑数据帧中每一行的数据子集，我们使用下面的代码:</strong></p><pre class="ks kt ku kv gt mf mg mh mi aw mj bi"><span id="a17c" class="mk ml it mg b gy mm mn l mo mp">for index in df.index:<br/>    if df.loc[index,'Name']=='Mr. Elon R. Musk':<br/>        df.loc[index,'Title'] = 'The Boss Man'<br/>    elif df.loc[index,'Name']=='Mr. Zachary J. Kirkhorn':<br/>        df.loc[index,'Title'] = 'The Money Man'<br/>    else:<br/>        df.loc[index,'Title'] = 'Another Dude'</span></pre><p id="2a4f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这个循环将遍历数据帧的每一行，检查“名称”是什么，然后根据它满足的条件编辑“标题”。我们的条件是，每一行的价值“名称”是否与“埃隆·r·马斯克先生”、“扎克里·j·柯克霍恩先生”和其他所有人在一起。</p><p id="f274" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在本例中，因为第一行的“姓名”是“Mr. Elon R. Musk ”,所以脚本会将第一行的“头衔”值更改为“老板”。因为我们使用<strong class="lk jd"> df.loc[] </strong>指定了行索引，所以它知道哪一行要执行这个更改。</p><p id="68b3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">生成的数据帧如下所示:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ny"><img src="../Images/952a0f31d3083a87a1abc6bcb2ada4af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2wCBYTcf6Ztl-Jfc9y_LQA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">已编辑的数据帧，根据条件更改了“标题”值</p></figure><p id="dff2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们已经根据前面指定的条件成功地更改了每一行的“Title”值！</p></div><div class="ab cl nz oa hx ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="im in io ip iq"><p id="1ea2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我希望下一次您必须梳理成千上万的行并根据某些条件编辑值时，您会发现这很有用。</p><p id="c449" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你应该查看一下<a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html\" rel="noopener ugc nofollow" target="_blank"> df.loc[]文档</a>，了解更多关于如何使用该方法的信息。你也可以看看<a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#indexing-label" rel="noopener ugc nofollow" target="_blank"> Pandas 用户指南</a>来获得更多关于索引和选择数据的提示。</p><p id="9d81" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">编辑愉快！</p></div></div>    
</body>
</html>