<html>
<head>
<title>Import CSV Files As Pandas DataFrame With skiprows, skipfooter, usecols, index_col and header Options</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用skiprows、skipfooter、usecols、index_col和header选项将CSV文件导入为Pandas DataFrame</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/import-csv-files-as-pandas-dataframe-with-skiprows-skipfooter-usecols-index-col-and-header-fbf67a2f92a?source=collection_archive---------18-----------------------#2020-05-21">https://towardsdatascience.com/import-csv-files-as-pandas-dataframe-with-skiprows-skipfooter-usecols-index-col-and-header-fbf67a2f92a?source=collection_archive---------18-----------------------#2020-05-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fbb6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习使用read_csv函数及其提供的一些非常有用的参数</h2></div><figure class="ki kj kk kl gt km"><div class="bz fp l di"><div class="kn ko l"/></div><p class="kp kq gj gh gi kr ks bd b be z dk translated">来源:作者</p></figure><p id="91e2" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">CSV文件是一种非常常见和流行的数据存储格式。数据科学家几乎定期处理CSV文件。Pandas不仅可以选择将数据集导入为常规的Pandas数据帧，还可以选择在导入时清理和调整数据帧。在这里，我想讨论其中的几个选项:</p><p id="4e82" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">使用read_csv方法将pandas和数据集作为数据帧导入:</p><pre class="ki kj kk kl gt lp lq lr ls aw lt bi"><span id="d442" class="lu lv it lq b gy lw lx l ly lz">import pandas as pd</span><span id="439d" class="lu lv it lq b gy ma lx l ly lz">df = pd.read_csv(‘olympics.csv’)<br/>df.head()</span></pre><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mb"><img src="../Images/557977a16e935f6824a91f71d2b08ffb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7IUtkPWmFEoXK01b0L6-Iw.png"/></div></div><p class="kp kq gj gh gi kr ks bd b be z dk translated">来源:作者</p></figure><p id="ad1d" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在本教程中，我使用了数据集“olympics.csv”。请<strong class="kv iu"> c </strong> <a class="ae mi" href="https://github.com/rashida048/Datasets" rel="noopener ugc nofollow" target="_blank"> <strong class="kv iu"> <em class="mj">点击此处</em> </strong> </a> <em class="mj"> </em>为数据集。</p><p id="8a82" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">df.head()只给出数据帧的前五行，因此我们可以看到数据帧的一些属性。df.tail()返回数据帧的最后五行。也可以指定行数。像df.head(8)将返回前8行。您可以使用数据帧长度范围内的任何数字。可以用同样的方式在df.tail()中指定行数。</p><pre class="ki kj kk kl gt lp lq lr ls aw lt bi"><span id="b791" class="lu lv it lq b gy lw lx l ly lz">df.tail()</span></pre><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mk"><img src="../Images/70b469177a5318754f034dc35233052f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AvM-HQOXvJvjfu5IHV7mlg.png"/></div></div><p class="kp kq gj gh gi kr ks bd b be z dk translated">来源:作者，数据框的最后五行</p></figure><p id="40a4" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">看数据集。在顶部，有一个不必要的行。这不是标题。有一个名为skiprows的选项可以去掉不必要的行。</p><pre class="ki kj kk kl gt lp lq lr ls aw lt bi"><span id="537e" class="lu lv it lq b gy lw lx l ly lz">df1 = pd.read_csv(‘olympics.csv’, skiprows = 1)<br/>df1.head()</span></pre><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi ml"><img src="../Images/9486657be018f50f67cd278809e5309d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*If03p4UBM-8dGxX4MGAa_A.png"/></div></div><p class="kp kq gj gh gi kr ks bd b be z dk translated">来源:作者，在skiprows中使用read_csv</p></figure><p id="f540" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这里skiprows = 1，意味着删除一行。默认情况下，它将从顶部删除一行。您可以使用skiprows删除2、3、4或任意数量的行。但是您可能不想从顶部删除所有行。比如你可能想删除第一行，第三行，第四行。在这种情况下，您可以在列表中指定行。</p><pre class="ki kj kk kl gt lp lq lr ls aw lt bi"><span id="6c66" class="lu lv it lq b gy lw lx l ly lz">df2 = pd.read_csv(‘olympics.csv’, skiprows = [0, 2, 3])</span></pre><p id="e4b0" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">有时在CSV文件中，没有标题，只有值。但默认情况下，熊猫以第一行为表头。为了避免这种情况，我们可以使用“header = None”。在这个数据集中，有一个头。但是为了这个例子，让我们假设没有标题。</p><pre class="ki kj kk kl gt lp lq lr ls aw lt bi"><span id="8b75" class="lu lv it lq b gy lw lx l ly lz">df3 = pd.read_csv(‘olympics.csv’, header = None)</span><span id="ed82" class="lu lv it lq b gy ma lx l ly lz">df3.head()</span></pre><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mm"><img src="../Images/a1352a879250aa8c0a71d045038e67ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_p6SiwvBmOOpBaj283IGIQ.png"/></div></div><p class="kp kq gj gh gi kr ks bd b be z dk translated">来源:作者，使用read_csv，标题=无</p></figure><p id="6082" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">看，熊猫在顶部多加了一行标签来增加标题。它没有将原始数据集中的任何一行作为标题。但是，在这个数据集中，有一个标题。第二行，这意味着行索引1是一个标题。让我们通过添加header = 1将第二行的第一行指定为标题。</p><pre class="ki kj kk kl gt lp lq lr ls aw lt bi"><span id="af61" class="lu lv it lq b gy lw lx l ly lz">df4 = pd.read_csv(‘olympics.csv’, header = 1)</span><span id="d5cb" class="lu lv it lq b gy ma lx l ly lz">df4.head()</span></pre><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mn"><img src="../Images/046debab0298c78753a9f301db222240.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d8lbH74jbPbLMElrOP_SAg.png"/></div></div><p class="kp kq gj gh gi kr ks bd b be z dk translated">来源:作者，使用header=1的read_csv</p></figure><p id="96c0" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在此数据框架中，默认索引列是一个通用序列。有一个有意义的索引是有用的。导入时，您可以将索引设置为您想要的任何列。我选择第一列的国名。所以列索引为零。请记住，索引列被视为一个列。</p><pre class="ki kj kk kl gt lp lq lr ls aw lt bi"><span id="0993" class="lu lv it lq b gy lw lx l ly lz">df5 = pd.read_csv(‘olympics.csv’, index_col = 0, skiprows = 1)</span><span id="4946" class="lu lv it lq b gy ma lx l ly lz">df5.head()</span></pre><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mo"><img src="../Images/550050382da5a8acd228f1bcb96af54c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8iIOWUOk1Y5WxRUZ2TADLw.png"/></div></div><p class="kp kq gj gh gi kr ks bd b be z dk translated">来源:作者，将read_csv与skiprows和index_col一起使用</p></figure><p id="cc3b" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">有时数据集的所有列对于分析来说可能不是必需的。尤其是当数据集太大时，呈现一部分总是有意义的。不然就变得太难理解了。这里有一种导入几列的方法。</p><pre class="ki kj kk kl gt lp lq lr ls aw lt bi"><span id="33cb" class="lu lv it lq b gy lw lx l ly lz">df6 = pd.read_csv(‘olympics.csv’, skiprows = 1, usecols = [‘Unnamed: 0′,’№ Summer’, ‘№ Winter’, ‘№ Games’], index_col = 0)</span><span id="3374" class="lu lv it lq b gy ma lx l ly lz">df6.head()</span></pre><figure class="ki kj kk kl gt km gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/7d90454bddbf33cfe5f0af0f76f98870.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*LfZJNM8k6dxmi3aL82OnVA.png"/></div><p class="kp kq gj gh gi kr ks bd b be z dk translated">来源:作者、使用skiprows的read_csv、使用列和index_col</p></figure><p id="a39e" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">让我们再次回到skiprows。使用“for循环”可以跳过任何范围的行。这个选项有时非常有用。我在这里使用了一个简单的for循环。</p><pre class="ki kj kk kl gt lp lq lr ls aw lt bi"><span id="c0bd" class="lu lv it lq b gy lw lx l ly lz">df7 = pd.read_csv(‘olympics.csv’, skip_blank_lines = False, skiprows = [i for i in range(2, 5)] )</span><span id="caab" class="lu lv it lq b gy ma lx l ly lz">df7.head()</span></pre><figure class="ki kj kk kl gt km gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mq"><img src="../Images/80be64c695d054d0ef4351ad9229d048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mip0wi-F2QZCI_e6HJGxgg.png"/></div></div><p class="kp kq gj gh gi kr ks bd b be z dk translated">来源:作者，read_csv的使用，其中skiprows采用for循环</p></figure><p id="50b8" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">另一个非常动态的想法是定义一个函数，并使用该函数跳过或保留您需要的行。对于这个例子，我在这里定义了一个简单的函数。仅返回偶数索引行的函数。然后，在skiprows中使用它来跳过偶数索引行。</p><pre class="ki kj kk kl gt lp lq lr ls aw lt bi"><span id="41c4" class="lu lv it lq b gy lw lx l ly lz">def even_rows(index):<br/>    if index%2 == 0:<br/>        return True<br/>    return False</span><span id="62a5" class="lu lv it lq b gy ma lx l ly lz">df8 = pd.read_csv(‘olympics.csv’, skiprows = lambda x: even_rows(x) )</span><span id="0c44" class="lu lv it lq b gy ma lx l ly lz">df8.head()</span></pre><p id="934b" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">最后，我应该谈谈skipfooter。Skipfooter从数据帧的底部跳过行。在这里，我对skipfooter使用值3。因此，它将从页脚跳过三行。</p><pre class="ki kj kk kl gt lp lq lr ls aw lt bi"><span id="6194" class="lu lv it lq b gy lw lx l ly lz">df10 = pd.read_csv(‘olympics.csv’, header = 1, skipfooter = 3)</span><span id="d06a" class="lu lv it lq b gy ma lx l ly lz">df10.tail()</span></pre><p id="34d7" class="pw-post-body-paragraph kt ku it kv b kw kx ju ky kz la jx lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这就是我想分享的关于使用熊猫图书馆在笔记本中导入CSV文件的全部内容。我希望它有帮助。</p></div></div>    
</body>
</html>