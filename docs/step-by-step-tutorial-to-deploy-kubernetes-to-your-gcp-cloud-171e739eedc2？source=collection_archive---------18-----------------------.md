# å°† Kubernetes éƒ¨ç½²åˆ°æ‚¨çš„ GCP äº‘çš„åˆ†æ­¥æŒ‡å—

> åŸæ–‡ï¼š<https://towardsdatascience.com/step-by-step-tutorial-to-deploy-kubernetes-to-your-gcp-cloud-171e739eedc2?source=collection_archive---------18----------------------->

## [å®è·µæ•™ç¨‹](https://towardsdatascience.com/tagged/hands-on-tutorials)

## ç”¨åŠ¨æ‰‹ç»ƒä¹ æ­å¼€ Kubernetes çš„ç¥ç§˜é¢çº±ï¼

![](img/917e9a2c5696d5ab7a2c78626255d91c.png)

ç”±[å…‹é‡Œæ–¯æ‰˜å¼—Â·é«˜å°”](https://unsplash.com/@cgower?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)åœ¨ [Unsplash](https://unsplash.com/s/photos/portable?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

# ä»‹ç»

ä½œä¸ºä¸€ååœ¨å®è·µä¸­çš„æ•°æ®ç§‘å­¦å®¶ï¼Œæˆ‘æ„Ÿå—åˆ°äº†å°†æ•°æ®å¤„ç†ã€æ¨¡å‹è®­ç»ƒå’Œæ¨ç†çš„ä¼ ç»Ÿä¾‹è¡Œç¨‹åºæ¨å…¥å…·æœ‰( [CI/CD](https://docs.gitlab.com/ee/ci/) )æŒç»­é›†æˆ/æŒç»­éƒ¨ç½²çš„é›†æˆç®¡é“çš„è¶‹åŠ¿ï¼Œå…¶æ¦‚å¿µæ˜¯ä» DevOps å€Ÿç”¨çš„ã€‚è‡³å°‘ä»æˆ‘çš„è§’åº¦æ¥çœ‹ï¼Œæœ‰ä¸¤ä¸ªä¸»è¦åŸå› ã€‚ä¸€ä¸ªæ˜¯å»ºæ¨¡æ­£åœ¨èµ°å‡ºåŸå‹é˜¶æ®µï¼Œè¿›å…¥ç”Ÿäº§ä¸­æ¨¡å‹çš„å¤§è§„æ¨¡é‡‡ç”¨ï¼Œæ— è®ºæ˜¯ä½œä¸ºä¸€ä¸ªé™„ä»¶è¿˜æ˜¯åº”ç”¨ç¨‹åºã€‚å¦ä¸€ä¸ªåŸå› æ˜¯å°†æ•´ä¸ªå»ºæ¨¡ä½“éªŒå¸¦åˆ°äº‘ä¸­çš„éœ€æ±‚å¢åŠ ï¼Œä»¥åŠæ¨¡å‹å¼€å‘çš„å¢å¼ºç¼–æ’ã€‚

åœ¨è¿™ç§éœ€æ±‚çš„é©±ä½¿ä¸‹ï¼Œæˆ‘å¼€å§‹äº†æˆ‘çš„æŠ€èƒ½æå‡ä¹‹æ—…ï¼Œä½¿ç”¨äº†é€‚åˆå»ºæ¨¡è½¬å‹çš„å·¥å…·ï¼Œæ¯”å¦‚ Kubernetesã€‚å®ƒç°åœ¨å¾ˆå—æ¬¢è¿ï¼Œå¹¶è·å¾—äº†æ˜“äºæ‰©å±•ã€å¯ç§»æ¤æ€§å’Œå¯æ‰©å±•æ€§çš„å£°èª‰ã€‚[è¿™ç¯‡åšå®¢](https://stackoverflow.blog/2020/05/29/why-kubernetes-getting-so-popular/)åœ¨è¿™é‡Œç‰¹åˆ«å±•ç¤ºäº†å®ƒæä¾›çš„ç»„ä»¶ã€‚ç„¶è€Œï¼Œå½“æˆ‘å¼€å§‹æˆ‘çš„ç ”ç©¶å¹¶å¾—åˆ°å®ƒçš„æ—¶å€™ï¼Œæˆ‘æ„Ÿåˆ°*è¢«æ‰€æœ‰è¿™äº›æ¦‚å¿µå’Œâ€œå®˜æ–¹æŒ‡å—â€æ·¹æ²¡äº†ï¼Œå› ä¸ºæˆ‘ä¸æ˜¯ä¸€ä¸ªè®­ç»ƒæœ‰ç´ çš„è½¯ä»¶å¼€å‘äººå‘˜ã€‚æˆ‘ä¸€ç‚¹ä¸€ç‚¹åœ°å’€åš¼æ‰€æœ‰è¿™äº›ææ–™ï¼Œå¹¶å¼€å§‹è·å¾—æ›´å®Œæ•´çš„å›¾ç‰‡ï¼Œå³ä½¿æˆ‘æ²¡æœ‰ä¸°å¯Œçš„ DevOps èƒŒæ™¯ã€‚æˆ‘çš„ç¬”è®°å’Œç†è§£éƒ½åœ¨è¿™ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘å¸Œæœ›è¿™å¯¹äºé‚£äº›ä¹Ÿéœ€è¦åœ¨ Kubernetes ä¸­æå‡è‡ªå·±çš„äººæ¥è¯´æ˜¯ä¸€ä¸ªç®€å•è€ŒæˆåŠŸçš„å¼€å§‹ã€‚*

## ä¸€è¨€ä»¥è”½ä¹‹çš„åº“ä¼¯å†…ç‰¹

Kubernetes å°†è‡ªå·±å®šä¹‰ä¸ºä¸€ä¸ªç”Ÿäº§çº§çš„å¼€æºå¹³å°ï¼Œåœ¨è®¡ç®—æœºé›†ç¾¤å†…éƒ¨å’Œä¹‹é—´åè°ƒåº”ç”¨ç¨‹åºå®¹å™¨çš„æ‰§è¡Œã€‚ç®€è€Œè¨€ä¹‹ï¼ŒKubernetes æ˜¯ä¸€ä¸ªä¸ºä½ ç»„è£…å‡ å°è®¡ç®—æœºæ¥æ‰§è¡Œåº”ç”¨ç¨‹åºçš„ç®¡ç†è€…ã€‚å®ƒæ˜¯æ‰§è¡Œæ‚¨åˆ†é…ç»™å®ƒçš„ä»»åŠ¡çš„æŒ‡æŒ¥ä¸­å¿ƒ:å®‰æ’åº”ç”¨ç¨‹åºã€å®šæœŸç»´æŠ¤ã€æ‰©å±•å®¹é‡å’Œæ¨å‡ºæ›´æ–°ã€‚

![](img/6fbcfba69ffcdb06d7b503549d35e4d6.png)

æ¥è‡ª [Kubernetes](https://kubernetes.io/docs/tutorials/kubernetes-basics/create-cluster/cluster-intro/) çš„èšç±»å›¾

Kubernetes é›†ç¾¤æœ€åŸºæœ¬çš„ç»„ä»¶æ˜¯ä¸»èŠ‚ç‚¹å’ŒèŠ‚ç‚¹ã€‚ä¸»æœåŠ¡å™¨æ˜¯ç®¡ç†å™¨ï¼Œæ˜¯é›†ç¾¤çš„ä¸­å¿ƒã€‚èŠ‚ç‚¹æ˜¯è™šæ‹Ÿæœºæˆ–ç‰©ç†è®¡ç®—æœºã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ª Kubelet æ¥ç®¡ç†å®ƒå¹¶ä¸ä¸»èŠ‚ç‚¹é€šä¿¡ã€‚ç”±äºèŠ‚ç‚¹æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œæˆ‘ä»¬è¿˜åº”è¯¥æœ‰ Docker/Container ä½œä¸ºå·¥å…·æ¥æ‰§è¡Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºã€‚

## Kubernetes åº”ç”¨ç¨‹åº

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº† Kubernetes çš„åŸºæœ¬çŸ¥è¯†ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå¼€å§‹æƒ³ä»æ•°æ®ç§‘å­¦å®¶çš„è§’åº¦æ¥çœ‹å®ƒèƒ½åšä»€ä¹ˆã€‚ä»¥æˆ‘çš„è§‚ç‚¹å’Œç»éªŒï¼Œæˆ‘ç¡®å®å‘ç° Kubernetes çš„æ¦‚å¿µéå¸¸å¸å¼•äººï¼Œå°¤å…¶æ˜¯å½“ä½ è®¤ä¸ºå»ºæ¨¡æœ€ç»ˆåº”è¯¥ä½œä¸ºåº”ç”¨ç¨‹åº/æœåŠ¡äº§å“åŒ–çš„æ—¶å€™ã€‚å½“æˆ‘ä»¬æƒ³è®©æœ€ç»ˆç”¨æˆ·è®¿é—®æ¨¡å‹æ—¶ï¼Œå®ƒé˜»ç¢è®¸å¤šäº§å“è®¾è®¡è€…çš„é—®é¢˜ï¼Œå¦‚å¯ä¼¸ç¼©æ€§å’Œå¯æ‰©å±•æ€§ä¹Ÿå°†æ˜¯è€ƒè™‘çš„ä¸€éƒ¨åˆ†ã€‚

è°·æ­Œæä¾›äº†ä¸€ä»½ä»–ä»¬å†…éƒ¨è§£å†³æ–¹æ¡ˆçš„åº”ç”¨ç¨‹åºåˆ—è¡¨ã€‚ä½†æ˜¯æˆ‘ä»¬åœ¨è¿™é‡Œæƒ³è¦å®ç°çš„æ˜¯æ ¹æ®æˆ‘ä»¬çš„éœ€æ±‚å’Œç›®çš„æ¥ä½¿ç”¨å’Œå®šåˆ¶ Kubernetesã€‚å› æ­¤ï¼Œæœ¬æ•™ç¨‹å°†è‡ªä¸‹è€Œä¸Šï¼Œä»åŸºç¡€å¼€å§‹è®¾ç½® GCPï¼Œä¸€ç›´åˆ°åœ¨ Kubernetes é›†ç¾¤ä¸Šéƒ¨ç½²åº”ç”¨ç¨‹åºã€‚

# æ­¥éª¤ 0ã€‚GCP è®¾ç½®

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ [Google Kubernetes å¼•æ“](https://cloud.google.com/kubernetes-engine/)æ¥å»ºç«‹ä¸€ä¸ª Kubernetes é›†ç¾¤ã€‚ä½†æ˜¯åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ»¡è¶³ä»¥ä¸‹å…ˆå†³æ¡ä»¶:

1.  åœ¨ [GCP](https://cloud.google.com/) è·å¾—ä¸€ä¸ªè´¦å·ï¼Œç™»å½•[æ§åˆ¶å°](https://console.cloud.google.com/)ã€‚
2.  åœ¨æ§åˆ¶å°ä¸­ï¼Œå¯ç”¨ [Kubernetes Engine AP](https://console.cloud.google.com/apis/api/container.googleapis.com/overview) I .ä½ å¯ä»¥åœ¨ API åº“ä¸­æ‰¾åˆ°ä¸€ä¸ªåº“ APIï¼Œåªéœ€æœç´¢åç§°å³å¯ã€‚

![](img/c99995d835234e06f56406855e529816.png)

API åº“(å›¾ç‰‡ç”±ä½œè€…æä¾›)

3.å®‰è£… [gcloud](https://cloud.google.com/sdk/docs/install) ã€‚æ‚¨å¯ä»¥ä½¿ç”¨åŸºäºç½‘ç»œçš„ç»ˆç«¯æˆ–æ‚¨è‡ªå·±çš„è®¡ç®—æœºç»ˆç«¯ã€‚è¦åœ¨ GCP æ§åˆ¶å°ä¸­æ‰¾åˆ°åŸºäº web çš„ç»ˆç«¯:

![](img/ba7c9f1962a5226218332f0a0809fc00.png)

å•å‡»çº¢è‰²æ¡†ä¸­çš„å›¾æ ‡(å›¾ç‰‡ç”±ä½œè€…æä¾›)

å»ºè®®æŒ‰ç…§[å®˜æ–¹æŒ‡å—](https://cloud.google.com/sdk/docs/install)å®‰è£… gcloudï¼Œä½†ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤:

4.å®‰è£… kubectlã€‚è¿™ä¸€æ­¥å¾ˆç®€å•:è®¾ç½® gcloud åï¼Œè¾“å…¥å‘½ä»¤:

```
gcloud components install kubectl
```

# ç¬¬ä¸€æ­¥ã€‚Kubernetes è®¾ç½®

ä¸€æ—¦æˆ‘ä»¬å®Œæˆäº†å‰é¢çš„æ‰€æœ‰æ­¥éª¤ï¼Œé¡¹ç›®ç°åœ¨å¯ä»¥ä½¿ç”¨ Google Cloud SDK æ¥åˆ›å»ºä¸€ä¸ªæ‰˜ç®¡çš„ Kubernetes é›†ç¾¤ã€‚

1.  è¦ä½¿ç”¨ gcloud åˆ›å»ºå®¹å™¨é›†ç¾¤:

```
gcloud container clusters create \
--machine-type n1-standard-2 \
--num-nodes 3\
--zone <compute zone from the list linked below> \
--cluster-version latest \
<CLUSTERNAME>
```

*   [æœºå™¨ç±»å‹](https://cloud.google.com/sdk/gcloud/reference/container/clusters/create#--machine-type):ç”¨äºèŠ‚ç‚¹çš„æœºå™¨ç±»å‹ã€‚
*   [num-nodes](https://cloud.google.com/sdk/gcloud/reference/container/clusters/create#--num-nodes) :è¦åœ¨æ¯ä¸ªé›†ç¾¤åŒºåŸŸä¸­åˆ›å»ºçš„èŠ‚ç‚¹æ•°é‡ã€‚æ‚¨å¯ä»¥å°†å…¶è®¾ç½®ä¸º 1 æ¥åˆ›å»ºä¸€ä¸ªå•èŠ‚ç‚¹é›†ç¾¤ï¼Œä½†æ˜¯æ„å»ºä¸€ä¸ª Kubernetes é›†ç¾¤è‡³å°‘éœ€è¦ 3 ä¸ªèŠ‚ç‚¹ã€‚ç¨åå¯ä»¥ä½¿ç”¨ [gcloud å‘½ä»¤](https://cloud.google.com/kubernetes-engine/docs/how-to/resizing-a-cluster)è°ƒæ•´å¤§å°ã€‚
*   [zone](https://cloud.google.com/sdk/gcloud/reference/container/clusters/create#--zone) :è®¡ç®—é›†ç¾¤çš„ [zone](https://cloud.google.com/compute/docs/regions-zones/#available) (ä¾‹å¦‚ us-central1-a)ã€‚

å¦‚æœé›†ç¾¤åˆ›å»ºæ­£ç¡®ï¼Œå®ƒå°†æ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯:

![](img/9bf9393376596e6455a7bd5f40fe4029.png)

2.ä¸ºäº†æµ‹è¯•æ–°è®¾ç½®çš„é›†ç¾¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ kubectl:

```
kubectl get node
```

3.æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†[æˆäºˆç”¨æˆ·æ‰§è¡Œç®¡ç†æ“ä½œçš„æƒé™](https://kubernetes.io/docs/reference/access-authn-authz/rbac/#kubectl-create-clusterrolebinding)ã€‚

```
kubectl create clusterrolebinding cluster-admin-binding \
  --clusterrole**=**cluster-admin \
  --user**=**<GOOGLE-EMAIL-ACCOUNT>
```

4.å®‰è£…[èˆµ](https://helm.sh/docs/intro/install/)ã€‚Helm æ˜¯ Kubernetes åº”ç”¨ç¨‹åºçš„åŒ…ç®¡ç†å™¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨[å¯¼èˆªå›¾](https://artifacthub.io/)æ¥æœç´¢è¦éƒ¨ç½²åˆ° Kubernetes çš„åº”ç”¨ç¨‹åº/åŒ…ã€‚Helm Chart æ˜¯é¢„è®¾çš„æŠ½è±¡æ¦‚å¿µï¼Œç”¨æ¥æè¿°å¦‚ä½•å°†åŒ…å®‰è£…åˆ° Kubernetes

```
curl https://raw.githubusercontent.com/helm/helm/master/scripts/get-helm-3 | bash
```

å®‰è£… Helm åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨ä»¥ä¸‹å‘½ä»¤æ¥æ£€æŸ¥é›†ç¾¤ä¸­å®‰è£…äº†ä»€ä¹ˆ:

```
helm list
```

ç°åœ¨ä½ çš„ Kubernetes å·²ç»å‡†å¤‡å¥½äº†ï¼ç¥è´ºğŸ¤“

# ç¬¬äºŒæ­¥ã€‚Kubernetes çš„åº”ç”¨

## ä»¥ JupyerHub ä¸ºä¾‹

åœ¨å¼€å§‹å®‰è£…è¿‡ç¨‹ä¹‹å‰ï¼Œä»è¾ƒé«˜çš„å±‚æ¬¡è¿›è¡Œæ£€æŸ¥å¹¶äº†è§£å®ƒçš„æ ·å­æ€»æ˜¯æœ‰å¸®åŠ©çš„ã€‚åœ¨å‰é¢çš„æ­¥éª¤ä¸­ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†å®‰è£… Helm çš„ Kubernetes é›†ç¾¤çš„è®¾ç½®ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³ä¸ºå®ƒéƒ¨ç½²ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå¹¶å¼€å§‹ä½¿ç”¨å®ƒã€‚å¯¹äºè¿™é‡Œçš„ä¾‹å­ï¼Œæˆ‘å°†ä½¿ç”¨å¯ä»¥æœåŠ¡å¤šä¸ªç”¨æˆ·çš„ JupyterHubã€‚ä¸‹é¢æ˜¯è¿™ä¸ªç»ƒä¹ çš„ç»“æ„ï¼Œä»¥ä¾¿äºå‚è€ƒã€‚

![](img/5a40deb89eac6d74a79e540f0a7eb9ee.png)

å®‰è£…ç»“æ„(å›¾ç‰‡ç”±ä½œè€…ä½¿ç”¨ LucidChart æä¾›)

1.  å®‰å…¨è®¾ç½®

*   ç”Ÿæˆä»£ç†å®‰å…¨ä»¤ç‰Œã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œå¼ºçƒˆå»ºè®®ä¸è¦åœ¨æ²¡æœ‰ SSL åŠ å¯†çš„æƒ…å†µä¸‹è¿è¡Œ JupyerHubã€‚ç”¨`openssl rand -hex 32`ç®€å•ç”Ÿæˆã€‚å°†ç”Ÿæˆçš„ä»¤ç‰Œä¿å­˜åœ¨è®°äº‹æœ¬ä¸­ä»¥å¤‡åç”¨ã€‚
*   å‘æ‚¨çš„[ä»£ç†](http://penssl rand -hex 32)æ·»åŠ ä»¤ç‰Œã€‚å®ƒå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æˆ–å­˜å‚¨ä¸ºç¯å¢ƒå˜é‡ã€‚ç„¶è€Œï¼Œç”±äºæˆ‘ä»¬å·²ç»å®‰è£…äº† Helmï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`helm`æ¥æ¨¡æ¿åŒ–`yaml`æ–‡ä»¶ä»¥æ·»åŠ  SSL ä»¤ç‰Œã€‚ä¸‹é¢æ˜¯æ‚¨ç”¨ä¸Šä¸€æ­¥ç”Ÿæˆçš„ä»¤ç‰Œæä¾›ç»™`yaml`çš„æ ¼å¼ã€‚æˆ‘ä»¬ç¨åå°†æŠŠå®ƒæ·»åŠ åˆ°é…ç½®æ–‡ä»¶ä¸­ã€‚

```
**proxy:**
  **secretToken:** "<SSL_Token>"
```

2.æ·»åŠ é…ç½®

JupyterHub å°±å¦‚ä½•è®¾ç½®é…ç½®æä¾›äº†éå¸¸å…¨é¢çš„[æŒ‡å—](https://zero-to-jupyterhub.readthedocs.io/en/latest/jupyterhub/customization.html)ã€‚æˆ‘æ­£åœ¨æ·»åŠ ä¸€äº›æœ‰ç”¨çš„è‡ªå®šä¹‰æ•°æ®ç§‘å­¦çš„ç›®çš„ã€‚æ‚¨ä¹Ÿå¯ä»¥å‚è€ƒæŒ‡å—æ¥è®¾ç½®æ‚¨çš„å®šåˆ¶æˆ–ä½¿ç”¨å‚è€ƒ[æ­¤å¤„çš„](https://zero-to-jupyterhub.readthedocs.io/en/latest/resources/reference.html#singleuser-memory)æ¥å¯¼èˆªæ‚¨çš„éœ€æ±‚ã€‚

*   [å›¾ç‰‡](https://zero-to-jupyterhub.readthedocs.io/en/latest/resources/reference.html#singleuser-image):æˆ‘ä»¬å¯ä»¥ä»[è¿™é‡Œ](https://jupyter-docker-stacks.readthedocs.io/en/latest/using/selecting.html)æä¾›çš„ç»¼åˆåˆ—è¡¨ä¸­æ·»åŠ [æ•°æ®ç§‘å­¦ç¬”è®°æœ¬](https://jupyter-docker-stacks.readthedocs.io/en/latest/using/selecting.html#jupyter-datascience-notebook)å›¾ç‰‡ã€‚è¿˜æœ‰ï¼Œè®°å¾—ç”¨æ ‡ç­¾ä»£æ›¿`latest`ã€‚ä½ çš„å›¾ç‰‡æ ‡ç­¾å¯ä»¥åœ¨ DockerHub ä¸­æ‰¾åˆ°ï¼Œæ•°æ®ç§‘å­¦ç¬”è®°æœ¬çš„æ ‡ç­¾ä¿¡æ¯å¯ä»¥åœ¨[è¿™é‡Œ](https://hub.docker.com/r/jupyter/pyspark-notebook/tags/)æ‰¾åˆ°ã€‚
*   [å†…å­˜](https://zero-to-jupyterhub.readthedocs.io/en/latest/resources/reference.html#singleuser-memory):æˆ‘ä»¬ä¸ºä½ çš„ç”¨æˆ·æŒ‡å®šå­˜å‚¨é™åˆ¶ã€‚è¿™å°†å‘ Kubernetes API å‘é€è¯·æ±‚ã€‚

å¦‚æœæ‚¨åªæƒ³éµå¾ªç¤ºä¾‹ï¼Œåªéœ€å¤åˆ¶å¹¶ç²˜è´´ä¸Šé¢çš„å†…å®¹ï¼Œå¹¶æ›¿æ¢å¿…è¦çš„å‡­è¯ã€‚ä½¿ç”¨`nano config.yaml`æˆ–`vim config.yaml`åˆ›å»º`yaml`æ–‡ä»¶å¹¶æ›¿æ¢å†…å®¹ã€‚

3.ç”¨èˆµå®‰è£…ã€‚ä»¥ä¸‹è„šæœ¬å°†ä½¿ç”¨`helm upgrade`å®‰è£… JupyterHubã€‚æœ‰å…³è¯¥å‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æ­¤å¤„çš„[ä»¥ä¾›å‚è€ƒã€‚](https://helm.sh/docs/helm/helm_upgrade/)

å¯¹äºå°†æ¥ä½¿ç”¨`helm`çš„å‡çº§ï¼Œæˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºåç§°ç©ºé—´ã€‚

JupyterHub çš„[æŒ‡å—](https://zero-to-jupyterhub.readthedocs.io/en/latest/jupyterhub/installation.html)å¯¹è¿™ä¸€éƒ¨åˆ†åšäº†éå¸¸é€å½»çš„è§£é‡Šï¼Œæˆ‘ä¸ªäººè®¤ä¸ºé˜…è¯»èµ·æ¥éå¸¸æœ‰å¸®åŠ©ã€‚`RELEASE`æŒ‡å®šæ‚¨å¸Œæœ›å¦‚ä½•ä»`helm`å‘½ä»¤è°ƒç”¨ï¼Œ`NAMESPACE`æ˜¯æ‚¨å¸Œæœ›ä¸`kubectl`ä¸€è‡´çš„å†…å®¹ã€‚

åœ¨ helm å¼€å§‹å®‰è£…çš„æ—¶å€™ä¼‘æ¯ä¸€ä¸‹ï¼Œä¸€æ—¦å®‰è£…å®Œæˆï¼Œä½ å°†ä¼šçœ‹åˆ° JupyterHub çš„ç»“æŸä¿¡æ¯ã€‚å¦‚æœæ‚¨éœ€è¦å¯¹è¯¥æ­¥éª¤ä¸­çš„ä»»ä½•é—®é¢˜è¿›è¡Œæ•…éšœè¯Šæ–­ï¼Œè¯·å‚è€ƒ[æŒ‡å—](https://zero-to-jupyterhub.readthedocs.io/en/latest/jupyterhub/installation.html)æˆ–ä½¿ç”¨`kubectl get events`æ£€ç´¢æ—¥å¿—å¹¶è‡ªå·±æ‰¾å‡ºå‘ç”Ÿäº†ä»€ä¹ˆã€‚

4.æ£€æŸ¥çŠ¶æ€å¹¶æµ‹è¯•æ‚¨çš„ JupyterHubã€‚æ­£ç¡®è®¾ç½®åï¼Œæˆ‘ä»¬åº”è¯¥é€šè¿‡è°ƒç”¨ä»¥ä¸‹å‘½ä»¤çœ‹åˆ°é›†çº¿å™¨å‡†å¤‡å°±ç»ª:

```
kubectl â€”-namespace=jhub get pod
```

è¦é€šè¿‡é›†ç¾¤è®¿é—®é›†çº¿å™¨ï¼Œè¯·è°ƒç”¨ä»¥ä¸‹å‘½ä»¤æ¥è·å– IP åœ°å€:

```
kubectl --namespace=jhub get svc proxy-public
```

![](img/80d566e545f5de95e21709ee5ad1e4d9.png)

å°†æ‚¨çš„å¤–éƒ¨ IP å¤åˆ¶å¹¶ç²˜è´´åˆ°ä¸€ä¸ªæ–°çš„æµè§ˆå™¨ï¼Œå®ƒåº”è¯¥ä¼šå°†æ‚¨å¯¼èˆªåˆ° JupyerHub ç™»å½•é¡µé¢ã€‚æ‚¨å¯ä»¥å°†è‡ªå·±çš„ JupyterHub ç”¨äº Kubernetes é›†ç¾¤ã€‚

![](img/0635d3accbffda2d49c4335fb694d3d6.png)

JupyterHub ç•Œé¢(å›¾ç‰‡ç”±ä½œè€…æä¾›)

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬æ²¡æœ‰ä¸ºç”¨æˆ·è®¾ç½®ä»»ä½•èº«ä»½éªŒè¯ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¾“å…¥éšæœºçš„ç”¨æˆ·åå’Œå¯†ç å³å¯å¼€å§‹ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾æ›´å¤šçš„å®‰å…¨æ€§æ¥ä¿æŠ¤æ‚¨çš„é›†ç¾¤ï¼Œè¯·æ£€æŸ¥[æ­¤é“¾æ¥](https://jupyterhub.readthedocs.io/en/stable/getting-started/authenticators-users-basics.html)æ¥è®¾ç½®æ‚¨çš„ JupyerHub èº«ä»½éªŒè¯ã€‚

## æ‰“æ‰«å«ç”Ÿã€‚&æœ€ç»ˆæƒ³æ³•

å¦‚æœä½ ä»€ä¹ˆéƒ½ä¸åšå°±è®©äº‘é—²ç½®ï¼Œé‚£å®ƒå°±ä¸ä¾¿å®œã€‚æ‰€ä»¥å¦‚æœä½ ä¸å†éœ€è¦ä½ çš„é›†ç¾¤ï¼Œå»ºè®®å°†[åˆ é™¤](https://cloud.google.com/kubernetes-engine/docs/how-to/deleting-a-cluster#deleting_a_cluster)å®ƒã€‚

```
# Retrieve the cluster **gcloud container clusters list**# Delete the cluster**gcloud container clusters delete <CLUSTER-NAME>**
```

æˆ‘ä»è¿™ä¸ªä¾‹å­çš„å®ç°ä¸­å­¦åˆ°äº†å¾ˆå¤šï¼Œå¸Œæœ›ä½ ä¹Ÿæœ‰åŒæ„Ÿã€‚Kubernetes å¹¶ä¸å®Œå…¨æ˜¯ç¥ç§˜çš„ï¼Œä½œä¸ºä¸€åæ•°æ®ç§‘å­¦å®¶ï¼Œå³ä½¿æ²¡æœ‰äº‹å…ˆåŸ¹è®­ï¼Œä¹Ÿå¯ä»¥ç†è§£åŸºæœ¬åŸç†å¹¶è·å¾—å®é™…åº”ç”¨ã€‚æˆ‘å°†ç»§ç»­ç”¨ Kubernetes å†™æˆ‘çš„ç ”ç©¶ã€æƒ³æ³•å’Œåº”ç”¨ï¼Œå¹¶ç”¨ç®€å•æ˜äº†çš„è¯­è¨€æ­å¼€çš„ç¥ç§˜é¢çº±ã€‚å’Œå¹³ï¼ğŸ¤—