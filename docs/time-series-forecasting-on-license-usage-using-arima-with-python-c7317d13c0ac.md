# 基于 Python ARIMA 的许可证使用时间序列预测

> 原文：<https://towardsdatascience.com/time-series-forecasting-on-license-usage-using-arima-with-python-c7317d13c0ac?source=collection_archive---------37----------------------->

## 自动化许可证使用情况收集、ML 模型的网格搜索、预测未来使用情况、在达到阈值之前发出警报

![](img/3adc08766b83065da3dd6be8315bee1f.png)

克里斯·利维拉尼在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

假设你需要买卫生纸。你会怎么做？你不是每天都买，可能一个月一次，甚至三个月一次。你不希望你买的太少，很快就需要再买。不希望你买太多，堆很多马桶。那你会怎么做？

首先，你会检查可用的卫生纸数量，然后你会预测你一个月会用多少，并购买相应数量的卫生纸。听起来是不是很熟悉的过程？是的，它是。许多公司重复这一过程进行采购。电信公司需要定期购买的常见项目之一是许可证。

![](img/2965c651c0fa218e63ea7eaaa356bffb.png)

[摄盒装水更好](https://unsplash.com/@boxedwater?utm_source=medium&utm_medium=referral)上 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

## 背景:许可证购买

在移动网络中，有各种执行特定网络功能的网络元件。每个网络元件具有许多许可证控制的项目，以限制特定资源的功能和容量。例如，电信供应商将控制 LTE 附加用户的数量，即可以连接到移动网络的手机数量。如果运营商想要同时服务更多的用户，他们必须从他们的供应商那里购买相应的许可证。就像卫生纸，用完了就需要重新买。然而，在移动运营商内部，标准的购买程序可能很漫长，需要花费几个月的时间。因此，作为一个工程部门，当我们从供应商那里购买许可证时，我们需要精确地预测几个月后许可证的使用情况。

# 以前的工作流程

在过去，首先，我们手动收集许可证使用记录。设备供应商通常提供一个 GUI，在其中我们可以根据他们自己的人机语言(MML)语法键入命令，以在屏幕上显示当前的许可证使用情况。然后我们把信息复制下来，以 Excel 的形式保存下来。这是一项令人讨厌的工作，有时负责人员可能会忘记显示或 Excel 文件损坏。我们也不能经常这样做，因为太耗费人力了。

![](img/e22142f8c823a2bee77bc3db3cdee07a.png)

项目前的手动程序

幸运的是，设备供应商还允许我们 telnet 到一台叫做网络管理系统(NMS)的机器上。我们可以键入特殊的命令来与它下面的不同网络元素进行交互。

![](img/81049e1721da70136d620f87605d8d04.png)

显示许可证使用情况的 MML 命令

# 新的自动化工作流程

为了自动化这个过程，我们使用 python 库包 [telnetlib](https://docs.python.org/3/library/telnetlib.html) 来收集许可证使用情况。`telnetlib`模块提供了实现 Telnet 协议的`Telnet`类。使用`tn = Telnet(NMS_IP, NMS_Port)`建立连接后，我们可以使用`tn.write()`功能发送命令。我定义了一个发送命令的函数，如下所示。

发送命令功能

获取您需要的许可证数据的流程是，首先，您需要登录到 NMS，然后您需要注册您想要检查的网元，如下所示:

登录并注册网元

当我们键入显示许可证使用情况所需的命令时，系统会返回一个文本表格，我们将每行分成两个空格。然后，我们将每一行作为一个元组添加到一个名为 data 的列表中。

发送命令以获取许可证使用数据

然后我们将输出结果解码成有用的数据帧。我们将数据库表设计为遍历的，因为如果网络元素已经升级，可能会添加或删除许可证项目。每次修改表模式是不可行的:首先，每周在不同的网络元件上有几次升级，其次，我们不能知道先前的升级添加或移除了哪些许可项目。我们最终确定了以下栏目:

> ***result_time*** *:采集时间；* ***object _ name****:网元的名称；* ***资源名称*** *:许可项目名称；* ***total _ resource****:许可证容量，即该许可证允许的最大数量；* ***used _ resource****:该时刻许可项的占用量；* ***用法*** *:简单用 _ 资源除以总 _ 资源。*

这种结构能够在不改变数据库模式的情况下添加或删除任意许可项。

(注:这是一项繁琐的工作，因为每个网络元素都有其命令和显示格式。我们需要一个一个定制。)

最后，我们收集了所有许可证项目！总共超过 60 个网络元素中的 1742 个不同项目。

![](img/a93918e1856d0114770d73fac815502c.png)

许可证使用自动化和人工智能预测的整个工作流程

# 预测许可证使用情况

有了数据后，我们现在可以使用 ARIMA 模型进行预测。ARIMA(自回归综合移动平均)是一种用于分析和预测时间序列数据的机器学习模型。这符合我们预测依赖于时间的许可证使用的目的。更多细节可以在这篇文章中找到:[如何用 Python](https://machinelearningmastery.com/arima-for-time-series-forecasting-with-python/) 创建 ARIMA 时间序列预测模型作者[杰森·布朗利](https://machinelearningmastery.com/author/jasonb/)。

[](https://machinelearningmastery.com/arima-for-time-series-forecasting-with-python/) [## 如何用 Python 创建用于时间序列预测的 ARIMA 模型

### 一个流行的和广泛使用的时间序列预测的统计方法是 ARIMA 模型。ARIMA 是…的首字母缩写

machinelearningmastery.com](https://machinelearningmastery.com/arima-for-time-series-forecasting-with-python/) 

我们使用 StatsModels 执行网格搜索，从总共 63 个组合中找到(p，d，q)的最佳参数集。

p = [0，1，2，4，6，8，10]
d = [0，1，2]
q = [0，1，2]

我们对 60 个网络元素和 1742 个许可证进行了循环，并运行了近一周的网格搜索！

用于网格搜索的代码

之后，我们有了每个许可证的最佳参数，并每天进行预测。过去，我们只能选择一些重要的许可证项目，并且只能预测每个季度的使用情况，这令人难以置信。但是现在，我们可以每天预测我们的许可证使用情况，并在许可证使用出现危险时向我们发出警报。

![](img/126b479c3533ee08e53a24b07907d441.png)

网络容量许可证使用的仪表板

如果许可证使用率在 1 个月内达到 80%，我们会收到红色警报。必须立即采取行动。否则，如果许可证使用率在 3 个月内达到 80 %，它将发出橙色警报，最后，如果使用率在 6 个月内达到 80%，我们将收到黄色警报。

# 结论

这个项目极大地减少了我们收集许可证使用数据的工作量，我们建立了一个提醒系统，提醒我们在许可证用完之前购买它。

要了解这个项目的更多信息，请点击查看我的 Github 链接[。](https://github.com/joshuayeung/AIOps-with-license-monitoring-and-prediction-on-network-elements)