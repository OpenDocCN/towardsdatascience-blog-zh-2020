<html>
<head>
<title>Image Classifier using TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用张量流的图像分类器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-classifier-using-tensorflow-a8506dc21d04?source=collection_archive---------56-----------------------#2020-07-28">https://towardsdatascience.com/image-classifier-using-tensorflow-a8506dc21d04?source=collection_archive---------56-----------------------#2020-07-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f013" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何创建图像分类器的分步指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9f7066335e0dd61ae06e506be906a775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iTAXD3yL71N4BKVO5s2Z_g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@jeremythomasphoto?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">杰瑞米·托马斯</a>在<a class="ae kv" href="https://unsplash.com/s/photos/space?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="e2e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你不知道卷积神经网络是如何工作的，看看我下面的博客，它解释了 CNN 中的层和它的目的</p><div class="ls lt gp gr lu lv"><a href="https://medium.com/dataseries/introduction-to-convolutional-neural-networks-5a227f61dd50" rel="noopener follow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">卷积神经网络简介</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">关于卷积神经网络如何工作的直觉</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">medium.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><p id="7f03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将在猫狗数据集上工作，这意味着我们的网络将预测提供的图像是猫还是狗。您可以在下面找到数据集和代码的链接</p><div class="ls lt gp gr lu lv"><a href="https://www.kaggle.com/tongpython/cat-and-dog" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">猫和狗</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">训练 DL 模型的猫狗数据集</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">www.kaggle.com</p></div></div><div class="me l"><div class="mk l mg mh mi me mj kp lv"/></div></div></a></div><div class="ls lt gp gr lu lv"><a href="https://github.com/ajaymuktha/DeepLearning/blob/master/Convolutional%20Neural%20Networks/cnn.py" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">ajaymuktha/深度学习</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">这个知识库包含了神经网络算法——ajaymuktha/deep learning</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">github.com</p></div></div><div class="me l"><div class="ml l mg mh mi me mj kp lv"/></div></div></a></div><p id="68b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了便于计算，我从数据集中提取了大约 10，000 张图像，制作了一个验证文件夹，并放置了一些猫和狗的随机图像，以测试训练后的分类器。</p><p id="bb41" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据集包含两个文件夹<strong class="ky ir"> Train </strong>和 T <strong class="ky ir"> est。</strong>训练文件夹包含两个文件夹，由用于训练的猫和狗的图像组成。测试文件夹也由两个文件夹组成，这两个文件夹由用于评估模型的猫和狗的图像组成。训练集由 8000 幅猫狗图像组成，测试集由 2000 幅猫狗图像组成</p><h1 id="8f09" class="mm mn iq bd mo mp mq mr ms mt mu mv mw jw mx jx my jz mz ka na kc nb kd nc nd bi translated">安装 Tensorflow</h1><p id="082a" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">如果你的 PC 或笔记本电脑没有 GPU，你可以使用 Google Colab，或者使用 Jupyter Notebook。如果您使用您的系统，请升级 pip，然后安装 TensorFlow，如下所示</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/5cee9e094edacc7c9c053614e51037f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/0*veS_ZXK6SlnO-dRP.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">tensorflow.org</p></figure><h1 id="cba6" class="mm mn iq bd mo mp mq mr ms mt mu mv mw jw mx jx my jz mz ka na kc nb kd nc nd bi translated">导入依赖项</h1><p id="935c" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">在上面几行代码中，我只是导入了这个过程中需要的所有库</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h1 id="a1cb" class="mm mn iq bd mo mp mq mr ms mt mu mv mw jw mx jx my jz mz ka na kc nb kd nc nd bi translated">数据再处理</h1><h2 id="6d6a" class="nm mn iq bd mo nn no dn ms np nq dp mw lf nr ns my lj nt nu na ln nv nw nc nx bi translated">训练集的预处理</h2><p id="58ca" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">我们将在训练图像上应用一些变换以避免过度拟合，如果我们不执行，我们将在训练集和测试集的准确性之间得到很大的差异。</p><p id="0812" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们执行一些几何变换，如水平翻转图像，垂直翻转，放大，缩小和许多其他可以执行的操作，我们应用它，这样我们的模型就不会过度学习我们的训练图像。我们使用<strong class="ky ir"> ImageDataGenerator </strong>类执行上述方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="94d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> train_datagen </strong>是 ImageDataGenerator 类的实例，它将对训练集中的图像应用所有变换，rescale 方法将对图像中的所有像素应用特征缩放，使其在 0 到 1 的范围内。现在我们需要将它连接到我们的训练数据集。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="6e05" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> flow_from_directory </strong>将把图像增强过程连接到我们的训练集。我们需要提到我们的训练集的路径。<strong class="ky ir">目标尺寸</strong>是应该输入神经网络的图像尺寸。<strong class="ky ir">批量大小</strong>被定义为一批中图像的数量，<strong class="ky ir">类模式</strong>将是二进制的，因为我们只有两个输出，要么是猫，要么是狗。</p><h2 id="a82e" class="nm mn iq bd mo nn no dn ms np nq dp mw lf nr ns my lj nt nu na ln nv nw nc nx bi translated">预处理测试集</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="b4c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们不为测试集应用变换，因为我们只使用它们来评估，对我们的测试集做的唯一任务是重新缩放图像，因为在训练部分，我们定义了可以馈入网络的图像的目标大小。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="321b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们定义从目录中导入测试图像的测试集。我们定义的批量大小、目标大小和班级模式与训练集中提到的相同。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ecfaf91cb2871aa8b463c07db6d28069.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zbD-SzNRK_kNHDWNUVSJDQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@vincentiu?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">文森特·所罗门</a>在<a class="ae kv" href="https://unsplash.com/s/photos/space?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="df1e" class="mm mn iq bd mo mp mq mr ms mt mu mv mw jw mx jx my jz mz ka na kc nb kd nc nd bi translated">构建 CNN</h1><p id="0f65" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">卷积神经网络是一系列连续的层，所以这里我们用一个连续的类来定义它</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="6af6" class="nm mn iq bd mo nn no dn ms np nq dp mw lf nr ns my lj nt nu na ln nv nw nc nx bi translated"><strong class="ak">卷积层</strong></h2><p id="e802" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">我们使用<strong class="ky ir">添加一个</strong>方法来添加层，首先我们添加卷积层 Conv2D 类，我们需要在其中传递三个参数</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="c9ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> filters </strong> →图像需要应用的特征检测器的数量，也称为内核。</p><p id="0ade" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">内核大小</strong> →需要根据行数和列数为您的特征检测器定义一个内核大小。</p><p id="f95d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> input_shape </strong> →每当我们在任何深度学习模型中添加第一层时，我们都需要指定 input_shape，因为我们在处理图像时需要提供我们上面在训练集中提到的目标大小，3 是指 RGB 通道。</p><p id="5611" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">激活 _ 功能</strong> →我们需要指定触发机制的激活功能。</p><h2 id="e991" class="nm mn iq bd mo nn no dn ms np nq dp mw lf nr ns my lj nt nu na ln nv nw nc nx bi translated">联营</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="df40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们考虑最大池类，我们需要指定两个参数</p><p id="deb1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> pool_size </strong> →这是我们为卷积层中获得的特征检测器申请的帧的大小。</p><p id="c370" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">步幅→帧在所有四个方向上应该移动的量</p><p id="f6de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们将第二个卷积层应用于我们的网络</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="38c1" class="nm mn iq bd mo nn no dn ms np nq dp mw lf nr ns my lj nt nu na ln nv nw nc nx bi translated">变平</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="4442" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们将所有卷积和最大池层转换为一维，这将成为全连接层的输入。</p><h2 id="9546" class="nm mn iq bd mo nn no dn ms np nq dp mw lf nr ns my lj nt nu na ln nv nw nc nx bi translated">全连接层</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="e97b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们传递到稠密层的参数是作为单元的隐藏神经元的数量，我们使用的激活函数是 relu。</p><h2 id="7ca8" class="nm mn iq bd mo nn no dn ms np nq dp mw lf nr ns my lj nt nu na ln nv nw nc nx bi translated">输出层</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="7b46" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出单元的数量将是 1，因为我们将只预测一个类，并且激活函数将是 sigmoid 激活函数。</p><h1 id="44df" class="mm mn iq bd mo mp mq mr ms mt mu mv mw jw mx jx my jz mz ka na kc nb kd nc nd bi translated">训练 CNN</h1><h2 id="406b" class="nm mn iq bd mo nn no dn ms np nq dp mw lf nr ns my lj nt nu na ln nv nw nc nx bi translated">编译 CNN</h2><p id="3a10" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">我们考虑采用两个参数的编译方法，一个是编译器 adam，一个是损失函数 binary_crossentropy，我们选择度量作为精确度。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="8912" class="nm mn iq bd mo nn no dn ms np nq dp mw lf nr ns my lj nt nu na ln nv nw nc nx bi translated"><strong class="ak">训练 CNN </strong></h2><p id="1973" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">我们将使用 fit 方法通过训练集进行训练，并使用测试集来评估模型。我们将运行 25 个时期。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><h2 id="66de" class="nm mn iq bd mo nn no dn ms np nq dp mw lf nr ns my lj nt nu na ln nv nw nc nx bi translated">预言；预测；预告</h2><p id="54c3" class="pw-post-body-paragraph kw kx iq ky b kz ne jr lb lc nf ju le lf ng lh li lj nh ll lm ln ni lp lq lr ij bi translated">让我们通过拍摄一个随机图像来进行预测，为此，我们导入基本的库 NumPy …和 image 来执行图像操作。我们使用<strong class="ky ir"> load_img </strong>函数来加载 PIL 格式的图像，我们提到了测试图像的路径，并且它应该与训练图像具有相同的大小。然后，我们使用 img_array 函数将图像转换为模型期望的数组进行预处理。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="9014" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的 CNN 模型被训练成一批图像，而不是一个单独的图像，所以我们需要增加一个额外的维度。我们将增加一个额外的维度来访问单独的图像。我们使用 NumPy 中的<strong class="ky ir"> expand_dim </strong>函数来实现。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nk nl l"/></div></figure><p id="4a5e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们对测试图像使用 predict 方法，还从批量大小中访问图像的标签，并使用 if-else 条件来检查图像是猫还是狗。</p><p id="c5fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是现在，希望你喜欢这个关于猫和狗分类的教程，在我的下一个博客中，我将向你解释递归神经网络的重要性，并从头实现它的一个应用。</p><p id="e483" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想知道人工神经网络如何与应用程序一起工作，请查看我下面的博客:</p><div class="ls lt gp gr lu lv"><a rel="noopener follow" target="_blank" href="/introduction-to-artificial-neural-networks-ac338f4154e5"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">人工神经网络导论</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">你深度学习的第一步</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">towardsdatascience.com</p></div></div><div class="me l"><div class="ny l mg mh mi me mj kp lv"/></div></div></a></div><div class="ls lt gp gr lu lv"><a rel="noopener follow" target="_blank" href="/building-an-ann-with-tensorflow-ec9652a7ddd4"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">用 Tensorflow 构建人工神经网络</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">如何使用 TensorFlow 构建神经网络的分步教程</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">towardsdatascience.com</p></div></div><div class="me l"><div class="nz l mg mh mi me mj kp lv"/></div></div></a></div></div></div>    
</body>
</html>