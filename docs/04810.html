<html>
<head>
<title>NLP Pipeline Tutorial for Text Classification Modeling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">文本分类建模的NLP管道教程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/nlp-python-pipeline-tutorial-for-text-classification-modeling-6eb1000f909c?source=collection_archive---------27-----------------------#2020-04-27">https://towardsdatascience.com/nlp-python-pipeline-tutorial-for-text-classification-modeling-6eb1000f909c?source=collection_archive---------27-----------------------#2020-04-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6b69" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于使用sklearn的FeatureUnion、Pipeline和transformers预处理组合文本和数字数据的数据科学python教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/93e786a2e5b743183a93e7f58715db42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N2eK_kI7l-k4O1j3rtwlNg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">文本和数字特征转换器的Python代码。作者截图来自<a class="ae ky" href="https://github.com/mprzybyla123/nlp-example" rel="noopener ugc nofollow" target="_blank">GitHub</a>【1】代码。</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="1141" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">目录</h1><ol class=""><li id="cff0" class="ly lz it ma b mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">什么是特征转换？</li><li id="6663" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">NLP对您的模型的好处</li><li id="1ba2" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">关于数据</li><li id="24ce" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">文本和数字转换器教程</li><li id="ab5b" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">摘要</li><li id="2abd" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml mm mn mo mp bi translated">参考</li></ol><h1 id="1079" class="lg lh it bd li lj mv ll lm ln mw lp lq jz mx ka ls kc my kd lu kf mz kg lw lx bi translated">什么是特征转换？</h1><p id="6870" class="pw-post-body-paragraph na nb it ma b mb mc ju nc md me jx nd mf ne nf ng mh nh ni nj mj nk nl nm ml im bi translated">机器学习最困难的方面之一是为您的模型摄取文本数据。在构建模型时，有您的输入或特征，然后是您试图预测的内容。虽然某些类型的模型可以按数值或分类预测值或目标变量进行分组，但当您不仅要使用数值，还要使用文本作为要素类型时，并没有太多的文档说明该如何操作。要素变换是一种将两种类型结合起来并将其转换为可用格式的方法，可作为X变量来预测Y预测值或变量。下面的代码使用sklearn库将这两种类型的数据转换并组合成一个输入。</p><h1 id="8b38" class="lg lh it bd li lj mv ll lm ln mw lp lq jz mx ka ls kc my kd lu kf mz kg lw lx bi translated">NLP对您的模型的好处</h1><p id="d8b7" class="pw-post-body-paragraph na nb it ma b mb mc ju nc md me jx nd mf ne nf ng mh nh ni nj mj nk nl nm ml im bi translated">NLP，也称为自然语言处理，可用于将文本特征转换为数字表示。好处如下:</p><ul class=""><li id="f43c" class="ly lz it ma b mb nn md no mf np mh nq mj nr ml ns mn mo mp bi translated">将输入要素转换为较小的尺寸</li><li id="60f5" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml ns mn mo mp bi translated">将目标变量转换成较小的大小</li><li id="b1ff" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml ns mn mo mp bi translated">将分类数据转换成数字</li><li id="8934" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml ns mn mo mp bi translated">将文本数据转换为数字</li><li id="f05e" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml ns mn mo mp bi translated">标准化您的输入数据</li><li id="fffc" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml ns mn mo mp bi translated">清理您的数据</li></ul><h1 id="09f7" class="lg lh it bd li lj mv ll lm ln mw lp lq jz mx ka ls kc my kd lu kf mz kg lw lx bi translated">关于数据</h1><p id="4542" class="pw-post-body-paragraph na nb it ma b mb mc ju nc md me jx nd mf ne nf ng mh nh ni nj mj nk nl nm ml im bi translated">这里的数据集是随机的，有三个数字特征的虚拟数据；<em class="nt">‘已确认_测试’，‘已确认_恢复’，‘已确认_新建’</em>，具有一个文本特征；<em class="nt">‘正文_特写’</em>。在这种情况下，目标变量被标记为<em class="nt">‘Text _ Predictor’</em>。正常情况下，这个数据集很容易被消化到机器学习模型中，但这里我们引入了一个文本特征，这确实带来了一个问题。问题是，我们有两种截然不同的数据。按照下面的教程，这个问题是用Python、<a class="ae ky" href="https://scikit-learn.org/0.19/auto_examples/hetero_feature_union.html" rel="noopener ugc nofollow" target="_blank">sk learn</a>【2】和<a class="ae ky" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">pandas</a>【3】解决和描述的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/bd8cf8a12cac26de36d27af4713799b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HWU5IIdG18PmWckaFJuuGg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">仔细观察所用的数据帧。作者截图来自<a class="ae ky" href="https://github.com/mprzybyla123/nlp-example" rel="noopener ugc nofollow" target="_blank">GitHub</a>【1】代码。</p></figure><h1 id="2dc8" class="lg lh it bd li lj mv ll lm ln mw lp lq jz mx ka ls kc my kd lu kf mz kg lw lx bi translated">文本和数字转换器教程</h1><p id="0b97" class="pw-post-body-paragraph na nb it ma b mb mc ju nc md me jx nd mf ne nf ng mh nh ni nj mj nk nl nm ml im bi translated">下面是如何设置Jupyter笔记本的教程。ipynb文件或您的Python。py文件。使用sklearn的库，您可以读入数据帧，转换输入要素和目标变量，然后开发一个随机森林模型来帮助预测新标签。</p><ul class=""><li id="41dc" class="ly lz it ma b mb nn md no mf np mh nq mj nr ml ns mn mo mp bi translated">TfidfVectorizer —术语频率-逆文档频率矢量器，根据您的特征在词的语料库中找到您的术语的唯一性</li><li id="11cc" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml ns mn mo mp bi translated">base estimator——sk learn库的基类</li><li id="1587" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml ns mn mo mp bi translated">用于sklearn库的transformer Mixin-Mixin类</li><li id="40f2" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml ns mn mo mp bi translated">管道-将要素和分类器结合在一起</li><li id="3931" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml ns mn mo mp bi translated">FeatureUnion组合所有特征；文本和数字一起</li><li id="a13b" class="ly lz it ma b mb mq md mr mf ms mh mt mj mu ml ns mn mo mp bi translated">pandas.get _ dummies将分类目标转换为数字</li></ul><p id="68d6" class="pw-post-body-paragraph na nb it ma b mb nn ju nc md no jx nd mf nv nf ng mh nw ni nj mj nx nl nm ml im bi translated">要遵循本教程，请查找一个类似的数据集，该数据集同时具有数字和文本特征以及分类目标变量。首先，导入必要的库。参考sklearn代码和类:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="4358" class="od lh it nz b gy oe of l og oh">BaseEstimator, TransformerMixin that are used in TextTransfomer and NumberTransformer classes.</span></pre><p id="aec3" class="pw-post-body-paragraph na nb it ma b mb nn ju nc md no jx nd mf nv nf ng mh nw ni nj mj nx nl nm ml im bi translated">接下来，读入你的数据帧。然后，创建您的<em class="nt"> vec_tdidf </em>对象，该对象使用<em class="nt"> TfidVectorizer </em>，通过利用其术语频率逆文档频率矢量器将文本计数转换为术语重要性的加权矩阵。使用<em class="nt">管道</em>创建一个管道对象，为“文本特征”一起编译转换器和矢量器。将相同的规则应用于数字要素，并分别对其进行标注。现在所有的特征类型都被转换了，使用<em class="nt"> FeatureUnion </em>将它们合并成一个。</p><p id="d525" class="pw-post-body-paragraph na nb it ma b mb nn ju nc md no jx nd mf nv nf ng mh nw ni nj mj nx nl nm ml im bi translated">下一步是创建您的随机森林分类器。然后，将特征和分类器结合在一起，这就是你的模型对象。使用<em class="nt"> pd.get_dummies将目标变量从分类变量转换为数字变量也很重要。</em></p><p id="eabc" class="pw-post-body-paragraph na nb it ma b mb nn ju nc md no jx nd mf nv nf ng mh nw ni nj mj nx nl nm ml im bi translated">为文本和数字特征创建一个列表，并分配目标变量。这些新项目将在<em class="nt"> train_test_split </em>中从您的数据帧中引用。接下来，使用<em class="nt"> X_train </em>和<em class="nt"> y_train </em>装配您的模型。然后，可以从测试集<em class="nt"> X_test </em>中预测。</p><p id="85e1" class="pw-post-body-paragraph na nb it ma b mb nn ju nc md no jx nd mf nv nf ng mh nw ni nj mj nx nl nm ml im bi translated">最后，使用sklearn <em class="nt">指标</em>，从你的<em class="nt"> y_test </em>和<em class="nt"> preds </em>(预测)计算出你的<em class="nt"> accuracy_score </em>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">整个nlp-example.py文件。由作者连同<a class="ae ky" href="https://scikit-learn.org/" rel="noopener ugc nofollow" target="_blank">sk learn</a>【2】和<a class="ae ky" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>【3】一起编码。</p></figure><h1 id="da6e" class="lg lh it bd li lj mv ll lm ln mw lp lq jz mx ka ls kc my kd lu kf mz kg lw lx bi translated">摘要</h1><p id="3e1d" class="pw-post-body-paragraph na nb it ma b mb mc ju nc md me jx nd mf ne nf ng mh nh ni nj mj nk nl nm ml im bi translated">总之，sklearn及其作者，以及pandas，已经使编译杂乱和异构的数据变得简单，以便干净有效地输入到您的机器学习模型中。使用这些公共库，每个数据科学家现在不必仅仅依靠数字特征来预测他们的目标变量，而是也可以使用文本/单词/术语数据。使用这些NLP技术，可以很容易地对文本分类问题(如术语分类)进行建模。</p><h1 id="cf6c" class="lg lh it bd li lj mv ll lm ln mw lp lq jz mx ka ls kc my kd lu kf mz kg lw lx bi translated">参考</h1><p id="b2d3" class="pw-post-body-paragraph na nb it ma b mb mc ju nc md me jx nd mf ne nf ng mh nh ni nj mj nk nl nm ml im bi translated">旁注——在我的代码、文本和文件中，我使用术语“预测器”作为预测的东西，也称为目标变量，或人们试图分类的东西。</p><p id="4c7c" class="pw-post-body-paragraph na nb it ma b mb nn ju nc md no jx nd mf nv nf ng mh nw ni nj mj nx nl nm ml im bi translated">[1] M.Przybyla，<a class="ae ky" href="https://github.com/mprzybyla123/nlp-example" rel="noopener ugc nofollow" target="_blank"> GitHub </a> (2020)</p><p id="c556" class="pw-post-body-paragraph na nb it ma b mb nn ju nc md no jx nd mf nv nf ng mh nw ni nj mj nx nl nm ml im bi translated">[2] sklearn，<a class="ae ky" href="https://scikit-learn.org/" rel="noopener ugc nofollow" target="_blank"> sklearn </a> (2020)</p><p id="9d65" class="pw-post-body-paragraph na nb it ma b mb nn ju nc md no jx nd mf nv nf ng mh nw ni nj mj nx nl nm ml im bi translated">[3]熊猫，<a class="ae ky" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a> (2020)</p></div></div>    
</body>
</html>