<html>
<head>
<title>I Tried Using Deep Learning to Predict the Stock Market</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我尝试用深度学习来预测股市</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-deep-learning-ai-to-predict-the-stock-market-9399cf15a312?source=collection_archive---------0-----------------------#2020-05-03">https://towardsdatascience.com/using-deep-learning-ai-to-predict-the-stock-market-9399cf15a312?source=collection_archive---------0-----------------------#2020-05-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="41ac" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用神经网络预测股票价格</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/71bc1b261a62f15eefdbe4626459a5ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*p6TmnuY60p7fWJCY"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Vladimir Solomyani 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="c540" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di">我</span>想象一下，如果你能够知道一只股票下周是涨是跌，然后用你剩余的现金，你会把所有的钱投资或做空这只股票。玩了股票市场之后，知道了股票会升值还是贬值，你可能会成为百万富翁！</p><p id="f478" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可惜这是不可能的，因为没有人能知道未来。然而，我们<em class="me">可以</em>根据我们现在和过去对任何股票的信息做出估计和明智的预测。根据股票价格过去的走势和模式做出的估计称为<a class="ae ky" href="https://www.investopedia.com/terms/t/technicalanalysis.asp" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">技术分析</strong> </a>。我们可以使用技术分析(<em class="me"> TA </em>)来预测一只股票的价格方向，然而，这并不是100%准确的。事实上，一些交易者批评TA，并说它在预测未来方面和占星术一样有效。但是也有其他交易者相信它，并且建立了长期成功的交易生涯。</p><p id="3860" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的例子中，我们将使用的神经网络将利用TA来帮助它做出明智的预测。我们将实现的特定神经网络被称为<a class="ae ky" href="https://pathmind.com/wiki/lstm" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">递归神经网络——LSTM</strong></a>。之前我们利用RNN来预测比特币价格(<em class="me">见下面的文章</em>):</p><div class="mf mg gp gr mh mi"><a rel="noopener follow" target="_blank" href="/predicting-bitcoin-prices-with-deep-learning-438bc3cf9a6f"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd iu gy z fp mn fr fs mo fu fw is bi translated">我尝试了深度学习模型来预测比特币价格</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">使用神经网络预测比特币价格</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">towardsdatascience.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw ks mi"/></div></div></a></div><p id="d57d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在文章中，我们探索了LSTM预测比特币价格的用法。我们稍微研究了一下LSTM模型的背景，并给出了如何编程来预测BTC价格的说明。然而，我们将输入数据限制在比特币自身的价格历史上，不包括其他变量，如成交量或移动平均线等技术指标。</p><h2 id="6623" class="mx my it bd mz na nb dn nc nd ne dp nf li ng nh ni lm nj nk nl lq nm nn no np bi translated">多变量输入</h2><p id="31ea" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">由于我们构建的最后一个RNN只能接受一个序列(过去的收盘价)来预测未来，我们想看看是否有可能向神经网络添加更多的数据。也许这些其他数据可以提高我们的价格预测？也许通过在我们的数据集中添加TA指标，神经网络可能能够做出更准确的预测？—这正是我们想要在这里完成的。</p><p id="3c95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在接下来的几个部分中，我们将构建一个新的<em class="me">递归神经网络</em>，它能够以<em class="me">技术指标</em>的形式接收多条信息，从而预测股票市场的未来价格。</p><blockquote class="nv nw nx"><p id="ef63" class="kz la me lb b lc ld ju le lf lg jx lh ny lj lk ll nz ln lo lp oa lr ls lt lu im bi translated"><a class="ae ky" href="https://marco-santos.medium.com/membership" rel="noopener">在这里注册一个中级会员，可以无限制地访问和支持像我这样的内容！在你的支持下，我赚了一小部分会费。谢谢！</a></p></blockquote></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="0cb2" class="oi my it bd mz oj ok ol nc om on oo nf jz op ka ni kc oq kd nl kf or kg no os bi translated">价格历史和技术指标</h1><p id="3721" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">为了使用神经网络来预测股票市场，我们将利用来自<strong class="lb iu"><em class="me">&amp;【p500】</em></strong>的价格。这将使我们对股票市场有一个总体的了解，通过使用RNN，我们也许能够判断出市场的走向。</p><h2 id="0f39" class="mx my it bd mz na nb dn nc nd ne dp nf li ng nh ni lm nj nk nl lq nm nn no np bi translated">下载价格历史记录</h2><p id="58e4" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">要为我们的神经网络检索正确的数据，你需要去雅虎财经<a class="ae ky" href="https://finance.yahoo.com/quote/SPY/history?p=SPY" rel="noopener ugc nofollow" target="_blank"> <em class="me">下载间谍</em> </a>的价格。我们将为SPY下载五年的价格历史，作为一个方便的<code class="fe ot ou ov ow b">.csv</code>文件。</p><p id="67b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一种选择是使用财务数据API，如<a class="ae ky" href="https://eodhistoricaldata.com/r/?ref=31CX3ILN" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> EOD历史数据</strong> </a>。注册是免费的，你可以访问大量的数据集。<em class="me">披露:我通过上面的链接从任何购买中赚取一小笔佣金。</em></p><h2 id="ce49" class="mx my it bd mz na nb dn nc nd ne dp nf li ng nh ni lm nj nk nl lq nm nn no np bi translated">技术指标</h2><p id="c205" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">在我们下载了SPY的价格历史之后，我们可以应用技术分析Python库来生成技术指标值。此处更深入地介绍了我们能够从中检索指标值的流程:</p><div class="mf mg gp gr mh mi"><a rel="noopener follow" target="_blank" href="/technical-indicators-on-bitcoin-using-python-c392b4a33810"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd iu gy z fp mn fr fs mo fu fw is bi translated">我是如何为比特币的技术指标编码的</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">使用Python创建比特币的技术指标</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">towardsdatascience.com</p></div></div><div class="mr l"><div class="ox l mt mu mv mr mw ks mi"/></div></div></a></div><p id="27c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的文章详细介绍了我们为了检索SPY的指标值而使用的确切的TA Python库。</p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="3082" class="oi my it bd mz oj ok ol nc om on oo nf jz op ka ni kc oq kd nl kf or kg no os bi translated">编码神经网络</h1><h2 id="3ef4" class="mx my it bd mz na nb dn nc nd ne dp nf li ng nh ni lm nj nk nl lq nm nn no np bi translated">导入库</h2><p id="f5ad" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">让我们通过首先导入一些库来开始编码我们的神经网络:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><p id="14cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们导入了一些常用的Python库(<em class="me"> numpy、pandas等</em>)。接下来，我们导入了之前用来创建BTC技术指标的技术分析库(上文中的提到了<em class="me">)。然后，我们从<a class="ae ky" href="https://www.tensorflow.org/guide/keras" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">tensor flow Keras</strong></a>导入神经网络库。导入必要的库后，我们将加载从雅虎财经下载的文件。</em></p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="f554" class="oi my it bd mz oj ok ol nc om on oo nf jz op ka ni kc oq kd nl kf or kg no os bi translated">预处理数据</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><h2 id="5adf" class="mx my it bd mz na nb dn nc nd ne dp nf li ng nh ni lm nj nk nl lq nm nn no np bi translated">日期时间转换</h2><p id="26fe" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">加载数据后，我们需要执行一些预处理，以便为神经网络准备数据，我们需要做的第一件事是将数据帧的索引转换为日期时间格式。然后，我们将数据中的<code class="fe ot ou ov ow b">Date</code>列设置为DF的索引。</p><h2 id="eaf1" class="mx my it bd mz na nb dn nc nd ne dp nf li ng nh ni lm nj nk nl lq nm nn no np bi translated">创建技术指标</h2><p id="c1c1" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">接下来，我们将使用<code class="fe ot ou ov ow b">ta</code>库创建一些技术指标。为了涵盖尽可能多的技术分析，我们将使用<em class="me">库中所有可用的指标。然后，从数据集中删除除了<em class="me">指标</em>和<em class="me">收盘</em> <em class="me">价格</em>之外的所有数据。</em></p><h2 id="a40f" class="mx my it bd mz na nb dn nc nd ne dp nf li ng nh ni lm nj nk nl lq nm nn no np bi translated">最近的数据</h2><p id="f4d4" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">一旦我们创建了技术指标值，我们就可以从原始数据集中删除一些行。我们将只包括最后1000行数据，以便更准确地反映当前的市场环境。</p><h2 id="a3e0" class="mx my it bd mz na nb dn nc nd ne dp nf li ng nh ni lm nj nk nl lq nm nn no np bi translated">缩放数据</h2><p id="ed2f" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">当缩放我们的数据时，有多种方法可以确保我们的数据仍然被准确地表示。试验不同的缩放器以查看它们对模型性能的影响可能是有用的。</p><p id="1f89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的例子中，我们将利用<code class="fe ot ou ov ow b">RobustScaler</code>来扩展我们的数据。这样做是为了使极端的异常值几乎没有影响，并有望改善训练时间和整体模型性能。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/44607774b75e910824eaca0b407af087.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lH0YFSyJ5fuMfY9TWhN3lQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用强大的缩放器缩放收盘价</p></figure></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="e246" class="oi my it bd mz oj ok ol nc om on oo nf jz op ka ni kc oq kd nl kf or kg no os bi translated">助手功能</h1><p id="0630" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">在我们开始构建神经网络之前，让我们创建一些辅助函数来更好地优化这个过程。我们将详细解释每个功能。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><ol class=""><li id="d46f" class="pb pc it lb b lc ld lf lg li pd lm pe lq pf lu pg ph pi pj bi translated"><code class="fe ot ou ov ow b">split_sequence</code> —此函数分割多元时间序列。在我们的例子中，输入值将是股票的<em class="me">收盘价</em>和<em class="me">指标</em>。这将把这些值拆分成我们的<strong class="lb iu"> <em class="me"> X </em> </strong>和<strong class="lb iu"> <em class="me"> y </em> </strong>变量。<strong class="lb iu"> <em class="me"> X </em> </strong>值将包含过去的收盘价和技术指标。<strong class="lb iu"> <em class="me"> y </em> </strong>值将包含我们的目标值(仅<em class="me">未来收盘价</em>)。</li><li id="9bee" class="pb pc it lb b lc pk lf pl li pm lm pn lq po lu pg ph pi pj bi translated"><code class="fe ot ou ov ow b">visualize_training_results</code> —这个函数将帮助我们评估刚刚创建的神经网络。我们在评估我们的NN时要寻找的东西是<strong class="lb iu"> <em class="me">收敛</em> </strong>。随着训练的进行，<strong class="lb iu">损失</strong>和<strong class="lb iu">准确度</strong>的验证值和常规值必须开始与<em class="me">对齐</em>。如果它们不收敛，那么这可能是过度拟合/欠拟合的迹象。我们必须回过头来修改神经网络的结构，这意味着改变层/节点的数量，改变优化函数等。</li><li id="1e4e" class="pb pc it lb b lc pk lf pl li pm lm pn lq po lu pg ph pi pj bi translated"><code class="fe ot ou ov ow b">layer_maker</code> —这个函数构造了我们的神经网络的主体。在这里，我们可以自定义层数和节点数。它还有一个正则化选项，可以在必要时添加漏失层，以防止过拟合/欠拟合。</li><li id="1503" class="pb pc it lb b lc pk lf pl li pm lm pn lq po lu pg ph pi pj bi translated"><code class="fe ot ou ov ow b">validater</code> —该函数使用特定日期范围的预测值创建DF。这个范围随着每个循环向前滚动。范围的间隔是可定制的。我们使用这个DF来评估模型的预测，稍后将它们与实际值进行比较。</li><li id="fedd" class="pb pc it lb b lc pk lf pl li pm lm pn lq po lu pg ph pi pj bi translated"><code class="fe ot ou ov ow b">val_rmse</code> —该函数将返回模型预测值与实际值相比的均方根误差(<em class="me"> RMSE </em>)。返回值代表我们的模型预测的平均偏差。总体目标是降低我们模型预测的RMSE。</li></ol></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="993e" class="oi my it bd mz oj ok ol nc om on oo nf jz op ka ni kc oq kd nl kf or kg no os bi translated">拆分数据</h1><p id="f86b" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">为了适当地格式化我们的数据，我们需要将数据分成两个序列。这些序列的长度可以修改，但我们将使用过去90天的值来预测未来30天的价格。然后，<code class="fe ot ou ov ow b">split_sequence</code>函数会将我们的数据格式化成适当的<strong class="lb iu"> <em class="me"> X </em> </strong>和<strong class="lb iu"> <em class="me"> y </em> </strong>变量，其中<strong class="lb iu"> <em class="me"> X </em> </strong>包含过去90天的收盘价<em class="me">和</em>指标，而<strong class="lb iu"> <em class="me"> y </em> </strong>包含未来30天的收盘价。</p><pre class="kj kk kl km gt pp ow pq pr aw ps bi"><span id="6a71" class="mx my it ow b gy pt pu l pv pw"># How many periods looking back to learn<br/>n_per_in  = 90</span><span id="cb6d" class="mx my it ow b gy px pu l pv pw"># How many periods to predict<br/>n_per_out = 30</span><span id="e49e" class="mx my it ow b gy px pu l pv pw"># Features <br/>n_features = df.shape[1]</span><span id="8dc6" class="mx my it ow b gy px pu l pv pw"># Splitting the data into appropriate sequences<br/>X, y = split_sequence(df.to_numpy(), n_per_in, n_per_out)</span></pre><p id="17cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的神经网络将对这些信息做的是<em class="me">了解</em>过去90天的收盘价和技术指标值<em class="me">如何影响</em>未来30天的收盘价。</p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="b111" class="oi my it bd mz oj ok ol nc om on oo nf jz op ka ni kc oq kd nl kf or kg no os bi translated">神经网络建模</h1><p id="afb6" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">现在我们可以开始构建我们的神经网络了！下面的代码是我们如何用自定义层和节点构建神经网络的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><p id="fa95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我们开始试验以下参数的地方:</p><ul class=""><li id="14b5" class="pb pc it lb b lc ld lf lg li pd lm pe lq pf lu py ph pi pj bi translated">层数</li><li id="6ac4" class="pb pc it lb b lc pk lf pl li pm lm pn lq po lu py ph pi pj bi translated">节点数量</li><li id="5ca5" class="pb pc it lb b lc pk lf pl li pm lm pn lq po lu py ph pi pj bi translated">不同的激活功能</li><li id="d94d" class="pb pc it lb b lc pk lf pl li pm lm pn lq po lu py ph pi pj bi translated">不同的优化器</li><li id="7802" class="pb pc it lb b lc pk lf pl li pm lm pn lq po lu py ph pi pj bi translated">时期数和批量大小</li></ul><p id="9b06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们为这些参数中的每一个输入的值都必须被探究，因为每一个值都会对整个模型的质量产生显著的影响。可能有一些方法可以找到每个参数的最佳值。对于我们的例子，我们主观地测试了每个参数的不同值，我们发现的最佳值可以在上面的代码片段中看到。</p><p id="cccc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你希望了解更多关于这些变量背后的推理和概念，那么建议你阅读我们之前的<a class="ae ky" rel="noopener" target="_blank" href="/predicting-bitcoin-prices-with-deep-learning-438bc3cf9a6f"> <em class="me">关于深度学习和比特币</em> </a>的文章。</p><h2 id="d1f2" class="mx my it bd mz na nb dn nc nd ne dp nf li ng nh ni lm nj nk nl lq nm nn no np bi translated">可视化损失和准确性</h2><p id="735b" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">训练后，我们将使用自定义助手函数来可视化神经网络的进展:</p><pre class="kj kk kl km gt pp ow pq pr aw ps bi"><span id="9ab9" class="mx my it ow b gy pt pu l pv pw">visualize_training_results(res)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pz"><img src="../Images/1df92e53b447de18965561a122638493.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n56dVJPMX9VxxuVYTiHfhw.png"/></div></div></figure><p id="8ae0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着我们的网络训练，我们可以看到损失减少和准确性增加。一般来说，随着历元数量的增加，我们会寻找两条线<strong class="lb iu"> <em class="me">汇聚或</em> </strong>对齐。如果他们没有，那么这是一个迹象，表明该模型是不充分的，我们将需要回去，改变一些参数。</p><h2 id="ffe8" class="mx my it bd mz na nb dn nc nd ne dp nf li ng nh ni lm nj nk nl lq nm nn no np bi translated">模型验证</h2><p id="309f" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">我们评估模型预测质量的另一种方法是对照实际值进行测试，并使用我们的自定义帮助函数<code class="fe ot ou ov ow b">val_rmse</code>计算RMSE。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qa"><img src="../Images/d5cd902c8e75829b01912617071a4ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*voMOjU43ybP5ARErIMZYkQ.png"/></div></div></figure><p id="40c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们将预测值与实际值绘制在一起，看看比较的效果如何。如果预测值的曲线非常偏离实际值，那么我们知道我们的模型是有缺陷的。但是，如果这些值看起来非常接近，并且RMSE非常低，那么我们可以得出结论，我们的模型是可以接受的。</p><p id="fd16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的模型似乎在开始做得很好，但它不能捕捉或模拟价格的剧烈波动。这可能是为什么最后三个预测看起来非常遥远。也许通过更多的训练和实验，我们的模型可以预测这些运动。</p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="1065" class="oi my it bd mz oj ok ol nc om on oo nf jz op ka ni kc oq kd nl kf or kg no os bi translated">预测未来</h1><p id="8189" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">一旦我们对模型的表现感到满意，我们就可以用它来预测未来的值。这一部分相对于我们已经做的事情来说相当简单。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><p id="c170" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们只是从下载的<code class="fe ot ou ov ow b">.csv</code>文件中预测出最近的值。运行代码后，我们将看到以下预测:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qb"><img src="../Images/b62638a4bd60fc62fd0353389269d62d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0uRHKzBOYrwHw2zoJwu-BQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">下个月间谍价格预测</p></figure><p id="d3bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们做到了！—间谍的预测价格。用这些知识做你想做的事情，但是记住一件事:<em class="me">股票市场是不可预测的</em>。这里预测的值是<em class="me">而不是</em>确定的。它们可能比随机猜测要好，因为这些值是基于过去的技术指标和价格模式的有根据的猜测。</p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h1 id="fa4e" class="oi my it bd mz oj ok ol nc om on oo nf jz op ka ni kc oq kd nl kf or kg no os bi translated">关闭</h1><p id="cde2" class="pw-post-body-paragraph kz la it lb b lc nq ju le lf nr jx lh li ns lk ll lm nt lo lp lq nu ls lt lu im bi translated">我们能够成功地构建一个LSTM层的递归神经网络，它能够接受多个输入而不是一个。模型的质量可能因人而异，取决于他们希望在模型上花费多少时间。即使预测未来是不可能的，但这些预测对于那些希望了解股票未来价格走势的人来说非常有用。但是，它很可能认为这种方式比随机猜测要好。</p><p id="1c78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="me">在eodhistoricaldata.com另外出版</em> </p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><p id="10e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="me">来自《走向数据科学》编辑的注释:</em> </strong> <em class="me">虽然我们允许独立作者根据我们的</em> <a class="ae ky" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="me">规则和指南</em> </a> <em class="me">发表文章，但我们并不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae ky" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="me">读者术语</em> </a> <em class="me">。</em></p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h2 id="21e8" class="mx my it bd mz na nb dn nc nd ne dp nf li ng nh ni lm nj nk nl lq nm nn no np bi translated">资源</h2><div class="mf mg gp gr mh mi"><a href="https://github.com/marcosan93/Price-Forecaster" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd iu gy z fp mn fr fs mo fu fw is bi translated">Marcos an 93/价格预测者</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">使用时间序列模型:萨里玛和FB先知预测比特币价格:使用递归神经网络:LSTM…</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">github.com</p></div></div><div class="mr l"><div class="qc l mt mu mv mr mw ks mi"/></div></div></a></div><div class="mf mg gp gr mh mi"><a rel="noopener follow" target="_blank" href="/predicting-bitcoin-prices-with-deep-learning-438bc3cf9a6f"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd iu gy z fp mn fr fs mo fu fw is bi translated">我尝试了深度学习模型来预测比特币价格</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">使用神经网络预测比特币价格</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">towardsdatascience.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw ks mi"/></div></div></a></div><div class="mf mg gp gr mh mi"><a rel="noopener follow" target="_blank" href="/technical-indicators-on-bitcoin-using-python-c392b4a33810"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd iu gy z fp mn fr fs mo fu fw is bi translated">我是如何为比特币的技术指标编码的</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">使用Python创建比特币的技术指标</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">towardsdatascience.com</p></div></div><div class="mr l"><div class="ox l mt mu mv mr mw ks mi"/></div></div></a></div><div class="mf mg gp gr mh mi"><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd iu gy z fp mn fr fs mo fu fw is bi translated">如何开发用于时间序列预测的LSTM模型-机器学习掌握</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">长短期记忆网络，简称LSTMs，可用于时间序列预测。有很多种…</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">machinelearningmastery.com</p></div></div><div class="mr l"><div class="qd l mt mu mv mr mw ks mi"/></div></div></a></div></div></div>    
</body>
</html>