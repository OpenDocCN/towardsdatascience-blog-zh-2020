<html>
<head>
<title>Impact of Regularization on Deep Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">正则化对深度神经网络的影响</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/impact-of-regularization-on-deep-neural-networks-1306c839d923?source=collection_archive---------37-----------------------#2020-07-09">https://towardsdatascience.com/impact-of-regularization-on-deep-neural-networks-1306c839d923?source=collection_archive---------37-----------------------#2020-07-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2524" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 TensorFlow 2.0 强调重量衰减</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/c1ac82efe9356e46016f6c5dc63bf23c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*fN4NFVVzaLs1QHezRtWKGA.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">一个高方差的模型(图片由作者提供)</p></figure><h1 id="393c" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated"><strong class="ak">简介</strong></h1><p id="18f3" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">在这个信息高速公路的时代，我们周围的世界正在向好的方向变化，可以毫不夸张地说，深度学习是下一次变革。深度学习是一套强大的数学工具，使我们能够表示、解释和控制我们周围的复杂世界。</p><p id="9761" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">编程范式正在改变:我们不再给计算机编程，而是教它学习一些东西，它做我们想做的事情。</p><p id="81f6" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">这个特殊的概念非常吸引人，并驱使机器学习实践者开发模型，以进一步发展这些概念和想法，并将它们应用于现实世界的场景中。</p><p id="45ea" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">然而，建立复杂的机器学习模型的基本问题是如何使架构不仅在训练数据上，而且在测试数据上，即在以前看不到的特征上做得好。为了克服这个中心问题，我们必须通过应用某些策略来修改模型，以减少测试误差，这可能是以增加训练误差为代价的。这些策略统称为<strong class="lo iu">正则化</strong>技术。然而，只有当模型遭受<strong class="lo iu"> <em class="mn">高方差</em> </strong>问题时，正则化才是有用的，在该问题中，网络过度适应训练数据，但是不能概括新特征(验证或测试数据)。</p><h1 id="9599" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated"><strong class="ak"> L2 范数或重量衰减</strong></h1><p id="c0b4" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">最广泛使用的正则化策略之一是利用 L2 范数。这可以通过向网络的成本函数添加正则化项来实现。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/71bbd0a1c48ea5e5fc268bac3ac6d903.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*IBTGDi5fdeskhMQ3_fymSA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">带有正则项的成本函数(作者要点)</p></figure><p id="52df" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">等式的第一部分对应于净网络损耗的计算。术语<em class="mn"> w </em> &amp; <em class="mn"> b </em>表示模型已经学习的权重和偏差。第二部分对应于计算权重向量的范数(<em class="mn"> w </em>)的正则化项。这个正则项被明确地称为著名的 L2 范数或权重衰减。这样的最终结果是，网络的权重矩阵根据正则化参数<em class="mn"> lambda (λ) </em>的值而受到惩罚。因此，正则化参数<em class="mn"> λ </em>可以被认为是需要微调的另一个超参数。</p><h1 id="da3a" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated"><strong class="ak">了解工作</strong></h1><p id="49b8" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">通过举一个极端的例子，可以理解 L2 规范的规则化影响背后的直觉。让我们将正则化参数<em class="mn"> λ </em>的值设置在较高端。这将严重惩罚网络的权重矩阵(<em class="mn"> w </em>)，它们将被赋予接近于零的值。其直接影响是神经网络的净激活减少，前向传递效应减弱。现在，有了简化得多的神经网络体系结构，该模型将无法过度适应训练数据，并将能够对新数据和特征进行更好的概括。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mp"><img src="../Images/90c4d66c1b599b4562a8e811d5a53b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8bTgTLp-fc7jgMi23m0wHg.jpeg"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">正则网络与非正则网络的分析(图片由作者提供)</p></figure><p id="5853" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">这种直觉基于正则化参数<em class="mn"> λ </em>的值被设置得非常高的事实。但是，如果选择该参数的中间值，将会提高测试集上的模型性能。</p><h1 id="fce3" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated"><strong class="ak">什么时候调整你的模型？</strong></h1><p id="8c47" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">弄清楚正则化概念背后的直觉当然很好，但是，更重要的一点是要知道你的网络是否真的需要正则化。在这里，绘制学习曲线起着至关重要的作用。</p><p id="1079" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">绘制出模型在多个时期的训练和验证损失是确定模型是否过度拟合的最广泛使用的方法。该方法背后的概念基于这样一个事实，即<strong class="lo iu">如果模型过度拟合训练数据，那么训练损失和验证损失将相差很大，而且验证损失将总是高于训练损失。</strong>其原因是，如果模型不能很好地概括以前未见过的数据，那么相应的损失或成本价值将不可避免地很高。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mu"><img src="../Images/9d9214863f4c686c7d05034d3228df54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lwajmzWdSHUZEIQUG5CADg.jpeg"/></div></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">过度拟合模型的学习曲线(图片由作者提供)</p></figure><p id="3ce3" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">从上图可以明显看出，训练损失和验证损失之间存在巨大的差距，这表明模型明显过度适合训练样本。</p><h1 id="d7ba" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated"><strong class="ak">使用 TensorFlow 2.0 实现 L2 范数</strong></h1><p id="1b8d" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">L2 规范的实际实施很容易证明。为此，让我们从 sklearn 获取<em class="mn">糖尿病数据集</em>，首先绘制非正则化模型的学习曲线，然后绘制正则化模型的学习曲线。</p><p id="a92d" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">该数据集有 442 个实例，并接受 10 个基线变量:<em class="mn">年龄、性别、身体质量指数、平均血压和 6 个血清测量值(S1 到 S6) </em>作为其训练特征(称为 x)和一年后疾病进展的<em class="mn">测量值</em>作为其标签(称为 y)。</p><h2 id="62eb" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated"><strong class="ak">非规范化模型</strong></h2><p id="4c56" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">让我们使用 TensorFlow 和 sklearn 导入数据集。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">导入数据集(按作者列出要点)</p></figure><p id="a8f1" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我们现在将数据分成训练集和测试集。测试集将保留 10%的训练数据。这可以使用 sklearn 中的<em class="mn"> train_test_split() </em>函数来完成。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">将数据集分成训练集和测试集(作者要点)</p></figure><p id="de09" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">现在，我们仅使用 Keras 的顺序 API 中的密集层创建一个非规范化模型。这个非正则化模型将有 6 个隐藏层，每个层都有一个 ReLU 激活功能。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">非规范化的模型架构(作者要点)</p></figure><p id="ede1" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在设计了模型架构之后，我们现在用<strong class="lo iu"> <em class="mn">亚当</em> </strong> <em class="mn"> </em>优化器和<strong class="lo iu"> <em class="mn">均方误差</em> </strong> <em class="mn"> </em>损失函数来编译模型。训练在<strong class="lo iu"> 100 个时期</strong>内进行，度量存储在一个变量中，该变量可用于绘制学习曲线。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">编译和训练模型(作者要点)</p></figure><p id="a7c0" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我们现在绘制训练数据和验证数据中观察到的模型损失:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/8044f27839240b6075f86eba62693122.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*DbxPhO53FJir_ZF3l1nKGQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">过度拟合的图表(图片由作者提供)</p></figure><p id="ec78" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">这里的结果是，验证损失在大约 10 个时期后持续上升，而训练损失持续下降。这种相反的趋势在两个损失之间产生了巨大的差距，这表明模型过度拟合了训练数据。</p><h2 id="cd7f" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">用 L2 范数正则化模型</h2><p id="fbeb" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">我们已经从前面的学习曲线中得出结论，非正则化模型会遭受过拟合，为了解决这个问题，我们引入了 L2 范数。</p><p id="514e" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">密集层和卷积层都有一个可选的<strong class="lo iu"><em class="mn">kernel _ regulator</em></strong>关键字参数。为了加入权重衰减或 L2 正则化，我们设置核正则化参数等于<strong class="lo iu"><em class="mn">TF . keras . regulators . L2(参数)</em> </strong>。这个参数对象是用一个必需的参数创建的，该参数是乘以权重平方和的系数或正则化参数<em class="mn"> λ。</em></p><p id="9691" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我们现在创建一个类似的网络架构，但是这一次，我们包括了<em class="mn">kernel _ regulator</em>参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">正则化模型架构(作者要点)</p></figure><p id="a934" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我们使用相同的优化器、损失函数、度量和时期数来编译和训练模型，因为这使得两个模型之间的比较更容易。</p><p id="71fd" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">训练后，当训练和验证损失相对于时期数作图时，观察到以下学习曲线:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/27e1184650a74a7c143da8436a4fa04d.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*LpYUiAPXPjdQfV9OEUA0yQ.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">正确匹配(图片由作者提供)</p></figure><p id="1ad2" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">正则化模型的学习曲线更加平滑，训练和验证损失彼此更加接近，这表示网络中的变化更小。现在，训练损失和验证损失都可以相互比较，这表明模型泛化新特征的信心增加了。</p><h1 id="825f" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated"><strong class="ak">结论</strong></h1><p id="d46a" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">在这个启发性的旅程中，我们通过比较两个模型的性能进行了广泛的分析，其中一个模型遭受过拟合，另一个模型解决了前一个模型的缺点。机器学习中的<strong class="lo iu"> <em class="mn">偏差和方差</em> </strong> <em class="mn"> </em>问题不容忽视，必须应用策略来克服这些非平凡的复杂性。我们今天讨论了一个这样的策略，以避免我们的模型出现偏差。</p><p id="c6ad" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">然而，旅程并没有就此停止，因此，我们必须把目光放得更远，必须顺风而行。</p><p id="a97e" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">这里是作者的 GitHub 库的链接，可以参考完整的代码。</p><div class="nk nl gp gr nm nn"><a href="https://github.com/ujjwalkumar2607/Regularisation-techniques-tensorflow" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">ujjwalkumar 2607/正则化-技术-张量流</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">通过在 GitHub 上创建一个帐户，为 ujjwalkumar 2607/regularization-techniques-tensor flow 开发做出贡献。</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">github.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob ko nn"/></div></div></a></div></div></div>    
</body>
</html>