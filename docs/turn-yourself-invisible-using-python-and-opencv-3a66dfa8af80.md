# ä½¿ç”¨ Python å’Œ OpenCV è®©è‡ªå·±éšå½¢

> åŸæ–‡ï¼š<https://towardsdatascience.com/turn-yourself-invisible-using-python-and-opencv-3a66dfa8af80?source=collection_archive---------16----------------------->

> å°†ä¸€ä¸ªäººä»èƒŒæ™¯ä¸­ç§»é™¤çš„ç¡®æ˜¯ä¸€é¡¹æœ‰è¶£åˆå°´å°¬çš„ä»»åŠ¡ã€‚åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘æƒ³ä¸€æ­¥ä¸€æ­¥åœ°å±•ç¤ºå¦‚ä½•ä½¿ç”¨ OpenCV å’Œ Python ä»ç›´æ’­æµä¸­åˆ é™¤ä¸€ä¸ªäººã€‚

![](img/2b6c2dc70d36126ba340f909f029e27c.png)

ç…§ç‰‡ç”±é˜¿ç´¢æ ¼è’‚åœ¨ unsplash.com æ‹æ‘„

å‡ å¤©å‰ï¼Œåœ¨æµè§ˆé»‘å®¢æ–°é—»æ—¶ï¼Œæˆ‘å¯¹è°·æ­Œå·¥ç¨‹å¸ˆæ°æ£®Â·æ¢…æ–¯çš„[T3 é¡¹ç›®å°è±¡æ·±åˆ»ã€‚ä»æˆ‘ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ä¸ªé¡¹ç›®çš„é‚£ä¸€åˆ»èµ·ï¼Œæˆ‘å°±å†³å®šä¸€å®šè¦(è‡³å°‘å°è¯•)å¤åˆ¶å®ƒã€‚ç„¶è€Œï¼Œç”±äºæˆ‘çš„éšèº«å·¥å…·ä¸»è¦æ˜¯ R å’Œ Pythonï¼Œæ‰€ä»¥æˆ‘å†³å®šç”¨åè€…æ¥å®ç°å®ƒã€‚](https://github.com/jasonmayes/Real-Time-Person-Removal)

## ä½ éœ€è¦ä»€ä¹ˆ:

*   Python 3.x.x(æˆ‘ç”¨çš„æ˜¯ Python 3.7.4)
*   OpenCV(æˆ‘ä½¿ç”¨çš„æ˜¯ç‰ˆæœ¬ 4.1.2)

![](img/7b6d528f38eaf626806138c634878cd4.png)

æœ¬é¡¹ç›®ä¸­æè¿°çš„ä¸åŒé˜¶æ®µçš„åˆ†è§£ã€‚

## å¤´è„‘é£æš´:

åœ¨åšäº†ä¸€äº›å¤´è„‘é£æš´åï¼Œæˆ‘æ„è¯†åˆ°ï¼Œè¦ä»ç¨³å®šçš„å›¾åƒä¸­åˆ é™¤ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘å¾ˆå¯èƒ½éœ€è¦ä¸€ä¸ªé”šç‚¹ä½œä¸ºèµ·ç‚¹ï¼Œç„¶åå¤åˆ¶ç²˜è´´æ¯ä¸€å¸§ï¼Œå°±åƒä¸€ä¸ªé®ç½©ä¸€æ ·ï¼Œåº”ç”¨äºåŒ…å«ä¸€ä¸ªäººçš„æ¯ä¸€ä¸ªåç»­å¸§ã€‚

ç„¶åæˆ‘æƒ³ï¼Œå¦‚æœæˆ‘æœ‰æˆ‘æƒ³è¦éšè—çš„åŒºåŸŸçš„åæ ‡ï¼Œæˆ‘å¯ä»¥ç®€å•åœ°ä»é”šå¸§å¤åˆ¶å®ƒï¼Œå¹¶åœ¨æˆ‘æƒ³è¦éšè—å¯¹è±¡çš„å½“å‰å¸§ä¸Šæ›¿æ¢å®ƒã€‚

![](img/9e1b01d9ee160a036a109f0d7438bd34.png)

ä¸€ä¸ªæˆ‘è¢«æ£€æµ‹åˆ°çš„å¸§çš„ä¾‹å­ã€‚

è¦è§£å†³çš„ç¬¬äºŒä¸ªé—®é¢˜æ˜¯æ‰¾åˆ°ä¸€ç§æ–¹æ³•æ¥æ£€æµ‹æˆ‘æƒ³è¦ç§»é™¤çš„æ„Ÿå…´è¶£çš„å¯¹è±¡ã€‚å¹¸è¿çš„æ˜¯ï¼ŒOpenCV æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•:åŸºäºæ”¯æŒå‘é‡æœºçš„æ¢¯åº¦æ–¹å‘ç›´æ–¹å›¾æ£€æµ‹å™¨ã€‚è¿™æ˜¯ä¸€ä¸ªå¿…å»çš„äººæ¢æµ‹å™¨ï¼Œä¸æ˜¯æœ€å¿«çš„ï¼Œä¸æ˜¯æœ€å‡†ç¡®çš„ï¼Œä¹Ÿä¸æ˜¯æœ€å¥½çš„ï¼Œä½†å®ƒå°±æ˜¯å·¥ä½œã€‚

## å·¥ä½œæµç¨‹:

å› æ­¤ï¼Œåœ¨å¤´è„‘é£æš´ä¹‹åï¼Œæˆ‘å†³å®šåšæŒä»¥ä¸‹å·¥ä½œæµç¨‹:

*   å®ä¾‹åŒ–`HOGDescriptor`
*   è·å–è§†é¢‘çš„ç¬¬ä¸€å¸§ä»¥ç”¨ä½œé®ç½©
*   è¿­ä»£æ¯ä¸€å¸§ï¼Œå¯¹äºæ¯ä¸ªæ£€æµ‹åˆ°çš„äººï¼Œç”¨ç¬¬ä¸€å¸§ä¸­ç›¸åº”çš„â€œç©ºâ€åŒºåŸŸæ›¿æ¢è¯¥åŒºåŸŸ
*   ä¿å­˜è¾“å‡º

## ä»£ç :

æŒ‰ç…§ä¹‹å‰æè¿°çš„å·¥ä½œæµç¨‹ï¼Œæˆ‘åœ¨æˆ‘çš„ [GitHub åº“](https://github.com/robertosannazzaro/person-removal-detectron2)ä¸‹æ‰¾åˆ°äº†ä¸‹é¢çš„ä»£ç ã€‚

## æ¥æµ‹è¯•ä¸€ä¸‹å§ï¼

![](img/abab61d4bacb0700db8f4ee7cb86e956.png)

åƒè€æ¿ä¸€æ ·ã€‚æŠŠæ‰‹æ”¾åœ¨å£è¢‹é‡Œï¼Œç„¶åæ¶ˆå¤±ï¼

ç„¶è€Œï¼Œå¼•ç”¨åŸƒéš†Â·é©¬æ–¯å…‹çš„è¯:

> â€œä»æœ‰æ”¹è¿›çš„ç©ºé—´â€

![](img/b8fbca2f093f377e334726dd5a19b0c3.png)

å®é™…ä¸Šæ²¡æœ‰è¿™ä¹ˆç²¾ç¡®ï¼Œå°¤å…¶æ˜¯å½“æˆ‘é è¿‘é•œå¤´çš„æ—¶å€™ã€‚

æµ‹è¯•å®Œè¿™æ®µä»£ç åï¼Œæˆ‘æ„è¯†åˆ°æˆ‘å¯èƒ½æ˜¯åœ¨æ­£ç¡®çš„é“è·¯ä¸Šï¼Œä½†æ˜¯ï¼Œæ£€æµ‹ä¸å¤Ÿç²¾ç¡®ï¼Œæ•´ä¸ªè¾“å‡ºçœ‹èµ·æ¥æœ‰é—®é¢˜ä¸”ä¸ç¨³å®šã€‚

æ‰€ä»¥æˆ‘æ„è¯†åˆ°æˆ‘éœ€è¦æ‰¾åˆ°ä¸€ç§æ–¹æ³•æ¥æ”¹è¿›å®ƒ:ç”¨ç¬¬ä¸€å¸§æ›¿æ¢æ¯ä¸ªæ£€æµ‹åˆ°çš„äººä¼¼ä¹æ˜¯ä¸€ä¸ªå¥½æ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘å¯èƒ½éœ€è¦æ‰¾åˆ°ä¸€ç§æ›´å¥½çš„æ–¹æ³•æ¥æ£€æµ‹ç‰©ä½“ï¼Œ**ä¸€ä¸ªæ›´å¥½çš„æ¨¡å‹ï¼**

æˆ‘è®°å¾—ä¸ä¹…å‰æˆ‘å†™äº†ä¸€ç¯‡[ç®€çŸ­æŒ‡å—](/a-beginners-guide-to-object-detection-and-computer-vision-with-facebook-s-detectron2-700b6273390e)å…³äºå¦‚ä½•å¼€å§‹ä½¿ç”¨è„¸ä¹¦çš„ Detectron2 æ¨¡å‹ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸å®ç°å®ƒè€Œä¸æ˜¯ HOG æ£€æµ‹å™¨å‘¢ï¼Ÿ

## æ”¹è¿›ä¹‹å¤„:

åœ¨ [COCO çš„æ¨¡å‹åŠ¨ç‰©å›­](https://github.com/facebookresearch/detectron2/tree/master/configs/COCO-InstanceSegmentation)ä¸Šæœç´¢æˆ‘å‘ç°äº†ä¸€ä¸ªå®ä¾‹åˆ†å‰²æ¨¡å‹ï¼Œæ¯å¼ å›¾ç‰‡çš„æ¨ç†æ—¶é—´ä¸º 0.07 ç§’ï¼Œè¿™æ˜¯æœ€å¿«çš„å¯ç”¨æ¨¡å‹ä¹‹ä¸€(å¯èƒ½ä¸æ˜¯æœ€å‡†ç¡®çš„)ã€‚ç„¶åæˆ‘å†³å®šä½¿ç”¨å®ƒã€‚

è¦åœ¨æˆ‘çš„ç®¡é“ä¸­æ’å…¥ä¸€ä¸ªå®šåˆ¶æ¨¡å‹ï¼Œå¿…é¡»å®‰è£…æ‰€æœ‰å¿…éœ€çš„ä¾èµ–é¡¹ï¼Œå¦‚`pytorch`ã€`torchvision`å’Œ`detectron2`:

```
# install dependencies:!pip install -U torch==1.4+cu100 torchvision==0.5+cu100 -f [https://download.pytorch.org/whl/torch_stable.html](https://download.pytorch.org/whl/torch_stable.html)!pip install cython pyyaml==5.1!pip install -U â€˜git+https://github.com/cocodataset/cocoapi.git#subdirectory=PythonAPI'import torch, torchvision
```

ä»¥ä¸‹ä»£ç å’ŒæŒ‡ä»¤æ˜¯åœ¨ Google Colab å®ä¾‹ä¸Šæµ‹è¯•çš„ï¼Œåšå‡ºè¿™ä¸€é€‰æ‹©æ˜¯ä¸ºäº†è®©è¿™ä¸ªå®éªŒæ›´å®¹æ˜“å¤åˆ¶ï¼Œè€Œä¸ä¼šæœ‰ç¼ºå°‘ä¾èµ–ã€ç‰ˆæœ¬å†²çªå’Œæ‰€æœ‰ç»å¸¸å‘ç”Ÿçš„æ— èŠäº‹æƒ…ã€‚

ç„¶åæˆ‘ä»¬éœ€è¦å®‰è£…æ£€æµ‹å™¨ 2:

```
# install detectron2:!git clone [https://github.com/facebookresearch/detectron2](https://github.com/facebookresearch/detectron2) detectron2_repo!pip install -e detectron2_repo
```

ç°åœ¨æˆ‘ä»¬å¯ä»¥å¯¼å…¥æ‰€æœ‰éœ€è¦çš„åº“å¹¶åŠ è½½æ¨¡å‹(å®Œæ•´ä»£ç è¯·å‚è€ƒ [Google Colab ç¬”è®°æœ¬](https://colab.research.google.com/drive/12cFu78sYG6Hl-kpmSEI3axuw4KhUe_RY)æˆ– [GitHub repo](https://github.com/robertosannazzaro/person-removal-detectron2) ):

```
cfg = get_cfg()cfg.merge_from_file(model_zoo.get_config_file(â€œCOCO-InstanceSegmentation/mask_rcnn_R_50_DC5_1x.yamlâ€))cfg.MODEL.ROI_HEADS.SCORE_THRESH_TEST = 0.5 # set threshold for this modelcfg.MODEL.WEIGHTS = model_zoo.get_checkpoint_url(â€œCOCO-InstanceSegmentation/mask_rcnn_R_50_DC5_1x.yamlâ€)predictor = DefaultPredictor(cfg)
```

ä¸å¯èƒ½ä½¿ç”¨æˆ‘ä»¬çš„`predictor`æ¥æ¨æ–­ç±»ï¼Œ`predictor`è¿”å›ä¸€ä¸ªéœ€è¦è½¬æ¢æˆ`numpy`æ•°ç»„çš„å¼ é‡æ•°ç»„ï¼Œç„¶åå¯ä»¥åƒæˆ‘ä¹‹å‰åšçš„ä¸€æ ·è¿­ä»£å®ƒ:

```
outputs = predictor(frame)outputs = outputs[â€œinstancesâ€].pred_boxes
.to(â€˜cpuâ€™)
.tensor
.numpy()
.astype(int)
```

è®©æˆ‘ä»¬æ¥çœ‹çœ‹æœ€ç»ˆç»“æœ:

![](img/327ca150406f7bca797c61edb60e32b2.png)

æ¢æµ‹å™¨ 2 ä¸å…¨æ¯æ¢æµ‹å™¨

ä» gif ä¸­å¯ä»¥è§‚å¯Ÿåˆ° Detectron2 å¦‚ä½•æ›´å‡†ç¡®åœ°æ£€æµ‹åˆ°ä¸€ä¸ªäººï¼Œç„¶è€Œï¼Œéœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œå½“ç„¶ï¼Œå®ƒéœ€è¦ä¸€äº›æ›´â€œæ·±å…¥â€çš„é…ç½®(ä¾èµ–å…³ç³»æœ‰æ—¶æ˜¯ä¸€ç§æ–—äº‰)ã€‚ä½†æ˜¯ï¼Œæœ€åçš„ç»“æœè‡ªå·±è¯´è¯ï¼

## å‡ ä¸ªæœ€åçš„è€ƒè™‘:

å°½ç®¡æœ€ç»ˆè·å¾—çš„ç»“æœç›¸å½“ä»¤äººæƒŠè®¶ï¼Œä½†æ€»æœ‰æ”¹è¿›çš„ä½™åœ°ã€‚ä»”ç»†è§‚å¯Ÿæˆ‘èº«åçš„æ»‘é›ªè€…ï¼Œå¯ä»¥å‘ç°å½“æˆ‘ä»ä»–ä»¬é¢å‰ç»è¿‡æ—¶ï¼Œé¢å…·ä½¿ä»–ä»¬è‡ªå·±æ¶ˆå¤±äº†(è¿™ç§ç°è±¡è¢«ç§°ä¸ºé®æŒ¡)ã€‚æ­¤å¤–ï¼Œå½“å‰å¸§ä¸Šçš„â€œåˆ‡å‰²â€çŸ©å½¢ä¹‹é—´çš„æ’å€¼éå¸¸æ˜æ˜¾ã€‚ä¸ºäº†è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œèƒ½å¤Ÿæ‰§è¡Œ[å…¨æ™¯åˆ†å‰²](https://github.com/facebookresearch/detectron2)çš„æ¨¡å‹å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚

## æœ€åçš„å¯¹æ¯”è§†é¢‘:

```
**I have a newsletter ğŸ“©.**Every week Iâ€™ll send you a brief findings of articles, links, tutorials, and cool things that caught my attention. If tis sounds cool to you subscribe.*That means* ***a lot*** *for me.*
```

 [## ç±³å°”æ–¯å½¢å¼

### ç¼–è¾‘æè¿°

æ— æƒ…-åˆ›é€ è€…-2481.ck.page](https://relentless-creator-2481.ck.page/68d9def351)