<html>
<head>
<title>Using Machine Learning to Predict Fantasy Football Points</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用机器学习预测梦幻足球积分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-machine-learning-to-predict-fantasy-football-points-72f77cb0678a?source=collection_archive---------16-----------------------#2020-06-22">https://towardsdatascience.com/using-machine-learning-to-predict-fantasy-football-points-72f77cb0678a?source=collection_archive---------16-----------------------#2020-06-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/2d2b0ac021ead523db5fbd058ec06e2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*32JRz8NDoi-aSZkAYWsAOw.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="f5f3" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">一个幻想足球贸易分析仪使用RNN LSTM，ARIMA，XGBoost和破折号</h2></div><p id="b4dd" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">NFL梦幻足球是一种游戏，其中足球迷扮演职业足球队的教练或总经理的角色。参与者起草他们的初始球队，选择每周比赛的球员，并交易球员，以便在一个赛季中每周与其他球队比赛。获胜队是由职业运动员的真实统计数据决定的。</p><h2 id="f962" class="lp lq je bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated"><strong class="ak">交易分析器的目标</strong></h2><p id="7d73" class="pw-post-body-paragraph kt ku je kv b kw mi kf ky kz mj ki lb lc mk le lf lg ml li lj lk mm lm ln lo im bi translated">交易分析器的目标是确定在2019年足球赛季的任何一周，一名或多名球员的拟议交易是“好”还是“坏”交易。一笔好的交易被定义为用你队中的一名球员交换一名有着更高期望的梦幻足球分数的球员。因此，目标是确定2019赛季每个星期每个职业足球运动员的预期梦幻足球积分。然后可以在玩家之间比较期望的分数。</p><p id="2549" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><a class="ae mn" href="https://nfl-trade.herokuapp.com" rel="noopener ugc nofollow" target="_blank">点击这里看2019 NFL奇幻足球交易分析</a></p><h2 id="fa86" class="lp lq je bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated"><strong class="ak">积分制</strong></h2><p id="4f56" class="pw-post-body-paragraph kt ku je kv b kw mi kf ky kz mj ki lb lc mk le lf lg ml li lj lk mm lm ln lo im bi translated">交易分析器使用ESPN标准联盟规则来确定梦幻足球点数。一支球队由7个位置的9名先发球员组成。这7个位置是四分卫(QB)，跑卫(RB)，外接员(WR)，紧逼端(TE)，踢球者(K)和团队防守(DF)。在虚拟足球中，一支球队的防守阵容被认为是一个“球员”。</p><figure class="mp mq mr ms gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mo"><img src="../Images/ae56aad67b29c21e56e51fc8978b1950.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lUoEo-9LC0vJvIWwLAOfTw.png"/></div></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">积分制</p></figure><h2 id="475d" class="lp lq je bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated"><strong class="ak">数据</strong></h2><p id="0411" class="pw-post-body-paragraph kt ku je kv b kw mi kf ky kz mj ki lb lc mk le lf lg ml li lj lk mm lm ln lo im bi translated">用于建模的数据来自<a class="ae mn" href="https://www.armchairanalysis.com/" rel="noopener ugc nofollow" target="_blank"> <em class="mx">、ArmchairAnalysis.com</em></a>。该数据由28个不同的excel表格中的700多个数据点组成，提供了自2000年以来NFL中每个球员的20年详细统计数据。</p><p id="0b9d" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">原始数据最初在Excel中进行处理，以便链接和提取所有2019年NFL球员的相关数据。经过处理的数据构成了初始建模数据的基础。根据初始建模数据，为每个2019年球员的每个赛季的每场比赛计算实际的梦幻足球积分。模型的训练数据使用了截至2018赛季每个球员的所有可用数据，2019年的数据用作测试数据。例如，如果一名球员在2014年开始职业生涯，那么2014-2018年的数据用于训练数据，2019年的数据用于测试数据。</p><h2 id="e509" class="lp lq je bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated"><strong class="ak">建模</strong></h2><p id="b8a1" class="pw-post-body-paragraph kt ku je kv b kw mi kf ky kz mj ki lb lc mk le lf lg ml li lj lk mm lm ln lo im bi translated">共有四个模型被用于预测653名2019年NFL球员的预期梦幻足球积分。这些数据本质上是时间序列数据，玩家拥有0到20年(20个赛季x 16场比赛= 320个数据点)的数据。</p><p id="6b6e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">平均值:</strong>使用每个2019年球员的平均值建立基线测量。第一周的平均值是使用2018赛季球员(不包括新秀)的平均每场比赛分数建立的。第2周到第17周是使用他们前几周实际绩效的平均值计算的(例如，第2周使用第1周的实际绩效，第3周使用第1周和第2周实际绩效的平均值，等等)。).这将被认为是天真的方法，也是普通的梦幻足球参与者经常使用的方法。</p><p id="a8e2" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf"> XGBoost: </strong>一个XGBoost模型被用来预测2019赛季第一周新秀球员的表现。2019年的106名新秀很难预测，因为他们没有专业经验。使用515名非新秀球员(不包括防守)的新秀年统计数据作为训练数据，计算2019赛季第1周预期幻想点数，验证MAE为28.93，R平方为0.49，测试MAE为30.75，R平方为0.43。这些是微弱的结果，但需要一个起点。第2周到第17周是使用他们前几周实际绩效的平均值计算的，与基线相同(例如，第2周使用第1周的实际绩效，第3周使用第1周和第2周实际绩效的平均值，等等。).</p><p id="153b" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">ARIMA:</strong>ARIMA模型最初用于预测2019赛季每周的老将表现。只有经验超过3年且在这3年中至少获得50分的资深玩家才使用ARIMA运行，因为模型需要大约50个数据点(3个赛季x 16场比赛= 48个数据点)才能表现良好。使用ARIMA对大约246名资深玩家进行建模，虽然结果非常好(参见评估选项卡)并且超过了基线，但神经网络模型显示出更好的结果。</p><p id="6e93" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">递归神经网络，长短期记忆(RNN-LSTM):</strong>RNN-LSTM模型用于预测2019赛季每周的老将表现。只有拥有3年以上经验和3年内至少50分的资深球员才使用RNN-LSTM进行比赛，因为该模型需要尽可能多的数据，3年似乎是一个很好的平衡。大约246名经验丰富的球员使用RNN-LSTM模型，并将结果与ARIMA模型进行比较。RNN-LSTM模型优于基线平均值和ARIMA模型，是最终应用程序中使用的模型。</p><p id="019c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">备注:</strong></p><p id="680b" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">最终结果:</strong>最终结果综合了新秀成绩(XGBoost+平均— 106人)、3+年的老将(RNN-LSTM —包括防守在内278人)和剩下的有&lt; 3年经验的老将(平均— 269人)。这在“评估”选项卡中被称为“神经网络”模型，而“ARIMA”是对3年以上的退伍军人仅使用ARIMA的相同结果组合。</p><p id="1e30" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">每周预测:</strong>每个模型都计算本季度剩余几周的预测。然后将剩余的每一周相加，得出玩家期望的梦幻足球点数。例如，在第1周<br/>中，预期的梦幻足球分数是所有16场比赛预测(整个赛季)的总和，在第2周中，分数是剩余15场比赛的总和，等等。</p><p id="3734" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">再见周:</strong>一个足球赛季实际上有17周，每个球队在赛季中都有一个随机的再见周。在“再见周”,每个玩家前一周的预测都会被简单地继续下去。</p><p id="c22f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">伤病:</strong>伤病在梦幻足球中起着巨大的作用。当一名球员受伤时，他的分数基本上降到零。没有可靠的方法来预测运动员是否或何时会受伤。虽然原始数据确实提供了一些关于伤病的细节，但它仍然没有提供球员何时从伤病中恢复的良好信息。在所有的模型中，当一名球员处于受伤的预备队状态时，他被认为是缺席了整个赛季。</p><p id="2089" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">代码</strong></p><p id="ab2c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">该项目的所有代码、数据和相关文件都可以在我的GitHub repo中访问。自述文件提供了repo目录和文件的详细信息。</p><h2 id="5f62" class="lp lq je bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated"><strong class="ak">RNN-LSTM模型</strong></h2><p id="ee01" class="pw-post-body-paragraph kt ku je kv b kw mi kf ky kz mj ki lb lc mk le lf lg ml li lj lk mm lm ln lo im bi translated">虽然预测梦幻足球积分的完整代码相当复杂，但让我们以一名球员为例，仔细看看核心的RNN-LSTM代码。我们要用艾伦·罗杰斯，绿湾包装工队的四分卫。Aaron是一个优秀的测试案例，因为他在2005年开始了他的NFL职业生涯，提供了15年的数据。此外，他在2019赛季没有受到任何重大伤害。</p><p id="4712" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">每个2019 NFL球员的实际积分存储在<strong class="kv jf"> original_df </strong>数据帧中。数据帧的前五列包含每个玩家的描述性特征。接下来的320列包含每个球员从2000年到2019年每场比赛的实际梦幻足球积分(每个赛季16场x 20个赛季= 320个数据点)。这些值是NaN直到球员的第一个NFL赛季。所以Aaron Rodgers的实际数据直到第85栏才开始(16x 5 = 2005赛季前的80场比赛加上5个描述栏)。</p><figure class="mp mq mr ms gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi my"><img src="../Images/f0b3f3f107319baa9d9e12438a23b067.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dfrQRSWiFGXaLuIvSpbO9g.png"/></div></div><p class="mt mu gj gh gi mv mw bd b be z dk translated">原始_测向数据帧</p></figure><p id="241d" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">对RNN-LSTM预测函数<strong class="kv jf"> lstm_pred </strong>的初始调用发生在名为<strong class="kv jf"> main </strong>的函数中。该功能的输入包括:</p><p id="fd31" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">player</strong>=‘Aaron Rodgers’(这是玩家的名字)<br/> <strong class="kv jf"> n_periods </strong> = 16(在本例中，我们从赛季初开始，预测2019赛季的所有16场比赛)<br/> <strong class="kv jf"> col </strong> = 85 (Aaron的2005年数据从数据帧的第85列开始)</p><pre class="mp mq mr ms gt mz na nb nc aw nd bi"><span id="506e" class="lp lq je na b gy ne nf l ng nh">pred_points = lstm_pred(player, n_periods, col)</span></pre><p id="d097" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">利用这三个输入，让我们仔细看看lstm_pred。</p><pre class="mp mq mr ms gt mz na nb nc aw nd bi"><span id="278f" class="lp lq je na b gy ne nf l ng nh">def lstm_pred(p, np, c):<br/>    series = make_series(p, c)<br/>    X = series.values<br/>    supervised = timeseries_to_supervised(X, 1)<br/>    supervised_values = supervised.values<br/><br/>    # Split data into train and test-sets<br/>    train, test = supervised_values[0:-np], supervised_values[-np:]<br/><br/>    # Transform the scale of the data<br/>    scaler, train_scaled, test_scaled = scale(train, test)<br/><br/>    # Fit the model<br/>    lstm_model = fit_lstm(train_scaled, 1, 100, 1)<br/><br/>    # Forecast the entire training dataset to build up state<br/>    train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)<br/>    lstm_model.predict(train_reshaped, batch_size=1)<br/><br/>    # Walk-forward validation on the test data<br/>    yhat_sum = 0<br/>    for i in range(len(test_scaled)):<br/>        # Make one-step forecast<br/>        X, y = test_scaled[i, 0:-1], test_scaled[i, -1]<br/>        yhat = forecast_lstm(lstm_model, 1, X)<br/>        # Invert scaling<br/>        yhat = invert_scale(scaler, X, yhat)<br/>        # Sum the weekly forecasts<br/>        yhat_sum = yhat_sum + yhat<br/><br/>    return yhat_sum</span></pre><p id="4918" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">让我们浏览一下这段代码，以便更好地理解它是如何工作的。前四行只是为模型准备数据。</p><pre class="mp mq mr ms gt mz na nb nc aw nd bi"><span id="8cbd" class="lp lq je na b gy ne nf l ng nh">series = make_series(p, c)<br/>X = series.values<br/>supervised = timeseries_to_supervised(X, 1)<br/>supervised_values = supervised.values</span></pre><p id="b8bf" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">函数<strong class="kv jf"> make_series </strong>只是将Aaron从2005年到2019年存储在dataframe中的实际点数转换成一个python序列。然后，系列值存储在<strong class="kv jf"> X </strong>中。现在,<strong class="kv jf"> X </strong>值代表了Aaron的梦幻足球点数的时间序列。函数<strong class="kv jf"> timeseries_to_supervised(X，1) </strong>获取时间序列<strong class="kv jf"> X </strong>并创建一个包含<strong class="kv jf"> X </strong>我们的监督学习输入模式和<strong class="kv jf"> y </strong>我们的监督学习输出模式的数据帧。<strong class="kv jf"> y </strong>值只是将<strong class="kv jf"> X </strong>系列向后移动一个周期。然后将<strong class="kv jf"> X </strong>和<strong class="kv jf"> y </strong>值存储在numpy数组<strong class="kv jf"> supervised_values </strong>中。我们对这四行代码(及其功能)所做的是从原始_df数据帧中提取Aaron的fantasy football point production，并将其转换为监督学习的形式。代表2019赛季的s<strong class="kv jf">supervised _ values</strong>的尾端在下面。第一列代表<strong class="kv jf"> X </strong>值，第二列代表<strong class="kv jf"> y </strong>值。</p><pre class="mp mq mr ms gt mz na nb nc aw nd bi"><span id="04f3" class="lp lq je na b gy ne nf l ng nh">....<br/> [ 1.04 12.92]<br/> [12.92 14.36]<br/> [14.36 14.3 ]<br/> [14.3  25.48]<br/> [25.48  9.42]<br/> [ 9.42 18.32]<br/> [18.32 44.76]<br/> [44.76 28.1 ]<br/> [28.1  12.94]<br/> [12.94 10.02]<br/> [10.02  9.46]<br/> [ 9.46 28.12]<br/> [28.12 11.4 ]<br/> [11.4  14.42]<br/> [14.42  9.34]<br/> [ 9.34 19.02]]</span></pre><p id="2d33" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">下一行代码将<strong class="kv jf"> supervised_values </strong>拆分为<strong class="kv jf"> train </strong>和<strong class="kv jf"> test </strong>将最近16场比赛(2019赛季)拆分为测试集，并将2005-2018赛季作为训练集。</p><pre class="mp mq mr ms gt mz na nb nc aw nd bi"><span id="1207" class="lp lq je na b gy ne nf l ng nh">train, test = supervised_values[0:-np], supervised_values[-np:]</span></pre><p id="5453" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">一旦代码被拆分，使用<strong class="kv jf"> scale </strong>函数对数据进行标准化。scale函数使用范围为(-1，1)的MinMaxScaler。建议对数据进行规范化，因为这将使神经网络的学习更容易，并应确保值的大小或多或少相似。</p><pre class="mp mq mr ms gt mz na nb nc aw nd bi"><span id="3f43" class="lp lq je na b gy ne nf l ng nh">scaler, train_scaled, test_scaled = scale(train, test)</span></pre><p id="a033" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们现在准备通过函数<strong class="kv jf"> fit_lstm </strong>拟合RNN-LSTM模型，参数如下:<br/><strong class="kv jf">train:</strong>train _ scaled<br/><strong class="kv jf">batch _ size:</strong>1<br/><strong class="kv jf">nb _ epochs:</strong>100<br/><strong class="kv jf">神经元:</strong> 1</p><pre class="mp mq mr ms gt mz na nb nc aw nd bi"><span id="772c" class="lp lq je na b gy ne nf l ng nh">lstm_model = fit_lstm(train_scaled, 1, 100, 1)</span></pre><p id="e18f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">fit_lstm 函数是RNN-LSTM魔术发生的地方。简而言之，该函数使用一个连续的Keras API，包括一个LSTM层和一个密集层。使用的损失函数是具有“adam”优化算法的“均方误差”。该函数的实际机制相当复杂，对于那些希望获得进一步信息的人，请参见杰森·布朗利 的文章<a class="ae mn" href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" rel="noopener ugc nofollow" target="_blank"> <em class="mx">中的LSTM模型开发部分中关于该函数的详细描述。</em></a></p><p id="033c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">为了获得更好的结果，文章建议使用更大数量的历元(1000–4000)和神经元(1–5)，但是由于运行数百个玩家的预测需要时间和资源，100个历元和1个神经元以资源较少的方式提供了非常好的结果。</p><p id="9c4d" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们现在准备使用模型的<strong class="kv jf"> lstm_model.predict </strong>函数进行预测。</p><pre class="mp mq mr ms gt mz na nb nc aw nd bi"><span id="76ad" class="lp lq je na b gy ne nf l ng nh">train_reshaped = train_scaled[:, 0].reshape(len(train_scaled), 1, 1)<br/>lstm_model.predict(train_reshaped, batch_size=1)</span></pre><p id="aa95" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">该函数需要一个3D numpy数组作为输入，在我们的例子中，这将是一个一个值的数组(前一个时间步长的观测值),并输出一个一个值的2D numpy数组。在预测测试数据之前，我们需要通过预测训练数据中的所有值来播种初始状态。上面代码的第一行将数据重新整形为单值3D numpy数组，第二行使用训练数据设置网络的初始状态。</p><p id="5020" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们所剩下的就是逐步通过测试数据，对16场比赛进行单独的预测，并反转比例以得出最终的单独预测。然后将个人预测相加，以创建亚伦2019赛季的预测幻想足球积分。</p><pre class="mp mq mr ms gt mz na nb nc aw nd bi"><span id="c347" class="lp lq je na b gy ne nf l ng nh">yhat_sum = 0<br/>for i in range(len(test_scaled)):<br/>    # Make one-step forecast<br/>    X, y = test_scaled[i, 0:-1], test_scaled[i, -1]<br/>    yhat = forecast_lstm(lstm_model, 1, X)<br/>    # Invert scaling<br/>    yhat = invert_scale(scaler, X, yhat)<br/>    # Sum the weekly forecasts<br/>    yhat_sum = yhat_sum + yhat</span></pre><p id="d107" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">亚伦罗杰斯赛季的预测结果如下。本赛季的总预测是293分(四舍五入)，他的实际得分是282分——本赛季4%的误差还不错！(每次运行代码时，结果会略有不同)</p><pre class="mp mq mr ms gt mz na nb nc aw nd bi"><span id="3456" class="lp lq je na b gy ne nf l ng nh">yhat =  13.550041856765747<br/>yhat =  15.615552995204924<br/>yhat =  17.195858060121534<br/>yhat =  18.015674024820328<br/>yhat =  20.544238206744193<br/>yhat =  18.375679302811623<br/>yhat =  19.83470756918192<br/>yhat =  18.937192922234534<br/>yhat =  21.3260236287117<br/>yhat =  20.56778145074844<br/>yhat =  18.166402292251586<br/>yhat =  16.316439254283903<br/>yhat =  19.98121999800205<br/>yhat =  18.90507374048233<br/>yhat =  18.95989200234413<br/>yhat =  16.812043523192404<br/><br/>yhat_sum =  293.10382082790136</span></pre><h2 id="6f66" class="lp lq je bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">对模型预测的评估</h2><p id="9184" class="pw-post-body-paragraph kt ku je kv b kw mi kf ky kz mj ki lb lc mk le lf lg ml li lj lk mm lm ln lo im bi translated">递归神经网络— LSTM模型(NN)优于基线平均值和ARIMA模型。虽然NN和ARIMA模型都具有较低的MAEs，但它们都在赛季中途开始收敛，因为所有模型都包含当前赛季的实际点，并且未来预测的数量减少，从而增加了所有模型的准确性。</p><p id="c141" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">模型的真实准确性显示在<em class="mx">正确预测百分比</em>图中。每个星期，每个玩家的“好”或“坏”交易的预测结果都要与其他玩家的交易结果进行比较，并与实际结果进行比较。神经网络显然比其他模型做出了更好的预测，2019赛季的总体平均正确率为85.59%，而ARIMA模型为84.72%，基线平均模型为83.17%。</p><figure class="mp mq mr ms gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ni"><img src="../Images/c97c175865447c24e021c117d515928b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QiAhao4SVqkt-xW_OQlClQ.png"/></div></div></figure><figure class="mp mq mr ms gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ni"><img src="../Images/fc21d8f9d11638b1fdc5fe4101cc4642.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7MVE4Z5ZXOaA7ENFIF016w.png"/></div></div></figure><h2 id="825b" class="lp lq je bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated"><strong class="ak">Dash App</strong></h2><p id="f225" class="pw-post-body-paragraph kt ku je kv b kw mi kf ky kz mj ki lb lc mk le lf lg ml li lj lk mm lm ln lo im bi translated">由于本文侧重于该项目的机器学习方面，Dash应用程序的细节将不被涵盖。有关创建Dash应用程序的详细信息，请参见我的文章<a class="ae mn" rel="noopener" target="_blank" href="/how-to-create-an-interactive-dash-web-application-11ea210aa6d9"> <em class="mx">如何创建交互式Dash Web应用程序</em> </a>。</p><p id="6147" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我欢迎建设性的批评和反馈，请随时给我发私信。</p><p id="8647" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在推特上关注我</p><p id="2beb" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这篇文章最初出现在我的GitHub Pages网站上</p><p id="f6e6" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">梦幻足球原始数据来源:<em class="mx"/><a class="ae mn" href="https://www.armchairanalysis.com/" rel="noopener ugc nofollow" target="_blank"><em class="mx">ArmchairAnalysis.com</em></a><br/>RNN-LSTM模型开发:<em class="mx"> </em> <a class="ae mn" href="https://machinelearningmastery.com/time-series-forecasting-long-short-term-memory-network-python/" rel="noopener ugc nofollow" target="_blank"> <em class="mx">用Python中的长短期记忆网络进行时间序列预测作者:杰森·布朗利</em> </a> <em class="mx"> <br/> </em>图片来源:<em class="mx"> Pixabay </em></p></div></div>    
</body>
</html>