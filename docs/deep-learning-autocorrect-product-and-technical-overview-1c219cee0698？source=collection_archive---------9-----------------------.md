# 深度学习:自动更正，短词拼写检查

> 原文：<https://towardsdatascience.com/deep-learning-autocorrect-product-and-technical-overview-1c219cee0698?source=collection_archive---------9----------------------->

## 使用最先进的神经网络纠正专有名词等生僻字的拼写。本文讨论网络的抽象概念、实现和结果。

![](img/7f15f43159b69f58d7c190f7d6151778.png)

由[比斯瓦帕蒂·阿查里亚](https://unsplash.com/@bisnaps?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄

这是一张纽约市天际线的美丽图片，为什么我会把它放在一篇神经网络文章上？也许我现在更欣赏外在的美了，因为我从 2 月 15 日开始隔离自己(76 天，还在继续)。是的，已经两个多月了！！！在周五午夜 2:45 打出一篇文章会出什么问题。我们会找到答案的。

我已经在 [***Reorg***](https://reorg.com/) 工作了一年多，这太不可思议了。Reorg 是在金融部门，提供破产相关的新闻和不良债务公司的分析。没错，当有人濒临破产时，我们会赚钱，这听起来很邪恶，但相信我，不是的。Reorg 有一个网站，用户可以通过这个网站获得对不良债务公司的最新分析。为了找到他们感兴趣的公司，我们为他们提供了一个搜索栏，搜索一个拥有超过一百万家公司的数据库。那么什么会出错呢？有一个问题，都是专有名词(公司名称)，所以你必须在搜索栏中正确获取确切的名称。

不幸的是，我们人类生来就会犯错。**解决方案？**机器人来救援了。* *用机器人语言尖叫* *

# **视觉:**

我在这里的愿景是实现类似于谷歌提供的东西，即在 ***下显示*** 或***的结果，你的意思是。***

我们为什么要这么做？让用户参与我们的网站。想象一下，如果每次你输入一个错误，谷歌从来没有显示任何结果，直到你真正输入正确的拼写。这个世界会有多糟糕？

以下是“深度学习”的搜索结果，其中有故意出现的错误。

![](img/174e6d999b374e34c454a2702d30df5d.png)![](img/16cb261c2a3a9ed8b2b4a8f87e9a739e.png)

资料来源:google.com

人们会注意到这两个结果有所不同。当它显示'**显示'**的结果时，Google 对您正在寻找的内容非常有信心，因此会向您显示预测关键字的搜索结果。另一方面，当它显示“**你是指**吗”的结果时，它的信心下降，并要求你(用户)帮助验证你实际上在找什么。尽管如此，他们仍然显示他们认为与搜索框中输入的词密切相关的网站链接。

*如果您只对模型结果感兴趣，请一直向下滚动到 AI in action*[](#4098)**。**

*![](img/0bda22bdd59ff5728176a8772599f8c2.png)*

*由 [Samrat Khadka](https://unsplash.com/@samrat_khadka?utm_source=medium&utm_medium=referral) 在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片*

*我的天啊，我是如此想念你！:(好了，我说够了莎士比亚。回到最酷的话题！*

# ***网络:***

*我们将使用一个**序列对机器神经传输网络中常用的**翻译器进行排序。这也会有一个**注意**机制和利用**老师强迫**学习。为此，你需要对 RNN 氏症和 GRU 氏症有基本的了解。我将简要描述这个网络，以及我如何使用我现有的数据库作为训练数据集。*

*总的来说，就是把源序列' **X'** 转换成某个目标序列 **'Y'** 其中， **X = x₁ + x₂ + …。+ xᵣ，
Y = y₁ + y₂ + …+ yₐ***

*通常，这项工作是通过创建我们的源序列' **X '的表示来完成的。**我们将对目标序列' **Y '中下一个目标单词/字符的条件概率进行建模。***

****为什么序列要序列模式？****

*抽象的思想是把一个给定的输入，即一个源序列转换成一个 N 维的上下文向量，它将体现输入的“意义”。这个向量然后被馈送到解码器，解码器将把输入“翻译”成所需的输出。*

****为什么有注意机制？等等，注意机制是什么？****

*分离编码器和解码器的上下文向量保存/总结了来自源序列的大部分输入信息。“预计”这将是输入的一个很好的总结，以便解码器开始产生良好的模型结果。注意力机制背后的思想是重新训练上下文向量，并发现哪些状态将被证明对解码器有用。如果没有注意机制，通常初始和中间状态不会被重视，很容易被遗忘，从而导致网络忘记序列的早期部分。为了更好地理解它，我建议阅读这些文章[这里](/intuitive-understanding-of-attention-mechanism-in-deep-learning-6c9482aecf4f)和[这里](https://blog.floydhub.com/attention-mechanism/)。*

# ***输入:***

*问题定义是独特的，不同于其他定义。我们的数据库由超过 100 万个公司名称的列表组成，这些名称都是专有名词，即它们都是公司名称，任何用户都可以搜索。让我们采用数据科学的方法来减少这个数字，并朝着实现我们的目标迈出一小步。不是每个人都会搜索所有的公司，他们会对一些正在或即将成为趋势的公司感兴趣。此外，我们有搜索历史记录，这有助于我们分析人们关注的领域以及他们最感兴趣的行业。这将消除很多噪音，并大大减少我们的公司范围。*

*在其他时间，这是一个数据科学项目，但现在我们将使用一组特殊的公司，我们可以合理地假设人们对搜索感兴趣。这涵盖了 2500 多家公司，这将是我们的训练数据集。*

***训练数据:***

*魔术来了！从我们想要预测的单词列表中，我们创建自己的输入和输出。我们在列表中归纳拼写错误，不是任何随机的拼写错误，而是关键字彼此接近。例如，如果我们有一个名为“***”Linkedin.com***的公司，我们创建一个带有拼写错误***“lonkwdin . com”的训练输入。那么这些错误有什么特别之处呢？我把字母 I 和 e 分别换成了 s 和 o。这些字母不是随意挑选的。看看你的键盘，最有可能拼错字母“I”的是“u”、“j”、“k”、“l”&“o”。我们选择这些字母中的任何一个，并在输入中替换它。字母 e 也是如此。现在我们引入一些变量，以便网络学习这些错误并预测输出。****

*![](img/8cdc4db3333cebae5290344a18172075.png)*

*我在增强的输入中创建了 24 个错误，并将其映射到实际的预测输出。我还添加了一个没有错误的，这样网络应该知道，当有人输入完全正确，我们仍然显示他们预期的结果。请记住，网络的目标是以概括的方式学习这些错误，以便一旦有人在训练/测试集中犯了拼写错误，我们仍然能够预测它。*

*然后，这种增强/模拟在所有公司中运行，产生了 78，000 个数据点。这些数据被分成 60-20-20 份，用于训练、验证和测试数据集。*

## *回到网络:*

*这里网络的目标是在给定增广值的情况下预测实际值。我们在这里必须随机应变如何使用神经机器翻译模型。这种模型广泛用于翻译语言，这些语言有大量的单词(专有名词除外)，这些单词的频率足以让模型理解何时、何地以及如何使用它们。不幸的是，这个案例不一样。*为什么？因为每当我们在数据集中介绍一家新公司时，我们的词汇量就会增加。*这显然是不可扩展的，因为我们不能总是修改网络的输入来考虑这些单词并从头重新训练它。保持输入索引不变的一种方法是使用字符。这样，无论发生什么，我们的词汇长度都保持不变。我们总共取 52 个字符，包括字母、数字和特殊符号，将每个字符映射为‘a’->2、‘b’->3、‘c’->4 等等。通过这样做，不管有什么新公司进来，它都将在这个 52 个字符的词汇表中。这允许我们从先前离开的地方训练模型。另一方面，如果我们必须引入一个新单词，我们的初始映射索引将每次增加 1。这将要求网络每次从头开始重新学习一组新的数字，这是不可扩展的。*

```
*"<>abcdefghijklmnopqrstuvwxyz &()+/.,;'?!-@0123456789"*
```

*前两个字符''将在解码器中用作' **SOS** '(字符串开始)和' **EOS** '(字符串结束)，以告诉解码器字符串何时开始和结束。为什么这是必要的？因为即使在抛出一个 EOS 标记后，它也会继续一个接一个地预测字符。这是一个提示，让我们知道预测到此结束。*

*很好，现在我们已经确定了我们的输入是什么样子，输出是实际的公司名称。我们开始训练网络，并在它过度适应之前停止。*

*![](img/2f293ea6f121c5cc2e3c67c61ef8dadf.png)*

# *结果:*

*该模型达到了 87.1%的准确率，与目前 89-90%的准确率相比，还算不错。准确性差异的原因仅仅是因为我的数据集是专有名词，即不会重复的单词。这大大增加了问题的复杂性，从而降低了准确性。*

*我认为改善这一点的一个方法是对数据集做更多的预处理，使模型更容易预测，从而提高准确性。*

# ***AI 在行动:***

*Reorg 最近一直在撰写关于冠状病毒影响的文章，所有相关文章都以“冠状病毒影响”为名。下面我用一些可能的错误组合创建了一个 gif。*

*![](img/33e51f7586c295cc2327855b96d779cd.png)*

*当有人在我们搜索栏中搜索“冠状病毒影响”并点击回车时，可能会出现这些错误。这张 gif 显示了即使在诱发了许多错误之后，模型仍然做得很好。*

**橙色的字母是用户的输入，下面的输出是自动完成预测。**

*这是“Bharti Airtel”公司的另一个例子。在完全删除第二个单词并在第一个单词中引入 2 个错误后，它仍然预测正确的结果*

*![](img/7ef615575a1c2a73dcbe7b72f624480b.png)*

*另一件需要指出的事情是，这个模型是绝对疯狂的。模型训练时，输入长度和输出长度不必保持不变。对于任何其他数据点，它们可以不同。现在试着想一想其他能做到这一点的模型。想不出很多，是吧？**心智成熟***