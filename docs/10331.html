<html>
<head>
<title>How to clean up messy data?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何清理杂乱的数据？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-clean-up-messy-data-9a8376475c67?source=collection_archive---------59-----------------------#2020-07-20">https://towardsdatascience.com/how-to-clean-up-messy-data-9a8376475c67?source=collection_archive---------59-----------------------#2020-07-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/7ede0643f1b2ac370e959d4217e63a28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tIZCqlp5_UUoF65Z2lOXVg.png"/></div></div></figure><div class=""/><div class=""><h2 id="032e" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">使用 OpenRefine</h2></div><figure class="ku kv kw kx gt iv gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/d9d9f0c9548dcd6b0a81dcf4725b53a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:192/format:webp/1*IbN4AUtmaZVbs5NTpZVMJg.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">图片来源:<a class="ae lc" href="https://www.linkedin.com/posts/keith-mcnulty_datascientists-datascience-rstats-activity-6686524168160219136-Lxeb" rel="noopener ugc nofollow" target="_blank">基思·麦纽提</a></p></figure><p id="1cf6" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我在 Linkedin 上看到一个帖子，提到了一个数据集，其中城市<strong class="lf jf">费城的拼写是 57(！)不同的方式</strong>，并询问数据科学家对处理数据质量问题的看法。来自同一个宾夕法尼亚州的 57 种亨氏酱有什么联系吗？:-)</p><p id="3433" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我看到另外两个<a class="ae lc" href="https://twitter.com/dataeditor/status/1280278987797942272?s=21" rel="noopener ugc nofollow" target="_blank">的帖子</a>也在讨论这个问题，评论从收集这些数据的应用程序应该有更好的验证到人们应该学习如何拼写。嗯，有时候在数据科学家/数据工程师的工作中，你确实会遇到这样的数据质量问题，你只需要处理它。也许您可以实现更好的控制，以便在将来获得更好的数据，但是如果您想要使用已经收集的数据，就必须对其进行清理。在这篇文章中，我将展示如何用免费数据辩论工具 open refine 解决这个问题。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h2 id="4d29" class="mg mh je bd mi mj mk dn ml mm mn dp mo lm mp mq mr lq ms mt mu lu mv mw mx my bi translated">OpenRefine</h2><p id="8c2a" class="pw-post-body-paragraph ld le je lf b lg mz kf li lj na ki ll lm nb lo lp lq nc ls lt lu nd lw lx ly im bi translated">OpenRefine(原名 Google Refine)是一个强大的工具，无需任何编码就可以轻松转换数据。而如果你是程序员，你可以使用 GREL(Google Refine Expression Language，类似于 Excel 公式)来做一些复杂的数据转换。这个工具有趣的一面是，它是免费的、开源的，可以本地安装在你的笔记本电脑上，所有的数据处理都在本地完成。<strong class="lf jf">数据永远不会离开你的电脑</strong>。我在数据迁移项目中使用过 OpenRefine，遗留应用程序有包含地址、姓名等的自由文本字段，需要在迁移到目标系统之前进行标准化和转换，它工作得非常好。</p><h2 id="726c" class="mg mh je bd mi mj mk dn ml mm mn dp mo lm mp mq mr lq ms mt mu lu mv mw mx my bi translated">我们可以在哪里使用 OpenRefine？</h2><figure class="ku kv kw kx gt iv gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/73fdcb01b9d4cc6f6d25eddd52a9c21e.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*w2f4j3uTEZLtQXX3sYH4SQ.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">混乱文本的例子</p></figure><p id="2821" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">当我们有杂乱的文本数据时，就像在这个例子中一样(顶部条目是正确的)，同一个单词拼写错误，大小写字符混合，有些有前导或尾随空格，空白字符，扩展西文字符，名字和姓氏顺序混淆，日期以不同的方式书写，我们可以使用 Open Refine 来清理它。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="19fd" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jf">PPP 数据集上的 open refine</strong></p><ul class=""><li id="b1a3" class="nf ng je lf b lg lh lj lk lm nh lq ni lu nj ly nk nl nm nn bi translated">数据集:数据来自美国的 PPP(工资保障计划),包含新冠肺炎危机期间小企业贷款的数据。让我们以宾夕法尼亚州的<a class="ae lc" href="https://www.sba.gov/funding-programs/loans/coronavirus-relief-options/paycheck-protection-program?utm_medium=email&amp;utm_source=govdelivery#section-header-11" rel="noopener ugc nofollow" target="_blank">数据集为例，获取 15 万美元以下的贷款。</a></li><li id="6847" class="nf ng je lf b lg no lj np lm nq lq nr lu ns ly nk nl nm nn bi translated">OpenRefine:下载<a class="ae lc" href="https://openrefine.org/download.html" rel="noopener ugc nofollow" target="_blank"> OpenRefine v3.3 </a>。安装完成后，运行 OpenRefine.exe 文件，这将在浏览器中打开一个指向 127.0.0.1:3333 的窗口。</li></ul><p id="f8ac" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jf">创建一个项目</strong> <br/>该工具会打开一个选项来创建一个项目。我们可以从不同的文件格式(JSON、CSV、固定宽度等)和来源(本地计算机和直接从网络)导入数据。</p><figure class="ku kv kw kx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nt"><img src="../Images/3c5e4ff220dc363244e4567bc35a8bfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L2UkCFvNWU3ZnY9rY7FOHg.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">创建项目-加载数据</p></figure><p id="1b95" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">OpenRefine 读入文件内容，尝试自动识别不同的列和标题，并显示预览。如果需要，我们可以修改设置。一旦我们对预览感到满意，我们可以点击“创建项目”。</p><figure class="ku kv kw kx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nu"><img src="../Images/12965332db652e4abaf619b2a7441e42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fa1d_MlTx7df2VTzRQjoUA.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">文件解析选项</p></figure><p id="1db9" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">OpenRefine 然后加载数据并显示一个类似于电子表格的视图。我们可以单击列顶部的向下箭头，查看我们可以对数据进行的各种数据转换。</p><figure class="ku kv kw kx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nv"><img src="../Images/ba8c2d86f4a670eea760736541cf8dd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EY3Xv6qPBqUlPKXFGN0rGg.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">数据被加载到项目中</p></figure><p id="2e6d" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">让我们来看看列城。我们有兴趣看到费城拼写错误的条目。为了方便地查看分布情况，我们可以过滤以 ph 开头的行(假设至少前两个字符拼写正确:-))。我们可以使用正则表达式'^ph'.字符'^'确保只显示以 ph 开头的城市。这并不是绝对必要的，但是这有助于限制我们在 facet 窗口中容易看到的条目的变化。</p><div class="ku kv kw kx gt ab cb"><figure class="nw iv nx ny nz oa ob paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><img src="../Images/21824536233f36ad30d32696411b6281.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*r5rSsW7PUWPwOz9hTy9M7Q.png"/></div></figure><figure class="nw iv oc ny nz oa ob paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><img src="../Images/4346ad551a97b705d4a4ad9af28572a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*YgJ1lbHDFHukePoDzgJhAw.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk od di oe of translated">文本过滤器</p></figure></div><p id="bfb6" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">然后，我们添加一个文本方面，它显示列“city”中每个不同值的行数。正如你所看到的，费城的拼写有相当多的变化。</p><div class="ku kv kw kx gt ab cb"><figure class="nw iv og ny nz oa ob paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><img src="../Images/93db912dad2a0d4b54d7bb331f765e32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1684/format:webp/1*4iqMM1EhEK1MH6c4xQ7hPw.png"/></div></figure><figure class="nw iv oh ny nz oa ob paragraph-image"><img src="../Images/5457bb6e12b4337b5f082a9f19d8fdf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:284/format:webp/1*2i6jIYzgpeI0GwYwPdad8Q.png"/><p class="ky kz gj gh gi la lb bd b be z dk oi di oj of translated">添加文本方面</p></figure></div><p id="9d6a" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jf">编辑文本 inline </strong> <br/>如果有一个条目需要更正，我们可以直接点击该条目旁边的编辑并替换该值。如果我们要替换几个值，这没问题。</p><div class="ku kv kw kx gt ab cb"><figure class="nw iv ok ny nz oa ob paragraph-image"><img src="../Images/72283682c201fecaee8511d1b77a7cbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*FBL5T1oVa5xdZ6fb5fuZSQ.png"/></figure><figure class="nw iv ol ny nz oa ob paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><img src="../Images/95be3c933deab0ca183c334652c7884a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*_HDeeDm3hpBIynzELbwyQA.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk om di on of translated">编辑单个条目</p></figure></div><p id="716c" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated"><strong class="lf jf">集群和编辑<br/> </strong>但是如果我们有太多的变化需要用单个值替换，我们可以选择基于一些内置方法对条目进行集群，然后一次性编辑它们。</p><figure class="ku kv kw kx gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/4d02e12f159f856509b813ca2110d7fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*H3G6_TVwLejpV4NUBElVaw.png"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">聚类和编辑</p></figure><p id="66fd" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">点击聚类按钮，打开一个窗口，其中的条目根据默认方法“按键碰撞”和功能“指纹”聚类在一起。我们可以改变键控函数，看到条目以不同的方式聚集。</p><figure class="ku kv kw kx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi op"><img src="../Images/d7d649df98933efebe97b2796f0d9521.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CVPXtqfblPNG0CEQRW2hGw.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">聚类方法和函数</p></figure><p id="f660" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">一旦我们对集群满意了，我们就可以继续为这些集群提供新的值。如果“键碰撞”没有得到想要的结果，我们可以尝试另一种方法“最近邻”。我们还可以重复聚类和编辑。我们不需要知道函数的所有内部工作原理来使用它，尽管如果你好奇的话,<a class="ae lc" href="https://github.com/OpenRefine/OpenRefine/wiki/Clustering-In-Depth" rel="noopener ugc nofollow" target="_blank">文档</a>是一个有趣的读物。</p><p id="d9db" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">随意试验不同的方法，选择最适合给定数据的方法。对于这个数据集，半径为 8 的 Levensthein 距离给出了最好的结果。</p><figure class="ku kv kw kx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oq"><img src="../Images/2dd2ddd0fa1995f9d921a0aa05d7859c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ro4B_jhw1S3asWnNlbRhmA.png"/></div></div></figure><p id="e1df" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">经过几次重新聚类，我们已经纠正了费城所有不正确的条目。</p><div class="ku kv kw kx gt ab cb"><figure class="nw iv or ny nz oa ob paragraph-image"><img src="../Images/91744f889bfea14963a07c14127f0d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*xp-fp0ZSpuGKxlVbIwnzVg.png"/></figure><figure class="nw iv os ny nz oa ob paragraph-image"><img src="../Images/2a68a11bffca9936557133e160b3b9b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:480/format:webp/1*Om90fbzDccIqiQPeKh92Mg.png"/></figure></div><p id="fdf5" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">我们到目前为止所做的所有手动<strong class="lf jf">清洁动作</strong>都被<strong class="lf jf">记录</strong>。我们可以看到它们作为一系列步骤列在“撤销/重做”下面。我们可以返回到任何步骤，并在该步骤结束时看到结果。如果我们对某个特定的步骤不满意，我们可以只做另一个清洁动作，然后覆盖这个步骤。</p><p id="596f" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">一旦我们对结果满意，我们就可以<strong class="lf jf">导出干净的数据</strong>。</p><figure class="ku kv kw kx gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nu"><img src="../Images/65d80a576eb95253fc6e7b67ada2381b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jkY5zUvsR-pklezbbwRCJg.png"/></div></div><p class="ky kz gj gh gi la lb bd b be z dk translated">以不同格式导出清理后的数据</p></figure></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><p id="5249" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">总之，OpenRefine 是一个有效的数据辩论工具</p><ol class=""><li id="04ec" class="nf ng je lf b lg lh lj lk lm nh lq ni lu nj ly ot nl nm nn bi translated">你不需要成为一个程序员来使用它。它就像一个电子表格，很容易处理。</li><li id="cad4" class="nf ng je lf b lg no lj np lm nq lq nr lu ns ly ot nl nm nn bi translated"><strong class="lf jf">数据清理规则的交互式可视化规范</strong>有助于共同提出动态数据修正规则。当您需要从业务领域的主题专家那里获得意见时，这非常有用，因为他们更喜欢看数据而不是代码。</li><li id="ee8e" class="nf ng je lf b lg no lj np lm nq lq nr lu ns ly ot nl nm nn bi translated">所有清洁动作都被记录为 JSON 脚本，这有助于<strong class="lf jf">再现性</strong>和<strong class="lf jf">自动化</strong>(将在另一篇文章中具体阐述)</li></ol><h2 id="3e50" class="mg mh je bd mi mj mk dn ml mm mn dp mo lm mp mq mr lq ms mt mu lu mv mw mx my bi translated">对于特定的数据清理来说，这听起来不错，但是我们能在自动化的数据清理管道中使用它吗？</h2><p id="a653" class="pw-post-body-paragraph ld le je lf b lg mz kf li lj na ki ll lm nb lo lp lq nc ls lt lu nd lw lx ly im bi translated">当然，你可以！。</p><p id="93f7" class="pw-post-body-paragraph ld le je lf b lg lh kf li lj lk ki ll lm ln lo lp lq lr ls lt lu lv lw lx ly im bi translated">OpenRefine 有一些我们可以使用的客户端库。我会写一篇关于如何使用<strong class="lf jf"> Python 和 OpenRefine </strong>建立数据清理管道的帖子。敬请关注…</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><h2 id="515a" class="mg mh je bd mi mj mk dn ml mm mn dp mo lm mp mq mr lq ms mt mu lu mv mw mx my bi translated">资源</h2><p id="ae6f" class="pw-post-body-paragraph ld le je lf b lg mz kf li lj na ki ll lm nb lo lp lq nc ls lt lu nd lw lx ly im bi translated">我们只讨论了 OpenRefine 的一小部分特性。它能提供更多的东西。伊利诺伊大学和杜克大学 T21 分校有很好的教程让你入门。</p></div><div class="ab cl lz ma hx mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="im in io ip iq"><blockquote class="ou ov ow"><p id="982e" class="ld le ox lf b lg lh kf li lj lk ki ll oy ln lo lp oz lr ls lt pa lv lw lx ly im bi translated">开始的方法是停止说话，开始行动——华特·迪士尼</p></blockquote></div></div>    
</body>
</html>