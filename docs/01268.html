<html>
<head>
<title>How To: Track Sentiment On Reddit With Python And A Chrome Extension</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何:使用Python和Chrome扩展跟踪Reddit上的情感</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-track-sentiment-on-reddit-with-python-and-a-chrome-extension-a623d63e3a1d?source=collection_archive---------32-----------------------#2020-02-04">https://towardsdatascience.com/how-to-track-sentiment-on-reddit-with-python-and-a-chrome-extension-a623d63e3a1d?source=collection_archive---------32-----------------------#2020-02-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="4cd5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我的Reddit用户帐号已经超过10年了。为此，我得到了一个虚拟徽章。谢谢Reddit。该网站已经从互联网的一个相当小众的角落变成了一个巨大的社区，在2019年拥有<a class="ae ko" href="https://techcrunch.com/2019/12/04/reddits-monthly-active-user-base-grew-30-to-reach-430m-in-2019/" rel="noopener ugc nofollow" target="_blank">4.3亿</a>月活跃用户。因此，尽管毫无疑问不是一个完全有代表性的社会样本，但仍有大量的问题需要研究，成千上万的社区需要探索。</p><p id="a9e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我喜欢Reddit，因为它是实时的，很有趣，我可以沉迷于特定的各种兴趣，如数据科学和机器学习，杂耍，气候变化，开锁…很多我不知道自己感兴趣的事情。那些让<a class="ae ko" href="https://www.reddit.com/r/oddlysatisfying" rel="noopener ugc nofollow" target="_blank">奇怪地满足的事情</a>，或者<a class="ae ko" href="https://www.reddit.com/r/fastworkers" rel="noopener ugc nofollow" target="_blank">快工</a>。</p><p id="b387" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我想找出在给定的子区域中，随着时间的推移，谁或什么是流行的。/r/politics，/r/nba，或者/r/bestof里的人在讨论谁？人们在/r/科学、/r/获得动机或/r/技术中谈论什么？炒作在哪里？</p><p id="91a6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将创建一个端到端的应用程序:</p><ul class=""><li id="d658" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn ku kv kw kx bi translated">首先，我将使用Python在Jupyter笔记本中获取数据</li><li id="3720" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">我将简要介绍在云中运行脚本、保存输出以及安排脚本更新它</li><li id="44a8" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn ku kv kw kx bi translated">最后，我将把数据提供给用Javascript编写的Google Chrome扩展</li></ul><p id="d3bb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所有需要的代码都在这里<a class="ae ko" href="https://github.com/treebeardtech/reddit_tracker_blog" rel="noopener ugc nofollow" target="_blank">。</a>我们开始吧。</p><h1 id="9f54" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">连接到Reddit API</h1><p id="9dba" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">Reddit API有一个很棒的python包装器，创造性地命名为Python Reddit API包装器，或PRAW。文件<a class="ae ko" href="https://praw.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">让我有了一个良好的开端。它说我需要创建一个reddit应用程序，所以先按照</a><a class="ae ko" href="https://github.com/reddit-archive/reddit/wiki/OAuth2-Quick-Start-Example#first-steps" rel="noopener ugc nofollow" target="_blank">这些步骤</a>:</p><ol class=""><li id="12d1" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn mg kv kw kx bi translated">为您的脚本创建一个新的用户帐户，然后登录</li><li id="9f0f" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn mg kv kw kx bi translated">在Reddit上创建一个应用:<a class="ae ko" href="https://www.reddit.com/prefs/apps" rel="noopener ugc nofollow" target="_blank">https://www.reddit.com/prefs/apps</a></li><li id="bd8b" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn mg kv kw kx bi translated">给它一个名称，并确保为类型选择<strong class="js iu">脚本</strong></li></ol><p id="bb01" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">PRAW客户端需要我们的应用程序客户端id和来自应用程序设置的密码，它也喜欢user_agent字符串:</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="5196" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，按照PRAW快速入门，我可以创建一个Reddit客户端。这为我们创建了一个Reddit的只读实例来进行交互。让我们确保它正在工作。</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="8d76" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我可以要求subreddits提交内容和评论。让我们尝试在/r/learnpython中获取热门提交:</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="dae1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">看起来不错。让我们创建一个数据集来分析。</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="f685" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我已经收集了一个数据集，让我们试着找到一些名字。</p><h1 id="9569" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">具有空间的自然语言处理</h1><p id="82d3" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">我最初在这个任务上尝试了nltk库，但是SpaCy的开箱即用性能要好得多(免责声明—只是我目测的结果，而不是严格测试的结果)。SpaCy可以识别许多不同的实体。哦，顺便说一下，空间文档是令人难以置信的！非常清晰、有用的提示，以及使用Binder的内嵌运行代码示例。谢谢SpaCy团队🙏。</p><p id="4a82" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">查找名称和其他种类的类别被称为命名实体提取。代码如下所示:</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/270d6c24f24da5acab53b75ee532804c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9g_xhban4r0HKN3AzanAJQ.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">这就是结果。SpaCy很酷。</p></figure><p id="a8f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我会看看它在一些/r/nba提交的标题上表现如何</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mz"><img src="../Images/d14e84bd4e362377a76f4b6f9b31fa67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yP4Cyrkyw7raAdvK"/></div></div></figure><p id="ed0f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">斯帕西做得很好。那里有一些流氓艺术作品，沙克被归类为一个国家，总的来说，人和组织之间有些混淆——但我印象深刻。虽然有组合两种实体类型的情况，但现在我将坚持查找人名(“PERSON”)。</p><h1 id="174a" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">简单的管道</h1><p id="c56f" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">一旦我获得了每个提交标题的命名摘要，我就可以将它们作为一列添加到dataframe中。一个标题中可以有多个名字，我不希望它们被组合在一起，所以我们需要将它们分开，并进行频率统计。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mz"><img src="../Images/97a432fec321b26325fb04ac0d2e0a7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5oFSV4_DXbxEWF7_"/></div></div></figure><p id="835f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦我们有了名字和计数的列表，让我们使用<a class="ae ko" href="https://plot.ly/python/" rel="noopener ugc nofollow" target="_blank"> plotly </a>绘制输出。我把绘图代码写成一个函数，以便以后重用。</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi na"><img src="../Images/5ceed08e89c17edd2958788931f83ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e70cBhTXpQcvmaqBXYZrPQ.png"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">撕裂科比</p></figure><p id="5afc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">到目前为止，一切顺利。为了便于使用，我将扩充这个函数，使它接受一个子编辑名作为输入，并用子编辑名保存图表。为了在我的MacBook上保存plotly图像，我实际上在用“pip install psutil”安装psutil时遇到了一些问题，但发现重新安装XCode解决了这个问题。</p><p id="4f7a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在我们有了一个工作流程:从获取数据、提取姓名到可视化输出。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nb"><img src="../Images/b10f19e7c926871d7cad6241fbc8c9a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NIt-7hN3sz7WncZK"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">工作流管道</p></figure><p id="dda8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">等等，我听到你说—你只是在看提交的标题。评论呢？！这是一个公平的观点。对每个提交的内容进行顶级或每条评论会提供更多的见解。通过PRAW找到的每个提交都带有变量，给出评论id。这些可以被迭代以获得注释。然而，我不打算在这里这样做——首先——有些线程有很多注释！我把它作为一个练习留给读者，但是如果你想<a class="ae ko" rel="noopener" target="_blank" href="/scraping-reddit-data-1c0af3040768">这篇教程</a>解释了你将如何做。</p><h1 id="e43f" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">可访问的输出</h1><p id="23fe" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">我希望笔记本电脑的输出能够与世界共享，也就是说，可以公开访问。这可能意味着用一个网络服务器为他们服务，或者将他们保存到一个公共可访问的云桶中。</p><p id="724d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我正把图像保存到我为此创建的AWS S3存储桶(亚马逊的文件存储服务)中。任何人都可以看到存储在那里的图像。随附笔记本的最后一部分对此进行了详细说明，因此我不会在此一一列举。本质上，笔记本在本地为我选择的每个子编辑保存了一张图片，然后上传到一个S3桶。</p><h1 id="d7a3" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">部署和计划</h1><p id="6fe2" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">到目前为止，这个笔记本作为一次性练习还是不错的。但是随着时间的推移运行笔记本会更有趣，可以看到趋势。我想存储输出，这样我就可以看到随时间的变化。</p><p id="06dd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我不打算详细介绍如何设置云服务器，所以如果你只想在本地运行并使用chrome扩展，就跳过这一步吧！</p><p id="4c35" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要自己部署这个过程，有很多选项。一种常见的方法是将笔记本转换成python脚本，并根据需要运行它。要部署它，您可以遵循以下步骤:</p><ol class=""><li id="b64a" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn mg kv kw kx bi translated">将笔记本变成python脚本(<a class="ae ko" href="https://github.com/treebeardtech/reddit_tracker_blog/blob/master/notebook/my_script.py" rel="noopener ugc nofollow" target="_blank">示例脚本my_script.py </a>)</li><li id="a3ac" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn mg kv kw kx bi translated">像创建S3桶这样的部分不需要每次都运行——所以把它们省略掉</li><li id="5b8d" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn mg kv kw kx bi translated">创建依赖文件(pipfile或requirements.txt)来重新创建您的开发环境</li><li id="c71d" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn mg kv kw kx bi translated">将脚本和依赖项列表复制到:</li><li id="bdcc" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn mg kv kw kx bi translated">虚拟服务器(EC2，谷歌云计算，数字海洋等)<br/>(更高级:docker容器，可部署在任何地方，包括无服务器环境，如谷歌云运行)</li><li id="1700" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn mg kv kw kx bi translated">在虚拟服务器上安装依赖项</li></ol><p id="c34b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">顺便说一句，笔记本可以通过一个名为<a class="ae ko" href="https://papermill.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Papermill </a>的库在“无头”模式下运行——我一直在研究用它来自动运行笔记本。</p><p id="6273" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我在这里一直缺乏想象力。你也可以把你的脚本放在你厨房的树莓派上，或者在<a class="ae ko" href="https://mybinder.org/" rel="noopener ugc nofollow" target="_blank"> Binder </a>或<a class="ae ko" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Google Collab </a>上运行笔记本。有许多部署选项。</p><p id="2350" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">日程安排开始变得更加棘手。如果您想让您的笔记本电脑开着，或者您有一个虚拟服务器在运行，您可以使用cron、unix调度程序或<a class="ae ko" href="https://pypi.org/project/python-crontab/" rel="noopener ugc nofollow" target="_blank"> python-crontab </a>来调度脚本运行，这样会更容易。如果您在Google Cloud Run中有docker容器，您可以使用Google Cloud Scheduler设置日程。其他云平台也有类似的工具。</p><p id="7d4d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您按照上面的步骤将您的脚本放到一个基于Linux的虚拟服务器中，那么您可以使用“cron”来调度您的脚本。对于每日以外的时间表，请查看此<a class="ae ko" href="https://devhints.io/cron" rel="noopener ugc nofollow" target="_blank"> cron cheatsheet </a>。</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><h1 id="15ab" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">准备分享——创建chrome扩展</h1><p id="c7f1" class="pw-post-body-paragraph jq jr it js b jt mb jv jw jx mc jz ka kb md kd ke kf me kh ki kj mf kl km kn im bi translated">每天都在收集数据并为我存储。所以让我们把它端上来。</p><p id="cb1b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我可以做一个简单的网站，但我认为做一个谷歌Chrome扩展会更有趣(向那些不使用Chrome的人道歉)。首先不是移动的。也就是说，我们开始吧。</p><p id="79be" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">用户体验应该是:</p><ol class=""><li id="97c6" class="kp kq it js b jt ju jx jy kb kr kf ks kj kt kn mg kv kw kx bi translated">转到reddit(否则扩展没有任何作用)</li><li id="e030" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn mg kv kw kx bi translated">浏览任何子编辑或提交页面</li><li id="b896" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn mg kv kw kx bi translated">点按重叠的谨慎悬停按钮</li><li id="0cd4" class="kp kq it js b jt ky jx kz kb la kf lb kj lc kn mg kv kw kx bi translated">收到一个图表，显示谁是最近最受欢迎的子编辑</li></ol><p id="24f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我以前从未做过chrome扩展，但幸运的是，有一些很棒的教程。</p><p id="5586" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我从<a class="ae ko" href="https://thoughtbot.com/blog/how-to-make-a-chrome-extension" rel="noopener ugc nofollow" target="_blank"> this tutoria </a> l中获得了一些灵感。但是我不想要太复杂的东西——将状态从页面传递到任何类型的弹出菜单的Javascript消息会很快变得混乱。</p><p id="d9ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您已经克隆了附带的代码库，找到“chrome extension”文件夹，或者创建自己的文件夹。然后从教程中:</p><p id="6f01" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="nc">“要在Chrome中加载你的扩展，在浏览器中打开chrome://extensions/，点击右上角的“开发者模式”。现在点击“加载解压缩的扩展…”并选择扩展的目录。您现在应该会在列表中看到您的扩展名。</em></p><p id="c0ef" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">保持Chrome扩展页面标签打开，你会刷新很多。它显示错误也很有帮助，但是我发现保持Chrome控制台(F12)打开对于查看正在发生的事情很有用。*注意* —如果你为一个扩展创建了一个弹出窗口，它就像一个独立的标签，有自己独立的控制台！编写“console.log”(“我的警报”)可能不会出现在您期望的控制台中。在检查器中设置断点，或者使用“alert('My alert ')”会有所帮助。</p><p id="1c8f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，让我们改变站点过滤器，这样扩展只能在Reddit上运行。然后，我将在manifest.json文件中添加一些标题和描述，包括一个图标链接以及到background.js和content.js脚本的链接。</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="f2b5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下载<a class="ae ko" href="https://code.jquery.com/jquery-3.4.1.min.js" rel="noopener ugc nofollow" target="_blank">最新的jQuery </a>并把它放在您的项目目录中，与content.js文件放在一起。它们在上面的manifest.json文件的“js”部分中指定。</p><p id="a72c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">这是怎么回事？</strong></p><p id="6756" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">background.js中的脚本始终运行，当站点URL与内容脚本列表中的任何URL匹配时，content.js运行。因此，我可以在content.js中编写一个脚本，为给定的subreddit获取我的图像，并将其注入页面。</p><p id="e79f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了显示图像，我将创建一个可以绘制到reddit页面上的覆盖图，添加一些样式，然后是我们之前创建的显示统计数据的图表。</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="f55d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为这些快速和肮脏的内联风格道歉。这将创建一个固定位置的侧边栏，它将扩展为一个矩形。这将是统计数据的容器。</p><p id="9aa3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我想找到subreddit的名称，并使它对脚本可用:</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="4da3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，我想获取我的统计图像，并将其注入覆盖:</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="b306" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我发现更改子编辑不会触发页面更新事件，因此(另一个黑客)我将每秒检查一次子编辑，如果它发生了变化，就更新覆盖图。这意味着将代码包装在“setInterval”子句中，每次重试等待1000毫秒。</p><p id="7910" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">经过一些摆弄，这里的覆盖最小化和最大化:</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nd"><img src="../Images/ff1e5d9731af75cee688853d106a1a36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7t1s8upd4prDySQ-"/></div></div><p class="mv mw gj gh gi mx my bd b be z dk translated">我漂亮的Chrome扩展，带有一个图像占位符</p></figure><p id="402e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当我用subreddit名称保存图像时，我可以用同样的方式获取图像。我可以这样指定图像:</p><figure class="mh mi mj mk gt ml"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="1c50" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了可用性，让我们确保当用户在我没有统计数据的子编辑上时，他们会收到一条友好的消息，引导他们到受支持的子编辑。让我们在stats图像下添加子编辑链接列表，以便更好地衡量。</p><figure class="mh mi mj mk gt ml gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi ne"><img src="../Images/7898d5a1d3d7e5f120c9cffe408e61f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1RX6-7LQStebAv8T"/></div></div></figure><p id="0702" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如我之前说过的，扩展的完整代码可以在这里看到，我希望content.js中的逻辑相当清晰。</p><p id="1d81" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我完成了…现在！从制定计划，抓取Reddit API，提取名称，绘制结果，保存输出，远程部署，调度脚本，以及创建Chrome扩展来查看结果！我希望你喜欢这次练习。</p><p id="17f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<a class="ae ko" href="http://treebeard.io" rel="noopener ugc nofollow" target="_blank"> Treebeard Technologies </a>，我正在制作工具，帮助数据科学家更快、更智能地工作，并从云服务中获得最佳收益。</p><p id="0bae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您想了解更多信息，请联系我们。给我留言，在<a class="ae ko" href="https://twitter.com/laurencewwatson" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我，在<a class="ae ko" href="https://treebeard.io" rel="noopener ugc nofollow" target="_blank"> Treebeard.io </a>上关注我们！</p></div></div>    
</body>
</html>