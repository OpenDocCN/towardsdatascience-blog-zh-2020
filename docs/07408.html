<html>
<head>
<title>Predicting MPAA Ratings for Movies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测电影的美国电影协会评分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-mpaa-ratings-for-movies-47fb85970bd4?source=collection_archive---------46-----------------------#2020-06-04">https://towardsdatascience.com/predicting-mpaa-ratings-for-movies-47fb85970bd4?source=collection_archive---------46-----------------------#2020-06-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2a2f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用KNN预测年龄分级使用IMDb评论和票房收入</h2></div><p id="b06e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了回归，分类是监督机器学习中最常见的任务之一。分类是将事物分类的任务。例如，将图像分为狗和猫的图像，标记x射线是否有骨折，以及更具争议的是，某人是否会偿还贷款。</p><p id="9d80" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">按照这个教程，你可以用这个Colab笔记本:<br/><a class="ae lb" href="https://colab.research.google.com/drive/1XZiBt_y4bE22k7D1bTfakD6-ax8Ddbxb?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://Colab . research . Google . com/drive/1 xzibt _ y 4 be 22k 7 D1 btfakd 6-ax 8d dbxb？usp =分享</a></p><p id="fb4d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请观看这段4分钟的视频:</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="lh li l"/></div></figure><p id="9ee9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在大多数情况下，分类是通过在数据点之间绘制决策边界来完成的。例如，在这个图中，我们可以画一个这样的决策边界来分隔x和Os。如果一个点在这条线上，我们把它归类为X，如果它在这条线以下，我们把它归类为o。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lj"><img src="../Images/b43ce05d378e9455ba39a9148cda86f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xrGErYirzk8vYP4pkte8Fw.png"/></div></div></figure><p id="4a81" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看一个可以使用分类解决的实际问题。我们可以仅仅通过查看关于电影的两个变量来将电影划分为美国电影协会评级(即G、PG、PG13或R)吗？这两个变量是:电影在iMDB上的观众评级和电影在全球的票房收入。换句话说，这些变量对美国电影协会评级有任何预测价值吗？</p><p id="a361" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们在这里画出<em class="lq"> 48 </em>电影的数据。票房收入将在X轴上，而iMDB评级将在Y轴上。我们将美国电影协会分级编码为从1到3的数字，1表示PG，3表示R。为了更好地显示该数据集，我们将PG电影着色为绿色，PG 13电影着色为橙色，R电影着色为红色。正如我们所看到的，使用简单的决策界限将电影分为美国电影协会等级几乎是不可能的。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lj"><img src="../Images/d13ba0bcb89da671c2f521ffc9795a8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bhhbGTRSfDRo6fV5VFs-pA.png"/></div></div></figure><p id="34d7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输入K-最近邻。k-最近邻或简称KNN是一种分类和回归方法，它基于一个简单的前提，即彼此接近的数据点往往具有相似的值或结果。例如，如果你的邻居都有车，那么你可能会认为你也有车。</p><p id="62f7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从数学上来说，为了预测特定点的结果，KNN挑选K个最接近该点的数据点，并对它们的结果进行平均。</p><p id="6006" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，让我们回到我们的电影数据集，选择一部我们想要预测其美国电影协会评分的电影。《重磅炸弹》是2019年的一部电视剧，讲述了福克斯新闻频道的三名女性着手揭露该网络首席执行官的性骚扰行为。当然，了解这一背景提供了关于电影分级的有价值的信息，但是假设我们只有这两条关于电影的信息。</p><p id="dc71" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们做出任何预测之前，让我们后退一步，看看我们的坐标轴。因为KNN依赖于点与点之间的欧几里得距离，这个过程的一个重要步骤是确保我们的轴被适当地缩放。我们希望垂直距离和水平距离一样重要。在我们的电影示例中，我们放大了IMDB，缩小了票房收入，这样两个轴的范围都是大约50个点。每次使用KNN时，缩放坐标轴是非常重要的。</p><pre class="lc ld le lf gt lr ls lt lu aw lv bi"><span id="38cc" class="lw lx iq ls b gy ly lz l ma mb">data["IMDB2"] = data["IMDB"]*10</span><span id="4d60" class="lw lx iq ls b gy mc lz l ma mb">data["Box Office2"]=data["Box Office"]/(0.8*10**7)</span><span id="a855" class="lw lx iq ls b gy mc lz l ma mb">X =  data[["IMDB2","Box Office2"]].values</span><span id="5ddc" class="lw lx iq ls b gy mc lz l ma mb">y = np.expand_dims(data["MPAA"].values,1)</span><span id="6699" class="lw lx iq ls b gy mc lz l ma mb">train_split = 40</span><span id="fbf1" class="lw lx iq ls b gy mc lz l ma mb">knn = KNeighborsClassifier(5, weights='distance')</span><span id="56b9" class="lw lx iq ls b gy mc lz l ma mb">knn.fit(X[:train_split],y[:train_split])</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lj"><img src="../Images/3590783320b7a5bc1be7a743f8f4997d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_qdHjZ0fm7SAT88lid5ETw.png"/></div></div></figure><p id="2eb6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我们在X轴上看到的，它在iMDB上获得了6.8的收视率，在Y轴上我们看到它的票房收入接近600亿美元。KNN将寻找K个最近的邻居，在我们的例子中我们选择K为5，但这可以根据需要调高或调低。最接近的5部电影是R级的《长镜头》和《午夜梦回》，PG13级的《朱迪》和《哈里特》，G级的《邻居的美好一天》。然后，KNN将对这5个美国电影协会评分进行加权平均，在图表中，距离“重磅炸弹”较近的电影比距离较远的电影权重更大。瞧啊。我们预测“Bombshell”的评级为r。这不仅准确，而且我们的模型还在几乎88%的时间内正确预测了测试集中所有电影的美国电影协会评级！</p><pre class="lc ld le lf gt lr ls lt lu aw lv bi"><span id="ffbf" class="lw lx iq ls b gy ly lz l ma mb">movie = 'Bombshell'</span><span id="9ed9" class="lw lx iq ls b gy mc lz l ma mb">dist,neighbors = knn.kneighbors(data[data['Title']==movie][["IMDB2","Box Office2"]])</span><span id="c072" class="lw lx iq ls b gy mc lz l ma mb">prediction = knn.predict( data[data['Title']==movie][["IMDB2","Box Office2"]])[0]</span></pre><p id="c24c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就对了。KNN是另一个简单的机器学习模型，在复杂的问题上效果惊人。在评论中让我们知道你打算把这个算法应用到什么样的问题上！</p><p id="668d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">快乐学习！</p></div></div>    
</body>
</html>