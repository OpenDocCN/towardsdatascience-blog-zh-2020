<html>
<head>
<title>Identifying Candlestick Patterns using Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习识别烛台模式</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/identifying-candlestick-patterns-using-deep-learning-b7d706726874?source=collection_archive---------2-----------------------#2020-09-17">https://towardsdatascience.com/identifying-candlestick-patterns-using-deep-learning-b7d706726874?source=collection_archive---------2-----------------------#2020-09-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="59c0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在蜡烛图上训练一个神经网络，然后用它来识别蜡烛图上的模式</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/0f87b93fda4bf30be6878c97ff10dce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*uga6tuJPbc-GLL3liKuzOA.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">使用下述方法生成的一些热图(图片由作者提供)。</p></figure><p id="b251" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最近我完成了一个非常有趣的项目，其中我试图使用深度学习来识别大型印度股票图表上的烛台模式，结果非常有趣！这个博客是一个教程，这样你就可以自己尝试这个迷人的“实验”。</p><blockquote class="lq lr ls"><p id="d519" class="ku kv lt kw b kx ky ju kz la lb jx lc lu le lf lg lv li lj lk lw lm ln lo lp im bi translated">我称之为“实验”,是为了强调这是一个实验，并明确表示你不应该根据这里给出的内容做出任何财务决策！</p></blockquote><p id="32de" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">简言之，我们将执行以下步骤(使用 python):</p><ul class=""><li id="1586" class="lx ly it kw b kx ky la lb ld lz lh ma ll mb lp mc md me mf bi translated">使用 python 库 nsepy 收集多只股票的每日历史股票数据。</li><li id="6949" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">将数据转换成蜡烛图。</li><li id="7c59" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">根据特定方向的百分比运动(收盘价),给蜡烛图贴上“上升”或“下降”的标签。</li><li id="2449" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">在数据上训练深度学习模型。</li><li id="cc18" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">获取感兴趣的区域(基于激活值)并使用热图对其进行可视化。</li></ul><p id="d1c0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">你可以在这里找到包含这个项目<a class="ae ml" href="https://github.com/shaan2909/Deep-Learning-for-Candle-Stick-Patterns-Identification" rel="noopener ugc nofollow" target="_blank">的 Jupyter 笔记本的 GitHub repo。随着我们的发展，我们将需要以下库:</a></p><ul class=""><li id="33e8" class="lx ly it kw b kx ky la lb ld lz lh ma ll mb lp mc md me mf bi translated">nsepy</li><li id="ffed" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">熊猫</li><li id="9a9c" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">numpy</li><li id="f1d0" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">matplotlib</li><li id="aaef" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">法斯泰</li></ul><p id="93c0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我将一段一段地解释代码。所以让我们开始吧！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="76b9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在上面这段代码中，我们定义了获取历史股票数据并为其绘制蜡烛图的函数。简要概述:</p><ul class=""><li id="db9c" class="lx ly it kw b kx ky la lb ld lz lh ma ll mb lp mc md me mf bi translated">函数“获取数据”将股票代码、开始和结束日期作为输入，给出一个包含股票数据的 Pandas 数据帧。</li><li id="8348" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">函数“plot_candles”(最初是由 Daniel Treiman 编写的，我对它做了一些小的改动)接收熊猫数据帧并输出一个蜡烛图。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mm mn l"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">很抱歉输出这么长，但我希望如此，以便让您了解代码是如何工作的。</p></figure><p id="76f0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在以上部分，我们将完成以下步骤:</p><ul class=""><li id="3f29" class="lx ly it kw b kx ky la lb ld lz lh ma ll mb lp mc md me mf bi translated">使用“获取数据”功能获取历史股票数据(过去两年)。</li><li id="8fe3" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">根据未来五天的走势，决定一个特定的图表是应该分类为“上涨”还是“下跌”。</li><li id="0ae8" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">创建一个 20 天的蜡烛图。</li><li id="03a1" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">将蜡烛图保存到各自的文件夹中(向上/向下)。</li><li id="1f76" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">对许多不同的股票重复上述步骤。</li></ul><p id="2eaf" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们现在完成了数据收集；开始训练模型吧！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="be00" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在上面这段代码中，我们正在设置数据，以便我们可以使用它来训练深度学习模型。我们正在完成以下任务:</p><ul class=""><li id="98c4" class="lx ly it kw b kx ky la lb ld lz lh ma ll mb lp mc md me mf bi translated">为模型定型设置批量大小。</li><li id="c3cc" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">将数据分成训练和验证数据集。</li><li id="63e6" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">对数据应用扩充(以减少过度拟合)。</li></ul><p id="cb7b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在开始训练模型吧！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="34ee" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们在上面训练了一个深度学习模型(在验证集上的准确率接近 62 %)。我们所做的更详细的概述如下:</p><ul class=""><li id="48e4" class="lx ly it kw b kx ky la lb ld lz lh ma ll mb lp mc md me mf bi translated">使用迁移学习，以适当的学习速率在我们的图表上训练预训练的神经网络。</li><li id="a3ab" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">增加了我们图像的尺寸(之前的训练周期是 224 乘 224，然后我们增加到 352 乘 352)</li><li id="dbe5" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">再次使用迁移学习，以适当的学习速率在新的较大图像上训练先前的网络。</li></ul><p id="8562" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我们的验证数据集上，我们获得了近 62 %的准确率！</p><p id="6dca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们将创建热图，突出显示使用激活的神经网络感兴趣的区域。让我们这样做吧！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="01b6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们完成了上一节中的以下步骤:</p><ul class=""><li id="4d12" class="lx ly it kw b kx ky la lb ld lz lh ma ll mb lp mc md me mf bi translated">创建了一个要分析的所有图表的列表(这些图表被高度准确地预测)。</li><li id="ee0f" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">从上面的列表中获得一个特定的图像，并将其传输到 GPU。</li><li id="8934" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">在向前传递以获得激活的过程中，使用钩子钩住模型。</li><li id="15ed" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">使用 matplotlib 激活创建热图。</li><li id="3bbc" class="lx ly it kw b kx mg la mh ld mi lh mj ll mk lp mc md me mf bi translated">保存了热图。</li></ul><p id="ef93" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">瞧啊。我们设法训练了一个神经网络，并用它来识别蜡烛图中的模式。</p><blockquote class="lq lr ls"><p id="1173" class="ku kv lt kw b kx ky ju kz la lb jx lc lu le lf lg lv li lj lk lw lm ln lo lp im bi translated"><strong class="kw iu">我想再次强调，请不要使用此处给出的任何内容来做出任何财务决定！</strong></p></blockquote><p id="5b05" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">希望你喜欢看这个博客，<br/>谢谢你一直读到最后！</p><p id="30d4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">附注<br/>如有任何问题或建议，请随时通过<a class="ae ml" href="https://www.linkedin.com/in/shaan-shah-88085819b/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>与我联系。</p><p id="7e28" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">P.P.S. <br/>我已经生成了许多烛台图表的热图，如果你想看看它们，请随时联系<a class="ae ml" href="https://www.linkedin.com/in/shaan-shah-88085819b/" rel="noopener ugc nofollow" target="_blank"> me </a>。</p></div></div>    
</body>
</html>