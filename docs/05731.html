<html>
<head>
<title>Mastering Data Selection with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用熊猫掌握数据选择</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mastering-data-selection-with-pandas-e8768104a39?source=collection_archive---------49-----------------------#2020-05-12">https://towardsdatascience.com/mastering-data-selection-with-pandas-e8768104a39?source=collection_archive---------49-----------------------#2020-05-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="efa0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用熊猫选择数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c4acbe0dfd218fac222958c751dce8c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*82I3npj2ykaJSBs2MAmIhw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.pexels.com/photo/paper-boats-on-solid-surface-194094/" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="70ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas 是一个 python 库，为统计分析、特征工程、数据选择、数据过滤等提供了一些有用的工具。数据选择和数据过滤对于探索性数据分析、特征工程和预测模型构建非常有用。在本帖中，我们将讨论 Pandas 中一些有用的数据选择和过滤方法。</p><p id="d456" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><p id="be47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于我们的目的，我们将使用<a class="ae ky" href="https://www.kaggle.com/gregorut/videogamesales" rel="noopener ugc nofollow" target="_blank"> <em class="lv">视频游戏销售数据集</em> </a>。</p><p id="4e61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们导入 Pandas 库并将数据读入 Pandas 数据框:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="b512" class="mb mc it lx b gy md me l mf mg">import pandas as pd <br/>df = pd.read_csv("vgsales.csv")</span></pre><p id="8c75" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们也放宽对显示列数的限制:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="3834" class="mb mc it lx b gy md me l mf mg">pd.set_option('display.max_columns', None)</span></pre><p id="f6c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们打印数据中的列:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="bcb5" class="mb mc it lx b gy md me l mf mg">print(list(df.columns))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/4ab71c18dea8bb0db50e20da9184c843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-I8ac5EiYUlK74TsNK6JEw.png"/></div></div></figure><p id="4375" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们也打印一些关于数据的基本信息:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="1ecd" class="mb mc it lx b gy md me l mf mg">print(df.info())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/7e01b79c134f901f8fb9ad7ee2eb382b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*kbyFWcLHN6cr24l8MFVFgw.png"/></div></figure><p id="b9b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们使用“head()”方法打印前五行数据:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="63cf" class="mb mc it lx b gy md me l mf mg">print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mj"><img src="../Images/0ab9c857a988a95110ff09baf30e0ea5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_O7yERS5cTNcq4B3MetOig.png"/></div></div></figure><p id="ee4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">好了，现在我们对数据中的列名和类型有了大致的了解，我们可以执行一些基本的数据选择操作了。首先，我们可以使用。loc[]'方法来根据列值选择我们的数据子集。让我们选择“体育”类别的视频游戏:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="4c93" class="mb mc it lx b gy md me l mf mg">df_sports = df.loc[df.Genre == 'Sports']</span></pre><p id="7dba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们打印新数据框的前五行:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="62e8" class="mb mc it lx b gy md me l mf mg">print(df_sports.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/949aa884370058262ae8b4894c734b7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18YOKeVKDxukI8TQSRtouw.png"/></div></div></figure><p id="95ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看另一个专栏。让我们为 Wii 平台选择对应于视频游戏的数据子集:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="91c1" class="mb mc it lx b gy md me l mf mg">df_wii = df.loc[df.Platform == 'Wii']</span></pre><p id="9b94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们打印前五行数据:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="92ec" class="mb mc it lx b gy md me l mf mg">print(df_wii.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/e4ed1bc92f09bd40464fa5027e03786a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8KenQ1BxYx19uVpIOaFoZw.png"/></div></div></figure><p id="dcc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以选择子集的子集。例如，我们选择在“Wii”上玩的“赛车”游戏:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="6e59" class="mb mc it lx b gy md me l mf mg">df_wii_racing = df_wii.loc[df.Genre == 'Racing']</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/5d7894ceae1f0f6712020445faae27ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RN-SIITjpJ-WuZE7Mcs6UQ.png"/></div></div></figure><p id="2ff3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以用一行代码使用一个联合条件来执行这个操作:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="98a5" class="mb mc it lx b gy md me l mf mg">df_wii_racing = df.loc[(df.Platform == 'Wii') &amp; (df.Genre == 'Racing')]<br/>print(df_wii_racing.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/5d7894ceae1f0f6712020445faae27ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RN-SIITjpJ-WuZE7Mcs6UQ.png"/></div></div></figure><p id="8b8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以添加任意多的条件。让我们选择全球销量超过 100 万台的 Wii 赛车游戏:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="8fd2" class="mb mc it lx b gy md me l mf mg">df_gt_1mil = df.loc[(df.Platform == 'Wii') &amp; (df.Genre == 'Racing') &amp; (df.Global_Sales &gt;= 1.0)]<br/>print(df_gt_1mil.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/dbf94f7b91cb115ec0e54e672ea58085.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Yw9MCooKmnveeHPDa4G9g.png"/></div></div></figure><p id="f3d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以使用'按行选择数据。iloc[]'方法。让我们选择原始数据的前 1000 行:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="697d" class="mb mc it lx b gy md me l mf mg">df_filter_rows = df.iloc[:1000]<br/>print("Length of original: ", len(df))<br/>print("Length of filtered: ", len(df_filter_rows))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/9f65793ff63823bcd22000492744ddc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/format:webp/1*GO3MxzQqvhoRT45qKrIVGQ.png"/></div></figure><p id="5864" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以使用“sample()”方法选择数据的随机样本:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="20e0" class="mb mc it lx b gy md me l mf mg">df_random_sample = df.sample(n=5000)<br/>print("Length of sample: ", len(df_random_sample))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/8fd85bf814c9dd35f1ba723b74b869a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*mj5F3dT_7LAaMPTmrbPm0Q.png"/></div></figure><p id="5c17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们打印前五行:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="5c61" class="mb mc it lx b gy md me l mf mg">print(df_random_sample.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/a0b4ba902d352bf00f8cf87ee332cf39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KlMnrFdS6qXYHl3TljO-XQ.png"/></div></div></figure><p id="040c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">并在另一次运行中打印前五行:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/660fdac13c366f141dec1939d8f5e62f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GfTfGd3q9pwjjNxz1EZUzQ.png"/></div></div></figure><p id="aadf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到我们得到不同的结果。如果我们希望始终获得相同的结果，我们可以在示例方法中设置“random_state”参数:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="c419" class="mb mc it lx b gy md me l mf mg">df_random_sample = df.sample(n=5000, random_state = 42)<br/>print("Length of sample: ", len(df_random_sample))</span></pre><p id="feb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将在每次运行时给我们相同的结果。我将在这里停下来，但是我鼓励您自己尝试代码和数据。</p><h1 id="21ea" class="ms mc it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">结论</h1><p id="815e" class="pw-post-body-paragraph kz la it lb b lc nj ju le lf nk jx lh li nl lk ll lm nm lo lp lq nn ls lt lu im bi translated">总之，在这篇文章中，我们讨论了如何使用 Python Pandas 库选择和过滤数据。我们讨论了如何使用。“loc[]”方法根据列值选择数据子集。我们还展示了如何使用'按行过滤数据帧。iloc[]'方法。最后，我们讨论了如何使用“sample()”方法从数据帧中选择随机数据样本。我希望你觉得这篇文章有趣/有用。这篇文章中的代码可以在<a class="ae ky" href="https://github.com/spierre91/medium_code/blob/master/pandas_tutorials/selecting_data.py" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。感谢您的阅读！</p></div></div>    
</body>
</html>