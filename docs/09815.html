<html>
<head>
<title>Pima Indians Diabetes - Prediction &amp; KNN Visualization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">皮马印第安人糖尿病-预测和 KNN 可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pima-indians-diabetes-prediction-knn-visualization-5527c154afff?source=collection_archive---------14-----------------------#2020-07-12">https://towardsdatascience.com/pima-indians-diabetes-prediction-knn-visualization-5527c154afff?source=collection_archive---------14-----------------------#2020-07-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0072" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用 KNN 算法的预测具有 74%的接收器操作特征准确度</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8135497077d59dfbd387bc7fad7af1b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UDobLMFFh-4TqC3l"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">迈肯齐·约翰逊在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="599a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在印度，糖尿病是一个主要问题。从 1971 年到 2000 年，糖尿病的发病率上升了十倍，从 1.2%上升到 12.1%。据估计，印度有 6130 万 20-79 岁的糖尿病患者(2011 年的预期)。预计到 2030 年，这一数字将上升至 1.012 亿。据报道，印度有 7720 万糖尿病前期患者。2012 年，印度有近 100 万人死于糖尿病。居住在钦奈城市贫民窟的每 4 个人中就有 1 人患有糖尿病，约为 7 %,是全国平均水平的 3 倍。印度三分之一的死亡涉及 60 岁以下的非传染性疾病患者。印度人患糖尿病的平均时间比西方人早 10 年。生活方式的改变导致体力下降，脂肪、糖和活动量增加，卡路里和胰岛素皮质醇水平升高，肥胖和脆弱。2011 年，印度每年因糖尿病花费约 380 亿美元。</p><p id="d480" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">参考:<a class="ae kv" href="http://www.arogyaworld.org/wp-content/uploads/2010/10/ArogyaWorld_IndiaDiabetes_FactSheets_CGI2013_web.pdf" rel="noopener ugc nofollow" target="_blank">http://www . ArogyaWorld . org/WP-content/uploads/2010/10/ArogyaWorld _ India diabetes _ FactSheets _ CGI 2013 _ web . pdf</a></p><p id="21b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由<strong class="ky ir"> Hardik </strong>编码</p><p id="bfbb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">链接<strong class="ky ir"> Colab </strong>笔记本:<a class="ae kv" href="https://colab.research.google.com/drive/1n4FNgK0DwtK0QALoWcyWjBtkCLxjGs-S?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://Colab . research . Google . com/drive/1n 4 fngk 0 dwt k 0 qalowcywjbtklxjgs-S？usp =共享</a></p><h2 id="1fc7" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">数据集:</h2><p id="0f62" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated"><strong class="ky ir">皮马印第安人糖尿病数据库</strong>(根据诊断方法预测糖尿病的发病)</p><h2 id="b895" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">数据集源:</h2><p id="6d1b" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">https://www.kaggle.com/uciml/pima-indians-diabetes-database UCI 机器学习库:<a class="ae kv" href="https://www.kaggle.com/uciml/pima-indians-diabetes-database" rel="noopener ugc nofollow" target="_blank"/></p><h2 id="19c2" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">语境</h2><p id="ac34" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">这个数据集来自美国国家糖尿病、消化和肾脏疾病研究所。该数据集的目的是根据数据集中的某些诊断方法来诊断患者是否患有糖尿病。从较大的数据库中选择这些实例受到一些限制。所有患者都是至少 21 岁的皮马印度后裔妇女。</p><h2 id="5cc3" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">内容</h2><p id="4ca0" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">数据集包括医学预测值的几个变量和一个目标变量<code class="fe mq mr ms mt b">Outcome</code>。预测变量包括患者的怀孕次数、身体质量指数水平、胰岛素水平、年龄等。</p><h2 id="551a" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">承认</h2><p id="138b" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">史密斯、J.W .、埃弗哈特、J.E .、迪克森、W.C .、诺尔勒、W.C .、约翰尼斯、R.S. (1988)。<a class="ae kv" href="http://rexa.info/paper/04587c10a7c92baa01948f71f2513d5928fe8e81" rel="noopener ugc nofollow" target="_blank">利用 ADAP 学习算法预测糖尿病的发病</a>。<em class="mu">《计算机应用与医疗研讨会论文集</em>(第 261-265 页)。IEEE 计算机学会出版社。</p><h2 id="6f37" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">灵感</h2><p id="082d" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">你能建立一个机器学习模型来准确预测数据集中的患者是否患有糖尿病吗？</p><h1 id="41b9" class="mv lt iq bd lu mw mx my lx mz na nb ma jw nc jx md jz nd ka mg kc ne kd mj nf bi translated">1 导入和加载数据集</h1><p id="b3a5" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated"><strong class="ky ir">进口</strong></p><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="896c" class="ls lt iq mt b gy nk nl l nm nn">import numpy as np<br/>import pandas as pd</span><span id="3991" class="ls lt iq mt b gy no nl l nm nn"># Visualization imports<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="ff0d" class="ls lt iq mt b gy no nl l nm nn"># plotly import for Colab<br/>def configure_plotly_browser_state():<br/>  import IPython<br/>  display(IPython.core.display.HTML('''<br/>        &lt;script src="/static/components/requirejs/require.js"&gt;&lt;/script&gt;<br/>        &lt;script&gt;<br/>          requirejs.config({<br/>            paths: {<br/>              base: '/static/base',<br/>              plotly: '<a class="ae kv" href="https://cdn.plot.ly/plotly-latest.min.js?noext'" rel="noopener ugc nofollow" target="_blank">https://cdn.plot.ly/plotly-latest.min.js?noext'</a>,<br/>            },<br/>          });<br/>        &lt;/script&gt;<br/>        '''))<br/>  <br/># plotly import<br/>import plotly.express as px</span><span id="85c4" class="ls lt iq mt b gy no nl l nm nn">from plotly import __version__<br/>import cufflinks as cf<br/>from plotly.offline import download_plotlyjs,init_notebook_mode,plot,iplot<br/>init_notebook_mode(connected=True)<br/>cf.go_offline()</span><span id="a3a5" class="ls lt iq mt b gy no nl l nm nn">import IPython</span><span id="0dbf" class="ls lt iq mt b gy no nl l nm nn">IPython.get_ipython().events.register('pre_run_cell', configure_plotly_browser_state)</span></pre><p id="1de7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">数据集</strong></p><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="9191" class="ls lt iq mt b gy nk nl l nm nn"># Loading Dataset<br/>df = pd.read_csv('/content/drive/My Drive/dataset/knn/datasets_228_482_diabetes.csv')<br/>df.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/58a28773633e8f5fb0191d3ca5ba2305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6f8Y3nssooQJl2KI-D4EPg.png"/></div></div></figure><h1 id="82a0" class="mv lt iq bd lu mw mx my lx mz na nb ma jw nc jx md jz nd ka mg kc ne kd mj nf bi translated">2 数据清理</h1><p id="c8cc" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">以下各列中' 0 '值没有意义。因此使他们成为 NaN。</p><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="b898" class="ls lt iq mt b gy nk nl l nm nn">df[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']] = df[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']].replace(0,np.NaN)</span><span id="53f2" class="ls lt iq mt b gy no nl l nm nn">df.isnull().sum()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/30bee91e1a5e367b697fad75bfb6f3cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*pw700dnkwM9xpldw9IjFwg.png"/></div></figure><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="89f0" class="ls lt iq mt b gy nk nl l nm nn">import missingno as msno<br/>p = msno.bar(df)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/fa6ddbae00f0150e5a0491aef5bbe83f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0QOZQ_o3jSDUqz1Tdks6Lg.png"/></div></div></figure><h2 id="948f" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">使用 k-NN 通过输入填充空值</h2><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="cddc" class="ls lt iq mt b gy nk nl l nm nn">!pip install impyute</span><span id="f72b" class="ls lt iq mt b gy no nl l nm nn">import sys<br/>from impyute.imputation.cs import fast_knn<br/>sys.setrecursionlimit(100000) #Increase the recursion limit of the OS<br/># start the KNN training<br/>imputed_training=fast_knn(df[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']].values, k=30)</span><span id="c074" class="ls lt iq mt b gy no nl l nm nn">df_t1 = pd.DataFrame(imputed_training,columns=['Glucose','BloodPressure','SkinThickness','Insulin','BMI'])<br/>df[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']] = df_t1[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']]</span><span id="7bed" class="ls lt iq mt b gy no nl l nm nn">df.isnull().sum()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/ff21b8972e8020e3a24b06b99cac3d29.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/1*5uDrh2sKNLCOVR0thhTWag.png"/></div></figure><h1 id="eaa8" class="mv lt iq bd lu mw mx my lx mz na nb ma jw nc jx md jz nd ka mg kc ne kd mj nf bi translated">3 数据描述和可视化</h1><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="696c" class="ls lt iq mt b gy nk nl l nm nn">df.info()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/2343bb5bf815fcbada2e959c5a862a7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*918J00a5trN82LFJLWIrOA.png"/></div></figure><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="2d2e" class="ls lt iq mt b gy nk nl l nm nn">df.describe()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/81f0258b7d78f4267a45f175f68717e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lk22W12Jg57AZht6yV2CHQ.png"/></div></div></figure><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="f023" class="ls lt iq mt b gy nk nl l nm nn">sns.heatmap(df.corr(),annot=True)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/e33041c68429afa86ae977075e55d544.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*Aa5q6Fcbga9MGCOPfq3uRg.png"/></div></figure><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="6046" class="ls lt iq mt b gy nk nl l nm nn">p = df[df['Outcome']==1].hist(figsize = (20,20))<br/>plt.title('Diabetes Patient')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/951dbd1171118d537b12ee041c194993.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XXhG9ZKXjcGoUILBZrH1Cw.png"/></div></div></figure><p id="458c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">KNN 可视化所有功能用<code class="fe mq mr ms mt b">Outcome</code></p><p id="cd50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">X = <code class="fe mq mr ms mt b">df[[‘Pregnancies’, ‘Glucose’, ‘BloodPressure’, ‘SkinThickness’, ‘Insulin’,’BMI’, ‘DiabetesPedigreeFunction’, ‘Age’]]</code></p><p id="d498" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">y = <code class="fe mq mr ms mt b">df[‘Outcome’]</code></p><p id="aab3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注:<em class="mu"> </em> <code class="fe mq mr ms mt b"><em class="mu">0 — Non Diabetic Patient and 1 — Diabetic Patient</em></code></p><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="c0e6" class="ls lt iq mt b gy nk nl l nm nn">from sklearn.decomposition import PCA<br/>from mlxtend.plotting import plot_decision_regions<br/>from sklearn.svm import SVC</span><span id="d540" class="ls lt iq mt b gy no nl l nm nn">clf = SVC(C=100,gamma=0.0001)<br/>pca = PCA(n_components = 2)<br/>X_train2 = pca.fit_transform(X)<br/>clf.fit(X_train2, df['Outcome'].astype(int).values)<br/>plot_decision_regions(X_train2, df['Outcome'].astype(int).values, clf=clf, legend=2)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/225319ea0280a98f5064f3e7e25a9f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*Z-iEjWWK4oQ9f1cRB2AAag.png"/></div></figure><p id="7064" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">KNN 的特点是互相可视化:</p><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="d196" class="ls lt iq mt b gy nk nl l nm nn">from sklearn import datasets, neighbors<br/>from mlxtend.plotting import plot_decision_regions</span><span id="502e" class="ls lt iq mt b gy no nl l nm nn">def ok(X,Y):<br/>  x = df[[X,Y]].values<br/>  y = df['Outcome'].astype(int).values<br/>  clf = neighbors.KNeighborsClassifier(n_neighbors=9)<br/>  clf.fit(x, y)<br/>  # Plotting decision region<br/>  plot_decision_regions(x, y, clf=clf, legend=2)<br/>  # Adding axes annotations<br/>  plt.xlabel(X)<br/>  plt.ylabel(Y)<br/>  plt.title('Knn with K='+ str(9))<br/>  plt.show()</span><span id="2d83" class="ls lt iq mt b gy no nl l nm nn">tt = ['Pregnancies', 'Glucose', 'BloodPressure', 'SkinThickness', 'Insulin','BMI', 'DiabetesPedigreeFunction', 'Age']<br/>ll = len(tt)</span><span id="0bd6" class="ls lt iq mt b gy no nl l nm nn">for i in range(0,ll):<br/>  for j in range(i+1,ll):<br/>    ok(tt[i],tt[j])</span></pre><p id="3ed5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意:<em class="mu"> </em> <code class="fe mq mr ms mt b"><em class="mu">0 — Non Diabetic and 1 — Diabetic</em></code></p><div class="kg kh ki kj gt ab cb"><figure class="ny kk nz oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/9fd6b6c62f8820cba13e05e99a6fb819.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*R4iisepD-1nvY56UYODo3w.png"/></div></figure><figure class="ny kk oe oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/05c7e4f8a8f8d140a9385500c2bbdd6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*fEGXEUcuNzjIkkMN-zO5ng.png"/></div></figure><figure class="ny kk nz oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/060cc51ac0a6c9c7b60debd813cc1996.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*ITQM9bXqE90tBdTRfZhmEg.png"/></div></figure></div><div class="ab cb"><figure class="ny kk of oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/1a876a993102ab02b07b1bea29f08f33.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*egkAzYdDgiSjIy0M8t2Fzw.png"/></div></figure><figure class="ny kk og oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/09c1a7e70ab7e411cdd14f3f87335678.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*jgQgfKDsII2s1kpPND-Biw.png"/></div></figure><figure class="ny kk oh oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/7236a9ffd5c83fa882413abbd166552c.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*9vrhKqIRued4gVWgqPcx1Q.png"/></div></figure></div><div class="ab cb"><figure class="ny kk oi oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/49f5ee52f5d47a45ebe973f3f6da527a.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*ExhN0BsoPLwLDSv0YDj7Dw.png"/></div></figure><figure class="ny kk oj oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/006358d7e16e6f8893f737982270139a.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*CZURqvd3E1s7-3G1WSChvA.png"/></div></figure><figure class="ny kk ok oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/9ec1a933aebb1f32a747bb758be6ae5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*RBSWxtJ18daeR8jDY9o9cg.png"/></div></figure></div><div class="ab cb"><figure class="ny kk nz oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/1a88ac550bfd5718587f5f6ff19b964a.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*zURCuswZixxQHyLc04Lckw.png"/></div></figure><figure class="ny kk oe oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/e03a344f0e3bab0c802db06c655bdff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*RgwzJVOs1wGcy-V6mCkaRg.png"/></div></figure><figure class="ny kk nz oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/8da0157e890b5e1de3f6bef12899d981.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*qY5Peaf3jJIHbjqSp_PsBw.png"/></div></figure></div><div class="ab cb"><figure class="ny kk ol oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/cfe0772e6cc0862cd78f27b5727ed5d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*OYvsqARtMo4CE6JIH4IrJA.png"/></div></figure><figure class="ny kk ol oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/6a65f064d326db9f29d8ebc7aca25bf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*DguDRwvaBypdX6zBOXf6sA.png"/></div></figure><figure class="ny kk om oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/40afd5fa7c547c8f78d0ef288b4e6992.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*IR3HYmEjVB2_LSwIpyv51w.png"/></div></figure></div><div class="ab cb"><figure class="ny kk oi oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/f086dc7172b411661dc1aa73170cb623.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*ybOTE1Hx8yocOZY9t8jZEA.png"/></div></figure><figure class="ny kk oj oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/9b9414ab44347807cb90e4a7a23bd411.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*woePX7dNI3nYjNMZ2MiV3g.png"/></div></figure><figure class="ny kk ok oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/5596a951cfb4934ed7ccaa30dacf7470.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gGO43pTZW7J5l7Eb-mA5gQ.png"/></div></figure></div><div class="ab cb"><figure class="ny kk on oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/6ebea70b08004344a59090b11a594288.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*b5ZygOQwjK9MishzmhrEIg.png"/></div></figure><figure class="ny kk on oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/d5171a46e5ff74d957aa32065ea2235a.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*Na8vsMNH77M1aJcwvjpVIA.png"/></div></figure><figure class="ny kk oo oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/4124664d8d219a728e1754ab097bb0e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/1*mAmTpMC5kIjAl-IS7nDm4A.png"/></div></figure></div><div class="ab cb"><figure class="ny kk op oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/cddbfeea64d2b913d8c02c67bd163a35.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*6sF7PK1MeDuV5GfoGcwIGw.png"/></div></figure><figure class="ny kk oq oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/b03a9fa0307557c32fb95b641ab49394.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*O7kCUmax6htCSCbJnp4a7w.png"/></div></figure><figure class="ny kk ok oa ob oc od paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/d1c11b779c5885e6d8f6d0a24e07d253.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*gQHsMyTIJupvTWvndJlMbg.png"/></div></figure></div><div class="ab cb"><figure class="ny kk or oa ob oc od paragraph-image"><img src="../Images/ad6ee8872d447839582c32511fad6c0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*m6uHyyZqrlYMqTflCXLQJQ.png"/></figure><figure class="ny kk or oa ob oc od paragraph-image"><img src="../Images/475e51711fe63165a64c46916cce4d8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*bZeyJ3gjFEG4ZnJ3C5ibSg.png"/></figure></div><div class="ab cb"><figure class="ny kk os oa ob oc od paragraph-image"><img src="../Images/fdede1677d2cfd0775490231e632a293.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*ExV5BLKC6c08tUPSCvA6wA.png"/></figure><figure class="ny kk ot oa ob oc od paragraph-image"><img src="../Images/f40c65441d6f77b1e778167db6cd4bf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*sCYIMaDeGOY48N_lJ41Wkw.png"/></figure></div><h1 id="894c" class="mv lt iq bd lu mw mx my lx mz na nb ma jw nc jx md jz nd ka mg kc ne kd mj nf bi translated">4 数据预处理</h1><p id="563f" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">数据<strong class="ky ir"> Z </strong>重新调整为<strong class="ky ir"> μ = 0 </strong>和<strong class="ky ir"> ρ = 1 </strong>，应用此表:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/499bed88accac97046f9c22fea48a7da.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*bvX1oIWjhCVJ0EeurcOF0Q.png"/></div></figure><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="a225" class="ls lt iq mt b gy nk nl l nm nn">from sklearn.preprocessing import StandardScaler<br/>scaler = StandardScaler()</span><span id="9615" class="ls lt iq mt b gy no nl l nm nn">scaler.fit(df.drop('Outcome', axis = 1))</span><span id="33cb" class="ls lt iq mt b gy no nl l nm nn">scaler_features = scaler.transform(df.drop('Outcome', axis = 1))</span><span id="aa04" class="ls lt iq mt b gy no nl l nm nn">df_feat = pd.DataFrame(scaler_features, columns = df.columns[:-1])</span><span id="1a3c" class="ls lt iq mt b gy no nl l nm nn"># appending the outcome feature<br/>df_feat['Outcome'] = df['Outcome'].astype(int)</span><span id="9479" class="ls lt iq mt b gy no nl l nm nn">df = df_feat.copy()<br/>df.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/fdb9f942818d7d1193022a30f9cbecd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GV8Aca4rf25qOhSPMKmb_A.png"/></div></div></figure><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="76f5" class="ls lt iq mt b gy nk nl l nm nn"># to reverse scaler transformation</span><span id="2b04" class="ls lt iq mt b gy no nl l nm nn">#s = scaler.inverse_transform(df_feat)<br/>#df_feat = pd.DataFrame(s, columns = df.columns[:-1])</span></pre><h1 id="9662" class="mv lt iq bd lu mw mx my lx mz na nb ma jw nc jx md jz nd ka mg kc ne kd mj nf bi translated">5 KNN</h1><p id="41a3" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">裂开</p><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="bfd8" class="ls lt iq mt b gy nk nl l nm nn">X = df.drop('Outcome', axis = 1)<br/>y = df['Outcome']</span><span id="cae4" class="ls lt iq mt b gy no nl l nm nn">from sklearn.model_selection import train_test_split</span><span id="1642" class="ls lt iq mt b gy no nl l nm nn">X_train, X_test, y_train, y_test = train_test_split(  X, y, test_size=0.3, random_state=0)</span></pre><p id="85a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过获得从 1 到 100 范围内的每个 K 的接收器操作特性精度来检查最佳 K 值</p><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="1f3a" class="ls lt iq mt b gy nk nl l nm nn">import sklearn</span><span id="285a" class="ls lt iq mt b gy no nl l nm nn">tt = {}<br/>il = []<br/>ac=[]<br/>for  i in range(1,100):<br/>  from sklearn.neighbors import KNeighborsClassifier</span><span id="c6fc" class="ls lt iq mt b gy no nl l nm nn">knn = KNeighborsClassifier(n_neighbors=i)</span><span id="c2a8" class="ls lt iq mt b gy no nl l nm nn">knn.fit(X_train,y_train)</span><span id="b430" class="ls lt iq mt b gy no nl l nm nn">y_pred = knn.predict(X_test)</span><span id="8a2e" class="ls lt iq mt b gy no nl l nm nn">from sklearn.metrics import accuracy_score<br/>  il.append(i)<br/>  ac.append( sklearn.metrics.roc_auc_score(y_test,y_pred) )</span><span id="b6e8" class="ls lt iq mt b gy no nl l nm nn">tt.update({'K':il})<br/>  tt.update({'ROC_ACC':ac})</span><span id="79a1" class="ls lt iq mt b gy no nl l nm nn">vv = pd.DataFrame(tt)<br/>vv.sort_values('ROC_ACC',ascending=False,inplace=True,ignore_index=True)<br/>vv.head(10)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/5e30095dd1224a240ea88e77d57d9cc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:278/format:webp/1*gCYA4N8NOu7jniVNv-Gjag.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">对应 K 值的前 10 个最佳 ROC 准确度</p></figure><p id="3eac" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">选择“k = 9”</p><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="b9df" class="ls lt iq mt b gy nk nl l nm nn">from sklearn.neighbors import KNeighborsClassifier</span><span id="bada" class="ls lt iq mt b gy no nl l nm nn">knn = KNeighborsClassifier(n_neighbors=9)</span><span id="5278" class="ls lt iq mt b gy no nl l nm nn">knn.fit(X_train,y_train)</span><span id="8dff" class="ls lt iq mt b gy no nl l nm nn">y_pred = knn.predict(X_test)</span><span id="1ad7" class="ls lt iq mt b gy no nl l nm nn">from sklearn.metrics import classification_report<br/>print(classification_report(y_test,y_pred))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/dbcaa3dd7e4714c311485268b99db8e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*3b82a2Au4sSFAUbpFkRvzQ.png"/></div></figure><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="bc89" class="ls lt iq mt b gy nk nl l nm nn">from sklearn.metrics import confusion_matrix<br/>print(confusion_matrix(y_test,y_pred))<br/>sns.heatmap(confusion_matrix(y_test,y_pred),annot=True)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/79749b34a297506e5d125dd4851b71d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*EncWtvPyjvBbozCItleq5w.png"/></div></figure><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="1a4d" class="ls lt iq mt b gy nk nl l nm nn">from sklearn.metrics import roc_curve<br/>plt.figure(dpi=100)<br/>fpr, tpr, thresholds = roc_curve(y_test, y_pred)<br/>plt.plot(fpr,tpr,label = "%.2f" %sklearn.metrics.roc_auc_score(y_test,y_pred))<br/>plt.legend(loc = 'lower right')</span><span id="538a" class="ls lt iq mt b gy no nl l nm nn">plt.xlim([0.0, 1.0])<br/>plt.ylim([0.0, 1.0])<br/>plt.title('ROC curve for Diabetes classifier')<br/>plt.xlabel('False positive rate (1-Specificity)')<br/>plt.ylabel('True positive rate (Sensitivity)')</span><span id="0a64" class="ls lt iq mt b gy no nl l nm nn">plt.grid(True)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/af6d2afd276f90fa698a9d6cd4bd30b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*pKDe0KKKviX3f5IQ_ElTfw.png"/></div></figure><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="bfbd" class="ls lt iq mt b gy nk nl l nm nn">import sklearn<br/>sklearn.metrics.roc_auc_score(y_test,y_pred)</span></pre><p id="4f53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe mq mr ms mt b">0.7399724565329662</code></p><pre class="kg kh ki kj gt ng mt nh ni aw nj bi"><span id="d1cd" class="ls lt iq mt b gy nk nl l nm nn">data = {'test':y_test.values.ravel(),'pred':y_pred.ravel(),'number':np.arange(0,len(y_test))}</span><span id="975f" class="ls lt iq mt b gy no nl l nm nn">pt = pd.DataFrame(data)</span><span id="61f9" class="ls lt iq mt b gy no nl l nm nn">pt.iplot(<br/>            kind='scatter',<br/>            x='number',<br/>            y=['test','pred'], <br/>            color=['white','yellow'],<br/>            theme='solar',<br/>            mode='lines+markers'<br/>          )</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pa"><img src="../Images/8370939dd22a76dd2495145848d70b72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e84M8CPnwywWMqs-D28TTw.png"/></div></div></figure></div></div>    
</body>
</html>