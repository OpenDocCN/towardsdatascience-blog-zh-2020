<html>
<head>
<title>Tweets, Emoji Sentiment Analysis using Q Blocks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æ¨æ–‡ï¼Œä½¿ç”¨ Q å—çš„è¡¨æƒ…ç¬¦å·æƒ…æ„Ÿåˆ†æ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/tweets-emoji-sentiment-analysis-using-q-blocks-495e24d7e1c0?source=collection_archive---------35-----------------------#2020-06-27">https://towardsdatascience.com/tweets-emoji-sentiment-analysis-using-q-blocks-495e24d7e1c0?source=collection_archive---------35-----------------------#2020-06-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="fccd" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">è‡ªç„¶è¯­è¨€å¤„ç†</h2><div class=""/><div class=""><h2 id="1fbc" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">æˆ‘ç¬¬ä¸€æ¬¡å°è¯•ç§Ÿ GPU åŠ é€Ÿè½¯ä»¶ã€‚åœ¨æˆ‘çš„å›è´­ä¸­å¯è·å¾—å…¨éƒ¨ä»£ç ã€‚</h2></div><p id="01f1" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">åœ¨ä¸‹é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘å°†ç§Ÿç”¨<a class="ae kr" href="https://www.qblocks.cloud/" rel="noopener ugc nofollow" target="_blank"> Q Blocks </a> GPU æ¥è¿è¡Œä¸€ä¸ªè®¡ç®—è¦æ±‚è‹›åˆ»çš„ AI æ¨¡å‹ã€‚æˆ‘å°†è¿è¡Œä¸€ä¸ªåä¸º<a class="ae kr" href="https://deepmoji.mit.edu/" rel="noopener ugc nofollow" target="_blank"> DeepMoji </a>çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œç»™å®šä¸€ä¸ªå¥å­ï¼Œè¯¥æ¨¡å‹å°†ä¼°è®¡å‡ºå¯ä»¥æè¿°è¯¥å¥å­çš„å‰ n ç§æƒ…ç»ª(å•å‡»éé“¾æ¥è¿›è¡Œå°è¯•)ã€‚æˆ‘å°†ç§Ÿç”¨ GPU çš„å¹³å°ä»ç„¶å¤„äºæ—©æœŸè®¿é—®é˜¶æ®µï¼Œæ‰€ä»¥ä½ å¯ä»¥åœ¨è´­ä¹°ä¹‹å‰è¯•ç”¨å®ƒ(è¿™ä¸ªå¹³å°ä¸ºä½ æä¾› 20 å°æ—¶çš„å…è´¹ GPUï¼Œä¸€ä¸ªå¾ˆå¥½çš„å¼€å§‹)ï¼Œçœ‹çœ‹ä½ æ˜¯å¦é€‚åº”å®ƒã€‚</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/468e1b105105b2fae98dc6ce7c905a35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8yZh5y-nq2G5QJIhfLXBfg.jpeg"/></div></div></figure><h1 id="9f54" class="ma mb it bd mc md me mf mg mh mi mj mk ki ml kj mm kl mn km mo ko mp kp mq mr bi translated">ç§Ÿ Q å— GPU</h1><p id="4215" class="pw-post-body-paragraph ks kt it ku b kv ms kd kx ky mt kg la lb mu ld le lf mv lh li lj mw ll lm ln im bi translated">ä¸ºäº†è¿›è¡Œè¿™ä¸ªå®éªŒï¼Œæˆ‘æƒ³ä»æ›¿ä»£æä¾›å•†è€Œä¸æ˜¯äºšé©¬é€Š AWS ç§Ÿèµ GPUï¼Œæˆ‘è¢«å‘ŠçŸ¥è¿™å¾ˆè´µã€‚ï¼Œåªæœ‰åœ¨è¿è¡Œå·¨å¤§çš„æ¨¡å‹æ—¶æ‰å˜å¾—æ–¹ä¾¿ã€‚</p><p id="f263" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘å‘ç°ä¸€ä¸ªå¾ˆå¥½çš„æè®®å°è¯• Q å— GPUã€‚GPU ä¸æ˜¯ç”¨ä½¿ç”¨é‡ä¹°çš„ï¼Œæ˜¯ç”¨æ—¶é—´ä¹°çš„ã€‚è¿™é¡¹æœåŠ¡æ¯å°æ—¶åªéœ€ 0.05 ç¾å…ƒã€‚æ˜¯ä¸€ä¸ªéå¸¸åˆç†çš„ä»·æ ¼ï¼Œä½ å°†åŸºæœ¬ä¸Šæ”¯ä»˜ç›¸åŒçš„ CPU æˆæœ¬çš„ GPUã€‚Q Blocks ä½¿ç”¨çš„åˆ†å¸ƒå¼è®¡ç®—æŠ€æœ¯å…è®¸è¯¥æä¾›å•†åœ¨ä¸é™ä½è´¨é‡çš„æƒ…å†µä¸‹ä¿æŒä½ä»·ã€‚</p><h2 id="d5db" class="mx mb it bd mc my mz dn mg na nb dp mk lb nc nd mm lf ne nf mo lj ng nh mq iz bi translated">ä¹° GPU æœ‰å¿…è¦å—ï¼Ÿ</h2><p id="55a0" class="pw-post-body-paragraph ks kt it ku b kv ms kd kx ky mt kg la lb mu ld le lf mv lh li lj mw ll lm ln im bi translated">å¦‚æœä½ æ˜¯åˆå­¦è€…ï¼Œè‚¯å®šä¸æ˜¯ã€‚å¸¸è§çš„åœ¨çº¿ç¼–è¯‘å™¨ï¼Œå¦‚ Google Colab æˆ– Kaggleï¼Œæä¾›äº†å…è´¹(ä½†ä¸å¼ºå¤§)çš„è®¡ç®—èƒ½åŠ›ã€‚å¦‚æœæ‚¨åƒæ¯ä¸ªåˆå­¦è€…ä¸€æ ·å¤„ç†å°æ•°æ®é›†ï¼Œå®ƒä¸éœ€è¦å¾ˆé«˜çš„è®¡ç®—èƒ½åŠ›ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å…è´¹ç‰ˆæœ¬ã€‚</p><p id="cdaa" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">ç›¸åï¼Œå¦‚æœä½ éœ€è¦è°ƒæ•´ä½ çš„æ¨¡å‹(å°±åƒæ¯ä¸ªä¸“ä¸šäººå£«éœ€è¦çš„é‚£æ ·)ï¼Œä½ å°†ä¸å¾—ä¸åœ¨ç”µè„‘å‰ç­‰å¾…æ— æ•°ä¸ªå°æ—¶ï¼Œç­‰å¾…å¯èƒ½ä¼šè®©ä½ å¤±æœ›çš„ç»“æœã€‚å»ºç«‹æ›´å…·æŒ‘æˆ˜æ€§çš„æ¨¡å‹çš„å‰ä¸€æ­¥æ˜¯å¢åŠ ä½ çš„è®¡ç®—èƒ½åŠ›ã€‚</p><p id="1d3d" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">ä¾‹å¦‚ï¼Œåœ¨ä¸ä½¿ç”¨ GPU çš„æƒ…å†µä¸‹è¿è¡Œè¿™ä¸ªç®—æ³•å°†éœ€è¦æˆ‘å‡ ä¸ªå°æ—¶æ‰èƒ½å®Œæˆã€‚æˆ‘çš„å®éªŒåœ¨äºæ›´å¿«åœ°å®Œæˆè¿™ä¸ªé¡¹ç›®ã€‚</p><h2 id="e4a2" class="mx mb it bd mc my mz dn mg na nb dp mk lb nc nd mm lf ne nf mo lj ng nh mq iz bi translated">å¦‚ä½•é«˜æ•ˆä½¿ç”¨ QBlocks:ä¸æµªè´¹ GPUï¼</h2><p id="8403" class="pw-post-body-paragraph ks kt it ku b kv ms kd kx ky mt kg la lb mu ld le lf mv lh li lj mw ll lm ln im bi translated">æˆ‘å°†ä½¿ç”¨æ­¤æœåŠ¡çš„æˆªå›¾æ¥ç®€åŒ–äº‹æƒ…ã€‚ç„¶è€Œï¼Œæˆ‘å‡è®¾æ¯ä¸ªä¾›åº”å•†éƒ½æ ¹æ®ä½ çš„éœ€æ±‚æä¾›ä¸åŒçš„æœåŠ¡ã€‚å› ä¸ºæˆ‘ä¸éœ€è¦è¿‡å¤šçš„è®¡ç®—èƒ½åŠ›ï¼Œæ‰€ä»¥æˆ‘å¯ä»¥æ¯å°æ—¶ä½¿ç”¨ 100 ä¸ªå—ï¼Œç›¸å½“äºæ¯å°æ—¶ 0.10 ç¾å…ƒã€‚</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/1d8d92b049f9524a5a297a18850cdd9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*Z4d2oS9ONzLh4iKYTqHEbQ.png"/></div></figure><p id="2fab" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">å¦‚æœè¿™æ˜¯ä½ ç¬¬ä¸€æ¬¡ç§Ÿç”¨ GPUï¼Œä½ å¯èƒ½ä¼šæ„Ÿåˆ°æ²®ä¸§ã€‚å½“ä½ å¯åŠ¨æ¨¡å‹æ—¶ï¼Œå®ƒå°†å¼€å§‹æ¶ˆè€—ã€‚å› æ­¤ï¼Œè‡³å…³é‡è¦çš„æ˜¯ï¼Œä½ çŸ¥é“ä½ åœ¨åšä»€ä¹ˆï¼Œä½ ä¸è¦åœ¨æœåŠ¡æä¾›çš„ç¬”è®°æœ¬ä¸Šåšå®éªŒã€‚å¦‚æœæœ‰é”™è¯¯ï¼Œä½ éœ€è¦åœ¨ä»˜è´¹çš„å·¥ä½œç°¿ä¸­è°ƒè¯•ä½ çš„ä»£ç ï¼Œä½ çš„æ—¶é—´å°†ä¼šæ˜¯æ˜‚è´µçš„ã€‚å½“ä½ æ„è¯†åˆ°è°ƒè¯•æ—¶é—´èŠ±è´¹äº†ä½ å¤šå°‘é’±æ—¶ï¼Œä½ å¯èƒ½ä¼šè½¬å‘å¦ä¸€å®¶ GPU æä¾›å•†ã€‚</p><p id="6c73" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">* * *ç¡®ä¿æ‚¨åœ¨å¦ä¸€ä¸ªå·¥ä½œç°¿ä¸­æœ‰ä¸€ä¸ªå·¥ä½œæ¨¡å‹çš„å‰¯æœ¬ã€‚æ‚¨å¯ä»¥ç®€å•åœ°å¯¼å…¥å¹¶è¿è¡Œè¯¥å‰¯æœ¬ï¼Œè€Œä¸ä¼šæµªè´¹å®è´µçš„æ—¶é—´ã€‚</p><p id="d014" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">Q Blocks ä¸åœ¨çº¿ Jupyter ç¬”è®°æœ¬æœ‰å…³è”ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨ Google Colab ä¸­å¼€å§‹ä½ çš„æ¨¡å‹ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›é—®é¢˜ã€‚è®¿é—®æ–‡ä»¶æˆ–ä¸‹è½½åº“çš„è¯­æ³•ç•¥æœ‰ä¸åŒï¼Œå½“æ‚¨çš„ç¬”è®°æœ¬æ­£åœ¨è¿è¡Œæ—¶ï¼Œæ‚¨å¯èƒ½ä¼šæµªè´¹æ—¶é—´åœ¨ç½‘ä¸Šæœç´¢è§£å†³æ–¹æ¡ˆã€‚å› ä¸ºæˆ‘åœ¨åˆ¶ä½œè¿™ä¸ªæ¨¡å‹æ—¶é‡åˆ°äº†ç±»ä¼¼çš„é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘å°†è¯¦ç»†è¯´æ˜å¦‚ä½•å…‹æœè§£å†³æ–¹æ¡ˆã€‚</p><p id="d663" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">å› æ­¤ï¼Œåœ¨å…è´¹ Jupyter å·¥ä½œç°¿ä¸­ç¼–å†™æ‚¨çš„æ¨¡å‹ä¹‹å‰ï¼Œå¦‚æœå®ƒå¯ä»¥å·¥ä½œï¼Œé‚£ä¹ˆåœ¨æ‚¨ä½¿ç”¨çš„å¹³å°ä¸Šå¯¼å…¥è¯¥æ¨¡å‹(åœ¨æˆ‘çš„ä¾‹å­ä¸­æ˜¯ Q å—)ä»¥èŠ‚çœæ—¶é—´ã€‚</p><p id="1a44" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">æä¾›å•†å¯èƒ½ä¼šå¯åŠ¨ä¸€ä¸ªåŠ è½½äº† GPU çš„ç©ºç¬”è®°æœ¬ã€‚æˆ‘ä»¬å¯ä»¥å¼€å§‹ç¼–ç äº†â€¦</p><h1 id="a8eb" class="ma mb it bd mc md me mf mg mh mi mj mk ki ml kj mm kl mn km mo ko mp kp mq mr bi translated">å¯¼å…¥æ•°æ®é›†</h1><p id="b92a" class="pw-post-body-paragraph ks kt it ku b kv ms kd kx ky mt kg la lb mu ld le lf mv lh li lj mw ll lm ln im bi translated">æ‚¨è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯å¯¼å…¥æ‚¨å¯ä»¥è®¿é—®çš„æ•°æ®é›†ã€‚æ¯ä¸ªç¬”è®°æœ¬éƒ½æœ‰ä¸€ä¸ªä¸Šä¼ æ–‡æ¡£çš„éƒ¨åˆ†ï¼Œæˆ‘ç¨åä¼šåˆ›å»ºä¸€ä¸ªåˆ°é‚£ä¸ªæ–‡æ¡£çš„è¿æ¥ï¼Œç”¨ç†ŠçŒ«å¯¼å…¥å®ƒã€‚</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/eacac49645127800383dffb6222a72ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*dtYwZ9elWQYIQYfC1iEgsw.png"/></div></figure><h1 id="9c8b" class="ma mb it bd mc md me mf mg mh mi mj mk ki ml kj mm kl mn km mo ko mp kp mq mr bi translated">ç«ç‚¬è£…ç½®</h1><p id="9007" class="pw-post-body-paragraph ks kt it ku b kv ms kd kx ky mt kg la lb mu ld le lf mv lh li lj mw ll lm ln im bi translated">å¾ˆå¯èƒ½ï¼Œåœ¨å°è¯•è¿™ä¸ªå®éªŒæ—¶ï¼Œæœ€å›°éš¾çš„äº‹æƒ…æ˜¯å®‰è£… torchMojiã€‚æˆ‘å°†æŠŠè¿™ä¸ªè£…ç½®åˆ†æˆä¸¤éƒ¨åˆ†ã€‚é¦–å…ˆï¼Œæˆ‘å°†å®‰è£…è¿è¡Œ torchMoji æ‰€éœ€çš„åº“:</p><pre class="lp lq lr ls gt nk nl nm nn aw no bi"><span id="f970" class="mx mb it nl b gy np nq l nr ns">!pip3 install torch==1.0.1 -f <a class="ae kr" href="https://download.pytorch.org/whl/cpu/stable" rel="noopener ugc nofollow" target="_blank">https://download.pytorch.org/whl/cpu/stable</a> <br/>!git clone <a class="ae kr" href="https://github.com/huggingface/torchMoji" rel="noopener ugc nofollow" target="_blank">https://github.com/huggingface/torchMoji</a><br/>import os<br/>os.chdir('torchMoji')<br/>!pip3 install -e .<br/>#if you restart the package, the notebook risks to crash on a loop<br/>#if you managed to be curious and to make it stuck, just clic on RunTime, Factory Reset Runtime<br/>#I did not restart and worked fine</span><span id="c2e5" class="mx mb it nl b gy nt nq l nr ns">#se questo funziona, poi crasha in future linee di codice, anche se chiudiamo e riapriamo dovrebbe essere a posto per 12 ore</span></pre><p id="e9bb" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">ç¬¬äºŒæ­¥ï¼Œæˆ‘å°†ä¸‹è½½å¹¶å®‰è£…æƒé‡ï¼Œè¿™å°†å…è®¸ç¥ç»ç½‘ç»œåŸºäºä»»ä½•æ–‡æœ¬é€‰æ‹©è¡¨æƒ…ç¬¦å·ã€‚</p><p id="a1b2" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">* * *éå¸¸å°å¿ƒï¼ŒJupyter Notebook ä¸­æœ‰ä¸€ä¸ªé”™è¯¯(æˆ‘ä¸çŸ¥é“æˆ‘æ˜¯å¦å¯ä»¥å°†å…¶å½’ç±»ä¸ºé”™è¯¯),å®ƒé˜»æ­¢æ‚¨è¾“å…¥æ˜¯æˆ–å¦ä¹‹ç±»çš„ç­”æ¡ˆã€‚è¦è§£å†³æ­¤é—®é¢˜å¹¶é˜²æ­¢æ‚¨çš„ GPU åœ¨å¾ªç¯ä¸­è¿­ä»£ï¼Œä»è€Œæ¶ˆè€—æ‚¨çš„å¯ç”¨å¤„ç†èƒ½åŠ›ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹ä»£ç è¡Œè§£å†³ Jupyter Notebook ä¸­çš„é—®é¢˜ã€‚</p><pre class="lp lq lr ls gt nk nl nm nn aw no bi"><span id="0d26" class="mx mb it nl b gy np nq l nr ns">#!python3 scripts/download_weights.py<br/>! yes | python3 scripts/download_weights.py</span></pre><p id="a0ec" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">åœ¨ä¼ ç»Ÿçš„ç¬”è®°æœ¬ä¸­ï¼Œä½ åº”è¯¥è¢«å…è®¸åœ¨é€‰é¡¹<strong class="ku jd">æ˜¯å’Œå¦</strong>ä¹‹é—´è¿›è¡Œé€‰æ‹©ã€‚ç„¶è€Œï¼ŒJupyter Notebook æ²¡æœ‰ä¸ºæ‚¨æä¾›ä»»ä½•è¾“å…¥é€‰æ‹©çš„å¯èƒ½æ€§ã€‚æˆ‘ä½¿ç”¨ä¸Šé¢çš„ä»£ç ç»•è¿‡äº†å®ƒï¼Œå¹¶ç«‹å³å£°æ˜äº†<strong class="ku jd"> yes </strong>é€‰æ‹©ã€‚</p><h2 id="8f0c" class="mx mb it bd mc my mz dn mg na nb dp mk lb nc nd mm lf ne nf mo lj ng nh mq iz bi translated">å®šä¹‰è½¬æ¢å‡½æ•°</h2><p id="98c3" class="pw-post-body-paragraph ks kt it ku b kv ms kd kx ky mt kg la lb mu ld le lf mv lh li lj mw ll lm ln im bi translated">æˆ‘ç°åœ¨å°†åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œä½œä¸ºè¾“å…¥ï¼Œå®ƒå°†æ¥å—ä¸€ä¸ªæ–‡æœ¬å­—ç¬¦ä¸²ï¼Œå¹¶æ ¹æ®æˆ‘ä»¬æƒ³è¦æå–çš„æƒ…ç»ªæ•°é‡ï¼Œè¾“å‡ºç›¸åº”çš„è¡¨æƒ…ç¬¦å·ã€‚</p><pre class="lp lq lr ls gt nk nl nm nn aw no bi"><span id="2fa3" class="mx mb it nl b gy np nq l nr ns">#si connette a DeepMoji per una request, non posso modificare i parametri, credo<br/>!python3 examples/text_emojize.py --text f" {Stay safe from the virus} "</span><span id="2e61" class="mx mb it nl b gy nt nq l nr ns">!pip3 install --upgrade numpy</span><span id="3164" class="mx mb it nl b gy nt nq l nr ns">!pip install numpy==1.18<br/>!pip install scipy==1.1.0<br/>!pip install scikit-learn==0.21.3</span><span id="a5f8" class="mx mb it nl b gy nt nq l nr ns">import numpy as np<br/>import emoji, json<br/>from torchmoji.global_variables import PRETRAINED_PATH, VOCAB_PATH<br/>from torchmoji.sentence_tokenizer import SentenceTokenizer<br/>from torchmoji.model_def import torchmoji_emojis<br/>  <br/>EMOJIS = ":joy: :unamused: :weary: :sob: :heart_eyes: :pensive: :ok_hand: :blush: :heart: :smirk: :grin: :notes: :flushed: :100: :sleeping: :relieved: :relaxed: :raised_hands: :two_hearts: :expressionless: :sweat_smile: :pray: :confused: :kissing_heart: :heartbeat: :neutral_face: :information_desk_person: :disappointed: :see_no_evil: :tired_face: :v: :sunglasses: :rage: :thumbsup: :cry: :sleepy: :yum: :triumph: :hand: :mask: :clap: :eyes: :gun: :persevere: :smiling_imp: :sweat: :broken_heart: :yellow_heart: :musical_note: :speak_no_evil: :wink: :skull: :confounded: :smile: :stuck_out_tongue_winking_eye: :angry: :no_good: :muscle: :facepunch: :purple_heart: :sparkling_heart: :blue_heart: :grimacing: :sparkles:".split(' ')<br/>model = torchmoji_emojis(PRETRAINED_PATH)<br/>with open(VOCAB_PATH, 'r') as f:<br/>  vocabulary = json.load(f)<br/>st = SentenceTokenizer(vocabulary, 30)</span><span id="06dc" class="mx mb it nl b gy nt nq l nr ns">def deepmojify(sentence, top_n=5, return_emoji=True, return_prob=False):<br/>  #converte lista probabilitÃ  in emoticon piÃ¹ probabili<br/>  def top_elements(array, k):<br/>    ind = np.argpartition(array, -k)[-k:]<br/>    return ind[np.argsort(array[ind])][::-1]</span><span id="b1ec" class="mx mb it nl b gy nt nq l nr ns">tokenized, _, _ = st.tokenize_sentences([sentence])<br/>  #print(tokenized)<br/>  #lista di probabilitÃ <br/>  prob = model(tokenized)[0]<br/>  #se ci sono errori parte da qui: too many values to unpack (expected 2), non riesce a trovare prob<br/>  #trova le n emoticono piÃ¹ alte <br/>  emoji_ids = top_elements(prob, top_n)</span><span id="0e4d" class="mx mb it nl b gy nt nq l nr ns">#converte questi numeri in emoticons<br/>  emojis = map(lambda x: EMOJIS[x], emoji_ids)<br/>  <br/>  if return_emoji == False and return_prob == False:<br/>    return None<br/>  elif return_emoji == True and return_prob == False:<br/>    return emoji.emojize(f"{sentence} {' '.join(emojis)}", use_aliases=True)<br/>  elif return_emoji == True and return_prob == True:<br/>    return emoji.emojize(f"{sentence} {' '.join(emojis)}", use_aliases=True), prob<br/>  elif return_emoji == False and return_prob == True:<br/>    return prob<br/>deepmojify('ciao, come stai?', top_n=3, return_emoji=True, return_prob=False)</span></pre><p id="e812" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">è¾“å…¥å­—ç¬¦ä¸²çš„è¾“å‡ºå¦‚ä¸‹:</p><pre class="lp lq lr ls gt nk nl nm nn aw no bi"><span id="313e" class="mx mb it nl b gy np nq l nr ns">'ciao, come stai? ğŸ’“ ğŸ’› â¤'</span></pre><h2 id="413f" class="mx mb it bd mc my mz dn mg na nb dp mk lb nc nd mm lf ne nf mo lj ng nh mq iz bi translated">å®šä¹‰æˆ‘ä»¬çš„ä¸»è¦åŠŸèƒ½</h2><p id="11b6" class="pw-post-body-paragraph ks kt it ku b kv ms kd kx ky mt kg la lb mu ld le lf mv lh li lj mw ll lm ln im bi translated">æˆ‘ç°åœ¨å°†åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œå°†ä¸€ä¸ªåˆ—è¡¨è½¬æ¢ä¸ºä¸€ä¸ªæ•°æ®é›†ï¼Œå…¶ä¼°è®¡çš„è¡¨æƒ…ç¬¦å·ä½äºä¸åŒçš„åˆ—ä¸­ã€‚æ­£å¦‚ä½ åœ¨ä¸Šé¢çš„å­—ç¬¦ä¸²ä¸­çœ‹åˆ°çš„ï¼Œè¿™ä¸ªå‡½æ•°å°†è¡¨æƒ…ç¬¦å·å’Œè¾“å…¥å­—ç¬¦ä¸²è¿æ¥åœ¨ä¸€èµ·ï¼Œæˆ‘å°†æŠŠå®ƒä»¬åˆ†å¼€ï¼Œåˆ†åˆ«æ”¾åœ¨æ•°æ®é›†çš„ä¸åŒåˆ—ä¸­ã€‚</p><pre class="lp lq lr ls gt nk nl nm nn aw no bi"><span id="0127" class="mx mb it nl b gy np nq l nr ns">def emoji_dataset(list1, n_emoji=3, only_prob=False):<br/>  emoji_list = [[x] for x in list1]</span><span id="a6cf" class="mx mb it nl b gy nt nq l nr ns">for _ in range(len(list1)):<br/>    for n_emo in range(1, n_emoji+1):<br/>      print(_)<br/>      if only_prob == False:<br/>        emoji_list[_].append(deepmojify(list1[_], top_n=n_emoji, return_emoji=True, return_prob=False)[2*-n_emo+1])<br/>      else:<br/>        emoji_list[_].append(deepmojify(list1[_], top_n=1, return_emoji=False, return_prob=True))</span><span id="5231" class="mx mb it nl b gy nt nq l nr ns">emoji_list = pd.DataFrame(emoji_list)<br/>  return emoji_list</span><span id="f49b" class="mx mb it nl b gy nt nq l nr ns">df_ = emoji_dataset(list1, 3)<br/>df_</span></pre><h2 id="b758" class="mx mb it bd mc my mz dn mg na nb dp mk lb nc nd mm lf ne nf mo lj ng nh mq iz bi translated">ä¸‹è½½æ•°æ®é›†</h2><p id="e1b7" class="pw-post-body-paragraph ks kt it ku b kv ms kd kx ky mt kg la lb mu ld le lf mv lh li lj mw ll lm ln im bi translated">ç°åœ¨æˆ‘å·²ç»å‡†å¤‡å¥½äº†ï¼Œæˆ‘å¯ä»¥è¿è¡Œæ•´ä¸ªé¡¹ç›®äº†ã€‚æˆ‘ä¼šä¸‹è½½æ•°æ®é›†ï¼Œå¿«é€Ÿé¢„å¤„ç†ï¼Œç„¶åå¯åŠ¨ç®—æ³•ã€‚</p><pre class="lp lq lr ls gt nk nl nm nn aw no bi"><span id="001f" class="mx mb it nl b gy np nq l nr ns">import pandas as pd<br/>X = pd.read_csv(open('tweets.csv'))</span></pre><p id="022d" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">å¦‚æœä½ è¿˜æ²¡æœ‰æ³¨æ„åˆ°ï¼Œæˆ‘æ­£åœ¨ä½¿ç”¨<strong class="ku jd"> read_csv </strong>é‡Œé¢çš„å‡½æ•°<strong class="ku jd"> open </strong>ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªå‡½æ•°ï¼Œä»£ç å°†è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚è¿™ç§è¡Œä¸ºæ˜¯æœ±åº‡ç‰¹ç¬”è®°æœ¬æ‰€ç‰¹æœ‰çš„ã€‚</p><pre class="lp lq lr ls gt nk nl nm nn aw no bi"><span id="29ce" class="mx mb it nl b gy np nq l nr ns">X.pop('Unnamed: 0')<br/>X = pd.DataFrame(X)<br/>X.columns = ['tweets']<br/>X</span><span id="f621" class="mx mb it nl b gy nt nq l nr ns">df = X.copy()<br/>df</span></pre><p id="a5fb" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">ä½œä¸ºæœ€åä¸€æ­¥ï¼Œæˆ‘å°†æŠŠ 25000 æ¡æ¨æ–‡çš„åˆ—è¡¨å˜æˆä¸€ä¸ªåˆ—è¡¨ã€‚æˆ‘å¯ä»¥ä½¿ç”¨è¿™ä¸ªåˆ—è¡¨ä½œä¸ºä¸»å‡½æ•°çš„è¾“å…¥ã€‚</p><pre class="lp lq lr ls gt nk nl nm nn aw no bi"><span id="5065" class="mx mb it nl b gy np nq l nr ns">list1 = df['tweets'].to_list()</span></pre><p id="452b" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">æˆ‘ç»ˆäºå¯ä»¥å¼€å§‹æ¨¡å‹äº†ã€‚å› æ­¤ï¼Œæˆ‘å°†æ‹¥æœ‰ 25000 æ¡å¸¦æœ‰ç›¸åº”æƒ…ç»ªçš„æ¨æ–‡åˆ—è¡¨ã€‚</p><pre class="lp lq lr ls gt nk nl nm nn aw no bi"><span id="3f24" class="mx mb it nl b gy np nq l nr ns">list1 = list1[0:25000]<br/>df_.to_csv('25k_emotions.csv')<br/>df_</span></pre><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/966e6c0370208749c9e392f4bf4cb1bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*XlPbuMuAy9_tRDh0GWgp_g.png"/></div><p class="nv nw gj gh gi nx ny bd b be z dk translated">è¾“å‡ºçš„ç¤ºä¾‹</p></figure><p id="402b" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">å½“æ‚¨çš„æ¨¡å‹è®¾ç½®å¥½åï¼Œä¸è¦å¿˜è®°åˆ é™¤ç¬”è®°æœ¬ä»¥ä¿å­˜æ‚¨å‰©ä½™çš„å­¦åˆ†ã€‚</p><h2 id="0085" class="mx mb it bd mc my mz dn mg na nb dp mk lb nc nd mm lf ne nf mo lj ng nh mq iz bi translated">ç»“è®º</h2><p id="4b1e" class="pw-post-body-paragraph ks kt it ku b kv ms kd kx ky mt kg la lb mu ld le lf mv lh li lj mw ll lm ln im bi translated">è¯¥æ¨¡å‹çš„æ‰§è¡Œé€Ÿåº¦ç›¸å¯¹è¾ƒå¿«ã€‚ä¸ GPU ç›¸æ¯”ï¼Œå…è´¹çš„äº‘ç¼–è¯‘å™¨å¯ä»¥è¾¾åˆ°å¿« 10 å€çš„é€Ÿåº¦ã€‚åœ¨ Google Colab ä¸Šè¿è¡Œè¿™ä¸ªç®—æ³•éœ€è¦ 1 ä¸ªå¤šå°æ—¶ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼Œæˆ‘ä½¿ç”¨ Q å—å¤§çº¦éœ€è¦ 10 åˆ†é’Ÿæ‰èƒ½è¾¾åˆ°ç›¸åŒçš„ç»“æœã€‚å¦‚æœä½ æ‰“ç®—ç§Ÿç”¨æ›´å¼ºå¤§çš„ GPUï¼Œæ ¹æ®ä½ çš„éœ€æ±‚ï¼Œè¿™ä¸ªæ•°å­—åªä¼šå¢åŠ ã€‚</p><p id="c9ae" class="pw-post-body-paragraph ks kt it ku b kv kw kd kx ky kz kg la lb lc ld le lf lg lh li lj lk ll lm ln im bi translated">äº‘è®¡ç®—å¾ˆå¿«å°†æˆä¸ºæ–°çš„è§„èŒƒã€‚æœ‰äº†åŒºå—é“¾å’Œåƒç´ æµæŠ€æœ¯ç­‰é©å‘½æ€§åˆ›æ–°ï¼Œäººä»¬å°†ä¸å†éœ€è¦è´­ä¹° GPU ç¡¬ä»¶ã€‚åƒ Q Blocks è¿™æ ·ä½¿ç”¨å¯¹ç­‰è®¡ç®—çš„æä¾›å•†ï¼Œé€šè¿‡ä½¿è®¡ç®—èƒ½åŠ›æ›´å®¹æ˜“è·å¾—ï¼ŒåŠ é€Ÿåˆ›æ–°ï¼Œåšå‡ºäº†è´¡çŒ®ã€‚</p></div></div>    
</body>
</html>