<html>
<head>
<title>CNN Approach: Using Image of the Polymer to Predict its Glass Transition Temperature</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CNN 方法:利用聚合物图像预测其玻璃化转变温度</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cnn-approach-using-image-of-the-polymer-to-predict-its-glass-transition-temperature-4a64ee450450?source=collection_archive---------23-----------------------#2020-08-01">https://towardsdatascience.com/cnn-approach-using-image-of-the-polymer-to-predict-its-glass-transition-temperature-4a64ee450450?source=collection_archive---------23-----------------------#2020-08-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="e716" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我们将使用聚合物结构的图像来预测其玻璃化转变温度。这篇文章采用了与西班牙材料物理中心和 Donostia 国际物理中心的 Luis.A. Miccio 最近发表的一篇研究论文相似的方法。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/8efc190e4ff1b62f899f683397ba7ceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QR6zeUTi-T-WIy47cTbzSQ.png"/></div></div></figure><h1 id="a75e" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">简介:</strong></h1><p id="c224" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">玻璃化转变温度是聚合物的重要性质之一。它标志着过冷液体的原子在冷却时暂时冻结(不结晶)的温度范围。预测玻璃化转变温度(Tg)提供了对聚合物性质的有价值的见解，否则其合成可能是昂贵和耗时的。科学家总是更热衷于定性地开发机器学习模型(例如，使用其他几个属性来预测其拉伸强度)。在过去的几年里，主要的重点已经放在定量结构-性质的关系。这使得仅用分子(即仅图像)化合物的结构预测各种性质成为可能，避免了任何额外的实验性质或繁琐的计算。在本文中，我们将使用卷积神经网络，利用聚合物的图像来预测未知聚合物化合物的 Tg。这听起来很酷，这实际上意味着如果你在白板上画出单体单元的图像，就足以预测它的 Tg。我们不需要聚合物的任何其他外部信息或性质。</p><h1 id="3008" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">导入相关包</strong></h1><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="me mf l"/></div></figure><h1 id="46d4" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">数据集</strong></h1><p id="94be" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">我们研究中使用的数据集来自一个流行的聚合物数据库。这项研究的数据集包括 351 种聚合物及其 smiles 代码，分子名称作为输入属性，玻璃化转变温度作为输出变量。300 种聚合物及其 Tg 值的子集用于训练验证数据集，而其余 51 种未知聚合物用于测试模型、CNN 和提议的 ANN 的结果。下图显示了数据集的前 5 行。这项研究的数据集可以在<a class="ae ko" href="https://github.com/Saket-Uoft/Artificial-Intelligence-for-Predicting-Materials-Properties/blob/master/molecules.csv" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="me mf l"/></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">读取和清理数据集</p></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/f0a8addc81d58d7aa2ba83076cec5134.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*la9Et0h0GqDgO0fvn1MF-w.png"/></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">数据框的前 5 行</p></figure><h1 id="82e4" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">聚合物分类</strong></h1><p id="e925" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">该数据集使用 python 中的 Pandas 库进行手动探索，并被分类为八种不同类别的聚合物——丙烯酸酯、苯乙烯、酰胺、烯烃、醚、酰胺、碳酸酯等。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/8929644fa85369f3ce52fbaedc136ce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*CUTQDdNaxdZDLksmA3gAFg.png"/></div></figure><h1 id="2514" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">探索性数据分析</h1><p id="6c6c" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated"><strong class="js iu">饼图:</strong>图中的饼图显示了数据集的确切组成，其中丙烯酸酯和苯乙烯的贡献最大</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mm"><img src="../Images/ab1f47653fb8e9f0483df391bf71bd86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IsY-YQIC07HrqRFE8eMkIA.png"/></div></div></figure><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="b6be" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">箱线图:</strong>箱线图用于显示各类聚合物的基本 Tg 分布散点图。可以看出，苯乙烯倾向于具有较高的 Tg，而丙烯酸酯具有相当混合的分布。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mn"><img src="../Images/04cddda82057cbf17bc9fa9e26a88333.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lRG3CwDlO9cBvuvIEboIag.png"/></div></div></figure><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="me mf l"/></div></figure><h2 id="3de5" class="mo lc it bd ld mp mq dn lh mr ms dp ll kb mt mu lp kf mv mw lt kj mx my lx mz bi translated">单体中的电荷分布</h2><p id="2f0a" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">开源的 RDKit [1] python 包用于将聚合物的分子结构从数据集可视化到绘图中。RDKit[1]模块中的一个这样的函数用于计算单体单元的 Gasteiger 部分电荷。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi na"><img src="../Images/f1bfc6e9f6830e70da1fea966a31b9d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*L-sU0GrPHc0UVVMeY6c0WA.png"/></div></figure><h1 id="34ac" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">特色工程</strong></h1><p id="f477" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">工程特征在为建模准备数据和以机器可读的形式呈现属性方面至关重要。根据问题陈述，Tg 预测是基于使用微笑线符号以编码形式输入 CNN 架构的聚合物化学结构的图像。这个问题的特征工程的主要目的是结合单体单元的化学结构和化学组成来预测 Tg。这是通过使用微笑线符号[2]实现的。</p><p id="6f1c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">SMILES 符号介绍:</strong> SMILES 代表简化的分子输入行输入系统。这基本上是一种用不同的字符以线符号的形式描述化学结构的方法。下图显示了给定化学结构的 SMILES 符号。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nb"><img src="../Images/4d33bcbc9b1f5bc128528504c35af336.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t8-3-D2PPgLPz1kJsB84nA.png"/></div></div></figure><p id="06df" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">分子结构到图像编码:</strong>我们首先定义了一个列表，该列表包含了可以出现在聚合物的任何给定 SMILES 线性串中的所有独特字符。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nc"><img src="../Images/3e5a662558df367ce6c2170369500992.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UVfnFuQM1gd6vT9Vf_maAQ.png"/></div></div></figure><p id="4b84" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，作为第二步，通过使用该独特微笑字符列表，通过二进制图像以机器可读形式对线符号形式的聚合物线性串进行 1-hot 编码。最终的转换是一个由二进制图像组成的 n 维矩阵，可以输入 CNN 架构。每个二进制图像是 m × n 维的矩阵，其中 n 表示唯一微笑列表中的字符数，m 是具有最长微笑代码的聚合物中存在的字符数。下图直观地描述了一个聚合物实例-聚(4-联苯丙烯酸酯)的编码过程。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nd"><img src="../Images/5aada75d296fb076a82b8f10574c2f05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_ixZe9zdjAMHY1hMIdgXPw.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">分子结构到图像编码过程</p></figure><p id="22e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">生成的一个热编码图像考虑了<strong class="js iu">化学结构和单体单元的组成。</strong>我们可以看到，编码图像告诉我们以二进制形式存在于单体结构中的每种原子的数量，以及聚合物链中原子相对于彼此的排列结构。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="e7a1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下图生成了数据框中前五种聚合物的编码图像。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ne"><img src="../Images/c93738074e6ef612026487d9500cc4da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tPd9_Z3321eYYTP7AR9GkA.png"/></div></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nf"><img src="../Images/12418ce241810e88e3de2d8efad29d89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*10wHF9TFudB74c2_IMOLdQ.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">数据框中前五种聚合物的编码图像</p></figure><h1 id="6d84" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">模型实现</strong></h1><p id="24e3" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">图像编码的分子结构作为输入输入到 CNN，目标变量是给定聚合物的 Tg，这是一个连续变量。这个模型是使用 Keras 库实现的，Keras 库是 Tensorflow 的应用程序编程接口(API)。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/907538e6cbe0fc8a8121d49efae3dc97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*fPtikRsOodO9opUKz7H64Q.png"/></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">CNN 示意图[2]</p></figure><p id="292a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">提议的架构:</strong>通过整合所有不同超参数的各种组合，选择了最终超参数。最佳观察配置在第一层中使用大小为 64 的滤波器，窗口大小为(5，5)，在第二层中使用大小为(3，3)的 32 个滤波器。接下来是窗口大小为(3，3)的 max-pooling 层。在最大池层之后，我们有三个密集层，分别具有 32、10 和 1 个神经元，最终的密集层是我们提出的 ANN 模型的输出。ReLu 激活函数由具有 l2 正则化的所有层使用。该模型通过训练多达 180 个时期达到其最佳泛化能力，批次大小为 64，学习率为 0.03。0.1 的验证分割和 0.1 的退出概率用于训练网络以执行交叉验证。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="me mf l"/></div></figure><h1 id="237a" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">结果</strong></h1><p id="e39e" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">下面给出的图显示了训练集和未知测试集的玻璃化转变温度的实验值和预测值。对于一个理想的模型，我们期望真实值完全等于预测的 Tg 值。这将导致一条直线穿过原点。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nh"><img src="../Images/5373eac02aa05d9ee71324c9db5dc5d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cklUtuHWad9rqeIuQKUW5Q.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">训练集的实际与预测 Tg 值</p></figure><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ni"><img src="../Images/65e3297a78545b83fa69561d9066b25d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iHFqtkqtOkJ9miBcRVh9TA.png"/></div></div><p class="mg mh gj gh gi mi mj bd b be z dk translated">看不见的测试集的实际与预测 Tg 值</p></figure><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="1908" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">可以看出，与真实的 Tg 值相比，大多数实施例显示出非常精确的预测。然而，由于缺乏足够的训练数据，有一些聚合物在预测中造成了很大程度的不确定性。这些聚合物属于酯类和醚类的少数类别，由于对这两类聚合物的培训不足，这些聚合物的 Tg 没有得到有效的了解。</p><p id="69d8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">损失度量:</strong>我们在训练神经网络时使用了平均绝对损失函数。但是对于我们的最终评估，我们使用平均相对误差%作为我们模型的评估标准。这可以表示如下-</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/8f258f1ac88dabe3fd5a09a90d34862a.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*wSjGR12oM6aUjZhK6Re3-g.png"/></div></figure><p id="6421" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其中 Ai 是实际的 Tg 值，Pi 是预测的 Tg 值。这一相对%误差的平均值取自 m 聚合物的全部数据集。在训练过程之后，我们计算各自的训练和测试平均相对误差。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/8b9fd98ae6418d56500f18667b5050ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*XyqNBsG1OkhR3nHivSRwww.png"/></div></figure><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="me mf l"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/4a8fc294861206a9aa51c7c50838e416.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*wyXQfCUeraeUa9SwbH32xA.png"/></div></figure><p id="f573" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下表显示了 4 种未知聚合物的真实和预测 Tg 值。我们可以看到，我们的预测非常接近实验 Tg 值，表明所提出的模型显示出优异的泛化能力。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/9757e7565a34ecd580467f62f4e68692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*u6F35mSITEmdXKGtzVv_hQ.png"/></div></figure><h1 id="e050" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">结论</strong></h1><p id="a502" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">在这项研究中，我们通过考虑聚合物中单体单元的分子结构和化学组成，证明了 CNN 预测聚合物 Tg 的可行性。我们能够分别实现 6%和 7%的训练和测试集的相对误差。在我的下一篇文章中，我将使用完全连接的神经网络来预测玻璃化转变温度。这个新模型将结合所有种类的分子内相互作用以及化学组成和分子结构来预测 Tg。</p><h1 id="db11" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">学分</strong></h1><p id="fc99" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">特别感谢<a class="ae ko" href="http://Special Thanks to Danish for contributing in this project'" rel="noopener ugc nofollow" target="_blank">丹麦</a>对这个项目的贡献。</p><h1 id="3558" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">参考文献:</strong></h1><p id="6ab4" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">1-G. Landrum 等人，“Rdkit:化学信息学和机器学习软件”。ORG，2013。</p><p id="6461" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2-Luis A. Miccio，Gustavo A. Schwartz，“通过卷积神经网络从化学结构到定量聚合物性质预测”，聚合物，2018 年</p><h1 id="e1ca" class="lb lc it bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">感谢您的阅读！！！！</h1><p id="63d0" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">如果你喜欢我的工作并想支持我:</p><p id="927b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">1-支持我的最好方式是跟随我上<a class="ae ko" href="https://medium.com/@saketthavananilindan" rel="noopener"> <strong class="js iu">中</strong> </a> <strong class="js iu">。</strong></p><p id="834e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2-在<a class="ae ko" href="https://www.linkedin.com/in/saket-thavanani-b1a149a0/" rel="noopener ugc nofollow" target="_blank"><strong class="js iu">LinkedIn</strong></a><strong class="js iu">上关注我。</strong></p></div></div>    
</body>
</html>