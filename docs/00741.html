<html>
<head>
<title>Hypothesis testing, a simple illustration of the superiority of the Bayesian framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">假设检验，贝叶斯框架优越性的简单说明</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/from-frequentism-to-bayesianism-hypothesis-testing-a-simple-illustration-11213232e551?source=collection_archive---------17-----------------------#2020-01-21">https://towardsdatascience.com/from-frequentism-to-bayesianism-hypothesis-testing-a-simple-illustration-11213232e551?source=collection_archive---------17-----------------------#2020-01-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="b4c0" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/frequentist-to-bayesian" rel="noopener" target="_blank">从频率主义到贝叶斯主义</a></h2><div class=""/><div class=""><h2 id="235c" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">当谈到假设检验时，贝叶斯方法可以取代经典的统计方法，我们将通过一个简单的例子来说明:不公平硬币。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/7563fe2791ff925f4f9a7289328f8a26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AqcmXX6ICMf_xBNv"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">由<a class="ae le" href="https://unsplash.com/@virgilcayasa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">维吉尔·卡亚萨</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="88c0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">通常假设检验并不是我们谈论<strong class="lh ja">贝叶斯主义</strong>时首先想到的话题。目前的趋势确实是更多地将这种方法纳入机器学习模型，而不是审查老式的统计数据。</p><p id="bc93" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">然而，越来越多的研究揭示了许多研究论文的失败程度，这些失败可以归因于对“初级”统计方法的误解/误用。鉴于这种现象的程度，很明显，这并不是科学家个人在这方面缺乏认真的结果，而是一种已经持续了相当长时间的全球系统性异常现象。鉴于此，似乎应该考虑更直观、更易于解释的方法。</p><p id="1c9b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">对什么是p值的误解是这种情况的根源，或者至少最能体现这一现实。</strong>如今，当谈到机器学习时，大多数数据科学家都受过良好的教育，甚至连最基本的统计概念都受到了损害；假设检验就是其中之一。</p><p id="dd48" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们现在将探索一个统计学家可能必须运行的最简单的测试之一，并从那里了解如何建立一个贝叶斯方法，它允许一个简单而直接的结论。</p><h1 id="6654" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">问题陈述</h1><p id="d6eb" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">我们将考虑一个最简单的实验，为了不忽略我们想要用不必要的卷积来证明的观点:<strong class="lh ja">抛硬币。</strong>问题是这样定义的:</p><ul class=""><li id="3a1f" class="my mz iq lh b li lj ll lm lo na ls nb lw nc ma nd ne nf ng bi translated">一枚硬币可以被翻转有限的次数。</li><li id="a51e" class="my mz iq lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated">我们的目标是找出这枚硬币是否公平。换句话说，我们想知道我们的假设(H0)“硬币是公平的”有多大可能是假的。</li></ul><p id="7cdc" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">很简单，对吧？</p><h1 id="7ef8" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">实验设计:p值和ROC曲线</h1><p id="76e3" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">实验的设计应该考虑到将用来回答我们问题的统计方法。学生t检验似乎是我们假设检验的一个明显的选择。我们将样本的平均值与数值0.5进行比较。</p><p id="83c7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">良好实践希望我们在设计研究时计算<strong class="lh ja">统计功效</strong>,以便估计适当的样本量，或者至少告诉我们样本量已经固定时研究的局限性(通常要求功效至少为0.8)</p><blockquote class="nm nn no"><p id="90d2" class="lf lg np lh b li lj ka lk ll lm kd ln nq lp lq lr nr lt lu lv ns lx ly lz ma ij bi translated">二元<a class="ae le" href="https://en.wikipedia.org/wiki/Hypothesis_test" rel="noopener ugc nofollow" target="_blank">假设检验</a>的<strong class="lh ja">功效</strong>是当特定的<a class="ae le" href="https://en.wikipedia.org/wiki/Alternative_hypothesis" rel="noopener ugc nofollow" target="_blank">替代假设</a> (H1)为真时，检验拒绝<a class="ae le" href="https://en.wikipedia.org/wiki/Null_hypothesis" rel="noopener ugc nofollow" target="_blank">零假设</a> (H0)的概率。</p></blockquote><p id="e1c9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">换句话说，测试的能力是当硬币实际上不公平时，在指定阈值下获得p值的概率。</p><p id="5606" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">为了方便起见，我们将只考虑另一个假设(H1)“硬币遵循参数p = 0.4的伯努利定律”，这将允许我们轻松地计算我们的测试的功效。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/97137802d32ca711efafd4045e05b615.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*gkESxd-nxH2r1-o0kP6eKw.jpeg"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">100°和192°翻转的ROC曲线</p></figure><p id="8828" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">看一下这个测试的ROC曲线将有助于我们理解发生了什么。对于给定的显著性水平α，我们可以通过分析或模拟得出真阳性率和假阳性率；或者换句话说，测试的统计功效和显著性水平本身。</p><p id="4480" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">通常α= 0.05是可接受的极限，对于这个阈值，最少需要翻转192次才能达到我们的目标(因为当一个人想到娱乐活动时，翻转硬币不是第一个想到的事情，我们将限制自己翻转硬币192次！).</p><h1 id="074b" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">解释测试的结果</h1><p id="57f1" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">我们的问题来了。假设我们发现硬币是不公平的，p值= 0.01，我们现在可以得出什么结论？</p><ul class=""><li id="fbec" class="my mz iq lh b li lj ll lm lo na ls nb lw nc ma nd ne nf ng bi translated">零假设为真的可能性有1%吗？</li><li id="999a" class="my mz iq lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated">我们99%确定我们的硬币不公平吗？</li></ul><p id="89d4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这些都不是你可能已经得出的结论。事实上，在这一点上，没有办法给出我们的硬币不公平的概率…相当烦人，特别是考虑到我们最初的问题:我们的硬币有多大可能不公平？我们能得出的唯一结论是，如果硬币是公平的，我们只有0.01的概率观察到如此极端的结果。</p><p id="01c0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">事实上<strong class="lh ja">贝叶斯定理</strong>给了我们计算这个值的方法，但是我们需要更多的信息:<strong class="lh ja">先验</strong>。H0 =“硬币不公平”，H1=“硬币公平”，S =“测试成功，p值&lt; 0.05”，我们有:</p><blockquote class="nu"><p id="7328" class="nv nw iq bd nx ny nz oa ob oc od ma dk translated">P(H0 | S)= P(H0)* P(H0)/(P(H0)* P(H0)+P(H1)* P(H1))</p></blockquote><p id="a884" class="pw-post-body-paragraph lf lg iq lh b li oe ka lk ll of kd ln lo og lq lr ls oh lu lv lw oi ly lz ma ij bi translated">最初假设我们的硬币更可能是公平的，我们设置<em class="np"> P(H1) = 0.9 </em>和<em class="np"> P(H0) = 0.1。</em>于是我们有了</p><blockquote class="nu"><p id="198b" class="nv nw iq bd nx ny nz oa ob oc od ma dk translated">p(H0 | S)= 0.8 * 0.1/(0.8 * 0.1+0.05 * 0.9)</p><p id="2bca" class="nv nw iq bd nx ny nz oa ob oc od ma dk translated">P(H0 | S) = 0.64</p></blockquote><p id="3a7c" class="pw-post-body-paragraph lf lg iq lh b li oe ka lk ll of kd ln lo og lq lr ls oh lu lv lw oi ly lz ma ij bi translated">所以即使我们的测试呈阳性，我们的硬币也只有64%的机会不公平。与我们希望的95%相差甚远…然而这个概率比简单的p值包含了更多的见解，幸运的是我们可以走得更远。这仅仅是进入贝叶斯世界的第一步，正如我们现在将要看到的，还有更多需要展开来改进我们的测试！</p><h1 id="826d" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">贝叶斯方法</h1><p id="f983" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated"><em class="np">对于这一部分，我们将使用python的PyMC3库，这允许我们轻松地构建贝叶斯非参数模型。</em></p><p id="1a4a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们对一个不公平硬币(p = 0.4)的抽样建模，并计算得到的后验分布。虽然使用了非平凡的<strong class="lh ja">马尔可夫链蒙特卡罗</strong> ( <strong class="lh ja"> MCMC </strong> ) <strong class="lh ja">算法</strong>，但其背后的思想仅仅是贝叶斯定理的应用。</p><p id="c2f6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">既然我们已经理解了如何用贝叶斯术语来转置我们的常规假设检验，我们可以调整先验分布来反映我们对系统初始状态的真实信念:以0.5为中心的beta分布将强调这样一个事实，即我们认为如果硬币有偏差，它一定不会像0或1那样极端。</p><pre class="kp kq kr ks gt oj ok ol om aw on bi"><span id="0c41" class="oo mc iq ok b gy op oq l or os">import pymc3 as pm<br/>N = 192 #Sampling size</span><span id="6871" class="oo mc iq ok b gy ot oq l or os">with pm.Model() as model:<br/>    p = pm.Uniform("p", 0, 1)<br/>    observations = pm.Binomial("observations", N, 0.4)<br/>    obs = pm.Binomial("obs", N, p, observed=observations)<br/>    step = pm.Metropolis()<br/>    start = pm.find_MAP()<br/>    trace = pm.sample(100000, step=step, start=start)<br/>    burned_trace=trace[1000:]<br/>    <br/>p_samples = burned_trace["p"]</span></pre><ul class=""><li id="b1f4" class="my mz iq lh b li lj ll lm lo na ls nb lw nc ma nd ne nf ng bi translated">我们也可以像许多贝叶斯主义者建议的那样，提供非信息性的前科。例如，我们可以假设p在[0；1].</li></ul><pre class="kp kq kr ks gt oj ok ol om aw on bi"><span id="8802" class="oo mc iq ok b gy op oq l or os">p = pm.distributions.continuous.Beta("p", 2, 2)</span></pre><p id="33f7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在每种情况下，我们可以直接计算p &lt; 0.5 from the posterior distributions.</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/a3e0feebc7534c04d6f661c54f829012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*ZrLIBYM_YqU-4qRGIhl45w.jpeg"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">Posteriors densities after 192 flips</p></figure><pre class="kp kq kr ks gt oj ok ol om aw on bi"><span id="4d72" class="oo mc iq ok b gy op oq l or os">print(np.mean(p_samples&lt;0.5))</span></pre><p id="18a2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">We get respectively 0.98 and 0.97 with the uniform prior and the beta(2,2) prior, informing us of the degree of confidence we have that the coin we observe is actually fair or not.</p><h2 id="418f" class="oo mc iq bd md ov ow dn mh ox oy dp ml lo oz pa mn ls pb pc mp lw pd pe mr iw bi translated">Going further</h2><p id="fa7b" class="pw-post-body-paragraph lf lg iq lh b li mt ka lk ll mu kd ln lo mv lq lr ls mw lu lv lw mx ly lz ma ij bi translated">In his paper <strong class="lh ja">贝叶斯估计取代t检验(最佳)的概率，</strong> John Kruschke建议查看他所谓的<strong class="lh ja">最高密度区间</strong>，它由包含95%后验密度的最小区间组成，以便定义我们的检验标准。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pf"><img src="../Images/90014c16a218b5e8f7d7c2edb30383f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eIWOO5NrXvc1WRKVmx3ixQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">192次翻转后的最高密度区间</p></figure><p id="efc6" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">例如，在我们的例子中，我们想知道这些区间是否与我们针对0.5测试的值重叠，并且如果0.5不包括在这些区间中，则得出结论(H0)被拒绝。</p><p id="ee29" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">用密度进行推理使我们能够利用我们所能接触到的所有信息。更好的是，它允许我们从数据中捕捉所有的细微差别，并得出明确的结论。</p><p id="d241" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">鉴于我们必须选择一个先验，有人可能会认为我们的分析是有偏见的。我不会在这里讨论频繁主义和贝叶斯主义之间的范式差异，而是简单地回忆一下，不选择先验往往等同于隐含地选择一个。</p><h1 id="111c" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">结论</h1><ul class=""><li id="6063" class="my mz iq lh b li mt ll mu lo pg ls ph lw pi ma nd ne nf ng bi translated">贝叶斯框架提供了一个易于执行的<strong class="lh ja">和易于阅读的</strong>来替代经典的统计测试。</li><li id="e73f" class="my mz iq lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated"><strong class="lh ja">后验密度</strong>为我们提供了更便于理解和使用的数学概念，而p值等概念已经被无数次地证明具有误导性。</li><li id="9b10" class="my mz iq lh b li nh ll ni lo nj ls nk lw nl ma nd ne nf ng bi translated">最终，<strong class="lh ja">贝叶斯网络</strong>的概念允许我们<strong class="lh ja">设想更复杂的实验，并通过简单地考虑后验分布来测试任何假设</strong>，就像我们观察<a class="ae le" href="https://medium.com/@alain.tanguy/from-frequentism-to-bayesianism-going-deeper-part-2-offline-a-b-test-d3324f7a39bb" rel="noopener"> <strong class="lh ja"> A/B测试</strong> </a> <strong class="lh ja">的情况一样。</strong></li></ul><h1 id="da0f" class="mb mc iq bd md me mf mg mh mi mj mk ml kf mm kg mn ki mo kj mp kl mq km mr ms bi translated">参考</h1><ol class=""><li id="bc34" class="my mz iq lh b li mt ll mu lo pg ls ph lw pi ma pj ne nf ng bi translated">T.V. Pereira和J.P.A. Ioannidis。"统计上有意义的临床试验荟萃分析可信度不高，效果夸大."<em class="np">临床流行病学杂志</em> 64，第10期(2011):1060-1069。DOI:<em class="np">10.1016/j . jclinepi . 2010 . 12 . 012</em>。</li><li id="b139" class="my mz iq lh b li nh ll ni lo nj ls nk lw nl ma pj ne nf ng bi translated">约翰·克鲁施克。(2012)贝叶斯估计取代了t检验。<em class="np">实验心理学杂志</em>综述。</li></ol></div></div>    
</body>
</html>