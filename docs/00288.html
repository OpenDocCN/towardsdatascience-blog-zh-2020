<html>
<head>
<title>How To Manipulate Date And Time In Python Like A Boss</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何像老板一样在Python中操纵日期和时间</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-manipulate-date-and-time-in-python-like-a-boss-ddea677c6a4d?source=collection_archive---------17-----------------------#2020-01-09">https://towardsdatascience.com/how-to-manipulate-date-and-time-in-python-like-a-boss-ddea677c6a4d?source=collection_archive---------17-----------------------#2020-01-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9f7f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">常用的日期时间函数及示例</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b6ab5f368ea9f6c3a5011d22fc14b97f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EhfFoWwA4EvRFi-j"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">伊莲娜·科伊切娃在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="e51f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">使用Python时，我们都有试图弄清楚如何“操纵”日期和时间的时刻。</p><p id="195d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我创建的一个备忘单，涵盖了Python中最常用的日期时间相关函数。如果你想要一些简单但实用的例子，看看吧！</p><p id="220c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将涵盖以下所有7个热门话题:</p><ul class=""><li id="6b8a" class="me mf it lb b lc ld lf lg li mg lm mh lq mi lu mj mk ml mm bi translated"><em class="mn">不同格式的今天的日期和时间</em></li><li id="b34c" class="me mf it lb b lc mo lf mp li mq lm mr lq ms lu mj mk ml mm bi translated"><em class="mn">字符串到日期的转换</em></li><li id="21ca" class="me mf it lb b lc mo lf mp li mq lm mr lq ms lu mj mk ml mm bi translated"><em class="mn">日期时间计算的差异</em></li><li id="57e9" class="me mf it lb b lc mo lf mp li mq lm mr lq ms lu mj mk ml mm bi translated"><em class="mn">日期时间加/减某段时间</em></li><li id="32ce" class="me mf it lb b lc mo lf mp li mq lm mr lq ms lu mj mk ml mm bi translated"><em class="mn">日期时间比较</em></li><li id="4a67" class="me mf it lb b lc mo lf mp li mq lm mr lq ms lu mj mk ml mm bi translated"><em class="mn">时区设置</em></li><li id="f144" class="me mf it lb b lc mo lf mp li mq lm mr lq ms lu mj mk ml mm bi translated"><em class="mn"> Unix时间戳/纪元时间计算</em></li></ul></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h2 id="2adb" class="na nb it bd nc nd ne dn nf ng nh dp ni li nj nk nl lm nm nn no lq np nq nr ns bi translated">不同格式的今天的日期和时间</h2><p id="3ed5" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">让我们从最基本的开始热身。下面是打印当前年、月、日、小时、分钟、秒和毫秒的代码。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="e875" class="na nb it nz b gy od oe l of og"><strong class="nz iu">In: </strong>from datetime import datetime</span><span id="238b" class="na nb it nz b gy oh oe l of og">    d = datetime.now() #today's datetime<br/>    d</span><span id="bec0" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out:</strong>datetime.datetime(2019, 12, 22, 13, 14, 18, 193898)</span></pre><p id="12be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是非常有用的信息，但我们通常只需要其中的一部分。我们可以打印下面不同的部分。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="6af3" class="na nb it nz b gy od oe l of og"><strong class="nz iu">In:  </strong>print(d.weekday()) #day of week - Monday is 0 and Sunday is 6<br/>     print(d.year)<br/>     print(d.month)<br/>     print(d.day)<br/>     print(d.hour)<br/>     print(d.minute)<br/>     print(d.second)</span><span id="1304" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out: </strong>6<br/>     2019<br/>     12<br/>     22<br/>     13<br/>     14<br/>     18</span></pre><p id="54a7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，可能需要某些日期/时间格式。我们可以使用下面的列表来定制不同的日期格式。这也可以被认为是将日期转换为字符串的一种方式。完整的名单可以在这里找到。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/7148294e52523e0cdc6205a6fec4cb8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6udoEqEFYe3xBvKbm2yRCQ.png"/></div></div></figure><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="1d3d" class="na nb it nz b gy od oe l of og"><strong class="nz iu">In:</strong>  print(d.strftime("%A %d/%m/%Y")) # date to string</span><span id="b784" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out:</strong> Sunday 22/12/2019</span></pre><h2 id="6197" class="na nb it bd nc nd ne dn nf ng nh dp ni li nj nk nl lm nm nn no lq np nq nr ns bi translated">字符串到日期的转换</h2><p id="8201" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">下面的示例显示了两个被转换为日期格式的流行字符串:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="90f8" class="na nb it nz b gy od oe l of og"><strong class="nz iu">In:</strong>  date_string = '2016-02-01 12:00PM'<br/>     print(datetime.strptime(date_string, '%Y-%m-%d %I:%M%p'))</span><span id="66a3" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out: </strong>2016-02-01 12:00:00</span><span id="0bc5" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">In:</strong>  date_string = '02/01/2016'<br/>     d2 = datetime.strptime(date_string, '%m/%d/%Y')<br/>     print(d2)</span><span id="5918" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out:</strong> 2016-02-01 00:00:00</span></pre><h2 id="0954" class="na nb it bd nc nd ne dn nf ng nh dp ni li nj nk nl lm nm nn no lq np nq nr ns bi translated">日期时间计算的差异</h2><p id="48a6" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">下面的示例打印天数的差异(例如今天和2016年2月1日):</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="b42b" class="na nb it nz b gy od oe l of og"><strong class="nz iu">In:</strong>  from datetime import timedelta</span><span id="7e24" class="na nb it nz b gy oh oe l of og">     d = datetime.now()<br/>     date_string = '2/01/2016'<br/>     d2 = datetime.strptime(date_string, '%m/%d/%Y')<br/>     print(d - d2)</span><span id="782b" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out:</strong> 1420 days, 13:18:27.386763</span></pre><p id="b958" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以只打印两个日期时间的差异，以天、周或年为单位，等等。</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="cea5" class="na nb it nz b gy od oe l of og"><strong class="nz iu">In:</strong> date_diff = (d - d2)/timedelta(days=1)<br/>    print('date_diff = {} days'.format(date_diff))</span><span id="257a" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out:</strong> date_diff = 1420.5544836430902 days</span><span id="414e" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">In: </strong> date_diff = (d - d2)/timedelta(weeks=1)<br/>     print('date_diff = {} weeks'.format(date_diff))</span><span id="3e9f" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out:</strong> date_diff = 202.93635480615575 weeks</span><span id="0eda" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">In:</strong>  date_diff = (d - d2)/timedelta(days=365)<br/>     print('date_diff = {} years'.format(date_diff))</span><span id="f29b" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out:</strong> date_diff = 3.8919300921728497 years</span></pre><h2 id="66fc" class="na nb it bd nc nd ne dn nf ng nh dp ni li nj nk nl lm nm nn no lq np nq nr ns bi translated">日期时间加上/减去某一段时间</h2><p id="780d" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">让我们按秒、分、小时、天、周或年的不同时间间隔做一些“时间旅行”:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="c8cb" class="na nb it nz b gy od oe l of og"><strong class="nz iu">In:</strong>  print(d + timedelta(seconds=1)) # today + one second</span><span id="58a6" class="na nb it nz b gy oh oe l of og">     print(d + timedelta(minutes=1)) # today + one minute</span><span id="2943" class="na nb it nz b gy oh oe l of og">     print(d + timedelta(hours=1)) # today + one hour</span><span id="f695" class="na nb it nz b gy oh oe l of og">     print(d + timedelta(days=1)) # today + one day</span><span id="5c11" class="na nb it nz b gy oh oe l of og">     print(d + timedelta(weeks=1)) # today + one week</span><span id="4c60" class="na nb it nz b gy oh oe l of og">     print(d + timedelta(days=1)*365) # today + one year<br/></span><span id="fb71" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out:</strong> 2019-12-22 13:18:28.386763<br/>     2019-12-22 13:19:27.386763<br/>     2019-12-22 14:18:27.386763<br/>     2019-12-23 13:18:27.386763<br/>     2019-12-29 13:18:27.386763<br/>     2020-12-21 13:18:27.386763</span></pre><h2 id="19ff" class="na nb it bd nc nd ne dn nf ng nh dp ni li nj nk nl lm nm nn no lq np nq nr ns bi translated">日期时间比较</h2><p id="e16e" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">日期之间的比较用通常的比较符号很简单:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="d364" class="na nb it nz b gy od oe l of og"><strong class="nz iu">In:  </strong>print(d &lt; (d2 +(timedelta(days=365*6)))) # d is no more than 6 years (assume each year has 365 days) after d2?<br/>     print(d &gt; (d2 +(timedelta(weeks=52*6)))) # d is more than 6 years (assume each year has 52 weeks) after d2?<br/>     print(d != d2) # d2 is not the same date as d?<br/>     print(d == d2) # d2 is the same date as d?</span><span id="9633" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out: </strong>True<br/>     False<br/>     True<br/>     False</span></pre><h2 id="2e93" class="na nb it bd nc nd ne dn nf ng nh dp ni li nj nk nl lm nm nn no lq np nq nr ns bi translated">时区设置</h2><p id="2317" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">我们还可以比较不同时区的时间，比如多伦多和上海:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="fc58" class="na nb it nz b gy od oe l of og"><strong class="nz iu">In:</strong>  import pytz<br/>     timezone = pytz.timezone("America/Toronto")<br/>     dtz = timezone.localize(d)<br/>     print(dtz.tzinfo)<br/>     print(dtz)</span><span id="a3cd" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out: </strong>America/Toronto<br/>     2019-12-22 13:18:27.386763-05:00</span><span id="9c2e" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">In:</strong>  shanghai_dt = dtz.astimezone(pytz.timezone("Asia/Shanghai"))<br/>     print(shanghai_dt)</span><span id="c828" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out: </strong>2019-12-23 02:18:27.386763+08:00</span><span id="08d9" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">In: </strong> (dtz - shanghai_dt)/timedelta(days=1) # same datetimes</span><span id="e3dd" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out: </strong>0.0</span></pre><p id="e520" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您对不同时区的完整列表感兴趣。使用下面的代码将打印它们:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="6d2e" class="na nb it nz b gy od oe l of og"><strong class="nz iu">In:</strong>  for tz in pytz.all_timezones:<br/>        print(tz)</span><span id="9a25" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out: </strong>Africa/Abidjan<br/>     Africa/Accra<br/>     Africa/Addis_Ababa<em class="mn"><br/>(Only showing the first three as examples)</em></span></pre><h2 id="169f" class="na nb it bd nc nd ne dn nf ng nh dp ni li nj nk nl lm nm nn no lq np nq nr ns bi translated">Unix时间戳/纪元时间计算</h2><p id="a4d6" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">Unix时间戳通常用于操作系统中的文件。通常它们也会出现在数据集中。</p><p id="ad51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们可以获得当前的Unix时间戳:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="4223" class="na nb it nz b gy od oe l of og"><strong class="nz iu">In:  </strong>from datetime import timezone</span><span id="cad3" class="na nb it nz b gy oh oe l of og">     dt_now = datetime.now(timezone.utc)<br/>     print(dt_now)<br/>     print(dt_now.tzinfo)<br/>     print(dt_now.timestamp()) # the unix timestamp.</span><span id="929a" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out: </strong>2019-12-22 18:21:28.681380+00:00<br/>     UTC<br/>     1577038888.68138</span></pre><p id="9699" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，我们可以将Unix时间戳转换为日期时间格式:</p><pre class="kj kk kl km gt ny nz oa ob aw oc bi"><span id="9037" class="na nb it nz b gy od oe l of og"><strong class="nz iu">In:  </strong>utc_timestamp = 1377050861.206272<br/>     unix_ts_dt = datetime.fromtimestamp(utc_timestamp, timezone.utc)</span><span id="ec4d" class="na nb it nz b gy oh oe l of og">     print(unix_ts_dt)<br/>     print(unix_ts_dt.astimezone(pytz.timezone("America/Toronto")))<br/>     print(unix_ts_dt.astimezone(pytz.timezone("Asia/Shanghai")))</span><span id="42b6" class="na nb it nz b gy oh oe l of og"><strong class="nz iu">Out: </strong>2013-08-21 02:07:41.206272+00:00<br/>     2013-08-20 22:07:41.206272-04:00<br/>     2013-08-21 10:07:41.206272+08:00</span></pre></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="5d2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="mn">更多数据科学相关文章来自Lianne和Justin: </em> </strong></p><div class="oj ok gp gr ol om"><a rel="noopener follow" target="_blank" href="/how-to-visualize-a-decision-tree-in-5-steps-19781b28ffe2"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">如何用5个步骤可视化决策树</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">为企业Windows环境量身定制</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa ks om"/></div></div></a></div><div class="oj ok gp gr ol om"><a rel="noopener follow" target="_blank" href="/how-much-do-you-need-to-retire-at-age-30-based-on-simulation-424fa9e0922b"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">根据模拟，30岁退休需要多少钱</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">很多人年纪轻轻就有辞掉工作的梦想，活在世上没有经济上的牵挂。怎么…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="pb l ox oy oz ov pa ks om"/></div></div></a></div><div class="oj ok gp gr ol om"><a rel="noopener follow" target="_blank" href="/when-is-the-best-time-to-buy-lottery-tickets-7735191b3c76"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd iu gy z fp or fr fs os fu fw is bi translated">买彩票的最佳时机是什么时候？</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">根据理性(或统计)分析</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">towardsdatascience.com</p></div></div><div class="ov l"><div class="pc l ox oy oz ov pa ks om"/></div></div></a></div></div></div>    
</body>
</html>