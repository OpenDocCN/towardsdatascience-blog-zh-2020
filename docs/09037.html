<html>
<head>
<title>State-of-the-art python project setup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">最先进的 python 项目设置</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/state-of-the-art-python-project-setup-82a046fc1f20?source=collection_archive---------14-----------------------#2020-06-29">https://towardsdatascience.com/state-of-the-art-python-project-setup-82a046fc1f20?source=collection_archive---------14-----------------------#2020-06-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8a0e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为您的下一个 python 项目提供有见解的设置指南</h2></div><p id="6669" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Python 是发展最快的编程语言之一。它的工具正在快速发展以迎头赶上。我写 python 已经超过 10 年了，有时很难跟上所有的新工具。最近，我有机会(也有时间)评估其中一些新工具，这个领域的活动给我留下了深刻的印象。以下是我目前(2020 年 6 月)理想的 python 项目设置。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/1c01103c4163401d5086f0e30da34b83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m8MURCq1z0CnKoRrWW6PjQ.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated"><a class="ae lu" href="https://xkcd.com/1987/" rel="noopener ugc nofollow" target="_blank">https://xkcd.com/1987/</a></p></figure><h2 id="5457" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">依赖管理:<a class="ae lu" href="https://pypi.org/project/pipenv/" rel="noopener ugc nofollow" target="_blank"> pipenv </a></h2><p id="3336" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">python 中的依赖管理非常困难和复杂。过去，我曾使用<a class="ae lu" href="https://github.com/jazzband/pip-tools" rel="noopener ugc nofollow" target="_blank"> pip-tools </a>和 virtualenv 来管理(非常不成功)各种项目的依赖和 env。Pipenv 彻底改变了开发体验。它以更优雅的方式解决了这些问题。Pipenv 将 virtualenv 和依赖关系管理结合到一个简单易用的工具中。您基本上为每个 pipfile 获得了一个自动化的 virtualenv，同时也为确定性构建获得了一个锁文件。Pipenv 还提供了额外的安全性，因为它使用哈希来检查锁定的依赖关系。尽管一些基本的操作，比如添加和安装一个新的库非常慢，但是这些操作很少发生，所以它仍然比其他任何方法都好。</p><p id="92a4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">更新:</strong>结账<a class="ae lu" href="https://python-poetry.org/" rel="noopener ugc nofollow" target="_blank">诗词</a>也是 pipenv 的改进版。</p><h2 id="3a05" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">棉绒:<a class="ae lu" href="https://pypi.org/project/flake8-black/" rel="noopener ugc nofollow" target="_blank">薄片 8-黑色</a> + <a class="ae lu" href="https://github.com/timothycrosley/isort" rel="noopener ugc nofollow" target="_blank">或其他</a></h2><p id="7066" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated"><a class="ae lu" href="https://pypi.org/project/flake8/" rel="noopener ugc nofollow" target="_blank"> Flake8 </a>是最受欢迎的蟒蛇皮，<a class="ae lu" href="https://pypi.org/project/black/" rel="noopener ugc nofollow" target="_blank"> black </a>是最固执己见且简单易用的蟒蛇皮。黑 linter 真的很好，真的是一个基本的蟒蛇林挺好。black 中缺少的两个特性是导入排序和查找未使用的导入/变量。Isort 解决了前者，flake8-black 解决了后者。这些工具提供了非常简单的 CLI 工具来自动修复大多数问题，这使得遵守 linter 规则变得非常容易。虽然我真的希望有一个工具可以将这三者结合起来。</p><h2 id="86a5" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">静态类型检查器:<a class="ae lu" href="http://mypy-lang.org/" rel="noopener ugc nofollow" target="_blank"> mypy </a></h2><p id="ff55" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">Mypy 是最常见和最广泛使用的 python 静态类型检查器。尽管确保 python 代码定义了正确的类型是一项不小的工作，但这是完全值得的。该工具提供了许多选项来打开和关闭各种不同类型的检查。我真正欣赏的一点是只在任何新代码上运行检查器的选项，这使得将它添加到现有的 repo 并在项目中增量添加类型成为可能。</p><h2 id="6478" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">测试:<a class="ae lu" href="https://docs.pytest.org/en/stable/" rel="noopener ugc nofollow" target="_blank"> pytest </a></h2><p id="068d" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">这不应该是一个惊喜。Pytest 是最受欢迎的 python 测试框架，拥有超过 6000 个 github stars。Pytest 提供了更简单的接口和更少的样板代码。它速度快，稳定，功能丰富。</p><h2 id="0e48" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">代码覆盖率:<a class="ae lu" href="https://coverage.readthedocs.io/en/coverage-5.1/" rel="noopener ugc nofollow" target="_blank">覆盖率</a></h2><p id="b686" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">Coverage 是最常见的 python 覆盖工具，拥有超过 1000 颗 github 星。它与 pytest 配合得很好，并且可以选择仅对项目中任何新编写的代码执行覆盖率阈值。因此，在您现有的 python 项目中稳定地开始实施测试覆盖变得很容易。我在实施代码覆盖方面的唯一问题是，该工具只是以状态代码 2 退出，而没有打印任何可用的错误消息，这使得调试 CI 构建失败的原因变得非常混乱。</p><h2 id="da7f" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">IDE: <a class="ae lu" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> VSCode </a></h2><p id="156f" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">这可能是最有争议的选择。紧随其后的是 Jetbrains 的 Pycharm。我两者都用过，最近转向了 VSCode，主要是因为它是免费的，并且有一组令人惊讶的扩展。您可以轻松地在 VSCode 中设置上述所有工具，并通过提交 git 中的设置与团队的其他成员共享这些工具(<a class="ae lu" href="https://github.com/NitinAgg/pd2tfrecord/blob/master/.vscode/settings.json" rel="noopener ugc nofollow" target="_blank">示例</a>)。VSCode 还使得跨多种语言工作变得容易。Pycharm 不错，但是界面感觉有点笨重，过时，速度慢。此外，由于 jetbrains 试图为每种语言销售不同的编辑器，他们在 pycharm 中为其他语言提供的扩展无法提供与 VSCode 相同的无缝体验。迫不及待想试试 VSCode 和 github 一直在做的在线编辑器。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><p id="bcca" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然我对上面的设置很满意，但有一件事我觉得还是有点乱:配置文件。Python 工具现在围绕着使用哪种配置文件格式而分散开来。似乎新的工具正在标准化。toml 配置文件，但现在我的 black、isort 和 coverage 配置在<a class="ae lu" href="https://github.com/NitinAgg/pd2tfrecord/blob/master/pyproject.toml" rel="noopener ugc nofollow" target="_blank"> pyproject.toml </a>中，flake8 配置在<a class="ae lu" href="https://github.com/NitinAgg/pd2tfrecord/blob/master/setup.cfg" rel="noopener ugc nofollow" target="_blank"> setup.cfg </a>中，mypy 设置在<a class="ae lu" href="https://github.com/NitinAgg/pd2tfrecord/blob/master/mypy.ini" rel="noopener ugc nofollow" target="_blank"> mypy.ini </a>中。如果我能把所有这些配置放在一个文件中就好了，我可以把它复制粘贴到我所有的项目中。</p><p id="50ff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里(<a class="ae lu" href="https://github.com/NitinAgg/pd2tfrecord" rel="noopener ugc nofollow" target="_blank"> link </a>)是一个简单的库，上面所有的设置都是在这里配置的。请签出 makefile 并。github/workflows/unit _ tests . YAML 来检查我如何设置 CI。</p></div></div>    
</body>
</html>