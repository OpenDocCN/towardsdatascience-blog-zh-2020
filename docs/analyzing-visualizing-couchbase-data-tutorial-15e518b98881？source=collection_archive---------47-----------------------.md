# 分析和可视化 Couchbase 数据—教程

> 原文：<https://towardsdatascience.com/analyzing-visualizing-couchbase-data-tutorial-15e518b98881?source=collection_archive---------47----------------------->

## 使用 Knowi 连接到 Couchbase，运行查询，分析和可视化您的查询结果，并通过基于搜索的分析提出问题。

![](img/5aa7b493267aef0a6619c9423ae52db8.png)

科琳·库兹在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

# 目录

*   [简介](#f1a5)
*   [连接到床座](#5e4d)
*   [查询 Couchbase 数据](#d5ef)
*   [使用基于搜索的分析完成您的查询](#9304)
*   [分析和可视化您的数据](#9e4e)
*   [总结](#376d)

# 介绍

[Couchbase](https://www.couchbase.com/) 是一个强大的 NoSQL 数据库，使企业能够存储和查询大量非结构化数据。Couchbase 的可伸缩性、灵活的数据模型和性能比率使其成为当今市场上最好的 NoSQL 数据库之一。

目前，大多数现有的商业智能和分析平台需要定制编码或繁琐的 ETL 过程，才能使用来自 Couchbase 的非结构化 NoSQL 数据。幸运的是， [Knowi](https://www.knowi.com/) 是为数不多的提供 Couchbase 原生集成的商业智能平台之一，这使得我们的用户能够利用 Couchbase 的优势。

在本教程中，您将学习如何使用 Knowi 来分析和可视化来自 Couchbase 的数据。

# 连接到沙发底座

一旦你登录到你的 [Knowi 试用账户](https://www.knowi.com/free-trial)，你需要按照以下步骤连接到一个 Couchbase 数据源:

1.  前往屏幕左侧的面板，选择“数据源”
2.  转到 NoSQL 数据源的右上角，选择 Couchbase。
3.  选择屏幕底部的“测试连接”。
4.  确保连接成功后，选择“保存”

作者图片

# 查询 Couchbase 数据

当您保存数据源时，您应该会在屏幕顶部收到一个警告，提示“Datasource Added”。配置查询。按照以下步骤开始设置您的第一个查询:

1.  点击“查询”开始当您这样做时，您将被带到一个查询构建器，并且屏幕顶部的警告将变为“获取存储桶”这意味着 Knowi 正在从您刚刚连接到的 Couchbase 数据源中自动索引“桶”(或数据集)。这将需要几秒钟的时间来完成，所以在您等待的时候，请将您的报告命名为“Queens Bakeries”(如果报告名称没有泄露，我们将分析纽约皇后区面包店的数据。)
2.  当您的警报变为“已检索存储桶”后，悬停在“存储桶/数据集”上。使用查询生成器部分来发现和构建报告/查询。点击工具条内部，您将看到存储在您的 Couchbase 数据库中的每个存储桶。选择“restaurant”并知道我将自动生成 N1QL 查询，该查询查询餐馆数据集的前 10，000 行中的所有列。
3.  选择屏幕左下角的“预览”。向下滚动以查看预览。如您所见，“地址”和“成绩”列都在嵌套的 JSON 中。我们的目标是分析地址字段中的特定信息，所以我们需要扩展它；Cloud9QL，Knowi 的 SQL 风格语法，让这变得轻而易举。只需向上滚动到您最初索引您的存储桶的区域，并在“Cloud9QL Query”下，键入“select * expand(address)”并再次预览您的查询。

作者图片

这一次，您会注意到预览数据已经扩展为包括几个新列:zipcode、coord、street 和 building。更重要的是，因为新的“coord”字段包含这些餐馆的坐标，Knowi 自动将您的预览图表可视化类型转换为地理聚类/自定义地图可视化。

# 使用基于搜索的分析完成您的查询

我们的查询还没有完成；我们甚至还没有拯救它，更不用说回到皇后区的面包店了，这是我们最初的目标。为了做这些事情，我们将从 Knowi 的[基于搜索的分析](https://www.knowi.com/search-based-analytics/)功能中获得一点帮助，该功能允许我们用简单的英语查询我们的数据，并实时接收结果。为了使用基于搜索的分析来完成您的查询，请遵循以下步骤:

1.  前往预览数据顶部的搜索栏，键入“显示皇后区的每家面包店”如您所见，Knowi 将自动过滤数据，只包含 cuisine 等于 Bakery，borough 等于 Queens 的行。
2.  向下滚动到预览图表。如您所见，数据现在包括了更小的餐馆子集，而且只包括皇后区内的餐馆。这是我们从一开始的目标。选择屏幕右下角的“保存并立即运行”以保存此查询。

运行查询后，Knowi 将结果作为数据集存储在其弹性数据仓库中。每次成功运行查询时，Knowi 都会这样做。

# 分析和可视化您的数据

除了将查询结果作为数据集存储在 Knowi 的弹性数据仓库中，Knowi 还会在您运行查询时将预览图表可视化保存为一个小部件。现在，您的第一个微件已经创建完毕，是时候通过创建一个仪表盘来放置它，并通过以下步骤进一步可视化数据集中的数据了:

1.  前往屏幕左侧面板的顶部，选择“仪表板”选择“+”图标创建一个新仪表板，将其命名为“Queens Bakery Dashboard”，然后单击“OK”
2.  回到屏幕左侧的面板，在“仪表板”的正下方，点击“Widgets”在这里，您将看到刚刚创建的“Queens Bakeries”小部件。将它拖到您的仪表板上进行添加。
3.  现在，您已经将微件添加到了仪表板中，您可以进一步分析您的数据并创建新的可视化效果。单击小部件右上角的 elipses 图标，然后选择“分析”这将引导您找到驱动您的小部件的原始数据。
4.  如果你看看屏幕左侧的栏，你会注意到在“坐标”和“成绩”旁边有一个加号图标。这意味着这些字段仍然是嵌套的 JSON 格式，因为我们在最初的查询中没有扩展它们。没关系；我们也可以在这里扩展它们。为此，请单击等级旁边的加号图标，然后单击[*]旁边的加号图标。
5.  我们感兴趣的字段是“等级”字段。我们知道每个面包店都被给定了一个等级，我们想分析这些等级的分布，以找出每个等级的真正含义；饼状图应该可以做到这一点。为了设置您的饼图，将“等级”拖到“分组/维度:”上，然后将“等级”拖到“字段/指标:”上，并将“操作”从“无”更改为“计数”这将显示每个等级在我们的数据中出现的次数。
6.  如你所见，我们有 A 级、B 级、C 级，还有……P 级和 Z 级？还有一些被标为“尚未分级”P 级和 Z 级是相当罕见的，我们不知道它们意味着什么，所以我们最好摆脱它们。为此，请拖动您的“分数[*]。将“指标”改为“排序依据”，并将方向改为“降序”如你所见，最常见的成绩是 A、B 和 c。因为这是我们唯一感兴趣的 3 个成绩，所以请转到“Limit:”并输入 3。这将把我们的数据限制在 3 个最常见的等级。
7.  现在，转向“可视化”，将“可视化类型”改为“饼图”我们不希望保存和覆盖我们的地理聚类图，而是希望我们的饼图与其并排放置，因此，请前往屏幕的右上角，单击克隆图标，该图标类似于两张叠放在一起的纸。将您的小部件命名为“皇后面包店-等级分布”，然后单击“克隆”然后，点按“添加到仪表板”

作者图片

正如你从我们的饼状图中看到的，皇后区的面包店获得 A 级非常普遍，如果没有，他们几乎肯定会获得 B 级。这种等级的 C 级在这里就像在罗德学者的成绩单上一样罕见，所以我们可以得出结论，C 级可能是一个危险信号，而不是表明质量差，而不是平均或平庸的质量。这是非常有用的信息。

# 摘要

回顾一下，我们通过连接到 Couchbase 数据库并使用 Knowi 的基于搜索的分析功能查询我们数据库中的餐馆数据集来开始本教程，以使查询更容易。成功运行该查询将查询结果作为数据集存储在 Knowi 的弹性数据仓库中，并将预览图表作为小部件存储在 Knowi 帐户中。然后，我们创建了一个新的仪表板来存储我们的新部件，并创建了另一个部件来进一步分析我们的数据集并回答一个重要的问题。