<html>
<head>
<title>From DataFrame to Network Graph</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从数据框架到网络图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/from-dataframe-to-network-graph-bbb35c8ab675?source=collection_archive---------1-----------------------#2020-05-16">https://towardsdatascience.com/from-dataframe-to-network-graph-bbb35c8ab675?source=collection_archive---------1-----------------------#2020-05-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="70d9" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据科学/ Python代码片段</h2><div class=""/><div class=""><h2 id="2f2d" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用networkx和matplotlib可视化熊猫数据帧的快速入门指南。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/f84df0cef7f775c6a18e926fa9c05110.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9R71-SPtUiAfkwftOfN5sw.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@alinnnaaaa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Alina Grubnyak </a>在<a class="ae lh" href="https://unsplash.com/s/photos/networks?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="ca51" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">我非常偶然地发现了如何从JIRA导出数据，于是我开始想办法将信息可视化，并从数据集中收集一些见解。我偶然发现了网络图的概念，这个想法很快抓住了我的想象力。我意识到我不仅可以用它来讲述人与人之间的关系，还可以用它来讲述单词之间的关系。但是NLP是个大话题，我们先走后跑怎么样？！</em></p><p id="d94a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这只是一个非常温和的介绍，所以我们不会在这里使用任何花哨的代码。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><p id="532a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">网络图“显示了一组实体之间的互连”，其中实体是<code class="fe mm mn mo mp b">nodes</code>，它们之间的连接通过链接或<code class="fe mm mn mo mp b">edges</code>来表示。在下图中，点是节点，线称为边。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mq"><img src="../Images/b2a2ddffbede5ae43e5e86a89eb6a206.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*twgQLOInFDk4AvbobHyL5Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">马丁·格兰让/CC BY-SA(<a class="ae lh" href="https://creativecommons.org/licenses/by-sa/3.0" rel="noopener ugc nofollow" target="_blank">https://creativecommons.org/licenses/by-sa/3.0</a>)</p></figure><p id="afe3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在这篇文章中，我将分享一些代码，这些代码将让我们使用一个流行的网络图包来快速可视化熊猫数据帧:<a class="ae lh" href="https://networkx.github.io/" rel="noopener ugc nofollow" target="_blank"> networkx </a>。</p><p id="fa6d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，让我们获取数据并将其加载到dataframe中。你可以在这里下载样本数据集<a class="ae lh" href="https://github.com/ecdedios/networkx-quick-start" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="ks kt ku kv gt mr mp ms mt aw mu bi"><span id="9f92" class="mv mw it mp b gy mx my l mz na">import pandas as pd</span><span id="7fca" class="mv mw it mp b gy nb my l mz na">df = pd.read_csv('jira_sample.csv')</span></pre><p id="324b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其次，让我们裁剪数据帧，只包含我们想要检查的列。在这种情况下，我们只需要“受托人”和“报告人”列。</p><pre class="ks kt ku kv gt mr mp ms mt aw mu bi"><span id="8e0c" class="mv mw it mp b gy mx my l mz na">df1 = df[['Assignee', 'Reporter']]</span></pre><p id="b5fb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">第三，是时候创建图形将要存在的世界了。如果你还没有安装，通过快速的<code class="fe mm mn mo mp b">pip install networkx</code>来安装networkx包。</p><pre class="ks kt ku kv gt mr mp ms mt aw mu bi"><span id="6dfa" class="mv mw it mp b gy mx my l mz na">import networkx as nx</span><span id="c8c6" class="mv mw it mp b gy nb my l mz na">G = nx.Graph()</span></pre><p id="4a95" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后，让我们用来自<code class="fe mm mn mo mp b">df1</code>数据帧的<code class="fe mm mn mo mp b">'Assignee'</code>和<code class="fe mm mn mo mp b">'Reporter'</code>列填充图表。</p><pre class="ks kt ku kv gt mr mp ms mt aw mu bi"><span id="04f6" class="mv mw it mp b gy mx my l mz na">G = nx.from_pandas_edgelist(df1, 'Assignee', 'Reporter')</span></pre><p id="624b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来，我们将在matplotlib的帮助下具体化我们创建的图表以进行格式化。</p><pre class="ks kt ku kv gt mr mp ms mt aw mu bi"><span id="f718" class="mv mw it mp b gy mx my l mz na">from matplotlib.pyplot import figure</span><span id="15d6" class="mv mw it mp b gy nb my l mz na">figure(figsize=(10, 8))<br/>nx.draw_shell(G, with_labels=True)</span></pre><p id="6126" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面这个块中最重要的一行是<code class="fe mm mn mo mp b">nx.draw_shell(G, with_labels=True)</code>。它告诉计算机使用打开实体标签的shell布局来绘制图形<code class="fe mm mn mo mp b">G</code>。</p><p id="91b5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">瞧啊。我们得到了一个网络图:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nc"><img src="../Images/dc427c8e68884578856a7c648807de8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aQBx3b8PGiaA-clMJutRUQ.png"/></div></div></figure><p id="b21d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">马上，我们可以告诉有一个来自三个主要玩家的台词高度集中，“芭比娃娃”，“苏珊·李”和“乔·苹果籽”。当然，为了保险起见，用一些硬数字来证实我们的“目测”总是一个好主意。</p><p id="5413" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">奖励回合</strong></p><p id="c435" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们看看“芭比娃娃”。</p><pre class="ks kt ku kv gt mr mp ms mt aw mu bi"><span id="d764" class="mv mw it mp b gy mx my l mz na">G['barbie.doll']</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nd"><img src="../Images/874c33f5577017fa84683e06a72dbbaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T1SaVjdEvQbQlGbJMwwxbQ.png"/></div></div></figure><p id="5cae" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要查看“芭比娃娃”有多少联系，让我们使用<code class="fe mm mn mo mp b">len()</code>:</p><pre class="ks kt ku kv gt mr mp ms mt aw mu bi"><span id="148e" class="mv mw it mp b gy mx my l mz na">len(G['barbie.doll'])</span></pre><p id="b025" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">接下来，让我们创建另一个显示节点及其连接数的数据框架。</p><pre class="ks kt ku kv gt mr mp ms mt aw mu bi"><span id="08fe" class="mv mw it mp b gy mx my l mz na">leaderboard = {}</span><span id="a2d1" class="mv mw it mp b gy nb my l mz na">for x in G.nodes:<br/> leaderboard[x] = len(G[x])</span><span id="f3ed" class="mv mw it mp b gy nb my l mz na">s = pd.Series(leaderboard, name='connections')</span><span id="8a58" class="mv mw it mp b gy nb my l mz na">df2 = s.to_frame().sort_values('connections', ascending=False)</span></pre><p id="6b7e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在上面的代码块中，我们首先初始化了一个名为“leaderboard”的空字典，然后使用一个简单的for循环将名称和连接数填充到字典中。然后，我们从字典中创建了一个系列。最后，我们从使用<code class="fe mm mn mo mp b">to_frame()</code>创建的系列中创建了另一个数据帧。</p><p id="98f9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">要显示数据框，我们只需使用<code class="fe mm mn mo mp b">df2.head()</code>，我们就有了自己的排行榜！</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/e8856fb7ea58e669164eae4fe8f5efe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:804/format:webp/1*Sz7ONEhJGBZ8h_bZa9vjfQ.png"/></div></figure><p id="f992" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">就是这样！通过几行简单的代码，我们很快就从熊猫的数据帧中制作了一个网络图，甚至显示了一个带有名称和连接数的表格。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><p id="980d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我希望你喜欢这个。网络图分析是一个大话题，但我希望这个温和的介绍将鼓励你探索更多和扩大你的曲目。</p><p id="cf41" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">在下一篇文章中，我将通过Power BI的自定义可视化工具“网络导航器”到</em> <a class="ae lh" rel="noopener" target="_blank" href="/create-a-network-graph-in-power-bi-be232991ee06"> <em class="me">创建一个网络图</em> </a> <em class="me">，只需简单地点击几下鼠标。</em></p><p id="ecbd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="me">敬请期待！</em></p><p id="aa0a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以在Twitter或LinkedIn上找到我。</p><p id="73ad" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[1]:数据到即(2020年5月15日)。【https://www.data-to-viz.com/graph/network.html】网络图网络图<a class="ae lh" href="https://www.data-to-viz.com/graph/network.html" rel="noopener ugc nofollow" target="_blank">网络图</a></p></div></div>    
</body>
</html>