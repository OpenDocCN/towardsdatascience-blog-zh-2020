<html>
<head>
<title>Interaction effect in multiple regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多元回归中的交互效应</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/interaction-effect-in-multiple-regression-3091a5d0fadd?source=collection_archive---------8-----------------------#2020-03-04">https://towardsdatascience.com/interaction-effect-in-multiple-regression-3091a5d0fadd?source=collection_archive---------8-----------------------#2020-03-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5bc3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解交互效应以及如何使用Python sklearn库在数据集中识别交互效应。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/574bc0d38a2aa47429eec66735782e97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LG_qb_KPYAUgJzgCMeUsZA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://pixabay.com/images/id-3286017/" rel="noopener ugc nofollow" target="_blank">www.pixabay.com</a></p></figure><h1 id="2942" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">什么是互动效应？</strong></h1><p id="f83e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">互动效应不仅存在于统计学中，也存在于市场营销中。在市场营销中，这个相同的概念被称为协同效应。交互效应是指两个或更多的特征/变量组合在一起，与单独的单个变量的总和相比，对一个特征具有明显更大的影响。当我们试图研究几个变量对单个响应变量的影响时，在回归中理解这种影响是很重要的。</p><p id="1424" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">线性回归方程可以表示如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/b05be9786b28ddf52b5204e3af1b7126.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*Yaq0gpWuUr26sXFV1LW9zw.png"/></div></figure><p id="f2a8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这里，我们试图找到自变量(X₁和X₂)与响应变量y和ε之间的线性关系是不可约误差。为了检查预测变量和反应变量之间是否有任何显著的统计关系，我们进行了假设检验。如果我们对预测变量X₁进行测试，我们将有两个假设:</p><p id="baf1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">零假设(<strong class="lt iu">h₀</strong>):x₁和y之间没有关系(β₁ = 0)</p><p id="b80c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">另类假设(<strong class="lt iu">h₁</strong>):x₁and y(β₁≠0)之间有关系</p><p id="5b72" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后，我们根据p值决定是否拒绝零假设。假设零假设为真，p值是测试结果的概率。</p><p id="7fce" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">例如，如果我们在测试结果中得到非零值的β₁，这表明X₁和y之间存在关系。但如果p值很大，这表明即使零假设实际上为真，我们也很有可能得到非零值的β₁。在这种情况下，我们无法拒绝零假设，并得出结论，预测和反应变量之间没有关系。但是，如果p值很低(通常p值截止值被认为是0.05)，那么即使β₁的非零值很小，也表明预测值和响应变量之间存在显著关系。</p><p id="827c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果我们得出X₁和y之间有关系的结论，我们认为X₁每增加一个单位，y就增加/减少β₁个单位。在上面的线性方程中，我们假设X₁对y的影响与X₂.无关这也称为线性回归中的<strong class="lt iu">加法假设</strong>。</p><p id="773d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但是如果X₁对y的影响也依赖于X₂呢？我们可以在许多商业问题中看到这种关系。例如，我们想找出两种不同投资类型的投资回报率。本例的线性回归方程为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/c2960fb57397f644fa1a1924f1bc2329.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*qfKCCmtIh-LYDfeNwXSWxg.png"/></div></figure><p id="37b9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这个例子中，如果我们部分投资于这两种类型的投资，而不是完全投资于其中一种，可能会有更大的利润。例如，如果我们有1000单位的资金进行投资，将500单位的资金同时投资于这两种投资，与将1000单位的资金全部投资于其中一种投资相比，可以获得更大的利润。在这种情况下，投资1与投资回报的关系将取决于投资2。这种关系可以包含在我们的等式中，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/35dba356c14fa327861e17c1d291bd37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*Lgc5m0sCWEFE09R-fVijuQ.png"/></div></figure><p id="36b7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在上面的等式中，我们包括了投资1和投资2之间的“相互作用”,用于预测总投资回报。对于任何线性回归方程，我们都可以包括这样的相互作用</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/d71b286eac87df3a8906512332698dec.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*ddcfVkOQ7qbBhA55SyvKQg.png"/></div></figure><p id="df59" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">上述等式可以改写为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/08c462b4d7c66e5f3af074f67feef41e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*j093bG_isKWsCqOXbFLylg.png"/></div></figure><p id="2e74" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这里，β₃是相互作用项的系数。同样，为了验证回归中交互作用的存在，我们进行假设检验并检查我们系数的p值(在这种情况下是β₃).</p><h1 id="2d87" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">使用sklearn在数据集中查找交互术语</strong></h1><p id="0c9b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在让我们看看如何验证数据集中交互作用的存在。我们将使用自动数据集作为我们的例子。数据集可以从<a class="ae ky" href="https://www.kaggle.com/uciml/autompg-dataset" rel="noopener ugc nofollow" target="_blank">这里</a>下载。让我们看一下数据集</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="c8a3" class="nc la it my b gy nd ne l nf ng">import pandas as pd<br/>data = pd.read_csv('data/auto-mpg.csv')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/dd88b1d7116d090c6e40904ca3005b93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ccZk6o83bWe4jn6U2wCk6Q.png"/></div></div></figure><p id="b6d7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">将数据集转换为数字并填充缺失的值</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="fec7" class="nc la it my b gy nd ne l nf ng">#removing irrelevant 'car name' column<br/>data.drop('car name',axis=1,inplace=True)<br/>#converting all columns to numeric<br/>for col in data.columns:<br/>    data[col] = pd.to_numeric(data[col], errors ='coerce')<br/>#replacing missing values in horsepower with its median<br/>horse_med = data['horsepower'].median()<br/>data['horsepower'] = data['horsepower'].fillna(horse_med)</span></pre><p id="7bca" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们在这个数据集上拟合一个OLS(普通最小二乘法)模型。该模型存在于statsmodels库中。</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="6f21" class="nc la it my b gy nd ne l nf ng">from statsmodels.regression import linear_model<br/>X = data.drop('mpg', axis=1)<br/>y = data['mpg']<br/>model = linear_model.OLS(y, X).fit()</span></pre><p id="57aa" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从这个模型中，我们可以得到系数值，以及它们是否在统计上有意义，以包括在模型中。</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="3b19" class="nc la it my b gy nd ne l nf ng">model.summary()</span></pre><p id="4b60" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">下面是模型摘要的快照。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/0cd2ef7a5ccca566143f79987e8d8c07.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*MNBAJOTU9Fi6_vMvXAN6EQ.png"/></div></figure><p id="4317" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在上面的模型总结中，我们可以看到除了<strong class="lt iu">加速度、</strong>之外，其他所有特征的p值都小于0.05，具有统计学意义。即使<strong class="lt iu">加速度</strong>独立对<strong class="lt iu"> mpg的预测没有帮助，</strong>我们也有兴趣找出<strong class="lt iu">加速度</strong>在与其他变量相互作用后是否对<strong class="lt iu"> mpg有影响。</strong>此外，我们有兴趣了解所有重要交互术语的存在。</p><p id="6b18" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们首先需要创建所有可能的交互项。通过使用sklearn库中的<strong class="lt iu">多项式特性</strong>，这在python中是可能的</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="b375" class="nc la it my b gy nd ne l nf ng">from sklearn.preprocessing import PolynomialFeatures</span><span id="a783" class="nc la it my b gy nj ne l nf ng">#generating interaction terms<br/>x_interaction = PolynomialFeatures(2, interaction_only=True, include_bias=False).fit_transform(X)</span><span id="9900" class="nc la it my b gy nj ne l nf ng">#creating a new dataframe with the interaction terms included<br/>interaction_df = pd.DataFrame(x_interaction, columns = ['cylinders','displacement','horsepower','weight','acceleration','year','origin',<br/>                                                       'cylinders:displacement','cylinders:horsepower','cylinders:weight','cylinders:acceleration',<br/>                                                       'cylinders:year','cylinders:origin','displacement:horsepower','displacement:weight',<br/>                                                       'displacement:acceleration','displacement:year','displacement:origin','horsepower:weight',<br/>                                                       'horsepower:acceleration','horsepower:year','horsepower:origin','weight:acceleration',<br/>                                                       'weight:year','weight:origin','acceleration:year','acceleration:origin','year:origin'])</span></pre><p id="e89c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当创建了包括交互项的新数据框架时，我们可以为其拟合新的模型，并查看哪些交互项是重要的。</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="f374" class="nc la it my b gy nd ne l nf ng">interaction_model = linear_model.OLS(y, interaction_df).fit()</span></pre><p id="af5a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们只需要那些统计上有意义的相互作用项(p值小于0.05)</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="d1b1" class="nc la it my b gy nd ne l nf ng">interaction_model.pvalues[interaction_model.pvalues &lt; 0.05]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/ff0ea300d9103608040c842ec62f6365.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*M2C00HEC8ZYnhNeP6jdJDA.png"/></div></div></figure><p id="71bc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正如我们所看到的，存在交互项。另外，<strong class="lt iu">加速度</strong>本身并不重要，但是它与<strong class="lt iu">马力</strong>和<strong class="lt iu">年份</strong>的相互作用被证明对于<strong class="lt iu"> mpg的预测非常重要。</strong></p><p id="42e7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">值得注意的是，在上面的例子中，加速度<strong class="lt iu">的p值</strong>很高，但它包含在交互项中。在这种情况下，我们必须将<strong class="lt iu">加速度</strong>的<strong class="lt iu">主效应</strong>包括在模型中，即<strong class="lt iu">加速度</strong>的系数，即使由于<strong class="lt iu">等级原则它在统计上不显著。</strong>等级原则规定，如果在交互项中有两个特征X₁和X₂，我们必须在模型中包括它们的coefficients(β₁和β₂，即使与它们相关的p值非常高。</p></div></div>    
</body>
</html>