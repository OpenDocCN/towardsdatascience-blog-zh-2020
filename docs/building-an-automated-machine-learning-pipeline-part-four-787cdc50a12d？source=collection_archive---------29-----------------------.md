# æ„å»ºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ ç®¡é“:ç¬¬å››éƒ¨åˆ†

> åŸæ–‡ï¼š<https://towardsdatascience.com/building-an-automated-machine-learning-pipeline-part-four-787cdc50a12d?source=collection_archive---------29----------------------->

## [æœºå™¨å­¦ä¹ ](https://towardsdatascience.com/machine-learning/home)

## åˆ©ç”¨ Docker å’Œ Luigi å®ç°ç®¡é“è‡ªåŠ¨åŒ–

*   [ç¬¬ 1 éƒ¨åˆ†:ç†è§£ã€æ¸…ç†ã€æ¢ç´¢ã€å¤„ç†æ•°æ®](/building-an-automated-machine-learning-pipeline-part-one-5c70ae682f35?source=friends_link&sk=8de05327eedb3d0dadcfa4b1a8e8cc75)
*   [ç¬¬ 2 éƒ¨åˆ†:è®¾ç½®æŒ‡æ ‡å’ŒåŸºçº¿ï¼Œé€‰æ‹©å’Œè°ƒæ•´æ¨¡å‹](/building-an-automated-machine-learning-pipeline-part-two-1d3c86e6fe42?source=friends_link&sk=a005d5ead7a844adb7819403ddc6dc0e)
*   [ç¬¬ä¸‰éƒ¨åˆ†:åŸ¹è®­ã€è¯„ä¼°å’Œè§£é‡Šæ¨¡å‹](/building-an-automated-machine-learning-pipeline-a74acda76b98?source=friends_link&sk=1790d8dd404126a45828c3905f47432c)
*   ç¬¬ 4 éƒ¨åˆ†:ä½¿ç”¨ Docker å’Œ Luigi è‡ªåŠ¨åŒ–æ‚¨çš„ç®¡é“(æ‚¨ç°åœ¨æ­£åœ¨é˜…è¯»)

> **å…è´£å£°æ˜:**æœ¬æ–‡ç« ç³»åˆ—ä¸æ˜¯å…³äº Docker å’Œ Luigi çš„æ•™ç¨‹ã€‚è¿™æ˜¯â€œæ„å»ºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ ç®¡é“â€ç³»åˆ—æ–‡ç« çš„æœ€åä¸€ç¯‡ï¼Œè¯¥ç³»åˆ—æ–‡ç« é‡ç‚¹å…³æ³¨æ„å»ºç«¯åˆ°ç«¯çš„ ML ç®¡é“ï¼Œå¹¶å±•ç¤ºå¦‚ä½•ä½¿ç”¨è¿™ä¸¤ç§å·¥å…·çš„æŸäº›å…ƒç´ æ¥è‡ªåŠ¨åŒ–å®ƒã€‚å¦‚æœä½ é˜…è¯»äº†ä¸Šé¢é“¾æ¥ä¸­çš„å‰å‡ ç¯‡æ–‡ç« ï¼Œè¿™ç¯‡æ–‡ç« ä¼šå¯¹ä½ æ›´æœ‰æ„ä¹‰ã€‚

![](img/f6d537cb8d250f759cdaf694e7a28c57.png)

ç…§ç‰‡ç”±[åŸƒé‡Œå…‹Â·å…‹é²å°”](https://unsplash.com/@ekrull?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)åœ¨ [Unsplash](https://unsplash.com/collections/10621375/medium-ejcuhcdfwrs?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šæ‹æ‘„

åœ¨è¿™ä¸ªç³»åˆ—æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æˆ‘ä»¬çš„è¯¾ç¨‹è®¾ç½®ä¸ºæ„å»ºä¸€ä¸ª 9 æ­¥æœºå™¨å­¦ä¹ (ML)ç®¡é“ï¼Œå¹¶ä½¿ç”¨ Docker å’Œ Luigi å°†å…¶è‡ªåŠ¨åŒ–ã€‚

1.  ç†è§£ã€æ¸…ç†å’Œæ ¼å¼åŒ–æ•°æ®
2.  æ¢ç´¢æ€§æ•°æ®åˆ†æ
3.  ç‰¹å¾å·¥ç¨‹å’Œé¢„å¤„ç†
4.  è®¾ç½®è¯„ä¼°æŒ‡æ ‡å¹¶å»ºç«‹åŸºçº¿
5.  åŸºäºè¯„ä¼°åº¦é‡é€‰æ‹© ML æ¨¡å‹
6.  å¯¹æ‰€é€‰æ¨¡å‹æ‰§è¡Œè¶…å‚æ•°è°ƒæ•´
7.  è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹
8.  è§£é‡Šæ¨¡å‹é¢„æµ‹
9.  å¾—å‡ºç»“è®ºå¹¶è®°å½•å·¥ä½œ

ç”±äºè¿™ä¸ªç®¡é“ï¼Œæˆ‘ä»¬æ„å»ºäº†æˆ‘ä»¬çš„ ML è§£å†³æ–¹æ¡ˆï¼Œå¹¶å°†å…¶å‘½åä¸º ***è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨*** ï¼Œå› ä¸ºæˆ‘ä»¬è¯•å›¾ä½¿ç”¨æ ·æœ¬æ•°æ®é›†[æ¥æ¨æ–­ç”¨*ç‚¹*è¡¨ç¤ºçš„è‘¡è„é…’è´¨é‡ã€‚åœ¨ç¬¬ä¸€ç¯‡æ–‡ç« ](https://github.com/cereniyim/Wine-Rating-Predictor-ML-Model/blob/master/data_root/raw/wine_dataset.csv)çš„[ä¸­ï¼Œæˆ‘ä»¬å°†è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨çš„è¦æ±‚å®šä¹‰ä¸º:](/building-an-automated-machine-learning-pipeline-part-one-5c70ae682f35?source=friends_link&sk=8de05327eedb3d0dadcfa4b1a8e8cc75)

> **-å¯ä»¥ç†è§£**å› ä¸ºæˆ‘ä»¬çš„è§‚ä¼—å¯èƒ½å¯¹ç»Ÿè®¡å­¦å’Œ ML äº†è§£æœ‰é™ã€‚
> 
> **-é«˜æ€§èƒ½**å› ä¸ºå®Œæ•´çš„ç”Ÿäº§æ•°æ®é›†å¯èƒ½æœ‰æ•°ç™¾ä¸‡è¡Œã€‚
> 
> **-è‡ªåŠ¨åŒ–**ï¼Œå¯ä»¥åœ¨ä»»ä½•ç”Ÿäº§ç³»ç»Ÿä¸Šè¿è¡Œï¼Œä¸éœ€è¦ä¸“é—¨çš„é…ç½®å’Œè®¾ç½®ã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»æ»¡è¶³äº†**çš„å¯ç†è§£æ€§**å¹¶è§£å†³äº†**çš„æ€§èƒ½**â€”â€”åœ¨æŸç§ç¨‹åº¦ä¸Š:

*   æˆ‘ä»¬é€‰æ‹©äº†ä¸€ä¸ª**å¯ç†è§£çš„**æ¨¡å‹ï¼Œéšæœºæ£®æ—å›å½’å™¨ï¼Œä½œä¸ºè‘¡è„é…’è¯„çº§é¢„æµ‹å™¨çš„åº•å±‚ ML ç®—æ³•ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å·²ç»åœ¨ç¬¬äºŒç¯‡æ–‡ç« å’Œç¬¬ä¸‰ç¯‡æ–‡ç« ä¸­è§£é‡Šäº†éšæœºæ£®æ—å›å½’å™¨çš„å·¥ä½œåŸç†åŠå…¶è¶…å‚æ•°[ã€‚](/building-an-automated-machine-learning-pipeline-part-two-1d3c86e6fe42?source=friends_link&sk=a005d5ead7a844adb7819403ddc6dc0e)
*   æˆ‘ä»¬é€šè¿‡å¯¹éšæœºæ£®æ—å›å½’å™¨æ‰§è¡Œè¶…å‚æ•°è°ƒä¼˜ï¼Œæ„å»ºäº†ä¸€ä¸ª**æ€§èƒ½**æ¨¡å‹ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶æœ‰å®ƒçš„ç©ºé—´ã€‚

ä»Šå¤©ï¼Œæˆ‘ä»¬å°†æˆ´ä¸Šè½¯ä»¶å·¥ç¨‹å¸ˆçš„å¸½å­ï¼Œè§£å†³æœ€åä¸€ä¸ªéœ€æ±‚â€” **è‡ªåŠ¨åŒ–ã€‚æˆ‘ä»¬å°†ä» ML ç®¡é“ä¸­é‡‡å–ä»¥ä¸‹æ­¥éª¤ï¼Œåœ¨ Docker å®¹å™¨ä¸Šè¿è¡Œè¿™äº›æ­¥éª¤ï¼Œå¹¶å°†å®ƒä»¬ä¸ Luigi ä»»åŠ¡è¿æ¥èµ·æ¥ã€‚(ä¸è¦æ‹…å¿ƒï¼Œæˆ‘ä»¬å°†åœ¨æ•´ç¯‡æ–‡ç« ä¸­è¯¦ç»†é˜è¿°å®ƒä»¬ğŸ™‚)**

![](img/41b042e461eae7b411c12519e5fda477.png)

ML ç®¡é“çš„è‡ªåŠ¨åŒ–æµç¨‹

å¦‚æœä½ å·²ç»æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªé¢å¤–çš„æ­¥éª¤ï¼Œå› ä¸ºä¸€ä¸ªå…¸å‹çš„ç°å®ä¸–ç•Œçš„ ML ç®¡é“å¼€å§‹äºä»ä¸€ä¸ªæºè·å–æ•°æ®ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬åŒ…æ‹¬äº†è®­ç»ƒ-æµ‹è¯•æ•°æ®é›†åˆ†å‰²ï¼Œå…¶ä½™çš„æ˜¯ ML ç®¡é“çš„å·²çŸ¥æ­¥éª¤ã€‚

ä¸ºäº†è¿è¡Œä¸Šé¢çš„æµç¨‹ï¼Œæˆ‘ä»¬å°†é¦–å…ˆæŸ¥çœ‹ Docker å’Œ Luigiï¼Œå¹¶ç†è§£å®ƒä»¬åœ¨æœ¬ç³»åˆ—æ–‡ç« çš„ä¸Šä¸‹æ–‡ä¸­çš„ç”¨æ³•ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ä»è§£é‡Šè¿™äº›å·¥å…·åŠå…¶å¿…è¦å…ƒç´ å¼€å§‹ã€‚

ç„¶åï¼Œæˆ‘ä»¬å°†ä½¿ç”¨è¿™äº›å·¥å…·æ¥è¿æ¥è¿™äº›ç‚¹ã€‚æœ€ç»ˆï¼Œæˆ‘ä»¬å°†æŠŠè¿™äº›ç¢ç‰‡æ”¾åœ¨ä¸€èµ·ï¼Œè¿è¡Œæµç¨‹ï¼Œè¿™å°†å®Œæˆæˆ‘ä»¬çš„è‡ªåŠ¨åŒ–ä»»åŠ¡ï¼

1.  ä»€ä¹ˆæ˜¯ Dockerï¼Œå®ƒæ˜¯å¦‚ä½•ç”¨äºè‘¡è„é…’ç­‰çº§é¢„æµ‹çš„ï¼Ÿ
2.  ä»€ä¹ˆæ˜¯ Luigiï¼Œä¸ºä»€ä¹ˆé€‰æ‹©å®ƒä½œä¸ºç¼–æ’å·¥å…·ï¼Ÿ
3.  æŠŠ Docker å’Œ Luigi çš„ç¢ç‰‡æ”¾åœ¨ä¸€èµ·
4.  è¿è¡Œå’Œè‡ªåŠ¨åŒ–ç®¡é“ï¼

æ‚¨å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ° GitHub èµ„æºåº“:

[](https://github.com/cereniyim/Wine-Rating-Predictor-ML-Model) [## cereniyim/è‘¡è„é…’è¯„çº§é¢„æµ‹æ¨¡å‹

### åœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä¸ºä¸€ä¸ªåœ¨çº¿è‘¡è„é…’å–å®¶æ„å»ºäº†ä¸€ä¸ªè‘¡è„é…’è¯„çº§é¢„æµ‹å™¨ã€‚è¿™æ¬¾è‘¡è„é…’é¢„æµ‹å™¨æ—¨åœ¨æ˜¾ç¤ºè‰¯å¥½çš„â€¦

github.com](https://github.com/cereniyim/Wine-Rating-Predictor-ML-Model) 

åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œè¿˜æœ‰ä¸€ä¸ªå…è´£å£°æ˜:

> **å…è´£å£°æ˜:**åº“çš„ç»“æ„å’Œ`download_data.py`ã€`util.py`ã€`docker-clean.sh`ã€`docker-compose.yml`æ–‡ä»¶æä¾›ç»™æˆ‘ä½œä¸ºä»£ç æŒ‘æˆ˜çš„åŸºç¡€ã€‚å‰©ä¸‹çš„ä»£ç æ˜¯æˆ‘å†™çš„ã€‚

# 1.ä»€ä¹ˆæ˜¯ Dockerï¼Œå®ƒæ˜¯å¦‚ä½•ç”¨äºè‘¡è„é…’ç­‰çº§é¢„æµ‹çš„ï¼Ÿ

## Docker æ˜¯ä»€ä¹ˆï¼Ÿ

[ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Docker_(software))å¯¹ Docker çš„å®˜æ–¹å®šä¹‰å¦‚ä¸‹:

> Docker æ˜¯ä¸€å¥—å¹³å°å³æœåŠ¡äº§å“ï¼Œå®ƒä½¿ç”¨æ“ä½œç³»ç»Ÿçº§è™šæ‹ŸåŒ–æ¥äº¤ä»˜åä¸º**å®¹å™¨**çš„è½¯ä»¶åŒ…ä¸­çš„è½¯ä»¶ã€‚

æˆ‘å°†å®ƒå®šä¹‰ä¸ºä¸ºä½ çš„åº”ç”¨ç¨‹åº/è½¯ä»¶/æ•°æ®ç§‘å­¦/ML é¡¹ç›®åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Œè¿™æ ·å®ƒå¯ä»¥åœ¨ä»»ä½•æœ‰ Docker çš„ç³»ç»Ÿä¸Šæ— ç¼è¿è¡Œã€‚

## **æˆ‘ä»¬å¦‚ä½•ç”¨ Docker åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼Ÿ**

ç»ç”±**å®¹å™¨**ã€‚å®ƒä»¬æ˜¯è¿è¡Œæ‚¨çš„åº”ç”¨ç¨‹åºçš„ç‹¬ç«‹è™šæ‹Ÿç¯å¢ƒï¼Œå¯¹äºæˆ‘ä»¬çš„æƒ…å†µï¼Œæ˜¯ ML è§£å†³æ–¹æ¡ˆã€‚

## æˆ‘ä»¬å¦‚ä½•åˆ›å»º Docker å®¹å™¨ï¼Ÿ

æ¥è‡ª**å›¾åƒ**ã€‚å®ƒä»¬æ˜¯ç”¨äºåˆ›å»ºå®¹å™¨çš„æ¨¡æ¿ã€‚å®ƒä»¬åŒ…å«å…³äºåº•å±‚æ“ä½œç³»ç»Ÿã€ç¯å¢ƒå’Œåº“çš„ä¿¡æ¯ï¼Œä»¥åŠç‰ˆæœ¬ã€‚

## æˆ‘ä»¬å¦‚ä½•åˆ›å»º Docker å›¾åƒï¼Ÿ

é€šè¿‡é˜…è¯»æ¥è‡ª**æ¡£æ¡ˆçš„æŒ‡ä»¤ã€‚**å®ƒæ˜¯ä¸€ç»„ç”¨æˆ·å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸Šè°ƒç”¨æ¥åˆ›å»ºå›¾åƒçš„æŒ‡ä»¤å’Œå‘½ä»¤ã€‚ä½ å¯ä»¥ç”¨`docker build Dockerfile -t <image_name>`å‘½ä»¤åœ¨ä½ çš„ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªæœ¬åœ°é•œåƒã€‚

## å›¾åƒå’Œå®¹å™¨æ˜¯å¦‚ä½•è¿æ¥çš„ï¼Ÿ

**å®¹å™¨**æ˜¯**å›¾åƒ**çš„è¿è¡Œå®ä¾‹ã€‚è¿è¡Œæ˜ åƒæ—¶ï¼Œæ‚¨ä¼šåˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼Œå®ƒæ˜¯ä¸€ä¸ªéš”ç¦»çš„ç¯å¢ƒã€‚

## æˆ‘ä»¬æ˜¯å¦‚ä½•ä½¿ç”¨ Docker æ„å»ºè‘¡è„é…’è¯„çº§é¢„æµ‹å™¨çš„ï¼Ÿ

æˆ‘ä»¬ä½¿ç”¨ Docker æ„å»ºè™šæ‹Ÿç¯å¢ƒå¹¶ç®¡ç†åº“çš„ä¾èµ–å…³ç³»ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ— ç¼åœ°è¿è¡Œæµç¨‹ã€‚ä¸‹é¢çš„ ***è‡ªåŠ¨åŒ–æµç¨‹*** è¢«è®¾è®¡æˆæ¯ä¸ªç›’å­åœ¨ä¸€ä¸ªå•ç‹¬çš„ Docker å®¹å™¨ä¸Šè¿è¡Œã€‚

![](img/ea84977b3ecb9830027bc946cc419ddd.png)

è‡ªåŠ¨åŒ–æµç¨‹

![](img/1fb02bcdb224b7f515a5857a6cc392d5.png)

è‘¡è„é…’ç­‰çº§é¢„æµ‹åº“çš„ç»“æ„

æˆ‘ç›¸ä¿¡ä½ å·²ç»æ³¨æ„åˆ°äº†å­˜å‚¨åº“ä¸­ä¸€äº›æˆ‘ä»¬è¿˜æ²¡æœ‰æåˆ°çš„ç›®å½•å’Œæ–‡ä»¶ã€‚æ‚¨å¯ä»¥å°†`download_data`ã€`make_dataset`ã€`clean_data`ã€`extract_features`ã€`transform_data`ã€`impute_data`ã€`train_model`å’Œ`evaluate_model`ç›®å½•è§†ä¸ºè‡ªåŠ¨åŒ–æµç¨‹ä¸­ç›’å­çš„è¾¹ç•Œï¼Œè¯¥æµç¨‹åŒ…å« docker æ–‡ä»¶å’Œ Python æ–‡ä»¶å½¢å¼çš„æºä»£ç ã€‚

åœ¨çœ‹å¦‚ä½•åˆ›å»º Dockerfile ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹`base_docker`åœ¨è¿™é‡Œçš„ç”¨æ³•ã€‚

![](img/53849d7d1685348a4ffa491abb4c0ac9.png)

åœ¨è‡ªåŠ¨åŒ–æµç¨‹ä¸­ä½¿ç”¨åŸºæœ¬ Docker

è‡ªåŠ¨åŒ–æµç¨‹çš„æ¯ä¸€æ­¥éƒ½åœ¨ä¸€ä¸ªå•ç‹¬çš„å®¹å™¨ä¸Šè¿è¡Œã€‚ç„¶è€Œï¼Œå®ƒä»¬æ˜¯ç”¨ Python ç¼–å†™çš„æ¨¡å—ï¼Œå®ƒä»¬ä¹‹é—´å”¯ä¸€çš„åŒºåˆ«æ˜¯ä½¿ç”¨çš„åº“ã€‚å› æ­¤ï¼Œ`base_docker`ç”¨äºæŒ‡å®šå…¬å…±ç¯å¢ƒå˜é‡å¹¶å®‰è£…æ‰€éœ€çš„ Python ç‰ˆæœ¬å’Œåº“ã€‚å®ƒä¹Ÿæœ‰åŠ©äºè‘¡è„é…’è¯„çº§é¢„æµ‹å™¨çš„æ€§èƒ½ï¼Œåªéœ€å®‰è£…ä¸€æ¬¡æ‰€éœ€çš„è½¯ä»¶åŒ…ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½å®‰è£…åœ¨å•ç‹¬çš„å®¹å™¨ä¸Šã€‚

## å¦‚ä½•å†™ Dockerfile æ–‡ä»¶

å½“åˆ›å»º docker æ–‡ä»¶æ—¶ï¼Œå°±åƒåœ¨æ‚¨çš„æœºå™¨ä¸Šåˆ›å»ºæœ¬åœ°ç¯å¢ƒä¸€æ ·å¼€å§‹æ‰§è¡Œè¿™äº›æ­¥éª¤ã€‚è€ƒè™‘åˆ°æ‚¨çš„ç›®æ ‡æ˜¯ä½¿ç”¨ Python éƒ¨ç½² ML è§£å†³æ–¹æ¡ˆï¼Œæ‚¨å¯ä»¥åœ¨ [Docker Hub](https://hub.docker.com/search?q=python&type=image) ä¸­çš„ç°æœ‰ Python æ˜ åƒä¹‹ä¸Šæ„å»ºæ‚¨çš„æ˜ åƒã€‚è¿™é‡Œå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯[é€‰æ‹©ä¸€ä¸ªé€‚åˆä½ æƒ…å†µçš„ç°æœ‰ Python å›¾åƒ](https://pythonspeed.com/articles/base-image-python-docker-images/)ï¼Œå› ä¸ºæœ‰å‡ ä¸ªç‰ˆæœ¬å’Œå¤§å°å¯ä¾›é€‰æ‹©ã€‚

```
FROM python:3.7-slim
ENV LC_ALL=C.UTF-8
ENV LANG=C.UTF-8
ENV PYTHONPATH=/opt/orchestrator:$PYTHONPATH

COPY requirements.txt /opt/base_docker/

RUN pip install -r /opt/base_docker/requirements.txt

WORKDIR /opt/base_docker/
```

é€‰æ‹©äº†`slim`å˜é‡ï¼Œå¹¶æŒ‡å®šäº† Python ç‰ˆæœ¬`3.7`ï¼Œä¸æˆ‘çš„æœ¬åœ°ç³»ç»Ÿä¸­çš„ Python ç‰ˆæœ¬ç›¸åŒã€‚

![](img/a7957b27926ddd29ad09b737c6fa3e0b.png)

requirements.txt æˆªå›¾

`ENV`å‘½ä»¤ç”¨äºæ›´æ–°å®¹å™¨å®‰è£…çš„åº•å±‚æ“ä½œç³»ç»Ÿçš„`PATH`ç¯å¢ƒå˜é‡(å¯¹äºæˆ‘ä»¬çš„ä¾‹å­æ˜¯`Python 3.7-slim`)ã€‚

å¸¦æœ‰`requirements.txt`ä¸­æåˆ°çš„ç‰ˆæœ¬çš„åº“è¢«å¤åˆ¶å¹¶ä¸`pip_install`ä¸€èµ·å®‰è£…ã€‚é™¤äº†å‰é¢æåˆ°çš„ Python åº“ä¹‹å¤–ï¼Œè¿˜å®‰è£…äº†`click`â€”â€”ç¨åå°†è¯¦ç»†ä»‹ç»å®ƒçš„ç”¨æ³•ã€‚

ä½œä¸ºæœ€åä¸€æ¡æŒ‡ä»¤ï¼ŒDocker å®¹å™¨çš„å·¥ä½œç›®å½•ç”¨`WORKDIR` å‘½ä»¤å®šä¹‰ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬çš„`base_docker`å·²ç»å‡†å¤‡å¥½äº†ï¼Œä»è‡ªåŠ¨åŒ–æµç¨‹ä¸­æ¢ç´¢ä»»ä½•**docker æ–‡ä»¶**å°±è¶³å¤Ÿäº†ï¼Œå› ä¸ºæ‰€æœ‰å…¶ä»–**docker æ–‡ä»¶**éƒ½æ˜¯ç”¨ç›¸åŒçš„é€»è¾‘ç¼–å†™çš„ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªæ¥è‡ª`clean_data`çš„ä¾‹å­:

```
FROM code-challenge/base-dockerCOPY . /opt/clean_data/

WORKDIR /opt/clean_data/
```

ç°åœ¨æˆ‘ä»¬çš„åŸºåœ°å½¢è±¡å˜æˆäº†`base_docker`ã€‚å¤åˆ¶`clean_data`ç›®å½•ä¸­çš„æ¯ä¸ªæ–‡ä»¶ï¼Œå¹¶åˆ›å»º Docker å®¹å™¨çš„å·¥ä½œç›®å½•ã€‚

æ˜¯æ—¶å€™çœ‹çœ‹ Spotify å¿ƒçˆ±çš„ Luigi äº†ï¼

# 2.ä»€ä¹ˆæ˜¯ Luigiï¼Œä¸ºä»€ä¹ˆé€‰æ‹©å®ƒä½œä¸ºç¼–æ’å·¥å…·ï¼Ÿ

## ä»€ä¹ˆæ˜¯è·¯æ˜“å‰ï¼Ÿ

[æ¥è‡ªæ–‡ä»¶](https://luigi.readthedocs.io/en/stable/)çš„å®˜æ–¹å®šä¹‰å¦‚ä¸‹:

> Luigi æ˜¯ä¸€ä¸ª Python åŒ…ï¼Œå¯ä»¥å¸®åŠ©æ‚¨æ„å»ºæ‰¹å¤„ç†ä½œä¸šçš„å¤æ‚ç®¡é“ã€‚å®ƒå¤„ç†ä¾èµ–å…³ç³»è§£æã€å·¥ä½œæµç®¡ç†ã€å¯è§†åŒ–ã€å¤„ç†æ•…éšœã€å‘½ä»¤è¡Œé›†æˆç­‰ç­‰ã€‚

å®ƒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªç¼–æ’å·¥å…·ï¼Œå°†è®¸å¤šä»»åŠ¡ç¼åˆåœ¨ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾(DAG)ç»“æ„ä¸­:

![](img/4ea64fe3b78a4cb02516da80bdd1859a.png)

æœ‰å‘æ— ç¯å›¾ç¤ºä¾‹ã€‚å›¾ç‰‡æ¥æº:[ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Directed_acyclic_graph)

## ä¸ºä»€ä¹ˆé€‰æ‹©å®ƒä½œä¸ºç¼–æ’å·¥å…·ï¼Ÿ

å½“ä½ æ„å»ºä¸€ä¸ª ML è§£å†³æ–¹æ¡ˆï¼Œéšç€è§„æ¨¡çš„å¢é•¿ï¼Œè¿™å¾ˆå®¹æ˜“å˜å¾—å¤æ‚å’Œæ··ä¹±ã€‚Luigi æ˜¯ä¸€ä¸ªå¥å£®çš„å·¥ä½œæµç®¡ç†å·¥å…·ï¼Œå¯ä»¥é˜²æ­¢æ··ä¹±å’Œå¤æ‚ã€‚

## Luigi å¦‚ä½•ä½œä¸ºä¸€ä¸ªç¼–æ’å·¥å…·å·¥ä½œï¼Ÿ

Luigi æœ‰ä¸¤ä¸ªåŸºæœ¬æ„ä»¶:**ä»»åŠ¡**å’Œ**ç›®æ ‡**

## ä»€ä¹ˆæ˜¯ Luigi ä»»åŠ¡ï¼Ÿ

å·¥ä½œæµçš„æ­¥éª¤æ˜¯**ä»»åŠ¡**ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªå•ç‹¬çš„å·¥ä½œå•å…ƒï¼Œåœ¨è¿™é‡Œå®Œæˆè®¡ç®—ã€‚Luigi å·¥ä½œæµå»ºç«‹åœ¨ä»»åŠ¡ä¹‹ä¸Šã€‚

## Luigi ä»»åŠ¡æ˜¯å¦‚ä½•è¿æ¥çš„ï¼Ÿ

æ¯ä¸ªä»»åŠ¡éƒ½ä¸ä¸€ä¸ª**ç›®æ ‡**ç›¸å…³è”ã€‚ç›®æ ‡å¯ä»¥æ˜¯æ–‡ä»¶ã€å·¥ä½œæµä¸­çš„æ£€æŸ¥ç‚¹æˆ–ä»»åŠ¡ç”Ÿæˆçš„ä»»ä½•ç±»å‹çš„**è¾“å‡º**ã€‚

![](img/d41ef29492676204ff47aa9c83229a89.png)

è‡ªåŠ¨åŒ–æµç¨‹ä¸­çš„æ¯ä¸€æ­¥éƒ½æ˜¯ä¸€é¡¹ä»»åŠ¡

æˆ‘ä»¬æ­£åœ¨è½¬å‚¨`data_root`ä¸­æ¯ä¸ªä»»åŠ¡ç”Ÿæˆçš„è¾“å‡º:

![](img/b52a79c2d1352123cd12deef322da78e.png)

åœ¨æµç¨‹ä¸­ï¼Œé™¤äº†åˆå§‹ä»»åŠ¡`download_data`ä¹‹å¤–ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½ä¾èµ–äºå‰ä¸€ä¸ªä»»åŠ¡çš„è¾“å‡ºã€‚æ¯ä¸ªæ–‡ä»¶éƒ½ä½œä¸ºä¸€ä¸ª`Parameter`ä¼ é€’ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥è¢«å·¥ä½œæµä¸­çš„åç»­æ­¥éª¤ä½¿ç”¨ã€‚

![](img/8fb4730ac1181c7ba8092fe8e6b69b7b.png)

æ¯ä¸ªä»»åŠ¡äº§ç”Ÿçš„è¾“å‡º

åœ¨è®¾è®¡å·¥ä½œæµæ—¶ï¼ŒLuigi æ¨èåŸå­ç»“æ„:æ¯ä¸ªä»»åŠ¡åº”è¯¥æœ‰ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä½œä¸ºè¾“å‡ºï¼Œå°±åƒåœ¨`download_data`å’Œ`train_model`ä»»åŠ¡ä¸­ä¸€æ ·ã€‚

å¯¹äºå…¶ä½™çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬ç”¨`SUCCESS`æ——æ¨¡æ‹ŸåŸå­æ€§ã€‚å½“æˆ‘ä»¬åœ¨è®­ç»ƒå’Œæµ‹è¯•æ•°æ®é›†ä¸Šæ‰§è¡Œè®¡ç®—æ—¶ï¼Œåœ¨å°†è¾“å‡ºæ–‡ä»¶è½¬å‚¨åˆ°ç›®å½•ä¸­ä¹‹åï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª`SUCCESS`æ ‡å¿—ä½œä¸ºä»»åŠ¡çš„è¾“å‡ºã€‚è¿™æ ·ï¼Œä¸‹ä¸€ä¸ªä»»åŠ¡åªæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª`SUCCESS`æ ‡å¿—ã€‚

## æˆ‘ä»¬å¦‚ä½•å®šä¹‰ä»»åŠ¡ä¾èµ–å…³ç³»ï¼Ÿ

ä»»åŠ¡ä¾èµ–æ˜¯ç”¨`requires()`æ–¹æ³•å®šä¹‰çš„ã€‚ä»¥ä¸‹æ˜¯ Luigi æ–‡æ¡£ä¸­çš„ä»»åŠ¡æ¦‚è¦:

![](img/5204170ef6951b4e985717e98f840b18.png)

Luigi ä»»åŠ¡çš„æ¦‚è¦ã€‚å›¾ç‰‡æ¥æº: [luigi.readthedocs.io](https://luigi.readthedocs.io/en/stable/tasks.html)

å¯¹äºæˆ‘ä»¬çš„ä¾‹å­ï¼Œä»»åŠ¡ä¾èµ–æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå› ä¸ºæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªçº¿æ€§çš„è‡ªåŠ¨åŒ–æµç¨‹ã€‚

## æˆ‘ä»¬å¦‚ä½•è¿è¡Œ Luigi å·¥ä½œæµï¼Ÿ

ä¸å¹¸çš„æ˜¯ï¼ŒLuigi æ²¡æœ‰è§¦å‘æœºåˆ¶ã€‚å¦‚æœè¦è¿è¡Œ Luigi å·¥ä½œæµï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡ŒæŒ‡å®šæ¨¡å—åç§°å’Œé¡¹ç›®ç›®å½•ä¸­çš„æœ€åä¸€é¡¹ä»»åŠ¡:

```
luigi --module <modul_name> <task_name> 
```

å½“å·¥ä½œæµè¢«è§¦å‘æ—¶ï¼ŒLuigi æ£€æŸ¥ä¸Šä¸€æ­¥çš„è¾“å‡ºæ˜¯å¦å­˜åœ¨ã€‚å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆå®ƒå‘åæ£€æŸ¥å‰ä¸€æ­¥éª¤çš„è¾“å‡ºæ˜¯å¦å­˜åœ¨ã€‚å¯¹äºæˆ‘ä»¬çš„ä¾‹å­ï¼Œè¿™å°†æ˜¯`train_model`ã€`impute_data`ã€`transform_data`ã€`extract_features`ã€`clean_data`ã€`make_dataset`å’Œ`download_data`ã€‚

å¦‚æœæ¥è‡ªæµç¨‹ä¸­ä»»ä½•ä¸€æ­¥çš„ä»»åŠ¡è¾“å‡ºå­˜åœ¨ï¼ŒLuigi å°†ä»å®ƒç¦»å¼€çš„åœ°æ–¹ç»§ç»­æµç¨‹ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨å’Œé‡è¦çš„ç‰¹æ€§ï¼Œå¯ä»¥é˜²æ­¢ ML ç®¡é“åœ¨åŒ…å«éƒ¨åˆ†æ•°æ®æ—¶å´©æºƒã€‚

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº† Luigi å’Œ Docker çš„åŸºæœ¬å…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­å®Œæˆè¿™å¹…ç”»äº†ï¼

# 3.æŠŠ Docker å’Œ Luigi çš„ç¢ç‰‡æ”¾åœ¨ä¸€èµ·

æˆ‘ä»¬å°†æŠŠ Docker å’Œ Luigi çš„ç‰‡æ®µæ”¾åœ¨`docker-compose.yml`å’Œ`orchestrator`ç›®å½•ä¸­ã€‚

ç”±[æ•°æ®æ”¶å…¥çš„ä»¤äººæ•¬ç•çš„å·¥ç¨‹å¸ˆ](https://www.datarevenue.com/en-our-team#the-team)æä¾›çš„æ•ˆç”¨å‡½æ•°å·²ç»ä½¿æˆ‘èƒ½å¤Ÿè¿æ¥ Docker å’Œ Luigi çš„ç‰‡æ–­ã€‚`util.py`ä¸­å¯ç”¨çš„å‡½æ•°å’Œç±»åœ¨è¿æ¥ Docker å’Œ Luigi çš„è‘¡è„é…’è¯„çº§é¢„æµ‹å™¨ä¸­å‘æŒ¥äº†é‡è¦ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œ`DockerTask` â€”æˆ‘ä»¬ä½œä¸ºå‚æ•°åœ¨ä»»åŠ¡ä¹‹é—´ä¼ é€’çš„å¯¹è±¡â€” [é€šå¸¸åœ¨ Luigi](https://luigi.readthedocs.io/en/stable/parameters.html) ä¸­ä¸èƒ½ä½œä¸ºå‚æ•°ä½¿ç”¨ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹`orchestrator`ç›®å½•ä¸­çš„`task.py`ï¼Œåœ¨é‚£é‡Œæˆ‘ä½¿ç”¨å®ç”¨ç¨‹åºæ„å»ºäº†è‡ªåŠ¨åŒ–æµç¨‹ã€‚é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬æ¥ç†è§£ä¸€ä¸‹`docker-compose.yml`çš„ç›®çš„ã€‚

## åœ¨ Task.py ä¸­å®šä¹‰ä»»åŠ¡

*   **Luigi å‚æ•°:**æ¯ä¸ªä»»åŠ¡éƒ½ä»¥ä¸€ä¸ª Luigi `Parameter`å¯¹è±¡å¼€å§‹ï¼Œæˆ‘ä»¬åœ¨å…¶ä¸­æŒ‡å®šä»»åŠ¡çš„è¾“å…¥/è¾“å‡ºæ–‡ä»¶å’Œç›®å½•ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ä½¿ç”¨æµ‹è¯•é›†è¯„ä¼° ML æ¨¡å‹çš„æœ€åä¸€ä¸ªä»»åŠ¡`EvaluateModel`å°†`test_features`ã€`test_target`å’Œç»è¿‡è®­ç»ƒçš„æ¨¡å‹æ–‡ä»¶(`model.sav`)ä½œä¸ºè¾“å…¥ Luigi `Parameter`ã€‚ç”±äºè¿™ä¸ªä»»åŠ¡åˆ›å»ºäº†å¤šä¸ªæ–‡ä»¶ä½œä¸ºè¾“å‡º(`PredictionsVSActuals.png`å’Œ`FeatureImportances.png`)ï¼Œæˆ‘ä»¬è¿˜å®šä¹‰äº†ä¸€ä¸ª`SUCCESS`æ ‡å¿—æ¥æ¨¡æ‹ŸåŸå­æ€§ã€‚
*   **Image:** æˆ‘ä»¬å®šä¹‰ä½¿ç”¨å“ªä¸ª Docker å›¾åƒæ¥åˆ›å»ºå®¹å™¨ã€‚
*   **ä¾èµ–ä»»åŠ¡:**å¦‚æœæœ‰ä¾èµ–ä»»åŠ¡ï¼Œåœ¨è¿™é‡Œç”¨`requires()`æ–¹æ³•å®šä¹‰ã€‚`EvaluateModel`çš„ä»å±ä»»åŠ¡æ˜¯`TrainModel`ã€‚
*   **å‘½ä»¤:**å®¹å™¨è¦æ‰§è¡Œçš„å‘½ä»¤ã€‚æ­¤å¤„å‘½ä»¤ç”¨ç›¸å…³å‚æ•°è°ƒç”¨`evaluate_model.py`ä¸­å¯ç”¨çš„æºä»£ç ã€‚
*   **è¾“å‡º:**`output()`æ–¹æ³•è¿”å›ä¸€ä¸ªæˆ–å¤šä¸ªç›®æ ‡å¯¹è±¡(è¾“å‡ºæ–‡ä»¶æˆ–`SUCCESS`æ ‡å¿—)

å›æƒ³ä¸€ä¸‹ï¼Œæµç¨‹ä¸­æ¯ä¸€æ­¥çš„æºä»£ç éƒ½ä»¥ Python æ–‡ä»¶çš„å½¢å¼å­˜åœ¨äºå„è‡ªçš„ç›®å½•ä¸­ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹`train_model`çš„æºä»£ç :

åœ¨å®šä¹‰äº†åŠ©æ‰‹å‡½æ•°`convert_features_to_array`å’Œ`convert_target_to_array`ä¹‹åï¼Œæˆ‘ä»¬å®šä¹‰äº†å¿…è¦çš„ç‚¹å‡»å‘½ä»¤ã€‚

[ç‚¹å‡»](https://click.palletsprojects.com/en/7.x/)ï¼Œå¦‚å®˜æ–¹æ–‡ä»¶ä¸­æ‰€å®šä¹‰:

> è¿™æ˜¯ä¸€ä¸ª Python åŒ…ï¼Œç”¨äºä»¥å¯ç»„åˆçš„æ–¹å¼ç”¨å°½å¯èƒ½å°‘çš„ä»£ç åˆ›å»ºæ¼‚äº®çš„å‘½ä»¤è¡Œç•Œé¢ã€‚

![](img/411aa64733ac5cd67664c933e8d6989d.png)

å¦‚ä½•ä½¿ç”¨ç‚¹å‡»å‘½ä»¤ã€‚å›¾ç‰‡æ¥æº:[click.palletsprojects.com](https://click.palletsprojects.com/en/7.x/)

æˆ‘ä»¬ä½¿ç”¨ Click ä»å‘½ä»¤è¡Œå‘ python è„šæœ¬ä¼ é€’å‚æ•°ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬åœ¨è®­ç»ƒæ•°æ®é›†ä¸Šçš„ ***å¯¹æ‰€é€‰æ¨¡å‹æ­¥éª¤*** æ‰§è¡Œè¶…å‚æ•°è°ƒæ•´ä¸­å†³å®šçš„å¾®è°ƒå‚æ•°æ¥è®­ç»ƒæ¨¡å‹ã€‚æœ€åï¼Œæˆ‘ä»¬å°†è®­ç»ƒå¥½çš„æ¨¡å‹ä¿å­˜åœ¨`model.sav`æ–‡ä»¶ä¸­ä½œä¸ºè¾“å‡ºã€‚

## Docker ç¼–å†™å™¨çš„ä½¿ç”¨

[æ ¹æ® Docker æ–‡æ¡£](https://docs.docker.com/compose/)ç¼–å†™ Docker çš„å®˜æ–¹å®šä¹‰å¦‚ä¸‹:

> Compose æ˜¯ä¸€ä¸ªå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨ Docker åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚ä½¿ç”¨ Composeï¼Œ[æ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ª YAML æ–‡ä»¶](/5-reasons-to-use-yaml-files-in-your-machine-learning-projects-d4c7b9650f27)æ¥é…ç½®æ‚¨çš„åº”ç”¨ç¨‹åºçš„æœåŠ¡ã€‚ç„¶åï¼Œåªéœ€ä¸€ä¸ªå‘½ä»¤ï¼Œæ‚¨å°±å¯ä»¥ä»æ‚¨çš„é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚

è¿™ä¸ªå®šä¹‰é€‚åˆæˆ‘ä»¬çš„æƒ…å†µï¼Œå› ä¸ºæˆ‘ä»¬åœ¨åŒ…æ‹¬`base_docker`åœ¨å†…çš„ 9 ä¸ªå®¹å™¨ä¸Šè¿è¡Œè‡ªåŠ¨åŒ–æµç¨‹ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»æ›´å¤šå…³äº`docker-compose`T20 çš„ç”¨æ³•å’Œå‘½ä»¤ã€‚

è¿™é‡Œå¯¹æˆ‘ä»¬æ¥è¯´é‡è¦çš„éƒ¨åˆ†è¿è¡Œ Luigi ä»»åŠ¡çš„å‘½ä»¤å†™åœ¨è¿™é‡Œï¼Œæ‰€ä»¥å½“æˆ‘ä»¬é€šè¿‡`docker-compose`è¿è¡Œå®¹å™¨æ—¶ï¼Œå®ƒå°†é€šè¿‡`luigi â€” module task EvaluateModel-scheduler-host luigiid`å‘½ä»¤è§¦å‘è‡ªåŠ¨åŒ–æµç¨‹ã€‚

# 4.è¿è¡Œå’Œè‡ªåŠ¨åŒ–ç®¡é“ï¼

è¿™æ˜¯å…³é”®æ—¶åˆ»ï¼æˆ‘ä»¬å°†è¿è¡Œè‡ªåŠ¨åŒ–æµç¨‹ï¼Œå¹¶è‡ªåŠ¨åŒ– 9 æ­¥ ML ç®¡é“ã€‚è¿™æ˜¯æœ€åä¸€æ­¥ï¼Œå†åšæŒä¸€åˆ†é’ŸğŸ˜‰

## **1ã€‚æ‰“å¼€æ‚¨çš„ç»ˆç«¯å¹¶å¯¼èˆªåˆ°é¡¹ç›®ç›®å½•**

å¯¹æˆ‘æ¥è¯´è¿™æ˜¯:

```
cd GitHub/Wine-Rating-Predictor-ML-Model
```

## 2.æ„å»º Docker å®¹å™¨

æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ª shell è„šæœ¬æ¥æ„å»º Docker å®¹å™¨`build-task-images.sh`ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ„å»ºå¤šä¸ª Docker å®¹å™¨

```
./build-task-images.sh 0.1
```

ä¸‹é¢çš„æ¶ˆæ¯æ˜¾ç¤ºå®¹å™¨æ„å»ºæˆåŠŸã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è§¦å‘è‡ªåŠ¨åŒ–æµç¨‹äº†ã€‚

```
**Successfully tagged code-challenge/evaluate-model:0.1**
```

## 4.ä» Docker ç¼–å†™è§¦å‘è‡ªåŠ¨åŒ–æµç¨‹:

æˆ‘ä»¬å°†é€šè¿‡ä»¥ä¸‹æ–¹å¼è§¦å‘å·¥ä½œæµ

```
docker-compose up orchestrator
```

åœ¨å†™è¿™ä¸ªå‘½ä»¤æ—¶ï¼ŒLuigi æ£€æŸ¥æ¯ä¸ªä»»åŠ¡æ˜¯å¦å®Œæˆï¼Œå¹¶è¾“å‡ºä»¥ä¸‹ä¿¡æ¯:

```
**Checking if EvaluateModel(
    no_remove_finished=False,
    in_test_features_csv=/usr/share/data/interim/test_features.csv,
    in_test_target_csv=/usr/share/data/interim/test_target.csv,
    in_trained_model=/usr/share/data/output/model.sav,
    out_dir=/usr/share/data/output/, 
    flag=.SUCCESS_EvaluateModel)** **is complete****Checking if TrainModel(
   no_remove_finished=False,
   in_train_features_csv=/usr/share/data/interim/train_features.csv,
   in_train_target_csv=/usr/share/data/interim/train_target.csv,
   out_dir=/usr/share/data/output/)** **is complete****Checking if ImputeData(
    no_remove_finished=False,
    in_train_csv=/usr/share/data/interim/train_transformed.csv,
    in_test_csv=/usr/share/data/interim/test_transformed.csv,
    out_dir=/usr/share/data/interim/, 
    flag=.SUCCESS_ImputeData)** **is complete****Checking if TransformData( 
  no_remove_finished=False,
  in_train_csv=/usr/share/data/interim/train_features_extracted.csv,
  in_test_csv=/usr/share/data/interim/test_features_extracted.csv,
  out_dir=/usr/share/data/interim/, 
  flag=.SUCCESS_TransformData)** **is complete****Checking if ExtractFeatures(
    no_remove_finished=False,
    in_train_csv=/usr/share/data/interim/train_cleaned.csv,
    in_test_csv=/usr/share/data/interim/test_cleaned.csv,
    out_dir=/usr/share/data/interim/, 
    flag=.SUCCESS_ExtractFeatures)** **is complete****Checking if CleanData(
    no_remove_finished=False,
    in_train_csv=/usr/share/data/interim/train.csv,
    in_test_csv=/usr/share/data/interim/test.csv,
    out_dir=/usr/share/data/interim/, 
    flag=.SUCCESS_CleanData)** **is complete****Checking if MakeDatasets(
    no_remove_finished=False,
    in_csv=/usr/share/data/raw/wine_dataset.csv,
    out_dir=/usr/share/data/interim/, 
    flag=.SUCCESS_MakeDatasets)** **is complete****Checking if DownloadData(
    no_remove_finished=False, 
    fname=wine_dataset, 
    out_dir=/usr/share/data/raw/,
    url=**[**https://github.com/datarevenue-berlin/code-challenge-2019/releases/download/0.1.0/dataset_sampled.csv**](https://github.com/datarevenue-berlin/code-challenge-2019/releases/download/0.1.0/dataset_sampled.csv)**)** **is complete**
```

ç„¶åä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è¿è¡Œä»»åŠ¡ã€‚å¯¹æˆ‘ä»¬æ¥è¯´å¦ä¸€ä¸ªé‡è¦çš„ä¿¡æ¯æ˜¯:

```
**INFO:evaluate-model:Mean square error of the model is: 4.95**
```

æˆåŠŸè¿è¡Œåï¼Œæ‚¨ä¼šçœ‹åˆ°ä¸€ä¸ªğŸ™‚ï¼š

![](img/322a31e41403b74346653b0f9639d7f1.png)

**å¥–åŠ±ç‚¹:è®©æˆ‘ä»¬çœ‹çœ‹ Luigi æ˜¯å¦‚ä½•ä»**
çš„æµç¨‹ä¸­æ¢å¤çš„ã€‚å‡è®¾æ‚¨å‡†å¤‡äº†è®­ç»ƒæ•°æ®é›†å¹¶è¿è¡Œäº†è‡ªåŠ¨åŒ–æµç¨‹ï¼Œç„¶åæ‚¨å°†ä»è®­ç»ƒæ¨¡å‹å¼€å§‹æ„å»ºæ¥ä¸‹æ¥çš„æ­¥éª¤ã€‚Luigi ä¸ä¼šé‡å¤æˆåŠŸè¿è¡Œä¹‹å‰çš„æ­¥éª¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹åªä¼šè¿è¡Œ`TrainModel`å’Œ`EvaluateModel`ä»»åŠ¡ã€‚

![](img/c7c6f252145371fc4b2862409c960f6f.png)

# ç»“è®º

æˆ‘ä¼šè¯´å“‡ï¼

è¿™æ˜¯ä¸€ä¸ªè·¨è¶Š 4 ç¯‡æ–‡ç« å’Œä¸€ä¸ªæœˆâ›µï¸çš„æ—…ç¨‹

æˆ‘ä»¬ä»å¤´å¼€å§‹ï¼Œé€šè¿‡ç¬¬ä¸€ã€ç¬¬äºŒå’Œç¬¬ä¸‰ç¯‡æ–‡ç« åˆ†æäº† 9 æ­¥ ML ç®¡é“çš„æ¯ä¸€æ­¥ã€‚

[](/building-an-automated-machine-learning-pipeline-part-one-5c70ae682f35) [## æ„å»ºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ ç®¡é“:ç¬¬ä¸€éƒ¨åˆ†

### æ•°æ®æ¸…ç†ã€æ¢ç´¢æ€§æ•°æ®åˆ†æå’Œç‰¹å¾å·¥ç¨‹æ­¥éª¤

towardsdatascience.com](/building-an-automated-machine-learning-pipeline-part-one-5c70ae682f35) [](/building-an-automated-machine-learning-pipeline-part-two-1d3c86e6fe42) [## æ„å»ºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ ç®¡é“:ç¬¬äºŒéƒ¨åˆ†

### è®¾ç½®è¯„ä¼°æŒ‡æ ‡&å»ºç«‹åŸºçº¿ã€é€‰æ‹©ç®—æ³•å’Œæ‰§è¡Œè¶…å‚æ•°è°ƒæ•´â€¦

towardsdatascience.com](/building-an-automated-machine-learning-pipeline-part-two-1d3c86e6fe42) [](/building-an-automated-machine-learning-pipeline-a74acda76b98) [## æ„å»ºè‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ ç®¡é“

### è®­ç»ƒå’Œè¯„ä¼°æ¨¡å‹ï¼Œè§£é‡Šæ¨¡å‹ç»“æœå’Œæœ€ç»ˆç»“è®º

towardsdatascience.com](/building-an-automated-machine-learning-pipeline-a74acda76b98) 

åœ¨è¿™æœ€åä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº† Docker å’Œ Luigi çš„ç›¸å…³å…ƒç´ ï¼Œå¹¶è§£é‡Šäº†å®ƒä»¬å¯¹äºè‘¡è„é…’è¯„çº§é¢„æµ‹å™¨çš„é‡è¦æ€§å’Œç”¨é€”ã€‚æˆ‘ä»¬å®Œæˆäº†æˆ‘ä»¬çš„ç»¼åˆç®¡é“çš„æœ€åä¸€ä¸ªç¼ºå¤±éƒ¨åˆ†ï¼Œå¹¶å¯¹ ML è§£å†³æ–¹æ¡ˆè¿›è¡Œäº†è¯•è¿è¡Œâ€”â€”å°±åƒå®ƒåœ¨ç”Ÿäº§ç³»ç»Ÿä¸Šè¿è¡Œä¸€æ ·ã€‚

## ç‰¹åˆ«æ„Ÿè°¢

æˆ‘æƒ³æ˜¯æ—¶å€™æ„Ÿè°¢æˆ‘çš„å¦ä¸€åŠäº†ã€‚åœ¨æˆ‘çš„æ•°æ®ç§‘å­¦æ¢é™©ä¸­ï¼Œä»–æ˜¯æˆ‘æœ€å®è´µçš„å¯¼å¸ˆã€ç¼–è¾‘å’Œå­¦ä¹ ä¼™ä¼´ï¼

ä»–å¸®åŠ©æˆ‘å…‹æœäº†è½¬è¡Œçš„èµ·èµ·è½è½ã€‚æ­¤å¤–ï¼Œæˆ‘è¦æ„Ÿè°¢ä»–å¯¹æˆ‘å®Œæˆè¿™ä¸ªç³»åˆ—æ–‡ç« çš„æ”¯æŒï¼Œä»¥åŠä»–ä¸ºæˆ‘æä¾›çš„å‹‡æ°”ã€‚è°¢è°¢ä½ ï¼Œäº²çˆ±çš„â¤ï¸

æ„Ÿè°¢é˜…è¯»ğŸ™‚è¯·éšæ„ä½¿ç”¨è¿™ä¸ªç®¡é“ã€ä»£ç å’Œ[åº“](https://github.com/cereniyim/Wine-Rating-Predictor-ML-Model)ç”¨äºä½ è‡ªå·±çš„é¡¹ç›®ã€‚

å¯¹äºè¯„è®ºæˆ–å»ºè®¾æ€§çš„åé¦ˆï¼Œæ‚¨å¯ä»¥é€šè¿‡å›å¤ã€ [Twitter](https://twitter.com/cereniyim) æˆ– [Linkedin](https://www.linkedin.com/in/ceren-iyim) è”ç³»æˆ‘ï¼

åœ¨æˆ‘ä»¬èµ°ä¹‹å‰ï¼Œæˆ‘è¿˜æƒ³åˆ†äº«ä¸€äº›æˆ‘ç”¨æ¥å‡†å¤‡è¿™ä¸ªé¡¹ç›®çš„æœ‰ç”¨èµ„æºã€‚ä¸‹ä¸€ç¯‡æ–‡ç« å†è§ğŸ‘‹

## **äº†è§£ Docker å’Œ Luigi æ›´å¤šä¿¡æ¯çš„å»ºè®®èµ„æº:**

*   [é€šè¿‡](https://www.datarevenue.com/en-blog/how-to-scale-your-machine-learning-pipeline)[æ•°æ®æ”¶å…¥](https://www.datarevenue.com/)æ¥æ‰©å±•ä½ çš„æœºå™¨å­¦ä¹ ç®¡é“
*   [é¢å‘åˆå­¦è€…çš„ Docker:ç”±](https://www.youtube.com/watch?v=zJ6WbK9zFpI&t=659s)[kode cloud](https://www.youtube.com/channel/UCSWj8mqQCcrcBlXPi4ThRDQ)æä¾›çš„å®Œæ•´è¯¾ç¨‹
*   [ç”¨ä½ çš„æœºå™¨å­¦ä¹ æ¨¡å‹](/build-a-docker-container-with-your-machine-learning-model-3cf906f5e07e)æ„å»ºä¸€ä¸ª Docker å®¹å™¨ [Tina Bu](https://medium.com/u/e2511f99cdfc?source=post_page-----787cdc50a12d--------------------------------)
*   [è·¯æ˜“å‰æ–‡æ¡£](https://luigi.readthedocs.io/en/stable/index.html)
*   [Docker æ–‡æ¡£](https://docs.docker.com/get-started/)
*   [ç”¨ Luigi å’Œ Jupyter çš„ç¬”è®°æœ¬æ„å»ºæ•°æ®ç§‘å­¦ç®¡é“](https://intoli.com/blog/luigi-jupyter-notebooks/)ä½œè€… [Mattia Ciollaro](https://mattiaciollaro.github.io/)