<html>
<head>
<title>How to Un-Delete Your Jupyter Notebooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何取消删除您的Jupyter笔记本</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-un-delete-your-jupyter-notebooks-1289e741705f?source=collection_archive---------17-----------------------#2020-03-26">https://towardsdatascience.com/how-to-un-delete-your-jupyter-notebooks-1289e741705f?source=collection_archive---------17-----------------------#2020-03-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0bfa" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用SQL和命令行破解Jupyter笔记本的元数据科学</h2></div><p id="91b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">谁不爱Jupyter笔记本？它们是互动的，给你即时反馈的即时满足感。它们是可扩展的——你甚至可以把它们作为网站来部署。对于数据科学家和机器学习工程师来说，最重要的是，它们具有表现力——它们跨越了操纵<em class="le">数据</em>的科学家和工程师与消费并希望理解数据所代表的<em class="le">信息</em>的普通观众之间的空间。</p><p id="0903" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是Jupyter笔记本也有缺点。它们是大型JSON文件，存储您运行的每个单元的代码、降价、输入、输出和元数据。为了理解我的意思，我写了一个简短的笔记本来定义和测试sigmoid函数。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/6f80fe88d25c3e460dbce395d4e37f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yekb40pmDyB23WQIskSe0A.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">朱庇特笔记本。</p></figure><p id="ff80" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是当IPython不渲染它时(的一部分)看起来的样子(除了第一个实际的输入单元格，我已经省略了所有的单元格，因为即使对于一个短笔记本来说，它也是又长又丑的):</p><pre class="lg lh li lj gt lv lw lx ly aw lz bi"><span id="d193" class="ma mb it lw b gy mc md l me mf">{<br/> "nbformat": 4,<br/> "nbformat_minor": 2,<br/> "metadata": {<br/>  "language_info": {<br/>   "name": "python",<br/>   "codemirror_mode": {<br/>    "name": "ipython",<br/>    "version": 3<br/>   },<br/>   "version": "3.6.8-final"<br/>  },<br/>  "orig_nbformat": 2,<br/>  "file_extension": ".py",<br/>  "mimetype": "text/x-python",<br/>  "name": "python",<br/>  "npconvert_exporter": "python",<br/>  "pygments_lexer": "ipython3",<br/>  "version": 3,<br/>  "kernelspec": {<br/>   "name": "python36864bitvenvscivenv55fc700d3ea9447888c06400e9b2b088",<br/>   "display_name": "Python 3.6.8 64-bit ('venv-sci': venv)"<br/>  }<br/> },<br/> "cells": [<br/>  {<br/>   "cell_type": "code",<br/>   "execution_count": 2,<br/>   "metadata": {},<br/>   "outputs": [],<br/>   "source": [<br/>    "import numpy as np\n",<br/>    "import random"<br/>   ]<br/>  },<br/>  <br/>   ...<br/>}</span></pre><p id="ef75" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此很难对它们进行版本控制。这也意味着有很多你通常不太关心保存的垃圾数据，比如单元执行计数和输出。</p><p id="21c6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下次你想知道为什么你的Jupyter笔记本运行如此缓慢时，在纯文本编辑器中打开它，看看你的笔记本元数据中有多少海量数据帧。</p><p id="0171" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不过，在适当的情况下，所有这些垃圾看起来都像珍贵的宝石。这些情况通常包括:</p><ul class=""><li id="83dd" class="mg mh it kk b kl km ko kp kr mi kv mj kz mk ld ml mm mn mo bi translated">意外关闭笔记本而未保存它</li><li id="4d94" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated">点击错误的快捷键，删除重要的单元格</li><li id="f034" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated">在多个浏览器窗口中打开同一笔记本并覆盖您自己的工作</li></ul><p id="aa8d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">任何误入在IPython笔记本上进行开发的危险领域的人都至少做过一次这些事情，可能是在同一时间。</p><p id="dc71" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果这是你，你在这里是因为你谷歌了<em class="le">恢复删除jupyter笔记本刷新浏览器窗口</em>，不要惊慌。首先我要告诉你如何修理它。*然后我要告诉你如何防止它再次发生。</p><p id="9503" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">*是的，你能修好它。(大概吧。)</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi mu"><img src="../Images/85c317e7b8fe3a4196ef7bcce8d9ccc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WZyQqUQJsQjKVzS1u-3zVw.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">我为你做的一本指南，在笔记本上，关于笔记本</p></figure><h2 id="f783" class="ma mb it bd mv mw mx dn my mz na dp nb kr nc nd ne kv nf ng nh kz ni nj nk nl bi translated">要求:</h2><ul class=""><li id="1854" class="mg mh it kk b kl nm ko nn kr no kv np kz nq ld ml mm mn mo bi translated">安装了Jupyter、IPython(带有nbformat和nbconvert)和jupytext的Python <a class="ae nr" href="https://medium.com/swlh/a-guide-to-python-virtual-environments-8af34aa106ac" rel="noopener">虚拟环境</a>(最好是一个新的venv，这样您可以测试一下)</li><li id="288d" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated">sqlite3的工作安装(可选但推荐:像<a class="ae nr" href="https://sqlitestudio.pl/index.rvt?act=download" rel="noopener ugc nofollow" target="_blank"> SQLiteStudio </a>这样的数据库浏览器)</li><li id="60e1" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated">希望和决心</li></ul><h1 id="f3c2" class="ns mb it bd mv nt nu nv my nw nx ny nb jz nz ka ne kc oa kd nh kf ob kg nk oc bi translated">场景:您意外删除了活动笔记本中的几个单元格</h1><p id="606d" class="pw-post-body-paragraph ki kj it kk b kl nm ju kn ko nn jx kq kr od kt ku kv oe kx ky kz of lb lc ld im bi translated">(不科学)估计恢复概率:90%</p><p id="907a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相对难度:更容易</p><p id="fa0f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在最坏的情况下，您点击了不想删除的单元格上的<code class="fe og oh oi lw b">x</code>,现在您想取回它的代码或数据。</p><h2 id="4124" class="ma mb it bd mv mw mx dn my mz na dp nb kr nc nd ne kv nf ng nh kz ni nj nk nl bi translated">方法一:进出</h2><p id="8472" class="pw-post-body-paragraph ki kj it kk b kl nm ju kn ko nn jx kq kr od kt ku kv oe kx ky kz of lb lc ld im bi translated">当您使用笔记本时，IPython内核会运行您的代码。IPython内核是一个独立于Python解释器的进程。(这也是为什么您需要将新的内核链接到新的虚拟环境。这两者不是自动连接的。)它使用JSON发送和接收消息，就像您的代码单元一样。</p><p id="15c0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当您运行一个单元或点击“保存”时，笔记本服务器会将您的代码作为JSON发送到您计算机上的一个笔记本中，该笔记本存储您的输入和输出。所以你手机旁边的小单词<code class="fe og oh oi lw b">In</code>和<code class="fe og oh oi lw b">Out</code>不仅仅是单词，它们是容器——特别是你会话历史的列表。你可以打印出来并编入索引。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi oj"><img src="../Images/6efb9b87d1178924c26f8e5a57afb7e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9IUFeRpc-UG9tESDvNBiaA.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">[]容器中的IPython</p></figure><h2 id="d4df" class="ma mb it bd mv mw mx dn my mz na dp nb kr nc nd ne kv nf ng nh kz ni nj nk nl bi translated">方法二:IPython魔术</h2><p id="89c3" class="pw-post-body-paragraph ki kj it kk b kl nm ju kn ko nn jx kq kr od kt ku kv oe kx ky kz of lb lc ld im bi translated">使用<code class="fe og oh oi lw b">%history</code> line magic打印您的输入历史(后进先出)。这个<a class="ae nr" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-history" rel="noopener ugc nofollow" target="_blank">强大的命令</a>允许您通过绝对或相对数字访问当前和过去的会话。</p><p id="1e06" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果当前的IPython进程仍然处于连接状态，并且您已经在您的<a class="ae nr" href="https://medium.com/swlh/a-guide-to-python-virtual-environments-8af34aa106ac" rel="noopener">虚拟环境</a>中安装了<code class="fe og oh oi lw b">nbformat </code>，那么在单元格中执行以下代码来恢复您的笔记本:</p><pre class="lg lh li lj gt lv lw lx ly aw lz bi"><span id="b9a8" class="ma mb it lw b gy mc md l me mf">&gt;&gt;&gt; %notebook your_notebook_filename_backup.ipynb</span></pre><p id="ab42" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这种魔法将整个当前会话历史呈现为一个新的Jupyter笔记本。</p><p id="a40c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">嗯，还不算太糟。T19】</p><p id="ea5f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这并不总是有效，您可能需要花费一些精力从输出中剔除无关的单元格。</p><p id="34c6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以用历史魔法做更多的事情。这里有几个我觉得有用的食谱:</p><ul class=""><li id="4397" class="mg mh it kk b kl km ko kp kr mi kv mj kz mk ld ml mm mn mo bi translated"><code class="fe og oh oi lw b">%history -l [LIMIT]</code>获取最后的<em class="le"> n个</em>输入</li><li id="eeb2" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated"><code class="fe og oh oi lw b">%history -g -f FILENAME</code>:将您的<em class="le">整个</em>保存的历史记录写入一个文件</li><li id="c627" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated"><code class="fe og oh oi lw b">%history -n -g [PATTERN]</code>:使用glob模式搜索您的历史，并打印会话和行号</li><li id="83ab" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated"><code class="fe og oh oi lw b">%history -u</code>:仅从当前会话中获取<em class="le">唯一的</em>历史。</li><li id="2555" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated"><code class="fe og oh oi lw b">%history [RANGE] -t</code>:获取本机历史，也就是IPython生成的源代码(有利于调试)</li><li id="41f5" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated"><code class="fe og oh oi lw b">%history [SESSION]/[RANGE] -p -o</code>:使用<code class="fe og oh oi lw b">&gt;&gt;&gt;</code>提示符打印输入和输出(适合阅读和文档)</li></ul><p id="ece7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你已经在一个真正的大数据科学笔记本上工作了很长时间，那么<code class="fe og oh oi lw b">%notebook</code>魔法策略可能会产生很多你不想要的噪音。使用其他参数削减<code class="fe og oh oi lw b">%history -g</code>的输出，然后使用jupytext(解释如下)转换结果。</p><h1 id="b1f9" class="ns mb it bd mv nt nu nv my nw nx ny nb jz nz ka ne kc oa kd nh kf ob kg nk oc bi translated"><strong class="ak">场景:你关闭了一个未保存的笔记本</strong></h1><p id="722c" class="pw-post-body-paragraph ki kj it kk b kl nm ju kn ko nn jx kq kr od kt ku kv oe kx ky kz of lb lc ld im bi translated">(不科学的)估计恢复概率:70–85%</p><p id="a440" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相对难度:更难</p><p id="174c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还记得我们说过笔记本的版本控制很难吗？一个内核可以同时连接到多个前端。这意味着打开同一笔记本的两个浏览器选项卡可以访问相同的变量。这就是你最初重写代码的方式。</p><p id="fecb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">IPython将您的会话历史存储在数据库中。默认情况下，您可以在您的主目录下的一个名为<code class="fe og oh oi lw b">.ipython/profile_default</code>的文件夹中找到它。</p><pre class="lg lh li lj gt lv lw lx ly aw lz bi"><span id="f3d4" class="ma mb it lw b gy mc md l me mf">$ ls ~/.ipython/profile_default</span><span id="840c" class="ma mb it lw b gy ok md l me mf">db  history.sqlite  log  pid  security  startup</span></pre><p id="4928" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">备份<code class="fe og oh oi lw b">history.sqlite</code>到副本。</p><pre class="lg lh li lj gt lv lw lx ly aw lz bi"><span id="420e" class="ma mb it lw b gy mc md l me mf">$ cp history.sqlite history-bak.sqlite</span></pre><p id="fa92" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在数据库浏览器中或通过sqlite3命令行界面打开备份。它有三个表:历史、输出历史和会话。根据您想要恢复的内容，您可能需要将这三者结合在一起，所以请放弃您的SQL。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ol"><img src="../Images/894b0a3e5e095f4b7d14320206afc9be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YxWCUn5vIndDS7RPpF7fXg.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">IPython历史的SQLiteStudio视图</p></figure><h2 id="5be1" class="ma mb it bd mv mw mx dn my mz na dp nb kr nc nd ne kv nf ng nh kz ni nj nk nl bi translated">盯着它</h2><p id="f96f" class="pw-post-body-paragraph ki kj it kk b kl nm ju kn ko nn jx kq kr od kt ku kv oe kx ky kz of lb lc ld im bi translated">如果您可以从数据库浏览器GUI中判断出<code class="fe og oh oi lw b">history</code>表中的哪个会话号有您的代码，那么您的生活就简单多了。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi om"><img src="../Images/c016154b660f95bfb8478961e76bc7d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cDKNZsbshSiAE_5pedDtiQ.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">历史表的SQLiteStudio视图</p></figure><p id="7ebe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在浏览器中或命令行上执行SQL命令:</p><pre class="lg lh li lj gt lv lw lx ly aw lz bi"><span id="d832" class="ma mb it lw b gy mc md l me mf">sqlite3 ~/.ipython/profile_default/history-bak.sqlite \<br/>  "select source || char(10) from history where session = 1;" &gt; recovered.py</span></pre><p id="26d3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这只是指定会话号和要写入的文件名(在给出的例子中是<code class="fe og oh oi lw b">1</code>和<code class="fe og oh oi lw b">recovered.py</code>)，并从数据库中选择源代码，用换行符(在ASCII中是10)分隔每个代码块。</p><p id="9880" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您想选择行号作为Python注释，可以使用如下查询:</p><pre class="lg lh li lj gt lv lw lx ly aw lz bi"><span id="56b6" class="ma mb it lw b gy mc md l me mf">"select '# Line:' || line || char(10) || source || char(10) from history where session = 1;"</span></pre><p id="9ec2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦你有了一个Python可执行文件，你就可以松一口气了。但是你可以用jupytext 把它变回笔记本，这是一个神奇的工具，可以把明文格式转换成Jupyter笔记本。</p><pre class="lg lh li lj gt lv lw lx ly aw lz bi"><span id="199d" class="ma mb it lw b gy mc md l me mf">jupytext --to notebook recovered.py</span></pre><p id="073f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="le">不太可怕！</em> </strong></p><h1 id="5007" class="ns mb it bd mv nt nu nv my nw nx ny nb jz nz ka ne kc oa kd nh kf ob kg nk oc bi translated">场景:你在多个标签页中打开你的笔记本，重新加载一个旧版本，删除你所有的工作，并杀死你的内核</h1><p id="ee5e" class="pw-post-body-paragraph ki kj it kk b kl nm ju kn ko nn jx kq kr od kt ku kv oe kx ky kz of lb lc ld im bi translated">(不科学的)估计恢复概率:50–75%</p><p id="80b4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相对难度:最难</p><p id="7692" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以上都不起作用，但你还不准备放弃。</p><h2 id="beed" class="ma mb it bd mv mw mx dn my mz na dp nb kr nc nd ne kv nf ng nh kz ni nj nk nl bi translated">硬模</h2><p id="9cae" class="pw-post-body-paragraph ki kj it kk b kl nm ju kn ko nn jx kq kr od kt ku kv oe kx ky kz of lb lc ld im bi translated">回到你正在使用的任何工具来浏览你的<code class="fe og oh oi lw b">history-bak.sqlite</code>数据库。您编写的查询将需要<a class="ae nr" rel="noopener" target="_blank" href="/advanced-google-skills-for-data-science-350bf828dbe6">创造性的搜索技术</a>来充分利用您拥有的信息:</p><ul class=""><li id="4bba" class="mg mh it kk b kl km ko kp kr mi kv mj kz mk ld ml mm mn mo bi translated">会话开始的时间戳(总是非空)</li><li id="1552" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated">会话结束的时间戳(有时以有用的方式为空)</li><li id="2c8c" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated">输出历史</li><li id="710d" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated">每个会话执行的命令数</li><li id="1ad5" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated">您的输入(代码和降价)</li><li id="1ccc" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated">IPython的渲染源代码</li></ul><p id="013f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，您可以通过以下查询找到您今年编写的与pytest相关的所有内容:</p><pre class="lg lh li lj gt lv lw lx ly aw lz bi"><span id="96f7" class="ma mb it lw b gy mc md l me mf"><strong class="lw iu">select</strong> line, source</span><span id="a047" class="ma mb it lw b gy ok md l me mf"><strong class="lw iu">from</strong> history</span><span id="6714" class="ma mb it lw b gy ok md l me mf"><strong class="lw iu">join</strong> sessions</span><span id="28d0" class="ma mb it lw b gy ok md l me mf"><strong class="lw iu">on</strong> sessions.session = history.session</span><span id="43b8" class="ma mb it lw b gy ok md l me mf"><strong class="lw iu">where</strong> sessions.start &gt; '2020-01-01 00:00:00.000000'</span><span id="e30f" class="ma mb it lw b gy ok md l me mf"><strong class="lw iu">and </strong>history.source like '%pytest%';</span></pre><p id="8449" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦您将视图调整为您想要的行，您可以像以前一样将其导出到可执行的<code class="fe og oh oi lw b">.py</code>文件，并使用jupytext将其转换回<code class="fe og oh oi lw b">.ipynb</code>。</p><h1 id="86eb" class="ns mb it bd mv nt nu nv my nw nx ny nb jz nz ka ne kc oa kd nh kf ob kg nk oc bi translated">如何避免需要这篇文章</h1><p id="622a" class="pw-post-body-paragraph ki kj it kk b kl nm ju kn ko nn jx kq kr od kt ku kv oe kx ky kz of lb lc ld im bi translated">当你品味不必从头重写笔记本的解脱时，花点时间思考一些措施来防止未来的探索进入<code class="fe og oh oi lw b">history.sqlite</code>:</p><ul class=""><li id="c88c" class="mg mh it kk b kl km ko kp kr mi kv mj kz mk ld ml mm mn mo bi translated">不要将相同的前端连接到同一个内核。换句话说，不要在多个浏览器标签中打开同一个笔记本。<a class="ae nr" rel="noopener" target="_blank" href="/power-up-your-python-projects-with-visual-studio-code-401f78dd97eb">使用Visual Studio代码作为您的Jupyter IDE </a>很大程度上消除了这种风险。</li><li id="7983" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated">定期备份您的IPython历史数据库文件，以防万一。</li><li id="9b2c" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated">尽可能将您的笔记本转换为明文，至少为了备份。Jupytext 让这变得几乎微不足道。</li><li id="b533" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated">使用IPython的<code class="fe og oh oi lw b">%store</code>魔法在IPython数据库中存储变量、宏和别名。你所需要做的就是在<code class="fe og oh oi lw b">profile_default</code>中找到你的<code class="fe og oh oi lw b">ipython_config.py</code>文件(或者如果你没有的话运行<code class="fe og oh oi lw b">ipython profile create</code>，添加这一行:<code class="fe og oh oi lw b">c.StoreMagics.autorestore = True</code>。如果你愿意，你可以存储、别名和访问从环境变量到小型机器学习模型的任何东西。这是完整的文档。</li></ul><p id="1abe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">Jupyter笔记本给你带来的最大挑战是什么？对你想在以后的帖子中讨论的话题发表评论。</em></p><h1 id="3514" class="ns mb it bd mv nt nu nv my nw nx ny nb jz nz ka ne kc oa kd nh kf ob kg nk oc bi translated">资源</h1><ul class=""><li id="f629" class="mg mh it kk b kl nm ko nn kr no kv np kz nq ld ml mm mn mo bi translated"><a class="ae nr" rel="noopener" target="_blank" href="/power-up-your-python-projects-with-visual-studio-code-401f78dd97eb">使用Visual Studio代码启动您的Python项目</a></li><li id="bc1a" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated"><a class="ae nr" rel="noopener" target="_blank" href="/advanced-google-skills-for-data-science-350bf828dbe6">谷歌数据科学高级技能</a></li><li id="5583" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated"><a class="ae nr" href="https://jupytext.readthedocs.io/en/latest/introduction.html" rel="noopener ugc nofollow" target="_blank"> Jupytext </a></li><li id="3419" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated"><a class="ae nr" href="https://ipython.readthedocs.io/en/stable/config/extensions/storemagic.html" rel="noopener ugc nofollow" target="_blank"> IPython storemagic </a></li><li id="3b15" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated"><a class="ae nr" href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-history" rel="noopener ugc nofollow" target="_blank"> IPython历史魔法</a></li><li id="c57b" class="mg mh it kk b kl mp ko mq kr mr kv ms kz mt ld ml mm mn mo bi translated"><a class="ae nr" href="https://sqlitestudio.pl/index.rvt?act=download" rel="noopener ugc nofollow" target="_blank"> SQLiteStudio </a></li></ul></div></div>    
</body>
</html>