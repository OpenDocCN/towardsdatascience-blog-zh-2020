<html>
<head>
<title>What is Vectorization in Machine Learning?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中的矢量化是什么？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/what-is-vectorization-in-machine-learning-6c7be3e4440a?source=collection_archive---------4-----------------------#2020-06-12">https://towardsdatascience.com/what-is-vectorization-in-machine-learning-6c7be3e4440a?source=collection_archive---------4-----------------------#2020-06-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/faf9d096088c16e72e0a1f18e7e90fe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BoBkV22GHTMCP9Jc"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">SpaceX 在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的<a class="ae jg" href="https://unsplash.com/@spacex?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"/></p></figure><div class=""/><p id="128c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用矢量化让您的代码快速执行</p><h2 id="3d2d" class="le lf jj bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">您将学到的内容:</h2><ol class=""><li id="dd41" class="lx ly jj ki b kj lz kn ma kr mb kv mc kz md ld me mf mg mh bi translated">什么是矢量化？</li><li id="7cab" class="lx ly jj ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">矢量化在机器学习中有多重要？</li><li id="fad5" class="lx ly jj ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">示例:非矢量化与矢量化实现</li><li id="0ff6" class="lx ly jj ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">矢量化实施的优势</li><li id="90ce" class="lx ly jj ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">jupyter 笔记本演示</li></ol><p id="60fc" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我第一次了解矢量化的概念是在 Coursera 平台上学习吴恩达教授的最著名的课程<strong class="ki jk">机器学习</strong>。</p><p id="60dc" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据吴恩达教授的说法:</p><p id="3db9" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mn">“执行矢量化的能力已经成为一项关键技能</em></p><p id="093f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以，让我们学习这项技能，并将其纳入我们的工具箱:)</p><h2 id="b129" class="le lf jj bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">什么是矢量化？</h2><p id="70d0" class="pw-post-body-paragraph kg kh jj ki b kj lz kl km kn ma kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi mr translated">构造化是一种可以让你的代码快速执行的技术。当你从零开始实现算法时，这是一个非常有趣和重要的优化算法的方法。</p><p id="bf3f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在借助 C/C++、Octave/Matlab、Python、…等高度优化的数值线性代数库。我们可以让代码高效运行。</p><p id="3eb4" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢专门做数值计算的人！</p><p id="0a94" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本教程中，我们将使用:</p><p id="badb" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">Numpy:</strong>Python 中的快速数值计算库</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h2 id="7011" class="le lf jj bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">矢量化在机器学习中有多重要？</h2><p id="5c94" class="pw-post-body-paragraph kg kh jj ki b kj lz kl km kn ma kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">就像在现实世界中，我们感兴趣的是以尽可能减少错误的方式有效地解决任何类型的问题。</p><p id="20fa" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在机器学习中，有一个优化算法的概念，它试图减少错误，并计算出机器学习模型的最佳参数。</p><p id="2e11" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，通过在优化算法中使用矢量化实现，我们可以使计算过程比非矢量化实现快得多。</p><p id="98b4" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">优化算法的一个基本例子:<strong class="ki jk">梯度下降</strong></p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/938495861e6b683d33f8eeecae5a2b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/1*geBrs4AkdZoE_FLzKX1Tpg.gif"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">梯度下降如何工作的例子，图片由<a class="ae jg" href="https://kevinbinz.com/about-me/" rel="noopener ugc nofollow" target="_blank">凯文·宾兹</a>在<a class="ae jg" href="https://kevinbinz.com/2019/05/26/intro-gradient-descent/" rel="noopener ugc nofollow" target="_blank">来源</a>上提供</p></figure><p id="0d2a" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们先玩玩<strong class="ki jk"> Numpy </strong>来了解一下如何使用高度优化的计算库</p><div class="ni nj nk nl gt ab cb"><figure class="nm iv nn no np nq nr paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><img src="../Images/1b88919223e023c23d1dc2bbc05de8c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*0CAF7qSz5Pa7etES-b-pHA.png"/></div></figure><figure class="nm iv ns no np nq nr paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><img src="../Images/9bb177426ee229b0725e3cdf135db91d.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*QFUyvjEVKuXr1USCIUvH9w.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk nt di nu nv translated">Python List 和 Numpy 数组的性能比较</p></figure></div><p id="9693" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用 Numpy:平均每循环花费<strong class="ki jk"> 1.52 毫秒</strong></p><p id="7c19" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">没有 Numpy:平均每个循环花费了<strong class="ki jk"> 69.9 毫秒</strong></p><h2 id="010f" class="le lf jj bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">代码:</h2><pre class="ni nj nk nl gt nw nx ny nz aw oa bi"><span id="fb1d" class="le lf jj nx b gy ob oc l od oe"># With Python Lists</span><span id="01ec" class="le lf jj nx b gy of oc l od oe">a=list(range(1000000)) #10^6 numbers generated<br/>%timeit [val + 5 for val in a] #Computing Element Wise Operation</span><span id="b82d" class="le lf jj nx b gy of oc l od oe"># With Numpy Arrays</span><span id="5ac4" class="le lf jj nx b gy of oc l od oe">import numpy as np<br/>a=np.array(a) #Converting into numpy array type<br/>%timeit a+5</span></pre><p id="e555" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk"> range() </strong> : range 函数用于生成一段时间内的数字序列</p><p id="0c22" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk"> %timeit </strong>:这是一个 ipython 神奇的函数，可以用来计时一段特定的代码。</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h2 id="2dc7" class="le lf jj bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">非矢量化与矢量化实施</h2><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi og"><img src="../Images/ebb3be1a4996d7ff6931403ecea43cb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*PLRFf7aPrRuGp9SWlht5cA.jpeg"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">线性回归的假设函数</p></figure><p id="5a43" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们使用线性回归的假设函数来理解矢量化的概念，其中<strong class="ki jk">θ</strong>表示权重/系数，<strong class="ki jk"> x </strong>表示特征</p><p id="4b42" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在有两种方法可以实现上述功能:</p><ol class=""><li id="6688" class="lx ly jj ki b kj kk kn ko kr oh kv oi kz oj ld me mf mg mh bi translated">使用 For 循环</li><li id="2ebb" class="lx ly jj ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">使用矢量化</li></ol><p id="8432" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，让我们为θ和 x 向量生成随机数</p><pre class="ni nj nk nl gt nw nx ny nz aw oa bi"><span id="a178" class="le lf jj nx b gy ob oc l od oe">n=10000</span><span id="4d6a" class="le lf jj nx b gy of oc l od oe"># Generate n random numbers between 0 - 1<br/>theta = np.random.rand(n)</span><span id="6ba2" class="le lf jj nx b gy of oc l od oe">#Generate n random integers between 0 - 100 <br/>x = np.random.randint(0, 100, n)</span></pre><p id="5df8" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在观察非矢量化代码和矢量化代码之间的区别</p><div class="ni nj nk nl gt ab cb"><figure class="nm iv ok no np nq nr paragraph-image"><img src="../Images/282e6a51b089e6cb2f24dd2d332a78b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:938/format:webp/1*wvG5EBAnSAsseA5yeTa_2Q.png"/></figure><figure class="nm iv ol no np nq nr paragraph-image"><img src="../Images/9c198ec8108557c04cf50542d4e11bd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*agIXPQRfihsq_i3bvXImSg.png"/><p class="jc jd gj gh gi je jf bd b be z dk om di on nv translated">对于循环与矢量化实现</p></figure></div><p id="8f13" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">两种实现给我们相同的输出，但问题是计算效率如何？</p><h2 id="2cb3" class="le lf jj bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">比较性能</h2><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oo"><img src="../Images/f3a69b1be808c7f5cc0d50341e657973.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aVlZQrryLOyiQdo4b0Rcqg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">非矢量化代码和矢量化代码的性能比较</p></figure><p id="e00b" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">使用未向量化的代码</strong>:平均每个循环花费<strong class="ki jk"> 6.46 毫秒</strong></p><p id="5b7f" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk">使用向量化代码:</strong>平均每循环花费了<strong class="ki jk"> 18.8 秒</strong></p><h2 id="2b4f" class="le lf jj bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">代码:</h2><pre class="ni nj nk nl gt nw nx ny nz aw oa bi"><span id="19b5" class="le lf jj nx b gy ob oc l od oe"># Unvectorized</span><span id="49f0" class="le lf jj nx b gy of oc l od oe">def unvectorized(n, theta, x):<br/>    <br/>    prediction= 0.0<br/>    <br/>    for j in range(n):<br/>        prediction= prediction + theta[j]*x[j]<br/>    <br/>    return prediction</span><span id="ad18" class="le lf jj nx b gy of oc l od oe"># Vectorized</span><span id="a80a" class="le lf jj nx b gy of oc l od oe">def vectorized(theta, x):<br/>    <br/>    prediction= 0.0<br/>    <br/>    prediction = np.dot(theta.transpose() , x)<br/>   <br/>    return prediction</span><span id="eee3" class="le lf jj nx b gy of oc l od oe">#Comparing Performance</span><span id="b0bc" class="le lf jj nx b gy of oc l od oe">%timeit unvectorized(n, theta, x)<br/>%timeit vectorized(theta, x)</span></pre><h2 id="a8cf" class="le lf jj bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">矢量化实施的优势</h2><ol class=""><li id="6d91" class="lx ly jj ki b kj lz kn ma kr mb kv mc kz md ld me mf mg mh bi translated">我们的代码运行高效</li><li id="80a2" class="lx ly jj ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">我们的代码变得更加简单，易于调试</li></ol></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h2 id="8885" class="le lf jj bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">演示时间:)</h2><figure class="ni nj nk nl gt iv"><div class="bz fp l di"><div class="op oq l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Jupyter 笔记本电脑演示(非矢量化与矢量化实施)</p></figure><h2 id="9f7f" class="le lf jj bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">源代码</h2><p id="d708" class="pw-post-body-paragraph kg kh jj ki b kj lz kl km kn ma kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">本教程中使用的所有代码都可以在我的 GitHub 帐户上获得<a class="ae jg" href="https://github.com/jalalmansoori19/Classfiying-Iris-flower-species/blob/master/vectorization.ipynb" rel="noopener ugc nofollow" target="_blank">点击这里</a></p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi or"><img src="../Images/a575f9532d01218cfc20589921f8aba1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GgboSP3CC-XZd7QB"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">埃米尔·佩龙在<a class="ae jg" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h2 id="2d94" class="le lf jj bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">结论</h2><p id="5b4d" class="pw-post-body-paragraph kg kh jj ki b kj lz kl km kn ma kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">在本教程中，您学习了矢量化技术，这是提高代码效率的方法之一。</p><p id="b1c9" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下节课再见:)</p><h2 id="e954" class="le lf jj bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">接触</h2><p id="fc09" class="pw-post-body-paragraph kg kh jj ki b kj lz kl km kn ma kp kq kr mo kt ku kv mp kx ky kz mq lb lc ld im bi translated">Gmail-&gt; jalalmansoori19@gmail.com</p><p id="6393" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">github-&gt;<a class="ae jg" href="https://github.com/jalalmansoori19" rel="noopener ugc nofollow" target="_blank">https://github.com/jalalmansoori19</a></p><h2 id="c837" class="le lf jj bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">参考</h2><ol class=""><li id="b4db" class="lx ly jj ki b kj lz kn ma kr mb kv mc kz md ld me mf mg mh bi translated"><a class="ae jg" href="https://speakerdeck.com/jakevdp/losing-your-loops-fast-numerical-computing-with-numpy-pycon-2015" rel="noopener ugc nofollow" target="_blank">https://speaker deck . com/jakevdp/losing-your-loops-fast-numpy-pycon-2015</a></li><li id="a158" class="lx ly jj ki b kj mi kn mj kr mk kv ml kz mm ld me mf mg mh bi translated">吴恩达教授在 Coursera 上的机器学习课程</li></ol></div></div>    
</body>
</html>