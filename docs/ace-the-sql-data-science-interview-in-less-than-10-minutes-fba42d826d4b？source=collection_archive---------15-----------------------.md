# 在不到 10 分钟的时间内通过 SQL 数据科学面试

> 原文：<https://towardsdatascience.com/ace-the-sql-data-science-interview-in-less-than-10-minutes-fba42d826d4b?source=collection_archive---------15----------------------->

## SQL 面试通常令人望而生畏，因为大多数人不知道如何准备。在这篇文章中，我强调了我在面试中遇到的最常见的问题，并给出了一些如何做好准备的建议。

大多数数据科学家的职位招聘都需要 SQL 技能。大多数公司，尤其是大公司(谷歌、脸书……)在他们的流程中至少有一次以 SQL 为中心的面试。学校很少教授 SQL，知道准备什么可能很有挑战性。在这篇文章中，我希望给出在这些过程中可能会被问到的大多数问题的答案。

# 不同类型的连接

当数据存储在不同的表中时，以最合适的方式将它们重新连接在一起可能会很棘手。最常见的 SQL 问题试图评估您对左/右/内/外连接之间的区别的理解。下图总结了每种连接类型之间的差异:

![](img/0850a7002dbfd39777dd3a46e3bec033.png)

典型图表突出显示了来自 [Wikimedia](https://commons.wikimedia.org/wiki/File:SQL_Joins.svg) 上 Arbeck 的左/右/内/外连接

存在额外的连接，这非常有用。至关重要的是:

1.  **交叉连接:**这将允许你做每个表的叉积(即可能有助于生成一个所有可能结果的表)。这种连接不需要连接条件。人们可以简单地在 FROM 语句中提到多个关系。
2.  **自连接:**有时候连接一个表本身可能会有帮助，特别是当一个表中的行之间有关系的时候。例如，为了计算滚动平均值，或者如果我们有一个特定事件的多个实例，我们可以找到第一个事件之后发生的所有事件(在 WHERE 语句中使用一个附加子句)。为此，我们可以像往常一样执行一个连接，但是为两个表提供不同的别名(使用 as)。

# If 语句

在 select 子句中，使用“filter”或 if 语句来确定某些值可能会有所帮助。

为此，我们声明一个 CASE 语句。发生这种情况时，每个子句都需要用一个分隔(使用任何条件运算符)，然后是这个值，并且可能包含一个 ELSE 子句来提供一个默认/回退值。最后，我们用 end 语句结束 CASE 语句。

这可以让您避免许多不必要的子查询，并且对于为您的聚合函数创建自定义组可能特别有帮助(见下文)。

# **聚合函数**

通常，您可能需要将一些数据聚合到组/汇总统计数据中。要计算汇总统计数据，您可以使用任何聚合函数，例如:
-COUNT
-SUM
-AVG
-MAX
-MIN

GROUP BY 允许将数据分成不同的组，并分别聚合这些组。面试官很可能会问这些功能，所以一定要牢牢掌握如何使用它们。

使用 GROUP BY 函数时，SELECT 子句的所有元素必须是聚合函数或 GROUP BY 子句之一。

此外，正如在面试中经常被问到的:WHERE 子句可以同时使用，并有助于在聚合之前过滤数据**。相反，HAVING 子句有助于在**聚合之后**过滤数据。因此，它们可以同时使用并具有不同的用途。**

# 数据类型

为了欺骗你，面试官可能会给你一些不能直接操作的数据类型。例如，他们可能会给你一个字符串格式的日期表，并要求你过滤过去的一周。为此，您首先需要将数据类型转换为“日期”。

为此，您有两种方法:

1.  您可以使用 CAST 函数来(即 CAST(column_name AS integer))
2.  使用::语法(即 column_name::integer))

最常见的数据类型有:

- VARCHAR
-文本
-时间戳
-整数
-浮点
-双精度
-布尔

# 窗口功能

滚动窗口通常被认为是一个高级的 SQL 主题，但它将真正有助于展示 SQL 掌握的深度。它们有助于大大简化查询，并允许在一组指定的行中执行计算(符合分区)。要使用滚动窗口，可以用 OVER 命令实例化窗口。可以使用 PARTITION 子句将滚动窗口分成不同的组，并且可以使用括号和 ORDER BY 子句以特定的顺序运行。

使用 BETWEEN … AND …ROW 和 ROWS … PRECEDING 这样的子句，可以进一步定制窗口函数并使它们适应任何用例。

因此，例如，使用 ROW_NUMBER()函数来计算行数以及分区和排序依据的组合，就可以非常容易地计算可能变得非常复杂的子查询数(即[计算移动平均值](https://www.essentialsql.com/sql-puzzle-calculate-moving-averages/))。

**-使用和不使用窗口功能如何计算累计和
-使用和不使用窗口功能计算 7 天滚动平均值**

***如需更深入的了解，请务必查看窗口功能* *上的* [*模式分析指南。*](https://mode.com/sql-tutorial/sql-window-functions/)**

# **其他需要了解的功能:**

*****字符串函数*****

*   **TRIM:从字符串中删除尾随(RTRIM)和前导(LTRIM)空格**
*   **SUBSTR:在一个较长的字符串中选择一个子字符串**
*   **LOWER/UPPER:将整个字符串转换为小写或大写。**
*   **CONCAT:允许将多个字符串连接成一个字符串**
*   **COALESCE:返回 colulmn 中的第一个非空值(通常用于将具有各种空值的列“合并”到一个充满值的列中)**
*   **LIKE:允许查找符合特定模式的字符串(可以使用“%”操作符来匹配任意数量的字符，或者使用“_”来匹配单个字符)。请不要忘记它是区分大小写的，一些数据库管理系统可能允许 ILIKE 作为不区分大小写的替代(否则使用 LOWER/UPPER)**
*   **包含:允许查找包含特定子字符串的字符串**

*****日期功能*****

*   **NOW():返回当前日期/时间**
*   **CURRENT_DATE():返回当前日期**
*   **DATE_ADD/DATE_SUB:允许从指定的时间间隔计算日期/时间(类似于 python 的时间增量)**
*   **月/年/日/工作日:从一个日期返回月/年/日/工作日**

*****数学运算*****

*   **ROUND:按要求的小数位数对数字进行舍入**
*   **ABS:返回浮点/整数的绝对值**
*   **MOD:返回除法的余数**
*   **SIGN:如果参数为正，则返回 1；如果参数为 0，则返回 0；否则返回-1**
*   **SQRT:返回一个值的平方根**
*   **FLOOR/CEIL:返回参数中最接近的向下/向上整数**
*   **POWER:返回第一个参数的第二次幂**

*****其他*****

*   **NULLIF:如果两个参数的值相等，则返回 NULL**
*   **如果第一个参数为空，则返回一个特定的表达式**
*   **EXISTS:检查是否存在非空值。**
*   **IN:检查值列表中是否存在给定值。**
*   **RANK:窗口函数，为结果集分区中的每一行给出一个等级(通常使用 ROW_NUMBER 更简单**

# ****需要了解的其他事实:****

**-如果你用 NULL 做任何数学运算，你还是有 NULL。
-要在查询中获得唯一的值，请在 SELECT 子句中使用 DISTINCT 关键字(也要知道这会明显降低查询速度)。
-默认情况下，除非另有规定，ORDER BY 以 ASC 顺序执行。**

**SQL 资源仍然相对分散在互联网上，很容易陷入过于复杂材料的陷阱。初级水平的大多数数据科学家职位/面试所需的 SQL 知识通常仍然非常基础，足以掌握绝大多数角色的基础/中介功能。**

**我强烈推荐从[模式](https://mode.com/sql-tutorial/introduction-to-sql/)开始的奇妙课程，供用户寻找最基本/中级 SQL 功能的更全面指南。为了更多的实践，请随意查看 [HackerRank](https://www.hackerrank.com/) 的专用 SQL 子部分。**