<html>
<head>
<title>An Introduction to Estimating the Causal Effects of Feasible Interventions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可行干预的因果效应估计导论</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-introduction-to-estimating-the-causal-effects-of-feasible-interventions-e07ed45136ff?source=collection_archive---------63-----------------------#2020-06-18">https://towardsdatascience.com/an-introduction-to-estimating-the-causal-effects-of-feasible-interventions-e07ed45136ff?source=collection_archive---------63-----------------------#2020-06-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="df9d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一种灵活的因果推理方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5b1d0625f643704743fc3cfb4e7af12b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BnHWJY7JannMUoBX2txHVg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@drew_beamer" rel="noopener ugc nofollow" target="_blank">德鲁·比姆</a> r在<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="36dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象一下你正在申请法学院。你参加了法学院入学考试，但没有得到你想要的高分。你开始想知道，提高你的LSAT分数对你的录取结果(定义为你申请的学校中你被录取的比例)会有什么影响？</p><p id="e926" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">乍一看，这似乎很容易。你找到前几年申请人的一些数据，回归LSAT分数的录取结果。太好了，你在LSAT分数和你期望被录取的学校比例之间有了一个衡量标准。</p><p id="e1a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是…这真的回答了你的问题吗？你的估计是无偏的吗？你回想一下线性回归的假设，意识到你能被录取的学校比例有界在0和1之间，所以不可能是线性的。你还记得一个回归系数的固定解释，“X每增加一个单位，Y增加或减少β”；如果有人刷爆了他们的LSAT分数，这种解释如何成立？</p><p id="1cfd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑到这一点，你开始缩小你的研究问题:如果LSAT分数提高了一个现实的数量，那么提高LSAT分数对法学院入学结果会有什么影响？我们可以认为这是一种可行的干预措施，并正式将其定义为一种修改后的治疗政策。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><blockquote class="mc md me"><p id="d478" class="kz la mf lb b lc ld ju le lf lg jx lh mg lj lk ll mh ln lo lp mi lr ls lt lu im bi translated">修改后的处理政策(MTP)被定义为可以依赖于暴露的自然价值的干预。这不同于其他因果效应，如平均治疗效应(ATE)，在平均治疗效应中，暴露量将确定性地增加(或减少)，这通常是不可能的。</p></blockquote><p id="ef34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于我们的问题，考虑LSAT分数所在的MTP:</p><ul class=""><li id="9ac1" class="mj mk it lb b lc ld lf lg li ml lm mm lq mn lu mo mp mq mr bi translated">如果个人的<em class="mf">观察到的</em> LSAT分数在120-150之间，则增加10分</li><li id="bf34" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">如果在151-160之间，则增加5分</li><li id="2e67" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">如果在161-165之间，则增加2分</li><li id="7c95" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">如果他们的分数高于165，则保持不变。</li></ul><p id="0829" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种干预考虑到观察到的LSAT分数越高，就越难提高。我们认为这种干预是可行的，因为我们可以想象一种假设的干预可以实现它(例如，参加LSAT预备课程)。相比之下，确定性干预，也是不可能的干预，将是每个人的LSAT分数增加相同数量的干预。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="dfa0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">定义了感兴趣的MTP后，您会很快意识到标准参数方法无法处理这个问题。进入R包<code class="fe mx my mz na b"><a class="ae ky" href="https://github.com/nt-williams/lmtp" rel="noopener ugc nofollow" target="_blank">lmtp</a></code>。<code class="fe mx my mz na b"><a class="ae ky" href="https://github.com/nt-williams/lmtp" rel="noopener ugc nofollow" target="_blank">lmtp</a></code>为基于点治疗和纵向修正治疗策略的可行干预措施的非参数偶然效应提供了一个估计框架。它支持两种主要的估计量，一种交叉验证的基于目标最小损失的估计量(CV-TMLE)和一种序列双稳健估计量(SDR)。这两种估计量都具有双重稳健性。这一点很重要，有几个原因，但也许最引人注目的是，它允许我们使用机器学习进行评估。因此，<code class="fe mx my mz na b"><a class="ae ky" href="https://github.com/nt-williams/lmtp" rel="noopener ugc nofollow" target="_blank">lmtp</a></code>使用<code class="fe mx my mz na b"><a class="ae ky" href="https://github.com/tlverse/sl3" rel="noopener ugc nofollow" target="_blank">sl3</a></code>包进行整体机器学习(也称为超级学习或堆叠泛化)来进行估计。</p><p id="af17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[1]超级学习对多个单独的机器学习算法的结果进行加权，以创建模型的最佳组合。</p><h1 id="af7d" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">应用</h1><p id="b0f2" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">让我们用<code class="fe mx my mz na b"><a class="ae ky" href="https://github.com/nt-williams/lmtp" rel="noopener ugc nofollow" target="_blank">lmtp</a></code>来回答我们的问题。首先，我们安装并加载必要的包，并模拟我们的数据。为了简单起见，我们假设录取只受GPA和LSAT分数的影响，GPA混淆了LSAT和录取之间的关系。我们还将假设法学院不设置招生上限。</p><pre class="kj kk kl km gt ny na nz oa aw ob bi"><span id="6815" class="oc nc it na b gy od oe l of og"># install and load lmtp, sl3, future, and progressr<br/>remotes::install_github("nt-williams/lmtp")<br/>remotes::install_github("tlverse/sl3")<br/>install.packages(c("future", "progressr"))</span><span id="3b26" class="oc nc it na b gy oh oe l of og">library(lmtp)<br/>library(sl3)<br/>library(future)<br/>library(progressr)</span><span id="c2f8" class="oc nc it na b gy oh oe l of og"># set seed and sample size<br/>set.seed(6232)<br/>n &lt;- 1000</span><span id="8710" class="oc nc it na b gy oh oe l of og"># assume you must have a minimum gpa of 3.0 to <br/># graduate from college and the maximum gpa is a 4.0<br/>gpa &lt;- round(rnorm(n, 3.5, .25), 2)<br/>gpa &lt;- ifelse(gpa &lt; 3, 3, gpa)<br/>gpa &lt;- ifelse(gpa &gt; 4, 4, gpa)</span><span id="5076" class="oc nc it na b gy oh oe l of og"># LSAT scores are bounded between 120 and 180 so we truncate<br/>lsat &lt;- round(rnorm(n, 149, 10) + gpa)<br/>lsat &lt;- ifelse(lsat &lt; 120, 120, lsat)<br/>lsat &lt;- ifelse(lsat &gt; 180, 180, lsat)</span><span id="dd4a" class="oc nc it na b gy oh oe l of og"># admissions results<br/>admit &lt;- (lsat / 300) + 0.05*gpa + 0.01*lsat*gpa<br/>admit &lt;- (admit - min(admit)) / (max(admit) - min(admit))</span><span id="5149" class="oc nc it na b gy oh oe l of og"># combine the data<br/>admissions &lt;- data.frame(gpa, lsat, admit)</span></pre><p id="5840" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我提到过<code class="fe mx my mz na b"><a class="ae ky" href="https://github.com/nt-williams/lmtp" rel="noopener ugc nofollow" target="_blank">lmtp</a></code>可以使用一个集合学习器进行估计，所以让我们来设置一下。我们将使用仅拦截模型、GLM和随机森林的集合。</p><pre class="kj kk kl km gt ny na nz oa aw ob bi"><span id="e274" class="oc nc it na b gy od oe l of og">lrnrs &lt;- make_learner_stack(Lrnr_mean, <br/>                            Lrnr_glm, <br/>                            Lrnr_ranger)</span></pre><p id="4979" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还需要一种方式将我们感兴趣的干预传达给<code class="fe mx my mz na b"><a class="ae ky" href="https://github.com/nt-williams/lmtp" rel="noopener ugc nofollow" target="_blank">lmtp</a></code>。我们可以使用移位函数来实现这一点。移位函数只是将一个向量作为输入，并返回一个长度和类型相同但根据我们的干预进行了修改的向量。</p><pre class="kj kk kl km gt ny na nz oa aw ob bi"><span id="3eb2" class="oc nc it na b gy od oe l of og">mtp &lt;- function(x) {<br/>  (x &lt;= 150)*(x + 10) + <br/>    (x &gt;= 151 &amp; x &lt;= 160)*(x + 5) + <br/>    (x &gt;= 161 &amp; x &lt;= 165)*(x + 2) + <br/>    (x &gt; 165)*x<br/>}</span><span id="3a30" class="oc nc it na b gy oh oe l of og">head(lsat)<br/>#&gt; [1] 145 156 161 139 148 148</span><span id="6fca" class="oc nc it na b gy oh oe l of og">head(mtp(lsat)) # testing our shift function<br/>#&gt; [1] 155 161 163 149 158 158</span></pre><p id="3a9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">剩下的就是估计干预的效果了。我们将使用CV-TML估计量<code class="fe mx my mz na b">lmtp_tmle()</code>。</p><pre class="kj kk kl km gt ny na nz oa aw ob bi"><span id="7a7e" class="oc nc it na b gy od oe l of og">plan(multiprocess) # using parallel processing</span><span id="7d60" class="oc nc it na b gy oh oe l of og">with_progress({<br/>  psi &lt;- lmtp_tmle(admissions, <br/>                   trt = "lsat", <br/>                   outcome = "admit", <br/>                   baseline = "gpa", <br/>                   shift = mtp, <br/>                   outcome_type = "continuous", <br/>                   learners_outcome = lrnrs,<br/>                   learners_trt = lrnrs)<br/>})</span><span id="15d2" class="oc nc it na b gy oh oe l of og">psi<br/>#&gt; LMTP Estimator: TMLE<br/>#&gt;    Trt. Policy: (mtp)<br/>#&gt; <br/>#&gt; Population intervention effect<br/>#&gt;       Estimate: 0.4945<br/>#&gt;     Std. error: 0.0044<br/>#&gt;         95% CI: (0.4858, 0.5032)</span></pre><p id="7ac8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据我们的LSAT处理政策，我们估计法学院在人口中的平均比例为0.495，95%的置信区间为0.49到0.5。我们可以正式地将这与观察到的法学院在LSAT自然分数0.42以下被录取的平均比例进行比较。</p><pre class="kj kk kl km gt ny na nz oa aw ob bi"><span id="1c73" class="oc nc it na b gy od oe l of og">ref &lt;- mean(admit)<br/>lmtp_contrast(psi, ref = ref)<br/>#&gt; Non-estimated reference value, defaulting type = 'additive'.<br/>#&gt; <br/>#&gt; LMTP Contrast: additive<br/>#&gt; Null hypothesis: theta == 0<br/>#&gt; <br/>#&gt;    theta shift   ref std.error conf.low conf.high p.value<br/>#&gt; 1 0.0701 0.494 0.424   0.00443   0.0614    0.0788  &lt;0.001</span></pre><p id="a1e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们估计，我们的治疗政策将使法学院在人口中的平均比例增加0.07，95%的置信区间为0.06至0.08。看来提高分数对你最有利。</p><h1 id="f124" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">最后的想法</h1><p id="3d64" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">前面的例子应该已经帮助你对什么是改良的治疗策略以及它们为什么有用建立了一些直觉。此外，这是一个玩具的例子，不应该被视为任何更多。</p><p id="f9a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也就是说，这里有几个MTP实际应用的例子:</p><ul class=""><li id="1bf2" class="mj mk it lb b lc ld lf lg li ml lm mm lq mn lu mo mp mq mr bi translated">老年人体力活动对心血管疾病发病率的影响</li><li id="c0c2" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">手术时间对术后结果的影响</li><li id="929d" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">水质、卫生、洗手和营养干预对疾病转归的影响</li></ul><p id="86f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">修改后的治疗策略并不局限于持续暴露，也可用于二元和分类治疗。此外，<code class="fe mx my mz na b"><a class="ae ky" href="https://github.com/nt-williams/lmtp" rel="noopener ugc nofollow" target="_blank">lmtp</a></code>适用于处理点治疗和纵向设置的二元、连续和存活结果(结果中均有遗漏),并可估计确定性治疗效果，如ate。关于使用<code class="fe mx my mz na b"><a class="ae ky" href="https://github.com/nt-williams/lmtp" rel="noopener ugc nofollow" target="_blank">lmtp</a>,</code>的深入介绍，我推荐你通读软件包<a class="ae ky" href="https://htmlpreview.github.io/?https://gist.githubusercontent.com/nt-williams/ddd44c48390b8d976fad71750e48d8bf/raw/c56a7b0bbdf24ec18d08f839e73fa06a42ca9265/intro-lmtp.html" rel="noopener ugc nofollow" target="_blank">简介</a>。</p><p id="f67e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想了解更多关于因果推断、修改后的治疗策略以及它们为何如此有用、基于目标最小损失的估计或超级学习者的信息，我推荐以下资源:</p><ul class=""><li id="78f7" class="mj mk it lb b lc ld lf lg li ml lm mm lq mn lu mo mp mq mr bi translated">Pearl、Glymour M .和Jewel N.P .，<a class="ae ky" href="http://bayes.cs.ucla.edu/PRIMER/" rel="noopener ugc nofollow" target="_blank">统计学中的因果推断，初级读本</a> (2016) Wiley</li><li id="6c43" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">díaz muoz，I .和van der Laan，m .，<a class="ae ky" href="https://pubmed.ncbi.nlm.nih.gov/21977966/" rel="noopener ugc nofollow" target="_blank">基于随机干预的人口干预因果效应</a> (2012)，生物统计学</li><li id="a61a" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">Díaz，I .、Williams，n .、Hoffman，K. L .和Schenck，E. J .，<a class="ae ky" href="https://arxiv.org/abs/2006.01366v2" rel="noopener ugc nofollow" target="_blank">基于纵向修正治疗政策的非参数因果关系</a> (2020)，arXiv</li><li id="0442" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">Haneuse，s .和Rotnitzky，a .，<a class="ae ky" href="https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.5907?casa_token=Mc7QwrKckREAAAAA%3ADJfUP5oz0R9BP4YtRYz2g65EYgZsX1TsTceFl-VgIWuhA5DX1KWznh1KyzSLn8H9DuA5RHur7zi4ib80" rel="noopener ugc nofollow" target="_blank">对修改已接受治疗的干预措施效果的评估</a> (2013)，医学统计</li><li id="ad60" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">范德莱恩，M. J .和罗斯，S. <a class="ae ky" href="https://www.springer.com/gp/book/9781441997814" rel="noopener ugc nofollow" target="_blank">统计学中的目标学习</a> (2011)斯普林格系列</li><li id="b396" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">Naimi，A. I .和Balzer，L. B. <a class="ae ky" href="https://link.springer.com/article/10.1007/s10654-018-0390-z" rel="noopener ugc nofollow" target="_blank">堆叠概括:超级学习简介</a> (2018)，《欧洲流行病学杂志》</li></ul></div></div>    
</body>
</html>