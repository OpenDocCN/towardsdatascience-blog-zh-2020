<html>
<head>
<title>Statisticians Should Learn TensorFlow Too</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">统计学家也应该学习张量流</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/statisticians-should-learn-tensorflow-too-58309441d3c2?source=collection_archive---------38-----------------------#2020-07-26">https://towardsdatascience.com/statisticians-should-learn-tensorflow-too-58309441d3c2?source=collection_archive---------38-----------------------#2020-07-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7179" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">统计学和机器学习在某种程度上一直存在分歧。下面是 TensorFlow 如何弥合这一差距。</h2></div><p id="0b42" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">委婉地说，统计学家总是带着一定程度的怀疑看待机器学习。</p><p id="798b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然统计学依赖于科学方法，并与任何学术领域一样受到同样的辩论和审查，但机器学习已经获得了“黑箱”方法的恶名，即数据只是被插入模型以产生结果，而结果不一定可靠。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/f4d17793f935505de7a2e9b334be8fc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FDYCM601x8VDENG0MtZ0iw.jpeg"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">来源:图片由<a class="ae lu" href="https://pixabay.com/users/artsybee-462611/" rel="noopener ugc nofollow" target="_blank"> ArtsyBee </a>从<a class="ae lu" href="https://pixabay.com/photos/mathematics-maths-computer-laptop-3821034/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>拍摄。</p></figure><p id="4605" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">也就是说，如果知道如何正确利用统计学和机器学习，这两者的结合会非常强大。</p><p id="657e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是我个人经验中的一些例子，说明 TensorFlow 是如何变得更加“统计友好”的，以及为什么这个软件库应该得到统计界更多的关注。</p><h2 id="98ad" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated"><strong class="ak"> 1。TensorFlow Probability 是一个被低估的概率编程工具</strong></h2><p id="cb06" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">TensorFlow 最初发布于 2015 年，2018 年 6 月发布了第一版 TensorFlow Probability。</p><p id="be48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个库结合了<strong class="kk iu">概率编程</strong>和<strong class="kk iu">深度学习</strong>的能力，以便对大型数据集进行统计分析。具体来说，TensorFlow Probability 强调了<strong class="kk iu">贝叶斯方法</strong>，它补充了 Python 中的 PyMC3 库，pym C3 库也实现了贝叶斯建模和统计分析。</p><p id="c03c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我预计这个图书馆将对未来的统计学家变得越来越重要。随着数据集变得越来越大，人们越来越重视概率在时间序列分析中的作用，张量流概率在处理这两个方面非常有效。</p><p id="b5a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在新冠肺炎事件发生之前，我一直在做一个关于酒店取消预订的兼职项目。该项目的部分目的是运行一些时间序列模型来预测给定酒店每周取消预订的数量。</p><p id="fa00" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，一个纯时间序列模型有其局限性，因为它不能解释极端情况下的时间，即全球疫情关闭酒店并导致取消预订的大幅增加。从这个角度来看，如果以今天的数据为模型，ARIMA 或 LSTM 等模型仍将被证明是非常不准确的。</p><p id="91a6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">也就是说，如果同样的数据用张量流概率建模会怎么样？</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mt"><img src="../Images/7dce005e52ff748b00ae7b50f7dae495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LGHeHNn1_mwjj-vqZ-qIWw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">来源:Jupyter 笔记本输出</p></figure><p id="763f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在查看该图时，我们可以看到，虽然也给出了线性预测，但该预测是基于后验分布建模的，以确定结果的范围。例如，我们可以看到，在极端情况下，取消订单可能会超过每周 500 个。</p><p id="e58e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这使得酒店可以询问——在什么情况下酒店每周会有超过 500 次的取消预订——以及如何防止这种情况发生？</p><p id="ef8d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在进行预测时，张量流概率考虑到了<em class="mu">不确定性</em>，我预计这将变得越来越重要。</p><h2 id="3f35" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated"><strong class="ak"> 2。Keras 和 R 的兼容性强</strong></h2><p id="deeb" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">从 TensorFlow 版本开始，Keras 已经成为库的默认 API。</p><p id="0690" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Keras 用于快速直观地生成深度神经网络。这种神经网络可用于设计分类和预测任务，以及用 LSTM 模型进行时间序列分析。</p><p id="b5a0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，Keras 也能够在 R 环境中运行，这一点不一定广为人知。</p><p id="aaf4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这为基础统计分析与机器学习模型的结合提供了一个强大的平台。</p><p id="e106" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个例子(在下面的参考文献部分引用)是使用序列模型来预测血糖水平。</p><p id="9390" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该库附带了可视化训练和验证损失的工具，就像在 Python 中一样:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/297c1e8bbec621420bb975d718b8e7f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*u57kVC0uBL00qrLvthgVuQ.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">资料来源:RStudio</p></figure><p id="a782" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，R 用户也可以利用 R 中的许多统计函数来促进分析。虽然像 Python 中的<strong class="kk iu"> pyplot </strong>或<strong class="kk iu"> seaborn </strong>这样的库也可以生成相关图，但是使用 r</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/a4f45f669f2102c595a07bc8e642dced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*l_wwBK_AB8rMDu7qWn45IQ.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">资料来源:RStudio</p></figure><p id="93b2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，R 还附带了一个名为<strong class="kk iu"> MLMetrics </strong>的便利库，可以轻松计算损耗和精度指标。</p><p id="2926" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从这个角度来看，希望利用机器学习的统计学家可以很容易地使用 Keras 在 R 中完成工作，而不是为了利用机器学习解决方案而必须学习 Python。</p><h2 id="f332" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated"><strong class="ak"> 3。与微软的 InterpretML 等可解释库结合使用时非常直观</strong></h2><p id="6af1" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">最近，人们越来越重视让机器学习模型变得可解释。也就是说——让模型输出容易被人类理解。</p><p id="051c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，来自微软的 InterpretML 库的 DiCE 擅长于通过生成<strong class="kk iu">不同的反事实解释</strong>。例如，假设我们正在构建一个分类模型，以预测客户是否会根据不同的属性取消酒店预订，例如他们的原籍国、交付时间、客户类型等因素。</p><p id="2f19" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本例中，DiCE 能够获取客户未取消预订的实例，并生成反例，即特征参数的变化会使客户更有可能取消预订。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mt"><img src="../Images/776d4f0f7371aecc7fafc4f4cda965ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N30HgEiG9dEFk4PB7moXZA.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">来源:Jupyter 笔记本输出—解释</p></figure><p id="8802" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当使用 Keras 构建顺序模型时，DiCE 通过保留模型训练参数对此进行补充，即使数据本身必须在一段时间后删除，例如，由于数据隐私法规等。</p><p id="1f74" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从这个角度来看，机器学习正在发展到一个重点，即让结果更加直观和易于理解——从这个例子中我们已经看到，TensorFlow 可以在这方面很好地补充其他 ML 库。</p><h2 id="f0c0" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated"><strong class="ak"> 4。必要时能够跨其他领域同时构建模型</strong></h2><p id="cbc4" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">你可能是一名统计学家，但你能肯定地说你永远不需要跨另一个学科构建算法吗——例如自然语言处理或图像分类？</p><p id="ded8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">学习张量流和神经网络的美妙之处在于，不同领域的模型配置实际上可能非常相似。</p><p id="d7e0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，我第一次接触 LSTM(长短期记忆)网络是通过一门自然语言处理课程。然而，由于这种模型的序列性质(或理解观察值之间的依赖性的能力)，我了解到 LSTM 模型在建模不稳定的时间序列数据时实际上是非常有效的。这个模型不一定适合所有情况——如果一个时间序列有一个很强的趋势，那么更传统的模型，如 ARIMA 模型，往往会更好地工作。</p><p id="6289" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，我发现自己使用 LSTM 来完成某些时间序列任务，因此在这种情况下，机器学习仍然与时间序列学科相关。</p><p id="4dde" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为另一个例子，学习如何将 CNN(卷积神经网络)用于分类任务，可以更容易地理解如何使用相同的网络进行图像分类。通过这种方式，理解张量流神经网络如何运行也有可能打开其他学科的知识。</p><h2 id="c3ef" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated"><strong class="ak">结论</strong></h2><p id="0311" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">作为一个经常使用时间序列和统计方法的人，我发现 TensorFlow 在这些领域使用机器学习时非常有用。</p><p id="2992" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我预计，随着数据量越来越大——越来越需要机器学习来及时有效地处理这些信息——同时仍然允许对结果进行直观的解释。</p><p id="b55a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">出于这些目的，我对 TensorFlow 印象深刻，它将继续成为我的数据科学工具包中的重要参考。</p><p id="f3b4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mu">免责声明:本文是在“原样”的基础上编写的，没有担保。本文旨在提供数据科学概念的概述，不应以任何方式解释为专业建议。</em></p><h2 id="d90a" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated"><strong class="ak">参考文献</strong></h2><ul class=""><li id="d44f" class="mx my it kk b kl mo ko mp kr mz kv na kz nb ld nc nd ne nf bi translated"><a class="ae lu" href="https://www.researchgate.net/publication/309379684_Using_Data_Science_to_Predict_Hotel_Booking_Cancellations" rel="noopener ugc nofollow" target="_blank"> Antonio、Almeida 和 Nunes:使用数据科学预测酒店预订取消</a></li><li id="2c0f" class="mx my it kk b kl ng ko nh kr ni kv nj kz nk ld nc nd ne nf bi translated"><a class="ae lu" href="https://github.com/interpretml" rel="noopener ugc nofollow" target="_blank"> GitHub:解释性文字</a></li><li id="9e0a" class="mx my it kk b kl ng ko nh kr ni kv nj kz nk ld nc nd ne nf bi translated"><a class="ae lu" href="https://github.com/tensorflow/probability/releases?after=v0.3.0" rel="noopener ugc nofollow" target="_blank"> GitHub:张量流概率</a></li><li id="03ad" class="mx my it kk b kl ng ko nh kr ni kv nj kz nk ld nc nd ne nf bi translated"><a class="ae lu" href="https://www.rdocumentation.org/packages/MLmetrics/versions/1.1.1" rel="noopener ugc nofollow" target="_blank">文档:MLmetrics </a></li><li id="787b" class="mx my it kk b kl ng ko nh kr ni kv nj kz nk ld nc nd ne nf bi translated"><a class="ae lu" href="https://blog.tensorflow.org/2018/12/an-introduction-to-probabilistic.html" rel="noopener ugc nofollow" target="_blank"> TensorFlow 博客:概率编程介绍，现已在 TensorFlow Probability </a>中发布</li><li id="ee6e" class="mx my it kk b kl ng ko nh kr ni kv nj kz nk ld nc nd ne nf bi translated"><a class="ae lu" rel="noopener" target="_blank" href="/keras-and-r-predicting-blood-glucose-levels-with-the-sequential-model-596efe89a6b8">走向数据科学——Keras 和 R:用序列模型预测血糖水平</a></li><li id="3d7a" class="mx my it kk b kl ng ko nh kr ni kv nj kz nk ld nc nd ne nf bi translated"><a class="ae lu" rel="noopener" target="_blank" href="/tensorflow-probability-predicting-weekly-hotel-cancellations-with-structural-time-series-modelling-eee0545f5f07">走向数据科学——利用结构化时间序列模型预测每周酒店取消预订量</a></li></ul></div></div>    
</body>
</html>