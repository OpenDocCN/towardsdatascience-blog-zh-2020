<html>
<head>
<title>How to achieve a quick &amp; accurate baseline for ML competitions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在大联盟比赛中获得快速准确的基线</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-achieve-a-quick-accurate-baseline-for-ml-competitions-11b7ae29b673?source=collection_archive---------61-----------------------#2020-05-12">https://towardsdatascience.com/how-to-achieve-a-quick-accurate-baseline-for-ml-competitions-11b7ae29b673?source=collection_archive---------61-----------------------#2020-05-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cff6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">这篇文章描述了我如何只用几行代码就在<em class="ki">性病药物有效性预测挑战赛</em>中获得第五名。</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/adf554d4be2cb8e2e795ef3dd6a78ff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i9ZvwVQheDpNXHeo"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">照片由<a class="ae kz" href="https://unsplash.com/@owenbeard?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">欧文比尔德</a>在<a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="0e6f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">根据美国疾病预防控制中心的报告，2018年美国报告了超过240万例性传播疾病(STDs)。该报告还强调，从2017年到2018年，因梅毒导致的新生儿死亡人数增长了22%。基于这些事实，HackerEarth宣布了<a class="ae kz" href="https://www.hackerearth.com/challenges/competitive/hackerearth-machine-learning-challenge-std-drug-effectiveness/" rel="noopener ugc nofollow" target="_blank">性病药物有效性机器学习预测挑战</a>，以提高人们对各种性病和用于治疗它们的药物的认识。</p><p id="3082" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">虽然我没有足够的时间专门参加比赛，但这一次看起来真的很有趣，我无法抗拒自己。一些快速分析和一些提交后，我在这里，在公共排行榜上获得第三名，在私人排行榜上获得第五名。我对我在这个问题上所花时间的排名感到非常惊讶，所以我决定写一篇关于我的方法的博客，以便每个人都能从快速准确的基线中受益。那么，让我们开始吧！</p><p id="6b28" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu"> <em class="lw">免责声明:我不使用熊猫</em> </strong> <em class="lw">(不，我不是嬉皮士——伪数据科学家，相信我)</em></p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/c8b700a8816b7cad2d02681f2d5d4de0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*LJshlnYFCUSCYTypsj5-iA.jpeg"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">来源:<a class="ae kz" href="https://imgflip.com/i/412v91" rel="noopener ugc nofollow" target="_blank">用<a class="ae kz" href="https://imgflip.com/" rel="noopener ugc nofollow" target="_blank"> Imgflip </a> <a class="ae kz" href="https://imgflip.com/memegenerator" rel="noopener ugc nofollow" target="_blank">模因生成器</a> (CCO)创建了</a></p></figure><div class="ly lz gp gr ma mb"><a href="https://github.com/atif-hassan/Competition-code/blob/master/Hackerearth/STD%20Drug%20Effectiveness/code/new_regression_ml.py" rel="noopener  ugc nofollow" target="_blank"><div class="mc ab fo"><div class="md ab me cl cj mf"><h2 class="bd iu gy z fp mg fr fs mh fu fw is bi translated">atif-Hassan/竞赛代码</h2><div class="mi l"><h3 class="bd b gy z fp mg fr fs mh fu fw dk translated">这个库包含我为我参加的所有比赛编写的代码- atif-hassan/Competition-code</h3></div><div class="mj l"><p class="bd b dl z fp mg fr fs mh fu fw dk translated">github.com</p></div></div><div class="mk l"><div class="ml l mm mn mo mk mp kt mb"/></div></div></a></div><h1 id="a566" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">数据分析</h1><p id="bebc" class="pw-post-body-paragraph la lb it lc b ld ni ju lf lg nj jx li lj nk ll lm ln nl lp lq lr nm lt lu lv im bi translated">什么？你认为会有银弹吗？我刚告诉过你我不是嬉皮士伪数据科学家！在解决问题之前，你总是需要分析你的数据。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nn"><img src="../Images/63ad40b97b57661f5da2bcd185fd4167.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1B-4hH90ddstl7QQPPVBoA.png"/></div></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">资料截图</p></figure><p id="1f88" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><em class="lw">有效性评级</em>功能是由评审者提供的最终评级，因此，可用于替代<em class="lw">评审_患者</em>栏。<em class="lw">药品由UIC </em>批准的功能没有多大意义，因为同一种药品有多个批准日期。有一种可能性是，批准是基于一个病人一个病人的基础上，但我没有深入挖掘这个想法。在平台提供的训练集和测试集中，<em class="lw"> patient_id </em>列不包含任何副本，因此它没有任何用处。经过这种初步的"<em class="lw">特征选择</em>"之后，我们剩下的是<em class="lw">药品名称(我们称此栏为</em> <strong class="lc iu"> <em class="lw">药品/药品名称</em></strong><em class="lw">)</em><em class="lw">使用_病例_药物(我们称此栏为</em> <strong class="lc iu"> <em class="lw">疾病</em></strong><em class="lw">)</em><em class="lw">药品_疗效</em>和<em class="lw"/></p><p id="1484" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">因为药物和疾病特征是分类的，所以让我们看看所有独特的实例，以便知道我们在这里处理的是什么。在excel的数据类别中快速应用筛选选项就可以做到这一点。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi no"><img src="../Images/5dfaa5872a206a6b35f520980d60295b.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*tScBBQ-gLeKNG4NdapIIbA.png"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">似乎疾病栏不是很干净</p></figure><p id="c111" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">药物一栏中没有什么出乎意料的，尽管疾病一栏确实包含一些噪音。看起来噪音模式是一个数字后跟一个span句子，可能是一个刮擦错误。现在让我们检查测试数据集中的药物和疾病列是否都是它们的训练数据集对应物的子集。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="np nq l"/></div><p class="kv kw gj gh gi kx ky bd b be z dk translated">代码查找出词汇(OOV)药物和疾病</p></figure><pre class="kk kl km kn gt nr ns nt nu aw nv bi"><span id="529e" class="nw mr it ns b gy nx ny l nz oa">OOV Drugs (158 in total):<br/>-------------------------<br/>Acetaminophen / caffeine<br/>Advil Cold and Sinus Liqui-Gels<br/>Afrin 4 Hour Extra Moisturizing<br/>Amethia Lo<br/>Amitriptyline / perphenazine<br/>.<br/>.<br/>.</span><span id="c08e" class="nw mr it ns b gy ob ny l nz oa">OOV Diseases (34 in total):<br/>---------------------------<br/>22&lt;/span&gt; users found this comment helpful.<br/>39&lt;/span&gt; users found this comment helpful.<br/>55&lt;/span&gt; users found this comment helpful.<br/>Aphthous Ulce<br/>Breast Cancer, Prevention<br/>.<br/>.<br/>.</span></pre><p id="4806" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">从上面的输出可以看出，测试集中有相当多的药物和一些疾病没有出现在训练集中，这是一个问题。但是等等，我们知道药物有时有多个名字。因此，也许，如果我们可以找到测试集中存在的药物的替代名称(存在于训练集中的名称)，那么，我们可以替换这些药物名称，并帮助模型理解大量样本。Drugs.com是一个很好的网站。由于时间不多，我只手动替换了几个药名。如果所有OOV药品的名称都被替换为训练集中正确的名称，这肯定会有所帮助。</p><pre class="kk kl km kn gt nr ns nt nu aw nv bi"><span id="ceac" class="nw mr it ns b gy nx ny l nz oa">Drug "Esomeprazole / naproxen" was present as "Vimovo" in test set<br/>Drug "Senna S" was present as "Docusate / senna" in test set<br/>Drug "Empagliflozin" was present as "Synjardy" in test set<br/>.<br/>.<br/>.</span></pre><p id="2175" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">同样，疾病也可以被替代，但是在这种情况下，oov的数量很少，所以我决定忽略它们。</p><h1 id="2616" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">模型结构</h1><p id="a4d4" class="pw-post-body-paragraph la lb it lc b ld ni ju lf lg nj jx li lj nk ll lm ln nl lp lq lr nm lt lu lv im bi translated">一旦预处理完成，我就进入了模型构建阶段。我无法使用<em class="lw">药物有效性</em>和<em class="lw">处方次数</em>数字列<em class="lw">快速设计一些好的功能。</em>相反，我应用了k-means聚类，并使用所有聚类之间的样本距离作为特征。这种无监督的特征工程方法几乎总是对我有效。我将很快写一篇关于所有这些技巧和窍门的文章，但更多的将在后面。“药品”和“疾病”列是一次性编码的(ohe ),而“疾病”列中的所有干扰样本都被替换为一个字符串，代表一个缺失值。这两组一键编码与两个数字和k均值特征连接在一起。这导致了一个大而稀疏的特征空间。</p><p id="55b3" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">最后，我使用LightGBM回归模型进行预测。使用10倍交叉验证对模型的超参数进行了一些调整。就是这样！这就是我能够连续20天保持在公共排行榜首位的原因，但值得称赞的是，前4名参与者一直工作到最后一刻！</p><h1 id="ea54" class="mq mr it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">带回家的信息</h1><p id="d58b" class="pw-post-body-paragraph la lb it lc b ld ni ju lf lg nj jx li lj nk ll lm ln nl lp lq lr nm lt lu lv im bi translated">永远记住，即使花费少量的时间和精力来挖掘数据中的模式，也能为您提供真正好的结果。这就是如何用几行代码实现快速准确的基线😉。</p><p id="5349" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我知道这篇文章不包含任何可视化，但那是因为我没有把太多的数据分析融入到我的工作中。我恳求大家给我提供反馈，因为这是我的第一篇博客(所以请小心行事😅).</p></div><div class="ab cl oc od hx oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="im in io ip iq"><blockquote class="oj"><p id="63b6" class="ok ol it bd om on oo op oq or os lv dk translated">谢谢大家！</p></blockquote></div></div>    
</body>
</html>