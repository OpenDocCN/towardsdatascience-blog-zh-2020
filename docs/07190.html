<html>
<head>
<title>Document scanner and private data sharing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">文档扫描仪和私人数据共享</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/document-scanner-and-private-data-sharing-2fb82b3f0fbb?source=collection_archive---------53-----------------------#2020-06-01">https://towardsdatascience.com/document-scanner-and-private-data-sharing-2fb82b3f0fbb?source=collection_archive---------53-----------------------#2020-06-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="60ef" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何给文档拍照，使用变换矩阵和变换视角并私信</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d523adf0a19edacb2af0a208c68e22d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BAhd3vOBxw0fVx8tXmHmnw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://depositphotos.com/" rel="noopener ugc nofollow" target="_blank"> Depositphotos </a></p></figure><h1 id="f9a0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">摘要</h1><p id="0221" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">问题:</strong>我们想用手机给一份文件拍照，然后私下发给收件人。通过这篇文章，我们试图解决现实生活中可能出现的问题:</p><ul class=""><li id="e541" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">给文档拍照可能会很麻烦——并不是所有的文档都读得很好，有一堆不需要的数据；</li><li id="ad85" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">图片可以通过第三方(如托管、图像共享服务等)获取。).我们希望一切都是私人的；</li><li id="7292" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">我们希望有一种快速的方式在浏览器中显示图像，直接从密文转换而来。</li></ul><p id="5d58" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated"><strong class="lt iu">这是现实生活中的问题吗？</strong>拍一张影像，“修复”视角并不是什么新鲜事，但却是现实妻子身上出现频率非常高的东西。这是一件常见的事情——有人问:“请扫描这份合同，并在今天发给我”或“请扫描这份声明，并在一个小时内发给我”，但如果我们没有扫描仪，我们怎么办？当然——用我们的手机拍个照，发个乱七八糟的图。然后我们得到回应——“嘿，你有扫描仪吗？我不想照片上有你的鞋子”等等。</p><p id="167b" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们将如何解决这个问题——当然是用数学。我们将使用一些步骤来抛出这个过程。我们将使用检测角度、改变视角和加密库来隐藏重要信息并方便地传输。</p><p id="5768" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated"><strong class="lt iu">我们将使用什么库</strong> —我们将使用和组合各种类型的库:</p><ul class=""><li id="8050" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><a class="ae ky" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank"> numpy </a> —作为Python数值运算中的标准</li><li id="65b0" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://opencv.org/" rel="noopener ugc nofollow" target="_blank">OpenCV</a>—Python中的图像处理；</li><li id="6c57" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://github.com/woltapp/blurhash-python" rel="noopener ugc nofollow" target="_blank"> blurhash-python </a> —获取图像的占位符。它对文档不是很有用，但也许我们会想在功能上扩展这个私人共享图像服务。如果我们这样做，占位符将非常非常重要。读者只能看到最初的预览，但如果没有密码，就没有办法看到整个画面。</li><li id="3be1" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://pypi.org/project/imutils/" rel="noopener ugc nofollow" target="_blank"> imutils </a> —一系列方便的功能，使基本的图像处理功能，如平移、旋转、调整大小、骨架化、显示Matplotlib图像、排序轮廓、检测边缘等，在OpenCV中变得更加简单。</li><li id="bba3" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://pypi.org/project/pyaes/" rel="noopener ugc nofollow" target="_blank">py AES</a>—AES(FIPS-197)分组密码算法和常见操作模式(CBC、CFB、CTR、ECB、OFB)的纯Python实现，不依赖于标准Python库。有关API参考和详细信息，请参见README.md。</li><li id="1322" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://pypi.org/project/pbkdf2/" rel="noopener ugc nofollow" target="_blank">pbkdf2</a>—RSA PKCS # 5v 2.0中规定的基于密码的密钥派生函数pbk df 2</li></ul><p id="0013" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated"><strong class="lt iu">我们将使用什么加密算法来保护数据？</strong></p><ul class=""><li id="bf29" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">base64 —用于将图像转换为文本，并以相反的方式进行转换。它对于向浏览器发送图片很有用；</li><li id="e415" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">blurhash —用于生成图像的占位符；</li><li id="503c" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">AES —用于文本(base64)加密；</li></ul><h1 id="3e64" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数学视角的改变</h1><p id="13e4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为什么在这篇文章中改变视角如此重要？在当前的文章中，我们将看看视角的实际变化。但是更深入地了解这个概念和数学基础对于理解整个图景是至关重要的。</p><p id="0712" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">在这里你可以找到一篇文章，它对透视变换背后的数学进行了深入的概述:<a class="ae ky" href="https://www.math.utah.edu/~treiberg/Perspect/Perspect.htm" rel="noopener ugc nofollow" target="_blank">https://www.math.utah.edu/~treiberg/Perspect/Perspect.htm</a>那些发生在艺术和计算机图形学中的数学思想。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/b6c73ff7088cc53b87bc67bac79c4253.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*ko5hIljG1n7PWjjN22RtWw.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">阿尔贝提的问题</p></figure><p id="e208" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">这个问题促进了一门新学科——射影几何的发展，其代表人物是吉拉德·笛沙格(1591-1661)。</p><h2 id="a9ee" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">点的平行变换</h2><p id="8b58" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">描述三维空间中的点如何映射到绘图平面的透视变换可以使用初等几何来简单地解释。我们从建立坐标开始。投影涉及两个坐标系。待画物体坐标系中的一点由<strong class="lt iu"> <em class="nt"> X=(x，y，z) </em> </strong>给出，在成像系统中(在绘图平面上)对应的是<strong class="lt iu"> <em class="nt"> P=(u，v) </em> </strong>。如果我们使用标准的右手系统，那么<strong class="lt iu"> <em class="nt"> x </em> </strong>和<strong class="lt iu"> <em class="nt"> y </em> </strong>对应宽度和深度，<strong class="lt iu"> <em class="nt"> z </em> </strong>对应高度。在绘图平面上，我们让<strong class="lt iu"><em class="nt"/></strong>为水平变量，<strong class="lt iu"> <em class="nt"> v </em> </strong>为垂直变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/865d6b8b3eac4dcb8b6d57a649355ca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*wbiyO690e5itZ7whMx1Lvw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将对象投影到绘图平面</p></figure><p id="674e" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们可以使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Euclidean_distance" rel="noopener ugc nofollow" target="_blank">欧几里德度量</a>以通常的方式测量成对点之间的距离。</p><p id="edf4" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">如果</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/fc7e76df54fcdf8c85ffacfce8b5915b.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*xUQEnlp4s4rDiQ6UUVCnqA.png"/></div></figure><p id="c1aa" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">和</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/7377f9943eccc5013ab9cd49906f2ccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:420/format:webp/1*2ijpQT_4Sz6kW451vB6GQg.png"/></div></figure><p id="6368" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">以此类推，然后:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/a34a89e57fe2444748fffaa6d6d8f2a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*clzr-I1JNzyZmW8Je0YywA.png"/></div></div></figure><p id="1033" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">如果物体中的所有平行线组都映射到图上的平行线，则从X到P的投影称为平行投影。这种映射由仿射变换给出，其形式为</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/8ce639aab64a5df90c2b6a704bf066d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*7FXlyX6RMcTA0-ayNt3aUA.png"/></div></figure><p id="02bd" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">其中<strong class="lt iu"> <em class="nt"> T </em> </strong>是平面中的固定向量，而<strong class="lt iu"> <em class="nt"> A </em> </strong>是3×2常数矩阵。平行投影还具有保持比值的特性。也就是说，如果<strong class="lt iu"> <em class="nt"> X (1，2，3，4) </em> </strong>是物体中的共线点，那么在平行投影下保持距离比</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/4d676027000cd2eb35cf1970d6aca5c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*_AFfsdZwUVj15BFhOxyIoQ.png"/></div></figure><p id="1a83" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">当然，分母被假定为非零。</p><h1 id="635f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">全过程</h1><h2 id="d50d" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">步骤0。要求</h2><p id="823d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">当你不知道所需的库和版本时，启动Python脚本总是一件痛苦的事情。我就是这样创建一个<strong class="lt iu"> requirements.txt </strong>文件(<a class="ae ky" href="https://gist.github.com/simeonemanuilov/8eb79283007445d6ee929caf62e48b59" rel="noopener ugc nofollow" target="_blank">链接</a>):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="ak"> requirements.txt </strong></p></figure><h2 id="2d17" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">第一步。阅读图像</h2><p id="7059" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这个阶段，我们需要进行导入，我们将在本文中进一步使用它们。请不要忘记让所有的导入按预期工作。此外，我们还定义了一些函数，这些函数在将来会很有用。这些是OpenCV的基本操作，可以重复多次，在函数中使用它们是很好的做法(如<strong class="lt iu"> read_image </strong>、<strong class="lt iu"> show_image_opencv </strong>、<strong class="lt iu"> save_image_opencv </strong>等)。我们还创建了一个函数<strong class="lt iu"> get_current_dir </strong>，如果我们不知道当前目录，或者我们想要包含来自不同位置的图像，这个函数可以帮助我们。</p><p id="26ec" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">请记住，对于*nix系统(比如Mac)，show_image_opencv不能很好地工作。可以“冻结”在<strong class="lt iu"> destroyAllWindows() </strong>的部分；</p><p id="6c29" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们读取我们的输入文件，名为<strong class="lt iu">bulsatcom.png</strong>，它和课程项目文件放在同一个目录下。然后我们可以创建一个变量来保存输入文件+一个副本。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="5097" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">原始文件:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/7b94ff89661bafc5be01cdc137298dec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*iDIeEk6RZAPUA8KW0k8-dQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">bulsatcom.png</p></figure><p id="962e" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated"><strong class="lt iu">这一步的预期结果:</strong>我们现在有了保存图像的OpenCV对象。我们在<strong class="lt iu"> input_image.png </strong>中也有一份图像的副本</p><h2 id="4032" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">第二步。识别边缘</h2><p id="30a3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">每个图像都有一些噪声，我们在这一步的目标是进行清理。其中一种方法是将彩色图像转换成灰色图像。之后，我们应用一个模糊函数，用(3，3)滤波器模糊图像。模糊减少了任何高频噪声，使轮廓检测更容易。</p><p id="8f2a" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">这里我们只有一个函数detect_edges，它接受输入图像并返回一个带有边缘的实例。</p><p id="2cb4" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">也许这里最有趣的部分是精明的边缘检测。Canny边缘检测是一种流行的边缘检测算法。它是由约翰·f·坎尼在1986年开发的。这是一个多阶段算法，简而言之，步骤如下:</p><ul class=""><li id="a72e" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">降噪；</li><li id="b432" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">找到图像的强度梯度；</li><li id="92d2" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">非最大抑制；</li><li id="8427" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">滞后阈值处理。</li></ul><p id="4b84" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">所以我们最终得到的是图像中的强边缘。第一个参数是图像实例(已经是灰色和模糊的)，第二个和第三个参数分别是我们的minVal和maxVal。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="3676" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated"><strong class="lt iu">这一步的预期结果:</strong>我们这里只有一个函数，但却是非常重要的一个。我们应用过滤器对图像中的噪声进行一些清理。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/d715b798702f13d90ac3d57013ff42c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*d8bMrmAuo9hyQ7TCA_K3fA.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd od"> edged_image.jpg </strong></p></figure><p id="50dd" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated"><strong class="lt iu">其他方法，文章&amp;边缘检测方法:</strong></p><ul class=""><li id="bdf1" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><a class="ae ky" href="https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_imgproc/py_canny/py_canny.html" rel="noopener ugc nofollow" target="_blank"> Canny边缘检测</a></li><li id="e192" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/edge-detection-in-python-a3c263a13e03">边缘检测——迈向数据科学的文章</a></li></ul><h2 id="94ac" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">第三步。检测图像中的文档边缘</h2><p id="3aac" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">最有趣的部分之一是找到图像中的轮廓。找出面积最高的等高线也是一个挑战(但非常重要)。在这一点上，我们将排除文件中的一些大字母或图像。我们只需要最大的部分，也就是整个文档。</p><p id="c239" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">我们创建了一个函数<strong class="lt iu">calculate _ draw _ contours</strong>，其中我们使用了一些内置的OpenCV函数，比如findContours。该函数返回</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="919d" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated"><strong class="lt iu">这一步的预期结果:</strong>我们有了图像的轮廓。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/4cdea3e1f461a47170e6be2e670c12e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*7L8M4K96ENmdpB0FknT4lg.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd od"> contoured_image.jpg </strong></p></figure><h2 id="6781" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">第四步。识别和提取文档边界/边缘</h2><p id="305d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这是本文中最难的时刻之一。我们有文档中所有角的坐标，排列它们并知道哪个坐标对应于一个角是至关重要的。<br/>图像由像素组成。当我们有一张灰色的图片时，我们没有颜色的深度，这也是一个维度。所以我们可以在两个维度上处理这些图片——宽度和高度。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><h2 id="45ff" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">第五步。应用透视变换</h2><p id="fe59" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">当我们有了维度，我们就可以构建目的点。我们可以使用OpenCV中的getPerspectiveTransform函数，它从四对对应点计算透视变换。之后，我们可以使用warpPerspective，它对图像应用透视变换。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="a361" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated"><strong class="lt iu">这一步的预期结果:</strong>一个几乎扫描的图像，哪一个视角更好显示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/41a0d9ff290b32fce2e6600cc42fc8cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*hSVK1F-1pouZziUOWI6hkQ.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><strong class="bd od"> scanned_image.jpg </strong></p></figure><h2 id="e1bd" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">第六步。用base64编码图像</h2><h2 id="0a49" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">但是Base64是什么呢？</h2><p id="a3e5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Base64是一种将8位二进制数据编码成可以用7位表示的格式的方式。只使用字符a-z、A-Z、0–9、+和/来表示数据，用=来填充数据。例如，使用这种编码，三个8位字节被转换成四个7位字节。</p><p id="9b6f" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">术语Base64取自<a class="ae ky" href="https://en.wikipedia.org/wiki/MIME" rel="noopener ugc nofollow" target="_blank">多用途互联网邮件扩展(MIME) </a>标准，该标准广泛用于HTTP和XML，最初是为编码电子邮件附件以便传输而开发的。</p><h2 id="1856" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">我们为什么使用Base64？</h2><p id="79d1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Base64对于二进制数据表示非常重要，因为它允许二进制数据以看起来和行为上都像纯文本的方式来表示，这使得在数据库中存储、通过电子邮件发送或以基于文本的格式(如XML)使用二进制数据更加可靠。Base64主要用于以ASCII字符串格式表示数据。</p><h2 id="1a9d" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">为什么我们不到处使用Base64？</h2><p id="f8e3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">base64能为我们做一些重要的事情是好的，但我们必须记住，我们不应该在每个地方都使用Base64，尤其是在web开发中。在这里你可以找到一篇关于这个的<a class="ae ky" href="https://csswizardry.com/2017/02/base64-encoding-and-performance/" rel="noopener ugc nofollow" target="_blank">有趣文章。</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><h2 id="7f1f" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">第七步。也获取图像的blurhash值</h2><p id="c473" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">BlurHash是图像占位符的紧凑表示。我发现它在项目中很有用，在项目中，我希望节省带宽并在图像实际加载之前显示一个占位符。此外，它非常适合本文，因为我们可以计算图片的BlurHash值并将其存储在DB中。之后，我们可以在用户的浏览器中显示“预览”,用户不允许查看完整的图片/文档。<br/>它可以用来做一些事情，比如一张图像的秘密变体，上面有一些数据，但不足以读取或识别模式。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/907589cddd0b2f118af871b67c5f215e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*ytp3kAEONy5tPW0kgFVYcg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://github.com/woltapp/blurhash" rel="noopener ugc nofollow" target="_blank"> BlurHash </a>拍摄</p></figure><p id="c290" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated"><strong class="lt iu">更多相关链接信息</strong></p><ul class=""><li id="ac31" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated"><a class="ae ky" href="https://github.com/woltapp/blurhash-python" rel="noopener ugc nofollow" target="_blank">https://github.com/woltapp/blurhash-python</a></li><li id="5528" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://codesandbox.io/s/lopvu" rel="noopener ugc nofollow" target="_blank">cloud image+blur hash的沙盒</a></li></ul><h2 id="55f3" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">第八步。用AES加密</h2><p id="0dc1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">下面的例子将说明一个简单的基于密码的AES加密(PBKDF2 + AES-CTR)，没有消息认证(未经认证的加密)。我发现这对于本文很有用，因为我们希望对图像进行base64编码，并使其“受密码保护”,如果有人拥有服务器，或者以某种方式阅读我们的消息，他就不能看到内容。</p><p id="741d" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">此类操作的有用链接:<a class="ae ky" href="https://cryptobook.nakov.com/symmetric-key-ciphers/aes-encrypt-decrypt-examples" rel="noopener ugc nofollow" target="_blank">https://crypto book . nakov . com/symmetric-key-ciphers/AES-encrypt-decrypt-examples</a></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><h2 id="2aeb" class="nh la it bd lb ni nj dn lf nk nl dp lj ma nm nn ll me no np ln mi nq nr lp ns bi translated">第九步。发送密文并在浏览器中可视化</h2><p id="43da" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这一步是可选的，我们不打算深入这个主题。这个想法是，当我们在浏览器中显示加密的image + blurhash(简短预览)时，拥有密码的用户可以加密密文并看到base64字符串。他也可以把它转换成图像。创建一个JavaScript库非常容易，它接受BlurHash值+密文，并在成功输入密码后可视化base64图像(原生为HTML格式)。</p><p id="37d3" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">可用于此类操作(AES在浏览器中解密)的示例库可在此处找到:【https://github.com/ricmoo/aes-js<a class="ae ky" href="https://github.com/ricmoo/aes-js" rel="noopener ugc nofollow" target="_blank"/></p><h1 id="2632" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">摘要</h1><p id="2fd6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">简而言之，我们想在这篇文章中表达什么？</strong></p><ul class=""><li id="29ef" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">用我们的手机拍一张图像；</li><li id="67d6" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">修复透视图以获得几乎扫描的文档；</li><li id="30b3" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">用base64编码；</li><li id="8e84" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">获取blurhash值；</li><li id="00e2" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">用AES加密；</li><li id="a4ab" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">发送密文；</li><li id="7c77" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">显示blurhash预览；</li><li id="978d" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">在有可用库的浏览器中解码。</li></ul><p id="7d2d" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated">它将解决一些私人文件/图片共享+修复一个文件的图片透视的问题。我们使用各种技术来获得这一点，这种方法可以很容易地成为一个API，我试图在最大的部分像函数一样，可以转换为端点。</p><h1 id="cde4" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">类似的文章/研究</h1><ul class=""><li id="986d" class="mn mo it lt b lu lv lx ly ma og me oh mi oi mm mu mv mw mx bi translated"><a class="ae ky" href="https://github.com/AmeyCaps/Document_Scanner" rel="noopener ugc nofollow" target="_blank">https://github.com/AmeyCaps/Document_Scanner</a></li><li id="e7c7" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/document-scanner-using-computer-vision-opencv-and-python-20b87b1cbb06">https://towards data science . com/document-scanner-using-computer-vision-opencv-and-python-20b 87 B1 cbb 06</a></li><li id="89b5" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://github.com/andrewdcampbell/OpenCV-Document-Scanner" rel="noopener ugc nofollow" target="_blank">https://github.com/andrewdcampbell/OpenCV-Document-Scanner</a></li></ul><p id="20f3" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma nd mc md me ne mg mh mi nf mk ml mm im bi translated"><strong class="lt iu">这篇文章中我们还有哪些内容？</strong></p><ul class=""><li id="b7ba" class="mn mo it lt b lu mp lx mq ma mr me ms mi mt mm mu mv mw mx bi translated">用加密方法扩展私人文件共享的想法；</li><li id="9e81" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">对函数、步骤和数学概念的描述性解释；</li><li id="13a8" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated">一些函数的测试，如果在计算中出现问题，这些测试会对我们有所帮助。</li></ul><h1 id="c137" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">一些函数的快速测试</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oa ob l"/></div></figure><h1 id="84fc" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">链接</h1><ul class=""><li id="8d63" class="mn mo it lt b lu lv lx ly ma og me oh mi oi mm mu mv mw mx bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Steganography" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Steganography</a>(隐藏图像信息的有趣话题)</li><li id="fd18" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://itnext.io/steganography-101-lsb-introduction-with-python-4c4803e08041" rel="noopener ugc nofollow" target="_blank">https://it next . io/steganography-101-LSB-introduction-with-python-4c 4803 e 08041</a>(图像中隐藏信息的有趣话题)</li><li id="593d" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://code.tutsplus.com/tutorials/base64-encoding-and-decoding-using-python--cms-25588" rel="noopener ugc nofollow" target="_blank">https://code . tuts plus . com/tutorials/Base64-encoding-and-decoding-using-python-CMS-25588</a>(Base64文章)</li><li id="09e6" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://csswizardry.com/2017/02/base64-encoding-and-performance/" rel="noopener ugc nofollow" target="_blank">https://CSS wizardry . com/2017/02/base64-encoding-and-performance/</a>(为什么要用base64，为什么不用？)</li><li id="f2f8" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://medium.com/@amitasaurus/encrypting-decrypting-a-string-with-aes-js-1d9efa4d66d7" rel="noopener">https://medium . com/@ amita saurus/encrypting-decrypting-a-string-with-AES-js-1 d9 EFA 4d 66d 7</a>(JavaScript decrypt AES)</li><li id="54f0" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://stackoverflow.com/questions/41980931/image-encryption-and-decryption-using-pycrypto" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/41980931/image-encryption-and-decryption-using-py Crypto</a>(Python加密模块)</li><li id="17d9" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://pycryptodome.readthedocs.io/en/latest/src/cipher/aes.html" rel="noopener ugc nofollow" target="_blank">https://pycryptodome . readthedocs . io/en/latest/src/cipher/aes . html</a>(JavaScript解密AES)</li><li id="7930" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://github.com/woltapp/blurhash-python" rel="noopener ugc nofollow" target="_blank">https://github.com/woltapp/blurhash-python</a>(Python的BlurHash实现)</li><li id="5bf9" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://www.pro-soft.bg/software/" rel="noopener ugc nofollow" target="_blank">https://www.pro-soft.bg/software/</a>(保加利亚语的软件新闻/博客)</li><li id="9156" class="mn mo it lt b lu my lx mz ma na me nb mi nc mm mu mv mw mx bi translated"><a class="ae ky" href="https://cryptobook.nakov.com/symmetric-key-ciphers/aes-encrypt-decrypt-examples" rel="noopener ugc nofollow" target="_blank">https://crypto book . nakov . com/symmetric-key-ciphers/AES-encrypt-decrypt-examples</a>(AES用密码加密和解密)</li></ul></div></div>    
</body>
</html>