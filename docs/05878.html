<html>
<head>
<title>The Asset of Age</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">年龄的财富</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-asset-of-age-e4b45599ea94?source=collection_archive---------40-----------------------#2020-05-14">https://towardsdatascience.com/the-asset-of-age-e4b45599ea94?source=collection_archive---------40-----------------------#2020-05-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4ba3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">NBA球员发展分析</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7f0bc8dafefc32a6e0ca7be8a5134433.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aXOxm8JzCyEGspRZ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">切尔西·费伦南多在<a class="ae ky" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> UnSplash </a>上的照片</p></figure><p id="c30c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我每周体育主题系列的第三部分。每周，我都会展示以体育为中心的数据科学应用。</p><p id="d263" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上周，我发表了一篇关于体育参考API 的<a class="ae ky" rel="noopener" target="_blank" href="/sports-reference-api-intro-dbce09e89e52">介绍，并展示了该API如何用于构建一个全面的NBA球员统计数据集。本周，我将深入这个数据集，看看球员的发展。</a></p><p id="549f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">NBA球队喜欢选秀年轻球员，这不是什么秘密。无论是从国际联盟来到NBA，还是在NCAA单干，青少年往往是第一批离开赛场的球员。年龄较大但更有成就的潜在客户往往必须等到第二轮，许多人没有被选中。很明显，NBA球探将年龄视为一项资产，让我们来看看这是为什么。</p><p id="076b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个显而易见的假设是，年轻球员在达到巅峰状态之前有更多的时间发展。但是什么时候是一个球员的全盛时期，他们真正发展了多少？事实上，每个球员的情况都不一样，但是数据中有一些趋势是可以确定的。</p><h2 id="51f6" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">黄金时间</h2><p id="f237" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">为了确定典型的NBA球员的黄金时期何时出现，我将根据年龄来看PER ( <a class="ae ky" href="https://en.wikipedia.org/wiki/Player_efficiency_rating" rel="noopener ugc nofollow" target="_blank">球员效率等级</a>)。PER是一种先进的篮球统计，由霍林格开发，它试图将传统的得分指标结合成一个单一的评级。虽然PER远非完美，尤其是在衡量防守方面，但它已经是你在单一评级中能得到的最好的了。</p><p id="e8cc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我首先加载数据集并绘制一些简单的图来感受数据。关于如何生成这个数据集，参见我之前的<a class="ae ky" rel="noopener" target="_blank" href="/sports-reference-api-intro-dbce09e89e52">故事</a>。我还做了一些额外的专栏，删除了不符合最低分钟数要求的赛季。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="5ed3" class="lv lw it mu b gy my mz l na nb">import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="4f4a" class="lv lw it mu b gy nc mz l na nb">%matplotlib inline</span><span id="329e" class="lv lw it mu b gy nc mz l na nb">seasons = pd.read_csv('Data/nba_player_stats_by_season.csv',<br/>                      index_col = 'id')</span><span id="c67c" class="lv lw it mu b gy nc mz l na nb"># Create a few extra columns<br/>def get_min_age(player_id):<br/>    return seasons[seasons['player_id'] == player_id]['age'].min()</span><span id="e9cc" class="lv lw it mu b gy nc mz l na nb">seasons['min_age'] = seasons['player_id'].apply(get_min_age)<br/>seasons['min_age_rounded'] = seasons['min_age'].apply(lambda x: int(np.floor(x)))<br/>seasons['age_rounded'] = seasons['age'].apply(lambda x: int(np.floor(x)))</span><span id="7d8c" class="lv lw it mu b gy nc mz l na nb">careers['min_age'] = careers['player_id'].apply(get_min_age)<br/>careers['min_age_rounded'] = careers['min_age'].apply(lambda x: int(np.floor(x)))</span><span id="8614" class="lv lw it mu b gy nc mz l na nb"># remove seasons with less than 1500 minutes.<br/># this is the minimum minutes requirement per BBallRef to qualify for PER.</span><span id="1fd5" class="lv lw it mu b gy nc mz l na nb">qseasons = seasons[seasons['minutes_played'] &gt; 1500]</span><span id="0114" class="lv lw it mu b gy nc mz l na nb">sns.set_context('notebook')<br/>sns.jointplot(x = qseasons['age'],<br/>              y = qseasons['player_efficiency_rating'],<br/>              kind = 'hex');</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/0b4badda96817ab0d2c46049ef27182d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AwAmRkBkTMOCEXGcKAbPFg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每对年龄联合图</p></figure><p id="bac4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这张图表显示，最高的PER季节发生在25岁左右。接下来，我将查看PER &gt; 20的季节的年龄分布，以及数据集中所有季节的总体年龄分布。作为参考，20的命中率被认为是一个临界的全明星赛季。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="d21c" class="lv lw it mu b gy my mz l na nb">plt.figure(figsize=(15,6))<br/>sns.set_context('notebook')</span><span id="2731" class="lv lw it mu b gy nc mz l na nb">plt.subplot(1,2,1)<br/>sns.distplot(qseasons[qseasons['player_efficiency_rating'] &gt; 20]['age'])<br/>plt.title('Age Distribution for PER &gt; 20 Seasons')</span><span id="6f7e" class="lv lw it mu b gy nc mz l na nb">plt.subplot(1,2,2)<br/>sns.distplot(qseasons['age'])<br/>plt.title('Overall League Age Distribution');</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/9e88f701a2cb3dd945c75bdee626d409.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jb-AxRZ8LhoZEXDDpn97KQ.png"/></div></div></figure><p id="dbe2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从这里可以看出，高PER季节的分布与我们数据集中的整体年龄分布基本相同。虽然很有趣，但这并没有真正说明20多岁的球员会更好，目前为止我所展示的是大多数球员都在这个年龄段。为了更好地了解不同年龄的预期表现，箱线图可以清晰地显示每个年龄组的PER分布。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="8b2d" class="lv lw it mu b gy my mz l na nb">plt.figure(figsize=(15,6))<br/>sns.set_context('notebook')<br/>sns.boxplot(x = qseasons['age_rounded'],<br/>            y = qseasons['player_efficiency_rating'])<br/>plt.title('PER vs Age Boxplot');</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/476c4e4acffe0cdf39d708fc30d24327.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G4xA_aXMuGAqzUdDoHY_Nw.png"/></div></div></figure><p id="b892" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们正在谈话！这个箱线图很好地展示了数据，并表明24-28岁年龄段的球员比其他年龄段的球员有更高的预期表现。这通过由方框中间的线表示的PER中值、由方框顶部表示的第75百分位PER以及高PER异常值的丰度来显示。其他一些有趣的趋势也很明显。一个是19岁和20岁的球员通常不是很好。另一个原因是36岁以上的球员表现上升，这是只有最好的球员能够在这个年龄之后留在联盟的结果。</p><h2 id="d60b" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">青春的价值</h2><p id="16d1" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">前面的部分仍然没有解释为什么球队如此强烈地支持青年选秀。如果19岁和20岁的球员通常效率较低，那么为什么不选择接近巅峰或者已经处于巅峰的老球员呢？回到年轻球员在达到巅峰状态之前有更多时间发展的假设，我将看看球员在职业生涯中是如何发展的。</p><p id="43d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为此，我将使用上面定义的“min_age”列对数据集进行分段，这只是表示球员在第一个赛季的年龄。下图是球员在NBA第一个赛季的年龄分布。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="949d" class="lv lw it mu b gy my mz l na nb">sns.distplot(careers['min_age']);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/d57ff5f7e8d728d105ae070d7d50a004.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uS8XPmv2fK7Sk_Pn_g9aHQ.png"/></div></div></figure><p id="a660" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如人们所料，大多数球员在他们的第一个NBA赛季都在20到25岁之间。一个按年龄划分的平均PER图，按球员在NBA第一个赛季的年龄划分，显示了年轻和年长年龄组非常不同的结果。以下代码生成此图。请注意，我将18岁和19岁这两个年龄段结合在一起，因为18岁这一年龄段本身就很小。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="ec37" class="lv lw it mu b gy my mz l na nb">qseasons['min_age_rounded'] = qseasons['min_age_rounded'].apply(<br/>                              lambda x: 19 if x &lt;= 19 else x)</span><span id="4535" class="lv lw it mu b gy nc mz l na nb"># segment qseasons by min_age_rounded and plot<br/>plt.figure(figsize=(10,6))<br/>sns.set_context('notebook')<br/>plt.xticks(ticks = [x for x in range(18,38)])<br/>plt.title("PER by Age, Segmented by Entry Age")</span><span id="907b" class="lv lw it mu b gy nc mz l na nb">for i in range(19, 24):</span><span id="872f" class="lv lw it mu b gy nc mz l na nb">    # filter data and aggregate<br/>    temp_df = qseasons[qseasons['min_age_rounded'] == i]<br/>              [['age_rounded', 'player_efficiency_rating']]<br/>    temp_df = temp_df.groupby(by = 'age_rounded').agg(<br/>              ['mean', 'count'])</span><span id="eb4e" class="lv lw it mu b gy nc mz l na nb">    # remove multi-index, then remove seasons with low sample size<br/>    temp_df.columns = [' '.join(col).strip() for col in<br/>                       temp_df.columns.values]<br/>    temp_df = temp_df[temp_df['player_efficiency_rating count'] &gt;<br/>                      10]['player_efficiency_rating mean']</span><span id="d782" class="lv lw it mu b gy nc mz l na nb">    # plot segment data<br/>    sns.lineplot(x = temp_df.index, y = temp_df, label = i)<br/>    sns.scatterplot(x = temp_df.index, y = temp_df);</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/60a671484271ae991f050deabcfd182f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V3t5pVqH3xd21oTfZw3AEA.png"/></div></div></figure><p id="7013" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这里，我们可以看到，19岁、20岁和21岁年龄段的人在25岁左右比22岁和23岁年龄段的人更有效率。特别是，19岁年龄组在25岁达到了令人印象深刻的高峰，这是6年复合改善的结果。在此期间，19岁年龄段的球员平均能够提高6分以上的PER。相比之下，22岁的细分市场从入门到巅峰平均只能提高2个百分点。请注意，这些线是根据可用的样本大小截断的。</p><p id="ae83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，使用箱线图可以进一步理解这些部分。各部分主要年份的PER箱线图有助于更全面地了解数据分布。这可以使用下面的代码来构造。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="b253" class="lv lw it mu b gy my mz l na nb">temp_df = qseasons[np.array(qseasons['min_age_rounded'] &lt;= 23) &amp;<br/>                   np.array(qseasons['age_rounded'] &lt;= 28) &amp;<br/>                   np.array(qseasons['age_rounded'] &gt;= 24)]</span><span id="e3ba" class="lv lw it mu b gy nc mz l na nb">plt.figure(figsize=(10,6))<br/>sns.set_context('notebook')<br/>sns.boxplot(x = temp_df['min_age_rounded'],<br/>            y = temp_df['player_efficiency_rating'])<br/>plt.title('PER in Prime Years (24-28) by Entry Age');</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/1c671741caacecbfe3b7a4cba43aebfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5fVhuRjbP4OKGUHI0xatuA.png"/></div></div></figure><h2 id="8072" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">萧条和偏见</h2><p id="978d" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">虽然我已经表明，在评估潜在的NBA人才时，年龄是一个非常重要的考虑因素，但它肯定不是一切。有很多在NBA选秀中被选中的年轻球员的例子，他们从来没有取得什么成就。重要的是要记住相关性和因果关系是非常不同的概念，证明因果关系的门槛要高得多。这个分析只显示了相关性，但是值得思考一下为什么存在这种相关性。</p><p id="9ae2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">主要原因是NBA选秀过程中固有的选择偏差。一个年轻的篮球运动员有强烈的动机尽快加入NBA。状元秀的新秀薪水是数百万美元，早早进入NBA给了球员一个更长的潜在职业收入窗口。因此，在任何时候，最好的19岁球员几乎总是希望成为职业球员。明年，这个组中剩下的最好的球员将在20岁时成为职业球员。在大多数情况下，一个22岁的球员进入NBA是一个不够好，不能更早进入NBA的球员。所以我们有最优秀的球员在年轻的时候进入NBA，然后最优秀的球员继续成为最优秀的球员。似乎很明显，不是吗？</p><p id="13b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事后看来，破产往往是对这种选择偏差误解的结果。在某些情况下，一支球队会选择一名球员，几乎完全是因为他们年轻。如果玩家没有真正证明自己是同龄人中的佼佼者，他们就很难领先。这是把相关性误认为因果关系，本质上是假设玩家会遵循上面显示的轨迹，因为他们还年轻。在其他情况下，一个球队会选择一个在大学四年级时发布了令人印象深刻的数据的老球员。在这些情况下，如果这个球员之前没有被证明是同龄人中的佼佼者，那么他们可能不值得接手已经证明了这一点的年轻球员。这是与第一个例子相反的错误，它完全忽略了选择偏差和相关性。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="d46c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你喜欢这篇文章。如果你有，请查看我的文章<a class="ae ky" rel="noopener" target="_blank" href="/beating-the-odds-8d26b1a83f1b">战胜困难</a>、<a class="ae ky" rel="noopener" target="_blank" href="/sports-reference-api-intro-dbce09e89e52">体育参考API介绍</a>和<a class="ae ky" href="https://towardsdatascience.com/@acmuhr" rel="noopener" target="_blank">其他</a>。下周，我将再次使用这个NBA球员数据集来建立一个预测2020年以后NBA职业生涯的模型。</p></div></div>    
</body>
</html>