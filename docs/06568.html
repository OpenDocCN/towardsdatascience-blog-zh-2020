<html>
<head>
<title>Build Your Fully Configurable Interface to Create MNIST-like Dataset with Python in 10 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建完全可配置的界面，用Python在10分钟内创建类似MNIST的数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-your-fully-configurable-interface-to-create-mnist-like-dataset-with-python-in-10-minutes-43ab414a875e?source=collection_archive---------40-----------------------#2020-05-24">https://towardsdatascience.com/build-your-fully-configurable-interface-to-create-mnist-like-dataset-with-python-in-10-minutes-43ab414a875e?source=collection_archive---------40-----------------------#2020-05-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5369" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一步一步的用户友好的python界面，从JSON配置文件中编写数据集(带代码)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/e4bb2fcaf0ff366d60951ad3367d0f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*AtdEr-6-fMciD8IIQ-RLvg.gif"/></div></figure><h1 id="edaf" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">动机</h1><p id="fc0a" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了一个个人项目，也许是一篇论文(手指交叉)，我需要创建一个类似MNIST的数据集。我以为可以<strong class="lk iu">对别人有用</strong>。因此，我将解释<strong class="lk iu">我是如何用Python </strong>编写这个<strong class="lk iu">接口的。(<a class="ae me" href="https://github.com/AxelThevenot/Python-Interface-to-Create-Handwritten-dataset/blob/master/README.md" rel="noopener ugc nofollow" target="_blank"> github库</a>)</strong></p><p id="ac14" class="pw-post-body-paragraph li lj it lk b ll mf ju ln lo mg jx lq lr mh lt lu lv mi lx ly lz mj mb mc md im bi translated">本文的目的是<strong class="lk iu">能够将自己的界面</strong>设计成尽可能的<strong class="lk iu">灵活</strong>和<strong class="lk iu">快速</strong>。这个界面将允许我们用鼠标绘制我们的角色<strong class="lk iu">，其他所有事情都将通过配置文件中指定的<strong class="lk iu">大量参数</strong>自动<strong class="lk iu">完成</strong>。</strong></p><h1 id="0998" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">完全可配置</h1><p id="0152" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我正在从一个JSON文件中寻找一个完全可配置的接口。再也不用摸代码，就是<strong class="lk iu">灵活</strong>、<strong class="lk iu">便捷</strong>和<strong class="lk iu">可伸缩</strong>。我们将在本文中讨论不同的参数，但是所有的参数都包含在我命名为<code class="fe mk ml mm mn b">config.json</code>的文件中。你可以随意命名。它允许您更改:</p><ul class=""><li id="c6a7" class="mo mp it lk b ll mf lo mg lr mq lv mr lz ms md mt mu mv mw bi translated">我们在上面绘制的图像的尺寸。</li><li id="bc06" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated">输出图像的<strong class="lk iu">尺寸，以完成<strong class="lk iu">数据集</strong>。</strong></li><li id="458a" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu">每个类别的预期图像数量</strong>，首选绘图<strong class="lk iu">节奏</strong>以及我们输出图像的<strong class="lk iu">渲染</strong>的存在。</li><li id="6872" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated">包含数据集的<strong class="lk iu">文件夹名称</strong>，可以为每个类创建<strong class="lk iu">子文件夹。</strong></li><li id="dee8" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated">我们铅笔的<strong class="lk iu">尺寸</strong>、<strong class="lk iu">强度</strong>和<strong class="lk iu">褪色</strong>..</li><li id="aed9" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu">插补</strong>方法。</li><li id="87b4" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu">命名类的</strong>。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h1 id="2654" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">存储和公用设施</h1><p id="c223" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">重要的事情先来。我们需要知道如何组织我们的数据。在文件<code class="fe mk ml mm mn b">config.json</code>中，我们有<code class="fe mk ml mm mn b">storage</code>部分:</p><ul class=""><li id="76e5" class="mo mp it lk b ll mf lo mg lr mq lv mr lz ms md mt mu mv mw bi translated"><strong class="lk iu"> root </strong> (str):数据集的<strong class="lk iu"> root </strong>文件夹的路径</li><li id="305c" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu"> by_class_name </strong> (bool):数据集的存储方式</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/2d406662a4307f674fc155cc9dcc10e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k-J6H363dHu_ZyrLpdwPvw.png"/></div></div></figure><p id="d768" class="pw-post-body-paragraph li lj it lk b ll mf ju ln lo mg jx lq lr mh lt lu lv mi lx ly lz mj mb mc md im bi translated">我们所有的图像都将有<strong class="lk iu">相同的图案</strong>。图像的名称总是以类名开头。然后是下划线，然后是5个字符的数字来标识它。所以我们有一个<code class="fe mk ml mm mn b">root/(subfolderclass)/name_id.png</code>格式。</p><p id="bc60" class="pw-post-body-paragraph li lj it lk b ll mf ju ln lo mg jx lq lr mh lt lu lv mi lx ly lz mj mb mc md im bi translated">您会注意到id是递增设置的<strong class="lk iu"/>。换句话说，你可以看到每个类已经生成了多少图像。然而，作为用户，你可能需要也可能不需要将其他文件放入这些文件夹中，或者有时删除图像或重命名它们。我们将在代码的开头放一小部分，让<strong class="lk iu">自动重新排列我们的图像名称</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ne"><img src="../Images/f0656aa66fdae902a4b4b38c0bafc04a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZiQmqjv3iEfFBbfqlCOaBQ.png"/></div></div></figure><p id="4567" class="pw-post-body-paragraph li lj it lk b ll mf ju ln lo mg jx lq lr mh lt lu lv mi lx ly lz mj mb mc md im bi translated">在<code class="fe mk ml mm mn b">utils.py</code>中我们设置了一些功能:</p><ul class=""><li id="04de" class="mo mp it lk b ll mf lo mg lr mq lv mr lz ms md mt mu mv mw bi translated"><strong class="lk iu"> get_json </strong>:返回json文件的<strong class="lk iu">内容，作为python <strong class="lk iu">字典</strong>。</strong></li><li id="2f6e" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu"> check_folder_path </strong>:检查文件夹<strong class="lk iu">是否存在</strong>，否则新建一个<strong class="lk iu"/>。</li><li id="fe44" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu">order _ filename _ by _ prefix</strong>:<strong class="lk iu">按照正确的名称格式对文件重新排序</strong>。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h1 id="25c0" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">设计师</h1><p id="7071" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们想要的是能够用手(鼠标)画出我们的角色<strong class="lk iu">。从<strong class="lk iu">绘图窗口</strong>中，我们想要快速创建数据集。然后我们需要一个<code class="fe mk ml mm mn b">class Designer</code>，我们将把它存储在<code class="fe mk ml mm mn b">designer.py</code>文件中。为了理解我们为什么需要这个类，让我们仔细看看配置文件中的一些参数:</strong></p><ul class=""><li id="af8f" class="mo mp it lk b ll mf lo mg lr mq lv mr lz ms md mt mu mv mw bi translated"><strong class="lk iu">输入</strong>:包含要绘制图像的尺寸和绘图铅笔的<strong class="lk iu">粗细</strong>(仅用于可视化)。</li><li id="fab8" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu">输出</strong>:包含输出图像的尺寸，以构成我们的数据集。</li><li id="0c37" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu">插值</strong> → <strong class="lk iu">方法</strong> (str或str列表):我们的绘图图像和我们的输出图像的尺寸不一样。所以我们需要一个<strong class="lk iu">插值</strong>方法来调整图像的大小。然后我们可以选择由<strong class="lk iu"> OpenCV </strong>提供的所有插值方法:<code class="fe mk ml mm mn b">INTER_NEAREST</code>、<code class="fe mk ml mm mn b">INTER_LINEAR</code>、<code class="fe mk ml mm mn b">INTER_AREA</code>、<code class="fe mk ml mm mn b">INTER_CUBIC</code>、<code class="fe mk ml mm mn b">INTER_LANCZOS4</code>。我们可以精确<code class="fe mk ml mm mn b">RANDOM</code>来改变每个图像的插值方法。该参数<strong class="lk iu">可以是一个列表</strong>:在这种情况下，指定的插值方法有多少个设计器，输入图像就有多少个输出图像。</li><li id="4e9f" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu">线条→粗细</strong>(浮动或浮动列表):输出图像上的铅笔粗细<strong class="lk iu">与图像对角线</strong>成比例。该参数<strong class="lk iu">可以是一个列表</strong>:在这种情况下，设计者的数量将和笔的粗细一样多。结果是一个<strong class="lk iu">设计矩阵</strong>结合了插值方法和指定厚度。</li><li id="9ee1" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu"> line → range_value </strong> (int或int的列表):像素在绘制时的亮度。在列表的情况下:所画像素的亮度将在指定范围内<strong class="lk iu">随机</strong>选择。</li><li id="76a0" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu">线条→渐变</strong>(浮点):线条的<strong class="lk iu">边缘</strong>的渐变值，渐变为线性。对数值<code class="fe mk ml mm mn b">fading=1</code>没有影响。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/e4bb2fcaf0ff366d60951ad3367d0f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*AtdEr-6-fMciD8IIQ-RLvg.gif"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="b82f" class="pw-post-body-paragraph li lj it lk b ll mf ju ln lo mg jx lq lr mh lt lu lv mi lx ly lz mj mb mc md im bi translated">注意绘图将由<strong class="lk iu">线条组合</strong>完成。因此有了<code class="fe mk ml mm mn b">draw(self, pt_1, pt2)</code>的角色。所以我们仍然需要用鼠标来控制这一切。</p><h1 id="75b1" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">控制器</h1><p id="06e4" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先我们需要创建一个<code class="fe mk ml mm mn b">class Controller</code>和<strong class="lk iu">从配置字典中初始化</strong>。</p><p id="1016" class="pw-post-body-paragraph li lj it lk b ll mf ju ln lo mg jx lq lr mh lt lu lv mi lx ly lz mj mb mc md im bi translated">在初始化期间，会发生几件事:</p><ul class=""><li id="daee" class="mo mp it lk b ll mf lo mg lr mq lv mr lz ms md mt mu mv mw bi translated"><strong class="lk iu">提取</strong>的所有配置参数。</li><li id="c2fb" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu">验证</strong>文件夹是否存在，如果不存在，创建它们。</li><li id="5fe1" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu">设计器</strong>的初始化。</li><li id="cfb1" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated">按已经完成的类别计算<strong class="lk iu">数量的图像</strong>。</li><li id="9e0d" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated">创建用于绘图的OpenCV <strong class="lk iu">窗口和用于可视化</strong>的OpenCV <strong class="lk iu">窗口。</strong></li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="1685" class="pw-post-body-paragraph li lj it lk b ll mf ju ln lo mg jx lq lr mh lt lu lv mi lx ly lz mj mb mc md im bi translated">为了创建我们所有的设计师，将有一个<strong class="lk iu">设计师矩阵</strong>，其中<strong class="lk iu">垂直</strong>用于铅笔粗细，而<strong class="lk iu">水平</strong>用于插值方法。同时我们可以创建一个函数来<strong class="lk iu">捕捉绘图窗口上的鼠标事件</strong>。只有按下鼠标左键<strong class="lk iu">才能绘图。最后，您可以检索已经绘制的图像数量。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h1 id="b45a" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">让我们画画吧</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/28874625aebb35410d32788dd9df52bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*EDIOtLm2LDcXjARso3aDJw.gif"/></div></figure><p id="7396" class="pw-post-body-paragraph li lj it lk b ll mf ju ln lo mg jx lq lr mh lt lu lv mi lx ly lz mj mb mc md im bi translated">在我们开始绘制之前，让我们来看看<code class="fe mk ml mm mn b">process</code>中我们最后的参数建议:</p><ul class=""><li id="3760" class="mo mp it lk b ll mf lo mg lr mq lv mr lz ms md mt mu mv mw bi translated"><strong class="lk iu"> volume </strong> (int):每个类要到达的图像数量。</li><li id="e5a7" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu">选择</strong> (str):选择下一个要绘制的字符的方式。可以是<code class="fe mk ml mm mn b">RANDOM</code>、<code class="fe mk ml mm mn b">CLASSBYCLASS</code>写完一个字再去写其他的，或者<code class="fe mk ml mm mn b">ROTATE </code>轮流换不同的类。</li><li id="7d07" class="mo mp it lk b ll mx lo my lr mz lv na lz nb md mt mu mv mw bi translated"><strong class="lk iu"> display_output </strong> (bool):显示或不显示输出窗口。</li></ul><p id="4a9c" class="pw-post-body-paragraph li lj it lk b ll mf ju ln lo mg jx lq lr mh lt lu lv mi lx ly lz mj mb mc md im bi translated">现在<strong class="lk iu">可以创建</strong>一个新的图像来绘制，<strong class="lk iu">绘制</strong>它，<strong class="lk iu">以正确的格式保存</strong>(<code class="fe mk ml mm mn b">root/(subfolderclass)/name_id.png</code>)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="cff9" class="pw-post-body-paragraph li lj it lk b ll mf ju ln lo mg jx lq lr mh lt lu lv mi lx ly lz mj mb mc md im bi translated">剩下的就是能够从OpenCV窗口中查看<strong class="lk iu">所有内容，并且只要没有达到每个类的图像量就运行程序。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h1 id="e54d" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">主要的</h1><p id="d371" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，为了更加方便，我们可以让用户选择使用shell中的命令来指定他的配置文件:</p><pre class="kj kk kl km gt nj mn nk nl aw nm bi"><span id="b836" class="nn kr it mn b gy no np l nq nr">python3 main.py -c path/to/the/config/file.json<br/>or <br/>python3 main.py -config path/to/the/config/file.json</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nc nd l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ns"><img src="../Images/a41213d2ce618721d92c099fba464fc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eGtKKRvZfNm6mIdQlVXisA.png"/></div></div></figure><blockquote class="nt nu nv"><p id="cd08" class="li lj nw lk b ll mf ju ln lo mg jx lq nx mh lt lu ny mi lx ly nz mj mb mc md im bi translated">知识就是分享。 <br/> <strong class="lk iu">支持</strong>我，一键获得<strong class="lk iu">访问<a class="ae me" href="https://axel-thevenot.medium.com/membership" rel="noopener"> <strong class="lk iu">中我所有文章的</strong>。</a></strong></p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nf ng di nh bf ni"><div class="gh gi ns"><img src="../Images/94e903d7d66ff043ca9645dbc42c33bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y7Q5U2MjIji7pvt6DRzq3A.png"/></div></div></figure><h1 id="fd6c" class="kq kr it bd ks kt ku kv kw kx ky kz la jz lb ka lc kc ld kd le kf lf kg lg lh bi translated">来源</h1><p id="1ac5" class="pw-post-body-paragraph li lj it lk b ll lm ju ln lo lp jx lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><a class="ae me" href="https://github.com/AxelThevenot/Python-Interface-to-Create-Handwritten-dataset/blob/master/README.md" rel="noopener ugc nofollow" target="_blank">项目的Github库</a></p><p id="c95d" class="pw-post-body-paragraph li lj it lk b ll mf ju ln lo mg jx lq lr mh lt lu lv mi lx ly lz mj mb mc md im bi translated">一切都是自制的，可以免费使用</p></div></div>    
</body>
</html>