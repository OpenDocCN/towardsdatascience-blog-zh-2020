<html>
<head>
<title>Merge Data Frames in Python &amp; R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Python &amp; R中合并数据框</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/merge-data-frames-in-python-r-725c0f874147?source=collection_archive---------35-----------------------#2020-05-20">https://towardsdatascience.com/merge-data-frames-in-python-r-725c0f874147?source=collection_archive---------35-----------------------#2020-05-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0b11" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">下面是一个简单的Python和r中数据帧合并的备忘单。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ab0cd30bad01e3a8db35947b2b3e8f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*K3nH_SY8Lsa_kZo3"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@mangofantasy?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">蒂姆·约翰逊</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="5292" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> M </span>生成数据框是数据处理人员的必备技能。然而，当从一种编码语言转换到另一种时，很难正确地记住命令。</p><p id="3fdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，我将为Python和R中的合并函数总结一个简单干净的备忘单，这类似于我以前的文章中的<a class="ae ky" rel="noopener" target="_blank" href="/extract-rows-columns-from-a-dataframe-in-python-r-678e5b6743d6">。此外，我将在合并多个数据框时对Python和R进行比较。</a></p><p id="cfab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，为了并排比较命令行，我将只使用<strong class="lb iu"> Python </strong>中的<strong class="lb iu"> Pandas </strong>和<strong class="lb iu"> R </strong>中的基本函数。有些综合库，比如<strong class="lb iu"> R </strong>中的<strong class="lb iu"> dplyr </strong>，就没有考虑。</p><p id="726a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你必须同时使用两种语言时，我希望这篇文章和备忘单对你有所帮助。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h2 id="33ab" class="ml mm it bd mn mo mp dn mq mr ms dp mt li mu mv mw lm mx my mz lq na nb nc nd bi translated">要使用的玩具数据集。</h2><p id="fd76" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">我们使用阿伦艾弗森和特雷西麦格雷迪的真实投篮命中率作为我们的玩具数据集。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/26e2dcb936617d8b982e0df08be08616.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qGF9LnnrDxrW3fWZyhau4g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">r输出1</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/bacba365f057228da1c2c3320bee8a24.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*wiwaMONXNJQgOoOeep-TrA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python输出1</p></figure><p id="1c16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到数据框中有三列，“季节”、“Pos”和“TS”，分别代表赛季指数，场上位置，真实投篮命中率。</p><h2 id="2f35" class="ml mm it bd mn mo mp dn mq mr ms dp mt li mu mv mw lm mx my mz lq na nb nc nd bi translated">四种类型的合并。</h2><p id="16a4" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">主要有四种类型的合并策略，包括基于用于合并的公共键(列)的内连接、外连接、左连接和右连接。</p><p id="629a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“内部连接”意味着只取两个数据框的键列中元素的交集。我们可以使用文氏图来表示“内部连接”,如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/d6c8bae5aa829efeba44600263ec3b4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKpyXNIQs-Re0o39MgiMXg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">内部连接图</p></figure><p id="486c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是R和Python的代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/6c715353d31f11e1fd652c463ee84531.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CMdiCzBEiK1t_Izaf4Ee9Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">r内部连接</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/e58be4bb24559e79aed60ea2495be1f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*yBKcIomN08Vkm6UJSOll4A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python内部连接</p></figure><p id="05b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上面的表格中我们可以看到，只显示了艾弗森和麦迪都打过的赛季。</p><p id="8b9b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来让我们看看“外部连接”策略。“外部连接”采用两个数据框的键列中的元素的联合。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/5f7e4cc40006e7760e49887c02953d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f96l87BO8C4cTd9XB0Y4qg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">外部连接图</p></figure><p id="3e9e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面列出了在R和Python中执行“外部连接”的代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/b85df4c9a2dac4722bdf72bbf80fa36d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YuPP_dSc36f6xHwy8k90wg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">r外部联接</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/6b424584090e0f10437c7050ffd78a76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*dqm9gklhueTeroF0TSsmbg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python外部连接</p></figure><p id="aa0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，两种语言都向原始数据帧中没有的关键元素填充了“NA”值。这张表显示了一个球员参加比赛而另一个球员没有参加的赛季。</p><p id="2f6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“左连接”只接受第一个表的键列中的元素，而不考虑第二个表的键列中的元素。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/67f22f78c7d49f48e8513cff2d6faaa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PVG-dsaH6hBa9MTmpUHNiQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">左连接图</p></figure><p id="88f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里列出了R和Python中“左连接”的代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/ef1eb8ffc613801005da50a077091159.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WOYEB3CbKyby8jjXZScnZA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">R中的左连接</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/d6525185c8cbfd4559a725988d950631.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*5JHOQcV6u8PAKYYB5891JQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python中的左连接</p></figure><p id="53ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“右连接”是“左连接”的反义词。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/68fc315f85c246473af25387e6b2ec5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fvcGyZ6hPKjjsi8KxSswsg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">右连接图</p></figure><p id="9f50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面列出了用Python和R进行“右连接”的代码。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/23cadbabd22d78f851781c8473fcbc8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F_e27cer4Wk6UcopOe_7oA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">右连接</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/23202595db09ef92ea50ab02a0f4965c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*XZzD_iOdStDCcYi0T5kkRA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python右连接</p></figure><p id="46f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这四种类型的合并构成了“合并”用法的主要部分。区分参数以选择R和Python中的合并策略很重要。R中使用的参数是“by.x”和“by.y”，而Python中的参数是“how”。注意，如果“by.x”和“by.y”在R中需要相同的赋值，我们可以使用单个参数“by”来代替。</p><h2 id="bd47" class="ml mm it bd mn mo mp dn mq mr ms dp mt li mu mv mw lm mx my mz lq na nb nc nd bi translated">合并多列上的两个数据框。</h2><p id="f7ef" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">有时，我们需要合并基于多个列的两个数据框。我们唯一需要做的事情是将列名列表传递给相应的参数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/c9c931bdb9fc73793be871935dd2eafe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IDjkM44bvPDRgi-5QD7qiQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">R中的多列合并</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/3b3bfd2fb6dedda4f39b73bb927bac4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*7Czr4SRZe1S4KLqJAu2JZw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Python中合并多个列</p></figure><p id="0461" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的例子中，我们感兴趣的是当两个球员在同一个赛季(“赛季”)中在相同的位置(“Pos”)比赛时，球员的统计数据比较。</p><h2 id="20d7" class="ml mm it bd mn mo mp dn mq mr ms dp mt li mu mv mw lm mx my mz lq na nb nc nd bi translated">合并多个数据框。</h2><p id="442c" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">在另一种情况下，我们对合并两个以上的数据帧感兴趣。我们绝对可以写一个很长的命令来逐个合并它们，但是更好的方法可以是“<strong class="lb iu"><em class="nw"/></strong>”函数。</p><p id="a9bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们有另一个关于科比真实投篮命中率的数据框架，我们想把它与艾弗森和麦迪的数据框架合并在一起。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/1a40aeee56d91a1b1c37686f8220fc6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4MhwKhDaU94qwCrWQzAFdA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">合并R中的多个数据帧</p></figure><p id="edce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里在R的“<strong class="lb iu"> <em class="nw"> Reduce </em> </strong>函数中，我们需要定义一个合并两个数据帧的函数并将其作为第一个参数，然后传递一列数据帧作为“<strong class="lb iu"><em class="nw"/></strong>”函数的第二个参数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/0b75711ce186dbc9ce8467f7584e1863.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L6YY9aOiTzpW6o6PbBl10w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Python中合并多个数据框</p></figure><p id="3fac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里在Python的“<strong class="lb iu"> <em class="nw"> reduce </em> </strong>函数中，与r中的非常相似，我们需要定义一个通过<em class="nw"> lambda </em>合并两个数据帧的函数。而且我们还需要将一列数据帧传递给“<strong class="lb iu"><em class="nw"/></strong>”函数。</p><h2 id="8e52" class="ml mm it bd mn mo mp dn mq mr ms dp mt li mu mv mw lm mx my mz lq na nb nc nd bi translated">用R和Python合并数据框的备忘单。</h2><p id="e060" class="pw-post-body-paragraph kz la it lb b lc ne ju le lf nf jx lh li ng lk ll lm nh lo lp lq ni ls lt lu im bi translated">下面是在R和Python中合并数据框的简单备忘单。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/ec3f857dacd6db43ba94b46f25d9198c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*arN6bVnso6i93VHQDNvxMQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">裕丰小抄</p></figure></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><p id="b6fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！希望这篇帖子能对你有所帮助。</p><p id="e6d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读！如果喜欢文章，请<a class="ae ky" href="https://medium.com/@jianan.jay.lin" rel="noopener"> <strong class="lb iu">关注我上媒</strong> </a>。以下是我之前在<strong class="lb iu">数据科学</strong>发表的一些文章:</p><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/consider-multicollinearity-in-my-model-or-not-7aca16e74773"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">是否在我的模型中考虑多重共线性？</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">简要讨论是否有必要修复特征空间中的多重共线性。我希望它会…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="on l oo op oq om or ks od"/></div></div></a></div><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/end-to-end-project-of-game-prediction-based-on-lebrons-stats-using-three-machine-learning-models-38c20f49af5f"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">使用三种机器学习模型基于勒布朗数据的端到端游戏预测方案</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">综合指导一个二元分类问题使用三个不同的分类器，包括逻辑…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="os l oo op oq om or ks od"/></div></div></a></div><div class="oa ob gp gr oc od"><a rel="noopener follow" target="_blank" href="/hands-on-guidance-of-data-visualization-in-r-package-ggplot2-of-nba-players-stats-d812ed272d66"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">NBA球员统计数据R包“ggplot2”中数据可视化的实践指导</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">应用于NBA数据的R数据可视化工具“ggplot2”的6分钟之旅。</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">towardsdatascience.com</p></div></div><div class="om l"><div class="ot l oo op oq om or ks od"/></div></div></a></div></div></div>    
</body>
</html>