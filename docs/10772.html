<html>
<head>
<title>Designing a 3D Healthcare Network Graph</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设计 3D 医疗保健网络图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/designing-a-3d-healthcare-network-graph-291e4f75e9a5?source=collection_archive---------62-----------------------#2020-07-27">https://towardsdatascience.com/designing-a-3d-healthcare-network-graph-291e4f75e9a5?source=collection_archive---------62-----------------------#2020-07-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b657" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 TigerGraph、Python 和 JavaScript 对医疗保健数据建模的一种很酷的方式</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e2a7d2c688126bf5110bd832c7594d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jGxDTw8LYH0XbbIrGc0sug.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">三维力导向网络图</p></figure><h1 id="55ce" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">介绍</h1><p id="f6cc" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">正如我们所知，图形数据库已经彻底改变了世界。在过去的十年里，他们已经在大量的案例中证明了他们的有用性，从社交媒体网络到欺诈检测再到推荐引擎。图形数据库的真正优势是能够有效地表示信息片段之间的关系<strong class="ls iu"> </strong>。这尤其适用于高度关联的数据，如医院记录。</p><p id="e0ad" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">在这篇博客中，我将介绍一个例子，说明我们如何将存储在图形数据库中的医疗保健数据以 3D 形式直观地展示出来。由于大量的连接，2D 网络图可能很快变得混乱和不可读；然而，这些问题可以通过改变我们的视角来解决。在 2D 选项失败的情况下，3D 图形提供了更容易看到的数据的扩展视图。</p><p id="629d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">因为数据存储在图形数据库中，所以用图形可视化才有意义。这样，我们所要做的就是将数据库中已经存在的连接转换成可见的东西。</p><p id="264a" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">有了这样的背景，让我们开始制作我们的 3D 图形杰作吧！</p><p id="72ac" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><em class="mr">这个博客的完整代码可以在我的</em> <a class="ae ms" href="https://github.com/akash-kaul/3d-network-graph-visualization" rel="noopener ugc nofollow" target="_blank"> <em class="mr"> Github </em> </a> <em class="mr">上找到。</em></p><h1 id="0673" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">设计图形数据库模式</h1><p id="d022" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我在这个项目中使用的图形数据库是建立在 TigerGraph 的基础上的，使用的是由一个叫做 Synthea 的整洁的开源程序生成的合成病人数据。如果你对 Synthea 不熟悉，可以看看我写的这个<a class="ae ms" rel="noopener" target="_blank" href="/generating-synthetic-patient-data-b7901c3bd397?source=friends_link&amp;sk=439d87db6fb28671063d1a29fad8262e">短博客</a>或者看看<a class="ae ms" href="https://synthetichealth.github.io/synthea/" rel="noopener ugc nofollow" target="_blank">他们的网站</a>。</p><p id="da7e" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls iu">如果你有兴趣看看我用来设计这个医疗网络的过程，可以看看我的</strong> <a class="ae ms" rel="noopener" target="_blank" href="/modeling-healthcare-data-with-graph-databases-3e3695bcae3c"> <strong class="ls iu">上一篇博文</strong> </a> <strong class="ls iu">。</strong></p><p id="d4c9" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">否则，请随意设计您自己的图表或使用预制的图表。TigerGraph 有大量的教程和例子可以帮助你设计自己的图形。或者，你可以参考我写的一篇<a class="ae ms" rel="noopener" target="_blank" href="/linking-documents-in-a-semantic-graph-732ab511a01e?source=friends_link&amp;sk=61ea0c500afbfe8babddf4d1c4e4c80f">文章</a>，这篇文章将带你了解一般的图形设计过程。</p><p id="0a3d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">从这一点开始，我提到的一切都可以用任何图形来完成。</p><h1 id="8f44" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">访问图表</h1><p id="326d" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">为了访问我们的图表，我们将使用由 Parker Erickson 创建的<a class="ae ms" href="https://parkererickson.github.io/pyTigerGraph/" rel="noopener ugc nofollow" target="_blank"> pyTigerGraph </a> Python 连接器。安装并导入软件包后，您可以使用以下代码连接到您的图形服务器:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">连接到 TigerGraph</p></figure><p id="0536" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">如果您没有令牌，您可以创建一个带有密码的令牌。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="e995" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">接下来，运行一个已安装的查询来从图表中获取数据。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">运行 GSQL 查询</p></figure><p id="3e93" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">以下是查询。它会抓取所有患者以及与这些患者直接相关的所有边和顶点。</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="2f0a" class="nc kz it my b gy nd ne l nf ng">CREATE QUERY grab_All_3d_demo() FOR GRAPH MyGraph { <br/>  <br/> ListAccum&lt;EDGE&gt; @@edgeList;<br/> <br/> Seed = {Patient.*};</span><span id="2a54" class="nc kz it my b gy nh ne l nf ng"> data = SELECT s FROM Seed:s -(ANY:e)-ANY:t ACCUM @@edgeList +=e;<br/> other = SELECT t FROM Seed:s -(ANY:e)-ANY:t;<br/> <br/> print data;<br/> print other;<br/> print @@edgeList;<br/>}</span></pre><h1 id="9db0" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">格式化数据</h1><p id="4529" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">当我们运行查询时，它会返回大量信息。我们可以尝试绘制所有进来的数据(本质上是绘制这些患者的大多数医疗保健接触点)，但我们的图表最终会看起来非常混乱。因此，我们将只获取数据的一部分。</p><p id="6174" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我选择了这些病人，他们的地址，以及他们一生中的任何过敏反应或影像学研究。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">解析传入数据</p></figure><p id="8d12" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这段代码可能有些混乱，所以让我们仔细分析一下到底是怎么回事。</p><ol class=""><li id="9f4a" class="ni nj it ls b lt mm lw mn lz nk md nl mh nm ml nn no np nq bi translated">首先，提取与 GSQL 查询中的 3 个 print 语句相对应的 3 个列表。</li><li id="15ac" class="ni nj it ls b lt nr lw ns lz nt md nu mh nv ml nn no np nq bi translated">接下来，创建两个名为<em class="mr">节点</em>和<em class="mr">链接</em>的列表。这些将包含我们的三维图形的顶点和边。</li><li id="efd1" class="ni nj it ls b lt nr lw ns lz nt md nu mh nv ml nn no np nq bi translated">现在，抓取代表患者、地址、过敏或成像研究的所有节点。对于每个节点，我们添加三个属性:<em class="mr"> id </em>、<em class="mr">描述</em>和<em class="mr">组</em>。<em class="mr"> id </em>是图形用来建立连接的标识符。<em class="mr">描述</em>是当鼠标悬停在节点上时出现的文本，而<em class="mr">组</em>用于给节点着色。</li><li id="f4c2" class="ni nj it ls b lt nr lw ns lz nt md nu mh nv ml nn no np nq bi translated">对于每个环节，我们也有三个属性:<em class="mr">源</em>、<em class="mr">目标</em>、<em class="mr">组</em>。<em class="mr">组</em>属性再次对应于着色。<em class="mr">源</em>和<em class="mr">目标</em>属性对应于该边的源和目标顶点的 id。</li><li id="5e10" class="ni nj it ls b lt nr lw ns lz nt md nu mh nv ml nn no np nq bi translated">最后，将这两个列表添加到 JSON 格式的字典中。这一步非常关键，因为我们的 JavaScript 函数无法识别其他格式的数据。</li></ol><p id="278b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这样，数据现在就可以使用了！</p><h1 id="e25c" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">用 Flask 传递数据</h1><p id="c1f5" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">为了让我们的 JavaScript 函数实时接收来自 Python 的图形数据，我们需要设置一个服务器。我们将使用<a class="ae ms" href="https://flask.palletsprojects.com/en/1.1.x/" rel="noopener ugc nofollow" target="_blank">烧瓶</a>来完成。我们所要做的就是将我们已经创建的函数包装在 Flask web 服务器结构中。完整的 Python 代码现在看起来应该是这样的:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最终 python 代码</p></figure><p id="83a6" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这个项目的 python 部分现在已经完成了！</p><h1 id="5896" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">创建图表</h1><p id="08b0" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这个可视化的核心是<a class="ae ms" href="https://github.com/vasturiano/3d-force-graph" rel="noopener ugc nofollow" target="_blank"> 3D 力图</a>包。这个包建立在 ThreeJS 和 WebGL 之上，使得生成力定向图变得非常简单。</p><p id="7438" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">像大多数 web 应用程序一样，这个网络图可视化是使用 HTML、JavaScript 和 CSS 构建的。让我们分别看一下这些组件。</p><h2 id="87ab" class="nc kz it bd la nw nx dn le ny nz dp li lz oa ob lk md oc od lm mh oe of lo og bi translated">超文本标记语言</h2><p id="b252" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这个项目的 HTML 非常简单。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">网站的 HTML</p></figure><p id="4519" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls iu">关键部件:</strong></p><p id="4cbe" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">—三维力图包</p><p id="c60e" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">— CSS 样式表</p><p id="bcb8" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">— JavaScript 代码(<em class="mr">dataset-loader . js</em>)</p><h2 id="36dd" class="nc kz it bd la nw nx dn le ny nz dp li lz oa ob lk md oc od lm mh oe of lo og bi translated">半铸钢ˌ钢性铸铁(Cast Semi-Steel)</h2><p id="f021" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这里没什么特别的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">网站的 CSS 文件</p></figure><h2 id="d6ac" class="nc kz it bd la nw nx dn le ny nz dp li lz oa ob lk md oc od lm mh oe of lo og bi translated">Java Script 语言</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mv mw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">生成图表的 JavaScript 代码</p></figure><p id="b8cf" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">让我们再次将这段代码分解成更小的步骤。</p><ol class=""><li id="8cfd" class="ni nj it ls b lt mm lw mn lz nk md nl mh nm ml nn no np nq bi translated">使用<em class="mr"> fetch </em>语句从我们的 Flask 服务器获取数据</li><li id="982e" class="ni nj it ls b lt nr lw ns lz nt md nu mh nv ml nn no np nq bi translated">使用 3D-Force-Graph 软件包生成我们的图形</li><li id="90d1" class="ni nj it ls b lt nr lw ns lz nt md nu mh nv ml nn no np nq bi translated">指定图形属性(即按组着色，将悬停数据设置为“描述”)</li><li id="c8f3" class="ni nj it ls b lt nr lw ns lz nt md nu mh nv ml nn no np nq bi translated">创建一个循环，使图形旋转。为什么？因为旋转图太牛逼了！</li></ol><h2 id="29ed" class="nc kz it bd la nw nx dn le ny nz dp li lz oa ob lk md oc od lm mh oe of lo og bi translated">CORS 问题</h2><p id="fd41" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">如果您试图按原样运行这段代码，很可能会遇到 CORS 错误。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/2f108d4e47e416a8df8f5eee586773d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1114/format:webp/1*loLRaCVPQYSpkXs2Y4jc9Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">CORS 误差</p></figure><p id="0dcc" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">你可以在这里阅读关于 CORS 问题的文章。要解决这个问题，您需要指定允许数据流动的响应头。我用谷歌浏览器的<a class="ae ms" href="https://chrome.google.com/webstore/detail/moesif-orign-cors-changer/digfbfaphojjndkpccljibejjbppifbc?hl=en-US" rel="noopener ugc nofollow" target="_blank"> Moesif Origin 和 CORS 转换器</a>扩展解决了这个问题。如果您在本地运行该程序，这将非常有用。然而，如果您想要部署该图，您将需要在<a class="ae ms" href="https://flask-cors.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Flask </a>和<a class="ae ms" href="https://javascript.info/fetch-crossorigin" rel="noopener ugc nofollow" target="_blank"> JavaScript </a>上配置适当的设置。</p><h1 id="00ea" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">有趣的东西</h1><p id="f5d4" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">这是所有的代码。现在，我们剩下要做的就是运行服务器，欣赏它的辉煌。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/3f81210c9113935a5378c69e4d6034c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*smljtMW5XEY1Aor4n681lQ.gif"/></div></figure><h1 id="3379" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">结论</h1><p id="b15d" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">通过不多的代码，我们收集了存储在图形数据库中的大量数据，并创建了一个令人惊叹的 3D 可视化来显示这些数据。我们使用 TigerGraph 来存储医疗保健信息，使用 Python 来提取和处理我们的数据，使用 JavaScript 和 HTML 来创建 3D 视图。这个过程并不复杂，但会产生非常酷的结果。这篇博客中展示的方法也可以用在医疗行业之外。任何处理高度关联数据的领域都可以从图形中受益，利用图形数据库存储信息的能力和 3D 网络图显示信息的能力。</p><p id="df93" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我希望你喜欢阅读这个博客，并学到一些新的东西！让我知道你的想法，并在 LinkedIn 上与我联系。</p></div><div class="ab cl oj ok hx ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="im in io ip iq"><div class="kj kk kl km gt oq"><a href="https://www.linkedin.com/in/akash-kaul-6a8063194/" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd iu gy z fp ov fr fs ow fu fw is bi translated">阿卡什·考尔-数据科学实习生-未来学家学院| LinkedIn</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">查看阿卡什·考尔在全球最大的职业社区 LinkedIn 上的个人资料。阿卡什有 5 个工作列在他们的…</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">www.linkedin.com</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe ks oq"/></div></div></a></div><div class="pf pg gp gr ph oq"><a href="https://github.com/akash-kaul/3d-network-graph-visualization.git" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd iu gy z fp ov fr fs ow fu fw is bi translated">akash-kaul/3d 网络图可视化</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">在 GitHub 上创建一个帐户，为 akash-kaul/3d 网络图可视化开发做出贡献。</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">github.com</p></div></div><div class="oz l"><div class="pi l pb pc pd oz pe ks oq"/></div></div></a></div></div></div>    
</body>
</html>