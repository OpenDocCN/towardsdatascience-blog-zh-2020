<html>
<head>
<title>Fast Visual Neural Network Design with PrototypeML.com</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于 PrototypeML.com 的快速视觉神经网络设计</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fast-visual-neural-network-design-with-prototypeml-com-ed83ef4f6f64?source=collection_archive---------52-----------------------#2020-07-12">https://towardsdatascience.com/fast-visual-neural-network-design-with-prototypeml-com-ed83ef4f6f64?source=collection_archive---------52-----------------------#2020-07-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0d29" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">新的直观和强大的视觉神经网络设计平台，允许快速模型原型。</h2></div><p id="1363" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">神经网络体系结构通常是从概念上设计并以视觉术语描述的，但通过编写容易出错的代码来实现。PrototypeML.com 是一个新的(目前在 alpha 中)开放神经网络开发环境，允许您(a)通过直观的可视化拖放和代码编辑界面快速原型化/设计任何神经网络架构,( b)基于社区驱动的网络构建块库进行构建，以及(c)导出完全可读的 PyTorch 代码用于培训。在<a class="ae lb" href="https://prototypeml.com" rel="noopener ugc nofollow" target="_blank">PrototypeML.com</a>尝试一下。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/2b6d8d36f2a82c8af13bca708fb11bdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*zykE_nObQowISWtBBFw82A.gif"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated"><em class="ls">作者图片。</em></p></figure><h1 id="001e" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">PrototypeML 如何工作</h1><p id="75cd" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">PyTorch 在研究界越来越受欢迎，它以概念简单、动态图形支持、模块化和面向未来的设计而闻名。PrototypeML 与 PyTorch 框架紧密耦合，支持普通 PyTorch 模型中可用的全部动态功能和任意代码执行。我们通过几个基本构件来实现这一点。</p><h2 id="d498" class="mq lu iq bd lv mr ms dn lz mt mu dp md ko mv mw mf ks mx my mh kw mz na mj nb bi translated">将神经网络表示为语法树代码图</h2><p id="1f85" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">首先，我们利用 PyTorch“作为常规 Python 程序的深度学习模型”设计范式，以静态语法树代码图的形式表示神经网络模型，而不是预定义的神经组件图。</p><h2 id="be34" class="mq lu iq bd lv mr ms dn lz mt mu dp md ko mv mw mf ks mx my mh kw mz na mj nb bi translated">变异体</h2><p id="845f" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">其次，我们引入了“变异体”的概念。mutator 组件封装了普通 PyTorch 或任意 Python 代码的片段，并定义了一种标准化的格式，通过这种格式可以表示数据输入和输出以及参数。</p><p id="7fe6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">PyTorch 模型使用<a class="ae lb" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html" rel="noopener ugc nofollow" target="_blank">nn 表示。模块 </a>类范例，其中带有参数的神经网络层在<a class="ae lb" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html" rel="noopener ugc nofollow" target="_blank"> <em class="nc"> nn 中被实例化。模块</em> </a>类<em class="nc"> init() </em>函数，并在网络正向传递期间调用<a class="ae lb" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html" rel="noopener ugc nofollow" target="_blank"> <em class="nc"> nn。模块</em> </a>类<em class="nc"> forward() </em>函数。Mutators 通过将执行<em class="nc"> init() </em>函数中的代码实例化和相应的<em class="nc"> forward() </em>执行代码所需的代码封装到单个组件中来构建这个模式，该组件包含运行代码所需的一切，而不管它将在哪里使用。</p><p id="0af7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">赋值函数定义了以下字段:</p><ol class=""><li id="c413" class="nd ne iq kh b ki kj kl km ko nf ks ng kw nh la ni nj nk nl bi translated">必需的导入(如标准 PyTorch 库，或任何第三方 PyTorch 库或 Python 代码库)。如果 mutator 需要安装一个包，请在 Python 包部分中指定</li><li id="8289" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">在<em class="nc"> forward() </em>阶段流入和流出 mutator 的数据流是通过端口定义的</li><li id="adec" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">在<em class="nc"> init() </em>中初始化代码所需的参数在<em class="nc"/><em class="nc"/>参数部分中定义</li><li id="d9cb" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">在<em class="nc"> nn 中初始化组件的代码。模块 init() </em>函数</li><li id="0ab9" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">执行<em class="nc"> nn 内组件的代码。模块转发()</em>功能</li><li id="2a19" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">任何需要的附加功能</li></ol><p id="6beb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Mutators 实现了各种神奇的变量，允许通过代码中的可视化界面访问设置，具体来说:</p><ul class=""><li id="8998" class="nd ne iq kh b ki kj kl km ko nf ks ng kw nh la nr nj nk nl bi translated"><em class="nc"> ${instance} | </em>可用于<em class="nc"> init() </em>和<em class="nc">forward()</em>|用于表示当前实例名(为了允许多次使用同一个赋值函数，init 中的变量名应该包括这个神奇的变量)</li><li id="9652" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la nr nj nk nl bi translated"><em class="nc">$ {港口。&lt;名称&gt; } </em> |仅在<em class="nc"> forward() </em>中可用|用于表示输入或输出端口变量。&lt;名称&gt;应替换为您在可视界面中选择的名称</li><li id="5fb4" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la nr nj nk nl bi translated"><em class="nc"> ${params} </em> |仅在<em class="nc"> init() </em>中可用|为<em class="nc"> init() </em>函数实例化生成逗号分隔的输入参数列表的快捷方式(例如，<em class="nc"> ${params} </em>可能会变成 spam="eggs ")</li><li id="ed47" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la nr nj nk nl bi translated"><em class="nc"> ${params。&lt; name &gt; } </em> |仅在<em class="nc"> init() </em>中可用|用于表示参数的内容(${params.spam}可能会变成“eggs”)</li></ul><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi ns"><img src="../Images/44aa3d91c363e935642c18d392714b46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-_ZVXhlc0-faxeMFDJyZFg.jpeg"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">ReLU Mutator 示例。<em class="ls">图片作者。</em></p></figure><h2 id="7d55" class="mq lu iq bd lv mr ms dn lz mt mu dp md ko mv mw mf ks mx my mh kw mz na mj nb bi translated">阻碍</h2><p id="69de" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">第三，我们实现“块”容器来封装子节点之间的关系。一个块组件代表一个<a class="ae lb" href="https://pytorch.org/docs/master/generated/torch.nn.Module.html" rel="noopener ugc nofollow" target="_blank">nn。模块 </a> <em class="nc"> </em>类，并用一个可视化图形表示。通过从库栏拖放，可以将变异子和其他块作为节点添加到图形中，并且在各个节点之间绘制的边代表神经网络模型的数据流。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nt"><img src="../Images/1e7a69582746986a92d6563463349aae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5VgLEDvC68bGTR8D1diPNw.png"/></div></div><p class="lo lp gj gh gi lq lr bd b be z dk translated">演示跳过连接的 ResNet 瓶颈层。<em class="ls">作者图片。</em></p></figure><h2 id="7c29" class="mq lu iq bd lv mr ms dn lz mt mu dp md ko mv mw mf ks mx my mh kw mz na mj nb bi translated">代码生成</h2><p id="640d" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">为了生成代码(可通过界面中的小下载按钮或块编辑器中的查看代码按钮访问)，遍历块图，将 mutator 和块<em class="nc"> init() </em>和<em class="nc"> forward() </em>代码段组合到它们各自的函数中，并解析各个组件之间的输入和输出依赖关系和参数。只需一次点击，您就可以下载您的模型的编译代码，包括所有依赖项、conda/pip 环境/需求文件等。</p><h1 id="5594" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">构建 MNIST 分类器</h1><p id="8c62" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">随着本质细节的方式，让我们看看所有这些如何帮助我们更快地原型神经网络！我们将构建一个基本的 MNIST 分类器，因为这几乎是神经网络的“Hello World ”(不过不要担心，生成一个类似的网络来处理 CIFAR-10，甚至 ImageNet 也一样容易！).下面详细介绍的项目可以在 https://prototypeml.com/prototypeml/mnist-classifier 的<a class="ae lb" href="https://prototypeml.com/prototypeml/mnist-classifier" rel="noopener ugc nofollow" target="_blank">找到。继续前进，分叉它(在你创建了一个帐户之后)，这样你就可以跟着走了。</a></p><ol class=""><li id="e9b4" class="nd ne iq kh b ki kj kl km ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae lb" href="https://prototypeml.com/login" rel="noopener ugc nofollow" target="_blank">签到</a> /R <a class="ae lb" href="https://prototypeml.com/register" rel="noopener ugc nofollow" target="_blank">注册</a>和<a class="ae lb" href="https://prototypeml.com/prototypeml/mnist-classifier" rel="noopener ugc nofollow" target="_blank">叉</a>MNIST 选粉机项目。</li><li id="ad45" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">在项目页面上，单击右上角的 Edit Model 按钮。这将把您带到模型编辑器界面。在你的左手边是库栏，在那里你所有的组件被管理。中间是你编写变异函数和构建模块的地方。右侧是编辑 mutator、block 和 component 实例属性的位置。</li><li id="1362" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">首先，从包存储库中添加已经构建(并自动生成)的 PyTorch 库。在库栏中，点击“添加”按钮，选择“添加包依赖”。接下来，选择 PyTorch(它应该在顶部附近)，然后单击“使用”按钮。这将把这个包作为一个依赖项添加到您的项目中(添加任何其他依赖项的过程也是一样的！).现在，您应该在库栏中看到一个包目录。如果您导航到 Packages 目录，并单击 PyTorch，您将找到整个 PyTorch 神经网络函数库。</li><li id="94bd" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">返回到您的根目录(单击“添加”按钮下面的面包屑中的“/”)，并通过“添加”按钮添加一个块(您可以随意命名)。点击块打开它，你会看到块编辑界面。如果再次导航到 Packages/PyTorch 目录，现在可以将其中一个子文件夹中的任何可用组件拖到项目中。</li><li id="2424" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">继续并开始构建您的模型:将组件从库栏拖到块编辑器中，并开始通过将边从输出端口拖到输入端口来连接它们(端口是组件实例顶部/底部的圆)。单击组件实例以查看和设置特定于该组件的参数。如果你想得到一些帮助来弄清楚要拖动什么，请随意查看示例项目。</li><li id="569e" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">在块编辑器中的任何时候，点击块编辑器工具栏中的&gt;按钮，查看将要生成的代码——探索当您拖动组件并将它们连接在一起时，代码是如何变化的。请注意，当两条边进入单个输入端口时，代码将自动包含一个连接操作(对此进行配置，或通过单击输入端口将其更改为替代的组合函数)。</li><li id="3918" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">编辑完模型后，单击库栏中“添加”按钮旁边的下载代码按钮，您就可以开始培训了。</li></ol><h1 id="36c4" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">使用外部库&amp;设计变异函数</h1><p id="6d6e" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">到目前为止，我们一直使用 PyTorch 库中包含的 mutator，但是如果您发现您需要某个组件，而这个组件的 mutator 还没有在包存储库中编写(或者您想在您的网络中包含完全自定义的代码)，那么您将需要自己设计。我们将构建一个 mutator，包装<a class="ae lb" href="https://github.com/lukemelas/EfficientNet-PyTorch" rel="noopener ugc nofollow" target="_blank"> EfficientNet 库</a>的 PyTorch 实现。</p><ol class=""><li id="909c" class="nd ne iq kh b ki kj kl km ko nf ks ng kw nh la ni nj nk nl bi translated">首先，通过单击“add”按钮添加一个 mutator。</li><li id="e8d4" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">在编辑器右侧的属性栏中，通过单击 parameters 旁边的“+”按钮，添加这个 mutator 所需的两个参数(模型名称和输出类的数量)。</li><li id="79c2" class="nd ne iq kh b ki nm kl nn ko no ks np kw nq la ni nj nk nl bi translated">我们需要在<em class="nc"> Imports </em>部分导入库，如下所示:</li></ol><pre class="ld le lf lg gt nu nv nw nx aw ny bi"><span id="f2ed" class="mq lu iq nv b gy nz oa l ob oc">from efficientnet_pytorch import EfficientNet</span></pre><p id="3451" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.接下来，让我们在<em class="nc"> Init </em>部分编写初始化 EfficientNet 模型所需的代码，就像这样。注意我们如何使用神奇变量<em class="nc"> ${instance} </em>而不是变量名称，并使用<em class="nc"> ${params 填充参数。&lt;名称&gt; } </em>语法:</p><pre class="ld le lf lg gt nu nv nw nx aw ny bi"><span id="ece6" class="mq lu iq nv b gy nz oa l ob oc">self.${instance} = EfficientNet.from_pretrained(${params.model}, num_classes=${params.num_classes})</span></pre><p id="23b5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">5.最后，编写调用<em class="nc"> Forward </em>部分中的 EfficientNet 模型所需的代码，就像这样(同样，注意我们是如何使用神奇变量<em class="nc"> ${ports。&lt;名称&gt; } </em>引用输入/输出变量，<em class="nc"> ${instance} </em>同上):</p><pre class="ld le lf lg gt nu nv nw nx aw ny bi"><span id="5b89" class="mq lu iq nv b gy nz oa l ob oc">${ports.output} = self.${instance}(${ports.input})</span></pre><p id="7952" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">6.我们完事了。当拖动到一个块中时(配置设置为:name='efficientnet '，model='efficientnet-b0 '，num_classes=10)，这个 mutator 将产生以下代码(假设块的其余部分为空):</p><pre class="ld le lf lg gt nu nv nw nx aw ny bi"><span id="090c" class="mq lu iq nv b gy nz oa l ob oc">import torch<br/>from efficientnet_pytorch import EfficientNet</span><span id="e220" class="mq lu iq nv b gy od oa l ob oc">class EfficientNet_Classifier(torch.nn.Module):<br/>    def __init__(self):<br/>        super(EfficientNet_Classifier, self).__init__() <br/>        <br/>        self.efficientnet = EfficientNet.from_pretrained('efficientnet-b0', num_classes=10)</span><span id="1523" class="mq lu iq nv b gy od oa l ob oc">def forward(self, input):<br/>        efficientnet_output = self.efficientnet(input)<br/>        <br/>        return efficientnet_output</span></pre><p id="72e7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完整的 MNIST 的例子可以在 https://prototypeml.com/prototypeml/mnist-classifier 找到。</p><h1 id="81fa" class="lt lu iq bd lv lw lx ly lz ma mb mc md jw me jx mf jz mg ka mh kc mi kd mj mk bi translated">结论</h1><p id="2e45" class="pw-post-body-paragraph kf kg iq kh b ki ml jr kk kl mm ju kn ko mn kq kr ks mo ku kv kw mp ky kz la ij bi translated">PrototypeML 实现了一个强大而直观的接口和组件标准，允许快速原型化强大的神经网络架构和实验。我们希望听到您对平台的想法和反馈，并期待在不久的将来从 alpha 升级到 beta。你可以在 https://PrototypeML.com<a class="ae lb" href="https://PrototypeML.com," rel="noopener ugc nofollow" target="_blank">访问平台，在这里</a><a class="ae lb" href="https://arxiv.org/abs/2007.01097" rel="noopener ugc nofollow" target="_blank">访问预印本</a>，在 https://Docs.PrototypeML.com<a class="ae lb" href="https://docs.prototypeml.com," rel="noopener ugc nofollow" target="_blank"/>访问文档，在 https://discord.gg/zq8uqSf<a class="ae lb" href="https://discord.gg/zq8uqSf" rel="noopener ugc nofollow" target="_blank"/>访问我们的 Discord 社区频道。</p></div></div>    
</body>
</html>