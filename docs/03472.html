<html>
<head>
<title>Python SQLite Tutorial — The Ultimate Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python SQLite 教程-终极指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-sqlite-tutorial-the-ultimate-guide-fdcb8d7a4f30?source=collection_archive---------11-----------------------#2020-04-02">https://towardsdatascience.com/python-sqlite-tutorial-the-ultimate-guide-fdcb8d7a4f30?source=collection_archive---------11-----------------------#2020-04-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="38ac" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">入门所需的一切！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9be9c1064f140c924113bc9c7fc299ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xoLXyDVdjAk-oMOV1eDsbw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让我们了解一下开始使用 Python 中的 SQLite3 所需要的一切！资料来源:Nik Piepenbreier</p></figure><p id="ca69" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">SQL 和 Python 已经迅速成为任何从事严肃数据分析的人的必备技能！本 Python SQLite 教程是您在 Python 中使用 SQLite 的唯一指南。在本帖中，我们将介绍:</p><ul class=""><li id="2db9" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">正在加载库</li><li id="ca4d" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">创建并连接到您的数据库</li><li id="da07" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">创建数据库表</li><li id="4f6e" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">添加数据</li><li id="74c6" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">查询数据</li><li id="f48d" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">删除数据</li><li id="f852" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">还有更多！</li></ul><p id="f5d7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">SQLite3(我们称之为 SQLite)是标准 Python 3 包的一部分，所以您不需要安装任何东西。如果你没有运行 Python 3，请点击<a class="ae mi" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">链接</a>开始。</p><p id="db53" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想开始学习 SQL，可以看看我的完整的<a class="ae mi" href="https://datagy.io/sql-beginners-tutorial/" rel="noopener ugc nofollow" target="_blank">初级 SQL 教程</a>，其中包括免费下载的 PDF 和其他赠品。</p><h1 id="90e3" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">你会创造什么</h1><p id="9e54" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">学习完本教程后，您将使用 Python 在 SQLite 中创建了一个数据库。具体来说，这篇文章将指导您完成创建数据库的所有步骤，该数据库涵盖了下表，包括所有关系:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/6c42fccdf0726e5de59acb5003006d05.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/0*R5Bg2LXQQ0fJ3yLS.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们将创建的数据库的概述。资料来源:Nik Piepenbreier</p></figure><h1 id="a01b" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">SQLite for Python 中可用的数据类型</h1><p id="3899" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">SQLite for Python 提供的数据类型比其他 SQL 实现少。这可能有点限制。然而，正如您将看到的，SQLite 使许多其他事情变得更容易。让我们快速看一下可用的数据类型:</p><ul class=""><li id="13f1" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><strong class="la iu">空值</strong> —包括一个空值</li><li id="2ecb" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><strong class="la iu">整数</strong> —包括一个整数</li><li id="a637" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><strong class="la iu">实数</strong> —包括一个浮点(十进制)值</li><li id="29b1" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><strong class="la iu">正文</strong>。—包括文本</li><li id="5036" class="lu lv it la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><strong class="la iu">斑点</strong>。—包括完全作为输入存储的二进制大对象</li></ul><p id="fbc7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从这个列表中，您可能会注意到一些缺失的数据类型，如日期。不幸的是，在使用 SQLite 时，您只能使用这些数据类型。</p><h1 id="c981" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">Python 中的 SQLite 入门</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/357d64555efb1cd14b9bc25582a52c3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7gprG7QmWFqZ536x.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">准备好了吗？我们开始吧！资料来源:Nik Piepenbreier</p></figure><p id="fd98" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们从加载库开始本教程。我们可以通过使用以下命令来实现这一点:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="3710" class="nn mk it nj b gy no np l nq nr">import sqlite3</span></pre><p id="49d6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们开始实际创建我们的数据库。</p><h1 id="06aa" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">用 Python 创建 SQLite 数据库</h1><p id="df1d" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">在 Python SQLite 教程的这一部分，我们将探索使用 SQLite 在 Python 中创建数据库的不同方法。为此，我们将创建一个代表数据库的<strong class="la iu"> <em class="ns">连接</em> </strong>对象。这个对象是使用 SQLite 的 connect()函数创建的。</p><p id="88b7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们首先创建一个. db 文件，因为这是实际维护 SQLite 数据库的一种非常标准的方式。我们将使用名为<em class="ns"> conn </em>的变量来表示连接。我们将创建一个名为<em class="ns"> orders.db </em>的文件。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="b333" class="nn mk it nj b gy no np l nq nr">conn = sqlite3.connect('orders.db')</span></pre><p id="c37d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过这行代码，我们创建了一个新的<em class="ns">连接</em>对象，以及一个名为<em class="ns"> orders.db </em>的新文件，该文件位于您正在工作的目录中。如果您想指定一个特定的目录，您可以写:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="394b" class="nn mk it nj b gy no np l nq nr">conn = sqlite3.connect(r'PATH-TO-YOUR-DIRECTORY/orders.db')</span></pre><p id="4747" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果文件已经存在，那么<em class="ns">连接</em>功能将简单地连接到该文件。</p><p id="6f9f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">注意</strong>:注意我们在包含这个路径的字符串前包含了字母“r”。这让 Python 知道我们正在处理一个原始字符串，这意味着“/”不会用于转义字符。你可以通过<a class="ae mi" href="https://docs.python.org/3/reference/lexical_analysis.html" rel="noopener ugc nofollow" target="_blank">查看此链接</a>了解更多关于原始字符串的信息。</p><p id="3018" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="ns"> connect </em>函数创建一个到 SQLite 数据库的连接，并返回一个对象来表示它。</p><h1 id="6713" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">内存数据库</h1><p id="69e4" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">使用 Python 中的 SQLite 生成数据库的另一种方法是在内存中创建数据库<em class="ns">。这是生成可用于测试目的的数据库的好方法，因为它们只存在于 RAM 中。</em></p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="1965" class="nn mk it nj b gy no np l nq nr">conn = sqlite3.connect(:memory:)</span></pre><p id="45aa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，出于本教程的目的，对于您将遇到的大多数用例，您将使用我们前面描述的方法。</p><h1 id="5b16" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">创建光标对象</h1><p id="30b1" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">现在我们已经创建了一个数据库连接对象，我们的下一个任务是创建一个<strong class="la iu"> <em class="ns">光标</em> </strong>对象。简单地说，游标对象允许我们对数据库执行 SQL 查询。我们将创建一个变量<em class="ns"> cur </em>来保存光标对象:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="9a3b" class="nn mk it nj b gy no np l nq nr">cur = conn.cursor()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/f7d5595afb2258b0fd1a7053ca3b8236.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6KpT8RnQWIeXnr4s.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">游标对于 Python 中的 SQLite3 至关重要。资料来源:Nik Piepenbreier</p></figure><p id="59e3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们有了一个 cursor 对象，我们可以使用它以下面的方式运行 SQL 查询:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="ff8f" class="nn mk it nj b gy no np l nq nr">cur.execute("YOUR-SQL-QUERY-HERE;")</span></pre><p id="576d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，我们用引号将 SQL 查询括起来，这很重要。不管我们使用单引号、双引号还是三引号。对于较长的查询，通常最好使用三重引号，因为它们允许我们编写多行查询。</p><h1 id="1e2b" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">在 SQLite for Python 中创建我们的表</h1><p id="7941" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">在 Python SQLite 教程的这一点上，让我们使用 Python 中的 SQLite 创建我们的第一个表！现在我们有了一个连接对象(<em class="ns"> conn </em>)和一个光标对象(<em class="ns"> cur </em>)，我们可以创建我们的第一个表了。按照我们之前展示的数据库模式:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/0de9d9d4a4d04de72a968f192d40700b.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/0*vIXnRb9jjuWZ-VB3.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">快速提醒一下我们的数据库是什么样子的。资料来源:Nik Piepenbreier</p></figure><p id="efeb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将从用户表开始。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="58c7" class="nn mk it nj b gy no np l nq nr">cur.execute("""CREATE TABLE IF NOT EXISTS users(<br/>   userid INT PRIMARY KEY,<br/>   fname TEXT,<br/>   lname TEXT,<br/>   gender TEXT);<br/>""")<br/>conn.commit()</span></pre><p id="5a63" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上面的代码中，我们做了很多事情:</p><ol class=""><li id="3eb9" class="lu lv it la b lb lc le lf lh lw ll lx lp ly lt nt ma mb mc bi translated">使用游标对象上的 execute 函数执行 SQL 查询</li><li id="8821" class="lu lv it la b lb md le me lh mf ll mg lp mh lt nt ma mb mc bi translated">使用 SQL 生成一个名为<em class="ns">用户</em>的表</li><li id="8d02" class="lu lv it la b lb md le me lh mf ll mg lp mh lt nt ma mb mc bi translated">如果不存在，那么<em class="ns">将在重新连接到数据库时帮助我们。该查询将允许我们检查该表是否存在，如果存在，则没有任何改变。</em></li><li id="ce38" class="lu lv it la b lb md le me lh mf ll mg lp mh lt nt ma mb mc bi translated">我们创建四列:<em class="ns">用户 id </em>、<em class="ns">名字</em>、<em class="ns">名字</em>和<em class="ns">性别</em>。<em class="ns">用户标识</em>被指定为主键。</li><li id="4bdb" class="lu lv it la b lb md le me lh mf ll mg lp mh lt nt ma mb mc bi translated">我们通过在连接对象上使用<em class="ns">提交</em>函数来提交更改。</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/e3b12f55c2320fd84598426261b693cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rl0rBi-wzjg2QXJJ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">准备好桌子了吗？资料来源:Nik Piepenbreier</p></figure><p id="9d4e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要创建我们的另一个表，我们可以遵循类似的模式并编写以下命令:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="74f3" class="nn mk it nj b gy no np l nq nr">cur.execute("""CREATE TABLE IF NOT EXISTS orders(<br/>   orderid INT PRIMARY KEY,<br/>   date TEXT,<br/>   userid TEXT,<br/>   total TEXT);<br/>""")<br/>conn.commit()</span></pre><p id="0eca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">执行这两个脚本后，您的数据库将有两个表。我们现在准备开始添加数据！</p><h1 id="5f81" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">在 Python 中使用 SQLite 添加数据</h1><p id="8b23" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">让我们看看如何用 Python 中的 SQLite 向我们刚刚创建的数据库添加数据。与表生成查询类似，添加数据的查询使用 cursor 对象来执行查询。</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="0b36" class="nn mk it nj b gy no np l nq nr">cur.execute("""INSERT INTO users(userid, fname, lname, gender) <br/>   VALUES('00001', 'Nik', 'Piepenbreier', 'male');""")</span><span id="8143" class="nn mk it nj b gy nu np l nq nr">conn.commit()</span></pre><p id="c7bc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通常，当我们在 Python 中工作时，我们会有保存值的变量。例如，我们可能有一个包含用户信息的元组，可能如下所示:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="dd19" class="nn mk it nj b gy no np l nq nr">user = ('00002', 'Lois', 'Lane', 'Female')</span></pre><p id="86df" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们想将这些数据加载到数据库中，我们将使用不同的约定:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="1602" class="nn mk it nj b gy no np l nq nr">cur.execute("INSERT INTO users VALUES(?, ?, ?, ?);", user)<br/>conn.commit()</span></pre><p id="d300" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们在这里做的是用问号替换所有的值，并添加一个包含我们希望添加的值的附加参数。</p><p id="89dc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里需要注意的是，SQLite 期望值是元组格式的。但是，变量可以包含列表，只要列表项是元组。例如，我们可以使用变量添加更多用户:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="70a9" class="nn mk it nj b gy no np l nq nr">more_users = [('00003', 'Peter', 'Parker', 'Male'), ('00004', 'Bruce', 'Wayne', 'male')]</span></pre><p id="0189" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这种情况下，我们不想使用 execute 函数，而是希望使用 executemany 函数:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="6ac0" class="nn mk it nj b gy no np l nq nr">cur.executemany("INSERT INTO users VALUES(?, ?, ?, ?);", more_users)</span><span id="e8e4" class="nn mk it nj b gy nu np l nq nr">conn.commit()</span></pre><p id="9f89" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们在 cursor 对象上使用了 execute 函数，该函数会假设我们将两个条目(两个元组)直接传入表中，而不是两组，每组四个条目！幸运的是，在这种情况下，这个函数可能会失败，但是要小心使用哪个函数！</p><h1 id="bfd8" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">SQLite 和防止注入攻击</h1><p id="097d" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">顺便说一下，使用(？, ?，…)我们上面提到的方法也有助于抵御 SQL 注入攻击。因此，建议使用这种方法，而不是前面提到的方法。也更容易打出来，所以是双赢！</p><h1 id="29f6" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">一些加载更多数据的脚本</h1><p id="382f" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">如果您正在学习 Python SQLite 教程，让我们加载更多的数据，使下面的部分更有意义。下面是一些脚本，您可以复制并粘贴这些脚本，将一些示例数据插入到这两个表中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nv nw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">如果您正在跟进，也加载这些数据文件！资料来源:Nik Piepenbreier</p></figure><p id="2783" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以使用以下查询来加载此数据:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="1301" class="nn mk it nj b gy no np l nq nr">cur.executemany("INSERT INTO users VALUES(?, ?, ?, ?);", customers)<br/>cur.executemany("INSERT INTO orders VALUES(?, ?, ?, ?);", orders)<br/>conn.commit()</span></pre><h1 id="dcb5" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">使用 Python 在 SQLite 中选择数据</h1><p id="2e1a" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">接下来，在这个 Python SQLite 教程中，我们将看看如何在 Python 中使用 SQLite 选择数据！我们将遵循与上面执行查询类似的结构，但是我们也将向其中添加另一个元素。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/6dd0fa322cc51f2408bef0bbf04bf490.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8XQCElcCRy-VmyXl.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">有许多方法可以返回数据。资料来源:Nik Piepenbreier</p></figure><h1 id="db82" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">通过 Python 在 SQLite 中使用 fetchone()</h1><p id="a52d" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">让我们从使用 fetchone()函数开始。我们创建了一个变量<em class="ns"> one_result </em>来只提取结果</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="06f9" class="nn mk it nj b gy no np l nq nr">cur.execute("SELECT * FROM users;")<br/>one_result = cur.fetchone()<br/>print(one_result)</span></pre><p id="3c6a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将返回:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="eb9f" class="nn mk it nj b gy no np l nq nr">[(1, 'Nik', 'Piepenbreier', 'male')]</span></pre><h1 id="7314" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">通过 Python 在 SQLite 中使用 fetchmany()</h1><p id="70de" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">假设我们想要返回不止一个结果，我们可以使用 fetchmany()函数。让我们运行一个不同的脚本来生成 3 个结果:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="c4bf" class="nn mk it nj b gy no np l nq nr">cur.execute("SELECT * FROM users;")<br/>three_results = cur.fetchmany(3)<br/>print(three_results)</span></pre><p id="8be8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将返回以下内容:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="2452" class="nn mk it nj b gy no np l nq nr">[(1, 'Nik', 'Piepenbreier', 'male'), (2, 'Lois', 'Lane', 'Female'), (3, 'Peter', 'Parker', 'Male')]</span></pre><h1 id="bf27" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">通过 Python 在 SQLite 中使用 fetchall()</h1><p id="8a3e" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">类似地，我们可以使用 fetchall()函数返回所有结果。如果我们运行以下命令，将返回所有结果:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="d84d" class="nn mk it nj b gy no np l nq nr">cur.execute("SELECT * FROM users;")<br/>all_results = cur.fetchall()<br/>print(all_results)</span></pre><h1 id="ccb8" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">用 Python 删除 SQLite 中的数据</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/1430d202aecdd769a7faa546283cde64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*t4_21NuMczv6-FqF.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让我们也学习一下如何删除数据！资料来源:Nik Piepenbreier</p></figure><p id="4aa3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们来看看如何在 Python 中使用 SQLite 删除数据。我们可以使用与上面类似的结构来实现这一点。假设我们想要删除姓“Parker”的任何用户，我们可以写:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="b1a9" class="nn mk it nj b gy no np l nq nr">cur.execute("DELETE FROM users WHERE lname='Parker';")<br/>conn.commit()</span></pre><p id="6066" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们运行下面的查询时:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="684b" class="nn mk it nj b gy no np l nq nr">cur.execute("select * from users where lname='Parker'")<br/>print(cur.fetchall())</span></pre><p id="7d51" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将打印出一个空列表，确认记录已被删除。</p><h1 id="7b28" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">在 Python 中用 SQLite 连接表</h1><p id="60b9" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">最后，让我们看看如何用更复杂的查询连接数据。假设我们想要生成一个查询，其中包含每个订单上每个客户的名字和姓氏。</p><p id="1b2e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了实现这一点，我们编写以下代码:</p><pre class="kj kk kl km gt ni nj nk nl aw nm bi"><span id="028a" class="nn mk it nj b gy no np l nq nr">cur.execute("""SELECT *, users.fname, users.lname FROM orders<br/>    LEFT JOIN users ON users.userid=orders.userid;""")<br/>print(cur.fetchall())</span></pre><p id="0ea5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">类似地，您可以应用一些其他的 SQL 技巧。关于 SQL 的完整介绍，<a class="ae mi" href="https://datagy.io/sql-beginners-tutorial/" rel="noopener ugc nofollow" target="_blank">点击这里查看我的完整初学者指南</a>。</p><h1 id="652d" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">结论:Python SQLite 教程</h1><p id="c527" class="pw-post-body-paragraph ky kz it la b lb nb ju ld le nc jx lg lh nd lj lk ll ne ln lo lp nf lr ls lt im bi translated">在这篇 Python SQLite 教程中，我们探索了开始使用 Python 中的 SQLite 所需要知道的一切。我们从如何加载库开始，探索了如何创建数据库和表，如何添加数据，如何查询表，以及如何删除数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/8b1daec7679b448542043192cb524b06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FN3qvwDnkujdIHts.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">非常感谢您抽出时间！你真的真的很棒！资料来源:Nik Piepenbreier</p></figure></div></div>    
</body>
</html>