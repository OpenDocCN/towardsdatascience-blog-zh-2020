<html>
<head>
<title>Quantum MNIST</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">量子 MNIST</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/quantum-mnist-f2c765bdd478?source=collection_archive---------30-----------------------#2020-09-16">https://towardsdatascience.com/quantum-mnist-f2c765bdd478?source=collection_archive---------30-----------------------#2020-09-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/0baca2e5d724a3bf228fc3545070176a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f-WEUrJr5qpbe5dpUBZvig.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者在<a class="ae jg" href="https://quantum-computing.ibm.com/" rel="noopener ugc nofollow" target="_blank"> IBM Q 体验</a>中生成的图像。</p></figure><div class=""/><h1 id="6922" class="kg kh jj bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">用量子计算模拟器对手写数字进行分类</h1><p id="c7c0" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我最近发表了一篇名为“<a class="ae jg" href="https://link.medium.com/6NlSXhLFI9" rel="noopener"> 130，780 点量子分类</a>的文章，讨论了一个基本上使用 20 个数据量子位来表示整个数据集的电路。它实际上只重置和重新使用了 5 个模拟数据量子位，但它这样做了 4 次，因此需要 20 个数据量子位才能在真实的量子处理器上运行特定的电路。令我惊讶的是，两个 Twitter 用户对我如何编码数据集完全不感兴趣。</p><p id="59b8" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">所以，我继续研究数据集，然后写了一篇名为<a class="ae jg" href="https://link.medium.com/qhSSSX2iA9" rel="noopener">“经典数据的超密集编码</a>”的文章那一次，我讨论了一个不可用的两量子位版本的电路，但也讨论了一个可用的四量子位版本的电路。令我惊讶的是，同样的 Twitter 用户仍然不为所动。</p><p id="f7e8" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">当有人评论说数据集的大小与高度使用的 MNIST 数据集相比微不足道时，后者仍然相对较小，我决定 MNIST 数据集将是增加复杂性的下一个逻辑婴儿步骤。</p><h2 id="3414" class="mh kh jj bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">介绍</h2><p id="5265" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">MNIST 数据集是图像的集合。每张图片显示一个从 0 到 9 的一位数手写数字。一个经过训练的机器学习模型有望获得一组测试图像，并根据图像显示的数量正确地对每张图像进行分类。</p><p id="3218" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">MNIST 数据集是众所周知的，并且经过了良好的测试，所以如果你开始学习经典的机器学习，几乎可以保证你会使用它。</p><h2 id="c148" class="mh kh jj bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">CSV 数据</h2><p id="d338" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我承认跳过了与 MNIST 合作的一个重要步骤，部分原因是代码已经可以在互联网上找到，部分原因是我致力于将 OpenQASM 专门用于这个项目。我没有先将图像转换成数值，而是下载了一个已经确定了数值的 CSV 文件。请注意我在本文末尾的致谢。</p><p id="4032" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">虽然 CSV 文件不包含所有的 MNIST 训练和测试数据，但它包含了足够的数据来执行这个分类实验。无论所用数据集的大小如何，算法都将保持不变。我们可以推测一个更大的数据集如何影响结果的准确性，但是任何这样的差异都可能被运行这个实验所需的维度减少量所抵消。</p><h2 id="b3ff" class="mh kh jj bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">算法</h2><p id="29f5" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">大部分工作实际上是经典的预处理。我给自己设定了一个挑战——完全不使用 Python 外加在智能手机上准备和运行这个实验的额外挑战。如果您尝试使用 Python 来复制这个实验，我承认这应该容易得多。</p><ol class=""><li id="c89a" class="mt mu jj lg b lh mc ll md lp mv lt mw lx mx mb my mz na nb bi translated">对于 10 个类别(0 到 9)中的每一个，通过将每列的平均值除以 255 来计算每个像素的归一化平均值；通常这个计算稍微复杂一点，但是最小值是 0，所以我们可以删除 2 个减去 0 的实例</li><li id="90e7" class="mt mu jj lg b lh nc ll nd lp ne lt nf lx ng mb my mz na nb bi translated">对于 10 个类别中的每一个，以卷积神经网络(CNN)启发的模式对归一化均值求和；我选择了一个 49 像素的 4x4 网格</li><li id="9309" class="mt mu jj lg b lh nc ll nd lp ne lt nf lx ng mb my mz na nb bi translated">将 160 个总和(16 个正方形 x 10 个类)除以 49，使其标准化</li><li id="02e2" class="mt mu jj lg b lh nc ll nd lp ne lt nf lx ng mb my mz na nb bi translated">重新排列对角线模式中的值；仅出于编码目的，这将把我想要映射到每个量子位的向量彼此相邻，这样我就不必做太多的剪切和粘贴</li></ol><p id="677c" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">最后一步是在量子位上混合数字的不同区域。这个想法是为了避免，例如，水平地映射量子位，用八个量子位中的四个来代表 0、3 和 8 的类似弯曲的顶部和底部。</p><h2 id="a391" class="mh kh jj bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">CNN 启发</h2><p id="3a8d" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">卷积神经网络(CNN)扫描图像的特征，如眼睛、鼻子和嘴巴的形状，以识别可能的人脸。我没有按行、列甚至对角线来浏览 MNIST 数据集，而是选择了一种受 CNN 启发的方块模式，希望这有助于辨别每个数字的不同特征。</p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/d07a16aa81b137fd4fc741300d6c0b99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*2aNjGAWLznJdt8QYx-CLgw.jpeg"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者创建的图像。</p></figure><p id="fe49" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">字母表示数据集中数值数据的列。</p><p id="f72f" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">顺便说一下，这在 Python 中会容易得多。虽然我能够自动化其中的一部分，但我自己造成的 Python 限制导致这个实验的这一部分需要相当多的手动干预。</p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/dc8ecf70c6b38efe79aa64b4eb64ba2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*rwY22WUhp9WsKWXZNimFPg.jpeg"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者创建的图像。</p></figure><p id="347d" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">基于之前给出的原因，新添加的颜色表明了这些块是如何映射到量子位的。例如，两个黄色块被映射到数据量子位 0，在电路上显示为 data[0]。</p><h2 id="bd85" class="mh kh jj bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">测试零点</h2><p id="ced1" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在创建完整的电路之前，由于在智能手机上编写 OpenQASM 已经具有挑战性，我测试了一个零的图像和零的数据量子位。零测试电路在本文的最顶端。</p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/a19a1d53c22110ea309879f2aca22cf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*Db_Iyx8KCBL9AD-Fbh25QA.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者在<a class="ae jg" href="https://quantum-computing.ibm.com/" rel="noopener ugc nofollow" target="_blank"> IBM Q 体验</a>中生成的图像。</p></figure><p id="7171" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">结果表明，零有合理的概率被归类为零。然而，考虑到前面提到的 3 和 8 的相似性，我不能假设 92.261%会是与其他数字相比的最高结果，特别是。就此而言，由于所需的降维量，我无法假设所有的数字不会模糊在一起并测量相同的值。</p><h2 id="87ee" class="mh kh jj bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">完整的电路</h2><p id="9a0d" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">使用 OpenQASM 子例程编写代码会容易得多，但他们过去收到过负面反馈，因为他们的电路只是显示出难以描述的块。相反，在下面，你可以看到许多 U3 门，弗雷德金门，复位门，加上一点点的哈达玛门和 x 测量。</p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi no"><img src="../Images/fa52d0e097c9f30d7f27b9649fc96f37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xxbSw3onDrH872QKF4CMoA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者在<a class="ae jg" href="https://quantum-computing.ibm.com/" rel="noopener ugc nofollow" target="_blank"> IBM Q Experienc </a> e 中生成的图像。</p></figure><p id="687e" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">要放大，只需查看本文最上方的零测试电路。这里唯一增加的是屏障，使电路看起来更好，重置门，所以我可以重复使用 17 个量子位。IBM Q 量子计算模拟器只允许使用最多 32 个量子位，随着更多量子位的添加，运行时明显变慢，因此您可以通过重置和重用更少的量子位来提高性能。</p><h2 id="c6f2" class="mh kh jj bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">结果</h2><p id="890e" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">下面的直方图是将之前使用的相同图像 0 与所有 10 个数字 0 到 9 进行比较的结果。</p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/ba4dacfc93dd3c68b176ebea4f36f5ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*yHrGKicsdocNAM4nWi720g.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者在<a class="ae jg" href="https://quantum-computing.ibm.com/" rel="noopener ugc nofollow" target="_blank"> IBM Q 体验</a>中生成的图像。</p></figure><p id="e190" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">直方图中只显示了顶部的结果，因此需要进行一些经典的后处理。</p><ul class=""><li id="d220" class="mt mu jj lg b lh mc ll md lp mv lt mw lx mx mb np mz na nb bi">0–92.517%</li><li id="9404" class="mt mu jj lg b lh nc ll nd lp ne lt nf lx ng mb np mz na nb bi">1–91.15%</li><li id="bf41" class="mt mu jj lg b lh nc ll nd lp ne lt nf lx ng mb np mz na nb bi">2–84.619%</li><li id="d663" class="mt mu jj lg b lh nc ll nd lp ne lt nf lx ng mb np mz na nb bi">3–84.741%</li><li id="b9dc" class="mt mu jj lg b lh nc ll nd lp ne lt nf lx ng mb np mz na nb bi">4–90.625%</li><li id="f0c9" class="mt mu jj lg b lh nc ll nd lp ne lt nf lx ng mb np mz na nb bi">5–90.491%</li><li id="566e" class="mt mu jj lg b lh nc ll nd lp ne lt nf lx ng mb np mz na nb bi">6–81.128%</li><li id="86df" class="mt mu jj lg b lh nc ll nd lp ne lt nf lx ng mb np mz na nb bi">7–86.633%</li><li id="bb2a" class="mt mu jj lg b lh nc ll nd lp ne lt nf lx ng mb np mz na nb bi">8–89.783%</li><li id="26ae" class="mt mu jj lg b lh nc ll nd lp ne lt nf lx ng mb np mz na nb bi">9–90.027%</li></ul><p id="ee63" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">即使进行这个实验需要所有的维数减少，零的测试图像与零的数据最接近。顺便说一下，这条完整线路的运行时间是 4 分 45 秒。</p><h2 id="2a39" class="mh kh jj bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">结论</h2><p id="e19c" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这个实验表明，使用量子计算模拟器对手写数字的图像进行准确分类实际上是可能的。虽然这种电路不能在 NISQ 处理器上运行——由于量子位连接和电路深度问题，即使你有足够的量子位来一次一位地进行比较——但这一结果有望在未来的量子处理器上得到实际应用。</p><h2 id="3106" class="mh kh jj bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">未来的工作</h2><p id="a452" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果我有 15，690 个容错量子位，我会喜欢运行这种算法的逐像素版本。在那之前，我只能等待这个实验的反馈，以确定接下来会有什么样的挑战。</p><p id="7c34" class="pw-post-body-paragraph le lf jj lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这种算法在发表前面临的一个挑战是，在量子处理器上运行这种算法相对于传统的运行算法是否有任何实际优势。由于它甚至不能在量子处理器上运行，我们将看到这个论点走向何方。</p><h2 id="56ed" class="mh kh jj bd ki mi mj dn km mk ml dp kq lp mm mn ku lt mo mp ky lx mq mr lc ms bi translated">承认</h2><p id="d62b" class="pw-post-body-paragraph le lf jj lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">一如既往，感谢<a class="ae jg" href="https://quantum-computing.ibm.com/" rel="noopener ugc nofollow" target="_blank"> IBM Q Experience </a>免费使用其量子计算模拟器，该模拟器生成了本文中的电路和直方图图像。感谢<a class="ae jg" href="https://www.youtube.com/channel/UC-2knDbf4kzT3uzWo7iTJyw" rel="noopener ugc nofollow" target="_blank">量子直觉</a> ( <a class="ae jg" href="https://twitter.com/explore_quantum?s=09" rel="noopener ugc nofollow" target="_blank"> @explore_quantum </a>)启发我尝试用 MNIST 数据集做量子分类。感谢<a class="ae jg" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank">http://yann.lecun.com/exdb/mnist/</a>为机器学习社区提供了 MNIST 数据集这样的资源。还要特别感谢<a class="ae jg" href="https://www.kaggle.com/oddrationale/mnist-in-csv#" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/oddrationale/mnist-in-csv#</a>分享 CSV 格式的 MNIST 测试数据集。</p></div></div>    
</body>
</html>