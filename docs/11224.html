<html>
<head>
<title>Add Animated Charts To Your Dashboards With Streamlit-Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Streamlit-Python 向您的仪表盘添加动画图表</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/add-animated-charts-to-your-dashboards-with-streamlit-python-f41863f1ef7c?source=collection_archive---------17-----------------------#2020-08-04">https://towardsdatascience.com/add-animated-charts-to-your-dashboards-with-streamlit-python-f41863f1ef7c?source=collection_archive---------17-----------------------#2020-08-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4669" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用 ATP 网球排名数据对比网球四大</h2></div></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="e8e3" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">介绍</h1><p id="80ca" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">有段时间一直想试用<a class="ae md" href="https://www.streamlit.io/" rel="noopener ugc nofollow" target="_blank"><em class="me"/></a>。所以上周末，我花了一些时间修补它。如果您以前从未听说过这个工具，它提供了一种非常友好的方式来使用 Python 为您的数据科学和机器学习项目创建自定义的交互式数据 web 应用程序。您可以与用户交互以获得输入并显示动态图表、表格、地图等。他们的<a class="ae md" href="https://www.streamlit.io/gallery" rel="noopener ugc nofollow" target="_blank"> <em class="me">官方画廊</em> </a>可能是一个好的开始。它将让您了解使用 Streamlit 可以实现什么。您还会发现一长串来自 Streamlit 社区的推文，它们以自己独特的方式利用该工具进行创作。一定要看看它们，寻找一些灵感。可以使用 pip install 命令(<em class="me"> pip install Streamlit </em>)下载 streamlit。</p><p id="f95d" class="pw-post-body-paragraph lh li it lj b lk mf ju lm ln mg jx lp lq mh ls lt lu mi lw lx ly mj ma mb mc im bi translated">在本文中，我分享了一个使用 Streamlit 构建的动画条形图示例。虽然，实现这一点的一些信息是零零碎碎的，但我无法在一个地方找到太多关于动画图表的信息。我希望这将有助于那些希望在他们的 Streamlit 仪表板中添加动画图表的人。</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="e06d" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">数据集</h1><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/ed3df4599a730eb5db9a93bd06856da4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hVLPauiVjoWGJUCC"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">由<a class="ae md" href="https://unsplash.com/@carlo_bazzo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Carlo Bazzo </a>在<a class="ae md" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="dfc4" class="pw-post-body-paragraph lh li it lj b lk mf ju lm ln mg jx lp lq mh ls lt lu mi lw lx ly mj ma mb mc im bi translated">稍微说一下数据吧。网球是我最喜欢的运动，我决定围绕它做点什么(也因为我真的真的很想念温布尔登💔).总之，在网上搜索了一段时间后，我偶然发现了一些我认为可以使用的东西。直到 2017 年，费德勒、纳达尔、诺瓦克·德约科维奇和安迪·穆雷都被亲切地称为四巨头。在他们之间，他们从 2004 年到 2017 年统治了这项运动。</p><p id="0e73" class="pw-post-body-paragraph lh li it lj b lk mf ju lm ln mg jx lp lq mh ls lt lu mi lw lx ly mj ma mb mc im bi translated">数据集包含每周 ATP 排名数据，其中包含球员姓名、排名点数、球员排名和排名日期等信息。在 streamlit 中，您还可以以表格形式查看数据帧。在一些基本的格式化之后，我最终的数据框架如下所示。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi na"><img src="../Images/4837c91f43119fb09ea62aa11fbcafbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bCV2rg1MjHGkoBc7u9NDzw.jpeg"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">处理过的数据帧:由<a class="nb nc ep" href="https://medium.com/u/c5b77fc1811c?source=post_page-----f41863f1ef7c--------------------------------" rel="noopener" target="_blank">阿林多姆·巴塔查尔吉</a></p></figure></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="b915" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">图表会显示什么？</h1><p id="ca0d" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我想制作一个动画条形图，展示近 20 年来四大银行之间的排名。为了制作动画，我在循环的<em class="me">中经过一定的时间延迟后，不断替换图表中的每周数据。这给了它一个生动的外观和感觉。</em></p><p id="007f" class="pw-post-body-paragraph lh li it lj b lk mf ju lm ln mg jx lp lq mh ls lt lu mi lw lx ly mj ma mb mc im bi translated">出于可视化的目的，最初我从优秀的旧 M <a class="ae md" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> atplotlib </a>库开始，但我遇到了一些问题，决定继续使用<a class="ae md" href="https://altair-viz.github.io/getting_started/overview.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lj iu"> <em class="me"> Altair </em> </strong> </a>，这是另一个可以与 python 一起使用的可视化库。根据我的经验，我发现在我的数据应用程序中使用它比 Matplotlib 有更好的外观和感觉。Streamlit 支持这两个库以及其他一些库。</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="411f" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">用户界面</h1><p id="f9ce" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">对于 UI，我决定让用户能够自己选择年的范围，并在他们选择的时间段运行动画。选择时间范围后，一旦他们按下按钮'<em class="me">提示图表</em>，动画就会开始。我使用了'<strong class="lj iu"> <em class="me">范围滑块</em></strong>'&amp;'<strong class="lj iu">'<em class="me">按钮</em> </strong>'功能来执行此操作。</p><p id="ea57" class="pw-post-body-paragraph lh li it lj b lk mf ju lm ln mg jx lp lq mh ls lt lu mi lw lx ly mj ma mb mc im bi translated"><strong class="lj iu">范围滑块</strong>:范围滑块的作用是选择一系列数字。它可以用这一行代码创建。该函数返回一个包含用户选择的值的元组。</p><pre class="ml mm mn mo gt nd ne nf ng aw nh bi"><span id="4d73" class="ni kq it ne b gy nj nk l nl nm">x = st.slider('Select the year range',1996, 2017, (1996, 2017))</span><span id="55c6" class="ni kq it ne b gy nn nk l nl nm"># 'Select the year range' -&gt; Text to display<br/># 1996 -&gt; The lower bound<br/># 2017 -&gt; The higher bound<br/># (1996, 2017) -&gt; Default selected range</span></pre><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi no"><img src="../Images/811125296714a3efc4710d58d7eb8679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zfr-ezBjCz0uPcZJj12twQ.jpeg"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">由 Arindom Bhattacharjee 制作的滑块图像<a class="nb nc ep" href="https://medium.com/u/c5b77fc1811c?source=post_page-----f41863f1ef7c--------------------------------" rel="noopener" target="_blank"/></p></figure><p id="ada4" class="pw-post-body-paragraph lh li it lj b lk mf ju lm ln mg jx lp lq mh ls lt lu mi lw lx ly mj ma mb mc im bi translated"><strong class="lj iu">按钮</strong>:我加了一个按钮，因为我不想让动画在用户选择时间范围后自行启动。可以创建如下所示的按钮。我运行这个'<em class="me"> if </em>'语句中的动画代码。当用户执行一个点击事件时，函数返回一个布尔值 true。</p><pre class="ml mm mn mo gt nd ne nf ng aw nh bi"><span id="99e5" class="ni kq it ne b gy nj nk l nl nm">if(st.button('Cue Chart')):<br/>    #run the animation. Value is 'True' when user clicks on it.</span></pre><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi np"><img src="../Images/c508147b1475d8f6f9a042a267ecfa43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CDLqhoFZ3XbqD14wbuulTw.jpeg"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">按钮图像作者:<a class="nb nc ep" href="https://medium.com/u/c5b77fc1811c?source=post_page-----f41863f1ef7c--------------------------------" rel="noopener" target="_blank"> Arindom Bhattacharjee </a></p></figure></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="47e9" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">图表动画</h1><p id="714d" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我使用 Altair python 库来创建条形图。我创建了一个函数(<em class="me">plot _ bar _ animated _ Altair</em>)，它接受两个输入——四大玩家的周数据和周名称。然后它会绘制一个条形图。我最终格式化的数据框架如下所示，将用于绘制图表。streamlit 函数<strong class="lj iu"><em class="me">ST . dataframe(df)</em></strong>以如下方式显示 data frame 对象。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi na"><img src="../Images/4837c91f43119fb09ea62aa11fbcafbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bCV2rg1MjHGkoBc7u9NDzw.jpeg"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">示例数据:Arindom Bhattacharjee </p></figure><pre class="ml mm mn mo gt nd ne nf ng aw nh bi"><span id="9507" class="ni kq it ne b gy nj nk l nl nm">import streamlit as st<br/>import pandas as pd<br/>import time<br/>import altair as alt<br/>from altair import Chart, X, Y, Axis, SortField, OpacityValue</span><span id="9da0" class="ni kq it ne b gy nn nk l nl nm">#---------------------------------------------------------------#<br/># Creating an empty chart in the beginning when the page loads<br/>#---------------------------------------------------------------#<br/>bars = alt.Chart(data).mark_bar().encode(<br/>    x=X('1:Q',axis=Axis(title='ATP Ranking Points'),<br/>    y=Y('0:Q',axis=Axis(title='The Big Four'))<br/>    ).properties(<br/>        width=650, <br/>        height=400<br/>    )</span><span id="d9d7" class="ni kq it ne b gy nn nk l nl nm"># This global variable 'bar_plot' will be used later on<br/><strong class="ne iu">bar_plot </strong>= st.altair_chart(bars)</span><span id="b196" class="ni kq it ne b gy nn nk l nl nm"><br/>def <strong class="ne iu">plot_bar_animated_altair</strong>(df,week):<br/>    bars = alt.Chart(df, title="Ranking as of week :"+week).encode(<br/>        x=X('ranking_points:Q',axis=Axis(title='ATP Ranking    <br/>            Points'), <br/>        y=Y('full_name:N',axis=Axis(title='The Big Four'), sort='-x'),<br/>    color=alt.Color('full_name:N'), <br/>    .properties(<br/>                 width=650, <br/>                 height=400<br/>     )</span><span id="ce00" class="ni kq it ne b gy nn nk l nl nm">if st.button('Cue Chart'):<br/>    for week in week_list:</span><span id="2356" class="ni kq it ne b gy nn nk l nl nm">        # <strong class="ne iu"><em class="me">weekly_df</em></strong> <strong class="ne iu">-&gt;</strong> this dataframe (sample shown above) contains<br/>        # data for a particular week which is passed to<br/>        # the 'plot_bar_animated_altair' function.</span><span id="e503" class="ni kq it ne b gy nn nk l nl nm">        # <strong class="ne iu">week</strong> -&gt; Current week title, eg:-  2016-06-10<br/>        <br/>        bars = <strong class="ne iu">plot_bar_animated_altair</strong>(weekly_df,week)<br/>        time.sleep(0.01) <br/>        <br/>        <strong class="ne iu">bar_plot</strong>.altair_chart(bars)<br/>    <br/>    st.balloons()  # Displays some celebratory balloons for glamour!</span></pre></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="047d" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">演示</h1><p id="d010" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在下面的演示中，我选择了从 1996 年到 2017 年的整个范围，开始时，你会注意到这里只有一个小节(针对罗杰·费德勒)，因为其他三个小节尚未转为职业。随着时间的推移，你可以看到 ATP 的总排名发生了变化，其他球员在随后的几年里也加入了进来。他们当前的排名显示为条形的标签。条形被排序，因此排名较高的玩家总是出现在顶部。</p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="nq nr l"/></div><p class="mw mx gj gh gi my mz bd b be z dk translated">演示者:<a class="nb nc ep" href="https://medium.com/u/c5b77fc1811c?source=post_page-----f41863f1ef7c--------------------------------" rel="noopener" target="_blank">阿林多姆·巴塔查尔吉</a></p></figure></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><h1 id="a037" class="kp kq it bd kr ks kt ku kv kw kx ky kz jz la ka lb kc lc kd ld kf le kg lf lg bi translated">结论</h1><p id="81f0" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">总之，在这个兼职项目结束时，我对<em class="me"> Streamlit </em>的简单性印象深刻。使用任何其他工具来实现这一点肯定会花费我更多的时间。如果你想创建一个动画图表，我希望这篇文章能帮你节省一些时间。</p><p id="bad3" class="pw-post-body-paragraph lh li it lj b lk mf ju lm ln mg jx lp lq mh ls lt lu mi lw lx ly mj ma mb mc im bi translated">鉴于它最近得到越来越多的支持，我相信他们会增加很多其他有用的功能。感谢您的阅读，并祝您未来一周过得愉快！</p></div><div class="ab cl ki kj hx kk" role="separator"><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn ko"/><span class="kl bw bk km kn"/></div><div class="im in io ip iq"><div class="ml mm mn mo gt ns"><a rel="noopener follow" target="_blank" href="/generate-qrcode-with-python-in-5-lines-42eda283f325"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">用 Python 生成 5 行二维码</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">也许在你的简历中使用它来链接到你的网站或 LinkedIn 个人资料</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og mu ns"/></div></div></a></div><div class="oh oi gp gr oj ns"><a rel="noopener follow" target="_blank" href="/face-detection-in-10-lines-for-beginners-1787aa1d9127"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">面向初学者的 10 行人脸检测</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">使用 Python OpenCV 在图像和视频中检测人脸的介绍。</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="ok l od oe of ob og mu ns"/></div></div></a></div></div></div>    
</body>
</html>