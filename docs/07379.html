<html>
<head>
<title>Building and Optimizing Multiple Linear Regression in PowerBI using DAX</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用DAX在PowerBI中构建和优化多元线性回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-and-optimizing-multiple-linear-regression-in-powerbi-using-dax-ed468e1ec2ae?source=collection_archive---------17-----------------------#2020-06-04">https://towardsdatascience.com/building-and-optimizing-multiple-linear-regression-in-powerbi-using-dax-ed468e1ec2ae?source=collection_archive---------17-----------------------#2020-06-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="27f4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文主要介绍如何在PowerBI中使用DAX完成多元线性回归进行时间序列分析。接下来，我将把“岭回归”和“套索回归”的思想引入模型优化。</p><h1 id="e4be" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">多重线性的公式推导</h1><p id="ffec" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">多元线性回归公式如下:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi lr"><img src="../Images/8eca0ff9982a7400573d3fad452e5dfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UEPgdlHiQM69cEPa"/></div></div><p class="md me gj gh gi mf mg bd b be z dk translated"><em class="mh">图片由</em> <a class="ae mi" href="https://en.wikipedia.org/wiki/Regression_analysis" rel="noopener ugc nofollow" target="_blank"> <em class="mh">维基</em> </a></p></figure><p id="409e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">DAX不能执行矩阵运算，所以回归公式参考了克利姆定律。以二元回归为例，其原理是通过计算数据集，得到β0，β1，β2的最优解。公式推导如下:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mj"><img src="../Images/019d9b60431b3b0bb9ceedc74cd18667.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ff8iWYhQsVvqH_kT"/></div></div><p class="md me gj gh gi mf mg bd b be z dk translated"><em class="mh">图片由</em> <a class="ae mi" href="https://en.wikipedia.org/wiki/Regression_analysis" rel="noopener ugc nofollow" target="_blank"> <em class="mh">百科</em> </a></p></figure><p id="53ec" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们只能通过根据这个公式在DAX中创建新的度量来完成回归。</p><h1 id="815e" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">关于本文的数据集</h1><p id="a460" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">本文数据集来自Tableau论坛(Superstore。xls)</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mk"><img src="../Images/7ef88b974d8a73d3d16d0ee70b7a8e93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Wl2n0K5fD3BbmfmA"/></div></div><p class="md me gj gh gi mf mg bd b be z dk translated"><em class="mh">作者图片</em></p></figure><p id="bcbb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其中“订单日期”将是第一个自变量，“销售额”将是因变量(即预测目标)。</p><h1 id="b080" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">构建多元线性回归</h1><p id="0115" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">从下图可以看出，销售数据是以年为单位形成的，所以我们可以用“月”作为第二个自变量。</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi ml"><img src="../Images/30e449ed6268642e40ffbabb33371afd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nJPbuY5EnGe6EhH-"/></div></div><p class="md me gj gh gi mf mg bd b be z dk translated"><em class="mh">作者图片</em></p></figure><p id="9f5d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">基于上述线性回归公式，代码如下:</p><pre class="ls lt lu lv gt mm mn mo mp aw mq bi"><span id="43c6" class="mr kp it mn b gy ms mt l mu mv">Binary Linear Regression = <br/>VAR VT =<br/>FILTER (<br/>SELECTCOLUMNS(<br/>SUMMARIZE(ALLSELECTED('Date'),'Date'[Date],'Date'[Month Number]),<br/>"VT[X1]", 'Date'[Date],<br/>"VT[X2]", 'Date'[Month Number],<br/>"VT[Y]",'Orders'[Qty]<br/>),<br/>AND (<br/>NOT ( ISBLANK ( VT[X1] ) ),<br/>AND(<br/>NOT ( ISBLANK ( VT[X2] ) ),<br/>NOT ( ISBLANK ( VT[Y] ) )<br/>))<br/>)<br/>VAR Average_X1 =<br/>AVERAGEX ( VT, VT[X1] )<br/>VAR Average_X2 =<br/>AVERAGEX ( VT, VT[X2] )<br/>VAR Average_Y =<br/>AVERAGEX ( VT, VT[Y] )<br/>VAR Sum_X1_2 =<br/>SUMX ( VT, (VT[X1] - Average_X1) ^ 2 )<br/>VAR Sum_X2_2 =<br/>SUMX ( VT, (VT[X2] - Average_X2) ^ 2 )<br/>VAR Sum_X1Y =<br/>SUMX ( VT, (VT[X1] - Average_X1) * (VT[Y] - Average_Y))<br/>VAR Sum_X2Y =<br/>SUMX ( VT, (VT[X2] - Average_X2) * (VT[Y] - Average_Y))<br/>VAR X12 = <br/>SUMX( VT, (VT[X1] - Average_X1)*(VT[X2] - Average_X2))<br/>VAR Beta1 =<br/>DIVIDE (<br/>Sum_X1Y*Sum_X2_2 - sum_x2y*X12,<br/>Sum_X1_2*Sum_X2_2 - X12 ^ 2<br/>)<br/>VAR Beta2 =<br/>DIVIDE (<br/>Sum_X2Y*Sum_X1_2 - sum_x1y*X12,<br/>Sum_X1_2*Sum_X2_2 - X12 ^ 2<br/>)<br/>VAR Intercept =<br/>Average_Y - Beta1 * Average_X1 - Beta2 * Average_X2<br/>VAR RESULT = <br/>SUMX (<br/>SUMMARIZE('Date','Date'[Date],'Date'[Month Number]),<br/>Intercept + Beta1 * 'Date'[Date] + Beta2 * 'Date'[Month Number]<br/>)<br/>RETURN<br/>RESULT</span></pre><p id="09f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以看到下图中有一条红色的曲线:这是我们刚刚建立的二元线性回归模型。</p><h1 id="19f6" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">评价模型</h1><p id="5db3" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">现在模型已经建立，我们需要评估它。</p><p id="8e21" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我引入两个指标:</p><p id="608b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">1.RMSE(均方根误差)—越小越好</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/e6740155980775aadb5a65db0bbbfb5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/0*f6slrre_jU7mlCQw"/></div><p class="md me gj gh gi mf mg bd b be z dk translated"><em class="mh">图片由</em> <a class="ae mi" href="https://en.wikipedia.org/wiki/Root-mean-square_deviation" rel="noopener ugc nofollow" target="_blank"> <em class="mh">维基百科</em> </a></p></figure><p id="d3cc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.r(拟合优度)—通常越接近1越好</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mx"><img src="../Images/02280067a8cfec7de30de7b7fc9e7900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GGsydZs97h8hGKQ0"/></div></div><p class="md me gj gh gi mf mg bd b be z dk translated"><em class="mh">图像由</em> <a class="ae mi" href="https://en.wikipedia.org/wiki/Explained_sum_of_squares" rel="noopener ugc nofollow" target="_blank"> <em class="mh">维基</em> </a>组成</p></figure><p id="7952" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">根据上面的公式，可以完成如下代码。</p><pre class="ls lt lu lv gt mm mn mo mp aw mq bi"><span id="75e3" class="mr kp it mn b gy ms mt l mu mv">RMSE = <br/>VAR <br/>VT =<br/>SUMMARIZE(<br/>ALLSELECTED('Date'),'Date'[Date],'Date'[Month Number])<br/>RETURN<br/>SQRT(<br/>divide(<br/>SUMX(VT,<br/>    ('Orders'[Binary Linear Regression] - 'Orders'[Qty]) ^ 2),<br/>COUNTROWS(VT)))</span><span id="5e9f" class="mr kp it mn b gy my mt l mu mv">--------------------------------------------------------------------------------------------------<br/>R^2 = <br/>VAR <br/>VT =<br/>SUMMARIZE(ALLSELECTED('Date'),'Date'[Date],'Date'[Month Number])<br/>VAR<br/>ESS = <br/>SUMX(VT,POWER('Orders'[Binary Linear Regression]-AVERAGEX(VT,[Qty]),2))<br/>VAR<br/>TSS = <br/>SUMX(VT,POWER([Qty]-AVERAGEX(VT,[Qty]),2))<br/>RETURN<br/>DIVIDE(ESS,TSS)</span></pre><p id="82fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行代码后，我们知道模型的拟合效果并不乐观。</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/68e4ff3522408732ed45ddbc8d66b821.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/0*sxWQb7w_PA7GulTO"/></div><p class="md me gj gh gi mf mg bd b be z dk translated"><em class="mh">作者图片</em></p></figure><h1 id="afb7" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">优化模型</h1><p id="cfd7" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">我们知道线性回归优化主要有两种方法:套索回归和岭回归。这两种方法分别在模型中加入了L1 &amp; L2正则化。我们不谈复杂的统计，我们只关心如何用DAX高效的解决模型优化的问题。</p><p id="ac68" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">实际上，这两种方法都是通过增加一个惩罚项来降低模型的某些系数。前者可以直接把不重要的系数压缩到0。所以这个算法本质上是对模型中每个β系数的选择性压缩。另外，DAX本身并不是算法的语言。因此，考虑到代码运行的性能，我们可以简单地将模型的系数乘以一个变量来达到效果，而不需要进行复杂的求导计算。在PowerBI中创建参数作为该变量的值，这样我们就可以在可视化界面中调整该变量的值，实现模型的手动优化。因此，我们修改了原始回归模型的代码:</p><pre class="ls lt lu lv gt mm mn mo mp aw mq bi"><span id="cf4e" class="mr kp it mn b gy ms mt l mu mv">Manual Binary Regression = <br/>VAR R = '_Slope'[Regular factor Value]<br/>VAR A = 'α'[α Value]<br/>VAR B = 'β'[β Value]<br/>VAR VT =<br/>FILTER (<br/>SELECTCOLUMNS(<br/>SUMMARIZE(ALLSELECTED('Date'),'Date'[Date],'Date'[Month Number]),<br/>"VT[X1]", 'Date'[Date],<br/>"VT[X2]", 'Date'[Month Number],<br/>"VT[Y]",'Orders'[Qty]<br/>),<br/>AND (<br/>NOT ( ISBLANK ( VT[X1] ) ),<br/>AND(<br/>NOT ( ISBLANK ( VT[X2] ) ),<br/>NOT ( ISBLANK ( VT[Y] ) )<br/>))<br/>)<br/>VAR Average_X1 =<br/>AVERAGEX ( VT, VT[X1] )<br/>VAR Average_X2 =<br/>AVERAGEX ( VT, VT[X2] )<br/>VAR Average_Y =<br/>AVERAGEX ( VT, VT[Y] )<br/>VAR Sum_X1_2 =<br/>SUMX ( VT, (VT[X1] - Average_X1) ^ 2 )<br/>VAR Sum_X2_2 =<br/>SUMX ( VT, (VT[X2] - Average_X2) ^ 2 )<br/>VAR Sum_X1Y =<br/>SUMX ( VT, (VT[X1] - Average_X1) * (VT[Y] - Average_Y))<br/>VAR Sum_X2Y =<br/>SUMX ( VT, (VT[X2] - Average_X2) * (VT[Y] - Average_Y))<br/>VAR X12 = <br/>SUMX( VT, (VT[X1] - Average_X1)*(VT[X2] - Average_X2))<br/>VAR Beta1 =<br/>DIVIDE (<br/>Sum_X1Y*Sum_X2_2 - sum_x2y*X12,<br/>Sum_X1_2*Sum_X2_2 - X12 ^ 2<br/>) * A <br/>VAR Beta2 =<br/>DIVIDE (<br/>Sum_X2Y*Sum_X1_2 - sum_x1y*X12,<br/>Sum_X1_2*Sum_X2_2 - X12 ^ 2<br/>) * B<br/>VAR Intercept =<br/>Average_Y - Beta1 * Average_X1 - Beta2 * Average_X2<br/>VAR Result = <br/>SUMX (<br/>SUMMARIZE('Date','Date'[Date],'Date'[Month Number]),<br/>Intercept + Beta1 * 'Date'[Date] + Beta2 * 'Date'[Month Number]<br/>)<br/>RETURN<br/>Result * (1-1/R)</span></pre><p id="bcf7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">代码运行如下(注意:调整后的模型显示在深蓝色曲线中，RMSE和R也被更改为该模型的评估值):</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi na"><img src="../Images/9fe9d641dd121d14b7896f28458bc30a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QJCgZdRYzBQydsgw"/></div></div><p class="md me gj gh gi mf mg bd b be z dk translated"><em class="mh">作者图片</em></p></figure><p id="8980" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(注:“α”用于调整第一个参数；“β”用于调整第二个参数)</p><p id="29d0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">到目前为止，我们已经完成了二元线性回归模型的手动优化，我们可以调整参数，然后通过观察RMSE和R来评估结果。</p><p id="c8cc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文本该到此结束，但后来觉得这种手动参数调整有点盲目，我们应该对调整参数有一个直观科学的参考，以提高使用效率。所以我做了一个模型优化参考图，我们以第一个自变量(订单日期)为例，以它的参数为自变量(X轴)，R和RMSE为因变量(Y轴)，这样，我们可以直观地为模型优化提供如下参考:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi nb"><img src="../Images/f64142099f263d9085731d480922fd99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1d2TrB4yrf-f1bJv"/></div></div><p class="md me gj gh gi mf mg bd b be z dk translated"><em class="mh">作者图片</em></p></figure><p id="2387" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(注:由于RMSE的值远大于R的值，上图中的RMSE值被压缩为原来的十分之一，以使RMSE和R更容易观察到。当然也可以考虑用两轴图)</p><h1 id="2a59" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">摘要</h1><p id="46f0" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">到目前为止，我们已经知道如何使用DAX进行多元线性回归和模型优化。代码虽然长，但也不难理解。你可能会奇怪为什么我们不用R语言做线性回归？是的，在PowerBI中使用R语言进行回归更容易。但是PowerBI服务目前只支持部分R库，如果使用报表服务器版本，截至2019年4月，Power BI服务(RS版)不支持任何R库(包括用R语言开发的自定义visual)。除非只需要使用桌面版，否则只能选择使用DAX来完成所有建模工作。另外，这是加深你对DAX和线性回归理解的好机会。</p><p id="5cad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你有更好的方法用PowerBI实现时间序列预测，希望得到你的分享。</p><p id="ac10" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="nc">附:三元线性回归代码</em></p><pre class="ls lt lu lv gt mm mn mo mp aw mq bi"><span id="5664" class="mr kp it mn b gy ms mt l mu mv">Ternary Linear Regression = <br/>VAR VT =<br/>FILTER (<br/>SELECTCOLUMNS(<br/>SUMMARIZE(<br/>    ALLSELECTED('Date'),<br/>    'Date'[Date],'Date'[Month Number],<br/>    DateFactorTable[DateFactor]),<br/>"VT[X1]", 'Date'[Date],<br/>"VT[X2]", 'Date'[Month Number],<br/>"VT[X3]", 'DateFactorTable'[DateFactor],<br/>"VT[Y]",'Orders'[Qty]<br/>),<br/>AND (<br/>NOT ( ISBLANK ( VT[X1] ) ),<br/>AND(<br/>NOT ( ISBLANK ( VT[X2] ) ),<br/>AND(<br/>NOT ( ISBLANK ( VT[X3] ) ),<br/>NOT ( ISBLANK ( VT[Y] ) )<br/>))<br/>))<br/>VAR N =<br/>COUNTROWS ( VT )<br/>VAR L11 = <br/>SUMX(VT,'VT'[X1]^2)-DIVIDE(SUMX(VT,'VT'[X1]^2),N)<br/>VAR L22 = <br/>SUMX(VT,'VT'[X2]^2)-DIVIDE(SUMX(VT,'VT'[X2]^2),N)<br/>VAR L33 = <br/>SUMX(VT,'VT'[X3]^2)-DIVIDE(SUMX(VT,'VT'[X3]^2),N)<br/>VAR L12 = <br/>SUMX(VT,'VT'[X1]*'VT'[X2])-DIVIDE(SUMX(VT,'VT'[X1]*'VT'[X2]),N)<br/>VAR L13 = <br/>SUMX(VT,'VT'[X1]*'VT'[X3])-DIVIDE(SUMX(VT,'VT'[X1]*'VT'[X3]),N)<br/>VAR L32 = <br/>SUMX(VT,'VT'[X3]*'VT'[X2])-DIVIDE(SUMX(VT,'VT'[X3]*'VT'[X2]),N)<br/>VAR L10 = <br/>SUMX(VT,'VT'[X1]*'VT'[Y])-DIVIDE(SUMX(VT,'VT'[X1]*'VT'[Y]),N)<br/>VAR L20 = <br/>SUMX(VT,'VT'[X2]*'VT'[Y])-DIVIDE(SUMX(VT,'VT'[X2]*'VT'[Y]),N)<br/>VAR L30 = <br/>SUMX(VT,'VT'[X3]*'VT'[Y])-DIVIDE(SUMX(VT,'VT'[X3]*'VT'[Y]),N)</span><span id="d1f7" class="mr kp it mn b gy my mt l mu mv">VAR D4 = <br/>L30*L12*L11*L22-L30*L12^3-L11*L22*L13*L20+L13*L20*L12^2-<br/>L11*L20*L30*L22+L11*L20^2*L13+L12*L10*L30*L22-L12*L10*L13*L20<br/>VAR D3 = <br/>L32*L13*L11*L22-L32*L13*L12^2-L12*L33*L11*L22+L12^3*L33-<br/>L30*L22*L12*L13+L13^2*L20+L11*L32*L20*L22-L11*L32*L13*L20</span><span id="4526" class="mr kp it mn b gy my mt l mu mv">VAR BETA3 = <br/>DIVIDE(D4,D3)</span><span id="d972" class="mr kp it mn b gy my mt l mu mv">VAR D2 = <br/>(L12*L13-L11*L32)*BETA3+L11*L20-L12*L10<br/>VAR D1 = <br/>L11*L22-L12^2</span><span id="51f4" class="mr kp it mn b gy my mt l mu mv">VAR BETA2 = <br/>DIVIDE(D2,D1)</span><span id="6eb8" class="mr kp it mn b gy my mt l mu mv">VAR D0 = <br/>L30-BETA2*L32-BETA3*L33</span><span id="0927" class="mr kp it mn b gy my mt l mu mv">VAR BETA1 = <br/>DIVIDE(D0,L13)</span><span id="5167" class="mr kp it mn b gy my mt l mu mv">VAR Intercept =<br/>AVERAGEX(VT,VT[Y]) - BETA1 * AVERAGEX(VT,VT[X1]) - <br/>BETA2 * AVERAGEX(VT,VT[X2]) - <br/>BETA3 * AVERAGEX(VT,VT[X3])<br/>VAR Result = <br/>SUMX (<br/>SUMMARIZE('Date','Date'[Date],'Date'[Month Number],<br/>    DateFactorTable[DateFactor]),<br/>Intercept + <br/>BETA1* 'Date'[Date] +<br/>BETA2 * 'Date'[Month Number] + <br/>BETA3 * 'DateFactorTable'[DateFactor]<br/>)<br/>RETURN<br/>RESULT</span></pre><p id="a3ba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="nc">结束~ </em></p></div></div>    
</body>
</html>