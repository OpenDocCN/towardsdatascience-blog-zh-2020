<html>
<head>
<title>Analyzing Fan Sentiments After NBA Trade Deadline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NBA 交易截止后的球迷情绪分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyzing-fan-sentiments-after-nba-trade-deadline-1b73f72d0ca2?source=collection_archive---------33-----------------------#2020-02-08">https://towardsdatascience.com/analyzing-fan-sentiments-after-nba-trade-deadline-1b73f72d0ca2?source=collection_archive---------33-----------------------#2020-02-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/45e00f64cb1d117fdae9807d803bf728.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LYGC1YUKLRiEmmvI"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae jg" href="https://unsplash.com/@diante21?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">点特乡绅</a>的照片</p></figure><div class=""/><div class=""><h2 id="335f" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">通过推特上关于截止日期前交易的信息来了解球队的整体球迷情绪。</h2></div><h1 id="88b3" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">介绍</h1><p id="26cf" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">今年我们看到了一些最大和最令人惊讶的季中交易。随着一些明显的赢家和其他人对其选择的怀疑，这显然是一个复杂情绪的管弦乐队。然而，在我解释我写这篇文章的原因之前，我想给非 NBA 球迷一些一周前发生的事情的背景。</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mm"><img src="../Images/06b3464d62e2f3aff49e284ec65b142f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jw7d63u3L8rNaBwX"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@rapiana?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">拉米罗·皮亚诺罗萨</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="16f8" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">随着 2020 年 2 月 6 日 NBA 19-20 赛季交易截止日期的临近，球迷们急切地等待着“Woj 炸弹”的降临，而谣言则通过各种人员在不同的平台上传播开来。关于这些谣言有太多要说的了，因为至少其中一些以某种形式成为了事实。</p><p id="9dea" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">这真的在 twitter 上引起了爆发，我很享受看着推文滚动，试图抓住每个粉丝的情绪。</p><p id="98bd" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">球员和媒体的反应很容易推断，但当你有 30 支不同球队的这么多球迷时，你如何确切地分辨谁感到不安，谁没有？一些球队因为失去了一名优秀的球员却没有得到太多的回报而明显感到沮丧，而另一些球队可能会以较小的数量表达他们的不满。</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mw"><img src="../Images/a22eb49dc3f3da866e7ebb33c67af9d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SF8IlowgDLP8n6Dh.jpg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://commons.wikimedia.org/wiki/File:2014_Toronto_Raptors_fans_Air_Canada_Centre.jpg" rel="noopener ugc nofollow" target="_blank">https://commons . wikimedia . org/wiki/File:2014 _ Toronto _ 猛龙 _fans_Air_Canada_Centre.jpg </a></p></figure><p id="8cf0" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">所以，我做了一点挖掘，并恢复了过去 10 天中受交易截止日期影响最大的球队的推文。我的目标是了解这些球队的整体球迷情绪，并看看他们如何相互竞争。我将分析的 7 个团队是:</p><ul class=""><li id="11c6" class="mx my jj ls b lt mr lw ms lz mz md na mh nb ml nc nd ne nf bi translated">亚特兰大老鹰队</li><li id="3776" class="mx my jj ls b lt ng lw nh lz ni md nj mh nk ml nc nd ne nf bi translated">克利夫兰骑士队</li><li id="6a73" class="mx my jj ls b lt ng lw nh lz ni md nj mh nk ml nc nd ne nf bi translated">洛杉矶快船队</li><li id="ed4f" class="mx my jj ls b lt ng lw nh lz ni md nj mh nk ml nc nd ne nf bi translated">迈阿密热火队</li><li id="3de2" class="mx my jj ls b lt ng lw nh lz ni md nj mh nk ml nc nd ne nf bi translated">休斯顿火箭队</li><li id="7140" class="mx my jj ls b lt ng lw nh lz ni md nj mh nk ml nc nd ne nf bi translated">明尼苏达森林狼队</li><li id="f7ef" class="mx my jj ls b lt ng lw nh lz ni md nj mh nk ml nc nd ne nf bi translated">金州勇士队</li></ul><p id="2a8e" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">所以，事不宜迟，让我们开始吧。</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nl"><img src="../Images/4738f820f5c1401de4c96b0e78990f1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*F4Yog6OlFF_Zg6Xp"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">谢尔盖·库图佐夫在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="af03" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">该过程</h1><p id="d6ed" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我在 Python (Jupyter)上做了完整的分析，如果你想复制这个过程，我将为你添加我的代码片段。</p><p id="e1af" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">需要以下库:NLTK、Textblob、Pandas(只需 pip 安装)。</p><p id="ffa2" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">您希望从导入以下内容开始:</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="01c7" class="nr kz jj nn b gy ns nt l nu nv">import pandas as pd<br/>import nltk<br/>nltk.download('stopwords')<br/>import en_core_web_sm<br/>from textblob import TextBlob<br/>import seaborn as sb<br/>from bs4 import BeautifulSoup</span></pre><p id="ff70" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">我将每个团队的所有推文保存为单独的 CSV 文件，所以我上传了以下内容:</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="4988" class="nr kz jj nn b gy ns nt l nu nv">HawksTweets = pd.read_csv("HawksTweets.csv")<br/>CavaliersTweets = pd.read_csv("CavaliersTweets.csv")<br/>ClippersTweets = pd.)read_csv("ClippersTweets.csv")<br/>HeatTweets = pd.read_csv("HeatTweets.csv")<br/>TimberwolvesTweets = pd.read_csv("TimberwolvesTweets.csv")<br/>RocketsTweets = pd.read_csv("RocketsTweets.csv")<br/>WarriorsTweets = pd.read_csv("WarriorsTweets.csv")</span></pre><p id="5b61" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">然后，我会将它们合并到一个数据集，如下所示:</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="4625" class="nr kz jj nn b gy ns nt l nu nv">teams = [HawksTweets, CavaliersTweets, ClippersTweets, HeatTweets, TimberwolvesTweets, RocketsTweets, WarriorsTweets]<br/>TeamTweets =  pd.concat(teams)</span></pre><p id="6d8a" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">因为我们只想分析英语的推文:</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="c464" class="nr kz jj nn b gy ns nt l nu nv">TeamTweets = TeamTweets[TeamTweets['Language'] == 'English']</span></pre><p id="8dd5" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">现在数据集已经准备好使用 NLTK 了。</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nw"><img src="../Images/b4a945b07a8714101d4355309cff3153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*69dA4RCw_xQlLqcL"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@t_ahmetler?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">托尔加·阿赫梅特勒</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="cf0c" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">文本预处理</h1><p id="74eb" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">首先，我们希望将文本标记成单独的单词，这样我们就可以删除停用词、非英语单词和无意义的标签。我们用下面一行来标记:</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="4c5c" class="nr kz jj nn b gy ns nt l nu nv">TeamTweets['tokenized_sent'] = TeamTweets.apply(lambda row: nltk.word_tokenize(row['Text']), axis=1)</span></pre><p id="d829" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">现在我们用漂亮的汤清洗课文:</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="62e3" class="nr kz jj nn b gy ns nt l nu nv">soup = BeautifulSoup(TeamTweets['tokenized_sent'])<br/>text = soup.get_text(strip=True)<br/>TeamTweets['tokenized_sent'] = text</span></pre><p id="43e6" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">接下来，我将定义一个函数来分解文本，并进行一些额外的清理，这可能有助于我们完成这个过程。我还使用来自 NLTK 的英语单词语料库去除了非英语单词。</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="b4aa" class="nr kz jj nn b gy ns nt l nu nv">def untokenize(words):<br/>    text = ' '.join(words)<br/>    step1 = text.replace("`` ", '"').replace(" ''", '"').replace('. . .',  '...')<br/>    step2 = step1.replace(" ( ", " (").replace(" ) ", ") ")<br/>    step3 = re.sub(r' ([.,:;?!%]+)([ \'"`])', r"\1\2", step2)<br/>    step4 = re.sub(r' ([.,:;?!%]+)$', r"\1", step3)<br/>    step5 = step4.replace(" '", "'").replace(" n't", "n't").replace(<br/>         "can not", "cannot")<br/>    step6 = step5.replace(" ` ", " '")<br/>    return step6.strip()</span><span id="c32f" class="nr kz jj nn b gy nx nt l nu nv">englang = words = set(nltk.corpus.words.words())<br/>TeamTweets['Sentences'] = TeamTweets['tokenized_sent'].apply(lambda x: [item for item in x if item in englang])<br/>TeamTweets['Sentences'] = TeamTweets['Sentences'].apply(lambda x: untokenize(x))</span></pre><p id="e4c3" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">现在，我有了一个包含已处理文本的数据集，它已经准备好进行 TextBlob 的情感分析。</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ny"><img src="../Images/ebbfdd027ab768aaa64b89b8c3d0c1ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3K0hchV0NqmJW55M.jpg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://commons.wikimedia.org/wiki/File:2019_nba_finals_game_2.jpg" rel="noopener ugc nofollow" target="_blank">https://commons . wikimedia . org/wiki/File:2019 _ NBA _ 总决赛 _ 游戏 _2.jpg </a></p></figure><h1 id="b19a" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">情感分析</h1><p id="2815" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">首先，让我们为分数插入一列:</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="ca4d" class="nr kz jj nn b gy ns nt l nu nv">TeamTweets.insert(2, "Score", "", True)</span></pre><p id="bdf2" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">接下来，我将定义一个函数，它将为我们的数据帧中的每一行文本提供情感输出。我将对我们的行应用这个函数，并获得每条推文的情感分数。</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="08df" class="nr kz jj nn b gy ns nt l nu nv">def senti(x):<br/>    return TextBlob(x).sentiment</span><span id="e1b7" class="nr kz jj nn b gy nx nt l nu nv">TeamTweets['Score'] = TeamTweets['Sentences'].apply(senti)</span></pre><p id="b76f" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">我们以主观性和极性的形式得到分数。您可以使用下面的方法用 seaborn 来绘制它们:</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="ddd2" class="nr kz jj nn b gy ns nt l nu nv">ax1 = sb.catplot(x="Subjectivity", y="Team", data=df)</span></pre><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/89aa3679f053ed03cc0c29996f02c734.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*8A1ygcO3RzgzEZr0HrCT0A.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">我的 Jupyter 笔记本截图</p></figure><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="470f" class="nr kz jj nn b gy ns nt l nu nv">ax2 = sb.catplot(x="Polarity", y="Team", data=df)</span></pre><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/c693ccb879c58287a779cfcf45106a86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*QGgZSlmXe7HnasdNALBM9A.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">我的 Jupyter 笔记本截图</p></figure><p id="3124" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">现在，让我们通过对项目求和来计算每个团队的总得分。这将给出我们的最终得分，这将是球迷情绪的一个指标。</p><p id="086a" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">首先，我创建一个新的数据框，每个团队作为一行。</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="be7b" class="nr kz jj nn b gy ns nt l nu nv">key = {'Team': ['Atlanta Hawks', 'Cleveland Cavaliers', 'LA Clippers', 'Miami Heat', 'Minnesota Timberwolves', 'Houston Rockets', 'Golden State Warriors']}<br/>keydata = pd.DataFrame(key)</span></pre><p id="0ba3" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">将团队列为一个列表:</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="85f3" class="nr kz jj nn b gy ns nt l nu nv">teamlist = keydata.Team.tolist()<br/>list2 = keydata.index</span><span id="47ed" class="nr kz jj nn b gy nx nt l nu nv">teams = []<br/>teams.extend([list(a) for a in zip(teamlist, list2)])</span></pre><p id="624f" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">最后，我编写了一个函数，根据球队名称计算得分总和:</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="199e" class="nr kz jj nn b gy ns nt l nu nv">def add_team(team_tuple):<br/>    <br/>    score = df.loc[(df['Team'] == team_tuple[0]),'Polarity'].sum()<br/>    keydata.loc[keydata.index[team_tuple[1]]] = score<br/>    return</span><span id="2215" class="nr kz jj nn b gy nx nt l nu nv">for team in teams:<br/>    add_team(team)</span></pre><p id="c5f6" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">最终的数据框汇总了每个队的得分。根据他们的推文，得分越高，这支球队的球迷情绪就越积极。</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/076e49e13f3cf6707e66b55a2a496be5.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*rPTJRwe1oYh81HIox6jlfQ.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">我的 Jupyter 笔记本截图</p></figure><p id="1937" class="pw-post-body-paragraph lq lr jj ls b lt mr kk lv lw ms kn ly lz mt mb mc md mu mf mg mh mv mj mk ml im bi translated">用图表展示我们的最终结果:</p><pre class="mn mo mp mq gt nm nn no np aw nq bi"><span id="c984" class="nr kz jj nn b gy ns nt l nu nv">ax3 = sb.barplot(x="Score", y="Team", data=keydata)</span></pre><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oc"><img src="../Images/69dfe016565f7ea8168e787bc2252afc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8TCKGqmLay6pjSEMUGVgBQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">我的 Jupyter 笔记本截图</p></figure><h1 id="c562" class="ky kz jj bd la lb lc ld le lf lg lh li kp lj kq lk ks ll kt lm kv ln kw lo lp bi translated">结论</h1><p id="2934" class="pw-post-body-paragraph lq lr jj ls b lt lu kk lv lw lx kn ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">我们可以看到骑士队在得到安德烈·德拉蒙德后情绪不佳(考虑到他的合同还有 3 个月到期)，所以他们只拥有他很短一段时间。另一方面，迈阿密热火队在交易了安德烈·伊戈达拉后，似乎得到了球迷们最好的反应。</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi od"><img src="../Images/5ceaf4747a866c700e07014f395de3cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YLQwCk613GGMpnQC"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">埃德加·恰帕罗在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><blockquote class="oe"><p id="1e93" class="of og jj bd oh oi oj ok ol om on ml dk translated">感谢你的阅读！希望你学到了新东西。</p><p id="1dce" class="of og jj bd oh oi oo op oq or os ml dk translated">更多类似内容关注我！</p></blockquote></div></div>    
</body>
</html>