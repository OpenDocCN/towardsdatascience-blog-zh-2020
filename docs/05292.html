<html>
<head>
<title>Machine Learning For Genomics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基因组学的机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-for-genomics-c02270a51795?source=collection_archive---------14-----------------------#2020-05-05">https://towardsdatascience.com/machine-learning-for-genomics-c02270a51795?source=collection_archive---------14-----------------------#2020-05-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b609" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何转换您的基因组数据以适应机器学习模型</h2></div><p id="910c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">机器学习已经普及。然而，它不是生物信息学和计算生物学领域的常见用例。使用机器学习技术的工具非常少。大多数工具都是在确定性方法和算法的基础上开发的。在这篇文章中，我将介绍我们如何安排我们的数据，以便在机器学习模型中有效地使用它们。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/f11d691c3bdbedceb48209d625e3a8c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cl2IGEJctRRVMeqh-Oi0qQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图片来自<a class="ae lr" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=296744" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae lr" href="https://pixabay.com/users/Clker-Free-Vector-Images-3736/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=296744" rel="noopener ugc nofollow" target="_blank"> Clker-Free-Vector-Images </a></p></figure><h1 id="d6fe" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">应用领域</h1><p id="34d7" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">在基因组学中有很多场景我们可能会用到机器学习。聚类和分类的主要领域可用于基因组学的各种任务。其中一些如下:</p><h2 id="067e" class="mp lt iq bd lu mq mr dn ly ms mt dp mc ko mu mv me ks mw mx mg kw my mz mi na bi translated">聚类(无监督学习)</h2><ol class=""><li id="0e62" class="nb nc iq kh b ki mk kl ml ko nd ks ne kw nf la ng nh ni nj bi translated">宏基因组重叠群的宁滨</li><li id="a0e4" class="nb nc iq kh b ki nk kl nl ko nm ks nn kw no la ng nh ni nj bi translated">质粒和染色体的鉴定</li><li id="4ba5" class="nb nc iq kh b ki nk kl nl ko nm ks nn kw no la ng nh ni nj bi translated">聚类读入染色体，以便更好地组装</li><li id="4910" class="nb nc iq kh b ki nk kl nl ko nm ks nn kw no la ng nh ni nj bi translated">作为读取集合的预处理器的读取聚类</li></ol><h2 id="0925" class="mp lt iq bd lu mq mr dn ly ms mt dp mc ko mu mv me ks mw mx mg kw my mz mi na bi translated">分类(监督学习)</h2><ol class=""><li id="43e6" class="nb nc iq kh b ki mk kl ml ko nd ks ne kw nf la ng nh ni nj bi translated">将较短的序列分类(门、属、种等)</li><li id="4c67" class="nb nc iq kh b ki nk kl nl ko nm ks nn kw no la ng nh ni nj bi translated">序列的系统发育推断</li><li id="b4ed" class="nb nc iq kh b ki nk kl nl ko nm ks nn kw no la ng nh ni nj bi translated">质粒和染色体的检测</li><li id="18b7" class="nb nc iq kh b ki nk kl nl ko nm ks nn kw no la ng nh ni nj bi translated">寻找编码区域</li><li id="fb4c" class="nb nc iq kh b ki nk kl nl ko nm ks nn kw no la ng nh ni nj bi translated">人类基因组学中的染色体预测</li></ol><p id="e149" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然我已经列出了几个我有经验的领域，但是这个清单可能还会更长。</p><h1 id="ac07" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">数据转换和模型选择</h1><p id="a65d" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">在转换和模型选择这两个步骤中，我认为前者更重要。这是因为如果没有数据表示的坚实基础，我们可能无法从模型中获得最大收益。然而，即使我们的模型看起来很差，拥有干净和信息丰富的数据也可以表现得更好。我们可以考虑两类数据。</p><h2 id="4533" class="mp lt iq bd lu mq mr dn ly ms mt dp mc ko mu mv me ks mw mx mg kw my mz mi na bi translated">顺序数据</h2><p id="18d7" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">顺序数据是指输入模型的数据顺序与数据集中数据的实际顺序相对应的数据。让我们看看下面的例子。</p><ol class=""><li id="6b73" class="nb nc iq kh b ki kj kl km ko np ks nq kw nr la ng nh ni nj bi translated">蛋白质编码区的预测<br/>在这个场景中，我们将会看到连续的核苷酸碱基和它们的顺序。否则就没有意义了。在这种情况下，我们可以将数据转换为包含连续的<strong class="kh ir">三聚体单词</strong>的句子。</li><li id="6cda" class="nb nc iq kh b ki nk kl nl ko nm ks nn kw no la ng nh ni nj bi translated">分类标签预测<br/>在这种情况下，我们需要更高的精确度，因为寡核苷酸频率在物种之间可能非常相似，而在某些物种之间具有非常低的唯一性。因此，我们将着眼于创建大于5或7的<strong class="kh ir"> k </strong>值的<strong class="kh ir"> k-mer </strong>句子。</li></ol><p id="0425" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们考虑下面的例子。我将使用两个物种<strong class="kh ir">铜绿假单胞菌(</strong> CP007224.1) <strong class="kh ir"> </strong>和<strong class="kh ir">发酵乳杆菌</strong> (AP008937.1) <strong class="kh ir"> </strong>来演示转化为<strong class="kh ir"> k-mer </strong>单词句子(显示了前50个碱基)。</p><pre class="lc ld le lf gt ns nt nu nv aw nw bi"><span id="36dc" class="mp lt iq nt b gy nx ny l nz oa"><strong class="nt ir">Pseudomonas aeruginosa<br/></strong>TTTAAAGAGACCGGCGATTCTAGTGAAATCGAACGGGCAGGTCAATTTCC</span><span id="b0db" class="mp lt iq nt b gy ob ny l nz oa"><strong class="nt ir">Lactobacillus fermentum<br/></strong>TTGACTGAGCTCGATTCTCTTTGGGAAGCGATCCAAAATTCATTCCGTAA</span></pre><p id="33bf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们可以将其转换为三聚体单词，如下所示。</p><pre class="lc ld le lf gt ns nt nu nv aw nw bi"><span id="c9cb" class="mp lt iq nt b gy nx ny l nz oa"><strong class="nt ir">Pseudomonas aeruginosa<br/></strong>TTT TTA TAA AAA AAG AGA GAG AGA GAC ACC CCG CGG GGC GCG CGA GAT ATT TTC TCT CTA TAG AGT GTG TGA GAA AAA AAT ATC TCG CGA GAA AAC ACG CGG GGG GGC GCA CAG AGG GGT GTC TCA CAA AAT ATT TTT TTC TCC</span><span id="d637" class="mp lt iq nt b gy ob ny l nz oa"><strong class="nt ir">Lactobacillus fermentum<br/></strong>TTG TGA GAC ACT CTG TGA GAG AGC GCT CTC TCG CGA GAT ATT TTC TCT CTC TCT CTT TTT TTG TGG GGG GGA GAA AAG AGC GCG CGA GAT ATC TCC CCA CAA AAA AAA AAT ATT TTC TCA CAT ATT TTC TCC CCG CGT GTA TAA</span></pre><p id="f67f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们有了单词的句子，处理过程变得类似于情感分析。关键的想法是保持句子的长度，你可以根据序列的平均长度来决定。</p><h2 id="2241" class="mp lt iq bd lu mq mr dn ly ms mt dp mc ko mu mv me ks mw mx mg kw my mz mi na bi translated">适用于顺序数据的模型</h2><p id="9be4" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">由于上述场景中k-mers的顺序很重要，我们可以很容易地使用<strong class="kh ir">递归神经网络(RNN) </strong>或<strong class="kh ir">长短期记忆模型(LSTM) </strong>。这是因为它们能够将项目的顺序保持为一种时间关系。</p><p id="c0f1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，在上面的场景中，您必须使用标记化，然后是单词嵌入层。确保将编码器和记号赋予器保存到一个文件中(序列化),这样您就有了用于以后预测的编码器。这里<strong class="kh ir"> kmer_strings </strong>是我创建的句子，<strong class="kh ir">类</strong>是指定的标签。</p><pre class="lc ld le lf gt ns nt nu nv aw nw bi"><span id="7bb4" class="mp lt iq nt b gy nx ny l nz oa">tokenizer = Tokenizer()<br/>tokenizer.fit_on_texts(<strong class="nt ir">kmer_strings</strong>)<br/>vocab_size = len(tokenizer.word_index) + 1<br/>encoded_docs = tokenizer.texts_to_sequences(<strong class="nt ir">kmer_strings</strong>)</span><span id="7345" class="mp lt iq nt b gy ob ny l nz oa">binarizer = preprocessing.LabelBinarizer()<br/>labels_encoded = binarizer.fit_transform(<strong class="nt ir">classes</strong>)</span></pre><p id="c791" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是我几天前使用<strong class="kh ir"> Keras Sequential API </strong>进行序列分类时使用的一个模型。我将单词从最初的32个维度嵌入到5个维度中(有32个独特的三聚体合并了下游链的反向互补)。</p><pre class="lc ld le lf gt ns nt nu nv aw nw bi"><span id="eab7" class="mp lt iq nt b gy nx ny l nz oa">model = Sequential()<br/>model.add(Embedding(vocab_size, 5))<br/>model.add(Bidirectional(LSTM(5)))<br/>model.add(Dense(30, activation = 'relu'))<br/>model.add(Dropout(0.2))<br/>model.add(Dense(20, activation = 'relu'))<br/>model.add(Dropout(0.2))<br/>model.add(Dense(2, activation = 'softmax'))</span></pre><p id="0a6d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您的分类是多标签，您需要使用<strong class="kh ir"> sigmoid </strong>激活功能代替<strong class="kh ir"> softmax </strong>功能。</p><h2 id="f504" class="mp lt iq bd lu mq mr dn ly ms mt dp mc ko mu mv me ks mw mx mg kw my mz mi na bi translated">无序数据</h2><p id="a982" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">对于相似序列之间的相关性比序列的唯一可识别性更重要的情况，我们倾向于使用无序数据。这些通常以寡核苷酸频率向量的形式表示。例如，<strong class="kh ir">铜绿假单胞菌(</strong> CP007224.1) <strong class="kh ir"> </strong>和<strong class="kh ir">发酵乳杆菌</strong> (AP008937.1)的标准化频率如下所示。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oc"><img src="../Images/aa98df6cb202586522e9845ea34d68b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OXy4oephslBEfOaGFdnsGg.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">两个物种的三聚体频率模式</p></figure><p id="c186" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到它们遵循完全不同的模式。请注意，我们已经失去了三聚体的实际顺序，但留下了一个代表来唯一地识别这两个物种。然而，在<strong class="kh ir"> k=3 </strong>的时候，你很可能会遇到近亲物种之间的碰撞。这是一篇关于如何基于这些模式进行集群的有趣文章；</p><div class="od oe gp gr of og"><a rel="noopener follow" target="_blank" href="/composition-based-clustering-of-metagenomic-sequences-4e0b7e01c463"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd ir gy z fp ol fr fs om fu fw ip bi translated">基于组成的宏基因组序列聚类</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">基于寡核苷酸组成的宏基因组序列聚类</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="oq l or os ot op ou ll og"/></div></div></a></div><p id="ff4f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面的文章可能会对如何非常有效地使用DBSCAN有所帮助。</p><div class="od oe gp gr of og"><a rel="noopener follow" target="_blank" href="/how-to-use-dbscan-effectively-ed212c02e62"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd ir gy z fp ol fr fs om fu fw ip bi translated">如何有效地使用DBSCAN</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">有效使用最常引用的聚类算法的完整指南</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="ov l or os ot op ou ll og"/></div></div></a></div><p id="53ce" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在您已经看到了数据，您可以使用类似于下面的模型来进行分类。</p><pre class="lc ld le lf gt ns nt nu nv aw nw bi"><span id="8535" class="mp lt iq nt b gy nx ny l nz oa">model = Sequential()<br/>model.add(Dense(30, activation = 'relu', input_shape=(32,)))<br/>model.add(Dropout(0.2))<br/>model.add(Dense(20, activation = 'relu'))<br/>model.add(Dropout(0.2))<br/>model.add(Dense(2, activation = 'softmax'))<br/>model.compile(loss='binary_crossentropy', optimizer='adam')</span></pre><p id="3645" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，当您为此决定更长的<strong class="kh ir"> k-mers </strong>时，您的输入维度将增加<strong class="kh ir"> 4 </strong>的幂次。此外，计算如此长的向量也需要很长时间。您可能希望阅读下面的文章，这篇文章解释了如何使用一个简单易用的小脚本来实现这一点。</p><div class="od oe gp gr of og"><a href="https://medium.com/computational-biology/vectorization-of-dna-sequences-2acac972b2ee" rel="noopener follow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd ir gy z fp ol fr fs om fu fw ip bi translated">DNA序列的矢量化</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">ACGT序列到k-mer频率向量的有效转换</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">medium.com</p></div></div><div class="op l"><div class="ow l or os ot op ou ll og"/></div></div></a></div><h1 id="2be5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">现有工具很少</h1><p id="1814" class="pw-post-body-paragraph kf kg iq kh b ki mk jr kk kl ml ju kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">现在，您已经看到了如何在机器学习模型中使用可变长度的基因组序列，让我展示几个实际做到这一点的工具。</p><ol class=""><li id="2126" class="nb nc iq kh b ki kj kl km ko np ks nq kw nr la ng nh ni nj bi translated"><a class="ae lr" href="https://github.com/Shamir-Lab/PlasClass/" rel="noopener ugc nofollow" target="_blank">plas class</a>(<a class="ae lr" href="https://journals.plos.org/ploscompbiol/article/comments?id=10.1371/journal.pcbi.1007781" rel="noopener ugc nofollow" target="_blank">2020出版，PLOS </a> ) <br/>对k-mer频率向量使用逻辑回归来检测它们是否来源于质粒序列或染色体片段。这是一个基于二元分类的工具。</li><li id="87c1" class="nb nc iq kh b ki nk kl nl ko nm ks nn kw no la ng nh ni nj bi translated"><a class="ae lr" href="https://github.com/smaegol/PlasFlow" rel="noopener ugc nofollow" target="_blank">plas flow</a>(<a class="ae lr" href="https://academic.oup.com/nar/article/46/6/e35/4807335" rel="noopener ugc nofollow" target="_blank">2018出版，核酸研究</a> ) <br/>该工具预测门级分类，预测给定的重叠群是质粒还是染色体。在k-mer频率向量上使用神经网络。</li><li id="3499" class="nb nc iq kh b ki nk kl nl ko nm ks nn kw no la ng nh ni nj bi translated"><a class="ae lr" href="https://github.com/anuradhawick/MetaBCC-LR/" rel="noopener ugc nofollow" target="_blank"> MetaBCC-LR </a> ( <a class="ae lr" href="https://doi.org/10.1093/bioinformatics/btaa441" rel="noopener ugc nofollow" target="_blank">出版，2020，生物信息学</a> ) <br/>使用t-分布式随机邻居嵌入(t-SNE)对基因组长阅读进行降维，以执行宏基因组阅读的三聚体向量的宁滨。</li></ol><p id="b27a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了这几个工具(我用过的和我写的第三个)，在不同的研究领域有更多的工具。LSTMs用于基因预测和编码区检测。</p><p id="cd5c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，机器学习技术在该领域有巨大的潜力可以展示。</p><p id="186b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望你读过一些有用的书。干杯！</p></div></div>    
</body>
</html>