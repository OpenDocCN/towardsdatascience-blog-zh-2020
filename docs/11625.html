<html>
<head>
<title>7 Months of a Relationship, WhatsApp Messages Analyzed</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">7 个月的关系，WhatsApp 消息分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/7-months-of-a-relationship-whatsapp-messages-analyzed-e5c34b8aaa63?source=collection_archive---------19-----------------------#2020-08-12">https://towardsdatascience.com/7-months-of-a-relationship-whatsapp-messages-analyzed-e5c34b8aaa63?source=collection_archive---------19-----------------------#2020-08-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/cadc6ca4e8af95268337efca756c1a39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UZqcoOLOaFMjKLTmaPM2HA.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@ymoran?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">莫兰</a>在<a class="ae kf" href="https://unsplash.com/s/photos/whatsapp?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="34da" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">他们说，交往是关键。没有交流，任何关系都是生不如死。在这个时代，就通信而言，技术占据了中心舞台。在这篇文章中，我们将分析我和我未婚夫之间的 WhatsApp 消息，最终你可以在 WhatsApp 数据上应用这些知识。我们将在这个分析中使用 Python，并具体处理:Pandas 表、数据可视化、数据清理等等。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="5b7f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我们开始之前，我想提一下，我们已经有一年半的关系了，可用的聊天时间是从 2019 年 12 月 18 日到 2020 年 8 月 10 日(236 天或 7 个月 23 天)。在这期间，我离开了我的祖国，离开了她的家乡。我们是土生土长的肯尼亚人，但我目前在南非。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="7e35" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们继续分析数据。我希望我们一步一步来，这样你就清楚了。</p><h1 id="b581" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">步骤 1:获取 WhatsApp 数据</h1><p id="abbc" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">WhatsApp 允许用户将整个聊天记录下载到一个文本文件中。要做到这一点，请打开您有兴趣获取数据的对话。在<strong class="ki iu">右上角点击 3 个点&gt;更多&gt;导出聊天&gt;无媒体</strong>。之后，将下载一个文本文件，它将包含从开始到结束的转换中的所有消息。为了清楚起见，我把我的保存为<code class="fe mo mp mq mr b">whatsapp.txt</code>。</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ms"><img src="../Images/7961a511f8f908edeb58b4c390b82711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*56Xix-LQe9X2Fj7Mh1RmqA.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">图 1:获取转换数据的过程。(来源:作者)</p></figure><h1 id="23dd" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">第二步:查看数据</h1><p id="69b8" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">打开文件<code class="fe mo mp mq mr b">whatsapp.txt</code>时，你会看到这样一个文件</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mx"><img src="../Images/03d5d8e9b651d89405431982e9d4ed02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sjIS3bQDzxDnuXDO2qSHww.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">图 whatsapp.txt 文件的前 5 行(来源:作者)</p></figure><ul class=""><li id="921a" class="my mz it ki b kj kk kn ko kr na kv nb kz nc ld nd ne nf ng bi translated"><strong class="ki iu">第 1 行:</strong>这是 WhatsApp 的一条消息，确保消息是端到端加密的。这是一个特例，我们将在分析中跳过它。</li><li id="24a7" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated"><strong class="ki iu">第 2 行到第 5 行:</strong>通常，每一行代表发件人的一条消息。它将包含<strong class="ki iu">日期、时间、发送者</strong>以及<strong class="ki iu">消息</strong>。</li></ul><p id="c709" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">注</strong>:有两个寄件人(我和我未婚夫)。我把我未婚夫的名字保存为<strong class="ki iu">我的妻子，我爱你❤ </strong>，我的 WhatsApp 用户名是<strong class="ki iu"> koech christian </strong>。</p><h1 id="d8de" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">步骤 3:处理数据并将其保存到 CSV 中</h1><p id="a975" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">对于每一行，我们需要提取消息发送的日期和时间、发送者和消息本身。</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><ul class=""><li id="a901" class="my mz it ki b kj kk kn ko kr na kv nb kz nc ld nd ne nf ng bi translated"><strong class="ki iu">第 2 行:</strong>这是一个空列表，用来保存我们的数据。</li><li id="bcb0" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated"><strong class="ki iu">第 3 行和第 4 行</strong>:这里，我们以读取模式(r)读取我们的文件，并且一次遍历每一行。</li><li id="35bc" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated">为了理解<strong class="ki iu">第 6–8 行</strong>，让我们以其中一行为例:</li></ul><pre class="mt mu mv mw gt no mr np nq aw nr bi"><span id="6c4c" class="ns lm it mr b gy nt nu l nv nw"><strong class="mr iu">line</strong> = 12/18/19, 08:15 - koech christian: Have woken up my dear.</span><span id="8328" class="ns lm it mr b gy nx nu l nv nw">In 6, we will <strong class="mr iu">strip</strong> the <strong class="mr iu">line</strong> of trailing white spaces and <strong class="mr iu">split</strong> the <strong class="mr iu">line</strong> by the hyphen (-)</span><span id="36bb" class="ns lm it mr b gy nx nu l nv nw">Result: <br/>12/18/19, 08:15 <strong class="mr iu">#send_time</strong><br/>koech christian: Have woken up my dear. <strong class="mr iu">#message_section</strong></span><span id="6047" class="ns lm it mr b gy nx nu l nv nw">Note: <strong class="mr iu">send_time</strong> still has both the date and the time while <strong class="mr iu">message_section</strong> has the sender and the message.</span><span id="13d2" class="ns lm it mr b gy nx nu l nv nw">Code line 7: We will split the content of <strong class="mr iu">message_section</strong> by the first occurrence of a full colon (:) hence <strong class="mr iu">maxsplit = 1</strong>. If we don't do this split function may split at the middle of the message in case a sender uses a full colon.</span><span id="645e" class="ns lm it mr b gy nx nu l nv nw">You now know what 8 does.</span></pre><ul class=""><li id="b08e" class="my mz it ki b kj kk kn ko kr na kv nb kz nc ld nd ne nf ng bi translated"><strong class="ki iu">第 9 行到第 15 行</strong>:我们将感兴趣的值传递到一个字典中，然后将其追加到数据中。</li><li id="5dff" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated"><strong class="ki iu">第 19 行和第 20 行</strong>:将数据写入名为<code class="fe mo mp mq mr b">messages.csv</code>的 CSV 文件。</li><li id="dcca" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated">由<strong class="ki iu">行 1 </strong>引发的异常将由<code class="fe mo mp mq mr b">try...except...</code>处理</li></ul><h1 id="2cf7" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">步骤 4:查看 CSV 文件</h1><p id="0f0f" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">让我们加载我们在步骤 3 中保存的 CSV 文件(<code class="fe mo mp mq mr b">messages.csv</code>)，看看几行是什么样子的。</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="1ba9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">输出:</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/97a02b5e0432b61fa2c641379ce5e440.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*aKRGF7GCtAXIzhqV_ON_fg.png"/></div></figure><p id="85b4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来的事情是分析数据，但在此之前，我只是想做出我的猜测，可能是我的预期。第一，我知道这很傻，但我给我的句子加标点符号，她不 LoL！。她睡得很早，甚至没有说晚安，所以我打赌我会在任何一天结束谈话。她也比我醒得早，我想她会开始大部分的“早上好”信息。</p><p id="edc7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们回到肯尼亚时，她很少在 WhatsApp 上和我聊天。这意味着我去南非之前(2020 年 2 月 2 日之前)的信息数量肯定会比我在这里时我们互相发送的信息少。</p><h1 id="3591" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated"><strong class="ak">第五步:数据分析</strong></h1><p id="8053" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">在数据分析中，我们将使用 Pandas 库进行描述性统计，并使用 Matplotlib 中的 Pyplot 模块来可视化我们的分析结果。</p><p id="fc25" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们开始吧！</p><h1 id="6e1f" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated"><strong class="ak">活动天数</strong></h1><p id="35fb" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">在我们有数据的 236 天中，有多少天我们实际上交换了 WhatsApp 信息？</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="3b3e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">输出:</p><pre class="mt mu mv mw gt no mr np nq aw nr bi"><span id="a7f1" class="ns lm it mr b gy nt nu l nv nw">Active days:  222<br/>First Day: 2019-12-18<br/>Last Day:  2020-08-10<br/>Difference of Dates:  236</span></pre><p id="8b7e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们再来看看代码实际上在做什么</p><ul class=""><li id="0c9b" class="my mz it ki b kj kk kn ko kr na kv nb kz nc ld nd ne nf ng bi translated"><strong class="ki iu">第 1 行</strong>:将日期字符串转换成 Python 日期时间对象。</li><li id="a2d5" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated"><strong class="ki iu">第 3 行和第 4 行</strong>:通过简单地计算<strong class="ki iu">日期</strong>列中唯一值的数量来确定活动天数。</li><li id="41e7" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated"><strong class="ki iu">第 6 行到第 10 行</strong>:获取聊天历史的第一天和最后一天。对话中包含的消息是从 2019 年 12 月 18 日到 2020 年 8 月 8 日。</li><li id="a9d7" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated"><strong class="ki iu">第 12–15 行</strong>:获取 6–10 中确定的第一个和最后一个日期之间的差值。</li></ul><p id="f80b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从这里可以看到我们在 WhatsApp <strong class="ki iu">上聊过 236 天的 222 天</strong> (94%的时间)。事实上，造成差异的 14 天是选择存在的。我们使用了另一种交流方式(当我回到肯尼亚的时候)。我在南非的时候，我们有 100%活跃的日子。我们马上就会发现。</p><h1 id="c6a9" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">谁的消息最多？</h1><p id="2726" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">我想我是留言最多的人，但差别不会很大。让我看看。</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="8671" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">输出:</p><pre class="mt mu mv mw gt no mr np nq aw nr bi"><span id="e101" class="ns lm it mr b gy nt nu l nv nw">Total Messages:  34491<br/>My Wife, I LOVE YOU ❤   18030<br/>koech christian         16461</span></pre><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/fb31bc1eb8d1dfb4a0a45e797be0fea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*fcApUJ41_TF2NPsP61yp-Q.png"/></div></figure><p id="37a0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">哎呀！总共 34491 条信息，其中大部分是她写的。她得听听这个。</p><h1 id="510f" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">第一条和最后一条消息(一天的开始和结束)</h1><p id="8438" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">正如我所说的，我很确定这一点:她通常会开始这一天，而我通常会结束这一天。那位女士总是在说晚安之前就睡觉，而且总是在早上道歉。</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="863c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">早晚信息(第 1-7 行)</strong></p><ul class=""><li id="7a3d" class="my mz it ki b kj kk kn ko kr na kv nb kz nc ld nd ne nf ng bi translated"><strong class="ki iu">第 2 行</strong>:在这一行中，我们按照<strong class="ki iu">日期</strong>和<strong class="ki iu">时间</strong>对数据帧进行排序，这样我们就可以将第一天的消息放在当天聊天的顶部。我们还删除了重复的消息，这样我们就可以在每天的数据帧中保留最早的消息。最后，我们统计每个<strong class="ki iu">发送者</strong>的早期消息。</li><li id="9e22" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated">第 3 行:输出(早间消息)</li></ul><pre class="mt mu mv mw gt no mr np nq aw nr bi"><span id="9580" class="ns lm it mr b gy nt nu l nv nw">My Wife, I LOVE YOU ❤    157<br/>koech christian           63</span></pre><ul class=""><li id="f21d" class="my mz it ki b kj kk kn ko kr na kv nb kz nc ld nd ne nf ng bi translated">第 11 行:输出(当天的最后一条消息)</li></ul><pre class="mt mu mv mw gt no mr np nq aw nr bi"><span id="2bcf" class="ns lm it mr b gy nt nu l nv nw">koech christian          156<br/>My Wife, I LOVE YOU ❤     64</span></pre><div class="mt mu mv mw gt ab cb"><figure class="oa ju ob oc od oe of paragraph-image"><img src="../Images/0e60da3937134694ccfc82d3a38bc7c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*lJbdxIzPCqTNAXviYw8ayA.png"/></figure><figure class="oa ju ob oc od oe of paragraph-image"><img src="../Images/a5c870eda72b33b099591e14c30a73c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*D--IOEKicwgCNmeg1GPiXg.png"/></figure></div><p id="9baa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">惊人的发现！的确，大多数日子里她写第一条信息，而大多数晚上我写最后一条信息。更令人惊讶的是它们的对称程度。这就好像我们在平等地进行“晨跑”和“夜跑”。</p><p id="8764" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">自从我们开始这段关系到现在，我一直不明白为什么她总是不说晚安就睡觉。开始的时候我很不舒服，但是我最终接受了那个层次的她。</p><h1 id="f988" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">一段时间内每天的邮件数量</h1><p id="a101" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">嗯，对于这一个，我知道期待什么，但我不知道理想的关系应该是怎样的。当关系变得稳固时，发信息的速度是否会下降，或者下降意味着一段失败的关系？我不知道，但对我来说，我认为有一些因素在起作用。首先，我一直致力于减少我的手机瘾。这可能是下降趋势的一个原因。</p><p id="5c14" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我也希望当我在家(肯尼亚)的时候会有很少的消息，而在这里(南非)会有更多的消息，因为 WhatsApp 现在是主要的沟通渠道。</p><p id="6522" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我看看。</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi og"><img src="../Images/927871c208da7c7d5f8cdcc54e10c383.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Mw7e8jTTx3g1jUcQViung.png"/></div></div></figure><p id="25dc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">看来我的预测是对的。自从我旅行以来，每天的信息数量有所增加，但持续下降。为了真正理解这一点，让我们在上面的图上画一条趋势线，也画一条我出国旅行那天的垂直线。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="5ef1" class="ll lm it bd ln lo oh lq lr ls oi lu lv lw oj ly lz ma ok mc md me ol mg mh mi bi translated"><strong class="ak">趋势平滑</strong></h1><p id="a708" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">有很多方法可以形成平滑的趋势线。这些方法包括重采样和滚动窗口。</p><p id="5c71" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">重采样</strong></p><p id="03e7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将<strong class="ki iu">时间序列数据重新采样到更低或更高的频率通常是有用的。重新采样到较低的频率(<strong class="ki iu">下采样</strong>)通常涉及一个聚合操作——例如，从每日计数中计算每月邮件总数。</strong></p><p id="84b8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">重新采样到更高的频率(<strong class="ki iu">上采样</strong>)不太常见，通常涉及插值或其他数据填充方法，例如，将每日数据插值到每小时间隔中，以输入到模型中。</p><p id="2247" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Pandas <code class="fe mo mp mq mr b">resample()</code>方法，该方法将数据索引分成时间仓，并按时间仓对数据进行分组。<code class="fe mo mp mq mr b">resample()</code>方法返回一个重采样器对象，类似于熊猫<code class="fe mo mp mq mr b">group-by()</code>函数。聚合方法如<code class="fe mo mp mq mr b">mean()</code>、<code class="fe mo mp mq mr b">median()</code>、<code class="fe mo mp mq mr b">sum()</code>等。，然后可以应用于每个时间仓的数据组。</p><p id="529a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">滚动车窗</strong></p><p id="0576" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">滚动窗口</strong>操作是时间序列数据的另一个重要转换。类似于下采样，滚动窗口将数据分成时间窗口和，并且每个窗口中的数据用诸如<code class="fe mo mp mq mr b">mean()</code>、<code class="fe mo mp mq mr b">median()</code>、<code class="fe mo mp mq mr b">sum()</code>等函数聚集。但是，与时间窗不重叠且输出频率低于输入频率的下采样不同，滚动窗口重叠并以与数据相同的频率“滚动”,因此转换后的时间序列与原始时间序列具有相同的频率。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="9126" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于我们的数据，我们将使用滚动窗口来拟合趋势线</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi og"><img src="../Images/86a0ff81afdcdb52d8ca095ce47c0f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rKruDmp1NkpHtoibzmu0rA.png"/></div></div></figure><p id="ac55" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从上图中，我们可以看到趋势线(窗口大小为 50 天)实际上与我们的预测相匹配。在我旅行之前(洋红色垂直线的左边)，我们使用 WhatsApp 的频率比旅行之后(右手边)要少。同样清楚的是，每天的消息数量正在随着时间的推移而下降。</p><h1 id="ab64" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated"><strong class="ak">一天中最大和最小的消息数量</strong></h1><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="2ff7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最大:一天 461 条消息。日期:2020 年 2 月 13 日</p><p id="75fa" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最小:每天 1 条消息。日期:2019 年 12 月 22 日，2020 年 1 月 1 日及其他</p><h1 id="7846" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">实际单词和句子的分析</h1><p id="3798" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">如果我们了解我们每个人使用的常用单词/表情符号，那将会非常有趣。在本节中，我们正是这样做的。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="3cc0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">每位发送者的总字数</strong></p><p id="7a82" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本节中，我们将统计每个发件人的所有消息的所有单词(注意，我们跳过了一些填充词，如下面的<strong class="ki iu">行 10 和 16 </strong>所示的<code class="fe mo mp mq mr b">a</code>、<code class="fe mo mp mq mr b">and</code>、&amp;、<code class="fe mo mp mq mr b">the</code></p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="dbe9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">输出:</p><pre class="mt mu mv mw gt no mr np nq aw nr bi"><span id="303b" class="ns lm it mr b gy nt nu l nv nw">Number of words(Myself): 105612<br/>Number of words(mylove): 113716</span></pre><p id="19a4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">又来了！她赢了！。</p><p id="53ea" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看一下上面的代码片段，这样你就能理解它是做什么的了。</p><ul class=""><li id="a9d8" class="my mz it ki b kj kk kn ko kr na kv nb kz nc ld nd ne nf ng bi translated">第 6 行和第 12 行的 If…else…语句用于调节<strong class="ki iu">发送器上的过滤器。</strong></li><li id="4eab" class="my mz it ki b kj nh kn ni kr nj kv nk kz nl ld nd ne nf ng bi translated">第 8 行和第 14 行在理论上做同样的事情。让我们看一个例子。</li></ul><pre class="mt mu mv mw gt no mr np nq aw nr bi"><span id="4b40" class="ns lm it mr b gy nt nu l nv nw">message = "Okay. Bye for now 💕💕💕💕"</span><span id="8378" class="ns lm it mr b gy nx nu l nv nw">word_list = message.strip().lower().translate(str.maketrans('', '', string.punctuation)).split(" ")</span><span id="a5cf" class="ns lm it mr b gy nx nu l nv nw">print(word_list)</span><span id="dcee" class="ns lm it mr b gy nx nu l nv nw"><strong class="mr iu">Result: </strong>['okay', 'bye', 'for', 'now', '💕💕💕💕']</span></pre><p id="db16" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这部分代码中，我们<strong class="ki iu">剥离</strong>尾部空格的消息，将单词改为<strong class="ki iu">小写</strong>，将标点符号的消息<strong class="ki iu">剥离</strong>(注意句号被剥离)，最后<strong class="ki iu">通过空格分割</strong>消息，这样我们就有了一个单词列表。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="7d4d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">最常见的单词有哪些？随着时间的推移，有哪些独特的词语被使用？</strong></p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="c048" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mo mp mq mr b">collections</code>库中的模块让我们的事情变得简单。在第 4 行和第 5 行，我们计算字数。结果是单词计数元组对的列表，例如，</p><pre class="mt mu mv mw gt no mr np nq aw nr bi"><span id="182e" class="ns lm it mr b gy nt nu l nv nw"><strong class="mr iu">text</strong> = "dog is a pet, hen is a bird"<br/><strong class="mr iu">result</strong> = Counter(text.split()).most_common()<br/><strong class="mr iu">print(result)</strong><br/><strong class="mr iu">[('is', 2), ('a', 2), ('dog', 1), ('pet,', 1), ('hen', 1), ('bird', 1)]</strong></span></pre><p id="1cad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从这里开始，可以通过简单地获得结果列表的长度来确定唯一单词的数量(<strong class="ki iu">第 7–9 行</strong>)。</p><p id="15e9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第 7–9 行的输出:</p><pre class="mt mu mv mw gt no mr np nq aw nr bi"><span id="d2db" class="ns lm it mr b gy nt nu l nv nw">Unique words used:<br/>Unique words She used:  8783<br/>Unique words I used:  7281</span></pre><p id="ec17" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">她又赢了。我不知道这是不是衡量智力的好方法，但我相信她是更聪明的一个。难怪！</p><p id="60a3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们想得到最常用的单词</p><p id="4d7d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意，我们已经在两个变量<code class="fe mo mp mq mr b">most_common_me</code>和<code class="fe mo mp mq mr b">most_common_her</code>中有了最常见的单词。在下面的代码片段中，我们将只选择前 10 个。</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="0eae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦我们有了最常用单词的列表和计数，我们现在就可以把它们放在一个熊猫的数据框架上，还可以制作一些柱状图来直观显示这些单词，如下所示</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="1a41" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">结果:</strong></p><div class="mt mu mv mw gt ab cb"><figure class="oa ju om oc od oe of paragraph-image"><img src="../Images/2e4eab654dd7ecc15b7f528807e16a43.png" data-original-src="https://miro.medium.com/v2/resize:fit:200/format:webp/1*t-Rq8-cu58Lhfw2CtTZv7A.png"/></figure><figure class="oa ju on oc od oe of paragraph-image"><img src="../Images/794b905058e10efb5c69a5e21b96eb9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*glQO-dQ2UvggtDE5sCQVGQ.png"/><p class="kb kc gj gh gi kd ke bd b be z dk oo di op oq translated">她最常用的词</p></figure></div><div class="ab cb"><figure class="oa ju or oc od oe of paragraph-image"><img src="../Images/d354b26cfb686798935d47d7e853af88.png" data-original-src="https://miro.medium.com/v2/resize:fit:224/format:webp/1*Hk-fpFu0NP_q0Pfwq3ioSw.png"/></figure><figure class="oa ju os oc od oe of paragraph-image"><img src="../Images/f9bf91a78a7b803260b9691842f693f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*wZaYPnOIqxqeGa-SISjmww.png"/><p class="kb kc gj gh gi kd ke bd b be z dk ot di ou oq translated">我常用的词</p></figure></div><p id="73ae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">说实话，数据不会说谎。从她的统计数据来看，我对<code class="fe mo mp mq mr b">I, you, my</code>和<code class="fe mo mp mq mr b">love</code>名列榜首并不感到惊讶。她经常使用它们，当她写下像“<em class="ov">我爱你，我的爱人</em>”这样的信息时，我总是不会感到惊讶，哈哈！。另一方面，我最了解的就是如何笑。难怪😂位居前十。但是相信我，我不会用很多表情符号，我可能只知道两个表情符号:😂和🙈。</p><p id="610d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">事实上，让我们继续分析表情符号的用法。</p><h1 id="d120" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated"><strong class="ak">表情符号爱情</strong></h1><p id="1d70" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">表情符号主要用于表达情感，只是一种增加交流乐趣的方式。让我们深入分析一下</p><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><ul class=""><li id="6688" class="my mz it ki b kj kk kn ko kr na kv nb kz nc ld nd ne nf ng bi translated"><strong class="ki iu">Line 1–4</strong>:我们正在使用<code class="fe mo mp mq mr b">emoji</code>包，借助<code class="fe mo mp mq mr b">extract_emojis</code>函数从句子中提取表情符号，例如，</li></ul><pre class="mt mu mv mw gt no mr np nq aw nr bi"><span id="e686" class="ns lm it mr b gy nt nu l nv nw">extract_emojis("K😂ip 😆rono🤣   El😂ij😁 😆ah")</span><span id="671d" class="ns lm it mr b gy nx nu l nv nw">result: '😂😆🤣😂😁😆'</span></pre><ul class=""><li id="ad7b" class="my mz it ki b kj kk kn ko kr na kv nb kz nc ld nd ne nf ng bi translated"><strong class="ki iu">第 6–24 行</strong>:遍历所有消息，并将所有表情提取到发送者列表中。</li></ul><figure class="mt mu mv mw gt ju"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="3b7f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">输出:</p><pre class="mt mu mv mw gt no mr np nq aw nr bi"><span id="5d52" class="ns lm it mr b gy nt nu l nv nw">Most Common emojis used (Me)<br/>('😂', 1652)<br/>('🙈', 270)<br/>('😍', 85)<br/>('😘', 52)<br/>('😋', 45)<br/>Most Common emojis used (Her)<br/>('😂', 1577)<br/>('♀', 132)<br/>('🤦', 120)<br/>('😘', 81)<br/>('❤️', 67)</span></pre><p id="0429" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">情节:</p><div class="mt mu mv mw gt ab cb"><figure class="oa ju ob oc od oe of paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/913d14059cd88582ed9a5cb57d8e5fb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*IUq4x0icU3qUcsAuVaKETg.png"/></div></figure><figure class="oa ju ob oc od oe of paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/e361ecd5590771d198ecb91e5f38aca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*oaX-KC8lU-g0oKsCAFH5QA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk ow di ox oq translated">最常用的表情符号</p></figure></div><p id="f62e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们是最开心的一家人。我们俩都用😂不过当然我用的最多还是比她多。</p><h1 id="fa48" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">时间和活动分析</h1><p id="01e0" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">了解聊天在一段时间内的分布也很有趣。</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/c7b7f42e63fa6b7d2936422bfe6b3226.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*lN3qmxYkgwaP5zEsEaJLeg.png"/></div></figure><p id="ebc5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的确主要在周四和周五聊天，但实际上没什么区别。</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/60d835da944e4f37adf1c7b60a1447c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*JE-cevdLMmIz_H2OfnhqhQ.png"/></div></figure><p id="1082" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上图显示了平均一天的聊天分布。在 0000 到 0500 之间的大多数日子里，我们都在睡觉，因此没有太多的活动。聊天量逐渐增加，在 2000 小时到 2100 小时之间达到峰值，然后随着我们继续睡觉，聊天量迅速下降。</p><p id="0566" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我做的最后一项分析是确定我们写过的最长的信息，</p><figure class="mt mu mv mw gt ju gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/82d5472cc9a52b089c877b1ba02413a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:240/format:webp/1*ZDeDkYvRXP5E9W5pN9S8OQ.png"/></div></figure><p id="1ff1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">再一次，她用她自己最长的包含 166 个单词的信息来引导我，而我只有 62 个单词。</p><h1 id="7c1b" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated"><strong class="ak">结论</strong></h1><p id="4bf7" class="pw-post-body-paragraph kg kh it ki b kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz mn lb lc ld im bi translated">在这篇文章中，我希望你玩得开心，也学到了东西。我们使用 pandas 对数据进行了清理、描述和可视化，通过这样做，你可以做出调整，使你们的关系更好，或者更好地理解字符串操作。</p><p id="e6d0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以使用自己的 WhatsApp 数据按照相同的步骤复制相同的内容。</p><p id="d105" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一如既往，感谢阅读:-)</p></div></div>    
</body>
</html>