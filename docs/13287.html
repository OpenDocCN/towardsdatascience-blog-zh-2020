<html>
<head>
<title>Boxplot for anomaly detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">异常检测的箱线图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/boxplot-for-anomaly-detection-9eac783382fd?source=collection_archive---------15-----------------------#2020-09-12">https://towardsdatascience.com/boxplot-for-anomaly-detection-9eac783382fd?source=collection_archive---------15-----------------------#2020-09-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/86eab4704f9073ee5d3ef8ba992d0e5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7r-aPFW42omeKi-i"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@morningbrew?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">晨酿</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><div class=""/><div class=""><h2 id="361f" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">小型数据科学</h2></div></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><p id="7237" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">在上一篇文章中，我写了关于使用简单的统计技术 Z-score 检测<a class="ae jg" rel="noopener" target="_blank" href="/z-score-for-anomaly-detection-d98b0006f510">异常值的文章。虽然这是一种创建筛选异常值的过滤器的简单方法，但还有一种更好的方法——使用箱线图。</a></p><p id="5deb" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">箱线图是理解单变量和分类数据的分布、离散和变化的极好的统计技术——所有这些都在一个图中。</p><p id="16fd" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">本文的目的是介绍 boxplot 作为异常值检测工具，我主要关注以下几个方面:</p><ul class=""><li id="ee9d" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">箱线图背后的统计直觉</li><li id="3a83" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">如何在异常值检测中使用它们</li><li id="c2d1" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">一点点编程</li></ul><h2 id="8c13" class="mp mq jj bd mr ms mt dn mu mv mw dp mx lo my mz na ls nb nc nd lw ne nf ng nh bi translated"><strong class="ak">箱线图:一种直觉</strong></h2><p id="e86e" class="pw-post-body-paragraph lf lg jj lh b li ni kk lk ll nj kn ln lo nk lq lr ls nl lu lv lw nm ly lz ma im bi translated">箱线图是可视化数据相对于中心值的分布的有效工具。我真的不认为你需要了解很多细节，但下面是一个简单的描述，给一点它如何在引擎盖下工作的直觉。如果你没有 100%得到，也不要难过。</p><p id="17de" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">一张图胜过千言万语，所以不要用文字来描述这个概念，只需自上而下地看一下下图，就可以建立自己的直觉。这一切都始于一个由七个观察值组成的小数据集:1，6，5，4，4，7，8。</p><figure class="no np nq nr gt iv gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/fbbb1e5d1ec70b995ba1a01ffb3b4c62.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*tiTRiporD0hWcnF6BC89jg.png"/></div></figure><p id="ad0f" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">如果把数据从小到大重新排列，中点就是中位数。中位数将数据分成两半。每一半的中点称为“四分位数”。因此，我们得到两个四分位数，第一个四分位数是上半年的中点，第三个四分位数是下半年的中点。当您从顶部开始执行这些步骤时，在图的最后部分，您会看到一个箱线图及其包含的数据。</p><p id="d608" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">从统计学上来说，箱线图提供了几条信息，其中两个重要的信息是四分位数，由箱线图的两端表示。这两个四分位数之间的距离称为四分位数间距(IQR)。</p><p id="8bad" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">在下面的盒状图中，盒子的长度是 IQR，最小和最大值由胡须表示。胡须通常延伸到盒子两侧的 1.5*IQR 距离。因此，这些 1.5*IQR 值之外的所有数据点都被标记为异常值。</p><figure class="no np nq nr gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ns"><img src="../Images/d41c4f98986e6947a8e4fcde4f45e6bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8lzi5NGN87MPJ72qBr4nbg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">与箱线图和异常值位置相关的统计概念</p></figure><p id="0415" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">如果你有正确的直觉，理解一个“离群值”是如何发挥作用的并不困难。查看下图。</p><figure class="no np nq nr gt iv gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/fa6563bf979184261bf26d382671a9bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*Zu8nukykzAUPjaVD_9FwsA.png"/></div></figure><p id="6a1f" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">通常，最小值和最大值之外的任何数据点(由框两端的胡须表示)都被视为异常值。</p><h2 id="d4c3" class="mp mq jj bd mr ms mt dn mu mv mw dp mx lo my mz na ls nb nc nd lw ne nf ng nh bi translated">Python 中的示例</h2><p id="3f83" class="pw-post-body-paragraph lf lg jj lh b li ni kk lk ll nj kn ln lo nk lq lr ls nl lu lv lw nm ly lz ma im bi translated">同样，如果你没有 100%理解统计概念，不要生气。我们可以在不了解很多机械原理的情况下驾驶汽车。但是我们必须知道如何开车！</p><p id="c4d8" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">就像知道如何开车一样，理解如何实现一个算法是业务中最重要的部分。下面是用 Python 构建编程直觉的一小段代码。</p><pre class="no np nq nr gt nv nw nx ny aw nz bi"><span id="ff63" class="mp mq jj nw b gy oa ob l oc od"># import libraries<br/>import numpy as np<br/>import seaborn as sns<br/>sns.set_style("whitegrid")</span><span id="d71b" class="mp mq jj nw b gy oe ob l oc od"># data<br/>data = [1, 4, 4, 5, 6, 7, 8, 13]</span><span id="a76c" class="mp mq jj nw b gy oe ob l oc od"># create boxplot<br/>sns.boxplot(y = data)</span></pre><figure class="no np nq nr gt iv gh gi paragraph-image"><div class="gh gi of"><img src="../Images/e08d983444ad887d26ce1e69e8d5b2ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*YLWDOQSersxsZ8nfGaCxrQ.png"/></div></figure><p id="39db" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">正如你所看到的，在这个箱线图中有一个异常值非常明显，我们可以很容易地过滤掉它。我们不知道异常值的确切值，但我们知道它大于 12。因此，让我们过滤那些异常值。</p><pre class="no np nq nr gt nv nw nx ny aw nz bi"><span id="22ec" class="mp mq jj nw b gy oa ob l oc od"># filter outliers <br/>outliers = [i for i in data if i &gt; 12]</span><span id="9108" class="mp mq jj nw b gy oe ob l oc od">print("Outliers are: ", outliers)</span></pre><figure class="no np nq nr gt iv gh gi paragraph-image"><div class="gh gi og"><img src="../Images/7252b0c57462b968851f2db623747097.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*_62bacEPCATl_hosbWJkHQ.png"/></div></figure><p id="8e2e" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">现在，箱线图将 13 检测为数据集中的异常值。这个异常值是否是一个异常，这当然是一个不同的问题，只能使用领域知识和其他技术单独回答。</p><h2 id="9acc" class="mp mq jj bd mr ms mt dn mu mv mw dp mx lo my mz na ls nb nc nd lw ne nf ng nh bi translated">结论</h2><p id="5068" class="pw-post-body-paragraph lf lg jj lh b li ni kk lk ll nj kn ln lo nk lq lr ls nl lu lv lw nm ly lz ma im bi translated">本文的目的是给出 boxplot 背后的统计直觉，并通过一点编程示例演示它是如何工作的。箱线图的强大之处在于，您可以“看到”极值，并通过直观的解释来决定异常值的阈值。这里的演示基于单变量数据，但对于多变量数据集和分类值，它也可以以类似的方式工作。</p><p id="ab9d" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">如果你喜欢这篇文章，请随时在<a class="ae jg" href="https://medium.com/@mab.datasc" rel="noopener">媒体</a>或<a class="ae jg" href="https://twitter.com/DataEnthus" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我。</p></div></div>    
</body>
</html>