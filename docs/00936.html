<html>
<head>
<title>Text Analytics in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R中的文本分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/text-analytics-in-r-ae23df8ee928?source=collection_archive---------20-----------------------#2020-01-27">https://towardsdatascience.com/text-analytics-in-r-ae23df8ee928?source=collection_archive---------20-----------------------#2020-01-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="34d1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">马克·吐温著作中的文本标记介绍。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/13886334b0bb9aa8233b022f18c7ede8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rvlPBs5QbWcwkpDx"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">帕特里克·托马索在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><blockquote class="kz"><p id="245d" class="la lb it bd lc ld le lf lg lh li lj dk translated">"经典——一本人们称赞却不去读的书."</p><p id="fad8" class="la lb it bd lc ld lk ll lm ln lo lj dk translated">[人名]马克·吐温(美国幽默大师、小说家、作家、演说家)</p></blockquote><p id="a78b" class="pw-post-body-paragraph lp lq it lr b ls lt ju lu lv lw jx lx ly lz ma mb mc md me mf mg mh mi mj lj im bi translated">希望你已经证明了马克·吐温是错的，并且已经沉迷于他的一部经典作品。如果不是，也许这是一个通过<strong class="lr iu">文本分析</strong>了解他的书的很好的入门。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="13f3" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">什么是文本分析？</h1><p id="a562" class="pw-post-body-paragraph lp lq it lr b ls nj ju lu lv nk jx lx ly nl ma mb mc nm me mf mg nn mi mj lj im bi translated">文本分析是检查文本形式的非结构化数据的过程，以收集关于感兴趣的模式和主题的一些见解。</p><h1 id="0fc7" class="mr ms it bd mt mu no mw mx my np na nb jz nq ka nd kc nr kd nf kf ns kg nh ni bi translated">为什么重要？</h1><p id="4075" class="pw-post-body-paragraph lp lq it lr b ls nj ju lu lv nk jx lx ly nl ma mb mc nm me mf mg nn mi mj lj im bi translated">文本分析之所以重要有很多原因，其中一个主要原因是理解我们每天使用的应用程序和服务中使用的情绪和情感。使用文本分析，我们可以从推文、电子邮件、短信、广告、地图等等中提取有意义的信息。</p><p id="2f3e" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">如果你想更深入地研究这个主题，这里有一本很好的书——《R中的文本挖掘》</p><p id="1db1" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">在本教程中，我将向您展示如何开始使用r中必要的文本分析功能。</p><blockquote class="ny nz oa"><p id="af33" class="lp lq ob lr b ls nt ju lu lv nu jx lx oc nv ma mb od nw me mf oe nx mi mj lj im bi translated">R是一种用于统计计算和图形的语言和环境。</p></blockquote></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="b610" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">入门指南</h1><p id="959d" class="pw-post-body-paragraph lp lq it lr b ls nj ju lu lv nk jx lx ly nl ma mb mc nm me mf mg nn mi mj lj im bi translated">我们将不得不安装<a class="ae ky" href="https://cran.r-project.org/web/packages/gutenbergr/vignettes/intro.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lr iu"> gutenbergr </strong> </a>库，这将使我们能够访问他们的可用书籍/出版物库。</p><p id="19b4" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated"><em class="ob">gutenbergr包帮助你从</em> <a class="ae ky" href="http://www.gutenberg.org/" rel="noopener ugc nofollow" target="_blank"> <em class="ob">项目Gutenberg </em> </a> <em class="ob">集合中下载并处理公有领域作品。这包括用于下载书籍的工具(和剥离页眉/页脚信息)，以及可用于查找感兴趣的单词的完整的古腾堡项目元数据数据集。</em></p><p id="302b" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">让我们在<a class="ae ky" href="https://rstudio.com/" rel="noopener ugc nofollow" target="_blank"> R Studio </a>中安装并加载这个库</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="8fbe" class="ok ms it og b gy ol om l on oo">install.packages("gutenbergr")</span><span id="f3e3" class="ok ms it og b gy op om l on oo">library(gutenbergr)</span></pre></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="77e1" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">马克·吐温的书</h1><p id="b291" class="pw-post-body-paragraph lp lq it lr b ls nj ju lu lv nk jx lx ly nl ma mb mc nm me mf mg nn mi mj lj im bi translated">现在，我们将从古腾堡图书馆调出几本马克·吐温写的书。</p><ul class=""><li id="6278" class="oq or it lr b ls nt lv nu ly os mc ot mg ou lj ov ow ox oy bi translated">《哈克贝利·费恩历险记》</li><li id="1213" class="oq or it lr b ls oz lv pa ly pb mc pc mg pd lj ov ow ox oy bi translated">汤姆·索耶历险记</li><li id="a84d" class="oq or it lr b ls oz lv pa ly pb mc pc mg pd lj ov ow ox oy bi translated"><a class="ae ky" href="https://www.amazon.com/Innocents-Abroad-Mark-Twain/dp/1710688718/ref=sr_1_2_sspa?keywords=The+Innocents+Abroad&amp;qid=1579914224&amp;s=books&amp;sr=1-2-spons&amp;psc=1&amp;spLa=ZW5jcnlwdGVkUXVhbGlmaWVyPUEzRkdWMFcxTDAxMzlXJmVuY3J5cHRlZElkPUEwNjUzMzUyQk1ZVEFLNlgxSVVOJmVuY3J5cHRlZEFkSWQ9QTAxODA1NTZTRVo2NFpPQjUyNksmd2lkZ2V0TmFtZT1zcF9hdGYmYWN0aW9uPWNsaWNrUmVkaXJlY3QmZG9Ob3RMb2dDbGljaz10cnVl" rel="noopener ugc nofollow" target="_blank">国外的无辜者</a> — gutenbergr ID: 3176</li><li id="ca7b" class="oq or it lr b ls oz lv pa ly pb mc pc mg pd lj ov ow ox oy bi translated"><a class="ae ky" href="https://www.amazon.com/Life-Mississippi-Signet-Classics-Twain/dp/0451531205/ref=sr_1_3?keywords=Life+on+the+Mississippi&amp;qid=1579914243&amp;s=books&amp;sr=1-3" rel="noopener ugc nofollow" target="_blank">密西西比河上的生活</a> —古滕贝格ID: 245</li></ul><p id="7303" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">在古腾堡图书馆，每本书都有一个ID号，我们需要用它来识别它们的位置。</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="bfb1" class="ok ms it og b gy ol om l on oo">mark_twain &lt;- gutenberg_download(c(<strong class="og iu">76</strong>, <strong class="og iu">74</strong>, <strong class="og iu">3176</strong>, <strong class="og iu">245</strong>))</span></pre><p id="02ac" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">我们使用gutenberg_download函数提取图书，并将其保存到mark_twain数据框中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/b1fa1a551ea748f4eb59581901585900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*G1f8EGYkttZAtkzjKrz9Nw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">mark_twin数据帧的快照</p></figure><p id="9b33" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">通过使用R，书籍被放入特定的行，并被标记到与书籍ID号相对应的列。很明显，这些数据是杂乱的，目前对分析没有太大用处。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="d735" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">识别停用词</h1><p id="3b5b" class="pw-post-body-paragraph lp lq it lr b ls nj ju lu lv nk jx lx ly nl ma mb mc nm me mf mg nn mi mj lj im bi translated">当您分析任何文本时，总是会有冗余的单词，这些单词会根据您试图识别的模式或趋势而扭曲结果。这些被称为<a class="ae ky" href="https://whatis.techtarget.com/definition/stop-word" rel="noopener ugc nofollow" target="_blank">停止字</a>。</p><p id="b5eb" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">您可以决定是否要删除停用字词，但在本例中，我们将继续删除它们。</p><p id="a3bd" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">首先，我们需要加载库<em class="ob"> tidytext。</em></p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="d19e" class="ok ms it og b gy ol om l on oo">library(tidytext)</span></pre><p id="be54" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">接下来，我们将查看整个R数据库中的stop_words(不在马克·吐温的书中)</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="aa29" class="ok ms it og b gy ol om l on oo">data(stop_words)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/9748f831f55bc0d405efba886ac5afd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*nudBTQ7hHgSBwvNcnmeZhg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">stop_words函数的前几行视图</p></figure><p id="a3df" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated"><strong class="lr iu">注意我们有1，139行。</strong></p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="f556" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">标记和删除停用词</h1><p id="0057" class="pw-post-body-paragraph lp lq it lr b ls nj ju lu lv nk jx lx ly nl ma mb mc nm me mf mg nn mi mj lj im bi translated">现在，我们将使用<em class="ob"> dplyr </em>库中的管道方法来删除停用词并标记我们的文本。</p><blockquote class="ny nz oa"><p id="1473" class="lp lq ob lr b ls nt ju lu lv nu jx lx oc nv ma mb od nw me mf oe nx mi mj lj im bi translated"><a class="ae ky" href="https://nlp.stanford.edu/IR-book/html/htmledition/tokenization-1.html" rel="noopener ugc nofollow" target="_blank">标记化</a>的任务是把它分割成小块</p></blockquote><p id="b6f1" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">把标记化想象成逐字分解一个句子。这使得文本分析软件能够为分析提供更多的结构。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/be226ddf53bd354bb4bf4e58d482fefa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*6CQGW5cuXzq6F7QV2tvqwg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:斯坦福大学自然语言处理——标记化示例</p></figure><p id="9aa1" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">我们将通过管道将几个步骤连接在一起，在对<em class="ob"> mark_twain </em>数据帧进行令牌化的同时移除停止字。</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="e8fb" class="ok ms it og b gy ol om l on oo">library(dplyr)</span><span id="1bbb" class="ok ms it og b gy op om l on oo">tidy_mark_twain &lt;- mark_twain %&gt;%<br/>  unnest_tokens(word, text) %&gt;% #<strong class="og iu">tokenize</strong> <br/>  anti_join(stop_words) #<strong class="og iu">remove stop words</strong></span><span id="d48e" class="ok ms it og b gy op om l on oo">print(tidy_mark_twain)</span></pre><p id="6e25" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">步骤:</p><ol class=""><li id="327c" class="oq or it lr b ls nt lv nu ly os mc ot mg ou lj ph ow ox oy bi translated">使用u <a class="ae ky" href="https://www.rdocumentation.org/packages/tidytext/versions/0.2.2/topics/unnest_tokens" rel="noopener ugc nofollow" target="_blank"> nnest_tokens() </a>公式并在输入中传递来指定我们想要标记的内容以及从哪里访问文本。</li><li id="f7f3" class="oq or it lr b ls oz lv pa ly pb mc pc mg pd lj ph ow ox oy bi translated">使用<a class="ae ky" href="http://zevross.com/blog/2014/08/05/using-the-r-function-anti_join-to-find-unmatched-records/" rel="noopener ugc nofollow" target="_blank"> anti_join() </a>，我们基本上排除了在停用字词数据库中找到的所有字词。</li><li id="6aa5" class="oq or it lr b ls oz lv pa ly pb mc pc mg pd lj ph ow ox oy bi translated">我们将所有的工作保存在一个新的变量中。</li><li id="ce8d" class="oq or it lr b ls oz lv pa ly pb mc pc mg pd lj ph ow ox oy bi translated">如果你看看</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/3a737dd3fa71a250400071d161899517.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*Id9xsdmsN6iRU5FJPBV0Jw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们可以看到单词没有被单独分开，并且图书ID被标记在上面</p></figure><p id="db09" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">您是否注意到，由于每个对象都被标记化了，我们现在有<strong class="lr iu"> 182，706 </strong>行！与<strong class="lr iu">相比，我们更早得到了1139行</strong>。这是因为每个单词都有自己的一行。</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="3b09" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">词的频率分布</h1><p id="76b7" class="pw-post-body-paragraph lp lq it lr b ls nj ju lu lv nk jx lx ly nl ma mb mc nm me mf mg nn mi mj lj im bi translated">我们的目标是找到数据中的模式，所以一个很好的方法来查看哪些词是排序和找到最常用的词。</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="0725" class="ok ms it og b gy ol om l on oo">tidy_mark_twain %&gt;%<br/>  count(word, sort=TRUE)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/a8b746a7b2ed002bb5b2b05fcf1e4142.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*hVB-4yg_qXzRNJiamNtmgQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最流行的词是<strong class="bd pk">时间。</strong></p></figure><p id="4298" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">如果你读过马克·吐温的任何一本书，毫无疑问汤姆是第二个最受欢迎的单词，但有趣的是看到单词<strong class="lr iu"><em class="ob"/></strong>是最频繁使用的单词——1226！</p></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="e13e" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">可视化数据</h1><p id="7f95" class="pw-post-body-paragraph lp lq it lr b ls nj ju lu lv nk jx lx ly nl ma mb mc nm me mf mg nn mi mj lj im bi translated">使用ggplot2库，我们可以添加一些可视上下文来查看哪些单词是最常用的。</p><pre class="kj kk kl km gt of og oh oi aw oj bi"><span id="23fa" class="ok ms it og b gy ol om l on oo">library(ggplot2)</span><span id="f701" class="ok ms it og b gy op om l on oo">freq_hist &lt;-tidy_mark_twain %&gt;%<br/>  count(word, sort=TRUE) %&gt;%<br/>  filter(n &gt; 400) %&gt;%<br/>  mutate(word = reorder(word,n )) %&gt;%<br/>  ggplot(aes(word, n))+<br/>  geom_col(fill= 'lightgreen')+<br/>  xlab(NULL)+<br/>  coord_flip()</span><span id="af63" class="ok ms it og b gy op om l on oo">print(freq_hist)</span></pre><p id="c8d1" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">完成了一些关键步骤来提供清晰的图表:</p><ol class=""><li id="fff2" class="oq or it lr b ls nt lv nu ly os mc ot mg ou lj ph ow ox oy bi translated"><strong class="lr iu"> filter() </strong> —确保我们不会查看所有单词的总字数，因为那样会太多。这里我们设置了一个超过400个计数的单词边界。</li><li id="2edd" class="oq or it lr b ls oz lv pa ly pb mc pc mg pd lj ph ow ox oy bi translated"><strong class="lr iu"> mutate() </strong> —提供更好的单词组织顺序。</li><li id="91f1" class="oq or it lr b ls oz lv pa ly pb mc pc mg pd lj ph ow ox oy bi translated"><strong class="lr iu"> coord_flip() </strong> —旋转图形，使其看起来更美观。</li></ol><p id="ddb3" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">如果剩下的代码面生，可以查看我的<a class="ae ky" rel="noopener" target="_blank" href="/introduction-to-ggplot2-in-r-4db4f720f505"> <strong class="lr iu"> ggplot教程</strong> </a>了解更多。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/c0ae75d4f2048fa11e7140d7ce8d2644.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*DPYhZt5QV2Yo0kIoiW36Vg.png"/></div></figure></div><div class="ab cl mk ml hx mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="im in io ip iq"><h1 id="2f5f" class="mr ms it bd mt mu mv mw mx my mz na nb jz nc ka nd kc ne kd nf kf ng kg nh ni bi translated">概观</h1><p id="534f" class="pw-post-body-paragraph lp lq it lr b ls nj ju lu lv nk jx lx ly nl ma mb mc nm me mf mg nn mi mj lj im bi translated">文本无处不在，这意味着有无限的机会来分析和理解非结构化数据。现在你有了一个基础，应该可以帮助你开始你的文本分析之旅。</p><p id="1a45" class="pw-post-body-paragraph lp lq it lr b ls nt ju lu lv nu jx lx ly nv ma mb mc nw me mf mg nx mi mj lj im bi translated">请继续关注——我将分享更多关于使用Twitter的API提取和抓取推文的教程。</p></div></div>    
</body>
</html>