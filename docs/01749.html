<html>
<head>
<title>What I like from Pandas V1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我喜欢V1熊猫的什么</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/what-i-like-from-pandas-v1-5d9108d9c176?source=collection_archive---------36-----------------------#2020-02-17">https://towardsdatascience.com/what-i-like-from-pandas-v1-5d9108d9c176?source=collection_archive---------36-----------------------#2020-02-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ddd4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">熊猫1.0.0更新简介</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f10fcc419ab742ba5d9b24040251f8f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yu6tHUs6u02zKdFguhpT0g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://en.wikipedia.org/wiki/Pandas_(software)" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="7d06" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">毫无疑问，Pandas已经成为Python社区中数据科学的重要组成部分。几乎所有的数据操作都以熊猫为基本步骤。2020年，熊猫发布了它的1.0.0版本，让我撞见了它们的<code class="fe mc md me mf b">Documentation Page</code>并发现了很酷的功能。在所有的特性中，这里是我最喜欢的</p><h1 id="0eaa" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">将数据帧转换为降价</h1><p id="9c7d" class="pw-post-body-paragraph lg lh it li b lj my ju ll lm mz jx lo lp na lr ls lt nb lv lw lx nc lz ma mb im bi translated">假设我们有这样一个数据框架(确保您使用的是1.0.0版或更高版本)</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/504f210232b39c3bbe015e5217fec0ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*QB6dFnAFPkVA168Ky-KAaA.png"/></div></figure><p id="4d3e" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我每天都在使用markdown(和latex)来写报告、文章或手册。和桌子是非常重要的一部分。我几乎所有的作品都包含一个表格。把一个表格剪成<code class="fe mc md me mf b">.png </code>文件并不是我真正擅长的，而且文件更大。所以我总是以访问<a class="ae ky" href="https://www.tablesgenerator.com/markdown_tables" rel="noopener ugc nofollow" target="_blank">表格生成器</a>告终。</p><p id="b975" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我发现有一个<code class="fe mc md me mf b">DataFrame.to_markdown</code>方法真的很有帮助。我可以直接从pandas打印我的表格到markdown支持的文档。这是我最喜欢的。只要做一个<code class="fe mc md me mf b">pd.to_markdown()</code>，我就可以得到它的降价形式。</p><p id="6555" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">注意:你需要一个<code class="fe mc md me mf b">tabulate</code>库来完成。使用<code class="fe mc md me mf b">$ pip install tabulate</code>安装</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/79c69b70217b22db5ce0d73d36c3ba79.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*MIjJDDKWDXiujv6If3BN-A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">降价格式结果中的df</p></figure><h1 id="c4c8" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">新数据类型</h1><p id="47f6" class="pw-post-body-paragraph lg lh it li b lj my ju ll lm mz jx lo lp na lr ls lt nb lv lw lx nc lz ma mb im bi translated">Pandas会自动设置数据类型。但是，<code class="fe mc md me mf b">string</code>或除其<a class="ae ky" href="https://stackoverflow.com/questions/29245848/what-are-all-the-dtypes-that-pandas-recognizes" rel="noopener ugc nofollow" target="_blank">扩展类型</a>之外的任何非基本数据类型都将被转换为<code class="fe mc md me mf b">object</code>。</p><p id="ef0a" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在熊猫1.0.0中，他们为<code class="fe mc md me mf b">string</code>和<code class="fe mc md me mf b">boolean</code>发布了自己专用的数据类型(之前用的是<code class="fe mc md me mf b">numpy</code>)。而且他们还让<code class="fe mc md me mf b">DataFrame.convert_dtypes</code>自动把数据类型改成最合适的。</p><p id="3146" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">看看下面的区别</p><div class="kj kk kl km gt ab cb"><figure class="nh kn ni nj nk nl nm paragraph-image"><img src="../Images/6e0ba20f83f3283723f0172f2994ea75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*jxtX_XeQGJrTg3ffBqboPw.png"/></figure><figure class="nh kn nn nj nk nl nm paragraph-image"><img src="../Images/b1fb1efe3e5f52006a235f637064d04d.png" data-original-src="https://miro.medium.com/v2/resize:fit:560/format:webp/1*K9tCZ1dZVDyRIjv9esaEfA.png"/><p class="ku kv gj gh gi kw kx bd b be z dk no di np nq translated">已转换数据帧(左)和未转换数据帧(右)的数据类型</p></figure></div><p id="f80c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">没有什么真正影响到我，因为我不太喜欢优化数据类型的使用。相反，我通常以矢量化或类似的方式结束，并将它们作为张量进行处理。</p><p id="2419" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">但是，显式地使用<code class="fe mc md me mf b">string</code>而不是<code class="fe mc md me mf b">object</code>将帮助我快速判断我的数据。</p><p id="ac57" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在，让我们试试另一件事如何使用一些重新索引。观察数据类型是如何变化的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/48c697a8ffb85775d51ba48775dc4085.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*-fZCEnbBtC12ZB7Len8K0A.png"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/b6637b49d3584c238f3cff9800963934.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/format:webp/1*3AeaXdjWOmJPzhi5_OolkQ.png"/></div></figure><p id="5b48" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">仔细检查丢失的值。Pandas默认情况下(在撰写本文时)将缺少的值更改为<code class="fe mc md me mf b">np.NaN</code>。</p><p id="7e7a" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">然而，熊猫1.0.0实际上支持<code class="fe mc md me mf b">NaN</code>数据类型，称为<code class="fe mc md me mf b">pd.NA</code>。当我们<code class="fe mc md me mf b">convert_dtypes</code>时，<code class="fe mc md me mf b">NaN</code>值将被转换成<code class="fe mc md me mf b">pd.NA</code>。参见下面的例子</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/887a831c59205b6eaa8b3cfe29f5724f.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*uyh4Flkx8OPHRbgJ0OEm-g.png"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/a09e365c209bb88d93151a64a152878f.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*tGVg-Gq4O0yu5_8MVSHbvw.png"/></div></figure><p id="75d3" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果您看到了差异，向未转换的数据帧中添加一个缺失值会将数据类型更改为<code class="fe mc md me mf b">object</code>。另一方面，转换后的datframe dtypes支持缺失值，因此它们不会更改数据类型。这使数据帧进入<strong class="li iu">一致性</strong>。这是我长久以来一直在寻找的。</p><p id="5327" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">熊猫。那</p><p id="c619" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><code class="fe mc md me mf b">Pandas.Na</code>是缺失值的pandas数据类型(通常称为<code class="fe mc md me mf b">NaN</code>)。正如我们之前演示的，默认情况下，pandas将缺失值设置为not as <code class="fe mc md me mf b">pd.NA</code>。这是因为pandas数据类型是基于numpy构建的，所以它是一个<code class="fe mc md me mf b">numpy.nan</code>。为了改变它，我们必须手动将数据类型从<code class="fe mc md me mf b">numpy</code>改变为<code class="fe mc md me mf b">pandas</code>(您可以使用<code class="fe mc md me mf b">convert_dtypes</code>)。</p><p id="304c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">当我想选择<code class="fe mc md me mf b">pandas</code>数据类型而不是<code class="fe mc md me mf b">numpy</code>时，我想向您展示一个场景。比方说，我们有缺失的值。如果我们要通过一些特定的值来使用<code class="fe mc md me mf b">fillna</code>，那么<code class="fe mc md me mf b">NaN</code>发生了变化，而且还改变了数据类型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/d22d417ea975d2c92fe68399b0711bff.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*RUT6DcNLLqw41AJabpkfxA.png"/></div></div></figure><p id="5cb0" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在，最重要的是，pandas数据类型(在<code class="fe mc md me mf b">convert_dtypes()</code>之后)在某种程度上不能被改变。与前面的示例不同，用string填充整数缺失值可能会导致错误。这种稳健性正是我们在数据中所需要的。看看下面出现的错误</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/d55c97646c444742fefa85426cd5d603.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JIAhZht5yWf6W-kTDDUhAg.png"/></div></div></figure><h1 id="513c" class="mg mh it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">结论</h1><p id="d097" class="pw-post-body-paragraph lg lh it li b lj my ju ll lm mz jx lo lp na lr ls lt nb lv lw lx nc lz ma mb im bi translated">Pandas新的专用数据类型带来了与以前版本的对比差异。尽管在某些情况下使用不合适，但这些新类型是一个很大的进步。</p><p id="eab5" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">将<code class="fe mc md me mf b">DataFrame</code>转换为markdown格式的新方法也对作者产生了很大的影响，尤其是在处理大量数据时。</p><p id="bdb4" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">熊猫v1更新还有很大的使用潜力。请看一下它的<a class="ae ky" href="https://pandas.pydata.org/docs/whatsnew/v1.0.0.html" rel="noopener ugc nofollow" target="_blank">文档页面</a></p></div></div>    
</body>
</html>