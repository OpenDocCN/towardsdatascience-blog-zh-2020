<html>
<head>
<title>Analyze the linear classifier confusion matrix within the medical context.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分析医学背景下的线性分类器混淆矩阵。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyze-the-linear-classifier-confusion-matrix-within-the-medical-context-62bbd9f3d82?source=collection_archive---------58-----------------------#2020-05-04">https://towardsdatascience.com/analyze-the-linear-classifier-confusion-matrix-within-the-medical-context-62bbd9f3d82?source=collection_archive---------58-----------------------#2020-05-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/43d644c260c315b7fd3dbf4d3ca41299.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y4mjEWSI8ES6iROSBJHU3g.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">Jules Bss 在<a class="ae kf" href="https://unsplash.com/s/photos/confusion?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="2912" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">构建分类模型时，最具挑战性的任务是评估性能。广泛使用的一个基本指标是混淆矩阵。在本教程中，我将尝试解释混淆矩阵和正确的阅读方法。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="3dad" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated"><strong class="ak">覆盖的是什么？</strong></h1><ul class=""><li id="f030" class="mj mk it ki b kj ml kn mm kr mn kv mo kz mp ld mq mr ms mt bi translated">混淆矩阵结构和术语。</li><li id="9655" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated">一类和二类错误。</li><li id="6d7e" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated">准确性悖论。</li><li id="2d85" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated">精确度和召回率。</li><li id="68c1" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated">累积精度曲线— CAP 分析</li><li id="6a99" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated">受试者工作特征— ROC 分析</li><li id="b117" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated">曲线下面积——AUC</li><li id="60f4" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated">延伸阅读—发表的学术论文。</li></ul></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="8598" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">1.什么是混淆矩阵？</h1><p id="c2bc" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">它是一个维数为 N*N 的矩阵，允许从分类模型中提取有意义的度量，这有助于评估性能。它被视为预测质量的总结报告。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h2 id="0cb9" class="nc lm it bd ln nd ne dn lr nf ng dp lv kr nh ni lz kv nj nk md kz nl nm mh nn bi translated">怎么读？</h2><p id="78cd" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">混淆矩阵的水平轴代表实际值，而垂直轴代表预测值。例如，在下面演示的 2X2 混淆矩阵中，有两个数据类；阳性病例(1)和阴性病例(0)。模型的阳性预测可能是真阳性或假阳性情况。真正的阳性预测(TP)定义为模型对阳性病例进行正确分类的次数。相比之下，假阳性预测(FP)是模型对阳性病例进行错误分类的次数。同样，真正的负面预测(TN)被定义为模型对负面情况进行正确分类的次数。相反，假阴性预测(FN)是模型对阴性病例进行错误分类的次数。</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div class="gh gi no"><img src="../Images/8ddec39e60b10adf231abff06e5f0506.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*r51vt2uquh1vonValAml0A.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">混乱矩阵解剖学</p></figure><blockquote class="nt nu nv"><p id="edec" class="kg kh nw ki b kj kk kl km kn ko kp kq nx ks kt ku ny kw kx ky nz la lb lc ld im bi translated">正如你可能注意到的，正确的预测落在矩阵对角线上。</p></blockquote><p id="3307" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">FP 也被定义为 I 型错误，它表示我们的模型错误地预测了多少个阴性病例为阳性病例。FN 被认为是第二类错误，它表明我们的模型错误地预测了多少阳性病例为阴性病例。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h2 id="820f" class="nc lm it bd ln nd ne dn lr nf ng dp lv kr nh ni lz kv nj nk md kz nl nm mh nn bi translated">从矩阵中提取度量</h2><p id="7c55" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">可以使用几个重要的度量来评估该模型。我们将一个一个地检查它们。让我们从基本的开始。</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/9b26436482176f736c8f022e16a5c5fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*Vww9zKrwES0wtoV7nC5lCA.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">分类预测模型产生的混淆矩阵示例</p></figure><ol class=""><li id="3573" class="mj mk it ki b kj kk kn ko kr ob kv oc kz od ld oe mr ms mt bi translated">准确性:分类器正确的频率。是对角线值之和与总例数之比:(TP+TN)/(TP+TN+FP+FN)—1500/1650 = 0.91。</li><li id="8b14" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld oe mr ms mt bi translated">错误率:所有错误预测与总案例之间的比率。误差率范围从 0 到 1；最好的是 0，而最差的是 1。(TN)/(TP+TN+FP+FN)—500/1650 = 0.30。</li><li id="9fc1" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld oe mr ms mt bi translated">准确率:所有正面预测与总案例之间的比率。最好的准确率是 1，最差的是 0。(TP)/(TP+TN+FP+FN)—1000/1650 = 0.61。</li><li id="f682" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld oe mr ms mt bi translated">特异性(阴性率):真阴性与真阴性和假阳性之和的比率。(TN)/(TN+FP) — 500/600 = 0.80。</li></ol></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="6549" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，仅仅考虑准确性不足以恰当地评估模型。一个模型可能有很高的精确度，但在预测中并不可靠，这是由于类别不平衡造成的。因此，除了准确性之外，还有其他用于评估的方法，如精确度和召回率。</p><ol class=""><li id="e5dc" class="mj mk it ki b kj kk kn ko kr ob kv oc kz od ld oe mr ms mt bi translated">精确度:有多少被预测为阳性的结果是真正的阳性病例。要确定模型精度，请计算真阳性与真阳性和假阴性之和之间的比率。(TP) / (TP + FP) — 1000/1100 = 0.90。</li><li id="6a77" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld oe mr ms mt bi translated">回忆(敏感度):假设案例确实是阳性的，那么案例是阳性的频率。(TP) /(TP + FN) — 1000/1050 = 0.95。</li></ol><p id="3c2f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这种情况下，我们可以将结果解读为:预测类的 90% <strong class="ki iu">(精度)</strong>原来是 1(正)。而 95%的<strong class="ki iu">(回忆)</strong>阳性类别被模型成功预测。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h2 id="88e7" class="nc lm it bd ln nd ne dn lr nf ng dp lv kr nh ni lz kv nj nk md kz nl nm mh nn bi translated"><strong class="ak">精准与召回</strong></h2><p id="2236" class="pw-post-body-paragraph kg kh it ki b kj ml kl km kn mm kp kq kr mz kt ku kv na kx ky kz nb lb lc ld im bi translated">使用哪一种取决于应用程序和您想要的结果类型。您可能已经注意到，<strong class="ki iu"> Precision 使用 FP(第一类错误)</strong>而<strong class="ki iu"> Recall 使用 FN(第二类错误)</strong>。根据经验，当 FP 或 I 类误差比 II 类误差更重要时，使用 Precision。相反，当假阴性比假阳性更重要时，使用回忆，尤其是在医学研究中。</p><blockquote class="nt nu nv"><p id="372d" class="kg kh nw ki b kj kk kl km kn ko kp kq nx ks kt ku ny kw kx ky nz la lb lc ld im bi translated"><strong class="ki iu"> Precision 使用 FP(第一类错误)</strong>而<strong class="ki iu"> Recall 使用 FN(第二类错误)</strong></p></blockquote></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="254d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如前所述，由于准确性悖论，我们需要更多的方法来评估我们的模型。累积精度曲线 CAP 和接收器工作特性曲线 ROC 就是这些方法中的一种。</p><h1 id="6b48" class="ll lm it bd ln lo of lq lr ls og lu lv lw oh ly lz ma oi mc md me oj mg mh mi bi translated">2.累积精度曲线上限</h1><blockquote class="ok"><p id="5e5f" class="ol om it bd on oo op oq or os ot ld dk translated">通过将曲线与直接获得最大数量正面结果的<strong class="ak">完美上限</strong>和正面结果平均分布的<strong class="ak">随机上限</strong>进行比较，上限可用于评估模型。<a class="ae kf" href="https://en.wikipedia.org/wiki/Cumulative_accuracy_profile" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></blockquote><p id="3a19" class="pw-post-body-paragraph kg kh it ki b kj ou kl km kn ov kp kq kr ow kt ku kv ox kx ky kz oy lb lc ld im bi translated">准确率——曲线下的面积，定义为生成模型下的面积与完美模型下的面积之比(见下图)。该比率范围在 0 和 1 之间，越接近 1 的模型越精确。例如，下面的模型假设联系的客户数量和退货销售之间存在关系。计算返回最大购买量的最小顾客数是一个优化问题。如图所示，好的模型(绿线)越接近完美的模型(蓝线)就越好。</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/44c45045600294b1812cb14248717338.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*JFkssQtdfExjpqGK2TvAvg.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">累积精度曲线— CAP</p></figure><p id="fc6e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些曲线可以根据下表进行评估:</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/7e4f3ee01a119103558abb6c14a3c47b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*1mkfqhY98YVfMwS4UIry0g.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">评估上限时应遵循的假设规则</p></figure></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="dfd0" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">3.接收机工作特性曲线 ROC</h1><blockquote class="nt nu nv"><p id="a94c" class="kg kh nw ki b kj kk kl km kn ko kp kq nx ks kt ku ny kw kx ky nz la lb lc ld im bi translated">累积精度曲线上限<strong class="ki iu">与接收器工作特性曲线 ROC</strong>不同。</p></blockquote><p id="8b7b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">受试者工作特征(ROC)曲线用于更广泛的领域，并经常用于医学研究。ROC 是一种基于两个因素评估模型性能的方法:特异性和敏感性。正如我们前面提到的，敏感性是真阳性率，特异性是假阴性率。ROC 曲线在 y 轴上代表灵敏度，在 x 轴上代表(1-特异性)。每个轴从 0 开始，到 1 结束。</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/4f535e61aef5172180bbd5e323f884c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*WLkptTFxq1QuZmX7Qkh29Q.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">ROC 曲线</p></figure></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="e4d2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更详细地说，假设有三个不同的模型。两个分布之间的重叠区域代表 FN 和 FP，如下图所示。第一个模型代表了一个完美的分类器(完美的分类——没有重叠)。</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/e114cec6d338357e144f7c3324140828.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*jCS7cyeUA76duQMfWLoihQ.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">完美分类器</p></figure><p id="3e53" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第二个模型也被认为是一个好模型。曲线下的面积(AUC)很小，且分布均匀。</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/44e68fab078d522d7bfd5a5243ee91b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*FrrjtwQ9J3L60iztrN1LjQ.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">好的分类器</p></figure><p id="8718" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，最后一个模型是预测模型的坏例子，并且被认为在区分 class_1 和 class_2 方面是弱的。</p><figure class="np nq nr ns gt ju gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/ef95c30fc87f8c44286f7dd9dcde72c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*P8ejPUSsLYKmymNIMoifcw.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">错误的分类器</p></figure><p id="354a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">曲线下面积或 AUC 是用于评估分类器的基本度量，特别是对于不平衡的类别，这是使用 ROC 的一个相当大的好处。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="be7d" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">外卖食品</h1><ul class=""><li id="a05a" class="mj mk it ki b kj ml kn mm kr mn kv mo kz mp ld mq mr ms mt bi translated">在敏感性和特异性之间应该有一个平衡；否则，模型会陷入过度拟合的陷阱。</li></ul><figure class="np nq nr ns gt ju gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/39fccf87d6949882166759f624080fbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*TCM8byWiAVy-atV3oK4Evw.jpeg"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">敏感性和特异性的关系</p></figure><ul class=""><li id="7f90" class="mj mk it ki b kj kk kn ko kr ob kv oc kz od ld mq mr ms mt bi translated">ROC 曲线的解释与累积精确度曲线(CAP)相同。只要模型处于向上的正确方向，它就表现得更好。</li><li id="604d" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated">重要的是要注意，具有有意义的性能水平的分类器通常位于随机(基线)和完美线之间的区域。</li><li id="b540" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated">帽子不摇。</li><li id="4c6b" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated">FN(假阴性)是第二类错误，而 FP(假阳性)是第一类错误。</li><li id="68c7" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated">如果第二类错误对你的模型更重要，使用召回措施；否则使用 type-I 错误。</li><li id="819a" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated">正确的预测落在混乱矩阵的对角线上。</li><li id="c721" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated">该模型不能仅基于准确性进行评估，它可能会由于类别不平衡而产生误导。例如，考虑 ROC AUC 曲线。</li></ul></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><h1 id="5aa8" class="ll lm it bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">参考</h1><ul class=""><li id="cbcd" class="mj mk it ki b kj ml kn mm kr mn kv mo kz mp ld mq mr ms mt bi translated"><a class="ae kf" href="https://www.researchgate.net/publication/314284545_Predictive_Model_for_the_Classification_of_Hypertension_Risk_Using_Decision_Trees_Algorithm" rel="noopener ugc nofollow" target="_blank">使用决策树算法的高血压风险分类预测模型</a></li><li id="6e28" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated"><a class="ae kf" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6068511/" rel="noopener ugc nofollow" target="_blank">跌倒检测技术的真实世界评估方法:范围审查</a></li><li id="71db" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated"><a class="ae kf" href="https://www.ijrte.org/wp-content/uploads/papers/v7i6s/F03250376S19.pdf" rel="noopener ugc nofollow" target="_blank">使用混淆矩阵进行风险评估策略绩效衡量</a></li><li id="d87c" class="mj mk it ki b kj mu kn mv kr mw kv mx kz my ld mq mr ms mt bi translated"><a class="ae kf" href="https://www.fharrell.com/post/mlconfusion/" rel="noopener ugc nofollow" target="_blank">在医疗保健的机器学习预测中，混淆矩阵是一个混淆矩阵</a></li></ul><p id="f3dd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我希望我的帖子能帮助你理解模型评估的不同方法，以及你应该考虑哪一种。感谢阅读！！</p></div></div>    
</body>
</html>