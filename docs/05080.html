<html>
<head>
<title>An Illustrated Guide to the Zero Inflated Poisson Regression Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">零膨胀泊松回归模型图解指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-illustrated-guide-to-the-zero-inflated-poisson-model-b22833343057?source=collection_archive---------4-----------------------#2020-05-02">https://towardsdatascience.com/an-illustrated-guide-to-the-zero-inflated-poisson-model-b22833343057?source=collection_archive---------4-----------------------#2020-05-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/4fa5d03f5ed5d5454ea488264edd08bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Me3lQpAvtdiQ8g0O8wQ6Qw.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://commons.wikimedia.org/wiki/File:Deschutes_Wild_and_Scenic_River_(28260152076).jpg" rel="noopener ugc nofollow" target="_blank">野生与风景河流</a> ( <a class="ae jg" href="https://creativecommons.org/licenses/by/2.0/deed.en" rel="noopener ugc nofollow" target="_blank"> CC BY 2.0 </a>)</p></figure><div class=""/><div class=""><h2 id="bcd1" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">另外还有一个Python教程，介绍如何在有多余零的数据集上训练ZIP模型</h2></div><p id="cf95" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我们将学习如何为基于<strong class="la jk">计数的数据集</strong>构建回归模型，其中因变量包含<strong class="la jk">过量的零值数据</strong>。</p><p id="83be" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">计数数据集</strong>是因变量为事件的数据集，例如:</p><ul class=""><li id="c420" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">每小时通过十字路口的车辆数量。</li><li id="382c" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">每月急诊室就诊次数</li><li id="1e9b" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">每年提出的机动车辆保险索赔数量</li><li id="6bc2" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">在大量生产的印刷电路板中发现的缺陷数量。</li></ul><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/64f9fda29143204139afe105d39492a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*4sguqPtvCtoFhO-1_Gqf1g.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">包含许多零计数的数据集(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="7b21" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">许多真实世界的现象产生的计数几乎总是零。例如:</p><ul class=""><li id="9e6c" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">机器每月发生故障的次数</li><li id="35bc" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">每年发现的系外行星数量</li><li id="c60d" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">生活在世界上每一个城市的亿万富翁的数量。</li></ul><p id="0df7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用传统的计数数据模型，如<a class="ae jg" rel="noopener" target="_blank" href="/an-illustrated-guide-to-the-poisson-regression-model-50cccba15958"><strong class="la jk"/></a><a class="ae jg" rel="noopener" target="_blank" href="/the-binomial-regression-model-everything-you-need-to-know-5216f1a483d3"><strong class="la jk">二项式</strong> </a>或<a class="ae jg" rel="noopener" target="_blank" href="/negative-binomial-regression-f99031bb25b4"> <strong class="la jk">负二项式</strong> </a>回归模型，很难处理这些数据。</p><p id="52bd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是因为此类数据集<strong class="la jk">包含的零值计数数量比使用传统模型的概率分布</strong>预期观察到的数量多。</p><p id="20e2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，如果您假设一个现象遵循以下<em class="mn">泊松(5) </em>过程，您将期望看到零计数不超过0.67%的时间:</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mo"><img src="../Images/bb6417291ed02efe96696b53606f340d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8vpaxISWoxQauPC_Jc8zOQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">泊松(5)过程将在大约0.67%的观测值中产生零(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="cdf2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您观察到的零计数远远多于这个数，那么数据集包含了过多的零。</p><p id="b498" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果对这样的数据集使用标准的泊松或二项式或NB回归模型，它可能拟合得很差，并且会生成质量很差的预测，无论您对其参数做了多少调整。</p><p id="698b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">那么，面对这种带有多余零的数据，建模者该怎么办呢？</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h2 id="65a7" class="mw mx jj bd my mz na dn nb nc nd dp ne lh nf ng nh ll ni nj nk lp nl nm nn no bi translated">零膨胀泊松回归模型</h2><p id="4b38" class="pw-post-body-paragraph ky kz jj la b lb np kk ld le nq kn lg lh nr lj lk ll ns ln lo lp nt lr ls lt im bi translated">幸运的是，有一种方法可以修改标准计数模型，如泊松或负二项式模型，以解释额外零的存在。事实上，至少有两种方法可以做到这一点。一种技术被称为<strong class="la jk">跨栏模式</strong>，第二种技术被称为<strong class="la jk">零充气模式</strong>。</p><p id="1db7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我们将详细研究零膨胀回归模型。具体来说，我们将关注<strong class="la jk">零膨胀泊松回归模型</strong>，通常被称为<strong class="la jk"> ZIP模型</strong>。</p><p id="837e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">ZIP模型的结构</strong></p><p id="4775" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在了解如何修改常规泊松模型的结构以处理过多的零计数之前，让我们先简要了解一下它的结构。</p><p id="10c7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">想象一个数据集，包含<em class="mn"> n </em>个样本和<em class="mn"> p </em>个样本的回归变量。因此，回归变量<strong class="la jk"><em class="mn"/></strong>可以用一个大小为<em class="mn">(n×p)</em>的矩阵来表示，<strong class="la jk"> <em class="mn"> X </em> </strong>矩阵中的每一行<strong class="la jk"> <em class="mn"> x_i </em> </strong>都是一个大小为<em class="mn">(1×p)</em>的向量，对应于因变量值<em class="mn"> y_i </em>:</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/3f806eeaee3092c2bdd75633e2608a34.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*ID8hGhqgsZeay_3R-ZpHgA.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">矩阵符号中的数据集(<strong class="bd nv"> <em class="nw"> y，X </em> </strong>)(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="071d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们假设<strong class="la jk"> <em class="mn"> y </em> </strong>是一个泊松分布的随机变量，我们可以为这个数据集建立一个泊松回归模型。泊松模型由两部分组成:</p><ol class=""><li id="8042" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt nx ma mb mc bi translated">泊松<strong class="la jk"> P </strong>概率<strong class="la jk"> M </strong> ass <strong class="la jk"> F </strong>函数(PMF)表示为<em class="mn"> P(y_i=k) </em>用于计算在给定λ事件/单位时间的平均事件率的情况下，在任何单位间隔内观察到<em class="mn"> k </em>事件的概率。</li><li id="df55" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt nx ma mb mc bi translated">用于将平均速率λ <strong class="la jk"> </strong>表示为回归变量<strong class="la jk"> <em class="mn"> X </em>的函数的链接函数。</strong></li></ol><p id="16e2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下图对此进行了说明:</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ny"><img src="../Images/9e00b85c15ff38db80ca2bc8dfb4f97c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ci0iQSqNzgZFrMIL9AKJZA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">标准泊松回归模型的概率质量函数(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="d95e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通常，我们假设有一些潜在的过程按照泊松<em class="mn"> PMF: P(y_i=k) </em>产生观察到的计数。</p><p id="071a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">零膨胀泊松模型背后的直觉是<strong class="la jk"> <em class="mn">存在第二个潜在过程，该过程确定计数是零还是非零</em> </strong>。一旦计数被确定为非零，常规泊松过程就会根据泊松过程的PMF来确定其实际非零值。</p><p id="ef7e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，<strong class="la jk"> ZIP </strong>回归模型由三部分组成:</p><ol class=""><li id="efbe" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt nx ma mb mc bi translated">PMF <em class="mn"> P(y_i=0) </em>用于计算观察到零计数的概率。</li><li id="4acd" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt nx ma mb mc bi translated">第二个PMF <em class="mn"> P(y_i=k) </em>，用于计算观察到<em class="mn"> k </em>事件的概率，给定k &gt; 0 。</li><li id="5b88" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt nx ma mb mc bi translated">用于将平均速率λ <strong class="la jk"> </strong>表示为回归变量<strong class="la jk"> <em class="mn"> X </em>的函数的链接函数。</strong></li></ol><p id="3c0e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下图对此进行了说明:</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nz"><img src="../Images/a7b89601ee4ab920fce094441999f915.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q9dtw-96AUhEFD920nV3-w.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">ZIP模型的概率质量函数(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="82d8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如前所述，<em class="mn"> y_i </em>是随机变量，表示对应于回归变量行<strong class="la jk"><em class="mn">x _ I</em></strong><em class="mn">=【x _ i1，x_i2，x_i3，…，x_ip】的观察计数。</em></p><p id="2c9e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="mn"> ϕ_i </em>是数据集中第I行<strong class="la jk"><em class="mn">(</em></strong><em class="mn">y _ I</em><strong class="la jk"><em class="mn">，x_i) </em> </strong>对应的多余零的比例的度量；。</p><h2 id="c945" class="mw mx jj bd my mz na dn nb nc nd dp ne lh nf ng nh ll ni nj nk lp nl nm nn no bi translated">了解ϕ_i</h2><p id="3241" class="pw-post-body-paragraph ky kz jj la b lb np kk ld le nq kn lg lh nr lj lk ll ns ln lo lp nt lr ls lt im bi translated">理解<em class="mn"> ϕ_i </em>的简单方法如下:</p><p id="5500" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设你取<em class="mn"> y_i </em>的1000个观测值，每一个都与<strong class="la jk"> <em class="mn">相同</em> </strong>组合的回归变量值<strong class="la jk"><em class="mn">x _ I</em></strong><em class="mn">=【x _ i1，x_i2，x_i3，…，x_ip】。</em>由于<em class="mn"> y_i是</em>一个遵循泊松分布的<em class="mn">随机变量</em>，你可能会在1000次观察的每一次中看到不同的<em class="mn"> y_i </em>值。</p><p id="30fd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设在你观察到的1000个<em class="mn"> y_i </em>值中，你观察到874个零值。您确定在这874个零值中，您为<em class="mn"> y_i </em>假设的常规泊松分布将只能解释最多7个零值。所以剩下的867个零值是多余的零观测值。所以对于数据集中的第<em class="mn">行和第</em>行，<em class="mn"> ϕ_i </em> =867/1000 = 0.867。</p><p id="ce57" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当数据集在因变量中没有任何多余的零时，<strong class="la jk"><em class="mn">【ϕ】</em></strong>的值计算出为零，并且ZIP模型的PMF减少到标准泊松模型的PMF(您可以通过将ZIP模型的PMF中的<strong class="la jk"><em class="mn"/></strong>设置为0来轻松验证这一点)。</p><h2 id="57dd" class="mw mx jj bd my mz na dn nb nc nd dp ne lh nf ng nh ll ni nj nk lp nl nm nn no bi translated">如何估计<em class="nw"> ϕ？</em></h2><p id="85d9" class="pw-post-body-paragraph ky kz jj la b lb np kk ld le nq kn lg lh nr lj lk ll ns ln lo lp nt lr ls lt im bi translated">那么我们如何估算ϕ_i的价值呢？</p><p id="6d14" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">估算<em class="mn"> ϕ_i </em>的一种简单而粗略的方法是将每个<strong class="la jk"><em class="mn">【ϕ】</em></strong><em class="mn">_ I</em>设定为以下比率:</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/6b4b444e18cfa82411e5b77b5fb44914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*brs2O3Bt5BzZ1HJS9SctcQ.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">一种简单但不准确的方法来估计<strong class="bd nv"><em class="nw"/></strong>_ I(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>)</p></figure><p id="7c97" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">也许计算<em class="mn"> ϕ_i </em>的一种更现实的方法是将其作为回归变量<strong class="la jk"> <em class="mn"> X </em> </strong>的函数进行估计。这通常是通过将<strong class="la jk"> <em class="mn"> y </em> </strong>变量转换为二进制0/1随机变量<strong class="la jk"><em class="mn">y’</em></strong>(<strong class="la jk"><em class="mn">y _ prime</em></strong>)来完成的，如果底层的<strong class="la jk"><em class="mn"/></strong>为0，则取值为0，在所有其他情况下取值为1。然后我们在转换后的<strong class="la jk"><em class="mn">y’</em></strong>上拟合一个<strong class="la jk">逻辑回归模型</strong>。然后，我们在数据集[ <strong class="la jk"> <em class="mn"> X，y' </em> </strong> ]上训练逻辑回归模型，并且它产生拟合概率的向量<strong class="la jk"><em class="mn">_拟合的</em> </strong> <em class="mn"> =[ _1，_2，_3，...，_n]，</em>(因为这就是逻辑回归模型所做的)<em class="mn">。</em></p><p id="d28e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦我们得到了<strong class="la jk"><em class="mn">_拟合的</em> </strong> <em class="mn">矢量，我们就简单地把它设置为</em> <strong class="la jk"> <em class="mn">矢量ϕ.</em>T55】</strong></p><p id="aa8d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="mn">从而【ϕ_1= _1，ϕ_2= _2，ϕ_3= _3,…,ϕ_n= _ n】</em>。</p><p id="b1b9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以上估算<strong class="la jk"> <em class="mn"> ϕ </em> </strong>的过程如下图<em class="mn"> : </em></p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ob"><img src="../Images/d5698323054e0910c133486138724d91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eLxe7T8crNog3X7TeohnlQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">估计<em class="nw">多余零点参数</em> <strong class="bd nv"> <em class="nw"> ϕ </em> </strong>的训练序列(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>)</p></figure><p id="9c4b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦估算出了<strong class="la jk"><em class="mn"/></strong>向量，我们就将它插入到ZIP模型的概率函数中，并使用所谓的<strong class="la jk"> M </strong>最大值<strong class="la jk"> L </strong>似然性<strong class="la jk"> E </strong>估计(<strong class="la jk"> MLE </strong>)技术来训练具有超额计数的数据集上的ZIP模型。</p><pre class="mj mk ml mm gt oc od oe of aw og bi"><span id="26b7" class="mw mx jj od b gy oh oi l oj ok">Please see my article on <a class="ae jg" rel="noopener" target="_blank" href="/an-illustrated-guide-to-the-poisson-regression-model-50cccba15958"><strong class="od jk">Poisson Regression Model</strong></a> for an explanation of how <strong class="od jk">MLE </strong>works.</span></pre><p id="9350" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下图说明了<strong class="la jk"> ZIP </strong>模型的训练顺序:</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ol"><img src="../Images/becacb0dd6c2e6f1396d4ffd3dab085d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PYNehN4r7FMMc5bf_YI4Cw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">ZIP模型的训练序列(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="4bb7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">令人欣慰的是，有许多统计软件包可以自动完成估算<strong class="la jk"><em class="mn"/></strong>ϕ的整个过程，并使用估算的<strong class="la jk"><em class="mn"/></strong>ϕ在数据集上使用MLE技术训练ZIP模型。</p><p id="ce07" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文的其余部分，我们将使用Python <em class="mn"> statsmodels </em>库在一行代码中构建和训练一个ZIP模型。</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h2 id="5eaa" class="mw mx jj bd my mz na dn nb nc nd dp ne lh nf ng nh ll ni nj nk lp nl nm nn no bi translated">如何使用Python训练ZIP模型</h2><p id="6c94" class="pw-post-body-paragraph ky kz jj la b lb np kk ld le nq kn lg lh nr lj lk ll ns ln lo lp nt lr ls lt im bi translated">在我们关于ZIP模型的Python教程中，我们将使用250组人进行的野营旅行的数据集:</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi om"><img src="../Images/ede3af68a4395edf9ee88b0e936122c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*u6WyuQDxdA2kuMuUN5pntg.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">野营旅行数据集(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="93aa" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据集在<a class="ae jg" href="https://gist.github.com/sachinsdate/09cfd42b7701c48ec68b04c786786434" rel="noopener ugc nofollow" target="_blank">这里</a>可用。以下是该数据集的几个显著特征:</p><ul class=""><li id="c563" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated">露营者在旅途中可能会也可能不会去钓鱼。</li><li id="7d00" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">如果一群人去钓鱼，他们可能没有或没有钓到鱼。</li><li id="5807" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">我们不仅要估计捕获了多少鱼(如果野营小组进行了捕鱼)，还要估计野营小组捕获任何鱼的概率。</li></ul><p id="2dfd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，这里涉及两个不同的数据生成过程:</p><ol class=""><li id="a4bc" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt nx ma mb mc bi translated">一个决定一个野营团体是否沉迷于一个成功的捕鱼活动的过程:ZIP模型将在内部使用一个逻辑回归模型，该模型在前面已经解释过，用于模拟这个二元过程。</li><li id="fb2f" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt nx ma mb mc bi translated">第二个过程是确定一个野营小组捕获了多少条鱼，假设该小组至少捕获了一条鱼:ZIP模型将使用常规泊松模型来建模第二个过程。</li></ol><p id="b8dc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">数据集中的变量</strong></p><p id="0570" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">野营旅行数据集包含以下变量:</p><p id="f4ab" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">被捕获的鱼的数量。这将是我们的因变量<strong class="la jk"> <em class="mn"> y </em> </strong>。</p><p id="34fc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk"> LIVE_BAIT: </strong>表示是否使用了活诱饵的二元变量。</p><p id="0b84" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">露营车:</strong>钓鱼团是否使用露营车。</p><p id="7232" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">人数:</strong>钓鱼组总人数。注意，在一些群体中，他们可能都没有捕鱼。</p><p id="4620" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">孩子:</strong>露营组的孩子数量。</p><p id="643d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是因变量FISH_COUNT的频率分布:</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi on"><img src="../Images/083148156d60241538734c1a652db026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KDiO-beCUqAx7NZkKROWug.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">FISH_COUNT的频率分布(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a></p></figure><p id="8976" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如我们所看到的，在这个数据集中<em class="mn">可能</em>有多余的零。我们将在这个数据集上训练一个ZIP模型来测试这个理论，并有望实现比常规泊松模型更好的拟合。</p><h2 id="fa0e" class="mw mx jj bd my mz na dn nb nc nd dp ne lh nf ng nh ll ni nj nk lp nl nm nn no bi translated">回归目标</h2><p id="d197" class="pw-post-body-paragraph ky kz jj la b lb np kk ld le nq kn lg lh nr lj lk ll ns ln lo lp nt lr ls lt im bi translated">我们对该数据集的回归目标如下:</p><p id="56b8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">根据LIVE_BAIT、CAMPER、PERSONS和CHILDREN变量的值，预测野营小组捕获的鱼的数量(FISH_COUNT)。</p><h2 id="9c65" class="mw mx jj bd my mz na dn nb nc nd dp ne lh nf ng nh ll ni nj nk lp nl nm nn no bi translated">回归策略</h2><p id="cc0c" class="pw-post-body-paragraph ky kz jj la b lb np kk ld le nq kn lg lh nr lj lk ll ns ln lo lp nt lr ls lt im bi translated">我们的回归策略如下:</p><ol class=""><li id="9c9b" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt nx ma mb mc bi translated">FISH_COUNT将是因变量<strong class="la jk"> <em class="mn"> y </em> </strong>，【LIVE_BAIT，CAMPER，PERSONS，CHILDREN】将是解释变量<strong class="la jk"> <em class="mn"> X </em> </strong>。</li><li id="78f2" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt nx ma mb mc bi translated">我们将使用Python <strong class="la jk"> <em class="mn"> statsmodels库</em> </strong>在(<strong class="la jk"> <em class="mn"> y，X </em> </strong>)数据集上训练ZIP回归模型。</li><li id="7816" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt nx ma mb mc bi translated">我们将使用ZIP模型对模型在其训练期间未见过的测试数据集进行一些预测。</li></ol><p id="c18b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们从导入所有需要的包开始:</p><pre class="mj mk ml mm gt oc od oe of aw og bi"><span id="103d" class="mw mx jj od b gy oh oi l oj ok"><strong class="od jk">import </strong>pandas <strong class="od jk">as </strong>pd<br/><strong class="od jk">from </strong>patsy <strong class="od jk">import </strong>dmatrices<br/><strong class="od jk">import </strong>numpy <strong class="od jk">as </strong>np<br/><strong class="od jk">import </strong>statsmodels.api <strong class="od jk">as </strong>sm<br/><strong class="od jk">import </strong>matplotlib.pyplot <strong class="od jk">as </strong>plt</span></pre><p id="8846" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我们将把fish数据集加载到内存中。这里是数据集的<a class="ae jg" href="https://gist.github.com/sachinsdate/09cfd42b7701c48ec68b04c786786434" rel="noopener ugc nofollow" target="_blank">链接:</a></p><pre class="mj mk ml mm gt oc od oe of aw og bi"><span id="9fca" class="mw mx jj od b gy oh oi l oj ok">df = pd.read_csv(<strong class="od jk">'fish.csv'</strong>, header=0)</span></pre><p id="d92e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们打印数据集的前几行:</p><pre class="mj mk ml mm gt oc od oe of aw og bi"><span id="89df" class="mw mx jj od b gy oh oi l oj ok">print(df.<strong class="od jk">head</strong>(10))</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oo"><img src="../Images/cad67f956457b2a2e75f2c598e304e1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kc8fOhGE7GUEkbfoLhyEkg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">数据集的前10行(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="c8b4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们也打印出FISH_COUNT值的频率分布:</p><pre class="mj mk ml mm gt oc od oe of aw og bi"><span id="2f98" class="mw mx jj od b gy oh oi l oj ok">df.<strong class="od jk">groupby</strong>('FISH_COUNT').<strong class="od jk">count</strong>()</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi op"><img src="../Images/98c6d10074665d85dfc13cc7b1246ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lPh-KMaZbZFJhljZ6Yp0iQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">鱼类数量的频率分布(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="0ca7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">创建训练和测试数据集。请注意，目前我们没有进行分层随机分割:</p><pre class="mj mk ml mm gt oc od oe of aw og bi"><span id="aea7" class="mw mx jj od b gy oh oi l oj ok">mask = np.random.<strong class="od jk">rand</strong>(len(df)) &lt; 0.8<br/>df_train = df[mask]<br/>df_test = df[~mask]<br/>print(<strong class="od jk">'Training data set length='</strong>+str(len(df_train)))<br/>print(<strong class="od jk">'Testing data set length='</strong>+str(len(df_test)))</span><span id="562a" class="mw mx jj od b gy oq oi l oj ok">&gt;&gt; Training data set length=196<br/>&gt;&gt; Testing data set length=54</span></pre><p id="a4d2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<a class="ae jg" href="https://patsy.readthedocs.io/en/latest/quickstart.html" rel="noopener ugc nofollow" target="_blank"><strong class="la jk">Patsy</strong></a><strong class="la jk"/>符号中设置回归表达式。我们告诉Patsy，FISH_COUNT是我们的因变量<strong class="la jk"> <em class="mn"> y </em> </strong>，它取决于回归变量LIVE_BAIT、CAMPER、PERSONS和CHILDREN:</p><pre class="mj mk ml mm gt oc od oe of aw og bi"><span id="66ae" class="mw mx jj od b gy oh oi l oj ok">expr = <strong class="od jk">'FISH_COUNT ~ LIVE_BAIT  + CAMPER + CHILDREN + PERSONS'</strong></span></pre><p id="2373" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们使用Patsy为训练和测试数据集绘制出<strong class="la jk"> <em class="mn"> X </em> </strong>和<strong class="la jk"> <em class="mn"> y </em> </strong>矩阵。</p><pre class="mj mk ml mm gt oc od oe of aw og bi"><span id="f29b" class="mw mx jj od b gy oh oi l oj ok">y_train, X_train = <strong class="od jk">dmatrices</strong>(expr, df_train, return_type=<strong class="od jk">'dataframe'</strong>)</span><span id="afe1" class="mw mx jj od b gy oq oi l oj ok">y_test, X_test = <strong class="od jk">dmatrices</strong>(expr, df_test, return_type=<strong class="od jk">'dataframe'</strong>)</span></pre><p id="9186" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用statsmodels的<a class="ae jg" href="https://www.statsmodels.org/stable/generated/statsmodels.discrete.count_model.ZeroInflatedPoisson.html" rel="noopener ugc nofollow" target="_blank"><strong class="la jk">ZeroInflatedPoisson</strong></a>类，我们在训练数据集上构建并训练一个ZIP回归模型。</p><p id="c9f4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是在我们这样做之前，让我解释一下如何使用类构造函数的两个参数:</p><ul class=""><li id="193f" class="lu lv jj la b lb lc le lf lh lw ll lx lp ly lt lz ma mb mc bi translated"><strong class="la jk"> <em class="mn">膨胀:</em></strong><em class="mn">zeroinflatedpoisson</em>模型类将在内部使用一个<em class="mn">逻辑回归</em>模型来估计参数<strong class="la jk"> <em class="mn"> ϕ </em> </strong>。因此，我们将模型参数<em class="mn">膨胀设置为‘logit</em>’。我们还可以尝试将它设置为其他二项式链接函数，如“probit”。</li><li id="0400" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><strong class="la jk"> <em class="mn"> exog_infl: </em> </strong>我们还想请ZIP模型估计<em class="mn"> ϕ </em>作为与母模型相同的一组回归变量的函数，即:LIVE_BAIT、CAMPER、PERSONS和CHILDREN。因此，我们将参数<em class="mn"> exog_infl </em>设置为X_train。如果您只想使用X_train的一个子集，您可以这样做，或者您可以将<em class="mn"> exog_infl </em>设置为一组完全不同的回归变量。</li></ul><p id="d28b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面一行代码在我们的训练数据集上构建和训练ZIP模型。</p><pre class="mj mk ml mm gt oc od oe of aw og bi"><span id="5da5" class="mw mx jj od b gy oh oi l oj ok">zip_training_results = <strong class="od jk">sm</strong>.<strong class="od jk">ZeroInflatedPoisson</strong>(<strong class="od jk"><em class="mn">endog</em></strong><em class="mn">=</em>y_train, <strong class="od jk"><em class="mn">exog</em></strong><em class="mn">=</em>X_train, <strong class="od jk"><em class="mn">exog_infl</em></strong><em class="mn">=</em>X_train, <strong class="od jk"><em class="mn">inflation</em></strong><em class="mn">=</em>'logit').<strong class="od jk">fit</strong>()</span></pre><p id="c456" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">打印培训总结:</p><pre class="mj mk ml mm gt oc od oe of aw og bi"><span id="9e67" class="mw mx jj od b gy oh oi l oj ok">print(zip_training_results.<strong class="od jk">summary</strong>())</span></pre><p id="d559" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是培训总结(我在输出中突出显示了重要元素):</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi or"><img src="../Images/f2f6b0b2b80b141dcb4717a0ebbaeb31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4LpDkhFLuKypa6HCPPtI3w.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">ZIP模型的训练总结(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="303f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">解释培训输出</strong></p><p id="4d9f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">蓝框包含嵌套逻辑回归模型用来估计野营小组<strong class="la jk">是否捕获任何鱼的概率<strong class="la jk"><em class="mn">【ϕ】</em></strong>的变量信息。</strong></p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi os"><img src="../Images/4a955e4d0d9ddd12c2f36e8c5605c3b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*v1QbCOx-G6NcTF2GyCki0g.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="062c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，逻辑回归模型没有发现对估计<strong class="la jk"><em class="mn"/></strong>ϕ有用的截距、LIVE_BAIT和CAMPER变量。发现它们的回归系数在95%的置信水平下不具有统计显著性，如各自的<em class="mn"> p </em>值所示:<br/><em class="mn">inflate _ Intercept =</em><strong class="la jk"><em class="mn">0.425</em></strong><em class="mn">，<br/>inflate _ LIVE _ BAIT =</em><strong class="la jk"><em class="mn">0.680</em></strong><em class="mn">和<br/>inflate _ CAMPER =</em><strong class="la jk"><em class="mn">0</em></strong></p><p id="0a69" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">观察结果1 </strong></p><p id="259f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">逻辑回归模型确定对估计是否有鱼被捕获的概率有用的唯一两个变量是儿童和人。</p><p id="de7e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">观察2 </strong></p><p id="cc2d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">人的回归系数为负(inflate _ PERSONS<strong class="la jk">-1.2193</strong>)，这意味着随着野营组人数的增加，该组没有鱼被捕获的概率降低。这符合我们的直觉。</p><p id="a046" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">红框包含关于父泊松模型在FISH_COUNT &gt; 0的条件下用于估计FISH_COUNT的变量的信息。</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/95dce88ad33332161ec9992d2c1af8e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*FgFaRyNMfLGGC81yyyOKLg.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="f63f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">观察结果3 </strong></p><p id="8f6d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以看到，所有5个回归变量的系数在99%的置信水平下具有统计显著性，正如它们的p值小于0.01所证明的那样。事实上，所有5个变量的p值都小于0.001，因此显示为0.000。</p><p id="4f5e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">观察结果4 </strong></p><p id="c996" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">儿童的系数为负(儿童-1.0810)，这意味着随着野营组中儿童数量的增加，该组捕获的鱼的数量减少！</p><p id="61e6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">观察5 </strong></p><p id="2c8d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该模型的最大对数似然为-566.43。这个值对于比较模型与其他模型的拟合优度很有用(见文末的趣味练习)。</p><p id="4d4e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">观察6 </strong></p><p id="ae71" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，请注意，ZIP模型的训练算法无法收敛于训练数据集，如下所示:</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/e2a3f3c8fe71522a90e193fca9fb7d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*UGgTEo4bAuDrczCpkE81IA.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="04b5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果它已经收敛，也许它会导致一个更好的拟合。</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><p id="b20e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">预测</strong></p><p id="d0bc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将获得ZIP模型对测试数据集的预测，并计算均方根误差w.r.t .实际值:</p><pre class="mj mk ml mm gt oc od oe of aw og bi"><span id="bc13" class="mw mx jj od b gy oh oi l oj ok">zip_predictions = zip_training_results.predict(X_test,exog_infl=X_test)</span><span id="05df" class="mw mx jj od b gy oq oi l oj ok">predicted_counts=np.round(zip_predictions)</span><span id="d184" class="mw mx jj od b gy oq oi l oj ok">actual_counts = y_test[dep_var]<br/><br/>print(<strong class="od jk">'ZIP RMSE='</strong>+str(np.sqrt(np.sum(np.power(np.subtract(predicted_counts,actual_counts),2)))))</span><span id="b3f4" class="mw mx jj od b gy oq oi l oj ok">&gt;&gt; <strong class="od jk">ZIP RMSE=</strong>55.65069631190611</span></pre><p id="b629" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们绘制预测的和实际的鱼数量:</p><pre class="mj mk ml mm gt oc od oe of aw og bi"><span id="deae" class="mw mx jj od b gy oh oi l oj ok">fig = plt.figure()</span><span id="8463" class="mw mx jj od b gy oq oi l oj ok">fig.suptitle(<strong class="od jk">'Predicted versus actual counts using the ZIP model'</strong>)</span><span id="bb41" class="mw mx jj od b gy oq oi l oj ok">predicted, = plt.plot(X_test.index, predicted_counts, <strong class="od jk">'go-'</strong>, label=<strong class="od jk">'Predicted'</strong>)</span><span id="2a39" class="mw mx jj od b gy oq oi l oj ok">actual, = plt.plot(X_test.index, actual_counts, <strong class="od jk">'ro-'</strong>, label=<strong class="od jk">'Actual'</strong>)</span><span id="5276" class="mw mx jj od b gy oq oi l oj ok">plt.legend(handles=[predicted, actual])</span><span id="8f34" class="mw mx jj od b gy oq oi l oj ok">plt.show()</span></pre><p id="ad82" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们看到下面的情节:</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ov"><img src="../Images/53e17f5b8ac6513a461dbb53a74138f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pDQ2Dob7Nh1YecxALfK4ZA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">预测与实际捕获的鱼(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="1f20" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就完成了我们对零膨胀泊松回归模型的研究。</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h2 id="2027" class="mw mx jj bd my mz na dn nb nc nd dp ne lh nf ng nh ll ni nj nk lp nl nm nn no bi translated">有趣的练习</h2><ol class=""><li id="dbae" class="lu lv jj la b lb np le nq lh ow ll ox lp oy lt nx ma mb mc bi translated">阅读以下文章:<a class="ae jg" rel="noopener" target="_blank" href="/an-illustrated-guide-to-the-poisson-regression-model-50cccba15958">泊松回归模型图解指南</a></li><li id="fac5" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt nx ma mb mc bi translated">使用Python和statsmodels，在露营旅行数据集上训练标准泊松模型，并将该模型的性能与ZIP模型的性能进行比较。你可能会对你的发现感到惊讶。</li><li id="bfe9" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt nx ma mb mc bi translated">使用statsmodels在两个模型的训练摘要中报告的最大对数似然值，比较两个模型在训练数据集上的拟合优度。最大L1越大，拟合优度越好。</li><li id="d700" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt nx ma mb mc bi translated">在测试数据集上比较两个模型的RMSE分数。</li></ol><p id="73e8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">快乐造型！</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h2 id="7bf6" class="mw mx jj bd my mz na dn nb nc nd dp ne lh nf ng nh ll ni nj nk lp nl nm nn no bi translated">建议进一步阅读的主题</h2><ul class=""><li id="c9f2" class="lu lv jj la b lb np le nq lh ow ll ox lp oy lt lz ma mb mc bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/the-poisson-process-everything-you-need-to-know-322aa0ab9e9a">泊松过程:你需要知道的一切</a></li><li id="9cee" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/the-intuition-for-the-poisson-distribution-formula-34c5e52f4e04">泊松分布公式的直觉</a></li><li id="225d" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/an-illustrated-guide-to-the-poisson-regression-model-50cccba15958">泊松回归模型图解指南</a></li><li id="fb46" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/generalized-poisson-regression-for-real-world-datasets-d1ff32607d79">真实世界数据集的广义泊松模型</a></li><li id="a56f" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/negative-binomial-regression-f99031bb25b4">负二项回归模型:逐步指南</a></li><li id="a27a" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated"><a class="ae jg" href="http://faculty.econ.ucdavis.edu/faculty/cameron/racd2/" rel="noopener ugc nofollow" target="_blank"> A. Colin Cameron和Pravin K. Trivedi，计数数据的回归分析</a></li><li id="5b4c" class="lu lv jj la b lb md le me lh mf ll mg lp mh lt lz ma mb mc bi translated">Lambert，D. (1992)，<a class="ae jg" href="https://www.researchgate.net/publication/254333007_Zero-Inflated_Poisson_Regression_With_An_Application_to_Defects_in_Manufacturing" rel="noopener ugc nofollow" target="_blank">零膨胀泊松回归及其在制造缺陷中的应用</a>，《技术计量学》，34，1–14。</li></ul></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><p id="dd5f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="mn">感谢阅读！我写关于数据科学的主题，特别关注回归和时间序列分析。</em></p><p id="dcfc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="mn">如果您喜欢这篇文章，请关注我的</em><a class="ae jg" href="https://timeseriesreasoning.medium.com" rel="noopener"><strong class="la jk"><em class="mn">Sachin Date</em></strong></a><em class="mn">以获得关于回归和时间序列分析主题的提示、操作方法和编程建议。</em></p></div></div>    
</body>
</html>