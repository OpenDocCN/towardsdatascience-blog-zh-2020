<html>
<head>
<title>How to measure the variance of a statistical model?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何度量一个统计模型的方差？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/measure-variance-of-statistical-model-e3b4725095b6?source=collection_archive---------33-----------------------#2020-06-24">https://towardsdatascience.com/measure-variance-of-statistical-model-e3b4725095b6?source=collection_archive---------33-----------------------#2020-06-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0f21" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">作为数据科学家，我们经常强调偏差-方差权衡。但是在比较模型的时候，我们需要量化方差。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/eb1097addc3d0158abdd64950db2ee4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xn4j38gUrgMefk_ElQ9l0A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由Pritesh Sudra在Unsplash上拍摄的图像</p></figure><p id="231a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文假设您理解并知道如何构建回归或分类模型。</p><p id="116e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">任何统计模型的误差都由三部分组成——偏差、方差和噪声。通俗地说，偏差是预测准确性的倒数。方差指的是预测展开的程度。另一方面，噪声是无法系统表达的随机波动。</p><p id="04c3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然而，上述定义是模糊的，我们需要从数学的角度来考察它们。在本文中，我将强调方差——困扰我们模型的更令人困惑的恶魔。</p><h1 id="bb75" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">关于方差的一个简短注记</h1><p id="dbe5" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">当我们允许我们的模型灵活地无用地学习训练数据的复杂关系时，它就失去了概括的能力。大多数情况下，这种灵活性是通过特征提供的，即当数据具有大量特征时(有时多于观测值)。这也可能是由于复杂的神经网络架构或过小的训练数据集。</p><p id="5e3c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由此产生的是一个也学习训练数据中的噪声的模型；因此，当我们试图根据看不见的数据做出预测时，模型就失灵了。</p><blockquote class="ms mt mu"><p id="1f7d" class="ky kz lu la b lb lc ju ld le lf jx lg mv li lj lk mw lm ln lo mx lq lr ls lt im bi translated">方差也是同一观测在模型的不同“实现”中的预测差异的原因。<strong class="la iu">我们稍后将使用这一点来寻找方差的精确值。</strong></p></blockquote><h1 id="a3d6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">数学解释</h1><p id="9410" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">设<em class="lu"> Xᵢ </em>为模型<em class="lu"> M </em>根据观察值<em class="lu"> i. </em>做出的预测总体。如果我们取大小为<em class="lu"> n </em>值的样本，方差将为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/68baefb9fd77d336cfc3fb41950cd7fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*WRByqHiCOH5iC1y8c-3RpA.png"/></div></figure><p id="1f32" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是我们已经知道的事情。然而，我们需要计算总体的方差(相当于生成它的统计模型的方差),我们还没有完全做到这一点。在此之前，我们需要了解一个概念——bootstrap重采样。</p><p id="fb14" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，这个方差公式假设模型的结果是一个连续变量—这发生在回归中。在分类的情况下，结果是0/1，因此，我们必须不同地测量方差。你可以在这篇<a class="ae mz" href="https://dl.acm.org/doi/10.5555/647288.721421" rel="noopener ugc nofollow" target="_blank">论文</a>中找到对此的解释。</p><h2 id="3440" class="na lw it bd lx nb nc dn mb nd ne dp mf lh nf ng mh ll nh ni mj lp nj nk ml nl bi translated">自举重采样</h2><p id="bd31" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">通常，我们无法访问整个人口来计算统计数据，如方差或均值。在这种情况下，我们利用自举子样本。</p><blockquote class="ms mt mu"><p id="cadb" class="ky kz lu la b lb lc ju ld le lf jx lg mv li lj lk mw lm ln lo mx lq lr ls lt im bi translated">bootstrapping的原理表明，如果我们从大小为<em class="it"> n </em>的样本中抽取大量大小为<em class="it"> n </em> <strong class="la iu">的子样本，并替换为</strong>，那么它就是从原始总体中抽取这些样本的近似值。</p></blockquote><p id="59de" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们找到每个子样本的样本统计量，并取它们的平均值来估计总体的统计量。我们获取的子样本数量仅受时间和空间约束的限制；然而，你拿的越多，你的结果就越准确。</p><h2 id="41ba" class="na lw it bd lx nb nc dn mb nd ne dp mf lh nf ng mh ll nh ni mj lp nj nk ml nl bi translated">模型的实现</h2><p id="16ab" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">设<em class="lu"> M </em>为我们的统计模型。<em class="lu"> M </em>的实现是从输入到输出的映射。当我们在一个特定的输入上训练M时，我们获得了模型的一个具体实现。通过在来自输入数据的子样本上训练模型，我们可以获得更多的实现。</p><h2 id="a5cf" class="na lw it bd lx nb nc dn mb nd ne dp mf lh nf ng mh ll nh ni mj lp nj nk ml nl bi translated">最后…</h2><p id="aaf2" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">我们可以将这两个概念结合起来，通过引导训练数据来获得模型的实际方差的估计，从而获得模型的多个实现。</p><p id="1585" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们将方差公式转化为模型<em class="lu"> M </em>对<em class="lu">观察</em>X的算法。</p><ol class=""><li id="cacd" class="nm nn it la b lb lc le lf lh no ll np lp nq lt nr ns nt nu bi translated">从训练数据中抽取一个bootstrap子样本。</li><li id="904c" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt nr ns nt nu bi translated">在子样本上训练<em class="lu"> M </em>并生成观测值<em class="lu"> X </em>的预测<em class="lu"> Pₓ </em>。</li><li id="f805" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt nr ns nt nu bi translated">重复第1步和第2步n次<em class="lu">。</em></li><li id="8214" class="nm nn it la b lb nv le nw lh nx ll ny lp nz lt nr ns nt nu bi translated">使用方差公式<em class="lu">计算<em class="lu"> Pₓ </em>的所有值的方差。</em></li></ol><p id="1552" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以对更多的观察重复这一过程，并报告平均方差。</p><h1 id="d822" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">回归模型的方差</h1><p id="44ac" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">我使用了一个数据集来预测混凝土的抗压强度，单位为兆帕(兆帕)。</p><h2 id="a067" class="na lw it bd lx nb nc dn mb nd ne dp mf lh nf ng mh ll nh ni mj lp nj nk ml nl bi translated">单点分析</h2><p id="8a5b" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">我们评估不同模型的单个样本外观察的预测方差(通过bootstrapping获得)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/f07389992cf72fd4cfb2668cf3c9e599.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*5wA5TShjOm-eW1c47TP_zg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">引导子样本数= 1000</p></figure><p id="7d06" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如预期的那样，bagging和random forest模型比它们的基础模型(即决策树)变化更小。在所有模型中，预测值在实际值处达到峰值；然而，决策树分布是双峰的，并且更加分散。</p><h2 id="cfb8" class="na lw it bd lx nb nc dn mb nd ne dp mf lh nf ng mh ll nh ni mj lp nj nk ml nl bi translated">分散分析</h2><p id="3d53" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">我们可以使用散点图比较所有样本外观察的模型的总体变化。</p><div class="kj kk kl km gt ab cb"><figure class="ob kn oc od oe of og paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/1295175df1127544f97cf3266eb51485.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*ZY78xv_dpqNXQn75SMfErw.png"/></div></figure><figure class="ob kn oc od oe of og paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/c2552399b863267d3ed4388a68b0203c.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Ix160zTF_m859ufza_HR0g.png"/></div></figure><figure class="ob kn oc od oe of og paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><img src="../Images/2c53a32f9562e837fe87e60c00daf261.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Gmo8VYXkn9V5BYDcNpo2xg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk oh di oi oj translated">样本数量= 1000</p></figure></div><p id="d4b7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">较暗的金线代表实际值。再一次，决策树的预测更多的是分散在这条线上。</p><h1 id="b4d6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">分类模型的方差</h1><p id="b613" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">对于分类任务，我将使用修改后的鸢尾数据集来预测该花是否是海滨鸢尾(1或0)。我还添加了一种传染性的花，伪装成鸢尾。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/d1385f466a43d1b7e1ec85dc15973e26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*NtHCUcY8V2PA62vJgDT3Zw.png"/></div></div></figure><h2 id="28e9" class="na lw it bd lx nb nc dn mb nd ne dp mf lh nf ng mh ll nh ni mj lp nj nk ml nl bi translated">灵敏度分析</h2><p id="d36a" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">基础模型对错误的观察(圆圈)更敏感，如在决策区域中所见。换句话说，它试图对训练数据中的噪声进行建模。</p><div class="kj kk kl km gt ab cb"><figure class="ob kn ol od oe of og paragraph-image"><img src="../Images/b6acaf265c9700a79b82d8ba0d7be64a.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*oCS647iJj2WGN6RDPgrqJA.png"/></figure><figure class="ob kn ol od oe of og paragraph-image"><img src="../Images/c35ad296ed2efa54fe34c33e93fd6508.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*u1Xcsd0boJDgVJnHhs00Dw.png"/><p class="ku kv gj gh gi kw kx bd b be z dk om di on oj translated">分类器的决策边界</p></figure></div></div><div class="ab cl oo op hx oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="im in io ip iq"><h1 id="0c77" class="lv lw it bd lx ly ov ma mb mc ow me mf jz ox ka mh kc oy kd mj kf oz kg ml mm bi translated">奖金代码</h1><p id="5a63" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">这是一个基于bootstrap子采样计算方差的实现。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pa pb l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">从mlxtend库中的bias_variance_decomp()扩展而来</p></figure><h1 id="380b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">一锤定音</h1><p id="58cf" class="pw-post-body-paragraph ky kz it la b lb mn ju ld le mo jx lg lh mp lj lk ll mq ln lo lp mr lr ls lt im bi translated">在比较两个或更多模型时，测量和模拟误差是很重要的。当你考虑升级到合奏时，这一点尤其重要。</p><p id="6e96" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还要注意，方差较低的模型不一定是更准确的模型(还记得有偏差的权衡吗？).偏差以类似的方式测量。</p></div></div>    
</body>
</html>