<html>
<head>
<title>Infectious Disease Modelling-The nuts and bolts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">传染病模型——基本原理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/infectious-disease-modelling-the-nuts-and-bolts-46a9b2d42388?source=collection_archive---------46-----------------------#2020-07-10">https://towardsdatascience.com/infectious-disease-modelling-the-nuts-and-bolts-46a9b2d42388?source=collection_archive---------46-----------------------#2020-07-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="485b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><strong class="ak">使用 R 中的简单二室模型的介绍</strong></h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f7a53471ce8b7b6b5a317f3233faa0a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aZgtMVRDssi8nU7Q"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com/@miracleday?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">埃琳娜·莫日维洛</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="1756" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi ls translated">自古以来，传染病就一直困扰着人类。通常，传播是由宿主驱动的，然后宿主将感染传给其他个体。传染病模型的目标是捕捉这些<strong class="ky ir">传播动态。它们是对传染病传播的数学描述。</strong></p><p id="0195" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用该模型，可以:</p><ul class=""><li id="5388" class="mb mc iq ky b kz la lc ld lf md lj me ln mf lr mg mh mi mj bi translated">研究干预对疾病负担的影响</li><li id="7a05" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">来预测不同干预的结果</li></ul><h2 id="cbc7" class="mp mq iq bd mr ms mt dn mu mv mw dp mx lf my mz na lj nb nc nd ln ne nf ng nh bi translated">一个简单的二室模型</h2><p id="c432" class="pw-post-body-paragraph kw kx iq ky b kz ni jr lb lc nj ju le lf nk lh li lj nl ll lm ln nm lp lq lr ij bi translated">考虑只有两个隔间的最简单的模型——感染(I)和恢复(R)。这个模型有助于我们回答以下问题:</p><p id="46c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">人从 I 到 R 需要多久？(或从 I 到 R 的转换率)</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/c0d5186fd1ddf29e357a104f48a71dee.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*Ix8OrX9vIxqBprwjbqSSIA.jpeg"/></div></figure><p id="79ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">假设</strong>:在任何时间点，I 区室中的每个个体都同样可能经历康复。</p><p id="8c51" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">变速器动力学由以下微分方程控制:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/9c3d24063bd7d28447cef3983f58e23f.png" data-original-src="https://miro.medium.com/v2/resize:fit:156/1*bfbUn0vTIWvWlN3s_amlsQ.gif"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/e4b98cfc370c595d829c94a93091faf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:136/1*XwQdrM5PEec74mjQ5rKiQQ.gif"/></div></figure><p id="687a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上述方程的解是:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/a4d16c376e422e811db36a97bab5c719.png" data-original-src="https://miro.medium.com/v2/resize:fit:250/1*D9SBPoS6LfTYLpKVs4ntkA.gif"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/9497770c3458fd33d9e03c8e419390e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/1*bucANhj4gnatQ2TbZ-02iQ.gif"/></div></figure><p id="c035" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，γ代表回收率。γ值越高，恢复越快。</p><p id="4e28" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在隔室 I 中度过的时间以参数γ和平均值 1/ γ(平均传染期)为指数分布</p><p id="e291" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">在 R 中建立一个双室模型</strong></p><p id="facc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">R 中的<strong class="ky ir"> deSolve </strong>包包含了求解一阶常微分方程组(‘ODE’)的初值问题的函数。</p><p id="3b98" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">步骤 1 </strong>:定义感染和康复队列中的人数、康复率γ(γ=0.1)和随访持续时间(21 天)</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="ce44" class="mp mq iq nt b gy nx ny l nz oa">initial_values&lt;-c(I=10000,R=0) #10000 in infected cohort<br/>parameters&lt;-c(gamma=0.1)<br/>time=seq(from=0,t=21,by=1)</span></pre><p id="812a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第二步</strong>:指定模型功能</p><p id="aa81" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在模型函数中，指定微分方程。该函数有三个输入参数:</p><ul class=""><li id="980d" class="mb mc iq ky b kz la lc ld lf md lj me ln mf lr mg mh mi mj bi translated">时间:我们希望求解模型的时间点</li><li id="6d2b" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">状态:存储每个时间点每个车厢的人数</li><li id="7c94" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated">参数:模型参数的名称和值</li></ul><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="f203" class="mp mq iq nt b gy nx ny l nz oa">model_cohort&lt;-function(time,state,parameters){<br/>  with(as.list(c(state,parameters)),{<br/>    dI=-gamma*I<br/>    dR=gamma*I<br/>    return(list(c(dI,dR)))<br/>  }</span><span id="d5b4" class="mp mq iq nt b gy ob ny l nz oa">)  <br/>}</span></pre><p id="3ce5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">第三步</strong>:使用 deSolve 包中的 ode()求解模型</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="d256" class="mp mq iq nt b gy nx ny l nz oa">output&lt;-as.data.frame(ode(y=initial_values,func =   model_cohort,parms=parameters,times = time))<br/>head(output)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/c2d396f0e3062318de42c2101a8ab8a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/1*NfJsKQVrRW9p7OTlHFlePg.jpeg"/></div></figure><p id="048c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们看到输出是带有时间点的数据帧，即在每个时间点感染和恢复隔离室中的人数。</p><p id="1fd7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">步骤 4:使用<strong class="ky ir"> ggplot2 </strong>绘制输出</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="dcdf" class="mp mq iq nt b gy nx ny l nz oa">out_long=melt(output,id="time") #To convert the dataframe to long   format</span><span id="a22a" class="mp mq iq nt b gy ob ny l nz oa">ggplot(data = out_long,          <br/>       aes(x = time, y = value, colour = variable, group = variable)) +  <br/>  geom_line() +                                                          <br/>  xlab("Time (days)")+                          <br/>  ylab("No: of people") +                    <br/>  labs(title = paste("No: infected and recovered for gamma = 0.1 days^-1"))+scale_color_discrete(name="State")</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/05ab704f576b08f94dd19b5063558260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*BHruoOhdKcBlMP3EO4LLyw.jpeg"/></div></figure><p id="1389" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从图中，可以回答关于在每个时间点感染和恢复的人数的问题。平均传染期将是恢复率的倒数，即 1/0.1=10 天</p><p id="a012" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">改变伽马值</strong></p><p id="519b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果γ增加到比如说 0.5，我们观察到一半的感染群体在大约 2 天内恢复，而对于γ=0.1，需要大约 7 天。因此，γ值越大，恢复时间越短。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/06e2a0607fe6f86e7cfd34d30250bc7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*WfymU8IxeN2WqiZP88zZ5w.jpeg"/></div></figure><p id="e5d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个模型是基于相似原理的更复杂的房室模型的最简单的例子，比如 SIR 模型。在即将到来的帖子中会有更多关于它的内容:)</p><p id="25f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">参考文献</strong></p><ul class=""><li id="cfe5" class="mb mc iq ky b kz la lc ld lf md lj me ln mf lr mg mh mi mj bi translated">Soetaert，K. E .，Petzoldt，t .，&amp; Setzer，R. W. (2010 年)。解 R 中的微分方程:包 deSolve。<em class="oe">统计软件杂志</em>，<em class="oe"> 33 </em>。</li><li id="1bd3" class="mb mc iq ky b kz mk lc ml lf mm lj mn ln mo lr mg mh mi mj bi translated"><a class="ae kv" href="https://www.coursera.org/specializations/infectious-disease-modelling" rel="noopener ugc nofollow" target="_blank">https://www . coursera . org/specializations/infectious-disease-modeling</a></li></ul></div></div>    
</body>
</html>