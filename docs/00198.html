<html>
<head>
<title>Big Data and AutoML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">大数据和自动化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automl-and-big-data-980e24fba6fa?source=collection_archive---------39-----------------------#2020-01-06">https://towardsdatascience.com/automl-and-big-data-980e24fba6fa?source=collection_archive---------39-----------------------#2020-01-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9211" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">或者如何对40+ GB的数据集使用Google AutoML</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e5dce63fd1d257e0146a5dea3c5226c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oxvtcMBOFhuiBy-m"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@codypboard?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">科迪板</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="67ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Cloud AutoML是谷歌云平台的一部分。AutoML提供令人印象深刻的图像分类结果，无需任何数学或技术背景知识。对于40 GB以下的图像数据，图像可以直接加载到AutoML模块中。对于更大的数据集，必须首先将数据下载到一个虚拟机中，然后传输到存储桶，再从那里传输到AutoML。</p><p id="b55f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于小于40 GB的数据，请考虑这个<a class="ae kv" rel="noopener" target="_blank" href="/google-cloud-automl-vision-for-medical-image-classification-76dfbf12a77e">教程</a>(它为你节省了一些开销)。</p><p id="ba40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我使用的数据集由112，120张X射线图像组成，这些图像带有来自30，805名不同患者的疾病标签[1]。本教程的目标不是深入医学细节，而是展示大型数据集的AutoML工作流。您可以在以下位置找到本教程的数据:</p><div class="ls lt gp gr lu lv"><a href="https://www.kaggle.com/nih-chest-xrays/data" rel="noopener  ugc nofollow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">NIH胸部x光检查</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">来自30，000多名不同患者的112，000多张胸部x光图像</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">www.kaggle.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="dea4" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">新项目</h1><p id="19d9" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">在<a class="ae kv" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank"> Google云平台</a>中，首先创建一个新项目。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/9a3832617b77067083f67aa569a049fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*5e5R7keAewcoYVtCG2zkEg.png"/></div></figure><p id="4a24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并建立一个新的帐户。有了300美元的免费积分，本教程对于了解AutoML工作流来说是完美的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/40f9347672c64c16de29c68b6cbf7f7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uLBpxNHy33LzQL_OC8gbdQ.png"/></div></div></figure></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="5196" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">虚拟计算机</h1><p id="f00b" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">设置新的虚拟机实例。我用的是50 GB磁盘的Debian GNU/Linux 9 (stretch)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/c6f2d3d540de92e4667f89cc7408dc68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0-2BEFaGms25B_PkbBx40g.png"/></div></div></figure><p id="1cde" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">设置好VM后，打开云Shell并输入以下命令来下载python和pip。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="e99e" class="nw ms iq ns b gy nx ny l nz oa">sudo apt update<br/>sudo apt install python3 python3-dev<br/>wget <a class="ae kv" href="https://bootstrap.pypa.io/get-pip.py" rel="noopener ugc nofollow" target="_blank">https://bootstrap.pypa.io/get-pip.py</a><br/>sudo python get-pip.py<br/>pip –version</span></pre><p id="f487" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后执行:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="7024" class="nw ms iq ns b gy nx ny l nz oa">sudo pip3 install kaggle</span></pre><p id="7db6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">能够通过kaggle API下载数据集。</p><p id="ee07" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将您的kaggle API令牌上传到环境中。你可以在你的卡格尔账户里找到它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/1ccf6bd237970960fcdb0774bc3a6188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v_u0tgjvakozpFu-5edtZg.png"/></div></div></figure><p id="a638" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个新文件夹，并将API令牌放入其中。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="214f" class="nw ms iq ns b gy nx ny l nz oa">mkdir .kaggle<br/>mv kaggle.json .kaggle/kaggle.json</span></pre><p id="d8fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后下载数据集:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="0ce7" class="nw ms iq ns b gy nx ny l nz oa">kaggle datasets download -d nih-chest-xrays/data</span></pre><p id="00d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在不到15分钟的时间里，您已经下载了完整的42 GB。最后，解压缩数据:</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="1b10" class="nw ms iq ns b gy nx ny l nz oa">unzip data.zip</span></pre><p id="dd17" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">传输文件可能需要允许完全访问所有云API。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/e0f8b49283b8b2b0121d9ba2f2be3583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EFtJ-IgFToN8RI_9bfqClA.png"/></div></div></figure><p id="f4a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">查看这篇<a class="ae kv" href="https://stackoverflow.com/questions/28612080/resumableuploadabortexception-403-insufficient-permission" rel="noopener ugc nofollow" target="_blank"> StackOverflow帖子</a>以获得更多帮助。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="c1cf" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">存储桶</h1><p id="d5cb" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">解压文件后，你将数据传输到谷歌云存储中。创建一个新的存储桶，并给它一个明确的名称。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/eac67ff64b1d4de4d8c663cd0906db19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Sr7przQ3DfiXobOu9xtvA.png"/></div></div></figure><p id="98e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">执行</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="d89a" class="nw ms iq ns b gy nx ny l nz oa">gsutil -m cp -r [DATA FOLDER] gs://[BUCKET NAME]</span></pre><p id="9cb2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将所有数据复制到云存储中。为了加速这个过程,–m标志确保使用所有的虚拟机内核。尽管如此，这需要一些时间。–r标志复制完整的文件夹。</p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="edc2" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">AutoML</h1><p id="f9a9" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">在数据被完全复制后，转到Google Cloud中的AutoML并创建一个新的数据集。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/16a626d9df915792a5d6ab32ef806c9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aDJksCf6ukx4U27VOuhdPQ.png"/></div></div></figure><p id="43da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这种情况下，我们有一个多标签分类。这些图像将通过您必须提供给AutoML的CSV来选择。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/782fb31792e8a135ded3e8b9f1e7ebca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zR6dVsehZFtuy15LgMNqVw.png"/></div></div></figure><p id="b49d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">AutoML需要标签的CSV文件来指示图像是如何分类的。标签必须以字母开头，并且只能包含字母、数字和下划线。一张图片最多可以容纳20个标签。您还可以将标签留空，以便使用UI或人工标注服务进行手动标签定义。</p><p id="e7f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有关详细信息，请查阅:</p><p id="d9d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://cloud.google.com/vision/automl/docs/prepare" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/vision/automl/docs/prepare</a></p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="fecd" class="mr ms iq bd mt mu mv mw mx my mz na nb jw nc jx nd jz ne ka nf kc ng kd nh ni bi translated">培养</h1><p id="5145" class="pw-post-body-paragraph kw kx iq ky b kz nj jr lb lc nk ju le lf nl lh li lj nm ll lm ln nn lp lq lr ij bi translated">然后你看到你的图像的标签，你可以开始训练一个模型。我建议从1或2小时这样的低预算(训练时间)开始。完成训练后，你总是可以训练更长时间。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/be67dfb415641527ebba30039dfe0a5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7TwAGGjfrTUZZ1yEtrM36A.png"/></div></div></figure><p id="f543" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了避免成本，请记住关闭您的虚拟机，或者在不再需要该项目时将其完全删除。</p><p id="655c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望这篇教程能帮助你用Google Cloud AutoML处理大型数据集！</p><p id="7772" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[1] X. Wang，Y. Peng，L. Lu，Z. Lu，M. Bagheri和RM .Summers，<a class="ae kv" href="https://www.nih.gov/news-events/news-releases/nih-clinical-center-provides-one-largest-publicly-available-chest-x-ray-datasets-scientific-community" rel="noopener ugc nofollow" target="_blank"> ChestX-ray8:医院级胸部X射线数据库和常见胸部疾病弱监督分类和定位基准</a> (2017)，IEEE CVPR</p></div></div>    
</body>
</html>