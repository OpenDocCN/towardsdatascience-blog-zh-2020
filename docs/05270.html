<html>
<head>
<title>Frontpage Slickdeals Data Analysis with Pandas and Plotly Express</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Frontpage Slickdeals 与 Pandas 和 Plotly Express 进行数据分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/frontpage-slickdeals-analytics-with-pandas-and-plotly-express-b5e5bbdf072d?source=collection_archive---------66-----------------------#2020-05-04">https://towardsdatascience.com/frontpage-slickdeals-analytics-with-pandas-and-plotly-express-b5e5bbdf072d?source=collection_archive---------66-----------------------#2020-05-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9b68" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Slickdeals.com 是一个受欢迎的交易和优惠券网站。我将展示 web 抓取并使用 Slickdeals 数据集执行数据分析</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/aeb048cc3c7f9abdd9cf396c36affdf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pBbSNqGnJs9BHYYYGsu3hw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<a class="ae ky" href="https://www.pexels.com/photo/woman-holding-card-while-operating-silver-laptop-919436/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的 Andrea Piacquadio 的照片</p></figure><p id="5632" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">人们喜欢在购物时省钱。这些交易信息是有价值的用户行为数据，从中可以检索出有趣的问题和答案。Slickdeals.com 是最受欢迎的交易和优惠券网站之一。Frontpage Slickdeals 是社区成员或 Slickdeals 的编辑在过去 24 小时内推荐的交易。交易范围涵盖各种类别，价格从免费到数千美元不等。</p><p id="b468" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将探索来自 Slickdeals 的数据集，并使用<a class="ae ky" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>和<a class="ae ky" href="https://plotly.com/python/plotly-express/" rel="noopener ugc nofollow" target="_blank"> Plotly Express </a>执行数据分析。我希望这篇文章可以提供一些收集原始数据的有趣例子，以及如何使用 Pandas 和 Plotly Express 进行数据分析和可视化的一些见解。</p><h2 id="6a2a" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">数据收集</h2><p id="6dc8" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">作为一名数据专家，我们需要与数据打交道。执行任何类型的 web 分析的挑战性任务之一是时间。由于任何网站的可用数据都是最新的，因此很难追溯之前发生的事情或进行任何类型的时间旅行分析。例如，在 Slickdeals 主页上，如果我们看到一个有 46 个赞的热门交易，我们不知道它会多快到达这里。在这种情况下，web 抓取工具非常有助于为此目的收集数据。详细内容见文章<a class="ae ky" href="https://medium.com/@chengzhizhao/how-to-detect-the-best-deals-with-web-scraping-c1af2d6f4ef7" rel="noopener">中的一篇</a>如何发现网络抓取的最佳交易</p><p id="28e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了收集足够的数据，我以 15 分钟的间隔运行了两周的网络抓取程序，这应该能够捕捉到不同日期和时间的变化。你可以在这里找到两周的数据<a class="ae ky" href="https://raw.githubusercontent.com/ChengzhiZhao/jupyter-notebooks/master/slickdeals_data_file.csv" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="9bf5" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">数据解析和清理</h2><p id="d365" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在从网络上收集数据一段时间后，我们处于解析和清理阶段。这里，我们添加了包含列名的原始数据，并将日期时间列的格式从字符串更改为日期格式。pandas 提供的一个便利功能是<code class="fe mt mu mv mw b">read_csv</code>功能，我们可以直接从网络上获取数据，并将其转换为 CSV 文件。</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="a62b" class="lv lw it mw b gy nb nc l nd ne">url=”https://raw.githubusercontent.com/ChengzhiZhao/jupyter-notebooks/master/slickdeals_data_file.csv"</span><span id="ef39" class="lv lw it mw b gy nf nc l nd ne">df=pd.read_csv(url,header=None,names=['datetime','store','title','item_url','deal_price','original_price', ‘like’, ‘comments’])</span><span id="f11e" class="lv lw it mw b gy nf nc l nd ne">df[‘datetime’] = pd.to_datetime(df[‘datetime’])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/8c98d4761fc64518dbb477383be3287a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZLWrCZ9eX-mgg5rLqGoxIg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据解析和清理(按作者)</p></figure><h2 id="38a1" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">收集数据的数据分析</h2><p id="7895" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated"><strong class="lb iu">顶级交易是什么？</strong></p><p id="9b83" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个 Slickdeals 数据集上可以提出一些有趣的问题。其中一个项目是"<em class="nh">在 frontpage 交易中最受欢迎的交易是什么？</em>”。为了找到答案，从 Slickdeal 数据集，我们可以比较一笔交易在 Slickdeals 主页上出现的次数。由于网络抓取每 15 分钟发生一次，显示的时间越长，该项目成为最受欢迎的项目的可能性就越大。</p><p id="044b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们可以使用下面的代码对所有的标题进行分组并执行计数，然后按降序对计数进行排序，这里的排序将确保 Plotly Express 按顺序显示行。</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="0289" class="lv lw it mw b gy nb nc l nd ne">frequency_frontdeal = df.groupby(['title'])['title'].agg(['count']).reset_index(drop=False).sort_values(by=['count'],ascending=False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/c1c9c4e354585b4468bf7a217fceeb99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E167Ihk9PhReblNjM3CDrA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">苹果 AirPods Pro</p></figure><p id="8f21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了形象化，我们可以使用 Plotly Express 为前 20 项交易创建一个漂亮的条形图。</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="6d49" class="lv lw it mw b gy nb nc l nd ne">fig = px.bar(frequency_frontdeal.head(20), x=’title’, y=’count’)<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/277241137deb7bbdfa13039370ba8aa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q8NEeepBndM0PneViEyftA.png"/></div></div></figure><p id="c515" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上面的结果来看，“<a class="ae ky" href="https://slickdeals.net/f/13988171-apple-airpods-pro-w-wireless-charging-case-225-free-shipping?src=sticky-missed" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">苹果 AirPods Pro </strong> </a>”显然被认为是前两周头版头条中的最佳交易。但是我们算重复的了吗？接下来我们将揭晓答案。</p><p id="7c5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">顶级交易的趋势是什么样的？</p><p id="12f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于“<a class="ae ky" href="https://slickdeals.net/f/13988171-apple-airpods-pro-w-wireless-charging-case-225-free-shipping?src=sticky-missed" rel="noopener ugc nofollow" target="_blank">苹果 AirPods Pro </a>”是唯一的交易，我们选择这一个进行进一步分析，让我们深入研究并探索这种情况下的趋势。为了更好地了解这项交易的受欢迎程度，其中一个衡量标准是有多少人点击了“喜欢”按钮。Slickdeals 可能会使用“喜欢”按钮作为其推荐功能之一。探索“喜欢”的数量随着日期和时间的增加而增加可能是令人兴奋的。</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="3831" class="lv lw it mw b gy nb nc l nd ne">airpod = df[df[‘title’]==’Apple AirPods Pro w&amp;sol; Wireless Charging Case’].sort_values(by=[‘like’])<br/>fig = px.line(airpod, x=’datetime’, y=’like’)<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/8cc7b1a00df6207508af4c4f419ebe5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OKjJyVJfUrSpQdDVsZ-RHw.png"/></div></div></figure><p id="7bd4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，在图表上绘制数据后，图表看起来很奇怪，我们原本预计会有一条完美的曲线表明增长，但上面的图表看起来像是数字跳回和强制。好像是在流行的起点，我们跟踪了两个数据点。那么问题来了，“<em class="nh">有没有重复数据？</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/b601d4b2e174bf8e04fc8e87dff7fe91.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/1*NDAk8zKqoygqpSV5SxYQWg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:网络来自<a class="ae ky" href="https://knowyourmeme.com/photos/1369043-cats" rel="noopener ugc nofollow" target="_blank"> knowyourmeme </a></p></figure><p id="17de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">答案是“<strong class="lb iu">是的</strong>，原因是 Slickdeals 有两个来自不同商店但标题相同的交易。我们可以看到，威瑞森无线公司在 4 月 17 日第一次在头版刊登了这笔交易。几天后，Google Shopping 赶上来了，也在指定时间段内列在了首页。然后谷歌购物开始了。目前还不清楚 Slickdeal 执行重复数据删除流程的算法是为了优先处理第一笔交易，还是其中一笔交易刚刚输掉了竞争。但我们可以从下面的图表中看到，威瑞森的交易持续时间更长，也更受欢迎。为了验证我们的假设，我们可以在折线图中显示这两家商店，<code class="fe mt mu mv mw b">color</code>是一个参数，我们可以设置它来拆分数据，以显示在不同的组中。</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="63ca" class="lv lw it mw b gy nb nc l nd ne">airpod.groupby('store')['store'].count()<br/># store<br/># Google Shopping 96<br/># Verizon Wireless 473</span><span id="6aba" class="lv lw it mw b gy nf nc l nd ne"># With store<br/>fig = px.line(airpod, x='datetime', y='like',color='store')<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/5c633ed83ff4a62e4278f198fb706f8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6imGDJq2Gca9Ab7L3PiFCw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">两个商店一个交易标题(按作者)</p></figure><p id="9bd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">热门交易的点赞和评论之间有关联吗？</strong></p><p id="3052" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe mt mu mv mw b">frequency_frontdeal</code>中，我们可以获得前十行，并在图表中绘制它们。然后我们可以观察点赞数和评论数之间的关系。</p><pre class="kj kk kl km gt mx mw my mz aw na bi"><span id="b59c" class="lv lw it mw b gy nb nc l nd ne">fig = px.line(transformed_top10_df, x=’datetime’, y=’count’, color=’type’,facet_row=”title”)<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/b4db4df18b1af5c18dec0c111c359aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FdjgXrpHir5ZoWCtREyQLQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">喜欢和评论(按作者)</p></figure><p id="0686" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上图中，我们可以看到评论和喜欢的两种情况都表现出相似的趋势。有些产品的评论甚至比赞还多，这可能是关于这些交易的多条讨论线索，也可能是这笔交易登上头版的另一个原因。</p><h2 id="d36f" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">完整代码</strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="no np l"/></div></figure><h2 id="9d70" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">最终想法</h2><p id="7435" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们可以执行更多的分析，并从 web 抓取程序中收集更多的字段。从网上收集数据进行分析既简单又便宜。然而，收集数据进行详细分析需要一些时间。我们可以设置一个运行在树莓 Pi 上的网页抓取工具，收集数据。这种解决方案比从第三方购买数据更加灵活。这篇文章展示了使用 Pandas 和 Plotly Express 来分析我们从 web 上获取的数据并执行分析是多么容易，我希望它展示了一种不同的数据收集和分析方法。</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><p id="8de0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望这个故事对你有帮助。本文是我的工程&amp;数据科学系列的<strong class="lb iu">部分，目前包括以下内容:</strong></p><div class="nx ny gp gr nz"><div role="button" tabindex="0" class="ab bv gv cb fp oa ob bn oc ks ex"><div class="od l"><div class="ab q"><div class="l di"><img alt="Chengzhi Zhao" class="l de bw oe of fe" src="../Images/51b8d26809e870b4733e4e5b6d982a9f.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/2*SGCkys53sdZUZKnpRQoq_A.jpeg"/><div class="fb bw l oe of fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://chengzhizhao.medium.com/?source=post_page-----b5e5bbdf072d--------------------------------" rel="noopener follow" target="_top">赵承志</a></p></div></div><div class="oi oj gw l"><h2 class="bd iu tn to fp tp fr fs tq fu fw is bi translated">数据工程和数据科学故事</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi tr au ts tt tu qc tv an eh ei tw tx ty el em eo de bk ep" href="https://chengzhizhao.medium.com/list/data-engineering-data-science-stories-ddab37f718e7?source=post_page-----b5e5bbdf072d--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="tz l fo"><span class="bd b dl z dk">47 stories</span></div></div></div><div class="ov dh ow fp ab ox fo di"><div class="di on bv oo op"><div class="dh l"><img alt="" class="dh" src="../Images/4ba0357365403d685da42e6cb90b2b7e.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/da:true/resize:fill:388:388/1*b4EVtemQ1EQEup3o1ewz1w.gif"/></div></div><div class="di on bv oq or os"><div class="dh l"><img alt="" class="dh" src="../Images/89f9120acd7a8b3a37b09537198b34ca.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*xj-YsbUEN_pMA4IS7hE6hw.jpeg"/></div></div><div class="di bv ot ou os"><div class="dh l"><img alt="" class="dh" src="../Images/1f0d78b4e466ea21d6a5bd7a9f97c526.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*zF1_SxRakCIMJ2sgKtyP1w.jpeg"/></div></div></div></div></div><p id="7870" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你也可以<a class="ae ky" href="https://chengzhizhao.medium.com/subscribe" rel="noopener"> <strong class="lb iu">订阅我的新文章</strong> </a>或者成为<a class="ae ky" href="https://chengzhizhao.medium.com/membership" rel="noopener"> <strong class="lb iu">推荐媒介会员</strong> </a> <strong class="lb iu"> </strong>可以无限制访问媒介上的所有故事。</p><p id="771b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果有问题/评论，<strong class="lb iu">请不要犹豫，写下这个故事的评论</strong>或者<strong class="lb iu">通过<a class="ae ky" href="https://www.linkedin.com/in/chengzhizhao/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>或<a class="ae ky" href="https://twitter.com/ChengzhiZhao" rel="noopener ugc nofollow" target="_blank"> Twitter </a>直接联系我</strong>。</p></div></div>    
</body>
</html>