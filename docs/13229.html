<html>
<head>
<title>Machine Learning: GridSearchCV &amp; RandomizedSearchCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习:GridSearchCV &amp; RandomizedSearchCV</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-gridsearchcv-randomizedsearchcv-d36b89231b10?source=collection_archive---------12-----------------------#2020-09-11">https://towardsdatascience.com/machine-learning-gridsearchcv-randomizedsearchcv-d36b89231b10?source=collection_archive---------12-----------------------#2020-09-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f93f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 GridSearchCV 和 RandomizedSearchCV 进行超参数调整</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/441fbf9e4110a98cef927b0b7b92c1c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1eRhpO0DD0vEWMrh-neO0A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@jeshoots?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a>在<a class="ae ky" href="https://unsplash.com/s/photos/study?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="ca2a" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">简介</strong></p><p id="84d0" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在这篇文章中，我想谈谈我们如何通过调整参数来提高机器学习模型的性能。</p><p id="9a5b" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">显然，为了改进我们的模型，了解我们想要调整的参数的含义是很重要的。出于这个原因，在谈论 GridSearchCV 和 RandomizedSearchCV 之前，我将首先解释一些参数，如 C 和 gamma。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="7bc2" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">第一部分:SVC 中一些参数的概述</strong></p><p id="0793" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在<strong class="li iu">逻辑回归</strong>和<strong class="li iu">支持向量分类器</strong>中，决定正则化强度的参数称为<strong class="li iu"> C </strong>。</p><p id="085c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">对于一个<strong class="li iu">高 C </strong>，我们将有一个更少的正则化，这意味着我们试图尽可能地适应训练集。相反，当参数<strong class="li iu"> C </strong>的<strong class="li iu">值较低</strong>时，算法会尝试调整到“大多数”数据点，并提高模型的泛化能力。</p><p id="3391" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">还有一个重要的参数叫做<strong class="li iu">伽马</strong>。但在谈论它之前，我认为了解一点线性模型的局限性是很重要的。</p><p id="632d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">线性模型在低维空间中非常有限，因为线和超平面具有有限的灵活性。使线性模型更加灵活的一种方法是添加更多要素，例如，添加输入要素的交互或多项式。</p><p id="2c00" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">用于分类的线性模型只能使用线来分隔点，这并不总是更好的选择。因此，解决方案可以是在三维空间中表示点，而不是在二维空间中。事实上，在三维空间中，我们可以创建一个平面，以更精确的方式对我们数据集的点进行划分和分类。</p><p id="31e9" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">有两种方法可以将你的数据映射到一个更高维的空间中:<strong class="li iu">多项式核</strong>，计算所有可能的多项式，直到原始特征的某个程度；以及<strong class="li iu">径向基函数(RBF) </strong>核，也称为<strong class="li iu">高斯核</strong>，其测量数据点之间的距离。这里<strong class="li iu"> gamma </strong>的任务是控制<strong class="li iu">高斯核的宽度。</strong></p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="6c04" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">第二部分:GridSearchCV </strong></p><p id="792a" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">正如我在我的<a class="ae ky" rel="noopener" target="_blank" href="/machine-learning-some-notes-about-cross-validation-4a0315599f2">上一篇文章</a>中所展示的，交叉验证允许我们评估和改进我们的模型。但是还有另一个有趣的技术来改进和评估我们的模型，这个技术叫做<strong class="li iu">网格搜索</strong>。</p><p id="8f0d" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">网格搜索</strong>是一种调整监督学习中参数，提高模型泛化性能的有效方法。通过网格搜索，我们尝试了感兴趣的参数的所有可能组合，并找到了最佳组合。</p><p id="7559" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu"> Scikit-learn </strong>提供了<strong class="li iu"> GridSeaechCV </strong>类。显然，我们首先需要指定我们想要搜索的参数，然后 GridSearchCV 将执行所有必要的模型拟合。例如，我们可以创建下面的字典，它提供了我们想要为我们的模型搜索的所有参数。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="c826" class="mh mi it md b gy mj mk l ml mm">parameters = {‘C’: [0.001, 0.01, 0.1, 1, 10, 100], <br/>‘gamma’: [0.001, 0.01, 0.1, 1, 10, 100]}</span></pre><p id="e7dc" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">然后，我们可以用 SVC 模型实例化 GridSearchCV 类，并应用 6 个交叉验证实验。当然，我们还需要将数据分成训练集和测试集，以避免过度拟合参数。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="7103" class="mh mi it md b gy mj mk l ml mm">from <strong class="md iu">sklearn.model_selection</strong> import <strong class="md iu">GridSearchCV <br/></strong>from<strong class="md iu"> sklearn.model_selection </strong>import<strong class="md iu"> train_test_split<br/></strong>from s<strong class="md iu">klearn.svm</strong> import <strong class="md iu">SVC</strong> </span><span id="86fc" class="mh mi it md b gy mn mk l ml mm">search = GridSearchCV(SVC(), parameters, cv=5)</span><span id="d23f" class="mh mi it md b gy mn mk l ml mm">X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=0)</span></pre><p id="bea4" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在，我们可以用我们的训练数据来拟合我们已经创建的搜索对象。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="3dd1" class="mh mi it md b gy mj mk l ml mm">search.fit(X_train, y_train)</span></pre><p id="0735" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">因此，GridSearchCV 对象搜索最佳参数，并在整个训练数据集上自动拟合新模型。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="f4fe" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">第三部分:随机搜索</strong></p><p id="05e5" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">当我们有很多参数要试，训练时间很长的时候，RandomizedSearchCV 就非常有用了。对于这个例子，我使用随机森林分类器，所以我想你已经知道这种算法是如何工作的。</p><p id="d436" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">第一步是写出我们想要考虑的参数，并从这些参数中选择最好的。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="b8e8" class="mh mi it md b gy mj mk l ml mm">param = {‘max_depth: [6,9, None], <br/>         ‘n_estimators’:[50, 70, 100, 150], <br/>          'max_features': randint(1,6),<br/>          'criterion' : ['gini', 'entropy'],<br/>          'bootstrap':[True, False],<br/>          'mln_samples_leaf': randint(1,4)}</span></pre><p id="c888" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在我们可以创建我们的<strong class="li iu"> RandomizedSearchCV </strong>对象并拟合数据。最后，我们可以找到最佳参数和最佳分数。</p><pre class="kj kk kl km gt mc md me mf aw mg bi"><span id="3f6e" class="mh mi it md b gy mj mk l ml mm">from <strong class="md iu">sklearn.model_selection</strong> import <strong class="md iu">RandomSearchCV<br/></strong>from<strong class="md iu"> sklearn.ensemble </strong>import<strong class="md iu"> RandomForestClassifier</strong></span><span id="f692" class="mh mi it md b gy mn mk l ml mm">rnd_search = RandomizedSearchCV(RandomForestClassifier(), param, <br/>n_iter =10, cv=9)</span><span id="0d00" class="mh mi it md b gy mn mk l ml mm">rnd_search.fit(X,y)<br/>rnd_search.best_params_<br/>rnd_search.best_score_</span></pre></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="ac38" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">结论</strong></p><p id="74a4" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">因此，当我们处理少量的超参数时，网格搜索是很好的。但是，如果要考虑的参数数量特别多，并且影响的大小不平衡，那么更好的选择是使用随机搜索。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="0bde" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">感谢你阅读这篇文章。您还可以通过其他方式与我保持联系并关注我的工作:</p><ul class=""><li id="5ccc" class="mo mp it li b lj lk lm ln lp mq lt mr lx ms mb mt mu mv mw bi translated">订阅我的时事通讯。</li><li id="1420" class="mo mp it li b lj mx lm my lp mz lt na lx nb mb mt mu mv mw bi translated">也可以通过我的电报群<a class="ae ky" href="https://t.me/DataScienceForBeginners" rel="noopener ugc nofollow" target="_blank"> <em class="nc">初学数据科学</em> </a>取得联系。</li></ul></div></div>    
</body>
</html>