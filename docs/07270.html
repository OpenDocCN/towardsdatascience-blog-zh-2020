<html>
<head>
<title>COVID-19 Sentiment Analysis Series, Part 1: Getting Started</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">新冠肺炎情绪分析系列，第1部分:开始</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/covid-19-sentiment-analysis-series-part-1-getting-started-70892122630c?source=collection_archive---------45-----------------------#2020-06-02">https://towardsdatascience.com/covid-19-sentiment-analysis-series-part-1-getting-started-70892122630c?source=collection_archive---------45-----------------------#2020-06-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/3efa2dabdf6ad91334acd1b254658e30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fKCe23zIH9dlAjaD"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">🇨🇭·克劳迪奥·施瓦茨| @purzlbaum 在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h2 id="47c5" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph">推特情感分析</h2><div class=""/><div class=""><h2 id="c43f" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">理解一级防范禁闭中的伦敦人</h2></div><p id="73c1" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我发现封锁最令人震惊的是，与朋友聚会喝酒，或在某人的电脑前与同事交谈时，社区的丧失。</p><p id="8878" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">于是，我们失去了对每个人的感觉，失去了被倾听的感觉，失去了将社会团结在一起的共同声音。</p><p id="3f90" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我想通过Twitter了解伦敦人对事件的反应，以某种小的方式抵消这一点。我们对谁有好感？又是什么给我们带来了愤怒和挫败感？</p><figure class="me mf mg mh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi md"><img src="../Images/512d942dd59844d84cf09668aec44d0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*OUMAt61gjHq8D_0e"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">由<a class="ae jg" href="https://unsplash.com/@kmitchhodge?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> K .米奇·霍奇</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="077b" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这将是一个由3部分组成的系列，我们将会看到解决这个问题的几种方法…</p><p id="dcc8" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">第一部分:入门:</strong>如何获得你的推文，如何为推文评分，进行一些高层次的相关性分析。</p><p id="8a09" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">第二部分:假设检验:</strong>如何在统计上高度确认组织情感上的信心差异，使用文字云来了解公众<em class="mi">对某人的真实看法</em>！</p><p id="0927" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">第3部分:建模:</strong>展示如何逐步应用频率主义和贝叶斯方法来建模锁定的赢家和输家，我还将清楚地概述每种方法在回答这个问题时为我们提供了什么。</p><h1 id="561b" class="mj mk jj bd ml mm mn mo mp mq mr ms mt ky mu kz mv lb mw lc mx le my lf mz na bi translated">第1部分:入门</h1><h2 id="85c8" class="nb mk jj bd ml nc nd dn mp ne nf dp mt lq ng nh mv lu ni nj mx ly nk nl mz jp bi translated">获取推文:</h2><p id="6acb" class="pw-post-body-paragraph lh li jj lj b lk nm kt lm ln nn kw lp lq no ls lt lu np lw lx ly nq ma mb mc im bi translated">我试图使用Twitter API来检索关于该病毒的推文，但是，搜索API将历史呼叫限制为7天，幸运的是，我找到了一个名为GetOldTweets3的Python Twitter scraper，它帮助我解决了这个问题:</p><figure class="me mf mg mh gt iv"><div class="bz fp l di"><div class="nr ns l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">GetOldTweets3:当函数被调用时，日期和搜索字符串保持可配置</p></figure><p id="05c2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我发现在抓取Twitter时存在稳定性问题，导致当我达到Twitter配额时出现“HTTP错误429:太多请求”，或者当我与他们的服务器失去连接时出现“HTTP错误503:服务暂时不可用”。</p><p id="de9f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这两个错误都会导致收集到的数据丢失，<strong class="lj jt"> </strong> <em class="mi">所以try/except is your friend </em> …在这些异常的情况下，我要求函数在重试之前等待15分钟，并确保我为用户打印了大量的进度更新…包括函数超时时的计时器…</p><blockquote class="nt nu nv"><p id="4c81" class="lh li mi lj b lk ll kt lm ln lo kw lp nw lr ls lt nx lv lw lx ny lz ma mb mc im bi translated">第1次尝试(共3次)检索2020–05–30<br/>在HTTP请求期间发生错误:HTTP错误429:请求太多</p><p id="d897" class="lh li mi lj b lk ll kt lm ln lo kw lp nw lr ls lt nx lv lw lx ny lz ma mb mc im bi translated">第1次尝试(共3次)检索2020–05–30时出错。睡了15分钟。<br/>分钟睡眠:<br/> 0..一..2..3..四..5..6..七..8..9..10..11..12..</p></blockquote><figure class="me mf mg mh gt iv"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="3714" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在撰写本文时，我在3个月的时间里收集了伦敦人以“冠状病毒或covid或新冠肺炎或covid19”为搜索字符串的55万条推文，并将其作为每日csv文件保存在我的GitHub中。</p><p id="25c5" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">解析文本:</strong></p><p id="1403" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们想提取伦敦人在推特上谈论的人/事，这样我们就能找到情绪的主要驱动因素…</p><p id="cbca" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我尝试了一下spaCy的NLP管道:</p><p id="b43d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">首先使用词性标注器来检索专有名词(虽然它工作得很好，但我发现这不符合我的目标，因为它检索了许多非实体)。</p><p id="4fce" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">然后使用实体识别器来检索预训练管道识别为“人”或“组织”的任何东西。</p><p id="e73d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">然后(出于兴趣)我用EntityRuler覆盖了带有我自己的自定义列表的实体识别(我看了两个:Boris Johnson和NHS)。</p><p id="7979" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">尽管EntityRuler是最精确的，但它非常繁琐，需要为每个实体手动设置规则，所以我选择了实体识别器:</p><figure class="me mf mg mh gt iv"><div class="bz fp l di"><div class="nr ns l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">spaCy的NLP管道:将实体识别器应用于一列tweets</p></figure><h2 id="9f5d" class="nb mk jj bd ml nc nd dn mp ne nf dp mt lq ng nh mv lu ni nj mx ly nk nl mz jp bi translated">得分情绪</h2><p id="2619" class="pw-post-body-paragraph lh li jj lj b lk nm kt lm ln nn kw lp lq no ls lt lu np lw lx ly nq ma mb mc im bi translated">我特别使用了VADER (Valence Aware字典和情感推理器)Python库，因为它已经被调整来处理社交媒体上表达的情感。它结合了词典方法和基于规则的方法，在社交媒体上进行情感评分时提供了高水平的准确性。</p><p id="33f8" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">他们的GitHub提供了VADER研究论文的更多细节，但总结起来:</p><p id="5367" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">词汇法</strong>:</p><ul class=""><li id="dc9e" class="nz oa jj lj b lk ll ln lo lq ob lu oc ly od mc oe of og oh bi translated">情感评分从-4(非常负面)到+4(非常正面)不等，收集了10位独立评委的9000多字，他们自己也经历了审查过程。</li><li id="1d1c" class="nz oa jj lj b lk oi ln oj lq ok lu ol ly om mc oe of og oh bi translated">平均评分为0或评分标准偏差&gt; 2.5的功能被丢弃，留给我们一个包含7，500个已验证功能的词典。</li></ul><p id="efde" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">VADER不仅研究了单个单词的情感等级，还研究了句法对句子层次情感的影响…</p><p id="d88f" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jt">基于规则的方法:</strong></p><ul class=""><li id="b66f" class="nz oa jj lj b lk ll ln lo lq ob lu oc ly od mc oe of og oh bi translated">例如，“好”与“非常好”是程度修饰语“非常”增加句子中情感强度的一个例子。</li><li id="7e9c" class="nz oa jj lj b lk oi ln oj lq ok lu ol ly om mc oe of og oh bi translated">VADER方面已经制定了一些规则，来检测此类结构性因素，并根据经验对整体情绪进行加权。</li></ul><p id="f2b1" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">代码实现起来非常简单:初始化SentimentIntensityAnalyzer()类，然后应用polarity_scores()方法(这是我在map函数中做的)。这返回了一个数组，其中包含每条tweet的4个不同的情感指标:POS，COMPOUND，NEU，NEG。</p><figure class="me mf mg mh gt iv"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="22a2" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">3个分数(POS/NEU/否定)量化了该推文中包含POS/NEU/否定单词的比例(例如，POS =推文中的正面单词数/推文中的总单词数)。</p><p id="c503" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">然而，我决定在下面的分析中使用化合物(或化合价),因为它简洁地解释了两极的极性程度:正极和负极。相对于该文本的长度，它还被归一化为-1到+1之间的值(+1表示最大正值，-1表示最大负值)，从而可以用作比较度量。研究人员通常将得分&gt; 0.05分为积极，并且</p><h2 id="d6f4" class="nb mk jj bd ml nc nd dn mp ne nf dp mt lq ng nh mv lu ni nj mx ly nk nl mz jp bi translated">Correlation: Did sentiment vary with the spread of the virus?</h2><p id="9995" class="pw-post-body-paragraph lh li jj lj b lk nm kt lm ln nn kw lp lq no ls lt lu np lw lx ly nq ma mb mc im bi translated">I found a dataset on Kaggle that had collated Public Health England’s statistics on the cases and deaths from Coronavirus. I started to plot this in Matplotlib together with the average daily sentiment observed from the tweets:</p><figure class="me mf mg mh gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi on"><img src="../Images/716eb8995f022c9917a74b18a93078e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YjSh-xT-RgIfJjHgLx-GXg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Plotted: Negative Sentiment and Cases / Deaths</p></figure><p id="4d44" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">I learned a couple of things from seeing the data like this:</p><ol class=""><li id="6d1c" class="nz oa jj lj b lk ll ln lo lq ob lu oc ly od mc oo of og oh bi translated"><strong class="lj jt"> A.B.C .(总是在检查)</strong> <br/>在这一时期的开始，我注意到我收集的推文数量急剧减少，很快发现我的查询已经过时……<br/>-不要搜索标签，而是搜索文本，因为大多数推文不经常使用标签。<br/>——“COVID”取代了“冠状病毒”，成为频繁发微博者的便捷速记。<br/>因此，将搜索字符串更改为<em class="mi">“冠状病毒或covid或新冠肺炎或covid 19”</em>可以立即看到改进(见5月)。尽管如此，谢天谢地我还是有足够大的样本量。</li><li id="c404" class="nz oa jj lj b lk oi ln oj lq ok lu ol ly om mc oo of og oh bi translated"><strong class="lj jt">高水平的数据产生低水平的洞察力</strong> <br/>在如此高的聚合水平上，情绪通常围绕全球平均水平波动。</li></ol><h2 id="e384" class="nb mk jj bd ml nc nd dn mp ne nf dp mt lq ng nh mv lu ni nj mx ly nk nl mz jp bi translated">随着病毒的发展，我们是否看到了更多负面的推文？</h2><p id="bd5b" class="pw-post-body-paragraph lh li jj lj b lk nm kt lm ln nn kw lp lq no ls lt lu np lw lx ly nq ma mb mc im bi translated">是的，我们可以大致看到这一点。</p><p id="6132" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">例如，情绪(即复合得分)与每日死亡数的负相关性为-41%。当你给死亡人数加上一天的滞后时，这个数字增加到-50%，表明人们对前一天的消息可能有一些延迟反应。</p><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi op"><img src="../Images/b68931882c875220efede20d9327310c.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*rvLNqud3TtVsf9wCOX89Ww.png"/></div></figure><p id="8443" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在相关性的一些早期不稳定性之后，我们能够看到一些有趣的东西:</p><figure class="me mf mg mh gt iv gh gi paragraph-image"><div class="gh gi op"><img src="../Images/8f5d237fa8e9c6435369f47ef1f25e30.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*OfCn_VImxe_ZZPrY5j_4sg.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">关联历史:负面推文与每日死亡人数</p></figure><p id="0ae6" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这种相关性在3月和4月基本上是负的，即<em class="mi">“病例数/死亡数的增加(更为积极)与整体情绪的恶化(更为消极)相一致</em>。<em class="mi">“</em>这也是我们在观察情绪和病例/死亡趋势时看到的情况。</p><p id="0ab4" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">自那以后，这种相关性变成了积极的，即使每天的死亡人数变得很少，人们的情绪也保持相对不变，这表明伦敦人现在已经找到了他们愤怒的其他原因。</p><h2 id="b735" class="nb mk jj bd ml nc nd dn mp ne nf dp mt lq ng nh mv lu ni nj mx ly nk nl mz jp bi translated">结论</h2><p id="2ea7" class="pw-post-body-paragraph lh li jj lj b lk nm kt lm ln nn kw lp lq no ls lt lu np lw lx ly nq ma mb mc im bi translated">收集完数据后，我们现在准备更深入地了解伦敦人。</p><p id="a09d" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在下一篇文章中，我将会使用假设检验<em class="mi">(并且会大量使用！)</em>验证对不同组织的态度是否真的存在差异。我将展示如何设置测试，并解释我们在每个测试中所依赖的假设(以及如何测试这些假设)。</p><p id="2836" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们还将看到如何以wordcloud的形式可视化人们的真实意见…例如，我们将国民保健服务视为<em class="mi">、【关心】、【支持】、【英雄】、【保护】、【乐于助人】</em> …但我们对政府的看法是一样的吗？#掌声鼓励者对此有什么影响？</p><p id="0e13" class="pw-post-body-paragraph lh li jj lj b lk ll kt lm ln lo kw lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">《T4》第二部再见……</p></div></div>    
</body>
</html>