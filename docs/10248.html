<html>
<head>
<title>Beginner guide to build, compare, and evaluate Machine Learning models in under 10 minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初学者指南，在 10 分钟内构建、比较和评估机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/beginner-guide-to-build-compare-and-evaluate-machine-learning-models-in-under-10-minutes-19a6781830de?source=collection_archive---------35-----------------------#2020-07-19">https://towardsdatascience.com/beginner-guide-to-build-compare-and-evaluate-machine-learning-models-in-under-10-minutes-19a6781830de?source=collection_archive---------35-----------------------#2020-07-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="79cf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过 Python 示例笔记本，探索构建机器学习模型的主要步骤。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/9fd66b41f4ef2eff9d45b6935cb7160e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SABnYfT-DtAuwGOgkqs79g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">初学者指南，在 10 分钟内建立、比较和评估机器学习模型。约书亚·索蒂诺在<a class="ae ky" href="https://unsplash.com/s/photos/data-science?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3bad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本笔记本的目标是给出构建和评估机器学习模型的步骤的高级概述。这是通过将每一步总结成最短的形式来完成的，所以请记住，在现实生活中，每一步都要复杂得多。</p><p id="45b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">你可以跟着一起过来</em> <a class="ae ky" href="http://jooskorstanje.com/Machine_Learning_Example_Under_10_Minutes.html" rel="noopener ugc nofollow" target="_blank"> <em class="lv">完整笔记本</em> </a> <em class="lv">。</em></p><h2 id="f3e1" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">机器学习的步骤</strong></h2><ol class=""><li id="2428" class="mp mq it lb b lc mr lf ms li mt lm mu lq mv lu mw mx my mz bi translated"><strong class="lb iu">数据准备— </strong>检查并准备数据集</li><li id="3ea3" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu mw mx my mz bi translated"><strong class="lb iu">定义模型验证策略— </strong>在训练、验证和测试集中拆分数据</li><li id="4c40" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu mw mx my mz bi translated"><strong class="lb iu">模型开发— </strong>使用 Python 中的 sklearn 库构建三个不同的模型:随机森林、决策树、逻辑回归。<br/> <strong class="lb iu">模型评估和微调</strong>使用<a class="ae ky" rel="noopener" target="_blank" href="/gridsearch-the-ultimate-machine-learning-tool-6cd5fb93d07"> GridSearch </a>交叉验证</li><li id="73bb" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu mw mx my mz bi translated"><strong class="lb iu">型号选择</strong></li><li id="cb4d" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu mw mx my mz bi translated"><strong class="lb iu">最终模型评估</strong></li></ol><h2 id="339c" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">步骤 1:数据准备</h2><p id="6008" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">对于这个项目，我将使用现有的网络安全数据集。该数据集的目标是预测某个连接是否是网络攻击。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="4697" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据集包含许多历史连接数据。对于这些连接中的每一个，已经注册了关于它们的不同变量。我们还有一个变量来表示连接是否危险(网络攻击)。</p><p id="010c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">目标是开发一个能够“学习”如何区分正常连接和危险连接的模型。我们还不知道如何做到:我们的机器学习模型将不得不学习这一点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/c11025e03e78c9240d532bde4852ed1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bZHPtqTQT74_XeEkMDBcXQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这一行的结果:scikit learn 获取数据集。</p></figure><p id="169c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面我们看到了数据的快速打印。第一列给出了关于连接类型的信息，其他列是关于连接的数字信息(参见<a class="ae ky" href="http://kdd.ics.uci.edu/databases/kddcup99/kddcup99.html" rel="noopener ugc nofollow" target="_blank"> kddcup99 </a>以获得关于变量内容的更多详细信息)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/e6a4a3e69892aaf0b20ba57c09b2b905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*RPOHzuFD5Jxq5gL73vzUqQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这一行的结果:我们数据的前 5 行。</p></figure><p id="d31b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在现实生活中的机器学习案例中，我们需要检查这些数据，并找出我们应该使用哪些变量，或者我们应该明确忽略哪些变量。但这是一个简单的例子，所以我们按原样取数据，看看我们在 10 分钟内可以获得什么样的精度。因此，我们删除了关于连接类型的列，并且我们以相同的方式对待每种类型的连接。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="10cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还检查了因变量，我们注意到它不是我们想要的数字 1 对 0 格式。让我们改变这一点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/a68a01a10b6bcb1b09b34fbd5ef8a64c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KUpT8LSNlmz7w1AJ7RneuQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这是目标变量的格式。我们想把它转换成 0 和 1。</p></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="2e2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了快速了解数据，我们在数据中绘制了攻击和正常连接的计数。请注意，我们的数据是有偏差的，因为“攻击”连接比正常连接多得多。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/1f3e21e3384c9d3c57fdb850bffc7d6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*wnMGhmA9U4PtjMEz4x_lNA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">正常(0)连接和攻击(1)连接的最终分布不是 50–50。</p></figure><h2 id="7c2e" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">第二步:定义模型验证策略:训练验证测试分割</strong></h2><p id="7103" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">为了验证任何预测模型，我们最好将一部分数据分开。当完成开发一个模型时，我们将能够在这个测试数据上应用它。这允许我们在实际部署模型之前，测量我们的模型在现实生活中的效果。</p><p id="d46b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有很多观察结果，所以我们可以允许分成三个部分:训练、验证、测试。在数据较少的情况下，我们通常一分为二:训练和测试。</p><ul class=""><li id="ceb6" class="mp mq it lb b lc ld lf lg li no lm np lq nq lu nr mx my mz bi translated"><em class="lv">训练数据</em>:用于开发 3 个模型，并通过超参数调谐(网格搜索)进行微调</li><li id="6ca1" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nr mx my mz bi translated"><em class="lv">验证数据</em>:用于型号选择</li><li id="df5b" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nr mx my mz bi translated"><em class="lv">测试数据</em>:用于对我们的分类模型的样本外精度有一个客观的最终估计</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><h2 id="d8b4" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">第三步:模型开发</strong></h2><p id="9d69" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">在模型开发步骤中，我们将构建三个不同的模型，并应用<a class="ae ky" rel="noopener" target="_blank" href="/gridsearch-the-ultimate-machine-learning-tool-6cd5fb93d07"> GridSearch </a>进行超参数调整。实际上，测试三个模型是您应该测试的最少模型数量。尝试更多的模型有更高的机会找到一个伟大的结果！</p><p id="a6db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用的三种模型是:</p><ul class=""><li id="c4d8" class="mp mq it lb b lc ld lf lg li no lm np lq nq lu nr mx my mz bi translated">随机森林</li><li id="8467" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nr mx my mz bi translated">决策图表</li><li id="649a" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nr mx my mz bi translated">逻辑回归</li></ul><p id="47f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了玩模型的选择，我们还可以玩每个模型的超参数的选择。有一种自动化的方法可以测试大量的超参数组合，并保留最佳评分超参数组合:<a class="ae ky" rel="noopener" target="_blank" href="/gridsearch-the-ultimate-machine-learning-tool-6cd5fb93d07">网格搜索</a>。</p><p id="8d74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将使用 GridSearchCV 调整以下超参数:</p><ul class=""><li id="7752" class="mp mq it lb b lc ld lf lg li no lm np lq nq lu nr mx my mz bi translated">对于随机森林:“最大特征”</li><li id="558e" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nr mx my mz bi translated">对于决策树:“最大特征”和“最小样本分割”</li><li id="d231" class="mp mq it lb b lc na lf nb li nc lm nd lq ne lu nr mx my mz bi translated">对于逻辑回归:“C”</li></ul><p id="a6bf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">步骤 3a:随机森林超参数调整</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/062d070fa115cc2153f891cbe3eef7d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ikOwvyNnVJIUBgnA-fK_yQ.png"/></div></div></figure><p id="a14d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">步骤 3a 结果:对验证数据应用随机森林并打印 roc_auc_score </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/013f0319f746b62301b96f9690e1fcf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sueABjb5UnHRk-OYf2PEuA.png"/></div></div></figure><p id="85f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">99%很高！</p><p id="c6f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">步骤 3b:决策树超参数调整</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/e5523d7cf3aeab3e93867cb748cb78e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g7FfXYHy-uBMZ0tcLAGWJQ.png"/></div></div></figure><p id="5a37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">步骤 3b 结果:对验证数据应用决策树并打印 roc_auc_score </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/1bd5c17485b32f6e68bf51c87411f3ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b5OJ_jeIgKbo2gOcKjDaoQ.png"/></div></div></figure><p id="19f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">也 99%，也很高！</p><p id="5b89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">步骤 3c:逻辑回归超参数调整</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/1c168a82539d3a2c2014263fdeed1c3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h_zSCsGNk_TMnOcBbUdlZQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/a93a62f74f8ad9027d233953e15a3291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*weLqpPKS2tHMoDX4tY_DJQ.png"/></div></div></figure><p id="62f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">步骤 3c 结果:对验证数据应用逻辑回归并打印 roc_auc_score </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/513f11aaac2676c0ddabf25de2065cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xG92L3q4i9Ozr-f__viRTw.png"/></div></div></figure><p id="d8d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">94%也高，但是有点不太好。</p><h2 id="bb64" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">第四步:在验证数据集上选择性能最佳的模型</strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/190a9dad680161fa695910a82bca8aba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_9QInffgNYC9kZIedqXgRA.png"/></div></div></figure><p id="9b5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据 GridSearch 的分数，选择的模型将是随机森林！</p><h2 id="7259" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated"><strong class="ak">步骤 5:精度的最终估计:将选择的模型应用于测试数据</strong></h2><p id="4be8" class="pw-post-body-paragraph kz la it lb b lc mr ju le lf ms jx lh li nf lk ll lm ng lo lp lq nh ls lt lu im bi translated">为了获得随机森林准确性的最终估计，我们将其应用于测试数据。这为我们提供了一个新的准确度分数，该分数可能更接近于从任何新的(外部)数据中获得的分数。</p><p id="5129" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分数相差不大，可以保留模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/1912d406ef60a161e9ff4dd3abb184c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n_0M-7du2phDmgPq76Nfjg.png"/></div></div></figure><p id="8052" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">虽然机器学习建模的实际过程比这要复杂一点，但我希望这篇文章确实对需要采取的不同步骤进行了很好的高层次描述。记得你可以跟着</em> <a class="ae ky" href="http://jooskorstanje.com/Machine_Learning_Example_Under_10_Minutes.html" rel="noopener ugc nofollow" target="_blank"> <em class="lv">一起把</em> </a> <em class="lv">的完整笔记本拿过来。希望你喜欢这篇文章。感谢阅读，不要犹豫，继续关注更多！</em></p></div></div>    
</body>
</html>