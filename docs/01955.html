<html>
<head>
<title>The Ultimate Beginner Guide to TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">张量流初学者终极指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-ultimate-beginner-guide-to-tensorflow-af82fd4b8626?source=collection_archive---------11-----------------------#2020-02-24">https://towardsdatascience.com/the-ultimate-beginner-guide-to-tensorflow-af82fd4b8626?source=collection_archive---------11-----------------------#2020-02-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ae83" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何从零开始实现线性回归和梯度下降！</h2></div><blockquote class="ki"><p id="9390" class="kj kk it bd kl km kn ko kp kq kr ks dk translated">为什么是TensorFlow？我们已经有Keras了！</p></blockquote><figure class="ku kv kw kx ky kz gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/f89dc720dee27069a932f7fb25419759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/0*H5Wus5XpvcszBYee.jpg"/></div><p class="lc ld gj gh gi le lf bd b be z dk translated">图片来自<a class="ae lg" href="https://devclass.com/2020/01/09/tensorflow-2-1-makes-keras-play-nice-with-tpus/" rel="noopener ugc nofollow" target="_blank">朱莉娅·施密特</a></p></figure><p id="c059" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">当我们建立一个机器学习模型时，例如，一个用于分类图像的卷积神经网络，我们通常在高级库如<strong class="lj iu"> Keras </strong>之上设计我们的网络。</p><blockquote class="ki"><p id="1a74" class="kj kk it bd kl km mc md me mf mg ks dk translated">最终，Keras模型被转换成TensorFlow程序。</p></blockquote><h1 id="39f7" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">什么是张量流？</h1><p id="3d80" class="pw-post-body-paragraph lh li it lj b lk mz ju lm ln na jx lp lq nb ls lt lu nc lw lx ly nd ma mb ks im bi translated">TensorFlow于2015年由谷歌向公众开放源代码，是多年来从一个困境中吸取教训的结果:我们应该尝试用不灵活的库进行研究，以便我们不必重新实现代码，还是应该用一个库进行研究，用一个完全不同的库进行生产？</p><blockquote class="ne nf ng"><p id="0bd0" class="lh li nh lj b lk ll ju lm ln lo jx lp ni lr ls lt nj lv lw lx nk lz ma mb ks im bi translated">TensorFlow被做得灵活、高效、可扩展、可移植(<a class="ae lg" href="https://www.amazon.com/TensorFlow-Machine-Intelligence-Hands-Introduction/dp/1939902452" rel="noopener ugc nofollow" target="_blank">来源</a>)。任何形状和大小的计算机都可以运行它，从智能手机一直到大型计算集群。TensorFlow包含了开源社区和大公司的稳定性。</p></blockquote><p id="e4f0" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">TensorFlow主要用于指用于构建和训练机器学习模型的API，而TensorFlow实际上是一个软件包:</p><ul class=""><li id="783a" class="nl nm it lj b lk ll ln lo lq nn lu no ly np ks nq nr ns nt bi translated"><strong class="lj iu"> TensorFlow API </strong>通过Python Keras中的用户友好环境访问，而实际计算是用C++编写的，以提高效率。</li><li id="1d3a" class="nl nm it lj b lk nu ln nv lq nw lu nx ly ny ks nq nr ns nt bi translated"><strong class="lj iu"> TensorBoard </strong>，一款可以洞察模特行为的图形可视化软件。这对于分析训练和调试TensorFlow代码非常有用。</li><li id="a5aa" class="nl nm it lj b lk nu ln nv lq nw lu nx ly ny ks nq nr ns nt bi translated"><strong class="lj iu"> TensorFlow Serving </strong>，一个高性能的轻量级服务器，可以获取输入数据，将其传递给训练好的模型，并从模型返回输出。此外，它可以无缝地将旧型号切换为新型号，不会给最终用户带来任何停机时间。</li></ul><h1 id="e31e" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz nz ka mt kc oa kd mv kf ob kg mx my bi translated">为什么是TensorFlow，而不是Keras？</h1><p id="ea9e" class="pw-post-body-paragraph lh li it lj b lk mz ju lm ln na jx lp lq nb ls lt lu nc lw lx ly nd ma mb ks im bi translated">现在，我们在问，既然已经有了Keras，为什么还要直接使用TensorFlow呢？以此类推，当你有Wordpress来构建网站时，为什么还要开发HTML代码呢？</p><p id="716c" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">嗯，如果你正在研究新的机器学习架构，<strong class="lj iu"> TensorFlow非常灵活，对你的想象力非常有用</strong>。通常，您从最近的研究文献中获取模型，并在TensorFlow中实现它们，而不是在Keras中。</p><p id="04c3" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">此外，如果您处于一个敏捷环境中，这要求您的模型在短时间内快速投入生产，<strong class="lj iu"> TensorFlow可以让您的团队能够在许多设备上扩展您的产品</strong>，包括Android设备和Raspberry Pi等小型计算机。您可以轻松地部署您的模型，在客户端的web浏览器上的web页面内运行！</p><h1 id="6ebb" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz nz ka mt kc oa kd mv kf ob kg mx my bi translated">计算图表</h1><p id="0f0e" class="pw-post-body-paragraph lh li it lj b lk mz ju lm ln na jx lp lq nb ls lt lu nc lw lx ly nd ma mb ks im bi translated">TensorFlow中的模型由计算图表示，这就像一系列链接在一起的函数，每个函数都将其输出传递给链中更远的其他函数。</p><p id="3654" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">图中的节点是圆形、椭圆形或方框，代表某种<strong class="lj iu">操作</strong>。边缘是传入和传出操作的实际<strong class="lj iu">值</strong>，通常绘制为箭头。下面，您会看到一个简单的图表，其中数据从左到右移动到compute (5*3) + (5+3)。</p><figure class="od oe of og gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="oh oi di oj bf ok"><div class="gh gi oc"><img src="../Images/59a7f12ed4112cf2ab9155bd68bbf385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nrs-C6djjVy2gOGqZEAjOA.png"/></div></div></figure><blockquote class="ki"><p id="ca87" class="kj kk it bd kl km kn ko kp kq kr ks dk translated">数据被称为张量，它只是矩阵的n维抽象。</p></blockquote><p id="8e58" class="pw-post-body-paragraph lh li it lj b lk ol ju lm ln om jx lp lq on ls lt lu oo lw lx ly op ma mb ks im bi translated">下面你可以看到它在TensorFlow代码中的样子。</p><figure class="od oe of og gt kz"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="702f" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">TensorFlow允许我们创建多个计算图，并在一个会话中运行它们。我们还可以定义占位符，占位符是张量对象，它们的值在运行时指定。</p><p id="93ea" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">例如，我们可能希望模型接受任意长度的单个向量，而不是两个离散的标量输入。在使用该图时，我们可能还希望累积一段时间内所有输出的总值。这就是占位符非常有用的地方。</p><p id="50a4" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">我们还可以将图形很好地分割成指定的范围。每次运行后，我们可能还想将图形的输出、所有输出的累计总数以及所有输出的平均值保存到磁盘，以便在TensorBoard中使用。</p><p id="d742" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">这篇文章并不旨在解释你应该知道的关于TensorFlow的一切。相反，我们将在下一节介绍一个实际的例子。</p><h1 id="f377" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz nz ka mt kc oa kd mv kf ob kg mx my bi translated">张量流线性回归</h1><p id="ec04" class="pw-post-body-paragraph lh li it lj b lk mz ju lm ln na jx lp lq nb ls lt lu nc lw lx ly nd ma mb ks im bi translated">让我们使用TensorFlow API实现并训练一个单神经元网络，用于线性回归。</p><p id="4368" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">线性回归任务在训练过程中通过识别使<em class="nh"> y_pred </em>和训练数据<em class="nh"> y </em>之间的均方误差最小化的直线<strong class="lj iu">y _ pred =𝑤∫𝑥+𝑏</strong>的权重<em class="nh"> w </em>和偏差<em class="nh"> b </em>来解决。</p><p id="28de" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">我们首先需要为回归数据<em class="nh"> X </em>和<em class="nh"> Y </em>定义占位符。权重和偏差由张量变量表示，张量变量是可变的，并且将在训练循环期间改变。损失函数计算为任意两个值<em class="nh"> y_pred </em>和<em class="nh"> y </em>的均方误差。</p><p id="6449" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">梯度下降通过定义损失函数的导数的占位符以及学习步骤来实现。在训练期间，权重和偏差将相对于梯度和学习率进行更新。</p><figure class="od oe of og gt kz"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="36e7" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">定义占位符后，我们现在可以用之前以字典形式准备的张量数据来填充我们的张量图。通过随机生成噪声线来创建合成训练数据。</p><p id="b009" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">在一个会话中，我们循环遍历各个时期。在每个时期，TensorFlow执行计算图。这更新了变量，即我们需要估计的权重和偏差。我们打印它们的值和误差，如下图所示。</p><figure class="od oe of og gt kz"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="od oe of og gt kz gh gi paragraph-image"><div class="gh gi os"><img src="../Images/e1490823d0ab27747d4a91db13baec70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*RTIPNVkGpUWlM_CZibe3PQ.jpeg"/></div></figure><p id="56b2" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">图形运行后，我们可以获取最后的权重和偏差值，并绘制出最终的回归线。</p><p id="57b6" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">我们在TensorFlow中用单个神经元进行的线性回归得到了87%的R2分数！</p><figure class="od oe of og gt kz"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="od oe of og gt kz gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/b225ba4424a06d7fa6e204adac2c8c73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*WyJ1Fn0Q0YbXwnHFEWZT3A.png"/></div></figure><figure class="od oe of og gt kz gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/74c2a5bb3ef1e3b82b3df972f2076cec.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*wnWV4MfbXRH6eeIRLFkdwA.png"/></div></figure><h1 id="dc36" class="mh mi it bd mj mk ml mm mn mo mp mq mr jz nz ka mt kc oa kd mv kf ob kg mx my bi translated">结论</h1><p id="dd2f" class="pw-post-body-paragraph lh li it lj b lk mz ju lm ln na jx lp lq nb ls lt lu nc lw lx ly nd ma mb ks im bi translated"><strong class="lj iu"> TensorFlow </strong>是一个开源软件库，专注于使用数据流图结构。节点表示数学运算，边表示在节点之间流动的多维数据数组(张量)。</p><p id="5edc" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated"><strong class="lj iu"> Keras </strong>是构建在<strong class="lj iu"> TensorFlow </strong>之上的高级API。</p><p id="f12b" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">虽然Keras更加用户友好，但TensorFlow提供了低级别的灵活性，尤其是当您需要实现自定义功能时。比如TensorFlow结合OpenCV对于物体检测非常有用。</p><p id="4e7c" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">Keras也可以在其他生态系统上运行，如Theano或CNTK。虽然您可能会找到一些Theano教程，但它已经不再处于开发中。作为Keras的替代品，Caffe缺乏灵活性，而Torch使用Lua。MXNet、Chainer和CNTK目前还没有广泛流行。你可以在这里找到TensorFlow和Torch <a class="ae lg" href="https://www.developereconomics.com/tensorflow-vs-pytorch" rel="noopener ugc nofollow" target="_blank">之间的一个基准。</a></p><p id="e682" class="pw-post-body-paragraph lh li it lj b lk ll ju lm ln lo jx lp lq lr ls lt lu lv lw lx ly lz ma mb ks im bi translated">在本文中，我们展示了为线性回归建立、训练和评估张量流模型是多么容易。如果你对学习如何用Keras做线性回归感兴趣，我下面的文章可能是你下一个令人兴奋的读物。</p><div class="ov ow gp gr ox oy"><a rel="noopener follow" target="_blank" href="/why-deep-learning-works-289f17cab01a"><div class="oz ab fo"><div class="pa ab pb cl cj pc"><h2 class="bd iu gy z fp pd fr fs pe fu fw is bi translated">深度学习为什么有效——循序渐进教程</h2><div class="pf l"><h3 class="bd b gy z fp pd fr fs pe fu fw dk translated">在开始是神经元:梯度下降，反向传播，回归，自动编码器，细胞神经网络…</h3></div><div class="pg l"><p class="bd b dl z fp pd fr fs pe fu fw dk translated">towardsdatascience.com</p></div></div><div class="ph l"><div class="pi l pj pk pl ph pm la oy"/></div></div></a></div></div></div>    
</body>
</html>