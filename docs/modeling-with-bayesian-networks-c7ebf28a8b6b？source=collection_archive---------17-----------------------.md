# 贝叶斯网络建模

> 原文：<https://towardsdatascience.com/modeling-with-bayesian-networks-c7ebf28a8b6b?source=collection_archive---------17----------------------->

## 从医学诊断建模导论

![](img/a48be6b35bbb4438b8adabf2327c9d85.png)

[国家癌症研究所](https://unsplash.com/@nci?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)在 [Unsplash](https://unsplash.com/s/photos/medical?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

我感觉不舒服。发烧。咳嗽。鼻塞。现在是冬天。我得了流感吗？很有可能。另外，我肌肉疼痛。更有可能。

贝叶斯网络非常适合这种类型的推理。我们有变量，有些变量的值是固定的。我们感兴趣的是给定这些固定值的一些自由变量的概率。

在我们的例子中，我们希望知道我们患流感的概率，给出我们观察到的一些症状，以及我们所处的季节。

到目前为止，它看起来像是用条件概率进行推理。还有更多的吗？是的。多得多。让我们放大这个例子，它就会出来。

**走向大规模贝叶斯网络**

想象一下，我们的网络模拟了每一种可能的症状，每一种可能的疾病，每一种可能的医学测试的结果，以及每一种可能影响某种疾病概率的外部因素。外部因素可以分为行为因素(吸烟、整天躺在沙发上看电视、吃得太多)、生理因素(体重、性别、年龄)和其他因素。为了更好的衡量，让我们也加入治疗。和副作用。

到目前为止，已经有足够的有用的医学知识来捕捉成千上万的变量(至少)及其相互作用。对于任何一组症状，加上一些行为、生理和其他外部因素的值，我们可以估计各种疾病的概率。还有更多。对于给定的疾病，我们可以要求它给出最可能的症状。还有更多。例如*我咳嗽、发高烧，但被诊断为流感，还可能有什么其他疾病*？对于给定的诊断，我们的特定症状，以及可能的其他因素，如我们的性别和年龄，我们可以要求它推荐治疗方法。

现在我们有所进展了。这些魔法是如何运作的？这就是我们在这里要探讨的。

**连通性**

第一个问题，*网*从何而来？来模拟成千上万个变量之间的相互作用。

建模这么多变量之间所有可能的相互作用几乎是不可能的。正是*网络*给了我们一种机制来穿越这种复杂性。通过让我们指定要建模的交互。目的是寻求一种足够丰富的模式。但不要过于复杂。

说到交互，我们如何决定对哪些进行建模？通常通过领域知识。在我们的案例中，利用了数千年临床实践和研究中获得的医学领域的集体知识。

我们的贝叶斯网会是什么样子？在结构上，一个巨大的有向图，有各种症状、疾病、医学测试、行为因素、生理因素和治疗方案的节点。用适当选择的(或推断的)弧线来模拟它们之间的重要相互作用。例如特定的症状和特定的疾病。

**连通性细化**

贝叶斯网络在结构上是一个有向图，一个无环图。*有向*意味着边缘有一个方向，这就是为什么它们被称为*弧*。*非循环*表示没有定向循环。这里举一个有向循环的例子:*A*→*B*→*C*→*A*。

除了无环性约束之外，建模者可以完全控制哪些节点与弧线连接以及如何定向它们。也就是说，在复杂的真实世界用例中，比如我们在这里讨论的(医疗诊断)，有一个吸引人的指导原则。

*选择弧线来模拟直接原因。将它们导向因果关系的方向*。

所以如果 *A* 是 *B* 的直接原因，我们就加弧 *A* → *B* 。这样的网络被称为*因果*贝叶斯网络。

因果网络的结构只和它的变量以及因果关系的保真度一样精确。例如，事实可能是 *A* 导致 *B* 并且 *B* 导致 *C* 。但是我们可能甚至不知道 B 的存在。所以我们能做的最好的事情就是通过弧线 *A* → *C* 来建模。

**因果建模**

好吧，让我们从医学角度来考虑因果关系。这是我们想出来的。

```
**Variable Type A causes Variable Type B        Example**disease         causes symptom            flu causes you to coughbehavior        causes disease            smoking causes lung cancerphysiological   causes disease            aging “causes” various    
factor                                    diseasestreatment       "causes" disease          chemotherapy reduces 
                                          cancertreatment       causes side-effect        chemotherapy causes 
                                          hair-loss
```

在结束这一部分之前，让我们注意一下，我们不应该太担心弄错一些因果弧。(当然，我们宁愿不要。)后果并不严重。事实上，我们很可能会在网络中发现一个新的非因果弧。对因果关系不明确或不存在的相关性进行建模。事实上，网络甚至分不清随意弧和非随意弧。在我们的用例中没有。

举这个例子。说 *A* 和 *B* 强相关。假设你认为 *A* 导致 *B* ，那么用圆弧 *A* → *B* 对此建模。但是你错了。添加这个弧线仍然是一件好事，因为它模拟了相关性。下一节将更详细地讨论非因果弧。

**非因果弧**

因果关系是网络设计中一个令人信服的指导原则。然而，这还不够。也就是说，添加非因果弧可以进一步改进模型。

考虑变量之间的相关性。例如在一组症状或一组疾病中。集合内的因果关系可能是未知的，甚至是不存在的。不过，我们确实想对相关性进行建模。所以要加上合适的“非因果”弧。

这里有一个简单的例子。说有强有力的证据证明*干呕* h 和*咽喉痛*相关。假设这是网络中仅有的两个变量。在任一方向上用弧线将它们连接起来将捕捉到这种相关性。不考虑弧线会将它们视为独立的。我们不想那样。

**网络的主方程**

在某些时候，就像一幅画可以展现一个远景一样，数学也可以。我们正处于这一阶段。所以现在开始。

形式上，贝叶斯网络是在 *n* 个节点上的有向无环图。这些节点，称之为 *X* 1、 *X* 2、…、 *X* n，模拟随机变量。弧线模拟了它们之间的相互作用。

更准确地说，网络的结构将 n 个变量的联合分布分解为

*P* (X1， *X* 2，…，Xn)= product _*I*P(*X*I |*双亲* (Xi))

这里有很多东西需要打开。先说:parents( *X* i)是有弧线进入 *X* i 的节点集合，嗯？

让我们用简单的例子慢慢来。都有相同的 5 个节点 A，B，C，D，e。

我们的第一个网络将没有弧线。所以没有一个节点有父节点。因此

P(A，B，C，D，E) = P(A)P(B)P(C)P(D)P(E)

我们的第二个网络将是一个马尔可夫链。在结构上，图是一条单路 A → B → C → D → E。节点 A 没有任何父节点。节点 B 的父节点是 a，节点 C 的父节点是 B，等等。因此

P(A，B，C，D，E) = P(A)P(B|A)P(C|B)P(D|C)P(E|D)

我们的第三个网络是朴素贝叶斯分类器，其中 E 作为类变量，A、B、C 和 D 作为预测变量。它的图形结构是

E → A，E → B，E → C，E → D

e 没有父母。A、B、C 和 D 中的每一个都有一个双亲:e。因此

P(A，B，C，D，E) = P(A|E)P(B|E)P(C|E)P(D|E)P(E

熟悉朴素贝叶斯分类器的读者会认识到这个等式右边的形式。把 A，B，C，D 看作预测值，E 看作类别变量。

现在我们已经准备好了一个临床例子。

**临床网络示例:流感及其症状**

考虑变量为*流感*、*发烧*、*咳嗽*、*鼻塞*、*季节*的网络。为简单起见，假设前四个是布尔型(是/否)，第三个是分类型(春、夏、秋、冬)。

因果建模将产生以下弧线:

```
flu → fever, flu → cough, flu → stuffy nose
```

让我们给它们加上弧线`flu` → `season`。这不是一个因果弧，也就是说，我们可以翻转它的方向。但我们不会。因此它的方向与从*流感*发出的因果弧线方向一致。这将有助于下一节中的诊断。

有趣的是，这不是巧合，这个网络的结构是朴素贝叶斯分类器。

**诊断:从症状到流感**

我们想要我们患流感的概率，假设我们有*发烧*、*咳嗽*、*鼻塞*和*冬季*。让我们把它正式表达为

```
P(flu = *yes* | fever = *yes*, cough = *yes*, stuffy nose = *yes*, *season* = *winter*)
```

或者更简明地(更笼统地)表述为

```
P(flu|fever,cough,stuffy nose, season)
```

为了推断这一点，我们只需应用贝叶斯法则:

```
numerator(x) = P(fever|flu=x)*P(cough|flu=x)*P(stuffy nose|flu=x)*P(season | flu=x)*P(flu=x)P(flu=yes|fever, cough, stuffy nose, season) = numerator(yes)/(numerator(yes)+numerator(no))
```

这就是为什么这个网络被称为贝叶斯网络。从症状到疾病的推断包括贝叶斯推理。

**“超越流感”网络**

我们已经有一个处方，所以让我们执行。首先，开始添加额外疾病和症状的节点。第二，为行为、生理因素、医学测试等添加节点。第三，按照前面给出的指导，开始添加更多的因果弧。诸如

```
smoking → lung cancer, aging → disease-1, aging → disease-2, …, aging → disease-*k* chemotherapy → cancer, chemotherapy → hair-loss
```

接下来，开始添加合适的非因果弧。捕捉症状之间的相关性、疾病之间的相关性等。

这种网络“主干”的宏观结构如下。

```
behaviors, physiological factors ⇒ diseases 
treatments ⇒ diseases
diseases ⇒ symptoms 
treatments ⇒ side-effects
```

测试？

复数形式的术语表示某些类型的节点集。比如疾病。X Y 表示从 X 到 Y 的一组圆弧。该级别不显示特定圆弧的首尾。

我们已经讨论过为什么弧集是这样定向的。我们之所以选择行为和生理因素来共同影响疾病，是因为这两类因素相互作用。例如，某些不良行为选择对某些疾病的不利影响在老年人中往往比在年轻人中更大。

事实上，疾病的宏观父母可以更加详细。诸如

```
behaviors, physiological factors, treatments ⇒ diseases
```

这将对所有三种类型的因素、*行为*、*生理因素*和*疾病治疗*的联合相互作用进行建模。也就是说，这种宏观层面的互动通常会产生一个相当复杂的网络。因此，为了传达主干的本质，我们将坚持我们早先的宏观结构。也就是说，例外情况，即影响特定疾病的特定三元组(*行为*、*生理因素*、*治疗*)总是可以添加进来的。宏观结构只是一个大的图景，而不是一个可执行的模式。该模式仅处于精细级别，由网络的弧线指定。

注意我们有一组节点， *tests* ，它是悬空的。我们将让您思考如何将这台电视机连接到网络的其余部分。我们应该做*检查**疾病*，还是*疾病**检查*，还是其他什么？

**培训“超越流感”网络**

训练意味着从数据、信念或组合中估计模型的各种概率分布*P*(*X*I |*parents*(Xi))。

**训练症状分布**

让我们从学习任何一个以其父母为条件的症状的概率分布开始。让我们做一个简化的假设，一个症状的母体只能是疾病。例如，症状*咳嗽*的父母会包括*流感*和*支气管炎*。

给定一个症状 *S* 及其父代 *pa* ( *S* )，条件概率表捕捉到*P*(*S*|*pa*(*S*))在 *pa* ( *S* )中的疾病数为指数。这是因为原则上 *pa* ( *S* )中 *n* 疾病的任何子集都可能发生。(我们所说的“发生”是指在特定的就诊中诊断出。)还有 2^n 这样的子集。当 *n* 较大时，这可能相当大。

三个因素将共同缓解这一问题。一个是，大多数症状不会有大量的父母，即大量的疾病可以导致他们。

第二，在任何情况下，被诊断的疾病将是父母的稀疏子集。诊断实例对应于拍摄显示症状的特定人的疾病状态的快照。在所有可能出现这种症状的潜在疾病中，一个人几乎肯定最多只能被诊断出几种。如果不止一个。这种稀疏性对训练有很大帮助。简单来说，稀疏意味着“没有显著的高阶相互作用”。下面的一个数值例子将说明这一现象。

第三个因素是，我们对我们认为包含在给定症状 *S* 的父母 *pa* ( *S* )集合中的内容有一些控制。如果症状的父集变得特别大，我们可以删除与症状不太相关的疾病。

**从数据中发现症状的父母**

我们应该将哪些疾病设置为给定症状 *S* 的父母？以前我们建议，作为一个通用的指导方针，使用领域知识。在我们的特殊情况下，有一个更好的方法。患者记录将揭示哪些症状与哪些疾病相关。因此，这方面的结构也可以从数据中有所收获。患者病历记录了许多专家在不同情况下做出诊断的集体智慧。

从数据中了解症状的父母的好处是巨大的。这避免了网络设计人员必须获取领域知识来完成这项工作——无论是通过与领域专家的讨论、扩展阅读还是一些更复杂的机制。即使这项工作被分配给一个大型的建模师和领域专家团队，这样的手工设计也是费力且容易出错的。症状太多，疾病太多。

也就是说，领域知识仍然可以帮助填补病人记录中可能没有涵盖的情况的空白，或者消除信念和数据之间的不一致。简单来说，领域知识+数据驱动学习一般比单独使用任何一种都要好。

我们将在下一节详细讨论患者就诊记录，因为我们无论如何都需要它们来学习网络的参数，例如在*P*(*S*|*pa*(*S*))中的概率。不管我们如何得出 *pa* ( *S* )的结构。

**患者就诊记录**

我们假设与医学专家的每一次互动都会生成一个新记录，记录观察到的症状和诊断出的疾病。如果诊断出多种疾病，那么观察到的哪些症状与哪种疾病有关也将被捕获。医学专家认为。诊断可以是确定的，也可以是专家认为合适的推测。我们所关心的是这是由专业人士做的。

让我们看一个病人就诊记录的例子。编造的。不是医学建议！

```
(*symptoms* = high fever, cough, sore throat, lump in throat; *disease* = flu)
(*symptoms* = lump in throat, chest pain; *disease* = gerd)
```

在这次访问中，确诊了两种疾病:*流感*和 *GERD* 。健康专家暗示两者都有咽喉肿块。

从这样的记录中，我们可以得到以症状为中心的表征，每个表征对应一个观察到的症状。这种表示列出了就诊期间与该症状相关的诊断疾病。这些疾病在就诊记录中也被称为症状的父母。

在我们上面的例子中，记录中*喉头肿块*的父母是*流感*和 *GERD* 。

以症状为中心的表征有助于学习症状分布。

**发现症状的父母**

从我们可以访问的所有患者就诊记录中收集以症状为中心的表征，我们可以很容易地确定症状的父母。这些都是这个数据所涉及的疾病。如果我们只能从单个病人就诊记录中学习的话,*喉咙哽咽*的父母应该是*流感*和 *GERD* 。

对于某些症状，大量不同的患者就诊记录可能会产生大量的父母。如前所述，我们可以通过删除与症状不太相关的父项来删减如此大的集合。

**根据患者就诊记录训练症状分布**

我们想知道，对于每一个症状，它的分布取决于它的父母。我们有一个以症状为中心的数据集可用于这项学习。(如前所述，这来源于患者就诊记录。)

考虑这个数据集中的任何一个实例。它列出了一个症状，以及在患者就诊期间与之相关的疾病。它没有列出症状父母中与*没有*牵连的疾病。正如我们将在下面看到的，我们也需要这些信息。幸运的是，我们可以通过从症状的父母中减去牵连疾病来推断这些疾病。

让我们看一个例子。说*咳嗽*的父母是*流感**肺炎**哮喘*。(在真实的网络中，这个列表将包括更多的疾病。)比如说*咳嗽*的父母在某个病历里是*流感*。由此，我们可以推断，在这种情况下*咳嗽*不是由*肺炎*或*哮喘*引起的。虽然在这种情况下，这种推断不是 100%正确的，但重复出现这种相同的推断确实给出了相关条件概率的良好估计。

从这两条信息——症状父母中的哪些疾病与特定患者记录有关，哪些不在特定患者记录中——我们将导出以下形式的训练向量。

```
cough flu pneumonia asthma
  1    1      0       0
```

这很容易读懂。它说，在这个患者记录中，咳嗽是存在的，并且在*咳嗽*的父母中，流感被诊断，肺炎未被诊断，哮喘未被诊断。

接下来，考虑一个患者记录，其观察到的症状列表不包括*咳嗽*。接下来，根据这组父母中的疾病是否在该记录中被诊断，导出该记录中*咳嗽*的父母的值。

这里有一个例子。假设患者记录导致了诊断

```
(symptoms = shortness of breath, chest pain, wheezing; diseases = asthma)
```

由此，我们可以得出记录

```
cough flu pneumonia asthma
  0    0      0       1
```

有了足够丰富的此类记录，当然随着人们在可预见的未来不断生病，这些记录还会不断增加，我们可以了解到 *P* ( *咳嗽* | *父母* ( *咳嗽*)。更广泛地说，任何症状的分布取决于其父母。

单独来看，这样的训练实例是完美的吗？不。在诊断中没有疾病并不意味着现在或不久就没有。这同样适用于症状。也就是说，在足够多样化的环境下，经过大量的训练，这种噪音应该会被信号淹没。例如，如果诊断流感的记录中只有 30%也显示咳嗽是一种观察到的症状，我们可以很有把握地推断流感产生咳嗽作为观察到的症状的时间不超过一半。

**训练行为和生理因素对疾病的影响**

这里我们提炼宏观结构

```
behaviors, physiological factors ⇒ diseases
```

我们将假设所需的信息也可能来自患者记录。

我们试图为每种疾病 *D* 估计以其双亲为条件的 *D* 分布的参数。 *D* 的父母是行为和生理因素的合适子集。哪些行为，哪些生理因素？这些可以通过领域知识来设置，因为关于哪些行为会影响哪些疾病已经知道了很多。(不利地或有利地。)同样对于生理因素。可选地或附加地，疾病的双亲也可以从数据中推断。

让我们从数据上来说明这样的训练。考虑以下患者记录

```
smoker, 50 years old, male, diagnosed: lung cancer
```

首先，从这些记录的集合中，我们可以推断肺癌的父母，即影响其诊断的行为和生理因素。与症状分布一样，我们需要另外两种类型的信息来估计*肺癌*在其父母已知的情况下的分布。

1.  在*肺癌*的特定诊断中，父母哪一方失踪了？
2.  如何估计一个人在部分父母在场的情况下不患肺癌的概率？

对于 1，与症状情况一样，缺失的父母是完整的父母集减去该患者记录中的父母集。对于 2，也是在症状的情况下，我们从患者记录中得到这些，其中一些父母患有肺癌，而患者被诊断为没有肺癌。一个例子是没有肺癌的吸烟者。我们如何决定一个因素是否“关键”？试试领域知识。

**训练治疗对疾病的影响**

我们这里有个问题。我们的宏观结构模式

```
behaviors, physiological factors ⇒ diseases 
treatments                       ⇒ diseases
```

也就是说，任何单一疾病 *D* 都会有两组亲本，一组涉及行为和生理因素的某些组合，另一组涉及治疗。当然，我们可以将这两组父母合二为一。广泛地这样做有前面讨论过的问题。也就是说，在特定疾病的背景下，行为、生理因素和治疗的特定三元组可能值得包括在内。(如前所述。)

总而言之，我们不想崩溃

```
behaviors, physiological factors ⇒ diseases 
treatments                       ⇒ diseases
```

到…里面

```
behaviors, physiological factors, treatments ⇒ diseases
```

一般来说。

**让两组父母分开**

那么，对于一种给定的疾病，我们如何将两组父母分开 *D* ？一种方法是为 *D* (我们称之为 *DI* )引入一个额外的变量，如下。

```
behaviors, physiological factors ⇒ *DI* treatments, DI                   ⇒ D
```

我们可以认为 *DI* 是对疾病发作的建模，D 是对疾病在一次或多次治疗后的下一个状态的建模。也就是说，这种方案无法模拟疾病对治疗的动态演变。这将要求 *D* 是 *DI* 的父代，这将违反贝叶斯网络上的无环性约束。

让我们看一个具体的例子。

```
diet, age, gender               → heart disease-I
heart-disease-I, treatment      → heart disease
```

**治疗和副作用**

让我们从简单的开始。每个副作用都有一个节点。我们对每种治疗都有一个节点。一个副作用的父母都是有那个副作用的治疗。

让我们看一个例子。

```
chemotherapy, bone marrow transplantation, …, → fatigue
```

在我们的网络中包含这样的弧有什么价值？一个是它让我们寻找对特定疾病既有效又有相对轻微副作用的治疗方法。

**在这个标度网络中的推论**

让我们从重复我们网络的宏观结构开始。这有助于了解网络适合什么类型的推理。

```
behaviors, physiological factors ⇒ diseases 
treatments                       ⇒ diseases
diseases                         ⇒ symptoms 
treatments                       ⇒ side-effects
tests ?
```

现在来看具体的推论。每一个后面都有一个关于它如何工作的解释。在这个解释中，我们关注的是是否以及如何从数据或领域知识中计算出各种概率。目的是深入了解网络结构如何简化各种计算。

在实践中，人们可能将推理算法用作黑盒，它将在幕后做任何事情。

如果我吸烟，我是女性，我 75 岁了，患肺癌的可能性有多大？

我们求 *P* ( *肺癌* | *抽烟*，*女*， *75 岁*)。

好消息是，这个推论所依据的所有观察结果都是肺癌患者的父母。

坏消息是，肺癌可能有额外的父母。这些需要被边缘化。边缘化包括平均这些额外的父母可以采取的各种价值，加权的概率。由于这些价值观的数量与新增父母的数量成指数关系，边缘化是一个缓慢的过程。确实存在复杂的算法来加速它。他们的讨论超出了本文的范围。

节点分布的常用限制可以缓存在节点上。可以认为这是附加到节点 *S* 上的，不仅是 *P* ( *S* | *父节点* ( *S* ))还有 *P* ( *S* | *子集* ( *父节点* ( *S* ))用于合适的*父节点*(*S*)然后可以适当地使用这种缓存的分发，减少即时边缘化的需要。

**本人吸烟，女，75 岁。我一直咳嗽。我有肺癌的可能性是多少？**

我们求 *P* ( *肺癌* | *抽烟*，*女*， *75 岁*，*持续咳嗽*)。根据贝叶斯法则，

```
P(lung cancer | smokes, female, 75 years old, persistent cough) =
P(smokes, female, 75 years old, persistent cough | lung cancer)*
**P(lung cancer)**/
**P(smokes, female, 75 years old, persistent cough)**
```

(稍后我们将解释粗体字体。)

接下来，我们利用一个重要的属性。

*给定其父节点*，节点有条件地独立于其非后代节点。

由于这是我们第一次在本帖中看到这个属性，让我们深入研究一下。考虑网络*A*→*B*→*C*。(一个马尔可夫链。)应用前述的条件独立概率，我们得到给定 *B* 的情况下 *C* 独立于 *A* 。即*P*(*C*|*B*， *A* )等于*P*(*C*|*B*)。或者换句话说，一旦我们观察到了*B*,*A*的值不会为预测 *C* 的值提供额外的信息。

将这种条件独立性应用于我们的情况给出

```
P(smokes, female, 75 years old, persistent cough | lung cancer) =
**P(smokes,female,75 years old|lung cancer)***
**P(persistent cough|lung cancer)**
```

好，现在让我们收集所有粗体的术语。这些都是有待估计的。我们在下面复制了它们。

```
**P(lung cancer)
P(smokes, female, 75 years old, persistent cough)
P(smokes,female,75 years old|lung cancer)
P(persistent cough|lung cancer)**
```

从一组足够丰富的患者记录中很容易估计出 P。一些有用的估计可能已经存在于公共领域。

*P* ( *持续咳嗽* | *肺癌*)也可以从患者记录中估计，作为诊断为*肺癌*的记录中具有*持续咳嗽*作为观察症状的部分。

为了估算 *P* ( *抽烟*，*女*， *75 岁*，*持续咳嗽*)，我们就调用独立性假设。这就给我们留下了 *P* ( *抽烟*)*P*(*年龄*)*P*(*持续咳嗽*)*P*(*女*)。前三个很容易从数据结合知识来估计。最后一个我们可以设置为 0.5。

稍微跑题一下，严格来说，上一段提到的变量并不都是完全独立的。例如，女性比男性长寿，所以年龄和性别至少是轻度相关的。

最后只剩下 *P* ( *抽烟*，*女*， *75 岁* | *肺癌*)。调理(*抽烟*、*女*、 *75 岁*)对*肺癌*使得前三者有条件*依赖*。因此，我们应该尽可能避免援引独立性。如果我们不能，那也不是世界末日。由此产生的推论仍然是有意义的解释。具体来说，它作为一个朴素贝叶斯分类器运行，根据作为条件独立结果治疗的*吸烟*、*女性*、*年龄*和*持续咳嗽*来预测*肺癌*。

**宏课**

从上述例子中得到的宏观教训是，当试图从一些观察到的生理因素和一些观察到的症状来诊断疾病时，生理因素可以被合理地假设为与给定疾病的症状无关。当然，老年人可能比年轻人更容易表现出某些症状。然而，当我们以某种疾病作为解释症状的附加条件时，相比之下，变老的额外影响是很小的。

什么癌症疗法副作用最小？

让我们用逻辑和概率的混合来表达这一点。我们寻求这样的治疗方法:P ( *癌症* | *T* )高，而对于每一种副作用 *SE* ，*P*(*SE*|*T*)低。这里的关键观察是，在两种概率中，作为条件的变量是我们试图计算其概率分布的变量的父变量。(在前面的句子中，如果“变量”一词引起了混淆，请将其替换为“事件”。)因此，我们可以利用网络的结构来高效地计算我们想要的东西。

**延伸阅读**

[https://www . science direct . com/science/article/pii/s 1532046418302041](https://www.sciencedirect.com/science/article/pii/S1532046418302041)

【https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5519723/】在本文中，疾病和症状提及也是从护士笔记等非结构化文本中提取的。为此，命名实体识别(NER)技术非常有用。(在这种情况下，命名实体是疾病和症状。)查看[https://towards data science . com/named-entity-recognition-in-NLP-be 09139 fa 7b 8](/named-entity-recognition-in-nlp-be09139fa7b8)了解更多关于 NER 的信息。

[http://www . cs . CMU . edu/～guest rin/Class/10701-S05/slides/bns-inference . pdf](http://www.cs.cmu.edu/~guestrin/Class/10701-S05/slides/bns-inference.pdf)此处为精辟示例

```
flu, allergy → sinus, sinus → headache, sinus → nose
```

请将此理解为“流感或过敏导致鼻窦，鼻窦导致头痛，鼻窦会妨碍鼻子的正常功能”。