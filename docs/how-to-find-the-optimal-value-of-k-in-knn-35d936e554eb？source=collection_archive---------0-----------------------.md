# å¦‚ä½•æ‰¾åˆ° KNN K çš„æœ€ä¼˜å€¼ï¼Ÿ

> åŸæ–‡ï¼š<https://towardsdatascience.com/how-to-find-the-optimal-value-of-k-in-knn-35d936e554eb?source=collection_archive---------0----------------------->

## å¯è§†åŒ–è¯¯å·®ç‡ä¸ K çš„å…³ç³»å›¾ï¼Œæ‰¾å‡ºæœ€åˆé€‚çš„ K å€¼ã€‚

![](img/e64c4c7248cd0189cf153ce2ccb88267.png)

å›¾ 1:é€šè¿‡[educba.com](https://www.educba.com/nearest-neighbors-algorithm/)æ‹æ‘„çš„ç…§ç‰‡

## ä»‹ç»

**K-æœ€è¿‘é‚»**æ˜¯**T5 ç”¨äºåˆ†ç±»å’Œå›å½’çš„ç›‘ç£æœºå™¨å­¦ä¹ ç®—æ³•ã€‚å®ƒå¤„ç†è®­ç»ƒæ•°æ®ï¼Œå¹¶åŸºäºè·ç¦»åº¦é‡å¯¹æ–°çš„æµ‹è¯•æ•°æ®è¿›è¡Œåˆ†ç±»ã€‚å®ƒæ‰¾åˆ°æµ‹è¯•æ•°æ®çš„ k ä¸ªæœ€è¿‘é‚»ï¼Œç„¶åç”±å¤§å¤šæ•°ç±»åˆ«æ ‡ç­¾æ‰§è¡Œåˆ†ç±»ã€‚**

å¯¹äºæ•°æ®ç§‘å­¦å®¶æ¥è¯´ï¼Œé€‰æ‹©æœ€ä½³ K å€¼ä»¥å®ç°æ¨¡å‹çš„æœ€å¤§å‡†ç¡®æ€§å§‹ç»ˆæ˜¯ä¸€é¡¹æŒ‘æˆ˜ã€‚æˆ‘å¸Œæœ›ä½ ä»¬éƒ½çŸ¥é“ knn èƒŒåçš„åŸºæœ¬æ€æƒ³ï¼Œä½†æ˜¯æˆ‘å°†åœ¨æœ¬æ–‡åé¢é˜æ˜ KNN çš„æ¦‚è¿°ã€‚è¦å…¨é¢äº†è§£è¿™ä¸ªç®—æ³•çš„å·¥ä½œåŸç†ï¼Œæˆ‘å»ºè®®é˜…è¯»ä¸‹é¢çš„æ–‡ç« :

> [k è¿‘é‚»ä»‹ç»:å¼ºå¤§çš„æœºå™¨å­¦ä¹ ç®—æ³•](https://www.analyticsvidhya.com/blog/2018/03/introduction-k-neighbours-algorithm-clustering/)

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†æ¼”ç¤ºåœ¨ knn ç®—æ³•ä¸­æ„ŸçŸ¥ K çš„ç†æƒ³å€¼çš„å¯å®ç°æ–¹æ³•ã€‚

# ç›®å½•

1.  KNN æ¦‚å†µ
2.  è·ç¦»åº¦é‡
3.  å¦‚ä½•é€‰æ‹©ä¸€ä¸ª K å€¼ï¼Ÿ
4.  KNN æ¨¡å¼å®æ–½
5.  å…³é”®è¦ç‚¹

æˆ‘ä»¬å¼€å§‹å§ï¼Œ

# 1.KNN æ¦‚å†µ

![](img/edc358819adf9a84c33750e5f1b473cf.png)

å›¾ 2:ç…§ç‰‡é€šè¿‡[kdnuggets.com](https://www.kdnuggets.com/2016/01/implementing-your-own-knn-using-python.html)

ä½¿ç”¨ K-æœ€è¿‘é‚»ï¼Œæˆ‘ä»¬é€šè¿‡æ‰¾åˆ°æµ‹è¯•ç‚¹å’Œè®­ç»ƒçš„ K ä¸ªæœ€è¿‘ç‰¹å¾å€¼ä¹‹é—´çš„è·ç¦»ï¼Œä»å¯ç”¨çš„ç±»åˆ«æ ‡ç­¾ä¸­é¢„æµ‹æµ‹è¯•ç‚¹çš„ç±»åˆ«ã€‚é€šè¿‡åˆ†ææ‰€æœ‰çš„ä¿¡æ¯ï¼Œä½ ä¼šæå‡ºä¸€ä¸ªé—®é¢˜ï¼Œ

## è·ç¦»æ€ä¹ˆç®—ï¼Ÿ

è®©æˆ‘åœ¨è·ç¦»åº¦é‡çš„ä¸‹ä¸€éƒ¨åˆ†å›ç­”ä½ çš„çƒ­æƒ…é—®é¢˜ã€‚

# 2.è·ç¦»åº¦é‡

è·ç¦»åº¦é‡æ˜¯æœ‰æ•ˆçš„è¶…å‚æ•°ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬æµ‹é‡æ•°æ®ç‰¹å¾å€¼å’Œæ–°æµ‹è¯•è¾“å…¥ä¹‹é—´çš„è·ç¦»ã€‚

![](img/7d364dde788acf689153b4f87c6b622c.png)

å›¾ 3:é€šè¿‡[slideplayer.com](https://slideplayer.com/slide/12735721/)æ‹æ‘„çš„ç…§ç‰‡

é€šå¸¸ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¬§å‡ é‡Œå¾—æ–¹æ³•ï¼Œè¿™æ˜¯æœ€å¹¿æ³›ä½¿ç”¨çš„è·ç¦»åº¦é‡ï¼Œç”¨äºè®¡ç®—æµ‹è¯•æ ·æœ¬å’Œè®­ç»ƒæ•°æ®å€¼ä¹‹é—´çš„è·ç¦»ã€‚æˆ‘ä»¬æ²¿ç€ä»ç‚¹(x1ï¼Œy1)åˆ°ç‚¹(x2ï¼Œy2)çš„ç›´çº¿æµ‹é‡è·ç¦»ã€‚

![](img/cf7ed8c01eba6c24f67e9857cc72de3d.png)

å›¾ 4:ç…§ç‰‡é€šè¿‡[slideplayer.com](https://slideplayer.com/slide/7529915/)

é€šè¿‡åˆ†æä¸Šé¢çš„è®¡ç®—ï¼Œæˆ‘å¸Œæœ›ä½ èƒ½ç†è§£æˆ‘ä»¬æ˜¯å¦‚ä½•è®¡ç®—æ¬§å‡ é‡Œå¾·è·ç¦»çš„ã€‚è®©æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹ KNN çš„é¢„æµ‹æ–¹æ³•ã€‚

![](img/140ea7a310923df356e1e6337c3c851f.png)

å›¾ 5:é€šè¿‡[datacamp.com](https://www.datacamp.com/community/tutorials/k-nearest-neighbor-classification-scikit-learn)çš„ç…§ç‰‡

## è¦å¯¹æœªçŸ¥è®°å½•è¿›è¡Œåˆ†ç±»:

*   åˆå§‹åŒ– K å€¼ã€‚
*   è®¡ç®—æµ‹è¯•è¾“å…¥å’Œ K ä¸ªè®­ç»ƒå¥½çš„æœ€è¿‘é‚»ä¹‹é—´çš„è·ç¦»ã€‚
*   æ£€æŸ¥æœ€è¿‘é‚»çš„ç±»åˆ«ï¼Œå¹¶ç¡®å®šæµ‹è¯•è¾“å…¥å±äºå“ªç§ç±»å‹ã€‚
*   å°†é€šè¿‡è·å¾—å¤šæ•°ç¥¨æ¥è¿›è¡Œåˆ†ç±»ã€‚
*   è¿”å›ç­çº§ç±»åˆ«ã€‚

æˆ‘ä»¬ç†è§£å¯¹æœªçŸ¥è®°å½•è¿›è¡Œåˆ†ç±»çš„è¿‡ç¨‹ï¼Œä½†æ˜¯é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜çš„ K å€¼å‘¢ï¼Ÿ

æˆ‘ä»¬æ¥å›ç­”ä¸€ä¸‹ã€‚

# 3.å¦‚ä½•é€‰æ‹©ä¸€ä¸ª K å€¼ï¼Ÿ

![](img/26a36e7fd60211970fe718dc9f85537e.png)

å›¾ 6:simplilearn.com é€šè¿‡[çš„ç…§ç‰‡](https://www.simplilearn.com/)

K å€¼è¡¨ç¤ºæœ€è¿‘é‚»å±…çš„è®¡æ•°ã€‚æˆ‘ä»¬å¿…é¡»è®¡ç®—æµ‹è¯•ç‚¹å’Œè®­ç»ƒæ ‡ç­¾ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚æ¯æ¬¡è¿­ä»£æ›´æ–°è·ç¦»åº¦é‡çš„è®¡ç®—ä»£ä»·å¾ˆé«˜ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ KNN æ˜¯ä¸€ä¸ªæ‡’æƒ°çš„å­¦ä¹ ç®—æ³•ã€‚

![](img/06c2a675746c234b0d4e5ef3c27bc788.png)

å›¾ 7:é€šè¿‡[datacamp.com](https://www.datacamp.com/)æ‹æ‘„çš„ç…§ç‰‡

*   ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœæˆ‘ä»¬ä» K=3 å¼€å§‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¢„æµ‹æµ‹è¯•è¾“å…¥å±äº B ç±»ï¼Œå¦‚æœæˆ‘ä»¬ä» K=7 å¼€å§‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¢„æµ‹æµ‹è¯•è¾“å…¥å±äº a ç±»ã€‚
*   è¿™å°±æ˜¯ä½ å¦‚ä½•æƒ³è±¡ K å€¼å¯¹ KNN æ€§èƒ½æœ‰å¼ºå¤§çš„å½±å“ã€‚

## é‚£ä¹ˆå¦‚ä½•é€‰æ‹©æœ€ä¼˜çš„ K å€¼å‘¢ï¼Ÿ

*   æ²¡æœ‰é¢„å…ˆå®šä¹‰çš„ç»Ÿè®¡æ–¹æ³•æ¥å¯»æ‰¾æœ€æœ‰åˆ©çš„ k å€¼ã€‚
*   åˆå§‹åŒ–ä¸€ä¸ªéšæœºçš„ K å€¼ï¼Œå¼€å§‹è®¡ç®—ã€‚
*   é€‰æ‹©å°çš„ K å€¼ä¼šå¯¼è‡´ä¸ç¨³å®šçš„å†³ç­–è¾¹ç•Œã€‚
*   è¾ƒå¤§çš„ K å€¼å¯¹äºåˆ†ç±»æ›´å¥½ï¼Œå› ä¸ºå®ƒå¯¼è‡´å¹³æ»‘å†³ç­–è¾¹ç•Œã€‚
*   **ç»˜åˆ¶è¯¯å·®ç‡å’Œ K ä¹‹é—´çš„æ›²çº¿å›¾ï¼Œè¡¨ç¤ºå®šä¹‰èŒƒå›´å†…çš„å€¼ã€‚ç„¶åé€‰æ‹©å…·æœ‰æœ€å°è¯¯å·®ç‡çš„ K å€¼ã€‚**

ç°åœ¨ä½ ä¼šå¾—åˆ°é€šè¿‡å®ç°æ¨¡å‹æ¥é€‰æ‹©æœ€ä¼˜ K å€¼çš„æƒ³æ³•ã€‚

# 4.KNN æ¨¡å¼å®æ–½

è®©æˆ‘ä»¬é€šè¿‡å¯¼å…¥æ‰€æœ‰å¿…éœ€çš„åŒ…æ¥å¯åŠ¨åº”ç”¨ç¨‹åºã€‚ç„¶åä½¿ç”¨ **read_csv()** å‡½æ•°è¯»å–ç”µä¿¡æ•°æ®æ–‡ä»¶ã€‚

![](img/9ece4b31f253d2149621c3df9bfade56.png)

å›¾ 8:ä¸»æ•°æ®é›†

> å¦‚æ‚¨æ‰€è§ï¼Œæœ‰ 12 åˆ—ï¼Œå³åœ°åŒºã€ä»»æœŸã€å¹´é¾„ã€å©šå§»ã€åœ°å€ã€æ”¶å…¥ã€å­¦å†ã€é›‡ä½£ã€é€€ä¼‘ã€æ€§åˆ«ã€å±…ä½å’Œå®¢æˆ·ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªç›®æ ‡åˆ—ï¼Œ**â€œcust catâ€**å°†å®¢æˆ·åˆ†ä¸ºå››ç»„:

*   1-åŸºæœ¬æœåŠ¡
*   2-ç”µå­æœåŠ¡
*   3+æœåŠ¡
*   4-å…¨é¢æœåŠ¡

![](img/bbe84f0a0a11229cadea19bb42308318.png)

å›¾ 9:K = 4 æ—¶çš„ç²¾åº¦æµ‹é‡

*   æˆ‘ä»¬å°†æ‰€æœ‰ç‹¬ç«‹çš„æ•°æ®ç‰¹å¾æ”¶é›†åˆ° X æ•°æ®æ¡†ä¸­ï¼Œå¹¶å°†ç›®æ ‡å­—æ®µæ”¶é›†åˆ° y æ•°æ®æ¡†ä¸­ã€‚ç„¶åæˆ‘ä»¬å¤„ç†æ•°æ®å¹¶ä½¿å…¶æ­£å¸¸åŒ–ã€‚
*   åˆ†å‰²æ•°æ®åï¼Œæˆ‘ä»¬å°† 0.8%çš„æ•°æ®ç”¨äºè®­ç»ƒï¼Œå…¶ä½™ç”¨äºæµ‹è¯•ã€‚
*   æˆ‘ä»¬ä» sklearn åº“ä¸­å¯¼å…¥åˆ†ç±»å™¨æ¨¡å‹ï¼Œå¹¶é€šè¿‡åˆå§‹åŒ– **K=4 æ¥æ‹Ÿåˆæ¨¡å‹ã€‚**æ‰€ä»¥æˆ‘ä»¬åœ¨è¿™é‡Œè¾¾åˆ°äº† **0.32** çš„ç²¾åº¦ã€‚

ç°åœ¨æ˜¯æ—¶å€™æ”¹è¿›æ¨¡å‹ï¼Œæ‰¾å‡ºæœ€ä¼˜ k å€¼äº†ã€‚

![](img/86e4afa436ae9d73cba397b288cbb543.png)

å›¾ 10:è¯¯å·®ç‡ä¸ K å€¼çš„å…³ç³»

ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œåœ¨ K=37 æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°çš„æœ€å°è¯¯å·®ä¸º 0.59ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯è§†åŒ–äº†**ç²¾åº¦å’Œ K å€¼ä¹‹é—´çš„å…³ç³»ã€‚**

![](img/f4e93fb9201b7669f0fd850efe467551.png)

å›¾ 11:ç²¾åº¦ä¸ K å€¼çš„å…³ç³»

ç°åœ¨æ‚¨çœ‹åˆ°äº†æ”¹è¿›çš„ç»“æœã€‚æˆ‘ä»¬åœ¨ K=37 å¾—åˆ°äº† **0.41 çš„ç²¾åº¦ã€‚ç”±äºæˆ‘ä»¬å·²ç»æ¨å¯¼å‡ºäº†è¯¯å·®å›¾ï¼Œå¹¶åœ¨ k=37 æ—¶è·å¾—äº†æœ€å°è¯¯å·®ï¼Œå› æ­¤æˆ‘ä»¬å°†åœ¨è¯¥ K å€¼ä¸‹è·å¾—æ›´å¥½çš„æ•ˆç‡**ã€‚****

å› ä¸ºæˆ‘ä»¬çš„ä¸»è¦é‡ç‚¹æ˜¯ç¡®å®šæœ€ä½³ K å€¼ï¼Œä½†æ˜¯ï¼Œæ‚¨å¯ä»¥æ‰§è¡Œæ¢ç´¢æ€§æ•°æ®åˆ†æï¼Œç”šè‡³å¯ä»¥å®ç°æ›´é«˜çš„å‡†ç¡®æ€§ã€‚æ•°æ®æ–‡ä»¶å’Œä»£ç åœ¨æˆ‘çš„**[**GitHub**](https://github.com/Amey23/Machine-Learning/tree/master/K-Nearest%20Neighbor)åº“ä¸­ã€‚**

# **5.å…³é”®è¦ç‚¹**

*   **æˆ‘ä»¬åœ¨ k=37 æ—¶è·å¾—äº† **0.41 çš„ç²¾åº¦ï¼Œæ¯” k=4 æ—¶è®¡ç®—çš„æ•ˆç‡è¦é«˜ã€‚****
*   ****å° K å€¼ä¸é€‚åˆ**åˆ†ç±»ã€‚**
*   **é€šå¸¸æ‰¾åˆ°çš„æœ€ä½³ K å€¼æ˜¯ N çš„å¹³æ–¹æ ¹**ï¼Œ**å…¶ä¸­ N æ˜¯æ ·æœ¬æ€»æ•°ã€‚**
*   **ä½¿ç”¨è¯¯å·®å›¾æˆ–ç²¾åº¦å›¾æ‰¾åˆ°æœ€æœ‰åˆ©çš„ K å€¼ã€‚**
*   **KNN åœ¨å¤„ç†å¤šæ ‡ç­¾ç±»æ—¶è¡¨ç°è‰¯å¥½ï¼Œä½†æ˜¯æ‚¨å¿…é¡»æ³¨æ„å¼‚å¸¸å€¼ã€‚**
*   **KNN å¹¿æ³›åº”ç”¨äº**æ¨¡å¼è¯†åˆ«**å’Œ**åˆ†æè¯„ä»·**é¢†åŸŸã€‚**

**æ‰€æœ‰äººéƒ½åœ¨è¿™é‡Œï¼Œ**

**åœ¨æˆ‘çš„ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­å†è§ã€‚**

> **ä½ å¥½ğŸ‘‹æˆ‘å¸Œæœ›ä½ èƒ½ä»æˆ‘çš„æ–‡ç« ä¸­è·å¾—çŸ¥è¯†ã€‚å¦‚æœä½ æ„¿æ„æ”¯æŒæˆ‘ï¼Œè¯·éšæ„ç»™æˆ‘ä¹°äº›å’–å•¡ğŸ™â˜•**
> 
> **[**https://www.buymeacoffee.com/amey23**](https://www.buymeacoffee.com/amey23)**
> 
> ****æˆ–é€šè¿‡ ameypband23@gmail.com è”ç³»æˆ‘****
> 
> ****ä¹æ„ä¸ºæ‚¨æ•ˆåŠ³ã€‚****
> 
> **å‚è€ƒæ–‡çŒ®:[ç›‘ç£æœºå™¨å­¦ä¹ ä¸­çš„è‚˜æ–¹æ³•](https://medium.com/@moussadoumbia_90919/elbow-method-in-supervised-learning-optimal-k-value-99d425f229e7)**

**[](https://github.com/Amey23/Machine-Learning/tree/master/K-Nearest%20Neighbor) [## amey 23/æœºå™¨å­¦ä¹ 

github.com](https://github.com/Amey23/Machine-Learning/tree/master/K-Nearest%20Neighbor)**