<html>
<head>
<title>Building a Coronavirus Outbreak SMS Alert System!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建冠状病毒爆发短信预警系统！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-coronavirus-outbreak-sms-alert-system-d80f4d648eea?source=collection_archive---------22-----------------------#2020-02-18">https://towardsdatascience.com/building-a-coronavirus-outbreak-sms-alert-system-d80f4d648eea?source=collection_archive---------22-----------------------#2020-02-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/dce867f451c892cf7a6dc32b19889b15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*byuk4BeuhHy0t_fmHC4J8g.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@thedotter" rel="noopener ugc nofollow" target="_blank"> @thedotter </a>拍摄</p></figure><div class=""/><div class=""><h2 id="4769" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">使用Python来控制疫情</h2></div><p id="d74c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于最近冠状病毒在中国以及亚洲其他国家爆发，世界其他地区的人们越来越担心病毒会继续传播并最终到达他们的国家。截至撰写本文时，mainland China约有98%(超过70，000)的确诊病例，当局正在尽一切努力控制疫情。但是，这并不意味着我们不应该做好准备。</p><p id="592a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">考虑到这一点，我决定写一个Python脚本来帮助人们在他们的国家达到一定数量的确诊病例时设置警报触发器。例如，美国目前约有15例确诊病例，但例如，如果该数字达到30例(或任何其他数字)，则会触发警报，您会收到一条发送到手机的短信。</p><p id="cc78" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面，我将描述如何建立这个由网页抓取器和文本消息API组成的系统。</p><h1 id="9042" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">收集冠状病毒数据</h1><p id="ecf1" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">首先，我们需要一个数据源来检查是否应该触发警报。幸运的是，有很多网站提供实时更新。我选择从网上抓取这个由约翰霍普金斯系统科学与工程中心提供的实时仪表板，因为它看起来是最可靠的。</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ms"><img src="../Images/0a4b66ec69926b98c71fd98e0d5b6e9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-dCzHmihi0f1GszCik4lyA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">冠状病毒全球数据仪表板</p></figure><h2 id="e1fb" class="mx lv jj bd lw my mz dn ma na nb dp me lh nc nd mg ll ne nf mi lp ng nh mk ni bi translated">从浏览网站开始</h2><p id="09cb" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">为了找出我需要针对的元素，我从检查网站的源代码开始。这可以通过右击感兴趣的元素并选择<em class="mr"> inspect </em>来轻松完成。这将显示HTML代码，从中我们可以看到包含每个字段的元素。例如，获取与<em class="mr">确诊病例</em>相关的所有数据将有助于为每个国家设置触发器</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nj"><img src="../Images/a98c32d0227991849755ab7ec7c04508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hn57UqUxnfwzBayzR4_PvQ.png"/></div></div></figure><p id="b39c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过检查代码，我们可以很快意识到这个网站使用动态内容，而不是将其作为HTML源代码的一部分。因此最好的网络抓取工具是<code class="fe nk nl nm nn b">Selenium</code>。</p><h2 id="902b" class="mx lv jj bd lw my mz dn ma na nb dp me lh nc nd mg ll ne nf mi lp ng nh mk ni bi translated">开始刮！</h2><p id="686a" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated"><code class="fe nk nl nm nn b">Selenium</code>提供了多种在网站中查找和提取元素的方法，其中之一就是使用函数<code class="fe nk nl nm nn b">find_elements_by_xpath()</code>。此功能要求您通过网站中包含您感兴趣的信息的部分的<code class="fe nk nl nm nn b">XPath</code>,它将继续查找其所有元素。例如，我们可以按国家/地区复制名为<em class="mr">确诊病例部分的<code class="fe nk nl nm nn b">XPath</code>，以提取每个国家的确诊病例数</em></p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi no"><img src="../Images/d68271bbaa3cfce96cfa48efe5a10b28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UAHtX5WuDcLTHKd7TJX-2A.png"/></div></div></figure><p id="ef78" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是提取数据所需的带有<code class="fe nk nl nm nn b">XPath</code>和<code class="fe nk nl nm nn b">class</code>名称的代码:</p><figure class="mt mu mv mw gt iv"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="1823" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请记住，这只是我们可以提取的一组数据，我们可以应用相同的过程来提取网站中的任何其他部分，如<em class="mr">总恢复数</em>和<em class="mr">总死亡数。</em></p><h1 id="0eba" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">触发短信提醒！</h1><p id="4de1" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">为此，我们将使用设置非常简单的<a class="ae jg" href="http://www.twilio.com/referral/Ee6Yov" rel="noopener ugc nofollow" target="_blank"> Twilio API </a>。虽然Twilio不是免费服务，但它为新用户提供15美元的免费信用，一条文本大约1美分，应该足够我们的脚本运行一段时间了！首先去他们的<a class="ae jg" href="http://www.twilio.com/referral/Ee6Yov" rel="noopener ugc nofollow" target="_blank">网站</a>创建一个账户。</p><p id="8e0a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你去<a class="ae jg" href="https://www.twilio.com/console" rel="noopener ugc nofollow" target="_blank">控制台</a>，你会看到你的<code class="fe nk nl nm nn b">Account SID</code>和你的<code class="fe nk nl nm nn b">Auth Token</code>，留着以后用。也点击红色的大按钮“获取我的试用号”，按照步骤，并保存这个稍后。</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nr"><img src="../Images/5ee773de48a1a73b721dad8bc62e5952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xkcTK_GGiBO-38wMrw_wng.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Twilio控制台</p></figure><p id="b5eb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，您需要做的就是使用<code class="fe nk nl nm nn b">pip install Twilio</code>在您的计算机上安装软件包，并使用以下代码发送文本消息:</p><figure class="mt mu mv mw gt iv"><div class="bz fp l di"><div class="np nq l"/></div></figure><h1 id="bb93" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">把所有东西放在一起</h1><p id="5afb" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">既然我们已经知道了如何使用<code class="fe nk nl nm nn b">Selenium<br/></code>收集数据，使用<code class="fe nk nl nm nn b">Twilio</code>发送短信提醒，我们可以将所有代码放在一起构建一个提醒系统:</p><figure class="mt mu mv mw gt iv"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="f4bd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请记住，最佳实践是将Twilio <code class="fe nk nl nm nn b">Account SID</code>等敏感信息保存为环境变量，而不是将其存储为代码的一部分，这就是上面的代码引用<code class="fe nk nl nm nn b">TWILIO_SID</code>等变量的原因。此外，为了避免运行脚本时出现问题，需要进行大量的错误处理，但是上面的代码应该足够好，可以开始使用了。</p><h1 id="4e77" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">运行脚本</h1><p id="4413" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">从这里开始，有多种方法可以在一天中多次运行该脚本，以检查是否触发了任何警报。一种选择是将它本地托管在您的计算机或Raspberry Pi之类的设备上，并使用像<code class="fe nk nl nm nn b">cron</code> (Mac或Linux)或<code class="fe nk nl nm nn b">Task Scheduler</code> (Windows)这样的服务来安排脚本在一天内运行多次。在本文中，我将解释如何做到这一点:</p><div class="is it gp gr iu ns"><a rel="noopener follow" target="_blank" href="/web-scraping-mountain-weather-forecasts-using-python-and-a-raspberry-pi-f215fdf82c6b"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd jk gy z fp nx fr fs ny fu fw ji bi translated">使用Python和Raspberry Pi的网络抓取山区天气预报</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">从没有API的网站提取数据</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">towardsdatascience.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og ja ns"/></div></div></a></div><p id="6d03" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另一种选择是通过使用Heroku之类的服务将其托管在云上，但这超出了本教程的范围。</p></div><div class="ab cl oh oi hx oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="im in io ip iq"><blockquote class="oo"><p id="5ab3" class="op oq jj bd or os ot ou ov ow ox lt dk translated">这个项目的所有代码都可以在这个<a class="ae jg" href="https://github.com/avourakis/Coronavirus-SMS-Alert" rel="noopener ugc nofollow" target="_blank"> Github资源库</a>中找到，您可以下载并立即开始运行！</p></blockquote><h1 id="2d31" class="lu lv jj bd lw lx ly lz ma mb mc md me kp oy kq mg ks oz kt mi kv pa kw mk ml bi translated">未来的改进</h1><p id="39e1" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">这个项目原来很简单，但这主要是因为它没有太多的功能。以下是一些改进它的想法:</p><ul class=""><li id="33a3" class="pb pc jj la b lb lc le lf lh pd ll pe lp pf lt pg ph pi pj bi translated">通过短信定义警报触发器</li><li id="b555" class="pb pc jj la b lb pk le pl lh pm ll pn lp po lt pg ph pi pj bi translated">支持其他类型数据的触发器，如“总死亡人数”</li><li id="f703" class="pb pc jj la b lb pk le pl lh pm ll pn lp po lt pg ph pi pj bi translated">支持多个短信收件人</li></ul><p id="ee28" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我希望这篇文章对你有用。如果你有任何问题或反馈，我很乐意在下面的评论中阅读:)</p></div></div>    
</body>
</html>