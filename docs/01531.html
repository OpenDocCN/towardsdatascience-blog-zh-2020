<html>
<head>
<title>Should I include the intercept in my machine learning model?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我应该在我的机器学习模型中包含截距吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/should-i-inlcude-the-intercept-in-my-machine-learning-model-2efa2a3eb58b?source=collection_archive---------12-----------------------#2020-02-11">https://towardsdatascience.com/should-i-inlcude-the-intercept-in-my-machine-learning-model-2efa2a3eb58b?source=collection_archive---------12-----------------------#2020-02-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/28b16f1322af5f60f97908180e7f9a55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*isPHjzUfMhJpyAkOVldwkQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者拍摄的图片</p></figure><div class=""/><div class=""><h2 id="1bab" class="pw-subtitle-paragraph kf jh ji bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dk translated">并简要介绍了数据科学中的回归建模</h2></div></div><div class="ab cl kx ky hx kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="im in io ip iq"><p id="516a" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated"><em class="ma">“回归建模和变量之间的线性关系”</em>…这是我在数据科学和机器学习领域的第一堂课的名字。之前我们上过一些关于 GitHub 和 Python 的课程，但直到那天，班里的每个人都感觉到那种独特的大开眼界的感觉，终于理解了我们在大学时看到的一些概念的实际应用。在我的情况下，任何与数学和统计相关的东西都是我大约 10 年前最后一次访问的东西，所以我想可能是因为这个原因，我发现很难处理我们看到的一些东西。然而，在那次会议几个月后，在与我的一个妹妹交谈时，她完成了第一年的经济学课程，她惊讶地发现，她正在学习的所有抽象概念实际上都在现实生活中有实际应用。</p><p id="f41b" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">我们在大学是如何被教导的，我们可能会失去更好地学习这些基本概念的机会，这在这个故事中简直太多了，但有一点是肯定的:没有接受理想的形式(或至少接受“旧学校”类型的形式，几乎没有概念的实际应用)，加上在大学毕业多年后进入数据科学，这让我好几次甚至想不通最简单的概念，以理解一切。</p><p id="42a0" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">如果你觉得与此相关，今天我们将深入研究一个非常基本但关键的概念，当我们开始使用 Sklearn 库时，时间有时会被误解或被遗忘，一切都很简单，只需写下 linreg.fit(X，y)。</p><p id="5e57" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">顺便说一下，如果你真的想致力于整个机器学习和数据科学的东西，一个很好的建议是:刷新那些尘封的数学知识。这可能是你花时间思考未来的最佳方式。我知道，在数据科学的世界里有很多东西要学，但是你知道吗？技术和语言可能来来去去，但是这个领域的数学背景将会一直存在。我自己，我正在遵循一个为期一年的自我实现的道路。将来我可能会写一个或几个关于我学习经历的故事，所以请继续关注！</p><h2 id="db72" class="mb mc ji bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms mt bi translated">回归基础</h2><p id="e21e" class="pw-post-body-paragraph le lf ji lg b lh mu kj lj lk mv km lm ln mw lp lq lr mx lt lu lv my lx ly lz im bi translated">从今天的主题开始，让我们暂时回到基础知识，重新审视机器学习中回归建模背后的概念。</p><p id="c5b6" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">在线性回归中，我们希望从预测变量 X 预测连续的结果变量 Y，并且我们假设这两个变量之间存在线性关系。通常，除了这种关系，我们假设还有一个额外的转变:</p><p id="669d" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">y = B0 + B1*x</p><p id="a1d3" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">这里，B1 的值给出了直线的斜率，增加的常数 B0 给出了称为截距的额外偏移。当 B0 等于零时，最后一个元素表示目标变量(也称为“因变量”、响应变量、结果变量以及许多其他名称)的值。</p><p id="f926" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">让我们来看一个实际的例子。假设做一道我的名菜，我花了整整 10 分钟把所有东西都放好，然后再花 5 分钟为每个用餐者切好食材，再加上 10 分钟在烤箱上烹饪这道菜。在这种情况下，斜率是 5，截距是 20 --从 10 分钟的固定设置和 10 分钟的烹饪中得出。</p><p id="f120" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">因此，我们的等式可以转化为:</p><ul class=""><li id="8db9" class="mz na ji lg b lh li lk ll ln nb lr nc lv nd lz ne nf ng nh bi translated">Y = 5X + 20</li></ul><p id="56da" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">因此，如果我今晚在家接待 4 个人吃饭，这就是我为所有客人和我做的名菜:</p><ul class=""><li id="7593" class="mz na ji lg b lh li lk ll ln nb lr nc lv nd lz ne nf ng nh bi translated">Y = 5*5 + 20 = 45 分钟</li></ul><figure class="nj nk nl nm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ni"><img src="../Images/75ad6cc55b4e8db442b98b2294c8b5dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ARGCjR2iyfjX9tOb"/></div></div></figure><p id="3f30" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">由于 B1 等于每位用餐者精细切菜的分钟数，我们的等式中可以有更多的项，例如，B2 可能是每位用餐者额外的购物分钟数，B3 可能是每位客人额外的烹饪分钟数，等等，以类似这样的形式结束:</p><p id="9d40" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">Y = B1x + B2x + B3x + … + Bnx + B0</p><p id="8cce" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">而 sklearn 是如何找到可能的最佳方程的呢？</p><p id="ba36" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">嗯，都是优化/最小化问题。最小二乘法是回归分析中的一种标准方法，其目标是最小化每个方程结果的残差平方和。</p><figure class="nj nk nl nm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nn"><img src="../Images/bcc83404c4b57e66c677993629359930.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GRG7vMHIb3DKch7D"/></div></div></figure><p id="6d67" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">其中:</p><ul class=""><li id="9390" class="mz na ji lg b lh li lk ll ln nb lr nc lv nd lz ne nf ng nh bi translated">易才是真正的价值</li><li id="7208" class="mz na ji lg b lh no lk np ln nq lr nr lv ns lz ne nf ng nh bi translated">yi 是预测值</li><li id="5b79" class="mz na ji lg b lh no lk np ln nq lr nr lv ns lz ne nf ng nh bi translated">N 是数据集/样本中的元素总数</li></ul><p id="3da0" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">为什么我们使用平方值而不仅仅是绝对值？只是为了增加对预测值和实际值之间较大差异的惩罚。</p><p id="b81f" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">以我们之前的例子为例，暂时忘记我们知道初始方程的解，其中我们只有 B1，即每位用餐者精细切碎食材的分钟数。现在假设我们不知道 B1 的值，但我们知道为以下数量的客人烹饪整道菜需要多少钱:</p><p id="c088" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">游客数量= x = [1，3，5，10，15，20]</p><p id="463d" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">总分钟数= y = [25，35，45，70，95，120]</p><p id="5a91" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">如果我们试图用等于 20 的截距和等于 3 的 B0 解这个方程，我们将得到烹饪分钟总数的下列值:[25，35，45，70，95，120]。继续上面的等式，我们将得到 506.67 的 MSE。同样，保持相同的截距，但 B0 等于 6，我们将得到[26，38，50，80，110，140]和 126.67 的 MSE。因此，对于我们的 B0 系数，6 比 3 更合适。如果我们继续尝试这些值，直到找到最准确的值，我们将会做一些与 Sklearn 实际做的非常相似的事情。只是 Sklearn 对此使用了一种叫做梯度下降的东西。如果你想了解更多这方面的内容，我向你推荐来自 Sagar Mainkar 的这个故事。</p><p id="7328" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">在我们进一步深入了解截距之前，值得一提的是，除了 MSE，我们还可以找到其他评估指标，如平均绝对误差或平均对数误差。前者对数据集中的所有值进行相同的惩罚，而后者对更高的值进行更大的惩罚。如果需要，我们甚至可以创建自己的误差函数，遵循类似的逻辑或者其他更适合我们业务模型的逻辑。</p><h2 id="4279" class="mb mc ji bd md me mf dn mg mh mi dp mj ln mk ml mm lr mn mo mp lv mq mr ms mt bi translated">那拦截是怎么回事？</h2><p id="c54c" class="pw-post-body-paragraph le lf ji lg b lh mu kj lj lk mv km lm ln mw lp lq lr mx lt lu lv my lx ly lz im bi translated">如前所述，截距是我们的目标变量的值，当我们所有的特征为零，我们的函数穿过 y 轴。在 Sklearn 中，我们可以通过使用任何线性模型的超参数，轻松地将截距包含或不包含在方程中。有时，当我们去掉截距时，我们的模型会变得更好，这几乎是奇迹。然而，记住这仅仅意味着我们强迫直线穿过原点。也就是说:当我们方程中的所有系数都等于零时，也就是说，我们所有的特征都等于零，那么我们的目标变量也将是零。这有意义吗？这取决于你的商业案例。</p><p id="4250" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">举以下例子:</p><ul class=""><li id="1e3a" class="mz na ji lg b lh li lk ll ln nb lr nc lv nd lz ne nf ng nh bi translated">假设我们根据浴室、卧室的数量、房龄以及是否有游泳池、阳台、花园和暖气等其他功能来预测一所房子的房间数量。如果所有这些都等于零，意味着该物业是一个新的建筑，没有卧室，没有浴室，没有列出的其他功能，这是否意味着该物业根本没有房间？也许是的。</li><li id="4cdd" class="mz na ji lg b lh no lk np ln nq lr nr lv ns lz ne nf ng nh bi translated">然而，另一方面，如果我们使用与以前相同的特征来预测房价，会不会是房产价值等于零？可能不会。我们会发现 X 永远不会为零的情况，因此，截距没有特别的意义。当这种情况发生时，我们可以简单地放弃截距，因为它不会告诉我们任何关于 X 和 y 之间的关系。</li></ul><p id="3134" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">当我们强制截距为零时，预测器的系数变得更强更大，这有时会被错误地解释为更重要。然而，在这种情况下，系数会变得更强，只是因为斜率会更陡，以便通过原点。不是因为我们有更强或更好的系数。也就是说，我们会人为地在我们的系数中强加那个重要性。</p><figure class="nj nk nl nm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nu"><img src="../Images/d60ee8076166ffe07f38e34bfb192669.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFXvnGV5ABwYbmzUp3RivQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来源:pexels 的免费图片</p></figure><p id="e4bf" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">这很棒，对吧？我们现在有一个非常简单直接的方法，来确定我们是否需要加权这个叫做截距的小东西，对吗？嗯，没那么快。有时候会有点棘手。当所有预测因子(B1，B2，B3 等。)是数字的和无中心的，它可以像前面提到的那样简单。由于截距是所有预测值都等于零时 Y 的值，因此只有当模型中的每个 X 实际上都有一些零值时，该值才有用。因此，如果我们只有一个特征，例如，某人的身高，我们不应该有任何接近于零的值，那么我们可以安全地放弃截距。然而，当我们拥有被虚拟化的<a class="ae nt" href="https://medium.com/swlh/what-are-categorical-variables-and-how-to-treat-in-machine-learning-fd078c09a9af?source=friends_link&amp;sk=d55d1f599f4c94d9e55c794eef2bddfe" rel="noopener">分类变量</a>或以均值为中心的<a class="ae nt" href="https://medium.com/@rrfd/standardize-or-normalize-examples-in-python-e3f174b65dfc" rel="noopener">特征时，会发生什么呢？</a></p><p id="559f" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">正如你可能知道的，当我们<a class="ae nt" href="https://medium.com/@rrfd/standardize-or-normalize-examples-in-python-e3f174b65dfc" rel="noopener">重新调整我们的预测变量</a>时，我们把它们都集中在它们自己的平均值上。意味着所有的 X 都等于零。因此，在这种情况下放弃截距可能不是最明智的想法，因为它是所有预测变量的平均值 Y，因此有意义。</p><p id="67fb" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">当我们有<a class="ae nt" href="https://medium.com/swlh/what-are-categorical-variables-and-how-to-treat-in-machine-learning-fd078c09a9af?source=friends_link&amp;sk=d55d1f599f4c94d9e55c794eef2bddfe" rel="noopener">虚拟的分类特征</a>时，截距的作用是一个完全不同的故事。虚拟变量将只取值 1 和 0，表示数据集的每个元素是否都观察到了这些特征。例如，如果我们的数据集中只有两个特征，第一个表明目标是不是狗，第二个告诉我们是不是猫，两个特征都等于零将告诉我们一些事情:Y 既不是猫也不是狗。您可以很容易地看到这个截距是如何变得有意义的。当我们处理已经集中的分类变量和数字特征的组合时，截距变得越来越重要，可能不应该被丢弃。</p><p id="72e8" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">总而言之，更好的办法是对我们的商业案例现实一点，而不是仅仅因为我们得到了更大的系数或更好的 R2 就强迫截距为零。当这种情况发生时，通常我们会强迫我们的模型在方程中加入更多的变量，只是为了解释无法解释的原因，因此，可能会过度拟合我们的模型。</p><p id="f4cf" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">好了，今天就到这里。请继续关注未来的故事，了解处理分类特征的其他技术。同时，我邀请你看看我最近的两个故事:</p><ul class=""><li id="799e" class="mz na ji lg b lh li lk ll ln nb lr nc lv nd lz ne nf ng nh bi translated"><a class="ae nt" rel="noopener" target="_blank" href="/its-official-time-doesn-t-exist-8c786530eca1?source=friends_link&amp;sk=65f4f8a97a96efccc3931faef4046595">官方说法:时间不存在</a>。谈如何处理时间特征？</li><li id="d3e9" class="mz na ji lg b lh no lk np ln nq lr nr lv ns lz ne nf ng nh bi translated">和<a class="ae nt" rel="noopener" target="_blank" href="/5-more-tools-and-techniques-for-better-plotting-ee5ecaa358b?source=friends_link&amp;sk=afd579f429a4890be0def79da8e28b57"> 5 个更好绘图的工具和技术</a></li></ul><p id="1092" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">此外，请随时访问我在 Medium 上的简介<a class="ae nt" href="https://medium.com/@gonzaloferreirovolpi" rel="noopener">，查看我的其他故事:)回头见！感谢您的阅读！</a></p><p id="8bdc" class="pw-post-body-paragraph le lf ji lg b lh li kj lj lk ll km lm ln lo lp lq lr ls lt lu lv lw lx ly lz im bi translated">来源:</p><ul class=""><li id="dace" class="mz na ji lg b lh li lk ll ln nb lr nc lv nd lz ne nf ng nh bi translated">材料来自我在<a class="ae nt" href="https://generalassemb.ly/" rel="noopener ugc nofollow" target="_blank">大会</a>的数据科学沉浸式课程</li><li id="4b16" class="mz na ji lg b lh no lk np ln nq lr nr lv ns lz ne nf ng nh bi translated"><a class="ae nt" href="https://www.theanalysisfactor.com/" rel="noopener ugc nofollow" target="_blank">https://www.theanalysisfactor.co</a>米</li></ul></div></div>    
</body>
</html>