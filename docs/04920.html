<html>
<head>
<title>From Analysis to Dashboarding-Connecting notebooks to Tableau</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从分析到仪表板——连接笔记本和表格</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/from-analysis-to-dashboarding-connecting-notebooks-to-tableau-483fa373f3a4?source=collection_archive---------19-----------------------#2020-04-29">https://towardsdatascience.com/from-analysis-to-dashboarding-connecting-notebooks-to-tableau-483fa373f3a4?source=collection_archive---------19-----------------------#2020-04-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="5347" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">现实世界中的数据科学。</h2><div class=""/><div class=""><h2 id="d107" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">这个故事讲述了在尝试和失败了许多方法后，我是如何从笔记本上创建梦想仪表盘的。在这里，我分享我是如何将我的数据帧连接到Tableau的。希望这篇博客能帮助那些在笔记本和仪表盘之间挣扎的人。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/1d2cb8c53f8b21debf72e928cdad1843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T-iADds-1lCncd92GIIyhA.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">卢克·切瑟在<a class="ae le" href="https://unsplash.com" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="544f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">数据分析的大背景不仅仅是数据和获得见解，还包括让每个人都能理解这些信息。当时，作为数据科学的初学者，我接触了Jupyter笔记本电脑。笔记本就像其他演示媒体一样。它由单元格组成，您可以在其中放置代码，然后在单元格下运行和输出，它还带有一个markdown功能，您可以用基本的HTML记录您的代码。这些笔记本用于探索性数据分析，便于与队友分享您的工作成果。尽管它有Plotly、matplotlib等库，但对于非技术用户来说，它仍然不是现成的。</p><p id="9d13" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">例如，以新冠肺炎为例。世界各地的每个人都关心了解他们国家的日常状况。他们会选择一个记录了更多单元格、代码的笔记本，还是一个以交互形式分享你的分析可视化的仪表板？这就是为什么每个数据分析师都需要具备讲故事的技能。仪表板就像讲故事一样，你从你所获得的信息中构建一个故事，这个故事应该以一种不会让他们转移视线的方式呈现。</p><p id="7dad" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">所以问题是，我如何将我的jupyter笔记本连接到Tableau，而不需要在Tableau中安装python？</p><p id="5f49" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">答案很简单。Tableau只需要数据。jupyterlab的数据帧可以保存为CSV、Xls、JSON等格式，但在<strong class="lh ja">实时分析</strong>中，当数据每天都在更新时，每天从jupyter笔记本下载数据并上传到Tableau是低效的。</p><p id="2039" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">但是有一个解决方案，尽管笔记本电脑不支持数据库，因为它们的唯一目的是分析数据集。</p><p id="5b8e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">如何这些分析的数据集，准备可视化是发送到谷歌使用谷歌API表。因此，即使数据在每次刷新我们的笔记本时不断更新，我们从在线门户网站读取的数据也会在分析后自动保存到google sheets，tableau可以连接到这些数据表。<br/> <br/>因此，创建实时仪表板的任务非常简单。你要做的就是</p><ul class=""><li id="0b70" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">创建笔记本</li><li id="8580" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">从在线门户数据API读取数据到熊猫数据框架</li><li id="fa99" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">分析并创建一个干净而精确的数据报。</li><li id="25b4" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">将数据发送到google sheets。</li><li id="70e9" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">让我们将以下库导入笔记本</li></ul><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="fd6f" class="mu mv iq mq b gy mw mx l my mz">import gspread<br/>from oauth2client.service_account import ServiceAccountCredentials<br/>from df2gspread import df2gspread as d2g</span></pre><ul class=""><li id="4631" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">现在，在做任何事情之前，请按照以下说明获得对您的工作表的凭据访问权限:</li></ul><ol class=""><li id="5d68" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma na mh mi mj bi translated">前往<a class="ae le" href="https://console.developers.google.com/project" rel="noopener ugc nofollow" target="_blank">谷歌开发者控制台</a>创建一个新项目(或者选择一个你已经有的项目)。</li></ol><p id="f236" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">2.在“APIs &amp; Services &gt; Library”下，搜索“Drive API”并启用它。</p><p id="ca04" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">3.在“APIs &amp; Services &gt; Library”下，搜索“Sheets API”并启用它。</p><p id="2c44" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">4.<a class="ae le" href="https://gspread.readthedocs.io/en/latest/oauth2.html#enable-api-access" rel="noopener ugc nofollow" target="_blank">启用项目的API访问</a>如果你还没有这么做的话。</p><p id="1b6c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">5.转到“APIs &amp;服务&gt;凭据”并选择“创建凭据&gt;服务帐户密钥”。</p><p id="45ad" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">6.填写表格</p><p id="9e74" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">7.点击“创建密钥”</p><p id="890b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">8.选择“JSON”并点击“创建”</p><p id="1d0b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">您将自动下载一个带有凭证的JSON文件。它可能看起来像这样:</p><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="67fa" class="mu mv iq mq b gy mw mx l my mz">{<br/>    "type": "service_account",<br/>    "project_id": "api-project-XXX",<br/>    "private_key_id": "5ty … bg4",<br/>    "private_key": "-----BEGIN PRIVATE KEY-----<strong class="mq ja">\n</strong>NrDyLw … jINQh/9<strong class="mq ja">\n</strong>-----END PRIVATE KEY-----<strong class="mq ja">\n</strong>",<br/>    "client_email": "443000000000-msmhj@developer.gserviceaccount.com",<br/>    "client_id": "445 … hd.apps.googleusercontent.com",<br/>    ...<br/>}</span></pre><p id="3fba" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">记住下载的凭证文件的路径。同样，在下一步中，您将需要该文件中client_email的值。转到您的电子表格，并与上面步骤中的client_email共享。</p><ul class=""><li id="6e01" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">创建一个新的google工作表，将键复制到一个名为spreadsheet_key的变量中。粗体字将是我的工作表的关键。可在打开工作表的链接中找到)</li></ul><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="c487" class="mu mv iq mq b gy mw mx l my mz"><a class="ae le" href="https://docs.google.com/spreadsheets/d/1vdDT6k8lcWNMDYz13kqW7zXnIX5TVED9-4Kq7EAQnvI/edit#gid=0" rel="noopener ugc nofollow" target="_blank">https://docs.google.com/spreadsheets/d/<strong class="mq ja">1vd6hDT6k8lcWNMDYz13kqW7zXnIX5TVED9–4Kq7EAQnvI</strong>/edit#gid=0</a></span></pre><ul class=""><li id="e4b1" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">将以下代码添加到您的python脚本或笔记本中。另外，友情提示，在复制下面的代码之前，您刚刚下载的JSON文件和python脚本应该在同一个文件夹中。</li></ul><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="3be9" class="mu mv iq mq b gy mw mx l my mz">scope = [‘<a class="ae le" href="https://spreadsheets.google.com/feeds'" rel="noopener ugc nofollow" target="_blank">https://spreadsheets.google.com/feeds'</a>,<br/> ‘<a class="ae le" href="https://www.googleapis.com/auth/drive'" rel="noopener ugc nofollow" target="_blank">https://www.googleapis.com/auth/drive'</a>]<br/>credentials = ServiceAccountCredentials.from_json_keyfile_name(<br/> ‘myfile.json’, scopes=scope)<br/>gc = gspread.authorize(credentials)</span><span id="49cb" class="mu mv iq mq b gy nb mx l my mz">spreadsheet_key=’<a class="ae le" href="https://docs.google.com/spreadsheets/d/1vdDT6k8lcWNMDYz13kqW7zXnIX5TVED9-4Kq7EAQnvI/edit#gid=0" rel="noopener ugc nofollow" target="_blank"><strong class="mq ja">1vd6hDT6k8lcWNMDYz13kqW7zXnIX5TVED9–4Kq7EAQnvI</strong></a>’</span></pre><ul class=""><li id="e05c" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">现在清理您的数据集，并将准备可视化的数据保存到数据框中。</li><li id="32e6" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">复制并粘贴以下代码，将您的数据帧发送到google sheets。</li></ul><pre class="kp kq kr ks gt mp mq mr ms aw mt bi"><span id="88ae" class="mu mv iq mq b gy mw mx l my mz">wks_name= “nameofyoursheet”<br/>d2g.upload(df, spreadsheet_key, wks_name, credentials=credentials, row_names=True)<br/>print(“Data upload success”)</span></pre><p id="7190" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">wks_name将是您的工作表的名称，df将是您的dataframe变量。现在，每次刷新笔记本时，数据都会自动更新到工作表中，您可以通过数据API将数据读取到笔记本中，这样就可以轻松地使用jupyter notebook进行实时分析。</p><ul class=""><li id="3e7e" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">完成以上步骤后，打开Tableau，连接你的google sheets。要下载Tableau，请点击<a class="ae le" href="https://public.tableau.com/en-us/s/download" rel="noopener ugc nofollow" target="_blank">这里</a></li><li id="32a4" class="mb mc iq lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">若要连接，请前往服务器&gt; google sheets</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nc"><img src="../Images/86776c16a1b39369c3008c73033bf2a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c8IFVwM46uXbvvqSi0Jywg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">将google sheet添加到Tableau数据连接后(数据来源:<a class="ae le" href="http://data.gov.in" rel="noopener ugc nofollow" target="_blank"> OGD平台印度</a></p></figure><ul class=""><li id="d677" class="mb mc iq lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">使用工作表中的数据框在Tableau中创建可视化效果。每个可视化都可以在表格中完成，这就是他们所说的Tableau。这些表可以拖放到仪表板中。将您的仪表板发布到Tableau Public，就大功告成了。</li></ul><p id="cc79" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，由于数据每天都在变化，我们所要做的就是刷新笔记本和Tableau数据连接。你所有的可视化会自动更新。</p><p id="bed2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">Tableau相对于其他可视化库(如Plotly和matplotlib)的一个优势是，你可以零编码地获得可视化效果，这是非常专业的。</p><p id="b0e4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">点击<a class="ae le" href="https://public.tableau.com/views/Project_AQIanalysis/Dashboard1?:display_count=y&amp;:origin=viz_share_link" rel="noopener ugc nofollow" target="_blank">此处</a>查看我使用jupyter notebook(用于分析)和Tableau(用于可视化)制作的一个仪表板。</p></div></div>    
</body>
</html>