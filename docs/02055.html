<html>
<head>
<title>Creating a Serverless Python Chatbot API in Microsoft Azure from Scratch in 9 Easy Steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用9个简单的步骤在Microsoft Azure中从头开始创建一个无服务器的Python聊天机器人API</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/creating-a-serverless-python-chatbot-api-in-microsoft-azure-from-scratch-in-9-easy-steps-2f1913fc9581?source=collection_archive---------3-----------------------#2020-02-27">https://towardsdatascience.com/creating-a-serverless-python-chatbot-api-in-microsoft-azure-from-scratch-in-9-easy-steps-2f1913fc9581?source=collection_archive---------3-----------------------#2020-02-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7979" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习使用Azure Function应用程序创建和部署自己的无服务器聊天机器人应用程序，这些应用程序可用于Slack、Skype、MS Teams和其他应用程序</h2></div><h1 id="409b" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">介绍</h1><p id="0f7c" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">聊天机器人和无服务器是2020年完全主导企业界的两大技术趋势:<br/>为什么不一石二鸟，学习如何构建自己的无服务器聊天机器人？</p><p id="aafb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">完成本文后，您将知道如何:</p><ol class=""><li id="48af" class="mb mc it lc b ld lw lg lx lj md ln me lr mf lv mg mh mi mj bi translated">在Azure中部署无服务器应用程序，</li><li id="4aba" class="mb mc it lc b ld mk lg ml lj mm ln mn lr mo lv mg mh mi mj bi translated">建立一个聊天机器人，可以嵌入到一个网站，连接到微软团队，Slack，Skype，Facebook Messenger和许多其他渠道！</li></ol><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mp"><img src="../Images/78ef19ad590d405accc418e138b5ade7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VohUHphGQL-vsdh-DLfWsg.png"/></div></div><p class="nb nc gj gh gi nd ne bd b be z dk translated">图片作者:皮沙贝的穆罕默德·哈桑</p></figure><h2 id="4dcf" class="nf kj it bd kk ng nh dn ko ni nj dp ks lj nk nl ku ln nm nn kw lr no np ky nq bi translated">为什么是聊天机器人？</h2><p id="9089" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们现在都知道，在未来几年，聊天机器人将在世界各地的组织中变得越来越突出。从优化公司和客户之间的信息交流到完全取代销售团队。</p><p id="ebc5" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">根据Juniper Research发布的一篇论文，我们可以预计，到2022年，客户服务领域多达75 <strong class="lc iu"> % </strong>的查询将由机器人处理，每年将带来80亿美元的业务成本。</p><h2 id="adb6" class="nf kj it bd kk ng nh dn ko ni nj dp ks lj nk nl ku ln nm nn kw lr no np ky nq bi translated">为什么没有服务器？</h2><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nr"><img src="../Images/0b12b7882aab9ed2edda001cbcefba31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*60epA3-2wc7WGVJV.png"/></div></div><p class="nb nc gj gh gi nd ne bd b be z dk translated">图片来源:Pixabay的Nikin</p></figure><p id="18eb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">无服务器应用程序是另一个巨大的技术趋势，它们允许在线部署简单的应用程序，而不需要建立或管理任何类型的服务器基础设施。此外，现在有了微软和亚马逊等公司提供的优秀云服务，就有可能(也非常容易)完全根据使用情况来扩展您的应用程序，因此您只需为使用量付费，永远不必担心没有足够的带宽！</p><h1 id="c1c7" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">教程:</h1><p id="a401" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在，我们将通过几个步骤来建立和设置你的机器人。<br/>你需要的只是一个Azure订阅，Visual Studio代码(VSCode)安装在你的机器上，旁边还有一些Python版本！</p><h2 id="88b9" class="nf kj it bd kk ng nh dn ko ni nj dp ks lj nk nl ku ln nm nn kw lr no np ky nq bi translated">步骤1:在Azure Portal上注册一个新的Web应用程序Bot服务</h2><p id="c258" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">首先登录Azure门户网站，在搜索栏上查找Web应用程序Bot，这将允许您导航到Bot服务页面，在这里您可以<strong class="lc iu">在Azure门户网站上创建一个新的Web应用程序Bot </strong>。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/a58ceab14a9d87dd13ccf61f3cf3dfb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*crrwC1XmxdtbHNr3RanYkg.png"/></div><p class="nb nc gj gh gi nd ne bd b be z dk translated">您可以通过在Azure门户主页上搜索来找到Bot服务</p></figure><p id="3f41" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">单击<strong class="lc iu"> add </strong>创建新服务，这将带您进入下一页，在这里您必须选择一系列配置，您可能需要创建一个新的资源组，并确保选择S1定价层(这是我们目前需要的)。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/bd73c9f1a1d8d9d965ad846f8afc7484.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*oJIHA0-BLfxkIXF28WFkzQ.png"/></div></figure><p id="022a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">选择<strong class="lc iu"> Echo Bot C# </strong>模板，我们稍后将稍微修改该模板以将Bot连接到我们的API。</p><h2 id="7f6d" class="nf kj it bd kk ng nh dn ko ni nj dp ks lj nk nl ku ln nm nn kw lr no np ky nq bi translated">步骤2:通过VSCode设置Azure访问</h2><p id="7e34" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">此时，我们将创建我们的bot将与之交互的后端。有多种方法可以做到这一点，你可以在Flask、Django或任何其他框架中创建一个API。</p><p id="77eb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们将使用Azure Function应用程序，因为它可以非常简单地建立一个无服务器的API，可以根据需求进行很好的扩展。</p><p id="a1a4" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">首先，<strong class="lc iu">创建一个新文件夹</strong>并在VSCode上打开它:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/40b863e8cf67900c3658b32f855c0aa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*RGqFZ0OdE-Y9Dj55YBOm3Q.png"/></div></figure><p id="61aa" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在，我们需要安装一些扩展来帮助我们创建一个功能应用程序，并将其推送到Azure，即我们需要Azure CLI工具和Azure功能。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nv"><img src="../Images/583a029e9db56752f45564cd5ee98a03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wXHvJ2YHKRPgyu3-FY9v8w.png"/></div></div></figure><p id="f8e3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">一旦你安装了VSCode的扩展，你就可以通过VSCode登录你的Azure订阅来管理那里的资源！</p><p id="9a9c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated"><strong class="lc iu">按CTRL+SHIFT+P </strong>打开VSCode命令托盘，然后输入Azure Sign in。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/499b2eaccb0de6c6937b909bff6d1fc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*pQdWU5BUEnTiIdKN8Jl9Pg.png"/></div></figure><p id="b3fb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">登录后，您应该会在VSCode的底部栏看到以下内容:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/a51babb2848cfb1d9bfdeb0bb8de7685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*9Rq5FrR_fBlBTrCvzp5LNQ.png"/></div></figure><h2 id="df23" class="nf kj it bd kk ng nh dn ko ni nj dp ks lj nk nl ku ln nm nn kw lr no np ky nq bi translated">步骤3:创建一个新的Azure Function App项目</h2><p id="1121" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">导航到VSCode中的Azure function选项卡并创建一个新项目:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/56ee3e88e3575f3d64b3c696375b7484.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*2ZEMlurtjUydTa8SYzxwTQ.png"/></div></figure><p id="b1d0" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">遵循将出现在VSCode命令托盘上的提示:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nz"><img src="../Images/ffa5f92981b5a547665e5f569c532072.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rjxtRRJI7qSQtIysIQgu0Q.png"/></div></div></figure><p id="7675" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">选择要使用的语言(在本例中为Python)并创建新的虚拟环境:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi oa"><img src="../Images/f5dc8559054d21001034fbfd3dce2974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y-NiYImu5c8OtDopwVlAIw.png"/></div></div></figure><p id="89ef" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">作为我们的模板，我们将使用HTTP触发器:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi ob"><img src="../Images/6366d8a33681acfe7e9d183aaad105f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IqycgYclOTjlQ1gVRItv9g.png"/></div></div></figure><p id="6b78" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们将使我们的安全<strong class="lc iu">选项匿名</strong>，这意味着任何人都可以访问你的API而不需要API密钥，你可以在这里阅读更多关于认证设置的信息:</p><div class="oc od gp gr oe of"><a href="https://docs.microsoft.com/en-us/azure/azure-functions/" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">Azure函数文档</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">Azure Functions是一种无服务器的计算服务，让您无需显式地…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">docs.microsoft.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot mz of"/></div></div></a></div><p id="bfe8" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">最后，<strong class="lc iu">为保存无服务器功能应用程序的文件夹选择一个名称</strong>，然后<strong class="lc iu">按回车键</strong>。</p><h2 id="e273" class="nf kj it bd kk ng nh dn ko ni nj dp ks lj nk nl ku ln nm nn kw lr no np ky nq bi translated">第四步:修改函数应用程序的代码</h2><p id="9f0d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在您已经创建了您的函数应用程序，应该已经为您的项目自动生成了一个文件夹结构。您应该会看到一个文件夹，其名称与您在步骤3中创建项目时传递的名称相同。</p><p id="68ae" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在这个文件夹中，应该有一个名为__init__的python文件。py，看起来像这样:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi ou"><img src="../Images/4b217e035db67357a46c0114fb9021ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NLtxkDBrVgtDsVAHEDAAFQ.png"/></div></div><p class="nb nc gj gh gi nd ne bd b be z dk translated">__init__。py注释</p></figure><p id="0a6a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">即使对于有经验的Python程序员来说，主函数定义的语法初看起来也有点令人畏惧:</p><pre class="mq mr ms mt gt ov ow ox oy aw oz bi"><span id="611b" class="nf kj it ow b gy pa pb l pc pd">def main(req: func.HttpRequest) -&gt; func.HttpResponse:</span></pre><p id="079c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这段代码只是指定函数将在接收到请求对象时执行，并将返回HTTP响应。</p><p id="d2e3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">从这里，我们可以很容易地修改这个模板，以添加我们希望通过我们的机器人接口提供的功能，这可能包括例如从SQL数据库查询数据，触发其他功能或您可能需要您的机器人做的任何其他工作。</p><p id="dc0e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">对于这个用例，我们将使用开放的英国政府数据:我们的无服务器函数将获得一个包含英国城市名称的HTTP请求，它将返回该城市所有图书馆的列表。</p><p id="0349" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">让我们在应用程序中创建一个名为<strong class="lc iu"> modules </strong>的文件夹，并在其中创建一个名为<strong class="lc iu"> library_finder.py的新文件。</strong></p><p id="4d94" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">此时，您的项目应该是这样的:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/d2ca8007550691cc9491fab7b79e6c64.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*rrg7m7zXRQRyGCOgJcLlrQ.png"/></div></figure><p id="e78d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在library_finder.py中粘贴以下代码片段:</p><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="pf pg l"/></div></figure><p id="614d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">您需要在azure function为我们创建的虚拟环境中安装pandas。</p><p id="81f4" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果您不熟悉虚拟环境，请查看以下链接:</p><div class="oc od gp gr oe of"><a href="https://docs.python.org/3/tutorial/venv.html" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iu gy z fp ok fr fs ol fu fw is bi translated">12.虚拟环境和包- Python 3.8.2文档</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">Python应用程序通常会使用不属于标准库的包和模块。应用程序…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">docs.python.org</p></div></div></div></a></div><p id="df5a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们的虚拟环境已经设置好了，我们现在只需要激活它。这可以在vscode中通过键入</p><pre class="mq mr ms mt gt ov ow ox oy aw oz bi"><span id="4d3c" class="nf kj it ow b gy pa pb l pc pd">.venv\Scripts\activate </span></pre><p id="cc8d" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在VSCode的终端窗口中。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/281f4871f3d734cc1c12cfc2c13937f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*rp7RP3yUI9DvH2WCwFsI_A.png"/></div></figure><p id="70be" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果您的环境已经成功激活，您将看到(。venv)在路径的开始。</p><p id="5b45" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在我们可以安装熊猫了，只需在你的控制台中输入“pip install pandas”</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/94eab3d4837791857378f3b0545ca7e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*wOLWt4eiNQquYhfnfnc1qQ.png"/></div></figure><p id="db96" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">(对于您希望通过pip安装的任何其他外部库，可以重复相同的过程)。</p><p id="f61c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated"><strong class="lc iu">现在将熊猫添加到您的requirements.txt文件中非常重要，它看起来应该是这样的:</strong></p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/3122bf923c014f52470633fbfa5383ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*ysMXBMT23DhqGPOQm_fQ7g.png"/></div></figure><p id="070b" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在我们可以回到<strong class="lc iu"> __init__。py </strong>(我们的无服务器应用程序的主文件)并修改代码，以便在接收到HTTP请求时(a)我们将在json上查找附加到请求正文的文本字段，(b)我们将读取文本并解析它，(c)我们将调用我们刚刚定义的函数并返回请求的数据。</p><p id="c52f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">以下代码将满足我们的目的:</p><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="pf pg l"/></div></figure><h2 id="3cf8" class="nf kj it bd kk ng nh dn ko ni nj dp ks lj nk nl ku ln nm nn kw lr no np ky nq bi translated">步骤5:在本地测试您的API</h2><p id="456b" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们现在已经使用Azure函数创建了一个基本的无服务器API，是时候测试我们是否一切都按预期工作了！</p><p id="71ce" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们可以在本地启动我们的Azure功能应用程序。为此，请在终端中用VS代码键入以下命令:</p><pre class="mq mr ms mt gt ov ow ox oy aw oz bi"><span id="d27c" class="nf kj it ow b gy pa pb l pc pd">func start</span></pre><p id="ba6a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">您的功能将被初始化，您应该会看到标志性的Azure Function应用程序徽标！</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/d15c2e234f0040513a9e563dbdd05a63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*ZKX2mDHa5AA5yGVDTd9o8A.png"/></div></figure><p id="ae97" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果一切正常，您应该不会看到任何错误，并且在提示符的末尾会显示如下消息:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/5c0230863d8548baa2b11ba12059298c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*TdQAe7BG2cKEYBTax-yeXA.png"/></div></figure><p id="fe1b" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">该消息包含与我们在本地启动的无服务器应用程序通信的URL。这可以很容易地用一个叫做Postman的免费软件来完成。在Postman中，您可以通过发送请求并查看响应来调试API。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pi"><img src="../Images/8ac42effa48e0a331c786655088bcb47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OcAXBjfJvJqt13KQy0hZAg.png"/></div></div></figure><p id="5b12" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">或者，您可以通过在命令提示符窗口中打开Python并向指定的URL发送请求，然后检查我们是否获得了预期的响应，来测试API是否正在工作。</p><h2 id="5e3b" class="nf kj it bd kk ng nh dn ko ni nj dp ks lj nk nl ku ln nm nn kw lr no np ky nq bi translated">第六步:将你的功能应用部署到Azure</h2><p id="7bdc" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">现在，您的无服务器应用程序正在工作，并且您已经成功创建了一个HTTP触发器，是时候将它部署到Azure了，这样您就可以从本地网络外部访问它。</p><p id="6707" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">要部署它，只需导航到VScode中的Azure选项卡，然后<strong class="lc iu">滚动到函数窗口</strong>。</p><p id="ed28" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated"><strong class="lc iu">右键点击你的Azure订阅</strong>，按<strong class="lc iu">在Azure中创建功能App</strong>。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/e39fb3f1ee6c15243ac9db2b171d6206.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*w9rchZ4HzsK5FTwl6wWocg.png"/></div></figure><p id="3346" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">提示将要求您命名函数，提供位置和Python版本。按照要求执行步骤，等待直到Azure函数创建完成。你应该可以在Azure Functions选项卡中找到它，再次右键单击该函数并选择Deploy to Function App。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/bae362cb55ebe1fdab133af61de8f9ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*zL9cRAX3x8Xfgr2wYfXLQQ.png"/></div></figure><p id="7877" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">将出现一个提示，要求确认部署，几分钟后，将出现一条消息，表明部署已经成功。</p><p id="39b1" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">发生这种情况时，您可以通过打开浏览器窗口并导航到以下位置来检查您的部署是否有效:</p><pre class="mq mr ms mt gt ov ow ox oy aw oz bi"><span id="e9c3" class="nf kj it ow b gy pa pb l pc pd"><a class="ae pk" rel="noopener ugc nofollow" target="_blank" href="/[name_of_your_functionapp].azurewebsites.net/">https://[name_of_your_functionapp].azurewebsites.net/</a></span></pre><p id="b708" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">如果您在Azure门户页面中导航到您的功能应用程序，也可以找到此链接。</p><p id="5c7c" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">访问该链接后，您应该会看到以下页面:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/7b70c5413e94a5e6a42f68e2c67a0669.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*_Hxlx2vcKEIi_0E30QFkaw.png"/></div></figure><p id="676f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这意味着您已经成功地将您的功能应用程序部署到互联网上，现在任何人都可以访问您的无服务器API！(取决于您在创建HTTP触发器时选择的身份验证设置)</p><h2 id="7611" class="nf kj it bd kk ng nh dn ko ni nj dp ks lj nk nl ku ln nm nn kw lr no np ky nq bi translated">步骤7:将机器人连接到无服务器功能</h2><p id="883f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">对于这一步，我们将回到我们在本教程的步骤1中在Azure portal中创建的Bot应用服务！</p><p id="8078" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">导航到web bot服务主页，转到build选项卡，然后<strong class="lc iu">点击“打开在线代码编辑器”</strong>。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/9d28b7cbb037477257bf05d6287d24d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*aExfJe1RzD5pmqE4a97l8g.png"/></div></figure><p id="b461" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">从在线代码编辑器导航到Bots &gt; EchoBot.cs</p><p id="fc7f" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">这将允许您对机器人的C#代码进行一些轻微的修改，这是您最初应该看到的内容:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/df2bc29825cc4abba7fb04d19f49dfc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*5OO2sFgHLZjVH9x13WTxVQ.png"/></div></figure><p id="3c41" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">用下面提供的代码替换此页面上的代码:</p><figure class="mq mr ms mt gt mu"><div class="bz fp l di"><div class="pf pg l"/></div></figure><p id="e0ed" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">记得把我们上一步创建的Azure Function App的URL访问点的URL替换掉！</p><p id="04b9" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">现在我们只需要构建我们对C#代码所做的修改，这可以通过右键单击页面上的build.cmd文件轻松完成</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/50e3bfcaf12e6a084cafe0739d56d306.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/1*utDUJg97GYT2w2cLiBWn7A.png"/></div></figure><p id="ef8e" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">我们可以测试我们的机器人，检查它是否如预期的那样工作。打开Azure Portal并导航到您的Web应用程序Bot主页。</p><p id="8da3" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在网络聊天中选择测试选项:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/5774fcac6759570fed104e3883f19e87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*mSK_NI2yQyc6Ceu_lg2jyQ.png"/></div></figure><h2 id="0c54" class="nf kj it bd kk ng nh dn ko ni nj dp ks lj nk nl ku ln nm nn kw lr no np ky nq bi translated">步骤8:将你的机器人发布到频道</h2><p id="0c4d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果一切正常，你就可以将这个机器人添加到任何支持的频道了。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/64c0c2341cee9f50ffb4e7458a8c535d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*CF4Kle2BQ8DJ28KZ2CSFjw.png"/></div></figure><p id="8574" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">通过按保存并接受使用条款来配置Microsoft Teams频道。</p><p id="30e4" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">接下来，我们可以通过点击“get bot embed codes”链接并复制HTML标记内的URL，为某人提供与我们的bot对话的链接。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/73321dbbb6e583d7f3f88913cc3a2c18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*XxsGJPuCDhM0WAzP7ZFKLA.png"/></div></figure><p id="2bcb" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">访问该URL的任何人都将被邀请在MS团队中添加机器人，如下所示:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/ae3ee92a257263ecad1354c3e7ab4f40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*Y7ULxsaNJa7uhkVLAzmmrA.png"/></div></figure><p id="5bfa" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">MS团队将打开，我们的机器人将被列为您的聊天之一。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/61ab81bab9315720ce1556f5fe8eb496.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*yu0GKPP-1zHZMGuWkxHpjA.png"/></div></figure><h2 id="a137" class="nf kj it bd kk ng nh dn ko ni nj dp ks lj nk nl ku ln nm nn kw lr no np ky nq bi translated">步骤9:(可选)将您的机器人应用程序发布到MSTeams</h2><p id="0dfc" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">这可能足以满足你的机器人需求，如果你想发布机器人，那么它可以被添加到ms团队的群聊中，你可以通过打开MS团队并点击“…”图标，然后打开<strong class="lc iu">应用工作室</strong>:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/6767288129442b8a3556e193edf2e03d.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*zdRfsS8pulufk24-Uro7Cw.png"/></div></figure><p id="dc71" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">点击<strong class="lc iu">创建新应用</strong>:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi po"><img src="../Images/bd745e075e63b7b2af7d9173a48ce6d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*JUXSioPohsjppGdVS8rKzQ.png"/></div></figure><p id="732a" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">你必须填写登记表。重要的是，一旦您填写了所有必需的信息，导航到机器人选项卡并按下<strong class="lc iu">设置</strong>按钮:</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pp"><img src="../Images/0b6737761977abf6ef7b082d069c3e1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*InoD7JXQ5RbvXRmUOciXRw.png"/></div></div></figure><p id="cc02" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">在<strong class="lc iu">现有机器人</strong>选项卡中，我们刚刚创建的机器人应该列在下拉菜单中</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/85be65760ba3245cce9b03d10286c0ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*jL0xQf9Nn4XCDFQYpmrN-Q.png"/></div></figure><p id="f35b" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">最后一步是导航到清单编辑器上的<strong class="lc iu">测试和分发</strong>选项卡，然后<strong class="lc iu">分组安装</strong>你的应用。</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi pr"><img src="../Images/752ee7c28fd02ae1181de62656ae9986.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X3_BdTuDbV1lGT4z2LFGAA.png"/></div></div></figure><p id="2092" class="pw-post-body-paragraph la lb it lc b ld lw ju lf lg lx jx li lj ly ll lm ln lz lp lq lr ma lt lu lv im bi translated">您已经配置了您的MS Teams应用程序，您需要做的只是邀请机器人加入特定的团队，并享受您的新无服务器机器人应用程序。</p></div></div>    
</body>
</html>