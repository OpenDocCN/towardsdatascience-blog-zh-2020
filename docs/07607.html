<html>
<head>
<title>Cyclical features encoding, it’s about time!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">周期性特征编码，是时候了！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cyclical-features-encoding-its-about-time-ce23581845ca?source=collection_archive---------4-----------------------#2020-06-08">https://towardsdatascience.com/cyclical-features-encoding-its-about-time-ce23581845ca?source=collection_archive---------4-----------------------#2020-06-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="cb05" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">找到一种简单的技术来转换时间、星期、月份或季节等特征，同时仍然保留它们的循环意义。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/f8594c73852de86f29fc915d034ed542.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d3erBgF6JG4o0tCX"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae le" href="https://unsplash.com/@fabrizioverrecchia?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Fabrizio Verrecchia </a>拍摄的照片</p></figure><p id="dbcb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我总是发现关于特征工程的讨论很吸引人，因为它们揭示了数据科学家如何通过增加提供给算法的信息来改善建模过程。</p><p id="d79e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">即使您是数据科学的新手，您也可能知道有些变量不能直接输入到模型中。是的，我肯定是在谈论需要诸如one-hot或get_dummies编码方法之类的技术的分类特征。</p><p id="e3c5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当您处理时间序列数据时，您的数据帧索引通常具有日期时间格式(YYYY-MM-DD HH:MM:SS ),除了数据点的升序之外，您不会从中提取太多信息。</p><p id="2ab9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是，您的数据集中可能存在一些隐藏的模式，这些模式不会被常规要素显示出来。我这里说的是循环模式，比如一天中的几个小时、一周中的几天、几个月、几个季节等等。</p><p id="8d47" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">问题是，当涉及到将这些信息转换成可解释的特征时，我们通常会面临一个挑战。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="f3e1" class="lm ln it bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">让我们以建立一个能源消耗预测模型为例。</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mk"><img src="../Images/0ff68ca51312d6644c6782df1a25b9b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hcrVWhqFOjyUITa8"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><a class="ae le" href="https://unsplash.com/@matthewhenry?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马太·亨利</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="d203" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们肯定地知道，一天中的时间将对这种消耗有很大的影响。</p><p id="4ffa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了将时间编码为从00:00到23:59，我们的第一个猜测可能是将其转换为从00:00开始经过的分钟数，从0到1439:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/6cd5059fbf1e224d608803397dc61890.png" data-original-src="https://miro.medium.com/v2/resize:fit:410/format:webp/1*R_Nhx9T6cLs5GBMXKXxbrA.png"/></div></figure><blockquote class="mo mp mq"><p id="2d78" class="jq jr mr js b jt ju jv jw jx jy jz ka ms kc kd ke mt kg kh ki mu kk kl km kn im bi translated"><strong class="js iu">这里的问题是，模型会将23:58和00:02之间的差异视为1336间隙，而它们之间仅相隔4分钟！</strong></p></blockquote><p id="bfd6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们如何解决这个问题？</p><p id="fa9d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你还记得高中的一些事情，你可能知道一些具有循环行为的函数…最著名的是余弦，因为它根据0-2π循环在-1和1之间变化。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mv"><img src="../Images/29728faf59a450c7a89866227227b73c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*7Y-jyZsaXraHq9IUOVXUBQ.gif"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">余弦函数(<a class="ae le" href="http://www.math.ust.hk/~machiang/1013/Notes/tri_func.html" rel="noopener ugc nofollow" target="_blank">源</a>)</p></figure><p id="359a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以让我们通过余弦转换我们的时间，我们很好，不是吗？</p><p id="5a39" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将在0到2π之间归一化x后运行余弦函数，这相当于一个余弦周期。<strong class="js iu"> </strong>作为一张图表胜过千言万语，我们就用Plotly来看看相应的结果:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/8bd8f350dde1408624005142cee074b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*nKLvoFC4GG8yEHViSIiaYw.png"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mx"><img src="../Images/b5998b7a373f95e28055af3115d5a07a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Jasxc76_aqcswOHS1Se3Q.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">1440分钟标准化并通过余弦转换</p></figure><p id="4e31" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以我们现在有了比以前更接近的00:00和23:59的值，它们都在1左右！</p><p id="77b0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是你看到我们创造的新问题了吗？</p><p id="1944" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">两个不同的时间会得到相同的值:</strong></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi my"><img src="../Images/180fdab8630b0b95dee208f2ff322160.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DPtvsAW2rdBG2NPVSuKrMA.png"/></div></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/71162d3447c0faf0ea5b22437b8b7b4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*TQtBR2RBOs3h3Pb_.gif"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">《采访》中的詹姆斯·弗兰科</p></figure><p id="c7c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">解决这个新问题的最好方法是添加另一个循环信息来区分具有相同余弦值的两个时间。我们可以把它想象成一个双轴坐标系统。</p><p id="2a8c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这大概是给余弦的哥哥打电话的恰当时机:正弦！</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi na"><img src="../Images/f55cf4bf0889d30d0f3a83d334c0972d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nPUDQuE9A0KxbrBAamOqtw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">0-2π周期上的余弦和正弦函数(y)</p></figure><p id="8efc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过将原来的时间转换为它们对应的余弦和正弦值，我们现在可以为00:00到23:59之间的每个时刻分配不同的坐标，使它们具有唯一性！</p><p id="3cd4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这样一个系统的可视化使它变得更加明显:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/08a5d8dc3090d028f0fa9373ab22fce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*eAvfGhs2dys_HuE7LMpozg.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">我们创造的余弦-正弦坐标系统</p></figure><p id="aaf3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了举例，让我们在一段时间内随机绘制15个点:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ml mm l"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/45885c81efe22a9ab0fb701b669bf648.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*VgONyTP9prp_doAunPyFIg.png"/></div></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/172e9187e9d034a73f7be4987de143e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*tUEYJtP62zAF2gI40_W4ig.png"/></div></figure><h1 id="b099" class="lm ln it bd lo lp ne lr ls lt nf lv lw lx ng lz ma mb nh md me mf ni mh mi mj bi translated">这种编码体系是否完美？不幸的是没有，以下是一些原因:</h1><ul class=""><li id="fcd6" class="nj nk it js b jt nl jx nm kb nn kf no kj np kn nq nr ns nt bi translated"><strong class="js iu">你正在将一个信息转换成两个特征</strong>，从算法的角度来看，这将在数学上赋予它更大的权重。</li><li id="92bc" class="nj nk it js b jt nu jx nv kb nw kf nx kj ny kn nq nr ns nt bi translated"><strong class="js iu">基于决策树的算法</strong>(随机森林，梯度提升树，XGBoost)一次根据一个特征建立它们的分割规则。这意味着它们<strong class="js iu">将无法同时处理这两个特征</strong>，而cos/sin值将被视为一个单一坐标系。</li></ul><p id="90a3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然而，权衡有时是游戏的一部分，这仍然是编码周期性特征的好方法。</p><p id="b2c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">值得一提的是，开源算法(如脸书的Prophet)确实允许您从时间序列中自动提取周期性信息，如年、月或日模式:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/e6908c7461f78d986d55b0279336803c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*LrczRoKNiOo0sn-hkFINHw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">摘自脸书的《先知快速入门指南》</p></figure><div class="oa ob gp gr oc od"><a href="https://facebook.github.io/prophet/docs/quick_start.html#python-api" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">快速启动</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">Prophet遵循sklearn模型API。我们创建一个Prophet类的实例，然后调用它的fit和predict…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">facebook.github.io</p></div></div><div class="om l"><div class="on l oo op oq om or ky od"/></div></div></a></div><div class="oa ob gp gr oc od"><a href="https://pl-bescond.medium.com/pierre-louis-besconds-articles-on-medium-f6632a6895ad" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">皮埃尔-路易·贝斯康德关于媒介的文章</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">数据科学、机器学习和创新</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">pl-bescond.medium.com</p></div></div><div class="om l"><div class="os l oo op oq om or ky od"/></div></div></a></div></div></div>    
</body>
</html>