<html>
<head>
<title>Style Your Pandas DataFrames</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设计你的熊猫数据框</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/style-your-pandas-dataframes-814e6a078c6d?source=collection_archive---------13-----------------------#2020-06-11">https://towardsdatascience.com/style-your-pandas-dataframes-814e6a078c6d?source=collection_archive---------13-----------------------#2020-06-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a237" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让我们创造出比简单数字更多的东西。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a41e468a660e68f5a99cbfc63fb50ff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9K4FRUR_pm8_xnDryEKOXA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由亨电影公司在Unsplash上拍摄</p></figure><p id="29a3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据可视化是从普通数据中推断出有意义结果的伟大工具。它们广泛用于探索性数据分析过程，以便更好地理解手头的数据。如果我们在熊猫数据框架中集成一些可视化结构会怎么样？我认为这比简单的数字更好看。此外，我们可以在数据帧的显示上增加一些信息能力。</p><p id="290a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以通过使用熊猫数据帧的<strong class="la iu"> Style </strong>属性来实现这一点。Style属性返回一个<strong class="la iu"> styler </strong>对象，该对象为格式化和显示数据帧提供了许多选项。在本帖中，我们将浏览几个例子，看看数据帧是如何以不同的风格显示的。</p><p id="588d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以通过调整参数来使用内置的样式函数。我们也可以编写自己的样式函数，并将其传递给styler对象，然后该对象在呈现之前实现样式。</p><p id="92ca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有两种方法可以使用styler对象。一种是基于元素的样式，可以用<strong class="la iu"> applymap </strong>方法完成。另一种是列或行样式，需要使用<strong class="la iu">应用</strong>方法。</p><p id="7baf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们首先用numpy和pandas创建一个样本dataframe。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="8be6" class="lz ma it lv b gy mb mc l md me">df = pd.DataFrame({'A':np.linspace(1,8,8),<br/>                   'B':np.random.random(8),<br/>                   'C':np.random.randn(8),<br/>                   'D':np.random.randn(8),<br/>                   'E':np.random.randint(-5,5,8)})</span><span id="bd94" class="lz ma it lv b gy mf mc l md me">df.iloc[[1,5],[1,3]] = np.nan<br/>df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/b3d90f91657133a63a7f3690503ba5cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*5qUpnaYTdq-IIVJUo71y8w.png"/></div></figure><p id="3fe0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">它看起来简单明了。我们可以编写一个函数，根据条件用不同的颜色显示一些值。例如，我们可以选择用红色显示负值。下面是完成这项任务的函数。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="9c70" class="lz ma it lv b gy mb mc l md me">def color_negative_values(val):<br/>  color = 'red' if val &lt; 0 else 'black'<br/>  return 'color: %s' % color</span></pre><p id="79c8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们把它传递给applymap方法。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="4739" class="lz ma it lv b gy mb mc l md me">df.style.applymap(color_negative_values)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/165f59326ab021de790d224e867ce807.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*POfZYVjeadFZN-A8fbQdog.png"/></div></figure><p id="813e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> Applymap </strong>执行基于元素的操作，而<strong class="la iu"> apply </strong>基于列或行执行操作。这是一个改变列中最大值的背景颜色的函数。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="e98c" class="lz ma it lv b gy mb mc l md me">def color_max(s):<br/>    is_max = s == s.max()<br/>    return ['background-color: lightblue' if v else '' for v in    is_max]</span></pre><p id="d00d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们只需要通过它来应用方法。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="0142" class="lz ma it lv b gy mb mc l md me">df.style.apply(color_max)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/7e468616bd86e41b54d55786e0074125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*OUWzPUiFuBXo9R_HN72uMg.png"/></div></figure><p id="062d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还可以通过将axis参数设置为1来将该函数应用于行。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="cad7" class="lz ma it lv b gy mb mc l md me">df.style.apply(color_max, axis=1)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/b2ac6593fa6434cc8ab26617f2509681.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*N7nLA6UTkT86eMeI0Z3twA.png"/></div></figure><p id="01ea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每行的最大值是彩色的。在这种情况下，它们恰好在“A”栏中。</p><p id="e8d1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以通过链式操作来组合不同风格的功能。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="4643" class="lz ma it lv b gy mb mc l md me">df.style.applymap(color_negative_values).apply(color_max)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/87f93fcebdd6ee2fc1afd0d6987e045e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*DDSYhctizN0WmyVz3REctQ.png"/></div></figure><p id="b400" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过使用<strong class="la iu">子集</strong>参数选择特定的行或列，样式功能可部分应用于数据帧。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="24f5" class="lz ma it lv b gy mb mc l md me">df.style.apply(color_max, subset=['B','C'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/f2d3ec9beb34c5dbef36b39305d1a54a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*MLlfa441WBjwdg5JE0R9bw.png"/></div></figure><p id="005f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Color_max函数应用于列“B”和“C”。</p><p id="b0a4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">除了定制的功能之外，pandas还有一些内置的功能，可以满足一些常见的任务。例如，<strong class="la iu"> highlight_null </strong>函数标记缺失值。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="4975" class="lz ma it lv b gy mb mc l md me">df.style.highlight_null(null_color='yellow')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/0867b9ce344a2b88f8c7c2a8d7bd0191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*DBAhlrH_LDp0U8xPTAAwuA.png"/></div></figure><p id="4ed4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以用<strong class="la iu"> null_color </strong>参数改变颜色。另一个有用的内置函数是<strong class="la iu"> background_gradient </strong>，它在seaborn的帮助下标记与值成比例的单元格。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="acc1" class="lz ma it lv b gy mb mc l md me">import seaborn as sns</span><span id="d45d" class="lz ma it lv b gy mf mc l md me">cm = sns.light_palette("green", as_cmap=True)</span><span id="84e1" class="lz ma it lv b gy mf mc l md me">df.style.background_gradient(cmap=cm)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/a96ea45b82b2ea7e4b2c8405c0e1c20d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*RQEvoUbamzt1U-xBftZisA.png"/></div></figure><p id="d1d4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">值越大，背景颜色越深。缺失值与其余值分开。</p><p id="e942" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> Highlight_max </strong>和<strong class="la iu"> highlight_min </strong>函数像我们的自定义color_max函数一样标记一列或一行中的最大值和最小值。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="bc45" class="lz ma it lv b gy mb mc l md me">df.style.highlight_min(color='lightgreen', axis=1)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/ba52fab6c2d391a72b26d36801c03bc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*A2W3TW8Pp7CAluao9a7o4w.png"/></div></figure><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="85fe" class="lz ma it lv b gy mb mc l md me">df.style.highlight_max()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/216cc169e3bf14a6e6b0c8399d227086.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*g5tYc7tS8yzhN1SG04QBug.png"/></div></figure><p id="7983" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">axis参数的默认值为0，执行列操作。</p><p id="2ec9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> Set_properties </strong>功能允许组合多种风格选择。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="551c" class="lz ma it lv b gy mb mc l md me">df.style.set_properties(**{'background-color': 'lightblue',<br/>                           'color': 'black',<br/>                           'border-color': 'white'})</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/83643a06b89c82c3d2eb6d9264a79f76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*2Ap0QRN50spo8DognH-weQ.png"/></div></figure><p id="a7cf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">另一个非常有用的函数是<strong class="la iu"> bar </strong>，它在单元格上绘制条形，条形的长度与单元格中的值成比例。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="add9" class="lz ma it lv b gy mb mc l md me">df.style.bar(color='lightgreen')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/00aeb11b2204d16f2766e1882750913a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jPo61KVdXSeM6zkrxV_kKA.png"/></div></div></figure><p id="e790" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过使用<strong class="la iu"> align </strong>参数，我们可以用不同的颜色显示负值和正值。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="9707" class="lz ma it lv b gy mb mc l md me">df.style.bar(align='mid', color=['red', 'lightgreen'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/19f608a706f0c5c0155546c06f75fa47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*trq4ex0SMalRWjqqE0Zi1A.png"/></div></div></figure></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="05a9" class="mw ma it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated"><strong class="ak">传送样式</strong></h1><p id="a7ea" class="pw-post-body-paragraph ky kz it la b lb nn ju ld le no jx lg lh np lj lk ll nq ln lo lp nr lr ls lt im bi translated">我们在这里使用的样式函数非常简单。然而，我们也可以创建更复杂的样式函数来增强数据帧的信息能力。我们可能希望在我们处理的所有数据帧上使用相同的样式。Pandas提供了一种在数据帧之间转换样式的方法。</p><p id="87fd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们首先将样式保存到styler对象中。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="2e05" class="lz ma it lv b gy mb mc l md me">style = df.style.applymap(color_negative_values).apply(color_max)<br/>style</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/d5578ea40ac0d86d07c1122a07902dd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*dRQnn444HpkPZlqjbLglDg.png"/></div></figure><p id="9b3b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们创建另一个示例数据帧。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="1464" class="lz ma it lv b gy mb mc l md me">df2 = pd.DataFrame({'col1':np.random.random(8),<br/>                   'col2':np.random.randn(8),<br/>                   'col3':np.random.randint(-5,5,8)})<br/>df2</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/6aa147bba82205a381c99d9949fe74cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*BTqNX50Cva3L45lajF_jfg.png"/></div></figure><p id="8385" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们可以创建另一个styler对象，并使用保存在前一个styler对象中的相同样式。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="ea74" class="lz ma it lv b gy mb mc l md me">style2 = df2.style<br/>style2.use(style.export())<br/>style2</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/b5238f27ece6e7579d7a092c4a594109.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*y3DTH8jBocutbZsR-tPugg.png"/></div></figure></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><p id="42c1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们已经覆盖了</p><ul class=""><li id="0cf3" class="nu nv it la b lb lc le lf lh nw ll nx lp ny lt nz oa ob oc bi translated">如何创建自定义样式函数并应用于数据框架</li><li id="2f2d" class="nu nv it la b lb od le oe lh of ll og lp oh lt nz oa ob oc bi translated">如何使用内置样式函数</li><li id="57c9" class="nu nv it la b lb od le oe lh of ll og lp oh lt nz oa ob oc bi translated">如何将样式从一个styler对象转移到另一个</li></ul><p id="ad74" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在pandas用户指南的<a class="ae oi" href="https://pandas.pydata.org/docs/user_guide/style.html" rel="noopener ugc nofollow" target="_blank">样式部分</a>有其他可用的样式和格式选项。</p><p id="8ca4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>