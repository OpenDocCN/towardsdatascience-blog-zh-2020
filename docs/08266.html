<html>
<head>
<title>XML Scraping done right!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">XML抓取做得很好！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/xml-scraping-done-right-6ac66eef9efc?source=collection_archive---------14-----------------------#2020-06-17">https://towardsdatascience.com/xml-scraping-done-right-6ac66eef9efc?source=collection_archive---------14-----------------------#2020-06-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6d0b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Python一步步抓取任何“XML”文件</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/846e2da911e2f1b7f39d9baff07eee24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lM_1w-3NqfJMPjV-"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">弗兰基·查马基在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="ac60" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi ls translated">ata是新的石油——但它绝对不便宜。我们有来自四面八方的数据；web、应用程序、社交媒体等，数据科学家必须能够挖掘其中的一些内容。在接下来的博客中，我们将学习如何使用Python库'<strong class="ky ir"> BeautifulSoup </strong>'快速从网站中挖掘/收集数据(为了好玩)</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><p id="307f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">行动（或活动、袭击）计划</p><h1 id="eee8" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">目录</h1><ol class=""><li id="4ef6" class="na nb iq ky b kz nc lc nd lf ne lj nf ln ng lr nh ni nj nk bi translated">介绍使用案例</li><li id="f0a5" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">什么是BeautifulSoup？</li><li id="c7e1" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">BS4行动——理解并提取数据</li><li id="cb83" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">最后评论</li></ol></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="9d90" class="mi mj iq bd mk ml nq mn mo mp nr mr ms jw ns jx mu jz nt ka mw kc nu kd my mz bi translated">介绍使用案例</h1><p id="caaa" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">任何在客户体验或酒店行业工作过的人都明白客户满意度的重要性。NPS或净推介值被视为客户体验的基准。虽然NPS是一项专门设计的调查，但还有其他方法来了解客户情绪。其中之一是Appstore上的<strong class="ky ir">客户反馈和评级</strong>(当然，前提是你的应用在那里可用)。</p><p id="c68e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以我们要做的是—</p><p id="17f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">→随机选择一个应用程序(例如:脸书)</p><p id="7eba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">→访问iTune评论</p><p id="921b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">→提取不同用户给出的评级、评论、日期等</p><p id="e37e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">→以干净的“csv/xlsx”格式导出它们。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="f002" class="mi mj iq bd mk ml nq mn mo mp nr mr ms jw ns jx mu jz nt ka mw kc nu kd my mz bi translated">什么是BeautifulSoup？</h1><p id="f255" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">美汤<em class="ny">(又名BS4) </em>是一个解析HTML和XML文档的Python包。它为解析过的页面创建了一个解析树，可以用来从HTML中提取数据，这对web抓取很有用。它适用于Python 2.7和Python 3</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><h1 id="4459" class="mi mj iq bd mk ml nq mn mo mp nr mr ms jw ns jx mu jz nt ka mw kc nu kd my mz bi translated">BS4行动——理解并提取数据</h1><p id="2275" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">iTunes使得从苹果应用商店获得应用评论变得非常容易。脸书的应用程序id是<code class="fe nz oa ob oc b">28488215</code>，我们只需要在下面的URL中添加相同的id</p><pre class="kg kh ki kj gt od oc oe of aw og bi"><span id="8cef" class="oh mj iq oc b gy oi oj l ok ol"><a class="ae kv" href="https://itunes.apple.com/us/rss/customerreviews/page=1/id=284882215/sortBy=mostrecent/xml" rel="noopener ugc nofollow" target="_blank">https://itunes.apple.com/us/rss/customerreviews/page=1/id=284882215/sortBy=mostrecent/xml</a></span></pre><p id="24a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">单击上面的URL，将会出现一个如下所示的页面:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/0800f98cfee3b9653f3882ff0c68d550.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ry1Kob6IW_Rq8z0AVuvaYQ.png"/></div></div></figure><blockquote class="on"><p id="4e44" class="oo op iq bd oq or os ot ou ov ow lr dk translated">XML文档被形成为元素树。一个XML树从一个<strong class="ak">根</strong>元素开始，从<strong class="ak">根</strong>分支到子元素。术语父、子和兄弟用于描述元素之间的关系。</p></blockquote><p id="10c1" class="pw-post-body-paragraph kw kx iq ky b kz ox jr lb lc oy ju le lf oz lh li lj pa ll lm ln pb lp lq lr ij bi translated">在上图中我们可以看到<code class="fe nz oa ob oc b">&lt;feed&gt;</code> <strong class="ky ir"> <em class="ny"> </em> </strong>是<em class="ny">的父</em>也就是多子。其中一个孩子是<code class="fe nz oa ob oc b">&lt;entry&gt;</code> <strong class="ky ir"> <em class="ny"> </em> </strong>，它又有许多孩子。在某种程度上——<code class="fe nz oa ob oc b">&lt;feed&gt;</code>是爷爷，<code class="fe nz oa ob oc b">&lt;entry&gt;</code>是儿子，其他人是孙子。</p><h2 id="c1f9" class="oh mj iq bd mk pc pd dn mo pe pf dp ms lf pg ph mu lj pi pj mw ln pk pl my pm bi translated">我们需要提取什么？</h2><p id="fcfe" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">现在，让我们假设我们想从每个评论中提取以下内容:</p><ol class=""><li id="1453" class="na nb iq ky b kz la lc ld lf pn lj po ln pp lr nh ni nj nk bi translated">审查日期</li><li id="d3dc" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">审查标题</li><li id="7a4c" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">内容</li><li id="b8d8" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">评级</li><li id="2e1c" class="na nb iq ky b kz nl lc nm lf nn lj no ln np lr nh ni nj nk bi translated">审查人姓名</li></ol><p id="fe6b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们想写10页。</p><h2 id="375e" class="oh mj iq bd mk pc pd dn mo pe pf dp ms lf pg ph mu lj pi pj mw ln pk pl my pm bi translated">Python代码</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pq pr l"/></div></figure><p id="c4c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">代码非常简单</p><p id="1b22" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">→首先使用<code class="fe nz oa ob oc b">request</code>从URL导入数据</p><p id="be7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">→使用<code class="fe nz oa ob oc b">BeautifulSoup</code>将其转换为BS4对象</p><p id="8563" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">→Extra:可以使用<code class="fe nz oa ob oc b">soup.findall()</code>查找数据中的所有文本</p><p id="2b02" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">→找到子/标签<code class="fe nz oa ob oc b">entry</code>并将其保存为对象。(这是第一次审核，包含所有与审核相关的信息)</p><p id="2f84" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">→搜索其子节点<code class="fe nz oa ob oc b">updated</code> <code class="fe nz oa ob oc b">title</code> <code class="fe nz oa ob oc b">content</code> <code class="fe nz oa ob oc b">im:rating</code> <code class="fe nz oa ob oc b">name</code>以提取所有需要的信息并保存在列表中</p><p id="965d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">→通过使用<code class="fe nz oa ob oc b">find_next_sibling()</code>找到子/标签<code class="fe nz oa ob oc b">entry</code>的同级(这将引导您进入下一个审查)</p><p id="b7e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">→继续循环，直到找不到更多评论。继续将数据追加到数据帧中。</p><p id="3512" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">→ Extra:在上面的代码中，我添加了另一个循环来提取前10个评论页面中的所有上述信息。</p><blockquote class="ps pt pu"><p id="a505" class="kw kx ny ky b kz la jr lb lc ld ju le pv lg lh li pw lk ll lm px lo lp lq lr ij bi translated">仅此而已。很整洁，对吧！</p></blockquote><p id="3eb2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">结果</strong></p><p id="94a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们应该得到一个你看起来像这样的数据帧:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi py"><img src="../Images/f07947d48b85f96ac4a7dd613abc24ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MNrl-R7Rlsm2cdtipiRunQ.png"/></div></div></figure><p id="87e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ny">瞧</em> </strong> —您已经成功地从iTunes中提取了信息。现在，你可以在它们的基础上开发你的<em class="ny">漂亮的</em> NLP模型，并了解你的客户对你的看法。</p></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><p id="eda3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要浏览我的其他数据科学/机器学习博客，请访问:</p><div class="pz qa gp gr qb qc"><a href="https://medium.com/@shirishgupta" rel="noopener follow" target="_blank"><div class="qd ab fo"><div class="qe ab qf cl cj qg"><h2 class="bd ir gy z fp qh fr fs qi fu fw ip bi translated">谢里什·古普塔培养基</h2><div class="qj l"><h3 class="bd b gy z fp qh fr fs qi fu fw dk translated">阅读希利什·古普塔在媒介上的作品。我是学术界的经济学家，专业的数据科学家和旅行者…</h3></div><div class="qk l"><p class="bd b dl z fp qh fr fs qi fu fw dk translated">medium.com</p></div></div><div class="ql l"><div class="qm l qn qo qp ql qq kp qc"/></div></div></a></div><p id="84b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">暂时结束了。有什么想法来改善这一点或希望我尝试任何新的想法？请在评论中给出你的建议。再见。</p></div></div>    
</body>
</html>