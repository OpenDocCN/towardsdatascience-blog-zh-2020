<html>
<head>
<title>The quickest way to deploy your Machine Learning model!!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">部署您的机器学习模型的最快方法！！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-quickest-way-to-deploy-your-machine-learning-model-12af348e0783?source=collection_archive---------17-----------------------#2020-07-30">https://towardsdatascience.com/the-quickest-way-to-deploy-your-machine-learning-model-12af348e0783?source=collection_archive---------17-----------------------#2020-07-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5aa2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用 Python，Tableau，机器学习和 TabPy</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/04d778b80efbd283cde910ffe00ffb4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6YaolB4RnGh_n-aP.jpg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://www.flickr.com/photos/subashpatel/43432945112/" rel="noopener ugc nofollow" target="_blank"> Subash Patel </a>拍摄</p></figure><p id="6ae7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据科学就是尽可能以最简单的方式向最终用户呈现洞察力。你在一个机器学习/深度学习模型上工作，从数据清理到超参数调整。然而，您意识到向最终用户呈现它的最重要的任务甚至还没有开始。在这里，我将讨论一种使用<strong class="ky ir"> Jupyter 笔记本</strong>和<strong class="ky ir"> Tableau </strong>部署 ML 模型的简单快捷的方法。</p><blockquote class="ls lt lu"><p id="f626" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">我们将使用<a class="ae kv" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> Scikit-Learn </a>来处理数据并构建模型。然后我们使用<a class="ae kv" href="https://www.tableau.com/about/blog/2020/1/python-tableau-now-10" rel="noopener ugc nofollow" target="_blank"> TabPy </a>来部署构建好的模型，并在 Tableau 中访问它。如果您正在寻找一种方法来部署模型，以便在云平台或分布式系统中使用它，您现在可以停止阅读。</p></blockquote><h1 id="5e48" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated"><strong class="ak">数据</strong></h1><p id="b1b4" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我们将使用 Kaggle 上可用的<a class="ae kv" href="https://www.kaggle.com/c/titanic" rel="noopener ugc nofollow" target="_blank"> Titanic </a>数据集来构建一个随机森林模型。该项目的目标是预测一名乘客是否可能在泰坦尼克号灾难中幸存。我们将使用人口统计变量，如年龄、性别、兄弟姐妹数，以及乘客的机票等级作为独立变量。</p><blockquote class="ls lt lu"><p id="669c" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">该项目的目标是预测一名乘客是否可能在泰坦尼克号灾难中幸存。</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/65297ee7574858e93e60c81de72d35b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*7r8XqOKuX4zzwgasaVFWCQ.gif"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">显示最终部署模型的仪表板。</p></figure><p id="1795" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据集包含 891 行，其中 177 个年龄值缺失。我们用平均值一个标准差内的随机数替换缺失值。同样，我们将 Fare 中的 NaNs 修改为 0。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="6503" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">建模</h1><p id="c892" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我们用默认参数构建一个随机森林分类器。然而，我们仅用 6 个变量就达到了约 94.5%的准确率，这表明它可能过度拟合了训练数据。但是，我们的重点是快速部署训练好的模型。因此，我们不会试图获得最好的评估指标，如精确度或召回率。Kaggle 上有很多其他的<a class="ae kv" rel="noopener" target="_blank" href="/predicting-the-survival-of-titanic-passengers-30870ccc7e8">资源</a>关注这一点，这里有一个简单的模型，没有交叉验证或参数调整。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="61e6" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">要求</h1><p id="e49f" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我们需要在我们的机器上安装 Python 2.x 或 Python 3.x 来开始部署，或者您可以使用<a class="ae kv" href="https://docs.anaconda.com/anaconda/install/windows/" rel="noopener ugc nofollow" target="_blank"> Anaconda </a>来安装 Jupyter Notebook 和 Python。此外，我们需要安装 TabPy 来启动一个可以托管已部署模型的服务器。你可以简单地按照<a class="ae kv" href="https://www.theinformationlab.co.uk/2019/04/09/how-to-set-up-tabpy-in-tableau/" rel="noopener ugc nofollow" target="_blank">这里</a>的步骤来做。如果您觉得安装命令花费时间，那么关闭 cmd 提示符并在另一个提示符下尝试。我不得不做了几次才弄对。</p><blockquote class="ls lt lu"><p id="cfe0" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><strong class="ky ir">TabPy</strong>(Tableau Python<strong class="ky ir">服务器</strong>)是一个分析扩展实现，它通过允许用户通过 Tableau 的表计算执行 Python 脚本和保存的函数来扩展 Tableau 的功能。</p></blockquote><h2 id="455d" class="mz ma iq bd mb na nb dn mf nc nd dp mj lf ne nf ml lj ng nh mn ln ni nj mp nk bi translated">启动并运行服务器的步骤</h2><ol class=""><li id="d6b5" class="nl nm iq ky b kz mr lc ms lf nn lj no ln np lr nq nr ns nt bi translated">在 conda 环境中安装了 TabPy 之后，打开一个新的 anaconda 命令提示符，使用“CD C:\ Users \ vipan \ anaconda 3 \ pkgs \ TabPy-server-0.2-py36 _ 1 \ Lib \ site-packages \ TabPy _ server”将目录更改为 TabPy 服务器目录。使用您的 PC 用户名和相应的目录路径代替 vipan。</li><li id="2a62" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated">运行命令“startup.bat ”,您应该会看到下面的屏幕。不要关闭此窗口，因为我们需要服务器在线。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/22acfd3eb4ec595d567fe4dc78ee13e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JFj00VDzVPnSXL_taJYUZw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">启用服务器连接</p></figure><h1 id="08c1" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated"><strong class="ak">部署</strong></h1><p id="9a5d" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">我们需要创建一个函数，该函数可以将 Tableau 中选定的参数值作为输入，并返回该人在泰坦尼克号上幸存的概率。现在，我们<strong class="ky ir">将函数和来自 Jupyter Notebook </strong>的训练模型一起部署到 Tableau-Python 服务器上。模型在服务器上保存为<strong class="ky ir"> pickle 文件。</strong>在这个步骤之后，经过训练的模型被托管在本地的 TabPy 服务器上，该服务器可以从 Tableau 访问！！</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="9de0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您得到任何错误消息说“tabpy_client”没有找到，那么您可以在 anaconda cmd 提示符下运行“pip list”命令来查看已安装库的列表并安装所需的库。通过使用“override = True ”,您可以训练和部署相同的模型，同时用最新或更新的版本替换旧版本。当您需要每天根据新数据训练模型时，这很有帮助。_arg1、_arg2 等将从 Tableau 中传递。</p><h1 id="836a" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">Tableau 配置</h1><p id="47d7" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">服务器运行后，在 Tableau 中转到:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/594b5052b9bca50604584fb68c8a068c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*taUm81SArXpoj6QTtN5Ztg.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/4d65aa442e81605a80e7829bd8cf8a41.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*SgeX1H4DC1p7O_eX-XNPCw.png"/></div></figure><p id="cf82" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">测试连接，您应该会看到下面的通知。单击确定。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/17095c3490d6c09c47ce3e51a16608b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*Ta2mEKwn34V2uJvyD6MLsw.png"/></div></figure><p id="3e7b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将“train.csv”文件导入 Tableau。为了访问 RF 模型，我们必须从 Tableau 传递参数。因此，让我们创建具有所需数据类型的参数来访问模型，如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/3df9d3f78bbc4a7c1c06a78497b4d371.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*D5bZW1poKQEP53gL55chZA.png"/></div></figure><p id="02a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">类似地，使用数据标签为等级、性别、费用、兄弟姐妹/配偶数量(SibSp)和子女或父母数量(Parch)创建参数。(<a class="ae kv" href="https://github.com/VipanchiKatthula/Titanic_survival_prediction" rel="noopener ugc nofollow" target="_blank"> Tableau 工作簿</a>供参考)。</p><p id="f656" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用下面的<a class="ae kv" href="https://gist.github.com/VipanchiKatthula/1a765baf76e880581418e5f0752575b4" rel="noopener ugc nofollow" target="_blank">脚本</a>创建一个计算字段，以连接到 TabPy 服务器。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/369e2d0ae9dd1c96bd0ede42d586039f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MtOB931Lsqc4dVsVkDQrQQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Tableau 中计算字段的脚本。</p></figure><p id="d793" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们必须将生存概率乘以 100 才能得到百分比值。此外，我通过创建另一个新的计算字段来创建死亡概率(请记住，您不能在另一个计算字段中访问之前的计算字段，因为这是一个具有分析扩展的字段)。瞧啊。！现在，我们可以使用我们创建的参数来创建可视化效果。<a class="ae kv" href="https://github.com/VipanchiKatthula/Titanic_survival_prediction/blob/master/Titanic.twbx" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="lv">这里的</em> </strong> </a> <strong class="ky ir"> <em class="lv">是我创建的互动仪表盘</em> </strong>。</p><p id="be30" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不幸的是，tableau-public 不允许发布带有分析扩展的仪表板，但您可以将它们发布到各自的工作服务器上。</p><p id="0d4b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Jupyter 笔记本的数据和代码以及 Tableau 工作簿可以在<a class="ae kv" href="https://github.com/VipanchiKatthula/Titanic_survival_prediction" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。</p><ol class=""><li id="63c7" class="nl nm iq ky b kz la lc ld lf of lj og ln oh lr nq nr ns nt bi translated"><a class="ae kv" href="https://github.com/shlok6368/App-Rating-Predictor-Model-and-Tabpy-Integration/blob/master/Model%20Building.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/shlok 6368/App-Rating-Predictor-Model-and-tabby-Integration/blob/master/Model % 20 building . ipynb</a></li><li id="a514" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated"><a class="ae kv" href="https://medium.com/@shlok6368/end-to-end-data-science-pipeline-using-python-and-tabpy-data-scraping-data-cleaning-model-41b2dcb63667" rel="noopener">https://medium . com/@ shlok 6368/end-to-end-data-science-pipeline-using-python-and-tabby-data-scraping-data-cleaning-model-41 B2 dcb 63667</a></li><li id="7fcc" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated">https://towards data science . com/predicting-the-survival-of-titanic-passengers-30870 ccc7e 8</li><li id="e5a5" class="nl nm iq ky b kz nu lc nv lf nw lj nx ln ny lr nq nr ns nt bi translated"><a class="ae kv" href="https://www.theinformationlab.co.uk/2019/04/09/how-to-set-up-tabpy-in-tableau/" rel="noopener ugc nofollow" target="_blank">https://www . theinformationlab . co . uk/2019/04/09/how-to-set-up-tabpy-in-tableau/</a></li></ol></div></div>    
</body>
</html>