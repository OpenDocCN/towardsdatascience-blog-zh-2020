# 不能 AB 考的时候怎么办

> 原文：<https://towardsdatascience.com/what-to-do-when-you-cant-ab-test-4e1dff692bf7?source=collection_archive---------14----------------------->

![](img/1c150bb956f4fc00ce5ac26472eb26e0.png)

作者图片

新的搜索软件会提高销售转化率吗？我们的新店提货流程对全渠道销售的增量影响是什么？你今天能找到吗？

我是加拿大百思买的数据科学家，这些是我们努力回答的一些重要问题，以支持产品开发和公司战略，以及我们建立的所有酷的机器学习产品(在未来的帖子中会有更多)。

为什么数据科学家也能回答数字分析师的问题？当然，AB 测试可以用来回答其中的一些问题，但这并不总是可行的。

在您需要提供答案的时间内，实施完全 AB 测试随机化可能存在技术或产品障碍。或者，可能需要测试线下世界的变化，就像我们在拥有庞大实体零售店的百思买所做的那样，在那里，客户层面的随机化是不可能的。

所以在我的工作中，我一直在使用各种反事实的方法来评估这些推论性的问题，我很乐意与社区分享它们。

**超越 AB 测试:反事实**

反事实是简单地比较在给定变化的情况下会发生什么，以及如果变化一开始就没有发生会发生什么。有很多种方法可以进行统计。我们一直在使用的一些强有力的方法包括:基于地理/市场的方法，如广义综合控制，以及基于时间序列的方法，如谷歌的因果影响。

*基于市场的方法*

基于市场的方法试图衡量引入效应的地理区域(例如新的营销渠道)和没有引入效应的控制区域之间的影响。简单地比较两个区域(治疗区域与对照区域)是没有用的，因为它们不是直接的比较。

我们需要做的是将我们的治疗区域与那些没有干预的治疗区域进行对比。在大多数基于市场的方法中，我们实际上可以使用我们的控制区域作为模型的输入，以在干预发生之前高精度地预测我们的治疗区域的行为。在引入干预措施后，测量与预测的差异可以让我们衡量任何变化对我们业务的真实影响。

![](img/45f542e0c0ac2b3be7a7863a17597fa9.png)

作者图片

我们使用的主要方法之一是由一位政治科学家在 2015 年提出的[广义综合控制](http://yiqingxu.org/software/gsynth/gsynth_examples.html)方法。易在他们的论文中用它来衡量美国选举日登记法对选民投票率的影响[1]。这是其他综合控制框架的发展:它对区域间的差异更加鲁棒，并对多个处理单元进行推广。

最近，这种方法被用来有效测试百思买执行渠道的战略变化的效果。我们试图解决的关键问题是衡量在线和店内对整个业务的收入影响。在商店体验发生变化的情况下，我们无法准确地随机选择用户进行 AB 测试。

在这个项目中，我们将美国划分为 100 多个大的地理区域，每个区域的销售额都对应于给定的送货邮政编码或商店位置。比单个城市更大的区域在大都市地区尤为重要，因为客户可以在一天之内在城市之间移动。顾客在市中心购物，然后在郊区提货是很常见的。

在大约 100 个地区中，我们选择了 20 个地区来切换到新的履行体验。这些治疗区域是基于治疗组和对照组的不同组合的功效分析模拟而选择的，它们在很大程度上代表了包括大中型城市、郊区和农村地区在内的全国范围内的业务。我们经常发现，最具预测性的特征只是规模相似且相对接近的其他地区的销售，例如同一省/州的中等城市。

一旦实验开始推广，GSC 的开源 R 库使得向我们的利益相关者报告结果变得非常容易，包括影响估计、置信区间和预测值。示例输出如下所示(结果基于为测试模型开发的假数据):

![](img/1c150bb956f4fc00ce5ac26472eb26e0.png)![](img/fab65c1076b4bc977d93cb035d3a57d5.png)

作者图片

*基于时间序列的方法*

当测量的影响不能在地理上分开时，以及当完全随机的实验不可用时，我们也使用基于时间序列的方法。我们可以比较治疗和控制时间序列，而不是比较治疗和控制区域。

我们在这里使用的主要方法是谷歌的因果影响，反事实原则仍然是我们如何衡量效果的核心。采用几个控制时间序列(不受干预影响)，我们可以建立一个治疗时间序列的预测模型，并衡量其结果的差异。

我们最近使用这种方法来测试运费的变化，这种变化只适用于销售的特定产品组。在进行我们通常会使用的完全随机 AB 测试时存在技术限制，因此关键问题是衡量对接受这种新运输体验的特定时间序列的任何销售影响。

考虑到不同的产品组合，我们建立了对照组，因此其时间序列对治疗组的变化相对不敏感。我们还模拟了治疗组和对照组的不同组合的潜在影响，以找到最终的分组。

类似于前面提到的 GSC 方法，因果影响有另一个伟大的开源库，我们利用它来返回我们与利益相关者交流的所有类型的统计结果。我们使用的输出类型的模拟示例如下所示，同样基于用于建模的虚假数据:

![](img/b4c9fd117a1ff1e64d385751906559b3.png)![](img/f9fba55481ed476f3aceccd78e00cb04.png)

作者图片

**为什么推理是数据科学工具包的关键部分**

大众媒体、在线讨论和博客中的大部分焦点都集中在数据科学的机器学习和预测方面。主观上“性感”的东西。

然而，经常被忽视的是数据科学的推理方面。重要的是要记住统计可以解决的大量问题，尤其是当预测模型很难或不可能建立时。纵观统计文献，以及经济学、心理学和生物学等领域，数据科学家可以使用大量强大的方法来支持战略决策。

**参考文献:**

[1]徐友友。、[广义综合控制方法:交互式固定效应模型因果推理](https://www.cambridge.org/core/journals/political-analysis/article/generalized-synthetic-control-method-causal-inference-with-interactive-fixed-effects-models/B63A8BD7C239DD4141C67DA10CD0E4F3) (2017)，政治分析。

[2] K. H. Brodersen，F. Gallusser，J. Koehler，N. Remy 和 S. L. Scott，[使用贝叶斯结构时间序列模型推断因果影响](https://research.google/pubs/pub41854/) (2015)，应用统计年鉴。