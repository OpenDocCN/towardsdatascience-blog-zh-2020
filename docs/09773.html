<html>
<head>
<title>How NOT to use ROC, Precision-Recall curves &amp; MCC (Matthews Correlation Coefficient)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何不使用 ROC、精确回忆曲线和 MCC(马修斯相关系数)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b?source=collection_archive---------24-----------------------#2020-07-11">https://towardsdatascience.com/how-not-to-use-roc-precision-recall-curves-mcc-matthews-correlation-coefficient-f68a33108f8b?source=collection_archive---------24-----------------------#2020-07-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d5f4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我们在这些指标上犯的常见错误&amp;如何选择最适合您的业务案例的指标</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e7ad933eec9551185d009a8c66ed4099.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5d7SZ2e4p6hZGOEB"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">SpaceX 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的<a class="ae ky" href="https://unsplash.com/@spacex?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="c85a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名数据科学家，我喜欢很多事情。其中之一就是对你正在为之创建解决方案的业务有一个整体的认识。让我们使用的公式具有真实世界的背景使它变得更加有趣。这就是为什么当我团队中的一位初级同事通过精确回忆曲线向我展示各种模型的比较时，我询问这是否是我们案例的最佳指标，他的反应是，“我可以通过 ROC 曲线展示这一点；也许那样会更好？”</p><p id="2b6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个有经验的数据科学家都会告诉你，没有对错之分。业务决定了最佳方法。所以，让我向你提出同样的问题，让我们看看什么是好的方法。</p><blockquote class="lv lw lx"><p id="e4d5" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">除非另有说明，所有图片均归作者所有。</p></blockquote><h1 id="a206" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">问题陈述</h1><p id="2198" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">我们正在为生产齿轮零件的制造工厂实施自动质量控制系统。这是一个计算机视觉问题。作为第一步，我们挑选了一个齿轮零件，并试图根据是否存在划痕、生锈、尺寸不正确等因素将其分为“好”或“坏”。发现的缺陷类型现在并不重要，只需要将其分类为好的或坏的。</p><p id="7a18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，将不良零件运送给最终客户的惩罚是巨大的，因此我们应该非常仔细地正确分类不良零件。</p><p id="d830" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们假设实际的和预测的(来自我们的模型)结果给出了下面的<a class="ae ky" rel="noopener" target="_blank" href="/the-two-variations-of-confusion-matrix-get-confused-never-again-8d4fb00df308">混淆矩阵</a>，其中我们将<strong class="lb iu">好的部分视为<em class="ly">正的</em> </strong>，将<strong class="lb iu">坏的部分视为<em class="ly">负的</em> </strong>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/b0625759509a2b5eb56265055a9c07dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*RqzMeF6Vnfgz6aA28Yh4mw.png"/></div></figure><p id="8d41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想温习与混淆矩阵相关的各种指标，如精确度、召回率、特异性，或者更喜欢预测作为列的“其他”表示，我会推荐阅读<a class="ae ky" rel="noopener" target="_blank" href="/the-two-variations-of-confusion-matrix-get-confused-never-again-8d4fb00df308"> <em class="ly">混淆矩阵的两种变化-弄糊涂了，再也不会了</em> </a>以获得更大的清晰感。</p><p id="a901" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，上面的矩阵是基于特定的概率阈值(在这种情况下为 0.5)，ROC 曲线将通过考虑各种阈值来构建，但您可以对一般的类别分布有一个大致的了解。</p><p id="cef9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您应该使用哪个指标？-</p><ol class=""><li id="6212" class="na nb it lb b lc ld lf lg li nc lm nd lq ne lu nf ng nh ni bi translated">受试者工作特征曲线</li><li id="c27e" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">精确召回曲线</li><li id="3521" class="na nb it lb b lc nj lf nk li nl lm nm lq nn lu nf ng nh ni bi translated">还有别的吗？</li></ol><h1 id="cc6e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">思维过程</h1><p id="000f" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">首先，让我们消除 ROC 曲线，因为它不是最适合不平衡的类问题。这里有一个很棒的<a class="ae ky" href="https://www.youtube.com/watch?v=4jRBRDbJemM" rel="noopener ugc nofollow" target="_blank">视频</a>可以帮你打好基础。</p><p id="9a01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在进入<a class="ae ky" href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_precision_recall.html" rel="noopener ugc nofollow" target="_blank">精确回忆</a>曲线——这是我的同事选择的。y 轴表示精度，x 轴表示召回率。如果我在不同的阈值下使用上面的混淆矩阵来绘制这条曲线，你会发现这个方法有什么问题吗？</p><blockquote class="no"><p id="b4e7" class="np nq it bd nr ns nt nu nv nw nx lu dk translated">精确回忆曲线应该会把我们的注意力吸引到 P <strong class="ak">阳性类别</strong>。</p></blockquote><p id="339d" class="pw-post-body-paragraph kz la it lb b lc ny ju le lf nz jx lh li oa lk ll lm ob lo lp lq oc ls lt lu im bi translated">如果我们想把注意力集中在“坏”的阶层上，那么积极和消极的阶层应该互换。这类似于一个医学用例，在这个用例中，癌症的检测相当于检测结果为“<strong class="lb iu">阳性</strong>”。如果只有很少的人/部分会有癌症/缺陷，那么我们将它设为阳性类别，然后使用 PR 曲线。</p><p id="34ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您不想交换类别标签，另一种非传统的方法是将 y 轴映射为<strong class="lb iu"> TN/(TN+FN) </strong>，x 轴映射为特异性或<strong class="lb iu"> TN/(TN+FP) </strong>。我可以用数学来解释这些新的轴，但是一个非常直观的记忆方式是:</p><p id="7df8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">案例一</strong>(传统 PR 曲线):以 TP 为‘pivot’，pivot 除以行和为 y 轴(精度)，pivot 除以列和为 x 轴(回忆)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/ecd2785a31ed9c3fcab68816cfd012e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/1*aaC8IIMAqou_c8QZkcQM2Q.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“传统”公关曲线</p></figure><p id="8bfe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">案例二</strong>(非传统曲线):既然你不希望交换标签，我们就以 TN 为支点。同样，与上面完全一样，pivot 除以行总和是 y 轴，而 pivot 除以列总和是 x 轴(特异性)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/0a15e473c8260307bd2811f846647ca0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/1*UzuKwWs0AGkYF5DJ_3jGIQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">“非传统”曲线</p></figure><p id="4961" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">理想的 PR 曲线在(1，1)处具有“最佳”值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/9c3c737a1be4f659135d336aa6b4a60d.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*OVyzJzdPEuvWgRpsUASmPg.png"/></div></figure><h1 id="448a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">一些其他指标？</h1><p id="7df5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果不提及马修斯相关系数或 MCC，这篇文章将是不完整的。</p><p id="215e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">MCC 适用于这样的情况:您希望在预测所有类时评估模型的性能，而不特别关注任何特定的类。这里有一个关于这个话题的很棒的博客。</p><p id="8bf5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象一下——很快，我们的问题陈述会扩大，客户会要求将所有不同的缺陷分开分类，而不仅仅是“好”或“坏”。因此，它可能是“划痕”、“尺寸错误”、“生锈”、“良好”等等。</p><p id="a4ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们筛选出几个型号，最好有一个单一的指标来比较它们在不同类别中的整体表现。MCC 就是这么做的。</p></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><p id="a5b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">希望这让您对不同的场景有所了解，在这些场景中，不同的指标是有价值的。理解它们背后的数学总是一个好主意，因为只有这样，人们才能根据自己的特定需求调整它们——就像我们将 PR 曲线调整为非传统曲线一样。</p></div><div class="ab cl of og hx oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="im in io ip iq"><p id="508b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对分享想法、提问或简单讨论想法感兴趣？通过我的网站、<a class="ae ky" href="http://iamjustastudent.com/about" rel="noopener ugc nofollow" target="_blank">我只是个学生</a>或者在<a class="ae ky" href="https://www.linkedin.com/in/himanshu-chandra-33512811/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae ky" href="https://www.youtube.com/channel/UChNybQwpqrX9SOc1D4K_x5Q" rel="noopener ugc nofollow" target="_blank"> YouTube </a>或<a class="ae ky" href="https://github.com/HCGrit/MachineLearning-iamJustAStudent" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上与我联系。</p><p id="855b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">回头见&amp;学习愉快！</p><div class="om on gp gr oo op"><a href="https://www.linkedin.com/in/himanshu-chandra-33512811/" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">Himanshu Chandra -业务主管-ML</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk">.</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">www.linkedin.com</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd ks op"/></div></div></a></div></div></div>    
</body>
</html>