<html>
<head>
<title>Predicting a Hotel Booking Demand</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测酒店预订需求</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-a-hotel-booking-demand-7608a7dbf5a4?source=collection_archive---------20-----------------------#2020-08-25">https://towardsdatascience.com/predicting-a-hotel-booking-demand-7608a7dbf5a4?source=collection_archive---------20-----------------------#2020-08-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e473" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">构建机器学习模型预测酒店预订需求。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cef4e0e9c6e18895c528e91dd859959f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9FMdvoMHbRmPXDku5YibVw.png"/></div></div></figure><p id="1a01" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本文中，我想写的是如何使用 Python 和 Jupyter Notebook 构建预测模型。我在这个实验中使用的数据是来自<a class="ae ln" href="https://www.kaggle.com/jessemostipak/hotel-booking-demand" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>的酒店预订需求数据集。</p><p id="cc6b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本文中，我将只向您展示建模阶段，只有逻辑回归模型，但是您可以在我的<a class="ae ln" href="https://github.com/dimadnan/ujian_modul_3" rel="noopener ugc nofollow" target="_blank"> Github </a>上访问完整的文档，包括数据清理、预处理和探索性数据分析。</p><p id="fa98" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">事不宜迟，我们开始吧。</p><p id="8e92" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">导入库</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lo lp l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">导入库</p></figure><p id="7f9f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">加载数据集</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lo lp l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">加载数据集</p></figure><p id="68b0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是数据集的样子。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lu"><img src="../Images/d5011694bd160a5b26e5d30ae1f17c4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0PnKqebIALn5T0_9O9Cx8Q.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">资料组</p></figure><p id="8e40" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它有 32 栏，完整版是:</p><pre class="kg kh ki kj gt lv lw lx ly aw lz bi"><span id="1fdd" class="ma mb iq lw b gy mc md l me mf">['hotel', 'is_canceled', 'lead_time', 'arrival_date_year',<br/>       'arrival_date_month', 'arrival_date_week_number',<br/>       'arrival_date_day_of_month', 'stays_in_weekend_nights',<br/>       'stays_in_week_nights', 'adults', 'children', 'babies', 'meal',<br/>       'country', 'market_segment', 'distribution_channel',<br/>       'is_repeated_guest', 'previous_cancellations',<br/>       'previous_bookings_not_canceled', 'reserved_room_type',<br/>       'assigned_room_type', 'booking_changes', 'deposit_type', 'agent',<br/>       'company', 'days_in_waiting_list', 'customer_type', 'adr',<br/>       'required_car_parking_spaces', 'total_of_special_requests',<br/>       'reservation_status', 'reservation_status_date']</span></pre><p id="ae03" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">根据我在笔记本上运行的信息，可以在三列中找到数据集中的 NaN 值，这三列是“<strong class="kt ir">国家</strong>”、“<strong class="kt ir">代理商”、“T11”和“<strong class="kt ir">公司”</strong></strong></p><p id="0388" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">基于'<strong class="kt ir"> lead_time' </strong>列的'<strong class="kt ir"> lead_time' </strong>特性，我将'<strong class="kt ir"> country </strong>中的 NaN 值替换为 PRT(葡萄牙)，其中 PRT 是最常见的国家，lead_time = 118。</p><p id="acbf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我试图替换基于<strong class="kt ir">提前期</strong>、<strong class="kt ir">到达日期月</strong>和<strong class="kt ir">到达日期周数</strong>的“<strong class="kt ir">代理人</strong>”特性上的 NaN 值，但是他们中的大多数都将“240”作为最常见的代理人。在我阅读了可以在互联网上找到的数据集的描述和解释后，作者将'<strong class="kt ir"> agent </strong>'特性描述为“进行预订的旅行社的 ID”所以，那些在数据集中有“代理人”的人是唯一通过旅行社制作图书的人，而那些没有“代理人”或值为 Nan 的人是那些没有通过旅行社制作图书的人。因此，基于此，我认为最好用 0 填充 NaN 值，而不是用代理填充它们，这会使数据集不同于原始数据集。</p><p id="11d5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后但同样重要的是，我选择放弃整个“公司”特性，因为该特性中的 NaN 约占数据的 96%。如果我决定修改数据，可能会对数据产生巨大的影响，并且可能会改变整个数据，尤其是在公司特性中。</p><p id="e27f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">分割数据集</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lo lp l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">分割数据集</p></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lo lp l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">设置 x 和 y(目标)</p></figure><p id="d322" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我试图根据与目标最相关的前 5 个(<strong class="kt ir"> is_canceled </strong>)来拆分数据集，它们是<strong class="kt ir">required _ car _ parking _ spaces</strong>'、<strong class="kt ir"> lead_time </strong>'、<strong class="kt ir"> booking_changes </strong>'、<strong class="kt ir"> adr、</strong>和<strong class="kt ir"> is_canceled。</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lo lp l"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">训练和测试各占 80%和 20%。</p></figure><p id="14bc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">拟合模型</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mg"><img src="../Images/37e9519e4b529fc81ac7834579045e12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-0nE6w5pDTEUJ9ksvpGeFQ.png"/></div></div></figure><p id="d97b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">model_LogReg_Asli 是在使用超参数调优之前使用逻辑回归的原始模型，这里是模型预测。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/2b8d05eae89a85c59da0f5ee3e62a3e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*BBWgMw0oGK5o2ePsfkN4gQ.png"/></div></figure><p id="d8f4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">车型性能</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/679f165b3ab8210320ab3c3789b09a28.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*11mOq2Bje17iLkU_ShtYWw.png"/></div></figure><p id="4f82" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">正如你在上面看到的，逻辑回归模型有大约 69.3%的准确率。</p><p id="a174" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">模型参数</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/1f9ef957aeb3392926084779270c7e8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*i2DMF0Ok7wk9e3LHgmntmA.png"/></div></figure><p id="a36d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">带有随机搜索 CV 的逻辑回归</strong></p><p id="52d8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">model_LR_RS 是使用带有超参数调整(随机化)的逻辑回归的模型。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mk"><img src="../Images/b08e413a7b675aa2910122c59cd25017.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jech7gNWmUne7KevxVNCqw.png"/></div></div></figure><p id="3ce5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如上图所示，带有随机搜索 CV 的逻辑回归模型与没有随机搜索 CV 的逻辑回归模型具有完全相同的结果，即 69.3%。</p><p id="1f11" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">带网格搜索 CV 的逻辑回归</strong></p><p id="f134" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">model_LR2_GS 是使用带有超参数调整(网格搜索)的逻辑回归的模型。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/0f00b718f640d18279d8c27a27a980a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BeFlK_XfRbhptjAH19WM5w.png"/></div></div></figure><p id="312c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">上图显示，具有网格搜索 CV 的逻辑回归模型具有完全相同的准确性，即 69.3%。</p><p id="eb82" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">评估模型</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/5ac8cc440d1c30b9dc45dcd1fc9d9ed7.png" data-original-src="https://miro.medium.com/v2/resize:fit:602/format:webp/1*o6t1LCSnzLp9HDGnFaP87Q.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">混淆矩阵</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mn"><img src="../Images/822c482ce91ac289e2bd7090f9d78bab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m2H6r0G_u1UKRuqLF6rVRg.png"/></div></div></figure><p id="f76d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">TN 为真阴性，FN 为假阴性，FP 为假阳性，TP 为真阳性，而 0 不取消，1 取消。下面是该型号的分类报告。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/42791ea1b131ac5590abcc0479320ab6.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*ky3o203PntWZsM6tCRu-tQ.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">分类报告</p></figure><p id="8c90" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本文中，我再次使用逻辑回归进行测试，但是您可以使用其他类型的模型，如随机森林、决策树等等。在我的 Github 上，我也尝试了随机森林分类器，但是结果非常相似。</p><p id="166b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这就是本文的全部内容。谢谢你，祝你愉快。</p></div></div>    
</body>
</html>