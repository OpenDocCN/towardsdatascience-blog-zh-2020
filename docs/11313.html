<html>
<head>
<title>How to use the notorious VLOOKUP function in Google Sheets?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 Google Sheets 中臭名昭著的 VLOOKUP 功能？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-the-notorious-vlookup-function-in-google-sheets-3dd6f825d4fe?source=collection_archive---------45-----------------------#2020-08-05">https://towardsdatascience.com/how-to-use-the-notorious-vlookup-function-in-google-sheets-3dd6f825d4fe?source=collection_archive---------45-----------------------#2020-08-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="61bf" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">电子表格/虚拟桌面</h2><div class=""/><div class=""><h2 id="cda9" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">以及如何克服它带来的各种挑战。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/26793e31cf6e12619a5b41ed1d7fb0ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jjcQXAOncg-GS-Ya"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@brucemars?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">布鲁斯·马尔斯</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="df1b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Google Sheets(或 Microsoft Excel)最神奇(也最令人困惑)的功能之一是<strong class="lk jd"> VLOOKUP </strong>。尽管从任何意义上来说都不完美，但它确实提供了强大的功能来连接两个不同的表，或者将一个表的值附加到另一个表中。</p><h1 id="01e2" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">什么是 VLOOKUP？</h1><p id="27ef" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">VLOOKUP 是电子表格中的一个功能，它允许用户<strong class="lk jd">在两个表格之间建立关系</strong>。让我们试着用一个例子来理解它。</p><p id="ff09" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">假设您是一家即将成立的游戏工作室的分析师，他们希望您创建一个 2002 年最畅销游戏的数据库。幸运的是，您发现了一个包含所有信息的惊人数据集，它是这样的:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nb"><img src="../Images/baddb8b6f92d94ad434382a9e0e926c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gMpAM7WA45KJhQlF0tQUPw.png"/></div></div></figure><p id="e741" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">它包含两个独立表格中的信息:</p><ul class=""><li id="7e1f" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated">一个表格包含游戏名称和发布平台的信息。</li><li id="9377" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated">第二个表包含游戏名称和北美和欧洲的销售额(以百万计)。</li></ul><p id="95df" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">有关上述数据集的更多信息，您可以访问<a class="ae lh" href="https://www.kaggle.com/gregorut/videogamesales" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>。</p><p id="6d93" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们如何<strong class="lk jd">合并两个表</strong>？我们可以简单地将值从一个复制粘贴到另一个。但是仔细看，两个表中的名字<strong class="lk jd">不是同一个顺序</strong>！嗯，我们可以一个一个复制粘贴。但是任务太多了！为什么不让电子表格来帮我们做呢？听起来像个计划！这就是全能的 VLOOKUP 函数出现的地方！</p><h1 id="1e0e" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">如何使用 VLOOKUP？</h1><p id="e263" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">下面是 VLOOKUP 函数的样子:</p><pre class="ks kt ku kv gt nq nr ns nt aw nu bi"><span id="2549" class="nv mf it nr b gy nw nx l ny nz">=VLOOKUP(search_key, range, index, [is_sorted])</span></pre><p id="79f4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">函数中需要的<strong class="lk jd"> 3 个强制参数</strong>。以下是它们是什么以及它们是如何工作的:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oa"><img src="../Images/df59e3b1718109588b7566cfefbc0679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iJsnBgSaySjN30ayN4Lrgw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">VLOOKUP 函数的作用</p></figure><ul class=""><li id="031d" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated"><strong class="lk jd">搜索关键字:</strong>选择您<strong class="lk jd">想要查找其值</strong>的单元格。在这个例子中，我们想要找到单元格 A2 中提到的游戏标题的<code class="fe ob oc od nr b">NA_Sales</code>数字。所以搜索关键字是 A2。</li><li id="d054" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated"><strong class="lk jd">范围</strong> : <strong class="lk jd">你想要的数值</strong>在哪里？在我们的例子中，它位于表中 D2 到 F16 的某个位置。因此，我们选择要从中复制值的整个表。请注意我们是如何添加许多$符号的。一旦你选择了表格范围，要做到这一点，只需按下键盘上的 F4，你会有相同的格式。</li></ul><blockquote class="oe of og"><p id="572b" class="li lj oh lk b ll lm kd ln lo lp kg lq oi ls lt lu oj lw lx ly ok ma mb mc md im bi translated">关于为什么使用$ signs 的一个小注意:一旦你创建了你的函数，下一个自然的步骤是向下拖动该函数并将其应用于下面的所有单元格。如果你没有按下 F4，随着<strong class="lk jd">拖动公式中的搜索键</strong>，你就是<strong class="lk jd">也在拖动你所选择的范围</strong>。这将意味着，为了找到对应于 A4 的值，您实际上是在范围 D3:F17 中搜索，而不是您原来的 D2:F16。所以如果你的 A4 值在 D2，你的函数不会读取它并抛出一个错误。这就是$符号出现的地方。按下 F4 一次，你就<strong class="lk jd">冻结了选定的范围</strong>，这样一旦你把公式拖到下面的单元格中，它就不会改变范围，而只会改变搜索关键字。</p></blockquote><ul class=""><li id="3712" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md nh ni nj nk bi translated"><strong class="lk jd"> Index </strong>:在您刚刚选择的范围内，<strong class="lk jd">您要抓取的列</strong>是哪一列？在我们的例子中，它是<code class="fe ob oc od nr b">NA_Sales</code>列，这是 D2 到 F16 的选定范围中的第二列。请注意，索引号从步骤 2 中所选范围的第一列开始。</li><li id="e626" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md nh ni nj nk bi translated"><strong class="lk jd">已排序:</strong>这是一个<strong class="lk jd">可选的</strong>字段。出于所有实际目的，将其设置为零或假。就我个人而言，我从未遇到过将该字段设置为其他方式的情况。</li></ul><p id="e7f9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">然后按回车键！这个函数现在在您提到的的<strong class="lk jd">范围内，在您的搜索关键字</strong>中找到<strong class="lk jd">值，一旦找到匹配，它<strong class="lk jd">就会抓取提到的索引列</strong>并给出结果。在这种情况下，它将打印值 8.41，因为这是提到的第一个游戏在北美地区的销售额。以下是最终的解决方案:</strong></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/6b5847bbb8c5ebf6adf55d4a50217d9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*072n7o2Enh9ynI-Q8Cvfcw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">成功实现 VLOOKUP 后的最终结果</p></figure><h1 id="cf8e" class="me mf it bd mg mh mi mj mk ml mm mn mo ki mp kj mq kl mr km ms ko mt kp mu mv bi translated">常见陷阱以及如何避免它们</h1><p id="feec" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">以下是应用 VLOOKUP 时需要记住的几个要点:</p><ol class=""><li id="e89e" class="nc nd it lk b ll lm lo lp lr ne lv nf lz ng md om ni nj nk bi translated">查找函数如何知道在提到的范围内匹配什么？请始终记住，查找函数<strong class="lk jd">只会匹配公式中指定范围的第一列</strong>中提到的值。在我们的例子中，我们提到的产品系列是 D2:F16。搜索关键字将只与 D2:F16 范围的 D 列中的值匹配。通常，搜索范围的第一列应该是搜索关键字所在的列。</li><li id="3e62" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md om ni nj nk bi translated">查找函数<strong class="lk jd">将总是提供它得到的第一个结果</strong>。<br/>例如，如果在销售表中多次提到一个游戏，它会获取第一个匹配的值并相应地提供结果。<br/>如果你有<strong class="lk jd">同一个搜索关键字的多个实例</strong>，VLOOKUP 是<strong class="lk jd">而不是</strong>要走的路！</li><li id="ad80" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md om ni nj nk bi translated">您需要确保在范围<strong class="lk jd">中找到的<strong class="lk jd">搜索关键字</strong>和<strong class="lk jd">值</strong>与</strong>完全匹配。不应该有多余的空格。字符串大小写应该是一样的。如果不是，它将与值不匹配，您将得不到想要的结果。</li><li id="de72" class="nc nd it lk b ll nl lo nm lr nn lv no lz np md om ni nj nk bi translated">当 VLOOKUP 在该范围内没有找到您要寻找的值时，它通常会抛出一个<strong class="lk jd"> #N/A 错误</strong>。这仅仅意味着该值不存在于所提到的范围内，或者该范围存在一些额外的空格或大小写问题(如上所述)。</li></ol><p id="0469" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">VLOOKUP 还有另一个变种，叫做 HLOOKUP。VLOOKUP 垂直匹配值，HLOOKUP 水平匹配值。该功能的工作方式完全相同。</p><p id="ec87" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">VLOOKUP 并不是连接两个表的完美解决方案。但是在大多数情况下，<strong class="lk jd">小心执行</strong>并记住<strong class="lk jd">常见陷阱</strong>，你可以在很多场景中使用 VLOOKUP。还有另一种更强大的方法来解决连接两个表的问题，这种方法通常被称为索引匹配函数，在下一篇文章中会详细介绍。</p><p id="065d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">同时，继续分析！</p></div></div>    
</body>
</html>