<html>
<head>
<title>DengAI — How to approach Data Science competitions? (EDA)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">邓艾—如何对待数据科学竞赛？(EDA)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dengai-how-to-approach-data-science-competitions-eda-22a34158908a?source=collection_archive---------38-----------------------#2020-08-06">https://towardsdatascience.com/dengai-how-to-approach-data-science-competitions-eda-22a34158908a?source=collection_archive---------38-----------------------#2020-08-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="4b56" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">理解 ML</h2><div class=""/><div class=""><h2 id="6c05" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">一步一步解释如何应对类似的竞争。哪些是我们应该重点关注的，哪些是应该忽略的？</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/1258e6ea597e39b3836cd82007debcbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*musZZRCcX_u5EUHI.jpg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">蚊子 CC BY-NC-ND 2.0。来源:</em> <a class="ae lf" href="https://www.flickr.com/photos/sanofi-pasteur/5284040324/in/photolist-93W66w-arV2fF-3p8QNh-cnF7KE-cnF7Mj-cnF8a7-3p8RvU-cnF88u-cnF7Nu-arXFfy-cnF7J7-arXFto-arXDno-cnF7Hb-rwLX9d-cnF7UC-yM76y7-cnF7Ps-cnF85Q-cnF84G-cnF7TE-9wSDw-e4U78V-qRQpJa-e8GxDY-d4YEBA-d4YEwu-e8AVyt-e8GoTN-cnF873-4Gq9Y9-cnFty3-cnF7SQ-c3urbq-cnF7RY-qRJm2d-cnF7VL-62BwyV-qRJj2S-r9i7QB-r99a5k-62Bwt8-c3urhL-c3urd5-5xe7XE-pNRXZp-qRSbMx-pocK57-5xe13J-cnF7XY" rel="noopener ugc nofollow" target="_blank"> <em class="le"> flickr 用户赛诺菲巴斯德</em> </a></p></figure><blockquote class="lg lh li"><p id="ad1c" class="lj lk ll lm b ln lo ka lp lq lr kd ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated"><em class="iq">本文基于我在 DrivenData 平台</em>  <em class="iq">上参加</em> <a class="ae lf" href="https://www.drivendata.org/competitions/44/dengai-predicting-disease-spread/" rel="noopener ugc nofollow" target="_blank"> <em class="iq">邓艾大赛。我的得分在 0.2%以内(截至 2020 年 6 月 2 日，14/9069)。这里提出的一些想法是严格为这样的比赛设计的，可能没什么用。</em></a></p></blockquote><p id="2442" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">在开始之前，我必须提醒您，对于更高级的数据工程师来说，有些部分可能是显而易见的，这是一篇很长的文章。你可以一节一节地读，或者只挑选你感兴趣的部分:</p><p id="4dbb" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated"><a class="ae lf" rel="noopener" target="_blank" href="/dengai-data-preprocessing-28fc541c9470">邓艾，数据预处理</a></p><p id="c974" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated"><em class="ll">更多零件即将推出… </em></p><h1 id="1886" class="mj mk iq bd ml mm mn mo mp mq mr ms mt kf mu kg mv ki mw kj mx kl my km mz na bi translated">问题描述</h1><p id="d280" class="pw-post-body-paragraph lj lk iq lm b ln nb ka lp lq nc kd ls mg nd lv lw mh ne lz ma mi nf md me mf ij bi translated">首先，我们需要讨论比赛本身。邓艾的目标是(实际上，此时此刻甚至是，因为 DrivenData 的管理部门决定让它成为“正在进行的”比赛，所以你可以参加并亲自尝试)根据天气数据和位置预测特定周内的登革热病例数。每个参与者都有一个<a class="ae lf" href="https://github.com/burnpiro/dengai-predicting-disease-spread/blob/master/dengue_features_train.csv" rel="noopener ugc nofollow" target="_blank">训练数据集</a>和<a class="ae lf" href="https://github.com/burnpiro/dengai-predicting-disease-spread/blob/master/dengue_features_test.csv" rel="noopener ugc nofollow" target="_blank">测试数据集</a>(非验证数据集)。<strong class="lm ja"> MAE </strong> ( <strong class="lm ja">平均绝对误差</strong>)是一个用于计算得分的指标，训练数据集覆盖了 2 个城市 28 年的周值(1456 周)。测试数据较小，跨越 5 年和 3 年(取决于城市)。</p><p id="a464" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">对于那些不知道的人来说，登革热是一种蚊子传播的疾病，发生在世界的热带和亚热带地区。因为它是由蚊子携带的，所以传播与气候和天气变量有关。</p><h1 id="7afe" class="mj mk iq bd ml mm mn mo mp mq mr ms mt kf mu kg mv ki mw kj mx kl my km mz na bi translated">资料组</h1><p id="834b" class="pw-post-body-paragraph lj lk iq lm b ln nb ka lp lq nc kd ls mg nd lv lw mh ne lz ma mi nf md me mf ij bi translated">如果我们看一下训练数据集，它有多个特征:</p><p id="272c" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated"><strong class="lm ja">城市和日期指示器:</strong></p><ul class=""><li id="6e49" class="ng nh iq lm b ln lo lq lr mg ni mh nj mi nk mf nl nm nn no bi translated"><strong class="lm ja">城市</strong> —城市缩写:<strong class="lm ja"> sj </strong>代表圣胡安<strong class="lm ja"> iq </strong>代表伊基托斯</li><li id="4bf6" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja"> week_start_date </strong> —以 yyyy-mm-dd 格式给出的日期</li></ul><p id="633b" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated"><strong class="lm ja"> NOAA 的 GHCN 每日气候数据气象站测量:</strong></p><ul class=""><li id="536a" class="ng nh iq lm b ln lo lq lr mg ni mh nj mi nk mf nl nm nn no bi translated"><strong class="lm ja">最高温度温度</strong> —最高温度</li><li id="384e" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja">车站最低温度</strong> —最低温度</li><li id="ff57" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja"> station_avg_temp_c </strong> —平均温度</li><li id="989c" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja"> station_precip_mm </strong> —总降水量</li><li id="387c" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja">station _ diur _ temp _ RNG _ c</strong>—日温度范围</li></ul><p id="a126" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated"><strong class="lm ja">波兰卫星降水测量(0.25x0.25 度刻度):</strong></p><ul class=""><li id="c81e" class="ng nh iq lm b ln lo lq lr mg ni mh nj mi nk mf nl nm nn no bi translated"><strong class="lm ja">降水量 _ 降雨量 _ 毫米</strong> —总降水量</li></ul><p id="5c5e" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated"><strong class="lm ja"> NOAA 的 NCEP 气候预报系统再分析测量值(0.5x0.5 度尺度):</strong></p><ul class=""><li id="a8ef" class="ng nh iq lm b ln lo lq lr mg ni mh nj mi nk mf nl nm nn no bi translated"><strong class="lm ja">再分析 _sat_precip_amt_mm </strong> —总降水量</li><li id="b73d" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja">再分析 _ 露点温度 _k </strong> —平均露点温度</li><li id="78b0" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja">再分析 _ 空气温度 _k </strong> —平均空气温度</li><li id="b7a3" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja">再分析 _ 相对湿度 _ 百分比</strong> —平均相对湿度</li><li id="c580" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja">再分析 _ 比湿度 _ 克/千克</strong> —平均比湿度</li><li id="d739" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja">再分析 _ 降水量 _ 千克/平方米</strong> —总降水量</li><li id="b33f" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja">再分析 _ 最高空气温度 _k </strong> —最高空气温度</li><li id="5802" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja">再分析 _ 最小空气温度 _k </strong> —最低空气温度</li><li id="1b0b" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja">再分析 _ 平均温度 _k </strong> —平均气温</li><li id="1b85" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja">再分析 _tdtr_k </strong> —日温差</li></ul><p id="fb0b" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated"><strong class="lm ja">卫星植被——归一化差异植被指数(NDVI)——NOAA 的 CDR 归一化差异植被指数(0.5x0.5 度标度)测量:</strong></p><ul class=""><li id="ceb7" class="ng nh iq lm b ln lo lq lr mg ni mh nj mi nk mf nl nm nn no bi translated"><strong class="lm ja"> ndvi_se </strong> —城市质心东南方向的像素</li><li id="ca21" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja"> ndvi_sw </strong> —城市质心西南方向的像素</li><li id="6373" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja"> ndvi_ne </strong> —城市质心东北方向的像素</li><li id="dffc" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja"> ndvi_nw </strong> —城市质心西北的像素</li></ul><p id="8c6b" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">此外，我们还有每周<strong class="lm ja">总例数</strong>的相关信息。</p><p id="05fe" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">很容易发现，对于数据集中的每一行，我们都有多个描述相似类型数据的特征。有四个类别:</p><p id="3682" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">-温度<br/> -降水<br/> -湿度<br/> - ndvi(这四个特征指的是城市中不同的点，所以它们不是完全相同的数据)</p><p id="9884" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">因此，我们应该能够从输入中删除一些冗余数据。我们不能随机选择一个温度。如果我们只看温度数据，范围(最小值、平均值、最大值)和类型(平均露点或昼夜)之间是有区别的。</p><h2 id="fbbf" class="nu mk iq bd ml nv nw dn mp nx ny dp mt mg nz oa mv mh ob oc mx mi od oe mz iw bi translated">输入示例:</h2><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="ad53" class="nu mk iq og b gy ok ol l om on">week_start_date 1994-05-07<br/>total_cases 22<br/>station_max_temp_c 33.3<br/>station_avg_temp_c 27.7571428571<br/>station_precip_mm 10.5<br/>station_min_temp_c 22.8<br/>station_diur_temp_rng_c 7.7<br/>precipitation_amt_mm 68.0<br/>reanalysis_sat_precip_amt_mm 68.0<br/>reanalysis_dew_point_temp_k 295.235714286<br/>reanalysis_air_temp_k 298.927142857<br/>reanalysis_relative_humidity_percent 80.3528571429<br/>reanalysis_specific_humidity_g_per_kg 16.6214285714<br/>reanalysis_precip_amt_kg_per_m2 14.1<br/>reanalysis_max_air_temp_k 301.1<br/>reanalysis_min_air_temp_k 297.0<br/>reanalysis_avg_temp_k 299.092857143<br/>reanalysis_tdtr_k 2.67142857143<br/>ndvi_location_1 0.1644143<br/>ndvi_location_2 0.0652<br/>ndvi_location_3 0.1321429<br/>ndvi_location_4 0.08175</span></pre><h2 id="9bbe" class="nu mk iq bd ml nv nw dn mp nx ny dp mt mg nz oa mv mh ob oc mx mi od oe mz iw bi translated">提交格式:</h2><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="73f5" class="nu mk iq og b gy ok ol l om on">city,year,weekofyear,total_cases<br/>sj,1990,18,4<br/>sj,1990,19,5<br/>...</span></pre><h2 id="8d92" class="nu mk iq bd ml nv nw dn mp nx ny dp mt mg nz oa mv mh ob oc mx mi od oe mz iw bi translated">分数评估:</h2><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/1c026712b6bb8833ce54047bd7c8647d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*vAkM7Tz1QXCEq81vz8DRKA.png"/></div></figure><h1 id="9c41" class="mj mk iq bd ml mm mn mo mp mq mr ms mt kf mu kg mv ki mw kj mx kl my km mz na bi translated">数据分析</h1><p id="c302" class="pw-post-body-paragraph lj lk iq lm b ln nb ka lp lq nc kd ls mg nd lv lw mh ne lz ma mi nf md me mf ij bi translated">在开始设计模型之前，我们需要查看原始数据并修正它。为了实现这个目标，我们将使用<a class="ae lf" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫图书馆</a>。通常，我们可以直接导入<code class="fe op oq or og b">.csv</code>文件，并在导入的数据帧上工作，但有时(尤其是当第一行没有列描述时)我们必须提供列的列表。</p><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="8036" class="nu mk iq og b gy ok ol l om on">import pandas as pd<br/>pd.set_option("display.precision", 2)<br/><br/>df = pd.read_csv('./dengue_features_train_with_out.csv')<br/>df.describe()</span></pre><p id="2644" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">Pandas 有一个名为<code class="fe op oq or og b">describe</code>的内置方法，可以显示数据集中列的基本统计信息。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi os"><img src="../Images/a56b13114de15370fd74c7c0b8413119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y154sThOQKTlh1OXW9tAbw.png"/></div></div></figure><p id="30da" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">自然，这种方法只对数字数据有效。如果我们有非数字列，我们必须先做一些预处理。在我们的例子中，唯一的分类列是<strong class="lm ja">城市</strong>。该列只包含两个值<strong class="lm ja"> sj </strong>和<strong class="lm ja"> iq </strong>，我们将在稍后处理它。</p><p id="0078" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">回到主桌。每行包含不同种类的信息:</p><ul class=""><li id="5f8d" class="ng nh iq lm b ln lo lq lr mg ni mh nj mi nk mf nl nm nn no bi translated"><strong class="lm ja">计数</strong> —描述非 NaN 值的个数，基本上有多少值是正确的，不是空数</li><li id="6462" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja">平均值</strong> —整列的平均值(用于归一化)</li><li id="92cb" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja"> std </strong> —标准偏差(也适用于标准化)</li><li id="e684" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated"><strong class="lm ja">最小值</strong>-&gt;-<strong class="lm ja">最大值</strong>-显示包含值的范围(对缩放有用)</li></ul><p id="745f" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">让我们从<strong class="lm ja">计数</strong>开始。知道数据集中有多少条记录有缺失数据(一条或多条)并决定如何处理它们是很重要的。如果你看一下<strong class="lm ja"> ndvi_nw </strong>值，13.3%的情况下是空的。如果您决定用像 0 这样的任意值替换丢失的值，这可能是一个问题。通常，这个问题有两种常见的解决方案:</p><ul class=""><li id="9e71" class="ng nh iq lm b ln lo lq lr mg ni mh nj mi nk mf nl nm nn no bi translated">设置一个<strong class="lm ja">平均值</strong>值</li><li id="afbf" class="ng nh iq lm b ln np lq nq mg nr mh ns mi nt mf nl nm nn no bi translated">做<strong class="lm ja">插补</strong></li></ul><p id="be38" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated"><strong class="lm ja">插值(处理缺失数据)</strong></p><p id="a718" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">当处理系列数据时(就像我们所做的那样)，从相邻数据中插值(仅从相邻数据中求平均值)比用整个集合的平均值替换更容易。通常，系列数据在系列中的值之间有一定的相关性，使用邻居会得到更好的结果。我给你举个例子。</p><p id="2b3e" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">假设您正在处理温度数据，并且您的整个数据集由从 1 月到 12 月的值组成。全年的平均值将是全年大部分时间里缺失天数的无效替代。如果你从 7 月开始计算天数，那么你可能会得到类似于<strong class="lm ja"> [28，27，-，30] </strong>(或者<strong class="lm ja"> [82，81，-，86] </strong>的值，对于那些喜欢英制单位的人来说)。如果那是一个伦敦，那么年平均温度是<strong class="lm ja">11 摄氏度</strong>(或 52 华氏度)。在这种情况下使用 11 条接缝是错误的，不是吗？这就是为什么我们应该使用插值而不是平均值。通过插值(即使在有更大间隙的情况下)，我们应该能够获得更好的结果。如果你计算值，你应该得到(27+30)/2=28.5 和(28.5+30)/2=29.25，所以最后我们的数据集看起来像<strong class="lm ja">【28，27，28.5，29.25，30】</strong>，比<strong class="lm ja">【28，27，11，11，30】</strong>好得多。</p><p id="4c68" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated"><strong class="lm ja">将数据集分割成城市</strong></p><p id="21f4" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">因为我们已经介绍了一些重要的内容，所以让我们定义一个方法，该方法允许我们将分类列(<strong class="lm ja"> city </strong>)重新定义为二进制列向量并插入数据:</p><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="587f" class="nu mk iq og b gy ok ol l om on">def extract_data(train_file_path, columns, categorical_columns=CATEGORICAL_COLUMNS, categories_desc=CATEGORIES,<br/>                 interpolate=True):<br/>    # Read csv file and return<br/>    all_data = pd.read_csv(train_file_path, usecols=columns)<br/>    if categorical_columns is not None:<br/>        # map categorical to columns<br/>        for feature_name in categorical_columns:<br/>            mapping_dict = {categories_desc[feature_name][i]: categories_desc[feature_name][i] for i in<br/>                            range(0, len(categories_desc[feature_name]))}<br/>            all_data[feature_name] = all_data[feature_name].map(mapping_dict)<br/><br/>        # Change mapped categorical data to 0/1 columns<br/>        all_data = pd.get_dummies(all_data, prefix='', prefix_sep='')<br/><br/>    # fix missing data<br/>    if interpolate:<br/>        all_data = all_data.interpolate(method='linear', limit_direction='forward')<br/><br/>    return all_data</span></pre><blockquote class="lg lh li"><p id="e706" class="lj lk ll lm b ln lo ka lp lq lr kd ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated"><em class="iq">所有常量(如 CATEGORICAL _ COLUMNS)都在</em> <a class="ae lf" href="https://gist.github.com/burnpiro/30610b5cf9fd685905fe36a0572ab292" rel="noopener ugc nofollow" target="_blank"> <strong class="lm ja"> <em class="iq">本要诀</em> </strong> </a> <em class="iq">中定义。</em></p></blockquote><p id="5dde" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">该函数返回一个数据集，该数据集包含两个名为<strong class="lm ja"> sj </strong>和<strong class="lm ja"> iq </strong>的二进制列，它们具有真值，其中<strong class="lm ja"> city </strong>被设置为<strong class="lm ja"> sj </strong>或<strong class="lm ja"> iq </strong>。</p><h2 id="c782" class="nu mk iq bd ml nv nw dn mp nx ny dp mt mg nz oa mv mh ob oc mx mi od oe mz iw bi translated">绘制数据</h2><p id="664f" class="pw-post-body-paragraph lj lk iq lm b ln nb ka lp lq nc kd ls mg nd lv lw mh ne lz ma mi nf md me mf ij bi translated">绘制数据以直观地了解数值在系列中的分布是很重要的。我们将使用一个名为<a class="ae lf" href="https://seaborn.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Seaborn </a>的库来帮助我们绘制数据。</p><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="0825" class="nu mk iq og b gy ok ol l om on">sns.pairplot(dataset[["precipitation_amt_mm", "reanalysis_sat_precip_amt_mm", "station_precip_mm"]], diag_kind="kde")</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/cc696ac0b0e0563db26db98b31705e14.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/0*6FzWtTYRf24NtAsc.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">训练数据集中的再分析最小空气温度 k</em></p></figure><p id="9525" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">这里我们只有数据集的一个特征，我们可以清楚地区分季节和城市(平均值从大约 297K 下降到大约 292K 的点)。</p><p id="f815" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">另一件有用的事情是不同特征之间的<strong class="lm ja">对相关性</strong>。这样，我们就能够从数据集中移除一些冗余的要素。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/94d04f010d01e3ea2d1609042bc4a3a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/0*zwjL2AvUB6Sv6oaD.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">降水成对图</em></p></figure><p id="ca58" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">正如您所注意到的，我们可以立即删除其中一个降水特征。起初这可能是无意的，但因为我们有来自不同来源的数据，同类数据(如降水量)不会总是彼此完全相关。这可能是由于不同的测量方法或其他原因。</p><h2 id="fc95" class="nu mk iq bd ml nv nw dn mp nx ny dp mt mg nz oa mv mh ob oc mx mi od oe mz iw bi translated">数据相关性</h2><p id="74c0" class="pw-post-body-paragraph lj lk iq lm b ln nb ka lp lq nc kd ls mg nd lv lw mh ne lz ma mi nf md me mf ij bi translated">当处理大量特征时，我们不需要像那样为每一对绘制配对图。另一种选择是计算叫做<strong class="lm ja">的相关性分数</strong>。不同类型的数据有不同类型的相关性。因为我们的数据集只包含数字数据，所以我们可以使用名为<code class="fe op oq or og b">.corr()</code>的内置方法来为每个城市生成相关性。</p><blockquote class="lg lh li"><p id="54d7" class="lj lk ll lm b ln lo ka lp lq lr kd ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated"><em class="iq">如果存在不应被视为二进制的分类列，您可以计算</em> <a class="ae lf" href="https://en.wikipedia.org/wiki/Cram%C3%A9r%27s_V" rel="noopener ugc nofollow" target="_blank"> <em class="iq">克莱姆的 V 关联度量</em> </a> <em class="iq">来找出它们与其余数据之间的“相关性”。</em></p></blockquote><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="8f34" class="nu mk iq og b gy ok ol l om on">import pandas as pd<br/>import seaborn as sns<br/><br/># Importing our extraction function<br/>from helpers import extract_data<br/>from data_info import *<br/><br/>train_data = extract_data(train_file, CSV_COLUMNS)<br/><br/># Get data for "sj" city and drop both binary columns<br/>sj_train = train_data[train_data['sj'] == 1].drop(['sj', 'iq'], axis=1)<br/><br/># Generate heatmap<br/>corr = sj_train.corr()<br/>mask = np.triu(np.ones_like(corr, dtype=np.bool))<br/>plt.figure(figsize=(20, 10))<br/>ax = sns.heatmap(<br/>    corr, <br/>     mask=mask, <br/>    vmin=-1, vmax=1, center=0,<br/>    cmap=sns.diverging_palette(20, 220, n=200),<br/>    square=True<br/>)<br/>ax.set_title('Data correlation for city "sj"')<br/>ax.set_xticklabels(<br/>    ax.get_xticklabels(),<br/>    rotation=45,<br/>    horizontalalignment='right'<br/>);</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ov"><img src="../Images/bfde42cc3eed3a1fbdec18dec92af86d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RYcLCOr8STNcSpIf.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">SJ 市的特征相关性</em></p></figure><p id="10dd" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">你可以对 iq 城市做同样的事情，并比较两者(相关性不同)。</p><p id="f029" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">如果你看这张热图，很明显哪些特征是相互关联的，哪些是不关联的。你应该知道正相关和负相关(深蓝和深红)。不相关的特征是白色的。存在多组正相关的特征，并且不出所料，它们指的是相同类型的测量(在<em class="ll"> station_min_temp_c </em>和<em class="ll"> station_avg_temp_c </em>之间的相关性)。但不同种类的特征之间也有相关性(如<em class="ll">再分析 _ 比 _ 湿度 _ 克 _ 每 _ 千克</em>和<em class="ll">再分析 _ 露点 _ 温度 _k </em>)。我们还应该关注<strong class="lm ja"> total_cases </strong>和其余特性之间的相关性，因为这是我们必须预测的。</p><p id="62fd" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">这一次我们运气不佳，因为没有什么与我们的目标有很强的相关性。但是我们仍然应该能够为我们的模型选择最重要的特性。查看热图现在没什么用，所以让我切换到条形图。</p><pre class="kp kq kr ks gt of og oh oi aw oj bi"><span id="5981" class="nu mk iq og b gy ok ol l om on">sorted_y = corr.sort_values(by='total_cases', axis=0).drop('total_cases')<br/>plt.figure(figsize=(20, 10))<br/>ax = sns.barplot(x=sorted_y.total_cases, y=sorted_y.index, color="b")<br/>ax.set_title('Correlation with total_cases in "sj"')</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/1af265877cb4348a75541c95b4a15221.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eExme0msbsSQd7lz.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">与 sj 市目标值的相关性</em></p></figure><p id="c186" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">通常，在为我们的模型挑选特征时，我们选择与我们的目标具有最高绝对相关值的特征。由你来决定选择多少功能，你甚至可以选择所有的功能，但这通常不是最好的主意。</p><p id="b7c5" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">查看目标值在我们的数据集中是如何分布的也很重要。我们可以用熊猫轻松做到这一点:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/d196a25ade31f2d4a4997890f4d97c85.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/0*M2mxNEwlhoCMCBaV.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd ox"> <em class="le"> sj </em> </strong> <em class="le">总例数直方图</em></p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/3bcaa8c118b8cd46601e097c7eaaff23.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/0*fw9qY3SoUcOfasNz.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><strong class="bd ox"> <em class="le">智商</em> </strong> <em class="le">总例数直方图</em></p></figure><p id="66b6" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">平均一周的案件数量相当低。只是偶尔(一年一次)，病例总数会跳到某个更高的值。在设计我们的模型时，我们需要记住这一点，因为即使我们设法找到了“跳跃”,我们也可能在很少或没有案例的几周内损失很多。</p><h2 id="b4b2" class="nu mk iq bd ml nv nw dn mp nx ny dp mt mg nz oa mv mh ob oc mx mi od oe mz iw bi translated">什么是 NDVI 值？</h2><p id="0d41" class="pw-post-body-paragraph lj lk iq lm b ln nb ka lp lq nc kd ls mg nd lv lw mh ne lz ma mi nf md me mf ij bi translated">最后我们要讨论的是本文中的一个<strong class="lm ja"> NDVI 指数</strong> ( <a class="ae lf" href="https://en.wikipedia.org/wiki/Normalized_difference_vegetation_index" rel="noopener ugc nofollow" target="_blank">归一化差异植被指数</a>)。这个指数是植被的指标。高负值对应于水，接近 0 的值代表岩石/沙子/雪，接近 1 的值代表热带森林。在给定的数据集中，每个城市有 4 个不同的 NDVI 值(每个值代表地图上的一个不同角落)。</p><p id="d775" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">即使整体 NDVI 指数对于理解我们正在处理的地形类型非常有用，如果我们需要为多个城市设计一个可能会派上用场的模型，但在这种情况下，我们只有两个城市的气候和在地图上的位置是已知的。我们不必训练我们的模型来确定我们正在处理哪种环境，相反，我们可以为每个城市训练两个单独的模型。</p><p id="ab70" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">我花了一些时间试图利用这些值(特别是在这种情况下插值很难，因为我们在这个过程中使用了大量的信息)。使用 NDVI 指数也可能产生误导，因为数值的变化不一定与植被过程的变化相对应。</p><p id="efd7" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated">如果你想看看这些城市，请参考<a class="ae lf" href="https://www.google.com/maps/place/San+Juan,+Puerto+Rico/@18.2818311,-67.176171,8.79z/data=!4m5!3m4!1s0x8c03686fe268196f:0xad6b7f0f5c935adc!8m2!3d18.4655394!4d-66.1057355" rel="noopener ugc nofollow" target="_blank">圣胡安，波多黎各</a>和<a class="ae lf" href="https://www.google.com/maps/place/Iquitos,+Peru/@-3.7626024,-73.5930914,9.54z/data=!4m5!3m4!1s0x91ea10b0e440c1cb:0x9210b8d7040a6692!8m2!3d-3.7436735!4d-73.2516326" rel="noopener ugc nofollow" target="_blank">伊基托斯，秘鲁</a>。</p><h1 id="315f" class="mj mk iq bd ml mm mn mo mp mq mr ms mt kf mu kg mv ki mw kj mx kl my km mz na bi translated">结论</h1><p id="f5c3" class="pw-post-body-paragraph lj lk iq lm b ln nb ka lp lq nc kd ls mg nd lv lw mh ne lz ma mi nf md me mf ij bi translated">此时，您应该知道我们的数据集是什么样子的。我们甚至没有开始设计第一个模型，但已经知道一些功能没有其他功能重要，其中一些只是重复相同的数据。如果您需要从整篇文章中吸取一点经验，那就是“首先尝试理解您的数据！”。</p><h1 id="ff9e" class="mj mk iq bd ml mm mn mo mp mq mr ms mt kf mu kg mv ki mw kj mx kl my km mz na bi translated">参考资料:</h1><ul class=""><li id="1307" class="ng nh iq lm b ln nb lq nc mg oz mh pa mi pb mf nl nm nn no bi translated">邓艾:预测疾病传播<a class="ae lf" href="https://www.drivendata.org/competitions/44/dengai-predicting-disease-spread/" rel="noopener ugc nofollow" target="_blank">https://www . driven data . org/competitions/44/邓艾-预测-疾病-传播/ </a></li></ul></div><div class="ab cl pc pd hu pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="ij ik il im in"><p id="b18a" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls mg lu lv lw mh ly lz ma mi mc md me mf ij bi translated"><em class="ll">最初发布于</em><a class="ae lf" href="https://erdem.pl/2020/07/deng-ai-how-to-aproach-data-science-competitions-eda" rel="noopener ugc nofollow" target="_blank"><em class="ll">https://erdem . pl</em></a><em class="ll">。</em></p></div></div>    
</body>
</html>