<html>
<head>
<title>Image Augmentation with skimage — Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用skimage增强图像— Python</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-augmentation-with-skimage-python-7f53f1b0eeb5?source=collection_archive---------22-----------------------#2020-05-01">https://towardsdatascience.com/image-augmentation-with-skimage-python-7f53f1b0eeb5?source=collection_archive---------22-----------------------#2020-05-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/03c58a8ff328a64573a159313c26d359.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nt4mTWGSK0PigrJNRCZ4eg.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">个人电脑:Flickr</p></figure><p id="6623" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">嘿伙计们，最近我在解决一个图像分类问题。但不幸的是，其中一个班级没有足够的样本。我在网上搜索，了解到一种叫做图像增强的技术。在这里，我分享了我对这种技术的理解，并分享了一些使用skimage的代码。你可以在底部找到jupyter笔记本。</p><h2 id="82f5" class="ld le it bd lf lg lh dn li lj lk dp ll kq lm ln lo ku lp lq lr ky ls lt lu lv bi translated">什么是图像增强？</h2><p id="133e" class="pw-post-body-paragraph kf kg it kh b ki lw kk kl km lx ko kp kq ly ks kt ku lz kw kx ky ma la lb lc im bi translated">影像增强是一种用于人为增加影像数据集大小的技术。这可以通过对图像进行随机变换来实现。</p><p id="ab65" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们知道，当深度学习模型能够看到更多数据时，它们能够很好地进行归纳。数据扩充可以创建现有图像的变体，这有助于更好地进行归纳。</p><p id="8738" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">但是你也需要小心。<strong class="kh iu">我们可以使用增强图像进行训练，但不能用于测试</strong>。因此，在应用任何增强之前，请将您的数据分成训练集和测试集。使用图像增强功能扩展您的训练数据。</p><p id="d597" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">图像增强主要应用于图像的两个领域</p><ol class=""><li id="7be7" class="mb mc it kh b ki kj km kn kq md ku me ky mf lc mg mh mi mj bi translated"><strong class="kh iu">位置增强</strong></li><li id="cda4" class="mb mc it kh b ki mk km ml kq mm ku mn ky mo lc mg mh mi mj bi translated"><strong class="kh iu">增色</strong></li></ol><h2 id="8434" class="ld le it bd lf lg lh dn li lj lk dp ll kq lm ln lo ku lp lq lr ky ls lt lu lv bi translated">什么是位置增强？</h2><p id="45e2" class="pw-post-body-paragraph kf kg it kh b ki lw kk kl km lx ko kp kq ly ks kt ku lz kw kx ky ma la lb lc im bi translated">位置增强很简单，我们在像素位置上应用不同的变换。</p><p id="e776" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">缩放、旋转、裁剪、翻转、填充、缩放、平移、剪切和其他仿射变换是位置增强的示例。让我们尝试应用其中的一些转换。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="cf00" class="ld le it mu b gy my mz l na nb">import numpy as np<br/>from skimage.io import imread, imsave<br/>import matplotlib.pyplot as plt<br/>from skimage import transform<br/>from skimage.transform import rotate, AffineTransform<br/>from skimage.util import random_noise<br/>from skimage.filters import gaussian<br/>from scipy import ndimage</span><span id="55aa" class="ld le it mu b gy nc mz l na nb"># load Image<br/>img = imread('./butterfly.jpg') / 255</span><span id="b4d7" class="ld le it mu b gy nc mz l na nb"># plot original Image<br/>plt.imshow(img)<br/>plt.show()</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/06ff2e5e06229775add93f442ae62039.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*H6SurLvbPrQSpk8dLDhSRA.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">原始图像PC: Flickr</p></figure><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="92ef" class="ld le it mu b gy my mz l na nb"># image rotation using skimage.transformation.rotate<br/>rotate30 = rotate(img, angle=30)<br/>rotate45 = rotate(img, angle=45)<br/>rotate60 = rotate(img, angle=60)<br/>rotate90 = rotate(img, angle=90)</span><span id="3bd4" class="ld le it mu b gy nc mz l na nb">fig = plt.figure(tight_layout='auto', figsize=(10, 7))</span><span id="eb48" class="ld le it mu b gy nc mz l na nb">fig.add_subplot(221)<br/>plt.title('Rotate 30')<br/>plt.imshow(rotate30)</span><span id="9da1" class="ld le it mu b gy nc mz l na nb">fig.add_subplot(222)<br/>plt.title('Rotate 45')<br/>plt.imshow(rotate45)</span><span id="f9e8" class="ld le it mu b gy nc mz l na nb">fig.add_subplot(223)<br/>plt.title('Rotate 60')<br/>plt.imshow(rotate60)</span><span id="7e02" class="ld le it mu b gy nc mz l na nb">fig.add_subplot(224)<br/>plt.title('Rotate 90')<br/>plt.imshow(rotate90)</span><span id="b849" class="ld le it mu b gy nc mz l na nb">plt.show()</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ne"><img src="../Images/b1f40b0760c8d2035cc5ae34ca159200.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F_Ap6AOh5K9kp8MlwboXlA.png"/></div></div></figure><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="0faf" class="ld le it mu b gy my mz l na nb"># image shearing using sklearn.transform.AffineTransform<br/># try out with differnt values of shear <br/>tf = AffineTransform(shear=-0.5)<br/>sheared = transform.warp(img, tf, order=1, preserve_range=True, mode='wrap')</span><span id="771f" class="ld le it mu b gy nc mz l na nb">sheared_fig = plot_side_by_side(img, sheared, 'Original', 'Sheared')</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi gj"><img src="../Images/19e388295d5e6abb0207790e263cf350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GUiFIPoAG4uTmq7UOFI7kQ.png"/></div></div></figure><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="3a25" class="ld le it mu b gy my mz l na nb"># Image rescaling with sklearn.transform.rescale<br/>rescaled = transform.rescale(img, 1.1)</span><span id="f05e" class="ld le it mu b gy nc mz l na nb">rescaled_fig = plot_side_by_side(img, rescaled, 'Original', 'Rescaled')<br/>plt.show()</span><span id="8efc" class="ld le it mu b gy nc mz l na nb">print('Original Shape: ',img.shape)<br/>print('Rescaled Shape: ',rescaled.shape)</span><span id="c34e" class="ld le it mu b gy nc mz l na nb">Output: <br/>Original Shape:  (684, 1024, 3)<br/>Rescaled Shape:  (752, 1126, 3)</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ne"><img src="../Images/f0f9bc9a77048fddcf2652b39461427f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GynANUYfuC9PxpRd6lcdgg.png"/></div></div></figure><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="a6be" class="ld le it mu b gy my mz l na nb"># flip up-down using np.flipud<br/>up_down = np.flipud(img)</span><span id="fdca" class="ld le it mu b gy nc mz l na nb">fig_updown = plot_side_by_side(img, up_down, 'Original', 'Up-Down')<br/>plt.show()</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/3a6dea133606c36077d347aff92bc65c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T6CAxc8WG3uYQlPFF9p3mg.png"/></div></div></figure><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="f3bc" class="ld le it mu b gy my mz l na nb"># flip up-down using np.flipud<br/>left_right = np.fliplr(img)</span><span id="6fac" class="ld le it mu b gy nc mz l na nb">fig_lr = plot_side_by_side(img, left_right, 'Original', 'Up-Right')<br/>plt.show()</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/3a6dea133606c36077d347aff92bc65c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T6CAxc8WG3uYQlPFF9p3mg.png"/></div></div></figure><p id="1ff0" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu">什么是增色？</strong></p><p id="4320" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">色彩增强是一种我们利用像素强度值的技术。</p><p id="5a48" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们通过<strong class="kh iu">调整亮度、对比度、饱和度来再现不同的图像，我们还可以给图像添加随机噪声。</strong></p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="9f59" class="ld le it mu b gy my mz l na nb"># Apply Random Noise to image using skimage.utils.random_noise<br/>noised = random_noise(img, var=0.1**2)</span><span id="2e4d" class="ld le it mu b gy nc mz l na nb">fig_noised = plot_side_by_side(img, noised, 'Original', 'Noised')<br/>plt.show()</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ng"><img src="../Images/def77fd51df15b328b4a7e34f02e595e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bicmj3GCW-T2HhM2UK5ksQ.png"/></div></div></figure><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="6016" class="ld le it mu b gy my mz l na nb"># Increasing the brighness of the Image<br/># Note: Here we add 100/255 since we scaled Intensity values of Image when loading (by dividing it 255)<br/>highB = img + (100/255)</span><span id="e065" class="ld le it mu b gy nc mz l na nb">fig_highB = plot_side_by_side(img, highB, 'Original', 'highB')<br/>plt.show()</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/021c6a817abd80f3e639f4ab844aa866.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kh57ZOjewRb-1OcajaOV2g.png"/></div></div></figure><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="6d0c" class="ld le it mu b gy my mz l na nb"># Increasing the contrast of the Image<br/># Note: Here we add 100/255 since we scaled Intensity values of Image when loading (by dividing it 255)<br/>highC = img * 1.5</span><span id="ae65" class="ld le it mu b gy nc mz l na nb">fig_highB = plot_side_by_side(img, highC, 'Original', 'highC')<br/>plt.show()</span></pre><figure class="mp mq mr ms gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/78ab87e93419dc3068a75308f9bb4ab4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6RZ_Oj0M3JpNb9LZpCkwuA.png"/></div></div></figure><p id="4f18" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">你有没有注意到一件事，我们已经从一个图像创建了11个不同的图像。请注意，我们仍然可以使用参数并创建更多的参数。</p><p id="3be2" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">当训练神经网络时，我们可以向图像加载器添加随机变换。还有其他高级技术，比如使用GAN进行数据扩充，我们可以在另一篇文章中看到。我希望你现在明白什么是图像增强。</p><p id="59ca" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">你可以在<a class="ae nj" href="https://github.com/Mathanraj-Sharma/sample-for-medium-article/blob/master/image-augmentation-skimage/image-augmentation.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/mathan Raj-Sharma/sample-for-medium-article/blob/master/image-augmentation-skimage/image-augmentation . ipynb</a>找到笔记本</p></div></div>    
</body>
</html>