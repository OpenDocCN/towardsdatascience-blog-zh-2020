<html>
<head>
<title>Stock Fundamental Analysis: EDA of SEC’s quarterly data summary</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">股票基本面分析:SEC 季度数据汇总的 EDA</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/stock-fundamental-analysis-eda-of-secs-quarterly-data-summary-455e62ff4817?source=collection_archive---------34-----------------------#2020-07-28">https://towardsdatascience.com/stock-fundamental-analysis-eda-of-secs-quarterly-data-summary-455e62ff4817?source=collection_archive---------34-----------------------#2020-07-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="88de" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">大熊猫 2020 SEC 申报的探索性数据分析</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/73f898aa412b8bc8cfbd23097ef53833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4AxfHzNFLt41Qq3r"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">马库斯·斯皮斯克在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="974e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">许多投资者认为基本面分析是他们战胜股市的秘密武器。您可以使用许多方法来执行它，但是它们有一个共同点。他们都需要关于公司财务报表的<strong class="lb iu">数据</strong>。</p><p id="7e26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">幸运的是，所有在美国股票市场交易的股票都必须向证券交易委员会提交季度报告。每季度 SEC 都会准备一份舒适的 CSV 文件，帮助所有投资者寻找投资机会。让我们来探讨如何从这些中获得有价值的见解。csv 文件。</p><p id="31b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我们将使用<a class="ae ky" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> python 的 pandas </a>库来解析 CSV 文件，我们将学习如何:</p><ul class=""><li id="cb19" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><a class="ae ky" href="#c382" rel="noopener ugc nofollow">探索季度转储</a>的<strong class="lb iu">结构</strong></li><li id="55ec" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#bc41" rel="noopener ugc nofollow">确定我们<strong class="lb iu">感兴趣的记录</strong>在</a></li><li id="05ae" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#bc41" rel="noopener ugc nofollow">了解有多少<strong class="lb iu">提交表格</strong>存在</a></li><li id="4477" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#f0e0" rel="noopener ugc nofollow">钻研<strong class="lb iu"> 10-K、8-K 或 40-F </strong>表格</a>的内容</li><li id="efd9" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#991a" rel="noopener ugc nofollow">分析是否每个公司每个季度只报告一个文件</a></li><li id="4e9b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><a class="ae ky" href="#cb50" rel="noopener ugc nofollow">检查提交文件是否符合 SEC 的截止日期</a></li></ul><p id="85fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将处理数据并:</p><ul class=""><li id="88f7" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">浏览<strong class="lb iu">秒转储</strong>中的文件</li><li id="970a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">查看这些文件的每一栏，并讨论与<strong class="lb iu">最相关的</strong></li><li id="5b1b" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">移除按关键列或多列分组的<strong class="lb iu">重复的</strong>数据</li><li id="c3cb" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用交互式 Plotly 图表可视化数据以支持我们的探索</li><li id="ac6e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">还有更多</li></ul><p id="68a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">和往常一样，你可以按照<a class="ae ky" href="https://github.com/vaclavdekanovsky/data-analysis-in-examples/blob/master/SEC%20Quarterly%20Data%20Dump/EDA_of_SEC_2020Q1_Filling_sub.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上分享的笔记本里的代码。</p><div class="mj mk gp gr ml mm"><a href="https://github.com/vaclavdekanovsky/data-analysis-in-examples/blob/master/SEC%20Quarterly%20Data%20Dump/EDA_of_SEC_2020Q1_Filling_sub.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">vaclavdekanovsky/数据分析示例</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">permalink dissolve GitHub 是超过 5000 万开发人员的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">github.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na ks mm"/></div></div></a></div><h1 id="c382" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">SEC 季度数据</h1><p id="7395" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">好像没什么问题。你只需从<a class="ae ky" href="https://www.sec.gov/dera/data/financial-statement-data-sets.html" rel="noopener ugc nofollow" target="_blank"> SEC 数据集页面</a>下载季度包，按降序排列财务报表中的数值，并挑选顶部的股票。现实并没有那么简单。让我们来看一看 2020 年第一季度所有 SEC 备案的 45.55MB 大 zip 文件。</p><p id="f9f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">每个季度的包包含 5 个文件。这里有一个<a class="ae ky" href="https://www.sec.gov/files/node/add/data_distribution/2020q1.zip" rel="noopener ugc nofollow" target="_blank"> 2020 Q1 </a>的例子:</p><ul class=""><li id="0428" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">readme.htm</strong>—描述文件的结构</li><li id="3371" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> sub.txt </strong> —关于提交文件的主要信息，包括公司标识符和文件类型</li><li id="4e19" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> num.txt </strong> —每份财务报表和其他文件的数字数据</li><li id="ba1a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> tag.txt </strong> —标准分类标签</li><li id="187e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> pre.txt </strong> —关于 num.txt 中的数据如何显示在在线演示文稿中的信息</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/825e557ea3c1e913d1fa65d1d7af0dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FhLexNiYrp9nDaQaPujC5g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">SEC 季度数据转储中的解压缩文件</p></figure><p id="7a13" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文将只讨论 submission master，因为它包含的信息对于一篇文章来说已经足够了。后续报道将更详细地研究这些数据。我们开始吧。</p><h2 id="99b4" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">2020Q1 提交文件</h2><p id="4207" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">2020 年第一季度，这些公司已经提交了<code class="fe ol om on oo b">13560</code>文件，sub.txt 收集了关于它们的 36 个专栏。</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="ec7c" class="nz nc it oo b gy ot ou l ov ow"># load the .csv file into pandas<br/>sub = pd.read_csv(os.path.join(folder,"sub.txt"), sep="\t", dtype={"cik":str})</span><span id="8e62" class="nz nc it oo b gy ox ou l ov ow"># explore number of rows and columns<br/>sub.shape</span><span id="6b51" class="nz nc it oo b gy ox ou l ov ow">[Out]: (13560, 36)</span></pre><p id="94b8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我总是从一个简单的函数开始，该函数检查数据框的每一列，检查空值的百分比，以及有多少唯一值出现在列中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">浏览 sub.txt 文件，查看每列包含的数据</p></figure><p id="bb8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我强调一下 SEC submission master 中的几个重要栏目。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/f7a4a70e4432fd5d2eac50f25a6e8593.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*feYgVvU89WO_sMDsBwTUaQ.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">pandas 中的快速文件概览示例</p></figure><ul class=""><li id="de6c" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu"> adsh </strong> — EDGAR 登录号唯一标识每份报告。该值<strong class="lb iu">在 sub.txt 中从不重复</strong>，例如 0001353283–20–000008 是<a class="ae ky" href="https://investors.splunk.com/sec-filings/sec-filing/10-k/0001353283-20-000008" rel="noopener ugc nofollow" target="_blank"> Splunk </a>的 10-K(年度备案)代码。</li><li id="d749" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu"> cik </strong> —中央索引键，识别每个 SEC 注册人的唯一键。例如，Splunk 的 0001353283。如您所见，adsh 的第一部分是 cik。</li><li id="0bfa" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">名称</strong> —提交季度财务数据的公司名称</li><li id="7991" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">表格</strong> —提交报告的类型</li></ul></div><div class="ab cl pb pc hx pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="im in io ip iq"><h1 id="bc41" class="nb nc it bd nd ne pi ng nh ni pj nk nl jz pk ka nn kc pl kd np kf pm kg nr ns bi translated">表格 s—提交给 SEC 的提交类型</h1><p id="38f4" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">根据分析，我们看到 2020 年第一季度提交的报告包含<strong class="lb iu"> 23 种独特的财务报告</strong>。投资者的主要兴趣在于涵盖上市公司年度业绩的<a class="ae ky" href="https://en.wikipedia.org/wiki/Form_10-K" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> 10-K </strong> </a>报告。因为这份报告预计每年只提交一次，所以显示公司财务季度变化的报告也很重要。</p><ul class=""><li id="2ae0" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><code class="fe ol om on oo b">10-K</code>美国公司年报</li><li id="da39" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe ol om on oo b">10-Q</code>季度报告和也许</li><li id="768a" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe ol om on oo b">20-F</code>外国公司的年度报告</li><li id="39d2" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><code class="fe ol om on oo b">40-F</code>外国公司的年度报告(加拿大)</li></ul><p id="2849" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看哪些表单在数据集中最常见。2020Q1 中表格类型的绘制将显示此图片:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用 Plotly 的低级 API 生成条形和饼形支线剧情</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pn"><img src="../Images/ea6b626f56224cabe9578b3d6b4e5119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jNU8PUfqucnMzZ9EPZnqng.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">各公司在 2020 年第 1 季度使用 Plotly 中的可视化功能报告了不同的提交类型</p></figure><p id="0734" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该数据集包含超过 7000 份<a class="ae ky" href="https://en.wikipedia.org/wiki/Form_8-K" rel="noopener ugc nofollow" target="_blank"> 8-K 报告</a>，通知重要事件，如协议、裁员、材料使用、股东权利修改、高级职位变更等(参见<a class="ae ky" href="https://www.sec.gov/fast-answers/answersform8khtm.html" rel="noopener ugc nofollow" target="_blank"> SEC 的指导方针</a>)。因为它们是最常见的，我们应该花些时间来探索它们。</p><h2 id="4abc" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">8k 唱片公司</h2><p id="1bb4" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">仅过滤<code class="fe ol om on oo b">8-K</code>表单，我们看到数据集包含这种类型的<code class="fe ol om on oo b">7502</code>记录。</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="b399" class="nz nc it oo b gy ot ou l ov ow">[In]:<br/># let's filter adsh, unique report identifier of the `8-K`s<br/>eight_k_filter = sub[sub["form"]=="8-K"][["name","adsh"]]<br/>eight_k_filter.shape</span><span id="77fa" class="nz nc it oo b gy ox ou l ov ow">[Out]: (7502, 2)</span></pre><p id="5ced" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们将包含详细财务数据的<code class="fe ol om on oo b">num.txt</code>合并，我们只能得到<code class="fe ol om on oo b">2894</code>行。有些记录似乎没有细节。</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="b441" class="nz nc it oo b gy ot ou l ov ow">[In]:<br/># load the num.txt file containing detailed data<br/>num = pd.read_csv(os.path.join(folder,"num.txt"),sep="\t")</span><span id="8194" class="nz nc it oo b gy ox ou l ov ow"># merge the file headers with the detailed data <br/>eight_k_nums = num.merge(eight_k_filter)<br/>eight_k_nums.shape</span><span id="5bca" class="nz nc it oo b gy ox ou l ov ow">[Out]: (2894, 10)</span></pre><p id="fb07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除此之外，这些记录仅涵盖<code class="fe ol om on oo b">20</code>份独特的报告(每份报告由<code class="fe ol om on oo b">adsh</code>号标识)。</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="18c7" class="nz nc it oo b gy ot ou l ov ow">[In]: len(eight_k_nums["adsh"].unique())<br/>[Out]: 20</span></pre><p id="c2ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是因为<code class="fe ol om on oo b">num.txt</code>只包含财务细节，而大多数<code class="fe ol om on oo b">8-K</code>用文字描述事件。只有像<a class="ae ky" href="https://sec.report/Document/0001262976-20-000015/" rel="noopener ugc nofollow" target="_blank">0001262976–20–000015</a>这样的罕见事件，这种特殊情况会声明额外的财务报表作为<code class="fe ol om on oo b">8-K</code>报告的一部分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi po"><img src="../Images/85b0e727d068976803dde6650d286c58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*om8fFzyVyzmBos2SNp4h-A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">num.txt 中的每一行正好包含财务报表中的一行</p></figure><blockquote class="pp pq pr"><p id="3b6f" class="kz la ps lb b lc ld ju le lf lg jx lh pt lj lk ll pu ln lo lp pv lr ls lt lu im bi translated"><code class="fe ol om on oo b">8-K</code>以纯文本描述事件，这不是转储的一部分。只有在包括财务报表的情况下才会出现详细信息，这种情况很少见</p></blockquote><h2 id="9d77" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">8-K 没有财务明细，其他表格有吗？</h2><p id="1c76" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">我们很少在<code class="fe ol om on oo b">num.txt</code>中看到任何与<code class="fe ol om on oo b">8-K</code>表单相关的数据。让我们用图表显示所有的表格类型，看看其他归档是否有所不同。我们将把<code class="fe ol om on oo b">num.txt</code>左连接到<code class="fe ol om on oo b">sub.txt</code>，并使用<code class="fe ol om on oo b">indicator</code>参数来查看哪个<code class="fe ol om on oo b">adsh</code>键出现在两者中。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pw"><img src="../Images/a960a96631377b2c93641901712d4ab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c-9EBJXZ7wFMQbw9NMf3_Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">只有 8-K 和 8-K/A 与财务详细信息无关</p></figure><p id="516c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们连接这两个文件时，我们可以看到只有<code class="fe ol om on oo b">8-K</code>和<code class="fe ol om on oo b">8-K/A</code>缺少财务细节，这很好，因为现在我们将研究年度<code class="fe ol om on oo b">10-K</code>和季度<code class="fe ol om on oo b">10-Q</code>报表</p></div><div class="ab cl pb pc hx pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="im in io ip iq"><h1 id="f0e0" class="nb nc it bd nd ne pi ng nh ni pj nk nl jz pk ka nn kc pl kd np kf pm kg nr ns bi translated">10K 和 10 Q</h1><p id="6a01" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">在 8-K 文件中，只有 20 份包含 SEC 季度数据转储中的额外信息，这并没有带来多少好处。让我们将注意力转移到更有趣的提交类型——年度报告和季度报告，然后我们将简要地看一下其他的形式。</p><p id="b0e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SEC 在 2020 年 4 月初发布了数据集，因此我们很有可能在记录中看到一些日期为 2019-12-31 的年度报告。如果我们只过滤<code class="fe ol om on oo b">10-K</code>和<code class="fe ol om on oo b">10-Q</code>，我们会发现 2020Q1 转储中的大部分数据都是年度报告。</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="0111" class="nz nc it oo b gy ot ou l ov ow"># filter only 10-K and 10-Q forms<br/>tens = sub[sub["form"].isin(["10-Q","10-K"])]</span><span id="9f33" class="nz nc it oo b gy ox ou l ov ow"># count how many forms of each type are in the dataset<br/>tens_counts = tens["form"].value_counts().reset_index().rename(columns={"index":"form type", "form": "count"})</span><span id="06e6" class="nz nc it oo b gy ox ou l ov ow"># using Plotly.Express create a bar chart<br/>fig = px.bar(tens_counts,<br/>            x="form type",<br/>            y="count",<br/>            barmode='group', <br/>            text="count", <br/>            title="Number of Annual and Quarterly forms in 2020Q1"<br/>           )<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi px"><img src="../Images/e1b524574e4dd1f49b6c678f777c779b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*truxVNV6tjOfJxq92BkhQA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Q1 的 SEC 数据转储主要包含年度报告</p></figure><p id="48c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是所有的公司都在一年的最后一天报告年度报表吗？</p><p id="acf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">财政年度</strong></p><p id="4373" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据集包含列<code class="fe ol om on oo b">fy</code>和<code class="fe ol om on oo b">fp</code>，它们表示财务报表所代表的财政年度和季度。我们绘制了最典型的图表。(有关代码，请参见完整的笔记本“财政年度”部分)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi py"><img src="../Images/f692e46a828573c50ef38d21101b134d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JP0fLxe3YvEvwX6kfhAyTw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">2019 年的年度报表是最典型的，但我们看到一些 Q1、Q2 甚至 2020 年第三季度的报表</p></figure><p id="f3f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它揭示了一个有趣的事实，即 2020 年第一季度的数据包含 2020 财年的第二季度和第三季度。我们怎么可能在第一季度就已经知道夏季和秋季的财务结果呢？</p><p id="8ec3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来看一下<a class="ae ky" href="https://www.sec.gov/ix?doc=/Archives/edgar/data/1439288/000143928820000090/rxn-20200331.htm" rel="noopener ugc nofollow" target="_blank">雷克斯诺德公司</a>的财务报表。</p><blockquote class="pp pq pr"><p id="2923" class="kz la ps lb b lc ld ju le lf lg jx lh pt lj lk ll pu ln lo lp pv lr ls lt lu im bi translated">本报告中 2020 财年之前(含)的财年是指相应日历年的 4 月 1 日至 3 月 31 日。例如，我们的 2020 财年，即 2020 财年，是指 2019 年 4 月 1 日至 2020 年 3 月 31 日这段时间。— Rexnord 公司</p></blockquote><p id="e0ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">财政年度不必与日历年度完全相同。有些公司在 1 月份结束了 2020 财年，大部分数据都进入了 2019 年。意味着一个公司的财政收入和其他公司没有可比性。</p><blockquote class="pp pq pr"><p id="b53a" class="kz la ps lb b lc ld ju le lf lg jx lh pt lj lk ll pu ln lo lp pv lr ls lt lu im bi translated">2020 财年将从 2 月 19 日持续到 2020 年 1 月</p></blockquote><h2 id="8181" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">2019 年营收如何确定？</h2><p id="d0a7" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">为了使价格与基本面特征一致，我们必须确定收入何时获得，现金何时流入。我们用什么变量来找出财务数据的真实时间框架？它是数据集中另一个名为<code class="fe ol om on oo b">period</code>的变量。再来看剧情。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pz"><img src="../Images/c5c72b0b7dde6846b9d9469f81d78304.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O8vpLhBRGUocLYZTXXSV_A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">period 变量表示表单财务周期的结束日期。</p></figure><p id="d246" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我使用了 Plotly 的高级 API，所谓的<strong class="lb iu"> Plotly.express </strong>。它在数据集方面非常强大，然而，它却在不同类型的支线剧情中挣扎，比如本例中的<a class="ae ky" href="https://plotly.com/python/bar-charts/" rel="noopener ugc nofollow" target="_blank">条形图</a>和<a class="ae ky" href="https://plotly.com/python/sunburst-charts/" rel="noopener ugc nofollow" target="_blank">旭日 char </a> t。</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="2bd0" class="nz nc it oo b gy ot ou l ov ow">fig=<strong class="oo iu">px.bar</strong>(tens_period_stats_1, # preproces statistics in a DataFrame<br/>           <strong class="oo iu">x="period"</strong>, # on x-axis display the period<br/>           <strong class="oo iu">y="records"</strong>, # on y-axis count of the records<br/>           <strong class="oo iu">color="form"</strong>, # split the bar chart by form (10-K, 10-Q)<br/>           # created groupped bar-chart (not stacked)<br/>          <strong class="oo iu"> barmode="group"</strong>, <br/>           <strong class="oo iu">text="records"</strong>, # label the bars with counts<br/>           # show only period from Sept-2019 to March-2020<br/>           # you can zoom-out the chart by double click<br/>           <strong class="oo iu">range_x=['2019-09-30','2020-03-31']</strong> <br/>           <br/>          )</span><span id="7bec" class="nz nc it oo b gy ox ou l ov ow"># plotly also struggles a bit with date-time variables,<br/># to make sure I see end of the months a specify that I really want ticks at these values<br/>fig.update_xaxes(<br/>    ticktext=tens_period_stats_1["period"].astype('str'),<br/>    tickvals=tens_period_stats_1["period"].astype('str')<br/>)</span><span id="f63c" class="nz nc it oo b gy ox ou l ov ow">fig.show()</span></pre><p id="9d2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想要显示类别的详细信息，旭日图是饼图的有用替代物。</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="d2c8" class="nz nc it oo b gy ot ou l ov ow">fig=<strong class="oo iu">px.sunburst</strong>(tens_period_stats_1,<br/>                path=["label","form"],<br/>                values="records")<br/>fig.show()</span></pre><p id="c712" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，大部分报表都落入了 2019 年底 2020 年初的预期期。还有一些来自 2019 年 9 月、10 月和 11 月的申请。为什么它们不属于 2019 年第四季度的前一次转储？</p><blockquote class="pp pq pr"><p id="fe4a" class="kz la ps lb b lc ld ju le lf lg jx lh pt lj lk ll pu ln lo lp pv lr ls lt lu im bi translated">注意:周期似乎在一个月的最后一天结束，但这是由 SEC 引入的舍入引起的。有些公司，如<a class="ae ky" href="https://www.deere.com/en/index.html" rel="noopener ugc nofollow" target="_blank"> John Deere </a>使用 52/53 周财年，其会计年度于 2019 年 11 月 3 日结束(<a class="ae ky" href="https://www.sec.gov/ix?doc=/Archives/edgar/data/315189/000155837019011614/de-20191103x10k.htm" rel="noopener ugc nofollow" target="_blank">参见 SEC 文件</a>)。然而，大多数公司都会在月底前提交报表。</p></blockquote><h2 id="cb50" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">处理这些报表需要多长时间？平均处理时间。</h2><p id="aaef" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">SEC 规定季度报表的最后期限为 40-45 天，年度报表的最后期限为 60-90 天(参见<a class="ae ky" href="https://www.sec.gov/fast-answers/answers-form10khtm.html" rel="noopener ugc nofollow" target="_blank"> SEC 指南</a>)。小公司 60 天，大公司 3 个月。这意味着在 1 月初发布 2019 年第四季度数据时，一些公司还没有上传 10 月、11 月甚至 9 月的数据。这就是为什么它们会出现在 2020 年的第一批垃圾中。</p><p id="e643" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看是否每个人都设法满足这些期限。我们将<code class="fe ol om on oo b">accepted</code>(SEC 接受数据时)的值与财政期结束时的<code class="fe ol om on oo b">period</code>进行比较。</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="e5eb" class="nz nc it oo b gy ot ou l ov ow"># we subtract `period` from `accepted` and turn into days<br/>tens_latest_period["delivery_time"] = (tens_latest_period["accepted"] - tens_latest_period["period"]).dt.days</span></pre><p id="93e9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们关注基本的统计参数:</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="c1ff" class="nz nc it oo b gy ot ou l ov ow">[In]: df["delivery_time"].agg(["mean","median","min","max"])<br/>[Out]: <br/>mean        78.115119<br/>median      58.000000<br/>min         11.000000<br/>max       2929.000000</span></pre><p id="1b7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最快的会计师在 11 天内提交报表，但平均值和中间值都接近 60 天。使用 Plotly 创建直方图的能力，我们可以检查通常的交付时间。</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="a9d9" class="nz nc it oo b gy ot ou l ov ow"><strong class="oo iu">px.histogram</strong>(df, <br/>             x="delivery_time", <br/>             color="form", <br/>             # maximum is 2929 days, but most of the values appear in the first fifth of the chart<br/>             range_x=[0,200])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qa"><img src="../Images/bb0b7a9f66891a840dea7ea2d31d4221.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mCRqC_leg_9MwGQGq-KzCg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们看到季度报告的交付时间大多长达 50 天，而年度报表的交付时间则长达 90 天</p></figure><p id="6d95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你注意到 90 天后提交的表格数量突然下降了吗？它承认，大多数公司都能在截止日期前提交，只有少数公司提交晚了。还可以有一些修正，我们将在下一节中探讨。</p><blockquote class="pp pq pr"><p id="3140" class="kz la ps lb b lc ld ju le lf lg jx lh pt lj lk ll pu ln lo lp pv lr ls lt lu im bi translated">典型的年度报告超过 50 页。见<a class="ae ky" href="https://www.sec.gov/ix?doc=/Archives/edgar/data/1018724/000101872420000004/amzn-20191231x10k.htm" rel="noopener ugc nofollow" target="_blank">亚马逊的 10k</a></p></blockquote><h2 id="991a" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">大家都只报一个 10-K 还是 10-Q？</h2><p id="d172" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">我们希望每家公司每个季度只报告一份报告，但是一个勤奋的分析师会仔细检查。我们根据公司的唯一<code class="fe ol om on oo b">cik</code>号分组，并标出有多少公司提交了一份申请，以及是否有一些公司提交了更多的申请。</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="e3fc" class="nz nc it oo b gy ot ou l ov ow"># Is 10-K/Q reported once by each company or more times? <br/>tens = sub[sub["form"].isin(["10-Q","10-K"])]</span><span id="2f35" class="nz nc it oo b gy ox ou l ov ow"># using `.value_counts().value_counts()` combo will tell us<br/># how many companies have 1, 2 or more records<br/>tens_counts_by_company = tens["cik"].value_counts().value_counts().sort_index().to_frame()</span></pre><p id="86e4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们可以直接从熊猫创建一个情节，如果你设置了</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="879b" class="nz nc it oo b gy ot ou l ov ow">pd.options.plotting.backend = "plotly"</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qb"><img src="../Images/fc3c448c87baf88583ac8d72d1e553ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r0IgXM-sAihytpZex9cjbA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">你可以使用不同的“后端”选项直接从熊猫绘图。查看 Matplotlib 如何仅显示输入的 xticks，同时 Plotly 填充 x 轴上缺失的值</p></figure><p id="d518" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们预计所有的<code class="fe ol om on oo b">cik</code>都只提交了一份报告，对于大多数公司来说，这是事实。然而，有一些张贴了更多的记录。</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="9bbb" class="nz nc it oo b gy ot ou l ov ow">[In]: tens["cik"].value_counts()</span><span id="e540" class="nz nc it oo b gy ox ou l ov ow">[Out]: <br/>1191334    33<br/>1165639    14<br/>1624985     8<br/>1481504     4<br/>...<br/>1517681     1</span></pre><p id="c2c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">公司为什么要这么做？这些错误是对以前提交的错误还是更正？他们是否将信息分成多个文件？我们不会知道，除非我们看看多次提交的例子。</p><p id="3094" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们过滤重复的行:</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="b257" class="nz nc it oo b gy ot ou l ov ow"># we filter the "cik"'s which appear more than once<br/>companies_reporting_more_tens = tens["cik"].value_counts()[tens["cik"].value_counts()&gt;1]</span><span id="34d4" class="nz nc it oo b gy ox ou l ov ow"># we look on few columns with relevant data<br/>columns_to_see = ["adsh","cik","name","period","fy","fp","filed", "form"]<br/>tens[tens["cik"].isin(companies_reporting_more_tens.index)].sort_values(by=["cik","period"])[columns_to_see]</span></pre><p id="8598" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码显示了 321 行，按<code class="fe ol om on oo b">cik</code>和<code class="fe ol om on oo b">period</code>排序，简单看一下就会告诉我们，实际上，大多数公司都提交了一些历史更正。拥有<code class="fe ol om on oo b">cik=1191334</code>的公司似乎报告了包含 24 份季度报告和 9 份年度报告的全部历史，但大多数只发送了一两份额外的文件。</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="3e1a" class="nz nc it oo b gy ot ou l ov ow"># preprocess the data<br/>df = tens[["form","cik"]].groupby(["cik","form"]).size().to_frame("submitted 10-K/Q")\<br/>.reset_index().groupby(["form","submitted 10-K/Q"]).size().to_frame("company count").reset_index()</span><span id="8951" class="nz nc it oo b gy ox ou l ov ow"># Create a bar chart with two series, one for 10-K and one for 10-Q<br/>fig = px.bar(df[df["submitted 10-K/Q"]&gt;1], <br/>            x="submitted 10-K/Q", <br/>            y="company count",<br/>            barmode="group", <br/>            color="form", <br/>            title="Number of companies having more than 1 submission in 2020Q1")</span><span id="b497" class="nz nc it oo b gy ox ou l ov ow"># update the tickers to each each one starting from 1 with step of 1<br/>fig.update_layout(<br/>    xaxis_type='category'<br/>)<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qc"><img src="../Images/b2801f1a482479bb98df11bcb0d34c35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PusfLn-4pMEzu2a_AQJUyw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">设置 xaxis_type='category '将强制 Plotly 以发送的方式显示值，并且不使用从 1 到 len(df)的线性值。不幸的是，一个范围接一个范围，所以所有的 10-K 在左边，剩下的 10-Q 在右边。</p></figure><p id="e71c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现场检查没有发现任何公司会在同一时期发送两种填充物。我们能证明他们真的不存在吗？</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="329a" class="nz nc it oo b gy ot ou l ov ow">[In]: tens.groupby(["cik","period"]).size().max()<br/>[Out]: 2</span></pre><p id="7d9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对分组<code class="fe ol om on oo b">cik&amp;period</code>组合的检查发现，有一些公司将同一时期的数据上传给 SEC 两次。</p><p id="acd6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们通过使用<code class="fe ol om on oo b">groupby</code>作为过滤器来观察它们:</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="c3fd" class="nz nc it oo b gy ot ou l ov ow">[In]: tens.groupby(["cik","period"]).size()[tens.groupby(["cik","period"]).size()&gt;1]</span><span id="6f68" class="nz nc it oo b gy ox ou l ov ow">[Out]:<br/>cik      period    <br/>1191334  2013-09-30    2<br/>1635748  2019-06-30    2</span></pre><p id="12e2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">详细的观察表明，它们在<code class="fe ol om on oo b">filed</code>、<code class="fe ol om on oo b">accepted</code>或两者上有所不同。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oy oz l"/></div></figure><h2 id="1560" class="nz nc it bd nd oa ob dn nh oc od dp nl li oe of nn lm og oh np lq oi oj nr ok bi translated">删除重复项</h2><p id="7a5c" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">重复的线是每个数据集的祸根。它们导致许多问题，因为它们扭曲了度量标准，污染了机器学习模型，并且随着每个连接而成倍增加。一旦我们发现它们，我们应该立即决定如何去除它们。</p><p id="f3f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的情况下，我们将只接受后来填写的表格(更高的<code class="fe ol om on oo b">filed</code>)，如果所有记录都相同，我们将采用较新的<code class="fe ol om on oo b">accepted</code>。熊猫的<code class="fe ol om on oo b">.cumcount()</code>功能将帮助我们完成任务。这相当于 SQL 的<code class="fe ol om on oo b">ROW_COUNT()</code>,我们将只选取每条记录的第一次出现。详细步骤如下:</p><ul class=""><li id="0db9" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">按决定性字段<code class="fe ol om on oo b">filed</code>和<code class="fe ol om on oo b">accepted</code>对数据进行排序</li><li id="2337" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">按分区列分组— <code class="fe ol om on oo b">cik</code>和<code class="fe ol om on oo b">period</code></li><li id="6cb1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">使用<code class="fe ol om on oo b">.cumcount()</code>对行 0，1，2 进行排序...</li><li id="d460" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">仅过滤具有该值的行<code class="fe ol om on oo b">==0</code></li></ul><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="f2fc" class="nz nc it oo b gy ot ou l ov ow"># for all the `10-K` and `10-Q` we reduce the number of rows from 5212 to 5210<br/>tens = tens.loc[tens.sort_values(by=["filed","accepted"],ascending=False).groupby(["cik","period"]).cumcount()==0]</span></pre><p id="8b63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<a class="ae ky" href="https://github.com/vaclavdekanovsky/data-analysis-in-examples/blob/master/SEC%20Quarterly%20Data%20Dump/EDA_of_SEC_2020Q1_Filling_sub.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上查看完整的代码和详细的分解。</p><p id="5f59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似的算法将帮助我们仅获得 2020 年第一季度提供的最新提交:</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="85f7" class="nz nc it oo b gy ot ou l ov ow">tens_latest_period = tens.loc[tens.sort_values(by="period", ascending=False).groupby("cik").cumcount()==0]</span></pre><h1 id="38cb" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">外国公司</h1><p id="997e" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated"><code class="fe ol om on oo b">10-K</code>和<code class="fe ol om on oo b">Q</code>对所有在股票市场交易的美国公司都是强制性的。但 SEC 收集从美国市场受益的外国企业的信息。他们必须按照<code class="fe ol om on oo b">20-F</code>和<code class="fe ol om on oo b">40-F</code>表格提交财务报表。它们有什么不同？</p><p id="404d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们使用列<code class="fe ol om on oo b">countryba</code>和<code class="fe ol om on oo b">cityba</code>来保存注册人的业务地址信息。我们把这些信息转换成地址。</p><div class="mj mk gp gr ml mm"><a rel="noopener follow" target="_blank" href="/pythons-geocoding-convert-a-list-of-addresses-into-a-map-f522ef513fd6"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">Python 的地理编码-将地址列表转换为地图</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">如何使用地理定位 API 接收绘制客户、工厂、车队地图所需的数据…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">towardsdatascience.com</p></div></div><div class="mv l"><div class="qd l mx my mz mv na ks mm"/></div></div></a></div><p id="f220" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有了这些地方的纬度和经度，我们就可以在世界地图上显示出来。Plotly 的<code class="fe ol om on oo b">.scatter_geo()</code>是我们需要的图表类型:</p><pre class="kj kk kl km gt op oo oq or aw os bi"><span id="cf79" class="nz nc it oo b gy ot ou l ov ow"># set up the chart from the df dataFrame<br/>fig = px.scatter_geo(twenties, <br/>                     # longitude is taken from the df["lon"] columns and latitude from df["lat"]<br/>                     lon="lon", <br/>                     lat="lat", <br/>                     # choose the map chart's projection<br/>                     projection="natural earth",<br/>                     # columns which is in bold in the pop up<br/>                     hover_name = "name",<br/>                     # format of the popup not to display these columns' data<br/>                     hover_data = {"name":False,<br/>                                   "lon": False,<br/>                                   "lat": False,<br/>                                   "countryba": True<br/>                                     },<br/>                     color="form",<br/>                     size_max=20<br/>                     )<br/># fit the map to surround the points<br/>fig.update_geos(fitbounds="locations", showcountries = True)</span><span id="260b" class="nz nc it oo b gy ox ou l ov ow">fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi qe"><img src="../Images/a551ec742e774128d3ea6fa60c1a4192.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6vOyw0pn_rj2kpNUvy8mdA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">40-F 专用于在加拿大注册的公司，而 20-F 则用于其他外国公司</p></figure></div><div class="ab cl pb pc hx pd" role="separator"><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg ph"/><span class="pe bw bk pf pg"/></div><div class="im in io ip iq"><h1 id="b719" class="nb nc it bd nd ne pi ng nh ni pj nk nl jz pk ka nn kc pl kd np kf pm kg nr ns bi translated">自己试试</h1><p id="f852" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">你想自己试试吗？没有比这更简单的了。SEC 最近公布了<a class="ae ky" href="https://www.sec.gov/files/dera/data/financial-statement-data-sets/2020q2.zip" rel="noopener ugc nofollow" target="_blank"> 2020Q2 数据</a>。下载它们，解压缩并运行笔记本中的脚本，看看表单的结构在第二季度是否发生了变化。</p><div class="mj mk gp gr ml mm"><a href="https://github.com/vaclavdekanovsky/data-analysis-in-examples/blob/master/SEC%20Quarterly%20Data%20Dump/EDA_of_SEC_2020Q1_Filling_sub.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">vaclavdekanovsky/数据分析示例</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">permalink dissolve GitHub 是超过 5000 万开发人员的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">github.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na ks mm"/></div></div></a></div><h1 id="962a" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">结论</h1><p id="e298" class="pw-post-body-paragraph kz la it lb b lc nt ju le lf nu jx lh li nv lk ll lm nw lo lp lq nx ls lt lu im bi translated">在本文中，我们回顾了 SEC 季度数据转储中提供的提交类型。我们已经看到，最常见的<code class="fe ol om on oo b">8-K</code>在转储中没有附加信息。因此，我们重点关注年度和季度报表，并探索这些报表在提交后的 180 天内出现在数据集中。大多数公司在一个季度报告一份报表，但我们已经看到一些历史文件和一些副本。</p><p id="a5fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过删除重复项，我们为分析的下一步——探索财务状况——准备了数据集。但是对于本文来说，这些信息已经足够了，我们将在下次讨论。</p><p id="45ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您喜欢这篇介绍，请随意查看我的其他文章:</p><div class="mj mk gp gr ml mm"><a rel="noopener follow" target="_blank" href="/dealing-with-extra-white-spaces-while-reading-csv-in-pandas-67b0c2b71e6a"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">阅读熊猫 CSV 时处理多余的空格</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">为什么我们关心空白？内置熊猫功能，自定义处理。创建 1M 测试数据和…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">towardsdatascience.com</p></div></div><div class="mv l"><div class="qf l mx my mz mv na ks mm"/></div></div></a></div><div class="mj mk gp gr ml mm"><a rel="noopener follow" target="_blank" href="/unzip-update-and-zip-again-xmls-in-a-folder-7d57f9710ddb"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd iu gy z fp mr fr fs ms fu fw is bi translated">在一个文件夹中解压缩、更新和再压缩 XML</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">使用 python 自动化办公程序</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">towardsdatascience.com</p></div></div><div class="mv l"><div class="qg l mx my mz mv na ks mm"/></div></div></a></div></div></div>    
</body>
</html>