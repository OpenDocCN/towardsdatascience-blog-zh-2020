<html>
<head>
<title>A 3-Minute Review of Rejection Sampling: Simulate Any Distribution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对剔除抽样的 3 分钟回顾:模拟任何分布</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simulate-any-distribution-with-rejection-sampling-ebe4e66cc068?source=collection_archive---------24-----------------------#2020-07-30">https://towardsdatascience.com/simulate-any-distribution-with-rejection-sampling-ebe4e66cc068?source=collection_archive---------24-----------------------#2020-07-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="8bec" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">3 分钟回顾</h2><div class=""/><div class=""><h2 id="95f0" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">一个简短的概率和算法教程，值得你花时间</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/12fc657dfb914bdd11e4badc0109c214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fQktN1vnTVBZ-_z-"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae lh" href="https://unsplash.com/@mluotio83?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Miikka Luotio </a>的照片</p></figure><p id="f2f2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当您想要某个概率分布的一些值时，比如说正态分布，您可以简单地在 R 中调用<code class="fe me mf mg mh b">rnorm</code>，或者在 Python 中调用<code class="fe me mf mg mh b">numpy.random.normal</code>。但是你有没有想过他们是怎么做到的？潜在的想法非常简单却非常强大。在这篇文章中，我将直观地解释它，而不会用任何数学符号来让你厌烦。在 3 分钟内，您将能够实现您自己的定制分发模拟器。我们开始吧！</p><h1 id="ba47" class="mi mj it bd mk ml mm mn mo mp mq mr ms ki mt kj mu kl mv km mw ko mx kp my mz bi translated">蒙特卡罗模拟拒绝抽样</h1><p id="fca5" class="pw-post-body-paragraph li lj it lk b ll na kd ln lo nb kg lq lr nc lt lu lv nd lx ly lz ne mb mc md im bi translated">任何计算机系统都应该有一个<a class="ae lh" href="https://en.wikipedia.org/wiki/Pseudorandom_number_generator#Non-uniform_generators" rel="noopener ugc nofollow" target="_blank">伪随机数发生器</a>，它能够给你(伪)均匀分布的随机数。这是我们的起点。核心问题是:<strong class="lk jd">给定均匀随机值，我们如何生成不同的分布？</strong></p><p id="7d7f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">考虑一个投掷飞镖的游戏，在这个游戏中，你向一块长方形的木板投掷飞镖。玩之前，你在上面画一个钟形曲线(高斯概率密度函数)。假设你的飞镖均匀地落在整个区域。自然，会有一些飞镖落在曲线上方，一些落在曲线下方。在足够多的投掷次数后，它应该看起来像下图的下半部分。如果我们去掉曲线上方的红色部分，为蓝色部分做一个直方图，它应该看起来像上半部分的那个。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/32044077770ffdef4f5d179ce2980df1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*mfMa_35OZjLc1YBZSHXKzw.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">这是我在 P5.js 中的实现，可以随意去<a class="ae lh" href="https://logancyang.com/simulations/montecarlo/montecarlo.html" rel="noopener ugc nofollow" target="_blank">我的网站</a>通过调优迭代次数和改变分布自己试试！</p></figure><p id="ebb3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这张照片展示了 2000 次投掷。当你扔的次数多了很多，上半部分的黄色轮廓会越来越接近底部的钟形曲线。</p><p id="0a78" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这个游戏被称为<a class="ae lh" href="https://en.wikipedia.org/wiki/Rejection_sampling" rel="noopener ugc nofollow" target="_blank">拒绝抽样</a>算法，或接受-拒绝法，每次投掷飞镖都是一次<a class="ae lh" href="https://en.wikipedia.org/wiki/Monte_Carlo_method" rel="noopener ugc nofollow" target="_blank">蒙特卡洛模拟</a>。</p><p id="9a63" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这里到底发生了什么？你可以把<em class="ng"> x </em>的值想成一个均匀随机数<code class="fe me mf mg mh b">sampleX</code>，把<em class="ng"> y </em>的值想成另一个，<code class="fe me mf mg mh b">sampleY</code>。那么一掷镖的位置就是<code class="fe me mf mg mh b">(sampleX, sampleY)</code>。算法是这样的:</p><ol class=""><li id="bfe0" class="nh ni it lk b ll lm lo lp lr nj lv nk lz nl md nm nn no np bi translated">首先，你画一个<code class="fe me mf mg mh b">sampleX</code>，然后你立即画一个<code class="fe me mf mg mh b">sampleY</code>。(扔飞镖)</li><li id="7939" class="nh ni it lk b ll nq lo nr lr ns lv nt lz nu md nm nn no np bi translated">您将<code class="fe me mf mg mh b">sampleX</code>插入到您想要的分布的 PDF 中，在本例中是高斯 PDF，并在对应于<code class="fe me mf mg mh b">sampleX</code>的紫色曲线<code class="fe me mf mg mh b">targetY</code>上获得一个值。</li><li id="a9d0" class="nh ni it lk b ll nq lo nr lr ns lv nt lz nu md nm nn no np bi translated">你把<code class="fe me mf mg mh b">sampleY</code>比作<code class="fe me mf mg mh b">targetY</code>。如果<code class="fe me mf mg mh b">sampleY &lt; targetY</code>，表示我们有一个“命中”，即飞镖落在曲线下方。这个随机数<code class="fe me mf mg mh b">sampleX</code>被“接受”并作为高斯样本返回。如果<code class="fe me mf mg mh b">sampleY &gt;= targetY</code>，这意味着我们有一个“错过”，然后<code class="fe me mf mg mh b">sampleX</code>被拒绝，并且没有成功的高斯样本从该试验中抽取。继续下一个试验。</li><li id="b131" class="nh ni it lk b ll nq lo nr lr ns lv nt lz nu md nm nn no np bi translated">一旦你有了足够的试验，所有被接受的<code class="fe me mf mg mh b">sampleX</code>形成了一个正态分布的随机值列表。</li></ol><p id="d849" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">就是这个！这就是我们用均匀随机数得到高斯随机数的方法。</p><p id="a45d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">事实上，您可以将其更改为任何您想要的目标分布！在板上画一个疯狂的曲线，开始投掷。如果低于曲线，接受；如果高于曲线，拒绝。就这么简单。曲线甚至不需要积分到 1，就相当于缩放这条曲线可以得到的 PDF。</p><p id="cbc8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我用 P5.js 在浏览器中创建了一个<a class="ae lh" href="https://logancyang.com/simulations/montecarlo/montecarlo.html" rel="noopener ugc nofollow" target="_blank">可视化。您可以通过调整迭代次数和改变分布类型来随意尝试。</a></p><h1 id="f4d6" class="mi mj it bd mk ml mm mn mo mp mq mr ms ki mt kj mu kl mv km mw ko mx kp my mz bi translated">摘要</h1><p id="57ab" class="pw-post-body-paragraph li lj it lk b ll na kd ln lo nb kg lq lr nc lt lu lv nd lx ly lz ne mb mc md im bi translated">拒绝采样是一个非常简单的想法，非常简单，你只需不到 5 分钟就能学会，而且<em class="ng">没有任何公式</em>！尽管它很简单，但对于计算统计学和任何依赖于概率的技术来说都是至关重要的。<code class="fe me mf mg mh b">rnorm</code>和<code class="fe me mf mg mh b">numpy.random.normal</code>使用的实际算法被称为<a class="ae lh" href="https://en.wikipedia.org/wiki/Ziggurat_algorithm" rel="noopener ugc nofollow" target="_blank">金字形神算法</a>。这是在拒绝抽样和蒙特卡罗方法的保护伞下。有兴趣可以看看。希望你喜欢这个非常短的教程，并欣赏这个算法的小宝石的美丽！</p><h1 id="1572" class="mi mj it bd mk ml mm mn mo mp mq mr ms ki mt kj mu kl mv km mw ko mx kp my mz bi translated">参考</h1><ul class=""><li id="1465" class="nh ni it lk b ll na lo nb lr nv lv nw lz nx md ny nn no np bi translated"><a class="ae lh" href="https://en.wikipedia.org/wiki/Rejection_sampling" rel="noopener ugc nofollow" target="_blank">拒绝采样</a></li><li id="ad06" class="nh ni it lk b ll nq lo nr lr ns lv nt lz nu md ny nn no np bi translated"><a class="ae lh" href="https://youtu.be/DfziDXHYoik" rel="noopener ugc nofollow" target="_blank">代码的本质视频</a>作者丹·希夫曼</li></ul><p id="afc1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><em class="ng">在</em> <a class="ae lh" href="https://medium.com/@loganyang" rel="noopener"> <em class="ng">中</em> </a> <em class="ng">上看我的其他帖子，或者在</em> <a class="ae lh" href="https://twitter.com/logancyang" rel="noopener ugc nofollow" target="_blank"> <em class="ng">上关注我的</em> </a> <em class="ng">。</em></p></div></div>    
</body>
</html>