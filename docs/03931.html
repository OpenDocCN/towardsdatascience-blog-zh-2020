<html>
<head>
<title>Grid Searching for Good Wine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">寻找好酒的格子</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/grid-searching-for-good-wine-43cdfeadee6c?source=collection_archive---------44-----------------------#2020-04-11">https://towardsdatascience.com/grid-searching-for-good-wine-43cdfeadee6c?source=collection_archive---------44-----------------------#2020-04-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="d5d1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在大多数ML项目中，微调一个人的模型是至关重要的一步。即使有很好的数据清理和特征工程，选择不当的超参数也会阻止用户从其模型中获得最佳性能。在过去的项目中，我发现自己循环通过参数并打印出训练错误来挑选最好的，但我最近读了安德烈亚斯·c·müller&amp;萨拉·圭多的<em class="ko">用Python </em>介绍机器学习。在本书中，作者解释并演示了sklearn自动搜索ML模型的给定超参数列表，然后挑选最佳组合的能力。我发现这个功能非常有用，所以我写了这篇文章，作为传递Müller和圭多的教导的一个快速演示。</p><p id="4e61" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将使用来自Kaggle的<a class="ae kp" href="https://www.kaggle.com/uciml/red-wine-quality-cortez-et-al-2009" rel="noopener ugc nofollow" target="_blank">红酒质量数据集</a>，它的可用性得分为8.8分，不算太大(1599行)。观察最上面的几行可以看出，这个数据集包含了红酒的各个方面，如pH值、残糖克数、酒精含量等...以及从1到10的葡萄酒总体质量分数。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi kq"><img src="../Images/2dbb1a648ae1af027186e5fa44f8b20a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IYRpZJUBo4HHkDKcCvQyUw.png"/></div></div></figure><p id="1808" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">由于我肯定不是品酒师，可能无法区分7分的葡萄酒和8分的葡萄酒，我将训练一个支持向量机来确定葡萄酒是否好喝。对我来说，“好”是指质量得分为7或更高的任何东西，所以我必须在数据中添加该特性。添加之后，我可以将数据拆分为独立变量和因变量，并创建我的培训/测试拆分。</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="8338" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">既然数据的形式正确，我们就转向网格搜索。我做的第一件事是创建一个超参数列表，供网格搜索迭代。因为我使用的是支持向量分类器，所以我测试了C和gamma的不同值，它们分别是正则化参数和核系数。我输入模型、我的参数网格和交叉验证折叠5来创建GridSearchCV()对象，然后像sklearn中的任何其他模型一样用。fit()方法。</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="bb04" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在模型已经拟合好了，是时候查看结果了。我可以使用。网格搜索对象的cv_results_ attribute，然后将结果透视到热图中。这清楚地表明，该数据的最佳组合是归一化参数的高值和核系数的低值。</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="lc ld l"/></div></figure><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi le"><img src="../Images/20baba976e1f48f54bb8d4e9489259cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*wGWTup9r4cVytB5MOnsjdQ.png"/></div></figure><p id="9bab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">网格搜索对象还将最佳拟合参数存储在。最佳参数属性。顺便提一下，Müller和圭多解释说，sklearn总是将来自训练数据的项目存储在以下划线结尾的属性中(例如:“。best_params_ "，"cv_results_ ")。我们可以使用kwargs将这些参数直接插入到我们希望拟合测试数据的模型中，如下文使用<strong class="js iu"><em class="ko">SVC(* * grid _ search . best _ params _)</em></strong>所演示的。使用网格搜索中找到的最佳参数，该模型在测试集上获得100%的分类准确率。</p><figure class="kr ks kt ku gt kv"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="0cae" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">希望这是sklearn网格搜索能力的一个有用的演示。要了解更多关于这方面的信息和大量其他的ML主题，我推荐阅读<em class="ko">Python机器学习入门。</em>感谢阅读，完整的脚本/数据可在<a class="ae kp" href="https://github.com/eonofrey/wine_grid_search" rel="noopener ugc nofollow" target="_blank">这里</a>找到。要获得所有中型文章的完整访问权限，请点击<a class="ae kp" href="https://eonofrey.medium.com/membership" rel="noopener">此处</a>！</p></div></div>    
</body>
</html>