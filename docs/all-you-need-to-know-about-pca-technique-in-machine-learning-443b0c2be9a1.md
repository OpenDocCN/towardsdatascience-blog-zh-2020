# æœºå™¨å­¦ä¹ ä¸­çš„ PCA æŠ€æœ¯

> åŸæ–‡ï¼š<https://towardsdatascience.com/all-you-need-to-know-about-pca-technique-in-machine-learning-443b0c2be9a1?source=collection_archive---------29----------------------->

## æœ€å¹¿æ³›ä½¿ç”¨çš„é™ç»´æŠ€æœ¯çš„è¯¦ç»†è§£é‡Š

![](img/c0b42ebc60d8f01a3f1529fac5125efa.png)

ç‹å å±±åœ¨ Unsplash ä¸Šæ‹æ‘„çš„ç…§ç‰‡

*æœ‰æ²¡æœ‰äººé‡åˆ°è¿‡è¿™æ ·çš„æƒ…å†µï¼Œåœ¨å»ºç«‹æ¨¡å‹æ—¶å¤„ç†å¤§é‡çš„å˜é‡ï¼Œå¹¶æ‹…å¿ƒå‡†ç¡®æ€§å’Œæ•ˆç‡ä½ä¸‹ï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œä¸»æˆåˆ†åˆ†æ(PCA)å°†ä¼šæ¥æ•‘ä½ * âœŒï¸

**ä»€ä¹ˆæ˜¯ä¸»æˆåˆ†åˆ†æï¼Ÿ**

å®ƒæ˜¯æœ€å¹¿æ³›ä½¿ç”¨çš„é™ç»´æŠ€æœ¯ä¹‹ä¸€ï¼Œé€šè¿‡è¯†åˆ«ç›¸å…³æ€§å’Œæ¨¡å¼å°†è¾ƒå¤§çš„æ•°æ®é›†è½¬æ¢ä¸ºè¾ƒå°çš„æ•°æ®é›†ï¼ŒåŒæ—¶ä¿ç•™å¤§éƒ¨åˆ†æœ‰ä»·å€¼çš„ä¿¡æ¯ã€‚

**å¯¹è®¤è¯åæ´»åŠ¨çš„éœ€æ±‚ï¼Ÿ**

å®ƒç”¨äºå…‹æœæ•°æ®é›†ä¸­çš„è¦ç´ å†—ä½™ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æ—¨åœ¨è·å–æœ‰ä»·å€¼çš„ä¿¡æ¯ï¼Œè§£é‡Šå¯¼è‡´æä¾›æœ€ä½³å‡†ç¡®æ€§çš„é«˜å·®å¼‚ã€‚å®ƒä½¿å¾—æ•°æ®å¯è§†åŒ–æ˜“äºå¤„ç†ã€‚å®ƒé™ä½äº†æ¨¡å‹çš„å¤æ‚æ€§ï¼Œæé«˜äº†è®¡ç®—æ•ˆç‡ã€‚

åœ¨é€‰æ‹©ä¸»æˆåˆ†æ•°é‡çš„æ¦‚å¿µèƒŒåæœ‰å¾ˆå¤šæ··ä¹±ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æµè§ˆæ‰€æœ‰æ­¥éª¤ï¼Œå¹¶ç†è§£ç¡®å®šéœ€è¦ä¸ºæ•°æ®é›†é€‰æ‹©çš„ç»„ä»¶æ•°é‡çš„é€»è¾‘ã€‚

æˆ‘ä»¬å°†ä½¿ç”¨åŒ…å« 8 ä¸ªå˜é‡çš„æŠ«è¨æ•°æ®é›†ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æ•°æ®é›†[ã€‚](https://github.com/SushmithaPulagam/PCA)

ä¸‹é¢æ˜¯æŠ«è¨æ•°æ®é›†çš„å‰å‡ æ¡è®°å½•ã€‚â€œå“ç‰Œâ€ä¸ºç›®æ ‡å˜é‡ï¼Œå…¶ä½™ä¸ºè‡ªå˜é‡ã€‚

![](img/322682761da2aae8a8d0e4944c6760bf.png)

æŠ«è¨æ•°æ®é›†çš„å‰å‡ æ¡è®°å½•

åˆ é™¤â€œå“ç‰Œâ€åˆ—ï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦å¯¹ç‹¬ç«‹å˜é‡è¿›è¡Œ PCAã€‚

![](img/df5c3ae8ca327fbc5c0b28c630316de0.png)

å»é™¤â€œå“ç‰Œâ€å˜é‡å

è®©æˆ‘ä»¬æ¥çœ‹çœ‹è¿™äº›æ­¥éª¤

ğŸ‘‰**ç¬¬ä¸€æ­¥:æ•°æ®æ ‡å‡†åŒ–**

åœ¨è¿›è¡Œ PCA ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ã€‚

*æ‰§è¡Œæ ‡å‡†åŒ–æ˜¯è‡³å…³é‡è¦çš„ä¸€æ­¥ï¼Œå› ä¸ºåŸå§‹å˜é‡å¯èƒ½æœ‰ä¸åŒçš„æ ‡åº¦ã€‚æˆ‘ä»¬éœ€è¦å°†å®ƒä»¬å¸¦åˆ°ç›¸ä¼¼çš„èŒƒå›´ï¼Œä»¥è·å¾—åˆç†çš„åæ–¹å·®åˆ†æã€‚*

ä» sklearn åº“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¥æ ‡å‡†åŒ–æ•°æ®ã€‚

```
from sklearn.preprocessing import StandardScaler
df_std = StandardScaler().fit_transform(df)
df_std
```

![](img/42868a2a555902386f196c64aab2c08e.png)

åº”ç”¨æ ‡å‡†åŒ–åçš„è¾“å‡º

ğŸ‘‰**æ­¥éª¤ 2:ç”¨æ ‡å‡†åŒ–æ•°æ®è®¡ç®—åæ–¹å·®çŸ©é˜µ**

*åæ–¹å·®çŸ©é˜µè¡¨ç¤ºä¸¤ä¸ªå˜é‡ä¹‹é—´çš„ç›¸å…³æ€§ã€‚è¿™æœ‰åŠ©äºæˆ‘ä»¬ç†è§£å“ªä¸¤ä¸ªå˜é‡ä¸¥é‡ä¾èµ–äºå½¼æ­¤ï¼Œå¹¶æ•æ‰æ•°æ®é›†ä¸­çš„åå·®å’Œå†—ä½™ã€‚*

å¦‚æœçŸ©é˜µä¸­çš„æ¡ç›®å¸¦æœ‰è´Ÿå·ï¼Œåˆ™æ„å‘³ç€å®ƒä»¬å½¼æ­¤æˆé—´æ¥æ¯”ä¾‹ã€‚å¦‚æœç¬¦å·æ˜¯æ­£çš„ï¼Œæ„å‘³ç€å®ƒä»¬æˆæ­£æ¯”ã€‚

```
df_cov_matrix = np.cov(df_std.T)
df_cov_matrix
```

![](img/8805c153815b7e51516c56f1c2fb02bd.png)

åæ–¹å·®çŸ©é˜µçš„è¾“å‡º

ğŸ‘‰**æ­¥éª¤ 3:è®¡ç®—åæ–¹å·®çŸ©é˜µä¸Šçš„ç‰¹å¾å‘é‡å’Œç‰¹å¾å€¼**

è¿™ä¸¤ä¸ªä»£æ•°å…¬å¼æ€»æ˜¯æˆå¯¹è®¡ç®—ï¼Œä¹Ÿç§°ä¸ºç‰¹å¾åˆ†è§£ï¼Œé€šè¿‡å‹ç¼©æ•°æ®æ¥å‡å°‘ç»´æ•°ç©ºé—´ã€‚ä¸»æˆåˆ†åˆ†æçš„æ ¸å¿ƒå°±æ˜¯å»ºç«‹åœ¨è¿™äº›å€¼ä¹‹ä¸Šçš„ã€‚

æ¯ä¸ªç‰¹å¾å‘é‡å°†å…·æœ‰ç›¸åº”çš„ç‰¹å¾å€¼ï¼Œå¹¶ä¸”æ‰€æœ‰ç‰¹å¾å€¼çš„æ€»å’Œè¡¨ç¤ºæ•´ä¸ªæ•°æ®é›†ä¸­çš„æ€»ä½“æ–¹å·®ã€‚è®¡ç®—ç‰¹å¾å€¼éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒè§£é‡Šäº†æ•°æ®é›†ä¸­æœ€å¤§æ–¹å·®çš„ä½ç½®ã€‚

è¦äº†è§£æ›´å¤šå…³äºç‰¹å¾å‘é‡å’Œç‰¹å¾å€¼çš„ä¿¡æ¯ï¼Œè¯·è®¿é—®æ­¤[ [é“¾æ¥](https://medium.com/fintechexplained/what-are-eigenvalues-and-eigenvectors-a-must-know-concept-for-machine-learning-80d0fd330e47#:~:text=Eigenvectors%20and%20eigenvalues%20revolve%20around,to%20represent%20a%20large%20matrix.)

```
eig_vals, eig_vecs = np.linalg.eig(df_cov_matrix)print(â€˜Eigenvectors \n%sâ€™ %eig_vecs)
print(â€˜\nEigenvalues \n%sâ€™ %eig_vals)
```

![](img/e5fa1b0858ddf1fd378abad49dd47c67.png)

ç‰¹å¾å‘é‡å’Œç‰¹å¾å€¼çš„è¾“å‡º

ğŸ‘‰**æ­¥éª¤ 4:æŒ‰é™åºæ’åˆ—ç‰¹å¾å€¼åˆ—è¡¨**

å®Œæˆç‰¹å¾åˆ†è§£åï¼Œæˆ‘ä»¬éœ€è¦æŒ‰é™åºæ’åˆ—ç‰¹å¾å€¼ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå€¼æ˜¯æœ€é‡è¦çš„ï¼Œä»è€Œå½¢æˆæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä¸»æˆåˆ†ã€‚

```
eig_pairs = [(np.abs(eig_vals[i]), eig_vecs[:,i]) for i in range(len(eig_vals))]print(â€˜Eigenvalues in descending order:â€™)
for i in eig_pairs:
 print(i[0])
```

![](img/4316af62dbc4f4d4a6d178301c498302.png)

æ’åºç‰¹å¾å€¼çš„è¾“å‡º

ğŸ‘‰**ç¬¬äº”æ­¥:é€‰æ‹©ä¸»æˆåˆ†æ•°**

> ç¬¬ä¸€ä¸ªä¸»æˆåˆ†å°†æ•è·åŸå§‹å˜é‡çš„å¤§éƒ¨åˆ†æ–¹å·®ï¼Œç¬¬äºŒä¸ªä¸»æˆåˆ†æ•è·ç¬¬äºŒé«˜çš„æ–¹å·®ï¼Œä¾æ­¤ç±»æ¨â€¦

```
total = sum(eig_vals)
var_exp = [(i / tot)*100 for i in sorted(eig_vals, reverse=True)]
cum_var_exp = np.cumsum(var_exp)
print(â€œVariance captured by each component is \nâ€,var_exp)
print(â€œCumulative variance captured as we travel with each component \nâ€,cum_var_exp)
```

![](img/7f2ba3351e19507620ef8c37e7a558f6.png)

æ¯ä¸ªç»„ä»¶æ•è·çš„å·®å¼‚çš„è¾“å‡º

ä»ä¸Šé¢å¯ä»¥çœ‹å‡ºï¼Œç¬¬ä¸€ä¸ªä¸»æˆåˆ†(PC1)è·å¾—äº†æ€»æ–¹å·®çš„ 60%,å…¶æ¬¡æ˜¯ PC2ï¼Œæ–¹å·®ä¸º 32.7%ã€‚

![](img/4d5003494905124fbee93d8783b0e0ad.png)

ä»ç´¯ç§¯å·®å¼‚æ¥çœ‹ï¼Œæ€»ä½“ä¸Š 92%æ˜¯ç”± 2 ä¸ªç»„ä»¶æ•è·çš„ï¼Œ98%çš„å·®å¼‚æ˜¯ç”±å‰ 3 ä¸ªç»„ä»¶è§£é‡Šçš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å†³å®šæ•°æ®é›†çš„ä¸»æˆåˆ†æ•°ä¸º 3ã€‚

æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹é¢çš„ scree å›¾ç”¨è§£é‡Šçš„æ–¹å·®æ¯”ç‡çš„ç´¯ç§¯å’Œæ¥å½¢è±¡åŒ–åŒæ ·çš„æƒ…å†µã€‚

```
pca = PCA().fit(df_std)
plt.plot(np.cumsum(pca.explained_variance_ratio_))
plt.xlabel(â€˜No of componentsâ€™)
plt.ylabel(â€˜Cumulative explained varianceâ€™)
plt.show()
```

![](img/78d8acfa8c5a8c87cecc86f2c2f8459e.png)

ç¡®å®šç»„ä»¶æ•°é‡çš„ Scree å›¾

ğŸ‘‰**æ­¥éª¤ 6:åˆ›å»ºä¸»æˆåˆ†**

é€šè¿‡ä¸Šé¢æåˆ°çš„æ‰€æœ‰æ­¥éª¤ï¼Œè€ƒè™‘åˆ°æœ€å¤§æ–¹å·®ï¼Œæˆ‘ä»¬å·²ç»ç¡®å®šæ•°æ®é›†æ‰€éœ€çš„ç»„ä»¶æ•°é‡ä¸º 3ã€‚

```
from sklearn.decomposition import PCA
pca = PCA(n_components = 3)
pcs = pca.fit_transform(df_std)
df_new = pd.DataFrame(data=pcs, columns={â€˜PC1â€™,â€™PC2',â€™PC3'})
df_new[â€˜targetâ€™] = df1[â€˜Brandâ€™] 
df_new.head()
```

![](img/698ad49fd44cd2df5b6d150c712c7d62.png)

ç”¨ä¸»æˆåˆ†åˆ›å»ºçš„æ–°æ•°æ®é›†çš„æ•°æ®æ¡†æ¶

PCA åªèƒ½å¯¹æ•°å€¼å˜é‡è¿›è¡Œã€‚å¦‚æœæ‚¨æœ‰åˆ†ç±»æ•°æ®ï¼Œé‚£ä¹ˆæ‚¨éœ€è¦åœ¨åº”ç”¨ PCA ä¹‹å‰å°†å…¶è½¬æ¢ä¸ºæ•°å­—ç‰¹å¾ã€‚å¦å¤–ï¼Œè¯·æ³¨æ„ï¼Œè¿™äº›ä¸»æˆåˆ†æ˜¯åŸå§‹æ•°æ®é›†çš„çº¿æ€§ç»„åˆã€‚è¿™äº›ç»„ä»¶ä¸åƒåŸå§‹ç‰¹å¾é‚£æ ·å¯è¯»å’Œå¯è§£é‡Šã€‚

**æ€»ç»“**

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»ç»å†äº†æ‰€æœ‰çš„æ­¥éª¤ï¼Œä»¥äº†è§£å¦‚ä½•é€‰æ‹©æ•°æ®é›†æ‰€éœ€çš„ä¸»æˆåˆ†çš„æ•°é‡ã€‚åº”è¯¥è®°ä½ï¼Œéœ€è¦æå…¶å°å¿ƒåœ°é€‰æ‹©ç»„ä»¶ï¼Œå¦åˆ™å¯èƒ½ä¼šä¸¢å¤±ä¿¡æ¯ã€‚

å¦‚æœæ‚¨è¦å¤„ç†æ•°æ®é›†ä¸­çš„å¤šé‡å…±çº¿æ€§é—®é¢˜ï¼Œå¯ä»¥åº”ç”¨è¿™ç§ PCA æŠ€æœ¯ï¼Œè¿™å°†æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„å¸®åŠ©ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºå¤šé‡å…±çº¿æ€§çš„çŸ¥è¯†ï¼Œè¯·è®¿é—®æˆ‘ä»¥å‰çš„åšå®¢[ [è¿™é‡Œ](/how-to-detect-and-deal-with-multicollinearity-9e02b18695f1?source=friends_link&sk=693ee8780b09f4a19a0f2d6ac33533a7)

ä½ å¯ä»¥ä»æˆ‘çš„ Github [ [è¿™é‡Œ](https://github.com/SushmithaPulagam/PCA) ]è·å¾—æ•°æ®é›†å’Œå®Œæ•´çš„ä»£ç 

æ„Ÿè°¢é˜…è¯»ï¼Œå¿«ä¹å­¦ä¹ ï¼ğŸ™‚