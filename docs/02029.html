<html>
<head>
<title>What it takes to be correlated</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关联需要什么</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/what-it-takes-to-be-correlated-ce41ad0d8d7f?source=collection_archive---------9-----------------------#2020-02-26">https://towardsdatascience.com/what-it-takes-to-be-correlated-ce41ad0d8d7f?source=collection_archive---------9-----------------------#2020-02-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4e77" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以及在我们的分析中如何解释它</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b29a3cd4f7439ff055a1fef35cd8c4a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sXUki9RzQyYtOyId"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">舒伊布·阿卜尔哈萨尼在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="e21d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相关性(确切地说是统计学上的相关性)是对两个变量之间相互关系的一种度量，不管它们是不是因果关系。这种程度的测量可以在任何类型的数据上进行(连续的和连续的，分类的和分类的，连续的和分类的)。尽管相关性说明了它是如何衡量相互关系的，但相关性度量的存在并不能为因果关系提供有力的证据。这意味着相关性并不意味着因果关系。那么相关性是如何有用的呢？</p><p id="0691" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相关性是有用的，因为它可以表明实践中可以利用的预测关系。例如，一天中温度越高，卖冰淇淋的次数越多。这也可能意味着因果关系，因为当天气较热时，人们倾向于购买冰淇淋，而当天气较冷时。然而，就像我之前陈述的那样；大多数时候，相关性并不意味着任何因果关系。</p><p id="c328" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们进入相关性和它如何计算之前，让我展示一下协方差的概念。</p><h1 id="13ec" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">协方差</h1><p id="35a0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在统计学中，协方差是变量X和y之间关联的度量，确切地说，它度量的是变量的线性关系趋势。这里我将展示协方差是如何计算的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/4fed4055edf65b98e2b73255dea5cb3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*2CyKltKZwDQW6WjKgH1bQg.png"/></div></figure><p id="f85a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">协方差的计算方法是将变量的每个成员减去其平均值(以数据为中心)。将这些居中的分数相乘，以测量一个变量的增加或减少是否与另一个变量相关联。最后，计算这些居中分数的期望值(<em class="mt"> E </em>)作为关联的汇总。另一项中的期望值本身就是平均值或均值(<em class="mt"> μ) </em>。</p><p id="e94c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">协方差的问题在于，X和Y可以取各自范围内的任何值。这模糊了解释过程，并且使得相互之间的协方差比较变得不可能。例如，<em class="mt"> Cov </em> ( <em class="mt"> X </em>，<em class="mt"> Y </em> ) = 7和<em class="mt"> Cov </em> ( <em class="mt"> A </em>，<em class="mt"> B </em> ) = 5会告诉我们这些对分别是正相关的，但是很难判断<em class="mt"> X </em>和<em class="mt"> Y </em>之间的关系是否强于<em class="mt"> A </em>和<em class="mt"> B这就是相关性变得有用的地方-通过数据中的可变性测量来标准化协方差，它将产生具有直观解释和一致尺度的产品。</em></p><p id="4cf2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们完成第一个关联。</p><h1 id="6301" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">皮尔逊相关系数</h1><p id="b8f4" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">皮尔逊相关是数据分析过程中最常用的相关之一。皮尔逊相关度量变量连续X和变量连续Y之间的线性关系，其值介于1和-1之间。换句话说，皮尔逊相关系数通过一条线来衡量两个变量之间的关系。</p><p id="3e68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看看皮尔逊相关系数是如何计算的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/4f9c1fea2d32bd24df84b1f3f3b621db.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*TNMjd7dXz4HtxUDvjbYI4Q.png"/></div></figure><p id="4f4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你注意到，分数方程的上边(分子)类似于我们之前讨论的协方差方程。这意味着我们也可以将皮尔逊相关系数表述如下。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/390cdaf266295c2282f2d442e5ea7b4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*ci8gTwU2UOZGBADIUeHEow.png"/></div></figure><p id="a1c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的等式表明协方差除以X标准偏差(σX)和Y标准偏差(σY)的乘积。标准差的除法过程是为了标准化我们的数据，并确保相关值落在1比1的范围内。这简化了我们的相关性解释。那么，我们如何解释皮尔逊相关性呢？</p><p id="c396" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当相关系数<strong class="lb iu">接近值1 </strong>时，意味着变量X和y之间存在<strong class="lb iu">正关系</strong>，正关系表示一个变量的增加与另一个变量的增加相关。另一方面，<strong class="lb iu">相关系数越接近-1 </strong>就意味着存在一种<strong class="lb iu">负相关关系</strong>，即一个变量的增加会导致另一个变量的减少。<strong class="lb iu">如果<em class="mt"> X </em>和<em class="mt"> Y </em>是独立的</strong>，那么<strong class="lb iu">相关系数接近于0 </strong>，尽管即使两个变量之间有很强的关系，皮尔逊相关也可能很小。</p><p id="4032" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你从上面的解释中意识到，实际上皮尔逊相关系数和回归线的斜率之间有明显的联系。首先，让我展示一个带有回归线的散点图的例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/9e5035ce1dc9664d61127657341fa303.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*YcTqO1D2N2X6Ah19p9Uglw.png"/></div></figure><p id="4ac3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上图中，回归线是最佳的，因为它使所有点到回归线的距离最小。由于这一特性，<em class="mt"> Y </em>和<em class="mt"> X </em>的回归线的斜率在数学上等价于<em class="mt"> X </em>和<em class="mt"> Y、</em>之间的相关性，通过它们的标准偏差来标准化。</p><p id="f1c0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">换句话说，皮尔逊相关系数反映了两个变量之间的关联性和可变性。这一特性也意味着皮尔逊相关易受异常值的影响。</p><p id="150b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这种与直线斜率的关系说明了为什么皮尔逊相关性描述了线性关系，以及为什么相关性在预测建模中很重要。</p><p id="d191" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们想测量变量之间的非线性关系呢？接下来我会展示一些其他的测量方法来描述这种非线性关系。</p><h1 id="5af8" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">斯皮尔曼等级相关</h1><p id="fbee" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">与皮尔逊相关系数不同，斯皮尔曼等级相关测量两个变量之间的单调关系(严格地增加或减少，而不是两者都增加)，并通过值的等级顺序来测量。尽管Spearman秩相关法仍然适用于离散的顺序变量，但仍然可以测量连续变量X和连续变量Y之间的相关性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/1a3016e2262408187e99fb3edd78f58e.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*bvT-ZFf4duhEAkp1OhN2Bw.png"/></div></figure><p id="6981" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们根据数据等级而不是分数来计算Spearman等级相关性。这意味着我们计算数据秩和秩标准差之间的协方差。如果所有的秩是唯一的或者秩之间没有联系，我们可以将等式简化如下。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi my"><img src="../Images/6172329bdd8bb6123f31d96d07594a03.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*sVjqJKZSNTQ61JDuFRo4sg.png"/></div></figure><p id="345a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中n是观察次数，d是秩差。这个公式只有在没有领带的情况下才严格使用。</p><p id="4773" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Spearman等级相关可以类似地解释为Pearson相关系数，因为它们的值在-1到1之间。<strong class="lb iu">得分越接近1 </strong>意味着变量之间存在<strong class="lb iu">正单调关系</strong>(数据不断增加)，反之亦然。如果<strong class="lb iu">变量X和变量Y独立</strong>，则值将为<strong class="lb iu">等于0 </strong>。</p><p id="161a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们谈论等级时，等级到底是什么？下面是我从维基百科上获得的一个排名过程的例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/8b462a8c34df1ae1bedb08514e6960ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*wMBkK9WfKDeOnHscaioQ7Q.png"/></div></figure><p id="09e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">更容易理解排名的方法是，我们将数据从最小到最大排序，并根据数据顺序分配排名。1是最小的等级，这意味着等级1被分配给相应列的最小值。为什么是各自的专栏？从上表中我们可以看出，我们根据各自的列对数据进行排序，因为我们想知道列X和列Y的排序之间的协方差；我们给每一列分配等级。准确的说，我们要的是每行之间的排名差。</p><p id="d20d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">皮尔逊和斯皮尔曼相关性之间的差异在下图中得到最好的说明。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/e25382f2684a819149205d44d0cfa68f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*ZIke1VTIJbXBb0HchVp1Yw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">皮尔逊相关与斯皮尔曼等级相关</p></figure><p id="2070" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们的上述数据显示了完美的正单调关系(数据总是增加)和非线性关系；我们的Spearman相关等于1。在这种情况下，皮尔逊关系较弱，但仍然显示出很强的相关性，因为数据之间存在部分线性关系。</p><h1 id="7869" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">肯德尔τ秩相关</h1><p id="7192" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">另一种测量变量之间非线性关系的方法是应用肯德尔的Tau等级相关性。Kendall Tau等级相关系数衡量给予同一组对象的两组等级之间的相似程度。然而，与Spearman系数不同，Kendall Tau只测量方向一致性，而不测量等级差异。因此，这个系数更适合于离散数据。下面是我们如何测量肯德尔τ相关性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/d04fb5c30226d6d8b8641a67a17a33de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*emJMzjQ1aAuCpdcpzGH5KQ.png"/></div></div></figure><p id="c605" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中和谐对是等级一致的值对((<em class="mt"> x </em> 1，<em class="mt"> y </em> 1)，(<em class="mt"> x </em> 2，<em class="mt">y</em>2)):<em class="mt">x</em>1&lt;<em class="mt">x</em>2和<em class="mt"> y </em> 1 &lt; <em class="mt"> y </em> 2或<em class="mt"> x </em> 1 &gt; <em class="mt"> x </em> 2和不和谐对是不遵循这些的等级对</p><p id="e8c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从上面的等式中，我们可以看出，测量值取决于物体对的反转次数。为了评估它们，每个等级顺序由所有对象对的集合来表示(例如，[a，b]和[b，a]是表示对象a和b的两对)。让我们使用一个样本数据集来衡量我们的相关性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/ec48e6486854839db80dccf1659fcc29.png" data-original-src="https://miro.medium.com/v2/resize:fit:268/format:webp/1*y-ybyIgU0pKUBHKP1ZjTzQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据集示例</p></figure><p id="78fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面是一个样本数据集，在各自的列中有排名。我们需要根据之前的规则来计算一致对和不一致对的数量。(1，2)和(2，7)是1 &lt;2 and 2&lt;7 while (1,2) and (4,1) are discordant pairs because 1 &lt; 4 but 2 &gt; 1的整合对。如果是我们的数据集示例，对应对是:</p><ul class=""><li id="7057" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">(1，2)和(2，7)</li><li id="866b" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">(1，2)和(3，5)</li></ul><p id="48d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不和谐的一对是:</p><ul class=""><li id="28b3" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">(1，2)和(4，1)</li><li id="3e75" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">(2，7)和(3，5)</li><li id="55af" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">(2，7)和(4，1)</li><li id="210e" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">(3.5)和(4.1)</li></ul><p id="dab0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这意味着我们有2个一致对和4个不一致对。使用前面的等式2–4/(4(4–1)/2)将得到-0.33。</p><p id="5cf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Kendall Tau将取1到+1之间的值，其中<strong class="lb iu">值越接近1 </strong>表示当<strong class="lb iu">一个等级顺序与另一个等级顺序完全相反</strong>和<strong class="lb iu">时，值越接近+1表示两个等级顺序相同</strong>。Kendall Tau相关性也可以解释为处于相同顺序(一致)的对象的概率与处于不同顺序(不一致)的观察之间的概率差。</p><p id="9b04" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">肯德尔τ适用于我们想知道变量的顺序是否相似的情况；尤其是如果我们的数据是离散的。然而，还有其他方法来测量离散变量相关性(<a class="nr ns ep" href="https://medium.com/u/43218078e688?source=post_page-----ce41ad0d8d7f--------------------------------" rel="noopener" target="_blank"> Shaked Zychlinski </a>已经写了一篇关于它的很好的文章<a class="ae ky" rel="noopener" target="_blank" href="/the-search-for-categorical-correlation-a1cf7f1888c9">这里</a>但是我想更详细地阐述它)</p><h1 id="5337" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">克莱姆的V型</strong></h1><p id="f0df" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">克莱姆V是两个离散变量之间关联的度量。测量基于皮尔逊卡方统计，输出范围在0到1之间；<strong class="lb iu">值越接近0 </strong>表示两个变量之间的<strong class="lb iu">关联越少</strong>而<strong class="lb iu"> 1 </strong>表示两个变量之间的<strong class="lb iu">关联越强</strong>。没有负(-)值作为输出，因为不存在负关联。克莱姆的V计算是用下面的公式计算的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/3f5b7149eeec29f42e343d29b3d053a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*oHGM3STsaQiQIm_twPGH3g.png"/></div></figure><p id="3a38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">其中，χ是卡方统计量，n是观察值的数量，k是列数，r是行数。</p><p id="a0db" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为Cramer的V过高估计了关联强度(卡方统计值倾向于随着行和列的数量之间的差异的增加而增加)，我们需要纠正偏差。这是通过下面的等式完成的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/f9263d8422f9e61f91a7251ea0db7cdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*NuqttAjuwaTAB2EZw_5tjw.png"/></div></figure><p id="a543" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在哪里</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/af18246972650285fac27cbc86d06969.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*iTf2clD8X4wQs9ty_xdGDw.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/4f874dc0321d23beca3efc28cf5420ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*OTNc_fy2MbBTpu2XfL0l9g.png"/></div></figure><h1 id="87ce" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">数据集示例</h1><p id="3ea9" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">幸运的是，python中的scipy和pandas模块为我们提供了一种计算所有数字的简单方法。在我的例子中，我将使用seaborn的tips样本数据集。</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="63d6" class="oc lw it ny b gy od oe l of og">#Importing the important module<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns</span><span id="5d16" class="oc lw it ny b gy oh oe l of og">#Load the dataset<br/>tips = sns.load_dataset('tips')</span><span id="1637" class="oc lw it ny b gy oh oe l of og">#Creating new category based on the tip feature (0: tip below 3 and 1 tip equal or more than 3)</span><span id="76a0" class="oc lw it ny b gy oh oe l of og">tips['tip_category'] = tips['tip'].apply(lambda x: 1 if x&gt;3 else 0)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/8faa4ade938ab52a1519a21a3d8bf585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*TiVm3q1zUxwXo5irUbNvVw.png"/></div></figure><p id="78fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们想知道total_bill和tip特性之间的关系。用熊猫的方法。corr，我们可以在几秒钟内测量我们的相关性。熊猫。corr方法只提供3种相关度量；皮尔森，斯皮尔曼和肯德尔。</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="ee59" class="oc lw it ny b gy od oe l of og">#Using the .corr method from pandas, default is Pearson Corellation <br/>tips[['total_bill', 'tip']].corr()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/1ebd67bfd70ad8a882d09e60fca8a1ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*778JQXBTqBeQ3vZTAXV-NQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">total_bill与小费变量之间的皮尔逊相关系数</p></figure><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="bf30" class="oc lw it ny b gy od oe l of og">tips['total_bill', 'tip']].corr('spearman')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/d1a401def21c272cc6c2e81e587e97d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*kDSAs2yzUwQIu8eODKOKiw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">total_bill与小费变量之间的Spearman等级相关性</p></figure><p id="8fea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们需要相关结果作为统计假设测试，我们可以使用scipy模块中的函数来计算。</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="0a73" class="oc lw it ny b gy od oe l of og">from scipy.stats import pearsonr, spearmanr</span><span id="593e" class="oc lw it ny b gy oh oe l of og">pearsonr(tips['total_bill'], tips['tip'])<br/>#Output: (0.6757341092113647, 6.6924706468630016e-34)</span><span id="f191" class="oc lw it ny b gy oh oe l of og">spearmanr(tips['total_bill'], tips['tip'])<br/>#Output: SpearmanrResult(correlation=0.6789681219001009, pvalue=2.501158440923619e-34)</span><span id="b341" class="oc lw it ny b gy oh oe l of og">#Where the first number represent the Correlation Coefficient and #the second number represent the p-value.</span></pre><p id="8cff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在相关分析中，我们可以检验变量之间是否存在关系的统计假设。正式的说法是:</p><ul class=""><li id="1818" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">H0:变量X和变量Y之间没有统计学上的显著关系</li><li id="fcd4" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">H1:变量X和变量Y之间有一种统计上的显著关系</li></ul><p id="0155" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就像任何其他假设检验一样，我们基于p值评估我们的假设。通常，我们将alpha水平设置为95%，这意味着如果p值低于0.05，那么我们拒绝H0，接受H1。在这种情况下，H0是相似的，如果我们说变量X和变量Y是独立的。</p><p id="e929" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以用类似于上面的方法计算肯德尔τ相关性。如前所述，Kendall Tau相关性更适合应用于离散变量，为此，我举一个大小和tip_category之间关系的例子。</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="11ea" class="oc lw it ny b gy od oe l of og">tips[['size', 'tip_category']].corr('kendall')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/20994e480d05ea1fa5ee1e5ced19be78.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*leF0j_aTW8LwtO4oY3kqtg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Kendall Tau尺寸和小费之间的相关性_类别</p></figure><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="020e" class="oc lw it ny b gy od oe l of og">from scipy.stats import kendalltau</span><span id="4e43" class="oc lw it ny b gy oh oe l of og">kendalltau(tips['size'], tips['tip_category'])<br/>#Output: KendalltauResult(correlation=0.3528363722264162, pvalue=6.456364135002584e-09)</span></pre><p id="a294" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">计算克莱姆的V需要一个额外的模块，校正偏差版本需要我们自己定义。对于未校正的版本，我们可以使用researchpy模块来帮助计算我们的Cramer's V。让我们将其应用于性别和大小变量之间的关系。</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="2caa" class="oc lw it ny b gy od oe l of og">pip install researchpy #only if you never have this module before</span><span id="e399" class="oc lw it ny b gy oh oe l of og">from researchpy import crosstab<br/>cross, res = crosstab(tips['sex'], tips['size'], test = 'chi-square')<br/>res</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/f141eaa0599711c07c4df52a3c404468.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*D4eGX4-9z4okIlQr_n4ldg.png"/></div></figure><p id="f23c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用researchpy，我们可以获得关于统计测试和相关性分析的信息。尽管如我之前所说，它还没有修正，这意味着它高估了关联强度。出于这个原因，我会使用之前由<a class="nr ns ep" href="https://medium.com/u/43218078e688?source=post_page-----ce41ad0d8d7f--------------------------------" rel="noopener" target="_blank"> Shaked Zychlinski </a>定义的偏差校正的Cramer V函数。</p><pre class="kj kk kl km gt nx ny nz oa aw ob bi"><span id="2c77" class="oc lw it ny b gy od oe l of og">def cramers_v(x, y):<br/>    import scipy.stats as ss<br/>    confusion_matrix = pd.crosstab(x,y)<br/>    chi2 = ss.chi2_contingency(confusion_matrix)[0]<br/>    n = confusion_matrix.sum().sum()<br/>    phi2 = chi2/n<br/>    r,k = confusion_matrix.shape<br/>    phi2corr = max(0, phi2-((k-1)*(r-1))/(n-1))<br/>    rcorr = r-((r-1)**2)/(n-1)<br/>    kcorr = k-((k-1)**2)/(n-1)<br/>    return np.sqrt(phi2corr/min((kcorr-1),(rcorr-1)))</span><span id="0d2e" class="oc lw it ny b gy oh oe l of og">cramers_v(tips['sex'], tips['size'])<br/>#output: 0.058202656344848294</span></pre><p id="e59a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们在上面看到的，修正和未修正版本之间的关联强度是不同的。</p><h1 id="0337" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">结论</strong></h1><p id="b324" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我已经展示了几种测量变量之间关系的方法，以及我们如何解释这种测量。</p><p id="b079" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">得出相关值之间存在因果关系的结论是很诱人的，但正如许多人以前说过的那样，“相关性并不意味着因果关系”。事情可能不像数字显示的那样简单。在我们得出任何结论之前，我们需要批判性思维来剖析我们从这种相关性中获得的信息。</p></div><div class="ab cl on oo hx op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="im in io ip iq"><h1 id="b599" class="lv lw it bd lx ly ou ma mb mc ov me mf jz ow ka mh kc ox kd mj kf oy kg ml mm bi translated">如果你喜欢我的内容，并想获得更多关于数据或作为数据科学家的日常生活的深入知识，请考虑在这里订阅我的<a class="ae ky" href="https://cornellius.substack.com/welcome" rel="noopener ugc nofollow" target="_blank">时事通讯。</a></h1><blockquote class="oz"><p id="94fa" class="pa pb it bd pc pd pe pf pg ph pi lu dk translated">如果您没有订阅为中等会员，请考虑通过<a class="ae ky" href="https://cornelliusyudhawijaya.medium.com/membership" rel="noopener">我的推荐</a>订阅。</p></blockquote></div></div>    
</body>
</html>