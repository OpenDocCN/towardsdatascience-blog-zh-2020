<html>
<head>
<title>Top 10 problems to practice almost all SQL concepts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">实践几乎所有 SQL 概念的 10 大问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/10-problems-to-practice-almost-all-sql-concepts-37545e7c5219?source=collection_archive---------2-----------------------#2020-07-06">https://towardsdatascience.com/10-problems-to-practice-almost-all-sql-concepts-37545e7c5219?source=collection_archive---------2-----------------------#2020-07-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2db4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">涵盖连接、聚合、窗口函数和子查询的所有 SQL 概念</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/06562d0aa84554c579ef7eb0257bd8a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ipRIWc6d0q0K928I"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@alexacea?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Alexandru Acea </a>拍摄</p></figure><h1 id="bc90" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="8e0b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我最近在 Leetcode 上用 25 天的时间完成了所有 117 个 SQL 问题，leet code 可能是最受欢迎的练习各种编程语言编码技能的网站之一。该网站将所有问题漂亮地分为三类，即简单、中等和困难，其中难度随着每个后续级别的提高而大幅提高。完成所有这些问题后，我决定突出 10 个问题，它们几乎涵盖了从基础到高级 SQL 的所有概念，您可以通过练习来提高 SQL 编程技能。此外，几乎所有大型科技公司都在面试中问过这些问题。</p><h2 id="7100" class="mn la it bd lb mo mp dn lf mq mr dp lj ma ms mt ll me mu mv ln mi mw mx lp my bi translated">以下是每个问题中测试的 SQL 技能的明细:</h2><ul class=""><li id="4461" class="mz na it lt b lu lv lx ly ma nb me nc mi nd mm ne nf ng nh bi translated"><strong class="lt iu"> Q1 平均工资:</strong> CTE <strong class="lt iu">，</strong>聚集在窗口函数中，CASE WHEN，DATE_PART、INNER JOIN 等日期函数</li><li id="1eba" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated"><strong class="lt iu"> Q2 在结果中找到安静的学生— </strong>子查询，最小值，最大值，窗口函数，窗口别名，内部连接，所有关键字</li><li id="78ee" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated"><strong class="lt iu"> Q3 体育场人流量— </strong>左连接子查询，CTE，行号</li><li id="c410" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated"><strong class="lt iu"> Q4 每次访问的事务数量— </strong>递归 CTE、联合、计数</li><li id="5030" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated"><strong class="lt iu"> Q5 报告连续日期(MySQL)——</strong>日期子，行数</li><li id="33b9" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated"><strong class="lt iu"> Q6 按周销售— </strong>数据透视表，CASE WHEN</li><li id="5bc2" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated"><strong class="lt iu"> Q7 部门前 3 名薪资— </strong> DENSE_RANK</li><li id="6607" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated"><strong class="lt iu"> Q8 餐厅增长— </strong>移动平均线前置，偏置</li><li id="1937" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated"><strong class="lt iu"> Q9 平面内最短距离— </strong>交叉连接、SQRT、POW</li><li id="e3ae" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated"><strong class="lt iu"> Q10 连续数字— </strong>滞后，超前</li></ul><p id="d72b" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated">所以，我们言归正传吧！</p></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><ol class=""><li id="4633" class="mz na it lt b lu nn lx no ma nz me oa mi ob mm oc nf ng nh bi translated"><strong class="lt iu"> <em class="od">给定下面两张表，写一个查询，显示某部门员工平均工资与公司平均工资的比较结果(高/低/相同)。</em>T29】</strong></li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="7234" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od">方案一:</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="64fa" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu">2<em class="od">。</em> </strong> <strong class="lt iu"> <em class="od">写一个 SQL 查询，报告学生(student_id，student_name)在所有考试中“安静”的情况。“相当”的学生是指至少参加了一次考试，既没有高分也没有低分的学生。</em>T41】</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="eecc" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od">方案二</em> </strong>:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="dc61" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od"> 3。编写一个查询来显示连续 3 行或<br/>多行且人数超过 100(含)的记录。</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="f73b" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od">方案三:</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="e453" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od"> 4。编写一个 SQL 查询来查找有多少用户访问了银行但没有进行任何交易，有多少用户访问了银行并进行一次交易等等。</em>T12】</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="1270" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od">方案四:</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="9798" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od"> 5。编写 SQL 查询，为 2019 年 1 月 1 日至 2019 年 12 月 31 日期间的每个连续天数间隔生成 period_state 报告。</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="5a4e" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od">方案五:</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="8eb2" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu">6<em class="od">6。编写一个 SQL 查询来报告一周中每天每个类别中订购了多少台。</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="edfc" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od">方案六:</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="92d4" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu">7<em class="od">。编写一个 SQL 查询来查找每个部门中工资最高的三名员工。对于上面的表，您的 SQL 查询应该返回下面的行(行的顺序无关紧要)。</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="5a9c" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od">解决方案 7: </em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="bc8c" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od"> 8。编写一个 SQL 查询来计算 7 天内(当天+ 6 天前)客户支付金额的移动平均值。</em>T44】</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="1b5b" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od">解决方案 8: </em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="ffc7" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu">9<em class="od">。编写一个查询，找出这些点之间的最短距离，四舍五入到 2 位小数。</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="f8b7" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od">解决方案 9: </em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="b04d" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu">10<em class="od">。编写一个 SQL 查询来查找至少连续出现三次的所有数字。</em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="2ca8" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated"><strong class="lt iu"> <em class="od">方案 10: </em> </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="3f26" class="pw-post-body-paragraph lr ls it lt b lu nn ju lw lx no jx lz ma np mc md me nq mg mh mi nr mk ml mm im bi translated">这是一个总结！我希望您喜欢这些问题，并且能够实践一些最重要的 SQL 概念。如果你想练习更多像这样的问题，请随时到我的<a class="ae ky" href="https://github.com/mrinal1704/SQL-Leetcode-Challenge" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">Github</strong><em class="od"/></a>页面，我已经上传了所有 117 个解决方案。</p><h1 id="fe2e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">谢谢大家！</h1><p id="319d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你喜欢我的作品，请在不久的将来跟随我在媒体上阅读更多的文章。</p><ul class=""><li id="66c6" class="mz na it lt b lu nn lx no ma nz me oa mi ob mm ne nf ng nh bi translated">阅读我关于<a class="ae ky" rel="noopener" target="_blank" href="/the-art-of-engineering-features-for-a-strong-machine-learning-model-a47a876e654c">特征工程</a> &amp; <a class="ae ky" rel="noopener" target="_blank" href="/learn-how-to-automate-the-basic-steps-of-data-analysis-45e118048172">自动化基础数据分析</a>的其他文章。</li><li id="9ae9" class="mz na it lt b lu ni lx nj ma nk me nl mi nm mm ne nf ng nh bi translated">很乐意在 LinkedIn 上与您联系。</li></ul></div></div>    
</body>
</html>