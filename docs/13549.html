<html>
<head>
<title>Descent method — Steepest descent and conjugate gradient</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">下降法——最速下降法和共轭梯度法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/descent-method-steepest-descent-and-conjugate-gradient-math-explained-78601d8df3ce?source=collection_archive---------16-----------------------#2020-09-17">https://towardsdatascience.com/descent-method-steepest-descent-and-conjugate-gradient-math-explained-78601d8df3ce?source=collection_archive---------16-----------------------#2020-09-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bd75" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">数学解释</h2></div><div class="ki kj gp gr kk kl"><a href="https://medium.com/@msdata/descent-method-steepest-descent-and-conjugate-gradient-in-python-85aa4c4aac7b" rel="noopener follow" target="_blank"><div class="km ab fo"><div class="kn ab ko cl cj kp"><h2 class="bd iu gy z fp kq fr fs kr fu fw is bi translated">下降法 Python 中的最速下降和共轭梯度</h2><div class="ks l"><h3 class="bd b gy z fp kq fr fs kr fu fw dk translated">让我们从这个方程开始，我们想解出 x:</h3></div><div class="kt l"><p class="bd b dl z fp kq fr fs kr fu fw dk translated">medium.com</p></div></div><div class="ku l"><div class="kv l kw kx ky ku kz la kl"/></div></div></a></div><p id="2e75" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">让我们从这个方程开始，我们想解出 x:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/6529068cacdf0150a681f9ff4c5a2ec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:308/format:webp/0*EBKdlHKpQFZ4YXDh.png"/></div></figure><p id="30b1" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">当 A 是<strong class="ld iu">对称正定</strong>时，解 x 最小化下面的函数(否则，x 可能是最大值)。这是因为 f(x)的梯度，∇f(x) = Ax- b .而当 Ax=b 时，∇f(x)=0 因而 x 是函数的最小值。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi me"><img src="../Images/d3d15ad5e84f7731064323eace6553da.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/0*4WOTfVzGgeg7QDln.png"/></div></figure><p id="7009" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">在这篇文章中，我将向你展示两种求 x 的方法——最速下降法和共轭梯度法。</p><h1 id="e997" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">最速下降法</h1><p id="b220" class="pw-post-body-paragraph lb lc it ld b le mx ju lg lh my jx lj lk mz lm ln lo na lq lr ls nb lu lv lw im bi translated">下降法的主要思想是，我们从 x 的起点开始，试图找到下一个更接近解的点，迭代这个过程，直到找到最终解。</p><p id="00a1" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">例如，在步骤 k，我们在点𝑥(𝑘).我们如何决定下一步去哪里？我们应该往哪个方向走？我们应该去多少？</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/2571606e6e686277053ab14f5afe7831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pP5AElma8upzuvKmctmgBg.png"/></div></div></figure><p id="887d" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">让我们假设我们决定去的方向是 p(k ),我们沿着这个方向走多远是𝛼.那么下一个数据点可以写成:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/339bfb524060dd8c448104fa0202a0eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*TjLV_dRk4jqLvY0A7x9X5Q.png"/></div></figure><p id="55ce" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">对于每一步，最速下降法都希望朝着最陡的斜坡下降，在那里最有效(这里 r 表示残差):</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi ni"><img src="../Images/7d780309b0420b65e683247a99aeb64a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T9owUh7exgQQOVGIaquSKw.png"/></div></div></figure><p id="8e31" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">一旦我们决定了前进的方向，我们要确保在这个方向上最小化函数:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nj"><img src="../Images/e3a01238f482ae4020a98f6f8816ea34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o5Umxw35n8-C45ZrVx_fig.png"/></div></div></figure><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nk"><img src="../Images/89aa99d0c4766593f3f52df3039851ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8cWpU2wYx6xX94YsiI-I8w.png"/></div></div></figure><p id="e644" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">现在我们可以计算下一个数据点的 x 和残差:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nl"><img src="../Images/ea144fdedf2d540db4910b0787accc13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*idlFiKNpX8rc3U9Iviuklg.png"/></div></div></figure><p id="8862" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">这基本上是最速下降法背后的数学原理。通常我们会给残差一个停止准则，然后我们迭代这个过程，直到到达停止点。</p><p id="b4c1" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">对于 Python 实现，请查看:</p><div class="ki kj gp gr kk kl"><a href="https://medium.com/@msdata/descent-method-steepest-descent-and-conjugate-gradient-in-python-85aa4c4aac7b" rel="noopener follow" target="_blank"><div class="km ab fo"><div class="kn ab ko cl cj kp"><h2 class="bd iu gy z fp kq fr fs kr fu fw is bi translated">下降法 Python 中的最速下降和共轭梯度</h2><div class="ks l"><h3 class="bd b gy z fp kq fr fs kr fu fw dk translated">让我们从这个方程开始，我们想解出 x:</h3></div><div class="kt l"><p class="bd b dl z fp kq fr fs kr fu fw dk translated">medium.com</p></div></div><div class="ku l"><div class="kv l kw kx ky ku kz la kl"/></div></div></a></div><h1 id="0ac6" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">共轭梯度法</h1><p id="85f6" class="pw-post-body-paragraph lb lc it ld b le mx ju lg lh my jx lj lk mz lm ln lo na lq lr ls nb lu lv lw im bi translated">最速下降法是伟大的，我们在每一步的方向上最小化函数。但这并不能保证，我们要最小化的方向，来自于所有之前的方向。这里我们引入一个非常重要的术语共轭方向。方向 p 是共轭方向，如果它们具有下列性质(注 A 是对称正定的):</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nm"><img src="../Images/147f32f1b328d281ee0c1b0693c6a76b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BCwIbxZbQicKKKnLGpL8cQ.png"/></div></div></figure><p id="22a1" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">只有当前方向 p 与所有先前方向共轭时，下一个数据点才会在所有先前方向的跨度内最小化函数。</p><p id="d85f" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">问题是，当 p 必须是共轭时，我们如何计算搜索方向 p？</p><p id="e759" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">记住最陡下降选择了最陡斜率，也就是每步的残差(r)。我们知道这是一个好的选择。不如我们找一个最接近最陡下降方向的 A 共轭方向，也就是说，我们最小化向量(r-p)的 2 范数。</p><p id="3af5" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">通过计算，我们知道当前方向是当前残差和上一个方向的组合。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/23880653bb9e9a48ca73f66fbfaa54a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*8oBDoXFXqwAbHgyHKWx7ZA.png"/></div></figure><p id="0770" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">因为α-共轭方向的性质:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi no"><img src="../Images/720c5570814414f787516bfae67d5120.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*F46Fd9DhX0h8AE02xoT3rA.png"/></div></figure><p id="b8be" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">然后我们可以计算𝛾_𝑘:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi np"><img src="../Images/f923d4d5be1a0a1e916c5476fa4fc8b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X4wWe4UFBW-7UtZzlGrARQ.png"/></div></div></figure><p id="8586" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">总之，共轭梯度法如下:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/edb45ed9a7dd62a2fd490d242123b492.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*G10XlkirfgAzFXEHSL5AFQ.png"/></div></figure><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/60ee76d8871cfb03611ce1124bbd8095.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*KxUU89THnYpmTKcGWXI_Aw.png"/></div></figure><p id="7cb0" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">同样，对于 Python 实现，请查看:</p><div class="ki kj gp gr kk kl"><a href="https://medium.com/@msdata/descent-method-steepest-descent-and-conjugate-gradient-in-python-85aa4c4aac7b" rel="noopener follow" target="_blank"><div class="km ab fo"><div class="kn ab ko cl cj kp"><h2 class="bd iu gy z fp kq fr fs kr fu fw is bi translated">下降法 Python 中的最速下降和共轭梯度</h2><div class="ks l"><h3 class="bd b gy z fp kq fr fs kr fu fw dk translated">让我们从这个方程开始，我们想解出 x:</h3></div><div class="kt l"><p class="bd b dl z fp kq fr fs kr fu fw dk translated">medium.com</p></div></div><div class="ku l"><div class="kv l kw kx ky ku kz la kl"/></div></div></a></div><p id="20fa" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">现在你知道如何用最速下降法和共轭梯度法解线性方程组了！尽情享受吧！</p><p id="f2ea" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">参考:</p><div class="ki kj gp gr kk kl"><a href="https://www.cs.utexas.edu/users/flame/laff/alaff/chapter08-important-observations.html" rel="noopener  ugc nofollow" target="_blank"><div class="km ab fo"><div class="kn ab ko cl cj kp"><h2 class="bd iu gy z fp kq fr fs kr fu fw is bi translated">ALAFF 技术细节</h2><div class="ks l"><h3 class="bd b gy z fp kq fr fs kr fu fw dk translated">这一单元可能是这门课程中技术难度最大的单元。为了完整起见，我们在这里给出了细节，但是…</h3></div><div class="kt l"><p class="bd b dl z fp kq fr fs kr fu fw dk translated">www.cs.utexas.edu</p></div></div><div class="ku l"><div class="ns l kw kx ky ku kz la kl"/></div></div></a></div></div></div>    
</body>
</html>