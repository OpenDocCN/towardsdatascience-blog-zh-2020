<html>
<head>
<title>A Simple Movie Recommendation System</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个简单的电影推荐系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-simple-movie-recommendation-system-d135cfd0a22d?source=collection_archive---------18-----------------------#2020-05-20">https://towardsdatascience.com/a-simple-movie-recommendation-system-d135cfd0a22d?source=collection_archive---------18-----------------------#2020-05-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8af3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">基于亚马逊基于商品的协同过滤</h2></div><p id="811c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">机器学习领域的推荐系统已经变得非常流行，对于网飞、亚马逊等科技巨头来说，这是一个巨大的优势，可以让他们的内容面向特定的受众。这些推荐引擎在预测方面非常强大，它们可以根据用户与应用程序的交互动态改变用户在页面上看到的内容的状态。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/b3cdaaa9fbebe5d7c8b371b465d517a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jqFy_PvgLrHQmlln"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">格伦·卡斯滕斯-彼得斯在<a class="ae lu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a19a" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">基于项目的协同过滤</h1><p id="a5c2" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">基于项目的协同过滤是由 Amazon 开发的一种方法，用于推荐系统中，主要基于数据集中各种项目之间的相似性向用户提供推荐。这些推荐是基于用户对该特定项目的评级来计算的。</p><h1 id="14ba" class="mc md it bd me mf mz mh mi mj na ml mm jz nb ka mo kc nc kd mq kf nd kg ms mt bi translated">一种电影推荐系统</h1><p id="fdee" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">我们将在这个项目中使用的数据集来自<a class="ae lu" href="https://grouplens.org/datasets/movielens/100k/" rel="noopener ugc nofollow" target="_blank"> MovieLens </a>。</p><p id="a23b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们从将数据集导入笔记本开始。有两个文件特别需要导入。因此，将用户的评级导入到<strong class="kk iu"> r_cols </strong>数据帧中，将电影导入到<strong class="kk iu"> m_cols </strong>数据帧中。我们还将把编码类型设置为<strong class="kk iu"> utf-8 </strong>。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="88ec" class="nj md it nf b gy nk nl l nm nn">import pandas as pd</span><span id="e092" class="nj md it nf b gy no nl l nm nn">r_cols = ['user_id', 'movie_id', 'rating']<br/>ratings = pd.read_csv('ml-100k/u.data', sep='\t', names=r_cols, usecols=range(3), encoding="ISO-8859-1")</span><span id="1a4b" class="nj md it nf b gy no nl l nm nn">m_cols = ['movie_id', 'title']<br/>movies = pd.read_csv('ml-100k/u.item', sep='|', names=m_cols, usecols=range(2), encoding="ISO-8859-1")</span></pre><p id="725c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们必须合并这两个数据帧，以获得一个完整的数据帧，该数据帧包含任何给定电影的用户评级。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="8943" class="nj md it nf b gy nk nl l nm nn">ratings = pd.merge(movies, ratings)</span></pre><p id="5895" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看这个数据帧是什么样子的，</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="6974" class="nj md it nf b gy nk nl l nm nn">ratings.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi np"><img src="../Images/6e7b2497ee77f144effb826dfc092dc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*Vn0g7i5gYGI1YWeJo38Xfg.jpeg"/></div></figure><p id="6905" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步是旋转这个表，创建一个用户和他们评价的电影的矩阵。这个表格是为了让我们了解哪个用户看过什么电影，以及他们提供了什么样的评级。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="8491" class="nj md it nf b gy nk nl l nm nn">movieRatings = ratings.pivot_table(index=['user_id'],columns=['title'],values='rating')<br/>movieRatings.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nq"><img src="../Images/7e7d50612acc74bcf400067afb47e951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m2BsjcQ2rKljRn4cnDHtog.jpeg"/></div></div></figure><p id="80a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将对 1977 年的星球大战电影进行分析。所以，让我们把所有星球大战的这些值分配给一个叫做<strong class="kk iu">星球大战等级</strong>的数据框架。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="8403" class="nj md it nf b gy nk nl l nm nn">starWarsRatings = movieRatings['Star Wars (1977)']<br/>starWarsRatings.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/2f6b66fd4877f9d42c0bef0fd78290b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*UWk4R8GGJa78o6srtJuwsQ.jpeg"/></div></figure><p id="0ce3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用 pandas corr()函数来查找与星球大战相关的所有列之间的成对相关性。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="5df7" class="nj md it nf b gy nk nl l nm nn">similarMovies = movieRatings.corrwith(starWarsRatings) # pairwise correlation of Star Wars vector of user rating with every other movie</span></pre><p id="ddea" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们放弃任何没有数据的结果，</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="d89c" class="nj md it nf b gy nk nl l nm nn">similarMovies = similarMovies.dropna() # Drop any results that have no data</span></pre><p id="d443" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">构建具有关于星球大战的每部电影的相关分数的新鲜的新数据帧。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="ce6a" class="nj md it nf b gy nk nl l nm nn">df = pd.DataFrame(similarMovies) # Construct a new Dataframe of movies and their correlation score to Star Wars</span></pre><p id="3681" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看这个数据框里有什么，</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="bae7" class="nj md it nf b gy nk nl l nm nn">df.head(10)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/41da0abbc75e0880ec2507dd28c9a8b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*o-vKeu3ND5adjZri8k11FA.jpeg"/></div></figure><p id="e40d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们根据分数对这些值进行排序，</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="506e" class="nj md it nf b gy nk nl l nm nn">similarMovies.sort_values(ascending=False)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/8d2922525d2b69c613a19e33bc72ab7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*OwqpSV3SmOyCVaK6dUqI0g.jpeg"/></div></figure><p id="f677" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">是的，这些结果没有任何意义。</p><p id="6152" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是因为我们的结果被那些只被一小撮人评级的电影搞砸了，他们也给《星球大战》评级。让我们来看看这些条目。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="97f1" class="nj md it nf b gy nk nl l nm nn">import numpy as np<br/>movieStats = ratings.groupby('title').agg({'rating': [np.size, np.mean]})<br/>movieStats.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/a5196a4af22cf2b3b326857c9a63a996.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*bbPMyTkIR3yIC7McCm220Q.jpeg"/></div></figure><p id="b70b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们去掉那些少于 100 人评价的条目。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="b26a" class="nj md it nf b gy nk nl l nm nn">popularMovies = movieStats['rating']['size'] &gt;= 100 # Ignore movies rated by less than 100 people<br/>movieStats[popularMovies].sort_values([('rating', 'mean')], ascending=False)[:15]</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/ae42ed17ae048b47df995ac1674a29f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*oKgBk8SNnDUbRPBPBe-OdA.jpeg"/></div></figure><p id="c0ab" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将这些数据与类似于《星球大战》的原始电影集结合起来。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="1f23" class="nj md it nf b gy nk nl l nm nn">df = movieStats[popularMovies].join(pd.DataFrame(similarMovies, columns=['similarity']))</span></pre><p id="5e8f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们来看看我们的数据框。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="b4fc" class="nj md it nf b gy nk nl l nm nn">df.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/d83ec0875f5b8bf1eb095e9959f4b8de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*836l7STHYg47RJtTRKkM6A.jpeg"/></div></figure><p id="d631" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，根据相似性得分对这些值进行排序。</p><pre class="lf lg lh li gt ne nf ng nh aw ni bi"><span id="7d19" class="nj md it nf b gy nk nl l nm nn">df.sort_values(['similarity'], ascending=False)[:5]</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/2025e400a7454b9ad24b1436613fa86a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*QhH1ywkb17CQpNweTottZg.jpeg"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0d6e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结果</h1><p id="9100" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">瞧😆！你可以看到，我们刚刚获得的最终输出中的前三个条目都是星球大战电影。接下来的几部电影基于相似的类型，即动作和冒险。我们刚刚建立了一个令人惊叹的电影推荐系统，它能够建议用户观看与他们过去观看过的内容相关的电影。</p><p id="faf5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以在我的<a class="ae lu" href="https://github.com/K-G-PRAJWAL/Machine-Learning-Projects/blob/master/Movie%20Recommendation/RecommenderSystem(MovieSimilarities).ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到完整的代码。如有任何疑问，请随时通过我的<a class="ae lu" href="https://www.linkedin.com/in/k-g-prajwal-a6b3b517a/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p><h2 id="981f" class="nj md it bd me ny nz dn mi oa ob dp mm kr oc od mo kv oe of mq kz og oh ms oi bi translated">谢谢你。</h2></div></div>    
</body>
</html>