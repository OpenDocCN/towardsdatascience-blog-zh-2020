<html>
<head>
<title>Use Environment Variable in your next Golang Project</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åœ¨ä¸‹ä¸€ä¸ª Golang é¡¹ç›®ä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/use-environment-variable-in-your-next-golang-project-39e17c3aaa66?source=collection_archive---------2-----------------------#2020-01-20">https://towardsdatascience.com/use-environment-variable-in-your-next-golang-project-39e17c3aaa66?source=collection_archive---------2-----------------------#2020-01-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="aea8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">golang ä¸­æœ‰å¤šç§æ–¹æ³•å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡å’Œæ–‡ä»¶ã€‚</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1f65fa120eacaf4d88809b266b0c09a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qCEMqr6hnylxa0oB-2H_mw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae kv" href="https://unsplash.com/@mojamsanii?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Moja Msanii </a>åœ¨<a class="ae kv" href="https://unsplash.com/s/photos/security?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</p></figure><p id="162f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å½“åˆ›å»ºç”Ÿäº§çº§åº”ç”¨ç¨‹åºæ—¶ï¼Œåœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡æ˜¯äº‹å®ä¸Šçš„<em class="ls"/>ã€‚</p><blockquote class="lt lu lv"><p id="86e0" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">ä¹Ÿå¯ä»¥çœ‹ youtube è§†é¢‘ã€‚</p></blockquote><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lz ma l"/></div></figure><h1 id="3950" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼Ÿ</h1><p id="3d6d" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">å‡è®¾æ‚¨æœ‰ä¸€ä¸ªå…·æœ‰è®¸å¤šç‰¹æ€§çš„åº”ç”¨ç¨‹åºï¼Œæ¯ä¸ªç‰¹æ€§éƒ½éœ€è¦è®¿é—®æ•°æ®åº“ã€‚æ‚¨åœ¨æ¯ä¸ªç‰¹æ€§ä¸­é…ç½®äº†æ‰€æœ‰çš„æ•°æ®åº“ä¿¡æ¯ï¼Œå¦‚<code class="fe my mz na nb b">DBURL</code>ã€<code class="fe my mz na nb b">DBNAME</code>ã€<code class="fe my mz na nb b">USERNAME</code>å’Œ<code class="fe my mz na nb b">PASSWORD</code>ã€‚</p><p id="75d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™ç§æ–¹æ³•æœ‰å‡ ä¸ªä¸»è¦ç¼ºç‚¹ï¼Œä½†ä¹Ÿæœ‰å¾ˆå¤šã€‚</p><h2 id="9c8e" class="nc mc iq bd md nd ne dn mh nf ng dp ml lf nh ni mn lj nj nk mp ln nl nm mr nn bi translated">å®‰å…¨é—®é¢˜:</h2><ul class=""><li id="e80a" class="no np iq ky b kz mt lc mu lf nq lj nr ln ns lr nt nu nv nw bi translated">ä½ åœ¨è¾“å…¥å¯†ç ä¸­çš„æ‰€æœ‰ä¿¡æ¯ã€‚ç°åœ¨ï¼Œæ‰€æœ‰æœªç»æˆæƒçš„äººä¹Ÿå¯ä»¥è®¿é—®æ•°æ®åº“ã€‚</li><li id="86ec" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ä»£ç ç‰ˆæœ¬æ§åˆ¶å·¥å…·<code class="fe my mz na nb b">git</code>ï¼Œé‚£ä¹ˆä¸€æ—¦ä½ å‘å¸ƒä»£ç ï¼Œä½ çš„æ•°æ®åº“çš„ç»†èŠ‚å°±ä¼šå…¬ä¹‹äºä¼—ã€‚</li></ul><h2 id="50a5" class="nc mc iq bd md nd ne dn mh nf ng dp ml lf nh ni mn lj nj nk mp ln nl nm mr nn bi translated">ä»£ç ç®¡ç†:</h2><ul class=""><li id="afe7" class="no np iq ky b kz mt lc mu lf nq lj nr ln ns lr nt nu nv nw bi translated">å¦‚æœä½ æ”¹å˜ä¸€ä¸ªå•ä¸€çš„å˜é‡ï¼Œé‚£ä¹ˆä½ å¿…é¡»æ”¹å˜æ‰€æœ‰çš„ç‰¹å¾ã€‚å¾ˆæœ‰å¯èƒ½ä½ ä¼šé”™è¿‡ä¸€ä¸¤ä¸ªã€‚ğŸ˜Œå»è¿‡é‚£é‡Œ</li><li id="7c8d" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">æ‚¨å¯ä»¥å¯¹ç¯å¢ƒå˜é‡è¿›è¡Œåˆ†ç±»ï¼Œå¦‚<code class="fe my mz na nb b">PROD</code>ã€<code class="fe my mz na nb b">DEV</code>æˆ–<code class="fe my mz na nb b">TEST</code>ã€‚åªéœ€ç»™å˜é‡åŠ ä¸Šç¯å¢ƒå‰ç¼€ã€‚</li></ul><p id="cced" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¼€å§‹æ—¶ï¼Œå®ƒå¯èƒ½çœ‹èµ·æ¥åƒä¸€äº›é¢å¤–çš„å·¥ä½œï¼Œä½†æ˜¯è¿™å°†åœ¨ä½ çš„é¡¹ç›®ä¸­å¥–åŠ±ä½ å¾ˆå¤šã€‚</p><blockquote class="oc"><p id="bde1" class="od oe iq bd of og oh oi oj ok ol lr dk translated">âš ï¸åªæ˜¯ä¸è¦å¿˜è®°åœ¨<code class="fe my mz na nb b"><strong class="ak">.gitignore</strong></code>ä¸­åŒ…å«ä½ çš„ç¯å¢ƒæ–‡ä»¶ã€‚</p></blockquote><p id="95a6" class="pw-post-body-paragraph kw kx iq ky b kz om jr lb lc on ju le lf oo lh li lj op ll lm ln oq lp lq lr ij bi translated">æ˜¯é‡‡å–è¡ŒåŠ¨çš„æ—¶å€™äº†ã€‚ğŸ”¨</p><h2 id="c6e6" class="nc mc iq bd md nd ne dn mh nf ng dp ml lf nh ni mn lj nj nk mp ln nl nm mr nn bi translated">åœ¨è¿™ä¸ªæ•™ç¨‹ä¸­æˆ‘ä»¬è¦åšä»€ä¹ˆï¼Ÿ</h2><p id="3479" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä»¥ 3 ç§ä¸åŒçš„æ–¹å¼è®¿é—®ç¯å¢ƒå˜é‡ã€‚</p><p id="0fcc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½ å¯ä»¥æ ¹æ®ä½ çš„éœ€è¦æ¥ä½¿ç”¨å®ƒã€‚</p><ul class=""><li id="3c09" class="no np iq ky b kz la lc ld lf or lj os ln ot lr nt nu nv nw bi translated"><code class="fe my mz na nb b">os</code>åŒ…è£…</li><li id="2605" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated"><code class="fe my mz na nb b">godotenv</code>åŒ…è£…</li><li id="9139" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated"><code class="fe my mz na nb b">viper</code>åŒ…è£…</li></ul></div><div class="ab cl ou ov hu ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="ij ik il im in"><h1 id="5acd" class="mb mc iq bd md me pb mg mh mi pc mk ml jw pd jx mn jz pe ka mp kc pf kd mr ms bi translated">åˆ›å»ºé¡¹ç›®</h1><p id="2913" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">åœ¨<code class="fe my mz na nb b"><strong class="ky ir">$GOPATH</strong></code>ä¹‹å¤–åˆ›å»ºä¸€ä¸ªé¡¹ç›®<code class="fe my mz na nb b"><strong class="ky ir">go-env-ways</strong></code>ã€‚</p><h1 id="71e5" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">åˆå§‹åŒ–æ¨¡å—</h1><p id="a8c3" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">æ‰“å¼€é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ç»ˆç«¯ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="bebb" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">go mod init goenv</strong></span></pre><p id="b84c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™ä¸ªæ¨¡å—å°†è®°å½•é¡¹ç›®ä¸­ä½¿ç”¨çš„æ‰€æœ‰åŒ…åŠå…¶ç‰ˆæœ¬ã€‚ç±»ä¼¼äº<code class="fe my mz na nb b">nodejs</code>ä¸­çš„<code class="fe my mz na nb b">package.json</code>ã€‚</p></div><div class="ab cl ou ov hu ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="ij ik il im in"><p id="add5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è®©æˆ‘ä»¬ä»æœ€ç®€å•çš„å¼€å§‹ï¼Œä½¿ç”¨<code class="fe my mz na nb b">os</code>åŒ…ã€‚</p><h1 id="b78e" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">æ“ä½œç³»ç»ŸåŒ…</h1><p id="e40b" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">Golang æä¾›äº†<code class="fe my mz na nb b">os</code>åŒ…ï¼Œè¿™æ˜¯ä¸€ç§é…ç½®å’Œè®¿é—®ç¯å¢ƒå˜é‡çš„ç®€å•æ–¹æ³•ã€‚</p><p id="9d9e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¦è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œ</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="b509" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">os.Setenv(key, value)</strong></span></pre><p id="65d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¦è·å¾—ç¯å¢ƒå˜é‡ï¼Œ</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="6c12" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">value := os.Getenv(key)</strong></span></pre><p id="bc00" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨é¡¹ç›®ä¸­åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶<code class="fe my mz na nb b">main.go</code>ã€‚</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="4af5" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">package main</strong><br/><br/>import (<br/>  "fmt"<br/>  "os"<br/>)<br/><br/>// use os package to get the env variable which is already set<br/><strong class="nb ir">func envVariable(key string) string </strong>{<br/><br/>  // set env variable using os package<br/>  <strong class="nb ir">os.Setenv(key, "gopher")</strong><br/><br/>  // return the env variable using os package<br/>  <strong class="nb ir">return os.Getenv(key)</strong><br/>}<br/><br/><strong class="nb ir">func main() {</strong><br/>  // os package<br/> <strong class="nb ir"> value := envVariable("name")</strong><br/><br/>  <strong class="nb ir">fmt.Printf("os package: name = %s \n", value)</strong></span><span id="874e" class="nc mc iq nb b gy po pl l pm pn"><strong class="nb ir">  fmt.Printf("environment = %s \n", os.Getenv("APP_ENV"))</strong><br/>}</span></pre><p id="7160" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œæ£€æŸ¥ã€‚</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="9e26" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">APP_ENV=prod go run main.go</strong><br/><br/>// Output<br/><strong class="nb ir">os package: name = gopher<br/>environment = prod</strong></span></pre></div><div class="ab cl ou ov hu ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="ij ik il im in"><h1 id="b817" class="mb mc iq bd md me pb mg mh mi pc mk ml jw pd jx mn jz pe ka mp kc pf kd mr ms bi translated">GoDotEnv åŒ…</h1><p id="0293" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">åŠ è½½<code class="fe my mz na nb b">.env</code>æ–‡ä»¶æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨<code class="fe my mz na nb b">godotenv</code>åŒ…ã€‚</p><h1 id="2815" class="mb mc iq bd md me mf mg mh mi mj mk ml jw mm jx mn jz mo ka mp kc mq kd mr ms bi translated">å®‰è£…</h1><p id="20c2" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰“å¼€ç»ˆç«¯ã€‚</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="2c42" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">go get github.com/joho/godotenv</strong></span></pre><p id="4c98" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe my mz na nb b">godotenv </code>æä¾›äº†ä¸€ä¸ª<code class="fe my mz na nb b">Load </code>æ–¹æ³•æ¥åŠ è½½ env æ–‡ä»¶ã€‚</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="ed90" class="nc mc iq nb b gy pk pl l pm pn">// Load the .env file in the current directory<br/><strong class="nb ir">godotenv.Load()</strong><br/><br/>// or<br/><br/><strong class="nb ir">godotenv.Load(".env")</strong></span></pre><blockquote class="lt lu lv"><p id="39ea" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><em class="iq"> Load æ–¹æ³•å¯ä»¥ä¸€æ¬¡åŠ è½½å¤šä¸ª env æ–‡ä»¶ã€‚è¿™ä¹Ÿæ”¯æŒ</em> <code class="fe my mz na nb b"><em class="iq">yaml</em></code> <em class="iq">ã€‚æ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹</em> <a class="ae kv" href="https://github.com/joho/godotenv" rel="noopener ugc nofollow" target="_blank"> <em class="iq">æ–‡æ¡£</em> </a> <em class="iq">ã€‚</em></p></blockquote><p id="90a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„<code class="fe my mz na nb b">.env</code>æ–‡ä»¶ã€‚</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="c0f3" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">STRONGEST_AVENGER=Thor</strong></span></pre><p id="e805" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ›´æ–°<code class="fe my mz na nb b">main.go</code>ã€‚</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="e11b" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">package main</strong><br/><br/>import (<br/><br/>    ...<br/>    // Import godotenv<br/>  <strong class="nb ir">"github.com/joho/godotenv"</strong><br/>)<br/><br/><br/>// use godot package to load/read the .env file and<br/>// return the value of the key<br/><strong class="nb ir">func goDotEnvVariable(key string) string {</strong><br/><br/>  // load .env file<br/>  <strong class="nb ir">err := godotenv.Load(".env")</strong><br/><br/>  if err != nil {<br/>    log.Fatalf("Error loading .env file")<br/>  }<br/><br/>  <strong class="nb ir">return os.Getenv(key)</strong><br/>}<br/><br/><strong class="nb ir">func main() {</strong><br/>    // os package<br/>    ... <br/><br/>  // godotenv package<br/>  <strong class="nb ir">dotenv := goDotEnvVariable("STRONGEST_AVENGER")</strong><br/><br/>  fmt.Printf("godotenv : %s = %s \n", "STRONGEST_AVENGER", dotenv)<br/>}</span></pre><p id="8ead" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ‰“å¼€ç»ˆç«¯å¹¶è¿è¡Œ<code class="fe my mz na nb b">main.go</code>ã€‚</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="a8a9" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">go run main.go</strong><br/><br/>// Output<br/><strong class="nb ir">os package: name = gopher</strong><br/><br/><strong class="nb ir">godotenv : STRONGEST_AVENGER = Thor</strong></span></pre><blockquote class="lt lu lv"><p id="ced7" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">åªéœ€åœ¨ä¸»å‡½æ•°ä¸­æ·»åŠ  os åŒ…æœ«å°¾çš„ä»£ç å³å¯ã€‚</p></blockquote></div><div class="ab cl ou ov hu ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="ij ik il im in"><h1 id="0519" class="mb mc iq bd md me pb mg mh mi pc mk ml jw pd jx mn jz pe ka mp kc pf kd mr ms bi translated">æ¯’è›‡åŒ…è£…</h1><p id="766d" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">Viper æ˜¯ golang ç¤¾åŒºä¸­æœ€å—æ¬¢è¿çš„è½¯ä»¶åŒ…ä¹‹ä¸€ã€‚è®¸å¤šå›´æ£‹é¡¹ç›®éƒ½æ˜¯ä½¿ç”¨ Viper æ„å»ºçš„ï¼ŒåŒ…æ‹¬ Hugoã€Docker å…¬è¯äººã€Mercuryã€‚</p><blockquote class="oc"><p id="56ac" class="od oe iq bd of og oh oi oj ok ol lr dk translated"><em class="pp">æ¯’è›‡ğŸæ˜¯ Go åº”ç”¨çš„å®Œæ•´é…ç½®è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ 12 å› ç´ åº”ç”¨ã€‚å®ƒè®¾è®¡ç”¨äºåœ¨åº”ç”¨ç¨‹åºä¸­å·¥ä½œï¼Œå¯ä»¥å¤„ç†æ‰€æœ‰ç±»å‹çš„é…ç½®éœ€æ±‚å’Œæ ¼å¼ã€‚è¯»å– JSONã€TOMLã€YAMLã€HCLã€envfile å’Œ Java å±æ€§é…ç½®æ–‡ä»¶</em></p><p id="6cd0" class="od oe iq bd of og oh oi oj ok ol lr dk translated">æ›´å¤šä¿¡æ¯è¯·é˜…è¯»<a class="ae kv" href="https://github.com/spf13/viper" rel="noopener ugc nofollow" target="_blank">è°è›‡</a>çš„å®˜æ–¹æ–‡æ¡£</p></blockquote><h1 id="a783" class="mb mc iq bd md me mf mg mh mi mj mk ml jw pq jx mn jz pr ka mp kc ps kd mr ms bi translated">å®‰è£…</h1><p id="dd6f" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰“å¼€ç»ˆç«¯ã€‚</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="299e" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">go get github.com/spf13/viper</strong></span></pre><p id="e1a1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¦è®¾ç½®é…ç½®æ–‡ä»¶å’Œè·¯å¾„</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="799b" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">viper.SetConfigFile(".env")</strong></span></pre><p id="c33f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¦è¯»å–é…ç½®æ–‡ä»¶</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="0102" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">viper.ReadInConfig()</strong></span></pre><p id="aacb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½¿ç”¨é”®ä»é…ç½®æ–‡ä»¶ä¸­è·å–å€¼</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="24b1" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">viper.Get(key)</strong></span></pre><p id="3f3a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ›´æ–°<code class="fe my mz na nb b">main.go</code>ã€‚</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="6b3d" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">import </strong>(<br/>  "fmt"<br/>  "log"<br/>  "os"<br/><br/>  "github.com/joho/godotenv"<br/>  <strong class="nb ir">"github.com/spf13/viper"</strong><br/>)<br/><br/>// use viper package to read .env file<br/>// return the value of the key<br/><strong class="nb ir">func viperEnvVariable(key string) string {</strong><br/><br/>  // SetConfigFile explicitly defines the path, name and extension of the config file.<br/>  // Viper will use this and not check any of the config paths.<br/>  // .env - It will search for the .env file in the current directory<br/>  <strong class="nb ir">viper.SetConfigFile(".env")<br/></strong><br/>  // Find and read the config file<br/>  <strong class="nb ir">err := viper.ReadInConfig()</strong><br/><br/>  if err != nil {<br/>    log.Fatalf("Error while reading config file %s", err)<br/>  }<br/><br/>  // viper.Get() returns an empty interface{}<br/>  // to get the underlying type of the key,<br/>  // we have to do the type assertion, we know the underlying value is string<br/>  // if we type assert to other type it will throw an error<br/>  <strong class="nb ir">value, ok := viper.Get(key).(string)</strong><br/><br/>  // If the type is a string then ok will be true<br/>  // ok will make sure the program not break<br/>  if !ok {<br/>    log.Fatalf("Invalid type assertion")<br/>  }<br/><br/> <strong class="nb ir"> return value</strong><br/>}<br/><br/><strong class="nb ir">func main() {</strong><br/><br/>    // os package  <br/>    ...<br/>  <br/>  // godotenv package<br/>  ...<br/><br/>  // viper package read .env<br/> <strong class="nb ir"> viperenv := viperEnvVariable("STRONGEST_AVENGER")</strong><br/><br/>  fmt.Printf("viper : %s = %s \n", "STRONGEST_AVENGER", viperenv)<br/>}</span></pre><p id="057f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ‰“å¼€ç»ˆç«¯å¹¶è¿è¡Œ<code class="fe my mz na nb b">main.go</code>ã€‚</p></div><div class="ab cl ou ov hu ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="ij ik il im in"><h1 id="30c1" class="mb mc iq bd md me pb mg mh mi pc mk ml jw pd jx mn jz pe ka mp kc pf kd mr ms bi translated">æ¯’è›‡ä¸ä»…é™äºã€‚ç¯å¢ƒæ–‡ä»¶ã€‚</h1><p id="51a9" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">å®ƒæ”¯æŒ:</p><ul class=""><li id="9b5c" class="no np iq ky b kz la lc ld lf or lj os ln ot lr nt nu nv nw bi translated">è®¾ç½®é»˜è®¤å€¼</li><li id="f837" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">è¯»å– JSONã€TOMLã€YAMLã€HCLã€envfile å’Œ Java å±æ€§é…ç½®æ–‡ä»¶</li><li id="e51c" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">å®æ—¶è§‚å¯Ÿå’Œé‡è¯»é…ç½®æ–‡ä»¶(å¯é€‰)</li><li id="a4ac" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">ä»ç¯å¢ƒå˜é‡ä¸­è¯»å–</li><li id="bca3" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">ä»è¿œç¨‹é…ç½®ç³»ç»Ÿ(etcd æˆ– Consul)è¯»å–ï¼Œå¹¶è§‚å¯Ÿå˜åŒ–</li><li id="64bc" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">ä»å‘½ä»¤è¡Œæ ‡å¿—ä¸­è¯»å–</li><li id="dd10" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">ä»ç¼“å†²åŒºè¯»å–</li><li id="bb8a" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">è®¾ç½®æ˜¾å¼å€¼</li></ul><p id="25ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Viper å¯ä»¥è¢«çœ‹ä½œæ˜¯æ»¡è¶³åº”ç”¨ç¨‹åºæ‰€æœ‰é…ç½®éœ€æ±‚çš„æ³¨å†Œè¡¨ã€‚</p><p id="e48d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è®©æˆ‘ä»¬å®éªŒä¸€ä¸‹:ğŸ’£</p><p id="70e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„<code class="fe my mz na nb b">config.yaml</code>æ–‡ä»¶ã€‚</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="83c7" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">I_AM_INEVITABLE: "I am Iron Man"</strong></span></pre><p id="a476" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¦è®¾ç½®é…ç½®æ–‡ä»¶å</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="e957" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">viper.SetConfigName("config")</strong></span></pre><p id="b3ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¦è®¾ç½®é…ç½®æ–‡ä»¶è·¯å¾„</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="6ab0" class="nc mc iq nb b gy pk pl l pm pn">// Look in the current working directory <br/><strong class="nb ir">viper.AddConfigPath(".")</strong></span></pre><p id="37bb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¦è¯»å–é…ç½®æ–‡ä»¶</p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="a219" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">viper.ReadInConfig()</strong></span></pre><p id="515f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ›´æ–°<code class="fe my mz na nb b"><strong class="ky ir">main.go</strong></code></p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="89e1" class="nc mc iq nb b gy pk pl l pm pn">// use viper package to load/read the config file or .env file and<br/>// return the value of the key<br/><strong class="nb ir">func viperConfigVariable(key string) string </strong>{<br/><br/>  // name of config file (without extension)<br/>  <strong class="nb ir">viper.SetConfigName("config")</strong><br/>  // look for config in the working directory<br/> <strong class="nb ir"> viper.AddConfigPath(".")</strong><br/><br/>  // Find and read the config file<br/>  <strong class="nb ir">err := viper.ReadInConfig()</strong><br/><br/>  if err != nil {<br/>    log.Fatalf("Error while reading config file %s", err)<br/>  }<br/><br/>  // viper.Get() returns an empty interface{}<br/>  // to get the underlying type of the key,<br/>  // we have to do the type assertion, we know the underlying value is string<br/>  // if we type assert to other type it will throw an error<br/>  <strong class="nb ir">value, ok := viper.Get(key).(string)</strong><br/><br/>  // If the type is a string then ok will be true<br/>  // ok will make sure the program not break<br/>  if !ok {<br/>    log.Fatalf("Invalid type assertion")<br/>  }<br/><br/> <strong class="nb ir"> return value</strong><br/>}<br/><br/><strong class="nb ir">func main() </strong>{<br/><br/>  // os package<br/>  ...<br/><br/>  // godotenv package<br/>  ...<br/><br/>  // viper package read .env<br/>  ...<br/><br/>  // viper package read config file<br/>  <strong class="nb ir">viperconfig := viperConfigVariable("I_AM_INEVITABLE")</strong>  <br/>  <br/>  fmt.Printf("viper config : %s = %s \n", "I_AM_INEVITABLE", viperconfig)  <br/>}</span></pre><p id="0dce" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ‰“å¼€ç»ˆç«¯å¹¶è¿è¡Œ<code class="fe my mz na nb b">main.go</code></p><pre class="kg kh ki kj gt pg nb ph pi aw pj bi"><span id="8884" class="nc mc iq nb b gy pk pl l pm pn"><strong class="nb ir">go run main.go</strong><br/><br/>// Output<br/><strong class="nb ir">os package: name = gopher</strong><br/><br/><strong class="nb ir">godotenv : STRONGEST_AVENGER = Thor<br/><br/>viper : STRONGEST_AVENGER = Thor<br/><br/>viper config : I_AM_INEVITABLE = I am Iron Man</strong></span></pre></div><div class="ab cl ou ov hu ow" role="separator"><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz pa"/><span class="ox bw bk oy oz"/></div><div class="ij ik il im in"><h1 id="32fb" class="mb mc iq bd md me pb mg mh mi pc mk ml jw pd jx mn jz pe ka mp kc pf kd mr ms bi translated">ç»“è®º</h1><p id="f49e" class="pw-post-body-paragraph kw kx iq ky b kz mt jr lb lc mu ju le lf mv lh li lj mw ll lm ln mx lp lq lr ij bi translated">å°±è¿™æ ·ï¼Œç°åœ¨ä½ å¯ä»¥æ¢ç´¢ä»–ä»¬æ›´å¤šçš„ç§˜å¯†äº†ğŸ”ã€‚å¦‚æœä½ å‘ç°ä¸€äº›å€¼å¾—åˆ†äº«çš„ä¸œè¥¿ï¼Œä¸è¦çŠ¹è±«ğŸ˜‰ã€‚</p><p id="ad13" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å®Œæ•´çš„ä»£ç å¯ä»¥åœ¨<a class="ae kv" href="https://github.com/schadokar/blog-projects/tree/go-env-ways" rel="noopener ugc nofollow" target="_blank"> GitHub </a>ä¸Šæ‰¾åˆ°ã€‚</p></div></div>    
</body>
</html>