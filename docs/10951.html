<html>
<head>
<title>Exploring WhatsApp data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">探索 WhatsApp 数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyzing-whatsapp-chats-with-python-20d62ce7fe2d?source=collection_archive---------16-----------------------#2020-07-30">https://towardsdatascience.com/analyzing-whatsapp-chats-with-python-20d62ce7fe2d?source=collection_archive---------16-----------------------#2020-07-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/3adfcbbd490662489a20bb8691a42351.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6TlwocGp_oRyQky8YBOHqA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">来自<a class="ae jd" href="https://unsplash.com" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>的<a class="ae jd" href="https://unsplash.com/@ymoran" rel="noopener ugc nofollow" target="_blank">莫兰</a>的照片</p></figure><div class=""/><div class=""><h2 id="1c04" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">使用 Python 分析您的 WhatsApp 聊天数据</h2></div><p id="218a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi lr translated">分析数据可能会很吸引人，很有趣，并且能够给出关于某个主题的非常有趣的见解。当这些数据与我们或我们的环境联系在一起时，分析这些数据就变得更加有趣，因为这些信息总是近在眼前，但却从来没有从分析的角度来看待过。</p><p id="6d82" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为此，我们通过社交网络与他人的互动是一个很好的数据来源。如今，我们每天都使用社交网络和互联网来工作或休闲。事实证明，这些方法真的很有帮助，让一些过程变得更有效率，甚至缓解了异地恋。它们影响了我们交流的方式，甚至重塑了我们的社交行为。社交网络注册，现在比以往任何时候都更需要<em class="ma">我们如何</em>和<em class="ma">什么</em>交流。</p><p id="cb43" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这方面，<a class="ae jd" href="https://www.whatsapp.com/" rel="noopener ugc nofollow" target="_blank"> WhatsApp </a>已经成为最广泛使用的与他人聊天的应用之一<a class="ae jd" href="#outline" rel="noopener ugc nofollow">【1】</a>。在这篇文章中，我将尝试展示我们如何使用 <strong class="kx jh"> python </strong>从 WhatsApp 聊天中轻松提取和<strong class="kx jh">分析数据。</strong></p><h2 id="d894" class="mb mc jg bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated">概述</h2><p id="8454" class="pw-post-body-paragraph kv kw jg kx b ky mu kh la lb mv kk ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">这篇文章的概要如下</p><ul class=""><li id="1b20" class="mz na jg kx b ky kz lb lc le nb li nc lm nd lq ne nf ng nh bi translated">从手机中导出 WhatsApp 聊天</li><li id="79e9" class="mz na jg kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">使用 python 库 whatstk</li><li id="78e6" class="mz na jg kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">结论</li></ul></div><div class="ab cl nn no hu np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ij ik il im in"><h1 id="7a0f" class="nu mc jg bd md nv nw nx mg ny nz oa mj km ob kn mm kp oc kq mp ks od kt ms oe bi translated">从手机中导出 WhatsApp 聊天</h1><p id="530c" class="pw-post-body-paragraph kv kw jg kx b ky mu kh la lb mv kk ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">从手机导出聊天内容的过程相当简单。但是，它会根据您的移动操作系统而变化(参见下面的剪辑)。</p><p id="4ac3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">导出聊天时，确保选择无媒体的<em class="ma">选项。一旦生成，您可以通过邮件发送给自己，并下载/保存到您的计算机上。</em></p><p id="ed70" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在<strong class="kx jh"> Android </strong>上，可能会导出几个文件。我们只对文本文件感兴趣(即<code class="fe of og oh oi b">txt</code>扩展名文件)。在<strong class="kx jh"> iOS </strong>上，聊天被导出为<code class="fe of og oh oi b">zip</code>。一旦你把它下载到你的电脑上，解压它以获得<code class="fe of og oh oi b">txt</code>。</p><figure class="ok ol om on gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oj"><img src="../Images/227d6aea9e064087ab5ff4176e6b7c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*tN5rH3L2wubhiLQvsCy61A.gif"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">左:<em class="oo"> Android 9，WhatsApp 2.20.123(自带源码，录屏)；右:iOS 12，WhatsApp 2.20.31(自带源码，好友</em> <a class="ae jd" href="https://www.instagram.com/sergidrum" rel="noopener ugc nofollow" target="_blank"> <em class="oo">塞尔吉的</em> </a> <em class="oo"> ) </em></p></figure></div><div class="ab cl nn no hu np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ij ik il im in"><h1 id="02d9" class="nu mc jg bd md nv nw nx mg ny nz oa mj km ob kn mm kp oc kq mp ks od kt ms oe bi translated">使用 python 库 whatstk</h1><p id="28d0" class="pw-post-body-paragraph kv kw jg kx b ky mu kh la lb mv kk ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated"><a class="ae jd" href="https://lcsrg.me/whatstk" rel="noopener ugc nofollow" target="_blank"> <strong class="kx jh"> whatstk </strong> </a>是一个<a class="ae jd" href="https://github.com/lucasrodes/whatstk/blob/master/LICENSE" rel="noopener ugc nofollow" target="_blank"> GPLv3 许可的</a> python 库，它是我帮助开发的，提供了探索、分析和可视化 WhatsApp 聊天的工具。它支持多种聊天格式，并分别使用<a class="ae jd" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>和<a class="ae jd" href="https://plotly.com/python/" rel="noopener ugc nofollow" target="_blank"> plotly </a>来处理和可视化数据。</p><p id="d4f9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">写这篇帖子的时候，最后一个稳定版本是<a class="ae jd" href="https://pypi.org/project/whatstk/0.4.1/" rel="noopener ugc nofollow" target="_blank"> 0.4.1 </a>。要安装它，只需使用画中画。</p><pre class="ok ol om on gt op oi oq or aw os bi"><span id="e4f6" class="mb mc jg oi b gy ot ou l ov ow">$ pip install whatstk</span></pre><p id="b2a7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="ma">要求至少 Python 3.7。</em></p><h2 id="8057" class="mb mc jg bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated">加载聊天</h2><p id="e530" class="pw-post-body-paragraph kv kw jg kx b ky mu kh la lb mv kk ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">我们将从使用类<code class="fe of og oh oi b">WhatsAppChat</code>及其方法<code class="fe of og oh oi b">from_source</code>将聊天加载到 python 开始。对于这个演示，我将使用我使用<a class="ae jd" href="https://whatstk.readthedocs.io/en/stable/source/api/whatstk.whatsapp.html#module-whatstk.whatsapp.generation" rel="noopener ugc nofollow" target="_blank">库工具</a>随机生成的<a class="ae jd" href="http://raw.githubusercontent.com/lucasrodes/whatstk/develop/chats/whatsapp/lorem-2000.txt" rel="noopener ugc nofollow" target="_blank">聊天</a>。以下是摘录:</p><pre class="ok ol om on gt op oi oq or aw os bi"><span id="cfd6" class="mb mc jg oi b gy ot ou l ov ow">[2019-04-16 02:09] +1 123 456 789: Et labore proident laboris do labore ex. <br/>[2019-04-16 03:01] Mary: Reprehenderit id aute consectetur aliquip nostrud culpa, fugiat ex deserunt magna, nostrud officia id aliquip in fugiat. 🇩🇰<br/>[2019-04-17 12:56] John: Amet magna officia ullamco pariatur ipsum cupidatat, laborum sint nostrud adipiscing sit. ✈<br/>[2019-04-17 13:30] Mary: Cillum aute et cupidatat ipsum, occaecat lorem sint tempor ullamco elit. 🏊🏻<br/>[2019-04-17 15:09] John: Eiusmod irure laboris dolore anim, velit velit proident qui commodo. <br/>[2019-04-17 17:55] Mary: Aute sed quis deserunt, veniam non veniam qui ipsum velit, aliqua sunt eu incididunt incididunt duis. 🤨</span></pre><p id="4a44" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在您的情况下，更改参数<code class="fe of og oh oi b">filepath</code>的值，使其指向您导出的聊天。聊天被自动解析，加载为数据帧并存储为类属性<code class="fe of og oh oi b">df</code>。</p><figure class="ok ol om on gt is"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="ea9d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">注意</strong>:如果您无法以这种方式加载您的聊天，您可能需要使用 hformat 输入参数手动指定您的聊天标题的<a class="ae jd" href="https://whatstk.readthedocs.io/en/stable/source/getting_started/hformat.html" rel="noopener ugc nofollow" target="_blank">格式</a><a class="ae jd" href="https://whatstk.readthedocs.io/en/stable/source/code_examples/load_chat_hformat.html" rel="noopener ugc nofollow" target="_blank">。对于我们的聊天，应该是这样的:</a></p><figure class="ok ol om on gt is"><div class="bz fp l di"><div class="ox oy l"/></div></figure><h2 id="ac33" class="mb mc jg bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated">首次数据概述</h2><p id="49fa" class="pw-post-body-paragraph kv kw jg kx b ky mu kh la lb mv kk ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">首先，我们将获得一些关于聊天活动的基本信息。</p><p id="760f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以获得第一个和最后一个发送消息的时间戳，这给了我们一个初始的时间上下文。接下来，我们获取每个用户发送的消息数量，以及聊天活动期间每天发送的消息量。为了完成这个，我们利用了 pandas 提供的工具，特别是它的<em class="ma"> groupby </em>方法。</p><figure class="ok ol om on gt is"><div class="bz fp l di"><div class="ox oy l"/></div></figure><p id="6da7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们注意到记录的聊天开始于 2019 年 4 月 16 日，结束于 2020 年 6 月 13 日。此外，朱塞佩和 2019 年 7 月 1 日似乎相当活跃！</p><h2 id="5468" class="mb mc jg bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated">谁说的最多？</h2><p id="4afb" class="pw-post-body-paragraph kv kw jg kx b ky mu kh la lb mv kk ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">现在，让我们仔细看看每个用户发送的消息数量。为此，我们使用类<code class="fe of og oh oi b">FigureBuilder</code>，它简化了生成和显示基于绘图的可视化的过程。</p><p id="b6b7" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们使用累积计数，这意味着对于给定的一天<em class="ma"> D </em>，我们对之前每个用户的所有干预进行计数。</p><figure class="ok ol om on gt is"><div class="bz fp l di"><div class="ox oy l"/></div></figure><figure class="ok ol om on gt is"><div class="bz fp l di"><div class="oz oy l"/></div></figure><p id="de65" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">虽然一个用户发送了很多消息，但这并不一定意味着他们发送了更多的字符。为了找出谁发送了最多的字符，我们可以使用函数的参数<code class="fe of og oh oi b">msg_len=False</code>。</p><figure class="ok ol om on gt is"><div class="bz fp l di"><div class="ox oy l"/></div></figure><figure class="ok ol om on gt is"><div class="bz fp l di"><div class="oz oy l"/></div></figure><h2 id="55c2" class="mb mc jg bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated">用户消息长度</h2><p id="6381" class="pw-post-body-paragraph kv kw jg kx b ky mu kh la lb mv kk ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">我们现在将看看每个用户发送的消息的长度，因为一些用户倾向于发送更少但更长的消息，而另一些用户发送几条短消息(那就是我)。</p><figure class="ok ol om on gt is"><div class="bz fp l di"><div class="ox oy l"/></div></figure><figure class="ok ol om on gt is"><div class="bz fp l di"><div class="oz oy l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">Mary 似乎有更高的中位数，这可能表明与聊天中的其他用户相比，他们倾向于发送更长的消息。使用平均值可能会产生误导，因为它会受到离群值(即长消息)的严重影响</p></figure><h2 id="f7a6" class="mb mc jg bd md me mf dn mg mh mi dp mj le mk ml mm li mn mo mp lm mq mr ms mt bi translated">用户交互</h2><p id="12a1" class="pw-post-body-paragraph kv kw jg kx b ky mu kh la lb mv kk ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">最后，最后一幅图展示了用户之间是如何互动的。具体来说，它显示了一个矩阵，该矩阵计算了从用户<em class="ma"> A </em>发送到用户<em class="ma">b</em>的响应数量。库做出<a class="ae jd" href="https://whatstk.readthedocs.io/en/stable/source/whatstk.analysis.html#whatstk.analysis.get_response_matrix" rel="noopener ugc nofollow" target="_blank">假设</a>消息<em class="ma"> n </em>总是对前一消息<em class="ma"> n-1 </em>的响应。虽然这可能与事实相去甚远，但它仍然设法捕捉到了某种现实。</p><figure class="ok ol om on gt is"><div class="bz fp l di"><div class="ox oy l"/></div></figure><figure class="ok ol om on gt is"><div class="bz fp l di"><div class="oz oy l"/></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">在这个随机生成的聊天中，我们观察到最大的消息流是从 Giuseppe 到+1 123 456 789。</p></figure><h1 id="59e6" class="nu mc jg bd md nv pa nx mg ny pb oa mj km pc kn mm kp pd kq mp ks pe kt ms oe bi translated">结论</h1><p id="317d" class="pw-post-body-paragraph kv kw jg kx b ky mu kh la lb mv kk ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">在这篇文章中，我们看到了如何用 python 加载 WhatsApp 聊天作为数据帧，并使用 plotly 可视化相关见解。可视化效果是使用工具生成的，但是，一旦聊天被加载，可能性是无限的。</p><p id="104b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我个人觉得这真的很有趣，因为每次我探索和分析 WhatsApp 聊天时，我最终都会使用一个独特的、动态的、可访问的数据集。</p><p id="9cb9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可以在这里查看这篇文章<a class="ae jd" href="https://gist.github.com/lucasrodes/f9a4183d769b7daacd9ea8405a5a08db" rel="noopener ugc nofollow" target="_blank">的代码。</a></p></div><div class="ab cl nn no hu np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ij ik il im in"><h1 id="244f" class="nu mc jg bd md nv nw nx mg ny nz oa mj km ob kn mm kp oc kq mp ks od kt ms oe bi translated">变更日志</h1><ul class=""><li id="c67d" class="mz na jg kx b ky mu lb mv le pf li pg lm ph lq ne nf ng nh bi translated">2020 年 7 月 30 日:文章发表。<code class="fe of og oh oi b">whatstk</code>版本 v0.3.1</li><li id="1693" class="mz na jg kx b ky ni lb nj le nk li nl lm nm lq ne nf ng nh bi translated">2021 年 5 月 27 日:修复断开的链接。<code class="fe of og oh oi b">whatstk</code>版本 0.4.1</li></ul></div><div class="ab cl nn no hu np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ij ik il im in"><h1 id="a300" class="nu mc jg bd md nv nw nx mg ny nz oa mj km ob kn mm kp oc kq mp ks od kt ms oe bi translated">参考</h1><p id="1c6a" class="pw-post-body-paragraph kv kw jg kx b ky mu kh la lb mv kk ld le mw lg lh li mx lk ll lm my lo lp lq ij bi translated">[1] Birgit Bucher，<a class="ae jd" href="https://www.messengerpeople.com/global-messenger-usage-statistics/" rel="noopener ugc nofollow" target="_blank"> WhatsApp，微信和 Facebook Messenger 应用——全球 Messenger 使用、渗透和统计</a>，Messenger People 2020，博客文章</p></div></div>    
</body>
</html>