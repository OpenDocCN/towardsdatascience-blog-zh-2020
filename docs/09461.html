<html>
<head>
<title>How to make a Coronavirus world map in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 Python 制作冠状病毒世界地图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-make-a-coronavirus-world-map-in-python-734c9fd87195?source=collection_archive---------36-----------------------#2020-07-06">https://towardsdatascience.com/how-to-make-a-coronavirus-world-map-in-python-734c9fd87195?source=collection_archive---------36-----------------------#2020-07-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="265f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">由 Pyecharts 库支持</h2></div><p id="1cd6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">新冠肺炎正在全世界传播。可视化数据的最佳方式之一是将数据映射到世界地图。幸运的是，很容易制作一个像下面这样的交互式地图。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/70444a1ba3296297bba65fe55b609416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-l_U8j2Sl23ksERdMjPOeQ.png"/></div></div></figure><p id="fc87" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一个动态图表，每当鼠标悬停在地图上时，数字就会显示出来。要创建这个图表，您只需要几行 Python 代码。</p><p id="8c99" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在编写这几行代码之前，您需要安装名为 Pyechart 的可视化包。这是一个 Python echarts 绘图库。它提供了 30 多种图表。最新版本是 1.7.1，发布于 2020 年 3 月 12 日。你可以 pip 安装它。</p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="da99" class="lv lw it lr b gy lx ly l lz ma">pip install pyecharts==1.7.1</span></pre><p id="f264" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">软件包安装完成后，我们就可以开始构建地图了。</p><p id="ab6b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">第一步:导入库</strong></p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="7447" class="lv lw it lr b gy lx ly l lz ma">#import libraries<br/>from pyecharts.charts import Map,Geo<br/>from pyecharts import options as opts<br/>from pyecharts.globals import ThemeType</span></pre><p id="d180" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">第二步:导入数据</strong></p><p id="99be" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">新冠肺炎的数据可以从<a class="ae mb" href="https://ourworldindata.org/coronavirus" rel="noopener ugc nofollow" target="_blank">我们的数据世界</a>网站下载。</p><p id="107e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该网站提供 CSV、CLSX 和 JSON 格式的完整新冠肺炎数据集。</p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="6e33" class="lv lw it lr b gy lx ly l lz ma">#import data<br/>dataset=pd.read_csv(‘owid-covid-data.csv’)</span></pre><p id="4ae0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我只会得到 2020 年 7 月 3 日的数据，然后将数据映射到世界地图上。</p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="650f" class="lv lw it lr b gy lx ly l lz ma">#change date from object data type to datetime data type<br/>dataset[‘date’]=pd.to_datetime(dataset[‘date’])<br/>df = dataset.sort_values(by=['date'], ascending=False) #sort data by date<br/>map_df=df[df['date']=='2020-07-03']<br/>map_df.reset_index(drop=True, inplace=True)<br/>map_df</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mc"><img src="../Images/c87909c24476ac88618c5bf6381cd717.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EgeoBfmuonOnwOdFp1wSOw.png"/></div></div></figure><p id="e1ba" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">第三步:创建数据可视化所需的两个数据序列</strong></p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="c0ce" class="lv lw it lr b gy lx ly l lz ma">country=list(map_df[‘location’])</span><span id="a2bc" class="lv lw it lr b gy md ly l lz ma">totalcases=list(map_df[‘total_cases’])</span></pre><p id="7c8e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">第四步:生成地图</strong></p><p id="d179" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有了 7 行，就会得到冠状病毒世界地图。</p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="f452" class="lv lw it lr b gy lx ly l lz ma">list1 = [[country[i],totalcases[i]] for i in range(len(country))] #prepare data for visualization<br/>map_1 = Map(init_opts=opts.InitOpts(width=”1000px”, height=”460px”)) #create the map and set the size of the map<br/>map_1.add(“Total Confirmed Cases”, list1, maptype=’world’) #add world map<br/>map_1.set_global_opts( #set global configurations<br/> visualmap_opts=opts.VisualMapOpts(max_=1100000,    is_piecewise=False),<br/> legend_opts=opts.LegendOpts(is_show=False), #show legend or not<br/> )<br/>map_1.render_notebook() #show the map in the notebook directly</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi me"><img src="../Images/ff9105bc65fe670bf6f994e0b85585d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SrHfjpjw9PffCPXhQHHpmg.png"/></div></div></figure><p id="c938" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这张地图看起来有点乱。我们需要自定义美化地图。</p><p id="c476" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mf"> 4.1 从地图上删除国家名称</em></p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="db2b" class="lv lw it lr b gy lx ly l lz ma">list1 = [[country[i],totalcases[i]] for i in range(len(country))] <br/>map_1 = Map(init_opts=opts.InitOpts(width=”1000px”, height=”460px”)) <br/>map_1.add(“Total Confirmed Cases”, <br/> list1, maptype=’world’) <br/>map_1.set_series_opts(label_opts=opts.LabelOpts(is_show=False)) #remove country names<br/>map_1.set_global_opts(visualmap_opts=opts.VisualMapOpts(max_=1100000,is_piecewise=False),<br/> legend_opts=opts.LegendOpts(is_show=False))<br/>map_1.render_notebook() </span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mg"><img src="../Images/a20860c3fad71d4fd8d55c33f3394e68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KLvJYq1dxKAd8nvs1yHMMg.png"/></div></div></figure><p id="664f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mf"> 4.2 从地图上移除圆点</em></p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="5b80" class="lv lw it lr b gy lx ly l lz ma">list1 = [[country[i],totalcases[i]] for i in range(len(country))] <br/>map_1 = Map(init_opts=opts.InitOpts(width=”1000px”, height=”460px”)) <br/>map_1.add(“Total Confirmed Cases”, <br/> list1, <br/> maptype=’world’,<br/> is_map_symbol_show=False)<br/>map_1.set_series_opts(label_opts=opts.LabelOpts(is_show=False)) <br/>map_1.set_global_opts(visualmap_opts=opts.VisualMapOpts(max_=1100000,is_piecewise=False),<br/> legend_opts=opts.LegendOpts(is_show=False))<br/>map_1.render_notebook() </span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mh"><img src="../Images/730beb3387afeb9b6e7faaf283fe5a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GiKVQ-7u4t4pblwuYyl21w.png"/></div></div></figure><p id="0c6b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mf"> 4.3 将图例从滑动条更改为颜色箱</em></p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="9d6c" class="lv lw it lr b gy lx ly l lz ma">list1 = [[country[i],totalcases[i]] for i in range(len(country))] <br/>map_1 = Map(init_opts=opts.InitOpts(width=”1000px”, height=”460px”)) <br/>map_1.add(“Total Confirmed Cases”, <br/> list1, <br/> maptype=’world’,<br/> is_map_symbol_show=False) <br/>map_1.set_series_opts(label_opts=opts.LabelOpts(is_show=False)) <br/>map_1.set_global_opts(visualmap_opts=opts.VisualMapOpts(max_=1100000,is_piecewise=True,pieces=[<br/> {“min”: 500000},<br/> {“min”: 200000, “max”: 499999},<br/> {“min”: 100000, “max”: 199999},<br/> {“min”: 50000, “max”: 99999},<br/> {“min”: 10000, “max”: 49999},<br/> {“max”: 9999},]),<br/> legend_opts=opts.LegendOpts(is_show=False))<br/>map_1.render_notebook() </span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mi"><img src="../Images/09267f6e9b26a68973b982226ab26070.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k0wpxsea6gVGCtX6JgJT6A.png"/></div></div></figure><p id="76a7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mf"> 4.4 给地图添加标题和副标题</em></p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="6f01" class="lv lw it lr b gy lx ly l lz ma">list1 = [[country[i],totalcases[i]] for i in range(len(country))] <br/>map_1 = Map(init_opts=opts.InitOpts(width=”1000px”, height=”460px”)) <br/>map_1.add(‘Total Confirmed Cases’, <br/> list1,<br/> maptype=’world’,<br/> is_map_symbol_show=False)<br/>map_1.set_series_opts(label_opts=opts.LabelOpts(is_show=False)) <br/>map_1.set_global_opts(<br/>visualmap_opts=opts.VisualMapOpts(max_=1100000,is_piecewise=True,pieces=[<br/> {“min”: 500000},<br/> {“min”: 200000, “max”: 499999},<br/> {“min”: 100000, “max”: 199999},<br/> {“min”: 50000, “max”: 99999},<br/> {“min”: 10000, “max”: 49999},<br/> {“max”: 9999},]),<br/> title_opts=opts.TitleOpts(<br/> title='Covid-19 Worldwide Total Cases',<br/> subtitle=’Till July 05th,2020',<br/> pos_left=’center’,<br/> padding=0,<br/> item_gap=2,# gap between title and subtitle <br/> title_textstyle_opts= opts.TextStyleOpts(color=’darkblue’,<br/> font_weight=’bold’,<br/> font_family=’Courier New’,<br/> font_size=30), <br/> subtitle_textstyle_opts= opts.TextStyleOpts(color=’grey’,<br/> font_weight=’bold’,<br/> font_family=’Courier New’,<br/> font_size=13)), <br/> legend_opts=opts.LegendOpts(is_show=False))<br/>map_1.render_notebook() </span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/70444a1ba3296297bba65fe55b609416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-l_U8j2Sl23ksERdMjPOeQ.png"/></div></div></figure><p id="6879" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过向主题参数传递不同的值，可以很容易地更改地图的整体外观。</p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="b4ad" class="lv lw it lr b gy lx ly l lz ma">list1 = [[country[i],totalcases[i]] for i in range(len(country))] <br/>map_1 = Map(init_opts=opts.InitOpts(width=”1000px”, height=”460px”<strong class="lr iu">,theme=ThemeType.ROMANTIC</strong>)) <br/>map_1.add(‘Total Confirmed Cases’, <br/> list1,<br/> maptype=’world’,<br/> is_map_symbol_show=False)<br/>map_1.set_series_opts(label_opts=opts.LabelOpts(is_show=False)) <br/>map_1.set_global_opts(<br/>visualmap_opts=opts.VisualMapOpts(max_=1100000,is_piecewise=True,pieces=[<br/> {“min”: 500000},<br/> {“min”: 200000, “max”: 499999},<br/> {“min”: 100000, “max”: 199999},<br/> {“min”: 50000, “max”: 99999},<br/> {“min”: 10000, “max”: 49999},<br/> {“max”: 9999},]),<br/> title_opts=opts.TitleOpts(<br/> title=”Covid-19 Worldwide Total Cases”,<br/> subtitle=’Till July 03rd,2020',<br/> pos_left=’center’,<br/> padding=0,<br/> item_gap=2,<br/> title_textstyle_opts= opts.TextStyleOpts(color=’darkblue’,<br/> font_weight=’bold’,<br/> font_family=’Courier New’,<br/> font_size=30), <br/> subtitle_textstyle_opts= opts.TextStyleOpts(color=’grey’,<br/> font_weight=’bold’,<br/> font_family=’Courier New’,<br/> font_size=13)), <br/> legend_opts=opts.LegendOpts(is_show=False))<br/>map_1.render_notebook()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mj"><img src="../Images/433ded1f3feb9aeffef9a23fd0dd9f25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lW28WrlAaMkvDh0CrLQSDA.png"/></div></div></figure><p id="8079" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有许多选项和参数可供您探索和尝试，以进一步美化您的地图。</p><p id="df06" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">享受 Python 中的数据可视化！</p></div></div>    
</body>
</html>