<html>
<head>
<title>Midnight Hack 2: Contextual search &amp; grouping Emojis using Document Embedding</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">午夜黑客 2:使用文档嵌入的上下文搜索和表情分组</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/midnight-hack-episode-2-contextual-search-grouping-of-emojis-using-document-embedding-9bee5bbed6cc?source=collection_archive---------35-----------------------#2020-02-16">https://towardsdatascience.com/midnight-hack-episode-2-contextual-search-grouping-of-emojis-using-document-embedding-9bee5bbed6cc?source=collection_archive---------35-----------------------#2020-02-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/5c3f9ef6123265c7a3494912c04c2738.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bZ09tZQ9YvbxFtgSLgHV0Q.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">引文:<a class="ae kf" href="http://www.satandigital.com/apps/EmojiPlot/" rel="noopener ugc nofollow" target="_blank">http://www.satandigital.com/apps/EmojiPlot/</a></p></figure><p id="c630" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你好。！！欢迎来到我又一个愚蠢的项目。</p><p id="58a6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以前几天我在用<a class="ae kf" href="https://www.whatsapp.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu"> Whatsapp </strong> </a> <strong class="ki iu"> </strong>的时候，发现这个用关键词查找表情符号的很酷的小功能真的很有趣。现在，我很确定他们没有使用机器学习来实现这一点，这很可能是硬编码关键词和表情符号的简单映射。</p><p id="1cc2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，如果你能更进一步，不把搜索功能局限于那些预定义的关键词，而是根据搜索关键词的上下文含义来搜索表情符号，那会怎么样呢？</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="a74d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">懒得通读？<strong class="ki iu">你可以在这里查看表情图:</strong><a class="ae kf" href="http://www.satandigital.com/apps/EmojiPlot/" rel="noopener ugc nofollow" target="_blank">http://www.satandigital.com/apps/EmojiPlot/</a></p><p id="ffd8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该图具有缩放和平移功能。单击并拖动鼠标进行缩放，使用 shift 键进行平移。</p><p id="fd73" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">并且抓取的数据集托管在这里:</strong><a class="ae kf" href="https://github.com/AtomicSpider/Emoji-Dataset" rel="noopener ugc nofollow" target="_blank">https://github.com/AtomicSpider/Emoji-Dataset</a></p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="f920" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该项目有 4 个部分:</p><ol class=""><li id="51b4" class="ll lm it ki b kj kk kn ko kr ln kv lo kz lp ld lq lr ls lt bi translated">准备表情数据集</li><li id="eb5a" class="ll lm it ki b kj lu kn lv kr lw kv lx kz ly ld lq lr ls lt bi translated">生成表情符号的矢量或数字表示</li><li id="d149" class="ll lm it ki b kj lu kn lv kr lw kv lx kz ly ld lq lr ls lt bi translated">在 2D 空间绘制表情符号</li><li id="92ff" class="ll lm it ki b kj lu kn lv kr lw kv lx kz ly ld lq lr ls lt bi translated">编写搜索脚本</li></ol></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><ol class=""><li id="10ef" class="ll lm it ki b kj kk kn ko kr ln kv lo kz lp ld lq lr ls lt bi translated"><strong class="ki iu">准备表情数据集:</strong></li></ol><p id="94e1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个简单的谷歌搜索把我带到了 https://unicode.org/，那里有所有表情符号、图像、Unicode ids、base64 数据 URIs 和名字的综合列表。</p><p id="6f97" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我编写了一个简单的 web 抓取脚本来下载所有的图像和元数据，并创建了一个主数据集 JSON，它也引用了图像文件。</p><p id="ebfb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据集可以在这里找到:<a class="ae kf" href="https://raw.githubusercontent.com/AtomicSpider/Emoji-Dataset/master/dataset/dataset.json" rel="noopener ugc nofollow" target="_blank">https://raw . githubusercontent . com/atomic spider/e moji-Dataset/master/Dataset/Dataset . JSON</a></p><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="md me l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">生成表情数据集的脚本</p></figure><p id="eb3c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 2。生成表情符号的矢量或数字表示:</strong></p><p id="8813" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我遇到了<a class="ae kf" href="https://radimrehurek.com/gensim/models/word2vec.html" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">word 2 vec</strong></a><strong class="ki iu">，</strong>一个两层的神经网络，它可以提取单词并生成单词的多维向量表示。</p><p id="3c26" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">word2vec、<a class="ae kf" href="https://radimrehurek.com/gensim/models/doc2vec.html" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu"> doc2vec </strong> </a> <strong class="ki iu">、</strong>的文档等效，工作原理类似。doc2vec 获取文档或一组单词，并生成它的多维向量表示。</p><p id="4918" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我决定使用 doc2vec，从表情符号名称中提取关键词，并为每个表情符号生成 300 维向量。</p><p id="7236" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">表情符号名称可以直接用作 doc2vec 模型的输入，但我继续使用<strong class="ki iu"> nltk </strong>(自然语言工具包)从名称中删除停用词以实现更好的准确性。</p><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="md me l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">生成表情矢量的脚本</p></figure><p id="b190" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 3。2D 空间的剧情表情符号:</strong></p><p id="b9f2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">酷！！！现在我们有了矢量数据，绘图应该很容易，对吗？对吗？？</p><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="mf me l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">引用:图片来自 giphy.com(<a class="ae kf" href="https://giphy.com/gifs/the-office-mrw-d10dMmzqCYqQ0" rel="noopener ugc nofollow" target="_blank">https://giphy.com/gifs/the-office-mrw-d10dMmzqCYqQ0</a>)</p></figure><p id="4c92" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">事实上，这部分花了我不少时间才弄明白。第一个问题是:你如何绘制 300 维的向量？</p><p id="2a8c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">经过相当多的研究，我决定使用<a class="ae kf" href="https://scikit-learn.org/stable/modules/generated/sklearn.manifold.TSNE.html" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">tSNE</strong></a><strong class="ki iu"/>并减少生成的表情向量的维数。</p><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="4c1b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对！！！现在我们有了绘图数据，用表情符号生成一个简单的散点图就很容易了，对吗？对吗？？对吗？？？</p><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="mg me l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">引用:图片来自 giphy.com(<a class="ae kf" href="https://media.giphy.com/media/26DOzMVt4i9GzzxyE/source.gif" rel="noopener ugc nofollow" target="_blank">https://media.giphy.com/media/26DOzMVt4i9GzzxyE/source.gif</a>)</p></figure><p id="1042" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">问题是，我想用表情符号作为分散点的自定义标记。遗憾的是 python 对此没有很好的支持。</p><p id="dc7e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">R 中有一个库，<strong class="ki iu"> ggplot </strong>可以和<a class="ae kf" href="https://github.com/dill/emoGG" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">dill/e mogg</strong></a><strong class="ki iu"/>一起使用来生成表情符号标记，但是剧情看起来不太好。此外，没有平移和缩放功能。</p><p id="5048" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以我决定使用<a class="ae kf" href="https://www.highcharts.com/" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">high charts</strong></a><strong class="ki iu">导出数据和绘图。感谢我的同事 Vinoth，他帮助我弄清楚了如何在 HighCharts 中使用自定义标记。</strong></p><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="md me l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">导出高图表绘图的数据</p></figure><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="md me l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">用于绘制表情散点图的 Javascript 代码</p></figure><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/5c3f9ef6123265c7a3494912c04c2738.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bZ09tZQ9YvbxFtgSLgHV0Q.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">引文:<a class="ae kf" href="http://www.satandigital.com/apps/EmojiPlot/" rel="noopener ugc nofollow" target="_blank">http://www.satandigital.com/apps/EmojiPlot/</a></p></figure><p id="1c61" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">剧情页面可以在这里进入:<a class="ae kf" href="http://www.satandigital.com/apps/EmojiPlot/" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu"/></a></p><p id="a446" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如你所看到的，我们采用的方法能够很好地对表情符号进行分组。可以看到所有的旗帜在左边组合在一起，动物在中间上方，食物在右上方，表情符号在右边等等。</p><p id="6c1e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 4。写一个搜索脚本:</strong></p><p id="fa62" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于从关键词中搜索表情符号，我们可以使用相同的 doc2vec 模型将搜索关键词转换为向量，并从表情符号向量列表中找到该向量的最近邻居。</p><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="md me l"/></div></figure></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="3d93" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">结果:</strong></p><p id="33e7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你在 WhatsApp 的表情键盘上搜索快乐情绪，它不会产生任何结果。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mh"><img src="../Images/2888c7f891fc0a9362422f69bdb90a78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jmfrNB56frn0tG9pwayJXw.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">引用:截图来自我的手机</p></figure><p id="0af7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是通过我们的方法，我们能够用上下文信息搜索相关的表情符号，而不是硬编码的关键字映射。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/e20a74872dd3e906e2c936b4885717be.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*C21Q0_Eh4GpPRUGRR_yFQQ.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">引用:截图来自我的笔记本电脑</p></figure><p id="fc19" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我的失眠之夜就此结束😁。</p></div></div>    
</body>
</html>