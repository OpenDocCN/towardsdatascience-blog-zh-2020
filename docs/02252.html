<html>
<head>
<title>Market Anomalies on the Oslo Stock Exchange</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">奥斯陆证券交易所的市场异常现象</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/market-anomalies-on-the-oslo-stock-exchange-40ce29886ed7?source=collection_archive---------18-----------------------#2020-03-03">https://towardsdatascience.com/market-anomalies-on-the-oslo-stock-exchange-40ce29886ed7?source=collection_archive---------18-----------------------#2020-03-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0b3f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用Python分析挪威股票市场的日历效应</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1dd0261c437e2ce6c3ec7631a9b566a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rZ24yjVTlGr8jidPJUEjJw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">致谢:乔治·雷克斯，Flickr</p></figure><h1 id="d18b" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">有效市场假说</h1><p id="0217" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">EMH是一个经济假说，认为资产价格完全反映在可获得的信息中。假设这是真的，我们不能用过去来预测未来，因为所有的运动都是新信息的结果。更有可能的是，人类行为效应导致了市场的低效率，尽管价格发现更快的发达市场加剧了这种低效率。</p><h1 id="62fb" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">市场异常</h1><p id="541a" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">市场异常是指如果EMH是真实的，就不会发生的任何可见的影响。有数不清的可能异常，一些比另一些有更多的研究支持。与日历相关的影响得到了很好的研究，其中包括:</p><ul class=""><li id="d328" class="mj mk iq lp b lq ml lt mm lw mn ma mo me mp mi mq mr ms mt bi translated">万圣节效应(在万圣节和1。5月份，今年剩余时间出售)</li><li id="0c69" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">圣诞老人集会(圣诞节和新年之间价格飙升)</li><li id="cd26" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">岁末效应(股票价格从年末到下一年上涨的趋势，类似于圣诞老人涨势)</li><li id="758e" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">一月效应(建立在一年之交的基础上，股票在一月份表现优于其他月份的趋势)</li><li id="1730" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">周末效应(周一的市场回报低于前一个周五)</li><li id="cdce" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">月末效应(股票价格在月末上升到下个月的趋势)</li></ul><p id="312e" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">如果这些异常情况存在，为什么？可能与机构何时重新平衡投资组合有关。发薪日可能会有影响，在接近发薪日时增加销售，而在发薪日之后增加销售。投资者想要在年底买入或卖出可能有与税收相关的原因。在挪威，你可以根据股票市场的损失获得减税，并为收益缴税。因为这是按31计算的。12月份，有利于在年底前出售失败者，更快地获得税收优惠，并在新的一年出售获胜者，让你等待一年的纳税。如果这些影响大到足以创造一个有利可图的异常，那就是另一个问题了，需要进一步研究。</p><p id="dd4f" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">关于这些影响的更多信息，请查看Investopedia:<br/>https://www.investopedia.com/terms/a/anomaly.asp</p><h1 id="52c6" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">工作日、月份、月份中的某一天</h1><p id="1875" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">我们将使用奥斯陆证券交易所指数(OSEBX)的每日股票价格来探索Python中可能的季节性趋势。比较每个工作日的回报，每月的回报，以及每月的一天。我们使用每日收盘，因此回报将是从前一天收盘到当天收盘的价格变化百分比。如果我们发现异常，这能为我们所用吗？</p><h1 id="c088" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">用Python获取和处理数据</h1><p id="0f05" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">数据从奥斯陆证券交易所的网站下载:</p><div class="nc nd gp gr ne nf"><a href="https://www.oslobors.no/markedsaktivitet/#/details/OSEBX.OSE/overview" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">Markedsaktivitet</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">奥斯陆仪表、衍生和租赁生产商</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">www.oslobors.no</p></div></div></div></a></div><p id="c849" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">在导入适当的库之后，我们将数据加载到pandas数据框架中。该数据包括1996年以来的每日收盘数据。这不是最长的时间序列，但在处理金融时间序列时，更长的时间框架并不总是更好。50年前发生的任何异常现象现在可能都已经消失了。</p><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="fbbb" class="nt kw iq np b gy nu nv l nw nx">import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import matplotlib as mpl</span><span id="79c0" class="nt kw iq np b gy ny nv l nw nx">import warnings<br/>warnings.filterwarnings(“ignore”)</span><span id="3f91" class="nt kw iq np b gy ny nv l nw nx"># Import osbx (Oslo stock exchange index, OSEBX)<br/>osbx = pd.read_excel(“osbx.xlsx”)<br/>osbx.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/c6035471161a8c49b9461265ff32fc20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*t12n09-f4LNAobflGuUUUQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">OSE指数的价格数据，请原谅挪威人</p></figure><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="a4f5" class="nt kw iq np b gy nu nv l nw nx"># revese the order of the DataFrame<br/>osbx = osbx.iloc[::-1]</span><span id="0cd7" class="nt kw iq np b gy ny nv l nw nx"># only keep daily close<br/>osbx = osbx[[“OSEBX”, “Siste”]]</span><span id="5795" class="nt kw iq np b gy ny nv l nw nx"># rename columns<br/>osbx.rename(columns={“OSEBX”: “Date”, “Siste”: “Close”}, inplace=True)</span><span id="2b86" class="nt kw iq np b gy ny nv l nw nx"># change the index to Date<br/>osbx.set_index(“Date”, inplace=True)</span><span id="915a" class="nt kw iq np b gy ny nv l nw nx"># calculate daily returns and add to the DataFrame<br/>osbx[“return”] = osbx[“Close”].pct_change()</span><span id="7897" class="nt kw iq np b gy ny nv l nw nx"># remove the first row, as it is nan<br/>osbx.dropna(inplace=True)<br/>osbx.head(10)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/d9d64e6475203e11be290648f129c5d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*j4o6VO64Sdda8mavwzC9gw.png"/></div></figure><p id="56c7" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">绘制整个时期的价格序列</p><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="9f40" class="nt kw iq np b gy nu nv l nw nx">osbx[“Close”].plot(figsize=(15,6), title=”Oslo stock exchange index price since 1996")</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/5b0b3a8d0f6e02dee2e7746492826aad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EbNKAeLs6WOglwZuPdCs8Q.png"/></div></div></figure><p id="9e86" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">展开数据框架以包括工作日、月份和年份。</p><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="bd9c" class="nt kw iq np b gy nu nv l nw nx"># Exclude 2020 onwards, only keeping the whole years 1996 through 2019<br/>osbx = osbx[“1996”:”2019"]</span><span id="e345" class="nt kw iq np b gy ny nv l nw nx"># Determine the weekday and add it as a new column to the DataFrame<br/>osbx[“Weekday”] = osbx.index.weekday.values<br/>osbx[“Weekday”] = osbx[“Weekday”].apply(lambda x: calendar.day_name[x])</span><span id="c617" class="nt kw iq np b gy ny nv l nw nx"># Determine the month and add it as a new column to the DataFrame<br/>osbx[“Month”] = osbx.index.month.values<br/>osbx[“Month”] = osbx[“Month”].apply(lambda x: calendar.month_name[x])</span><span id="299e" class="nt kw iq np b gy ny nv l nw nx"># Determine the year, convert it to string, and add it as a new column to the DataFrame<br/>osbx[“Year”] = osbx.index.year.values<br/>osbx[“Year”] = osbx[“Year”].astype(str)</span><span id="97ca" class="nt kw iq np b gy ny nv l nw nx">osbx.head(10)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/3380ff8656e0a5cdb62601c81b3e9782.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*kWGNNvDhun12pOD3Tgc9MQ.png"/></div></figure><h1 id="d2ac" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">平日</h1><p id="6427" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">首先，我们想探索一种趋势的可能性，这种趋势取决于一周中的某一天。若要计算平均值，请按工作日列分组并计算平均值。然后在周一到周五重新排序。</p><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="29bc" class="nt kw iq np b gy nu nv l nw nx"># Mean return for each weekday<br/>osbx_weekday_mean = osbx.groupby(“Weekday”).mean()</span><span id="484c" class="nt kw iq np b gy ny nv l nw nx"># Reorder<br/>osbx_weekday_mean = osbx_weekday_mean.reindex([“Monday”, “Tuesday”, “Wednesday”, “Thursday”, “Friday”])<br/>osbx_weekday_mean</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/ceab53580ca7973dc3a04d14f3a0ee91.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*N7tSplfvcXozgvS2taSimA.png"/></div></figure><p id="0c3b" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">周一、周二和周四的平均回报率都差不多，而周三的回报率接近于零，周五的回报率更高。让我们用两种不同的方式来绘制它，以便更好地了解分布情况。首先让我们单独查看工作日的平均值，然后使用散点图来查看每个工作日的回报是如何分布的。</p><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="951e" class="nt kw iq np b gy nu nv l nw nx">x = osbx[“Weekday”]<br/>y = 100*osbx_weekday_mean[“return”]</span><span id="cc42" class="nt kw iq np b gy ny nv l nw nx"># reorder<br/>osbx_weekday_mean = osbx_weekday_mean.reindex([“Monday”, “Tuesday”, “Wednesday”, “Thursday”, “Friday”])<br/>osbx_weekday_mean</span><span id="7974" class="nt kw iq np b gy ny nv l nw nx"># barplot of the average return for each week day<br/>import seaborn as sns<br/>sns.set_palette(“pastel”)<br/>fig, ax = plt.subplots(figsize=(15,6))<br/>ax = sns.barplot(x=osbx_weekday_mean.index, y=y, data=osbx_weekday_mean)<br/>ax = plt.ylabel(“Return (%)”, size=15)<br/>ax = plt.title(“Average daily return for each weekday in 1996 through 2019”, size=20)<br/>plt.savefig(‘osbx1.png’)<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/7c6c40a8305de66aa54287310273a60b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d1akcBSFKVKPflBWejc2Iw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">带有彩色调色板的Seaborn绘图库</p></figure><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="6fb5" class="nt kw iq np b gy nu nv l nw nx"># Scatter plot of all observations to see the variations for each weekday<br/>x = osbx[“Weekday”].values<br/>y = 100*osbx[“return”].values</span><span id="e2f5" class="nt kw iq np b gy ny nv l nw nx">days = [‘Monday’, ‘Tuesday’, ‘Wednesday’, ‘Thursday’, ‘Friday’]<br/>points = [[x[i], y[i]] for i in range(0,len(x))]<br/>for i in range(0,len(points)):<br/> points[i][0] = days.index(points[i][0])+1<br/> <br/>x = [points[i][0] for i in range(0,len(points))]<br/>y = [points[i][1] for i in range(0,len(points))]</span><span id="8d15" class="nt kw iq np b gy ny nv l nw nx">fig = plt.figure(figsize=(15,6))<br/>ax = plt.scatter(x, y, color=”green”, linewidths=3, marker=”x”, s=30)<br/>ax = plt.scatter([1,2,3,4,5], osbx_weekday_mean[“return”], color=”blue”, marker=”*”, s=100)<br/>ax = plt.ylabel(“Return (%)”, size=15)<br/>ax = plt.title(“Daily returns for each weekday for 1996 through 2019”, size=20)<br/>plt.savefig(‘osbx2.png’)<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/0cddf50a0cae251adb69285184ff76ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HUkEDJrqDzcK2lfSADqMew.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">散点图显示按工作日排序的每日回报分布。请注意，星期一是最后一天</p></figure><p id="34e1" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">现在计算波动率，并计算每个工作日的观察次数</p><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="f537" class="nt kw iq np b gy nu nv l nw nx"># Volatility of the returns for each weekday<br/>osbx[“return”] = osbx[“return”]<br/>weekday_vol = osbx[[“Weekday”, “return”]].groupby(“Weekday”).std()<br/>print(weekday_vol)<br/>print()</span><span id="acbd" class="nt kw iq np b gy ny nv l nw nx"># Number of weekdays<br/>print(osbx[[“Weekday”, “return”]].groupby(“Weekday”).count())</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/afa8f1a2c03333a5454b0d378ca7b9ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*bidfyF37qOHIfnggVyWuag.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">一周中每一天的波动性和计数</p></figure><p id="de1b" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">由于市场在此期间增长了800%以上，我们预计每个工作日的平均日回报都是正的，并且有大致相同的回报。周一有点特殊，因为它紧接在周末之后，这意味着周末的风险会延续到周一，因此它应该有3天的风险。隔夜风险使投资者暴露于国际市场的事件，这表明周五将有更多抛售，这将推动价格下跌。由于市场在此期间随着时间的推移而上涨，我们也应该期待看到从周五收盘到周一收盘价的更高回报，以及更高的波动性。然而，相反的事情正在发生。周一的波动性比预期的要高，但回报率却没有提高。一个可能的原因可能是临近周末时人们的情绪，乐观情绪的增加会导致更多的购买，但我对此一点也不自信。</p><p id="b2f2" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">为了解释周五和周一之间比一周其他时间更长的时间，一个更准确的分析将改为查看每天从开盘到收盘的回报。</p><h1 id="7a8f" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">统计学意义？</h1><p id="cbb1" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">现在，我们想使用t检验来测试每个工作日的平均回报是否与所有工作日的平均回报在统计上有显著差异。假设μᵢ是工作日I的所有回报的平均值。将零假设定义为μᵢ与大平均值相同，即所有日期的平均每日回报:</p><p id="5b58" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">H₀: μᵢ =大平均<br/> H₁: μᵢ ≠大平均</p><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="f293" class="nt kw iq np b gy nu nv l nw nx"># Perform statistical analysis<br/>from scipy import stats</span><span id="d166" class="nt kw iq np b gy ny nv l nw nx">average_return = osbx_weekday_mean[“return”].mean()</span><span id="f9f3" class="nt kw iq np b gy ny nv l nw nx">for day in osbx_weekday_mean.index.values:<br/> sample = np.array(osbx[osbx.Weekday == day][“return”])<br/> print(day,”:”, stats.ttest_1samp(sample, average_return))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/62c551d79d37f9b2e34ca4e46a255589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZOyXEqrNMrsG5hQpzwPNKw.png"/></div></div></figure><p id="63d6" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">周五的p值为0.0696，对应的置信度为93.04%。虽然这在大多数实际情况下不会被认为是重要的，但深入研究这种机制并看看这背后是否有什么东西会很有趣，但它可能只是噪音。运行5次测试，我们只有大约70%的概率看不到低于0.0696的p值(0.9304⁵= 0.6972……)。</p><p id="610f" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">我们来逐年比较一下。模式一致吗？</p><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="2001" class="nt kw iq np b gy nu nv l nw nx">years = range(1996, 2020)<br/>nr_rows = 6<br/>nr_cols = 4<br/>fig, axs = plt.subplots(nr_rows, nr_cols, figsize=(nr_cols*4,nr_rows*3), squeeze=False)</span><span id="0810" class="nt kw iq np b gy ny nv l nw nx">axis = []<br/>for r in range(0,nr_rows):<br/> for c in range(0,nr_cols):<br/> axis.append(axs[r][c])</span><span id="ba5c" class="nt kw iq np b gy ny nv l nw nx">count = 0<br/>for year in years:<br/> osbx_year = osbx[str(year)]<br/> # Mean return for each weekday<br/> osbx_year = osbx_year.groupby(“Weekday”).mean()<br/> # reorder<br/> osbx_year = osbx_year.reindex([“Monday”, “Tuesday”, “Wednesday”, “Thursday”, “Friday”])<br/> # plot<br/> sns.barplot(x=[1,2,3,4,5], y=”return”, data=osbx_year, ax=axis[count])<br/> plt.ylabel(‘Number of Occurrences’, fontsize=12)<br/> axis[count].legend([str(years[count])])<br/> count = count + 1</span><span id="9d49" class="nt kw iq np b gy ny nv l nw nx">fig.suptitle(“Average OSBX returns for each weekday by year from 1996 through 2019”, size=20)<br/>plt.tight_layout()<br/>fig.subplots_adjust(top=0.93)<br/>plt.savefig(‘osbx3.png’)<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/221237e50e49a57388c4c9b1f004f439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VUylsPcEY0VhHbw8DYEMHQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">周一至周五，每年所有交易日的平均值</p></figure><p id="d40d" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">24年中只有7年星期五比其他日子好。由于一年有52周，减去一些公共假期，我希望看到“星期五效应”更加一致。</p><p id="eecc" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">周五的表现排名:</p><ul class=""><li id="2529" class="mj mk iq lp b lq ml lt mm lw mn ma mo me mp mi mq mr ms mt bi translated">最佳表演:7次</li><li id="ffad" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">2.最佳表演:6次</li><li id="8b65" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">中等表现者:4次</li><li id="f31c" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">2.表现最差:6次</li><li id="df7b" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">表现最差:1次</li></ul><h1 id="2dff" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">月度回报</h1><p id="a90a" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">我们分析的第二步是比较每月的回报。某些月份的回报比其他月份好吗？</p><p id="9b06" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">剩下的代码类似，但是你可以在我的github找到完整的笔记本。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/bee9c35458076f9253c34ea618210c14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zUv5ISLik4TFP2EDgiVeaQ.png"/></div></div></figure><p id="dc1d" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">几乎像波浪状分布。虽然一月似乎不是很高，但十二月表现良好。也许是圣诞老人集会推高了12月份的价格？从历史数据来看，万圣节效应似乎是有利可图的，因为唯一的负回报发生在6月至9月。</p><p id="9eda" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">每个月的分配情况如何？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/460793a2f09ec80105fcb886e9892f80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rQGaeUGQfO36QStUilWnLg.png"/></div></div></figure><p id="99b5" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">除了经历大幅下跌的几个月，每个月的波动性看起来都差不多。让我们看看每年的月回报</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/3755d581faf86c406c61f073841ed38e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VZsYtGmzysLVRbhMfjpjDA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">从1996年到2019年的月度回报柱状图，x轴标注为1-12，代表1-12月</p></figure><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="6832" class="nt kw iq np b gy nu nv l nw nx"># average monthly return over all months<br/>average_return = osbx_month_returns.mean()<br/>average_return[0]</span></pre><p id="634e" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">输出:0.00928467867</p><p id="ab4d" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">约1%的平均月回报率。让我们用t检验来测试每个月相对于平均值的表现。通过运行12个测试，请注意，我们需要一个较低的p值来拒绝空值。使用临界值0.05，假设空值为真，我们在至少一个测试上拒绝空值的概率实际上是1-0.95 ~46%。为了达到95%没有错误拒绝，我们实际上需要大约0.004的个体p值。</p><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="ecf9" class="nt kw iq np b gy nu nv l nw nx">for month in months:<br/> sample = osbx_returns[osbx_returns.Month == month][“return”]<br/> print(month,”:”, stats.ttest_1samp(sample, average_return))<br/> print()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/06655b820a4cb03eeed2ad55433dfb30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2VcxWMXKF1ugJx9Et_w2gQ.png"/></div></div></figure><p id="1144" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">4月的p值最低，为0.0297，12月为0.0538。其余月份的值不重要。但是如前所述。当我们进行如此多的测试时，0.0297并没有低到有意义的程度。</p><p id="b1ae" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">月度回报分析的一个明显缺陷是缺乏样本。我们只有24次观察，每年一次。使用更长的时间框架可能是有趣的，但范式会改变，如果市场异常变得众所周知，它会很快被利用和消除。随着市场变得越来越有效，找到这样的模式变得越来越困难。</p><h1 id="f990" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">一月中的某一天</h1><p id="1de4" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">最后，让我们看看一个月中的某一天。</p><pre class="kg kh ki kj gt no np nq nr aw ns bi"><span id="83ea" class="nt kw iq np b gy nu nv l nw nx"># mean return of each day of the month (note that 31 will have a smaller sample size)<br/>day_of_month_return = osbx[[“return”]].groupby(osbx.index.day).mean()<br/>day_of_month_return.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/c7a1e28fdbeb0517eb2f48cf6897c987.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*n4r3zSZgkRz-OebInc_qUA.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/3436dc91db1a84c3ab35362b22911cb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Td6yv28D8GdIpz7a5ISEg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/33fb6abccfe9bfd08babb35b17ab1acf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s37-lQWOlZfWxvyMwaf-Pg.png"/></div></div></figure><h2 id="30ed" class="nt kw iq bd kx ol om dn lb on oo dp lf lw op oq lh ma or os lj me ot ou ll ov bi translated">在每月的某一天进行T-test</h2><p id="7429" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">在对所有31天进行t检验后，p值最低的三天是:</p><ul class=""><li id="43e1" class="mj mk iq lp b lq ml lt mm lw mn ma mo me mp mi mq mr ms mt bi translated">2.:0.07163584(回报率高于平均值)</li><li id="4fbf" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">12.:0.0114696(回报率低于平均值)</li><li id="ab92" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">29.:0.08354356(回报率高于平均值)</li></ul><p id="8c9a" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">通过31天的测试，我们预计平均至少有一次测试会拒绝零假设，事实也确实如此。</p><p id="d3e3" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">我们观察到一个轻微的U型回报。月初和月末的天数比月内天数的回报率稍高。这些年的曲线似乎没有非常一致的模式，这让我对U形的预测能力不太有信心。</p><h1 id="b214" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">结论</h1><p id="a35b" class="pw-post-body-paragraph ln lo iq lp b lq lr jr ls lt lu ju lv lw lx ly lz ma mb mc md me mf mg mh mi ij bi translated">观察异常的一个问题是，我们总是会发现一些模式，如果我们足够努力的话，甚至可以进行显著的测试。然而，如果我们使用定量的方法来发现一些可能的异常，我们可以更深入地研究这些机制，以确定这种模式是否有一些价值。更好的是，首先，找到一些关于市场的有趣的工件，然后进行定量测试，以确定其有效性。这是一个有趣的练习，但仅此而已。我不建议用这个作为策略的基础，因为有限的重要性和巨大的变化会导致一个工作日或一个月的收益来自不相关的事件。</p><h1 id="9d42" class="kv kw iq bd kx ky kz la lb lc ld le lf jw lg jx lh jz li ka lj kc lk kd ll lm bi translated">进一步分析:</h1><ul class=""><li id="41b0" class="mj mk iq lp b lq lr lt lu lw ow ma ox me oy mi mq mr ms mt bi translated">寻找样本量较大的异常情况，如工作日</li><li id="c23c" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">更高粒度的数据。日内异常？</li><li id="307f" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">欠发达市场可能会有更明显的异常</li><li id="8ed6" class="mj mk iq lp b lq mu lt mv lw mw ma mx me my mi mq mr ms mt bi translated">查看各种因素(如公司规模)是否会导致异常的显著变化</li></ul><p id="58d9" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">GitHub上提供完整的笔记本:</p><div class="nc nd gp gr ne nf"><a href="https://github.com/RunarOesthaug/Oslo-stock-exchange-analysis" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">RunarOesthaug/奥斯陆证券交易所分析</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">该存储库将包含对来自挪威股票市场的数据进行的分析。主要是奥斯陆股票…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">github.com</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe kp nf"/></div></div></a></div><p id="ccb4" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">如果您有任何问题，请随时留言。</p><p id="bc12" class="pw-post-body-paragraph ln lo iq lp b lq ml jr ls lt mm ju lv lw mz ly lz ma na mc md me nb mg mh mi ij bi translated">感谢阅读！</p></div></div>    
</body>
</html>