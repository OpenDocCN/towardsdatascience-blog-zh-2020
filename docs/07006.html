<html>
<head>
<title>Exploring NYC 311 Complaint Data through Covid-19 with Matplotlib Geographic, Bar, and Line Plots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Matplotlib 地理图、条形图和折线图探索新冠肺炎的 NYC 311 投诉数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/has-quarantine-made-you-hate-your-loud-neighbors-these-charts-certainly-imply-it-c760e999a04b?source=collection_archive---------68-----------------------#2020-05-29">https://towardsdatascience.com/has-quarantine-made-you-hate-your-loud-neighbors-these-charts-certainly-imply-it-c760e999a04b?source=collection_archive---------68-----------------------#2020-05-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/e2492dcbfc4a5459ac0a066df0bcc66e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*A3EKIM3NV9LqkVYwEMMARg.gif"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">2020 年 2 月至 5 月的投诉</p></figure><h2 id="813b" class="jg jh ji bd b dl jj jk jl jm jn jo dk jp translated" aria-label="kicker paragraph">数据新闻</h2><div class=""/><div class=""><h2 id="2c51" class="pw-subtitle-paragraph ko jr ji bd b kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf dk translated">看起来隔离区让我们很多人讨厌我们的邻居！</h2></div><p id="fadb" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">从 3 月到 5 月的纽约市 311 投诉数据表明，隔离让我们有更多的时间生邻居的气——同时，我们中的许多人通过播放音乐来保持理智。</p><p id="ca79" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果你不知道什么是 311 电话，你可以在这里阅读。从消防栓漏水到吵闹的邻居，你可以打电话投诉或通知城市几乎任何事情。</p><p id="b1fe" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在将数据读入 Python 后，我从数据透视表开始，然后是条形图比较。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="fa51" class="mm mn ji mi b gy mo mp l mq mr">pivot = df.pivot_table(index="Descriptor", columns = "Borough", values = "Unique Key", aggfunc = "count")<br/>pivot = pivot.sort_values(by=['BRONX'],ascending=False)<br/>pivot.iloc[:10,:5].plot(kind="bar", figsize=(10,10)).set(title="Number of Complaints by Type and Borough", ylabel = "Count")</span></pre><p id="307e" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">以下是 2019 年 1 月至 2020 年 5 月各区最常见的投诉:</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/46d3e376e0c1b50c73c0542c6d54cd18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*44sZ-X7XYLghLWDtkQSw_w.png"/></div></figure><p id="16a6" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">对于那些喜欢更多的数据空间视图的人，我创建了一个地图。这只是地图图像顶部的散点图，使用<code class="fe mt mu mv mi b">BBox</code>匹配边界。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="2170" class="mm mn ji mi b gy mo mp l mq mr">descriptors = ["Loud Music/Party", "Loud Talking","Social Distancing","Banging/Pounding"]<br/>plot_df = df[df["Descriptor"].isin(descriptors)]</span><span id="9d72" class="mm mn ji mi b gy mw mp l mq mr">BBox = ((df.Longitude.min(),   df.Longitude.max(),      <br/>         df.Latitude.min(), df.Latitude.max()))</span><span id="c8fa" class="mm mn ji mi b gy mw mp l mq mr">#map from openstreetmap<br/>ruh_m = plt.imread(r'C:\Users\Andrew\Documents\Python Scripts\Medium Charts\NYC Open Data\StreetMap.png')<br/>        <br/>fig, ax = plt.subplots(figsize = (10,10))<br/>sns.scatterplot(x = plot_df["Longitude"], y = plot_df["Latitude"]<br/>                , hue = plot_df["Descriptor"], alpha = 0.2, ax = ax,zorder = 10,<br/>                size = 0.1)<br/>ax.set_title('Plotting Complaint Data on NYC Map')<br/>ax.set_xlim(BBox[0],BBox[1])<br/>ax.set_ylim(BBox[2],BBox[3])<br/>ax.imshow(ruh_m, zorder=0, extent = BBox, aspect= 'auto')</span></pre><figure class="md me mf mg gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mx"><img src="../Images/57f4c88e6d96ab60b17ce445985cb0e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DcDH4wx6AvB2jIassL740Q.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">底图来自<a class="ae mc" href="https://www.openstreetmap.org/export#map=11/40.7048/-73.9744" rel="noopener ugc nofollow" target="_blank"> OpenStreetData </a></p></figure><p id="e72e" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">同样的想法，但使用趋势线，显示每个区的需求:</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div class="gh gi my"><img src="../Images/4df3c5da768df0fa2d9dace3ba4f6a1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*9P_XERFT4dM0cVYnSQQbnw.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">我使用 7 天移动平均线来平滑大多数图表上的线条</p></figure><p id="afd7" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这条趋势线实际上非常接近苹果的移动数据，然而，由于我们无法直接与 2019 年进行比较，我们无法得出任何结论。</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mz"><img src="../Images/3c070e25f051e490f313e750c3cd50b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8UjdHHf_Ou2NmIidZ9r1iA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae mc" href="https://www.apple.com/covid19/mobility" rel="noopener ugc nofollow" target="_blank">https://www.apple.com/covid19/mobility</a></p></figure><p id="41e0" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">下面我们可以看到自纽约市开始隔离以来的最高投诉-这肯定是周期性的，但仍高于 2019 年！</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div class="gh gi my"><img src="../Images/f132ae6600ce91797fe1372587819c89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*O1Coqbvd67JviJZ1Y0xI3A.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">有趣的是，随着流动性的增加，社交距离电话减少了</p></figure><p id="88c1" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我马上想到这是因为我们都呆在家里，所以我希望人们拨打 311 的时间分布更加均匀。</p><p id="9009" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">以下是 3 月份之前按投诉类型划分的来电趋势:</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div class="gh gi na"><img src="../Images/8bec82d689fc73089619d6c5d6ded6b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*i17wuhZOTkYY7b7wnJYvaA.png"/></div></figure><p id="4959" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这是同一个图表，但使用的是 3 月到 5 月的数据:</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/9523cd497a1fe067550cc09b99b97005.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*gE3QuyYqf2i2BZkvk__P3Q.png"/></div></figure><p id="fbb2" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">它似乎保持大致相同的形状，但是从中午到午夜有更多的呼叫开始。我对此的解释是，人们通常在中午 10 点左右醒来，可能是听着邻居的音乐。</p><p id="0b7e" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">那么现在谁更喜欢聚会呢？</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div class="gh gi na"><img src="../Images/935dc5c9380d4cea7b790505ee5cf8b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*LJqimK0pl5T_46-tNLUaOA.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">仅 2020 年 3 月至 5 月的数据</p></figure><p id="7bcd" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">不过，这可能是因为大多数人已经离开了曼哈顿和布鲁克林的部分地区——所以我对这张图表持保留态度。</p><p id="041c" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在结束之前，让我们看一下我想探究这些数据的主要原因，看看现在与隔离前相比，服务请求是否需要更长的时间。</p><p id="06bf" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">为了创建“关闭时间”列，我减去了原始数据集中的“关闭”和“创建”日期列。</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="bf92" class="mm mn ji mi b gy mo mp l mq mr">df["time to close out"] = df["Closed (Date Only)"] - df["Created (Date Only)"]<br/>df = df[pd.notnull(df["time to close out"])]<br/>df["time to close out"] = df["time to close out"].dt.days</span><span id="79d0" class="mm mn ji mi b gy mw mp l mq mr">pivot = df.pivot_table(index="Created (Date Only)", <br/>                       columns = "Borough", values = "time to close out", aggfunc = np.mean)<br/>pivot = pivot.rolling(7).mean()<br/>pivot.iloc[:,:5].plot(kind="line", figsize=(10,10)).set(title="Days to Close Out Complaint", ylabel = "Days")</span></pre><figure class="md me mf mg gt iv gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/ea48aec621c3cae58820dd290aefe49d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*l3-aXBAsPvNixXCpYH_MeA.png"/></div></figure><p id="bc4f" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">令我惊讶的是，自从去年 9 月达到峰值后，解决投诉的时间一直在稳步减少。我们可以看到 3 月初有一点点增长，但很快就下降了。</p><p id="e7ae" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">按一天中的小时检查结算时间会给出以下两个图表:</p><figure class="md me mf mg gt iv gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/dca7672b542a9dbfff1bcea40789de79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*z1_ojtSqZ4c7t35l4Bz_AQ.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">在隔离之前，不知道史坦顿岛凌晨 3 点会发生什么</p></figure><figure class="md me mf mg gt iv gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/2678f5e82a45d6d371d74083c717054a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*BSA5CtLp8dpnCkrykP4VgA.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">3 月至 5 月期间</p></figure><p id="8fed" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">同样，趋势变化不大。我相信那是好事！</p><p id="e57f" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这篇文章引起你的共鸣了吗？如果是，你是打 311 的人还是吹音乐的人？</p><p id="7787" class="pw-post-body-paragraph lg lh ji li b lj lk ks ll lm ln kv lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><em class="ne">(如果想自己探索数据，可以从</em> <a class="ae mc" href="https://data.cityofnewyork.us/Social-Services/311-Service-Requests-from-2010-to-Present/erm2-nwe9" rel="noopener ugc nofollow" target="_blank"> <em class="ne">这里</em> </a> <em class="ne">导出 csv)。要创建这些图表，请查看我的</em><a class="ae mc" href="https://github.com/andrewhong5297/NYC_Open_Data" rel="noopener ugc nofollow" target="_blank"><em class="ne">GitHub repo</em></a><em class="ne">。数据列比我在这里选择的要多得多！)</em></p></div></div>    
</body>
</html>