<html>
<head>
<title>Diagnostic for Heart Disease with Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用机器学习诊断心脏病</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/diagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd?source=collection_archive---------15-----------------------#2020-01-11">https://towardsdatascience.com/diagnostic-for-heart-disease-with-machine-learning-81b064a3c1dd?source=collection_archive---------15-----------------------#2020-01-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6812" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我们能用核磁共振诊断心脏病吗？你打赌！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a1d45bd29bfc0b6524f0742991095c3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RGlcCyOWSyCs5dP9HYLF2w.png"/></div></div></figure></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><p id="bdbd" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi lu translated">目录表</p><ol class=""><li id="a5c6" class="md me iq la b lb lc le lf lh mf ll mg lp mh lt mi mj mk ml bi translated"><em class="mm">摘要</em></li><li id="3a56" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated"><em class="mm">背景</em></li><li id="7f51" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated"><em class="mm">材料&amp;方法</em></li><li id="550c" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated"><em class="mm">结果&amp;结论</em></li><li id="2c8b" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated"><em class="mm">参考文献</em></li></ol><h1 id="204b" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated"><strong class="ak"> 1。摘要</strong></h1><p id="15b8" class="pw-post-body-paragraph ky kz iq la b lb nk jr ld le nl ju lg lh nm lj lk ll nn ln lo lp no lr ls lt ij bi translated">根据疾病控制和预防中心(CDC)的数据，心脏病是美国男性、女性和大多数种族和民族人群的头号死因。在美国，每分钟都有一个以上的人死于这种疾病，每年有近 50 万人死于这种疾病，每年造成数十亿美元的损失。⁴因此，这个故事的目的是研究不同的潜在监督机器学习(ML)算法，以创建诊断心脏病模型。</p></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h1 id="abca" class="ms mt iq bd mu mv np mx my mz nq nb nc jw nr jx ne jz ns ka ng kc nt kd ni nj bi translated"><strong class="ak"> 2。背景</strong></h1><p id="2f66" class="pw-post-body-paragraph ky kz iq la b lb nk jr ld le nl ju lg lh nm lj lk ll nn ln lo lp no lr ls lt ij bi translated">为了进行这种分析，使用公开可用的克利夫兰心脏病数据集用 Python 构建了一个<a class="ae nu" href="https://nbviewer.jupyter.org/github/stevensmiley1989/Cleveland_Dataset/blob/master/Cleveland.ipynb" rel="noopener ugc nofollow" target="_blank"> Jupyter notebook </a>，该数据集有 300 多个独特的实例，共有 76 个属性。⁵ ⁶ ⁷ ⁸ ⁹从这 76 个总属性中，只有 14 个常用于研究至今。此外，该分析中使用的超参数来自 Olson 博士的建议，“将机器学习应用于生物信息学问题的数据驱动建议。”⁰在这个分析中使用的库和编码包是:SciPy，Python，NumPy，IPython ⁴，Matplotlib ⁵，熊猫⁶，Scikit-Learn ⁷，和 Scikit-Image。⁸</p><h1 id="23a4" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">克里夫兰 dataset⁵ ⁶ ⁷ ⁸ ⁹的背景</h1><p id="ab70" class="pw-post-body-paragraph ky kz iq la b lb nk jr ld le nl ju lg lh nm lj lk ll nn ln lo lp no lr ls lt ij bi translated">克利夫兰数据库的实验集中在简单地试图区分心脏病的存在和不存在。使用的 14 个属性:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">表 1。克利夫兰数据集 14 特征和描述。</p></figure><h1 id="d477" class="ms mt iq bd mu mv mw mx my mz na nb nc jw nd jx ne jz nf ka ng kc nh kd ni nj bi translated">olson 博士超参数建议的背景</h1><p id="bfd6" class="pw-post-body-paragraph ky kz iq la b lb nk jr ld le nl ju lg lh nm lj lk ll nn ln lo lp no lr ls lt ij bi translated">Randal S. Olson 等人在 2017 年发表的一篇文章为解决机器学习的生物信息学问题提供了有见地的最佳实践建议，<a class="ae nu" href="https://arxiv.org/abs/1708.05070" rel="noopener ugc nofollow" target="_blank">“将机器学习应用于生物信息学问题的数据驱动建议”</a>。</p><p id="66bc" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">简要地看一下摘要，他们分析了“13 种最先进的、常用的机器学习算法，这些算法针对一组 165 个公开可用的分类问题，以便为当前的研究人员提供数据驱动的算法建议。”有趣的是，这个数据集并没有包含在他们论文的<a class="ae nu" href="https://arxiv.org/abs/1708.05070" rel="noopener ugc nofollow" target="_blank">表 2 </a>的分析中。这使得它成为实验的一个很好的候选，因为它是使用 ML 的生物信息学中的一个二元分类问题。</p><p id="87f1" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">通过他们的研究，他们能够提供“五种具有超参数的算法的建议，这些算法可以最大限度地提高测试问题的分类器性能，以及将机器学习应用于监督分类问题的一般指南。”这些建议概述如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">表二。奥尔森博士的超参数建议摘要。⁰</p></figure></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h1 id="bff4" class="ms mt iq bd mu mv np mx my mz nq nb nc jw nr jx ne jz ns ka ng kc nt kd ni nj bi translated">3.材料和方法</h1><h2 id="4544" class="ob mt iq bd mu oc od dn my oe of dp nc lh og oh ne ll oi oj ng lp ok ol ni om bi translated">导入库</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="on nw l"/></div></figure><h2 id="f154" class="ob mt iq bd mu oc od dn my oe of dp nc lh og oh ne ll oi oj ng lp ok ol ni om bi translated">导入和查看数据</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oo nw l"/></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">表 3。导入后克利夫兰数据集的前 10 行原始数据。</p></figure><p id="86ba" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">将二进制分类的诊断列值更改为 0 或 1 之间。</p><pre class="kg kh ki kj gt op oq or os aw ot bi"><span id="dcc4" class="ob mt iq oq b gy ou ov l ow ox"><em class="mm"># Change num values &gt; 0 to 1 for a Diagnosis </em><br/>data['diagnosis'] = np.where((data['diagnosis']&gt;0),1,0)</span></pre><p id="01d1" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">检查有关数据的信息以了解其类型。</p><pre class="kg kh ki kj gt op oq or os aw ot bi"><span id="f399" class="ob mt iq oq b gy ou ov l ow ox">data.info() <em class="mm"># view</em></span></pre><p id="dc1a" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">有两个包含<code class="fe oy oz pa oq b">object</code>值的特性:</p><ol class=""><li id="3520" class="md me iq la b lb lc le lf lh mf ll mg lp mh lt mi mj mk ml bi translated">#通过荧光镜检查着色的主要血管</li><li id="1e0a" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated">地中海贫血</li></ol><p id="b61c" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在这两个特征中，有一个唯一的值<code class="fe oy oz pa oq b">?</code>,表示缺少一个值。这是从以下内容中发现的:</p><pre class="kg kh ki kj gt op oq or os aw ot bi"><span id="0817" class="ob mt iq oq b gy ou ov l ow ox">data['# Major Vessels colored by Flouroscopy'].unique()</span><span id="06fa" class="ob mt iq oq b gy pb ov l ow ox">data['Thalassemia (norm.,fix. defect, revers. defect)'].unique()</span></pre><p id="7bf9" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">两者分别只有 4 次和 2 次计数。假设实例数量不多，因此这些实例按如下方式删除:</p><pre class="kg kh ki kj gt op oq or os aw ot bi"><span id="cf7b" class="ob mt iq oq b gy ou ov l ow ox">sum(data['# Major Vessels colored by Flouroscopy'].values=='?')</span><span id="48c7" class="ob mt iq oq b gy pb ov l ow ox">droplist=data.loc[data['# Major Vessels colored by Flouroscopy']=='?'].index.tolist()</span><span id="d213" class="ob mt iq oq b gy pb ov l ow ox">data.drop(droplist,axis=0,inplace=<strong class="oq ir">True</strong>)</span><span id="a8de" class="ob mt iq oq b gy pb ov l ow ox">data['# Major Vessels colored by Flouroscopy']=data['# Major Vessels colored by Flouroscopy'].astype(str).astype(float).astype(int)</span><span id="d5b7" class="ob mt iq oq b gy pb ov l ow ox">sum(data['Thalassemia (norm.,fix. defect, revers. defect)'].values=='?')</span><span id="8967" class="ob mt iq oq b gy pb ov l ow ox">droplist=data.loc[data['Thalassemia (norm.,fix. defect, revers. defect)']=='?'].index.tolist()</span><span id="270c" class="ob mt iq oq b gy pb ov l ow ox">data.drop(droplist,axis=0,inplace=<strong class="oq ir">True</strong>)</span><span id="5d57" class="ob mt iq oq b gy pb ov l ow ox">data['Thalassemia (norm.,fix. defect, revers. defect)']=data['Thalassemia (norm.,fix. defect, revers. defect)'].astype(str).astype(float).astype(int)</span></pre><p id="7b72" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">此外，还使用以下方法检查缺失值:</p><pre class="kg kh ki kj gt op oq or os aw ot bi"><span id="5629" class="ob mt iq oq b gy ou ov l ow ox">data.isnull().sum()</span></pre><p id="2413" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">此时，没有丢失的值。</p><h2 id="2007" class="ob mt iq bd mu oc od dn my oe of dp nc lh og oh ne ll oi oj ng lp ok ol ni om bi translated">特征工程</h2><p id="a64f" class="pw-post-body-paragraph ky kz iq la b lb nk jr ld le nl ju lg lh nm lj lk ll nn ln lo lp no lr ls lt ij bi translated">如上所述的一些分类值只有几个唯一值。对这些值使用分类编码是一个很好的实践，这样 ML 算法就不会过度适应唯一的值。将这些转换成二进制允许 ML 算法以较少偏差的方式处理数据，而不会丢失任何信息。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pc nw l"/></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">表 4。特征工程后克利夫兰数据集的前 5 行原始数据。</p></figure><p id="0d27" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">接下来，清理和特征工程后的克利夫兰数据集直方图如图 0 所示。这个数字和心脏病的结果有一些明显的关系。</p><p id="3de8" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">例如，看左上方的年龄支线图，在 60 岁左右，心脏病患者的数量相对于该年龄没有疾病的人增加了近一倍。另外，看性爱的支线剧情，很明显男性(值= 1)比女性(值=0)患心脏病的次数多。还有更多的关系，但关键是这些关系是存在的，而且是牢固的。因此，最大似然算法应该利用这些来进行诊断。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/7352ebc03a20d4156642f58887765f64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b3TXVLnIqxzfHMLiJNCuEg.png"/></div></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">图 0。清理和特征工程后克利夫兰数据集的直方图。</p></figure><h2 id="bc75" class="ob mt iq bd mu oc od dn my oe of dp nc lh og oh ne ll oi oj ng lp ok ol ni om bi translated">缩放数据</h2><p id="e76e" class="pw-post-body-paragraph ky kz iq la b lb nk jr ld le nl ju lg lh nm lj lk ll nn ln lo lp no lr ls lt ij bi translated">缩放数据非常重要，这样 ML 算法就不会过度拟合错误的要素。使用<code class="fe oy oz pa oq b">MinMaxScaler()</code>，根据 0 和 1 之间的最小值和最大值，对每个特征的值进行缩放。这防止了信息丢失，但是允许 ML 算法用数据正确地训练。</p><pre class="kg kh ki kj gt op oq or os aw ot bi"><span id="25d1" class="ob mt iq oq b gy ou ov l ow ox">X = data.drop(['diagnosis'], axis= 1)<br/>y= pd.DataFrame(data['diagnosis'])<br/><br/><em class="mm">#Scale Data</em><br/>scaler = MinMaxScaler()<br/>X=MinMaxScaler().fit_transform(X.values)<br/>X = pd.DataFrame(X)<br/>X.columns=(data.drop(['diagnosis'], axis= 1)).columns</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="pe nw l"/></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">表 5。克利夫兰的前 5 行缩放数据。</p></figure><h2 id="0c18" class="ob mt iq bd mu oc od dn my oe of dp nc lh og oh ne ll oi oj ng lp ok ol ni om bi translated">具有皮尔逊相关系数的特征热图</h2><p id="8e5d" class="pw-post-body-paragraph ky kz iq la b lb nk jr ld le nl ju lg lh nm lj lk ll nn ln lo lp no lr ls lt ij bi translated">皮尔逊相关系数值接近 1 表示强相关。因此，当查看热图(图 1)时，与第一列“诊断”最相关的值对于训练 ML 算法将非常重要。其他特征之间接近 1 的值是不理想的，因为该信息已经存在用于训练 ML 算法。这在统计学上叫做多重共线性。看来<code class="fe oy oz pa oq b">Major Vessels F. Colored: 0</code>和<code class="fe oy oz pa oq b">Thalassemia:normal</code>的特征与<code class="fe oy oz pa oq b">diagnosis</code>具有最强的相关性，皮尔逊相关系数为 0.24。这不是很大的相关性，因此 ML 模型不太可能具有心脏病诊断所需的准确性，但这并不妨碍诊断的有效模型，因为它是基于受试者工作特征(ROC)曲线的曲线下面积(AUC)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pf"><img src="../Images/744860ac59bb456410ad3e53de64bcf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uAo97-wjNmxHCtaguBRxLQ.png"/></div></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">图一。清理、要素工程和缩放后的克利夫兰数据集的热图。</p></figure><h2 id="1eb9" class="ob mt iq bd mu oc od dn my oe of dp nc lh og oh ne ll oi oj ng lp ok ol ni om bi translated">为培训拆分数据</h2><p id="5577" class="pw-post-body-paragraph ky kz iq la b lb nk jr ld le nl ju lg lh nm lj lk ll nn ln lo lp no lr ls lt ij bi translated">在删除了 6 个缺失值的实例后，数据被分成 80%的培训(237 人)和 20%的测试(60 人)。这是拆分数据以训练 ML 算法的一般经验法则。</p><pre class="kg kh ki kj gt op oq or os aw ot bi"><span id="44e7" class="ob mt iq oq b gy ou ov l ow ox">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size= 0.2, random_state= 42) <em class="mm">#withold 20% of data for testing</em></span></pre><h2 id="5328" class="ob mt iq bd mu oc od dn my oe of dp nc lh og oh ne ll oi oj ng lp ok ol ni om bi translated">机器学习</h2><p id="1abc" class="pw-post-body-paragraph ky kz iq la b lb nk jr ld le nl ju lg lh nm lj lk ll nn ln lo lp no lr ls lt ij bi translated">为了找到一个好的模型，在训练数据集上测试了几种算法。使用算法的不同超参数的敏感性研究用 GridSearchCV 迭代，以便优化每个模型。通过查看训练数据和验证数据结果，最佳模型是具有最高准确性而不会过度拟合的模型。对于这些模型来说，计算机时间似乎不是问题，所以它对模型之间的决策没有什么影响。代码和细节请看<a class="ae nu" href="https://nbviewer.jupyter.org/github/stevensmiley1989/Cleveland_Dataset/blob/master/Cleveland.ipynb" rel="noopener ugc nofollow" target="_blank"> Jupyter 笔记本</a>。</p><p id="c762" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">使用 GridSearchCV 通过 k-fold 交叉验证评估模型，k-fold = 10，GridSearchCV 迭代不同算法的超参数。测试了几个新的超参数，以及奥尔森博士的分析中没有包括的一个附加算法。新算法是一个神经网络，多层感知器(MLPClassifier)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nv nw l"/></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">表 6。GridSearchCV 使用的超参数和算法摘要。</p></figure><h2 id="2afe" class="ob mt iq bd mu oc od dn my oe of dp nc lh og oh ne ll oi oj ng lp ok ol ni om bi translated">评估模型</h2><p id="3196" class="pw-post-body-paragraph ky kz iq la b lb nk jr ld le nl ju lg lh nm lj lk ll nn ln lo lp no lr ls lt ij bi translated"><strong class="la ir">查看混淆矩阵图</strong></p><p id="1fe8" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><em class="mm">图二。答 3。答 4。答，5。答，6。答，7。答，8。答，9。答，10。答，11。答，12。答和 13。答</em></p><p id="c2d7" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">当涉及到诊断心脏病时，我们希望确保我们没有太多的假阳性(你没有心脏病，但被告知你做了并得到了治疗)或假阴性(你有心脏病，但被告知你没有得到治疗)。因此，选择总体精度最高的模型(精度是混淆矩阵上对角线的总和除以总和)。您可以看到，所有模型的假阳性和假阴性都不到几个，这意味着它们都相当准确，因为测试集有 60 个观察值。</p><div class="kg kh ki kj gt ab cb"><figure class="pg kk ph pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/1ce72f263b29a634d4388e6ec8ab9457.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*ja1o8cLp4HA48ig78xR0xQ.png"/></div></figure><figure class="pg kk pm pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/b70e54aeb04d402d9c8eb3c044151d44.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*aTwNAztm1ilULU0NtF6GnA.png"/></div></figure><figure class="pg kk pn pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/b839709c15fba63d37e58cfbbae8ec78.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*Yvgj49j5mAJKjPKNfFgsvA.png"/></div></figure></div><div class="ab cb"><figure class="pg kk po pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/bf1df960701df2775bf694b4cec8adf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*EWbV8yhvrSzgaR6Bge9VNA.png"/></div></figure><figure class="pg kk pp pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/48dadcaced3504550abe2cf7f519fb16.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*TAXBlpg-r2tOew6mmvkNdQ.png"/></div></figure><figure class="pg kk pq pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/fde962eb1722336ac54bbe096fb26c0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*8UZM0TCH6ecMa8as2gSynw.png"/></div></figure></div><div class="ab cb"><figure class="pg kk pr pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/1402ad8d8cadc2eddaa95c84893fff36.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*xz3UDST45y2OEJ7q5cBPww.png"/></div></figure><figure class="pg kk ps pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/ec3a6805e096b67afad5251704bfca27.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*GvMEimpTAkwx6p68NWsiqQ.png"/></div></figure><figure class="pg kk pt pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/8368775ea42b2d3d8410017e75240074.png" data-original-src="https://miro.medium.com/v2/resize:fit:646/format:webp/1*-DDPnWrj92HuRtwLxRmCIQ.png"/></div></figure></div><div class="ab cb"><figure class="pg kk pu pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/fdf79f42ad0483b2b919ab6ef0a7dbfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*6I6q4GobCfCHWrUTqaqOYA.png"/></div></figure><figure class="pg kk pv pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/dd681930bc3bf6a2b80c43b82c1f273c.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*XvWPTPcMWB8jgEyZJ6CUig.png"/></div></figure><figure class="pg kk pw pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/88f66427184c93cbd40c07cd355c21cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*nDYJOBUv59uv7JcfXvpoLg.png"/></div></figure></div><p id="ff20" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="la ir">查看变量重要性图</strong></p><p id="eb47" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><em class="mm">图二。b，3。b，4。b，5。b，8。b 和 9。B </em></p><p id="a9e8" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">大多数<code class="fe oy oz pa oq b">ensemble</code>模型都有一个名为<code class="fe oy oz pa oq b">predict_proba</code>的参数，该参数允许通过<code class="fe oy oz pa oq b">gini</code>指数或<code class="fe oy oz pa oq b">entropy</code>的多数投票，根据模型的概率输出最重要的特征。这 5 个最重要的变量出现在所有这些变量重要性图中:</p><ul class=""><li id="3c23" class="md me iq la b lb lc le lf lh mf ll mg lp mh lt px mj mk ml bi translated"><code class="fe oy oz pa oq b">Exercise Max Heart Rate Achieved</code></li><li id="c5ff" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt px mj mk ml bi translated"><code class="fe oy oz pa oq b">Major Vessels F. Colored: 0</code></li><li id="5afe" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt px mj mk ml bi translated"><code class="fe oy oz pa oq b">ST depression induced by Exercise relative to Rest</code></li><li id="181b" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt px mj mk ml bi translated"><code class="fe oy oz pa oq b">Thalassemia: reversable defect</code></li><li id="5dae" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt px mj mk ml bi translated"><code class="fe oy oz pa oq b">Thalassemia: normal</code></li></ul><p id="2f10" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">毫不奇怪，在图 1 的热图中，这些相同的变量也显示出与诊断的高度相关性。因此，这些变量变得如此重要是有道理的。</p><div class="kg kh ki kj gt ab cb"><figure class="pg kk py pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/26cb5410a835352f057d80ac8aaef451.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*0WDQjW5aLFLFBQL2nby7Fg.png"/></div></figure><figure class="pg kk py pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/d4c540c811ad9667ed59125959cb6381.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*xyP2BQsewMz4pnTXZ17hFQ.png"/></div></figure><figure class="pg kk py pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/966b87915fe68d47bc650cb59d663396.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*zbujp22sjiQbOLNY-047Xg.png"/></div></figure></div><div class="ab cb"><figure class="pg kk py pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/1d5720d0c9b734260411641e6db31f78.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*AVJfykUOokFEo6bDI-lfUQ.png"/></div></figure><figure class="pg kk py pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/8ff93774c6c9545a9d5e2196dea2ab55.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*8NnXa8NUJEh822lVZ5bbDw.png"/></div></figure><figure class="pg kk py pi pj pk pl paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/53b670a5f1309081575ac4707a460594.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*Tx5ZOMusPu_08v7hvkQ0HQ.png"/></div></figure></div><p id="2b90" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="la ir">查看接收机工作特性(ROC)曲线</strong></p><p id="3fe4" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><em class="mm">图 14 </em></p><p id="e9b0" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">所有模型的受试者操作特征(ROC)曲线都有<code class="fe oy oz pa oq b">Excellent</code>曲线下面积(AUC ),因为它们的值都大于 90%(所有值都接近 95%),这意味着它们都可以作为优秀的诊断。这也表现在它们的高特异性和灵敏度值上。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pz"><img src="../Images/6ba98f609b049f35fe304e89a2a52977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8n-lTfyzOC38hqsqEatOYQ.png"/></div></div></figure></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h1 id="7069" class="ms mt iq bd mu mv np mx my mz nq nb nc jw nr jx ne jz ns ka ng kc nt kd ni nj bi translated">4.结果和结论</h1><p id="c627" class="pw-post-body-paragraph ky kz iq la b lb nk jr ld le nl ju lg lh nm lj lk ll nn ln lo lp no lr ls lt ij bi translated">所有模型在微调其超参数后都表现良好，但最佳模型是具有最高总体准确性的模型。</p><p id="184d" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在该分析中，<code class="fe oy oz pa oq b">Support Vector Machine (SVM)</code>和<code class="fe oy oz pa oq b">Multilayer Perceptron Classifier (MLP)</code>并列获得最高的整体精度，<code class="fe oy oz pa oq b">91.7%</code>(见下表 7)。然而，<code class="fe oy oz pa oq b">SVM</code>的 AUC<code class="fe oy oz pa oq b">96.8%</code>比<code class="fe oy oz pa oq b">MLP</code>的 AUC<code class="fe oy oz pa oq b">93.6%</code>高。这意味着<code class="fe oy oz pa oq b">SVM</code>在这种情况下是更好的诊断模型，但并不意味着<code class="fe oy oz pa oq b">SVM</code>在所有情况下都是最好的模型。所有这一切意味着，对于给定的测试集，这个模型表现最好。在这个测试中 20%的数据(60 个随机个体)中，只有少数几个在所有模型中被误诊。没有一个模型是完美的，但是这些结果是有希望的。如果平均来说，测试集中少于几个人被如此准确和精确地误诊，这是一个好的开始。显然，未来的目标是找到更好的度量标准来训练和测试 ML 算法或更多的数据。</p><p id="fc57" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="la ir">这里的关键是，由于受试者工作特征(ROC)曲线的曲线下面积(AUC)如此之高，心脏病的诊断是可能的。所有值都大于 90%，诊断结果非常好。</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="qa nw l"/></div><p class="nx ny gj gh gi nz oa bd b be z dk translated">表 7。统计结果汇总。</p></figure></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h1 id="b42f" class="ms mt iq bd mu mv np mx my mz nq nb nc jw nr jx ne jz ns ka ng kc nt kd ni nj bi translated">5.参考</h1><ol class=""><li id="c30b" class="md me iq la b lb nk le nl lh qb ll qc lp qd lt mi mj mk ml bi translated">Heron，M. <a class="ae nu" href="https://www.cdc.gov/nchs/data/nvsr/nvsr68/nvsr68_06-508.pdf" rel="noopener ugc nofollow" target="_blank">死亡:2017 年的主要原因</a>。<em class="mm">国家人口动态统计报告</em>；68(6).2019 年 11 月 19 日接入。</li><li id="bf9a" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated">本杰明·EJ、蒙特纳·P、阿朗索·A、比滕考特·MS、卡拉威·CW、卡森·AP 等,《心脏病和中风统计——2019 年更新:美国心脏协会的一份报告》。<em class="mm">循环</em>。2019;139(10):e56–528。</li><li id="5f4a" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated">Fryar CD，Chen T-C，Li X. <a class="ae nu" href="https://www.cdc.gov/nchs/data/databriefs/db103.pdf" rel="noopener ugc nofollow" target="_blank">心血管疾病未控制危险因素的患病率:美国，1999–2010</a>。NCHS 数据简报，第 103 号。马里兰州 Hyattsville:国家卫生统计中心；2012.2019 年 5 月 9 日接入。</li><li id="a2d9" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated">Dua d .和 Graff c .(2019 年)。http://archive.ics.uci.edu/ml 的 UCI 机器学习库。加州欧文:加州大学信息与计算机科学学院。</li><li id="70af" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated">匈牙利心脏病研究所。布达佩斯:<a class="ae nu" href="https://archive.ics.uci.edu/ml/datasets/heart+Disease" rel="noopener ugc nofollow" target="_blank">安朵斯·雅诺西，医学博士</a></li><li id="0675" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated">瑞士苏黎世大学医院:<a class="ae nu" href="https://archive.ics.uci.edu/ml/datasets/heart+Disease" rel="noopener ugc nofollow" target="_blank">医学博士威廉·斯坦布伦</a></li><li id="9141" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated">瑞士巴赛尔大学医院:<a class="ae nu" href="https://archive.ics.uci.edu/ml/datasets/heart+Disease" rel="noopener ugc nofollow" target="_blank">医学博士马蒂亚斯·普菲斯特勒</a></li><li id="95f8" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated">V.A .医疗中心，长滩和克里夫兰诊所基金会:<a class="ae nu" href="https://archive.ics.uci.edu/ml/datasets/heart+Disease" rel="noopener ugc nofollow" target="_blank"> Robert Detrano，医学博士，哲学博士</a></li><li id="05c4" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated">Olson，Randal S .等人<a class="ae nu" href="https://arxiv.org/abs/1708.05070" rel="noopener ugc nofollow" target="_blank">“将机器学习应用于生物信息学问题的数据驱动建议”。</a>“太平洋生物计算研讨会。太平洋生物计算研讨会 23(2017):192–203。</li><li id="7f61" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated"><a class="ae nu" href="https://scipy.org" rel="noopener ugc nofollow" target="_blank">T9】SciPy。(2019)SciPy 1.0-Python 中科学计算的基本算法。预印本 arXiv:1907.10121</a></li><li id="e8bd" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated"><a class="ae nu" href="https://www.python.org" rel="noopener ugc nofollow" target="_blank"> <strong class="la ir">巨蟒。</strong> </a> a)特拉维斯·芬特。科学计算的 Python，科学计算&amp;工程，9，10–20(2007)b)k . Jarrod mill man 和 Michael Aivazis。面向科学家和工程师的 Python，科学计算&amp;工程，13，9–12(2011)</li><li id="388c" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated"><a class="ae nu" href="https://numpy.org" rel="noopener ugc nofollow" target="_blank"> <strong class="la ir"> NumPy。</strong> </a> a)特拉维斯·芬特。美国 NumPy 指南:特雷戈尔出版公司(2006 年)。(b)斯蒂芬·范德沃特、克里斯·科尔伯特和盖尔·瓦洛夸。NumPy 数组:高效数值计算的结构，科学计算&amp;工程，13，22–30(2011)</li><li id="f18b" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated"><a class="ae nu" href="https://ipython.org" rel="noopener ugc nofollow" target="_blank"> <strong class="la ir"> IPython。</strong> </a> a)费尔南多·佩雷斯和布莱恩·e·格兰杰。IPython:交互式科学计算系统，科学计算工程，9，21–29(2007)</li><li id="a5c0" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated"><a class="ae nu" href="https://matplotlib.org" rel="noopener ugc nofollow" target="_blank"> <strong class="la ir"> Matplotlib。</strong> </a> J. D. Hunter，“Matplotlib:一个 2D 图形环境”，科学计算&amp;工程，第 9 卷，第 3 期，第 90–95 页，2007 年。</li><li id="1068" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated"><a class="ae nu" href="https://pandas.pydata.org" rel="noopener ugc nofollow" target="_blank">T5】熊猫。 </a>韦斯·麦金尼。Python 中统计计算的数据结构，第 9 届科学中的 Python 会议录，51–56(2010)</li><li id="c3e2" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated"><a class="ae nu" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> <strong class="la ir"> Scikit-Learn。</strong> </a>法比安·佩德雷戈萨、加尔·瓦洛夸、亚历山大·格拉姆福特、文森特·米歇尔、贝特朗·蒂里翁、奥利维耶·格里塞尔、马蒂厄·布隆德尔、彼得·普雷顿霍弗、罗恩·韦斯、文森特·杜伯格、杰克·范德普拉斯、亚历山大·帕索斯、大卫·库尔纳波、马蒂厄·布鲁彻、马蒂厄·佩罗特、爱德华·杜谢斯奈。sci kit-learn:Python 中的机器学习，机器学习研究杂志，12，2825–2830(2011)</li><li id="a0f9" class="md me iq la b lb mn le mo lh mp ll mq lp mr lt mi mj mk ml bi translated"><a class="ae nu" href="https://scikit-image.org" rel="noopener ugc nofollow" target="_blank"> <strong class="la ir"> Scikit-Image。</strong> </a>斯蒂芬·范德沃特、约翰内斯·l·舍恩伯格、胡安·努涅斯-伊格莱西亚斯、弗朗索瓦·布洛涅、约书亚·d·华纳、尼尔·雅戈、伊曼纽尔·古雅特、托尼·于和 scikit-image 供稿人。sci kit-Image:Python 中的图像处理，PeerJ 2:e453 (2014)</li></ol></div></div>    
</body>
</html>