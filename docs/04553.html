<html>
<head>
<title>Using Python to create a world map from a list of country names</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python从国家名称列表创建世界地图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-python-to-create-a-world-map-from-a-list-of-country-names-cd7480d03b10?source=collection_archive---------2-----------------------#2020-04-23">https://towardsdatascience.com/using-python-to-create-a-world-map-from-a-list-of-country-names-cd7480d03b10?source=collection_archive---------2-----------------------#2020-04-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7587" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从国家名称列表中，获取纬度和经度以创建世界地图</h2></div></div><div class="ab cl kf kg hu kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="ij ik il im in"><p id="be05" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">最近，我参与了一个项目，根据一系列简短的国家名称(如美国)创建一幅世界地图。在这里，我展示了创建世界地图(或任何其他地图)的步骤。</p><h1 id="a414" class="li lj iq bd lk ll lm ln lo lp lq lr ls jw lt jx lu jz lv ka lw kc lx kd ly lz bi translated">数据</h1><p id="2de8" class="pw-post-body-paragraph km kn iq ko b kp ma jr kr ks mb ju ku kv mc kx ky kz md lb lc ld me lf lg lh ij bi translated">有两列(国家名称、用户百分比)的样本数据是我们的原始数据。</p><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/a7db5ca319cca979411103f335bd739d.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*8Sv90Ui9w9N9ziGPOXsSdA.png"/></div></figure><h1 id="ad33" class="li lj iq bd lk ll lm ln lo lp lq lr ls jw lt jx lu jz lv ka lw kc lx kd ly lz bi translated">1.转换为阿尔法2代码和大陆</h1><p id="897d" class="pw-post-body-paragraph km kn iq ko b kp ma jr kr ks mb ju ku kv mc kx ky kz md lb lc ld me lf lg lh ij bi translated">alpha 2代码更便于以后的分析，因此简短的国家名称被转换为alpha 2国家代码。例如，美国转换为美国。Python的pycountry-convert包用于处理转换。下面的Python代码片段显示了一个要转换的函数。</p><pre class="mg mh mi mj gt mn mo mp mq aw mr bi"><span id="a313" class="ms lj iq mo b gy mt mu l mv mw">#installation<br/>pip install pycountry-convert</span><span id="6b8b" class="ms lj iq mo b gy mx mu l mv mw">#function to convert to alpah2 country codes and continents</span><span id="7081" class="ms lj iq mo b gy mx mu l mv mw">from pycountry_convert import country_alpha2_to_continent_code, country_name_to_country_alpha2</span><span id="4a03" class="ms lj iq mo b gy mx mu l mv mw">def get_continent(col):<br/>    try:<br/>        cn_a2_code =  country_name_to_country_alpha2(col)<br/>    except:<br/>        cn_a2_code = 'Unknown' <br/>    try:<br/>        cn_continent = country_alpha2_to_continent_code(cn_a2_code)<br/>    except:<br/>        cn_continent = 'Unknown' <br/>    return (cn_a2_code, cn_continent)</span></pre><p id="cfa5" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">在这个步骤之后，原始数据被处理如下:</p><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/3fa0d9b0d7edb948a36a1a783150ccb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*sNHJHObC_KoAIlH9Ln_frQ.png"/></div></figure><h1 id="7356" class="li lj iq bd lk ll lm ln lo lp lq lr ls jw lt jx lu jz lv ka lw kc lx kd ly lz bi translated">2.获取经度和纬度</h1><p id="36c4" class="pw-post-body-paragraph km kn iq ko b kp ma jr kr ks mb ju ku kv mc kx ky kz md lb lc ld me lf lg lh ij bi translated">第二，基于这些alpha 2国家代码提取经度和纬度信息。Python的geopy可以使用第三方地理编码器和其他数据源轻松定位地址、城市、国家和地标的坐标。下面的Python代码片段展示了一个获取经度和纬度的函数。</p><pre class="mg mh mi mj gt mn mo mp mq aw mr bi"><span id="2d16" class="ms lj iq mo b gy mt mu l mv mw">#installation<br/>pip install geopy</span><span id="137a" class="ms lj iq mo b gy mx mu l mv mw">#function to get longitude and latitude data from country name</span><span id="885e" class="ms lj iq mo b gy mx mu l mv mw">from geopy.geocoders import Nominatim</span><span id="30af" class="ms lj iq mo b gy mx mu l mv mw">geolocator = Nominatim()<br/>def geolocate(country):<br/>    try:<br/>        # Geolocate the center of the country<br/>        loc = geolocator.geocode(country)<br/>        # And return latitude and longitude<br/>        return (loc.latitude, loc.longitude)<br/>    except:<br/>        # Return missing value<br/>        return np.nan</span></pre><p id="3172" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">在运行上面的函数并将geolocate拆分为两个独立的纬度和经度列后，显示了下表。</p><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi mz"><img src="../Images/69d502d8533e4bb07606538af486f623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eKwAmufaDR1tQFcDKKysig.png"/></div></div></figure><h1 id="c4aa" class="li lj iq bd lk ll lm ln lo lp lq lr ls jw lt jx lu jz lv ka lw kc lx kd ly lz bi translated">3.创建世界地图</h1><p id="39a4" class="pw-post-body-paragraph km kn iq ko b kp ma jr kr ks mb ju ku kv mc kx ky kz md lb lc ld me lf lg lh ij bi translated">有许多Python包可用于创建视觉上吸引人且信息丰富的地图，包括底图、散景和树叶等。这里，follow用于创建某些用户分布的世界地图。Folium的CircleMarker()通过改变半径和颜色变量来描述数据是很有用的。</p><pre class="mg mh mi mj gt mn mo mp mq aw mr bi"><span id="aa65" class="ms lj iq mo b gy mt mu l mv mw">#installation<br/>pip install folium</span><span id="9875" class="ms lj iq mo b gy mx mu l mv mw"># Create a world map to show distributions of users <br/>import folium<br/>from folium.plugins import MarkerCluster</span><span id="3abe" class="ms lj iq mo b gy mx mu l mv mw">#empty map<br/>world_map= folium.Map(tiles="cartodbpositron")</span><span id="4bb8" class="ms lj iq mo b gy mx mu l mv mw">marker_cluster = MarkerCluster().add_to(world_map)</span><span id="3a0a" class="ms lj iq mo b gy mx mu l mv mw">#for each coordinate, create circlemarker of user percent<br/>for i in range(len(df)):<br/>        lat = df.iloc[i]['Latitude']<br/>        long = df.iloc[i]['Longitude']<br/>        radius=5<br/>        popup_text = """Country : {}&lt;br&gt;<br/>                    %of Users : {}&lt;br&gt;"""<br/>        popup_text = popup_text.format(df.iloc[i]['Country'],<br/>                                   df.iloc[i]['User_Percent']<br/>                                   )<br/>        folium.CircleMarker(location = [lat, long], radius=radius, popup= popup_text, fill =True).add_to(marker_cluster)</span><span id="83a5" class="ms lj iq mo b gy mx mu l mv mw">#show the map<br/>world_map</span></pre><p id="6c77" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">用户可以放大地图，查看更详细的国家用户分布情况。</p><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi ne"><img src="../Images/c77d8f7e21bf064baac15de00417ba00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TZ5M6InxPHaXEYYwTNc7lA.png"/></div></div></figure><p id="8d64" class="pw-post-body-paragraph km kn iq ko b kp kq jr kr ks kt ju ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">在这个例子中，我在几个Python包的帮助下创建了一个世界地图。不用说，使用给定的坐标可以很容易地创建其他类型的地理地图。</p></div></div>    
</body>
</html>