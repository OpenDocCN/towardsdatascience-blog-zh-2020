<html>
<head>
<title>Exploring Auto-Sklearn Models with PipelineProfiler</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 PipelineProfiler 探索 Auto-Sklearn 模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/exploring-auto-sklearn-models-with-pipelineprofiler-5b2c54136044?source=collection_archive---------34-----------------------#2020-06-03">https://towardsdatascience.com/exploring-auto-sklearn-models-with-pipelineprofiler-5b2c54136044?source=collection_archive---------34-----------------------#2020-06-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d4e1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何打开 AutoML 的黑匣子</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f8da62bfd6d9b3c411cfd6ce1fec5ead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*js6vDfCriuqVIMe8Cj-IrQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源:<a class="ae ky" href="https://www.pexels.com/photo/coffee-writing-computer-blogging-34600/" rel="noopener ugc nofollow" target="_blank">负空格</a></p></figure><p id="c759" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">构建机器学习管道通常是一项困难、耗时且反复试验的任务。AutoML 通过自动选择计算步骤、调整超参数和训练解决机器学习问题的端到端模型，使这一过程变得更容易。Auto-Sklearn 是最流行的开源 AutoML 系统之一。给定一个数据集、一个问题类型(分类或回归)和一个度量分数，Auto-Sklearn 能够产生集成管道来优化所选的度量并产生良好的结果。</p><p id="454b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以<em class="lv">数字</em>数据集为例，我们希望在这里对数字图像进行分类。我们可以自动创建一个管道，用几行代码解决这个问题:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="1144" class="mb mc it lx b gy md me l mf mg">import sklearn.datasets<br/>import autosklearn.classification<br/>X, y = sklearn.datasets.load_digits(return_X_y=True)<br/>automl = autosklearn.classification.AutoSklearnClassifier()<br/>automl.fit(X, y, dataset_name='digits')</span></pre><p id="7262" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然这极大地方便了模型构建过程，但也使结果更加模糊:数据科学家不知道采取了什么步骤来产生管道，探索了搜索空间的什么部分，以及调整了什么超参数。</p><p id="98f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇博文中，我们展示了如何使用<em class="lv"> PipelineProfiler </em>来调试和探索 Auto-Sklearn 生成的模型。<em class="lv"> PipelineProfiler </em>是一个新的库，旨在生成端到端机器学习管道的详细可视化。它与 Python 笔记本(Jupyter 和 Google Colab)集成在一起，可以在数据科学工作流中使用。</p><h1 id="ce4d" class="mh mc it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">管道剖面仪工具</h1><p id="7043" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">给定由 Auto-Sklearn 生成的训练模型，我们可以使用具有三行代码的 PipelineProfiler:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="d001" class="mb mc it lx b gy md me l mf mg">import PipelineProfiler<br/>profiler_data = PipelineProfiler.import_autosklearn(automl)<br/>PipelineProfiler.plot_pipeline_matrix(profiler_data)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/7dbe8c7e0935126ac009e870ff09f2d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xfmgKt_v1lVRlTN0zcqQBA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 1 PipelineProfiler 应用于 Digits 数据集。</p></figure><p id="88a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图 1 显示了应用于 Digits 数据集的<em class="lv"> PipelineProfiler </em>。该系统分为三个部分。1)原始贡献，显示原始使用与管道分数的相关性。2)流水线矩阵，呈现流水线、所使用的原语和超参数的概要。3)管道比较视图，突出显示所选管道之间的差异。</p><h1 id="a954" class="mh mc it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">管道分析</h1><p id="2ec2" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">图一。显示顶部两条管线使用<em class="lv"> Nystroem 采样器</em>、<em class="lv"> LDA </em>和<em class="lv">变压器</em>，但是在<em class="lv">级平衡</em>和<em class="lv">采样器</em>超参数的使用上有所不同。原始贡献向我们展示了<em class="lv"> Nystroem 采样器</em>和 LDA 与高准确度分数相关。反之，<em class="lv">特征集聚</em>与低分相关。</p><p id="3f48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">管道比较视图显示了所选管道的节点链接表示(按住<em class="lv">键并点击</em>可以选择多条管道)。图一。显示了三大管道之间的差异。为每个选定的管线指定一种颜色，并用颜色对图形节点进行编码，以表示原始管线。</p><p id="9e16" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv"> PipelineProfiler </em>还显示被评估管道的性能指标。在图 1 中。，我们会看到所有管道的准确度分数。但是，我们可以将此视图切换到其他管道指标。例如，Auto-Sklearn 生成的集合由所有评估的管道的加权平均值组成。我们可以切换度量分数来显示总体权重。我们还可以可视化每个管道的训练时间。图二。显示了可以显示的多个指标。我们从这个图像中移除了原始贡献视图，因为对于每个选择的度量，贡献都是不同的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/0f5cb318c0d57fce5d6e533e9360e991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oevSA5D61WOBsneh1ycv9A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 2 PipelineProfiler 可用于检查 Auto-Sklearn 提供的指标，例如准确度、总体重量和时间。</p></figure><p id="0b0a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们注意到管线#9 和#19 不属于系综，因为它们的权重被设置为零。此外，我们看到管道#7 训练时间最长，管道#9 和#5 训练时间最快。我们还注意到，流水线#1 具有最好的精度，但是不具有最高的总体权重。这表明 Auto-Sklearn 使用其他标准将权重分配给集合中的管道。</p><p id="e0dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们对哪些原语导致了长训练时间感兴趣，我们可以研究原语贡献视图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/c29aeb22274dc29d5ad58a1520b384d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a1jzRh95u9tVE8Sobu2fcg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图三。基于时间度量计算的原始贡献。梯度提升是与流水线训练时间最相关的原语。</p></figure><p id="b063" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们看到<em class="lv">梯度增强</em>和<em class="lv">多项式</em>是与高训练时间相关的两个原语，因此它们可能是罪魁祸首。直观地说，原始的<em class="lv">多项式</em>会导致更长的训练时间，因为它会从原始数据中生成大量的多项式特征。</p><h1 id="18d2" class="mh mc it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">最后的想法</h1><p id="3c2f" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">这篇文章简要介绍了<em class="lv"> PipelineProfiler </em>，这是一个 Python 库，可以用来研究 AutoML 模型。我们已经在 Jupyter Notebook 中看到了如何从 Auto-Sklearn 导入和可视化管道。</p><p id="e406" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv"> PipelineProfiler </em>是一款新工具，我们正在积极寻求关于我们应该支持哪些功能的反馈。如果您有任何问题或想要合作，请告诉我们！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h1 id="96fb" class="mh mc it bd mi mj mk ml mm mn mo mp mq jz mr ka ms kc mt kd mu kf mv kg mw mx bi translated">安装和演示</h1><p id="3dda" class="pw-post-body-paragraph kz la it lb b lc my ju le lf mz jx lh li na lk ll lm nb lo lp lq nc ls lt lu im bi translated">该系统的现场演示可在<a class="ae ky" href="https://colab.research.google.com/drive/1_2FRIkHNFGOiIJt-n_3zuh8vpSMLhwzx?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>上获得。</p><p id="d019" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该代码是在 BSD 3 许可下开源的。github 库是:<a class="ae ky" href="https://github.com/VIDA-NYU/PipelineVis" rel="noopener ugc nofollow" target="_blank">https://github.com/VIDA-NYU/PipelineVis</a></p><p id="68e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv"> PipelineProfiler </em>可从 PyPI 库中获得。它可以通过以下命令安装:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="212e" class="mb mc it lx b gy md me l mf mg">pip install pipelineprofiler</span></pre><p id="2010" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">欲了解更多信息，请参见<a class="ae ky" href="https://arxiv.org/abs/2005.00160" rel="noopener ugc nofollow" target="_blank">我们的论文</a>并观看我们的视频演示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nh l"/></div></figure></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><p id="54e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[1]福雷尔，马蒂亚斯<a class="ae ky" href="https://automl.github.io/auto-sklearn" rel="noopener ugc nofollow" target="_blank">等.</a>高效健壮的自动化机器学习<a class="ae ky" href="https://automl.github.io/auto-sklearn" rel="noopener ugc nofollow" target="_blank">。</a> <em class="lv">神经信息处理系统进展</em> 2015。<a class="ae ky" href="https://automl.github.io/auto-sklearn" rel="noopener ugc nofollow" target="_blank">https://automl.github.io/auto-sklearn</a></p><p id="7d51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2] Ono，Jorge 等人，“PipelineProfiler:用于探测 AutoML 管道的可视化分析工具”。2020.<a class="ae ky" href="https://arxiv.org/abs/2005.00160" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/2005.00160</a></p></div></div>    
</body>
</html>