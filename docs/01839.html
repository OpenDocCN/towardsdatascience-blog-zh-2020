<html>
<head>
<title>Variational Inference in Bayesian Multivariate Gaussian Mixture Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">贝叶斯多元高斯混合模型中的变分推断</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/variational-inference-in-bayesian-multivariate-gaussian-mixture-model-41c8cc4d82d7?source=collection_archive---------16-----------------------#2020-02-20">https://towardsdatascience.com/variational-inference-in-bayesian-multivariate-gaussian-mixture-model-41c8cc4d82d7?source=collection_archive---------16-----------------------#2020-02-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="a2b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">变分推理是贝叶斯统计中的一种近似推理方法。给定一个模型，我们经常想要推断它的后验密度。然而，关于后验密度的精确推断需要通过所有不相关的参数进行边缘化，这通常在计算上是难以处理的。VI 的主要思想是使用简单分布来近似查询密度。为了简化问题，我们用一个分布来近似每个单独的目标参数，并假设我们用于近似的分布是独立的。这种方法叫做平均场近似法。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/89b6fb11f17076078ef43b15f8099124.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*4xgxu0YHwyLyhi2acRgrdQ.jpeg"/></div><p class="kt ku gj gh gi kv kw bd b be z dk translated">等式 1</p></figure><p id="0858" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">说到近似，我们自然会想到 KL 散度，它衡量两个分布之间的相似性。但是 KL 散度本身就包含了我们要推断的后验密度。因此，这又是一个棘手的问题。然后我们介绍<strong class="jp ir">证据下界(ELBO)。</strong>可以证明 KL 散度的最小化等价于 ELBO 的最大化。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/902b62f04aadef58aae3d12543915f01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*P1Eq8lx7S1h4KyTyDgZzcQ.jpeg"/></div><p class="kt ku gj gh gi kv kw bd b be z dk translated">等式 2</p></figure><p id="75aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在优化是可能的。我们所做的是，我们遵循与期望最大化相似的程序(<strong class="jp ir"> EM </strong>)，一次更新一个近似分布。原来更新函数的表达式相当简单，如下图所示。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/33f07212b71c9c111aea80cbe5d7d2b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*d5HLx3dylmT2eC7R4pUjQg.jpeg"/></div><p class="kt ku gj gh gi kv kw bd b be z dk translated">等式 3</p></figure><p id="b7be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，z 是我们想要近似其分布的参数。</p></div><div class="ab cl kz la hu lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ij ik il im in"><p id="02f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面提到的方程是我们进行变分推理所需要的。让我们看看它们在贝叶斯多元高斯混合模型中的具体应用。该模型的图示如下所示。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/fbbaa4788d9fb367cc0a86684a52a7e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*h395iWvhF3O0tcTLVrSfYw.jpeg"/></div></figure><p id="a062" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个节点的分布如下:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/351620f8099ed70ae63263ead6599d27.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*86OiEEuAweTycYmKW1XY2Q.jpeg"/></div></figure><p id="eb69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个模型的直觉是，观察值或数据是从高斯分布生成的。这个高斯分布的参数由另外两个分布控制。首先，我们有 k 个μ选择，它也是由高斯分布产生的。其次，我们有一个分类分布，它决定 k 个生成的μ中的哪个均值负责生成数据。概括地说，生成数据的分布是多元的，这意味着我们的观察值 x 不止一个维度。我们用 p 来表示数据的维数。</p><p id="fdba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里的异议是，我们想用平均场近似来近似 p(μ，c)。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi li"><img src="../Images/106a6f8b1aaf81345538e996d38353a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*1dRdZtoFVMAl634TC4Xo9g.jpeg"/></div></figure><p id="826d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，根据概率图形理论，这里的μ和 c 不是独立的，因为数据是观察到的。然而，当我们设计近似函数时，我们可以使我们的近似分布相互独立。如你所见，这里的第一件事是找到所有 q 分布的形式。虽然我们可以使用任何我们想要的发行版，但是我们希望尽可能地简化它们。自然，我们希望使用与原始参数相同的分布(实际上，为了数学上的方便，我们希望先验与后验共轭。但这里不讨论。).所以，我们把近似分布设计成，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/25aa209a3131094cc03c9d898e22be47.png" data-original-src="https://miro.medium.com/v2/resize:fit:346/format:webp/1*o7YECm2Re0wyxQTDRiURqw.jpeg"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/63794b0dc36f102db2cb30cc7a2df9c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*NJ2ePNVt9iA6QwZV-qb6Pg.jpeg"/></div></figure><p id="bd86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我们的工作变成了优化 mk、sk 和ϕi.</p></div><div class="ab cl kz la hu lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ij ik il im in"><p id="eca7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看我们的 ELBO 长什么样</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/a07f971b4891090dfa66b91444da815d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*-Ga6W0YzNVu-aH1u88q3Ag.jpeg"/></div></figure><p id="4412" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于 ELBO 中的每一项，我们可以导出一个封闭形式。</p><p id="e60c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第一期</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/d0d50aea2ce5f567880e20002856fcbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*E3Bqs9nAvA7AY5H6boN67g.jpeg"/></div></figure><p id="2c98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我们假设，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/25aa209a3131094cc03c9d898e22be47.png" data-original-src="https://miro.medium.com/v2/resize:fit:346/format:webp/1*o7YECm2Re0wyxQTDRiURqw.jpeg"/></div></figure><p id="383f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/d3932bae8b0c7d4ed085125661be467c.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*GpEvAX0_0NQmTBLR1QGAiQ.jpeg"/></div></figure><p id="08d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二学期</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/c7dfc963b9180a5d1316d1e31b29cccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/1*zbEaPo3GtNxB2gnDEXLdxg.jpeg"/></div></figure><p id="6c2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第三期</strong></p><p id="564c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/f06b5a39c593364ce2afa77f3ffae77e.png" data-original-src="https://miro.medium.com/v2/resize:fit:370/format:webp/1*79W0uiX5s1l6Ao4riZlhLA.jpeg"/></div></figure><p id="f83b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/1ada6b82f6a25c2574d562acb8e80d05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*uNKssqG9J5xQxIrnUwaSyQ.jpeg"/></div></figure><p id="2b50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第四项</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/e06f54cc2e97df2e404f9cce72f7d360.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*Yuw-Gk0LfiTrOwCocuQjpQ.jpeg"/></div></figure><p id="f3bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">期限 5 </strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/fe44d7ced63fd6e711c587f250793d71.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*giXQjHnphGGCVwv6aIaabw.jpeg"/></div></figure><p id="e956" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对 ELBO 的上述计算表明它是易处理的，并且可以通过监视它是否在增加来跟踪参数的更新。</p></div><div class="ab cl kz la hu lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ij ik il im in"><p id="c43a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们使用等式 3 来导出参数的更新函数。</p><p id="dfee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">对于 q(c) </strong>，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/a65d53b937c84403543367e1337cd1b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*OXcIxcqIJRHxfr0DTTS08A.jpeg"/></div></figure><p id="f4c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过使用来自图形模型的联合分布，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lu"><img src="../Images/29b01b858d3777433f9bb2abe47c614b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*-heBViPKrof4pHxhPVmgeg.jpeg"/></div></div></figure><p id="5a3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/3f3d5119b39e2e464c83ae5ec8eacb73.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*4CmJqqNFOxDQAoKDSGlQiw.jpeg"/></div></figure><p id="ce75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">对于 q(μ) </strong>，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/1ba75167c9add648528e20bda5518789.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*pdPDFIWwwEE96V1ZfEygIA.jpeg"/></div></figure><p id="eaad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">而且，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/5c66d7b3656d14a01eb1338d13dc6237.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*LdKOhJMXPGOIlMBskMbvNg.jpeg"/></div></figure><p id="d583" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/142baeaa701c6c4d47f3e466f072490d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*GxRE0KUPlyzwGSoMBdg8Ng.jpeg"/></div></figure><p id="6ec7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi md"><img src="../Images/370615320529a599aa61b9dc1b2e9c68.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*Wh4Kn_jgFw8DVRU110YDSQ.jpeg"/></div></figure><p id="5ff5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi me"><img src="../Images/57bfe7713ea718f3ad6b3b96e0a877f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:372/format:webp/1*c-l8VrmcZ74YhWHFN5Zk5w.jpeg"/></div></figure><p id="eb7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/131f14d511e8840645c5f0583488085d.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*iLyakXkF8BX6h21pjX9Cdg.jpeg"/></div></figure><p id="8153" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我们有了所有近似参数的更新函数。</p></div><div class="ab cl kz la hu lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="ij ik il im in"><p id="7bf5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以在数据维数为 2 的情况下测试我们的理论。结果如下所示。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/43f1efa8e0507cf5d501a6545778550c.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*q2Hfw-AFimiRDl2COr3Ahw.jpeg"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/8041d0a7165ab164190f7ddcfa370d10.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*f3rtG7IOuEvHvoSht0H4fA.jpeg"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/7f8c822b1c2669c006d9eb779743499e.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*PasR5PSXjcJdkyJsYboVUA.jpeg"/></div></figure></div></div>    
</body>
</html>