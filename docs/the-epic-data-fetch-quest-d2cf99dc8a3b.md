# 史诗般的数据获取任务

> 原文：<https://towardsdatascience.com/the-epic-data-fetch-quest-d2cf99dc8a3b?source=collection_archive---------52----------------------->

## 一个人去很危险！拿着这个。

![](img/d5009bfa3a4f97822935c9719f7adde0.png)

(摄影:兰迪·欧)

特别感谢在 twitter 上发信息给我这个问题的人，他让我把这个问题作为一篇文章的出发点。探索真实的场景真的很有趣，我总是可以在匿名化细节方面有一点创造性的自由。

这是他们(转述的)问题陈述。

> *我最近成为了一家公司的数据分析师。看起来我需要先做大量的组织数据库创建工作。很多数据都在不同系统的 Excel 文件里。我想收集一切，组织起来，让用户可以查询和可视化。你对数据库，工具，设计方法有什么建议吗？*

所以这个问题有两个部分:1)显性问题:如果我要开始这样一个史诗般的追求来增加我成功的机会，要做些什么；2)隐性问题:现在做的最好的事情是什么？

这类问题的一般形式类似于一个大型 RPG 游戏，你被丢进了一个全新的世界，一切都闪闪发光，看起来很重要，并且缺乏任何由神强加给你的更强的故事情节任务，你被派去从世界各地获取物品以换取未指定的奖励。我就是这样花了 100 个小时做支线任务和关卡打磨的，这作为休闲活动可能不错，但对你的职业生涯可能不理想。

我认为有一些项目管理经验的人很可能会在他们的脑海中响起一些警钟“警告！无界范围！”

所以让我们先从最重要的问题开始深入研究:

这可能是这项努力的关键问题。不着手一项没有真正目标的巨大任务，也有办法变得有效和有影响力。

将所有东西放入“一个集中的地方，每个人都可以共享，而且功能更强大”是一个看似自然的目标。“现在一切都很困难，因为它分散在各地。甚至开始做分析工作都需要工作，这就是为什么一切都很糟糕！”

以我个人的经验，这样的项目也是项目走向死亡的地方。我坚信，一旦你把“数据仓库”这个词和一个项目联系起来，[你失败的几率就会大大增加。我这么说是作为一个在我的职业生涯中设计和建造了三个该死的东西的人。我希望没有第四个。](https://twitter.com/Randy_Au/status/1235991970230816768)

DW 项目困难的原因与技术难度关系不大。都符合[知名模式](https://panoply.io/data-warehouse-guide/data-warehouse-architecture-traditional-vs-cloud/)。技术部分相对容易。

*   数据被路由到为分析而设计的中央系统。
*   集中式系统只是一个大型的类似数据库的服务。
*   需要编写大量烦人的数据摄取 ETL 工作。
*   有接口可以提取数据并进行分析。
*   最后，还有大量的维护和保养。
*   很难在一长串旧的数据存储/分析系统和类似于现代数据仓库的东西之间划清界限，但是到了 20 世纪 90 年代，所有的部分和规模都准备好了。那是至少 30 年的技术改进。现代系统只是采用了核心思想，并以比以前更好的规模、成本和易用性来完成它。

# 人类制造了问题，也需要人类来解决它

这些项目困难的主要原因是因为这些假设忽略了事情为什么会变得像最初一样“混乱”的最**人**的部分。对盛大的渴望“让我们扫除所有的丑陋，让每个人都在同一页上！”愿景部分源于不理解不同的系统是由不同的人创建的，以满足特定的需求。这些系统随后不断发展，直到它们在有限的范围内工作得相当好。但是，由于它们在开始时从未协调过，现在让它们一起工作需要付出巨大的人力成本。

每个输入数据集都包含以下内容:

*   拥有独特需求和不同合作意愿的所有者
*   需要理解和协调的新的或稍有不同的术语定义和度量
*   需要克服的不同访问权限
*   围绕数据的不同人工流程(收集、输入、使用)

与所有这些人一起工作并获得想要的结果需要很多技巧、耐心和资源。这些技能中有许多与软件开发或数据分析无关。因此，当您考虑将所有东西都收集到一个系统中时，这就是您要注册的。

你将与工程部门的 Alice 一起工作，接触生产系统的分析方面，并在使用系统时调试所有数据问题。然后，您将与客户支持部门的 Bob 交谈，了解带有定制内部工具的第三方支持票证系统，以及维护该系统的工程师已于上个月离职。然后，财务部的 Eve 完全忙于 B 轮融资的准备工作，没有时间解释本季度的任何财务数据。

一旦你克服了障碍，理解并合并所有这些数据源到一个地方。然后你就陷入了维护系统的困境，因为你是唯一一个知道这个东西如何工作的人，没有人投资来保持它的更新。

好心没好报。

没人说数据仓库一定会从你的额头上冒出来，准备好向世界提供智慧。正如我在上面提到的，这样做通常是致命的。你可以称之为，头脑分裂。相反，通过调用由来已久的项目管理咒语“限制范围”,有办法生存下来。

# 确定一些核心业务问题，首先瞄准这些问题

虽然任何组织内部都有许多功能和流程，这是一个无尽的分析可能性的海洋，但应该只有少数核心功能支持其他所有功能。无论是小工具的生产还是订阅的销售，有些东西天生就比其他东西更重要。如果它变坏时严重威胁到企业的生存，那么它可能值得关注。

识别这些系统，并想出一些好的分析来帮助人们更好地理解它们。我们的目标是首先构建出支持那些核心业务问题的东西。可能是了解成本、销售、重复销售、获得新客户、保持现有客户等。最有可能的不是办公室每个月用多少咖啡过滤器(我肯定你能在办公室经理的数据里找到这方面的一些数据。)

通常，围绕这些核心业务问题的数据仅位于少数系统中。它们甚至可能在单个系统上，因为这是业务的核心，一切都围绕着核心发展。你真的只想在最好的情况下一次处理一个系统，最坏的情况下一次处理两个系统。

# 在你开始编码之前做一些分析

既然你的范围被限制在针对少数几个问题的少数几个问题上，接下来你需要做的是做一些基本的分析。

挑一个问题，任何让你感到兴奋的。下一步你将需要这种动力。您将进行一次性分析来检验这个问题。也许是关于客户保持，或者销售时间，或者获取客户的成本。经历获取数据的实际机制，理解它是如何工作的，最重要的是，使用数据创建一个别人觉得有用的工件。

这是你的原型。

通过这样做，你会学到很多关于这些系统如何工作的知识，这将使剩下的过程变得更容易。你很可能需要与人们交谈，询问他们各种数据的含义，哪里不可靠，哪里可以改进数据收集。你会在数据中发现奇怪的错误，这会破坏你的分析管道。即使是做最粗糙、最简单、最随意的分析，所花的时间也比你想象的要长得多。在此过程中，你可能要花数周时间来修复 bug。

但是不要绝望，这些都是你在开始构建数据仓库时必须做的工作，但是现在你做这些是为了一个具体的目的，而不是未来一个模糊的抽象系统。有一个单一的可交付成果，终点在望。

最后，一旦您创建了您的分析结果，您就可以向人们展示了。希望他们对你创造的东西感到兴奋，因为它帮助他们更好地理解某些东西，或者提供洞察力。他们甚至可能有后续问题，你必须进一步分析。但是猜猜你刚刚做了什么？**你已经为你的项目**制造了刺激。您已经向他们展示了您可以如何帮助他们，如果您需要他们为您的数据仓库改变他们的数据流程，他们将来会更愿意帮助您。

# 自动化您的分析

既然您实际上已经完成了端到端的分析，那么您应该对系统足够熟悉，对如何自动化它有一个很好的想法。所以去做吧。

当你这样做的时候，你会发现新的问题和问题。最重要的一个问题是“等等，我如何在什么系统上自动化这些东西？”如果你是第一个人，可能没有任何基础设施。是时候戴上数据工程师的帽子，解决问题了(同时与运营人员一起工作)。

这时，您可以开始评估您的技术需求。你使用简单的关系数据库吗？(答案:99%的情况下是)。你想用什么语言？谁负责维护系统？

这里有大量的细节和潜在的选择。我唯一能强调的是，**咨询你的工程伙伴**！你想避免成为异类。

如果你是唯一知道 R 的人，而其他人都在用 Java，请不要在没有超级重要迫切的理由下使用 R。这样做意味着要么自愿永远做唯一维护这个系统的人，要么你得教别人一门他们不懂的语言。这也适用于您的其他基础设施。如果你是一个 SQL Server 商店，没有一个好的理由不要启动 PostgreSQL 实例。

幸运的是，数据仓库解决方案非常丰富。每个[云](https://aws.amazon.com/training/course-descriptions/data-warehousing/) [服务](https://cloud.google.com/solutions/marketing-data-warehouse-on-gcp) [提供商](https://azure.microsoft.com/en-us/solutions/data-warehouse/)都提供完整的解决方案，你想花多少钱就花多少钱。您可以使用开源技术构建自己的数据库，包括一个简单的 PostgreSQL 数据库。选择适合您的环境和预算的产品。

一旦你完成了所有这些工作，并且最终完成了自动化，恭喜你，你已经创建了一个数据管道！你甚至有等待消费输出的用户。

# 重复，直到你厌倦了这一切

现在您已经有了一个处理分析的系统，您可以考虑扩展了。找到一个新的分析，一个你想要的新结果，测试它，构建它，自动化它，并将其集成到你的系统中。也许这将涉及到将新的数据源集成到您的系统中，或者您可能只是对现有数据进行新的分析。

一遍又一遍地重复这个动作。这有点累人，但还是那句话，由于范围有限，总会有尽头。第二次，你也将不得不做更少的数据工程。

# 那些像 AWS Redshift、GCP BigQuery 这样的大数据仓库分析数据库呢？

如果它们符合你的需要，你可以用它们。它们是为大量数据而设计的。它们通常很好，因为您可以将 CSV 文件放入这些系统，它们会接收这些文件，但会为您提供一个非常灵活的 SQL 界面。由于 CSV 是数据的通用语言，它可以使您的许多 ETL 工作变得更容易。我曾经不得不编写原始的 MapReduce 作业来做红移和 BQ 在 SQL 中做的事情。从这个背景来看，这些新工具是惊人的。

同时，您将为这些惊人的特性付费，包括日志存储和运行查询的成本。那些 [的账单](https://aws.amazon.com/getting-started/projects/deploy-data-warehouse/services-costs/#:~:text=Using%20the%20default%20configuration%20recommended,usage%20of%20each%20individual%20service.)可不简单。它们被宣传为数据仓库解决方案的基础技术，但是如果您的数据源主要是 Excel，它们就完全是多余的。( [Excel 每张工作表仅支持约 100 万行](https://support.office.com/en-us/article/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3)，这很容易放入笔记本电脑的内存中。)

我的建议是从便宜得多的小型本地关系数据库开始，您可以迁移和扩展，稍后会有一些不适。

# 提前计划

您可以在编程和系统架构方面提前做一点计划。您可以避免编写太多一次性代码，因为您知道您的数据管道和系统将被其他系统重用。

从一开始就设计一定的灵活性。这里或那里的一些额外的抽象层将在将来为您节省一些重构。平衡抽象层次是一种艺术形式，你当然可以走得太远，但是只需要几分钟就可以把事情分成函数和方法，而不是一大堆意大利面条。避免让现在的自己给未来的自己带来痛苦。

我使用的一个很好的经验法则是在关注点分离中相当 UNIX-y，着眼于在未来开发代表不同数据系统的功能模块。然后，可以根据需要交换/迭代这些模块。

# 与人合作

人们会创造或破坏这个过程。如果你建立的东西不符合他们的世界，他们不会使用它。你将依赖他们给你数据，所以没有他们的投入就不要打乱他们的流程。当您的管道完成时，您将依赖它们来警告您是否有变化。

如果人们投资于你的新系统，是因为他们直接从中获得价值，那么他们会有兴趣帮助你保持所有移动部件平稳运行。管理这种关系至关重要。如果人们不再关心，事情就会开始变糟。

# 这需要时间

这不是一个一周的项目。确保参与的每个人都有现实的期望。确保他们知道事情会因为错误和问题而脱轨。

然后就是继续下去的问题了。祝你好运！

*最初发表在兰迪的免费每周时事通讯上，* [*【计数玩意儿】*](https://counting.substack.com) *，内容涵盖了数据和技术中较为平凡、重要的部分。*