<html>
<head>
<title>The Witch, The Queen, and The Markov Chain</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">女巫、女王和马尔可夫链</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-witch-the-queen-and-the-markov-chain-55997163c6a?source=collection_archive---------44-----------------------#2020-04-17">https://towardsdatascience.com/the-witch-the-queen-and-the-markov-chain-55997163c6a?source=collection_archive---------44-----------------------#2020-04-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="39c3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">马尔可夫过程并不无聊。这太有趣了！</h2></div><p id="2ba3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据引用牛津词典的维基百科，马尔可夫链是描述一系列可能事件的随机模型，其中每个事件的概率仅取决于前一个事件达到的状态。人们可能会被这个定义吓倒，甚至更糟，感到无聊，但自从我开始发现数学和统计建模中的马尔可夫过程后，我除了乐趣什么也没有。在这篇文章中，我将尝试用一个例子来解释马尔可夫过程，并给出一些有趣的句子，这些句子是由使用马尔可夫链的自然语言生成器生成的。</p><h2 id="ebfc" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">一个说明这一过程的故事</h2><p id="0731" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">很久很久以前，在一个神奇的王国里住着一位王后。她聪明、强大，但不受欢迎。她的王国很大，但只有 20%的人支持她和她的政治，80%的臣民不喜欢或支持女王。但是，正如我所说的，女王很聪明，所以她决定采取行动。她去了魔法森林，那里住着一个森林女巫，她能预知未来并配制药剂来改变它。王后带来了黄金和钻石，并对女巫说:“救救我，强大的女巫。只有 20%的受试者尊重和支持我。我需要一种能让更多人爱我的药水”。女巫一句话也没说，离开了房间，一小时后拿着药水回来了。她说“在这里。拿着这个，它会帮助你。我的水晶球告诉我，在你服用这种药剂后，90%的支持者会继续支持你，70%的不支持者会从现在开始支持你。”</p><p id="4276" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据女王的说法，情况看起来是这样的:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mc"><img src="../Images/4aa2793439cf06b092c4d98c95939d4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BD3rthC_f88pwO-3g34gKA.png"/></div></div></figure><p id="b2c7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">而且据女巫说，服用药剂后的情况会是这样的:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mo"><img src="../Images/5ed0d3ea7fa9ba0a0572a84851288e0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0s7bjZfkRO2q8BMQtskDUg.png"/></div></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mp"><img src="../Images/d4b119549a898891cc9b1c45557d92a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PJ_R2f7W1o9DXEtTOQg51g.png"/></div></div></figure><p id="8391" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从这个图中，我们可以计算一个过渡态概率矩阵:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mq"><img src="../Images/c8b9b5fd1e9ff9038d9edc7e87964b23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nrAXSag_KOEVGQjfILyeNw.png"/></div></div></figure><p id="3f28" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为我们记得最初的情形是怎样的:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mr"><img src="../Images/d67758b29c93040624fa60e5471fea1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qEWJHYLK27QtnUylO0S1_g.png"/></div></div></figure><p id="cd07" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在可以执行矩阵乘法来计算女王服用魔法药水后的追随者数量:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ms"><img src="../Images/d27a1a51b7d166b03a3dd80006422cfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_VRlpayWefiMM9oX8ptELw.png"/></div></div></figure><p id="1f3a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从只有 20%跃升到 74%……这个魔女配得上很多黄金！</p><h2 id="f08f" class="le lf it bd lg lh li dn lj lk ll dp lm kr ln lo lp kv lq lr ls kz lt lu lv lw bi translated">简单的代码来玩文本</h2><p id="4e24" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">从上面的例子中我们可以看到，马尔可夫过程用于计算一个事件发生在另一个事件之后的概率。如果女巫有一个水晶球来告诉她在女王服用她的药剂后会发生什么，我们就有数学和代码来计算概率。这个过程非常有用，可以应用到很多东西上。马尔可夫过程的一个我最喜欢的应用是自然语言生成器。</p><p id="9d44" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当处理文本数据和使用高级 NLP 技术时，为什么不试着找点乐子呢？通过使用马尔可夫过程，模型可以在整个文本数据集上进行训练，并计算一个单词跟随另一个单词的概率。最简单的例子是短信中的建议:当你输入“我的”，它会提供“朋友”、“父母”、“狗”等。，因为这是我们自然语言的工作方式。NLG 的作品从不完美，这使得和他们一起工作很有趣。有时他们会给你有意义的建议，但有时不会，我个人觉得这很有趣。</p><p id="867b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是 NLG 根据丝芙兰网站的用户评论进行训练后得出的一些评论:</p><pre class="md me mf mg gt mt mu mv mw aw mx bi"><span id="99c1" class="le lf it mu b gy my mz l na nb">“AMAZING I originally purchased the Balance and Clarify set which contained a 2 step peel and I broke out”</span><span id="6695" class="le lf it mu b gy nc mz l na nb">“The only thing it seemed to work because I’m self conscious of the work getting rid of it”</span><span id="a187" class="le lf it mu b gy nc mz l na nb">“It smells like bad BO and I love the gel cream”</span><span id="7f4d" class="le lf it mu b gy nc mz l na nb">“If your eyes it remove makeup i love it but the more expensive items in my midlate 20s normal skin”</span></pre><p id="0ee9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里有一些食谱(来自 BBC Food 和 Allrecipes 的食谱培训):</p><pre class="md me mf mg gt mt mu mv mw aw mx bi"><span id="c626" class="le lf it mu b gy my mz l na nb">‘2 loins of lamb or mutton neck fillet, diced, 3 tbsp tomato purée, 1 tbsp dill seeds, 1 tsp sea salt, plus extra leaves to serve, salt and pepper’</span><span id="d812" class="le lf it mu b gy nc mz l na nb">‘2 tbsp crème fraîche, 300g/10½ oz fettucine or tagliatelle, cooked according to packet instructions’</span><span id="fbaf" class="le lf it mu b gy nc mz l na nb">‘200g/7oz white sweet potatoes, 12–10 inch flour tortillas, 9 ounces shredded Cheddar cheese’</span><span id="339b" class="le lf it mu b gy nc mz l na nb">‘2 Japanese aubergine cut into very small florets, 1 garlic clove roughly chopped to garnish’</span></pre><p id="51c0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，看看泰勒·斯威夫特(Taylor Swift)歌词训练后写的一首歌:</p><pre class="md me mf mg gt mt mu mv mw aw mx bi"><span id="6b90" class="le lf it mu b gy my mz l na nb">Asking you to roll your eyes are like a best friend<br/> Are we in the dress cried the whole scene<br/> Im just a classroom<br/> Ill be usin for the first Old Fashioned we were dancing<br/> Didnt you flash your green eyes baby as the water rushes in The moon like a necklace</span><span id="938b" class="le lf it mu b gy nc mz l na nb">The whole place was a masterpiece And I stare at the back door<br/> Cause you know you<br/> I hope you remember it all too well She said I do</span><span id="ff5a" class="le lf it mu b gy nc mz l na nb">Enchanting to meet you where you first met me<br/> Im the one who makes you come in my head<br/> Oh never grow up just stay this simple<br/> Cause Im still trying to change your mind trying to know</span></pre><p id="ec37" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码非常简单。首先导入 Markovify 库和字符串进行预处理:</p><pre class="md me mf mg gt mt mu mv mw aw mx bi"><span id="435c" class="le lf it mu b gy my mz l na nb">import markovify<br/>import string</span></pre><p id="a709" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，去掉文本中的所有标点符号，并将其应用于所有文本数据:</p><pre class="md me mf mg gt mt mu mv mw aw mx bi"><span id="c962" class="le lf it mu b gy my mz l na nb">def no_punct(string):<br/> no_punct_string = re.sub(r’[^\w\s]’, ‘’, string)<br/> return no_punct_string</span><span id="8c0a" class="le lf it mu b gy nc mz l na nb">df['Text'] = df.apply(lambda row: no_punct(row['Text']), axis=1)</span></pre><p id="35b8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">训练模型:</p><pre class="md me mf mg gt mt mu mv mw aw mx bi"><span id="e8ff" class="le lf it mu b gy my mz l na nb">text_model = markovify.NewlineText(df.Text, state_size = 2)</span></pre><p id="5992" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">并生成文本:</p><pre class="md me mf mg gt mt mu mv mw aw mx bi"><span id="d516" class="le lf it mu b gy my mz l na nb">for i in range(5):<br/> print(text_model.make_sentence())</span></pre></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><p id="ddb3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">资源:</p><p id="d936" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae nk" href="https://en.wikipedia.org/wiki/Markov_chain" rel="noopener ugc nofollow" target="_blank">维基百科</a></p><p id="daa2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae nk" href="https://www.youtube.com/watch?v=uvYTGEZQTEs" rel="noopener ugc nofollow" target="_blank">帕特里克杰姆特</a></p><p id="bf1b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae nk" href="https://github.com/jsvine/markovify" rel="noopener ugc nofollow" target="_blank">马克维奇</a></p></div></div>    
</body>
</html>