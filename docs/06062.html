<html>
<head>
<title>Automating Personal Investments with Excel and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Excel 和 Python 实现个人投资自动化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automating-personal-investments-with-excel-and-python-6f6a95898522?source=collection_archive---------32-----------------------#2020-05-17">https://towardsdatascience.com/automating-personal-investments-with-excel-and-python-6f6a95898522?source=collection_archive---------32-----------------------#2020-05-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0288" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如你所愿，随时更新你自己的股票投资数据。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0896dfd6eb65f84f18349ea43654de89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*38u7Fw2bwfYSceFl"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@ishant_mishra54?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Ishant Mishra </a>拍摄的照片</p></figure><p id="1660" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还入门 Python？</p><p id="14c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很长一段时间以来，我一直想知道如何开发 Python 项目，因为 Python 在我的日常工作中并没有被大量使用。所以，我在这里看到两种你可能适合的情况:</p><blockquote class="lv"><p id="9589" class="lw lx it bd ly lz ma mb mc md me lu dk translated"><em class="mf">要么你的工作没有给你提供你正在寻找的编程技能</em>，要么事实上<em class="mf">根本没有给你提供任何使用它的机会</em>。</p></blockquote><p id="4951" class="pw-post-body-paragraph kz la it lb b lc mg ju le lf mh jx lh li mi lk ll lm mj lo lp lq mk ls lt lu im bi translated">无论你的情况如何(甚至是不包括在上面的情况)，在这篇文章中，你可能会发现一个有趣的 Python 项目，现在就开始。那么，到底是什么？我设法开发了一种方法，你可以输入你所拥有的股票，并每天跟踪每只股票的表现。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><p id="35ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，代码实际上是做什么的？简而言之，你必须在一个 Excel 文件中提供关于你所拥有的每一只股票的 3 个输入，然后，使用本文中分享的 Python 脚本，以便每天更新每一只股票的表现。</p><p id="8dc5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Excel 文件中需要输入哪些信息？<strong class="lb iu">股票交易代码(“股票行情”)</strong>、<strong class="lb iu">、</strong>、<strong class="lb iu">股票数量(“数量”)、</strong>和<strong class="lb iu">每只股票的总成本(“买入价格”)</strong>。很简单吧？除了这些输入非常简单这一事实之外，强调您只需要输入一次也很重要。</p><p id="0e51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ms"> PS:我是巴西人，所以考虑了一个例子，我从巴西股市挑选了一些股票。</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/76a3bdcb210b107865ef3643450a00f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*u8j8PqyTxGnR2ei2PEzxSw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Excel 文件输入— Stock.xlsx</p></figure><p id="c81c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事不宜迟，我们最后来看看代码本身。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="317f" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">代码:</h1><p id="f3e9" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">我的目标是分享我构建分析的方式，并强调我认为最重要的事情。还有一点很重要，我鼓励你搜索任何你不确定如何工作的<em class="ms">库</em>、<em class="ms">方法、</em>或<em class="ms">属性</em>。</p><h1 id="b54d" class="mu mv it bd mw mx nr mz na nb ns nd ne jz nt ka ng kc nu kd ni kf nv kg nk nl bi translated">第一部分:</h1><p id="3910" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">每次您想要加载过去的数据时，都应该执行以下命令。</p><h2 id="1c26" class="nw mv it bd mw nx ny dn na nz oa dp ne li ob oc ng lm od oe ni lq of og nk oh bi">1.1:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="0ea4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可能从未听说过的库是 yfinance。这是我们代码的核心，因为它通过<a class="ae ky" href="https://finance.yahoo.com/" rel="noopener ugc nofollow" target="_blank"> Yahoo Finance </a> API 提供了您可能想要跟踪的股票价格(和其他一些信息)。</p><p id="6714" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ms"> PS:你可能注意到了我在 Excel 文件输入图像中使用的语法，重要的是确保你写下了</em>股票<em class="ms">谈判的名称，因为它们在雅虎财经中是可用的。</em></p><h2 id="f72c" class="nw mv it bd mw nx ny dn na nz oa dp ne li ob oc ng lm od oe ni lq of og nk oh bi">1.2:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="3a7c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还记得我之前提到的 Excel 文件吗？在我的例子中，它保存为“Stock.xlsx ”,与我保存的目录相同。py 文件(这就是为什么您不必像在其他示例中看到的那样担心提供完整的文件位置，例如“C:/Documents/…”)</p><h2 id="f1c3" class="nw mv it bd mw nx ny dn na nz oa dp ne li ob oc ng lm od oe ni lq of og nk oh bi">1.3:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="51ba" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了逻辑结构之外，我强烈建议您花点时间去理解，我列出了最重要的事情:</p><ul class=""><li id="594b" class="ok ol it lb b lc ld lf lg li om lm on lq oo lu op oq or os bi translated">^BVSP 是巴西主要的股票市场指数，类似于纳斯达克综合指数(^ixic)；</li><li id="63de" class="ok ol it lb b lc ot lf ou li ov lm ow lq ox lu op oq or os bi translated">“收盘”是每只股票的市场收盘价，这是 yfinance 的一个属性。</li></ul><h2 id="4e4d" class="nw mv it bd mw nx ny dn na nz oa dp ne li ob oc ng lm od oe ni lq of og nk oh bi">1.4:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="9abd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我称为“第 1 部分”的结尾。你在这之前都有什么？您创建了一个<a class="ae ky" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" rel="noopener ugc nofollow" target="_blank"> Pandas DataFrame </a>，涵盖了您在 Excel 文件“Stock.xlsx”中考虑的过去一段时间(在本例中为 2 个月)内每天开市的股票价格。</p><p id="e820" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了避免创建多个 Excel 文件，您可能会注意到我覆盖了原始文件。您应该能够看到类似下面的内容(来自表的一部分的快照):</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/246d131d653cb2084f2973bd7e8e4f92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s7WtJ6Wd3e_DSTKAJjcLwA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Excel 文件被股票信息覆盖</p></figure></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><h1 id="d195" class="mu mv it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated">第二部分:</h1><p id="136f" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">你应该在每天股市开盘时执行以下命令。</p><h2 id="6519" class="nw mv it bd mw nx ny dn na nz oa dp ne li ob oc ng lm od oe ni lq of og nk oh bi">2.1:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="7c7a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我只添加了<a class="ae ky" href="https://matplotlib.org/3.2.1/api/_as_gen/matplotlib.pyplot.html" rel="noopener ugc nofollow" target="_blank"> matplotlib.pyplot </a> <em class="ms">库</em>(对我们要做什么有任何猜测吗？).</p><h2 id="029c" class="nw mv it bd mw nx ny dn na nz oa dp ne li ob oc ng lm od oe ni lq of og nk oh bi">2.2:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="0aab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这取决于你将如何保存你的。py 文件。按照我上面写的方法去做，“第 2 部分”会被认为是一个不同的。py 文件(有一部分 1。py 分隔文件，“StockHistory”，因为我只需要执行一次)。如果你想在一个地方拥有一切。py 文件，只需忽略这段代码，将它与所有其他代码行放在一起(但是，您需要注意，您将每天执行不必要的任务)。</p><h2 id="738f" class="nw mv it bd mw nx ny dn na nz oa dp ne li ob oc ng lm od oe ni lq of og nk oh bi">2.3:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="83cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ms"> closePriceList </em>是由执行<em class="ms">方法</em>当天的每只股票价格组成的列表(注意到“[-1]”元素了吗？看看这行代码提供了什么)。</p><h2 id="0bcf" class="nw mv it bd mw nx ny dn na nz oa dp ne li ob oc ng lm od oe ni lq of og nk oh bi">2.4:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="1338" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里的要点是向我们一直使用的 Excel 文件“追加”一个新列。这些列中的每一列都由最近股票价格的列表组成。</p><h2 id="db5e" class="nw mv it bd mw nx ny dn na nz oa dp ne li ob oc ng lm od oe ni lq of og nk oh bi">2.5:</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="0589" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是最长的代码块，但是它的目标很简单:处理<em class="ms"> df </em>以便它的每一行都作为列表提供。需要这些列表来生成以下内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oz"><img src="../Images/d2bbf7f2d295420de1fe68559c943cfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3GWCSgXben4Ey7g2uExKNA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">股票每日余额[BRL 价值]</p></figure><p id="3af0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个投资组合所有者应该考虑改变策略，对吗？</p><p id="6cdd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你喜欢它。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><p id="c412" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我在 Medium 上的第一篇文章。这里重要的是分享一些有用的东西，这些东西可以用 Python 来完成，特别是对于那些不直接使用它，但希望学习更多的人。例如，您可以修改此代码来绘制累计余额，并区分您购买每只股票的日期。这取决于你自己的想象力和必要性。</p></div></div>    
</body>
</html>