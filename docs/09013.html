<html>
<head>
<title>Visualizing data with RoughViz.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 RoughViz.js 可视化数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-data-with-roughviz-js-77b8f96331e9?source=collection_archive---------57-----------------------#2020-06-28">https://towardsdatascience.com/visualizing-data-with-roughviz-js-77b8f96331e9?source=collection_archive---------57-----------------------#2020-06-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e2a9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 RoughViz.js 让您的图表更有趣、更具互动性</h2></div><p id="3bb9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本教程中，我们将深入到<a class="ae le" href="https://github.com/jwilber/roughViz" rel="noopener ugc nofollow" target="_blank"> RoughViz.js </a>来可视化数据。有了它，你就能画出具有草图视觉效果的图形。对于本教程，我们将使用<strong class="kk iu"/><a class="ae le" href="https://disease.sh/v2/countries" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu">disease . sh</strong></a>API<strong class="kk iu"/>来可视化各个国家的人口和新冠肺炎数据。我选择这个库的原因是对如何可视化数据有一个更开放的想法。随着每一次数据可视化，我们用不同的艺术风格讲述一个故事可以极大地改变人们对它的看法。对我来说，这也是一个实验，看看使用 RoughViz.js 这样的工具的数据可视化是否可以因为本库使用的视觉效果而使看起来枯燥的主题变得更有趣。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/4ccbc59005d9b4ebde101afef17d5865.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*x562RQ21PKPV4BCdt2TkJg.gif"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><a class="ae le" href="https://github.com/jwilber/roughViz" rel="noopener ugc nofollow" target="_blank"> RoughViz.js </a>示例图</p></figure><h1 id="692f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">设置我们的开发人员环境</h1><p id="f96c" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">对于本教程，我们将使用 React 创建一个项目。建立 react 项目最简单的方法是通过<a class="ae le" href="https://create-react-app.dev/docs/getting-started" rel="noopener ugc nofollow" target="_blank">创建 React 应用</a>。如果您还没有安装 create react 应用程序，请检查他们的<a class="ae le" href="https://create-react-app.dev/docs/getting-started/" rel="noopener ugc nofollow" target="_blank">文档</a>以准备好工具开始使用。我们将使用以下命令创建并运行项目:</p><pre class="lg lh li lj gt ms mt mu mv aw mw bi"><span id="228f" class="mx lw it mt b gy my mz l na nb">npx create-react-app rough-viz</span><span id="2037" class="mx lw it mt b gy nc mz l na nb">cd rough-viz</span><span id="21dc" class="mx lw it mt b gy nc mz l na nb">npm start</span></pre><p id="ce07" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">文件夹的名字可以是你喜欢的任何名字，但这是我在本教程中选择的。执行<code class="fe nd ne nf mt b">npm <strong class="kk iu">start</strong></code>应该显示一个带有旋转 react 标志的运行页面。现在让我们安装 RoughViz.js，这样我们就可以在我们的项目中使用它了。因为我们使用 react，所以我们将安装 react 包装器。</p><pre class="lg lh li lj gt ms mt mu mv aw mw bi"><span id="00f2" class="mx lw it mt b gy my mz l na nb">npm install react-roughviz --save</span></pre><p id="d991" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在可以开始在<code class="fe nd ne nf mt b">app.js</code>中导入库了。从起始项目中移除所有代码，并添加导入。你的<code class="fe nd ne nf mt b">app.js</code>应该是这样的:</p><pre class="lg lh li lj gt ms mt mu mv aw mw bi"><span id="d3a2" class="mx lw it mt b gy my mz l na nb">import React from 'react';<br/>import { Bar, StackedBar, Scatter } from 'react-roughviz'<br/>import './App.css';</span><span id="ce0b" class="mx lw it mt b gy nc mz l na nb">function App() {</span><span id="7735" class="mx lw it mt b gy nc mz l na nb">return (</span><span id="9186" class="mx lw it mt b gy nc mz l na nb">&lt;div className="App"&gt;<br/>      &lt;header className="App-header"&gt;<br/>     <br/>      <br/>      &lt;/header&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="f0d1" class="mx lw it mt b gy nc mz l na nb">export default App;</span></pre><h1 id="264a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建我们的第一个条形图</h1><p id="1a7e" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">我们现在可以开始 bij 建立我们的第一个图表。现在，我们将使用一个硬编码的数组来向您展示 RoughViz.js 的功能。不要担心，在我们设置完第一个图表后，我们将使用来自 API 的数据。对于第一张图表，我们将使用条形图。使用下面的代码，你应该能够看到一个有 4 个条的条形图。</p><pre class="lg lh li lj gt ms mt mu mv aw mw bi"><span id="d6cd" class="mx lw it mt b gy my mz l na nb">&lt;Bar<br/>    data={{<br/>        labels: ['Appels',<br/>            'Bananas',<br/>            'Strawberries',<br/>            'Blueberries'    <br/>              values: [10, 5, 8, 3],<br/>            }}<br/>    color="pink"<br/>    title="Top 4 sold fruits"<br/>    stroke='coral'<br/>    axisFontSize={"1.5rem"}<br/>    tooltipFontSize={"2rem"}<br/>    roughness={5}<br/>    labelFontSize={'3rem'}<br/>    strokeWidth={2}<br/>    fillStyle="hachure"<br/>    fillWeight={1}<br/>    margin={{ top: 70, right: 50, bottom: 80, left: 150 }}<br/>    padding={0.2}<br/>    height={700}<br/>    width={window.innerWidth - 100}<br/>    font={1}<br/>/&gt;</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ng"><img src="../Images/2011880d1b11e583dd1c53ce324398d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y09Voa9rjkCR538kI_5aZQ.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图 1:条形图销售的前 4 种水果</p></figure><p id="a0f7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我添加了一些额外的可选属性，如<code class="fe nd ne nf mt b">fillWeight</code>、<code class="fe nd ne nf mt b">axisFontSize</code>、<code class="fe nd ne nf mt b">roughness</code>和<code class="fe nd ne nf mt b">padding</code>。我添加了这些属性，以便您可以随意使用。更改这些值，并查看它对图形的影响。增加<code class="fe nd ne nf mt b">roughness</code>和<code class="fe nd ne nf mt b">fillWeight</code>特别有趣，因为它允许我们将图表从图 1 变成类似下面的图 2。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nh"><img src="../Images/669ad3ea04e62cd8a6f26ebd88f081b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vzA6th5ylHF0J-VdIzktvw.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图 2:粗糙度和填充重量增加的相同条形图</p></figure><h1 id="98f2" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">用 API 数据填充图表</h1><p id="0869" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">在这个例子中，我们将使用<a class="ae le" href="https://disease.sh/v2/countries" rel="noopener ugc nofollow" target="_blank"> Disease.sh </a> API 来显示人口最多的 10 个国家。让我们首先设置 API 调用，以便用来获取我们想要的数据。首先导入<code class="fe nd ne nf mt b">useState</code>和<code class="fe nd ne nf mt b">useEffect</code>，因为我们将使用它们来存储我们的数据。</p><pre class="lg lh li lj gt ms mt mu mv aw mw bi"><span id="2949" class="mx lw it mt b gy my mz l na nb">import React, { <strong class="mt iu">useState, useEffect</strong> } from 'react';</span></pre><p id="b041" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来用<code class="fe nd ne nf mt b">useState</code>初始化变量以存储数据。我们还需要为人口和姓名初始化一个单独的数组，因为我们需要两个数组，一个用于标签，另一个用于人口字段。</p><pre class="lg lh li lj gt ms mt mu mv aw mw bi"><span id="e767" class="mx lw it mt b gy my mz l na nb">const [data, setData] = useState([]);</span><span id="148a" class="mx lw it mt b gy nc mz l na nb">let population = [];</span><span id="fde6" class="mx lw it mt b gy nc mz l na nb">let names = [];</span></pre><p id="9a7b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们将创建一个<code class="fe nd ne nf mt b">fetchData</code>函数，该函数将调用 API 来检索数据。检索之后，我们可以将这个响应存储在上面初始化的<code class="fe nd ne nf mt b">setData</code>中。尝试控制台记录数据，看看是否能从 API 获得数据输出。如果一切就绪，我们可以开始过滤数据，只显示人口最多的前 10 个国家。我们将使用 ES6 中的过滤功能来只检索这些国家，并将它们从最高到最低排序。</p><pre class="lg lh li lj gt ms mt mu mv aw mw bi"><span id="2005" class="mx lw it mt b gy my mz l na nb">useEffect(() =&gt; {<br/>    fetchData();<br/>  }, [])</span><span id="1321" class="mx lw it mt b gy nc mz l na nb">const fetchData = () =&gt; {<br/>    fetch(`<a class="ae le" href="https://disease.sh/v2/countries`" rel="noopener ugc nofollow" target="_blank">https://disease.sh/v2/countries`</a>)<br/>      .then(response =&gt; response.json())<br/>      .then(json =&gt; setData(json))<br/>  }</span></pre><p id="ef9a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完成后，我们将把它存储在。将函数映射到我们上面初始化的人口变量中。最后，我们还将填充上面的 names 数组，以在图表的标签字段中显示每个国家的名称。</p><pre class="lg lh li lj gt ms mt mu mv aw mw bi"><span id="08fe" class="mx lw it mt b gy my mz l na nb">let dataCut = data.filter(<em class="ni">a</em> =&gt; (<em class="ni">a</em>.population &gt; 106932753) &amp;&amp; data.sort((<em class="ni">a</em>, <em class="ni">b</em>) =&gt; <em class="ni">b</em>.population - <em class="ni">a</em>.population));</span><span id="5330" class="mx lw it mt b gy nc mz l na nb">population = dataCut.map((<em class="ni">a</em>) =&gt; <em class="ni">a</em>.population);<br/>names = dataCut.map((<em class="ni">a</em>) =&gt; <em class="ni">a</em>.country);</span></pre><p id="65ce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在可以用新检索到的数据填充图表。图形的代码看起来应该是一样的，唯一不同的是数据属性。</p><pre class="lg lh li lj gt ms mt mu mv aw mw bi"><span id="b0ff" class="mx lw it mt b gy my mz l na nb">&lt;Bar<br/>    <em class="ni">data</em>={{<br/>     labels: names,<br/>     values: population<br/>    }}<br/>    color="pink"<br/>    title="Top 4 sold fruits"<br/>    stroke='coral'<br/>    axisFontSize={"1.5rem"}<br/>    tooltipFontSize={"2rem"}<br/>    roughness={5}<br/>    labelFontSize={'3rem'}<br/>    strokeWidth={2}<br/>    fillStyle="hachure"<br/>    fillWeight={1}<br/>    margin={{ top: 70, right: 50, bottom: 80, left: 150 }}<br/>    padding={0.2}<br/>    height={700}<br/>    width={window.innerWidth - 100}<br/>    font={1}<br/>/&gt;</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/7b6785b1b1450cc07d8832a8456663a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*FcNo4TM3IL7PuM6qHy0Dpw.gif"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图 3:拥有 API 数据的前 10 个人口大国</p></figure><p id="71e5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果操作正确，您的图表应该如图 3 所示。</p><h1 id="634a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">显示前 10 个活动新冠肺炎案例的散点图</h1><p id="7000" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">现在我们可以尝试另一个图表。散点图的代码大致相同。这里最重要的区别是，我们将数据存储在 x 和 y 属性中，而不是标签和值中。我们仍将使用人口数组，但添加了一个活动数组来显示每个国家有多少活动病例。接下来，我们还应该设置地图上显示的每个圆圈的<code class="fe nd ne nf mt b">radius</code>。我把我的设置为 40，但你可以设置为任何你想要的。接下来，我们还添加了一个<code class="fe nd ne nf mt b">colors</code>属性来添加颜色数组。这是用来确定什么颜色的一个圆的基础上的价值</p><pre class="lg lh li lj gt ms mt mu mv aw mw bi"><span id="6ed5" class="mx lw it mt b gy my mz l na nb">let population = [];<br/>  let names = [];<br/> <strong class="mt iu"> let active = [];</strong> </span><span id="54a5" class="mx lw it mt b gy nc mz l na nb">useEffect(() =&gt; {<br/>    fetchData();<br/>  }, [])<br/>const fetchData = () =&gt; {<br/>    fetch(`<a class="ae le" href="https://disease.sh/v2/countries`" rel="noopener ugc nofollow" target="_blank">https://disease.sh/v2/countries`</a>)<br/>      .then(response =&gt; response.json())<br/>      .then(json =&gt; setData(json))<br/>  }</span><span id="71f1" class="mx lw it mt b gy nc mz l na nb">let dataCut = data.filter(a =&gt; (a.population &gt; 106932753) &amp;&amp;  data.sort((a, b) =&gt; b.population - a.population));</span><span id="fb2c" class="mx lw it mt b gy nc mz l na nb">population = dataCut.map((a) =&gt; a.population);</span><span id="bc69" class="mx lw it mt b gy nc mz l na nb"><strong class="mt iu">active = dataCut.map((a) =&gt; a.active);</strong></span><span id="212a" class="mx lw it mt b gy nc mz l na nb">&lt;Scatter<br/>    data={{<br/>        x: population,<br/>        y: <strong class="mt iu">active</strong><br/>    }}<br/>    title='Population country versus active covid-19 cases'<br/>    titleFontSize={'2rem'}<br/>    roughness={2}<br/>    bowing={true}<br/>    radius={40}<br/>    xLabel={'Population'}<br/>    yLabel={'active covid-19 cases'}<br/>    labelFontSize={'2rem'}<br/>    fillWeight={8}<br/>    axisRoughness={0}<br/>    font={0}<br/>    height={700}<br/>    tooltipFontSize={'1.5rem'}<br/>    colors={['#a6cee3', '#1f78b4', '#b2df8a', '#33a02c', '#fb9a99',  '#e31a1c', '#fdbf6f', '#ff7f00', '#cab2d6', '#6a3d9a', '#ffff99', '#b15928']}<br/>    width={window.innerWidth}<br/>    margin={{ top: 50, right: 50, bottom: 170, left: 300 }}<br/>    curbZero={true}</span></pre><p id="e771" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果实现正确，您的图表应该如图 4 所示。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nk"><img src="../Images/7521953acff859ae8fff0e1830aa9dee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S2TiCGiqxbfRZk62EumElw.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图 4:人口国家与活跃的新冠肺炎病例</p></figure><p id="d8e6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">太好了，你现在已经用真实的 API 数据做出了两个很棒的图表。RoughViz.js 有更多的图形，如折线图、堆积条形图和圆形图。在图 5 中是另一个例子，我用同样的新冠肺炎数据制作了散点图。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nl"><img src="../Images/5be5906d98018af24ab10700065f04ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BDBB2bHiQwC7rhtMDP80Gg.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图 5:每个国家的死亡/康复/活跃病例</p></figure><p id="e1d4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想了解他们的图书馆，你可以查看他们的<a class="ae le" href="https://github.com/jwilber/roughViz" rel="noopener ugc nofollow" target="_blank"> GitHub 页面</a>。他们有各种代码甚至 React、Vue 和 Python 的包装器的例子。我希望你喜欢这个教程，并学到一些新的东西。编码快乐！</p><p id="317b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">本文使用的资源… </strong></p><ul class=""><li id="e6b0" class="nm nn it kk b kl km ko kp kr no kv np kz nq ld nr ns nt nu bi translated">rough viz . js—<a class="ae le" href="https://github.com/jwilber/roughViz" rel="noopener ugc nofollow" target="_blank">github rough viz . js</a></li><li id="997c" class="nm nn it kk b kl nv ko nw kr nx kv ny kz nz ld nr ns nt nu bi translated">NovelCOVID API — <a class="ae le" href="https://github.com/NovelCOVID/API" rel="noopener ugc nofollow" target="_blank">全球新冠肺炎 api </a></li></ul></div></div>    
</body>
</html>