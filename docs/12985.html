<html>
<head>
<title>Fast and Less Restricted Style Transfer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">更快和更少限制的风格转移</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fast-and-less-restricted-style-transfer-50366c43f672?source=collection_archive---------51-----------------------#2020-09-06">https://towardsdatascience.com/fast-and-less-restricted-style-transfer-50366c43f672?source=collection_archive---------51-----------------------#2020-09-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="cfb2" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">神经类型转移，进化</h2><div class=""/><div class=""><h2 id="28ad" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">基于条件实例规范化的图像风格转换</h2></div><h2 id="df50" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">介绍</h2><p id="b929" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">仿制品是模仿另一件作品风格的艺术作品。<strong class="ll ja"> <em class="mc">风格转移</em> </strong>可以定义为找到一个模仿图像<strong class="ll ja"> <em class="mc"> p </em> </strong>其内容与一个内容图像<strong class="ll ja"> <em class="mc"> c </em> </strong>相似但其风格与一个风格图像<strong class="ll ja"> <em class="mc"> s </em> </strong>相似。</p><h2 id="8683" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">背景</h2><blockquote class="md me mf"><p id="f87c" class="lj lk mc ll b lm mg ka lo lp mh kd lr mi mj lt lu mk ml lw lx mm mn lz ma mb ij bi translated">如果您熟悉<a class="ae mo" rel="noopener" target="_blank" href="/slow-and-arbitrary-style-transfer-3860870c8f0e">基于优化的风格传递</a>和<a class="ae mo" rel="noopener" target="_blank" href="/fast-and-restricted-style-transfer-bbfc383cccd6">前馈风格传递网络</a>，请随意跳过本节。</p></blockquote><p id="2654" class="pw-post-body-paragraph lj lk iq ll b lm mg ka lo lp mh kd lr kx mj lt lu lb ml lw lx lf mn lz ma mb ij bi translated">神经类型转移算法提出了以下定义:</p><ol class=""><li id="d242" class="mp mq iq ll b lm mg lp mh kx mr lb ms lf mt mb mu mv mw mx bi translated"><strong class="ll ja"> <em class="mc">内容相似度</em> </strong>:如果由训练好的分类器提取的两个图像的高级特征在欧几里德距离上接近，则这两个图像在内容上是相似的</li><li id="06b1" class="mp mq iq ll b lm my lp mz kx na lb nb lf nc mb mu mv mw mx bi translated"><strong class="ll ja"> <em class="mc">风格相似度</em> </strong>:如果由训练好的分类器提取的两幅图像的低层特征共享相同的统计量，则这两幅图像风格相似。</li></ol><p id="c0df" class="pw-post-body-paragraph lj lk iq ll b lm mg ka lo lp mh kd lr kx mj lt lu lb ml lw lx lf mn lz ma mb ij bi translated"><a class="ae mo" rel="noopener" target="_blank" href="/slow-and-arbitrary-style-transfer-3860870c8f0e"> <strong class="ll ja"> <em class="mc">缓慢而随意的风格转移</em> </strong> </a></p><p id="a238" class="pw-post-body-paragraph lj lk iq ll b lm mg ka lo lp mh kd lr kx mj lt lu lb ml lw lx lf mn lz ma mb ij bi translated">在其原始公式[R1]中，神经风格转移算法进行如下:从<strong class="ll ja"><em class="mc">【p】</em></strong>(例如<strong class="ll ja"> <em class="mc"> c、</em> </strong>或一些随机初始化)的一些初始化开始，该算法调整<strong class="ll ja"> <em class="mc"> p </em> </strong>以最小化图 1 中描述的个体内容和风格损失函数。</p><figure class="ne nf ng nh gt ni gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi nd"><img src="../Images/401e5f9d0534f66aeacfa7810715ef45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hpv86OU9Yr10uPhoIR9HKw.png"/></div></div><p class="np nq gj gh gi nr ns bd b be z dk translated"><strong class="bd nt">图一。</strong>基于优化的神经式传递损失公式</p></figure><blockquote class="md me mf"><p id="feb4" class="lj lk mc ll b lm mg ka lo lp mh kd lr mi mj lt lu mk ml lw lx mm mn lz ma mb ij bi translated">而上面的算法是<strong class="ll ja"> <em class="iq">灵活(+) </em> </strong>，运行起来就是<strong class="ll ja"> <em class="iq">昂贵(-) </em> </strong>。</p></blockquote><p id="558f" class="pw-post-body-paragraph lj lk iq ll b lm mg ka lo lp mh kd lr kx mj lt lu lb ml lw lx lf mn lz ma mb ij bi translated"><a class="ae mo" rel="noopener" target="_blank" href="/fast-and-restricted-style-transfer-bbfc383cccd6"> <strong class="ll ja"> <em class="mc">快速和受限风格转移</em> </strong> </a></p><p id="bae0" class="pw-post-body-paragraph lj lk iq ll b lm mg ka lo lp mh kd lr kx mj lt lu lb ml lw lx lf mn lz ma mb ij bi translated">为了加速上述过程，引入了称为风格转移网络<strong class="ll ja"><em class="mc"/></strong>【R2】的前馈卷积网络来学习转换。它将内容图像<strong class="ll ja"> <em class="mc"> c </em> </strong> <em class="mc"> </em>作为输入，并直接输出仿作图像<strong class="ll ja"> <em class="mc"> p </em> </strong>。使用图 2 中描述的损失函数在许多内容图像上训练网络。在测试时，变换网络<strong class="ll ja"> <em class="mc"> T </em> </strong>变换<strong class="ll ja"> <em class="mc">任何</em> </strong>内容图像以适应与前馈网络相关联的<strong class="ll ja"> <em class="mc">单个</em> </strong>样式图像的样式。</p><figure class="ne nf ng nh gt ni gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi nd"><img src="../Images/c330aa2aea12371a2890cc72bdf130cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wdk_TfaojO_KtWzlq6sO6g.png"/></div></div><p class="np nq gj gh gi nr ns bd b be z dk translated"><strong class="bd nt">图二。</strong>前馈神经式传递损失公式</p></figure><blockquote class="md me mf"><p id="aa60" class="lj lk mc ll b lm mg ka lo lp mh kd lr mi mj lt lu mk ml lw lx mm mn lz ma mb ij bi translated">虽然推论是<strong class="ll ja"> <em class="iq">快速(+) </em> </strong>，但它是<strong class="ll ja"> <em class="iq">受限的(-) </em> </strong>，因为每种个人风格都需要单独的网络来训练</p></blockquote><h2 id="f746" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">较少限制的前馈式传输网络</h2><p id="43bb" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">先前的为每种风格建立单独网络的前馈风格传递方法[R2]忽略了许多风格可能共享某种程度的计算的事实，并且当建立多风格风格传递网络时，这种共享被从零开始训练 N 个网络所丢弃。例如，许多印象派画作的笔触相似，但使用的调色板不同。那样的话，把一套 N 幅印象派的画当作完全独立的风格来看，似乎是非常浪费的。</p><p id="beae" class="pw-post-body-paragraph lj lk iq ll b lm mg ka lo lp mh kd lr kx mj lt lu lb ml lw lx lf mn lz ma mb ij bi translated">杜谋林<em class="mc">等人</em>【R3】训练单<strong class="ll ja">T3】有条件 T5】风格转移网络<strong class="ll ja"> <em class="mc"> T(c，s) </em> </strong>为<strong class="ll ja"> <em class="mc"> N 风格</em> </strong>。他们不是学习单一的一组仿射参数<em class="mc"> γ </em> ( <strong class="ll ja"> <em class="mc">缩放</em> </strong>)和<em class="mc"> β </em> ( <strong class="ll ja"> <em class="mc">平移</em> </strong>)，而是提出了一种<strong class="ll ja"> <em class="mc">条件</em> </strong> <a class="ae mo" href="https://becominghuman.ai/all-about-normalization-6ea79e70894b" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ja"> <em class="mc">实例归一化</em></strong><strong class="ll ja"><em class="mc"/></strong>(<strong class="ll ja"><em class="mc">CIN</em></strong>在训练期间，从一组固定的样式<strong class="ll ja"><em class="mc">【S ∈{ 1，2，…，S} </em> </strong>中随机选择一个样式图像及其索引<strong class="ll ja"> <em class="mc"> s </em> </strong>。然后，内容图像由风格传输网络处理，其中在<strong class="ll ja"><em class="mc"/></strong>层中使用相应的<em class="mc"> γs </em>和<em class="mc"> βs </em>。令人惊讶的是，网络在 </a></strong>层中使用<strong class="ll ja"> <em class="mc">相同的卷积参数但不同的仿射参数，可以生成风格完全不同的图像。</em></strong></p><figure class="ne nf ng nh gt ni gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi nd"><img src="../Images/21ac88031b6540e337f5fa82a6958b73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pN2DrGCGsQurI7Rj0rMi_Q.png"/></div></div><p class="np nq gj gh gi nr ns bd b be z dk translated"><strong class="bd nt">图 4。</strong>条件实例规范化。输入激活 x 在两个空间维度上被归一化，随后使用风格相关的参数向量<em class="nu"> γs 和βs 进行缩放和移位，其中 s 表示风格标签。图片取自“[R3] </em>艺术风格的学术代表”</p></figure><p id="cc8e" class="pw-post-body-paragraph lj lk iq ll b lm mg ka lo lp mh kd lr kx mj lt lu lb ml lw lx lf mn lz ma mb ij bi translated"><strong class="ll ja"> <em class="mc"> CIN </em> </strong>(图 4)层的引入允许单个网络学习风格转移为<strong class="ll ja"> <em class="mc">多个风格</em> </strong>。它具有以下特性:</p><ol class=""><li id="0a77" class="mp mq iq ll b lm mg lp mh kx mr lb ms lf mt mb mu mv mw mx bi translated">这种方法<strong class="ll ja"> <em class="mc">灵活</em> </strong>但可与单一用途的传输网络相媲美。一个额外的优势是，人们可以通过一个批量大小为 N 的前馈通道将单个图像风格化为 N 种绘画风格(图 5.a)。</li><li id="7531" class="mp mq iq ll b lm my lp mz kx na lb nb lf nc mb mu mv mw mx bi translated">该模型将每个风格图像简化为嵌入空间中的一个点(<em class="mc"> γs，βs </em>)，从而简洁地捕捉到各种绘画的艺术风格。嵌入空间的表现允许人们以前所未见的新方式任意组合艺术风格(图 5.b)。</li></ol><figure class="ne nf ng nh gt ni gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/af68cf41bbadb361505cf65b703ffd75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*3vScDCgaEZFb07MHW5Yo2Q.png"/></div><p class="np nq gj gh gi nr ns bd b be z dk translated"><strong class="bd nt">图 5。</strong>由风格转移网络制作的模仿品，该网络根据为其多样性选择的 32 种风格进行训练。图片摘自“[R3]艺术风格的学术代表”</p></figure><h2 id="e924" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">结论</h2><p id="97d1" class="pw-post-body-paragraph lj lk iq ll b lm ln ka lo lp lq kd lr kx ls lt lu lb lv lw lx lf ly lz ma mb ij bi translated">以上做法是<strong class="ll ja"> <em class="mc">快</em> </strong>然而<strong class="ll ja"> <em class="mc">灵活</em> </strong>有一定程度。仍然存在的一个问题是，要包含一个新的样式，您需要将它包含在集合<strong class="ll ja"> <em class="mc"> S </em> </strong>中，并再次训练网络。</p><h2 id="a191" class="ko kp iq bd kq kr ks dn kt ku kv dp kw kx ky kz la lb lc ld le lf lg lh li iw bi translated">参考</h2><ol class=""><li id="2f78" class="mp mq iq ll b lm ln lp lq kx nw lb nx lf ny mb mu mv mw mx bi translated">利昂·A·加蒂斯、亚历山大·S·埃克和马蒂亚斯·贝奇。<a class="ae mo" href="https://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Gatys_Image_Style_Transfer_CVPR_2016_paper.pdf" rel="noopener ugc nofollow" target="_blank">使用卷积神经网络的图像风格转换</a>。在<em class="mc"> CVPR </em>，2016。</li><li id="4db9" class="mp mq iq ll b lm my lp mz kx na lb nb lf nc mb mu mv mw mx bi translated">贾斯廷·约翰逊，亚历山大·阿拉希和李菲菲。<a class="ae mo" href="https://arxiv.org/abs/1603.08155" rel="noopener ugc nofollow" target="_blank">实时风格转换和超分辨率的感知损失</a>。在 2016 年<em class="mc"> ECCV </em>。</li><li id="1cc6" class="mp mq iq ll b lm my lp mz kx na lb nb lf nc mb mu mv mw mx bi translated">文森特·杜穆林，黄邦贤·史伦斯，曼朱纳斯·库德鲁尔。艺术风格的学术代表。在<em class="mc"> ICLR，</em> 2017。</li></ol></div></div>    
</body>
</html>