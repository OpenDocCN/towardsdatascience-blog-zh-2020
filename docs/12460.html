<html>
<head>
<title>Few-Shot Learning with fast.ai</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 fast.ai 进行少拍学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/few-shot-learning-with-fast-ai-81c66064e372?source=collection_archive---------24-----------------------#2020-08-27">https://towardsdatascience.com/few-shot-learning-with-fast-ai-81c66064e372?source=collection_archive---------24-----------------------#2020-08-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4739" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在少镜头学习中，我们只使用几个带标签的例子来训练一个模型。了解如何使用迁移学习和一个新颖的样本选择框架来训练您的分类器。</h2></div><h1 id="45fd" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">介绍</h1><p id="2994" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">最近，关于新的深度学习架构和训练策略的帖子和教程主导了社区。然而，一个非常有趣的研究领域，即少数镜头学习，并没有得到应有的重视。如果我们想要广泛采用 ML，我们需要找到用很少的数据和代码有效训练它们的方法。在本教程中，我们将通过一个 Google Colab 笔记本来训练一个图像分类模型，每个类仅使用 5 个标记样本。仅使用 5 个示例性样本也被称为 5 次学习。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/1fe655ded8cfe0985bb48ee0729aa7c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*aG6UvkQordnAzMN0OCJbPw.png"/></div><p class="mb mc gj gh gi md me bd b be z dk translated">该图显示了仅在 10 幅样本图像上训练的模型的最高损失</p></figure><blockquote class="mf mg mh"><p id="688d" class="kx ky mi kz b la mj jr lc ld mk ju lf ml mm li lj mn mo lm ln mp mq lq lr ls ij bi translated">不要忘记查看<a class="ae mr" href="https://colab.research.google.com/drive/11j4aJv50UxEVZbuUluOGqCMKIZrx7pUM?usp=sharing" rel="noopener ugc nofollow" target="_blank">我们的 Google Colab 笔记本</a>以获得本教程的完整代码！</p></blockquote><h1 id="bf22" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">我们使用的框架和库</h1><p id="8c32" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> Jupyter 笔记本(Google Colab) <br/> </strong> <a class="ae mr" href="https://colab.research.google.com/drive/11j4aJv50UxEVZbuUluOGqCMKIZrx7pUM?usp=sharing" rel="noopener ugc nofollow" target="_blank">本教程的全部代码将作为笔记本</a>提供。Jupyter 笔记本是可通过 web 浏览器访问的 python 编程环境，对于快速原型制作和实验非常有用。Colab 是谷歌的一项服务，在这里你可以免费访问运行在实例上的笔记本。</p><p id="244c" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated"><strong class="kz ir"> Fast.ai <br/> </strong>训练深度学习模型可能相当复杂，涉及数百行代码。这就是<a class="ae mr" href="https://www.fast.ai/" rel="noopener ugc nofollow" target="_blank"> fast.ai </a>来救援的地方。由前凯格勒·杰瑞米·霍华德开发的一个库专门旨在快速简单地训练深度学习模型。使用 fast.ai，我们只需几行代码就可以训练和评估我们的分类器。其实，fast.ai 使用的是 PyTorch 框架。</p><p id="3747" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated"><strong class="kz ir">轻轻的<br/> </strong> <a class="ae mr" href="https://www.lightly.ai" rel="noopener ugc nofollow" target="_blank">轻轻的</a>旨在解决你应该处理哪些样本的问题。如果你只标注了数据集中的一些样本，那么出现的一个关键问题是你如何挑选样本？Lightly 旨在通过为您提供选择样品的不同方法和指标来解决这一问题</p><h1 id="a794" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">设置您的笔记本</h1><p id="6133" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们从安装必要的依赖项和下载数据集开始。您可以在笔记本中运行任何 shell 命令，只需以<strong class="kz ir">"！"开始代码即可<br/> </strong>例如，要安装我们的依赖项，我们可以在一个笔记本单元中运行以下代码:</p><figure class="lu lv lw lx gt ly"><div class="bz fp l di"><div class="ms mt l"/></div><p class="mb mc gj gh gi md me bd b be z dk translated">在笔记本单元内安装依赖项的代码</p></figure><p id="f195" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated">在本教程中，我们使用由猫和狗图像组成的数据集。您可以通过运行以下命令，使用 fastai CLI(命令行界面)从<a class="ae mr" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>下载它。注意，您需要修改从 Kaggle 获得的令牌:</p><figure class="lu lv lw lx gt ly"><div class="bz fp l di"><div class="ms mt l"/></div><p class="mb mc gj gh gi md me bd b be z dk translated">使用 Kaggle CLI 下载数据集并解压缩文件夹</p></figure><h1 id="0728" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">选择少量学习的样本</h1><p id="fcdc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了使用我们的少镜头学习算法获得稳健的结果，我们希望我们的训练集覆盖样本的整个空间。这意味着我们不想要很多相似的例子，而是选择一组非常不同的图片。为了实现这一点，我们可以创建数据集的嵌入，然后使用一种叫做 coreset[1]采样的采样方法。核心集采样确保我们仅通过添加尽可能远离现有数据集的样本来构建数据集。</p><p id="88b9" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated">现在，我们将使用<a class="ae mr" href="https://www.lightly.ai" rel="noopener ugc nofollow" target="_blank"> Lightly app </a>及其 python 包<a class="ae mr" href="https://github.com/lightly-ai/lightly" rel="noopener ugc nofollow" target="_blank"> lightly </a>来选择我们想要处理的最多样化的 10 个样本。我们首先需要创建一个嵌入。通过利用最近在自我监督学习中取得的成功，轻松地让我们不用任何标签就能做到这一点。我们可以简单地运行下面的命令来训练几个时期的模型，并创建我们的嵌入:</p><figure class="lu lv lw lx gt ly"><div class="bz fp l di"><div class="ms mt l"/></div><p class="mb mc gj gh gi md me bd b be z dk translated">使用 lightly pip 包训练和嵌入数据集</p></figure><p id="1ac0" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated">最后，我们需要上传我们的数据集并嵌入到<a class="ae mr" href="https://app.lightly.ai" rel="noopener ugc nofollow" target="_blank"> Lightly app </a>来运行我们的选择算法。由于我们不想上传图像，我们可以告诉 CLI 只考虑样本的元数据。</p><figure class="lu lv lw lx gt ly"><div class="bz fp l di"><div class="ms mt l"/></div><p class="mb mc gj gh gi md me bd b be z dk translated">上传元数据并嵌入到 Lightly 的 CLI 命令</p></figure><p id="e55f" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated">一旦上传了数据和嵌入，我们就可以回到网络平台，运行我们的采样算法。这可能需要一分钟才能完成。如果一切顺利，你应该会看到一个滑块图。向左移动滑块，在新的子集中仅保留 10 个样本。提示:您可以使用箭头键一个接一个地移动滑块。一旦我们选择了 10 个样本，我们需要创建一个新的标签(左侧菜单)。对于本教程，我们使用“tiny”作为名称，并按 enter 键创建它。</p><p id="c29e" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated">使用以下 CLI 命令下载新创建的子集:</p><figure class="lu lv lw lx gt ly"><div class="bz fp l di"><div class="ms mt l"/></div><p class="mb mc gj gh gi md me bd b be z dk translated">下载基于标签的子集，并创建我们想要处理的图像的本地副本</p></figure><p id="3b5c" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated">您可能会发现您下载的数据集并不完全平衡。例如，你可能有 4 张猫的图片和 6 张狗的图片。这是由于我们选择样本的算法。我们的目标是覆盖整个嵌入/特征空间。很可能在我们的数据集中，猫的相似图像比狗的图像更多。因此，狗的图像会比猫的多。</p><h1 id="4679" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">使用 fast.ai 训练我们的模型</h1><p id="7917" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你达到这一点，你应该有一个数据集，我们使用轻度和 Coreset 采样获得，准备用于训练我们的分类器。</p><p id="9b8b" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated">Fast.ai 只需要几行代码就可以训练一个图像分类器。我们首先需要创建一个数据集，然后是一个学习者对象。最后，我们使用<code class="fe mu mv mw mx b">.fit(...)</code>方法训练模型。</p><figure class="lu lv lw lx gt ly"><div class="bz fp l di"><div class="ms mt l"/></div><p class="mb mc gj gh gi md me bd b be z dk translated">Fast.ai 代码，使用迁移学习来构建和训练分类器</p></figure><h1 id="6046" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">解释结果</h1><p id="aecb" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了评估我们的模型，我们使用由 2000 幅图像组成的猫狗数据集的测试集。通过观察混淆矩阵，我们发现我们的模型很难预测狗是猫。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi my"><img src="../Images/e51e49405f85df329c2c5feb01c74ac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*khfUjAkLFaJxeFqmt799Vg.png"/></div><p class="mb mc gj gh gi md me bd b be z dk translated">在 10 个样本上训练的模型的混淆矩阵</p></figure><p id="ec3f" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated">Fast.ai 还帮助我们用几行代码就可以得到我们模型的可解释的性能图。</p><figure class="lu lv lw lx gt ly"><div class="bz fp l di"><div class="ms mt l"/></div><p class="mb mc gj gh gi md me bd b be z dk translated">Fast.ai 代码来创建我们的模型如何在测试集上执行的图表</p></figure><p id="5b6d" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated">该库还允许我们查看来自训练模型损失最高的测试集的图像。你可以看到这个模型与看起来更像猫的小型狗斗争。我们可以通过为训练程序选择更多的样本来提高准确性。然而，本教程的目标是表明，通过利用迁移学习和智能数据选择过程，您可以用少量的训练数据获得很高的准确性(&gt; 80%)。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/1fe655ded8cfe0985bb48ee0729aa7c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*aG6UvkQordnAzMN0OCJbPw.png"/></div><p class="mb mc gj gh gi md me bd b be z dk translated">该图显示了仅在 10 幅样本图像上训练的模型的最高损失</p></figure><p id="c1b4" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated">我希望你喜欢这篇关于如何使用 fast.ai 和<a class="ae mr" href="https://www.lightly.ai" rel="noopener ugc nofollow" target="_blank">轻松使用</a>的简单指导。请关注我，了解更多关于 Medium 的教程！</p><p id="dc8e" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated">Igor 联合创始人<br/> <a class="ae mr" href="https://www.lightly.ai" rel="noopener ugc nofollow" target="_blank"> Lightly.ai </a></p><p id="ed16" class="pw-post-body-paragraph kx ky iq kz b la mj jr lc ld mk ju lf lg mm li lj lk mo lm ln lo mq lq lr ls ij bi translated">[1]oze an s .(2017)，卷积神经网络的主动学习:核心集方法</p></div></div>    
</body>
</html>