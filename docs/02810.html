<html>
<head>
<title>Extend Named Entity Recogniser (NER) to label new entities with spaCy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">扩展命名实体识别器(NER ),用空格标记新实体</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/extend-named-entity-recogniser-ner-to-label-new-entities-with-spacy-339ee5979044?source=collection_archive---------10-----------------------#2020-03-18">https://towardsdatascience.com/extend-named-entity-recogniser-ner-to-label-new-entities-with-spacy-339ee5979044?source=collection_archive---------10-----------------------#2020-03-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="dbfc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">单词的标签顺序-简洁明了</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/98008f42fe02c0cc1cc5df3a6b3634dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w4449DJGuXlay02gFt8APg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图1:彩色编码的识别实体</p></figure><p id="3617" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这篇文章假设读者对从文本中提取实体有一些概念，并希望进一步了解新的自定义实体识别存在哪些先进的技术，以及如何使用它们。然而，如果你是第一次接触NER问题，那么请在这里阅读。</p><p id="8d32" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">话虽如此，这篇文章的目的是描述使用来自<a class="ae le" href="https://spacy.io/models/en" rel="noopener ugc nofollow" target="_blank"> spaCy </a>的预训练自然语言处理(NLP)核心模型来学习识别新实体。来自spacy的现有核心NLP模型被训练以识别各种实体，如图2所示。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lf"><img src="../Images/56670646f279315bd5dffd32ee6726b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DlrDXw3g46hRLwnlhldwcQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图spaCy核心模型识别的现有实体(<a class="ae le" href="https://spacy.io/api/annotation#named-entities" rel="noopener ugc nofollow" target="_blank">来源</a>)</p></figure><p id="9218" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">尽管如此，用户可能想要构建自己的实体来解决问题需求。在这种情况下，先前存在的实体表现得不够充分，因此，需要训练NLP模型来完成这项工作。感谢<a class="ae le" href="https://spacy.io/usage/spacy-101" rel="noopener ugc nofollow" target="_blank"> spaCy </a>的文档和预训练模型，这并不是很困难。</p><p id="0e7f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你不想进一步阅读，而是想学习如何使用它，那么请到这个jupyter <a class="ae le" href="https://github.com/prem2017/new-entity-labelling/blob/master/new_entity_labelling.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a> <a class="ae le" href="https://github.com/prem2017/new-entity-labelling/blob/master/new_entity_labelling.ipynb)-" rel="noopener ugc nofollow" target="_blank"> - </a>它是独立的。无论如何，我也建议浏览一下。</p><h2 id="fe2d" class="lg lh it bd li lj lk dn ll lm ln dp lo kb lp lq lr kf ls lt lu kj lv lw lx ly bi translated">数据预处理</h2><p id="bc1e" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">像任何需要输入和输出来学习的监督学习算法一样，类似地，这里——输入是<strong class="js iu">文本</strong>，输出根据<a class="ae le" href="https://spacy.io/api/annotation#biluo" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">【罗比】</strong> </a>进行编码，如图3所示。虽然存在不同的方案，但是，<a class="ae le" href="https://www.aclweb.org/anthology/W09-1119/" rel="noopener ugc nofollow" target="_blank"> Ratinov和Roth </a>表明最小Begin，in，Out ( <a class="ae le" href="https://spacy.io/api/annotation#iob" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu"> IOB </strong> </a>)方案比明确标记边界标记的<strong class="js iu">罗比</strong>方案更难学习。IOB编码的一个例子是由<a class="ae le" href="https://github.com/explosion/spaCy/blob/master/examples/training/train_new_entity_type.py" rel="noopener ugc nofollow" target="_blank"> spaCy </a>提供的，我发现它与提供的参数一致。因此，从这里开始，任何注释方案的提及都将是罗比。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi me"><img src="../Images/7eb6137756b928a4019d10381487e99f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9LWOAxzy40V8OSei4BUPvg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图3: <a class="ae le" href="https://spacy.io/api/annotation#biluo" rel="noopener ugc nofollow" target="_blank">罗比</a>方案</p></figure><p id="5790" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下图显示了罗比编码实体的一个简短示例。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/a60f58b9218482b217b75f305fc09bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*JCdkfw5R2xT5TFdXtfMnXA.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">图4:用BILOU方案编码的实体</p></figure><p id="f9cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">用罗比方案编码有三种可能的方法。<strong class="js iu">方法之一</strong>是创建一个spaCy <a class="ae le" href="https://spacy.io/api/doc" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu"> doc </strong> </a>格式的文本字符串，并将从doc中提取的令牌保存在一个文本文件中，用换行符隔开。然后根据罗比方案标记每个令牌。人们可以创建自己的令牌并标记它，但可能会降低性能——稍后将详细介绍。以下是如何标记您的数据，供以后在NER培训中使用。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="8962" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上面的片段使生活更容易注释，但这不能直接输入到学习的空间模型中。尽管如此，spaCy提供的另一个模块<a class="ae le" href="https://spacy.io/api/goldparse/" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu"> GoldParse </strong> </a>解析模型接受的保存格式。使用下面的代码片段从保存的文件中读取数据，并将其解析成模型可以接受的形式。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="f82a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">另一种</strong>方式是使用每个实体/标签的偏移索引，即实体的开始和结束(即实体的开始、内部和最后部分组合在一起)的索引与标签一起提供，例如:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="3a2a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第三个类似于第一个，除了，这里我们可以修复我们自己的令牌并标记它们，而不是用NLP模型生成令牌然后标记它们。虽然这也可以工作，但是，在我的实验中，我发现这大大降低了性能。然而，你可以这样做:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mg mh l"/></div></figure><h2 id="eb5d" class="lg lh it bd li lj lk dn ll lm ln dp lo kb lp lq lr kf ls lt lu kj lv lw lx ly bi translated">培养</h2><p id="3550" class="pw-post-body-paragraph jq jr it js b jt lz jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj md kl km kn im bi translated">在对数据进行预处理并为训练做好准备后，我们需要在模型<strong class="js iu"> NER </strong>管道中进一步添加新实体的词汇表。核心空间模型有三条流水线:<strong class="js iu">标记器</strong>、<strong class="js iu">解析器</strong>和<strong class="js iu"> NER </strong>。此外，我们需要禁用标记器和解析器管道，因为我们将只训练<strong class="js iu"> NER </strong>管道，尽管可以同时训练所有其他管道。点击了解更多<a class="ae le" href="https://github.com/explosion/spaCy/tree/master/examples/training" rel="noopener ugc nofollow" target="_blank">。</a></p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="d525" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这里，为了训练，dropout被指定为0.0-故意过度拟合模型，并表明它可以学习识别所有的新实体。</p><p id="f358" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">推论</strong></p><p id="223f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">来自训练模型的结果:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="93d7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">spaCy还提供了一种生成彩色编码的<a class="ae le" href="https://spacy.io/usage/visualizers#ent" rel="noopener ugc nofollow" target="_blank">实体</a>(如图1所示)的方法，可以使用以下代码片段在网络浏览器或笔记本上查看:</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="82f3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">注意事项</strong></p><p id="7227" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里提供的训练新实体的过程可能看起来有点简单，但是，它有一个警告。在训练时，新训练的模型可能会忘记识别旧实体，因此，强烈建议将一些文本与来自先前训练的实体的实体混合，除非旧实体对于问题的解决方案不是必需的。其次，学习更多具体的T21实体可能比学习一个一般化的实体更好。</p><p id="6e29" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">结论</strong></p><p id="5c8b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们看到，开始学习新的实体并不难，但是需要尝试不同的注释技术，并选择最适合给定问题的方法。</p><p id="a2d1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">补充说明</strong></p><ul class=""><li id="5a2b" class="mi mj it js b jt ju jx jy kb mk kf ml kj mm kn mn mo mp mq bi translated">这篇文章是spaCy <a class="ae le" href="https://github.com/explosion/spaCy/blob/master/examples/training/train_new_entity_type.py" rel="noopener ugc nofollow" target="_blank">在这里</a>提供的例子的进一步扩展。</li><li id="648b" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">在这个jupyter <a class="ae le" href="https://github.com/prem2017/new-entity-labelling/blob/master/new_entity_labelling.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>中可以访问整个代码块。自述文件还包含如何安装空间库以及在安装和加载预训练模型期间调试错误问题。</li><li id="c324" class="mi mj it js b jt mr jx ms kb mt kf mu kj mv kn mn mo mp mq bi translated">阅读由<a class="ae le" href="https://alanakbik.github.io/papers/coling2018.pdf" rel="noopener ugc nofollow" target="_blank"> Akbik等人</a>撰写的这篇论文，它应该有助于理解序列标记背后的算法，即多个单词实体。</li></ul></div></div>    
</body>
</html>