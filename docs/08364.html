<html>
<head>
<title>Generate boolean (yes/no) questions from any content using T5 text-to-text transformer model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用T5文本到文本转换器模型从任何内容生成布尔型(是/否)问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/generating-boolean-yes-no-questions-from-any-content-using-t5-text-to-text-transformer-model-69f2744aff44?source=collection_archive---------31-----------------------#2020-06-18">https://towardsdatascience.com/generating-boolean-yes-no-questions-from-any-content-using-t5-text-to-text-transformer-model-69f2744aff44?source=collection_archive---------31-----------------------#2020-06-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4e6c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用BoolQ数据集和T5文本到文本转换器模型的问题生成算法的训练脚本和预训练模型。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bbced2d527390d2e344b1f2c593aa9c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FDVO_wgG6Vd7nr0hazfCCA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://pixabay.com/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><h1 id="7da3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">投入</h1><p id="5c7d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们程序的输入将是任何一般的<strong class="lt iu">内容/段落</strong></p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="d0d8" class="ms la it mo b gy mt mu l mv mw"><strong class="mo iu">Months earlier, Coca-Cola had begun “Project Kansas.” It sounds like a nuclear experiment but it was just a testing project for the new flavor. In individual surveys, they’d found that more than 75% of respondents loved the taste, 15% were indifferent, and 10% had a strong aversion to the taste to the point that they were angry.</strong></span></pre><h1 id="19dd" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">输出</h1><p id="3a59" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">输出将是从上述输入生成的<strong class="lt iu">布尔(是/否)</strong>问题。</p><p id="1f43" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated"><strong class="lt iu">布尔(是/否)</strong>从<strong class="lt iu"> T5模型</strong>生成的问题:</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="31b9" class="ms la it mo b gy mt mu l mv mw"><strong class="mo iu">1: Does coca cola have a kansas flavor?<br/>2: Is project kansas a new coca cola flavor?<br/>3: Is project kansas the same as coca cola?</strong></span></pre><p id="fd8a" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">今天我们将看看如何从<a class="ae ky" href="https://github.com/huggingface/transformers" rel="noopener ugc nofollow" target="_blank"> Huggingface的变形金刚</a>库中训练一个T5模型来生成这些布尔问题。我们还将看到如何使用提供的<strong class="lt iu">预训练模型</strong>来生成这些<strong class="lt iu">布尔(是/否)</strong>问题。</p><h1 id="e83e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">实际使用案例(学习聊天机器人)</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/ee0ef96926d6af643667b84a81195be2.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*IhhmcDit6cJnyCipc34hwg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<a class="ae ky" href="https://www.flaticon.com/" rel="noopener ugc nofollow" target="_blank">平面图标</a>的图标</p></figure><p id="eef5" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi nd translated">我想象一个场景，作为一名学生，你和一个聊天机器人互动学习一个概念<strong class="lt iu"/>。聊天机器人会根据你的回答向你展示教科书章节中相关的字节大小的片段。它还想让<strong class="lt iu">实时评估</strong>你是否已经<strong class="lt iu">理解了</strong>提出的主题。为课本章节的每个片段手动<strong class="lt iu">预生成评估</strong>是不切实际的。<strong class="lt iu">聊天机器人</strong>可以利用这个<strong class="lt iu">算法</strong>实时生成<strong class="lt iu">布尔(是/否)</strong>问题，评估你对题目的<strong class="lt iu">理解</strong>。</p><p id="ef9e" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">让我们开始吧—</p><h1 id="57db" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">资料组</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/8c2204f37fd1b562d36e5e7894d0ec1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*F5DB98C-hKA0JcuGVJpYQg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来自<a class="ae ky" href="https://www.flaticon.com/" rel="noopener ugc nofollow" target="_blank">平面图标</a>的图标</p></figure><p id="394d" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">我用<strong class="lt iu"/><a class="ae ky" href="https://github.com/google-research-datasets/boolean-questions" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">BoolQ</strong></a>数据集收集了<strong class="lt iu">段落</strong>、<strong class="lt iu">问题</strong>和<strong class="lt iu">答案</strong>三元组，准备了训练集和验证集。</p><p id="b3fe" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated"><strong class="lt iu"> boolQ </strong>数据集具有以下格式-</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="0394" class="ms la it mo b gy mt mu l mv mw">{<br/>  <strong class="mo iu">"question"</strong>: "is france the same timezone as the uk",<br/>  <strong class="mo iu">"passage"</strong>: "At the Liberation of France in the summer of 1944, Metropolitan France kept GMT+2 as it was the time then used by the Allies (British Double Summer Time). In the winter of 1944--1945, Metropolitan France switched to GMT+1, same as in the United Kingdom, and switched again to GMT+2 in April 1945 like its British ally. In September 1945, Metropolitan France returned to GMT+1 (pre-war summer time), which the British had already done in July 1945. Metropolitan France was officially scheduled to return to GMT+0 on November 18, 1945 (the British returned to GMT+0 in on October 7, 1945), but the French government canceled the decision on November 5, 1945, and GMT+1 has since then remained the official time of Metropolitan France."<br/>  <strong class="mo iu">"answer"</strong>: false,<br/>  <strong class="mo iu">"title"</strong>: "Time in France",<br/>}</span></pre><p id="a1d2" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">有一段“<strong class="lt iu">短文</strong>，有对应的“<strong class="lt iu">问题</strong>和正确的布尔“<strong class="lt iu">答案</strong>”——对或错。</p><p id="c62a" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">我们会详细讨论你如何-</p><ol class=""><li id="e52b" class="nm nn it lt b lu mx lx my ma no me np mi nq mm nr ns nt nu bi translated">使用我的<strong class="lt iu">预训练的</strong>模型为任何给定的内容生成<strong class="lt iu">布尔问题</strong>。</li><li id="e96c" class="nm nn it lt b lu nv lx nw ma nx me ny mi nz mm nr ns nt nu bi translated">使用我的<strong class="lt iu">训练</strong>代码和数据集在你自己的<strong class="lt iu"> GPU </strong>机器上复制结果。</li></ol><h1 id="ff2a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">训练算法— T5</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/2e8f91232c6c6156897031d2b9ffb545.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/0*68_8SJLwkHuaZC4R.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用<a class="ae ky" href="https://www.flaticon.com/authors/freepik" rel="noopener ugc nofollow" target="_blank">扁平图标</a>生成的图标</p></figure><p id="62ea" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">T5是Google的一个新的transformer模型，它以端到端的方式进行训练，将<strong class="lt iu">文本作为输入</strong>，将修改后的<strong class="lt iu">文本作为输出</strong>。你可以在这里了解更多。</p><p id="7d34" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">它使用在大型文本语料库上训练的文本到文本转换器，在多个NLP任务上实现了<strong class="lt iu">最先进的</strong>结果，如摘要、问题回答、机器翻译等。</p><p id="bdeb" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">我将“<strong class="lt iu">通道”</strong>和<strong class="lt iu">“答案”</strong>作为<strong class="lt iu">输入</strong>给我的T5变压器模型，并训练它生成<strong class="lt iu">“问题”</strong>作为<strong class="lt iu">输出</strong>。</p><h1 id="0cb5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">密码</h1><p id="3d78" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用<strong class="lt iu">预训练</strong>模型和<strong class="lt iu">训练</strong>具有给定数据的模型的所有代码可在-</p><div class="oa ob gp gr oc od"><a href="https://github.com/ramsrigouthamg/generate_boolean_questions_using_T5_transformer" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">ramsrigouthamg/generate _ boolean _ questions _ using _ T5 _ transformer</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">使用这个程序，您可以从任何内容中生成布尔型(是/否)问题。一篇详细的媒体博文解释了…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">github.com</p></div></div><div class="om l"><div class="on l oo op oq om or ks od"/></div></div></a></div><h1 id="52d2" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">使用预先训练的模型</h1><p id="213f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Python文件<a class="ae ky" href="https://github.com/ramsrigouthamg/generate_boolean_questions_using_T5_transformer/blob/master/t5_inference.py" rel="noopener ugc nofollow" target="_blank"> t5_inference.py </a>包含了下面给出的所有代码。</p><p id="9fc9" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">首先，安装必要的库-</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="2747" class="ms la it mo b gy mt mu l mv mw">!pip install torch==1.4.0<br/>!pip install transformers==2.9.0<br/>!pip install pytorch_lightning==0.7.5</span></pre><p id="e810" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">以任何文本/段落作为输入运行<strong class="lt iu">推理</strong>，查看生成的<strong class="lt iu">布尔问题</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="e78a" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">上述代码的<strong class="lt iu">输出</strong>为-</p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="8c74" class="ms la it mo b gy mt mu l mv mw"><strong class="mo iu">Context: </strong> Months earlier, Coca-Cola had begun “Project Kansas.” It sounds like a nuclear experiment but it was just a testing project for the new flavor. In individual surveys, they’d found that more than 75% of respondents loved the taste, 15% were indifferent, and 10% had a strong aversion to the taste to the point that they were angry.</span><span id="077b" class="ms la it mo b gy ou mu l mv mw"><strong class="mo iu">Beam decoding [Most accurate questions] ::</strong></span><span id="a27b" class="ms la it mo b gy ou mu l mv mw">Does coca cola have a kansas flavor?<br/>Is project kansas the same as coca cola?<br/>Is project kansas a new coca cola flavor?</span><span id="7259" class="ms la it mo b gy ou mu l mv mw"><strong class="mo iu">TopKP decoding [Not very accurate but more variety in questions] ::</strong></span><span id="18a0" class="ms la it mo b gy ou mu l mv mw">Does coca cola have a koala flavor?<br/>Is kakao the same as project kansas?<br/>Was project ksoda a real thing?</span><span id="7d23" class="ms la it mo b gy ou mu l mv mw"><strong class="mo iu">Time elapsed  1.2351574897766113</strong></span></pre><h1 id="26e0" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">训练你自己的模型</h1><p id="a40f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">所有用于训练的训练代码和数据集都可以在提到的Github repo中获得。我们将经历我用来训练模型的步骤。</p><h1 id="dd17" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">1.数据准备</h1><p id="06d9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">文件<a class="ae ky" href="https://github.com/ramsrigouthamg/generate_boolean_questions_using_T5_transformer/blob/master/boolQ_prepare_train_validation_dataset.ipynb" rel="noopener ugc nofollow" target="_blank">boolQ _ prepare _ train _ validation _ dataset . ipynb</a>包含准备训练和验证数据集的所有代码。我将boolQ数据集作为JSON文件，并将其转换为csv文件。</p><h1 id="41b5" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">2.培养</h1><p id="7003" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">感谢<a class="ae ky" href="https://madewithml.com/@patil-suraj/" rel="noopener ugc nofollow" target="_blank"> Suraj Patil </a>给了我们一个神奇的<a class="ae ky" href="https://colab.research.google.com/drive/176NSaYjc2eeI-78oLH_F9-YV3po3qQQO?usp=sharing#scrollTo=SDVQ04fGRb1v" rel="noopener ugc nofollow" target="_blank"> Colab笔记本</a>来训练T5完成任何文本到文本的任务。我从Colab笔记本上借用了大部分训练代码，只更改了数据集类和训练参数。我使dataset类适应了我们的boolQ数据集。</p><p id="edb1" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">培训代码可作为培训<a class="ae ky" href="https://github.com/ramsrigouthamg/generate_boolean_questions_using_T5_transformer/blob/master/train.py" rel="noopener ugc nofollow" target="_blank">使用。</a>Github回购中的py。</p><p id="1e43" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">你需要做的就是<strong class="lt iu">在任一台<strong class="lt iu"> GPU </strong>机器上克隆</strong>repo，安装<strong class="lt iu"> requirements.txt </strong>，运行<strong class="lt iu"> train.py </strong>来训练T5模型。</p><p id="469c" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">在<strong class="lt iu"> p2.xlarge </strong> (AWS ec2)上训练该模型4个时期(默认)需要大约5-6个小时。</p><p id="3142" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">数据集类如下所示—</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="os ot l"/></div></figure><p id="bb11" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">关键是我们如何向T5模型培训师提供我们的输入和输出。我将“<strong class="lt iu">通道”</strong>和<strong class="lt iu">“答案”</strong>作为<strong class="lt iu">输入</strong>给我的T5变压器模型，并训练它生成<strong class="lt iu">“问题”</strong>作为<strong class="lt iu">输出</strong>，如下所示-</p><p id="0b4f" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated"><strong class="lt iu">输入格式到T5进行训练</strong></p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="5cef" class="ms la it mo b gy mt mu l mv mw"><strong class="mo iu">truefalse</strong>: yes <strong class="mo iu">passage</strong>: <!-- -->At the Liberation of France in the summer of 1944, Metropolitan France kept GMT+2 as it was the time then used by the Allies (British Double Summer Time). In the winter of 1944--1945, Metropolitan France switched to GMT+1, same as in the United Kingdom, and switched again to GMT+2 in April 1945 like its British ally. In September 1945, Metropolitan France returned to GMT+1 (pre-war summer time), which the British had already done in July 1945. Metropolitan France was officially scheduled to return to GMT+0 on November 18, 1945 (the British returned to GMT+0 in on October 7, 1945), but the French government canceled the decision on November 5, 1945, and GMT+1 has since then remained the official time of Metropolitan France.<!-- --> <strong class="mo iu">&lt;/s&gt;</strong></span></pre><p id="a679" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated"><strong class="lt iu">输出格式到T5进行训练</strong></p><pre class="kj kk kl km gt mn mo mp mq aw mr bi"><span id="2189" class="ms la it mo b gy mt mu l mv mw">Is france the same timezone as the uk<!-- -->?<strong class="mo iu"> &lt;/s&gt;</strong></span></pre><p id="e3b6" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated"><strong class="lt iu">注:</strong>文本"<strong class="lt iu"> truefalse </strong> : yes "或"<strong class="lt iu"> truefalse </strong> : no "应生成一个<strong class="lt iu">适当的</strong>布尔问题，其答案为文本中给出的" yes "或" no "。但是我尝试训练T5时，效果并不好。所以确保你<strong class="lt iu">不要依赖</strong>对生成的布尔问题给出的<strong class="lt iu">答案</strong>的初始标记“是”或“否”。</p><p id="8216" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">总数据集只有大约<strong class="lt iu"> ~10k </strong>个样本，因此生成的问题质量有时<strong class="lt iu">不是很好</strong>。请注意。</p></div><div class="ab cl ov ow hx ox" role="separator"><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa"/></div><div class="im in io ip iq"><p id="03cf" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">祝NLP探索愉快，如果你喜欢它的内容，请随时在Twitter上找到我。</p><p id="f7d3" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">如果你想学习使用变形金刚的现代自然语言处理，看看我的课程<a class="ae ky" href="https://www.udemy.com/course/question-generation-using-natural-language-processing/?referralCode=C8EA86A28F5398CBF763" rel="noopener ugc nofollow" target="_blank">使用自然语言处理的问题生成</a></p></div></div>    
</body>
</html>