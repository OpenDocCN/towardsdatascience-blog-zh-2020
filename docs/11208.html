<html>
<head>
<title>Clustering Geospatial Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">èšç±»åœ°ç†ç©ºé—´æ•°æ®</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/clustering-geospatial-data-f0584f0b04ec?source=collection_archive---------1-----------------------#2020-08-04">https://towardsdatascience.com/clustering-geospatial-data-f0584f0b04ec?source=collection_archive---------1-----------------------#2020-08-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/bf7a59d41b19f964ce71b34753c515bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LgqxDMP5qD1HE_uM33zZrg.png"/></div></div></figure><div class=""/><div class=""><h2 id="ce47" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">ä½¿ç”¨äº¤äº’å¼åœ°å›¾ç»˜åˆ¶æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ èšç±»</h2></div><h2 id="6fc0" class="kt ku je bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">æ‘˜è¦</h2><p id="8ff6" class="pw-post-body-paragraph lp lq je lr b ls lt kf lu lv lw ki lx lc ly lz ma lg mb mc md lk me mf mg mh im bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨æ•°æ®ç§‘å­¦å’Œ Pythonï¼Œå±•ç¤ºå¦‚ä½•å°†ä¸åŒçš„èšç±»ç®—æ³•åº”ç”¨äºåœ°ç†ç©ºé—´æ•°æ®ï¼Œä»¥è§£å†³é›¶å”®åˆç†åŒ–ä¸šåŠ¡æ¡ˆä¾‹ã€‚</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mi"><img src="../Images/06845dad056d8611e7147ea2b90b7751.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*HVqgJmxiSK2Z9Mswe_niUg.gif"/></div></div></figure><p id="efa8" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated"><a class="ae ms" href="https://www.investopedia.com/terms/r/rationalization.asp" rel="noopener ugc nofollow" target="_blank"> <strong class="lr jf">é—¨åº—åˆç†åŒ–</strong> </a>æ˜¯å…¬å¸ä¸ºäº†æé«˜ç»è¥æ•ˆç‡ï¼Œé™ä½æˆæœ¬è€Œè¿›è¡Œçš„é‡ç»„ã€‚ç”±äº T4 å’Œæ–°å† è‚ºç‚çš„å±æœºï¼Œä¸–ç•Œå„åœ°çš„å‡ å®¶é›¶å”®ä¼ä¸šæ­£åœ¨å…³é—­åº—é“ºã€‚è¿™å¹¶ä¸ä»…ä»…æ˜¯é‡‘èå±æœºçš„ç—‡çŠ¶ï¼Œäº‹å®ä¸Šè®¸å¤šå…¬å¸å·²ç»å°†æŠ•èµ„é›†ä¸­åœ¨ä½¿ä»–ä»¬çš„ä¸šåŠ¡æ›´åŠ æ•°å­—åŒ–ä¸Šã€‚</p><p id="2921" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated"><a class="ae ms" href="https://en.wikipedia.org/wiki/Cluster_analysis" rel="noopener ugc nofollow" target="_blank"> <strong class="lr jf">èšç±»</strong> </a> <strong class="lr jf"> </strong>æ˜¯å¯¹ä¸€ç»„å¯¹è±¡è¿›è¡Œåˆ†ç»„çš„ä»»åŠ¡ï¼Œä½¿åŒä¸€ç»„ä¸­çš„è§‚å¯Ÿå€¼å½¼æ­¤ä¹‹é—´æ¯”å…¶ä»–ç»„ä¸­çš„è§‚å¯Ÿå€¼æ›´ç›¸ä¼¼ã€‚è¿™æ˜¯<a class="ae ms" href="https://en.wikipedia.org/wiki/Unsupervised_learning" rel="noopener ugc nofollow" target="_blank">æ— ç›‘ç£å­¦ä¹ </a>(æ²¡æœ‰ç›®æ ‡å˜é‡æ—¶çš„æœºå™¨å­¦ä¹ )æœ€å—æ¬¢è¿çš„åº”ç”¨ä¹‹ä¸€ã€‚</p><p id="9d8d" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated"><a class="ae ms" href="https://en.wikipedia.org/wiki/Spatial_analysis" rel="noopener ugc nofollow" target="_blank"> <strong class="lr jf">åœ°ç†ç©ºé—´åˆ†æ</strong> </a>æ˜¯å¤„ç†å«æ˜Ÿå›¾åƒã€GPS åæ ‡å’Œè¡—é“åœ°å€ä»¥åº”ç”¨äºåœ°ç†æ¨¡å‹çš„æ•°æ®ç§‘å­¦é¢†åŸŸã€‚</p><p id="8030" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ä½¿ç”¨åœ°ç†æ•°æ®èšç±»æ¥è§£å†³é›¶å”®åˆç†åŒ–é—®é¢˜ã€‚æˆ‘å°†å±•ç¤ºä¸€äº›æœ‰ç”¨çš„ Python ä»£ç ï¼Œè¿™äº›ä»£ç å¯ä»¥å¾ˆå®¹æ˜“åœ°åº”ç”¨äºå…¶ä»–ç±»ä¼¼çš„æƒ…å†µ(åªéœ€å¤åˆ¶ã€ç²˜è´´ã€è¿è¡Œ)ï¼Œå¹¶é€šè¿‡æ³¨é‡Šéå†æ¯ä¸€è¡Œä»£ç ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥å¤åˆ¶è¿™ä¸ªç¤ºä¾‹(ä¸‹é¢æ˜¯å®Œæ•´ä»£ç çš„é“¾æ¥)ã€‚</p><div class="is it gp gr iu mt"><a href="https://github.com/mdipietro09/DataScience_ArtificialIntelligence_Utils/blob/master/machine_learning/example_clustering.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd jf gy z fp my fr fs mz fu fw jd bi translated">mdipietro 09/data science _ äººå·¥æ™ºèƒ½ _ å®ç”¨å·¥å…·</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">permalink dissolve GitHub æ˜¯è¶…è¿‡ 5000 ä¸‡å¼€å‘äººå‘˜çš„å®¶å›­ï¼Œä»–ä»¬ä¸€èµ·å·¥ä½œæ¥æ‰˜ç®¡å’Œå®¡æŸ¥ä»£ç ï¼Œç®¡ç†â€¦</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">github.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh ja mt"/></div></div></a></div><p id="f8a0" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">æˆ‘å°†ä½¿ç”¨"<strong class="lr jf"> Starbucks Stores dataset </strong>"æä¾›æ‰€æœ‰æ­£åœ¨è¿è¥çš„å•†åº—çš„ä½ç½®(ä¸‹é¢çš„é“¾æ¥)ã€‚æˆ‘å°†é€‰æ‹©ä¸€ä¸ªç‰¹å®šçš„åœ°ç†åŒºåŸŸï¼Œé™¤äº†æ‰€æä¾›çš„çº¬åº¦å’Œç»åº¦ä¹‹å¤–ï¼Œæˆ‘å°†æ¨¡æ‹Ÿæ•°æ®é›†ä¸­æ¯ä¸ªå•†åº—çš„ä¸€äº›ä¸šåŠ¡ä¿¡æ¯(æˆæœ¬ã€å®¹é‡ã€å‘˜å·¥)ã€‚</p><div class="is it gp gr iu mt"><a href="https://www.kaggle.com/starbucks/store-locations" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd jf gy z fp my fr fs mz fu fw jd bi translated">æ˜Ÿå·´å…‹åœ¨å…¨çƒçš„ä½ç½®</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">è¿è¥ä¸­çš„æ¯å®¶æ˜Ÿå·´å…‹åº—çš„åç§°ã€æ‰€æœ‰æƒç±»å‹å’Œä½ç½®</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">www.kaggle.com</p></div></div><div class="nc l"><div class="ni l ne nf ng nc nh ja mt"/></div></div></a></div><p id="1872" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">ç‰¹åˆ«æ˜¯ï¼Œæˆ‘å°†ç»å†:</p><ul class=""><li id="f7cb" class="nj nk je lr b ls mn lv mo lc nl lg nm lk nn mh no np nq nr bi translated">è®¾ç½®:å¯¼å…¥åŒ…ï¼Œè¯»å–åœ°ç†æ•°æ®ï¼Œåˆ›å»ºä¸šåŠ¡åŠŸèƒ½ã€‚</li><li id="019c" class="nj nk je lr b ls ns lv nt lc nu lg nv lk nw mh no np nq nr bi translated">æ•°æ®åˆ†æ:ç”¨<em class="nx">å¶å­</em>å’Œ<em class="nx"> geopy </em>åœ¨åœ°å›¾ä¸Šå±•ç¤ºå•†ä¸šæ¡ˆä¾‹ã€‚</li><li id="e694" class="nj nk je lr b ls ns lv nt lc nu lg nv lk nw mh no np nq nr bi translated">èšç±»:ç”¨<em class="nx"> scikit-learn </em>çš„æœºå™¨å­¦ä¹ (K-Means / Affinity Propagation)ï¼Œç”¨<em class="nx"> minisom </em>çš„æ·±åº¦å­¦ä¹ (è‡ªç»„ç»‡æ˜ å°„)ã€‚</li><li id="d678" class="nj nk je lr b ls ns lv nt lc nu lg nv lk nw mh no np nq nr bi translated">å•†åº—åˆç†åŒ–:æ„å»ºç¡®å®šæ€§ç®—æ³•æ¥è§£å†³ä¸šåŠ¡æ¡ˆä¾‹ã€‚</li></ul></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><h2 id="9f58" class="kt ku je bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">è®¾ç½®</h2><p id="862d" class="pw-post-body-paragraph lp lq je lr b ls lt kf lu lv lw ki lx lc ly lz ma lg mb mc md lk me mf mg mh im bi translated">é¦–å…ˆï¼Œæˆ‘éœ€è¦å¯¼å…¥ä»¥ä¸‹åŒ…ã€‚</p><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="0da6" class="kt ku je og b gy ok ol l om on"><strong class="og jf">## for data</strong><br/>import <strong class="og jf">numpy </strong>as np<br/>import <strong class="og jf">pandas </strong>as pd</span><span id="2f90" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## for plotting</strong><br/>import <strong class="og jf">matplotlib</strong>.pyplot as plt<br/>import <strong class="og jf">seaborn </strong>as sns</span><span id="59f0" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## for geospatial</strong><br/>import <strong class="og jf">folium</strong><br/>import <strong class="og jf">geopy</strong></span><span id="af78" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## for machine learning</strong><br/>from <strong class="og jf">sklearn </strong>import preprocessing, cluster<br/>import <strong class="og jf">scipy</strong></span><span id="8c9e" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## for deep learning</strong><br/>import <strong class="og jf">minisom</strong></span></pre><p id="91d8" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">ç„¶åæˆ‘å°†æŠŠæ•°æ®è¯»å…¥ä¸€ä¸ªç†ŠçŒ«æ•°æ®å¸§ã€‚</p><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="b915" class="kt ku je og b gy ok ol l om on">dtf = pd.read_csv('data_stores.csv')</span></pre><p id="28ae" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">åŸå§‹æ•°æ®é›†åŒ…å«è¶…è¿‡ 5ï¼Œ000 ä¸ªåŸå¸‚å’Œ 25ï¼Œ000 å®¶å•†åº—ï¼Œä½†æ˜¯å‡ºäºæœ¬æ•™ç¨‹çš„ç›®çš„ï¼Œæˆ‘å°†åªå¤„ç†ä¸€ä¸ªåŸå¸‚ã€‚</p><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="a718" class="kt ku je og b gy ok ol l om on">filter = <strong class="og jf">"Las Vegas"</strong></span><span id="7169" class="kt ku je og b gy oo ol l om on">dtf = dtf[dtf["City"]==filter][["City","Street Address","Longitude","Latitude"]].reset_index(drop=True)</span><span id="15de" class="kt ku je og b gy oo ol l om on">dtf = dtf.reset_index().rename(columns={"index":"id"})<br/>dtf.head()</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi op"><img src="../Images/42ef6d1ef8b11a8af25397d23d83c175.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hJ7ECkivXOysFCM0k37bSA.png"/></div></div></figure><p id="3495" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">åœ¨é‚£ä¸ªåœ°åŒºï¼Œæœ‰ 156 å®¶å•†åº—ã€‚ä¸ºäº†ç»§ç»­è¿›è¡Œä¸šåŠ¡æ¡ˆä¾‹ï¼Œæˆ‘å°†<strong class="lr jf">æ¨¡æ‹Ÿæ¯ä¸ªå•†åº—çš„ä¸€äº›ä¿¡æ¯</strong>:</p><ul class=""><li id="53a3" class="nj nk je lr b ls mn lv mo lc nl lg nm lk nn mh no np nq nr bi translated"><em class="nx">æ½œåœ¨èƒ½åŠ›</em>:å‘˜å·¥çš„æ€»èƒ½åŠ›(ä¾‹å¦‚ï¼Œ10 è¡¨ç¤ºå•†åº—æœ€å¤šå¯å®¹çº³ 10 åå‘˜å·¥)</li><li id="5fca" class="nj nk je lr b ls ns lv nt lc nu lg nv lk nw mh no np nq nr bi translated"><em class="nx">å‘˜å·¥</em>:å½“å‰å‘˜å·¥çº§åˆ«(å¦‚ 7 è¡¨ç¤ºè¯¥åº—ç›®å‰æœ‰ 7 åå‘˜å·¥åœ¨è¿è¥)</li><li id="a02c" class="nj nk je lr b ls ns lv nt lc nu lg nv lk nw mh no np nq nr bi translated"><em class="nx">å®¹é‡</em>:å½“å‰å‰©ä½™å®¹é‡(å¦‚ 10â€“7 = 3ï¼Œå•†åº—ä»å¯å®¹çº³ 3 åå‘˜å·¥)</li><li id="46b5" class="nj nk je lr b ls ns lv nt lc nu lg nv lk nw mh no np nq nr bi translated"><em class="nx">æˆæœ¬</em>:å…¬å¸ç»´æŒåº—é“ºè¿è¥çš„å¹´åº¦æˆæœ¬(<em class="nx">ä½</em>ã€<em class="nx">ä¸­</em>ã€<em class="nx">é«˜</em>)</li></ul><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="9309" class="kt ku je og b gy ok ol l om on">dtf["<strong class="og jf">Potential</strong>"] = np.random.randint(low=3, high=10+1, size=len(dtf))</span><span id="3779" class="kt ku je og b gy oo ol l om on">dtf["<strong class="og jf">Staff</strong>"] = dtf["<strong class="og jf">Potential</strong>"].apply(lambda x: int(np.random.rand()*x)+1)</span><span id="fb3a" class="kt ku je og b gy oo ol l om on">dtf["<strong class="og jf">Capacity</strong>"] = dtf["<strong class="og jf">Potential</strong>"] - dtf["<strong class="og jf">Staff</strong>"]</span><span id="8255" class="kt ku je og b gy oo ol l om on">dtf["<strong class="og jf">Cost</strong>"] = np.random.choice(["high","medium","low"], size=len(dtf), p=[0.4,0.5,0.1])</span><span id="7825" class="kt ku je og b gy oo ol l om on">dtf.head()</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oq"><img src="../Images/267f82732ea0a0a4bf3379c317c1301e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sdx91gEttdPnVrXged1r0w.png"/></div></div></figure><p id="2746" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">è¯·æ³¨æ„ï¼Œè¿™åªæ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿï¼Œè¿™äº›æ•°å­—æ˜¯éšæœºäº§ç”Ÿçš„ï¼Œå¹¶ä¸çœŸæ­£åæ˜ æ˜Ÿå·´å…‹(æˆ–ä»»ä½•å…¶ä»–å…¬å¸)çš„ä¸šåŠ¡ã€‚</p><p id="dcf0" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">ç°åœ¨ä¸€åˆ‡éƒ½å‡†å¤‡å¥½äº†ï¼Œæˆ‘å°†ä»åˆ†æä¸šåŠ¡æ¡ˆä¾‹å¼€å§‹ï¼Œç„¶åæ„å»ºä¸€ä¸ªèšç±»æ¨¡å‹å’Œä¸€ä¸ªåˆç†åŒ–ç®—æ³•ã€‚</p><p id="88ac" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">æˆ‘ä»¬å¼€å§‹å§ï¼Œå¥½å—ï¼Ÿ</p><h2 id="c646" class="kt ku je bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">æ•°æ®åˆ†æ</h2><p id="1e83" class="pw-post-body-paragraph lp lq je lr b ls lt kf lu lv lw ki lx lc ly lz ma lg mb mc md lk me mf mg mh im bi translated">å‡è®¾æˆ‘ä»¬æ‹¥æœ‰ä¸€å®¶é›¶å”®ä¼ä¸šï¼Œæˆ‘ä»¬ä¸å¾—ä¸å…³é—­ä¸€äº›å•†åº—ã€‚æˆ‘ä»¬å¸Œæœ›åœ¨ä¸è£å‘˜çš„æƒ…å†µä¸‹å®ç°åˆ©æ¶¦æœ€å¤§åŒ–(é€šè¿‡æˆæœ¬æœ€å°åŒ–)ã€‚</p><p id="2887" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">è´¹ç”¨åˆ†é…å¦‚ä¸‹:</p><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="5e4f" class="kt ku je og b gy ok ol l om on"><strong class="og jf">x = "Cost"</strong></span><span id="d4f8" class="kt ku je og b gy oo ol l om on">ax = dtf[x].value_counts().sort_values().plot(kind="barh")<br/>totals = []<br/>for i in ax.patches:<br/>    totals.append(i.get_width())<br/>total = sum(totals)<br/>for i in ax.patches:<br/>     ax.text(i.get_width()+.3, i.get_y()+.20, <br/>     str(round((i.get_width()/total)*100, 2))+'%', <br/>     fontsize=10, color='black')<br/>ax.grid(axis="x")<br/>plt.suptitle(x, fontsize=20)<br/>plt.show()</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi or"><img src="../Images/1cb427ea76c7b2d1046923ce09d1a743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zPqeXUSnhZwAlS0BTcHKiQ.png"/></div></div></figure><p id="185c" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">ç›®å‰ï¼Œåªæœ‰ä¸€å°éƒ¨åˆ†å•†åº—åœ¨æ»¡è´Ÿè·è¿è½¬(å‰©ä½™å®¹é‡= 0)ï¼Œè¿™æ„å‘³ç€æœ‰äº›å•†åº—çš„å‘˜å·¥æ•°é‡å¾ˆå°‘(å‰©ä½™å®¹é‡å¾ˆé«˜):</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi os"><img src="../Images/2426d6b3aaf3c8ae160d684fc812d8a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KhS_uIuZ9BMeC0bx3UUSYQ.png"/></div></div></figure><p id="4272" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">è®©æˆ‘ä»¬æŠŠè¿™äº›ä¿¡æ¯åœ¨åœ°å›¾ä¸Šå½¢è±¡åŒ–ã€‚é¦–å…ˆï¼Œæˆ‘éœ€è¦è·å¾—åœ°ç†åŒºåŸŸçš„åæ ‡æ¥å¯åŠ¨åœ°å›¾ã€‚æˆ‘ä¼šç”¨<a class="ae ms" href="https://geopy.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> <em class="nx"> geopy </em> </a>æ¥åš:</p><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="0376" class="kt ku je og b gy ok ol l om on">city = <strong class="og jf">"Las Vegas"</strong></span><span id="1a88" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## get location</strong><br/>locator = geopy.<strong class="og jf">geocoders</strong>.<strong class="og jf">Nominatim</strong>(user_agent="MyCoder")<br/>location = locator.geocode(city)<br/>print(location)</span><span id="5ad2" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## keep latitude and longitude only</strong><br/>location = [location.latitude, location.longitude]<br/>print("[lat, long]:", location)</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ot"><img src="../Images/e08c0c0acda6ef8cddbeac90b0eca1b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i6ocU0wB-sv98snwjy3YxA.png"/></div></div></figure><p id="6144" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">æˆ‘å°†ä½¿ç”¨<a class="ae ms" href="https://python-visualization.github.io/folium/quickstart.html#Getting-Started" rel="noopener ugc nofollow" target="_blank"><em class="nx"/></a><em class="nx"/>åˆ›å»ºåœ°å›¾ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„åŒ…ï¼Œå…è®¸æˆ‘ä»¬ç»˜åˆ¶äº¤äº’å¼åœ°å›¾ï¼Œè€Œæ— éœ€åŠ è½½<a class="ae ms" href="https://en.wikipedia.org/wiki/Shapefile" rel="noopener ugc nofollow" target="_blank"> shapefile </a>ã€‚æ¯ä¸ªå•†åº—åº”é€šè¿‡ä¸€ä¸ªç‚¹æ¥è¯†åˆ«ï¼Œè¯¥ç‚¹çš„å¤§å°ä¸å…¶å½“å‰çš„å‘˜å·¥äººæ•°æˆæ¯”ä¾‹ï¼Œé¢œè‰²åŸºäºå…¶æˆæœ¬ã€‚æˆ‘è¿˜å°†å‘é»˜è®¤åœ°å›¾æ·»åŠ ä¸€å°æ®µ HTML ä»£ç æ¥æ˜¾ç¤ºå›¾ä¾‹ã€‚</p><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="1048" class="kt ku je og b gy ok ol l om on">x, y = <strong class="og jf">"Latitude", "Longitude"</strong><br/>color =<strong class="og jf"> "Cost"<br/></strong>size =<strong class="og jf"> "Staff"<br/></strong>popup =<strong class="og jf"> "Street Address"</strong><br/>data = dtf.copy()</span><span id="2043" class="kt ku je og b gy oo ol l om on"><strong class="og jf"><br/>## create color column</strong><br/>lst_colors=["red","green","orange"]<br/>lst_elements = sorted(list(dtf[color].unique()))<br/>data["color"] = data[color].apply(lambda x: <br/>                lst_colors[lst_elements.index(x)])</span><span id="97d4" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## create size column (scaled)</strong><br/>scaler = preprocessing.MinMaxScaler(feature_range=(3,15))<br/>data["size"] = scaler.fit_transform(<br/>               data[size].values.reshape(-1,1)).reshape(-1)</span><span id="0fa3" class="kt ku je og b gy oo ol l om on"><strong class="og jf"><br/>## initialize the map with the starting location<br/></strong>map_ = folium.<strong class="og jf">Map</strong>(location=location, tiles="cartodbpositron",<br/>                  zoom_start=11)</span><span id="2d3f" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## add points</strong><br/>data.apply(lambda row: folium.<strong class="og jf">CircleMarker</strong>(<br/>           location=[row[x],row[y]], popup=row[popup],<br/>           color=row["color"], fill=True,<br/>           radius=row["size"]).add_to(map_), axis=1)</span><span id="0e8d" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## add html legend<br/></strong>legend_html = """&lt;div style="position:fixed; bottom:10px; left:10px; border:2px solid black; z-index:9999; font-size:14px;"&gt;&amp;nbsp;&lt;b&gt;"""+color+""":&lt;/b&gt;&lt;br&gt;"""<br/>for i in lst_elements:<br/>     legend_html = legend_html+"""&amp;nbsp;&lt;i class="fa fa-circle <br/>     fa-1x" style="color:"""+<strong class="og jf">lst_colors[lst_elements.index(i)]</strong>+""""&gt;<br/>     &lt;/i&gt;&amp;nbsp;"""+str(i)+"""&lt;br&gt;"""<br/>legend_html = legend_html+"""&lt;/div&gt;"""</span><span id="4947" class="kt ku je og b gy oo ol l om on">map_.get_root().<strong class="og jf">html.add_child</strong>(folium.<strong class="og jf">Element</strong>(legend_html))</span><span id="4112" class="kt ku je og b gy oo ol l om on"><strong class="og jf"><br/>## plot the map</strong><br/>map_</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ou"><img src="../Images/a8e452147b98d2eb2ce8bd92862417a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*VdecXRu4Sf3VeYTubGEFmg.gif"/></div></div></figure><p id="b27f" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å°½å¯èƒ½å¤šåœ°å…³é—­é«˜æˆæœ¬å•†åº—(çº¢ç‚¹),å°†å‘˜å·¥è½¬ç§»åˆ°ä½äºåŒä¸€ç¤¾åŒºçš„ä½æˆæœ¬å•†åº—(ç»¿ç‚¹)ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†æœ€å¤§åŒ–åˆ©æ¶¦(é€šè¿‡å…³é—­é«˜æˆæœ¬å•†åº—)å’Œæ•ˆç‡(é€šè¿‡è®©ä½æˆæœ¬å•†åº—æ»¡è´Ÿè·å·¥ä½œ)ã€‚</p><p id="fcf5" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">æˆ‘ä»¬å¦‚ä½•åœ¨ä¸é€‰æ‹©è·ç¦»é˜ˆå€¼å’Œåœ°ç†è¾¹ç•Œçš„æƒ…å†µä¸‹å®šä¹‰é‚»åŸŸï¼Ÿå—¯ï¼Œç­”æ¡ˆæ˜¯â€¦â€¦é›†ç¾¤ã€‚</p><h2 id="9d62" class="kt ku je bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">ä½¿èšé›†</h2><p id="f640" class="pw-post-body-paragraph lp lq je lr b ls lt kf lu lv lw ki lx lc ly lz ma lg mb mc md lk me mf mg mh im bi translated">æœ‰å‡ ç§ç®—æ³•å¯ä»¥ä½¿ç”¨ï¼Œè¿™é‡Œåˆ—å‡ºäº†ä¸»è¦çš„<a class="ae ms" href="https://scikit-learn.org/stable/modules/clustering.html" rel="noopener ugc nofollow" target="_blank">å’Œ</a>ã€‚æˆ‘å°†å°è¯• K-Meansã€ç›¸ä¼¼æ€§ä¼ æ’­ã€è‡ªç»„ç»‡æ˜ å°„ã€‚</p><p id="2b53" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated"><a class="ae ms" href="https://en.wikipedia.org/wiki/K-means_clustering" rel="noopener ugc nofollow" target="_blank"> <strong class="lr jf"> K-Means </strong> </a>æ—¨åœ¨å°†è§‚å¯Ÿå€¼åˆ’åˆ†ä¸ºé¢„å®šä¹‰æ•°é‡çš„èšç±»(<em class="nx"> k </em>)ï¼Œå…¶ä¸­æ¯ä¸ªç‚¹å±äºå…·æœ‰æœ€è¿‘å‡å€¼çš„èšç±»ã€‚å®ƒé¦–å…ˆéšæœºé€‰æ‹© k ä¸ªè´¨å¿ƒå¹¶å°†è¿™äº›ç‚¹åˆ†é…ç»™æœ€è¿‘çš„èšç±»ï¼Œç„¶åç”¨èšç±»ä¸­æ‰€æœ‰ç‚¹çš„å¹³å‡å€¼æ›´æ–°æ¯ä¸ªè´¨å¿ƒã€‚å½“æ‚¨éœ€è¦è·å¾—ç²¾ç¡®çš„ç»„æ•°æ—¶ï¼Œè¿™ç§ç®—æ³•å¾ˆæ–¹ä¾¿(ä¾‹å¦‚ï¼Œä¿æŒæœ€å°æ•°é‡çš„è¿è¥å•†åº—)ï¼Œå¹¶ä¸”å®ƒæ›´é€‚åˆäºå°‘é‡çš„å¶æ•°èšç±»ã€‚</p><p id="b142" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">è¿™é‡Œï¼Œä¸ºäº†å®šä¹‰æ­£ç¡®çš„ kï¼Œæˆ‘å°†ä½¿ç”¨<a class="ae ms" href="https://en.wikipedia.org/wiki/Elbow_method_(clustering)" rel="noopener ugc nofollow" target="_blank">è‚˜æ–¹æ³•</a>:ç»˜åˆ¶æ–¹å·®ä½œä¸ºé›†ç¾¤æ•°é‡çš„å‡½æ•°ï¼Œå¹¶é€‰æ‹©ä½¿æ›²çº¿å˜å¹³çš„<em class="nx"> k </em>ã€‚</p><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="3b13" class="kt ku je og b gy ok ol l om on">X = dtf[[<strong class="og jf">"Latitude","Longitude"</strong>]]<strong class="og jf"><br/></strong>max_k =<strong class="og jf"> 10</strong></span><span id="4110" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## iterations</strong><br/>distortions = [] <br/>for i in range(1, max_k+1):<br/>    if len(X) &gt;= i:<br/>       model = cluster.KMeans(n_clusters=i, init='k-means++', max_iter=300, n_init=10, random_state=0)<br/>       model.fit(X)<br/>       distortions.append(model.inertia_)</span><span id="ac43" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## best k: the lowest derivative</strong><br/>k = [i*100 for i in np.diff(distortions,2)].index(min([i*100 for i <br/>     in np.diff(distortions,2)]))</span><span id="17ae" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## plot</strong><br/>fig, ax = plt.subplots()<br/>ax.plot(range(1, len(distortions)+1), distortions)<br/>ax.axvline(k, ls='--', color="red", label="k = "+str(k))<br/>ax.set(title='The Elbow Method', xlabel='Number of clusters', <br/>       ylabel="Distortion")<br/>ax.legend()<br/>ax.grid(True)<br/>plt.show()</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ov"><img src="../Images/76abaf213da6cf5f5d46e91c012819b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aMKJFRAA6NiaYYipTnNHKA.png"/></div></div></figure><p id="7fe8" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨<em class="nx"> k = 5 </em>ï¼Œè¿™æ · K-Means ç®—æ³•å°†æ‰¾åˆ° 5 ä¸ªç†è®ºè´¨å¿ƒã€‚æ­¤å¤–ï¼Œæˆ‘è¿˜å°†ç¡®å®šçœŸæ­£çš„è´¨å¿ƒ(ç¦»èšç±»ä¸­å¿ƒæœ€è¿‘çš„è§‚æµ‹å€¼)ã€‚</p><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="477e" class="kt ku je og b gy ok ol l om on">k = 5<br/>model = cluster.<strong class="og jf">KMeans</strong>(n_clusters=k, init='k-means++')<br/>X = dtf[[<strong class="og jf">"Latitude","Longitude"</strong>]]</span><span id="0d1d" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## clustering</strong><br/>dtf_X = X.copy()<br/>dtf_X["cluster"] = model.fit_predict(X)</span><span id="4b0b" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## find real centroids</strong><br/>closest, distances = scipy.<strong class="og jf">cluster.vq.vq</strong>(model.cluster_centers_, <br/>                     dtf_X.drop("cluster", axis=1).values)<br/>dtf_X["centroids"] = 0<br/>for i in closest:<br/>    dtf_X["centroids"].iloc[i] = 1</span><span id="5ab3" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## add clustering info to the original dataset<br/></strong>dtf[["<strong class="og jf">cluster</strong>","<strong class="og jf">centroids</strong>"]] = dtf_X[["<strong class="og jf">cluster</strong>","<strong class="og jf">centroids</strong>"]]<br/>dtf.sample(5)</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ow"><img src="../Images/fdb7804b8ba623291ae3136c999fb151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*soLpnEdBeePzLNG_WkiQ2Q.png"/></div></div></figure><p id="819f" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">æˆ‘å‘æ•°æ®é›†æ·»åŠ äº†ä¸¤åˆ—:"<em class="nx"> cluster </em>"è¡¨ç¤ºè§‚å¯Ÿå€¼å±äºå“ªä¸ªç°‡ï¼Œä»¥åŠ"<em class="nx"> centroids </em>"å¦‚æœè§‚å¯Ÿå€¼ä¹Ÿæ˜¯è´¨å¿ƒ(æœ€é è¿‘ä¸­å¿ƒ)ï¼Œåˆ™ä¸º 1ï¼Œå¦åˆ™ä¸º 0ã€‚è®©æˆ‘ä»¬è®¡åˆ’ä¸€ä¸‹:</p><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="9c30" class="kt ku je og b gy ok ol l om on"><strong class="og jf">## plot</strong><br/>fig, ax = plt.subplots()<br/>sns.<strong class="og jf">scatterplot</strong>(x="Latitude", y="Longitude", data=dtf, <br/>                palette=sns.color_palette("bright",k),<br/>                hue='cluster', size="centroids", size_order=[1,0],<br/>                legend="brief", ax=ax).set_title('Clustering <br/>                (k='+str(k)+')')</span><span id="50ec" class="kt ku je og b gy oo ol l om on">th_centroids = model.cluster_centers_<br/>ax.scatter(th_centroids[:,0], th_centroids[:,1], s=50, c='black', <br/>           marker="x")</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ox"><img src="../Images/f0d1e59050b55f194d3028fa663a709a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ighr6bQcNEwvnhRXHvC3mA.png"/></div></div></figure><p id="0e0b" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated"><a class="ae ms" href="https://en.wikipedia.org/wiki/Affinity_propagation" rel="noopener ugc nofollow" target="_blank"> <strong class="lr jf">ç›¸ä¼¼æ€§ä¼ æ’­</strong> </a>æ˜¯ä¸€ç§åŸºäºå›¾å½¢çš„ç®—æ³•ï¼Œå°†æ¯ä¸ªè§‚å¯Ÿå€¼åˆ†é…ç»™å…¶æœ€è¿‘çš„æ ·æœ¬ã€‚åŸºæœ¬ä¸Šï¼Œæ‰€æœ‰çš„è§‚å¯Ÿâ€œæŠ•ç¥¨â€ç»™å®ƒä»¬æƒ³è¦å…³è”çš„å…¶ä»–è§‚å¯Ÿï¼Œè¿™å¯¼è‡´å°†æ•´ä¸ªæ•°æ®é›†åˆ’åˆ†æˆå¤§é‡ä¸å‡åŒ€çš„èšç±»ã€‚å½“æ‚¨ä¸èƒ½æŒ‡å®šç°‡çš„æ•°é‡æ—¶ï¼Œè¿™æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œå¹¶ä¸”å®ƒé€‚ç”¨äºåœ°ç†ç©ºé—´æ•°æ®ï¼Œå› ä¸ºå®ƒå¯ä»¥å¾ˆå¥½åœ°å¤„ç†éå¹³é¢å‡ ä½•ã€‚</p><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="0ca2" class="kt ku je og b gy ok ol l om on">model = cluster.<strong class="og jf">AffinityPropagation</strong>()</span></pre><p id="8bff" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">ä½¿ç”¨ä¹‹å‰çš„ç›¸åŒä»£ç ï¼Œæ‚¨å¯ä»¥æ‹Ÿåˆæ¨¡å‹(æ‰¾åˆ° 12 ä¸ªç°‡)ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç æ¥ç»˜å›¾(ä¸åŒä¹‹å¤„åœ¨äº<em class="nx"> k </em>åœ¨å¼€å§‹æ—¶æ²¡æœ‰å£°æ˜ï¼Œå¹¶ä¸”æ²¡æœ‰ç†è®ºä¸Šçš„è´¨å¿ƒ):</p><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="089c" class="kt ku je og b gy ok ol l om on">k = dtf["cluster"].nunique()</span><span id="daba" class="kt ku je og b gy oo ol l om on">sns.<strong class="og jf">scatterplot</strong>(x="Latitude", y="Longitude", data=dtf, <br/>                palette=sns.color_palette("bright",k),<br/>                hue='cluster', size="centroids", size_order=[1,0],<br/>                legend="brief").set_title('Clustering <br/>                (k='+str(k)+')')</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oy"><img src="../Images/f8f33cec2b0349d1e14c450ab26b1ef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mj5tzTu6gS-f-pK4RnEOkQ.png"/></div></div></figure><p id="8bf8" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated"><a class="ae ms" href="https://en.wikipedia.org/wiki/Self-organizing_map" rel="noopener ugc nofollow" target="_blank"> <strong class="lr jf">è‡ªç»„ç»‡åœ°å›¾</strong> </a> (SOMs)ç”±äºä½¿ç”¨æ·±åº¦å­¦ä¹ è€Œå¤§ä¸ç›¸åŒã€‚äº‹å®ä¸Šï¼ŒSOM æ˜¯ä¸€ç§äººå·¥ç¥ç»ç½‘ç»œï¼Œå®ƒä½¿ç”¨æ— ç›‘ç£å­¦ä¹ è¿›è¡Œè®­ç»ƒï¼Œä»¥äº§ç”Ÿè¾“å…¥ç©ºé—´çš„ä½ç»´è¡¨ç¤ºï¼Œç§°ä¸ºâ€œåœ°å›¾â€(ä¹Ÿç§°ä¸º<a class="ae ms" href="https://en.wikipedia.org/wiki/Hybrid_Kohonen_self-organizing_map" rel="noopener ugc nofollow" target="_blank"> Kohonen å±‚</a>)ã€‚åŸºæœ¬ä¸Šï¼Œè¾“å…¥è¿æ¥åˆ°å½¢æˆæ˜ å°„çš„<em class="nx"> n x m </em>ç¥ç»å…ƒï¼Œç„¶åä¸ºæ¯ä¸ªè§‚å¯Ÿè®¡ç®—â€œè·èƒœâ€ç¥ç»å…ƒ(æœ€è¿‘çš„)ï¼Œå¹¶ä½¿ç”¨æ¨ªå‘è·ç¦»å°†ç¥ç»å…ƒèšé›†åœ¨ä¸€èµ·ã€‚è¿™é‡Œï¼Œæˆ‘å°†å°è¯•ä½¿ç”¨ 4x4 SOM:</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oz"><img src="../Images/5acf999105970a46b2ea0c2175bd7c20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pwaWkZMX-PrEGHImTboI2g.png"/></div></div></figure><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="7a88" class="kt ku je og b gy ok ol l om on">X = dtf[[<strong class="og jf">"Latitude","Longitude"</strong>]]<br/>map_shape = <strong class="og jf">(4,4)</strong></span><span id="7d45" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## scale data</strong><br/>scaler = preprocessing.<strong class="og jf">StandardScaler</strong>()<br/>X_preprocessed = scaler.fit_transform(X.values)</span><span id="5966" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## clustering<br/></strong>model = minisom.<strong class="og jf">MiniSom</strong>(x=map_shape[0], y=map_shape[1], <br/>                        input_len=X.shape[1])<br/>model.train_batch(X_preprocessed, num_iteration=100, verbose=False)</span><span id="2023" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## build output dataframe</strong><br/>dtf_X = X.copy()<br/>dtf_X["cluster"] = np.<strong class="og jf">ravel_multi_index</strong>(np.array(<br/>      [model.winner(x) for x in X_preprocessed]).T, dims=map_shape)</span><span id="b3eb" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## find real centroids<br/></strong>cluster_centers = np.array([vec for center in model.get_weights() <br/>                            for vec in center])</span><span id="9a3d" class="kt ku je og b gy oo ol l om on">closest, distances = scipy.<strong class="og jf">cluster.vq.vq</strong>(model.cluster_centers_, <br/>                                         X_preprocessed)<br/>dtf_X["centroids"] = 0<br/>for i in closest:<br/>    dtf_X["centroids"].iloc[i] = 1</span><span id="4ce9" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## add clustering info to the original dataset<br/></strong>dtf[["cluster","centroids"]] = dtf_X[["cluster","centroids"]]</span><span id="911a" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## plot<br/></strong>k = dtf["cluster"].nunique()</span><span id="f75d" class="kt ku je og b gy oo ol l om on">fig, ax = plt.subplots()<br/>sns.<strong class="og jf">scatterplot</strong>(x="Latitude", y="Longitude", data=dtf, <br/>                palette=sns.color_palette("bright",k),<br/>                hue='cluster', size="centroids", size_order=[1,0],<br/>                legend="brief", ax=ax).set_title('Clustering <br/>                (k='+str(k)+')')</span><span id="ddd5" class="kt ku je og b gy oo ol l om on">th_centroids = scaler.inverse_transform(cluster_centers)<br/>ax.scatter(th_centroids[:,0], th_centroids[:,1], s=50, c='black', <br/>           marker="x")</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pa"><img src="../Images/0044c3d7e7fa929b4edbaf449e7ca658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Hu2EeU8jcYV_Jl3KMUMGQ.png"/></div></div></figure><p id="196a" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">ç‹¬ç«‹äºæ‚¨ç”¨æ¥å¯¹æ•°æ®è¿›è¡Œèšç±»çš„ç®—æ³•ï¼Œç°åœ¨æ‚¨æœ‰äº†ä¸€ä¸ªå¤šäº†ä¸¤åˆ—çš„æ•°æ®é›†("<em class="nx"> cluster </em>"ï¼Œ"<em class="nx"> centroids </em>")ã€‚æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å¯è§†åŒ–åœ°å›¾ä¸Šçš„æ˜Ÿå›¢ï¼Œè¿™æ¬¡æˆ‘ä¹Ÿè¦ç”¨ä¸€ä¸ªæ ‡è®°æ¥æ˜¾ç¤ºè´¨å¿ƒã€‚</p><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="9268" class="kt ku je og b gy ok ol l om on">x, y = <strong class="og jf">"Latitude", "Longitude"</strong><br/>color =<strong class="og jf"> "cluster"<br/></strong>size =<strong class="og jf"> "Staff"<br/></strong>popup =<strong class="og jf"> "Street Address"<br/></strong>marker = "<strong class="og jf">centroids</strong>"<br/>data = dtf.copy()</span><span id="2824" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## create color column</strong><br/>lst_elements = sorted(list(dtf[color].unique()))<br/>lst_colors = ['#%06X' % np.random.randint(0, 0xFFFFFF) for i in <br/>              range(len(lst_elements))]<br/>data["color"] = data[color].apply(lambda x: <br/>                lst_colors[lst_elements.index(x)])</span><span id="e604" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## create size column (scaled)</strong><br/>scaler = preprocessing.MinMaxScaler(feature_range=(3,15))<br/>data["size"] = scaler.fit_transform(<br/>               data[size].values.reshape(-1,1)).reshape(-1)</span><span id="f59c" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## initialize the map with the starting location<br/></strong>map_ = folium.<strong class="og jf">Map</strong>(location=location, tiles="cartodbpositron",<br/>                  zoom_start=11)</span><span id="957a" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## add points</strong><br/>data.apply(lambda row: folium.<strong class="og jf">CircleMarker</strong>(<br/>           location=[row[x],row[y]], popup=row[popup],<br/>           color=row["color"], fill=True,<br/>           radius=row["size"]).add_to(map_), axis=1)</span><span id="0fd9" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## add html legend<br/></strong>legend_html = """&lt;div style="position:fixed; bottom:10px; left:10px; border:2px solid black; z-index:9999; font-size:14px;"&gt;&amp;nbsp;&lt;b&gt;"""+color+""":&lt;/b&gt;&lt;br&gt;"""<br/>for i in lst_elements:<br/>     legend_html = legend_html+"""&amp;nbsp;&lt;i class="fa fa-circle <br/>     fa-1x" style="color:"""+<strong class="og jf">lst_colors[lst_elements.index(i)]</strong>+""""&gt;<br/>     &lt;/i&gt;&amp;nbsp;"""+str(i)+"""&lt;br&gt;"""<br/>legend_html = legend_html+"""&lt;/div&gt;"""</span><span id="9ab7" class="kt ku je og b gy oo ol l om on">map_.get_root().<strong class="og jf">html.add_child</strong>(folium.<strong class="og jf">Element</strong>(legend_html))</span><span id="3d0c" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## add centroids marker</strong><br/>lst_elements = sorted(list(dtf[marker].unique()))<br/>data[data[marker]==1].apply(lambda row: <br/>           folium.<strong class="og jf">Marker</strong>(location=[row[x],row[y]], <br/>           popup=row[marker], draggable=False,          <br/>           icon=folium.<strong class="og jf">Icon</strong>(color="black")).add_to(map_), axis=1)</span><span id="da53" class="kt ku je og b gy oo ol l om on"><strong class="og jf">## plot the map</strong><br/>map_</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pb"><img src="../Images/87a8a8388c8031ea99495052fa3e3aa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YNWyqAaheDhZ1b2wALwHRw.png"/></div></div></figure><p id="fd39" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†é›†ç¾¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¯ä¸ªé›†ç¾¤å†…éƒ¨å¼€å§‹å•†åº—åˆç†åŒ–ã€‚</p><h2 id="c30d" class="kt ku je bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">å•†åº—åˆç†åŒ–</h2><p id="1649" class="pw-post-body-paragraph lp lq je lr b ls lt kf lu lv lw ki lx lc ly lz ma lg mb mc md lk me mf mg mh im bi translated">å› ä¸ºæœ¬æ–‡çš„ä¸»è¦ç„¦ç‚¹æ˜¯åœ°ç†ç©ºé—´æ•°æ®çš„èšç±»ï¼Œæ‰€ä»¥æˆ‘å°†ä¿æŒè¿™ä¸€éƒ¨åˆ†éå¸¸ç®€å•ã€‚åœ¨æ¯ä¸ªé›†ç¾¤ä¸­ï¼Œæˆ‘å°†é€‰æ‹©æ½œåœ¨ç›®æ ‡(é«˜æˆæœ¬å•†åº—)å’Œä¸­å¿ƒ(ä½æˆæœ¬å•†åº—)ï¼Œå¹¶å°†ç›®æ ‡çš„å‘˜å·¥é‡æ–°å®‰ç½®åœ¨ä¸­å¿ƒï¼Œç›´åˆ°åè€…è¾¾åˆ°æ»¡è´Ÿè·ã€‚å½“ä¸€ä¸ªç›®æ ‡çš„æ‰€æœ‰å‘˜å·¥éƒ½è¢«è½¬ç§»æ—¶ï¼Œå•†åº—å¯ä»¥å…³é—­ã€‚</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pc"><img src="../Images/b7d0f448d7f9cfc71a0abdccdd58c675.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*MtpFLSkRrKtIEa-xvR_scg.gif"/></div></div><p class="pd pe gj gh gi pf pg bd b be z dk translated">é›†ç¾¤å†…çš„è¿­ä»£</p></figure><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="ef5f" class="kt ku je og b gy ok ol l om on">dtf_new = pd.DataFrame()</span><span id="fbe4" class="kt ku je og b gy oo ol l om on">for c in sorted(dtf["cluster"].unique()):<br/>    dtf_cluster = dtf[dtf["cluster"]==c]<br/>    <br/>   <strong class="og jf"> ## hubs and targets</strong><br/>    lst_hubs = dtf_cluster[dtf_cluster["Cost"]=="low"<br/>               ].sort_values("Capacity").to_dict("records")<br/>    lst_targets = dtf_cluster[dtf_cluster["Cost"]=="high"<br/>               ].sort_values("Staff").to_dict("records")</span><span id="f50a" class="kt ku je og b gy oo ol l om on">    <strong class="og jf">## move targets</strong><br/>    for target in lst_targets:<br/>         for hub in lst_hubs:<br/>             <strong class="og jf">### if hub has space</strong><br/>             if hub["Capacity"] &gt; 0:<br/>                residuals = hub["Capacity"] - target["Staff"]</span><span id="49ff" class="kt ku je og b gy oo ol l om on">                <strong class="og jf">#### case of hub has still capacity: do next target</strong><br/>                if residuals &gt;= 0:<br/>                   hub["Staff"] += target["Staff"]<br/>                   hub["Capacity"] = hub["Potential"] - hub["Staff"]<br/>                   target["Capacity"] = target["Potential"]<br/>                   target["Staff"] = 0<br/>                   break</span><span id="1813" class="kt ku je og b gy oo ol l om on">                <strong class="og jf">#### case of hub is full: do next hub</strong><br/>                else:<br/>                   hub["Capacity"] = 0<br/>                   hub["Staff"] = hub["Potential"]<br/>                   target["Staff"] = -residuals<br/>                   target["Capacity"] = target["Potential"] - <br/>                                          target["Staff"]</span><span id="f05f" class="kt ku je og b gy oo ol l om on">    dtf_new = dtf_new.append(pd.DataFrame(lst_hubs)<br/>                 ).append(pd.DataFrame(lst_targets))</span><span id="d7a8" class="kt ku je og b gy oo ol l om on">dtf_new = dtf_new.append(dtf[dtf["Cost"]=="medium"]<br/>                 ).reset_index(drop=True).sort_values(<br/>                 ["cluster","Staff"])<br/>dtf_new.head()</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ph"><img src="../Images/3fca5254ac03f375b0857aba0347292d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1I-tlALhqPW7l6m1JPkyfQ.png"/></div></div></figure><p id="4f60" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ç®—æ³•ï¼Œå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼è¿›è¡Œæ”¹è¿›:ä¾‹å¦‚ï¼Œå°†ä¸­ç­‰æˆæœ¬çš„å•†åº—çº³å…¥ç­‰å¼ï¼Œå¹¶åœ¨ä½æˆæœ¬å•†åº—å…¨éƒ¨æ»¡å‘˜æ—¶é‡å¤è¿™ä¸€è¿‡ç¨‹ã€‚</p><p id="d125" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬ç”¨è¿™ä¸ªåŸºæœ¬æµç¨‹å…³é—­äº†å¤šå°‘å®¶é«˜æˆæœ¬å•†åº—:</p><pre class="mj mk ml mm gt of og oh oi aw oj bi"><span id="3d06" class="kt ku je og b gy ok ol l om on">dtf_new["<strong class="og jf">closed</strong>"] = dtf_new["<strong class="og jf">Staff</strong>"].apply(lambda x: 1 <br/>                                           if x==0 else 0)<br/>print("closed:", dtf_new["<strong class="og jf">closed</strong>"].sum())</span></pre><p id="45a3" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">æˆ‘ä»¬æˆåŠŸå…³é—­äº† 19 å®¶å•†åº—ï¼Œä½†æˆ‘ä»¬æ˜¯å¦ä¹Ÿä¿æŒäº†è¯¥åœ°åŒºçš„å‡åŒ€è¦†ç›–ï¼Œè¿™æ ·é¡¾å®¢å°±ä¸éœ€è¦å»å¦ä¸€ä¸ªç¤¾åŒºé€›å•†åº—äº†ï¼Ÿè®©æˆ‘ä»¬åœ¨åœ°å›¾ä¸Šæ ‡å‡ºå…³é—­çš„å•†åº—(<em class="nx"> marker = "closed" </em>)æ¥æƒ³è±¡ä¸€ä¸‹åæœ:</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pi"><img src="../Images/a093709b08bb0b7d28b83de653912d50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gPLPyPzcEw7fHgv94zPGtQ.png"/></div></div></figure><h2 id="6af9" class="kt ku je bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">ç»“è®º</h2><p id="a09b" class="pw-post-body-paragraph lp lq je lr b ls lt kf lu lv lw ki lx lc ly lz ma lg mb mc md lk me mf mg mh im bi translated">è¿™ç¯‡æ–‡ç« æ˜¯ä¸€ç¯‡å…³äº<strong class="lr jf">å¦‚ä½•åœ¨é›¶å”®å•†ä¸šæ¡ˆä¾‹</strong>ä¸­ä½¿ç”¨èšç±»å’Œåœ°ç†ç©ºé—´åˆ†æçš„æ•™ç¨‹ã€‚æˆ‘ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®é›†æ¥æ¯”è¾ƒæµè¡Œçš„æœºå™¨å­¦ä¹ å’Œæ·±åº¦å­¦ä¹ æ–¹æ³•ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•åœ¨äº¤äº’å¼åœ°å›¾ä¸Šç»˜åˆ¶è¾“å‡ºã€‚æˆ‘è¿˜å±•ç¤ºäº†ä¸€ä¸ªç®€å•çš„ç¡®å®šæ€§ç®—æ³•æ¥æä¾›ä¸šåŠ¡æ¡ˆä¾‹çš„è§£å†³æ–¹æ¡ˆã€‚</p><p id="aee6" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">æˆ‘å¸Œæœ›ä½ å–œæ¬¢å®ƒï¼å¦‚æœ‰é—®é¢˜å’Œåé¦ˆï¼Œæˆ–è€…åªæ˜¯åˆ†äº«æ‚¨æ„Ÿå…´è¶£çš„é¡¹ç›®ï¼Œè¯·éšæ—¶è”ç³»æˆ‘ã€‚</p><blockquote class="pj"><p id="3199" class="pk pl je bd pm pn po pp pq pr ps mh dk translated">ğŸ‘‰<a class="ae ms" href="https://linktr.ee/maurodp" rel="noopener ugc nofollow" target="_blank">æˆ‘ä»¬æ¥è¿çº¿</a>ğŸ‘ˆ</p></blockquote></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><blockquote class="pt pu pv"><p id="0215" class="lp lq nx lr b ls mn kf lu lv mo ki lx pw mp lz ma px mq mc md py mr mf mg mh im bi translated">æœ¬æ–‡æ˜¯ç”¨ Python è¿›è¡Œæœºå™¨å­¦ä¹ ç³»åˆ—<strong class="lr jf">çš„ä¸€éƒ¨åˆ†</strong>ï¼Œå‚è§:</p></blockquote><div class="is it gp gr iu mt"><a rel="noopener follow" target="_blank" href="/machine-learning-with-python-classification-complete-tutorial-d2c99dc524ec"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd jf gy z fp my fr fs mz fu fw jd bi translated">ç”¨ Python è¿›è¡Œæœºå™¨å­¦ä¹ :åˆ†ç±»(å®Œæ•´æ•™ç¨‹)</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">æ•°æ®åˆ†æå’Œå¯è§†åŒ–ã€ç‰¹å¾å·¥ç¨‹å’Œé€‰æ‹©ã€æ¨¡å‹è®¾è®¡å’Œæµ‹è¯•ã€è¯„ä¼°å’Œè§£é‡Š</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="pz l ne nf ng nc nh ja mt"/></div></div></a></div><div class="is it gp gr iu mt"><a rel="noopener follow" target="_blank" href="/machine-learning-with-python-regression-complete-tutorial-47268e546cea"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd jf gy z fp my fr fs mz fu fw jd bi translated">Python æœºå™¨å­¦ä¹ :å›å½’(å®Œæ•´æ•™ç¨‹)</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">æ•°æ®åˆ†æå’Œå¯è§†åŒ–ã€ç‰¹å¾å·¥ç¨‹å’Œé€‰æ‹©ã€æ¨¡å‹è®¾è®¡å’Œæµ‹è¯•ã€è¯„ä¼°å’Œè§£é‡Š</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="qa l ne nf ng nc nh ja mt"/></div></div></a></div><div class="is it gp gr iu mt"><a rel="noopener follow" target="_blank" href="/deep-learning-with-python-neural-networks-complete-tutorial-6b53c0b06af0"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd jf gy z fp my fr fs mz fu fw jd bi translated">Python æ·±åº¦å­¦ä¹ :ç¥ç»ç½‘ç»œ(å®Œæ•´æ•™ç¨‹)</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">ç”¨ TensorFlow å»ºç«‹ã€ç»˜åˆ¶å’Œè§£é‡Šäººå·¥ç¥ç»ç½‘ç»œ</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="qb l ne nf ng nc nh ja mt"/></div></div></a></div><div class="is it gp gr iu mt"><a rel="noopener follow" target="_blank" href="/modern-recommendation-systems-with-neural-networks-3cc06a6ded2c"><div class="mu ab fo"><div class="mv ab mw cl cj mx"><h2 class="bd jf gy z fp my fr fs mz fu fw jd bi translated">åŸºäºç¥ç»ç½‘ç»œçš„ç°ä»£æ¨èç³»ç»Ÿ</h2><div class="na l"><h3 class="bd b gy z fp my fr fs mz fu fw dk translated">ä½¿ç”¨ Python å’Œ TensorFlow æ„å»ºæ··åˆæ¨¡å‹</h3></div><div class="nb l"><p class="bd b dl z fp my fr fs mz fu fw dk translated">towardsdatascience.com</p></div></div><div class="nc l"><div class="qc l ne nf ng nc nh ja mt"/></div></div></a></div></div></div>    
</body>
</html>