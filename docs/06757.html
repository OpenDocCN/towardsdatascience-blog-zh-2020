<html>
<head>
<title>FizzBuzz in BigQuery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">BigQuery 中的 FizzBuzz</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fizzbuzz-in-bigquery-e0c4fbc1d195?source=collection_archive---------74-----------------------#2020-05-26">https://towardsdatascience.com/fizzbuzz-in-bigquery-e0c4fbc1d195?source=collection_archive---------74-----------------------#2020-05-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9e90" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有时你需要一个巨大的托管数据库服务来传递 FizzBuzz</h2></div><p id="3235" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你过去做过编程，我肯定你听说过 FizzBuzz 挑战。这是一个简单的编程任务，应该会让应届毕业生措手不及。有很多关于如何用 Java、Python、C 等等语言来做这件事的帖子。但我认为在 BigQuery 中进行会很有趣。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/27a82af58c0a59b70120c03414b0e851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ZJoTDxq5SAEQNcZF4ffMg.jpeg"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">图片来源:<a class="ae lu" href="https://www.pxfuel.com/en/free-photo-jyliq" rel="noopener ugc nofollow" target="_blank"> pxfuel </a></p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="b3f8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">挑战如下:</p><p id="83fa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">写一个函数或者程序，打印从 1 到 100 的数字，但是如果这个数字能被 3 整除，打印<code class="fe mc md me mf b">Fizz</code>，如果这个数字能被 5 整除，打印<code class="fe mc md me mf b">Buzz</code>，如果能被 3 和 5 整除，打印<code class="fe mc md me mf b">FizzBuzz</code>。</p><p id="39c5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">多刺激啊，对吧？</p><p id="ebe3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里有一个朱莉娅版本让我们思考(因为我喜欢朱莉娅:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="5f8b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，这个问题已经解决了，让我们从创建数字开始。你可以使用<code class="fe mc md me mf b">union all</code>语句，但是那会很快变得很无聊，所以我将使用数组来代替。请注意，这些查询在 BigQuery 中都是免费的，因为我们不查询任何实际数据，我们只是自己动态生成数据。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="950f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这使我们得到以下结果:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mi"><img src="../Images/8e4b6e1448691c26d531bb8de561dcdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BPBstdDBLjY0W95UmU6RQg.png"/></div></div></figure><p id="9549" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还有，生活中免费的东西总是更好:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/c610db8bd711117e1bb8b4dee7b162df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*hs58Q445r106p-GsdLENFQ.png"/></div></figure><p id="1a1b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里发生的事情是，<code class="fe mc md me mf b">GenerateArray</code> <a class="ae lu" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/arrays#using_generated_values" rel="noopener ugc nofollow" target="_blank">创建了一个从 1 到 15 的数组</a>，然后我们使用<code class="fe mc md me mf b">Unnest</code>到<a class="ae lu" href="https://cloud.google.com/bigquery/docs/reference/standard-sql/arrays#flattening_arrays" rel="noopener ugc nofollow" target="_blank">展平数组</a>，并使用数组的每个元素作为列<code class="fe mc md me mf b">num</code>的行值。(上面链接了函数的文档。)</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="e2b9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在是嘶嘶作响的部分。我将使用上面创建的表，只是为了使代码更容易阅读，并对其应用一个<code class="fe mc md me mf b">CASE</code>语句:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="1e4b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">需要注意的事项:</p><ul class=""><li id="e51e" class="mk ml it kk b kl km ko kp kr mm kv mn kz mo ld mp mq mr ms bi translated">我们必须首先检查一个数是否能被 3 和 5 整除(即 15)</li><li id="7c18" class="mk ml it kk b kl mt ko mu kr mv kv mw kz mx ld mp mq mr ms bi translated">不可分的数字必须转换为字符串，以确保该列的所有元素都具有相同的类型</li></ul><p id="46ab" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这应该可以了。下次他们让你在采访中写 FizzBuzz 的时候，登录 GCP，在 BigQuery 中写！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><div class="lf lg lh li gt my"><a rel="noopener follow" target="_blank" href="/fibonacci-series-with-user-defined-functions-in-bigquery-f72e3e360ce6"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">BigQuery 中的斐波那契数列</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">在 BigQuery 中使用用户定义的 JavaScript 函数来计算 Fibonacci</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">towardsdatascience.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm lo my"/></div></div></a></div><div class="nn no gp gr np my"><a rel="noopener follow" target="_blank" href="/load-files-faster-into-bigquery-94355c4c086a"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">将文件更快地加载到 BigQuery 中</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">针对摄取的 CSV、GZIP、AVRO 和拼花文件类型进行基准测试</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">towardsdatascience.com</p></div></div><div class="nh l"><div class="nq l nj nk nl nh nm lo my"/></div></div></a></div></div></div>    
</body>
</html>