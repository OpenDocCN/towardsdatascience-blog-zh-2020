<html>
<head>
<title>Diffie Hellman Key Exchange</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Diffie Hellman 密钥交换</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/diffie-hellman-key-exchange-f673d617137?source=collection_archive---------24-----------------------#2020-08-17">https://towardsdatascience.com/diffie-hellman-key-exchange-f673d617137?source=collection_archive---------24-----------------------#2020-08-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/9622bac6800051626efad4953dc4f0af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*B1Mr76Rk2dfda0wB"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">克林特·帕特森在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="612b" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">使互联网成为可能的技术</h2></div><p id="4a4d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">简而言之，Diffie Hellman 是一种广泛使用的技术，用于将对称加密密钥安全地发送给另一方。在继续之前，让我们首先讨论一下为什么要使用像 Diffie Hellman 这样的东西。当在互联网上以纯文本形式传输数据时，有人很容易使用某种数据包嗅探器(如 WireShark)来捕获数据包。一个恶意的人，可能会偷听你和你女朋友的谈话，或者更糟，窃取密码和信用卡信息。幸运的是，一些非常聪明的人想出了一种为交通信息编码的方法。我们将普通的纯文本转换成难以理解的东西，反之亦然的过程被称为<strong class="la jk">密码术</strong>。密码学最基本的例子叫做凯撒密码。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/14444e1eccffd88424a5a60242aefbb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/0*AFW0fyRwOwFIhT0L.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://commons.wikimedia.org/wiki/File:Caesar_Shift_Cipher_Wheel.png" rel="noopener ugc nofollow" target="_blank">https://commons . wikimedia . org/wiki/File:Caesar _ Shift _ Cipher _ wheel . png</a></p></figure><p id="c0bc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本质上，双方都有一个对称密钥，它指定了什么字符映射到加密文本的什么符号。没有钥匙的人不能阅读这条信息。例如，在前面的图像中，字符“A”将被编码为加密消息中的“T”。然后，接收端的个人可以使用相同的凯撒密码来解码消息。</p><p id="d430" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在计算机网络领域，对称加密算法的问题是，密钥必须不可避免地通过网络发送给另一方，以便他们可以解密传入的消息，并依次加密它们。如果恶意行为者碰巧在那个时间点监听网络，他们可以获得密钥，并将其用于邪恶的目的。</p><p id="7b26" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这就是不对称加密发挥作用的地方。不对称加密通过生成公钥和私钥对来工作。公钥只能用于加密消息，而私钥只能用于解密消息。例如，当您进行网上银行业务时，您将您的公钥交给银行，然后用它来加密发送给您的数据。如果一个坏人得到了公钥，他们不会造成任何真正的伤害，因为他们只有加密数据的能力。</p><p id="2fbe" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">今天，使用最广泛的非对称加密算法是 RSA。<strong class="la jk"> RSA </strong>代表<strong class="la jk">Rivest–sha mir–ad leman</strong>在<strong class="la jk">T5】之后，这些人在 1977 年首次描述了该算法。RSA 算法通过将消息提升到公钥的幂，然后取结果的模来加密消息。为了解密给定的消息，我们将它提升到私钥的幂，然后取结果的模。RSA 依赖于一种称为单向函数的数学概念。假设我们有以下等式:</strong></p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/3b596b836c0a212461a0eef8cf7d0527.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/0*E4QPJgUuGXwtwHNc.png"/></div></figure><p id="38d3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，假设你得到了数字<strong class="la jk"> <em class="ma"> 8 </em> </strong>并要求返回 2 <strong class="la jk"> <em class="ma"> </em> </strong>。你能做到吗？</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/48a9d95f6bddfa2c9b1881700721577e.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/0*Nqn1o0_DJ_e_e0a7.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/e7bfc3d94bc1f9bec1437900a785cc99.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/0*k63jn643Sx5yASFY.png"/></div></figure><p id="b1ce" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了弄清楚<strong class="la jk"> <em class="ma"> 8 </em> </strong>的所有因素，我们可以相对容易地逆向工作。</p><p id="dc13" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">相反，模(与余数同义)运算是单向函数的一个例子。假设我们有以下等式:</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi md"><img src="../Images/99c9b0ffff5cac25c4bd2199e765512f.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/0*N685eLNoi9NXf-YU.png"/></div></figure><p id="54b3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果让你从<strong class="la jk"><em class="ma"/></strong>推导出<strong class="la jk"> <em class="ma"> 11 </em> </strong>，你会吗？</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi me"><img src="../Images/963bbc245136e8c0a5c2355efd5953da.png" data-original-src="https://miro.medium.com/v2/resize:fit:266/format:webp/0*W9iTkopd2gwoxISB.png"/></div></figure><p id="f0ff" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过尝试所有不同的可能性(即<strong class="la jk"> 3 % 4 = 3 </strong>，<strong class="la jk"> 7 % 4 = 3 </strong>，<strong class="la jk"> 11 % 4 = 3) </strong>，您可能能够获得正确的答案(<strong class="la jk">11<em class="ma">)</em>)</strong>，但是当分子非常大时，如 RSA 的情况(即 4096 位长)，有很多排列，我指的是给出余数的很多排列鉴于这一特性，黑客将别无选择，只能使用蛮力(尝试各种可能性)来从加密消息和公钥中确定私钥。考虑到今天的密钥长度为 4096 位，传统的计算机要花上几个世纪才能遍历完所有可能的值。</p><p id="17fe" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">实际上，非对称加密比对称加密慢 3 到 5 个数量级。因此，我们不使用非对称加密来加密实际的有效载荷。相反，我们使用像 Diffie-Hellman 这样的技术安全地向另一方发送对称加密密钥，然后使用所述密钥加密/解密所有进一步的消息。</p><h1 id="2c4f" class="mf mg jj bd mh mi mj mk ml mm mn mo mp kp mq kq mr ks ms kt mt kv mu kw mv mw bi translated">模运算(RSA) Diffie Hellman</h1><p id="2c91" class="pw-post-body-paragraph ky kz jj la b lb mx kk ld le my kn lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">我们已经在高层次上描述了 RSA。现在，让我们看一个具体的例子。假设，鲍勃想给爱丽丝发送一条消息。鲍勃将通过生成新的随机素数<strong class="la jk"> <em class="ma"> N </em> </strong>和相应的生成器<strong class="la jk"><em class="ma"/></strong>开始</p><p id="94d6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意:g 不是随机的，但是我们如何选择它超出了本文的范围。T47】</p><p id="e7b2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">实际上，N 是一个很大的数字。然而，为了简单起见，我们将使用以下值:</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/d8f9768aa67c63ec9d6850e2ab937234.png" data-original-src="https://miro.medium.com/v2/resize:fit:308/format:webp/1*ydZRZLdVWmBcPaQVZODG7Q.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/b619f994ea3a3f9bbab7a8aca9865903.png" data-original-src="https://miro.medium.com/v2/resize:fit:268/format:webp/1*r_5glr4lvm2-E4wzMq_F9Q.png"/></div></figure><p id="2144" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">两个 g &amp; N 都以纯文本形式在网络上发送。Bob 然后生成一个密钥<strong class="la jk"> a = 2 </strong>。接下来，鲍勃将生成器<strong class="la jk"> g </strong>提升到他的密钥<strong class="la jk"> a </strong>的幂，并取结果的模。最终产品<strong class="la jk"> A = 5 </strong>被发送给爱丽丝。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/efa2869e61675cc22b51f7a4c51687c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:250/format:webp/1*XC36XHc2Nd-T8uo9v2KpEw.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/89a53c59ab757dfca268bb6b37206928.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/format:webp/1*5u9Rw5ifAKtn71T23YpuSg.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/1e93d246ae418aba19645cee41c77338.png" data-original-src="https://miro.medium.com/v2/resize:fit:428/format:webp/1*44CqMrTHkK3IKu46xGAVrg.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/b1c65e5074dd3d25da49b93f8fee0d4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*AKCE_1wGew8myFqZk0Fq-w.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/85779d03b72abeb14ba919c87029eba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:406/format:webp/1*hnAjnYXEuVP7_FIVFf1VNQ.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/3939e8e6db4c259acfb441a549d04896.png" data-original-src="https://miro.medium.com/v2/resize:fit:264/format:webp/1*2GLeSzbBQ2thYCRfaRrFNg.png"/></div></figure><p id="ab94" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在另一端，Alice 执行相同的步骤—即，她生成一个密钥<strong class="la jk"> b，</strong>将生成器<strong class="la jk"> g </strong>提升到她的密钥<strong class="la jk"> b </strong>的幂，取乘积的模，并将最终结果<strong class="la jk"> B = 3 </strong>发送给 Bob。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/46975422ce15b756c6fc4fe84a02dbed.png" data-original-src="https://miro.medium.com/v2/resize:fit:236/format:webp/1*eKN_KIVAEKV7Eqz-ncey-g.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/78af48dd40890a769334a6662fdfdb17.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/format:webp/1*BVsowTDelfopHFetcLSHdQ.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/0eb39dfe5442db91bef88c9585179df1.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*ooD9QZ7hsvmbihiujr-rvA.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/6cef33f1eca6d59f6fa46039da1fe105.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*1oqnTb1_AsK7RM3R6X-XsA.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/283a2766ce0b27d64ce5734d51acdcbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*76kv73-3XcK5WOswY9sogA.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi no"><img src="../Images/d60745d3fe2dbc5845d0c53bc90bd620.png" data-original-src="https://miro.medium.com/v2/resize:fit:254/format:webp/1*mnJacaQdpD0Fa2iGquWywQ.png"/></div></figure><p id="d15d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">即使恶意的参与者想要窥探他们的流量。他们无法从 A 和 b 中推导出 Bob 或 Alice 的秘密密钥。</p><p id="ef58" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在从<strong class="la jk"> </strong>爱丽丝接收到<strong class="la jk"> B </strong>后，鲍勃将其提升到他的私钥<strong class="la jk"> a </strong>的幂，并取结果的模。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/d84f0abf21bc2105fcee423b95c1251d.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*g6m96YUEUAOvAa8j2-axAg.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi np"><img src="../Images/b0ae5065a718679bef329f1d675cbefd.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*NC3R3yWBHhqRt4L0fX129w.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/b7336e6448723af03c165f3263aafd43.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*jdXcwqP-GhJr2jkpE1yxjg.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/ee967caa239c54d224e7b23d99623d99.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*LF4I77hyxoM9rbP-ihtLhA.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/da3d3e7a68ae9a9bebd5b8b8b83d8cbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*5ZONmC8HPlr6jJ8LQ6sWXA.png"/></div></figure><p id="64fd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">爱丽丝也一样。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/62adbc1c1e5c35545ec42b8595af571f.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*w4rk4Jt1nVQJ3ETBjMc62g.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/95969144faa3285e140bb88d831e6a12.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/format:webp/1*W6nMrq1NLdq4IqxI2dc5EA.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi np"><img src="../Images/b0ae5065a718679bef329f1d675cbefd.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*NC3R3yWBHhqRt4L0fX129w.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/3fbba387a6433d04a2879a4e68cc032c.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/format:webp/1*pkgx6hg2eQf8prAJCsOjtA.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/fc08f9bb3c3f8d27756e87cf1d96303a.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*ifpS7GQd7r4GGXvGUj_Krg.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/da3d3e7a68ae9a9bebd5b8b8b83d8cbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:494/format:webp/1*5ZONmC8HPlr6jJ8LQ6sWXA.png"/></div></figure><p id="741f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这种情况下，爱丽丝和鲍勃最后都得到相同的数字，<strong class="la jk"> 9 </strong>。然后他们使用<strong class="la jk"> 9 </strong>作为 AES 等对称加密算法的密钥。</p><h1 id="63f7" class="mf mg jj bd mh mi mj mk ml mm mn mo mp kp mq kq mr ks ms kt mt kv mu kw mv mw bi translated">椭圆曲线 Diffie Hellman</h1><p id="55bd" class="pw-post-body-paragraph ky kz jj la b lb mx kk ld le my kn lg lh mz lj lk ll na ln lo lp nb lr ls lt im bi translated">试图从椭圆曲线上的一点导出私钥比传统的 RSA(模运算)更难破解。因此，椭圆曲线 Diffie Hellman 可以用较少的比特实现相当的安全级别。</p><p id="919e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">较小的密钥需要较少的计算步骤来加密/解密给定的有效载荷。当从本地机器建立安全连接时，您不会注意到太大的不同。然而，在类似于每秒执行成千上万次密钥交换的中型 web 服务器上，使用椭圆曲线 Diffie Hellman 可以节省大量资源。</p><p id="6681" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以将 Diffie Hellman RSA 密钥交换中所有可能数字的定义域想象成一个圆(由于模函数的性质)。<strong class="la jk"> n 的值越大，</strong>圆圈越大，越难猜出正确的数字。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nw"><img src="../Images/08c5554362205696b481d3aa8075a3c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JlvIITjwi0gc7DzTGk-hTw.png"/></div></div></figure><p id="3472" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">相反，顾名思义，椭圆曲线 Diffie Hellman 密钥交换的所有可能数字的定义域采用椭圆曲线的形式。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/c9e42679b7e4e5a77a5e504e4905577d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UCMQRN70Ln_eLoF-KlT-Sg.png"/></div></div></figure><p id="cb80" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">前述椭圆曲线的特征在于以下数学方程:</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/bd66b61a939af07496c0f7d5ca927ec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/1*O51k-wyC-wVMWKfAR3TXew.png"/></div></figure><p id="d366" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在野外，使用等式(<strong class="la jk"> mod n </strong>)是很常见的。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/c2129d0b223e110320fa789bc9c6d1a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*g5f-eHDITXtuqaDaRykWAQ.png"/></div></figure><p id="d977" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在实践中，你希望使用由专业数学家开发的曲线，并检查以确保它们是安全的。</p><p id="b197" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">椭圆曲线 Diffie Hellman 的工作方式不是像 RSA 那样进行幂运算，而是将点<strong class="la jk"> <em class="ma"> G </em> </strong>多次添加到自身。</p><p id="638c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看一个例子。假设 Bob 发起了与 Alice 的连接。Bob 选择一个生成器<strong class="la jk"> <em class="ma"> G ( </em> </strong>曲线上的一点)和椭圆曲线方程的参数<strong class="la jk"> <em class="ma"> a </em> </strong>、<strong class="la jk"> <em class="ma"> b </em> </strong>、<strong class="la jk"> <em class="ma"> n </em> </strong>，并以明文形式通过网络发送它们。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/dfd5f8ca90c9c859b5f881056e83762c.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*YyEEIgxn19ON2ci8kAJqwQ.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/09213069c3b0131c1f334fd24f9b8803.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/format:webp/1*2SDuphUdDT-D3EDsM3OLbw.png"/></div></figure><p id="a2e1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Bob 和 Alice 各自生成一个私钥(数字)。为了简单起见，我们假设鲍勃选择了<strong class="la jk"> b = 9 </strong>而<strong class="la jk">T19】爱丽丝选择了<strong class="la jk"> a = 3 </strong>。鲍勃和爱丽丝分别负责计算<strong class="la jk"> bG = 9G </strong>和<strong class="la jk">aG = 3G</strong><strong class="la jk">。</strong></strong></p><p id="de6d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了计算<strong class="la jk"> xG </strong>(其中<strong class="la jk"> x </strong>为任意数)<strong class="la jk">、</strong>，我们使用了点的加法和加倍公式。例如，为了确定 2G，我们使用一个点加倍的公式。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/e841ce18b5dbcccaca0be7cc0d3bbb55.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*w5XTo-5T824Q68OhkojHnA.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi od"><img src="../Images/5061aa0c0fc0430e118bef702ff06918.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*QQydTgA_kIC6sXT74hfM8w.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/dce472b86bb1da1d33b06982c3a71a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*_xWWXJ_9OsxF2LPh9GNc1Q.png"/></div></figure><p id="9a95" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了取分数的模，我们可以使用模乘逆计算器。</p><div class="is it gp gr iu of"><a href="https://planetcalc.com/3311/" rel="noopener  ugc nofollow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd jk gy z fp ok fr fs ol fu fw ji bi translated">模乘逆</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">这个计算器计算给定整数 a 模 m 的模乘逆。理论是下面的…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">planetcalc.com</p></div></div></div></a></div><p id="baa3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们将答案乘以<strong class="la jk"> 77 % 17 = 9，</strong>并取结果的模。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/724fbea942f00df913af8faeec2b5a6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/format:webp/1*00rZM1hh7cgH2E4rFWzQzQ.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi op"><img src="../Images/8e24af4fb9ea1c13ffb1cc3981f5e5e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:592/format:webp/1*N8RszEfy9rsde_4cAUy8bg.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/72ab48b9171ef35b99459897877a0193.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/format:webp/1*5VhqVfE7OomQH1qMWMnaJQ.png"/></div></figure><p id="d7f4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该点的 x 坐标可以计算如下:</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi or"><img src="../Images/11e6fdeb5d92e74ed23675b562213443.png" data-original-src="https://miro.medium.com/v2/resize:fit:622/format:webp/1*b4oHpAVjGhV5338VUu2oDA.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi os"><img src="../Images/fb23e44f44b3a8c5adde391bb046ee9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*ltCPDyzFM_bX-fyG6_Qynw.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/7893bd16fe6f95bda1986134bcd35726.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*Mi6JGrM5m-FZBaNaG9_Y9Q.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/b53d28e4cd2463387d00a4980aca5362.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*taP2qHdNaC5E1gAz3ZBI1A.png"/></div></figure><p id="0dbb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们用 x2G 来计算 y2G。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/37b166e3aa74bb8d5ee65b8559f89081.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*tb5-aGI8aIoSJaeMd6L6fw.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/c1f4d73906b0a3d7d73b41fec1c0d65b.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*eMTOmwCdMk8dVhNPXTg-LQ.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/d287a2c5ba0d2dcdcdce6627e46fee28.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*rQ7q6j3ov82yfAF04C92YA.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/e45259ef51a0a3bdee8f172b44cdb0f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*CKWi1BUZv1AHhnCjNGHHRA.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/f6bb2545f741b260fb1dea62e1d3fecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/format:webp/1*O3G6d3C-xoWsLQZkLW4Fjg.png"/></div></figure><p id="148e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了计算 3G，我们使用增加一个点的公式。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/d959d9fb5c951a9f6bfd80dd41ef609a.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*m4rajjZLZqsggCuMQg-0WQ.png"/></div></figure><p id="7de3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们从计算斜率开始。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/798109436c5da9e806cc20e0fabc6939.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*PsIIe7s0dlGvefVNSJGcGQ.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/a8086bba8d815aed64c1387ba7fb7415.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*A5DsIk-LEnTK5nyLM8O7Dg.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/5a76d0d3bfc58c7421aa5d038cfe449d.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*VXWbidxoWQ48aPk0ictiYw.png"/></div></figure><p id="1c0a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后我们计算新点的 x 位置。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/0e55bf875dffb21c288b9d05369aa1fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*6YUSBJRy5j-_VwSZwcEM4Q.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/2e5c479e49e38d09028d6fa5a8f34889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*AO4HSXJifIfo3PaYp8t8vg.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/970094094d8f114b33cc3a276b136ee9.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*0JnyUlmq5Axv9BE5f2k-BA.png"/></div></figure><p id="b3a4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，我们使用 x 坐标的值来计算 y。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/3da2420bfa7f0b5e1b6a19eaf582f783.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*nEGnCurrINapi3qJb6Y8hw.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/26f45f8a2e19d3e5566c51a11c2fb605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*aJHYBMV89ute3QUsronv8Q.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/20cfc2f66461f2ba3f7f8f48836d0852.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*ifNNjjSE7-CWzStq_1Wsxw.png"/></div></figure><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/e61e06ec12dc893251c9742bc9fa3bf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*BIA24Su8ll0okICG_Gqzug.png"/></div></figure><p id="305b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Bob 通过网络发送<strong class="la jk"> bG = 9G </strong> <strong class="la jk"> = (7，6) </strong>。同样，爱丽丝发送<strong class="la jk"> aG = 3G = (10，6) </strong>。在事件中，一个恶意的演员正在监听，从椭圆曲线上的点<strong class="la jk"> (7，6) </strong>和<strong class="la jk"> (10，6) </strong>导出<strong class="la jk"> aG </strong>或<strong class="la jk"> bG </strong>的值是不可能的。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pk"><img src="../Images/d89392e6fec3dba4bac8a8162e9f0664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cLbkY2j-TfhGONZwVPmIhg.png"/></div></div></figure><p id="780f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦 Bob 从 Alice 接收到<strong class="la jk"> aG = (10，6) </strong>，他计算<strong class="la jk"> abG = 9(3G) = 27G = (13，7) </strong>。当 Alice 从 Bob 收到<strong class="la jk"> bG = (7，6) </strong>时，她计算<strong class="la jk"> abG = 3(9G) = 27G = (13，7) </strong>。然后，它们都使用<strong class="la jk"> abG </strong>的 x 坐标作为所有进一步数据传输的对称加密密钥。</p></div></div>    
</body>
</html>