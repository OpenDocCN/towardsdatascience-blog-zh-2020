<html>
<head>
<title>10 tips to make your data science code cleaner and more efficient</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让您的数据科学代码更干净、更高效的10个技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/10-tips-to-make-your-data-science-code-cleaner-798ba398fcbe?source=collection_archive---------34-----------------------#2020-04-27">https://towardsdatascience.com/10-tips-to-make-your-data-science-code-cleaner-798ba398fcbe?source=collection_archive---------34-----------------------#2020-04-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="a0a2" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://medium.com/towards-data-science/data-science-in-the-real-world/home" rel="noopener"> <strong class="ak">现实世界中的数据科学</strong> </a></h2><div class=""/><div class=""><h2 id="ec3f" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">大多数Moocs和大学课程都不会教你如何用Python进行专业编码，这篇文章会给你一些提示。</h2></div><p id="a184" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">[注意:本文会根据您的反馈定期更新。欢迎在评论中添加您的评论。]</p><p id="754d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">首先，我想指出的是，这个列表并不详尽，但它是我的许多经验和阅读的结果:</p><ul class=""><li id="10a0" class="lk ll iq kq b kr ks ku kv kx lm lb ln lf lo lj lp lq lr ls bi translated">我从事数据科学项目、进行代码审查和开发机器学习管道的经验，其中涉及许多数据科学家(数据科学家Modeo.ai的联合创始人、Pronoo.ai的CTO、自由数据科学家和GarageISEP的AiLab负责人)。</li><li id="c3e6" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lp lq lr ls bi translated">我在亚马逊网络服务组织的自动驾驶汽车锦标赛AWS DeepRacer上的工作，在那里我赢得了法国版并参加了2019年12月在拉斯维加斯举行的世界决赛(见:<a class="ae ly" href="https://medium.com/@matthieurousseau_16015/what-is-the-aws-deepracer-league-and-how-did-we-win-the-french-edition-facae656680c" rel="noopener">https://medium . com/@ matthieurousseau _ 16015/what-is-the-AWS-deep racer-league-and-how-do-we-win-the-French-edition-facae 656680 c</a>)</li><li id="bd95" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lp lq lr ls bi translated">我读过的关于这个主题的书(我强烈推荐):</li></ul><ol class=""><li id="cf46" class="lk ll iq kq b kr ks ku kv kx lm lb ln lf lo lj lz lq lr ls bi translated">罗伯特·马丁。干净的代码:敏捷软件技术手册。皮尔森，2009年。</li><li id="1131" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated">奥雷连·盖伦。<em class="ma">使用Scikit-Learn和TensorFlow进行动手机器学习:构建智能系统的概念、工具和技术</em>。奥莱利，2017。</li><li id="830c" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated">韦斯·麦金尼。<em class="ma">用于数据分析的Python</em>。奥莱利，2017。</li><li id="c2de" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated">罗伯特·马丁。<em class="ma">干净的架构:软件结构和设计的工匠指南</em>。培生，2017。</li></ol><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mb"><img src="../Images/796bb4994d44b90e52f52b4f6f735e5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*U6Xf_MEn3MPdra95.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">罗伯特·马丁。<em class="mr">干净的代码:敏捷软件技术手册</em>。皮尔森，2009年，<a class="ae ly" href="https://www.amazon.fr/" rel="noopener ugc nofollow" target="_blank">https://www.amazon.fr/</a>。</p></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="8b77" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">尽管我在法国大学学习数据科学多年，但我的大部分知识都是通过Coursera和Udemy上的在线课程获得的(我想我是现代数据科学家的陈词滥调，但感谢吴恩达)。然而，我不得不说，在在线课程中教授代码的方式和如何开发代码以用于现实世界的应用程序之间存在巨大的差距。</p><p id="aaeb" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我不会假装说我的编码方式是最好的，我也不认为正确编码是一门精确的科学，但是通过遵循这10个技巧，你可以大大提高代码的可读性。</p><h1 id="111e" class="mz na iq bd nb nc nd ne nf ng nh ni nj kf nk kg nl ki nm kj nn kl no km np nq bi translated"><strong class="ak"> 1。每个功能一个抽象层次</strong></h1><p id="1ba7" class="pw-post-body-paragraph ko kp iq kq b kr nr ka kt ku ns kd kw kx nt kz la lb nu ld le lf nv lh li lj ij bi translated">为了使代码更具可读性，每个函数必须专用于一个任务。最好有很多函数，而不是太长的函数，做几件事，因此令人困惑。为了确保一个函数只做一件事，将函数限制在一个抽象层次上是很重要的。</p><p id="b868" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">什么是抽象层次？该函数的目的是从数据库中检索数据，然后对数据进行预处理。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nw"><img src="../Images/5ce608fce33a0e9414f4d53795cf43c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AV2vrAuX1sPc9GxNq3VbuQ.png"/></div></div></figure><p id="183a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在下图中，你可以看到三个层次的抽象。这其实是代码层面的问题。我们是否将“高级”函数视为process_data_from_db，我们是否像重命名列一样直接操作Pandas数据框架？</p><p id="864c" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">下面是我们可以做些什么来使这段代码更具可读性:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nx"><img src="../Images/93b6885e9fe056322393be392fa91405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kUV4kGW6ujVnFc0oBCOdSA.png"/></div></div></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="01dc" class="mz na iq bd nb nc ny ne nf ng nz ni nj kf oa kg nl ki ob kj nn kl oc km np nq bi translated"><strong class="ak"> 2。使用类型提示提高可读性</strong></h1><p id="cc73" class="pw-post-body-paragraph ko kp iq kq b kr nr ka kt ku ns kd kw kx nt kz la lb nu ld le lf nv lh li lj ij bi translated">因为我们的目标是操作数据，所以我们的函数通常采用不同的数据类型作为参数(列表、元组、字典、Pandas DataFrame、Numpy数组等)。因此，必须指定每个参数的类型以及返回对象的类型。</p><p id="598a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">为此，建议使用提示来指定每个参数和每个返回对象的类型。这使得代码更容易阅读和维护。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi od"><img src="../Images/c8378c8bd63fbd667415b652df2bde5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nDwKZ_RF7HWghBVmnrAXug.png"/></div></div></figure><p id="ed25" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">https://www.bernat.tech/the-state-of-type-hints-in-python/见<a class="ae ly" href="https://www.bernat.tech/the-state-of-type-hints-in-python/" rel="noopener ugc nofollow" target="_blank"/></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="9071" class="mz na iq bd nb nc ny ne nf ng nz ni nj kf oa kg nl ki ob kj nn kl oc km np nq bi translated">3.<strong class="ak">论据</strong></h1><p id="6e69" class="pw-post-body-paragraph ko kp iq kq b kr nr ka kt ku ns kd kw kx nt kz la lb nu ld le lf nv lh li lj ij bi translated">应该尽可能地限制争论。令人惊讶，对吧？让我告诉你为什么。</p><p id="bbe1" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">函数有几种类型，一元(0个自变量)、一元(1个自变量)、二元(2个自变量)、三元(3个自变量)和多元(3个以上自变量)。一元是可以接受的，二元应该避免，超过3个参数就太多了。</p><p id="52dc" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">主要原因是它们需要大量的概念性工作，因此很难理解，尤其是在具有复杂工作流的管道中。第二个原因与单元测试有关。当您对函数执行单元测试时，您必须测试每个参数之间所有可能的组合，这使得这一阶段的测试更加复杂。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi oe"><img src="../Images/393f5440b29ed509d172c4c3d4fdcc1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zPryneaVeguo_5YBD5prPA.png"/></div></div></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="f127" class="mz na iq bd nb nc ny ne nf ng nz ni nj kf oa kg nl ki ob kj nn kl oc km np nq bi translated"><strong class="ak"> 4。分块和缩进</strong></h1><p id="3610" class="pw-post-body-paragraph ko kp iq kq b kr nr ka kt ku ns kd kw kx nt kz la lb nu ld le lf nv lh li lj ij bi translated">功能必须很小。没有人想在2000行的函数中寻找错误。为了使函数可读，每个语句尽量少用几行(if，else，while…)。</p><p id="3614" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">理想情况下，每条语句尽量只占一行。为了尽可能清楚起见，这一行可以用来调用具有显式名称的函数。当你别无选择的时候，尽量限制自己最多两级缩进，以免影响代码的可读性。</p><p id="1ef6" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">此外，Python允许在一行中进行循环，这有助于提高清晰度。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi of"><img src="../Images/c14e9860a6b7f038aecd027ed58dcd68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*diqTvEsqQ7DJU2Nlq7dPrw.png"/></div></div></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="5269" class="mz na iq bd nb nc ny ne nf ng nz ni nj kf oa kg nl ki ob kj nn kl oc km np nq bi translated"><strong class="ak"> 5。错误处理</strong></h1><p id="03c7" class="pw-post-body-paragraph ko kp iq kq b kr nr ka kt ku ns kd kw kx nt kz la lb nu ld le lf nv lh li lj ij bi translated">错误管理不是开发数据科学管道中最令人兴奋的部分，但却是必不可少的。它将帮助您监督管道的执行，并在出错时做出正确的决策。</p><p id="ffc0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">首先，一个好的反应是用try开始你的顶层脚本，除了，最后，因为它们定义了你的程序的执行范围。如果执行失败，它将在catch中恢复，因此您将能够根据错误的类型做出正确的决定。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi og"><img src="../Images/49c6040c159ca252a4e949e8da2cd2ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C4nDyH8tB7X6Y6L19GjxJA.png"/></div></div></figure><p id="fed1" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">另一个充分利用例外的方法是发展你自己的例外。</p><p id="6f97" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">假设您正在通过API检索数据。最有可能的是，您无法控制API返回给您的内容，这会影响您的程序的正确执行。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi oh"><img src="../Images/d6259ce4fbedd99af553f918d0eada71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yM7Hm6kduXIzMBg2Uom7aw.png"/></div></div></figure><p id="bed7" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">见:<a class="ae ly" href="https://jeffknupp.com/blog/2013/02/06/write-cleaner-python-use-exceptions/" rel="noopener ugc nofollow" target="_blank">https://jeffknupp . com/blog/2013/02/06/write-cleaner-python-use-exceptions/</a></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="1a06" class="mz na iq bd nb nc ny ne nf ng nz ni nj kf oa kg nl ki ob kj nn kl oc km np nq bi translated">6.<strong class="ak">使用记录器，不打印</strong></h1><p id="4873" class="pw-post-body-paragraph ko kp iq kq b kr nr ka kt ku ns kd kw kx nt kz la lb nu ld le lf nv lh li lj ij bi translated">打印有利于调试和测试，但是当涉及到将代码投入生产时，日志记录器更合适。</p><p id="6437" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">印刷品的格式更复杂，可读性更差，最重要的是包含的信息很少。另一方面，记录器包含更多的信息，被直接格式化，并且具有一定的信息级别，可以识别信息的重要性(信息、警告、错误等)。).</p><p id="fcb1" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">在下图中，您可以看到培训脚本的执行显示。关于登录Python的更多细节，请参见https://docs.python.org/3/howto/logging.html<a class="ae ly" href="https://docs.python.org/3/howto/logging.html" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi oi"><img src="../Images/08cf076dca63804c412fcc61f86cb300.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GSUH0_LkxwpxkGJOZVXmtQ.png"/></div></div></figure><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi oj"><img src="../Images/b9cbf599036d84c94525b2210b70798d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nOPHoOUqkG3WKeSaLm56tQ.png"/></div></div></figure></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="e80a" class="mz na iq bd nb nc ny ne nf ng nz ni nj kf oa kg nl ki ob kj nn kl oc km np nq bi translated">7.<strong class="ak">文档字符串</strong></h1><p id="9220" class="pw-post-body-paragraph ko kp iq kq b kr nr ka kt ku ns kd kw kx nt kz la lb nu ld le lf nv lh li lj ij bi translated">Docstring是Python中必不可少的元素。它必须出现在任何语句声明中(函数、类或方法定义)。它们使代码更加清晰，并作为对象的文档。</p><p id="8a3e" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">一个通用的约定提供了所有的可维护性、清晰性、一致性，也是良好编程习惯的基础。它没有做的是坚持让你违背自己的意愿去跟随它。那是Python！”</p><p id="22f1" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><em class="ma"> —蒂姆·彼得斯论比较语言. python，2001年6月16日</em></p><p id="c692" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">有两种类型的文档字符串，单行文档字符串和多行文档字符串。</p><p id="e4ad" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">单行docstring </strong>用于最明显的情况，它们适合单行。描述简明扼要，并提供了函数名称所提供的附加信息。正如Python文档中所述:</p><ul class=""><li id="29ac" class="lk ll iq kq b kr ks ku kv kx lm lb ln lf lo lj lp lq lr ls bi translated">即使字符串在一行中，也要使用三重引号。这使得以后扩展它变得容易。</li><li id="f65d" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lp lq lr ls bi translated">结束引号和开始引号在同一行。这看起来更适合一行程序。</li><li id="ee2e" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lp lq lr ls bi translated">docstring前后都没有空行。</li><li id="a779" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lp lq lr ls bi translated">文档字符串是以句点结尾的短语。它将函数或方法的效果规定为命令(“Do this”、“Return that”)，而不是描述；例如，不要写“返回路径名…”。</li><li id="2a43" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lp lq lr ls bi translated">单行docstring不应该是重复函数/方法参数的“签名”(可以通过内省获得)。</li></ul><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi ok"><img src="../Images/dd0a3e4df2fe32d8fba9c1ba626754b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RdsWMzWGvmG6qQ-Ae7lAZw.png"/></div></div></figure><p id="c5db" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">多行文档字符串用于更复杂的情况。描述更加详细，后面还有一个空行。重要的是，它应该在一行中，并通过一个空行与docstring的其余部分分隔开。摘要行可以与起始引号在同一行，也可以在下一行。整个文档字符串的缩进与其第一行的引号相同(参见下面的示例)。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi of"><img src="../Images/bf06c7834c471c844d20d7cbef055086.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rVITV_lJUKulus2As3cUJg.png"/></div></div></figure><p id="53b7" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">参见:【https://www.python.org/dev/peps/pep-0257/#abstract】T2</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="3e13" class="mz na iq bd nb nc ny ne nf ng nz ni nj kf oa kg nl ki ob kj nn kl oc km np nq bi translated">8.单元测试</h1><p id="c3b0" class="pw-post-body-paragraph ko kp iq kq b kr nr ka kt ku ns kd kw kx nt kz la lb nu ld le lf nv lh li lj ij bi translated">Python测试是一个非常广泛的话题，并且可能非常复杂，但是它们对于使您的python代码更干净和更健壮是必不可少的。</p><p id="eeb0" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><em class="ma">“在计算机程序设计中，</em> <strong class="kq ja"> <em class="ma">单元测试</em> </strong> <em class="ma">是一种软件测试方法，通过这种方法对单个源代码单元、一组或多组计算机程序模块以及相关的控制数据、使用程序和操作程序进行测试，以确定它们是否适合使用”。</em>科拉瓦、亚当、胡伊津加、多洛塔(2007年)。<a class="ae ly" href="http://www.wiley.com/WileyCDA/WileyTitle/productCd-0470042125.html" rel="noopener ugc nofollow" target="_blank"> <em class="ma">自动化缺陷预防:软件管理中的最佳实践</em> </a>。威利-IEEE计算机学会出版社。第75页。</p><p id="13c5" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">有效测试的一个好技巧是使用TDD三定律和F.I.RS.T原则(适用于Python和其他编程语言)。</p><p id="620a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja">TDD三定律:</strong></p><ol class=""><li id="4368" class="lk ll iq kq b kr ks ku kv kx lm lb ln lf lo lj lz lq lr ls bi translated">在你写完一个失败的单元测试之前，你不能写任何产品代码。</li><li id="bed8" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated">你不能写超过足以失败的单元测试，不编译就是失败。</li><li id="5dd7" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated">您不能编写比足以通过当前失败的单元测试更多的产品代码。</li></ol><p id="7491" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated"><strong class="kq ja"> F.I.R.S.T </strong></p><ol class=""><li id="9621" class="lk ll iq kq b kr ks ku kv kx lm lb ln lf lo lj lz lq lr ls bi translated">快速:测试应该快速运行，因为你必须经常测试它们。否则，你就不能充分发挥它们的潜力，因为它们会浪费你的时间。</li><li id="ddf4" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated"><strong class="kq ja">独立:</strong>测试不应该相互依赖，它们不应该为下一次测试设置条件。您应该能够按照您想要的顺序运行它们。</li><li id="b0f8" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated">可重复:测试必须能够在任何环境下运行，无论是生产阶段还是原型开发阶段，无论是在任何机器上。因此，使用的环境不会影响测试的成功。</li><li id="f94c" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated"><strong class="kq ja">自我验证:</strong>测试的输出应该是布尔值。要么考上了，要么没考上但是没有中介。否则，通过测试就变得主观了。</li><li id="9abf" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated"><strong class="kq ja">及时:</strong>单元测试必须在正确的时间开发，即在测试阶段，而不是在产品中。</li></ol><p id="b590" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">参见:【https://docs.python.org/3/library/unittest.html<a class="ae ly" href="https://docs.python.org/3/library/unittest.html" rel="noopener ugc nofollow" target="_blank"/></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="de8e" class="mz na iq bd nb nc ny ne nf ng nz ni nj kf oa kg nl ki ob kj nn kl oc km np nq bi translated">9.<strong class="ak">评论</strong></h1><p id="52aa" class="pw-post-body-paragraph ko kp iq kq b kr nr ka kt ku ns kd kw kx nt kz la lb nu ld le lf nv lh li lj ij bi translated">如果使用得当，Python注释非常有用，但是如果使用不当，它可能会成为混乱和信息过剩的主要来源。当我们开发的代码不够清晰时，我们使用它们，这是正常的，因为并不总是能够清楚地解释我们的代码做什么。</p><p id="758d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">有几种类型的<strong class="kq ja">好的</strong>评论:</p><ol class=""><li id="7eec" class="lk ll iq kq b kr ks ku kv kx lm lb ln lf lo lj lz lq lr ls bi translated"><strong class="kq ja">法律意见</strong>:版权、许可等…</li><li id="e8b8" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated"><strong class="kq ja">信息性注释</strong>:当您需要指定正在解析的日期的格式时。</li><li id="d1b9" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated"><strong class="kq ja">意图解释</strong>:缩进往往反映了一种复杂的逻辑，它可以用来简要解释他们在做什么。</li><li id="c831" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated">澄清:你的代码很难理解。阐明返回的参数或变量的用法有时很有用。</li><li id="fe13" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated"><strong class="kq ja">后果警告</strong>:执行某些代码块可能会产生重要后果。注释可以用来提醒另一个代码用户。</li><li id="71f8" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated">放大:它们可以用来放大可能被忽视的代码的重要性。</li></ol><p id="8004" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">但也有几种类型的恶评:</p><ol class=""><li id="04c8" class="lk ll iq kq b kr ks ku kv kx lm lb ln lf lo lj lz lq lr ls bi translated"><strong class="kq ja">不明确</strong>:当你懒于写好，评论没有提供明确的信息。</li><li id="69b3" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated"><strong class="kq ja">多余</strong>:当你重复docstring中或者之前注释中说过的话。</li><li id="8b29" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated"><strong class="kq ja">噪音信息</strong>:不必事事评论，否则说明你的代码不清楚。</li><li id="0b61" class="lk ll iq kq b kr lt ku lu kx lv lb lw lf lx lj lz lq lr ls bi translated"><strong class="kq ja">注释掉的代码:</strong>删除旧的不用的代码比注释掉好。</li></ol></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="fdbd" class="mz na iq bd nb nc ny ne nf ng nz ni nj kf oa kg nl ki ob kj nn kl oc km np nq bi translated">10.<strong class="ak">重新格式化代码的工具</strong></h1><p id="6029" class="pw-post-body-paragraph ko kp iq kq b kr nr ka kt ku ns kd kw kx nt kz la lb nu ld le lf nv lh li lj ij bi translated">关于代码的格式，Python的结构要求我们非常仔细，以便正确地格式化我们的代码。实际上，要跳过的行数根据代码中声明的内容而有所不同(我们是声明一个类、一个方法还是一个变量？).</p><p id="a283" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">列表不要太长，否则，你必须回到那一行，行的长度、空间规则等等也是如此……总之，有很多规则要遵循，用手一丝不苟地遵循它们太长了(见<a class="ae ly" href="https://www.python.org/dev/peps/pep-0008/" rel="noopener ugc nofollow" target="_blank">https://www.python.org/dev/peps/pep-0008/</a>)。</p><p id="bd03" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">幸运的是，一些库会自动格式化你的代码，节省的时间是相当可观的。最著名的库是Black和Yapf，我强烈推荐它们。它们很容易集成到像PyCharm这样的IDE中，结果非常好。</p><p id="5ac9" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">此外，一个好的IDE可以指出主要的风格错误，并提出修改建议。就我而言，我使用PyCharm，其纠错系统非常高效。</p><p id="a319" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">下面的代码向您展示了如何将格式糟糕的难看代码转换成格式良好的难看代码。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi ol"><img src="../Images/44788b0f3cce716db6d49ebc0d6320ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qZC1U1w-GQ9vJtN6QmnbTg.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">以前</p></figure><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi om"><img src="../Images/6598878dbbcecb8358e217de1ce50881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cW7sK_OU1E1Qa8PWBK5-1w.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">在布莱克和皮查姆之后</p></figure><p id="479a" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">参见:<a class="ae ly" href="https://opensource.com/article/18/7/7-python-libraries-more-maintainable-code" rel="noopener ugc nofollow" target="_blank">https://open source . com/article/18/7/7-python-libraries-more-maintable-code</a></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><h1 id="bb05" class="mz na iq bd nb nc ny ne nf ng nz ni nj kf oa kg nl ki ob kj nn kl oc km np nq bi translated">结论</h1><p id="f4ee" class="pw-post-body-paragraph ko kp iq kq b kr nr ka kt ku ns kd kw kx nt kz la lb nu ld le lf nv lh li lj ij bi translated">我希望您会对这篇文章感兴趣，并且它会为您提供一些改进Python代码的线索。</p><p id="6d3d" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">我还推荐你看看这个GitHub资源库，它包括了本文中提到的概念和其他代码示例:【https://github.com/davified/clean-code-ml<a class="ae ly" href="https://github.com/davified/clean-code-ml" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="ba44" class="pw-post-body-paragraph ko kp iq kq b kr ks ka kt ku kv kd kw kx ky kz la lb lc ld le lf lg lh li lj ij bi translated">如果您对本文中提到的技巧有任何意见，请随时对本文发表评论或通过电子邮件发送给我:<a class="ae ly" href="mailto:matthieu@modeo.ai" rel="noopener ugc nofollow" target="_blank"> matthieu@modeo.ai </a>。</p></div></div>    
</body>
</html>