<html>
<head>
<title>Understanding the Coronavirus Epidemic Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解冠状病毒流行数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-the-coronavirus-epidemic-data-44d2fb356ecb?source=collection_archive---------12-----------------------#2020-02-15">https://towardsdatascience.com/understanding-the-coronavirus-epidemic-data-44d2fb356ecb?source=collection_archive---------12-----------------------#2020-02-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0eff" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用于分析当前冠状病毒爆发的 Python 工具箱</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/ddfc9b98c21f6b942c2aac574ed70e67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0WdEWywHmyWg8ZCckV3HZQ.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk">Graphical Illustration from <a class="ae ku" href="https://t.qianzhan.com/caijing/detail/200122-b2c202ef.html" rel="noopener ugc nofollow" target="_blank">前瞻网</a></p></figure><p id="ca92" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">新型冠状病毒(之前命名为 2019-nCov，后来改为 COVID-1⁹)目前正在席卷中国。截至 202⁰时间 2 月 13 日，它引发了一场全球卫生紧急事件，并夺走了 1000 多人的生命。世界各地的人们不断受到新闻、谣言、困惑和恐慌的轰炸。</p><p id="62ec" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">为了帮助人们更好地评估形势，并促进理性反应，流行病数据必须便于公众获取。很多网站一直在实时发布一些疫情数字。比如<a class="ae ku" href="https://ncov.dxy.cn/ncovh5/view/pneumonia" rel="noopener ugc nofollow" target="_blank">丁香元</a>、<a class="ae ku" href="https://gisanddata.maps.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6" rel="noopener ugc nofollow" target="_blank">约翰霍普金斯 CSSE </a>、<a class="ae ku" href="https://www.mapbox.cn/coronavirusmap/" rel="noopener ugc nofollow" target="_blank"> Mapbox </a>等。这些网站向公众提供及时的信息，但它们不能提供足够的数据进行分析。例如，使用上述网站回答以下任何一个简单的问题都非常困难或者几乎不可能:</p><p id="5b56" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Q1。湖北省过去 7 天的确诊病例数是多少？</p><p id="c766" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Q2。广东省和浙江省的每日新增确诊病例相比如何？</p><p id="248a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Q3。截至 2020 年 2 月 13 日，死亡人数最多的前 5 个城市是哪几个？</p><p id="9a05" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">(还有更多……)</p><p id="b9dd" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">为了能够分析数据，需要一个更方便的数据集。<a class="ae ku" href="https://github.com/BlankerL/DXY-2019-nCoV-Data" rel="noopener ugc nofollow" target="_blank">DXY-2019-nCoV-Data</a>GitHub 项目每天多次从<a class="ae ku" href="https://ncov.dxy.cn/ncovh5/view/pneumonia" rel="noopener ugc nofollow" target="_blank">丁象元</a>抓取实时疫情报告，并保存为 CSV 文件。但是这个 CSV 文件只包含网站数据的快照。由于报告时间的随机性和不断变化的报告格式，不容易用于分析。</p><p id="7f66" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">因此，这个项目<a class="ae ku" href="https://github.com/jianxu305/nCov2019_analysis" rel="noopener ugc nofollow" target="_blank"><strong class="kx iu">ncov 2019 _ analysis</strong></a><strong class="kx iu">⁴</strong>是在 GitHub 中创建的。其主要目的如下:</p><ul class=""><li id="f94b" class="lr ls it kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">执行关键数据清理</li><li id="0eb4" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">提供了一个方便的结构化数据供用户探索和贡献</li><li id="d30b" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">使用此工具箱分析冠状病毒流行的某些方面</li></ul><p id="93a0" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这个 GitHub 项目包含一个<a class="ae ku" href="https://github.com/jianxu305/nCov2019_analysis/blob/master/src/coronavirus_demo_colab.ipynb" rel="noopener ugc nofollow" target="_blank"> Python 笔记本</a>来说明基本用法。为了方便读者，笔记本在 Google Colab 中。以下是该软件包的演示。</p><h1 id="c42b" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">1.获取原始数据</h1><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="0b45" class="nc mg it my b gy nd ne l nf ng">import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import utils <strong class="my iu"> </strong> <em class="nh"># functions to process the coronavirus data</em></span><span id="89e0" class="nc mg it my b gy ni ne l nf ng">data = utils.load_chinese_data()  #load the raw CSV data</span></pre><p id="d590" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">这个加载函数显示数据集的一些基本信息。</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="9b6c" class="nc mg it my b gy nd ne l nf ng">Last update:  2020-02-14 13:02:25.736000<br/>Data date range:  2020-01-24 to 2020-02-14<br/>Number of rows in raw data:  38164</span></pre><p id="7f17" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">原始 CSV 数据如下所示:</p><h1 id="6654" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">2.数据处理</h1><p id="f0b4" class="pw-post-body-paragraph kv kw it kx b ky nj ju la lb nk jx ld le nl lg lh li nm lk ll lm nn lo lp lq im bi translated">该步骤调用一个函数<em class="nh"> utils.aggDaily() </em>，该函数运行多个步骤:</p><ul class=""><li id="e41e" class="lr ls it kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">将原始 CSV 数据聚合到每日数据中。</li><li id="2819" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">由于不一致的报告方案、缺失的报告等，执行关键清理。</li><li id="15d1" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">每天新增确诊/治愈/死亡人数。</li><li id="eff9" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">为<em class="nh">省名</em>和<em class="nh">城市名</em>添加<em class="nh"> *_en </em>列，以便非中文用户可以轻松使用这些数据。</li></ul><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="8242" class="nc mg it my b gy nd ne l nf ng">daily_frm = utils.aggDaily(data)<br/>daily_frm.tail()</span></pre><p id="ec02" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">生成的“<em class="nh"> daily_frm </em>”是一个平面 Pandas 数据框，逻辑上按(update_date，province_name(_en)，city_name(_en)进行索引，因此用户可以轻松地以他们想要的任何方式对数据进行切片，或者导出到其他应用程序(如 Excel 或 Google Sheet)进行进一步分析。</p><p id="a684" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">有了这个数据集，这三个对那些流行网站来说很难的示例问题可以通过几行代码轻松回答。现在让我们重温这些问题:</p><p id="b988" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Q1。湖北省过去 7 天的确诊病例数是多少？</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="b371" class="nc mg it my b gy nd ne l nf ng">daily_frm[daily_frm['province_name_en'] == 'Hubei'].groupby('update_date').agg('sum')[-7:]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi no"><img src="../Images/3409139e530e646cba8bbe6eafaef416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nnL_Sz8QgZ3pT961mmqpGw.png"/></div></div></figure><p id="ee13" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Q2。广东省和浙江省的每日新增确诊病例相比如何？</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="6186" class="nc mg it my b gy nd ne l nf ng">frm1 = daily_frm[(daily_frm['province_name_en'] == 'Guangdong') | (daily_frm['province_name_en'] == 'Zhejiang')].copy()</span><span id="1135" class="nc mg it my b gy ni ne l nf ng">frm1['update_date'] = pd.to_datetime(frm1['update_date'])</span><span id="8c50" class="nc mg it my b gy ni ne l nf ng">frm2 = frm1.groupby(['update_date', 'province_name_en']).agg('sum')</span><span id="f807" class="nc mg it my b gy ni ne l nf ng">ax = frm2['new_confirmed'][:, 'Guangdog'].plot(figsize=(15,10), label='Guangdong', grid=True, marker='*')</span><span id="df35" class="nc mg it my b gy ni ne l nf ng">frm2['new_confirmed'][:, 'Zhejiang'].plot(ax=ax, label='Zhejiang', grid=True, title='New Confirmed Comparison', marker='o')</span><span id="6e52" class="nc mg it my b gy ni ne l nf ng">ax.legend(loc='upper right')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nt"><img src="../Images/456acebdab4bc0693528afb06a4e143a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s_lQBmUQTlxQxjQUlZHhQA.png"/></div></div></figure><p id="7586" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">Q3。截至 2020 年 2 月 13 日，死亡人数最多的前 5 个城市是哪几个？</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="7652" class="nc mg it my b gy nd ne l nf ng">daily_frm[(daily_frm['update_date'] == pd.to_datetime('2020-02-13'))].sort_values('cum_dead', ascending=False)[:5]</span></pre><p id="6e78" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">正如您所看到的，这个数据集非常灵活，可以轻松地回答许多其他方式难以解决的问题。</p><h1 id="86bd" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">3.绘图功能</h1><p id="0590" class="pw-post-body-paragraph kv kw it kx b ky nj ju la lb nk jx ld le nl lg lh li nm lk ll lm nn lo lp lq im bi translated">为了加快数据的分析，提供了两个方便的可视化绘图功能:</p><ul class=""><li id="5acd" class="lr ls it kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">时间序列图:<em class="nh">utils . ts plot _ conf _ dead _ cured()</em></li><li id="5eb7" class="lr ls it kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">横截面图:<em class="nh">utils . cross _ section _ bar()</em></li></ul><p id="d64a" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">例如，您可以通过以下命令绘制中国确诊、死亡和治愈病例的总数:</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="b039" class="nc mg it my b gy nd ne l nf ng">fig = utils.tsplot_conf_dead_cured(daily_frm, title= 'Total Confirmed, Dead, and Cured Counts')</span><span id="98db" class="nc mg it my b gy ni ne l nf ng">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nu"><img src="../Images/d7995883cd00d1df71aa7ce6d2fc15cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HfC8t7vQkKviit70rdW5VA.png"/></div></div></figure><p id="26ba" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">同样，用户可以使用特定城市/省份的数据来获得该地区的相同绘图。此外，可以提供一个可选参数<em class="nh"> logy </em>来控制 y 轴，这样用户可以更容易地看到数字是否呈指数增长。以下是武汉疫情中心同一地块的一个例子。</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="e5ff" class="nc mg it my b gy nd ne l nf ng">fig = utils.tsplot_conf_dead_cured(daily_frm[daily_frm['city_name_en'] == 'Wuhan'], <strong class="my iu">logy</strong>=False, title='Confirmed, Dead, and Cured Counts in Wuhan')</span><span id="7547" class="nc mg it my b gy ni ne l nf ng">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nv"><img src="../Images/61f9241f1320e6fcdca51da65d56ddca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2LZDJZHYjaWGVOgfdGpOg.png"/></div></div></figure><p id="468e" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">横截面图也很容易制作。以下是一个比较所有省份已确认数量的示例:</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="ffd8" class="nc mg it my b gy nd ne l nf ng">fig = utils.cross_sectional_bar(daily_frm, '2020-02-03', col='cum_confirmed', groupby='province_name_en', title='2020-02-03 Confirmed Count comparison among all provinces')</span><span id="0a90" class="nc mg it my b gy ni ne l nf ng">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nw"><img src="../Images/ff22b8f50695f77d3c01c50411db07c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a5wGU354UITXIiNVmVG7TA.png"/></div></div></figure><p id="dbc6" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">可以提供一个可选参数"<em class="nh"> largestN </em>"来只显示前 N 个条形。例如，下面比较了 2020 年 2 月 5 日最新确认数量最多的 10 个城市:</p><pre class="kj kk kl km gt mx my mz na aw nb bi"><span id="8f45" class="nc mg it my b gy nd ne l nf ng">fig = utils.cross_sectional_bar(daily_frm, '2020-02-05', col='new_confirmed', groupby='city_name_en', largestN=10, title='Top 10 cities with the most new confirmed counts on 2020-02-05' )</span><span id="8383" class="nc mg it my b gy ni ne l nf ng">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="np nq di nr bf ns"><div class="gh gi nx"><img src="../Images/e180e362a8966e2a4608727b771f70a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L54hfd1fjm-9bMk-MJrF4g.png"/></div></div></figure><h1 id="b654" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">最后的话</h1><p id="c0c4" class="pw-post-body-paragraph kv kw it kx b ky nj ju la lb nk jx ld le nl lg lh li nm lk ll lm nn lo lp lq im bi translated">以上是工具箱的一些基本用法。我希望它能为你更好地了解最近的冠状病毒疫情提供方便和帮助。</p><p id="6643" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">在<a class="ae ku" rel="noopener" target="_blank" href="/behind-the-coronavirus-mortality-rate-4501ef3c0724">下一篇文章</a>中，我将使用这个工具箱来分析死亡率。你会看到并不是广为流传的 2%那么简单。</p><h1 id="fbff" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">承认</h1><p id="d273" class="pw-post-body-paragraph kv kw it kx b ky nj ju la lb nk jx ld le nl lg lh li nm lk ll lm nn lo lp lq im bi translated">我要感谢我的朋友 David Tian，他是一名机器学习工程师，对 Google Colab 的设置提供了慷慨的帮助，并对本文提出了宝贵的建议。看看他有趣的自驾* <a class="ae ku" rel="noopener" target="_blank" href="/deeppicar-part-1-102e03c83f2c"> DeepPiCar </a> *博客。</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><p id="99f3" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated"><strong class="kx iu">更新(2020 年 3 月 2 日)</strong></p><p id="4b50" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">来自约翰霍普金斯大学的国际数据已经被添加到我的 GitHub 项目中。这些数据不如中国的丁香园数据统一，因为许多国家没有省级报告，也根本没有市级数据。此外，在国家之间运送病人需要在数据处理方面格外小心。所以为了方便分析，做了一些数据清理。</p></div><div class="ab cl ny nz hx oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="im in io ip iq"><p id="3f4c" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">参考:</p><p id="0d09" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">[1]2020 年 2 月 11 日，世卫组织决定将该疾病命名为新冠肺炎:<a class="ae ku" href="https://www.who.int/dg/speeches/detail/who-director-general-s-remarks-at-the-media-briefing-on-2019-ncov-on-11-february-2020" rel="noopener ugc nofollow" target="_blank">https://www . who . int/DG/speechs/detail/who-总干事-s-remarks-at-the-media-briefing-On-2019-ncov-On-11-2020 年 2 月</a></p><p id="da37" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">[2]2020 年 1 月 30 日，世卫组织宣布进入国际卫生紧急状态:<a class="ae ku" href="https://www.who.int/news-room/detail/30-01-2020-statement-on-the-second-meeting-of-the-international-health-regulations-(2005)-emergency-committee-regarding-the-outbreak-of-novel-coronavirus-(2019-ncov)" rel="noopener ugc nofollow" target="_blank">https://www . who . int/news-room/detail/30-01-2020-statement-On-the-second-meeting-of-the-international-health-regulations-(2005)-emergency-Committee-about-the-outbreak-of-novel-coronavirus-(2019-ncov)</a></p><p id="b1e4" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">[3]2 月 13 日，中国冠状病毒死亡人数超过 1000 人:<a class="ae ku" href="https://globalnews.ca/news/6533678/china-coronavirus-death-toll-who/" rel="noopener ugc nofollow" target="_blank">https://global news . ca/news/6533678/China-coronavirus-death-toll-who/</a></p><p id="d226" class="pw-post-body-paragraph kv kw it kx b ky kz ju la lb lc jx ld le lf lg lh li lj lk ll lm ln lo lp lq im bi translated">[4]代码的 GitHub 链接:<a class="ae ku" href="https://github.com/jianxu305/nCov2019_analysis" rel="noopener ugc nofollow" target="_blank">https://github.com/jianxu305/nCov2019_analysis</a></p></div></div>    
</body>
</html>