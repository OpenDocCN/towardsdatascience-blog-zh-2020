<html>
<head>
<title>How to join tables using SQL to combine datasets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用SQL连接表以组合数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/combining-tables-using-sql-f6ddfd5f8b6f?source=collection_archive---------0-----------------------#2020-05-17">https://towardsdatascience.com/combining-tables-using-sql-f6ddfd5f8b6f?source=collection_archive---------0-----------------------#2020-05-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="38e7" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/ldswsd" rel="noopener" target="_blank">在保持社交距离的同时学习数据科学</a></h2><div class=""/><div class=""><h2 id="ae6b" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用SQL关键字UNION、UNION ALL、INNER JOIN、LEFT OUTER JOIN和RIGHT OUTER JOIN找出澳大利亚哪里的喜鹊最危险</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/3490fc2d37e0d3d7bffd1414cd989a60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ub_7b1bzxcI_PSjH"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@drazgoosh?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">大流士K </a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="ee8a" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">介绍</h1><p id="ef10" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">在过去的4周里，我和我的朋友们在保持社交距离的同时互相帮助学习新技能。我们正在以在线学习小组的形式学习数据科学。我们几乎完成了SQL部分。我为每个人的努力和他们尝试新事物的意愿感到骄傲。</p><p id="1a18" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在过去的几周里，我的父母甚至决定尝试一下我的课程。他们只有几周的时间来补上，所以听听他们的想法会很有趣。</p><h1 id="66ac" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">前一课</h1><p id="c427" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">上周，我们利用辣妹组合发行的三张专辑的数据来判断哪张专辑是最好的。我们使用GROUP BY关键字这样做，以便我们可以聚合每个专辑的统计数据。</p><h1 id="1614" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">这一课</h1><p id="7cae" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">现在我们知道了如何分组和聚合表中的数据，本周我们将学习如何将表连接在一起。</p><p id="bcc7" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">能够组合数据集是有帮助的。尤其是如果每个表中有不同的细节。通过将它们连接在一起，你可以进行一些计算。或者，您可以创建一个新表，在一个数据集中包含所有不同的详细信息。</p><p id="9d9d" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">为了合并表，我们将使用UNION、UNION ALL、INNER JOIN、LEFT OUTER JOIN和RIGHT OUTER JOIN关键字。</p><h2 id="fd53" class="nb lj it bd lk nc nd dn lo ne nf dp ls mj ng nh lu mn ni nj lw mr nk nl ly iz bi translated">主要学习内容</h2><ul class=""><li id="4d32" class="nm nn it mc b md me mg mh mj no mn np mr nq mv nr ns nt nu bi translated">使用关键字UNION堆叠没有重复值的数据集</li><li id="d8e3" class="nm nn it mc b md nv mg nw mj nx mn ny mr nz mv nr ns nt nu bi translated">使用关键字UNION ALL来堆叠具有重复值的数据集</li><li id="6274" class="nm nn it mc b md nv mg nw mj nx mn ny mr nz mv nr ns nt nu bi translated">使用关键字INNER JOIN将两个表连接在一起，只获得重叠的值</li><li id="87bb" class="nm nn it mc b md nv mg nw mj nx mn ny mr nz mv nr ns nt nu bi translated">使用关键字LEFT OUTER JOIN将两个表连接在一起，并且不会丢失左表中的任何数据，即使那些记录在右表中没有匹配项</li><li id="f8d7" class="nm nn it mc b md nv mg nw mj nx mn ny mr nz mv nr ns nt nu bi translated">使用关键字RIGHT OUTER JOIN将两个表连接在一起，并且不会丢失右表中的任何数据，即使是那些在左表中没有匹配项的记录</li><li id="fa02" class="nm nn it mc b md nv mg nw mj nx mn ny mr nz mv nr ns nt nu bi translated">理解UNION和UNION ALL关键字的区别</li><li id="0c1c" class="nm nn it mc b md nv mg nw mj nx mn ny mr nz mv nr ns nt nu bi translated">理解内部连接、左外部连接和右外部连接之间的区别。</li></ul><h1 id="a508" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">问题是</h1><p id="9500" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">每个人都知道澳大利亚充满了危险的动物。然而，一种鲜为人知的食肉动物是喜鹊。这种鸟猛扑向毫无防备的受害者，锋利的喙装备精良，可以挖出一只眼睛。我们想知道澳大利亚各州喜鹊攻击事件有多普遍。哪里要戴防护帽？😜</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oa"><img src="../Images/71a7e2f32aa508af0a0443c44d445fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9DqKQYzhVwHO73A8"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">弗兰克·布施在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="c099" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">数据</h1><p id="7b23" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">为了解决我们的问题，我们有几个数据表。</p><p id="6090" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">首先是一个表格，根据网站<a class="ae lh" href="https://www.magpiealert.com/Swooping-Magpie-Attack-Statistics-2019" rel="noopener ugc nofollow" target="_blank">喜鹊警报</a>，包含了澳大利亚各州报告的喜鹊攻击数量。需要注意的是，这个网站的数据是众包的。当人们被喜鹊袭击时，他们会自我报告。因此，根据网站最受欢迎的地方，可能会有一些偏差。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/5abe0323d723abe94b71927c53cfb305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*81oeKe-SQCn2kyMXyjLXYQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">喜鹊攻击表</p></figure><p id="dc52" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我们的第二组数据是dropbear攻击的表格。北极熊是另一种凶猛的澳大利亚动物。我们可以将此表与喜鹊攻击数据进行比较。</p><p id="9dec" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">免责声明:</strong> dropbears不是真的，所以数据是我编造的😃</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/01d2b4d386117ac7e75ab42194a2e11e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pagyIK4eCOAgL4-cf-KNCg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">Dropbear攻击表</p></figure><p id="4fbf" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">除了关于动物袭击的两个表格，我们还有我从维基百科<a class="ae lh" href="https://en.wikipedia.org/wiki/States_and_territories_of_Australia" rel="noopener ugc nofollow" target="_blank">获得的澳大利亚各州的数据。我们可以使用这个表来标准化我们的动物攻击表，以反映各州之间的人口或地区差异。</a></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/3ef97e6200e802db7ecb18d2fee1087a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eDNHXMwWJ0B8ksPn-i3E9g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">澳大利亚州和地区表</p></figure><h1 id="2534" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">组合表格的语法</h1><p id="8fca" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">将两个表组合在一起的最简单的方法是使用关键字UNION或UNION ALL。这两种方法将一批选定的数据堆积在另一批数据之上。</p><pre class="ks kt ku kv gt oe of og oh aw oi bi"><span id="0232" class="nb lj it of b gy oj ok l ol om">    SELECT <br/>        name_column_one, <br/>        name_column_three<br/>    FROM<br/>        name_of_table_one<br/>UNION<br/>    SELECT<br/>        name_column_one, <br/>        name_column_three<br/>    FROM<br/>        name_of_table_two<br/>;</span></pre><p id="ccaf" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">这两个关键字之间的区别在于UNION只接受不同的值，而UNION ALL则保留所有选中的值。两者使用相同的语法。</p><pre class="ks kt ku kv gt oe of og oh aw oi bi"><span id="d26c" class="nb lj it of b gy oj ok l ol om">    SELECT <br/>        name_column_one, <br/>        name_column_three<br/>    FROM<br/>        name_of_table_one<br/>UNION ALL<br/>    SELECT<br/>        name_column_one, <br/>        name_column_three<br/>    FROM<br/>        name_of_table_two<br/>;</span></pre><h2 id="c182" class="nb lj it bd lk nc nd dn lo ne nf dp ls mj ng nh lu mn ni nj lw mr nk nl ly iz bi translated">如果您想根据匹配值合并表，该怎么办？</h2><p id="b699" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">有几种不同的方法可以根据值匹配来组合表。它们包括内部连接、完全外部连接、左外部连接和右外部连接。</p><p id="f3a3" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在不同版本的SQL语言中，可用的连接略有不同。我们一直在学习MySQL。因此，我们将只关注MySQL中可用的连接。在MySQL中可以使用内连接、左外连接和右外连接，但不能使用全外连接。</p><p id="1158" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">如果你想学习如何做一个完整的外连接，我的另一篇关于SQL 中的内连接和外连接的<a class="ae lh" rel="noopener" target="_blank" href="/what-is-the-difference-between-an-inner-and-an-outer-join-in-sql-5b5ec8277377">区别的文章中有介绍。</a></p><h2 id="59c3" class="nb lj it bd lk nc nd dn lo ne nf dp ls mj ng nh lu mn ni nj lw mr nk nl ly iz bi translated">如果您只想要两个表都包含匹配值的数据，该怎么办？</h2><p id="e85f" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">如果要执行的联接只包含两个表在指定列中包含匹配值的数据，则可以使用内部联接。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/2445b38bdbae51410a793be3161fcaad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IDuDlq5_OtBHIYoQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">内部连接图:内部连接的结果将只包含Table_1和Table_2重叠的黄色部分</p></figure><p id="dde9" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">内部联接只返回两个数据集重叠的部分。这样，只有在两个表中要连接的列中有匹配值时，才会返回记录。内部联接的语法如下所示:</p><pre class="ks kt ku kv gt oe of og oh aw oi bi"><span id="c09c" class="nb lj it of b gy oj ok l ol om">SELECT *<br/>FROM<br/>    name_of_table_one<br/>INNER JOIN<br/>    name_of_table_two<br/>ON<br/>    name_of_table_one.name_column_one = name_of_table_two.name_column_one</span></pre><p id="0ebb" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在上面的示例中，表一和表二的记录都将被返回，但前提是表一第一列中的值与表二第一列中的值匹配。内部联接不会返回任何没有匹配值的记录。</p><p id="03b5" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">我们在前面的课程中没有遇到的连接语法的一部分是通过表名和列名来引用列。这在连接表时很重要，因为两个表可能有同名的列。如果在选择同名列时不包括表名，程序将不会知道您引用的是哪一个。</p><p id="8f15" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">为了避免混淆，我们使用由句号分隔的表名和列名来为每一列创建唯一的标识符。</p><h2 id="ddf1" class="nb lj it bd lk nc nd dn lo ne nf dp ls mj ng nh lu mn ni nj lw mr nk nl ly iz bi translated">如果您想连接一个匹配值，但只想保留左侧表中的所有数据，并且只保留右侧表中匹配的记录，该怎么办？</h2><p id="27bf" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">要基于列匹配连接两个表而不丢失左表中的任何数据，可以使用左外连接。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/d1be6340ddf3561fce949893f299b93f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*85ECPmY9WrXM8Le3.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">左外部连接图:左外部连接的结果将包含Table_1和Table_2重叠的黄色部分，以及包含Table_1其余部分的黄色部分</p></figure><p id="415c" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">当您希望从一个表中获取所有值，但只从右表中获取与左表匹配的记录时，可以使用左外连接。</p><pre class="ks kt ku kv gt oe of og oh aw oi bi"><span id="f702" class="nb lj it of b gy oj ok l ol om">SELECT *<br/>FROM<br/>    name_of_table_one<br/>LEFT OUTER JOIN<br/>    name_of_table_two<br/>ON<br/>    name_of_table_one.name_column_one = name_of_table_two.name_column_one</span></pre><p id="c69a" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">在上面左侧的外部连接示例中，将返回表一中的所有行，以及表二和表一中基于每个表中的列一共有的行。</p><h2 id="36d1" class="nb lj it bd lk nc nd dn lo ne nf dp ls mj ng nh lu mn ni nj lw mr nk nl ly iz bi translated">左外连接和右外连接有什么区别？</h2><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi on"><img src="../Images/8e61eb78903ba76c343fe9791db05a42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*m_avyMYRNmWvtG5s.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">右外连接图:右外连接的结果将包含Table_1和Table_2重叠的黄色部分，以及包含Table_2其余部分的黄色部分</p></figure><p id="58bc" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">右外连接的语法与左外连接的语法相同。两者之间唯一的区别是右边的表，在我们的示例表2中，将保留它的所有记录。而在左边的表中，表1将只保留其第一列和表2的第一列匹配的记录。</p><pre class="ks kt ku kv gt oe of og oh aw oi bi"><span id="fcfd" class="nb lj it of b gy oj ok l ol om">SELECT *<br/>FROM<br/>    name_of_table_one<br/>RIGHT OUTER JOIN<br/>    name_of_table_two<br/>ON<br/>    name_of_table_one.name_column_one = name_of_table_two.name_column_one</span></pre><h1 id="d0a4" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">现在让我们试一试</h1><ol class=""><li id="86e7" class="nm nn it mc b md me mg mh mj no mn np mr nq mv oo ns nt nu bi translated">前往<a class="ae lh" href="https://www.db-fiddle.com/" rel="noopener ugc nofollow" target="_blank">https://www.db-fiddle.com/</a></li><li id="cb0b" class="nm nn it mc b md nv mg nw mj nx mn ny mr nz mv oo ns nt nu bi translated">在左栏中，将CREATE TABLE和INSERT放入下面的查询中</li></ol><pre class="ks kt ku kv gt oe of og oh aw oi bi"><span id="b841" class="nb lj it of b gy oj ok l ol om">CREATE TABLE magpie_attacks(<br/>    state_code varchar(255),<br/>    state_name varchar(255),<br/>    animal varchar(255),<br/>    number_of_attacks int(255)<br/>);</span><span id="30e5" class="nb lj it of b gy op ok l ol om">INSERT INTO magpie_attacks(<br/>    state_code,<br/>    state_name,<br/>    animal,<br/>    number_of_attacks<br/>)<br/>VALUES<br/>    ('SA', 'South Australia', 'magpie', 154),<br/>    ('VIC', 'Victoria', 'magpie', 972),<br/>    ('TAS', 'Tasmania', 'magpie', 0),<br/>    ('NSW', 'New South Whales', 'magpie', 823),<br/>    ('QLD', 'Queensland', 'magpie', 1141),<br/>    ('WA', 'Western Australia', 'magpie', 287),<br/>    ('ACT', 'Australian Capital Territory', 'magpie', 668)</span><span id="9b1a" class="nb lj it of b gy op ok l ol om">;</span><span id="b7e0" class="nb lj it of b gy op ok l ol om">CREATE TABLE dropbear_attacks(<br/>    state_code varchar(255),<br/>    state_name varchar(255),<br/>    animal varchar(255),<br/>    number_of_attacks int(255)<br/>);</span><span id="1a0b" class="nb lj it of b gy op ok l ol om">INSERT INTO dropbear_attacks(<br/>    state_code,<br/>    state_name,<br/>    animal,<br/>    number_of_attacks<br/>)<br/>VALUES<br/>    ('SA', 'South Australia', 'dropbear', 21),<br/>    ('VIC', 'Victoria', 'dropbear', 67),<br/>    ('TAS', 'Tasmania', 'dropbear', 30),<br/>    ('NSW', 'New South Whales', 'dropbear', 19),<br/>    ('QLD', 'Queensland', 'dropbear', 40),<br/>    ('WA', 'Western Australia', 'dropbear', 37)<br/>;</span><span id="b3e2" class="nb lj it of b gy op ok l ol om">CREATE TABLE australian_states(<br/>    state_code varchar(255),<br/>    state_name varchar(255),<br/>    population int(255),<br/>    area_km2 int(255)<br/>);</span><span id="96e7" class="nb lj it of b gy op ok l ol om">INSERT INTO australian_states(<br/>    state_code,<br/>    state_name,<br/>    population,<br/>    area_km2<br/>)<br/>VALUES<br/>    ('SA', 'South Australia', 1751693, 1044353),<br/>    ('VIC', 'Victoria', 6594804, 237657),<br/>    ('TAS', 'Tasmania', 534281, 90758),<br/>    ('NSW', 'New South Whales', 8089526, 809952),<br/>    ('QLD', 'Queensland', 5095100, 1851736),<br/>    ('WA', 'Western Australia', 2621680, 2642753),<br/>    ('ACT', 'Australian Capital Territory', 426709, 2358),<br/>    ('NT', 'Northern Territory', 245869, 1419630)<br/>;</span></pre><p id="b29c" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">3.在右栏中输入您的查询，并使用左上角的“运行”按钮运行它们</p><p id="d606" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">4.运行下面的查询，看看它是否会返回您所期望的结果:</p><pre class="ks kt ku kv gt oe of og oh aw oi bi"><span id="94f5" class="nb lj it of b gy oj ok l ol om">    SELECT <br/>        * <br/>    FROM<br/>        magpie_attacks<br/>UNION<br/>    SELECT <br/>        *<br/>    FROM <br/>        dropbear_attacks<br/>;</span></pre><p id="e0a2" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">5.运行下面的查询，看看它是否会返回您所期望的结果:</p><pre class="ks kt ku kv gt oe of og oh aw oi bi"><span id="88d1" class="nb lj it of b gy oj ok l ol om">    SELECT <br/>        state_code, <br/>        state_name<br/>    FROM<br/>        magpie_attacks<br/>UNION<br/>    SELECT <br/>        state_code, <br/>        state_name<br/>    FROM <br/>        dropbear_attacks<br/>;</span></pre><p id="9e7f" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">6.运行下面的查询，并将结果与之前的查询进行比较:</p><pre class="ks kt ku kv gt oe of og oh aw oi bi"><span id="739f" class="nb lj it of b gy oj ok l ol om">    SELECT <br/>        state_code, <br/>        state_name<br/>    FROM<br/>        magpie_attacks<br/>UNION ALL<br/>    SELECT <br/>        state_code, <br/>        state_name<br/>    FROM <br/>        dropbear_attacks;</span></pre><p id="42f2" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">7.运行下面的查询，看看它是否会返回您所期望的结果:</p><pre class="ks kt ku kv gt oe of og oh aw oi bi"><span id="89d0" class="nb lj it of b gy oj ok l ol om">SELECT <br/>    magpie_attacks.state_code, <br/>    magpie_attacks.number_of_attacks AS magpie_attacks,<br/>    dropbear_attacks.number_of_attacks AS dropbear_attacks<br/>FROM<br/>    magpie_attacks<br/>INNER JOIN<br/>    dropbear_attacks<br/>ON<br/>    magpie_attacks.state_code = dropbear_attacks.state_code;</span></pre><p id="327c" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">8.运行以下查询，并将结果与之前的查询进行比较:</p><pre class="ks kt ku kv gt oe of og oh aw oi bi"><span id="c891" class="nb lj it of b gy oj ok l ol om">SELECT <br/>    magpie_attacks.state_code, <br/>    magpie_attacks.number_of_attacks AS magpie_attacks,<br/>    dropbear_attacks.number_of_attacks AS dropbear_attacks<br/>FROM<br/>    magpie_attacks<br/>LEFT OUTER JOIN<br/>    dropbear_attacks<br/>ON<br/>    magpie_attacks.state_code = dropbear_attacks.state_code;</span></pre><p id="2406" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">9.运行下面的查询，并将结果与前两个查询进行比较:</p><pre class="ks kt ku kv gt oe of og oh aw oi bi"><span id="21f5" class="nb lj it of b gy oj ok l ol om">SELECT <br/>    magpie_attacks.state_code, <br/>    magpie_attacks.number_of_attacks AS magpie_attacks,<br/>    dropbear_attacks.number_of_attacks AS dropbear_attacks<br/>FROM<br/>    magpie_attacks<br/>RIGHT OUTER JOIN<br/>    dropbear_attacks<br/>ON<br/>    magpie_attacks.state_code = dropbear_attacks.state_code;</span></pre><p id="979a" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">10.运行下面的查询，并将结果与前两个查询进行比较:</p><pre class="ks kt ku kv gt oe of og oh aw oi bi"><span id="03bc" class="nb lj it of b gy oj ok l ol om">SELECT <br/>    magpie_attacks.state_code, <br/>    magpie_attacks.number_of_attacks AS magpie_attacks,<br/>    dropbear_attacks.number_of_attacks AS dropbear_attacks,<br/>      dropbear_attacks.number_of_attacks / magpie_attacks.number_of_attacks * 100 AS 'dropbear_attacks_as_percentage_of_magpie_attacks'<br/>FROM<br/>    magpie_attacks<br/>INNER JOIN<br/>    dropbear_attacks<br/>ON<br/>    magpie_attacks.state_code = dropbear_attacks.state_code<br/>;</span></pre><p id="ebe1" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">练习1: </strong>使用我们在本课中学到的每一种不同的union和join方法，组合magpie_attacks表和australian_states表。为了运行查询，您可以根据需要随意选择任意多或任意少的列。</p><p id="42da" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated"><strong class="mc jd">练习2: </strong>写一个查询，找出澳大利亚哪个州的喜鹊攻击次数占该州人口的百分比最高。提示:如果需要，您可以使用步骤10中的查询作为参考。</p><h1 id="66f3" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">学习回顾</h1><p id="76f5" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">学完本课后，你应该知道:</p><ul class=""><li id="625f" class="nm nn it mc b md mw mg mx mj oq mn or mr os mv nr ns nt nu bi translated">如何使用关键字UNION来堆叠没有重复值的数据集</li><li id="f30a" class="nm nn it mc b md nv mg nw mj nx mn ny mr nz mv nr ns nt nu bi translated">如何使用关键字UNION ALL来堆叠具有重复值的数据集</li><li id="8510" class="nm nn it mc b md nv mg nw mj nx mn ny mr nz mv nr ns nt nu bi translated">如何使用关键字INNER JOIN将两个表连接在一起，并且只获得重叠的值</li><li id="7a00" class="nm nn it mc b md nv mg nw mj nx mn ny mr nz mv nr ns nt nu bi translated">如何使用关键字LEFT OUTER JOIN将两个表连接在一起，并且不丢失左表中与右表不匹配的任何数据</li><li id="9179" class="nm nn it mc b md nv mg nw mj nx mn ny mr nz mv nr ns nt nu bi translated">如何使用关键字RIGHT OUTER JOIN将两个表连接在一起，并且不会丢失右表中与左表不匹配的任何数据</li><li id="2e59" class="nm nn it mc b md nv mg nw mj nx mn ny mr nz mv nr ns nt nu bi translated">理解UNION和UNION ALL关键字的区别</li><li id="b97a" class="nm nn it mc b md nv mg nw mj nx mn ny mr nz mv nr ns nt nu bi translated">理解内部连接、左外部连接和右外部连接之间的区别。</li></ul><h1 id="3800" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">下一课</h1><p id="7669" class="pw-post-body-paragraph ma mb it mc b md me kd mf mg mh kg mi mj mk ml mm mn mo mp mq mr ms mt mu mv im bi translated">下一课将回顾我们在过去5课中学到的关于SQL的知识。我总是认为练习新技能来巩固课程是个好主意。希望复习课也能让我们以一种更独立的方式使用在课上学到的所有技能。到目前为止，这些练习与之前的例子非常相似。然而，我希望下节课我们将学到的部分内容是如何选择使用什么方法来解决问题。</p><p id="e86b" class="pw-post-body-paragraph ma mb it mc b md mw kd mf mg mx kg mi mj my ml mm mn mz mp mq mr na mt mu mv im bi translated">除了数据，我的另一个爱好是绘画。你可以在www.katemarielewis.com找到我的野生动物艺术</p><h1 id="b894" class="li lj it bd lk ll lm ln lo lp lq lr ls ki lt kj lu kl lv km lw ko lx kp ly lz bi translated">社交距离学习数据科学(LDSWSD)系列中的所有课程</h1><div class="ot ou gp gr ov ow"><a href="https://towardsdatascience.com/tagged/ldswsd" rel="noopener follow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd jd gy z fp pb fr fs pc fu fw jc bi translated">Ldswsd —走向数据科学</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">阅读《走向数据科学》中关于Ldswsd的文章。共享概念、想法和代码的媒体出版物。</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">towardsdatascience.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk lb ow"/></div></div></a></div></div></div>    
</body>
</html>