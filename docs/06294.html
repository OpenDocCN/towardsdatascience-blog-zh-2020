<html>
<head>
<title>Predicting the probability of SARS CoV-2 result using Multiple Logistic Regression in R and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 R 和 Python 中的多元逻辑回归预测 SARS CoV-2 结果的概率</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-the-probability-of-sars-cov-2-result-using-multiple-logistic-regressing-in-r-and-python-874cf9185d62?source=collection_archive---------33-----------------------#2020-05-20">https://towardsdatascience.com/predicting-the-probability-of-sars-cov-2-result-using-multiple-logistic-regressing-in-r-and-python-874cf9185d62?source=collection_archive---------33-----------------------#2020-05-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2f52" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">对 SARS 冠状病毒 2 型患者进行分类以及哪些变量会影响结果。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/17ab1259d1a67cc7b9c9862078a4aa95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XPBuKze0VjjgNp-AaLvS3g.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来源:<a class="ae kv" href="https://www.vexels.com/vectors/preview/191360/covid-19-background-design?ref=vexelsck&amp;tap_s=576618-2da5a0" rel="noopener ugc nofollow" target="_blank">维克斯</a></p></figure><p id="f026" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">编者注:</em> </strong> <em class="ls"> </em> <a class="ae kv" href="http://towardsdatascience.com/" rel="noopener" target="_blank"> <em class="ls">走向数据科学</em> </a> <em class="ls">是一份以研究数据科学和机器学习为主的中型刊物。我们不是健康专家或流行病学家，本文的观点不应被解释为专业建议。想了解更多关于疫情冠状病毒的信息，可以点击</em> <a class="ae kv" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports" rel="noopener ugc nofollow" target="_blank"> <em class="ls">这里</em> </a> <em class="ls">。</em></p><h2 id="0826" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated"><strong class="ak">简介</strong></h2><p id="e5a2" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">大约两个月前，巴西的以色列阿尔伯特·爱因斯坦医院发布了关于 Kaggle 的公开数据，以便更好地了解这种新型冠状病毒。因此，我试图使用这个数据集来预测患 SARS CoV-2 的概率，并检查哪些变量影响最具预测性的 SARS CoV-2 结果。</p><p id="d1a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">背景</strong></p><p id="793a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">截至 3 月 27 日，圣保罗州记录了 1223 例新冠肺炎确诊病例，68 例相关死亡，而拥有约 1200 万人口的圣保罗州，以及以色列阿尔伯特·爱因斯坦医院所在地，截至 3 月 23 日，有 477 例确诊病例和 30 例相关死亡。该州和圣保罗县都决定建立隔离和社会距离措施，这将至少持续到 4 月初，以减缓病毒的传播。</p><p id="0c71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">数据集</strong></p><p id="e9c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该数据集包含在巴西圣保罗的以色列阿尔伯特爱因斯坦医院就诊的患者的匿名数据，这些患者在就诊期间收集了样本以进行新型冠状病毒 RT-PCR 和其他实验室测试。</p><p id="23a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据集总共有 5644 行和 111 列。</p><p id="f6fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">分析中使用的变量(预测值)</strong></p><p id="a856" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这篇文章不足以解释所有使用的变量。因此，我将即时讨论一些重要的预测因素。</p><p id="3ff1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了准备数据，我使用了 Python 中的 Pandas。对于逻辑回归分析，我使用了 r。现在让我们跳到数据准备。</p><h2 id="fc2c" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated"><strong class="ak">数据准备</strong></h2><p id="d541" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">第一眼看数据集，我发现了许多<em class="ls"> NaN </em>值。在前进之前，必须纠正缺少值的问题。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/f28ddcef8cefad9f89e99df2c50b65ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ncjjx_lRUetyjL6LJ27G3g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">按降序排列的每一列的值计数</p></figure><p id="b990" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从这里开始，我将数据集分成两个子集，命名为条件和疾病。(它们只是名字，不代表任何东西)橙色标记的是疾病子集，绿色标记的是病情子集。</p><p id="dfda" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">变量<em class="ls">中性粒细胞</em>和<em class="ls">蛋白质 C reativa </em>中的缺失值必须进行估算。我已经使用 KNNImputer 来估算丢失的值。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="b8e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于这两个数据集，我们的目标变量是<em class="ls"> SARS_CoV2_exam_result。</em>数据集疾病具有所有分类预测值，数据集条件具有所有连续数值预测值。</p><p id="d99a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于分类变量，0 表示未检测到疾病，1 表示检测到疾病。</p><h2 id="7139" class="lt lu iq bd lv lw lx dn ly lz ma dp mb lf mc md me lj mf mg mh ln mi mj mk ml bi translated"><strong class="ak">分析</strong></h2><p id="d551" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">从这里开始，我将使用 R 进行分析。让我们从疾病数据集开始。</p><p id="3237" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">疾病数据集分析</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/68c099e748e3c4f0583d519ab17ed025.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xmCHg9ECGQ7iYNEgfROZjQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">疾病数据集摘要</p></figure><p id="a6ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我不得不跳过副流感 2 号，因为没有病例。现在，让我们绘制克拉姆夫相关图，以检查分类变量之间的相关性。</p><pre class="kg kh ki kj gt mv mw mx my aw mz bi"><span id="5eca" class="lt lu iq mw b gy na nb l nc nd"># CramerV Correlation to check for any correlation between catagorical variables<br/># Except Patient's age, all other variables are catagorical(binary)<br/>&gt;disease.corr = PairApply(disease[,names(disease) != "Patient_Age_Quantile"],cramerV, symmetric = TRUE)<br/># Displaying correlation with variable SARS_COV2_Result<br/>&gt;disease.corr[,2]<br/># Correlation plot<br/>&gt;corrplot(disease.corr, method = "square", type = "lower")</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/dc2ae9e0f63db0694675ddbaf1f8cc88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hb19EUdF4zUq2r0pmEtPrg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">疾病数据集相关图</p></figure><p id="13a0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里最重要的预测因子似乎是我们目标上的<em class="ls">鼻病毒或肠道病毒</em>，相关值为 0.1517。(不太重要)现在让我们将数据集分成 80%的训练和 20%的测试。</p><pre class="kg kh ki kj gt mv mw mx my aw mz bi"><span id="a902" class="lt lu iq mw b gy na nb l nc nd"># Dividing Train/Test data with 80% training and 20% test<br/>&gt;sample_size &lt;- floor(0.8 * nrow(disease))<br/>&gt;train &lt;- sample(nrow(disease), size = sample_size)<br/>&gt;disease.train &lt;- as.data.frame(disease[train,])<br/>&gt;disease.test &lt;- as.data.frame(disease[-train,])</span></pre><p id="abae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的数据集还没有准备好进行逻辑回归分析。</p><pre class="kg kh ki kj gt mv mw mx my aw mz bi"><span id="07ff" class="lt lu iq mw b gy na nb l nc nd"># Logistic regression considering top predictors<br/>&gt;disease.function = paste("SARS_COV2_Result", "~", "Patient_Age_Quantile + Rhinovirus_OR_Enterovirus")<br/>disease.glm = glm(as.formula(disease.function), data = disease.train , family = binomial)<br/>&gt;summary(disease.glm)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/110d80534080e34c3b2e3015c0181dfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VaE5VKchO1ovoQ-ylLthrQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">疾病概述</p></figure><p id="aded" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，预测因子<em class="ls">患者年龄分位数</em>和<em class="ls">鼻病毒或肠道病毒</em>的 P 值显示了巨大的希望。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/21394cdeffe45e43c85fa39ec16280b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PCshgx4WIPbZQ0RqZLpudQ.png"/></div></div></figure><p id="e55d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">根据上面的等式，我们可以说，如果一个人患有鼻病毒，他/她患 SARS CoV2 的可能性较小。</p><p id="cb14" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我使用了 10 重交叉验证来验证我们的模型。下一步是预测测试数据集上的值并准备混淆矩阵。</p><pre class="kg kh ki kj gt mv mw mx my aw mz bi"><span id="2b7c" class="lt lu iq mw b gy na nb l nc nd"># 10 fold cross-validation to verify the model<br/>&gt;cv.glm(disease.train,disease.glm,K=10)$delta[1]</span><span id="98db" class="lt lu iq mw b gy nh nb l nc nd"># Predicting on test data based on training set<br/>&gt;disease.glm.predict &lt;- predict(disease.glm,disease.test,type = "response")<br/>&gt;summary(disease.glm.predict)<br/># Mean predict results for SARS Cov2 Results diagnosis<br/>&gt;tapply(disease.glm.predict, disease.test$SARS_COV2_Result, mean)</span><span id="986e" class="lt lu iq mw b gy nh nb l nc nd"># Confusion matrix for threshold of 1%<br/>&gt;disease.confusion = table(disease.test$SARS_COV2_Result, disease.glm.predict &gt; 0.01)<br/>&gt;disease.confusion</span><span id="ec92" class="lt lu iq mw b gy nh nb l nc nd"># False negative error(Type II error)<br/>&gt;disease.type2error = disease.confusion[1,1]/<br/>(disease.confusion[1,1]+disease.confusion[2,2])<br/>&gt;disease.type2error</span></pre><p id="0d31" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我设置了一个严格的阈值(1%)来最小化第二类错误。该模型必须最大限度地减少误检患者的数量。60%的患有新冠肺炎的患者将从模型中被错误地检测为阴性，这是相当高的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/f7d2d387e1f66543beaa0eb7ee57243c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*seRna3g2waWvr0OqDLNHYA.png"/></div></div></figure><p id="ebd7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如预测的那样，ROC 曲线是 okayish 的。</p><pre class="kg kh ki kj gt mv mw mx my aw mz bi"><span id="54f1" class="lt lu iq mw b gy na nb l nc nd"># Plotting ROCR curve<br/>&gt;disease.ROCRpred = prediction(disease.glm.predict, &gt;disease.test$SARS_COV2_Result)<br/>&gt;disease.ROCRperf = performance(disease.ROCRpred, "tpr", "fpr")<br/>&gt;par(mfrow=c(1,2))<br/>&gt;plot(disease.ROCRperf, colorize=TRUE, &gt;print.cutoffs.at=seq(0,1,by=0.1), text.adj=c(-0.2,1.7))</span><span id="996f" class="lt lu iq mw b gy nh nb l nc nd"># Probability of SARS vs Rhinovirus plot<br/>&gt;disease.predicted.data &lt;- data.frame(<br/>  probability.of.having.SARS=disease.glm.predict,<br/>  Rhinovirus=disease.test$Rhinovirus_OR_Enterovirus)<br/>&gt;disease.predicted.data &lt;- disease.predicted.data[<br/>  order(disease.predicted.data$probability.of.having.SARS, decreasing=FALSE),]<br/>&gt;disease.predicted.data$rank &lt;- 1:nrow(disease.predicted.data)</span><span id="5401" class="lt lu iq mw b gy nh nb l nc nd">&gt;plot(probability.of.having.SARS ~ Rhinovirus,disease.predicted.data, type = "l", lwd = 2)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/859342a194b64dab9736d9c037324292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rKIjDoynbLEJWy6PVJ2EvA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ROC 图和 SARS 与鼻病毒的概率图</p></figure><p id="8d88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">鼻病毒的症状接近 SARS CoV-2 病毒，多见于鼻部(<a class="ae kv" href="https://en.wikipedia.org/wiki/Rhinovirus" rel="noopener ugc nofollow" target="_blank">鼻病毒</a>)。因此，随着鼻病毒的检测，患 SARS 的概率降低。</p><p id="6d71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">条件数据集分析</strong></p><p id="0300" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">条件数据集包含所有数字预测值，即从血液样本中获取的值。从摘要来看，数据看起来正常。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/7be5c332c6bfb25d5e68afa39c5b1c48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iOU5Z0qCOonM1JnEhT3R4A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">条件数据集摘要</p></figure><p id="b5c6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">重复相同的步骤，对目标变量的较高相关预测值应用逻辑回归。</p><pre class="kg kh ki kj gt mv mw mx my aw mz bi"><span id="29d6" class="lt lu iq mw b gy na nb l nc nd"># attaching the final dataset<br/>&gt;attach(condition)</span><span id="20dd" class="lt lu iq mw b gy nh nb l nc nd"># Correlation between varables<br/>&gt;condition.corr = cor(condition)<br/>&gt;condition.corr[,2]<br/># Correlation plot<br/>&gt;corrplot(condition.corr, method = "square", type = "lower")</span><span id="85a9" class="lt lu iq mw b gy nh nb l nc nd"># Dividing Train/Test data with 80% training dataset<br/>&gt;sample_size &lt;- floor(0.8 * nrow(condition))<br/>&gt;train_ind &lt;- sample(nrow(condition), size = sample_size)<br/>&gt;condition.train &lt;- as.data.frame(condition[train_ind,])<br/>&gt;condition.test &lt;- as.data.frame(condition[-train_ind,])</span><span id="58d9" class="lt lu iq mw b gy nh nb l nc nd"># Logistic regression considering all the variables on the targer variable SARS_COV2_Result<br/>&gt;condition.function = paste("SARS_COV2_Result", "~", "Patient_Age_Quantile + Leukocytes + Eosinophils + Red_blood_cell_distribution_width_RDW + Platelets + Proteina_C_reativa_mg_dL")<br/>&gt;condition.glm = glm(as.formula(condition.function), data = &gt;condition.train , family = binomial)<br/>&gt;summary(condition.glm)</span><span id="06e0" class="lt lu iq mw b gy nh nb l nc nd"># 10 fold cross-validation to verify the model<br/>&gt;cv.glm(condition.train,condition.glm,K=10)$delta[1]</span><span id="7fbd" class="lt lu iq mw b gy nh nb l nc nd"># Predicting on test data based on training set<br/>&gt;condition.glm.predict &lt;- predict(condition.glm,condition.test,type = "response")<br/>&gt;summary(condition.glm.predict)<br/>&gt;tapply(condition.glm.predict, condition.test$SARS_COV2_Result, mean)</span><span id="200a" class="lt lu iq mw b gy nh nb l nc nd"># Confusion matrix for threshold of 1%<br/>&gt;condition.confusion = table(condition.test$SARS_COV2_Result, condition.glm.predict &gt; 0.01)<br/>&gt;condition.confusion</span><span id="a3fc" class="lt lu iq mw b gy nh nb l nc nd"># False negative error rate (Type II error)<br/>&gt;condition.type2error = condition.confusion[1,1]/ (condition.confusion[1,1]+condition.confusion[2,2])<br/>&gt;condition.type2error</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/be559cff1d0b1a70922d37ca11c62a21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aLO5WeML0AJsDptvFGLPPA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">条件数据集相关图</p></figure><p id="00b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里我们看到一些高度相关的变量。然而，我们只考虑与目标变量高度相关的预测值。因此，为了进行分析，我将使用<em class="ls">患者年龄分位数、白细胞、嗜酸性粒细胞、红细胞分布宽度 RDW、血小板和蛋白质 a_C_reativa_mg_dL </em>预测值。我们来看看 glm 总结。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/13696724d40f44cccfad885180d31a28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b_g8X0UdjdfmyvqEDOuUzQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">条件数据集 glm 摘要</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/35fec0b107ec57ba0ee75407659ddf71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pQbxtO8whYKuwU1zoVgguA.png"/></div></div></figure><p id="eeb6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们预测一下测试数据集的误差。使用该模型，121 例中的 30 例给出错误的结果，并且 ROC 曲线优于先前的模型。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/852d0f37aaa98daa4fb0ccdffdf02189.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fd95lNlUevCidWFGg-a2MQ.png"/></div></div></figure><pre class="kg kh ki kj gt mv mw mx my aw mz bi"><span id="736e" class="lt lu iq mw b gy na nb l nc nd"># Plotting ROCR curve<br/>&gt;condition.ROCRpred = prediction(condition.glm.predict,    condition.test$SARS_COV2_Result)<br/>&gt;condition.ROCRperf = performance(condition.ROCRpred, "tpr", "fpr")<br/>&gt;plot(condition.ROCRperf, colorize=TRUE, print.cutoffs.at=seq(0,1,by=0.1), text.adj=c(-0.2,1.7))</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/1a0a06278cf024a60b0fea3440ef961a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1nXh6ll9N0Nr8mmBl19DPg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">条件数据集 ROC 曲线</p></figure><p id="c0e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">绘制结果，</p><pre class="kg kh ki kj gt mv mw mx my aw mz bi"><span id="783b" class="lt lu iq mw b gy na nb l nc nd"># Creating a dataframe with variables and predicted values of SARS results<br/>&gt;condition.predict.dataframe &lt;- data.frame(<br/>  probability.of.having.SARS=condition.glm$fitted.values,<br/>  Leukocytes=condition.train$Leukocytes,<br/>  Patient_Age_Quantile = condition.train$Patient_Age_Quantile,<br/>  Eosinophils = condition.train$Eosinophils,<br/>  Red_blood_cell_distribution_width_RDW = &gt;condition.train$Red_blood_cell_distribution_width_RDW,<br/>  Platelets = condition.train$Platelets,<br/>  Proteina_C_reativa_mg_dL = &gt;condition.train$Proteina_C_reativa_mg_dL)</span><span id="aaf5" class="lt lu iq mw b gy nh nb l nc nd">&gt;plot1 = ggplot(data=condition.predict.dataframe, aes(x=Patient_Age_Quantile, y=probability.of.having.SARS)) +<br/>  geom_point(aes(color=Patient_Age_Quantile), size=4)<br/>&gt;plot2 = ggplot(data=condition.predict.dataframe, aes(x=Leukocytes, y=probability.of.having.SARS)) +<br/>  geom_point(aes(color=Leukocytes), size=4)<br/>&gt;plot3 = ggplot(data=condition.predict.dataframe, aes(x=Red_blood_cell_distribution_width_RDW, y=probability.of.having.SARS)) +<br/>  geom_point(aes(color=Red_blood_cell_distribution_width_RDW), size=4)<br/>&gt;plot4 = ggplot(data=condition.predict.dataframe, aes(x=Eosinophils, y=probability.of.having.SARS)) +<br/>  geom_point(aes(color=Eosinophils), size=4)<br/>&gt;plot5 = ggplot(data=condition.predict.dataframe, aes(x=Platelets, y=probability.of.having.SARS)) +<br/>  geom_point(aes(color=Platelets), size=4)<br/>&gt;plot6 = ggplot(data=condition.predict.dataframe, aes(x=Proteina_C_reativa_mg_dL, y=probability.of.having.SARS)) +<br/>  geom_point(aes(color=Proteina_C_reativa_mg_dL), size=4)<br/># Plotting the values<br/>&gt;grid.arrange(plot1, plot2, plot3, plot4, plot5, plot6, ncol=3 , nrow = 2)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/2cd242a3cb52daad47458062e15cceb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9XpoQqOjwGOatIRSG2mPTQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">患 SARS 的概率与预测值</p></figure><p id="cf72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以看到，<em class="ls">患者的年龄分位数</em>和<em class="ls">蛋白 a C reativa </em>呈正相关，其余与目标变量的概率呈负相关。</p><p id="3de1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">预测器的单独调查</strong></p><p id="cca7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一些预测因素在单独分析时显示出巨大的潜力。这些预测是，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/f207a35646615013cdf4e624202874d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*GvnJ1FWL2S-eMvpXKk-O1g.png"/></div></figure><p id="cbd0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我现在将创建一个函数来分析这些变量，以查看它们的效果。</p><pre class="kg kh ki kj gt mv mw mx my aw mz bi"><span id="e063" class="lt lu iq mw b gy na nb l nc nd"># Plotting Seperate probability graphs<br/>&gt;plotting.function &lt;- function(var,variableORrank){<br/>  condition.sep.function = paste("SARS_COV2_Result", "~", as.character(var))<br/>  condition.sep.glm = glm(as.formula(condition.sep.function), data = condition.train , family = binomial)<br/>  print(summary(condition.sep.glm))<br/>  cv.glm(condition.train,condition.sep.glm,K=10)$delta[1]<br/>  <br/>  condition.predicted.data &lt;- data.frame(<br/>    probability.of.SARS=condition.sep.glm$fitted.values,<br/>    variable=condition.train[,as.character(var)])<br/>  <br/>  condition.predicted.data &lt;- condition.predicted.data[<br/>    order(condition.predicted.data$variable, decreasing=FALSE),]<br/>  <br/>  condition.predicted.data$rank &lt;- 1:nrow(condition.predicted.data)<br/>  <br/>  ggplot(data=condition.predicted.data, aes(x= variable, y=probability.of.SARS)) +<br/>    geom_point(aes(color=variable), size=3) +<br/>    xlab(as.character(var)) +<br/>    ylab("Probability of having SARS CoV-2") +<br/>    scale_colour_gradient(low = "darkgreen", high = "darkred", na.value = NA) +<br/>    ggtitle(coef(summary(condition.sep.glm))[,'Pr(&gt;|z|)'])<br/>}</span><span id="4859" class="lt lu iq mw b gy nh nb l nc nd">&gt;plotfun1 = plotting.function("Platelets")<br/>&gt;plotfun2 = plotting.function("Monocytes")<br/>&gt;plotfun3 = plotting.function("Hemoglobin")<br/>&gt;plotfun4 = plotting.function("Red_blood_cells")<br/>&gt;plotfun5 = plotting.function("Mean_platelet_volume")<br/>&gt;grid.arrange(plotfun1, plotfun2, plotfun3, plotfun4, plotfun5, ncol=3 , nrow = 2)</span></pre><p id="7213" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">结果是，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/5ac938d6444f58f1dca94f0e0feb0f0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sRDbBhi6RD4XhK0DQqQafQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">患 SARS 的概率与单一预测因子分析(图表标题为 Pr(&gt;|z|)值，越低越好)(单核细胞是一种白细胞，血红蛋白是一种含铁的氧运输金属蛋白)</p></figure><p id="ab3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">除了<em class="ls">血小板</em>之外，所有预测因子都与患 SARS CoV-2 的概率呈正相关。</p><h1 id="c00c" class="nt lu iq bd lv nu nv nw ly nx ny nz mb jw oa jx me jz ob ka mh kc oc kd mk od bi translated"><strong class="ak">结论</strong></h1><p id="1d5d" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">对于医院来说，区分鼻病毒携带者和新冠肺炎病毒携带者是非常重要的。将鼻病毒和新冠肺炎病毒患者分开会让这个过程快很多。</p><p id="89ca" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">高%vol 的白细胞表明身体正在对抗病毒。</p><p id="cc96" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当携带病毒时，身体不能产生足够的血小板来帮助止血。</p><p id="fea7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">利用给定的患者血液数据，该模型可以预测患 SARS CoV-2 的概率。</p><h1 id="df65" class="nt lu iq bd lv nu nv nw ly nx ny nz mb jw oa jx me jz ob ka mh kc oc kd mk od bi translated"><strong class="ak">分析中使用的代码</strong></h1><div class="oe of gp gr og oh"><a href="https://github.com/ZeroPanda/COVID-19-Regression-Analysis" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd ir gy z fp om fr fs on fu fw ip bi translated">零熊猫/新冠肺炎回归分析</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">介质物品分析代码。通过创建一个……为零熊猫/新冠肺炎回归分析的发展做出贡献</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">github.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov kp oh"/></div></div></a></div><h1 id="7f6b" class="nt lu iq bd lv nu nv nw ly nx ny nz mb jw oa jx me jz ob ka mh kc oc kd mk od bi translated"><strong class="ak">参考文献</strong></h1><p id="41fe" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated"><a class="ae kv" href="http://faculty.marshall.usc.edu/gareth-james/ISL/ISLR%20Seventh%20Printing.pdf" rel="noopener ugc nofollow" target="_blank">统计学习介绍及在 R 中的应用</a>；加雷斯·詹姆斯，丹妮拉·威滕，特雷弗·哈斯蒂，罗伯特·蒂布拉尼</p><div class="oe of gp gr og oh"><a href="https://www.kaggle.com/einsteindata4u/covid19" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd ir gy z fp om fr fs on fu fw ip bi translated">新冠肺炎的诊断及其临床表现</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">支持临床决策的人工智能和数据科学(3 月 28 日至 4 月 3 日)</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">www.kaggle.com</p></div></div><div class="oq l"><div class="ow l os ot ou oq ov kp oh"/></div></div></a></div><div class="oe of gp gr og oh"><a href="https://www.wikipedia.org/" rel="noopener  ugc nofollow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd ir gy z fp om fr fs on fu fw ip bi translated">维基百科(一个基于 wiki 技术的多语言的百科全书协作计划ˌ也是一部用不同语言写成的网络百科全书ˌ 其目标及宗旨是为全人类提供自由的百科全书)ˌ开放性的百科全书</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">维基百科是一个免费的在线百科全书，由世界各地的志愿者创建和编辑，由维基媒体托管…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">www.wikipedia.org</p></div></div><div class="oq l"><div class="ox l os ot ou oq ov kp oh"/></div></div></a></div></div></div>    
</body>
</html>