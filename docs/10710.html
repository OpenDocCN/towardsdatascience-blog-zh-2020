<html>
<head>
<title>5 Ways to Merge Dictionaries in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 合并字典的 5 种方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/merge-dictionaries-in-python-d4e9ce137374?source=collection_archive---------0-----------------------#2020-07-27">https://towardsdatascience.com/merge-dictionaries-in-python-d4e9ce137374?source=collection_archive---------0-----------------------#2020-07-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="0458" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">编程；编排</h2><div class=""/><div class=""><h2 id="5080" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">Python 3.9 中合并 Python 字典和新运算符的不同方式</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/1731921ba1a94bf423b79ea31443c5ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*383ADMsLmALfFDCWF3jaUA.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">图片来自<a class="ae la" href="https://pixabay.com/users/Clker-Free-Vector-Images-3736/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=39400" rel="noopener ugc nofollow" target="_blank"> Clker-Free-Vector-Images </a>来自<a class="ae la" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=39400" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="0320" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在 Python 中，字典是一种数据结构，它包含键-值对形式的元素，其中键用于访问字典的值。Python 字典是无序和可变的，即字典的元素可以改变。</p><p id="4e01" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在本文中，我们将探索合并两个或更多字典的五种不同方法，以及一种粗略的方法。</p><p id="df0e" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">对于本文，让我们创建两个字典<code class="fe lx ly lz ma b">d1</code>和<code class="fe lx ly lz ma b">d2</code>，我们希望将它们连接成一个字典:</p><pre class="kp kq kr ks gt mb ma mc bn md me bi"><span id="f5ee" class="mf mg iq ma b be mh mi l mj mk">d1 = {'India': 'Delhi',<br/>      'Canada': 'Ottawa',<br/>      'United States': 'Washington D. C.'}<br/><br/>d2 = {'France': 'Paris',<br/>      'Malaysia': 'Kuala Lumpur'}</span></pre></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h2 id="c6bf" class="ms mg iq bd mt mu mv dn mw mx my dp mz lk na nb nc lo nd ne nf ls ng nh ni iw bi translated">粗暴的方式</h2><p id="9f3c" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">通过用第一个字典迭代第二个字典的键值对，可以合并两个字典。</p><pre class="kp kq kr ks gt mb ma mc bn md me bi"><span id="01ab" class="mf mg iq ma b be mh mi l mj mk">d3 = d1.copy()<br/>for key, value in d2.items():<br/>    d3[key] = value<br/>    <br/>print(d3)</span></pre><pre class="no mb ma mc bn md me bi"><span id="1425" class="mf mg iq ma b be mh mi l mj mk">Output:<br/><br/>{'India': 'Delhi',<br/> 'Canada': 'Ottawa',<br/> 'United States': 'Washington D. C.',<br/> 'France': 'Paris',<br/> 'Malaysia': 'Kuala Lumpur'}</span></pre></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><p id="18c9" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">现在，让我们看看合并字典的更干净、更好的方法:</p><h2 id="0f81" class="ms mg iq bd mt mu mv dn mw mx my dp mz lk na nb nc lo nd ne nf ls ng nh ni iw bi translated">方法 1:使用更新方法</h2><p id="8b51" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">Dictionary 有一个方法<a class="ae la" href="https://docs.python.org/3/library/stdtypes.html#dict.update" rel="noopener ugc nofollow" target="_blank"> update() </a>，该方法将 dictionary 与其他 dictionary 中的条目合并，并覆盖现有的键。</p><pre class="kp kq kr ks gt mb ma mc bn md me bi"><span id="1597" class="mf mg iq ma b be mh mi l mj mk">d4 = d1.copy()<br/>d4.update(d2)<br/><br/>print(d4)</span></pre><pre class="no mb ma mc bn md me bi"><span id="9270" class="mf mg iq ma b be mh mi l mj mk">Output:<br/>{'India': 'Delhi',<br/> 'Canada': 'Ottawa',<br/> 'United States': 'Washington D. C.',<br/> 'France': 'Paris',<br/> 'Malaysia': 'Kuala Lumpur'}</span></pre><p id="b955" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">update 方法修改当前字典。因此，在对字典进行操作之前，您可能需要创建字典的副本。</p><h2 id="fc5d" class="ms mg iq bd mt mu mv dn mw mx my dp mz lk na nb nc lo nd ne nf ls ng nh ni iw bi translated">方法 2:使用解包操作符</h2><p id="274f" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">我们可以通过简单地使用解包操作符(**)将字典合并在一行中。</p><pre class="kp kq kr ks gt mb ma mc bn md me bi"><span id="d08a" class="mf mg iq ma b be mh mi l mj mk">d5 = {**d1, **d2}<br/><br/>print(d5)</span></pre><pre class="no mb ma mc bn md me bi"><span id="d202" class="mf mg iq ma b be mh mi l mj mk">Output:<br/>{'India': 'Delhi',<br/> 'Canada': 'Ottawa',<br/> 'United States': 'Washington D. C.',<br/> 'France': 'Paris',<br/> 'Malaysia': 'Kuala Lumpur'}</span></pre><p id="e790" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我们也可以用这种方法合并多个字典。</p><pre class="kp kq kr ks gt mb ma mc bn md me bi"><span id="8136" class="mf mg iq ma b be mh mi l mj mk">{**dict1, **dict2, **dict3}</span></pre><h2 id="4ecc" class="ms mg iq bd mt mu mv dn mw mx my dp mz lk na nb nc lo nd ne nf ls ng nh ni iw bi translated">方法 3:使用集合。链式地图</h2><p id="6e0a" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">这可能是最不为人知的合并字典的方法。集合模块中的<br/> <a class="ae la" href="https://docs.python.org/3/library/collections.html#collections.ChainMap" rel="noopener ugc nofollow" target="_blank"> ChainMap </a>类将多个字典组合在一个视图中。</p><pre class="kp kq kr ks gt mb ma mc bn md me bi"><span id="14f0" class="mf mg iq ma b be mh mi l mj mk">from collections import ChainMap<br/>d6 = ChainMap(d1, d2)<br/><br/>print(d6)</span></pre><pre class="no mb ma mc bn md me bi"><span id="2ba9" class="mf mg iq ma b be mh mi l mj mk">Output:<br/>ChainMap({'Canada': 'Ottawa',<br/>          'India': 'Delhi',<br/>          'United States': 'Washington D. C.'},<br/>         {'France': 'Paris',<br/>          'Malaysia': 'Kuala Lumpur'})</span></pre><p id="c4fe" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这个方法返回一个 ChainMap 类的对象。我们仍然可以像使用任何其他词典一样使用这个对象。例如<code class="fe lx ly lz ma b">d6[’India’]</code>将返回<code class="fe lx ly lz ma b">'Delhi’</code>。</p><p id="1b0b" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">然而，在两个字典中有相同键的情况下，这个方法将返回第一个字典的值，这与从第二个字典返回值的其他方法不同。</p><pre class="kp kq kr ks gt mb ma mc bn md me bi"><span id="e509" class="mf mg iq ma b be mh mi l mj mk">x = {'A': 1, 'B': 2}<br/>y = {'B': 10, 'C': 20}<br/><br/>z = ChainMap(x, y)<br/>z['B']<br/><br/># outputs 2</span></pre><h2 id="569b" class="ms mg iq bd mt mu mv dn mw mx my dp mz lk na nb nc lo nd ne nf ls ng nh ni iw bi translated">方法 4:打开第二本字典</h2><p id="85c1" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">我们可以通过打开第二本字典来合并字典。</p><pre class="kp kq kr ks gt mb ma mc bn md me bi"><span id="c248" class="mf mg iq ma b be mh mi l mj mk">d7 = dict(d1, **d2)<br/><br/>print(d7)</span></pre><pre class="no mb ma mc bn md me bi"><span id="0b51" class="mf mg iq ma b be mh mi l mj mk">Output:<br/>{'India': 'Delhi',<br/> 'Canada': 'Ottawa',<br/> 'United States': 'Washington D. C.',<br/> 'France': 'Paris',<br/> 'Malaysia': 'Kuala Lumpur'}</span></pre><p id="f0d4" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">但是，只有当第二个字典的键是字符串时，这种方法才有效。</p><pre class="kp kq kr ks gt mb ma mc bn md me bi"><span id="fd15" class="mf mg iq ma b be mh mi l mj mk">x = {1: 'A', 2: 'B'}<br/>y = {3: 'C', 4: 'D'}<br/><br/>z = dict(x, **y)</span></pre><pre class="no mb ma mc bn md me bi"><span id="83fc" class="mf mg iq ma b be mh mi l mj mk">Output:<br/>TypeError: keyword arguments must be strings</span></pre><h2 id="f53d" class="ms mg iq bd mt mu mv dn mw mx my dp mz lk na nb nc lo nd ne nf ls ng nh ni iw bi translated">方法 5:使用合并运算符</h2><p id="3f1e" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">Python 3.9 在<code class="fe lx ly lz ma b">dict</code>类中引入了<a class="ae la" href="https://docs.python.org/3.9/whatsnew/3.9.html#dictionary-merge-update-operators" rel="noopener ugc nofollow" target="_blank">合并</a>操作符(|)。使用 merge 操作符，我们可以在一行代码中组合字典。</p><pre class="kp kq kr ks gt mb ma mc bn md me bi"><span id="6ff1" class="mf mg iq ma b be mh mi l mj mk">d8 = d1 | d2<br/><br/>print(d8)</span></pre><pre class="no mb ma mc bn md me bi"><span id="dbc0" class="mf mg iq ma b be mh mi l mj mk">Output:<br/>{'India': 'Delhi',<br/> 'Canada': 'Ottawa',<br/> 'United States': 'Washington D. C.',<br/> 'France': 'Paris',<br/> 'Malaysia': 'Kuala Lumpur'}</span></pre><p id="931e" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我们还可以通过使用更新操作符(|=)来合并字典。</p><pre class="kp kq kr ks gt mb ma mc bn md me bi"><span id="2cfe" class="mf mg iq ma b be mh mi l mj mk">d1 |= d2</span></pre></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h2 id="8526" class="ms mg iq bd mt mu mv dn mw mx my dp mz lk na nb nc lo nd ne nf ls ng nh ni iw bi translated">资源</h2><p id="b837" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">本文中使用的代码片段可以在我的<a class="ae la" href="https://jimit105.github.io/medium-articles/5%20Ways%20to%20Merge%20Dictionaries%20in%20Python.html" rel="noopener ugc nofollow" target="_blank"> GitHub 页面</a>上找到。</p><h2 id="5720" class="ms mg iq bd mt mu mv dn mw mx my dp mz lk na nb nc lo nd ne nf ls ng nh ni iw bi translated">让我们连接</h2><p id="2a1a" class="pw-post-body-paragraph lb lc iq ld b le nj ka lg lh nk kd lj lk nl lm ln lo nm lq lr ls nn lu lv lw ij bi translated">领英:<a class="ae la" href="https://www.linkedin.com/in/jimit105/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/jimit105/</a><br/>GitHub:<a class="ae la" href="https://github.com/jimit105" rel="noopener ugc nofollow" target="_blank">https://github.com/jimit105</a><br/>推特:<a class="ae la" href="https://twitter.com/jimit105" rel="noopener ugc nofollow" target="_blank">https://twitter.com/jimit105</a></p></div></div>    
</body>
</html>