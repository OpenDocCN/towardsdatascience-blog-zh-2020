<html>
<head>
<title>Machine Learning Basics: Simple Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习基础:简单线性回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-basics-simple-linear-regression-bc83c01baa07?source=collection_archive---------16-----------------------#2020-06-27">https://towardsdatascience.com/machine-learning-basics-simple-linear-regression-bc83c01baa07?source=collection_archive---------16-----------------------#2020-06-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1e19" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习简单线性回归的基本机器学习程序。</h2></div><p id="cb35" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在数据科学编程的最初几天，人们可能会遇到术语“<strong class="kk iu">回归</strong>”。在这个故事中，我想用一个常见的例子来解释非常基本的“<strong class="kk iu"><em class="le"/></strong>”的程序代码。</p><h2 id="a136" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">概述—</h2><p id="5c1b" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">在统计学中，<strong class="kk iu"> <em class="le">线性回归</em> </strong>是一种对标量响应(或因变量)与一个或多个解释变量(或自变量)之间的关系进行建模的线性方法。在我们的例子中，我们将经历简单的线性回归。</p><p id="dcc6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">简单线性回归的形式为<code class="fe md me mf mg b">y = wx + b</code>，其中<strong class="kk iu"> <em class="le"> y </em> </strong>为因变量，<strong class="kk iu"> <em class="le"> x </em> </strong>为自变量，<strong class="kk iu"> <em class="le"> w </em> </strong>和<strong class="kk iu"> <em class="le"> b </em> </strong>为训练参数，在训练过程中需要对其进行优化，以获得准确的预测。</p><p id="898a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们应用机器学习来训练一个数据集，根据<strong class="kk iu"><em class="le"/></strong>年的经验来预测<strong class="kk iu"> <em class="le">工资</em> </strong>。</p><h2 id="c597" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">步骤 1:导入库</h2><p id="4177" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">在第一步中，我们将导入<strong class="kk iu"> <em class="le"> pandas </em> </strong>库，该库将用于存储 pandas 数据帧中的数据。<strong class="kk iu"> <em class="le"> matplotlib </em> </strong>用于绘制图形。</p><pre class="mh mi mj mk gt ml mg mm mn aw mo bi"><span id="7fcf" class="lf lg it mg b gy mp mq l mr ms">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd</span></pre><h2 id="a403" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">步骤 2:导入数据集</h2><p id="319f" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">在这一步中，我们将从我的 github 存储库中下载数据集，其中包含的数据为“Salary_Data.csv”。变量<strong class="kk iu"> <em class="le"> X </em> </strong>会存储“<strong class="kk iu"> <em class="le">年资</em> </strong>”，变量<strong class="kk iu"><em class="le"/></strong>会存储“<strong class="kk iu"> <em class="le">工资</em></strong><strong class="kk iu"><em class="le">。</em></strong><code class="fe md me mf mg b">dataset.head(5)</code>用于可视化前 5 行数据。</p><pre class="mh mi mj mk gt ml mg mm mn aw mo bi"><span id="2846" class="lf lg it mg b gy mp mq l mr ms">dataset = pd.read_csv('https://raw.githubusercontent.com/mk-gurucharan/Regression/master/Salary_Data.csv')</span><span id="8a46" class="lf lg it mg b gy mt mq l mr ms">X = dataset.iloc[:, :-1].values<br/>y = dataset.iloc[:, -1].values</span><span id="f7c9" class="lf lg it mg b gy mt mq l mr ms">dataset.head(5)</span><span id="5fde" class="lf lg it mg b gy mt mq l mr ms">&gt;&gt;<br/>YearsExperience Salary<br/>1.1             39343.0<br/>1.3             46205.0<br/>1.5             37731.0<br/>2.0             43525.0<br/>2.2             39891.0</span></pre><h2 id="2f4c" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">步骤 3:将数据集分为训练集和测试集</h2><p id="da31" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">在这一步中，我们必须将数据集分为训练集和测试集，前者将训练线性回归模型，后者将应用训练好的模型来可视化结果。在此，<code class="fe md me mf mg b">test_size=0.2</code>表示<strong class="kk iu"><em class="le"/></strong>数据的 20%<strong class="kk iu"><em class="le">将作为</em> </strong>测试集保存，剩余的<strong class="kk iu"><em class="le"/></strong>的 80%<strong class="kk iu"><em class="le">将作为</em> </strong>训练集用于训练。</p><pre class="mh mi mj mk gt ml mg mm mn aw mo bi"><span id="e086" class="lf lg it mg b gy mp mq l mr ms">from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2)</span></pre><h2 id="42da" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">步骤 4:在训练集上训练简单线性回归模型</h2><p id="f561" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">第四步，导入类<code class="fe md me mf mg b">LinearRegression</code>，并将其赋给变量<strong class="kk iu"> <em class="le">“回归量”</em> </strong>。<code class="fe md me mf mg b">regressor.fit()</code>功能配有<strong class="kk iu"> X_train </strong>和<strong class="kk iu"> <em class="le"> Y_train </em> </strong>，模型将在其上进行训练。</p><pre class="mh mi mj mk gt ml mg mm mn aw mo bi"><span id="9a53" class="lf lg it mg b gy mp mq l mr ms">from sklearn.linear_model import LinearRegression<br/>regressor = LinearRegression()<br/>regressor.fit(X_train, y_train)</span></pre><h2 id="ea7c" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">步骤 5:预测测试集结果</h2><p id="f31b" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">在这一步中，<code class="fe md me mf mg b">regressor.predict()</code>函数用于预测测试集的值，这些值被存储到变量<code class="fe md me mf mg b">y_pred.</code></p><pre class="mh mi mj mk gt ml mg mm mn aw mo bi"><span id="4fb2" class="lf lg it mg b gy mp mq l mr ms">y_pred = regressor.predict(X_test)</span></pre><h2 id="28d3" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">步骤 6:将测试集与预测值进行比较</h2><p id="9813" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">在这个步骤中，创建一个 Pandas DataFrame 来比较原始测试集(<strong class="kk iu"> <em class="le"> y_test </em> </strong>)和预测结果(<strong class="kk iu"> <em class="le"> y_pred </em> </strong>)的工资值。</p><pre class="mh mi mj mk gt ml mg mm mn aw mo bi"><span id="39c0" class="lf lg it mg b gy mp mq l mr ms">df = pd.DataFrame({'Real Values':y_test, 'Predicted Values':y_pred})<br/>df</span><span id="1e61" class="lf lg it mg b gy mt mq l mr ms">&gt;&gt; <br/>Real Values    Predicted Values<br/>109431.0       107621.917107<br/>81363.0        81508.217112<br/>93940.0        82440.849255<br/>55794.0        63788.206401<br/>66029.0        74047.159970<br/>91738.0        89901.906396</span></pre><p id="e10f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以看到，预测的工资非常接近实际工资值，可以得出结论，该模型已经过良好的训练。</p><h2 id="eadd" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">第七步:可视化结果</h2><p id="90a1" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">在最后一步中，我们将<strong class="kk iu"> <em class="le">实际</em> </strong>和<strong class="kk iu"> <em class="le">预测</em> </strong>工资值的结果以及绘制的图表上的线性回归线可视化。</p><pre class="mh mi mj mk gt ml mg mm mn aw mo bi"><span id="afc7" class="lf lg it mg b gy mp mq l mr ms">plt.scatter(X_test, y_test, color = 'red')<br/>plt.scatter(X_test, y_pred, color = 'green')<br/>plt.plot(X_train, regressor.predict(X_train), color = 'black')<br/>plt.title('Salary vs Experience (Result)')<br/>plt.xlabel('YearsExperience')<br/>plt.ylabel('Salary')<br/>plt.show()</span></pre><figure class="mh mi mj mk gt mv gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/b5b33fcaa3490607524c5c033f68e419.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*MDjQmknfIaHbheZwO6RigQ.png"/></div><p class="my mz gj gh gi na nb bd b be z dk translated">薪水与经验</p></figure><p id="6cde" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在该图中，实际值用“<strong class="kk iu"> <em class="le">红色</em> </strong>绘制，预测值用“<strong class="kk iu"> <em class="le">绿色</em> </strong>绘制。生成的线性回归线以“<strong class="kk iu"> <em class="le">黑色</em> </strong>”颜色绘制。</p><h2 id="6d11" class="lf lg it bd lh li lj dn lk ll lm dp ln kr lo lp lq kv lr ls lt kz lu lv lw lx bi translated">结论—</h2><p id="0caa" class="pw-post-body-paragraph ki kj it kk b kl ly ju kn ko lz jx kq kr ma kt ku kv mb kx ky kz mc lb lc ld im bi translated">因此，在这个故事中，我们已经成功地构建了一个<strong class="kk iu"> <em class="le">简单线性回归</em> </strong>模型，该模型根据员工的“工作经验”来预测他们的“工资”,并将结果可视化。</p><p id="e41a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我还附上了我的 github 资源库的链接，你可以在那里下载这个 Google Colab 笔记本和数据文件供你参考。</p><div class="nc nd gp gr ne nf"><a href="https://github.com/mk-gurucharan/Regression" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd iu gy z fp nk fr fs nl fu fw is bi translated">MK-guru charan/回归</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">GitHub 是超过 5000 万开发人员的家园，他们一起工作来托管和审查代码、管理项目和构建…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">github.com</p></div></div><div class="no l"><div class="np l nq nr ns no nt mw nf"/></div></div></a></div><p id="80c5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您还可以在下面找到该程序对其他回归模型的解释:</p><ul class=""><li id="76f8" class="nu nv it kk b kl km ko kp kr nw kv nx kz ny ld nz oa ob oc bi translated"><a class="ae od" rel="noopener" target="_blank" href="/machine-learning-basics-simple-linear-regression-bc83c01baa07">简单线性回归</a></li><li id="fe62" class="nu nv it kk b kl oe ko of kr og kv oh kz oi ld nz oa ob oc bi translated"><a class="ae od" rel="noopener" target="_blank" href="/machine-learning-basics-multiple-linear-regression-9c70f796e5e3">多元线性回归</a></li><li id="ee02" class="nu nv it kk b kl oe ko of kr og kv oh kz oi ld nz oa ob oc bi translated"><a class="ae od" rel="noopener" target="_blank" href="/machine-learning-basics-polynomial-regression-3f9dd30223d1">多项式回归</a></li><li id="ecf2" class="nu nv it kk b kl oe ko of kr og kv oh kz oi ld nz oa ob oc bi translated"><a class="ae od" rel="noopener" target="_blank" href="/machine-learning-basics-support-vector-regression-660306ac5226">支持向量回归</a></li><li id="14d5" class="nu nv it kk b kl oe ko of kr og kv oh kz oi ld nz oa ob oc bi translated"><a class="ae od" rel="noopener" target="_blank" href="/machine-learning-basics-decision-tree-regression-1d73ea003fda">决策树回归</a></li><li id="1a1d" class="nu nv it kk b kl oe ko of kr og kv oh kz oi ld nz oa ob oc bi translated"><a class="ae od" rel="noopener" target="_blank" href="/machine-learning-basics-random-forest-regression-be3e1e3bb91a">随机森林回归</a></li></ul><p id="207c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在接下来的文章中，我们将会遇到更复杂的回归、分类和聚类模型。到那时，快乐的机器学习！</p></div></div>    
</body>
</html>