<html>
<head>
<title>Ball Detection - Machine Learning in Sports.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">运动中的机器学习。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ball-detection-with-computer-vision-ai-in-sports-f9ef743e0ef1?source=collection_archive---------5-----------------------#2020-02-26">https://towardsdatascience.com/ball-detection-with-computer-vision-ai-in-sports-f9ef743e0ef1?source=collection_archive---------5-----------------------#2020-02-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7b73" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">快速浏览自动球检测的可用解决方案</h2></div><h2 id="c96f" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">🚩<strong class="ak"> <em class="le">目标</em> </strong></h2><p id="ab98" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln kr lo lp lq kv lr ls lt kz lu lv lw lx im bi translated">我们希望评估在体育赛事中检测球的最快方法，以便开发一种体育人工智能，而无需在技术或开发人员上花费一百万美元。<strong class="lh iu"> <em class="ly">我们很快发现，探测球是开发一个健壮的体育 AI 的关键组成部分。</em> </strong></p><p id="82bd" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated"><strong class="lh iu"> <em class="ly">(我不是我团队中的技术人员，这意味着这篇文章中提供的观点不会让你深入了解任何算法或神经网络)。</em>T11】</strong></p><h2 id="1117" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">🚩你为什么要关心？为什么是舞会？T15】</h2><p id="3695" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln kr lo lp lq kv lr ls lt kz lu lv lw lx im bi translated">如果你是在人工智能运动利基<strong class="lh iu">完全相关</strong> <strong class="lh iu">为你</strong> <strong class="lh iu">了解球探的艺术状态，</strong>这个物体永远是任何运动的主要关注中心。如果你能探测到球(即使是在高速下)，那么你就能探测到比赛中更容易的关键事件、度量和更多有用的信息。</p><h2 id="7954" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">🚩<strong class="ak"> <em class="le">玩家呢？</em>T25】</strong></h2><p id="2ef0" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln kr lo lp lq kv lr ls lt kz lu lv lw lx im bi translated">拥有一个成功的体育人工智能是一套出色的计算机视觉检测的结果，<strong class="lh iu">现在有许多可用的神经网络擅长检测人体(例如 OpenPose ),所以球员将很容易被检测到，但球却不容易..更不用说在高速下… <br/> </strong>这就是为什么我们创建这个帖子来评估最快的球探方法。</p><p id="f1b7" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated"><strong class="lh iu">仅仅能够探测到球不会带你去那里</strong>但是我们相信，使用一个好的球探测器和来自预训练神经网络的真人探测器是最快的开始方式。</p><h1 id="d7f6" class="me kj it bd kk mf mg mh kn mi mj mk kq jz ml ka ku kc mm kd ky kf mn kg lc mo bi translated"><strong class="ak">简介:跟踪和检测运动物体</strong></h1><p id="acf0" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln kr lo lp lq kv lr ls lt kz lu lv lw lx im bi translated">正如我们之前所说的<strong class="lh iu">检测</strong> <strong class="lh iu">和</strong> <strong class="lh iu">跟踪</strong>移动物体是人工智能在这个领域取得成功和发展的关键任务。<strong class="lh iu">运动相当于运动，人和物体以不同的速度和方向运动。</strong></p><p id="6466" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">跟踪移动物体并对其进行分析的能力起着至关重要的作用<strong class="lh iu">。对我们来说,</strong>开发并<strong class="lh iu">教会一个人工智能去观看一场足球比赛</strong>并检测比赛中的元素或事件<strong class="lh iu">听起来像是一个简单的任务，但实际上非常具有挑战性..</strong></p><h2 id="208b" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">这里有几个原因</h2><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/d61c9c43de48b09fdeebbd655dff0332.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*I4NFhoRN9iTFjFlxQ1I3aQ.gif"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">有时，即使是人类也很难理解复杂的体育比赛中发生了什么。看看 2010 年世界杯赛场上发生了多少疯狂的事情。很难注意到苏亚雷斯实际上是用手触球来阻止进球。对加纳来说幸运的是，裁判发现了这一点，并给了他们点球和最后一次晋级半决赛的机会。</p></figure><ul class=""><li id="977d" class="nc nd it lh b li lz ll ma kr ne kv nf kz ng lx nh ni nj nk bi translated">相机不断地平移、变焦，有时倾斜，有时从一个完全不同的角度回放，我们的大脑非常善于否定这种运动，以至于我们甚至没有注意到它。</li><li id="41d2" class="nc nd it lh b li nl ll nm kr nn kv no kz np lx nh ni nj nk bi translated">以不同的速度和不可预测的轨迹向各个方向移动的物体和人的数量</li><li id="87ae" class="nc nd it lh b li nl ll nm kr nn kv no kz np lx nh ni nj nk bi translated">背景中混有球员和球，物体和外形几乎相同的人</li><li id="94c8" class="nc nd it lh b li nl ll nm kr nn kv no kz np lx nh ni nj nk bi translated">假阳性，游戏外的相同物体(板凳上穿着相同服装的球员，游戏外的运动球与“游戏中”的球相同)</li></ul><p id="52ca" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated"><strong class="lh iu">但是我们人类在这项任务中表现出色！</strong></p><p id="0297" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">或者迷失在人(球员)和物体(球、网等)的快速且有时无规律的运动中。人工智能很难与人类竞争。</p><h1 id="8635" class="me kj it bd kk mf mg mh kn mi mj mk kq jz ml ka ku kc mm kd ky kf mn kg lc mo bi translated">我们开始吧！—我的球探之旅</h1><p id="4298" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln kr lo lp lq kv lr ls lt kz lu lv lw lx im bi translated"><strong class="lh iu">我的目标是尝试我在谷歌搜索 5 小时内遇到的球探测器</strong>让这个实验非常简单，没有人工智能行业的内部观点。</p><p id="2dd5" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">为了做到这一点，我使用了一种<strong class="lh iu">“即插即用”</strong>的方法，我不修改我找到的检测器和神经网络的代码，我只是下载并运行我的本地示例，只做了很小的修改。</p><p id="2249" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">我成功地想在下面的视频中跟踪球，当然我的期望不是太高，我意识到球移动得难以置信的快..</p><h2 id="d80c" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">让我们看看发生了什么！！</h2><p id="ef4e" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln kr lo lp lq kv lr ls lt kz lu lv lw lx im bi translated">这是我将使用<strong class="lh iu"> 3 个球检测器选项进行分析的视频。</strong></p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/7a78e8e964237d9582a3d9110d4488f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*BPFvVXSFniz2u_35QWIWVQ.gif"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">乌拉圭 vs 加哈纳[2010 年南非世界杯四分之一决赛]</p></figure><h1 id="d4aa" class="me kj it bd kk mf mg mh kn mi mj mk kq jz ml ka ku kc mm kd ky kf mn kg lc mo bi translated"><strong class="ak"> <em class="le"> 1st — PyImageSearch，OpenCV 球检测器</em> </strong></h1><blockquote class="nq nr ns"><p id="5aaf" class="lf lg ly lh b li lz ju lk ll ma jx ln nt mb lp lq nu mc ls lt nv md lv lw lx im bi translated"><strong class="lh iu">好得难以置信！我搜索的第一个结果！</strong> <br/> <em class="it">📹以 32fps 的速度在 CPU 上运行🤯<br/> ✅实时功能。</em></p></blockquote><p id="706a" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">参考链接源代码:<br/><a class="ae nw" href="https://www.pyimagesearch.com/2015/09/14/ball-tracking-with-opencv/" rel="noopener ugc nofollow" target="_blank">https://www . pyimagesearch . com/2015/09/14/ball-tracking-with-opencv/</a></p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/bc18769b0018a2a8b97bb3e0beb41142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/1*QTb5CcN4k2zfM_LNl10IHA.gif"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">用<strong class="bd nb">和<em class="le"> PyImageSearch 进行球检测和跟踪。</em>T29】</strong></p></figure><p id="43c4" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">这篇 PyImageSearch 文章描述了一种非常简单的检测和跟踪网球的方法:只需在图像上寻找一个绿色区域，然后找到该区域的封闭圆。轻松点。</p><p id="f7d0" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">报告的结果显示，球实际上被很好地跟踪，即使被手部分遮挡，它甚至以 32 FPS 的速度运行，这是非常高的，并允许实时检测。</p><p id="5ab9" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">到目前为止还不错，完全符合我的需求，所以我需要在我的视频上试一试！</p><h2 id="6e34" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">这是应用该检测器的结果。</h2><p id="8c2e" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln kr lo lp lq kv lr ls lt kz lu lv lw lx im bi translated"><strong class="lh iu"> <em class="ly">这里做个小澄清:</em> </strong> <em class="ly">我们确实把颜色检测器从绿色改成了白色，以便尝试检测足球，因为被设置为绿色。</em></p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/e36493c1a6ea6fb703bf0d3f90d63140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*AS3dtkmrpdJrPTWYTWiJZw.gif"/></div></figure><p id="f69a" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">根本不起作用，它与屏幕上的其他白色物体混淆了，球从未被检测到或跟踪到。</p><h1 id="6926" class="me kj it bd kk mf mg mh kn mi mj mk kq jz ml ka ku kc mm kd ky kf mn kg lc mo bi translated">第二个检测器 2(来自脸书的预训练神经网络)</h1><blockquote class="nq nr ns"><p id="1150" class="lf lg ly lh b li lz ju lk ll ma jx ln nt mb lp lq nu mc ls lt nv md lv lw lx im bi translated"><em class="it">📹</em>在 GPU (Nvidia GTX 1060Ti 6Gb Ram)上以 2 fps 运行，<br/> <em class="it"> ❌ </em> <strong class="lh iu"> <em class="it">非实时能力</em> </strong></p></blockquote><p id="909a" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">参考链接源代码:<br/><a class="ae nw" href="https://github.com/facebookresearch/detectron2" rel="noopener ugc nofollow" target="_blank"><em class="ly">https://nol.cs.nctu.edu.tw:234/open-source/TrackNet/</em></a></p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/18a1c4d84357510e8185698761c59105.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/1*btU2ycdhB5RYHGkeMv_0qQ.gif"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">我不拥有这个图像的权利。摘自侦探 2 Github</p></figure><p id="dde3" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">在第二个选项中，我将尝试实现一个由脸书提供的神经网络，该网络已经用大量对象(包括运动球)进行了预训练。我对“开箱即用”的结果很感兴趣。另外，我想看看它是否能够探测到玩家的身体。</p><h2 id="2d3c" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">这是应用该检测器的结果:</h2><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/26c428b06d30dba48871b7d9d17a197e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*C_8gt_aIxuAISSAMl6dKDw.gif"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">探测器 2 的结果对球来说不是很好，但对球员来说却很棒。我不拥有这个图像的权利。</p></figure><p id="df9e" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">球员们都被完美地探测到了。<strong class="lh iu">关于球，它在几帧内被探测到</strong>但这是我第一次看到它被探测到！</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/f03c0ae4294138fa8c5e1ad613af3a1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*zCHTQv4vjf19FgTAMC5V_A.jpeg"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">只有静止或缓慢运动时，才能以良好的精度检测到球对象。</p></figure><blockquote class="nq nr ns"><p id="052d" class="lf lg ly lh b li lz ju lk ll ma jx ln nt mb lp lq nu mc ls lt nv md lv lw lx im bi translated">我们发现<strong class="lh iu">当球处于静止位置时，它能够被探测器 2 检测到</strong>，并且具有高置信度得分。</p></blockquote><p id="bf68" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">但是这种预先训练的神经网络<strong class="lh iu">对于像球这样快速移动的物体</strong>有问题。</p><p id="856a" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">这让我想到了最后一个实验，一个定制的跟踪器，特别是<strong class="lh iu">基于热图解决快速移动的物体</strong>这下一个发展是有希望的，因为对网球的近乎完美的检测(这是一个更小的球，移动更快！)</p><h1 id="8658" class="me kj it bd kk mf mg mh kn mi mj mk kq jz ml ka ku kc mm kd ky kf mn kg lc mo bi translated">第三轨道网</h1><blockquote class="nq nr ns"><p id="5ebf" class="lf lg ly lh b li lz ju lk ll ma jx ln nt mb lp lq nu mc ls lt nv md lv lw lx im bi translated"><em class="it">📹</em>在文档中说明它能够以 22fps 的速度运行！允许实时能力<strong class="lh iu">但不是那么正确..</strong> <br/>在我的 GPU 上(英伟达 GTX 1060Ti 6Gb Ram) <strong class="lh iu">它以 2 fps 的速度运行..</strong><br/><em class="it"/><strong class="lh iu"><em class="it">没有实时能力。</em>T13】</strong></p></blockquote><p id="1e13" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated"><strong class="lh iu">参考链接源代码:</strong><br/><a class="ae nw" href="https://nol.cs.nctu.edu.tw:234/open-source/TrackNet/" rel="noopener ugc nofollow" target="_blank"><em class="ly">https://nol.cs.nctu.edu.tw:234/open-source/TrackNet/</em></a></p><p id="06f8" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">这是我跟踪球的最佳选择，尽管探测是在网球上<strong class="lh iu">我相信它可以更容易地探测到一个更大的球，并且永远不会以那么高的速度运行，</strong>但是…</p><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div role="button" tabindex="0" class="oa ob di oc bf od"><div class="gh gi nz"><img src="../Images/72bb4211eda959ce996c49c95926c01a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*jd5akXGmqI_3jw-cQhzsqg.gif"/></div></div><p class="mx my gj gh gi mz na bd b be z dk translated">这看起来很适合我们的提议，小网球被完美地检测和跟踪。我不拥有这个图像的权利。摘自 TrackNet Github</p></figure><h2 id="38fa" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">应用该检测器的结果:</h2><figure class="mq mr ms mt gt mu gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/f3aa5f962e70544ef4979ddb5c0a20f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*h6hQB-9lVzavPNx3AZNMzw.gif"/></div></figure><p id="d068" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated"><strong class="lh iu">我错了，结果很糟糕</strong> …尽管与 PyImageSearch 检测器相比，足球的检测有所改进，但帧中有太多的误报…这意味着 TrackNet 即使在根本没有球的情况下也能检测到球…</p><p id="b04a" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">此外<strong class="lh iu">它以 2 fps 运行，而不是文档中提到的 22 fps </strong>，这阻碍了实时分析和检测的可能性。</p><p id="9955" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">一个很大的优势是，这个 TrackNet 神经网络在如何用你自己的数据训练方面有很好的文档和建议。这可能是解决足球上的球检测的一个解决方案，但这显然不是一件容易的事情。</p><p id="53bd" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">如果任何人有足球数据集(真实的和/或合成的),我们有兴趣合作训练这个神经网络或开发一个定制的解决方案，请发送电子邮件到<strong class="lh iu"> gcor@eidos.ai </strong></p><h1 id="49a8" class="me kj it bd kk mf mg mh kn mi mj mk kq jz ml ka ku kc mm kd ky kf mn kg lc mo bi translated">从结果得出的结论</h1><p id="3fcd" class="pw-post-body-paragraph lf lg it lh b li lj ju lk ll lm jx ln kr lo lp lq kv lr ls lt kz lu lv lw lx im bi translated">总之，在人工智能运动中，没有“即插即用”的神经网络会把你带到那里，在这个领域没有全局解决方案。这对于那些早期进入这一领域并开发全球解决方案的人来说是一个不可思议的优势。这还没有到来..</p><p id="5e7f" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">但是，即使没有全球解决方案，每个不同的情况都可以用不同的方法来解决，为每个问题创建定制的解决方案。</p><p id="6a5e" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">这就是为什么你需要联系一个团队来开发这种类型的人工智能。</p><p id="4f5e" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">如果你有兴趣与我们合作或建立你的人工智能。</p><p id="01bc" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated"><strong class="lh iu">伸手！</strong></p><p id="4cbb" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">我们是一家专注于机器学习，特别是计算机视觉的软件公司，你可以通过 info@eidos.ai 联系我们，我们的网站是<a class="ae nw" href="https://eidos.ai" rel="noopener ugc nofollow" target="_blank"><strong class="lh iu">https://eidos . ai</strong></a></p><p id="49cb" class="pw-post-body-paragraph lf lg it lh b li lz ju lk ll ma jx ln kr mb lp lq kv mc ls lt kz md lv lw lx im bi translated">敬请关注我们下个月在 medium 上的下一篇文章！</p></div></div>    
</body>
</html>