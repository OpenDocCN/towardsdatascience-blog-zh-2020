<html>
<head>
<title>Plotting in Pandas Just Got Prettier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫里的情节越来越漂亮了</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/plotting-in-pandas-just-got-prettier-289d0e0fe5c0?source=collection_archive---------8-----------------------#2020-06-17">https://towardsdatascience.com/plotting-in-pandas-just-got-prettier-289d0e0fe5c0?source=collection_archive---------8-----------------------#2020-06-17</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><div class=""><h2 id="f76d" class="pw-subtitle-paragraph jr it iu bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">创建丰富的可视化和仪表板与熊猫绘图后端为 Plotly 和 Bokeh</h2></div><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/6588bca4839d5fa4d91b4b22dbc712b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WasTPy2AWbA7gjmyooGdGg.png"/></div></div></figure><p id="a60a" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">流行的 Python 数据分析库<a class="ae lr" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>中的绘图功能一直是我获取超级快速图表的常用方法之一。然而，可用的观想总是相当基础的，并不特别漂亮。</p><p id="930a" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我经常发现自己使用 Pandas 绘图功能快速执行一些可视化数据探索。但是，当涉及到向利益相关者展示见解时，可以使用 Plotly 或 Bokeh 等“更漂亮”的绘图库重新进行可视化。</p><p id="dbf5" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">自从最新的 Pandas 版本 0.25.3 以来，这不再是必要的，您现在可以使用第三方可视化库作为 Pandas 绘图功能的后端。流行的基于网络的交互式可视化 Python 库 Plotly 最近也发布了一个<a class="ae lr" href="https://medium.com/plotly/beyond-tidy-plotly-express-now-accepts-wide-form-and-mixed-form-data-bdc3e054f891" rel="noopener">熊猫绘图后台</a>。</p><p id="46c0" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">让我们来看看如何使用 Plotly 和 Bokeh 后端创建更丰富的可视化效果。</p></div><div class="ab cl ls lt hy lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="in io ip iq ir"><h1 id="f3cd" class="lz ma iu bd mb mc md me mf mg mh mi mj ka mk kb ml kd mm ke mn kg mo kh mp mq bi translated">使用不同的后端</h1><p id="d244" class="pw-post-body-paragraph kv kw iu kx b ky mr jv la lb ms jy ld le mt lg lh li mu lk ll lm mv lo lp lq in bi translated">为了激活绘图功能的不同后端，在导入 pandas 之后，添加这行代码。</p><pre class="kk kl km kn gu mw mx my mz aw na bi"><span id="47ac" class="nb ma iu mx b gz nc nd l ne nf">pd.options.plotting.backend = 'plotly'</span></pre><p id="881e" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">当前可用的后端有:</p><ul class=""><li id="8efb" class="ng nh iu kx b ky kz lb lc le ni li nj lm nk lq nl nm nn no bi translated">Plotly</li><li id="316d" class="ng nh iu kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">全息视图</li><li id="bee6" class="ng nh iu kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">Matplotlib</li><li id="fb77" class="ng nh iu kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">熊猫 _bokeh</li><li id="3df3" class="ng nh iu kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">Hyplot</li></ul></div><div class="ab cl ls lt hy lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="in io ip iq ir"><h1 id="8813" class="lz ma iu bd mb mc md me mf mg mh mi mj ka mk kb ml kd mm ke mn kg mo kh mp mq bi translated">Plotly 后端</h1><p id="ff89" class="pw-post-body-paragraph kv kw iu kx b ky mr jv la lb ms jy ld le mt lg lh li mu lk ll lm mv lo lp lq in bi translated">Plotly 是一个 Python 库，支持各种丰富的交互式可视化。Plotly 包的一个好处是它建立在 Javascript 版本的库之上，这意味着图表是基于 web 的，可以显示为 HTML 文件或嵌入到基于 Python 的 web 应用程序中。您还可以下载高质量图像文件的可视化效果，因此非常适合在文档或论文中使用。</p><p id="6c81" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">让我们快速浏览一些熊猫绘图功能的后端使用示例。</p><p id="9b2e" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">如果你还没有安装它，你将需要安装 Plotly<code class="fe nu nv nw mx b">pip intsall plotly</code>。如果你在 Jupyterlab 中使用 Plotly，你将需要执行几个额外的安装步骤<a class="ae lr" href="https://plotly.com/python/getting-started/#jupyterlab-support-python-35" rel="noopener ugc nofollow" target="_blank">来显示可视化。首先，安装 IPywidgets。</a></p><pre class="kk kl km kn gu mw mx my mz aw na bi"><span id="74f5" class="nb ma iu mx b gz nc nd l ne nf">pip install jupyterlab "ipywidgets&gt;=7.5"</span></pre><p id="70f9" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">然后运行这个来安装 Plotly 扩展。</p><pre class="kk kl km kn gu mw mx my mz aw na bi"><span id="142a" class="nb ma iu mx b gz nc nd l ne nf">jupyter labextension install jupyterlab-plotly@4.8.1</span></pre><p id="658d" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">为了说明绘图后端的用法，我将使用一个来自 openml.org 的数据集，名为“葡萄酒”数据集。可以在这里找到<a class="ae lr" href="https://www.openml.org/d/187" rel="noopener ugc nofollow" target="_blank"/>，但是也可以使用下面的代码直接导入到笔记本中(你需要先安装 Scikit-learn)。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nx ny l"/></div></figure><p id="db4e" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">葡萄酒数据集由葡萄酒类型的许多特征和相应的标签组成。数据集的前几行如下所示。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nz"><img src="../Images/88b34cda96aa62185d627c249ef9f2e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EIL_OwOfKmbH2QxHJt-h7g.png"/></div></div></figure><p id="710e" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">让我们使用 Plotly 后端来稍微探索一下数据集。</p><p id="0f96" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">绘图功能的工作方式与标准的 Pandas 绘图功能非常相似，只是现在可视化以丰富的 Plotly 显示。以下代码绘制了数据集中两个要素之间的关系。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nx ny l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oa"><img src="../Images/63dfe7eaff7ffcf1afcbb240b5c2bf10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2gMvlA-Kxbz3rxImvo2OBw.png"/></div></div></figure><p id="8a38" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">如果我们将鼠标悬停在图表上，可以看到我们可以选择将图表下载为高质量的图像文件。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ob"><img src="../Images/a211ad6a838cbd295a811ecabc1802cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lB4G6CMeTcs511lO31QQKQ.png"/></div></div></figure><p id="5d3d" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我们可以将 Pandas groupby 函数结合起来，创建一个条形图来总结不同类别之间平均色调的差异。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nx ny l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj oc"><img src="../Images/57428bc6a617f7c8b20758d78c540da9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aO1wCGDehYSwshXL9kVLDg.png"/></div></div></figure><p id="d44b" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">让我们向之前创建的散点图中添加类。Plotly 允许您轻松地将不同的颜色应用到每个类，以便我们可以可视化的分离。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nx ny l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj od"><img src="../Images/442052d1201179d6f1273ec94168f4b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8_1hn6i2LEoDbleZxFluFg.png"/></div></div></figure></div><div class="ab cl ls lt hy lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="in io ip iq ir"><h1 id="561f" class="lz ma iu bd mb mc md me mf mg mh mi mj ka mk kb ml kd mm ke mn kg mo kh mp mq bi translated">散景后端</h1><p id="b26e" class="pw-post-body-paragraph kv kw iu kx b ky mr jv la lb ms jy ld le mt lg lh li mu lk ll lm mv lo lp lq in bi translated">Bokeh 是另一个 Python 绘图库，提供丰富的交互式可视化。可视化可以在网络浏览器中查看，嵌入到网络应用程序中，或者用于创建交互式仪表板。Bokeh 甚至有一个流式 API，因此可以为流式数据(如金融市场)创建实时可视化。</p><p id="5cd1" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">熊猫散景的完整文档可以在这里找到<a class="ae lr" href="https://github.com/PatrikHlobil/Pandas-Bokeh" rel="noopener ugc nofollow" target="_blank">。该库可以被 pip 安装<code class="fe nu nv nw mx b">pip install pandas-bokeh</code>。</a></p><p id="0a87" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">为了在 Jupyterlab 中显示散景可视化，我们需要安装两个新的扩展。</p><pre class="kk kl km kn gu mw mx my mz aw na bi"><span id="aece" class="nb ma iu mx b gz nc nd l ne nf">jupyter labextension install @jupyter-widgets/jupyterlab-manager</span><span id="7306" class="nb ma iu mx b gz oe nd l ne nf">jupyter labextension install @bokeh/jupyter_bokeh</span></pre><p id="247b" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">让我们使用散景后端重新创建之前创建的散点图。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nx ny l"/></div></figure><p id="e165" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">可视化如下所示。散景图是自动交互的。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj of"><img src="../Images/2341b59c8d24735bd464f196c09e927e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*yskmKSsR9aYCXTcz4PGDKA.gif"/></div></figure><p id="3b3e" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">散景有一个<a class="ae lr" href="https://docs.bokeh.org/en/latest/docs/user_guide/layout.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kx iv"> plot_grid </strong> </a>功能，可以为多个图表创建类似仪表板的布局。下面的代码以网格布局创建了四个图表—显示在代码下面。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="nx ny l"/></div></figure><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/6588bca4839d5fa4d91b4b22dbc712b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WasTPy2AWbA7gjmyooGdGg.png"/></div></div></figure></div><div class="ab cl ls lt hy lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="in io ip iq ir"><p id="3e0f" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">内置的 Pandas 绘图功能增加了多个第三方后端，大大增强了这个库的数据可视化能力。本文只给出了 Plotly 和 Bokeh 后端的一些功能。如果您仔细阅读文档，您会发现使用这一新功能可以创建丰富的仪表板和 web 应用程序。</p><p id="e94a" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">感谢阅读！</p><p id="51a5" class="pw-post-body-paragraph kv kw iu kx b ky kz jv la lb lc jy ld le lf lg lh li lj lk ll lm ln lo lp lq in bi translated">我每月都会发一份简讯，如果你想加入，请点击此链接注册。期待成为您学习旅程的一部分！T3】</p></div></div>    
</body>
</html>