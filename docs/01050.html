<html>
<head>
<title>Central Limit Theorem Explained with Python Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python代码解释的中心极限定理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/central-limit-theorem-explained-with-python-code-230884d40ce0?source=collection_archive---------6-----------------------#2020-01-30">https://towardsdatascience.com/central-limit-theorem-explained-with-python-code-230884d40ce0?source=collection_archive---------6-----------------------#2020-01-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/68c0ba55e3ab28445c04ff558d57acbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aMLbr2sEbBDJzCn3"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">马文·朗斯多夫在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="2492" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">一个解释中心极限定理的模拟:即使一个样本不是正态分布，如果你抽取多个样本，取它们的每个平均值，这些平均值将代表一个正态分布。</strong></p><p id="4b97" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">条条大路通罗马！等等不要。条条大路通涩谷！等等不要。所有样本平均值都是总体平均值。</p><p id="3107" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://en.wikipedia.org/wiki/Central_limit_theorem" rel="noopener ugc nofollow" target="_blank">中心极限定理</a>表明，如果你随机抽取一个客户样本，比如说1000个客户，这个样本本身可能不是正态分布的。但是如果你现在重复这个实验100次，那么这100个样本(1000个客户)的100个平均值将构成一个正态分布。</p><p id="67b1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一行对我们很重要:“这个样本本身可能不是正态分布的”。为什么？因为生活中的大多数事物都不是正态分布的；不是等级，不是财富，不是食物，当然也不是我们的顾客在我们店里付了多少钱。但是生活中的一切都有泊松分布；更好的是，生活中的一切都可以用狄利克雷分布来解释，但为了简单起见，让我们坚持用泊松分布(泊松分布实际上是狄利克雷分布的简化情况)。</p><p id="6cfd" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但实际上在一个电商店里，我们的客户大部分都是非购买客户。因此，分布实际上看起来像一个指数，因为泊松可以从指数得到，让我们做一些指数分布来反映我们的客户的购买。</p><h1 id="1b6f" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">让我们试一个例子</h1><p id="2096" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">假设我们的客户群的平均订单价值为170美元，那么我们将用这个平均值创建指数分布。我们将尝试通过查看一些样本平均值来获得该值。</p><h2 id="9f6c" class="mh lf it bd lg mi mj dn lk mk ml dp lo kr mm mn ls kv mo mp lw kz mq mr ma ms bi translated">仅抽取四个样本</h2><p id="ee81" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">在这里，我抽取了1000名客户的样本。然后重复4次。我得到了以下四个分布(要得到与此类似的图形，请在末尾使用代码repeat _ sample _ draws _ exponential(4，1000，170，True)):</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mt"><img src="../Images/3f62def67734dd948eb02e69a49155e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zwtGP_Ouk1MVhd6nuak8Fg.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">从1000名顾客中随机抽取4个样本。每个样本都有一个平均值为170美元的指数分布。</p></figure><p id="752d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是绘制的4个平均值(要获得类似的图形，请在结尾处使用代码repeat _ sample _ draws _ exponential(4，1000，170，True)):</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mt"><img src="../Images/1164d969475dbe870a98d75f7103e108.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*57hX8hbjCeedKNwlH_xQiA.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">绘制的四个样本的平均值。</p></figure><p id="81c2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上述4个样本均值的平均值为165.48美元<br/>上述4个样本均值的标准差为5.36美元</p><p id="260f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，如果您在这里停止实验，在四个样本中，您将报告您的客户群的平均订单价值为166美元，其中68% ( <a class="ae kf" href="https://en.wikipedia.org/wiki/Standard_deviation" rel="noopener ugc nofollow" target="_blank"> 1标准差包含68% </a>)的客户购买了161美元到171美元之间的商品(从166+/-$5美元)。这将是一个错误的结论，因为我们所有的这些模拟都是基于最初的假设，即人口平均值是170美元！</p><h2 id="0c7f" class="mh lf it bd lg mi mj dn lk mk ml dp lo kr mm mn ls kv mo mp lw kz mq mr ma ms bi translated">抽取100个样本，但保持每个样本的大小与上述1000个客户相同</h2><p id="6210" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">如果我们重复这个实验100次会发生什么？即抽取1000个客户的100个样本？</p><p id="5abb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在末尾使用代码:<br/>repeat _ sample _ draws _ index(100，1000，170，True)</p><p id="645c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将得到100个类似这样的指数分布(要得到类似的图形，请在末尾使用代码repeat _ sample _ draws _ exponential(100，1000，170，True)):</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mt"><img src="../Images/daa22fb1d18debfb856543197f24ef84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c9sGZq8CALvWYlK4GBhEoQ.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">从1000名顾客中随机抽取100个样本。每个样本都有一个平均值为170美元的指数分布。</p></figure><p id="d6cf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">100个平均值的分布现在看起来像正态分布(要获得类似的图形，请在结尾处使用代码repeat _ sample _ draws _ exponential(100，1000，170，True)):</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mt"><img src="../Images/1a5431f45195f534b3e2f0afd649c99b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7s1JRoGbsw3Ck8B5AaFEAQ.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">绘制的100个样本的平均值。</p></figure><p id="5533" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上述100个样本均值的平均值为169.55美元<br/>上述100个样本均值的标准差为5.18美元</p><p id="506e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，现在您会得出结论，您的客户群的平均支出为170美元(耶！这实际上是我们的第一个假设！)我们68%的客户购买价格在165美元到175美元之间。</p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><h2 id="d19d" class="mh lf it bd lg mi mj dn lk mk ml dp lo kr mm mn ls kv mo mp lw kz mq mr ma ms bi translated">关于标准差的旁注</h2><p id="7f7d" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">注意标准偏差没有变化:当我们抽取4个样本时是5美元，当我们抽取100个样本时是5美元。您可以对10000个样本运行下面的代码，并看到标准偏差不会从$5改变。这是为什么呢？</p><p id="7ec2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就把我们带到了经常被忽视的中心极限定理的第二部分:样本均值的标准差等于总体的标准差除以样本大小的平方根。</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/59718c2e6b65dd189df1f21463d94627.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*dCxzo7E6lmKxHLEg2xZSoQ.png"/></div></figure><p id="e06c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的人口是平均170美元的指数分布。指数有一个特殊的性质，即它的标准差等于它的平均值，所以总体平均值的标准差是170美元。因此，在这种情况下，我们预计样本均值的标准差为170/sqrt(1000) = 5.4</p><p id="b562" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是我们得到的结果，样本的标准差——意味着大约是5美元。无论我们重复抽样多少次，标准偏差都不会改变，因为它只取决于<strong class="ki iu">样本量</strong>(它也取决于总体平均值，但对于给定的总体来说，它保持不变)<strong class="ki iu">。</strong></p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><h1 id="63a1" class="le lf it bd lg lh ng lj lk ll nh ln lo lp ni lr ls lt nj lv lw lx nk lz ma mb bi translated">结论</h1><p id="9f74" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">这就是中心极限定理。抽取的样本越多，就越能准确预测总体均值。我们不可能测试/调查我们所有的客户(或我们所有的人群)，所以我们能做的下一个最好的事情是抽取几个较小数量的样本，并得到这些平均值的平均值。这里的关键是尽可能多地抽取样本。当我们这样做时，我们有:</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/7d6073f7930c0853997c5afbb52511b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*RdIQG331j0tayi50asTOIw.png"/></div></figure><p id="b3e2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">而样本均值分布的标准差会随着你增加你的<strong class="ki iu">样本量</strong>而改变(样本量不是样本数；在我们的示例中，样本大小为1000，样本数量为100):</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/59718c2e6b65dd189df1f21463d94627.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*dCxzo7E6lmKxHLEg2xZSoQ.png"/></div></figure></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><p id="9fae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae kf" href="https://medium.com/@sujeewak/basic-elements-of-a-b-testing-with-python-code-to-simulate-2b7f342f5ac6" rel="noopener">在以后的帖子里，我会描述为什么这是A/B测试中的一个重要概念</a>。</p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><p id="6137" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">代码重现了这一点:</p><pre class="mu mv mw mx gt nm nn no np aw nq bi"><span id="672d" class="mh lf it nn b gy nr ns l nt nu"><strong class="nn iu">import </strong>numpy <strong class="nn iu">as </strong>np<br/><strong class="nn iu">import </strong>matplotlib.pyplot <strong class="nn iu">as </strong>plt<br/><br/><strong class="nn iu">def </strong>repeat_sample_draws_exponential(n, samp_size, mu, show_all=<strong class="nn iu">False</strong>):<br/>    means = []<br/><br/>    samples = []<br/>    <strong class="nn iu">for </strong>ii <strong class="nn iu">in </strong>range(0, n):<br/>        samples.append(np.random.exponential(mu, samp_size))<br/>        means.append(np.mean(samples[ii]))<br/><br/>    <strong class="nn iu">if </strong>show_all:<br/>        pltdim = np.math.ceil(np.math.sqrt(n))<br/>        fig, axs = plt.subplots(pltdim, pltdim, figsize=(8, 8), gridspec_kw={<strong class="nn iu">'hspace'</strong>: 0.2}, sharex=<strong class="nn iu">True</strong>, sharey=<strong class="nn iu">True</strong>)<br/>        fig.suptitle(<strong class="nn iu">'Individual Samples\' Order Value Distribution'</strong>)<br/>        fig.text(0.5, 0.04, <strong class="nn iu">'Order Values ($)'</strong>, ha=<strong class="nn iu">'center'</strong>)<br/>        fig.text(0.04, 0.5, <strong class="nn iu">'Number of Customers'</strong>, ha=<strong class="nn iu">'center'</strong>, rotation=<strong class="nn iu">'vertical'</strong>)<br/>        axs = axs.flatten()<br/>        <strong class="nn iu">for </strong>ii <strong class="nn iu">in </strong>range(0, n):<br/><br/>            plt.sca(axs[ii])<br/><br/>            plt.gca().hist(samples[ii], bins=int(50), histtype=<strong class="nn iu">'step'</strong>,<br/>                           label=<strong class="nn iu">'$mean = {0:.2f}$'</strong>.format(np.mean(samples[ii])), range=[0, 2 * mu])<br/>            <strong class="nn iu">if </strong>n &lt; 10:<br/>                plt.gca().set_title(<strong class="nn iu">'Sample #{0} : average={1:.2f}'</strong>.format(ii, np.mean(samples[ii])))<br/>            <strong class="nn iu">for </strong>item <strong class="nn iu">in </strong>([axs[ii].title, axs[ii].xaxis.label, axs[ii].yaxis.label] +<br/>                             axs[ii].get_xticklabels() + axs[ii].get_yticklabels()):<br/>                item.set_fontsize(8)<br/><br/>        plt.savefig(<strong class="nn iu">'expdist_{0}_mu_{1}_sample_{2}_sampsize'</strong>.format(mu, n, samp_size))<br/><br/>    plt.clf()<br/>    plt.hist(means, bins=int(10), histtype=<strong class="nn iu">'step'</strong>)<br/>    plt.title(<strong class="nn iu">'Overall Average of {} Samples\' Average Order Value'</strong>.format(n))<br/>    plt.xlabel(<strong class="nn iu">'Average of Individual Sample\'s Order Value ($)'</strong>)<br/>    plt.savefig(<strong class="nn iu">'average_of_expdist_{0}_mu_{1}_sample_{2}_sampsize'</strong>.format(mu, n, samp_size))<br/>    print(<strong class="nn iu">'mean of the samples is {0:.2f}'</strong>.format(np.mean(means)))<br/>    print(<strong class="nn iu">'standard deviation of the samples is {0:.2f}'</strong>.format(np.std(means)))<br/><br/>repeat_sample_draws_exponential(100, 1000, 170, <strong class="nn iu">True</strong>)</span></pre></div></div>    
</body>
</html>