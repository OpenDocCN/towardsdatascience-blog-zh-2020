<html>
<head>
<title>MedCAT | Introduction — Analyzing Electronic Health Records</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MedCAT |简介—分析电子健康记录</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/medcat-introduction-analyzing-electronic-health-records-e1c420afa13a?source=collection_archive---------16-----------------------#2020-04-04">https://towardsdatascience.com/medcat-introduction-analyzing-electronic-health-records-e1c420afa13a?source=collection_archive---------16-----------------------#2020-04-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/afe58e10e89940c86ecd2990ae5c3e6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c6hj2y8uLuEBee16l8dILg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@hush52" rel="noopener ugc nofollow" target="_blank"> Hush Naidoo </a>在U<a class="ae jg" href="https://unsplash.com/photos/yo01Z-9HQAw" rel="noopener ugc nofollow" target="_blank">n spash</a>上拍摄。</p></figure><div class=""/><div class=""><h2 id="c8ac" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">介绍如何使用<a class="ae jg" href="https://github.com/CogStack/MedCAT" rel="noopener ugc nofollow" target="_blank"> MedCAT </a>组织、构建和分析电子健康档案(EHRs)。例如，MedCAT用于最近一项关于<a class="ae jg" href="https://www.researchgate.net/publication/340261837_Treatment_with_ACE-inhibitors_is_associated_with_less_severe_disease_with_SARS-Covid-19_infection_in_a_multi-site_UK_acute_Hospital_Trust" rel="noopener ugc nofollow" target="_blank"> ACE抑制剂和CoVid-2019 </a>的研究。</h2></div><p id="87e5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">电子病历是医疗信息的宝库；它们包含了令人难以置信的大量知识。提几个通常每个病人都有的数据点:(1)有症状的疾病；(2)药物治疗，通常伴有剂量说明、最终副作用和患者反馈；(3)治疗，有时有患者的反馈；(4)来自临床医生的风险、假设和意见；(5)病人的证词；(6)各种测量和实验室结果。</p><p id="f937" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在处理EHR时，我们首先需要构建和组织它们。它们包含的信息通常以非结构化格式(自由文本)提供。对于医生来说，这个相对还可以；他们可以阅读文档并获得他们需要的信息。但是，如果我们想要使用数据进行统计分析或机器学习，没有结构是有挑战性的。</p><p id="d9db" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">给定一个结构化的EHR，一些可能的研究用例是(1)死亡率预测；(2)疾病风险计算；(3)临床编码；(4)疾病或患者的时间模型；(5)疾病/药物相互作用；(6)药物不良反应的检测；</p><p id="3706" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当然，我并不是第一个理解电子病历中的可用数据对病人和医疗机构都有很大好处的人。最近，我们已经看到谷歌健康(数据聚合工具)、亚马逊(他们的理解医疗)和许多其他公司的大动作。虽然很高兴看到大公司了解EHR的价值，但他们需要很长时间才能完全访问医院数据(隐私问题)。最后，即使他们获得了访问权，它是否能促进研究项目或帮助病人也是值得怀疑的。</p><p id="2e2b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我在这里的目标是展示，使用像<a class="ae jg" href="https://github.com/CogStack/MedCAT" rel="noopener ugc nofollow" target="_blank"><strong class="la jk">【MedCAT】</strong></a><strong class="la jk">这样的工具，我们可以在几个小时内在一台个人笔记本电脑上构建大型医院的电子病历，而不需要大型服务器和基础设施。有了这个，我们就有可能启动/进行能够改善医疗保健的研究项目。</strong></p><p id="b6d1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这篇文章的其余部分组织如下。首先，我们将定义一个用于展示<a class="ae jg" href="https://github.com/CogStack/MedCAT" rel="noopener ugc nofollow" target="_blank"> MedCAT </a>的小项目。其次，我们将看看我们正在使用的数据集。第三，我们将检查环境设置。</p><p id="1c6e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">请注意</strong>:(2)我不会分享任何医疗数据集，但会显示在哪里以及如何访问/获取它们；(3)一些统计学和机器学习的知识会有帮助，但不是必须的；(4)我们这里关注的是EHR，同样的方法可以用于其他类型的文档，但是目前，该工具主要在生物医学文档上进行测试。</p><h1 id="dd4c" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated"><a class="ae jg" href="https://github.com/CogStack/MedCAT/tree/master/tutorial" rel="noopener ugc nofollow" target="_blank"> MedCAT教程概述</a></h1><p id="7221" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">本教程中的每一篇文章都是独立的文章，但仍然建立在同一个故事之上。随意跳转到你感兴趣的帖子，它应该很容易跟踪和理解(链接将随着教程的发布而更新)。</p><ol class=""><li id="5b15" class="mr ms jj la b lb lc le lf lh mt ll mu lp mv lt mw mx my mz bi translated"><strong class="la jk">简介</strong> —本岗位</li><li id="2fb5" class="mr ms jj la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/medcat-dataset-analysis-and-preparation-be8bc910bd6d"/></li><li id="718c" class="mr ms jj la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/medcat-extracting-diseases-from-electronic-health-records-f53c45b3d1c1"> <strong class="la jk">从电子健康档案中提取疾病</strong> </a> <strong class="la jk"> </strong> —深入探究Python中的MedCAT库以及命名实体识别和医疗概念的链接。如果您只对如何使用MedCAT感兴趣，这很有用。</li><li id="d63e" class="mr ms jj la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><strong class="la jk">监督培训和完整的MedCAT管道</strong> —探索MedCAT库的更高级部分，以及如何为NER+L &amp;元注释构建完整的管道。</li><li id="f879" class="mr ms jj la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/prevalence-of-physical-and-mental-diseases-450c0f4f5851"> <strong class="la jk">分析结果</strong> </a> <strong class="la jk"> </strong> —这是我们从电子健康记录中提取出感兴趣的实体后可能实现的一个例子。</li><li id="f238" class="mr ms jj la b lb na le nb lh nc ll nd lp ne lt mw mx my mz bi translated"><strong class="la jk">med cat库的其他工具和功能(ICD10代码，SNOMED CT) &amp;未来的期望</strong></li></ol><h1 id="85c7" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">简介—项目定义</h1><p id="7247" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">让我们看一个例子。假设我们访问了一家大型医院的数据库，该医院的每个患者都有一个包含大量自由文本的EHR(下面的文档示例，您可以在<a class="ae jg" href="https://www.mtsamples.com/" rel="noopener ugc nofollow" target="_blank"> mtsamples </a>找到更多)。除此之外，每个EHR还包括几个结构化字段，如年龄、性别和种族。现在，假设我们的项目是展示疾病与年龄之间的<strong class="la jk">关系(可以用来计算与年龄相关的疾病风险分值)。为了做到这一点，我们需要知道每个患者的年龄，以及在他的EHR中出现的疾病。提取年龄很容易，这是一个结构化的领域，但问题是疾病。它们只在自由文本中被提及，通常不会在其他地方出现。在继续之前，我们需要从每个EHR中提取疾病，并将它们保存在结构化数据库中。</strong></p><p id="11cd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">请注意</strong> : (1)疾病提取问题还有更多的内容，但我们会继续扩展。(2)疾病只是一个例子，我们可以用药物、症状、程序或任何其他东西来做同样的事情。</p><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nf"><img src="../Images/74309853bd6454312de00ba7082341dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ic7o3tuHXzOcKjZqEX8DUg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">一个EHR的假例子，请注意，尽管这是自由文本，但它明显比真正的EHR更结构化，阅读/理解起来是一场灾难。</p></figure><h2 id="545c" class="nk lv jj bd lw nl nm dn ma nn no dp me lh np nq mg ll nr ns mi lp nt nu mk nv bi translated">疾病提取问题的正式定义</h2><p id="1d6e" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">我们想要实现的在自然语言处理(NLP)中被称为命名实体检测和链接(NER+L)。NER意味着检测文本中的实体(例如医学术语，图1中的第二步)。而L意味着将被识别的实体链接到生物医学数据库中的概念(例如<a class="ae jg" href="https://www.nlm.nih.gov/research/umls/index.html" rel="noopener ugc nofollow" target="_blank"> UMLS </a>，图1中的第三步)。</p><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nw"><img src="../Images/d7b38eb92e50d96efa82b989ea399dee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aoexKMpXyZfYg0kK6LKGtQ.png"/></div></div></figure><p id="e10d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">链接部分是必不可少的，因为它允许我们标准化和组织被检测的实体，因为多个被识别的实体可以链接到生物医学数据库中的相同医学概念。例如，在EHR中，我们可以有:</p><ul class=""><li id="7d1d" class="mr ms jj la b lb lc le lf lh mt ll mu lp mv lt nx mx my mz bi translated">患者被诊断患有<strong class="la jk">乳腺恶性肿瘤</strong> …</li><li id="2650" class="mr ms jj la b lb na le nb lh nc ll nd lp ne lt nx mx my mz bi translated">既往病史包括<strong class="la jk">乳腺癌</strong> …</li><li id="0ee1" class="mr ms jj la b lb na le nb lh nc ll nd lp ne lt nx mx my mz bi translated">入院原因:<strong class="la jk">乳腺癌</strong> …</li></ul><p id="4012" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每一个粗体的概念都是相同的疾病，只是书写方式不同。如果我们不对检测到的实体进行标准化，将很难计算例如有多少患者患有乳腺癌的统计数据。</p><p id="6e99" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，如果我们将一个实体链接到一个生物医学数据库，我们就可以访问该数据库中的所有结构化字段(图2)。</p><figure class="ng nh ni nj gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ny"><img src="../Images/967f7d3c39b25ed4a68b642fe91b6b1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pw9pS3PC-ThFYXX3BDBL6g.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">生物医学数据库的一小部分(UMLS)。</p></figure><p id="6878" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦我们检测到实体并将其链接到我们的生物医学数据库，我们就可以，例如，基于<code class="fe nz oa ob oc b">Semantic Type</code>字段过滤实体，或者找到所有链接到ID为<code class="fe nz oa ob oc b">C0006142</code>的生物医学概念的实体。在UMLS可以找到所有语义类型的概述<a class="ae jg" href="https://metamap.nlm.nih.gov/Docs/SemanticTypes_2018AB.txt" rel="noopener ugc nofollow" target="_blank">这里</a>(注意，其中一个语义类型是<em class="od">疾病</em>，这正是我们需要的)。</p><p id="2e99" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">请注意:</strong> (1)对于生物医学数据库，我们将使用UMLS，因为它是最大的数据库，拥有超过420万个医学概念。还有许多其他生物医学数据库，但UMLS完全符合我们的需求，因为我们希望提取所有可能的疾病。</p><h1 id="9476" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">数据集——MIMIC-III</h1><p id="9a2f" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated"><a class="ae jg" href="https://mimic.physionet.org/about/mimic/" rel="noopener ugc nofollow" target="_blank"> MIMIC-III </a>是一个公开可用的数据集，由麻省理工学院计算生理学实验室开发。它包括临床笔记，人口统计，生命体征，实验室测试等。</p><p id="9e5a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我选择了这个数据集，因为它是唯一公开的包含EHR的数据集之一。数据集不能直接下载，但需要先<a class="ae jg" href="https://mimic.physionet.org/gettingstarted/access/" rel="noopener ugc nofollow" target="_blank">提交请求</a>——通常会在几天内获得批准。</p><h1 id="7b98" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">环境设置(如果在本地运行)</h1><p id="bcdd" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">我们将使用Python作为主要编程语言，稍后，一些情节将使用R或在JavaScript的帮助下完成，但这主要是为了让它们更有趣。</p><p id="45ce" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我将使用python 3.7做任何事情，很可能3.5以上的版本会很好。</p><p id="140e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您正在本地机器上学习本教程，建议使用以下命令启动一个新的Python虚拟环境:</p><pre class="ng nh ni nj gt oe oc of og aw oh bi"><span id="942f" class="nk lv jj oc b gy oi oj l ok ol">python3 -m venv medcat</span></pre><p id="60b0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦完成，您就可以克隆<a class="ae jg" href="https://github.com/CogStack/MedCAT" rel="noopener ugc nofollow" target="_blank"> MedCAT存储库</a>并进入<code class="fe nz oa ob oc b">tutorial</code>目录。从那里运行(不要忘记激活<code class="fe nz oa ob oc b">medcat</code>环境):</p><pre class="ng nh ni nj gt oe oc of og aw oh bi"><span id="5c38" class="nk lv jj oc b gy oi oj l ok ol">pip install -r requirements</span></pre><p id="7edf" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于MedCAT构建在SpaCy/SciSpaCy之上，您还需要使用以下命令下载语言模型:</p><pre class="ng nh ni nj gt oe oc of og aw oh bi"><span id="85b6" class="nk lv jj oc b gy oi oj l ok ol">pip install <a class="ae jg" href="https://s3-us-west-2.amazonaws.com/ai2-s2-scispacy/releases/v0.2.4/en_core_sci_md-0.2.4.tar.gz" rel="noopener ugc nofollow" target="_blank">https://s3-us-west-2.amazonaws.com/ai2-s2-scispacy/releases/v0.2.4/en_core_sci_md-0.2.4.tar.gz</a></span></pre><h1 id="a995" class="lu lv jj bd lw lx ly lz ma mb mc md me kp mf kq mg ks mh kt mi kv mj kw mk ml bi translated">Google Colab</h1><p id="d494" class="pw-post-body-paragraph ky kz jj la b lb mm kk ld le mn kn lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">所有的代码也可以在Google Colab上找到，你可以在<a class="ae jg" href="https://github.com/CogStack/MedCAT/tree/master/tutorial" rel="noopener ugc nofollow" target="_blank">库</a>的<code class="fe nz oa ob oc b">tutorial</code>部分找到笔记本的链接。这是遵循本教程的最简单的方法，因为一切都已经配置好了。但是，请注意，Colabs不会使用真实数据(MIMIC-III)，而只会使用公开可用的数据集和生成的虚拟数据。</p></div></div>    
</body>
</html>