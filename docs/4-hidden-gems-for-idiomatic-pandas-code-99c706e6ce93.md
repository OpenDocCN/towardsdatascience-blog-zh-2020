# åœ°é“ç†ŠçŒ«ä»£ç çš„ 4 ä¸ªéšè—çš„å®çŸ³

> åŸæ–‡ï¼š<https://towardsdatascience.com/4-hidden-gems-for-idiomatic-pandas-code-99c706e6ce93?source=collection_archive---------24----------------------->

![](img/e0bd3ac313b98ec796d3f305a9259332.png)

å›¾ç‰‡æ¥æº:[åƒç´ ](https://www.pexels.com/photo/woman-holding-six-polished-stones-1147946/)

## åˆ†äº«æ›´å¤šç†ŠçŒ«æç¤ºæ¥æé«˜ä½ çš„æ•°æ®å¤„ç†æ°´å¹³

æˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œ[ç†ŠçŒ«çš„ 6 ä¸ªé²œä¸ºäººçŸ¥ä½†ä»¤äººæ•¬ç•çš„æŠ€å·§](/6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8)ï¼Œå¸Œæœ›å·²ç»ç»™ä½ ä¸€äº›ç†ŠçŒ«é«˜æ•ˆç¼–ç çš„å‘³é“ã€‚ç»§ç»­è¿™ä¸ªè¯é¢˜ï¼Œå¦‚æœä½ è¿˜ä¸çŸ¥é“çš„è¯ï¼Œè®©æˆ‘ä»¬æ¥æ¢ç´¢æ›´å¤šå…³äºç†ŠçŒ«çš„å°æŠ€å·§å’Œçªé—¨ã€‚

è¿™ç¯‡åšå®¢å°†ä½¿ç”¨æˆ‘ä»¬åœ¨[ä¸Šä¸€ç¯‡åšå®¢](/6-lesser-nown-yet-awesome-tricks-in-pandas-32236f3785c8)ä¸­è®¨è®ºè¿‡çš„ html æŠ€å·§ï¼Œä½¿ç”¨ç›´æ¥ä»ç»´åŸºé¡µé¢[é£Ÿç‰©è¥å…»æˆåˆ†è¡¨](https://en.wikipedia.org/wiki/Table_of_food_nutrients)ä¸­æŠ“å–çš„ä¹³åˆ¶å“è¡¨ã€‚è¿™æ˜¯ä¸€å¼ è¡¨æ ¼çš„å¿«ç…§ï¼Œæ˜¾ç¤ºäº†é£Ÿç‰©åç§°ã€åº¦é‡å•ä½/å…‹æ•°ä»¥åŠç›¸åº”çš„çƒ­é‡å€¼ã€‚

![](img/e5ffe1f843d58ff5940e4da4b0b31794.png)

**1ã€‚** `**Pandas series**` **æˆ–** `**list**` **æˆ–** `**series of lists**`

ç®€å•æ¥è¯´ï¼ŒPandas ä¸­çš„ series æ˜¯ä¸€ä¸ªå¸¦æœ‰ç´¢å¼•æ ‡ç­¾çš„ä¸€ç»´æ•°ç»„ã€‚ä¸è®¾è®¡ç”¨äºæŒ‡ç¤ºå…ƒç´ ä½ç½®çš„åˆ—è¡¨ç´¢å¼•ä¸åŒï¼Œåºåˆ—ä¸­çš„ç´¢å¼•æ ‡ç­¾å¯ä»¥æ˜¯ç”¨æˆ·å®šä¹‰çš„ä»»ä½•å†…å®¹ã€‚è¿™å½“ç„¶åœ¨ä½¿ç”¨åºåˆ—æ—¶æä¾›äº†çµæ´»æ€§ï¼Œä½†æ˜¯å¦‚æœä½ ä¸ç†Ÿæ‚‰ç´¢å¼•æ ‡ç­¾åœ¨ pandas ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè¿™ä¹Ÿâ€œè®¾ç½®äº†ä¸€ä¸ªé™·é˜±â€ã€‚

æ‰€ä»¥æˆ‘ä»¬ä»Šå¤©çš„ä»»åŠ¡#1 æ˜¯æ£€æŸ¥ä¸€ä¸ªå€¼(ä¾‹å¦‚ï¼Œ`skim, instant`)æ˜¯å¦å­˜åœ¨äºä¸€ä¸ªåºåˆ—ä¸­(ä¾‹å¦‚ï¼Œ`dairy_table[â€˜Foodâ€™]`)ã€‚å¦‚æœæ˜¯ï¼Œåˆ™è¿”å› true å¦åˆ™ä¸ºå‡ã€‚å¾ˆç®€å•ï¼Œè¿™ä¸ªä»»åŠ¡åªéœ€è¦ä¸€è¡Œä»£ç ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ

æƒŠè®¶å’Œå›°æƒ‘ï¼Ÿç”¨æœ€ç›´è§‚çš„ `in` æ“ä½œç¬¦ï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä»£ç è¿”å›**å‡**ï¼Œç„¶è€Œç¬¬äºŒä¸ªä»£ç è¿”å›**çœŸ**ï¼Ÿä¸ºä»€ä¹ˆ Python å‘Šè¯‰æˆ‘**é£Ÿç‰©**ä¸€æ ä¸å«`skim, instant`ï¼Œå«`index6`ï¼Ÿ

å—¯ï¼ŒåŸå› æ˜¯ä½¿ç”¨`in`ç›´æ¥æ£€æŸ¥ç†ŠçŒ«ç³»åˆ—å°†æ£€æŸ¥`skim, instant`æ˜¯å¦å­˜åœ¨äº**ç´¢å¼•**æ ‡ç­¾ä¸­ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬çš„é£Ÿç‰©åˆ—çš„**å€¼**ã€‚å› æ­¤ï¼Œä¸ºäº†é¿å…è½å…¥è¿™ä¸ªâ€œé™·é˜±â€ï¼Œæˆ‘ä»¬å¿…é¡»æŒ‡å®š**å€¼/å€¼åˆ—è¡¨**ä½œä¸ºæˆ‘ä»¬çš„æœç´¢ç©ºé—´ï¼Œä¸‹é¢æ¼”ç¤ºäº†å‡ ç§æ–¹æ³•ï¼Œ

å½“åœ¨ Pandas ä¸­å¤„ç†ç³»åˆ—æ—¶ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªæ½œåœ¨çš„â€œé™·é˜±â€,ä¹Ÿå°±æ˜¯è¯´ï¼Œå…è®¸ä¸€ä¸ªå•ç‹¬çš„ç³»åˆ—åŒ…å«åˆ—è¡¨/å…ƒç»„ï¼Œå¹¶ä¸”éœ€è¦é¢å¤–çš„æ­¥éª¤å°†å®ƒä»¬è§£æåˆ°å®ƒä»¬è‡ªå·±çš„åˆ—ä¸­ã€‚ä¾‹å¦‚ï¼Œè®©æˆ‘ä»¬å°†æˆ‘ä»¬çš„ dairy è¡¨ä¿®æ”¹ä¸ºä¸€ä¸ªåŒ…å«å€¼å…ƒç»„çš„æ•°æ®å¸§ï¼Œä½œä¸ºä¸€ä¸ªæ–°çš„åˆ— **Nums** ï¼Œ

ç°åœ¨ï¼Œæˆ‘ä»¬çš„ä»»åŠ¡#2 æ˜¯å°† **Nums** åˆ—åˆ†æˆä¸¤ä¸ªå•ç‹¬çš„åˆ—ã€‚åŒæ ·ï¼Œæœ€ç›´è§‚çš„æ–¹å¼æ˜¯é€šè¿‡ç´¢å¼•æ¥è®¿é—®å…ƒç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œ

å½“ç„¶ï¼Œå¯¹äºæ¯ä¸ªå…ƒç»„ä¸­åªæœ‰ä¸¤ä¸ªå€¼çš„ä¾‹å­æ¥è¯´ï¼Œè¿™æ˜¯å¯è¡Œçš„ã€‚å¦‚æœæˆ‘ä»¬æœ‰æ•°ç™¾ä¸ªå€¼ï¼Œè€Œæ— æ³•æ‰‹åŠ¨è®¿é—®æ¯ä¸ªå…ƒç´ ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿå¦å¤–ï¼Œæ­£å¦‚æˆ‘ä»¬ä»è¾“å‡ºä¸­çœ‹åˆ°çš„ï¼Œè¿™ä¸ª list comprehension è¿”å›ä¸€ä¸ªå¿…é¡»è¿›ä¸€æ­¥è½¬æ¢ä¸ºæ•´æ•°å€¼çš„å­—ç¬¦ä¸²åˆ—è¡¨ã€‚ç›¸å½“å¤šçš„åŸºæœ¬ç»†èŠ‚ï¼

é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ¥å®ç°å®ƒå‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œè€Œä¸”éå¸¸ç®€å•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ

**** * *æ›´æ–° 2022:åŠ å…¥æˆ‘ä»¬çš„ YouTube ç¤¾åŒºğŸ¦*** [***ã€æ•°æ®è¯´è¯å¸¦å‰ã€‘***](https://www.youtube.com/channel/UCbGx9Om38Ywlqi0x8RljNdw) ***ğŸ˜„***

**2ã€‚å®æ»¨å€¼æ½‡æ´’åœ°ç”¨** `**map**` **æˆ–** `**applymap**`

æˆ‘ä»¬çš„ä»»åŠ¡#3 æ˜¯å°†é£Ÿç‰©å€¼åˆ†ä¸ºä¸‰ç±»â€”â€”ç‰›å¥¶ã€å¸ƒä¸å’Œå¥¶æ²¹ï¼Œå®šä¹‰å¦‚ä¸‹:

![](img/51f32c619d05f7200db224643f8da482.png)

ä¸å…¶å•è°ƒä¹å‘³åœ°åˆ›å»ºå¤šä¸ª`if`è¯­å¥æˆ–`isin()`å‡½æ•°ï¼Œä¸å¦‚é€šè¿‡åˆ©ç”¨æ˜ å°„æŠ€å·§ä»¥æ›´æ™ºèƒ½çš„æ–¹å¼æ¥å®ç°ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†å€¼ç»„ç»‡åˆ°ä¸€ä¸ªæ˜ å°„å­—å…¸ä¸­ï¼Œå…¶ä¸­æ¯ä¸ªå€¼å±äºå…¶å¯¹åº”çš„ binï¼Œ

ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨`map`æˆ–`applymap`æ¥æ›¿æ¢åŸå§‹å€¼ï¼Œ

è¿™é‡Œæœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„:

(1)æˆ‘ä»¬äº¤æ¢äº†åŸå§‹æ˜ å°„å­—å…¸ä¸­çš„é”®å’Œå€¼ï¼Œä»¥ä¾¿å®ƒçš„é”®ä¸æ•°æ®é›†ä¸­çš„å®é™…é£Ÿç‰©åç§°åŒ¹é…ã€‚

(2)æˆ‘ä»¬æ¼”ç¤ºäº†ä¸¤ç§å®ç°æ–¹å¼:`map`å’Œ`applymap`ï¼Œæˆ‘ç»å¸¸è¢«é—®åˆ°è¿™ä¸¤ä¸ªæ¦‚å¿µçš„åŒºåˆ«ã€‚ç®€å•æ¥è¯´ï¼Œ`**map**` å–å…¥å¹¶è¿”å›**ç³»åˆ—**ï¼Œè€Œ`**applymap**`å–å…¥å¹¶è¿”å›**æ•°æ®å¸§**ã€‚ä¾‹å¦‚ï¼Œä¸Šé¢ä»£ç ä¸­çš„`map()`å‡½æ•°ç”¨äº*é£Ÿç‰©*åºåˆ—ï¼Œå®ƒç”¨åºåˆ—æ–¹æ³•`fillna()`å°†å­—å…¸ä¸­æ²¡æœ‰çš„å€¼é‡æ–°ç¼–ç ä¸º*â€˜å…¶ä»–â€™*ã€‚

ç›¸æ¯”ä¹‹ä¸‹ï¼Œç¬¬äºŒä¸ªå‡½æ•°`applymap()`ç”¨äºæ•´ä¸ªæ•°æ®å¸§ï¼Œæœç´¢ä¸å­—å…¸å…³é”®å­—åŒ¹é…çš„å€¼(å³é£Ÿç‰©åç§°)ï¼Œç„¶åç”¨ç›¸åº”çš„å­—å…¸å€¼(å³ bin åç§°)æ›¿æ¢å®ƒä»¬ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„é”®ï¼Œä»£ç å°†ä¿æŒåŸå§‹å€¼ä¸å˜ã€‚

å› æ­¤ï¼Œ`map()`æˆ–`applymap()`éƒ½å¯ä»¥å·¥ä½œï¼Œä¸Šé¢çš„ä¸€è¡Œä»£ç å†™èµ·æ¥ç®€æ´ä¸”æ˜“äºç»´æŠ¤ï¼Œæ›´ä¸ç”¨è¯´å®ƒåº”è¯¥æ¯”éå†æ¯ä¸ªé£Ÿç‰©åç§°çš„ç»„è¦å¿«å¾—å¤šã€‚

**3ã€‚** `**where**` **ç”¨ä½œç›¸å½“äº** `**ifelse**` **ä¸­çš„ R**

R ä¸­æˆ‘æœ€å–œæ¬¢çš„ä¸€ä¸ªå‡½æ•°æ˜¯`ifelse`ï¼›ç±»ä¼¼åœ°ï¼ŒPandas æä¾›äº†`where`å‡½æ•°æ¥åšåŒæ ·çš„äº‹æƒ…:å½“æŒ‡å®šçš„å¸ƒå°”æ¡ä»¶ä¸æ»¡è¶³æ—¶æ›¿æ¢å€¼ã€‚

ä¾‹å¦‚ï¼Œä¸‹é¢æ˜¾ç¤ºäº†ä¸€ä¸ªé£Ÿå“åç§°åˆ—è¡¨ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ç”¨*â€˜å…¶ä»–â€™*æ›¿æ¢åˆ—è¡¨ä¸­çœç•¥çš„é£Ÿå“åç§°ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹`where(other)`å¦‚ä½•æ–¹ä¾¿åœ°å®Œæˆè¿™ä¸ªæ•°æ®æ“ä½œä»»åŠ¡ï¼Œ

**4ã€‚**ç±»å‹`**category**` ç±»å‹**ä¿å­˜å†…å­˜**

æœ€åä½†åŒæ ·é‡è¦çš„æ˜¯ï¼Œæˆ‘æƒ³è®¨è®ºä¸€ä¸ªå…³äº Pandas ä¸­çš„**åˆ†ç±»**æ•°æ®ç±»å‹çš„æŠ€å·§ï¼Œè¿™æ˜¯ä¸º**å¯¹è±¡**æ•°æ®èŠ‚çœç©ºé—´çš„å¦ä¸€ç§é€‰æ‹©ã€‚ä¿å­˜ä¸º`object-dtype`çš„å­—ç¬¦ä¸²é€šå¸¸ä¼šå ç”¨å¤§é‡å†…å­˜ï¼Œè€Œ`category-dtype`åœ¨åç«¯ä½¿ç”¨æ•´æ•°å€¼æ¥è¡¨ç¤ºåŸå§‹å€¼ï¼Œå› æ­¤æ›´èŠ‚çœç©ºé—´å’Œæ—¶é—´ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„ object-dtype**Food _ Category**åˆ—ï¼Œ

è¿™é‡Œæœ‰å‡ ä¸ªæ³¨æ„äº‹é¡¹ï¼Œ(1)ä¸€æ—¦è¢«è½¬æ¢ä¸ºç±»åˆ«ç±»å‹ï¼Œ **Food_Category** è¢«ç¼–ç ä¸ºæ•´æ•°ï¼›(2)é€šè¿‡å°†å¯¹è±¡æ•°æ®ç±»å‹è½¬æ¢æˆç±»åˆ«æ•°æ®ç±»å‹ï¼Œå­˜å‚¨å™¨ä½¿ç”¨ä» 1051 å­—èŠ‚å‡å°‘åˆ° 427 å­—èŠ‚(å³ï¼Œå‡å°‘ 60%)ã€‚

ç„¶è€Œï¼Œå…³äº category-dtype çš„ä¸¤ä¸ªè­¦å‘Šä¸èƒ½è¢«å¿½ç•¥ã€‚é¦–å…ˆï¼Œå°±åƒ R ä¸­çš„`factors`ï¼Œ`category-dtype`åœ¨æ–°å€¼èµ‹å€¼æ–¹é¢ä¸åƒ`object-dtype`é‚£æ ·çµæ´»ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³ç”¨ä¸‹é¢çš„ä»£ç å‘ **Food_Category** åˆ—æ·»åŠ ä¸€ä¸ªæ–°çš„ç±»åˆ«/çº§åˆ«ï¼Œæˆ‘ä»¬å°†å¾—åˆ°è‡­åæ˜­è‘—çš„ ValueError msgã€‚è¯¥é”™è¯¯æŒ‡ç¤ºæ–°çº§åˆ«(å³ï¼Œå¦ä¸€ä¸ª _ ç±»åˆ«)åœ¨è¢«åˆ†é…ç»™ä»»ä½•è¡Œä¹‹å‰å¿…é¡»é¦–å…ˆè¢«æ·»åŠ åˆ°å®¹å™¨ä¸­ï¼Œ

å› æ­¤ï¼Œæ­£ç¡®çš„æ–¹æ³•æ˜¯é¦–å…ˆä½¿ç”¨`add_categories()`æ–¹æ³•è®¾ç½®ç”µå¹³å€¼ï¼Œ

å…³äº`category-dtype`çš„å¦ä¸€ä¸ªè­¦å‘Šæ˜¯ï¼Œå¯¹äºå…·æœ‰è¾ƒå°‘é‡å¤å€¼çš„åˆ—ï¼Œæç«¯æƒ…å†µæ˜¯æ‰€æœ‰çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œ`category-dtype`å°†æ¯”`object-dtype`å ç”¨æ›´å¤šçš„å†…å­˜ã€‚è®©æˆ‘ä»¬ä»¥**é£Ÿç‰©**åˆ—ä¸ºä¾‹ï¼Œè¿™é‡Œæ‰€æœ‰çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œ

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸€æ—¦**é£Ÿç‰©**åˆ—è¢«è½¬æ¢ä¸º`category-dtype`ï¼Œmemory_usage ä» 1605 å­—èŠ‚å¢åŠ åˆ° 2262 å­—èŠ‚(å³å¢åŠ äº† 41%)ã€‚å› æ­¤ï¼Œå½“ä¸€ä¸ª`object-dtype` åˆ—åŒ…å«è®¸å¤šé‡å¤å€¼æ—¶ï¼Œåˆ†ç±»å°†æœ€æœ‰åˆ©äºé«˜æ•ˆå­˜å‚¨ã€‚

**ä¸Šå‰ç»ƒä¹ **

æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘å·²ç»åˆ†äº«äº†æˆ‘çš„ç†ŠçŒ«å°è´´å£«å’ŒæŠ€å·§ï¼Œæˆ‘å¸Œæœ›æˆ‘èƒ½æ—©ç‚¹çŸ¥é“ã€‚[å®Œæ•´ä»£ç é“¾æ¥åœ¨æˆ‘çš„ Github](https://github.com/YiLi225/Pandas_Tricks/blob/master/Top10_Pandas_Tricks.py) é‡Œã€‚ç°åœ¨è½®åˆ°ä½ å¼€å§‹ç¼–ç äº†ï¼ğŸ˜ƒ

> æ²¡æœ‰ä¸æ–­çš„ç»ƒä¹ ï¼Œå°±ä¸ä¼šæœ‰ä¼˜ç§€çš„éŸ³ä¹[ç†ŠçŒ«]ã€‚
> 
> ç®€Â·å¥¥æ–¯æ±€ã€Šå‚²æ…¢ä¸åè§ã€‹ä¸­çš„å‡¯ç‘Ÿç³å¤«äºº(ç¬¬ 31 ç« )

æˆ‘å¸Œæœ›ä½ å–œæ¬¢è¿™ä¸ªåšå®¢ï¼ ***æƒ³è¦æ›´å¤šæ•°æ®ç§‘å­¦å’Œç¼–ç¨‹æŠ€å·§ï¼Ÿä½¿ç”¨*** [***æˆ‘çš„é“¾æ¥***](https://yilistats.medium.com/membership) ***æ³¨å†Œ Mediumï¼Œè·å¾—æˆ‘æ‰€æœ‰å†…å®¹çš„å…¨éƒ¨è®¿é—®æƒé™ã€‚***

***è¿˜è®¢é˜…æˆ‘æ–°åˆ›å»ºçš„ YouTube é¢‘é“*** [***ã€Šæ•°æ®ä¸å‰è°ˆã€‹***](https://www.youtube.com/channel/UCbGx9Om38Ywlqi0x8RljNdw)

*ä»¥ä¸‹æ˜¯æˆ‘çš„å…¶ä»–åšå®¢ï¼Œä½ å¯èƒ½ä¹Ÿä¼šè§‰å¾—å¾ˆæœ‰å¯å‘æ€§ã€‚*

*[](/6-sql-tricks-every-data-scientist-should-know-f84be499aea5) [## æ¯ä¸ªæ•°æ®ç§‘å­¦å®¶éƒ½åº”è¯¥çŸ¥é“çš„ 6 ä¸ª SQL æŠ€å·§

### æé«˜åˆ†ææ•ˆç‡çš„ SQL æŠ€å·§

towardsdatascience.com](/6-sql-tricks-every-data-scientist-should-know-f84be499aea5) [](/data-reshaping-in-sql-r-and-python-d44ca19e71b8) [## SQLã€R å’Œ Python ä¸­çš„æ•°æ®æ•´å½¢

### ä» Python vs. R åˆ° Python & R

towardsdatascience.com](/data-reshaping-in-sql-r-and-python-d44ca19e71b8)*