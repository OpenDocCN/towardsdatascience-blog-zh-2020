<html>
<head>
<title>How to train a neural network on Chrome using tensorflow.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用tensorflow.js在Chrome上训练神经网络</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-train-a-neural-network-on-chrome-using-tensorflow-js-76dcd1725032?source=collection_archive---------34-----------------------#2020-01-02">https://towardsdatascience.com/how-to-train-a-neural-network-on-chrome-using-tensorflow-js-76dcd1725032?source=collection_archive---------34-----------------------#2020-01-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/a85f7420cecbdc2a7fcf3808bf162d35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NsA3nUxx9m4QmxXadBNsmw.jpeg"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">Tensorflow.js谷歌浏览器</p></figure><p id="8a49" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">本教程只是演示了我们如何利用简单的脚本语言(如javascript)。在这种情况下，要在浏览器中使用神经网络进行训练和预测。我们将使用javascript。这个博客的主要目的是利用浏览器不仅可以使用互联网，还可以在幕后训练一个模型。</p><p id="c524" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在本教程中，我们将构建一个模型来推断两个数字之间的关系，其中y = 2x -1 (y等于2x减1)。</p><p id="0a31" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我们从教程开始吧。</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><p id="b0cb" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">本教程需要的东西<br/> 1。包含一个. js代码片段的简单HTML文件。<br/> 2。谷歌Chrome浏览器。<br/> 3。用于编辑html文件的文本编辑器。</p><h1 id="8982" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak">让我们从创建一个基本的html文件</strong>开始</h1><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="de2d" class="mr ll it mn b gy ms mt l mu mv">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/> &lt;title&gt;Training a model on browser&lt;/title&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;</span><span id="4da2" class="mr ll it mn b gy mw mt l mu mv">&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h1 id="6d74" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak">现在我们需要导入tensorflow.js库</strong></h1><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="7b98" class="mr ll it mn b gy ms mt l mu mv">&lt;script src="<a class="ae mx" href="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest</a>"&gt;&lt;/script&gt;</span></pre><p id="6cf9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><em class="my">注意:这必须包含在&lt;头&gt;标签</em>内</p><h1 id="8bb1" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak">创建训练功能</strong></h1><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="8f1d" class="mr ll it mn b gy ms mt l mu mv">function doTraining(model) {<br/>//here we are going to write logic for training<br/>}</span></pre><p id="a51f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们需要使功能异步，以便它可以在后台运行，而不影响我们的网页。</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="fe85" class="mr ll it mn b gy ms mt l mu mv">async function doTraining(model){<br/>            const history = <br/>                  await model.fit(xs, ys, <br/>                        { epochs: 500,<br/>                          callbacks:{<br/>                              onEpochEnd: async(epoch, logs) =&gt;{<br/>                                  console.log("Epoch:" <br/>                                              + epoch <br/>                                              + " Loss:" <br/>                                              + logs.loss);<br/>                                  <br/>                              }<br/>                          }<br/>                        });<br/>        }</span></pre><p id="cae0" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">功能解释:</p><p id="d018" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们在函数内部异步调用model.fit()，为了做到这一点，我们需要将模型作为参数传递给我们的异步函数。<br/>我们对模型使用了await，这样它就可以等到训练结束。不会因为异步调用而影响我们的网页。<br/>我们在训练后使用了javascript回调，比如在本例中，我们调用了onEpochEnd在训练完成后打印最终损失。</p><p id="ee2e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">既然我们已经准备好了我们的函数，我们可以继续预测。</p><h1 id="d814" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak">用单个神经网络创建模型</strong></h1><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="d4f9" class="mr ll it mn b gy ms mt l mu mv">const model = tf.sequential();</span><span id="c049" class="mr ll it mn b gy mw mt l mu mv">model.add(tf.layers.dense({units: 1, inputShape: [1]}));</span><span id="2d8f" class="mr ll it mn b gy mw mt l mu mv">model.compile({loss:'meanSquaredError', <br/>                       optimizer:'sgd'});</span></pre><h1 id="3154" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak">型号总结</strong></h1><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="f205" class="mr ll it mn b gy ms mt l mu mv">model.summary()<br/>//pretty simple</span></pre><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/b7ed07844b7f00802dd83b15f448e424.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*CysBhlH0cyI-rvCF4DMRqw.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">单神经元网络模型综述</p></figure><p id="5542" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">附注:<em class="my">那些正在思考为什么摘要显示可训练参数的人:2(两个)<br/>有两个参数是因为</em> <strong class="kh iu"> <em class="my">权重</em> </strong> <em class="my">和</em> <strong class="kh iu"> <em class="my">偏差</em> </strong> <em class="my">即</em> <strong class="kh iu"> <em class="my"> w </em> </strong> <em class="my">和</em> <strong class="kh iu"> <em class="my"> c </em> </strong></p><h1 id="7b31" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak">训练我们方程的样本数值数据</strong></h1><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="80ba" class="mr ll it mn b gy ms mt l mu mv">const xs = tf.tensor2d([-1.0, 0.0, 1.0, 2.0, 3.0, 4.0], [6, 1]);</span><span id="2745" class="mr ll it mn b gy mw mt l mu mv">const ys = tf.tensor2d([-3.0, -1.0, 2.0, 3.0, 5.0, 7.0], [6, 1]);</span></pre><p id="1642" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu">解释</strong>:</p><p id="6f88" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">就像我们在python中使用numpy一样，我们需要使用tf.tensor2d()函数来定义二维数组。<br/>提到tensor2d函数的数组形状很重要。</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="0b23" class="mr ll it mn b gy ms mt l mu mv">let xs = [-1.0, 0.0, 1.0, 2.0, 3.0, 4.0] # array</span><span id="a088" class="mr ll it mn b gy mw mt l mu mv">[6,1] # shape of that array</span></pre><h1 id="4709" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">异步训练和预测</h1><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="a0fe" class="mr ll it mn b gy ms mt l mu mv">doTraining(model).then(() =&gt; {<br/>            alert(model.predict(tf.tensor2d([10], [1,1])));<br/>        }); #calling the function</span></pre><p id="1f99" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们将使用Promise.js异步调用训练函数，然后根据训练好的模型预测一个值。</p><p id="b1c5" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">javascript新手可以从<a class="ae mx" href="https://javascript.info/promise-basics" rel="noopener ugc nofollow" target="_blank"> <strong class="kh iu">这里</strong> </a>查一下什么是Promise.js。</p><h1 id="9f59" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">添加一些数据显示在网页上。</h1><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="d468" class="mr ll it mn b gy ms mt l mu mv">&lt;h1 align="center"&gt;Press 'f12' key or 'Ctrl' + 'Shift' + 'i' to check whats going on&lt;/h1&gt;</span></pre><p id="a10a" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们还可以添加一些数据，将显示在网页上，就像一个样本运行的网站。</p><h1 id="6475" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak">最终的html文件看起来会像这样</strong></h1><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="a027" class="mr ll it mn b gy ms mt l mu mv">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;head&gt;<br/> &lt;title&gt;Training a model on browser&lt;/title&gt;<br/> &lt;script src="<a class="ae mx" href="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest</a>"&gt;&lt;/script&gt;</span><span id="b7be" class="mr ll it mn b gy mw mt l mu mv">&lt;script lang="js"&gt;<br/>        async function doTraining(model){<br/>            const history = <br/>                  await model.fit(xs, ys, <br/>                        { epochs: 500,<br/>                          callbacks:{<br/>                              onEpochEnd: async(epoch, logs) =&gt;{<br/>                                  console.log("Epoch:" <br/>                                              + epoch <br/>                                              + " Loss:" <br/>                                              + logs.loss);<br/>                                  <br/>                              }<br/>                          }<br/>                        });<br/>        }<br/>        const model = tf.sequential();<br/>        model.add(tf.layers.dense({units: 1, inputShape: [1]}));<br/>        model.compile({loss:'meanSquaredError', <br/>                       optimizer:'sgd'});<br/>        model.summary();<br/>   const xs = tf.tensor2d([-1.0, 0.0, 1.0, 2.0, 3.0, 4.0], [6, 1]);<br/>   const ys = tf.tensor2d([-3.0, -1.0, 2.0, 3.0, 5.0, 7.0], [6, 1]);<br/>        doTraining(model).then(() =&gt; {<br/>            alert(model.predict(tf.tensor2d([10], [1,1])));<br/>        });<br/>    &lt;/script&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/> &lt;h1 align="center"&gt;Press 'f12' key or 'Ctrl' + 'Shift' + 'i' to check whats going on&lt;/h1&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="4798" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">你也可以从<a class="ae mx" href="https://gist.github.com/novasush/df35cc2d8a914e06773114986ccde186" rel="noopener ugc nofollow" target="_blank"> <strong class="kh iu">这里</strong> </a> <strong class="kh iu">下载这个文件。</strong></p><p id="e0b8" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><a class="ae mx" href="https://gist.github.com/novasush/df35cc2d8a914e06773114986ccde186" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/novas ush/df 35 cc 2d 8 a 914 e 06773114986 ccde 186</a></p><h1 id="1f3f" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">最后在浏览器上训练和预测你的模型</h1><p id="b10a" class="pw-post-body-paragraph kf kg it kh b ki na kk kl km nb ko kp kq nc ks kt ku nd kw kx ky ne la lb lc im bi translated">使用Google Chrome打开您的html文件，并按“F12”键检查开发人员控制台。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/7fad1d3e262e095e75161e6334de28a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GO-JVIT3p1UxKWmw17PmYA.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">控制台中训练日志的快照，随后是警告框中的预测</p></figure><p id="97bd" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">您可以在开发人员控制台中看到训练时期及其损失。训练完成后，网页上会自动显示一个警告框，显示预测结果。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/6206fe74cdf470bffb99671e19f125f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*QjQnzXiTk2IrF53Tj140Ow.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">包含方程y = 2x-1的输入10的预测的图像</p></figure><p id="3d4f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这是一个警告框，显示我们的输入数字10的预测。</p><p id="5c84" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">根据等式Y = 2X-1，输入x = 10的输出应该是<br/> y = 19。我们的模型预测的18.91已经足够接近了。</p><h1 id="7111" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated"><strong class="ak">谢谢</strong></h1><p id="52d0" class="pw-post-body-paragraph kf kg it kh b ki na kk kl km nb ko kp kq nc ks kt ku nd kw kx ky ne la lb lc im bi translated">请不吝分享你的疑惑或建议。我是团队<a class="ae mx" href="https://nsemble.ai" rel="noopener ugc nofollow" target="_blank"> Nsemble.ai </a>的成员之一，我们喜欢使用人工智能来研究和开发具有挑战性的产品。Nsemble在工业4.0和电子商务领域开发了多个解决方案。我们很乐意帮助你。</p></div></div>    
</body>
</html>