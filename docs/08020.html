<html>
<head>
<title>The Viola-Jones Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">维奥拉-琼斯算法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-viola-jones-algorithm-7357c07d8356?source=collection_archive---------45-----------------------#2020-06-13">https://towardsdatascience.com/the-viola-jones-algorithm-7357c07d8356?source=collection_archive---------45-----------------------#2020-06-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c75dcd2a7159769edd9686ed0b45b0ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LL7sjtsxWETqCzs8SL-aOw.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">照片由Ameer Basheer在Unsplash上拍摄</p></figure><p id="d54e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使计算机或手机等机器看到周围环境的现象被称为计算机视觉。它是计算机科学的一个领域，专注于复制人类视觉系统的部分复杂性，并使计算机能够像人类一样识别和处理图像和视频中的对象。</p><p id="2a53" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">计算机视觉的一些应用包括:</p><ul class=""><li id="5d18" class="la lb iq ke b kf kg kj kk kn lc kr ld kv le kz lf lg lh li bi translated">目标检测</li><li id="a0ac" class="la lb iq ke b kf lj kj lk kn ll kr lm kv ln kz lf lg lh li bi translated">人脸检测</li><li id="0f62" class="la lb iq ke b kf lj kj lk kn ll kr lm kv ln kz lf lg lh li bi translated">人脸识别</li><li id="673b" class="la lb iq ke b kf lj kj lk kn ll kr lm kv ln kz lf lg lh li bi translated">自动驾驶汽车</li><li id="1f78" class="la lb iq ke b kf lj kj lk kn ll kr lm kv ln kz lf lg lh li bi translated">自主无人机</li></ul><p id="4047" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">人脸检测并不完美，但它已经达到了在我们的日常生活中被接受的阶段，从解锁手机到汇款。</p><h1 id="289c" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">维奥拉-琼斯算法</h1><p id="a793" class="pw-post-body-paragraph kc kd iq ke b kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz ij bi translated">该算法是OpenCV库的基础。它是由保罗·维奥拉和迈克尔·琼斯在2001年开发的。它允许实时检测图像。</p><h1 id="02b6" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">它是如何工作的</h1><p id="855d" class="pw-post-body-paragraph kc kd iq ke b kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz ij bi translated">这个算法有两个阶段</p><ol class=""><li id="ff21" class="la lb iq ke b kf kg kj kk kn lc kr ld kv le kz mr lg lh li bi translated">培养</li><li id="685d" class="la lb iq ke b kf lj kj lk kn ll kr lm kv ln kz mr lg lh li bi translated">侦查</li></ol><p id="090a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们将首先讨论检测</p><h2 id="8c02" class="ms lp iq bd lq mt mu dn lu mv mw dp ly kn mx my mc kr mz na mg kv nb nc mk nd bi translated"><strong class="ak">检测</strong></h2><p id="bbc0" class="pw-post-body-paragraph kc kd iq ke b kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz ij bi translated">这种算法被设计用来寻找<strong class="ke ir">正面人脸。</strong>检测侧向、向上或向下时，性能会很差。图像首先被转换为灰度，因为它更容易处理，需要处理的数据更少。该算法首先在灰度图像中找到人脸，然后在彩色图像中找到人脸的位置。</p><p id="5bb6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">它勾勒出一个矩形框，并从左上角搜索人脸。它寻找类似haar的特征，我们将在本博客后面讨论。在瓷砖上每走一步后的矩形方块右侧。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d4125494b92aa1c4587f825efe23a135.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-36f0U3D_6-rbB7FP2LEbQ.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">mahdis mousavi在Unsplash上拍摄的照片</p></figure><h1 id="d873" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">类哈尔特征</h1><p id="b09e" class="pw-post-body-paragraph kc kd iq ke b kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz ij bi translated">它是以发展了哈尔小波概念的匈牙利数学家阿尔弗雷德·哈尔的名字命名的。下面的特征显示了一个有亮侧和暗侧的盒子，这是机器如何确定特征是什么的。</p><p id="2f17" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">维奥拉和琼斯发现了三种类型的哈尔特征，它们是</p><ol class=""><li id="6a55" class="la lb iq ke b kf kg kj kk kn lc kr ld kv le kz mr lg lh li bi translated">边缘特征</li><li id="a0ff" class="la lb iq ke b kf lj kj lk kn ll kr lm kv ln kz mr lg lh li bi translated">线特征</li><li id="30af" class="la lb iq ke b kf lj kj lk kn ll kr lm kv ln kz mr lg lh li bi translated">四个矩形特征/四边特征</li></ol><p id="9dd4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">边缘特征</strong></p><p id="bb66" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">例如，您想要检测眉毛。图像中眉毛上的像素的阴影将变暗，并突然变亮(皮肤)。边缘特征非常有助于找到这一点。</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/8490c78b6e13e27e3624e0b2637d5fc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*KdAKw35aRba3BZlfRzHXGA.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">边缘特征</p></figure><h2 id="d50a" class="ms lp iq bd lq mt mu dn lu mv mw dp ly kn mx my mc kr mz na mg kv nb nc mk nd bi translated">线特征</h2><p id="b09f" class="pw-post-body-paragraph kc kd iq ke b kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz ij bi translated">自然地，你的嘴唇在脸上的区域从亮变暗，然后又变亮。这个特征最好找</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/ddc8031800b2f8d0f6621e23dcb333ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*lGczrd0lMwaQ1i6EMJ5_qA.jpeg"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">线特征</p></figure><h2 id="9de7" class="ms lp iq bd lq mt mu dn lu mv mw dp ly kn mx my mc kr mz na mg kv nb nc mk nd bi translated">四个侧面特征</h2><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/b6dff5e27ec7dd2100abdb71d127699c.png" data-original-src="https://miro.medium.com/v2/resize:fit:182/format:webp/1*mWi3SiI6KiSGgBkCpahR9w.jpeg"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">四矩形特征</p></figure><p id="3fdf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这些特征帮助机器理解图像是什么。当检查图像时，每个特征都有自己的值。这很容易计算:从黑色区域减去白色区域</p><h1 id="03e6" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">整体图像</h1><p id="174c" class="pw-post-body-paragraph kc kd iq ke b kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz ij bi translated">随着像素数量的增加，即在更大的图像中，计算一个特征的值将变得非常复杂。积分图像概念有助于快速执行密集计算，因此我们可以了解多个特征中的一个特征是否符合标准。</p><p id="3135" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们解释一下它是如何工作的。考虑下图</p><figure class="ne nf ng nh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/ab00bf88e9584df5abddc97d00ff9a58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1V5yQsdo4spyP_9ItqnCFA.png"/></div></div></figure><p id="11a0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">积分图像中的每一个点都是源图像</strong>中相应像素上方和左侧像素的总和。我们使用这个是因为我们不是对所有特征的每个像素值做加法，而是利用一些减法来得到相同的结果。</p><h1 id="a863" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">训练分类器</h1><p id="8f82" class="pw-post-body-paragraph kc kd iq ke b kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz ij bi translated">在训练中，我们给它输入信息，训练分类器从预测信息中学习。因此，最终，该算法将设置一个最小阈值来确定某个事物是否可以被归类为一个特征。</p><p id="1a57" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在训练阶段，图像缩小为24*24像素，并在图像中搜索特征。我们需要大量的图像数据来训练算法。Viola和Jones向他们的算法输入了4960张手动标记的图像。我们还应该向分类器提供非面部图像，以便它能够分类和理解。Viola和Jones为他们的算法提供了9544张非面部图像。</p><h1 id="d2fc" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">自适应增压</h1><p id="795a" class="pw-post-body-paragraph kc kd iq ke b kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz ij bi translated">当我们观察所有可能的位置和这些特征的组合时，我们得到了一个精确的模型。训练在计算上可能是昂贵的，以检查每个图像中的每一种可能性和组合，这需要很多时间。</p><p id="037b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里我们有一个以f1，f2，f3为特征，以a1，a1，a3为各自权重的方程。F(x)称为强分类器。单个分类器将是弱的，当我们有两个或三个弱分类器的组合时，我们得到一个强分类器。这个过程被称为<strong class="ke ir">合奏。</strong></p><h1 id="f0a8" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">级联</h1><p id="2558" class="pw-post-body-paragraph kc kd iq ke b kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv mq kx ky kz ij bi translated">这是另一种提高模型精度和速度的方法。在这里，我们首先选取一个子窗口，然后选取最佳特征，检查它是否出现在图像中。如果不是，我们拒绝该子窗口，并继续到另一个子窗口。如果它存在，我们看第二个特征，如果它不存在，我们拒绝它，并转移到另一个特征。级联加速了这一过程，并且机器更快地传递结果。</p><p id="c536" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">就这些了，希望你喜欢我关于计算机视觉的博客！。在我的下一篇博客中，我们将讨论使用OpenCV的人脸识别。</p></div></div>    
</body>
</html>