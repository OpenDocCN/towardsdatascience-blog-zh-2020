<html>
<head>
<title>3 Intermediate Excel Functions and How to do Them in Python!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">3个中级Excel函数以及如何用Python来做！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/excel-functions-in-python-17d35defebdd?source=collection_archive---------17-----------------------#2020-06-08">https://towardsdatascience.com/excel-functions-in-python-17d35defebdd?source=collection_archive---------17-----------------------#2020-06-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9b45" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">不仅仅是在熊猫身上试水！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2e7e41b66cae32843e14f7b76b9ee6f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dAepbK9mz1yZkrY7JfuOZA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让我们和熊猫一起出发吧！资料来源:Nik Piepenbreier</p></figure><p id="9d39" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你想尝试一下蟒蛇和熊猫的有趣世界吗？</p><p id="70fd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Python通常被认为比Excel更难掌握，但却有无限的潜力。本教程将带您逐步了解您已经在Excel中使用的函数。</p><h1 id="94cf" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">Pandas中的文本转列</h1><p id="4486" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">当您得到由奇怪结构的数据组成的大型数据集时，Text to columns是这些基本功能之一。</p><p id="8d0b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，可能会给你一列人名。但是不是一列表示姓，另一列表示名，而是一列表示姓<em class="mr">，名</em>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/4cd2806b803ba43248fc710fcf25f9e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*azW0ixmqWj2xCGuQJjVUHw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Excel中的文本到列。资料来源:Nik Piepenbreier</p></figure><p id="8dc1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Excel的“文本到列”功能让您可以轻松地将这些数据拆分到单独的列中。</p><p id="f352" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您只需选择列，单击数据→文本到列，并用逗号分隔。</p><p id="c1f8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">瞧啊。</p><p id="68a3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在在熊猫身上做同样简单！</p><p id="7f73" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们来看看这段代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pandas中的文本到列。资料来源:Nik Piepenbreier</p></figure><p id="c797" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要创建包含姓氏和名字的两个新列，只需编写以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Pandas中的文本到列-代码。资料来源:Nik Piepenbreier</p></figure><p id="9a28" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们来看看拆分功能:</p><ul class=""><li id="6d24" class="mv mw it la b lb lc le lf lh mx ll my lp mz lt na nb nc nd bi translated">我们指定要在逗号(，)上进行拆分。</li><li id="f61f" class="mv mw it la b lb ne le nf lh ng ll nh lp ni lt na nb nc nd bi translated">我们还指出expand=True，这意味着数据被拆分到新的列中。如果该值为False，将创建一个字符串列表。</li><li id="0be9" class="mv mw it la b lb ne le nf lh ng ll nh lp ni lt na nb nc nd bi translated">还可以使用n=来指定想要拆分字符串的次数。默认值为-1，表示所有实例。</li></ul><h1 id="0b2e" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">用熊猫代替文本函数(如RIGHT()、PROPER())</h1><p id="a679" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">Excel也塞满了不同的文本函数。您可以使用LEFT()和RIGHT()等函数来提取字符，使用PROPER()和LOWER()来修改单元格内的文本。</p><p id="57a7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们加载另一个数据帧，看看如何用Pandas实现这些:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">加载更多数据。资料来源:Nik Piepenbreier</p></figure><p id="5b3a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，让我们应用一些文本函数:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">应用字符串函数。资料来源:Nik Piepenbreier</p></figure><p id="78d2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">LEFT()和RIGHT()函数通过索引每一列中的字符串来工作。由于字符串是Python中的<em class="mr">可迭代</em>对象，所以可以对它们进行索引。</p><p id="0450" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">通过编写[:3]，您要求Python返回第三个字符之前的字符(但不包括第三个字符)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ce0c91d351d6432eeefbd4e5d296102d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XGF01x53cy77mRcQ91twVA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Excel和Pandas中的一些常用文本函数。资料来源:Nik Piepenbreier</p></figure><h1 id="8a1d" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">跨列应用计算</h1><p id="aae9" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">Excel使得对列的操作非常直观。由于每个单元格都有一个特定的引用，您可以使用该单元格引用轻松地将其乘以一个值，将两个单元格相加，等等。</p><p id="dc17" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在还不清楚你是否能在熊猫身上做到这一点。</p><p id="3a65" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们加载一个包含两列重量的样本数据帧，我们假设重量单位为千克:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">加载第三个数据帧。资料来源:Nik Piepenbreier</p></figure><p id="abd8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们想要创建一个包含weight1和weight2之和的新列，我们可以简单地将它们相加:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">添加两列。资料来源:Nik Piepenbreier</p></figure><p id="dcea" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，如果我们想将sum列转换为磅(通过乘以2.2)，您可以直接应用该乘法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mt mu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在熊猫中乘一列。资料来源:Nik Piepenbreier</p></figure><h1 id="5de5" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">结论</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/d8e8d3c620b1beac5805c9503b307562.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*79bPgZGKunoBBA6JmrB9Vw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">感谢阅读！资料来源:Nik Piepenbreier</p></figure><p id="02b1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读这篇文章！我希望你学到了一些东西，并且对尝试Python和熊猫的有趣世界感到更舒服了！</p><p id="8726" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想更深入地了解这一点，可以看看我的其他文章或我的电子书，带你从完全初学者到中级熊猫！你可以在这里找到:<a class="ae nk" href="https://gumroad.com/l/introtopythonfordatascience" rel="noopener ugc nofollow" target="_blank">https://gumroad.com/l/introtopythonfordatascience</a></p></div></div>    
</body>
</html>