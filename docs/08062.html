<html>
<head>
<title>Understanding Distributions using R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用R理解发行版</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-distributions-using-r-490620c2bb08?source=collection_archive---------27-----------------------#2020-06-14">https://towardsdatascience.com/understanding-distributions-using-r-490620c2bb08?source=collection_archive---------27-----------------------#2020-06-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="48d4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">R中的分布基础是数据可视化的先决条件</h2></div><p id="ee60" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你如何传达数据驱动的发现？</p><p id="b7ab" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据可视化！</p><p id="5c4f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有各种各样的工具可以实现这一点，本文将介绍其中的一个工具——r。</p><p id="9b8f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是在我们开始使用R可视化数据之前，我们需要理解一些概念和术语。在这篇文章结束时，我希望你能够理解:</p><p id="22de" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">a)分布以及如何使用它们来汇总您的数据集</p><p id="79d7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">b)直方图和密度图之间的差异</p><p id="da3b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">c)正态分布&amp;使用标准单位</p><p id="81a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">d)如何使用分位数图检查正态分布</p><p id="8ae7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">e)何时以及如何使用箱线图</p><p id="8964" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里我们介绍一个问题。假设有一个来自另一个星球的霸主，我们需要向他描述身高，比如说，一群学生。为此，我们首先需要收集学生的性别和身高数据。向外星霸主解释数据集的一种方式是简单地与它共享数据集。</p><p id="a6c1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">展示这些数据的另一个更简单的方法是通过分布——所有列表中最基本的统计汇总。在描述一系列分类变量或连续变量时，会用到不同形式的分布。例如，在这种情况下，可以使用prop.table()命令对变量“sex”进行汇总，以生成频率表，并帮助我们理解给定数据集中男性和女性两个类别的比例。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="2813" class="ln lo it lj b gy lp lq l lr ls">library(dslabs)<br/>data(heights)<br/># make a table of category proportions<br/>prop.table(table(heights$sex))</span></pre><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/d46c746f16e29a0a1b73e8bd2e6fb7d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:358/format:webp/1*nkfAsRyqFNY2V7GAuKmKAg.png"/></div></figure><p id="a429" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有了更多的类别，我们可以利用条形图来描述分布。但是对于数字数据，绘制分布图可能更具挑战性。这是因为单个数据点可能不是唯一的。一个人可能报告他/她的身高为68.897英寸，而另一个人可能报告同样的身高为68.503英寸。很明显这些人是分别从175和174英寸换算出来的身高。</p><p id="c458" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这种条目的表示需要分布函数。这就是“累积分布函数”概念发挥作用的地方。随机变量X的CDF定义为，</p><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/b996be880f1b66a5064a3dc420b18bad.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*dnFgUoZrKZkEcbXcRQOxpQ.png"/></div></figure><p id="bed5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们假设X是一个离散随机变量，范围R = {x1，x2，x3…}并且范围R从下面有界(即x1)。下图显示了生成的CDF的一般形式。CDF是一个非减函数，当x变得足够大时，它趋近于1。</p><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/2ac9598094f5ba28f0f29315dfc73af5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*RObpu5FqUyjbgdwMVz8qOA.png"/></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">来源:https://www.probabilitycourse.com/chapter3/3_2_1_cdf.php</p></figure><h1 id="472a" class="me lo it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">柱状图</h1><p id="e4d5" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">回到高度的数据集示例，当我们为它构建CDF时，我们需要评估它是否回答了重要的问题，如分布集中在哪里，哪个范围包含大多数数据，等等。虽然CDF可以帮助回答这类问题，但它要困难得多。</p><p id="a36c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相比之下，我们现在利用直方图来更好地理解数据。只要看一眼剧情，霸王就能从中推断出重要的信息。</p><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi na"><img src="../Images/969c001ffee9db9c08b382c367c52a21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*Y2ONivKv_EENADKsK6rJiw.png"/></div></figure><p id="0b9d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以在69英寸左右对称分布，大部分数据位于63到74英寸之间。有了这种近似，我们总是会丢失一些信息。在这种特殊情况下，影响可以忽略不计。</p><h1 id="0be5" class="me lo it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">密度图</h1><p id="6493" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">我们还可以利用平滑的密度图来显示数据的分布。在平滑噪声的同时，图中的峰值有助于识别大部分值集中的区域或范围。</p><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/5c030afcc7c61d1150622c173ba564c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*epFovz6TVKwsH_IWYpdO_w.png"/></div></figure><p id="faf3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">密度图优于直方图的一个主要优点是，它们更能确定分布的形状。例如，具有比如说5个面元的直方图不会像15个面元的直方图那样产生可区分的形状。然而，在使用密度图时，不存在这样的问题。</p><h1 id="0600" class="me lo it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">正态分布</h1><p id="3053" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">让我们更进一步，计算这个数据集的平均值和平均偏差。我们都熟悉正态分布的含义。当您从独立来源的随机数据集合中绘制点时，它会生成一条钟形曲线(或高斯曲线)。在这个图表中，曲线的中心将给出数据集的平均值。</p><p id="4805" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是R中用于生成正态分布函数的内置函数:</p><ol class=""><li id="09d3" class="nc nd it kk b kl km ko kp kr ne kv nf kz ng ld nh ni nj nk bi translated"><strong class="kk iu"> dnorm() </strong> —用于针对给定的平均值和标准差，找出每个点的概率分布的高度。</li></ol><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="a54b" class="ln lo it lj b gy lp lq l lr ls">x &lt;- seq(-20, 20, by = .1)<br/>y &lt;- dnorm(x, mean = 5, sd = 0.5)<br/>plot(x,y)</span></pre><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/7c0e9391a30e72b0d021603f8f98f0e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*13WvVvyuey7AVLDMUp1Pxg.png"/></div></figure><p id="6e6a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 2。pnorm() </strong> —也称为“累积分布函数”(CDF)，pnorm用于找出正态分布随机数小于给定数值的概率。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="e677" class="ln lo it lj b gy lp lq l lr ls">x &lt;- seq(-10,10,by = .2)<br/>y &lt;- pnorm(x, mean = 2.5, sd = 2)<br/>plot(x,y)</span></pre><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/3396ae57a04c6253935996d8c0988f6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*F3wIoUJjVqJb90lpYKzt5Q.png"/></div></figure><p id="c729" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 3。qnorm() </strong> —获取概率值并给出一个数字，其累积值与概率值匹配。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="d499" class="ln lo it lj b gy lp lq l lr ls">x &lt;- seq(0, 1, by = 0.02)<br/>y &lt;- qnorm(x, mean = 2, sd = 1)<br/>plot(x,y)</span></pre><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/d8bb843f9daafb10655c5120dae04ed7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*Agbqn9ODgi3qf9m5WFvZoQ.png"/></div></figure><p id="e296" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 4。rnorm() </strong> —该函数用于生成正态分布的随机数。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="2df2" class="ln lo it lj b gy lp lq l lr ls">y &lt;- rnorm(50)<br/>hist(y, main = "Normal DIstribution")</span></pre><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi no"><img src="../Images/2cca992c04b512abf66e43385015948a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*j6e-2YiyyIIaSWHVEOurgQ.png"/></div></figure><p id="3f4a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">正态分布方程:</strong></p><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi np"><img src="../Images/ae68546885f61120f0894da7d9b0df34.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*ibaoB8dIqjVDhaeTunPpdw.png"/></div></figure><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="525d" class="ln lo it lj b gy lp lq l lr ls"># define x as vector of male heights<br/><br/>library(tidyverse)<br/><br/>library(dslabs)<br/><br/>data(heights)<br/><br/>index &lt;- heights$sex=="Male"<br/><br/>x &lt;- heights$height[index]</span><span id="4f54" class="ln lo it lj b gy nq lq l lr ls"># calculate the mean and standard deviation manually<br/><br/>average &lt;- sum(x)/length(x)<br/><br/>SD &lt;- sqrt(sum((x - average)^2)/length(x))</span><span id="34ad" class="ln lo it lj b gy nq lq l lr ls"># built-in mean and sd functions <br/><br/>average &lt;- mean(x)<br/><br/>SD &lt;- sd(x)<br/><br/>c(average = average, SD = SD)</span></pre><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/d79f5aa9bb394031b7f233808219dc5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*FrS4nDSfX5izS8EunnRe0Q.png"/></div></figure><p id="7008" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在数据集高度的情况下，这种分布以平均值为中心，大多数数据点在平均值的两个标准偏差范围内。我们观察到这种分布仅由两个参数定义——均值和标准差，因此这意味着如果数据集遵循正态分布，则可以用这两个值来概括。</p><p id="6c5e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在R中，我们利用函数标度来获得标准单位。数学上，标准单位定义如下:</p><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/4dc06229e57723da2454142992693bfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:166/format:webp/1*Rf_xYrFsS3G0Luw_FVgpLA.png"/></div></figure><p id="b886" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它基本上告诉我们一个物体x(在这种情况下是高度)偏离平均值的标准偏差的数量。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="c4a2" class="ln lo it lj b gy lp lq l lr ls"># calculate standard units<br/> z &lt;- scale(x)</span><span id="41e7" class="ln lo it lj b gy nq lq l lr ls"># calculate proportion of values within 2 SD of mean<br/> mean(abs(z) &lt; 2)</span></pre><p id="4304" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">平均值的-2和+2圈内的值的比例约为95%,这正是正态分布的预测值。</p><p id="b156" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是我们如何检查这些分布是否是正态分布的近似值呢？</p><h1 id="3a2b" class="me lo it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated"><strong class="ak">分位数—分位数图</strong></h1><p id="f4f4" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">这里主要概念是，我们定义一系列比例p，并基于定义的分位数q，使得数据中低于q的值的比例是p。因此，如果数据的分位数等于正态分布的分位数，我们可以得出数据近似正态分布的结论。</p><p id="ca50" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们计算样本和理论分位数，以检查数据点是否落在同一直线上。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="eb1c" class="ln lo it lj b gy lp lq l lr ls"># calculate observed and theoretical quantiles<br/>p &lt;- seq(0.05, 0.95, 0.05)<br/>observed_quantiles &lt;- quantile(x, p)<br/>theoretical_quantiles &lt;- qnorm(p, mean = mean(x), sd = sd(x))</span><span id="7b8d" class="ln lo it lj b gy nq lq l lr ls"># make QQ-plot<br/>plot(theoretical_quantiles, observed_quantiles)<br/>abline(0,1)</span></pre><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/2347f872f09cfc43b1ed5a83a088e2ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*hQXq4xvg4dRW4fPD8_Vb8Q.png"/></div></figure><p id="b569" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">事实上，这些值落在单位线上，这意味着这些分布很好地近似为正态分布。</p><p id="32d5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="nu">注:</em> </strong></p><p id="16c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="nu"> a)分位数的特例，百分位数是定义p = 0.01，0.02，0.03…时得到的分位数。，0.99 </em></p><p id="2da2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="nu"> b)四分位数是第25、50和75个百分位数，第50个百分位数给出了中值。</em></p><h1 id="dc95" class="me lo it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">箱线图</h1><p id="af9c" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">如果数据集不符合正态分布，并且两个参数(均值和标准差)不足以汇总数据，会发生什么情况？箱线图在这种情况下会很有帮助。将数据集分为三个四分位数，箱线图表示数据集中的第一个四分位数、第三个四分位数、最小值、最大值和中值。</p><p id="5c73" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们使用相同的“身高”数据集来创建学生性别(男/女)和身高之间关系的基本箱线图。</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="07f4" class="ln lo it lj b gy lp lq l lr ls">data(heights)<br/>boxplot(height~sex, data=heights, xlab="Sex",ylab="height")</span></pre><figure class="le lf lg lh gt lu gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/127e01e4ed9e23847ead629d9c1653c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*JqngE3piipQ2NNy_W8-xhA.png"/></div></figure><p id="695a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从上面的图中，我们可以推断出两组的标准偏差几乎是相似的，尽管平均来看，平均比女性高。</p><p id="1973" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想进一步了解测试统计中其他/不常见的分布，请参考R Stats包中的‘分布’(下面给出的链接)</p><div class="nw nx gp gr ny nz"><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/Distributions" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">分布</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">分布在统计包密度，累积分布函数，分位数函数和随机变量…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">www.rdocumentation.org</p></div></div></div></a></div></div></div>    
</body>
</html>