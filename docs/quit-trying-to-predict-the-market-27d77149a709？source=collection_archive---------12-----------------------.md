# 不要试图预测市场

> 原文：<https://towardsdatascience.com/quit-trying-to-predict-the-market-27d77149a709?source=collection_archive---------12----------------------->

## 为什么 99.99%的机器学习算法从未真正发挥作用

我经常在我的 Medium Daily Digest 电子邮件中收到相同类型的文章，标题有趣，声称可以用机器学习来预测股市。通常，他们以近乎完美的准确性结束一些极其精确的模型。我承认，这是非常令人兴奋的，也是一个了解这些模型如何工作的好机会，但是在现实世界中使用这些模型是自找麻烦。

![](img/ec42e9e71b1e8be5ffab4f4977ae0137.png)![](img/9677cd2339131e7dd115735a41eeaf56.png)

特斯拉公司的机器学习模型接近完美的准确性。

为了理解为什么这些模型在市场上如此不准确，我将首先解释为什么，然后用 Python 研究一些 LSTM 张量流模型来进一步解释我的推理。

## 为什么市场如此难以预测？

为了回答这个问题，我们先从基础说起。股票市场本质上是投资者的市场，由供求关系驱动。不管听起来多么简单，实际上有无数的因素在起作用。这就是为什么几乎所有能想到的资料都显示，买入并持有策略远比试图把握时机或预测市场更省时、更有利可图。

现在，有了这个说法，你可以从技术上创建一个模型，将所有已知的影响市场的因素考虑在内。然而，绝大多数市场因素实际上是不可能事先知道的，比如自然灾害、流行病和政治动向。哦，还有，市场有时完全是不理性的，所以祝你好运，努力跟上它。

但是你看，即使你能够成功地预测或准确地把握市场时机，其他人也会模仿你的策略，最终导致市场以不同于你预测的方式做出反应。这可能有点令人困惑，所以我将在这里打破它。

假设你有一个预测 XYZ 公司未来股票价格的模型，那么你会用这些知识做什么呢？你很可能会试图用它来赚取大量的利润，促使你在实际市场中创造无限量的买卖信号。所有能接触到这个模型的人也一样。所有这些交易的结果是什么？它会以一种你的模型无法预测的方式影响 XYZ 股票的价格，无论它是暴涨还是暴跌；因此，本质上这里的悖论是，即使使用模型的预测，你也在直接影响未来，以这样或那样的方式使预测过时。

有机会，你可以预测或更确切地说，预测市场的一些趋势，以获得更高的市场成功机会，因为这基本上是市场研究人员和分析师所做的，但这些预测更接近于有根据的猜测，而不是 99%准确的精确预测。此外，市场未来将如何变化的置信区间太大，甚至无法做出简明的预测。

## 用 Python 中的 TensorFlow 创建 LSTM 模型

虽然在市场上使用这样的模型是不明智的，但创建机器学习模型是一种学习和熟悉模型如何工作以及它们潜在能力的好方法。遵循本文的其余部分，不仅要创建一个神经网络来“预测”TSLA 的价格，而且要理解它的缺点在哪里。

导入模块并设置参数

首先，您需要导入依赖项，并设置程序其余部分所需的参数。我们将对 LSTM 模型和 Scikit-Learn 使用 TensorFlow 来测试其准确性。

获取数据并对其进行整形以在模型中工作！

首先，我们必须使用 pandas_datareader 从 Yahoo Finance 读入数据。接下来，为了让 LSTM 模型工作，必须以正确的方式对数据进行预处理。我们可以使用 Scikit-Learn 中的 MinMaxScaler 和模块 NumPy 来实现这一点。我们还必须创建 x_train 和 y_train 数据列表，以发送到下一部分中的模型。

拟合模型并获得预测。

在这里，我们必须构建、编译和训练 LSTM 模型，以便获得最终的预测。幸运的是，TensorFlow 和 Scikit-Learn 让这变得非常简单。模型生成后，我们可以在测试数据上测试它，以获得我们的最终预测，看看它有多准确。对于这个特定的模型，我将 epochs 设置为 5，但是您可以更改它来查看它如何影响模型的输出。

使用预测来实际测试模型。

现在有趣的部分来了。我们成功地使用 LSTM 模型来“预测”股票价格，并最终找到了我们的准确性。在代码的这一部分，我们绘制了训练数据、测试数据和预测，并收到了一系列其他指标，如预测日常运动的准确性、下一个交易日的预测价格以及模型的均方根误差和测试均方误差。

![](img/8ebd305f3bcbafa41a1d7c209ac9a242.png)

TSLA 的 LSTM 模式

乍一看，这个模型似乎非常好。它甚至预测了 2020 年前所未有的冠状病毒大崩溃！

但是，当你进一步滚动时，你会看到模型只是跟踪最后一天的收盘价，因为它已经决定简单地跟踪昨天的收盘价是预测明天价格的“最好”方法。

![](img/a268be3408cd9ee191adc31c628a6e0c.png)

LSTM 模型的特写视图

如果你回头看看我们之前找到的统计数据，你可以证实这一点(我在下面附上了一个截图)。预测每日走势的准确率为 48.19%，甚至低于抛硬币的准确率！！

![](img/72977645c2517daf48f5d4ab795698f3.png)

LSTM 模型的结果

这个故事的寓意是:尽你所能预测股市，但千万不要在现实生活中使用它。非常感谢你的阅读，我希望你喜欢！

*免责声明:本文材料纯属教育性质，不应作为专业投资建议。自行决定投资。*

如果你喜欢这篇文章，看看我下面的其他文章吧！

[](/parse-thousands-of-stock-recommendations-in-minutes-with-python-6e3e562f156d) [## 使用 Python 在几分钟内解析数千份股票推荐！

### 了解如何在不到 3 分钟的时间内解析顶级分析师的数千条建议！

towardsdatascience.com](/parse-thousands-of-stock-recommendations-in-minutes-with-python-6e3e562f156d) [](/making-a-stock-screener-with-python-4f591b198261) [## 用 Python 制作股票筛选程序！

### 学习如何用 Python 制作一个基于 Mark Minervini 的趋势模板的强大的股票筛选工具。

towardsdatascience.com](/making-a-stock-screener-with-python-4f591b198261) [](/creating-a-finance-web-app-in-3-minutes-8273d56a39f8) [## 在 3 分钟内创建一个财务 Web 应用程序！

### 了解如何使用 Python 中的 Streamlit 创建技术分析应用程序！

towardsdatascience.com](/creating-a-finance-web-app-in-3-minutes-8273d56a39f8)