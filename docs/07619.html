<html>
<head>
<title>Geospatial adventures. Step 1: Shapely.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">地理空间冒险。第一步:匀称。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/geospatial-adventures-step-1-shapely-e911e4f86361?source=collection_archive---------16-----------------------#2020-06-08">https://towardsdatascience.com/geospatial-adventures-step-1-shapely-e911e4f86361?source=collection_archive---------16-----------------------#2020-06-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/71cfef7b3932f78433456cc4cf657929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*znG9LlPMkGhUWWut5nDDqg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">使用 KeplerGL 生成的图像</p></figure><div class=""/><div class=""><h2 id="9ccc" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">快速浏览使用 Shapely 库在 Python 中处理几何对象的基础知识。</h2></div><p id="2273" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">这是一系列文章中的第一篇，总结了过去几年中使用 PropTech 处理地理空间数据的一些关键成果。这些将会有所有的东西——地理空间数据集、几何形状、栅格文件、地图、可视化。从最基础的开始，在后面的文章中，朝着更有趣和更有挑战性的方向努力...</p><p id="6d79" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们从介绍身材匀称的<a class="ae lr" href="https://shapely.readthedocs.io/en/latest/manual.html" rel="noopener ugc nofollow" target="_blank">开始吧。毫无疑问，这是我最喜欢的 Python 库之一——非常重要，对于你最终从事的任何几何/地理相关的工作都是绝对必要的。</a></p><p id="db83" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">该库允许您使用三种主要类型的几何对象:点、线串和多边形+几何图形集合(如果您想要组合它们)。还有一堆其他的——线性环、多点、多多边形等。，但是现在这些就够了，这些方法是可以移植的。</p><h2 id="9e9b" class="ls lt jf bd lu lv lw dn lx ly lz dp ma ld mb mc md lh me mf mg ll mh mi mj mk bi translated"><strong class="ak">安装</strong></h2><p id="25fe" class="pw-post-body-paragraph ku kv jf kw b kx ml kg kz la mm kj lc ld mn lf lg lh mo lj lk ll mp ln lo lp ij bi translated">非常标准的安装，使用 pip。如果你像我一样使用 jupyter，你可以直接运行</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="78aa" class="ls lt jf mv b gy mz na l nb nc">!pip install shapely</span></pre><p id="a7ed" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">请注意，GeoPandas 正在使用 Shapely，因此如果您已经安装了 GeoPandas，您可能已经有了 Shapely 的最新版本。您可以在导入 Geopandas 后执行一些 Shapely 操作，而无需单独导入，但是，如果您想要直接处理点和面对象，您仍需要首先加载它们。关于 Geopandas 已经说得够多了，但是我们将在下一篇文章中更详细地讨论它。</p><p id="45f5" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">安装完成后，将其导入笔记本并加载主要几何图形类型:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="eac2" class="ls lt jf mv b gy mz na l nb nc">import shapely<br/>from shapely.geometry import Point, Polygon, LineString, GeometryCollection<br/>import numpy as np</span></pre><p id="8964" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我也在进口 numpy，因为我太喜欢了。不过说真的，我经常发现自己在 shapely 对象和等价的 numpy 坐标数组之间来回跳跃，因为 numpy 允许您以显式矢量化形式更快地进行一些操作，所以从一开始就了解这两者之间的联系是一个好主意。</p><h2 id="b177" class="ls lt jf bd lu lv lw dn lx ly lz dp ma ld mb mc md lh me mf mg ll mh mi mj mk bi translated"><strong class="ak">点状物体</strong></h2><p id="49ae" class="pw-post-body-paragraph ku kv jf kw b kx ml kg kz la mm kj lc ld mn lf lg lh mo lj lk ll mp ln lo lp ij bi translated">顾名思义，这只是二维平面上的一个点，以一对坐标为特征。</p><p id="b05e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Shapely 的一个超级方便的功能是——它允许您查看所有的几何对象，而不必求助于任何图形包。请注意，无论对象在坐标系中的位置如何，当您想要查看它时，它总是以对象为中心。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="a0c8" class="ls lt jf mv b gy mz na l nb nc">pt = Point(10, 10)<br/>pt1 = Point(100, 101)</span></pre><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nd"><img src="../Images/daa6721c5ce543de6d070581626f6886.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sPCtRYH7Rn9CJj-98Ex1WQ.png"/></div></div></figure><p id="58f6" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">您还可以显示对象的字符串表示，只需将 str()括起来，或者将其转换为坐标的 numpy 数组。正如我提到的，我发现后者特别有用，因为我经常发现自己在处理大型几何对象阵列(例如来自 OSM 的超过 600 万个建筑多边形)，如果我想以矢量格式进行计算，numpy 是绝对不可替代的。</p><p id="54e9" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">还有一个将这个字符串表示加载回几何格式的方法，当您必须加载以非几何格式存储的数据(例如从 csv 文件)时，这将非常方便。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nd"><img src="../Images/119304d7e8b6fa39989d0391c4ae1506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gZPQA3G9-4Tl4Z54Yww_GQ.png"/></div></div></figure><p id="d139" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">如果您想要快速查看几个对象，并查看它们如何相互缩放，您所要做的就是将它们转换为几何体集合:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nd"><img src="../Images/1f2c17564527f72052f8442f6c252c54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H8xlBaOZQI2MQLLWsjObLA.png"/></div></div></figure><p id="5b60" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">其他一些简便的方法——距离、坐标采集。</p><p id="f2f5" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[8]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="d217" class="ls lt jf mv b gy mz na l nb nc">pt.distance(pt1)</span></pre><p id="ecfd" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[8]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="05d4" class="ls lt jf mv b gy mz na l nb nc">127.98828071350908</span></pre><p id="9d35" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[9]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="f3a7" class="ls lt jf mv b gy mz na l nb nc">pt.x, pt.y, pt.xy</span></pre><p id="f989" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[9]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="1372" class="ls lt jf mv b gy mz na l nb nc">(10.0, 10.0, (array('d', [10.0]), array('d', [10.0])))</span></pre><p id="50b0" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在继续学习线条之前，还有最后一件事。所有 shapely 对象都有一个. name 属性。例如，当您要将 GeoPandas 或 Pandas 数据帧中存储的大型集合中的每个多边形转换为一组较小的多边形(如格网)时，并且希望有一种简单的方法将它们与原始多边形相关联时，这将非常有用。</p><p id="c565" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[10]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="bf2f" class="ls lt jf mv b gy mz na l nb nc">pt.name = 'My Point'<br/>pt.name</span></pre><p id="4677" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[10]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="4a1b" class="ls lt jf mv b gy mz na l nb nc">'My Point'</span></pre><h2 id="80d2" class="ls lt jf bd lu lv lw dn lx ly lz dp ma ld mb mc md lh me mf mg ll mh mi mj mk bi translated"><strong class="ak">线串</strong></h2><p id="f2bf" class="pw-post-body-paragraph ku kv jf kw b kx ml kg kz la mm kj lc ld mn lf lg lh mo lj lk ll mp ln lo lp ij bi translated">LineStrings 以非常相似的方式启动，只是这次我们有一个元组列表，而不是单个元组。它们可以交叉并多次通过相同的点，但是，不建议使用后者，因为它会对性能产生负面影响，您最好将它们拆分为单独的组件。请注意，点的顺序很重要，因为它决定了您通过它们的顺序(这同样适用于多边形，您将在下面看到)。</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="0e4d" class="ls lt jf mv b gy mz na l nb nc">ln = LineString([(0, 1), (20, 100), (100, 3), (120, 102), (200, 5)])</span></pre><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/7013b8d2503e939dbe609f4c71281e49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tIqm8bgbrp3j9n9izCtO2A.png"/></div></div></figure><p id="8b0d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">与点一样，可以将 LineString 对象转换为点坐标数组。这里保留了顺序，因此这可用于快速获得第一个和最后一个点的坐标——例如，这对于构建表示道路网络的树对象很方便。</p><p id="d3fd" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[13]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="11b4" class="ls lt jf mv b gy mz na l nb nc">np.array(ln)</span></pre><p id="c48c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[13]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="842e" class="ls lt jf mv b gy mz na l nb nc">array([[  0.,   1.],<br/>       [ 20., 100.],<br/>       [100.,   3.],<br/>       [120., 102.],<br/>       [200.,   5.]])</span></pre><p id="8c23" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">或者，如果您希望首先使用与创建 LineString 相同的元组列表表示:</p><p id="52df" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[14]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="9411" class="ls lt jf mv b gy mz na l nb nc">list(ln.coords)</span></pre><p id="f43b" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[14]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="1b60" class="ls lt jf mv b gy mz na l nb nc">[(0.0, 1.0), (20.0, 100.0), (100.0, 3.0), (120.0, 102.0), (200.0, 5.0)]</span></pre><p id="418c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">您也可以只分离出 X 坐标或 Y 坐标(当然，您也可以使用 numpy 来完成):</p><p id="d409" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[15]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="71b2" class="ls lt jf mv b gy mz na l nb nc">list(ln.xy[0]), list(ln.xy[-1])</span></pre><p id="9fe2" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[15]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="76a6" class="ls lt jf mv b gy mz na l nb nc">([0.0, 20.0, 100.0, 120.0, 200.0], [1.0, 100.0, 3.0, 102.0, 5.0])</span></pre><p id="9dfa" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">快速浏览一下图形表示以及我们之前创建的点:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/d1d99371224b1f5fd17ba55427d0697e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OWXQbUysYF4Zni6xg1D_XQ.png"/></div></div></figure><p id="13b4" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">计算点到线的距离、线上的点投影(从起点沿着线的距离)和线的长度非常简单:</p><p id="f9e0" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[17]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="a1d7" class="ls lt jf mv b gy mz na l nb nc">pt.distance(ln)</span></pre><p id="820e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[17]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="15f7" class="ls lt jf mv b gy mz na l nb nc">8.01980198019802</span></pre><p id="1981" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[18]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="03d0" class="ls lt jf mv b gy mz na l nb nc">ln.project(pt), ln.length</span></pre><p id="8723" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[18]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="fc7d" class="ls lt jf mv b gy mz na l nb nc">(10.801980198019802, 453.46769176178475)</span></pre><p id="b0f5" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[19]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="df28" class="ls lt jf mv b gy mz na l nb nc">list(ln.interpolate(ln.project(Point(1, 1))).coords)</span></pre><p id="aa63" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[20]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="3d09" class="ls lt jf mv b gy mz na l nb nc">[(0.039211841976276834, 1.1940986177825703)]</span></pre><p id="e7f0" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">请注意，如果点在线上的投影恰好位于定义的区域之外，则距离将计算到最近的线端。如果你在实际的投影之后，你将需要做一些额外的几何。最简单的方法是延伸直线的第一段和最后一段，并仍然使用相同的投影方法。</p><p id="9282" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">线交点也很简单，即使你有多个交点。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/5cbe9facef58dbc919cea3187642cd99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FWcpau3HmjTZVQTglFFoUw.png"/></div></div></figure><p id="eae9" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">结果是一个多点对象，您可以对其进行迭代，就像这是一个常规列表一样，将点对象作为可迭代对象:</p><p id="7247" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[21]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="4ef6" class="ls lt jf mv b gy mz na l nb nc">str(ln.intersection(LineString([(0, 0), (200, 100)])))</span></pre><p id="7def" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[22]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="435e" class="ls lt jf mv b gy mz na l nb nc">'MULTIPOINT (72.55474452554745 36.27737226277372, 110.561797752809 55.28089887640449, 144.5255474452555 72.26277372262774)'</span></pre><p id="c008" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[22]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="ce09" class="ls lt jf mv b gy mz na l nb nc">[np.array(a) for a in ln.intersection(<br/>    LineString([<br/>        (0, 0),<br/>        (200, 100)<br/>    ])<br/>)]</span></pre><p id="341d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[22]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="c84d" class="ls lt jf mv b gy mz na l nb nc">[array([72.55474453, 36.27737226]),<br/> array([110.56179775,  55.28089888]),<br/> array([144.52554745,  72.26277372])]</span></pre><h2 id="c86e" class="ls lt jf bd lu lv lw dn lx ly lz dp ma ld mb mc md lh me mf mg ll mh mi mj mk bi translated"><strong class="ak">多边形</strong></h2><p id="5fd7" class="pw-post-body-paragraph ku kv jf kw b kx ml kg kz la mm kj lc ld mn lf lg lh mo lj lk ll mp ln lo lp ij bi translated">毫不奇怪，创建一个与创建一个 LineString 非常相似，并且与 LineString 一样，列出点的顺序很重要。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/b55f3c2064505e61ed7dac313a4a9ed0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vXSGpJ-04oHCw_IufMweOg.png"/></div></div></figure><p id="3556" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">多边形内部可以有洞，这些洞的定义遵循一个简单的规则:多边形([多边形坐标列表]，[洞列表])，其中每个洞本身就是一个多边形。请注意，表示洞的多边形必须完全位于原始多边形内部，或者只能在一个地方接触到原始多边形。</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/b041eb101a923dbbfdfaec89c0bc5d1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WZiFMA9fzwDVza__ERJK_w.png"/></div></div></figure><p id="2ee3" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">请注意，多边形不能像线串和点那样直接转换成点的集合。相反，我们必须处理它们的外部和内部轮廓(它们本身就是线条，也就是一个自身循环的线条)。对于内部边界，我们得到一个迭代器:</p><p id="60e9" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[25]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="f7e9" class="ls lt jf mv b gy mz na l nb nc">np.array(poly.exterior)</span></pre><p id="3a47" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[25]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="67e3" class="ls lt jf mv b gy mz na l nb nc">array([[0., 0.],<br/>       [0., 1.],<br/>       [1., 1.],<br/>       [1., 0.],<br/>       [0., 0.]])</span></pre><p id="c55f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[26]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="786d" class="ls lt jf mv b gy mz na l nb nc">[np.array(a) for a in poly.interiors]</span></pre><p id="fa7a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[26]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="8e50" class="ls lt jf mv b gy mz na l nb nc">[array([[0.5, 0.5],<br/>        [0.5, 0.6],<br/>        [0.6, 0.6],<br/>        [0.6, 0.5],<br/>        [0.5, 0.5]]), array([[0.1, 0.1],<br/>        [0.1, 0.5],<br/>        [0.5, 0.5],<br/>        [0.5, 0.1],<br/>        [0.1, 0.1]])]</span></pre></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><p id="ba15" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">几个额外的方法作为一个追赶者:</p><p id="c18e" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg">多边形的质心</strong>(或者，类似地，线对象)</p><p id="26ab" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[27]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="6622" class="ls lt jf mv b gy mz na l nb nc">np.array(poly.centroid)</span></pre><p id="4b53" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[27]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="fea0" class="ls lt jf mv b gy mz na l nb nc">array([0.53795181, 0.53795181])</span></pre><p id="6549" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg">检查点是否在多边形内的两种不同方法</strong>:</p><p id="7f45" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[28]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="266c" class="ls lt jf mv b gy mz na l nb nc">Point(0.7, 0.7).within(poly), poly.contains(Point(0.7, 0.7))</span></pre><p id="62ba" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[28]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="a9fd" class="ls lt jf mv b gy mz na l nb nc">(True, True)</span></pre><p id="9722" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">你可以很容易地<strong class="kw jg">将线串和点对象转换成多边形</strong>通过在它们周围添加一个缓冲区</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/aab8601dd5b4a41ab401ef9ddfd54c14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BPO39Wpv8Gi2SwAavCtTXw.png"/></div></div></figure><p id="5518" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">注意-这仍然是一个多边形(不是严格意义上的圆)，在这种情况下，由 66 个点组成。</p><p id="c76d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[30]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="608c" class="ls lt jf mv b gy mz na l nb nc">len(np.array(Point(0.7, 0.7).buffer(1).exterior))</span></pre><p id="9043" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[30]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="ac0b" class="ls lt jf mv b gy mz na l nb nc">66</span></pre><p id="7ba4" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">如果需要，您可以通过在缓冲区中传递分辨率参数来提高默认分辨率(16)的精度:</p><p id="f019" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[31]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="d657" class="ls lt jf mv b gy mz na l nb nc">len(np.array(Point(0.7, 0.7).buffer(1, resolution=32).exterior))</span></pre><p id="85d9" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[31]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="e365" class="ls lt jf mv b gy mz na l nb nc">130</span></pre><p id="ff9a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">缓冲区允许您轻松地关联多边形和其他几何体对象。例如，如果你想用一条特定宽度的线切割一个多边形</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/c58f16ce22b7c697d64212ef7f022d14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aNPOZ6wDpacHpl2zWH753A.png"/></div></div></figure><p id="7565" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">或者切割它而不损失任何表面积:</p><figure class="mq mr ms mt gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/6fa33ed08aadd43fdfee9e42a4098af6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wjyJ6KcUJ5-bzXTxyRJ08A.png"/></div></div></figure><p id="f711" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">最后，超级有用的<strong class="kw jg"> bounds </strong> metod，可以应用于多边形、线串和多对象，返回最小边界矩形的左下角和右上角的坐标，与 XY 轴对齐。</p><p id="165f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在[34]中:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="ca5f" class="ls lt jf mv b gy mz na l nb nc">Point(10, 10).buffer(5).bounds</span></pre><p id="1ec5" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">Out[34]:</p><pre class="mq mr ms mt gt mu mv mw mx aw my bi"><span id="cc0b" class="ls lt jf mv b gy mz na l nb nc">(5.0, 5.0, 15.0, 15.0)</span></pre><p id="3c0d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">今天到此为止。下一站<a class="ae lr" href="https://medium.com/@datingpolygons/geospatial-adventures-step-2-pandas-vs-geopandas-16e842d0e3a7" rel="noopener">熊猫大战地质熊猫</a>！</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><p id="b94c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><em class="lq">本系列其他帖子:</em></p><p id="3399" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lr" href="https://medium.com/@datingpolygons/geospatial-adventures-step-2-pandas-vs-geopandas-16e842d0e3a7" rel="noopener"> <em class="lq">地理空间冒险。第二步:熊猫大战地球熊猫</em> </a></p><p id="029f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lr" href="https://medium.com/analytics-vidhya/geospatial-adventures-step-3-polygons-grow-on-r-trees-2f15e2712537" rel="noopener"> <em class="lq">地理空间历险记。第三步。多边形生长在 R 树上</em> </a></p><p id="e613" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lr" href="https://medium.com/@datingpolygons/geospatial-adventures-step-4-the-colour-of-magic-or-if-i-dont-see-it-it-doesn-t-exist-56cf7fb33ba9" rel="noopener"> <em class="lq">地理空间历险记。第四步。魔法的色彩或者如果我没有看到它——它就不存在</em>T3】</a></p><p id="2c7d" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lr" href="https://medium.com/@datingpolygons/geospatial-adventures-step-5-leaving-the-flatlands-or-flying-over-the-sea-of-polygons-846e45c7487e" rel="noopener"> <em class="lq">地理空间历险记。第五步。离开平地或飞越多边形的海洋</em> </a></p></div></div>    
</body>
</html>