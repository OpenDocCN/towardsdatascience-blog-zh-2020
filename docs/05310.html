<html>
<head>
<title>Create ML: A GUI for training Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建ML:一个用于训练神经网络的GUI</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-ml-a-gui-for-training-neural-networks-72bd1d651275?source=collection_archive---------32-----------------------#2020-05-05">https://towardsdatascience.com/create-ml-a-gui-for-training-neural-networks-72bd1d651275?source=collection_archive---------32-----------------------#2020-05-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bd4c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让我们用3行代码创建一个狗和猫的分类器。</h2></div><p id="2cfa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">几周前，我买了一台新的笔记本电脑——2019年的MacBook Pro，从那以后我就喜欢上了它。很自然地，我开始试验Swift T1和T2 Xcode T3，主要是为了创建一些虚拟的iOS应用。在那里我发现了Create ML——一个用于训练定制神经网络的GUI工具。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/b093cde30edf559ee419059753c8c0f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1OWkWqqHV6BrTaQM"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">照片由<a class="ae lu" href="https://unsplash.com/@tomstanislavsky?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">托马什·斯坦尼斯拉夫斯克</a>在<a class="ae lu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="5145" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里有一个直接来自苹果官方文档的简短声明:</p><blockquote class="lv lw lx"><p id="6271" class="ki kj ly kk b kl km ju kn ko kp jx kq lz ks kt ku ma kw kx ky mb la lb lc ld im bi translated">将Create ML与Swift和macOS playgrounds等熟悉的工具配合使用，在Mac上创建和训练定制的机器学习模型。您可以训练模型来执行任务，如识别图像、从文本中提取含义或查找数值之间的关系。[1]</p></blockquote><p id="fb45" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">很好。所以你可以看到，它不仅仅是像我们今天要做的图像分类。</p><p id="43ba" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先要注意的是，对于大多数用户来说，创建ML肯定会有一个巨大的缺点——这是一个苛刻的要求:<strong class="kk iu">你需要在macOS上运行。</strong></p><p id="539b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你没有苹果电脑，这并不是世界末日，因为像MacInCloud.com这样的解决方案已经存在。我还没有亲自测试过它们，所以我不能保证你会有一个完美流畅的体验——但总比没有好。</p><p id="3dab" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以概括一下，如果你想继续，你需要运行macOS，并且安装最新版本的Xcode 。</p><p id="e50c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这篇文章的结构如下:</p><ol class=""><li id="bf6f" class="mc md it kk b kl km ko kp kr me kv mf kz mg ld mh mi mj mk bi translated">数据集下载</li><li id="19f6" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated">3行来训练他们</li><li id="0778" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated">模特培训</li><li id="2181" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated">模型评估</li><li id="4bbf" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated">模型保存</li><li id="5792" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated">结论和下一步措施</li></ol><p id="00ef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">简单提一下，在下一篇文章中，我们将创建一个iOS应用程序，并将我们的训练模型链接到它。<a class="ae lu" href="https://github.com/daradecic/iOS_CNN_CatVsDog" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>已经存在，可以随意查看。</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="efc5" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">数据集下载</h1><p id="b348" class="pw-post-body-paragraph ki kj it kk b kl np ju kn ko nq jx kq kr nr kt ku kv ns kx ky kz nt lb lc ld im bi translated">如前所述，我们将制作一个狗和猫的图像分类器，数据集可以从这里下载<a class="ae lu" href="https://s3.amazonaws.com/content.udacity-data.com/nd089/Cat_Dog_data.zip" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="9484" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您已经下载并解压缩了它，那么在根文件夹中，您将拥有以下结构:</p><pre class="lf lg lh li gt nu nv nw nx aw ny bi"><span id="f054" class="nz my it nv b gy oa ob l oc od">├── test<br/>│   ├── cat<br/>│   └── dog<br/>└── train<br/>    ├── cat<br/>    └── dog</span></pre><p id="99da" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里有两件事你必须知道:</p><ol class=""><li id="17c9" class="mc md it kk b kl km ko kp kr me kv mf kz mg ld mh mi mj mk bi translated">在<strong class="kk iu">训练</strong>和<strong class="kk iu">测试</strong>文件夹中的子文件夹名称必须相同</li><li id="1291" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated">预测的类别名称将从子文件夹名称中推断出来——因此这里的<strong class="kk iu">猫</strong>和<strong class="kk iu">狗</strong></li></ol><p id="af9e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ly">还在跟踪？</em>太好了，让我们在开始训练之前做好一切准备。</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="73bd" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">3行来统治他们</h1><p id="7bfd" class="pw-post-body-paragraph ki kj it kk b kl np ju kn ko nq jx kq kr nr kt ku kv ns kx ky kz nt lb lc ld im bi translated">我们现在可以打开Xcode并创建一个新的<strong class="kk iu">游乐场</strong>——一个用于macOS的空白游乐场:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oe"><img src="../Images/63264ae50a58e672191f36f014ae28e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4QeruT-CeEDXju3zLmdZhQ.png"/></div></div></figure><p id="4d6b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">随意命名，点击<strong class="kk iu">下一个</strong>。我们现在看到了以下屏幕:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi of"><img src="../Images/9cc931a84b1c27b98714d795ea4fdd3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k4qTTuNE3YC73w9YMDg0Qg.png"/></div></div></figure><p id="eae8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">太好了！在左边部分，我们将编写我们的代码，在右边部分，我们将训练我们的模型。</p><p id="4478" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在可以删除该占位符代码，并输入以下3行代码:</p><pre class="lf lg lh li gt nu nv nw nx aw ny bi"><span id="e954" class="nz my it nv b gy oa ob l oc od">import CreateMLUI</span><span id="4cee" class="nz my it nv b gy og ob l oc od">let builder = MLImageClassifierBuilder()<br/>builder.showInLiveView()</span></pre><p id="79b3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您的屏幕应该是这样的:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi of"><img src="../Images/d1b4864719c7bdad5ccc0861f7e979bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KqQsB-pG4SuJeCfo0w0qMQ.png"/></div></div></figure><p id="0b97" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不要担心弃用警告，因为代码会工作得很好。现在，我们可以单击代码下方的蓝色播放按钮。几秒钟后，您将看到以下内容:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi of"><img src="../Images/14dda817bed1bc3cc221fde7cf37a8cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2U7t_jezBfY-AT8KHRbFgw.png"/></div></div></figure><p id="3eef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就这样，我们可以开始训练了！</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="2711" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">模特培训</h1><p id="0502" class="pw-post-body-paragraph ki kj it kk b kl np ju kn ko nq jx kq kr nr kt ku kv ns kx ky kz nt lb lc ld im bi translated">好了，现在你唯一要做的就是将<strong class="kk iu"> train </strong>文件夹拖到这个<strong class="kk iu"> Drop Images开始训练</strong>部分:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oh"><img src="../Images/3e442fdcc337f74ac7158d9e4574c1fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nFu9V0XWZpPAF2S3Q2h8kA.png"/></div></div></figure><p id="281c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">训练过程将立即开始，由于我们有超过20K的训练图像，这显然需要一些时间。所以，喝杯咖啡，休息一下，或者看看火车模型。</p><p id="32f2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，过了一段时间(在我的机器上大约半小时)，模型被训练:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oi"><img src="../Images/536f13c89532faffe9e3e7ccace5024d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j3Z-3BsnTyOTnmlYfI2MqA.png"/></div></div></figure><p id="e319" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们所看到的，它在训练集上表现出色，只需看看它在以前看不到的数据上的表现如何——因此在测试集上。让我们在下一节中探索这一点。</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="f722" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">模型评估</h1><p id="409d" class="pw-post-body-paragraph ki kj it kk b kl np ju kn ko nq jx kq kr nr kt ku kv ns kx ky kz nt lb lc ld im bi translated">要评估测试集上的模型，只需将<strong class="kk iu">测试</strong>文件夹拖至<strong class="kk iu">拖放图像以开始测试</strong>部分:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oh"><img src="../Images/e5715de4a57176eb75929aaf0a5240e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Xwq06Z4Dd-oMwfYmAoiWg.png"/></div></div></figure><p id="974e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">测试过程将大大缩短时间，因为我们只有2500张图像用于测试。尽管如此，你也可以休息一会儿，直到它结束。</p><p id="f12c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好了，完成了吗？爽。正如我们所看到的，测试集上的准确率仍然令人印象深刻——98%。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oj"><img src="../Images/58cf247eb9ca228240caa7e5647c8eb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XndBVK4Q9jRMQ8-1DPqVuQ.png"/></div></div></figure><p id="a0b1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们知道我们的模型已经可以生产了，让我们在下一节探索如何导出它。</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="5feb" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">模型保存</h1><p id="a40a" class="pw-post-body-paragraph ki kj it kk b kl np ju kn ko nq jx kq kr nr kt ku kv ns kx ky kz nt lb lc ld im bi translated">我们需要保存这个模型，以便以后在我们的iOS应用程序中使用。为此，向上滚动模型培训部分并展开下拉列表:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi oj"><img src="../Images/8f190a9d609c293c1409c88a0573a6cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JGR6YOsQsdzgve3Qr_CeMQ.png"/></div></div></figure><p id="33ff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您对自动填充的选项感到满意，请点击<strong class="kk iu">保存</strong>。记住，默认情况下，模型将被保存到<strong class="kk iu"> Documents </strong>文件夹中——所以让我们快速验证一下它是否在那里:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi ok"><img src="../Images/2f94c14a2362eb1aa123b25adb8f5090.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A8oGaK-WUxr7s8Co-hWENg.png"/></div></div></figure><p id="72fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">厉害！注意<strong class="kk iu">。mlmodel </strong>扩展？对于您希望在iOS上部署的任何模型，这都是强制性的，所以请记住这一点。</p><p id="fa92" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们今天的工作已经完成了，所以让我们做一个简短的总结。</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="088c" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">结论</h1><p id="c682" class="pw-post-body-paragraph ki kj it kk b kl np ju kn ko nq jx kq kr nr kt ku kv ns kx ky kz nt lb lc ld im bi translated">做完这一切后，你可能想知道这个模型到底是怎么表现得这么好的？苹果官方声明如下:</p><blockquote class="lv lw lx"><p id="0daa" class="ki kj ly kk b kl km ju kn ko kp jx kq lz ks kt ku ma kw kx ky mb la lb lc ld im bi translated">Create ML利用了苹果产品内置的机器学习基础设施，如照片和Siri。这意味着你的图像分类和自然语言模型更小，训练时间更少。[2]</p></blockquote><p id="e9f8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">简而言之，这意味着苹果有很多预训练的模型，它只需要调整输出层(也称为<strong class="kk iu">迁移学习</strong>)。如果你以前用过<em class="ly"> ResNet </em>或者<em class="ly"> AlexNet </em>，你就会知道我在说什么。</p><p id="62d1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是现在你有了它，大约30分钟来训练模型，并在测试集上达到98%的准确率——对于只有3行代码来说非常令人印象深刻。</p><p id="db45" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请继续关注下面的文章，我们将把这个模型整合到一个iOS应用程序中。</p><p id="172f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读。</p></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><p id="3eb4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="ly">喜欢这篇文章吗？成为</em> <a class="ae lu" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="ly">中等会员</em> </a> <em class="ly">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="ol om gp gr on oo"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="op ab fo"><div class="oq ab or cl cj os"><h2 class="bd iu gy z fp ot fr fs ou fu fw is bi translated">通过我的推荐链接加入Medium-Dario rade ci</h2><div class="ov l"><h3 class="bd b gy z fp ot fr fs ou fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ow l"><p class="bd b dl z fp ot fr fs ou fu fw dk translated">medium.com</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc lo oo"/></div></div></a></div></div><div class="ab cl mq mr hx ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="im in io ip iq"><h1 id="ecac" class="mx my it bd mz na nb nc nd ne nf ng nh jz ni ka nj kc nk kd nl kf nm kg nn no bi translated">资源</h1><p id="245f" class="pw-post-body-paragraph ki kj it kk b kl np ju kn ko nq jx kq kr nr kt ku kv ns kx ky kz nt lb lc ld im bi translated">[1]<a class="ae lu" href="https://developer.apple.com/documentation/createml" rel="noopener ugc nofollow" target="_blank">https://developer.apple.com/documentation/createml</a></p><p id="51f5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">[2]<a class="ae lu" href="https://developer.apple.com/documentation/createml" rel="noopener ugc nofollow" target="_blank">https://developer.apple.com/documentation/createml</a></p></div></div>    
</body>
</html>