<html>
<head>
<title>Don’t Use Uniform Priors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不要使用统一的前科</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/stop-using-uniform-priors-47473bdd0b8a?source=collection_archive---------24-----------------------#2020-03-02">https://towardsdatascience.com/stop-using-uniform-priors-47473bdd0b8a?source=collection_archive---------24-----------------------#2020-03-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6341" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">它们在统计学上没有意义</h2></div><p id="490b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一个微不足道的咆哮，但却是必要的。我们需要让从业者不再使用统一的前科。概率编程发展很快，这很好，但这意味着有些人学习了MCMC，却从未学习过ANOVA。</p><p id="c6a8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">贝叶斯统计学家一致认为，统一的先验知识是愚蠢的。标准文件<a class="ae le" href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations" rel="noopener ugc nofollow" target="_blank">不鼓励统一的前科</a>。它们出现在教科书中是为了简化计算——我们不想让学生在交流概念时陷入繁琐的计算中。然而，统一的先验知识在教科书之外几乎没有位置。</p><p id="c8cf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在解释了原因之后，我将在文章的后半部分提供选择更好先验的方法，记住实际应用，比如A/B测试。</p><h1 id="5fd7" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">无信息的前科？更像是荒谬的前科</h1><p id="2fd3" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">一篇<a class="ae le" href="https://medium.com/analytics-vidhya/how-this-frequentist-turned-bayesian-7066e210a301?source=friends_link&amp;sk=578af7782e8824afe55043bc5d6c2838" rel="noopener">的前一篇文章</a>解释了附在不具信息性的前文中的所有不合理的陈述。我们应该使用先前的预测检查来诊断我们的病史，最好是通过<a class="ae le" href="https://arxiv.org/pdf/1709.01449.pdf" rel="noopener ugc nofollow" target="_blank">可视化</a>。贝叶斯模型是可生成的，我们可以模拟一些数据来评估我们假设的合理性。</p><p id="7b61" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我会编造一个愚蠢的对话来说明我对统一先验的反对。在这种情况下，我们希望用大n进行单侧假设检验。</p><p id="33fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">爱丽丝:“什么是95%的置信区间？”</p><p id="7e71" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">鲍勃:“参数有95%的概率在区间内。”</p><p id="ce95" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">爱丽丝:“不！别开玩笑了！例如，如果我们知道参数为0，那么它包含在这个95% CI中的概率为0:"</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/fcb30cb40dd8b1ca5d4dca2bd9da2488.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*JVmhha4e29URVQkRWIz9iA.jpeg"/></div></figure><p id="b5d0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">鲍勃:“哦，对了。如果我们从总体中随机抽取大小为n的样本，那么95%的区间将覆盖真实参数。”</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/78855dd841a0dc2d5eb2dcea83f3ebae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*w5KKRdGk3pe-5i5VgwF5Ew.png"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated"><a class="ae le" href="https://en.m.wikipedia.org/wiki/File:NYW-confidence-interval.svg" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="cd44" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">艾丽斯:“是的！什么是p值？”</p><p id="61f1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">鲍勃:“零假设正确的概率。”</p><p id="b7e2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">爱丽丝:“不！不好！”</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/0474aa9a8b5a4251d6620b4ba58d060f.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*6q5tvrE3zjFoy9YFWttonQ.jpeg"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated"><a class="ae le" href="https://www.pickpik.com/spray-water-mist-cleaner-background-black-61136" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="100d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">鲍勃:“嗯，我的意思是，假设零假设是真的，这是观察测试统计的概率或更极端的东西。”</p><p id="e177" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">爱丽丝:“对！重要的是要精准！”</p><p id="84b7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">鲍勃:“但是这太令人困惑和不直观了！我们如何向外行人解释？哦，我知道了！我们在那上面打一个制服prior怎么样？”</p><p id="a15e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">爱丽丝:“你什么意思？”</p><p id="edd2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">鲍勃:“那么95%可信区间与95%置信区间相同，但我们可以说参数有95%的概率在区间内！”</p><p id="f0ce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">爱丽丝:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/fbe70453270bd6e82e7a4915b686df8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*pfmbIB03ulx0W-pCxJ30gA.jpeg"/></div><p class="ml mm gj gh gi mn mo bd b be z dk translated"><a class="ae le" href="https://knowyourmeme.com/memes/wait-thats-illegal" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="e6dd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">鲍勃:“忘记令人困惑的p值！我们可以给人们零假设为真的概率！在这里，我放置一个均匀的β(1，1)先验，在抛一次硬币并得到正面后，我得出结论，有75%的概率P(H) &gt; 0.5！”</p><p id="cdbd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">爱丽丝:“但是那个结论完全是荒谬的！你真的认为世界上大多数硬币都是极不公平的吗？”</p><p id="cc4b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">鲍勃:“这叫做贝叶斯。你没听说过所有的流行吗？这比i n t e r p r e t a b l e要多得多。我们改变几个词，然后以前不正确的陈述神奇地变成了正确的。将军，常客！”</p><h1 id="b9f6" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">选择更好的前科</h1><p id="eadc" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">统一先验不提供任何<a class="ae le" href="https://en.wikipedia.org/wiki/Regularization_(mathematics)" rel="noopener ugc nofollow" target="_blank">正则化</a>，尽管这是贝叶斯的主要优势之一。更糟糕的是，如果你选择一个均匀的(0，10)先验，那么你就是在这个区间之外放置了0质量，并且<a class="ae le" href="https://en.wikipedia.org/wiki/Bernstein%E2%80%93von_Mises_theorem" rel="noopener ugc nofollow" target="_blank"> Bernstein-von Mises定理</a>不成立。换句话说，即使你有无限的数据，你仍然可能在这些先验知识上犯严重的错误。</p><p id="64a8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在缺乏知情先验信念的情况下，我们仍然可以做得比一致先验更好。正如<a class="ae le" href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations" rel="noopener ugc nofollow" target="_blank"> Stan文档</a>所建议的:</p><blockquote class="mr ms mt"><p id="879a" class="ki kj mu kk b kl km ju kn ko kp jx kq mv ks kt ku mw kw kx ky mx la lb lc ld im bi translated">不要使用统一的先验或更一般的硬约束，除非界限代表真正的约束(例如比例参数被限制为正，或相关性被限制为-1和1之间)。一些例子:</p><p id="bbc2" class="ki kj mu kk b kl km ju kn ko kp jx kq mv ks kt ku mw kw kx ky mx la lb lc ld im bi translated">您认为参数可以是从0到1的任何值，因此您将prior设置为uniform(0，1)。请改用normal(.5，. 5)。</p></blockquote><h2 id="16a0" class="my lg it bd lh mz na dn ll nb nc dp lp kr nd ne lr kv nf ng lt kz nh ni lv nj bi translated">经验贝叶斯</h2><p id="ea2e" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated"><a class="ae le" href="https://en.wikipedia.org/wiki/Empirical_Bayes_method" rel="noopener ugc nofollow" target="_blank">经验贝叶斯</a>利用你的数据得出先验。我们将忽略“从数据中估计出来的先验值是先验值吗？”在实践中，经验贝叶斯非常有效。詹姆斯-斯坦估计量的表现让人们困惑了一段时间，但我们已经接受了这一点，就像许多药物一样，重要的是它是有效的。</p><p id="6317" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最简单的方法是使用<a class="ae le" href="https://en.wikipedia.org/wiki/Method_of_moments_(statistics)" rel="noopener ugc nofollow" target="_blank">矩量法</a>。假设您正在测试50/50分割的转换率。结合你所有的观察，计算转换的均值和方差，并用它们来估计你将用作先验的<a class="ae le" href="https://en.wikipedia.org/wiki/Beta_distribution" rel="noopener ugc nofollow" target="_blank">贝塔分布</a>的α和β。假设均值和方差分别为0.2和0.01。然后:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/b9f9ee8fa34bbc76456d8c359a381909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*pWyqfKfKnU-DjjVZnUEh0w.jpeg"/></div></figure><p id="4e9e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，根据经验贝叶斯，我们的先验应该是Beta(3，12)。</p><p id="c798" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您对每个用户有多个观察值或没有观察值，例如购买量，那么您希望在使用矩量法之前按用户进行汇总(例如总购买量、购买次数)。请记住，有些用户购买了0次，我们需要将他们包括在估算中。我们假设参数因人而异，而不是因购买而异。</p><h2 id="7aa4" class="my lg it bd lh mz na dn ll nb nc dp lp kr nd ne lr kv nf ng lt kz nh ni lv nj bi translated">贝叶斯分层模型</h2><p id="a6ae" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">分层模型可以解释为从数据中学习先验知识。您可以尝试对此运行MCMC，其中x_i是我们的第I个观察值，β_ j是该组的平均值(例如，对照组与治疗组):</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/7e778c44e3e86ee9b23b2a60227a1a88.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*ZH0qFR4Hiy8qqbRnj3ugyw.jpeg"/></div></figure><p id="7dfd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">选择的先验是一般性的，但是你应该根据你的历史数据得到更多的信息，特别是对于mu。此外，您可以根据您在实验中评估的指标做出更好的分布假设。即使超参数的先验非常弱，在部分汇集之后，我们仍然应该得到β的合理分布。</p><h2 id="95e2" class="my lg it bd lh mz na dn ll nb nc dp lp kr nd ne lr kv nf ng lt kz nh ni lv nj bi translated">N(0，1)</h2><p id="b2f8" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">可笑的是，你总是可以重新调整你的数据，使N(0，1)先验有意义。例如，如果我们认为1%的变化是合理的，但20%的变化是不可能的，那么重新调整你的数据(或正常的先验)来反映这一点。如果你害怕离群值的影响，尝试使用t分布作为先验。正如本节开始时提到的，正态先验几乎总是比均匀先验好。</p><h1 id="7a04" class="lf lg it bd lh li lj lk ll lm ln lo lp jz lq ka lr kc ls kd lt kf lu kg lv lw bi translated">最后</h1><p id="2e66" class="pw-post-body-paragraph ki kj it kk b kl lx ju kn ko ly jx kq kr lz kt ku kv ma kx ky kz mb lb lc ld im bi translated">每当你想使用制服优先，记住:<strong class="kk iu">只是不要</strong>。</p></div></div>    
</body>
</html>