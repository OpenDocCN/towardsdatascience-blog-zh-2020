<html>
<head>
<title>Understanding the Bias-Variance Tradeoff and visualizing it with example and python code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解偏差-方差权衡，并通过示例和python代码将其可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-the-bias-variance-tradeoff-and-visualizing-it-with-example-and-python-code-7af2681a10a7?source=collection_archive---------7-----------------------#2020-02-17">https://towardsdatascience.com/understanding-the-bias-variance-tradeoff-and-visualizing-it-with-example-and-python-code-7af2681a10a7?source=collection_archive---------7-----------------------#2020-02-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e4db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">机器学习中最重要和最基本的主题之一是偏差-方差权衡。在本文中，我们将详细介绍什么是偏差-方差权衡，它来自哪里，为什么必须考虑它，它如何影响我们的底层系统，以及可以做些什么来改进我们的ML模型。</p><h1 id="eb95" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">上下文:它源于哪里？</h1><p id="5d90" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">ML系统背后的总体思想是从收集的样本中建模数据集的隐藏分布。如果您从分布中抽取足够的样本，您可以得到一个相当精确的分布的重新创建，如下所示。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/bf09fecc05e4778d81f246870877f732.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DfRL_SLfgLVwIpzHw71LtQ.png"/></div></div></figure><p id="d397" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">给定(x，y)对，估计f。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ma"><img src="../Images/7c78d2bf8f62a2b2347856b987c4c950.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hymytuOcW8zjS-glWC5XbQ.png"/></div></div></figure><p id="2aaf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但问题是，在现实生活中，收集的样本通常是嘈杂的。这种噪声的来源可能有很多因素，如量化、感官限制等。因此，我们得不到分布的精确输出，而是在其中加入了噪声因子。因此，现在的问题是，在给定输入x的情况下，估计函数f及其相应的噪声输出y。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/3b5b9fb9f97b1f916f8b4683b3148889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eSiVJ_aZwVfo_fXE1xJUng.png"/></div></div></figure><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mb"><img src="../Images/8c72080cc5a74431aade1977f7d859cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MW0JR7IZtjq5LCOweAoL0A.png"/></div></div></figure><p id="ca62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目标是有效地估计函数f并滤除噪声。由于您对添加到样本输出中的噪声了解不多，如果处理不当，ML系统最终会将输入x映射到有噪声的输出y(称为过拟合)。这种映射不是函数f的精确表示，并且对于看不见的测试数据产生很高的误差。</p><p id="7189" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">偏差-方差权衡告诉我们，在存在噪声的情况下，我们的基础系统(f`(x))应该有多复杂，才能相当准确地代表数据集的分布。</p><h1 id="be83" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">术语:什么是ML系统中的偏差和差异:</h1><p id="0ff4" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">在我们的ML系统中，偏差和方差都是误差的来源。假设我们有一个训练数据集<strong class="jp ir"><em class="mc">【D】</em></strong>，由从隐藏分布中采样的(x，y)对组成(<strong class="jp ir"> <em class="mc"> y=f(x)+e </em> </strong>)。我们从数据集<strong class="jp ir"><em class="mc"/></strong>建立模型<strong class="jp ir"> <em class="mc"> f` </em> </strong>，使得训练标签和预测值之间的误差最小化(<strong class="jp ir"><em class="mc">error = y-f `(x)</em></strong>)。</p><h1 id="4922" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">偏见:</strong></h1><p id="9edf" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">偏差被定义为平均模型预测值<strong class="jp ir"> <em class="mc"> f`(x) </em> </strong>和地面真实值<strong class="jp ir"> <em class="mc"> f(x) </em> </strong>之间的误差</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi md"><img src="../Images/fd908b76897fdaea84c4f4f7a92b4f97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tge8zF6kZXBbR2g_10V0_w.png"/></div></div></figure><p id="05a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对从不同数据子集<strong class="jp ir"> D_i </strong>预测的函数进行期望。更简单地说，你从隐藏分布中采样<strong class="jp ir"> n </strong>个不同的数据集<strong class="jp ir"> D_i </strong>(每个数据集由多个(x，y)对组成)，然后估计<strong class="jp ir"> n </strong>个不同的函数<strong class="jp ir"> <em class="mc"> f_i . </em> </strong></p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi me"><img src="../Images/0d8b919b8c1a0adde08e60ffd53d3cc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qv-QpT5o8u2HiAkmPzXKeA.png"/></div></div></figure><p id="34a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">估计函数的偏差告诉我们基础模型预测值的能力。一般来说，更简单的模型不能捕捉高维数据的复杂性，因此它们有更高的偏差。例如，您有一个从正弦曲线采样的数据集，并且您试图使用一次多项式来估计它，即通过函数<strong class="jp ir"> <em class="mc"> y = ax+b. </em> </strong>无论您采样多少个数据点(x，y)，直线将永远无法捕捉正弦曲线的趋势。因此，对于正弦曲线，直线模型具有非常高的偏差。另一方面，假设您将多项式的次数增加到3次，即现在通过<strong class="jp ir"> <em class="mc"> y = ax +bx+c. </em> </strong>对其进行估计，该多项式将比前一个多项式的性能好得多，因此在估计正弦曲线时，3次多项式的偏差比1次多项式的偏差小得多。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mf"><img src="../Images/d6a0fba6599786b35124e2bacf25fd8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cp_O8__Gm663JLw-I0S1TA.png"/></div></div></figure><p id="a1a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">模型的高偏差与以下因素有关</p><ol class=""><li id="d467" class="mg mh iq jp b jq jr ju jv jy mi kc mj kg mk kk ml mm mn mo bi translated">拟合不足—未能捕捉到数据趋势</li><li id="1aee" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">更强调概括</li><li id="0d63" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">训练和测试数据集的错误率都很高</li><li id="8ece" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">过于简化的模型</li></ol><h1 id="0633" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">差异:</h1><p id="94e2" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">方差是指给定数据集的模型预测的平均可变性。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mu"><img src="../Images/211bde58fe78243a5e3f6beee49ca858.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bpHcbO7ajSVsl2Chqeqh2Q.png"/></div></div></figure><p id="541a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">估计函数的方差告诉您该函数能够根据数据集中的变化进行多大程度的调整。方差越大，函数对变化的数据集越稳健。例如，假设您训练两个不同的多项式来拟合从正弦曲线(1次和3次多项式)采样的数据。你在三个不同的数据集(D1、D2和D3)上训练这两个多项式。下图显示了跨多项式次数和数据集的估计函数。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mv"><img src="../Images/b6b107b215d7eba2c43286404d1aea11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eW3iQHXDQ3uvM3O3Rw0LdA.png"/></div></div></figure><p id="ea73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可以看出，1次多项式在三个不同的数据集之间变化不大(因此方差较低)，而3次多项式的估计彼此相差很大(因此方差较高)。</p><p id="c3e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">模型的高方差与以下因素有关</p><ol class=""><li id="1605" class="mg mh iq jp b jq jr ju jv jy mi kc mj kg mk kk ml mm mn mo bi translated">过度拟合-结束对数据集中噪声的建模</li><li id="e269" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">更加强调尽可能接近地拟合每个数据点</li><li id="4acc" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">训练数据误差小，但测试数据误差大</li><li id="e2f1" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">过于复杂的模型和稀疏的训练数据。</li></ol><blockquote class="mw mx my"><p id="45aa" class="jn jo mc jp b jq jr js jt ju jv jw jx mz jz ka kb na kd ke kf nb kh ki kj kk ij bi translated"><strong class="jp ir">一般来说，如果你增加底层系统的复杂度，系统的偏差会减小，而方差会增大。它们两者彼此成反比。不能两个都减。这一点将是偏差-方差权衡的基础。</strong></p></blockquote><h1 id="e672" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">权衡:</h1><p id="562d" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">ML模型的预期测试误差可通过以下公式分解为其偏差和方差</p><blockquote class="nc"><p id="8038" class="nd ne iq bd nf ng nh ni nj nk nl kk dk translated">测试误差=偏差+方差+不可约误差</p></blockquote><p id="1500" class="pw-post-body-paragraph jn jo iq jp b jq nm js jt ju nn jw jx jy no ka kb kc np ke kf kg nq ki kj kk ij bi translated">这一点的完整推导可以在<a class="ae nr" href="https://en.wikipedia.org/wiki/Bias–variance_tradeoff" rel="noopener ugc nofollow" target="_blank">这里</a>找到。不可约误差是由于数据中的噪声引起的误差，并且与模型的选择无关。</p><p id="9bbe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以为了减少估计误差，你需要减少偏差和方差。你必须选择一个模型(在我们的例子中是多项式的次数),以最小化误差的方式权衡偏差和方差。在过拟合和欠拟合的情况下，测试误差都可能很高。因此，我们需要偏差和方差的最佳平衡，这样我们的模型既不会过度拟合也不会欠拟合我们的数据。</p><p id="debf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">考虑前面的例子。我们必须使用多项式从噪声采样数据<strong class="jp ir"> <em class="mc"> D </em> </strong>中估计正弦曲线。我们可以从各种不同次数的多项式中选择。在理想情况下，我们可以访问足够大量的无噪声数据(噪声=0)，泰勒级数展开告诉我们，如果我们不断增加多项式的次数，我们可以越来越好地逼近正弦曲线。但是在有噪声和有限数据集的情况下，增加多项式的次数将开始拟合数据中的噪声，并且在测试数据集上表现不佳。因此，我们需要找到在我们的数据集上最有效(即测试误差最小化)的多项式的最佳次数。</p><p id="93a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下图描绘了不同多项式的正弦曲线的估计值。1次多项式过于简单，无法捕捉正弦曲线，而11次多项式则非常复杂，甚至可以包含噪声(因此偏离了我们试图估算的实际正弦曲线)。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ns"><img src="../Images/19abc9e9d82bf5f397d58207e6c5b77c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9WZsMZ5ZIeRUcsdjSwG_Bg.png"/></div></div><p class="nt nu gj gh gi nv nw bd b be z dk translated">正弦曲线的多项式回归</p></figure><p id="8fde" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了找到估计正弦曲线的最佳多项式，我们找到测试数据集的多项式(1、3、5、7、9和11次)的偏差和方差。图表绘制如下。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ns"><img src="../Images/28211492ace6bdd4894798e6880fd77d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DMv9-Wbt6pyLlFYrmhUh0w.png"/></div></div></figure><p id="0ad9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可以看出，在存在噪声的情况下，7次多项式为我们的正弦曲线提供了最佳拟合。该多项式的选择取决于</p><ol class=""><li id="2b61" class="mg mh iq jp b jq jr ju jv jy mi kc mj kg mk kk ml mm mn mo bi translated">样本数据中噪声的数量和性质</li><li id="c742" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">训练数据量</li></ol><p id="406e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们假设采样的数据集没有噪声。对这个干净的数据集运行相同的实验得到了下面的图表</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ns"><img src="../Images/766ae1d7f93c7429b3ae954771c5b5be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dL7ALyUlApU27b_I0UYxCg.png"/></div></div></figure><p id="370f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上图符合正弦曲线的泰勒级数展开，表明多项式的次数越高，逼近越好。完整的代码附后。</p><h1 id="a665" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">Python代码:</h1><p id="c6b4" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">正弦曲线估计问题的python代码可以在下面找到。模块gen_data()中的变量b用于控制采样数据中的噪声量。通过对num_data=2000个不同的(但重叠的)数据集估计f`(x ),并对其进行平均，可以得到估计函数f`(x)的期望值。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="nx ny l"/></div></figure><h1 id="9b00" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">总结:</h1><h2 id="56ec" class="nz km iq bd kn oa ob dn kr oc od dp kv jy oe of kz kc og oh ld kg oi oj lh ok bi translated"><strong class="ak">对于干净且足够大的数据集:</strong></h2><ol class=""><li id="ccf7" class="mg mh iq jp b jq lj ju lk jy ol kc om kg on kk ml mm mn mo bi translated">模型越复杂，估计误差越低，近似性越好。</li><li id="78f5" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">模型越复杂，偏差越小</li><li id="8676" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">模型复杂度越大，<strong class="jp ir">方差越低</strong></li></ol><h2 id="0fac" class="nz km iq bd kn oa ob dn kr oc od dp kv jy oe of kz kc og oh ld kg oi oj lh ok bi translated">对于噪声数据集:</h2><ol class=""><li id="bc7e" class="mg mh iq jp b jq lj ju lk jy ol kc om kg on kk ml mm mn mo bi translated">更高的模型复杂度并不意味着更低的估计误差</li><li id="9eff" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">模型越复杂，偏差越小</li><li id="54be" class="mg mh iq jp b jq mp ju mq jy mr kc ms kg mt kk ml mm mn mo bi translated">模型复杂度越大，<strong class="jp ir">方差就越高</strong></li></ol><p id="5045" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于现实世界中的数据集几乎总是有噪声和有限的，因此我们需要找到底层模型的最佳复杂性，使我们在数据集上的误差最小。更高的复杂度并不能保证最合适。</p><h1 id="ed39" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">奖金:</h1><p id="f2a1" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">可以在下面的链接中找到这个主题和机器学习中许多其他重要主题的紧凑备忘单</p><div class="oo op gp gr oq or"><a href="https://medium.com/swlh/cheat-sheets-for-machine-learning-interview-topics-51c2bc2bab4f" rel="noopener follow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd ir gy z fp ow fr fs ox fu fw ip bi translated">机器学习面试主题的备忘单</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">ML面试的视觉备忘单(www.cheatsheets.aqeel-anwar.com)</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">medium.com</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf ly or"/></div></div></a></div></div><div class="ab cl pg ph hu pi" role="separator"><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl pm"/><span class="pj bw bk pk pl"/></div><div class="ij ik il im in"><p id="5f06" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果这篇文章对你有帮助，欢迎鼓掌、分享和回复。如果你想了解更多关于机器学习和数据科学的知识，请关注我@<a class="pn po ep" href="https://medium.com/u/a7cc4f201fb5?source=post_page-----7af2681a10a7--------------------------------" rel="noopener" target="_blank"><strong class="jp ir">Aqeel an war</strong></a><strong class="jp ir">或者在</strong><a class="ae nr" href="https://www.linkedin.com/in/aqeelanwarmalik/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="mc">LinkedIn</em></strong></a><strong class="jp ir"><em class="mc">上与我联系。</em> </strong></p></div></div>    
</body>
</html>