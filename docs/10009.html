<html>
<head>
<title>How to Run MySQL Using Docker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 Docker 运行 MySQL</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-run-mysql-using-docker-ed4cebcd90e4?source=collection_archive---------1-----------------------#2020-07-15">https://towardsdatascience.com/how-to-run-mysql-using-docker-ed4cebcd90e4?source=collection_archive---------1-----------------------#2020-07-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="417f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">轻松运行 MySQL</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5afcacd706b115d9614a99183edc536b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gC2dVyvCCzdyfB05"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来自<a class="ae ky" href="https://unsplash.com/@jankolar?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">推特:@jankolario </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="941b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">如果你是数据库管理员、数据科学家或开发人员，你可能必须使用 MySQL 来存储和操作数据。由于 Docker 近年来已经成为一个流行的 DevOps 工具，你最终需要知道如何在 Docker 容器中运行 MySQL。</p><p id="5a01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于环境管理的原因，在不同的机器上运行您的应用程序可能会令人头疼。Docker 通过使用其容器化技术解决了这个问题，该技术使用 Docker 图像。如果你是 Docker 的新手，或者想提高你的技能，请阅读下面的帖子，我已经介绍了一些基础知识。</p><div class="me mf gp gr mg mh"><a rel="noopener follow" target="_blank" href="/how-to-mount-a-directory-inside-a-docker-container-4cee379c298b"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd iu gy z fp mm fr fs mn fu fw is bi translated">如何在 Docker 容器中挂载目录</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">专注于编写代码，无需担心环境管理</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">towardsdatascience.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv ks mh"/></div></div></a></div><p id="1de0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦你完成了本教程，你就可以使用 Docker 测试任何 MySQL 查询了。这种方法将节省您的时间和精力，因为您不必安装或配置 MySQL。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="757b" class="nd ne it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated">设置</h1><p id="e2e6" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">首先，你需要安装<a class="ae ky" href="https://docs.docker.com/engine/install/" rel="noopener ugc nofollow" target="_blank"> Docker </a>。对于这个例子，我们将使用一个<a class="ae ky" href="https://github.com/lifeparticle/MySQL-Snippets/blob/master/docker-compose.yml" rel="noopener ugc nofollow" target="_blank"> Docker 组合文件</a>，<a class="ae ky" href="https://github.com/lifeparticle/MySQL-Snippets/blob/master/school.sql" rel="noopener ugc nofollow" target="_blank">一个包含引导数据的 SQL 文件</a>，也称为 mysql-dump <strong class="lb iu"> </strong>和 macOS。我们需要将<code class="fe oa ob oc od b">docker-compose.yml</code>和<code class="fe oa ob oc od b">school.sql</code>文件放在同一个文件夹中。这个设置中使用的文件夹名是<strong class="lb iu"> MySQL-Snippets </strong>。</p><ul class=""><li id="319e" class="oe of it lb b lc ld lf lg li og lm oh lq oi lu oj ok ol om bi translated"><strong class="lb iu"> Docker Compose: </strong>我们可以使用 Docker Compose 运行多个容器，并在一个 YAML 文件中定义它们的属性。这些容器被称为服务。当您的应用程序有多个堆栈时，比如一个 web 服务器和一个数据库服务器，这是很有帮助的。</li><li id="0b67" class="oe of it lb b lc on lf oo li op lm oq lq or lu oj ok ol om bi translated">MySQL-dump:MySQL-dump 包含纯文本格式的 MySQL 查询。MySQL 命令行客户端可以运行这些命令，并将它们发送到 MySQL 服务器。</li></ul><p id="9e5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们来分解一下<code class="fe oa ob oc od b">docker-compose.yml</code>文件的各个组成部分。</p><pre class="kj kk kl km gt os od ot bn ou ov bi"><span id="0245" class="ow ne it od b be ox oy l oz pa">version: '3.1'<br/>services:<br/>  db:<br/>    image: mysql<br/>    restart: always<br/>    environment:<br/>      MYSQL_ROOT_PASSWORD: root<br/>      MYSQL_DATABASE: test_db<br/>    ports:<br/>      - "3307:3306"<br/>    volumes:<br/>      - $HOME/Desktop/MySQL-Snippets/school.sql:/school.sql</span></pre><p id="c17b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们使用版本标记来定义合成文件格式，即 3.1。还有其他文件格式— 1、2、2.x 和 3.x。从 Docker 的文档中获取更多关于合成文件格式的信息<a class="ae ky" href="https://docs.docker.com/compose/compose-file/" rel="noopener ugc nofollow" target="_blank">此处</a>。</p><p id="ecef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们通过服务散列来跟随我们的版本标签。在这里面，我们必须定义我们的应用程序想要使用的服务。对于我们的应用程序，我们只有一个名为<strong class="lb iu"> db </strong>的服务。</p><p id="40f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了使我们的设置过程快速简单，我们使用预先构建的官方图片<a class="ae ky" href="https://hub.docker.com/_/mysql" rel="noopener ugc nofollow" target="_blank"> MySQL </a>作为图片标签。</p><p id="3bc0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们使用<strong class="lb iu"> always </strong>作为重启标签时，容器总是重启。这样可以节省时间。例如，您不必在每次手动重启机器时都启动容器。当 Docker 守护进程重新启动或者容器本身被手动重新启动时，它会重新启动容器。</p><p id="d9b2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在环境标签下，我们定义了环境变量，我们将使用这些变量进行数据库认证。</p><p id="cf07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ports 标记用于定义主机端口和容器端口。它将主机上的端口 3307 映射到容器上的端口 3306。</p><p id="8ab0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，卷标签用于将文件夹从主机挂载到容器。它包含由冒号分隔的两个字段。第一部分是主机中的路径。第二部分是容器中的路径。如果您不想将 mysql-dump <strong class="lb iu"> </strong>挂载到容器中，请删除这一部分。</p><p id="8c1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很好，你已经完成了这篇文章的设置。现在从<code class="fe oa ob oc od b">docker-compose.yml</code>文件所在的目录运行下面的命令。命令<code class="fe oa ob oc od b">docker compose up</code>启动并运行你的整个应用。</p><pre class="kj kk kl km gt os od ot bn ou ov bi"><span id="7f61" class="ow ne it od b be ox oy l oz pa">docker compose up</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/a1b4aefcabc8dcc2474839827d5d978f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*jtFsKuQqqAgeZdVFnWGH3g.gif"/></div></figure><p id="2889" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在在主机上运行<code class="fe oa ob oc od b">docker ps</code>命令，查看正在运行的容器列表。正如我们所看到的，我们有一个名为<code class="fe oa ob oc od b">mysql-snippets_db_1</code>的运行容器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/65c0c6c8d0fe616b6326c2eb0adff10f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nUoz6M3KFYYBHJs1xNz90w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">docker ps</p></figure><p id="ffeb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以看到一个图像是通过运行<code class="fe oa ob oc od b">docker images</code>命令创建的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/51e466c7ef9f8d6976e14298d059858a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X07hyoXD2hZfCbDvBDngzg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><code class="fe oa ob oc od b">docker images</code></p></figure><p id="df2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过运行以下命令来访问正在运行的容器<code class="fe oa ob oc od b">mysql-snippets_db_1</code>。</p><pre class="kj kk kl km gt os od ot bn ou ov bi"><span id="450e" class="ow ne it od b be ox oy l oz pa">docker exec -it mysql-snippets_db_1 bash</span></pre><p id="4365" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe oa ob oc od b">docker exec</code>命令允许我们进入正在运行的容器。标志<code class="fe oa ob oc od b">-i -t</code>(通常写为<code class="fe oa ob oc od b">-it</code>)用于以交互模式访问容器。现在我们提供想要访问的容器的名称，在本例中是<code class="fe oa ob oc od b">mysql-snippets_db</code>。<code class="fe oa ob oc od b">bash</code>命令用于获取容器内部的 bash shell，因此我们可以访问 MySQL 命令行并执行 MySQL 查询。</p><p id="81fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您刚刚完成了容器的设置。现在，我们将演练如何连接到 MySQL 服务器。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/86901d89731597e6d4d7c0fe5d92850a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*3lpTffmESYvxWwUtdFUP_g.gif"/></div></figure><h2 id="8cb7" class="pe ne it bd nf pf pg dn nj ph pi dp nn li pj pk np lm pl pm nr lq pn po nt pp bi translated">连接到 MySQL 服务器</h2><p id="a057" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">使用您的用户名和密码<code class="fe oa ob oc od b">root</code>连接到 MySQL 服务器。一旦连接到服务器，您就可以运行 MySQL 命令。</p><pre class="kj kk kl km gt os od ot bn ou ov bi"><span id="0187" class="ow ne it od b be ox oy l oz pa">mysql -uroot -proot</span></pre><p id="9e63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里有一个例子，你可以试试:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/9164f92a7e6d6b277f72a1b52db87c13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*cKoJ7eTBlb94BJ5NrzE79A.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示数据库；</p></figure><p id="05c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到名为<strong class="lb iu"> test_db </strong>的数据库，它定义在我们的 Compose 文件中。要选择数据库，运行<code class="fe oa ob oc od b">USE test_db;</code>命令。使用<code class="fe oa ob oc od b">SHOW TABLES;</code>命令显示我们数据库<strong class="lb iu"> test_db </strong>的所有表格。键入<code class="fe oa ob oc od b">ctrl + L</code>清除控制台。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/a1f67df4557c2cd3766729a2346c56b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ZUL1MbU2_-uH5ThqpFS7A.png"/></div></div></figure><p id="d1f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因为我们没有任何表，所以命令<code class="fe oa ob oc od b">SHOW TABLES;</code>返回了一个空集。现在您已经确认您已经连接到 MYSQL 服务器，您可以进入下一步。</p><h2 id="b6ae" class="pe ne it bd nf pf pg dn nj ph pi dp nn li pj pk np lm pl pm nr lq pn po nt pp bi translated">从文件中加载数据</h2><p id="1a13" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">现在我们可以将 MySQL 转储加载到我们的<code class="fe oa ob oc od b">test_db</code>数据库中。在这种情况下是<code class="fe oa ob oc od b">school.sql</code>。它在容器内部是可访问的，因为我们已经从主机装载了它。</p><pre class="kj kk kl km gt os od ot bn ou ov bi"><span id="f229" class="ow ne it od b be ox oy l oz pa">mysql -uroot -p test_db &lt; school.sql</span></pre><p id="f47d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用用户名<code class="fe oa ob oc od b">root</code>连接到 MySQL 服务器。输入密码<code class="fe oa ob oc od b">root </code>进行验证。现在我们将默认数据库设置为<code class="fe oa ob oc od b">test_db</code>。<code class="fe oa ob oc od b">&lt;</code>和文件名一起用于向服务器发送命令。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/cf0455ba95d4f518a1bf1bbd33d629e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*8OxB6o-onQSk_8m-ZGce3Q.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将 mysql 转储导入到 sql server</p></figure><p id="775f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们运行 MySQL 命令<code class="fe oa ob oc od b">SHOW TABLES</code>，我们可以在数据库<code class="fe oa ob oc od b">test_db</code>中看到两个名为<strong class="lb iu"> marks </strong>和<strong class="lb iu"> students </strong>的表，它们是在<code class="fe oa ob oc od b">school.sql</code>中定义的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/f0a4c638d30f241a5b0f09a732b015f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*frOtyvGUwyJ0fT8Olun0CA.png"/></div></div></figure></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="37e4" class="nd ne it bd nf ng nh ni nj nk nl nm nn jz no ka np kc nq kd nr kf ns kg nt nu bi translated">包裹</h1><p id="9ccd" class="pw-post-body-paragraph kz la it lb b lc nv ju le lf nw jx lh li nx lk ll lm ny lo lp lq nz ls lt lu im bi translated">像 MySQL 这样的关系数据库在行业中经常使用，所以这是一个您想要彻底了解的主题。现在您已经完成了这个基础教程，您可以使用 Docker 更深入地探索 MySQL。你可以在这里找到更多的 MySQL 命令。Docker 彻底改变了我们管理环境的方式，包括开发、测试和生产。这就是为什么你必须为个人和工业目的获得这种技能。希望这能帮助你入门 MySQL 和 Docker。</p></div></div>    
</body>
</html>