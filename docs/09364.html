<html>
<head>
<title>Web Scraping NBA 2k Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网络抓取 NBA 2k 数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/web-scraping-nba-2k-data-d7fdd4c8898c?source=collection_archive---------40-----------------------#2020-07-04">https://towardsdatascience.com/web-scraping-nba-2k-data-d7fdd4c8898c?source=collection_archive---------40-----------------------#2020-07-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/ca54efedd065b2d8b58913ba94e78100.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8RDKCFSztFbSw4m6.jpg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">照片来自 Pixabay，作者为<a class="ae jd" href="https://pixabay.com/users/rochigb-232681/" rel="noopener ugc nofollow" target="_blank"> Rochigb </a></p></figure><div class=""/><div class=""><h2 id="9b23" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">这是一个学习宝贵的数据科学技能的实践示例</h2></div><p id="3a28" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">并不是所有值得分析的数据都打包好了(我正看着你呢，Kaggle)。最终，在您的数据科学之旅中，您会发现自己在寻找一个并不存在的数据集。是吗？</p><p id="567e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">进入:网页抓取。</p><p id="23d2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">网络抓取是从网页中获取数据的一个非常有价值的工具。抓取不是手动收集信息，而是自动获取和存储数据。它涉及一个网页:</p><ul class=""><li id="f179" class="lr ls jg kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">从语法上分析</li><li id="5517" class="lr ls jg kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">重新格式化</li><li id="e83e" class="lr ls jg kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">复制到电子表格中</li></ul><p id="cbee" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">入门</strong></p><p id="968e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此时，您可能想知道可以使用哪些库来开始 web 抓取。有多种选择，但最常见的库和框架是:</p><ul class=""><li id="6f48" class="lr ls jg kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">要求</li><li id="a601" class="lr ls jg kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">美味的汤</li><li id="6748" class="lr ls jg kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">硒</li><li id="5d21" class="lr ls jg kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">Scrapy</li><li id="4345" class="lr ls jg kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">LXML</li></ul><p id="621d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本教程中，我们将使用以下库:</p><ul class=""><li id="5065" class="lr ls jg kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">熊猫</li><li id="5bdf" class="lr ls jg kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">要求</li><li id="ae81" class="lr ls jg kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">美丽的声音</li><li id="e4d1" class="lr ls jg kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">有平面的</li></ul><p id="edea" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">第一步是导入上面的内容:</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="fb6f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">查看网页</strong></p><p id="c815" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">网站包含许多不同的元素，因此检查网页以了解 python 代码应该以哪些元素为目标非常重要。</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/d1c3edbfdfe522d2d6dc33ebaa83076c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNiDksY7NSUjWvIvkZMW5g.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">像 HoopsHype 这样的网站定期收集体育数据并发布。</p></figure><p id="cec0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将关注 2016 年 NBA 2K 收视率。这将是基于篮球评级的数据可视化或机器学习项目的伟大先驱。</p><div class="mf mg mh mi gt ab cb"><figure class="mm is mn mo mp mq mr paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/ec57e0f5e8e47458634a61f0293b7992.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*R90CiGIr8-di9wrKXDKL1g.png"/></div></figure><figure class="mm is ms mo mp mq mr paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><img src="../Images/f7a238034025e36dac69ee0326427e09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*WVKM20EO5kAf76qjlsnd1g.png"/></div><p class="iz ja gj gh gi jb jc bd b be z dk mt di mu mv translated">检查一个网站将揭示其源代码</p></figure></div><p id="d344" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">要轻松检查网站，请将光标放在包含数据的元素中或突出显示该元素。然后，右键单击并选择“Inspect”来访问站点的源代码。如果数据存储在一个表中，您将会知道，因为像表行(<tr>)和数据单元格(<td>)这样的标记不是实际的<table>元素。</table></td></tr></p><p id="81d3" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是一个数据单元格标签示例:</p><pre class="mf mg mh mi gt mw mx my mz aw na bi"><span id="e421" class="nb nc jg mx b gy nd ne l nf ng">&lt;td style=”text-align:center;”&gt;71&lt;/td&gt;</span></pre><p id="3f8d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是一个表格行标签的例子:</p><pre class="mf mg mh mi gt mw mx my mz aw na bi"><span id="e067" class="nb nc jg mx b gy nd ne l nf ng">&lt;tr style=”font-size:11px;”&gt;&lt;/tr&gt;</span></pre><p id="f0f6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">解析网页</strong></p><p id="d23d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">解析的第一步是获取你想要抓取的网页的 url。接下来，使用 requests get()方法查询页面。这将返回一个请求。响应对象。</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="9f0a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们创建一个漂亮的对象。这将表示已解析的页面。使用“美化”方法可以让我们更好地看到嵌套标签，但这不是必需的。LXML 是 BeautifulSoup 可以使用的 XML 和 HTML 解析器。这增加了额外的功能，尤其是涉及字符串处理的功能。</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="c84b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">调用 BeautifulSoup 对象应该会产生页面的源代码:</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nh"><img src="../Images/ae978e761606637ec8420e6a282cb9e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mldbTJKcExM6zH7B9BSohQ.png"/></div></div></figure><p id="9c16" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">解析页面的最后一步是定位我们想要的表。我们需要选择源代码中的第一个表(因此是[0])。如果您的目标表是源代码中的第二个表，您应该使用[1]等等。</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="d6f6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Pandas 中的 read_html 方法返回一个数据帧列表，这对下一步很重要。</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ni"><img src="../Images/4f3ba1e12a106336bd2ba24a823e8e52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*msaDfzCS09axSiAvwYAdcA.png"/></div></div></figure><p id="2b94" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">重新格式化数据</strong></p><p id="1cfc" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们有了一个数据帧的列表，我们需要以一种有意义的方式重新格式化数据。让我们打印 read_html 方法返回的内容:</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="a7ab" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">调用 to_json 方法会将传递的对象转换成一个<em class="nj"> JSON 字符串</em>。orient 参数告诉方法预期的<em class="nj"> JSON 字符串</em>格式。我们选择'<em class="nj">记录</em>指示，因为我们知道 read_html 方法返回一个列表，并且列表相对容易操作。处理其他适应症是可行的，但更困难。</p><p id="f351" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为我们最终想要一个有不同数据行的数据帧，我们需要<em class="nj">制表</em>(排列)数据。</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="6bb6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将数据帧列表的第一个元素(唯一的数据帧)制成表格。</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nk"><img src="../Images/acbb9807fa50bc78e474e1dc5c701943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AwsfSh2Op-6XPdvrTAoXiw.png"/></div></div></figure><p id="e91e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为我们现在可以看到新的行字符(\n)，所以让我们将每一行拆分到它自己的列表中。</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="0610" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">数据开始变得越来越清晰。</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nl"><img src="../Images/5219715a4d84257ef089b97a46e1e93b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2-AbJCHRFBOYBXyG549n9A.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">现在每一行都是一个列表元素</p></figure><p id="6c9e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，让我们通过按空格字符拆分来将每一行拆分成单元格。</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="adf2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这导致破折号<em class="nj">和</em>成为额外的第一行。</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nm"><img src="../Images/dd97bd24a892b651d697490023bf4d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IoA5k3edKaJJ_hEFeqPscg.png"/></div></div></figure><p id="300e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以使用 pop()函数轻松删除行。</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ni"><img src="../Images/fd99c0b5767a52cd86f8c3c575a3546c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ng2g6KSiAX_CrUF_s9rm9w.png"/></div></div></figure><p id="7081" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">将数据复制到数据帧中</strong></p><p id="6965" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将数据复制到 Pandas 数据帧并检查输出非常简单。</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="0dc6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还需要几个步骤来准备这个表，以便进行分析。</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nn"><img src="../Images/6439184358d3a8d2567f2464092f1440.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EX0QqQf-3hrswKD4HJgXEw.png"/></div></div></figure><p id="8a86" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，每隔一行用 NaN 值填充。让我们重新定义 DataFrame，只取每隔一行。</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="42f9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还需要删除第一列、最后两列和第一行，因为它包含标题值。</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="98d6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">DataFrame 现在没有多余的列或行了！</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ni"><img src="../Images/5ccdda5922f4313a551848dd190a3373.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XuQe8Im__TMTMHgNFVtn_g.png"/></div></div></figure><p id="1f97" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果需要，您可以重命名这些列。</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="1565" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该表现在可以进行分析了！</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi no"><img src="../Images/5331bc6742137286dcad75a2715836c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0l8D0W4tHizTYLEsPxIJ1w.png"/></div></div></figure><p id="463f" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您想将数据帧写入 csv，可以通过 to_csv 函数来完成。</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="f944" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们已经有了分数和球员的名字，我们可以绘制这些数据了。我用了 Plotly。</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="6153" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这里没有惊喜。</p><p id="d870" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2016 年得分最高的球员是<strong class="kx jh">勒布朗詹姆斯</strong>。现在它已经被清理了，您可以用这些数据做更多的事情！</p><figure class="mf mg mh mi gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi np"><img src="../Images/db843efdeaefb5008b57cc68616bef2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fw4ntKbYzIm49-tJcZ_xXg.png"/></div></div></figure><p id="02d2" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">结论</strong></p><p id="a0b0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是最终代码:</p><figure class="mf mg mh mi gt is"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="9665" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">本教程涵盖了:</p><ul class=""><li id="978d" class="lr ls jg kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">常见的 web 抓取库</li><li id="aa7d" class="lr ls jg kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">使用 BeautifulSoup 和 LXML 解析 HTML</li><li id="0dbc" class="lr ls jg kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">将数据复制到熊猫数据框架中</li><li id="7c30" class="lr ls jg kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">修复网页抓取的常见错误</li><li id="cc62" class="lr ls jg kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">导出 web 抓取的数据</li></ul><p id="e547" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">网络抓取是利用数据和练习熊猫技能的好方法。这是为机器学习或可视化项目获取数据的一种很好的方式。</p></div></div>    
</body>
</html>