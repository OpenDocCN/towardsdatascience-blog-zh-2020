<html>
<head>
<title>Hierarchical Classification by Local Classifiers: Your Must-Know Tweaks &amp; Tricks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">局部分类器的层次分类:你必须知道的调整和技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc?source=collection_archive---------45-----------------------#2020-05-18">https://towardsdatascience.com/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc?source=collection_archive---------45-----------------------#2020-05-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2866" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">分级分类集成模型的最佳实践。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b66c57e3913a70e5ccf335c20b877517.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0c8-7FA7s4vHl7Yg"/></div></div></figure><p id="6851" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你有没有一个<a class="ae ln" rel="noopener" target="_blank" href="/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076">层次分类</a>的任务，只是乞求一个机器学习模型？你是否已经决定选择一个局部分类器的集合，甚至决定了<a class="ae ln" rel="noopener" target="_blank" href="/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076">对于那个任务</a>来说最好的局部分类器结构？你的键盘准备好了吗，手指准备好了吗？嗯，现在就一分钟。你可能想坐下来。</p><p id="22f0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你读过我在<a class="ae ln" rel="noopener" target="_blank" href="/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076">之前关于等级分类的</a> <a class="ae ln" rel="noopener" target="_blank" href="/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382">帖子</a>，你肯定已经了解了所有的基础知识。然而，有一些重要的最后细节你应该让自己熟悉。无论是<strong class="kt ir">如何选择你的训练样本和特征集</strong>，如何<strong class="kt ir">避免错误传播</strong>，还是<strong class="kt ir">处理分类不一致的方法</strong> — <strong class="kt ir">这是你在实现你的第一个现实生活中的层次模型</strong>之前想要阅读的一篇文章。</p><h1 id="6d67" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">在我们开始之前</h1><p id="82a2" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">分层局部分类器的主题很长，理解下面描述的复杂性需要您熟悉:</p><ol class=""><li id="6c27" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm mq mr ms mt bi translated"><a class="ae ln" rel="noopener" target="_blank" href="/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076">数据分类&amp;层次分类</a></li><li id="a817" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm mq mr ms mt bi translated"><a class="ae ln" rel="noopener" target="_blank" href="/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382">分级局部分类器及其不同结构</a></li></ol><p id="2123" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果不是这样，那就继续读下去吧。没事的。我们会等的。</p><p id="c8f4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这篇文章中，正如我之前的<a class="ae ln" rel="noopener" target="_blank" href="/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076"/><a class="ae ln" rel="noopener" target="_blank" href="/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382"/>一样，我将根据常见宠物的分类给出例子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/6c555107f25b98fcef5b96502e35d70a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z68UG1eIK9GASUEb1nSbzg.png"/></div></div><p class="na nb gj gh gi nc nd bd b be z dk translated">常见家养宠物的分类。我听说彩虹独角兽很难家养。</p></figure><h1 id="fc9b" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">谈正事</h1><p id="6311" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">你正在建立你自己的层次集合模型吗？您是否已经定义了您的数据分类法，挑选了您最喜欢的局部分类器结构，卷起袖子，准备好开始着手进行模型破解了吗？</p><p id="7ec0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你就快到了，冠军。但是在您打开数据科学引擎之前，还有几个要点需要您花时间考虑。</p><h1 id="3831" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">1.不一致性校正方法</h1><p id="8628" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated"><strong class="kt ir"> <em class="ne">“嗯……为什么我的模型输出坚持这个例子是一只暹罗犬？”</em>T3】</strong></p><p id="6649" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">正如你已经知道的(如果你不知道，你为什么不继续点击<a class="ae ln" rel="noopener" target="_blank" href="/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382">这里</a>，局部分类器集成模型可以吐出一些不一致的结果。</p><p id="4350" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">根据您的用例，您可能不希望您的测试集示例同时被标记为“Unicorn”和“French Bulldog”，也不希望父节点分类器说<em class="ne">不</em>而它的一个子节点投票<em class="ne">赞成</em>。不同层次的系综之间的不一致是我们非常希望避免的。那么，我们应该怎样做呢？</p><p id="0515" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有几个方法——其中一些不必要地复杂。我将为您节省一些麻烦，并描述最简单和最直观的，考虑到手头的问题最有意义的:</p><h2 id="56b3" class="nf lp iq bd lq ng nh dn lu ni nj dp ly la nk nl ma le nm nn mc li no np me nq bi translated">第一种不一致的情况:不同层次的预测相互矛盾</h2><p id="7b35" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated"><em class="ne">(例如:“假”代表狗，“真”代表狮子狗)。</em></p><p id="b4b9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">解决方案:<strong class="kt ir">类预测自顶向下的方法。<br/> </strong>在测试阶段，<strong class="kt ir"> </strong>您从分类树的顶部开始，<strong class="kt ir"> </strong>并且每次向下一级，您只考虑作为预测类的后代的局部分类器。<br/>有点太抽象了？让我们看几个例子，然后:</p><ul class=""><li id="e249" class="ml mm iq kt b ku kv kx ky la mn le mo li mp lm nr mr ms mt bi translated"><strong class="kt ir">每父节点局部分类器(LCPN) </strong>:你有一只动物。它是什么物种，哦，如此强大的一级分类器？是一只狗？太好了。让我们只将这个特定的例子发送到“狗”本地分类器，然后——不需要咨询“猫”和“独角兽”的分类器。</li><li id="b5aa" class="ml mm iq kt b ku mu kx mv la mw le mx li my lm nr mr ms mt bi translated"><strong class="kt ir">每节点局部分类器(LCN) </strong>:又一个动物！万岁！让我们看看它是一只猫，一只狗，还是一只独角兽。猫分类器说“是”，狗分类器说“不是”，独角兽分类器说“是”？非常好。接下来，我们将只考虑不同品种的猫和独角兽的本地分类器。狗品种可以坐在这一个。(当然，这个例子只适用于多标签的情况。还有，你有没有想过独角兽猫长什么样？<a class="ae ln" href="https://www.google.com/search?tbm=isch&amp;q=unicorn+cat" rel="noopener ugc nofollow" target="_blank">点击风险自担</a>)。</li></ul><h2 id="47bf" class="nf lp iq bd lq ng nh dn lu ni nj dp ly la nk nl ma le nm nn mc li no np me nq bi translated">第二个不一致的场景:一个标签问题的几个叶节点标签</h2><p id="c848" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated"><em class="ne">(例如:一只彩虹-独角兽-法国-牛头犬)。</em></p><p id="5bbc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您正在使用 LCN ( <em class="ne">每个节点的本地分类器</em>)，但是您的问题是单标签问题？嗯，首先，我不知道你为什么要这样做——LCPN(<em class="ne">每个父节点的本地分类器</em> ) <strong class="kt ir"> </strong>结构只是坐在那里，等待——但是如果你决定这样做，并且你在同一级别的多个本地分类器对同一个示例说“是”，这里是你要做的:<strong class="kt ir">选择可信度最高的那个。</strong></p><p id="053b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">是的，就这么简单。“独角兽”和“狗”都在争称号？向每个分类器询问一个置信度得分，并且只考虑更有把握的那个的答案。有点像现实生活，不是吗？</p><p id="24c0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">(该解决方案假设您也使用上述自顶向下的分类预测，只将示例发送到结果为肯定的父分类器的子分类器。如果不是，就应该)。</p><h1 id="f211" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">2.错误传播</h1><p id="4996" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated"><strong class="kt ir"> <em class="ne">“等等！误差传播呢？如果这些父节点分类器中的一个给出了假阳性，我们如何避免将错误向下传播？”</em>T13】</strong></p><p id="2273" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">初级的，我亲爱的读者。我们<strong class="kt ir">用信任来阻挡</strong>。根据您的用例及其所需的确定性水平，确定一个阈值，如果预测的置信度得分没有达到阈值，则停止分类过程，并且不将该样本发送到该分类器的子节点。</p><p id="4a76" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">不过，这种解决方案也是有代价的:最终的预测可能不太具体(例如，“猫”而不是“Sphynx 猫”)，并且取决于您的具体问题和业务需求，您的最终用户可能对此不满意。</p><h1 id="e594" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">3.LCN 量词的正反例</h1><p id="f5e1" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated"><strong class="kt ir"> <em class="ne">“我正在构建一个每节点局部分类器的集成模型。每个二元分类器的训练集应该是什么样的？</em> </strong></p><p id="7975" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当谈到 LCN(每个节点的本地分类器)方法时，如何训练本地分类器可能不是显而易见的，这些分类器都是二进制的。我们应该把什么样的例子作为正面的例子来喂它？哪些是负面的？</p><p id="d317" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有几种不同的政策，每一种都有其合理性和独特之处。你很幸运，我费了很大劲才找到了对 LCN 来说最有意义的一个，因为其他的都有点难以理解，而且没有任何明显的好处。</p><p id="d014" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">它被称为“<strong class="kt ir"> <em class="ne">兄弟姐妹政策</em> </strong>”，并且<em class="ne">它将类 X 的正面例子定义为属于类 X 及其子类的那些，将负面例子定义为属于类 X 的兄弟姐妹类以及它们自己的子类的那些。</em></p><p id="49ce" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">举例？当然:<br/>说我想训练我的“狗”分类器。在这种情况下，我的<strong class="kt ir">正面例子</strong>将是那些既属于一般“狗”类(假设有一些例子，我知道它们是狗，但不知道是哪个品种)，又属于它的所有特定品种(斑点狗、拉布拉多等)的狗。).<br/>我的<strong class="kt ir">反面例子</strong>，另一方面，将会是所有的猫和所有的独角兽(我必须说，这听起来很棒)。</p><p id="afb3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">明白了吗？很好。让我们继续下一个调整。</p><h1 id="f885" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">4.相同与不同的特性/算法</h1><p id="e85f" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated"><strong class="kt ir"> <em class="ne">“我应该对我的集成中的所有局部分类器使用相同的基础算法吗？同样的功能集怎么样？”</em>T9】</strong></p><p id="44d5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个简单:<strong class="kt ir">不</strong>。</p><p id="0d10" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有大量证据表明，针对不同子问题的不同算法和特性可以提供更好的结果。这很有道理。你不会期望一个“它喵喵叫吗”的特性能很好的区分不同品种的狗，你会吗？</p><h1 id="a3cd" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">最后一个音符</h1><p id="bdb0" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">如果你已经走了这么远，你已经准备好了。你有你的本地分类器结构吗？你的正反例子？不一致和错误传播问题都解决了？等等，你忘了什么吗？</p><p id="3e97" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一旦你建立了你的层次模型，你将会想要知道它做得有多好。虽然平面分类问题的性能指标是众所周知的——但当涉及到层次问题时，就不那么简单了。</p><p id="bbc2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所以，开始构建你的模型吧，但如果你也想测量它的性能，请查看我的下一篇文章。这将是一个爆炸。</p></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><p id="6542" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Noa Weiss 是特拉维夫的一名人工智能机器学习顾问。 </p></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><p id="41ba" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ne">资料来源</em> : C.N. Silla &amp; A.A. Freitas，<a class="ae ln" href="https://link.springer.com/article/10.1007/s10618-010-0175-9" rel="noopener ugc nofollow" target="_blank"> <em class="ne">跨不同应用领域的层次分类综述</em> </a> <em class="ne"> </em> (2011)，<em class="ne">数据挖掘与知识发现</em>，22(1–2):182–196</p></div></div>    
</body>
</html>