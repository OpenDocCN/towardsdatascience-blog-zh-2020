<html>
<head>
<title>A Quick, Easy Way to Unpivot Data in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中一种快速、简单的数据反透视方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-quick-easy-way-to-unpivot-data-in-python-ea31dc707ae7?source=collection_archive---------10-----------------------#2020-03-17">https://towardsdatascience.com/a-quick-easy-way-to-unpivot-data-in-python-ea31dc707ae7?source=collection_archive---------10-----------------------#2020-03-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9f7e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在熊猫中使用融化功能</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/be57a88555d7a961ee0157a8e4108398.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PHRxFfeMwW_AZ1fPEXrxSQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让我们学习如何在熊猫身上融化数据(来源:Nik Piepenbreier)</p></figure><p id="8645" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在之前的一篇文章中，我们看了一下在Python 中执行<a class="ae lu" rel="noopener" target="_blank" href="/learn-how-to-easily-do-3-advanced-excel-tasks-in-python-925a6b7dd081">三个常见的Excel任务。今天我们来看看一个函数，虽然在Excel中是可能的，但它隐藏得很好，有点笨拙。我说的是Excel中的“非透视”数据。</a></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9716" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">为什么取消数据透视？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7a0198323ad68359c81909d8af87efea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VTwWvK10Tc6MnM0DYZ_h9w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让我们让下载的数据更有用！资料来源:Nik Piepenbreier</p></figure><p id="e545" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Python和Excel使得分析数据和以跨表格式呈现分析变得非常容易。但是如果您只接收那种格式的数据呢？为了进行更有意义的分析，通常需要花费大量时间来重新格式化数据。我们称这个过程为“非旋转”。</p><h1 id="38dc" class="mc md it bd me mf mu mh mi mj mv ml mm jz mw ka mo kc mx kd mq kf my kg ms mt bi translated">开始取消透视数据</h1><p id="53f4" class="pw-post-body-paragraph ky kz it la b lb mz ju ld le na jx lg lh nb lj lk ll nc ln lo lp nd lr ls lt im bi translated">让我们通过运行以下命令将数据集加载到Pandas数据帧中:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="6e64" class="nj md it nf b gy nk nl l nm nn">import pandas as pd<br/>df = pd.read_excel('<a class="ae lu" href="https://github.com/datagy/mediumdata/raw/master/unpivot.xlsx" rel="noopener ugc nofollow" target="_blank">https://github.com/datagy/mediumdata/raw/master/pythonexcel.xlsx</a>')</span></pre><p id="f01d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你想探索Excel中的数据，你可以<a class="ae lu" href="https://github.com/datagy/mediumdata/raw/master/unpivot.xlsx" rel="noopener ugc nofollow" target="_blank">在这里</a>下载文件。</p><p id="f42e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以通过编写以下代码打印出列名:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="2d61" class="nj md it nf b gy nk nl l nm nn">print(df.columns)</span></pre><p id="54d5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将返回:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="cad4" class="nj md it nf b gy nk nl l nm nn">['Product', 'Quarter 1', 'Quarter 2', 'Quarter 3', 'Quarter 4']</span></pre><p id="c76e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本质上，我们希望将所有的季度放在一个列中(称为季度)，并将销售额放在一个单独的列中。熊猫融化功能使这变得非常容易。我们可以简单地写:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="3ffb" class="nj md it nf b gy nk nl l nm nn">df = df.melt(id_vars = 'Product', var_name = 'Quarter', value_name = 'Sales')</span></pre><p id="c3be" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们稍微分解一下:</p><ul class=""><li id="2da0" class="no np it la b lb lc le lf lh nq ll nr lp ns lt nt nu nv nw bi translated"><strong class="la iu"> id_vars </strong>:标识要用作标识符变量的列</li><li id="214e" class="no np it la b lb nx le ny lh nz ll oa lp ob lt nt nu nv nw bi translated"><strong class="la iu"> value_vars </strong>:要取消透视的列。如果为空(如这里的情况)，则使用除了那些在<em class="oc"> id_vars </em>中标识的列之外的所有列</li><li id="64ea" class="no np it la b lb nx le ny lh nz ll oa lp ob lt nt nu nv nw bi translated"><strong class="la iu"> var_name </strong>:为取消透视的列指定一个名称</li><li id="8c92" class="no np it la b lb nx le ny lh nz ll oa lp ob lt nt nu nv nw bi translated"><strong class="la iu">值名称</strong>:为值列指定一个名称</li></ul><p id="542a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们现在打印出df时，我们看到它以如下方式返回:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/a9a746f506c78a7fad373f51c99b3a59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6PV1N1rLsdDp96eGBEdgtw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们融化的数据框。资料来源:Nik Piepenbreier</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9524" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">在Excel中取消数据透视</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/b424350a42d8369f296fbde38855464f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*4QluddA74Uaz4W9K5LTz3w.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在Excel中取消数据透视。资料来源:Nik Piepenbreier</p></figure><p id="15c0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，假设我们想在好的、旧的Excel中做这件事。我们该怎么做呢？在Excel 2016之前，这需要下载Power Query插件。从该版本开始，附加组件的功能被内置到主版本中。让我们从打开数据集开始。从那里开始:</p><ol class=""><li id="21e0" class="no np it la b lb lc le lf lh nq ll nr lp ns lt of nu nv nw bi translated">选择数据选项卡</li><li id="5a1e" class="no np it la b lb nx le ny lh nz ll oa lp ob lt of nu nv nw bi translated">选择表格后，在获取和转换数据中选择表格/范围</li><li id="9d1b" class="no np it la b lb nx le ny lh nz ll oa lp ob lt of nu nv nw bi translated">切换到变换菜单</li><li id="8460" class="no np it la b lb nx le ny lh nz ll oa lp ob lt of nu nv nw bi translated">选择要取消透视的列</li><li id="3db5" class="no np it la b lb nx le ny lh nz ll oa lp ob lt of nu nv nw bi translated">单击取消透视列</li><li id="ecbd" class="no np it la b lb nx le ny lh nz ll oa lp ob lt of nu nv nw bi translated">在主页选项卡上选择关闭并加载</li><li id="01e4" class="no np it la b lb nx le ny lh nz ll oa lp ob lt of nu nv nw bi translated">享受你的数据！</li></ol></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="737a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读这篇文章！请务必查看我的其他帖子，包括<a class="ae lu" rel="noopener" target="_blank" href="/learn-how-to-easily-do-3-advanced-excel-tasks-in-python-925a6b7dd081">轻松学会如何！！)用Python做3个高级Excel任务</a>。</p></div></div>    
</body>
</html>