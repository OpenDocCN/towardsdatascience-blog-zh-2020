<html>
<head>
<title>How to Create Dynamic 3D Scatter Plots with Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Plotly创建动态3D散点图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-dynamic-3d-scatter-plots-with-plotly-6371adafd14?source=collection_archive---------28-----------------------#2020-06-08">https://towardsdatascience.com/how-to-create-dynamic-3d-scatter-plots-with-plotly-6371adafd14?source=collection_archive---------28-----------------------#2020-06-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e0d6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">让你的数据技能更上一层楼。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a9c1d89bfa9ce4743e1758a82dd218d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m0mhUrZN1BaZJIVCEPVTUg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@jcs_chen?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">杰森CS陈</a>在<a class="ae ky" href="https://unsplash.com/s/photos/view?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="696e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可视化比纯文本或数字更容易让人记住。可视化的信息力量是纯文本难以达到的。因此，可视化被广泛应用于数据科学领域。可视化的信息能力取决于它的结构。例如，3D动态图比2D图更能说明问题。随着结构变得越来越复杂，我们可以用可视化来表示更多的信息。在将模型应用于数据之前，探索和理解原始数据中的结构是非常重要的。可视化是加速探索数据和帮助建立一个健壮的数据分析过程的很好的工具。</p><p id="024d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本帖中，我们将创建动态3D散点图，并将它们与2D散点图进行比较。我们将使用<strong class="lb iu"> Plotly Python </strong> (plotly.py)，这是一个基于plotly javascript (plotly.js)构建的开源绘图库。我喜欢plotly.py的一点是，它提供了一个高级API ( <strong class="lb iu"> plotly express </strong>)和一个低级API ( <strong class="lb iu"> graph objects </strong>)来创建可视化。使用plotly express，我们可以用很少的代码行创建一个很好的情节。另一方面，我们需要用图形对象编写更多的代码，但是对我们创建的内容有更多的控制权。</p><p id="e3fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们首先使用numpy和pandas创建一个合成数据集。我们从导入库开始。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0173" class="ma mb it lw b gy mc md l me mf">import numpy as np<br/>import pandas as pd</span><span id="e27e" class="ma mb it lw b gy mg md l me mf">import plotly.express as px</span></pre><p id="9e5d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们创建了一个数据框架，其中包含属于两个不同类别的一些观察值的3个不同的数字特征。我们使用numpy数组来表示数字特征，使用python列表来创建类别列。</p><p id="30cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数字特征:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d38c" class="ma mb it lw b gy mc md l me mf">x = np.random.random(size=60)*7 + 1<br/>y = np.random.random(size=60)*7 + 1<br/>z = np.random.random(size=60)<br/>z[-30:] = z[-30:]*5 + 2</span></pre><p id="b913" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分类特征:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d712" class="ma mb it lw b gy mc md l me mf">categories = "A "*30 + "B "*30<br/>categories = categories.split(" ")<br/>categories.pop(60)</span></pre><p id="ea51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先创建一个包含30个a和30个b(中间有空格)的字符串，然后用空格分割该字符串以创建一个包含30个条目的列表。由于字符串末尾有一个空格，所以列表的最后一个元素是一个空格(“”)。我们使用<code class="fe mh mi mj lw b">pop</code>方法移除它。</p><p id="a616" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用这4个数组，我们可以创建一个熊猫数据帧。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="62de" class="ma mb it lw b gy mc md l me mf">df = pd.DataFrame({<br/>'cat':categories, 'col_x':x, 'col_y':y, 'col_z':z<br/>})</span><span id="5e65" class="ma mb it lw b gy mg md l me mf">df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/67bfc32af1e64662b466ba699e878354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*1Hwe4zwEnO9rAUi1dopA5A.png"/></div></figure><p id="7b52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建一个基于x列和y列的2D散点图</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="3f46" class="ma mb it lw b gy mc md l me mf">fig = px.scatter(df, x='col_x', y='col_y', color='cat',<br/>                 width=700, height=500,<br/>                 title="2D Scatter Plot")</span><span id="2665" class="ma mb it lw b gy mg md l me mf">fig.show()</span></pre><p id="5f62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们传递dataframe的名称、用作x轴和y轴的列。可选的<strong class="lb iu">颜色</strong>参数代表数据点的类别。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/ce97bbe26a6fade76b34e095d45dd69e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wPCcDNC_NA07TjQoZOQ5FQ.png"/></div></figure><p id="ffaf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如我们所看到的，类别A和b中的数据点之间没有明显的区别。在某些情况下，在可视化中增加一个特性就能说明很多问题。我们以这样一种方式创建数据帧，即“col_z”具有信息能力。</p><p id="17f1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们使用所有功能创建一个3D散点图。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="c3a9" class="ma mb it lw b gy mc md l me mf">fig = px.scatter_3d(df, x='col_x', y='col_y', z='col_z',<br/>                    color='cat',<br/>                    title="3D Scatter Plot")</span><span id="1d19" class="ma mb it lw b gy mg md l me mf">fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/eb044d6bd90f8a07cc74056271fa2044.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*JzrMEkC0FGRPOvd8dhEPkA.gif"/></div></div></figure><p id="d2cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">col_z中的值清楚地区分了类别A和类别b。当然，我们可以在x轴或y轴上使用col_z，并通过2D散点图获得类似的结果。但是，在某些情况下，所有列都包含我们需要的有价值的信息。</p><p id="15d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们构建一个更复杂的数据框架，每个特征对分类都很重要。</p><p id="2b7f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">特点:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="365d" class="ma mb it lw b gy mc md l me mf">x = np.random.random(size=100)*5<br/>x[-30:] = x[-30:] + 6<br/>x = x + np.random.random(size=100)*8</span><span id="f9df" class="ma mb it lw b gy mg md l me mf">y = np.random.random(size=100)*5<br/>y[:30] = y[:30]*4 + 8<br/>y = y + np.random.random(size=100)*3<br/>y[-30:] = y[-30:] + 4</span><span id="a545" class="ma mb it lw b gy mg md l me mf">z = np.random.random(size=100)*5<br/>z[30:70] = z[30:70] - np.arange(1,41) / 40<br/>z = z + np.random.random(size=100)*5</span><span id="e399" class="ma mb it lw b gy mg md l me mf">categories = "A "*30 + "B "*40 + "C "*30<br/>categories = categories.split(" ")<br/>categories.pop(100)</span></pre><p id="f5cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据帧:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d70f" class="ma mb it lw b gy mc md l me mf">df = pd.DataFrame({<br/>'cat':categories, 'col_x':x, 'col_y':y, 'col_z':x<br/>})</span><span id="5e07" class="ma mb it lw b gy mg md l me mf">df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/c6b1684aeac0beec79ad48f2833a9db3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*tCVVmNX_7fSlamLGmkQ-6w.png"/></div></figure><p id="b2df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基于新功能的散点图:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/eea127b1f4642fab897ca09debf41b10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*YIkYizUjHqeuVd30wXsIpw.gif"/></div></div></figure><p id="edbd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mh mi mj lw b">px.scatter_3d</code>的另一个重要参数是<code class="fe mh mi mj lw b">size. </code>到目前为止，我们创建的图中的点具有相同的大小。然而，我们也可以给<code class="fe mh mi mj lw b">size </code>参数分配一个特性。然后，数据点的大小根据该特征中的值而改变。</p><p id="6204" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们给<code class="fe mh mi mj lw b">color </code>参数分配了一个分类变量，因此数据点用不同的颜色表示。Plotly还提供了对<code class="fe mh mi mj lw b">color </code>参数使用数字特征的选项。在这种情况下，点的颜色会根据比例发生变化。</p><p id="0cca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们使用<code class="fe mh mi mj lw b">size </code>参数再创建一个3D散点图。我们将使用著名的“iris”数据集，它是plotly库中的内置数据集。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0576" class="ma mb it lw b gy mc md l me mf">df_iris = px.data.iris()<br/>df_iris.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/0ab867067d683f6f7ed7e1bdf0331180.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*BjQSX7nK1MGtJR-RLPf8fA.png"/></div></figure><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="2be8" class="ma mb it lw b gy mc md l me mf">fig = px.scatter_3d(<br/>df_iris, x='sepal_length', y='sepal_width', z='petal_width',  color='petal_length',<br/>size='petal_length', size_max=20<br/>)</span><span id="2fef" class="ma mb it lw b gy mg md l me mf">fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/955eabc489550a4475238e0f8d2159d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*WhRcrmWBkCzjdEJl3zFl9g.gif"/></div></div></figure><p id="c4a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有一个参数增加了动态3D散点图的信息量，这就是<code class="fe mh mi mj lw b">symbol</code>。它只接受一个分类变量，代表数据点的符号根据类别而变化。例如，类别A可以用正方形表示，而类别B可以用圆形表示。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><p id="ec88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个动态的3D图承载了大量的信息。如果“一张图胜过千言万语”，这些3D动态图有可能达到100万字:)</p><p id="2839" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>