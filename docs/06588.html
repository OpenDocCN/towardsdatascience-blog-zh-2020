<html>
<head>
<title>How to Build COVID-19 Data-Driven Shiny Apps in 5mins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在5分钟内构建新冠肺炎数据驱动的闪亮应用</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-covid-19-data-driven-shiny-apps-in-5mins-2d7982882a73?source=collection_archive---------60-----------------------#2020-05-24">https://towardsdatascience.com/how-to-build-covid-19-data-driven-shiny-apps-in-5mins-2d7982882a73?source=collection_archive---------60-----------------------#2020-05-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d7aa" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">利用新冠肺炎数据中心构建闪亮的应用程序。一个20行代码的全功能示例。</h2></div><p id="046d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lb">编者按:</em> </strong> <em class="lb"> </em> <a class="ae lc" href="http://towardsdatascience.com/" rel="noopener" target="_blank"> <em class="lb">走向数据科学</em> </a> <em class="lb">是一份以数据科学和机器学习研究为主的中型刊物。我们不是健康专家或流行病学家，本文的观点不应被解释为专业建议。想了解更多关于疫情冠状病毒的信息，可以点击</em> <a class="ae lc" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports" rel="noopener ugc nofollow" target="_blank"> <em class="lb">这里</em> </a> <em class="lb">。</em></p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi ld"><img src="../Images/7f8fb4bc4c5af49f72f618ca2d04df8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*avoRZUDQx4S935eHeJbt7A@2x.png"/></div><p class="ll lm gj gh gi ln lo bd b be z dk translated">徽标由<a class="ae lc" href="http://www.garysandoz.ch/index.html" rel="noopener ugc nofollow" target="_blank">加里·桑多兹</a>和<a class="ae lc" href="https://www.talk-to-me.ch/" rel="noopener ugc nofollow" target="_blank">跟我说话</a>提供。</p></figure><p id="c55a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与新冠肺炎系统相关的数据库很多，但目前没有一个虚拟平台整合了这些来源的很大一部分。这样就很难进行全面的分析，也很难将这些医学信息与外部因素，尤其是社会政治因素联系起来。考虑到这一点，<a class="ae lc" href="https://covid19datahub.io" rel="noopener ugc nofollow" target="_blank">新冠肺炎数据中心</a>旨在开发一个统一的数据集，有助于更好地了解新冠肺炎。</p><p id="9c20" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本教程中，我们将使用到新冠肺炎数据中心的<a class="ae lc" href="https://cran.r-project.org/package=COVID19" rel="noopener ugc nofollow" target="_blank"> R包COVID19 </a> : R接口构建一个简单而完整的闪亮应用程序。</p><p id="df0f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设对<a class="ae lc" href="https://shiny.rstudio.com/tutorial/" rel="noopener ugc nofollow" target="_blank">闪亮的</a>(网络应用)和<a class="ae lc" href="https://plotly.com/r/" rel="noopener ugc nofollow" target="_blank">情节性的</a>(互动情节)有基本的了解，但是可以简单地通过复制/粘贴来构建一个全功能的应用。加载以下软件包以开始使用:</p><pre class="le lf lg lh gt lp lq lr ls aw lt bi"><span id="507d" class="lu lv iq lq b gy lw lx l ly lz">library(shiny)<br/>library(plotly)<br/>library(COVID19)</span></pre><h2 id="c23b" class="lu lv iq bd ma mb mc dn md me mf dp mg ko mh mi mj ks mk ml mm kw mn mo mp mq bi translated">新冠肺炎（新型冠状病毒肺炎）</h2><p id="e3a6" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">COVID19 R包通过<code class="fe mw mx my lq b">covid19()</code>功能提供了与<a class="ae lc" href="https://covid19datahub.io" rel="noopener ugc nofollow" target="_blank">新冠肺炎数据中心</a>的无缝集成。键入<code class="fe mw mx my lq b">?covid19</code>获取参数的完整列表。这里我们将使用:</p><ul class=""><li id="cc5b" class="mz na iq kh b ki kj kl km ko nb ks nc kw nd la ne nf ng nh bi translated"><code class="fe mw mx my lq b">country</code>:国名或ISO代码的向量。</li><li id="3edc" class="mz na iq kh b ki ni kl nj ko nk ks nl kw nm la ne nf ng nh bi translated"><code class="fe mw mx my lq b">level</code>:粒度级别；数据按(1)国家，(2)地区，(3)城市。</li><li id="4365" class="mz na iq kh b ki ni kl nj ko nk ks nl kw nm la ne nf ng nh bi translated"><code class="fe mw mx my lq b">start</code>:计息期的开始日期。</li><li id="eb46" class="mz na iq kh b ki ni kl nj ko nk ks nl kw nm la ne nf ng nh bi translated"><code class="fe mw mx my lq b">end</code>:计息期的结束日期。</li></ul><h2 id="aa4a" class="lu lv iq bd ma mb mc dn md me mf dp mg ko mh mi mj ks mk ml mm kw mn mo mp mq bi translated">定义用户界面</h2><p id="0ff7" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">定义以下输入…</p><ul class=""><li id="c897" class="mz na iq kh b ki kj kl km ko nb ks nc kw nd la ne nf ng nh bi translated"><code class="fe mw mx my lq b">country</code>:国家名称。请注意，选项是使用<code class="fe mw mx my lq b">covid19()</code>功能自动填充的。</li><li id="e73c" class="mz na iq kh b ki ni kl nj ko nk ks nl kw nm la ne nf ng nh bi translated"><code class="fe mw mx my lq b">type</code>:要使用的度量。其中一个是<code class="fe mw mx my lq b">c("confirmed", "tests", "recovered", "deaths")</code>，但还有许多其他的可供选择。完整列表见<a class="ae lc" href="https://covid19datahub.io/articles/doc/data.html" rel="noopener ugc nofollow" target="_blank">此处</a>。</li><li id="475e" class="mz na iq kh b ki ni kl nj ko nk ks nl kw nm la ne nf ng nh bi translated"><code class="fe mw mx my lq b">level</code>:粒度级别(国家-地区-城市)。</li><li id="b8cb" class="mz na iq kh b ki ni kl nj ko nk ks nl kw nm la ne nf ng nh bi translated"><code class="fe mw mx my lq b">date</code>:开始和结束日期。</li></ul><p id="06fa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">…以及输出:</p><ul class=""><li id="4b6f" class="mz na iq kh b ki kj kl km ko nb ks nc kw nd la ne nf ng nh bi translated"><code class="fe mw mx my lq b">covid19plot</code> : plotly输出，将渲染一个交互的plot。</li></ul><p id="0b3d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">把一切都包装成一个<code class="fe mw mx my lq b">fluidPage</code>:</p><pre class="le lf lg lh gt lp lq lr ls aw lt bi"><span id="aef3" class="lu lv iq lq b gy lw lx l ly lz"># Define UI for application<br/>ui &lt;- fluidPage(<br/>    <br/> selectInput(<br/>  "country", <br/>  label    = "Country", <br/>  multiple = TRUE, <br/>  choices  = unique(covid19()$administrative_area_level_1), <br/>  selected = "Italy"<br/> ),</span><span id="29a7" class="lu lv iq lq b gy nn lx l ly lz"> selectInput(<br/>  "type", <br/>  label    = "type", <br/>  choices  = c("confirmed", "tests", "recovered", "deaths")<br/> ),</span><span id="513f" class="lu lv iq lq b gy nn lx l ly lz"> selectInput(<br/>  "level", <br/>  label    = "Granularity", <br/>  choices  = c("Country" = 1, "Region" = 2, "City" = 3), <br/>  selected = 2<br/> ),</span><span id="9c12" class="lu lv iq lq b gy nn lx l ly lz"> dateRangeInput(<br/>  "date", <br/>  label    = "Date", <br/>  start    = "2020-01-01"<br/> ),   <br/> <br/> plotlyOutput("covid19plot")<br/>    <br/>)</span></pre><h2 id="0f5d" class="lu lv iq bd ma mb mc dn md me mf dp mg ko mh mi mj ks mk ml mm kw mn mo mp mq bi translated">服务器逻辑</h2><p id="fde3" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">在UI中定义了反馈输入之后，我们将这些输入连接到<code class="fe mw mx my lq b">covid19()</code>函数来获取数据。以下代码片段显示了如何呈现交互式绘图(ly ),当任何输入发生变化时，该绘图会自动更新。请注意，<code class="fe mw mx my lq b">covid19()</code>功能使用内部<strong class="kh ir">内存缓存</strong>系统，因此数据不会被下载两次。多次调用该函数是非常高效和用户友好的。</p><pre class="le lf lg lh gt lp lq lr ls aw lt bi"><span id="1c96" class="lu lv iq lq b gy lw lx l ly lz"># Define server logic<br/>server &lt;- function(input, output) {</span><span id="8a40" class="lu lv iq lq b gy nn lx l ly lz"> output$covid19plot &lt;- renderPlotly({<br/>  if(!is.null(input$country)){<br/>   <br/>   x &lt;- covid19(<br/>    country = input$country, <br/>    level   = input$level, <br/>    start   = input$date[1], <br/>    end     = input$date[2]<br/>   )<br/>   <br/>   color &lt;- paste0("administrative_area_level_", input$level)<br/>   plot_ly(x = x[["date"]], y = x[[input$type]], color = x[[color]])</span><span id="056d" class="lu lv iq lq b gy nn lx l ly lz">  }<br/> })<br/>   <br/>}</span></pre><h2 id="af54" class="lu lv iq bd ma mb mc dn md me mf dp mg ko mh mi mj ks mk ml mm kw mn mo mp mq bi translated">运行应用程序</h2><p id="a35a" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">函数<code class="fe mw mx my lq b">shinyApp</code>从上面实现的<code class="fe mw mx my lq b">ui</code>和<code class="fe mw mx my lq b">server</code>参数构建一个应用程序。</p><pre class="le lf lg lh gt lp lq lr ls aw lt bi"><span id="16a0" class="lu lv iq lq b gy lw lx l ly lz"># Run the application <br/>shinyApp(ui = ui, server = server)</span></pre><p id="3969" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<a class="ae lc" href="https://guidotti.shinyapps.io/h83h5/" rel="noopener ugc nofollow" target="_blank">https://guidotti.shinyapps.io/h83h5/</a>有售</p><h2 id="b63c" class="lu lv iq bd ma mb mc dn md me mf dp mg ko mh mi mj ks mk ml mm kw mn mo mp mq bi translated">结束语</h2><p id="0238" class="pw-post-body-paragraph kf kg iq kh b ki mr jr kk kl ms ju kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">我们构建了一个与R包COVID19接口的简单应用程序，它代表了一个可重用的通用架构。示例应用程序可以用作更高级的新冠肺炎数据驱动应用程序的构建块。特别是，通过<code class="fe mw mx my lq b">covid19()</code>功能获得的数据集包括关于新冠肺炎案例、政策措施、地理信息和外部关键字的额外指标，这些指标允许使用<a class="ae lc" href="https://data.worldbank.org/" rel="noopener ugc nofollow" target="_blank">世界银行公开数据</a>、<a class="ae lc" href="https://www.google.com/covid19/mobility/" rel="noopener ugc nofollow" target="_blank">谷歌移动报告</a>、<a class="ae lc" href="https://www.apple.com/covid19/mobility" rel="noopener ugc nofollow" target="_blank">苹果移动报告</a>和当地政府数据轻松扩展数据集。参见<a class="ae lc" href="https://covid19datahub.io/articles/doc/data.html" rel="noopener ugc nofollow" target="_blank">完整数据集文档</a>和<a class="ae lc" href="https://covid19datahub.io/articles/api/r.html" rel="noopener ugc nofollow" target="_blank"> COVID19代码片段</a>。</p></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="fc9b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">新冠肺炎数据中心是免费软件，没有任何担保。请确保同意<a class="ae lc" href="https://covid19datahub.io/LICENSE.html" rel="noopener ugc nofollow" target="_blank">使用条款</a>。</p><p id="1c3f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[1]吉多蒂，即阿尔迪亚，d .(2020)。<a class="ae lc" href="https://doi.org/10.21105/joss.02376" rel="noopener ugc nofollow" target="_blank">新冠肺炎数据中心</a>，《开源软件杂志》，5(51):2376</p></div></div>    
</body>
</html>