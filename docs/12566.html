<html>
<head>
<title>Rendering Text on Video using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 渲染视频文本</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/rendering-text-on-video-using-python-1c006519c0aa?source=collection_archive---------6-----------------------#2020-08-30">https://towardsdatascience.com/rendering-text-on-video-using-python-1c006519c0aa?source=collection_archive---------6-----------------------#2020-08-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="23d2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 moviePy 库的动手机器学习项目</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3001d74d828bee59102206003acd52f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q_7Ugp5Xcj32JR5nk0Ftsg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">雅各布·欧文斯在<a class="ae ky" href="https://unsplash.com/s/photos/video-editing?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="1423" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di">在这篇文章中，我将向你展示如何使用 Python 向你的视频添加文本。乍一看，这听起来很难，但是相信我，这比你想象的要容易得多，而且很酷。这将是一个简单的练习，我们将能够看到机器学习如何在现实生活中使用。如果你看看我的其他文章，你会发现我喜欢动手做项目。我觉得这是练习我们编码技能，提升自己的最好方式。当你做一点研究时，你会在网上找到一些项目想法。但是我强烈建议你自己进行头脑风暴，写下你个人的项目想法，然后开始研究如何实现它们。让我们回到我们的项目。</span></p><h2 id="ed1a" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">目录</h2><ul class=""><li id="b34d" class="mx my it lb b lc mz lf na li nb lm nc lq nd lu ne nf ng nh bi translated"><strong class="lb iu"> <em class="ni">入门</em> </strong></li><li id="d552" class="mx my it lb b lc nj lf nk li nl lm nm lq nn lu ne nf ng nh bi translated"><strong class="lb iu"> <em class="ni">第一步:导入库</em> </strong></li><li id="add4" class="mx my it lb b lc nj lf nk li nl lm nm lq nn lu ne nf ng nh bi translated"><strong class="lb iu"> <em class="ni">第二步:定义你的视频</em> </strong></li><li id="cfd4" class="mx my it lb b lc nj lf nk li nl lm nm lq nn lu ne nf ng nh bi translated"><strong class="lb iu"> <em class="ni">第三步:创建你的文本</em> </strong></li><li id="ed69" class="mx my it lb b lc nj lf nk li nl lm nm lq nn lu ne nf ng nh bi translated"><strong class="lb iu"> <em class="ni">最后一步:在视频上渲染文字</em> </strong></li></ul></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><h1 id="88c9" class="nv mf it bd mg nw nx ny mj nz oa ob mm jz oc ka mp kc od kd ms kf oe kg mv of bi translated">入门指南</h1><p id="e596" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li og lk ll lm oh lo lp lq oi ls lt lu im bi translated">正如你可以理解的标题，这个项目，我们将需要一个视频记录文件。它甚至可以是你对着镜头说话的录音。使用名为<em class="ni"> MoviePy，</em>的库，我们将向视频记录中添加文本。</p><p id="1f88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们将导入库，我将向您展示如何安装它们。在第二步中，我们将定义我们将用于项目的视频，它可以是一个短视频。在第三步中，我们将定义一个文本变量，它将是添加到视频中的文本。最后，我们将渲染视频记录上的文本。如果您准备好了，让我们从安装库开始吧！</p><h2 id="5ab2" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">图书馆</h2><p id="f040" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li og lk ll lm oh lo lp lq oi ls lt lu im bi translated">我们将为这个项目使用一个库，但要进行文本渲染，我们还需要安装另一个模块。该库名为 MoviePy，安装方法如下:</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="91cd" class="me mf it ok b gy oo op l oq or">pip install moviepy</span></pre><p id="920b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以从官方<a class="ae ky" href="https://zulko.github.io/moviepy/" rel="noopener ugc nofollow" target="_blank">文档</a>页面了解更多关于<em class="ni"> moviepy </em>的信息。</p><p id="a296" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要安装的第二个模块叫做 ImageMagick。如果没有此模块，您可能会在将文本渲染到视频录制时出现错误。为了安装 ImageMagick，我使用了 Homebrew，这是一个用于 macOs 和 Linux 设备的软件包管理器。如果您使用不同的操作系统，可以在线搜索“如何安装 ImageMagick”。</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="9961" class="me mf it ok b gy oo op l oq or">brew install imagemagick</span></pre><p id="0b3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以从官方的<a class="ae ky" href="https://imagemagick.org/script/download.php" rel="noopener ugc nofollow" target="_blank">文档</a>页面了解更多关于<em class="ni"> imagemagick </em>的信息。</p><p id="0ac4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> MoviePy </strong>是一个可以读写所有最常见的音频和视频格式的库，包括 GIF。如果您在安装 MoviePy 库时遇到问题，请尝试安装 ffmpeg。Ffmpeg 是一个领先的多媒体框架，能够解码、编码、转码、复用、解复用、流式传输、过滤和播放人类和机器创造的几乎任何东西。</p><p id="57b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们应该开始在代码编辑器中编写代码了。我们将从导入库开始。</p></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><h1 id="de20" class="nv mf it bd mg nw nx ny mj nz oa ob mm jz oc ka mp kc od kd ms kf oe kg mv of bi translated">步骤 1-导入库</h1><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="2efc" class="me mf it ok b gy oo op l oq or">import moviepy.editor as mp</span></pre><p id="f311" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是的，这就是我们完成任务所需要的。抓紧时间，让我们进入下一步。</p></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><h1 id="a96a" class="nv mf it bd mg nw nx ny mj nz oa ob mm jz oc ka mp kc od kd ms kf oe kg mv of bi translated">第二步——定义你的视频</h1><p id="fb30" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li og lk ll lm oh lo lp lq oi ls lt lu im bi translated">在这一步，我们将定义一个名为“my_video”的变量。然后使用 moviepy 库的特殊方法，我们将定义我们的视频文件。此外，我想保留视频的音频，这就是为什么视频的值为 True。</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="8198" class="me mf it ok b gy oo op l oq or">my_video = mp.VideoFileClip(“data/video_test.mov”, audio=True)</span></pre><p id="99fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">顺便说一下，有许多视频格式，其中一些可以被列为:</p><ul class=""><li id="8eda" class="mx my it lb b lc ld lf lg li os lm ot lq ou lu ne nf ng nh bi translated">MP4 (mp4、m4a、m4v、f4v、f4a、m4b、m4r、f4b、mov)</li><li id="f103" class="mx my it lb b lc nj lf nk li nl lm nm lq nn lu ne nf ng nh bi translated">3GP (3gp、3gpp2、3g2、3gpp、3gpp 2)</li><li id="e61a" class="mx my it lb b lc nj lf nk li nl lm nm lq nn lu ne nf ng nh bi translated">OGG (ogg、oga、ogv、ogx)</li><li id="08b8" class="mx my it lb b lc nj lf nk li nl lm nm lq nn lu ne nf ng nh bi translated">WMV (wmv、wma、asf*)</li></ul><p id="5b8c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请确保您的路径正确，并且您的视频格式工作正常。如果您在此步骤中遇到问题，请尝试将您的视频转换为不同的格式。</p><p id="f30b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们进入下一步之前，让我们定义视频的宽度和高度。我们将需要这些渲染成视频文本。别担心，这很容易。</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="92be" class="me mf it ok b gy oo op l oq or">w,h = moviesize = my_video.size</span></pre></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><h1 id="e9f9" class="nv mf it bd mg nw nx ny mj nz oa ob mm jz oc ka mp kc od kd ms kf oe kg mv of bi translated">第三步——创建你的文本</h1><p id="3ce4" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li og lk ll lm oh lo lp lq oi ls lt lu im bi translated">在这一步，我们将为我们的文本定义一个新的变量。我把它叫做“我的文本”。使用 TextClip 方法，我们将能够创建文本。</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="2854" class="me mf it ok b gy oo op l oq or">my_text = mp.TextClip(“The Art of Adding Text on Video”, font=’Amiri-regular’, color=’white’, fontsize=34)</span></pre><p id="c818" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如你所见，我们甚至可以玩参数。我们可以自定义我们的文本，这真的很酷。文本字体、文本颜色和字体大小可以根据您的喜好进行更改。</p><p id="40ee" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们将定位视频中的文本。我们也可以为我们的文本设计一个背景。您可以试验参数，看看它是如何工作的。背景颜色、背景不透明度和文本位置是一些参数。</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="e415" class="me mf it ok b gy oo op l oq or">txt_col = my_text.on_color(size=(my_video.w + my_text.w, my_text.h+5), color=(0,0,0), pos=(6,’center’), col_opacity=0.6)</span></pre></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><h1 id="69a9" class="nv mf it bd mg nw nx ny mj nz oa ob mm jz oc ka mp kc od kd ms kf oe kg mv of bi translated">最后一步—在视频上渲染文本</h1><p id="42e7" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li og lk ll lm oh lo lp lq oi ls lt lu im bi translated">太好了！你坚持到了最后一步。这一步就是奇迹发生的地方。</p><h2 id="1b9e" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">动画</h2><p id="6619" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li og lk ll lm oh lo lp lq oi ls lt lu im bi translated">首先，我们将定义一个名为“text_mov”的新变量，我们可以在其中添加一些动画。文本在视频上的移动。玩参数就能找到自己喜欢的结果。这是我们制作动画的代码行:</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="c42c" class="me mf it ok b gy oo op l oq or">txt_mov = txt_col.set_pos( lambda t: (max(w/30,int(w-0.5*w*t)),max(5*h/6,int(100*t))) )</span></pre><h2 id="a9b0" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">翻译</h2><p id="fc60" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li og lk ll lm oh lo lp lq oi ls lt lu im bi translated">最后，是时候渲染我们视频上的文本了。多亏了 moviepy 库，我们将使用名为“CompositeVideoClip”的方法为我们进行渲染。如前所述，如果你在这一行遇到错误，我强烈推荐安装<strong class="lb iu"> imageMagick </strong>和<strong class="lb iu"> ffmpeg </strong>模块。这是让奇迹发生的台词:</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="0f97" class="me mf it ok b gy oo op l oq or">final = mp.CompositeVideoClip([my_video,txt_mov])</span></pre><h2 id="ee01" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">导出您的结果</h2><p id="25e4" class="pw-post-body-paragraph kz la it lb b lc mz ju le lf na jx lh li og lk ll lm oh lo lp lq oi ls lt lu im bi translated">差不多了，看看最后的效果如何，我们导出视频吧。我们将把它保存为一个新的视频文件。导出真正酷的是你可以调整视频格式，甚至每秒帧数。下面是导出渲染视频的前 5 秒的代码:</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="33a6" class="me mf it ok b gy oo op l oq or">final.subclip(0,17).write_videofile(“data/text_add_result.mov”,fps=24,codec=’libx264')</span></pre></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><h1 id="b98d" class="nv mf it bd mg nw nx ny mj nz oa ob mm jz oc ka mp kc od kd ms kf oe kg mv of bi translated">分享结果</h1><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ov ow l"/></div></figure><p id="5174" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">恭喜你。<strong class="lb iu"> </strong>你已经创建了一个程序，在不使用任何视频编辑软件的情况下，在视频上呈现自定义文本。看到机器学习如何应用在我们的日常生活中，这真的很酷。希望你喜欢阅读这篇文章并参与这个项目。如果你今天学到了新东西，我会很高兴。从事像这样的动手编程项目是提高编码技能的最好方式。</p><p id="6771" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您在执行代码时有任何问题，请随时<a class="ae ky" href="https://sonsuzdesign.blog/contact/" rel="noopener ugc nofollow" target="_blank">联系我</a>。</p><blockquote class="ox oy oz"><p id="32d2" class="kz la ni lb b lc ld ju le lf lg jx lh pa lj lk ll pb ln lo lp pc lr ls lt lu im bi translated">关注我的<a class="ae ky" href="https://medium.com/@lifexplorer" rel="noopener">博客</a>和<a class="ae ky" href="https://towardsdatascience.com/" rel="noopener" target="_blank">走向数据科学</a>以获得灵感。谢谢你，</p></blockquote></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><h2 id="c384" class="me mf it bd mg mh mi dn mj mk ml dp mm li mn mo mp lm mq mr ms lq mt mu mv mw bi translated">相关内容</h2><div class="pd pe gp gr pf pg"><a rel="noopener follow" target="_blank" href="/extracting-speech-from-video-using-python-f0ec7e312d38"><div class="ph ab fo"><div class="pi ab pj cl cj pk"><h2 class="bd iu gy z fp pl fr fs pm fu fw is bi translated">使用 Python 从视频中提取语音</h2><div class="pn l"><h3 class="bd b gy z fp pl fr fs pm fu fw dk translated">使用 Google 语音识别 API 的简单实用项目</h3></div><div class="po l"><p class="bd b dl z fp pl fr fs pm fu fw dk translated">towardsdatascience.com</p></div></div><div class="pp l"><div class="pq l pr ps pt pp pu ks pg"/></div></div></a></div><div class="pd pe gp gr pf pg"><a rel="noopener follow" target="_blank" href="/simple-face-detection-in-python-1fcda0ea648e"><div class="ph ab fo"><div class="pi ab pj cl cj pk"><h2 class="bd iu gy z fp pl fr fs pm fu fw is bi translated">Python 中的简单人脸检测</h2><div class="pn l"><h3 class="bd b gy z fp pl fr fs pm fu fw dk translated">如何使用 OpenCV 库检测图像中的人脸</h3></div><div class="po l"><p class="bd b dl z fp pl fr fs pm fu fw dk translated">towardsdatascience.com</p></div></div><div class="pp l"><div class="pv l pr ps pt pp pu ks pg"/></div></div></a></div></div></div>    
</body>
</html>