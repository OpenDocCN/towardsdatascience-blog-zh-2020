<html>
<head>
<title>Classifying Online-Shop Customers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对网上商店顾客进行分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/classifying-online-shop-customers-65438e0cc58b?source=collection_archive---------40-----------------------#2020-07-25">https://towardsdatascience.com/classifying-online-shop-customers-65438e0cc58b?source=collection_archive---------40-----------------------#2020-07-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e88c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">不同机器学习分类器的可视化方法</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/87b4cbd5e0655ab4c1630b872bb605de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I2zQucb37HfkagZawr6VWg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="ba78" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这篇文章中，我想展示如何使用不同的机器学习方法，利用在线商店的跟踪数据将客户分为购买和不购买。利用从原始数据中汇总的特征，例如访问次数和页面浏览次数，可以训练和可视化预测模型。</p><p id="0476" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">特别注意借助于二维图和决策边界的着色的预测模型的视觉呈现。不同方法的特点以及模型调整不足和过度的情况变得很明显。为了使可视化成为可能，我考虑只有两个特征的非常简化的模型。</p><h2 id="c193" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">数据导入</h2><p id="24b7" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">让我们从 CSV 文件加载原始数据。这些来自 Kaggle 数据集<a class="ae mp" href="https://www.kaggle.com/mkechinov/ecommerce-behavior-data-from-multi-category-store" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/mkechinov/ecommerce-behavior-data-from-multi-category-store</a>。这与我在关于分段和可视化的文章中使用的数据源相同:</p><p id="6431" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae mp" rel="noopener" target="_blank" href="/segmentation-of-online-shop-customers-8c304a2d84b4">https://towards data science . com/segmentation-of-online-shop-customers-8c 304 a2 d 84 b 4</a></p><p id="dc01" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了演示和分析，我只使用了一部分数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/db2c2a967ba7cbb21eb85182bb7b0cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8tIzerPUzIKXjWY04vEQjQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">跟踪网上商店的数据</p></figure><p id="905e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在线商店的产品页面上有 1，000，000 条数据记录，具有产品类别、品牌、价格、用户会话 id 等特征。</p><p id="586a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了进一步处理数据，我们形成了一个数据框架，该数据框架聚集了各个匿名访问者的数据，并计算了在线商店的页面浏览量和访问量。此外，为每个访问者计算购买物品的数量，从而创建一个标签，无论该顾客是否是购买者。</p><p id="04aa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了简化下面的演示，从分析中删除了一些访问者的数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/4f81911676b1752a37bec8d01d828c40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fOhLqi_8kqaE6npCeESr1A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">网上商店用户的汇总数据</p></figure><p id="aab1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这为我们提供了来自 121 个网站访问者的数据。</p><h2 id="6be6" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">数据的图形表示</h2><p id="fd0a" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在我们开始分析之前，让我们来看一个访问者的二维图，它使用访问次数和页面浏览量作为坐标轴。是否是买家由颜色代码表示。图书馆“Plotly”(【https://plotly.com/】)是用来搞阴谋的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/f5b3a7bb7694843a4a5f388b52d494f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6DfMJQXkQanRRNrJU9mAWg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">网店用户的特征空间/作者提供的图片</p></figure><p id="df7c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">红点和绿点大多集中在这个“特征空间”的某些区域。在下文中，我们尝试创建分类模型，根据访问者在特征空间中的位置，正确地将他们识别为购买者。</p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="1613" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了能够可视化模型和它们的预测，我们需要一个辅助函数，它也可以在二维图中绘制决策边界。训练完模型后，该函数对一个狭窄的点网格执行分类预测，然后使用此信息根据预测对区域进行着色。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><h2 id="ef79" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">按会话和页面浏览量对访问者进行分类</h2><p id="c84c" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">对于分类模型的实现，我们使用库“Scikit Learn”(<a class="ae mp" href="https://scikit-learn.org/" rel="noopener ugc nofollow" target="_blank">https://scikit-learn.org/</a>)。我们考虑不同的方法，包括我们的可视化功能的参数。</p><h2 id="51c8" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">朴素贝叶斯分类</h2><p id="33aa" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">贝叶斯分类器是从贝叶斯定理导出的分类器。它将每个对象分配给它最可能所属的类。形式上，它是一个数学函数，将一个类分配给特征空间中的每个点。</p><p id="5467" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">朴素贝叶斯分类器因其快速的可计算性而非常流行。天真的基本假设是属性是独立的。在我们的例子中，这并没有实现，页面浏览的数量取决于访问的数量。</p><p id="8c7f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如下图所示，结果的质量也一般。分类器只是粗略地划分了红点和绿点的区域。很多点都在错误的区域。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/16268045373f39ac2558c31cf10cd814.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QpQ1yc39DeyBxjCRGkcV2A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者使用朴素贝叶斯/图像进行分类</p></figure><p id="d8d9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">关于朴素贝叶斯的更多信息:</p><div class="nc nd gp gr ne nf"><a href="https://medium.com/machine-learning-101/chapter-1-supervised-learning-and-naive-bayes-classification-part-1-theory-8b9e361897d5" rel="noopener follow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">第 1 章:监督学习和朴素贝叶斯分类—第 1 部分(理论)</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">欢迎来到监督学习的踏脚石。我们首先讨论一个小场景，它将构成…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">medium.com</p></div></div><div class="no l"><div class="np l nq nr ns no nt kp nf"/></div></div></a></div><h2 id="74c5" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">支持向量机分类</h2><p id="5720" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我们从线性支持向量分类开始。对于线性内核，最佳可能分离由直线实现。在图中，您可以看到直线是如何放置的，以保持到分类边界附近的点的距离尽可能大。这种线性模型定义复杂区域的可能性自然是有限的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/c618f80749de80cb9f4fb78d9b3cbf25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xD5DTJhEt0Tln7weTtgAnA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者用 SVM /图像分类</p></figure><p id="7b0e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">关于支持向量机的更多信息:</p><div class="nc nd gp gr ne nf"><a rel="noopener follow" target="_blank" href="/a-friendly-introduction-to-support-vector-machines-svm-925b68c5a079"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">支持向量机的友好介绍(SVM)</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">机器学习被认为是人工智能的一个分支，它与人工智能的发展密切相关</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">towardsdatascience.com</p></div></div><div class="no l"><div class="nu l nq nr ns no nt kp nf"/></div></div></a></div><p id="d990" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在具有多项式核的变体中，多项式被使用到指定的次数作为分离。该图显示了高达 4 次多项式的使用，这使得该方法有更多的可能性来适应数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/c618f80749de80cb9f4fb78d9b3cbf25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xD5DTJhEt0Tln7weTtgAnA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者用多项式 SVM /图像分类</p></figure><p id="cace" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果程度设置得高，则可以在特征空间中定义更复杂的区域。具有混合点的区域仍然没有被更好地解决。然而，随着多项式次数的增加，有过度拟合的危险。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/33ebb2aaaaad56630fcda0b1edc0af32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jaF5ta1eBC0Zu0h6luObrQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者用多项式 SVM-10 次/图像进行分类</p></figure><h2 id="b93a" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">神经元网络</h2><p id="5420" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">有了神经网络，可以定义任何复杂的功能和区域。这是由层数和神经元数定义的。在该图中，使用了具有 3 层，每层 25 个神经元的神经网络。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/d0b2d24569a99bba48fda8c72bd90779.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mXIiAy6WxgysqZvwrcMx6Q.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者用神经网络/图像分类</p></figure><p id="acb5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">关于神经网络分类的更多信息，请参见:</p><div class="nc nd gp gr ne nf"><a href="https://medium.com/gadictos/iris-data-classification-using-neural-net-335d3303abd8" rel="noopener follow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">基于神经网络的虹膜数据分类</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">Iris flowers 数据集是分类文献中最著名的数据集之一。目标是…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">medium.com</p></div></div><div class="no l"><div class="nv l nq nr ns no nt kp nf"/></div></div></a></div><h2 id="46f1" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">决策树</h2><p id="bdac" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">根据允许的最大深度，决策树可以形成或多或少复杂的分类区域。然而，总是仅在轴方向上具有决策限制。这导致区域呈阶梯状。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/c00bf9770ae20e6a13e7e872648e80ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CZLnAE1O2q9GpVi_uTCWfQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者用决策树/图片分类</p></figure><p id="53e9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在深度很深的地方，决策树很快就会过度适应。这可以在图中通过窄条纹清楚地看到，每个窄条纹仅分类一个数据点。</p><p id="376a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有关决策树的更多信息，请访问:</p><div class="nc nd gp gr ne nf"><a rel="noopener follow" target="_blank" href="/a-guide-to-decision-trees-for-machine-learning-and-data-science-fe2607241956"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">机器学习和数据科学决策树指南</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">决策树是一类非常强大的机器学习模型，可以在许多任务中实现高精度，同时…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">towardsdatascience.com</p></div></div><div class="no l"><div class="nw l nq nr ns no nt kp nf"/></div></div></a></div><h2 id="9341" class="lr ls iq bd lt lu lv dn lw lx ly dp lz le ma mb mc li md me mf lm mg mh mi mj bi translated">随机森林——决策树的集合</h2><p id="8e7c" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">如果不使用单个决策树，而是使用多个决策树，然后让大多数单个分类器来决定整体分类，我们就称之为随机森林。这些具有决策树的一些优点，例如简单性和良好的可解释性，但是它们可以更灵活地划分分类区域，并且不会很快过度适应。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/39fa747dda84c9c681b1fdfdfb2fb42d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SWjcOfpg5r6-czfw5ovR3w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者用随机森林/图像分类</p></figure><p id="4c02" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该图显示了非常灵活的决策限制，但也显示了过度适应的方法。</p><p id="0627" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有关随机森林的更多信息，请访问:</p><div class="nc nd gp gr ne nf"><a href="https://medium.com/rants-on-machine-learning/the-unreasonable-effectiveness-of-random-forests-f33c3ce28883" rel="noopener follow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">随机森林的不合理有效性</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">机器学习从业者有喜欢的算法是很常见的。这有点不合理，因为没有…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">medium.com</p></div></div><div class="no l"><div class="nx l nq nr ns no nt kp nf"/></div></div></a></div><p id="028d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用这个只有两个特征的买家分类的例子，我们直观地展示了一些非常普遍的分类方法的典型属性。这有助于发展对方法的直觉，并更好地评估风险，如过度适应。</p></div></div>    
</body>
</html>