<html>
<head>
<title>ML from Scratch- Polynomial Regression Using PyTorch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ML 从零开始-使用 PyTorch 的多项式回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/polynomial-regression-using-pytorch-from-scratch-500b7887b0ed?source=collection_archive---------26-----------------------#2020-06-02">https://towardsdatascience.com/polynomial-regression-using-pytorch-from-scratch-500b7887b0ed?source=collection_archive---------26-----------------------#2020-06-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/24dcda7652665f33adaf08d5721c3d48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VGrfNUsYnS55focXfzzZLw.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来自<a class="ae jg" href="https://www.pexels.com/photo/aerial-photography-of-island-3427774/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae jg" href="https://www.pexels.com/@lukas-rodriguez-1845331?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Lukas Rodriguez </a>摄影</p></figure><div class=""/><div class=""><h2 id="a648" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">如何编写多项式回归模型及其背后的数学的完整指南</h2></div><p id="3d06" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">说到预测分析，回归模型被证明是最具成本效益的方法之一。虽然线性回归模型可以提供一些很好的预测，但在某些情况下，多项式回归模型可以大大优于简单的线性模型。在下面的项目中，我们将看看如何在 PyTorch 中从头开始创建多项式回归模型。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="7795" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">项目目标</h1><ul class=""><li id="2380" class="mt mu jj la b lb mv le mw lh mx ll my lp mz lt na nb nc nd bi translated">在<strong class="la jk"> PyTorch </strong>中实现机器学习模型，使用多项式回归算法进行预测。</li></ul><p id="7890" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用基本的 PyTorch 张量运算，完全从头开始创建模型。</p><ul class=""><li id="b8c2" class="mt mu jj la b lb lc le lf lh ne ll nf lp ng lt na nb nc nd bi translated">利用该模型对汽车价格进行预测分析。在项目的最后，我们的目标是开发一个高效的 ML 模型，它可以根据汽车的特征预测汽车的价格。</li><li id="8edd" class="mt mu jj la b lb nh le ni lh nj ll nk lp nl lt na nb nc nd bi translated">对数据进行可视化和描述性分析，以预测哪些功能在确定汽车价格时起着关键作用。</li></ul></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="409a" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">导入项目依赖关系</h1><p id="e191" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh nm lj lk ll nn ln lo lp no lr ls lt im bi translated">在我们开始这个项目之前，让我们导入所有必要的库和函数。</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="e21b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，让我们导入数据集。</p><p id="52ff" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果你打算自己动手，这里有数据集的<a class="ae jg" href="https://www.kaggle.com/goyalshalini93/car-data" rel="noopener ugc nofollow" target="_blank">链接。</a></p><p id="4f89" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我还会在本文末尾将 GitHub repo 与项目笔记本和数据集链接起来。</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nv"><img src="../Images/adde45ea4bce9c0f0a413f847cc1ba95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c_mGYCJpv3c4Es623HPugA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">在我的笔记本中看到的数据框</p></figure><p id="6cc7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于多项式回归模型对于初学者来说已经有点太难了，因此，为了简单起见，我们将在项目中只使用连续变量。</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nw"><img src="../Images/6bb67bd710890b9c611401de4de91e88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hWK8TJJxLZppajMeAZ6jUQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">我们将着手更新数据框</p></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="a963" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">数据争论</h1><p id="85d6" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh nm lj lk ll nn ln lo lp no lr ls lt im bi translated">现在，让我们分析数据，看看是否需要清理或修改。首先，让我们检查数据帧中每一列的数据类型。</p><p id="bf88" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">*需要注意的一点是，数据集没有空值。</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/75e36f554f87640646abff6631cb209e.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/1*dtvXshZRpSLj0aR6GrNQpg.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">不同列的数据类型</p></figure><p id="4ad4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如我们所看到的，一些数据是'<em class="ny"> int64 '，</em>类型，而一些数据是'<em class="ny"> float64' </em>类型。由于我们将使用张量，我们可能希望在我们的特征集中有一个统一的数据类型。因此，我们将在后面的步骤中将整个数据帧转换为'<em class="ny"> float64' </em>。</p><p id="30f3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们将看看数据框的描述性分析。</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nz"><img src="../Images/b3c9124bdd42956a694637aefb78fc03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gpitBi1rYZE0Jpq2vrTauA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">显示我们的数据框的描述性分析的表格</p></figure><p id="88ae" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如我们所看到的，不同列中的数据在规模上有很大差异。在我们的数据集中，在较低范围上有顺序为<em class="ny"> 1e+0 </em>的元素，在较高范围上有顺序为<em class="ny"> 1e+3 </em>的元素。<strong class="la jk">我们可能想要将数据标准化</strong>。我们将在项目的后续步骤中处理这个问题。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="be2d" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">特征选择</h1><p id="3cab" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh nm lj lk ll nn ln lo lp no lr ls lt im bi translated">让我们首先绘制每个独立变量相对于目标变量(质量)的曲线图。</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oa"><img src="../Images/eecf8ff3fb3a592c6626bba566c61dd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4Zyb4WQTfQSmWPRQX60hbA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">所有情节的截图</p></figure><p id="d6be" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，让我们看看数据集的相关值。</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ob"><img src="../Images/a8b6510eff91eeb267cdfe4df0bdb13e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*koKI7bH0MI8XYg_v_yaJhw.png"/></div></div></figure><blockquote class="oc od oe"><p id="d588" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">从上面的直观分析中，我们可以清楚地看到<strong class="la jk">发动机尺寸</strong> (++0.87)、<strong class="la jk">整备质量</strong> (+0.84)和<strong class="la jk">马力</strong> (+0.81)与因变量<strong class="la jk">价格</strong>呈现出非常强的相关性。</p><p id="3360" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated"><strong class="la jk">车宽</strong> (0.76)、<strong class="la jk">城市 mpg </strong> (-0.69)、<strong class="la jk">公路 mpg </strong> (-0.70)和<strong class="la jk">汽车长度</strong> (0.68)表现出相对较强的相关性。因此，在本例中，我们将选择这 7 项作为我们的培训功能。</p></blockquote><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/2758e033bd9ab3b64df38227e106a86d.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*Wf7o6d3tTX7UQ6Zl-s7Zjw.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">特征测向和目标系列的形状</p></figure><blockquote class="oc od oe"><p id="946d" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">现在，我们将研究我们的模型。但在此之前，首先让我们再一次观察目标的特征图。</p></blockquote><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oj"><img src="../Images/2f85652982e4e5aaab27fc69c1341e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ccn5sKIY8A_iDgOv-sE2xw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">我们的自变量对因变量的图表</p></figure><blockquote class="oc od oe"><p id="ba31" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">如果我们仔细观察图表，我们会注意到特征<strong class="la jk">发动机尺寸</strong>、<strong class="la jk">整备重量</strong>、马力、<strong class="la jk">车长</strong>和<strong class="la jk">车宽</strong>具有类型<strong class="la jk"> y = x2 </strong>的图表。</p><p id="10fb" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">另一方面，<strong class="la jk"> citympg </strong>和<strong class="la jk"> highwaympg </strong>具有类型<strong class="la jk"> y = 1 / x2 </strong>的图形。</p><p id="ac47" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">因此，我们将相应地处理这些特性。</p></blockquote></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="7a1c" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">从头开始构建模型</h1><p id="6b48" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh nm lj lk ll nn ln lo lp no lr ls lt im bi translated">下面给出了我们的多项式回归模型将工作的公式。</p><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ok"><img src="../Images/a1f6cd91200d2f588f778228710cf2a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5v-VrbZgBrPBYFaYbIxHAA.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">根据我们的特征集的多项式回归公式</p></figure><blockquote class="oc od oe"><p id="f34f" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">正如我们所看到的，多项式回归函数可以替换为线性回归函数</p></blockquote><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/ab91a59bc9c55a5c3e5df9afe2d9af96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*qGVPueO7zaFN7vYop4krzg.jpeg"/></div></figure><p id="ab3b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里，</p><ul class=""><li id="68e6" class="mt mu jj la b lb lc le lf lh ne ll nf lp ng lt na nb nc nd bi translated"><strong class="la jk"> ŷ </strong> -目标变量的预测值</li><li id="0c06" class="mt mu jj la b lb nh le ni lh nj ll nk lp nl lt na nb nc nd bi translated"><strong class="la jk"> W </strong> -这是一个(1 x m)矩阵，包含与每个多项式变换的因变量相关的所有权重</li><li id="36db" class="mt mu jj la b lb nh le ni lh nj ll nk lp nl lt na nb nc nd bi translated"><strong class="la jk"> X </strong> -包含所有多项式变换特征变量的矩阵转置</li><li id="a710" class="mt mu jj la b lb nh le ni lh nj ll nk lp nl lt na nb nc nd bi translated"><strong class="la jk"> B </strong> - A (1 x m)矩阵，其中每个元素都是我们函数的偏差值。</li><li id="dfd9" class="mt mu jj la b lb nh le ni lh nj ll nk lp nl lt na nb nc nd bi translated"><strong class="la jk">m</strong>——训练/测试集中的行数</li><li id="b0cf" class="mt mu jj la b lb nh le ni lh nj ll nk lp nl lt na nb nc nd bi translated"><strong class="la jk"> n </strong> -多项式变换特征的数量</li></ul><blockquote class="oc od oe"><p id="63c5" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">现在让我们将特征(Pandas Dataframe 对象)和目标(Pandas Series 对象)转换为张量对象，这样我们就可以用它们来训练 PyTorch 的模型。</p></blockquote><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi om"><img src="../Images/bcdded734bed45ab2458a4b058d6bf7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:426/format:webp/1*BjuYx2WWmmPld44khgAIsQ.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">张量特征 _x2 和特征 _ 1byX2 的大小</p></figure><blockquote class="oc od oe"><p id="2e16" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">现在，对于激活函数类型为<strong class="la jk"> y = x2 </strong>的特征，我们首先创建 x2 特征，然后将其连接到我们的张量对象。</p></blockquote><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi on"><img src="../Images/9f4b12a42de5399d851de57d544eec64.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/format:webp/1*gm2KIEvL8gZqLOccet-5Qg.png"/></div></figure><blockquote class="oc od oe"><p id="05ad" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">现在，对于激活函数类型为<strong class="la jk"> y = 1/x2 </strong>的特征，我们首先创建 1/x2 特征，然后将其连接到我们的张量对象。</p></blockquote><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/89304d7d3ef905bb1c3548c3877bba89.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*QTv60uAEL-OzaoJzlyJduA.png"/></div></figure><blockquote class="oc od oe"><p id="4ab5" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">有了这个，我们已经多项式变换了我们的特征。</p><p id="6d03" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">最后，我们将把所有转换后的特征张量连接成一个单一的张量对象。</p></blockquote><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi op"><img src="../Images/eccaea42ce22cbb3c5171b7582da4b9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*QXMygmS5cZne500a07-FBQ.png"/></div></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="ea23" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">特征缩放</h1><p id="8947" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh nm lj lk ll nn ln lo lp no lr ls lt im bi translated">由于我们将使用随机梯度下降(SGD)算法作为我们模型的优化算法，缩放可以显著改善优化过程和我们模型的性能。</p><p id="a92c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这个项目中，我们将执行最小-最大缩放。最小-最大归一化转换数据，使所有值都在[0，1]之间。</p><p id="badb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最小-最大归一化的数学公式如下:</p><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/17e075934927541a7bdb8380ccb5910b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*KkqNiI3DiFPaYJ2pXQS-yw.jpeg"/></div></figure><p id="0c73" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里，</p><ul class=""><li id="968a" class="mt mu jj la b lb lc le lf lh ne ll nf lp ng lt na nb nc nd bi translated"><strong class="la jk"> X </strong> =观察值</li><li id="6ae4" class="mt mu jj la b lb nh le ni lh nj ll nk lp nl lt na nb nc nd bi translated"><strong class="la jk"> X </strong> min =在列中观察到的最小值</li><li id="0f5f" class="mt mu jj la b lb nh le ni lh nj ll nk lp nl lt na nb nc nd bi translated"><strong class="la jk"> X </strong> max =列中观察到的最大值</li><li id="7248" class="mt mu jj la b lb nh le ni lh nj ll nk lp nl lt na nb nc nd bi translated"><strong class="la jk"> X </strong> <em class="ny">比例值</em> =比例值</li></ul><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="02d9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，让我们对我们的特征集执行最小-最大归一化。</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi or"><img src="../Images/f4a4d3c3d0b209d2c38db7f9de18abee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*DT4ycbJNSWBhw61h_5RBFw.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">所有值都在[0，1]之间的缩放特征集</p></figure><blockquote class="oc od oe"><p id="db19" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">现在，我们将创建一个张量对象，它保存与多项式变换的归一化特征相关联的权重。这些权重是随机生成的，非常小。</p></blockquote><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi os"><img src="../Images/544be605ed763d48fc2784d862cd3fe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2b-tLCUS6BKhsDKVvU723g.png"/></div></div></figure><blockquote class="oc od oe"><p id="4b2d" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">现在，让我们为我们的模型初始化一个随机偏差。</p></blockquote><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/29124ee9217c9e6d68a9a2e2f32e9278.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*iAIeqE6o2B4wI0mXDQKfxQ.png"/></div></figure><blockquote class="oc od oe"><p id="f556" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">最后，将目标数组转换成张量。</p></blockquote><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ou"><img src="../Images/f4bf08e0b5853d913a48a9ebca3dd2cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8upECfuLfQiDIxl5RrjRdg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">目标张量的屏幕截图</p></figure><p id="5ac7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">现在，让我们定义回归函数</strong>。</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">为我们的特征集运行多元回归函数</p></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/2e1f6ddb8e9c0eee42b40711aa68554c.png" data-original-src="https://miro.medium.com/v2/resize:fit:364/format:webp/1*YjALofNX8p1L7yx-m7cpIQ.png"/></div></figure><p id="3f54" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们将定义我们的均方差(<strong class="la jk"> MSE </strong>)函数。MSE 是计算总模型损耗最常用的方法之一。下面给出了 MSE 的计算公式。</p><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/c453e739df93b038b2a0821ccd0c1d41.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*KFsFrFJ5XK55IhdGlh6-_g.png"/></div></figure><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="fea0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在为我们的模型运行 MSE 函数时-</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/10ed0e6daa4d199c6bf141326fcbd036.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*aMHEUjjqOu2d0ivIallOow.png"/></div></figure><blockquote class="oc od oe"><p id="7bd7" class="ky kz ny la b lb lc kk ld le lf kn lg of li lj lk og lm ln lo oh lq lr ls lt im bi translated">正如我们所见，我们的模型目前给出了一个非常大的 MSE。因此，我们需要优化我们的模型权重和偏差，以提高其性能。</p></blockquote></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="2e8a" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">优化模型</h1><p id="3f0f" class="pw-post-body-paragraph ky kz jj la b lb mv kk ld le mw kn lg lh nm lj lk ll nn ln lo lp no lr ls lt im bi translated">为了优化我们的模型，我们将使用随机梯度下降(SGD)算法。下面给出了与 SGD 优化器算法相关的数学。</p><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oy"><img src="../Images/b66ebd69d6181f106268bb54be6f3eec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9tEbAl8Sbcg9GGjKLS82xA.jpeg"/></div></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oy"><img src="../Images/15aecca1e7f6525776e4ae5a51eae8fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_04bBSwYP7pqh4-AGDDLag.jpeg"/></div></div></figure><p id="5b16" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有关 SGD 的更多信息，请访问<a class="ae jg" href="https://medium.com/bayshore-intelligence-solutions/why-is-stochastic-gradient-descent-2c17baf016de" rel="noopener">此</a>链接。</p><p id="937d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在我们的模型中，我们将使用 PyTorch 内置的梯度计算函数来计算和更新权重和偏差。</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="eb28" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">完成所有这些后，我们将最终为我们的模型运行优化器函数。</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi gj"><img src="../Images/41da1d1c2d3665360ef4525645fc190c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4nkZHPr7nTciBPfpOf7FrQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">通过为我们的模型运行优化器函数获得的结果</p></figure><p id="ecf4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，为了检查我们模型的准确性，我们将计算它的 r 平方得分。以下是 r2 得分的公式-</p><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/a60e6d5350378cea7e8076dbe759ac56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*NXyeK4m9Nstj-aZr390cMg.png"/></div></figure><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="1139" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，让我们检查模型的性能。我们将使用通过优化函数获得的更新模型和权重。</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/5c0251b733395054d23005704b54d02b.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*uyG0sCsdarNZHyIszK447Q.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">我们模型的 r 平方分数</p></figure><p id="e27a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如我们所见，我们的多项式回归模型可以解释因变量约 83–84%的方差。这是一个相当有效的模型。</p><p id="4a93" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里需要注意的一点是，我们在同一个数据集上执行了训练和测试，这是一种糟糕的做法。相反，您应该将数据集分为测试集和训练集。然而，在这个例子中，当从头开始创建模型时，我跳过了这一步，以使事情简单易懂。</p><p id="cb0d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在项目的最后，让我们为模型的所有多项式变换特征绘制回归图。</p><figure class="np nq nr ns gt iv"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="np nq nr ns gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pb"><img src="../Images/d1a04d3dbb29382a8ebc67bd14ffeca0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UVSjYxFx_AnVAn6SHlF7dw.png"/></div></div></figure><p id="0088" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从上面的图表中，我们可以看到我们的模型表现得相当好。</p><p id="9a0e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这样，我们的项目就结束了。更多像这样有趣的项目，请查看<a class="ae jg" href="https://medium.com/@amansharma2910" rel="noopener">我的简介</a>。</p><p id="7b40" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我只是机器学习和数据科学领域的新手，所以任何建议和批评都将真正帮助我提高。</p><p id="363a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">点击以下链接，继续关注更多 ML 内容！</p><p id="102c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">数据集和 Jupyter 笔记本的 GitHub repo 链接- </strong></p><div class="is it gp gr iu pc"><a href="https://github.com/amansharma2910/PolynomialRegression_from_scratch_using_PyTorch" rel="noopener  ugc nofollow" target="_blank"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd jk gy z fp ph fr fs pi fu fw ji bi translated">aman Sharma 2910/多项式回归 _ 从头开始 _ 使用 _PyTorch</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">repo 包含我的项目的 Jupyter 笔记本，在那里我从头开始创建了一个多项式回归模型，使用…</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">github.com</p></div></div><div class="pl l"><div class="pm l pn po pp pl pq ja pc"/></div></div></a></div></div></div>    
</body>
</html>