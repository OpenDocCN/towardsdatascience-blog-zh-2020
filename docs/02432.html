<html>
<head>
<title>Modeling the spread of diseases</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模拟疾病的传播</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/modeling-the-spread-of-diseases-821fc728990f?source=collection_archive---------16-----------------------#2020-03-08">https://towardsdatascience.com/modeling-the-spread-of-diseases-821fc728990f?source=collection_archive---------16-----------------------#2020-03-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ec06" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">SIR 模型的模拟练习</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/70aa44e21bf5b6d0113f391942299298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HGXWeOtnVlQkSHIuuhsIkw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">约翰·西米托普洛斯在<a class="ae ky" href="https://unsplash.com/s/photos/people?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="7a63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些天，关于新冠肺炎病毒传播的新闻占据了所有报纸的专栏，所以我尝试了一个关于这个主题的简单建模练习。</p><p id="2fec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">在继续之前，我需要说两点。第一点很明显:本文仅供参考，不提供任何医疗建议，也不能替代专业医疗。第二个是，作为我的习惯，我选择使用手绘公式，因为我发现在介质上使用乳胶相当烦人。我提前为书法道歉。</em></p><p id="2c82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在流行病学中，有一个数学技术家族，称为<strong class="lb iu">房室模型</strong>，用于传染病的<a class="ae ky" href="https://en.wikipedia.org/wiki/Mathematical_modelling_of_infectious_disease" rel="noopener ugc nofollow" target="_blank">建模。顾名思义，在这些模型中，种群被分成不同的组，并假设在相同区间中的个体具有相同的特征。</a></p><p id="0f36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们来考虑一下<strong class="lb iu"> SIR </strong> <strong class="lb iu">型号</strong>，这是最简单的一种。在这个模型中，种群被分成三组:易感个体，<strong class="lb iu"> S，</strong>感染个体，<strong class="lb iu"> I </strong>，以及<strong class="lb iu"> R </strong>。应该注意的是，这里的术语“康复的”表示可能已经痊愈并产生免疫力的个体，或者可能已经死亡的个体，但是在任何情况下，他们都不能再被感染。</p><h1 id="242a" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">假设</h1><p id="50cb" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">SIR 模型依赖于几个重要的假设。</p><ul class=""><li id="8bf3" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">首先，没有人加入易感群体，因为我们忽略了出生和移民，我们假设人们只能被感染一次。因此，个体离开易感群体的唯一途径就是被感染。同样，受感染的个体最终只能进入康复组。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/04e0966d711796bf66df1048a16cbc37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cBLqYzh7V2tx2m6xs0rZkA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">隔间之间的流动</p></figure><ul class=""><li id="0162" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">第二，人口中的所有个体都具有相同的患病概率，并且他们的年龄分布均匀地分布在<strong class="lb iu"> 0 </strong>和<strong class="lb iu">预期寿命<em class="lv"> L </em> </strong> <em class="lv"> </em>之间(这种假设尤其对发达国家是合理的)。</li><li id="8f2d" class="mt mu it lb b lc nd lf ne li nf lm ng lq nh lu my mz na nb bi translated">第三，群体的<em class="lv">同质混合</em>:个体与群体其余部分的接触也遵循均匀分布，即个体不是更小群体的一部分。由于通常存在的社会结构，这种假设不太合理，但有必要使模型易于处理。</li></ul></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="d09d" class="lw lx it bd ly lz np mb mc md nq mf mg jz nr ka mi kc ns kd mk kf nt kg mm mn bi translated">基本定义</h1><p id="e1f6" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">在定义模型之前，我们需要引入两个基本的流行病学量:</p><ul class=""><li id="7085" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated"><strong class="lb iu">感染率<em class="lv"> β </em> </strong>，即单位时间内单个(被感染)个体感染的人数。这个量与单位时间内的接触次数(假定不变)和疾病传播的概率有关；</li><li id="c894" class="mt mu it lb b lc nd lf ne li nf lm ng lq nh lu my mz na nb bi translated"><strong class="lb iu">痊愈/死亡率𝛾 </strong>，是单位时间内痊愈的感染者的平均比率。例如，如果一次感染的持续时间<strong class="lb iu"><em class="lv">【D】</em></strong><em class="lv"/>为 10 天，那么从统计数据来看，当前感染人群的<em class="lv"> 1/10 </em>每天都会康复。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/d857807db1f34f77910c8ac578f1ec42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j8xCKL5ttJZfgx801oRPLw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">恢复速度和疾病持续时间</p></figure><p id="f268" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感染率和恢复率之间的比率给了我们另一个基本的衡量标准，即<strong class="lb iu">r₀的基本再生数</strong>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/213c9d77360422890ef43212bef90f6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hl-uKRmlKytH4bSbGPQxhg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">基本复制数</p></figure><p id="ae8c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">基本生殖数代表疾病的<strong class="lb iu">生殖比率</strong>，是易感个体群体中一个受感染个体直接产生的预期病例数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/4653b7dd716965227c1956241291fcb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*--GnWkri6MUMUcupy-XJtw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">每个被感染的个体预计会感染另外两个个体</p></figure><p id="60c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果估计准确的话，这是一个非常重要的数字，因为它区分了自熄性疾病(<strong class="lb iu"> R₀ &lt; 1 </strong>)、地方性疾病(<strong class="lb iu"> R₀=1 </strong>)和流行病(<strong class="lb iu"> R₀ &gt; 1 </strong>)。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="1e36" class="lw lx it bd ly lz np mb mc md nq mf mg jz nr ka mi kc ns kd mk kf nt kg mm mn bi translated">模型</h1><p id="42b1" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">为了开始建模，让我们定义一组变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/55d404d7fbdefcc04cd18c94d482faa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T9yvbWXEsLX7bX7Mu0DEhQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">模型的变量</p></figure><p id="783c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">给定模型假设，以下等式成立:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/770619840aa40615ec7babb5d02a4b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*esELZcVBECHIkw8s8CWyOQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">平衡方程式</p></figure><p id="491e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了推广该模型并简化计算，我们将从现在开始考虑每一组相对于总体的分数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/8363b435dfb8cfe4d2254b74eaee5958.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iGg7-R2afUmJFzrS5iVTJQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">三类人口的比例</p></figure></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="17e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">给定上述假设，这些量应该如何随时间变化？</p><p id="3273" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">随着人们感染这种疾病，易感者的数量会减少，所以这种变化肯定是负面的。单个(被感染)个体在单位时间内感染<em class="lv"> β </em> <strong class="lb iu"> <em class="lv"> </em> </strong>【易感】个体，则单位时间内感染者的总分数等于:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/fe1fa5439842cc7b103b9576cf504bcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QPYfMBNW4yny9xUmv1E7SQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">单位时间内受感染个体的比例</p></figure><p id="91f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，如果一部分𝛾感染的个体在单位时间内康复，则在单位时间内康复的个体的总比例为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/763d4475e25a5521ac9950b33fc73415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2To6X14g0NCqGv9MA56yVQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">单位时间内恢复个体的分数</p></figure></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="3d3f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，使用正确的符号，我们可以写出模型的微分方程:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/e87806ee21554305db23a25d65404a3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6E81P48Op6WWjmAbYAazJA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">模型方程</p></figure><p id="6db7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它们反映了模型的假设:没有人会再次变得易感，易感者会被感染，所有被感染的个体最终会康复(或死亡)，没有其他选择。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h1 id="79af" class="lw lx it bd ly lz np mb mc md nq mf mg jz nr ka mi kc ns kd mk kf nt kg mm mn bi translated">模拟</h1><p id="b489" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">运行模型的时间到了。迄今为止，我一直在努力寻找新冠肺炎病毒的已知参数。根据[1]，恢复的中位时间约为 2 周，因此<strong class="lb iu"> <em class="lv"> β=1/14 </em> </strong> <em class="lv">。</em>另一个来源【2】估计基本再生数为<strong class="lb iu"> <em class="lv"> R₀=2.28 </em> </strong>，由此我们可以推断出<strong class="lb iu"> <em class="lv"> 𝛾=0.16 </em> </strong>。最后，尽管有些说法与此相反，但最被接受的假设仍然是，一个人一旦被感染，就会获得对病毒的免疫力。</p><p id="9afa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了整合模型的方程，我使用了 scipy 的<a class="ae ky" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html" rel="noopener ugc nofollow" target="_blank"><em class="lv">odeint</em></a><em class="lv"/>函数。顺便说一句，[3]为编写 SIR 模型提供了一个很好的例子。我假设最初的感染人数等于 0.1%(T21)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/7171b8673021085630df6fdfbc46883c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*Mi9BiO7qT5kk0ljodh2YUA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">新冠肺炎的 SIR 模型</p></figure><p id="e1ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据这个模型，在没有任何干预来控制传播的情况下，病毒将在大约 180 天内被消灭，挽救不到 20%的人口。</p><p id="ca0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">SIR 模型当然是一个非常简单的模型，不适合塑造复杂的动态，尤其是那些涉及大量不同人群的动态。尽管如此，它仍然适用于小规模同质人群，在这些人群中，更容易尊重模型背后的假设(例如，疫情发生在游轮<a class="ae ky" href="https://en.wikipedia.org/wiki/2020_coronavirus_outbreak_on_cruise_ships#Diamond_Princess" rel="noopener ugc nofollow" target="_blank">钻石公主号</a>上)。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="85e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当局下令采取的措施如何遏制病毒的传播？最近在一些欧洲地区实施的隔离和检疫措施显然是为了尽可能地限制感染的可能性。在我们的模型中，这反映在因子<em class="lv"> β的突然降低。</em></p><p id="a02a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设这些措施:</p><ul class=""><li id="9223" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">使新的<em class="lv">ββ₂=β/3</em>(也许没有这么大的减少)，并且</li><li id="cb84" class="mt mu it lb b lc nd lf ne li nf lm ng lq nh lu my mz na nb bi translated">在第 50 天施用，即在感染人数达到高峰之前，</li></ul><p id="f288" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">会出现以下情况:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/1e2c141887ab74cefa89822d7fa85302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*dNQvlwpo2MTEC3QsgBy1-Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">减少模型的<em class="oe"> β</em></p></figure><p id="1e6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">事实上，通过迅速反应，大幅降低β因子，感染人数立即减少，从而趋近于零。</p></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><h2 id="4664" class="of lx it bd ly og oh dn mc oi oj dp mg li ok ol mi lm om on mk lq oo op mm oq bi translated">参考</h2><p id="b7e3" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">[1]<a class="ae ky" href="https://ourworldindata.org/coronavirus" rel="noopener ugc nofollow" target="_blank">https://ourworldindata.org/coronavirus</a></p><p id="c1ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[2]<a class="ae ky" href="http://www.cidrap.umn.edu/news-perspective/2020/02/study-72000-covid-19-patients-finds-23-death-rate" rel="noopener ugc nofollow" target="_blank">http://www . cid rap . umn . edu/news-perspective/2020/02/study-72000-新冠肺炎-病人-发现-23-死亡率</a></p><p id="4314" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">[3]<a class="ae ky" href="https://scipython.com/book/chapter-8-scipy/additional-examples/the-sir-epidemic-model/" rel="noopener ugc nofollow" target="_blank">https://scipython . com/book/chapter-8-scipy/additional-examples/the-sir-epidemic-model/</a></p></div></div>    
</body>
</html>