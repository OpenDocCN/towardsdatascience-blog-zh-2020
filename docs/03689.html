<html>
<head>
<title>Do you know this Flower? Image Classifier using PyTorch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你认识这朵花吗？使用PyTorch的图像分类器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/do-you-know-this-flower-image-classifier-using-pytorch-1d45c3a3df1c?source=collection_archive---------50-----------------------#2020-04-06">https://towardsdatascience.com/do-you-know-this-flower-image-classifier-using-pytorch-1d45c3a3df1c?source=collection_archive---------50-----------------------#2020-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4771" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Udacity数据科学家纳米学位计划项目</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4de24600a7b2844d2dda234a0e457dca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RNl52CXcJrtq1SPLFEqt9w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Oenothera_speciosa" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Oenothera_speciosa</a></p></figure><p id="c2b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个项目是数据科学家纳米学位项目<a class="ae ky" href="https://eu.udacity.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> Udacity </strong> </a> <strong class="lb iu">的一部分:图像分类器项目</strong>，目标是应用深度学习技术来训练图像分类器，以识别不同的花卉品种</p><p id="eb07" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们从使用<strong class="lb iu"> CRISP-DM流程</strong>(数据挖掘的跨行业流程)开始:</p><ol class=""><li id="018d" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated"><strong class="lb iu">业务理解</strong></li><li id="d40c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">数据理解</strong></li><li id="54d5" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">准备数据</strong></li><li id="1b0e" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">数据建模</strong></li><li id="83e1" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">评估结果</strong></li><li id="3a87" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated"><strong class="lb iu">部署</strong></li></ol><p id="5cd3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">业务理解</strong></p><p id="3315" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图像分类是当今非常常见的任务，它包括将图像和一些类别作为输入，并输出输入图像属于一个或多个给定类别的概率。关于这一点，我想推荐安妮·邦纳的这个令人敬畏的故事。总之，这个项目的目标是建立一个应用程序，可以对任何一组标记图像进行训练，以对给定的输入进行预测。由<a class="ae ky" href="https://eu.udacity.com/" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu">uda city</strong></a><strong class="lb iu"/>提供的具体数据集是关于花的</p><p id="c299" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">数据理解</strong></p><p id="f9da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该数据集包含属于102个不同类别的花的图像。这些图像是通过搜索网页和拍照获得的。这些图像具有很大的比例、姿态和光线变化。此外，有些类别在类别内有很大的差异，还有几个非常相似的类别。更多信息请参见M. Nilsback、A. Zisserman撰写的本文</p><p id="2e87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">准备数据和数据建模</strong></p><p id="d662" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Udacity在json文件<strong class="lb iu"> cat_to_name.json </strong>中提供了图像的标签以及类别名称和标签之间的映射</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/d976257ba919a6dd805dfa6a4b6957b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*2U0z1irqI8_meVzl4yWkdQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">类别名称和标签之间的映射</p></figure><p id="1a6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Udacity还在一个有组织的目录树中提供了所有数据集:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/e5f48c3d9eee926ede3d7745275dee7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:384/format:webp/1*yO8LlmF9oLz3auMkkydLLg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">数据目录树</p></figure><p id="968d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在每个文件夹中，都有一个以类别标签命名的文件夹，我们可以在其中找到图像。该类别的jpeg格式</p><p id="283e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该项目分为多个步骤:</p><ul class=""><li id="4ec4" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ml mb mc md bi translated">加载并预处理图像数据集</li><li id="2794" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ml mb mc md bi translated">在数据集上训练图像分类器</li><li id="29ee" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ml mb mc md bi translated">使用训练好的分类器来预测图像内容</li></ul><p id="5e71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">评估结果</strong></p><p id="bf52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">应用程序使用的默认网络是由牛津大学的K. Simonyan和A. Zisserman在论文“V<a class="ae ky" href="https://arxiv.org/pdf/1409.1556.pdf" rel="noopener ugc nofollow" target="_blank">very Deep卷积网络用于大规模图像识别</a>中提出的卷积神经网络模型</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/08c0803190fe308e262c7e1af4d86b66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KHX_nncX0upyO1SJ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://neurohive.io/en/popular-networks/vgg16/" rel="noopener ugc nofollow" target="_blank">https://neurohive.io/en/popular-networks/vgg16/</a></p></figure><p id="9a24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了使用该网络，我们将图像的大小调整为224x224像素，因为cov1层的输入是固定大小的224 x 224 RGB图像。Udacity通过一个Jupyter笔记本为这个项目的开发提供了指导，所以很多步骤都非常简单。为了帮助网络泛化以获得更好的性能，我们将应用随机缩放、裁剪和翻转等变换</p><p id="fba9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您将使用的预训练网络是在ImageNet数据集上训练的，其中每个颜色通道都是单独标准化的。对于所有三组图像，您需要将图像的平均值和标准偏差归一化到网络预期的值。平均值为<code class="fe mm mn mo mp b">[0.485, 0.456, 0.406]</code>，标准偏差为<code class="fe mm mn mo mp b">[0.229, 0.224, 0.225]</code>，从<a class="ae ky" href="http://www.image-net.org/" rel="noopener ugc nofollow" target="_blank"> ImageNet </a>图像中计算得出。这些值将使每个颜色通道以0为中心移动，范围从-1到1</p><p id="4753" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们有了预训练网络，我们必须:</p><ul class=""><li id="2c48" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ml mb mc md bi translated">使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Rectifier_(neural_networks)" rel="noopener ugc nofollow" target="_blank"> ReLU </a>激活和退出，定义一个新的、未经训练的前馈网络作为分类器</li><li id="1baa" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ml mb mc md bi translated">使用预先训练的网络，使用反向传播来训练分类器层，以获得特征</li><li id="8ba7" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ml mb mc md bi translated">跟踪验证集的损失和准确性，以确定最佳超参数</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/b7f46bb20f0f7b7e00291f4bacbd5cac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yala0E5w2YiqZ7li0PnIAw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">网络安装程序</p></figure><p id="5095" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">默认情况下，如果通过勾选<code class="fe mm mn mo mp b">torch.cuda.is_available()</code>GPU可用，则使用GPU完成训练</p><p id="5652" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe mm mn mo mp b">torch.cuda</code>增加了对CUDA张量类型的支持，实现了与CPU张量相同的功能，但是它们利用GPU进行计算。更多信息<a class="ae ky" href="https://pytorch.org/docs/stable/cuda.html" rel="noopener ugc nofollow" target="_blank">点击此处</a></p><p id="63e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用10个时期，我们在训练数据集上获得了0.8944的准确度</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/70f4f0617d4bac2d8b13b2eda0a75cff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*n-bUQEsOlA1iT9Q6O8h-Zg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">培训结果</p></figure><p id="5b58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在验证数据集上，我们获得了0.8563的准确度</p><p id="d35f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">展开</strong></p><p id="c522" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一个<a class="ae ky" href="https://dash.plot.ly/introduction" rel="noopener ugc nofollow" target="_blank">破折号</a>的应用程序已经开发出来作为用户界面:可以上传一张图片进行分类。当没有图像被上传时，应用程序显示关于训练数据集的一些信息的概述</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/3257eeaa38b3366a52f2c1930cfd009b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PdildUJ3Wycx_WV5.JPG"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Dash web应用程序主页</p></figure><p id="239c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当提供一幅图像并按下<strong class="lb iu">分类</strong>按钮时，应用程序显示该图像的分类概率分布，并与相应类别的训练数据集中的图像进行比较</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/31c32da97e165a0fbbaa39e04d5cdaad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*v_dYwx9pwQ1KRYAdhFvUnw.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图像分类</p></figure><p id="afc2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在所示的例子中，我在Google image上搜索了花朵<strong class="lb iu">粉色樱草花</strong>，并将其作为输入来检查我的分类器的输出</p><p id="4060" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以在我的网站上的这个<a class="ae ky" href="http://www.simonerigoni.net/projects/1" rel="noopener ugc nofollow" target="_blank">页面</a>中尝试一下</p><p id="63cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">有趣的事实</strong></p><p id="87ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我尝试对我的个人资料图片进行分类，显然我是一个<strong class="lb iu">剑百合</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/952be4a8dbf155be8f1f6441ac0fad2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*Tisx1k8ohLsy71qqBom32g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我的个人资料图片分类</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/8393f9793ea4d9f4456a64e62b079da8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/0*BsyAocH6bohA1enp.jpg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.gardenia.net/storage/app/public/uploads/images/detail/216420%20Gladiolus%20adrenalinOptimized.jpg" rel="noopener ugc nofollow" target="_blank">https://www . gardenia . net/storage/app/public/uploads/images/detail/216420% 20g ladiolus % 20 adrenaline optimized . jpg</a></p></figure><p id="abad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意:</strong>代码可以在这个github <a class="ae ky" href="https://github.com/simonerigoni/image_classifier_project" rel="noopener ugc nofollow" target="_blank">仓库</a>中找到</p></div></div>    
</body>
</html>