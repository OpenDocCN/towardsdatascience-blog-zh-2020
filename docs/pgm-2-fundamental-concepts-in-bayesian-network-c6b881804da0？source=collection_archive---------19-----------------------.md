# PGM 2:理解贝叶斯网络的基本概念

> 原文：<https://towardsdatascience.com/pgm-2-fundamental-concepts-in-bayesian-network-c6b881804da0?source=collection_archive---------19----------------------->

## PGM 系列的第 2 部分，建立构建贝叶斯网络的概念理解

![](img/50ecbffa397aeb6070a29ea0650631d0.png)

乔尔·菲利普在 [Unsplash](https://unsplash.com/s/photos/building-blocks?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上的照片

这是 PGM 系列的第 2 部分，其中我将介绍以下概念，以便更好地理解贝叶斯网络:

*   从联合分布计算条件概率——归约和归一化
*   排斥
*   结构类型—链式、叉式和碰撞式
*   条件独立性及其意义——d-sep 和马尔可夫毯
*   推理的类型:诊断型、预测型和因果关系型

从[之前关于概率图形模型(PGM)介绍的文章](/introduction-to-probabilistic-graphical-models-7d2c0b4bef19)中，我们了解到图形模型本质上编码了一组随机变量(或者简单地说变量)的联合分布。而联合分布又可以用来计算另外两种分布——边际分布和条件分布。

## **这些分布背后的直觉:**

*   边际概率是单个事件或变量的概率，不参考任何其他变量的任何特定范围的值，例如 P(A)。
*   在大多数现实生活的例子中，有多个过程在起作用。因此，需要对同时发生的事件(如 A、B 和 C)的概率进行研究，以得出推论。它被称为联合概率，用 P (A，B，C)表示
*   给定一个事件 B 发生的先验信息，事件 A 的概率如何变化，用条件概率来度量，记为 P(A|B)。

让我们举一个快速的**现实生活中的例子:**

*   边际概率——在不知道疫情袭击全球的情况下，经济衰退的概率，P(衰退)
*   联合概率——“衰退”和“疫情”同时出现的概率，P(衰退和疫情)
*   条件概率——给定疫情 P(衰退|疫情)的衰退概率。疫情首先出现，导致经济放缓和衰退。因此，在这种情况下，条件概率被解释为——根据疫情的证据，衰退的可能性有多大？

# **使用上一篇文章中的以下示例，从联合分布计算边际分布和条件分布:**

![](img/59ea4d9a3933abfba59a72d452ce0638.png)

前一篇文章中的例子将用来展示边际和条件概率计算

## **条件分布:**

假设上述网络的联合概率数据库如下所示:

![](img/b8495df65a1c7e4df38d38d9d064d9d1.png)

联合概率表

设 C_1 是变量 C 的观测状态，那么给定观测状态 C_1 的变量 A 和 B 的条件分布是通过边缘化观测状态的联合分布来计算的。

从数学上讲，这可以分两步完成，如下所示:

*   **归约:**剔除未观察到状态的行，即本例中的 c0:

![](img/61a6b073a3a91e0a958f751c59ce324a.png)

计算条件分布的简化步骤

请注意,“概率”栏中的数字总和不等于 1，这意味着它不是一个概率分布。因此，作为缩减步骤的结果，我们得到了非归一化的度量。这要求我们的下一步是“重整化”。

*   **重正化:**取剩余行的和，将每个非范数度量除以总和，得到归一化的概率分布。请注意,“Norm”列中的数字现在总计为 1

![](img/9234b02954506b7c0d1199bcd10ead18.png)

重正化

## **边际分布:**

边缘化是指在一个单一变量或一组较大变量的一个子集上产生一个分布的过程，而不涉及一组观察到的变量。

为了计算 A 和 B 上的联合分布，我们将 C 的所有状态上的 P (A，B，C)边缘化:

![](img/7f49971b74203429ccb8f6f53c739194.png)

排斥

# **常见网络结构:**

用医疗保健领域的例子(基于作者的个人直觉)说明网络结构。

年龄(A)、糖尿病(D)、高胆固醇(C)和葡萄糖(G)等变量如何与心脏病(H)相关联？括号中提到的变量符号主要用于书写结构的联合分布表达式。

基于领域/经验知识，让我们尝试从医生的角度进行推理，并思考他如何将年龄知识与糖尿病概况联系起来——在没有任何其他信息的情况下，可以安全地假设随着年龄的增长，患糖尿病的可能性很高。

这种关联由从年龄到糖尿病的边缘来表示，其中年龄是糖尿病的因果因素，并且这两个变量彼此直接相关。

请注意，在下面的结构中，观察到的节点是灰色阴影。

让我们进一步理解常见的网络结构类型:

1.  **连锁:**高葡萄糖含量可导致个体患上糖尿病。这表现为从葡萄糖到糖尿病的边缘，它们之间有直接的联系。此外，如果糖尿病患者更有可能患心脏病，那么这两者之间就有一个优势。

代表高葡萄糖导致糖尿病的链结构显示如下，高葡萄糖反过来会导致更高的心脏病风险:

![](img/bfd0d1fd0fe5e1eed3f6e91993722585.png)

链子

我们可以将联合概率分布写成:

P (G，D，H) = P(H|D) * P(D|G) * P(G)

链式结构进一步细分为两类——1)因果结构和 2)证据结构。

上面举例说明了因果链结构。因果链和证据链结构的区别主要源于突出因果关系的箭头方向。

因果结构是自上而下的，也就是说，它从原因开始，通过对链式结构中跟随它的变量的影响。然而，证据结构说，给定证据，我们可以推断出它的原因，即它是一个自下而上的关系。

**踪迹:**如果 P 被定义为从葡萄糖到心脏病的踪迹，那么了解糖尿病就告诉了我们关于心脏病病因的一切。因此，如果已知 D，知道葡萄糖%并不能为发现心脏病的原因提供任何额外的信息。因此，在这种结构中，葡萄糖与糖尿病引起的心脏病无关。

> **另一种解释这种结构和 Trail 概念的方式:**如果我们意识到一个人的健康状况存在糖尿病状态，那么它就解释掉了关于心脏病风险的一切，从而阻断了在没有糖尿病信息的情况下“葡萄糖”状态可能有助于心脏病的信息流。

**经验法则:**路径中观察到的任何节点都会阻碍信息流，使连接变量相互独立。

理解一个变量的证据的影响如何使两个(相关的)变量独立是至关重要的。这将有助于理解 d-sep 和 Markov blanket 的概念。

2.碰撞器/共同效应:如果我们知道一个人有高胆固醇，那么仅仅这个知识并不能告诉我们一个人患糖尿病的可能性。因此，这两个变量是独立的，因为一个变量不共享另一个变量的任何信息。

然而，当它们与心脏病相关联时，如下面的结构所示，这表明在观察心脏病的常见影响时，胆固醇分享了关于其糖尿病概况的信息。

> 因此，我们从这个结构中得出的结论是，在我们观察到共同的影响(即心脏病)之前，这两个原因是相互独立的。这一事件导致胆固醇和糖尿病这两个变量之间的某种关系的发展，使它们相互依赖。

![](img/77cd290352ad756239e2499c78755284.png)

共同效应

联合概率分布写如下:

P (C，D，H) = P (H|C，D) * P(D) * P(C)

**Trail:** 观察心脏病或其任何后代(从心脏病出现并与另一个变量相连的边缘)引出了两种常见效应之间的依赖性，而缺乏心脏病知识使胆固醇和糖尿病彼此独立。

达芙妮·柯勒教授解释的水阀例子很好地将这个概念内化了。我非常鼓励她在 Coursera 主持的 PGM 专业化课程中深入研究这些概念。

> 我们的例子中的水阀类比如下:观察心脏病(或它的后代)打开了通道，允许从糖尿病到胆固醇的信息流动，带出依赖关系。

3. **Fork/Common Cause:** 一般来说，糖尿病和心脏病有很强的相关性，但是如果我们引入可变年龄，那么我们就是在断言，给定一个人的年龄，在一个人的糖尿病状态和心脏病风险之间没有进一步的关系。**简单地说，年龄这个隐藏变量解释了所有观察到的糖尿病和心脏病之间的相关性。**

也就是说，如果老年人更容易患糖尿病和心脏病，那么年龄就成为这两种影响的共同原因，如下图所示:

![](img/a2eba10ffd8ddfb813c89112e49d1703.png)

共同事业

联合概率分布写如下:

P (A，D，H) = P(H|A) * P(D|A) * P(A)

**线索:**让我们遵循同样的水阀类比，来理解这个倒 V 型共因结构中的信息流。

如果我们观察年龄，它会阻止糖尿病和心脏病这两个变量之间的信息流，使它们相互独立。相反，对可变年龄一无所知会打开渠道，让信息流动。这使得变量是相关的。

# 条件独立性及其意义——d-sep 和马尔可夫毯

两个变量在第三个变量存在的情况下变得相互独立的条件依赖现象被称为 **d-sep** 。

根据[定义](https://en.wikipedia.org/wiki/Bayesian_network)，

如果两个节点 u 和 v 之间的所有轨迹都是 d-分隔的，则它们被 Z d-分隔。如果 u 和 v 不是 d 分隔的，则它们是 d 连接的。

> d-sep 的概念使我们更容易理解另一个关键概念——Markov Blanket:变量的一个子集，它包含了对正在讨论的变量进行推断所需的所有有用信息(例如下图中的 A)。换句话说，它涉及所有必要的变量，没有这些变量，我们就没有足够的信息来计算节点的分布。

![](img/bd98440099cbde1e46d0352f79aba714.png)

作者加:[https://en.wikipedia.org/wiki/Markov_blanket](https://en.wikipedia.org/wiki/Markov_blanket)

但是为什么条件独立或对 d-sep 和 Markov blanket 的研究在贝叶斯网络的研究中具有如此重要的意义？

嗯，那是因为网络对多个互相连接的节点的联合分布进行了编码。

> 使用条件独立性假设:“给定其父节点，每个变量有条件地独立于其非子节点”，计算联合分布的参数数量急剧减少，从而降低了计算复杂度(因为条件独立性仅考虑父节点，而忽略其他一切)。

好了，我们现在可以利用条件独立性的概念来模拟贝叶斯网络中的依赖关系，但是要达到什么目的呢？我们能用贝叶斯网络做什么样的推理？

1) **诊断推理:**诊断是一个向后看的过程。它通过深入研究数据、分析数据和识别模式，告诉你过去为什么会发生一些事情。相当于找到了某个事件背后的根本原因。

让我们根据上面的共同效应网络来理解它，其中高胆固醇和糖尿病都预示着心脏处于更高的风险中。我们诊断病人心脏病状态背后的原因。

因此，我们观察到的成为证据，我们寻求推理或推断的变量成为查询变量。在这种情况下，心脏病是证据，糖尿病和胆固醇是查询变量。

我们可以从这样的网络中得出以下推论:

*   **P(D1 | h1):**考虑到患者有心脏病，患糖尿病的概率
*   **P(C1 | h1):**考虑到患者有心脏病，胆固醇偏高的可能性

**2)** **预后推理:**预后是一个前瞻性的过程。这类似于机器学习算法通常所做的，即给定历史数据和关联；它对未来做出预测**。**

假设一个病人患有糖尿病和高胆固醇(证据)，病人携带心脏病的概率是多少(查询)。

从这样的网络中可以得出以下推论:

*   P(h1 | D1):糖尿病患者患心脏病的概率
*   P(H_1|D_1，C_1): 如果一个人同时患有糖尿病和高胆固醇，那么他患心脏病的可能性

**3)** **因果推理:**

它不同于上面讨论的两个原因，因为它涉及两个原因之间的信息流。

一旦有证据表明患者具有无心脏病的高胆固醇家族史(F ),则与高胆固醇引起的心脏病相比，患者患由糖尿病引起的心脏病的可能性急剧增加。

最初，这两个原因是独立的，但随着新变量“家族史”的证据，解释了证据的原因，一个原因“糖尿病”的概率急剧增加，并分享了另一个变量“高胆固醇”不是患者心脏病主要原因的概率。

![](img/d46dc190e1476831cdf4eb78eae22210.png)

因果推理

就这样，我们到了本文的结尾。图形网络的概念通常被认为是困难的。我试图用简单的术语解释贝叶斯网络的基础，同时保留概念的本质。

我的召唤来自 Coursera 的 [PGM 专业化。](https://www.coursera.org/specializations/probabilistic-graphical-models)

希望这篇文章能成为你的召唤，激励你去学习更多关于图形网络的知识，以释放它们的力量。

请继续关注下一篇文章，我们将构建贝叶斯网络，学习参数并进行推理，以更好地理解我们的数据。

一如既往，快乐读书，快乐学习！！！

参考资料:

[http://www-Prima . imag . fr/Prima/home pages/jlc/Courses/2016/ensi 2。SIRR/ENSI2。SIRR.S13.pdf](http://www-prima.imag.fr/Prima/Homepages/jlc/Courses/2016/ENSI2.SIRR/ENSI2.SIRR.S13.pdf)

[https://www . coursera . org/specializations/probability-graphical-models](https://www.coursera.org/specializations/probabilistic-graphical-models)