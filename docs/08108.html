<html>
<head>
<title>Colab on steroids: free GPU instances with SSH access and Visual Studio Code Server</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">类固醇上的Colab:带SSH访问和Visual Studio代码服务器的免费GPU实例</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/colab-free-gpu-ssh-visual-studio-code-server-36fe1d3c5243?source=collection_archive---------17-----------------------#2020-06-15">https://towardsdatascience.com/colab-free-gpu-ssh-visual-studio-code-server-36fe1d3c5243?source=collection_archive---------17-----------------------#2020-06-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e80a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一步一步地引导SSH进入Google Colab提供的免费GPU实例，并安装Visual Studio Code Server。</h2></div><p id="7819" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如你们大多数人已经知道的，谷歌研究提供了免费的Jupyter笔记本环境实例，带有T2图形处理器和TPU，完全在云中运行。该平台名为<a class="ae le" href="https://colab.research.google.com/notebooks/intro.ipynb" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu"/></a>(简称“Colab”)，当你想进行快速实验或构建新的机器学习模型时，它是一个很好的资源，因为不需要设置:你需要的只是一个浏览器！</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/a66fb34820749972875a02f0ee8d9f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2vycxjoWZizxIzpkL4eOyg.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图片作者。与GPU的Colab会话</p></figure><p id="bdce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，当事情变得棘手时，一个简单的Jupyter笔记本界面可能会相当有限:我们可能需要有一个<strong class="kk iu"> SSH </strong>会话！我们开始吧！</p><h2 id="0f3b" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">第一步。从ngrok获取令牌</h2><p id="98d2" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">在<a class="ae le" href="https://ngrok.com/" rel="noopener ugc nofollow" target="_blank"> ngrok </a>上免费注册，从左侧的认证设置中获取一个Authtoken。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi mt"><img src="../Images/8d50add5aa7e9c269692adaa5d4868ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6vDwf90lfkTji8LSQsLUiA.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图片作者。从ngrok获取免费令牌。</p></figure><h2 id="ea4d" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">第二步。在Colab上安装并运行ngrok</h2><p id="9a94" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">在Colab的一个笔记本单元格内，复制并粘贴下面的代码，插入来自ngrok的令牌并运行单元格。</p><pre class="lg lh li lj gt mu mv mw mx aw my bi"><span id="0907" class="lv lw it mv b gy mz na l nb nc"># Install useful stuff<br/>! apt install --yes ssh screen nano htop ranger git &gt; /dev/null</span><span id="53c4" class="lv lw it mv b gy nd na l nb nc"># SSH setting<br/>! echo "root:carbonara" | chpasswd<br/>! echo "PasswordAuthentication yes" &gt; /etc/ssh/sshd_config<br/>! echo "PermitUserEnvironment yes" &gt;&gt; /etc/ssh/sshd_config<br/>! echo "PermitRootLogin yes" &gt;&gt; /etc/ssh/sshd_config<br/>! service ssh restart &gt; /dev/null</span><span id="62e5" class="lv lw it mv b gy nd na l nb nc"># Download ngrok<br/>! wget -q -c -nc <a class="ae le" href="https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip" rel="noopener ugc nofollow" target="_blank">https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip</a><br/>! unzip -qq -n ngrok-stable-linux-amd64.zip</span><span id="9fe0" class="lv lw it mv b gy nd na l nb nc"># Run ngrok<br/>authtoken = "PUT_YOUR_TOKEN_HERE"<br/>get_ipython().system_raw('./ngrok authtoken $authtoken &amp;&amp; ./ngrok tcp 22 &amp;')<br/>! sleep 3</span><span id="aee9" class="lv lw it mv b gy nd na l nb nc"># Get the address for SSH<br/>import requests<br/>from re import sub<br/>r = requests.get('<a class="ae le" href="http://localhost:4040/api/tunnels'" rel="noopener ugc nofollow" target="_blank">http://localhost:4040/api/tunnels'</a>)<br/>str_ssh = r.json()['tunnels'][0]['public_url']<br/>str_ssh = sub("tcp://", "", str_ssh)<br/>str_ssh = sub(":", " -p ", str_ssh)<br/>str_ssh = "ssh root@" + str_ssh<br/>print(str_ssh)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ne"><img src="../Images/06cc13b9fdff7febb877a853f7963e2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sgx1hmPVhMKZt8fTxIVvhw.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图片作者。用ngrok在Colab中启动一个SSH会话。</p></figure><p id="66f9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为输出，您应该会收到如下内容(地址和端口可能不同):</p><pre class="lg lh li lj gt mu mv mw mx aw my bi"><span id="53fb" class="lv lw it mv b gy mz na l nb nc">ssh <a class="ae le" href="mailto:root@0.tcp.ngrok.io" rel="noopener ugc nofollow" target="_blank">root@0.tcp.ngrok.io</a> -p 14407</span></pre><p id="29d4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将它复制并粘贴到您喜欢的终端模拟器中，当需要密码时插入<strong class="kk iu"> carbonara </strong>并享受您的SSH会话！当然，你可以随心所欲地修改密码！</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/ceffed19ea0d850d7de53724d85ec3c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*3k2ySIabvdgzqEKOQink2A.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图片作者。SSH会话:在Colab实例内部</p></figure><p id="6214" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不习惯Linux命令行？查看这篇文章:<a class="ae le" rel="noopener" target="_blank" href="/linux-console-commands-data-scientist-566744ef1fb0">每个数据科学家都应该知道的基本Linux控制台命令</a>。</p><h2 id="531e" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">第三步。运行Visual Studio代码服务器</h2><p id="3b4c" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">SSH很好，但是直接在浏览器中拥有一个完整的代码编辑器更好！现在让我们看看如何在Colab实例中安装<strong class="kk iu"> Visual Studio代码</strong>。</p><p id="2f3f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们需要安装我们的Google Drive。</p><pre class="lg lh li lj gt mu mv mw mx aw my bi"><span id="b710" class="lv lw it mv b gy mz na l nb nc"># Mount Google Drive and make some folders for vscode<br/>from google.colab import drive<br/>drive.mount('/googledrive')<br/>! mkdir -p /googledrive/My\ Drive/colabdrive<br/>! mkdir -p /googledrive/My\ Drive/colabdrive/root/.local/share/code-server<br/>! ln -s /googledrive/My\ Drive/colabdrive /<br/>! ln -s /googledrive/My\ Drive/colabdrive/root/.local/share/code-server /root/.local/share/</span></pre><p id="240c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">系统将提示您通过插入在第二个页面上生成的令牌来授权访问。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ng"><img src="../Images/2c5ecc9ec3f491e1e38a6e2e88657c33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c4wg2l0Tvc_HdE1Zj3R2-g.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图片作者。在Colab上安装Google Drive</p></figure><p id="dcff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让我们下载、安装并运行Visual Studio代码的服务器版本。</p><pre class="lg lh li lj gt mu mv mw mx aw my bi"><span id="8654" class="lv lw it mv b gy mz na l nb nc">! curl -fsSL <a class="ae le" href="https://code-server.dev/install.sh" rel="noopener ugc nofollow" target="_blank">https://code-server.dev/install.sh</a> | sh &gt; /dev/null<br/>! code-server --bind-addr 127.0.0.1:9999 --auth none &amp;</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nh"><img src="../Images/4fa5f015a4399e08d8dc67881bccc1f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z21yNtIs8U_iCgLoBIXTOg.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图片作者。在Colab上下载并安装Visual Studio代码服务器</p></figure><p id="abbc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们用端口转发启动另一个SSH会话(用您的地址和端口替换ngrok地址和端口):</p><pre class="lg lh li lj gt mu mv mw mx aw my bi"><span id="2111" class="lv lw it mv b gy mz na l nb nc">ssh -L 9999:localhost:9999 <a class="ae le" href="mailto:root@0.tcp.ngrok.io" rel="noopener ugc nofollow" target="_blank">root@0.tcp.ngrok.io</a> -p 14407</span></pre><p id="3a23" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后在<a class="ae le" href="http://127.0.0.1:9999" rel="noopener ugc nofollow" target="_blank">打开浏览器http://127.0.0.1:9999 </a></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/d044e504989083fac575bbac72e16bfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SdaD1l98mXDepmjMm3U9Fg.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图片作者。运行在Colab上的Visual Studio代码服务器</p></figure><p id="03db" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于我们之前已经安装了Google Drive，设置、Visual Studio代码的扩展和项目文件(如果保存在/colabdrive下)将通过会话保持不变。</p><p id="1a35" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">享受Colab中的Visual Studio代码！</p><h2 id="d5e1" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">参考</h2><ul class=""><li id="19a0" class="ni nj it kk b kl mo ko mp kr nk kv nl kz nm ld nn no np nq bi translated"><a class="ae le" href="https://gist.github.com/yashkumaratri/204755a85977586cebbb58dc971496da" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/yashkumaratri/204755 a 85977586 cebb 58 DC 971496 da</a></li><li id="357e" class="ni nj it kk b kl nr ko ns kr nt kv nu kz nv ld nn no np nq bi translated"><a class="ae le" href="https://stackoverflow.com/questions/48459804/how-can-i-ssh-to-google-colaboratory-vm" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/48459804/how-can-I-ssh-to-Google-co laboratory-VM</a></li><li id="5b9e" class="ni nj it kk b kl nr ko ns kr nt kv nu kz nv ld nn no np nq bi translated"><a class="ae le" href="https://medium.com/@meet_patel/how-to-ssh-into-google-colab-and-run-scripts-from-terminal-instead-of-jupyter-notebook-3931f2674258" rel="noopener">https://medium . com/@ meet _ Patel/how-to-ssh-into-Google-colab-and-run-scripts-from-terminal-notebook-3931 f 2674258</a></li></ul></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><p id="bd12" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">联系人:<a class="ae le" href="https://www.linkedin.com/in/shuyiyang/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a> | <a class="ae le" href="https://twitter.com/deltarule" rel="noopener ugc nofollow" target="_blank"> Twitter </a></p></div></div>    
</body>
</html>