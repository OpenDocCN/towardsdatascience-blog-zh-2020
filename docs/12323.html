<html>
<head>
<title>Ball tracking in volleyball with OpenCV and Tensorflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 OpenCV 和 Tensorflow 实现排球中的球跟踪</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7?source=collection_archive---------11-----------------------#2020-08-25">https://towardsdatascience.com/ball-tracking-in-volleyball-with-opencv-and-tensorflow-3d6e857bd2e7?source=collection_archive---------11-----------------------#2020-08-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7f0d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">运动技术中的计算机视觉和神经网络</h2></div><h2 id="6d31" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">介绍</h2><p id="c705" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">在<a class="ae lx" rel="noopener" target="_blank" href="/squats-detector-with-opencv-and-tensorflow-ce934f19aeb9">第一次在运动中应用 AI 的经历</a>之后，我受到了继续下去的启发。家庭练习看起来是一个无关紧要的目标，我的目标是团队合作。</p><p id="ffc8" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">人工智能在体育领域是一个相当新的事物。有几个有趣的作品:</p><ul class=""><li id="b7f5" class="md me it lg b lh ly lk lz kr mf kv mg kz mh lw mi mj mk ml bi translated"><a class="ae lx" href="https://dev.to/stephan007/open-source-sports-video-analysis-using-maching-learning-2ag4" rel="noopener ugc nofollow" target="_blank">篮球</a></li><li id="9084" class="md me it lg b lh mm lk mn kr mo kv mp kz mq lw mi mj mk ml bi translated"><a class="ae lx" href="https://www.researchgate.net/publication/329740964_Convolutional_Neural_Networks_Based_Ball_Detection_in_Tennis_Games" rel="noopener ugc nofollow" target="_blank">网球</a></li><li id="e8b4" class="md me it lg b lh mm lk mn kr mo kv mp kz mq lw mi mj mk ml bi translated"><a class="ae lx" href="https://www.tugraz.at/institute/icg/research/team-bischof/lrs/downloads/vb14/" rel="noopener ugc nofollow" target="_blank">排球</a></li></ul><p id="0bb4" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">我是个打排球的大粉丝，那就说说最后一个参考吧。这是一个分析当地业余联赛的奥地利机构的网站。<br/>有些文档需要阅读，更重要的是——打开视频数据集。</p><p id="61bf" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">排球是一项复杂的运动，有许多不同的方面。所以我从一个小但非常重要的东西开始——球。</p><p id="7f8b" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">跟踪球是一项非常著名的任务。谷歌给出了很多链接，但其中许多只是一个演示。显然，在摄像机前识别和跟踪颜色不同的大球无法与真实游戏球检测相比，真实游戏球检测中的球很小，移动很快，并融入背景中。</p><p id="5bec" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">最后，我们想得到这样的东西:</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mr"><img src="../Images/45e58db22737642b67a7f73a8963a230.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TiextFf2znWP-498kOHyoA.jpeg"/></div></div></figure><p id="ed4e" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">开始之前，让我们注意一下视频数据集的一些细节:</p><ul class=""><li id="7268" class="md me it lg b lh ly lk lz kr mf kv mg kz mh lw mi mj mk ml bi translated">摄像机是静态的，位于球场后面</li><li id="8871" class="md me it lg b lh mm lk mn kr mo kv mp kz mq lw mi mj mk ml bi translated">技术水平允许自由看球(职业选手击球太狠，没有电视回放几乎不可能看球)</li><li id="17a7" class="md me it lg b lh mm lk mn kr mo kv mp kz mq lw mi mj mk ml bi translated">不幸的是，球的颜色，蓝色和黄色，与地面没有太大的对比。这使得所有基于颜色的方法变得毫无意义</li></ul><h2 id="31de" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">解决办法</h2><p id="709a" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">到目前为止，最明显的方法——用颜色——不起作用，我用了一个事实，球在移动。然后让我们找到移动的物体并捡球，听起来很容易。</p><p id="8583" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">OpenCV 包含检测移动物体和背景移除的工具:</p><pre class="ms mt mu mv gt nd ne nf ng aw nh bi"><span id="7140" class="ki kj it ne b gy ni nj l nk nl">mask = backSub.apply(frame)     <br/>mask = cv.dilate(mask, None)     <br/>mask = cv.GaussianBlur(mask, (15, 15),0)     <br/>ret,mask = cv.threshold(mask,0,255,cv.THRESH_BINARY | cv.THRESH_OTSU)</span></pre><p id="2438" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">还有这样的图片:</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mr"><img src="../Images/7fa489bdd20d5ce2d254af68b55f203a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*V00SvVlk_k551q_V.jpeg"/></div></div></figure><p id="c516" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">转化为:</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mr"><img src="../Images/a83da556438ab2b5180cea5c8e0eba4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*q9X_fzk_--gJgJci.jpeg"/></div></div></figure><p id="abfe" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">在这个例子中，球在顶部，人的大脑和眼睛可以很容易地发现它。我们是怎么决定的？从这幅图中可以推断出一些规律:</p><ul class=""><li id="3d50" class="md me it lg b lh ly lk lz kr mf kv mg kz mh lw mi mj mk ml bi translated">这个球是一团</li><li id="dfb9" class="md me it lg b lh mm lk mn kr mo kv mp kz mq lw mi mj mk ml bi translated">这是图片上最高的斑点</li></ul><p id="46b5" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">第二条规则不太管用。例如，在这张图片中，最高的斑点是裁判的肩膀。</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mr"><img src="../Images/74405175497fe63ba0db48016ceaa6f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8z_z1OZIVzosJlXf.jpeg"/></div></div></figure><p id="80de" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">但是最高斑点方法为进一步的步骤提供了初始数据。</p><p id="9c84" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">我们可以收集这些斑点，并训练一个分类器来区分球。</p><p id="3e6b" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">这个数据集看起来像这样:</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nm"><img src="../Images/96c4c2b854a7a81f262748fd6f8235a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pBc23IRPEAmWDFSc.jpeg"/></div></div></figure><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nm"><img src="../Images/61ce6e265b379a1b2d55d1c84ae20a9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0J6sWPFKXlEr90Qe.jpeg"/></div></div></figure><p id="6578" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">在人工智能方面——它是彩色图像的二进制分类，非常类似于<a class="ae lx" href="https://www.kaggle.com/c/dogs-vs-cats" rel="noopener ugc nofollow" target="_blank">猫对狗挑战</a>。</p><p id="501a" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">有许多方法可以实现，但最流行的方法是用<a class="ae lx" href="https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html" rel="noopener ugc nofollow" target="_blank"> VGG 神经网络</a>。</p><p id="6518" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">一个问题-球图片非常小，多个卷积层不适合在那里。所以我不得不把 VGG 切割成一个非常简单的建筑:</p><pre class="ms mt mu mv gt nd ne nf ng aw nh bi"><span id="c560" class="ki kj it ne b gy ni nj l nk nl">model = Sequential([</span><span id="c689" class="ki kj it ne b gy nn nj l nk nl">Convolution2D(32,(3,3), activation='relu',       input_shape=input_shape),         MaxPooling2D(),            Convolution2D(64,(3,3), activation='relu'),         <br/> MaxPooling2D(),         <br/>Flatten(),         <br/>Dense(64, activation='relu'),         <br/>Dropout(0.1),         <br/>Dense(2, activation='softmax')       <br/>])<br/>     <br/>model.compile(loss="categorical_crossentropy",   optimizer=SGD(lr=0.01), metrics=["accuracy"])</span></pre><p id="fa61" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">这个模型很简单，产生的结果一般:大约 20%的假阳性和大约 30%的假阴性。<br/>这当然比什么都没有强，但还不够。</p><p id="dc2a" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">应用于游戏的模型产生许多假球:</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mr"><img src="../Images/1338222f74eaa93fb9bba6cdfe9cfb1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OYQ1WRHQuM3EYqdr.jpeg"/></div></div></figure><p id="bfcf" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">实际上有两种假球:</p><ul class=""><li id="05e4" class="md me it lg b lh ly lk lz kr mf kv mg kz mh lw mi mj mk ml bi translated">他们在随机的时间出现在随机的地方</li><li id="6ed6" class="md me it lg b lh mm lk mn kr mo kv mp kz mq lw mi mj mk ml bi translated">这个模型总是犯错误，把别的东西当成球</li></ul><h2 id="373e" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">轨道</h2><p id="138c" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated">作为下一步，有一个想法，球不是随机运动，而是遵循抛物线或直线轨迹。</p><p id="b3bb" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">对该几何图形上的斑点运动的验证将切断随机和一致的错误。</p><p id="9928" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">有一个在一场球赛中记录轨迹的例子:</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mr"><img src="../Images/eb685b3ed40126ebe6986a79526837bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Pymf1SBvISfkJJdE.jpeg"/></div></div></figure><p id="8cd7" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">其中定向路径用蓝色表示，静态路径用绿色表示，随机路径用灰色表示。</p><p id="9be6" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">只有蓝色的轨迹才有趣。它们至少由 3 个点组成，并且有一个方向。方向非常重要，因为如果下一个点在实际流中丢失并且没有检测到新的路径，则可以预测下一个点。</p><p id="1c7c" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated">应用于片段的这一逻辑生成了非常逼真的跟踪:</p><figure class="ms mt mu mv gt mw gh gi paragraph-image"><div class="gh gi no"><img src="../Images/4d576046d3367d6dd66a47e18a099f7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*VRB3qRjCPSQF16-R.gif"/></div></figure><h2 id="3b42" class="ki kj it bd kk kl km dn kn ko kp dp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">链接</h2><p id="0e65" class="pw-post-body-paragraph le lf it lg b lh li ju lj lk ll jx lm kr ln lo lp kv lq lr ls kz lt lu lv lw im bi translated"><a class="ae lx" href="https://github.com/tprlab/vball" rel="noopener ugc nofollow" target="_blank"> Github 回购</a></p><p id="764e" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated"><a class="ae lx" href="https://www.tugraz.at/institute/icg/research/team-bischof/lrs/downloads/vb14/" rel="noopener ugc nofollow" target="_blank">视频源</a></p><p id="2f66" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated"><a class="ae lx" href="https://files.icg.tugraz.at/f/d5668bbb4a/?raw=1" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">利用时空上下文改进体育活动识别</strong> </a> <br/>乔治·瓦尔特纳、托马斯·毛特纳和霍斯特·比朔夫<br/>在<em class="np"> Proc。DVS-体育领域计算机科学会议(DVS/GSSS)，2014 年</em></p><p id="36bc" class="pw-post-body-paragraph le lf it lg b lh ly ju lj lk lz jx lm kr ma lo lp kv mb lr ls kz mc lu lv lw im bi translated"><a class="ae lx" href="https://files.icg.tugraz.at/f/43f43cbc00/?raw=1" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu">自动化体育游戏分析的室内活动检测与识别</strong> </a> <br/>乔治·瓦尔特纳、托马斯·毛特纳和霍斯特·比朔夫<br/>在<em class="np"> Proc。奥地利模式识别协会(AAPR/OAGM)研讨会，2014 年</em></p></div></div>    
</body>
</html>