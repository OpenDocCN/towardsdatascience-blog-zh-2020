<html>
<head>
<title>How to code different types of moving averages in Python.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 Python 编写不同类型的移动平均线？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-code-different-types-of-moving-averages-in-python-4f8ed6d2416f?source=collection_archive---------15-----------------------#2020-07-21">https://towardsdatascience.com/how-to-code-different-types-of-moving-averages-in-python-4f8ed6d2416f?source=collection_archive---------15-----------------------#2020-07-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="40fc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用 Python 编写不同类型的移动平均线。</h2></div><p id="9308" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">交易软件带有不同类型的移动平均线，已经预先安装并准备好了。但是理解如何计算这些移动平均线是很有趣的，以便在回测潜在策略时能够使用它们。</p><p id="e74e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在 Python  的<strong class="kk iu"> <em class="le">新技术指标成功后，我刚刚出版了一本新书。它对复杂的交易策略进行了更完整的描述和补充，Github 页面致力于不断更新代码。如果你对此感兴趣，请随时访问下面的链接，或者如果你喜欢购买 PDF 版本，你可以在 Linkedin 上联系我。</em></strong></p><div class="lf lg gp gr lh li"><a href="https://www.amazon.com/gp/product/B09919GQ22/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=B09919GQ22&amp;linkCode=as2&amp;tag=sofien-20&amp;linkId=bc5df3f6ab0f3af2df79641c56b949ba" rel="noopener  ugc nofollow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">交易策略之书</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">亚马逊网站:交易策略之书(9798532885707): Kaabar，Sofien:书籍</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">www.amazon.com</p></div></div><div class="lr l"><div class="ls l lt lu lv lr lw lx li"/></div></div></a></div><p id="2d82" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想要一个自己动手的方法，那么下面的肯定会让你感兴趣。所需要的只是 SPYDER 这样的 python 解释器。不同的“已知”移动平均线类型有:</p><ul class=""><li id="b37e" class="ly lz it kk b kl km ko kp kr ma kv mb kz mc ld md me mf mg bi translated"><strong class="kk iu"> <em class="le">简单移动平均线。</em> </strong></li><li id="570f" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated"><strong class="kk iu">T9】指数移动平均线。T11】</strong></li><li id="79d7" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated"><strong class="kk iu"> <em class="le">平滑移动平均线。</em>T15】</strong></li><li id="a1dc" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi translated"><strong class="kk iu"> <em class="le">线性加权移动平均线。</em>T19】</strong></li></ul><p id="c509" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将逐一介绍，定义，编码，并绘制图表。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/33e221d0cf58d31a8cc12b63a4a31c7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HdYMdJYuGVNVHb2L_YI9HQ.png"/></div></div><p class="mx my gj gh gi mz na bd b be z dk translated">GBPUSD 每日图表。黑色的是 200 日均线，深红色的是 200 日均线，黄色的是 200 日平滑均线，粉色的是 200 日线性加权均线。</p></figure><h1 id="1610" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">简单移动平均线</h1><p id="a1d6" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">顾名思义，这是一个简单的平均数，在统计学和我们生活中的任何地方都会用到。它就是观察值的总和除以观察次数。</p><p id="ae6c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从数学上来说，它可以写成:</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/8e4d6ba528ecaa0c6edd6d7c9dba33b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*NY8pWGfjc4MA-ciHMo-FgA.png"/></div></figure><p id="2fef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在 python 中，我们可以定义一个计算移动平均值的函数，如下所示:</p><pre class="mn mo mp mq gt nz oa ob oc aw od bi"><span id="f9b8" class="oe nc it oa b gy of og l oh oi">def ma(Data, period, onwhat, where):<br/>    <br/>    for i in range(len(Data)):<br/>            try:<br/>                Data[i, where] = (Data[i - period:i + 1, onwhat].mean())<br/>        <br/>            except IndexError:<br/>                pass<br/>    return Data</span></pre><p id="e10f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该函数采用由<strong class="kk iu">数据</strong>变量表示的数据结构，移动平均周期(20、60、200 等。)由<strong class="kk iu"> period </strong>变量表示，您希望对其应用什么(在 OHLC 数据结构上，选择 3 表示收盘价，因为 python 索引从零开始)由 what 变量表示，<strong class="kk iu"> where </strong>变量是您希望移动平均线列出现的位置。请注意，您必须有一个超过 4 列的数组才能工作，因为它不会自动创建一个新列，而是简单地填充它。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/4e38a4e33a7f2391e5a0faca63045c02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*_t6us_jFFCQAchhKo9Vgvw.png"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">欧元兑美元每日时间跨度，200 天简单移动平均线。</p></figure><h1 id="245a" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">指数移动平均线</h1><p id="3e71" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">与简单的移动平均线给所有的观察值相同的权重相反，指数移动平均线给最近的观察值更多的权重。它比简单的移动平均线对最近的变动反应更大。</p><p id="9eae" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从数学上来说，它可以写成:</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi ok"><img src="../Images/5c4e017bc1d07131a65655f36063e2e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uSF_E3EXu4YH4TnZyEjWkQ.png"/></div></div></figure><p id="a9f6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">平滑因子通常为 2。请注意，如果我们增加平滑因子(也称为 alpha ),那么最近的观测值将具有更大的权重。</p><p id="bc3d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在 python 语言中，我们可以定义一个函数来计算 EMA，如下所示:</p><pre class="mn mo mp mq gt nz oa ob oc aw od bi"><span id="9b65" class="oe nc it oa b gy of og l oh oi">def ema(Data, alpha, window, what, whereSMA, whereEMA):<br/>    <br/>    # alpha is the smoothing factor<br/>    # window is the lookback period<br/>    # what is the column that needs to have its average calculated<br/>    # where is where to put the exponential moving average<br/>    <br/>    alpha = alpha / (window + 1.0)<br/>    beta  = 1 - alpha<br/>    <br/>    # First value is a simple SMA<br/>    Data[window - 1, whereSMA] = np.mean(Data[:window - 1, what])<br/>    <br/>    # Calculating first EMA<br/>    Data[window, whereEMA] = (Data[window, what] * alpha) + (Data[window - 1, whereSMA] * beta)</span><span id="9e2f" class="oe nc it oa b gy ol og l oh oi"># Calculating the rest of EMA<br/>    for i in range(window + 1, len(Data)):<br/>            try:<br/>                Data[i, whereEMA] = (Data[i, what] * alpha) + (Data[i - 1, whereEMA] * beta)<br/>        <br/>            except IndexError:<br/>                pass<br/>    return Data</span></pre><p id="ff36" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该函数是不言自明的，因为它只是复制了上面介绍的 EMA 函数。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/9a0623d9510b03e5df27b44d092049cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*E85P-glAmhdubJ1N2ou7iw.png"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">欧元兑美元每日时间跨度，200 天指数移动平均线。</p></figure><h1 id="7cc1" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">平滑移动平均值</h1><p id="b8f2" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">该移动平均线考虑了总体情况，受近期走势的影响较小。这是我最喜欢的趋势跟踪指标。从数学上来说，简单地将 EMA 函数中的 Days 变量乘以 2 再减去 1 就可以得到。这意味着，要将指数移动平均线转换为平滑移动平均线，我们需要遵循 python 语言中的等式，即将指数移动平均线转换为平滑移动平均线:</p><pre class="mn mo mp mq gt nz oa ob oc aw od bi"><span id="6108" class="oe nc it oa b gy of og l oh oi">smoothed = (exponential * 2) - 1 # From exponential to smoothed</span></pre><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/c670b7137a2ca34be3d277a9754e45f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*eePWaIlvbODARLbK8QBYKQ.png"/></div><p class="mx my gj gh gi mz na bd b be z dk translated">200 天平滑移动平均线的欧元兑美元每日时间范围。</p></figure><h1 id="c00f" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">线性加权移动平均</h1><p id="c8d4" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">这是一个简单的移动平均线，更重视最近的数据。最近的观察值具有最大的权重，并且在它之前的每个观察值具有逐渐减小的权重。直觉上，它比其他移动平均线有更少的滞后，但它也是最少使用的，因此，它在滞后减少方面的收益，失去了受欢迎的程度。</p><p id="ac37" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从数学上来说，它可以写成:</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi om"><img src="../Images/6fe0f26944ba64ee0c366a1f11caa5c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*WXlGuQzjVVM05iT4tsmf6w.png"/></div></figure><p id="efb9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在 python 语言中，我们可以定义一个计算移动平均值的函数，如下所示:</p><pre class="mn mo mp mq gt nz oa ob oc aw od bi"><span id="0b81" class="oe nc it oa b gy of og l oh oi">def lwma(Data, period):</span><span id="0887" class="oe nc it oa b gy ol og l oh oi">    weighted = []</span><span id="32ea" class="oe nc it oa b gy ol og l oh oi">    for i in range(len(Data)):<br/>            try:<br/>                total = np.arange(1, period + 1, 1) # weight matrix<br/>                <br/>                matrix = Data[i - period + 1: i + 1, 3:4]<br/>                matrix = np.ndarray.flatten(matrix)<br/>                matrix = total * matrix # multiplication<br/>                wma = (matrix.sum()) / (total.sum()) # WMA<br/>                weighted = np.append(weighted, wma) # add to array</span><span id="120d" class="oe nc it oa b gy ol og l oh oi">            except ValueError:<br/>                pass</span><span id="2fbd" class="oe nc it oa b gy ol og l oh oi">    return weighted</span></pre><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi on"><img src="../Images/f36336c8d40a06cf950d678f7f8194d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yo18nGQxUOedDno5cCOaMQ.png"/></div></div><p class="mx my gj gh gi mz na bd b be z dk translated">200 天加权移动平均线的欧元兑美元每日时间范围。</p></figure><p id="5057" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基本上，如果我们有一个由两个数字[1，2]组成的数据集，并且我们想要计算一个线性加权平均值，那么我们将执行以下操作:</p><ul class=""><li id="0632" class="ly lz it kk b kl km ko kp kr ma kv mb kz mc ld md me mf mg bi translated">(2 x 2) + (1 x 1) = 5</li><li id="980b" class="ly lz it kk b kl mh ko mi kr mj kv mk kz ml ld md me mf mg bi">5 / 3 = 1.66</li></ul><p id="c061" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这假设数字为 2 的时间序列是最近的观察结果。</p><p id="6349" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你也对更多的技术指标和使用 Python 创建策略感兴趣，那么我关于技术指标的畅销书可能会让你感兴趣:</p><div class="lf lg gp gr lh li"><a href="https://www.amazon.com/gp/product/B08WZL1PNL/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=B08WZL1PNL&amp;linkCode=as2&amp;tag=sofien-20&amp;linkId=e3cb9716bb6a07cf6c8b9fb585412b07" rel="noopener  ugc nofollow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">Python 中的新技术指标</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">亚马逊网站:Python 中的新技术指标(9798711128861): Kaabar，Sofien 先生:书籍</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">www.amazon.com</p></div></div><div class="lr l"><div class="oo l lt lu lv lr lw lx li"/></div></div></a></div><h1 id="7dbd" class="nb nc it bd nd ne nf ng nh ni nj nk nl jz nm ka nn kc no kd np kf nq kg nr ns bi translated">结论</h1><p id="9b5c" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">那么，选哪个呢？这个问题留给交易者的风险状况和她对均线的熟悉程度。一些人更喜欢简单的移动平均线，而另一些人试图通过使用指数和平滑移动平均线的组合来深入研究。找到你最喜欢的一个完全取决于你。我的建议？考虑长期移动平均线。</p><p id="6231" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="le">注来自《走向数据科学》的编辑:</em> </strong> <em class="le">虽然我们允许独立作者根据我们的</em> <a class="ae op" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="le">规则和指导方针</em> </a> <em class="le">发表文章，但我们不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae op" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="le">读者术语</em> </a> <em class="le">。</em></p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi oq"><img src="../Images/de2a23c8937bb16637ed491c20ed882b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TjmQJPFn9vPmW4OTDREtrA.jpeg"/></div></div><p class="mx my gj gh gi mz na bd b be z dk translated"><a class="ae op" href="https://pixabay.com/photos/trading-analysis-forex-chart-643722/" rel="noopener ugc nofollow" target="_blank">https://pix abay . com/photos/trading-analysis-forex-chart-643722/</a></p></figure></div></div>    
</body>
</html>