<html>
<head>
<title>WSDM — KKBox’s Music Recommendation Challenge</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">WSDM——KKBox 的音乐推荐挑战</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/wsdm-kkboxs-music-recommendation-challange-bf15214c6635?source=collection_archive---------33-----------------------#2020-07-17">https://towardsdatascience.com/wsdm-kkboxs-music-recommendation-challange-bf15214c6635?source=collection_archive---------33-----------------------#2020-07-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/54109da5b77ea19dce8a5941a7b3d7c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WLi7emgs5zcigKoi"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">音乐与自然！！莱奥·麦克拉伦(@leiomclaren) 在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="2a33" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">目标:</strong></p><p id="45cb" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这项任务中，我们必须预测用户在一个时间窗口内第一次可观察到的收听事件被触发后重复收听一首歌曲的机会。</p><p id="93c5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">概述:<a class="ae kf" href="https://www.kaggle.com/c/kkbox-music-recommendation-challenge/overview" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/kkbox-music-recommendation-challenge/overview</a></p><p id="e67d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">大纲:</strong></p><ol class=""><li id="ef51" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld lj lk ll lm bi translated">商业问题</li><li id="ad27" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">数据讨论</li><li id="d91c" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">电子设计自动化(Electronic Design Automation)</li><li id="90be" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">特征工程</li><li id="361a" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">数据预处理</li><li id="18c0" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">模型</li><li id="55cb" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">比较</li><li id="8169" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">结论和未来工作</li><li id="3120" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">参考</li></ol></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="aad6" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated"><strong class="ak">简介</strong></h1><blockquote class="mx my mz"><p id="39a0" class="kg kh na ki b kj kk kl km kn ko kp kq nb ks kt ku nc kw kx ky nd la lb lc ld im bi translated">“<strong class="ki iu">音乐是人类意识不到自己在计数而通过计数体验到的快乐”——<strong class="ki iu">莱布尼茨</strong></strong></p></blockquote><p id="69df" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">音乐帮助任何人与你正在做的事情联系起来。它能提升情绪，让思想的浪潮恢复活力。人们每次都喜欢听音乐，无论是通勤时间、工作时间还是专注时间。不同的人有不同的音乐风格。音乐已经为其用户提供了各种平台，如 waves of Victrola、磁带文化、随身听时代、i-pods、FM 收音机以及最新的音乐应用程序，如 Spotify、亚马逊 Prime Music、Deezer、SoundCloud、Gaana 等。</p><p id="538f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">互联网在选择用户喜欢的音乐方面使生活变得容易，但仍然需要算法来向用户推荐喜欢的音乐，而不需要手动选择。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="0901" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated"><strong class="ak"> 1。业务问题和限制:</strong></h1><p id="df26" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">我们的经营宗旨是为用户提供他们喜欢的歌曲！这一建议不需要几个小时，几秒钟就足以预测收听的机会。</p><ul class=""><li id="0226" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld nj lk ll lm bi translated"><strong class="ki iu"> ML 问题公式化</strong></li></ul><p id="0706" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们必须建立模型，通过评估用户和歌曲的给定特征来预测用户是否会重新收听歌曲。我们可以把这个问题转化为分类问题，可以应用各种分类算法。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="e013" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated"><strong class="ak"> 2。资料讨论:</strong></h1><p id="c1f0" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">数据集来源:<a class="ae kf" href="https://www.kaggle.com/c/kkbox-music-recommendation-challenge/data" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/kkbox-music-re commendation-challenge/data</a></p><p id="226e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该问题有 6 个数据文件:</p><p id="97ea" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 1.train.csv </strong>:该文件包括</p><p id="25f8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">user_id (msno)、song_id、source_system_tab(事件被触发的位置)、<br/> source_type(用户首先播放音乐的入口点)、source_screen_name(用户看到的布局的名称)和 target ( 1 表示在用户第一次可观察到的收听事件之后的一个月内有重复的收听事件被触发，否则 target=0)。</p><p id="2b40" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 2。test.csv </strong>:这个文件包括</p><p id="a35a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">user_id (msno)、song_id、source_system_tab(事件被触发的位置)、<br/> source_type(用户首先播放音乐的入口点)和 source_screen_name(用户看到的布局的名称)。</p><p id="c85a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 3。songs.csv: </strong>这个文件有如下特点</p><p id="dadf" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">歌曲 id、歌曲长度、流派 id、艺术家姓名、作曲家、作词人和语言。</p><p id="4fa3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 4。members.csv: </strong>这个文件有 msno (user_id)、city、bd(可能包含离群值)、性别、register_via (register method)、register_init_time (date)和 expiration _ date(date)。</p><p id="61b0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 5。song_extra_info.csv: </strong>该文件具有用于识别歌曲的特征宋立科 id、歌曲名称和<br/> ISRC(国际标准录音代码)。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="03e6" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated"><strong class="ak"> 3。EDA: </strong></h1><p id="98c2" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">让我们探索我们的数据，并了解每个特征的行为与情节。</p><p id="f574" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一、列车特点:</p><div class="nk nl nm nn gt ab cb"><figure class="no ju np nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/57320c6912417d9bd337beb28cf079de.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*kFRiXMyBbkUER7OP3qilvA.png"/></div></figure><figure class="no ju nu nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/23b55dbfddbd1872ba932c8f01fd2abe.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*uwJBizjYj3bKmHiBOOTgGA.png"/></div></figure><figure class="no ju nv nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/b9a61bb7ab4b4ac03a87093009c835cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*AwRbHcolWq3tNvMyA-4TEw.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk nw di nx ny translated">源类型、源系统选项卡和源屏幕名称的计数图</p></figure></div><div class="ab cb"><figure class="no ju nz nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/1d0787dee2003018ccbe5859a1cc1fe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*VcKfxg_wRfxvznkYixvCXg.png"/></div></figure><figure class="no ju oa nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/875e2a29c37da35505083bf8b68bc79d.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*brd1eVJ_d23bQ2KHwdG7zA.png"/></div></figure><figure class="no ju ob nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/9f3385ec9850f279e053eccaedd6b0ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*y5t68kdrEHzzqJPzEkAoLg.png"/></div></figure></div><p id="133e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们有 source_type、source_system_tab 和 source_screen_name 的计数图。从图中我们可以看到，我们所有的特性在特性的每个值中几乎都是平衡的。</p><p id="4277" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">二。歌曲特色:</p><div class="nk nl nm nn gt ab cb"><figure class="no ju oc nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/8a1c6622418a26ef9346924a98d9eabe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*WXuABGWoKivOriXrMmkiYQ.png"/></div></figure><figure class="no ju od nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/628f9fd8ae2ddc04f1377390c0ec8d02.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*uGlp3FfplkmHjqP-g2M0og.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk oe di of ny translated">registered_via 和语言的计数图</p></figure></div><p id="c041" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">歌曲数据中有不同类型的语言，用数字表示。我们可以看到，大多数用户更喜欢听来自'-1 '和' 52 '语言的歌曲。</p><p id="0e88" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">大多数用户更喜欢通过“4”、“7”和“9”方式注册。</p><p id="c468" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">三。成员数据:</p><div class="nk nl nm nn gt ab cb"><figure class="no ju og nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/3edc5f8c865449e9ada9b509bb1a3cdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*G9L48J8m_uXmNEFJkZMrHg.png"/></div></figure><figure class="no ju oh nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/ca4221bb3386e2ef0abb88c07df45b47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*1yFHmrUS13N-6doSaaQrjg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk oi di oj ny translated">注册开始时间和截止日期的 PDF</p></figure></div><p id="beca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从上面的 pdf 我们可以说，在 2012 年之后，人们开始注册自己听音乐，因此他们的有效期也被发现接近 2020 年。</p><div class="nk nl nm nn gt ab cb"><figure class="no ju ok nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/a937712c4f824bce82e9a56dc3f9224b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*RvmP3J4962ASCH6GGH0Xng.png"/></div></figure><figure class="no ju ol nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/39df9a16f52458bd0d5a09a504ef5056.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*0d2HsRTpRSvA9QBkBcEnww.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk om di on ny translated">适合用户年龄的 PDF 和 CDF</p></figure></div><p id="72e1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">嗯！50 岁以下的人说“你好！”听音乐并享受它！！</p><figure class="nk nl nm nn gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oo"><img src="../Images/4a2598b352d4466a0b9ea98b793db9d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*47e3twz3bcmcA2n5G3V9HA.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">缺失值的热图</p></figure><p id="7c8a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以说作曲家、作词家、isrc 特征有更多缺失的价值。</p><figure class="nk nl nm nn gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi op"><img src="../Images/30f67540f28e0cab9bee87f77a09264f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dKg84-f8QPZgL6i5RxAqPg.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">特征树状图</p></figure><p id="5ca6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是特征的树状图。我们可以看到一个 source_system_tab -&gt; source_type，composer -&gt;作词人，语言-&gt; (song_length，artist_name，name)，isrc -&gt; song_year 之间的关联。</p><p id="a2c1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们所知，一些作曲家对某些艺术家、语言、歌词作者有偏见。</p></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="3570" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated"><strong class="ak"> 4。特征工程:</strong></h1><p id="c826" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">到目前为止，我们已经通过计数图和 PDF-CDF 研究了这些数据。让我们放弃那些丢失值超过 25%的特性，开始特性工程。我们还将根据特征填充缺失的值。</p><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">填充缺失值</p></figure><p id="36ad" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据维基百科，<a class="ae kf" href="https://en.wikipedia.org/wiki/Feature_engineering" rel="noopener ugc nofollow" target="_blank"> <strong class="ki iu">特征工程</strong> </a>是利用领域知识通过<a class="ae kf" href="https://en.wikipedia.org/wiki/Data_mining" rel="noopener ugc nofollow" target="_blank">数据挖掘</a>技术从原始数据中提取<a class="ae kf" href="https://en.wikipedia.org/wiki/Feature_(machine_learning)" rel="noopener ugc nofollow" target="_blank">特征</a>的过程。提取的特征有助于提高机器学习算法的性能。</p><ul class=""><li id="bb58" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld nj lk ll lm bi translated">我们将提取独立于成员、歌曲和歌曲 _extra 的个人特征。合并所有文件后，我们将提取按特征分组。</li><li id="4bf0" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld nj lk ll lm bi translated">我们将过滤 0 到 75 岁之间的年龄。</li></ul><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">过滤器年龄</p></figure><ul class=""><li id="4ec8" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld nj lk ll lm bi translated">我们将从到期和初始日期中提取成员资格 _ 天、年、月和日。</li></ul><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">计算日期功能</p></figure><ul class=""><li id="7b4c" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld nj lk ll lm bi translated">我们将从流派 id 和艺术家中提取流派 id 计数、艺术家计数。一些歌曲有许多艺术家和流派，所以我们还将提取第一个艺术家的名字和第一个流派 id。</li></ul><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">计算艺术家特征</p></figure><p id="e50b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下片段是艺术家的特点。</p><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">计算艺术家特征</p></figure><ul class=""><li id="b240" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld nj lk ll lm bi translated">我们将从 isrc 特征中提取<code class="fe os ot ou ov b">song_year</code>、<code class="fe os ot ou ov b">country_code</code>和<code class="fe os ot ou ov b">registration_code</code>。</li></ul><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">计算歌曲特征</p></figure><ul class=""><li id="509b" class="le lf it ki b kj kk kn ko kr lg kv lh kz li ld nj lk ll lm bi translated">就艺术家、语言、流派和年龄组而言，每个人都有自己最喜欢的音乐风格。我们将基于这些来提取 group_by 特征。</li></ul><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">group_by 功能</p></figure><h1 id="e0f3" class="lz ma it bd mb mc ow me mf mg ox mi mj mk oy mm mn mo oz mq mr ms pa mu mv mw bi translated"><strong class="ak"> 5。数据预处理:</strong></h1><p id="94bd" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">从数据文件中提取所有特征后，是时候转换所有这些特征了。我们有数字和分类特征。有标准化、规范化、十进制等技术。我们将使用标准化，因为它通过移除平均值和缩放到单位方差来标准化特征。对于分类特征，我们有一次性编码、标签编码、响应编码等。我们将尝试对我们的分类特征进行标记编码。</p><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">转换数字特征</p></figure><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">编码分类特征</p></figure></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="e728" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated"><strong class="ak"> 6。型号:</strong></h1><p id="c636" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">正如我们先前所述，我们将把这个问题作为一个分类问题提出，我们可以在我们的数据点上应用各种分类算法。所以我们一个一个来试试。我们将在本节的最后讨论每个模型的特性重要性。在比较部分，我们将讨论结果。</p><p id="f434" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 1。逻辑回归</strong></p><p id="e41d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一种简单的分类技术，尽管它的名字中有“回归”这个词。我们将使用带有 log_loss 的<a class="ae kf" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html" rel="noopener ugc nofollow" target="_blank">SGD 分类器</a>。我们将使用<a class="ae kf" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="noopener ugc nofollow" target="_blank"> GridSearchCV </a>调整超参数，如惩罚和 alpha。</p><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">使用 GridSearchCV 调整逻辑回归超参数</p></figure><p id="dd35" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 2。支持向量机</strong></p><p id="5705" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用带铰链损耗的<a class="ae kf" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html" rel="noopener ugc nofollow" target="_blank">SGD 分类器</a>执行线性 SVM，并使用<a class="ae kf" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="noopener ugc nofollow" target="_blank"> GridSearchCV </a>进行超参数调谐。</p><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">使用 GriSeachCV 进行 SVM 超参数调谐</p></figure><p id="1c52" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 3。决策树</strong></p><p id="2a4a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">决策树是一组轴平行的超平面或决策规则，也可以对非线性可分的数据点进行分类。sklearn 提供了<a class="ae kf" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html" rel="noopener ugc nofollow" target="_blank">决策树分类器</a>。我们将调整参数，如<code class="fe os ot ou ov b">max_depth,</code> <code class="fe os ot ou ov b">min_samples_split</code>和<code class="fe os ot ou ov b">max_leaf_nodes.</code></p><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">决策树分类器超参数调整 GridSearchCV</p></figure><p id="9985" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 4。随机森林</strong></p><p id="80fe" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">元估计器在数据集的各种子样本上拟合多个决策树分类器，并使用平均来提高预测精度和控制过拟合。我们将使用<a class="ae kf" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" rel="noopener ugc nofollow" target="_blank"> RandomForestClassifier </a>并使用<a class="ae kf" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.RandomizedSearchCV.html" rel="noopener ugc nofollow" target="_blank">randomsearchv</a>进行超参数调整。</p><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">随机森林及其超参数调谐</p></figure><p id="ef0c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 5。XgBoost </strong></p><p id="bab4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">XgBoost 是一个实现梯度提升决策树的库，它包含决策树作为基础学习器，并试图降低整体偏差。<a class="ae kf" href="https://www.youtube.com/watch?v=8b1JEDvenQU" rel="noopener ugc nofollow" target="_blank">这里的</a>是对 XgBoost 及其背后的深入数学的有用视频解释。</p><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">XgBoost 及其超参数调谐</p></figure><p id="a4d9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">6。LightGBM </p><p id="cae6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">LighGBM 也是一个梯度提升决策树的框架，但是它速度更快，占用内存更少。你可以从<a class="ae kf" href="https://lightgbm.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">这里</a>了解更多。</p><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">LGB 超参数调谐</p></figure><p id="90d0" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 7。堆叠</strong></p><p id="d05a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">堆叠是一种集成技术，其中多个分类器的预测被用作训练元分类器的新特征。我们将使用<a class="ae kf" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.StackingClassifier.html" rel="noopener ugc nofollow" target="_blank">堆叠分类器</a>和决策树，RF 和 GBDT 作为一级分类器，逻辑回归作为元分类器。</p><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">堆积分类器</p></figure><p id="bbc6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 8。投票分类器</strong></p><p id="61a4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">投票分类器是许多分类器的包装器。它将以软或硬的方式为来自基本分类器的预测投票。我们将执行来自 sklearn 的<a class="ae kf" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.VotingClassifier.html" rel="noopener ugc nofollow" target="_blank"> VotingClassifier </a>。</p><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">投票分类器</p></figure><p id="f606" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> 9。深度学习</strong></p><p id="811b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们也将尝试基于深度学习的方法。我们将构建基于 MLP 的架构，该架构将所有特征作为输入，并将基于 sigmoid 概率生成适当的类别标签。我们将使用 Adam 作为优化器，使用二进制交叉熵作为损失函数。</p><figure class="nk nl nm nn gt ju"><div class="bz fp l di"><div class="oq or l"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">MLP 模型与培训</p></figure><p id="37fc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> (a)特征重要性:</strong></p><p id="0691" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了更好地理解任何模型，建议检查特性的重要性。每一个特性都对模型的性能有积极或消极的影响。基于树的算法具有内置的特征重要性，而在 SVM LR 的情况下，我们必须通过<code class="fe os ot ou ov b">model.coef_</code>提取它</p><div class="nk nl nm nn gt ab cb"><figure class="no ju pb nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/7144db073b0a5e72f88a3ee8b00b8030.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/1*dMH174xxIqzccqqygN6oQw.png"/></div></figure><figure class="no ju pc nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/b8d07b27ea7f6c6f162d3eb330ed50a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*OoZDDmBWLstAJazYsuPTAg.png"/></div></figure><figure class="no ju pd nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/29cc1559308fe1d43ffcadf290dd1ec4.png" data-original-src="https://miro.medium.com/v2/resize:fit:670/format:webp/1*ScspsdIFiAzea5p2NDMXOg.png"/></div></figure></div><div class="ab cb"><figure class="no ju pe nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/7bc1c649f025e3f9ef299347a4f6aa5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*zUkizxJmnN7F0h9uSyHBkw.png"/></div></figure><figure class="no ju pf nq nr ns nt paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><img src="../Images/cd587d9d26289195c81e44571e732f72.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*jKoNyJFB140ZtthHPwJecw.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk pg di ph ny translated">特征重要性</p></figure></div><p id="bff2" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu"> (b)特征选择和提取</strong></p><p id="7ef5" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">特征选择意味着选择原始特征池的子集，而特征提取意味着从现有数据中获取有用的特征。我们使用<a class="ae kf" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectKBest.html#sklearn.feature_selection.SelectKBest" rel="noopener ugc nofollow" target="_blank">选择测试</a>进行特征选择，使用<a class="ae kf" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html" rel="noopener ugc nofollow" target="_blank"> PCA </a>进行特征提取。我们还可以从 DT、RF 或 XgBoost 等算法中选择基于特征重要性的特征。我们从 DT 中选择了最重要的特征，并在这些选择的特征上应用了最佳模型。<a class="ae kf" href="https://github.com/khushi810/KKBOX_Music_Recommendation_Challenge/blob/master/Music_Recommendation_models.ipynb" rel="noopener ugc nofollow" target="_blank">这里的</a>是型号和功能重要性的详细记录。</p><h1 id="8e0f" class="lz ma it bd mb mc ow me mf mg ox mi mj mk oy mm mn mo oz mq mr ms pa mu mv mw bi translated"><strong class="ak"> 7。对比:</strong></h1><p id="3644" class="pw-post-body-paragraph kg kh it ki b kj ne kl km kn nf kp kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">在对我们的数据集和特征重要性应用所有模型之后，我们可以说 LR 和 SVM 不太适合我们的数据集。他们还对具体特征给予更多负面的重视。基于树的算法工作得更好，具有更好的特征重要性。当我们使用 LighGBM 时，与其他模型相比，它提供了更高的性能。LightGBM 和 XgBoost 是 Kaggle 社区的热门。特征选择也推动分数。</p><p id="611c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是不同算法的对比表。</p><figure class="nk nl nm nn gt ju gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/7f6685dfc8506ba3f68a831f0baa1c63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*hgkwrVUDbo69U29_5exp2Q.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">比较表</p></figure></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="5441" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated"><strong class="ak"> 8。结论&amp;未来工作:</strong></h1><ul class=""><li id="84e7" class="le lf it ki b kj ne kn nf kr pj kv pk kz pl ld nj lk ll lm bi translated">从上表中，我们可以看到，与其他模型相比，基于 LightGBM 的模型给出了更高的分数。在基于特征提取和选择的模型中，选择最佳模型的特征选择给出了更好的结果。</li><li id="8084" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld nj lk ll lm bi translated">由于资源限制，我只使用了 30%的数据点。如果我们使用所有数据点并进行更多的超参数调整，我们可以获得更好的结果。</li><li id="6e30" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld nj lk ll lm bi translated">深度学习需要大量的数据点。</li><li id="c6c7" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld nj lk ll lm bi translated">我们还可以想到更多的特征提取。</li></ul></div><div class="ab cl ls lt hx lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="im in io ip iq"><h1 id="6580" class="lz ma it bd mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw bi translated"><strong class="ak"> 9。参考文献:</strong></h1><ol class=""><li id="446e" class="le lf it ki b kj ne kn nf kr pj kv pk kz pl ld lj lk ll lm bi translated"><a class="ae kf" href="https://www.kaggle.com/c/kkbox-music-recommendation-challenge/overview" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/c/kkbox-music-recommendation-challenge/overview</a></li><li id="40ed" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><a class="ae kf" href="https://github.com/lystdo/Codes-for-WSDM-CUP-Music-Rec-1st-place-solution" rel="noopener ugc nofollow" target="_blank">https://github . com/lyst do/Codes-for-WSDM 杯-Music-Rec-first-place-solution</a></li><li id="a933" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><a class="ae kf" href="https://www.kaggle.com/asmitavikas/feature-engineered-0-68310" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/asmitavikas/feature-engineered-0-68310</a></li><li id="aefd" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated"><a class="ae kf" href="https://www.kaggle.com/rohandx1996/recommendation-system-with-83-accuracy-lgbm" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/rohandx 1996/re commendation-system-with-83-accuracy-lgbm</a></li><li id="009f" class="le lf it ki b kj ln kn lo kr lp kv lq kz lr ld lj lk ll lm bi translated">【https://www.appliedaicourse.com/course/11/Applied-Machine-】<br/><a class="ae kf" href="https://www.appliedaicourse.com/course/11/Applied-Machine-" rel="noopener ugc nofollow" target="_blank">学习-课程</a></li></ol><p id="e919" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢您的关注。如果你有任何想法，可以留下评论、反馈或任何<br/>建议。</p><p id="35cc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以在我的 Github repo 上找到完整的代码(<a class="ae kf" href="https://github.com/khushi810/KKBOX_Music_Recommendation_Challenge/tree/master" rel="noopener ugc nofollow" target="_blank">这里</a>)。</p><p id="05a4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">很高兴在<a class="ae kf" href="https://www.linkedin.com/in/khushali-vithani/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>:)上与您联系</p></div></div>    
</body>
</html>