<html>
<head>
<title>Know Yourself More from Your WhatsApp Chat History</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从你的WhatsApp聊天记录中了解自己</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/know-yourself-more-from-your-whatsapp-chat-history-8ec4b69c12c5?source=collection_archive---------40-----------------------#2020-03-23">https://towardsdatascience.com/know-yourself-more-from-your-whatsapp-chat-history-8ec4b69c12c5?source=collection_archive---------40-----------------------#2020-03-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9425" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用python对聊天数据进行简单的数据探索以发现新事物</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/965320bce57496e797664b2fd76a7700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xUmcFdHng4KYOF_tZ_mdVQ.png"/></div></div></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><p id="56e5" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">由于新冠肺炎疫情，我被建议在家做远程工作。已经一个星期了，整天呆在家里让我厌烦，所以我随意地想，也许是时候做自我反省了。幸运的是，我记得不久前我导出了我的WhatsApp聊天。所以我一头扎进去，决定做快速的数据探索，以更多地了解我自己和我的对话者。让数据说话。</p><h1 id="95a3" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">数据准备</h1><p id="9900" class="pw-post-body-paragraph lb lc it ld b le mp ju lg lh mq jx lj lk mr lm ln lo ms lq lr ls mt lu lv lw im bi translated">WhatsApp导出的聊天格式为<code class="fe mu mv mw mx b">.txt</code>。消息的每一行都由<code class="fe mu mv mw mx b">&lt;timestamp&gt; — &lt;sender&gt; : &lt;message&gt;</code>组成。在消息有多行的一些情况下，第二行和随后的行将仅用<code class="fe mu mv mw mx b">&lt;message&gt;</code>表示，而没有<code class="fe mu mv mw mx b">&lt;timestamp&gt; — &lt;sender&gt;</code>。结构见下例。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/cef85a2c3e9923745ea7f874e6695e40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TqOdi2XV0it1f4v7GEhtrg.png"/></div></div></figure><p id="2452" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">将数据转换成数据帧让我可以做更多的事情。这个任务的美妙之处在于它需要模式匹配来区分<code class="fe mu mv mw mx b">timestamp</code>、<code class="fe mu mv mw mx b">sender</code>和<code class="fe mu mv mw mx b">message</code>。正则表达式将使工作变得容易得多。我将Python的<code class="fe mu mv mw mx b">re</code>模块与其<code class="fe mu mv mw mx b">f-string</code>字符串格式结合起来，发现这是一个很好的组合，尤其是在更复杂的模式上。下面是我将<code class="fe mu mv mw mx b">.txt</code>文件转换成<code class="fe mu mv mw mx b">dataframe</code>文件的代码。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="7d8e" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">够不够？不。我们可以检索更多的信息来帮助未来的分析。因此，我在下面的代码中做了更多的特性工程，并返回下面的<code class="fe mu mv mw mx b">dataframe</code>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/749f2f05e040f45784a61a55477d69a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z3vZsNvRzfY00y7ptWaFhA.png"/></div></div></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h1 id="9f78" class="lx ly it bd lz ma nd mc md me ne mg mh jz nf ka mj kc ng kd ml kf nh kg mn mo bi translated">探索性数据分析</h1><p id="d847" class="pw-post-body-paragraph lb lc it ld b le mp ju lg lh mq jx lj lk mr lm ln lo ms lq lr ls mt lu lv lw im bi translated">现在数据已经准备好了，让我们从回答几个问题开始</p><h2 id="1316" class="ni ly it bd lz nj nk dn md nl nm dp mh lk nn no mj lo np nq ml ls nr ns mn nt bi translated">1.最活跃的对话发生在什么时候</h2><p id="8720" class="pw-post-body-paragraph lb lc it ld b le mp ju lg lh mq jx lj lk mr lm ln lo ms lq lr ls mt lu lv lw im bi translated">了解聊天行为是必须的。我认为调查谈话发生最多的时间将会很好地描述它。所以，在小时频率中，我取了平均值:</p><ul class=""><li id="20c6" class="nu nv it ld b le lf lh li lk nw lo nx ls ny lw nz oa ob oc bi translated">字数(<code class="fe mu mv mw mx b">word</code>)，</li><li id="29e1" class="nu nv it ld b le od lh oe lk of lo og ls oh lw nz oa ob oc bi translated">字符数(<code class="fe mu mv mw mx b">char</code>)，</li><li id="6ef4" class="nu nv it ld b le od lh oe lk of lo og ls oh lw nz oa ob oc bi translated">被认为是<strong class="ld iu">一个回复</strong> ( <code class="fe mu mv mw mx b">seq</code>)的行的顺序号</li><li id="68d4" class="nu nv it ld b le od lh oe lk of lo og ls oh lw nz oa ob oc bi translated">行数(<code class="fe mu mv mw mx b">seq_line</code>)。</li></ul><p id="8dcb" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">万一你把<code class="fe mu mv mw mx b">seq</code>和<code class="fe mu mv mw mx b">seq_line</code>搞混了，假设A和B之间有一段对话</p><ul class=""><li id="d69c" class="nu nv it ld b le lf lh li lk nw lo nx ls ny lw nz oa ob oc bi translated">A-A-B-B-B将有2个序列和5个<code class="fe mu mv mw mx b">seq_line</code></li><li id="1bb5" class="nu nv it ld b le od lh oe lk of lo og ls oh lw nz oa ob oc bi translated">A-B-A-B将有4个序列和4个<code class="fe mu mv mw mx b">seq_line</code></li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi nb l"/></div></figure><p id="549d" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">从上面的图表中，我至少知道:</p><ul class=""><li id="ba4b" class="nu nv it ld b le lf lh li lk nw lo nx ls ny lw nz oa ob oc bi translated">在工作日，我们倾向于在休息时间(12点)停止聊天，而在周末，则是在下午3点。我能理解为什么我们在工作日的中午停止聊天。现在是休息时间。我吃午饭，快速休息，这让我远离我的手机。但是，我从没想过周末下午3点会那么低。</li><li id="abbc" class="nu nv it ld b le od lh oe lk of lo og ls oh lw nz oa ob oc bi translated">在工作日，seq和seq_line之间的差距在中午变得更小，这意味着在这个时间每个回复包含的行数非常少。总体差距在周末要高得多，这意味着我们经常在周末回复更多的行。</li><li id="a13b" class="nu nv it ld b le od lh oe lk of lo og ls oh lw nz oa ob oc bi translated">如果我们放大到晚上7-10点，即使工作日和周末之间的行数(<code class="fe mu mv mw mx b">seq_line</code>)相对相同，周末的字数(<code class="fe mu mv mw mx b">word</code>)也要高得多。这意味着每一行在周末包含的单词比工作日多。我想这是“故事时间”。如果我必须讨论什么，我想我会在那个时候做。</li></ul><p id="088e" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">我可以说，平均而言，我在下午6点开始积极聊天，每天晚上10-11点达到高峰，直到早上6点才停止聊天。</p><h2 id="2fe3" class="ni ly it bd lz nj nk dn md nl nm dp mh lk nn no mj lo np nq ml ls nr ns mn nt bi translated">2.谁反应更快</h2><p id="6054" class="pw-post-body-paragraph lb lc it ld b le mp ju lg lh mq jx lj lk mr lm ln lo ms lq lr ls mt lu lv lw im bi translated">我想知道，谁回复短信的时间更长。知道谁有反应，谁没有反应是非常重要的。我不想在没有任何证据的情况下，被人笼统地以“你回复晚了”来评判。所以，这又是关键时刻了。</p><p id="f529" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">我计算了甲方和乙方所有文本的平均值。我计算了甲方最后一次聊天和乙方第一次回复之间的差异(反之亦然)，进行了一些数据辩论，结果如下:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi nb l"/></div></figure><p id="f09a" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">看起来甲方和乙方差不多。他们花了大约10分钟回复一条信息。然而，在乙方方面，差异更大，这意味着乙方有更大的机会需要更长的时间来回复。我想我知道乙方是谁了*哎。</p><h2 id="5a86" class="ni ly it bd lz nj nk dn md nl nm dp mh lk nn no mj lo np nq ml ls nr ns mn nt bi translated">3.最快的响应时间是什么时候</h2><p id="b360" class="pw-post-body-paragraph lb lc it ld b le mp ju lg lh mq jx lj lk mr lm ln lo ms lq lr ls mt lu lv lw im bi translated">与前一个问题类似，但现在我想看看最快的反应发生在什么时候。从平均值来看，在工作日(周一至Fri)，甲方和乙方的响应时间分别为凌晨1点和晚上11点。周末，甲方凌晨0点最快，乙方还在晚上11点。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi nb l"/></div></figure><p id="38f6" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">你可以看到甲方和乙方的几个不同的峰值，但我想强调的是，这个事实支持了我之前的说法，即谈话在深夜更激烈。</p><h2 id="55b9" class="ni ly it bd lz nj nk dn md nl nm dp mh lk nn no mj lo np nq ml ls nr ns mn nt bi translated">4.谁写得更长或更快</h2><p id="2118" class="pw-post-body-paragraph lb lc it ld b le mp ju lg lh mq jx lj lk mr lm ln lo ms lq lr ls mt lu lv lw im bi translated">我已经告诉你谁回答得更快了。但是如果用更长时间回复的一方用了更多的词呢？我对每个聚会的文本中使用的行、词和字符进行了简要总结。请注意，文本或回复可以包含多行。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oi nb l"/></div></figure><p id="a63f" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">如果我们仔细观察，就行数而言，乙方回复的行数比甲方多。这可能会导致一个结论，即甲方倾向于用一整行来总结回复，而乙方倾向于用不同的行来发送。</p><p id="2aa7" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">乙方在每次回复中发送的字数和字符数相对低于甲方，这意味着甲方比乙方写得更长。这也得到持续时间变量的支持，其中甲方比乙方写回复的持续时间更长。因此，甲方比乙方写得更长</p><p id="3790" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">在前面的问题中，我们知道乙方需要更长的时间来响应。我假设那是因为B写的比A长，实际上A写的更长。而且B写的甚至比a还快所以B没有借口哈哈。</p><h2 id="92bb" class="ni ly it bd lz nj nk dn md nl nm dp mh lk nn no mj lo np nq ml ls nr ns mn nt bi translated">5.词频</h2><p id="2dfd" class="pw-post-body-paragraph lb lc it ld b le mp ju lg lh mq jx lj lk mr lm ln lo ms lq lr ls mt lu lv lw im bi translated">检查单词数据的一种最流行的方法是使用单词云可视化其词频。</p><p id="8ae8" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">我删除了几个停用词，以去除无意义的常用词。因为我在聊天中使用印度尼西亚语，所以我使用<a class="ae mz" href="https://github.com/onlyphantom/elang" rel="noopener ugc nofollow" target="_blank"> Elang </a>来删除印度尼西亚语的停用词。现在，使用单词云，看看这些单词</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ccd2f026824ec267d3fd285f9e2aed52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5lFz4WdJ25es0OLkKNkiAA.png"/></div></div></figure><p id="4b4d" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">有很多“哈哈”和“wkwk”，印度尼西亚人认为是笑的词。使用正则表达式，我删除了笑的单词，这是最后的单词云。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/965320bce57496e797664b2fd76a7700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xUmcFdHng4KYOF_tZ_mdVQ.png"/></div></div></figure><p id="ff35" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">如果你听不懂的话我很抱歉，这是印尼语，而且多是非正式用语(反正谁在聊天中用正式用语)。</p><h2 id="86fa" class="ni ly it bd lz nj nk dn md nl nm dp mh lk nn no mj lo np nq ml ls nr ns mn nt bi translated">6.我们多久笑一次</h2><p id="35df" class="pw-post-body-paragraph lb lc it ld b le mp ju lg lh mq jx lj lk mr lm ln lo ms lq lr ls mt lu lv lw im bi translated">之前我发现笑的单词占据了我的单词云很多空间。我们笑得那么频繁吗(通过短信)？为了找出答案，我提取了所有笑的单词，并将其数量与行数进行比较，以获得概率。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/495e47af6e05da59825f7ad43d3f6539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xg2HjZ5lRiEWHNuHmOViqw.png"/></div></div></figure><p id="1a98" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">21.7%概率一句台词有笑点？太搞笑了。我没期望那么多。但事实就是如此。也许我在短信里是个有趣的人。我是吗？</p><h1 id="5072" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">摘要</h1><p id="4297" class="pw-post-body-paragraph lb lc it ld b le mp ju lg lh mq jx lj lk mr lm ln lo ms lq lr ls mt lu lv lw im bi translated">我们在深夜进行了一次激烈的谈话，可能是在谈论彼此的经历。我们经常笑。甲方写的很多但是写的时间比较长，乙方写的比较短但是回复的时间比较长。</p><h1 id="5e70" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">未来的工作</h1><p id="b5bb" class="pw-post-body-paragraph lb lc it ld b le mp ju lg lh mq jx lj lk mr lm ln lo ms lq lr ls mt lu lv lw im bi translated">这些数据有许多应用。在未来的工作中，我想对聊天进行情感分析，看看我是否可以使用数据来预测对话的数量，并使用多个对话(多人)进行聚类</p><p id="2d32" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">如果你认为我在这篇文章中遗漏了什么，请在下面留下评论。我也希望听到任何形式的问题/建议。</p><p id="ffd2" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">我的git库上有完整的代码<a class="ae mz" href="https://github.com/iqbalbasyar/whatsapp-chat-analysis" rel="noopener ugc nofollow" target="_blank"/></p><p id="d0b2" class="pw-post-body-paragraph lb lc it ld b le lf ju lg lh li jx lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">谢谢你。</p></div></div>    
</body>
</html>