<html>
<head>
<title>Using Machine Learning to Predict Recessions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习来预测衰退</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/replicating-machine-learning-prediction-of-recessions-yazdani-2020-9b9500131c71?source=collection_archive---------27-----------------------#2020-09-08">https://towardsdatascience.com/replicating-machine-learning-prediction-of-recessions-yazdani-2020-9b9500131c71?source=collection_archive---------27-----------------------#2020-09-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7487" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">复制“衰退的机器学习预测”(亚兹达尼，2020 年)</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5b1801973c23ac9e214e97d18a9bdb60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ozuex3x5t0xiIElp"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">可爱的北极熊在打招呼——在金融市场上，熊通常没那么可爱</p></figure><p id="e551" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">包含所有代码的笔记本可以在<a class="ae kv" href="https://nbviewer.jupyter.org/github/lumalik/recession-replication/blob/master/nbs/recession-repl.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="d1b2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我最近发现了一个关于从经济数据中预测美国衰退的有趣的<a class="ae kv" href="https://fdpinstitute.org/resources/Documents/webinars%20thoughtleadership%20pieces%20etc/Al%20Yazdani%20Webinar%20July%208,%202020.pdf" rel="noopener ugc nofollow" target="_blank">演示</a>。虽然我对这个话题并不完全惊讶，但吸引我眼球的是他们的模型的绝对难以置信的准确性。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/f264a36e229a862a0dccc3a4c441f68f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rF5-SIIrJGips3IXNgXwTg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">最佳模型是 AUC 为 95 %的随机森林！！！</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/62ccf2fd0281fead8093580d3e1a578b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*HMFltmqpsuu_2swv-_15Rg.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">你看那个随机森林的 ROC 曲线！</p></figure><p id="9fa6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们谈论的是曲线下 95 %的区域，完美的灵敏度，和近乎完美的特异性。当然，他们一定犯了错误？文章本身是在付费墙后面的。尽管如此，这种表达提供了足够的信息用于复制。</p><h1 id="c234" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">他们是怎么做到的？</h1><p id="99c2" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">根据陈述，他们使用了非常基本的经济指标(联邦基金利率的差异，失业率等。)以及作为整体市场指标的 SP500(美国 500 家最大公司)月度价格差异。他们有时使用对数差异，因为这些差异更可能遵循正态分布。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/5e1a297b67b6ec720fe3e14fdf18c5f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Ccnna_ij4vlStHl4gBnQQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这些是所使用的预处理步骤和特性</p></figure><p id="ff4c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在他们的研究中，他们使用了 1959 年 1 月至 2019 年 12 月的月度数据。</p><p id="85f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我从哪里获得数据的快速总结:</p><h2 id="9d68" class="ms lv iq bd lw mt mu dn ma mv mw dp me lf mx my mg lj mz na mi ln nb nc mk nd bi translated">Quandl:</h2><ul class=""><li id="c274" class="ne nf iq ky b kz mm lc mn lf ng lj nh ln ni lr nj nk nl nm bi translated">由 GDP 推断的衰退</li><li id="ecf0" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated">联邦基金利率</li><li id="36ba" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated">工业生产指数</li><li id="0ed5" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated">非农工资</li><li id="2e35" class="ne nf iq ky b kz nn lc no lf np lj nq ln nr lr nj nk nl nm bi translated">失业率</li></ul><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="4e1b" class="ms lv iq nt b gy nx ny l nz oa"># you can download the data like this -&gt; might require API key<br/>recession_data = quandl.get("FRED/USRECQP", collapse="monthly") fed_funds_data = quandl.get("FRED/FEDFUNDS", collapse="monthly")<br/>indpro_data = quandl.get("FRED/INDPRO", collapse="monthly")<br/>nonfarm_payroll_data = quandl.get("FRED/PAYEMS", collapse="monthly")<br/>unemploy_data = quandl.get("FRED/UNEMPLOY", collapse="monthly")</span></pre><h2 id="5f0a" class="ms lv iq bd lw mt mu dn ma mv mw dp me lf mx my mg lj mz na mi ln nb nc mk nd bi translated">市场观察</h2><ul class=""><li id="3472" class="ne nf iq ky b kz mm lc mn lf ng lj nh ln ni lr nj nk nl nm bi translated">500 先令</li></ul><h2 id="0e63" class="ms lv iq bd lw mt mu dn ma mv mw dp me lf mx my mg lj mz na mi ln nb nc mk nd bi translated">宏观趋势</h2><ul class=""><li id="289c" class="ne nf iq ky b kz mm lc mn lf ng lj nh ln ni lr nj nk nl nm bi translated">10 年期国债</li></ul><p id="e733" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关于宏观趋势，只有 1962 年开始的数据可用。因此，我将只考虑 1962 年开始的数据。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="4a82" class="ms lv iq nt b gy nx ny l nz oa"># load in merged data <br/>data = pd.read_csv("../data/replication_data.csv", index_col=0)</span><span id="dbed" class="ms lv iq nt b gy ob ny l nz oa"># fill missing recession data<br/>data["recession"] = data["recession"].fillna(method='ffill')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/a32204ab2959a98f883c9a2612fdb5e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7aDGFbF7BHL8ROfk3uFOxQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">这是我们的目标——根据 GDP 推断的衰退</p></figure><h1 id="0e40" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">准备数据</h1><p id="0c4f" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">数据准备非常简单。我们计算对数差和差。此外，我们在测试集上划分序列中的数据，从 1962 年开始，但在其他方面坚持演示中建议的结束日期。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="58d6" class="ms lv iq nt b gy nx ny l nz oa"># calculate logarithmic differences <br/>def log_diff(v): <br/>    log_diff = np.log(v/v.shift(1))<br/>    return log_diff</span><span id="613f" class="ms lv iq nt b gy ob ny l nz oa"># preprocessing <br/>data["slope_yc"] = (data["ty10"] - data["fedfunds"]).diff()<br/>data["fedfunds"] = data["fedfunds"].diff()<br/>data["indpro"] = log_diff(data["indpro"]) <br/>data["nonfarm"] = log_diff(data["nonfarm"])<br/>data["SP500"] = log_diff(data["SP500"])<br/>data["ty10"] = (data["ty10"]).diff()<br/>data["unemploy"] = log_diff(data["unemploy"])<br/>data["recession"] = data["recession"].shift(1)</span></pre><p id="03e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的<strong class="ky ir">列车</strong>周期是从<strong class="ky ir">1962–02 到 2006–12。</strong></p><p id="773e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的<strong class="ky ir">测试</strong>周期为<strong class="ky ir"> 2007 年 1 月至 2019 年 12 月。</strong></p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="25f8" class="ms lv iq nt b gy nx ny l nz oa"># get x and y <br/>X = data.drop(['recession'], axis=1)<br/>y = data["recession"]</span><span id="685b" class="ms lv iq nt b gy ob ny l nz oa"># divide in train test according to paper <br/>X_train, y_train = (X.loc["1962-02-28":"2007-01-01"], y.loc["1962-02-28":"2007-01-01"])<br/>X_test, y_test = (X.loc["2007-01-01":], y.loc["2007-01-01":])</span></pre><h1 id="e335" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">处理阶级不平衡</h1><p id="7b1c" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">鉴于他们文章的完整标题是“衰退的机器学习预测:不平衡的分类方法”——衰退是一个非常罕见的事件，这一事实应该在充分拟合模型的过程中发挥主要作用。</p><p id="5924" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们可能会问自己，这些衰退月份在数据中出现的频率有多高？</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="8c6f" class="ms lv iq nt b gy nx ny l nz oa">print(data["recession"].value_counts())</span><span id="7c8e" class="ms lv iq nt b gy ob ny l nz oa">0.0    612<br/>1.0     83<br/>Name: recession, dtype: int64</span></pre><p id="cc44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">少数民族阶层只占 13.56 %！</p><p id="a144" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么你如何处理阶级不平衡呢？</p><p id="0894" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有两种主要策略:</p><ol class=""><li id="b148" class="ne nf iq ky b kz la lc ld lf od lj oe ln of lr og nk nl nm bi translated"><strong class="ky ir">欠采样</strong>按顺序</li></ol><p id="ba87" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用欠采样，您从多数类中采样样本以匹配少数类。由于演示没有提到使用了哪种方法，我使用了<strong class="ky ir">随机欠采样</strong>。</p><p id="dc87" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.<strong class="ky ir">过采样</strong></p><p id="6e66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过过采样，您可以将数据综合添加到少数类中，以匹配多数类。<strong class="ky ir"> SMOTE </strong>是一种常用的过采样技术。</p><p id="ded9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将对训练数据使用过采样和欠采样来帮助拟合我们的模型，并将它们与原始数据进行比较。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="1e65" class="ms lv iq nt b gy nx ny l nz oa">## Sampling techniques<br/><br/>from imblearn.over_sampling import SMOTE<br/>from imblearn.under_sampling import RandomUnderSampler<br/><br/># oversample using SMOTE <br/>sm = SMOTE(random_state=42)<br/>X_train_smote, y_train_smote = sm.fit_resample(X_train, y_train)<br/><br/># undersample randomly<br/>rus = RandomUnderSampler(random_state=42)<br/>X_train_rnd, y_train_rnd  = rus.fit_resample(X_train, y_train)</span></pre><p id="3c5d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们得到了三组不同的火车。原始训练数据，一个带有 SMOTE 的过采样版本和一个随机欠采样版本。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="7b36" class="ms lv iq nt b gy nx ny l nz oa">train_test_pairs = {"Normal":(X_train, y_train), <br/>                    "SMOTE":(X_train_smote, y_train_smote), <br/>                    "Undersampling":(X_train_rnd, y_train_rnd)}</span></pre><p id="9f49" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于论文标题强调了这样一个事实，即这是一个不平衡数据的问题——幸运的是，衰退是一种罕见的事件——我预计这些抽样方法的得分会有很大不同。</p><h1 id="327d" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">符合我们的模型并进行评估</h1><p id="06de" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">所以让我们比较三种采样方法——拟合一个随机森林，看看性能。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="775f" class="ms lv iq nt b gy nx ny l nz oa">fig = go.Figure()<br/>fig.add_shape(<br/>    type='line', line=dict(dash='dash'),<br/>    x0=0, x1=1, y0=0, y1=1<br/>)<br/><br/>for label, pair in train_test_pairs.items(): <br/>    clf = RandomForestClassifier(max_depth=10, n_estimators=100, class_weight = "balanced_subsample", random_state=0)<br/>    clf.fit(pair[0], pair[1])<br/>    y_pred= clf.predict(X_test) <br/>    fpr, tpr, thresholds = metrics.roc_curve(y_test, clf.predict_proba(X_test)[:,1])<br/>    auc = metrics.roc_auc_score(y_test, clf.predict(X_test))<br/><br/>    name = f"{label} (AUC={auc:.2f})"<br/>    fig.add_trace(go.Scatter(x=fpr, y=tpr, name=name, mode='lines'))<br/><br/>fig.update_layout(<br/>    xaxis_title='False Positive Rate',<br/>    yaxis_title='True Positive Rate',<br/>    yaxis=dict(scaleanchor="x", scaleratio=1),<br/>    xaxis=dict(constrain='domain'),<br/>    width=900, height=700<br/>)<br/>fig.show()</span></pre><p id="97da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="oh">请击鼓……</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/09dcf8fd8439abe7b4921d865bdf6906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i5xCVDlMwv1JjHIW"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">击鼓！<a class="ae kv" href="https://unsplash.com/photos/Dq0ml-Xrf4U" rel="noopener ugc nofollow" target="_blank">照片</a>卢兹·门多萨在 Unsplash 上拍摄</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/49d50a86c034f8b5587c2d02e1f0340b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4_3olWpFrOPFsTJ7nGTCCg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">不同抽样方法的 ROC 曲线</p></figure><p id="bf1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不错！我们可以看到，取样方法对报告的 AUC 分数有很大的影响。欠采样比 SMOTE 执行得更好，本文中也使用了欠采样。总的来说，我认为<strong class="ky ir">复制是成功的— </strong>考虑到我丢失了前三年的数据，并且我没有调优任何超参数。</p><p id="1a2d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么，假设我们能够预测衰退，我们能利用这些信息做什么呢？</p><h1 id="dda9" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">衰退期间你应该把钱投到哪里</h1><p id="bc64" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">我想到了几个策略。为了研究这些策略，我将使用我们的模型中的<strong class="ky ir">预测来拟合训练期。</strong></p><h2 id="bd71" class="ms lv iq bd lw mt mu dn ma mv mw dp me lf mx my mg lj mz na mi ln nb nc mk nd bi translated">1)仅限间谍</h2><p id="d7ce" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">SP500 指数将作为我们的基准，因为它通常被认为是美国市场的良好代表。</p><h2 id="b2c8" class="ms lv iq bd lw mt mu dn ma mv mw dp me lf mx my mg lj mz na mi ln nb nc mk nd bi translated">2)间谍减去衰退</h2><p id="d61a" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">在经济衰退期间，人们可能想减少风险，把钱拿出来放在一边——也许藏在枕头下？</p><h2 id="c67a" class="ms lv iq bd lw mt mu dn ma mv mw dp me lf mx my mg lj mz na mi ln nb nc mk nd bi translated">3)间谍和 GLD</h2><p id="97aa" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">黄金似乎总是一个安全的选择。在衰退期间，人们可能会观察到挤兑。</p><h2 id="935e" class="ms lv iq bd lw mt mu dn ma mv mw dp me lf mx my mg lj mz na mi ln nb nc mk nd bi translated">4)间谍和 VIX</h2><p id="c42d" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">VIX 是根据 SP500 期权计算的波动指数。它通常也被称为恐惧指数，更高的波动性意味着不稳定的时期。</p><p id="2143" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">比较这些交易策略，并使用我们模型的预测，我们得到了以下测试期的图表:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/f4fe3f5806ae4607db4a10f36ec30973.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yYak8xG2HYeYFXNCoTDvOw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">根据测试集上的预测返回不同的策略</p></figure><p id="815a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这一时期的主要衰退是在 2008 年到 2010 年之间。我们看到，与流行的观点相反，投资黄金实际上不是一个好主意。黄金似乎很容易受到市场总体走势的影响。在经济衰退期间将我们的资金撤出市场是好的，但这并没有给我们带来真正的优势。另一方面，对被动投资者来说，投资于<strong class="ky ir">波动指数(VIX) </strong>似乎是真正的游戏规则改变者。随着经济衰退的到来，恐惧和波动增加，利润也增加。</p><h1 id="94ea" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">未来一个月会出现经济衰退吗？</h1><p id="2fd3" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">为了确定是否会出现衰退，我们可以获取更多类似这样的最新数据。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="7dd2" class="ms lv iq nt b gy nx ny l nz oa"># features <br/>fed_funds_data = quandl.get("FRED/FEDFUNDS", collapse="monthly")<br/>indpro_data = quandl.get("FRED/INDPRO", collapse="monthly")<br/>nonfarm_payroll_data = quandl.get("FRED/PAYEMS", collapse="monthly")<br/>unemploy_data = quandl.get("FRED/UNEMPLOY", collapse="monthly")<br/>spy = yf.Ticker("^GSPC").history(period='1d', start='2019-1-1').Close.resample("M").mean()<br/>ty10 = yf.Ticker("^TNX").history(period='1d', start='2019-1-1').Close.resample("M").mean()</span><span id="1518" class="ms lv iq nt b gy ob ny l nz oa"># subsetting recent data  <br/>data = pd.DataFrame()<br/>data["fedfunds"] = fed_funds_data.loc["01-01-2020":].Value<br/>data["nonfarm"] = nonfarm_payroll_data.loc["01-01-2020":].Value<br/>data["indpro"] = indpro_data.loc["01-01-2020":].Value<br/>data["SP500"] = spy.loc["01-01-2020":]<br/>data["ty10"] = ty10.loc["01-01-2020":]<br/>data["unemploy"] = unemploy_data.loc["01-01-2020":].Value<br/><br/># preprocessing <br/>data["slope_yc"] = (data["ty10"] - data["fedfunds"]).diff()<br/>data["fedfunds"] = data["fedfunds"].diff()<br/>data["indpro"] = log_diff(data["indpro"]).fillna(method="ffill") # no recent data<br/>data["nonfarm"] = log_diff(data["nonfarm"])<br/>data["SP500"] = log_diff(data["SP500"])<br/>data["ty10"] = (data["ty10"]).diff()<br/>data["unemploy"] = log_diff(data["unemploy"])</span></pre><p id="8d8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们可以使用我们的模型来估计我们的模型在预测中的置信度。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="003f" class="ms lv iq nt b gy nx ny l nz oa">data.dropna(inplace=True)<br/>data["recession_proba"] = clf.predict_proba(data)[:,1]</span><span id="dc39" class="ms lv iq nt b gy ob ny l nz oa">fig = go.Figure()<br/>fig.add_scatter(x= data.index, y=data["recession_proba"], mode='lines', name="SPY long")<br/>fig.update_layout(title_text="Probabilities of a Recession according to the model")<br/>fig.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/9bd98a0ab2a32aba8b3f368823415d1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RgDAw-Gko8z9RZ_xRMB7oA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">根据我们对训练数据的随机森林拟合，对衰退的信心</p></figure><p id="f54e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">截至 9 月，我们的模型确信未来一个月不会出现衰退。我们可以看到，由于杰罗姆鲍威尔美联储利率的变化以及失业人数的上升，我们实际上在 4 月和 3 月遇到了<strong class="ky ir">更高的信心水平。</strong></p><p id="a2f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你发现任何错误，有任何问题，或者想要合作，请随时在<a class="ae kv" href="http://www.linkedin.com/in/lukas-malik-3b5201b6" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>上联系我。</p><h1 id="38a1" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">参考</h1><p id="c946" class="pw-post-body-paragraph kw kx iq ky b kz mm jr lb lc mn ju le lf mo lh li lj mp ll lm ln mq lp lq lr ij bi translated">亚兹达尼(2020)。衰退的机器学习预测:不平衡分类方法。《金融数据科学杂志》。演示幻灯片检索自:<a class="ae kv" href="https://fdpinstitute.org/resources/Documents/webinars%20thoughtleadership%20pieces%20etc/Al%20Yazdani%20Webinar%20July%208,%202020.pdf" rel="noopener ugc nofollow" target="_blank">https://FDP institute . org/resources/Documents/webinars % 20 thought leadership % 20 pieces % 20 etc/Al % 20 yaz dani % 20 webinar % 20 July % 208，%202020.pdf </a></p></div></div>    
</body>
</html>