<html>
<head>
<title>How to find the optimal value of K in KNN?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何找到KNN K的最优值？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-find-the-optimal-value-of-k-in-knn-35d936e554eb?source=collection_archive---------0-----------------------#2020-05-23">https://towardsdatascience.com/how-to-find-the-optimal-value-of-k-in-knn-35d936e554eb?source=collection_archive---------0-----------------------#2020-05-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0ef4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">可视化误差率与K的关系图，找出最合适的K值。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e64c4c7248cd0189cf153ce2ccb88267.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zuU7qHWKROGUCcSpMB9a8w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图1:通过<a class="ae ky" href="https://www.educba.com/nearest-neighbors-algorithm/" rel="noopener ugc nofollow" target="_blank">educba.com</a>拍摄的照片</p></figure><h2 id="ea5c" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">介绍</h2><p id="3c0c" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated"><strong class="lx iu">K-最近邻</strong>是<strong class="lx iu">T5用于分类和回归的监督机器学习算法。它处理训练数据，并基于距离度量对新的测试数据进行分类。它找到测试数据的k个最近邻，然后由大多数类别标签执行分类。</strong></p><p id="cdaf" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">对于数据科学家来说，选择最佳K值以实现模型的最大准确性始终是一项挑战。我希望你们都知道knn背后的基本思想，但是我将在本文后面阐明KNN的概述。要全面了解这个算法的工作原理，我建议阅读下面的文章:</p><blockquote class="mt mu mv"><p id="6b46" class="lv lw mw lx b ly mo ju ma mb mp jx md mx mq mf mg my mr mi mj mz ms ml mm mn im bi translated"><a class="ae ky" href="https://www.analyticsvidhya.com/blog/2018/03/introduction-k-neighbours-algorithm-clustering/" rel="noopener ugc nofollow" target="_blank">k近邻介绍:强大的机器学习算法</a></p></blockquote><p id="2585" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在本文中，我将演示在knn算法中感知K的理想值的可实现方法。</p><h1 id="d523" class="na la it bd lb nb nc nd le ne nf ng lh jz nh ka ll kc ni kd lp kf nj kg lt nk bi translated">目录</h1><ol class=""><li id="b49e" class="nl nm it lx b ly lz mb mc li nn lm no lq np mn nq nr ns nt bi translated">KNN概况</li><li id="e72a" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn nq nr ns nt bi translated">距离度量</li><li id="4983" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn nq nr ns nt bi translated">如何选择一个K值？</li><li id="693c" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn nq nr ns nt bi translated">KNN模式实施</li><li id="db89" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn nq nr ns nt bi translated">关键要点</li></ol><p id="e830" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我们开始吧，</p><h1 id="f272" class="na la it bd lb nb nc nd le ne nf ng lh jz nh ka ll kc ni kd lp kf nj kg lt nk bi translated">1.KNN概况</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/edc358819adf9a84c33750e5f1b473cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YWKvGH4kKOtCvlX950LM9g.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图2:照片通过<a class="ae ky" href="https://www.kdnuggets.com/2016/01/implementing-your-own-knn-using-python.html" rel="noopener ugc nofollow" target="_blank">kdnuggets.com</a></p></figure><p id="01de" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">使用K-最近邻，我们通过找到测试点和训练的K个最近特征值之间的距离，从可用的类别标签中预测测试点的类别。通过分析所有的信息，你会提出一个问题，</p><h2 id="cca7" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">距离怎么算？</h2><p id="4637" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">让我在距离度量的下一部分回答你的热情问题。</p><h1 id="339c" class="na la it bd lb nb nc nd le ne nf ng lh jz nh ka ll kc ni kd lp kf nj kg lt nk bi translated">2.距离度量</h1><p id="a8b3" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">距离度量是有效的超参数，通过它我们测量数据特征值和新测试输入之间的距离。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/7d364dde788acf689153b4f87c6b622c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lh6R4QArolCRdzF7jjSzDw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图3:通过<a class="ae ky" href="https://slideplayer.com/slide/12735721/" rel="noopener ugc nofollow" target="_blank">slideplayer.com</a>拍摄的照片</p></figure><p id="e819" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">通常，我们使用欧几里得方法，这是最广泛使用的距离度量，用于计算测试样本和训练数据值之间的距离。我们沿着从点(x1，y1)到点(x2，y2)的直线测量距离。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/cf7ed8c01eba6c24f67e9857cc72de3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_i1PCxvSDw5TIfzyq90aag.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图4:照片通过<a class="ae ky" href="https://slideplayer.com/slide/7529915/" rel="noopener ugc nofollow" target="_blank">slideplayer.com</a></p></figure><p id="fa37" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">通过分析上面的计算，我希望你能理解我们是如何计算欧几里德距离的。让我们来解释一下KNN的预测方法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/140ea7a310923df356e1e6337c3c851f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/0*elaSSkBa3Gi9H1-x.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图5:通过<a class="ae ky" href="https://www.datacamp.com/community/tutorials/k-nearest-neighbor-classification-scikit-learn" rel="noopener ugc nofollow" target="_blank">datacamp.com</a>的照片</p></figure><h2 id="9d73" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">要对未知记录进行分类:</h2><ul class=""><li id="eeb3" class="nl nm it lx b ly lz mb mc li nn lm no lq np mn oc nr ns nt bi translated">初始化K值。</li><li id="7b30" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">计算测试输入和K个训练好的最近邻之间的距离。</li><li id="041f" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">检查最近邻的类别，并确定测试输入属于哪种类型。</li><li id="775a" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">将通过获得多数票来进行分类。</li><li id="8d65" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">返回班级类别。</li></ul><p id="9946" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我们理解对未知记录进行分类的过程，但是选择一个最优的K值呢？</p><p id="2d5d" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我们来回答一下。</p><h1 id="70c0" class="na la it bd lb nb nc nd le ne nf ng lh jz nh ka ll kc ni kd lp kf nj kg lt nk bi translated">3.如何选择一个K值？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/26a36e7fd60211970fe718dc9f85537e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*l8KlCPGOY73IoMbZyv9uJA.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图6:simplilearn.com通过<a class="ae ky" href="https://www.simplilearn.com/" rel="noopener ugc nofollow" target="_blank">的照片</a></p></figure><p id="e60b" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi oe translated"><span class="l of og oh bm oi oj ok ol om di"> K </span>值表示最近邻居的计数。我们必须计算测试点和训练标签点之间的距离。每次迭代更新距离度量的计算代价很高，这就是为什么KNN是一个懒惰的学习算法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/06c2a675746c234b0d4e5ef3c27bc788.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/0*FakkqTKdMPDb3gof.jpg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图7:通过<a class="ae ky" href="https://www.datacamp.com/" rel="noopener ugc nofollow" target="_blank">datacamp.com</a>拍摄的照片</p></figure><ul class=""><li id="c270" class="nl nm it lx b ly mo mb mp li oo lm op lq oq mn oc nr ns nt bi translated">从上图可以看出，如果我们从K=3开始，那么我们预测测试输入属于B类，如果我们从K=7开始，那么我们预测测试输入属于a类。</li><li id="f895" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">这就是你如何想象K值对KNN性能有强大的影响。</li></ul><h2 id="5fca" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">那么如何选择最优的K值呢？</h2><ul class=""><li id="68ab" class="nl nm it lx b ly lz mb mc li nn lm no lq np mn oc nr ns nt bi translated">没有预先定义的统计方法来寻找最有利的k值。</li><li id="46bb" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">初始化一个随机的K值，开始计算。</li><li id="2cd3" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">选择小的K值会导致不稳定的决策边界。</li><li id="0c10" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">较大的K值对于分类更好，因为它导致平滑决策边界。</li><li id="bf24" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated"><strong class="lx iu">绘制误差率和K之间的曲线图，表示定义范围内的值。然后选择具有最小误差率的K值。</strong></li></ul><p id="875c" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">现在你会得到通过实现模型来选择最优K值的想法。</p><h1 id="fb18" class="na la it bd lb nb nc nd le ne nf ng lh jz nh ka ll kc ni kd lp kf nj kg lt nk bi translated">4.KNN模式实施</h1><p id="bf8f" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">让我们通过导入所有必需的包来启动应用程序。然后使用<strong class="lx iu"> read_csv() </strong>函数读取电信数据文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/9ece4b31f253d2149621c3df9bfade56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zj4ZFiRjlGvrGs95KSLg9w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图8:主数据集</p></figure><blockquote class="mt mu mv"><p id="1878" class="lv lw mw lx b ly mo ju ma mb mp jx md mx mq mf mg my mr mi mj mz ms ml mm mn im bi translated">如您所见，有12列，即地区、任期、年龄、婚姻、地址、收入、学历、雇佣、退休、性别、居住和客户。我们有一个目标列，<strong class="lx iu">“cust cat”</strong>将客户分为四组:</p></blockquote><ul class=""><li id="700f" class="nl nm it lx b ly mo mb mp li oo lm op lq oq mn oc nr ns nt bi translated">1-基本服务</li><li id="df20" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">2-电子服务</li><li id="82c5" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">3+服务</li><li id="e612" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">4-全面服务</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/bbe84f0a0a11229cadea19bb42308318.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*qzp7FxhDvFQaW8TlJVh0gA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图9:K = 4时的精度测量</p></figure><ul class=""><li id="7e8b" class="nl nm it lx b ly mo mb mp li oo lm op lq oq mn oc nr ns nt bi translated">我们将所有独立的数据特征收集到X数据框中，并将目标字段收集到y数据框中。然后我们处理数据并使其正常化。</li><li id="176f" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">分割数据后，我们将0.8%的数据用于训练，其余用于测试。</li><li id="6107" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">我们从sklearn库中导入分类器模型，并通过初始化<strong class="lx iu"> K=4来拟合模型。</strong>所以我们在这里达到了<strong class="lx iu"> 0.32 </strong>的精度。</li></ul><p id="aa92" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">现在是时候改进模型，找出最优k值了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/86e4afa436ae9d73cba397b288cbb543.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uULtZ9LAQ-Qp8xpGZNZXcg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图10:误差率与K值的关系</p></figure><p id="8153" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">从图中可以看出，在K=37时，我们得到的最小误差为0.59。接下来，我们可视化了<strong class="lx iu">精度和K值之间的关系。</strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="or os l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/f4e93fb9201b7669f0fd850efe467551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NM4oaO6Cr9M2cJTTuKP2AQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图11:精度与K值的关系</p></figure><p id="52e4" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">现在您看到了改进的结果。我们在K=37 得到了<strong class="lx iu"> 0.41的精度。由于我们已经推导出了误差图，并在k=37时获得了最小误差，因此我们将在该K值下获得更好的效率<strong class="lx iu">。</strong></strong></p><p id="793e" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">因为我们的主要重点是确定最佳K值，但是，您可以执行探索性数据分析，甚至可以实现更高的准确性。数据文件和代码在我的<strong class="lx iu"/><a class="ae ky" href="https://github.com/Amey23/Machine-Learning/tree/master/K-Nearest%20Neighbor" rel="noopener ugc nofollow" target="_blank"><strong class="lx iu">GitHub</strong></a>库中。</p><h1 id="de64" class="na la it bd lb nb nc nd le ne nf ng lh jz nh ka ll kc ni kd lp kf nj kg lt nk bi translated">5.关键要点</h1><ul class=""><li id="846c" class="nl nm it lx b ly lz mb mc li nn lm no lq np mn oc nr ns nt bi translated">我们在k=37 时获得了<strong class="lx iu"> 0.41的精度，比k=4时计算的效率要高。</strong></li><li id="8a13" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated"><strong class="lx iu">小K值不适合</strong>分类。</li><li id="9730" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">通常找到的最佳K值是N的平方根<strong class="lx iu">，</strong>其中N是样本总数。</li><li id="253c" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">使用误差图或精度图找到最有利的K值。</li><li id="69d0" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">KNN在处理多标签类时表现良好，但是您必须注意异常值。</li><li id="14ef" class="nl nm it lx b ly nu mb nv li nw lm nx lq ny mn oc nr ns nt bi translated">KNN广泛应用于<strong class="lx iu">模式识别</strong>和<strong class="lx iu">分析评价</strong>领域。</li></ul><p id="a9d6" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">所有人都在这里，</p><p id="f25a" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在我的下一篇文章中再见。</p><blockquote class="mt mu mv"><p id="546b" class="lv lw mw lx b ly mo ju ma mb mp jx md mx mq mf mg my mr mi mj mz ms ml mm mn im bi translated">你好👋我希望你能从我的文章中获得知识。如果你愿意支持我，请随意给我买些咖啡🙏☕ </p><p id="2070" class="lv lw mw lx b ly mo ju ma mb mp jx md mx mq mf mg my mr mi mj mz ms ml mm mn im bi translated"><a class="ae ky" href="https://www.buymeacoffee.com/amey23" rel="noopener ugc nofollow" target="_blank"><strong class="lx iu">https://www.buymeacoffee.com/amey23</strong></a></p><p id="c51c" class="lv lw mw lx b ly mo ju ma mb mp jx md mx mq mf mg my mr mi mj mz ms ml mm mn im bi translated"><strong class="lx iu">或通过ameypband23@gmail.com联系我</strong></p><p id="0ef3" class="lv lw mw lx b ly mo ju ma mb mp jx md mx mq mf mg my mr mi mj mz ms ml mm mn im bi translated"><strong class="lx iu">乐意为您效劳。</strong></p><p id="30b2" class="lv lw mw lx b ly mo ju ma mb mp jx md mx mq mf mg my mr mi mj mz ms ml mm mn im bi translated">参考文献:<a class="ae ky" href="https://medium.com/@moussadoumbia_90919/elbow-method-in-supervised-learning-optimal-k-value-99d425f229e7" rel="noopener">监督机器学习中的肘方法</a></p></blockquote><div class="ox oy gp gr oz pa"><a href="https://github.com/Amey23/Machine-Learning/tree/master/K-Nearest%20Neighbor" rel="noopener  ugc nofollow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">amey 23/机器学习</h2><div class="ph l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">github.com</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn ks pa"/></div></div></a></div></div></div>    
</body>
</html>