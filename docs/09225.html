<html>
<head>
<title>RFM Analysis using BigQuery ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 BigQuery ML 进行 RFM 分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/rfm-analysis-using-bigquery-ml-bfaa51b83086?source=collection_archive---------7-----------------------#2020-07-02">https://towardsdatascience.com/rfm-analysis-using-bigquery-ml-bfaa51b83086?source=collection_archive---------7-----------------------#2020-07-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7a25" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 BigQuery ML 中的 RFM 分析和 Data Studio 中的可视化进行用户细分。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8b3417c6273979b243101970fb1cc3a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FpP3veuVkgQkOkEL0c7ejw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1233873" rel="noopener ugc nofollow" target="_blank">皮克斯拜</a>的 Gerd Altmann 提供</p></figure><p id="d101" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您想通过使用存储在 BigQuery 中的<a class="ae ky" rel="noopener" target="_blank" href="/send-google-analytics-hit-level-data-to-bigquery-5093e2db481b">谷歌分析数据，基于用户的网站应用活动创建细分市场，从而为用户的转化和重新激活进行再营销。</a></p><p id="55f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本指南中，我将展示如何实现一种流行的技术来细分用户，并将结果可视化，以帮助做出重要的营销决策。</p><p id="0357" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将经历的技术是<strong class="lb iu"> RFM 分析</strong>。我们将使用 BigQuery ml 来创建分段，并使用 data studio 来可视化结果。这是它的样子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">细分用户的仪表板，作者 Muffaddal</p></figure></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><p id="bf27" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本指南中，我们将:</p><p id="aaa3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，<strong class="lb iu">计算用户的最近度、频率、</strong>和<strong class="lb iu">货币</strong>价值。<br/>其次，<strong class="lb iu">使用 k-means 聚类</strong>算法创建 <strong class="lb iu">客户细分。<br/>第三，<strong class="lb iu">在 data studio 中可视化结果</strong>。<br/>第四，将<strong class="lb iu"> RFM 的分析结果导入谷歌分析</strong>进行激活<br/>第五，<strong class="lb iu">自动化 RFM 分析流程</strong>。</strong></p><p id="fa79" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="me">注意:如果你有兴趣在 GCP 探索更多这样的技术，这里的</em> <a class="ae ky" href="https://bit.ly/2NtuqtH" rel="noopener ugc nofollow" target="_blank"> <em class="me">是一个很好的课程，可以从 Google 的</em> </a> <em class="me">开始。</em></p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="9b08" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">什么是 RFM 分析？</h1><p id="1705" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">客户细分策略之一是使用 RFM 分析创建用户群组。它基于用户过去的活动。它使用三个指标来执行分段:</p><ol class=""><li id="c311" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu nh ni nj nk bi translated"><strong class="lb iu">最近度</strong>:自上次购买后的天数。</li><li id="bf44" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><strong class="lb iu">频率</strong>:用户购买的次数。</li><li id="d980" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu nh ni nj nk bi translated"><strong class="lb iu">货币</strong>:用户在购买上花费的总金额。</li></ol><p id="efd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">主要用于购买，但 RFM 分析也可以定制用于其他重要的用户活动，如查看的页面数量，而不是购买基于内容的业务的次数，如<a class="ae ky" href="http://medium.com" rel="noopener">medium.com</a>。</p><h2 id="adfc" class="nq mg it bd mh nr ns dn ml nt nu dp mp li nv nw mr lm nx ny mt lq nz oa mv ob bi translated">利益</h2><p id="aeae" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">RFM 分析的好处是，由于用户是根据他们过去的活动进行细分的，我们对他们与业务的密切关系有一个很好的了解，因此每个细分市场都可以有针对性。</p><p id="7bd3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">举个例子，一个经常在网站上购物的用户，他的平均购买量也很高，我们立刻知道这是一个忠实的客户，应该用来传播口碑。而另一方面，可以向最近购买但不经常购买的用户群提供折扣优惠，以帮助他更习惯该产品。</p><p id="70c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">RFM 分析可以有所帮助</p><ul class=""><li id="e3eb" class="nc nd it lb b lc ld lf lg li ne lm nf lq ng lu oc ni nj nk bi translated">增加客户<strong class="lb iu">保留率</strong></li><li id="ca6d" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oc ni nj nk bi translated">增加<strong class="lb iu">响应</strong>速率</li><li id="75e5" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oc ni nj nk bi translated">增加<strong class="lb iu">转换率</strong></li><li id="47c8" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oc ni nj nk bi translated">增加的<strong class="lb iu">收入</strong></li><li id="d85e" class="nc nd it lb b lc nl lf nm li nn lm no lq np lu oc ni nj nk bi translated">增加<strong class="lb iu">电子邮件中心</strong></li></ul><p id="1f47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">data camp 上有一个关于使用 RFM 分析进行用户细分的很好的教程，可以帮助进一步理解这种用户细分技术背后的直觉。如果你有兴趣，一定要去看看。</p><div class="od oe gp gr of og"><a href="https://bit.ly/2BfqNoI" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">使用 RFM 进行客户细分</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">在第一章中，您将了解群组以及如何分析它们。您将创建自己的客户群…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">bit.ly</p></div></div><div class="op l"><div class="oq l or os ot op ou ks og"/></div></div></a></div></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="2a0a" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated"><strong class="ak">计算 RFM 值</strong></h1><p id="9f40" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">为了计算 RFM 分析，我们需要三个指标，即<strong class="lb iu">用户 id </strong>(在我们的例子中是 GA 客户端 id)<strong class="lb iu">转换事件日期</strong>(在我们的例子中是购买事件日期)，以及<strong class="lb iu">购买事件支付的金额</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/aeda9ea250d0ffca45789a94a205e48a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*1t5xJtQwNfWigvLPRRAqpA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Muffaddal 用于 RFM 分析的主数据集表</p></figure><p id="73b4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意:</strong> <em class="me">我会假设你的数据是上面描述的格式。如果不是，那么你要么转换你的数据为上面的格式，要么修改下面的查询。</em></p><p id="783f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://bit.ly/3vTZdGH" rel="noopener ugc nofollow" target="_blank"> <em class="me">需要 RFM 帮忙分析吗？下面我们来连线</em> </a></p><p id="f885" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们将使用下面的查询计算每个用户的最近次数、频率和货币值。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用 SQL 计算用户的近期、频率和货币价值。</p></figure><p id="7a4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用您的数据表名称替换<code class="fe ox oy oz pa b">line 9</code>上的<code class="fe ox oy oz pa b">&lt;your table &gt;</code>,运行上面的查询应该会得到您的每个用户的最近值、频率和货币值。姑且称之为<code class="fe ox oy oz pa b">query 1</code></p><p id="1a50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该查询的输出将如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/537c8d3291d5077b82c9f370c44d5bbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*TeKi3x4Q0VDZJtBLj3IuGA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用户的新近性、频率和货币价值</p></figure><p id="6f80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将查询的输出保存为名为<code class="fe ox oy oz pa b">RFM_Values</code>的大查询数据表，如下所示</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pc"><img src="../Images/11d41e23b2033159d70f7737a5ee82be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uP4Kbem2I9RPTKfUpgXWog.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">如何用 Muffaddal 将查询结果保存为 BigQuery 表</p></figure><p id="5ff9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们应用 k-means 聚类，根据用户的 RFM 值对他们进行分组。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="de89" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">基于 K 均值聚类的用户细分</h1><p id="8854" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">使用 BigQuery ml，我们可以将机器学习模型直接应用于 BigQuery 中的数据集。使用 BigQuery ml 进行客户细分也相当简单。</p><p id="0cbf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要使用 BigQuery ML 算法，请使用命令<code class="fe ox oy oz pa b">CREATE OR REPLACE MODEL</code>启动您的 SQL 查询。这告诉 BigQuery 将机器学习算法(在 options 命令中提到)应用于查询的 out。</p><p id="6ad7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是如何使用 BigQuery ML 对上一次查询得到的结果应用 k-means 聚类:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用 Biguqery ML 创建 k 均值模型</p></figure><p id="08e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用您想要存储模型输出的表的名称更新<code class="fe ox oy oz pa b">devtest.Demo.RFM_Model</code>，并在<code class="fe ox oy oz pa b">line 10</code>更新项目和数据集值。运行查询，您将在数据集中创建一个新表。我们称之为我们的<code class="fe ox oy oz pa b">query 2</code>。</p><p id="60ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">导航到模型化表的评估选项卡以查看统计数据。它应该是这样的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/57ef57ab792d43da64590f76b0b50804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EVrnE4qOqu4r4KCVZToSmw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">k-均值模型输出，用 Muffaddal 表示</p></figure><p id="c82e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ox oy oz pa b">Centroid id</code>列，说明模型将我们的用户分组到了哪个细分市场。和 count 展示了每个细分市场中的用户数量。</p><p id="663f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们把眼光放在最近、频率和货币列上，我们可以检查该模型根据什么对所有用户进行分组。</p><p id="4839" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，<code class="fe ox oy oz pa b">Centroid id</code>列中的第四部分是不经常使用该应用程序的用户，他们最近也不活跃。然而，他们的购买力是其他细分市场中最高的。</p><p id="7559" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，第一部分用户和第四部分用户一样活跃，但是他们的购买力有点低。</p><p id="2ec1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于这两个用户都已经超过 2 个月(平均 74 天)没有使用我们的网站，他们可能会有所改变，我们应该计划一个营销策略让他们回来。</p><p id="1d26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="me">注意:假设我的数据模型产生了具有 5 个聚类的最佳片段(参见查询中的</em> <code class="fe ox oy oz pa b"><em class="me">line 4</em></code> <em class="me">)。在您的情况下可能会有所不同，所以检查不同数量的分类的结果，看看哪一个给了您最好的分段。</em></p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><p id="0cad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们创建了我们的细分市场，是时候将它连接回 user_id，以便我们可以使用它来重新定位它们。</p><p id="84d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是执行此操作的查询:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">查询来生成细分用户的最终表。</p></figure><p id="123c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意:我已经在上面的第 15 行将每个细分市场命名为细分市场 1、2 等，但是我将建议给它们一个适当的名称，如忠实用户、潜在用户、流失用户等。</p><p id="4258" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将最后一个查询称为<code class="fe ox oy oz pa b">query 3</code></p><p id="4396" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/e6563fef790330e6fbc97d4049395599.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*Zjmk9Gkxx9lv1cY7PPt7tA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Muffaddal 的分割结果</p></figure><p id="8da1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将其保存为 BigQuery 表<code class="fe ox oy oz pa b">RFM_Final</code>，用于分析和仪表板。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="181e" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">在 Data Studio 中可视化 RFM 分析结果</h1><p id="53ad" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">下一步是将我们的<code class="fe ox oy oz pa b">RFM_Final</code>表连接到 Data Studio 并可视化结果。接着，<a class="ae ky" href="https://datastudio.google.com/u/1/reporting/3be5f079-bee9-4407-ac41-da91d1510c2d/page/GqBTB" rel="noopener ugc nofollow" target="_blank">根据我们最终的数据表创建了一个模板</a>仪表盘。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">RFM 仪表板，由穆法达尔</p></figure><p id="17d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它在顶部显示了所有近期、频率和货币值的平均值。理想情况下，平均最近值应该最小，频率和货币值应该最大，这样顶部的 KPI 指标有助于查看应用程序的当前排名。</p><p id="7ded" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">之后，控制面板将三个指标按细分市场进行细分，以帮助了解它们的分布情况。通过过滤报告，我们可以彻底检查每个细分市场。</p><p id="28aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Data studio 的混合也可以用于将这些细分市场与用户的其他活动联系起来，以丰富报告并进一步深入行为分析。</p><p id="afe0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最棒的是，每当<code class="fe ox oy oz pa b">RFM_Final </code>表更新时，我们的仪表板就会自动更新。我们还将看到如何自动进行 RFM 分析，以及时更新用户群。稍后将详细介绍。</p><p id="a981" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意</strong> : <em class="me">该模板是用 google sheets 而不是 BigQuery 构建的，以避免成本，但它应该也可以与 BigQuery connector 一起重用。</em></p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="acc0" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">基于 RFM 结果重定向用户</h1><p id="ab11" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">现在你已经将你的用户细分并可视化了。其中一些将是高付费的忠实用户，而一些将是失去的用户，需要大量有针对性地重新激活他们。所以下一步是用不同的活动和促销来推销它们。</p><p id="00a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是怎么做呢？</p><p id="1e65" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想法是将与每个用户相关的部分发送到谷歌分析，并从那里创建一个观众和目标，因为你喜欢使用谷歌广告。因此，我们必须将丰富的数据发送给谷歌分析。</p><p id="4372" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以在这里利用 GCP。这样做使得我们所有的数据都在一个平台上。我们必须建立一个数据管道，将数据导入谷歌分析。要设置管道，请在云 shell 中输入以下命令来安装所有必需的依赖项:</p><p id="9bfa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ox oy oz pa b">git clone <a class="ae ky" href="https://github.com/GoogleCloudPlatform/cloud-for-marketing.git" rel="noopener ugc nofollow" target="_blank">https://github.com/GoogleCloudPlatform/cloud-for-marketing.git</a></code></p><p id="4e4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装完成后，我们所要做的就是将数据从<code class="fe ox oy oz pa b">RMF_Final</code>表移动到云存储，数据将自动导入 GA！</p><p id="ce56" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里是<a class="ae ky" rel="noopener" target="_blank" href="/automate-data-import-to-google-analytics-471de2c3fc76"> <strong class="lb iu">关于如何设置 GA 导入数据管道</strong> </a> <strong class="lb iu">的详细指南。</strong></p><p id="cc10" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据管道继续监视云存储桶中安装期间提到的文件夹，当它看到任何新的上传文件时，管道会处理它并将其发送到 google analytics。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="0fe2" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">自动化 RFM 分析</h1><p id="26b0" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">运行上面讨论的所有三个查询，将在您需要的任何时候为您的用户群获得更新的细分市场。但是，我们也可以自动执行这一手动流程，以便根据业务需求每月/每季度更新细分市场。</p><p id="0f7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="me">注意:自动化过程需要一点编程知识，因此您可能需要请团队中的技术人员来实现自动化过程。</em></p><p id="1398" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有三个查询需要及时运行，以便从用户群中创建细分市场。首先，计算 RFM 值(<code class="fe ox oy oz pa b">Query 1</code>)。第二，创建模型(<code class="fe ox oy oz pa b">Query 2</code>)。第三，合并模型输出和用户 RFM 值(<code class="fe ox oy oz pa b">Query 3</code>)。</p><p id="64f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想法是链接所有三个查询，以便一个查询的完成执行另一个。</p><p id="11f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是数据流的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pf"><img src="../Images/6c409995fa9e53f2559eede41c93ba52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*717VJbErWlxOcwZP8qiPLQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">RFM 自动化数据管道，由 Muffaddal</p></figure><p id="81dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意</strong> : <em class="me">我将假设已经为所有三个查询创建了表，如以上部分所示。</em></p><p id="8a69" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">1-让我们首先创建一个发布/订阅主题，因为在创建 query 1 schedular 时会用到它。我将其命名为<code class="fe ox oy oz pa b">RFM_Model_Topic</code>，因为它将触发负责执行我们的模型查询(即查询 2)的云函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/5dc77d40bd27ec398410ca094bdd957e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KBJ6zUJK3UnI9ppethN9JQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">RFM _ 模型<code class="fe ox oy oz pa b">_Topic</code>发布/订阅主题，作者 Muffaddal</p></figure><p id="8f53" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">复制主题名称，因为在创建<code class="fe ox oy oz pa b">query 1</code> schedular 时需要它。</p><p id="8c3c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2-接下来，转到 BigQuery，在查询编辑器中粘贴查询 1，它为我们的用户计算 RFM 值，然后单击“Schedule query”按钮创建新的查询 schedular。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ph"><img src="../Images/79cd7e9e7e157cde534fef9769ee7c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ikJFCBKMksUKWbt6cGF6fg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">通过 Muffaddal 创建新的计划查询</p></figure><p id="d0d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3-然后，在调度程序创建菜单中输入所需的值来创建调度程序</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/fffa0f222867c1249cb7960186594355.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*Xih_T5UfLJt7U7OqOLHtMQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">查询日程创建菜单，按 Muffaddal</p></figure><p id="62da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个 schedular 将做的是，它将在指定的时间运行，以计算用户的最近、频率和货币值，并存储在上述 BigQuery 表中。一旦调度完成执行查询，它将向我们的<code class="fe ox oy oz pa b">RFM_Model_Topic</code>发送一条消息，这将触发一个云函数来触发我们的模型查询。所以现在让我们创建一个云函数。</p><p id="91ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4-进入<code class="fe ox oy oz pa b">RFM_Model_Topic</code>发布/订阅主题，点击屏幕顶部的“触发云功能”按钮。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/d31c8d9676ab62659ffdfc18b2639d6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*335fAPTpVF0ntQxN5ScIlQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由 Muffaddal 从发布/订阅主题创建云函数</p></figure><p id="1f4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">5-进入如下所示的设置，并将云功能命名为<code class="fe ox oy oz pa b">RFM_Model_Function</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/3a1c07e4ec37e3fb611104341f176baf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*IMLyefyqO4WhCQGUk6iCIA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">云功能设置，由 Muffaddal</p></figure><p id="e5fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">6-将下面的代码粘贴到<code class="fe ox oy oz pa b">index.js </code>文件中</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">运行 RFM 模型查询的云函数</p></figure><p id="98cd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们的 BigQuery 被执行，我们就向一个名为<code class="fe ox oy oz pa b">RFM_Final</code>的新发布/订阅主题发送一条发布消息，这触发了负责我们最后一个查询的云函数，该查询将 RFM 值和模型结果组合在一个数据集中。</p><p id="76d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">7-因此，接下来，在发布/订阅中创建<code class="fe ox oy oz pa b">RFM_Model</code>主题和一个云函数，就像我们在上一步中做的那样。将下面的代码复制粘贴到云函数中，这样它就可以运行我们最后的查询了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ow lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">运行 RFM 最终查询的云函数</p></figure><p id="6376" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！</p><p id="2c8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们自动化了 RFM 分析流程，该流程将在每个月初自动更新我们的仪表板。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="776a" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">摘要</h1><p id="b43a" class="pw-post-body-paragraph kz la it lb b lc mx ju le lf my jx lh li mz lk ll lm na lo lp lq nb ls lt lu im bi translated">通过个性化营销瞄准细分用户，可以提高留存率、转换率和收入。RFM 分析根据用户在网站/应用程序上的活动创建用户群组。</p><p id="83f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本指南中，我们通过利用 BigQuery ML 使用 SQL 查询执行了 RFM 分析，并在 data studio 中可视化了结果。我们还谈到了如何通过向 Google analytics 导入数据来定位细分用户。最后，我们建立了数据管道来自动化整个 RFM 分析过程，这样我们就可以每月获得更新的用户群。</p><p id="de8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望我能够传达这样一个想法，即我们可以毫不费力地从现有的数据中提取出多少信息。以及支持和改进业务的有效性。</p></div><div class="ab cl lx ly hx lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="im in io ip iq"><h1 id="3442" class="mf mg it bd mh mi mj mk ml mm mn mo mp jz mq ka mr kc ms kd mt kf mu kg mv mw bi translated">您喜欢的类似分析阅读:</h1><div class="od oe gp gr of og"><a rel="noopener follow" target="_blank" href="/user-segmentation-based-on-purchase-history-490c57402d53"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">根据用户的购买力确定产品的目标用户</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">根据用户的购买行为对其进行细分，从而改进广告活动。</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="pl l or os ot op ou ks og"/></div></div></a></div><div class="od oe gp gr of og"><a rel="noopener follow" target="_blank" href="/send-google-analytics-hit-level-data-to-bigquery-5093e2db481b"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">向 BigQuery 发送 Google Analytics 点击量数据</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">如何发送标准的谷歌分析点击量数据到 BigQuery？</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="pm l or os ot op ou ks og"/></div></div></a></div><div class="od oe gp gr of og"><a rel="noopener follow" target="_blank" href="/automate-data-import-to-google-analytics-471de2c3fc76"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">将细分的用户数据发送到 Google Analytics 进行重新激活。</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">建立一个数据管道，使用 Google Cloud Platfrom 将数据导入 google analytics。</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="pn l or os ot op ou ks og"/></div></div></a></div><div class="od oe gp gr of og"><a rel="noopener follow" target="_blank" href="/comprehensive-guide-on-item-based-recommendation-systems-d67e40e2b75d"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">通过个性化推荐增强用户体验</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">本指南将详细介绍基于项目的推荐系统的工作原理以及如何在实际工作中实现它…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="po l or os ot op ou ks og"/></div></div></a></div></div></div>    
</body>
</html>