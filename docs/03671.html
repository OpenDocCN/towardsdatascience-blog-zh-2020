<html>
<head>
<title>Time Series Analysis with Theory, Plots, and Code Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列分析与理论、图表和代码第2部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-series-analysis-with-theory-plots-and-code-part-2-c72b447da634?source=collection_archive---------32-----------------------#2020-04-06">https://towardsdatascience.com/time-series-analysis-with-theory-plots-and-code-part-2-c72b447da634?source=collection_archive---------32-----------------------#2020-04-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/c3569fb9918f9e4cef6c35a1449b001a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LzT7YkGStIOm1ccGwBOKww.jpeg"/></div></div></figure><p id="d0a6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在第一部分中，我们看了:</p><ul class=""><li id="fadf" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky lf lg lh li bi translated">什么是时间序列</li><li id="7bb4" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">预测任务的基本步骤</li><li id="bf02" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">时间序列图形，包括时间图、季节图和季节子序列图</li><li id="a660" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">时间序列成分和分解。</li></ul><p id="1f8b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一切都伴随着理论和代码。</p><p id="28d7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在第2部分，我们将继续我们的旅程:</p><ul class=""><li id="edf6" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky lf lg lh li bi translated">平稳性</li><li id="6560" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">自相关</li><li id="65da" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">滞后散点图</li><li id="45d1" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">简单移动平均线</li><li id="5453" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">指数加权移动平均</li><li id="c9ef" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">双重和三重指数平滑</li></ul><p id="6e48" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们先看一下我们的数据集的第一行。</p><figure class="lp lq lr ls gt ju gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/cf12457912449bff6bcf7eb9fb798c75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*xikKdgPkRtlF8jbinbrhkA.png"/></div><p class="lt lu gj gh gi lv lw bd b be z dk translated">海面温度和盐度的月数据。</p></figure><h1 id="6eae" class="lx ly it bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">1.平稳性</h1><p id="939b" class="pw-post-body-paragraph kb kc it kd b ke mv kg kh ki mw kk kl km mx ko kp kq my ks kt ku mz kw kx ky im bi translated">平稳时间序列的性质不依赖于序列被观察的时间。因此，<strong class="kd iu">具有趋势或季节性的时间序列并不是平稳的</strong> —趋势和季节性会影响时间序列在不同时间的值。另一方面，白噪声序列是稳定的——当你观察它时，这并不重要，它在任何时间点看起来都应该差不多。</p><p id="4510" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">具有周期行为(但没有趋势或季节性)的时间序列是平稳的。这是因为周期不是固定长度的，所以在我们观察序列之前，我们不能确定周期的波峰和波谷在哪里。也就是说，序列的统计属性(如平均值、方差和自相关性)是恒定的。</p><p id="f6f8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">大多数统计预测方法都是针对平稳的时间序列而设计的。预测过程的第一步通常是进行一些转换，将非平稳序列转换为平稳序列。预测平稳序列相对容易，预测结果也更可靠。</p><p id="dec0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们知道，如果预测值(X个变量)彼此不相关，线性回归效果最好。因此，平稳化序列解决了这个问题，因为它消除了任何持久的自相关，从而使预测模型中的预测因子(序列的滞后)几乎独立。</p><p id="38b6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了<strong class="kd iu">使</strong>成为一个时间序列<strong class="kd iu">静止</strong>我们可以:</p><ul class=""><li id="65ef" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky lf lg lh li bi translated">将序列差分一次或多次(用当前值减去下一个值)</li><li id="8229" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">取序列的对数(有助于稳定时间序列的方差。)</li><li id="23f2" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">以nₜₕ根为例</li><li id="f8f8" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">以上各项的组合</li></ul><p id="752e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">但是首先，为了测试<strong class="kd iu">时间序列<strong class="kd iu">是否平稳</strong>，我们可以:</strong></p><ul class=""><li id="40bf" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky lf lg lh li bi translated">看时间图。</li><li id="fc7d" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">将序列分成两部分，并计算描述性统计数据。如果它们不同，那么它就不是静止的。</li><li id="4b29" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">执行被称为<strong class="kd iu">单位根检验</strong>的统计检验，如<strong class="kd iu">增广迪基富勒检验</strong> (ADF检验)、科维亚特科夫斯基-菲利普斯-施密特-申-KPSS检验(趋势平稳)和飞利浦佩龙检验(PP检验)。</li></ul><p id="9693" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最常用的是<strong class="kd iu"> ADF </strong>因此，如果ADF检验中的P值小于显著性水平(0.05)，您拒绝零假设，序列是平稳的。</p><figure class="lp lq lr ls gt ju"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="7e05" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这将输出:</p><figure class="lp lq lr ls gt ju gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/8226a35c186d5e517405c87b9aa60354.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*2lrjOqVQXXIMvqFs_-berA.png"/></div><p class="lt lu gj gh gi lv lw bd b be z dk translated">ADF测试统计的输出。</p></figure><p id="8bd9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">数列是平稳的。然而，p值=0.04967，我们可以应用差异来查看其效果。</p><figure class="lp lq lr ls gt ju"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lp lq lr ls gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nd"><img src="../Images/a0ccafc11a852f39d07b6394df453dc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ktw45VMbbKh65dtzu-Yrw.png"/></div></div><p class="lt lu gj gh gi lv lw bd b be z dk translated">为了使数列看起来稳定，需要三阶差分。</p></figure><h1 id="6b25" class="lx ly it bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">2.自相关</h1><p id="938a" class="pw-post-body-paragraph kb kc it kd b ke mv kg kh ki mw kk kl km mx ko kp kq my ks kt ku mz kw kx ky im bi translated">正如相关性测量两个变量之间线性关系的程度一样，<strong class="kd iu">自相关</strong>测量一个时间序列的<em class="ne">滞后值</em>之间的线性关系，例如yₜ和yₜ₋₁.之间的线性关系如果一个序列是显著自相关的，这意味着该序列以前的值(滞后)可能有助于预测当前值。</p><p id="c84d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">部分自相关</strong>在去除影响两个变量的其他变量的影响后，测量一个变量的线性相关性。也就是说，滞后<em class="ne"> k </em>处的部分自相关是未被滞后1至<em class="ne">k</em>1考虑在内的<em class="ne"> y </em> ₜ和<em class="ne"> y </em> ₜ+yₜ₊ₖ之间的自相关。我们本质上绘制出前一天/前一个月的残差与当天的真实值之间的关系。一般来说，我们预计偏相关会很快下降。</p><figure class="lp lq lr ls gt ju"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lp lq lr ls gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/23118705ae9cdda2d0303d069c8fac79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l7i56V6NaQ3udpwGtUhHqQ.png"/></div></div><p class="lt lu gj gh gi lv lw bd b be z dk translated">60个月的自相关和偏相关(海表温度)。</p></figure><p id="1bc8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于自相关，y轴是值与其滞后时间之间的相关值。滞后在x轴上。零滞后的相关性为1，因为它与自身完全相关。该图显示了6ₜₕ和12ₜₕ月份以及之前和之后月份的高度自相关性。</p><h1 id="4876" class="lx ly it bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">3.滞后散点图</h1><p id="484d" class="pw-post-body-paragraph kb kc it kd b ke mv kg kh ki mw kk kl km mx ko kp kq my ks kt ku mz kw kx ky im bi translated">探索每个观察值和该观察值的滞后之间的关系的一种有用的图称为散点图。</p><p id="8136" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Pandas对此有一个内置的函数，叫做滞后图。它在x轴上绘制了时间t时的观察值，在y轴上绘制了lag1观察值(t-1)。</p><ul class=""><li id="169e" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky lf lg lh li bi translated">如果这些点沿着从图的左下角到右上角的对角线聚集，这表明正相关关系。</li><li id="10ec" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">如果这些点沿着从左上到右下的对角线聚集，这表明负相关关系。</li><li id="ac22" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">这两种关系都很好，因为它们可以被建模。</li><li id="e3e9" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">越靠近对角线的点表示关系越强，越远离对角线的点表示关系越弱。</li><li id="4efe" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">中间有一个球或分布在图中表明关系很弱或没有关系。</li></ul><figure class="lp lq lr ls gt ju"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lp lq lr ls gt ju gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/df28ece655ae5ae914745cb08a0d45e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*_Hpb4dbg_H7lMIq7OQNZEA.png"/></div></figure><h1 id="ed36" class="lx ly it bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">4.移动平均数</h1><p id="94a9" class="pw-post-body-paragraph kb kc it kd b ke mv kg kh ki mw kk kl km mx ko kp kq my ks kt ku mz kw kx ky im bi translated"><strong class="kd iu">移动平均</strong>是对时间t的趋势周期的估计，通过对t的k个周期内的时间序列值进行平均来获得。时间上接近的观测值也可能在数值上接近。因此，平均值消除了数据中的一些随机性，留下了平滑的趋势周期成分。</p><p id="7b2d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">基本的SMA有一些弱点:</p><ul class=""><li id="6fe6" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky lf lg lh li bi translated">较小的窗口会导致更多的噪音，而不是信号。</li><li id="9d24" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">它将总是滞后于窗口的大小。</li><li id="e2e4" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">由于求平均值，它将永远不会达到数据的最大峰值或谷值。</li><li id="39f1" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">它并不真正告诉你未来可能的行为，它真正做的只是描述你的数据的趋势。</li><li id="3729" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">极端的历史值会显著扭曲SMA。</li></ul><figure class="lp lq lr ls gt ju"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lp lq lr ls gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nd"><img src="../Images/bf5cce763ad33ed2107b6dca4ac6a8d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zm-BTDFDMX0Bseh-3NDyfA.png"/></div></div><p class="lt lu gj gh gi lv lw bd b be z dk translated">窗口=3的初始数据和简单移动平均。</p></figure><p id="01a8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">简单移动平均线有一个变种叫做<strong class="kd iu">指数加权移动平均线</strong> (EWMA)。</p><p id="d231" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它将允许我们减少来自SMA的滞后效应，并且它将把更多的权重放在最近发生的值上(通过将更多的权重应用到最近发生的值，因此得名)。应用于最近值的权重量将取决于EWMA中使用的实际参数和给定窗口大小的周期数。</p><figure class="lp lq lr ls gt ju"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lp lq lr ls gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/6f8512a6f90fc0cf151e97991427049e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WOn8Cg6f5BGffAm_Hkfeug.png"/></div></div><p class="lt lu gj gh gi lv lw bd b be z dk translated">初始数据、简单移动平均和简单指数平滑</p></figure><h1 id="3b80" class="lx ly it bd lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bi translated">5.双重和三重指数平滑</h1><p id="3252" class="pw-post-body-paragraph kb kc it kd b ke mv kg kh ki mw kk kl km mx ko kp kq my ks kt ku mz kw kx ky im bi translated">简单指数平滑仅使用一个平滑因子α (alpha)，<strong class="kd iu">双指数平滑</strong>添加了第二个平滑因子<em class="ne"> β </em> (beta)，用于处理数据趋势。与alpha因子一样，beta因子的值介于零和一之间(0 &lt; <em class="ne"> β </em> ≤10 &lt; β≤1)。这里的好处是，模型可以预测未来的增长或下降，而水平模型只能根据最近的计算来工作。</p><p id="7fb7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们还可以处理趋势中不同类型的变化(增长/衰退)。如果时间序列显示直线倾斜趋势，您可以使用<strong class="kd iu">加法</strong>调整。如果时间序列显示指数(曲线)趋势，您可以使用<strong class="kd iu">乘法</strong>调整。</p><p id="990d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">三重指数平滑</strong>，与Holt-Winters关系最密切的方法，增加了对数据中趋势和季节性的支持。</p><figure class="lp lq lr ls gt ju"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="lp lq lr ls gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/6baac4abe9a3522179ee4d97c41a9dbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t4V1uAXDJgpjNkljm2f-CA.png"/></div></div><p class="lt lu gj gh gi lv lw bd b be z dk translated">初始数据，双重和三重指数平滑。</p></figure><p id="d846" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">就是这样！感谢您的阅读，下次见！</p><p id="d2dd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">参考资料:</p><ul class=""><li id="9a0f" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky lf lg lh li bi translated"><a class="ae kz" href="https://www.machinelearningplus.com/time-series/time-series-analysis-python/" rel="noopener ugc nofollow" target="_blank">https://www . machinelingplus . com/time-series/time-series-analysis-python/</a></li><li id="0b86" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated"><a class="ae kz" href="https://www.udemy.com/python-for-time-series-data-analysis/" rel="noopener ugc nofollow" target="_blank">https://www.udemy.com/python-for-time-series-data-analysis/</a></li><li id="7207" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated"><a class="ae kz" href="https://machinelearningmastery.com/time-series-data-visualization-with-python/" rel="noopener ugc nofollow" target="_blank">https://machine learning mastery . com/time-series-data-visualization-with-python/</a></li></ul></div></div>    
</body>
</html>