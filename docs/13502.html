<html>
<head>
<title>Integrating Python with MySQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">集成 Python 和 MySQL</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/integrating-python-with-mysql-4575248d5929?source=collection_archive---------24-----------------------#2020-09-16">https://towardsdatascience.com/integrating-python-with-mysql-4575248d5929?source=collection_archive---------24-----------------------#2020-09-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/2211fb29fec3727861d7dba06d6f2b89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fCOBpevfigJ0COX_de0TBQ.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">汉斯-彼得·高斯特在 Unsplash 上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="ba67" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">如何将数据动态加载到数据库中</h2></div><p id="1719" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">数据分析师或数据科学家有很多机会使用 Python 和 SQL。Python 及其庞大的库支持为数据分析师提供了一根魔棒来操纵和可视化数据。同样，SQL 帮助我们存储数百万条记录，并与其他表建立关系，以实现最佳的数据管理。有些场景需要 Python 程序将数据直接加载到后端数据库中。例如，如果定期或随机动态修改数据帧，则将每次数据更新的 csv 文件上传到数据库是不可行的。在本帖中，我们将介绍如何将 Python 程序与 MySQL 数据库集成。</p><p id="97ee" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，我用 Python 创建了一个小数据集。它有两列，第一列存储索引，第二列存储时间戳。</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="381e" class="ma mb jg lw b gy mc md l me mf">from datetime import datetime # Current date time in local system <br/>col_1 = col_1+1 <br/>col_2 = datetime.now()<br/>print('ID:',col_1)<br/>print('Timestamp:',col_2)</span></pre><figure class="lr ls lt lu gt is gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/bd54e6c408a1b44099e61abcb052a3ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*NhkI57nhLGEY33k2Y_2H3w.png"/></div></figure><p id="e175" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">在 MySQL 中创建表格</strong></p><p id="fbe0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">同时，我们可以在 MySQL db 中创建一个表，用于存储我们在第一步中生成的数据。也可以在 MySQL 中从 python 本身创建一个表。因为这是一个一次性的过程，所以直接在数据库中创建表会更容易。</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="2a01" class="ma mb jg lw b gy mc md l me mf">#Create table called details.<br/>create table `details`(<br/>Id int(20)  not null,<br/>Time datetime null <br/>);</span></pre><figure class="lr ls lt lu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mh"><img src="../Images/f1c01b703d121728b490dd2ea5d01da7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kMYTh3Jx1jfz5MDoUWRRzQ.png"/></div></div></figure><p id="a369" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">连接 Python 和 MySQL </strong></p><p id="1e35" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，我们需要导入 mysql.connector 包，如果它不可用，那么我们需要使用下面的代码安装它</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="7b8e" class="ma mb jg lw b gy mc md l me mf">pip install mysql.connector<br/>#or<br/>!pip install mysql.connector</span></pre><p id="2c87" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们需要从 mysql.connector 导入错误代码。这将有助于在插入数据库时识别问题(如果有的话)。可能遇到的一些错误是主键空错误和重复条目(如果表设置了主键)。</p><figure class="lr ls lt lu gt is"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="dce6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们需要在代码中指定我们的 MySQL 凭证。我们首先打开一个到 MySQL 服务器的连接，并将变量 connection 对象存储在变量<em class="mk"> cnct </em>中。然后，我们使用连接的 cursor()方法创建一个新的游标。</p><p id="72aa" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将 insert 语句存储在变量<em class="mk"> sql_query </em>中，变量<em class="mk"> info </em>中的数据用于替换查询中的%s 标记。</p><p id="180e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">execute 语句将执行存储在变量<em class="mk"> sql_query </em>中的查询</p><p id="bad0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦执行了上面的代码，让我们检查一下数据库，看看数据是否是动态加载的。</p><figure class="lr ls lt lu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ml"><img src="../Images/fc4d4cfa5aac09af0243aa8e2cf915fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ijk4HSHjGibSEqB95kFfuw.png"/></div></div></figure><p id="4215" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">精彩！！数据已经加载。</p><p id="0716" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在让我们看看如果我运行代码 5 次，数据是如何加载到数据库中的。</p><figure class="lr ls lt lu gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mm"><img src="../Images/8f5459191fb1e1061bf78c796e2b74a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lG9xTV6lS8zbHLC_qJY3PQ.png"/></div></div></figure><p id="b8a1" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">每次运行代码或作业时，都会动态加载和刷新数据库。</p><p id="c988" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">结论</strong></p><p id="9d0b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">同样，我们可以从 Python 接口本身执行任何操作，如创建数据库或表、插入、更新、删除和选择操作，这将反映在 MySQL 数据库中。</p><p id="2c76" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">事实证明，这种集成对于涉及不断变化的数据的场景非常有用。例如，经常从网站上搜集的数据，或者从 Twitter 或脸书 feeds 上获取的实时数据。</p><p id="421d" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Jupyter 笔记本在<a class="ae jd" href="https://github.com/Sanjana-Ramankandath/Python_MySQL_integration/blob/master/Integration_Python_MySQL.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上有售。</p><p id="4b27" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx jh">参考:</strong></p><p id="536b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">[1]<a class="ae jd" href="https://dev.mysql.com/doc/connector-python/en/connector-python-example-cursor-select.html" rel="noopener ugc nofollow" target="_blank">https://dev . MySQL . com/doc/connector-python/en/connector-python-example-cursor-select . html</a></p></div></div>    
</body>
</html>