<html>
<head>
<title>Working with JSON in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Python 中使用 JSON</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/working-with-json-in-python-a53c3b88cc0?source=collection_archive---------15-----------------------#2020-09-15">https://towardsdatascience.com/working-with-json-in-python-a53c3b88cc0?source=collection_archive---------15-----------------------#2020-09-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fc9d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在 5 分钟内学会基础知识</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/66ecde301458e4640184ae5de6178340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5tOFAOu3mJBlb3wp"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">丹尼斯·帕夫洛维奇在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="7677" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇博文中，我们将学习 JSON。我们将学习 JSON 是什么，它为什么存在，人们为什么使用它，以及最终如何利用 python 的能力来帮助我们处理它。</p><p id="9f7e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一名数据科学家、程序员或者仅仅是一名技术爱好者，理解 JSON 是什么以及如何使用它是很重要的。我确信，一旦你理解了它，你会发现它的许多应用。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a846" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">JSON 是什么？</h1><p id="79c5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">JSON 代表 JavaScript 对象符号，它本质上是一种表示数据的方式。JSON 遵循一种人类可以自然理解的格式，它真正的力量来自于它捕捉复杂数据关系的能力。</p><p id="ae50" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以在以下示例中看到这一点:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="4956" class="ne md it na b gy nf ng l nh ni">{<br/> "usersName": "Costas",<br/> "website": {<br/>    "host": "<a class="ae ky" href="http://www.medium.com" rel="noopener">www.medium.com</a>",<br/>    "account": "costasandreou",<br/>    "blogpost": [<br/>        {<br/>            "type": "title",<br/>            "description": {<br/>                "main" : "Working with JSON in Python",<br/>                "sub" : "the info you need"<br/>            }<br/>        }<br/>    ]<br/>  }<br/>}</span></pre><p id="1910" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意 JSON 是如何在键值对中构造的，同时还保存数组对象(注意“blogpost”下面有几个类型)。如果你来自一个平面数据结构背景(想想 Excel 或 Pandas dataFrames)，这一点非常重要。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="a58e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">JSON 为什么会存在？</h1><p id="4493" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">JSON 创建于千禧年之初，是为了将我们从 Flash 和 Java 小程序中拯救出来。如果你碰巧不记得那些浏览器内置插件，请认为你非常幸运，因为它们是噩梦的素材！但是我跑题了。JSON 是为无状态实时服务器到浏览器的通信提供协议而构建的。</p><p id="9e1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您已经熟悉 XML，那么您可以将 JSON 视为一种轻量级的、更容易使用、更快速的替代方案。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="8083" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">人们为什么使用 JSON？</h1><p id="d025" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">据信，第一家开始提供服务并因此普及 JSON 应用的大公司是 2005 年的雅虎。现在认为 JSON 是最常用的数据格式。</p><p id="cc62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">人们使用 JSON 的三大原因是:</p><ol class=""><li id="6f68" class="nj nk it lb b lc ld lf lg li nl lm nm lq nn lu no np nq nr bi translated">非常易于阅读、书写和操作</li><li id="550a" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">通过网络传输非常快</li><li id="7f98" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu no np nq nr bi translated">受所有主流浏览器支持，后端技术堆栈</li></ol></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="000c" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">阅读 JSON</h1><p id="00b9" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">当您必须使用 JSON 时，您想做的第一件事就是将它读入您的 Python 应用程序。Python 中的 json 库期望 JSON 以字符串的形式出现。</p><p id="6ba0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设您的数据 JSON 数据已经是一个字符串:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="1382" class="ne md it na b gy nf ng l nh ni">obj = '{ "usersName": "Costas",  "website": { "host": "www.medium.com", "account": "costasandreou", "blogpost": [ { "type": "title", "description": { "main" : "Working with JSON in Python", "sub" : "the info you need" } } ] } }'</span><span id="9107" class="ne md it na b gy nx ng l nh ni">import json<br/>json_obj = json.loads(obj)<br/>print('obj: ',type(obj))<br/>print('obj.usersName: ', json_obj['usersName'])</span></pre><p id="c5fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它返回:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="088b" class="ne md it na b gy nf ng l nh ni">obj:  &lt;class 'str'&gt;<br/>obj.usersName:  Costas</span></pre><p id="aa87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，如果您将 json 保存在 Python 对象中(比如字典)，JSON 库允许您将它转换回字符串，以便进一步处理。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="c89e" class="ne md it na b gy nf ng l nh ni">obj1 = { "usersName": "Costas",  "website": { "host": "<a class="ae ky" href="http://www.medium.com" rel="noopener">www.medium.com</a>", "account": "costasandreou", "blogpost": [ { "type": "title", "description": { "main" : "Working with JSON in Python", "sub" : "the info you need" } } ] } }</span><span id="81d2" class="ne md it na b gy nx ng l nh ni">print('obj1: ',type(obj1))<br/>json_obj1str = json.dumps(obj1)<br/>print('json_obj1str: ', type(json_obj1str))<br/>json_obj1 = json.loads(json_obj1str)<br/>print('obj1.usersName: ', json_obj1['usersName'])</span></pre><p id="556a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它返回:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="5fed" class="ne md it na b gy nf ng l nh ni">obj1:  &lt;class 'dict'&gt;<br/>json_obj1str:  &lt;class 'str'&gt;<br/>obj1.usersName:  Costas</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="64e2" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">使用 JSON</h1><p id="ee90" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">既然我们已经看到了如何将 JSON 数据加载到 Python 应用程序中，那么让我们看看使用 JSON 的选项。</p><h2 id="b811" class="ne md it bd me ny nz dn mi oa ob dp mm li oc od mo lm oe of mq lq og oh ms oi bi translated"><strong class="ak"> <em class="oj">直接查询</em> </strong></h2><p id="0b99" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">从 JSON 中提取信息就像定义我们要寻找的路径并提供键值对的名称一样简单。我们来看几个例子。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="23eb" class="ne md it na b gy nf ng l nh ni">&gt;&gt;&gt; print(json_obj['usersName'])<br/>Costas</span><span id="5483" class="ne md it na b gy nx ng l nh ni">&gt;&gt;&gt; print(json_obj['website'])<br/>{'host': '<a class="ae ky" href="http://www.medium.com'" rel="noopener">www.medium.com'</a>, 'account': 'costasandreou', 'blogpost': [{'type': 'title', 'description': {'main': 'Working with JSON in Python', 'sub': 'the info you need'}}]}</span><span id="bcb0" class="ne md it na b gy nx ng l nh ni">&gt;&gt;&gt; print(json_obj['website']['host'])<br/><a class="ae ky" href="http://www.medium.com" rel="noopener">www.medium.com</a></span><span id="ed43" class="ne md it na b gy nx ng l nh ni">&gt;&gt;&gt; print(json_obj['website']['blogpost'])<br/>[{'type': 'title', 'description': {'main': 'Working with JSON in Python', 'sub': 'the info you need'}}]</span><span id="b49e" class="ne md it na b gy nx ng l nh ni">&gt;&gt;&gt; print(json_obj['website']['blogpost'][0]['description']['sub'])<br/>the info you need</span></pre><p id="de4e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们可以像上面那样提取数据，我们就可以很容易地将它们存储在列表或数据库中，以便进一步处理。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="df38" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak"> <em class="oj">用熊猫</em> </strong>处理你的数据</h1><p id="bd79" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">如果您已经习惯了 Pandas，并且希望使用平面数据，有一种快速的方法可以将数据放入数据框中。首先，你可以将<em class="ok">的第一层数据</em>添加到数据帧中。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="eb5f" class="ne md it na b gy nf ng l nh ni">df = pd.read_json(obj)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/62454eefac29711a3708dc2c628b10f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*nGXkfiZnUpsZSB1Gz1Q3kg.png"/></div></figure><p id="c112" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如您所见，read_json 接受 string 数据类型，并且只允许我们查看顶级信息。换句话说，它不会使任何结构变平。我们需要一种方法来浏览较低层次的数据。</p><p id="1133" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过使用 json_normalise pandas 方法将数据<em class="ok">进一步扁平化</em>。</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="ae5f" class="ne md it na b gy nf ng l nh ni">obj = json.loads(obj)<br/>df1 = pd.json_normalize(obj)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/119f30fec333a120f2d8c654c147c2a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*stw9nf3s0hV34h3K8fBeZQ.png"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0236" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">扁平化 JSON</h1><p id="c40e" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在某些情况下，您只是想将数据展平。它当然可以使数据分析有时更快，并可以允许大量记录的可视化检查(想想 Excel 类型的数据过滤)。</p><p id="d26a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以使用第三方库来实现。首先，安装库:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="ccb8" class="ne md it na b gy nf ng l nh ni">pip install json-flatten</span></pre><p id="21c8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，运行以下命令:</p><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="322a" class="ne md it na b gy nf ng l nh ni">&gt;&gt;&gt; import json<br/>&gt;&gt;&gt; obj = json.loads(obj)</span><span id="bcad" class="ne md it na b gy nx ng l nh ni">&gt;&gt;&gt; import json_flatten<br/>&gt;&gt;&gt; print(json_flatten.flatten(obj))</span><span id="cf34" class="ne md it na b gy nx ng l nh ni">{'usersName': 'Costas', 'website.host': '<a class="ae ky" href="http://www.medium.com'" rel="noopener">www.medium.com'</a>, 'website.account': 'costasandreou', 'website.blogpost.0.type': 'title', 'website.blogpost.0.description.main': 'Working with JSON in Python', 'website.blogpost.0.description.sub': 'the info you need'}</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="d420" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">交叉记录分析</h1><p id="0bd8" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">到目前为止，我们研究的所有内容都集中在处理单个 JSON 记录上。然而，在现实世界中，您可能需要处理许多 JSON 文档，并且需要跨记录进行聚合。</p><p id="b312" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以考虑使用以下任何一种方法来支持您的分析:</p><ul class=""><li id="22ee" class="nj nk it lb b lc ld lf lg li nl lm nm lq nn lu on np nq nr bi translated">MongoDB 存储数据，然后在其上运行聚合</li><li id="923a" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu on np nq nr bi translated">扁平化数据，用熊猫做运营</li><li id="4764" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu on np nq nr bi translated">展平数据并导出到 Excel 以供进一步操作</li><li id="caff" class="nj nk it lb b lc ns lf nt li nu lm nv lq nw lu on np nq nr bi translated">选择您想要的属性，并将它们加载到 SQL DB 中以供进一步分析</li></ul></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="2f94" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结论</h1><p id="f681" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">这就是了。在 5 分钟内，您就知道了开始使用 JSON 所需的一切。我鼓励你花些时间去熟悉它。它应用广泛，当然是你简历上的必备！</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h2 id="f82f" class="ne md it bd me ny nz dn mi oa ob dp mm li oc od mo lm oe of mq lq og oh ms oi bi translated">参考资料:</h2><pre class="kj kk kl km gt mz na nb nc aw nd bi"><span id="7142" class="ne md it na b gy nf ng l nh ni">{<br/> "References" : [<br/>  { <br/>   "¹" : "<a class="ae ky" href="https://en.wikipedia.org/wiki/JSON#History" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/JSON#History</a>"<br/>  },<br/>  { <br/>   "²" : "guru99.com/json-vs-xml-difference.html"<br/>  },<br/>  { <br/>   "³" : "<a class="ae ky" href="https://pypi.org/project/json-flatten/#description" rel="noopener ugc nofollow" target="_blank">https://pypi.org/project/json-flatten/#description</a>"<br/>  },<br/> ]<br/>}</span></pre></div></div>    
</body>
</html>