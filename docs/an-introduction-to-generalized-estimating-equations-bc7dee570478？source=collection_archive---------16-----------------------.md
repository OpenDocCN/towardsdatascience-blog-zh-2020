# 广义估计方程导论

> 原文：<https://towardsdatascience.com/an-introduction-to-generalized-estimating-equations-bc7dee570478?source=collection_archive---------16----------------------->

![](img/27f4291d281694e17639dc99bb454150.png)

罗马法师在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

## 如何评估纵向数据的总体平均效应

支撑*广义线性模型*(线性回归是其中的一种)的一个关键假设是观察的独立性。在纵向数据中，这是不成立的。个体内部(时间点之间)的观察结果可能比个体之间的观察结果更相似。

那么，你如何处理这个问题呢？一种选择是拟合广义线性混合模型，其中每个个体都有随机截距和斜率项。这将告诉你一个特定的个体(即取决于随机截距和斜率)变量对结果的影响。然而，如果你关注的是边际效应，也就是说，一个变量对总体的平均*结果*有什么影响，这就没什么用了。

如果你想回答这些人口问题，你需要使用*广义估计方程* (GEE)拟合一个广义线性模型。这是一种获得总体平均效应的方法，说明了个体内部的观察结果可能比个体之间的观察结果更相似。

# 一个例子

假设我们有我们的*结果*——全因死亡率。现在假设我们每个月为每个人记录 10 个月。现在假设我们的曝光时间。我们现在可以定义一个逻辑回归模型，唯一的自变量是时间(以月为单位)，因变量是当时的死亡。“好的，很好”我听到你说“但是这些观察显然是不独立的！”。完全正确，但我们会谈到这一点。

# 工作相关结构

要使用 GEE，我们必须首先定义时间点是如何关联的。然而，通过使用 [Huber-White 标准误差](https://en.wikipedia.org/wiki/Heteroscedasticity-consistent_standard_errors)，我们的结果将*一致*，即使我们错误地指定了这种关系！所以我们有一些选择。

## 自主的

这种工作关联结构假设时间点彼此独立。这在实践中很可能是一个不合理的假设。

## 可交换的

对于任意两个时间点，两个时间点的观测值之间的相关性相等。这是通常使用的，因为它只需要估计一个额外的参数α。

## 自回归的

在这种情况下，观测值之间的相关性遵循自回归结构。假设我们使用 AR-1 相关矩阵。这将意味着一个人的第 1 个月和第 2 个月之间的相关性将被期望为α，一个人的第 1 个月和第 3 个月之间的相关性将被期望为α，第 1 个月和第 4 个月之间的相关性将为α，依此类推。

当您认为距离较近的时间点比距离较远的时间点更相似时，这是最合适的。

## 无社会组织的

这是我们为每个可能的时间点组合估计一个单独的α的地方。这是最一般的情况。尽管你需要大量的数据来估计所有使用的α。

## 其他选择

确实存在一些其他的选择，但是这些没有被广泛使用。

## 如何选择使用哪一种？

很简单。要么选择您的数据可以支持的最通用的方法(取决于样本大小)，要么选择您认为最适合该数据的方法。不管怎样，别担心！这种方法是一致的，即使你指定错了。

# 如何适应模型

拟合模型很简单。我们只是使用 GEE 和我们指定的工作相关矩阵来拟合 GLM:

![](img/52793cf4e5bed72eeccfdae90a948766.png)

其中:

*   如果参与者 I 在时间 j 死亡，Yij 为 1
*   pij 是参与者 I 在时间 j 的死亡概率
*   β0 是 0 时刻的人口平均死亡概率对数。这可以被指数化以获得在时间 0 的死亡几率。
*   β1 是与时间增加一个月相关的死亡对数比的总体平均差异。这可以被指数化以获得与一个月的时间增加相关联的优势比。
*   Tij 是以月为单位对参与者 I 进行第 j 次测量的时间。

就是这样。我们的人口平均效应是时间增加一个月，死亡的几率增加一个比值比 exp(β1)。

## 在 R 中拟合模型

我们可以在 R 中使用 [geepack](https://rdrr.io/cran/geepack/man/geeglm.html) 来做到这一点。假设我们的数据帧已经存在，有三列`death` `time`和`person.id`，我们要做的就是:

```
library(geepack)
mod <- geeglm(death ~ time, id = person.id, waves = time, family=binomial, corstr="exchangeable")
```

然后你可以像平常一样调用`summary(mod)`并得到你的结果！

当然，你可以把协变量加到模型中，只要把它们加到公式中。它们可以是时变的，也可以是恒定的——任何一种都可以！

# 结论

希望你在读完这篇文章后对 GEE 有了一个基本的概念。它们应该是任何处理纵向数据的数据科学家工具箱中的一个工具。