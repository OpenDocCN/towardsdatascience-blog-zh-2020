<html>
<head>
<title>Simple linear regressions in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的简单线性回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/linear-regressions-with-scikitlearn-a5d54efe898f?source=collection_archive---------41-----------------------#2020-05-12">https://towardsdatascience.com/linear-regressions-with-scikitlearn-a5d54efe898f?source=collection_archive---------41-----------------------#2020-05-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0a80" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">scikit入门-学习和Python</h2></div><p id="eaae" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文应该足以涵盖如何在Python中运行构造一个简单的线性回归。它也将包含一些我面对的错误和如何克服它们！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/22cc49336c0282636b411b913c881a26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*inGb1PmxP5WhZHZe"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">在<a class="ae lr" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae lr" href="https://unsplash.com/@zmachacek?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">zdenk macha ek</a>拍摄的照片</p></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="1ac8" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">这个概念</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/b0347a4719b5df40680a18e7f48df18a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*Hg8CgDNL4QqwuFCHJOeyFQ.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">简单线性回归</p></figure><p id="6fa2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，线性回归是关于<strong class="kh ir">通过一组数据点找到一条最佳拟合线性线</strong>(通常由R平方度量来判断)。对于给定的X数据点，通过最小化实际和预测的Y数据点之间的差异(残差),该线将实现更好的拟合。在下面的例子中，蓝色点代表<em class="ms">实际的</em> Y值，而红色线代表<em class="ms">预测的</em> Y值的向量。</p><p id="c6f9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">令人兴奋的是，简单的线性回归是监督机器学习最简单的形式之一！</p><h1 id="b0a5" class="lz ma iq bd mb mc mt me mf mg mu mi mj jw mv jx ml jz mw ka mn kc mx kd mp mq bi translated"><strong class="ak">数据</strong></h1><p id="47c7" class="pw-post-body-paragraph kf kg iq kh b ki my jr kk kl mz ju kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">首先，我将使用iris数据集，它是数据空间中覆盖面非常广的数据集，可以很容易地在网上找到。它包含5个属性下的一组150个记录— <strong class="kh ir">花瓣长度、花瓣宽度、萼片长度、萼片宽度和类(种)</strong>。</p><p id="e13a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有一个快速的<em class="ms"> iris_df.head() </em>:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/82328808b3d86bef49b70bd2b7278c32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*35rRigOd_yaiaehVd1QWPA.png"/></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">快速浏览数据集</p></figure><h1 id="9926" class="lz ma iq bd mb mc mt me mf mg mu mi mj jw mv jx ml jz mw ka mn kc mx kd mp mq bi translated">包裹</h1><ol class=""><li id="4411" class="ne nf iq kh b ki my kl mz ko ng ks nh kw ni la nj nk nl nm bi translated"><em class="ms"> sklearn </em>模块(train_test_split、LinearRegression、make_regression、load _ iris)——这些模块在加载iris数据集、准备数据和拟合模型时是必需的。</li><li id="553f" class="ne nf iq kh b ki nn kl no ko np ks nq kw nr la nj nk nl nm bi translated"><em class="ms"> matplotlib pyploy </em>模块—需要绘制结果。</li><li id="8531" class="ne nf iq kh b ki nn kl no ko np ks nq kw nr la nj nk nl nm bi translated"><em class="ms">熊猫</em>和<em class="ms"> numpy </em>包——需要操纵数据帧及其组成值</li></ol><h1 id="6a62" class="lz ma iq bd mb mc mt me mf mg mu mi mj jw mv jx ml jz mw ka mn kc mx kd mp mq bi translated">该过程</h1><p id="e527" class="pw-post-body-paragraph kf kg iq kh b ki my jr kk kl mz ju kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">我们将尝试解决的问题陈述是:</p><blockquote class="ns"><p id="d81c" class="nt nu iq bd nv nw nx ny nz oa ob la dk translated"><strong class="ak">萼片长度</strong>和萼片宽度之间有线性关系吗？</p></blockquote><figure class="od oe of og oh lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oc"><img src="../Images/36f88722d75595ac39b3d4ee4e5256e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jDwDbmQ70Nl7J4H1WRW8nA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">代码块1</p></figure><ol class=""><li id="43f2" class="ne nf iq kh b ki kj kl km ko oi ks oj kw ok la nj nk nl nm bi translated">我们首先从<strong class="kh ir">开始设置萼片长度为<em class="ms"> X_var </em>，萼片宽度为<em class="ms"> Y_var。</em> </strong></li><li id="96ea" class="ne nf iq kh b ki nn kl no ko np ks nq kw nr la nj nk nl nm bi translated">此外，有必要使用<em class="ms">的<strong class="kh ir">。对两个变量整形(-1，1) </strong></em>方法；这将在后面的部分详细阐述。</li><li id="2dd2" class="ne nf iq kh b ki nn kl no ko np ks nq kw nr la nj nk nl nm bi translated"><strong class="kh ir">设置一个75/25列车测试分割。监督机器学习的一个关键思想是能够在未接触的数据上测试你的模型的能力。训练-测试分割实际上使用75%来生成最佳拟合线，并使用剩余的25%来评估模型对新数据(假设这些数据来自与训练数据集相同的分布)的性能。75/25是<em class="ms"> scikit learn，</em>使用的默认比例，必要时可以更改。</strong></li></ol><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ol"><img src="../Images/09f353796797134acb462c88007a900b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fnQUY_sM_8I6NtLVXz5rTw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">代码块2</p></figure><p id="ed01" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.<strong class="kh ir">创建线性回归对象，并使其符合训练数据。</strong> <em class="ms"> LinearRegression() </em>可以认为是建立一个不含参数的‘空白’线性回归模型。呼唤着<em class="ms">。线性回归对象上的fit(x_train，y_train) </em>方法使用训练数据集和标签来为对象生成参数。</p><p id="5ac2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">5.<strong class="kh ir">获取线性回归模型的参数。</strong>这是通过调用方法<em class="ms">完成的。coef_ </em>和<em class="ms">。在拟合的模型对象<em class="ms">上截取_ </em>。</em>末尾的下划线表示由模型生成。</p><p id="e1ed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">6.<strong class="kh ir">评估模型在训练和测试数据集上的表现。</strong>在这种情况下，模型在训练数据上输出0.0030的R平方，在测试数据集上输出0.0265的R平方。在这种情况下，得出弱到不存在线性相关性的结论是合理的。</p><h1 id="08b5" class="lz ma iq bd mb mc mt me mf mg mu mi mj jw mv jx ml jz mw ka mn kc mx kd mp mq bi translated">测绘</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi om"><img src="../Images/2d9cbfcd06d8e454e914ac3e12d82547.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*rWomLPOPAAKjFghi213qQg.png"/></div></figure><p id="ead6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以使用来自<em class="ms"> matplotlib库</em>的<em class="ms"> pyplot </em>模块进一步可视化数据。对于给定的萼片长度，似乎最佳拟合线提供了对萼片宽度的非常不准确的预测。这与低R平方分数相一致。</p><blockquote class="ns"><p id="8113" class="nt nu iq bd nv nw nx ny nz oa ob la dk translated">因此，我们可以得出结论，在这些花的萼片宽度和萼片长度之间存在微弱或不存在的线性回归。</p></blockquote><figure class="od oe of og oh lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi on"><img src="../Images/525753cd8f74c61644b18a37f9751c0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yz1pfz_03i7--fTHgxHlJw.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">代码块3</p></figure><h1 id="f62c" class="lz ma iq bd mb mc mt me mf mg mu mi mj jw mv jx ml jz mw ka mn kc mx kd mp mq bi translated">可能的问题</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oo"><img src="../Images/f2c96f1bc0d0f9c202176d3e20b4201a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VCHHw6mUHqLZJSYHxNI8oQ.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">错误消息！</p></figure><p id="a056" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如上所述，我称之为<em class="ms">。在继续建模之前，对变量进行整形(-1，1) </em>方法。下面不用<em class="ms">重塑</em>的方法来试试吧。线性回归模型抛出了一个令人生畏的错误，但是需要重点关注的是最后几行:</p><p id="20c5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="ms">应为2D数组，却得到了1D数组，</em>和<em class="ms">要么使用array . shape(-1，1)对数据进行整形(如果数据只有一个要素),要么使用array . shape(1，-1)对数据进行整形(如果数据只有一个样本)。</em></p><p id="e5ea" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">基本上，<em class="ms">。fit </em>方法期望x和y变量是二维数组，但它们最终是原始形式的一维数组。为了确认，我们可以打电话给<em class="ms">。shape </em>方法，它们都将返回各自numpy <em class="ms"> (150，)</em>的形状。这可以解释为第一维度具有150个值，而第二维度包含0，从而产生一维对象。进一步调用<em class="ms">。ndim </em>方法对变量将返回维数，1。</p><p id="dc70" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">这个。<em class="ms"> reshape(-1，1) </em>方法用于创建原始数组的一个实例，该实例添加了一个额外的numpy数组维度。</strong>该方法的参数具有以下含义:</p><ol class=""><li id="6d07" class="ne nf iq kh b ki kj kl km ko oi ks oj kw ok la nj nk nl nm bi translated">-1:保持尺寸不变。</li><li id="a597" class="ne nf iq kh b ki nn kl no ko np ks nq kw nr la nj nk nl nm bi translated">1:添加新尺寸。</li></ol><p id="63be" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">这样一来，X_var和Y_var现在就转化成了带<em class="ms">的变量。2的ndim </em>，和<em class="ms">。(150，1)的形状</em>。</strong>在此过程中，变量也从类型<em class="ms">pandas . core . series . series</em>变为类型<em class="ms"> numpy.ndarray. </em></p><h1 id="2d24" class="lz ma iq bd mb mc mt me mf mg mu mi mj jw mv jx ml jz mw ka mn kc mx kd mp mq bi translated">代码</h1><p id="6ecf" class="pw-post-body-paragraph kf kg iq kh b ki my jr kk kl mz ju kn ko na kq kr ks nb ku kv kw nc ky kz la ij bi translated">请在这里找到我的GitHub上的代码:</p><div class="op oq gp gr or os"><a href="https://github.com/dehan97/fictional-fiesta/blob/master/scikit%20linear%20regs.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd ir gy z fp ox fr fs oy fu fw ip bi translated">dehan 97/虚构-嘉年华</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">GitHub是超过5000万开发者的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">github.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg ll os"/></div></div></a></div><p id="5195" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望我能够以这样或那样的方式帮助您学习数据科学方法——如果有，请留下评论！</p><p id="718e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你有问题或者想讨论在后新冠肺炎时代应用数据科学技术的想法，请随时联系我。</p><p id="e405" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是另一篇数据科学文章！</p><div class="op oq gp gr or os"><a href="https://medium.com/python-in-plain-english/ridge-regressions-on-easy-mode-9e7353a0e3f9" rel="noopener follow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd ir gy z fp ox fr fs oy fu fw ip bi translated">简易模式下的岭回归</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">了解岭回归模型背后的理论，如何通过python和scikit-learn对其进行编码和调优。</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">medium.com</p></div></div><div class="pb l"><div class="ph l pd pe pf pb pg ll os"/></div></div></a></div></div></div>    
</body>
</html>