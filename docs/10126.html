<html>
<head>
<title>Machine Learning Basics: Random Forest Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习基础:随机森林回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-basics-random-forest-regression-be3e1e3bb91a?source=collection_archive---------4-----------------------#2020-07-17">https://towardsdatascience.com/machine-learning-basics-random-forest-regression-be3e1e3bb91a?source=collection_archive---------4-----------------------#2020-07-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e73d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习用 Python 构建机器学习中的随机森林回归模型</h2></div><p id="5c52" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">之前，我已经解释了各种回归模型，如线性、多项式、支持向量和决策树回归。在本文中，我们将浏览随机森林回归应用程序的代码，它是对之前实现的<a class="ae le" rel="noopener" target="_blank" href="/machine-learning-basics-decision-tree-regression-1d73ea003fda"> <em class="lf">决策树回归</em> </a>的扩展。</p><h2 id="758f" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">随机森林算法综述</h2><p id="cdd8" class="pw-post-body-paragraph ki kj it kk b kl lz ju kn ko ma jx kq kr mb kt ku kv mc kx ky kz md lb lc ld im bi translated">决策树是一种易于理解和解释的算法，因此单个树可能不足以让模型从中学习特征。另一方面，随机森林也是一种基于“树”的算法，它使用多个决策树的质量特征来进行决策。</p><p id="85fc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，它可以被称为一个<em class="lf">【森林】</em>的树木，因此得名“随机森林”。术语'<em class="lf"> Random </em>是因为这个算法是一个<strong class="kk iu"> <em class="lf">'随机创建的决策树'</em> </strong>的森林。</p><p id="e5ee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">决策树算法的一个主要缺点是它会导致<em class="lf">过拟合</em>。这个问题可以通过用随机森林回归代替决策树回归来解决。此外，与其他回归模型相比，随机森林算法也非常<em class="lf">快速</em>和<em class="lf">稳健</em>。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div class="gh gi me"><img src="../Images/8da957894879a4be836c98a1126b64d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/0*a00NU4E2ueW31mcE.png"/></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">随机森林算法(<a class="ae le" href="https://medium.com/@williamkoehrsen/random-forest-simple-explanation-377895a60d2d" rel="noopener">来源</a>)</p></figure><p id="b468" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">简而言之，随机森林算法合并多个决策树的输出，以生成最终输出。</p><h2 id="892c" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">问题分析</h2><p id="7e97" class="pw-post-body-paragraph ki kj it kk b kl lz ju kn ko ma jx kq kr mb kt ku kv mc kx ky kz md lb lc ld im bi translated">用于<a class="ae le" rel="noopener" target="_blank" href="/machine-learning-basics-decision-tree-regression-1d73ea003fda"> <em class="lf">决策树回归</em> </a>的相同数据集在此使用，我们有一个独立变量<em class="lf">温度</em>和一个独立变量<em class="lf">收入</em>，我们必须预测。在这个问题中，我们必须建立一个随机森林回归模型，该模型将研究冰淇淋店的温度和收入之间的相关性，并根据特定日期的温度预测冰淇淋店的收入。</p><h2 id="4b33" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">步骤 1:导入库</h2><p id="9993" class="pw-post-body-paragraph ki kj it kk b kl lz ju kn ko ma jx kq kr mb kt ku kv mc kx ky kz md lb lc ld im bi translated">照常导入<strong class="kk iu"><em class="lf">NumPy</em></strong><strong class="kk iu"><em class="lf">matplotlib</em></strong>和<strong class="kk iu"> <em class="lf">熊猫库</em> </strong>。</p><pre class="mf mg mh mi gt mq mr ms mt aw mu bi"><span id="da2f" class="lg lh it mr b gy mv mw l mx my">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd</span></pre><h2 id="03e7" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">步骤 2:导入数据集</h2><p id="ed5a" class="pw-post-body-paragraph ki kj it kk b kl lz ju kn ko ma jx kq kr mb kt ku kv mc kx ky kz md lb lc ld im bi translated">使用函数'<em class="lf"> pd.read_csv </em>'从我的 github 存储库中导入数据集。在此，我们将自变量(X)分配给'<em class="lf">温度'</em>列，将因变量(y)分配给'<em class="lf">收入'</em>列。</p><pre class="mf mg mh mi gt mq mr ms mt aw mu bi"><span id="b22c" class="lg lh it mr b gy mv mw l mx my">dataset = pd.read_csv('<a class="ae le" href="https://raw.githubusercontent.com/mk-gurucharan/Regression/master/IceCreamData.csv'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/mk-gurucharan/Regression/master/IceCreamData.csv'</a>)</span><span id="9753" class="lg lh it mr b gy mz mw l mx my">X = dataset['Temperature'].values<br/>y = dataset['Revenue'].values</span><span id="d40c" class="lg lh it mr b gy mz mw l mx my">dataset.head(5)</span><span id="8801" class="lg lh it mr b gy mz mw l mx my">&gt;&gt;</span><span id="8e0c" class="lg lh it mr b gy mz mw l mx my">Temperature   Revenue<br/>24.566884     534.799028<br/>26.005191     625.190122<br/>27.790554     660.632289<br/>20.595335     487.706960<br/>11.503498     316.240194</span></pre><h2 id="c549" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">步骤 3:将数据集分为训练集和测试集</h2><p id="c128" class="pw-post-body-paragraph ki kj it kk b kl lz ju kn ko ma jx kq kr mb kt ku kv mc kx ky kz md lb lc ld im bi translated">类似于决策树回归模型，我们将拆分数据集，我们使用<code class="fe na nb nc mr b">test_size=0.05</code>，这意味着 500 个数据行(<em class="lf"> 25 行</em>)中的 5%将仅用作<em class="lf">测试集</em>，剩余的<em class="lf"> 475 行</em>将用作<em class="lf">训练集</em>，用于构建随机森林回归模型。</p><pre class="mf mg mh mi gt mq mr ms mt aw mu bi"><span id="4746" class="lg lh it mr b gy mv mw l mx my">from sklearn.model_selection import train_test_split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.05)</span></pre><h2 id="1c62" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">步骤 4:在训练集上训练随机森林回归模型</h2><p id="569f" class="pw-post-body-paragraph ki kj it kk b kl lz ju kn ko ma jx kq kr mb kt ku kv mc kx ky kz md lb lc ld im bi translated">在这一步中，为了训练模型，我们导入了<code class="fe na nb nc mr b">RandomForestRegressor</code>类，并将其赋给了变量<code class="fe na nb nc mr b">regressor</code>。然后，我们使用<code class="fe na nb nc mr b">.fit()</code>函数，通过相应地调整回归变量来拟合 X_train 和 y_train 值。</p><pre class="mf mg mh mi gt mq mr ms mt aw mu bi"><span id="86f5" class="lg lh it mr b gy mv mw l mx my"># Fitting Random Forest Regression to the dataset<br/>from sklearn.ensemble import RandomForestRegressor<br/>regressor = RandomForestRegressor(n_estimators = 10, random_state = 0)<br/>regressor.fit(X_train.reshape(-1,1), y_train.reshape(-1,1))</span></pre><h2 id="9e26" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">第五步:预测结果</h2><p id="df4d" class="pw-post-body-paragraph ki kj it kk b kl lz ju kn ko ma jx kq kr mb kt ku kv mc kx ky kz md lb lc ld im bi translated">在这一步中，我们使用<code class="fe na nb nc mr b">regressor.predict</code>函数预测模型在训练集值上训练的测试集的结果，并将其分配给'<strong class="kk iu"> <em class="lf"> y_pred' </em>。</strong></p><pre class="mf mg mh mi gt mq mr ms mt aw mu bi"><span id="cc54" class="lg lh it mr b gy mv mw l mx my">y_pred = regressor.predict(X_test.reshape(-1,1))</span></pre><h2 id="defd" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">步骤 6:将实际值与预测值进行比较</h2><p id="95b3" class="pw-post-body-paragraph ki kj it kk b kl lz ju kn ko ma jx kq kr mb kt ku kv mc kx ky kz md lb lc ld im bi translated">在这一步中，我们将在 Pandas 数据帧中比较并显示 y_test 的值为'<strong class="kk iu">真实值</strong>，y_pred 的值为'<strong class="kk iu">预测值</strong>。</p><pre class="mf mg mh mi gt mq mr ms mt aw mu bi"><span id="726a" class="lg lh it mr b gy mv mw l mx my">df = pd.DataFrame({'Real Values':y_test.reshape(-1), 'Predicted Values':y_pred.reshape(-1)})<br/>df</span><span id="2776" class="lg lh it mr b gy mz mw l mx my">&gt;&gt;<br/>Real Values    Predicted Values<br/>534.622865     510.602018<br/>542.608070     558.764770<br/>618.457277     653.356430<br/>460.402500     449.302331<br/>759.377432     728.037404<br/>631.318237     649.712332<br/>572.672047     583.685756<br/>494.627437     503.075097<br/>250.131728     239.372956<br/>594.651009     635.653662<br/>383.956240     384.531416<br/>491.230603     503.075097<br/>875.019348     933.984685<br/>273.073342     224.659296<br/>500.925064     498.355934<br/>191.623312     193.223331<br/>691.516541     726.817925<br/>421.621505     420.997198<br/>636.298374     653.945550<br/>321.848273     276.772845<br/>283.679657     275.805778<br/>608.936345     589.542982<br/>212.591740     239.372956<br/>594.804871     541.164031<br/>500.065779     524.649546</span></pre><p id="a9d4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从上述值，我们推断该模型能够以良好的准确度预测 y_test 的值，尽管它可以通过调整超参数如<code class="fe na nb nc mr b">n_estimators</code>和<code class="fe na nb nc mr b">max_depth</code>来改进。我把这些参数交给你们来处理，以提高随机森林回归模型的准确性。</p><h2 id="7e09" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">步骤 7:可视化随机森林回归结果</h2><div class="mf mg mh mi gt ab cb"><figure class="nd mj ne nf ng nh ni paragraph-image"><img src="../Images/7e21b366719c0f002afdb128ca95ca0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*u6kgzUMes-70xDEY-trtUw.png"/></figure><figure class="nd mj nj nf ng nh ni paragraph-image"><img src="../Images/2f006c0c5bcd12d9a76d06008e706e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*PjTuVXoaQVGiQPhJ8CqZrQ.png"/><p class="mm mn gj gh gi mo mp bd b be z dk nk di nl nm translated">温度与收入(随机森林回归)</p></figure></div><p id="235e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在该图中，实际值用"<strong class="kk iu"> <em class="lf">、红色</em> </strong>"绘制，预测值用"<strong class="kk iu"> <em class="lf">、绿色</em> </strong>"绘制。决策树回归模型的绘图也是用<strong class="kk iu"> <em class="lf">黑色</em> </strong>颜色绘制的。</p><figure class="mf mg mh mi gt mj"><div class="bz fp l di"><div class="nn no l"/></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">随机森林回归</p></figure><p id="a30a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我附上了我的 github 资源库的链接，你可以在那里找到 Google Colab 笔记本和数据文件供你参考。</p><div class="np nq gp gr nr ns"><a href="https://github.com/mk-gurucharan/Regression" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">MK-guru charan/回归</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">GitHub 是超过 5000 万开发人员的家园，他们一起工作来托管和审查代码、管理项目和构建…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">github.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og mk ns"/></div></div></a></div><p id="6952" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我真的希望我已经用一个例子解释了构建决策树回归模型的 ML 代码。</p><p id="ef90" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您还可以在下面找到该程序对其他回归模型的解释:</p><ul class=""><li id="dbe8" class="oh oi it kk b kl km ko kp kr oj kv ok kz ol ld om on oo op bi translated"><a class="ae le" rel="noopener" target="_blank" href="/machine-learning-basics-simple-linear-regression-bc83c01baa07">简单线性回归</a></li><li id="464d" class="oh oi it kk b kl oq ko or kr os kv ot kz ou ld om on oo op bi translated"><a class="ae le" rel="noopener" target="_blank" href="/machine-learning-basics-multiple-linear-regression-9c70f796e5e3">多元线性回归</a></li><li id="6b70" class="oh oi it kk b kl oq ko or kr os kv ot kz ou ld om on oo op bi translated"><a class="ae le" rel="noopener" target="_blank" href="/machine-learning-basics-polynomial-regression-3f9dd30223d1">多项式回归</a></li><li id="c4f7" class="oh oi it kk b kl oq ko or kr os kv ot kz ou ld om on oo op bi translated"><a class="ae le" rel="noopener" target="_blank" href="/machine-learning-basics-support-vector-regression-660306ac5226">支持向量回归</a></li><li id="fd92" class="oh oi it kk b kl oq ko or kr os kv ot kz ou ld om on oo op bi translated"><a class="ae le" rel="noopener" target="_blank" href="/machine-learning-basics-decision-tree-regression-1d73ea003fda">决策树回归</a></li><li id="72c9" class="oh oi it kk b kl oq ko or kr os kv ot kz ou ld om on oo op bi translated"><a class="ae le" rel="noopener" target="_blank" href="/machine-learning-basics-random-forest-regression-be3e1e3bb91a">随机森林回归</a></li></ul><p id="ddfc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在接下来的文章中，我们将会遇到更复杂的回归、分类和聚类模型。到那时，快乐的机器学习！</p></div></div>    
</body>
</html>