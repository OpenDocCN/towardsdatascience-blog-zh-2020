<html>
<head>
<title>Handtrack.js — let the flames dancing in your hands</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Handtrack.js —让火焰在你手中舞动</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/handtrack-js-let-the-flames-dancing-in-your-hands-77419dca22b6?source=collection_archive---------47-----------------------#2020-05-06">https://towardsdatascience.com/handtrack-js-let-the-flames-dancing-in-your-hands-77419dca22b6?source=collection_archive---------47-----------------------#2020-05-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5d15" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从网络摄像头流中检测手，并将您的手掌放在火上</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2ca3c8101e41e99fa90eb26cddb7b4b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6P9vzRCAb9z65Xg7IlhD-A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://pixabay.com/users/Comfreak-51581/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1947878" rel="noopener ugc nofollow" target="_blank">com break</a>来自<a class="ae ky" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=1947878" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="5caf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">魔术师走上舞台，伸出左手——嗖——一个火球出现了！这是一个你通常在舞台上看到的把戏，但今天我将在你的网络摄像头中向你展示这个魔法，通过手跟踪技术来实现。</p><p id="4bf7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们建立一个网络应用程序，可以从网络摄像头检测手，并把你的手掌着火！打开你的网络摄像头，举起你的手，让火焰在你手中舞动。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/6f2ffb876a757a2444c23ee3d6abd199.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*xCchbj2-hIA4HCrij53gtA.gif"/></div></div></figure><p id="d624" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击下面的链接亲自尝试一下:</p><div class="lw lx gp gr ly lz"><a href="https://bensonruan.com/magic-fire-in-your-hand-with-handtrack-js/" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">handtrack.js - Benson 技术让魔法之火在你手中</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">魔术师走上舞台，伸出左手，嗖的一声，一个火球出现了！那是一个你通常…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">bensonruan.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn ks lz"/></div></div></a></div><p id="c6dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">太酷了，对吧？你玩得开心吗，把这神奇的火给你的朋友看？我希望你喜欢它，这个演示利用了一种叫做手跟踪的先进技术，它可以在图像或视频流中识别人手。</p><p id="214c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢<a class="ae ky" href="https://github.com/victordibia/handtrack.js/" rel="noopener ugc nofollow" target="_blank"> handtrack.js </a>，这是一个很棒的 javascript 库，它使用<a class="ae ky" href="https://www.tensorflow.org/js" rel="noopener ugc nofollow" target="_blank"> TensorFlow.js </a>对象检测 API 来支持浏览器中的手部跟踪。如果你有兴趣构建自己的手部跟踪应用，请在下面跟随我，了解我是如何实现它的。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="cf43" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">履行</h1><h2 id="4351" class="nn mw it bd mx no np dn nb nq nr dp nf li ns nt nh lm nu nv nj lq nw nx nl ny bi translated">#步骤 1:包含 handtrack.js</h2><p id="a5b2" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">首先，简单的在 html 文件的&lt;头&gt;部分包含脚本<code class="fe oe of og oh b">handtrack.js</code>。</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="0dd4" class="nn mw it oh b gy om on l oo op">&lt;script<!-- --> <!-- -->src="<a class="ae ky" href="https://cdn.jsdelivr.net/npm/handtrackjs/dist/handtrack.min.js" rel="noopener ugc nofollow" target="_blank">https://cdn.jsdelivr.net/npm/handtrackjs/dist/handtrack.min.js</a>"&gt; &lt;/script&gt;</span></pre><p id="0201" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者您可以通过 npm 安装它，以便在 TypeScript / ES6 项目中使用</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="cbc3" class="nn mw it oh b gy om on l oo op">npm install --save handtrackjs</span></pre><h2 id="9148" class="nn mw it bd mx no np dn nb nq nr dp nf li ns nt nh lm nu nv nj lq nw nx nl ny bi translated">#步骤 2:将网络摄像头传输到浏览器</h2><p id="fe80" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">为了将您的网络摄像头传输到浏览器中，我使用了 npm JavaScript 模块<code class="fe oe of og oh b">webcam-easy.js</code>，它提供了一个易于使用的模块，可以访问网络摄像头并拍照。要了解更多细节，请参考我之前的博客:</p><div class="lw lx gp gr ly lz"><a href="https://medium.com/swlh/how-to-access-webcam-and-take-picture-with-javascript-b9116a983d78" rel="noopener follow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">如何使用 JavaScript 访问网络摄像头并拍照</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">介绍网络摄像头-简易 npm 模块</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">medium.com</p></div></div><div class="mi l"><div class="oq l mk ml mm mi mn ks lz"/></div></div></a></div><h2 id="f7ff" class="nn mw it bd mx no np dn nb nq nr dp nf li ns nt nh lm nu nv nj lq nw nx nl ny bi translated">#第 3 步:加载扶手模型</h2><p id="78f4" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">为了执行手部跟踪，我们首先需要通过调用<code class="fe oe of og oh b">handTrack.load(modelParams)</code>的 API 来加载预先训练好的手部跟踪模型。HandTrack 带有几个可选的模型参数:</p><ul class=""><li id="288c" class="or os it lb b lc ld lf lg li ot lm ou lq ov lu ow ox oy oz bi translated">flipHorizontal —翻转，例如对于视频，默认值:True</li><li id="f5ce" class="or os it lb b lc pa lf pb li pc lm pd lq pe lu ow ox oy oz bi translated">imageScaleFactor 减小输入图像大小以提高速度，默认值:0.7</li><li id="1037" class="or os it lb b lc pa lf pb li pc lm pd lq pe lu ow ox oy oz bi translated">maxNumBoxes —要检测的最大盒子数，默认值:20</li><li id="a005" class="or os it lb b lc pa lf pb li pc lm pd lq pe lu ow ox oy oz bi translated">iouThreshold —非最大抑制的 ioU 阈值，默认值:0.5</li><li id="b36f" class="or os it lb b lc pa lf pb li pc lm pd lq pe lu ow ox oy oz bi translated">scoreThreshold 预测的置信度阈值，默认值为 0.99</li></ul><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="4542" class="nn mw it oh b gy om on l oo op">const modelParams = {<br/> flipHorizontal: true, <br/> maxNumBoxes: 20, <br/> iouThreshold: 0.5,<br/> scoreThreshold: 0.8<br/>}</span><span id="562b" class="nn mw it oh b gy pf on l oo op"><strong class="oh iu">handTrack.load(modelParams)</strong>.then(mdl =&gt; { <br/> model = mdl;<br/> console.log("model loaded");<br/>});</span></pre><h2 id="e41c" class="nn mw it bd mx no np dn nb nq nr dp nf li ns nt nh lm nu nv nj lq nw nx nl ny bi translated">#步骤 4:手部检测</h2><p id="e66b" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">接下来，我们通过调用<code class="fe oe of og oh b">model.detect(video)</code>的 API，开始通过 HandTrack 模型馈送网络摄像头流来执行手检测。它接受一个输入图像元素(可以是一个<code class="fe oe of og oh b">img</code>、<code class="fe oe of og oh b">video</code>、<code class="fe oe of og oh b">canvas</code>标签)，并返回一个包含类名和可信度的边界框数组。</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="b142" class="nn mw it oh b gy om on l oo op"><strong class="oh iu">model.detect(webcamElement)</strong>.then(predictions =&gt; {<br/> console.log("Predictions: ", predictions);<br/> showFire(predictions);<br/>});</span></pre><p id="0ef7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">预测的返回看起来像:</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="aece" class="nn mw it oh b gy om on l oo op">[{<br/>  bbox: [x, y, width, height],<br/>  class: "hand",<br/>  score: 0.8380282521247864<br/>}, {<br/>  bbox: [x, y, width, height],<br/>  class: "hand",<br/>  score: 0.74644153267145157<br/>}]</span></pre><h2 id="a0f8" class="nn mw it bd mx no np dn nb nq nr dp nf li ns nt nh lm nu nv nj lq nw nx nl ny bi translated">#第五步:展示魔法之火</h2><p id="964b" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">在上面的函数中，我们得到了手的位置的包围盒，现在我们可以用它来显示你手中的火焰 GIF 图像。</p><p id="7471" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="pg"> HTML </em> </strong></p><p id="a64f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe oe of og oh b">webcam</code>元素上叠加<code class="fe oe of og oh b">canvas</code>层</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="1675" class="nn mw it oh b gy om on l oo op">&lt;video<!-- --> <!-- -->id="webcam"<!-- --> <!-- -->autoplay playsinline width="640"<!-- --> <!-- -->height="480"&gt;&lt;/video&gt;</span><span id="d579" class="nn mw it oh b gy pf on l oo op">&lt;div<!-- --> <!-- -->id="canvas"<!-- --> <!-- -->width="640"<!-- --> <!-- -->height="480"&gt;&lt;/div&gt;</span></pre><p id="0b91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="pg"> JavaScript </em> </strong></p><p id="6272" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">设置<code class="fe oe of og oh b">fireElement</code>的大小和位置，并将其添加到<code class="fe oe of og oh b">canvas</code>层。</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="367c" class="nn mw it oh b gy om on l oo op">function showFire(predictions){<br/>    if(handCount != predictions.length){<br/>        $("#canvas").empty();<br/>        fireElements = [];<br/>    }   <br/>    handCount = predictions.length;<br/> <br/>    for (let i = 0; i &lt; predictions.length; i++) {<br/>        if (fireElements.length &gt; i) { <br/>            fireElement = fireElements[i];<br/>        }else{<br/>            <strong class="oh iu">fireElement = $("&lt;div class='fire_in_hand'&gt;&lt;/div&gt;");<br/>            fireElements.push(fireElement);<br/>            fireElement.appendTo($("#canvas"));</strong><br/>        }<br/>        var fireSizeWidth = fireElement.css("width").replace("px","");<br/>        var fireSizeHeight = fireElement.css("height").replace("px","");<br/>        var firePositionTop = hand_center_point[0]- fireSizeHeight;<br/>        var firePositionLeft = hand_center_point[1] - fireSizeWidth/2;<br/>        <strong class="oh iu">fireElement.css({top: firePositionTop, left: firePositionLeft, position:'absolute'});</strong><br/>    }<br/>}</span></pre><p id="b5d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> <em class="pg"> CSS </em> </strong></p><p id="47c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将<code class="fe oe of og oh b">background-image</code>设置为<code class="fe oe of og oh b">fire.gif</code>图像</p><pre class="kj kk kl km gt oi oh oj ok aw ol bi"><span id="7421" class="nn mw it oh b gy om on l oo op">.fire_in_hand {<br/>    width: 300px;<br/>    height: 300px;<br/>    <strong class="oh iu">background-image: url(../images/fire.gif);</strong><br/>    background-position: center center;<br/>    background-repeat: no-repeat;<br/>    background-size: cover;<br/>}</span></pre><p id="117b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码就这么多了！现在你应该可以开始展示你手中的魔法之火了！</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="a213" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">GitHub 知识库</h1><p id="3b31" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">您可以通过下面的链接下载上述演示的完整代码:</p><div class="lw lx gp gr ly lz"><a href="https://github.com/bensonruan/Hand-Track" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">本森阮/手动轨道</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">在浏览器中使用 javascript 库 handtrack.js 流网络摄像头在台式计算机上从网络摄像头进行手部跟踪，或者…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">github.com</p></div></div><div class="mi l"><div class="ph l mk ml mm mi mn ks lz"/></div></div></a></div><p id="8eff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果你喜欢这篇文章，请在脸书或推特上分享。如果你有任何问题，请在评论中告诉我。在<a class="ae ky" href="https://github.com/bensonruan/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>和<a class="ae ky" href="https://www.linkedin.com/in/benson-ruan/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>上关注我。</p></div></div>    
</body>
</html>