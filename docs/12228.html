<html>
<head>
<title>Drug Discovery with Graph Neural Networks — part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图形神经网络药物发现—第二部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/drug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4?source=collection_archive---------30-----------------------#2020-08-23">https://towardsdatascience.com/drug-discovery-with-graph-neural-networks-part-2-b1b8d60180c4?source=collection_archive---------30-----------------------#2020-08-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="a039" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">预测毒性</h2><div class=""/><div class=""><h2 id="afaf" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">了解如何使用 Deepchem(生命科学的深度学习库)预测 GNNs 的毒性。</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/a239a6a1e58603db883b8092d0b667c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kPfJJ4tUoXITWcwX"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">马修·T·雷德在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h2 id="d933" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">相关材料</h2><ul class=""><li id="adf3" class="md me it mf b mg mh mi mj lr mk lv ml lz mm mn mo mp mq mr bi translated"><a class="ae lh" href="https://github.com/KacperKubara/ml-cookbook/blob/master/drug_discovery_with_gnns/toxicity.ipynb" rel="noopener ugc nofollow" target="_blank">朱庇特笔记本作文章</a></li><li id="54c8" class="md me it mf b mg ms mi mt lr mu lv mv lz mw mn mo mp mq mr bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/drug-discovery-with-graph-neural-networks-part-1-1011713185eb">用图形神经网络发现药物—第一部分</a></li><li id="9bd8" class="md me it mf b mg ms mi mt lr mu lv mv lz mw mn mo mp mq mr bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/drug-discovery-with-graph-neural-networks-part-3-c0c13e3e3f6d">利用图形神经网络进行药物发现—第三部分</a></li><li id="6d4e" class="md me it mf b mg ms mi mt lr mu lv mv lz mw mn mo mp mq mr bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/introduction-to-cheminformatics-7241de2fe5a8">化学信息学简介</a></li><li id="5edc" class="md me it mf b mg ms mi mt lr mu lv mv lz mw mn mo mp mq mr bi translated"><a class="ae lh" href="https://medium.com/me/stats/post/625f4c5fb8cd" rel="noopener">图形的特征提取</a></li><li id="94c2" class="md me it mf b mg ms mi mt lr mu lv mv lz mw mn mo mp mq mr bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/towards-explainable-graph-neural-networks-45f5e3912dd0">走向可解释图神经网络</a></li><li id="fbbc" class="md me it mf b mg ms mi mt lr mu lv mv lz mw mn mo mp mq mr bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/machine-learning-tasks-on-graphs-7bc8f175119a">图上的机器学习任务</a></li></ul><h2 id="98e5" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">目录</h2><ul class=""><li id="f962" class="md me it mf b mg mh mi mj lr mk lv ml lz mm mn mo mp mq mr bi translated">介绍</li><li id="cba7" class="md me it mf b mg ms mi mt lr mu lv mv lz mw mn mo mp mq mr bi translated">用图形神经网络解决问题</li><li id="6869" class="md me it mf b mg ms mi mt lr mu lv mv lz mw mn mo mp mq mr bi translated">Deepchem 的实际操作部分</li><li id="c189" class="md me it mf b mg ms mi mt lr mu lv mv lz mw mn mo mp mq mr bi translated">关于我</li><li id="f871" class="md me it mf b mg ms mi mt lr mu lv mv lz mw mn mo mp mq mr bi translated">参考</li></ul><h1 id="dce3" class="mx lj it bd lk my mz na ln nb nc nd lq ki ne kj lu kl nf km ly ko ng kp mc nh bi translated">介绍</h1><p id="ddab" class="pw-post-body-paragraph ni nj it mf b mg mh kd nk mi mj kg nl lr nm nn no lv np nq nr lz ns nt nu mn im bi translated">在本文中，我们将涵盖另一个决定药物能否通过安全性测试的关键因素— <strong class="mf jd">毒性</strong>。事实上，毒性占被拒绝的候选药物的 30%，使其成为药物开发阶段考虑的最重要因素之一[1]。机器学习在这里将被证明是非常有益的，因为它可以在药物发现过程的早期阶段筛选出有毒的候选药物。</p><p id="250f" class="pw-post-body-paragraph ni nj it mf b mg nv kd nk mi nw kg nl lr nx nn no lv ny nq nr lz nz nt nu mn im bi translated">我假设你已经阅读了我的上一篇文章，它解释了我将在这篇文章中使用的一些主题和术语:)让我们开始吧！</p><h1 id="5db5" class="mx lj it bd lk my mz na ln nb nc nd lq ki ne kj lu kl nf km ly ko ng kp mc nh bi translated">用图形神经网络解决问题</h1><p id="c2d1" class="pw-post-body-paragraph ni nj it mf b mg mh kd nk mi mj kg nl lr nm nn no lv np nq nr lz ns nt nu mn im bi translated">特征工程部分与本系列的第 1 部分中的<a class="ae lh" href="https://medium.com/me/stats/post/1011713185eb" rel="noopener">非常相似。为了将分子结构转换为 GNNs 的输入，我们可以创建分子指纹，或者使用邻接矩阵和特征向量将其输入到图形神经网络中。这个特性可以由外部软件自动生成，如 RDKit 或 Deepchem，所以我们不必太担心它。</a></p><h2 id="a252" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">毒性</h2><p id="699d" class="pw-post-body-paragraph ni nj it mf b mg mh kd nk mi mj kg nl lr nm nn no lv np nq nr lz ns nt nu mn im bi translated">最大的区别在于机器学习任务本身。毒性预测是一项<strong class="mf jd">分类</strong>任务，与溶解度预测相反，溶解度预测是一项回归任务，我们可能还记得上一篇文章。有许多不同的毒性效应，如致癌性、呼吸毒性、刺激/腐蚀等[2]。这使得工作变得稍微复杂了一些，因为我们可能还要处理不平衡的班级。</p><p id="4f1b" class="pw-post-body-paragraph ni nj it mf b mg nv kd nk mi nw kg nl lr nx nn no lv ny nq nr lz nz nt nu mn im bi translated">幸运的是，毒性数据集通常比溶解度数据集大得多。例如，当用于溶解度预测的 Delaney 数据集只有大约 3k 训练样本时，Tox21 数据集具有大约 12k 训练样本。这使得神经网络架构成为一种更有前途的方法，因为它可以捕捉更多隐藏的信息。</p><h2 id="032a" class="li lj it bd lk ll lm dn ln lo lp dp lq lr ls lt lu lv lw lx ly lz ma mb mc iz bi translated">Tox21 数据集</h2><p id="4480" class="pw-post-body-paragraph ni nj it mf b mg mh kd nk mi mj kg nl lr nm nn no lv np nq nr lz ns nt nu mn im bi translated"><a class="ae lh" href="https://tripod.nih.gov/tox21/challenge/about.jsp" rel="noopener ugc nofollow" target="_blank"> Tox21 数据集</a>是作为一个项目创建的，该项目挑战研究人员开发机器学习模型，以在给定数据上实现最高性能。它包含 12 种不同的标签，每一种都表示不同的毒性效应。总体而言，该数据集有 12，060 个训练样本和 647 个测试样本。</p><p id="f0fc" class="pw-post-body-paragraph ni nj it mf b mg nv kd nk mi nw kg nl lr nx nn no lv ny nq nr lz nz nt nu mn im bi translated">这一挑战的获胜方法是 DeepTox [3],这是一种深度学习管道，利用化学描述符来预测毒性类别。它高度表明深度学习是最有效的方法，图形神经网络有潜力实现更高的性能。</p><h1 id="c36d" class="mx lj it bd lk my mz na ln nb nc nd lq ki ne kj lu kl nf km ly ko ng kp mc nh bi translated">Deepchem 的实际操作部分</h1><p id="31f2" class="pw-post-body-paragraph ni nj it mf b mg mh kd nk mi mj kg nl lr nm nn no lv np nq nr lz ns nt nu mn im bi translated"><a class="ae lh" href="https://github.com/KacperKubara/ml-cookbook/blob/master/drug_discovery_with_gnns/toxicity.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="oa">可以自己跑的 Colab 笔记本来了。</em> </a></p><p id="2574" class="pw-post-body-paragraph ni nj it mf b mg nv kd nk mi nw kg nl lr nx nn no lv ny nq nr lz nz nt nu mn im bi translated">首先，我们导入必要的库。<em class="oa">这里没有什么新东西</em> —我们将使用 Deepchem 根据 Tox21 数据训练一个 GNN 模型。GraphConvModel 是由 Duvenaud 等人创建的架构。它使用指纹算法的修改版本，使它们具有可区分性(因此我们可以进行梯度更新)。这是第一个 GNN 体系结构，被设计用来处理图形的分子结构。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="07e6" class="pw-post-body-paragraph ni nj it mf b mg nv kd nk mi nw kg nl lr nx nn no lv ny nq nr lz nz nt nu mn im bi translated">Deepchem 包含了一个方便的 API 来为我们加载 Tox21。<em class="oa"> load_tox21 </em>功能。我们选择一个特征器作为<em class="oa"> GraphConv </em> —它将创建化学描述符(即特征)来匹配我们模型的输入要求。由于这是一项分类任务，ROC AUC 分数将被用作一项指标。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="7102" class="pw-post-body-paragraph ni nj it mf b mg nv kd nk mi nw kg nl lr nx nn no lv ny nq nr lz nz nt nu mn im bi translated">Deepchem 的美妙之处在于模型使用了类似 Keras 的 API。我们可以用。<em class="oa">拟合</em>函数。我们将<em class="oa"> len(tox21_tasks) </em>传递给模型的参数<em class="oa">、</em>，这是一些标签(本例中是 12 个)。这将设置最终层的输出大小为 12。我们使用 32 的批量大小来加快计算时间，并指定模型用于分类任务。该模型需要几分钟时间在 Google Colab 笔记本上进行训练。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="4c57" class="pw-post-body-paragraph ni nj it mf b mg nv kd nk mi nw kg nl lr nx nn no lv ny nq nr lz nz nt nu mn im bi translated">训练完成后，我们可以评估模型。这一点也不难——我们仍然可以使用 Keras API 来完成这一部分。ROC AUC 分数通过<em class="oa">获得。评估</em>功能。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="20f0" class="pw-post-body-paragraph ni nj it mf b mg nv kd nk mi nw kg nl lr nx nn no lv ny nq nr lz nz nt nu mn im bi translated">在我的病例中，训练 ROC AUC 得分高于验证 ROC AUC 得分。这可能表明模型对某些分子过度拟合。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi od"><img src="../Images/669f21eec19e1a51bb9781f594b0d79a.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*2VuauLiO0Q1-s157J0aCnw.png"/></div></figure><p id="5c44" class="pw-post-body-paragraph ni nj it mf b mg nv kd nk mi nw kg nl lr nx nn no lv ny nq nr lz nz nt nu mn im bi translated">你可以用 Deepchem 做更多的事情。它包含几个不同的 GNN 模型，像本教程一样易于使用。我强烈建议看看他们的教程。对于毒性任务，他们收集了几个用不同模型运行的不同例子。你可以在这里找到<a class="ae lh" href="https://github.com/deepchem/deepchem/tree/master/examples/tox21" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><p id="eafa" class="pw-post-body-paragraph ni nj it mf b mg nv kd nk mi nw kg nl lr nx nn no lv ny nq nr lz nz nt nu mn im bi translated"><em class="oa">感谢您阅读本文，希望对您有用！</em></p><h1 id="8a6c" class="mx lj it bd lk my mz na ln nb nc nd lq ki ne kj lu kl nf km ly ko ng kp mc nh bi translated">关于我</h1><p id="c792" class="pw-post-body-paragraph ni nj it mf b mg mh kd nk mi mj kg nl lr nm nn no lv np nq nr lz ns nt nu mn im bi translated">我是阿姆斯特丹大学的人工智能硕士学生。在我的业余时间，你可以发现我摆弄数据或者调试我的深度学习模型(我发誓这很有效！).我也喜欢徒步旅行:)</p><p id="cd1f" class="pw-post-body-paragraph ni nj it mf b mg nv kd nk mi nw kg nl lr nx nn no lv ny nq nr lz nz nt nu mn im bi translated">如果你想了解我的最新文章和其他有用的内容，以下是我的社交媒体资料:</p><ul class=""><li id="8bd5" class="md me it mf b mg nv mi nw lr ol lv om lz on mn mo mp mq mr bi translated"><a class="ae lh" href="https://medium.com/@kacperkubara" rel="noopener">中等</a></li><li id="1340" class="md me it mf b mg ms mi mt lr mu lv mv lz mw mn mo mp mq mr bi translated"><a class="ae lh" href="https://www.linkedin.com/in/kacperkubara/" rel="noopener ugc nofollow" target="_blank">领英</a></li><li id="e565" class="md me it mf b mg ms mi mt lr mu lv mv lz mw mn mo mp mq mr bi translated"><a class="ae lh" href="https://github.com/KacperKubara" rel="noopener ugc nofollow" target="_blank"> Github </a></li><li id="c7b9" class="md me it mf b mg ms mi mt lr mu lv mv lz mw mn mo mp mq mr bi translated"><a class="ae lh" href="https://kacperkubara.com/" rel="noopener ugc nofollow" target="_blank">个人网站</a></li></ul><h1 id="3ec3" class="mx lj it bd lk my mz na ln nb nc nd lq ki ne kj lu kl nf km ly ko ng kp mc nh bi translated">参考</h1><p id="79c2" class="pw-post-body-paragraph ni nj it mf b mg mh kd nk mi mj kg nl lr nm nn no lv np nq nr lz ns nt nu mn im bi translated"><strong class="mf jd">【1】“制药业能降低流失率吗？”:【https://pubmed.ncbi.nlm.nih.gov/15286737/<a class="ae lh" href="https://pubmed.ncbi.nlm.nih.gov/15286737/" rel="noopener ugc nofollow" target="_blank">T21</a></strong></p><p id="ab75" class="pw-post-body-paragraph ni nj it mf b mg nv kd nk mi nw kg nl lr nx nn no lv ny nq nr lz nz nt nu mn im bi translated"><strong class="mf jd">【2】“使用机器学习方法和结构警报对药物设计的化学毒性进行计算机预测”:</strong><a class="ae lh" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5826228/" rel="noopener ugc nofollow" target="_blank">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5826228/</a></p><p id="87dd" class="pw-post-body-paragraph ni nj it mf b mg nv kd nk mi nw kg nl lr nx nn no lv ny nq nr lz nz nt nu mn im bi translated"><strong class="mf jd">【3】Deep tox:利用深度学习进行毒性预测:</strong><a class="ae lh" href="https://www.frontiersin.org/articles/10.3389/fenvs.2015.00080/full" rel="noopener ugc nofollow" target="_blank">https://www . frontier sin . org/articles/10.3389/fenvs . 2015.00080/full</a></p></div></div>    
</body>
</html>