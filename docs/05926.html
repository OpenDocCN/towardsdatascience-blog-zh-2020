<html>
<head>
<title>Build a Simple Neural Network using Numpy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ Numpy æ„å»ºä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/build-a-simple-neural-network-using-numpy-2add9aad6fc8?source=collection_archive---------19-----------------------#2020-05-15">https://towardsdatascience.com/build-a-simple-neural-network-using-numpy-2add9aad6fc8?source=collection_archive---------19-----------------------#2020-05-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9c25" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">ä½¿ç”¨ NumPy æ„å»ºå•ä¸ªç¥ç»å…ƒè¿›è¡Œå›¾åƒåˆ†ç±»ã€‚</h2></div><p id="29a9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•ä½¿ç”¨ NumPy åˆ¶ä½œä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œã€‚</p><ol class=""><li id="eaa7" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated"><strong class="kk iu">å¯¼å…¥åº“</strong></li></ol><p id="2f41" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å°†å¯¼å…¥æ‰€æœ‰æˆ‘ä»¬éœ€è¦çš„åŒ…ã€‚æˆ‘ä»¬å°†éœ€è¦<strong class="kk iu"> <em class="ln"> numpy </em> </strong>ï¼Œ<strong class="kk iu"> <em class="ln"> h5py </em> </strong>(ç”¨äºåŠ è½½å­˜å‚¨åœ¨ H5 æ–‡ä»¶ä¸­çš„æ•°æ®é›†)ï¼Œä»¥åŠ<strong class="kk iu"> <em class="ln"> matplotlib </em> </strong>(ç”¨äºç»˜å›¾)ã€‚</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="1b3b" class="lx ly it lt b gy lz ma l mb mc"><strong class="lt iu">import</strong> numpy as np<br/><strong class="lt iu">import</strong> matplotlib.pyplot as plt<br/><strong class="lt iu">import</strong> h5py</span></pre><p id="fc07" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 2ã€‚æ•°æ®å‡†å¤‡</strong></p><p id="cdbd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ•°æ®ä»¥(" . h5 ")æ ¼å¼æä¾›ï¼ŒåŒ…å«æ ‡è®°ä¸º cat æˆ–é cat çš„è®­ç»ƒå’Œæµ‹è¯•å›¾åƒé›†ã€‚è¯¥æ•°æ®é›†å¯ä»<a class="ae md" href="https://rpaudel42.github.io/datasets/NN.zip" rel="noopener ugc nofollow" target="_blank"> github repo </a>ä¸‹è½½ã€‚ä½¿ç”¨ä»¥ä¸‹å‡½æ•°åŠ è½½æ•°æ®é›†:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="3773" class="lx ly it lt b gy lz ma l mb mc"><strong class="lt iu">def</strong> <strong class="lt iu">load_dataset</strong>():<br/>    train_dataset = h5py.File('datasets/train_catvnoncat.h5', "r")<br/>    train_x = np.array(train_dataset["train_set_x"][:]) <br/>    train_y = np.array(train_dataset["train_set_y"][:])</span><span id="23d7" class="lx ly it lt b gy me ma l mb mc">test_dataset = h5py.File('datasets/test_catvnoncat.h5', "r")<br/>    test_x = np.array(test_dataset["test_set_x"][:]) <br/>    test_y = np.array(test_dataset["test_set_y"][:])</span><span id="281b" class="lx ly it lt b gy me ma l mb mc">classes = np.array(test_dataset["list_classes"][:]) <br/>    <br/>    train_y = train_y.reshape((1, train_y.shape[0]))<br/>    test_y = test_y.reshape((1, test_y.shape[0]))<br/>    <br/>    return train_x, train_y, test_x, test_y, classes</span></pre><p id="39c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å¯ä»¥é€šè¿‡è§‚å¯Ÿå®ƒä»¬çš„å½¢çŠ¶æ¥åˆ†ææ•°æ®ã€‚</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="51d9" class="lx ly it lt b gy lz ma l mb mc">train_x, train_y, test_x, test_y, classes = load_dataset()</span><span id="4210" class="lx ly it lt b gy me ma l mb mc">print ("Train X shape: " + str(train_x.shape))<br/>print ("Train Y shape: " + str(train_y.shape))</span><span id="b6e5" class="lx ly it lt b gy me ma l mb mc">print ("Test X shape: " + str(test_x.shape))<br/>print ("Test Y shape: " + str(test_y.shape))</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mf"><img src="../Images/03b8b05b1d88a832409a4194c420d1df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oS7fG5w2KTDBxACQVytC3Q.png"/></div></div></figure><p id="7a26" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬æœ‰ 209 ä¸ªè®­ç»ƒå›¾åƒï¼Œå…¶ä¸­æ¯ä¸ªå›¾åƒæ˜¯æ­£æ–¹å½¢(é«˜åº¦= 64px)å’Œ(å®½åº¦= 64px)ä¸”å…·æœ‰ 3 ä¸ªé€šé“(RGB)ã€‚ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬æœ‰ 50 ä¸ªç›¸åŒç»´åº¦çš„æµ‹è¯•å›¾åƒã€‚</p><p id="1e55" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸‹è¿™ä¸ªå›¾åƒã€‚æ‚¨å¯ä»¥æ›´æ”¹ç´¢å¼•æ¥æŸ¥çœ‹ä¸åŒçš„å›¾åƒã€‚</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="2ca8" class="lx ly it lt b gy lz ma l mb mc"><em class="ln"># change index for another image</em><br/>index = 2<br/>plt.imshow(train_x[index])</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mf"><img src="../Images/9a5e9bf2484704a6df9e994a4042e75d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_gQh4NsUY2YBQDDEvjXapA.png"/></div></div></figure><p id="5570" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">æ•°æ®é¢„å¤„ç†:</strong>å›¾åƒæ•°æ®å¸¸è§çš„æ•°æ®é¢„å¤„ç†åŒ…æ‹¬:</p><ol class=""><li id="7448" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated">ç®—å‡ºæ•°æ®çš„ç»´åº¦å’Œå½¢çŠ¶(m_trainï¼Œm_testï¼Œnum_pxï¼Œâ€¦)</li><li id="2047" class="le lf it kk b kl mn ko mo kr mp kv mq kz mr ld lj lk ll lm bi translated">é‡å¡‘æ•°æ®é›†ï¼Œä½¿æ¯ä¸ªç¤ºä¾‹ç°åœ¨éƒ½æ˜¯ä¸€ä¸ªå¤§å°ä¸º(é«˜åº¦*å®½åº¦*é€šé“ï¼Œ1)çš„å‘é‡</li><li id="42a1" class="le lf it kk b kl mn ko mo kr mp kv mq kz mr ld lj lk ll lm bi translated">å°†æ•°æ®â€œæ ‡å‡†åŒ–â€</li></ol><p id="6503" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä½¿å›¾åƒå˜å¹³ã€‚è¿™å¯ä»¥é€šè¿‡åœ¨å½¢çŠ¶çš„ numpy æ•°ç»„(é«˜åº¦Ã·å®½åº¦Ã·é€šé“ï¼Œ1)ä¸­é‡å¡‘å½¢çŠ¶(é«˜åº¦ã€å®½åº¦ã€é€šé“)çš„å›¾åƒæ¥å®Œæˆã€‚</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="8efc" class="lx ly it lt b gy lz ma l mb mc">train_x = train_x.reshape(train_x.shape[0], -1).T<br/>test_x = test_x.reshape(test_x.shape[0], -1).T</span><span id="5904" class="lx ly it lt b gy me ma l mb mc">print ("Train X shape: " + str(train_x.shape))<br/>print ("Train Y shape: " + str(train_y.shape))</span><span id="ae75" class="lx ly it lt b gy me ma l mb mc">print ("Test X shape: " + str(test_x.shape))<br/>print ("Test Y shape: " + str(test_y.shape))</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi ms"><img src="../Images/4bea498d623dbce5181088052aa61f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AaL3VP_3_fbxXW9Kg9uVFA.png"/></div></div></figure><p id="e831" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">æ ‡å‡†åŒ–æ•°æ®:</strong>æœºå™¨å­¦ä¹ ä¸­å¸¸è§çš„é¢„å¤„ç†æ­¥éª¤æ˜¯å¯¹æ•°æ®é›†è¿›è¡Œå±…ä¸­å’Œæ ‡å‡†åŒ–ã€‚å¯¹äºç»™å®šçš„å›¾ç‰‡æ•°æ®é›†ï¼Œå¯ä»¥é€šè¿‡å°†æ•°æ®é›†çš„æ¯ä¸€è¡Œé™¤ä»¥ 255(åƒç´ é€šé“çš„æœ€å¤§å€¼)æ¥å®Œæˆã€‚</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="a8a5" class="lx ly it lt b gy lz ma l mb mc">train_x = train_x/255.<br/>test_x = test_x/255.</span></pre><p id="8d24" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç°åœ¨æˆ‘ä»¬å°†å»ºç«‹ä¸€ä¸ªç®€å•çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå®ƒå¯ä»¥æ­£ç¡®åœ°å°†å›¾ç‰‡åˆ†ç±»ä¸ºçŒ«æˆ–éçŒ«ã€‚</p><h2 id="47a2" class="lx ly it bd mt mu mv dn mw mx my dp mz kr na nb nc kv nd ne nf kz ng nh ni nj bi translated">3.ç¥ç»ç½‘ç»œæ¨¡å‹</h2><p id="10a4" class="pw-post-body-paragraph ki kj it kk b kl nk ju kn ko nl jx kq kr nm kt ku kv nn kx ky kz no lb lc ld im bi translated">æˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi np"><img src="../Images/45405cf2dab2efa59db225c39788e997.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jzKGLRTLPElYP3DTMgDlzw.png"/></div></div></figure><p id="7a17" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">å…³é”®æ­¥éª¤</strong>:æ„å»ºç¥ç»ç½‘ç»œçš„ä¸»è¦æ­¥éª¤æœ‰:</p><ol class=""><li id="49c4" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated">å®šä¹‰æ¨¡å‹ç»“æ„(å¦‚è¾“å…¥ç‰¹å¾æ•°é‡ã€è¾“å‡ºæ•°é‡ç­‰)ã€‚)</li><li id="420f" class="le lf it kk b kl mn ko mo kr mp kv mq kz mr ld lj lk ll lm bi translated">åˆå§‹åŒ–æ¨¡å‹çš„å‚æ•°(æƒé‡å’Œåå·®)</li><li id="b910" class="le lf it kk b kl mn ko mo kr mp kv mq kz mr ld lj lk ll lm bi translated">å¾ªç¯:</li></ol><ul class=""><li id="dbe9" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld nq lk ll lm bi translated">è®¡ç®—ç”µæµæŸè€—(æ­£å‘ä¼ æ’­)</li><li id="5f60" class="le lf it kk b kl mn ko mo kr mp kv mq kz mr ld nq lk ll lm bi translated">è®¡ç®—ç”µæµæ¢¯åº¦(åå‘ä¼ æ’­)</li><li id="07cd" class="le lf it kk b kl mn ko mo kr mp kv mq kz mr ld nq lk ll lm bi translated">æ›´æ–°å‚æ•°(æ¢¯åº¦ä¸‹é™)</li></ul><p id="ccd4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 3.1 æ¿€æ´»åŠŸèƒ½</strong></p><p id="a1c1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">sigmoid æ¿€æ´»å‡½æ•°ç”±ä¸‹å¼ç»™å‡º</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/c3b5fe32ff9ab2bcf5d3cf7f90c7c9ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:872/format:webp/1*sF8pcVKFObMog1vOiDsVVg.png"/></div></figure><p id="e5a4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¯ä»¥ä½¿ç”¨<em class="ln"> np.exp()è®¡ç®— sigmoid æ¿€æ´»å‡½æ•°ã€‚</em></p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="5ac6" class="lx ly it lt b gy lz ma l mb mc">def <strong class="lt iu">sigmoid</strong>(z):<br/>    return 1/(1+np.exp(-z))</span></pre><p id="966b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 3.2 åˆå§‹åŒ–å‚æ•°</strong></p><p id="679b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬éœ€è¦åˆå§‹åŒ–å‚æ•°ğ‘¤(æƒé‡)å’Œğ‘(åå·®)ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œğ‘¤ä½¿ç”¨<em class="ln"> np.random.randn() </em>åˆå§‹åŒ–ä¸ºä¸€ä¸ªéšæœºæ•°å‘é‡ï¼Œè€Œğ‘åˆå§‹åŒ–ä¸ºé›¶ã€‚</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="2dee" class="lx ly it lt b gy lz ma l mb mc">def <strong class="lt iu">initialize_parameters</strong>(dim):<br/>    w = np.random.randn(dim, 1)*0.01<br/>    b = 0<br/>    return w, b</span></pre><p id="2056" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 3.3 æ­£å‘å’Œåå‘ä¼ æ’­</strong></p><p id="7f9b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä¸€æ—¦å‚æ•°è¢«åˆå§‹åŒ–ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œâ€œå‘å‰â€å’Œâ€œå‘åâ€ä¼ æ’­æ­¥éª¤æ¥å­¦ä¹ å‚æ•°ã€‚</p><ul class=""><li id="9779" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld nq lk ll lm bi translated">ç»™å®šä¸€ç»„è¾“å…¥ç‰¹å¾(X)ã€‚</li><li id="8e53" class="le lf it kk b kl mn ko mo kr mp kv mq kz mr ld nq lk ll lm bi translated">æˆ‘ä»¬å°†å¦‚ä¸‹è®¡ç®—æ¿€æ´»å‡½æ•°ã€‚</li></ul><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/0134f86a9a8a41c0bccfafd1ab282bb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*Bf5JXOKQtpBgadTcw_LJRw.png"/></div></figure><ul class=""><li id="e470" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld nq lk ll lm bi translated">æˆ‘ä»¬å°†æŒ‰å¦‚ä¸‹æ–¹å¼è®¡ç®—æˆæœ¬ã€‚</li></ul><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/bbbb961647110ba6c5429462e47300e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*4P8h6_6HGaOjK-bh4k9hFA.png"/></div></figure><ul class=""><li id="e887" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld nq lk ll lm bi translated">æœ€åï¼Œæˆ‘ä»¬å°†å¦‚ä¸‹è®¡ç®—æ¢¯åº¦(åå‘ä¼ æ’­)ã€‚</li></ul><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/e6b2ef824a5a2464a9c5dbeca28ac495.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*jqxgWMA6j5ABzddUpw5gDQ.png"/></div></figure><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="d417" class="lx ly it lt b gy lz ma l mb mc">def <strong class="lt iu">propagate</strong>(w, b, X, Y):<br/>    m = X.shape[1]<br/>    <br/>    #calculate activation function<br/>    A = <strong class="lt iu">sigmoid</strong>(np.dot(w.T, X)+b)</span><span id="571c" class="lx ly it lt b gy me ma l mb mc">    #find the cost<br/>    cost = (-1/m) * np.sum(Y * np.log(A) + (1 - Y) * (np.log(1 - A)))  <br/>    #find gradient (back propagation)<br/>    dw = (1/m) * np.dot(X, (A-Y).T)<br/>    db = (1/m) * np.sum(A-Y)</span><span id="a3ae" class="lx ly it lt b gy me ma l mb mc">    cost = np.squeeze(cost)<br/>    grads = {"dw": dw,<br/>             "db": db} <br/>    return grads, cost</span></pre><p id="196a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 3.4 ä¼˜åŒ–</strong></p><p id="12d0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åœ¨åˆå§‹åŒ–å‚æ•°ã€è®¡ç®—æˆæœ¬å‡½æ•°å’Œè®¡ç®—æ¢¯åº¦ä¹‹åï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ¥æ›´æ–°å‚æ•°ã€‚</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="19ec" class="lx ly it lt b gy lz ma l mb mc">def <strong class="lt iu">gradient_descent</strong>(w, b, X, Y, iterations, learning_rate):<br/>    costs = []<br/>    for i in range(iterations):<br/>        grads, cost = propagate(w, b, X, Y)<br/>        <br/>        #update parameters<br/>        w = w - learning_rate * grads["dw"]<br/>        b = b - learning_rate * grads["db"]<br/>        costs.append(cost)<br/>        if i % 500 == 0:<br/>            print ("Cost after iteration %i: %f" %(i, cost))<br/>    <br/>    params = {"w": w,<br/>              "b": b}    <br/>    return params, costs</span></pre><p id="b450" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 3.5 é¢„æµ‹</strong></p><p id="ee94" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä½¿ç”¨å­¦ä¹ åˆ°çš„å‚æ•°<em class="ln"> w </em>å’Œ<em class="ln"> bï¼Œ</em>æˆ‘ä»¬å¯ä»¥é¢„æµ‹è®­ç»ƒæˆ–æµ‹è¯•ç¤ºä¾‹çš„æ ‡ç­¾ã€‚ä¸ºäº†é¢„æµ‹ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦è®¡ç®—å¦‚ä¸‹ç»™å‡ºçš„æ¿€æ´»å‡½æ•°ã€‚</p><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/5594cf25a8a64962768252f347860047.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*Z9IUuHJO7L117awisWGuFw.png"/></div></figure><p id="b346" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç„¶åå°†è¾“å‡º(é¢„æµ‹)è½¬æ¢æˆ 0(if<strong class="kk iu"><em class="ln">A</em></strong>&lt;= 0.5)æˆ– 1(if<strong class="kk iu"><em class="ln">A</em></strong>&gt;0.5)å­˜å‚¨åœ¨<em class="ln"> y_pred </em>ä¸­ã€‚</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="10ff" class="lx ly it lt b gy lz ma l mb mc">def <strong class="lt iu">predict</strong>(w, b, X):    <br/>    # number of example<br/>    m = X.shape[1]<br/>    y_pred = np.zeros((1,m))<br/>    w = w.reshape(X.shape[0], 1)<br/>    <br/>    A = sigmoid(np.dot(w.T, X)+b)<br/>    <br/>    for i in range(A.shape[1]):<br/>        y_pred[0,i] = 1 if A[0,i] &gt;0.5 else 0 <br/>        pass<br/>    return y_pred</span></pre><p id="b9f6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.6 æœ€ç»ˆæ¨¡å‹</p><p id="bb1b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å¯ä»¥æŒ‰æ­£ç¡®çš„é¡ºåºæŠŠæ‰€æœ‰çš„æ„ä»¶æ”¾åœ¨ä¸€èµ·ï¼Œåˆ¶ä½œä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹ã€‚</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="14c8" class="lx ly it lt b gy lz ma l mb mc">def <strong class="lt iu">model</strong>(train_x, train_y, test_x, test_y, iterations, learning_rate):<br/>    w, b = <strong class="lt iu">initialize_parameters</strong>(train_x.shape[0])<br/>    parameters, costs = <strong class="lt iu">gradient_descent</strong>(w, b, train_x, train_y, iterations, learning_rate)<br/>    <br/>    w = parameters["w"]<br/>    b = parameters["b"]<br/>    <br/>    # predict <br/>    train_pred_y = <strong class="lt iu">predict</strong>(w, b, train_x)<br/>    test_pred_y = <strong class="lt iu">predict</strong>(w, b, test_x)</span><span id="e24a" class="lx ly it lt b gy me ma l mb mc">    print("Train Acc: {} %".format(100 - np.mean(np.abs(train_pred_y - train_y)) * 100))<br/>    print("Test Acc: {} %".format(100 - np.mean(np.abs(test_pred_y - test_y)) * 100))<br/>    <br/>    return costs</span></pre><p id="75e4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ä»£ç ï¼Œä½¿ç”¨ä¸Šé¢æ„å»ºçš„æ¨¡å‹å¯¹å›¾åƒæ•°æ®é›†è¿›è¡Œè®­ç»ƒå’Œé¢„æµ‹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ 0.005 çš„<em class="ln"> learning_rate </em>ï¼Œå¹¶ä¸º 2000 æ¬¡<em class="ln">è¿­ä»£</em>è®­ç»ƒæ¨¡å‹ã€‚</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="cde1" class="lx ly it lt b gy lz ma l mb mc">costs = <strong class="lt iu">model</strong>(train_x, train_y, test_x, test_y, iterations = 2000, learning_rate = 0.005)</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nw"><img src="../Images/f1c79ea3ef241242c81733fcefebeea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EQ-RzGWka_Q9y9EfqnjnRA.png"/></div></div></figure><p id="9e48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è®­ç»ƒå‡†ç¡®ç‡åœ¨ 99%å·¦å³ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„æ¨¡å‹æ­£åœ¨å·¥ä½œï¼Œå¹¶ä¸”ä»¥é«˜æ¦‚ç‡æ‹Ÿåˆè®­ç»ƒæ•°æ®ã€‚æµ‹è¯•å‡†ç¡®ç‡åœ¨ 70%å·¦å³ã€‚ç»™å®šç®€å•çš„æ¨¡å‹å’Œå°çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºå®ƒæ˜¯ä¸€ä¸ªå¥½çš„æ¨¡å‹ã€‚</p><p id="ca7b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ç”»å‡ºæˆæœ¬å›¾ï¼Œçœ‹çœ‹æ¨¡å‹æ˜¯å¦‚ä½•å­¦ä¹ å‚æ•°çš„ã€‚</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="5d46" class="lx ly it lt b gy lz ma l mb mc">plt.plot(costs)<br/>plt.ylabel('cost')<br/>plt.xlabel('iterations')<br/>plt.title("Learning rate =" + str(d["learning_rate"]))<br/>plt.show()</span></pre><figure class="lo lp lq lr gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nx"><img src="../Images/41db1217eca39dda58ab0c22b110f70e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*frS0JUUFA6wPFdJHA0REUA.png"/></div></div></figure><p id="7c53" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¯æ¬¡è¿­ä»£çš„æˆæœ¬éƒ½åœ¨ä¸‹é™ï¼Œè¿™è¡¨æ˜å‚æ•°æ­£åœ¨è¢«å­¦ä¹ ã€‚</p><p id="5325" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åœ¨<a class="ae md" rel="noopener" target="_blank" href="/building-a-neural-network-with-a-single-hidden-layer-using-numpy-923be1180dbf">ä¸‹ç¯‡</a>ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•åˆ¶ä½œä¸€ä¸ªå¸¦éšè—å±‚çš„ç¥ç»ã€‚</p><blockquote class="ny nz oa"><p id="8725" class="ki kj ln kk b kl km ju kn ko kp jx kq ob ks kt ku oc kw kx ky od la lb lc ld im bi translated">åœ¨è¿™é‡Œæˆä¸ºåª’ä½“ä¼šå‘˜<a class="ae md" href="https://medium.com/@rmesfrmpkr/membership" rel="noopener">å¹¶æ”¯æŒç‹¬ç«‹å†™ä½œï¼Œæ¯æœˆ 5 ç¾å…ƒï¼Œå¯ä»¥å®Œå…¨è®¿é—®åª’ä½“ä¸Šçš„æ¯ä¸ªæ•…äº‹ã€‚</a></p></blockquote></div></div>    
</body>
</html>