<html>
<head>
<title>Python StdOuts: Don’t Print, Log!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python StdOuts:不要打印，记录！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dont-print-log-85df4c153abb?source=collection_archive---------25-----------------------#2020-08-17">https://towardsdatascience.com/dont-print-log-85df4c153abb?source=collection_archive---------25-----------------------#2020-08-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="38c7" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/tips-and-tricks" rel="noopener" target="_blank"> <em class="jb">小窍门</em> </a></h2><div class=""/><div class=""><h2 id="0cd1" class="pw-subtitle-paragraph ka jd it bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">显示状态消息的 pythonic 方式</h2></div><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/532c15e57b2ac8a13cc08dbfc0daf133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7pCMSlxWxg6e7wxF"/></div></div><p class="le lf gj gh gi lg lh bd b be z dk translated">马库斯·斯皮斯克在<a class="ae li" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="f1fb" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">通常在 Python 上，尤其是作为初学者，您可能会打印( )一个变量，以便查看程序中发生了什么。如果你在整个程序中依赖太多的打印语句，你可能会面临不得不在最后注释掉它们的噩梦。查看程序正在做什么的另一种方式是日志记录。然后，您可以将打印内容限制为最终用户希望看到的命令行输出。</p><h1 id="e2da" class="mf mg it bd mh mi mj mk ml mm mn mo mp kj mq kk mr km ms kn mt kp mu kq mv mw bi translated">为什么要日志？</h1><p id="b76c" class="pw-post-body-paragraph lj lk it ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me im bi translated">日志是一种在开发阶段查看程序状态的舒适工具。理想情况是:</p><ol class=""><li id="a28e" class="nc nd it ll b lm ln lp lq ls ne lw nf ma ng me nh ni nj nk bi translated">您希望区分调试输出和程序输出</li><li id="298c" class="nc nd it ll b lm nl lp nm ls nn lw no ma np me nh ni nj nk bi translated">您不希望在最终产品中出现不相关的标准输出</li><li id="80f2" class="nc nd it ll b lm nl lp nm ls nn lw no ma np me nh ni nj nk bi translated">您希望在开发和测试后禁用所有标准输出</li><li id="5398" class="nc nd it ll b lm nl lp nm ls nn lw no ma np me nh ni nj nk bi translated">您希望将程序执行历史保存到一个文件中，该文件包含元信息，如时间和更详细的调试信息。</li></ol><h1 id="ca6d" class="mf mg it bd mh mi mj mk ml mm mn mo mp kj mq kk mr km ms kn mt kp mu kq mv mw bi translated">怎么日志？</h1><p id="93a9" class="pw-post-body-paragraph lj lk it ll b lm mx ke lo lp my kh lr ls mz lu lv lw na ly lz ma nb mc md me im bi translated">您可以使用日志模块登录 python。</p><pre class="kt ku kv kw gt nq nr ns nt aw nu bi"><span id="95a4" class="nv mg it nr b gy nw nx l ny nz">import logging</span></pre><p id="c0b8" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">日志模块提供了在程序中记录各种状态消息的一些默认状态。默认级别为<code class="fe oa ob oc nr b">DEBUG</code>、<code class="fe oa ob oc nr b">INFO</code>、<code class="fe oa ob oc nr b">WARNING</code>、<code class="fe oa ob oc nr b">ERROR</code>和<code class="fe oa ob oc nr b">CRITICAL</code>。</p><p id="6a05" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">如果您执行以下程序:</p><pre class="kt ku kv kw gt nq nr ns nt aw nu bi"><span id="bd83" class="nv mg it nr b gy nw nx l ny nz">import logging<br/>import os<br/><br/>savepath = ‘path/to/save/at/’</span><span id="3c60" class="nv mg it nr b gy od nx l ny nz">if not os.path.exists(savepath):<br/>  logging.warning(‘Warning! The savepath provided doesn\’t exist!'     <br/>                  'Saving at current directory ‘)<br/>  savepath = os.getcwd() <br/>  logging.info(‘savepath reset at %s’,str(savepath))</span><span id="00ea" class="nv mg it nr b gy od nx l ny nz">else:<br/>    logging.info('Savepath provided is correct,'<br/>                 'saving at %s’,str(savepath))</span></pre><p id="04e9" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">示例中的路径不存在。您将看到以下输出:</p><pre class="kt ku kv kw gt nq nr ns nt aw nu bi"><span id="330c" class="nv mg it nr b gy nw nx l ny nz">WARNING:root:warning! The savepath provided doesn’t exist!Saving at current directory</span></pre><p id="3830" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><strong class="ll je">不显示新的当前保存路径信息，即 logging.info。</strong></p><p id="4107" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这是因为输出的默认严重级别是“警告”。严重程度的顺序如下:</p><p id="a76a" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><code class="fe oa ob oc nr b">DEBUG</code></p><p id="e640" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><code class="fe oa ob oc nr b">INFO</code></p><p id="36f4" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><code class="fe oa ob oc nr b">WARNING</code>(这是默认设置)</p><p id="ba66" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><code class="fe oa ob oc nr b">ERROR</code></p><p id="c2e3" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated"><code class="fe oa ob oc nr b">CRITICAL</code></p><p id="8798" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">如果您想要查看较低严重性级别的输出，您必须在日志记录配置中显式设置它们。在这个设置之后启动一个新的解释器，否则它将无法工作。</p><pre class="kt ku kv kw gt nq nr ns nt aw nu bi"><span id="261b" class="nv mg it nr b gy nw nx l ny nz">logging.basicConfig(level = logging.DEBUG)</span></pre><p id="c4f6" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">现在，一切都将被打印出来，从调试级开始。</p><p id="eaaa" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">输出:</p><pre class="kt ku kv kw gt nq nr ns nt aw nu bi"><span id="d748" class="nv mg it nr b gy nw nx l ny nz">WARNING:root:warning! The savepath provided doesn’t exist! Saving at current directory </span><span id="80ad" class="nv mg it nr b gy od nx l ny nz">INFO:root:savepath reset at path/to/current/directory</span></pre><p id="c207" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">太棒了。但是对于一个像样的日志，我们可能希望看到更多的信息，并将其放在一个单独的文件中。这可以使用配置中的格式和文件名来设置。在文件开头添加所需的配置:</p><pre class="kt ku kv kw gt nq nr ns nt aw nu bi"><span id="0f4a" class="nv mg it nr b gy nw nx l ny nz">logging.basicConfig(filename=’logfilename.log’,level = <br/>                    logging.DEBUG,format=’%(asctime)s %<br/>                    (message)s’,<br/>                    datefmt=’%d/%m/%Y %I:%M:%S %p’)</span></pre><p id="01dd" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这会将您的信息连同时间戳一起记录到 logfilename.log 中。</p><pre class="kt ku kv kw gt nq nr ns nt aw nu bi"><span id="3fee" class="nv mg it nr b gy nw nx l ny nz">13/06/2020 05:14:47 PM warning! The savepath provided doesn’t exist!  <br/>                       Saving at current directory <br/>13/06/2020 05:14:47 PM savepath reset at current/working/directory</span></pre><p id="5122" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">下一次运行该文件时，日志会被附加到文本文件中，这样您就可以在一个地方拥有日志的历史记录。您也可以更改它，每次都创建一个新的文本文件，方法是将它添加到您的 logging.basicConfig 中</p><pre class="kt ku kv kw gt nq nr ns nt aw nu bi"><span id="822e" class="nv mg it nr b gy nw nx l ny nz">filemode='w'</span></pre><p id="807b" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">您可以通过在脚本中添加以下内容来集中禁用所有日志记录，而不必注释掉每条消息:</p><pre class="kt ku kv kw gt nq nr ns nt aw nu bi"><span id="74d0" class="nv mg it nr b gy nw nx l ny nz">logger = logging.getLogger()<br/>logger.disabled = True</span></pre><p id="3a5c" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">或者，您可以选择更改需要写入日志文件的输出级别，以便只向最终用户显示警告和严重错误消息。</p></div><div class="ab cl oe of hx og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="im in io ip iq"><p id="eff1" class="pw-post-body-paragraph lj lk it ll b lm ln ke lo lp lq kh lr ls lt lu lv lw lx ly lz ma mb mc md me im bi translated">这是登录 python 的入门知识。日志记录提供了比上面描述的更大的灵活性(处理程序、过滤器、更改默认日志级别等)，但这应该足以开始使用基本的日志记录，并消除打印语句。</p></div></div>    
</body>
</html>