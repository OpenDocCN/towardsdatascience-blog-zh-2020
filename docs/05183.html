<html>
<head>
<title>Lessons from Scraping a DarkNet Market</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从打击暗网市场中吸取的教训</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/lessons-from-scraping-a-darknet-market-63e4ca546c18?source=collection_archive---------40-----------------------#2020-05-03">https://towardsdatascience.com/lessons-from-scraping-a-darknet-market-63e4ca546c18?source=collection_archive---------40-----------------------#2020-05-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a90a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我从研究一个垂死的市场中学到了什么</h2></div><p id="3b69" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="le">伦理学笔记</em> </strong></p><p id="de05" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">在写这篇文章的时候，我试着坚持一些原则，试图平衡分享这些信息的好处和风险——我把它们列在下面:</em></p><ul class=""><li id="be6a" class="lf lg it kk b kl km ko kp kr lh kv li kz lj ld lk ll lm ln bi translated"><em class="le">本文不会教你如何选购药品。我故意没有详细描述任何访问 DNMs 的步骤。非法药物是危险的，不好的，你在这里不会学到如何得到它们。</em></li><li id="92c0" class="lf lg it kk b kl lo ko lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><em class="le">我对数据进行了匿名处理，删除了可能与其他平台或个人相关联的用户名——卖家用户名已被替换为唯一的号码。除此之外，我使用的所有数据和代码都可以在这篇文章的底部访问和链接</em></li><li id="b4a8" class="lf lg it kk b kl lo ko lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><em class="le">任何访问大同协会的人都可以访问我使用的任何数据——我没有使用任何隐蔽的方法或花哨的代码来访问任何东西</em></li></ul><p id="73a0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">我知道有些人可能会有不同的看法——我觉得这些讨论最好在公开场合进行，而且遮遮掩掩不是保护人们安全的特别好的方式。</em></p></div><div class="ab cl lt lu hx lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="im in io ip iq"><p id="960a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">4 月 20 日，我决定通过搜集和分析暗网市场(DNM)的内容，来尝试和使用我那生疏的数据科学工具集。我希望分析随着社会距离措施的放松(例如，被大肆吹捧的与暴力的联系)，波动的药品价格的影响，但是，正如很快将变得清楚的那样，情况合谋破坏了我的狡猾计划。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ma"><img src="../Images/5c5d1e487f47f81d0a6228885fad0523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PZDtenClR1RYeqGU.jpg"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">来自 darknetstats.com 的大同协会截图</p></figure><p id="3a85" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这不是一篇期刊文章，我不是统计学家/数据科学家，我的数据集可能不能代表黑暗网络的其余部分——我肯定我犯了很多错误，请在评论中告诉我(建设性地)这些错误……但这是一次有趣的经历，我希望值得分享。</p><p id="f74c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">访问 DNMs 在技术上并不复杂，但它是迟钝和不直观的——晦涩和摩擦是访问的真正障碍。你必须运行 TOR，你不能只点击你找到的第一个谷歌链接…但这也不会花费太多的努力，因为有很多网站会收集现有市场的信息以及如何访问它们。在探索了几个选项之后，我选定了 Pax Romana(Pax Romana )( Pax Romana )( T15 ),它被描述为“一个新的黑暗网络市场，具有许多创新功能，可以减少网络钓鱼和退出欺诈”,它显然是从 3 月初开始出现的，但由于新手友好的流程和安全功能，以及在登录时迎接你的马库斯·奥勒留(Marcus Aurelius)令人放心的照片，它已经积累了大量的客户基础。</p><p id="73ee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它的结构也很好，有一个明确的“药物”类别，包含大约 200 页的产品。在稍微调整了一下我的代理设置后，我让<a class="ae mq" href="https://webscraper.io/" rel="noopener ugc nofollow" target="_blank"> Web Scraper </a>忙碌地浏览了几百个页面，从 4 月 21 日到 25 日我每天都在运行这些页面。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mr"><img src="../Images/026aa49223998c729f58cf7920a09b1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sSmaCpaZssJtrdPbLjebUA.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">darknetstats.com 大同协会的现状</p></figure><p id="a671" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">4 月 25 日，大同协会被黑了。当我在 26 号试图登录时，我得到了一个错误 404，网站再也没有回来。</p><p id="1100" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我分析不断变化的药品价格的计划被毁了，但我也无意中记录了罗马的末日。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ms"><img src="../Images/2aac61a336e618eac0efd337c258bcbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9iQrscFFizJBJ4ckF82dUA.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">来自 darknetstats.com 的用户评论</p></figure><h1 id="895f" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">聚集和清理</h1><p id="925d" class="pw-post-body-paragraph ki kj it kk b kl nl ju kn ko nm jx kq kr nn kt ku kv no kx ky kz np lb lc ld im bi translated">考虑到这一点，我开始清理和分析我的数据集，它由 10930 行组成，代表每天的广告运行，其中 3149 个是独特的广告(分成每天的 CSV 文件)。</p><p id="3767" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我的主要挑战是将每个广告归类到特定的物质类型——大同协会没有被归类到“毒品”之外，所以我必须有点创造性才能获得有用的数据。我使用<a class="ae mq" href="https://github.com/seatgeek/fuzzywuzzy" rel="noopener ugc nofollow" target="_blank"> FuzzyWuzzy </a> python 库迭代广告中的每个单词，寻找常见的药品名称。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/7c313a2c7016d2bea56217157b449b4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*37F63gtYVNOV-RDZKZZfmw.png"/></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">摘自我的药物词典</p></figure><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="fd6f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我使用各种痛苦的正则表达式字符串来提取视图、销售额、来源国和目的地、价格、卖家详细信息，以及我能找到的几乎所有东西，而又不会让我太紧张。</p><p id="eeb5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我在这里学到了我的第一课:<strong class="kk iu">毒品市场一片混乱。</strong> Pax Romana 的设计实际上非常有用，它具有列出单位重量价格的功能，使顾客能够快速找到值得购买的产品。</p><p id="3187" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">剧透:大多数毒贩不喜欢清晰的定价结构。</p><p id="36e2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在绝大多数的列表中，不是使用这个功能列出它们的价格，而是围绕产品的信息被打包到标题中，这导致了折衷的和几乎难以理解的产品数量、描述和定价——我已经强调了几个特别惊人的例子。</p><blockquote class="nt nu nv"><p id="c541" class="ki kj le kk b kl km ju kn ko kp jx kq nw ks kt ku nx kw kx ky ny la lb lc ld im bi translated">15 重新启动销售！PAX 上最便宜的 20 x 3mg Xanax 绿巨人(+20%免费)!</p></blockquote><p id="55ce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">大量药丸的单一广告也很常见——当你计算药丸的数量和每颗药丸的重量时，享受测量每卷价格的乐趣。我想这就是试图理解板球的感觉。</p><blockquote class="nt nu nv"><p id="cb06" class="ki kj le kk b kl km ju kn ko kp jx kq nw ks kt ku nx kw kx ky ny la lb lc ld im bi translated">' SALESALE'' 2000 x 'XTC'BENTLEY 药丸'' 240 毫克' '跟踪</p></blockquote><p id="0f34" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">尽我所能，我试图从所有这些广告中提取价格信息、重量和药丸数量。最终，我有了 6193 个条目，其中我对药物名称(定义为与我预先定义的名称之一相似超过 85%)有信心，并有了每重量的价格(理想状态，或者如果不是从描述中提取的)，从 1800 个独特的广告中创建。</p><h1 id="f8f5" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">分析</h1><p id="4ad1" class="pw-post-body-paragraph ki kj it kk b kl nl ju kn ko nm jx kq kr nn kt ku kv no kx ky kz np lb lc ld im bi translated">我首先想知道一个广告会有多少浏览量，所以我计算了一个广告每天的平均浏览量。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="7925" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">每条广告每天不到 10 次浏览。考虑到网站上的广告数量，这表明有一个不错的客户群。然而，有多少客户群转化成了销售呢？</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="8f82" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">显然没有那么多——平均每天的广告销售额不到 0.1。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="0b4b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用简单的线性 OLS 回归，浏览量似乎是销售的一个很强的预测因素(如我们的 R 为 0.6 所示，这意味着浏览量似乎占销售方差的一半以上)，但系数仅为 0.015 左右，这表明需要额外的 66 次浏览才能产生额外的销售。</p><p id="0b1f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">第二课？在网上卖毒品看起来很难。</strong> <em class="le"> </em>也就是说，平均值掩盖了极端值，我相信我们都想知道是谁购买了互联网上绝大多数的垃圾广告……如果你有足够多的广告，谁会在乎转化率低呢？</p><p id="76e0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">考虑到这一点，我接下来调查了个人卖家:你友好的网上邻居经销商有多少广告，有多少真正成交了？</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="fdfd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">事实证明，就像在现实世界一样，大多数毒品交易者并没有赚那么多钱。在平台上的 95 个卖家中，<em class="le"> 50%没有卖出一单— </em>无论他们设定什么价格。几个大玩家在争夺大钱，而其他人都在争夺残羹剩饭。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="4ada" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第二个有趣的发现是，大多数经销商不仅销售一种产品，事实上，有些经销商销售十种以上不同的物质。这甚至不是不同股的大麻:这是卖家出售医用阿片类药物，安非他明，苯并，类固醇…这里有一些认真勤奋的演员。与此同时，还记得我是如何强调平均值隐藏了极端值的吗？上面的 3d 散点图突出了一些最成功的卖家，即使他们的销量不多，但营业额也很高。例如，一个卖家卖出了 62 笔，平均价格为 5407 美元，而另一个卖家卖出了 136 笔，平均价格约为 1730 美元。</p><p id="5242" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些钱从哪里来，去了哪里？显然，我没有能力(或意图)跟踪用户，但大量的广告列出了产品将从哪里发出。虽然我们显然不能确认这些有多准确，但它们描绘了一幅有趣的画面。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="2788" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">美国、荷兰、德国、英国和西班牙代表了绝大部分的销售，并且考虑到卖家可以通过列出“全球”来模糊他们的位置，这些可能是最准确的。有趣的是，尽管所有这些国家都陷入了更深的封锁，但供应在一周内飙升，增长了近三分之一。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="cbfb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不过，总趋势再次掩盖了独特的趋势。许多国家在本周开始时下降，在周中达到平台期，然后随着周末的临近而攀升——在英国，整体供应萎缩，尽管没有更多数据，很难说这是自然变化还是由于封锁影响了更广泛的市场。然而，总的来说，供应量大幅增加——我认为这是由于季节变化(可能在月底或周末前)，尽管社交距离可能是一个因素。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="dd5f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过检查物质的市场细分，看起来这种增长不是由任何一种产品驱动的——虽然增长不是均匀的，但多种产品在一周内的供应量都有所增加。</p><p id="e35f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了试图理解这些变化，我更详细地考察了各个国家的市场。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="52a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我原以为可卡因、大麻或海洛因会是我们的首选药物，但可卡因只是被各种苯二氮卓类药物(通常用于治疗焦虑或恐慌发作，并以其商业名称出售，如 Xanax)所取代。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="8022" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看美国的图表，处方阿片类药物是一个明显的突出问题——这里的供应规模令人震惊，特别是与其他药物相比。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="fda1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">检查荷兰和德国的广告，我不禁认为这些差异可能是由大卖家造成的——尽管数量相当大，但这似乎太明显了，不可能是自然差异。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="c959" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我研究了药品定价。正如我在上面提到的，这些数据<em class="le">非常</em>混乱，我怀疑是由大量广告驱动的，这些广告旨在将流量导向其他地方，而不是实现真正的销售(例如，描述中给出的 Whatsapp 数字)。也就是说，通过只关注那些只卖出过一次的广告，我可以关注 760 个左右的独特广告的价格信息，这些广告实际上以规定的价格卖出了一些东西。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="b6b4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们再次注意到难以置信的差异和大型玩家的影响——虽然大多数销售倾向于在 100 美元左右，但一些极端销售正在接近 1000 美元的价位。我希望绘制每克的价格能让数据更清晰，但坦白地说，这只是增加了混乱。</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="nz ns l"/></div></figure><p id="ae74" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">也就是说，往往会有一个一致的平均值，我相信，随着时间的推移，随着更多的数据，我们可以绘制出价格的变化。</p><p id="fe8a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">那么，我的主要收获是什么？</p><ul class=""><li id="190b" class="lf lg it kk b kl km ko kp kr lh kv li kz lj ld lk ll lm ln bi translated">在线药品市场故意不透明和混乱——绝大多数广告并不推动销售，事实上可能被用来推动流量到更有效的平台。</li><li id="31ff" class="lf lg it kk b kl lo ko lp kr lq kv lr kz ls ld lk ll lm ln bi translated">就像实体领域的交易商一样，大多数人可能并没有赚到多少钱。也就是说，上层的生活是美好的，重要的玩家可能会获得巨额财富，并经营几种不同的毒品。</li><li id="b709" class="lf lg it kk b kl lo ko lp kr lq kv lr kz ls ld lk ll lm ln bi translated">价格和购买数量相差很大，甚至在同类产品中也是如此。也就是说，大多数销售是在较小的价格范围内进行的，一个更大的数据集可能能够产生围绕药品市场波动的真实预测。</li></ul><p id="4240" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你想知道更多关于这些可视化背后的代码或数据本身，它们可以在我的 Github 上以<a class="ae mq" href="https://github.com/crimsoneer/DNM_Scrape_Analysis" rel="noopener ugc nofollow" target="_blank"> Jupyter 笔记本格式获得。Github 不能很好地运行可视化，所以我也把它们上传到了下面的 Google Collab。</a></p><div class="oa ob gp gr oc od"><a href="https://colab.research.google.com/drive/1jr0dGkoFdC5zjT9jaEDS3kfwQOQhA8Pb" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd iu gy z fp oi fr fs oj fu fw is bi translated">可乐闪现</h2></div><div class="ok l"><div class="ol l om on oo ok op mk od"/></div></div></a></div></div></div>    
</body>
</html>