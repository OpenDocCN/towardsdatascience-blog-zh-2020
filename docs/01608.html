<html>
<head>
<title>Making cool maps using census data in 5 easy steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过5个简单的步骤使用人口普查数据制作酷地图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/making-cool-maps-using-census-data-in-5-easy-steps-1f80a6bcb457?source=collection_archive---------29-----------------------#2020-02-13">https://towardsdatascience.com/making-cool-maps-using-census-data-in-5-easy-steps-1f80a6bcb457?source=collection_archive---------29-----------------------#2020-02-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f1df" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">面向数据科学家的基础地理空间数据可视化</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5e0ebb44eaf19954867f4efd6335aece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mRZsSFzilEzYQxY8"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">克里斯·劳顿在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="312f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">人类有1100万个感觉受体，其中90%以上是光学审查者。这就是为什么数据的可视化表示如此重要，并且没有比制作地图更好的方式来表示数据。人们不常看到表格、饼状图和条形图，但他们每天都会用到地图。因此，地理空间分析是每个数据科学家工具箱中如此强大的工具。</p><p id="e14e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用人口普查数据库(<a class="ae ky" href="https://www.census.gov/" rel="noopener ugc nofollow" target="_blank">Census.gov</a>)这篇文章将演示如何制作简单的地图来可视化数据。该职位主要面向:a)希望学习空间数据表示基础知识的人，以及b)对普查数据分析感兴趣的人。</p><p id="c2a0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以让我们开始吧。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="35c6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">1.加载库</h1><p id="34a0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在继续之前，首先您需要有自己的API键来访问来自人口普查局API的数据。你可以<a class="ae ky" href="https://api.census.gov/data/key_signup.html" rel="noopener ugc nofollow" target="_blank">在这里注册</a>来获得你的密钥——这应该是一个快速的过程。</p><p id="744a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Python是我处理所有数据的“首选”语言。除了两种情况——<a class="ae ky" rel="noopener" target="_blank" href="/time-series-forecasting-from-naive-to-arima-and-beyond-ef133c485f94">时间序列预测</a>和地理空间分析。所以我用r做这个演示。</p><p id="f065" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有相当多的Rstat软件包可以用来处理人口普查数据，但是<code class="fe mz na nb nc b">tidycensus</code>可以说是记录最完整的软件包，在网上有很多例子。除此之外，我还是绘制人口普查变量的<code class="fe mz na nb nc b">tmap</code>的忠实粉丝。因此，让我们在第一步加载所有的包！</p><blockquote class="nd ne nf"><p id="c072" class="kz la ng lb b lc ld ju le lf lg jx lh nh lj lk ll ni ln lo lp nj lr ls lt lu im bi translated">库(tidysensus)<br/>库(tmap) <br/>库(tidyverse)</p></blockquote><p id="8cb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，您将使用<code class="fe mz na nb nc b">census_api_key()</code>函数加载您的API密匙。</p><blockquote class="nd ne nf"><p id="4ca2" class="kz la ng lb b lc ld ju le lf lg jx lh nh lj lk ll ni ln lo lp nj lr ls lt lu im bi translated">census _ API _ KEY(" YOUR _ API _ KEY _ HERE ")</p></blockquote><h1 id="bf60" class="mc md it bd me mf nk mh mi mj nl ml mm jz nm ka mo kc nn kd mq kf no kg ms mt bi translated">2.寻找正确的变量</h1><p id="9019" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">人口普查局既是工厂(即制造商)，也是仓库(即储存库)，储存了美国人类生活几乎每个方面的大量数据集。许多数据是通过每五年一次的美国社区调查(ACS)收集的。</p><p id="5e2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦您准备好启动您的IDE，您需要知道您感兴趣的变量的正确标识符(ID)。如果你不知道如何访问变量ID，这将是一个真正的挑战。这里有3个选项来找到合适的变量:</p><p id="f5fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">a)<code class="fe mz na nb nc b">tidycensus</code>中的<code class="fe mz na nb nc b"><a class="ae ky" href="https://walkerke.github.io/tidycensus/articles/basic-usage.html#searching-for-variables" rel="noopener ugc nofollow" target="_blank">load_variable</a>()</code>函数加载RStudio中的所有普查变量。从这里你可以搜索你正在寻找的变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/3a640f3f07712d24b76e1a7372a35378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*I5QO-PS233eYf3D7dtFzvA.png"/></div></div></figure><p id="48f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">b)使用<code class="fe mz na nb nc b">acs</code>包中的<code class="fe mz na nb nc b"><a class="ae ky" href="https://www.rdocumentation.org/packages/acs/versions/2.1.4/topics/acs.lookup" rel="noopener ugc nofollow" target="_blank">acs.lookup</a>()</code>功能</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/ef49326bcf41d080348480373f39b3bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*VVLQpDqkBsyNEXG0uNEdbw.png"/></div></figure><p id="0d9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">c)如果您不想在您的计算机中添加另一个软件包，可以从<a class="ae ky" href="https://www2.census.gov/geo/tiger/TIGER_DP/2015ACS/Metadata/STATE_METADATA_2015.txt" rel="noopener ugc nofollow" target="_blank">这里</a>或<a class="ae ky" href="https://api.census.gov/data/2017/acs/acs5/variables.html" rel="noopener ugc nofollow" target="_blank">这里</a>轻松访问25，000个变量的列表。</p><h1 id="0cec" class="mc md it bd me mf nk mh mi mj nl ml mm jz nm ka mo kc nn kd mq kf no kg ms mt bi translated">3.获取数据</h1><p id="baf5" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">一旦你知道你在找什么，那么获取数据只是一行代码。我将提取马里兰州每个县的家庭收入中位数变量(ID: B19013_001)。</p><blockquote class="nd ne nf"><p id="4dc8" class="kz la ng lb b lc ld ju le lf lg jx lh nh lj lk ll ni ln lo lp nj lr ls lt lu im bi translated">df </p><p id="8609" class="kz la ng lb b lc ld ju le lf lg jx lh nh lj lk ll ni ln lo lp nj lr ls lt lu im bi translated">head(df)</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/e4536dc2f2ed45f9817136f4a3a89204.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*Mu9hAn7Kyv-X6ZyjXRUsbw.png"/></div></figure><p id="2a5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">The dataframe may look a bit messy and intimidating but all you need to care about are 4 columns: NAME (name of the state/county), variable (variable ID: median household income), estimate (the actual data you are looking for) and moe (margin of error).</p><p id="41bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">The rest of the info in the dataset are basically metadata and geometry information for mapping purpose.</p><h1 id="f7f5" class="mc md it bd me mf nk mh mi mj nl ml mm jz nm ka mo kc nn kd mq kf no kg ms mt bi translated">4. Mapping data</h1><p id="5cad" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">The data you fetched in the previous step has a geometry column in it for displaying on the map. And for that you’ll need another package. Of all the mapping packages out there I prefer  【T4】  the most because it’s easy to write, read and interpret.</p><p id="200b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">You can make two kinds of maps: a static map and an interactive map. You need to tell  【T5】  upfront which kind do you want.</p><blockquote class="nd ne nf"><p id="759e" class="kz la ng lb b lc ld ju le lf lg jx lh nh lj lk ll ni ln lo lp nj lr ls lt lu im bi translated">tmap_mode(“view”) # you can change “view” to “plot” for static map</p></blockquote><p id="8468" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Now you can add as many layers of other info to make your map pretty and beautiful by tuning mapping parameters.</p><blockquote class="nd ne nf"><p id="9538" class="kz la ng lb b lc ld ju le lf lg jx lh nh lj lk ll ni ln lo lp nj lr ls lt lu im bi translated">tm_shape(df)+<br/> tm_fill("estimate "，palette = "BuGn "，title = " Median income ")+<br/>TM _ scale _ bar(breaks = c(0，25，50)，text . size = 0.5)+<br/>TM _ borders(" white "，LWD = . 5)+<br/>TM _ bubbles(size = " estimate "，col = " green ")+<br/>tmap _ options(BG . color = " white "，legend.text.color = "black ")</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/224052259467b68bf9bf87742668d993.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*LRwfJLq_X4YqwsWXCDJiGA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示马里兰州所有县的家庭收入中位数的地图。</p></figure><h1 id="0a75" class="mc md it bd me mf nk mh mi mj nl ml mm jz nm ka mo kc nn kd mq kf no kg ms mt bi translated">5.统计可视化</h1><p id="3963" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">地图是可视化和交流数据空间变化的一种很好的方式，但有些东西在传统的数据可视化中表现得更好。例如，在上面显示的地图中，您看到了不同县的中值收入的全州分布，但如果您有一个类似于下图的图表，则更容易看到哪些县在顶部，哪些县在底部。</p><blockquote class="nd ne nf"><p id="55be" class="kz la ng lb b lc ld ju le lf lg jx lh nh lj lk ll ni ln lo lp nj lr ls lt lu im bi translated">ggplot(data = df，aes(x = estimate，y = reorder(NAME，estimate))+<br/>geom _ error barh(AES(xmin = estimate—moe，xmax = estimate+moe))+<br/>geom _ point(color = " red "，size = 2)+<br/>geom _ label _ repult(AES(label = estimate)，size = 3) + <br/> xlab("家庭收入中位数")+ ylab(")</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/c58125b70ec3cc2e2a429b72285b2f2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*q21Eo1-kdMyGxmcX8xtb4w.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">可视化马里兰州所有24个县的中值家庭收入[这是第一次剪切的可视化，有点乱，需要做一些清理]。</p></figure><p id="e21f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里不仅列出了估计收入，还列出了误差幅度。可以想象，统计可视化是地图表示的真正补充。</p><p id="a888" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你有问题，请在下面的评论中写下，现在就可以开始了。我也在<a class="ae ky" href="https://twitter.com/DataEnthus" rel="noopener ugc nofollow" target="_blank">推特</a>和<a class="ae ky" href="https://www.linkedin.com/in/mab-alam/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上。</p></div></div>    
</body>
</html>