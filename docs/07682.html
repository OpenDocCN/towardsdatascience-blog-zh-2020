<html>
<head>
<title>Starbucks Promotional Campaign: Will you spend your money?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">星巴克促销活动:你会花钱吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/starbucks-promotional-campaigns-will-you-spend-your-money-9e8e965ab3d?source=collection_archive---------79-----------------------#2020-06-08">https://towardsdatascience.com/starbucks-promotional-campaigns-will-you-spend-your-money-9e8e965ab3d?source=collection_archive---------79-----------------------#2020-06-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fc4a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用 Python 和 ensemble 方法深入挖掘星巴克顾客</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ff6e237cfdbec952e0f6dab5f2b8a33f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2hbGHmK1m3fum621"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">埃里克·麦克林在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="6bf2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">每当星巴克向你提供买一送一的促销活动时，你会感到兴奋吗？然而，你被这个优惠吸引到最近的星巴克店消费了吗？</p><h1 id="f355" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">简介</strong></h1><p id="e694" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">所使用的数据集包含来自星巴克的模拟数据，这些数据模拟了顾客在他们的 rewards 移动应用上的行为。星巴克每隔几天就会发出一次优惠，可以是饮料的广告，也可以是实际的优惠，如折扣或 BOGO(买一送一)。然而，并不是每个用户都能得到相同的优惠，而且在优惠到期之前，每个优惠都有一个有效期。</p><p id="50c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过将年龄和性别等人口统计数据与交易和报价数据相结合，我们希望实现两个目标:</p><h2 id="3eaf" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated"><strong class="ak"> 1。报价视图和已完成的预测模型</strong></h2><p id="adfa" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">想象自己是一名收入一般的年轻女性，当你查看手机时，你看到一则广告:星巴克的 BOGO 促销活动将在 3 天后到期。你会使用促销吗？</p><p id="af0b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或者想象一下如果你是一个富裕忙碌的中年男性。你会有时间去看星巴克的广告吗？或者你会直接在最近的星巴克店里使用 BOGO 促销活动？</p><p id="7b08" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该模型旨在预测特定人群中的特定客户是否会查看或/和完成星巴克发送的报价。</p><h2 id="3b45" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated"><strong class="ak"> 2。平均支出预测模型</strong></h2><p id="ea27" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">相对于平均交易，星巴克给你的优惠有多有效？如果您收到并查看了星巴克的某些优惠，您会在星巴克消费多少金额？该模型旨在了解会员在看到优惠后直到有效期到期平均会花多少钱。</p><h1 id="c9d8" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">第一部分报价查看&amp;完成预测模型</strong></h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/ae570780848c2afdcb120b3342b22e76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1tpx4P5CduNb6EW6nVml_A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="4356" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">基于上面的相关图，推广变量(类型、奖励、难度)而不是人口统计属性影响更多的人观看广告。像 BOGO 这样的提议似乎很有吸引力。超过 70%的优惠被会员查看。与只有 57.9%成功率的其他类型的活动相比，这是一个非常显著的数字。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/ca5718d8b06ac1f5eaf002a09c47bf77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TeSzM87of6pD0gvWYhxIqg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="1379" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，故事是不同的其他类型的运动，如信息运动，将通知你，如果有新类型的饮料。只有 55%的会员观看了广告。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/4d603167dc474e03c4e59d694d78afc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AX5Cjk7bYlC0A6kS-af1NA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="58a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与报价最相关的人口统计属性是年龄组。如下图所示，年轻成人年龄组(17-25 岁)中有 41.6%的会员甚至不屑于看到报价，而其他年龄组的成功率为 63.1%。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/75cd048549506e4e97ff0d8ba1684a28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ym6F-ZmdgTowL_AZztHtPQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="d39d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是为什么呢？似乎年轻的成年人群体对 BOGO 的促销活动反应良好。68.2%的人看过 BOGO 的竞选活动，只有 52%的人看过其他类型的竞选活动。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/63d3d58e8c33fe6b07a09b30ece37bbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kwwzAM-LTQzjAHS9B4UjPQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="6ef6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，让我们继续讨论报价完成与其他变量的关系。请注意，当会员在促销有效期到期前超过最低消费时，优惠即被归类为已完成。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/f3a5f62a193d75890bbf089f860690c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ofS1aj5IooSD-Iv1NQabhw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="bb1e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">发现的一个有趣的注意事项是，2018 年加入的成员(数据集的最新成员)的失败率为 71.5%。它比其他会员多了将近 20%!</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/d2f201a1b3e905e91f9a7a650adc3ef0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0wPQ_ROkG8tS5ts_gbj1PA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="1332" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是优惠的类型呢？虽然 BOGO 活动是最成功的报价，但折扣活动对报价完成率的影响更大。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/21fde1ebdc5c62f2a6533c12c84b6318.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*03s5Y-wzeQC6f6VKnmIsKA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="a195" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">性别在这里被证明是至关重要的。与女性相比，男性未完成工作的比例高出 14%。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/c90a7bc59e1b8eb55f6f629ab7d3a58d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F3ZuT2hG0MR-cUgFpdNxbw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="e049" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们知道，与女性相比，男性不太可能完成报价。现在，什么样的男人会完成一个提议，什么样的提议足够吸引他们去完成？通过结合上面的另一个见解，我们可以看到折扣非常受欢迎，在 2018 年之前成为会员的男性中有 59%完成了折扣。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/0557ae3743155ca4d66db579d51b70f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b0bq4q0ymfCVjKD--nkbbg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="f93e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们开始建模。由于有两个分类，即已查看和已完成的报价，因此使用 MultiOutputClassifier，这意味着将有四种不同类型的输出，即未查看和未完成报价的客户(0，0)，未查看和完成报价的客户(0，1)，已查看和未完成报价的客户(1，0)，以及已查看和完成报价的客户(1，1)。两个集成学习模型，梯度提升和随机森林与网格搜索一起使用。</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="db21" class="mp lt iq ng b gy nk nl l nm nn">pipeline = Pipeline([<br/>    ('clf', MultiOutputClassifier(GradientBoostingClassifier())) <br/>    ])</span><span id="74ec" class="mp lt iq ng b gy no nl l nm nn">parameters = [<br/>    {<br/>    "clf": [MultiOutputClassifier(GradientBoostingClassifier())],<br/>    'clf__estimator__learning_rate':[0.5, 0.25],<br/>    'clf__estimator__n_estimators':[100, 200],<br/>    },<br/>    {<br/>    "clf": [MultiOutputClassifier(RandomForestClassifier())],<br/>    'clf__estimator__n_estimators': [100,200]<br/>    }]</span><span id="ab59" class="mp lt iq ng b gy no nl l nm nn">grid = GridSearchCV(pipeline, param_grid = parameters, cv=10, return_train_score=False)</span><span id="4d40" class="mp lt iq ng b gy no nl l nm nn">grid.fit(X_train, y_train)</span></pre><p id="d968" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在训练数据集中以 54%的最佳平均测试分数返回的最佳模型是具有学习率 0.25 和 n_estimators 100 的超参数的梯度增强。</p><p id="35d5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为什么渐变提升比随机森林表现更好？对于不平衡数据集，如用于此模型的训练数据集(只有 8%的标签是未查看和完成报价的客户)，梯度提升的性能优于随机森林。Boosting 一步一步地关注困难的例子，这些例子通过加强正类的影响给出了处理不平衡数据集的好策略。</p><p id="1469" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看看模型如何执行测试数据集。</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="0a41" class="mp lt iq ng b gy nk nl l nm nn">y_pred = grid.predict(X_test)</span><span id="de97" class="mp lt iq ng b gy no nl l nm nn">label = ['Offer Viewed', 'Offer Completed']</span><span id="cdf1" class="mp lt iq ng b gy no nl l nm nn">report = classification_report(y_test, y_pred, output_dict=True, target_names=label)</span><span id="4565" class="mp lt iq ng b gy no nl l nm nn">confusion_matrix_viewed = multilabel_confusion_matrix(y_test, y_pred)[0]<br/>accuracy_viewed = round(sum(confusion_matrix_viewed.diagonal())*100/confusion_matrix_viewed.sum(), 2)<br/>recall_viewed = round(report['Offer Viewed']['recall']*100,2)<br/>precision_viewed = round(report['Offer Viewed']['precision']*100,2)<br/>confusion_matrix_completed = multilabel_confusion_matrix(y_test, y_pred)[1]<br/>accuracy_completed = round(sum(confusion_matrix_completed.diagonal())*100/confusion_matrix_completed.sum(), 2)<br/>recall_completed = round(report['Offer Completed']['recall']*100,2)<br/>precision_completed = round(report['Offer Completed']['precision']*100,2)</span><span id="2543" class="mp lt iq ng b gy no nl l nm nn">print('The overall accuracy of the model on both class in the test dataset is {}%. Accuracy, recall and precision for offer viewed are {}%, {}% and {}%, \<br/>while accuracy, recall and precision for offer completed are {}%, {}% and {}%.'.format(round(grid.score(X_test, y_test)*100,2),\                                                                              accuracy_viewed,recall_viewed,precision_viewed,\                                                                                   accuracy_completed,recall_completed,precision_completed))</span></pre><p id="fece" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该模型在测试数据集中对两个类的总体准确率为 53.85%。已查看要约的准确率、召回率和准确率分别为 71.03%、80.39%和 75.13%，已完成要约的准确率、召回率和准确率分别为 72.44%、70.27%和 66.84%。</p><h1 id="dd58" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">第二部分。平均支出预测模型</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/9d0d9bc222a0867dbdbe8fb651569605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NNhFhGwaiCuck2kd0b5FFw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="49fd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">人口统计组属性，如收入、性别和年龄组，在会员在优惠有效期内查看优惠后，主导与会员平均消费的相关性。</p><p id="4441" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">被归类为高收入成员的成员通常花费大约 30 美元，中等收入成员通常花费 20 美元，低收入成员通常花费大约 5-10 美元。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/5663a97de81eb22578b30a6b5aaf4dd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z7fOIfP_m1sSk2uYBOobnQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="db4c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">男性和女性在看到报价后的消费行为是不同的。女性通常花费 25-30 美元，而男性通常只花费 10 美元以下。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/b9cfed365d6ed0b216bd631a2bb402c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WXM69uaPsOANucNhMLN5DQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="d939" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最有趣的是老年组(60 岁以上)和其他年龄组之间的比较。老年人群花费最多，大约 30 美元，而其他年龄组大约 10 美元。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/46b920469c4b2ee3e1d513c72ba321b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o1BgnTS5RsOh2snisYjXyw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="43e3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们开始建模。梯度推进和随机森林与网格一起用于搜索最佳模型和超参数。</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="0120" class="mp lt iq ng b gy nk nl l nm nn">pipeline = Pipeline([<br/>    ('clr', GradientBoostingRegressor()) <br/>    ])</span><span id="059a" class="mp lt iq ng b gy no nl l nm nn">parameters = [<br/>    {<br/>    "clr": [GradientBoostingRegressor()],<br/>    'clr__learning_rate':[0.5, 0.25, 0.1],<br/>    'clr__n_estimators':[100, 200,300],<br/>    'clr__max_depth':[10,20,50]<br/>    },<br/>    {<br/>    "clr": [RandomForestRegressor()],<br/>    'clr__n_estimators': [100,200,300],<br/>    'clr__max_depth':[10,20,50],<br/>    'clr__min_samples_split':[2, 5, 10]<br/>    }]</span><span id="ecc5" class="mp lt iq ng b gy no nl l nm nn">grid_amount = GridSearchCV(pipeline, param_grid = parameters, cv=10, return_train_score=False)</span><span id="4e6b" class="mp lt iq ng b gy no nl l nm nn">grid_amount.fit(X_train, y_train.values.ravel())</span><span id="c6e6" class="mp lt iq ng b gy no nl l nm nn">y_pred_train = grid_amount.predict(X_train)<br/>print(mean_absolute_error(y_train, y_pred_train))<br/>print(mean_squared_error(y_train, y_pred_train))</span></pre><p id="92f6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行网格搜索后的最佳模型是随机森林，其超参数估计数为 300，最大深度为 10，最小样本分裂为 10。训练数据集上的平均绝对误差和均方误差分别为 5.52 和 186.80。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/0c01f97d3b1c5be911c290b5b904b461.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aMFYxDevW4LZcMWJWWoxOw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由作者拍摄</p></figure><p id="7047" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于这种回归问题，随机森林的表现优于梯度增强的原因是因为数据中存在异常值(见上图)。<a class="ae kv" href="https://stats.stackexchange.com/questions/140215/why-boosting-method-is-sensitive-to-outliers#:~:text=Outliers%20can%20be%20bad%20for,its%20attention%20on%20those%20points." rel="noopener ugc nofollow" target="_blank">离群值可能对 boosting 不利，因为 boosting 将每棵树建立在先前树的残差/误差上。异常值将比非异常值具有大得多的残差，因此梯度增强将在这些点上集中不成比例的注意力。</a></p><p id="13f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看看它在测试数据集中的表现。</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="b7dc" class="mp lt iq ng b gy nk nl l nm nn">y_pred = grid_amount.predict(X_test)<br/>print(mean_absolute_error(y_test, y_pred))<br/>print(mean_squared_error(y_test, y_pred))</span></pre><p id="594a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在测试数据集上，平均绝对误差和均方误差分别为 6.33 和 279.52。</p><p id="11bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">与数据集中从 0 到 600 的平均支出范围值相比，6.33 的平均绝对误差听起来令人吃惊，但是我们应该考虑到数据集的平均值只有 15 左右。</p><h1 id="cbb5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">第三部。结论&amp;改进</strong></h1><ol class=""><li id="f1ee" class="nr ns iq ky b kz mk lc ml lf nt lj nu ln nv lr nw nx ny nz bi translated">优惠类型等促销属性会影响会员查看他们收到的优惠的行为。70%的会员会查看像 BOGO 这样的优惠类型。</li><li id="5561" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated">在完成报价的过程中，人口属性起着重要作用。与女性相比，男性未完成工作的比例高出 14%。</li><li id="6b87" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated">对于提供已查看和已完成的模型，梯度增强的性能优于随机森林模型，因为对于不平衡数据集，它的性能优于随机森林。为了改进，欠采样或过采样不平衡类可以解决这个问题。梯度增强模型在测试数据集中的两个类上的总体准确度是 53.85%。已查看要约的准确率、召回率和准确率分别为 71.03%、80.39%和 75.13%，已完成要约的准确率、召回率和准确率分别为 72.44%、70.27%和 66.84%。</li><li id="6c21" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated">在报价有效期内，不同的人口统计组在他们观看某些报价后，相对于他们花费的平均金钱表现不同。男性通常只花 10 美元以下，而女性通常花 25-30 美元左右。</li><li id="0646" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated">对于平均支出模型，随机森林比梯度增强模型表现更好，因为数据集中存在离群值。为了改进，处理异常值可能会解决这个问题。测试数据集中的平均绝对误差和均方误差分别为 6.33 和 279.52。</li></ol><h1 id="1f04" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated"><strong class="ak">参考文献</strong></h1><p id="876f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">完全归功于 Udacity 和 Starbucks 提供的数据集。你可以在这里看到完整的代码:【https://github.com/dhaneswaramandrasa/starbucks】T2。</p><ol class=""><li id="6584" class="nr ns iq ky b kz la lc ld lf of lj og ln oh lr nw nx ny nz bi translated">【http://ecmlpkdd2017.ijs.si/papers/paperID241.pdf T4】</li><li id="2ef8" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated"><a class="ae kv" href="https://medium.com/@aravanshad/gradient-boosting-versus-random-forest-cfa3fa8f0d80" rel="noopener">https://medium . com/@ aravanshad/gradient-boosting-vs-random-forest-CFA 3 fa 8 f 0d 80</a></li><li id="577b" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated"><a class="ae kv" href="https://stats.stackexchange.com/questions/140215/why-boosting-method-is-sensitive-to-outliers#:~:text=Outliers%20can%20be%20bad%20for,its%20attention%20on%20those%20points." rel="noopener ugc nofollow" target="_blank">https://stats . stack exchange . com/questions/140215/why-boosting-method-is-sensitive-to-Outliers #:~:text = Outliers % 20 can % 20 be % 20 bad % 20 for，its % 20 attention % 20 that % 20 points。</a></li></ol></div></div>    
</body>
</html>