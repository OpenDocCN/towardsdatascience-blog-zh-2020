<html>
<head>
<title>A Data Pipeline for Predicting Animated Film Performance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测动画电影表现的数据管道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-animated-film-performance-5d25748b7481?source=collection_archive---------40-----------------------#2020-01-27">https://towardsdatascience.com/predicting-animated-film-performance-5d25748b7481?source=collection_archive---------40-----------------------#2020-01-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6961" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">实施线性回归预测动画电影表现的技术演示。</h2></div><p id="d38f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是METIS正在进行的五个数据科学项目中的第二个，涉及虚构的客户端。这篇文章基于第1部分:客户演示。</p><h1 id="0dcf" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">项目焦点</h1><p id="7ade" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">这个项目的目的是使用新获得的数据科学工具来解决一个虚构客户的问题领域。我选择看动画电影是因为我个人对媒体的兴趣，并将这个项目视为帮助动画电影制片人和电影制作人增加投资回报的一种方式。我试图梳理出让动画电影更有利可图的众所周知的特征，从而帮助整个行业。帖子中的技术解释可能过于详细，但我在一个数据科学项目的典型帖子中从未见过如此详细的内容，所以我认为这将是对万维网的一个很好的贡献。</p><h1 id="5a94" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">技术工具</h1><p id="e5eb" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">这是我使用技术工具的顺序，但是，项目的重点以粗体显示。</p><ul class=""><li id="4771" class="mc md it kk b kl km ko kp kr me kv mf kz mg ld mh mi mj mk bi translated">数据刮痧:美汤</li><li id="c428" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated">数据清理和合并:熊猫</li><li id="cf0a" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated"><strong class="kk iu">探索性数据分析:Seaborn，Statsmodel </strong></li><li id="f227" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated"><strong class="kk iu">线性回归:SKlearn </strong></li><li id="8386" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld mh mi mj mk bi translated"><strong class="kk iu">正规化:拉索和山脊，拉斯</strong></li></ul><h1 id="5c81" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">数据抓取</h1><p id="4614" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">利用美人汤，我从“the-numbers.com”上刮出了有史以来423部动画电影的排行榜。从主页上，我调出了每部电影的票房收入，包括国内、国际票房收入、上映年份以及每部电影的网址。下面是初始数据帧的头部，以及生成它的代码。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mq"><img src="../Images/2a6888ae1b82940ae1aff9cd7cd6ffad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Byf0itzv0gYbPDscNApePA.png"/></div></div></figure><pre class="mr ms mt mu gt nc nd ne nf aw ng bi"><span id="0700" class="nh lf it nd b gy ni nj l nk nl">from bs4 import BeautifulSoup<br/>import requests<br/>import time</span><span id="fc36" class="nh lf it nd b gy nm nj l nk nl">#store url of page to be scraped<br/>movies_html = “<a class="ae nn" href="https://www.the-numbers.com/box-office-records/domestic/all-movies/cumulative/all-time-animated" rel="noopener ugc nofollow" target="_blank">https://www.the-numbers.com/box-office-records/domestic/all-movies/cumulative/all-time-animated</a>"<br/>movies_htmls = [movies_html, movies_html + “/101”, movies_html + “/201”, movies_html + “/301”, movies_html+ “401”]</span><span id="5aab" class="nh lf it nd b gy nm nj l nk nl">#iterate through url pages<br/>movies = {}<br/>for movies_html in movies_htmls:</span><span id="6411" class="nh lf it nd b gy nm nj l nk nl">#retrieve page’s html<br/> response = requests.get(movies_html)<br/> response.status_code</span><span id="a916" class="nh lf it nd b gy nm nj l nk nl">#store response<br/> page = response.text</span><span id="2cf6" class="nh lf it nd b gy nm nj l nk nl">#parse page with “lxml” parser<br/> soup = BeautifulSoup(page, “lxml”)</span><span id="f4e2" class="nh lf it nd b gy nm nj l nk nl">#gather movie data<br/> table = soup.find(‘table’)<br/> type(table)</span><span id="87d2" class="nh lf it nd b gy nm nj l nk nl">#find all rows: tr tag is for rows<br/> rows = [row for row in table.find_all(‘tr’)]</span><span id="1c0f" class="nh lf it nd b gy nm nj l nk nl">#get movies info<br/> for row in rows[1:100]:<br/> items = row.find_all(‘td’)<br/> url_1 = “<a class="ae nn" href="https://www.the-numbers.com" rel="noopener ugc nofollow" target="_blank">https://www.the-numbers.com</a>”<br/> link = items[2].find(‘a’)<br/> title, url = link.text, url_1 + link[‘href’]<br/> movies[title] = [url] + [i.text for i in items]<br/> time.sleep(2)```</span></pre><p id="0d15" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我提取每部电影的数据和预处理信息，例如，在提取美元金额时，我删除了逗号和美元符号，以获得一个纯粹的数字。这个过程与上面的非常相似，但是我从the-numbers.com的HTML中提取的信息是基于关键字的，而不是来自表格。下面是单个电影页面抓取的结果数据帧。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi no"><img src="../Images/780dd427c878327f7209ebced6947153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tjxDXkHFHJjJJUdcudqDHw.png"/></div></div></figure><p id="b035" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我想给这个项目一个更广阔的视角，所以我结合了GDP数据，以及从现有数据集中提取的IMDB元得分数据。与使用美国GDP数据一致，我决定使用国内票房表现，而不是国际。回想起来，我认为虚构的客户使用国际票房收入会更有用，因为钱就是钱，正如你在上面的前5部电影中看到的，国内份额不到50%。此外，通过合并有限的现有数据集，其中没有太多的动画电影，我不得不将数据集削减到166部电影。如果时间允许的话，如果我没有削减数据集的话，可能会产生一个更好的模型。元分数在我的模型中很有影响力，但它可能是一个很好的实验，以检查是否有更多的数据来训练或有元分数会产生更好的模型。</p><p id="6258" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我对数据集进行了一些清理，将其与其他数据集合并，并在数值数据类型中包含数值数据。</p><pre class="mr ms mt mu gt nc nd ne nf aw ng bi"><span id="85a8" class="nh lf it nd b gy ni nj l nk nl">#convert datatypes to numeric / date<br/>df["Avg. Run"] = pd.to_numeric(df["Avg. Run"], errors='coerce')<br/>df["Runtime"] = pd.to_numeric(df["Runtime"], errors='coerce')<br/>df["Release Date"] = pd.to_datetime(df["Release Date"], format = "%Y-%m-%d" )</span><span id="06ca" class="nh lf it nd b gy nm nj l nk nl">#make a column of lowercase + no punctuation titles<br/>df["title_formatted"] = df["Title"].str.lower()<br/>df["title_formatted"] = df["title_formatted"].str.replace('[^\w\s]','') <br/>df["title_formatted"] = df["title_formatted"].str.replace(' ','')</span></pre><p id="5c72" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我对要合并的数据集做了类似的清理和重新格式化，然后合并。</p><pre class="mr ms mt mu gt nc nd ne nf aw ng bi"><span id="2bea" class="nh lf it nd b gy ni nj l nk nl">mergedStuff = pd.merge(df, df_imdb, on=['title_formatted'], how='inner')</span></pre><p id="191e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我还从我收集的信息中生成了一些数字数据，尽可能地为模型提供最有意义的数字数据。例如，当我把发行语言转换成语言的数量，把标题转换成标题的长度，把续集转换成0和1。</p><pre class="mr ms mt mu gt nc nd ne nf aw ng bi"><span id="02d8" class="nh lf it nd b gy ni nj l nk nl">#find how many languages the film is in<br/>gdp_movie_df['Language'] = gdp_movie_df['Language'].str.split()<br/>gdp_movie_df['# of Languages']  = [len(x) for x in gdp_movie_df['Language']]</span></pre><p id="1db6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我最终使用以下数据集来进行EDA和模型训练，它由15个数字特征和7个分类特征组成。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi np"><img src="../Images/1e75015bedec1f1d0badce32abe11723.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*77ND1glYcxnOWcMEgARNsg.png"/></div></div></figure><p id="b6c3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我做了一个快速总结，看看是否一切都像预期的那样，没有不太可能的异常值。</p><pre class="mr ms mt mu gt nc nd ne nf aw ng bi"><span id="5fdc" class="nh lf it nd b gy ni nj l nk nl">X_y_df.describe()</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nq"><img src="../Images/49297286a97709710e410403d79978d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PDUKR7lfSeRo07SbbXCaKg.png"/></div></div></figure><p id="394f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一切似乎都井井有条，我确实决定保留票房表现高端的异常值，以便更好地理解它们。回过头来看，去掉它们以产生一个更精确的模型可能是明智的。</p><h1 id="2f46" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">探索性数据分析</h1><p id="d959" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">在我收集了所有的数据之后，我分离出我的数字数据，并首先使用相关矩阵对其进行检查。代码和输出如下:</p><pre class="mr ms mt mu gt nc nd ne nf aw ng bi"><span id="ba1c" class="nh lf it nd b gy ni nj l nk nl">numeric_df = X_y_df.loc[:,["Box Ofice", 'Production Budget', 'Theaters', 'Avg. Run', 'Metascore', 'Runtime_x', "month", 'year', 'Title Length', '# of Languages', 'GDP_level-current','GDP_level-chained', 'GDP_change-current', 'GDP_change-chained', "sequel_num"]]</span><span id="389f" class="nh lf it nd b gy nm nj l nk nl"># correlation matrix heatmap<br/>plt.figure(figsize = (8,7))<br/>sns.heatmap(numeric_df.corr(), cmap="RdYlBu", annot=True, vmin=-1, vmax=1);<br/>plt.savefig("heatmap_blue_or.png", bbox_inches='tight')</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/755cc8eff2673e0f7afa029d92f350f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*1XULr6taBYV182d1DimYqA.png"/></div></figure><p id="7470" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从热图中，我可以收集到与票房表现高度相关并且会严重影响我的模型的主要特征是:</p><ol class=""><li id="734d" class="mc md it kk b kl km ko kp kr me kv mf kz mg ld ns mi mj mk bi translated">平均运行周数</li><li id="d1c5" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld ns mi mj mk bi translated">剧院数量</li><li id="dd1e" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld ns mi mj mk bi translated">生产预算</li><li id="4905" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld ns mi mj mk bi translated">续集/翻拍</li><li id="b1b9" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld ns mi mj mk bi translated">元得分</li><li id="a112" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld ns mi mj mk bi translated">标题长度(标题中的字母数)</li><li id="c4a3" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld ns mi mj mk bi translated">运行时间</li><li id="24b8" class="mc md it kk b kl ml ko mm kr mn kv mo kz mp ld ns mi mj mk bi translated">国内生产总值水平环比</li></ol><p id="4f55" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有意思的是，随着年限的增长，收益反而下降。这也可能与不得不削减数据集以包含准确的元得分有关。为了探索这些特征和票房表现之间的数学关系，我进一步观察了一个配对图。代码和结果如下:</p><pre class="mr ms mt mu gt nc nd ne nf aw ng bi"><span id="a1f8" class="nh lf it nd b gy ni nj l nk nl">sns_plot = sns.pairplot(numeric_df, height=4, aspect=1);<br/>sns_plot.savefig(“pairplot.pdf”)</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nt"><img src="../Images/5b1a80b59a40456a52a2ba7a6d2c2038.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TKjC07_P45c4922m4o6leQ.png"/></div></div></figure><p id="15a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从配对图中(在pdf上放大很多倍后)，我可以进一步理解这些关系，并看到一些更有影响力的特征:</p><ol class=""><li id="1352" class="mc md it kk b kl km ko kp kr me kv mf kz mg ld ns mi mj mk bi translated">平均运行周数</li></ol><p id="a599" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个特征与票房有直接关系，斜率很小，截距大于零。</p><p id="6f8e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.剧院数量</p><p id="a9fc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一特征在达到最大值时似乎趋于平稳，表明与票房表现的关系更加复杂。</p><p id="db97" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.生产预算:</p><p id="fb60" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个功能与票房有最直接的关系，截距为零。随着制作预算的增长，票房业绩成比例地增长。</p><p id="4670" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">4.续集/重拍</p><p id="d67e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一特征在异常值中是一致的，这些异常值是表现最好的电影。</p><p id="01df" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">5.元得分</p><p id="c736" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一特征确实与票房表现有直接关系，但许多元得分较高的电影在票房上表现不佳。</p><p id="2ddb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">6.标题长度(标题中的字母数)</p><p id="5d88" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这条曲线与票房表现成反比。高回报的电影总是有较短的片名。</p><p id="fea2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">7.运行时间</p><p id="4a8d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该数据主要聚集在90分钟的直线周围，高回报电影更接近该长度。我觉得这个特点不太显著。</p><p id="5718" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">8.国内生产总值水平环比</p><p id="6098" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个特点也不是很显著。</p><p id="1267" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">9.月</p><p id="b9d3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一特性非常重要，从图表中我们可以看出，初夏和年末的发布日期更为成功。但是，季节并不遵循线性关系，因此它可能无法在线性回归模型中很好地建模。</p><p id="286a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个EDA之后，我可以建立一个模型，测试我的功能之间的关系，以及目标变量，国内票房表现。</p><p id="9745" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">线性回归</strong></p><p id="e08b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我使用SKlearn python包来设置我的简单训练测试分割，并在变量的几次迭代中获得我的R平方、平均绝对误差和均方根误差，包括一些虚拟变量和超参数。我做了一个循环来测试下面的组合、代码和结果，我的第一次迭代只使用了开箱即用的数字数据，如下所示:</p><pre class="mr ms mt mu gt nc nd ne nf aw ng bi"><span id="6d4b" class="nh lf it nd b gy ni nj l nk nl">from sklearn.model_selection import train_test_split<br/>from sklearn import metrics</span><span id="681c" class="nh lf it nd b gy nm nj l nk nl">def split_and_validate(X, y):<br/> ‘’’<br/> For a set of features and target X, y, perform a 80/20 train/val split, <br/> fit and validate a linear regression model, and report results<br/> ‘’’<br/> <br/> # perform train/val split<br/> X_train, X_val, y_train, y_val = \<br/> train_test_split(X, y, test_size=0.2, random_state=42)<br/> <br/> # fit linear regression to training data<br/> lr_model = LinearRegression()<br/> lr_model.fit(X_train, y_train)<br/> <br/> # score fit model on validation data<br/> val_score = lr_model.score(X_val, y_val)<br/> lr_preds = lr_model.predict(X_val)<br/> rmse = np.sqrt(metrics.mean_squared_error(y_val,lr_preds))<br/> mae = metrics.mean_absolute_error(y_val,lr_preds)<br/> <br/> # report results<br/> print(‘\nValidation R² score was:’, val_score)<br/> print(‘Feature coefficient results: \n’)<br/> for feature, coef in zip(X.columns, lr_model.coef_):<br/> print(feature, ‘:’, f’{coef:.2f}’) <br/> print (“RMSE score was:”, rmse)<br/> print (“MAE score was:”, mae)</span><span id="60c0" class="nh lf it nd b gy nm nj l nk nl">#vanilla training<br/>split_and_validate(X, y)</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nu"><img src="../Images/623d4eff71060fc912aad1b44ca8fcc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vN7HVWJca9pNnaaSdZpaYA.png"/></div></div></figure><p id="e88c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我打印了每次迭代的系数和分数。我从大约0.64 R平方开始，这并不可怕。我进行了几次迭代，得出了下面的模型。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nv"><img src="../Images/964ca35fb9609fe587ee63777024e3d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iWxnVLXOqdQWNoJdabceBQ.png"/></div></div></figure><p id="9a5c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些分数是我在我的数据集上能得到的最好的分数，R平方达到0.815，平均绝对误差达到48，934，141美元。如果时间允许的话，我会添加更多关于演员和导演的历史表现的数据，更多关于工作室的信息，以及公众对电影中启动力量的兴趣。</p><p id="3ee3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我还测试了Ridge和Lasso，看看它们是否会产生更好的结果，但它们没有，因为过度拟合不是这个特定模型的问题。代码和输出如下:</p><pre class="mr ms mt mu gt nc nd ne nf aw ng bi"><span id="2c2b" class="nh lf it nd b gy ni nj l nk nl">#Standard Scaler for Lasso and Ridge<br/>std = StandardScaler()<br/>std.fit_transform(X_tr.values)<br/>X_tr_std = std.transform(X_tr.values)<br/>X_val_std = std.transform(X_va.values)</span><span id="a3b4" class="nh lf it nd b gy nm nj l nk nl">#Ridge Linear Regression (code clip)<br/>lr_model_ridge = Ridge(alpha = 100)<br/>lr_model_ridge.fit(X_tr_std, y_tr)</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nw"><img src="../Images/0861e1faf84ef3ee5adfc75bbb9db067.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y5eHPPczwIRm8rqY6qb2DQ.png"/></div></div></figure><pre class="mr ms mt mu gt nc nd ne nf aw ng bi"><span id="7939" class="nh lf it nd b gy ni nj l nk nl">#Lasso Linear Regression (code clip)<br/>lr_model_lasso = Lasso(alpha = .01)<br/>lr_model_lasso.fit(X_tr_std, y_tr)</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nx"><img src="../Images/e76176667bc54e7977d777e3d11783f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g0AHWk34oG_wmUxtjkpgog.png"/></div></div></figure><p id="c0fc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了评估我的模型，我绘制了残差图，发现它们是随机分布的。</p><pre class="mr ms mt mu gt nc nd ne nf aw ng bi"><span id="9faa" class="nh lf it nd b gy ni nj l nk nl">residual = (y_test - lr_preds)</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/350d45621294ee3981c2bd9cec2bcb50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*ilrFPcJTDHqG0J-Wh3EIFA.png"/></div></figure><p id="b10d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我还绘制了预期与预测的票房表现，如下所示。</p><pre class="mr ms mt mu gt nc nd ne nf aw ng bi"><span id="ef76" class="nh lf it nd b gy ni nj l nk nl">plt.figure(figsize=(7,7))<br/>plt.scatter(lr_preds, y_test, c = "k")<br/>#plt.xlabel('Predicted Domestic Total Gross ', labelpad=15, color = "k")<br/>#plt.ylabel("Actual Domestic Total Gross (in 100 millions)", labelpad=15)<br/>#plt.title("Predicted Domestic Total Gross vs Actual", fontsize = 22, weight =  'bold', pad=40)<br/>plt.savefig("Predicted vs Actual.svg", bbox_inches='tight')</span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nz"><img src="../Images/51db132fb9864e573a160cd69692f15a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wMc7M1LxlaL01lZ5RyOmxg.jpeg"/></div></div></figure><p id="86df" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总的来说，端到端地运行这个过程非常令人满意。令人惊讶的是看到了过程中涉及的EDA和迭代的数量，但也令人欣慰的是知道人类对模型的输入和模型本身一样重要。我期待将线性回归应用于无数的问题。</p></div></div>    
</body>
</html>