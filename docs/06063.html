<html>
<head>
<title>Access Free Google Cloud Public Dataset with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python访问免费的谷歌云公共数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/access-free-google-cloud-public-dataset-with-python-42eb378be72c?source=collection_archive---------33-----------------------#2020-05-17">https://towardsdatascience.com/access-free-google-cloud-public-dataset-with-python-42eb378be72c?source=collection_archive---------33-----------------------#2020-05-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="ad29" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据科学基本指南</h2><div class=""/><div class=""><h2 id="c065" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">下载免费的谷歌公共数据集到熊猫数据框</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/2fd920edbab8376dcc4d41c953fff66a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rLOBT-DvSjQBfb-xw72Uow.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">使用Python </strong>访问免费的谷歌云公共数据集(插图由<a class="ae li" href="https://medium.com/@chaeyunkim" rel="noopener"> Chaeyun Kim </a>绘制)</p></figure><h1 id="ed6b" class="lj lk it bd ll lm ln lo lp lq lr ls lt ki lu kj lv kl lw km lx ko ly kp lz ma bi translated">谷歌公共数据集简介</h1><p id="ffe1" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi mx translated"><span class="l my mz na bm nb nc nd ne nf di"> G </span>数据科学家的好消息！谷歌正在制作一个公共数据集的托管存储库，如<a class="ae li" href="https://console.cloud.google.com/marketplace/details/johnshopkins/covid19_jhu_global_cases?filter=solution-type:dataset&amp;q=covid&amp;id=430e16bb-bd19-42dd-bb7a-d38386a9edf5" rel="noopener ugc nofollow" target="_blank">约翰·霍普金斯系统科学与工程中心</a>(JHU·CSSE)，来自世界银行的全球健康数据，以及【OpenStreetMap数据，可以通过他们的<a class="ae li" href="https://console.cloud.google.com/marketplace/details/bigquery-public-datasets/covid19-public-data-program" rel="noopener ugc nofollow" target="_blank">新冠肺炎公共数据集项目</a>免费访问和查询，以帮助研究人员、数据科学家和分析师努力抗击新冠肺炎。这些数据集消除了障碍，提供了对关键信息的快速、轻松的访问，消除了搜索和装载大型数据文件的需要。研究人员可以从<a class="ae li" href="https://console.cloud.google.com/marketplace/browse?filter=solution-type:dataset" rel="noopener ugc nofollow" target="_blank">谷歌云控制台</a>中访问数据集，以及数据描述和样本查询，以推进研究。我们在该计划中包含的所有数据都将是公开和免费的。* <em class="ng">该计划将持续有效，直至2020年9月15日。</em>【1】</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nh"><img src="../Images/e973c527d3414b93a0bca11b60e30963.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sbQOC0M--eJEdRnRe2ko_g.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">截至2020年5月15日可用的免费公共数据集列表</strong>(作者截图来自<a class="ae li" href="https://console.cloud.google.com/marketplace/details/bigquery-public-datasets/covid19-dataset-list" rel="noopener ugc nofollow" target="_blank"> Google </a></p></figure><h2 id="7236" class="ni lk it bd ll nj nk dn lp nl nm dp lt mk nn no lv mo np nq lx ms nr ns lz iz bi translated">为什么我这么喜欢？</h2><p id="0b9b" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">我自己用数据库存储、管理和更新数据有时既无聊又昂贵。有了谷歌公共数据集，他们就在替我打理这些无聊的部分。至于定价，在新冠肺炎疫情之前，它有每月1 TB查询的免费层限制(嗯，已经有很多免费数据了！)支持疫情的情况，再也没有限制了！！因此，我可以愉快地专注于有趣的部分:数据分析、性感的数据可视化、开发web应用程序等。</p><p id="fc7e" class="pw-post-body-paragraph mb mc it md b me nt kd mg mh nu kg mj mk nv mm mn mo nw mq mr ms nx mu mv mw im bi translated">本文将与您分享以下分步指南:</p><ol class=""><li id="ddba" class="ny nz it md b me nt mh nu mk oa mo ob ms oc mw od oe of og bi translated">启用Google Cloud BigQuery API。</li><li id="73f2" class="ny nz it md b me oh mh oi mk oj mo ok ms ol mw od oe of og bi translated">为BigQuery API创建服务帐户，以向您的Python脚本授予权限。</li><li id="ec4c" class="ny nz it md b me oh mh oi mk oj mo ok ms ol mw od oe of og bi translated">使用BigQuery Web界面浏览数据集。</li><li id="24e9" class="ny nz it md b me oh mh oi mk oj mo ok ms ol mw od oe of og bi translated">使用Python访问数据集，并将其导入熊猫数据框架。</li></ol><p id="5377" class="pw-post-body-paragraph mb mc it md b me nt kd mg mh nu kg mj mk nv mm mn mo nw mq mr ms nx mu mv mw im bi translated"><strong class="md jd"> <em class="ng">那么，我们开始吧！</em>T3】</strong></p><h1 id="94c7" class="lj lk it bd ll lm ln lo lp lq lr ls lt ki lu kj lv kl lw km lx ko ly kp lz ma bi translated">启用Google Cloud BigQuery API</h1><p id="cef7" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">为了能够访问数据集，你应该注册<a class="ae li" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云账户</a>。在您注册之后，或者如果您已经有了一个帐户，请转到您的Google Cloud <a class="ae li" href="http://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">控制台</a>，然后激活您的Google Cloud BigQuery API ( <a class="ae li" href="https://console.cloud.google.com/apis/library/bigquery.googleapis.com" rel="noopener ugc nofollow" target="_blank">链接</a>)。点击“激活”API后，可以看到确认的“API启用”，如下图所示。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi om"><img src="../Images/7c81052d13d71cd6e01402fa703163d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xZ3Q8Rfx3YHrkVcSeBsHXg.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">激活Google BigQuery API </strong>(作者截图)</p></figure><h2 id="b6d4" class="ni lk it bd ll nj nk dn lp nl nm dp lt mk nn no lv mo np nq lx ms nr ns lz iz bi translated">为BigQuery API创建服务帐户</h2><p id="9e55" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">为了让BigQuery API在以后使用Python或其他编程语言访问您的机器，您需要一个新的Google服务帐户密钥，步骤如下。<em class="ng">(如果只需要通过web界面访问，可以跳过这些步骤)</em></p><ul class=""><li id="5ac5" class="ny nz it md b me nt mh nu mk oa mo ob ms oc mw on oe of og bi translated">转到您的Google API凭证页面，为这个BigQuery API创建API键(<a class="ae li" href="https://console.cloud.google.com/apis/credentials" rel="noopener ugc nofollow" target="_blank">链接</a>)。</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oo"><img src="../Images/9fac704a2616ff7aacf96768111f0cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N4J8dv3m7WPwo73dAPRbXA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">创建Google BigQuery API服务账号</strong>(作者截图)</p></figure><ul class=""><li id="6334" class="ny nz it md b me nt mh nu mk oa mo ob ms oc mw on oe of og bi translated">选择服务帐户权限角色为“BigQuery Admin”</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi op"><img src="../Images/fabd669ac7690205ad12534890f01e20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dpm34jt3fCJhc0t2AWfGAw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">创建Google BigQuery API服务账号</strong>(作者截图)</p></figure><ul class=""><li id="b050" class="ny nz it md b me nt mh nu mk oa mo ob ms oc mw on oe of og bi translated">然后，点击<em class="ng">创建键</em>并选择<em class="ng"> JSON </em>类型。请确保您安全地保存这个文件，否则其他人也可能访问您的API帐户。我们将在最后一步中再次使用这个文件。</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oq"><img src="../Images/c5e153990771ff34382a9a387ae76224.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fELCHSUP0_GyVCow2yEGVQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">创建Google BigQuery API服务账号</strong>(作者截图)</p></figure><h1 id="5591" class="lj lk it bd ll lm ln lo lp lq lr ls lt ki lu kj lv kl lw km lx ko ly kp lz ma bi translated">使用BigQuery Web界面浏览数据集</h1><p id="fee0" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">用户可以使用SQL查询语法检索或查询Google公共数据集。首先，您可以尝试观察您可以访问哪些数据集，并通过以下三个步骤通过<a class="ae li" href="https://console.cloud.google.com/bigquery" rel="noopener ugc nofollow" target="_blank"> Google BigQuery Web界面</a>测试SQL查询:</p><ol class=""><li id="e316" class="ny nz it md b me nt mh nu mk oa mo ob ms oc mw od oe of og bi translated">探索可用的数据资源。选择其中一个。</li><li id="9b6e" class="ny nz it md b me oh mh oi mk oj mo ok ms ol mw od oe of og bi translated"><strong class="md jd">在“查询编辑器”窗口中输入查询语法。</strong>在这一步，你需要SQL的基本知识来查询(搜索)数据集。如果您以前从未使用过，请查看有关它的在线文档。有几个是在线的比如<a class="ae li" href="https://www.w3schools.com/sql/" rel="noopener ugc nofollow" target="_blank"> W3 </a>。</li><li id="e12c" class="ny nz it md b me oh mh oi mk oj mo ok ms ol mw od oe of og bi translated"><strong class="md jd">浏览您的查询结果。</strong></li></ol><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/c79926417102ae52a80c22214edf38fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GsqacnHYPZL8J32P3oI7Ow.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">使用Google BigQuery Web接口查询Google公共数据集的例子——纽约市新冠肺炎案例。</strong>(作者)</p></figure><h1 id="c3e1" class="lj lk it bd ll lm ln lo lp lq lr ls lt ki lu kj lv kl lw km lx ko ly kp lz ma bi translated">使用Python访问数据集，并将其导入熊猫数据框架。</h1><p id="66b2" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">要使用Python访问BigQuery API，请使用以下命令安装该库:</p><pre class="ks kt ku kv gt os ot ou ov aw ow bi"><span id="71e9" class="ni lk it ot b gy ox oy l oz pa"><strong class="ot jd">pip install --upgrade google-cloud-bigquery</strong></span></pre><p id="6f87" class="pw-post-body-paragraph mb mc it md b me nt kd mg mh nu kg mj mk nv mm mn mo nw mq mr ms nx mu mv mw im bi translated">创建您的项目文件夹，并将服务帐户JSON文件放入该文件夹。然后，创建一个Python文件，用你喜欢的编辑器编辑它。你需要做的第一件事是将Google应用点的操作系统环境设置为你的JSON密钥目录，这可以通过使用<code class="fe pb pc pd ot b">os.environ["xxx"]="yyy"</code>来完成</p><pre class="ks kt ku kv gt os ot ou ov aw ow bi"><span id="b786" class="ni lk it ot b gy ox oy l oz pa"><strong class="ot jd">os.environ["GOOGLE_APPLICATION_CREDENTIALS"]="Your json directory"</strong></span></pre><p id="2fe0" class="pw-post-body-paragraph mb mc it md b me nt kd mg mh nu kg mj mk nv mm mn mo nw mq mr ms nx mu mv mw im bi translated">然后，您可以启动BigQuery客户机，并使用以下命令启动查询:</p><pre class="ks kt ku kv gt os ot ou ov aw ow bi"><span id="01ed" class="ni lk it ot b gy ox oy l oz pa"><strong class="ot jd">client = bigquery.Client()          </strong># Start the BigQuery Client<strong class="ot jd"><br/>QUERY = ('SELECT ...')              </strong># Input Query Syntax<strong class="ot jd"><br/>query_job = client.query(QUERY)     </strong># Start Query API Request<strong class="ot jd"><em class="ng"><br/></em>query_result = query_job.result()   </strong># Get Query Result<strong class="ot jd"><br/>df = query_result.to_dataframe()    </strong># Save the Query to Dataframe</span></pre><p id="1092" class="pw-post-body-paragraph mb mc it md b me nt kd mg mh nu kg mj mk nv mm mn mo nw mq mr ms nx mu mv mw im bi translated">例如，您可以按照下面的完整Python脚本，从纽约时报新冠肺炎数据库中按较晚日期和较高确诊病例的顺序查询美国前20名新冠肺炎确诊和死亡病例。</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="pe pf l"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="ak">从谷歌公共数据集查询新冠肺炎数据的示例Python脚本——纽约时报新冠肺炎数据库</strong>(作者提供的示例脚本)</p></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pg"><img src="../Images/5521276568b9287afdf151b6a1ca8a34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pAqIu4e4D4hROw0Z0qXSfw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><strong class="bd lh">谷歌公共数据集查询结果示例——纽约时报新冠肺炎数据库</strong>(作者举例)</p></figure><p id="87f0" class="pw-post-body-paragraph mb mc it md b me nt kd mg mh nu kg mj mk nv mm mn mo nw mq mr ms nx mu mv mw im bi translated">所以，就这样吧！祝贺您，现在您可以访问数据集了，享受您的新数据框架吧！！✌🎉🎉</p></div><div class="ab cl ph pi hx pj" role="separator"><span class="pk bw bk pl pm pn"/><span class="pk bw bk pl pm pn"/><span class="pk bw bk pl pm"/></div><div class="im in io ip iq"><h1 id="1750" class="lj lk it bd ll lm po lo lp lq pp ls lt ki pq kj lv kl pr km lx ko ps kp lz ma bi translated">结论</h1><p id="1f4c" class="pw-post-body-paragraph mb mc it md b me mf kd mg mh mi kg mj mk ml mm mn mo mp mq mr ms mt mu mv mw im bi translated">本文涵盖了如何使用WebUI和Python通过Google Cloud BigQuery服务使用和访问数据集的基本步骤。请注意，这篇文章只涵盖了初学者的步骤，还有更多的功能和界面来访问和使用这项服务。你可以在这里查看完整的BigQuery文档。</p><p id="34e7" class="pw-post-body-paragraph mb mc it md b me nt kd mg mh nu kg mj mk nv mm mn mo nw mq mr ms nx mu mv mw im bi translated">我希望你喜欢这篇文章，并发现它对你的日常工作或项目有用。如果您有任何问题或意见，请随时给我留言。</p><p id="fe8a" class="pw-post-body-paragraph mb mc it md b me nt kd mg mh nu kg mj mk nv mm mn mo nw mq mr ms nx mu mv mw im bi translated">关于我&amp;查看我所有的博客内容:<a class="ae li" href="https://joets.medium.com/about-me-table-of-content-bc775e4f9dde" rel="noopener">链接</a></p><p id="ebe3" class="pw-post-body-paragraph mb mc it md b me nt kd mg mh nu kg mj mk nv mm mn mo nw mq mr ms nx mu mv mw im bi translated">安全<strong class="md jd">健康</strong>健康<strong class="md jd">吗！💪</strong></p><p id="2645" class="pw-post-body-paragraph mb mc it md b me nt kd mg mh nu kg mj mk nv mm mn mo nw mq mr ms nx mu mv mw im bi translated"><strong class="md jd">感谢您的阅读。📚</strong></p></div><div class="ab cl ph pi hx pj" role="separator"><span class="pk bw bk pl pm pn"/><span class="pk bw bk pl pm pn"/><span class="pk bw bk pl pm"/></div><div class="im in io ip iq"><p id="1fc9" class="pw-post-body-paragraph mb mc it md b me nt kd mg mh nu kg mj mk nv mm mn mo nw mq mr ms nx mu mv mw im bi translated">[1] Chad W. Jennings，<a class="ae li" href="https://cloud.google.com/blog/products/data-analytics/free-public-datasets-for-covid19" rel="noopener ugc nofollow" target="_blank">新冠肺炎公共数据集计划:使数据可自由访问以获得更好的公共结果</a>(2020年3月30日)，谷歌云数据分析</p></div></div>    
</body>
</html>