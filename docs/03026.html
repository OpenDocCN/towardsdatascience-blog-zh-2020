<html>
<head>
<title>Machine Learning Experiment Tracking</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习实验跟踪</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-experiment-tracking-93b796e501b0?source=collection_archive---------6-----------------------#2020-03-23">https://towardsdatascience.com/machine-learning-experiment-tracking-93b796e501b0?source=collection_archive---------6-----------------------#2020-03-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="95f9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><strong class="ak">为什么实验跟踪对于进行真实世界的机器学习如此重要？</strong></h2></div><p id="4cf1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">乍一看，构建和部署机器学习模型看起来很像编写代码。但是有一些关键的差异使得机器学习更加困难:</p><ol class=""><li id="dd20" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated">机器学习项目比典型的软件项目有更多的分支和实验。</li><li id="90f9" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">机器学习代码一般不会抛出错误，只是表现不佳，使得调试变得格外困难和耗时。</li><li id="944f" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">训练数据、训练代码或超参数中的一个微小变化都会极大地改变模型的性能，因此重现早期的工作通常需要与之前的设置完全匹配。</li><li id="4551" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">运行机器学习实验可能非常耗时，而且计算成本可能会变得非常昂贵。</li></ol><p id="81fa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有组织地跟踪实验有助于解决所有这些核心问题。weights and bias(wandb)是一个简单的工具，可以帮助个人跟踪他们的实验——我与不同规模团队的几位机器学习领导者谈论过他们如何使用wandb来跟踪他们的实验。</p><h1 id="d978" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated"><strong class="ak">开始使用wandb进行实验跟踪</strong></h1><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/20a131d51ac9dc6660b8aa0636369deb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FT-F8Rat4-y9cfhz"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">查看<a class="ae na" href="https://app.wandb.ai/stacey/estuary/reports/Distributed-Training--Vmlldzo1MjEw" rel="noopener ugc nofollow" target="_blank">现场仪表盘</a></p></figure><p id="43ad" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ML项目进展的基本单位是实验，所以大多数人以某种方式跟踪他们正在做的事情——通常我看到从业者从电子表格或文本文件开始跟踪他们正在做的事情。</p><p id="45ee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">电子表格和文档非常灵活——这种方法有什么问题？</p><p id="ad3b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是几年前我在一个项目中使用的谷歌文档:</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nb"><img src="../Images/0b41e9765d19b24af5b04712aa5591cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*x63ako-wMyFH77xt"/></div></div></figure><p id="960b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我确信这些笔记在当时很重要，但现在我不知道这些笔记是什么意思。</p><p id="8883" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">权重和偏差使得自动记录所有超参数(输入)和指标(输出)变得非常简单。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/71037c1a7eedc027d612bd359ed6e8bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y3K78UKqhDzF9pRH"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">一个典型的项目在<a class="ae na" href="http://app.wandb.ai/l2k2/l2k" rel="noopener ugc nofollow" target="_blank"> wandb </a>。</p></figure><p id="efff" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是你如何在pytorch 中<a class="ae na" href="https://docs.wandb.com/library/frameworks/pytorch" rel="noopener ugc nofollow" target="_blank">设置wandb(你可以在</a><a class="ae na" href="https://docs.wandb.com/library/frameworks" rel="noopener ugc nofollow" target="_blank">文档</a>中找到其他常见的ML框架)。</p><pre class="ml mm mn mo gt nc nd ne nf aw ng bi"><span id="a8ce" class="nh lt it nd b gy ni nj l nk nl"><strong class="nd iu">import wandb</strong></span><span id="ff08" class="nh lt it nd b gy nm nj l nk nl"><strong class="nd iu">wandb.init(config=args)</strong> # track hyperparameters<br/><strong class="nd iu">wandb.watch(model)</strong> # track model metrics</span><span id="dfce" class="nh lt it nd b gy nm nj l nk nl">model.train()<br/>for batch_idx, (data, target) in enumerate(train_loader):<br/>  output = model(data)<br/>  loss = F.nll_loss(output, target)<br/>  loss.backward()<br/>  optimizer.step()</span><span id="c316" class="nh lt it nd b gy nm nj l nk nl">  <strong class="nd iu">wandb.log({“loss”: loss})</strong> # track a specific metric</span></pre><p id="3941" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦设置好，Weights and Biases就会默认监控很多东西。任何命令行参数都成为保存的超参数。pytorch提供的任何值都成为度量。实验可以自动链接到最新的git提交或训练代码的确切状态。被动地收集信息真的很重要，因为持续地写下你可能关心的所有事情几乎是不可能的。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/76415c89d7e75fe04c80f1429badcd59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qefpzarwY8069BhW"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated"><a class="ae na" href="https://app.wandb.ai/l2k2/l2k/runs/nv641wyz/overview" rel="noopener ugc nofollow" target="_blank">实验概述</a>权重&amp;偏差</p></figure><p id="8f66" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">写下关于你稍后构建的模型的定性注释也是极其重要的。在Weights and Biases中，您可以创建报告来跟踪模型度量的注释，并与您的团队共享您的发现和进展。</p><p id="c9b3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">在后台收集系统指标</strong>就是一个很好的例子。Wandb在后台收集系统使用指标，如分配的GPU内存、网络流量和磁盘使用情况。大多数情况下，您不需要查看所有这些信息，但是在您不再使用大部分GPU内存的情况下进行更改是很容易的，并且很难跟踪您何时进行了更改。如果你<a class="ae na" href="https://docs.wandb.com/quickstart" rel="noopener ugc nofollow" target="_blank">用wandb对你的训练代码</a>进行一次测试，你将能够回顾你所有的实验，并看到用法在哪里发生了变化。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/db407eef21d0c83775a0d39b9ce151e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8zPvmf0LJmsDJW36"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">在<a class="ae na" href="https://app.wandb.ai/l2k2/examples-prod_monitor" rel="noopener ugc nofollow" target="_blank">实时仪表盘</a>中查看</p></figure><h1 id="50e8" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated"><strong class="ak">使用实验跟踪来比较不同实验的结果</strong></h1><p id="07c3" class="pw-post-body-paragraph ki kj it kk b kl nn ju kn ko no jx kq kr np kt ku kv nq kx ky kz nr lb lc ld im bi translated">典型的ML工作流程包括运行大量实验。我们发现，在其他结果的背景下观察结果<a class="ae na" href="https://app.wandb.ai/sweep/simpsons" rel="noopener ugc nofollow" target="_blank">比单独观察一个实验更有意义。</a></p><p id="97d1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同时查看大量实验很快就会变得混乱。有许多输入在变化，也有许多不同的可能输出。一些运行不可避免地会过早失败。</p><p id="ccaa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不同的实验风格导致不同的工作流程，但是我们发现记录下你可能关心的每一个指标，并用一些对你有意义的一致标签来标记实验，可以让事情在以后变得更有条理。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/dcaf5ce7ed49989f342c2b2d9a36899a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WFwTLurK2nvsCvZb"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">在<a class="ae na" href="https://app.wandb.ai/stacey/estuary/table" rel="noopener ugc nofollow" target="_blank">实时仪表盘</a>中查看。</p></figure><p id="4429" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦你记录了大量的模型，你就有更多的维度需要检查，而不是一下子就能看到。我们发现的一个强大的可视化工具是平行坐标图。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ns"><img src="../Images/976f76fe7a0871981704f70965b0993f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xC-9T1fDU3GoN7y4"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">查看<a class="ae na" href="https://app.wandb.ai/sweep/simpsons" rel="noopener ugc nofollow" target="_blank">实时仪表盘</a></p></figure><p id="87f9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里每行是一个单独的实验，每列是一个输入超参数或输出度量。我突出显示了最高精度运行，它非常清楚地表明，在我选择的所有实验中，高精度来自低压差值。</p><p id="61a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">跨实验查看是如此重要，以至于wandb允许您构建工作空间，您可以在其中选择像散点图这样的可视化图形组，然后立即查看所选运行的比较</p><h2 id="3451" class="nh lt it bd lu nt nu dn ly nv nw dp mc kr nx ny me kv nz oa mg kz ob oc mi od bi translated"><strong class="ak">查看具体例子</strong></h2><p id="5880" class="pw-post-body-paragraph ki kj it kk b kl nn ju kn ko no jx kq kr np kt ku kv nq kx ky kz nr lb lc ld im bi translated">总的指标是好的，但是看具体的例子是必要的。函数<a class="ae na" href="https://docs.wandb.com/library/log" rel="noopener ugc nofollow" target="_blank"> wandb.log() </a>可以处理各种数据类型，并自动可视化。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/dff4f87d00d38aaf4e9ecb595a2dab33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*a_tuPLDSmUcu-Kaq"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">查看<a class="ae na" href="https://app.wandb.ai/stacey/deep-drive/reports/The-View-from-the-Driver's-Seat--Vmlldzo1MTg5NQ" rel="noopener ugc nofollow" target="_blank">现场报道</a></p></figure><h2 id="5726" class="nh lt it bd lu nt nu dn ly nv nw dp mc kr nx ny me kv nz oa mg kz ob oc mi od bi translated"><strong class="ak">测井图像</strong></h2><p id="a975" class="pw-post-body-paragraph ki kj it kk b kl nn ju kn ko no jx kq kr np kt ku kv nq kx ky kz nr lb lc ld im bi translated"><a class="ae na" href="https://docs.wandb.com/library/log#logging-images" rel="noopener ugc nofollow" target="_blank">记录图像</a>对于许多应用来说非常重要，可以在多次运行中查看图像。以下是构建GAN的不同方法以及不同规模和时间步长下的结果。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi oe"><img src="../Images/7f4faa1b203d3d03f3ac3c876abb0158.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9103GbE2lZNEMB-q"/></div></div></figure><h2 id="88e3" class="nh lt it bd lu nt nu dn ly nv nw dp mc kr nx ny me kv nz oa mg kz ob oc mi od bi translated"><strong class="ak">测井Matplotlib图</strong></h2><p id="6553" class="pw-post-body-paragraph ki kj it kk b kl nn ju kn ko no jx kq kr np kt ku kv nq kx ky kz nr lb lc ld im bi translated">通常代码已经在matplotlib中跟踪了一些东西——如果你<a class="ae na" href="https://docs.wandb.com/library/log#logging-plots" rel="noopener ugc nofollow" target="_blank">记录了图表</a>,它将被永久保存，并且很容易恢复。事实上，你可以为你的训练代码的每一步记录一个独特的图表。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi of"><img src="../Images/c7769b861083f325ea9de4a927a9b037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xAUTvCu95qlinBhq"/></div></div></figure><h1 id="506c" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated"><strong class="ak">使用实验跟踪管理分布式培训</strong></h1><p id="f0f5" class="pw-post-body-paragraph ki kj it kk b kl nn ju kn ko no jx kq kr np kt ku kv nq kx ky kz nr lb lc ld im bi translated">当进行<a class="ae na" href="https://app.wandb.ai/stacey/estuary/reports/Distributed-Training--Vmlldzo1MjEw" rel="noopener ugc nofollow" target="_blank">分布式训练</a>时，即使只是可视化结果也会变得更加困难。</p><p id="46d3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在多台计算机上的分布式运行中，每个实例都可以调用wandb init并设置group和job_type，如下所示:</p><pre class="ml mm mn mo gt nc nd ne nf aw ng bi"><span id="6bb4" class="nh lt it nd b gy ni nj l nk nl">wandb.init(group=”first-run”, job_type=”train”)</span></pre><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/9c866e4ef12a9398ecab3e64aa310db8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y7HyO3m49rGExAQ3"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">查看<a class="ae na" href="https://app.wandb.ai/stacey/estuary/reports/Distributed-Training--Vmlldzo1MjEw" rel="noopener ugc nofollow" target="_blank">实时仪表盘</a></p></figure><p id="1b0f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Wandb将显示集合在一起的组中所有运行的指标，但也可以查看单个流程，看看它们的表现如何。</p><h1 id="ae4c" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated"><strong class="ak">使用实验跟踪报告管理团队协作</strong></h1><p id="d7b8" class="pw-post-body-paragraph ki kj it kk b kl nn ju kn ko no jx kq kr np kt ku kv nq kx ky kz nr lb lc ld im bi translated">随着团队的成长，跟踪一切变得越来越重要。Wandb允许您构建<a class="ae na" href="https://app.wandb.ai/stacey/deep-drive/reports/The-View-from-the-Driver's-Seat--Vmlldzo1MTg5NQ" rel="noopener ugc nofollow" target="_blank">静态报告</a>,精确显示您使用聚合统计数据运行的实验，并具有深入挖掘的能力。</p><p id="d62e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在OpenAI机器人团队中，wandb报告是ML从业者记录他们所做工作并与同事分享的地方。当一个变化可能无意中损害了进展时，可视化是至关重要的。</p><p id="08fc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在潜伏空间，每个团队项目会议都以审查最新的wandb实验报告开始，并围绕当前方法的效果以及下一步应该尝试什么实验进行讨论。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/e716ff10a48c625961ac70d1971ff6c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uh8N4CSRgK3BCak0"/></div></div><p class="mw mx gj gh gi my mz bd b be z dk translated">查看<a class="ae na" href="https://app.wandb.ai/stacey/curr_learn/reports/Layout%3A-Classify-Species--Vmlldzo0MDQ2NA" rel="noopener ugc nofollow" target="_blank">现场报道</a></p></figure><h1 id="a87e" class="ls lt it bd lu lv lw lx ly lz ma mb mc jz md ka me kc mf kd mg kf mh kg mi mj bi translated"><strong class="ak">使用实验跟踪作为模型的记录系统</strong></h1><p id="4fb7" class="pw-post-body-paragraph ki kj it kk b kl nn ju kn ko no jx kq kr np kt ku kv nq kx ky kz nr lb lc ld im bi translated">随着团队的成长和模型被部署到产品中，记录所发生的一切变得越来越重要。在丰田研究所，wandb实验链接被用作每一款ML车型的官方记录。如果在模型构建的下游发生了一些事情，他们可以将问题追溯到wandb培训运行。从一组实验中构建一份报告意味着对所做的工作有一个永久的记录，团队可以很容易地回去回顾到底发生了什么。</p></div></div>    
</body>
</html>