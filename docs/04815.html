<html>
<head>
<title>Targeting Users In Specific Area Using Geofence API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Geofence API锁定特定区域的用户</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/working-with-google-geofence-api-2e04a227ff27?source=collection_archive---------32-----------------------#2020-04-27">https://towardsdatascience.com/working-with-google-geofence-api-2e04a227ff27?source=collection_archive---------32-----------------------#2020-04-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3a23" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Geofence API为设备提供了监控全球圆形区域的能力</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7e684bf177fa04cd55604067c1bc2a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sYmaMqnk4UipxJVnxjESnQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@kobuagency?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> KOBU机构</a>在<a class="ae ky" href="https://unsplash.com/s/photos/google-map?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="554b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当你想通知用户他们是否在世界上的特定区域附近(如购物中心、机场、餐馆等)时，可以使用谷歌地理围栏API。).例如，客户安装了一个在线购物应用程序，如果他们在与该应用程序有联系的商店附近，商店可以在应用程序中生成通知，让客户知道他们附近的商店正在为他们提供特价。这样你可以吸引更多的用户。</p><h1 id="ae05" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">获取谷歌地图API密钥</h1><p id="2309" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">要使用Geofence API，您必须通过以下步骤获取Google Maps API密钥。</p><ul class=""><li id="a6b3" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">点击<a class="ae ky" href="https://console.cloud.google.com/projectcreate" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">这个</strong> </a>链接打开谷歌云平台，如果你还没有登录，那么请先登录并创建项目。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/fd176f54515eab78052525520663705b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*juDyDEVxkJje28ZIzxAmxw.png"/></div></div></figure><p id="40b6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以给这个项目起任何名字，或者你可以让它保持原样，然后现在点击<strong class="lb iu">创建</strong>。</p><ul class=""><li id="b681" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">现在确保您已经选择了新创建的项目。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/6362f0ce90b35bfe15439dd58fb85235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*odcQNCqjdiy6fz6Y7ppjtQ.png"/></div></div></figure><ul class=""><li id="5ea5" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">现在点击左边的菜单图标，选择<strong class="lb iu">API&amp;服务</strong>，然后从子列表中选择<strong class="lb iu">库</strong>。</li><li id="141a" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">搜索<strong class="lb iu"> Maps SDK for Android </strong>和<strong class="lb iu">启用</strong>该API(不要忘记启用API，因为这很重要)</li><li id="4416" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">现在再次点击左侧的菜单图标，选择<strong class="lb iu">凭证</strong>，然后选择<strong class="lb iu"> +创建凭证</strong>，最后点击<strong class="lb iu"> API键</strong></li><li id="9aec" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">复制这个API键并将其粘贴到string.xml文件中</li></ul><h1 id="ce3a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">我们将要建造的</h1><p id="591a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们将构建一个应用程序，允许您在地图上设置您的位置(或者准确地说是特定区域)。当你到达指定位置时，你的应用程序会用你在设置位置时定义的消息通知你。</p><p id="8f1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，你会有一个看起来像这样的应用程序。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/e0bce1d5771d381fceb579b8468e64ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YEt3ZrWm8FJNB8MsQ86V7w.png"/></div></div></figure><p id="c453" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要在地图上设置位置，您可以将标记拖到所需的位置。指定位置后，您可以点击<strong class="lb iu">继续</strong>按钮继续。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/2b58313fbe12e06bcd411862eabc280d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I6dndD0TiH850CUjfNHqVA.png"/></div></div></figure><p id="a550" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你现在兴奋吗？我相信你会的。</p><h1 id="39ec" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">我们会学到什么？</h1><ul class=""><li id="ed18" class="ms mt it lb b lc mn lf mo li nk lm nl lq nm lu mx my mz na bi translated">谷歌地图API</li><li id="293d" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">谷歌地理围栏API</li><li id="93ec" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">服务</li><li id="3c54" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">广播收音机</li><li id="f842" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">创建通知</li><li id="0ee9" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">在共享首选项中存储和检索自定义对象</li></ul><p id="5d0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们快速设置我们的项目并继续。</p><h1 id="614a" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">设置Android项目</h1><ul class=""><li id="7bb4" class="ms mt it lb b lc mn lf mo li nk lm nl lq nm lu mx my mz na bi translated">创建一个新的Android项目，选择空的activity，给你的项目起一个你想要的名字。</li><li id="2f39" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">在您的应用程序级<strong class="lb iu"> build.gradle </strong>中添加以下依赖项</li></ul><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="68a2" class="ns lw it no b gy nt nu l nv nw">implementation <strong class="no iu">'com.google.android.gms:play-services-location:16.0.0'<br/></strong>implementation <strong class="no iu">'com.google.android.gms:play-services-maps:16.0.0'<br/></strong>implementation <strong class="no iu">'com.google.code.gson:gson:2.8.5'<br/></strong>implementation <strong class="no iu">"com.google.android.material:material:1.1.0-alpha02"</strong></span></pre><ul class=""><li id="5dfc" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">如果在activity.xml文件中遇到以下错误</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/42670c568df079fc3861376cf0b4dab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N-YEbl1XrdzfR94IdPYLZw.png"/></div></div></figure><p id="2862" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后在您的<strong class="lb iu"> build.gradle </strong>中添加以下代码行</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="6dcf" class="ns lw it no b gy nt nu l nv nw">android{ defaultConfig {<br/>vectorDrawables.useSupportLibrary = <strong class="no iu">true</strong>}}</span></pre><ul class=""><li id="4bfa" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">在您的<code class="fe ny nz oa no b"><strong class="lb iu">AndroidManifest.xml</strong></code>文件中添加以下权限</li></ul><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="44b4" class="ns lw it no b gy nt nu l nv nw">&lt;<strong class="no iu">uses-permission android:name="android.permission.INTERNET" </strong>/&gt;<br/>&lt;<strong class="no iu">uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" </strong>/&gt;</span></pre><ul class=""><li id="88d2" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">现在将下面的元数据标签添加到您的<code class="fe ny nz oa no b"><strong class="lb iu">AndroidManifest.xml</strong></code>文件中的<code class="fe ny nz oa no b"><strong class="lb iu">&lt;application&gt;</strong></code>标签内，稍后我们将在这里添加<strong class="lb iu"> API_KEY </strong>。</li></ul><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="5edc" class="ns lw it no b gy nt nu l nv nw">&lt;<strong class="no iu">meta-data<br/>    android:name="com.google.android.geo.API_KEY"<br/>    android:value="API_KEY"</strong>/&gt;</span></pre><ul class=""><li id="f1e5" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">最后，同步项目和设置完成。</li></ul></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><p id="4775" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们快速熟悉一下这个应用中使用的一些android组件</p><p id="ee8c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">服务:</strong>服务是一个android组件，用来执行后台任务。任务可以是任何类型的，例如上传照片、同步服务器上的用户数据和生成通知等。</p><p id="2295" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">广播接收器:</strong>广播接收器也是android的一个基本组件，当你想在你的应用程序中执行一些基于未来事件的操作时，它会很方便。例如，您只希望在手机连接到WIFI时将用户数据上传到您的服务器，另一个例子是，您希望在用户重启手机时启动后台服务。</p><p id="8aaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">pending content:</strong><code class="fe ny nz oa no b">PendingIntent</code>类似于正常意图，只是不会立即执行。</p><h1 id="a810" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">让我们了解我们的班级</h1><p id="073d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我把所有的类、实用函数和常量都放在根包中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/a346ea1c5d4a425deff747c3dd6c08b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*ru-SwysDhs3tPZLpjq8lfw.png"/></div></figure><p id="052d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们逐一了解。</p><ul class=""><li id="5222" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated"><strong class="lb iu"> MainActivity.kt: </strong>这是我们的主屏幕，它将向您显示谷歌地图和右下角的两个操作按钮。第一个按钮将允许您放大地图，加号操作按钮将打开新活动<code class="fe ny nz oa no b"><strong class="lb iu">ReminderActivity.kt</strong></code>，在此屏幕上您可以选择您的位置，设置消息并保存提醒。</li><li id="a005" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated"><strong class="lb iu"> ReminderActivity.kt: </strong>正如我所解释的，这个活动将允许您设置位置并将提醒保存在共享首选项中。当您选择位置并保存它时，您将看到您指定的位置周围的圆圈。这个圆是你将在代码中定义的边界或半径。圆圈越大，意味着它将覆盖更大的区域。当你进入这个区域，你会收到一个通知。</li><li id="95fb" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated"><strong class="lb iu"> MyBroadcast Receiver: </strong>这是一个广播接收器，当用户到达指定位置时会被触发。当这个广播接收器触发时，它将执行后台服务。</li><li id="7ba7" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">这是一个将由我们的广播接收机执行的服务，当它执行时，它生成通知，让用户知道他已经到达他的目的地。</li><li id="e1e4" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">这是一个数据类，在它的构造函数中，我接受了四个参数，它们是唯一的id、纬度、经度、半径和一条消息。我们将把这些信息保存在共享首选项中，同时，我们将设置待定意向来生成通知。</li><li id="c6cf" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated"><strong class="lb iu">myreminderRepository . kt:</strong>如你所知，repository帮助我们获得应用程序的核心方法来执行我们为应用程序定义的操作。所以只有这个类负责添加一个新的提醒，删除提醒和设置挂起的意图。我们将总是创建这个类的对象并执行动作。</li><li id="5a07" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated"><strong class="lb iu"> Utils.kt: </strong>这是我们的实用程序类，包含四个方法。<code class="fe ny nz oa no b"><strong class="lb iu">vectorToBitmap()</strong></code>方法将矢量图像转换为位图，<code class="fe ny nz oa no b"><strong class="lb iu">showReminderInMap()</strong></code>方法在地图上显示提醒，这是围绕指定位置画圆的方法。而<code class="fe ny nz oa no b"><strong class="lb iu">sendNotification()</strong></code>方法创建了通知，这个方法由我们的后台服务调用。最后一个方法是<code class="fe ny nz oa no b"><strong class="lb iu">getUniqueId()</strong></code>，它显然返回唯一的id。</li><li id="b80d" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated"><strong class="lb iu"> AppConstants.kt: </strong>这个类包含了这个应用使用的所有常量。这个类还包含一个服务方法和两个调用<code class="fe ny nz oa no b">MainActivity.kt</code>和<code class="fe ny nz oa no b">ReminderActivity.kt</code>活动的方法。</li></ul></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><p id="d516" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">说够了吗？让我们回到正题…</p><p id="6cd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您创建一个项目时，您将拥有一个默认的ActivityMain.kt类。我要你再创建一个类，命名为ReminderActivity.kt，在这个类中扩展<code class="fe ny nz oa no b">AppCompatActivity()</code>类，实现<code class="fe ny nz oa no b">OnMapReadyCallback</code>谷歌地图的接口，实现其方法<code class="fe ny nz oa no b">onMapReady()</code>。现在，让一切保持原样。</p><p id="394a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们将创建我们的AppConstants类，并定义所有的常量和一些方法。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="2f59" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个类中，我们定义了我们的常量和三个方法，<strong class="lb iu">newintentforminactivity()</strong>方法将调用<code class="fe ny nz oa no b">MainActivity.kt</code>类，<strong class="lb iu">newIntentForReminderActivity()</strong>将调用<code class="fe ny nz oa no b">ReminderActivity.kt</code>类。我们的广播接收器将调用enqueueWork()方法来生成通知。<br/> <strong class="lb iu">提示:</strong>所有的常量和方法都定义在<code class="fe ny nz oa no b"><strong class="lb iu">companion object</strong></code>里面，这是因为无论何时我们需要调用这些方法中的任何一个，我们都不必创建这个类的对象。</p><p id="02c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们将创建<strong class="lb iu"> Utils.kt </strong>并添加以下方法</p><h2 id="8abd" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">vectorToBimap()</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="0b46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们调用这个方法时，我们必须传递两个参数，即<code class="fe ny nz oa no b">context.resources</code>和需要转换成位图的图像的id。<code class="fe ny nz oa no b">context.<em class="ow">resources</em></code> <em class="ow"> </em>为您的应用程序返回一个资源实例。在这个方法中，我得到了drawable对象，创建了<strong class="lb iu">位图</strong>和<strong class="lb iu">画布</strong>对象。我们现在在<code class="fe ny nz oa no b">vectorDrawable</code>中有了我们的图像，我们将把这个对象转换成<code class="fe ny nz oa no b">bitmap</code>，然后在画布上绘制位图，设置它的边界并返回。</p><p id="fc71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">提示:</strong>如果你不熟悉<strong class="lb iu">画布</strong>，那么你可以把它想象成一张白纸，你可以在上面画出任何形状。</p><h2 id="12e9" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">showReminderInMap()</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="ac6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ny nz oa no b"><strong class="lb iu">showReminderInMap()</strong></code>方法将上下文、<strong class="lb iu"> GoogleMap </strong>对象和<strong class="lb iu"> MyReminder </strong>类对象作为参数，并检查<code class="fe ny nz oa no b">myReminder</code>是否有值，然后继续执行，否则不执行任何操作。在<code class="fe ny nz oa no b"><strong class="lb iu"><em class="ow">if</em></strong></code>语句中，我从myReminder对象中获取纬度和经度，并将其转换为<code class="fe ny nz oa no b">LatLng</code>，在第二个<code class="fe ny nz oa no b"><strong class="lb iu"><em class="ow">if</em></strong></code>语句中，我在指定位置周围画圆。一般来说，这种方法用于在指定的位置上画圆。</p><h2 id="a588" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">发送通知()</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="45d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ny nz oa no b">sendNotification()</code>方法非常简单，它除了创建通知之外什么也不做。从服务中调用此方法来显示通知。</p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h2 id="efd0" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">MyBroadcastReceiver.kt类</h2><p id="622f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">现在在您的根目录中创建这个类，并将这个广播接收器添加到您的<code class="fe ny nz oa no b"><strong class="lb iu">AndroidManifest.xml</strong></code>文件中。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="1aec" class="ns lw it no b gy nt nu l nv nw">&lt;<strong class="no iu">receiver<br/>    android:name=".MyBroadcastReceiver"<br/>    android:enabled="true"<br/>    android:exported="true" </strong>/&gt;</span></pre><p id="1078" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个类扩展了抽象类<code class="fe ny nz oa no b">BroadcastReceiver()</code>并实现了它的<code class="fe ny nz oa no b">onReceive()</code>方法。当onReceive()方法被执行时，它将执行<code class="fe ny nz oa no b">AppConstants.kt.</code>的<code class="fe ny nz oa no b">enqueueWork()</code>方法</p><p id="4eb9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您添加提醒时，该接收器将通过<code class="fe ny nz oa no b">PendingIntent</code>注册。</p><h2 id="8067" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">GeofenceTransitionService.kt</h2><p id="98ef" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">创建这个类并在<code class="fe ny nz oa no b">AndroidManifest.xml</code>文件中声明它</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="a133" class="ns lw it no b gy nt nu l nv nw">&lt;<strong class="no iu">service<br/>    android:name=".GeofenceTransitionService"<br/>    android:exported="true"<br/>    android:permission="android.permission.BIND_JOB_SERVICE" </strong>/&gt;</span></pre><p id="1529" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意:</strong>如果在清单中声明了一个作业服务，但没有使用<strong class="lb iu"> BIND_JOB_SERVICE </strong>权限保护，该服务将被系统忽略。</p><p id="93a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个扩展了<code class="fe ny nz oa no b">JobIntentService</code>类的服务，IntentService或JobIntentService是一个在后台独立线程上运行的服务，它在任务完成时被销毁。要使用这个类，我们必须实现它所需的方法<code class="fe ny nz oa no b"><strong class="lb iu">onHandleWork()</strong></code>。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="d4d5" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">class </strong>GeofenceTransitionService : JobIntentService() {</span><span id="0870" class="ns lw it no b gy ox nu l nv nw"><strong class="no iu">override fun </strong>onHandleWork(intent: Intent) {<br/><br/>    <strong class="no iu">val </strong>geofencingEvent = GeofencingEvent.fromIntent(intent)<br/>    <strong class="no iu">repositoryMy </strong>= MyReminderRepository(<strong class="no iu">this</strong>)<br/><br/>    <strong class="no iu">if </strong>(geofencingEvent.hasError()) {<br/>        Log.e(AppConstants.<strong class="no iu">LOG_TAG</strong>, <strong class="no iu">"An error occured"</strong>)<br/>        <strong class="no iu">return<br/>    </strong>}<br/>    handleEvent(geofencingEvent)<br/>}<br/>}</span></pre><p id="721b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个方法中，我们可以完成我们的任务。我在这个方法中获取<code class="fe ny nz oa no b"><strong class="lb iu">GeofencingEvent</strong></code>类的对象，如果有问题，我们显示错误消息，否则我们调用<code class="fe ny nz oa no b">handleEvent()</code>方法。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="f34c" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private fun </strong>handleEvent(event: GeofencingEvent) {<br/><br/>    <strong class="no iu">if </strong>(event.<em class="ow">geofenceTransition </em>== Geofence.<em class="ow">GEOFENCE_TRANSITION_ENTER</em>) {<br/><br/>        <strong class="no iu">val </strong>reminder = getFirstReminder(event.<em class="ow">triggeringGeofences</em>)<br/>        <strong class="no iu">val </strong>message = reminder?.<strong class="no iu">message<br/>        val </strong>latLng = reminder?.<strong class="no iu">latLng<br/>        if </strong>(message != <strong class="no iu">null </strong>&amp;&amp; latLng != <strong class="no iu">null</strong>) {<br/>            <em class="ow">sendNotification</em>(<strong class="no iu">this</strong>, message, latLng)<br/>        }<br/>    }<br/>}</span></pre><p id="0b4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在此方法中，我们首先使用GeofencingEvent对象，检查用户是否进入了指定区域，如果是，则从存储库中获取reminder对象，检索其数据并发送通知。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="7b6b" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private fun </strong>getFirstReminder(triggeringGeofences: List&lt;Geofence&gt;): MyReminder? {<br/>    <strong class="no iu">val </strong>firstGeofence = triggeringGeofences[0]<br/>    <strong class="no iu">return repositoryMy</strong>.get(firstGeofence.<em class="ow">requestId</em>)<br/>}</span></pre><p id="4c90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ny nz oa no b"><strong class="lb iu">getFirstReminder()</strong></code>方法从<code class="fe ny nz oa no b">MyRepository</code>类返回<code class="fe ny nz oa no b">MyReminder</code>类的对象。</p><p id="4fb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是这个服务类的完整代码</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="941a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">提示:</strong> <code class="fe ny nz oa no b"><strong class="lb iu">lateinit</strong></code> <strong class="lb iu"> </strong>是Kotlin中的一个关键字，可以让你在声明的时候不用初始化它，但是在使用之前应该初始化它，否则你会遇到<strong class="lb iu"> NullPointerException </strong>。</p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h2 id="10d7" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">MyReminderRepository.kt</h2><p id="d741" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">您可以将该类视为本地服务器，这意味着它为我们提供了在地图上执行任何操作所需的一切，例如添加提醒或删除提醒以及维护所有提醒。</p><p id="33ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下代码片段创建了一个<strong class="lb iu"> GeofencingClient </strong>对象，帮助您操作地理围栏。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="f34b" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private val geofencingClient </strong>= LocationServices.getGeofencingClient(<strong class="no iu">context</strong>)</span></pre><p id="9901" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我们得到了<strong class="lb iu"> SharedPreference </strong>对象和<strong class="lb iu"> Gson </strong>对象</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="6b1b" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private val preferences </strong>= <strong class="no iu">context</strong>.getSharedPreferences(<em class="ow">PREFS_NAME</em>, Context.<em class="ow">MODE_PRIVATE</em>)<br/><strong class="no iu">private val gson </strong>= Gson()</span></pre><p id="7419" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<code class="fe ny nz oa no b">SharedPreference</code>中，我们将存储提醒，并使用<code class="fe ny nz oa no b">Gson</code>对象将json字符串转换成Java对象，反之亦然。既然SharedPreference只能保存键值对形式的原始值，但是我们想要存储我们的类对象，那么这怎么可能呢？。显然，我们可以将我们的对象转换成json字符串并存储在SharedPreference中，每当我们需要使用它时，我们都会将其转换成一个真实的对象。</p><h2 id="1fb1" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">buildGeofence():</h2><p id="e939" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">纬度、经度和半径的组合称为地理围栏。它是地图上特定位置的圆形区域。每当用户进入这个区域，应用程序就会触发特定的行为。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="c4d2" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private fun </strong>buildGeofence(myReminder: MyReminder): Geofence? {<br/>    <strong class="no iu">val </strong>latitude = myReminder.<strong class="no iu">latLng</strong>?.<strong class="no iu">latitude<br/>    val </strong>longitude = myReminder.<strong class="no iu">latLng</strong>?.<strong class="no iu">longitude<br/>    val </strong>radius = myReminder.<strong class="no iu">radius<br/><br/>    if </strong>(latitude != <strong class="no iu">null </strong>&amp;&amp; longitude != <strong class="no iu">null </strong>&amp;&amp; radius != <strong class="no iu">null</strong>) {<br/>        <strong class="no iu">return </strong>Geofence.Builder()<br/>            .setRequestId(myReminder.<strong class="no iu">id</strong>)<br/>            .setCircularRegion(<br/>                latitude,<br/>                longitude,<br/>                radius.toFloat()<br/>            )<br/>            .setTransitionTypes(Geofence.<em class="ow">GEOFENCE_TRANSITION_ENTER</em>)<br/>            .setExpirationDuration(Geofence.<em class="ow">NEVER_EXPIRE</em>)<br/>            .build()<br/>    }<br/><br/>    <strong class="no iu">return null<br/></strong>}</span></pre><p id="7880" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看看代码，我们正在使用<strong class="lb iu"> Geofence构建地理围栏。构建器()</strong>。</p><p id="dafa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在方法<strong class="lb iu"> setRequestId() </strong>中，我传递了唯一的Id，因为每个geofence都是唯一的，您将从您的模型类中获得这个id。</p><p id="2f80" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<strong class="lb iu"> setCircularRegion() </strong>中，我正在设置我的纬度、经度和半径，<strong class="lb iu">所有这些参数一起在一个特定的位置上形成一个圆</strong>。</p><p id="3bed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> setTransitionTypes() </strong>定义了过渡类型，可以使用<code class="fe ny nz oa no b"><em class="ow">GEOFENCE_TRANSITION_ENTER</em></code> <em class="ow"> </em>在用户进入定义区域时触发事件。</p><p id="2dcb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">setExpirationDuration()</strong>方法设置geofence的到期时间，我们使用的是<code class="fe ny nz oa no b"><em class="ow">NEVER_EXPIRE</em></code> <em class="ow"> </em>，这意味着它永远不会到期，直到用户删除它。</p><h2 id="9023" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">buildFencingRequest():</h2><p id="1f46" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">您将使用此方法构建geofence请求。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="98c5" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private fun </strong>buildGeofencingRequest(geofence: Geofence): GeofencingRequest {<br/>    <strong class="no iu">return </strong>GeofencingRequest.Builder()<br/>        .setInitialTrigger(0)<br/>        .addGeofences(<em class="ow">listOf</em>(geofence))<br/>        .build()<br/>}</span></pre><p id="eade" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，您将<strong class="lb iu">setinitiatrigger()</strong>设置为0，这意味着您不希望您的应用程序在已经位于geofence内部时触发事件。下一个addGeofences()方法将请求添加到geofence。</p><h2 id="eaff" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">建筑地理围栏待定内容:</h2><p id="5b54" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">正如您在代码片段中看到的，我们在intent对象中传递MyBroadcastReceiver，这意味着当调用此待定intent时，它将调用BroadcastReceiver，而此Receiver将调用<strong class="lb iu">geofencetransationservice。</strong></p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="e19f" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private val geofencePendingIntent</strong>: PendingIntent <strong class="no iu">by </strong><em class="ow">lazy </em><strong class="no iu">{<br/>    val </strong>intent = Intent(<strong class="no iu">context</strong>, MyBroadcastReceiver::<strong class="no iu">class</strong>.<em class="ow">java</em>)<br/>    PendingIntent.getBroadcast(<br/>        <strong class="no iu">context</strong>,<br/>        0,<br/>        intent,<br/>        PendingIntent.<em class="ow">FLAG_UPDATE_CURRENT<br/>    </em>)<br/><strong class="no iu">}</strong></span></pre><p id="d7e0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该代码只有在<code class="fe ny nz oa no b"><em class="ow">GEOFENCE_TRANSITION_ENTER</em></code>事件被触发时才会被执行。</p><p id="3c71" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">提示:通过</strong> <em class="ow">惰性属性，</em>该值仅在第一次使用时计算。</p><h2 id="0260" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">添加():</h2><p id="0eb3" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这个<code class="fe ny nz oa no b">add()</code>方法将提醒添加到SharedPreference中，并将请求添加到geofence中。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="332c" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">fun </strong>add(myReminder: MyReminder, success: () -&gt; Unit, failure: (error: String) -&gt; Unit)<br/>{<br/>    <strong class="no iu">val </strong>geofence = buildGeofence(myReminder)<br/>    <strong class="no iu">if </strong>(geofence != <strong class="no iu">null </strong>&amp;&amp; ContextCompat.checkSelfPermission(<strong class="no iu">context</strong>, android.Manifest.permission.<em class="ow">ACCESS_FINE_LOCATION</em>) == PackageManager.<em class="ow">PERMISSION_GRANTED</em>) {<br/>        <strong class="no iu">geofencingClient</strong>.addGeofences(buildGeofencingRequest(geofence), <strong class="no iu">geofencePendingIntent</strong>)<br/>            .addOnSuccessListener <strong class="no iu">{<br/>                </strong>saveAll(getAll() + myReminder)<br/>                success()<br/>            <strong class="no iu">}<br/>            </strong>.addOnFailureListener <strong class="no iu">{<br/>                </strong>failure(<strong class="no iu">"An error occured"</strong>)<br/>            <strong class="no iu">}<br/><br/>    </strong>}<br/>}</span></pre><p id="8388" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我们检查权限是否被授予，然后我们继续，接下来，我们使用<strong class="lb iu"> geofencingClient </strong>创建地理围栏。如果成功，那么只有我们将保存在共享首选项中，否则报告错误消息。</p><h2 id="8a29" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">移除():</h2><p id="c8d0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这个方法只是从列表中删除提醒。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="cec5" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">fun </strong>remove(myReminder: MyReminder) {<br/>    <strong class="no iu">val </strong>list = getAll() - myReminder<br/>    saveAll(list)<br/>}</span></pre><h2 id="7ef3" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">saveAll():</h2><p id="059d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">此方法会将列表中的所有提醒事项添加到共享偏好设置中。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="7c40" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private fun </strong>saveAll(list: List&lt;MyReminder&gt;) {<br/>    <strong class="no iu">preferences<br/>        </strong>.edit()<br/>        .putString(<em class="ow">REMINDERS</em>, <strong class="no iu">gson</strong>.toJson(list))<br/>        .apply()<br/>}</span></pre><p id="e65c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，我们将列表转换为Json字符串，然后存储它。</p><h2 id="5f51" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">getAll():</h2><p id="bb5a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">该方法返回我们存储在共享首选项中的所有提醒列表。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="8be1" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">fun </strong>getAll(): List&lt;MyReminder&gt; {<br/>    <strong class="no iu">if </strong>(<strong class="no iu">preferences</strong>.contains(<em class="ow">REMINDERS</em>)) {<br/>        <strong class="no iu">val </strong>remindersString = <strong class="no iu">preferences</strong>.getString(<em class="ow">REMINDERS</em>, <strong class="no iu">null</strong>)<br/>        <strong class="no iu">val </strong>arrayOfReminders = <strong class="no iu">gson</strong>.fromJson(<br/>            remindersString,<br/>            Array&lt;MyReminder&gt;::<strong class="no iu">class</strong>.<em class="ow">java<br/>        </em>)<br/>        <strong class="no iu">if </strong>(arrayOfReminders != <strong class="no iu">null</strong>) {<br/>            <strong class="no iu">return </strong>arrayOfReminders.<em class="ow">toList</em>()<br/>        }<br/>    }<br/>    <strong class="no iu">return </strong><em class="ow">listOf</em>()<br/>}</span></pre><h2 id="0dc8" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">getLast():</h2><p id="1713" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这个函数返回添加到列表中的提醒。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="1ca5" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">fun </strong>getLast() = getAll().<em class="ow">lastOrNull</em>()</span></pre><p id="35cf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意这个函数首先调用返回列表的<code class="fe ny nz oa no b">getAll()</code>方法，我们调用<code class="fe ny nz oa no b">lastOrNull()</code>函数，它是<code class="fe ny nz oa no b">List</code>类的一个方法，这个方法返回最后一个值。</p><h2 id="6691" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">get():</h2><p id="6500" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果列表不是<code class="fe ny nz oa no b">null.</code>，该方法从列表中返回第一个提醒</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="0267" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">fun </strong>get(requestId: String?) = getAll().<em class="ow">firstOrNull </em><strong class="no iu">{ it</strong>.<strong class="no iu">id </strong>== requestId <strong class="no iu">}</strong></span></pre><p id="2b0f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe ny nz oa no b">{it.id == requestId }</code>是执行空值检查的lambda表达式。当lambda表达式中只有一个参数时，可以使用<code class="fe ny nz oa no b"><strong class="lb iu">it</strong></code>。</p><p id="00fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">MyReminderRepository.kt的完整代码</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h2 id="991f" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">ReminderActivity.kt:</h2><p id="12c7" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这个活动允许我们在指定的位置添加新的提醒。</p><p id="a0f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，在本活动中创建这些对象。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="ee4e" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private lateinit var map</strong>: GoogleMap<br/><br/><strong class="no iu">lateinit var myRepository</strong>: MyReminderRepository<br/><br/><strong class="no iu">private var reminder </strong>= MyReminder(latLng = <strong class="no iu">null</strong>, radius = <strong class="no iu">null</strong>, message = <strong class="no iu">null</strong>)</span></pre><p id="d18d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在将下面的代码粘贴到您的<code class="fe ny nz oa no b">onCreate()</code>方法中</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="05f9" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">override fun </strong>onCreate(savedInstanceState: Bundle?) {<br/>  <strong class="no iu">super</strong>.onCreate(savedInstanceState)<br/>  setContentView(R.layout.<em class="ow">activity_new_reminder</em>)<br/>  <strong class="no iu">myRepository </strong>= MyReminderRepository(<strong class="no iu">this</strong>)<br/>  <strong class="no iu">val </strong>mapFragment = <em class="ow">supportFragmentManager<br/>      </em>.findFragmentById(R.id.<em class="ow">map</em>) <strong class="no iu">as </strong>SupportMapFragment<br/>  mapFragment.getMapAsync(<strong class="no iu">this</strong>)<br/><br/>  instructionTitle.<em class="ow">visibility </em>= View.<em class="ow">GONE<br/>  </em>radiusDescription.<em class="ow">visibility </em>= View.<em class="ow">GONE<br/>  </em>message.<em class="ow">visibility </em>= View.<em class="ow">GONE<br/><br/></em>}</span></pre><p id="5eff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个onCreate()方法中，我初始化了我的存储库实例变量并设置了映射。最初，我隐藏了所有的文本视图。</p><h2 id="b25d" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">中央摄像机():</h2><p id="d191" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在这种方法中，我从意图中获取缩放值，并将相机设置在位置的中心。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="e064" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private fun </strong>centerCamera() {<br/>  <strong class="no iu">val </strong>latLng = <em class="ow">intent</em>.<em class="ow">extras</em>?.get(AppConstants.<strong class="no iu">LAT_LNG</strong>) <strong class="no iu">as </strong>LatLng<br/>  <strong class="no iu">val </strong>zoom = <em class="ow">intent</em>.<em class="ow">extras</em>?.get(AppConstants.<strong class="no iu">ZOOM</strong>) <strong class="no iu">as </strong>Float<br/>  <strong class="no iu">map</strong>.moveCamera(CameraUpdateFactory.newLatLngZoom(latLng, zoom))<br/>}</span></pre><h2 id="16cb" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">showReminderUpdate():</h2><p id="71bd" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">此方法更新提醒。在调用这个方法的时候，它会显示出这个位置周围的圆圈。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="ffd8" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private fun </strong>showReminderUpdate() {<br/>  <strong class="no iu">map</strong>.clear()<br/>  <em class="ow">showReminderInMap</em>(<strong class="no iu">this</strong>, <strong class="no iu">map</strong>, <strong class="no iu">reminder</strong>)<br/>}</span></pre><h2 id="d720" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">showConfigurationLocationStep():</h2><p id="a19f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这种方法只是指导您如何在地图上导航。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="5fa5" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private fun </strong>showConfigureLocationStep() {<br/>  marker.<em class="ow">visibility </em>= View.<em class="ow">VISIBLE<br/>  </em>instructionTitle.<em class="ow">visibility </em>= View.<em class="ow">VISIBLE<br/>  </em>radiusDescription.<em class="ow">visibility </em>= View.<em class="ow">GONE<br/>  </em>message.<em class="ow">visibility </em>= View.<em class="ow">GONE<br/>  </em>instructionTitle.<em class="ow">text </em>= <strong class="no iu">"Drag map to set location"<br/>  </strong>next.setOnClickListener <strong class="no iu">{<br/>    reminder</strong>.<strong class="no iu">latLng </strong>= <strong class="no iu">map</strong>.<em class="ow">cameraPosition</em>.<strong class="no iu">target<br/>    </strong>showConfigureRadiusStep()<br/>  <strong class="no iu">}<br/><br/>  </strong>showReminderUpdate()<br/>}</span></pre><h2 id="02ab" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">showConfigurationMessageStep():</h2><p id="4904" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这个方法和上面的方法一样，它指导你如何添加消息。当您收到通知时，会显示此消息。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="a2a2" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private fun </strong>showConfigureMessageStep() {<br/>  marker.<em class="ow">visibility </em>= View.<em class="ow">GONE<br/>  </em>instructionTitle.<em class="ow">visibility </em>= View.<em class="ow">VISIBLE<br/>  </em>message.<em class="ow">visibility </em>= View.<em class="ow">VISIBLE<br/>  </em>instructionTitle.<em class="ow">text </em>= <strong class="no iu">"Enter a message"<br/>  </strong>next.setOnClickListener <strong class="no iu">{<br/><br/>    reminder</strong>.<strong class="no iu">message </strong>= message.<em class="ow">text</em>.toString()<br/><br/>    <strong class="no iu">if </strong>(<strong class="no iu">reminder</strong>.<strong class="no iu">message</strong>.<em class="ow">isNullOrEmpty</em>()) {<br/>      message.<em class="ow">error </em>= <strong class="no iu">"Message Error"<br/>    </strong>} <strong class="no iu">else </strong>{<br/>      addReminder(<strong class="no iu">reminder</strong>)<br/>    }<br/>  <strong class="no iu">}<br/><br/>  </strong>showReminderUpdate()<br/>}</span></pre><h2 id="3c18" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">addReminder():</h2><p id="0a8c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">该方法从MyReminderRepository类调用add方法并添加提醒。如果提醒添加成功，那么它会在底部显示一条消息“提醒已添加”,否则会显示一条失败消息。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="c9b1" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private fun </strong>addReminder(myReminder: MyReminder) {<br/><br/>  <strong class="no iu">myRepository</strong>.add(myReminder,<br/>      success = <strong class="no iu">{<br/>        </strong>setResult(Activity.<em class="ow">RESULT_OK</em>)<br/>        finish()<br/>      <strong class="no iu">}</strong>,<br/>      failure = <strong class="no iu">{<br/>        </strong>Snackbar.make(main, <strong class="no iu">it</strong>, Snackbar.<em class="ow">LENGTH_LONG</em>).show()<br/>      <strong class="no iu">}</strong>)<br/>}</span></pre><p id="4858" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后修改您的onMapReady()</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="f430" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">override fun </strong>onMapReady(googleMap: GoogleMap) {<br/>  <strong class="no iu">map </strong>= googleMap<br/>  <strong class="no iu">map</strong>.<em class="ow">uiSettings</em>.<em class="ow">isMapToolbarEnabled </em>= <strong class="no iu">false<br/><br/>  </strong>centerCamera()<br/><br/>  showConfigureLocationStep()<br/>}</span></pre><p id="8785" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个方法中，我们将<code class="fe ny nz oa no b">GoogleMap</code>对象分配给我们的地图，然后配置设置。</p><p id="9a1d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此活动的完整代码</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="9184" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此活动的布局文件</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="ba8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在<fragment>标签中你唯一能注意到的是"<strong class="lb iu">Android:name = " com . Google . Android . GMS . maps . supportmapfragment "</strong>行，这一行帮助你在屏幕上添加谷歌地图。这是添加地图最简单的方法。这个文件中的其余代码对您来说一定非常熟悉。</fragment></p></div><div class="ab cl ob oc hx od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="im in io ip iq"><h2 id="1387" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">主活动. kt:</h2><p id="6a22" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">最后，这是我们代码的最后一部分。这是我们的家庭活动，当你第一次与应用程序互动时，你会看到它。</p><p id="3014" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，在您的活动中添加这些侦听器，并实现它的所有方法。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="fae9" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">class </strong>MainActivity : AppCompatActivity(), OnMapReadyCallback, GoogleMap.OnMarkerClickListener</span></pre><p id="6c6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在创建这些实例变量。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="cb16" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">lateinit var myRepository</strong>: MyReminderRepository<br/><br/> <strong class="no iu">private var map</strong>: GoogleMap? = <strong class="no iu">null<br/><br/> private lateinit var locationManager</strong>: LocationManager</span></pre><h2 id="e623" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">onCreate():</h2><p id="2e83" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在这个方法中，我们首先初始化实例变量，然后从activity_main.xml文件的一个片段和动作按钮上的侦听器中获取一个映射。最初，这些按钮将不可见，直到用户给予<strong class="lb iu"> ACCESS_FINE_LOCATION </strong>权限<strong class="lb iu">。</strong>当用户授予权限时，我们在<code class="fe ny nz oa no b"><strong class="lb iu">onMapAndPermissionReady()</strong></code>方法中使按钮对用户可见。</p><p id="cd88" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看看下面的代码，我在按钮上附加了一个监听器，在lambda表达式中，我调用了Google map类的<code class="fe ny nz oa no b"><strong class="lb iu">run</strong></code>方法。这个<code class="fe ny nz oa no b">run</code>也是一个λ函数。当用户按下<strong class="lb iu"> (+) </strong>动作按钮时，我们将用户带到ReminderActivity.kt类。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="0554" class="ns lw it no b gy nt nu l nv nw">actionNewReminder.setOnClickListener <strong class="no iu">{<br/>    map</strong>?.<em class="ow">run </em><strong class="no iu">{<br/>        val </strong>intent = AppConstants.newIntentForReminderActivity(<br/>            <strong class="no iu">this</strong>@MainActivity,<br/>            <em class="ow">cameraPosition</em>.<strong class="no iu">target</strong>,<br/>            <em class="ow">cameraPosition</em>.<strong class="no iu">zoom<br/>        </strong>)<br/>        startActivityForResult(intent, AppConstants.<strong class="no iu">REMINDER_REQUEST_CODE</strong>)<br/>    <strong class="no iu">}<br/>}</strong></span></pre><h2 id="4d3c" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">onMapAndPermissionReady():</h2><p id="cdf1" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">当许可被授予并且地图不等于<code class="fe ny nz oa no b">null</code>时，那么我们使我们的按钮可见并且添加一个监听器到<code class="fe ny nz oa no b">actionCurrentLocation</code>按钮。现在，如果用户按下<code class="fe ny nz oa no b">actionCurrentLocation</code>按钮，我们将获得位置提供者和用户的最后已知位置。如果这个不为空，那么我们将把摄像机移动到最后一个已知的位置。</p><h2 id="53bd" class="ns lw it bd lx ol om dn mb on oo dp mf li op oq mh lm or os mj lq ot ou ml ov bi translated">onMarkerClick():</h2><p id="7f4a" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">当用户点击标记时，会弹出一个警告对话框，询问用户是否想删除提醒，如果他按“是”，那么该提醒会从列表中删除。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="afce" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">override fun </strong>onMarkerClick(marker: Marker): Boolean {<br/>    <strong class="no iu">val </strong>reminder = <strong class="no iu">myRepository</strong>.get(marker.<em class="ow">tag </em><strong class="no iu">as </strong>String)<br/><br/>    <strong class="no iu">if </strong>(reminder != <strong class="no iu">null</strong>) {<br/>        showReminderRemoveAlert(reminder)<br/>    }<br/><br/>    <strong class="no iu">return true<br/></strong>}</span></pre><p id="9c41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">showreminderemovealert():</strong></p><p id="b245" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个方法只创建一个有两个选项的警告对话框，即<strong class="lb iu"> OK </strong>和<strong class="lb iu"> Cancel </strong>，如果用户点击“OK”，那么我们调用removeReminder()来删除它。</p><pre class="kj kk kl km gt nn no np nq aw nr bi"><span id="6dc7" class="ns lw it no b gy nt nu l nv nw"><strong class="no iu">private fun </strong>showReminderRemoveAlert(myReminder: MyReminder) {<br/>    <strong class="no iu">val </strong>alertDialog = AlertDialog.Builder(<strong class="no iu">this</strong>).create()<br/>    alertDialog.<em class="ow">run </em><strong class="no iu">{<br/>        </strong>setMessage(<strong class="no iu">"Reminder Removed"</strong>)<br/>        setButton(<br/>            AlertDialog.<em class="ow">BUTTON_POSITIVE</em>,<br/>            <strong class="no iu">"OK"<br/>        </strong>) <strong class="no iu">{ </strong>dialog, _ <strong class="no iu">-&gt;<br/>            </strong>removeReminder(myReminder)<br/>            dialog.dismiss()<br/>        <strong class="no iu">}<br/>        </strong>setButton(<br/>            AlertDialog.<em class="ow">BUTTON_NEGATIVE</em>,<br/>            <strong class="no iu">"Cancel"<br/>        </strong>) <strong class="no iu">{ </strong>dialog, _ <strong class="no iu">-&gt;<br/>            </strong>dialog.dismiss()<br/>        <strong class="no iu">}<br/>        </strong>show()<br/>    <strong class="no iu">}<br/></strong>}</span></pre><p id="ecd8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">ActivityMain.kt文件的完整代码</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="26ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们终于有了activity_main.xml文件</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><h1 id="487d" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">运行和测试</h1><ul class=""><li id="8f3b" class="ms mt it lb b lc mn lf mo li nk lm nl lq nm lu mx my mz na bi translated">运行应用程序并给予许可。</li><li id="c936" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">如果你在模拟器上运行应用程序，然后点击三个点，你会看到下面的屏幕。现在设置任何你想要的位置(我设置了新德里的康诺特广场)。并保存该位置。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/9bd768102573ef9f7965b61b800f8a2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ITjVhCFOlevpDQAJMLxoBA.png"/></div></div></figure><ul class=""><li id="6a78" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">现在，单击应用程序上的第一个操作按钮，您会看到您的地图将导航到指定的位置。</li><li id="4ccc" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">现在通过点击(+)操作按钮添加提醒，拖动地图设置您的位置，点击继续，现在输入您的消息，再次点击继续。现在您的提醒已保存。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/b69e53847bc493808994226bc46ed3ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*wS7U_flUfCY3CoA2nvkQAg.png"/></div></figure><ul class=""><li id="fd83" class="ms mt it lb b lc ld lf lg li mu lm mv lq mw lu mx my mz na bi translated">现在再次点击三个点，改变位置到模拟器的其他地方，并保存它。</li><li id="f14c" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">点击应用程序的第一个按钮，你将到达你在模拟器上设置的位置。</li><li id="0eab" class="ms mt it lb b lc nd lf ne li nf lm ng lq nh lu mx my mz na bi translated">最后，在模拟器中，设置保存提醒时的位置。等几秒钟，你会收到通知。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/218d8eb0a2e34336434d1d9e831506c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*mZjfCgPtTzKUyZvrFED1Mw.png"/></div></figure><p id="b10c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你的项目有任何困难，那么你可以从我的<a class="ae ky" href="https://github.com/himanshujbd/Google-Geofence" rel="noopener ugc nofollow" target="_blank"> Github </a>项目中寻求帮助。</p><p id="9a5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你喜欢读这篇文章，你也可以访问我的<a class="ae ky" href="http://thehimanshuverma.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">网站</strong> </a> <strong class="lb iu"> </strong>，在那里我会定期发布文章。</p><p id="231f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://mailchi.mp/b08da935e5d9/himanshuverma" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">订阅</strong> </a>我的邮件列表，以便在您的收件箱中直接获得我的文章，并且不要忘记关注我自己在Medium上发表的文章<a class="ae ky" href="https://medium.com/the-code-monster" rel="noopener"><strong class="lb iu">The Code Monster</strong></a>来完善您的技术知识。</p><h1 id="688e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="a2cd" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">我们已经了解了如何在自己的项目中使用谷歌地图和Geofence APIs，还了解了服务和广播接收器。除此之外，我们还学习了一个技巧，使用Gson在SharedPreference中存储自定义java对象，并使用相同的方法检索它们。</p></div></div>    
</body>
</html>