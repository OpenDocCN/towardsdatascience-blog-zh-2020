<html>
<head>
<title>Exploring Netflix Data in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Python 中探索网飞数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/exploring-netflix-data-in-python-eb03e8f3944c?source=collection_archive---------13-----------------------#2020-03-23">https://towardsdatascience.com/exploring-netflix-data-in-python-eb03e8f3944c?source=collection_archive---------13-----------------------#2020-03-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="57f1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">网飞数据的探索性数据分析</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/353445657052718f08bcf575e3be2528.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rmB5iEYR6zkWrzrZcCcFog.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/photos/11SgH7U6TmI" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="2e20" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://flixable.com/" rel="noopener ugc nofollow" target="_blank"> Flixable </a>是一个视频流媒体服务搜索引擎，提供网飞电影和节目的完整列表。搜索引擎发布了<em class="lv">网飞电影和电视节目</em>数据集，其中包括 2019 年可用的电影和节目的完整列表。</p><p id="9f51" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本帖中，我们将对<em class="lv">网飞电影和电视节目</em>数据集进行探索性数据分析。数据可以在<a class="ae ky" href="https://www.kaggle.com/shivamb/netflix-shows" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="ed5c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧！</p><p id="1be5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们导入 Pandas 并将数据读入数据框:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="0670" class="mb mc it lx b gy md me l mf mg">import pandas as pd <br/>df = pd.read_csv("netflix_titles.csv")</span></pre><p id="108f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们打印列的列表:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="0cfa" class="mb mc it lx b gy md me l mf mg">print(list(df.columns))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/e15270575ad6c24ec0d67ab9c5ef797b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vCFVa7HgAzDyHjSpe8BEig.png"/></div></div></figure><p id="5bf9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还可以看看数据中的行数:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="96f2" class="mb mc it lx b gy md me l mf mg">print("Number of rows: ", len(df))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/f856a79882e004da9f4f414a9e324d1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*SLye7OZdNqZENg1J-3sDZw.png"/></div></figure><p id="b94d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们打印前五行数据:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="5ff6" class="mb mc it lx b gy md me l mf mg">print(df.head())</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mj"><img src="../Images/af18c6b9ae1f2662c312db885fe0a430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uCbTM4bHDjD2J4NkxZY-lA.png"/></div></div></figure><p id="45b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到有几个分类列。让我们定义一个将数据框、列名和限制作为输入的函数。当被调用时，它打印分类值的字典以及它们出现的频率:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="f7db" class="mb mc it lx b gy md me l mf mg">def return_counter(data_frame, column_name, limit):<br/>   from collections import Counter    print(dict(Counter(data_frame[column_name].values).most_common(limit)))</span></pre><p id="df82" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将函数应用于“国家”列，并将结果限制为五个最常见的值:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="9505" class="mb mc it lx b gy md me l mf mg">return_counter(df, 'country', 5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/e73ff91f41a477b34fa22f66cf299d30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1a5rcbzNposMFJCUFK755A.png"/></div></div></figure><p id="939d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如我们所见，美国有 2，032 个标题，印度有 777 个，缺少 476 个国家值，英国有 348 个，日本有 176 个。</p><p id="cdfc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们将函数应用于“director”列，删除缺失的值:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="2178" class="mb mc it lx b gy md me l mf mg">df['director'].dropna(inplace = True)<br/>return_counter(df, 'director', 5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/d7f63bc037b5ddd1cff4b4774da6248c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V_IuKDpflUo7m1ZIStgNKA.png"/></div></div></figure><p id="9055" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们看看最常见的导演“劳尔·坎波斯”和“扬·苏特”的片名:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="b161" class="mb mc it lx b gy md me l mf mg">df_d1 = df[df['director'] =='Raúl Campos, Jan Suter']<br/>print(set(df_d1['title']))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/3c90057972f09a950e7ef7c28b0dacda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nnm0CmKSWDae7nV_LGv-3Q.png"/></div></div></figure><p id="791d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">和国家:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="1063" class="mb mc it lx b gy md me l mf mg">print(set(df_d1['country']))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/1fcc4eaf6afd5958b2a5d4cdb670ac4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*mLoDibizzrLalH_yf7EgCg.png"/></div></figure><p id="b5df" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到这些头衔来自哥伦比亚、智利、阿根廷和墨西哥。让我们为马库斯·雷波依做同样的事情:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="dd02" class="mb mc it lx b gy md me l mf mg">df_d2 = df[df['director'] =='Marcus Raboy']<br/>print(set(df_d2['title']))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/390ba2215da1dda6d0dc5a4d197340ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HEAXmJUltVGtm1ggpxQvTg.png"/></div></div></figure><p id="871a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在我们来分析电影时长。首先，我们需要过滤数据集，只包括电影标题:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="ec91" class="mb mc it lx b gy md me l mf mg">df = df[df['type'] =='Movie']</span></pre><p id="c90d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，让我们打印一组电影时长:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="8bf7" class="mb mc it lx b gy md me l mf mg">print(set(df['duration']))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/abe2138009571c933cd1bd8006177268.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cG4r-qtrvAVh4-RMEFotzg.png"/></div></div></figure><p id="f71a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们看到所有的值都以字符串的形式报告，持续时间以分钟为单位。让我们从字符串值中删除“min ”,并将结果转换为整数:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="10be" class="mb mc it lx b gy md me l mf mg">df['duration'] = df['duration'].map(lambda x: x.rstrip('min')).astype(int)<br/>print(set(df['duration']))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/9a414daecf8b5bb0b26b809409967af3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ii1iK_FH2qIkOEK6OS306w.png"/></div></div></figure><p id="41d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，从像“持续时间”这样的数字列中生成汇总统计数据会很有用。让我们定义一个采用数据框、分类列和数字列的函数。每个类别的数字列的平均值和标准偏差存储在数据框中，并且数据框根据平均值以降序排序。如果您想要快速查看特定类别对于特定数字列是否具有更高或更低的平均值和/或标准偏差值，这将非常有用。</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="823e" class="mb mc it lx b gy md me l mf mg">def return_statistics(data_frame, categorical_column, numerical_column):<br/>    mean = []<br/>    std = []<br/>    field = []<br/>    for i in set(list(data_frame[categorical_column].values)):<br/>        new_data = data_frame[data_frame[categorical_column] == i]<br/>        field.append(i)<br/>        mean.append(new_data[numerical_column].mean())<br/>        std.append(new_data[numerical_column].std())<br/>    df = pd.DataFrame({'{}'.format(categorical_column): field, 'mean {}'.format(numerical_column): mean, 'std in {}'.format(numerical_column): std})<br/>    df.sort_values('mean {}'.format(numerical_column), inplace = True, ascending = False)<br/>    df.dropna(inplace = True)<br/>    return df</span></pre><p id="6e52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用分类列‘listed _ in’和数字列‘duration’来调用我们的函数:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="ac06" class="mb mc it lx b gy md me l mf mg">stats = return_statistics(df, 'listed_in', 'duration')<br/>print(stats.head(15))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/f399f21ee2ab5461c02151e0e4a1b203.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ZpJwQXVHTRhgwHRyk723Q.png"/></div></div></figure><p id="0fa0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们将使用箱线图来显示基于最小值、最大值、中值、第一个四分位数和第三个四分位数的数值分布。如果您对它们不熟悉，可以看看文章<a class="ae ky" rel="noopener" target="_blank" href="/understanding-boxplots-5e2df7bcbd51">了解 Boxplots </a>。</p><p id="0ed8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与汇总统计函数类似，此函数采用数据框、分类列和数值列，并根据限制显示最常见类别的箱线图:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="dec3" class="mb mc it lx b gy md me l mf mg">def get_boxplot_of_categories(data_frame, categorical_column, numerical_column, limit):<br/>    import seaborn as sns<br/>    from collections import Counter<br/>    keys = []<br/>    for i in dict(Counter(df[categorical_column].values).most_common(limit)):<br/>        keys.append(i)<br/>    print(keys)<br/>    df_new = df[df[categorical_column].isin(keys)]<br/>    sns.set()<br/>    sns.boxplot(x = df_new[categorical_column], y =      df_new[numerical_column])</span></pre><p id="7342" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们为 5 个最常见的“列出”类别中的“持续时间”生成箱线图:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="9054" class="mb mc it lx b gy md me l mf mg">get_boxplot_of_categories(df, 'listed_in', 'duration', 5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/5305ae4cf526d958e61fcdebd765e0c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QmVzKJpyc3sKg8T048ivkQ.png"/></div></div></figure><p id="bafb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，让我们定义一个函数，它将一个数据框和一个数字列作为输入，并显示一个直方图:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="8863" class="mb mc it lx b gy md me l mf mg">def get_histogram(data_frame, numerical_column):<br/>    df_new = data_frame<br/>    df_new[numerical_column].hist(bins=100)</span></pre><p id="7917" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们用数据框调用函数，并从“持续时间”生成一个直方图:</p><pre class="kj kk kl km gt lw lx ly lz aw ma bi"><span id="23c2" class="mb mc it lx b gy md me l mf mg">get_histogram(df, 'duration')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/6fb7598e71ef94aae5c95edd21535ccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ktf1n-xBH2Uvsh5kj1UKNw.png"/></div></div></figure><p id="ba9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我就讲到这里，但是请随意处理数据并自己编码。</p><p id="aeb1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">概括地说，我回顾了几种分析<em class="lv">网飞电影和电视节目</em>数据集的方法。<em class="lv"> </em>这包括定义生成汇总统计数据的函数，比如平均值、标准差和分类值的计数。我们还定义了用箱线图和直方图可视化数据的函数。我希望这篇文章有趣。这篇文章的代码可以在<a class="ae ky" href="https://github.com/spierre91/medium_code/blob/master/netflix_eda.py" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。感谢您的阅读！</p></div></div>    
</body>
</html>