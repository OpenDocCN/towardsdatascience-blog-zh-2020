<html>
<head>
<title>Time Series Forecasting with Statistical Models in Python Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python代码中基于统计模型的时间序列预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-series-forecasting-with-statistical-models-in-python-code-da457a46d68a?source=collection_archive---------9-----------------------#2020-03-23">https://towardsdatascience.com/time-series-forecasting-with-statistical-models-in-python-code-da457a46d68a?source=collection_archive---------9-----------------------#2020-03-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="0978" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在我之前的文章中，我展示了使用脸书先知Python API(可用的统计模型之一)预测数字广告支出是多么容易。在第二部分中，我们将更多地讨论如何应用统计方法进行时间序列分析。</p><p id="3442" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">问题</strong>:根据2年多的历史每日广告支出，预测未来2个月的数字广告支出。</p><p id="6f35" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面快速浏览一下数据文件(从2017年1月1日到2019年9月23日的每日广告支出)</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/cdf8115b7a2b598077f264ce0e45a652.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*NqhgS5BPUsgHNvQ_C3Ae3g.png"/></div></figure><p id="be89" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">创建培训和测试数据集:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/f79b62b7b834c630f8a2c0bced90eb14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*gVr0lJwpSLxkFFtsejKzoQ.png"/></div></figure><h1 id="2f65" class="ky kz it bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">目录</h1><ol class=""><li id="5333" class="lw lx it js b jt ly jx lz kb ma kf mb kj mc kn md me mf mg bi translated">介绍</li></ol><ul class=""><li id="8cb2" class="lw lx it js b jt ju jx jy kb mh kf mi kj mj kn mk me mf mg bi translated">时间序列分析</li><li id="3f36" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated">什么是流行的统计模型</li><li id="a2d9" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated">单变量统计时间序列建模的关键要素</li></ul><p id="a312" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.ARIMA</p><ul class=""><li id="69e9" class="lw lx it js b jt ju jx jy kb mh kf mi kj mj kn mk me mf mg bi translated">ACF和PACF图</li><li id="3a9b" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated">萨里玛</li><li id="4e96" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated">案例研究:用SARIMA预测广告支出</li></ul><p id="95f2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.美国教育考试服务中心</p><ul class=""><li id="b938" class="lw lx it js b jt ju jx jy kb mh kf mi kj mj kn mk me mf mg bi translated">美国教育考试服务中心</li><li id="eb2c" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated">霍尔特-温特季节方法</li><li id="cc44" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated">案例研究:用霍尔特-温特季节平滑法预测广告支出</li></ul><p id="a626" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4.对比模型</p><p id="f3d3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">5.结案摘要</p><h1 id="2d74" class="ky kz it bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">1.1时间序列分析</h1><p id="4676" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">细节在我之前的帖子<a class="ae ko" rel="noopener" target="_blank" href="/a-quick-start-of-time-series-forecasting-with-a-practical-example-using-fb-prophet-31c4447a2274">中解释过，这里</a>。</p><h1 id="7f54" class="ky kz it bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">1.2我们可以使用什么时间序列统计模型？</h1><p id="fc33" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">a.单变量统计时间序列建模(例如，平均和平滑模型、有/无季节项的ARIMA模型)</p><p id="37c0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">b.多变量统计时间序列建模(如外部回归变量、风险值)</p><p id="29a3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">c.附加或组件模型(如<a class="ae ko" rel="noopener" target="_blank" href="/a-quick-start-of-time-series-forecasting-with-a-practical-example-using-fb-prophet-31c4447a2274">第一部分</a>中涉及的脸书预言家)</p><p id="47f3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">d.结构时序建模(例如，贝叶斯结构时序建模、分层时序建模)。</p><p id="86bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在本文中，我将重点解释萨里玛和霍尔特-温特斯。</p><h1 id="e40d" class="ky kz it bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">1.3关键组件</h1><p id="c183" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">我们需要我们的数据平稳性，这意味着(1)常数均值(2)常数方差(3)自协方差不依赖于时间，如果我们想使用时间序列数据的统计建模。</p><p id="ad60" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">那如果我的数据不符合这个统计假设呢？换句话说，非平稳数据是什么样的？</p><p id="872c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">非平稳数据背后的两个共同特征是:( 1)趋势~均值不随时间变化;( 2)季节性~方差不随时间变化;( 3)自协方差依赖于时间。</p><p id="30da" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">去趋势化和消除季节性的方法有哪些？</p><ul class=""><li id="2bab" class="lw lx it js b jt ju jx jy kb mh kf mi kj mj kn mk me mf mg bi translated">转换(例如，日志、sqrt等)</li><li id="32b2" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated">平滑(例如，滚动平均等)</li><li id="ae18" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated">差异</li><li id="ddf9" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated">分解</li><li id="814c" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated">多项式拟合(例如，拟合回归模型)</li></ul><h1 id="fefc" class="ky kz it bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">2.1 ARIMA模型中的关键术语</h1><p id="b64d" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">格式:ARIMA(p，d，q) — (1) p: AR项(2) d: (3) q: MA项</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/720512b4b302b41f9a4aa3ab80533ce5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*gjzlB8i1agGNPlz4Zv5ZnA.png"/></div><p class="mu mv gj gh gi mw mx bd b be z dk translated">图片来自<a class="ae ko" href="https://www.slideshare.net/21_venkat?" rel="noopener ugc nofollow" target="_blank">https://www.slideshare.net/21_venkat?</a></p></figure><ul class=""><li id="63d0" class="lw lx it js b jt ju jx jy kb mh kf mi kj mj kn mk me mf mg bi translated">AR(自回归)项将序列中的下一步描述为前一时间步观察值的线性函数。</li><li id="46e4" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated">I(积分)项，序列的差分预处理步骤，使序列稳定。</li><li id="fdab" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated">MA(移动平均)项将序列中的下一步描述为前一时间步平均过程的残差的线性函数。</li></ul><p id="3211" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">模型的符号包括将AR (p)、I (d)和MA (q)模型的阶指定为ARIMA函数的参数，例如ARIMA(p，d，q)。ARIMA模型也可以用来开发AR、MA和ARMA模型。</p><p id="910d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">那我们怎么确定p，d，q呢？</p><h1 id="a2ce" class="ky kz it bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">2.2 ACF和PACF图</h1><p id="a0a0" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">ACF(自相关函数)描述了时间序列与其自身滞后版本之间的相关性(例如，Y(t)与Y(t-1)的相关性)</p><p id="ab3f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">PACF(部分自相关函数)提供了由每个连续滞后项解释的附加相关性。</p><ol class=""><li id="16a9" class="lw lx it js b jt ju jx jy kb mh kf mi kj mj kn md me mf mg bi translated">用PACF图确定p</li><li id="2dd0" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn md me mf mg bi translated">使用ACF图确定q</li></ol><div class="my mz gp gr na nb"><a href="https://people.duke.edu/~rnau/411arim3.htm" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd iu gy z fp ng fr fs nh fu fw is bi translated">识别ARIMA模型中AR和MA项的顺序</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">非季节性ARIMA模型说明(pdf文件)季节性和非季节性ARIMA模型幻灯片(pdf文件)介绍…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">people.duke.edu</p></div></div><div class="nk l"><div class="nl l nm nn no nk np kv nb"/></div></div></a></div><h1 id="f51f" class="ky kz it bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">2.3萨里玛</h1><p id="0201" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">SARIMA(季节性自回归综合移动平均)在季节性水平上结合了ARIMA模型。</p><p id="7643" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">格式:SARIMA(p，D，q) (P，D，Q)s其中s代表季节周期。</p><h1 id="1002" class="ky kz it bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">2.3案例研究:用SARIMA预测广告支出</h1><p id="8ee3" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">我创建了test _ stationarity来检查平稳性。</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="2f45" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">该函数绘制了滚动平均值和标准差，并通过进行<a class="ae ko" href="https://en.wikipedia.org/wiki/Augmented_Dickey%E2%80%93Fuller_test" rel="noopener ugc nofollow" target="_blank">增强迪基-富勒测试</a>输出p值。</p><p id="17e9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">检查原始数据:test _ stationary(df1[' Spend ']。dropna())</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi ns"><img src="../Images/20686456685287c64071e202e0fd8601.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mcb-aT2bl2uTM91LH6UkqA.png"/></div></div></figure><p id="5474" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">与临界值相比，时间序列是非平稳的。</p><p id="51e5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们做一个对数转换:df1[' log _ Spend ']= NP . log(df1[' Spend '])</p><p id="2f16" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">test _ stationary(df1[' log _ Spend ']。diff(1)。dropna())</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi nx"><img src="../Images/5af186f587e37983af0587945ed1a083.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SfigUvsm1qkjvU1V6i9u1g.png"/></div></div></figure><p id="7f5e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">太好了。利用对数变换，时间序列在5%的阈值处是平稳的。</p><p id="d1dc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们尝试第一个差异:test _ stationary(df1[' Spend ']。diff(1)。dropna())</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi ny"><img src="../Images/8bc57fd7e5ca1a0d599df70043036bca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WvL5swInI2JZERn5cF7kvg.png"/></div></div></figure><p id="543b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">令人印象深刻。结果是事件更好:时间序列在1%的阈值处是稳定的，具有一阶差分。</p><p id="ec54" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">建立SARIMA模型，预测2019年7月23日至2019年9月23日两个月的广告支出</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="99e8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，让我们通过从<em class="nz">sk learn . metrics import mean _ squared _ error，mean_absolute_error </em>计算mse和mae来检查该模型的性能</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi oa"><img src="../Images/c622307150ef0c12842a029a17f5a342.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zT8FFTlT925pw5iKlH1xlA.png"/></div></div></figure><p id="aa82" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们想象一下预测:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi ob"><img src="../Images/fe63e8ad5c7eeea34683b449be0bb64e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L8Hm5yD8H8udvtrM58BbkQ.png"/></div></div></figure><p id="556e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">SARIMA模型能够捕捉趋势和每周季节性，但在MAE为5813的波峰和波谷上有点偏离。</p><h1 id="ce14" class="ky kz it bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">3.指数平滑(ETS)</h1><p id="a2cf" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">因为时间序列数据在一段时间内自然是随机的，我们通常希望平滑数据，为此我们将使用ETS，使用指数方法为过去的观察值分配较少的权重。在<a class="ae ko" href="https://en.wikipedia.org/wiki/Exponential_smoothing" rel="noopener ugc nofollow" target="_blank"> wiki </a>上有一个像样的解释。</p><p id="0ec3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">类似地，我们也希望通过应用ETS将时间序列分解成趋势(T)、季节(S)和不规则或误差(E)分量。</p><p id="6e69" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">三种常见的ETS类型:</p><ul class=""><li id="52a2" class="lw lx it js b jt ju jx jy kb mh kf mi kj mj kn mk me mf mg bi translated"><strong class="js iu">线性:</strong>双指数平滑:</li><li id="3a50" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated"><strong class="js iu">加法:</strong>三重指数平滑</li><li id="ea56" class="lw lx it js b jt ml jx mm kb mn kf mo kj mp kn mk me mf mg bi translated"><strong class="js iu">乘法:</strong>也称三重指数平滑</li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi oc"><img src="../Images/743cf41c1b7bc8d4eb2617fb9bbfea12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HWmu75O760gybmYmx1ZA-w.png"/></div></div><p class="mu mv gj gh gi mw mx bd b be z dk translated">来自:https://www . stat . Berkeley . edu/~ arturof/Teaching/stat 248/lab 10 _ part 1 . html</p></figure><h1 id="78c8" class="ky kz it bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">3.2霍尔特-温特斯季节性方法</h1><p id="3c72" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">热冬季节法是三重指数平滑法的一种。它有三个关键部分:(1)一个水平(2)一个趋势(3)季节成分霍尔特-温特斯加法和霍尔特-温特斯乘法。</p><h1 id="75be" class="ky kz it bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">3.3案例研究:用霍尔特-温特季节平滑法预测广告支出</h1><p id="ae05" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">建立热冬附加模型，预测2019年7月23日至2019年9月23日两个月的广告支出</p><figure class="kq kr ks kt gt ku"><div class="bz fp l di"><div class="nq nr l"/></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi od"><img src="../Images/f8b8524c7ef3f67355b792b4566e8c5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PRTMDoueQ_HplluF13YFEA.png"/></div></div></figure><p id="e4da" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过<em class="nz">从sklearn.metrics导入mean_squared_error，mean_absolute_error </em>计算mse和mae</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi oe"><img src="../Images/f15d21a325d8d3719bc290368b16f19e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*784cOM9o7sA_l97i_vti9g.png"/></div></div></figure><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi of"><img src="../Images/c9547537f649e1f4136dc6159df5ce6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6mQI3Aa1Ujq4APnDFG6dbw.png"/></div></div></figure><p id="efa0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">H-W模型能够捕捉趋势和每周季节性，但在MAE为6055的波峰和波谷上有点偏离。</p><h1 id="2d43" class="ky kz it bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">4.比较这两个模型</h1><p id="ac6e" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">让我们在同一个图中可视化两个模型的预测。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi og"><img src="../Images/596f7d71e05389e6590101b082897fb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gET0hrhlDZjbL5KRI4Mgog.png"/></div></div></figure><p id="bd73" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">从图中，我们可以看出SARIMA模型比Holt_Winter模型表现稍好，MSE和MAE都较低。尽管这两个模型都不能完美地捕捉到波峰和波谷，但在这种情况下，它们仍然对业务有用。根据数据，平均每月广告支出为200万美元以上。然而，基于这两种模型的平均寿命约为6000。换句话说，对于一个平均每月广告支出为200万美元的企业来说，两个月的广告支出预测将下降约6000美元。这是一个相当不错的预测！</p><h1 id="281e" class="ky kz it bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">5.结案摘要</h1><p id="626c" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb mq kd ke kf mr kh ki kj ms kl km kn im bi translated">在本文中，单变量预测方法在广告支出数据上表现良好。但是用这些方法组合/合并新的信号，例如事件、天气，并不容易。这些统计方法对缺失数据也非常敏感，通常不能很好地预测长期数据。</p><p id="43d9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在下一篇文章中，我将展示如何使用深度学习来预测同一数据集上的时间序列！</p><p id="fb6b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有用的参考资料:</p><div class="my mz gp gr na nb"><a href="https://www.stat.berkeley.edu/~arturof/Teaching/STAT248/lab10_part1.html" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd iu gy z fp ng fr fs nh fu fw is bi translated">实验10，第1部分-指数平滑</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">首先，我们区分方法和模型。预测方法是一种算法，它提供一个点…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">www.stat.berkeley.edu</p></div></div></div></a></div><div class="my mz gp gr na nb"><a href="https://en.wikipedia.org/wiki/Exponential_smoothing" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd iu gy z fp ng fr fs nh fu fw is bi translated">指数平滑法</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">指数平滑是一种使用指数窗口平滑时间序列数据的经验法则…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">en.wikipedia.org</p></div></div></div></a></div><div class="my mz gp gr na nb"><a href="https://people.duke.edu/~rnau/411arim.htm" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd iu gy z fp ng fr fs nh fu fw is bi translated">ARIMA模型介绍</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">非季节性ARIMA模型说明(pdf文件)季节性和非季节性ARIMA模型幻灯片(pdf文件)介绍…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">people.duke.edu</p></div></div><div class="nk l"><div class="oh l nm nn no nk np kv nb"/></div></div></a></div></div></div>    
</body>
</html>