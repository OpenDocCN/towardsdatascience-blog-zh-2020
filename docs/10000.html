<html>
<head>
<title>Baby Steps Towards Data Science: Polynomial Regression in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">迈向数据科学的一小步:Python 中的多项式回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/baby-steps-towards-data-science-polynomial-regression-in-python-a75f371bd984?source=collection_archive---------52-----------------------#2020-07-14">https://towardsdatascience.com/baby-steps-towards-data-science-polynomial-regression-in-python-a75f371bd984?source=collection_archive---------52-----------------------#2020-07-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6a39" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">理解多项式回归背后的直觉，并用 python 实现。提供源代码和数据集。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/79296cb25739c42899333827f3def09b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4uHjVHrtqciNZLdb66vd9Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片来源<a class="ae ky" href="https://animoidin.wordpress.com/2018/07/01/polynomial-regression/" rel="noopener ugc nofollow" target="_blank"> Animoid </a></p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="c80f" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">什么是多项式回归？</h1><p id="7ed9" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">在上图中，你可以看到多项式曲线的例子。大多数实时数据实际上并不是线性的，而是非线性的。上图中所有蓝色的点代表数据点，绿线是线性回归线，而红线是多项式回归线。你可以立即看到哪条线是完美的。它是红线，即代表给定范围内数据的总体趋势。</p><p id="c820" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">现在，让我们理解什么是多项式回归:你可以从初等数学中联系你对多项式的理解。它是一个正整数幂的变量。因此，多项式回归归结为使用多项式函数来对数据建模。如何知道何时使用这种类型的回归？简单地看一下数据分布，如果它与你在上图中看到的接近，你可以尝试使用多项式回归。数据科学是关于在真实世界场景中使用数学和统计知识，而不是像我们在学校里学到的那样，是一个假设的作业问题。</p><h1 id="8d9e" class="lg lh it bd li lj mz ll lm ln na lp lq jz nb ka ls kc nc kd lu kf nd kg lw lx bi translated">多项式回归函数的表示</h1><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="5b3f" class="nj lh it nf b gy nk nl l nm nn">Y = b0+ b1x +b2 x²+b3 x³ + ….+bn x^n </span></pre><p id="65ec" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">你可以看到它不同于线性函数，线性函数的形式是:</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="bd6c" class="nj lh it nf b gy nk nl l nm nn"> Y = b0 + b1 x1 + …+ bn xn</span></pre><h1 id="a3c0" class="lg lh it bd li lj mz ll lm ln na lp lq jz nb ka ls kc nc kd lu kf nd kg lw lx bi translated">用 Python 实现</h1><p id="f085" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">让我们深入研究 python，建立一个多项式回归模型，并尝试预测一个 6.5 级别的员工的工资(假设)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/4000623af3ecea8a36a071d6b1310350.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SAKlgo7cemJV54sA"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@campaign_creators?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">活动创作者</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="07a4" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">在您继续之前，请从我的 GitHub Gist 下载 csv 数据文件。</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="a0f4" class="nj lh it nf b gy nk nl l nm nn"><a class="ae ky" href="https://gist.github.com/tharunpeddisetty/22447d5446928f864b55e096b4aac995" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/tharunpeddisetty/22447d5446928f864b55e096b4aac995</a><br/>Once you open the link, you can find "Download Zip" button on the top right corner of the window. Go ahead and download the files.<br/>You can download 1) python file 2)data file (.csv)<br/>Rename the folder accordingly and store it in desired location and you are all set.If you are a beginner I highly recommend you to open your python IDE and follow the steps below because here, I write detailed comments(statements after #.., these do not compile when our run the code) on the working of code. You can use the actual python as your backup file or for your future reference.</span></pre><p id="4e4f" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="np">导入库</em> </strong></p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="172a" class="nj lh it nf b gy nk nl l nm nn">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd</span></pre><p id="52e0" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="np">导入数据并定义 X 和 Y 变量</em> </strong></p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="962f" class="nj lh it nf b gy nk nl l nm nn">dataset = pd.read_csv(‘/Users/tharunpeddisetty/Desktop/Position_Salaries.csv’) #add your file path</span><span id="9aba" class="nj lh it nf b gy nq nl l nm nn">#iloc takes the values from the specified index locations and stores them in the assigned variable as an array<br/>X = dataset.iloc[:,1:-1].values<br/>y = dataset.iloc[:, -1].values</span></pre><p id="ee2c" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu">让我们看看我们的数据，了解一下变量:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/928564fd4617003f810f2e9d50876f50.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*I5PVBdHyIca33bPROZFN0A.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="41c2" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">该数据描述了员工的职位/级别及其工资。你可以看到，随着工作级别的提高，工资的增长是非线性的。</p><p id="cb1f" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="np">可视化数据</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/f8e1cab110f7fdd695f64662584958d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*kfMpw9lkJq0GaxghYbeB1Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6bfb" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">你可以看到绘制的数据是非线性增长的，因此，我们可以尝试多项式回归方法。请注意，我是说我们可以“尝试”，但不是说这是最好的模式。你会在我以后的文章中看到其中的道理。</p><p id="c35f" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="np">训练模特</em> </strong></p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="6322" class="nj lh it nf b gy nk nl l nm nn">from sklearn.preprocessing import PolynomialFeatures<br/>poly_reg = PolynomialFeatures(degree=4)<br/>X_poly=poly_reg.fit_transform(X) </span><span id="7d92" class="nj lh it nf b gy nq nl l nm nn">#regressor is the object for class PolynomialFeatures<br/>#degree=4 defines that the function must have x, x^2 , x^3 and x^4 terms<br/>#fit_transform() returns a new data set with x, x^2 , x^3 and x^4 terms as the input data set</span></pre><p id="fda9" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我们将使用模型中的全部数据，因此您不需要将数据分成训练和测试数据。</p><p id="21fe" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="np">可视化多项式回归的结果</em> </strong></p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="2a89" class="nj lh it nf b gy nk nl l nm nn">plt.scatter(X,y,c=’red’)<br/>plt.plot(X,lin_reg2.predict(X_poly), c=’blue’)<br/>plt.title(‘Polynomial Linear Regression’)<br/>plt.xlabel(“Position Level”)<br/>plt.ylabel(‘Salary’)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/519a006186dd9863109901a775225520.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*9jDBuXKFeWah4tURB1SZ3g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="56fa" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">你可以看到 4 次多项式函数给了我们合适的回归线。</p><p id="39de" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="np">可视化线性回归的结果</em> </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/60f01d943a1f96c686582fd1f82c2886.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*Emb0sFxJg2PFW3YTSoCloQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8ce4" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">您可以通过阅读我的线性回归文章来实现线性回归并将其可视化。以上图片已添加供您参考。不过你在我的要点文件里有它的代码。你可以立即看到回归线的巨大差异。</p><p id="92e2" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="np">使用多项式线性回归预测 6.5 级结果</em> </strong></p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="226b" class="nj lh it nf b gy nk nl l nm nn">print(lin_reg2.predict(poly_reg.fit_transform([[6.5]]))) <br/># we need to enter x1,x2,x3,x4 and this is the efficient model<br/># predict method expects a 2D array thats the reason you see [[6.5]]<br/># we use poly_reg.fit_transform because we want to transform our value 6.5 into a 3 other columns values with degree 4. We need to enter the input exactly how we transformed it for using in the model</span></pre><p id="cbbf" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="np">结果</em> </strong></p><p id="2669" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">多项式线性回归:158862.45</p><p id="053b" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">线性回归预测:330378.79(请自行尝试)</p><h1 id="3b3c" class="lg lh it bd li lj mz ll lm ln na lp lq jz nb ka ls kc nc kd lu kf nd kg lw lx bi translated">结论</h1><p id="1acb" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">我们可以看到，我们的多项式模型预测的实际工资介于 6 级和 7 级工资之间。看看线性回归的表现有多差。现在你可能会想，为什么我只考虑了这个问题的 4 度。好吧，我鼓励你尝试不同的程度，看看你的结果。尝试度=2、3、4、5、6 等</p><p id="a9e9" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我希望这对你来说是有趣的。恭喜你！您已经用最少的代码行实现了多项式回归。当我说婴儿迈向数据科学时，我是认真的。现在您有了代码模板，可以在其他数据集上实现它，并通过更改想要使用的多项式函数的次数来观察结果。机器学习快乐！</p></div></div>    
</body>
</html>