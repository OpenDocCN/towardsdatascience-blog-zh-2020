<html>
<head>
<title>tl;dr Structural Causal Models (DAGs) Made Easy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TL；灾难恢复结构因果模型(Dag)变得简单</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/tl-dr-structural-causal-models-dags-made-easy-part-1-25526374cfd5?source=collection_archive---------48-----------------------#2020-04-21">https://towardsdatascience.com/tl-dr-structural-causal-models-dags-made-easy-part-1-25526374cfd5?source=collection_archive---------48-----------------------#2020-04-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8123" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“吸烟与癌症有关”vs“吸烟致癌”，哪个更容易摇摆公众情绪？后者肯定；因果结论强于关联。我们拥有比以往更多的数据，但开发因果人工智能引擎仍然是一个重大挑战，我们在哪里？</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/5a0e682d3693f3e283ab89d04153ffcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lbs2-T69Wylj8iDZ-yaXyA.jpeg"/></div></div><p class="kx ky gj gh gi kz la bd b be z dk translated">先有鸡还是先有蛋？资料来源:publicdomainpictures.net</p></figure><p id="2ec9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">联想vs因果关系</strong></p><p id="3071" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简而言之:因果关系是那些在外部条件变化时保持不变的关系，无论如何关联都保持不变。</p><p id="29f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设我们想了解一年中的哪一个月是冰淇淋需求增加的原因。相关性是一个简单的模型，其中观察到的冰淇淋需求被建模为一年中月份的线性函数<strong class="jp ir">。</strong>我们可以通过测量边际概率<em class="lb"> P </em>(冰淇淋<strong class="jp ir"> | </strong>月)来表示这种关系。然而，一台机器如何仅凭联想就能确定是冰淇淋需求导致了一年中的哪一个月，还是相反？</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/b0edf86c04bf64fd7cd65418c23333c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sm6TFZJVLb3Z2lVpcpHjpQ.png"/></div></div></figure><p id="d266" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它不能！这是因为我们无法在<em class="lb">变化条件</em>下验证<em class="lb"> P </em>(冰淇淋<strong class="jp ir"> | </strong>月)。这就是所谓的关联模型的<strong class="jp ir">静态属性</strong> <em class="lb"> </em>，包括但不限于关联和回归。</p><p id="6526" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">批判地说，朱迪亚·珀尔(现代因果理论之父)将我们温顺的“<em class="lb">相关性并不意味着因果关系”</em>重新表述为更严格的<a class="ae ld" href="https://ftp.cs.ucla.edu/pub/stat_ser/r350.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="lb">“一个人不能仅仅从关联中证实因果关系的主张，即使是在群体水平上——在每一个因果结论的背后，必定存在一些在观察研究中不可检验的因果假设”</em> </a> <em class="lb">。这与我们将因果假设直接编码到数据收集过程中的实验形成对比。那么，我们如何验证“六月会导致更多的冰淇淋需求”这句话呢？</em></p><p id="7200" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一些人通过简单地控制与治疗变量<strong class="jp ir"> x </strong>和结果变量<strong class="jp ir"> y </strong>相关的变量<strong class="jp ir"> Z </strong>来宣称因果关系。例如，当检查六月(<strong class="jp ir"> x </strong>)是否会导致冰淇淋需求激增(<strong class="jp ir"> y </strong>)时，分析师可能会针对天气调整他们的模型。如果<strong class="jp ir"> (Z </strong>和<strong class="jp ir"> x </strong> ) <strong class="jp ir"> </strong>和(<strong class="jp ir"> Z </strong>和<strong class="jp ir"> y </strong>)不是独立的，<strong class="jp ir"> Z </strong>就说是一个<a class="ae ld" href="https://www.statisticshowto.com/experimental-design/confounding-variable/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">混杂变量</strong> </a>。因此，如果我们考虑天气因素，我们的计算机可以使用更新的关联模型<em class="lb">P’</em>(<strong class="jp ir">y</strong>|<strong class="jp ir">x</strong>)来识别下面这些家伙之间的正确因果关系吗？</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi le"><img src="../Images/4808e8206c20b042db2ec9cc096a99f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bvvYNdOEWGuVgB1wTkWRlw.png"/></div></div></figure><p id="b9a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">差得远，“控制<strong class="jp ir">Z”</strong>只是我们已经验证的因果假设的一个子集，仍然有太多的依赖和事情在发生！为了了解为什么会出现这种情况，我们可以用一种叫做<a class="ae ld" href="https://en.wikipedia.org/wiki/Directed_acyclic_graph" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"/><strong class="jp ir">有向无环图</strong> </a>的<strong class="jp ir">结构因果图</strong>来说明因果关系。</p><p id="a4b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">因果有向无环图</strong></p><p id="1fc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通俗地说，DAG是一个没有圈的有向图:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lf"><img src="../Images/7bb36afddd076e858ba3b0e2f348e1ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0TexyL_FRlpzzhgwW_p-fg.png"/></div></div></figure><p id="e237" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着从图中的任何节点开始，比如<strong class="jp ir"> D、</strong>D，没有任何路径可以将你带回到<strong class="jp ir"> D </strong>。重要的是，它们可以用于编码因果模型的所有假设，这被称为因果DAG。节点表示事件，有向边表示因果关系:<strong class="jp ir">E</strong>-&gt;-T50】F隐含<strong class="jp ir"> E </strong>是因果<strong class="jp ir"> F </strong>。因为图是无环的，<strong class="jp ir">没有事件能引起自身</strong>。事件由<strong class="jp ir">路径</strong>连接，有三种路径需要考虑。让我们从字母转移到我们的冰淇淋示例，以获得一些实际的上下文:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lg"><img src="../Images/18656bd4439f8ba4ab0781803634a0b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OPw48lolPoQG4-gWrFANEg.png"/></div></div><p class="kx ky gj gh gi kz la bd b be z dk translated">DAG 1:开放路径</p></figure><p id="9e71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> (1)开放路径:</strong>六月是气温升高的原因，而气温升高又是冰淇淋需求增加的原因。天气在六月和冰淇淋需求之间扮演着T2的中介角色。健康的经济也会导致冰淇淋需求的增加，但是由于没有箭头指向它，这一事件与月份或天气无关。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lh"><img src="../Images/7d3b832073fe2913bd5782bc7b60e846.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g3h-M8KTsASl_9N2eGoLaQ.png"/></div></div><p class="kx ky gj gh gi kz la bd b be z dk translated">DAG 2:后门路径</p></figure><p id="2934" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> (2)后门路径</strong>:这里两个变量共享同一个因果路径。在一个以农业为主的经济体中，气温升高可能会增加作物产量，从而提高经济健康水平，进而增加冰淇淋需求。更高的温度也让人们想吃更多的冰淇淋。因此，我们可以看到天气或一年中的月份如何成为农业和冰淇淋需求之间关系的混淆变量，因为两者之间存在关联。在因果Dag中，通过追踪后门路径总能找到混淆变量。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi li"><img src="../Images/10d0d82ffbec5c6de6673ecffebf4731.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qXLdAX8SGOXfOpDVZwB2lA.png"/></div></div><p class="kx ky gj gh gi kz la bd b be z dk translated">DAG 3:封闭路径</p></figure><p id="ec2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> (3)封闭路径:</strong>这里，一个变量有两个效应导入其中。更高的温度可能会使人们想开着空调汽车到处跑。此外，更健康的经济让汽车更实惠。后果如何？天气和通过更多驾驶传递的冰淇淋需求之间没有联系。驱动事件变量被称为<em class="lb">碰撞器。</em></p><p id="b798" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们明白了为什么简单地“控制混杂变量”会产生误导。在模型(1)中，对天气的调节对应于对<em class="lb">中介的调节，</em>这关闭了路径，并且这歪曲了事件之间的关系。在模型(3)中，错误地控制一个碰撞器作为混杂因素，打开了一条从六月到通过驾驶的冰淇淋需求的路径，扭曲了整体关系。在实验设计中，这也是一个同样重要的考虑因素，研究天气对倾向于驾驶的人群中冰淇淋销售的影响<strong class="jp ir">选择偏差</strong>。</p><p id="1130" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最重要的是，检查因果Dag可以指导我们选择混杂变量:为了在模型(2)中收集经济健康对冰淇淋销售的影响的无偏估计，控制天气似乎是一个不错的选择。</p></div></div>    
</body>
</html>