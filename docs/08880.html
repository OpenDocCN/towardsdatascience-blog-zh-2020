<html>
<head>
<title>Making your Ubuntu deep learning ready</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让你的 Ubuntu 深度学习做好准备</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/making-your-ubuntu-deep-learning-ready-a710cb337b39?source=collection_archive---------21-----------------------#2020-06-26">https://towardsdatascience.com/making-your-ubuntu-deep-learning-ready-a710cb337b39?source=collection_archive---------21-----------------------#2020-06-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="347f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在 Ubuntu 中安装 Nvidia 驱动程序、Cuda、cuDNN、TensorFlow、Keras &amp; PyTorch</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c6c26723661fc4ef6278a20ff5eef61c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*n6ZnTj3YDUWnyCZo"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@freestocks?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> freestocks </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="fd17" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">偶然发现很多安装深度学习库的指南，Cuda，cuDNN &amp; nvidia-driver。但是我从来没有在只跟随一个向导的情况下一次成功。所以，我决定写这篇文章。首先，本指南是安装有 GPU 支持的深度学习库(TensorFlow，Keras，PyTorch)。CPU 支持非常简单，所以我不会谈论它。</p><p id="fce3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你需要一个</p><blockquote class="lv lw lx"><p id="5494" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated">具有 CUDA 计算能力 3.5 或更高的 NVIDIA GPU 卡。</p></blockquote><p id="5135" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以通过访问这个<a class="ae ky" href="https://developer.nvidia.com/cuda-gpus#compute" rel="noopener ugc nofollow" target="_blank">链接</a>来检查你的 GPU 是否兼容。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="3638" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">安装 Nvidia 驱动程序</h1><p id="51b1" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">运行以下命令。它添加了下载 Nvidia 驱动程序所需的存储库。会的</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="804d" class="nl mk it nh b gy nm nn l no np">sudo add-apt-repository ppa:graphic-drivers/ppa</span><span id="cfc2" class="nl mk it nh b gy nq nn l no np">sudo apt update</span><span id="b59b" class="nl mk it nh b gy nq nn l no np">ubuntu-drivers devices | grep nvidia</span></pre><p id="9cb3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它会显示与您的 GPU 卡兼容的驱动程序版本。我有一张 RTX 2060 超级 GPU 卡。它显示</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="08e4" class="nl mk it nh b gy nm nn l no np">driver : nvidia-430 — third-party free recommended</span></pre><p id="7cac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">根据您使用的 GPU 卡，它可能还会显示多个条目。例子</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="2880" class="nl mk it nh b gy nm nn l no np">driver : nvidia-340 — distro non-free<br/>driver : nvidia-304 — distro non-free<br/>driver : nvidia-384 — distro non-free recommended</span></pre><p id="7e24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装合适的版本。你的驱动将决定你将要安装的 CUDA 的最低版本。你可以在这里找到表格<a class="ae ky" href="https://docs.nvidia.com/deploy/cuda-compatibility/index.html#binary-compatibility__table-toolkit-driver" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="9e43" class="nl mk it nh b gy nm nn l no np">sudo apt install nvidia-xxx</span></pre><p id="d3bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">用你想要的版本替换<code class="fe nr ns nt nh b">xxx</code>。重新启动并检查安装</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="5616" class="nl mk it nh b gy nm nn l no np">sudo reboot<br/>lsmod|grep nvidia<br/>nvidia-smi</span></pre></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="80f7" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">安装 CUDA 和 cuDNN</h1><p id="3c56" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">从<a class="ae ky" href="https://developer.nvidia.com/cuda-toolkit-archive" rel="noopener ugc nofollow" target="_blank">这里</a>下载 CUDA 安装程序。我更喜欢从运行文件安装。安装并添加<code class="fe nr ns nt nh b">PATH</code>和<code class="fe nr ns nt nh b">LD_LIBRARY_PATH</code>变量中的路径。用您的路径替换 Cuda 的路径(在我的例子中是<code class="fe nr ns nt nh b">/usr/local/cuda-10.1/</code>)。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="cee2" class="nl mk it nh b gy nm nn l no np">./cuda_10.1.105_418.39_linux.run</span><span id="94f3" class="nl mk it nh b gy nq nn l no np">echo “export LD_LIBRARY_PATH=/usr/local/cuda-10.1/lib64:$LD_LIBRARY_PATH”&gt;&gt; ~/.bashrc</span><span id="4fd9" class="nl mk it nh b gy nq nn l no np">echo “export PATH=/usr/local/cuda-10.1/bin:$PATH”&gt;&gt; ~/.bashrc</span></pre><p id="004e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">访问此<a class="ae ky" href="https://www.tensorflow.org/install/source#gpu" rel="noopener ugc nofollow" target="_blank">表</a>获取经过测试的构建版本。检查您需要安装的 cuDNN 版本。从<a class="ae ky" href="https://developer.nvidia.com/rdp/cudnn-archive" rel="noopener ugc nofollow" target="_blank">这里</a>下载 cuDNN。我更喜欢压缩版本。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/43677c444fbaa18689be262ba4f82130.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0EirSwSzgfSyqOB20g6Gqw.png"/></div></div></figure><p id="3637" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下载后解压并复制文件到 CUDA 目录。</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="3a79" class="nl mk it nh b gy nm nn l no np">tar -xzvf cudnn-x.x-linux-x64-v8.x.x.x.tgz<br/>sudo cp cuda/include/cudnn*.h /usr/local/cuda/include<br/>sudo cp cuda/lib64/libcudnn* /usr/local/cuda/lib64</span><span id="e405" class="nl mk it nh b gy nq nn l no np">sudo chmod a+r /usr/local/cuda/include/cudnn*.h /usr/local/cuda/lib64/libcudnn*</span></pre></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h1 id="44f8" class="mj mk it bd ml mm mn mo mp mq mr ms mt jz mu ka mv kc mw kd mx kf my kg mz na bi translated">安装 Tensorflow、Keras、Pytorch</h1><p id="5d9a" class="pw-post-body-paragraph kz la it lb b lc nb ju le lf nc jx lh li nd lk ll lm ne lo lp lq nf ls lt lu im bi translated">使用安装 TensorFlow 和 Keras</p><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="bc25" class="nl mk it nh b gy nm nn l no np">pip install tensorflow-gpu==2.2.0 keras</span></pre><p id="b000" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要安装支持 GPU 的 PyTorch，请访问此<a class="ae ky" href="https://pytorch.org/get-started/locally/" rel="noopener ugc nofollow" target="_blank">链接</a>。选择版本、操作系统、语言、软件包安装程序、CUDA 版本，然后按照下图中突出显示的部分进行安装。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/f04ea3826b7d3ca0dd1a8c8969ad0dd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wbNWAcAOJSwO82eGqAbHgw.png"/></div></div></figure><p id="ff24" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是了。现在使用这些 python 脚本来验证您的安装。</p><h2 id="e05e" class="nl mk it bd ml nw nx dn mp ny nz dp mt li oa ob mv lm oc od mx lq oe of mz og bi translated">张量流代码</h2><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="94aa" class="nl mk it nh b gy nm nn l no np">from tensorflow.python.client import device_lib<br/><br/>def get_available_gpus():<br/>    local_device_protos = device_lib.list_local_devices()<br/>    return [x.<!-- -->physical_device_desc<!-- --> for x in local_device_protos if x.device_type == 'GPU']<br/></span><span id="ac6b" class="nl mk it nh b gy nq nn l no np">get_available_gpus()</span></pre><h2 id="6678" class="nl mk it bd ml nw nx dn mp ny nz dp mt li oa ob mv lm oc od mx lq oe of mz og bi translated">Pytorch 代码</h2><pre class="kj kk kl km gt ng nh ni nj aw nk bi"><span id="3ea8" class="nl mk it nh b gy nm nn l no np">import torch</span><span id="6408" class="nl mk it nh b gy nq nn l no np">def get_available_gpus():<br/>    return [ <!-- -->torch.cuda.get_device_properties(i)<!-- --> for i in range(<!-- -->torch.cuda.device_count())<!-- -->]<br/></span><span id="2a96" class="nl mk it nh b gy nq nn l no np">get_available_gpus()</span></pre><p id="fe00" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是了。</p><p id="db5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有库都已安装。现在打开你的<em class="ly">创意</em>模式。</p><h1 id="61e7" class="mj mk it bd ml mm oh mo mp mq oi ms mt jz oj ka mv kc ok kd mx kf ol kg mz na bi translated">参考</h1><div class="om on gp gr oo op"><a href="https://docs.nvidia.com/deeplearning/sdk/cudnn-install/index.html" rel="noopener  ugc nofollow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd iu gy z fp ou fr fs ov fu fw is bi translated">cuDNN 安装指南::NVIDIA 深度学习 SDK 文档</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">本 cuDNN 8.0.0 预览版安装指南提供了如何安装和检查的分步说明…</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">docs.nvidia.com</p></div></div></div></a></div><p id="45b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">【https://stackoverflow.com/a/38580201 T4】</p></div></div>    
</body>
</html>