<html>
<head>
<title>Clothes reviews analysis with NLP — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用NLP分析服装评论—第1部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/clothes-reviews-analysis-with-nlp-part-1-d81bdfa14d97?source=collection_archive---------15-----------------------#2020-03-21">https://towardsdatascience.com/clothes-reviews-analysis-with-nlp-part-1-d81bdfa14d97?source=collection_archive---------15-----------------------#2020-03-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/c2eadf1eca7e65f3055bbd704cb016d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TioTLHKSV_ecYuwQ.jpg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://www.klaviyo.com/blog/fashion-apparel-best-practices" rel="noopener ugc nofollow" target="_blank">https://www.klaviyo.com/blog/fashion-apparel-best-practices</a></p></figure><div class=""/><div class=""><h2 id="380c" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">如何推断顾客评论的情绪</h2></div><p id="3a81" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">自然语言处理(NPL)是人工智能的一个领域，其目的是找到计算方法来解释人类语言的口语或书面语。NLP的思想超越了可以由ML算法或深度学习神经网络进行的简单分类任务。的确，NLP是关于<em class="lu">解释</em>的:你想训练你的模型不仅要检测频繁出现的单词，还要统计它们或者消除一些嘈杂的标点符号；你希望它告诉你谈话的情绪是积极的还是消极的，电子邮件的内容是纯粹的宣传还是重要的事情，过去几年关于惊悚小说的评论是好是坏。</p><p id="2d16" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">好消息是，对于NLP，我们提供了有趣的Python库，它提供了一个预先训练好的模型，能够查询书面文本。其中，我将使用<a class="ae jg" href="https://spacy.io/" rel="noopener ugc nofollow" target="_blank">空间</a>和<a class="ae jg" href="https://www.nltk.org/" rel="noopener ugc nofollow" target="_blank"> NLTK </a>。</p><p id="e1f5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本文中，我将分析女装电子商务数据集，其中包含客户撰写的文本评论(此处<a class="ae jg" href="https://www.kaggle.com/nicapotato/womens-ecommerce-clothing-reviews/version/1#" rel="noopener ugc nofollow" target="_blank">可用</a>)。</p><p id="81bf" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以下是数据集的描述:</p><pre class="lv lw lx ly gt lz ma mb mc aw md bi"><span id="433d" class="me mf jj ma b gy mg mh l mi mj">This dataset includes 23486 rows and 10 feature variables. Each row corresponds to a customer review, and includes the variables:</span><span id="c8c8" class="me mf jj ma b gy mk mh l mi mj">Clothing ID: Integer Categorical variable that refers to the specific piece being reviewed.</span><span id="fdd9" class="me mf jj ma b gy mk mh l mi mj">Age: Positive Integer variable of the reviewers age.</span><span id="b587" class="me mf jj ma b gy mk mh l mi mj">Title: String variable for the title of the review.</span><span id="7e80" class="me mf jj ma b gy mk mh l mi mj">Review Text: String variable for the review body.</span><span id="419c" class="me mf jj ma b gy mk mh l mi mj">Rating: Positive Ordinal Integer variable for the product score granted by the customer from 1 Worst, to 5 Best.</span><span id="0159" class="me mf jj ma b gy mk mh l mi mj">Recommended IND: Binary variable stating where the customer recommends the product where 1 is recommended, 0 is not recommended.</span><span id="2ee6" class="me mf jj ma b gy mk mh l mi mj">Positive Feedback Count: Positive Integer documenting the number of other customers who found this review positive.</span><span id="87d5" class="me mf jj ma b gy mk mh l mi mj">Division Name: Categorical name of the product high level division.</span><span id="080f" class="me mf jj ma b gy mk mh l mi mj">Department Name: Categorical name of the product department name.</span><span id="e2de" class="me mf jj ma b gy mk mh l mi mj">Class Name: Categorical name of the product class name.</span></pre><p id="b398" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，让我们导入并检查我们的数据集:</p><pre class="lv lw lx ly gt lz ma mb mc aw md bi"><span id="ddda" class="me mf jj ma b gy mg mh l mi mj">import pandas as pd<br/>df = pd.read_csv('Womens Clothing E-Commerce Reviews.csv')<br/>df.head()</span></pre><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ml"><img src="../Images/50a2127412ac767b27f1d6a3aec8d2b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a4ZWR7zygcXHn0Kga2T5Ag.png"/></div></div></figure><p id="4f0b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们清理它，删除NaN值和无用的列，以及清理文本。</p><pre class="lv lw lx ly gt lz ma mb mc aw md bi"><span id="6323" class="me mf jj ma b gy mg mh l mi mj">df.dropna(inplace=True)<br/>df.reset_index(drop=True, inplace=True)<br/>import re<br/>for i in range(len(df)):<br/>    #print(i)<br/>    df['Review Text'][i] = df['Review Text'][i].replace("'s", " is").replace("'ll", " will").replace("'ve", " have").replace("'m", " am").replace("\'", "'")<br/>    <br/>df['Review Text'][1]<br/>df = df.drop('Unnamed: 0', 1)<br/>df.head()</span></pre><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mm"><img src="../Images/63ad16c8e2e706a4144011fb0fb0c396.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E7POyB5aUVLys2CdcFSk0A.png"/></div></div></figure><p id="0aa5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个想法是提取每个评论的情感，看它是否与推荐指标一致(如果评论推荐该项目，则为1，否则为0)。</p><p id="bfd8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，我们将使用NLTK包中可用的Vader模块(您可以在这里找到官方文档<a class="ae jg" href="https://www.nltk.org/_modules/nltk/sentiment/vader.html" rel="noopener ugc nofollow" target="_blank"/>)。但是首先，让我们预处理我们的文本并提取词条:</p><pre class="lv lw lx ly gt lz ma mb mc aw md bi"><span id="a524" class="me mf jj ma b gy mg mh l mi mj">#importing necessary libraries</span><span id="1337" class="me mf jj ma b gy mk mh l mi mj">import nltk<br/>import en_core_web_sm<br/>import spacy<br/>nlp = spacy.load("en_core_web_sm")<br/>from nltk.corpus import stopwords<br/></span><span id="c10e" class="me mf jj ma b gy mk mh l mi mj">def lemmatization(df):<br/>    df["Lemmas"] = [" ".join([token.lemma_ if token.lemma_ != "-    <br/>    PRON-" else token.text.lower() <br/>    for sentence in nlp(speech).sents for token in sentence if <br/>    token.pos_ in {"NOUN", "VERB", "ADJ", "ADV", "X"} and  <br/>    token.is_stop == False]) for speech in df.text]</span><span id="d1b4" class="me mf jj ma b gy mk mh l mi mj"><br/>    <br/>df["Lemmas"] = [" ".join([token.lemma_ if token.lemma_ != "-PRON-" <br/>                else token.text.lower() for sentence in <br/>                nlp(speech).sents for token in sentence if <br/>                token.pos_ in {"NOUN", "VERB", "ADJ", "ADV", "X"} <br/>                and token.is_stop == False]) for speech in <br/>                df['Review Text']]</span><span id="054d" class="me mf jj ma b gy mk mh l mi mj">df.head()</span></pre><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mn"><img src="../Images/3416f8285a9cc1efb5eaf876016afa1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ixnhtb9JZsYy7X77ZANoKw.png"/></div></div></figure><p id="0618" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们对Lemmas列进行情感分析:</p><pre class="lv lw lx ly gt lz ma mb mc aw md bi"><span id="d0f6" class="me mf jj ma b gy mg mh l mi mj">from nltk.sentiment.vader import SentimentIntensityAnalyzer</span><span id="ef68" class="me mf jj ma b gy mk mh l mi mj">sid = SentimentIntensityAnalyzer()<br/>sentiment=[]<br/>for i in range(len(df)):<br/>     ss = sid.polarity_scores(df.Lemmas[i])<br/>     sentiment.append(ss)<br/>    <br/>compound=[sentiment[i]['compound'] for i in range(len(sentiment))]<br/>df['compound']=compound<br/>df.head()</span></pre><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mo"><img src="../Images/2b6d8cec7d59f2d2490ef5977b8c80e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H-T_BI7VBu1OAGsBGRPxEA.png"/></div></div></figure><p id="0ab3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">复合列包含范围从-1(非常负)到1(非常正)的分数。一般来说，如果一篇文章的分数大于0.05，我们就给它贴上“正面”标签；如果分数小于-0.05，我们就贴上“负面”标签；如果分数在-0.05到0.05之间，我们就贴上“中性”标签。但是，为了这个研究问题的目的，我们将只区分积极和消极，使用分数=0作为阈值。</p><pre class="lv lw lx ly gt lz ma mb mc aw md bi"><span id="75a8" class="me mf jj ma b gy mg mh l mi mj">sent=[]<br/>for i in compound:<br/>    if i&lt;0:<br/>        sent.append('negative')<br/>    else:<br/>        sent.append('positive')</span><span id="c69d" class="me mf jj ma b gy mk mh l mi mj">df['sentiment']=sent<br/>df.head()</span></pre><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mp"><img src="../Images/e6a2449f7cafd397c6dbaa157d108837.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1bENxtr9D79wHe0-tUWYZg.png"/></div></div></figure><p id="26b4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第一眼看到情感专栏，似乎大多数评论都是积极的，但它与推荐项目的数量一致:在19661篇评论中，有16087篇最终得到了推荐。</p><p id="ebef" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们来看看有多少推荐商品符合点评的情绪。让我借用假阳性/阴性和真阳性/阴性的统计学术语来完成这个任务:当商品被推荐购买时，我谈论假阳性，然而文本评论却带有负面情绪。</p><pre class="lv lw lx ly gt lz ma mb mc aw md bi"><span id="446b" class="me mf jj ma b gy mg mh l mi mj">#initializing a 2x2 matrix populated with zeros</span><span id="5861" class="me mf jj ma b gy mk mh l mi mj">mat = np.zeros(4).reshape(2,2)<br/>true_neg=0<br/>true_pos=0<br/>false_neg=0<br/>false_pos=0</span><span id="7800" class="me mf jj ma b gy mk mh l mi mj">for i in range(len(df)):<br/>    if df['sentiment'][i]=='negative' and df['Recommended IND'][i]==0:<br/>        true_neg+=1<br/>    elif df['sentiment'][i]=='positive' and df['Recommended IND'][i]==1:<br/>        true_pos+=1<br/>    elif df['sentiment'][i]=='positive' and df['Recommended IND'][i]==0:<br/>        false_neg+=1<br/>    elif df['sentiment'][i]=='negative' and df['Recommended IND'][i]==1:<br/>        false_pos+=1<br/>    <br/>mat[0][0]=true_neg<br/>mat[0][1]=false_neg<br/>mat[1][0]=false_pos<br/>mat[1][1]=true_pos<br/>mat</span></pre><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/6aa91d9d70f0f18fa15bd633f3858f7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*_rICB6MmcpW9S5j4Os68mQ.png"/></div></figure><p id="f2e7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们把它变得漂亮一点:</p><pre class="lv lw lx ly gt lz ma mb mc aw md bi"><span id="2dff" class="me mf jj ma b gy mg mh l mi mj">from pandas import DataFrame</span><span id="7fcd" class="me mf jj ma b gy mk mh l mi mj">Index= ['Not Recommended', 'Recommended']<br/>Cols = ['Negative', 'Positive']<br/>d = DataFrame(mat, index=Index, columns=Cols)</span></pre><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/c4f009994f6673e77c8d17d2043040b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*6LCB748RaMSGM8F71sY1rA.png"/></div></figure><p id="1bbd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所以在16087个推荐条目中，只有227个不符合文本的情感。另一方面，我们并不推荐3154个实际上已经获得正面评价的项目。这种结果可能暗示了推荐系统的不同方法，因为如果我们观察评论者的情绪，可能会购买更多的项目。</p><p id="e1b6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">情感分析在市场研究和类似领域中起着举足轻重的作用。事实上，跟踪顾客的满意度，最重要的是，隔离那些决定他们对商品的情绪的驱动因素，可能会导致赢得营销活动和销售策略。</p><p id="981d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这篇文章中，我将我的研究局限于情感分析，但是这个数据集提供了多个研究问题，这将在我的下一篇文章中涉及，所以请继续关注！</p><h2 id="3ab5" class="me mf jj bd ms mt mu dn mv mw mx dp my lh mz na nb ll nc nd ne lp nf ng nh ni bi translated">参考资料:</h2><ul class=""><li id="9a10" class="nj nk jj la b lb nl le nm lh nn ll no lp np lt nq nr ns nt bi translated"><a class="ae jg" href="https://www.nltk.org/" rel="noopener ugc nofollow" target="_blank">https://www.nltk.org/</a></li><li id="6085" class="nj nk jj la b lb nu le nv lh nw ll nx lp ny lt nq nr ns nt bi translated">https://spacy.io/<a class="ae jg" href="https://spacy.io/" rel="noopener ugc nofollow" target="_blank"/></li><li id="d2bc" class="nj nk jj la b lb nu le nv lh nw ll nx lp ny lt nq nr ns nt bi translated">【https://medium.com/r/? T4】URL = https % 3A % 2F %2Fwww . ka ggle . com % 2Fnicapotato % 2f预兆-电子商务-服装-评论% 2f版本%2F1%23 </li></ul></div></div>    
</body>
</html>