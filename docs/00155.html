<html>
<head>
<title>Data Cleaning and Analysis with a Bonus Story</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据清理和分析以及额外的故事</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-cleaning-and-analysis-with-a-bonus-story-36b3ae39564c?source=collection_archive---------18-----------------------#2020-01-05">https://towardsdatascience.com/data-cleaning-and-analysis-with-a-bonus-story-36b3ae39564c?source=collection_archive---------18-----------------------#2020-01-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="8502" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">人是企业中最关键的部分。人给人创造价值，卖给人。因此，人们及其生活的变化影响着每一项业务。人口特征和人们的生活方式在不久的过去发生了巨大的变化。塑造和定义一个国家人口的关键指标，如生育率、死亡率、预期寿命、肥胖、劳动力职业分布一直在变化。这些变化对于关键业务决策始终至关重要，因为人是所有业务的核心。</p><p id="8078" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Worldbank.org 拥有关于人口的社会和社会经济指标的全面数据集。根据性别统计，不同国家的劳动力、生育率和死亡率、预期寿命、肥胖和人口年龄分布数据均可获得。</p><div class="ko kp gp gr kq kr"><a href="https://databank.worldbank.org/source/gender-statistics" rel="noopener  ugc nofollow" target="_blank"><div class="ks ab fo"><div class="kt ab ku cl cj kv"><h2 class="bd iu gy z fp kw fr fs kx fu fw is bi translated">性别统计|数据库</h2><div class="ky l"><h3 class="bd b gy z fp kw fr fs kx fu fw dk translated">选择已被修改。随时单击“应用更改”以使用所做的更改刷新报告…</h3></div><div class="kz l"><p class="bd b dl z fp kw fr fs kx fu fw dk translated">databank.worldbank.org</p></div></div></div></a></div><p id="5b16" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过使用 worldbank.org 现有的数据，我将试图展示最近发生了什么变化，并解释这些变化。我将更多地关注数据分析部分，所以这更像是一个有奖金故事的数据分析项目。有许多有用和信息丰富的统计数据，但这些数据并不是一种清晰、易于分析的格式。我需要使用 pandas 来为探索性数据分析准备数据，并使用 matplotlib 和 seaborn 来进行可视化。</p><p id="dd99" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所有的代码都可以在 Github 上的<a class="ae la" href="https://github.com/SonerYldrm/gender_statistics" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div><div class="ab cl lb lc hx ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="im in io ip iq"><h1 id="f55f" class="li lj it bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated"><strong class="ak">为分析准备好数据</strong></h1><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="8461" class="mp lj it ml b gy mq mr l ms mt"># Importing necessary libraries<br/>import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>%matplotlib inline</span><span id="064d" class="mp lj it ml b gy mu mr l ms mt"># read the data into a pandas dataframe<br/>data = pd.read_csv('data.csv')</span><span id="5394" class="mp lj it ml b gy mu mr l ms mt">data.shape<br/>(2237, 19)</span></pre><p id="c05e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">初始数据集有 2237 行和 19 列。这些列是国家名称和代码、年份、系列名称和代码。系列名称和代码列描述了数据是什么。我下载了 4 个不同大洲 4 个国家 15 年(2004-2018)的数据。</p><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/6f209c1541fa00fea23055cfcfa024a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*7KBrB4MKzynBZ8BQlt-Rww.png"/></div></figure><p id="e096" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">指标有 500 多个。我的分析计划是使用 25 个指标来比较不同大洲的 4 个不同国家。为了过滤初始数据集，我创建了一个列表，其中包括我要分析的指标的系列代码。然后我用<strong class="js iu"> isin() </strong>方法创建了一个遮罩来过滤初始数据帧。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="ac08" class="mp lj it ml b gy mq mr l ms mt">mask <strong class="ml iu">=</strong> data['Series Code'].isin(code_list)<br/>data1 <strong class="ml iu">=</strong> data[mask]</span><span id="2c40" class="mp lj it ml b gy mu mr l ms mt">data1.shape<br/>(100, 19)</span></pre><p id="5a66" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们现在有 4 个不同国家 15 年(2004-2018)的 25 个属性。列名可以简化。例如，“2004 [YR2004]”可以写成 2004，国家名称列可以删除，因为国家代码清楚地显示了国家。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="c1bf" class="mp lj it ml b gy mq mr l ms mt">data1.columns = ['series_name', 'series_code', 'country_name', 'country_code', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011','2012', '2013', '2014', '2015', '2016', '2017', '2018']</span><span id="9b14" class="mp lj it ml b gy mu mr l ms mt">data1 = data1.drop('country_name', axis=1)</span></pre><p id="b39e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">缺失数据</strong></p><p id="9519" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">处理缺失值是数据清理的关键步骤。我们首先需要找到缺失的值，然后根据数据的特征和属性决定如何处理它们。对于所有数据集，没有一种最佳的方法来做到这一点。这在很大程度上取决于数据集。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="3c38" class="mp lj it ml b gy mq mr l ms mt">data1.isna().any().sum()<br/>0</span></pre><p id="4bba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们的数据集中似乎没有缺失数据，但我知道有些单元格没有任何信息。有些行带有“..”这些值实际上是缺失值，但熊猫无法检测出它们是缺失值。因此，目视检查数据集也非常重要。我将使用 dataframes <strong class="js iu"> replace() </strong>方法用 NaN 替换这些值。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="25be" class="mp lj it ml b gy mq mr l ms mt">data1.replace('..', np.nan, inplace=True)</span><span id="99d1" class="mp lj it ml b gy mu mr l ms mt">data1.isna().sum()<br/>series_name      0<br/>series_code      0<br/>country_code     0<br/>2004            10<br/>2005             9<br/>2006            10<br/>2007            10<br/>2008            10<br/>2009            10<br/>2010             5<br/>2011            10<br/>2012            10<br/>2013             6<br/>2014             5<br/>2015             7<br/>2016             7<br/>2017            16<br/>2018            40<br/>dtype: int64</span></pre><p id="02aa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> isna()。any() </strong>返回一个布尔值，如果该列中有任何缺失值，则该值为真。另一方面，<strong class="js iu">是一种()。sum() </strong>将返回一列中缺失值的总数。</p><p id="8e14" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下一步是决定如何处理这些丢失的值。2018 列包含 100 个空值中的 40 个，因此我将删除整个列。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="d36e" class="mp lj it ml b gy mq mr l ms mt">data1 = data1.drop('2018', axis=1)</span></pre><p id="d2cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">pandas drop()函数的一个重要参数是<strong class="js iu">轴</strong>，用于指定列(1)或行(0)。</p><p id="e64d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如所料，缺少的值大多在同一行中，因为某些属性没有任何特定国家的值，这导致该行中的大多数值都是 NaN。因此，我将根据该行中 NaN 值的阈值删除行。删除 2018 列后，我们有 14 年(2004-2017)的数据，我将使用 70%的阈值。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="2f92" class="mp lj it ml b gy mq mr l ms mt">data1 = data1.dropna(thresh=14*0.7, axis='rows')</span></pre><p id="3e84" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">之后，还剩下一些缺失的值。可以接受用同一国家前一年的数值来填充这些数值，这不会对结果产生很大影响。为此，我将对行使用带有<strong class="js iu"> ffill </strong>方法的<strong class="js iu"> fillna() </strong>。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="f1f6" class="mp lj it ml b gy mq mr l ms mt">data1 = data1.fillna(method='ffill', axis=0)</span><span id="a574" class="mp lj it ml b gy mu mr l ms mt">#Make sure no missing values left<br/>data1.isna().sum().sum()<br/>0</span></pre><p id="7ca5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">值的数据类型是不适于数值分析的对象。因此，我需要更改数字列的数据类型。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="6890" class="mp lj it ml b gy mq mr l ms mt">years = ['2004', '2005', '2006','2007', '2008', '2009', '2010', '2011', '2012', '2013', '2014', '2015','2016', '2017']</span><span id="fa92" class="mp lj it ml b gy mu mr l ms mt">for year in years:<br/>    data1 = data1.astype({year:'float'})</span></pre><p id="08f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们的数据集现在包括 90 行和 17 列。我的分析最初旨在基于 15 年期间的 25 个不同属性来比较 4 个不同的国家。由于数据不可用，我删除了一些列和行。删除这些行和列后，有些属性没有所有 4 个国家的数据。为了进行全面彻底的分析，我将只使用包含所有 4 个国家数据的属性。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="605c" class="mp lj it ml b gy mq mr l ms mt">data1.shape<br/>(90, 17)</span><span id="561e" class="mp lj it ml b gy mu mr l ms mt">attributes = data1.series_name.value_counts() == 4</span><span id="6911" class="mp lj it ml b gy mu mr l ms mt"># Filter attributes with 4 values <br/>attributes = attributes[attributes.values == True]</span><span id="0dc3" class="mp lj it ml b gy mu mr l ms mt"># Make a list from series index<br/>attributes_list = list(attributes.index)</span><span id="f22c" class="mp lj it ml b gy mu mr l ms mt"># Use this list as filter<br/>mask1 = data1['series_name'].isin(attributes_list)<br/>data1 = data1[mask1]</span><span id="4890" class="mp lj it ml b gy mu mr l ms mt">data1.shape<br/>(72, 17)</span></pre><p id="f43d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们现在有 4 个不同国家 14 年的 18 个属性。这些属性是:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="5ab5" class="mp lj it ml b gy mq mr l ms mt">attributes_list<br/>['Prevalence of obesity, female (% of female population ages 18+)',<br/> 'Life expectancy at birth, female (years)',<br/> 'Employment in services, female (% of female employment) (modeled ILO estimate)',<br/> 'Fertility rate, total (births per woman)',<br/> 'Population ages 15-64 (% of total)',<br/> 'Employment in industry, male (% of male employment) (modeled ILO estimate)',<br/> 'Employment in agriculture, female (% of female employment) (modeled ILO estimate)',<br/> 'Contributing family workers, female (% of female employment) (modeled ILO estimate)',<br/> 'Employment in industry, female (% of female employment) (modeled ILO estimate)',<br/> 'Prevalence of obesity, male (% of male population ages 18+)',<br/> 'Population ages 65 and above (% of total)',<br/> 'Labor force, female (% of total labor force)',<br/> 'Contributing family workers, male (% of male employment) (modeled ILO estimate)',<br/> 'Employment in services, male (% of male employment) (modeled ILO estimate)',<br/> 'Life expectancy at birth, male (years)',<br/> 'Population ages 0-14 (% of total)',<br/> 'Employment in agriculture, male (% of male employment) (modeled ILO estimate)',<br/> 'Death rate, crude (per 1,000 people)']</span></pre><h1 id="ee66" class="li lj it bd lk ll mz ln lo lp na lr ls lt nb lv lw lx nc lz ma mb nd md me mf bi translated"><strong class="ak">探索性数据分析</strong></h1><p id="ed24" class="pw-post-body-paragraph jq jr it js b jt ne jv jw jx nf jz ka kb ng kd ke kf nh kh ki kj ni kl km kn im bi translated">我计划基于三个主要主题来分析这些数据:</p><ol class=""><li id="6755" class="nj nk it js b jt ju jx jy kb nl kf nm kj nn kn no np nq nr bi translated">雇用</li><li id="4151" class="nj nk it js b jt ns jx nt kb nu kf nv kj nw kn no np nq nr bi translated">肥胖</li><li id="d2b1" class="nj nk it js b jt ns jx nt kb nu kf nv kj nw kn no np nq nr bi translated">年龄分布、预期寿命、生育率和死亡率</li></ol><p id="2431" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">就业</strong></p><p id="2b3e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">就业属性显示了农业、服务业和工业这三个不同领域中劳动力职业的百分比。我将使用 series_name 列中的描述来过滤这些属性。</p><p id="9f4e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Pandas 有许多有用的矢量化字符串操作。我将使用<strong class="js iu"> contains() </strong>方法如下:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="26e8" class="mp lj it ml b gy mq mr l ms mt">employment = data1[data1.series_name.str.contains('Employment')]</span><span id="fb1d" class="mp lj it ml b gy mu mr l ms mt">employment.shape<br/>(24, 17)</span></pre><p id="5d7e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">4 个国家有 6 个属性:男性和女性在农业、服务业和工业的就业情况。</p><p id="62b3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我将尝试使系列代码更具信息性，并删除 series_name 列，以便更容易分析和可视化。比如 SL。AGR.EMPL.FE.ZS 指农业就业(女性)。我将从这段代码中导出 AGR 和 FE，并使用矢量化字符串操作<strong class="js iu"> split()生成单独的列。</strong>然后使用 pandas <strong class="js iu"> concat() </strong>函数将结果数据帧与原始数据帧合并:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="ad58" class="mp lj it ml b gy mq mr l ms mt">split1 = employment.series_code.str.split(".", expand=True)<br/>employment = pd.concat([employment, split1], axis=1)</span></pre><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/94066e23f5596e59838d9ad8e969d5f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*FCXH6Me2ia7w8fWvB4_YRg.png"/></div><p class="ny nz gj gh gi oa ob bd b be z dk translated">原始列(不显示年份)</p></figure><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/1efad326d0b45ab5d037730dfeb2bf08.png" data-original-src="https://miro.medium.com/v2/resize:fit:336/format:webp/1*msn54nNbnGoq9GmbyirpfA.png"/></div><p class="ny nz gj gh gi oa ob bd b be z dk translated">从 split()返回的列</p></figure><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="3406" class="mp lj it ml b gy mq mr l ms mt"># To simplify, drop series_code, 0, 2 and 4<br/># Rename 1 and 3 to be more informative</span><span id="53b8" class="mp lj it ml b gy mu mr l ms mt">employment = employment.drop(['series_code', 0, 2, 4], axis=1)<br/>employment.rename(columns={1:'field', 3:'gender'}, inplace=True)</span><span id="37db" class="mp lj it ml b gy mu mr l ms mt"># New columns<br/>employment.columns</span><span id="ec9e" class="mp lj it ml b gy mu mr l ms mt">Index(['series_name', 'country_code', '2004', '2005', '2006', '2007', '2008','2009', '2010', '2011', '2012', '2013', '2014', '2015', '2016', '2017','field', 'gender'],dtype='object')</span><span id="df2c" class="mp lj it ml b gy mu mr l ms mt"># Can drop series_name as well because field and gender columns<br/># are enough to describe the data<br/>employment_new = employment.drop('series_name', axis=1)</span></pre><p id="8aa7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以列的形式列出年份不便于分析和可视化。因此，我将创建一个 year 列，并将所有年份作为行项目列出。熊猫已经在<strong class="js iu">中内置了</strong>()【融化】功能来完成这个任务。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="a523" class="mp lj it ml b gy mq mr l ms mt">employment_new = employment_new.melt(id_vars=['country_code', 'field', 'gender'],<br/>                   var_name='year',<br/>                   value_name='employment')</span></pre><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div class="gh gi od"><img src="../Images/6bb733866a069a7273dfa8e39d92c3a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*ZlQOR_RjmzCqyGHwqUZ7dw.png"/></div><p class="ny nz gj gh gi oa ob bd b be z dk translated">就业数据框架的最终版本</p></figure><p id="7000" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们看看劳动力职业是如何随着时间的推移而变化的。使用 seaborn lineplot 的色调和风格参数，我们可以在同一个图表上看到男性和女性的每个职业。我还认为，如果图形上有许多线条，最好将图例放在图形之外。下面代码片段的最后一行找到了图例。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="a05d" class="mp lj it ml b gy mq mr l ms mt">sns.set_context("notebook", font_scale=1.5, rc={"lines.linewidth": 2.5})<br/>plt.figure(figsize=(10,6))<br/>ax = sns.lineplot(x='year', y='employment', hue='field', style='gender', ci=None, data=employment_new)<br/>ax.set_title('Labor Force Occupations in General')<br/>ax.set_xlabel('')<br/>ax.set_ylabel('% share')<br/>ax.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)</span></pre><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi oe"><img src="../Images/be23e0fb4612bb7ba7e8d4d164dc47ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dml0SXUjv4nxefbyW4fUWg.png"/></div></div></figure><p id="f6f4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">总的来说，无论男女，超过一半的劳动力从事与服务相关的工作。这并不奇怪，因为与服务相关的工作在零售、运输、医疗保健、分销和许多其他行业无处不在。虽然与服务相关的工作有增加的趋势，但在工业或农业部门工作的人数却在减少。农业是过去的主要职业，但随着生产力的提高和技术带来的便利，农业工作减少了。近期仍有下降趋势。同样，近年来，越来越多的机器参与到工业中，使得大部分工作自动化并由机器完成，这反过来减少了男性和女性的工作岗位。</p><p id="2e06" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在劳动力分布方面，国与国之间可能存在差异。下面截取的代码展示了如何为荷兰创建一个线图。同样，只需更改 mask 中的国家代码，我们就可以为其他国家创建相同的可视化效果。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="c9f2" class="mp lj it ml b gy mq mr l ms mt">#Labor force occupations in Netherlands<br/>sns.set_context("notebook", font_scale=1.5, rc={"lines.linewidth": 2.5})<br/>maskNLD = employment_new.country_code == 'NLD'<br/>plt.figure(figsize=(10,6))<br/>ax = sns.lineplot(x='year', y='employment', hue='field', style='gender', data=employment_new[maskNLD])<br/>ax.set_title('Employment in Netherlands')<br/>ax.set_xlabel('')<br/>ax.set_ylabel('% share')<br/>ax.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)</span></pre><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi oe"><img src="../Images/55cc851eabba6d991453c7a3d51d0ffb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LoHOSoAZ7xC9wr8ejAJmEg.png"/></div></div></figure><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi oe"><img src="../Images/5c404613c975de2684467e44f45bf038.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Du3KnBiLeA2HQN_hbcwwPA.png"/></div></div></figure><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi oe"><img src="../Images/d736494a5619290a9060f5ab0cdfbcb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tWqLSs8P6hy0xtX7Vk60lg.png"/></div></div></figure><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi oe"><img src="../Images/dacdad092699ceb3a069c2a518aee787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0xW1W0LRZKvZUnyDNSCCDA.png"/></div></div></figure><p id="3804" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">有一个有趣的趋势引起了我们的注意。在发达国家，美国和荷兰，劳动职业份额不随时间变化。2004 年和 2017 年的数值差不多。然而，在发展中国家，我们看到了很多变化。</p><p id="411c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">除土耳其外，所有国家的女性都比男性更多地从事与服务相关的工作。我认为这是因为土耳其女性比过去更多地加入了劳动力大军。2015 年后，服务领域女性份额超过男性份额。</p><p id="c617" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Seaborn 允许我们通过提供许多参数和选项来定制可视化。例如，我们可以在同一个图形上使用色调、风格和大小参数来可视化不同的类别。我用色调和风格来区分职业和性别。另一方面，有时在同一个图表上显示不同的类别并不是一个好的选择，因为它看起来很复杂，很难阅读。在这种情况下，我们可以通过使用子图在一个可视化图形上绘制多个图形:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="35a0" class="mp lj it ml b gy mq mr l ms mt"># Create masks to filter employment dataframe<br/>mask00 = (employment_new.field == 'AGR') &amp; (employment_new.gender == 'MA')<br/>mask01 = (employment_new.field == 'AGR') &amp; (employment_new.gender == 'FE')</span><span id="00b3" class="mp lj it ml b gy mu mr l ms mt">fig, axs = plt.subplots(ncols=2, figsize=(18,6))<br/>sns.set_context("notebook", font_scale=1.3, rc={"lines.linewidth": 2.})<br/>sns.lineplot(x='year', y='employment', hue='country_code', data=employment_new[mask00], legend=False, ax=axs[0])<br/>axs[0].set_title('Male Employment in Agriculture')<br/>axs[0].set_ylabel('% Share')<br/>axs[0].set_xlabel('')<br/>sns.lineplot(x='year', y='employment', hue='country_code', data=employment_new[mask01], ax=axs[1])<br/>axs[1].set_title('Female Employment in Agriculture')<br/>axs[1].set_ylabel('')<br/>axs[1].set_xlabel('')<br/>axs[1].legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)</span></pre><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi oj"><img src="../Images/644f32c413aaa98c3a5de5e7f513d0ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LSR7AEBi9gp9KC3_WAj5Dg.png"/></div></div><p class="ny nz gj gh gi oa ob bd b be z dk translated">农业工作</p></figure><p id="59e4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上面的图表也显示了土耳其和中国农业就业的下降趋势，而美国和荷兰的农业就业份额保持稳定。</p><p id="c593" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">肥胖</strong></p><p id="042c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我使用<strong class="js iu"> str.contains() </strong>函数从初始数据帧中过滤肥胖数据:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="2354" class="mp lj it ml b gy mq mr l ms mt">obesity = data1[data1.series_name.str.contains('obesity')]</span></pre><p id="d60b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">应用同样的步骤，我创建了肥胖数据框架:</p><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/a6bd71af9599948c8b9df9f44bf408fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*2P1HonEtHcRONMjRpEz7fQ.png"/></div></figure><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi ol"><img src="../Images/43ddcbd82890cba1794b4ca7397bb22f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*crIQyA2EroPl0TNYIsgXEQ.png"/></div></div></figure><p id="d7ea" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">每个国家的肥胖程度不同，但它们有一个共同点:肥胖正在增加。这对我们的健康绝对不是一个好兆头。土耳其的一个有趣的区别是，女性的肥胖率远远高于男性，而在其他国家，女性和男性的肥胖率非常接近。</p><p id="b123" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">年龄分布、预期寿命、生育率和死亡率</strong></p><p id="b14d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">初始数据集具有许多与人口统计学相关的属性。我将尝试了解我们的数据集中包括的 4 个不同国家的总人口年龄组、死亡率、生育率和出生时预期寿命。</p><p id="626f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">通过对初始数据框架应用与就业和肥胖相同的步骤，我获得了 4 个不同的数据框架:年龄分布、预期寿命、生育率和死亡率。</p><p id="f8eb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了简单起见，并且能够更容易地比较一些属性，我将把这些数据帧合并成一个。Pandas 内置的<strong class="js iu"> merge() </strong>函数使得合并数据帧变得非常简单。数据帧的共同点或您想要组合数据帧的条件由'<strong class="js iu"> on </strong>参数指定:</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="e449" class="mp lj it ml b gy mq mr l ms mt">population_new = pd.merge(population, life_exp, on=['country_code','year'])</span></pre><p id="37a4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">应用<strong class="js iu"> merge() </strong>函数后，最终数据帧如下:</p><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div class="gh gi om"><img src="../Images/f465aeccd7ea12c63e5723ae8822fb47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*d9y1VF-Qc-Uqk-938jOJTQ.png"/></div></figure><p id="8407" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">世界人口正在老龄化。据世界卫生组织(世卫组织)称，世界人口老龄化是生育率持续下降和预期寿命延长的结果。这种人口结构的变化导致 60 岁以上人口的数量和比例不断增加。因此，历史上第一次老年人比年轻人多的时代正在迅速到来。</p><p id="cb9a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们用现有的数据来证实这些:</p><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi on"><img src="../Images/a167141d382973faca0bb7dc2cf41f2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2IjH-HCNh-5ClyYIhz5wzw.png"/></div></div></figure><p id="1b1a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如上图所示，14 岁及以下的人口在减少，而 65 岁及以上的人口在增加。这一趋势适用于我们数据中包含的所有国家。</p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="aa3c" class="mp lj it ml b gy mq mr l ms mt">mask1 = population_new.ages == '0014'<br/>mask2 = population_new.ages == '65UP'</span><span id="7705" class="mp lj it ml b gy mu mr l ms mt">fig, axs = plt.subplots(ncols=2, figsize=(20,6))</span><span id="cd6a" class="mp lj it ml b gy mu mr l ms mt">sns.lineplot(x='year', y='share', hue='country_code', data=population_new[mask1], legend=False, ax=axs[0])<br/>axs[0].set_title('14 and under')<br/>axs[0].set_ylabel('% Share')<br/>axs[0].set_xlabel('')</span><span id="441b" class="mp lj it ml b gy mu mr l ms mt">sns.lineplot(x='year', y='share', hue='country_code', data=population_new[mask2], ax=axs[1])<br/>axs[1].set_title('65 and UP')<br/>axs[1].set_ylabel('')<br/>axs[1].set_xlabel('')<br/>axs[1].legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)</span></pre><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi ca"><img src="../Images/86299c7351ca02df8bfbd85fe8da7353.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CafqQwX_F4PDpqUt1FHpuA.png"/></div></div></figure><p id="c8e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如世卫组织所言<a class="ae la" href="https://www.who.int/features/qa/72/en/" rel="noopener ugc nofollow" target="_blank">，人口老龄化的主要原因是预期寿命增加和生育率下降:</a></p><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi oo"><img src="../Images/30c05f645fd0946c7dfdb1f0a9599805.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gAQ3dnbDz_5Mo67x5LBHMg.png"/></div></div></figure><p id="26d7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">可以肯定地说，一般来说，女人比男人长寿。以下数据证实了这一点:</p><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi op"><img src="../Images/15437a5d65afd50454fe87b319d86ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9OEaCPyi6qKQ7KA7UUSl-A.png"/></div></div></figure><p id="e7b0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这四个国家中，土耳其男人享受生活的时间最少。往好的方面看，土耳其男性的预期寿命也在增加。</p><p id="34a9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">人口老龄化意味着比以前有更多的老年人。这可能是与服务相关的工作数量增加的原因之一。</p><p id="53d3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最后，我还想检查不同国家的死亡率。根据 worldbank.org 的定义，粗死亡率是指年中估计的每 1，000 人口中一年内发生的死亡人数。死亡率属性在男性和女性之间没有区别。</p><figure class="mg mh mi mj gt mw gh gi paragraph-image"><div role="button" tabindex="0" class="of og di oh bf oi"><div class="gh gi oq"><img src="../Images/e51f32925f9b01452b6f66c62217b763.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eF3CjQGf50kOVFZBsICtpQ.png"/></div></div></figure><p id="a370" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">死亡率本身并不能告诉我们太多。为了获得关于人口的一些见解，我们需要一起分析死亡率、出生率和移民数据。</p><p id="6c62" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">结论</strong></p><p id="2010" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们讨论的特征不会在短时间内改变，但企业应该及时采取行动，因为我们的生活方式和生活方式对每个企业都至关重要。</p><p id="524c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">与大多数企业一样，我们可以在做出关键决策之前，利用数据来审视全局并获得更多洞察力。</p></div></div>    
</body>
</html>