<html>
<head>
<title>Time Series Analysis with Theory, Plots, and Code Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时间序列分析与理论、图表和代码第1部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-series-analysis-with-theory-plots-and-code-part-1-dd3ea417d8c4?source=collection_archive---------2-----------------------#2020-04-05">https://towardsdatascience.com/time-series-analysis-with-theory-plots-and-code-part-1-dd3ea417d8c4?source=collection_archive---------2-----------------------#2020-04-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/65994e1f44de887fdcfaa7271ba857e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GUjIYs3dhe69gIF3EU0aWw.png"/></div></div></figure><h1 id="97a4" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak"> A .先有理论</strong></h1><h1 id="9d8f" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak"> 1。</strong> <strong class="ak">什么是时间序列？</strong></h1><p id="32bd" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><strong class="lb iu"> <em class="lx">时间序列</em> </strong> <em class="lx">是以固定的时间间隔记录的一系列观测值。</em></p><p id="3f7a" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">根据观测频率的不同，时间序列通常可以是每小时、每天、每周、每月、每季度和每年。有时，你可能也有秒和分钟的时间序列，比如，每分钟的点击量和用户访问量，等等。</p><p id="9ae1" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">大多数问题使用时间序列数据。任何随时间顺序观察到的事物都是时间序列。</p><p id="b772" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">时间序列数据的示例包括:</p><ul class=""><li id="b6d5" class="md me it lb b lc ly lg lz lk mf lo mg ls mh lw mi mj mk ml bi translated">每日股票价格</li><li id="e20e" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated">每月海水温度</li><li id="daad" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated">公司的季度销售额</li><li id="701f" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated">公司年度利润</li></ul><p id="6f13" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated"><strong class="lb iu">时间序列分析</strong>包括了解序列固有性质的各个方面，以便您更好地了解信息，从而创建有意义且准确的预测。</p><p id="5c8e" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">时间序列分析是开发序列的<em class="lx">预测</em>之前的准备步骤。你对数据了解得越多，预测就越准确。</p><h1 id="f07c" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak"> 2。预测任务的基本步骤</strong></h1><ol class=""><li id="12f6" class="md me it lb b lc ld lg lh lk mr lo ms ls mt lw mu mj mk ml bi translated"><strong class="lb iu">问题定义。这通常是预测中最困难的部分。仔细定义问题需要了解预测的使用方式，谁需要预测，以及预测功能如何适应需要预测的组织。一个预报员需要花时间和每个参与收集数据、维护数据库和使用预测进行未来规划的人交谈。</strong></li><li id="ad48" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mu mj mk ml bi translated">收集信息。至少需要两种信息:(1)统计数据，和(2)收集数据和使用预测的人积累的专业知识。通常，很难获得足够的历史数据来拟合一个好的统计模型。偶尔，由于预测系统的结构变化，旧数据会变得不太有用；那么我们可以选择只使用最新的数据。然而，请记住，一个好的统计模型将处理系统中的进化变化；不要不必要地丢弃好的数据。</li><li id="bb68" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mu mj mk ml bi translated"><strong class="lb iu">探索性分析。总是从绘制数据开始。有一致的模式吗？有显著的趋势吗？季节性重要吗？有商业周期存在的证据吗？数据中有没有异常值需要有专家知识的人来解释？可供分析的变量之间的关系有多强？已经开发了各种工具来帮助进行这种分析。</strong></li><li id="3e2d" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mu mj mk ml bi translated"><strong class="lb iu">选择和拟合模型。</strong>要使用的最佳模型取决于历史数据的可用性、预测变量和任何解释变量之间的关系强度，以及预测的使用方式。比较两个或三个潜在模型是很常见的。每个模型本身都是基于一组假设(显式和隐式)的人工构造，通常涉及一个或多个必须使用已知历史数据进行估计的参数。</li><li id="261a" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mu mj mk ml bi translated"><strong class="lb iu">使用和评估预测模型。</strong>一旦选择了模型并估计了其参数，就可以使用该模型进行预测。只有在预测期的数据可用后，才能正确评估模型的性能。已经开发了许多方法来帮助评估预测的准确性。在使用和实施预测方面也存在组织问题。</li></ol><h1 id="8fb2" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak"> 3。时间序列图形</strong></h1><p id="8406" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">首先要做的是<strong class="lb iu">导入数据</strong>。它们通常是. csv格式。它们可以有一列显示日期，多列显示测量值。当有多个样本时，数据集可以有一个sample_id列，对于每个唯一的id，日期将重复。这种格式称为<strong class="lb iu">面板数据</strong>。</p><p id="4cf9" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">在任何数据分析任务中，接下来要做的事情是<strong class="lb iu">绘制数据</strong>。图表使数据的许多特征可视化，包括模式、异常观察、随时间的变化以及变量之间的关系。在数据图中看到的特征必须尽可能地结合到要使用的预测方法中。正如数据类型决定了使用什么样的预测方法一样，它也决定了什么样的图表是合适的。</p><p id="dbbd" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">从图中我们可以观察到几个<strong class="lb iu">时间序列模式</strong>:</p><ul class=""><li id="38ee" class="md me it lb b lc ly lg lz lk mf lo mg ls mh lw mi mj mk ml bi translated"><strong class="lb iu">趋势。</strong>当数据长期增加或减少时，趋势存在。它不必是线性的。当趋势可能从上升趋势变为下降趋势时，有时趋势被称为“改变方向”。</li><li id="d47b" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated"><strong class="lb iu">季节性。</strong>当时间序列受季节性因素(如一年中的某个时间或一周中的某一天)影响时，会出现季节性模式。季节性总是有一个固定和已知的频率。</li><li id="2692" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated"><strong class="lb iu">循环往复。</strong>当数据呈现非固定频率的上升和下降时，出现一个周期。如果模式不是基于固定日历的频率，那么它是循环的。因为与季节性不同，周期性效应通常会受到业务和其他社会经济因素的影响。</li></ul><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/c1a9be94e74d5d6fd5b65191e52e80f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*G5pNK1c8D0SkFX12Czn4Zw.png"/></div></figure><ol class=""><li id="16ec" class="md me it lb b lc ly lg lz lk mf lo mg ls mh lw mu mj mk ml bi translated">每月的房屋销售(左上)显示了每年内强烈的季节性，以及一些大约6-10年的强烈周期性行为。这段时间的数据没有明显的趋势。</li><li id="f6aa" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mu mj mk ml bi translated">美国国债合约(右上)显示了1981年芝加哥市场连续100个交易日的结果。这里没有季节性，但有明显的下降趋势。可能，如果我们有一个更长的序列，我们会看到这种下降趋势实际上是一个长周期的一部分，但当只在100天内观察时，它似乎是一种趋势。</li><li id="73c9" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mu mj mk ml bi translated">澳大利亚季度发电量(左下)显示出强劲的增长趋势，具有很强的季节性。这里没有任何循环行为的证据。</li><li id="bd4c" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mu mj mk ml bi translated">谷歌收盘价(右下角)的每日变化没有趋势、季节性或周期性行为。有些随机波动似乎不太容易预测，也没有强有力的模式来帮助开发预测模型。</li></ol><h1 id="a31f" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">B.让我们编码、绘图和学习</h1><p id="f77c" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><strong class="lb iu">导入库</strong></p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="a6bc" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated"><strong class="lb iu">导入数据</strong></p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/66f1303499e85b5ca40b4151d9dc0523.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*cC9r8CukK0NuWWZ0h4hDeg.png"/></div><p class="nd ne gj gh gi nf ng bd b be z dk translated">前5个条目</p></figure><p id="354a" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">数据是每月的，有两个变量。一个用于海面温度，一个用于海面盐度。</p><h1 id="9302" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak"> 1。时间图</strong></h1><p id="f5b0" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">对于时间序列数据，首先明显的图形是时间图。也就是说，观察值是相对于观察时间绘制的，连续的观察值用直线连接。</p><p id="b1a3" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">在这些图中我们可以看到:</p><ul class=""><li id="16ed" class="md me it lb b lc ly lg lz lk mf lo mg ls mh lw mi mj mk ml bi translated"><strong class="lb iu">奇怪的值</strong>，比如离群值和需要解释的值，因为它们不同于季节性或趋势。</li><li id="5f59" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated"><strong class="lb iu">缺失观察值的时间段</strong>。</li><li id="84a2" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated"><strong class="lb iu">数据的波动</strong>。例如，盐度波动在2008年有所增加。</li><li id="0070" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated"><strong class="lb iu">趋势</strong>、<strong class="lb iu">季节性</strong>和<strong class="lb iu">周期性</strong>行为。例如，温度具有很强的季节性，没有趋势或循环行为。</li></ul><p id="6bb2" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">在缺少观察值的情况下，我们可以用各种方法来填充它们，例如:</p><ul class=""><li id="8b7e" class="md me it lb b lc ly lg lz lk mf lo mg ls mh lw mi mj mk ml bi translated">反向填充</li><li id="742a" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated">线性内插法</li><li id="6db8" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated">二次插值法</li><li id="0d65" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated">最近邻居的平均值</li><li id="cde3" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated">季节性对应平均值</li></ul><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/d5188cda9ed82bb2b76e063222a1a28d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IjwKOx0Q4bChpsDviZXpQw.png"/></div></div></figure><p id="256a" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">月度数据显示每年都有一定的季节性。没有循环行为，也没有趋势。</p><h1 id="e3f8" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak"> 2。季节性地块</strong></h1><p id="9035" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">季节图类似于时间图，只是数据是根据观察数据的单个“季节”绘制的。每个季节的数据是重叠的。</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/452761a61238d6d75341d70f949e6c0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u5a9NtcST3jnv8UcQZtSfg.png"/></div></div></figure><p id="3434" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">在<strong class="lb iu">季节性剧情</strong>中我们可以瞬间看到:</p><ul class=""><li id="f193" class="md me it lb b lc ly lg lz lk mf lo mg ls mh lw mi mj mk ml bi translated">更清楚的季节模式，如果它存在的话。</li><li id="a228" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated">确定模式变化的年份。</li><li id="834e" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated">识别大的跳跃或下降。</li></ul><p id="abc5" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">在<strong class="lb iu">趋势和季节性曲线图</strong>中我们可以看到:</p><ul class=""><li id="aa7e" class="md me it lb b lc ly lg lz lk mf lo mg ls mh lw mi mj mk ml bi translated">趋势和季节性更加明显。例如，虽然我们可以说盐度在以前的地块中有季节性，但现在更明显的是它有季节性。</li><li id="baad" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated">有异常值的年份或月份。</li><li id="67d7" class="md me it lb b lc mm lg mn lk mo lo mp ls mq lw mi mj mk ml bi translated">比较年份或月份更容易。</li></ul><h1 id="ed8e" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak"> 3。季节性子系列图</strong></h1><p id="0498" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">另一种强调季节模式的绘图是将每个季节的数据收集在单独的迷你时间绘图中。</p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nj"><img src="../Images/5f50d979f0ba3e0178d2e071a1ab51d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o7C4Rr0R9_0J-5qKa47VLw.png"/></div></div></figure><p id="c5ab" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">它执行groupby以更清楚地查看季节性月份。</p><h1 id="4643" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated"><strong class="ak"> 4。时间序列组件</strong></h1><p id="0f95" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">时间序列数据可以表现出多种模式，将时间序列分成几个部分通常是有帮助的，每个部分代表一个基本的模式类别。当我们将一个时间序列分解成组件时，我们通常将趋势和周期组合成一个单一的<strong class="lb iu">趋势-周期</strong>组件(有时为了简单起见，称为<strong class="lb iu">趋势</strong>)。因此，我们认为时间序列由三部分组成:趋势周期部分、季节部分和余数部分(包含时间序列中的任何其他部分)。</p><p id="ebaa" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">如果我们假设一个加法分解，那么我们可以写</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/fd8e75f8b392c0c51709b2f740021518.png" data-original-src="https://miro.medium.com/v2/resize:fit:266/format:webp/1*IqyuVmwzKEv9gv3NBFxy3w.png"/></div></figure><p id="af8b" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">，其中yₜ是数据，Sₜ是季节分量，Tₜ是趋势周期分量，Rₜ是余数分量，所有这些都在周期t内。或者，乘法分解可以写成</p><figure class="mw mx my mz gt ju gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/9a35c169423c118028f74b7ae983750b.png" data-original-src="https://miro.medium.com/v2/resize:fit:262/format:webp/1*eKe-EOzj5q37UQFsre8rCQ.png"/></div></figure><p id="2c2a" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">如果季节性波动的幅度或围绕趋势周期的变化不随时间序列的水平而变化，则加法分解是最合适的。换句话说，当趋势看起来更加线性，季节性和趋势成分看起来在一段时间内保持不变时，我们应用<strong class="lb iu">加性</strong>模型。当季节模式的变化或趋势周期的变化似乎与时间序列的水平成比例时，乘法分解更为合适。换句话说，当我们以非线性速率增加(或减少)时，乘法<strong class="lb iu">模型更合适。乘法分解在经济时间序列中很常见。这个分解叫做<strong class="lb iu"> ETS分解</strong>(误差/趋势/季节性)。</strong></p><figure class="mw mx my mz gt ju"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="mw mx my mz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/0c8d75c270660afcd9490cef594747d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IGF1SszmOTrBAkOQOn-AGw.png"/></div></div></figure><p id="dcd4" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">将所有这些数字绘制在一起，可以让我们立即深入了解这些数据。</p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><p id="3ec0" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">我希望这篇文章在你穿越时间和系列的旅程的开始(或者没有)对你有所帮助。</p><p id="494d" class="pw-post-body-paragraph kz la it lb b lc ly le lf lg lz li lj lk ma lm ln lo mb lq lr ls mc lu lv lw im bi translated">继续<a class="ae nu" href="https://medium.com/@dimitris.effrosynidis/time-series-analysis-with-theory-plots-and-code-part-2-c72b447da634" rel="noopener">第2部分</a>学习平稳性、自相关、滞后散点图、简单移动平均线、指数加权移动平均线、双重和三重指数平滑。</p><blockquote class="nv nw nx"><p id="9e02" class="kz la lx lb b lc ly le lf lg lz li lj ny ma lm ln nz mb lq lr oa mc lu lv lw im bi translated">参考:非常感谢精彩的udemy <a class="ae nu" href="https://www.udemy.com/course/python-for-time-series-data-analysis/" rel="noopener ugc nofollow" target="_blank">课程</a>对时间序列分析的介绍！</p></blockquote></div></div>    
</body>
</html>