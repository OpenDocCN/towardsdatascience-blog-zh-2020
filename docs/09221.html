<html>
<head>
<title>How to Collect Data from TikTok (Tutorial)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从抖音收集数据(教程)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-collect-data-from-tiktok-tutorial-ab848b40d191?source=collection_archive---------3-----------------------#2020-07-02">https://towardsdatascience.com/how-to-collect-data-from-tiktok-tutorial-ab848b40d191?source=collection_archive---------3-----------------------#2020-07-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="51a1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何抓取用户发布或喜欢的视频，从种子帐户滚雪球般地收集大量用户列表，以及收集流行视频，所有这些都只需一个简单的 API。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4158edb8f5ef5976b1b4d0956cf96076.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s2IYrQQNEQyPt8WT527FmA.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Kon Karampelas 在<a class="ae ky" href="https://unsplash.com/s/photos/tiktok?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="5cc8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如<a class="ae ky" href="https://www.theinformation.com/articles/tiktoks-u-s-revenues-expected-to-hit-500-million-this-year" rel="noopener ugc nofollow" target="_blank"> The Information </a>所说，抖音已经“像火箭一样在美国和全世界起飞，创造了一种新的移动视频体验，让 YouTube 和脸书争相跟上。”</p><p id="50e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">仅看看 18 岁以上的美国用户，根据康姆斯克提供给《广告周刊》的数据，抖音的独立访客从 1 月份的 2220 万增加到 4 月份的 3920 万。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/82c6f9791793c19fa32381f213017862.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9yefFhnVsZCT4AZdriNuuw.png"/></div></div></figure><p id="c98c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该平台不仅仅是一个很酷的新应用程序:正如最近的事件所表明的那样，其算法传播的视频可能会产生现实世界的后果。举几个突出的例子，</p><ul class=""><li id="9493" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated">韩国流行乐迷利用抖音在塔尔萨的集会上恶作剧，买了票却没有露面</li><li id="d765" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">抖音的青少年在 Trump 的商品网站上组织了“放弃购物车”活动，试图向其他人隐藏库存</li><li id="76a1" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">一些用户鼓励特朗普的反对者点击特朗普的广告，以便<a class="ae ky" href="https://twitter.com/williamlegate/status/1275614944411746304" rel="noopener ugc nofollow" target="_blank">抬高竞选的广告成本</a></li><li id="0e2d" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated">这款应用已经传播了乔·拜登的视频</li></ul><p id="5ea7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简而言之，抖音及其驾驶算法现在具有相当大的现实世界影响力，特别是考虑到一个典型的用户每天花近一个小时在平台上观看视频。考虑到这一点，了解抖音每天向数百万人展示什么是很重要的，为此，我们需要一些数据。</p><p id="86b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面，我包含了如何以各种方式收集抖音数据的代码。我试图保持它的通用性并对大多数用例有帮助，但是你可能需要根据你正在做的事情来调整它。这篇文章的剩余部分讲述了如何做到以下几点:</p><ol class=""><li id="2288" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mk mc md me bi translated">👤收集用户发布的视频</li><li id="2ce0" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mk mc md me bi translated">❤️收集用户喜欢视频</li><li id="0edb" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mk mc md me bi translated">⛄️像滚雪球一样扩大了用户名单</li><li id="ab19" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mk mc md me bi translated">📈收集热门视频</li></ol><p id="b068" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">(给书呆子们一些提示:如果你打算提出几十个以上的请求，我建议设立一个代理。我还没有测试过，但是我在这里演示的 API 应该很容易与您的代理集成。第二，如果您想跟踪流行程度，您将需要在统计数据中添加时间戳。)</p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><h2 id="b0ec" class="mt mu it bd mv mw mx dn my mz na dp nb li nc nd ne lm nf ng nh lq ni nj nk nl bi translated">1.👤收集用户发布的视频</h2><p id="4e33" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">一个好的起点是从给定的用户那里收集视频。我将使用由<a class="ae ky" href="https://github.com/davidteather" rel="noopener ugc nofollow" target="_blank">大卫·蒂瑟</a>开发的<a class="ae ky" href="https://github.com/davidteather/TikTok-Api" rel="noopener ugc nofollow" target="_blank">抖音-Api </a>(运行<code class="fe nr ns nt nu b">pip3 install TikTokApi</code>以获得软件包)。</p><p id="9655" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要从《华盛顿邮报》抖音账户(我最喜欢的账户之一)收集视频，以下是你在 Python 中需要做的所有事情:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="7302" class="mt mu it nu b gy nz oa l ob oc">from TikTokApi import TikTokApi<br/>api = TikTokApi()</span><span id="67ad" class="mt mu it nu b gy od oa l ob oc">n_videos = 100<br/>username = 'washingtonpost'</span><span id="7f03" class="mt mu it nu b gy od oa l ob oc">user_videos = api.byUsername(username, count=n_videos)</span></pre><p id="c050" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nr ns nt nu b">user_videos</code>对象现在是 100 个视频字典的列表(这里的示例字典是<a class="ae ky" href="https://gist.github.com/davidteather/7c30780bbc30772ba11ec9e0b909e99d" rel="noopener ugc nofollow" target="_blank"/>)。您可能最感兴趣的只是一些统计数据，您可以使用下面的函数从完整的字典中提取这些数据:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="a9a2" class="mt mu it nu b gy nz oa l ob oc">def simple_dict(tiktok_dict):<br/>  to_return = {}<br/>  to_return['user_name'] = tiktok_dict['author']['uniqueId']<br/>  to_return['user_id'] = tiktok_dict['author']['id']<br/>  to_return['video_id'] = tiktok_dict['id']<br/>  to_return['video_desc'] = tiktok_dict['desc']<br/>  to_return['video_time'] = tiktok_dict['createTime']<br/>  to_return['video_length'] = tiktok_dict['video']['duration']<br/>  to_return['video_link'] = 'https://www.tiktok.com/@{}/video/{}?lang=en'.format(to_return['user_name'], to_return['video_id'])</span><span id="7b98" class="mt mu it nu b gy od oa l ob oc">  to_return['n_likes'] = tiktok_dict['stats']['diggCount']<br/>  to_return['n_shares'] = tiktok_dict['stats']['shareCount']<br/>  to_return['n_comments'] = tiktok_dict['stats']['commentCount']<br/>  to_return['n_plays'] = tiktok_dict['stats']['playCount']</span><span id="0f63" class="mt mu it nu b gy od oa l ob oc">  return to_return</span></pre><p id="66a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们可以从 API 输出的<code class="fe nr ns nt nu b">user_videos</code>列表转到一个漂亮、干净的表格(即 Pandas 数据框)，只有三行代码:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="4741" class="mt mu it nu b gy nz oa l ob oc">user_videos = [simple_dict(v) for v in user_videos]<br/>user_videos_df = pd.DataFrame(user_videos)<br/>user_videos_df.to_csv('{}_videos.csv'.format(username),index=False)</span></pre><p id="e477" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面是输出文件的样子(为了便于阅读，我删除了一些行和列):</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><h2 id="a930" class="mt mu it bd mv mw mx dn my mz na dp nb li nc nd ne lm nf ng nh lq ni nj nk nl bi translated">2.❤️收集用户喜欢视频</h2><p id="3d35" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">在这种情况下，您可能对给定用户“喜欢”的视频感兴趣。这很容易收集。来看看<a class="ae ky" href="https://www.tiktok.com/@tiktok" rel="noopener ugc nofollow" target="_blank">抖音官方账号</a>最近都喜欢哪些视频:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="9bba" class="mt mu it nu b gy nz oa l ob oc">username = 'tiktok'<br/>n_videos = 10</span><span id="51cf" class="mt mu it nu b gy od oa l ob oc">liked_videos = api.userLikedbyUsername(username, count=n_videos)<br/>liked_videos = [simple_dict(v) for v in liked_videos]</span><span id="445e" class="mt mu it nu b gy od oa l ob oc">liked_videos_df = pd.DataFrame(liked_videos)<br/>liked_videos_df.to_csv('{}_liked_videos.csv'.format(username), index=False)</span></pre><p id="925c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输出文件看起来与上次的相似，因为它也保存了一个视频列表:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><h2 id="d3a3" class="mt mu it bd mv mw mx dn my mz na dp nb li nc nd ne lm nf ng nh lq ni nj nk nl bi translated">3.⛄️像滚雪球一样扩大了用户名单</h2><p id="aecd" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">假设您想要创建一个大型用户列表，从中您可以收集他们发布的视频和他们喜欢的视频。你可以使用<a class="ae ky" href="https://en.wikipedia.org/wiki/List_of_most-followed_TikTok_accounts" rel="noopener ugc nofollow" target="_blank"> 50 个最受关注的抖音账户</a>，但 50 个账户可能无法产生足够广泛的样本。</p><p id="d1fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一种方法是使用建议的用户从一个用户滚雪球式地增加用户列表。首先，我们将为四个不同的帐户执行此操作:</p><ul class=""><li id="baec" class="lw lx it lb b lc ld lf lg li ly lm lz lq ma lu mb mc md me bi translated"><code class="fe nr ns nt nu b">tiktok</code>是 app 的官方账号</li><li id="9cb6" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><code class="fe nr ns nt nu b">washingtonpost</code>是我最喜欢的账户之一</li><li id="c3e3" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><code class="fe nr ns nt nu b">charlidamelio</code>是抖音最受欢迎的账户</li><li id="f288" class="lw lx it lb b lc mf lf mg li mh lm mi lq mj lu mb mc md me bi translated"><code class="fe nr ns nt nu b">chunkysdead</code>在 app 上领导一个自称“邪教”的人</li></ul><p id="b954" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是我使用的代码:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="b3eb" class="mt mu it nu b gy nz oa l ob oc">seed_users = ['tiktok', 'washingtonpost', 'charlidamelio', 'chunkysdead']</span><span id="31f4" class="mt mu it nu b gy od oa l ob oc">seed_ids = [api.getUser(user_name)['userInfo']['user']['id'] for user_name in seed_users]</span><span id="020f" class="mt mu it nu b gy od oa l ob oc">suggested = [api.getSuggestedUsersbyID(count=20, startingId=s_id) for s_id in seed_ids]</span></pre><p id="8117" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是推荐的用户:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="4634" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">值得注意的是，<code class="fe nr ns nt nu b">washingtonpost</code>和<code class="fe nr ns nt nu b">chunkysdead</code>的推荐列表是相同的，其他推荐之间有很多重叠，所以这种方法可能无法满足您的需求。</p><p id="a1c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">创建大型用户列表的另一种方法是使用<code class="fe nr ns nt nu b">getSuggestedUsersbyIDCrawler</code>来保持雪球滚动。要使用<code class="fe nr ns nt nu b">tiktok</code>作为种子帐户创建 100 个建议帐户的列表，您只需要以下代码:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="936f" class="mt mu it nu b gy nz oa l ob oc">tiktok_id = api.getUser('tiktok')['userInfo']['user']['id']</span><span id="4b00" class="mt mu it nu b gy od oa l ob oc">suggested_100 = api.getSuggestedUsersbyIDCrawler(count=100, startingId=tiktok_id)</span></pre><p id="a639" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将创建一个包含各种不同名人账户的列表，以下是一些:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="ea0c" class="mt mu it nu b gy nz oa l ob oc">@lizzo (lizzo, 8900000 fans)<br/>@wizkhalifa (Wiz Khalifa, 1800000 fans)<br/>@capuchina114 (Capuchina❗️👸🏼, 32600 fans)<br/>@silviastephaniev (Silvia Stephanie💓, 27600 fans)<br/>@theweeknd (The Weeknd, 1400000 fans)<br/>@theawesometalents (Music videos, 33400 fans)<br/>...</span></pre><p id="2de7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从我的观察来看，<code class="fe nr ns nt nu b">getSuggestedUsersbyIDCrawler</code>方法开始扩展，寻找更小、更小众的账户，这些账户拥有数万名粉丝，而不是数十万或数百万。如果您想要一个有代表性的数据集，这是一个好消息。</p><blockquote class="og"><p id="c550" class="oh oi it bd oj ok ol om on oo op lu dk translated">如果您想从抖音收集广泛的数据样本，我建议从推荐的用户爬虫开始。</p></blockquote><h2 id="9780" class="mt mu it bd mv mw oq dn my mz or dp nb li os nd ne lm ot ng nh lq ou nj nk nl bi translated">4.📈收集热门视频</h2><p id="8833" class="pw-post-body-paragraph kz la it lb b lc nm ju le lf nn jx lh li no lk ll lm np lo lp lq nq ls lt lu im bi translated">最后，也许你只是想收集流行视频进行简单的内容分析，或者只是为了跟上潮流🙂。API 使这变得非常简单，如下所示:</p><pre class="kj kk kl km gt nv nu nw nx aw ny bi"><span id="ed10" class="mt mu it nu b gy nz oa l ob oc">n_trending = 20</span><span id="f2d4" class="mt mu it nu b gy od oa l ob oc">trending_videos = api.trending(count=n_trending)<br/>trending_videos = [simple_dict(v) for v in trending_videos]<br/>trending_videos_df = pd.DataFrame(trending_videos)<br/>trending_videos_df.to_csv('trending.csv',index=False)</span></pre><p id="f62a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是周四下午(2020 年 7 月 2 日)趋势视频的输出文件:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="648d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程到此结束，感谢您的阅读！这里有一个文件，里面有我使用的所有代码。</p></div></div>    
</body>
</html>