<html>
<head>
<title>Solving categorical feature selection with Kydavra ChiSquaredSelector</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Kydavra ChiSquaredSelector 解决分类特征选择问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/solving-categorical-feature-selection-with-kydavra-chisquaredselector-1aa19aa1fe4d?source=collection_archive---------49-----------------------#2020-09-09">https://towardsdatascience.com/solving-categorical-feature-selection-with-kydavra-chisquaredselector-1aa19aa1fe4d?source=collection_archive---------49-----------------------#2020-09-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/0ea78c2bac798eefd8fec261cfdbdff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BhBHoUrliPRFcypqhDDzFw.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">由 Sigmoid 创建的图像</p></figure><p id="ffa9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">所以我们在之前关于 Kydavra 库的文章中是怎么说的，特征选择是机器学习模型开发中非常重要的一部分。不幸的是，获得理想模型的方法并不只有一种，主要是因为数据几乎每次都有不同的形式，但这也意味着不同的方法。在本文中，我将分享一种使用 Sigmoid 创建的 Kydavra ChiSquaredSelector 选择分类特征的方法。</p><h2 id="6ff5" class="ld le it bd lf lg lh dn li lj lk dp ll kq lm ln lo ku lp lq lr ky ls lt lu lv bi translated">使用 Kydavra 图书馆的 ChiSquaredSelector。</h2><p id="faf6" class="pw-post-body-paragraph kf kg it kh b ki lw kk kl km lx ko kp kq ly ks kt ku lz kw kx ky ma la lb lc im bi translated">和往常一样，对于那些主要是为了解决问题的人来说，他们需要的是命令和代码:</p><p id="aa0d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">要安装 kydavra，只需在终端中写入以下命令:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="2a9f" class="ld le it mg b gy mk ml l mm mn">pip install kydavra</span></pre><p id="5ea5" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在，您可以导入选择器并将其应用于数据集，如下所示:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="c649" class="ld le it mg b gy mk ml l mm mn">from kydavra import ChiSquaredSelector</span><span id="10ee" class="ld le it mg b gy mo ml l mm mn">selector = ChiSquaredSelector()</span><span id="fe87" class="ld le it mg b gy mo ml l mm mn">new_columns = selector.select(df, ‘target’)</span></pre><p id="6083" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">为了测试它，让我们对<a class="ae mp" href="https://www.kaggle.com/ronitf/heart-disease-uci" rel="noopener ugc nofollow" target="_blank">心脏病 UCI 数据集</a>稍加修改后应用它。我们将删除数字列，而不是保留所有特征。因此，我们的新数据集将只包含以下要素:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="f726" class="ld le it mg b gy mk ml l mm mn">sex, cp, fbs, restecg, exang, slope, ca and thal</span></pre><p id="4d22" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我选择的算法是 SVC，在选择特征之前，它的 cross_val_score 是:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="b928" class="ld le it mg b gy mk ml l mm mn">0.6691582491582491</span></pre><p id="a743" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">但是在应用 ChiSquaredSelector 之后，cross_val_score 变成:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="b504" class="ld le it mg b gy mk ml l mm mn">0.8452525252525251</span></pre><p id="8751" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">保持下一个特征:<strong class="kh iu">性别，cp，exang，斜率，ca，thal。</strong></p><h2 id="0c45" class="ld le it bd lf lg lh dn li lj lk dp ll kq lm ln lo ku lp lq lr ky ls lt lu lv bi translated">那么它是如何工作的呢？</h2><p id="7db9" class="pw-post-body-paragraph kf kg it kh b ki lw kk kl km lx ko kp kq ly ks kt ku lz kw kx ky ma la lb lc im bi translated">所以，和其他选择者一样，ChiSquaredSelector 的灵感来自统计学，当然是来自 Chi2-test。作为 p 值，Chi2 检验用于证明或反驳零假设。只是提醒一下:</p><p id="0704" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu">零假设</strong>是对两个被测现象之间没有关系的一般性陈述(或者也称特征)。</p><p id="db5a" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">所以为了发现特征是否相关，我们需要看看我们是否能拒绝零假设。从技术上说，ChiSquaredSelector 采用计算 chi2-s 时获得的 p 值。只是概括一下。</p><p id="fce6" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated"><strong class="kh iu"> P 值</strong> —是给定统计模型的概率值，如果零假设为真，一组统计观测值在数量级上大于或等于观测结果。</p><p id="7789" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">因此，通过设置显著性水平(ChiSquaredSelector 的参数),我们可以反复消除具有最高 p 值的要素。</p><h2 id="796a" class="ld le it bd lf lg lh dn li lj lk dp ll kq lm ln lo ku lp lq lr ky ls lt lu lv bi translated">奖金！</h2><p id="381b" class="pw-post-body-paragraph kf kg it kh b ki lw kk kl km lx ko kp kq ly ks kt ku lz kw kx ky ma la lb lc im bi translated">如果你感兴趣的是为什么选择器选择了一些特性而忽略了另一些，你可以画出选择特性的过程。ChiSquaredSelector 有两个绘图函数，一个用于 Chi2，另一个用于 p 值:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="147b" class="ld le it mg b gy mk ml l mm mn">selector .plot_chi2()</span></pre><figure class="mb mc md me gt ju gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/cc83049ef8f21dcfa98554aaf97384c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/0*TQeYxTzIK3PwRGec"/></div></figure><p id="dafe" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">对于 p 值:</p><pre class="mb mc md me gt mf mg mh mi aw mj bi"><span id="87ab" class="ld le it mg b gy mk ml l mm mn">selector.plot_p_value()</span></pre><figure class="mb mc md me gt ju gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/adb36d03a467385fb0daaa9627ef68d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/0*7HTaYlIC3k7xwxSL"/></div></figure><p id="5447" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">每个函数都有以下参数:</p><ul class=""><li id="482e" class="mr ms it kh b ki kj km kn kq mt ku mu ky mv lc mw mx my mz bi translated"><strong class="kh iu">标题</strong> —剧情标题。</li><li id="eb64" class="mr ms it kh b ki na km nb kq nc ku nd ky ne lc mw mx my mz bi translated"><strong class="kh iu">保存</strong> —布尔值，True 表示将保存剧情，False 表示不保存。默认情况下，它被设置为 false。</li><li id="513b" class="mr ms it kh b ki na km nb kq nc ku nd ky ne lc mw mx my mz bi translated"><strong class="kh iu">文件路径</strong> —新创建的图的文件路径。</li></ul><p id="f9ca" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果您想更深入地了解零假设、Chi2 检验和 p 值等概念，或者这个特征选择是如何工作的，下面有一个链接列表。</p><figure class="mb mc md me gt ju gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/2d9ca715050b0f2dc8ab260e90fd7fc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/1*jwsKMABpWqdNfqATXVJghA.gif"/></div></figure><p id="4a2e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果你想深入了解卡方如何工作，我强烈推荐文章末尾的链接。如果你尝试过 kydavra，我邀请你留下一些反馈，并分享你使用它的经验。</p><p id="1697" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">西格蒙德用❤做的。</p><p id="e4e1" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">有用的链接:</p><ul class=""><li id="9f87" class="mr ms it kh b ki kj km kn kq mt ku mu ky mv lc mw mx my mz bi translated">https://en.wikipedia.org/wiki/Null_hypothesis<a class="ae mp" href="https://en.wikipedia.org/wiki/Null_hypothesis" rel="noopener ugc nofollow" target="_blank"/></li><li id="a09a" class="mr ms it kh b ki na km nb kq nc ku nd ky ne lc mw mx my mz bi translated">【https://en.wikipedia.org/wiki/P-value T4】</li><li id="a720" class="mr ms it kh b ki na km nb kq nc ku nd ky ne lc mw mx my mz bi translated"><a class="ae mp" href="https://en.wikipedia.org/wiki/Chi-squared_test" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Chi-squared_test</a></li></ul></div></div>    
</body>
</html>