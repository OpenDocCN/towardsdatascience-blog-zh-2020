<html>
<head>
<title>Interactive maps with Python, Pandas and Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python、Pandas 和 Plotly 的交互式地图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/interactive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e?source=collection_archive---------12-----------------------#2020-01-23">https://towardsdatascience.com/interactive-maps-with-python-pandas-and-plotly-following-bloggers-through-sydney-c24d6f30867e?source=collection_archive---------12-----------------------#2020-01-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="12f5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">跟随博主在悉尼的足迹</h2></div><p id="c7f5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章和其他几篇文章中，我将探索 Python 和 Plotly，把一些不同的看起来很棒的图表放在一起。Plotly.js 是一个基于 Javascript 的可视化库，由一家名为 Plotly 的公司构建，他们也为各种语言提供了包装器，包括一个名为… plotly 的 python 包装器。</p><p id="8516" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">尽管它们的命名模式不尽如人意，但它们确实构建了一个非常强大、但仍非常可定制的库，我很想探索它能做什么。</p><blockquote class="le lf lg"><p id="70dd" class="ki kj lh kk b kl km ju kn ko kp jx kq li ks kt ku lj kw kx ky lk la lb lc ld im bi translated"><em class="it">你可以跟随我使用的源代码和数据，从这个</em> <a class="ae ll" href="https://gitlab.com/jphwang/online_articles" rel="noopener ugc nofollow" target="_blank"> <em class="it"> GitLab 库</em> </a> <em class="it">。</em></p></blockquote><h1 id="7c94" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">位置，位置，位置</h1><p id="9329" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">经常看文章，像美食博客，或者旅游博客，想:<em class="lh">这些地方到底在哪里</em>？</p><p id="958c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在去年的圣诞假期，我有机会和我的伴侣一起回到悉尼，她从未去过澳大利亚，更不用说悉尼了。我来自悉尼，我想帮助她看到悉尼的“最好”，并像我们许多人一样欣赏它。</p><p id="d29b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以我读了一些旅游博客，看看第一次来的游客喜欢悉尼的什么。我突然意识到这样做会让游客很容易搞不清东西在哪里，哪些景点值得一看。计划每一天的日程将是一件痛苦的事，因为永远不清楚一个地方与另一个地方相比有多远。</p><p id="cee6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我的解决方案是绘制一张地图，心中有三个目标:</p><ul class=""><li id="4c31" class="mj mk it kk b kl km ko kp kr ml kv mm kz mn ld mo mp mq mr bi translated">第一，建立一个互动地图，包括每一个标记的位置。</li><li id="4618" class="mj mk it kk b kl ms ko mt kr mu kv mv kz mw ld mo mp mq mr bi translated">第二，地图会有不同的标记来表示位置的类型。无论它是一个地标，一个位置(像一个郊区)，还是一个交通枢纽。</li><li id="5b0c" class="mj mk it kk b kl ms ko mt kr mu kv mv kz mw ld mo mp mq mr bi translated">第三，显示有多少博客提到了这个位置，这样我们就可以筛选出更“重要”的。</li></ul><p id="3d11" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Plotly 有我定制的可视化库。我已经看到它包含了一个惊人的地图框集成，这是我以前没有尝试过的。所以我想我会一石二鸟。</p><h1 id="72ff" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">在开始之前</h1><p id="556d" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">我假设您熟悉 python。即使你相对较新，这个教程也不应该太难。</p><p id="cba9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你需要用一个简单的<code class="fe mx my mz na b">pip install [PACKAGE_NAME]</code>将<code class="fe mx my mz na b">pandas</code>和<code class="fe mx my mz na b">plotly</code>安装到你的虚拟环境中。</p><p id="4330" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你没有地图框令牌，<a class="ae ll" href="https://www.mapbox.com" rel="noopener ugc nofollow" target="_blank">给他们设置一个</a>——我们会需要它。他们提供了一个非常自由的帐户，有非常合理的访问限制。</p><p id="d0a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将密钥保存在一个文件中，并使用以下命令加载它:</p><pre class="nb nc nd ne gt nf na ng nh aw ni bi"><span id="9dbd" class="nj ln it na b gy nk nl l nm nn">with open('mapbox_tkn.txt', 'r') as f: <br/>    mapbox_key = f.read().strip()</span></pre><h1 id="7960" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">地图很有趣</h1><h2 id="de88" class="nj ln it bd lo no np dn ls nq nr dp lw kr ns nt ly kv nu nv ma kz nw nx mc ny bi translated">介绍</h2><p id="cf7b" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">尽管使用了 NLP 工具，整理这些信息还是有点困难，因为人们坚持在博客上拼错名字，或者只是用不同的名字称呼事物。(‘海港大桥’还是‘悉尼港湾大桥’？维多利亚女王大厦还是 QVB？)</p><p id="1757" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本教程侧重于情节，而不是刮，所以我会提供<code class="fe mx my mz na b">loc_data.csv</code>(所有数据和脚本可在我的<a class="ae ll" href="https://gitlab.com/jphwang/online_articles" rel="noopener ugc nofollow" target="_blank"> repo 这里</a>)。该文件包含我们要查看的所有独特位置的数据。每个博客的数据都包含在名为<code class="fe mx my mz na b">blog_file[N].csv</code>的<code class="fe mx my mz na b">data_csvs</code>子目录中。</p><p id="4b90" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将 csv 文件加载到数据帧中，并查看其内容:</p><pre class="nb nc nd ne gt nf na ng nh aw ni bi"><span id="f899" class="nj ln it na b gy nk nl l nm nn">loc_df = pd.read_csv('mapping_blogs/loc_data.csv', index_col=0) print(loc_df.head())</span></pre><p id="504c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您将看到有五列:索引、位置、纬度、经度和类型。</p><p id="9f85" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它们是索引号、位置名称字符串、以小数表示的纬度和经度以及位置类型。</p><h2 id="ed9f" class="nj ln it bd lo no np dn ls nq nr dp lw kr ns nt ly kv nu nv ma kz nw nx mc ny bi translated">数据清理</h2><p id="369c" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">第一次检查时,“类型”列看起来是绝对的。一列中的所有唯一值都可以通过<code class="fe mx my mz na b">loc_df.type.unique()</code>进行整理。它显示的是<code class="fe mx my mz na b">['Area', nan, 'Food/Drinks', 'Transport', 'Lodging']</code>。的确如此！我记得 NaN 值是那些我无法归类的值。先给它们起个名字，<code class="fe mx my mz na b">Misc</code>为杂。</p><p id="af6c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最简单的方法是使用 pandas 的<code class="fe mx my mz na b">.fillna</code>方法和<code class="fe mx my mz na b">inplace</code>参数。<code class="fe mx my mz na b">loc_df.type.fillna('Misc', inplace=True)</code>将完成此操作，并填入任何 NaN 值。</p><h2 id="89e7" class="nj ln it bd lo no np dn ls nq nr dp lw kr ns nt ly kv nu nv ma kz nw nx mc ny bi translated">我们的第一张地图</h2><p id="4b36" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">到这个阶段，我们实际上已经有足够的信息来设计一些东西了！通过 plotly 的魔力，我们只需要为我们的第一张地图添加以下代码行:</p><pre class="nb nc nd ne gt nf na ng nh aw ni bi"><span id="3671" class="nj ln it na b gy nk nl l nm nn">import plotly.express as px <br/>fig = px.scatter_mapbox(loc_df, lat="lat", lon="lon", color="type")<br/>fig.update_layout(mapbox_style="open-street-map") <br/>fig.show()</span></pre><figure class="nb nc nd ne gt oa gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi nz"><img src="../Images/321a5b80393be013f6698fef491ac3e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uQ_sfp2RUfiAoWs9x-teSQ.png"/></div></div><p class="oh oi gj gh gi oj ok bd b be z dk translated">我们的第一张地图！</p></figure><p id="3791" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">类似这样的东西应该已经在你的浏览器上(或者在你的 Jupyter 笔记本上)打开了。是不是很酷？仅仅用了三行代码就画出了这个。Plotly Express 可以更快地创建情节。地图是交互式的，因此可以通过单击图例来缩放、平移、查看标记和隔离每个地块。</p><p id="7e94" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在这里做的是将整个数据帧传递给<code class="fe mx my mz na b">.scatter_mapbox</code>函数，并指定数据所在的列。然后我们使用<code class="fe mx my mz na b">update_layout</code>指定<code class="fe mx my mz na b">open-street-map</code>样式(本指南中的<a class="ae ll" href="https://plot.ly/python/mapbox-layers/" rel="noopener ugc nofollow" target="_blank">列出了可用的样式)。</a></p><p id="3d7a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您想知道我们是如何将之前加载的<code class="fe mx my mz na b">mapbox_key</code>变量传递给 Plotly 的，答案是我们没有。使用<code class="fe mx my mz na b">open-street-map</code>风格意味着不需要地图框键，开放街道地图是一个免费的合作项目。</p><p id="9387" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们知道了如何制作一个基本的地图，让我们进入杂草中，仔细观察数据，并添加一些附加功能。</p><h1 id="f35f" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">严肃的映射</h1><h2 id="c7ce" class="nj ln it bd lo no np dn ls nq nr dp lw kr ns nt ly kv nu nv ma kz nw nx mc ny bi translated">鼠标悬停</h2><p id="e936" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">在玩地图的时候，你可能注意到了鼠标悬停工具提示。它们很棒，但不是特别有用。所以让我们解决这个问题。我们想看看这个地方的名字，不太在乎确切的坐标。让我们指定参数<code class="fe mx my mz na b">hover_name='location'</code>，而不是<code class="fe mx my mz na b">hover_data=['type']</code>。</p><p id="b670" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我还认为彩色地图有点分散了叠加的注意力，所以我把地图框样式改成了<code class="fe mx my mz na b">light</code>，现在我们需要提供地图框键。最后，当我对悉尼市区最感兴趣的时候，我认为地图一开始就太高了。因此，让我们通过指定<code class="fe mx my mz na b">zoom</code>参数来更改默认的映射区域。代码和生成的地图如下:</p><pre class="nb nc nd ne gt nf na ng nh aw ni bi"><span id="6f01" class="nj ln it na b gy nk nl l nm nn">fig = px.scatter_mapbox(loc_df, lat="lat", lon="lon", color="type", hover_name='location', hover_data=['type'], zoom=12) <br/># Now using Mapbox <br/>fig.update_layout(mapbox_style="light", mapbox_accesstoken=mapbox_key) <br/>fig.show()</span></pre><figure class="nb nc nd ne gt oa gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi nz"><img src="../Images/bafe48e006b5c7ce25cf3abd2826573f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cPVTUFfL525mys55oZ-85A.png"/></div></div><p class="oh oi gj gh gi oj ok bd b be z dk translated">鼠标悬停弹出窗口很棒，但是(还)不太能提供信息</p></figure><p id="9060" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">好吧，这是一个巨大的进步。现在我们已经实现了三个目标中的两个。对于最后一个，我们将不得不编译位置的计数。所以，回到数据框架。</p><h2 id="7202" class="nj ln it bd lo no np dn ls nq nr dp lw kr ns nt ly kv nu nv ma kz nw nx mc ny bi translated">寻找最受欢迎的目的地</h2><p id="43de" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">我想看看哪些目的地或地点最受博客作者的欢迎。因此，在本节中，我们将统计每个位置被包含的次数。</p><p id="9acf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第一步是统计主列表中的哪些位置在每个博客中，并对结果数据帧进行排序:</p><pre class="nb nc nd ne gt nf na ng nh aw ni bi"><span id="450b" class="nj ln it na b gy nk nl l nm nn">data_dir = 'data_csvs' <br/>data_files = [i for i in os.listdir(data_dir) if i.endswith('.csv')] </span><span id="a15c" class="nj ln it na b gy ol nl l nm nn">for csv_file in data_files: <br/>    with open(os.path.join(data_dir, csv_file), 'r') as f: <br/>        locs_txt = f.read() <br/>    temp_locs = locs_txt.split('\n') <br/>    locs_bool = [loc_in_list(i, temp_locs) for i in list(loc_df['location'])] <br/>    loc_df = loc_df.assign(**{csv_file: locs_bool}) </span><span id="113c" class="nj ln it na b gy ol nl l nm nn">loc_df = loc_df.assign(counts=loc_df[data_files].sum(axis=1))<br/>loc_df.sort_values(by='counts', inplace=True, ascending=False)</span></pre><p id="82f9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mx my mz na b">loc_in_list</code>函数是我写的用来比较位置名称和列表的东西，考虑了包括/省略单词‘the’和各种撇号/引号的各种组合。</p><pre class="nb nc nd ne gt nf na ng nh aw ni bi"><span id="7bc0" class="nj ln it na b gy nk nl l nm nn">def loc_in_list(loc, loc_list): </span><span id="3699" class="nj ln it na b gy ol nl l nm nn">loc_list = list(set([i.strip().lower() for i in loc_list if len(i.strip().lower()) &gt; 0])) <br/>loc_list += ['the ' + i for i in loc_list if i[:4] != 'the '] <br/>loc_list += [i[4:] for i in loc_list if i[:4] == 'the '] </span><span id="0fc4" class="nj ln it na b gy ol nl l nm nn">for t_char in ["'", "-"]: <br/>    loc_list += [i.replace(t_char, "") for i in loc_list if t_char in i] <br/>    loc_list += [i.replace(t_char, " ") for i in loc_list if t_char in i] </span><span id="7c93" class="nj ln it na b gy ol nl l nm nn">loc = loc.replace("'", "'") <br/>loc = loc.strip().lower() </span><span id="d505" class="nj ln it na b gy ol nl l nm nn">loc_in_list_bool = (loc in loc_list) or (loc.replace("'", "") in loc_list) </span><span id="05da" class="nj ln it na b gy ol nl l nm nn">return loc_in_list_bool</span><span id="cee2" class="nj ln it na b gy ol nl l nm nn">print(loc_df.head())</span></pre><p id="d594" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">再次查看数据帧，看起来我们得到了一个按出现次数排序的数据帧。《海港大桥》在每个榜单上都出现了 6 个！</p><p id="9b82" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以添加一个<code class="fe mx my mz na b">sizing</code>参数(和<code class="fe mx my mz na b">max_size</code>来控制符号大小)，并再次绘制地图:</p><pre class="nb nc nd ne gt nf na ng nh aw ni bi"><span id="c331" class="nj ln it na b gy nk nl l nm nn">fig = px.scatter_mapbox( loc_df, lat="lat", lon="lon", color="type", size="counts", hover_name='location', hover_data=['type'], zoom=12, size_max=15) <br/>fig.update_layout(mapbox_style="light", mapbox_accesstoken=mapbox_key) <br/>fig.show()</span></pre><figure class="nb nc nd ne gt oa gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi nz"><img src="../Images/9cd2d139a2183453d86572e62754571a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SDGYPabtBh1Ncrt2.png"/></div></div></figure><h1 id="dc06" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">重叠位置</h1><p id="c0a2" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">你们当中眼尖的人可能已经注意到了这些重叠的位置。</p><figure class="nb nc nd ne gt oa gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi om"><img src="../Images/ba0db6baa2f20ffbb3aad7a5cc740322.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uyDd_xK_7rYnCzg6.png"/></div></div></figure><p id="00a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于像这样的地方，我将查看重叠的位置，只查看计数较高的名称的位置。</p><p id="2700" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我简单地遍历每一行，寻找距离小于阈值的行:</p><pre class="nb nc nd ne gt nf na ng nh aw ni bi"><span id="4f67" class="nj ln it na b gy nk nl l nm nn">loc_df = loc_df.assign(dup_row=0) <br/>loc_thresh = 0.0001 </span><span id="b1c9" class="nj ln it na b gy ol nl l nm nn">for i in range(len(loc_df)): <br/>    src_ind = loc_df.iloc[i].name <br/>    for j in range(i+1, len(loc_df)): <br/>        tgt_ind = loc_df.iloc[j].name <br/>        lat_dist = loc_df.loc[src_ind]['lat'] - loc_df.loc[tgt_ind]['lat'] <br/>        lon_dist = loc_df.loc[src_ind]['lon'] - loc_df.loc[tgt_ind]['lon'] <br/>        tot_dist = (lat_dist ** 2 + lon_dist ** 2) ** 0.5 <br/>        if tot_dist &lt; loc_thresh: <br/>            print(f'Found duplicate item "{loc_df.loc[tgt_ind]["location"]}", index {tgt_ind}') <br/>            for csv_file in data_files: <br/>                if loc_df.loc[tgt_ind, csv_file]: <br/>                    loc_df.loc[src_ind, csv_file] = True <br/>                if loc_df.loc[tgt_ind, 'location'] not in loc_df.loc[src_ind, 'location']: <br/>                    loc_df.loc[src_ind, 'location'] = loc_df.loc[src_ind, 'location'] + ' | ' + loc_df.loc[tgt_ind, 'location'] <br/>                    loc_df.loc[tgt_ind, 'dup_row'] = 1 </span><span id="0247" class="nj ln it na b gy ol nl l nm nn">loc_df = loc_df[loc_df.dup_row == 0] <br/>loc_df = loc_df.assign(counts=loc_df[data_files].sum(axis=1))<br/>loc_df.sort_values(by='counts', inplace=True, ascending=False)</span></pre><p id="108e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在可以绘制数据了！我还关闭了显示栏和禁用编辑，这是我在所有绘图中使用的。</p><pre class="nb nc nd ne gt nf na ng nh aw ni bi"><span id="f352" class="nj ln it na b gy nk nl l nm nn">fig = px.scatter_mapbox(loc_df, lat="lat", lon="lon", color="type", size="counts", hover_name='location', hover_data=['type'], zoom=12, size_max=15) <br/>fig.update_layout(mapbox_style="light", mapbox_accesstoken=mapbox_key) <br/>fig.show( config={ 'displayModeBar': False, 'editable': False, }, )</span></pre><figure class="nb nc nd ne gt oa gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi nz"><img src="../Images/bbdff6c79a261943d9d8b9044df75698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Adg-l4iqxGk2_oIW.png"/></div></div></figure><p id="58b0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">看那个——桥上的点已经被连接起来，名字彼此相加，计数增加了！</p><p id="fc27" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我们有一个交互式的，可按类别过滤的工具提示！</p><figure class="nb nc nd ne gt oa gh gi paragraph-image"><div role="button" tabindex="0" class="ob oc di od bf oe"><div class="gh gi on"><img src="../Images/50374c214c603465e053fc3855674b7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9RIQxrT-6M3bR8XblVNbXw.png"/></div></div></figure><p id="92b1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就完成了这篇关于在地图上绘制散点图的文章。希望你对此感兴趣。</p><p id="7ab2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你喜欢这个，比如说👋/在<a class="ae ll" href="https://twitter.com/_jphwang" rel="noopener ugc nofollow" target="_blank"> twitter </a>上关注，或关注更新。</p></div></div>    
</body>
</html>