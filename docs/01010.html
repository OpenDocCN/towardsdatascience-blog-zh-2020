<html>
<head>
<title>Machine Learning Fails When It Comes to Embedded System. Here’s Why</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习在嵌入式系统上是失败的。原因如下</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-fails-when-it-comes-to-embedded-system-9ce6def9ba75?source=collection_archive---------6-----------------------#2020-01-29">https://towardsdatascience.com/machine-learning-fails-when-it-comes-to-embedded-system-9ce6def9ba75?source=collection_archive---------6-----------------------#2020-01-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="ebc2" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">思考不同</h2><div class=""/><div class=""><h2 id="e730" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">深入了解嵌入式世界以及ML行业目前还不能解决的问题</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/c284eccbae7f3b67772fa2891b0c87dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ChA81UKNwAGJw2_D"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">丹尼尔·威德罗在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="e683" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi mb translated">今天，中文学习达到了顶峰，最终被广泛使用。你可以在机场看到人脸识别系统，在脸书看到个性化的广告。</p><p id="8ed4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">虽然，当我们谈到<strong class="lh ja">将ML与嵌入式设备</strong>相结合时，仍然有<strong class="lh ja">相当大的差距</strong>。</p><h1 id="e164" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">1.我们不明白嵌入式世界是什么</h1><p id="177f" class="pw-post-body-paragraph lf lg iq lh b li nc ka lk ll nd kd ln lo ne lq lr ls nf lu lv lw ng ly lz ma ij bi translated">使用ML，我们曾经拥有巨大的计算能力。</p><blockquote class="nh ni nj"><p id="50a6" class="lf lg nk lh b li lj ka lk ll lm kd ln nl lp lq lr nm lt lu lv nn lx ly lz ma ij bi translated">AlexNet需要727 MegaFlops和235Mb内存来处理一个227x227px的小图像。例如，谷歌Nexus S上的ARM Cortex-A8每秒可以产生66兆次浮点运算。所以，你要等~11秒才能推断。太多了！</p><p id="d49c" class="lf lg nk lh b li lj ka lk ll lm kd ln nl lp lq lr nm lt lu lv nn lx ly lz ma ij bi translated"><em class="iq"> *FLOP —浮点运算</em></p></blockquote><p id="055e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> <em class="nk">查看更多信息</em> </strong> : <a class="ae le" href="https://github.com/albanie/convnet-burden" rel="noopener ugc nofollow" target="_blank">对各种CNN</a>和<a class="ae le" href="https://iopscience.iop.org/article/10.1088/1742-6596/681/1/012049/pdf" rel="noopener ugc nofollow" target="_blank">ARM内核浮点性能及其效率</a>的内存消耗和FLOP计数的估计。</p><p id="1fdd" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我在大学里学过几门与ML相关的课程。我们做了很多很酷的作业。但即使在那里，我的4GB GTX1050 <strong class="lh ja">也不足以</strong>训练所有的模型。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi no"><img src="../Images/71840bd205469f513acbbe146aa61b86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/0*KbWJLUTeLRcMkZpF.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">理解问题是制造正确产品的关键</p></figure><p id="341b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">一般ML工程师<strong class="lh ja">很少考虑计算资源</strong>。而且，他/她<strong class="lh ja">很少关心内存使用</strong>。为什么？因为它很便宜，甚至你的手机有很好的CPU和很大的内存。</p><p id="6763" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">提到上次聚会的照片，你还会觉得手机内存不足吗？假设您使用具有256KB闪存的TrueTouch感应控制器。是的，256KB。由于现有的固件，你不能使用所有这些。大约100KB。看看你最后的型号。可能要大得多。</p><p id="13b4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">变得有趣了吗？我们继续:)</p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><blockquote class="nx"><p id="bb1a" class="ny nz iq bd oa ob oc od oe of og ma dk translated">听到“嵌入式设备”你会怎么想？想象这幅画，并把它记在心里。</p></blockquote><h2 id="dc92" class="oh ml iq bd mm oi oj dn mq ok ol dp mu lo om on mw ls oo op my lw oq or na iw bi translated">1.它是任何电动机械。甚至我的微波炉和洗衣机</h2><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi os"><img src="../Images/67c0dc50e8eb43d77a25819b0f3a4858.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BLIQ8aJecGQLFCd7"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">马科斯·拉米雷斯在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="6049" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="nk">是的，你是对的！</em></p><p id="1922" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">如今，几乎所有的电子设备都是嵌入式设备。它内部可能有一个或几个控制器，负责每个确切的功能:触摸感应、发动机状态监控等。</strong></p><h2 id="1d34" class="oh ml iq bd mm oi ot dn mq ok ou dp mu lo ov on mw ls ow op my lw ox or na iw bi translated">2.Arduino或/和树莓派</h2><div class="kp kq kr ks gt ab cb"><figure class="oy kt oz pa pb pc pd paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/9754b4270af12f566a433895daaf8f56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*0RmHNeHbzs3L0SK1"/></div></figure><figure class="oy kt oz pa pb pc pd paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/ce391ee094a6ade7cddeccd69e84960c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*M_JbHOLgLigaVuiO"/></div><p class="la lb gj gh gi lc ld bd b be z dk pe di pf pg translated">哈里森·布罗德本特在Unsplash上拍摄的照片</p></figure></div><p id="a12f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">恭喜你，你又答对了！</p><p id="e330" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">它们是DIY项目中最受欢迎和广泛使用的工具包之一。是的，它们是嵌入式设备。</p><h2 id="b966" class="oh ml iq bd mm oi ot dn mq ok ou dp mu lo ov on mw ls ow op my lw ox or na iw bi translated">3.杰特森纳米和类似产品</h2><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/9cbdaee0372ffe9df3853e3620f5b880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/0*c_6HZv5scE3rK8j4.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">英伟达照片</p></figure><p id="c13f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="nk">又对了。</em></p><p id="51e1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这是一个特殊的开发工具包“又名迷你电脑”，专为在其上运行ML模型而开发。它非常强大，说实话，超级性感。</p><h1 id="0748" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">但是这里遗漏了一些东西</h1><p id="8a85" class="pw-post-body-paragraph lf lg iq lh b li nc ka lk ll nd kd ln lo ne lq lr ls nf lu lv lw ng ly lz ma ij bi translated">我有许多朋友正在做令人难以置信的硬件宠物项目。他们那里一般用Arduino或者STM32(又名硬核Arduino)。</p><div class="kp kq kr ks gt ab cb"><figure class="oy kt pi pa pb pc pd paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/2995882644bebfa57a70b20e459a3893.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/0*sMaY5nem6hFC7m7_"/></div></figure><figure class="oy kt pj pa pb pc pd paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/1f3ac428093e6bf51dc10439f297c5a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:694/0*ydCFC8NCqzFkcMeY"/></div></figure><figure class="oy kt pk pa pb pc pd paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><img src="../Images/579fa63dc6488bb4e43ae3abdb95fc4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/0*lSVGHXTvI4Q-9KE8"/></div><p class="la lb gj gh gi lc ld bd b be z dk pl di pm pg translated">智能头盔、机器人汽车和ALU</p></figure></div><p id="cc5d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我认识几个人工智能工程师，他们对Jetson Nano和类似的设备感到兴奋。他们认为这是嵌入式人工智能的未来。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pn"><img src="../Images/cc4cec73c670864a848c0aac5a1248e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_1vw1t9I5Ch2GuLC.jpg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">英伟达照片</p></figure><blockquote class="nx"><p id="c5be" class="ny nz iq bd oa ob po pp pq pr ps ma dk translated">而现在。请想一想“这样的设备有多少是用在生产层面的？”</p></blockquote><h1 id="878c" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf pt kg mw ki pu kj my kl pv km na nb bi translated">答案是——微小</h1><p id="f62e" class="pw-post-body-paragraph lf lg iq lh b li nc ka lk ll nd kd ln lo ne lq lr ls nf lu lv lw ng ly lz ma ij bi translated">想想你家里有多少电器设备。然后在你的车里增加大量的控制器。你工作中的安全系统。我可以列出一个很长的清单。</p><p id="08d3" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">且每个设备都有一些控制器。通常，它是微型的，而且超级便宜。不能和杰特森或者树莓的资源和能力相比。</p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><blockquote class="nh ni nj"><p id="6ffa" class="lf lg nk lh b li lj ka lk ll lm kd ln nl lp lq lr nm lt lu lv nn lx ly lz ma ij bi translated">想象你有一个微控制器。它的主要任务是处理你在屏幕上的手指触摸。它有ARM Cortex-M0处理器，256KB内存(其中只有80–120可供您使用)。这是一个实时系统，所以你有很少的时间来为你的模型做出推断，比如说100微秒。你的目标是改进或替换那里的一些算法。</p><p id="72c1" class="lf lg nk lh b li lj ka lk ll lm kd ln nl lp lq lr nm lt lu lv nn lx ly lz ma ij bi translated">祝你好运，欢迎来到“嵌入式人工智能”的世界。</p></blockquote><h2 id="abac" class="oh ml iq bd mm oi ot dn mq ok ou dp mu lo ov on mw ls ow op my lw ox or na iw bi translated">***嵌入式世界”由1-2美元的芯片组成，资源有限。这是在生产层面上使用的***</h2><h1 id="b767" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">2.纯基础设施</h1><p id="c035" class="pw-post-body-paragraph lf lg iq lh b li nc ka lk ll nd kd ln lo ne lq lr ls nf lu lv lw ng ly lz ma ij bi translated">我一直在做我上面描述的项目。一切都很好。我开发了一个小型网络，它有可能适合那个微控制器。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pw"><img src="../Images/8533ede8e8cb7330cdbe16939ac4681f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wmr5Z-DBBpnBnhsn"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">马蒂·林恩·巴恩斯在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="fb45" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">将模型从我的电脑转移到设备的时间已经开始了！</strong></p><ol class=""><li id="8325" class="px py iq lh b li lj ll lm lo pz ls qa lw qb ma qc qd qe qf bi translated"><strong class="lh ja">量化。</strong></li></ol><p id="2533" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">那个处理器不能处理浮点数。即使可以，我们也不会使用它，因为这是一个相当复杂的操作，需要很多时间。</p><p id="d2fd" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">所以，我做了模型权重<strong class="lh ja">量化</strong>——将连续范围的值转换成有限范围的离散值。</p><p id="39e9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">你猜怎么着？PyTorch和TensorflowLite都不完全支持。它们不支持所有激活功能(虽然我使用了非常简单的HardTanh)。PyTorch甚至无法将量化模型保存到文件中。</p><p id="c446" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">所以，我只能用手来做。</p><p id="d016" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> 2。推理代码生成</strong></p><p id="31a9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">您希望在该控制器上运行您的模型。对吗？所以，你需要<em class="nk"> C代码</em>进行模型推断。</p><p id="dc16" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">很悲哀，但你必须用手去做。为什么？PyTorch没有推理代码生成的功能。相比之下，TFLite有，但是它非常有限，也不支持常见的激活功能。</p><p id="fa49" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">所以，我又用手做了一次。</p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><p id="4c9c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我在工作中遇到过很多这样的情况。不是往PyTorch或者TF这边一拳，而是“呼救”。</p><h2 id="80f9" class="oh ml iq bd mm oi ot dn mq ok ou dp mu lo ov on mw ls ow op my lw ox or na iw bi translated">* * *社区还有另外一面，那就是在找“<em class="qg">嵌入式AI”的专业工具，</em>却找不到。***</h2><h1 id="69b6" class="mk ml iq bd mm mn mo mp mq mr ms mt mu kf mv kg mw ki mx kj my kl mz km na nb bi translated">有什么好消息吗？</h1><p id="82ce" class="pw-post-body-paragraph lf lg iq lh b li nc ka lk ll nd kd ln lo ne lq lr ls nf lu lv lw ng ly lz ma ij bi translated">我看到大型半导体公司对人工智能有巨大的兴趣，他们正在做非常有价值和重要的事情。它们值得再写一篇文章，所以我列出了几个，以免这篇文章太长。</p><ul class=""><li id="5a41" class="px py iq lh b li lj ll lm lo pz ls qa lw qb ma qh qd qe qf bi translated">CMS is-NN——面向Arm Cortex-M处理器的高效神经网络内核</li><li id="018f" class="px py iq lh b li qi ll qj lo qk ls ql lw qm ma qh qd qe qf bi translated">编译器可以产生高效的推理代码，并根据您所拥有的硬件进行优化</li><li id="9878" class="px py iq lh b li qi ll qj lo qk ls ql lw qm ma qh qd qe qf bi translated">还有很多其他很酷的东西</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/778c590d1e50b60637a5fcccf5fb70a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6gUJzJKUs7XA8vE6"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@carsive?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">艾哈迈德·哈桑</a>在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><p id="1448" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">觉得这篇文章有用？看看下面另一篇有趣的文章</p><div class="qn qo gp gr qp qq"><a href="https://medium.com/swlh/do-we-need-math-imagine-our-life-without-it-c458fda152b3" rel="noopener follow" target="_blank"><div class="qr ab fo"><div class="qs ab qt cl cj qu"><h2 class="bd ja gy z fp qv fr fs qw fu fw iz bi translated">我们需要数学吗？想象一下我们没有它的生活</h2><div class="qx l"><h3 class="bd b gy z fp qv fr fs qw fu fw dk translated">没有数学的世界之旅，以及为什么抽象是一切的关键</h3></div><div class="qy l"><p class="bd b dl z fp qv fr fs qw fu fw dk translated">medium.com</p></div></div><div class="qz l"><div class="ra l rb rc rd qz re ky qq"/></div></div></a></div></div></div>    
</body>
</html>