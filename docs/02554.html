<html>
<head>
<title>Using Machine Learning to Tackle Arms Proliferation In Russian Trade Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用机器学习解决俄罗斯贸易数据中的武器扩散问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-machine-learning-to-tackle-arms-proliferation-in-russian-trade-data-e457f44002c0?source=collection_archive---------27-----------------------#2020-03-11">https://towardsdatascience.com/using-machine-learning-to-tackle-arms-proliferation-in-russian-trade-data-e457f44002c0?source=collection_archive---------27-----------------------#2020-03-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="bff3" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/making-sense-of-big-data" rel="noopener" target="_blank">理解大数据</a></h2><div class=""/><div class=""><h2 id="5abc" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">我们如何构建和迭代一个机器学习模型来识别俄罗斯非法武器交易的实例。</h2></div><p id="fe45" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><em class="ln">作者:埃利奥特·冈恩</em></p><p id="776e" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><em class="ln">数据科学团队:Sean Antosiak、Elliot Gunn、Andrew Mikol、Jason Nova </em></p><p id="88b7" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">项目负责人:Elan Riznis </p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/031a4c7b10e04603b62c56059f0ac153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ji9YlyGqz6Y_1dCss28fnA.jpeg"/></div></div></figure><p id="4a7f" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">简介</strong> <br/>在本帖中，我们描述了我们如何构建一种新颖的方法，在大型贸易数据集上使用机器学习来识别向外国军队发货的俄罗斯方，或代表俄罗斯国有军事公司行事的各方。</p><p id="4b94" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">俄罗斯是世界第二大武器出口国。现有的大量贸易数据给武器不扩散领域的研究人员和政府机构带来了挑战和机遇。最近，我们的数据科学家团队与 DC 华盛顿州的非营利组织<a class="ae ma" href="https://c4ads.org/" rel="noopener ugc nofollow" target="_blank"> C4ADS 合作，</a>研究我们是否可以将机器学习技术应用于他们拥有的非常大的贸易数据集，并找到潜在的俄罗斯武器扩散的实例。</p><p id="3e0e" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们的任务是双重的:ML 解决方案在这个用例中是否可行，如果可行，我们将如何构建我们的方法？在我们的研究中，我们发现只有一个其他项目试图将机器学习技术应用于类似的用例。伦敦大学国王学院的阿尔法项目(Project Alpha)正致力于为防扩散分析师创建一个大数据平台。</p><p id="b6bf" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们的第一次尝试是成功的:在 8 周内，我们能够识别高风险公司，这表明数据科学是一种可行的方法，对那些从事军备控制研究和/或出口控制的人来说非常有用。</p><p id="c3d0" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">在亚马逊网络服务(AWS)工作<br/> </strong>这是我们团队第一次接触 AWS，所以学习曲线相当陡峭。我们学习了拼花文件以及模式信息是如何工作的。我们花了一周时间探索不同的选项，包括花一些时间在 AWS Glue 上，在那里我们没有成功地编写生命周期脚本。</p><p id="036f" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们最终选择了 EMR (Spark &amp; Livy)和 SageMaker，因为它非常适合我们的用例。我们选择这两个是因为它们在协作工作环境中易于使用，并且能够使用多个集群来处理我们的大型数据集。设置过程是实质性的，需要一些所谓的系统管理员技能。简而言之，在设置 SageMaker 笔记本之前，我们在 EMR 服务中创建了集群。我们使用 SageMaker 笔记本的根目录中的一个笔记本作为中心位置，为 conda_python3 环境 pip 安装相关的库。</p><p id="cff1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">数据集的样本使用 Dask(拼花文件)进行探索，然后使用 Spark 进行清理。</p><p id="f286" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">数据探索&amp;清理<br/> </strong>“贸易”数据集大于 170 GB，包含 2016 年至 2018 年超过 6500 万行俄罗斯进出口数据。这包括 59 家被列为我们的目标变量的公司，它们是一家大型俄罗斯武器出口商和已知代表其转运货物的各方。</p><p id="fe99" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">读取数据集有一些重大障碍，因为它们没有数据字典；有些柱子是神秘的。一个关键的专栏，Description Good，是用西里尔语写的——虽然我们很幸运有两个团队成员具有西里尔语能力，但是这个专栏应该被翻译成在未来的模型构建迭代中允许 NLP 派生的特性。这些公司在其税号(INN)中包含名称和唯一标识符。</p><p id="be76" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们只过滤出口商，并大量使用正则表达式来清理 PySpark 中的“交易”。我们必须将一些俄语(русскийязык语)转换成等价的 unicode，以便 regex 引擎进行处理。我们要么采用我们需要的精确单词(例如，пао、ооо、оо),要么必须采用单词的变化来匹配(例如，таможни、пост等)，以确保这些色谱柱达到最基本的清洁标准。我们也考虑过将正则表达式应用于描述 Good，但是试图弄清楚俄语中动词/名词/形容词变化的复杂性被证明是相当困难的。</p><p id="8f14" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这将交易数据集从 170+ GB 减少到了 4GB 以下，即大约 900 万行。虽然我们担心减少的太多，但很难确保我们的正则表达式在清理数据时不会太严格或太宽松。这种减少确实让我们可以使用 Pandas 进行机器学习，而不是必须学习另一种新工具，Apache Spark 的 MLlib。导致两个数据帧的清理过程的示例代码片段:</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="bc56" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">功能工程<br/> </strong>我们主要使用 UDF 来应用 lambda 函数，以仅允许指定的值(例如，对于浮点列，nones 和 nulls 被设置为 0.0)。在第一次传递数据时，我们确实手工输入了所有的方法和参数，但是在以后的迭代中，更加程序化的方法将会更加清晰。</p><p id="2e7c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">每一列都有字符串或非序号值，所以它们都是编码的。此处是工作流程的一个示例:</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="daa6" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们试图将一些领域知识融入到特征工程中。我们的研究发现，军队和安全部队一直是俄罗斯非法武器转让的主要来源，要么通过直接参与地区冲突，要么通过腐败官员与犯罪组织合作进行销售。</p><p id="5f6b" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们创建了一个新的专栏，试图用一个虚拟变量“active-russian-military-ties”来捕捉这一过程。该标准被定义为具有当今或最近的历史(过去 10 年)联系，包括军事干预、维和以及签署的军事或技术合作协议。我们通过自己的研究手工编码，找到了 106 个符合标准的国家。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="0ed9" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">然而，稍后运行特征重要性分析将证实我们的直觉，即唯一重要的列是商品描述列。</p><p id="09c8" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">原型和训练</strong> <br/>我们同时追求监督和非监督学习方法。</p><p id="41be" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><em class="ln">受监督的</em> <br/>以 59 家出口商的列表作为我们的目标变量，我们在选定 scikit-learn 的<a class="ae ma" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingClassifier.html" rel="noopener ugc nofollow" target="_blank">GradientBoostingClassifier</a>之前尝试了几个分类器。相对于深度决策树，GBC 让我们建立一个低偏差和低方差的预测函数。Boosting 在每一步按顺序拟合树，新的树根据先前树的残差进行训练。GBC 通过使用学习率(在 0，1 之间)来衡量新树每一步的贡献，解决了过度拟合问题。</p><p id="8605" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">因为它在最后组合它们之前按顺序训练了许多树，所以我们可以小心地控制方差并避免过度拟合，这与拟合单个深度决策树不同。决策树也是非参数化的，这对我们的数据集特别有用，因为我们的很多列都无法识别，因此无法与领域知识联系起来。</p><p id="598b" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们最初的迭代严重依赖于一个特性，所以我们删除了它并重新训练了模型。为了解决高度不平衡的类别，我们对数据集的子集进行了训练，其中我们分别对 25，000 和 250，000 个已知和非出口商进行了采样(这个 1:10 的比例最适合我们的模型)。我们的指标针对召回进行了优化，因为由于法律分歧，过度识别合法交易(误报)比错过非法交易(误报)要好。监督方法产生了 50 个预测的旅馆，它们不包含在 59 个原始列表中。我们有一种感觉，在俄罗斯注册网站上查找旅馆后，我们已经获得了一个很好的基线，其中许多旅馆都有与军事有关的描述。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="c1d8" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><em class="ln">无监督的<br/> </em>我们使用 scikit-learn 的<a class="ae ma" href="https://scikit-learn.org/stable/modules/neighbors.html#unsupervised-nearest-neighbors" rel="noopener ugc nofollow" target="_blank">最近邻的</a>库，它实现了无监督的最近邻学习。</p><p id="4581" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在最近邻算法中，参数是 n_neighbors 和使用的算法类型。BallTree 被用于该算法，因为它用于“快速广义 N 点问题”n_neighbors 用于对簇中的邻居进行分组。选择 10，000 这个数字来产生一个预测集，这个预测集足够宽，可以确定一个已知出口商的内部贸易交易的分组，并使用该交易来识别其他感兴趣的公司。在 37，467 个已知的 INN 预测器行中，前 1000 行用于构建 10，000，000 个邻域的预测数据框架。该数据帧然后过滤掉已知的 INN 邻居，并且对结果进行值计数以发现新的潜在 INN。在查看了最初的结果后，这种方法的成功被认为是不确定的。</p><p id="f91b" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">方法<br/> </strong>我们在方法中做了几个假设:</p><ul class=""><li id="c21f" class="md me it kt b ku kv kx ky la mf le mg li mh lm mi mj mk ml bi translated">非法和合法武器出口商在其贸易交易中表现出相似的特征(例如，在贸易伙伴、空间、货物、数量方面)。我们的目标变量是俄罗斯 59 家已知武器出口商的名单。使用这份合法出口商名单是了解非法武器出口商如何也出现在贸易数据中的一种方式。由于我们实际上不知道非法出口商和合法出口商有什么不同，这可能是一个巨大的飞跃。</li><li id="9d8c" class="md me it kt b ku mm kx mn la mo le mp li mq lm mi mj mk ml bi translated">交易数据包含准确和真实的信息。更有可能的情况是，非法武器出口商混淆了他们的路线、出口目的地、货物数量，甚至货物实际上是什么。一个众所周知的例子是俄罗斯武器经纪人 Victor Bout，他利用许多幌子公司，通过飞机运输武器，并重新注册飞机，试图通过合法和非法手段逃避管制。其他出口商可能会采取迂回路线前往其真正的目的地，在空壳公司之间转移货物，这些过境国或公司不会被数据捕获。</li></ul><p id="c0e0" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">吸取教训&amp;展望未来</strong></p><p id="a767" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们有 8 周的时间来学习新工具，并为 C4ADS 的项目利益相关者提供概念证明。听说我们的基线结果是进一步探索的有效 MVP，并得到了利益相关方的积极认可，我们非常兴奋。</p><ul class=""><li id="8d34" class="md me it kt b ku kv kx ky la mf le mg li mh lm mi mj mk ml bi translated">首先，文档是至关重要的:其他团队以前曾与他们合作应对这一挑战，但是没有任何文档(特别是关于架构设置)，我们花了大量时间尝试不同的设置，然后选择了最适合项目独特需求的设置。为此，我们确保尽早并经常记录文档，并传递一份广泛详细的 22 页文档，以确保可重复性，并使下一个团队能够更快地发展。</li><li id="4261" class="md me it kt b ku mm kx mn la mo le mp li mq lm mi mj mk ml bi translated">第二，项目管理让我们走上正轨:我们一直作为一个远程团队工作，并且能够从 0 到一个有希望的基线结果如此之快，因为我们有一个了不起的项目经理(感谢 Elan！)与我们紧密合作，跨越所有时区。我们每天站立，提交定期发布的画布，评估里程碑，并定期与涉众进行视频通话，以更好地理解业务问题和期望。</li><li id="2cd1" class="md me it kt b ku mm kx mn la mo le mp li mq lm mi mj mk ml bi translated">结果，我们很早并且经常迭代:有了这个清晰的工作结构，并且我们的项目经理的焦点是在第 12 周交付 MVP，我们被鼓励尽早尝试，抛弃那些很快被证明没有结果的工具或工作流。我们无法在短时间内对关键的西里尔列进行超参数调整或 NLP，但我们很高兴我们的文档和基线结果将使下一个团队能够推动机器学习在这一领域的发展。</li></ul><p id="4700" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><em class="ln">特别感谢 C4ADS 给我们这个难以置信的机会来解决这个新奇的数据科学问题。</em></p></div></div>    
</body>
</html>