<html>
<head>
<title>Run your first trading algorithm!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">运行你的第一个交易算法！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/run-your-first-trading-algorithm-46dbd5b1cb7c?source=collection_archive---------24-----------------------#2020-04-02">https://towardsdatascience.com/run-your-first-trading-algorithm-46dbd5b1cb7c?source=collection_archive---------24-----------------------#2020-04-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d78f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">编码或选择一个算法，回测它，并使用羊驼中的纸张或货币帐户运行它。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/162f48454f46e8281700d926db82c56c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vyJt8qmxJ8CN-VkG"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">菲利普·格利克曼在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="059e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">免责声明:本文内容不构成理财建议。这只是一个关于如何为交易机器人建立基础设施的教程。</strong></p><h1 id="46e6" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">动机</h1><p id="5b22" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">一张图片胜过千言万语。请看下面 S&amp;P500 指数和一些组成 ML 401k 投资组合的共同基金的表现比较，并做出你自己的结论。</p><p id="8172" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">(<em class="mp">来源:</em><a class="ae kv" href="https://finance.yahoo.com" rel="noopener ugc nofollow" target="_blank"><em class="mp">https:/finance . Yahoo . com</em></a>)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/eadbe335d45b7d2b36d4b76e7492d791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iZNehLIQgxq5ZZIPYyvS2A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">S&amp;P500 vs FSELX</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/5a1d118b11c4fd9a166884a91d2fac52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ebehDVIAUDdUwRfUurPQbA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">S&amp;P500 对雷西斯</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/40cb2f02c9a51619e25aa06ffb7e109b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l7KX9nnVd8YWDedPKF5XqQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">S&amp;P500 对 S&amp;P500？</p></figure><p id="e3c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你所看到的，这些共同基金的表现与 S&amp;P500 相比并没有那么好。除此之外，获取这些基金的业绩/风险指标并不简单。夏普比率，最大下降，阿尔法，贝塔——祝你好运。</p><blockquote class="ms"><p id="05b6" class="mt mu iq bd mv mw mx my mz na nb lr dk translated">我们不应该盲目地依赖公司来管理我们的财务。归根结底，这是我们的未来，我们对此最感兴趣。</p></blockquote><p id="fd06" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf ne lh li lj nf ll lm ln ng lp lq lr ij bi translated">但是谁有时间管理投资组合呢？这就是我们需要自动化的原因。</p><p id="ce75" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看看如何部署我们的第一个交易算法。</p><h1 id="c528" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">建筑</h1><p id="2b66" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">你需要:</p><ul class=""><li id="7755" class="nh ni iq ky b kz la lc ld lf nj lj nk ln nl lr nm nn no np bi translated"><strong class="ky ir">量子密码。</strong>自己写或者在社区搜索。那里有很多好东西，但鉴于目前新冠肺炎市场的波动性，我建议采取市场中性策略(小市场相关性，小贝塔)。</li><li id="1915" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated"><strong class="ky ir"> PythonAnywhere 账户</strong>(你需要 5 美元/月的计划):<a class="ae kv" href="https://www.pythonanywhere.com/user/cunha/" rel="noopener ugc nofollow" target="_blank">https://www.pythonanywhere.com/</a></li><li id="b4df" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated"><strong class="ky ir">羊驼账号</strong>(免费！)<br/><a class="ae kv" href="https://alpaca.markets" rel="noopener ugc nofollow" target="_blank">https://alpaca . markets</a></li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/91c76bb0c01573148884e38386f69bfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S6SXKFSMrubb2ooPACO_Cg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我应该成为一名艺术家。</p></figure><h1 id="d6d1" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">建立基础设施</h1><ol class=""><li id="e005" class="nh ni iq ky b kz mk lc ml lf nw lj nx ln ny lr nz nn no np bi translated"><strong class="ky ir">羊驼</strong></li></ol><p id="17a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦您创建并验证了您的羊驼账户，点击“转到纸质账户”并点击“您的 API 密钥”中的“查看”按钮。记下 key_id、secret_key 和 base_url。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/756b2a9abc1844756df8db0d68338c6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qiD5D8Iz4yXu6MPPTAJOpw.png"/></div></div></figure><p id="f808" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.<strong class="ky ir"> PythonAnywhere </strong></p><p id="fc8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">创建虚拟环境</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/562a58ee7bbf2d065a6425271e909217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R71TYX2ZfPTbDQ0e0Aa6wA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">《时代》杂志 2015 年虚拟现实封面催生了一个经典迷因。Pic: @PellyNV</p></figure><p id="f3da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们先用 python 3.6 创建一个虚拟环境，安装<em class="mp"> pylivetrader。</em></p><blockquote class="ms"><p id="3930" class="mt mu iq bd mv mw mx my mz na nb lr dk translated">Pylivetrader 是让羊驼理解量子算法的软件包。这个包允许您获得 Quantopian 和 Alpaca 的算法订单执行的回溯测试功能，所有这些都与 PythonAnywhere 粘合在一起，同时在云中不间断地运行。</p></blockquote><p id="490d" class="pw-post-body-paragraph kw kx iq ky b kz nc jr lb lc nd ju le lf ne lh li lj nf ll lm ln ng lp lq lr ij bi translated">在创建和升级你的账户(最便宜的计划)后，你需要用 Python 3.6 创建一个虚拟环境并安装<em class="mp"> pylivetrader。</em></p><p id="7842" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在 PythonAnywhere 上打开 bash 并键入以下命令:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="c0ff" class="oh lt iq od b gy oi oj l ok ol">$ python3.6 -m venv venv<br/>$ source venv/bin/activate<br/>(venv)$ pip install pylivetrader</span></pre><p id="2697" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意<em class="mp"> pylivetrader </em>将只与 Python 3.6 一起工作。</strong></p><p id="5bb2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">安装在虚拟环境中的所有包只能在同一个虚拟环境中访问，这里称为'<em class="mp"> venv </em>'。'<em class="mp"> venv </em>'内部的 Python 版本也将被限制为 3.6(在这种特殊情况下)；然而，您仍然可以使用'<em class="mp"> venv </em>'之外的其他 python 版本。为此，只需输入 deactivate。</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="7b35" class="oh lt iq od b gy oi oj l ok ol">(venv)$ deactivate</span></pre><p id="cc22" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以通过键入以下内容直接跳回虚拟环境:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="c7ef" class="oh lt iq od b gy oi oj l ok ol">$ source venv/bin/activate</span></pre><p id="9bb0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">上传量子算法</strong></p><p id="4167" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关闭 bash 并转到“<em class="mp">文件</em>”，创建一个名为<em class="mp"> algo.py 的新空文件，并粘贴以下代码:</em></p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="1bc2" class="oh lt iq od b gy oi oj l ok ol">from pylivetrader.api import order_target, symbol<br/><br/>def initialize(context):<br/>    context.i = 0<br/>    context.asset = symbol('AAPL')<br/><br/>def handle_data(context, data):<br/>    # Compute averages<br/>    # data.history() has to be called with the same params<br/>    # from above and returns a pandas dataframe.<br/>    short_mavg = data.history(context.asset, 'price', bar_count=100, frequency="1m").mean()<br/>    long_mavg = data.history(context.asset, 'price', bar_count=300, frequency="1m").mean()<br/><br/>    # Trading logic<br/>    if short_mavg &gt; long_mavg:<br/>        # order_target orders as many shares as needed to<br/>        # achieve the desired number of shares.<br/>        order_target(context.asset, 100)<br/>    elif short_mavg &lt; long_mavg:<br/>        order_target(context.asset, 0)</span></pre><p id="1300" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">保存并关闭它。我们需要一个配置文件来访问羊驼；还记得 api_key 和 secret 吗？我们现在需要它们。</p><p id="cbfa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建一个名为<em class="mp"> config.yaml </em>的新文件，并添加以下定义<em class="mp"> : </em></p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="60f7" class="oh lt iq od b gy oi oj l ok ol">key_id: 'your key_id'<br/>secret: 'your secret'<br/>base_url: <a class="ae kv" href="https://paper-api.alpaca.markets" rel="noopener ugc nofollow" target="_blank">https://paper-api.alpaca.markets</a></span></pre><p id="3485" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">保存并关闭它。我们差不多完成了:最后要做的事情是安排一个将在云中不间断运行的任务。</p><p id="2243" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">转到“任务”，一直向下滚动到“<em class="mp">始终在线任务</em>”，然后键入以下命令:</p><pre class="kg kh ki kj gt oc od oe of aw og bi"><span id="bbcc" class="oh lt iq od b gy oi oj l ok ol">source venv/bin/activate &amp;&amp; pylivetrader run -f algo.py --backend-config config.yaml</span></pre><p id="68c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">稍后，任务将开始运行:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/46e8099c2f1b51629bf976b0f16d9d49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DOL5YhJaGrAbPLMK7kRHbw.png"/></div></div></figure><p id="0494" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，进入你的羊驼纸账户，检查订单是否通过。</p><p id="d942" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦你准备好用真钱开始，为你的钱帐户获得 api 密钥和秘密，并更新 config.yaml 文件。</p><h1 id="0c48" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="bde5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在本文中，我们使用 PythonAnywhere 和 Alpaca 完成了运行 Quantopian 算法的步骤。</p><p id="98ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">根据您的算法，您可能需要包含更多的导入以使其工作。您可以在这里找到每种情况下需要导入的包的列表:</p><p id="a43f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://alpaca.markets/docs/alpaca-works-with/zipline-to-pylivetrader/" rel="noopener ugc nofollow" target="_blank">https://alpaca . markets/docs/alpaca-works-with/zip line-to-pylivetrader/</a></p><p id="8507" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，如果你决定运行你的羊驼货币账户，我强烈建议使用市场中性算法(空头和多头头寸比例相等)。我的苹果股票布林线交易算法一直很好地应对了冠状病毒危机引起的波动。可以在这里查看:<a class="ae kv" rel="noopener" target="_blank" href="/backtesting-bollinger-bands-on-apple-stock-using-quantopian-6be2e4824f43">https://towards data science . com/back testing-bollinger-bands-on-apple-stock-using-quanto pian-6be 2e 4824 f 43</a></p><p id="4b4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你喜欢这篇文章！请不要犹豫评论或分享您的结果。</p><p id="3762" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">谢谢</p><p id="58c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="mp">来自《走向数据科学》编辑的提示:</em> </strong> <em class="mp">虽然我们允许独立作者根据我们的</em> <a class="ae kv" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="mp">规则和指导方针</em> </a> <em class="mp">发表文章，但我们不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae kv" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="mp">读者术语</em> </a> <em class="mp">。</em></p></div></div>    
</body>
</html>