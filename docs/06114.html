<html>
<head>
<title>Automating Analytics in Tableau — Python &amp; Tabcmd</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Tableau中的自动化分析— Python和Tabcmd</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automating-analytics-in-tableau-5516e1e7134c?source=collection_archive---------18-----------------------#2020-05-18">https://towardsdatascience.com/automating-analytics-in-tableau-5516e1e7134c?source=collection_archive---------18-----------------------#2020-05-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="39a5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">概述了如何使用Python来自动洞察Tableau，并介绍了Tableau命令行实用程序Tabcmd。</h2></div><h1 id="230b" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated"><strong class="ak">简介</strong></h1><p id="fc14" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">Tableau连续七年被<a class="ae lw" href="https://www.tableau.com/about/blog/2019/2/tableau-7-years-leader-2019-gartner-magic-quadrant-101644" rel="noopener ugc nofollow" target="_blank"> Gartner </a>评为分析和商业智能平台的领先工具。几乎每个行业中各种形状和规模的公司的BI/数据团队都开发了仪表板，以便在整个组织中有效地交流关键业务指标。</p><p id="3859" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">使用Tableau的一个主要优点(这一点经常被忽略)是，它公开了一个公共API来以编程方式处理几乎所有可以在应用程序GUI上执行的任务，包括管理。</p><p id="5d3e" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">这就是Python的用武之地。大量库的脚本功能和支持使其成为在BI工作流中处理端到端流程自动化的流行选择。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mc"><img src="../Images/d1db4252fdbfde3f85fc0389b2d76c72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8T5vuoCY1nEeou7aRMfUyA.png"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">来自tableau.com/products/viewer<a class="ae lw" href="http://tableau.com/products/viewer" rel="noopener ugc nofollow" target="_blank">的</a></p></figure><blockquote class="ms mt mu"><p id="2e49" class="la lb mv lc b ld lx ju lf lg ly jx li mw lz ll lm mx ma lp lq my mb lt lu lv im bi translated"><strong class="lc iu">在您继续之前… </strong></p><p id="38c0" class="la lb mv lc b ld lx ju lf lg ly jx li mw lz ll lm mx ma lp lq my mb lt lu lv im bi translated"><em class="it">为了有效地使用集成，Tableau工作簿应在以下位置可用:</em></p><p id="4800" class="la lb mv lc b ld lx ju lf lg ly jx li mw lz ll lm mx ma lp lq my mb lt lu lv im bi translated">1.<a class="ae lw" href="https://www.tableau.com/products/server" rel="noopener ugc nofollow" target="_blank"><strong class="lc iu">Tableau Server</strong></a><strong class="lc iu"><br/></strong>允许您在组织服务器上或使用云服务提供商托管内部工作簿和数据源。</p><p id="de88" class="la lb mv lc b ld lx ju lf lg ly jx li mw lz ll lm mx ma lp lq my mb lt lu lv im bi translated"><strong class="lc iu"> 2。</strong><a class="ae lw" href="https://www.tableau.com/products/cloud-bi" rel="noopener ugc nofollow" target="_blank"><strong class="lc iu">Tableau Online</strong></a><strong class="lc iu"><br/></strong>Tableau管理服务器基础设施，您可以通过它们托管您的工作簿，只需支付一些额外费用。</p><p id="a2b6" class="la lb mv lc b ld lx ju lf lg ly jx li mw lz ll lm mx ma lp lq my mb lt lu lv im bi translated"><em class="it">通过上述方法之一将工作簿托管在Tableau服务器上通常是一种好的做法——尤其是如果您的仪表板经常被多方查看，并且涉及定期数据刷新(每天/每小时)。</em></p></blockquote><blockquote class="mz"><p id="5c61" class="na nb it bd nc nd ne nf ng nh ni lv dk translated">Tableau Online 有一个14天的免费试用期，默认情况下会加载一些示例工作簿。您可以<a class="ae lw" href="https://www.tableau.com/products/online/request-trial" rel="noopener ugc nofollow" target="_blank">创建一个免费试用帐户</a>来试用下面列出的一些测试集成和代码片段。</p></blockquote><p id="d26f" class="pw-post-body-paragraph la lb it lc b ld nj ju lf lg nk jx li lj nl ll lm ln nm lp lq lr nn lt lu lv im bi translated">创建tableau在线账户后，保存<em class="mv">用户名、密码、Tableau服务器地址</em>和<em class="mv">网站名称</em>的凭证。一台tableau服务器可以有多个站点，每个站点都承载一组工作簿和数据源。</p><h1 id="f1a3" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">条条大路通罗马</h1><p id="dcef" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">将Python与Tableau Server集成有多种方式，每种方式都基于不同的用例。</p><ol class=""><li id="4ff8" class="no np it lc b ld lx lg ly lj nq ln nr lr ns lv nt nu nv nw bi translated"><strong class="lc iu"> <em class="mv"> Tableau服务器客户端(TSC) </em> </strong>库<br/> (Python 3.5或更高版本)</li></ol><p id="2e25" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">这可能是从Python脚本执行服务器相关任务的最佳选择。这是一个由Tableau管理的开源项目，它包装了<strong class="lc iu"> <em class="mv"> Tableau服务器REST API。</em>T13】</strong></p><pre class="md me mf mg gt nx ny nz oa aw ob bi"><span id="3735" class="oc kj it ny b gy od oe l of og">pip install tableauserverclient</span></pre><p id="bab9" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">2.<strong class="lc iu"> <em class="mv"> TabPy </em> </strong>库<br/>允许您在Tableau的表计算中嵌入和执行Python脚本。它本质上允许Tableau远程执行Python代码。</p><pre class="md me mf mg gt nx ny nz oa aw ob bi"><span id="5859" class="oc kj it ny b gy od oe l of og">pip install tabpy</span></pre><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi oh"><img src="../Images/d5eb9c1d94af947c8accdc7ae9bf1a7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LOYgitIXTVZ1hbKFy-6HyQ.png"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">从这个<a class="ae lw" href="https://www.tableau.com/about/blog/2017/1/building-advanced-analytics-applications-tabpy-64916" rel="noopener ugc nofollow" target="_blank">tabby博客</a>——在Tableau计算中嵌入Python</p></figure><p id="1a3c" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">3.使用<strong class="lc iu"> <em class="mv">请求</em> </strong>库直接消耗<em class="mv"> Tableau服务器REST API </em> <strong class="lc iu">。一个更简单的方法，但是你可以让Tableau以任何你认为合适的方式工作，只要API允许。</strong></p><p id="3391" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">其他整合路线和变体包括:</strong></p><p id="4dfd" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">1.<strong class="lc iu">T33】JupyTabT35】</strong></p><p id="0877" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">将Jupyter笔记本数据带入Tableau可视化。</p><pre class="md me mf mg gt nx ny nz oa aw ob bi"><span id="b7c7" class="oc kj it ny b gy od oe l of og">pip install jupytab</span></pre><p id="7d66" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">2.<strong class="lc iu"> <em class="mv"> Tabcmd </em> </strong> <br/>从Windows Shell向Tableau Server发出命令——Mac/Linux原生不支持，但有一个<a class="ae lw" href="https://community.tableau.com/thread/118422" rel="noopener ugc nofollow" target="_blank"> hack </a>。</p><p id="9f29" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><a class="ae lw" href="https://help.tableau.com/current/online/en-us/tabcmd.htm" rel="noopener ugc nofollow" target="_blank"> <em class="mv">下载Tableau服务器的tab cmd</em></a></p><p id="821c" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">Tabcmd的执行可以通过在<a class="ae lw" href="https://www.windowscentral.com/how-create-automated-task-using-task-scheduler-windows-10" rel="noopener ugc nofollow" target="_blank">计划任务</a>下的<a class="ae lw" href="https://www.windowscentral.com/how-create-and-run-batch-file-windows-10" rel="noopener ugc nofollow" target="_blank">批处理文件</a>中进行设置来实现自动化。将Tabcmd添加到您的windows <code class="fe oi oj ok ny b">PATH</code>变量中，或者切换到安装它的目录来运行它的命令。</p><blockquote class="ms mt mu"><p id="54f1" class="la lb mv lc b ld lx ju lf lg ly jx li mw lz ll lm mx ma lp lq my mb lt lu lv im bi translated">您可以使用<code class="fe oi oj ok ny b"><strong class="lc iu"><em class="it">os</em></strong></code>或<code class="fe oi oj ok ny b"><strong class="lc iu">subprocess</strong></code>模块在Python源代码中执行tabcmd命令。将tabcmd语句构造为字符串，并使用<code class="fe oi oj ok ny b"><strong class="lc iu"><em class="it">os.system()</em></strong></code>或<code class="fe oi oj ok ny b"><strong class="lc iu"><em class="it">subprocess.call()</em></strong></code>函数将它们传递给shell</p></blockquote><p id="5efc" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">你可以在<a class="ae lw" href="https://www.github.com/tableau" rel="noopener ugc nofollow" target="_blank"> Tableau的GitHub页面</a>找到更多支持其他语言(比如JavaScript)的项目</p><p id="2ba2" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">这里我们重点讲TSC和Tabcmd的用法</strong>。</p><p id="e487" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">假设每个TSC片段都可以访问下面列出的虚拟变量。用你自己的凭证代替这些。</p><pre class="md me mf mg gt nx ny nz oa aw ob bi"><span id="24ba" class="oc kj it ny b gy od oe l of og">tableau_user = 'cricks@gmail.com'<br/>tableau_passwd = '123'<br/>tableau_server = 'http://172.16.22.2/'<br/>tableau_server_site = 'my_site'<br/>server_version = '3.7'</span></pre><p id="5662" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">对于Tableau Online，<code class="fe oi oj ok ny b">tableau_server</code>字段看起来会像这样:<br/> <code class="fe oi oj ok ny b">prod-apnortheast-a.online.tableau.com</code>基于您的服务器位置。</p><p id="98e2" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">以下各节详细介绍了如何使用TSC和Tabcmd在Tableau服务器上执行特定任务。</p><h1 id="8140" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated"><strong class="ak">认证</strong></h1><p id="1f4a" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated"><strong class="lc iu">贸易与供应链</strong></p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="ol om l"/></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">使用TableauServerClient登录到Tableau服务器</p></figure><p id="e08c" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu"> Tabcmd </strong></p><pre class="md me mf mg gt nx ny nz oa aw ob bi"><span id="9c4d" class="oc kj it ny b gy od oe l of og">&gt; tabcmd login -s http://172.16.22.2/ -t my_site -u cricks@gmail.com -p 123</span></pre><p id="7981" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">凭证的每个参数都作为shell中的一个标志传递。</p><p id="af51" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">输出应该如下所示:</p><pre class="md me mf mg gt nx ny nz oa aw ob bi"><span id="b99e" class="oc kj it ny b gy od oe l of og">===== redirecting to http://172.16.22.2/auth<br/>===== Signed out<br/>===== Creating new session<br/>=====     Server:   http://172.16.22.2/<br/>=====     Username: cricks@gmail.com<br/>=====     Site:     my_site<br/>===== Connecting to the server...<br/>===== Signing in...<br/>===== Succeeded</span></pre><blockquote class="ms mt mu"><p id="b1e5" class="la lb mv lc b ld lx ju lf lg ly jx li mw lz ll lm mx ma lp lq my mb lt lu lv im bi translated">如果任一路由的身份验证失败，请向Tableau服务器管理员检查您的用户权限/用户授权。</p></blockquote><h1 id="3474" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">获取并下载工作簿</h1><blockquote class="ms mt mu"><p id="de86" class="la lb mv lc b ld lx ju lf lg ly jx li mw lz ll lm mx ma lp lq my mb lt lu lv im bi translated"><em class="it">“超市”工作簿可作为所有Tableau发行版的样本。它将是我们代码片段演示中的默认工作簿。</em></p></blockquote><p id="8569" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">找到工作簿&amp;将其下载为</strong> <code class="fe oi oj ok ny b"><strong class="lc iu">.twbx</strong></code> <strong class="lc iu">文件</strong></p><p id="f181" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">TSC</strong>T30<code class="fe oi oj ok ny b">workbooks.get()</code>上带<code class="fe oi oj ok ny b">TSC.Filter()</code>的<br/> — <code class="fe oi oj ok ny b">TSC.Pager()<br/></code> — <code class="fe oi oj ok ny b">TSC.RequestOptions()</code>可以找到一个工作簿。</p><p id="fbb1" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">TSC返回一个带有工作簿ID、工作簿名称等属性的工作簿对象。这些选项中的每一个都在下面的要点中被详细描述为一个函数。</p><p id="7387" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">可以使用<br/> - <code class="fe oi oj ok ny b">TSC.Server().workbooks.download(workbook_id)</code>将工作簿下载为<code class="fe oi oj ok ny b">twbx</code> (Tableau打包工作簿)</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="ol om l"/></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">从服务器获取工作簿对象并作为twbx下载的两种不同方法</p></figure><p id="a86e" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">您可以通过引用workbook对象上的<code class="fe oi oj ok ny b">id</code>属性在服务器上检索工作簿的ID。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi on"><img src="../Images/019490b539539f64baafbd8ce13686d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jVPG8Sv2b3BHEMepXnEszA.png"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">超市工作簿的产品视图</p></figure><p id="f45a" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu"> Tabcmd </strong></p><p id="a78d" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">Tabcmd保持简短:</p><p id="8db6" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><code class="fe oi oj ok ny b">tabcmd get “/workbooks/Superstore.twbx”</code></p><blockquote class="ms mt mu"><p id="01e8" class="la lb mv lc b ld lx ju lf lg ly jx li mw lz ll lm mx ma lp lq my mb lt lu lv im bi translated"><em class="it">可能有几个警告，特别是对于Tabcmd中的</em> <code class="fe oi oj ok ny b"><em class="it">get </em></code> <em class="it">命令的权限。请务必在此</em>  <em class="it">查看完整的清单</em> <a class="ae lw" href="https://help.tableau.com/current/server/en-us/tabcmd_cmd.htm#id7e0a0627-ad89-4135-a1c2-85b1d8472568" rel="noopener ugc nofollow" target="_blank"> <em class="it">。您可以使用</em> <code class="fe oi oj ok ny b"><em class="it">get</em></code> <em class="it">下载PDF或PNG格式的工作簿。</em></a></p></blockquote><h1 id="c83a" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">对视图应用过滤器并作为文件下载</h1><p id="9a58" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">我们可以查询工作簿中的特定视图，并对其应用过滤器。</p><p id="b427" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><em class="mv">工作原理:</em> <br/>我们发出一个以过滤器为参数的视图请求。API将请求应用于视图，并将快照取回请求客户端。</p><p id="1449" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">过滤前:</strong></p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi oo"><img src="../Images/03d4f6cd0f9ccb0a92c67fa99a76cb06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x0LcfOfcXnE4P_zBKXgspg.png"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">超市——所有地区概览</p></figure><p id="1d6b" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">后过滤</strong>为<code class="fe oi oj ok ny b">Region = West</code>:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi op"><img src="../Images/debc591796439a62f94268bdcbb92fd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VL0MPjxgH5DB0Oq8S8MY3A.png"/></div></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">超级商店-区域字段过滤为一个值的概览</p></figure><p id="6481" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu"> TSC </strong></p><p id="4f0e" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">假设<code class="fe oi oj ok ny b">workbook id</code>可以被获取，我们将使用它作为一个虚拟变量。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="ol om l"/></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">过滤视图并以PDF格式下载</p></figure><p id="21ac" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><code class="fe oi oj ok ny b">view_items</code>包含一个<code class="fe oi oj ok ny b">view</code>对象列表。一个视图对象有<code class="fe oi oj ok ny b">id</code>、<code class="fe oi oj ok ny b">workbook_id</code>、<code class="fe oi oj ok ny b">name</code>、<code class="fe oi oj ok ny b">csv</code>等属性。个人最喜欢的是<code class="fe oi oj ok ny b">total_views</code>属性，它返回当前引用的视图在服务器上被用户查看的总次数。</p><p id="7c83" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">我们需要"<code class="fe oi oj ok ny b">populate</code>" pdf格式的视图，因为它允许TSC仅从网络上获取必要的属性。工作簿或视图对象包含对服务器上该对象的所有其他属性的引用。当需要填充其中一个对象时，TSC让请求获取所需的属性以满足填充参数。</p><p id="d6b9" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">使用<code class="fe oi oj ok ny b">ImageRequestOptions()</code>可以将图像保存为PNG，使用<code class="fe oi oj ok ny b">CSVRequestOptions()</code>可以保存CSV。</p><p id="e2e9" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">关于<a class="ae lw" href="https://tableau.github.io/server-client-python/docs/api-ref#requests" rel="noopener ugc nofollow" target="_blank">的用法，请参见此处</a>的文档。</p><p id="0662" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu"> Tabcmd </strong></p><p id="bf8a" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">export命令接受指定视图的URL和下载选项的可选参数。</p><pre class="md me mf mg gt nx ny nz oa aw ob bi"><span id="dcd8" class="oc kj it ny b gy od oe l of og">tabcmd export -t my_site "Superstore/Overview?refresh=yes&amp;Region=West" --pdf --pagesize a4 --pagelayout landscape -f "Overview.pdf"</span></pre><p id="abb6" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">视图也可以导出为PNG或CSV格式。</p><blockquote class="ms mt mu"><p id="5048" class="la lb mv lc b ld lx ju lf lg ly jx li mw lz ll lm mx ma lp lq my mb lt lu lv im bi translated"><em class="it">引号中指定的URI与用于通过浏览器访问Tableau服务器上的视图的URL的子字符串完全相同。</em></p></blockquote><p id="1cfb" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">以下是相同命令在浏览器上的URL:</p><pre class="md me mf mg gt nx ny nz oa aw ob bi"><span id="2503" class="oc kj it ny b gy od oe l of og">http://172.16.22.2/#/site/my_site/views/Superstore/Overview?Region=West</span></pre><p id="3768" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">这有助于在使用Tabcmd将视图导出到本地之前，在浏览器上试验视图的外观。</p><blockquote class="ms mt mu"><p id="d343" class="la lb mv lc b ld lx ju lf lg ly jx li mw lz ll lm mx ma lp lq my mb lt lu lv im bi translated"><code class="fe oi oj ok ny b">'refresh=yes'</code> <em class="it">强制服务器端刷新视图并获取最新结果。</em></p><p id="c4cf" class="la lb mv lc b ld lx ju lf lg ly jx li mw lz ll lm mx ma lp lq my mb lt lu lv im bi translated"><em class="it">应用</em>多个过滤器<em class="it">，在参数中用</em> ' <code class="fe oi oj ok ny b">&amp;'</code>将它们分开</p><p id="1ac1" class="la lb mv lc b ld lx ju lf lg ly jx li mw lz ll lm mx ma lp lq my mb lt lu lv im bi translated"><em class="it">日期可以过滤为:‘</em>..<code class="fe oi oj ok ny b">?report_date=2020–01–01</code></p></blockquote><h1 id="150c" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">数据源和连接</h1><p id="71ac" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">Tableau作为一个软件的核心特性之一是它允许用户处理数据源、提取和连接输入可视化的数据的能力。</p><p id="d74f" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu">贸易与供应链</strong></p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="ol om l"/></div><p class="mo mp gj gh gi mq mr bd b be z dk translated">获取服务器上的所有数据源作为对象，并打印每个数据源的名称。</p></figure><p id="238b" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">与工作簿或视图对象类似，<code class="fe oi oj ok ny b">datasource</code>对象也可以被过滤或分页。</p><p id="04f9" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated"><strong class="lc iu"> Tabcmd </strong></p><pre class="md me mf mg gt nx ny nz oa aw ob bi"><span id="e69c" class="oc kj it ny b gy od oe l of og">tabcmd refreshextracts --datasource sales_ds</span></pre><h1 id="eaee" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">TSC与Tabcmd</h1><blockquote class="mz"><p id="424c" class="na nb it bd nc nd oq or os ot ou lv dk translated">TSC和Tabcmd都允许您对数据源、连接、工作簿、视图、用户等执行重要的CRUD操作。</p></blockquote><p id="f2c9" class="pw-post-body-paragraph la lb it lc b ld nj ju lf lg nk jx li lj nl ll lm ln nm lp lq lr nn lt lu lv im bi translated">虽然TSC本身与操作系统无关，但是如果您有windows系统或者能够将其配置为在Mac/Linux上手动运行，Tabcmd仍然足以在服务器上执行大多数日常任务。</p><p id="6750" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">TSC胜过Tabcmd的一个特殊用例是它能够并行处理对服务器<em class="mv">的大量请求</em>。使用Tabcmd，请求总是在每个shell会话中序列化。TSC可以多线程处理数十或数百个工作线程，从而大幅提升其服务器请求的性能。在Python上，您可以在一个使用TSC的函数的列表上实现带有<code class="fe oi oj ok ny b">map()</code>的<code class="fe oi oj ok ny b">ThreadPoolExecutor()</code>,并让它为您所用。</p><p id="970c" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">这可能有助于启动快速高效的BI报告。将这些与<a class="ae lw" rel="noopener" target="_blank" href="/replacing-sheets-with-python-f1608e58d2ca">Python for Google Sheets/Excel</a>或<a class="ae lw" rel="noopener" target="_blank" href="/pivoting-your-data-using-python-sql-or-spreadsheets-62736ba23921"> Python for SQL </a>结合在一起可以增强你的工作流程。</p><p id="31a7" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">Tableau有丰富的关于使用TSC和Tabcmd的文档。本文中的代码片段只是触及了它们在Tableau服务器上可以执行的大量操作的表面。下面详细检查一下。</p><blockquote class="mz"><p id="93de" class="na nb it bd nc nd oq or os ot ou lv dk translated"><a class="ae lw" href="https://tableau.github.io/server-client-python/#" rel="noopener ugc nofollow" target="_blank"> TableauServerClient文档</a></p><p id="32ff" class="na nb it bd nc nd oq or os ot ou lv dk translated"><a class="ae lw" href="https://help.tableau.com/current/server/en-us/tabcmd_cmd.htm" rel="noopener ugc nofollow" target="_blank"> Tabcmd文档</a></p></blockquote><h1 id="e52f" class="ki kj it bd kk kl km kn ko kp kq kr ks jz ov ka ku kc ow kd kw kf ox kg ky kz bi translated">其他参考文献</h1><ol class=""><li id="31fb" class="no np it lc b ld le lg lh lj oy ln oz lr pa lv nt nu nv nw bi translated"><a class="ae lw" href="https://visualbi.com/blogs/tableau/automate-admin-tasks-tabcmd/" rel="noopener ugc nofollow" target="_blank"> VisualBI在基本选项卡上的博客cmd </a></li><li id="1d31" class="no np it lc b ld pb lg pc lj pd ln pe lr pf lv nt nu nv nw bi translated"><a class="ae lw" href="https://www.youtube.com/watch?v=sqrTUUay8uk" rel="noopener ugc nofollow" target="_blank">用Tabcmd </a>指挥</li><li id="a57c" class="no np it lc b ld pb lg pc lj pd ln pe lr pf lv nt nu nv nw bi translated"><a class="ae lw" href="https://www.youtube.com/watch?v=NHomg6M9RcA" rel="noopener ugc nofollow" target="_blank"> Tableau服务器客户端和REST API演示</a></li></ol><p id="10b7" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">希望这是一个足够温和的介绍，可以让您站起来开始这些集成。</p><p id="032a" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">干杯。</p></div></div>    
</body>
</html>