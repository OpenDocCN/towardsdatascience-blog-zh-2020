<html>
<head>
<title>Time Series Analysis for Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">æœºå™¨å­¦ä¹ çš„æ—¶é—´åºåˆ—åˆ†æ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/time-series-analysis-for-machine-learning-with-python-626bee0d0205?source=collection_archive---------3-----------------------#2020-03-06">https://towardsdatascience.com/time-series-analysis-for-machine-learning-with-python-626bee0d0205?source=collection_archive---------3-----------------------#2020-03-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/bf7a59d41b19f964ce71b34753c515bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LgqxDMP5qD1HE_uM33zZrg.png"/></div></div></figure><div class=""/><div class=""><h2 id="20e5" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">è¶‹åŠ¿ã€å¼‚å¸¸å€¼ã€å¹³ç¨³æ€§ã€å­£èŠ‚æ€§</h2></div></div><div class="ab cl kt ku hx kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="im in io ip iq"><h2 id="1559" class="la lb je bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">æ‘˜è¦</h2><p id="f1f9" class="pw-post-body-paragraph lw lx je ly b lz ma kf mb mc md ki me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated">åœ¨æè¿°ç»Ÿè®¡å­¦ä¸­ï¼Œæ—¶é—´åºåˆ—è¢«å®šä¹‰ä¸ºä¸€ç»„æŒ‰æ—¶é—´æ’åºçš„éšæœºå˜é‡ã€‚ç ”ç©¶æ—¶é—´åºåˆ—æ˜¯ä¸ºäº†è§£é‡Šä¸€ç§ç°è±¡ï¼Œç¡®å®šè¶‹åŠ¿ã€å‘¨æœŸæ€§ã€å­£èŠ‚æ€§çš„ç»„æˆéƒ¨åˆ†ï¼Œå¹¶é¢„æµ‹å…¶æœªæ¥å€¼ã€‚æˆ‘è®¤ä¸ºå®ƒä»¬æ˜¯ç»æµå­¦é¢†åŸŸå’Œæ•°æ®ç§‘å­¦(è‚¡ç¥¨ä»·æ ¼ã€ç»æµå‘¨æœŸã€é¢„ç®—å’Œç°é‡‘æµâ€¦â€¦)ä¹‹é—´ç»“åˆçš„æœ€ä½³ä¾‹å­ã€‚</p><p id="1052" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘å°†ä¸€æ­¥ä¸€æ­¥åœ°è§£é‡Šæ—¶é—´åºåˆ—åˆ†ææ ‡å‡†æ–¹æ³•ï¼Œå¹¶å±•ç¤ºä¸€äº›æœ‰ç”¨çš„å·¥å…·(python ä»£ç )ï¼Œè¿™äº›å·¥å…·å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨äºå…¶ä»–ç±»ä¼¼çš„æƒ…å†µ(åªéœ€å¤åˆ¶ã€ç²˜è´´å’Œè¿è¡Œ)ã€‚æˆ‘å°†å¸¦ç€æ³¨é‡Šéå†æ¯ä¸€è¡Œä»£ç ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥è½»æ¾åœ°å¤åˆ¶è¿™ä¸ªç¤ºä¾‹(ä¸‹é¢æ˜¯å®Œæ•´ä»£ç çš„é“¾æ¥)ã€‚</p><p id="59b1" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">æˆ‘ä»¬å°†ä½¿ç”¨ Kaggle ç«èµ›â€œ<strong class="ly jf">é¢„æµ‹æœªæ¥é”€å”®</strong>â€(é“¾æ¥å¦‚ä¸‹)çš„æ•°æ®é›†ï¼Œå…¶ä¸­ä¸ºæ‚¨æä¾›æ¯æ—¥å†å²é”€å”®æ•°æ®ï¼Œä»»åŠ¡æ˜¯é¢„æµ‹é”€å”®çš„äº§å“æ€»é‡ã€‚è¯¥æ•°æ®é›†å‘ˆç°äº†ä¸€ä¸ªæœ‰è¶£çš„æ—¶é—´åºåˆ—ï¼Œå› ä¸ºå®ƒä¸ç°å®ä¸–ç•Œä¸­çš„ç”¨ä¾‹éå¸¸ç›¸ä¼¼ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“ä»»ä½•äº§å“çš„æ—¥å¸¸é”€å”®éƒ½ä¸ä¼šæ˜¯å›ºå®šçš„ï¼Œå¹¶ä¸”æ€»æ˜¯å—åˆ°å­£èŠ‚æ€§çš„ä¸¥é‡å½±å“ã€‚</p><p id="c918" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">è¯´åˆ°è¿™é‡Œï¼Œæœ¬æ•™ç¨‹çš„ä¸»è¦ç›®çš„æ˜¯åœ¨è®¾è®¡å’Œæµ‹è¯•ç”¨äºé¢„æµ‹çš„æ¨¡å‹ä¹‹å‰ï¼Œäº†è§£<strong class="ly jf">æ—¶é—´åºåˆ—åˆ†æ</strong> <strong class="ly jf">çš„åŸºæœ¬æ­¥éª¤(<em class="mu">æ³¨æ„ï¼Œæœ¬æ–‡å‡è®¾äº†è¯¥ä¸»é¢˜çš„åŸºæœ¬çŸ¥è¯†ï¼Œæ‰€ä»¥æˆ‘ä¸ä¼šè¿‡å¤šåœ°è¿›è¡Œå®šä¹‰ï¼Œä½†æˆ‘ä¼šæ’å…¥æ‰€æœ‰æœ‰ç”¨çš„è¶…é“¾æ¥</em>)ã€‚ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬å°†äº†è§£:</strong></p><ul class=""><li id="03fd" class="mv mw je ly b lz mp mc mq lj mx ln my lr mz mo na nb nc nd bi translated"><a class="ae ne" href="https://en.wikipedia.org/wiki/Trend_analysis" rel="noopener ugc nofollow" target="_blank">è¶‹åŠ¿åˆ†æ</a>ç¡®å®šå®ƒæ˜¯å¦æ˜¯çº¿æ€§çš„ï¼Œå› ä¸ºå¤§å¤šæ•°æ¨¡å‹éœ€è¦æ­¤ä¿¡æ¯ä½œä¸ºè¾“å…¥</li><li id="3ce8" class="mv mw je ly b lz nf mc ng lj nh ln ni lr nj mo na nb nc nd bi translated"><a class="ae ne" href="https://en.wikipedia.org/wiki/Outlier" rel="noopener ugc nofollow" target="_blank">å¼‚å¸¸å€¼æ£€æµ‹</a>äº†è§£å¦‚ä½•å‘ç°å’Œå¤„ç†å¼‚å¸¸å€¼</li><li id="ab83" class="mv mw je ly b lz nf mc ng lj nh ln ni lr nj mo na nb nc nd bi translated"><a class="ae ne" href="https://en.wikipedia.org/wiki/Stationary_process" rel="noopener ugc nofollow" target="_blank">å¹³ç¨³æ€§æµ‹è¯•</a>äº†è§£æˆ‘ä»¬æ˜¯å¦å¯ä»¥å‡è®¾æ—¶é—´åºåˆ—æ˜¯å¹³ç¨³çš„</li><li id="6f0c" class="mv mw je ly b lz nf mc ng lj nh ln ni lr nj mo na nb nc nd bi translated"><a class="ae ne" href="https://en.wikipedia.org/wiki/Seasonality" rel="noopener ugc nofollow" target="_blank">å­£èŠ‚æ€§åˆ†æ</a>ç¡®å®šå»ºæ¨¡æ—¶ä½¿ç”¨çš„æœ€ä½³å­£èŠ‚æ€§å‚æ•°ã€‚</li></ul><p id="02ec" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated"><strong class="ly jf">å®Œæ•´ä»£ç </strong> (Github):</p><div class="is it gp gr iu nk"><a href="https://github.com/mdipietro09/DataScience_ArtificialIntelligence_Utils/blob/master/time_series/example_forecast.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd jf gy z fp np fr fs nq fu fw jd bi translated">mdipietro 09/data science _ äººå·¥æ™ºèƒ½ _ å®ç”¨å·¥å…·</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">permalink dissolve GitHub æ˜¯è¶…è¿‡ 5000 ä¸‡å¼€å‘äººå‘˜çš„å®¶å›­ï¼Œä»–ä»¬ä¸€èµ·å·¥ä½œæ¥æ‰˜ç®¡å’Œå®¡æŸ¥ä»£ç ï¼Œç®¡ç†â€¦</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">github.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny ja nk"/></div></div></a></div><p id="0c8e" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated"><strong class="ly jf">æ•°æ®é›†</strong> (Kaggle):</p><div class="is it gp gr iu nk"><a href="https://www.kaggle.com/c/competitive-data-science-predict-future-sales" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd jf gy z fp np fr fs nq fu fw jd bi translated">é¢„æµ‹æœªæ¥é”€å”®</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">Coursera è¯¾ç¨‹â€œå¦‚ä½•èµ¢å¾—æ•°æ®ç§‘å­¦ç«èµ›â€çš„æœŸæœ«é¡¹ç›®</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">www.kaggle.com</p></div></div><div class="nt l"><div class="nz l nv nw nx nt ny ja nk"/></div></div></a></div></div><div class="ab cl kt ku hx kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="im in io ip iq"><h2 id="4dc8" class="la lb je bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><strong class="ak">è®¾ç½®</strong></h2><p id="6aa4" class="pw-post-body-paragraph lw lx je ly b lz ma kf mb mc md ki me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å°†å¯¼å…¥ä»¥ä¸‹åº“</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="4724" class="la lb je of b gy oj ok l ol om"><strong class="of jf">## For data</strong><br/>import <strong class="of jf">pandas</strong> as pd<br/>import <strong class="of jf">numpy</strong> as np</span><span id="6037" class="la lb je of b gy on ok l ol om"><strong class="of jf">## For plotting</strong><br/>import <strong class="of jf">matplotlib</strong>.pyplot as plt</span><span id="7fa3" class="la lb je of b gy on ok l ol om"><strong class="of jf">## For outliers detection</strong><br/>from <strong class="of jf">sklearn</strong> import preprocessing, svm</span><span id="3390" class="la lb je of b gy on ok l ol om"><strong class="of jf">## For stationarity test and decomposition</strong><br/>import <strong class="of jf">statsmodels</strong>.tsa.api as smt<br/>import <strong class="of jf">statsmodels</strong>.api as sm</span></pre><p id="7db2" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">ç„¶åæˆ‘ä»¬å°†æ•°æ®è¯»å…¥ç†ŠçŒ«æ•°æ®å¸§</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="a95d" class="la lb je of b gy oj ok l ol om">dtf = pd.read_csv('data.csv')</span><span id="a2a9" class="la lb je of b gy on ok l ol om">dtf.head()</span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oo"><img src="../Images/dd1553d4b8293447accb2a609ee9a3bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bbROLG6DmsCSbhsl6MMo_Q.png"/></div></div></figure><p id="28f0" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">åŸå§‹æ•°æ®é›†æœ‰ä¸åŒçš„åˆ—ï¼Œä½†æ˜¯å‡ºäºæœ¬æ•™ç¨‹çš„ç›®çš„ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸‹é¢çš„åˆ—:æ—¥æœŸå’Œå”®å‡ºäº§å“çš„æ•°é‡(item_cnt_day)ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª<a class="ae ne" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html" rel="noopener ugc nofollow" target="_blank"> pandas Series </a>(åä¸ºâ€œsalesâ€)çš„æ¯æ—¥é¢‘ç‡æ—¥æœŸæ—¶é—´ç´¢å¼•ï¼Œä»…ä½¿ç”¨æ¯æ—¥é”€å”®é¢</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="2477" class="la lb je of b gy oj ok l ol om"><strong class="of jf">## format datetime column</strong><br/>dtf["<strong class="of jf">date</strong>"] = pd.to_datetime(dtf['<strong class="of jf">date</strong>'], format='<strong class="of jf">%d.%m.%Y</strong>')</span><span id="9902" class="la lb je of b gy on ok l ol om"><strong class="of jf">## create time series</strong><br/>ts = dtf.groupby("<strong class="of jf">date</strong>")["<strong class="of jf">item_cnt_day</strong>"].sum().rename("<strong class="of jf">sales</strong>")</span><span id="d345" class="la lb je of b gy on ok l ol om">ts.head()</span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi op"><img src="../Images/7939b0d33faa345d5e0123467d75ec4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*zqn0WOnOkrWOL4PH6ELHag.png"/></div></figure><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="cdb0" class="la lb je of b gy oj ok l ol om">ts.tail()</span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/b067ac06f226606fce08cd62657d29ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*OeVRHND-BoCDB3ZOYx-7aA.png"/></div></figure><p id="4ddf" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">æ‰€ä»¥æ—¶é—´åºåˆ—èŒƒå›´ä»<strong class="ly jf">2013â€“01â€“01</strong>åˆ°<strong class="ly jf">2015â€“10â€“31</strong>ï¼Œå®ƒæœ‰<strong class="ly jf"> 1034 ä¸ªè§‚æµ‹å€¼</strong>ï¼Œä¸€ä¸ª<strong class="ly jf">å¹³å‡å€¼ 3528ï¼Œ</strong>å’Œä¸€ä¸ª<strong class="ly jf">æ ‡å‡†å·® 1585 </strong>ã€‚å®ƒ<strong class="ly jf"> </strong>çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="771a" class="la lb je of b gy oj ok l ol om">ts.plot()</span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi or"><img src="../Images/9214ac07bdb8cc3c9d0b660135dac702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1CfnBxo8FFpIHce-JwZw8A.png"/></div></div></figure><p id="127b" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">æˆ‘ä»¬ç°åœ¨å¼€å§‹å§ï¼Œå¥½å—ï¼Ÿ</p><h2 id="a41f" class="la lb je bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><strong class="ak">è¶‹åŠ¿åˆ†æ</strong></h2><p id="4bad" class="pw-post-body-paragraph lw lx je ly b lz ma kf mb mc md ki me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated"><a class="ae ne" href="https://stats.oecd.org/glossary/detail.asp?ID=6692" rel="noopener ugc nofollow" target="_blank">è¶‹åŠ¿æ˜¯æ—¶é—´åºåˆ—çš„ç»„æˆéƒ¨åˆ†ï¼Œä»£è¡¨æ—¶é—´åºåˆ—ä¸­ä½é¢‘çš„å˜åŒ–ï¼Œé«˜é¢‘å’Œä¸­é¢‘çš„æ³¢åŠ¨å·²è¢«æ»¤é™¤ã€‚</a></p><p id="8f84" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">è¿™ç§åˆ†æçš„ç›®çš„æ˜¯äº†è§£æ•°æ®ä¸­æ˜¯å¦æœ‰è¶‹åŠ¿ï¼Œä»¥åŠè¿™ç§æ¨¡å¼æ˜¯å¦æ˜¯çº¿æ€§çš„ã€‚è¿™é¡¹å·¥ä½œçš„æœ€ä½³å·¥å…·æ˜¯<strong class="ly jf">å¯è§†åŒ–</strong>ã€‚</p><p id="d363" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">è®©æˆ‘ä»¬å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç†è§£æ—¶é—´åºåˆ—çš„è¶‹åŠ¿å’Œè¿åŠ¨ã€‚æˆ‘ä»¬å¸Œæœ›åœ¨å›¾ä¸­çœ‹åˆ°ä¸€äº›æ»šåŠ¨ç»Ÿè®¡æ•°æ®ï¼Œä¾‹å¦‚:</p><ul class=""><li id="2818" class="mv mw je ly b lz mp mc mq lj mx ln my lr mz mo na nb nc nd bi translated">M <a class="ae ne" href="https://en.wikipedia.org/wiki/Moving_average" rel="noopener ugc nofollow" target="_blank">ç§»åŠ¨å¹³å‡å€¼</a>:å‰ä¸€ä¸ª<em class="mu"> n </em>æ•°æ®çš„æœªåŠ æƒ<a class="ae ne" href="https://en.wikipedia.org/wiki/Arithmetic_mean" rel="noopener ugc nofollow" target="_blank">å¹³å‡å€¼</a>(ä¹Ÿç§°â€œç§»åŠ¨å¹³å‡å€¼â€)</li><li id="1dfd" class="mv mw je ly b lz nf mc ng lj nh ln ni lr nj mo na nb nc nd bi translated"><a class="ae ne" href="https://en.wikipedia.org/wiki/Bollinger_Bands" rel="noopener ugc nofollow" target="_blank">å¸ƒæ—çº¿</a>:é«˜äºç§»åŠ¨å¹³å‡çº¿çš„ k å€<em class="mu"> n </em>å‘¨æœŸæ ‡å‡†å·®çš„ä¸Šå¸¦ï¼Œä½äºç§»åŠ¨å¹³å‡çº¿çš„ k å€<em class="mu"> N </em>å‘¨æœŸæ ‡å‡†å·®çš„ä¸‹å¸¦ã€‚</li></ul><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="4daf" class="la lb je of b gy oj ok l ol om"><strong class="of jf">'''<br/>Plot ts with rolling mean and 95% confidence interval with rolling std.<br/>:parameter    <br/>  :param ts: pandas Series    <br/>  :param window: num - for rolling stats<br/>  :param plot_ma: bool - whether plot moving average<br/>  :param plot_intervals: bool - whether plot upper and lower bounds<br/>'''</strong><br/>def plot_ts(ts, plot_ma=True, plot_intervals=True, window=30,<br/>            figsize=(15,5)): <strong class="of jf"> </strong>  <br/>   rolling_mean = ts.rolling(window=window).mean()    <br/>   rolling_std = ts.rolling(window=window).std()<br/>   plt.figure(figsize=figsize)    <br/>   plt.title(ts.name)    <br/>   plt.plot(ts[window:], label='Actual values', color="black")    <br/>   if plot_ma:        <br/>      plt.plot(rolling_mean, 'g', label='MA'+str(window),<br/>               color="red")    <br/>   if plot_intervals:<br/>      lower_bound = rolling_mean - (1.96 * rolling_std)<br/>      upper_bound = rolling_mean + (1.96 * rolling_std)<br/>   plt.fill_between(x=ts.index, y1=lower_bound, y2=upper_bound,<br/>                    color='lightskyblue', alpha=0.4)<br/>   plt.legend(loc='best')<br/>   plt.grid(True)<br/>   plt.show()</span></pre><p id="076d" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">å½“æ•°æ®é›†è‡³å°‘æœ‰ä¸€æ•´å¹´çš„è§‚å¯Ÿæ—¶é—´æ—¶ï¼Œæˆ‘æ€»æ˜¯ä»ä¸€ä¸ª<strong class="ly jf"> 30 å¤©</strong>çš„æ»šåŠ¨çª—å£å¼€å§‹:</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="788d" class="la lb je of b gy oj ok l ol om"><strong class="of jf">plot_ts(</strong>ts, window=30<strong class="of jf">)</strong></span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi os"><img src="../Images/29bc7086ac8cc037b45f1794a9bd8b2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TEkNmiH2Xm5EGsgRLs0CKQ.png"/></div></div></figure><p id="ae29" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">è§‚å¯Ÿå›¾ä¸­çš„çº¢çº¿ï¼Œæ‚¨å¯ä»¥å¾ˆå®¹æ˜“åœ°å‘ç°ä¸€ç§æ¨¡å¼:æ—¶é—´åºåˆ—éµå¾ªçº¿æ€§ä¸‹é™è¶‹åŠ¿ï¼Œæ¯å¹´ä¸€æœˆéƒ½æœ‰ä¸¥é‡çš„å­£èŠ‚æ€§é«˜å³°ã€‚å½“ä½¿ç”¨è‡³å°‘<strong class="ly jf"> 1 å¹´</strong>çš„æ»šåŠ¨çª—å£æ—¶ï¼Œè¶‹åŠ¿å˜å¾—æ˜æ˜¾</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="48a4" class="la lb je of b gy oj ok l ol om"><strong class="of jf">plot_ts(</strong>ts, window=365<strong class="of jf">)</strong></span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ot"><img src="../Images/f52c071fbccd8e65b1cb04e65d702615.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YbqTcQ1PfXZZrfFmWV3m5A.png"/></div></div></figure><p id="50c4" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">å¦‚ä½ æ‰€è§ï¼Œè¿™æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„çº¿æ€§ä¸‹é™è¶‹åŠ¿ã€‚è¿™åœ¨æ¨¡å‹è®¾è®¡ä¸­å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå¤§å¤šæ•°æ¨¡å‹è¦æ±‚æ‚¨æŒ‡å®šè¶‹åŠ¿ç»„ä»¶æ˜¯å¦å­˜åœ¨ï¼Œä»¥åŠå®ƒæ˜¯çº¿æ€§çš„(ä¹Ÿç§°ä¸ºâ€œåŠ æ³•â€)è¿˜æ˜¯éçº¿æ€§çš„(ä¹Ÿç§°ä¸ºâ€œä¹˜æ³•â€)ã€‚</p><h2 id="c4bc" class="la lb je bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">ç¦»ç¾¤ç‚¹æ£€æµ‹</h2><p id="6d94" class="pw-post-body-paragraph lw lx je ly b lz ma kf mb mc md ki me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated"><a class="ae ne" href="https://stats.oecd.org/glossary/detail.asp?ID=3465" rel="noopener ugc nofollow" target="_blank">ç¦»ç¾¤å€¼æ˜¯ä½äºä¸€ç»„æ•°æ®å€¼çš„ç»Ÿè®¡åˆ†å¸ƒå°¾éƒ¨çš„æ•°æ®å€¼ã€‚</a></p><p id="a5a6" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">æœ¬èŠ‚çš„ç›®æ ‡æ˜¯æ‰¾å‡ºå¼‚å¸¸å€¼å¹¶å†³å®šå¦‚ä½•å¤„ç†å®ƒä»¬ã€‚åœ¨å®è·µä¸­ï¼Œé€šå¸¸ä½¿ç”¨ä¼ ç»Ÿçš„ç¡®å®šæ€§æ–¹æ³•ï¼Œå¦‚ç»˜åˆ¶åˆ†å¸ƒå›¾ï¼Œå¹¶å°†é«˜äºæˆ–ä½äºé€‰å®šé˜ˆå€¼çš„æ¯ä¸ªè§‚å¯Ÿå€¼æ ‡è®°ä¸ºå¼‚å¸¸å€¼ã€‚ä¾‹å¦‚:</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="fbc1" class="la lb je of b gy oj ok l ol om"><strong class="of jf">## Plot histogram</strong><br/>ts.hist(color="black", bins=100)</span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ou"><img src="../Images/6e7e9ff29f71a66db4006016ffb5592f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r7dscS0OKKe0UiQ06bBfyw.png"/></div></div></figure><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="d193" class="la lb je of b gy oj ok l ol om"><strong class="of jf">## Boxplot<br/></strong>ts.plot.box()</span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ov"><img src="../Images/9f472d672780ec4671e201f1a15853fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*3gsTJ2c45xfo7IP-X_mI2A.png"/></div></div></figure><p id="395f" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">è¿™ç§æ–¹æ³•ç‰¹åˆ«é€‚ç”¨äºæ‚¨éå¸¸ç†Ÿæ‚‰æ‚¨çš„æ•°æ®ï¼Œå¹¶ä¸”æ‚¨å·²ç»çŸ¥é“å®ƒéµå¾ªä»€ä¹ˆæ ·çš„è¿‡ç¨‹å’Œåˆ†å¸ƒï¼Œå› æ­¤ä»€ä¹ˆé˜ˆå€¼æ›´é€‚ç”¨çš„æƒ…å†µã€‚ç„¶è€Œï¼Œ<strong class="ly jf">æˆ‘ä¸ªäººå‘ç°è®©æœºå™¨å­¦ä¹ ç®—æ³•åœ¨ä»»ä½•æ—¶é—´åºåˆ—æ•°æ®é›†ä¸Šä¸ºæˆ‘åšè¿™ä»¶äº‹éƒ½æ›´å®¹æ˜“ã€‚</strong></p><p id="8abd" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">è®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨ scikit-learn åº“ä¸­çš„<strong class="ly jf">èšç±»ç®—æ³•</strong>è‡ªåŠ¨æ£€æµ‹æ—¶é—´åºåˆ—ä¸­çš„å¼‚å¸¸å€¼:<a class="ae ne" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.OneClassSVM.html" rel="noopener ugc nofollow" target="_blank">å•ç±»æ”¯æŒå‘é‡æœº</a>ï¼Œå®ƒå­¦ä¹ åˆ†å¸ƒçš„è¾¹ç•Œ(ç§°ä¸ºâ€œ<a class="ae ne" href="https://en.wikipedia.org/wiki/Support_(mathematics)" rel="noopener ugc nofollow" target="_blank">æ”¯æŒ</a>â€)ï¼Œå› æ­¤èƒ½å¤Ÿå°†ä½äºè¾¹ç•Œä¹‹å¤–çš„ä»»ä½•ç‚¹å½’ç±»ä¸ºå¼‚å¸¸å€¼ã€‚</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="d46d" class="la lb je of b gy oj ok l ol om"><strong class="of jf">'''<br/>Find outliers using sklearn unsupervised support vetcor machine.<br/>:parameter<br/>    :param ts: pandas Series<br/>    :param perc: float - percentage of outliers to look for<br/>:return<br/>    dtf with raw ts, outlier 1/0 (yes/no), numeric index<br/>'''</strong><br/>def find_outliers(ts, perc=0.01, figsize=(15,5)):<br/>    <strong class="of jf">## fit svm</strong><br/>    scaler = preprocessing.StandardScaler()<br/>    ts_scaled = scaler.fit_transform(ts.values.reshape(-1,1))<br/>    model = svm.OneClassSVM(nu=perc, kernel="rbf", gamma=0.01)<br/>    model.fit(ts_scaled)</span><span id="9021" class="la lb je of b gy on ok l ol om">    <strong class="of jf">## dtf output</strong><br/>    dtf_outliers = ts.to_frame(name="ts")<br/>    dtf_outliers["index"] = range(len(ts))<br/>    dtf_outliers["outlier"] = model.predict(ts_scaled)<br/>    dtf_outliers["outlier"] = dtf_outliers["outlier"].apply(lambda<br/>                                              x: 1 if x==-1 else 0)<br/>    <strong class="of jf">## plot</strong><br/>    fig, ax = plt.subplots(figsize=figsize)<br/>    ax.set(title="Outliers detection: found"<br/>           +str(sum(dtf_outliers["outlier"]==1)))<br/>    ax.plot(dtf_outliers["index"], dtf_outliers["ts"],<br/>            color="black")<br/>    ax.scatter(x=dtf_outliers[dtf_outliers["outlier"]==1]["index"],<br/>               y=dtf_outliers[dtf_outliers["outlier"]==1]['ts'],<br/>               color='red')<br/>    ax.grid(True)<br/>    plt.show()<br/>    return dtf_outliers</span></pre><p id="758e" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">æœ‰äº†è¿™ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿå‘ç°å¼‚å¸¸å€¼ï¼Œä½†æ˜¯ä¸€æ—¦å‘ç°å¼‚å¸¸å€¼ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿè¿™é‡Œæ²¡æœ‰æœ€ä¼˜ç­–ç•¥:æ²¡æœ‰ä¸å…¶ä»–è§‚å¯Ÿå€¼æ˜¾è‘—ä¸åŒçš„æ•°æ®ç‚¹æ—¶ï¼Œæ—¶é—´åºåˆ—é¢„æµ‹æ›´å®¹æ˜“ï¼Œä½†åˆ é™¤è¿™äº›ç‚¹ä¼šæå¤§åœ°æ”¹å˜æ•°æ®çš„åˆ†å¸ƒã€‚å¦‚æœæ‚¨å·²ç»å†³å®šæ’é™¤å¼‚å¸¸å€¼ï¼Œæœ€æ–¹ä¾¿çš„æ–¹æ³•æ˜¯é€šè¿‡<strong class="ly jf">æ’å€¼</strong>æ¥ç§»é™¤å®ƒä»¬ã€‚</p><p id="8c3b" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">è®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨æ£€æµ‹åˆ°å¼‚å¸¸å€¼åï¼Œé€šè¿‡å¯¹å¼‚å¸¸å€¼å‰åçš„å€¼è¿›è¡Œæ’å€¼æ¥ç§»é™¤å¼‚å¸¸å€¼ã€‚</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="e737" class="la lb je of b gy oj ok l ol om"><strong class="of jf">'''<br/>Interpolate outliers in a ts.<br/>'''</strong><br/>def remove_outliers(ts, outliers_idx, figsize=(15,5)):<br/>    ts_clean = ts.copy()<br/>    ts_clean.loc[outliers_idx] = np.nan<br/>    ts_clean = ts_clean.interpolate(method="linear")<br/>    ax = ts.plot(figsize=figsize, color="red", alpha=0.5,<br/>         title="Remove outliers", label="original", legend=True)<br/>    ts_clean.plot(ax=ax, grid=True, color="black",<br/>                  label="interpolated", legend=True)<br/>    plt.show()<br/>    return ts_clean</span></pre><p id="ef47" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">ç°åœ¨è®©æˆ‘ä»¬ä½¿ç”¨è¿™äº›å‡½æ•°ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æ£€æµ‹å¼‚å¸¸å€¼:</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="d22e" class="la lb je of b gy oj ok l ol om">dtf_outliers = <strong class="of jf">find_outliers(</strong>ts, perc=0.05<strong class="of jf">)</strong></span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ow"><img src="../Images/e72b15ad610e14bdf3a50f4be3f10fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ExEjl1nhnxybkYiNL_4UQ.png"/></div></div></figure><p id="ba25" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">ç„¶åå¤„ç†å®ƒä»¬:</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="bdd1" class="la lb je of b gy oj ok l ol om"><strong class="of jf">## outliers index position</strong><br/>outliers_index_pos = dtf_outliers[dtf_outliers["outlier"]==1].index</span><span id="02d0" class="la lb je of b gy on ok l ol om"><strong class="of jf">## exclude outliers</strong><br/>ts_clean = <strong class="of jf">remove_outliers(</strong>ts, outliers_idx=outliers_index_pos<strong class="of jf">)</strong></span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ox"><img src="../Images/e490179bc4b9e0b6f7276089ffd87b50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iulS0MOBlwqFI6osQiALJw.png"/></div></div></figure><p id="f246" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">å‡ºäºæœ¬æ•™ç¨‹çš„ç›®çš„ï¼Œæˆ‘å°†ç»§ç»­è®¨è®ºåŸå§‹æ—¶é—´åºåˆ—(åŒ…æ‹¬å¼‚å¸¸å€¼)ï¼Œä½†æ˜¯å»é™¤å¼‚å¸¸å€¼å¹¶åœ¨å¹²å‡€çš„æ—¶é—´åºåˆ—(æ²¡æœ‰å¼‚å¸¸å€¼)ä¸Šå»ºç«‹æ¨¡å‹ä¹Ÿæ˜¯ä¸€ä¸ªå¥½ç­–ç•¥ã€‚</p><h2 id="91b1" class="la lb je bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">å¹³ç¨³æ€§æ£€éªŒ</h2><p id="b595" class="pw-post-body-paragraph lw lx je ly b lz ma kf mb mc md ki me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated"><a class="ae ne" href="https://en.wikipedia.org/wiki/Stationary_process" rel="noopener ugc nofollow" target="_blank">å¹³ç¨³è¿‡ç¨‹æ˜¯ä¸€ç§éšæœºè¿‡ç¨‹ï¼Œå…¶æ— æ¡ä»¶è”åˆæ¦‚ç‡åˆ†å¸ƒéšæ—¶é—´æ¨ç§»ä¸å‘ç”Ÿå˜åŒ–ã€‚å› æ­¤ï¼Œå‡å€¼å’Œæ–¹å·®ç­‰å‚æ•°ä¹Ÿä¸ä¼šéšæ—¶é—´å˜åŒ–</a>ï¼Œå› æ­¤å¹³ç¨³æ—¶é—´åºåˆ—æ›´å®¹æ˜“é¢„æµ‹ã€‚</p><p id="7e0e" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">æœ‰å‡ ç§æ–¹æ³•å¯ä»¥ç¡®å®šä¸€ä¸ªæ—¶é—´åºåˆ—æ˜¯å¦æ˜¯å¹³ç¨³çš„ï¼Œæœ€å¸¸è§çš„æ˜¯å¾ˆå¥½çš„å¯è§†åŒ–ï¼ŒæŸ¥çœ‹è‡ªç›¸å…³å’Œè¿è¡Œç»Ÿè®¡æµ‹è¯•ã€‚</p><p id="6a01" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">æœ€å¸¸è§çš„æµ‹è¯•æ˜¯<a class="ae ne" href="https://en.wikipedia.org/wiki/Augmented_Dickey%E2%80%93Fuller_test" rel="noopener ugc nofollow" target="_blank"> Dickey-Fuller æµ‹è¯•</a>(ä¹Ÿç§°ä¸ºâ€œADF æµ‹è¯•â€)ï¼Œå…¶ä¸­<strong class="ly jf">é›¶å‡è®¾æ˜¯æ—¶é—´åºåˆ—æœ‰ä¸€ä¸ªå•ä½æ ¹ï¼Œæ¢å¥è¯è¯´ï¼Œæ—¶é—´åºåˆ—ä¸æ˜¯å¹³ç¨³çš„</strong>ã€‚æˆ‘ä»¬å°†é€šè¿‡æ¯”è¾ƒ p å€¼å’Œé€‰å®šçš„é˜ˆå€¼(Î±)æ¥æµ‹è¯•æ˜¯å¦å¯ä»¥æ‹’ç»é›¶å‡è®¾ï¼Œå› æ­¤ï¼Œå¦‚æœ p å€¼è¾ƒå°ï¼Œæˆ‘ä»¬å¯ä»¥æ‹’ç»é›¶å‡è®¾ï¼Œå¹¶å‡è®¾æ—¶é—´åºåˆ—æ˜¯å¹³ç¨³çš„ï¼Œç½®ä¿¡æ°´å¹³ä¸º 1-Î±(ä»æŠ€æœ¯ä¸Šè®²ï¼Œæˆ‘ä»¬ä¸èƒ½è¯´å®ƒä¸æ˜¯):</p><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oy"><img src="../Images/dd83c09f6648436bf53aadf9b7f751de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mUlYlVEtfaVOfN-n-5JMrA.png"/></div></div><p class="oz pa gj gh gi pb pc bd b be z dk translated"><a class="ae ne" href="https://userpage.fu-berlin.de/soga/200/2070_hypothesis_tests/20713_The_Critical_Value_and_the_p-Value_Approach_to_Hypothesis_Testing.html" rel="noopener ugc nofollow" target="_blank">æ¥æº</a></p></figure><p id="0772" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">è®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå°†æ‰€æœ‰è¿™äº›æ–¹æ³•æ”¾åœ¨ä¸€èµ·ï¼Œå¹¶æ˜¾ç¤ºä¸€ä¸ªç”±ä»¥ä¸‹å†…å®¹ç»„æˆçš„å›¾å½¢:</p><ul class=""><li id="470b" class="mv mw je ly b lz mp mc mq lj mx ln my lr mz mo na nb nc nd bi translated">95% (Î±=0.05) ADF æµ‹è¯•çš„ç»“æœ(å°†æ‰“å°åœ¨è¾“å‡ºå›¾çš„æ ‡é¢˜ä¸­)ã€‚</li><li id="0ea5" class="mv mw je ly b lz nf mc ng lj nh ln ni lr nj mo na nb nc nd bi translated">ç¬¬ä¸€å¼ å›¾å°†ç»˜åˆ¶æ•°æ®çš„å‰ x%çš„å¹³å‡å€¼å’Œæ–¹å·®ï¼Œè¿™æ˜¯ä¸€ä¸ªå›¾å½¢æµ‹è¯•:å¦‚æœæ—¶é—´åºåˆ—çš„å±æ€§æ˜¯å¸¸æ•°ï¼Œæˆ‘ä»¬å°†çœ‹åˆ° 1-x%çš„æ•°æ®åœ¨å¹³å‡å€¼é™„è¿‘å¾˜å¾Šï¼Œå¹¶åœ¨å‰ x%çš„è§‚æµ‹å€¼çš„æ–¹å·®èŒƒå›´å†…</li><li id="2e57" class="mv mw je ly b lz nf mc ng lj nh ln ni lr nj mo na nb nc nd bi translated">æœ€åä¸¤ä¸ªå›¾æç»˜äº†<a class="ae ne" href="https://en.wikipedia.org/wiki/Partial_autocorrelation_function" rel="noopener ugc nofollow" target="_blank"> PACF </a>å’Œ<a class="ae ne" href="https://en.wikipedia.org/wiki/Autocorrelation" rel="noopener ugc nofollow" target="_blank"> ACF </a></li></ul><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="4929" class="la lb je of b gy oj ok l ol om"><strong class="of jf">'''<br/>Test stationarity by:<br/>    - running Augmented Dickey-Fuller test wiht 95%<br/>    - plotting mean and variance of a sample from data<br/>    - plottig autocorrelation and partial autocorrelation<br/>'''</strong><br/>def test_stationarity_acf_pacf(ts, sample=0.20, maxlag=30, figsize= <br/>                              (15,10)):<br/>    with plt.style.context(style='bmh'):<br/>        <strong class="of jf">## set figure</strong><br/>        fig = plt.figure(figsize=figsize)<br/>        ts_ax = plt.subplot2grid(shape=(2,2), loc=(0,0), colspan=2)<br/>        pacf_ax = plt.subplot2grid(shape=(2,2), loc=(1,0))<br/>        acf_ax = plt.subplot2grid(shape=(2,2), loc=(1,1))<br/>        <br/>        <strong class="of jf">## plot ts with mean/std of a sample from the first x%</strong> <br/>        dtf_ts = ts.to_frame(name="ts")<br/>        sample_size = int(len(ts)*sample)<br/>        dtf_ts["mean"] = dtf_ts["ts"].head(sample_size).mean()<br/>        dtf_ts["lower"] = dtf_ts["ts"].head(sample_size).mean() <br/>                          + dtf_ts["ts"].head(sample_size).std()<br/>        dtf_ts["upper"] = dtf_ts["ts"].head(sample_size).mean() <br/>                          - dtf_ts["ts"].head(sample_size).std()<br/>        dtf_ts["ts"].plot(ax=ts_ax, color="black", legend=False)<br/>        dtf_ts["mean"].plot(ax=ts_ax, legend=False, color="red",<br/>                            linestyle="--", linewidth=0.7)<br/>        ts_ax.fill_between(x=dtf_ts.index, y1=dtf_ts['lower'], <br/>                y2=dtf_ts['upper'], color='lightskyblue', alpha=0.4)<br/>        dtf_ts["mean"].head(sample_size).plot(ax=ts_ax,<br/>                legend=False, color="red", linewidth=0.9)<br/>        ts_ax.fill_between(x=dtf_ts.head(sample_size).index, <br/>                           y1=dtf_ts['lower'].head(sample_size), <br/>                           y2=dtf_ts['upper'].head(sample_size),<br/>                           color='lightskyblue')<br/>        <br/>        <strong class="of jf">## test stationarity (Augmented Dickey-Fuller)</strong><br/>        adfuller_test = sm.tsa.stattools.adfuller(ts, maxlag=maxlag,<br/>                                                  autolag="AIC")<br/>        adf, p, critical_value = adfuller_test[0], adfuller_test[1], <br/>                                 adfuller_test[4]["5%"]<br/>        p = round(p, 3)<br/>        conclusion = "Stationary" if p &lt; 0.05 else "Non-Stationary"<br/>        ts_ax.set_title('Dickey-Fuller Test 95%: '+conclusion+<br/>                        '(p value: '+str(p)+')')<br/>        <br/>        <strong class="of jf">## pacf (for AR) e acf (for MA) </strong><br/>        smt.graphics.plot_pacf(ts, lags=maxlag, ax=pacf_ax, <br/>                 title="Partial Autocorrelation (for AR component)")<br/>        smt.graphics.plot_acf(ts, lags=maxlag, ax=acf_ax,<br/>                 title="Autocorrelation (for MA component)")<br/>        plt.tight_layout()</span></pre><p id="7f10" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">è®©æˆ‘ä»¬è¿è¡Œå®ƒ:</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="240e" class="la lb je of b gy oj ok l ol om"><strong class="of jf">test_stationarity_acf_pacf(</strong>ts, sample=0.20, maxlag=30<strong class="of jf">)</strong></span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ox"><img src="../Images/fde2678e56d360fdaf83ebba1a821e3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ESzcBFAT6h_gYySJPmgbw.png"/></div></div></figure><p id="9421" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">Dickey-Fuller æ£€éªŒçš„ç»“æœè¡¨æ˜ï¼Œæ—¶é—´åºåˆ—å¯èƒ½æ˜¯å¹³ç¨³çš„ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥ä»¥ 95%çš„ç½®ä¿¡åº¦æ‹’ç»éå¹³ç¨³æ€§çš„é›¶å‡è®¾(p å€¼ä¸º 0.015 &lt; Î± of 0.05). However, this does not match with the â€œeye testâ€ as we can see that the time series moves away from the mean after January 2015. Moreover, we couldnâ€™t reject the null hypothesis of non-stationarity with a confidence level of 99% (p-value of 0.015 &gt; Î±ä¸º 0.01)ï¼Œå¹¶ä¸”è‡ªç›¸å…³æ— æ³•æ”¶æ•›åˆ°é›¶ã€‚</p><p id="e371" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">åœ¨<strong class="ly jf">å¯¹æ—¶é—´åºåˆ—</strong>è¿›è¡Œå·®åˆ†åï¼Œæˆ‘ä»¬å°†è¿è¡Œç›¸åŒçš„æµ‹è¯•ã€‚å·®å¼‚å¯ä»¥é€šè¿‡æ¶ˆé™¤è§‚å¯Ÿæ°´å¹³çš„å˜åŒ–æ¥å¸®åŠ©ç¨³å®šå¹³å‡å€¼ï¼Œä»è€Œæ¶ˆé™¤(æˆ–å‡å°‘)è¶‹åŠ¿å’Œå­£èŠ‚æ€§ã€‚åŸºæœ¬ä¸Šï¼Œæˆ‘ä»¬å°†åº”ç”¨ä»¥ä¸‹è½¬æ¢:</p><blockquote class="pd"><p id="16c8" class="pe pf je bd pg ph pi pj pk pl pm mo dk translated">diff[t] = y[t] â€” y[t æ»å]</p></blockquote><p id="7eed" class="pw-post-body-paragraph lw lx je ly b lz pn kf mb mc po ki me lj pp mg mh ln pq mj mk lr pr mm mn mo im bi translated">ç°åœ¨è®©æˆ‘ä»¬å°è¯•ç”¨ 1 ä¸ªæ»åæ¥åŒºåˆ†æ—¶é—´åºåˆ—ï¼Œå¹¶å†æ¬¡è¿è¡Œä¹‹å‰çš„å‡½æ•°</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="1fb4" class="la lb je of b gy oj ok l ol om">diff_ts = ts - ts.shift(1)<br/>diff_ts = diff_ts[(pd.notnull(diff_ts))]</span><span id="3234" class="la lb je of b gy on ok l ol om"><strong class="of jf">test_stationarity_acf_pacf(</strong>diff_ts, sample=0.20, maxlag=30<strong class="of jf">)</strong></span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ps"><img src="../Images/467d949f99a8070fcb859dfe8322b3a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z1WF3loqXl_V0tg_W6yvKA.png"/></div></div></figure><p id="0efc" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ 95%å’Œ 99%çš„ç½®ä¿¡åº¦æ‹’ç»éå¹³ç¨³æ€§çš„é›¶å‡è®¾(p å€¼ä¸º 0.000)ã€‚æˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼Œæœ€å¥½å‡è®¾æ—¶é—´åºåˆ—ä¸æ˜¯å¹³ç¨³çš„ã€‚</p><p id="7043" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">å…³äºè‡ªç›¸å…³å›¾ï¼Œæ˜¾ç„¶æ¯ 2 å¤©æœ‰ä¸€ä¸ªè´Ÿçš„å­£èŠ‚æ€§ï¼Œè¿™æ„å‘³ç€åœ¨ä¸€å‘¨çš„å¼€å§‹æœ‰è¾ƒå°‘çš„é”€å”®ï¼Œæ¯ 7 å¤©æœ‰ä¸€ä¸ªæ­£çš„å­£èŠ‚æ€§(å‘¨æœ«æœ‰æ›´å¤šçš„é”€å”®)ã€‚</p><h2 id="c752" class="la lb je bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">å­£èŠ‚æ€§åˆ†æ</h2><p id="2286" class="pw-post-body-paragraph lw lx je ly b lz ma kf mb mc md ki me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated"><a class="ae ne" href="https://stats.oecd.org/glossary/detail.asp?ID=6695" rel="noopener ugc nofollow" target="_blank">å­£èŠ‚æ€§æˆåˆ†æ˜¯æ—¶é—´åºåˆ—ä¸­çš„å˜åŒ–éƒ¨åˆ†ï¼Œä»£è¡¨å¹´å†…æ³¢åŠ¨ï¼Œåœ¨æ—¶é—´ã€æ–¹å‘å’Œå¹…åº¦æ–¹é¢å¹´å¤ä¸€å¹´æˆ–å¤šæˆ–å°‘æ˜¯ç¨³å®šçš„ã€‚</a></p><p id="1ea9" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">æœ€åä¸€éƒ¨åˆ†çš„ç›®æ ‡æ˜¯äº†è§£å“ªç§å­£èŠ‚æ€§å½±å“æ•°æ®(å¦‚æœæ¯ 7 å¤©å‡ºç°ä¸€æ¬¡æ³¢åŠ¨ï¼Œåˆ™ä¸ºæ¯å‘¨å­£èŠ‚æ€§ï¼›å¦‚æœæ¯ 30 å¤©å‡ºç°ä¸€æ¬¡æ³¢åŠ¨ï¼Œåˆ™ä¸ºæ¯æœˆå­£èŠ‚æ€§ï¼Œä»¥æ­¤ç±»æ¨)ã€‚</p><p id="28b9" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">è¿™å¯¹äºåˆ†æä¼šè®®ä¹‹åçš„æ¨¡å‹è®¾è®¡éƒ¨åˆ†è‡³å…³é‡è¦ã€‚ç‰¹åˆ«æ˜¯ï¼Œå½“ä½¿ç”¨å­£èŠ‚æ€§è‡ªå›å½’æ¨¡å‹æ—¶ï¼Œæ‚¨å¿…é¡»æŒ‡å®šæ¯ä¸ªå­£èŠ‚çš„è§‚å¯Ÿæ¬¡æ•°:æˆ‘è¯´çš„æ˜¯<strong class="ly jf"> SARIMA (pï¼ŒDï¼Œq)x(Pï¼ŒDï¼ŒQï¼Œs) </strong>ä¸­çš„å‚æ•°<strong class="ly jf">â€œsâ€</strong>ã€‚</p><p id="a7bb" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">åœ¨<a class="ae ne" href="https://www.statsmodels.org/dev/generated/statsmodels.tsa.seasonal.seasonal_decompose.html" rel="noopener ugc nofollow" target="_blank"> statsmodel åº“</a>ä¸­æœ‰ä¸€ä¸ªè¶…çº§æœ‰ç”¨çš„å‡½æ•°ï¼Œå…è®¸æˆ‘ä»¬<a class="ae ne" href="https://en.wikipedia.org/wiki/Decomposition_of_time_series" rel="noopener ugc nofollow" target="_blank">åˆ†è§£æ—¶é—´åºåˆ—</a>ã€‚è¯¥å‡½æ•°å°†æ•°æ®åˆ†ä¸º 3 ä¸ªéƒ¨åˆ†:è¶‹åŠ¿ã€å­£èŠ‚æ€§å’Œæ®‹å·®ã€‚</p><p id="fe82" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">è®©æˆ‘ä»¬ç”¨ 7 å¤©çš„å­£èŠ‚æ€§æ¥ç»˜åˆ¶æ—¶é—´åºåˆ—çš„åˆ†è§£å›¾</p><pre class="oa ob oc od gt oe of og oh aw oi bi"><span id="8376" class="la lb je of b gy oj ok l ol om">decomposition = <strong class="of jf">smt.seasonal_decompose(</strong>ts, freq=7<strong class="of jf">)</strong><br/>trend = decomposition.trend<br/>seasonal = decomposition.seasonal<br/>residual = decomposition.resid   <br/>fig, ax = plt.subplots(nrows=4, ncols=1, sharex=True, sharey=False)<br/>ax[0].plot(ts)<br/>ax[0].set_title('Original')<br/>ax[0].grid(True) <br/>ax[1].plot(trend)<br/>ax[1].set_title('Trend')<br/>ax[1].grid(True)  <br/>ax[2].plot(seasonal)<br/>ax[2].set_title('Seasonality')<br/>ax[2].grid(True)  <br/>ax[3].plot(residual)<br/>ax[3].set_title('Residuals')<br/>ax[3].grid(True)</span></pre><figure class="oa ob oc od gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pt"><img src="../Images/3772b0f1adf1f60a7a30a407db65d635.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UL3RjP3aLQMct3XRVBDRBA.png"/></div></div></figure><p id="0994" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">æˆ‘é€šå¸¸é€‰æ‹©å¯¼è‡´è¾ƒå°æ®‹å·®çš„å­£èŠ‚æ€§å‚æ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°è¯•ä½¿ç”¨ 2 å¤©ã€7 å¤©å’Œ 30 å¤©ï¼Œæ¯å‘¨å­£èŠ‚æ€§(s = 7)çš„ç»“æœæ›´å¥½ã€‚</p><h2 id="9748" class="la lb je bd lc ld le dn lf lg lh dp li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">ç»“è®º</h2><p id="d2fa" class="pw-post-body-paragraph lw lx je ly b lz ma kf mb mc md ki me lj mf mg mh ln mi mj mk lr ml mm mn mo im bi translated">æœ¬æ–‡æ˜¯ä¸€ç¯‡æ•™ç¨‹ï¼Œè®²è¿°åœ¨å¼€å§‹æ„å»ºé¢„æµ‹æ¨¡å‹ä¹‹å‰ï¼Œå¦‚ä½•ä½¿ç”¨ç»Ÿè®¡å’Œæœºå™¨å­¦ä¹ æ¥åˆ†æç°å®ä¸–ç•Œçš„æ—¶é—´åºåˆ—ã€‚è¿™ç§åˆ†æçš„ç»“æœå¯¹äºè®¾è®¡èƒ½å¤Ÿå¾ˆå¥½åœ°é€‚åº”æ—¶é—´åºåˆ—çš„æ¨¡å‹æ˜¯æœ‰ç”¨çš„(è¿™å°†åœ¨ä¸‹ä¸€ä¸ªæ•™ç¨‹ä¸­å®Œæˆï¼Œé¡¶éƒ¨çš„é“¾æ¥)ã€‚ç‰¹åˆ«æ˜¯:</p><ul class=""><li id="2bbe" class="mv mw je ly b lz mp mc mq lj mx ln my lr mz mo na nb nc nd bi translated">æˆ‘ä»¬å¯ä»¥åœ¨é¢„æµ‹æ¨¡å‹ä¸­åŠ å…¥çº¿æ€§è¶‹åŠ¿æˆåˆ†</li><li id="12ed" class="mv mw je ly b lz nf mc ng lj nh ln ni lr nj mo na nb nc nd bi translated">æˆ‘ä»¬å¯ä»¥åœ¨åŒ…å«å¼‚å¸¸å€¼çš„åŸå§‹æ•°æ®å’Œä¸åŒ…å«å¼‚å¸¸å€¼çš„å·²å¤„ç†æ•°æ®ä¸Šè®­ç»ƒæ¨¡å‹ï¼Œå¹¶æµ‹è¯•å“ªä¸€ä¸ªè¡¨ç°æ›´å¥½</li><li id="447f" class="mv mw je ly b lz nf mc ng lj nh ln ni lr nj mo na nb nc nd bi translated">æˆ‘ä»¬çŸ¥é“æ—¶é—´åºåˆ—ä¸æ˜¯å¹³ç¨³çš„ï¼Œå› æ­¤æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ AR-I-MA æ¨¡å‹è€Œä¸æ˜¯ ARMA æ¨¡å‹</li><li id="290c" class="mv mw je ly b lz nf mc ng lj nh ln ni lr nj mo na nb nc nd bi translated">æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬çš„é¢„æµ‹æ¨¡å‹ä¸­åŒ…å«ä¸€ä¸ªæ¯å‘¨çš„å­£èŠ‚æ€§å› ç´ ã€‚</li></ul><p id="4654" class="pw-post-body-paragraph lw lx je ly b lz mp kf mb mc mq ki me lj mr mg mh ln ms mj mk lr mt mm mn mo im bi translated">æˆ‘å¸Œæœ›ä½ å–œæ¬¢å®ƒï¼å¦‚æœ‰é—®é¢˜å’Œåé¦ˆï¼Œæˆ–è€…åªæ˜¯åˆ†äº«æ‚¨æ„Ÿå…´è¶£çš„é¡¹ç›®ï¼Œè¯·éšæ—¶è”ç³»æˆ‘ã€‚</p><blockquote class="pd"><p id="3199" class="pe pf je bd pg ph pi pj pk pl pm mo dk translated">ğŸ‘‰<a class="ae ne" href="https://linktr.ee/maurodp" rel="noopener ugc nofollow" target="_blank">æˆ‘ä»¬æ¥è¿çº¿</a>ğŸ‘ˆ</p></blockquote></div><div class="ab cl kt ku hx kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="im in io ip iq"><blockquote class="pu pv pw"><p id="2144" class="lw lx mu ly b lz mp kf mb mc mq ki me px mr mg mh py ms mj mk pz mt mm mn mo im bi translated">æœ¬æ–‡æ˜¯ä½¿ç”¨ Python è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹ç³»åˆ—<strong class="ly jf">çš„ä¸€éƒ¨åˆ†</strong>ï¼Œå¦è¯·å‚è§:</p></blockquote><div class="is it gp gr iu nk"><a href="https://medium.com/analytics-vidhya/time-series-forecasting-arima-vs-lstm-vs-prophet-62241c203a3b" rel="noopener follow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd jf gy z fp np fr fs nq fu fw jd bi translated">æ—¶é—´åºåˆ—é¢„æµ‹:ARIMA vs LSTM vs é¢„è¨€å®¶</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">åŸºäºæœºå™¨å­¦ä¹ å’Œ Python çš„æ—¶é—´åºåˆ—é¢„æµ‹</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">medium.com</p></div></div><div class="nt l"><div class="qa l nv nw nx nt ny ja nk"/></div></div></a></div><div class="is it gp gr iu nk"><a href="https://medium.com/analytics-vidhya/time-series-forecasting-with-random-walk-58e84c93058b" rel="noopener follow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd jf gy z fp np fr fs nq fu fw jd bi translated">éšæœºæ¸¸èµ°æ—¶é—´åºåˆ—é¢„æµ‹</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">åŸºäºæœºå™¨å­¦ä¹ å’Œ Python çš„æ—¶é—´åºåˆ—é¢„æµ‹</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">medium.com</p></div></div><div class="nt l"><div class="qb l nv nw nx nt ny ja nk"/></div></div></a></div><div class="is it gp gr iu nk"><a href="https://medium.com/analytics-vidhya/how-to-predict-when-the-covid-19-pandemic-will-stop-in-your-country-with-python-d6fbb2425a9f" rel="noopener follow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd jf gy z fp np fr fs nq fu fw jd bi translated">ç®€å•å‚æ•°æ›²çº¿æ‹Ÿåˆçš„æ—¶é—´åºåˆ—é¢„æµ‹</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">é¢„æµ‹æ–°å† è‚ºç‚ç–«æƒ…ä»€ä¹ˆæ—¶å€™ä¼šåœåœ¨ä½ çš„å›½å®¶</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">medium.com</p></div></div><div class="nt l"><div class="qc l nv nw nx nt ny ja nk"/></div></div></a></div></div></div>    
</body>
</html>