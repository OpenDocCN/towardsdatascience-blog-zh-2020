<html>
<head>
<title>COVID-19 Detector Flask App based on Chest X-rays and CT Scans using Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">新冠肺炎探测器烧瓶应用程序基于使用深度学习的胸部x光和CT扫描</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/covid-19-detector-flask-app-based-on-chest-x-rays-and-ct-scans-using-deep-learning-a0db89e1ed2a?source=collection_archive---------24-----------------------#2020-06-07">https://towardsdatascience.com/covid-19-detector-flask-app-based-on-chest-x-rays-and-ct-scans-using-deep-learning-a0db89e1ed2a?source=collection_archive---------24-----------------------#2020-06-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f4ab" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用四种深度学习算法(VGG16、ResNet50、InceptionV3和Xception)实现基于人工智能的模型和Flask应用程序，以检测胸部X射线和ct扫描中的新冠肺炎</h2></div><p id="7421" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lb">编者按:</em> </strong> <em class="lb"> </em> <a class="ae lc" href="http://towardsdatascience.com/" rel="noopener" target="_blank"> <em class="lb">走向数据科学</em> </a> <em class="lb">是一份以数据科学和机器学习研究为主的中型刊物。我们不是健康专家或流行病学家，本文的观点不应被解释为专业建议。想了解更多关于疫情冠状病毒的信息，可以点击</em> <a class="ae lc" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports" rel="noopener ugc nofollow" target="_blank"> <em class="lb">这里</em> </a> <em class="lb">。</em></p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/773a5bbc0525b7ca3c8e94aa90485cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0eI3k68XEkudWPRz4QKqEw.jpeg"/></div></div><p class="lp lq gj gh gi lr ls bd b be z dk translated"><strong class="bd lt">图1:新型冠状病毒疾病2019 </strong> <a class="ae lc" href="https://media.defense.gov/2020/Mar/03/2002258405/780/780/0/200303-A-TC012-005.JPG" rel="noopener ugc nofollow" target="_blank"> <strong class="bd lt">来源</strong> </a></p></figure><p id="3b70" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">新冠肺炎</strong>，或更通常被称为<strong class="kh ir">新型冠状病毒疾病</strong>是一种高传染性疾病，于2019年底在中国出现。这种疾病是由<a class="ae lc" href="https://en.wikipedia.org/wiki/Severe_acute_respiratory_syndrome_coronavirus_2" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">新型冠状病毒</strong> </a>引起的，一种属于冠状病毒大家族的病毒。该疾病于2019年12月<strong class="kh ir"/>首次起源于<strong class="kh ir">中国武汉</strong>，并很快成为全球疫情，蔓延至超过<strong class="kh ir"> 213 </strong>个国家。</p><p id="ec39" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">新冠肺炎最常见的症状是发烧、干咳和疲倦。人们可能经历的其他症状包括疼痛、疼痛或呼吸困难。这些症状中的大多数都显示出呼吸道感染和肺部异常的迹象，这可以由<strong class="kh ir">放射科医生</strong>检测出来。</p><p id="a842" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，可以使用<strong class="kh ir">机器学习</strong>算法从<strong class="kh ir">胸部x光</strong>和<strong class="kh ir"> CT扫描</strong>的图像中检测疾病。可以创建自动化应用程序来帮助支持放射科医生。本文是对四种深度学习算法的尝试，分别是:<strong class="kh ir"> VGG16、ResNet50、InceptionV3 </strong>和<strong class="kh ir"> Xception </strong>。</p><p id="4892" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">训练和测试模型以及运行Flask应用程序的完整代码可在我的<a class="ae lc" href="https://github.com/kaushikjadhav01/COVID-19-Detection-Flask-App-based-on-Chest-X-rays-and-CT-Scans" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> Github存储库</strong> </a> <strong class="kh ir">上获得。</strong></p><h1 id="eaf9" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">数据集</h1><p id="3cb8" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">该项目的数据集是从两个开源Github存储库中收集的:</p><ol class=""><li id="93bd" class="mr ms iq kh b ki kj kl km ko mt ks mu kw mv la mw mx my mz bi translated"><strong class="kh ir">胸部x光片</strong>图像(1000张图像)从<a class="ae lc" href="https://github.com/ieee8023/covid-chestxray-dataset" rel="noopener ugc nofollow" target="_blank">https://github.com/ieee8023/covid-chestxray-dataset</a>获得</li><li id="0e53" class="mr ms iq kh b ki na kl nb ko nc ks nd kw ne la mw mx my mz bi translated"><strong class="kh ir"> CT扫描</strong>图像(750张图像)从<a class="ae lc" href="https://github.com/UCSD-AI4H/COVID-CT/tree/master/Data-split" rel="noopener ugc nofollow" target="_blank">https://github . com/UCSD-AI4H/COVID-CT/tree/master/Data-split</a>获取</li></ol><p id="3544" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">四个算法:VGG16、ResNet50、InceptionV3和Xception分别在胸部x光和CT扫描上进行训练，给了我们总共8个深度学习模型。<strong class="kh ir"> 80% </strong>的图像用于<strong class="kh ir">训练</strong>模型，剩余的<strong class="kh ir"> 20% </strong>用于<strong class="kh ir">测试</strong>模型的准确性。</p><h1 id="46e2" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">构建模型</h1><p id="7786" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">我首先向预训练模型添加了<strong class="kh ir"> 3个自定义层</strong>，以便它们可以在我们的数据集上进行训练。例如，添加自定义层到<strong class="kh ir"> ResNet50 </strong>模型的代码如下所示。其余模型的代码保持不变。只需将第一行中的ResNet50更改为所需模型的名称。</p><pre class="le lf lg lh gt nf ng nh ni aw nj bi"><span id="4620" class="nk lv iq ng b gy nl nm l nn no">res = ResNet50(weights="imagenet", include_top=False, input_tensor=Input(shape=(224, 224, 3)))<br/>outputs = res.output<br/>outputs = Flatten(name="flatten")(outputs)<br/>outputs = Dropout(0.5)(outputs)<br/>outputs = Dense(2, activation="softmax")(outputs)<br/>model = Model(inputs=res.input, outputs=outputs)<br/>for layer in res.layers:<br/>  layer.trainable = False<br/>model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])</span></pre><p id="0686" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据集中的图像大小不同。因此，我需要将它们调整到固定的大小，然后才能将它们提供给深度学习模型进行训练。我将图片尺寸调整为224 x 224像素，这被认为是ResNet50机型的理想尺寸。因此，我将形状<strong class="kh ir"> (224，224，3) </strong>的输入张量添加到预训练的ResNet50模型中，3为通道数。</p><p id="41ca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，我添加了一个<strong class="kh ir">展平</strong>层来展平我们所有的特征，并添加了一个<strong class="kh ir">脱落</strong>层来克服<strong class="kh ir">过度拟合</strong>。最后，我使用<strong class="kh ir"> softmax函数</strong>作为激活函数，添加了<strong class="kh ir">密集</strong>输出层。由于模型的前半部分已经被预训练，先前层的可训练属性被设置为<strong class="kh ir">假</strong>。最后，我用<strong class="kh ir"> adam优化器</strong>编译模型，并使用<strong class="kh ir">分类交叉熵</strong>作为<strong class="kh ir">损失</strong> <strong class="kh ir">函数</strong>。</p><h1 id="e501" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">训练模型</h1><p id="05b8" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">我首先定义了一个<strong class="kh ir">图像数据生成器</strong>来训练模型修改版本的图像，比如不同的角度、翻转、旋转或移位。</p><pre class="le lf lg lh gt nf ng nh ni aw nj bi"><span id="80f4" class="nk lv iq ng b gy nl nm l nn no">train_aug = ImageDataGenerator(rotation_range=20, width_shift_range=0.2, height_shift_range=0.2, horizontal_flip=True)</span></pre><p id="0dab" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">接下来，执行模型的训练，所有需要的参数指定如下:</p><pre class="le lf lg lh gt nf ng nh ni aw nj bi"><span id="3129" class="nk lv iq ng b gy nl nm l nn no">history = model.fit(train_aug.flow(X_train, y_train, batch_size=32),validation_data=(X_test,y_test),validation_steps=len(X_test) / 32, steps_per_epoch=len(X_train) / 32, epochs=500)</span></pre><p id="d33f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如你所见，我已经用<strong class="kh ir"> 32张图像</strong>的批量为<strong class="kh ir"> 500个纪元</strong>训练了模型。</p><h1 id="8fe8" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">做预测</h1><p id="077f" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">通过在测试集的图像上运行训练的模型来生成预测。数据集前10幅图像的预测绘制如下:</p><pre class="le lf lg lh gt nf ng nh ni aw nj bi"><span id="a090" class="nk lv iq ng b gy nl nm l nn no">y_pred = model.predict(X_test, batch_size=batch_size)<br/>prediction=y_pred[0:10]<br/>for index, probability in enumerate(prediction):<br/>  if probability[1] &gt; 0.5:<br/>    plt.title('%.2f' % (probability[1]*100) + '% COVID')<br/>  else:<br/>    plt.title('%.2f' % ((1-probability[1])*100) + '% NonCOVID')<br/>  plt.imshow(X_test[index])<br/>  plt.show()</span></pre><p id="78a2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下片段显示了胸部X射线的前10个预测图:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi np"><img src="../Images/acec6b17513ff81e1e8f31b9567ac60e.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*FNALqHaMzZ6e5NUeWHZBfA.png"/></div><p class="lp lq gj gh gi lr ls bd b be z dk translated"><strong class="bd lt">图2:可视化胸部X射线的前10个预测</strong></p></figure><h1 id="c2bd" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">机器学习的评估和结果</h1><p id="4135" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">以下是一些重要的结果和图表，有助于估计模型的准确性并了解其性能。</p><h2 id="57b1" class="nk lv iq bd lw nq nr dn ma ns nt dp me ko nu nv mg ks nw nx mi kw ny nz mk oa bi translated">测试集图像的输出示例</h2><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/c68f979bfe5b049534325fd2dbdcae27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*kfHfwkZ_A3SV8PgF1dYwyA.png"/></div><p class="lp lq gj gh gi lr ls bd b be z dk translated"><strong class="bd lt">图3:测试集图像的样本输出</strong></p></figure><h2 id="0a3b" class="nk lv iq bd lw nq nr dn ma ns nt dp me ko nu nv mg ks nw nx mi kw ny nz mk oa bi translated">分类报告</h2><p id="2902" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">VGG16型胸部X线和CT扫描分类报告</p><div class="le lf lg lh gt ab cb"><figure class="oc li od oe of og oh paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><img src="../Images/c69cfcac6269f8a91d0487b4e3ac9583.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*nR__AWt8HNI4wSAPV1nTcw.png"/></div></figure><figure class="oc li oi oe of og oh paragraph-image"><img src="../Images/595ea21f1169de2ccbf5735c2ed76ddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*6IlkpAumgqf5sZyJAayr7w.png"/><p class="lp lq gj gh gi lr ls bd b be z dk oj di ok ol translated"><strong class="bd lt">图VGG16模型胸片(左)和CT扫描(右)分类报告</strong></p></figure></div><p id="90cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ResNet50型胸部X线和CT扫描分类报告</p><div class="le lf lg lh gt ab cb"><figure class="oc li om oe of og oh paragraph-image"><img src="../Images/89f04f89b52a6dd8d39ac474fb908116.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*_Lkj81PdgJ9n7h-yjRznzw.png"/></figure><figure class="oc li on oe of og oh paragraph-image"><img src="../Images/c7a91ae8a0a2eb4f101fea85870c77dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*CoGo8smV8aXoCnRpHQUv-g.png"/><p class="lp lq gj gh gi lr ls bd b be z dk oo di op ol translated"><strong class="bd lt">图ResNet50型号胸片(左)和CT扫描(右)分类报告</strong></p></figure></div><p id="a2bd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">胸部X线和CT扫描的InceptionV3模型分类报告</p><div class="le lf lg lh gt ab cb"><figure class="oc li om oe of og oh paragraph-image"><img src="../Images/256147c1db575a47b7cec70aa828d0b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*EatgjI72Ozl_2e24eHp2bA.png"/></figure><figure class="oc li on oe of og oh paragraph-image"><img src="../Images/ff70cae1f29fe94df5c4bba027aac2ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*JrDKE1yQq9alJspqhJ7RIg.png"/><p class="lp lq gj gh gi lr ls bd b be z dk oo di op ol translated"><strong class="bd lt">图6:胸部x光(左)和CT扫描(右)的InceptionV3模型分类报告</strong></p></figure></div><p id="2cce" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">胸部X线和CT扫描异常模型分类报告</p><div class="le lf lg lh gt ab cb"><figure class="oc li oq oe of og oh paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><img src="../Images/a228ef72403b5f56e23ef4b644b7d6a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*-Zn9X7tn61BiTpMhD86viQ.png"/></div></figure><figure class="oc li or oe of og oh paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><img src="../Images/e1a6efcc08b393cf79ea7c33472bdcfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*a5btMUNz5f5yTPYPvcxfUQ.png"/></div><p class="lp lq gj gh gi lr ls bd b be z dk os di ot ol translated"><strong class="bd lt">图7:X线胸片(左)和CT扫描(右)异常模型分类报告</strong></p></figure></div><h2 id="d5a0" class="nk lv iq bd lw nq nr dn ma ns nt dp me ko nu nv mg ks nw nx mi kw ny nz mk oa bi translated">混淆矩阵</h2><p id="48b1" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">用于胸部X线和CT扫描的VGG16模型的混淆矩阵</p><div class="le lf lg lh gt ab cb"><figure class="oc li ou oe of og oh paragraph-image"><img src="../Images/a5cb6fef6a4109060e6a34cbcf59349b.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*gC5i7BDWlo-H00XFJVF9qA.png"/></figure><figure class="oc li ov oe of og oh paragraph-image"><img src="../Images/06fa541ce0caa65bf856fc6b8f475713.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*BS6OtMeNbr9aYLEJK4VSdw.png"/><p class="lp lq gj gh gi lr ls bd b be z dk oo di op ol translated"><strong class="bd lt">图8:胸片(左)和CT扫描(右)的VGG16模型混淆矩阵</strong></p></figure></div><p id="ec78" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ResNet50胸部X线和CT扫描模型的混淆矩阵</p><div class="le lf lg lh gt ab cb"><figure class="oc li ow oe of og oh paragraph-image"><img src="../Images/5d13e84956adf8087252d38268d4bb4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*7vsVTag3WuKMHLXo4YD_tA.png"/></figure><figure class="oc li ox oe of og oh paragraph-image"><img src="../Images/a8774e994ed07a2a5660b3113486256a.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*LUVSQhWueKKpUalJmTGODA.png"/><p class="lp lq gj gh gi lr ls bd b be z dk oy di oz ol translated"><strong class="bd lt">图ResNet50模型胸部x光(左)和CT扫描(右)的混淆矩阵</strong></p></figure></div><p id="3af5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">胸部X线和CT扫描的概念模型混淆矩阵</p><div class="le lf lg lh gt ab cb"><figure class="oc li pa oe of og oh paragraph-image"><img src="../Images/6cd99ec5c48f5f7ec95770e02894b657.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*jLpZvuL_unlOZ0Oz8TxVDg.png"/></figure><figure class="oc li pb oe of og oh paragraph-image"><img src="../Images/22bac1af0c1f502849f26e80ff59adfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*fjVzURC8dGHid17DvwiKzw.png"/><p class="lp lq gj gh gi lr ls bd b be z dk pc di pd ol translated"><strong class="bd lt">图10:胸部x光(左)和CT扫描(右)的InceptionV3模型的混淆矩阵</strong></p></figure></div><p id="0cf0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">胸部X线和CT扫描异常模型的混淆矩阵</p><div class="le lf lg lh gt ab cb"><figure class="oc li pe oe of og oh paragraph-image"><img src="../Images/801a69b2aab291b952a75900fafb79f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*XcHTvSram5Qyy_OAcLcLQg.png"/></figure><figure class="oc li pf oe of og oh paragraph-image"><img src="../Images/55a2132780aba42e57ac0876f1e7a7bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/format:webp/1*8HLffnPXFbP9WXZ-VJ6tCw.png"/><p class="lp lq gj gh gi lr ls bd b be z dk oj di ok ol translated"><strong class="bd lt">图11:胸部x光(左)和CT扫描(右)的异常模型的混淆矩阵</strong></p></figure></div><h1 id="27b8" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">构建Flask应用程序</h1><p id="a99b" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">现在，我使用目前为止我创建的代码，通过在某些flask函数中粘贴特定的代码段来构建Flask应用程序。例如，使用四个模型来生成胸部X射线预测的代码如下所示:</p><pre class="le lf lg lh gt nf ng nh ni aw nj bi"><span id="a1c1" class="nk lv iq ng b gy nl nm l nn no">def uploaded_chest():<br/>   resnet_chest = load_model('models/resnet_chest.h5')<br/>   vgg_chest = load_model('models/vgg_chest.h5')<br/>   inception_chest = load_model('models/inceptionv3_chest.h5')<br/>   xception_chest = load_model('models/xception_chest.h5')</span><span id="bf9b" class="nk lv iq ng b gy pg nm l nn no">   image = cv2.imread('./flask app/assets/images/upload_chest.jpg') <br/>   # read file <br/>   image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB) <br/>   # arrange format as per keras<br/>   image = cv2.resize(image,(224,224))<br/>   image = np.array(image) / 255<br/>   image = np.expand_dims(image, axis=0)<br/>   <br/>   resnet_pred = resnet_chest.predict(image)<br/>   probability = resnet_pred[0]<br/>   print("Resnet Predictions:")<br/>   if probability[0] &gt; 0.5:<br/>      resnet_chest_pred = str('%.2f' % (probability[0]*100) + '% COVID') <br/>   else:<br/>      resnet_chest_pred = str('%.2f' % ((1-probability[0])*100) + '% NonCOVID')<br/>   print(resnet_chest_pred)</span><span id="b5f8" class="nk lv iq ng b gy pg nm l nn no">   vgg_pred = vgg_chest.predict(image)<br/>   probability = vgg_pred[0]<br/>   print("VGG Predictions:")<br/>   if probability[0] &gt; 0.5:<br/>      vgg_chest_pred = str('%.2f' % (probability[0]*100) + '% COVID') <br/>   else:<br/>      vgg_chest_pred = str('%.2f' % ((1-probability[0])*100) + '% NonCOVID')<br/>   print(vgg_chest_pred)</span><span id="8245" class="nk lv iq ng b gy pg nm l nn no">   inception_pred = inception_chest.predict(image)<br/>   probability = inception_pred[0]<br/>   print("Inception Predictions:")<br/>   if probability[0] &gt; 0.5:<br/>      inception_chest_pred = str('%.2f' % (probability[0]*100) + '% COVID') <br/>   else:<br/>      inception_chest_pred = str('%.2f' % ((1-probability[0])*100) + '% NonCOVID')<br/>   print(inception_chest_pred)</span><span id="cfb1" class="nk lv iq ng b gy pg nm l nn no">xception_pred = xception_chest.predict(image)<br/>   probability = xception_pred[0]<br/>   print("Xception Predictions:")<br/>   if probability[0] &gt; 0.5:<br/>      xception_chest_pred = str('%.2f' % (probability[0]*100) + '% COVID') <br/>   else:<br/>      xception_chest_pred = str('%.2f' % ((1-probability[0])*100) + '% NonCOVID')<br/>   print(xception_chest_pred)<br/>   return render_template('results_chest.html',resnet_chest_pred=resnet_chest_pred,vgg_chest_pred=vgg_chest_pred,inception_chest_pred=inception_chest_pred,xception_chest_pred=xception_chest_pred)</span></pre><h2 id="46b4" class="nk lv iq bd lw nq nr dn ma ns nt dp me ko nu nv mg ks nw nx mi kw ny nz mk oa bi translated">Flask App截图</h2><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ph"><img src="../Images/819f20d009b7fd74914f6a2981be8e6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-B3DHg1ExqABAYD08zkaGQ.png"/></div></div></figure><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi pi"><img src="../Images/5fe4ecbebae162f6e0d5f31dea724e12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RyQG94tnWHG85Q2GdQF-1g.png"/></div></div></figure><h1 id="34a4" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">源代码</h1><p id="3200" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">整个项目的源代码以及数据集、模型和flask应用程序都可以在我的<a class="ae lc" href="https://github.com/kaushikjadhav01/COVID-19-Detection-Flask-App-based-on-Chest-X-rays-and-CT-Scans/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> Github repo上找到。</strong>T3】</a></p><h1 id="2b43" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">结论</h1><p id="6251" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">最后，我想说明一个事实，即分析是在有限的数据集上进行的，结果是初步的。该方法尚未进行医学验证，因此结果可能与实际使用案例中观察到的结果不同。</p><p id="94c6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在未来，我计划通过在更多的图像上训练模型来提高它们的性能，并可能包括其他因素，如年龄、国籍、性别等。此外，我鼓励本文的读者自己尝试代码，以提高模型的精度。</p><p id="8f1b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你觉得这篇文章有用，请随意与他人分享。非常感谢您的阅读。注意安全！</p><p id="3682" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lb">注意——我不是医学背景，这个项目是为了概念的演示而开发的。</em> </strong></p><p id="dd66" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请随时在其他平台上与我联系:</p><p id="f621" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">github—<a class="ae lc" href="https://github.com/kaushikjadhav01" rel="noopener ugc nofollow" target="_blank">https://github.com/kaushikjadhav01</a></p><p id="8626" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">LinkedIn—<a class="ae lc" href="https://www.linkedin.com/in/kaushikjadhav01/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/kaushikjadhav01/</a></p></div></div>    
</body>
</html>