<html>
<head>
<title>How to Avoid Potential Machine Learning Pitfalls</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何避免潜在的机器学习陷阱</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-avoid-potential-machine-learning-pitfalls-a08781f3518e?source=collection_archive---------51-----------------------#2020-06-29">https://towardsdatascience.com/how-to-avoid-potential-machine-learning-pitfalls-a08781f3518e?source=collection_archive---------51-----------------------#2020-06-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f081" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">理解并防止机器学习管道中固有的某些常见缺陷</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/240bfdd3b4f734977b8d6a7fac1e0f87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZHJLTa-Lj4UVeZrp"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">迈克尔·波德格在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="684b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> T </span>他的帖子是写给那些最近加入机器学习潮流的数据科学爱好者的。无论你是在大学里学习数据科学，还是自学成才，大多数有抱负的数据科学家在实际环境中尝试机器学习项目时，都会受到现实的检验。</p><p id="5cb4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我自己也曾与以下大部分潜在的绊脚石作斗争，但正如理查德·布兰森简洁地指出的:</p><blockquote class="me"><p id="1091" class="mf mg it bd mh mi mj mk ml mm mn lu dk translated">你不能循规蹈矩地学习走路。你通过实践和跌倒来学习。</p></blockquote><p id="740a" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">这里讨论的潜在缺陷会影响模型的准确性，并且一旦用于分析实时数据，还会影响模型的性能。人们通过实践学习这些东西，很快，当开发机器学习管道时，所有这些都将成为你的第二天性。我将尽可能让这篇文章实用，以便在从事实际的机器学习项目时，它可以作为一种清单。</p><p id="a65c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">简单回顾一下，<strong class="lb iu">机器学习管道</strong>包括机器学习项目中的所有单个工作流，包括但不限于:数据收集、探索性数据分析(EDA)、特征选择、特征工程、为训练准备干净的数据、训练/测试/验证数据分割、模型选择、训练&amp;验证、生产部署和模型监控。</p><p id="5309" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以事不宜迟，让我们开始吧:</p><h1 id="7e0c" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">取样偏差</h1><p id="1a85" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">数据收集是任何机器学习项目的第一步，它充满了潜在的绊脚石，最关键的是采样偏差。简而言之，有偏样本是指在根据样本统计推断总体参数时，不能代表整个总体的样本，从而导致系统误差。</p><p id="15ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="http://www.scholarpedia.org/article/Sampling_bias" rel="noopener ugc nofollow" target="_blank">采样偏差</a>可以通过多种方式引入数据集，包括关注特定的真实区域(郊区、城市、乡村、大学等)。)only，自我选择偏差，排除偏差，生存偏差等。</p><p id="fb2c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预防策略</strong>:虽然收集一个完全无偏见的数据集有时可能有点棘手，但是，可以调整数据收集策略，以确保尽可能公正的样本。例如，数据收集应该纯粹是一种随机行为，每个数据点都有平等的机会被选中；使用来自内部数据库的整个数据集；避免数据收集过程中的判断、便利或成本因素等。</p><h1 id="4ef5" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">数据清理</h1><p id="df03" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">处理输入要素中的缺失值是任何机器学习项目的关键组成部分，因为在实际设置中很少会有干净的数据集可供处理。处理缺失值的一种简单方法是丢弃所有缺失值的观测值，或者通过统计参数(如平均值、中值或众数)对其进行估算。但是，如果丢失的值真的是由设计或数据收集逻辑造成的呢？</p><p id="32c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预防策略</strong>:利用领域知识和主题专业知识理解数据集中缺失值的性质、原因和方式。只有这样，一旦你掌握了这些知识，就可以相应地利用适当的插补技术——可以是丢弃观察值，使用均值/中值/众数，或者应用专门用于插补目的的另一种 ML 算法，等等。</p><h1 id="7daf" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">不适当的特征选择</h1><p id="9a87" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">特征工程和特征选择通常被吹捧为任何数据科学项目的支柱，因为模型验证和实际模型性能严重依赖于它们。为此，一些 ML 实践者陷入了对理想特征的追求，以至于他们无意中选择了不相关的特征作为模型训练的目的。</p><p id="c46b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预防策略</strong>:这是深度领域知识派上用场的地方，以识别和选择只适合模型训练的特征。如果数据科学家缺乏深入的领域和行业知识，也可以利用主题专家。</p><h1 id="4c0f" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">数据泄露</h1><p id="8873" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">ML 算法通常应用于训练数据集，然后在测试/保留数据集上进行验证。为此，完整的数据集被分成 2 个(有时是 3 个)集合，每个集合用于训练、测试(和验证)。如果所有的数据转换和准备步骤都在拆分前应用，那么很有可能在模型训练期间已经使用了来自测试数据集的一些信息。这种数据泄漏导致过度拟合，并且通常导致过度乐观和无效的模型。</p><p id="5436" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">作为一个简单的例子，考虑这样一个场景，我们通过使用变量的平均值来估算缺失值。如果我们使用整个数据集进行插补，那么我们的假设值也将基于测试数据集的值。测试数据集应该代表看不见的真实数据；因此，使用这些在生产中不可用的信息将导致模型偏差和过度拟合。</p><p id="b382" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预防策略</strong>:简单，在应用任何数据准备、转换、特征选择、降维、特征工程技术之前，将数据集分成训练集和测试集。所有这些技术应该分别应用于训练和测试数据集。</p><h1 id="b552" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">走向未来</h1><p id="5580" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">这一点是前两点的直接延续。在目标变量中的事件发生之前，您可能遇到的一些输入变量是无法观察到的。例如，直到客户拖欠贷款时才能知道 amount_recovered(用于预测贷款拖欠的模型)，或者直到航班着陆时才能确定航班时间(用于预测航班延误的模型)。</p><p id="b98b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预防策略</strong>:只要不使用任何这样的特征进行模型训练，在目标变量被观察到之前不可能发生。</p><h1 id="ecd3" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">需要时没有规范化或标准化</h1><p id="dfd9" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">依赖于某种距离度量(例如，线性回归、SVM、kNN)的机器学习算法对度量尺度高度敏感，因为它们假设所有特征都在同一尺度上。因此，与其他数据(例如，年龄)相比，这些算法将为数值较大的数据(例如，年度支出)分配较高的权重。这显然是不可取的。</p><p id="b31f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预防策略</strong>:在模型训练之前，对你的数据集应用某种统计变换，例如<a class="ae ky" href="https://statisticsbyjim.com/glossary/standardization/" rel="noopener ugc nofollow" target="_blank">标准化</a>或<a class="ae ky" href="https://en.wikipedia.org/wiki/Normalization_(statistics)" rel="noopener ugc nofollow" target="_blank">规范化</a>，使所有变量处于一个等价的尺度上。请注意，这仅在使用假设统一测量比例的算法时需要。</p><h1 id="48b6" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">异常值的处理</h1><p id="afc9" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">离群值是在特定数据集的上下文中不正常的单个数据点，但在现实生活中并不少见。每个最大似然算法处理它们的方式不同，应该小心识别和处理数据集中的异常值。某些算法适当地处理异常值(大多数基于树的方法都这样做，例如随机森林，XGBoost)。相比之下，线性回归等其他方法更容易受到它们的影响，并试图相应地拟合模型(也称为过度拟合)。</p><p id="57bd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预防策略</strong>:通过绘图(例如，盒须图)或统计技术(<a class="ae ky" href="https://en.wikipedia.org/wiki/Standard_score" rel="noopener ugc nofollow" target="_blank"> Z 值</a>)，始终识别数据中的任何异常值。然后或者使用适当处理异常值的算法(例如，基于树的算法)，消除异常值，或者应用<a class="ae ky" href="https://en.wikipedia.org/wiki/Winsorizing" rel="noopener ugc nofollow" target="_blank"> winsorization 技术</a>。</p><h1 id="bb26" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">多重共线性</h1><p id="3603" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">多重共线性是指两个或多个输入要素彼此高度相关的情况，即它们都以某种方式以相似的方式预测目标变量。这可能导致不利的后果，即模型不收敛，或者预测值的统计显著性被破坏。多重共线性通常发生在为分类变量创建哑变量而没有删除其中一个哑变量时，例如，性别 _ 男性和性别 _ 女性哑变量共线，因此任何一个哑变量都可以用于识别一个人的性别。</p><p id="6088" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预防策略</strong>:通过计算所有独立变量的成对相关系数(通过相关矩阵或<a class="ae ky" href="https://en.wikipedia.org/wiki/Variance_inflation_factor" rel="noopener ugc nofollow" target="_blank">变异膨胀因子</a>)来识别多重共线性，然后通过主成分分析或其他方法删除其中一个冗余变量或合并相关变量。</p><h1 id="7a52" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">不平衡数据的验证指标</h1><p id="66e1" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">有几个验证指标，但并不是所有的都与不平衡数据相关。识别和应用合适的验证指标对于不平衡数据至关重要，否则，我们将错误地依赖模型的稳健性。</p><p id="e6a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑欺诈检测的示例，其中训练数据集仅包含 2%的欺诈案例。天真地使用准确性指标并不能代表模型的真实预测能力。换句话说，如果我将所有的测试/现实案例都归类为非违约，那么我有 98%的正确率。</p><p id="0aca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">预防策略</strong>:使用更适合不平衡数据的验证指标，如<a class="ae ky" href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="noopener ugc nofollow" target="_blank">精度</a>、<a class="ae ky" href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="noopener ugc nofollow" target="_blank">召回</a>、<a class="ae ky" href="https://en.wikipedia.org/wiki/F1_score" rel="noopener ugc nofollow" target="_blank"> F1 分数</a>、<a class="ae ky" href="https://machinelearningmastery.com/roc-curves-and-precision-recall-curves-for-imbalanced-classification/" rel="noopener ugc nofollow" target="_blank">精度-召回(PR)曲线</a>、<a class="ae ky" href="https://machinelearningmastery.com/roc-curves-and-precision-recall-curves-for-imbalanced-classification/" rel="noopener ugc nofollow" target="_blank">受试者操作特征(AUROC)曲线下面积</a>、<a class="ae ky" href="https://en.wikipedia.org/wiki/Gini_coefficient#Relation_to_other_statistical_measures" rel="noopener ugc nofollow" target="_blank">基尼指数</a>。</p><h1 id="c4c8" class="mt mu it bd mv mw mx my mz na nb nc nd jz ne ka nf kc ng kd nh kf ni kg nj nk bi translated">结论</h1><p id="30e4" class="pw-post-body-paragraph kz la it lb b lc nl ju le lf nm jx lh li nn lk ll lm no lo lp lq np ls lt lu im bi translated">这就对了——注意上面的潜在陷阱，你将会在机器学习的道路上走得很好。</p><p id="2574" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想讨论任何与数据分析、预测分析和信用/财务评估相关的问题，请随时联系我。</p></div></div>    
</body>
</html>