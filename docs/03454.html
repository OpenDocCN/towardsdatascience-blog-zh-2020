<html>
<head>
<title>Code Gradient Descent From Scratch · Britts &amp; Bytes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">代码梯度下降从零开始字节和字节</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/code-gradient-descent-from-scratch-britts-bytes-e9f4a36a9955?source=collection_archive---------47-----------------------#2020-04-01">https://towardsdatascience.com/code-gradient-descent-from-scratch-britts-bytes-e9f4a36a9955?source=collection_archive---------47-----------------------#2020-04-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d97f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">如何用 python 从零开始编程梯度下降？那段时间你在面试中笨手笨脚。</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/8945ded518806cf71ac7188fd154f019.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lWWZue9UyUB6B3Xztnet6w.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">土壤中的物理和化学梯度很大程度上影响着稻田的生长和小气候</p></figure><h1 id="e09d" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">动机</h1><p id="fec1" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这就是了。你已经通过向完全陌生的人发送大约 10 条 LinkedIn 信息，并通过总结你整个成年职业生涯的 30 分钟电话来吸引招聘人员，从而建立了人际关系网。他们给你送来了……敦敦敦……任务。他们说 4 个小时。短短 4 个小时。“4 个小时”，你对自己说“小菜一碟”。这封电子邮件附带了一个指向谷歌说明文档的链接。“就两个提示”你再想想，“完全没问题。打赌我会有时间。”你打开作业。那里。第一张谷歌表单上写着“请最小化这个未知函数”。你的大脑一片黑暗，你在考虑自己是否能通过五年级的数学考试。</p><h1 id="22ec" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">提示</h1><p id="d87d" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">好吧，让我们重新看看面试官想让你做什么:</p><p id="c4b9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">已知:</strong>您从类似 pickle 文件的东西中提取函数，因此您只知道输入(您指定的)和输出(由函数给出的)。</p><p id="7bf5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">问题:</strong>通过计算每个给定点的梯度，找出使该函数输出最小的输入。例如，我们将使用 f(x1，x2)=y</p><h1 id="4765" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">背景</h1><p id="7360" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这是梯度下降。它只是被分解成几个部分。你知道的。你以前学过。有这么多关于梯度下降的文章，我不能证明为什么在这里广泛地写它会有价值。一些很好的资源是这篇<a class="ae mp" rel="noopener" target="_blank" href="/understanding-the-mathematics-behind-gradient-descent-dde5dc9be06e">文章</a>用于快速回顾，经典的吴恩达<a class="ae mp" href="https://www.coursera.org/lecture/machine-learning/gradient-descent-8SpIM" rel="noopener ugc nofollow" target="_blank">课程</a>用于你想知道的一切。现在，我将提醒您完成这项挑战所需的基础知识。</p><p id="047c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">什么是渐变？</strong></p><p id="157b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">书中定义:梯度是从一点到另一点的变化幅度和方向。</p><p id="b4c9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">实际定义:在我转到数据科学之前，我学的是工程学，所以我关于梯度的最好的例子都源于力学和流体动力学。希望这个类比对一个人来说是绝对完美的，对其他人来说是可以忍受的。想象一个湖。通常很平静。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mq"><img src="../Images/c1bf144105e51e7ad612f88c0abd38a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*--PeCuz7jsQJeDpQ_6iCBw.jpeg"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者照片</p></figure><p id="ef06" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">好了，现在一艘船正拉着一位非凡的障碍滑雪运动员过来。水仍然有相同的水流吗？</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/de0a9ecb2e1b5dbd6883e1e4d0e6d94e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*DEVUOlENgPF2hlTcs9cCVw.jpeg"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者照片</p></figure><p id="a18c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">水很可能不再以相同的速度和方向流过整个表面，对吗？我们如何在这个湖的不同部分表现水的速度和方向？机械物理学会告诉你用速度矢量。像这样:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/5fee99362976ff7e514834f6dd902dde.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/0*yRuxxmz8Zsm3lmt1.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">图片由可汗学院提供</p></figure><p id="a74a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这代表一种梯度。速度是从一点到另一点的距离(在特定方向上)相对于时间的变化。开始结合这些梯度，我们得到的东西看起来像这样:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi mt"><img src="../Images/bf6aa46b2f469101054234330671c4e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-l0AEWO_udh8In3e.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">大卫·切纳勒通过<a class="ae mp" href="https://www.researchgate.net/figure/A-schematic-of-sliding-plate-rheometry-The-velocity-gradient-caused-by-the-shear-flow_fig1_2677https://www.researchgate.net/figure/A-schematic-of-sliding-plate-rheometry-The-velocity-gradient-caused-by-the-shear-flow_fig1_26771890818908" rel="noopener ugc nofollow" target="_blank">研究之门</a>拍摄的图片</p></figure><p id="b5df" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">数学定义:梯度是在你评估的任何一点与曲线相切的直线的斜率。这意味着梯度是代表该点函数的偏导数分量的和。这让我们想到了这样的事情:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/5c8c21f744ea562a28a9390847b2bde9.png" data-original-src="https://miro.medium.com/v2/resize:fit:386/1*hhCyA1cI4XuXiNX8yCoDFQ.gif"/></div></figure><p id="20b5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">我们在下降什么，为什么？</strong></p><p id="961a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在机器学习中，你通常试图找到预测器和一系列特征之间的某种关系。为了收敛，你优化了一个<a class="ae mp" rel="noopener" target="_blank" href="/coding-deep-learning-for-beginners-linear-regression-part-2-cost-function-49545303d29f">成本函数</a>，以获得最小的误差。优化的方法是在误差最小的方向上采取步骤，并返回相应的梯度向量。一旦你达到一个阈值最小值，你的梯度向量揭示了优化这个成本函数的系数。</p><p id="e954" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">换句话说，也许你以前见过这个:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/9af211ea94a0698d4cdd14e21877e22b.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/1*2oAfYnjWaQkKXJiJh8cVig.gif"/></div></figure><p id="b7e8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这是梯度下降方程，假设你有一些已知的成本函数 J(θ)和学习率(α)。例如，线性回归的常见成本函数是误差平方和:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/3cfa8bfb46340f581839734710c5366c.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/1*cOoiWVdXhVA6aZolIpHdAQ.gif"/></div></figure><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/6bd5574b598629323e4a5f18e290c434.png" data-original-src="https://miro.medium.com/v2/resize:fit:290/1*nceP12DJII16iA6wpo5jng.gif"/></div></figure><p id="f021" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在这个等式中，我们通过目标值(y_pred)和输出值(y_actual)计算平方误差。接下来，我们通过除以我们的观察次数(n)来计算误差平方的平均值。在线性回归的情况下，为了结合我们的两个方程，让我们用平方误差来表示我们的成本函数。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi my"><img src="../Images/27ac3b9076d2c68124371c1c2e428562.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/1*yR6YbIRILFwbt0AwSziefQ.gif"/></div></figure><p id="7727" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这里我们用 m 而不是 n 来表示这个步骤中的观察次数，我们除以 2 只是为了在计算梯度时更容易微分。h(theta)代表目标(y_pred)，y 代表产出(y_actual)。回到第一个等式，你会得到如下结果:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/d152b0b357118dea5a2336179b5d5e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:562/1*7phm1jGYXKRwEKBsuadcFg.gif"/></div></figure><p id="2d6f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这里，α代表第一个等式中的学习速率，但是我们已经求解了梯度的偏导数。</p><p id="98bd" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">让我们回到(成本)函数未知的面试问题。我们没有计算偏导数的奢侈。因此，我们必须使用猜测和检查的方法来寻找最大梯度。我将简单地指定一个步长，而不是计算梯度(如下所示)。我将使用这个步长来检查当前点周围的每个梯度。</p><p id="653c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这是相当蛮力的，但我会假设你的面试官正在测试你是否能潜入你的算法车辆的引擎盖下，进行一点手动维护。</p><h1 id="32d6" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">解决方案编码</h1><p id="dbc9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">好吧，让我们开始吧。我做了两个函数来解决这个问题。第一个函数将简单地计算给定 x = (x1，x2)的最大梯度。我假设只有 2 个特征(x1，x2)由提示定义。第二个函数将使用第一个函数，通过遵循第一个函数中的梯度来最小化您的未知(给定)函数 f(x1，x2) = y。从我们的第一个函数开始:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="2fe5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这里发生的是，我抓住了我的给定点(x1，x2)周围的每个点和我的给定点+我实例化的步长(这里是 1)之间的差。然后，我将找到这 4 个差值的最大值，并返回相关的方向(x1+步长，x2+步长)和幅度(差值)。</p><p id="c8a8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">让我们来看看最小化函数:</p><figure class="kh ki kj kk gt kl"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="f467" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这里我使用梯度函数返回的最大值遍历梯度，每次都重新运行循环。一旦我到达一个接近于零的停止差，我就返回该点的坐标(x1，x2)。我还建议将它可视化(如果可能的话),感受一下您的解决方案。我的例子是这样的:</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/15de9824d309699a5cfea44bc31ae3b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*jA8xol_o-Y2tGh9roSiAjg.png"/></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">作者图片</p></figure><p id="701e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">如你所见，除了全局最小值之外，还有一个局部最小值。如果我只在(0，0)初始化 minimize()函数，我会陷入局部最小值。我通过在随机不同的起点初始化脚本来避免这个问题，以确保一个真正的最小值。一旦 minimize()函数从~(750，500)开始，我就能找到全局最小值。<a class="ae mp" rel="noopener" target="_blank" href="/stochastic-gradient-descent-with-momentum-a84097641a5d">动量</a>是神经网络中的一个流行概念，它无需在随机点进行初始化就能完成这项任务(可以想象，如果有 100 多个特征，这可能会变得很乏味)。这有点超出了这篇文章的范围，但是可以研究一下达到全局最小值的可扩展方法。</p><h1 id="5e59" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">最后</h1><p id="644a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这个问题的某种形式对于机器学习面试来说是非常典型的。我也认为这是一个有趣的谜题，展示一些基本的 python 印章，因为你不需要任何花哨的包。下面是我用来解决这个问题的一些参考资料，我祝你在未来的面试中好运。愿你优雅地走下阶梯。</p><h1 id="0355" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">参考</h1><ul class=""><li id="0dbe" class="nd ne iq lq b lr ls lu lv lx nf mb ng mf nh mj ni nj nk nl bi translated"><a class="ae mp" href="https://en.wikipedia.org/wiki/Gradient" rel="noopener ugc nofollow" target="_blank">关于渐变的维基百科</a></li><li id="dc42" class="nd ne iq lq b lr nm lu nn lx no mb np mf nq mj ni nj nk nl bi translated"><a class="ae mp" rel="noopener" target="_blank" href="/gradient-descent-in-python-a0d07285742f">Python 中的渐变下降</a></li><li id="66b4" class="nd ne iq lq b lr nm lu nn lx no mb np mf nq mj ni nj nk nl bi translated"><a class="ae mp" rel="noopener" target="_blank" href="/understanding-the-mathematics-behind-gradient-descent-dde5dc9be06e">梯度下降数学</a></li><li id="85de" class="nd ne iq lq b lr nm lu nn lx no mb np mf nq mj ni nj nk nl bi translated"><a class="ae mp" href="https://www.geeksforgeeks.org/gradient-descent-in-linear-regression/" rel="noopener ugc nofollow" target="_blank">梯度下降方程</a></li></ul></div><div class="ab cl nr ns hu nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ij ik il im in"><p id="bd76" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><em class="ny">原载于 2020 年 4 月 1 日 https://brittanybowers.com</em><em class="ny">的</em> <a class="ae mp" href="https://brittanybowers.com/code-gradient-descent-from-scratch/" rel="noopener ugc nofollow" target="_blank"> <em class="ny">。</em></a></p></div></div>    
</body>
</html>