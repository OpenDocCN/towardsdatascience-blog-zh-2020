<html>
<head>
<title>A, B, Cs… of Deep Learning Hyperparameters</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习超参数的 a、B、Cs……</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-b-cs-of-deep-learning-hyperparameters-4d5de9a37de1?source=collection_archive---------66-----------------------#2020-07-29">https://towardsdatascience.com/a-b-cs-of-deep-learning-hyperparameters-4d5de9a37de1?source=collection_archive---------66-----------------------#2020-07-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fa3d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">超参数:是福是祸，由你决定。好吧，我们都知道“人工智能是新的电力”，我们不可避免地需要力量和知识来综合和控制它。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1ab2626c354d2977de17e6e1102d7baa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s40YA6taPC3nt1vwAt_heg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Diomari Madulara 在<a class="ae ky" href="https://unsplash.com/s/photos/abc?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="eafa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> D </span> eep learning 目前成为新闻，因为它的准确性和对我们现有模型的控制。有了大量的编程软件，如<strong class="lb iu"> TensorFlow </strong>、<strong class="lb iu"> Keras </strong>、<strong class="lb iu"> Caffe </strong>，以及一个巨大的列表，简化了深度学习编程的工作。现在，我们不必担心反向传播步骤、权重更新等，而只需调整超参数。</p><p id="53f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，深度学习的人知道这不是一件简单的事情。由于预测精度高，深度学习有利于拥有大量超参数，这些超参数由从业者根据他们的任务或他们实施深度学习模型的问题类型来使用。</p><blockquote class="me mf mg"><p id="8627" class="kz la mh lb b lc ld ju le lf lg jx lh mi lj lk ll mj ln lo lp mk lr ls lt lu im bi translated">人工智能对世界来说是一种恩惠，但如果你不明智地使用它，它可能会成为你的诅咒，而要明智地使用它，你需要准确地理解它。</p></blockquote><p id="2996" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，为了准确地理解它们，我们需要回答三个问题，即何时、何地以及在何种背景下。在此之前，让我们列出它们，以便顺利开始。</p><p id="a11b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将讨论以下超参数的三个 w:</p><ol class=""><li id="55b9" class="ml mm it lb b lc ld lf lg li mn lm mo lq mp lu mq mr ms mt bi translated">学习率</li><li id="edeb" class="ml mm it lb b lc mu lf mv li mw lm mx lq my lu mq mr ms mt bi translated">隐藏单元数和隐藏层数</li><li id="79c2" class="ml mm it lb b lc mu lf mv li mw lm mx lq my lu mq mr ms mt bi translated">β(带动量的梯度下降)</li><li id="75b4" class="ml mm it lb b lc mu lf mv li mw lm mx lq my lu mq mr ms mt bi translated">β1、β2 和ϵ (Adam 优化器)</li><li id="43be" class="ml mm it lb b lc mu lf mv li mw lm mx lq my lu mq mr ms mt bi translated">学习率衰减</li><li id="638c" class="ml mm it lb b lc mu lf mv li mw lm mx lq my lu mq mr ms mt bi translated">小批量(小批量梯度下降)</li></ol><h1 id="35d7" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">1.学习率</h1><p id="e7a8" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">当你写出梯度下降的最基本形式并更新参数时，这里就是学习率出现的地方</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/82bb46e3deb4a8650e4eeb8a573927d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sGiwbQFwg4kyAmXRoe1j4w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">梯度下降的步骤(由作者出版)</p></figure><p id="8833" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">学习率决定了你在梯度下降的每次迭代中要跳多远。一般来说，学习率在 0.001 和 1 之间，这可以随着你向函数的最小值前进而变化。</p><h1 id="eb36" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">2.隐藏层和隐藏单元的数量</h1><p id="3a47" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">另一个重要的超参数是隐藏层中隐藏单元的数量和隐藏层本身。它决定了模型在给定数据点中描述的函数有多复杂。隐藏单元和隐藏层的数量越多，模型概述的函数就越复杂，因此过度拟合的机会就越多。</p><p id="fd8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通常，人们采用许多隐藏层和隐藏单元来构建深度神经网络，并使用一些技术，如 L2 或辍学正则化，以防止数据过拟合的规定。</p><p id="cecf" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没有规定的方法来确定正确的或最佳的层数，您必须从某个最小的层数开始并增加它，直到您达到期望的预测精度。这就是为什么应用机器学习是一个高度迭代的过程。</p><p id="6623" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个参数是你的系统，<strong class="lb iu"> CPU </strong>，或者<strong class="lb iu"> GPU </strong>决定了隐藏层和单元的数量。因为这是一个高度迭代的过程，你需要迅速得到每次迭代的结果，为此你应该有很高的计算能力。</p><h1 id="518e" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">3.带动量的梯度下降</h1><h2 id="a98a" class="nx na it bd nb ny nz dn nf oa ob dp nj li oc od nl lm oe of nn lq og oh np oi bi translated">什么是加权平均？</h2><p id="2724" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">假设我们记录了夏季 200 天的温度(黄色散点分布)。附加曲线代表不同权重(β)的加权平均温度。</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="6a77" class="nx na it ok b gy oo op l oq or">##CODE FOR WEIGHTED AVERAGE<br/>temp                      ## list of temperatures of 200 days<br/>v[0]  = temp[0]           ## random initialization (for scalability)<br/>for i in range(len(temp)) :<br/>    v[i+1] = (beta)*v[i] + (1-beta)*temp[i+1]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/b11156efcf5294205089c10da585287a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HOYMAEtqYhaJeeZYrwx4zQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">印度德里 200 天的温度分布((作者发表))</p></figure><p id="b436" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注意</strong>:我们已经初始化了 v[0] = temp[0]，以确保加权平均温度保持在实际分布的范围内。</p><h2 id="9f3c" class="nx na it bd nb ny nz dn nf oa ob dp nj li oc od nl lm oe of nn lq og oh np oi bi translated">我们如何利用这一点？</h2><p id="9a7a" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">假设我们有以下类型的成本函数，我们的梯度下降与它很好地合作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/4c2deafc02d9799cbf6b6d0d72511997.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8wdlJjhmvgoDeaEFkpAW9Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">成本函数上的批量梯度下降(由作者发表)</p></figure><p id="1dac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，当我们有足够的数据来训练时，梯度下降在振荡中花费了大量的时间来达到成本函数的最小值。当我们将加权平均应用于梯度下降时，它将两个方向的值平均化。因此，垂直值相互抵消，我们在水平方向获得更多的动量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/14da09ab949c02086639ccf71c6f09d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C10gguUgTExL_5IQVQnFvA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">成本函数上带有动量的梯度下降(由作者发表)</p></figure><p id="6e21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这叫做动量梯度下降。通常，β的范围从 0.9 到 0.99，我们使用对数标度来寻找该超参数的最佳值。</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="bac0" class="nx na it ok b gy oo op l oq or">## UPDATION STEP OF GRADIENT DESCENT<br/>W = W - learning_rate * dW<br/>b = b - learning_rate * db</span><span id="b674" class="nx na it ok b gy ov op l oq or">## CHANGE IN UPDATION STEP OF GRDIENT DESCENT<br/>## WEIGHTED AVERAGE form of  GRADIENT DESCENT<br/>VdW = beta * VdW + (1-beta)*dW    ## Taking weighted avg of weights Vdb = beta * Vdb + (1-beta)*db    ## Taking weighted avg of biases</span><span id="fb59" class="nx na it ok b gy ov op l oq or">## Updating weights and biases<br/>W = W - learning_rate*VdW<br/>b = b - learning_rate*Vdb</span></pre><h1 id="66cc" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">4.Adam 优化器</h1><h2 id="d9fb" class="nx na it bd nb ny nz dn nf oa ob dp nj li oc od nl lm oe of nn lq og oh np oi bi translated">批量标准化</h2><p id="716c" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">据观察，当我们标准化输入数据时，训练变得更快。那么，为什么我们不对每个隐藏层的输入进行标准化呢？这种技术被称为批处理规范化。通常，在将它们放入激活函数之前，我们会对值进行归一化。</p><p id="c3ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果我们对如下所示的给定的猫图片进行训练，我们的模型就有可能预测不正确。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/be4893c70b0c0f70e0f67b9abd54dedc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y0gABAu5ZCn0EkiBhKWvfg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">(1)Kazuky aka yashi 在<a class="ae ky" href="https://unsplash.com/s/photos/black-cats?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片，(2)Lamna The Shark 在<a class="ae ky" href="https://unsplash.com/s/photos/black-cats?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片，(3)Daria Shatova 在<a class="ae ky" href="https://unsplash.com/s/photos/black-cats?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片，(4)Tran Mau Tri Tam<a class="ae ky" href="https://unsplash.com/@tranmautritam?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">在</a><a class="ae ky" href="https://unsplash.com/s/photos/cats?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="fbaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是因为训练数据集中的所有猫都是黑色的，而测试数据集中的图片是白色的猫。从数学上讲，测试数据集和训练数据集的数据分布是不同的。</p><p id="999f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">标准化是一种技术，通过这种技术，我们每次必须提供输入时都可以获得相同的数据分布。标准化的一般步骤是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/c62a2a2fbd0e701dffcffde37ff699c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*UqEFanS5_hHBRxLrlx9xsg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">规范化输入数据的步骤(由作者发布)</p></figure><p id="e341" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些步骤使平均值为零和单位标准偏差。这种特殊的分布可能并不总是有效。可能存在这样的情况，我们需要具有不同集中趋势的分布。因此，我们需要调整分布参数，即平均值和偏差。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/480bd7b47aa128f9d65a737a3f61af1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*NTY8TDkcLXSvE4Mxbok1Zg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">调整标准化数据集中趋势的附加步骤(由作者发布)</p></figure><p id="88f5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">步骤 4 允许我们调整分布参数。此外，在步骤 3 中，我们添加了一个ε项，以确保分母永远不等于零。</p><h1 id="ec13" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">5.小批量</h1><p id="1c9c" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">梯度下降的一次迭代过程:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/82470bb653bf0fcf44de6259650fa76b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*0JatUZJm4YKyPH80tCD4rQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">分批梯度下降法(作者发表)</p></figure><p id="f0d9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当训练集非常大时，比如说大约 500 万个样本，那么升级一次参数所需的时间将会很长。因此，作为一种补救措施，我们将大型数据集划分为较小的数据集，对于这些较小数据集的每次迭代，我们都要更新参数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/40797bd50a67a77a2f884a546f0c43ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*BaW-NNLNtP4_KpwQwPiWWw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">小批量梯度下降法(作者发表)</p></figure><p id="da38" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，我们将训练集分成三个更小的集合，但是有一些规范可以做到这一点。人们建议我们应该在小批量中生产相当于 2 的某个幂的批量，即 64、128、1024 个样品。这在某种程度上优化了内存分配，实际上优化了模型的性能。</p><p id="16b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">整个数据集的一个循环的完成被称为一个<strong class="lb iu">时期</strong>。当我们使用批量梯度下降(简单梯度下降)时，我们在一个时期内更新一次参数，但是在小批量梯度下降中，在一个时期内更新多次参数。</p><h1 id="0922" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">6.学习率衰减</h1><p id="3de8" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">取学习率的大值可以优化时间，但是我们可能永远达不到最小值。相反，如果我们取一个小的学习率，学习速度就低。那么，为什么我们不能在训练模型时改变学习率呢？</p><p id="3f68" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当学习速率接近收敛(成本函数的最小值)时，可以减慢学习速率以获得更好的结果。在这种情况下，学习率的一个非常一般的形式可以表示为</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/25876224cdc92ebb2c0bdf4423812e17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ngNPbU2yt_UT8m07uqEwqw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">实现学习率衰减(由作者出版)</p></figure><p id="9108" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这个例子中，我们可以观察到学习率是如何变化的。现在明智地选择“<strong class="lb iu">衰变率</strong>变得很重要，因此可以称为另一个超参数。</p><h1 id="68d4" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">猜测…</h1><p id="5616" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">当你训练一个模型时，感知每个参数和超参数的细节是非常重要的，因为你梦想它会给世界和社会带来一些变化。即使是一件小事也能引发一项大的创新。</p><p id="6837" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">至此，我希望这篇文章能为你增添一些东西。请分享你的想法，因为</p><blockquote class="pc"><p id="37b8" class="pd pe it bd pf pg ph pi pj pk pl lu dk translated">"批评是自我吹嘘的一种间接形式。"埃米特·福克斯</p></blockquote></div></div>    
</body>
</html>