<html>
<head>
<title>Who is a Potential Customer?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谁是潜在客户？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/who-is-a-potential-customer-2d76af153f57?source=collection_archive---------26-----------------------#2020-04-18">https://towardsdatascience.com/who-is-a-potential-customer-2d76af153f57?source=collection_archive---------26-----------------------#2020-04-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="1717" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">现实世界中的数据科学</h2><div class=""/><div class=""><h2 id="1be2" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">基于机器学习和谷歌分析的在线购买意向预测</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/0f4c9431acc017c740006b4cadde7af4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rmrPxA-YxzOCmxBZJu1Kqg.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">戴维·维克斯列尔在<a class="ae le" href="https://unsplash.com/s/photos/online-shopping?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="954d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">每天在线购物网站都有大量的访问量。然而，只有一小部分访问变成了购买。</p><blockquote class="mb mc md"><p id="7949" class="lf lg me lh b li lj ka lk ll lm kd ln mf lp lq lr mg lt lu lv mh lx ly lz ma ij bi translated">如果购物网站知道哪些客户群更有可能购买，会怎么样？</p></blockquote><p id="736d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">他们将能够推出对网站和客户都有利的目标促销活动。今天我们将利用机器学习的力量来探索这个问题。数据集来自奥莰·萨卡尔的<a class="ae le" href="https://link.springer.com/article/10.1007/s00521-018-3523-0" rel="noopener ugc nofollow" target="_blank">研究</a>。我们将在这个项目的研究中使用不同的方法。如果你想复制这个项目，你可以在我的<a class="ae le" href="https://github.com/guo-pei/who-is-a-potential-customer" rel="noopener ugc nofollow" target="_blank"> Github </a>中找到所有的资源。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="06d6" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">数据概述</h1><p id="11f6" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">该数据集由网站的12，330次在线购物访问组成。为避免任何趋势，数据在1年内。18个特征用于描述每个会话，分为数字特征和分类特征。特征<strong class="lh ja">“收入”</strong>是我们二元分类问题的<strong class="lh ja">标签</strong>。我们的目标是使用以下所有其他17个特征来预测“收入”标签，也就是看一次访问会话是否会以交易结束。</p><p id="1a9b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">以下是这些特性的描述，请参考本文。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/f5267ae4ceb2a071507431159113af91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*mfMR7vM86HunzI_E7yUNaw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">数字特征</p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nn"><img src="../Images/8df94ce0ff0e00a509005b208ca2fa00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KMaqdkS1wujZqqR0zPwfew.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">分类特征</p></figure><p id="cb3f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">值得注意的是<strong class="lh ja"> Google Analytics </strong>指标用于数字特征:<a class="ae le" href="https://support.google.com/analytics/answer/1009409?hl=en" rel="noopener ugc nofollow" target="_blank">跳出率</a>衡量客户是否离开一个页面而不再访问另一个页面；<a class="ae le" href="https://support.google.com/analytics/answer/2525491?hl=en" rel="noopener ugc nofollow" target="_blank">退出率</a>告诉你一个页面多久是一个会话的最后一页；<a class="ae le" href="https://support.google.com/analytics/answer/2695658?hl=en" rel="noopener ugc nofollow" target="_blank">页面价值</a>显示哪个页面对网站的收入贡献更大。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="3573" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">方法学</h1><h2 id="6d90" class="no mq iq bd mr np nq dn mv nr ns dp mz lo nt nu nb ls nv nw nd lw nx ny nf iw bi translated">这个项目的工作流程是怎样的？</h2><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nz"><img src="../Images/23959b1b777faa584075d798a3e60a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4jrF_S72mV9i44nLUQnUaw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">项目工作流程</p></figure><p id="d781" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们将按照上面的工作流程来寻找客户购买意向预测的最佳模型。</p><h2 id="e407" class="no mq iq bd mr np nq dn mv nr ns dp mz lo nt nu nb ls nv nw nd lw nx ny nf iw bi translated">我们如何做决定？</h2><p id="bb60" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">在这个项目中，我们需要在型号选择和功能选择上做出很多决定。决策是基于这些指标做出的:<strong class="lh ja">准确度、召回率、精确度和F1。</strong>让我用我们的商业案例来解释一下。</p><p id="0f2a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在我们的数据集中，每个在线访问会话背后都有一个客户。如果我们预测“收入”为1，这意味着发起会话的客户更有可能进行购买。然而，我们的预测并不总是正确的。下表显示了不同的场景。</p><p id="5207" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="me">假设:1。每个订单的收入为100美元，每个发送的优惠券的成本为5美元。2.有优惠券的可能顾客会购买，而有优惠券的不可能顾客不会购买。</em></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oa"><img src="../Images/19ef5c3c12fc73ee317407d438254900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VwKWrrer4RGNntvRkoPvBw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">可能和不可能顾客的混淆矩阵</p></figure><p id="fe46" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">从上表可以看出，我们希望更多的“真阳性(TP)”发生，并尽可能避免“假阴性(FN)”。我们如何将此应用于机器学习模型？分类指标:</p><p id="9c97" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">召回分数:TP/(TP+FN) </strong></p><p id="3ea2" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="me">在所有可能的客户中，模型能正确识别出多少。高召回率要求高TP和低FN。它可以识别很大一部分潜在客户，以减少销售损失。与此同时，更多不太可能的客户(FP)也将收到优惠券。当损失的销售成本大于息票成本时，这没有问题。</em></p><p id="adbb" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">精度得分:TP/(TP+ FP) </strong></p><p id="a0b7" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="me">在我们的模型预测的所有“可能”客户中，有多少是正确的，而不是误报的。高精度分数需要高TP和低FP。它可以确保大部分预测的潜在客户是正确的。使用的优惠券越多，浪费的优惠券越少。然而，更多的其他潜在客户将被忽略，导致销售损失。</em></p><p id="5b31" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> F1得分:2 *召回率*准确率/(召回率+准确率)</strong></p><p id="4d19" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="me">一个兼顾查全率和查准率的值。</em></p><p id="ff73" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">准确率得分:(TP+TN)/(TP +TN+FN+FP) </strong></p><p id="4c0f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="me">预测结果正确的百分比。这个标准只在类平衡时有效。我们不用它来处理不平衡的数据。</em></p><blockquote class="mb mc md"><p id="c78f" class="lf lg me lh b li lj ka lk ll lm kd ln mf lp lq lr mg lt lu lv mh lx ly lz ma ij bi translated">由于上述原因，在这个项目中，我们将使用召回分数作为我们在选择型号时的主要衡量标准。当回忆分数相近时，我们也会考虑F1分数。</p></blockquote></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="4493" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">初始模型选择</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/05ec991f7083b76d3f38d89879566c54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wL7BP-A3YGzaEgGhk4hlWg.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">维多利亚诺·伊斯基耶多在<a class="ae le" href="https://unsplash.com/s/photos/selection?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="ce82" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">首先，让我们清理数据:</p><p id="e448" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">通常只有一小部分访问以交易结束，我们怀疑数据是不平衡的。经过下面的测试，我们发现交易转化率只有18.3%。这意味着以后我们需要对建模数据进行平衡调整。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/66109b308aa65406226743438ed3ba37.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*oMWIkxqyPtnCIow4FnqBXw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">不平衡标签</p></figure><p id="b675" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">分类数据需要转换成数字以便进一步分析。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="e162" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">数据集非常不平衡。所有模型都倾向于符合多数类，因此为了提高模型性能，我们需要首先平衡数据。我使用了<strong class="lh ja"> SMOTE </strong>超尺寸技术，结果是两个类的样本数量相同。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="od oe l"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">使用SMOTE平衡数据</p></figure><p id="3feb" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，我们可以使用准确性作为平衡数据集的衡量标准。我选择了7个分类器作为模型候选。我将数据集分成80%的训练和20%的测试。然后将训练集拟合到每个模型中，无需调整。这里我们得到了一个基线精度排名。我将选择前4个模型作为我的基线模型:随机森林、额外树、ADAboost和逻辑回归。我们现在优先考虑回忆的准确性，因为我们需要无偏见的模型。然后在高精度模型中选择高召回模型。</p><p id="f5d0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">特性工程和模型调整将在稍后对4个模型进行。代码详情请参考我的<a class="ae le" href="https://github.com/guo-pei/who-is-a-potential-customer" rel="noopener ugc nofollow" target="_blank"> Github </a>页面。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi of"><img src="../Images/8d23f095bf62752483f8d66c6826166d.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*RtrTSeLa28WhtPUAx0l7Sw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">初始模型性能</p></figure></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="3557" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">第一轮特征选择</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/366bf27dda6db939a8020e57889d3df2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e-PIdacMqBQ25aR7pH5Y9A.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">安东尼·马蒂诺在<a class="ae le" href="https://unsplash.com/s/photos/choose?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="e480" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我的目标是减少特性的数量，同时增加度量值。随着特征的减少，数据收集的成本降低，计算时间和成本也降低。使用三种特征选择技术来给出综合决策:<strong class="lh ja">信息值、</strong> sklearn的<strong class="lh ja"> SelectFromModel()、</strong>和<strong class="lh ja">相关值</strong>。</p><p id="46f0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">哪些特征在预测中比其他特征能给我们更多的信息？我们试试sklearn的SelectFromModel()来筛选特征的重要性权重。这给了我们三个重要的特征。我们将保留它们，并继续探索其他两种特征选择方法。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="od oe l"/></div></figure><pre class="kp kq kr ks gt oh oi oj ok aw ol bi"><span id="57cc" class="no mq iq oi b gy om on l oo op">'ProductRelated_Duration', 'ExitRates', 'PageValues'</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oq"><img src="../Images/ed5c24e7d79569b2107d46fae09b0116.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QM8czT6vCUFyTVc_dwApoA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">功能选择前的热图</p></figure><p id="89fd" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">左侧的热图显示了所有功能之间的相关性。颜色越深，相关性越高。我们希望看到的是，这些特性与“收入”这个标签非常相关，但彼此之间并不相关。但是一些特征与另一个特征高度相关。这意味着只能保留其中一个相关特征。我们怎么知道该保留哪一个？信息值(IV)将帮助我们。</p><p id="c3d8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，我们将使用信息值对所有特征进行排序，并找出具有中等至强预测能力的特征。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi or"><img src="../Images/f58da825689525f12d3def07e2ee74f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*SVafWCGiK_N2dmGqQv3NrA.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">信息价值及其预测能力</p></figure><p id="29b9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">下面的函数将计算每个特征的信息值。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="od oe l"/></div></figure><p id="0e04" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">通过以上所有计算，现在我们得到了以下结果:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi os"><img src="../Images/56666756122c91187cd9fedc77554824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g8jrqUs2QOX6hyauT1BMEA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">高度相关特征对的信息值</p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/da1e60c9b8d7f5633111a10236e75d0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*4zauxISkcALX7ObeB_CogQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">其他不相关特征的信息值</p></figure><p id="4c30" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">上表显示了为进一步建模而保留的8个特征:</p><blockquote class="mb mc md"><p id="ae21" class="lf lg me lh b li lj ka lk ll lm kd ln mf lp lq lr mg lt lu lv mh lx ly lz ma ij bi translated"><strong class="lh ja">管理持续时间，信息，产品相关持续时间，展示，特殊日，月，访问者类型，页面值</strong></p></blockquote><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/27768891d4dcf2e772a0f90fa6b49524.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*3cVcU_Iax38HZa-3fAqkXQ.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">特征选择的决策流程图</p></figure><p id="dd8d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">我是如何做决定的？</strong></p><p id="4b56" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">左边的流程图是我的思考过程。</p><ol class=""><li id="194a" class="ov ow iq lh b li lj ll lm lo ox ls oy lw oz ma pa pb pc pd bi translated">IV低于0.1的特征被移除。</li><li id="6bf7" class="ov ow iq lh b li pe ll pf lo pg ls ph lw pi ma pa pb pc pd bi translated">对于其他的，如果一个特性被sklearn过滤器选中，我们就保留它。</li><li id="5dd7" class="ov ow iq lh b li pe ll pf lo pg ls ph lw pi ma pa pb pc pd bi translated">然后，如果剩余部分与保留的特征高度相关，则将其移除。</li><li id="f410" class="ov ow iq lh b li pe ll pf lo pg ls ph lw pi ma pa pb pc pd bi translated">最后一部分，如果一个特性与另一个不相关，我们保留它。如果是，则保留具有较高信息值的那个。</li></ol><p id="f31c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在我们的功能更少了，让我们看看它们是否能帮助改进我们的模型:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pj"><img src="../Images/39513a63055efe35165c162e97393480.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4jHGffoWR6oA9N4_HqPYWw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">具有8个特征的新数据框</p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/66d03cc4634778c9625a9bd4f80006e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*iLlVEqJlGgN7bZL1oPni7g.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">第一轮特征选择后的模型性能</p></figure><p id="c09a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们取得了巨大的成果！经过特征选择后，所有的查全率都有了很大的提高，其他指标看起来也不错。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="9c63" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">第二轮特征选择</h1><p id="ba51" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">我们有7个分类特征。即使它们之前被转换为数值，分类特征的所有值都在一列中。如果我们让每个值都有自己的特征呢？让我们用<strong class="lh ja">哑</strong>这个分类特征变量吧！处理完数据后，现在我们有29个特征和1个标签。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pl"><img src="../Images/ce336b7ec39dbc15da4a742270206d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jV9ooFcuzNHRsOCLIrq-YQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">虚拟变量后的特征</p></figure><p id="ee1c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">为什么我们在第一轮特征选择中不使用虚拟变量？因为把低信息价值的特征虚拟化，做太多新的特征是没有效果的。这将降低模型的性能。</p><p id="008e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，我们将在第一轮功能选择过程中使用相同的技术来选择新功能。详情请参考我的<a class="ae le" href="https://github.com/guo-pei/who-is-a-potential-customer" rel="noopener ugc nofollow" target="_blank"> Github </a>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pm"><img src="../Images/4d4f455f83ac54b9e2b779595dee5fe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SSzUPA4zo-sQpkRrXvXb3g.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">第二轮功能选择后的功能热图</p></figure><p id="3725" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja"> Administrative_Duration，Informational_bins_page_1_plus，ProductRelated_Duration，ExitRates，Month 11，VisitorType_bins_return，PageValues_bins_above_0 </strong></p><p id="b13d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在上面的热图显示了新一轮特征选择后的7个特征+ 1个标签。请注意，没有两个功能是相关的(这很好)，Pagevalues_bins_above_0功能与收入非常相关</p><p id="84bf" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在让我们来看看这些新功能在模型上的表现。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/8c0d8e6b11af647d19de2885303f39e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*cuZZjNM1IFPudu4bYMVhVw.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">第一轮特征选择后的模型性能</p></figure><p id="9959" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们可以看到，EXTRA trees和AdaBoost提高了召回分数，而其他两个模型的性能不如以前。EXTRA trees模型的召回率比AdaBoost低，但F1高。因此，我们将暂时保留这两个模型，以便进行下一步的模型调优。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="00bd" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">模型调整</h1><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi og"><img src="../Images/3d8b0672c4161f4ecf70a0bf7fb18014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*17hLGIMhrPD4uUkXRo8XLg.jpeg"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">照片由<a class="ae le" href="https://unsplash.com/@denisseleon?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">丹尼斯·莱昂</a>在<a class="ae le" href="https://unsplash.com/s/photos/tune?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="7562" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在我们已经缩小到两个模型:EXTRA trees和AdaBoost。通过调整他们的超参数，我们有可能进一步提高回忆分数。对于模型调优技术，我将首先使用RandomizedSearchCV。它将通过我们定义的超参数列表随机运行模型。一旦我们通过RandomizedSearch获得了最佳性能，我们将使用GridSearch通过运行更窄的超参数列表来进一步改进模型。详情请查看我的<a class="ae le" href="https://github.com/guo-pei/who-is-a-potential-customer" rel="noopener ugc nofollow" target="_blank"> Github </a>。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi po"><img src="../Images/9264145f624841872e5e812ea27667cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*o5u4AaaWrIczUDuFimrIRA.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated">模型调整结果</p></figure><p id="3dab" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">上图显示，这两个模型都通过使用随机搜索和网格搜索得到了改进。最后的回忆分数只有0.002的差异。然后我们看F1和准确度分数。<strong class="lh ja"> EXTRA trees </strong>模型在这两个指标上都有更高的分数。结果就是我们的<strong class="lh ja">最终型号</strong>。</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="aecd" class="mp mq iq bd mr ms mt mu mv mw mx my mz kf na kg nb ki nc kj nd kl ne km nf ng bi translated">结论</h1><p id="a0fd" class="pw-post-body-paragraph lf lg iq lh b li nh ka lk ll ni kd ln lo nj lq lr ls nk lu lv lw nl ly lz ma ij bi translated">在这个项目中，我们建立了一个二元分类机器学习模型来预测在线购物网站上客户的购买意向。经过几轮特征选择和模型选择后，我们确定我们的数据的最佳模型是EXTRA trees，适合该模型的特征如下。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi pp"><img src="../Images/20459efacad7784a600c26414e8ea9f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e_5UYeEIqAK4B6c3iTC0HA.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated">最终特征和营销建议</p></figure><p id="4069" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们在这个项目中建立的额外树模型可以捕获83%的潜在客户。这意味着，如果营销团队将优惠券发送给该模型预测的所有潜在客户，优惠券将覆盖市场上所有实际潜在客户的83%。这个模型绝对可以帮助营销团队制定有效的营销策略！</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><p id="0067" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">感谢您花时间阅读本文。希望对你自己的项目有所启发。如果你喜欢我的文章，请为它鼓掌。随时欢迎您通过Linkedin 与我联系！快乐学习！</p></div></div>    
</body>
</html>