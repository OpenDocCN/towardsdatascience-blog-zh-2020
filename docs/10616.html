<html>
<head>
<title>Installing TensorFlow GPU in Ubuntu 20.04</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 Ubuntu 20.04 中安装 TensorFlow GPU</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/installing-tensorflow-gpu-in-ubuntu-20-04-4ee3ca4cb75d?source=collection_archive---------0-----------------------#2020-07-25">https://towardsdatascience.com/installing-tensorflow-gpu-in-ubuntu-20-04-4ee3ca4cb75d?source=collection_archive---------0-----------------------#2020-07-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6e33" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">安装 TensorFlow GPU 及其必备包的简短指南</h2></div><blockquote class="kf kg kh"><p id="c202" class="ki kj kk kl b km kn jr ko kp kq ju kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">同时发布在<a class="ae lf" href="https://afagarap.works/2020/07/26/installing-tf-gpu-ubuntu2004.html" rel="noopener ugc nofollow" target="_blank">https://afagarap . works/2020/07/26/installing-TF-GPU-Ubuntu 2004 . html</a></p></blockquote><p id="f537" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">当 Ubuntu 发布长期支持(LTS)版本时，我通常会等待一段时间再升级，主要是因为我在等待 CUDA 和 cuDNN 对新版本的支持。这一次，我只用了三个月就从 Ubuntu 18.04 迁移到了 Ubuntu 20.04——嗯，技术上来说是基于 Ubuntu 的发行版，也就是<a class="ae lf" href="https://regolith-linux.org/" rel="noopener ugc nofollow" target="_blank"> Regolith Linux </a>。我这样做的决定只是因为我将我的 SSD 从 120GB 升级到 1TB，所以我也迁移到了一个不同的操作系统——尽管只是一个<a class="ae lf" href="https://www.omgubuntu.co.uk/2019/06/install-regolith-linux-i3-gaps-ubuntu" rel="noopener ugc nofollow" target="_blank"> Ubuntu 的衍生物</a>。</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi lj"><img src="../Images/bc8563b6fa89847f282963c38eed2dde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BZ9WK2GGWWHa0g32.jpg"/></div></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">照片来自<a class="ae lf" href="https://pixabay.com/photos/laptop-computer-business-tech-5421966/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae lf" href="https://pixabay.com/users/geordie_strike-17222189/" rel="noopener ugc nofollow" target="_blank"> geordie_strike </a>。</p></figure><p id="a99c" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">正如我预料的那样，我花了一段时间来适应我的新系统。幸运的是，我在网上看到了一些有用的答案，现在我在他们的答案上增加了一些解释。所以，这个帖子实际上是基于<a class="ae lf" href="https://askubuntu.com/users/263979/meetnick" rel="noopener ugc nofollow" target="_blank"> meetnick </a>和<a class="ae lf" href="https://askubuntu.com/users/822295/singrium" rel="noopener ugc nofollow" target="_blank"> singrium </a>在<a class="ae lf" href="https://askubuntu.com/questions/1230645/when-is-cuda-gonna-be-released-for-ubuntu-20-04" rel="noopener ugc nofollow" target="_blank">这个相关问题</a>中给出的答案。</p><p id="98f3" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">Ubuntu 20.04 中 TensorFlow GPU 的安装可以总结为以下几点，</p><ul class=""><li id="420f" class="lz ma iq kl b km kn kp kq lg mb lh mc li md le me mf mg mh bi translated">通过安装<code class="fe mi mj mk ml b">nvidia-cuda-toolkit</code>来安装 CUDA 10.1。</li><li id="e160" class="lz ma iq kl b km mm kp mn lg mo lh mp li mq le me mf mg mh bi translated">安装与 CUDA 10.1 兼容的 cuDNN 版本。</li><li id="0ae5" class="lz ma iq kl b km mm kp mn lg mo lh mp li mq le me mf mg mh bi translated">导出 CUDA 环境变量。</li><li id="2c00" class="lz ma iq kl b km mm kp mn lg mo lh mp li mq le me mf mg mh bi translated">安装带 GPU 支持的 TensorFlow 2.0。</li></ul><h2 id="182c" class="mr ms iq bd mt mu mv dn mw mx my dp mz lg na nb nc lh nd ne nf li ng nh ni nj bi translated">安装 CUDA 10.1</h2><p id="39ca" class="pw-post-body-paragraph ki kj iq kl b km nk jr ko kp nl ju kr lg nm ku kv lh nn ky kz li no lc ld le ij bi translated">首先，通过转到“附加驱动程序”，确保您使用的是 NVIDIA 专有驱动程序，然后选择合适的驱动程序，即对于 CUDA 10.1，<a class="ae lf" href="https://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html" rel="noopener ugc nofollow" target="_blank">所需的驱动程序版本是≥ 418.39 </a>。我们使用专有版本而不是开源版本<a class="ae lf" href="https://forums.developer.nvidia.com/t/can-cuda-operate-with-open-source-nvidia-driver-or-only-with-nvidia-proprietary-driver/48039/5" rel="noopener ugc nofollow" target="_blank">，因为 CUDA 只能使用专有驱动</a>。</p><p id="88a0" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">我们正在安装 CUDA 10.1，因为它是与 TensorFlow GPU 兼容的版本。</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi np"><img src="../Images/41024933b64747cda14791bf05c41361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*M-eE2LPKX5trA4Hx.png"/></div></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">图片由作者提供。为 CUDA 10.1 选择合适的专有驱动程序版本，即≥ 418.39。</p></figure><p id="17a1" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">在撰写本文时，还没有适用于 Ubuntu 20.04 的 CUDA 10.1，但正如 meetnick 在引用的 Ask Ubuntu 帖子中指出的那样，安装<code class="fe mi mj mk ml b">nvidia-cuda-toolkit</code>也会安装 CUDA 10.1。</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi nq"><img src="../Images/c3408dd447f41b240cac13184503acd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mo5sI-Ek02Q9j42EnmhhWQ.png"/></div></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">图片由作者提供。<a class="ae lf" href="https://developer.nvidia.com/cuda-10.1-download-archive-base?target_os=Linux&amp;target_arch=x86_64&amp;target_distro=Ubuntu" rel="noopener ugc nofollow" target="_blank"> CUDA 工具包存档</a>。</p></figure><p id="fe94" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">为了啰嗦起见，Ubuntu 20.04 不要尝试使用 18.10 或 18.04 CUDA 10.1。我是吃了苦头才知道的，哈哈！</p><p id="7336" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">所以，你可以在 Ubuntu 20.04 中安装 CUDA 10.1，</p><pre class="lk ll lm ln gt nr ml ns nt aw nu bi"><span id="7ef4" class="mr ms iq ml b gy nv nw l nx ny">$ sudo apt install nvidia-cuda-toolkit</span></pre><p id="8bb4" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">安装 CUDA 10.1 后，运行<code class="fe mi mj mk ml b">nvcc -V</code>。然后，您将得到与下面类似的输出，以验证您是否成功安装，</p><pre class="lk ll lm ln gt nr ml ns nt aw nu bi"><span id="bbde" class="mr ms iq ml b gy nv nw l nx ny">nvcc: NVIDIA (R) Cuda compiler driver<br/>Copyright (c) 2005-2019 NVIDIA Corporation<br/>Built on Sun_Jul_28_19:07:16_PDT_2019<br/>Cuda compilation tools, release 10.1, V10.1.243</span></pre><p id="59ce" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">与 Ubuntu 18.04(我来自的地方)不同，CUDA 在 20.04 中安装在不同的路径中，即<code class="fe mi mj mk ml b">/usr/lib/cuda</code>——你可以通过运行，</p><pre class="lk ll lm ln gt nr ml ns nt aw nu bi"><span id="23e3" class="mr ms iq ml b gy nv nw l nx ny">$ whereis cuda<br/>cuda: /usr/lib/cuda /usr/include/cuda.h</span></pre><p id="ed4d" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">在 Ubuntu 18.04 中，你可能知道，CUDA 安装在<code class="fe mi mj mk ml b">/usr/local/cuda</code>或者<code class="fe mi mj mk ml b">/usr/local/cuda-10.1</code>中。</p><h2 id="3a7d" class="mr ms iq bd mt mu mv dn mw mx my dp mz lg na nb nc lh nd ne nf li ng nh ni nj bi translated">安装 cuDNN</h2><p id="8874" class="pw-post-body-paragraph ki kj iq kl b km nk jr ko kp nl ju kr lg nm ku kv lh nn ky kz li no lc ld le ij bi translated">安装 CUDA 10.1 后，现在可以从这个<a class="ae lf" href="https://developer.nvidia.com/rdp/form/cudnn-download-survey" rel="noopener ugc nofollow" target="_blank">链接</a>下载安装 cuDNN 7.6.5。然后，选择“下载 cuDNN”，你会被要求登录或创建一个 NVIDIA 帐户。登录并接受 cuDNN 软件许可协议的条款后，您将看到可用 cuDNN 软件的列表。</p><p id="f074" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">点击“CUDA 10.1 下载 cud nn v 7 . 6 . 5(2019 . 11 . 5)”，然后选择“cuDNN Library for Linux”下载 cuDNN 7.6.5 for CUDA 10.1。下载 cuDNN 后，通过运行，</p><pre class="lk ll lm ln gt nr ml ns nt aw nu bi"><span id="f70a" class="mr ms iq ml b gy nv nw l nx ny">$ tar -xvzf cudnn-10.1-linux-x64-v7.6.5.32.tgz</span></pre><p id="1366" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">接下来，将提取的文件复制到 CUDA 安装文件夹中，</p><pre class="lk ll lm ln gt nr ml ns nt aw nu bi"><span id="8184" class="mr ms iq ml b gy nv nw l nx ny">$ sudo cp cuda/include/cudnn.h /usr/lib/cuda/include/<br/>$ sudo cp cuda/lib64/libcudnn* /usr/lib/cuda/lib64/</span></pre><p id="8c3e" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">设置 cuDNN 的文件权限，</p><pre class="lk ll lm ln gt nr ml ns nt aw nu bi"><span id="fca8" class="mr ms iq ml b gy nv nw l nx ny">$ sudo chmod a+r /usr/lib/cuda/include/cudnn.h /usr/lib/cuda/lib64/libcudnn*</span></pre><h2 id="68f7" class="mr ms iq bd mt mu mv dn mw mx my dp mz lg na nb nc lh nd ne nf li ng nh ni nj bi translated">导出 CUDA 环境变量</h2><p id="7018" class="pw-post-body-paragraph ki kj iq kl b km nk jr ko kp nl ju kr lg nm ku kv lh nn ky kz li no lc ld le ij bi translated">TensorFlow 需要 CUDA 环境变量来支持 GPU。要设置它们，我们需要通过运行，</p><pre class="lk ll lm ln gt nr ml ns nt aw nu bi"><span id="ce06" class="mr ms iq ml b gy nv nw l nx ny">$ echo 'export LD_LIBRARY_PATH=/usr/lib/cuda/lib64:$LD_LIBRARY_PATH' &gt;&gt; ~/.bashrc<br/>$ echo 'export LD_LIBRARY_PATH=/usr/lib/cuda/include:$LD_LIBRARY_PATH' &gt;&gt; ~/.bashrc</span></pre><p id="b10a" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">通过运行以下命令加载导出的环境变量:</p><pre class="lk ll lm ln gt nr ml ns nt aw nu bi"><span id="d8e8" class="mr ms iq ml b gy nv nw l nx ny">$ source ~/.bashrc</span></pre><h2 id="3a78" class="mr ms iq bd mt mu mv dn mw mx my dp mz lg na nb nc lh nd ne nf li ng nh ni nj bi translated">安装 TensorFlow 2.0</h2><p id="06ac" class="pw-post-body-paragraph ki kj iq kl b km nk jr ko kp nl ju kr lg nm ku kv lh nn ky kz li no lc ld le ij bi translated">安装好必备包后，最后就可以安装 TensorFlow 2.0 了，</p><pre class="lk ll lm ln gt nr ml ns nt aw nu bi"><span id="7e57" class="mr ms iq ml b gy nv nw l nx ny">$ pip install tensorflow==2.2.0</span></pre><p id="caed" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">默认情况下,<code class="fe mi mj mk ml b">tensorflow</code>包现在包含了 GPU 支持，而过去我们需要专门安装<code class="fe mi mj mk ml b">tensorflow-gpu</code>。</p><p id="0654" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">通过运行以下命令验证 TensorFlow 可以检测到您的 GPU，</p><pre class="lk ll lm ln gt nr ml ns nt aw nu bi"><span id="d635" class="mr ms iq ml b gy nv nw l nx ny">&gt;&gt;&gt; import tensorflow as tf<br/>&gt;&gt;&gt; tf.config.list_physical_devices("GPU")<br/>[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]</span></pre><p id="8a11" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">如果事情进展顺利，应该会有类似的输出。</p><p id="9494" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">您现在可以享受使用 TensorFlow 进行深度学习项目了！万岁！</p></div><div class="ab cl nz oa hu ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="ij ik il im in"><p id="f70e" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">如果你正在寻找一个 TensorFlow 项目，也许你会发现我的博客<a class="ae lf" rel="noopener" target="_blank" href="/implementing-an-autoencoder-in-tensorflow-2-0-5e86126e9f7">在 TensorFlow 2.0 </a>中实现自动编码器很有趣！</p><p id="00c9" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lg kt ku kv lh kx ky kz li lb lc ld le ij bi translated">另外，如果你喜欢这篇文章，也许你也会喜欢我的其他博客！</p><div class="og oh gp gr oi oj"><a href="https://medium.com/@afagarap/how-can-i-trust-you-fb433a06256c" rel="noopener follow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">我怎么能相信你？</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">关于信任分数的直觉和指南</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">medium.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox lt oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a rel="noopener follow" target="_blank" href="/avoiding-the-vanishing-gradients-problem-96183fd03343"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">使用梯度噪声添加避免消失梯度问题</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">添加梯度噪声改善了深度神经网络的学习。</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">towardsdatascience.com</p></div></div><div class="os l"><div class="oy l ou ov ow os ox lt oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a href="https://medium.com/pytorch/implementing-an-autoencoder-in-pytorch-19baa22647d1" rel="noopener follow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">在 PyTorch 中实现自动编码器</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">构建用于重建的自动编码器模型</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">medium.com</p></div></div><div class="os l"><div class="oz l ou ov ow os ox lt oj"/></div></div></a></div></div></div>    
</body>
</html>