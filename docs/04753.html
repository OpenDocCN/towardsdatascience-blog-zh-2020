<html>
<head>
<title>Confusion Matrix — Explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">混淆矩阵—已解释</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/confusion-matrix-explained-34e4be19b3ec?source=collection_archive---------46-----------------------#2020-04-26">https://towardsdatascience.com/confusion-matrix-explained-34e4be19b3ec?source=collection_archive---------46-----------------------#2020-04-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e96f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何利用混淆矩阵</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f258dd23a9d5f73d96a77079da3ad4a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HQ66bcANMBeMANbd8hRJzw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/s/photos/precise?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@hue12_photography?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> hue12摄影</a>拍摄</p></figure><p id="9bde" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分类是一种监督学习方法，其中目标变量是离散的(或分类的)。评估机器学习模型和构建它一样重要。我们正在创建模型来处理新的、以前看不到的数据。因此，需要进行全面和多方面的评估，以创建稳健的模型。当涉及到分类模型时，评估过程变得有些棘手。</p><h1 id="b30e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">困惑矩阵背后的动机</strong></h1><p id="dce1" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">准确度显示正确预测与所有预测的比率:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/916cdf7d03e4d7c55a2ccbdece3f22ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/0*qdhOkWRJb635zZo1.png"/></div></figure><p id="011d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在某些情况下，准确性不足以评估模型。假设我们为二元分类任务建立一个模型，目标变量的分布是不平衡的(93%的数据点在A类中，7%在B类中)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/fda6fdbc8745742f6384bc7f49f8363f.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/0*aS25PSViP2SskOgu.png"/></div></figure><p id="8190" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有一个只预测A类的模型，甚至很难称之为“模型”，因为它预测A类，没有任何计算。然而，由于93%的样本属于A类，因此我们的模型的准确率为93%。</p><p id="640c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果正确检测B类样本至关重要，而我们又不能对任何B类样本进行错误分类(例如癌症预测)，该怎么办？这就是混淆矩阵发挥作用的地方。</p><h1 id="44ac" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">混乱矩阵</strong></h1><p id="e8b2" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">混淆矩阵不是评估模型的指标，但它提供了对预测的洞察。学习混淆矩阵对于理解其他分类指标很重要，例如<strong class="lb iu">精度</strong>和<strong class="lb iu">召回</strong>。</p><p id="9d9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">混淆矩阵通过显示每个类别的正确和错误(即真或假)预测，比分类准确性更深入。在二进制分类任务的情况下，混淆矩阵是2×2矩阵。如果有三个不同的类，那就是一个3x3的矩阵，以此类推。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/245705d6d1c872dfe51608e9f5684329.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/0*_fe41VT0HbBQuyB-.png"/></div></figure><p id="09b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设A类是正类，B类是负类。混淆矩阵的关键术语如下:</p><ul class=""><li id="f714" class="mv mw it lb b lc ld lf lg li mx lm my lq mz lu na nb nc nd bi translated"><strong class="lb iu">真阳性(TP) </strong>:预测阳性类别为阳性(ok)</li><li id="723b" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated"><strong class="lb iu">假阳性(FP) </strong>:将阴性类别预测为阳性(不正常)</li><li id="5693" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated"><strong class="lb iu">假阴性(FN) </strong>:将阳性类别预测为阴性(不正常)</li><li id="74a6" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated"><strong class="lb iu">真阴性(TN) </strong>:预测阴性类别为阴性(ok)</li></ul><p id="fd0e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">期望的结果是预测类和实际类是相同的。这可能看起来令人困惑，但你可以想出一个窍门来记住。我的如下:</p><blockquote class="nj nk nl"><p id="e07b" class="kz la nm lb b lc ld ju le lf lg jx lh nn lj lk ll no ln lo lp np lr ls lt lu im bi translated">第二个词是模型预测的。</p><p id="0270" class="kz la nm lb b lc ld ju le lf lg jx lh nn lj lk ll no ln lo lp np lr ls lt lu im bi translated">第一个字表示预测是否正确。</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/2b56fc3587fa6ae43b47bcc3950080e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/0*lfm1IUxZUm_4OTmn.png"/></div></figure><blockquote class="nr"><p id="323f" class="ns nt it bd nu nv nw nx ny nz oa lu dk translated">注意:假阳性也称为I型错误。假阴性也称为II型错误。</p></blockquote><p id="e2f3" class="pw-post-body-paragraph kz la it lb b lc ob ju le lf oc jx lh li od lk ll lm oe lo lp lq of ls lt lu im bi translated">混淆矩阵用于计算精度和召回率。</p><h1 id="9108" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">精度和召回</strong></h1><p id="e116" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">精确度和召回率度量将分类准确性向前推进了一步，并允许我们获得对模型评估的更具体的理解。选择哪一个取决于任务和我们的目标。</p><p id="17fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> Precision </strong>衡量当预测为正时我们的模型有多好。它是正确的正面预测与所有正面<strong class="lb iu">预测</strong>的比率:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/b51626689147cbd8bb6dba62b5bacaee.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/0*XKr0Uf3atfQ5SAc5.png"/></div></figure><p id="a52c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">回忆</strong>测量我们的模型在正确预测正类方面有多好。它是正确的正面预测与所有正面<strong class="lb iu">类别</strong>的比率。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/4b68d223bad1c462f0746e6963593dfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/0*38WZpBTs45CBfj5i.png"/></div></figure><p id="9e63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">精度的焦点是<strong class="lb iu">正预测</strong>所以它<strong class="lb iu"> </strong>表示有多少正预测是真的。召回的焦点是<strong class="lb iu">实际肯定类别</strong>，因此它指示模型能够正确预测多少肯定类别。</p><p id="5003" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">精准还是召回？</strong></p><p id="30f7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们不能试图同时最大化精确度和召回率，因为它们之间有一个平衡。提高精度会降低召回率，反之亦然。我们可以根据任务来最大化精确度或回忆。</p><p id="e05f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑一个垃圾邮件检测模型，我们试图最大化精确度，因为我们希望当一封邮件被检测为垃圾邮件时是正确的。我们不想将一封普通的电子邮件标记为垃圾邮件(即误报)。如果模型不能捕捉一些垃圾邮件，这是可以接受的。但是，如果一封非常重要的电子邮件被标记为垃圾邮件，后果可能会很严重。</p><p id="8402" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一方面，对于取消细胞检测任务，我们需要最大化召回，因为我们想要检测每个阳性类别(恶性细胞)。如果模型预测恶性细胞为良性(即假阴性)，这将是一个严重的错误。</p><p id="ac14" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有一个将精确度和召回率结合成一个数字的方法，那就是F1分数。</p><h1 id="22bc" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">F1分数</h1><p id="ccf8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">F1分数是精确度和召回率的加权平均值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/378439a395fa57a1ce424b553d1f6163.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/0*XZmUHjEd9Z3nJlYc.png"/></div></figure><p id="4db9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于类别分布不均匀的问题，F1分数是比准确度更有用的度量，因为它考虑了假阳性和假阴性。</p><p id="2830" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">f1得分的最佳值是1，最差值是0。</p><h1 id="29de" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">敏感性和特异性</h1><p id="d97d" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">敏感度，也称为真阳性率(TPR)，与回忆相同。因此，它测量被正确预测为阳性的阳性类别的比例。</p><p id="c03c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">特异性类似于敏感性，但侧重于负类。它测量被正确预测为负面的负面类别的比例。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/2e1cfeac7e2fb3feefa4583f049660d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DHCCtS6xipsetZ4e.png"/></div></div></figure></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><h1 id="7f31" class="lv lw it bd lx ly or ma mb mc os me mf jz ot ka mh kc ou kd mj kf ov kg ml mm bi translated">结论</h1><p id="d2cf" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">免费的午餐定理在这里也不适用。对于所有的任务，没有一个最优的、容易找到的选择。我们需要清楚地定义需求，并根据这些需求选择度量标准。</p></div><div class="ab cl ok ol hx om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="im in io ip iq"><p id="47c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>