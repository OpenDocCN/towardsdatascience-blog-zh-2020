<html>
<head>
<title>Image Classifier — House Room Type Classification using the Monk Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">影像分类器-使用 Monk 库进行房屋类型分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-classifier-house-room-type-classification-using-monk-library-d633795a42ef?source=collection_archive---------24-----------------------#2020-08-05">https://towardsdatascience.com/image-classifier-house-room-type-classification-using-monk-library-d633795a42ef?source=collection_archive---------24-----------------------#2020-08-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="847e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于如何使用 Monk 库解决计算机视觉分类问题的文章。</h2></div><p id="bde4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这篇文章是一个关于如何使用 Monk 库来分类房间类型的教程，比如客厅、餐厅等等。</p><p id="da59" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">详细教程可在<a class="ae le" href="https://github.com/Tessellate-Imaging/monk_v1/blob/master/study_roadmaps/4_image_classification_zoo/Classifier%20-%20House%20room%20type%20Claasification.ipynb" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/5e8aa3650adb7132617c1507af275b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H93IWX3LNsFNCOdDgGBCBA.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">数据集中的一些样本图像</p></figure><h2 id="3dd1" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">关于数据集</h2><ul class=""><li id="301e" class="mo mp it kk b kl mq ko mr kr ms kv mt kz mu ld mv mw mx my bi translated">该数据集包含总共 145436 幅图像，分为七类，即“外部”、“卧室”、“厨房”、“起居室”、“内部”、“浴室”、“餐厅”。</li><li id="9158" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">可以从<a class="ae le" href="https://drive.google.com/file/d/0BxDIywue_VABY1dRcFVvZ3BodnM/view?usp=sharing" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</li></ul><h2 id="8e66" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">关于 Monk 库和 Monk 如何让图像分类变得简单</h2><ul class=""><li id="867b" class="mo mp it kk b kl mq ko mr kr ms kv mt kz mu ld mv mw mx my bi translated">编写更少的代码，创建端到端的应用程序。</li><li id="8bc7" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">只学习一种语法，使用任何深度学习库——py torch、Mxnet、Keras、TensorFlow 等，创建应用。</li><li id="9869" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">通过多个实验轻松管理您的整个项目。</li></ul><h2 id="e59e" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">这座图书馆是为谁而建的</h2><ul class=""><li id="fc5e" class="mo mp it kk b kl mq ko mr kr ms kv mt kz mu ld mv mw mx my bi translated">学生:使用我们的综合学习路线图无缝学习计算机视觉。</li><li id="ddeb" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">研究人员和开发人员:创建和管理多个深度学习项目。</li><li id="cd69" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">Kaggle、Codalab、HackerEarth、AiCrowd 等上的比赛参与者。</li></ul><h1 id="4d19" class="ne lw it bd lx nf ng nh ma ni nj nk md jz nl ka mg kc nm kd mj kf nn kg mm no bi translated">目录</h1><ol class=""><li id="90c2" class="mo mp it kk b kl mq ko mr kr ms kv mt kz mu ld np mw mx my bi translated">安装 Monk</li></ol><p id="25d0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">2.将预训练模型用于部分房屋分类数据集</p><p id="4508" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">3.从头开始训练分类器</p><ul class=""><li id="3028" class="mo mp it kk b kl km ko kp kr nq kv nr kz ns ld mv mw mx my bi translated"><em class="nt">使用 ResNet 变体训练部分 house 分类器</em></li><li id="b778" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated"><em class="nt">了解在 ResNets 变体之间切换时发生的所有差异。</em></li><li id="0c24" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated"><em class="nt">理解更大更深的网络并不总是意味着更好的结果</em></li><li id="df5a" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated"><em class="nt">在这个实验中，您将使用 mxnet 后端</em></li></ul><p id="2832" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">4.结论。</p><h1 id="10de" class="ne lw it bd lx nf ng nh ma ni nj nk md jz nl ka mg kc nm kd mj kf nn kg mm no bi translated">1.安装 Monk</h1><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="353a" class="lv lw it nv b gy nz oa l ob oc"><em class="nt">#using cuda10.0 download monk using following command</em></span><span id="c8d1" class="lv lw it nv b gy od oa l ob oc"><strong class="nv iu">pip install -U monk-gluon-cuda100</strong></span></pre><p id="b393" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更多安装方法请访问<a class="ae le" href="https://github.com/Tessellate-Imaging/monk_v1#installation" rel="noopener ugc nofollow" target="_blank"> Monk 库</a>。</p><h1 id="25fe" class="ne lw it bd lx nf ng nh ma ni nj nk md jz nl ka mg kc nm kd mj kf nn kg mm no bi translated">2.使用预先训练好的模型进行演示</h1><p id="fbbd" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr oe kt ku kv of kx ky kz og lb lc ld im bi translated">首先，从 google drive 下载预先训练好的模型。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="7afb" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">! wget --load-cookies /tmp/cookies.txt "https://docs.google.com/uc?export=download&amp;confirm=$(wget --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&amp;id=10SrowcOJp8GWqEB21BfCIinqUCHS7PMv' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\1\n/p')&amp;id=10SrowcOJp8GWqEB21BfCIinqUCHS7PMv" -O cls_house_scene_trained.zip &amp;&amp; rm -rf /tmp/cookies.txt</strong></span></pre><p id="2a9d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面会下载预训练模型的 zip 文件，命名为 cls_house_scene_trained.zip，现在我们要解压文件了。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="91d4" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">! unzip -qq cls_house_scene_trained.zip</strong></span></pre><p id="d95b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">导入<strong class="kk iu"><em class="nt">monk . glon _ prototype</em></strong><em class="nt"/>用于使用和尚库。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="8c20" class="lv lw it nv b gy nz oa l ob oc"><em class="nt">#Using mxnet-gluon backend</em><br/><br/><em class="nt"># When installed using pip</em><br/><strong class="nv iu">from</strong> <strong class="nv iu">monk.gluon_prototype</strong> <strong class="nv iu">import</strong> <strong class="nv iu">prototype</strong></span></pre><p id="30a9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们以推断模式加载模型，对演示数据进行分类。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="5b78" class="lv lw it nv b gy nz oa l ob oc"><em class="nt"># Load project in inference mode</em><br/><br/><strong class="nv iu">gtf = prototype(verbose=1);<br/>gtf.Prototype("Task", "gluon_resnet18_v1_train_all_layers", eval_infer=True);</strong></span></pre><h2 id="ca14" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">根据一些样本推断</h2><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="a2cc" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">img_name = "workspace/test/2.jpg"<br/>predictions = gtf.Infer(img_name=img_name);<br/>from IPython.display import Image<br/>Image(filename=img_name, height=300, width=300)</strong></span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/ef848e0bf5db4a70184e365e4c8ef068.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*O0OqZYgdSLfqPiwTxC5y4g.png"/></div></figure><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="f694" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">img_name = "workspace/test/3.jpg"<br/>predictions = gtf.Infer(img_name=img_name);<br/>from IPython.display import Image<br/>Image(filename=img_name, height=300, width=300)</strong></span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/33659aa8f7f718aa3fca6df6f6fcbd6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*NYIE0rwVLVyYzdTjRQBYwA.png"/></div></figure><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="e4f3" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">img_name = "workspace/test/6.jpg"<br/>predictions = gtf.Infer(img_name=img_name);<br/>from IPython.display import Image<br/>Image(filename=img_name, height=300, width=300)</strong></span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/b6cec8bce1f0e097a72dd5b597895437.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*l5HmyWIkIHjdcKQ2yYCS8g.png"/></div></figure><p id="28c9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更多例子请访问<a class="ae le" href="https://github.com/Tessellate-Imaging/monk_v1/blob/master/study_roadmaps/4_image_classification_zoo/Classifier%20-%20House%20room%20type%20Claasification.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>。</p><h1 id="78ee" class="ne lw it bd lx nf ng nh ma ni nj nk md jz nl ka mg kc nm kd mj kf nn kg mm no bi translated">3.<strong class="ak">从头开始训练自定义分类器</strong></h1><h2 id="2fc0" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">什么是 ResNet？</h2><p id="d012" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr oe kt ku kv of kx ky kz og lb lc ld im bi translated">来自<a class="ae le" rel="noopener" target="_blank" href="/an-overview-of-resnet-and-its-variants-5281e2f56035">https://towards data science . com/an-overview-of-resnet-and-its-variants-5281 e2f 56035</a></p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="be93" class="lv lw it nv b gy nz oa l ob oc">- The core idea of ResNet is introducing a so-called “identity shortcut connection” that <strong class="nv iu">skips one or more layers</strong><br/>- The deeper model should not produce a training error higher than its shallower counterparts.<br/>- solves the problem of <strong class="nv iu">vanishing gradients</strong> as network depth increased</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ok"><img src="../Images/56a47eb7346a54f73e8759c3cc8afd87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PLDIbqMGxoSqWKsiqAGF4g.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">ResNet18 架构</p></figure><h2 id="1768" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">近期内容</h2><ol class=""><li id="3613" class="mo mp it kk b kl mq ko mr kr ms kv mt kz mu ld np mw mx my bi translated">加载数据集</li><li id="065b" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld np mw mx my bi translated">训练模型采用 resnet18_v1(只训练最后一层)架构进行迁移学习。</li><li id="851e" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld np mw mx my bi translated">训练模型采用 resnet18_v1(训练所有层)架构进行迁移学习。</li><li id="0956" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld np mw mx my bi translated">训练模型采用 resnet18_v2(只训练最后一层)架构进行迁移学习。</li><li id="c293" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld np mw mx my bi translated">训练模型采用 resnet34_v1(只训练最后一层)架构进行迁移学习。</li><li id="8ccb" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld np mw mx my bi translated">比较所有的型号。</li></ol><h2 id="95de" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">1.加载数据集</h2><p id="d48a" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr oe kt ku kv of kx ky kz og lb lc ld im bi translated">数据集学分:<a class="ae le" href="https://omidpoursaeed.github.io/publication/vision-based-real-estate-price-estimation/" rel="noopener ugc nofollow" target="_blank">https://omidpoursaeed . github . io/publication/vision-based-real-estate-price-estimate/</a></p><p id="6538" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤 1:下载数据集。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="ea4e" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">! wget --load-cookies /tmp/cookies.txt "https://docs.google.com/uc?export=download&amp;confirm=$(wget --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&amp;id=0BxDIywue_VABY1dRcFVvZ3BodnM' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\1\n/p')&amp;id=0BxDIywue_VABY1dRcFVvZ3BodnM" -O dataset.zip &amp;&amp; rm -rf /tmp/cookies.txt</strong></span></pre><p id="45e0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤 2:解压缩数据集。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="47f9" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">! unzip -qq dataset.zip</strong></span></pre><h2 id="b355" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">2.训练模型采用 resnet18_v1(只训练最后一层)架构进行迁移学习。</h2><p id="06dd" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr oe kt ku kv of kx ky kz og lb lc ld im bi translated">步骤 1:加载实验并插入数据。更多详情请访问<a class="ae le" href="https://clever-noyce-f9d43f.netlify.app/#/quick_mode/quickmode_gluon" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="e5b8" class="lv lw it nv b gy nz oa l ob oc"><em class="nt"># Load experiment</em><br/><strong class="nv iu">monk_gln = prototype(verbose=1);<br/>monk_gln.Prototype("Task", "gluon_resnet18_v1");<br/><br/></strong><em class="nt"># Insert data and set params in default mode</em><br/><strong class="nv iu">monk_gln.Default(dataset_path="Train", <br/>            model_name="resnet18_v1", <br/>            freeze_base_network=True,<br/>            num_epochs=10);</strong></span></pre><p id="643e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤 2:训练模型。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="75ea" class="lv lw it nv b gy nz oa l ob oc"><em class="nt">#Start Training</em><br/><strong class="nv iu">monk_gln.Train();</strong></span></pre><h2 id="4bb1" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">3.训练模型采用 resnet18_v1(训练所有层)架构进行迁移学习。</h2><p id="d4f0" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr oe kt ku kv of kx ky kz og lb lc ld im bi translated">步骤 1:加载实验并插入数据。更多详情<a class="ae le" href="https://clever-noyce-f9d43f.netlify.app/#/quick_mode/quickmode_gluon" rel="noopener ugc nofollow" target="_blank">请访问</a>。参数<strong class="kk iu"><em class="nt">freeze _ base _ network</em></strong><em class="nt"/>将被设置为 false 以训练所有层。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="0554" class="lv lw it nv b gy nz oa l ob oc"><em class="nt"># Load experiment</em><br/><strong class="nv iu">monk_gln = prototype(verbose=1);<br/>monk_gln.Prototype("Task", "gluon_resnet18_v1_train_all_layers");</strong><br/><br/><em class="nt"># Insert data and set params in default mode</em><br/><strong class="nv iu">monk_gln.Default(dataset_path="Train", <br/>            model_name="resnet18_v1", <br/>            freeze_base_network=False,<br/>            num_epochs=10);</strong></span></pre><p id="9004" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤 2:训练模型。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="de5c" class="lv lw it nv b gy nz oa l ob oc"><em class="nt">#Start Training</em><br/><strong class="nv iu">monk_gln.Train();</strong></span></pre><h2 id="4088" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">4.训练模型采用 resnet18_v2(只训练最后一层)架构进行迁移学习。</h2><p id="a521" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr oe kt ku kv of kx ky kz og lb lc ld im bi translated">步骤 1:加载实验并插入数据。欲了解更多详情<a class="ae le" href="https://clever-noyce-f9d43f.netlify.app/#/quick_mode/quickmode_gluon" rel="noopener ugc nofollow" target="_blank">，请访问</a>。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="8809" class="lv lw it nv b gy nz oa l ob oc"><em class="nt"># Load experiment</em><strong class="nv iu"><br/>monk_gln = prototype(verbose=1);<br/>monk_gln.Prototype("Task", "gluon-resnet18_v2");</strong><br/><br/><em class="nt"># Insert data and set params in default mode</em><br/><strong class="nv iu">monk_gln.Default(dataset_path="Train", <br/>            model_name="resnet18_v2", <br/>            freeze_base_network=True,<br/>            num_epochs=10);</strong></span></pre><p id="2825" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤 2:训练模型。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="6354" class="lv lw it nv b gy nz oa l ob oc"><em class="nt">#Start Training</em><br/><strong class="nv iu">monk_gln.Train()</strong></span></pre><h2 id="ff4b" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated"><strong class="ak"> 5。训练模型采用 resnet34_v1( </strong>只训练最后一层)<strong class="ak">架构进行迁移学习。</strong></h2><p id="6b1d" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr oe kt ku kv of kx ky kz og lb lc ld im bi translated">步骤 1:加载实验并插入数据。更多详情请访问。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="14ee" class="lv lw it nv b gy nz oa l ob oc"><em class="nt"># Load experiment</em><strong class="nv iu"><br/>monk_gln = prototype(verbose=1);<br/>monk_gln.Prototype("Task", "gluon-resnet18_v2");</strong></span><span id="f3f7" class="lv lw it nv b gy od oa l ob oc"><em class="nt"># Insert data and set params in default mode</em><br/><strong class="nv iu">monk_gln.Default(dataset_path="Train", <br/>            model_name="resnet34_v1", <br/>            freeze_base_network=True,<br/>            num_epochs=10);</strong></span></pre><p id="b9fe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤 2:训练模型。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="9859" class="lv lw it nv b gy nz oa l ob oc"><em class="nt">#Start Training</em><br/><strong class="nv iu">monk_gln.Train()</strong></span></pre><h2 id="310d" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">6.比较所有的模型。</h2><p id="726d" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr oe kt ku kv of kx ky kz og lb lc ld im bi translated">步骤 1:使用 Monk 库的比较类。更多详情请访问。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="22f2" class="lv lw it nv b gy nz oa l ob oc"><em class="nt"># Invoke the comparison class</em><br/><strong class="nv iu">from</strong> <strong class="nv iu">monk.compare_prototype</strong> <strong class="nv iu">import</strong> <strong class="nv iu">compare</strong></span></pre><p id="9460" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤 2:创建和管理比较实验。提供项目名称。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="3cd8" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">gtf = compare(verbose=1);<br/>gtf.Comparison("Comparison-1");</strong></span></pre><p id="5b1d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这将按照以下结构创建文件和目录</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="1fb4" class="lv lw it nv b gy nz oa l ob oc">workspace<br/>    |<br/>    |--------comparison<br/>                    |<br/>                    |<br/>                    |-----Compare-1<br/>                                |<br/>                                |------stats_best_val_acc.png<br/>                                |------stats_max_gpu_usage.png<br/>                                |------stats_training_time.png<br/>                                |------train_accuracy.png<br/>                                |------train_loss.png<br/>                                |------val_accuracy.png<br/>                                |------val_loss.png                    <br/>                    |-----comparison.csv (Contains necessary details of all experiments)</span></pre><p id="b40c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤 3:将实验添加到比较对象中。</p><ul class=""><li id="8923" class="mo mp it kk b kl km ko kp kr nq kv nr kz ns ld mv mw mx my bi translated">第一个参数——项目名称。</li><li id="ba7c" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld mv mw mx my bi translated">第二个参数——实验名称。</li></ul><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="5ca4" class="lv lw it nv b gy nz oa l ob oc"><em class="nt">#add the models trained above.</em><strong class="nv iu"><br/>gtf.Add_Experiment("Task", "gluon_resnet18_v1");<br/>gtf.Add_Experiment("Task", "gluon_resnet18_v1_train_all_layers");<br/>gtf.Add_Experiment("Task", "gluon-resnet18_v2");<br/>gtf.Add_Experiment("Task", "gluon-resnet34_v1");</strong></span></pre><p id="0c01" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤 4:运行分析。该步骤生成七幅图像。</p><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="9189" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">gtf.Generate_Statistics();</strong></span></pre><p id="6d18" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤 5:可视化研究比较指标。</p><ul class=""><li id="688b" class="mo mp it kk b kl km ko kp kr nq kv nr kz ns ld mv mw mx my bi translated">训练准确度曲线</li></ul><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="a51d" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">from IPython.display import Image<br/>Image(filename="workspace/comparison/Comparison-1/train_accuracy.png")</strong></span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ol"><img src="../Images/32f46d975ddce871795b3ab0b646285f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3S4FDCm_MftCbqNo3GsL2g.png"/></div></div></figure><ul class=""><li id="bdf9" class="mo mp it kk b kl km ko kp kr nq kv nr kz ns ld mv mw mx my bi translated">训练损失曲线</li></ul><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="66c1" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">Image(filename="workspace/comparison/Comparison-1/train_loss.png")</strong></span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ol"><img src="../Images/b4f5f9fa6037a66471367285303e3007.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SUKZdMWCsgHuu8y2000FZQ.png"/></div></div></figure><ul class=""><li id="2530" class="mo mp it kk b kl km ko kp kr nq kv nr kz ns ld mv mw mx my bi translated">验证准确度曲线</li></ul><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="31fa" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">Image(filename="workspace/comparison/Comparison-1/val_accuracy.png")</strong></span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ol"><img src="../Images/f3cb7dff2ddb61534bd472b6123b2698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AvwE0mPindmLhu6m7wTN2g.png"/></div></div></figure><ul class=""><li id="4811" class="mo mp it kk b kl km ko kp kr nq kv nr kz ns ld mv mw mx my bi translated">验证损失曲线</li></ul><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="2c41" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">Image(filename="workspace/comparison/Comparison-1/val_loss.png")</strong></span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ol"><img src="../Images/72e23d6cdda91e5848abaaa3d5a205f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rOsgMtgSV0MSCIaCPtTRuQ.png"/></div></div></figure><ul class=""><li id="208b" class="mo mp it kk b kl km ko kp kr nq kv nr kz ns ld mv mw mx my bi translated">培训时间被占用</li></ul><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="9b40" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">Image(filename="workspace/comparison/Comparison-1/stats_training_time.png")</strong></span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ol"><img src="../Images/a79b98ff54645813efacad97a6f6aa56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HEQcmBS-Vwdy-sijFzoL7g.png"/></div></div></figure><ul class=""><li id="1086" class="mo mp it kk b kl km ko kp kr nq kv nr kz ns ld mv mw mx my bi translated">最大 GPU 使用率</li></ul><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="85ef" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">Image(filename="workspace/comparison/Comparison-1/stats_max_gpu_usage.png")</strong></span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ol"><img src="../Images/f76bbcc16b3af5b315ae49842e75178f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ufFobvQ5wrpPJD4iy2Qe5A.png"/></div></div></figure><ul class=""><li id="4ad9" class="mo mp it kk b kl km ko kp kr nq kv nr kz ns ld mv mw mx my bi translated">最佳验证准确性</li></ul><pre class="lg lh li lj gt nu nv nw nx aw ny bi"><span id="d5d4" class="lv lw it nv b gy nz oa l ob oc"><strong class="nv iu">Image(filename="workspace/comparison/Comparison-1/stats_best_val_acc.png")</strong></span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ol"><img src="../Images/3f01db2e990b819aa770790f0f7951b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zqVAnsYBI5te31ulOOyphA.png"/></div></div></figure><h1 id="fd0f" class="ne lw it bd lx nf ng nh ma ni nj nk md jz nl ka mg kc nm kd mj kf nn kg mm no bi translated">结论</h1><ol class=""><li id="8f08" class="mo mp it kk b kl mq ko mr kr ms kv mt kz mu ld np mw mx my bi translated">Monk library 让学生、研究人员和竞争对手可以非常轻松地创建深度学习模型，并尝试不同的超参数调整来提高模型的准确性。</li><li id="f3ff" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld np mw mx my bi translated">预先训练的模型可以直接下载使用，而无需进入模型创建部分。</li><li id="d568" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld np mw mx my bi translated">从上面的图表中，我们可以看到，在这个数据集中，所有层都是可训练的模型比其他模型更准确。但这并不总是正确的，所以直到明智的尝试两者。</li><li id="7fcf" class="mo mp it kk b kl mz ko na kr nb kv nc kz nd ld np mw mx my bi translated">此外，与仅最后一层可训练的模型相比，所有层可训练时所花费的时间大约多 40%。</li></ol><h2 id="fac8" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated">感谢阅读。请给出你的建议。</h2><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/3cffcc23a3bdde0ec87c128b6d0ca8af.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/1*x5_q0fLXelcDMZfA4luH7w.gif"/></div></figure><p id="35dd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Rohit 是一个 BTech。最后一年学生。他有机器学习和深度学习的知识。他有兴趣在人工智能和人工智能领域工作。目前，他在 Tessellate Imaging 担任计算机视觉实习生。在<a class="ae le" href="https://www.linkedin.com/in/rohit96/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上和他联系。</p></div></div>    
</body>
</html>