# 直观来看，神经网络是如何工作的？

> 原文：<https://towardsdatascience.com/intuitively-how-do-neural-networks-work-d7710b602e51?source=collection_archive---------27----------------------->

## 直观地

## “神经网络”这个术语可能看起来很神秘，为什么一个算法叫做神经网络？它真的能模仿真正的神经元吗，又是如何模仿的呢？

在我上一篇关于 [*直观上，我们如何理解不同的分类算法*](/intuitively-how-can-we-understand-different-classification-algorithms-principles-d45cf8ef54e3) 的文章中，我介绍了分类算法的主要原理。然而，我使用的玩具数据非常简单，几乎是线性可分的数据；在现实生活中，数据几乎总是**非线性**，所以我们应该让我们的算法能够处理非线性可分数据。

# 简单逻辑回归和非线性数据

让我们比较一下逻辑回归对于几乎线性可分数据和非线性可分数据的表现。

通过下面的两个玩具数据，我们可以看到，当数据几乎是线性可分时，逻辑回归有助于我们找到决策边界，但当数据不是线性可分数据时，逻辑回归无法找到明确的决策边界。这是可以理解的，因为逻辑回归只能将数据分成两部分。

![](img/6901f7f60886de5afd63b81bcfe007e2.png)![](img/b200f7712121bc9c9620ea4285728f18.png)

在本文中，我们将尝试以不同的方式重用逻辑回归，并尝试使其适用于非线性数据。

# 组合逻辑回归

当观察蓝点和红点时，数据是非线性的，因为我们可以看到有 3 个部分，我们应该找到两个决策边界。那么，如果…如果我们试着结合两个逻辑回归会怎么样？

例如，我们有这两个基于逻辑回归的模型。

![](img/b24a151d77bebc4e8ae5013493074504.png)![](img/976eb29e3546afe4ad007778c8de0464.png)

我们称它们为 h1 和 h2。

![](img/5305936bcc5bf8dfa22be7d76069f4ae.png)![](img/176807d486126a92126a6a23cdce2e8e.png)

然后，我们可以将 h1 和 h2 结合起来，用另一个逻辑回归进行最终预测。

![](img/f66c994fd5750c9f4a2612a971b22aaa.png)

然后，您可以用 h1 和 h2 各自的逻辑函数表达式来替换它们:

![](img/9851b0e7a3d137e16b88cd5bb50a83ee.png)

然后我们可以通过找到不同的系数来解决问题，你猜怎么着，最终的结果是相当令人满意的:我们可以看到，两个组合的 Logistic 回归给了我们两个决策边界。

![](img/ee35feed546f3be2326581ec79f0b3cc.png)

# 更好的表现

让我们回到我们模型的最终表达式:

![](img/9851b0e7a3d137e16b88cd5bb50a83ee.png)

**这个表情可能看起来挺吓人的。让我们给它加点艺术感。**

让我们画一些东西来以更易读的方式表示这些函数:

![](img/2682a71ba0952985dbe72ead41248a60.png)

横向来看，甚至会更好:

![](img/b043fe6196d21f91748b6baca365f090.png)

让我们指定所有要确定的系数，我们可以将它们放在线上，这样更容易理解:

![](img/67841e33b568bbf44a57395d08b7763c.png)

我们可以将线性函数和 sigmoid 函数分开，以更好地提高可读性。

![](img/20eaa8de2ea6d86fa53dab1418785060.png)

长方形？不，圆圈更好。等等，你看到我看到的了吗？

![](img/8a2b3b66e49185e9e03fdcb42f872357.png)

哇，它们就像…神经元！

![](img/ac8ef6055cf870ccf73615e25b04758d.png)

图片来自 123rf

我们可以添加更多的颜色使它更好。连接代表重量，我们可以让它们变粗来代表更大的数字。用一种颜色，我们可以代表这个符号。

*   这里，绿色是正的，红色是负的。

![](img/95e0dbce360592426a4bb56d16a25d12.png)

数学家是艺术家！

# 神经网络词汇

现在让我们围绕这个神经网络创造一个全新的世界。

让我们创建不同的层:输入、输出和隐藏层。

![](img/de2988e270184275312542df65b13047.png)

当计算给定输入值的输出值时，必须遍历所有隐藏层。所以你会从左边走到右边。姑且称之为“**正向传播**”。

最后，您将计算出一个估计的输出，并且您必须将它与实际输出进行比较。这个误差将帮助我们微调权重。为此，我们可以使用梯度下降，我们必须计算不同的导数。

由于最终会计算误差，因此我们会在输出层之前调整神经元的权重。我们总是会从右向左调整。所以姑且称之为“**反向传播**”。

# 二维空间会发生什么

现在让我们考虑两个输入变量，这是玩具数据。

![](img/53141deef434e45bd3975ba374b41e92.png)

直观上，我们可以看到两个决策边界就足够了。所以让我们应用两个隐藏的神经元:

![](img/220aa4d63f85c0bc6726e010a1242fca.png)![](img/dfc5c50bc3c3c326e825910864fbb0c3.png)![](img/be0445ab3421f265bf5851373d9cf9c1.png)

然后，我们可以通过用周围区域数据测试神经网络来可视化最终结果。我们可以看到模型做得相当好。

现在，既然我们知道在神经网络内部只有逻辑回归，我们可以尝试将转换的不同步骤可视化。

## 隐藏层转换

让我们看看 H1:输入数据是原始的蓝点和红点。H1 是一个有两个输入变量的逻辑回归，所以结果是一个表面。

![](img/6fcf91f577a5c83e58a7d4d25f0fe87d.png)![](img/611b9f792bb75f8a920bfed67c3fcbee.png)

然后第二个隐藏神经元 H2 是类似的。

![](img/e6e84ed768a4e50f3e64264381a6d2d0.png)![](img/2c94f0aa5746f3dbd5448cf6c78a3060.png)

输出图层 O1 是一个逻辑回归，也接受两个输入，因此我们也有一个表面来表示结果。而 O1 的输入是数值在 0 和 1 之间的两个数据系列，因为它们是两个逻辑回归的结果。然后我们可以看到，如果我们取值 0.5 到表面，最初的蓝点和红点可以线性分成两部分。

![](img/c1730c8e5ef0e95cf3e01f03dcdb2197.png)![](img/2cab418253e21d12e3a1a70d7a54cacb.png)

那么在这个神经网络中发生了什么呢？在某种意义上，我们可以说**神经网络将非线性可分离的数据转化为几乎线性可分离的数据。**

## 另一个可视化

隐藏层有两个神经元，所以是二维的。因此，如果我们想看到这种转变，我们希望看到点是如何在平面上移动的。我们知道这些点的最终位置在单位正方形(0，1)x(0，1)中。

![](img/228e247ace2125f02b20976932453f45.png)

我们可以分别看到蓝点和红点。**注意，箭头指向最终位置。**

![](img/3a838478b69e8f5ef6e69e711843e041.png)![](img/04c3bf44455914d02b01cfd637c65570.png)

然后我们可以看到最后的逻辑回归。

原始数据不是线性可分的，但是经过变换后，它们被移动到单位正方形中，在那里它们变得几乎线性可分。

![](img/9fa32ac2cc7aee08d066c0a8aa6b0aac.png)![](img/0df8d88a75ba068d0cda4b70126aad09.png)

# 另一个更复杂数据的可视化

现在让我们考虑另一个玩具数据。凭直觉，你会应用多少个隐藏神经元？

![](img/3d677b32865f28fe1654cde74d0c04b1.png)

嗯，3 个神经元就足够了，如下图所示:

![](img/db247f0f9619cfb69ce595d482d9bf4f.png)![](img/775106b9907269f1c2bfc669788eedac.png)![](img/f27e742205aa9067994567790dad8cf1.png)

我们可以看到每个神经元的逻辑回归曲面。

![](img/254b5db3a944f64e88c5b018e98eb31f.png)![](img/97aa7edc6005efecc9c991d8546ee690.png)

隐藏神经元 2

![](img/41b0e8850aa3e6332227ada7a79050a2.png)![](img/c528d0223b38d127674c64586220dfb6.png)

隐藏神经元 3

![](img/b2699c840f0944b9820e209e585adac1.png)![](img/d846011f31f8b30009b33b6603067094.png)

对于输出神经元，它有 3 个输入(因为它们是逻辑回归的结果，值在 0 和 1 之间)，我们可以在一个单位立方体中可视化它们。

![](img/1ac834552da68e6f0c905aae53160075.png)![](img/d47af0a9038efde909afb3a7eb31005b.png)![](img/23ea03f9dbd6262e71b7ab54da20719e.png)

我们可以创建一个动画来更好地可视化

![](img/c45534202a071bf6caca3d510cc32849.png)

让我们回顾一下:

*   初始 2D 数据不是线性可分的。
*   它们被转换成 3D 空间(在一个隐藏层中有 3 个神经元)。
*   经过变换后，它们变得几乎线性可分。
*   最后，简单的逻辑回归允许我们对转换后的数据进行线性分类。
*   最终的逻辑回归有 3 个输入变量。因此该模型可以预测三维空间中每个点的概率。这就是为什么我们可以看到立方体充满了彩色点。决策边界是一个曲面。

更复杂的神经网络可以捕捉甚至更复杂的输入数据关系。但我们可以看到原理相当简单:**隐藏神经元的目的是将非线性可分离的数据转换到一个可以线性分离的空间。**

如果你对其他分类器如何处理非线性可分离数据感兴趣，你可以看看下面的文章:

[](/intuitively-how-can-we-build-non-linear-classifiers-10c381ed633e) [## 凭直觉，我们如何建立非线性分类器

### 现实生活中的问题通常是非线性的，所以让我们看看算法是如何处理非线性可分数据的。

towardsdatascience.com](/intuitively-how-can-we-build-non-linear-classifiers-10c381ed633e)