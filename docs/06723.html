<html>
<head>
<title>Automate Data Imports with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python自动导入数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automated-data-import-with-python-832e8f912845?source=collection_archive---------40-----------------------#2020-05-26">https://towardsdatascience.com/automated-data-import-with-python-832e8f912845?source=collection_archive---------40-----------------------#2020-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e761" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">python中数据文件导入的自动化方法。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7a045b0d9a1e3c0a53d72f5c5005d69e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ptMVo9mZOUAnKpFyoLv3w.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">SpaceX 在<a class="ae kv" href="https://unsplash.com/?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的<a class="ae kv" href="https://unsplash.com/@spacex?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="65f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据导入在数据科学中起着举足轻重的作用。知道如何做可以防止模型失败的可能性。为了实现这一点，不同的方法取决于数据类型(例如csv，。txt，。json)，都有可能。</p><p id="0038" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将数据放入python环境是构建模型的基本步骤之一。在某些情况下，我们必须在不使用API或SQL数据库的情况下加载数据。在本教程中，我将介绍如何在Python中自动加载数据。编译这个可能有点棘手。此外，有可能找到一种简单的方法来做这件事。但是我想让你看看我复杂的方法。所以让我们开始吧。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="f9ec" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">入门指南</h2><p id="3093" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">在开始之前，让我们使用以下命令导入必需的库。在适当的时候，我会解释为什么我们需要这些模块。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="ad71" class="lz ma iq my b gy nc nd l ne nf">import pandas as pd<br/>import os<br/>from os import listdir<br/>from os.path import isfile,join<br/>import csv</span></pre><p id="f3ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图显示了包含几种数据文件类型的数据文件夹。请记住文件名。我们将使用它们来创建变量名。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/bc898fcf5848d44bcf1a424c8069bebd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/0*ZiTVkx-cLVxqNnq5.png"/></div></figure><p id="161a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通常，我宁愿将我的工作目录指定为文件路径。这让我可以快速地组合文件路径和文件夹名称。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="0b03" class="lz ma iq my b gy nc nd l ne nf"><strong class="my ir">#assign working directory to variable</strong><br/>file_path=os.getcwd()</span><span id="3ae5" class="lz ma iq my b gy nh nd l ne nf"><strong class="my ir">#setting path for data folder</strong><br/>data_path=file_path+'\\'+'data'</span></pre><h2 id="cf00" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">提取文件名</h2><p id="38ac" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">这一步至关重要，因为我们将从文件名中生成变量名。有两种不同的代码来提取文件名。第一个有扩展，另一个没有扩展。我们使用<strong class="ky ir"> <em class="ni">【列表目录】</em> </strong>和<strong class="ky ir"><em class="ni">【is file】</em></strong>方法获取文件名。<strong class="ky ir"><em class="ni">【listdir】</em></strong>方法是获取指定目录下所有文件的列表。在我们的代码中，目录是<strong class="ky ir"><em class="ni">【data _ path】</em></strong>，这是我们不久前分配给我们的工作目录。所以，<strong class="ky ir"><em class="ni">【is file】</em></strong>方法检查该文件是否存在于该文件夹中。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="5d91" class="lz ma iq my b gy nc nd l ne nf"><strong class="my ir"># extracting file names without extensions</strong><br/>file_names=[".".join(f.split(".")[:-1]) for f in listdir(data_path) if isfile (join(data_path,f))] </span><span id="4eeb" class="lz ma iq my b gy nh nd l ne nf"><strong class="my ir"># extracting file names with extensions</strong><br/>full_file_names=[f for f in listdir(data_path) if isfile (join(data_path,f))]</span><span id="b36e" class="lz ma iq my b gy nh nd l ne nf"><strong class="my ir">#checking file names and extensions<br/></strong>print(file_names)<br/>print(full_file_names)</span></pre><h2 id="faaa" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">获取分隔符</h2><p id="a9a0" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">到目前为止，一切都很好。现在是时候检测文件中使用哪个分隔符作为分隔符了。要做到这一点，我们需要由"<strong class="ky ir"><em class="ni"/></strong>类提供的<strong class="ky ir"><em class="ni"/></strong>方法。这个类用于推导csv文件的格式。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="8bf6" class="lz ma iq my b gy nc nd l ne nf"><strong class="my ir">#creating a dictionary with file names and their extensions</strong><br/>dict_del={}<br/>delimit=[]<br/>for i in range(len(file_names)):<br/>    delimit.append(i)<br/>t=0<br/>for s in full_file_names:<br/>    with open(data_path+'\\'+s, newline='', encoding="utf8") as csvfile:<br/>        dialect = csv.Sniffer().sniff(csvfile.read(1024))<br/>        csvfile.seek(0)<br/>        reader = csv.reader(csvfile, dialect)<br/>        delimit[t]=dialect.delimiter<br/>        dict_del[s]=delimit[t]<br/>        t+=1</span></pre><p id="1cfb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你注意到的，我们建立了一个字典和一个列表。名为<strong class="ky ir"> <em class="ni">【分隔符】</em> </strong>的列表用于存储分隔符。我们使用for循环语法，通过索引用提取的分隔符轻松替换随机值。字典包含文件名(作为键)和分隔符(作为值)。让我们检查一下我们有什么；</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="d166" class="lz ma iq my b gy nc nd l ne nf"><strong class="my ir">#checking dictionary and delimiters</strong><br/>print(dict_del)<br/>print(delimit)</span></pre><h2 id="9313" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">一个有风险的方法:globals()</h2><p id="9f43" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">是时候使用“<strong class="ky ir"><em class="ni">【globals()”</em></strong>方法来创建变量了。有消息来源<strong class="ky ir"> ( </strong> <a class="ae kv" href="https://wiki.c2.com/?GlobalVariablesAreBad" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">链接</strong> </a> <strong class="ky ir"> ) </strong>说它危险是因为它是全球性的。<strong class="ky ir"> <em class="ni">这种方法会造成混乱，所以请仔细阅读！</em> </strong></p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="e746" class="lz ma iq my b gy nc nd l ne nf"><strong class="my ir">#creating global variables depend on file names</strong><br/>z=0<br/>files_ready=[]<br/>for f,r in zip(file_names,full_file_names):<br/>    globals()[f]=pd.read_csv(data_path+'\\'+r,sep=dict_del[r])        <br/>    files_ready.append(f)<br/>    z+=1</span></pre><p id="77fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您注意到，变量是为每个文件名单独创建的。我们完了！让我们确保它有效。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="8100" class="lz ma iq my b gy nc nd l ne nf"><strong class="my ir">#checking data files</strong><br/>print(files_ready)<br/>bank.head()<br/>deacit.head()<br/>netflix_titles.head()</span></pre><p id="26a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">瞧啊。我们加载了所有文件，并给它们分配了一个变量。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/a3a939354ba0b32d7a9476e8ab7b881a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QYLC3zwKyWK6S2zwUCiW9w.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/f7dd93380d319c2f3c61f051de4f7a8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sr2genhyVbWxXMjn6Vm_kg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/4673993b50a7bda6dcbf7096a174c2d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4tZx-MhoNoxDU6jvRxa7eg.png"/></div></div></figure><p id="46be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，让我们对一个新的数据文件进行双重检查。我刚刚保存了一个<code class="fe nm nn no my b">.txt</code>文件。(PSA)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/65ccfbda22b0015877481927cd44527d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*5AGFeSB0jAXjmzwjTXlAmA.png"/></div></figure><p id="5923" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我想知道它是否有效。</p><pre class="kg kh ki kj gt mx my mz na aw nb bi"><span id="a419" class="lz ma iq my b gy nc nd l ne nf"><strong class="my ir">#checking the new file</strong><br/>print(files_ready)<br/>PSA.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/083c1f93271131ce505b2732bf08d9c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8DTbX_HCi_MIKsrmej7HAw.png"/></div></div></figure><p id="686e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一切似乎都运转正常。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="9fc2" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">最后的想法</h2><p id="9d0c" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">正如我之前所说，我并不声称这些是实现这一目标的唯一和容易的选择。本教程是我创建的自动化过程的方式。随意开发代码。:)</p><p id="2c9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">优点</strong>:</p><ul class=""><li id="5902" class="nr ns iq ky b kz la lc ld lf nt lj nu ln nv lr nw nx ny nz bi translated">只需运行代码，在短时间内加载几个文件。</li><li id="aa50" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated">你不需要考虑变量名。</li><li id="e8a6" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated">你不会错过任何新文件。</li></ul><p id="8aee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">缺点</strong>:</p><ul class=""><li id="a5e5" class="nr ns iq ky b kz la lc ld lf nt lj nu ln nv lr nw nx ny nz bi translated">我测试的代码只有csv和txt文件。</li><li id="0b14" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated">可能有更简单的方法。请去看看:)</li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="891b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">有用链接</strong></p><ul class=""><li id="f3d6" class="nr ns iq ky b kz la lc ld lf nt lj nu ln nv lr nw nx ny nz bi translated">学习如何使用split()函数(<a class="ae kv" href="https://docs.python.org/3/library/stdtypes.html#str.split" rel="noopener ugc nofollow" target="_blank">链接</a>)</li><li id="3c94" class="nr ns iq ky b kz oa lc ob lf oc lj od ln oe lr nw nx ny nz bi translated">os.path.join和os.path.isfile ( <a class="ae kv" href="https://docs.python.org/3/library/pathlib.html#module-pathlib" rel="noopener ugc nofollow" target="_blank">链接</a>)</li></ul><h2 id="f28c" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated">概述</h2><p id="6ba4" class="pw-post-body-paragraph kw kx iq ky b kz ms jr lb lc mt ju le lf mu lh li lj mv ll lm ln mw lp lq lr ij bi translated">数据导入本质上是一项繁重的工作，但它仍然是构建数据模型的重要组成部分。你可以找到并使用更多的方法。</p><p id="8f37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">构建您的方法将提高您的编码技能。我希望这个指南对你有用。感谢阅读到最后。</p><h2 id="2c2f" class="lz ma iq bd mb mc md dn me mf mg dp mh lf mi mj mk lj ml mm mn ln mo mp mq mr bi translated"><strong class="ak">代码</strong>:</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="of og l"/></div></figure><div class="oh oi gp gr oj ok"><a href="https://www.linkedin.com/in/esersaygin/" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd ir gy z fp op fr fs oq fu fw ip bi translated">eser saygı客户细分主管—图尔基耶i̇ş银行| LinkedIn</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">经验丰富的项目主管，有银行业工作经验。英语熟练…</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">www.linkedin.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy kp ok"/></div></div></a></div></div></div>    
</body>
</html>