<html>
<head>
<title>Extract Data From Tables in PDF — Using a Single Line in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从 PDF 表格中提取数据—使用 Python 中的一行代码</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/scraping-table-data-from-pdf-files-using-a-single-line-in-python-8607880c750?source=collection_archive---------0-----------------------#2020-07-07">https://towardsdatascience.com/scraping-table-data-from-pdf-files-using-a-single-line-in-python-8607880c750?source=collection_archive---------0-----------------------#2020-07-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ffcb" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在本文中，您将学习使用 python 从 PDF 文件的表格中提取数据并导出到 CSV/Excel 的最佳方式。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4fd2d12a34e587fda10662755d9e4f00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RZbv5-U9DZQ_A9-R"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">戴维·克洛德在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="bfda" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从 PDF 文件中获取表格不再是一项困难的任务，您可以使用 python 中的一行代码来完成。</p><h1 id="1a59" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">你将学到什么</h1><ol class=""><li id="f889" class="mn mo it lb b lc mp lf mq li mr lm ms lq mt lu mu mv mw mx bi translated">安装磁盘库。</li><li id="911f" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">正在导入库。</li><li id="3bc4" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">阅读 PDF 文件。</li><li id="0d20" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">读取 PDF 文件特定页面上的表格。</li><li id="f7ef" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">读取 PDF 文件同一页面上的多个表格。</li><li id="8676" class="mn mo it lb b lc my lf mz li na lm nb lq nc lu mu mv mw mx bi translated">将 PDF 文件直接转换为 CSV 文件。</li></ol></div><div class="ab cl nd ne hx nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="im in io ip iq"><h1 id="c1fa" class="lv lw it bd lx ly nk ma mb mc nl me mf jz nm ka mh kc nn kd mj kf no kg ml mm bi translated">白板</h1><p id="bad8" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">Tabula 是一个有用的软件包，它不仅允许你从 PDF 文件中抓取表格，还可以将 PDF 文件直接转换成 CSV 文件。</p><h1 id="9f7c" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">所以让我们开始吧…</h1><h2 id="686c" class="ns lw it bd lx nt nu dn mb nv nw dp mf li nx ny mh lm nz oa mj lq ob oc ml od bi translated">1.安装磁盘库</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="3830" class="ns lw it of b gy oj ok l ol om">pip install tabula-py</span></pre><h2 id="6e09" class="ns lw it bd lx nt nu dn mb nv nw dp mf li nx ny mh lm nz oa mj lq ob oc ml od bi translated">2.导入 tabula 库</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="6982" class="ns lw it of b gy oj ok l ol om">import tabula</span></pre><h2 id="b6c5" class="ns lw it bd lx nt nu dn mb nv nw dp mf li nx ny mh lm nz oa mj lq ob oc ml od bi translated">3.阅读 PDF 文件</h2><p id="4ebb" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">让我们把这个<a class="ae ky" href="https://nbviewer.jupyter.org/github/kuruvasatya/Scraping-Tables-from-PDF/blob/master/data1.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> PDF </strong> </a>剪切成熊猫数据帧。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/d35d238963cc19400b140bd03a10b554.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eH6Q8lDFeJqvdbi9LQgG0g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由 Satya Ganesh 提供</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="ad0d" class="ns lw it of b gy oj ok l ol om">file1 = "<a class="ae ky" href="https://nbviewer.jupyter.org/github/kuruvasatya/Scraping-Tables-from-PDF/blob/master/data1.pdf" rel="noopener ugc nofollow" target="_blank">https://nbviewer.jupyter.org/github/kuruvasatya/Scraping-Tables-from-PDF/blob/master/data1.pdf</a>"</span><span id="9ee8" class="ns lw it of b gy oo ok l ol om">table = tabula.read_pdf(file1,pages=1)</span><span id="34bf" class="ns lw it of b gy oo ok l ol om">table[0]</span></pre><p id="d184" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看看上面在 Google Colabs 中执行的代码片段的输出</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/354066a810177c545510ff5c1ff76a32.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*3LDNwvrfbVv_A869E0oqdA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由 Satya Ganesh 提供</p></figure><h1 id="5353" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">4.读取 PDF 文件特定页面上的表格。</h1><p id="7b85" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">假设我们需要废弃这个包含多页的<a class="ae ky" href="https://nbviewer.jupyter.org/github/kuruvasatya/Reading-Table-Data-From-PDF/blob/master/data.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="oq"> PDF 文件</em> </strong> </a>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/938711b89bb306c163449ea23fabea7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*WneY94vawARLdOUJjby0Aw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由 Satya Ganesh 提供</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/fc527c8d607616a52359c918f34afa72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ds2I6X-pd7I4AldWMYLzYQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由 Satya Ganesh 提供</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="613b" class="ns lw it of b gy oj ok l ol om">file2 = "<a class="ae ky" href="https://nbviewer.jupyter.org/github/kuruvasatya/Reading-Table-Data-From-PDF/blob/master/data.pdf" rel="noopener ugc nofollow" target="_blank">https://nbviewer.jupyter.org/github/kuruvasatya/Reading-Table-Data-From-PDF/blob/master/data.pdf</a>"</span><span id="14d0" class="ns lw it of b gy oo ok l ol om"># To read table in first page of PDF file<br/>table1 = tabula.read_pdf(file2 ,<strong class="of iu">pages=1</strong>)</span><span id="5b73" class="ns lw it of b gy oo ok l ol om"># To read tables in secord page of PDF file<br/>table2 = tabula.read_pdf(file2 ,<strong class="of iu">pages=2</strong>)</span><span id="bb36" class="ns lw it of b gy oo ok l ol om">print(table1[0])<br/>print(table2[0])</span></pre><h1 id="134e" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">5.如果一个 PDF 文件的同一个页面上有多个表格怎么办？</h1><p id="049d" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">假设我们需要抓取这两个表格，它们在一个<a class="ae ky" href="https://nbviewer.jupyter.org/github/kuruvasatya/Reading-Table-Data-From-PDF/blob/master/data3.pdf" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> PDF 文件</strong> </a>的同一页上。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/1f0f2aed0925714dcacb33b8eebca5c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MnHek72KM11Kkrm4T5bNyg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由 Satya Ganesh 提供</p></figure><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="ae1b" class="ns lw it of b gy oj ok l ol om">To read multiple tables we need to add extra parameter</span><span id="77d6" class="ns lw it of b gy oo ok l ol om"><strong class="of iu">multiple_tables = True</strong> -&gt; Read multiple tables as independent tables<br/><strong class="of iu">multiple_tables = False</strong> -&gt; Read multiple tables as single table</span></pre><h2 id="e0d2" class="ns lw it bd lx nt nu dn mb nv nw dp mf li nx ny mh lm nz oa mj lq ob oc ml od bi translated">5.1.将多个表作为独立的表读取</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="51e7" class="ns lw it of b gy oj ok l ol om">file3 = "<a class="ae ky" href="https://nbviewer.jupyter.org/github/kuruvasatya/Reading-Table-Data-From-PDF/blob/master/data3.pdf" rel="noopener ugc nofollow" target="_blank">https://nbviewer.jupyter.org/github/kuruvasatya/Reading-Table-Data-From-PDF/blob/master/data3.pdf</a>"</span><span id="5dd0" class="ns lw it of b gy oo ok l ol om">tables = tabula.read_pdf(file3 ,pages=1, <strong class="of iu">multiple_tables=True</strong>)</span><span id="3a69" class="ns lw it of b gy oo ok l ol om">print(tables[0])<br/>print(tables[1])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/fcd42c7e42765ee6d1b2243973200ed9.png" data-original-src="https://miro.medium.com/v2/resize:fit:386/format:webp/1*Y6TXlrqsqxKkFKkr-2SquQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由 Satya Ganesh 提供</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/2b0049fa0bdc2b2934e0021341af0c67.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*G7fx6O1Bn6nxNVKFZu9nHw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由 Satya Ganesh 提供</p></figure><h2 id="28eb" class="ns lw it bd lx nt nu dn mb nv nw dp mf li nx ny mh lm nz oa mj lq ob oc ml od bi translated">5.2 将多个表作为单个表读取</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="3b41" class="ns lw it of b gy oj ok l ol om">tables = tabula.read_pdf(file3 ,pages=1,<strong class="of iu">multiple_tables=False</strong>)</span><span id="5f7d" class="ns lw it of b gy oo ok l ol om">tables[0]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/2ca47bc5f6fff308ef976aed40a51359.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/1*HQncrtclUd_DCKXirm68iw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由 Satya Ganesh 提供</p></figure><h1 id="68d5" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">6.将 PDF 文件直接转换为 CSV 文件</h1><p id="8c7c" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">我们可以使用 tabula 库中的<strong class="lb iu"> convert_into() </strong>方法将包含表格数据的 PDF 文件直接转换为 CSV 文件。</p><h2 id="fccd" class="ns lw it bd lx nt nu dn mb nv nw dp mf li nx ny mh lm nz oa mj lq ob oc ml od bi translated">1.将一页 PDF 文件中的表格转换为 CSV 格式</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="cd70" class="ns lw it of b gy oj ok l ol om"># output just the first page tables in the PDF to a CSV</span><span id="f4f1" class="ns lw it of b gy oo ok l ol om">tabula.convert_into("pdf_file_name", "Name_of_csv_file.csv")</span></pre><h2 id="963c" class="ns lw it bd lx nt nu dn mb nv nw dp mf li nx ny mh lm nz oa mj lq ob oc ml od bi translated">2.将 PDF 文件中的所有表格转换为 CSV 格式</h2><pre class="kj kk kl km gt oe of og oh aw oi bi"><span id="b25d" class="ns lw it of b gy oj ok l ol om">tabula.convert_into("pdf_file_name","Name_of_csv_file.csv",<strong class="of iu">all</strong><strong class="of iu"> </strong><strong class="of iu">=</strong><strong class="of iu"> </strong><strong class="of iu">True</strong>)</span></pre><h1 id="2b65" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="fa4a" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">我希望您学会了一种使用 python 中的一行代码来抓取 PDF 文件表格的好方法。</p><p id="c9d3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">查看我的相关文章</p><div class="ox oy gp gr oz pa"><a rel="noopener follow" target="_blank" href="/scraping-table-data-from-websites-using-a-single-line-in-python-ba898d54e2bc"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">从网站抓取表格数据—使用 Python 中的一行代码</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">本文将教您如何使用 python 中的一行代码从网站中抓取表格数据。</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po ks pa"/></div></div></a></div><div class="ox oy gp gr oz pa"><a rel="noopener follow" target="_blank" href="/impact-of-covid-19-data-visualization-using-python-6f8e3bdc860b"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">新冠肺炎的影响-使用 Python 进行数据可视化</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">使用 python 在印度地图上可视化冠状病毒爆发的初级方法。当你到达…的终点时</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pp l pl pm pn pj po ks pa"/></div></div></a></div><h1 id="50c5" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">参考</h1><div class="ox oy gp gr oz pa"><a href="https://tabula-py.readthedocs.io/en/latest/" rel="noopener  ugc nofollow" target="_blank"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">表格:将 PDF 中的表格读入数据框架表格文档</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">是 tabula-java 的一个简单的 Python 包装器，可以读取 PDF 的表格。您可以从 PDF 读取表格并转换成…</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">tabula-py.readthedocs.io</p></div></div></div></a></div><h1 id="ba3b" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">感谢阅读😃过得愉快</h1></div></div>    
</body>
</html>