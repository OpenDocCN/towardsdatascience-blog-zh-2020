<html>
<head>
<title>Learn How to Create Animated Graphs in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解如何用Python创建动画图形</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learn-how-to-create-animated-graphs-in-python-fce780421afe?source=collection_archive---------1-----------------------#2020-05-05">https://towardsdatascience.com/learn-how-to-create-animated-graphs-in-python-fce780421afe?source=collection_archive---------1-----------------------#2020-05-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="310a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">动画数据可视化的基础</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/c2635f38d6c172424e1bfa6ce5ac6e76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*mBJvfCxbvqFeVSJ9U1ey7w.gif"/></div></figure><p id="db8a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">随着数据以前所未有的速度不断膨胀，数据科学家需要对其进行分析和理解。一旦发生这种情况，就需要有效地交流结果。</p><p id="3db7" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">然而，交流数据分析的结果常常是棘手的。为了有效地沟通，一个流行的和非常有效的技术是讲故事。</p><blockquote class="lm"><p id="a887" class="ln lo it bd lp lq lr ls lt lu lv ll dk translated">让世界上所有的信息触手可及并不会让交流变得更容易:反而会让交流变得更难。―科尔·努斯鲍默·克纳弗里克</p></blockquote><p id="6b0e" class="pw-post-body-paragraph kq kr it ks b kt lw ju kv kw lx jx ky kz ly lb lc ld lz lf lg lh ma lj lk ll im bi translated">为了帮助讲故事和交流，数据可视化是至关重要的。动画数据可视化让事情更上一层楼，增加了令人惊叹的因素。</p><p id="3ab9" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在这篇博客中，我们将探讨如何让你的图表生动起来。我们将学习如何给折线图、条形图和饼图添加新的维度。这个博客将让你开始，但可能性是无限的。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/3ea9e8a7abbadd157ffb408437132e46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*N_JZM-l9rEQsojbjVV_6Fw.gif"/></div><p class="mi mj gj gh gi mk ml bd b be z dk translated"><a class="ae mm" href="https://matplotlib.org/gallery/animation/double_pendulum_animated_sgskip.html" rel="noopener ugc nofollow" target="_blank">双摆</a></p></figure><h1 id="5525" class="mn mo it bd mp mq mr ms mt mu mv mw mx jz my ka mz kc na kd nb kf nc kg nd ne bi translated">动画是如何工作的</h1><p id="4c23" class="pw-post-body-paragraph kq kr it ks b kt nf ju kv kw ng jx ky kz nh lb lc ld ni lf lg lh nj lj lk ll im bi translated">在典型的时尚中，正如你对Python的期望，有一个非常<a class="ae mm" href="https://matplotlib.org/3.1.1/api/animation_api.html" rel="noopener ugc nofollow" target="_blank">易用的包</a>，它使我们能够为我们的数据可视化增加一个额外的维度。</p><p id="6619" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">正在讨论的包是<a class="ae mm" href="https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.animation.FuncAnimation.html#matplotlib.animation.FuncAnimation" rel="noopener ugc nofollow" target="_blank"> FuncAnimation扩展方法</a>，是Python的matplotlib库中动画类的一部分。我们将通过多个例子来看看如何使用它，但是现在，你可以把这个函数想象成一个while循环，它不断地在画布上重新绘制我们的图形。</p><h2 id="5ec8" class="nk mo it bd mp nl nm dn mt nn no dp mx kz np nq mz ld nr ns nb lh nt nu nd nv bi translated">如何使用图书馆</h2><p id="49ee" class="pw-post-body-paragraph kq kr it ks b kt nf ju kv kw ng jx ky kz nh lb lc ld ni lf lg lh nj lj lk ll im bi translated">帮助我理解如何制作图表动画的是从结尾开始。这个动画魔术将从下面两行开始发生:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="9c3c" class="nk mo it nx b gy ob oc l od oe">import matplotlib.animation as ani</span><span id="558f" class="nk mo it nx b gy of oc l od oe">animator = ani.FuncAnimation(fig, chartfunc, interval = 100)</span></pre><p id="6e79" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">让我们看看FuncAnimation的上述输入:</p><ol class=""><li id="8305" class="og oh it ks b kt ku kw kx kz oi ld oj lh ok ll ol om on oo bi translated"><em class="op"> fig </em>是我们将用来“绘制我们的图形”的图形对象</li><li id="563c" class="og oh it ks b kt oq kw or kz os ld ot lh ou ll ol om on oo bi translated"><em class="op"> chartfunc </em>是一个接受数字输入的函数，它表示时间序列上的时间(随着数字的增加，我们沿着时间轴移动)</li><li id="3b8a" class="og oh it ks b kt oq kw or kz os ld ot lh ou ll ol om on oo bi translated"><em class="op">间隔</em>是帧之间的延迟，单位为毫秒。默认为200。</li></ol><p id="297f" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如需更多可选输入，请查看<a class="ae mm" href="https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.animation.FuncAnimation.html#matplotlib.animation.FuncAnimation" rel="noopener ugc nofollow" target="_blank">文档</a>。</p><p id="47f8" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">进一步研究以上内容，我们需要做的就是将他们的图表参数化为一个函数，该函数将时间序列中的点作为输入，游戏就开始了！</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="a151" class="mn mo it bd mp mq ov ms mt mu ow mw mx jz ox ka mz kc oy kd nb kf oz kg nd ne bi translated">入门指南</h1><p id="32d7" class="pw-post-body-paragraph kq kr it ks b kt nf ju kv kw ng jx ky kz nh lb lc ld ni lf lg lh nj lj lk ll im bi translated">为了确保我们涵盖了所有基础，我们将基于之前的数据可视化示例，我们已经在:</p><div class="pa pb gp gr pc pd"><a rel="noopener follow" target="_blank" href="/the-basics-of-data-visualisation-with-python-23188aa9fc1a"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd iu gy z fp pi fr fs pj fu fw is bi translated">Python数据可视化基础</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">不到5分钟的逐步介绍</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">towardsdatascience.com</p></div></div><div class="pm l"><div class="pn l po pp pq pm pr ko pd"/></div></div></a></div><p id="3887" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">换句话说，我们将使用来自疫情(每天死亡人数)的数据，并且我们将使用下面代码中给出的最终数据集。如果你想了解更多关于下面的数据转换和如何开始简单的数据可视化，先简单地阅读上面的帖子。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="487c" class="nk mo it nx b gy ob oc l od oe">import matplotlib.animation as ani<br/>import matplotlib.pyplot as plt<br/>import numpy as np<br/>import pandas as pd</span><span id="4557" class="nk mo it nx b gy of oc l od oe">url = '<a class="ae mm" href="https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_deaths_global.csv'</a><br/>df = pd.read_csv(url, delimiter=',', header='infer')</span><span id="e7a9" class="nk mo it nx b gy of oc l od oe">df_interest = df.loc[<br/>    df['Country/Region'].isin(['United Kingdom', 'US', 'Italy', 'Germany'])<br/>    &amp; df['Province/State'].isna()]</span><span id="48bd" class="nk mo it nx b gy of oc l od oe">df_interest.rename(<br/>    index=lambda x: df_interest.at[x, 'Country/Region'], inplace=True)<br/>df1 = df_interest.transpose()</span><span id="0bdb" class="nk mo it nx b gy of oc l od oe">df1 = df1.drop(['Province/State', 'Country/Region', 'Lat', 'Long'])<br/>df1 = df1.loc[(df1 != 0).any(1)]<br/>df1.index = pd.to_datetime(df1.index)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="pt pu di pv bf pw"><div class="gh gi ps"><img src="../Images/72f7da55a228945b0d64488ac58dd586.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*Afe_EF2CsFnSYm2blmkH3A.png"/></div></div></figure></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="ff79" class="mn mo it bd mp mq ov ms mt mu ow mw mx jz ox ka mz kc oy kd nb kf oz kg nd ne bi translated">动画线条图</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/c2635f38d6c172424e1bfa6ce5ac6e76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*mBJvfCxbvqFeVSJ9U1ey7w.gif"/></div></figure><p id="21d4" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我们需要做的第一件事是定义图表中的项目，这些项目将保持不变。也就是说，创建图形对象、x和y标签，设置线条颜色和图形边距。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="fa23" class="nk mo it nx b gy ob oc l od oe">import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="dc5f" class="nk mo it nx b gy of oc l od oe">color = ['red', 'green', 'blue', 'orange']<br/>fig = plt.figure()<br/>plt.xticks(rotation=45, ha="right", rotation_mode="anchor") #rotate the x-axis values<br/>plt.subplots_adjust(bottom = 0.2, top = 0.9) #ensuring the dates (on the x-axis) fit in the screen<br/>plt.ylabel('No of Deaths')<br/>plt.xlabel('Dates')</span></pre><p id="ee6d" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">然后，我们必须设置我们的曲线功能，然后动画它:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="8083" class="nk mo it nx b gy ob oc l od oe">def buildmebarchart(i=int):<br/>    plt.legend(df1.columns)<br/>    p = plt.plot(df1[:i].index, df1[:i].values) #note it only returns the dataset, up to the point i<br/>    for i in range(0,4):<br/>        p[i].set_color(color[i]) #set the colour of each curve</span><span id="a204" class="nk mo it nx b gy of oc l od oe">import matplotlib.animation as ani<br/>animator = ani.FuncAnimation(fig, buildmebarchart, interval = 100)<br/>plt.show()</span></pre></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="daed" class="mn mo it bd mp mq ov ms mt mu ow mw mx jz ox ka mz kc oy kd nb kf oz kg nd ne bi translated">动画饼图</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/33c5fca553816394202aeed73b2535ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*RDnzEWdudV4NPFySgfvX1w.gif"/></div></figure><p id="2212" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">代码结构看起来与折线图相同。然而，有一些差异，我们将通过。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="e0bf" class="nk mo it nx b gy ob oc l od oe">import numpy as np<br/>import matplotlib.pyplot as plt</span><span id="ca9c" class="nk mo it nx b gy of oc l od oe">fig,ax = plt.subplots()<br/>explode=[0.01,0.01,0.01,0.01] #pop out each slice from the pie</span><span id="d7c3" class="nk mo it nx b gy of oc l od oe">def getmepie(i):<br/>    def absolute_value(val): #turn % back to a number<br/>        a  = np.round(val/100.*df1.head(i).max().sum(), 0)<br/>        return int(a)<br/>    ax.clear()<br/>    plot = df1.head(i).max().plot.pie(y=df1.columns,autopct=absolute_value, label='',explode = explode, shadow = True)<br/>    plot.set_title('Total Number of Deaths\n' + str(df1.index[min( i, len(df1.index)-1 )].strftime('%y-%m-%d')), fontsize=12)</span><span id="6928" class="nk mo it nx b gy of oc l od oe">import matplotlib.animation as ani<br/>animator = ani.FuncAnimation(fig, getmepie, interval = 200)<br/>plt.show()</span></pre><p id="5e83" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">一个主要的区别是，在上面的代码中，我们每次都返回一组值。在线图中，我们将整个时间序列返回到我们所在的点。我们通过使用</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="89e6" class="nk mo it nx b gy ob oc l od oe">df1.head(i).max()</span></pre><p id="b72c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">df1.head(i)返回一个时间序列，但是。max()确保我们只获得最新的记录(因为死亡总数要么保持不变，要么上升)。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="fb0f" class="mn mo it bd mp mq ov ms mt mu ow mw mx jz ox ka mz kc oy kd nb kf oz kg nd ne bi translated">动画条形图</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="pt pu di pv bf pw"><div class="gh gi px"><img src="../Images/2c0d57e275bfd82ff82802a1093ad50c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Kp3a9swTo9daMRU2ZjUwZg.gif"/></div></div></figure><p id="4829" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">构建条形图就像我们到目前为止看到的例子一样简单。对于这个例子，我包括了水平和垂直条形图。取决于你想看哪一个，你只需要定义变量<em class="op"> bar </em>。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="7244" class="nk mo it nx b gy ob oc l od oe">fig = plt.figure()<br/>bar = ''</span><span id="faf7" class="nk mo it nx b gy of oc l od oe">def buildmebarchart(i=int):<br/>    iv = min(i, len(df1.index)-1) #the loop iterates an extra one time, which causes the dataframes to go out of bounds. This was the easiest (most lazy) way to solve this :)<br/>    objects = df1.max().index<br/>    y_pos = np.arange(len(objects))<br/>    performance = df1.iloc[[iv]].values.tolist()[0]<br/>    if bar == 'vertical':<br/>        plt.bar(y_pos, performance, align='center', color=['red', 'green', 'blue', 'orange'])<br/>        plt.xticks(y_pos, objects)<br/>        plt.ylabel('Deaths')<br/>        plt.xlabel('Countries')<br/>        plt.title('Deaths per Country \n' + str(df1.index[iv].strftime('%y-%m-%d')))<br/>    else:<br/>        plt.barh(y_pos, performance, align='center', color=['red', 'green', 'blue', 'orange'])<br/>        plt.yticks(y_pos, objects)<br/>        plt.xlabel('Deaths')<br/>        plt.ylabel('Countries')</span><span id="c705" class="nk mo it nx b gy of oc l od oe">animator = ani.FuncAnimation(fig, buildmebarchart, interval=100)</span><span id="b3ca" class="nk mo it nx b gy of oc l od oe">plt.show()</span></pre></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="f50e" class="mn mo it bd mp mq ov ms mt mu ow mw mx jz ox ka mz kc oy kd nb kf oz kg nd ne bi translated">如何保存动画图形</h1><p id="f787" class="pw-post-body-paragraph kq kr it ks b kt nf ju kv kw ng jx ky kz nh lb lc ld ni lf lg lh nj lj lk ll im bi translated">所以你已经创建了你的第一个动画图表，你想分享它们。你如何拯救他们？</p><p id="ead0" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">幸运的是，只需要一行代码:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="ce97" class="nk mo it nx b gy ob oc l od oe">animator.save(r'C:\temp\myfirstAnimation.gif')</span></pre><p id="b63a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">更多信息，<a class="ae mm" href="https://matplotlib.org/3.1.1/api/animation_api.html" rel="noopener ugc nofollow" target="_blank">查看文档</a>。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><p id="07a5" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果你喜欢这篇博文，你可能也会喜欢:</p><div class="pa pb gp gr pc pd"><a rel="noopener follow" target="_blank" href="/how-to-supercharge-excel-with-python-726b0f8e22c2"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd iu gy z fp pi fr fs pj fu fw is bi translated">如何用Python为Excel增压</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">如何用xlwings集成Python和Excel</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">towardsdatascience.com</p></div></div><div class="pm l"><div class="py l po pp pq pm pr ko pd"/></div></div></a></div><div class="pa pb gp gr pc pd"><a href="https://medium.com/better-programming/introduction-to-regex-8c18abdd4f70" rel="noopener follow" target="_blank"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd iu gy z fp pi fr fs pj fu fw is bi translated">正则表达式简介</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">使用Python逐步介绍正则表达式</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">medium.com</p></div></div><div class="pm l"><div class="pz l po pp pq pm pr ko pd"/></div></div></a></div><div class="pa pb gp gr pc pd"><a rel="noopener follow" target="_blank" href="/automate-ui-testing-with-pyautogui-in-python-4a3762121973"><div class="pe ab fo"><div class="pf ab pg cl cj ph"><h2 class="bd iu gy z fp pi fr fs pj fu fw is bi translated">用Python中的PyAutoGUI实现自动化UI测试</h2><div class="pk l"><h3 class="bd b gy z fp pi fr fs pj fu fw dk translated">回归测试你的用户界面的一个快速简单的方法</h3></div><div class="pl l"><p class="bd b dl z fp pi fr fs pj fu fw dk translated">towardsdatascience.com</p></div></div><div class="pm l"><div class="qa l po pp pq pm pr ko pd"/></div></div></a></div></div></div>    
</body>
</html>