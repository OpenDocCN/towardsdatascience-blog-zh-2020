<html>
<head>
<title>How to Build a Map Dashboard with Python ASAP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何尽快用 Python 构建地图仪表盘</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-a-map-dashboard-with-python-asap-e278945fbd6d?source=collection_archive---------13-----------------------#2020-08-08">https://towardsdatascience.com/how-to-build-a-map-dashboard-with-python-asap-e278945fbd6d?source=collection_archive---------13-----------------------#2020-08-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="996a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用几行 python 代码创建可共享地图仪表盘的一种非常简单、直接、容易且快速的方法。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a586150f1a2a179a72d43159e7c7cb4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4zYV7iiIbZvEmx6isTL16w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">机场仪表板</p></figure><p id="f7dd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们已经<a class="ae lu" rel="noopener" target="_blank" href="/how-to-visualize-data-on-top-of-a-map-in-python-using-the-geoviews-library-c4f444ca2929">看到了</a>使用 python 和 geoviews 库在地图上绘制一些数据是多么容易。然而，说实话，每次当你想改变图中显示内容的特定方面时，编辑代码行会非常令人沮丧。因此，构建一个地图仪表板通常更有用、更方便，即使是最没有经验的用户也可以通过点击几下鼠标来更改地图。幸运的是，有一种简单的方法可以实现这一点，使用 Panel 和 Param。</p><p id="7386" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae lu" href="https://panel.holoviz.org/" rel="noopener ugc nofollow" target="_blank"> <em class="lv"> Panel </em> </a> <em class="lv">是一个开源的 Python 库，它允许您通过将用户定义的小部件连接到绘图、图像、表格或文本来创建自定义的交互式 web 应用程序和仪表盘。Panel 也可以与单独的</em><a class="ae lu" href="http://param.pyviz.org" rel="noopener ugc nofollow" target="_blank"><em class="lv">Param</em></a><em class="lv">项目一起使用，以完全声明的方式创建带有或不带有关联可视化的交互式可配置对象。</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="2145" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">出于本教程的目的，我们将构建一个地图仪表板来可视化我国希腊和邻国土耳其最繁忙机场的客流量，以便进行比较，就像我们在 geoviews 的<a class="ae lu" rel="noopener" target="_blank" href="/how-to-visualize-data-on-top-of-a-map-in-python-using-the-geoviews-library-c4f444ca2929">演示</a>中所做的那样。积分模块。这一次，数据集更新了 2019 年的客运量，现在包含 2018 年和 2019 年的数据，以及伊斯坦布尔的新机场。</p><p id="f051" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">数据集可以在<a class="ae lu" href="https://www.dropbox.com/s/mymlk9cljj8nniq/airports_2019.csv?dl=0" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="4598" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">首先，我们需要导入我们将要使用的必要的库和模块。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="b8ea" class="mi mj it me b gy mk ml l mm mn">import pandas as pd<br/>import numpy as np<br/>import geoviews as gv<br/>from geoviews import opts, dim <br/>import param, panel as pn<br/>gv.extension('bokeh')</span></pre><p id="0235" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将前面提到的数据集读作<code class="fe mo mp mq me b">airports_df</code>，看起来像这样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/578b1f1d92bfaca12a9269c22db14ebe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*fqkCK2ME2wWap7ov-uZAFQ.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">机场 _df</p></figure><p id="6d1f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们做一些准备工作。</p><p id="cc2d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们创建 HoverTool 来指定当我们将鼠标悬停在这些点上时显示的信息。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="41a3" class="mi mj it me b gy mk ml l mm mn">from bokeh.models import HoverTool<br/>tooltips = [('IATA', '<a class="ae lu" href="http://twitter.com/IATA" rel="noopener ugc nofollow" target="_blank">@IATA</a>'),<br/>            ('Passengers', '<a class="ae lu" href="http://twitter.com/passengers" rel="noopener ugc nofollow" target="_blank">@passengers</a>{0.000 a}m'),<br/>            ('City', '<a class="ae lu" href="http://twitter.com/city" rel="noopener ugc nofollow" target="_blank">@city</a>'),<br/>            ('Country', '<a class="ae lu" href="http://twitter.com/country" rel="noopener ugc nofollow" target="_blank">@country</a>'),<br/>            ('Longitude', '$x'),<br/>            ('Latitude', '$y'),<br/>            ('Year', '<a class="ae lu" href="http://twitter.com/year" rel="noopener ugc nofollow" target="_blank">@year</a>')<br/>            ]<br/>hover = HoverTool(tooltips=tooltips) </span></pre><p id="fc4b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们创建了一个列表，其中包含所有的国家和值"<em class="lv"> All" </em>。所以在这种情况下，它包含值['GR '，' TR '，' All']。我们将在仪表板参数“国家”中使用该列表。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="0237" class="mi mj it me b gy mk ml l mm mn">country_list = airports_df['country'].unique().tolist() <br/>country_list.append('All')<br/>country_list</span></pre><p id="81d5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还创建了一个字典，其中包含我们使用的 tilemap 的主要选项，因此也包含整个地块的主要选项。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="8fc8" class="mi mj it me b gy mk ml l mm mn">topts = dict(width=1100, height=680, xaxis=None, yaxis=None, \    show_grid=False)</span></pre><p id="ebfe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们使用<strong class="la iu">参数</strong>和<strong class="la iu">面板</strong>构建仪表板。结构如下。首先，我们使用 Param 定义主对象，在这里我们设置仪表板选项的参数。在 Param 对象内部，我们还定义了绘图，在这里我们传递用户设置的参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="3e89" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，我们所要做的就是将上述对象传递给<code class="fe mo mp mq me b">dashboard</code>，并使用 Panel 连续显示<code class="fe mo mp mq me b">dashboard.param</code>和<code class="fe mo mp mq me b">dashboard.plot</code>，即左边是参数，右边是绘图。</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="7c16" class="mi mj it me b gy mk ml l mm mn">dashboard = Airports(name="Airports Dashboard")<br/>DashboardPanel = pn.Row(dashboard.param, dashboard.plot)</span></pre><p id="5e0b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，有两种方式来运行仪表板。或者在同一个 jupyter 笔记本中，或者在单独的标签中。</p><p id="6bc5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于第一个选项，只需键入</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="ee73" class="mi mj it me b gy mk ml l mm mn">DashboardPanel.servable()</span></pre><p id="8304" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">而对于第二个选项，只需键入</p><pre class="kj kk kl km gt md me mf mg aw mh bi"><span id="347d" class="mi mj it me b gy mk ml l mm mn">DashboardPanel.show()</span></pre><p id="808e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">仪表板将如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/ed1a1cc6680ac2dd47b7601f5d3fd0cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*-scShZOLNthwNHCMcAS0PQ.gif"/></div></div></figure><p id="99a8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当然，用户可以在仪表板上添加更多的参数和图表。这个只是为了演示的目的。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="f3f9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">今天到此为止。希望你觉得有用。下次见！</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="59c0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">点击<a class="ae lu" href="https://www.linkedin.com/in/christoszeglis/" rel="noopener ugc nofollow" target="_blank">这里</a>，你可以随时在 LinkedIn 上找到我。</p></div></div>    
</body>
</html>