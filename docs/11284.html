<html>
<head>
<title>An introduction to Generalized Estimating Equations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">广义估计方程导论</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/an-introduction-to-generalized-estimating-equations-bc7dee570478?source=collection_archive---------16-----------------------#2020-08-05">https://towardsdatascience.com/an-introduction-to-generalized-estimating-equations-bc7dee570478?source=collection_archive---------16-----------------------#2020-08-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/27f4291d281694e17639dc99bb454150.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HiUJ8Bz24dDnNl4q"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">罗马法师在<a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="7fa1" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">如何评估纵向数据的总体平均效应</h2></div><p id="6da4" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">支撑<em class="lr">广义线性模型</em>(线性回归是其中的一种)的一个关键假设是观察的独立性。在纵向数据中，这是不成立的。个体内部(时间点之间)的观察结果可能比个体之间的观察结果更相似。</p><p id="fc0b" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那么，你如何处理这个问题呢？一种选择是拟合广义线性混合模型，其中每个个体都有随机截距和斜率项。这将告诉你一个特定的个体(即取决于随机截距和斜率)变量对结果的影响。然而，如果你关注的是边际效应，也就是说，一个变量对总体的平均<em class="lr">结果</em>有什么影响，这就没什么用了。</p><p id="b688" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你想回答这些人口问题，你需要使用<em class="lr">广义估计方程</em> (GEE)拟合一个广义线性模型。这是一种获得总体平均效应的方法，说明了个体内部的观察结果可能比个体之间的观察结果更相似。</p><h1 id="0855" class="ls lt jg bd lu lv lw lx ly lz ma mb mc km md kn me kp mf kq mg ks mh kt mi mj bi translated">一个例子</h1><p id="1510" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">假设我们有我们的<em class="lr">结果</em>——全因死亡率。现在假设我们每个月为每个人记录 10 个月。现在假设我们的曝光时间。我们现在可以定义一个逻辑回归模型，唯一的自变量是时间(以月为单位)，因变量是当时的死亡。“好的，很好”我听到你说“但是这些观察显然是不独立的！”。完全正确，但我们会谈到这一点。</p><h1 id="0103" class="ls lt jg bd lu lv lw lx ly lz ma mb mc km md kn me kp mf kq mg ks mh kt mi mj bi translated">工作相关结构</h1><p id="19f2" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">要使用 GEE，我们必须首先定义时间点是如何关联的。然而，通过使用<a class="ae jd" href="https://en.wikipedia.org/wiki/Heteroscedasticity-consistent_standard_errors" rel="noopener ugc nofollow" target="_blank"> Huber-White 标准误差</a>，我们的结果将<em class="lr">一致</em>，即使我们错误地指定了这种关系！所以我们有一些选择。</p><h2 id="4547" class="mp lt jg bd lu mq mr dn ly ms mt dp mc le mu mv me li mw mx mg lm my mz mi na bi translated">自主的</h2><p id="7c34" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">这种工作关联结构假设时间点彼此独立。这在实践中很可能是一个不合理的假设。</p><h2 id="07e4" class="mp lt jg bd lu mq mr dn ly ms mt dp mc le mu mv me li mw mx mg lm my mz mi na bi translated">可交换的</h2><p id="8177" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">对于任意两个时间点，两个时间点的观测值之间的相关性相等。这是通常使用的，因为它只需要估计一个额外的参数α。</p><h2 id="e99a" class="mp lt jg bd lu mq mr dn ly ms mt dp mc le mu mv me li mw mx mg lm my mz mi na bi translated">自回归的</h2><p id="4177" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">在这种情况下，观测值之间的相关性遵循自回归结构。假设我们使用 AR-1 相关矩阵。这将意味着一个人的第 1 个月和第 2 个月之间的相关性将被期望为α，一个人的第 1 个月和第 3 个月之间的相关性将被期望为α，第 1 个月和第 4 个月之间的相关性将为α，依此类推。</p><p id="dee6" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当您认为距离较近的时间点比距离较远的时间点更相似时，这是最合适的。</p><h2 id="eebc" class="mp lt jg bd lu mq mr dn ly ms mt dp mc le mu mv me li mw mx mg lm my mz mi na bi translated">无社会组织的</h2><p id="2b38" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">这是我们为每个可能的时间点组合估计一个单独的α的地方。这是最一般的情况。尽管你需要大量的数据来估计所有使用的α。</p><h2 id="0ad9" class="mp lt jg bd lu mq mr dn ly ms mt dp mc le mu mv me li mw mx mg lm my mz mi na bi translated">其他选择</h2><p id="c026" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">确实存在一些其他的选择，但是这些没有被广泛使用。</p><h2 id="25c3" class="mp lt jg bd lu mq mr dn ly ms mt dp mc le mu mv me li mw mx mg lm my mz mi na bi translated">如何选择使用哪一种？</h2><p id="34c9" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">很简单。要么选择您的数据可以支持的最通用的方法(取决于样本大小)，要么选择您认为最适合该数据的方法。不管怎样，别担心！这种方法是一致的，即使你指定错了。</p><h1 id="9545" class="ls lt jg bd lu lv lw lx ly lz ma mb mc km md kn me kp mf kq mg ks mh kt mi mj bi translated">如何适应模型</h1><p id="35d5" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">拟合模型很简单。我们只是使用 GEE 和我们指定的工作相关矩阵来拟合 GLM:</p><figure class="nc nd ne nf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nb"><img src="../Images/52793cf4e5bed72eeccfdae90a948766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FsCVqONclBMqSdRx.png"/></div></div></figure><p id="114e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">其中:</p><ul class=""><li id="370b" class="ng nh jg kx b ky kz lb lc le ni li nj lm nk lq nl nm nn no bi translated">如果参与者 I 在时间 j 死亡，Yij 为 1</li><li id="e497" class="ng nh jg kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">pij 是参与者 I 在时间 j 的死亡概率</li><li id="964c" class="ng nh jg kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">β0 是 0 时刻的人口平均死亡概率对数。这可以被指数化以获得在时间 0 的死亡几率。</li><li id="aff4" class="ng nh jg kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">β1 是与时间增加一个月相关的死亡对数比的总体平均差异。这可以被指数化以获得与一个月的时间增加相关联的优势比。</li><li id="9915" class="ng nh jg kx b ky np lb nq le nr li ns lm nt lq nl nm nn no bi translated">Tij 是以月为单位对参与者 I 进行第 j 次测量的时间。</li></ul><p id="adb5" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">就是这样。我们的人口平均效应是时间增加一个月，死亡的几率增加一个比值比 exp(β1)。</p><h2 id="2a5f" class="mp lt jg bd lu mq mr dn ly ms mt dp mc le mu mv me li mw mx mg lm my mz mi na bi translated">在 R 中拟合模型</h2><p id="5ce8" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">我们可以在 R 中使用<a class="ae jd" href="https://rdrr.io/cran/geepack/man/geeglm.html" rel="noopener ugc nofollow" target="_blank"> geepack </a>来做到这一点。假设我们的数据帧已经存在，有三列<code class="fe nu nv nw nx b">death</code> <code class="fe nu nv nw nx b">time</code>和<code class="fe nu nv nw nx b">person.id</code>，我们要做的就是:</p><pre class="nc nd ne nf gt ny nx nz oa aw ob bi"><span id="5207" class="mp lt jg nx b gy oc od l oe of">library(geepack)<br/>mod &lt;- geeglm(death ~ time, id = person.id, waves = time, family=binomial, corstr="exchangeable")</span></pre><p id="1361" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后你可以像平常一样调用<code class="fe nu nv nw nx b">summary(mod)</code>并得到你的结果！</p><p id="b3df" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当然，你可以把协变量加到模型中，只要把它们加到公式中。它们可以是时变的，也可以是恒定的——任何一种都可以！</p><h1 id="e73e" class="ls lt jg bd lu lv lw lx ly lz ma mb mc km md kn me kp mf kq mg ks mh kt mi mj bi translated">结论</h1><p id="2f48" class="pw-post-body-paragraph kv kw jg kx b ky mk kh la lb ml kk ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">希望你在读完这篇文章后对 GEE 有了一个基本的概念。它们应该是任何处理纵向数据的数据科学家工具箱中的一个工具。</p></div></div>    
</body>
</html>