<html>
<head>
<title>Sentiment classification in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python ä¸­çš„æƒ…æ„Ÿåˆ†ç±»</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/sentiment-classification-in-python-da31833da01b?source=collection_archive---------10-----------------------#2020-09-12">https://towardsdatascience.com/sentiment-classification-in-python-da31833da01b?source=collection_archive---------10-----------------------#2020-09-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="31fe" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">ä½¿ç”¨ VADER å’Œ TextBlob è¿›è¡Œæƒ…æ„Ÿåˆ†æï¼Œä½¿ç”¨ scikit-learn è¿›è¡Œç›‘ç£æ–‡æœ¬åˆ†ç±»</h2></div><p id="8890" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™ç¯‡æ–‡ç« æ˜¯æ„å»ºæƒ…æ„Ÿåˆ†ç±»å™¨çš„ä¸‰ç¯‡è¿ç»­æ–‡ç« ä¸­çš„æœ€åä¸€ç¯‡ã€‚åšäº†ä¸€äº›<a class="ae le" rel="noopener" target="_blank" href="/exploratory-text-analysis-in-python-8cf42b758d9e">æ¢ç´¢æ€§æ–‡æœ¬åˆ†æ</a>å’Œ<a class="ae le" rel="noopener" target="_blank" href="/preprocessing-text-in-python-923828c4114f">é¢„å¤„ç†æ–‡æœ¬</a>ä¹‹åï¼Œæ˜¯æ—¶å€™å°†è¯„è®ºåˆ†ç±»ä¸ºæƒ…ç»ªäº†ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†é¦–å…ˆçœ‹çœ‹ä¸¤ç§ä¸ç”¨å»ºç«‹æ¨¡å‹å°±èƒ½è·å¾—æƒ…æ„Ÿçš„æ–¹æ³•ï¼Œç„¶åå»ºç«‹ä¸€ä¸ªå®šåˆ¶æ¨¡å‹ã€‚</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/ac22805965e89381a9356617f4d95a9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*29rMZ77wiiW861Ui"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae le" href="https://unsplash.com/@artbyhybrid?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">æ··åˆ</a>åœ¨<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</p></figure><p id="d294" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬åé€€ä¸€æ­¥ï¼Œå¿«é€Ÿåœ°çœ‹ä¸€ä¸‹æ›´å¤§çš„ç”»é¢ã€‚<a class="ae le" href="https://www.datasciencecentral.com/profiles/blogs/crisp-dm-a-standard-methodology-to-ensure-a-good-outcome" rel="noopener ugc nofollow" target="_blank"> CRISP-DM </a>æ–¹æ³•æ¦‚è¿°äº†æˆåŠŸçš„æ•°æ®ç§‘å­¦é¡¹ç›®çš„æµç¨‹ã€‚åœ¨æœ¬å¸–ä¸­ï¼Œæˆ‘ä»¬å°†åšä¸€äº›æ•°æ®ç§‘å­¦å®¶åœ¨<strong class="kk iu">å»ºæ¨¡</strong>é˜¶æ®µä¼šç»å†çš„ä»»åŠ¡ã€‚</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/eb0c82b29b5f0dfa8ec8c5f3758ff76d.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*qvgzhs_qixhx0SRCDN5-jg.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">CRISP-DM å·¥è‰ºæµç¨‹æ‘˜å½•</p></figure></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="6d7c" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">0.Python è®¾ç½®</h1><p id="a298" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">è¿™ç¯‡æ–‡ç« å‡è®¾è¯»è€…(ğŸ‘€æ˜¯çš„ï¼Œä½ ï¼)å¯ä»¥è®¿é—®å¹¶ç†Ÿæ‚‰ Pythonï¼ŒåŒ…æ‹¬å®‰è£…åŒ…ã€å®šä¹‰å‡½æ•°å’Œå…¶ä»–åŸºæœ¬ä»»åŠ¡ã€‚å¦‚æœæ‚¨æ˜¯ Python çš„æ–°æ‰‹ï¼Œ<a class="ae le" href="https://www.python.org/about/gettingstarted/" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å…¥é—¨åœ°æ–¹ã€‚</p><p id="fa10" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘åœ¨ Jupyter ç¬”è®°æœ¬é‡Œæµ‹è¯•è¿‡ Python 3.7.1 çš„è„šæœ¬ã€‚</p><p id="a567" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è®©æˆ‘ä»¬åœ¨å¼€å§‹ä¹‹å‰ç¡®ä¿æ‚¨å·²ç»å®‰è£…äº†ä»¥ä¸‹åº“:<br/> â—¼ï¸ <strong class="kk iu">æ•°æ®æ“ä½œ/åˆ†æ:</strong> <em class="na"> numpyï¼Œpandas <br/> </em> â—¼ï¸ <strong class="kk iu">æ•°æ®åˆ†åŒº:</strong><em class="na">sk learn<br/></em>â—¼ï¸<strong class="kk iu">æ–‡æœ¬é¢„å¤„ç†/åˆ†æ:</strong> <em class="na"> nltkï¼Œtextblob </em> <br/> â—¼ï¸ <strong class="kk iu">å¯è§†åŒ–:</strong> <em class="na"> matplotlibï¼Œseaborn </em></p><p id="657e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä¸€æ—¦ä½ å®‰è£…äº†<em class="na"> nltk </em>ï¼Œè¯·ç¡®ä¿ä½ å·²ç»ä»<em class="na"> nltk </em>ä¸‹è½½äº†<em class="na">ã€åœç”¨è¯ã€‘</em><em class="na">ã€wordnetã€‘</em>å’Œ<em class="na">ã€Vader _ lexiconã€‘</em>ï¼Œè„šæœ¬å¦‚ä¸‹:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="926f" class="ng me it nc b gy nh ni l nj nk">import nltk<br/>nltk.download('stopwords') <br/>nltk.download('wordnet')<br/>nltk.download('vader_lexicon')</span></pre><p id="fe3b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¦‚æœä½ å·²ç»ä¸‹è½½äº†ï¼Œè¿è¡Œè¿™ä¸ªä¼šé€šçŸ¥ä½ ã€‚</p><p id="ece1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å‡†å¤‡å¥½å¯¼å…¥åŒ…äº†:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="ee2a" class="ng me it nc b gy nh ni l nj nk"># Set random seed<br/>seed = 123</span><span id="c1ba" class="ng me it nc b gy nl ni l nj nk"># Data manipulation/analysis<br/>import numpy as np<br/>import pandas as pd</span><span id="c298" class="ng me it nc b gy nl ni l nj nk"># Text preprocessing/analysis<br/>import re<br/>from nltk.corpus import stopwords<br/>from nltk.stem import WordNetLemmatizer<br/>from nltk.tokenize import RegexpTokenizer<br/>from nltk.sentiment.vader import SentimentIntensityAnalyzer<br/>from textblob import TextBlob<br/>from scipy.sparse import hstack, csr_matrix<br/>from sklearn.feature_extraction.text import TfidfVectorizer<br/>from sklearn.preprocessing import MinMaxScaler</span><span id="ac0c" class="ng me it nc b gy nl ni l nj nk"># Modelling<br/>from sklearn.model_selection import train_test_split, cross_validate, GridSearchCV, RandomizedSearchCV<br/>from sklearn.linear_model import LogisticRegression, SGDClassifier<br/>from sklearn.naive_bayes import MultinomialNB<br/>from sklearn.metrics import classification_report, confusion_matrix<br/>from sklearn.pipeline import Pipeline</span><span id="520c" class="ng me it nc b gy nl ni l nj nk"># Visualisation<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>%matplotlib inline<br/>sns.set(style="whitegrid", context='talk')</span></pre><h1 id="b31f" class="md me it bd mf mg nm mi mj mk nn mm mn jz no ka mp kc np kd mr kf nq kg mt mu bi translated">1.æ•°æ®ğŸ“¦</h1><p id="ea4f" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">æˆ‘ä»¬å°†ä½¿ç”¨ IMDB ç”µå½±è¯„è®ºæ•°æ®é›†ã€‚æ‚¨å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½æ•°æ®é›†<a class="ae le" href="https://www.kaggle.com/lakshmi25npathi/imdb-dataset-of-50k-movie-reviews" rel="noopener ugc nofollow" target="_blank">ï¼Œå¹¶å°†å…¶ä¿å­˜åœ¨æ‚¨çš„å·¥ä½œç›®å½•ä¸­ã€‚ä¿å­˜åï¼Œè®©æˆ‘ä»¬å°†å…¶å¯¼å…¥ Python:</a></p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="9c2e" class="ng me it nc b gy nh ni l nj nk">sample = pd.read_csv('IMDB Dataset.csv')<br/>print(f"{sample.shape[0]} rows and {sample.shape[1]} columns")<br/>sample.head()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/6b23a671ee90c83029239e074f5dfca9.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*PHe-BswQXmJWcDyd9CHtLA.png"/></div></figure><p id="bd69" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è®©æˆ‘ä»¬æ¥çœ‹çœ‹æƒ…ç»ªä¹‹é—´çš„åˆ†æ­§:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="8a02" class="ng me it nc b gy nh ni l nj nk">sample['sentiment'].value_counts()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/5e5c06fc380f7ac8acfe9701d65dedac.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*e3f7OlQu1JOKN3FCw-HBMA.png"/></div></figure><p id="87c2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åœ¨æ ·æœ¬æ•°æ®ä¸­ï¼Œæƒ…æ„Ÿæ˜¯å¹³å‡åˆ†é…çš„ã€‚è®©æˆ‘ä»¬å°†ç›®æ ‡ç¼–ç æˆæ•°å­—å€¼ï¼Œå…¶ä¸­æ­£æ•°ä¸º 1ï¼Œè´Ÿæ•°ä¸º 0:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="30cc" class="ng me it nc b gy nh ni l nj nk"># Encode to numeric<br/>sample['target'] = np.where(sample['sentiment']=='positive', 1, 0)</span><span id="14d4" class="ng me it nc b gy nl ni l nj nk"># Check values<br/>sample.groupby(['sentiment', 'target']).count().unstack()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/986b5b6a0665e784ca4af419c1882fe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*_o8-6fAXAEddsI5jDCz3wQ.png"/></div></figure><p id="d7fc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è®©æˆ‘ä»¬ç•™å‡º 5000 ä¸ªæ¡ˆä¾‹è¿›è¡Œæµ‹è¯•:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="1dc4" class="ng me it nc b gy nh ni l nj nk"># Split data into train &amp; test<br/>X_train, X_test, y_train, y_test = train_test_split(sample['review'], sample['sentiment'], test_size=5000, random_state=seed, <br/>                                                    stratify=sample['sentiment'])</span><span id="21aa" class="ng me it nc b gy nl ni l nj nk"># Append sentiment back using indices<br/>train = pd.concat([X_train, y_train], axis=1)<br/>test = pd.concat([X_test, y_test], axis=1)</span><span id="62d8" class="ng me it nc b gy nl ni l nj nk"># Check dimensions<br/>print(f"Train: {train.shape[0]} rows and {train.shape[1]} columns")<br/>print(f"{train['sentiment'].value_counts()}\n")</span><span id="2e91" class="ng me it nc b gy nl ni l nj nk">print(f"Test: {test.shape[0]} rows and {test.shape[1]} columns")<br/>print(test['sentiment'].value_counts())</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/bed36a246927452e55efe8cab219564f.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*0vDtVCpnqFtdFs7lvTIr5A.png"/></div></figure><p id="2544" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å°†å¿«é€Ÿæ£€æŸ¥è®­ç»ƒæ•°æ®é›†çš„å¤´éƒ¨:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="318d" class="ng me it nc b gy nh ni l nj nk">train.head()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/82cbcc4362d2f190d2edb80a4266416c.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*fWrQ9vPZgj7uTTKS2Fl8sQ.png"/></div></figure><p id="ccba" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¥½å§ï¼Œæˆ‘ä»¬å¼€å§‹å§ï¼ğŸ³</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="2266" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">1.æƒ…æ„Ÿåˆ†æğŸ’›</h1><p id="168f" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘æƒ³å‘æ‚¨å±•ç¤ºä¸¤ç§éå¸¸ç®€å•çš„æ–¹æ³•æ¥è·å¾—æƒ…æ„Ÿï¼Œè€Œæ— éœ€æ„å»ºè‡ªå®šä¹‰æ¨¡å‹ã€‚æˆ‘ä»¬å°†ç”¨<em class="na"> VADER </em>å’Œ<em class="na">æ–‡æœ¬å—</em>æå–ææ€§å¼ºåº¦åˆ†æ•°ã€‚</p><h2 id="07d0" class="ng me it bd mf nw nx dn mj ny nz dp mn kr oa ob mp kv oc od mr kz oe of mt og bi translated">1.1.VADER çš„æƒ…æ„Ÿåˆ†æ</h2><blockquote class="oh oi oj"><p id="47f3" class="ki kj na kk b kl km ju kn ko kp jx kq ok ks kt ku ol kw kx ky om la lb lc ld im bi translated">â€œVADER (Valence Aware å­—å…¸å’Œæƒ…æ„Ÿæ¨ç†å™¨)æ˜¯ä¸€ä¸ªåŸºäºè¯å…¸å’Œè§„åˆ™çš„æƒ…æ„Ÿåˆ†æå·¥å…·ï¼Œä¸“é—¨é’ˆå¯¹ç¤¾äº¤åª’ä½“ä¸­è¡¨è¾¾çš„æƒ…æ„Ÿã€‚â€</p></blockquote><p id="c484" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è®©æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­å¼€å§‹ï¼Œçœ‹çœ‹æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨<em class="na"> VADER </em>æƒ…æ„Ÿåˆ†æå™¨æå–æƒ…æ„Ÿå¼ºåº¦åˆ†æ•°:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="76e3" class="ng me it nc b gy nh ni l nj nk">example = 'The movie was awesome.'<br/>sid = SentimentIntensityAnalyzer()<br/>sid.polarity_scores(example)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/639049cd63ae4b021f48f8b4eb2ff2e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*9yjnJzdvgeI6z8jpEWASzA.png"/></div></figure><blockquote class="oh oi oj"><p id="08c4" class="ki kj na kk b kl km ju kn ko kp jx kq ok ks kt ku ol kw kx ky om la lb lc ld im bi translated"><a class="ae le" href="https://github.com/cjhutto/vaderSentiment" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> <em class="it"> negï¼Œneuï¼Œpos: </em> </strong> <em class="it">è¿™ä¸‰ä¸ªåˆ†æ•°ç›¸åŠ ä¸º 1ã€‚è¿™äº›åˆ†æ•°æ˜¾ç¤ºäº†å±äºè¯¥ç±»åˆ«çš„æ–‡æœ¬çš„æ¯”ä¾‹ã€‚<br/> </em> <strong class="kk iu"> <em class="it">å¤åˆ:</em> </strong> <em class="it">è¿™ä¸ªåˆ†æ•°èŒƒå›´ä»-1(æœ€è´Ÿ)åˆ° 1(æœ€æ­£ã€‚</em>T24ã€‘</a></p></blockquote><p id="8e65" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è™½ç„¶ä¸æ˜¯æ‰€æœ‰çš„è¯„è®ºéƒ½åƒæˆ‘ä»¬æ‰‹å¤´çš„ä¾‹å­ä¸€æ ·ç®€å•ï¼Œä½†å¾ˆé«˜å…´çœ‹åˆ°ä¾‹å­è¯„è®ºçš„åˆ†æ•°çœ‹èµ·æ¥å¤§å¤šæ˜¯æ­£é¢çš„ã€‚ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°†å¼ºåº¦åˆ†æ•°æ·»åŠ åˆ°è®­ç»ƒæ•°æ®ä¸­:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="72be" class="ng me it nc b gy nh ni l nj nk">train[['neg', 'neu', 'pos', 'compound']] = train['review'].apply(sid.polarity_scores).apply(pd.Series)<br/>train.head()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi oo"><img src="../Images/fc86ac61eff74116216f9fd52dcbaf25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EFUNsTNBemTHPq6UQPtC4A.png"/></div></div></figure><p id="8a3d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä¸€æ—¦æˆ‘ä»¬åˆå§‹åŒ–äº†åˆ†æå™¨å¯¹è±¡ï¼Œè·å¾—æƒ…æ„Ÿåˆ†æ•°åªéœ€è¦ä¸€è¡Œä»£ç ã€‚æˆ‘ä»¬è¦è¿›ä¸€æ­¥æ£€æŸ¥åˆ†æ•°å—ï¼Ÿè®©æˆ‘ä»¬ä»å¾—åˆ†æœ€é«˜çš„ 5 æ¡è®°å½•å¼€å§‹:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="722c" class="ng me it nc b gy nh ni l nj nk">train.nlargest(5, ['pos'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi op"><img src="../Images/3bede19fd7b9b34af4869f795b49e1ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9nJsK_rGH1H5Y-dVwi3a_Q.png"/></div></div></figure><p id="fcb4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¾ˆé«˜å…´çœ‹åˆ°æ‰€æœ‰çš„è¯„è®ºéƒ½æ˜¯æ­£é¢çš„ã€‚è®©æˆ‘ä»¬ä¸º<em class="na">é˜´æ€§</em>åšåŒæ ·çš„äº‹æƒ…:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="3e8e" class="ng me it nc b gy nh ni l nj nk">train.nlargest(5, ['neg'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi op"><img src="../Images/c19ec41e170de76a57dd4603a0cfa1e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t9insjQnIZadpys-iRDoLA.png"/></div></div></figure><p id="5280" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™ä¸ªçœ‹èµ·æ¥ä¹Ÿä¸é”™ã€‚ä½†æˆ‘ä»¬å¯èƒ½ä¼šçœ‹åˆ°æ•°æ®çš„æç«¯ï¼Œé‚£é‡Œçš„æƒ…ç»ªæ›´åŠ æ˜æ˜¾ã€‚è®©æˆ‘ä»¬ç”¨ç›´æ–¹å›¾ç›´è§‚æ˜¾ç¤ºåˆ†æ•°ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="cf2a" class="ng me it nc b gy nh ni l nj nk">for var in ['pos', 'neg', 'neu', 'compound']:<br/>    plt.figure(figsize=(12,4))<br/>    sns.distplot(train.query("target==1")[var], bins=30, kde=False, <br/>                 color='green', label='Positive')<br/>    sns.distplot(train.query("target==0")[var], bins=30, kde=False, <br/>                 color='red', label='Negative')<br/>    plt.legend()<br/>    plt.title(f'Histogram of {var} by true sentiment');</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi oq"><img src="../Images/c8dba99f7cea373ef92d12e2679dd288.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SAMG_t6QHvN5-N6DM6u4SQ.png"/></div></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi or"><img src="../Images/ad256d5f1ce725fd3a27d06b610932a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r0Bq548egMlNd21TdlUrqA.png"/></div></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi os"><img src="../Images/06fa365b74cba695b41e833d66e626df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bqOM1oxKjwb5wIdtj_D2Ag.png"/></div></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ot"><img src="../Images/765183de3297673e920d423422a3a54a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jmv-G_DKykyleh9i_-RJ2A.png"/></div></div></figure><p id="9c52" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä»ç›´æ–¹å›¾æ¥çœ‹ï¼Œä¼¼ä¹<em class="na"> posã€neg </em>å’Œæ½œåœ¨çš„<em class="na"> compound </em>åˆ—åœ¨å¯¹ç§¯æå’Œæ¶ˆææƒ…ç»ªè¿›è¡Œåˆ†ç±»æ—¶æ˜¯æœ‰ç”¨çš„ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›åˆ†æ•°å¿«é€Ÿåœ°å°†æ¯ä¸ªè¯„è®ºåˆ†ä¸ºæ­£é¢æˆ–è´Ÿé¢ç±»åˆ«ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ƒä¼šåšå¾—å¤šå¥½:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="aaa7" class="ng me it nc b gy nh ni l nj nk">train['vader_polarity'] = np.where(train['pos']&gt;train['neg'], 1, 0)<br/>target_names=['negative', 'positive']<br/>print(classification_report(train['target'], <br/>                            train['vader_polarity'], <br/>                            target_names=target_names))</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/c6436164a5dd9042d12020b32d9be151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*jmtgwaADH1yvX967toh62g.png"/></div></figure><p id="bc85" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä½¿ç”¨<em class="na"> VADER </em>ï¼Œæˆ‘ä»¬å¯ä»¥ä¸è´¹å¹ç°ä¹‹åŠ›è·å¾—å¤§çº¦ 69%çš„å‡†ç¡®ç‡ã€‚ä¸è¿‡ï¼Œæ­£é¢å’Œè´Ÿé¢è¯„è®ºçš„è¡¨ç°çœ‹èµ·æ¥æœ‰æ‰€ä¸åŒã€‚æˆ‘ä»¬å¯¹æ­£é¢è¯„è®ºçš„å¬å›ç‡æ›´é«˜ï¼Œå‡†ç¡®ç‡æ›´ä½â€”â€”è¿™æ„å‘³ç€æˆ‘ä»¬æœ‰æ›´å¤šçš„è¯¯æŠ¥(çœ‹åˆ°æˆ‘åœ¨é‚£é‡Œåšäº†ä»€ä¹ˆå—ï¼Ÿä½ æ˜ç™½æˆ‘ä¸ºä»€ä¹ˆæŠŠæ­£é¢è¯„ä»·ç¼–ç ä¸º 1 äº†å—ï¼ŸğŸ™Š).è®©æˆ‘ä»¬çœ‹çœ‹æ··æ·†çŸ©é˜µ:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="b965" class="ng me it nc b gy nh ni l nj nk"># Create function so that we could reuse later<br/>def plot_cm(y_test, y_pred, target_names=['negative', 'positive'], <br/>            figsize=(5,3)):<br/>    """Create a labelled confusion matrix plot."""<br/>    cm = confusion_matrix(y_test, y_pred)<br/>    fig, ax = plt.subplots(figsize=figsize)<br/>    sns.heatmap(cm, annot=True, fmt='g', cmap='BuGn', cbar=False, <br/>                ax=ax)<br/>    ax.set_title('Confusion matrix')<br/>    ax.set_xlabel('Predicted')<br/>    ax.set_xticklabels(target_names)<br/>    ax.set_ylabel('Actual')<br/>    ax.set_yticklabels(target_names, <br/>                       fontdict={'verticalalignment': 'center'});</span><span id="17be" class="ng me it nc b gy nl ni l nj nk"># Plot confusion matrix<br/>plot_cm(train['target'], train['vader_polarity'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/e4ed892a54bca13264cc6905b7da869d.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*zQ-BNaGmy9i2w3KpzjSGbw.png"/></div></figure><p id="09ef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œæˆ‘ä»¬æœ‰è®¸å¤šçœŸé˜³æ€§å’Œå‡é˜³æ€§ã€‚äº‹å®ä¸Šï¼Œå¤§çº¦ 67%çš„é¢„æµ‹æ˜¯ç§¯æçš„ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚æœä½¿ç”¨<em class="na">å¤åˆ</em>åˆ†æ•°ï¼Œæ€§èƒ½æ˜¯å¦ä¼šæé«˜ã€‚</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="1c7e" class="ng me it nc b gy nh ni l nj nk">train['vader_compound'] = np.where(train['compound']&gt;0, 1, 0)<br/>print(classification_report(train['target'], <br/>                            train['vader_compound'], <br/>                            target_names=target_names))</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/30da55ff4c8c4f8e4e87bbb9f113f5e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*hKc5mr0gw1sByg7I89BXig.png"/></div></figure><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="a1bd" class="ng me it nc b gy nh ni l nj nk">plot_cm(train['target'], train['vader_compound'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ox"><img src="../Images/1c9f128b42011bc1d60a16116ca4f31c.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*ukwsadCsVAqQXFLlp6Wxfw.png"/></div></div></figure><p id="40ba" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ€§èƒ½çœ‹èµ·æ¥éå¸¸ç›¸ä¼¼ã€‚æˆ‘ä½¿ç”¨è®­ç»ƒæ•°æ®é›†è¿›è¡Œè¯„ä¼°ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨è¿™é‡Œä¸æ˜¯è®­ç»ƒæ¨¡å‹ã€‚ä½†æ˜¯ï¼Œå¦‚æœå¯¹æµ‹è¯•æ•°æ®è¿›è¡ŒåŒæ ·çš„æ“ä½œï¼Œç»“æœåº”è¯¥éå¸¸ç›¸ä¼¼ã€‚</p><p id="2beb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ğŸ”—nltk  ä¸­å…³äº<a class="ae le" href="https://github.com/cjhutto/vaderSentiment" rel="noopener ugc nofollow" target="_blank"><em class="na">ã€VADERã€‘</em></a><em class="na"/><a class="ae le" href="https://www.nltk.org/howto/sentiment.html" rel="noopener ugc nofollow" target="_blank"><em class="na">VADER çš„æ›´å¤šä¿¡æ¯ã€‚</em></a></p><h2 id="2762" class="ng me it bd mf nw nx dn mj ny nz dp mn kr oa ob mp kv oc od mr kz oe of mt og bi translated">1.2.ä½¿ç”¨ TextBlob è¿›è¡Œæƒ…æ„Ÿåˆ†æ</h2><p id="1c30" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">å¦ä¸€ç§è·å¾—æƒ…æ„Ÿåˆ†æ•°çš„æ–¹æ³•æ˜¯åˆ©ç”¨<em class="na"> TextBlob </em>åº“ã€‚ä½¿ç”¨æ¥è‡ª<em class="na"> TextBlob </em>å¯¹è±¡çš„æƒ…æ„Ÿå±æ€§ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æå–ç›¸ä¼¼çš„åˆ†æ•°ã€‚ä¸‹é¢æ˜¯æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨ä¹‹å‰çš„ç¤ºä¾‹è¿›è¡Œæå–:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="fa25" class="ng me it nc b gy nh ni l nj nk">TextBlob(example).sentiment</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/f2647eef1449ffc98c15661891a8e11f.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*pkNPreTSFYqnxVxhKM2imA.png"/></div></figure><blockquote class="oh oi oj"><p id="7b7e" class="ki kj na kk b kl km ju kn ko kp jx kq ok ks kt ku ol kw kx ky om la lb lc ld im bi translated"><strong class="kk iu"> <em class="it">ææ€§:</em> </strong> <em class="it">èŒƒå›´ä»-1(æœ€è´Ÿ)åˆ° 1(æœ€æ­£)<br/> </em> <strong class="kk iu"> <em class="it">ä¸»è§‚æ€§:</em> </strong> <em class="it">èŒƒå›´ä» 0(éå¸¸å®¢è§‚)åˆ° 1(éå¸¸ä¸»è§‚)</em></p></blockquote><p id="5829" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬çš„ä¾‹å­è¢«åˆ†æä¸ºéå¸¸ä¸»è§‚çš„è‚¯å®šé™ˆè¿°ã€‚æ˜¯çœŸçš„ï¼Œä¸æ˜¯å—ï¼Ÿåœ¨è¿™ä¸¤ä¸ªåˆ†æ•°ä¸­ï¼Œ<em class="na">ææ€§</em>ä¸æˆ‘ä»¬æ›´ç›¸å…³ã€‚è®©æˆ‘ä»¬å°†å¼ºåº¦åˆ†æ•°æ·»åŠ åˆ°è®­ç»ƒæ•°æ®ä¸­ï¼Œå¹¶æ£€æŸ¥å…·æœ‰æœ€é«˜<em class="na">ææ€§</em>åˆ†æ•°çš„ 5 ä¸ªè®°å½•:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="098a" class="ng me it nc b gy nh ni l nj nk">train[['polarity', 'subjectivity']] = train['review'].apply(lambda x:TextBlob(x).sentiment).to_list()</span><span id="15b3" class="ng me it nc b gy nl ni l nj nk">columns = ['review', 'target', 'polarity', 'subjectivity']<br/>train[columns].nlargest(5, ['polarity'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/daeaf74850f11f4e8bb4ac6d604101da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*-ultlUoZ3pufwWZhSIp6Zg.png"/></div></figure><p id="8835" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¦‚ä½ æ‰€è§ï¼Œç”¨<em class="na"> TextBlob </em>æ·»åŠ æƒ…æ„Ÿå¼ºåº¦åˆ†æ•°ä¹Ÿå¾ˆç®€å•ã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹ææ€§<em class="na">åˆ†æ•°æœ€ä½çš„ 5 æ¡è®°å½•:</em></p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="3634" class="ng me it nc b gy nh ni l nj nk">train[columns].nsmallest(5, ['polarity'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/c483f87a7f591be357643395ef7a72a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*gT93FYT3jxBfEgKl65yc8g.png"/></div></figure><p id="9450" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ˜¯æ—¶å€™ç»˜åˆ¶ä¸€äº›ç›´æ–¹å›¾æ¥æ›´å¥½åœ°ç†è§£åˆ†æ•°äº†:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="fd1b" class="ng me it nc b gy nh ni l nj nk">for var in ['polarity', 'subjectivity']:<br/>    plt.figure(figsize=(12,4))<br/>    sns.distplot(train.query("target==1")[var], bins=30, kde=False, <br/>                 color='green', label='Positive')<br/>    sns.distplot(train.query("target==0")[var], bins=30, kde=False, <br/>                 color='red', label='Negative')<br/>    plt.legend()<br/>    plt.title(f'Histogram of {var} by true sentiment');</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi or"><img src="../Images/3cdf061d1a6cb0203edd7fe6d1e0907a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b7SLSmVsZjnqsJnlO6EERA.png"/></div></div></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pb"><img src="../Images/1d48d1bdcbc3be13f39c0c7ef2778243.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cRQ9zhbsn_AyoxIMqVqPFw.png"/></div></div></figure><p id="e6db" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ­£å¦‚æ‰€æ–™ï¼Œ<em class="na">ææ€§</em>åˆ†æ•°çœ‹èµ·æ¥å¯èƒ½æœ‰åŠ©äºå¯¹ç§¯ææƒ…ç»ªå’Œæ¶ˆææƒ…ç»ªè¿›è¡Œåˆ†ç±»ã€‚è®©æˆ‘ä»¬ä½¿ç”¨<em class="na">ææ€§</em>åˆ†æ•°è¿›è¡Œåˆ†ç±»ï¼Œå¹¶æŸ¥çœ‹æ€§èƒ½:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="bba9" class="ng me it nc b gy nh ni l nj nk">train['blob_polarity'] = np.where(train['polarity']&gt;0, 1, 0)<br/>print(classification_report(train['target'], <br/>                            train['blob_polarity'], <br/>                            target_names=target_names))</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/41710a95225dd457dfccaef9a6cd1685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*BAGdbyCN-1Vg2xDd1JLFmw.png"/></div></figure><p id="cc55" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä½¿ç”¨<em class="na"> TextBlob </em>ï¼Œæˆ‘ä»¬å¯ä»¥ä¸è´¹å¹ç°ä¹‹åŠ›è·å¾—å¤§çº¦ 69%çš„å‡†ç¡®ç‡ã€‚åŒæ ·ï¼Œæˆ‘ä»¬æœ‰è®¸å¤šå‡é˜³æ€§ï¼Œäº‹å®ä¸Šï¼Œç”šè‡³æ¯”ä»¥å‰æ›´å¤šã€‚è®©æˆ‘ä»¬çœ‹çœ‹æ··æ·†çŸ©é˜µ:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="3d6d" class="ng me it nc b gy nh ni l nj nk">plot_cm(train['target'], train['blob_polarity'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/3be0a2d32ac061dd2c97f8bd207e6132.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*alKDx1ZNC9x8xRm1vCB1sg.png"/></div></figure><p id="3e8d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™ä¸€æ¬¡ï¼Œå‡é˜³æ€§çš„æ•°é‡é«˜äºçœŸé˜´æ€§çš„æ•°é‡ã€‚é¢„æµ‹åå‘ç§¯ææƒ…ç»ªï¼Œå› ä¸º 76%çš„é¢„æµ‹æ˜¯ç§¯æçš„ã€‚</p><p id="8375" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ğŸ”—å…³äº<a class="ae le" href="https://textblob.readthedocs.io/en/dev/" rel="noopener ugc nofollow" target="_blank"> <em class="na"> TextBlob </em>çš„æ›´å¤šä¿¡æ¯ã€‚</a></p><h2 id="5ed2" class="ng me it bd mf nw nx dn mj ny nz dp mn kr oa ob mp kv oc od mr kz oe of mt og bi translated">1.3.ä¸¤è€…ä¹‹é—´çš„å…³ç³»</h2><p id="f133" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">è®©æˆ‘ä»¬æ¥æ¯”è¾ƒä¸€ä¸‹<em class="na"> VADER </em>å’Œ<em class="na"> TextBlob </em>çš„åˆ†æ•°æœ‰å¤šç›¸ä¼¼:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="f101" class="ng me it nc b gy nh ni l nj nk">pd.crosstab(train['vader_polarity'], train['blob_polarity'])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pd"><img src="../Images/1b2682057bd48af7d1f65f73283e69af.png" data-original-src="https://miro.medium.com/v2/resize:fit:464/format:webp/1*T0OAiYigTgiNl_0cxPbVoA.png"/></div></div></figure><p id="ebf2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä»–ä»¬çš„åˆ†ç±»ä¸­æœ‰å¤§çº¦ 79%çš„é‡å ï¼Œå¤§å¤šæ•°æ˜¯æ­£é¢æƒ…ç»ªã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹ææ€§å¾—åˆ†:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="baf3" class="ng me it nc b gy nh ni l nj nk">plt.figure(figsize=(12,12))<br/>sns.scatterplot(data=train, x='polarity', y='compound',<br/>                hue='target', palette=['red', 'green'], <br/>                alpha=.3)<br/>plt.axhline(0, linestyle='--', color='k')<br/>plt.axvline(0, linestyle='--', color='k')<br/>plt.title('Scatterplot between polarity intensity scores');</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pe"><img src="../Images/0aa19bf51624efda89c23521a1f9836a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5-Pl7Hob_8dLaIIthFvOLg.png"/></div></div></figure><p id="2ea8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™å¼ å›¾æ˜¾ç¤ºçš„ä¿¡æ¯æ¯”å‰ä¸€å¼ è¡¨å¤šä¸€ç‚¹ã€‚åœ¨å·¦ä¸‹è±¡é™ï¼Œæˆ‘ä»¬ä¸»è¦çœ‹åˆ°çº¢è‰²åœ†åœˆï¼Œå› ä¸ºä¸¤ç§æ–¹æ³•ä¸­çš„è´Ÿé¢åˆ†ç±»éƒ½æ›´ç²¾ç¡®ã€‚åœ¨å³ä¸Šè±¡é™ï¼Œæœ‰å¤§é‡çš„åœ†åœˆï¼Œå¤§éƒ¨åˆ†æ˜¯ç»¿è‰²çš„ï¼Œä½†é¢œè‰²æ··åˆä¸åƒä»¥å‰é‚£ä¹ˆçº¯ã€‚å‰©ä¸‹çš„ä¸¤ä¸ªè±¡é™æ˜¾ç¤ºäº†ä¸¤ä¸ªåˆ†æ•°ä¸ä¸€è‡´çš„åœ°æ–¹ã€‚æ€»çš„æ¥è¯´ï¼Œåœ¨å›¾çš„å³åŠéƒ¨åˆ†ï¼Œé¢œè‰²æ¯”å·¦åŠéƒ¨åˆ†æ›´æ··åˆã€‚</p><p id="7d1b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬ä»ä¸¤è€…ä¸­å¾—åˆ°éå¸¸ç›¸ä¼¼çš„ 69%çš„æ€»ä½“å‡†ç¡®åº¦ï¼›ç„¶è€Œï¼Œå½“æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿé¢„æµ‹æ—¶ï¼Œè¿™ä¸¤ç§æ–¹æ³•ä¹‹é—´çš„æ€§èƒ½æ˜¯ä¸åŒçš„ã€‚</p><p id="f6c7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç°åœ¨ä½ çŸ¥é“å¦‚ä½•ç”¨<em class="na"> VADER </em>æˆ–<em class="na">æ–‡æœ¬å—</em>è·å¾—æƒ…æ„Ÿææ€§åˆ†æ•°ã€‚å¦‚æœæ‚¨æœ‰æœªæ ‡è®°çš„æ•°æ®ï¼Œè¿™ä¸¤ä¸ªå·¥å…·ä¸ºè‡ªåŠ¨æ ‡è®°æ‚¨çš„æ•°æ®æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚æ˜¯æ—¶å€™å»ºç«‹æ¨¡å‹äº†ï¼âœ¨</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="ea0b" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">2.æ¨¡æ‹Ÿâ“œï¸</h1><p id="4df3" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†:</p><ol class=""><li id="d275" class="pf pg it kk b kl km ko kp kr ph kv pi kz pj ld pk pl pm pn bi translated">é€‰æ‹©åˆé€‚çš„é¢„å¤„ç†æ–¹æ³•å’Œç®—æ³•</li><li id="7698" class="pf pg it kk b kl po ko pp kr pq kv pr kz ps ld pk pl pm pn bi translated">æ¢ç´¢æ·»åŠ <em class="na"> VADER </em>å’Œ<em class="na">æ–‡æœ¬æ–‘ç‚¹</em>æƒ…æ„Ÿåˆ†æ•°ä½œä¸ºç‰¹å¾æ˜¯å¦ä¼šæé«˜æ¨¡å‹çš„é¢„æµ‹èƒ½åŠ›</li><li id="509e" class="pf pg it kk b kl po ko pp kr pq kv pr kz ps ld pk pl pm pn bi translated">æ„å»ºç®¡é“å¹¶è°ƒæ•´å…¶è¶…å‚æ•°</li><li id="2558" class="pf pg it kk b kl po ko pp kr pq kv pr kz ps ld pk pl pm pn bi translated">åœ¨çœ‹ä¸è§çš„æ•°æ®ä¸Šæµ‹è¯•æœ€ç»ˆç®¡é“</li></ol><p id="b4a7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æƒ…æ„Ÿåˆ†ç±»æ˜¯ç›‘ç£åˆ†ç±»æ¨¡å‹çš„ä¸€ä¸ªåº”ç”¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œé‡‡ç”¨çš„æ–¹æ³•å¯ä»¥æ¨å¹¿åˆ°ä»»ä½•ç›‘ç£åˆ†ç±»ä»»åŠ¡ã€‚</p><h2 id="626c" class="ng me it bd mf nw nx dn mj ny nz dp mn kr oa ob mp kv oc od mr kz oe of mt og bi translated">2.1.é€‰æ‹©åˆé€‚çš„é¢„å¤„ç†æ–¹æ³•å’Œç®—æ³•</h2><p id="b7b8" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">åœ¨<a class="ae le" rel="noopener" target="_blank" href="/preprocessing-text-in-python-923828c4114f">æˆ‘ä¹‹å‰çš„å¸–å­</a>ä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢äº†ä¸‰ç§ä¸åŒçš„æ–‡æœ¬é¢„å¤„ç†æ–¹æ³•ï¼Œå¹¶åˆ—å‡ºå…¶ä¸­ä¸¤ç§:<em class="na">ç®€å•æ–¹æ³•</em>å’Œ<em class="na">ç®€å•æ–¹æ³•</em>ã€‚åœ¨è¿™ä¸¤ä¸ªé€‰é¡¹ä¸­ï¼Œæˆ‘ä»¬ç°åœ¨å°†æµ‹è¯•è¿™ä¸¤ä¸ªé€‰é¡¹ä¹‹é—´çš„æ¨¡å‹æ€§èƒ½æ˜¯å¦æœ‰ä»»ä½•å·®å¼‚ï¼Œå¹¶é€‰æ‹©å…¶ä¸­ä¸€ä¸ªæ¥ä½¿ç”¨å‘å‰ç§»åŠ¨ã€‚ä¸ºäº†ä½¿äº‹æƒ…å˜å¾—ç®€å•ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªå‡½æ•°(è¿™äº›å‡½æ•°çš„æƒ³æ³•æ˜¯ä»<a class="ae le" href="https://www.kaggle.com/pouryaayria/a-complete-ml-pipeline-tutorial-acu-86/comments" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>å¾—åˆ°çš„å¯å‘):</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="5a54" class="ng me it nc b gy nh ni l nj nk"># Define functions<br/>def create_baseline_models():<br/>    """Create list of baseline models."""<br/>    models = []<br/>    models.append(('log', LogisticRegression(random_state=seed, <br/>                                             max_iter=1000)))<br/>    models.append(('sgd', SGDClassifier(random_state=seed)))<br/>    models.append(('mnb', MultinomialNB()))<br/>    return models</span><span id="da20" class="ng me it nc b gy nl ni l nj nk">def assess(X, y, models, cv=5, scoring=['roc_auc', <br/>                                        'accuracy', <br/>                                        'f1']):<br/>    """Provide summary of cross validation results for models."""<br/>    results = pd.DataFrame()<br/>    for name, model in models:<br/>        result = pd.DataFrame(cross_validate(model, X, y, cv=cv, <br/>                                             scoring=scoring))<br/>        mean = result.mean().rename('{}_mean'.format)<br/>        std = result.std().rename('{}_std'.format)<br/>        results[name] = pd.concat([mean, std], axis=0)<br/>    return results.sort_index()</span></pre><p id="5b3b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘æŒ‘äº†ä¸‰ä¸ªç®—æ³•æ¥è¯•:<a class="ae le" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html" rel="noopener ugc nofollow" target="_blank"> <em class="na">é€»è¾‘å›å½’åˆ†ç±»å™¨</em> </a>ã€<a class="ae le" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html?highlight=sgd#sklearn.linear_model.SGDClassifier" rel="noopener ugc nofollow" target="_blank"> <em class="na">éšæœºæ¢¯åº¦ä¸‹é™åˆ†ç±»å™¨</em> </a>å’Œ<a class="ae le" href="https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.MultinomialNB.html?highlight=multinomialnb#sklearn.naive_bayes.MultinomialNB" rel="noopener ugc nofollow" target="_blank"> <em class="na">å¤šé¡¹æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨</em> </a>ã€‚è®©æˆ‘ä»¬å¯åŠ¨æ¨¡å‹:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="f7bc" class="ng me it nc b gy nh ni l nj nk">models = create_baseline_models()<br/>models</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/c7c50e0630f51a84019c1d0a7b51c0b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*2GSfUv9BLoLO9MtGaNFG9A.png"/></div></figure><p id="812c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä½¿ç”¨<em class="na">æ›´ç®€å•æ–¹æ³•</em>æ—¶çš„æ¨¡å‹æ€§èƒ½:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="8ccf" class="ng me it nc b gy nh ni l nj nk"># Preprocess the data<br/>vectoriser = TfidfVectorizer(token_pattern=r'[a-z]+', <br/>                             stop_words='english', <br/>                             min_df=30, <br/>                             max_df=.7)<br/>X_train_simpler = vectoriser.fit_transform(X_train)</span><span id="618e" class="ng me it nc b gy nl ni l nj nk"># Assess the model<br/>assess(X_train_simpler, y_train, models)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/16ffbde7506d1a91ffd3d9aac9324c61.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*Bwvb1tc0ZXCr8n7pMvrnAA.png"/></div></figure><p id="6db3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¾ˆé«˜å…´çœ‹åˆ°æˆ‘ä»¬è·å¾—äº†æ›´å¥½çš„æ€§èƒ½:ä¸ä»…ä½¿ç”¨æƒ…æ„Ÿåˆ†æ•°ç›¸æ¯”ï¼ŒåŸºçº¿æ¨¡å‹çš„å‡†ç¡®ç‡ä¸º 86â€“89%ã€‚ç”±äºè¿™äº›èŒä¸šç›¸å½“å¹³è¡¡ï¼Œæˆ‘ä»¬å°†ä¸»è¦å…³æ³¨å‡†ç¡®æ€§ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å°†ç¡®ä¿ç¨åæ›´ä»”ç»†åœ°æ£€æŸ¥é¢„æµ‹ï¼Œä»¥è¯„ä¼°æ¨¡å‹ã€‚æ€§èƒ½æŒ‡æ ‡åœ¨<em class="na">é€»è¾‘å›å½’</em>å’Œ<em class="na">éšæœºæ¢¯åº¦ä¸‹é™</em>ä¹‹é—´çœ‹èµ·æ¥éå¸¸æ¥è¿‘ï¼Œåè€…åœ¨è®­ç»ƒä¸­æ›´å¿«(å‚è§<em class="na"> fit_time </em>)ã€‚æœ´ç´ è´å¶æ–¯æ˜¯ä¸‰ä¸ªäººä¸­è®­ç»ƒé€Ÿåº¦æœ€å¿«çš„ï¼Œä½†æ˜¯è¡¨ç°æ¯”å…¶ä»–ä¸¤ä¸ªäººç¨å·®ã€‚ç°åœ¨è®©æˆ‘ä»¬æ¥è¯„ä¼°ä¸€ä¸‹<em class="na">ç®€å•æ–¹æ³•</em>:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="b1b0" class="ng me it nc b gy nh ni l nj nk"># Define function<br/>def preprocess_text(text):<br/>    # 1. Tokenise to alphabetic tokens<br/>    tokeniser = RegexpTokenizer(r'[A-Za-z]+')<br/>    tokens = tokeniser.tokenize(text)<br/>    <br/>    # 2. Lowercase and lemmatise <br/>    lemmatiser = WordNetLemmatizer()<br/>    tokens = [lemmatiser.lemmatize(t.lower(), pos='v') <br/>              for t in tokens]<br/>    return tokens</span><span id="439d" class="ng me it nc b gy nl ni l nj nk"># Preprocess the data<br/>vectoriser = TfidfVectorizer(analyzer=preprocess_text, <br/>                             min_df=30, <br/>                             max_df=.7)<br/>X_train_simple = vectoriser.fit_transform(X_train)</span><span id="0a7e" class="ng me it nc b gy nl ni l nj nk"># Assess models<br/>assess(X_train_simple, y_train, models)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/2c5b287fef37fe8a72b13de655718986.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*8pwnnDLD5rY3sNkPS6GKdg.png"/></div></figure><p id="0144" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æ€§èƒ½çœ‹èµ·æ¥å’Œä»¥å‰å·®ä¸å¤šã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†å€¾å‘äºä½¿ç”¨<em class="na">æ›´ç®€å•çš„æ–¹æ³•</em>,å¹¶ç»§ç»­ä½¿ç”¨å®ƒã€‚åœ¨è¿™ä¸‰ç§ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬å°†é€‰æ‹©<em class="na">éšæœºæ¢¯åº¦ä¸‹é™</em>ï¼Œå› ä¸ºå®ƒæœ€èƒ½å¹³è¡¡é€Ÿåº¦å’Œé¢„æµ‹èƒ½åŠ›ã€‚</p><h2 id="a50f" class="ng me it bd mf nw nx dn mj ny nz dp mn kr oa ob mp kv oc od mr kz oe of mt og bi translated">2.2.è¯„ä¼°é™„åŠ åŠŸèƒ½</h2><p id="0a28" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨æ·»åŠ <em class="na"> VADER </em>å’Œ<em class="na">æ–‡æœ¬æ–‘ç‚¹</em>æƒ…æ„Ÿåˆ†æ•°ä½œä¸ºç‰¹å¾æ˜¯å¦ä¼šæé«˜æ¨¡å‹çš„é¢„æµ‹èƒ½åŠ›ã€‚è®©æˆ‘ä»¬å¿«é€Ÿæ£€æŸ¥ä¸€ä¸‹æ˜¯å¦æœ‰ä»»ä½•é«˜åº¦ç›¸å…³çš„ç‰¹æ€§:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="ce1e" class="ng me it nc b gy nh ni l nj nk">plt.figure(figsize = (14,5))<br/>columns = ['target', 'neg', 'neu', 'pos', 'compound', 'polarity', <br/>           'subjectivity']<br/>sns.heatmap(train[columns].corr(), annot=True, cmap='seismic_r');</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pw"><img src="../Images/fbd4350aeedae0035ac78e299b1390fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YBTXK4CxD9X5QRik-N7qeA.png"/></div></div></figure><p id="b800" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æœ€ç›¸å…³çš„ç‰¹å¾æ˜¯<em class="na">å¤åˆ</em>å’Œ<em class="na">è´Ÿ</em>ã€‚è®©æˆ‘ä»¬è¿è¡Œä¸€ä¸ªå¿«é€Ÿæ¨¡å‹ï¼Œçœ‹çœ‹å“ªäº›åˆ†æ•°æ›´æœ‰ç”¨:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="6b64" class="ng me it nc b gy nh ni l nj nk"># Initialise a model<br/>sgd = SGDClassifier(random_state=seed)</span><span id="5b63" class="ng me it nc b gy nl ni l nj nk"># Initialise a scaler<br/>scaler = MinMaxScaler()</span><span id="562b" class="ng me it nc b gy nl ni l nj nk"># Assess the model using scores<br/>scores = train[['neg', 'neu', 'pos', 'compound', 'polarity', <br/>                'subjectivity']]<br/>assess(scaler.fit_transform(scores), y_train, [('sgd', sgd)])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi px"><img src="../Images/876f0027833428e71bc12a099d2403b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*341aIzrIS9UsU26rXe-JzQ.png"/></div></figure><p id="0c96" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬ä½¿ç”¨åˆ†æ•°å¾—åˆ°å¤§çº¦ 77%çš„å‡†ç¡®ç‡ã€‚ç°åœ¨è®©æˆ‘ä»¬æ£€æŸ¥ç³»æ•°:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="aa9a" class="ng me it nc b gy nh ni l nj nk"># Fit to training data<br/>sgd.fit(scores, y_train)</span><span id="04b7" class="ng me it nc b gy nl ni l nj nk"># Get coefficients<br/>coefs = pd.DataFrame(data=sgd.coef_, columns=scores.columns).T<br/>coefs.rename(columns={0: 'coef'}, inplace=True)</span><span id="7fcd" class="ng me it nc b gy nl ni l nj nk"># Plot<br/>plt.figure(figsize=(10,5))<br/>sns.barplot(x=coefs.index, y='coef', data=coefs)<br/>plt.title('Coefficients');</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi py"><img src="../Images/a9ad1551203a63acf1f66b43898fe0e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1362/format:webp/1*lykkZKbjFS_oKr3yC3UOLA.png"/></div></figure><p id="04bc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä¼¼ä¹æˆ‘ä»¬åªèƒ½ä½¿ç”¨<em class="na">é˜´æ€§ã€é˜³æ€§</em>å’Œ<em class="na">ææ€§</em>ï¼Œå› ä¸ºå®ƒä»¬æ˜¯å¾—åˆ†<em class="na">ä¸­æœ€ä¸»è¦çš„ç‰¹å¾ã€‚</em>è®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦å¯ä»¥é€šè¿‡å°†è¿™äº›é€‰æ‹©çš„åˆ†æ•°æ·»åŠ åˆ°å…ˆå‰é¢„å¤„ç†çš„æ•°æ®æ¥æ”¹è¿›æ¨¡å‹ç»“æœã€‚</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="77e2" class="ng me it nc b gy nh ni l nj nk"># Add features to sparse matrix<br/>selected_scores = train[['neg', 'pos', 'polarity']]<br/>X_train_extended = hstack([X_train_simpler, csr_matrix(scaler.fit_transform(selected_scores))])</span><span id="0ec7" class="ng me it nc b gy nl ni l nj nk"># Assess<br/>assess(X_train_extended, y_train, [('sgd', sgd)])</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi px"><img src="../Images/d03ad39844fbbb002f2b3b9d0b0e7374.png" data-original-src="https://miro.medium.com/v2/resize:fit:430/format:webp/1*1kKaP9hJE7OQtgYp1xv79Q.png"/></div></figure><p id="a972" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç”±äºæ·»åŠ è¿™äº›åˆ†æ•°å¹¶æ²¡æœ‰æ”¹è¿›æ¨¡å‹ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦å°†å®ƒä»¬ä½œä¸ºç‰¹å¾æ·»åŠ ã€‚è¿™ä¹Ÿå°†ä½¿æˆ‘ä»¬çš„æ¸ é“ä¿æŒç®€å•ï¼</p><h2 id="5de7" class="ng me it bd mf nw nx dn mj ny nz dp mn kr oa ob mp kv oc od mr kz oe of mt og bi translated">2.3.æ„å»ºç®¡é“å¹¶è°ƒæ•´å…¶è¶…å‚æ•°</h2><p id="2e4b" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">æ˜¯æ—¶å€™æ„å»ºä¸€ä¸ªå°ç®¡é“ï¼Œå°†é¢„å¤„ç†å™¨å’Œæ¨¡å‹æ”¾åœ¨ä¸€èµ·äº†ã€‚æˆ‘ä»¬å°†å¾®è°ƒå®ƒçš„è¶…å‚æ•°ï¼Œçœ‹çœ‹æˆ‘ä»¬æ˜¯å¦èƒ½æ”¹è¿›è¿™ä¸ªæ¨¡å‹ã€‚é¦–å…ˆï¼Œè®©æˆ‘ä»¬å°è¯•ç†è§£ä¸‰ä¸ªè¶…å‚æ•°çš„å½±å“:å¯¹äºå‘é‡æœºçš„<code class="fe pz qa qb nc b">min_df</code>ã€<code class="fe pz qa qb nc b">max_df</code>å’Œå¯¹äºéšæœºæœç´¢æ¨¡å‹çš„<code class="fe pz qa qb nc b">loss</code>:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="a2c9" class="ng me it nc b gy nh ni l nj nk"># Create a pipeline<br/>pipe = Pipeline([('vectoriser', TfidfVectorizer(token_pattern=r'[a-z]+')),<br/>                 ('model', SGDClassifier(random_state=seed))])</span><span id="d135" class="ng me it nc b gy nl ni l nj nk"># Prepare a random search<br/>param_distributions = {'vectoriser__min_df': np.arange(10, 1000, 10),<br/>                       'vectoriser__max_df': np.linspace(.2, 1, 40),<br/>                       'model__loss': ['log', 'hinge']}<br/>r_search = RandomizedSearchCV(estimator=pipe, param_distributions=param_distributions, <br/>                              n_iter=30, cv=5, n_jobs=-1, random_state=seed)<br/>r_search.fit(X_train, y_train)</span><span id="391a" class="ng me it nc b gy nl ni l nj nk"># Save results to a dataframe<br/>r_search_results = pd.DataFrame(r_search.cv_results_).sort_values(by='rank_test_score')</span></pre><p id="680b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è¿™é‡Œï¼Œæˆ‘ä»¬æ­£åœ¨å°è¯• 30 ç§ä¸åŒçš„è¶…å‚æ•°ç©ºé—´æŒ‡å®šçš„éšæœºç»„åˆã€‚è¿™éœ€è¦ä¸€æ®µæ—¶é—´æ¥è¿è¡Œã€‚éšæœºæœç´¢çš„è¾“å‡ºå°†ä¿å­˜åœ¨åä¸º<code class="fe pz qa qb nc b">r_search_results</code>çš„æ•°æ®å¸§ä¸­ã€‚è®©æˆ‘ä»¬åˆ›å»ºå¦ä¸€ä¸ªæ•°æ®æ¡†æ¶ï¼Œå…¶ä¸­åŒ…å«ä¸€äº›æˆ‘ä»¬æ›´æ„Ÿå…´è¶£çš„åˆ—:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="1c91" class="ng me it nc b gy nh ni l nj nk">columns = [col for col in r_search_results.columns <br/>           if re.search(r"split|param_", col)]<br/>r_summary = r_search_results[columns].copy()<br/>r_summary.columns = [re.sub(r'_test_score|param_', '', col) <br/>                     for col in r_summary.columns]<br/>columns = [col.split('__')[1] if '__' in col else col <br/>           for col in r_summary.columns ]<br/>r_summary.columns = columns<br/>r_summary.head()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi qc"><img src="../Images/8acd6efc3bbd8f64736433483f85e398.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*e0ty_8YaVEsE6MVlhP1snw.png"/></div></figure><p id="848b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è®©æˆ‘ä»¬å°†è¾“å‡ºå¯è§†åŒ–ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç†è§£è¶…å‚æ•°çš„å½±å“:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="f425" class="ng me it nc b gy nh ni l nj nk"># Create a long dataframe<br/>r_summary_long = pd.melt(r_summary, <br/>                         id_vars=['min_df', <br/>                                  'max_df', <br/>                                  'loss'], <br/>                         value_vars=['split0', <br/>                                     'split1', <br/>                                     'split2', <br/>                                     'split3', <br/>                                     'split4'])</span><span id="7c3f" class="ng me it nc b gy nl ni l nj nk"># Plot hyperparameter 'loss'<br/>plt.figure(figsize=(8,4))<br/>plt.title('Performance by loss')<br/>sns.boxplot(x='value', y='loss', data=r_summary_long, <br/>            orient='h')<br/>plt.xlim(.8, .9);</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi qd"><img src="../Images/83ae826acc46dc66465c1b4f8226b6f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*jZwA50wrMYhbXOVl8xsOeA.png"/></div></figure><p id="35f0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">çœ‹èµ·æ¥<code class="fe pz qa qb nc b">loss='hinge'</code>ä¼šå¸¦æ¥ç¨å¾®å¥½ä¸€ç‚¹çš„æ€§èƒ½ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æ•°å­—è¶…å‚æ•°:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="50df" class="ng me it nc b gy nh ni l nj nk">for param in ['min_df', 'max_df']:<br/>    plt.figure(figsize=(8,4))<br/>    sns.scatterplot(x=param, y="value", data=r_summary_long, <br/>                    x_jitter=True, alpha=0.5)<br/>    plt.ylim(.8, .9);</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi qe"><img src="../Images/151a67356e7dda36782f71291e607603.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*b0r-a8udnfyisq8WL4JjgA.png"/></div></figure><p id="eb82" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç”±äº<code class="fe pz qa qb nc b">min_df</code>å’Œå‡†ç¡®åº¦ä¹‹é—´ä¼¼ä¹å­˜åœ¨è´Ÿç›¸å…³å…³ç³»ï¼Œæˆ‘ä»¬å°†æŠŠ<code class="fe pz qa qb nc b">min_df</code>ä¿æŒåœ¨ 200 ä»¥ä¸‹ã€‚<code class="fe pz qa qb nc b">max_df</code>æ²¡æœ‰æ˜æ˜¾çš„è¶‹åŠ¿ï¼Œå¯èƒ½æ˜¯å› ä¸ºä¸šç»©å—<code class="fe pz qa qb nc b">min_df</code>å’Œ<code class="fe pz qa qb nc b">loss</code>çš„å½±å“æ›´å¤§ã€‚è™½ç„¶ä»–ä»¬ä¸‰ä¸ªéƒ½æ˜¯è¿™æ ·ï¼Œä½†æ˜¯å¯¹äº<code class="fe pz qa qb nc b">max_df</code>æ¥è¯´æ›´æ˜æ˜¾ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯¹è¿™äº›è¶…å‚æ•°å¦‚ä½•å½±å“æ¨¡å‹æœ‰äº†ä¸€äº›äº†è§£ï¼Œè®©æˆ‘ä»¬æ›´ç²¾ç¡®åœ°å®šä¹‰ç®¡é“(<code class="fe pz qa qb nc b">max_df=.6</code>å’Œ<code class="fe pz qa qb nc b">loss=â€™hinge'</code>)å¹¶å°è¯•ä½¿ç”¨ç½‘æ ¼æœç´¢è¿›ä¸€æ­¥è°ƒæ•´å®ƒ:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="92d1" class="ng me it nc b gy nh ni l nj nk"># Create a pipeline<br/>pipe = Pipeline([('vectoriser', TfidfVectorizer(token_pattern=r'[a-z]+', max_df=.6)),<br/>                 ('model', SGDClassifier(random_state=seed, loss='hinge'))])</span><span id="6f26" class="ng me it nc b gy nl ni l nj nk"># Prepare a grid search<br/>param_grid = {'vectoriser__min_df': [30, 90, 150],<br/>              'vectoriser__ngram_range': [(1,1), (1,2)],<br/>              'vectoriser__stop_words': [None, 'english'],<br/>              'model__fit_intercept': [True, False]}<br/>g_search = GridSearchCV(estimator=pipe, param_grid=param_grid, cv=5, n_jobs=-1)<br/>g_search.fit(X_train, y_train)</span><span id="b043" class="ng me it nc b gy nl ni l nj nk"># Save results to a dataframe<br/>g_search_results = pd.DataFrame(g_search.cv_results_).sort_values(by='rank_test_score')</span></pre><p id="b92b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ç½‘æ ¼æœç´¢ä¹Ÿéœ€è¦ä¸€äº›æ—¶é—´ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰ 24 ç§ä¸åŒçš„è¶…å‚æ•°ç»„åˆè¦å°è¯•ã€‚åƒä»¥å‰ä¸€æ ·ï¼Œè¾“å‡ºå°†ä¿å­˜åˆ°åä¸º<code class="fe pz qa qb nc b">g_search_results</code>çš„æ•°æ®å¸§ä¸­ã€‚è®©æˆ‘ä»¬å°†æ›´å¤šç›¸å…³åˆ—æå–åˆ°å¦ä¸€ä¸ªæ•°æ®æ¡†æ¶ä¸­:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="7bc5" class="ng me it nc b gy nh ni l nj nk">columns = [col for col in g_search_results.columns <br/>           if re.search(r"split|param_", col)]<br/>g_summary = g_search_results[columns+['mean_test_score']].copy()<br/>g_summary.columns = [re.sub(r'_test_score|param_', '', col) <br/>                     for col in g_summary.columns]<br/>columns = [col.split('__')[1] if '__' in col else col <br/>           for col in g_summary.columns ]<br/>g_summary.columns = columns<br/>g_summary.head()</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi qf"><img src="../Images/149961dc1f3c89edb3027ca7755e9f37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dvhEC60GwYGZsV1mcRkYHA.png"/></div></div></figure><p id="967a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä½¿ç”¨è¿™äº›ç»„åˆä¸­çš„ä»»ä½•ä¸€ç§ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥è¾¾åˆ°çº¦ 0.9 çš„äº¤å‰éªŒè¯ç²¾åº¦ã€‚å¾ˆé«˜å…´çœ‹åˆ°è¾¹é™…å¢é•¿ã€‚</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="af1a" class="ng me it nc b gy nh ni l nj nk"># Create a long dataframe<br/>g_summary_long = pd.melt(g_summary, <br/>                         id_vars=['min_df', <br/>                                  'ngram_range', <br/>                                  'stop_words', <br/>                                  'fit_intercept'], <br/>                         value_vars=['split0', <br/>                                     'split1', <br/>                                     'split2', <br/>                                     'split3', <br/>                                     'split4'])<br/>g_summary_long.replace({None: 'None'}, inplace=True)</span><span id="9704" class="ng me it nc b gy nl ni l nj nk"># Plot performance<br/>for param in ['ngram_range', 'stop_words', 'fit_intercept']:<br/>    plt.figure(figsize=(8,4))<br/>    plt.title(f'Performance by {param}')<br/>    sns.boxplot(x='value', y=param, data=g_summary_long, orient='h')<br/>    plt.xlim(.85, .95);</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi qg"><img src="../Images/e796b678dfbea21adf4bd9575e19dbbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*iduUq6zLkCb4Ud2JgsDHMQ.png"/></div></figure><p id="7d63" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ¢æˆ<code class="fe pz qa qb nc b">ngram_range=(1,2)</code>ï¼Œmodel è¡¨ç°æ›´å¥½ã€‚<code class="fe pz qa qb nc b">stop_words=None</code>ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬æ˜¯å¦æ‹Ÿåˆæˆªè·å¹¶æ²¡æœ‰å¤ªå¤§çš„å½±å“ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªè¶…å‚æ•°ä¿ç•™ä¸ºé»˜è®¤å€¼ã€‚æˆ‘è®¤ä¸ºè¿™å·²ç»è¶³å¤Ÿå¥½äº†ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥å®šä¹‰æœ€ç»ˆçš„ç®¡é“äº†ã€‚</p><h2 id="6440" class="ng me it bd mf nw nx dn mj ny nz dp mn kr oa ob mp kv oc od mr kz oe of mt og bi translated">2.4.åœ¨çœ‹ä¸è§çš„æ•°æ®ä¸Šæµ‹è¯•æœ€ç»ˆç®¡é“</h2><p id="f840" class="pw-post-body-paragraph ki kj it kk b kl mv ju kn ko mw jx kq kr mx kt ku kv my kx ky kz mz lb lc ld im bi translated">ä½¿ç”¨ç½‘æ ¼æœç´¢ä¸­çš„é¡¶éƒ¨ç»„åˆï¼Œè¿™æ˜¯æˆ‘ä»¬æœ€ç»ˆç®¡é“çš„æ ·å­:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="cbb1" class="ng me it nc b gy nh ni l nj nk">pipe = Pipeline([('vectoriser', TfidfVectorizer(token_pattern=r'[a-z]+', min_df=30, max_df=.6, ngram_range=(1,2))),<br/>                 ('model', SGDClassifier(random_state=seed, loss='hinge'))])</span><span id="acab" class="ng me it nc b gy nl ni l nj nk">pipe.fit(X_train, y_train)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi qh"><img src="../Images/3e382ebce812a60d3de7f7ab3602d275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_bN3hSFWlBmIgqe2mWNHiQ.png"/></div></div></figure><p id="b355" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">æˆ‘ä»¬çš„ç®¡é“å¾ˆå°å¾ˆç®€å•ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ƒçš„ç³»æ•°:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="1d9f" class="ng me it nc b gy nh ni l nj nk">coefs = pd.DataFrame(pipe['model'].coef_, <br/>                     columns=pipe['vectoriser'].get_feature_names())<br/>coefs = coefs.T.rename(columns={0:'coef'}).sort_values('coef')<br/>coefs</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi qi"><img src="../Images/2434aae0d16dfe2732867e3bcbf40583.png" data-original-src="https://miro.medium.com/v2/resize:fit:398/format:webp/1*q5Tc6cA47-bIjMGXdEyMVg.png"/></div></figure><p id="fc0c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å…·æœ‰æœ€é«˜æˆ–æœ€ä½ç³»æ•°çš„ç‰¹å¾çœ‹èµ·æ¥å¾ˆç›´è§‚ã€‚ä½†æ˜¯çœ‹çœ‹æˆ‘ä»¬æ‹¥æœ‰çš„ç‰¹æ€§æ•°é‡:49ï¼Œ577ï¼è¿™ä¸»è¦æ˜¯å› ä¸ºæ”¾æ¾äº†<code class="fe pz qa qb nc b">min_df</code>ï¼Œå¢åŠ äº†äºŒå…ƒæ¨¡å‹ï¼Œæ²¡æœ‰åˆ é™¤åœç”¨è¯ã€‚å¦‚æœæˆ‘ä»¬çƒ­è¡·äºå‡å°‘ç‰¹å¾çš„æ•°é‡ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜ç®¡é“ä¸­çš„è¿™äº›è¶…å‚æ•°ã€‚å¦‚æœæˆ‘ä»¬å¼€å§‹å‡å°‘ç‰¹å¾ï¼Œæˆ‘ä»¬ä¼šæ³¨æ„åˆ°ç‰¹å¾æ•°é‡å’Œæ¨¡å‹ç²¾åº¦ä¹‹é—´çš„æƒè¡¡ã€‚æœ€ä½³å¹³è¡¡æ˜¯ä»€ä¹ˆæ ·çš„å–å†³äºå…·ä½“æƒ…å†µã€‚è®©æˆ‘ä»¬æ¥è¯„ä¼°ç®¡é“:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="32c3" class="ng me it nc b gy nh ni l nj nk">train_pred = pipe.predict(X_train)<br/>print(classification_report(train_pred, <br/>                            y_train, <br/>                            target_names=target_names))</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi qg"><img src="../Images/99fe7fd7a1bf19a45c2ffbbbd1ba4518.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*28_I5B0S8xn44tppJpTgiA.png"/></div></figure><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="ca8d" class="ng me it nc b gy nh ni l nj nk">test_pred = pipe.predict(X_test)<br/>print(classification_report(test_pred, <br/>                            y_test, <br/>                            target_names=target_names))</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi qd"><img src="../Images/58f324f37df2290d1c30f81f3033cb94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*5V6FegW-sQWlnfQahVWCmQ.png"/></div></figure><p id="c814" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡åˆ†åˆ«çº¦ä¸º 0.94 å’Œ 0.92ã€‚è¿™ä¸¤ç§è§‚ç‚¹çš„ç²¾ç¡®åº¦å’Œå¬å›ç‡çœ‹èµ·æ¥éå¸¸ç›¸ä¼¼ã€‚æˆ‘ä»¬æœ‰ç¨å¾®å¤šä¸€ç‚¹çš„å‡é˜´æ€§ã€‚è®©æˆ‘ä»¬ç»˜åˆ¶æ··æ·†çŸ©é˜µ:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="9f21" class="ng me it nc b gy nh ni l nj nk">plot_cm(test_pred, y_test, target_names=target_names)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi qj"><img src="../Images/8ff0c63a8faa0796066ea8781de9ab35.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*tfaQt2CpcSXv8TuDLVw7Bg.png"/></div></figure><p id="e713" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">çœ‹èµ·æ¥ä¸é”™ã€‚è¿™ä¹ˆğŸŠç°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå°†å¤§çº¦ 90%çš„è¯„è®ºå½’ç±»ä¸ºæ­£ç¡®è§‚ç‚¹çš„ç®¡é“ã€‚è®©æˆ‘ä»¬çœ‹çœ‹åšä¸€æ¬¡é¢„æµ‹éœ€è¦å¤šé•¿æ—¶é—´ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ Jupyter ç¬”è®°æœ¬çš„é­”æ³•å‘½ä»¤<code class="fe pz qa qb nc b">%timeit</code>:</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="f2e8" class="ng me it nc b gy nh ni l nj nk">for i in range(10):<br/>    lead = X_test.sample(1)<br/>    %timeit pipe.predict(lead)</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi qk"><img src="../Images/9941c7acdf6954a9c868040226d8c62f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bbdOeHuBnRGZ5rPXIeZ6AQ.png"/></div></div></figure><p id="8fc6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å°½ç®¡<code class="fe pz qa qb nc b">%timeit</code>è¿è¡Œäº†å¤šä¸ªå¾ªç¯ï¼Œå¹¶ç»™å‡ºäº†è¿è¡Œæ—¶é—´çš„å‡å€¼å’Œæ ‡å‡†å·®ï¼Œä½†æˆ‘æ³¨æ„åˆ°æˆ‘æ¯æ¬¡å¾—åˆ°çš„è¾“å‡ºéƒ½ç•¥æœ‰ä¸åŒã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ­£åœ¨æŸ¥çœ‹<code class="fe pz qa qb nc b">%timeit</code>çš„ 10 ä¸ªå¾ªç¯ä»¥è§‚å¯ŸèŒƒå›´ã€‚</p><p id="2a1f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å•æ¬¡é¢„æµ‹å¤§çº¦éœ€è¦ 1.5 åˆ° 4 æ¯«ç§’ã€‚è¿™éœ€è¦åœ¨ç”¨ä¾‹çš„ç”Ÿäº§ç¯å¢ƒçš„ä¸Šä¸‹æ–‡ä¸­è¿›è¡Œè¯„ä¼°ã€‚</p><p id="24a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å¥½äº†ï¼Œè¿™å°±æ˜¯è¿™ç¯‡æ–‡ç« çš„å†…å®¹ã€‚ğŸ’«</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ql"><img src="../Images/c71d93a750d94bf7ee21bbafa3142f9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cjnWuJ-_PYrTZ6HX"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">ç…§ç‰‡ç”±<a class="ae le" href="https://unsplash.com/@countchris?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">ä¼¯çˆµå…‹é‡Œæ–¯</a>åœ¨<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šæ‹æ‘„</p></figure><p id="e618" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="na">æ‚¨æƒ³è®¿é—®æ›´å¤šè¿™æ ·çš„å†…å®¹å—ï¼Ÿåª’ä½“ä¼šå‘˜å¯ä»¥æ— é™åˆ¶åœ°è®¿é—®åª’ä½“ä¸Šçš„ä»»ä½•æ–‡ç« ã€‚å¦‚æœæ‚¨ä½¿ç”¨</em> <a class="ae le" href="https://zluvsand.medium.com/membership" rel="noopener"> <em class="na">æˆ‘çš„æ¨èé“¾æ¥</em> </a>ï¼Œ<em class="na">æˆä¸ºä¼šå‘˜ï¼Œæ‚¨çš„ä¸€éƒ¨åˆ†ä¼šè´¹å°†ç›´æ¥ç”¨äºæ”¯æŒæˆ‘ã€‚</em></p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="25cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">è°¢è°¢ä½ çœ‹æˆ‘çš„å¸–å­ã€‚å¸Œæœ›æ‚¨å·²ç»å­¦ä¼šäº†ä¸€äº›ä¸åŒçš„å®ç”¨æ–¹æ³•ï¼Œå¯ä»¥åœ¨æ„å»ºæˆ–ä¸æ„å»ºå®šåˆ¶æ¨¡å‹çš„æƒ…å†µä¸‹å°†æ–‡æœ¬åˆ†ç±»ä¸ºæƒ…æ„Ÿã€‚ä»¥ä¸‹æ˜¯æœ¬ç³»åˆ—å…¶ä»–ä¸¤ç¯‡æ–‡ç« çš„é“¾æ¥:<em class="na"><br/></em>â—¼ï¸<a class="ae le" rel="noopener" target="_blank" href="/exploratory-text-analysis-in-python-8cf42b758d9e">python ä¸­çš„æ¢ç´¢æ€§æ–‡æœ¬åˆ†æ</a><br/>â—¼ï¸<a class="ae le" rel="noopener" target="_blank" href="/preprocessing-text-in-python-923828c4114f">python ä¸­çš„æ–‡æœ¬é¢„å¤„ç†</a></p><p id="6643" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ä»¥ä¸‹æ˜¯æˆ‘çš„å…¶ä»– NLP ç›¸å…³å¸–å­çš„é“¾æ¥:<br/>â—¼ï¸<a class="ae le" rel="noopener" target="_blank" href="/simple-wordcloud-in-python-2ae54a9f58e5">Python ä¸­çš„ç®€å• word cloud</a><br/><em class="na">(ä¸‹é¢åˆ—å‡ºäº†ä¸€ç³»åˆ—å…³äº NLP ä»‹ç»çš„å¸–å­)</em> <br/> â—¼ï¸ <a class="ae le" rel="noopener" target="_blank" href="/introduction-to-nlp-part-1-preprocessing-text-in-python-8f007d44ca96">ç¬¬ä¸€éƒ¨åˆ†:Python ä¸­çš„é¢„å¤„ç†æ–‡æœ¬</a> <br/> â—¼ï¸ <a class="ae le" href="https://medium.com/@zluvsand/introduction-to-nlp-part-2-difference-between-lemmatisation-and-stemming-3789be1c55bc" rel="noopener">ç¬¬äºŒéƒ¨åˆ†:è¯æ¡æ»¡è¶³å’Œè¯å¹²çš„åŒºåˆ«</a> <br/> â—¼ï¸ <a class="ae le" href="https://medium.com/@zluvsand/introduction-to-nlp-part-3-tf-idf-explained-cedb1fc1f7dc" rel="noopener">ç¬¬ä¸‰éƒ¨åˆ†:TF-IDF è§£é‡Š</a> <br/> â—¼ï¸ <a class="ae le" href="https://medium.com/@zluvsand/introduction-to-nlp-part-4-supervised-text-classification-model-in-python-96e9709b4267" rel="noopener">ç¬¬å››éƒ¨åˆ†:python ä¸­çš„ç›‘ç£æ–‡æœ¬åˆ†ç±»æ¨¡å‹</a><a class="ae le" href="https://medium.com/@zluvsand/introduction-to-nlp-part-4-supervised-text-classification-model-in-python-96e9709b4267" rel="noopener"/></p><p id="7874" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">å†è§ğŸƒğŸ’¨</p></div></div>    
</body>
</html>