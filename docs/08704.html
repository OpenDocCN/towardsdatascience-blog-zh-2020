<html>
<head>
<title>Behind the scenes — How does a streaming service know what we want to watch next?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">幕后——流媒体服务如何知道我们接下来想看什么？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/behind-the-scenes-how-does-a-streaming-service-know-what-we-want-to-watch-next-52d5f53731a1?source=collection_archive---------43-----------------------#2020-06-23">https://towardsdatascience.com/behind-the-scenes-how-does-a-streaming-service-know-what-we-want-to-watch-next-52d5f53731a1?source=collection_archive---------43-----------------------#2020-06-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bff4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">推荐系统综述</h2></div><p id="a4d9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">网飞公司成立于1997年，最初是一家通过邮件租赁DVD的公司，在十年内发展成为一家视频流媒体服务公司，现在已经成为我们生活中不可分割的一部分。通过后端的推荐引擎，它可以发现一个又一个值得狂欢的标题，从而确保客户粘性。事实上，主页上的“网飞流行”并不是全球流行图书的权威排名，而是基于浏览历史的相似用户中流行图书的代表。推荐系统是网飞收入的一个重要贡献者，为该平台上约80%的时间提供了动力。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/529c79a6c6ade88f6f03c8fd75b965f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oscYvlfmyKNQvX2gIbBEXQ.jpeg"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">照片由<a class="ae lu" href="/s/photos/streaming-service?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae lu" href="https://unsplash.com/@jenskreuter?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">延斯·克罗伊特</a>拍摄</p></figure><p id="4a64" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该平台分析观众如何点击、搜索、观看、播放和暂停，以生成<strong class="kk iu">隐性评分</strong>，从而对出现在主页上的标题进行个性化设置。这是一种比依赖用户的<strong class="kk iu">明确评级</strong>更具可扩展性的方法(例如——星星的数量，如按钮等)。</p><p id="b868" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了更好地识别用户的偏好，内容被分为成千上万个微观类型，具体如“备受好评的情感失败者电影”或“20世纪70年代的中国动作和冒险”然后，网飞将流派标签与用户的观看历史配对。数据点被组合以创建具有相同内容偏好的人的聚类。</p><p id="fabc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">网飞已经确定了2000多个味觉社区。一组订阅了《纸牌屋》(T8)的用户还订阅了《费城永远阳光灿烂》(T9)。那些看《黑镜》的人往往会被同样愤世嫉俗和尖锐的纪录片所吸引。</p><p id="5171" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我们将研究推荐引擎背后的算法。参考数据集是<a class="ae lu" href="https://grouplens.org/datasets/movielens/" rel="noopener ugc nofollow" target="_blank"> MovieLens 1M数据</a>。这些数据包括用户、电影和收视率数据。</p><p id="8679" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">电影数据有3883个条目，并包含以下各列:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/d24531401353deebb251798851859889.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*yljvIP9v8gWCZbi2wAzTGA.png"/></div></figure><p id="cc33" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">收视率数据有一百万个条目，每行对应一个用户电影收视率。该数据包含以下各列:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/f2fdc6ae9687509eb9f4d68091f9e115.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*a-SL_8Ym8Ygf5W_XKOcjcg.png"/></div></figure><p id="81f7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们将看一个基于内容的推荐系统。会根据以往的观看历史推荐类似的电影。电影之间的相似性可以基于几个因素来确定，例如演员、电影发行年份、导演等。在这种情况下，由于我们没有任何其他信息，相似性将根据流派进行计算。</p><p id="a8d6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了分析流派，我们将流派分成一个数组，如下所示:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/f2c6f367706fde3651cb7c233372ea13.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*pAvypE9zh_FLLKEHWjULvw.png"/></div></figure><p id="2f63" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此后，<a class="ae lu" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html" rel="noopener ugc nofollow" target="_blank"> TfidVectorizer </a>被应用于流派列，以识别每部电影的区别特征。对于每部电影来说，具有最高Tfidf分数的类型是表征该电影的类型。</p><pre class="lf lg lh li gt lz ma mb mc aw md bi"><span id="8b56" class="me mf it ma b gy mg mh l mi mj">tf = TfidfVectorizer(analyzer='word',ngram_range=(1, 2),min_df=0, stop_words='english')<br/>tfidf_matrix = tf.fit_transform(movies['genre'])<br/>tfidf_matrix.shape</span><span id="b3a7" class="me mf it ma b gy mk mh l mi mj">Output: (3883, 127)</span></pre><p id="dd75" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基于Tfidf分数，使用<a class="ae lu" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.pairwise.cosine_similarity.html" rel="noopener ugc nofollow" target="_blank">余弦</a>计算电影之间的相似度。</p><pre class="lf lg lh li gt lz ma mb mc aw md bi"><span id="dafe" class="me mf it ma b gy mg mh l mi mj">cosine_sim = cosine_similarity(tfidf_matrix)<br/>np.fill_diagonal(cosine_sim, 0 )<br/>cosine_sim.shape</span><span id="d3be" class="me mf it ma b gy mk mh l mi mj">Output: (3883, 3883)</span></pre><p id="11f6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">矩阵cosine_sim的每一行都给了我们每部电影和其他3882部电影之间的相似性得分。以下函数计算与特定标题最相似的电影。</p><pre class="lf lg lh li gt lz ma mb mc aw md bi"><span id="36a8" class="me mf it ma b gy mg mh l mi mj">titles = movies['title']<br/>indices = pd.Series(movies.index, index=movies['title'])</span><span id="8483" class="me mf it ma b gy mk mh l mi mj">def genre_recommendation(title):<br/>    idx=indices[title]<br/>    ranked = np.argsort(cosine_sim[idx])<br/>    largest_indices = ranked[::-1]<br/>    return titles.iloc[largest_indices]</span></pre><p id="1d24" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在为《玩具总动员》运行这个函数时，我们得到了前十部类似的电影:</p><pre class="lf lg lh li gt lz ma mb mc aw md bi"><span id="6ed8" class="me mf it ma b gy mg mh l mi mj">genre_recommendation("Toy Story (1995)").head(10)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/c702762edea2f5b7ca4eab90eb74822b.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*8uSpQW4FPK7cqVwTZKupTw.png"/></div></figure><p id="7e2c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，基于内容的推荐受到过于领域特定和同质的困扰。例如，如果用户过去观看过喜剧，则未来的推荐也将围绕喜剧，而不考虑用户也可能喜欢其他类型。</p><p id="68d9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，一种<strong class="kk iu">协同过滤</strong>方法被更多地使用。该方法分析用户之间的关系和产品之间的相互依赖性，以识别新的用户-项目关联。该方法中使用的两种主要技术是— <strong class="kk iu">邻域模型</strong>和<strong class="kk iu">潜在因素模型。</strong></p><p id="6b7f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lv">邻里模型</em> </strong></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mm"><img src="../Images/33ea54a5bf8cd1c76be4dbd1c5976df1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cicsshp4EKS6oAG2u1W38A.jpeg"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">在<a class="ae lu" href="/s/photos/neighbours-buying-the-same-thing?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae lu" href="https://unsplash.com/@tamtit24?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">bùI Thanh TM</a>拍摄的照片</p></figure><p id="6cb3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用户邻居是那些以类似方式评价电影的人。项目邻居是被同一用户相似地评级的电影。因此，通过找到用户的邻居，我们可以根据某个用户的邻居看过的电影，向她推荐一部未看过的电影。相反，我们会查看一部电影的最近邻居，以预测特定用户对这部电影的评价。</p><p id="74b3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我们将研究用户-用户协同过滤。首先，计算每个用户的平均等级。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/bbd9b71d46f946799526f6d53fdce538.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/1*S8H0NjkA5vatujVK93VnPA.png"/></div></figure><p id="28e1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">目标是获得一个评级矩阵，其中用户id作为行索引，电影id作为列索引，评级作为值。</p><p id="6182" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，用户通常在他们的评级中有偏见。有些人可能倾向于总是评价低，而有些人可能总是评价高。为了使数值标准化，我们将从每个个人评分中减去平均评分。</p><p id="634c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">标准化后，低评分变成负数，高评分变成正数。如果我们然后取余弦距离，我们发现对他们共同观看的电影具有相反视图的用户将具有几乎相反方向的向量，并且可以被认为尽可能远。但是，对共同评分的电影有相似意见的用户，他们之间的角度会相对较小。</p><p id="471f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">减去每个用户的平均评级后，最终评级矩阵如下:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mo"><img src="../Images/b247c57c89573a4cab1032e57da9f12e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XuAJIEdCFzpvRB4BBsDzBw.png"/></div></div></figure><p id="fa8b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Nan值仅仅是用户没有看过的电影。我们需要预测这些未看过的电影的收视率，以便能够确定用户是否愿意观看这些电影。在计算用户之间的相似性之前，我们将用行平均值填充Nan值。</p><pre class="lf lg lh li gt lz ma mb mc aw md bi"><span id="0100" class="me mf it ma b gy mg mh l mi mj">rating_final_user = rating_final.apply(lambda row:row.fillna(row.mean()), axis=1)</span></pre><p id="f00f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">评级矩阵现在看起来像这样:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mp"><img src="../Images/653b68d3233ed5877aef23776c94f43e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HunH_MhxLg1HPDOaSPtarA.png"/></div></div></figure><p id="e180" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，计算用户之间的相似性:</p><pre class="lf lg lh li gt lz ma mb mc aw md bi"><span id="5d9d" class="me mf it ma b gy mg mh l mi mj">cosine = cosine_similarity(rating_final_user)<br/>np.fill_diagonal(cosine, 0 )<br/>user_similarity = pd.DataFrame(cosine,index=rating_final_user.index)<br/>user_similarity.columns=rating_final_user.index<br/>user_similarity.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mq"><img src="../Images/aacf965ed2132cd739d7518b52892d35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ygtOeP2IqrBsG9xHfPUwtw.png"/></div></div></figure><p id="865d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">计算每个用户的前30个邻居:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mr"><img src="../Images/cd06ec9172887baa0b2eac4f4719ed85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I6WgWOftn9Mo0mSENwTz6A.png"/></div></div></figure><p id="54fc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们通过以下步骤预测特定用户对电影的评价:</p><p id="205a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">I)我们找到我们想要预测其评级的用户的前30个邻居。</p><p id="5f42" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">ii)接下来，我们找到这些邻居对所讨论的电影给出的评级值。没有对该特定电影进行评级的邻居被忽略。</p><p id="00d8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">iii)我们现在有两个数据点——邻居用户对特定电影给出的评级以及他们相对于我们想要预测其评级的用户的相似性值。通过将评级和相似性值的总和除以相似性值来计算加权分数。</p><p id="e704" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">iv)然后将其添加到我们想要预测的用户的平均评级中，以得出最终数字。</p><p id="7ccb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">v)根据这个值，我们可以最终决定是否要向用户推荐这部电影。</p><p id="6604" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">借助下图，可以直观地理解该过程:</p><p id="ebd5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个评分矩阵显示了12个用户对6部电影的评分。列“avg”是每个用户的平均等级,“sim”是每个用户相对于用户1的相似性值。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/de7ad98996ffbae4d00cecec53b26f35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*klDYgJ8aNNUQWwAUwJa27Q.png"/></div></figure><p id="238e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="lv">从每个值中减去平均评分后，计算标准化矩阵。</em></p><p id="a49b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="lv">假设，我们想预测用户1会给电影2打多少分。</em></p><p id="bd79" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="lv">与1最相似的用户是用户10、11和2。然而，用户2没有看过电影2，因此我们可以忽略该行。因此，用户1对电影2的预测评级是用户10和11的评级的加权平均值。这种情况下的权重是相似性值。最后，我们得到用户1给出的电影2的值-1.3。这意味着用户1对电影的评价比他的平均值低1.3分。十有八九我们不应该向用户1推荐这部电影。</em></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/8d246f0e837cee3cab576491c065a0fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*Cl6tbTr0s_NnP_u9yBVhAw.png"/></div></figure><p id="6259" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过转置评级矩阵并重复这些步骤来寻找相似的项目而不是相似的用户，可以为项目-项目协同过滤重复该过程。</p><p id="54b7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通常用户数量远远超过任何平台上的项目数量。因此，项目-项目协同过滤给了我们一个更好的结果，因为它更容易分组相似的项目，而不是相似的用户。</p><p id="259b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lv">潜在因素模型</em> </strong></p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mt"><img src="../Images/bb82adf75d1f83a1a1c5a38395dfc4cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mGcTU6VZkuNecklzfibcag.jpeg"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">照片由<a class="ae lu" href="https://unsplash.com/@brucemars?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">布鲁斯·马斯</a>在<a class="ae lu" href="/s/photos/person-with-headphone?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="4f32" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们有多少次在不知道自己喜欢这首歌的确切原因的情况下循环播放了这首歌？</p><p id="dc1a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">潜在因素模型试图发现那些不容易被发现的隐藏特征。他们根据这些特征来描述用户和物品的特征。</p><p id="2a09" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lv">矩阵分解</em> </strong></p><p id="14b1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是通过称为<strong class="kk iu"> <em class="lv">矩阵分解</em> </strong> <em class="lv">，</em>的方法来完成的，该方法将用户(n) x项目(m)矩阵分解成两个矩阵:用户(n) x特征(f) *特征(f) x项目(m)</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/c482c7815df76a37909d72f4c2764ead.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*r8Vir04o9qm7WG0QXZVKew.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">电影推荐的矩阵分解。资料来源:Alpaydin，2016年。</p></figure><p id="5d9f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">直观上，这意味着用户对第一矩阵中的特定电影给出的评级是该电影所具有的特征的函数。这类似于创建用户配置文件和电影配置文件。特征值被随机初始化，以通过将两个矩阵相乘来产生某个额定值。目标是在训练期间找到一个尽可能接近原始评级矩阵的值，这是通过梯度下降实现的。一旦我们有了分解的矩阵，我们就可以根据特征值将用户与电影匹配起来。例如，如果特征的数量是2，一个用户可能具有两个特征的对应值[4，3]。如果特定电影的这两个特征的值是[3.8，2.7]，我们可以断定用户和电影简档匹配。值越接近，用户对电影的评价越高，因此我们应该推荐相同的值。</p><p id="c990" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">除了寻找潜在的特征，这种方法还帮助我们将一个大矩阵转化为两个小矩阵。假设有5000个用户，1000部电影。因此，第一个矩阵将有5000 x 1000 = 500万个占位符。</p><p id="5e97" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，假设我们有20个功能，等式右侧的第一个矩阵将有5000个用户20个功能= 100k个占位符。类似地，第二个矩阵将有20个特征x 1000个电影= 20k个占位符。这一共是120k，比500万减少了一大截。</p><p id="0b40" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lv">【奇异向量分解】</em> </strong></p><p id="07ce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">矩阵分解技术发展成更复杂的SVD技术，将评级矩阵分解成3个矩阵，而不是2个。</p><p id="74d6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">给定一个m × n矩阵A，秩为k，奇异值分解SV D(A)定义为SVD(A) = U(m，k)× S(k，k) × V (k，n)。</p><p id="5719" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">*V是电影(n) x特征(k)矩阵的转置。</p><p id="3813" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">矩阵S是只有k个非零元素的对角矩阵。S的对角元(s1，s2，…，sk)具有si &gt; 0且s1 ≥ s2 ≥ … ≥ sk的性质。因此，S矩阵是一个特征矩阵，它以降序给出了特征的相对重要性。通过丢弃<strong class="kk iu"> r </strong>其他不重要的条目，可以只保留<strong class="kk iu"> k-r </strong>奇异值。还通过分别从U中移除<strong class="kk iu"> r </strong>列和从V中移除r行来缩减矩阵U和V。通过将三者相乘得到的简化矩阵是原始矩阵的良好近似。</p><p id="28cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Python通过<a class="ae lu" href="http://surpriselib.com/" rel="noopener ugc nofollow" target="_blank">惊喜包</a>方便了SVD的应用。</p><p id="2fdd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">关于这里涉及的所有主题的详细代码，请参考github <a class="ae lu" href="https://github.com/pritha21/Concepts/tree/master/Recommender_Systems" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">链接</strong> </a>。</p><p id="73af" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">协同过滤存在冷启动问题和流行偏见。网飞试图通过要求新用户列出一些初始偏好来管理冷启动问题，以便未来的推荐可以基于相同的偏好。有不同的方法来防止流行偏见，但是这超出了本文的范围。网飞在向用户推荐书目时会考虑几个参数，比如新鲜度和多样性，从而避免流行偏见。</p><p id="88be" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文旨在提供一个推荐系统如何工作的简要框架。在现实生活场景中，大量的计算和数据挖掘用于创建用户简档、电影简档，并且通常使用几种算法的组合来最终得出可以向用户推出的推荐。</p><p id="11ec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望我已经能够开始了解推荐引擎背后的直觉！一如既往，欢迎反馈！</p><h1 id="851f" class="mv mf it bd mw mx my mz na nb nc nd ne jz nf ka ng kc nh kd ni kf nj kg nk nl bi translated"><strong class="ak">参考文献:</strong></h1><div class="nm nn gp gr no np"><a href="https://www.buzzfeednews.com/article/nicolenguyen/netflix-recommendation-algorithm-explained-binge-watching" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">网飞有一个改变你放松方式的计划</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">现在是周四晚上，你在电视机前。为了省钱，你把有线电视套餐换成了10.99美元…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">www.buzzfeednews.com</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od lo np"/></div></div></a></div><div class="nm nn gp gr no np"><a href="https://www.newamerica.org/oti/reports/why-am-i-seeing-this/case-study-netflix/#:~:text=Netflix%27s%20recommendation%20system%20is%20an,targeted%20advertisements%20to%20its%20users." rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">为什么我会看到这个？</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">视频和电商平台如何利用算法驱动对用户的推荐。</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">www.newamerica.org</p></div></div><div class="ny l"><div class="oe l oa ob oc ny od lo np"/></div></div></a></div><div class="nm nn gp gr no np"><a href="https://netflixtechblog.com/netflix-recommendations-beyond-the-5-stars-part-2-d9b96aa399f5" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd iu gy z fp nu fr fs nv fu fw is bi translated">网飞推荐:超越五星(下)</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">更深入地了解我们更广泛的个性化技术。</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">netflixtechblog.com</p></div></div><div class="ny l"><div class="of l oa ob oc ny od lo np"/></div></div></a></div><p id="be08" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae lu" href="https://blogs.commons.georgetown.edu/cctp-607-spring2019/2019/05/06/music-to-my-ears-de-blackboxing-spotifys-recommendation-algorithm/" rel="noopener ugc nofollow" target="_blank">https://blogs . commons . George town . edu/cctp-607-spring 2019/2019/05/06/music-to-my-ears-de-black box-spotifys-recommendation-algorithm/</a></p><p id="909b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用于高度可扩展推荐系统的增量奇异值分解算法(Badrul Sarwar、George Karypis、Joseph Konstan和John Riedl { Sarwar、Karypis、Konstan、riedl}@cs.umn.edu Group lens Research Group/美国明尼苏达州明尼阿波利斯市明尼苏达大学计算机科学与工程系陆军HPC研究中心，邮编:55455)</p><p id="af3a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">【http://www.mmds.org/】T2(第九章)</p><p id="08c7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae lu" href="https://datajobs.com/data-science-repo/Recommender-Systems-[Netflix].pdf" rel="noopener ugc nofollow" target="_blank">推荐系统的矩阵分解技术</a></p></div></div>    
</body>
</html>