<html>
<head>
<title>Adversarial Machine Learning Mitigation: Adversarial Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对抗性机器学习缓解:对抗性学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/adversarial-machine-learning-mitigation-adversarial-learning-9ae04133c137?source=collection_archive---------30-----------------------#2020-07-17">https://towardsdatascience.com/adversarial-machine-learning-mitigation-adversarial-learning-9ae04133c137?source=collection_archive---------30-----------------------#2020-07-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bc57" class="pw-subtitle-paragraph jo ip iq bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">一种保护机器学习模型免受恶意攻击的简单方法</h2></div><p id="e4e0" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">文献中有几种针对深度学习模型的攻击，包括<strong class="ki ir">快速梯度符号法</strong>(FGSM)<strong class="ki ir"/>(BIM)或<strong class="ki ir">动量迭代法</strong> (MIM)攻击。这些攻击是攻击者用来躲避分类模型的最纯粹的基于梯度的躲避技术。</p><h2 id="40d8" class="lc ld iq bd le lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">引用代码</h2><p id="8769" class="pw-post-body-paragraph kg kh iq ki b kj lv js kl km lw jv ko kp lx kr ks kt ly kv kw kx lz kz la lb ij bi translated">如果您认为这些结果有用，请引用本文:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="1c32" class="lc ld iq mf b gy mj mk l ml mm">@PROCEEDINGS{catak-adv-ml-2020,<br/>    title = {Deep Neural Network based Malicious Network Activity Detection Under Adversarial Machine Learning Attacks},<br/>    booktitle = {Proc.\ 3rd International Conference on Intelligent Technologies and Applications (INTAP 2020)},<br/>    volume = 5805,<br/>    series = {LNCS},<!-- -->author  = {Ferhat Ozgur Catak},<br/>    publisher = {Springer},<br/>    year = {2020}<br/>    }</span></pre><h2 id="0c3f" class="lc ld iq bd le lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">介绍</h2><p id="0c1e" class="pw-post-body-paragraph kg kh iq ki b kj lv js kl km lw jv ko kp lx kr ks kt ly kv kw kx lz kz la lb ij bi translated">在这项工作中，我将提出一种新的方法来保护恶意活动检测模型免受几种敌对的机器学习攻击。因此，我们探索了应用对抗性训练来建立一个对抗 FGSM 攻击的健壮模型的能力。相应地，(1)用对立的例子增强数据集；(2)使用 KDDCUP99 数据集训练基于深度神经网络的检测模型，以学习基于 FGSM 的攻击模式。我们将这个训练模型应用于基准网络安全数据集。</p><p id="7a29" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">对抗性机器学习被用来描述对机器学习模型的攻击，它试图通过恶意输入实例误导模型。图中显示了典型的对抗性机器学习攻击。</p><figure class="ma mb mc md gt mn gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/c4c73b199f200207ef18430a0c18d035.png" data-original-src="https://miro.medium.com/v2/format:webp/1*8FhisenG1AsVv-MxRpVYZg.png"/></div></figure><p id="c373" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">典型的机器学习模型基本上包括两个阶段，即训练时间和决策时间。因此，对抗性机器学习攻击发生在训练时间或决策时间。根据攻击的时间，黑客用于对抗性机器学习的技术可以分为两种:</p><ul class=""><li id="88e9" class="mr ms iq ki b kj kk km kn kp mt kt mu kx mv lb mw mx my mz bi translated"><strong class="ki ir">数据中毒</strong>:攻击者改变训练输入实例的一些标签，误导输出模型。</li><li id="0eb4" class="mr ms iq ki b kj na km nb kp nc kt nd kx ne lb mw mx my mz bi translated"><strong class="ki ir">模型中毒</strong>:黑客在模型创建后，利用一些被扰动的实例驱动模型产生虚假标签。</li></ul><p id="0eb7" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">我们的模型能够应对黑客使用对抗性机器学习方法进行的模型攻击。该图说明了用于保护模型和正确分类的系统架构。</p><figure class="ma mb mc md gt mn gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/49492831c131bd2ef33e3f0efcb04f46.png" data-original-src="https://miro.medium.com/v2/format:webp/1*HIwGtjcE2VpdFF8Xw3XZFA.png"/></div></figure><h2 id="0240" class="lc ld iq bd le lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">让我们编码吧</h2><p id="c247" class="pw-post-body-paragraph kg kh iq ki b kj lv js kl km lw jv ko kp lx kr ks kt ly kv kw kx lz kz la lb ij bi translated">我们导入通常的标准库加上一个 cleverhans 库，对深度学习模型进行对抗性攻击。</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="5c7c" class="lc ld iq mf b gy mj mk l ml mm">from sklearn.datasets import fetch_kddcup99<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.metrics import confusion_matrix<br/>from sklearn import preprocessing<br/>import tensorflow as tf<br/>import pandas as pd<br/>import numpy as np<br/>from keras.utils import np_utils<br/>from cleverhans.future.tf2.attacks import fast_gradient_method, \<br/>    basic_iterative_method, momentum_iterative_method<br/><br/>np.random.seed(10)</span></pre><p id="a755" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">在这项工作中，我们将使用标准的 KDDCUP'99 入侵检测数据集来显示结果。我们需要从数据集中提取数字特征。我创建了一个新方法来加载和提取 KDD cup’99 数据集。</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="b778" class="lc ld iq mf b gy mj mk l ml mm">COL_NAME = ['duration', 'protocol_type', 'service', 'flag', 'src_bytes',<br/>            'dst_bytes', 'land', 'wrong_fragment', 'urgent', 'hot',<br/>            'num_failed_logins', 'logged_in', 'num_compromised', 'root_shell',<br/>            'su_attempted', 'num_root', 'num_file_creations', 'num_shells',<br/>            'num_access_files', 'num_outbound_cmds', 'is_host_login',<br/>            'is_guest_login', 'count', 'srv_count', 'serror_rate',<br/>            'srv_serror_rate', 'rerror_rate', 'srv_rerror_rate',<br/>            'same_srv_rate', 'diff_srv_rate', 'srv_diff_host_rate',<br/>            'dst_host_count', 'dst_host_srv_count', 'dst_host_same_srv_rate',<br/>            'dst_host_diff_srv_rate', 'dst_host_same_src_port_rate',<br/>            'dst_host_srv_diff_host_rate', 'dst_host_serror_rate',<br/>            'dst_host_srv_serror_rate', 'dst_host_rerror_rate', 'dst_host_srv_rerror_rate']<br/><br/>NUMERIC_COLS = ['duration', 'src_bytes', 'dst_bytes', 'wrong_fragment',<br/>                'urgent', 'hot', 'num_failed_logins', 'num_compromised',<br/>                'root_shell', 'su_attempted', 'num_root', 'num_file_creations',<br/>                'num_shells', 'num_access_files', 'num_outbound_cmds', 'count',<br/>                'srv_count', 'serror_rate', 'srv_serror_rate', 'rerror_rate',<br/>                'srv_rerror_rate', 'same_srv_rate', 'diff_srv_rate',<br/>                'srv_diff_host_rate', 'dst_host_count', 'dst_host_srv_count',<br/>                'dst_host_same_srv_rate', 'dst_host_diff_srv_rate',<br/>                'dst_host_same_src_port_rate', 'dst_host_srv_diff_host_rate',<br/>                'dst_host_serror_rate', 'dst_host_srv_serror_rate',<br/>                'dst_host_rerror_rate', 'dst_host_srv_rerror_rate']<br/><br/>def get_ds():<br/>    """ get_ds: Get the numeric values of the KDDCUP'99 dataset. """<br/>    x_kddcup, y_kddcup = fetch_kddcup99(return_X_y=True, shuffle=False)<br/>    df_kddcup = pd.DataFrame(x_kddcup, columns=COL_NAME)<br/>    df_kddcup['label'] = y_kddcup<br/>    df_kddcup.drop_duplicates(keep='first', inplace=True)<br/>    df_kddcup['label'] = df_kddcup['label'].apply(lambda d: \<br/>                                    str(d).replace('.', '').replace("b'", "").\<br/>                                        replace("'", ""))<br/><br/>    conversion_dict = {'back':'dos', 'buffer_overflow':'u2r', 'ftp_write':'r2l',<br/>                       'guess_passwd':'r2l', 'imap':'r2l', 'ipsweep':'probe',<br/>                       'land':'dos', 'loadmodule':'u2r', 'multihop':'r2l',<br/>                       'neptune':'dos', 'nmap':'probe', 'perl':'u2r', 'phf':'r2l',<br/>                       'pod':'dos', 'portsweep':'probe', 'rootkit':'u2r',<br/>                       'satan':'probe', 'smurf':'dos', 'spy':'r2l', 'teardrop':'dos',<br/>                       'warezclient':'r2l', 'warezmaster':'r2l'}<br/>    df_kddcup['label'] = df_kddcup['label'].replace(conversion_dict)<br/>    df_kddcup = df_kddcup.query("label != 'u2r'")<br/>    df_y = pd.DataFrame(df_kddcup.label, columns=["label"], dtype="category")<br/>    df_kddcup.drop(["label"], inplace=True, axis=1)<br/>    x_kddcup = df_kddcup[NUMERIC_COLS].values<br/>    x_kddcup = preprocessing.scale(x_kddcup)<br/>    y_kddcup = df_y.label.cat.codes.to_numpy()<br/>    return x_kddcup, y_kddcup</span></pre><p id="ca24" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">基于张量流的分类模型然后作为练习给出如下:</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="be8e" class="lc ld iq mf b gy mj mk l ml mm">def create_tf_model(input_size, num_of_class):<br/>    """ This method creates the tensorflow classification model """<br/>    model_kddcup = tf.keras.Sequential([<br/>        tf.keras.layers.Dense(200, input_dim=input_size, activation=tf.nn.relu),<br/>        tf.keras.layers.Dense(500, activation=tf.nn.relu),<br/>        tf.keras.layers.Dense(200, activation=tf.nn.relu),<br/>        tf.keras.layers.Dense(num_of_class),<br/>        # We seperate the activation layer to be able to access<br/>        # the logits of the previous layer later<br/>        tf.keras.layers.Activation(tf.nn.softmax)<br/>        ])<br/>    model_kddcup.compile(loss='categorical_crossentropy',<br/>                         optimizer='adam',<br/>                         metrics=['accuracy'])<br/>    return model_kddcup</span></pre><p id="edba" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">下一步是使用 CleverHans 库创建对抗性的机器学习攻击。我对 Tensorflow 库使用了<strong class="ki ir">快速梯度符号法</strong>(FGSM)<strong class="ki ir">基本迭代法</strong> (BIM)或<strong class="ki ir">动量迭代法</strong> (MIM)攻击。我为每次攻击创造了 3 种方法。</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="143d" class="lc ld iq mf b gy mj mk l ml mm">def gen_tf2_fgsm_attack(org_model, x_test):<br/>    """ This method creates adversarial examples with fgsm """<br/>    logits_model = tf.keras.Model(org_model.input, model.layers[-1].output)<br/><br/>    epsilon = 0.1<br/>    adv_fgsm_x = fast_gradient_method(logits_model,<br/>                                      x_test,<br/>                                      epsilon,<br/>                                      np.inf,<br/>                                      targeted=False)<br/>    return adv_fgsm_x<br/><br/>def gen_tf2_bim(org_model, x_test):<br/>    """ This method creates adversarial examples with bim """<br/>    logits_model = tf.keras.Model(org_model.input, model.layers[-1].output)<br/><br/>    epsilon = 0.1<br/>    adv_bim_x = basic_iterative_method(logits_model,<br/>                                       x_test,<br/>                                       epsilon,<br/>                                       0.1,<br/>                                       nb_iter=10,<br/>                                       norm=np.inf,<br/>                                       targeted=True)<br/>    return adv_bim_x<br/><br/>def gen_tf2_mim(org_model, x_test):<br/>    """ This method creates adversarial examples with mim """<br/>    logits_model = tf.keras.Model(org_model.input, model.layers[-1].output)<br/><br/>    epsilon = 0.1<br/>    adv_mim_x = momentum_iterative_method(logits_model,<br/>                                          x_test,<br/>                                          epsilon,<br/>                                          0.1,<br/>                                          nb_iter=100,<br/>                                          norm=np.inf,<br/>                                          targeted=True)<br/>    return adv_mim_x</span></pre><p id="e7dd" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">让我们继续用正常的(未被操纵的)KDDCUP'99 数据集训练攻击检测模型</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="c25e" class="lc ld iq mf b gy mj mk l ml mm">EPOCH = 50<br/>TEST_RATE = 0.2<br/>VALIDATION_RATE = 0.2<br/><br/>X, y = get_ds()<br/><br/>num_class = len(np.unique(y))<br/><br/>attack_functions = [gen_tf2_bim,<br/>                    gen_tf2_fgsm_attack,<br/>                    gen_tf2_mim]<br/><br/>model = create_tf_model(X.shape[1], num_class)<br/><br/>X_train, X_test, y_train, y_test = train_test_split(X, y, \<br/>                                                    test_size=TEST_RATE)<br/>y_train_cat = np_utils.to_categorical(y_train)<br/>y_test_cat = np_utils.to_categorical(y_test)<br/><br/>history = model.fit(X_train, y_train_cat, epochs=EPOCH,<br/>                    batch_size=50000, verbose=0,<br/>                    validation_split=VALIDATION_RATE)<br/><br/>y_pred = model.predict_classes(X_test)<br/>cm_org = confusion_matrix(y_test, y_pred)<br/>print("*"*50)<br/>print("Original confusion matrix")<br/>print(cm_org)</span><span id="7a7e" class="lc ld iq mf b gy nf mk l ml mm">C:\Users\ferhatoc\AppData\Roaming\Python\Python37\site-packages\pandas\core\frame.py:3997: SettingWithCopyWarning: <br/>A value is trying to be set on a copy of a slice from a DataFrame<br/><br/>See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy<br/>  errors=errors,<br/><br/><br/>WARNING:tensorflow:AutoGraph could not transform &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x0000025288139948&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING: AutoGraph could not transform &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x0000025288139948&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING:tensorflow:AutoGraph could not transform &lt;function Model.make_test_function.&lt;locals&gt;.test_function at 0x0000025287FF4318&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING: AutoGraph could not transform &lt;function Model.make_test_function.&lt;locals&gt;.test_function at 0x0000025287FF4318&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING:tensorflow:From &lt;ipython-input-7-6c756bab0648&gt;:24: Sequential.predict_classes (from tensorflow.python.keras.engine.sequential) is deprecated and will be removed after 2021-01-01.<br/>Instructions for updating:<br/>Please use instead:* `np.argmax(model.predict(x), axis=-1)`,   if your model does multi-class classification   (e.g. if it uses a `softmax` last-layer activation).* `(model.predict(x) &gt; 0.5).astype("int32")`,   if your model does binary classification   (e.g. if it uses a `sigmoid` last-layer activation).<br/>WARNING:tensorflow:AutoGraph could not transform &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x0000025283D0E798&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING: AutoGraph could not transform &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x0000025283D0E798&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>**************************************************<br/>Original confusion matrix<br/>[[10873    16     0     0]<br/> [   16 17528     6    18]<br/> [    7    20   403    11]<br/> [    3    23     4   179]]</span></pre><h2 id="a6fa" class="lc ld iq bd le lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">原始模型的混淆矩阵</h2><p id="6424" class="pw-post-body-paragraph kg kh iq ki b kj lv js kl km lw jv ko kp lx kr ks kt ly kv kw kx lz kz la lb ij bi translated">这里显示了原始模型的混淆矩阵。根据混淆矩阵，该模型的分类性能相当好。</p><figure class="ma mb mc md gt mn gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/cde0625662ed3d0157b75e9eb09f0b91.png" data-original-src="https://miro.medium.com/v2/format:webp/1*k1rySA8d2j0tcqvB3FkRSQ.png"/></div></figure><p id="7ff5" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">让我们继续攻击，被攻击模型的混淆矩阵和敌对训练模型的混淆矩阵</p><pre class="ma mb mc md gt me mf mg mh aw mi bi"><span id="5638" class="lc ld iq mf b gy mj mk l ml mm">for attack_function in attack_functions:<br/>        print("*"*20)<br/>        print("Attack function is ", attack_function)<br/>        <br/>        model = create_tf_model(X.shape[1], num_class)<br/>        history = model.fit(X_train, y_train_cat, epochs=EPOCH,<br/>                            batch_size=50000, verbose=0,<br/>                            validation_split=VALIDATION_RATE)<br/>        <br/>        X_adv_list = []<br/>        y_adv_list = []<br/><br/>        adv_x = attack_function(model, X_test)<br/>        y_pred = model.predict_classes(adv_x)<br/>        cm_adv = confusion_matrix(y_test, y_pred)<br/>        print("*"*20)<br/>        print("Attacked confusion matrix")<br/>        print(cm_adv)<br/><br/>        print("Adversarial training")<br/>        # define the checkpoint<br/><br/>        adv_x = attack_function(model, X_train)<br/>        adv_x_test = attack_function(model, X_test)<br/><br/>        concat_adv_x = np.concatenate([X_train, adv_x])<br/>        concat_y_train = np.concatenate([y_train_cat, y_train_cat])<br/><br/>        history = model.fit(concat_adv_x, concat_y_train, epochs=EPOCH,<br/>                            batch_size=50000, verbose=0,<br/>                            validation_data=(adv_x_test, y_test_cat))<br/><br/>        y_pred = model.predict_classes(adv_x_test)<br/>        cm_adv = confusion_matrix(y_test, y_pred)<br/>        print("*"*20)<br/>        print("Attacked confusion matrix - adv training")<br/>        print(cm_adv)</span><span id="aa53" class="lc ld iq mf b gy nf mk l ml mm">********************<br/>Attack function is  &lt;function gen_tf2_bim at 0x00000252FCF84A68&gt;<br/>WARNING:tensorflow:AutoGraph could not transform &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x00000252FD05FDC8&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING: AutoGraph could not transform &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x00000252FD05FDC8&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING:tensorflow:AutoGraph could not transform &lt;function Model.make_test_function.&lt;locals&gt;.test_function at 0x00000252877B80D8&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING: AutoGraph could not transform &lt;function Model.make_test_function.&lt;locals&gt;.test_function at 0x00000252877B80D8&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING:tensorflow:AutoGraph could not transform &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x0000025281E8B168&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING: AutoGraph could not transform &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x0000025281E8B168&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>********************<br/>Attacked confusion matrix<br/>[[10874    15     0     0]<br/> [   14 17532     7    15]<br/> [    6    19   404    12]<br/> [    3    23     5   178]]<br/>Adversarial training<br/>********************<br/>Attacked confusion matrix - adv training<br/>[[10877    12     0     0]<br/> [   12 17535     6    15]<br/> [    1    13   425     2]<br/> [    0    22     3   184]]<br/>********************<br/>Attack function is  &lt;function gen_tf2_fgsm_attack at 0x00000252FCF84B88&gt;<br/>WARNING:tensorflow:AutoGraph could not transform &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x0000025281E8B438&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING: AutoGraph could not transform &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x0000025281E8B438&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING:tensorflow:AutoGraph could not transform &lt;function Model.make_test_function.&lt;locals&gt;.test_function at 0x0000025288BB38B8&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING: AutoGraph could not transform &lt;function Model.make_test_function.&lt;locals&gt;.test_function at 0x0000025288BB38B8&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING:tensorflow:AutoGraph could not transform &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x0000025287EF2558&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING: AutoGraph could not transform &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x0000025287EF2558&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>********************<br/>Attacked confusion matrix<br/>[[10702   180     6     1]<br/> [   79 17353    31   105]<br/> [    9    47   376     9]<br/> [    3    88     8   110]]<br/>Adversarial training<br/>********************<br/>Attacked confusion matrix - adv training<br/>[[10877    11     0     1]<br/> [    9 17543     4    12]<br/> [    1    15   422     3]<br/> [    2    25     2   180]]<br/>********************<br/>Attack function is  &lt;function gen_tf2_mim at 0x00000252FCF84D38&gt;<br/>WARNING:tensorflow:AutoGraph could not transform &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x00000252875459D8&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING: AutoGraph could not transform &lt;function Model.make_train_function.&lt;locals&gt;.train_function at 0x00000252875459D8&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING:tensorflow:AutoGraph could not transform &lt;function Model.make_test_function.&lt;locals&gt;.test_function at 0x00000252F9990048&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING: AutoGraph could not transform &lt;function Model.make_test_function.&lt;locals&gt;.test_function at 0x00000252F9990048&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING:tensorflow:5 out of the last 14 calls to &lt;function compute_gradient at 0x00000252FCF6A318&gt; triggered tf.function retracing. Tracing is expensive and the excessive number of tracings is likely due to passing python objects instead of tensors. Also, tf.function has experimental_relax_shapes=True option that relaxes argument shapes that can avoid unnecessary retracing. Please refer to https://www.tensorflow.org/tutorials/customization/performance#python_or_tensor_args and https://www.tensorflow.org/api_docs/python/tf/function for more details.<br/>WARNING:tensorflow:AutoGraph could not transform &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x0000025280355A68&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>WARNING: AutoGraph could not transform &lt;function Model.make_predict_function.&lt;locals&gt;.predict_function at 0x0000025280355A68&gt; and will run it as-is.<br/>Please report this to the TensorFlow team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output.<br/>Cause: Bad argument number for Name: 4, expecting 3<br/>To silence this warning, decorate the function with @tf.autograph.experimental.do_not_convert<br/>********************<br/>Attacked confusion matrix<br/>[[10874    15     0     0]<br/> [   16 17530     5    17]<br/> [    6    24   400    11]<br/> [    3    23     5   178]]<br/>Adversarial training<br/>********************<br/>Attacked confusion matrix - adv training<br/>[[10878    11     0     0]<br/> [   12 17537     4    15]<br/> [    1    16   420     4]<br/> [    0    21     2   186]]</span></pre><h2 id="f824" class="lc ld iq bd le lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">对抗性训练结果</h2><h2 id="33f3" class="lc ld iq bd le lf lg dn lh li lj dp lk kp ll lm ln kt lo lp lq kx lr ls lt lu bi translated">基本迭代法(BIM)</h2><p id="60e2" class="pw-post-body-paragraph kg kh iq ki b kj lv js kl km lw jv ko kp lx kr ks kt ly kv kw kx lz kz la lb ij bi translated">被攻击模型的混淆矩阵</p><figure class="ma mb mc md gt mn gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/1aa43f1807b02d1dba1290960545f233.png" data-original-src="https://miro.medium.com/v2/format:webp/1*oYAUGCdCN9GHfk8qa-Tj6g.png"/></div></figure><p id="6416" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">对抗训练模型的混淆矩阵</p><figure class="ma mb mc md gt mn gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/50253d96d572814dda40484ecdde5647.png" data-original-src="https://miro.medium.com/v2/format:webp/1*lP4mjV6j3X0_dmKlblSWxg.png"/></div></figure><p id="6541" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">快速梯度符号法</strong></p><p id="924b" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">被攻击模型的混淆矩阵</p><figure class="ma mb mc md gt mn gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/78c57e014886090cd53271ed032c5006.png" data-original-src="https://miro.medium.com/v2/format:webp/1*dp5kXJt2ZGSooUsikLe9Yg.png"/></div></figure><p id="d213" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">对抗训练模型的混淆矩阵</p><figure class="ma mb mc md gt mn gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/aa96fe0dfee28fb85585501e3e07df7a.png" data-original-src="https://miro.medium.com/v2/format:webp/1*thGa_uUhh9BqssL7PvsnLQ.png"/></div></figure><p id="0adc" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated"><strong class="ki ir">动量迭代法</strong></p><p id="d46d" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">被攻击模型的混淆矩阵</p><figure class="ma mb mc md gt mn gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/688931677830ddb34ca8c4830532d4ad.png" data-original-src="https://miro.medium.com/v2/format:webp/1*xiK7DFKQMKBKF448zP8iXQ.png"/></div></figure><p id="fc7d" class="pw-post-body-paragraph kg kh iq ki b kj kk js kl km kn jv ko kp kq kr ks kt ku kv kw kx ky kz la lb ij bi translated">对抗训练模型的混淆矩阵</p><figure class="ma mb mc md gt mn gh gi paragraph-image"><div class="ab gu cl mo"><img src="../Images/f2b41db854002034851418f1023034d7.png" data-original-src="https://miro.medium.com/v2/format:webp/1*q0c3U8YEt-CzUeN5fIMRig.png"/></div></figure></div></div>    
</body>
</html>