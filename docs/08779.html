<html>
<head>
<title>Analyzing Microbiome Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分析微生物组数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyzing-microbiome-data-320728b56b8e?source=collection_archive---------52-----------------------#2020-06-24">https://towardsdatascience.com/analyzing-microbiome-data-320728b56b8e?source=collection_archive---------52-----------------------#2020-06-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/3cbba5e878800456969ea686d447c38d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*c74j3M2P5y-N0iH_"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来源:<a class="ae jg" href="https://wallpapercave.com/dna-background" rel="noopener ugc nofollow" target="_blank"> DNA 壁纸洞穴</a></p></figure><div class=""/><div class=""><h2 id="ae07" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">第 1 部分—基因组数据科学系列</h2></div><p id="8bf7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本文是将机器学习应用于生物信息学数据的系列教程的一部分:</p><p id="7d02" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">第 1 部分—数据采集和预处理</p><p id="d869" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/visualizing-high-dimensional-microbiome-data-eacf02526c3a">第二部分——可视化高维数据</a></p><p id="2254" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了跟进，你可以下载我们的<a class="ae jg" href="https://github.com/njparker1993/Microbiome_Machine_Learning/blob/master/Microbiome_Data_Acquisition.ipynb" rel="noopener ugc nofollow" target="_blank"> Jupyter 笔记本</a>，或者继续阅读并输入下面的代码。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="f1a0" class="mb mc jj bd md me mf mg mh mi mj mk ml kp mm kq mn ks mo kt mp kv mq kw mr ms bi translated">介绍</h1><p id="6faa" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">我们许多人大部分时间都在室内度过，但很少有人意识到我们接触的每一个表面都是寄居在这些空间的特殊有机体的家园——门把手、厨房柜台、桌子、椅子、浴室、冰箱等。当我们想到不同的生态系统，如沙漠、雨林、草原或珊瑚礁时，我们知道不同的生物群落专门生活在世界上的这些地区。同样，我们可以推断不同组成或不同类群的微生物和真菌可能专门生活在我们周围的不同位置或表面。我们称这些特殊的微生物群落为<a class="ae jg" href="https://en.wikipedia.org/wiki/Microbiota" rel="noopener ugc nofollow" target="_blank"> <em class="my">微生物群</em> </a>。</p><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/bac5a31e934ee1a5cd17e6f9c8ef3840.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*IM2a3GfyNLfDB4xC.jpg"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来源:<a class="ae jg" href="https://www.geograph.org.uk/photo/2815842" rel="noopener ugc nofollow" target="_blank">2012 年隐形世界展览，地理</a></p></figure><p id="9c70" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们只知道这些生物群落之间的基因差异会怎么样？我们也许可以逆向工程这些生物体的来源？在接下来的系列教程中，我们将向您展示我们如何从简单表面拭子的基因序列数据出发，在事先不知道拭子来源位置的情况下，使用一些数据科学检测工作，找出如何区分这些拭子的来源位置。</p><p id="3e8c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了研究微生物组之间的遗传差异，我们能够使用<a class="ae jg" href="https://qiita.ucsd.edu/static/doc/html/index.html" rel="noopener ugc nofollow" target="_blank"> <em class="my"> Qiita </em> </a>找到一个数据集。</p><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ne"><img src="../Images/f23e75f239438f828069bc02104de9df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*It0HUUu6lD7_vnha"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来源:<a class="ae jg" href="https://qiita.ucsd.edu/" rel="noopener ugc nofollow" target="_blank">qi ta 文档</a></p></figure><p id="69df" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Qiita(发音为“<em class="my"> cheetah </em>”)是一个多组学软件包和数据库，包含微生物生态学数据集，并提供一个良好的界面来搜索不同类型的组学数据，从论文中找到参考数据，甚至提供关于文件类型和相关元数据的信息。它基于<a class="ae jg" href="https://en.wikipedia.org/wiki/QIIME" rel="noopener ugc nofollow" target="_blank"><em class="my">qime</em></a>生物信息学管道，将原始测序数据转换和处理为有利于数据分析的通用格式。其他常见的生物信息学管道有<em class="my">方法</em>、<em class="my">数据 2 </em>、<em class="my">使用原型</em>等。不同管道的比较，<a class="ae jg" href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0227434" rel="noopener ugc nofollow" target="_blank">见此处</a>。</p><h1 id="bc49" class="mb mc jj bd md me nf mg mh mi ng mk ml kp nh kq mn ks ni kt mp kv nj kw mr ms bi translated">获取我们的数据</h1><p id="6cb2" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">要访问这些数据，您需要创建一个帐户，然后<a class="ae jg" href="https://qiita.ucsd.edu/study/description/10423" rel="noopener ugc nofollow" target="_blank">点击左侧的<em class="my">所有 QIIME 地图和 BIOMs </em>下载北亚利桑那大学病原体&amp;微生物研究所<a class="ae jg" href="https://caporasolab.us/" rel="noopener ugc nofollow" target="_blank"> Caporaso 实验室</a>收集的数据</a>。</p><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/6dde06e517708944e50f59cd8033ef55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bvWd8VzMoT7unwcU"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">资料来源:<a class="ae jg" href="https://qiita.ucsd.edu/study/description/10423" rel="noopener ugc nofollow" target="_blank"> Qiita，Caporaso 实验室项目</a></p></figure><p id="1304" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦完成，你需要解压文件，把它放在一个名为<em class="my"> data </em>的文件夹中，然后把数据转换成我们可以处理的格式。为此，我们首先需要安装一个名为<em class="my"> biom-format </em>的软件包，方法是在您的终端上键入:</p><pre class="na nb nc nd gt nk nl nm nn aw no bi"><span id="8aca" class="np mc jj nl b gy nq nr l ns nt">pip install biom-format</span></pre><p id="1ea8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">完成后，我们可以在终端中运行以下命令:</p><pre class="na nb nc nd gt nk nl nm nn aw no bi"><span id="4ddc" class="np mc jj nl b gy nq nr l ns nt">biom convert -i data/BIOM/60899/all.biom -o data/BIOM/60899/feature_table.tsv — to-tsv</span></pre><p id="cd00" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此命令将转换我们的。biom 文件到更熟悉的。tsv 格式，这样我们就可以进入我们的<em class="my"> Jupyter </em>笔记本，并通过以下方式读入<em class="my"> Pandas </em>数据帧:</p><figure class="na nb nc nd gt iv"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="6b1a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae jg" href="http://biom-format.org/" rel="noopener ugc nofollow" target="_blank"> BIOM 文件格式</a>常见于<em class="my">-组学</em>数据集中，用于表示<em class="my"> OTU </em>表格。OTUs 代表<a class="ae jg" href="https://en.wikipedia.org/wiki/Operational_taxonomic_unit" rel="noopener ugc nofollow" target="_blank"> <em class="my">可操作的分类单位</em> </a>，可认为是由基因组特定区域的遗传序列相似性分组的生物集群。本质上，当生物集群未知时，它们在不同的分类水平上充当“物种”的代理。该表中的观察值或行是 OTU，相应的矩阵记录了在每个样品中观察到每个 OTU 的次数。</p><p id="f704" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于最初收集这些数据的科学家最有可能在不同的表面和位置采集拭子，然后对拭子采集的微生物和真菌的 DNA 进行测序，我们不一定事先知道实际物种的组成。我们所拥有的是不同组的 DNA 串(由<em class="my"> A，T，C，Gs </em>组成)，然后我们可以通过对其运行<a class="ae jg" href="https://en.wikipedia.org/wiki/BLAST_(biotechnology)" rel="noopener ugc nofollow" target="_blank"> <em class="my"> BLAST </em> </a>局部比对搜索算法来与参考数据库进行比较。</p><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/708264d196abaf9acb6b628d09457f7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*VlrrLHzl607PzAHNKjg6oQ.jpeg"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来源:<a class="ae jg" href="https://www.ncbi.nlm.nih.gov/books/NBK62051/" rel="noopener ugc nofollow" target="_blank">爆炸词汇</a></p></figure><p id="1ef7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这样的工具可以在这里找到。在我们的例子中，这一步已经为我们完成了。</p><h1 id="88d9" class="mb mc jj bd md me nf mg mh mi ng mk ml kp nh kq mn ks ni kt mp kv nj kw mr ms bi translated">数据预处理</h1><p id="e3d7" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">幸运的是，我们的数据集已经带有相应的元数据文件，其中包含有关样本 id、测序执行位置、数据来自的实验类型、使用的测序机器、拭子收集的时间戳、地理位置等信息。我们可以通过以下操作在 pandas 中打开我们的元数据文件:</p><figure class="na nb nc nd gt iv"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/4c0219805bfa34669d65bae5bd237dc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Yv1V8V-swvz3ILxe"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来源:作者图片</p></figure><p id="fc70" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们可以创建一个助手函数，它从我们的。biom 文件，并将其转换为更容易处理的格式，我们称之为<em class="my">特征表</em>:</p><figure class="na nb nc nd gt iv"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="5120" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们可以在之前的原始表上运行上面的 helper 函数，并重命名我们的索引:</p><figure class="na nb nc nd gt iv"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="95a6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以看到，我们从一个有 1，497 行和 25，756 列的表开始。因为每一列代表一个特定的基因序列或 OTU(对应于我们的特征或维度)，所以我们可以看到我们正在处理难以置信的高维数据。这在处理宏基因组数据集时很常见，并提出了传统数据科学技术可能无法应对的新挑战。</p><p id="70c2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了帮助我们处理这种高维度，我们使用我们的助手函数将每个最初标记有基因序列的列重命名为相应的整数，这样我们就没有真正长的基因序列字符串作为列名。这些列中的每一列包含每行的特定 OTU 的频率或计数。每一行代表一个样本 id，其可以识别例如特定的拭子。</p><p id="919d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从这里，我们可以经历一些用于清理生物信息学数据的常见实践。通过确保每个序列有 20，000 个以上的相关读数，并且在至少 3 个不同的样本中出现过(本质上，应用一系列阈值)，我们可以对数据进行子集化，这样我们现在有 301 行和 1，894 列。</p><p id="655a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，这一步还有很多可以改进的地方，许多科学论文都是关于这一点的。我们正从快速和肮脏的角度来处理这个问题。</p><figure class="na nb nc nd gt iv"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ny"><img src="../Images/4d27bcd51c707a3e3edf5d7d65bd783a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VgRfaUm3mCjmAMA9"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来源:作者图片</p></figure><p id="b675" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为我们应用了阈值来减少我们的要素表，所以我们也将从元数据表中删除那些对应的条目:</p><figure class="na nb nc nd gt iv"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="b5fd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">从这里，我们现在可以使用我们的元数据来仔细检查，看看我们有来自 3 个不同城市的样本:</p><figure class="na nb nc nd gt iv"><div class="bz fp l di"><div class="nu nv l"/></div></figure><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/6a0275883f740aea8f8d0526042a3331.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*e5MIaHczG4_ft6eJ"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来源:作者图片</p></figure><h1 id="115e" class="mb mc jj bd md me nf mg mh mi ng mk ml kp nh kq mn ks ni kt mp kv nj kw mr ms bi translated">后续步骤…</h1><p id="f8b3" class="pw-post-body-paragraph ky kz jj la b lb mt kk ld le mu kn lg lh mv lj lk ll mw ln lo lp mx lr ls lt im bi translated">我们已经完成了解释微生物组宏基因组数据的性质的步骤，如何获得它，如何加载它，以及如何预处理它并将其转换成我们现在可以进行分析的格式。在<a class="ae jg" href="https://medium.com/@njparker_8716/visualizing-high-dimensional-microbiome-data-eacf02526c3a" rel="noopener">我们的下一篇文章</a>中，我们将向您展示如何应用各种机器学习算法和降维技术来帮助可视化和解释高维数据，以便我们可以从数据中推断出潜在的地理结构，而不必求助于通过元数据提供的标签。</p><p id="878a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">参见:<a class="ae jg" rel="noopener" target="_blank" href="/visualizing-high-dimensional-microbiome-data-eacf02526c3a">第二部分——可视化高维数据</a></p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="a972" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">本教程系列的两位合著者是<a class="oa ob ep" href="https://medium.com/u/76a19323c6b6?source=post_page-----320728b56b8e--------------------------------" rel="noopener" target="_blank">尼古拉斯·帕克</a> &amp; <a class="oa ob ep" href="https://medium.com/u/65f1193d859e?source=post_page-----320728b56b8e--------------------------------" rel="noopener" target="_blank">蒙迪·雷默</a>，他们都是旧金山大学数据科学硕士项目<a class="ae jg" href="https://www.usfca.edu/arts-sciences/graduate-programs/data-science" rel="noopener ugc nofollow" target="_blank">的毕业生。</a></p><p id="b645" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果您想联系我们，请联系我们:</p><p id="0189" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">蒙迪·雷默<br/> </strong> <a class="ae jg" href="https://www.linkedin.com/in/mundyreimer" rel="noopener ugc nofollow" target="_blank">领英</a> <br/> <a class="ae jg" href="https://twitter.com/MondayRhymer" rel="noopener ugc nofollow" target="_blank">推特</a> <br/> <a class="ae jg" href="https://mundyreimer.github.io/" rel="noopener ugc nofollow" target="_blank">个人博客</a></p><p id="1a1d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">尼克·帕克<br/></strong><a class="ae jg" href="https://www.linkedin.com/in/nicholas-j-parker" rel="noopener ugc nofollow" target="_blank">Linkedin</a><br/><a class="ae jg" href="https://medium.com/@njparker_8716" rel="noopener">个人博客</a></p></div></div>    
</body>
</html>