# TensorFlow 2.x çš„æ¼”å‘˜å…¼è¯„è®ºå®¶[ç¬¬ 1 éƒ¨åˆ†ï¼Œå…± 2 éƒ¨åˆ†]

> åŸæ–‡ï¼š<https://towardsdatascience.com/actor-critic-with-tensorflow-2-x-part-1-of-2-d1e26a54ce97?source=collection_archive---------12----------------------->

## ä½¿ç”¨ Tensorflow 2.x ä»¥ä¸åŒæ–¹å¼å®ç°å‚ä¸è€…-æ‰¹è¯„å®¶æ–¹æ³•

![](img/941d8a1c645693ca0fdc35a9862d9c2f.png)

æˆ´ç»´Â·ç»´å…‹æ–¯åˆ—å°”åœ¨ [Unsplash](https://unsplash.com/s/photos/reinforcement-learning?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šçš„ç…§ç‰‡

åœ¨è¿™ä¸€ç³»åˆ—æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è¯•å›¾ç†è§£æ¼”å‘˜-è¯„è®ºå®¶æ–¹æ³•ï¼Œå¹¶ä»¥ 3 ç§æ–¹å¼å®ç°å®ƒï¼Œå³å¤©çœŸçš„ ACï¼Œæ²¡æœ‰å¤šä¸ªå·¥äººçš„ A2Cï¼Œå’Œæœ‰å¤šä¸ªå·¥äººçš„ A2Cã€‚

è¿™æ˜¯ç³»åˆ—çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ TensorFlow 2.2 å®ç°å¤©çœŸçš„æ¼”å‘˜è¯„è®ºå®¶ã€‚æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹æ¼”å‘˜-è¯„è®ºå®¶æ³•æ˜¯ä»€ä¹ˆï¼Œæ˜¯å¦‚ä½•è¿ä½œçš„ï¼Ÿäº†è§£åŠ å¼ºæ”¿ç­–æ¢¯åº¦æ–¹æ³•å°†æ˜¯æœ‰ç›Šçš„ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å®ƒ[ã€‚](/reinforce-policy-gradient-with-tensorflow2-x-be1dea695f24)

## æ¦‚è¿°:

å¦‚æœä½ è¯»è¿‡åŠ å¼ºæ”¿ç­–æ¢¯åº¦æ³•ï¼Œä½ å°±ä¼šçŸ¥é“å®ƒçš„æ›´æ–°è§„åˆ™æ˜¯

![](img/0da8448049e044d579747dd7065be3b1.png)

æ›´æ–°åŠ å›ºè§„åˆ™

åœ¨æ¼”å‘˜-è¯„è®ºå®¶æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬ä»æŠ˜æ‰£å¥–åŠ±ä¸­å‡å»åŸºçº¿ã€‚è¿™äº›æ–¹æ³•çš„å¸¸ç”¨åŸºçº¿æ˜¯çŠ¶æ€å€¼å‡½æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬çš„æ¼”å‘˜-è¯„è®ºå®¶æ›´æ–°è§„åˆ™å°†å¦‚ä¸‹æ‰€ç¤ºã€‚

![](img/844694445f700cbf6ae32dd5ce1c7991.png)![](img/82826aeb18becc177d79f4d89a326aab.png)

æ¼”å‘˜-è¯„è®ºå®¶æ›´æ–°è§„åˆ™

åœ¨æ¼”å‘˜-è¯„è®ºå®¶æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªç¥ç»ç½‘ç»œï¼Œå³æ¼”å‘˜å’Œè¯„è®ºå®¶ã€‚actor ç”¨äºåŠ¨ä½œé€‰æ‹©ï¼ŒCritic ç”¨äºè®¡ç®—çŠ¶æ€å€¼ã€‚å¦‚æœæ‚¨æŸ¥çœ‹æ›´æ–°ç­‰å¼ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°çŠ¶æ€å€¼è¢«ç”¨ä½œåŸºçº¿ã€‚æœ‰äº†åŸºçº¿æœ‰åŠ©äºç¡®å®šæ‰€é‡‡å–çš„è¡ŒåŠ¨æ˜¯åçš„/å¥½çš„ï¼Œè¿˜æ˜¯çŠ¶æ€æ˜¯åçš„/å¥½çš„ã€‚æ‚¨å¯ä»¥åœ¨å‚è€ƒèµ„æ–™éƒ¨åˆ†æ‰¾åˆ°éå¸¸å¥½çš„ç†è®ºèµ„æºã€‚

# å¤©çœŸçš„æ¼”å‘˜å…¼è¯„è®ºå®¶:

åœ¨è¿™ä¸ªå®ç°ä¸­ï¼Œæˆ‘ä»¬å°†åœ¨æ¯ä¸ªæ—¶é—´æˆ³æ›´æ–°æˆ‘ä»¬çš„ç¥ç»ç½‘ç»œã€‚è¿™ç§å®ç°ä¸åŒäº A2Cï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬åœ¨æ¯ n ä¸ªæ—¶é—´æˆ³ä¹‹åæ›´æ–°æˆ‘ä»¬çš„ç½‘ç»œã€‚æˆ‘ä»¬å°†åœ¨æœ¬ç³»åˆ—çš„ä¸‹ä¸€éƒ¨åˆ†å®ç° A2Cã€‚

## ç¥ç»ç½‘ç»œ:

ç¥ç»ç½‘ç»œåŸºæœ¬ä¸Šå¯ä»¥ç”¨ä¸¤ç§æ–¹å¼å®ç°ã€‚

1.  ä¸€ä¸ªç½‘ç»œç”¨äºæ¼”å‘˜å’Œè¯„è®ºå®¶åŠŸèƒ½ï¼Œå³ä¸€ä¸ªç½‘ç»œå…·æœ‰ä¸¤ä¸ªè¾“å‡ºå±‚ï¼Œä¸€ä¸ªç”¨äºçŠ¶æ€å€¼ï¼Œå¦ä¸€ä¸ªç”¨äºåŠ¨ä½œæ¦‚ç‡ã€‚
2.  ç‹¬ç«‹çš„ç½‘ç»œï¼Œä¸€ä¸ªæ˜¯æ¼”å‘˜çš„ï¼Œå¦ä¸€ä¸ªæ˜¯è¯„è®ºå®¶çš„ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å¯¹æ¼”å‘˜å’Œè¯„è®ºå®¶ä½¿ç”¨ä¸åŒçš„ç½‘ç»œï¼Œå› ä¸ºæˆ‘å‘ç°è¿™ä¸ªå¯ä»¥å¿«é€Ÿå­¦ä¹ ã€‚

## ä»£ç :

æ¼”å‘˜å’Œè¯„è®ºå®¶ç½‘ç»œ:

1.  æ‰¹è¯„å®¶ç½‘ç»œè¾“å‡ºæ¯ä¸ªçŠ¶æ€çš„ä¸€ä¸ªå€¼ï¼Œè€Œè¡ŒåŠ¨è€…ç½‘ç»œè¾“å‡ºè¯¥çŠ¶æ€ä¸­æ¯ä¸ªå•ä¸ªåŠ¨ä½œçš„æ¦‚ç‡ã€‚
2.  è¿™é‡Œï¼Œæ¼”å‘˜ç½‘ç»œä¸­çš„ 4 ä¸ªç¥ç»å…ƒæ˜¯åŠ¨ä½œçš„æ•°é‡ã€‚
3.  æ³¨æ„ï¼ŒActor åœ¨å¤–å±‚æœ‰ä¸€ä¸ª softmax å‡½æ•°ï¼Œå®ƒè¾“å‡ºæ¯ä¸ªåŠ¨ä½œçš„åŠ¨ä½œæ¦‚ç‡ã€‚

> æ³¨æ„:éšè—å±‚ä¸­çš„ç¥ç»å…ƒæ•°é‡å¯¹äºä»£ç†å­¦ä¹ éå¸¸é‡è¦ï¼Œå¹¶ä¸”å› ç¯å¢ƒè€Œå¼‚ã€‚

ä»£ç†ç±»çš„åˆå§‹åŒ–æ–¹æ³•:

1.  è¿™é‡Œï¼Œæˆ‘ä»¬ä¸ºæˆ‘ä»¬çš„ç½‘ç»œåˆå§‹åŒ–ä¼˜åŒ–å™¨ã€‚**è¯·** **æ³¨æ„**å­¦ä¹ çš„****é€Ÿåº¦**ä¹Ÿå¾ˆé‡è¦ï¼Œå¹¶ä¸”ä¼šå› ä½¿ç”¨çš„ç¯å¢ƒå’Œæ–¹æ³•è€Œå¼‚ã€‚**

**åŠ¨ä½œé€‰æ‹©:**

1.  **è¿™ç§æ–¹æ³•åˆ©ç”¨äº†å¼ é‡æµæ¦‚ç‡åº“ã€‚**
2.  **é¦–å…ˆï¼ŒActor ç»™å‡ºæ¦‚ç‡ï¼Œç„¶åä½¿ç”¨ TensorFlow æ¦‚ç‡åº“å°†æ¦‚ç‡è½¬æ¢æˆåˆ†å¸ƒï¼Œç„¶åä»åˆ†å¸ƒä¸­æŠ½å–åŠ¨ä½œã€‚**

**å­¦ä¹ åŠŸèƒ½å’ŒæŸå¤±:**

1.  **æˆ‘ä»¬å°†åˆ©ç”¨æ¢¯åº¦èƒ¶å¸¦æŠ€æœ¯è¿›è¡Œå®šåˆ¶åŸ¹è®­ã€‚**
2.  **è¡ŒåŠ¨è€…æŸå¤±æ˜¯é‡‡å–è¡ŒåŠ¨çš„å¯¹æ•°æ¦‚ç‡ä¹˜ä»¥ q å­¦ä¹ ä¸­ä½¿ç”¨çš„æ—¶é—´å·®çš„è´Ÿæ•°ã€‚**
3.  **å¯¹äºä¸´ç•ŒæŸå¤±ï¼Œæˆ‘ä»¬é‡‡å–äº†ä¸€ç§ç®€å•çš„æ–¹æ³•ï¼Œåªè®¡ç®—æ—¶é—´å·®çš„å¹³æ–¹ã€‚å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥ä½¿ç”¨ tf2 çš„å‡æ–¹è¯¯å·®å‡½æ•°ï¼Œä½†æ˜¯ä½ éœ€è¦å¯¹æ—¶å·®è®¡ç®—åšä¸€äº›ä¿®æ”¹ã€‚æˆ‘ä»¬å°†åœ¨æœ¬ç³»åˆ—çš„ä¸‹ä¸€éƒ¨åˆ†ä¸­ä½¿ç”¨ MSEï¼Œæ‰€ä»¥ä¸è¦æ‹…å¿ƒã€‚**
4.  **ä½ å¯ä»¥åœ¨ TensorFlow å®˜ç½‘æ‰¾åˆ°æ›´å¤šå…³äºå®šåˆ¶è®­ç»ƒå¾ªç¯çš„å†…å®¹ã€‚**

> **æ³¨æ„:è¯·ç¡®ä¿ä½¿ç”¨è¯­å¥(ä¸Šä¸‹æ–‡ç®¡ç†å™¨)è°ƒç”¨ networks insideï¼Œå¹¶ä¸”åªä½¿ç”¨å¼ é‡è¿›è¡Œç½‘ç»œé¢„æµ‹ï¼Œå¦åˆ™æ‚¨å°†å¾—åˆ°ä¸€ä¸ªå…³äºæ²¡æœ‰æä¾›æ¢¯åº¦çš„é”™è¯¯ã€‚**

**Trining å¾ªç¯:**

1.  **ä»£ç†åœ¨ç¯å¢ƒä¸­é‡‡å–è¡ŒåŠ¨ï¼Œç„¶å bot ç½‘ç»œæ›´æ–°ã€‚**
2.  **å¯¹äºæœˆçƒç€é™†å™¨ç¯å¢ƒï¼Œè¿™ç§å®ç°è¡¨ç°è‰¯å¥½ã€‚**

> **æ³¨æ„:åœ¨å®ç°è¿™äº›æ–¹æ³•æ—¶ï¼Œæˆ‘æ³¨æ„åˆ°å­¦ä¹ é€Ÿç‡å’Œéšè—å±‚ä¸­çš„ç¥ç»å…ƒå¯¹å­¦ä¹ æœ‰å¾ˆå¤§çš„å½±å“ã€‚**

**ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°è¿™ç¯‡æ–‡ç« çš„å®Œæ•´ä»£ç ã€‚è¯·ç»§ç»­å…³æ³¨å³å°†å‘å¸ƒçš„æ–‡ç« ï¼Œæˆ‘ä»¬å°†åœ¨æœ‰å¤šä¸ªå·¥äººå’Œæ²¡æœ‰å¤šä¸ªå·¥äººçš„æƒ…å†µä¸‹å®æ–½ A2Cã€‚**

**è¿™ä¸ªç³»åˆ—çš„ç¬¬äºŒéƒ¨åˆ†å¯ä»¥åœ¨è¿™é‡Œè®¿é—®[ã€‚](/actor-critic-with-tensorflow-2-x-part-2of-2-b8ceb7e059db)**

**æ‰€ä»¥ï¼Œæœ¬æ–‡åˆ°æ­¤ç»“æŸã€‚è°¢è°¢ä½ çš„é˜…è¯»ï¼Œå¸Œæœ›ä½ å–œæ¬¢å¹¶ä¸”èƒ½å¤Ÿç†è§£æˆ‘æƒ³è¦è§£é‡Šçš„ä¸œè¥¿ã€‚å¸Œæœ›ä½ é˜…è¯»æˆ‘å³å°†å‘è¡¨çš„æ–‡ç« ã€‚å“ˆé‡Œå¥¥å§†â€¦ğŸ™**

# **å‚è€ƒèµ„æ–™:**

**[](https://mitpress.mit.edu/books/reinforcement-learning-second-edition) [## å¼ºåŒ–å­¦ä¹ ï¼Œç¬¬äºŒç‰ˆ

### æ˜¾ç€æ‰©å¤§å’Œæ›´æ–°çš„å¹¿æ³›ä½¿ç”¨çš„æ–‡æœ¬å¼ºåŒ–å­¦ä¹ çš„æ–°ç‰ˆæœ¬ï¼Œæœ€â€¦

mitpress.mit.edu](https://mitpress.mit.edu/books/reinforcement-learning-second-edition) [](https://hackernoon.com/intuitive-rl-intro-to-advantage-actor-critic-a2c-4ff545978752) [## ç›´è§‰ RL:ä¼˜åŠ¿ä»‹ç»-æ¼”å‘˜-è¯„è®ºå®¶(A2C)

### å¼ºåŒ–å­¦ä¹ (RL)å®è·µè€…å·²ç»äº§ç”Ÿäº†è®¸å¤šä¼˜ç§€çš„æ•™ç¨‹ã€‚ç„¶è€Œï¼Œå¤§å¤šæ•°æè¿° RL åœ¨â€¦

hackernoon.com](https://hackernoon.com/intuitive-rl-intro-to-advantage-actor-critic-a2c-4ff545978752) [](https://www.freecodecamp.org/news/an-intro-to-advantage-actor-critic-methods-lets-play-sonic-the-hedgehog-86d6240171d/) [## ä¼˜åŠ¿æ¼”å‘˜è¯„è®ºæ–¹æ³•ä»‹ç»:è®©æˆ‘ä»¬ç©åˆºçŒ¬ç´¢å°¼å…‹ï¼

### æ‰˜é©¬æ–¯è¥¿è’™å°¼å°¼ä»‹ç»ä¼˜åŠ¿æ¼”å‘˜è¯„è®ºå®¶çš„æ–¹æ³•:è®©æˆ‘ä»¬ç©åˆºçŒ¬ç´¢å°¼å…‹ï¼ä»â€¦å¼€å§‹

www.freecodecamp.org](https://www.freecodecamp.org/news/an-intro-to-advantage-actor-critic-methods-lets-play-sonic-the-hedgehog-86d6240171d/) [](https://www.youtube.com/channel/UC58v9cLitc8VaCjrcKyAbrw) [## è²å°”çš„æœºå™¨å­¦ä¹ 

### ä½ å¥½ã€‚åœ¨ Neuralnet.aiï¼Œæˆ‘ä»¬æ¶µç›–äº†å„ç§ä¸»é¢˜çš„äººå·¥æ™ºèƒ½æ•™ç¨‹ï¼Œä»å¼ºåŒ–â€¦

www.youtube.com](https://www.youtube.com/channel/UC58v9cLitc8VaCjrcKyAbrw)**