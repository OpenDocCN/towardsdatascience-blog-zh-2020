<html>
<head>
<title>Analyze Customer Behavior the Right Way Using a Sunburst Chart Built with Python, Pandas and Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python、Pandas和Plotly构建的旭日图以正确的方式分析客户行为</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analyze-customer-behavior-the-right-way-using-a-sunburst-chart-built-with-python-pandas-and-plotly-a493076515c1?source=collection_archive---------38-----------------------#2020-06-08">https://towardsdatascience.com/analyze-customer-behavior-the-right-way-using-a-sunburst-chart-built-with-python-pandas-and-plotly-a493076515c1?source=collection_archive---------38-----------------------#2020-06-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/ae98564a87fa00361cfc3e433c3ea13e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*Pk8xUVxxFrp4OYSzScgnwg.png"/></div></figure><p id="5b0e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">旭日图，有时也称为环形图、多层饼图或径向树形图(<a class="ae ks" href="https://www.anychart.com/chartopedia/chart-type/sunburst-chart/" rel="noopener ugc nofollow" target="_blank"> Anychart，n.d. </a>)是可视化和理解分层或顺序数据的一种极好的方式。</p><p id="b417" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">旭日图有两个主要用例:</p><ol class=""><li id="2dc1" class="kt ku iq jw b jx jy kb kc kf kv kj kw kn kx kr ky kz la lb bi translated">理解整体的最大贡献者和这些组成部分的比例</li><li id="9708" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated">理解流程中连续步骤之间的人员流动</li></ol><p id="ca86" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了说明旭日图的用例，我将使用我生成的数据集来模拟客户在网站上完成购买的简单路径。(如果你想复制我的例子，数据集可以在<a class="ae ks" href="https://www.kaggle.com/giordan/datasets" rel="noopener ugc nofollow" target="_blank">我的Kaggle数据集</a>中找到)</p><figure class="li lj lk ll gt jr gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/889c56f5a7f32f984eae8e3aa53fa7bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:922/format:webp/1*2P3EHTJKE11u4Rzw1HWOLQ.png"/></div></figure><p id="eeb6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这个假设的用例中，我们希望了解我们的客户在我们的网站上完成购买的最常见途径是什么，并比较访问我们的客户的行为是否与通过广告平台到达的客户不同。</p><p id="dc03" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">值得一提的是，旭日图对于时间序列或连续数据来说并不理想，但对于层次性或序列性数据来说更理想。</p><p id="9d27" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">有了基本的方法，让我们把无聊的熊猫数据框变成一个互动的旭日图，让我们找到一些见解。</p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><p id="6d4b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要学习本教程，您需要在当前环境中安装以下库:</p><ul class=""><li id="bab6" class="kt ku iq jw b jx jy kb kc kf kv kj kw kn kx kr lt kz la lb bi translated">Numpy</li><li id="880c" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr lt kz la lb bi translated">熊猫</li><li id="aa87" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr lt kz la lb bi translated">Plolty</li></ul><p id="9ea8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我的大部分工作都是在Jupyter笔记本和Jupyter实验室中完成的，但是您可以随意使用您喜欢的任何IDE。请参考<a class="ae ks" href="https://plotly.com/python/getting-started/" rel="noopener ugc nofollow" target="_blank"> <em class="lu"> Plotly入门文档</em> </a> <em class="lu">，</em>尤其是如果你像我一样使用Jupyter工具的话。在Jupyter中第一次使用Plotly时，您必须运行几行代码，但我向您保证这并不复杂。</p><p id="8769" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当您确信可以显示Plotly图形时，您可以通过导入上述带有常用别名的库开始，Plotly提供了一个名为Plotly Express的高级API，我们将使用它。</p><pre class="li lj lk ll gt lv lw lx ly aw lz bi"><span id="c2a2" class="ma mb iq lw b gy mc md l me mf">import numpy as np<br/>import pandas as pd<br/>import plotly.express as px</span></pre><p id="f0f1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果你正在使用我的数据集，并把它放在同一个工作目录中，你可以用下面的方法导入它，如果你正在使用其他数据集，请随意使用你最喜欢的方法把它作为一个熊猫数据框架。</p><pre class="li lj lk ll gt lv lw lx ly aw lz bi"><span id="35a5" class="ma mb iq lw b gy mc md l me mf">df = pd.read_csv(‘path_to_purchase.csv’)</span></pre><p id="e837" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">使用Plotly Express构建旭日图相当简单，尤其是从熊猫数据框架。我们必须指定的关键内容是使用<em class="lu"> data_frame </em>参数的数据帧、使用的列以及使用<em class="lu"> path </em>参数的它们的层次结构，以及将确定我们的sunburst图表中各部分的大小的列</p><pre class="li lj lk ll gt lv lw lx ly aw lz bi"><span id="e2fa" class="ma mb iq lw b gy mc md l me mf">fig = px.sunburst(<br/>    data_frame = df,<br/>    path = ['Segment', 'Customer Origin', 'First Click', 'Coupon Usage'],<br/>    values = 'Customer Count'<br/>)<br/>fig.show()</span></pre><p id="57b4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">上面的代码生成了下面的图表:</p><figure class="li lj lk ll gt jr gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/476068c2add0abb99b4bfb7a7c07bddd.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*td_48DWv2zQD_AQXEbTgiA.png"/></div></figure><p id="7554" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">还有一些格式改进的空间，我不会深入讨论这些参数的细节，但是这些关键字清楚地表明了它们的作用，所以它们对你来说不应该是一个问题。</p><p id="6089" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">通过添加以下代码行，我们可以生成一个更好看的图表:</p><pre class="li lj lk ll gt lv lw lx ly aw lz bi"><span id="8f42" class="ma mb iq lw b gy mc md l me mf">fig =px.sunburst(<br/> data_frame = df,<br/> path = [‘Segment’, ‘Customer Origin’, ‘First Click’, ‘Coupon Usage’],<br/> values = ‘Customer Count’,<br/> title = ‘Paths to purchase’,<br/> height = 700,<br/> template = ‘ggplot2’<br/>)<br/>fig.show()</span></pre><figure class="li lj lk ll gt jr gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/2a7341996781fde37b0715ea6882ff9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*v1q8qlH6vNdEBgbNo29Sog.png"/></div></figure><p id="e2a2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">与Matplotlib不同，Plotly的一个优点是它生成的图表是交互式的。这增加了一个可用性层，可以增强您的探索性分析，并在演示时提供令人惊叹的因素。想想Tableau或Power BI，但可以通过Python获得。</p><p id="6155" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">通过利用这种可视化和交互性，我们现在可以在图表中看到以下内容:</p><ol class=""><li id="00ad" class="kt ku iq jw b jx jy kb kc kf kv kj kw kn kx kr ky kz la lb bi translated">大多数顾客都是有机地来到我们的网站</li><li id="a726" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated">有机到达的顾客倾向于购买更多无折扣商品，但来自平台广告的顾客更喜欢有折扣的商品</li><li id="19ab" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated">最重要的是，来自广告平台并购买打折商品的顾客比其他类型的顾客更倾向于使用优惠券购物</li></ol><figure class="li lj lk ll gt jr gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/02fa1050ce3d8a5e959b71a8dcd8b887.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*jl_L-xgEAQ-e8KhXRJi5cg.gif"/></div></figure><p id="eab7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当然，这将引发更多的问题，我们可以使用这些问题来推动进一步的分析，但旭日图使我们能够对数据进行快速探索。</p></div></div>    
</body>
</html>