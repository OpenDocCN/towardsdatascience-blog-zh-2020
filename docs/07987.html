<html>
<head>
<title>Cash Demand Forecasting of ATMs: Time Series Regression Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动取款机现金需求预测:时间序列回归模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/time-series-and-regression-methods-for-forecasting-atms-filling-in-cc6d5f7dde1e?source=collection_archive---------12-----------------------#2020-06-13">https://towardsdatascience.com/time-series-and-regression-methods-for-forecasting-atms-filling-in-cc6d5f7dde1e?source=collection_archive---------12-----------------------#2020-06-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="deaf" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><strong class="ak">机器学习在ATM取现</strong>需求预测</h2><div class=""/><div class=""><h2 id="347d" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">使用时间序列和回归模型进行需求预测</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/9d9377a005a7e908f7cd2679f55f61d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VoHBpdySuBCbJJSwwMEfGw.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">作者图片</p></figure><p id="ba2c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi md translated">自动取款机中的烟灰需求需要准确的预测，这与其他自动售货机没有什么不同。唯一的区别是现金产品需要在一段时间内补充。如果预测是错误的，它会导致大量的成本。在高预测和高未使用的情况下，ATM中存储的现金会给银行带来成本。银行根据其与货币运输公司的政策支付不同的重新填充费用。银行通常为重新填充支付大量的固定费用，为安全运输安排支付额外的额外费用。</p><p id="cd36" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">一些银行可能会在自动取款机中储存比实际需求多40%的现金，而且银行可能在全国范围内拥有数千台自动取款机。因此，业务运营的小优化将有助于高收益。</p><h1 id="6ec9" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">业务用例</h1><p id="fcdc" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">自动柜员机不应装满大量现金，这可能会带来低运输/物流成本，但高冷冻和高保险成本。另一方面，如果银行没有适当的机制来跟踪使用模式，那么频繁地重新填充ATM将降低冻结和保险成本，但会增加物流成本。</p><h1 id="33e7" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">我们的目标</h1><p id="32c0" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">很明显，每天的现金提取量是时间序列。因此，在这个典型的现金需求预测模型中，我们将展示时间序列和回归机器学习模型，以解决上述用例的问题。我们将针对单个自动柜员机(也可以将一组自动柜员机作为单个自动柜员机处理)的需求，为给定的数据集开发一个模型。</p><p id="2edd" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们必须记住，从ATM机提取现金不仅仅是时间相关的。可能存在季节性，例如:1)人们倾向于在周末的周五或2)月底领工资时取款，或3)在每个月的7-10日之间，一些人会领养老金。因此，开发ATM网络现金需求预测模型是一项具有挑战性的任务。此外，每台ATM的时序现金需求随时间波动，并且经常与用户的非平稳行为叠加。</p><h1 id="2347" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">数据加载</h1><p id="21f7" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">我们有2011年到2017年的每日交易数据。实际取款(total _ amount _ extracted)包括从自动柜员机提取实际金额的所有交易。这些交易实际上反映在ATM机的可用余额中。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi nj"><img src="../Images/c8c37543bf50087e8cfd7787e74bcf17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J0J5NcQgaaLTAKdcvRg_KA.png"/></div></div></figure><blockquote class="nk nl nm"><p id="e281" class="lh li nn lj b lk ll kd lm ln lo kg lp no lr ls lt np lv lw lx nq lz ma mb mc im bi translated">为了简单起见，我们在这里没有进行任何数据挖掘活动。建议进行广泛的挖掘工作，从数据中提取隐藏的信息。此外，建议消除可能导致多重共线性问题的不重要要素。</p></blockquote><h1 id="2808" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">模拟每日现金需求</h1><p id="dd57" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">我们将尝试拟合几个时间序列模型，并为我们的数据找到最佳拟合模型，这将允许预测未来的需求。有很多机器学习模型可供选择，决定从哪里开始可能会令人生畏。一般来说，从简单的、可解释的模型(如线性回归)开始是一个好主意，如果性能不够好，就转向更复杂但通常更精确的方法。因此，受到塞尔维亚银行<strong class="lj jd"><em class="nn"/></strong>的<em class="nn"> </em> <a class="ae nr" href="http://Broda, P., Levajković, T., Kresoja, M., Marčeta, M., Mena, H., Nikolić, M., &amp; Stojančević, T. (2014). Optimization of ATM filling-in with cash." rel="noopener ugc nofollow" target="_blank"> <strong class="lj jd"> <em class="nn">案例分析</em> </strong> </a>的启发，其中<em class="nn">时间序列分析和线性模型被用于获得每个ATM </em>的每日现金需求预测，我们选择从一个简单的线性模型开始我们的用例。</p><p id="a8f8" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们在这里的特征中既有数字变量也有分类变量。观察箱线图，我们没有观察到分类变量对现金提取的任何显著影响。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ns"><img src="../Images/3a10e6cdfd0a5368e0c92dee962a9333.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rv1-dxqeDW0jK7ix_uzlaA.jpeg"/></div></div></figure><pre class="ks kt ku kv gt nt nu nv nw aw nx bi"><span id="7cf6" class="ny mn it nu b gy nz oa l ob oc">plt.figure(figsize=(14,6))<br/>plt.subplot(1,2,1)<br/>data['total_amount_withdrawn'].hist(bins=50)<br/>plt.title('Total amount withdrawan')<br/>plt.subplot(1,2,2)<br/>stats.probplot(data['total_amount_withdrawn'], plot=plt);<br/>data['total_amount_withdrawn'].describe().T.round()</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/c33384ec24de241f10f3a0c866a88759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bwCVBErb4vn4zqxoUZo1og.png"/></div></div></figure><p id="04d9" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们可以从直方图中看到，中心在60附近。数据集中的大多数值(提取的总金额)接近60万，而更远的值(14万)很少，这也符合我们的心理模型。分布大致对称，提取的值落在大约100和100，000之间，这可以从图表上方所示的统计汇总中得到验证。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oe"><img src="../Images/0c754571a354d4e145ed99f76d24e74b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*07zaqK2XCiJvkgaZvxdmKw.png"/></div></div></figure><h2 id="41a3" class="ny mn it bd mo of og dn ms oh oi dp mw lq oj ok my lu ol om na ly on oo nc iz bi translated">OneHotEncoding</h2><p id="7eb8" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">下面的代码片段将数字特征分开，选择分类特征并对这些特征使用一键编码，然后将两个集合连接在一起。这听起来像是复杂的工作，但却相对简单明了。</p><pre class="ks kt ku kv gt nt nu nv nw aw nx bi"><span id="8edd" class="ny mn it nu b gy nz oa l ob oc"># Copy the original data<br/>features = df.copy()</span><span id="b03a" class="ny mn it nu b gy op oa l ob oc"># Select the numeric columns<br/>numeric_subset = df[['trans_date_set','trans_month','trans_year','prevweek_mean', 'total_amount_withdrawn']]</span><span id="5410" class="ny mn it nu b gy op oa l ob oc"># Select the categorical columns<br/># dropped atm_name<br/>categorical_subset = df[['weekday','festival_religion', working_day',  'holiday_sequence']]</span><span id="4879" class="ny mn it nu b gy op oa l ob oc"># One hot encoding<br/>categorical_subset = pd.get_dummies(categorical_subset)</span><span id="2870" class="ny mn it nu b gy op oa l ob oc"># Join the two dataframes using concat<br/>features = pd.concat([numeric_subset, categorical_subset], axis = 1)</span></pre><p id="9f80" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在<em class="nn"> OHE </em>之后，我们有27列(特征)的2244个观察值。</p><p id="51a2" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">通常测试集的大小范围是数据的25- 35 %,尽管没有关于大小的硬性规定。我们必须记住，随着训练数据集规模的缩小，训练模型的性能会下降。从训练集中提取太多数据可能会对最终性能造成不利影响。</p><pre class="ks kt ku kv gt nt nu nv nw aw nx bi"><span id="6479" class="ny mn it nu b gy nz oa l ob oc">X = features.copy().drop(columns = ['total_amount_withdrawn', 'trans_date_set', 'trans_month','trans_year', 'working_day_H', 'working_day_W'])<br/>y = features['total_amount_withdrawn'].copy()</span><span id="9906" class="ny mn it nu b gy op oa l ob oc">Xtrain, Xtest, ytrain, ytest = train_test_split(X, y, shuffle= False, test_size = 0.2, random_state = 42)<br/>print('length of Xtrain and Xtest: ', len(Xtrain), len(Xtest))<br/>print('length of ytrain and ytest: ', len(ytrain), len(ytest))</span></pre><h1 id="ff44" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">线性回归</h1><p id="b5e0" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">我们考虑了一个线性模型的形式:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/73c68806807a87971676b738d7118bb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*0KO-kvh8gbTzKc3WQzlOaQ.png"/></div></figure><p id="7aec" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">其中<em class="nn"> αi </em>为数据中待估计模型的参数，<em class="nn"> hi </em>为现金需求历史的不同统计。该模型针对特定日期<em class="nn"> d </em>进行评估。值<em class="nn"> li </em>是元参数，控制统计<em class="nn"> hi </em>的计算，如所考虑的历史长度。</p><blockquote class="nk nl nm"><p id="6ee2" class="lh li nn lj b lk ll kd lm ln lo kg lp no lr ls lt np lv lw lx nq lz ma mb mc im bi translated">我们总是可以使用训练数据来拟合最小最大缩放器，然后在预测之前将该缩放器应用于测试数据。此外，可以测试线性模型附加正则化参数。</p></blockquote><pre class="ks kt ku kv gt nt nu nv nw aw nx bi"><span id="81ff" class="ny mn it nu b gy nz oa l ob oc">linear = LinearRegression()<br/>linear.fit(Xtrain, ytrain)</span><span id="b52c" class="ny mn it nu b gy op oa l ob oc"># make predictions<br/>lin_pred = linear.predict(Xtest)</span><span id="1b92" class="ny mn it nu b gy op oa l ob oc"># Prediction vs Actual<br/>linpred = pd.DataFrame(lin_pred[-10:]) # predicting last 10 values<br/>linpred.rename(columns = {0: 'lin_predicted'}, inplace=True) # renaming the column<br/>linpred = linpred.round(decimals=0) # rounding the decimal values<br/>d = pd.DataFrame(data['total_amount_withdrawn']).tail(10) # calling last 10 values of original amt wothdrawn<br/>linpred.index = d.index # mapping the index of both dataframe<br/>linok = pd.concat([linpred, d], axis=1)<br/>linok['accuracy'] = round(linok.apply(lambda row: row.lin_predicted /row.total_amount_withdrawn *100, axis = 1),2)<br/>linok['accuracy'] = pd.Series(["{0:.2f}%".format(val) for val in linok['accuracy']],index = linok.index)<br/>linok = linok.assign(day_of_week = lambda x: x.index.day_name())</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi or"><img src="../Images/24cf6da96e36600414b3d8d02e04063d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wlHg9S1yeo0_SiQvzwxrrg.png"/></div></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi os"><img src="../Images/85afb3b1ab66da34e9dad7f9b0b2b339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*h81tqyxllCEuNZD_a4nhPQ.png"/></div></figure><p id="a685" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们在这里看到，线性回归预测平均超过100%。</p><h1 id="68d8" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">XGBoost回归</h1><p id="0d64" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">虽然我在这里扩展了ohe的使用，但是在实践中应该小心谨慎。</p><blockquote class="nk nl nm"><p id="605f" class="lh li nn lj b lk ll kd lm ln lo kg lp no lr ls lt np lv lw lx nq lz ma mb mc im bi translated">虽然基于回归的模型，我们通常使用ohe特征，但我们应该小心使用决策树算法。理论上，决策树能够处理分类数据。然而，它的scikit-learn实现仍然要求所有特征都是数字的。一种可能的解决方案是使用不同种类的编码(标签/目标编码)或处理分类特征的实现，如h2o库中的随机森林。</p></blockquote><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/e70a65764b3747cb460a4e5b31ed7c66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*867pRb9RR62bgI0Ck-P6LQ.png"/></div></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ou"><img src="../Images/5029c5a615e4a3131de267c412453ab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EZpez2LmXB5W9w3flhf_9A.png"/></div></div></figure><p id="2b5a" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">下面，我们绘制了预测值和实际值，以及这些值的组合，以获得更好的可视性。与LinReg相比，XGBoost模型做得相当好，并且使用默认参数，与LinReg的大约50%相比，平均应计率超过90%。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ov"><img src="../Images/fc915fd8904d7b5f27e30590b126d990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*njtQwPZ4Id7qUMTDeXhibg.jpeg"/></div></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/f1e84d41788055da8ace6a2afd874789.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*pWs6JZ5QrlAYFXsZwmMOUg.png"/></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/29233ebafb2910d97cdcb0595f0ef170.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*aTdsxw9lsrvFJC9WpOCX2w.png"/></div></figure><p id="c99d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">变量重要性图如下所示:</p><pre class="ks kt ku kv gt nt nu nv nw aw nx bi"><span id="cd96" class="ny mn it nu b gy nz oa l ob oc">shap_values = shap.TreeExplainer(xgb).shap_values(Xtest)<br/>shap.summary_plot(shap_values, Xtest, plot_type="bar")</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oy"><img src="../Images/cb71e5591858f9768d46c16b75b5a0b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AdOtc9Lfz03lVhL-RePrhw.png"/></div></div></figure><h1 id="e809" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">轻型GBM</h1><p id="1c88" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">LightGBM通过整数编码的分类特征提供了良好的准确性。它通常比一位热编码执行得更好。</p><pre class="ks kt ku kv gt nt nu nv nw aw nx bi"><span id="7781" class="ny mn it nu b gy nz oa l ob oc">X = df.iloc[:, 2:10].copy()<br/>y = df.iloc[:, 10].values</span><span id="51c2" class="ny mn it nu b gy op oa l ob oc"># Transform categorical features into the appropriate type that is expected by LightGBM<br/>for c in X.columns:<br/>col_type = X[c].dtype<br/>if col_type == 'object' or col_type.name == 'category':<br/>X[c] = X[c].astype('category')</span><span id="40d9" class="ny mn it nu b gy op oa l ob oc"># Splitting the dataset into the Training set and Test set<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, shuffle= False, test_size = 0.2, random_state = 42)<br/>print('length of X_train and X_test: ', len(X_train), len(X_test))<br/>print('length of y_train and y_test: ', len(y_train), len(y_test))</span></pre><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oz"><img src="../Images/041d4e725637e2defdc3ace08e8bf5a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zLhj06Ecx8c0SUrCRYDAZA.png"/></div></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pa"><img src="../Images/e58f09b1c3fa52738f6b8ef62c78e757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cBWKN1vDdO36BE0cai8a9w.png"/></div></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/9253d929e7e59b8f04b46a037b401bcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*xc-_r_bP0t22frBZH4B4uQ.png"/></div></figure><p id="c756" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们的平均预测在这里是相当准确的。虽然这个模型漏掉了一些日子，但是平均来说，这个预测比XG模型要好。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pc"><img src="../Images/210d713022d211637eab1600ba42fdec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CrElcfQZFH-zyAOi7ciN1A.png"/></div></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pd"><img src="../Images/32cf4e00a856b2c629c332c397d55a2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wrVopbfutmUT5c_keK7Wkg.png"/></div></div></figure><h1 id="f0e5" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">CatBoost</h1><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pe"><img src="../Images/a66dfbcbd76c2d7292c655f36982d833.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HzvYCRcVi_zVm2KZu5OQYw.png"/></div></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pf"><img src="../Images/1f3e0500ff5bf46105458b6e951b51f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FF1fC9B8NYvgbsm9YpF9YA.png"/></div></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/6d44ca585d545dfb833d113354827b7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*w9ZmT_NL0RCCeoe5d60MAA.png"/></div></figure><p id="5460" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">像LGB一样，CatBoost也显示了几乎相似预测结果。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ph"><img src="../Images/d4926230973f85d5f77cd4545be5a8b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ir1CqJc80Ro0BVINeNcv4A.png"/></div></div></figure><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ot"><img src="../Images/0993ac606acf08fe5222f9b06f8a86e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*McfQSD1BUJnsr3tJSGv3kA.png"/></div></div></figure><p id="e114" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">观察LightGBM和CatBoost如何从训练集中决定重要的特征总是很有趣的。但是，我将在另一篇文章中讨论这个问题。</p><h1 id="7adb" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">对比分析</h1><p id="7171" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">企业可能会有兴趣看到最终的表格报告。根据这里观察到的结果，选择Catboost或LightGBM建模方法进行进一步优化是可行的。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pi"><img src="../Images/2fce1eb9a2305a28ba2c967238b9a23f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ZJyQM5RglU3YZHwgfDSwg.png"/></div></div></figure><p id="5fd2" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">我们上面的练习是为了举例说明。在机器学习练习中，有三个更广泛的部分:(1)数据提取和挖掘，这有助于确定特征(这通常需要大约60-70%)，(2)确定和拟合包括超参数优化的模型(这通常需要10-15%)，(3)准确性度量和测试需要10-15%的时间)。因此，我们看到第一阶段对于机器学习生命周期的成功至关重要。</p><p id="f97c" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">这里，我们分析了一台特定的自动柜员机。对于多台柜员机，可以使用聚类方式进行现金需求预测，这带来了额外的优势:</p><ol class=""><li id="d60c" class="pj pk it lj b lk ll ln lo lq pl lu pm ly pn mc po pp pq pr bi translated">提高了现金需求预测的准确性，这是因为在预测具有类似的一周中现金提取季节性模式的ATM中心组的ATM每日现金需求时，计算复杂性降低了，</li><li id="b5d8" class="pj pk it lj b lk ps ln pt lq pu lu pv ly pw mc po pp pq pr bi translated">运营成本的潜在巨大节约，因为类似的现金补充模式可用于属于同一集群的ATM中心。</li></ol><h1 id="3f1c" class="mm mn it bd mo mp mq mr ms mt mu mv mw ki mx kj my kl mz km na ko nb kp nc nd bi translated">结论</h1><p id="f29c" class="pw-post-body-paragraph lh li it lj b lk ne kd lm ln nf kg lp lq ng ls lt lu nh lw lx ly ni ma mb mc im bi translated">LightGBM和CatBoost在没有对给定数据集进行任何优化的情况下表现出了良好的预测能力。然而，有相当多的金融机构和使用案例可用于简单的线性回归或复杂的神经网络。作为一名分析顾问，当我们解决一个业务问题时，我们想到的第一个问题是我们能否使用线性规划(LP)来解决。考虑到LP更快的处理时间和清晰的可见性，它在商业中非常受欢迎。甚至LP也可以用来一次解决多个目标。</p><p id="ba1d" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated">在这里，自动柜员机提款预测的关键是捕获和处理历史数据，以洞察未来。然而，现金需求天生具有高方差和非平稳的随机过程，这会影响许多方法的可靠性。此外，对现金的需求不仅受时间的影响，而且它遵循不同的趋势，这使得建模更加困难。比如节假日如何影响ATM的使用，取决于柜员所在的位置。根据取款金额和取款交易次数，可根据需求(如高、中、低)将多台ATM分为几大类。集群级别的补充计划可以为在类似地理区域运行的ATM节省大量运营成本。</p><p id="6fd7" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><strong class="lj jd"> <em class="nn">我可以到达</em> </strong> <em class="nn"> </em> <a class="ae nr" href="https://www.linkedin.com/in/saritmaitra/" rel="noopener ugc nofollow" target="_blank"> <strong class="lj jd"> <em class="nn">这里</em> </strong> </a>。</p><p id="79bf" class="pw-post-body-paragraph lh li it lj b lk ll kd lm ln lo kg lp lq lr ls lt lu lv lw lx ly lz ma mb mc im bi translated"><em class="nn">参考:</em></p><ol class=""><li id="0bc8" class="pj pk it lj b lk ll ln lo lq pl lu pm ly pn mc po pp pq pr bi translated"><em class="nn">加雷斯，詹姆斯；丹妮拉·威滕；哈斯蒂，特雷弗；罗伯特·蒂布拉尼(2015)。统计学习导论。纽约:施普林格</em></li></ol></div></div>    
</body>
</html>