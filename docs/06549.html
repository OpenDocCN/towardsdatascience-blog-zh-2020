<html>
<head>
<title>Scraping Tabular Data with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用熊猫抓取表格数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/scraping-tabular-data-with-pandas-python-10cf2a133cbf?source=collection_archive---------21-----------------------#2020-05-24">https://towardsdatascience.com/scraping-tabular-data-with-pandas-python-10cf2a133cbf?source=collection_archive---------21-----------------------#2020-05-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="e3bf" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">编程；编排</h2><div class=""/><div class=""><h2 id="eead" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">使用 Python 和 Pandas 进行网页抓取</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ko"><img src="../Images/7c787a75dffc77df5ea1d10d4f133d36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*RgNuJ_R-7DzaqYvUjOVuKQ.jpeg"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">图片来自<a class="ae la" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=731198" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae la" href="https://pixabay.com/photos/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=731198" rel="noopener ugc nofollow" target="_blank">自由照片</a></p></figure><p id="49b8" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi lx translated">eb 抓取是一种从网站获取数据的技术。BeautifulSoup 和 Scrapy 是 Python 中两个广泛用于执行 Web 抓取的库。然而，使用这些库可能很麻烦，因为我们需要找到元素标签，从它们中提取文本，然后清理数据。</p><p id="e5d5" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">本文将向您展示一种使用 Pandas 提取表格数据的简单方法。是啊！熊猫！</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h2 id="57ab" class="mn mo iq bd mp mq mr dn ms mt mu dp mv lk mw mx my lo mz na nb ls nc nd ne iw bi translated"><strong class="ak">从 HTML 页面提取表格</strong></h2><p id="1535" class="pw-post-body-paragraph lb lc iq ld b le nf ka lg lh ng kd lj lk nh lm ln lo ni lq lr ls nj lu lv lw ij bi translated">对于本教程，我们将从<a class="ae la" href="https://en.wikipedia.org/wiki/The_World%27s_Billionaires" rel="noopener ugc nofollow" target="_blank">这个维基百科页面</a>中摘录全球十大亿万富翁的详细信息。</p><p id="7c83" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我们将使用 Pandas 库的<code class="fe nk nl nm nn b"><a class="ae la" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_html.html" rel="noopener ugc nofollow" target="_blank">read_html</a></code>方法来读取 HTML 表。</p><pre class="kp kq kr ks gt no nn np bn nq nr bi"><span id="af45" class="ns mo iq nn b be nt nu l nv nw">import pandas as pd<br/><br/>url = 'https://en.wikipedia.org/wiki/The_World%27s_Billionaires'<br/><br/>df_list = pd.read_html(url)</span></pre><p id="b9c8" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这个脚本将 HTML 表格返回到 DataFrame 对象列表中。</p><p id="eb10" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">让我们检查找到的表的总数:</p><pre class="kp kq kr ks gt no nn np bn nq nr bi"><span id="44c7" class="ns mo iq nn b be nt nu l nv nw">len(df_list)<br/><br/># Output:<br/># 32</span></pre><p id="ce43" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">要访问特定表，只需访问列表中的元素。例如，<br/>将返回下表:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/84563ba9830326c731f4be19f929ed05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*6QFP4r9NNHKPuKlFKeLx2w.png"/></div></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h2 id="99c7" class="mn mo iq bd mp mq mr dn ms mt mu dp mv lk mw mx my lo mz na nb ls nc nd ne iw bi translated">将特定列设置为索引</h2><p id="fa2e" class="pw-post-body-paragraph lb lc iq ld b le nf ka lg lh ng kd lj lk nh lm ln lo ni lq lr ls nj lu lv lw ij bi translated">我们可以通过使用<code class="fe nk nl nm nn b">index_col</code>参数来选择表索引的特定列。</p><p id="cd25" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="ny">例如:</em> </strong></p><pre class="kp kq kr ks gt no nn np bn nq nr bi"><span id="cca5" class="ns mo iq nn b be nt nu l nv nw">pd.read_html(url, index_col=1)[2]</span></pre><p id="f2a7" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">返回下表:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/ceb42d6fe72aee0bb56caaf9ef76b6cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*VuTBmdbcfdxvkkJJbXG1Tg.png"/></div></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h2 id="5240" class="mn mo iq bd mp mq mr dn ms mt mu dp mv lk mw mx my lo mz na nb ls nc nd ne iw bi translated">返回包含字符串或正则表达式的表格</h2><p id="2e0e" class="pw-post-body-paragraph lb lc iq ld b le nf ka lg lh ng kd lj lk nh lm ln lo ni lq lr ls nj lu lv lw ij bi translated">我们还可以使用<code class="fe nk nl nm nn b">match</code>参数指定返回包含特定字符串或正则表达式的表列表。</p><p id="d294" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="ny">举例:</em> </strong></p><pre class="kp kq kr ks gt no nn np bn nq nr bi"><span id="17d4" class="ns mo iq nn b be nt nu l nv nw">pd.read_html(url, match='Number and combined net worth of billionaires by year')[0].head()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/0274c87eedcf940a8e39af6c993afbf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*vjfpdaGMhUdPlGAi1DW8LQ.png"/></div></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h2 id="4c75" class="mn mo iq bd mp mq mr dn ms mt mu dp mv lk mw mx my lo mz na nb ls nc nd ne iw bi translated">指定要识别为不适用的字符串</h2><p id="b6dd" class="pw-post-body-paragraph lb lc iq ld b le nf ka lg lh ng kd lj lk nh lm ln lo ni lq lr ls nj lu lv lw ij bi translated">我们可以通过使用<code class="fe nk nl nm nn b">na_values</code>参数来指定要识别为 NA/NaN 的字符串列表。</p><p id="042b" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="ny">例如:</em> </strong></p><ul class=""><li id="cd76" class="ob oc iq ld b le lf lh li lk od lo oe ls of lw og oh oi oj bi translated">未指定<code class="fe nk nl nm nn b">na_values</code>:</li></ul><pre class="kp kq kr ks gt no nn np bn nq nr bi"><span id="61cc" class="ns mo iq nn b be nt nu l nv nw">pd.read_html(url)[0].tail()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/f416d7395d3bcf6b19e04aca3456979f.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*BZUGoqpyyZ1zjv7bFSI56A.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">不指定 na_values</p></figure><ul class=""><li id="d8c4" class="ob oc iq ld b le lf lh li lk od lo oe ls of lw og oh oi oj bi translated">指定<code class="fe nk nl nm nn b">na_values</code>后:</li></ul><pre class="kp kq kr ks gt no nn np bn nq nr bi"><span id="c733" class="ns mo iq nn b be nt nu l nv nw">pd.read_html(<br/>    url, <br/>    na_values=["Forbes: The World's Billionaires website"]<br/>    )[0].tail()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/db52a9e0f72c224f097c07aa6a7aaa72.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*M5F7drAHnqGjadIxY64UNw.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">指定 na_values 后</p></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h2 id="9395" class="mn mo iq bd mp mq mr dn ms mt mu dp mv lk mw mx my lo mz na nb ls nc nd ne iw bi translated">其他参数</h2><ul class=""><li id="5189" class="ob oc iq ld b le nf lh ng lk om lo on ls oo lw og oh oi oj bi translated"><code class="fe nk nl nm nn b">skiprows</code>参数允许我们跳过开始的“n”行</li><li id="2186" class="ob oc iq ld b le op lh oq lk or lo os ls ot lw og oh oi oj bi translated"><code class="fe nk nl nm nn b">header</code>参数可以用来使指定的行作为列标题</li></ul><p id="9d11" class="pw-post-body-paragraph lb lc iq ld b le lf ka lg lh li kd lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated"><strong class="ld ja"> <em class="ny">例如:</em> </strong></p><pre class="kp kq kr ks gt no nn np bn nq nr bi"><span id="f858" class="ns mo iq nn b be nt nu l nv nw">pd.read_html(url, skiprows=3, header=0)[0].head()</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/fe415a87df9fab3939655f4378ecf5b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*cTZy4uv1CHDoFL2hV2A_5w.png"/></div></figure></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h1 id="fd91" class="ov mo iq bd mp ow ox oy ms oz pa pb mv kf pc kg my ki pd kj nb kl pe km ne pf bi translated">结论</h1><p id="3fc6" class="pw-post-body-paragraph lb lc iq ld b le nf ka lg lh ng kd lj lk nh lm ln lo ni lq lr ls nj lu lv lw ij bi translated">在本文中，我们学习了如何使用<code class="fe nk nl nm nn b">read_html</code>方法轻松地从页面中抓取 HTML 表格。此外，我们还学习了一些重要的参数，这些参数可以进一步帮助我们抓取所需的表。</p><h2 id="1a86" class="mn mo iq bd mp mq mr dn ms mt mu dp mv lk mw mx my lo mz na nb ls nc nd ne iw bi translated">参考</h2><ul class=""><li id="8f8c" class="ob oc iq ld b le nf lh ng lk om lo on ls oo lw og oh oi oj bi translated"><a class="ae la" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_html.html" rel="noopener ugc nofollow" target="_blank">https://pandas . pydata . org/pandas-docs/stable/reference/API/pandas . read _ html . html</a></li></ul><h2 id="5b5e" class="mn mo iq bd mp mq mr dn ms mt mu dp mv lk mw mx my lo mz na nb ls nc nd ne iw bi translated">资源</h2><p id="f7e7" class="pw-post-body-paragraph lb lc iq ld b le nf ka lg lh ng kd lj lk nh lm ln lo ni lq lr ls nj lu lv lw ij bi translated">本文中使用的代码片段可以在我的<a class="ae la" href="https://jimit105.github.io/medium-articles/Scraping%20Tabular%20Data%20with%20Pandas.html" rel="noopener ugc nofollow" target="_blank"> GitHub 页面</a>上找到。</p><h2 id="f349" class="mn mo iq bd mp mq mr dn ms mt mu dp mv lk mw mx my lo mz na nb ls nc nd ne iw bi translated">让我们连接</h2><p id="440f" class="pw-post-body-paragraph lb lc iq ld b le nf ka lg lh ng kd lj lk nh lm ln lo ni lq lr ls nj lu lv lw ij bi translated">领英:<a class="ae la" href="https://www.linkedin.com/in/jimit105/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/jimit105/</a><br/>GitHub:<a class="ae la" href="https://github.com/jimit105" rel="noopener ugc nofollow" target="_blank">https://github.com/jimit105</a><br/>推特:<a class="ae la" href="https://twitter.com/jimit105" rel="noopener ugc nofollow" target="_blank">https://twitter.com/jimit105</a></p></div></div>    
</body>
</html>