<html>
<head>
<title>How to quickly find the best bins for your histogram</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何快速找到最适合直方图的条柱</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-quickly-find-the-best-bin-width-for-your-histogram-4d8532f053b0?source=collection_archive---------11-----------------------#2020-02-06">https://towardsdatascience.com/how-to-quickly-find-the-best-bin-width-for-your-histogram-4d8532f053b0?source=collection_archive---------11-----------------------#2020-02-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7edf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据探索是每个数据科学项目中的关键步骤，通常从查看单个变量的分布开始。这就是直方图的亮点。</p><p id="b09d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">直方图对于可视化列的分布非常有用，这有助于理解数据的重要方面。例如，通过简单地查看直方图，我们可以立即识别数据中的异常值甚至错误(例如，包含患者年龄的列中的负值)。</p><p id="ac5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当处理直方图时，我们几乎总是最终调整条柱宽度，这是一个关键参数，因为它决定了我们可以从图中提取多少信息和什么类型的信息。</p><p id="f132" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我将向您展示如何通过在Jupyter Notebook或JupyterLab中使用plotly和ipywidgets创建一个交互式直方图来快速找到您的最佳bin宽度。</p><p id="a670" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注意:</strong>尽管我用plotly展示了交互式重新绑定，但是您可以将我所展示的逻辑应用于任何绘图库，比如seaborn和matplotlib。</p><p id="c36e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了可视化，我将以分钟为单位显示2013年从纽约出发的300，000多个航班的飞行时间(<a class="ae kl" href="https://cran.r-project.org/web/packages/nycflights13/nycflights13.pdf" rel="noopener ugc nofollow" target="_blank"> NYCflights13 </a>数据)。你可以在GitHub 上找到这篇文章的完整代码。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><h1 id="723b" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">交互式宁滨直方图</h1><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi lr"><img src="../Images/ed50c5ad63bc83e78499548ca19e3188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*980Ewi0NJf27bnPcHM2Bag.gif"/></div></div></figure><p id="83a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这张图中，你可以看到最终的结果。如果我们通过一个滑块改变箱的宽度，plotly图会自动调整。</p><p id="b3d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了实现这个行为，我们将<code class="fe md me mf mg b">plotly.graph_objs</code>(创建plotly图)与<code class="fe md me mf mg b">ipywidgets.Floatslider</code>结合起来。</p><p id="3734" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是创建可重组直方图的代码。</p><figure class="ls lt lu lv gt lw"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="9b94" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们一行一行地过一遍。</p><h1 id="88b5" class="kt ku iq bd kv kw mj ky kz la mk lc ld le ml lg lh li mm lk ll lm mn lo lp lq bi translated">逐行解释代码</h1><h2 id="6e3b" class="mo ku iq bd kv mp mq dn kz mr ms dp ld jy mt mu lh kc mv mw ll kg mx my lp mz bi translated">0.功能签名</h2><figure class="ls lt lu lv gt lw"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="aca6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，我们的函数有两个参数:<code class="fe md me mf mg b">series</code>一只熊猫。Series和<code class="fe md me mf mg b">initial_bin_width</code>，指定我们希望在绘图中将a作为默认值的bin宽度。在我们的例子中，它是10分钟的广播时间窗口。</p><h2 id="5938" class="mo ku iq bd kv mp mq dn kz mr ms dp ld jy mt mu lh kc mv mw ll kg mx my lp mz bi translated">1.创建图形</h2><figure class="ls lt lu lv gt lw"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="b6cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们生成一个新的<code class="fe md me mf mg b">FigureWidget</code>实例。<code class="fe md me mf mg b">FigureWidget</code>物体是plotly的新“魔法物体”。你可以在Jupyter笔记本或JupyterLab中显示它，就像任何普通的plotly图形一样。但是，这种方法有一些优点:</p><ul class=""><li id="3fc7" class="na nb iq jp b jq jr ju jv jy nc kc nd kg ne kk nf ng nh ni bi translated">FigureWidgets可以与ipywidgets相结合，以创建更强大的结构(事实上，这就是FigureWidgets的设计目的)</li><li id="0670" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated">您可以在Python中以各种方式操作<code class="fe md me mf mg b">FigureWidget</code></li><li id="5ede" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated">您还可以收听一些事件和</li><li id="7c8e" class="na nb iq jp b jq nj ju nk jy nl kc nm kg nn kk nf ng nh ni bi translated">当事件被触发时，您可以执行更多的Python代码</li></ul><p id="ec82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe md me mf mg b">FigureWidget</code>接收属性<code class="fe md me mf mg b">data</code>，该属性指定了我们想要显示的所有轨迹的列表。在我们的例子中，我们只想显示一个直方图。直方图的x值来自<code class="fe md me mf mg b">series</code>。我们通过将字典传递给<code class="fe md me mf mg b">xbins</code>来设置bin宽度。当我们在字典中设置<code class="fe md me mf mg b">size=None</code>时，plotly会为我们选择一个bin宽度。</p><h2 id="03f1" class="mo ku iq bd kv mp mq dn kz mr ms dp ld jy mt mu lh kc mv mw ll kg mx my lp mz bi translated">2.创建滑块</h2><figure class="ls lt lu lv gt lw"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="909b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用<code class="fe md me mf mg b">ipywidgets</code>库生成一个<code class="fe md me mf mg b">FloatSlider</code>。通过这个滑块，我们稍后将能够操纵我们的直方图。</p><h2 id="b667" class="mo ku iq bd kv mp mq dn kz mr ms dp ld jy mt mu lh kc mv mw ll kg mx my lp mz bi translated">3.保存对直方图的引用</h2><figure class="ls lt lu lv gt lw"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="40dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们获取对直方图的引用，因为我们想在最后一步操作它。特别是，我们将更改对象的<code class="fe md me mf mg b">xbins</code>属性，我们可以通过<code class="fe md me mf mg b">histogram_object.xbins</code>访问它。</p><h2 id="cf54" class="mo ku iq bd kv mp mq dn kz mr ms dp ld jy mt mu lh kc mv mw ll kg mx my lp mz bi translated">4.编写并使用回调</h2><figure class="ls lt lu lv gt lw"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="0b7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们已经实现的<code class="fe md me mf mg b">FloatSlider</code>带有一些魔力。每当它的值改变时(即我们移动滑块)，它就触发一个事件。我们可以使用该事件来更新直方图中的区间宽度。从技术上来说，您可以通过调用bin滑块上的<code class="fe md me mf mg b">observe</code>方法来实现这一点，向它传递您想要调用的函数(在我们的例子中是<code class="fe md me mf mg b">set_bin_size</code>，并告诉它何时调用该函数(<code class="fe md me mf mg b">name="value"</code>意味着每当滑块的<code class="fe md me mf mg b">value</code>改变时我们都会调用该函数)。现在，每当滑块的值改变时，它就会调用<code class="fe md me mf mg b">set_bin_size</code>。<code class="fe md me mf mg b">set_bin_size</code>通过魔术参数<code class="fe md me mf mg b">change</code>访问滑块的值，魔术参数是一个字典，包含关于由<code class="fe md me mf mg b">bin_slider</code>触发的事件的数据。例如，<code class="fe md me mf mg b">change["new"]</code>包含滑块的新值，但是您也可以使用<code class="fe md me mf mg b">change["old"]</code>来访问它以前的值。注意，你不必使用参数名<code class="fe md me mf mg b">change</code>。你可以给它取任何你想要的名字。</p><p id="1a22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在回调函数<code class="fe md me mf mg b">set_bin_size</code>中，我们可以看到它简单地采用了引用<code class="fe md me mf mg b">histogram_object</code>，以便通过覆盖<code class="fe md me mf mg b">xbins</code>来更新<code class="fe md me mf mg b">FigureWidget</code>的bin设置(即改变bin宽度)。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="9b32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们把上面的所有部分放在一起时，我们就有了第一个漂亮的交互式直方图的原型。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><h1 id="92ec" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">结论</h1><p id="587b" class="pw-post-body-paragraph jn jo iq jp b jq no js jt ju np jw jx jy nq ka kb kc nr ke kf kg ns ki kj kk ij bi translated">直方图是开始探索数据集的单个列的一个很好的方法。使用plotly，我们可以创建强大的交互式可视化，并可以使用ipywidgets进一步增强。</p><p id="aac4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我向您展示了在Jupyter Notebook或JupyterLab中使用plotly和ipywidgets时，如何交互式地快速找到直方图的(主观)最佳条宽。</p><p id="d0e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在8080实验室，我们使用我们的python工具<a class="ae kl" href="http://bamboolib.8080labs.com" rel="noopener ugc nofollow" target="_blank"> bamboolib </a>中的重新绑定特性。与许多其他交互式功能一起，它帮助我们的用户更快地获得洞察力。</p><p id="7980" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您对本文有任何反馈或建设性的批评，或者想讨论如何为直方图添加更多功能，请随时通过<a class="ae kl" href="https://www.linkedin.com/in/tobias-krabel-830532114/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="e4ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nt">原载于2020年02月06日https://8080labs.com</em><em class="nt"/><a class="ae kl" href="https://8080labs.com/blog/posts/find-best-bins-for-plotly-histogram/" rel="noopener ugc nofollow" target="_blank"><em class="nt">。</em></a></p></div></div>    
</body>
</html>