# 了解投资组合优化

> 原文：<https://towardsdatascience.com/understanding-portfolio-optimization-795668cef596?source=collection_archive---------12----------------------->

![](img/3628ebe40e7053081f7e71d9734f92ab.png)

卢卡斯·布拉塞克在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

## 从概念上理解优化投资组合意味着什么

***来自《走向数据科学》编辑的提示:*** *虽然我们允许独立作者根据我们的* [*规则和指导方针*](/questions-96667b06af5) *发表文章，但我们并不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的* [*读者术语*](/readers-terms-b5d780a700a4) *。*

量化金融(至少在投资组合管理方面)就是寻找最优投资组合。对于给定的风险水平，我们希望确保获得尽可能多的回报。

在定量金融学中，风险被视为一种资源。将你的投资组合暴露在风险中会随着时间的推移产生回报。换句话说，预期回报是我们承担不确定性(围绕通货膨胀、经济等的不确定性)所得到的补偿。).

有几件事要记住:

*   投资回报的风险和不确定性传统上由其历史回报的标准差(也称为波动性)来表示。
*   风险和收益之间存在近似的正相关关系。一项资产的波动性越大，其历史回报率通常就越高。
*   然而情况并非总是如此。有一些波动性很大的资产，相对于其他波动性类似的资产，其已实现回报一直乏善可陈。回报率较低的一个潜在原因是，这些资产还有其他价值，比如与股市的相关性较低。随着股市波动而波动(并提供正预期回报)的投资因其对冲能力而备受青睐。

我在下面的文章中深入探讨了投资风险，所以如果你想深入研究，请读一读:

[](/understanding-investment-risk-3882c58e00e0) [## 了解投资风险

### 关于我们如何对投资风险建模以及这是否有意义的哲学探索

towardsdatascience.com](/understanding-investment-risk-3882c58e00e0) 

# 理解投资组合优化的类比

如果你只有一天时间去东京旅游(之前从未去过)，并且你需要为这一天制定一个行程，你会怎么做？你可能会从列出可能的活动开始。然后你会挑选四五个可能是最有趣的活动。

![](img/66322741abd092639a6298955098deb1.png)

埃里克·伊斯曼在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的照片

但是对东京不熟悉，你担心你可能会尝试一项活动而不喜欢它——那会浪费你宝贵的时间。但是你也想尝试一些新的东西。做一些你已经在家做过的事情(比如在咖啡馆阅读)是一种乐趣，但是没有潜力变得超级有趣。做一些完全新奇的事情可能会非常有趣，但也可能会很糟糕。

**因此，对于每一项活动，你不仅需要考虑它可能有多有趣(预期回报)，还要考虑它最终变得不太有趣的风险(不确定性)。**

你也可以选择彼此不相关的活动。因为如果你最终一遍又一遍地做同一类型的活动，并且你发现它实际上一点也不有趣，那么你的一天就会被毁了。因此，多种多样的活动类型会让你更有可能最终获得快乐。

因此，我们可以将您的旅程创建过程总结如下— **您希望创建一篮子活动，根据您的个人风险承受能力(您个人对新体验和熟悉体验的渴望)最大化您可能获得的乐趣。**

您评估和权衡一项活动与其他活动的方式如下:

*   权衡每项活动本身的潜在乐趣和你对其乐趣的不确定性。
*   将每项活动与其他活动进行权衡，确保你有多种活动类型(**多样化**)。例如，你不会希望每项活动都涉及食物(以防你发现你不喜欢日本食物)。此外，你吃得越多，越饱，下一餐就越难享受。换句话说，你希望各种活动之间的相关性低，这样做一项活动不会影响你对下一项活动的享受。

一旦你完成了，假设你付出了一些努力，你可能会相信**你的最终清单最大化了你那天开心的可能性**。

简而言之，这就是投资组合优化—

> **对于给定的风险水平，我们希望最大化我们投资组合获得正回报的概率**。

我们通过筛选金融资产来做到这一点，就像我们对活动所做的那样:

*   通过权衡他们的预期回报和波动性(记住波动性是我们估算风险的方式)。相对于波动性而言，预期回报越高，我们就越确定投资的回报随着时间的推移将是正的。
*   通过考虑资产收益之间的相关性。同等条件下，我们希望资产尽可能不相关。这使多样化的好处最大化。下一节将详细介绍我们为什么关注多元化。

# 多样化的好处

多样化有时被称为经济学和金融学中唯一的免费午餐。要了解原因，让我们举个例子。

如果我们持有一只股票 100 美元，预期在下一年回报 10%，那么我们的预期回报是 10 美元。如果我们再增加 100 美元的另一只股票，它的预期回报率也是 10%，那么我们 200 美元的投资组合的回报率现在翻了一番，达到了 20 美元。

## 相关性= 1 的情况

双资产投资组合的投资组合风险(标准差)可以计算如下:

```
**stdev = 
sqrt(w1^2*stdev1^2 + w2^2*stdev2^2 + 2*w1*w2*p*stdev1*stdev2)**where 
w1 is weight of stock 1
w2 is weight of stock 2
stdev1 is standard deviation of stock 1
stdev2 is standard deviation of stock 2
p is correlation between stock 1 and stock 2
```

假设我们投资组合中的两只股票的标准差都是 10%。

因此，当我们只有 100 美元投资于一只股票时，我们投资组合的风险是 100 美元* 10% = 10 美元。这意味着我们预期我们的回报是 10 美元，但是围绕着它有一个不确定的圆锥。

不确定度的宽度由其西格玛(也称为标准偏差)描述。在这种情况下，sigma 等于 10 美元。sigma 越大，我们就越不确定我们的投资组合在任何特定年份的回报(我们的投资组合价值波动就越大)。

如果你不熟悉正态分布及其参数，可以看看下面的帖子:

[](/understanding-the-normal-distribution-with-python-e70bb855b027) [## 理解正态分布(使用 Python)

### 了解如何使用它，以及为什么它对数据科学和统计学如此重要

towardsdatascience.com](/understanding-the-normal-distribution-with-python-e70bb855b027) 

我们还假设两只股票的走势完全一致(意味着它们的相关性为 1.0)。我们可以使用上面的公式计算我们投资组合的风险:

```
stdev = 
sqrt(w1^2*stdev1^2 + w2^2*stdev2^2 + 2*w1*w2*p*stdev1*stdev2)Portfolio Risk
= sqrt(0.5^2*0.1^2 + 0.5^2*0.1^2 + 2*0.5*0.5*1*0.1*0.1)
= 0.1
```

所以我们两只股票投资组合的风险仍然是 10%。用美元计算，我们的 sigma 现在是 200 美元* 10% = 20 美元。所以我们从 100 美元的投资组合，预期收益为 10 美元，sigma 为 10 美元，到 200 美元的投资组合，预期收益为 20 美元，sigma 为 20 美元。*(我互换使用 sigma 和 risk)*

所以基本上没什么变化。如果我们将股票 1 的持有量增加一倍(而不是购买股票 2)，我们将会获得完全相同的结果。这是因为我们假设股票 1 和股票 2 完全相关(p=1)。因此，拥有其中之一或两者都是一回事。

现在让我们看看如果股票 1 和股票 2 不相关会发生什么。

## 相关性= 0 的情况

我们 200 美元投资组合的预期回报仍然是 20 美元。但现在我们的风险是:

```
stdev = 
sqrt(w1^2*stdev1^2 + w2^2*stdev2^2 + **2*w1*w2*p*stdev1*stdev2**)***Since p=0, the third term drops out!***Portfolio Risk
= sqrt(0.5^2*0.1^2 + 0.5^2*0.1^2 + 2*0.5*0.5***0***0.1*0.1)
= 0.0707
```

我们的投资组合风险已降至 7.1%。这意味着以美元计算，我们 200 美元的投资组合的 sigma(也称为风险)为 14.14 美元，大大低于我们之前的 sigma 20 美元。

因此，与完全相关的情况和持有 200 美元股票 1 的情况相比，我们能够在保持相同预期回报的同时降低近三分之一的风险！一顿真正的免费午餐。

这显然是一个典型的例子。事实上，很难找到一堆完全不相关的资产都有很高的预期回报。关于相关性和多样化的更深入的讨论，你可以阅读我之前的博客:

[](/understanding-correlation-and-diversification-661c19a26555) [## 理解相关性和多样化

### 为什么投资不相关的资产是值得的

towardsdatascience.com](/understanding-correlation-and-diversification-661c19a26555) 

# 最优投资组合

因此，最优投资组合是以这样一种方式组合我们的候选资产，即对于给定的风险水平，投资组合获得正回报的概率最大化。

为什么在给定的风险水平下？如果我们唯一想做的事情是最大化我们的正回报概率，我们可以投资像货币市场基金这样的超低风险资产。从技术上来说，我们几乎可以保证赚钱，但那只是几个便士。记住你需要承担一些风险来获得回报。

相反，我们希望(尽可能)确定的是，对于特定的风险水平，我们投资的投资组合能够最大化我们获得正回报的机会。做到这一点的投资组合，也称为最优投资组合，是预期回报率最高的投资组合(或者用统计学术语来说，是 Z 值最高的投资组合)。

所以我们需要解决的优化问题是:

```
For a given level of risk, solve for the weights, W, that:**Maximize W.T @ E****Subject to:
  W.T @ Cov @ W = (target risk)^2 
  and sum(W) = 1**Where **W** is a vector representing the weights of the asset in our portfolio.
**E** is a vector representing the expected returns of the asset.
**Cov** is the covariance matrix of the asset's returns.
**@** denotes matrix multiplication.
**.T** denotes the transpose operation.
```

简单地说，我们希望在以下条件下最大化预期收益(W.T @ E ):

1.  投资组合方差(W.T @ Cov @ W)等于目标方差。记住方差是风险的平方(因为风险等于标准差)。这就是让我们达到特定风险目标的约束。
2.  权重总和为 1。在这种情况下，我们允许短重(负重量)。如果我们不想要负权重，我们需要添加一个额外的约束。如果我们没有这个条件，优化就会炸或者吐槽乱码。

我们可以用两种方法来解决这个问题——用优化器或者分析方法。允许卖空的投资组合优化的酷之处在于，它有一个解析解，我们只需要一些矩阵代数就可以实现。

# 直到下次

这就是本文的全部内容。我已经写了一些代码来分析性地运行优化。但是我想让这篇文章停留在概念层面。代码和例子将在以后的文章中发布！在那之前干杯！

***下一部分:***

[](/portfolio-optimization-with-numpy-93e1428525a5) [## 基于 NumPy 的投资组合优化

### 你所需要的只是一些矩阵代数来做出最优投资组合

towardsdatascience.com](/portfolio-optimization-with-numpy-93e1428525a5)