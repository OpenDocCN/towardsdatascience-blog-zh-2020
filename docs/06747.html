<html>
<head>
<title>Scikit-learn Linear Regression for Predicting Golf Performance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Scikit-learn预测高尔夫表现的线性回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/scikit-learn-linear-regression-for-predicting-golf-performance-c92f31b69f92?source=collection_archive---------64-----------------------#2020-05-26">https://towardsdatascience.com/scikit-learn-linear-regression-for-predicting-golf-performance-c92f31b69f92?source=collection_archive---------64-----------------------#2020-05-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="318c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我如何建立一个简单的工具来帮助玩家理解他们使用数据的技能。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/971eefefc7b15f9aeda60673b4774bd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NHd-uJ3nAOxwopsxEI0kxw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">资料来源:Unsplash/andrewricegolf</p></figure><p id="2d87" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作为努力提高我的高尔夫球水平的一部分，我在过去的一年里一直在跟踪我在比赛关键领域的数据。当我在一轮结束时计算我的分数时，我也会计算推杆数、果岭数和球道数。这并不需要太多的努力，但它可以告诉你很多关于你的游戏需要练习的地方。</p><p id="5eb9" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在General Assembly上数据科学课程时，我决定将我的最终项目集中在我收集的数据上。我使用Python中的Scikit-learn库构建了一个线性回归模型，该模型可以预测您的高尔夫表现。并且，我将我构建的模型打包在一个简单的Flask web应用程序中，该应用程序可以部署到Heroku以方便访问。<a class="ae lu" href="https://github.com/mvrahas/scorepredictor" rel="noopener ugc nofollow" target="_blank">可在Github上获得</a></p><p id="f280" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我构建的模型侧重于两个主要用例…</p><p id="3243" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">根据分数预测统计数据</strong></p><p id="110e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">高尔夫球手通常会围绕他们想要打出的分数为自己设定目标。也许他们希望能够在资格赛中晋级，减少他们的障碍，或者只是打出他们个人的最好成绩。这个工具接受一个得分输入，并输出一个得分所需的平均统计预测。例如，如果你的目标是突破80，这个工具可以给你具体的目标来实现它。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/c3779504e6e4c234980a86975a5cdfe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i08dlrYbOpfqynQXl2cQPA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在模型中输入分数79时的示例输出。</p></figure><p id="9c79" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">根据数据预测得分</strong></p><p id="b6c7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于高尔夫球手来说，了解自己的技术水平很重要，这样他们就可以管理对高尔夫球场的期望，避免不必要的风险。这是帮助高尔夫球手计划比赛的有用工具。它以数据为输入，预测你最有可能投篮的得分。例如，如果你要去一个困难的球场，只希望打5个果岭，你可以生成一个得分预测，以了解你在那里可能会打出什么。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/37d4f48c4bd3d31b7d073930a499b88f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i75yYPnANVbXpWP54ixhVQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">向模型中输入特定统计数据时的示例输出。</p></figure><p id="1fba" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以用数据来理解导致高分的行动。它可以帮助我们建立具体的目标，我们需要实现，以拍摄我们想要的分数。我们可以想出一个具体的计划来打出一个低分，而不是专注于短暂的挥杆想法，比如“低头”或“坚持到底”。例如，我们可以通过每次瞄准果岭的中心来制定击中更多果岭的具体计划。</p><h1 id="9fa6" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">构建模型</h1><p id="7c1d" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">我用自己高尔夫比赛的数据开发了一个线性模型来预测数据和分数。我的数据集中的每个样本都代表我玩的一轮游戏，并对这一轮游戏进行统计。请参阅每个功能的以下定义…</p><ul class=""><li id="72ee" class="mt mu it la b lb lc le lf lh mv ll mw lp mx lt my mz na nb bi translated">得分(整数):一轮击球的总次数</li><li id="fa14" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">果岭数(整数):规则中的果岭数(共18个)</li><li id="ed82" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">推杆(整数):一轮推杆的总数</li><li id="6028" class="mt mu it la b lb nc le nd lh ne ll nf lp ng lt my mz na nb bi translated">球道(INT):一轮比赛中击中球道的总数</li></ul><p id="22cf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在散点图上画出这些分数后，根据我对游戏的体验，这些趋势是有意义的。随着你推球次数的增加，你的分数也会上升。随着你击中果岭数量的增加，你的分数会下降。击中球道的次数和你的得分之间的相关性较小。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/df5af44522a451820c5e248d535eb1cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mF_7DJgqJjgjFMNQsYb6nA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">N=13个样本</p></figure><p id="5b22" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了让数据代表更大范围的分数，我添加了来自PGA巡回赛数据集的样本。数据集中的每个样本都代表了一名职业巡回赛选手，以及他们在2010年至2018年期间在比赛各个领域的平均统计数据。原始数据集包含数千个值，但我随机抽取了10个值来代表得分范围在69到75之间的玩家。在将职业统计数据添加到我的个人数据集中之后，我重新创建了散点图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/bbbe7ba7dcc8d9c71d30a04547a0f863.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eNESXdwAjdTvkwVreiU1_Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">N=23个样本</p></figure><p id="445c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为统计数据似乎都与分数有线性关系，所以我选择用线性模型来拟合数据，这种模型训练速度快，解释简单，方差低，这意味着不管输入的数据是什么，它都会预测类似的结果。线性模型的缺点是，它可能比最先进的建模技术更有偏差。</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="482a" class="no lx it nk b gy np nq l nr ns">from sklearn.linear_model import LinearRegression<br/>from sklearn.model_selection import cross_validate, KFold</span><span id="676f" class="no lx it nk b gy nt nq l nr ns">def fit_and_score_linear_model(data,target):<br/>    <br/>    # Define features<br/>    features = ['Putts','Fairways','Greens']<br/>    X = data[features]<br/>    y = data[target]<br/>    <br/>    # Fit linear regression model<br/>    lr = LinearRegression()<br/>    lr.fit(X,y)<br/>    y_pred = lr.predict(X)<br/>    r2 = lr.score(X,y)<br/>    <br/>    # Cross validate model<br/>    kf = KFold(n_splits = 5, shuffle=True, random_state=24)<br/>    cv_results = cross_validate(lr,X,y,scoring='r2',cv=kf)<br/>    <br/>    print('r2 training: '+str(r2))<br/>    print('r2 cross val: ' +str(cv_results['test_score'].mean()))<br/>    <br/>    return {'model':lr, 'predicted': y_pred}</span></pre><p id="1708" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我从Scikit-learn导入了线性回归模型，并构建了一个函数来用数据拟合模型，打印训练分数，并打印5倍的交叉验证分数。仅用我的个人数据运行该函数，我得到了以下准确度值…</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="1bab" class="no lx it nk b gy np nq l nr ns">r2 training: 0.5005286435494004<br/>r2 cross val: -2.370294280122853</span></pre><p id="11d5" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">用我的个人数据结合专业数据运行该函数，我得到了以下准确度值…</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="4a5e" class="no lx it nk b gy np nq l nr ns">r2 training: 0.9205079679115369<br/>r2 cross val: 0.8118472290929108</span></pre><p id="9053" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">加入职业高尔夫球手的数据后，R2值显著增加。这可能是因为目标变量的差异更大，或者为模型学习正确的关系提供了更多的数据。在打印出我拟合的线性模型的系数后，我能够将下面的等式放在一起，以表示一名球员基于推杆、球道和果岭击球的总分。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/9abac2272df55fa83055dcda6ecec4ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*As3U6WSaVTAgzi0MfJdnoA.png"/></div></figure><p id="ae2b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了创建一个基于输入I得分预测统计数据的工具，我用相同的数据拟合了多个不同的线性模型。我没有使用Score作为目标变量，而是使用它作为唯一的特征，将每个单独的stat作为目标变量。结果是推杆、球道和果岭的3个线性模型，分别以0.44、0.33和0.83的训练R2精度拟合数据。我又一次打印出了系数，将基于分数预测不同统计数据平均值的方程放在一起。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/ddabb2d51339a0a7696746c0814e1500.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*HRtgiZ-SCktnj3Jiubz8Lw.png"/></div></figure><h1 id="29c9" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结论和后续步骤</h1><p id="4aaf" class="pw-post-body-paragraph ky kz it la b lb mo ju ld le mp jx lg lh mq lj lk ll mr ln lo lp ms lr ls lt im bi translated">这种模式在未来有几个方面可以改进或扩展。</p><p id="10de" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">更多数据-样本量较小，这导致在尝试交叉验证模型和寻找样本外精度时结果不一致。根据为我的KFolds交叉验证选择的数据子集，这些值会发生显著变化。</p><p id="f617" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">代表所有高尔夫球员-用于训练模型的数据仅代表我的技能和巡回赛职业的技能，在数据集中留下了很大的差距。该模型需要来自射击在75-80之间的高级玩家和射击超过100的初学者的额外样本。填补这一空白可以让我探索不同的模型，可能会导致更准确的预测。</p><p id="554b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一致的抽样方法——我的个人得分数据是以不同于职业得分数据的方式收集的。职业得分的每个样本都是多轮统计的平均值。我的每个分数样本代表了我玩的一个特定回合。取平均值可以消除数据中的重要差异，这些差异可用于做出更准确的预测。</p><p id="a755" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">更多功能—有可能创建/修改与分数更密切相关的功能。例如，不是所有的球场都有相同数量的球道。通过创建一个详细描述球场上球道数量的特征，我们可以将球道统计数据转换成一个百分比而不是一个绝对数字。</p></div></div>    
</body>
</html>