<html>
<head>
<title>How to turn your webcam into a Motion Detect controller</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将您的网络摄像头变成运动检测控制器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-turn-your-webcam-into-a-motion-detect-controller-9d4e9945644c?source=collection_archive---------22-----------------------#2020-04-28">https://towardsdatascience.com/how-to-turn-your-webcam-into-a-motion-detect-controller-9d4e9945644c?source=collection_archive---------22-----------------------#2020-04-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3a2c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何使用JavaScript实现运动检测的完整指南，构建一个虚拟鼓，你只需在空中挥舞双手就可以演奏。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/46b8f12c4d7f0225e0b0b09abeeb2c53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O7xvQehHAzvf-Cqwtz210Q.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://bensonruan.com/motion-detection-play-drums-with-webcam/" rel="noopener ugc nofollow" target="_blank">bensonruan.com</a></p></figure><p id="689d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你玩过带运动传感器的Xbox游戏吗？在电子游戏中，只要挥动手臂去打网球就感觉很酷。运动检测是让这一奇迹发生的技术，它可以检测到物体相对于其周围环境的位置变化。</p><p id="964f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这篇文章中，让我们来找点乐子。我打算建一个虚拟的鼓乐场，让你只需在空中挥舞双手就能敲鼓。它不需要任何运动传感器，只需要打开电脑或手机上的摄像头。</p><p id="326e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是虚拟鼓游乐场的演示。正如你所看到的，当鼓和钹在那个区域探测到显著的运动时，它就会演奏。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/7a056811ae6ecaa8eeffcaba1e5edce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*jxFoLvNLXK28wpcY826MrA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:<a class="ae ky" href="https://bensonruan.com/motion-detection-play-drums-with-webcam/" rel="noopener ugc nofollow" target="_blank">bensonruan.com</a></p></figure><p id="71ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">点击下面的链接亲自尝试一下:</p><div class="lw lx gp gr ly lz"><a href="https://bensonruan.com/motion-detection-play-drums-with-webcam/" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">运动检测-使用网络摄像头播放鼓声- Benson技术</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">你玩过带运动传感器的Xbox游戏吗？挥动手臂击球的感觉真酷…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">bensonruan.com</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn ks lz"/></div></div></a></div></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="3ccb" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">履行</h1><p id="2b51" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">你玩得开心，像摇滚明星一样一直打鼓吗？你好奇这种神奇是怎么发生的吗？我首先受到了这个<a class="ae ky" href="https://soundstep.github.io/magic-xylophone/app/index.html" rel="noopener ugc nofollow" target="_blank">木琴</a>版本的启发，然后建立了我的上面的鼓版本。下面跟随我实现这个虚拟鼓游乐场的旅程。</p><h2 id="35a1" class="ns mw it bd mx nt nu dn nb nv nw dp nf li nx ny nh lm nz oa nj lq ob oc nl od bi translated">#步骤1:将网络摄像头传输到浏览器</h2><p id="f92c" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">为了让你的网络摄像头进入浏览器，我使用了JavaScript库<code class="fe oe of og oh b">navigator.mediaDevices.getUserMedia</code>。要了解更多细节，请参考我之前的博客:</p><div class="lw lx gp gr ly lz"><a href="https://medium.com/swlh/how-to-access-webcam-and-take-picture-with-javascript-b9116a983d78" rel="noopener follow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">如何使用JavaScript访问网络摄像头并拍照</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">介绍网络摄像头-简易npm模块</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">medium.com</p></div></div><div class="mi l"><div class="oi l mk ml mm mi mn ks lz"/></div></div></a></div><h2 id="9b4a" class="ns mw it bd mx nt nu dn nb nv nw dp nf li nx ny nh lm nz oa nj lq ob oc nl od bi translated">#步骤2:标记每个滚筒区域</h2><p id="ba46" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">用鼓和钹的图像覆盖网络摄像头。这是为了在网络摄像头中设置目标区域，以便每当在这些区域检测到重大运动时，它就会触发播放齿轮的效果。</p><p id="bb72" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> HTML </strong></p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><p id="4a91" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> JavaScript </strong></p><p id="3cf5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过齿轮的(x，y，宽度，高度)来存储齿轮的位置，请注意，宽度和高度需要通过全屏相机大小和混合画布大小之间的比率来计算。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><h2 id="b561" class="ns mw it bd mx nt nu dn nb nv nw dp nf li nx ny nh lm nz oa nj lq ob oc nl od bi translated">#步骤3:加载声音音频</h2><p id="7dc5" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">为了演奏鼓和钹，我们需要加载这些乐器的音频声道文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><h2 id="b2e6" class="ns mw it bd mx nt nu dn nb nv nw dp nf li nx ny nh lm nz oa nj lq ob oc nl od bi translated">#步骤4:通过混合模式差异进行运动检测</h2><p id="ccba" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">这是进行运动检测的最重要的部分。它使用了一种叫做<code class="fe oe of og oh b">Blend Mode Difference</code>的技术。</p><p id="3713" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，我来解释一下混合模式差异的概念。想象你拍了一张照片，半秒钟后又拍了一张，如果在那半秒钟内没有任何东西移动，那两张照片会完全一样。当你减去这两张图片的像素值时，它将全是0，混合图像将完全是黑色的。如果在某些区域有移动，混合图像将突出显示差异。</p><p id="2140" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有关更多详细信息，请参考下面的文章:</p><div class="lw lx gp gr ly lz"><a href="https://www.adobe.com/devnet/archive/html5/articles/javascript-motion-detection.html" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">JavaScript运动检测</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">了解如何使用HTML5、JavaScript和jQuery来检测网络摄像头流的移动，并对用户做出实时反应…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">www.adobe.com</p></div></div><div class="mi l"><div class="ol l mk ml mm mi mn ks lz"/></div></div></a></div><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oj ok l"/></div></figure><h2 id="2760" class="ns mw it bd mx nt nu dn nb nv nw dp nf li nx ny nh lm nz oa nj lq ob oc nl od bi translated">#第五步:播放效果和声音</h2><p id="3b8a" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">我们为网络摄像头视频的每一帧反复调用以下函数进行运动检测。</p><pre class="kj kk kl km gt om oh on oo aw op bi"><span id="3ee4" class="ns mw it oh b gy oq or l os ot"><strong class="oh iu">function</strong><strong class="oh iu"> </strong><strong class="oh iu">update()</strong> {<br/>  drawVideo();<br/>  blend();<br/>  checkAreas();<br/>  <strong class="oh iu">window.requestAnimationFrame(update);</strong><br/>}</span></pre><p id="21c7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在鼓和钹的区域内，如果它检测到帧之间的显著差异，则表明该区域有运动。然后我们播放相应档位的效果和声音。</p><pre class="kj kk kl km gt om oh on oo aw op bi"><span id="6cd8" class="ns mw it oh b gy oq or l os ot">while (i &lt; (blendedData.data.length * 0.25)) {<br/>  <strong class="oh iu">average += (blendedData.data[i*4] + blendedData.data[i*4+1] + blendedData.data[i*4+2]) / 3;</strong><br/>  ++i;<br/>}<br/>average = Math.round(average / (blendedData.data.length * 0.25));<br/><strong class="oh iu">if (average &gt; 20)</strong> { //over a threshold, means significant movement<br/>  playHover(drum);          <br/>}</span></pre><p id="4d37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码就这么多了。让我们享受和玩一些疯狂的鼓！</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="94f1" class="mv mw it bd mx my mz na nb nc nd ne nf jz ng ka nh kc ni kd nj kf nk kg nl nm bi translated">GitHub知识库</h1><p id="4f97" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">您可以通过下面的链接下载上述演示的完整代码:</p><div class="lw lx gp gr ly lz"><a href="https://github.com/bensonruan/Motion-Detection-Virtual-Drums" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd iu gy z fp me fr fs mf fu fw is bi translated">Benson Ruan/运动检测-虚拟鼓</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">从网络摄像头检测动作，通过在空中挥舞双手来玩虚拟鼓。</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">github.com</p></div></div><div class="mi l"><div class="ou l mk ml mm mi mn ks lz"/></div></div></a></div></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/e009f764c451b704ad32176857f2e2a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*YYOa-lY4lq689p9x"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@jaden_hatch?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰登哈奇</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><h1 id="b4bb" class="mv mw it bd mx my ow na nb nc ox ne nf jz oy ka nh kc oz kd nj kf pa kg nl nm bi translated">结论</h1><p id="7043" class="pw-post-body-paragraph kz la it lb b lc nn ju le lf no jx lh li np lk ll lm nq lo lp lq nr ls lt lu im bi translated">如今，运动检测已经应用于许多领域，例如安全警报、自动门……有些与传感器一起工作，有些可能基于计算机视觉目标检测。毕竟，我希望你觉得这个虚拟鼓游乐场有趣，并激起你对最新技术的兴趣。</p><p id="9196" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果你喜欢这篇文章，请在LinkedIn或Twitter上分享。如果你有任何问题，请在评论中告诉我。在<a class="ae ky" href="https://github.com/bensonruan/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>和<a class="ae ky" href="https://www.linkedin.com/in/benson-ruan/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>上关注我。</p></div></div>    
</body>
</html>