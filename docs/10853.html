<html>
<head>
<title>One liner Machine learning and Deep Learning using Libra</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Libra 的线性机器学习和深度学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-and-deep-learning-in-one-liner-using-libra-7eef4023618f?source=collection_archive---------58-----------------------#2020-07-28">https://towardsdatascience.com/machine-learning-and-deep-learning-in-one-liner-using-libra-7eef4023618f?source=collection_archive---------58-----------------------#2020-07-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c56c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">自动化机器学习和深度学习理解 Libra 的完全指南。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7975d3e931e0883b7ebfcfefbe47b753.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bNL-T2BzjhFBuzOlLFZCpQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@brett_jordan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">布雷特·乔丹</a>在<a class="ae kv" href="https://unsplash.com/s/photos/robot?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="5482" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">随着机器学习的兴起，我们看到了许多伟大的框架和库的兴起，如 sci-kit learn、Tensorflow、Pytorch。这些框架使得用户可以更容易地创建机器学习模型。但是仍然需要遵循整个过程，包括数据准备、建模和评估。数据准备包括数据清洗和预处理。建模接受预处理的数据，并使用算法来预测结果。评估为我们提供了一个衡量算法性能的方法。由于这些库和框架，我们写所有东西的时间减少了，但是我们仍然需要写少量的代码。</p><blockquote class="ls"><p id="30fa" class="lt lu iq bd lv lw lx ly lz ma mb lr dk translated">"机器智能是人类需要创造的最后一项发明."尼克·博斯特伦</p></blockquote><p id="055d" class="pw-post-body-paragraph kw kx iq ky b kz mc jr lb lc md ju le lf me lh li lj mf ll lm ln mg lp lq lr ij bi translated">在令人惊叹的开源社区的帮助下，这个领域的进步与日俱增，这些社区催生了现有的框架。想象一个在一行中完成上述所有过程的框架。是的，你没看错，现在你也可以这么做了。Libra 是一个框架，它在一行中为你做了这些工作。即使对于非技术人员来说，它也很容易使用。Libra 需要最少的平均行数来训练模型。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/6c6430653a844981aa2e28ad21870c7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*86rk_JnbAh40DzTo5zl_ZQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片取自<a class="ae kv" href="https://libradocs.github.io/index.html" rel="noopener ugc nofollow" target="_blank">文档</a></p></figure><p id="0380" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇博客中，我将给出如何使用天秤座的完整指导。我将针对不同的问题采用不同的数据集，并向您展示一步一步的方法。</p><h1 id="dc6e" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">使用 Libra 检测信用卡欺诈</h1><p id="106d" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">我已经使用 Kaggle 数据集来预测信用卡欺诈。该数据已经经过主成分分析，因此与原始数据相比，它现在减少到更少的维度数据。解决这个问题需要遵循一个系统的方法。一般来说，你会按照第一段提到的顺序。但是和天秤座在一起，就不用担心这个了。</p><p id="26d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据集的链接<code class="fe nf ng nh ni b">https:/<a class="ae kv" href="https://colab.research.google.com/drive/1khr-nqQVkP_XMUQ5y8GWrK5AUS41lyzC#" rel="noopener ugc nofollow" target="_blank">/www.kaggle.com/mlg-ulb/creditcardfraud</a></code></p><p id="6158" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该数据中的大多数交易在 99.83%的时间内是非欺诈性的，而欺诈性交易在数据集中的 0.17%的时间内发生。这意味着数据是高度不平衡的。让我们看看 Libra 对数据的预处理有多好，并给出结果。</p><h2 id="797b" class="nj mj iq bd mk nk nl dn mo nm nn dp ms lf no np mu lj nq nr mw ln ns nt my nu bi translated">安装 Libra</h2><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="f22c" class="nj mj iq ni b gy nz oa l ob oc">pip install -U libra</span></pre><h2 id="4059" class="nj mj iq bd mk nk nl dn mo nm nn dp ms lf no np mu lj nq nr mw ln ns nt my nu bi translated">从 libra 导入客户端</h2><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="b769" class="nj mj iq ni b gy nz oa l ob oc">from libra import client</span></pre><h2 id="6c68" class="nj mj iq bd mk nk nl dn mo nm nn dp ms lf no np mu lj nq nr mw ln ns nt my nu bi translated">利用天秤座</h2><p id="c20a" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">一切都是围绕客户机对象构建的。您可以对它调用不同的查询，所有内容都将存储在对象的 models 字段下。</p><p id="c7e0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们在客户机对象中传递文件的位置，并将其命名为 newClient。现在要访问各种查询，请参考文档。我在这里使用决策树。英语中的指令是一个陈述，代表你想要完成的任务。比如预测房子价值中位数，或者请估计一下家庭人数。否则，该指令应该对应于数据集中的一列。Libra 自动检测目标列，但是为了确保它选择了正确的列，我传递了目标列名。</p><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="8c69" class="nj mj iq ni b gy nz oa l ob oc">newClient = client('creditcard.csv')</span><span id="3b5b" class="nj mj iq ni b gy od oa l ob oc">newClient.decision_tree_query('Class')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/fcca898775422c516d657d4ed363ba79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*dlptF7d8g8NM6X9ZxvmKww.png"/></div></figure><p id="a7b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅用两行代码，我们就获得了大约 0.99 的分数，这是我们能得到的最好分数。如果您查看其他内核，您会发现只有少数人获得了 0.99 的精度，并且他们需要花费数小时来预处理数据并为其编写代码。那样的话，天秤座为你节省了很多时间，给了你最好的结果。Libra 使用智能预处理，这样你就不需要自己预处理数据了。</p><h2 id="568c" class="nj mj iq bd mk nk nl dn mo nm nn dp ms lf no np mu lj nq nr mw ln ns nt my nu bi translated">你不需要担心分析结果。</h2><p id="c112" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">newClient.analyze()为所有分类问题创建混淆矩阵和 ROC 曲线。它还计算召回率、精确度、f1 和 f2 分数。</p><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="13c1" class="nj mj iq ni b gy nz oa l ob oc">newClient.analyze()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/327be1b8a4891e8c8a8f5bc6910990f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*uGuKjN3CPDXVW9pIK8urSg.png"/></div></figure><p id="9be5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">newClient.info()返回所有键，代表为数据集生成的每一类数据。</p><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="cb04" class="nj mj iq ni b gy nz oa l ob oc">newClient.info()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/0b92097b06a6f016ca48e89bcf017b3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rdIMer2YgYFoOfaOAxLqvA.png"/></div></div></figure><p id="7aaf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">newClient.model()返回该模型的字典。它包括从准确度、精确度、召回率、F1 分数到所有预处理技术的一切。对于已经了解这些概念并能编码的人更有帮助。非技术用户无需担心这一点。</p><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="b9cb" class="nj mj iq ni b gy nz oa l ob oc">newClient.model()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/0a8ad31e12471b5a2a7c45c977427b6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uj_VIe8Dywy5KJidtOe9Yg.png"/></div></div></figure><h2 id="f621" class="nj mj iq bd mk nk nl dn mo nm nn dp ms lf no np mu lj nq nr mw ln ns nt my nu bi translated">访问模型</h2><p id="5a08" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">返回一个字典，如果你想访问模型，你可以直接使用 newClient.model()['model']</p><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="3af5" class="nj mj iq ni b gy nz oa l ob oc">newClient.model()['model']</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/59c2e23b5c34ceb61aebbd73786b093d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ehlPbBkQWaEFtQSIsQ4SQQ.png"/></div></div></figure><h1 id="2f16" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">使用 Libra 的卷积神经网络</h1><p id="a49d" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">使用下面的代码在 colab 笔记本上下载 Laurence Moroney 的石头、纸、剪刀数据集。我可以直接向您展示使用 Libra 创建 CNN 的代码，但是我想创建一个示例，您可以在自己的 colab 笔记本中尝试，以便更好地理解。你不需要担心下面的代码。</p><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="11d3" class="nj mj iq ni b gy nz oa l ob oc">!wget --no-check-certificate \</span><span id="f4db" class="nj mj iq ni b gy od oa l ob oc">https://storage.googleapis.com/laurencemoroney-blog.appspot.com/rps.zip \</span><span id="ac46" class="nj mj iq ni b gy od oa l ob oc">-O /tmp/rps.zip</span><span id="0c18" class="nj mj iq ni b gy od oa l ob oc">!wget --no-check-certificate \</span><span id="d1a5" class="nj mj iq ni b gy od oa l ob oc">https://storage.googleapis.com/laurencemoroney-blog.appspot.com/rps-test-set.zip \</span><span id="e2a6" class="nj mj iq ni b gy od oa l ob oc">-O /tmp/rps-test-set.zip</span></pre><p id="500b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用下面的代码提取下载的文件。</p><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="f9cc" class="nj mj iq ni b gy nz oa l ob oc">import os</span><span id="796d" class="nj mj iq ni b gy od oa l ob oc">import zipfile</span><span id="8297" class="nj mj iq ni b gy od oa l ob oc">local_zip = '/tmp/rps.zip'</span><span id="8515" class="nj mj iq ni b gy od oa l ob oc">zip_ref = zipfile.ZipFile(local_zip, 'r')</span><span id="cb0e" class="nj mj iq ni b gy od oa l ob oc">zip_ref.extractall('/tmp/')</span><span id="04d9" class="nj mj iq ni b gy od oa l ob oc">zip_ref.close()</span><span id="9c97" class="nj mj iq ni b gy od oa l ob oc">local_zip = '/tmp/rps-test-set.zip'</span><span id="31a6" class="nj mj iq ni b gy od oa l ob oc">zip_ref = zipfile.ZipFile(local_zip, 'r')</span><span id="c13d" class="nj mj iq ni b gy od oa l ob oc">zip_ref.extractall('/tmp/')</span><span id="32b3" class="nj mj iq ni b gy od oa l ob oc">zip_ref.close()</span></pre><p id="6e03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用下面的代码创建文件夹，并将提取的图像放入其中。</p><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="c7db" class="nj mj iq ni b gy nz oa l ob oc">rock_dir = os.path.join('/tmp/rps/rock')</span><span id="0a29" class="nj mj iq ni b gy od oa l ob oc">paper_dir = os.path.join('/tmp/rps/paper')</span><span id="eb56" class="nj mj iq ni b gy od oa l ob oc">scissors_dir = os.path.join('/tmp/rps/scissors')</span><span id="bf8d" class="nj mj iq ni b gy od oa l ob oc">print('total training rock images:', len(os.listdir(rock_dir)))</span><span id="829d" class="nj mj iq ni b gy od oa l ob oc">print('total training paper images:', len(os.listdir(paper_dir)))</span><span id="c975" class="nj mj iq ni b gy od oa l ob oc">print('total training scissors images:', len(os.listdir(scissors_dir)))</span><span id="36f3" class="nj mj iq ni b gy od oa l ob oc">rock_files = os.listdir(rock_dir)</span><span id="d840" class="nj mj iq ni b gy od oa l ob oc">print(rock_files[:10])</span><span id="5996" class="nj mj iq ni b gy od oa l ob oc">paper_files = os.listdir(paper_dir)</span><span id="e5b3" class="nj mj iq ni b gy od oa l ob oc">print(paper_files[:10])</span><span id="70e7" class="nj mj iq ni b gy od oa l ob oc">scissors_files = os.listdir(scissors_dir)</span><span id="168a" class="nj mj iq ni b gy od oa l ob oc">print(scissors_files[:10])</span></pre><p id="aa04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图显示了数据集的相关信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/16b04a62ee7f88a32487a991483cdaac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7PeobVaYzYHXjOfFYsxV4A.png"/></div></div></figure><p id="2c28" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用下面的代码，你可以创建 CNN。数据将通过缩放、剪切、翻转和重缩放自动增加。然后将选择最佳的图像尺寸。您还会注意到每个类中图像的数量以及与之相关的类的数量。最后，你还会观察训练精度和测试精度。</p><p id="b5c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还可以在 convolutional _ query 内部传递<strong class="ky ir">read _ mode</strong>hyper-parameter，在其中可以指定读取模式。允许三种读取模式。我将一一描述它们。默认情况下<strong class="ky ir">read _ mode = distinguisher()</strong>自动检测数据的类型。允许的三种读取模式是:</p><h2 id="dbd4" class="nj mj iq bd mk nk nl dn mo nm nn dp ms lf no np mu lj nq nr mw ln ns nt my nu bi translated">1.Setwise</h2><p id="ce39" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">目录由“训练集”和“测试集”文件夹组成，这两个文件夹都包含分类文件夹，文件夹内有图像。[1]</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/5f944b3116db5d5b023a22770cfa3aac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*W1Vm7UBACPKRn5TG-KYuJw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片取自<a class="ae kv" href="https://libradocs.github.io/index.html" rel="noopener ugc nofollow" target="_blank">文档</a></p></figure><h2 id="c6c4" class="nj mj iq bd mk nk nl dn mo nm nn dp ms lf no np mu lj nq nr mw ln ns nt my nu bi translated">2.按类别</h2><p id="617a" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">目录由分类文件夹组成，里面有图像。[1]</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/0d2cf0685993adad5a4fa40fbe55afdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*EwhMZviHpbFfYlrpGBuIwA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片取自<a class="ae kv" href="https://libradocs.github.io/index.html" rel="noopener ugc nofollow" target="_blank">文档</a></p></figure><h2 id="fac2" class="nj mj iq bd mk nk nl dn mo nm nn dp ms lf no np mu lj nq nr mw ln ns nt my nu bi translated"><strong class="ak"> 3。CSV Wise </strong></h2><p id="6479" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">目录由图像文件夹和包含图像列的 CSV 文件组成。[1]</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/0a617200ef0980d88de5f25bd28c0d87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*mvCq38wIIKt0ss4UNk4xBw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片取自<a class="ae kv" href="https://libradocs.github.io/index.html" rel="noopener ugc nofollow" target="_blank">文档</a></p></figure><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="6dd9" class="nj mj iq ni b gy nz oa l ob oc">newClient = client('/tmp/rps')</span><span id="64d6" class="nj mj iq ni b gy od oa l ob oc">newClient.convolutional_query("Please classify my images")</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/c15c7b7b5b3215a61062b468a2c200ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*E6zd8VR1U_CHOovp8vChPA.png"/></div></figure><h1 id="19e4" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">基于 Libra 的自然语言文本分类</h1><p id="0b7b" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">对于这个问题，我使用了<a class="ae kv" href="https://www.kaggle.com/team-ai/spam-text-message-classification" rel="noopener ugc nofollow" target="_blank">垃圾短信分类</a>数据集。</p><p id="fe12" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">链接:<a class="ae kv" href="https://www.kaggle.com/team-ai/spam-text-message-classification" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/team-ai/spam-text-message-class ification</a></p><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="eceb" class="nj mj iq ni b gy nz oa l ob oc">new_client = client('SPAM text message 20170820 - Data.csv')</span><span id="4aba" class="nj mj iq ni b gy od oa l ob oc">new_client.text_classification_query('sentiment')</span><span id="690b" class="nj mj iq ni b gy od oa l ob oc">new_client.classify_text('new text to classify')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/1ef808be6ffe03e21a3b4caa0040eef4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C7_W2kcEkDtNY1A9kryq7w.png"/></div></div></figure><p id="0e63" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">new_client.classify_text()将对输入其中的文本进行分类。在上面的输出中，你可以看到它已经把我的文本归类为‘火腿’。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/c30c8ae7b844c71bb44b3ffaab65fa31.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*hoXaeYRlDO6dvzJjcDxo3g.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/6cf616555c36be88869107ac201988ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*Pz0G0W3Zzo7ULrFXJ2tEJQ.png"/></div></figure><h1 id="6da3" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">k 表示使用 Libra 进行聚类</h1><p id="6ede" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">这个问题我用的是商城客户细分数据:<a class="ae kv" href="https://www.kaggle.com/vjchoudhary7/customer-segmentation-tutorial-in-python" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/vjchoudhary 7/Customer-Segmentation-tutorial-in-python</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/71a1d36c2ec7a4dd2850ff3c6394a3b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*Ykt3FsSa-k-Phk5Ugb9X6A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">数据集的图像。</p></figure><p id="73aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码将创建一个 K 均值聚类模型，并确定最佳质心计数和优化精度，以及最佳的聚类数。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi or"><img src="../Images/fff6d2ef918332e9abdeab11a17aa5f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*Ek21ugfKCZbTmuNwiB8Mtw.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/1334448118b05a0053f0e5853e8530ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*Q75FiQmyoLrpKU1VLv4WFA.png"/></div></figure><h1 id="504e" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">使用 Libra 进行分类的神经网络</h1><p id="2e21" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">在本节中，我将使用神经网络查询进行分类。为此，我使用一个私人数据集，从大脑信号预测行为。让我们来看看它在数据集上的表现如何。</p><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="6fc0" class="nj mj iq ni b gy nz oa l ob oc">new_client = client('Mood_classification.csv')</span><span id="9ebb" class="nj mj iq ni b gy od oa l ob oc">new_client.neural_network_query('Predict the behavior')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/b92453a08623c6b8bbc872aea1efad0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fuKMQ1Su6bAMwhda1y2X9g.png"/></div></div></figure><p id="5b13" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从上面的代码中，您可以注意到模型使用的初始层数是 3。然后，它还使用根据前一层的性能而变化的不同层数来测试精度。它预测找到的最佳层数及其训练和测试精度。看起来我需要为我的数据集收集更多的数据。</p><p id="e32f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以使用 new_client.model()['model']来访问模型，并可以使用 Keras 中的 summary()函数来获得神经网络模型的摘要。</p><pre class="kg kh ki kj gt nv ni nw nx aw ny bi"><span id="8add" class="nj mj iq ni b gy nz oa l ob oc">new_client.model()['model'].summary()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi or"><img src="../Images/d359c935946a483bd426a02f17fd3e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*yEcyPWNrwZlFp25CKdHuUQ.png"/></div></figure><h1 id="8208" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">结论</h1><p id="aa99" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">天秤座是一个非常有趣的框架，每天都在进步。该框架让我们大致了解了数据科学领域的发展速度，也让我们看到了该领域可能出现的变化类型。他们还为现有的数据科学家添加功能，以修改现有的神经网络，并在指定的索引处添加像 LSTM 这样的层。这个框架带来的概念让我兴奋不已。你也可以在 Github 上投稿。</p><h1 id="ca31" class="mi mj iq bd mk ml mm mn mo mp mq mr ms jw mt jx mu jz mv ka mw kc mx kd my mz bi translated">参考资料:</h1><p id="4a51" class="pw-post-body-paragraph kw kx iq ky b kz na jr lb lc nb ju le lf nc lh li lj nd ll lm ln ne lp lq lr ij bi translated">[1] Libra，文献(2020)，<a class="ae kv" href="http://libradocs.github.io" rel="noopener ugc nofollow" target="_blank">资料来源</a></p></div></div>    
</body>
</html>