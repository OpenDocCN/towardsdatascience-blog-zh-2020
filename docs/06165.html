<html>
<head>
<title>Automate the Machine Learning Model Implementation with Sklearn Pipeline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用Sklearn管道实现机器学习模型的自动化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automate-the-machine-learning-model-implementation-with-sklearn-pipeline-2ef1389062c9?source=collection_archive---------69-----------------------#2020-05-18">https://towardsdatascience.com/automate-the-machine-learning-model-implementation-with-sklearn-pipeline-2ef1389062c9?source=collection_archive---------69-----------------------#2020-05-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5967" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在本教程中，我们将了解如何加快机器学习算法开发中的模型实现步骤。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7ef447d1009a8bf71369915563aca99b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YblcI2tzILPfhbCTmXOm3Q.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com/@hiteshchoudhary?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kv" href="https://unsplash.com/@hiteshchoudhary?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Hitesh Choudhary </a>拍摄的照片</p></figure><p id="a3ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很多时候，在处理机器学习问题时，我们会遇到这样的机器学习任务，我们希望预处理我们的数据，并用不同的分类器测试我们的模型，以选择最佳的一个。在这种情况下，在训练数据上单独拟合每个分类器，然后测试模型是非常繁琐的，更不用说还涉及到大量的冗余编码。此外，如果您的算法涉及交叉验证，并且您的预处理步骤涉及规范化或标准化等操作，则在学习之前对完整的训练集执行规范化或标准化将会影响测试集的规模。如果所有这些问题都有一个单一的解决方案，那不是很好吗？</p><p id="3a60" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">嗯，有！Scikit-Learn有一个管道模块，它提供了解决上述问题的简单方法。</p><blockquote class="ls lt lu"><p id="1a0c" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><a class="ae kv" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html" rel="noopener ugc nofollow" target="_blank"> <em class="iq"> Pipeline是一个按顺序应用一系列变换和一个最终估计器的函数。管道的目的是组装几个步骤，这些步骤可以在设置不同参数的同时进行交叉验证。</em> </a></p></blockquote><p id="3a2c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们来看一个实现，它将展示我们如何使用管道来简化手头的任务。</p><p id="41e5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我将使用Iris数据集，将其标准化，并测试分类器的数量，以查看哪一个给出了最佳结果。在这里，我将使用KNN、SVM、随机森林和逻辑回归来测试算法。</p><p id="5366" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我们需要导入所有需要的模块。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="32da" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们将从Scikit-Learn导入Iris数据集，并将其分成训练集和测试集。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="6776" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们将从Scikit-Learn中列出分类器名称及其各自的功能。最后，把它们连在一起。这一步将确保我们将所有分类器连同它们的名称一起一次性传递给我们的管道函数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="a727" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里需要注意的一点是，我们将为所有分类器的所有超参数选择默认值。</p><p id="a14e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，我们将定义将分类器的zip以及训练和测试数据作为输入的函数，准备带有分类器的Standardscalar管道，并将管道的结果馈送到我们稍后将定义的<strong class="ky ir"> <em class="lv"> fit_classifier() </em> </strong>函数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="37a6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们定义前面提到的<strong class="ky ir"> <em class="lv"> fit_classifier() </em> </strong>函数。该功能接收管道和列车测试数据。它用<strong class="ky ir"> <em class="lv"> pipeline.fit() </em> </strong>拟合管道来训练数据，计算预测和准确度分数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="3dfb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在是时候测试我们的算法了。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="c0db" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">运行上面的行之后，我们得到以下结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mb"><img src="../Images/7b122ef1223c38fb9490c25e3fd6113b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PoMtO7x1UaHTwuKqcySzIQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">分类器和准确度分数</p></figure><p id="a1e1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们将看到分类器及其各自的准确度分数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="0687" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的运行给出了以下结果。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mc"><img src="../Images/3bcde4ecccc8c00d9b0a33f73660bb91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iSybs6di4bunaiqX35q7zA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">决赛成绩</p></figure></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="edb1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你有它！我们刚刚看到Scikit-Learn的管道功能如何让生活变得更简单。</p><p id="4687" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">如果你觉得有用，不妨在这里</strong>  <strong class="ky ir">多看看我的文章</strong> <a class="ae kv" href="https://medium.com/@agastidukare" rel="noopener"> <strong class="ky ir">。</strong></a></p><p id="20f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你有什么建议，请在评论里告诉我。</p></div></div>    
</body>
</html>