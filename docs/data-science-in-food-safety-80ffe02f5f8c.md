# 食品安全中的数据科学

> 原文：<https://towardsdatascience.com/data-science-in-food-safety-80ffe02f5f8c?source=collection_archive---------70----------------------->

## MDX 食品安全黑客马拉松

![](img/be196ce0d4ab05c879304b62e6fb39f1.png)

大卫·坎特利在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上拍摄的照片

[](https://github.com/aastha12/MDX-Food-Safety-Hackathon) [## aastha 12/MDX-食品安全-黑客马拉松

### 这个知识库是我提交给迪拜米德尔塞克斯大学组织的食品安全黑客马拉松的一部分。那里…

github.com](https://github.com/aastha12/MDX-Food-Safety-Hackathon) 

# 介绍

每年，世界上几乎十分之一的人因食用受污染的食物而生病。不安全的食品对每个人都构成了全球性的健康威胁，尤其是婴儿、幼儿、孕妇、老人和有潜在疾病的人。食品安全的重要性可以从以下事实中得到理解:食源性疾病给卫生保健系统带来压力，损害国民经济、旅游业和贸易，从而阻碍社会经济发展。不安全的食物造成了疾病和营养不良的恶性循环。因此，很明显，食品安全、营养和可持续经济发展是密不可分的。对于我们来说，改善当前的食品安全措施变得至关重要，不仅可以减少食源性疾病，还可以改善经济和社会背景。

为了参与改善当前的食品安全措施，米德尔塞克斯大学与 RUBICS Smart Solutions、DataCon Dubai 2020 和 Beinex 合作组织了“食品安全分析黑客马拉松”,该黑客马拉松的目标是开放的，但也给了我们一个发挥创造力的机会，提出创新和可持续的解决方案来改善食品安全措施。

# 目录

1.  [数据](#da99)
2.  [方法论](#93c5)
3.  [第 1 部分:探索性数据分析](#6432)
4.  [第二部分:逻辑回归](#7dbb)
5.  [第 3 部分:将警告案例自动化为 WhatsApp 消息](#dcd1)
6.  [第 4 部分:将我们的模型部署为 web 应用程序](#710f)
7.  [结果和讨论](#0c19)

# 数据

作为黑客马拉松的一部分，我们获得了 10 个 csv 文件:

1.  警报级别
2.  属性
3.  日期
4.  设备
5.  门
6.  组
7.  位置
8.  阅读
9.  服务
10.  存储单元

“Reading”文件有 200 多万行，包含主数据集，而其他文件就像查找表一样。

我最初尝试使用 Dask(一个流行的并行计算库-[https://dask.org/](https://dask.org/))来组合所有的表，并使用整个数据集进行分析，但是我无法这样做。Dask 能够合并所有的表，但由于内存问题，我无法将其转换为 pandas 数据框架，因此我无法处理整个数据集。

相反，我决定对数据集进行随机抽样(原始数据集的大约 10%)。我连接了所有的表，最终的数据集有 271，897 行。

然后，我继续清理数据集，删除任何空值，并确保所有列都是正确的格式。

以下是最终数据集的快照:

![](img/9a6f79fefaddabb3bbab3fdaec18579d.png)

清理的数据

*注意:最终数据集的列数比上面快照中描述的多。*

# 方法学

我将首先执行探索性数据分析，以更好地理解我们的数据，并从数据中找到任何有趣的观察结果。然后，我将尝试执行逻辑回归来将案例分类为警报或不警报，并使用它来预测警报案例的概率。

我还将尝试使用 python 自动处理 WhatsApp 消息，这样无论何时我们的模型预测到一个警报案例，健康和安全主管都会首先得到通知。

我还在一个 web 应用程序上部署了逻辑回归模型，这样任何人都可以访问它(链接:[预测预警案例 Web 应用程序](https://alert-model.herokuapp.com/))。最后，我将讨论分析的结果和推论。

## **第一部分:探索性数据分析**

我将根据以下内容分析数据:

## 组名与警报名称类型

![](img/fefc0f65f2776acbdf6127ebbd592d24.png)

*针对集团名称的案例分布*

从上面的图中，我们可以看到最高的警报和警告案例是在冰柜和水果冷藏器中，最低的是在果汁冷藏器中。

## 存储名称与警报名称类型

![](img/afe9b23ea5e1486375b9cf48388d28ac.png)

*根据存储名称分配案例*

最高警戒级别的案例(左图)在小冰箱、房间 4 和房间 2 中，而最高警告级别的案例(右图)在房间 3、房间 2 和房间 4 中

## 位置名称和服务名称

![](img/e43e887bc4b6e0e75f2d8ba679a0a7d3.png)

根据位置名称分配案例

![](img/ab58285a541b222574b9d31e55cc281a.png)

根据服务名称分配案例

从左图中，我们可以推断出大多数警报和警告发生在储藏室。从右图中，我们可以推断出所有警报和警告案例都是由于违反最佳温度水平而发生的。

## **设备名称**

![](img/9889e541fe6bc33fad4ebc678ef32c2e.png)

*根据设备名称分布病例*

从左图中，我们可以看到最大警报案例来自 SF-冷却器、R4-冷冻机和 R2-冷冻机。从右边的图中，我们可以看到最大的警告案例来自 R3 冷冻机、R2 冷冻机和 R4 冷冻机。

## **警报类型与小时**

![](img/f13ed41a2a7d9fe0eee23107d8daba19.png)

*每小时案件分布*

从左边的图中，我们可以看到最高的警报案例是在上午 11 点到下午 4 点。从右边的图中，我们可以推断出最高的警告案例发生在上午 9-11 点和晚上 9-10 点。

## **警报类型与夜间**

![](img/580ab863ebf96a870497ef6d639e7479.png)

*夜间病例分布*

大多数警报和警告案例发生在白天，这可能是因为阿联酋白天的温度较高，而且冰柜在一天中会多次打开，从而降低冰柜中的温度，进而导致警告或警报案例。

## **警报类型与当月周**

现在，让我们来看一下警报和警告案例在每月某周的分布情况。

![](img/8f57657108f573d50837690fee2e2752.png)

*按月周分布案例*

一个月中警报案例几乎是不变的，但是接近月末时警报案例会下降。虽然在第一周警告案例较少，但随后开始增加，但接近月底时警告案例也会下降。有趣的是，警报和警告案例似乎在本月的最后一周下降。

## **案例类型与季度**

预警和警告案例在年初(即第一季度)较少，在第三季度最多。

![](img/3b1ad28da08209b27e5eba188d3baeef.png)

*案例对比季度*

## **预警案例 vs 值**

![](img/c424c079fdd8bdd3b63ea0819656fb55.png)

*预警案例分布对比值*

当该值为-9.9 时，出现了最高的警报案例。进一步的调查显示，所有值为-9.9 的警报案例都发生在储藏室的冷冻室中，而-9.9 表示温度，这意味着最佳温度。没有得到满足。可能的情况是，该冷冻箱需要适当的维护，以确保冷冻箱内保持最佳温度。

## **第二部分:逻辑回归**

我从数据集中注意到的一个缺点是，我们只能在警报案例发生后才能识别警报案例。但是，使用机器学习算法，您可以根据某些输入参数预测某个案例是否会成为警报案例。这种方法将帮助组织从分析过去的数据以了解发生了什么以及为什么会发生的思维模式转变为更加复杂和具有前瞻性思维的思维模式，在这种思维模式下，我们可以预测将会发生什么？这将有助于组织提前识别任何威胁。

为了实现这一点，我使用逻辑回归将案例分类为警报案例(1)或非警报案例(0)。该模型能够预测一个案例是否会成为警报，它还会告诉我们一个案例成为警报案例的概率，准确率为 **97%** 。

## **分类报告和混淆矩阵**

![](img/933cf7c45eddcd4c16108e205c8fd800.png)

*分类报告*

![](img/145a1b98adc4b5944141421154e64f46.png)

*混淆矩阵*

**-精度**是精度的度量，假设已经预测了类别标签。它由下式定义:精度= TP / (TP + FP)

——**回忆**是真阳性率。它被定义为:召回= TP / (TP + FN)

- **F1 得分**:F1 得分是精度和召回率的调和平均值，其中 F1 得分在 1 时达到最佳值(完美的精度和召回率)，在 0 时最差。这是一个很好的方式来表明一个分类器具有良好的召回率和精确度。

最后，我们可以知道这个分类器的平均准确度是两个标签的 F1 分数的平均值，在我们的例子中是 0.97 (即 **97%** )。

## **第 3 部分:将警告案例自动化为 WhatsApp 消息**

黑客马拉松直播( [Youtube 黑客马拉松直播](https://www.youtube.com/watch?v=wdKCSeZvRqE))中提到的一个关键问题是，工程师是监控案例的人，大多数时候他们不知道哪个案例需要紧急关注，因为他们不是食品健康和安全方面的专家。为了提高这个过程的效率，我认为如果健康&安全主管能够在 WhatsApp 上获得警报案例，那么我们可以减少任何延迟，这将是有帮助的。

因此，对于这个项目，我已经发送了我们的分类器已经预测到警报的案例，以及该案例成为警报案例的概率%。

我在这个项目中使用了 Twilio API。你可以在这里阅读更多信息- [Twilio 文档](https://www.twilio.com/docs/whatsapp/quickstart/python%23whatsapp-beta-1)。

为了这个项目，我已经把我的号码，我将发送的情况下，该案件的概率是一个警报是 100%。让我们在 WhatsApp 上发送通知，以便在实际警报发出之前立即采取行动。

![](img/d05325e858fa130ec27c8e07195d5c2b.png)

*WhatsApp 截图*

从上面的截图可以看出，我收到了案例为警报案例的概率为 100%的案例的索引号。现在从上面的截图中，你可以看到这个信息不是很丰富，但是我们可以调整这个信息来包含更多的细节。

## **第 4 部分:将我们的模型部署为 web 应用程序**

![](img/085dd5d4530d49e8c9cc202dd580fc5b.png)

*网络应用*

为了让我们的项目被其他人实际使用，我们需要在应用程序上部署我们的模型。我们不能给组织中的每个人发送代码文件，并期望他们运行它并解释结果。因此，我在一个 web 应用程序上部署了逻辑回归模型(link:[Predict Alert Cases Web App](https://alert-model.herokuapp.com/))。该应用程序的设计不是很美观，也不是用户友好的，因为 css 不是我的专业知识，但该应用程序功能齐全，可以用来预测一个案例是否会成为警报案例。显然，如果这要在一个组织中实现，我们将不得不对它进行一点调整，使它对用户更加友好。

# 结果和讨论

从我们的分析中，我们注意到最高的警报和警告案例发生在冷冻和水果冷藏组。

我们还注意到，警报级别最高的案例出现在小冰箱、房间 4 和房间 2 的存储单元中，而警报级别最高的案例出现在房间 3、房间 2 和房间 4 的存储单元中。这表明【T12 号房& 4 号存储单元可能存在一些技术或维护困难，因此我们看到了大量的警报和警告案例。

我们还推断，所有警报和警告案例都是由于最佳温度水平的**突破而发生的。**

大多数警报和警告案例发生在白天，这可能是因为阿联酋**白天的温度较高**，而且冰柜在一天中会被打开多次，从而降低冰柜中的温度，进而导致警告或警报案例。

一个月中警报案例几乎是恒定的，但是接近月末时警报案例下降。虽然在第一周警告案例较少，但随后开始增加，但接近月底时警告案例也会下降。有趣的是— **警报和警告案例似乎在本月最后一周下降**。

最高警报案例发生在**值为-9.9** 时。进一步的调查显示，所有值为-9.9 的警报案例都发生在储藏室的冷冻室中，而-9.9 表示温度，这意味着最佳温度。没有得到满足。可能的情况是，该冷冻箱需要适当的维护，以确保冷冻箱内保持最佳温度。

现在来看我们的逻辑回归模型，我们能够以 97%的准确率**预测一个案例是否会成为警报案例，以及它成为警报案例的概率。该模型将帮助组织在警报案例实际发生之前识别任何警报案例，并允许他们使用其数据将其转化为未来的见解。**

我们还能够通过 WhatsApp 自动发送最有可能(即 100%概率)的警报案例，以减少延迟。

最后，我们还能够将我们的模型部署到一个 web 应用程序中，这样每个人都可以访问它。

[*跃至榜首*](#1089)