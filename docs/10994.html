<html>
<head>
<title>Confusion Matrix for Object Detection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于目标检测的混淆矩阵</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/confusion-matrix-and-object-detection-f0cbcb634157?source=collection_archive---------5-----------------------#2020-07-31">https://towardsdatascience.com/confusion-matrix-and-object-detection-f0cbcb634157?source=collection_archive---------5-----------------------#2020-07-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1329" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一种评估实例分割模型性能的度量</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/aa45b9aa5c7b80c07de2ba5517e7ee6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S_GILc1PGpvSCP_zKoWXwg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@sctgrhm?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">斯科特·格雷厄姆</a>在<a class="ae ky" href="https://unsplash.com/s/photos/math?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="d05b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在训练机器学习分类器之后，下一步是使用相关度量来评估其性能。混淆矩阵是评估指标之一。</p><p id="98ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">混淆矩阵是显示给定一些真值/实例的分类器性能的表格(监督学习类型)。</p><p id="5089" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是对于对象检测和实例分割任务，混淆矩阵的计算不太直观。首先，有必要理解另一个支持度量:并集上的交集(IoU)。交集/并集(IoU)在对象检测和实例分割任务的计算指标中起着关键作用。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1b90" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">交集超过并集(借据)</strong></h1><p id="28b9" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated"><strong class="lb iu"> IoU </strong>，也称为<strong class="lb iu"> Jaccard index </strong>，是一种评估地面真实掩码(<em class="mz"> gt </em>)和预测掩码(<em class="mz"> pd </em>)之间重叠的度量。在对象检测中，我们可以使用 IoU 来确定给定的检测是否有效。</p><p id="e4d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">IoU 的计算方法为<em class="mz"> gt </em>和<em class="mz"> pd </em>之间的重叠/相交面积除以两者之间的并集面积，即:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi na"><img src="../Images/8d9ba3f18c007eb7a1010724bb4f40a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*V5EoeoLerTcZ2Hj4LkwOGA.png"/></div></figure><p id="4c9a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">IoU 的定义如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/2e005502175d3ef5d0e0afba5bb534cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*fYdiMfuzhqJ5OtSKmo_xtQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 1(来源:作者)</p></figure><p id="044a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">注:</strong> IoU 度量范围从 0 到 1，0 表示没有重叠，1 表示<em class="mz"> gt </em>和<em class="mz"> pd </em>之间完全重叠。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="c05a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">混淆矩阵由 4 个分量组成，即<strong class="lb iu">真阳性(TP)、真阴性(TN)、假阳性(FP)和假阴性(FN) </strong>。为了定义所有组件，我们需要根据 IoU 定义一些<strong class="lb iu">阈值(比如α)。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nc"><img src="../Images/21caba17070ab2cf1727510c80b11a0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bMZoMIj1PP_saB3laenViA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 2:2 类的混淆矩阵:1 和 2(来源:作者)</p></figure><ul class=""><li id="b925" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated">真阳性(TP) —这是当事实确实为阳性时分类器预测为阳性的实例，即 IoU ≥ α的检测。</li><li id="707b" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">假阳性(FP) —这是一种误阳性检测，即 IoU &lt; α的检测。</li><li id="6400" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">假阴性(FN)-这是分类器未检测到的实际实例。</li><li id="63fc" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated">真阴性(TN) —如果实际实例也是阴性的，此度量意味着阴性检测。在对象检测中，该度量不适用，因为存在许多不应该在图像中检测到的可能预测。因此，TN 包括未被检测到的所有可能的错误检测。</li></ul><p id="68f2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些概念可以通过一些图形示例直观地理解(让我们考虑 IOU 阈值，α = 0.5)</p><div class="kj kk kl km gt ab cb"><figure class="nr kn ns nt nu nv nw paragraph-image"><img src="../Images/49bf697565089021a593fe6370bd4413.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*n0Mup3npsZtifu2LuYPNJw.png"/></figure><figure class="nr kn ns nt nu nv nw paragraph-image"><img src="../Images/c8b60ffe5fd46dff4fa3e66cf74f4594.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*_Wd07umuN62yNUzGmRy_3Q.png"/><p class="ku kv gj gh gi kw kx bd b be z dk nx di ny nz translated">图 3:左:假阴性(FN)，右:真阳性(TP)，演职员表:<a class="ae ky" href="https://unsplash.com/@danielsjensen?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">丹尼尔·延森</a>在<a class="ae ky" href="https://unsplash.com/s/photos/person?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure></div><div class="ab cb"><figure class="nr kn ns nt nu nv nw paragraph-image"><img src="../Images/6d2085203d8edafc4ddb1a0c062a7863.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*ysftVmISsbSN6QVD3u2jUA.png"/></figure><figure class="nr kn ns nt nu nv nw paragraph-image"><img src="../Images/f782df0136a3e75889afec666c28f500.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*LlXRMUztu82updHToOy47Q.png"/><p class="ku kv gj gh gi kw kx bd b be z dk nx di ny nz translated">图 4:都是假阳性(FP)，演职员表:照片由<a class="ae ky" href="https://unsplash.com/@danielsjensen?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">丹尼尔·延森</a>在<a class="ae ky" href="https://unsplash.com/s/photos/person?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure></div><p id="f2c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">备注:</strong>根据 IoU 阈值的定义，如果我们选择阈值大于 0.86，则图 3 右侧变为 FP，如果我们选择 IoU 阈值小于 0.14，则图 4 右侧变为 TP</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="5383" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以从混淆矩阵中得出的其他指标包括:</p><ul class=""><li id="2c19" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated"><strong class="lb iu">精度</strong>是分类器仅识别相关对象的能力。它是正确的正面预测的比例，由下式给出</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/0d64de3fcb54f5eb67401ac771c812b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*izILqjIzbM0nPgr5xPRh2A.png"/></div></figure><ul class=""><li id="5e68" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated"><strong class="lb iu"> Recall </strong>是一个衡量分类器找到所有相关案例(即所有基本事实)的能力的指标。它是在所有基本事实中检测到的真阳性的比例，定义为</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/76760f72d87edad083ea1687974d6882.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*aDVeqVA9B-Qw-8i3vlG9nw.png"/></div></figure><p id="4043" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">₁分数是精确度和召回率的调和平均值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/0b13847a669d4aca5b93d61e5d495c44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*k5k9aVBcx6Ri-npLhiBn4g.png"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="55c6" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated"><strong class="ak">示例</strong></h1><p id="2004" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">考虑下面的图像，带有基本事实(深蓝色)和分类器检测(红色)。通过观察，你能说出 TP，FP 和 FN 的数目吗？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/0836757f4bae4546ec7afaf7c05e6e12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g78cBuIQXkMpaDj9UKfPEA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 5(来源:富士-SfM 数据集(引用于参考资料部分))</p></figure><h1 id="6e58" class="mc md it bd me mf oe mh mi mj of ml mm jz og ka mo kc oh kd mq kf oi kg ms mt bi translated">Python 实现</h1><p id="14d0" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">在 Python 中，可以使用<a class="ae ky" href="https://pypi.org/project/Shapely/" rel="noopener ugc nofollow" target="_blank"> Shapely </a>库计算混淆矩阵。以下函数<strong class="lb iu"> ( </strong> <code class="fe oj ok ol om b"><strong class="lb iu">evaluation(ground,pred,iou_value)</strong></code> →用于<strong class="lb iu"> TP、FP、FN、Precision、Recall、F₁的 6 值元组)</strong>可用于确定上述图像的混淆矩阵(图 5)</p><p id="1261" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">参数:</strong></p><ul class=""><li id="b1ef" class="nd ne it lb b lc ld lf lg li nf lm ng lq nh lu ni nj nk nl bi translated"><strong class="lb iu">地面</strong> —是<em class="mz">n</em>×<em class="mz">m</em>×<em class="mz">2</em>数组，其中<em class="mz"> n </em>是给定图像的地面真实实例的数量，<em class="mz"> m </em>是在掩膜圆周上采样的<em class="mz"> (x，y) </em>对的数量。</li><li id="1335" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated"><strong class="lb iu"> pred </strong>为<em class="mz"> p × q × 2 </em>数组，其中<em class="mz"> p </em>为检测数，<em class="mz"> q </em>为预测掩码采样的<em class="mz"> (x，y) </em>点数</li><li id="4507" class="nd ne it lb b lc nm lf nn li no lm np lq nq lu ni nj nk nl bi translated"><strong class="lb iu"> iou_value </strong>为 iou 阈值</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="on oo l"/></div></figure><p id="f909" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于图 5 和 IoU 阈值，α = 0.5，<code class="fe oj ok ol om b"><strong class="lb iu">evaluation(ground,pred,iou_value)</strong></code>→</p><pre class="kj kk kl km gt op om oq or aw os bi"><span id="6957" class="ot md it om b gy ou ov l ow ox">TP: 9   FP: 5   FN: 0   GT: 10<br/>Precall: 0.643   Recall: 1.0   F1 score: 0.783</span></pre><p id="2be8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读:-)</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="fb2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在 https://medium.com/@kiprono_65591/membership<a class="ae ky" href="https://medium.com/@kiprono_65591/membership" rel="noopener">加入媒体</a>以获取媒体上的所有报道。</p><p id="df48" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你也可以在我发文章的时候通过这个链接把文章发到你的邮箱里:<a class="ae ky" href="https://medium.com/subscribe/@kiprono_65591" rel="noopener">https://medium.com/subscribe/@kiprono_65591</a></p><h1 id="335a" class="mc md it bd me mf oe mh mi mj of ml mm jz og ka mo kc oh kd mq kf oi kg ms mt bi translated"><strong class="ak">参考文献</strong></h1><p id="91bc" class="pw-post-body-paragraph kz la it lb b lc mu ju le lf mv jx lh li mw lk ll lm mx lo lp lq my ls lt lu im bi translated">若尔迪·吉恩-莫拉、里卡多·桑斯-科尔蒂埃拉、琼·罗塞尔-波罗、何塞普-拉蒙·莫罗斯、哈维尔·鲁伊斯-伊达尔戈、维罗尼卡·维拉普拉纳和爱德华·格雷戈里奥。(2020).富士 SfM 数据集。芝诺多。<a class="ae ky" href="http://doi.org/10.5281/zenodo.3712808" rel="noopener ugc nofollow" target="_blank">http://doi.org/10.528/zenodo.3712808</a></p><p id="09a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Everingham，m ,, es lami，s . A ,, Van Gool，l ,, Williams，c . k ,, Winn，j ,,和 Zisserman，A,《Pascal 视觉对象类挑战:回顾》。国际计算机视觉杂志，111(1):98–136，2015。</p><p id="b210" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对 ROC 分析的介绍。模式识别快报，27(8):861–874，2006。</p></div></div>    
</body>
</html>