<html>
<head>
<title>How to Learn Non-linear Dataset with Support Vector Machines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用支持向量机学习非线性数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-learn-non-linear-separable-dataset-with-support-vector-machines-a7da21c6d987?source=collection_archive---------24-----------------------#2020-05-19">https://towardsdatascience.com/how-to-learn-non-linear-separable-dataset-with-support-vector-machines-a7da21c6d987?source=collection_archive---------24-----------------------#2020-05-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b084" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">支持向量机简介及其在非线性数据集上的应用</h2></div><h1 id="e27c" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">动机</h1><h2 id="0831" class="la kj it bd kk lb lc dn ko ld le dp ks lf lg lh ku li lj lk kw ll lm ln ky lo bi translated">支持向量机</h2><p id="98da" class="pw-post-body-paragraph lp lq it lr b ls lt ju lu lv lw jx lx lf ly lz ma li mb mc md ll me mf mg mh im bi translated">什么是支持向量机？支持向量机是监督学习模型，分析数据进行分类。单独类别的样本点由一个尽可能宽的间隙<strong class="lr iu">分开。</strong></p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/f1138fccb6edffd66f3a572781dcb407.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*kvcFnSh9RZ1uHi6Ec_UKsA.png"/></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="ff7c" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">如上图所示，间隙是用黑色圆圈的两点定义的黄色区域。边框绘制在黄色区域的中间。当新的样本点进来时，它们将被<strong class="lr iu">预测为属于它们落入的那一侧的类别</strong>。</p><h2 id="4c59" class="la kj it bd kk lb lc dn ko ld le dp ks lf lg lh ku li lj lk kw ll lm ln ky lo bi translated">但是我们的数据并不总是线性的</h2><p id="7563" class="pw-post-body-paragraph lp lq it lr b ls lt ju lu lv lw jx lx lf ly lz ma li mb mc md ll me mf mg mh im bi translated">如果数据像上面一样是线性可分的，那么我们用线性分类器来分离这两个类就没有问题了。但是如果我们的数据是像这样的非线性可分的呢:</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi mz"><img src="../Images/3f294651a9e1300f6569b284665b16a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZFD1ZUePleYZCuCdGsD1vA.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="7768" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">正如我们所看到的，即使来自不同类的数据点是可分的，我们也不能像上面那样简单地画一条直线</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi ne"><img src="../Images/70d0f9d09a590f7ff096d7cacac2c989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ldxJR3X3MKbv3ntFEZcgRQ.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="ddc8" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">那么，我们如何使用支持向量机来拟合非线性数据集呢？本文将带您了解如何做到这一点。读完本文后，您应该能够<strong class="lr iu">理解内核、gamma和C的作用，以及如何操纵它们来适应您的数据集</strong>。</p><h1 id="eb08" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">SVM的实验</h1><h2 id="4e45" class="la kj it bd kk lb lc dn ko ld le dp ks lf lg lh ku li lj lk kw ll lm ln ky lo bi translated">创建数据集和绘图功能</h2><p id="a716" class="pw-post-body-paragraph lp lq it lr b ls lt ju lu lv lw jx lx lf ly lz ma li mb mc md ll me mf mg mh im bi translated">从创建非线性数据集开始。</p><figure class="mj mk ml mm gt mn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="3614" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">您应该会看到类似这样的内容。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi mz"><img src="../Images/3f294651a9e1300f6569b284665b16a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZFD1ZUePleYZCuCdGsD1vA.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="2adc" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">我们还需要一个名为<code class="fe nh ni nj nk b">plot_decision_region</code>的绘图函数，就像<a class="ae nl" href="http://3776d8abd4204a2efd4792888337592c" rel="noopener ugc nofollow" target="_blank">这个</a>一样。由于本文的目标是理解SVM，如果您想使用数据集并遵循本文，请随意复制并粘贴下面的代码。</p><h2 id="bd8b" class="la kj it bd kk lb lc dn ko ld le dp ks lf lg lh ku li lj lk kw ll lm ln ky lo bi translated">线性SVM的尝试</h2><p id="4799" class="pw-post-body-paragraph lp lq it lr b ls lt ju lu lv lw jx lx lf ly lz ma li mb mc md ll me mf mg mh im bi translated">在扭曲我们的算法之前，让我们先试试标准的线性SVM</p><figure class="mj mk ml mm gt mn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="c1f8" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated"><code class="fe nh ni nj nk b">C</code>是与错误分类相关的成本。<code class="fe nh ni nj nk b">C</code>的值越高，正确分离数据集的算法就越严格。我们使用<code class="fe nh ni nj nk b">kernel='linear'</code>进行线性分类。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nm"><img src="../Images/ff6fe5e345c2515983d536f300149c18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wKAANEW_Mu83R73TrziViQ.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="13f7" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">正如我们所看到的，即使我们将成本设置得非常高，这条线也没有很好地分离红色和蓝色点。一些蓝点和红点在错误的一边。</p><h2 id="64da" class="la kj it bd kk lb lc dn ko ld le dp ks lf lg lh ku li lj lk kw ll lm ln ky lo bi translated">径向基函数核</h2><p id="6018" class="pw-post-body-paragraph lp lq it lr b ls lt ju lu lv lw jx lx lf ly lz ma li mb mc md ll me mf mg mh im bi translated">到目前为止，我们已经使用了线性分类器的形式</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/ed50edcfa095a0562a62b2009be6a1f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:660/format:webp/1*mtdrH3NOyNYKV-OlOocMZQ.png"/></div></figure><p id="b040" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">我们可以看到，g(x)是一个线性函数。当g(x) &gt;0时，预测为1。当g(x) &lt;1时，预测为-1。但是由于我们不能像上面那样使用线性函数来处理非线性数据，我们需要将线性函数转换成另一个函数。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div class="gh gi no"><img src="../Images/890e5d4c903b04c0c2e72d13f5e6b0db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*fbfWYD7DJz1kfPoY88adiA.png"/></div></figure><p id="98e8" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">你不需要理解我们是怎么得到像上面这样的函数g(x)的。请注意:</p><ul class=""><li id="4f46" class="np nq it lr b ls mu lv mv lf nr li ns ll nt mh nu nv nw nx bi translated">||x-x_i||是距离公式。我们根据两点之间的径向距离来区分这两点。</li><li id="f102" class="np nq it lr b ls ny lv nz lf oa li ob ll oc mh nu nv nw nx bi translated">西格玛是一个调节参数。西格玛越大，分类器对距离差异越不敏感。</li><li id="8c32" class="np nq it lr b ls ny lv nz lf oa li ob ll oc mh nu nv nw nx bi translated">范围从0到1的函数。</li><li id="7817" class="np nq it lr b ls ny lv nz lf oa li ob ll oc mh nu nv nw nx bi translated">距离越大，函数越接近零。这意味着两点更有可能是<strong class="lr iu">不同的</strong>。</li><li id="b094" class="np nq it lr b ls ny lv nz lf oa li ob ll oc mh nu nv nw nx bi translated"><strong class="lr iu">距离</strong>越小，函数越接近零。这意味着两点更有可能<strong class="lr iu">相似。</strong></li></ul><p id="6553" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">这个分类器似乎是我们非线性数据的一个很好的候选。让我们检查一下</p><figure class="mj mk ml mm gt mn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="afd5" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated"><code class="fe nh ni nj nk b">gamma</code>是1/sigma。记住sigma是一个调节函数。因此，伽马值越小，西格玛值越大，并且分类器<strong class="lr iu">对各个<strong class="lr iu">点之间的距离越不敏感。</strong></strong></p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi od"><img src="../Images/89e193a541376d7233937ef3ac5f073e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kIITbnlsN4hwFZznNz41oA.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="4ca5" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">让我们试着把伽玛放大，看看会发生什么</p><figure class="mj mk ml mm gt mn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi oe"><img src="../Images/ac3d6479ee4b6aa9d5f6196e6c6f14fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XVXvVRroXiKTpnEvX6xnaA.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="61ef" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">厉害！似乎将伽马值放大100倍可以提高我们的分类器对训练集的准确性。我们把这个伽玛乘以10怎么样？</p><figure class="mj mk ml mm gt mn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi of"><img src="../Images/c524754d9bc3ef665ab511735c868594.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aHS2rOlBbHU2yg0f3w-9bg.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="ded3" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">看起来分类器努力使训练集的准确度更接近于零。那么这是否意味着如果我们将gamma增加到10000，它会更加精确呢？不完全是。如果伽马太大，分类器最终对差异不敏感</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi og"><img src="../Images/5473003216a3da0162b1645484402b2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gcxp9WnQIx3f2ZjIk6FJAg.png"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="f243" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">让我们改为增加C。还记得C是做什么的吗？c是与整个数据集的错误分类相关联的成本。换句话说，增加C将<strong class="lr iu">增加对<strong class="lr iu">整个数据集</strong>的灵敏度</strong>，而不仅仅是单个数据点。</p><p id="3d04" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">让我们用一个下拉栏来快速观察C值增加的差异</p><figure class="mj mk ml mm gt mn"><div class="bz fp l di"><div class="nf ng l"/></div></figure><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi oh"><img src="../Images/cf680da317f591fc2aaf0cba735371cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*NhMDh7duLVLPneRCLKYS4w.gif"/></div></div><p class="mq mr gj gh gi ms mt bd b be z dk translated">作者图片</p></figure><p id="39a0" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">厉害！我们已经找到了参数，所以我们的SVM分类器成功地分离了两组点。</p><h1 id="6432" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">下一步是什么</h1><p id="a1cf" class="pw-post-body-paragraph lp lq it lr b ls lt ju lu lv lw jx lx lf ly lz ma li mb mc md ll me mf mg mh im bi translated">我希望这篇文章能让你直观地了解什么是SVM分类器，以及如何使用它来学习非线性数据集。当然，如果您的数据是高维的，您不能总是基于上述可视化来判断您的分类器的性能。一个好的做法是根据训练集训练数据集，并在测试集上使用混淆矩阵或f1分数等指标。</p><p id="51d6" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">你可以玩玩这本<a class="ae nl" href="https://github.com/khuyentran1401/Data-science/blob/master/machine-learning/SVM_Separate_XOR.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>中提供的代码，以建立对SVM更好的直觉。</p><p id="b948" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">我喜欢写一些基本的数据科学概念，并尝试不同的算法和数据科学工具。你可以在LinkedIn和T2 Twitter上与我联系。</p><p id="03d9" class="pw-post-body-paragraph lp lq it lr b ls mu ju lu lv mv jx lx lf mw lz ma li mx mc md ll my mf mg mh im bi translated">星<a class="ae nl" href="https://github.com/khuyentran1401/Data-science" rel="noopener ugc nofollow" target="_blank">这个回购</a>如果你想检查我写的所有文章的代码。在Medium上关注我，了解我的最新数据科学文章，例如:</p><div class="oi oj gp gr ok ol"><a rel="noopener follow" target="_blank" href="/how-to-create-a-drop-down-menu-and-a-slide-bar-for-your-favorite-visualization-tool-3a50b7c9ea01"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">如何为你最喜欢的可视化工具创建下拉菜单和滑动条</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">使用Python Widget，您可以用3行代码升级可视化</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">towardsdatascience.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz mo ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a rel="noopener follow" target="_blank" href="/how-to-fine-tune-your-machine-learning-models-with-ease-8ca62d1217b1"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">如何有效地微调你的机器学习模型</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">发现为您的ML模型寻找最佳参数非常耗时？用这三招</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">towardsdatascience.com</p></div></div><div class="ou l"><div class="pa l ow ox oy ou oz mo ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a rel="noopener follow" target="_blank" href="/convolutional-neural-network-in-natural-language-processing-96d67f91275c"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">自然语言处理中的卷积神经网络</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">什么是卷积神经网络，如何利用它进行情感分析？</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">towardsdatascience.com</p></div></div><div class="ou l"><div class="pb l ow ox oy ou oz mo ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a rel="noopener follow" target="_blank" href="/how-to-organize-your-data-science-articles-with-github-b5b9427dad37"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">如何用Github组织你的数据科学文章</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">被新信息淹没？现在，您可以轻松地跟踪文章并为其创建自定义注释</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">towardsdatascience.com</p></div></div><div class="ou l"><div class="pc l ow ox oy ou oz mo ol"/></div></div></a></div><div class="oi oj gp gr ok ol"><a rel="noopener follow" target="_blank" href="/what-is-pytorch-a84e4559f0e3"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd iu gy z fp oq fr fs or fu fw is bi translated">PyTorch是什么？</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">想想Numpy，但是有强大的GPU加速</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">towardsdatascience.com</p></div></div><div class="ou l"><div class="pd l ow ox oy ou oz mo ol"/></div></div></a></div></div></div>    
</body>
</html>