<html>
<head>
<title>Understanding Region of Interest — (RoI Align and RoI Warp)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">了解感兴趣区域— (RoI对齐和RoI扭曲)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-region-of-interest-part-2-roi-align-and-roi-warp-f795196fc193?source=collection_archive---------1-----------------------#2020-02-09">https://towardsdatascience.com/understanding-region-of-interest-part-2-roi-align-and-roi-warp-f795196fc193?source=collection_archive---------1-----------------------#2020-02-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="86a3" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">理解ML</h2><div class=""/><div class=""><h2 id="ba3c" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">直观解释RoI Align的工作原理，以及为什么它优于标准RoI合并？</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/2fb95cc8f384587b4bed444a9945b179.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*UqYj-d9zTPMCXhWT.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">独创快速R-CNN架构。来源:</em><a class="ae lf" href="https://arxiv.org/pdf/1504.08083.pdf" rel="noopener ugc nofollow" target="_blank"><em class="le"/></a></p></figure><blockquote class="lg lh li"><p id="9170" class="lj lk ll lm b ln lo ka lp lq lr kd ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated"><em class="iq">如果你不熟悉RoI的概念，先阅读一下</em><a class="ae lf" href="https://medium.com/@kemalpiro/understanding-region-of-interest-part-1-roi-pooling-e4f5dd65bb44" rel="noopener"><strong class="lm ja"><em class="iq"/>了解感兴趣区域— (RoI汇集)</strong></a><strong class="lm ja"><em class="iq"/></strong><em class="iq">可能会有所帮助。本文不包括对什么是RoI的介绍，而只集中在</em><strong class="lm ja"><em class="iq">RoI align</em></strong><em class="iq">和</em> <strong class="lm ja"> <em class="iq"> RoIWarp上。</em>T29】</strong></p></blockquote><h1 id="8985" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">为什么我们要修改投资回报池？</h1><p id="aaff" class="pw-post-body-paragraph lj lk iq lm b ln my ka lp lq mz kd ls na nb lv lw nc nd lz ma ne nf md me mf ij bi translated">正如您在本系列的第一部分中所记得的，RoI Pooling有一个主要问题。在此过程中，它会丢失大量数据。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ng"><img src="../Images/2340f02a725cd15d25d58e969298ba6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BsrnKGN-HZjMWRHi.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le"> RoI集中量化损失(深蓝色和浅蓝色)，数据增益(绿色)</em></p></figure><p id="638d" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">每当它这样做时，关于该对象的部分信息就会丢失。这降低了整个模型的精度，很多真正聪明的人都考虑过这个问题。</p><h1 id="cdd6" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">设置</h1><p id="e696" class="pw-post-body-paragraph lj lk iq lm b ln my ka lp lq mz kd ls na nb lv lw nc nd lz ma ne nf md me mf ij bi translated">开始之前，我需要快速解释一下我们的模型。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/f34c3dcde64294e829c1ee6d56e9f0b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZhruhfkX0fu8Nf1V.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">原创Mask R-CNN架构。来源:</em><a class="ae lf" href="https://arxiv.org/pdf/1703.06870.pdf" rel="noopener ugc nofollow" target="_blank"><em class="le">https://arxiv.org/pdf/1703.06870.pdf</em></a></p></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/512dcf9b2178fb33eef8a30ace55ec03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FSAVHzp_ejTq-AKX.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">屏蔽R-CNN输出。来源:</em><a class="ae lf" href="https://arxiv.org/pdf/1703.06870.pdf" rel="noopener ugc nofollow" target="_blank"><em class="le">https://arxiv.org/pdf/1703.06870.pdf</em></a></p></figure><p id="8954" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">我们将使用<strong class="lm ja">屏蔽R-CNN </strong>网络进行测试。我们使用它的唯一原因是这种网络更多地受益于精确的池层，因此更容易显示RoI Align和RoI Pooling之间的<strong class="lm ja">差异</strong>。在实现投资回报池之前，我们使用哪个网络并不重要。因此，我们的设置保持不变，如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/4ae714c8319aa139226d3c345603326b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JArsNcfm3TyRj1Q8.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">模型特征映射过程。猫i </em>法师来源:斯蒂芬妮·布斯<a class="ae lf" href="https://www.flickr.com/photos/bunny/" rel="noopener ugc nofollow" target="_blank">https://www.flickr.com/photos/bunny/</a></p></figure><p id="9077" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">我们的模型接受大小为<strong class="lm ja"> 512x512x3 </strong>(宽x高x RGB)的图像输入，VGG16将它映射到一个<strong class="lm ja"> 16x16x512 </strong>特征图中。比例因子是<strong class="lm ja"> 32 </strong>。</p><p id="f42d" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">接下来，我们使用一个建议的ROI(<strong class="lm ja">145 x200</strong>框)并尝试将其映射到特征图上。因为不是所有的物体尺寸都可以除以32，所以我们放置的RoI不与网格对齐。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nh"><img src="../Images/b02651d3452ccd5ea2da37287365008a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JXAuro-N0Nl4zDt_.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le"> RoI放置</em></p></figure><ul class=""><li id="3a41" class="ni nj iq lm b ln lo lq lr na nk nc nl ne nm mf nn no np nq bi translated"><strong class="lm ja"> (9.25，6) </strong> —左上角</li><li id="082f" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated"><strong class="lm ja"> 6.25 </strong> —宽度</li><li id="14dd" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated"><strong class="lm ja"> 4.53 </strong> —高度</li></ul><p id="2096" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">我们再次选择我们的池层大小为<strong class="lm ja"> 3x3 </strong>，因此最终结果形状为<strong class="lm ja"> 3x3x512 </strong>(这只是一个任意的例子，以便更容易在图像上显示。您的池层可能会有不同的大小)。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/b2b9c53827060e83891e9646d0a5b9a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6YgoeWBShTWx25bD.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">汇集层</em></p></figure><p id="cbcf" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">至此，一切看起来与<a class="ae lf" href="https://medium.com/@kemalpiro/understanding-region-of-interest-part-1-roi-pooling-e4f5dd65bb44" rel="noopener"> RoI Pooling </a>中的完全相同。</p><h1 id="79af" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">RoI Align简介</h1><p id="e655" class="pw-post-body-paragraph lj lk iq lm b ln my ka lp lq mz kd ls na nb lv lw nc nd lz ma ne nf md me mf ij bi translated">RoI Pooling和RoI Align的主要区别在于量化。<strong class="lm ja"> RoI Align不使用量化</strong>进行数据汇集。你知道快速R-CNN是两次应用量化。第一次在映射过程中，第二次在汇集过程中。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/5ae7d1e333bf13f0a5a8b592160f9a75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*H9dzv-y3dmmDdHIt.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">映射和汇集时的量化</em></p></figure><p id="8c66" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">我们可以跳过这一步，将原始RoI分成9个大小相等的方框，并在每个方框内应用双线性插值。让我们来定义盒子:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nw"><img src="../Images/6813a76cd6f2081b5bb8f4c970b04cfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RNy9uPsv5acoTtPg.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le"> RoI框尺寸</em></p></figure><p id="b58d" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">每个框的大小由映射的RoI的大小和汇集层的大小决定。我们使用的是<strong class="lm ja"> 3x3 </strong>池层，所以我们必须将映射的RoI ( <strong class="lm ja"> 6.25x4.53 </strong>)除以3。这给了我们一个高度为<strong class="lm ja"> 1.51 </strong>和宽度为<strong class="lm ja"> 2.08 </strong>的盒子(这里我将数值四舍五入以使其更简单)。现在，我们可以将我们的盒子放入映射的RoI中:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/4881f5b4ee95cfe2370a604916698918.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CC8CdUxkIm_DVT5V.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le"> RoI被分成多个方框</em></p></figure><p id="950c" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">如果您查看第一个框(左上角)，您会注意到它覆盖了六个不同的网格单元。为了提取池层的价值，我们必须从中抽取一些数据。为了对数据进行采样，我们必须在那个盒子里创建四个采样点。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/18247b029a7eeccf43ee65c1612cbf0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*R_Nbks0OUyRZPRH3.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">采样点分布</em></p></figure><p id="e8fc" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">你可以通过<strong class="lm ja">将盒子的高度和宽度除以3 </strong>来计算这些点应该在哪里。</p><p id="9fe2" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">在我们的例子中，我们像这样计算第一个点(左上角)的坐标:</p><ul class=""><li id="9e3b" class="ni nj iq lm b ln lo lq lr na nk nc nl ne nm mf nn no np nq bi translated">X = X_box +(宽度/3) * 1 = 9.94</li><li id="ebdc" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">Y = Y_box +(高度/3) * 1 = 6.50</li></ul><p id="7b39" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">为了计算第二个点(左下角),我们只需改变Y:</p><ul class=""><li id="75d6" class="ni nj iq lm b ln lo lq lr na nk nc nl ne nm mf nn no np nq bi translated">X = X_box +(宽度/3) * 1 = 9.94</li><li id="dfcd" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">Y = Y_box +(高度/3) * 2 = 7.01</li></ul><p id="fc5e" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">现在，当我们有了所有的点，我们可以应用双线性插值来采样这个盒子的数据。双线性插值通常用于图像处理中对颜色进行采样，其公式如下所示:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nx"><img src="../Images/7e136bf5b33cc4eba0f5e5a32ae1d7b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J7VPE_DrDTwSluzN_8RJKQ.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">双线性插值方程</em></p></figure><p id="6a69" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">请不要试图理解这个等式，而是看一看它是如何工作的图形解释:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/747b94db2bf0784d92fcdb43f4c114ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EEREnVrhY4U83vUa.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">第一点的双线性插值</em></p></figure><p id="8a20" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">当你从我们的盒子中取出第一个点时，你把它和最近的相邻单元连接起来(正好在中间)，除非它已经被取了。在这种情况下，我们的点有坐标<strong class="lm ja"> (9.44，6.50) </strong>。左上方向上最接近单元格中间的是<strong class="lm ja"> (9.50，6.50) </strong>(如果我们的点在网格上仅高出0.01，则为(9.50，5.50))。然后我们必须选择一个左下方的点，最接近的点是<strong class="lm ja"> (9.50，7.50) </strong>。遵循同样的规则，我们选择<strong class="lm ja"> (10.50，6.50) </strong>和<strong class="lm ja"> (10.50，7.50) </strong>作为右上角和右下角的点。在RoI上方，您可以看到获得第一个点的值(0.14)的整个计算过程。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/5f4fea19edc29ddd6e531b510ad10d96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pNXjoftdbR9W4tNW.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">第二点的双线性插值</em></p></figure><p id="6314" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">这次我们从以下位置开始插值:</p><ul class=""><li id="7c6f" class="ni nj iq lm b ln lo lq lr na nk nc nl ne nm mf nn no np nq bi translated">左上:(10.50，6.50)</li><li id="94e9" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">左下方:(10.50，7.50)</li><li id="d39e" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">右上:(11.50，6.50)</li><li id="de65" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">右下:(11.50，7.50)</li></ul><p id="c3c8" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">你应该在这里开始看到一个模式:)。以下是其他几点:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/a1a660cbfc44b88dd75ed044d0f7e493.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*czN31BxYWrujn-qD.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">第三点的双线性插值</em></p></figure><ul class=""><li id="581f" class="ni nj iq lm b ln lo lq lr na nk nc nl ne nm mf nn no np nq bi translated">左上:(9.50，6.50)</li><li id="66cb" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">左下方:(9.50，7.50)</li><li id="7071" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">右上:(10.50，6.50)</li><li id="e1bc" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">右下:(10.50，7.50)</li></ul><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/9c537dc6206239a3c8853a2da2a64217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*J78DE2M7QdwNns_T.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">第四点的双线性插值</em></p></figure><ul class=""><li id="ddd3" class="ni nj iq lm b ln lo lq lr na nk nc nl ne nm mf nn no np nq bi translated">左上:(10.50，6.50)</li><li id="13cd" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">左下方:(10.50，7.50)</li><li id="d620" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">右上:(11.50，6.50)</li><li id="3738" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">右下:(11.50，7.50)</li></ul><p id="d6b3" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">现在我们已经计算了所有的点，可以对它们应用<strong class="lm ja">最大池</strong>(如果你愿意，也可以是平均池):</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/a26cae756a8d77220ae76e7091911963.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*h4cpIjHPjRx2dMRc.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">第一箱统筹</em></p></figure><p id="8add" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">我不会给你看所有的插值，因为这会花很长时间，你可能已经知道如何做了。我将向您展示使用RoIAlign从该RoI汇集数据的整个过程:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ny"><img src="../Images/932a811f89c1a3a3d0f9b3b04facbaf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7WFmQBxoOCPu2BDJ.gif"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le"> RoIAlign池化过程(在新标签中打开图像以检查所有计算)</em></p></figure><p id="7dea" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">还有ofc。此过程适用于所有图层，因此最终结果包含512个图层(与要素地图输入相同)</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/b4015d555e47781f850b9ee248a6766c.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/0*KGrcXozWbZOfDfqk.png"/></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le"> RoIAlign全尺寸</em></p></figure><p id="aa24" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">请注意，即使我们没有将采样点放置在要素地图的所有像元内，我们也是通过双线性插值从这些像元中提取数据。</p><p id="8e27" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">在这种情况下，单元格11x6、11x7、11x8、11x9、11x10、13x6、13x7、13x8、13x9、13x10、15x6、15x7、15x8、15x9、15x10中不会有任何点。如果您查看第二个点计算(第一个框)，它仍然使用11x6和11x7单元进行双线性插值，即使该点位于10x6单元中。</p><p id="8253" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">如果您比较RoIAlign和RoIPooling的数据损失/数据增加，您应该看到RoIAlign使用整个区域来汇集来自以下区域的数据:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/2d614c5f3686f32001e1d422e0743f4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EUJOm7bE0zM6FxFE.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le">比较RoIAlign(左)和RoIPooling(右)数据源。</em></p></figure><ul class=""><li id="44c0" class="ni nj iq lm b ln lo lq lr na nk nc nl ne nm mf nn no np nq bi translated">绿色表示用于池化的附加数据。</li><li id="53d1" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">蓝色(两种阴影)表示数据在汇集时丢失。</li></ul><h1 id="6bae" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">洛奇普——在中间见我</h1><p id="4da7" class="pw-post-body-paragraph lj lk iq lm b ln my ka lp lq mz kd ls na nb lv lw nc nd lz ma ne nf md me mf ij bi translated">通过多任务网络级联 在<a class="ae lf" href="https://arxiv.org/pdf/1512.04412.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="ll">实例感知语义分段中引入了第三种汇集数据的方法，这种方法被称为<strong class="lm ja"> RoIWarp </strong>。RoIWarp的想法与RoIAlign或多或少是一样的，唯一的区别是<strong class="lm ja"> RoIWarp是将RoI映射量化到特征映射上</strong>。</em></a></p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi oa"><img src="../Images/16ce4487b269928e7f1b30eb042556ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Yzsw9XOLtRjK-qMw.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le"> RoI翘曲</em></p></figure><p id="eeb0" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">如果从数据丢失/数据增加的角度来看:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ob"><img src="../Images/2f85c03e5cb6ebe384bc0246ae56f9dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sDjOScbSjgoUAY6z.png"/></div></div><p class="la lb gj gh gi lc ld bd b be z dk translated"><em class="le"> RoI翘曲数据丢失/数据增加</em></p></figure><p id="9569" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">由于双线性插值，我们只损失了一小部分。</p><h1 id="2f54" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">RoIAlign和RoIWarp如何影响精度</h1><p id="a678" class="pw-post-body-paragraph lj lk iq lm b ln my ka lp lq mz kd ls na nb lv lw nc nd lz ma ne nf md me mf ij bi translated">如果我们看一下Mask R-CNN的论文，有一些重要的数字需要讨论。第一个是在步幅为16的ResNet-50-C4上应用不同RoI层时<strong class="lm ja">平均精度</strong>的变化:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/054b88e655cdfffbe75a42a408abcd65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*LzXWxztqOjhW3219eWCAlg.png"/></div></figure><p id="375b" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">当应用RoIWarp时，只有很小的改进，但是应用RoIAlign使我们在精度上有了显著的提高。这种提升随着步幅的增加而增加:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi od"><img src="../Images/4c73de8bd5f112f6ff7b6b311248827f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*mKEow8X4uffLqF-TSbA1NA.png"/></div></figure><p id="3e59" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">其中<strong class="lm ja"> APbb </strong>是检测边界框的平均精度。测试在ResNet-50-C5上进行，步幅为32。</p><h1 id="7b67" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">摘要</h1><p id="a0e3" class="pw-post-body-paragraph lj lk iq lm b ln my ka lp lq mz kd ls na nb lv lw nc nd lz ma ne nf md me mf ij bi translated">当我们想提高我们的R-CNN类模型的准确性时，理解RoI池是很重要的。在2014年关于快速R-CNN的论文中提出的标准方法和2018年关于屏蔽R-CNN的论文中提出的新方法之间存在显著差异。这并不意味着这些方法只适用于特定的网络，我们可以很容易地在快速R-CNN中使用RoIAlign，在Mask R-CNN中使用RoIPooling，但你必须记住，RoIAlign平均来说可以提供更好的精度。</p><p id="8a1e" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated">我真的希望我的解释很容易理解，因为我已经看到了很多关于投资回报池的帖子，而没有进入计算。在我看来，更直观的方法总是更好，尤其是如果你不想花一整天的时间一遍又一遍地阅读原始论文以最终理解它的作用。</p><h1 id="0e26" class="mg mh iq bd mi mj mk ml mm mn mo mp mq kf mr kg ms ki mt kj mu kl mv km mw mx bi translated">参考资料:</h1><ul class=""><li id="a083" class="ni nj iq lm b ln my lq mz na oe nc of ne og mf nn no np nq bi translated">R.吉斯克。快速R-CNN。2014年<a class="ae lf" href="https://arxiv.org/pdf/1504.08083.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1504.08083.pdf ICCV</a></li><li id="dd96" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">J.戴，贺国强，孙军。基于多任务网络级联的实例感知语义分割。2016年<a class="ae lf" href="https://arxiv.org/pdf/1512.04412.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1512.04412.pdf CVPR</a></li><li id="9c0d" class="ni nj iq lm b ln nr lq ns na nt nc nu ne nv mf nn no np nq bi translated">K.何、g .基约萨里、p .杜尔和r .吉希克。面具R-CNN在ICCV，2018<a class="ae lf" href="https://arxiv.org/pdf/1703.06870.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1703.06870.pdf</a></li></ul></div><div class="ab cl oh oi hu oj" role="separator"><span class="ok bw bk ol om on"/><span class="ok bw bk ol om on"/><span class="ok bw bk ol om"/></div><div class="ij ik il im in"><p id="40f2" class="pw-post-body-paragraph lj lk iq lm b ln lo ka lp lq lr kd ls na lu lv lw nc ly lz ma ne mc md me mf ij bi translated"><em class="ll">原载于</em><a class="ae lf" href="https://erdem.pl/2020/02/understanding-region-of-interest-part-2-ro-i-align" rel="noopener ugc nofollow" target="_blank"><em class="ll">https://erdem . pl</em></a><em class="ll">。</em></p></div></div>    
</body>
</html>