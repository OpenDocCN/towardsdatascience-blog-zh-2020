<html>
<head>
<title>Pretty (Simple) Geospatial Data Visualization in R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">R 中漂亮(简单)的地理空间数据可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/gorgeous-simple-geospatial-data-visualizations-in-r-878b41e8bb9a?source=collection_archive---------39-----------------------#2020-06-26">https://towardsdatascience.com/gorgeous-simple-geospatial-data-visualizations-in-r-878b41e8bb9a?source=collection_archive---------39-----------------------#2020-06-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b785" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 ggplot2、rgdal 和 maptools 制作华丽的渐变</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/3a679c738f8f66c07cf2d47b9d00ff7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7nc_VWOir984vknC6ZWYyQ.png"/></div></div></figure><p id="63eb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我最近在 R 中写了一篇关于<a class="ae lq" rel="noopener" target="_blank" href="/route-66-revisited-mapping-geospatial-data-in-r-371dd406cde0">地理空间可视化的介绍文章，这篇文章很快成为我阅读量最大的文章，增加了 5 倍(谢谢，顺便说一句！).看到人们对地理空间数据可视化如此感兴趣真是太棒了，因为在这一点上，它已经成为我在这个星球上最喜欢的事情之一。</a></p><p id="266d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">话虽如此，我觉得我已经在桌子上留下了一些卡片；首先，我没有讨论过 ggplot2。更好的是，第二种方式<em class="lr">甚至更漂亮。</em></p><p id="75c0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在本教程中，我们将使用 2010 年的人口普查数据来展示用 R 的 ggplot2 库绘图的奇迹。就像上次一样，<strong class="kw iu">只有 3 步</strong>—所以拿些爆米花，让我们开始吧！</p><h2 id="b255" class="ls lt it bd lu lv lw dn lx ly lz dp ma ld mb mc md lh me mf mg ll mh mi mj mk bi translated">步骤 1:下载 2010 年人口普查数据集</h2><p id="60c3" class="pw-post-body-paragraph ku kv it kw b kx ml ju kz la mm jx lc ld mn lf lg lh mo lj lk ll mp ln lo lp im bi translated">史上最简单的一步；去我的<a class="ae lq" href="https://github.com/amawest/mapping_R/blob/master/county_census.zip" rel="noopener ugc nofollow" target="_blank"> Github repo </a>下载 county_census.zip 就行了。</p><p id="3042" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是一个相当大的文件；一旦下载完毕，解压，你就可以开始了。</p><h2 id="c897" class="ls lt it bd lu lv lw dn lx ly lz dp ma ld mb mc md lh me mf mg ll mh mi mj mk bi translated">步骤 2:安装库并上传普查数据到 R</h2><p id="bfd7" class="pw-post-body-paragraph ku kv it kw b kx ml ju kz la mm jx lc ld mn lf lg lh mo lj lk ll mp ln lo lp im bi translated">我们将使用 3 R 库，它们是<code class="fe mq mr ms mt b">maptools</code>、<code class="fe mq mr ms mt b">rgdal</code>和<code class="fe mq mr ms mt b">ggplot2</code>。我们还将运行一个命令<code class="fe mq mr ms mt b">readShapeSpatial()</code>，它将提示您输入想要使用的文件。</p><ul class=""><li id="e2f8" class="mu mv it kw b kx ky la lb ld mw lh mx ll my lp mz na nb nc bi translated">出现提示时，一定要打开<code class="fe mq mr ms mt b">County_2010Census_DP1.shp</code> <em class="lr"> </em>(这是上一步下载的)。</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h2 id="1816" class="ls lt it bd lu lv lw dn lx ly lz dp ma ld mb mc md lh me mf mg ll mh mi mj mk bi translated">步骤 3:地理空间制图</h2><p id="fb73" class="pw-post-body-paragraph ku kv it kw b kx ml ju kz la mm jx lc ld mn lf lg lh mo lj lk ll mp ln lo lp im bi translated"><strong class="kw iu"> <em class="lr">例 1:佛罗里达州&amp;中位年龄</em> </strong></p><p id="6a18" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们将选择一个状态，创建一个模板，并用颜色填充它:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="13e3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">图表显示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/19dbabe219365779ea8710e3d8be4ba4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A2BKsEOPbQp0EyfmKMmGxQ.png"/></div></div><p class="ng nh gj gh gi ni nj bd b be z dk translated"><strong class="bd nk">左:</strong>粉色&amp;面霜，例 1；<strong class="bd nk">右</strong>:蓝色&amp;绿色，前。2</p></figure><p id="08e9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在重新创建时，“GEOID10”只是指 2010 年的人口普查，不需要更改。另一方面，第一行中的“12”代表佛罗里达州的 FIPS 代码，如果你绘制不同的州，这个代码<em class="lr">会</em>改变。<a class="ae lq" href="https://www.mcc.co.mercer.pa.us/dps/state_fips_code_listing.htm" rel="noopener ugc nofollow" target="_blank"> FIPS 代码</a>是常用的唯一标识符，它将每个州定义为一个从 1 到 50 的数字(美国领地也有自己的 FIPS 代码)。</p><p id="5914" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe mq mr ms mt b">DP_TableDescriptions.xlx</code>提供了我们可以根据人口普查中提供的答案绘制的所有变量的列表(对于本例，我选择了 DP0020001，<em class="lr">各县的平均年龄</em>)。你可以在<code class="fe mq mr ms mt b">county_census.zip</code>文件中找到这个 Excel 表格。</p><p id="25c1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">佛罗里达&amp;中位年龄图很好，因为老年人和年轻人的高数量组合构成了一个超级漂亮的梯度(谢谢你，雪鸟！).如果你想描绘另一个州，你可以参考<a class="ae lq" href="https://www.mcc.co.mercer.pa.us/dps/state_fips_code_listing.htm" rel="noopener ugc nofollow" target="_blank">这一页</a>，找到你选择的 FIPS 代码。否则，坚持佛罗里达就好了。</p><p id="9b8d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">不要画俄亥俄州，因为…嗯，你知道的。</p><p id="4dec" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="lr">例 2:路易斯安那州和平均家庭规模(+趣味色彩！)</em> </strong></p><p id="db7f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将再做一次，改变我们选择使用的州和人口普查数据——我喜欢提供两个例子，以便有人可以看到代码如何响应变化。</p><p id="0fb6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们使用<a class="ae lq" href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf" rel="noopener ugc nofollow" target="_blank"> R 颜色</a>来挑选一两个令人愉快的配色方案，并进行绘图:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="3c9f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">图表显示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/649c260a923cb7a8d92cca701b10dc6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tbtzm9XSVtbWmtYAjqsy7Q.png"/></div></div><p class="ng nh gj gh gi ni nj bd b be z dk translated"><strong class="bd nk">左:</strong> Camo，Ex.3<strong class="bd nk">右</strong>:红色，白色&amp;蓝色，例如。四</p></figure><p id="a7f9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这一次，我选择了迷彩的颜色(在美国农村长大，迷彩已经深深印在我的脑海里)和另一种红色、白色和蓝色，奇怪的是，这让我想起了黏糊糊的冰棍，而不是美国国旗。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/aa128948d59388c0186e9da14dbc7cfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uqwhijafg9UvF596i0Rnzg.jpeg"/></div></div><p class="ng nh gj gh gi ni nj bd b be z dk translated">尼克·托伦塔利在<a class="ae lq" href="/s/photos/popsicles?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="4fb3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">另外，你会注意到在第二个例子中渐变的范围发生了巨大的变化——因为我们是手动插入的，所以在你精确地描绘了整个范围并设置了一个精确的中间值之前，对它进行试验是很重要的(稍微搜索一下就可以避免太多的猜测)。<strong class="kw iu">如果任何州县持有超出指定范围的值，它们在绘制图表时将显示为令人讨厌的灰色。</strong></p><h2 id="12a6" class="ls lt it bd lu lv lw dn lx ly lz dp ma ld mb mc md lh me mf mg ll mh mi mj mk bi translated">结论</h2><p id="3f8c" class="pw-post-body-paragraph ku kv it kw b kx ml ju kz la mm jx lc ld mn lf lg lh mo lj lk ll mp ln lo lp im bi translated">我希望你对这个教程有一点兴趣(我非常喜欢想象伪装中的路易斯安那州！).如果你有任何问题，运行代码的问题，或者只是想打个招呼，请在下面评论🙂。你也可以通过我的个人网站或<a class="ae lq" href="https://twitter.com/amawest_" rel="noopener ugc nofollow" target="_blank">推特联系我。</a></p><p id="5d07" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">谢谢，祝你一周愉快！</p><p id="026a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">——阿曼达·❤️</p></div></div>    
</body>
</html>