<html>
<head>
<title>Google Sheets, Meet Pandas DataFrame</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">è°·æ­ŒåºŠå•ï¼Œé‡è§ç†ŠçŒ«æ•°æ®æ¡†</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/google-sheets-pandas-dataframe-6b8666f9cf6?source=collection_archive---------11-----------------------#2020-08-09">https://towardsdatascience.com/google-sheets-pandas-dataframe-6b8666f9cf6?source=collection_archive---------11-----------------------#2020-08-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3e43" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">ğŸè·³ç”µå­è¡¨æ ¼ä¹‹èˆ:ç®€å•çš„æ–¹æ³•ã€‚</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/35c44f8d3938cfa9c12b6ad2dfae239d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*56FJ_Xjo5YsYhszg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">ç”±<a class="ae kv" href="https://unsplash.com/@mbaumi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">ç±³å¡Â·é²æ¢…æ–¯ç‰¹</a>åœ¨<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>æ‹æ‘„çš„ç…§ç‰‡</p></figure><p id="8aa0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¯èƒ½æ˜¯å› ä¸ºåœ¨é”®ç›˜åé¢å‘†çš„æ—¶é—´å¤ªé•¿äº†ã€‚ä½†æ˜¯æœ‰æ—¶å€™æˆ‘åœ¨ç½‘ä¸Šçš„é˜…è¯»å’Œè§‚çœ‹è®©æˆ‘è§‰å¾—æˆ‘æ˜¯ä¸€ä¸ªæ¿’ä¸´ç­ç»çš„å¼€å‘è€…ã€‚åœ¨ç”µå­è¡¨æ ¼ä¸­å·¥ä½œçš„äººã€‚æ¯ä¸€å¤©ã€‚</p><p id="af24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½ èƒ½ç›¸ä¿¡å—ï¼Ÿå¼€å‘äººå‘˜ï¼Œåƒä¸å­˜åœ¨çš„ç”µå­è¡¨æ ¼ä¸€æ ·è¿‡ä»–ä»¬çš„ç”Ÿæ´»ã€‚å¦‚æœä½ æ˜¯è¿™äº›äººä¸­çš„ä¸€å‘˜ï¼Œæˆ‘æƒ³è§è§ä½ ã€‚è¦çŸ¥é“<em class="ls">ä½ </em>çš„å­˜åœ¨ï¼Œè¿™å¹¶ä¸å…¨æ˜¯æˆ‘è€³ç•”çš„ç‹‚è¨€ã€‚</p><p id="b24c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¯¹äºæˆ‘ä»¬å…¶ä½™çš„äººæ¥è¯´ï¼Œç”µå­è¡¨æ ¼æ˜¯éå¸¸é‡è¦çš„ä¸œè¥¿ã€‚çˆ±ä»–ä»¬æˆ–è€…æ¨ä»–ä»¬ï¼Œé‚£äº›äºŒè¿›åˆ¶çš„è¡Œå’Œåˆ—æ˜¯æ²¡æœ‰ç”¨çš„ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå“²å­¦è¯¾å°±æ˜¯<em class="ls">ç”µå­è¡¨æ ¼å°±æ˜¯</em>ã€‚æ¯ä¸ªéå¼€å‘äººå‘˜çš„å‘˜å·¥éƒ½åœ¨ç”µå­è¡¨æ ¼ä¸­æ‹¯æ•‘äº†æ¸…æ´å·¥çš„ç”Ÿå‘½ã€‚</p><blockquote class="lt lu lv"><p id="19bb" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><em class="iq">â€œç”µå­è¡¨æ ¼æ˜¯ã€‚â€æŠŠè¿™ä¸ªå­˜åœ¨ä¸»ä¹‰çš„é‡ç£…ç‚¸å¼¹äº¤ç»™ä¸€æ‰€å¤§å­¦ï¼›å“²å­¦è£èª‰åšå£«å­¦ä½è‚¯å®šä¼šéšä¹‹è€Œæ¥ã€‚</em></p></blockquote><p id="5414" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Excel å’Œ Google Sheetsï¼Œå®ƒä»¬æ¯«æ— ç”¨å¤„ï¼›é™¤éæˆ‘ä»¬æŠŠè‡ªåŠ¨åŒ–å’ŒçŸ¥è¯†å·¥ä½œè€…ä¼ é€’ç”µå­è¡¨æ ¼çš„ä»ªå¼åˆ†å¼€ï¼Œå¦åˆ™æˆ‘ä»¬çš„ç”Ÿäº§åŠ›ä¹Ÿä¸ä¼šæé«˜ã€‚</p><h1 id="ce6c" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">æˆ‘çš„ä¸‰æ®µä¸¤åˆ†é’±</h1><p id="4460" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">å°±ä¸ªäººè€Œè¨€ï¼Œæˆ‘å–œæ¬¢å¥½çš„ç”µå­è¡¨æ ¼ã€‚å¯¹äºç®¡ç†æ•°æ®ï¼Œå¿«é€Ÿå’Œè‚®è„çš„è®¡ç®—ï¼Œå¯è§†åŒ–ä¸€ç»´æ—¶é—´åºåˆ—â€¦5 æ¬¡ä¸­æœ‰ 4 æ¬¡æˆ‘ä¼šæ‰“å¼€ Excel æˆ– Google å·¥ä½œè¡¨ï¼Œè€Œä¸æ˜¯å¯åŠ¨ Jupyter æœåŠ¡å™¨ã€‚</p><p id="d044" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">é™¤æ­¤ä¹‹å¤–ï¼Œ<em class="ls">ä¸šåŠ¡ä¸­çš„ spreadsheetitis </em>æ˜¯ä¸çŸ¥é“å¦‚ä½•ç§»åŠ¨æ•°æ®çš„ä¸€ç§ç—‡çŠ¶ã€‚æˆ‘äº²çœ¼è§è¿‡â€œäººè‚‰è·¯ç”±å™¨â€é—®é¢˜ä¸¥é‡åˆ° 20 å¤šä¸ª(20 ä¸ªï¼)äººä»¬åœ¨æœ€ç»ˆâ€”â€”å¹¸è¿çš„æ˜¯â€”â€”å°†ä¸€ä¸ªç‰ˆæœ¬çš„ç”µå­è¡¨æ ¼æ”¾å…¥â€œæ•°æ®åº“â€(å¦ä¸€ä¸ªç”µå­è¡¨æ ¼)ä¹‹å‰æ¥è§¦è¿‡å®ƒã€‚</p><p id="2248" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿˜æœ‰ç”µå­è¡¨æ ¼ã€‚å½“æœ‰ä¸€ä¸ªå¤§å†™çš„â€œSâ€çš„ç”µå­è¡¨æ ¼æ—¶ï¼Œä½ å°±çŸ¥é“è¿™ä¸ªè¡Œä¸šæ˜¯æ•°æ®åœ°ç‹±ã€‚ç»ç†ä»¬è®¤ä¸º<em class="ls">å°±æ˜¯</em>ä¸šåŠ¡ã€‚</p><h1 id="c973" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">è‡ªåŠ¨åŒ–ä½ çš„ç†æ™ºä¹‹è·¯</h1><p id="f945" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">æˆ‘ä»¬å°†è®¨è®ºå‡ ä¸ªç”¨äº Python ä¸­ Google Sheets I/O çš„åº“ã€‚æ— è®ºæ˜¯å“ªç§æ–¹æ³•ï¼Œä½ éƒ½å¿…é¡»åœ¨è°·æ­Œäº‘å¹³å°(è°·æ­Œç‰ˆçš„ AWS å’Œ Azure)çš„è¿·å®«èˆ¬çš„æ§åˆ¶å°å†…å¯ç”¨ Google Sheets APIã€‚å¹¸è¿çš„æ˜¯ï¼ŒGoogleâ€”â€”go figureâ€”â€”åœ¨æ§åˆ¶å°ä¸­æœ‰ä¸€ä¸ªå¾ˆæ£’çš„æœç´¢åŠŸèƒ½ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥å¸®åŠ©æ‚¨è¿›è¡Œè®¾ç½®ã€‚</p><h2 id="45b3" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">ç–¯ç‹‚ç¬¬ä¸€â€”â€”ä»è°·æ­Œäº‘å¹³å°è·å–ä¸€ä¸ª<code class="fe ni nj nk nl b">credentials.json</code>æ–‡ä»¶</h2><p id="e583" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">å‰å¾€<a class="ae kv" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">console.cloud.google.com/</a>ï¼Œä½¿ç”¨è°·æ­Œè´¦æˆ·ç™»å½•ï¼Œè®¿é—®æ‚¨æƒ³è¦è‡ªåŠ¨åŒ–çš„ç”µå­è¡¨æ ¼ã€‚è¯¥ API å¯ç”¨äº GSuite å’Œå…è´¹çš„ Google è´¦æˆ·ã€‚å¦‚æœè¿™æ˜¯ä¸€ä¸ªå·¥ä½œæ‹¥æœ‰çš„ç”µå­è¡¨æ ¼ï¼Œä¸ GCP è®¿é—®çš„ç®¡ç†å‘˜å°†ä¸å¾—ä¸æŒ‰ç…§è¿™äº›æ­¥éª¤ï¼Œç»™ä½ çš„å‡­è¯æ–‡ä»¶ã€‚</p><p id="0c86" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">é€‰æ‹©é¡¶éƒ¨å¯¼èˆªæ ä¸­çš„é¡¹ç›®ã€‚æ¯ä¸ªèµ„æºéƒ½ä¿å­˜åœ¨é¡¹ç›®ä¸­ï¼Œå°±åƒ Azure ä¸­çš„èµ„æºç»„ä¸€æ ·ã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰ï¼Œè¯·é€‰æ‹©é¡¹ç›®ä¸‹æ‹‰åˆ—è¡¨å’Œâ€œæ–°å»ºé¡¹ç›®â€ã€‚ç„¶åæœç´¢â€œGoogle Sheets APIâ€ï¼Œå¦‚æœä½ æ˜¯ä¸ªè™å¾…ç‹‚ï¼Œæƒ³ç”¨é¼ æ ‡æ¢ç´¢ä»ªè¡¨ç›˜ï¼Œå°±åœ¨â€œAPIs &amp; Servicesâ€ä¸‹é¢ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/ecfdd15b85725a83acfe845407275620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p0Utb-hqsMhwN7Kli3w1CA.png"/></div></div></figure><p id="11c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">â€œå¯ç”¨â€APIã€‚</p><p id="0a5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨ä½ éœ€è¦ä¸º Google Drive API åšåŒæ ·çš„äº‹æƒ…ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/5e162ad7e0ae7585f1128fa91b39e9d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_N33qFWGP6XIkjS2bpyzgA.png"/></div></div></figure><p id="b5b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ¥ä¸‹æ¥ï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªæœåŠ¡å¸æˆ·ï¼Œç„¶åæ‚¨å°†ä¸ºå…¶åˆ›å»ºå‡­æ®ã€‚</p><p id="3592" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ­¥éª¤:</p><ul class=""><li id="eca1" class="no np iq ky b kz la lc ld lf nq lj nr ln ns lr nt nu nv nw bi translated">ä½ åœ¨è°·æ­Œäº‘å¹³å°&gt;è°·æ­Œå·¥ä½œè¡¨ API åœ¨<a class="ae kv" href="console.cloud.google.com/apis/api/sheets.googleapis.com" rel="noopener ugc nofollow" target="_blank">console.cloud.google.com/apis/api/sheets.googleapis.com</a></li><li id="aea4" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">å‰å¾€ä¾§è¾¹æ ä¸Šçš„å‡­è¯<code class="fe ni nj nk nl b">ğŸ— Credentials</code>ã€‚</li><li id="068c" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">é€‰æ‹©<code class="fe ni nj nk nl b">+ CREATE CREDENTIALS</code> &gt;æœåŠ¡è´¦å·ã€‚OAuth æ˜¯ä¸€ä¸ªä¸åŒçš„æ•…äº‹ã€‚æœ¬æ–‡æ¶µç›–äº†æœåŠ¡å™¨ç«¯çš„å†…éƒ¨ä½¿ç”¨ã€‚åˆ›å»ºæœåŠ¡å¸æˆ·ã€‚</li><li id="08ba" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">ä¸‹ä¸€ä¸ªè§†å›¾æ˜¯ä¸ºæœåŠ¡å¸æˆ·é€‰æ‹© IAM è§’è‰²ã€‚è¿™æ˜¯å¯é€‰çš„ï¼Œè·³è¿‡å®ƒã€‚</li><li id="06e1" class="no np iq ky b kz nx lc ny lf nz lj oa ln ob lr nt nu nv nw bi translated">æ¥ä¸‹æ¥æ˜¯â€œæˆäºˆç”¨æˆ·å¯¹æ­¤æœåŠ¡å¸æˆ·çš„è®¿é—®æƒé™(å¯é€‰)â€ã€‚ä¹Ÿè·³è¿‡ã€‚</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/62571126964d3c529116eba717ef7fbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PIQajqCphqWw87KMnnS2cA.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/61093b2d7c5de0d0af7c8e42015a13c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IPRXI9DM1mZ-nufhd1XIHA.png"/></div></div></figure><p id="6c72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨ï¼Œæ‚¨å°†å›åˆ°â€œé¡¹ç›®[é¡¹ç›®åç§°]çš„æœåŠ¡å¸æˆ·â€å±å¹•ã€‚ç‚¹å‡»è¶…é“¾æ¥<code class="fe ni nj nk nl b">Email</code>å­—æ®µæˆ–æ±‰å ¡èœå•(ä¸‰ç‚¹)&gt; <code class="fe ni nj nk nl b">Create key</code>ï¼Œé€‰æ‹©è¡¨æ ¼ä¸­çš„æœåŠ¡è´¦æˆ·ã€‚</p><p id="f291" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ— è®ºå“ªç§æ–¹å¼ï¼Œ<code class="fe ni nj nk nl b">ADD KEY</code>æˆ–<code class="fe ni nj nk nl b">Create key</code>ï¼Œé€‰æ‹© JSON é”®ç±»å‹å’Œ<code class="fe ni nj nk nl b">CREATE</code>ã€‚è¿™ä¼šå°†ä¸€ä¸ª JSON æ–‡ä»¶ä¸‹è½½åˆ°æ‚¨çš„è®¡ç®—æœºä¸Šã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/f408772d8c75c43359f146ed5b5345cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UvY9BlC816XXKDInHLbAGw.png"/></div></div></figure><p id="fd81" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æœ€åä¸€ä»¶äº‹:ç”µå­è¡¨æ ¼ã€‚è¿™é‡Œæˆ‘ä¸ºè¿™ä¸ªä¾‹å­åˆ›å»ºäº†ä¸€ä¸ªã€‚è¯·æ³¨æ„ Omnibar ä¸­ URL çš„çªå‡ºæ˜¾ç¤ºéƒ¨åˆ†ã€‚è¿™æ˜¯æ–‡æ¡£çš„ IDã€‚å¤§å¤šæ•°åº“éƒ½ç»™å‡ºäº†å¼•ç”¨æ•´ä¸ª URL æˆ–è€…åªå¼•ç”¨è¿™ä¸ª ID çš„é€‰æ‹©ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/0ba1a393fcdb734f6bce437c4a5bc441.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jRH_QHUeNJdIYk-9aKFrgg.png"/></div></div></figure><p id="43f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ‚¨å¯ä»¥ä»<a class="ae kv" href="https://docs.google.com/spreadsheets/d/11zmk55OFpFL5HW_MhPfqfC-GjRQvHlI_M-jtHcBzyzA/edit?usp=sharing" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œ</a>æŸ¥çœ‹å¹¶ä¸‹è½½ç”µå­è¡¨æ ¼ã€‚</p><p id="c5d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºæœåŠ¡å¸æˆ·æ‰“å¼€ä» GCP ä¸‹è½½çš„<code class="fe ni nj nk nl b">credentials.json</code>æ–‡ä»¶ã€‚å¤åˆ¶<code class="fe ni nj nk nl b">client_email</code>å±æ€§ä¸­çš„ç”µå­é‚®ä»¶å€¼ã€‚ç”¨è¿™å°é‚®ä»¶åˆ†äº«è°·æ­Œè¡¨å•ã€‚è¿™ä½¿æœåŠ¡å¸æˆ·å¯ä»¥è®¿é—®åœ¨å¦ä¸€ä¸ªå¸æˆ·(ä¸æ˜¯æœåŠ¡å¸æˆ·)ä¸Šåˆ›å»ºçš„ç”µå­è¡¨æ ¼ã€‚</p><p id="f09e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å”·ã€‚è¿™æ˜¯æ‰€æœ‰è°·æ­ŒåŸºç¡€è®¾æ–½çš„ä¸œè¥¿ã€‚æˆ‘ä¿è¯ã€‚</p><p id="dd36" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹å†™ Python ä»£ç äº†ã€‚</p><h2 id="a48c" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">å°è¯•å¼€æºåº“</h2><p id="8df3" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">è°·æ­Œæœ‰ä¸€ä¸ªç”¨äº<a class="ae kv" href="https://developers.google.com/sheets/api/" rel="noopener ugc nofollow" target="_blank">å·¥ä½œè¡¨</a>çš„ APIï¼Œå°±åƒå®ƒç”¨äºæ‰€æœ‰è°·æ­Œé©±åŠ¨äº§å“ä¸€æ ·ã€‚æœ‰äº†å®ƒçš„<a class="ae kv" href="https://developers.google.com/sheets/api/quickstart/python" rel="noopener ugc nofollow" target="_blank"> Python åº“</a>ï¼Œæ²¡æœ‰ä»€ä¹ˆæ˜¯ä½ åšä¸åˆ°çš„ã€‚</p><p id="dcea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å°½ç®¡å¦‚æ­¤ï¼Œä½ è¿˜æ˜¯ä¼šç–¯ç‹‚åœ°ä½¿ç”¨å®ƒã€‚</p><p id="d3fc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘å¯¹ç”µå­è¡¨æ ¼çš„å¼ºç¡¬æ€åº¦æ˜¯ï¼Œå®ƒä»¬æ˜¯å‘å•†ä¸šç”¨æˆ·ä¼ é€’æ•°æ®çš„ä¸€ç§å¯ç§»æ¤çš„ã€å¯è§†åŒ–çš„æ–¹å¼ã€‚æ•°æ®çŸ©å½¢ï¼Œå·¦ä¸Šè§’çš„å•å…ƒæ ¼ A1ã€‚ä¸æ˜¯ç©é²å‹ƒÂ·ç½—æ–¯ğŸ¨å…·æœ‰æ¡ä»¶æ ¼å¼çš„ğŸ–Œï¼Œåœ¨åŒä¸€å·¥ä½œè¡¨ä¸­å½¢æˆç¾¤å²›çš„æ•°æ®å²›ï¼Œæˆ–åˆ›å»ºç±»ä¼¼ Tableau çš„å›¾è¡¨ä»ªè¡¨æ¿ã€‚</p><p id="703a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¹¶ä¸æ˜¯è¯´æ‰€æœ‰è¿™äº›äº‹æƒ…éƒ½ä¸å¥½ã€‚æˆ‘å·²ç»ç”¨ç”µå­è¡¨æ ¼è‡ªåŠ¨åŒ–æ‰è¿›é‚£äº›å…”å­æ´å¾ˆå¤šæ¬¡äº†ã€‚åªæ˜¯ï¼Œå½“ä½ æ·±å…¥ç ”ç©¶ Google Sheets è¿™äº›å¹´æ¥å†…ç½®çš„æ‰€æœ‰åŠŸèƒ½æ—¶ï¼Œç¼–ç çš„å›æŠ¥æ—¶é—´æ¯”ä¸‹é™å¾—å¾ˆå¿«ã€‚</p><p id="cca8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™ç¯‡æ–‡ç« æ˜¯å…³äºæ•°æ®è¾“å…¥å’Œæ•°æ®è¾“å‡ºçš„ã€‚æœ€å¿«è§£å†³é—®é¢˜çš„æ—¶é—´èƒœå‡ºã€‚</p><p id="4950" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">åœ¨ Python æ•°æ®æ–¹é¢ï¼Œè¿™æ„å‘³ç€ä½¿ç”¨ pandas <a class="ae kv" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.htmlhttps://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" rel="noopener ugc nofollow" target="_blank">æ•°æ®å¸§</a>ã€‚åœ¨ Google Sheets è¿æ¥å™¨æ–¹é¢ï¼Œå®ƒæ›´æ‚¬è€Œæœªå†³ã€‚æ˜¯æ—¶å€™å» GitHub è´­ç‰©äº†ã€‚</p><p id="7d3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºæ­¤ï¼Œè¿™é‡Œæœ‰ä¸‰ä¸ªæˆ‘æœ€å–œæ¬¢çš„åŒ…è£… Google Sheets API çš„ç¬¬ä¸‰æ–¹ Python åº“:</p><p id="c41c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">EZSheets</p><p id="f01f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">é˜¿å°”Â·æ–¯å¨åŠ ç‰¹ä¸ä¼šåšé”™äº‹ã€‚ä»–çš„ä¹¦<em class="ls">ç”¨ Python è‡ªåŠ¨åŒ–æ¯ç‡¥çš„ä¸œè¥¿</em>ä¸€æ‰‹æ•™ä¼šäº†æˆ‘å¦‚ä½•ä¸ºé‡‘é’±ç¼–ç ã€‚æˆ‘è¿˜æ˜¯ä¸€ä¸ªæœˆå‚è€ƒå‡ æ¬¡ã€‚</p><p id="39b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ–¯å¨åŠ ç‰¹æ˜¯ä¸€ä¸ªå·¨å¤§çš„å¤§è„‘ï¼Œä»–æœ‰èƒ½åŠ›æŠŠå¤æ‚çš„ä¸œè¥¿åˆ†è§£æˆæˆ‘èƒ½æ¶ˆåŒ–çš„å©´å„¿é£Ÿå“ã€‚EZSheets  (GitHub)æ˜¯ä»–çš„åˆ›é€ ï¼Œè¿˜æœ‰ Gmailã€æ—¥å†å’Œ Drive çš„å…„å¼Ÿç•Œé¢ã€‚</p><p id="d7f0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">EZSheets ä»¥å…¶ä¸€æ¬¡æ›´æ–°ä¸€ç»„æ•°æ®çš„æ¸…æ™°æ–¹æ³•è€Œå¤§æ”¾å¼‚å½©ã€‚ä¹Ÿç”¨äºé€‰æ‹©åˆ—å’Œè¡Œã€‚æˆ‘è¿˜æ²¡æœ‰æ‰¾åˆ°å¦ä¸€ä¸ªåº“èƒ½åƒè¿™ä¸ªåº“ä¸€æ ·æ•æ‰åˆ°éå†å•å…ƒæ ¼çš„å¤æ‚æ€§ã€‚å…¶ä»–åº“å¹¶ä¸æ¯” Sheets API æ›´å¥½ï¼Œå…¶ä¸­ç”¨äºå¤„ç†æ•°æ®çš„åµŒå¥—çš„<code class="fe ni nj nk nl b">for</code>å¾ªç¯è®©æˆ‘çœ©æ™•ã€‚</p><p id="af0c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">gspread</p><p id="354f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">gspread  (GitHub)æ˜¯å¦ä¸€ä¸ªå¤§è„‘ Anton Burnashev è®¾è®¡çš„åº“ã€‚gspread éå¸¸å—æ¬¢è¿ï¼Œå·²ç»æˆä¸ºå¸Œæœ›ä½¿ç”¨ Google Sheets çš„ Python å¼€å‘äººå‘˜çš„äº‹å®ä¸Šçš„åº“ã€‚</p><p id="a921" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æœ‰å……åˆ†çš„ç†ç”±ã€‚æ–‡æ¡£<a class="ae kv" href="https://gspread.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">å¾ˆæ£’ï¼Œæºä»£ç æ¸…æ™°ï¼Œå¸ƒå±€åˆç†ï¼Œæ–‡æ¡£å­—ç¬¦ä¸²ä¹Ÿä¸é”™ã€‚å¦å¤–ï¼Œgspread çš„ç•Œé¢åŒ…è£…äº†ä¸€äº› Google Sheets æ ¼å¼åŠŸèƒ½ã€‚å®ƒä¹Ÿæœ‰å¤„ç†ç†ŠçŒ«å’Œ NumPy æ•°ç»„çš„æ–¹æ³•ã€‚</a></p><p id="5810" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">gspread-dataframe(è·èƒœè€…)</p><p id="dab6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸€ä¸ªç”±ç½—å®¾Â·æ‰˜é©¬æ–¯æ„å»ºçš„ gspread åº“çš„åŒ…è£…å™¨ï¼Œ<a class="ae kv" href="https://github.com/robin900/gspread-dataframe" rel="noopener ugc nofollow" target="_blank">gspread-data frame</a>(GitHub)æ˜¯æˆ‘ç”¨ DataFrames è¯»å†™ Google Sheets çš„é¦–é€‰åŒ…ã€‚</p><p id="a248" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ–‡æ¡£<a class="ae kv" href="https://pythonhosted.org/gspread-dataframe/" rel="noopener ugc nofollow" target="_blank">å¾ˆå¥½ï¼Œä½†æ˜¯æœ‰ç‚¹å¤šä½™ã€‚æºä»£ç å¾ˆç®€çŸ­ï¼Œæœ‰ä¸¤ä¸ªå‡½æ•°ï¼Œ<code class="fe ni nj nk nl b">get_as_dataframe</code>å’Œ<code class="fe ni nj nk nl b">set_with_dataframe</code>ã€‚</a></p><p id="ced6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">gspread-dataframe æ˜¯æˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨çš„ã€‚</p><h2 id="9405" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">å¯†ç </h2><p id="b1e3" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">åœºæ™¯:æˆ‘ä»¬æœ‰ä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„ç”µå½±ä¹‹å¤œçš„æ•°æ®è¡¨ã€‚åŒäº‹éœ€è¦æ¯å¤©æ‰‹åŠ¨å‘åˆ—ä¸­æ·»åŠ å€¼ã€‚å½“æˆ‘ä»¬å®‰æ’æ–°çš„ç”µå½±ä¹‹å¤œæ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ”¶é›†è¾“å…¥åˆ°è¡¨å•ä¸­çš„æ‰‹å†™æ•°æ®ï¼Œå¹¶åœ¨é¡¶éƒ¨æ·»åŠ æ–°çš„ç”µå½±ã€‚</p><p id="f4a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™ä¸ªä¾‹å­æ˜¯è™šæ„çš„ï¼Œä½†æ˜¯æˆ‘æœ‰å¤šä¸ªä¸­å‹ç§‘æŠ€å…¬å¸çš„å®¢æˆ·è¦æ±‚è¿™ä¸ªåŠŸèƒ½ã€‚ä½ å¯ä»¥æƒ³è±¡æœ‰ä¸€ä¸ªæ•°æ®åº“ï¼Œé‡Œé¢æœ‰åƒ<code class="fe ni nj nk nl b">movies</code>å’Œ<code class="fe ni nj nk nl b">movienights</code>è¿™æ ·çš„è¡¨ï¼Œæœ‰ä¸€ä¸ªè§†å›¾åŠŸèƒ½å°†è¿™äº›è¡¨è¿æ¥åˆ°è¿™ä¸ªè¡¨ä¸­ï¼Œç”µå½±ä¹‹å¤œçš„åè°ƒå‘˜å¸®åŠ©å¡«å†™è¿™ä¸ªè¡¨ã€‚</p><p id="dae7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">é™¤äº†æˆç†Ÿçš„ web åº”ç”¨ç¨‹åºæˆ–è¡¨å•è½¯ä»¶ï¼Œä½¿ç”¨ç”µå­è¡¨æ ¼ä½œä¸ºè¡¨ç¤ºå±‚å’Œæ•°æ®è¾“å…¥å±‚å®é™…ä¸Šéå¸¸æ–¹ä¾¿ã€‚</p><blockquote class="lt lu lv"><p id="9eb8" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><em class="iq">å¥–åŠ±:æœ‰äº† pandas 1.1.0ï¼Œæˆ‘ä»¬å¯ä»¥ä» DataFrame ä¸Šçš„ä¸€ä¸ªæ–¹æ³•ç”Ÿæˆä¸€ä¸ªæ²¡æœ‰ç´¢å¼•çš„å‡ä»·è¡¨ï¼</em></p><p id="1504" class="kw kx ls ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated"><em class="iq">df . headâ‘ ã€‚to _ markdown(index = False)<br/><br/>' | IMDB URL | IMDB Score | Length | Attendees | Mood | Staff Notes | \ n |:â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”Length | enders | Mood |ğŸ˜“|å…‹æ˜Ÿå¼€é£æœºâœˆ |' </em></p></blockquote><p id="c12c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æˆ‘ä»¬çš„æ•°æ®:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oe of l"/></div></figure><h2 id="fd02" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">å†™å…¥ Google å·¥ä½œè¡¨</h2><p id="c282" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">å…ˆå®‰è£…<code class="fe ni nj nk nl b">gspread_dataframe</code>ã€‚å› ä¸ºå®ƒæ˜¯<code class="fe ni nj nk nl b">gspread</code>çš„åŒ…è£…å™¨ï¼Œæˆ‘ä»¬å°†éœ€è¦é‚£ä¸ªåº“å’Œå®ƒçš„<code class="fe ni nj nk nl b">oauth2client</code>ä¾èµ–ã€‚</p><pre class="kg kh ki kj gt og nl oh oi aw oj bi"><span id="7c28" class="mw ma iq nl b gy ok ol l om on">pip install gspread_dataframe gspread oauth2client</span></pre><p id="ab17" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">æ£€æŸ¥æ‚¨æ˜¯å¦å¯ä»¥è¿æ¥åˆ°å·¥ä½œè¡¨:</p><pre class="kg kh ki kj gt og nl oh oi aw oj bi"><span id="4a4b" class="mw ma iq nl b gy ok ol l om on">$ ipython<br/>Python 3.8.1 (tags/v3.8.1:1b293b6, Dec 18 2019, 23:11:46) [MSC v.1916 64 bit (AMD64)]<br/>Type 'copyright', 'credits' or 'license' for more information<br/>IPython 7.12.0 -- An enhanced Interactive Python. Type '?' for help.<br/>In [1]: import gspread<br/>   ...: from gspread_dataframe import (get_as_dataframe,<br/>   ...:                                set_with_dataframe)<br/>   ...: from oauth2client.service_account import ServiceAccountCredentials<br/>   ...: scope = ["https://spreadsheets.google.com/feeds",<br/>   ...:          "https://www.googleapis.com/auth/drive"]<br/>   ...: credentials = ServiceAccountCredentials.from_json_keyfile_name("./credentials.json", scope)<br/>   ...: gc = gspread.authorize(credentials)<br/>   ...: gc.open_by_key("11zmk55OFpFL5HW_MhPfqfC-GjRQvHlI_M-jtHcBzyzA")<br/>Out[1]: &lt;Spreadsheet 'Google Sheets Automation! ğŸ' id:11zmk55OFpFL5HW_MhPfqfC-GjRQvHlI_M-jtHcBzyzA&gt;</span></pre><p id="dfd8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¦‚æœè¿æ¥æœ‰é—®é¢˜ï¼Œè¯·é˜…è¯»ç”±<code class="fe ni nj nk nl b">gspread</code>æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå®ƒéå¸¸æœ‰ç”¨ã€‚è®°ä½ï¼ŒJSON æ–‡ä»¶ä¸‹è½½çš„å¯†é’¥æœ‰ä¸€ä¸ª<code class="fe ni nj nk nl b">client_email</code>ã€‚è¯¥ç”µå­é‚®ä»¶éœ€è¦ä¸å…¶å…±äº«å·¥ä½œè¡¨ã€‚OAuth åº“éœ€è¦åœ¨æ­£ç¡®çš„æ–‡ä»¶è·¯å¾„ä¸‹è®¿é—®<code class="fe ni nj nk nl b">credentials.json</code>ã€‚è®°å¾—æŠŠæ–‡ä»¶é‡å‘½åä¸º<code class="fe ni nj nk nl b">credentials.json</code>ã€‚</p><p id="8a01" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨æ¥ç»™ Google Sheets å†™ä¿¡ã€‚</p><pre class="kg kh ki kj gt og nl oh oi aw oj bi"><span id="b84e" class="mw ma iq nl b gy ok ol l om on"># gsheets.py<br/>â€‹<br/>import gspread<br/>from gspread_dataframe import (get_as_dataframe,<br/>                               set_with_dataframe)<br/>from oauth2client.service_account import ServiceAccountCredentials<br/>import pandas as pd<br/>â€‹<br/>â€‹<br/>FILE_KEY: str = "11zmk55OFpFL5HW_MhPfqfC-GjRQvHlI_M-jtHcBzyzA"<br/>SHEET_NAME: str = "movie night"<br/>â€‹<br/>â€‹<br/>def _get_worksheet(<br/>    key:str,<br/>    worksheet_name:str,<br/>    creds:"filepath to Google account credentials"="credentials.json",<br/>    ) -&gt; gspread.Worksheet:<br/>    """ return a gspread Worksheet instance for given Google Sheets workbook/worksheet """<br/>    scope = ["https://spreadsheets.google.com/feeds",<br/>             "https://www.googleapis.com/auth/drive"]<br/>    credentials = ServiceAccountCredentials.from_json_keyfile_name(creds, scope)<br/>    gc = gspread.authorize(credentials)<br/>    wb = gc.open_by_key(key)<br/>    sheet = wb.worksheet(worksheet_name)<br/>    return sheet<br/>â€‹<br/>â€‹<br/>def write(sheet: gspread.Worksheet, df: pd.DataFrame, **options) -&gt; None:<br/>    set_with_dataframe(sheet, df,<br/>                     include_index=False,<br/>                     resize=True,<br/>                     **options)</span></pre><p id="22f5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½¿ç”¨è¿™äº›å‡½æ•°:</p><pre class="kg kh ki kj gt og nl oh oi aw oj bi"><span id="ba35" class="mw ma iq nl b gy ok ol l om on">sh: gspread.Worksheet = _get_worksheet(FILE_KEY, SHEET_NAME)<br/>â€‹<br/>""" Here you are getting your data. Usually this would be a<br/>database. But it could be another spreadsheet, serialized data,<br/>generated from Python code... wherever. """<br/>df = pd.read_pickle("./movienight2.pickle")<br/>â€‹<br/>write(sh, df)</span></pre><p id="fd72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ni nj nk nl b">set_as_dataframe</code>(ä¿¡ç”¨ç½—å®¾Â·æ‰˜é©¬æ–¯ï¼Œ<code class="fe ni nj nk nl b">gspread-dataframe.py</code>)é€‰é¡¹:</p><pre class="kg kh ki kj gt og nl oh oi aw oj bi"><span id="c09b" class="mw ma iq nl b gy ok ol l om on">:param worksheet: the gspread worksheet to set with content of DataFrame.<br/>:param dataframe: the DataFrame.<br/>:param include_index: if True, include the DataFrame's index as an<br/>        additional column. Defaults to False.<br/>:param include_column_header: if True, add a header row or rows before data with<br/>        column names. (If include_index is True, the index's name(s) will be<br/>        used as its columns' headers.) Defaults to True.<br/>:param resize: if True, changes the worksheet's size to match the shape<br/>        of the provided DataFrame. If False, worksheet will only be<br/>        resized as necessary to contain the DataFrame contents.<br/>        Defaults to False.<br/>:param allow_formulas: if True, interprets `=foo` as a formula in<br/>        cell values; otherwise all text beginning with `=` is escaped<br/>        to avoid its interpretation as a formula. Defaults to True.</span></pre><p id="1890" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Python å†™ Google Sheetsï¼</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/5495949e4cc490ca43c1fdca59ac7958.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8lFw4C1xLCm2UKb98Q3hUA.png"/></div></div></figure><p id="b2b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸é”™ï¼(æˆ‘å–œæ¬¢çœ‹ç”µè„‘åšè‹¦å·¥ã€‚æ„å‘³ç€æˆ‘ä¸ç”¨å·¥ä½œäº†ã€‚ğŸ˜„)æ³¨æ„<code class="fe ni nj nk nl b">resize=True</code>é€‰é¡¹æ˜¯å¦‚ä½•ä½¿å·¥ä½œè¡¨é€‚åº”æ•°æ®æ¡†å½¢çŠ¶çš„ã€‚</p><p id="1e1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸è¿‡ï¼Œè¿˜å¯ä»¥æ›´å¥½ã€‚åœ¨å†™å…¥å·¥ä½œè¡¨ä¹‹å‰ï¼Œå°†å¯¹æ•°æ®å¸§è¿›è¡Œä¸€äº›è°ƒæ•´ã€‚æ—¥æœŸæ ¼å¼ä¸º datetimeã€‚åŒæ ·ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨å•å…ƒæ ¼å…¬å¼çš„åŠ›é‡æ¥æ•´ç† IMDB é“¾æ¥ã€‚</p><pre class="kg kh ki kj gt og nl oh oi aw oj bi"><span id="2bee" class="mw ma iq nl b gy ok ol l om on">def _to_string(df: pd.DataFrame, *cols) -&gt; pd.DataFrame:<br/>    for col in cols:<br/>        if col in df.columns:<br/>            df[col] = df[col].astype(str)<br/>    return df<br/>â€‹<br/>def hyperlink_formula(df: pd.DataFrame, textcol: str, linkcol: str) -&gt; pd.DataFrame:<br/>    ix: int = df.columns.tolist().index(textcol)<br/>    vals: pd.Series = \<br/>        '=HYPERLINK("' + df["IMDB URL"] + '", "' + df["Movie"] + '")'<br/>    df.insert(ix, textcol+"_temp", vals)<br/>    df.drop([textcol, linkcol], axis=1, inplace=True)<br/>    df.rename(columns={textcol+"_temp": textcol}, inplace=True)<br/>    return df<br/>â€‹<br/>sh: gspread.Worksheet = _get_worksheet(FILE_KEY, SHEET_NAME)<br/>df = pd.read_pickle("./movienight1.pickle")<br/>â€‹<br/>df = _to_string(df, "Date", "Movie")<br/>df = hyperlink_formula(df, "Movie", "IMDB URL")<br/>â€‹<br/>write(sh, df)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/c6307a7566a9a07b5ad33a0d5b5580e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5eRANbS3PHl-73nBhYv_3A.png"/></div></div></figure><p id="704f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å¹²å‡€å¤šäº†ã€‚ç°åœ¨ï¼Œ<code class="fe ni nj nk nl b">Movie</code>æ æœ‰äº†æœ‰æ•ˆçš„è¶…é“¾æ¥ï¼</p><p id="3e3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">å½“æ–°çš„ç”µå½±ä¹‹å¤œè¢«æ’å…¥åˆ°æ•°æ®åº“ä¸­æ—¶ï¼Œè¿è¡Œ Python è„šæœ¬çš„è°ƒåº¦ç¨‹åºæ›´æ–°è¯¥è¡¨:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/9f4697e74aadf44348579841d8cfbf36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T1J6Es68YayLhY5ue6Q-OQ.png"/></div></div></figure><h2 id="a1c7" class="mw ma iq bd mb mx my dn mf mz na dp mj lf nb nc ml lj nd ne mn ln nf ng mp nh bi translated">ä»è°·æ­Œå·¥ä½œè¡¨ä¸­è¯»å–</h2><p id="3a41" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">ç”µå½±ã€Šå¤œç§˜ã€‹ç»Ÿè®¡äººå¤´ï¼Œè§£è¯»äººç¾¤ï¼Œå†™ä¸‹å¯¹äº‹ä»¶çš„è¯„è®ºã€‚äººç±»ä»ç„¶æ¯”æœºå™¨åšå¾—æ›´å¥½çš„äº‹æƒ…ã€‚</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/d000e0058a65f66e2c590766b6222dad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D1UshBncXGPWXcI6fFlNMQ.png"/></div></div></figure><p id="0a88" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ç°åœ¨è®© Python æ¥åƒå§ã€‚è¦æ’å…¥æ•°æ®åº“ï¼Œä¿å­˜åœ¨ S3 æ¡¶ï¼Œæ–‡ä»¶ç³»ç»Ÿæˆ–å…¶ä»–åœ°æ–¹ã€‚</p><p id="837a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä¸ºæ­¤ï¼Œæˆ‘ä»¬ä½¿ç”¨<code class="fe ni nj nk nl b">gspread_dataframe</code> : <code class="fe ni nj nk nl b">get_as_dataframe</code>æä¾›çš„å¦ä¸€ä¸ªå‡½æ•°ã€‚</p><p id="d6c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe ni nj nk nl b">set_as_dataframe</code>é€‰é¡¹(å†æ¬¡æ„Ÿè°¢ç½—å®¾Â·æ‰˜é©¬æ–¯ï¼Œ<code class="fe ni nj nk nl b">gspread-dataframe.py</code>):</p><pre class="kg kh ki kj gt og nl oh oi aw oj bi"><span id="0016" class="mw ma iq nl b gy ok ol l om on">:param worksheet: the worksheet.<br/>:param evaluate_formulas: if True, get the value of a cell after<br/>        formula evaluation; otherwise get the formula itself if present.<br/>        Defaults to False.<br/>:param nrows: if present and not None, limits the number of rows read from the worksheet.<br/>                Defaults to None. See pandas documentation for more info on this parameter.<br/>:param \*\*options: all the options for pandas.io.parsers.TextParser,<br/>        according to the version of pandas that is installed.<br/>        (Note: TextParser supports only the default 'python' parser engine,<br/>        not the C engine.)</span></pre><p id="a23d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä»£ç :</p><pre class="kg kh ki kj gt og nl oh oi aw oj bi"><span id="3a8f" class="mw ma iq nl b gy ok ol l om on">def read(sheet: gspread.Worksheet, **options) -&gt; pd.DataFrame:<br/>    return get_as_dataframe(sheet,<br/>                     evaluate_formulas=False,<br/>                     **options)<br/>â€‹<br/>df = read(sh)<br/>(df[df["Movie"].str.contains("Rambo")]<br/>    .values.tolist()<br/>)</span></pre><p id="3d6c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™å°†è¿”å›:</p><pre class="kg kh ki kj gt og nl oh oi aw oj bi"><span id="51c0" class="mw ma iq nl b gy ok ol l om on">[['2020-08-28',<br/>  '=HYPERLINK("https://m.imdb.com/title/tt1206885/?ref_=m_ttls_tt_119", "Rambo: Last Blood")',<br/>  6.2,<br/>  89,<br/>  1.0,<br/>  'ğŸ˜­ğŸ˜­ğŸ˜­ğŸ˜­',<br/>  'WHY AM I THE ONLY ONE HERE???']]</span></pre><h1 id="50c5" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">ç»“è®º</h1><p id="822a" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">ç”µå­è¡¨æ ¼æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ã€‚æœ‰äº†åƒ EZSheetsã€gspread å’Œ gspread_dataframe è¿™æ ·çš„ä»¤äººæƒŠå¹çš„ Google Sheets API åŒ…è£…å™¨ï¼Œç”¨ Python ç®¡ç†å®ƒä»¬çš„å¤§é‡å·¥ä½œå·²ç»å®Œæˆäº†ã€‚</p><p id="3967" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">ä½¿ç”¨ç”µå­è¡¨æ ¼ä½œä¸º Python å·¥å…·é“¾çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯å¦¨ç¢ä¸šåŠ¡è‡ªåŠ¨åŒ–â€¦è¿™ä¸ºæˆ‘ä»¬èŠ‚çœäº†å¤§é‡æ—¶é—´å’Œå·¥ä½œã€‚æœ€é‡è¦çš„æ˜¯ï¼Œå®ƒåœæ­¢äº†â€œä¼ é€’ç”µå­è¡¨æ ¼â€çš„ä»ªå¼ã€‚è¿™æ˜¯ä¸€ä»¶ç¾å¦™çš„äº‹æƒ…ï¼</p><p id="b1cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">è¿™æ˜¯æœ¬æ–‡ä¸­ä½¿ç”¨çš„<a class="ae kv" href="https://docs.google.com/spreadsheets/d/11zmk55OFpFL5HW_MhPfqfC-GjRQvHlI_M-jtHcBzyzA/edit?usp=sharing" rel="noopener ugc nofollow" target="_blank"> Google å·¥ä½œè¡¨</a>çš„é“¾æ¥ã€‚</p></div></div>    
</body>
</html>