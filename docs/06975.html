<html>
<head>
<title>Interactive Distribution Plots with Plotly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Plotly 的交互式分布图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/interactive-distribution-plots-with-plotly-ea58efc78885?source=collection_archive---------37-----------------------#2020-05-29">https://towardsdatascience.com/interactive-distribution-plots-with-plotly-ea58efc78885?source=collection_archive---------37-----------------------#2020-05-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cb83" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何创建信息分布图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8d14078d90bb5d5db7d3b9199c206ae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6hedv8zHmxHGglvH.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@kymellis?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">金莎·艾利斯</a>在<a class="ae ky" href="https://unsplash.com/s/photos/view?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="6d6a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Plotly Python (plotly.py)是一个基于 plotly javascript (plotly.js)构建的开源绘图库。<strong class="lb iu"> Plotly express </strong>是 plotly.py 的一个高级接口，它允许我们创建许多交互式和信息可视化。</p><p id="325c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本帖中，我们将使用 plotly express 创建不同类型的<strong class="lb iu">分布图</strong>。分布图是非常有用的工具，广泛用于统计分析以及数据科学项目的探索性数据分析。顾名思义，分布图显示值的分布，并概述更有可能观察到的值、值分布的程度、值更密集的范围等。</p><p id="a081" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将首先使用一个数据集，其中包括 Coursera 上课程的基本信息。数据集可在 Kaggle 上的<a class="ae ky" href="https://www.kaggle.com/siddharthm1698/coursera-course-dataset" rel="noopener ugc nofollow" target="_blank">这里</a>获得。让我们从将数据读入熊猫数据帧开始。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a5b2" class="ma mb it lw b gy mc md l me mf">import numpy as np<br/>import pandas as pd</span><span id="42c8" class="ma mb it lw b gy mg md l me mf">coursera = pd.read_csv("coursera_data.csv")<br/>print(coursera.shape)<br/>coursera.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/b1be715e71b13f476f9bc7f549c03ccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b92aJk9EWd_KNh79koqztQ.png"/></div></div></figure><p id="08f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们需要做一些数据清理和操作。“未命名:0”列只是一个 ID，因此我们可以删除它。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a737" class="ma mb it lw b gy mc md l me mf">coursera.drop('Unnamed: 0', axis=1, inplace=True)</span></pre><p id="e199" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“课程 _ 学生 _ 注册”列的数字格式不正确。比如 5.3k 应该是 5300 等等。有不同的方法来完成这项任务。我们要做的是分离最后的字符，并将其转换为数值(k 代表千，m 代表百万)。然后乘以这些值，得到实际的注册人数。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="72bb" class="ma mb it lw b gy mc md l me mf">coursera['unit'] = [x.strip()[-1] for x in coursera['course_students_enrolled']]</span><span id="435e" class="ma mb it lw b gy mg md l me mf">unit_values = {'k':1000, 'm':1000000}<br/>coursera.unit.replace(unit_values, inplace=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mi"><img src="../Images/06305a24a58b7161cdff304793770a3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*is-UnnMi_MYYbXRNO8Y0Dg.png"/></div></div></figure><p id="d91a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们还需要从 course_students_enrolled 列中删除字母“k”和“m ”,这可以通过分割字符串以排除最后一个字符来完成。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="b069" class="ma mb it lw b gy mc md l me mf">coursera['course_students_enrolled'] = coursera['course_students_enrolled'].str.slice(0, -1)</span></pre><p id="0480" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后我们可以将这两列相乘，创建一个“注册”列。为了能够多重化，两个列都必须具有数字数据类型。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="786d" class="ma mb it lw b gy mc md l me mf">coursera['course_students_enrolled'] = coursera['course_students_enrolled'].astype("float")</span><span id="4cac" class="ma mb it lw b gy mg md l me mf">coursera['enrollment'] = coursera['course_students_enrolled'] * coursera['unit']</span><span id="9f9c" class="ma mb it lw b gy mg md l me mf">coursera.drop(['course_students_enrolled','unit'], axis=1, inplace=True)</span><span id="d6cb" class="ma mb it lw b gy mg md l me mf">coursera.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mj"><img src="../Images/69448e0185bbad1f4b72a222df3dd9aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gEG3QFmr-llh1Sh1ycZJ9g.png"/></div></div></figure><p id="01d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们首先在注册栏上创建一个基本直方图。为了让图看起来更好，我删除了登记值超过 500k 的离群值。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="fd0b" class="ma mb it lw b gy mc md l me mf">df = coursera[coursera.enrollment &lt; 500000]</span><span id="565a" class="ma mb it lw b gy mg md l me mf">fig = px.histogram(df, x="enrollment")<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/49e1ec022aa30ec5c24c8d987cc58db8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qhp8e55Is9I4Ojc5sPvRdg.png"/></div></div></figure><p id="c4bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大多数课程的注册人数不到 10 万。我们还可以检查课程难度对注册是否有任何影响。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="ca4e" class="ma mb it lw b gy mc md l me mf">fig = px.histogram(df, x="enrollment", color="course_difficulty", <br/>                   facet_col="course_difficulty",<br/>                   title="Course Enrollment Numbers")<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/2a6fdc6771cbadc3750f5b149bb3d1c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*zUDhR2Ud0yFJ4H1_t3roow.gif"/></div></div></figure><p id="cbf6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">初级课程的报名人数最多，随着难度的增加，报名人数会减少。然而，在每个难度级别内，有一个相似的分布趋势。</p><p id="7b78" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以创建一个类似的图来可视化课程评级。这一次，我们还将 y 轴用于不同的目的。通过将 enrollment 列传递给 y 参数，我们可以看到注册的总人数以及课程评级的分布情况。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="1654" class="ma mb it lw b gy mc md l me mf">fig = px.histogram(df, x="course_rating", y="enrollment",<br/>                   color="course_difficulty", <br/>                   facet_col="course_difficulty",<br/>                   title="Course Ratings")<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/39825dacf3a5f8b756b34db3c904bdcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Vjk10p8dY5skk689g4hHCw.gif"/></div></div></figure></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><p id="a93b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以使用 plotly 的<strong class="lb iu">图形工厂</strong>在一个图形上有多个分布。Numpy 可用于创建具有不同分布类型的合成变量。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="0688" class="ma mb it lw b gy mc md l me mf">x1 = np.random.normal(3, size=500)<br/>x2 = np.random.normal(5, size=500)</span></pre><p id="c77e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们把这些变量放在图上:</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="cd50" class="ma mb it lw b gy mc md l me mf">variables = [x1, x2]</span><span id="5df6" class="ma mb it lw b gy mg md l me mf">labels = ['Normal', 'Random']</span><span id="918f" class="ma mb it lw b gy mg md l me mf">fig = ff.create_distplot(variables, labels, show_hist=False)<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/34fbd70c6e43968aef15fd084c2e72a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p0uBNdqhYEP6PiyxuDq7nQ.png"/></div></div></figure><p id="b8d6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们有两个均值不同的正态分布变量。底部的图被称为“<strong class="lb iu">地毯</strong>”图，这是表示分布的另一种方式。在人口更稠密的地区，垂直线更密集。我们可以通过将<strong class="lb iu"> show_rug </strong>参数设置为 false 来消除地毯图部分。</p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><p id="ff0b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一种表示分布的方式是<strong class="lb iu">箱线图</strong>。让我们回到 Coursera 数据集，使用箱线图来可视化注册人数。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="f7be" class="ma mb it lw b gy mc md l me mf">fig = px.box(df, y="enrollment", <br/>             color="course_difficulty", <br/>             title="Course Enrollment Numbers")<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/2a1c4e629b8dbbb0229b1195f23dfb71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*RjuQzc12Lok2gTqrB7vGmA.gif"/></div></div></figure><p id="7b1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Boxplot 给出了一个关于这些值如何分布的概念，同时也指出了异常值。当我们将鼠标悬停在箱线图上时，我们会看到箱线图的临界值，即最小值、第一个四分位数、中值、第三个四分位数、上围栏和最大值。如果没有异常值，那么上栏就是最大值。我们还能够看到异常值。</p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><p id="b041" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们已经用 plotly 介绍了基本分布图。当然，这只是这个神奇的图书馆的一小部分功能。我们可以使用 plotly 动态创建许多其他绘图类型。它的语法也很容易理解。在接下来的帖子中，我会尝试涵盖更复杂的情节。你也可以查看 plotly 文档，我认为它有很多不同的例子。就像任何其他主题一样，熟悉 plotly 的最好方法就是实践。因此，我建议创造大量的情节来提高你的技能。</p><p id="ed28" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>