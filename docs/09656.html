<html>
<head>
<title>Solve the MNIST Image Classification Problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解决 MNIST 图像分类问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/solve-the-mnist-image-classification-problem-9a2865bcf52a?source=collection_archive---------16-----------------------#2020-07-09">https://towardsdatascience.com/solve-the-mnist-image-classification-problem-9a2865bcf52a?source=collection_archive---------16-----------------------#2020-07-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="01f7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">“你好，世界！”深度学习和 Keras</h2></div><p id="8757" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">求解 MNIST 是机器学习模型的一个基准。这也是你进入深度学习领域时首先会遇到的问题之一。</p><p id="dc39" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本文中，我们将设计一个神经网络，它使用 Python 库 Keras 来学习对 MNIST 数据集的手写数字进行分类。</p><p id="cbc3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">解决 MNIST 问题的疯狂之处在于，它根本不消耗资源。你<em class="le">不需要 GPU </em>。我们在这里建立的模型可以在不到一分钟的时间内在任何现代 CPU 上快速训练。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/5304a1f75778e39594992403cdbe96dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qYjM4kLeyZotqLpkIn1RMA.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">手写数字的 MNIST 数据集</p></figure><h1 id="3545" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">关于 MNIST 数据集</h1><p id="00dd" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">MNIST 数据集是一组 60，000 幅训练图像加上 10，000 幅测试图像，由美国国家标准与技术研究所(NIST)在 20 世纪 80 年代汇编而成。这些图像被编码为 NumPy 数组，标签是一个数字数组，范围从 0 到 9。图像和标签是一一对应的。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="f0ea" class="lv lw it bd lx ly mz ma mb mc na me mf jz nb ka mh kc nc kd mj kf nd kg ml mm bi translated">设置 Keras 和相关性</h1><p id="3ae3" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">假设您已经安装了<a class="ae ne" href="https://anaconda.com" rel="noopener ugc nofollow" target="_blank"> Anaconda </a>，我们将简要讨论安装 Keras 和其他依赖项。</p><p id="c3c8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然 Anaconda 在默认情况下捆绑了很多好东西，但它没有预装 Keras。然而，Anaconda Cloud 的好人们在这里有一个定制的 Keras 包。</p><p id="3cd8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以使用命令行从<code class="fe nf ng nh ni b">conda-forge</code>通道安装它。</p><pre class="lg lh li lj gt nj ni nk nl aw nm bi"><span id="1920" class="nn lw it ni b gy no np l nq nr">$ conda install --channel conda-forge keras</span></pre></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="1c4f" class="lv lw it bd lx ly mz ma mb mc na me mf jz nb ka mh kc nc kd mj kf nd kg ml mm bi translated">深度学习教育学</h1><ol class=""><li id="5e5b" class="ns nt it kk b kl mn ko mo kr nu kv nv kz nw ld nx ny nz oa bi translated">绘制训练样本和相应目标的映射，即加载数据。</li><li id="fc7a" class="ns nt it kk b kl ob ko oc kr od kv oe kz of ld nx ny nz oa bi translated">创建网络架构。</li><li id="706d" class="ns nt it kk b kl ob ko oc kr od kv oe kz of ld nx ny nz oa bi translated">选择一个损失函数、一个优化器和度量标准，以便在测试和培训期间进行监控。</li><li id="94cc" class="ns nt it kk b kl ob ko oc kr od kv oe kz of ld nx ny nz oa bi translated">根据需要对数据进行预处理。</li><li id="a9fa" class="ns nt it kk b kl ob ko oc kr od kv oe kz of ld nx ny nz oa bi translated">对训练样本运行网络，即<em class="le">正向传递</em>以获得预测。</li><li id="30fc" class="ns nt it kk b kl ob ko oc kr od kv oe kz of ld nx ny nz oa bi translated">计算批次上的网络损耗。</li><li id="9932" class="ns nt it kk b kl ob ko oc kr od kv oe kz of ld nx ny nz oa bi translated">更新网络的所有权重，减少批次损失。</li></ol></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="4618" class="lv lw it bd lx ly mz ma mb mc na me mf jz nb ka mh kc nc kd mj kf nd kg ml mm bi translated">解决 MNIST 图像分类问题</h1><p id="19a8" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">MNIST 图像分类问题是一个多类分类问题。让我们实施上面讨论过的教学方法。</p><p id="8df1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">采用的<em class="le">工作流程</em>简单。我们将把<em class="le">训练数据</em>输入神经网络。然后，网络将学习关联图像和标签。最后，网络将对<em class="le">测试数据</em>和达到的准确度进行预测。</p><h2 id="4f7e" class="nn lw it bd lx og oh dn mb oi oj dp mf kr ok ol mh kv om on mj kz oo op ml oq bi translated">步骤 1:加载数据</h2><p id="a12a" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">MNIST 数据集以一组四个 NumPy 数组的形式预装在 Keras 中。我们将使用<code class="fe nf ng nh ni b">load_data()</code>函数加载数据集。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="or os l"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">加载用于训练和测试的数据</p></figure><h2 id="0e30" class="nn lw it bd lx og oh dn mb oi oj dp mf kr ok ol mh kv om on mj kz oo op ml oq bi translated">步骤 2:网络架构</h2><p id="6d57" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">我们将使用<em class="le">密集连接的</em>(也称为<em class="le">完全连接的</em> ) <em class="le">顺序神经层*来构建网络。</em>层是神经网络的核心构建块。它们是基本的张量运算，实现了渐进式的“数据提炼”</p><p id="883e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">(前面混乱的句子，仔细阅读**) </em></p><p id="1292" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">层将它之前的层的输出作为输入。</p><ul class=""><li id="b725" class="ns nt it kk b kl km ko kp kr ot kv ou kz ov ld ow ny nz oa bi translated">* *因此，层的输入的“<em class="le">形状必须与前一层的输出的“<em class="le">形状相匹配。”</em></em></li><li id="17c4" class="ns nt it kk b kl ob ko oc kr od kv oe kz of ld ow ny nz oa bi translated">* <em class="le">连续层</em>根据前一层的输出动态调整输入到该层的形状，从而减少程序员的工作量。</li></ul><p id="1d22" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了创建我们的网络，</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="or os l"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">包括两个密集连接的顺序神经层的网络体系结构</p></figure><p id="f4cc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的网络由两个完全连接的层组成。第二层(也是最后一层)是一个<em class="le"> 10 路 softmax </em>层，它返回 10 个概率得分的数组。每个分数是当前数字图像属于我们的 10 个数字类之一的概率。</p><h2 id="37a4" class="nn lw it bd lx og oh dn mb oi oj dp mf kr ok ol mh kv om on mj kz oo op ml oq bi translated">第三步:编译</h2><p id="6699" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">现在让我们选择一个<em class="le">优化器，一个用于评估模型性能的损失函数&amp;指标。</em></p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="or os l"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">选择三连胜。这个步骤对网络的准确性有最大的影响</p></figure><h2 id="2797" class="nn lw it bd lx og oh dn mb oi oj dp mf kr ok ol mh kv om on mj kz oo op ml oq bi translated">步骤 4:预处理图像数据</h2><p id="6fbb" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">我们将通过<em class="le">将</em>整形为网络期望的形状，并通过<em class="le">缩放</em>使所有值都在[0，1]区间内，来预处理图像数据。</p><p id="ead7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以前，我们的训练图像存储在类型为<code class="fe nf ng nh ni b">uint8</code>的 shape (60000，28，28)数组中，其值在[0，255]范围内。我们将把它转换成一个形状为(60000，28 * 28)的<code class="fe nf ng nh ni b">float32</code>数组，其值在 0 和 1 之间。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="or os l"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">预处理输入数据</p></figure><p id="5145" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后我们将使用<code class="fe nf ng nh ni b">keras.utils</code>中的<code class="fe nf ng nh ni b">to_categorical</code>函数对标签进行分类编码</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="or os l"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">编码目标</p></figure><p id="5320" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，我们准备训练我们的网络。</p><h2 id="f396" class="nn lw it bd lx og oh dn mb oi oj dp mf kr ok ol mh kv om on mj kz oo op ml oq bi translated">第五步:开始训练</h2><p id="8e7e" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">Keras 通过调用网络的<code class="fe nf ng nh ni b">fit()</code>方法来训练网络。我们<em class="le">使</em>模型符合它的训练数据。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="or os l"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">训练神经网络</p></figure><p id="af7c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">随着网络的训练，你会看到它的准确性增加，损失减少。您在这里看到的时间是与 i7 CPU 相对应的训练时间。</p><pre class="lg lh li lj gt nj ni nk nl aw nm bi"><span id="2178" class="nn lw it ni b gy no np l nq nr">Epoch 1/5<br/>469/469 [==============================] - 5s 10ms/step - <br/>loss: 0.2596 - accuracy: 0.9255<br/>Epoch 2/5<br/>469/469 [==============================] - 5s 10ms/step - <br/>loss: 0.1047 - accuracy: 0.9693<br/>Epoch 3/5<br/>469/469 [==============================] - 5s 11ms/step - <br/>loss: 0.0684 - accuracy: 0.9791<br/>Epoch 4/5<br/>469/469 [==============================] - 5s 10ms/step - <br/>loss: 0.0496 - accuracy: 0.9851<br/>Epoch 5/5<br/>469/469 [==============================] - 5s 11ms/step - <br/>loss: 0.0379 - accuracy: 0.9887</span></pre><p id="94c7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们已经获得了<code class="fe nf ng nh ni b">98.87%</code>的训练精度。这个度量告诉我们，我们的网络正确地分类了测试数据中 98.87%的图像。</p><h2 id="45ce" class="nn lw it bd lx og oh dn mb oi oj dp mf kr ok ol mh kv om on mj kz oo op ml oq bi translated">步骤 6:评估网络性能</h2><p id="1b02" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">MNIST 数据集保留了 10，000 张图像，我们将通过在这个以前从未见过的数据集上测试来评估我们网络的性能。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="or os l"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">评估模型性能</p></figure><pre class="lg lh li lj gt nj ni nk nl aw nm bi"><span id="5c24" class="nn lw it ni b gy no np l nq nr">313/313 [==============================] - 1s 3ms/step - loss: 0.0774 - accuracy: 0.9775<br/>Test Loss: 0.07742435485124588<br/>Test Accuracy : 97.75000214576721 %</span></pre><p id="dec9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们获得了测试精度<code class="fe nf ng nh ni b">97.75%</code>,由于过度拟合，与训练精度相比，这是可以理解的。</p><h1 id="4be6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">可视化网络</h1><p id="1d91" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">为了可视化我们的神经网络，我们需要几个额外的依赖项。您可以使用安装它们</p><pre class="lg lh li lj gt nj ni nk nl aw nm bi"><span id="be8e" class="nn lw it ni b gy no np l nq nr">$ $HOME/anaconda/bin/pip install graphviz</span><span id="5700" class="nn lw it ni b gy ox np l nq nr">$ pip3 install ann-visualizer</span></pre><p id="c881" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用<code class="fe nf ng nh ni b">ann-visualizer</code>将我们的神经网络可视化为一个图形。这一步是可选的；您可以选择不可视化您的网络。然而，看图表无疑更有趣。</p><p id="50b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nf ng nh ni b">graphviz</code>是对<code class="fe nf ng nh ni b">ann-visualizer</code>的依赖</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="or os l"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">使用 ann-visualizer 可视化网络。</p></figure><p id="4ce9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是你的神经网络。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi oy"><img src="../Images/a834a94df37574b07cd094f7ad9ddace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bBvwxpgTfp_zCEWB1RZJNw.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">MNIST 神经网络。输入层由 786(28×28)个节点组成。所有节点都连接到第一层上的每个其他节点，即全连接或密集连接的网络。</p></figure><p id="39e4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">关于可视化神经网络的更多信息，请查看您刚刚使用的<code class="fe nf ng nh ni b">ann-visualizer</code>的 GitHub 库。</p><div class="oz pa gp gr pb pc"><a href="https://github.com/Prodicode/ann-visualizer" rel="noopener  ugc nofollow" target="_blank"><div class="pd ab fo"><div class="pe ab pf cl cj pg"><h2 class="bd iu gy z fp ph fr fs pi fu fw is bi translated">Prodicode/ann-visualizer</h2><div class="pj l"><h3 class="bd b gy z fp ph fr fs pi fu fw dk translated">一个很棒的可视化 python 库曾经与 Keras 一起工作。它使用 python 的 graphviz 库来创建一个可展示的…</h3></div><div class="pk l"><p class="bd b dl z fp ph fr fs pi fu fw dk translated">github.com</p></div></div><div class="pl l"><div class="pm l pn po pp pl pq lp pc"/></div></div></a></div></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><h1 id="ef9f" class="lv lw it bd lx ly mz ma mb mc na me mf jz nb ka mh kc nc kd mj kf nd kg ml mm bi translated">结论</h1><p id="7f7d" class="pw-post-body-paragraph ki kj it kk b kl mn ju kn ko mo jx kq kr mp kt ku kv mq kx ky kz mr lb lc ld im bi translated">恭喜你！你已经成功跨过了深度学习的门槛。如果这是你第一次涉足神经网络，我希望你喜欢它。</p><p id="02d2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我建议你配合这篇文章。你可以在十分钟之内解决 MNIST 图像分类问题。确保对我们之前讨论的<strong class="kk iu">教学法</strong>给予足够的重视。这是全面解决和实现神经网络的基础。</p><p id="c4d8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我假设读者对诸如优化器、分类编码、损失函数和度量标准之类的技术细节已经有了很好的理解。你可以在这里找到我关于这些概念的练习笔记。</p><p id="97db" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更多内容，请查看 Francois Chollet 的《用 Python 进行深度学习<a class="ae ne" href="https://www.manning.com/books/deep-learning-with-python" rel="noopener ugc nofollow" target="_blank">》一书。</a></p><p id="5607" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请随意查看本文的<a class="ae ne" href="https://github.com/rakshitraj/fchollet" rel="noopener ugc nofollow" target="_blank">实现</a>以及我在<a class="ae ne" href="https://github.com/rakshitraj/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上的更多工作。</p><p id="969b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读！</p></div></div>    
</body>
</html>