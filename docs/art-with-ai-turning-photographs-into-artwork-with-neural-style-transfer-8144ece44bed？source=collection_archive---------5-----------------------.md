# 人工智能艺术:用神经风格转换将照片变成艺术品

> 原文：<https://towardsdatascience.com/art-with-ai-turning-photographs-into-artwork-with-neural-style-transfer-8144ece44bed?source=collection_archive---------5----------------------->

## 你曾希望自己能像毕加索或梵高一样画画吗？

![](img/ea7760bf7347086ef7876236ff892af1.png)

1.  **简介:机器之间的界限&艺术家变得模糊**

*   虽然人工智能已被证明在复杂的计算和预测方面更胜一筹，但创造力似乎是机器无法接管的领域。
*   随着人工智能开始产生令人惊叹的视觉效果、深刻的诗歌和超凡的音乐，艺术的本质和人类创造力在未来的作用开始变得不确定。
*   令人惊讶的是，人工智能现在能够创作出具有美感的艺术作品。

***请注意:*** *我保留本博客使用的所有媒体的权利——照片、动画、视频等。它们是我的作品(除了上面提到的 7 件作为风格图片的艺术家作品)。gif 文件可能需要一段时间加载，请耐心等待。在中型应用程序中，它不为我加载。如果是这种情况，请在浏览器中打开。*

这是一些我用来从照片中生成数字艺术品的图像处理技术

**2。颜色量化**

*   减少图像中使用的不同颜色的数量，目的是使新图像在视觉上相似，大小压缩。
*   常见情况:将 24 位彩色图像转换为 8 位彩色图像。
*   使用 K 均值聚类对相似颜色的像素进行分组。
*   聚类的 K 个质心代表 3-D RGB 颜色空间&将替换聚类中所有点的颜色，得到具有 K 种颜色的图像。

![](img/bb150d2b75efb895b91c4dca60ef865a.png)![](img/5164380786198e6827491a394f0bf305.png)

**3。超像素分割**

*   将图像划分为超像素。超像素是一组具有相似颜色或灰度级的相连像素。
*   使用一种称为简单线性迭代聚类(SLIC)的无监督分割技术。使用 K-均值聚类分割图像。
*   它接受图像的所有像素值，并试图将它们分成预定义数量的子区域。
*   然后，每个超像素中的所有像素取该段中所有像素的平均颜色值。

![](img/219362a5575237004608ae6b3a018265.png)![](img/6af661e36c7365641e56d8df1622b57f.png)

**4。神经类型转移**

*   一种优化技术，将一幅图像的内容与另一幅图像的风格结合起来，有效地传递风格。
*   **图像内容:**物体结构，其具体布局&定位。
*   **意象风格:**色彩、肌理、笔触图案、画风技法。
*   能够产生手工难以产生的迷人结果。
*   如下所示，输出匹配内容图像的内容统计&样式图像的样式统计。这些统计数据是使用卷积神经网络从图像中提取的。
*   简而言之，生成的图像是相同的内容图像，但好像是梵高以其艺术作品“星夜”的风格绘制的。

![](img/da13c2443c8848c9ea0175919657eb7f.png)

**4.1 项目概述**

*   我已经在这个项目上工作了一个多月。我用模型超参数&一对内容图像和样式图像做了很多实验。
*   迄今为止，使用 63 幅内容图片和 40 幅风格图片(8 幅作品和 32 张照片)生成了 2500 多幅数字作品。
*   每个图像(800 像素宽)需要 7 分钟来生成(2000 次迭代)。我能够使用 6GB 的 GPU 生成高达 1200 像素宽的图像。
*   我还应用了基本的图像增强技术&色彩校正来制作视觉上有美感的艺术品。

**4.2 风格转移:VGG-19 CNN 架构**

*   风格转移是一项复杂的技术，需要一个强大的模型。
*   大到足以完成这项任务的模型可能需要很长时间来训练&为此需要非常大的数据集。
*   出于这个原因，我们导入一个已经在非常大的 ImageNet 数据库上训练过的预训练模型。
*   根据[的 NST 原始论文](https://arxiv.org/abs/1508.06576)，我们将使用 VGG-19 网络。
*   预先训练的 VGG-19 模型已经学会识别各种特征。
*   图 1 示出了输入图像(1200x800)的不同层的尺寸。

![](img/12dd914f7e5bed2fe03ab41bdd53d0b3.png)

*   **特征部分-** 处理从图像中提取相关特征。
*   **分类器部分-** 处理图像分类(此处不需要)。
*   在我们的项目中，我们将只依赖模型的预训练特征部分，而不是从零开始构建我们自己的 CNN。
*   输入图层采用 3 通道彩色 RGB 图像，然后通过总共 16 个图层，因为 VGG-19 中剩余的 3 个图层是完全连接的分类图层。还有总共 5 个最大池层。
*   我们已经冻结了相关参数，这样它们在反向传播过程中不会更新。

**4.3 成本函数**

*   与深度学习中的常规神经网络算法不同，我们不是优化成本函数来获得一组参数值。
*   相反，我们优化一个成本函数来获得目标图像的像素值。
*   **内容损失:**内容图像&生成图像产生的某些卷积输出的均方误差。
*   **风格损失:**风格图像产生的 gram 矩阵的均方误差&生成的图像。
*   **总损失:**内容损失的加权相加&风格损失。

**4.4 优化图像内容:**

将目标图像的内容特征与内容图像的特征进行匹配。

**4.4.1 特征图—过滤可视化**

*   这里我展示了 Conv1_1 层的 64 个特征图中的 2 个。
*   图层中的每个特征地图检测图像的一些特征。
*   下面的特征图试图识别图像中的垂直边缘(更确切地说是左侧比右侧亮的边缘)。

![](img/5d072e6e75ef456ce4ab90eae3ad4846.png)

*   下面的特征图识别水平边缘(更具体地，顶部区域比底部区域亮的边缘)。

![](img/7748c2c0c2e2f14552a6037319ec004f.png)

**4.4.2 浅层与深层**

*   较浅的层检测边缘和简单纹理等低级特征。
*   更深的层检测高级特征，如复杂的纹理和形状。
*   随着我们越深入，特征地图的维度就越小。
*   以下 gif 显示了上述图层中的一些特征地图。

![](img/10b78f01e8b6637aefa99d8e3cda0e07.png)

1200x800

![](img/e2fbe514d17137bcb7a6b730735021f8.png)

600x400

![](img/3c9d4cfe9ea1efcdba56cc8013566f54.png)

300x200

**4.4.3 选择用于内容提取的层**

*   CNN 的每一层都会忘记原始图像的具体细节&更多地关注特征(边缘、形状、纹理)。
*   取内容最重要的特征。我们没有填充的任何细节都可以用样式填充。这使得空间可以平衡内容和风格。
*   在神经网络的初期，我们总会得到更清晰的图像。
*   如果你在网络中间选择一个图层，我们将会得到视觉上最愉悦的结果——既不太浅也不太深。
*   这里选择 Conv4_2 层来捕捉最重要的特性。

**4.4.4 含量损失**

*   **目标:**生成与输入图像内容相似的图像。
*   内容丢失采用 CNN 的隐藏层激活(此处为 Conv4_2)，并测量内容和生成图像的不同激活。
*   最大限度地减少内容损失确保两幅图像有相似的内容。
*   取内容图像(AC)和生成图像(AG)激活之间的平方差，然后平均所有这些平方差。
*   content _ loss = mean(σᵢ(ag-AC))∀I = 1 到 512

![](img/145515e4445d20fced034540d3dd4254.png)

**4.5 优化图像风格:**

*   内容特征按原样使用，因为 CNN 在提取输入图像的内容元素方面做得很好。
*   尽管 syle 特征需要一个额外的预处理步骤，但是使用 gram 矩阵进行更有效的风格特征提取。
*   通过将 gram 矩阵应用于所提取的特征，内容信息被消除，然而风格信息被保留。

**4.5.1 样式权重**

*   我们选择了 5 层从中提取特征。靠近开头的层通常在重新创建风格特征方面更有效，而后面的层为风格元素提供了额外的变化。
*   我们可以通过将某些权重参数与每个层相关联来选择将某些层优先于其他层。
*   我们将加重早期层的重量。

**4.5.2 克矩阵—克(克)**

*   G(gram)度量同一层中特征图之间的相关性。
*   特征映射只是卷积层的激活后输出。
*   Conv2_1 有 128 个滤波器，它将输出 128 个特征图。
*   **直觉:**假设我们有两个滤镜，一个检测蓝色物体&一个检测螺旋。将这些过滤器应用于输入图像将产生 2 个特征图&我们测量它们的相关性。
*   如果特征图高度相关，那么图像中出现的任何螺旋几乎肯定是蓝色的。
*   最小化样式和生成的图像的 gram 矩阵之间的差异导致在生成的图像中具有相似的纹理。

![](img/efcb547145f134f1d99053fc1f7ef985.png)

*   然后，所有的激活图被展开成像素值的 2D 矩阵。
*   展开版本中的每一行代表一个滤波器(或通道)的激活。

![](img/0f33f75568dc9810f3ddbbe8f730ec5a.png)

*   g(克)是通过将展开的滤波器矩阵与其转置相乘来计算的，这产生了维度通道 x 通道的矩阵。
*   g(克)与图像分辨率无关，即对于 Conv2_1 层，生成的图像和样式图像的克矩阵尺寸为 128x128。
*   因此，生成图像的分辨率(=内容图像的分辨率)和样式图像可能不同。
*   对角线元素测量滤波器 ii 有多活跃，例如，假设滤波器 ii 正在检测垂直纹理，那么 G(gram)ᵢᵢ测量垂直纹理在整个图像中有多常见。如果 G(gram)ᵢᵢ很大，这意味着图像有很多垂直纹理。
*   通过捕捉不同类型的特征 G(gram)ᵢᵢ的流行，以及有多少不同的特征一起出现 G(gram)ᵢⱼ，gram 矩阵 G(gram)测量图像的风格。

**4.5.3 风格损失**

*   **目标:**最小化样式图像的克矩阵之间的距离&生成图像的克矩阵。
*   将生成的图像和风格图像通过同一个预先训练的 VGG CNN。
*   取 CNN 的一些卷积的输出，计算它们的 gram 矩阵&然后计算每个选择层的均方误差。
*   在每次迭代中，我们创建一个输出图像，使得输出的 gram 矩阵和样式图像的 gram 矩阵之间的差异最小化。

![](img/abadad3f36eede7c3ea8befb9611f13a.png)

**4.6 优化内容&样式一起:**

*   总损失是内容损失和总风格损失的线性组合。
*   总损失=α*内容损失+β*总损失
*   α和β超参数控制内容和风格之间的相对权重。
*   通过 VGG19 模型运行内容映像并计算内容成本。
*   通过 VGG19 模型运行样式图像并计算样式成本。
*   使用 adam 优化器，学习率= 0.003
*   通过将模型和张量转移到 CUDA 来利用 GPU。

**4.7 总结**

*   我们有内容图像、风格图像&生成的(或目标)图像。
*   虽然样式转印纸从目标图像是随机的白噪声图像开始，但是我从目标图像是内容图像的克隆开始。
*   优化过程然后将尝试&保持目标图像的内容，同时在每次迭代中应用更多来自样式图像的样式。
*   我们将针对生成的图像优化总损耗。
*   **内容丢失:**我们将内容&生成的图像通过预先训练好的 CNN，如 VGG-19。我们取这两个输出之间的均方误差。
*   **风格丢失:**我们通过同一个 CNN 传递风格&生成的图像。我们抓取 5 个不同层的输出&计算克矩阵。
*   然后，我们取每一层的样式图像和生成图像的 gram 矩阵之间的均方误差。
*   取这些均方差的加权和。这让我们完全失去了风格。
*   总损失是内容损失和总风格损失的加权和。
*   利用反向传播，计算所有需要的梯度，以最小化相对于我们的目标图像参数的损失。
*   这就是优化器如何学习调整哪些像素&如何调整它们以最小化总损失。
*   用最小化总损失的反向传播更新生成的图像。
*   每次迭代更新权重&重复这个过程。

**4.8.1 利用著名艺术品作为风格图像:**

*   以从梵高到毕加索的任何艺术家的风格重画这幅画。
*   这里是我为这个博客选择的一些艺术作品。

![](img/951e295456eb205c8253da30afbd1132.png)

**文森特梵高:星夜**

*   世界上最受认可和最宏伟的艺术品之一。
*   我在这里添加了一个运动效果，整个效果是空灵的&像做梦一样。
*   蓝色主导了这幅画，将群山融入天空。星星的黄色白色月亮在天空的映衬下显得格外突出。
*   **天空:**一笔一笔打着旋儿，卷着星星周围的云&月亮。
*   **山丘&树木:**弯曲&搭配天空柔和的漩涡。滚进下面的小村庄。
*   **村庄:**直线&锐角把它和画的其他部分分开。

> **我梦想画画，然后我画出我的梦想——文森特·梵高**

![](img/7ed018f3ca67c3dcefd941934b2ecdfd.png)

> 今天的世界没有意义，我为什么要画有意义的画呢？—巴勃罗·毕加索

以下是结果，一些组合产生了令人震惊的艺术品。

![](img/494c142c706ed9d390ed8bdf81291c2a.png)![](img/692a89fdf5b1776c11cf41b4923f8fd8.png)![](img/761686de5b5df3c2398632f44e7435e4.png)![](img/f0d9336d75ca5020edbf8b3d6c6f624e.png)![](img/45e0b9ef08bc5ca2933d4b0a49b335e2.png)![](img/9941dc29818ca0a51004d9f50b7a51d7.png)![](img/cb20b8f3df71a42f3257e7bf30f0b35a.png)![](img/6b20f8032f476f59fe8a14b4ff161c80.png)

**4.8.2 使用照片作为风格图像:**

这是一个新娘和涂鸦的图像，将它们结合起来会产生一个类似涂鸦的输出。

![](img/01da0bfc9764f3f551cbd0f6b20e0e1a.png)

在这里，你可以看到建筑在背景中被弹出。

![](img/5463429d8b5178e1df5e3e092b3481f8.png)

这种效果有点像这里的玻璃蚀刻技术。

![](img/04741da9be8dd4dcbb28e6ff977dce67.png)

旧木门的纹理创造了一幅古画的独特外观。

![](img/a4530151dd771978c4caa28b593ff030.png)

印度人居中心的天花板图案被转移到这里，创造出类似马赛克的效果。

![](img/23beb39ee353935fc40af78a8685c5b8.png)

spirograph 生成的设计应用于此处的内容图像。

![](img/df60e9b3796ca4988474c2cf1dac16f8.png)

冰块的纹理在这里非常好用。

![](img/d8a58d7a2f5c00cc01c4524a11f86645.png)

好像涂鸦是画在砖墙上的。

![](img/ae578d222c969c8235aea743531d9196.png)

马赛克天花板的样式用于生成输出。

![](img/4fff8f2ba553034c9975f02dd7210394.png)

**4.9 迭代式可视化:**

*   形象的风格和内容如何结合起来优化目标图像。
*   随着更多的迭代，图像在整个过程中逐渐变得更有风格&可视化是非常迷人的。

![](img/42c23c675d0b1950347825fa60a00ba7.png)

**4.10 将一系列照片风格化以创建动画:**

*   我能想到的一个应用是在动画行业，在现实世界中拍摄&根据所需的风格图像进行风格化。
*   在这里，我用 DSLR 的连续连拍模式捕捉图像。

![](img/4d2f40c672f4f805b970e99e08933877.png)

**4.11 使用风格转移将视频风格化**

*   程式化的定时录像，我以 30 帧/秒的速度拍摄，持续时间为 30 秒。
*   然后，900 帧中的每一帧都与不同风格的图像一起通过风格转换算法，以创建独特的效果。
*   对于每一种风格，所有的帧在 720p 分辨率下渲染需要大约 18 个小时。

**4.12 结果随内容权重的变化(α** ) **&样式权重(β):**

*   α与β的比率越低，风格转移得越多。
*   当α=1 & β=100 时，我得到了令人印象深刻的结果，这个博客中的所有结果都是针对这个比例的。
*   对于 2000 次迭代，下面是比率如何影响生成的图像-

![](img/a4396f71e936e3d5648fa62661c0bf71.png)

*   这种变化在树木的笔触中更加明显。

**4.13 两种风格图像的风格转换:**

*   我已经扩展了算法来结合两种风格的图像。
*   下面显示的是用两种风格的图像生成的两个图像。

![](img/119fab2249023343004c2744d6f8949b.png)

*   我喜欢第一张生成图像的纹理。然而，我希望它像第二个生成的图像一样更加丰富多彩。
*   因此，我没有使用单一风格的图片，而是使用了两种风格图片的组合&结果令人印象深刻。
*   修改后的总损失= 1 *内容损失+100 *样式 1 损失+45 *样式 2 损失

![](img/b340323eef459c075b2f289aac84aeb1.png)

**4.14 结论**

完成一幅画需要几个小时或几天甚至更长时间&然而在深度学习的帮助下，我们可以使用照片在几分钟内生成一幅受某种风格启发的新的数字绘画。这让我们想知道未来的艺术家是计算机还是人类。

以一个值得商榷的问题结束博客:如果用人工智能来创造图像，最终的产品真的可以被认为是艺术吗？评论一下你对此的看法。

感谢您的阅读！

我希望你喜欢这个博客。如果你想了解我的文章，请跟我来。🙂

我的下一篇博客将是关于 Deep Dream，这是一种人工智能算法，它在有意过度处理的图像中产生梦一样的幻觉外观。

***阅读我的其他博客:***

[](/creating-typography-using-word-cloud-in-python-9652bd62fa69) [## 在 python 中使用单词云创建排版

### 一张图胜过千言万语。字面意思！这张图有 2200+字。😱

towardsdatascience.com](/creating-typography-using-word-cloud-in-python-9652bd62fa69) [](/country-wise-visual-analysis-of-music-taste-using-spotify-api-seaborn-in-python-77f5b749b421) [## 使用 Spotify API 和 Python 中的 Seaborn 对音乐品味进行国别可视化分析

### 你知道哪个国家喜欢欢快的音乐，哪个国家喜欢喧闹的音乐吗？

towardsdatascience.com](/country-wise-visual-analysis-of-music-taste-using-spotify-api-seaborn-in-python-77f5b749b421) 

本博客中使用的绘画作品归功于它们各自的艺术家。提及他们的官方网站:

[](https://www.vangoghgallery.com/) [## 梵高画廊-他的生活和作品

### 在这里，你会看到。梵高的画，水彩画，平面作品，字母素描，以及梵高的…

www.vangoghgallery.com](https://www.vangoghgallery.com/) [](https://afremov.com/) [## 李奥尼德·阿夫列莫夫在线画廊

### 李奥尼德·阿夫列莫夫是当代最杰出的艺术家之一，以其不同寻常的绘画方式和独特的艺术风格而闻名

afremov.com](https://afremov.com/) [](https://www.wassilykandinsky.net/) [## 瓦西里·康丁斯基- 610 艺术品，传记，书籍，引文，文章

### 9 月 05 日布拉德福德·麦考密克写道:“评论说:”我 8 岁的儿子画这样的艺术作品，当他真的…

www.wassilykandinsky.net](https://www.wassilykandinsky.net/) [](https://www.edvardmunch.org/) [## 爱德华蒙克-绘画，传记，爱德华蒙克的报价

### 爱德华·蒙克最著名的身份是出生于挪威的表现主义画家和印刷商。在 20 世纪后期，他…

www.edvardmunch.org](https://www.edvardmunch.org/) [](https://www.pablopicasso.org/) [## 巴勃罗·毕加索:毕加索 150 幅名画、传记及语录

### 就艺术和艺术运动而言，巴勃罗·毕加索可能是 20 世纪最重要的人物

www.pablopicasso.org](https://www.pablopicasso.org/) [](https://afremov.com/) [## 李奥尼德·阿夫列莫夫在线画廊

### 李奥尼德·阿夫列莫夫是当代最杰出的艺术家之一，以其不同寻常的绘画方式和独特的艺术风格而闻名

afremov.com](https://afremov.com/) [](https://www.katsushikahokusai.org/) [## 葛饰北斋

### 点击这里探索关于葛饰北斋传记的完整信息，并从他杰出的…

www.katsushikahokusai.org](https://www.katsushikahokusai.org/) [](https://www.tate.org.uk/art/artists/joseph-mallord-william-turner-558) [## 约瑟夫·马洛德·威廉·透纳 1775-1851 |泰特

### 约瑟夫·马洛德·威廉·透纳(1775 年 4 月 23 日-1851 年 12 月 19 日)，现在被称为威廉·特纳，是一个…

www.tate.org.uk](https://www.tate.org.uk/art/artists/joseph-mallord-william-turner-558) 

***参考文献:***

 [## 艺术风格的神经算法

### 在美术中，尤其是绘画，人类已经掌握了通过构图创造独特视觉体验的技巧…

arxiv.org](https://arxiv.org/abs/1508.06576) [](/convolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c) [## 卷积神经网络:特征映射和滤波器可视化

### 了解卷积神经网络如何理解图像。

towardsdatascience.com](/convolutional-neural-network-feature-map-and-filter-visualization-f75012a5a49c) [](https://harishnarayanan.org/writing/artistic-style-transfer/) [## 用于艺术风格转换的卷积神经网络

### 现在有一个很棒的应用程序叫做 Prisma，它可以把你的照片转换成艺术作品，使用…

harishnarayanan.org](https://harishnarayanan.org/writing/artistic-style-transfer/) [](/neural-style-transfer-using-vgg-model-ff0f9757aafc) [## 基于 VGG 模型的神经风格迁移

### 一种采用不同图像风格的数字图像变换技术

towardsdatascience.com](/neural-style-transfer-using-vgg-model-ff0f9757aafc) [](https://d2l.ai/chapter_computer-vision/neural-style.html) [## 13.12.神经类型转移-深入研究深度学习 0.14.3 文档

### 如果你使用社交分享应用程序，或者碰巧是一名业余摄影师，你对滤镜很熟悉。过滤器可以…

d2l.ai](https://d2l.ai/chapter_computer-vision/neural-style.html) [](https://www.widewalls.ch/magazine/ai-art-artificial-intelligence-artists) [## AI 对于艺术和艺术家意味着什么？宽墙

### 到目前为止，人工智能系统已经成功地完成了许多以前由人类完成的任务，每一个新的…

www.widewalls.ch](https://www.widewalls.ch/magazine/ai-art-artificial-intelligence-artists) [](https://www.americanscientist.org/article/ai-is-blurring-the-definition-of-artist#:~:text=To%20create%20AI%20art%2C%20artists,the%20aesthetics%20it%20has%20learned.) [## 人工智能模糊了艺术家的定义

### 随着人工智能(AI)融入我们日常生活的更多方面，从写作到驾驶…

www.americanscientist.org](https://www.americanscientist.org/article/ai-is-blurring-the-definition-of-artist#:~:text=To%20create%20AI%20art%2C%20artists,the%20aesthetics%20it%20has%20learned.)