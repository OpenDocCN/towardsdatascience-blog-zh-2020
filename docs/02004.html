<html>
<head>
<title>Create a YouTube Video from Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从代码创建一个 YouTube 视频</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-a-youtube-video-from-code-c9b433485d72?source=collection_archive---------24-----------------------#2020-02-25">https://towardsdatascience.com/create-a-youtube-video-from-code-c9b433485d72?source=collection_archive---------24-----------------------#2020-02-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d973" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用 C++演示创建分形缩放</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/640d139412f4ad9feda8d99ceb716ea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rqHDZ1JTV4Wq7dkehMNXyg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由沃尔夫冈·拜尔用超分形 3 程序创建。(<a class="ae ky" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en" rel="noopener ugc nofollow" target="_blank"> CC BY-SA 3.0 </a></p></figure><p id="82ff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你是一名计算机程序员，曾经想过创建一个包含计算机生成动画的视频，那么这篇文章就是为你准备的。在这里，我假设您已经有代码，或者可以编写代码，将某种图像创建为二维像素数组。它是什么样的图像并不重要，只要它适合内存中的数组。</p><p id="1cc9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你能做到这一点，这篇文章将带你走完剩下的路。您将了解如何创建 MP4 视频文件的详细步骤。当我们完成后，你将有一个适合上传到 YouTube 的视频文件，就像这样:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Mandelbrot 设置缩放视频由作者生成。</p></figure><h2 id="370e" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">计划概述</h2><p id="c3c8" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">以下是创建计算机生成视频的步骤概要。</p><ul class=""><li id="87de" class="mv mw it lb b lc ld lf lg li mx lm my lq mz lu na nb nc nd bi translated">将生成图像的 C++代码写入内存数组。我将使用一个简单的 Mandelbrot 集合图像生成器，但同样，这可以是你想要的任何东西。</li><li id="58eb" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">使用开源库<a class="ae ky" href="https://lodev.org/lodepng/" rel="noopener ugc nofollow" target="_blank"> LodePNG </a>将该图像保存到磁盘上的 PNG 文件中。</li><li id="dbde" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">这段代码重复前两步数百次，一次生成一个视频帧。每个 PNG 输出文件为您的电影保存一个静态帧图像。</li><li id="8ca5" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu na nb nc nd bi translated">在 Windows 或 Linux 上，使用<a class="ae ky" href="https://www.ffmpeg.org/" rel="noopener ugc nofollow" target="_blank"> ffmpeg </a>将一系列 PNG 图像转换为 MP4 视频格式文件。</li></ul><h2 id="725b" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">Mandelbrot 集合图像</h2><p id="6736" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">Mandelbrot 集合是最著名的分形物体之一。上面的视频将曼德布洛特集合的放大倍数从 1 倍逐渐增加到 1 亿倍。该视频以每秒 30 帧的速率持续 30 秒，总共快速连续播放了 900 幅图像。</p><p id="a64a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">值得注意的是，如此多的视觉复杂性从迭代微小的公式中显现出来</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nj lw l"/></div></figure><p id="389e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">源文件<a class="ae ky" href="https://github.com/cosinekitty/mandelzoom/blob/master/mandelzoom.cpp" rel="noopener ugc nofollow" target="_blank"> mandelzoom.cpp </a>中的<code class="fe nk nl nm nn b">Mandelbrot</code>函数迭代该公式，直到复值<em class="no"> z </em>超出原点半径为 2 的圆，或者<em class="no"> n </em>(迭代次数)达到最大限制。<em class="no"> n </em>的结果值决定了屏幕上给定像素的颜色。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np lw l"/></div></figure><p id="b0d4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">看一下函数<code class="fe nk nl nm nn b">Palette</code>,看看迭代计数是如何转换成红色、绿色和蓝色值的。</p><h2 id="1ace" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">在内存中生成图像</h2><p id="5a10" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">函数<code class="fe nk nl nm nn b">GenerateZoomFrames</code>产生一系列 PNG 输出文件。每个 PNG 文件都包含一个以不同放大率渲染的 Mandelbrot Set 图像。帧图像的分辨率为 1280 像素宽 720 像素高，这是标准的 HD 720p 视频尺寸。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np lw l"/></div></figure><h2 id="ca17" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">将图像保存到 PNG 文件</h2><p id="6ae3" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">对于您自己的视频生成器应用程序，类<code class="fe nk nl nm nn b">VideoFrame</code>可能会有所帮助。它表示视频的单个帧，并知道如何将该帧保存为 PNG 文件。函数<code class="fe nk nl nm nn b">GenerateZoomFrames</code>使用<code class="fe nk nl nm nn b">VideoFrame</code>生成分形缩放电影的每一帧。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np lw l"/></div></figure><p id="5261" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您的应用程序必须为每一帧的每一个像素调用成员函数<code class="fe nk nl nm nn b">VideoFrame::SetPixel</code>。您传入一个定义像素的红色、绿色和蓝色分量的<code class="fe nk nl nm nn b">PixelColor</code>结构。这些值都是 0 范围内的整数..255.</p><p id="8193" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nk nl nm nn b">PixelColor</code>还包含范围为 0 的 alpha 值..255 表示像素的透明度。对于视频应用程序，您应该始终将此设置为 255，这意味着像素完全不透明。为了通用性，我包括了 alpha 值，以防您希望生成具有透明区域的 PNG 文件。</p><h2 id="641a" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">使用 ffmpeg 创建电影</h2><p id="b843" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">我包含了一个 bash 脚本<code class="fe nk nl nm nn b">run</code>，它自动化了从源代码构建 mandelzoom 程序、运行它，以及将生成的 900 个 PNG 文件转换为名为<code class="fe nk nl nm nn b">zoom.mp4</code>的电影文件的整个过程。这最后一步是通过运行 ffmpeg 程序来完成的。下面是<code class="fe nk nl nm nn b">run</code>脚本。它包括一些有用的注释，解释 ffmpeg 的命令行参数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="np lw l"/></div></figure><p id="2279" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是全部了！您可以使用本文末尾“参考资料”一节中的链接下载整个源代码库<code class="fe nk nl nm nn b">mandelzoom</code>。</p><h2 id="afa1" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">另一个例子</h2><p id="e4e1" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li ms lk ll lm mt lo lp lq mu ls lt lu im bi translated">我提到过，这种技术可以用于创建你能想象的任何类型的视频，只要你能编写代码来创建每一帧。只是为了好玩，我以我创建的另一个 YouTube 视频样本作为结束。它是基于一个简单的<a class="ae ky" href="https://github.com/cosinekitty/raytrace" rel="noopener ugc nofollow" target="_blank">光线追踪</a>我为我的书<a class="ae ky" href="http://cosinekitty.com/raytrace/" rel="noopener ugc nofollow" target="_blank"> <em class="no">光线追踪</em> </a>的基础创建的。创建这个视频的代码与上面的 Mandelbrot zoomer 工作方式相同:它生成一系列 PNG 文件，然后 ffmpeg 将其转换为 MP4 文件。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div></figure><h2 id="c227" class="lx ly it bd lz ma mb dn mc md me dp mf li mg mh mi lm mj mk ml lq mm mn mo mp bi translated">参考</h2><ol class=""><li id="6fd4" class="mv mw it lb b lc mq lf mr li nq lm nr lq ns lu nt nb nc nd bi translated">曼德尔布罗变焦源代码:<a class="ae ky" href="https://github.com/cosinekitty/mandelzoom" rel="noopener ugc nofollow" target="_blank">https://github.com/cosinekitty/mandelzoom</a></li><li id="d593" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu nt nb nc nd bi translated">LodePNG 首页:<a class="ae ky" href="https://lodev.org/lodepng/" rel="noopener ugc nofollow" target="_blank">https://lodev.org/lodepng</a></li><li id="eff6" class="mv mw it lb b lc ne lf nf li ng lm nh lq ni lu nt nb nc nd bi translated">ffmpeg 项目页面:<a class="ae ky" href="https://www.ffmpeg.org/" rel="noopener ugc nofollow" target="_blank">https://www.ffmpeg.org</a></li></ol></div></div>    
</body>
</html>