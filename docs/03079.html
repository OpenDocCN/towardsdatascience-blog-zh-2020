<html>
<head>
<title>Common Pipenv Errors</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">常见Pipenv错误</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/common-pipenv-errors-3a6f8ce81562?source=collection_archive---------14-----------------------#2020-03-24">https://towardsdatascience.com/common-pipenv-errors-3a6f8ce81562?source=collection_archive---------14-----------------------#2020-03-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2e27" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Pipenv错误及其解决方案的集合。</h2></div><p id="c432" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作者:<a class="ae le" href="https://www.linkedin.com/in/edkrueger/" rel="noopener ugc nofollow" target="_blank"> Edward Krueger </a>数据科学家兼讲师和<a class="ae le" href="https://www.linkedin.com/in/douglas-franklin-1a3a2aa3/" rel="noopener ugc nofollow" target="_blank"> Douglas Franklin </a>助教兼开发者倡导者。</p><p id="bf56" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="lf">在本文中，我们将讨论Pipenv虚拟环境，在您的机器上的什么地方使用它们，如何利用Pipfile和Pipfile.lock特性，以及当这些操作不正确时可能出现的一些问题。我们从为什么环境对于数据科学和软件开发至关重要开始。</em></p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/86694cc3c09ab3114e656b8d6ccbb9aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_FE9k3IKceIO4nZszD32Xw.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">开发者最好的朋友:照片由Timothy Dykes在Unsplash上拍摄</p></figure><p id="ce32" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有关Pipenv环境或入门的更多信息，请查看本文</p><h1 id="49ef" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">数据科学和部署问题</h1><p id="3c0d" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">数据科学家通常是跨学科的，他们还没有开发出编码技能来与其他人合作并将项目推向生产。因此，通常缺乏环境和依赖性管理技能。这给代码可复制性和项目协作带来了困难。其他人可以轻松地重新创建、修改和运行的数据科学项目是可复制的数据科学项目</p><p id="feed" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正确执行的环境管理实践减少了项目之间的依赖版本冲突，并防止开发环境变得臃肿和不可管理，从而帮助用户创建可重复的项目。</p><h1 id="a816" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">Pipenv是什么？</h1><p id="8474" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">Pipenv将软件包管理和虚拟环境控制结合到一个工具中，用于安装、删除、跟踪和记录您的依赖关系；以及创建、使用和管理您的虚拟环境。Pipenv将pip和virtualenv结合成一个产品。有关Pipenv或虚拟环境的更多信息，请查看本文！</p><p id="29cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Pipenv将包管理和虚拟环境控制结合到一个工具中，使其成为数据科学家和开发人员的绝佳工具。</p><p id="44b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Pipenv基于每个项目来管理依赖项，因此最好在项目目录中使用Pipenv。要安装软件包，请转到您的项目目录并运行:</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="a25f" class="my lx it mu b gy mz na l nb nc">$ cd myproject<br/>$ pipenv install requests</span></pre><p id="25f0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当您使用Pipenv开始一个项目时，该工具会自动创建一个虚拟环境、一个Pipfile和一个Pipfile.lock。Pipfile存储运行项目代码所需的包或依赖项。对于那些使用pip开发的人来说，Pipfile非常类似于requirements.txt文件。Pipfile.lock存储特定的依赖版本，这些版本支持环境的确定性构建。当您使用<code class="fe nd ne nf mu b">pipenv install</code>来获得一个新的依赖项时，Pipfile和Pipfile.lock会自动用这个新的依赖项进行更新。在上面的例子中，您的Pipfile将包含包“requests”，而您的Pipfile.lock将包含已安装的版本。</p><h1 id="33d5" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">常见问题:虚拟环境和Pipfile位置</h1><p id="8d02" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">使用Pipenv，您需要为每个项目创建一个新目录。这允许您隔离依赖项及其关联的文件。这通常是一个好的实践，尤其是在创建隔离的开发环境时。</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="95f4" class="my lx it mu b gy mz na l nb nc">&gt; mkdir new_project</span><span id="83ad" class="my lx it mu b gy ng na l nb nc">&gt; cd new_project</span><span id="f87a" class="my lx it mu b gy ng na l nb nc">&gt; pipenv install pandas matplotlib</span></pre><p id="9c48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">完成上述命令后，您将拥有一个需要Python、Pandas和Matplotlib的项目的基础设施。这个基础结构由目录new_project、包含已安装包的Pipfile和包含它们的特定版本的Pipfile.lock组成。</p><p id="3077" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为每个项目创建一个新的目录和Pipenv环境将使您的机器保持有序，并允许从一个项目到另一个项目的无缝转换。要参与项目，请切换到一个新目录，并通过运行以下命令激活该目录的环境:</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="3bc6" class="my lx it mu b gy mz na l nb nc">&gt; pipenv install</span><span id="7c81" class="my lx it mu b gy ng na l nb nc">&gt; pipenv shell</span></pre></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><h2 id="60c5" class="my lx it bd ly no np dn mc nq nr dp mg kr ns nt mi kv nu nv mk kz nw nx mm ny bi translated">丢失的pip文件</h2><p id="5281" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">假设出于某种原因，你在一个奇怪的地方有一个Pipfile，比如在根目录下。当你使用</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="193b" class="my lx it mu b gy mz na l nb nc">&gt; pipenv install</span></pre><p id="b6b0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，在一个较低的目录<code class="fe nd ne nf mu b">~/Desktop/new_project</code>中，Pipenv将找到并使用根目录下的Pipfile。这实际上阻止了您使用该包来管理依赖项。在本例中，在根目录下有一个Pipfile，它为您在较低目录下创建的所有Pipenv虚拟环境提供资源。如果您遇到这种情况，您必须删除导致问题的杂散pip文件。</p><p id="9816" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们将重新创建这个错误。下面是一个没有Pipfile放在根目录那么极端的例子，但是将说明相同的概念，在路径的一个级别上有一个Pipfile，然后尝试在该路径的较低级别上创建另一个Pipfile。</p><p id="3dd9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里我们已经创建了目录pipenv_nesting_test并运行<code class="fe nd ne nf mu b">pipenv install pandas</code>。请注意，这将在该目录中创建Pipfile和Pipfile.lock。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/6b559a7d3f438174e5f64594b21e19f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/0*sWW8fNmZwf_tK3Ko.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">更高级目录中的Pipfile</p></figure><p id="5934" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意，Pipfile与nested_directory处于同一级别。现在我们将导航到这个目录并运行<code class="fe nd ne nf mu b">pipenv install matplotlib</code>。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi oa"><img src="../Images/282290fd6537ba9b35568cd004dde2f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3Gg-BhI1tm_NyRLW.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">安装matplotlib</p></figure><p id="8920" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意，在运行<code class="fe nd ne nf mu b">ls</code>之后，没有生成Pipfile或Pipfile.lock。这是因为Pipenv找到了路径中较高位置的Pipfile，并修改了这些文件中的数据以包含matplotlib。下面我们使用<code class="fe nd ne nf mu b">cat ../Pipfile</code>来可视化matplotlib确实已经被添加到路径中更高的Pipfile中。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ob"><img src="../Images/4b3fa05ffbe962b1138be4cf73772cce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9GQilFTCVRbtcnNP.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">包含熊猫和matplotlib的Pipfile</p></figure><p id="9b0a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将pip文件保存在它们的项目目录中是避免在您的机器上出现不明确或不确定的pip文件的最好方法。此外，当您在一个在线项目存储库中有一个pip文件时，例如Github，其他用户可以很容易地克隆您的repo，从pip文件重新创建您的环境，并运行您的代码！</p><h1 id="df69" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">常见问题:锁定失败</h1><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/7d94ecdbd5fe82f5c542c04518fbb6fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*sG2NyMbk6GZ2VvGhYC3OBw.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">锁定失败！</p></figure><h2 id="16a4" class="my lx it bd ly no np dn mc nq nr dp mg kr ns nt mi kv nu nv mk kz nw nx mm ny bi translated">Pipfile.lock是做什么的？</h2><p id="f52f" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">当您使用命令<code class="fe nd ne nf mu b">pipenv install</code>时，会创建一个Pipfile.lock文件。此外，命令<code class="fe nd ne nf mu b">pipenv lock</code>可以用来创建一个<code class="fe nd ne nf mu b">Pipfile.lock</code>，它在<strong class="kk iu">最新可用版本</strong>中声明<strong class="kk iu">项目的所有</strong>依赖项(和子依赖项)，并存储下载文件的当前散列。这意味着依赖项和子依赖项的所有特定版本都存储在Pipfile.lock中。这确保了可重复的，最重要的是，<strong class="kk iu"> <em class="lf">确定性的</em> </strong>构建。然而，许多不良做法可能导致锁定失败。下面我们将介绍一些避免和解决这个问题的方法。</p><p id="e218" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">命令<code class="fe nd ne nf mu b">pipenv install</code>首先尝试从Pipfile.lock构建虚拟环境，如果Pipfile.lock不可用，Pipenv将从Pipfile创建虚拟环境，然后创建Pipfile.lock。</p><h2 id="d66c" class="my lx it bd ly no np dn mc nq nr dp mg kr ns nt mi kv nu nv mk kz nw nx mm ny bi translated">锁定问题:Pipfile包含对不存在的包的引用</h2><p id="4e3c" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">Pipfile.lock在尝试安装不存在的软件包(即错别字)时不会锁定。</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="d1ca" class="my lx it mu b gy mz na l nb nc">pipenv install panadas</span></pre><p id="2a4d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Pipenv查找您指定的包，不管它是否存在。当包不存在或由于其他原因找不到时，您会在终端中看到以下错误以及更多错误。现在，我们将把重点放在这两个方面。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi od"><img src="../Images/662c62954a623f5c81ba5ad186fe9e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/0*YmJRUwKtLzD8NikT.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">安装错别字</p></figure><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi oe"><img src="../Images/0106f0d0ff51f87d12025380aaf20479.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/0*fSqSCsUMm9YYbHfK.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">Pipenv找不到Panadas的版本</p></figure><p id="dfab" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">锁定失败！请注意,“panadas”被添加到Pipfile的包中。这种打字错误将成为一个问题，因为现在我们的Pipfile包含一个错误，任何使用这个Pipfile的人都会遇到锁定和依赖错误。请注意，“安装成功”警报是不真实的；没有要安装的Panadas。所发生的只是将“panadas”添加到Pipfile中。Pipfile中的拼写错误是锁定失败的最常见原因。</p><p id="3561" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">只要Pipfile中存在这种输入错误，安装一个包，不管存在与否，都会导致锁定失败。您需要在文本编辑器中修复Pipfile。我用的是纳米。你可以使用任何你觉得舒服的编辑器；Sublime，VS代码，Atom等。简单地把Panadas改成熊猫然后<code class="fe nd ne nf mu b">pipenv install.</code></p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi of"><img src="../Images/a9caae31d0f58cbe09a4a64cc1a3d9f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iNfr5K7ZX0IUJEQs.png"/></div></div></figure><p id="7c47" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们看看锁定失败时控制台中出现的其他一些错误消息。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi og"><img src="../Images/c7c9da16399aab7d19b51fdc32bd883c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OSbZFCmwqbggSAf3.png"/></div></div></figure><p id="3516" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意建议<code class="fe nd ne nf mu b">pipenv install --skip-lock</code>。这应该只在极端或因果编程环境中使用，因为它绕过了Pipfile。锁的主要用途；锁定软件包版本并创建安装环境依赖项的公式。</p><p id="c227" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当在另一台机器上克隆存储库时，可能会遇到Pipfile.lock不兼容问题。这是因为Pipfile.lock是特定于系统的。如果合作开发人员使用不同的系统，即macOS和Windows，最好删除Pipfile.lock，让每个系统解决其依赖性。在这种情况下，确保每个人都使用相同版本的包，方法是手动将它们固定在Pipfile中。</p><p id="f7d7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">锁定失败的另一个常见原因是，如果Pipfile中的包只作为预发布版本存在。要允许预发布软件包，您必须在install命令中添加— pre标志，否则锁定将会失败。</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="8cc5" class="my lx it mu b gy mz na l nb nc">pipenv install --pre black</span></pre><p id="a73b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以通过在安装命令<code class="fe nd ne nf mu b">pipenv install --pre</code>中添加pre标志来解决预发布版本冲突。在这个命令之后，您的Pipfile有了一个新变量；allow_prereleases = true。请注意，这将允许在您的环境中安装任何预发行软件包。现在是固定特定包版本有用的时候了。固定版本是一个很好的习惯，可以防止将来出现依赖问题。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/e8ea640b5f22a576296887725df5b3dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*Wkw05gBNBszJmIT5OCt47A.png"/></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">允许Pipfile中的预发布</p></figure><p id="45ca" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> Pipfile管理:指定Python版本</strong></p><p id="447f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请注意上面“要求”部分下的Pipfile图像；你看python_version = 3.7。Pipenv可用于指定Python版本和包版本。</p><p id="7c56" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要使用特定的Python版本构建Pipfile或环境，请使用以下语法。</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="78dc" class="my lx it mu b gy mz na l nb nc">pipenv --python &lt;path&gt;<br/>#or<br/>pipenv --python python3</span></pre><p id="988b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意:需要时可以指定包的版本。</p><p id="c257" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">展示pip文件的样子，并说明您也可以直接在pip文件中修改它</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="9f49" class="my lx it mu b gy mz na l nb nc">pipenv install flask1.1.1</span></pre><p id="379d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">注意，这个版本被固定在下面的Pipfile中。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/53bba655d872495b1102a335301a5986.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*xIzEgdlijH9irQioW1vH-w.png"/></div></figure><p id="d87e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可能还想直接编辑您的Pipfile来更改版本。</p><h1 id="8215" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">常见问题:在虚拟环境中运行Jupyter</h1><p id="62e5" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">许多数据科学家使用Jupyter进行探索性数据分析和模型选择。Jupyter可能很难与包管理器一起使用。但是，我们可以很容易地用Pipenv创建一个环境，并用一个内核将其连接到Jupyter。</p><p id="7178" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在Jupyter中，您可以访问指向虚拟环境的Jupyter内核。虚拟环境是用Pipenv创建的。</p><p id="b122" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Pipenv自动将项目映射到其特定的虚拟环境。命令<code class="fe nd ne nf mu b">pipenv shell</code>指向你计算机上的一个虚拟环境。虚拟环境以项目根目录的名称加上项目根目录的完整路径的散列(即<code class="fe nd ne nf mu b">my_project-a3de50</code>)进行全局存储。因此，如果您更改项目的路径，就会破坏这样的默认映射，Pipenv将不再能够找到并使用项目的虚拟环境。</p><p id="bdcf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在使用下面的命令之前，您需要知道您的Python版本并安装Jupyter。设置指南可在“Pipenv工作流教程:Jupyter”标题下的另一篇文章<strong class="kk iu">、</strong>、<a class="ae le" rel="noopener" target="_blank" href="/virtual-environments-for-data-science-running-python-and-jupyter-with-pipenv-c6cb6c44a405">、<strong class="kk iu">中找到。</strong></a></p><p id="e92f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将Pipenv虚拟环境连接到Jupyter内核。首先，运行<code class="fe nd ne nf mu b">pipenv shell.</code>,然后在shell中创建Jupyter内核，使其指向虚拟环境。</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="c40b" class="my lx it mu b gy mz na l nb nc">python3.7 -m ipykernel install --user --display-name matpltlib --name matpltlib</span></pre><p id="ebb6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当让内核指定一切时，为了安全起见。一些计算机的内核总是被命名为Python 3，当<code class="fe nd ne nf mu b">--display-name</code>或<code class="fe nd ne nf mu b">--name</code>没有通过时，会覆盖其他虚拟环境。我们建议对<code class="fe nd ne nf mu b">--name</code>和<code class="fe nd ne nf mu b">--display-name</code>使用相同的名称，以避免混淆。</p><p id="ce98" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你只有一个版本的Python，你应该可以使用<code class="fe nd ne nf mu b">python</code>而不是上面的<code class="fe nd ne nf mu b">python3.7</code>。如果您使用的是Mac，默认情况下您将拥有Python版本。如果您不确定您使用的是哪个Python版本，请查看:</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="891c" class="my lx it mu b gy mz na l nb nc">python --version<br/>#and/or<br/>python3 --version</span></pre><h2 id="8c2b" class="my lx it bd ly no np dn mc nq nr dp mg kr ns nt mi kv nu nv mk kz nw nx mm ny bi translated">在Jupyter中选择内核</h2><p id="6105" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">完成上述操作后，您现在应该能够运行:</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="2e74" class="my lx it mu b gy mz na l nb nc">jupyter notebook</span></pre><p id="1ee1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者您更喜欢实验室用户界面和附加功能。</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="186e" class="my lx it mu b gy mz na l nb nc">jupyter lab</span></pre><p id="2adc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<strong class="kk iu"> Jupyter Notebook中，</strong>选择“新建”查看下拉列表，查看可用内核列表。请注意，上面第3步中创建的“example_env”是内核的名称。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi oj"><img src="../Images/b6562de10d0ef6c1dbd301e0f3284778.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OEfEVedPCtFmAdt3.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">选择笔记本中的内核</p></figure><p id="dfee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<strong class="kk iu"> Jupyter Lab，</strong>你必须点击右上角的内核框来访问内核列表。或者，您可以单击“内核”选项卡，然后选择“更改内核”来访问同一个下拉菜单。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ok"><img src="../Images/13adf27eded5a13987389d3b831bb5d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BNrolSRww0GdVPck.png"/></div></div><p class="ls lt gj gh gi lu lv bd b be z dk translated">实验室中选择内核的两个位置</p></figure><h2 id="2784" class="my lx it bd ly no np dn mc nq nr dp mg kr ns nt mi kv nu nv mk kz nw nx mm ny bi translated">测试导入</h2><p id="65af" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">在一个新的。ipynb文件，尝试在单元格中运行以下代码。</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="87f8" class="my lx it mu b gy mz na l nb nc">import pandas</span></pre><p id="5cba" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果成功的话，你正在改进你的开发工作流程！</p><p id="1aa8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果出现任何问题，请确保您选择了正确的内核，在连接内核和运行<code class="fe nd ne nf mu b">jupyter lab</code>或<code class="fe nd ne nf mu b">jupyter notebook</code>之前，您已经运行了<code class="fe nd ne nf mu b">pipenv shell</code>。</p><h1 id="a30d" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">结论</h1><p id="5bef" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">Pipenv是开发人员和数据科学家的优秀工具。然而，在学习这些工具和方法时，我们会遇到一些常见的错误。对于Pipenv，Pipfile.lock在默认情况下固定特定的版本；然而，由于提到的锁定问题和其他复杂性，当在开发人员之间共享时，锁可能会失败。因此，将您的依赖项固定在Pipfile中用于生产是一个最佳实践，并且在从Pipfile.lock构建环境时要小心。此外，在共享Pipfile或使用它来构建环境之前，您需要检查您的Pipfile是否有拼写错误！</p><p id="d853" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Jupyter笔记本是学习代码或制作使用代码创建可视化的报告的有用工具。在Pipenv虚拟环境中使用Jupyter可以让您将所有环境依赖项导入笔记本，从而简化依赖项管理。将虚拟环境连接到Jupyter内核可能会很棘手，但是如果您按照上面的步骤操作，应该没有任何困难！</p><p id="8ae7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为数据科学家和开发人员，正确的开发、打包和虚拟环境管理实践都是需要学习的关键技能。使用Pipenv来管理虚拟环境可以加速生产，并允许您创建确定性的构建来复制代码和将项目推向生产。</p><p id="f700" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">将pip文件保存在它们的项目目录中是避免在您的机器上出现任何含糊不清或杂乱无章的pip文件的方法。此外，当您在一个在线存储库中有一个Pipfile时，例如Github，其他用户可以很容易地克隆您的repo，重新创建您的环境，并使用您的代码。通过Pipenv和Pipfile，您向其他人展示了一种安装项目依赖项以及测试和开发需求的标准化方法。任何拥有您的Pipfile副本的人都可以使用以下内容重新创建您的环境。</p><pre class="lh li lj lk gt mt mu mv mw aw mx bi"><span id="01ab" class="my lx it mu b gy mz na l nb nc">pipenv install</span></pre><p id="65b4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个命令创建一个由Pipfile指定的环境。在分享它之前，只要确保它没有打字错误，并且指定了正确的包和Python版本就可以了！</p><p id="a3e8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们希望这是信息丰富和有帮助的。祝你好运，继续编码！</p></div></div>    
</body>
</html>