<html>
<head>
<title>Automating Real Estate Investment Analysis: Python Web Scraping Bot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化房地产投资分析:Python网络抓取机器人</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automating-real-estate-investment-analysis-d2b07395833b?source=collection_archive---------6-----------------------#2020-01-18">https://towardsdatascience.com/automating-real-estate-investment-analysis-d2b07395833b?source=collection_archive---------6-----------------------#2020-01-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8c7e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">python中的数据挖掘实现房地产交易筛选自动化。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8b23f5985e7c2e9cf97cf1a487ecd22c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FQBVMffAujxxRURLJikIQw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">房屋图片(来自<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> unsplash </a></p></figure><h1 id="5073" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">摘要</h1><p id="6848" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">目标是构建一个能够分析投资属性的python web工具。该工具将使用数据挖掘来查找房地产价格，然后分析回报率。</p><h1 id="4bac" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">索引</h1><blockquote class="mk ml mm"><p id="a996" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">摘要</p><p id="b13d" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">索引</p><p id="e97f" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">动机</p><p id="f426" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">该应用程序</p><p id="480b" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">这些功能</p><p id="ea4e" class="lo lp mn lq b lr mo jr lt lu mp ju lw mq mr lz ma ms mt md me mu mv mh mi mj ij bi translated">总结和展望</p></blockquote><h1 id="779f" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">动机</h1><p id="dc5c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">机器人或自动化在交易和投资中的应用并不新鲜。多个例子包括股票交易机器人，其任务是根据不同的模型或指标来购买或出售资产。复兴科技因其通过算法投资获得的回报率而受到世界关注，该回报率在30年的时间跨度内平均达到<a class="ae kv" href="https://www.businessinsider.com/how-jim-simons-renaissance-technologies-has-outperformed-market-30-years-2019-12" rel="noopener ugc nofollow" target="_blank"> 60%以上的年化回报率</a>。</p><p id="98a5" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">自动化的好处有可能改变不同规模的企业。单个重复性任务可通过内部开发的软件或第三方SaaS平台实现自动化。</p><p id="aa5b" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">对于个人散户投资者来说，python机器人为房地产投资的各种元素提供了一个有前途的解决方案。在本文中，我们将研究分析属性过程的自动化。其他可以自动化的流程包括:列出物业，向租户发送通知，筛选租户(机器学习或人工智能)，甚至自动派遣维护人员。</p><h1 id="c873" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">该计划</h1><h2 id="1778" class="mw kx iq bd ky mx my dn lc mz na dp lg lx nb nc li mb nd ne lk mf nf ng lm nh bi translated">输入和输出</h2><p id="7553" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">该程序有三个输入:房源URL、月租金价格和财产税税率。它返回每月现金流、上限利率和现金回报率。</p><ul class=""><li id="4a96" class="ni nj iq lq b lr mo lu mp lx nk mb nl mf nm mj nn no np nq bi translated"><strong class="lq ir"> <em class="mn">现金流</em> </strong> —扣除所有费用(抵押贷款、物业管理、维修补贴、空置费用)后的每月利润</li><li id="f37d" class="ni nj iq lq b lr nr lu ns lx nt mb nu mf nv mj nn no np nq bi translated"><strong class="lq ir"><em class="mn"/></strong>—每年的净收入除以资产价格(百分比)</li><li id="0a33" class="ni nj iq lq b lr nr lu ns lx nt mb nu mf nv mj nn no np nq bi translated"><strong class="lq ir"><em class="mn"/></strong>—每年净收入除以用于资产的首付款(百分比)</li></ul><h2 id="33ae" class="mw kx iq bd ky mx my dn lc mz na dp lg lx nb nc li mb nd ne lk mf nf ng lm nh bi translated">包装</h2><p id="0ec8" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">使用了以下软件包。注意对于那些在Anacondas环境中工作的人来说，streamlit目前似乎不能通过这个包管理器使用。Streamlit是和pip一起安装的，当PIP和Anacondas一起使用时<a class="ae kv" href="https://www.anaconda.com/using-pip-in-a-conda-environment/" rel="noopener ugc nofollow" target="_blank">可能会导致问题</a></p><ul class=""><li id="4529" class="ni nj iq lq b lr mo lu mp lx nk mb nl mf nm mj nn no np nq bi translated"><strong class="lq ir"> <em class="mn">请求</em> </strong> —这个包用于通过HTTP请求访问python中的网站。</li><li id="f05c" class="ni nj iq lq b lr nr lu ns lx nt mb nu mf nv mj nn no np nq bi translated"><strong class="lq ir"> <em class="mn">美汤4 </em> </strong> —用于网页抓取和数据挖掘。我们能够使用这个包来检索描述网站内容和样式的HTML代码。一旦检索到HTML代码，就可以利用beautiful soup来隔离站点的特定部分。例如，在这个项目中，我们使用美丽的汤来获取房价。</li><li id="f80c" class="ni nj iq lq b lr nr lu ns lx nt mb nu mf nv mj nn no np nq bi translated"><strong class="lq ir"> <em class="mn"> Streamlit </em> </strong> —这个包让部署web应用程序变得超级简单。代码是在Jupyter笔记本上开发的，然后转换成。py脚本一旦开始工作。Streamlit允许无缝部署，并最大限度地减少用户界面上花费的时间。使用streamlit，将python用于后端、flask用于部署、react用于动态内容的经典部署选项要简单得多。</li></ul><h2 id="8805" class="mw kx iq bd ky mx my dn lc mz na dp lg lx nb nc li mb nd ne lk mf nf ng lm nh bi translated">编写代码</h2><p id="f7be" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">完成大部分繁重工作的函数是<strong class="lq ir"> price_mine </strong>、<strong class="lq ir"> mortgage_monthly </strong>和<strong class="lq ir"> net_operating </strong>。</p><p id="5d5e" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">这些是分别执行以下职责的主要功能:</p><ul class=""><li id="7947" class="ni nj iq lq b lr mo lu mp lx nk mb nl mf nm mj nn no np nq bi translated">从URL中检索标价</li><li id="2fcf" class="ni nj iq lq b lr nr lu ns lx nt mb nu mf nv mj nn no np nq bi translated">计算每月抵押贷款成本</li><li id="7be1" class="ni nj iq lq b lr nr lu ns lx nt mb nu mf nv mj nn no np nq bi translated">计算扣除所有费用后的每月净营业收入</li><li id="1cb1" class="ni nj iq lq b lr nr lu ns lx nt mb nu mf nv mj nn no np nq bi translated"><strong class="lq ir"><em class="mn">price _ mine</em></strong><em class="mn">|</em>该函数用于从房源中检索房价。可以使用API，但是网络抓取更强大。web抓取的缺点是站点结构的改变需要在代码中更新。在这里，网页刮包使用的是美丽的汤。这个过程相对简单，使用f12检查网页，然后在HTML代码中找到所需的元素。这段代码可以被隔离在beautiful soup中，以检索页面的特定部分。检索到代码后，内置的python函数replace用于删除逗号、美元符号和不必要的空格，以便建立一个浮点变量。</li></ul><pre class="kg kh ki kj gt nw nx ny nz aw oa bi"><span id="c9c1" class="mw kx iq nx b gy ob oc l od oe"><strong class="nx ir"><br/>def</strong> price_mine(url):<br/>    <em class="mn">#Currently this function takes an input of a URL and returns the listing prices </em><br/>    <em class="mn">#The site it mines is remax</em><br/>    <em class="mn">#The input must be a string input, we can reformat the input to force this to work</em><br/>    <em class="mn">#Next we use regex to remove space and commas and dollar signs </em><br/>    headers = ({'User-Agent':<br/>            'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36'})<br/>    response = get(url)<br/>    response_text = response.text<br/>    html_soup = BeautifulSoup(response_text, 'html.parser')<br/>    prices = html_soup.find('h2',{'class': 'price'}).text<br/>    prices = prices.replace(",", "")<br/>    prices = prices.replace("$", "")<br/>    prices = prices.replace(" ", "")<br/>    prices = float(prices)<br/>  <br/>    <strong class="nx ir">return</strong> prices<br/></span></pre><ul class=""><li id="8079" class="ni nj iq lq b lr mo lu mp lx nk mb nl mf nm mj nn no np nq bi translated"><strong class="lq ir"><em class="mn">mortgage _ monthly</em>|</strong>该函数将挂牌价格、抵押期限和利率作为输入，并返回每月抵押价格。有许多方法来计算每月抵押贷款价格，没有作出具体的决定，至于使用哪种方法和一个通用算法，是相当容易实现的使用。</li></ul><pre class="kg kh ki kj gt nw nx ny nz aw oa bi"><span id="5b7d" class="mw kx iq nx b gy ob oc l od oe"><strong class="nx ir">def</strong> mortgage_monthly(price,years,percent):<br/>    <br/>    <br/>    <em class="mn">#This implements an approach to finding a monthly mortgage amount from the purchase price,</em><br/>    <em class="mn">#years and percent. </em><br/>    <em class="mn">#Sample input: (300000,20,4) = 2422</em><br/>    <em class="mn">#</em><br/>    <br/>    <br/>    percent = percent /100<br/>    down = down_payment(price,20)<br/>    loan = price - down<br/>    months = years*12<br/>    interest_monthly = percent/12<br/>    interest_plus = interest_monthly + 1<br/>    exponent = (interest_plus)**(-1*months)<br/>    subtract = 1 - exponent<br/>    division = interest_monthly / subtract<br/>    payment = division * loan<br/>    <br/>    <br/>    <strong class="nx ir">return</strong>(payment)<br/></span></pre><ul class=""><li id="f6c9" class="ni nj iq lq b lr mo lu mp lx nk mb nl mf nm mj nn no np nq bi translated"><strong class="lq ir"> <em class="mn"> net_operating </em> | </strong>该函数以月租金、税率和价格作为输入，返回每月的净营业收入。净营业收入的金额分别代表支付抵押贷款(本金和利息)、财产税、支付管理费(每月10%)、物业维修补贴和空置补贴后的现金。有人可能会说，只有每月支付的利息才构成费用，因为本金是建立在股本基础上的。虽然这是真的，但我们的模型想知道在支付所有费用后还剩多少现金。个人投资分析机器人可以改变像这样的元素，使个人投资者的计算个性化。</li></ul><pre class="kg kh ki kj gt nw nx ny nz aw oa bi"><span id="4bde" class="mw kx iq nx b gy ob oc l od oe"><strong class="nx ir"><br/>def</strong> net_operating(rent, tax_rate, price):<br/>    <br/>    <em class="mn">#Takes input as monthly mortgage amount and monthly rental amount</em><br/>    <em class="mn">#Uses managment expense, amount for repairs, vacancy ratio</em><br/>    <em class="mn">#Example input: net_operating(1000,1,400,200)</em><br/>    <em class="mn">#879.33</em><br/>    <em class="mn">#1000 - 16.67 (tax) - 100 (managment) - 4 (repairs)</em><br/>    <br/>    mortgage_amt = mortgage_monthly(price,20,3)<br/>    prop_managment = rent * 0.10<br/>    prop_tax = (price * (tax_rate/100)/12)<br/>    prop_repairs = (price * 0.02)/12<br/>    vacancy = (rent*0.02)<br/>    <em class="mn">#These sections are a list of all the expenses used and formulas for each</em><br/>    <br/>    net_income = rent - prop_managment - prop_tax - prop_repairs - vacancy - mortgage_amt<br/>    <em class="mn">#Summing up expenses</em><br/>    output = [prop_managment, prop_tax, prop_repairs, vacancy, net_income]<br/>  <br/>    <br/>    <strong class="nx ir">return</strong> output<br/></span></pre><p id="49c3" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated"><strong class="lq ir">其他功能:</strong></p><p id="ec9e" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">使用的其他函数，如cap_rate，以百分比计算净收入与资产价格的比率。完整的函数列表可以在项目的GitHub资源库中找到，但是不包括在本文档中。</p><h1 id="7355" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">构建界面</h1><h2 id="8f13" class="mw kx iq bd ky mx my dn lc mz na dp lg lx nb nc li mb nd ne lk mf nf ng lm nh bi translated">早期概念化</h2><p id="f3f7" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">想法是让输入在页面的左边，输出在页面的右边。输入被放置在侧边栏中，这样输入和输出在视觉上是不同的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/ee551009632f147c1fe238613fb65a0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8JmsE3WpFiXzlbOZ5vRXBg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">初始用户界面概念草图</p></figure><h2 id="1983" class="mw kx iq bd ky mx my dn lc mz na dp lg lx nb nc li mb nd ne lk mf nf ng lm nh bi translated">介绍streamlit</h2><p id="1f1e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">构建这个仪表板的一个常见方法是用HTML创建一个静态网站，用flask部署后端，在某种数据库中存储值，然后用react链接所有内容。<a class="ae kv" href="https://medium.com/swlh/part-1-will-streamlit-kill-off-flask-5ecd75f879c8" rel="noopener">一种比这种方法更具优势的新的替代部署途径被称为streamlit。</a></p><p id="3f94" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">Streamlit允许从python脚本快速过渡到现代用户体验。它还提供了一种简单快速的部署途径。转换的第一步是替换内置的python输入函数，并用streamlit输入框替换它们。对输出进行了同样的替换。</p><p id="55e9" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">一旦完成，就可以从控制台<a class="ae kv" rel="noopener" target="_blank" href="/quickly-build-and-deploy-an-application-with-streamlit-988ca08c7e83">部署</a>streamlit应用程序，并通过外部IP地址进行访问。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/94f5a93ad365b55a575dd604cf32d69c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7TnOs9oNDQme8gGsC4rBOA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">streamlit内置的初始用户界面</p></figure><p id="bf57" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">一旦在streamlit中构建了用户界面，就要修改代码，为输入添加一个侧栏，如上面草图中最初描述的那样。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/98827fba77c2745cbe5af7778c76a1dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qINtbhBHfELWhgBdOtQo1A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">带有输入侧边栏的用户界面</p></figure><h2 id="1e01" class="mw kx iq bd ky mx my dn lc mz na dp lg lx nb nc li mb nd ne lk mf nf ng lm nh bi translated">最终代码</h2><p id="1a44" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">最终代码可以在GitHub上找到。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oi oj l"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">项目的GitHub存储库</p></figure><h1 id="691f" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">总结和未来方向</h1><p id="1677" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">尽管复兴科技(renaissance technology)等集团能够从应用于投资的数学模型中获利，但个人散户投资者也能从中受益，而且实施起来要容易得多。</p><p id="64a0" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated">房地产投资者可以从自动化中受益，处理许多以前需要助理或占用大量时间的任务。这是一个使用自动化来减少过滤交易时间的例子。如果自动生成摘要报告，并且只将最好的资产呈现给人类，投资者可以审查更多的交易。夫妻店、房地产投资者和企业家可以从自动化中受益，而不仅仅是财富500强公司。</p></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><p id="7613" class="pw-post-body-paragraph lo lp iq lq b lr mo jr lt lu mp ju lw lx mr lz ma mb mt md me mf mv mh mi mj ij bi translated"><strong class="lq ir"> <em class="mn">注来自《走向数据科学》的编辑:</em> </strong> <em class="mn">虽然我们允许独立作者根据我们的</em> <a class="ae kv" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="mn">规则和指导方针</em> </a> <em class="mn">发表文章，但我们不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae kv" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="mn">读者术语</em> </a> <em class="mn">。</em></p></div></div>    
</body>
</html>