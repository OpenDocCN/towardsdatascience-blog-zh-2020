<html>
<head>
<title>Language Modeling — I</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">语言建模— I</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/language-modeling-c1cf7b983685?source=collection_archive---------27-----------------------#2020-04-24">https://towardsdatascience.com/language-modeling-c1cf7b983685?source=collection_archive---------27-----------------------#2020-04-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><blockquote class="jq jr js"><p id="d8d6" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">这是关于语言建模的第5部分系列的第1部分。</p></blockquote><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/86b6ff3c328fc9a326f28cb537c10561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jb1fPBc4bbFSiOnMD4MBVw.png"/></div></div><p class="lf lg gj gh gi lh li bd b be z dk translated">使用键盘中的语言模型预测下一个单词<a class="ae ks" href="https://www.linkedin.com/in/mandardeshpande1995/" rel="noopener ugc nofollow" target="_blank"> (Mandar Deshpande) </a></p></figure><h1 id="aec3" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">介绍</h1><p id="a471" class="pw-post-body-paragraph jt ju it jw b jx mh jz ka kb mi kd ke mj mk kh ki ml mm kl km mn mo kp kq kr im bi translated">现在你可能已经猜到了，语言建模是我们日常使用的一个用例，但它仍然是一个很难理解的概念。REALM(检索增强语言模型预训练)是该领域不断发展的研究的最新成果。这是一个很大的进步，这正是为什么它使这篇论文成为一篇具有挑战性的文章来阅读和评论。</p><p id="8781" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">这篇博客假设你对深度学习、词向量和嵌入空间有基本的了解，因为这些是掌握语言模型的先决条件。</p><p id="7fa7" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">训练(深度)计算机视觉模型的主要方法也逐渐到达了自然语言处理的领域。我们正在谈论迁移学习。</p><p id="af2c" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">一旦我们理解了NLP中的模型预训练的情况，我们将会在一个舒适而混乱的地方去理解REALM做什么和如何做！</p><p id="33cc" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">为了带领我们了解语言建模领域并掌握相关概念，我们将在这一系列博客中讨论以下内容:</p><ul class=""><li id="7769" class="mp mq it jw b jx jy kb kc mj mr ml ms mn mt kr mu mv mw mx bi translated">迁移学习及其与模型预训练的相关性</li><li id="9987" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr mu mv mw mx bi translated">开放领域问答(Open-QA)</li><li id="7168" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr mu mv mw mx bi translated">语言理解双向转换器</li><li id="efa7" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr mu mv mw mx bi translated">Roberta(稳健优化的BERT预训练方法)</li><li id="dc66" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr mu mv mw mx bi translated">谷歌T5</li><li id="393b" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr mu mv mw mx bi translated">领域:检索增强语言模型预训练</li></ul><p id="413d" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">这篇文章将特别尝试解释以下几点:</p><ul class=""><li id="3c3d" class="mp mq it jw b jx jy kb kc mj mr ml ms mn mt kr mu mv mw mx bi translated">迁移学习</li><li id="5298" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr mu mv mw mx bi translated">语言模型预训练</li></ul><h1 id="62e9" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">迁移学习</h1><p id="2403" class="pw-post-body-paragraph jt ju it jw b jx mh jz ka kb mi kd ke mj mk kh ki ml mm kl km mn mo kp kq kr im bi translated">当我们有一个庞大的图像数据集，我们想解决一个图像分类和/或定位任务，我们明确利用图像像素作为特征。训练深度神经网络来解决这些任务需要我们利用海量的计算能力和数据。通常，从事该领域工作的大型科技公司和研究实验室已经从头开始训练了许多这样的网络，并在网上发布了预训练的权重。我们如何利用这一点？</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi nd"><img src="../Images/ccd351fca0c6a21c52496e072dad9d2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*itwiuj_HVMA-oxoOnuso1w.png"/></div></div><p class="lf lg gj gh gi lh li bd b be z dk translated">使用卷积神经网络的迁移学习<a class="ae ks" href="https://www.linkedin.com/in/mandardeshpande1995/" rel="noopener ugc nofollow" target="_blank"> (Mandar Deshpande) </a></p></figure><p id="c361" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">让我们考虑一个简单的卷积神经网络(如上所示),它有4个卷积层(conv + relu +最大池),后面是一个全连接(FC)层，该层以softmax或sigmoid之类的损失函数终止。我们正在ImageNet数据集上训练该模型，该数据集是属于大约1000个类的大约100万个图像的集合。</p><p id="d820" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">现在，深度神经网络的任务是逐步提取特征，并将这些特征组合起来，以学习更复杂的特征。上图中显示的每一层都执行以下任务:</p><ul class=""><li id="9968" class="mp mq it jw b jx jy kb kc mj mr ml ms mn mt kr mu mv mw mx bi translated"><strong class="jw iu">con v1</strong>-提取简单的边、曲线和直线</li><li id="25d7" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr mu mv mw mx bi translated"><strong class="jw iu"> Conv2 </strong> —使用这些学习到的特征来提取图像中的形状和几何线段</li><li id="40e7" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr mu mv mw mx bi translated"><strong class="jw iu">con v3</strong>——学习检测网格图案、光滑布料或道路等纹理</li><li id="5e3c" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr mu mv mw mx bi translated">学习更复杂的特征，如眼睛、耳朵、椅子、门和其他帮助我们理解物体可能是什么的基本线索</li><li id="f36a" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr mu mv mw mx bi translated"><strong class="jw iu"> FC层</strong>——使用先前学习的特征找出组合，这些组合一起很好地给出待分类物体的连贯图像</li><li id="96c0" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr mu mv mw mx bi translated"><strong class="jw iu">损失函数</strong>—FC层给出的这个组合被转换成一个分数，高分数/概率类作为预测返回</li></ul><p id="7985" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">现在，如果我们仔细观察，模型在前几层中学习的特征对于任何图像都是非常通用的，并且可以被视为在一系列图像类别中是冗余的。帮助我们明确区分对象的唯一层是具有损失函数的全连接层。</p><p id="6a6f" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">一般来说，当我们谈论训练深度神经网络时，我们的意思是我们将<strong class="jw iu">冻结大多数卷积层的权重</strong>(用粉色标记),我们只是<strong class="jw iu">用损失函数(用绿色标记)修改完全连接层的权重</strong>。本质上，我们可以在冻结层之后改变整个网络，使其适合类似的基于图像的学习任务。通过对新的用例特定数据的训练，仅修改允许改变的权重部分。这种对预训练模型的权重的更新被称为<strong class="jw iu">微调</strong>。</p><blockquote class="jq jr js"><p id="ed0a" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">例如，我们有一个用于图像分类的预训练模型，该模型具有特定的损失函数，我们希望解决图像分割的任务。因此，我们冻结conv层并修改FC层以优化与分割相关的损失函数，使得我们的模型学习预测边界框(位置)以及对象类别预测。</p></blockquote><p id="5a8d" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">使用在学习任务的特定领域训练的模型，并重新利用学习到的权重来解决另一个类似的学习任务，这被称为<strong class="jw iu">迁移学习。</strong></p><p id="b466" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">由于使用迁移学习训练的模型不需要从头开始学习，它可以很容易地被训练到相同或更高的性能指标(例如准确性)，而不需要太多的计算成本和时间。</p><h1 id="efc7" class="lj lk it bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">语言模型预训练</h1><p id="7def" class="pw-post-body-paragraph jt ju it jw b jx mh jz ka kb mi kd ke mj mk kh ki ml mm kl km mn mo kp kq kr im bi translated">当我们处理大量的文本数据时，了解单词序列彼此跟随的概率以及理解这种相关性需要哪些特定的特征是有帮助的。</p><p id="3a4b" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated"><strong class="jw iu">语言建模</strong>是理解单词序列的概率分布的任务。这有助于我们创建能够根据句子和短语出现的上下文来区分它们的特征。</p><p id="a629" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated"><strong class="jw iu">与单词嵌入的比较<br/> </strong>每当我们想要在我们的模型中使用单词或文本数据作为特征时，我们通常将它们转换成稀疏向量，如一键编码，或者称为<strong class="jw iu">嵌入</strong>的密集向量。尽管预先训练的嵌入也已经在早期广泛地用于NLP任务，语言模型预先训练的新颖性在于它们是为特定的下游任务微调的，而不像嵌入那样广泛地用于文本。像word2vec和GloVe这样的嵌入是单词或句子的向量表示，它捕捉每个单词的上下文和语义特征。预先训练的语言模型进一步将这些嵌入提取为特定于任务的表示，从而通过在特定于任务的数据集上进行训练来实现特定的目标。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi ne"><img src="../Images/fa29c8184ba0eb677c756b98fb20533c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NmM9J_34HWvNt2idYEkGMQ.png"/></div></div><p class="lf lg gj gh gi lh li bd b be z dk translated">预培训语言模型使用管道<a class="ae ks" href="https://www.linkedin.com/in/mandardeshpande1995/" rel="noopener ugc nofollow" target="_blank"> (Mandar Deshpande) </a></p></figure><p id="4875" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">实际上，我们将大量未标记/未标注文本的语料库(维基百科、Quora)输入语言模型，并期望它学习不同上下文和主题之间内在的单词和句子级别的关系。一旦模型被训练，这实质上意味着模型已经学习了语言的结构，即语言已经在一些潜在向量/嵌入空间中被建模。一旦我们有了预先训练的语言模型，我们就可以利用它来完成任何下游任务，例如文本分类、文本生成和情感分类。</p><p id="7fef" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">长期以来，预训练语言模型的使用一直是自然语言处理中最令人兴奋的消息，许多即将到来的研究都建立在这个概念上。这个领域可以通过以下预训练语言模型的开创性工作来突出:</p><ol class=""><li id="ed50" class="mp mq it jw b jx jy kb kc mj mr ml ms mn mt kr nf mv mw mx bi translated"><a class="ae ks" href="https://arxiv.org/abs/1801.06146" rel="noopener ugc nofollow" target="_blank"><strong class="jw iu">ul mfit</strong></a><strong class="jw iu">:</strong>通用语言模型微调方法</li><li id="9f02" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr nf mv mw mx bi translated"><a class="ae ks" href="https://arxiv.org/abs/1802.05365" rel="noopener ugc nofollow" target="_blank"><strong class="jw iu">ELMo</strong></a><strong class="jw iu">:</strong>来自语言模型的嵌入</li><li id="283f" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr nf mv mw mx bi translated"><strong class="jw iu">变形金刚:</strong> <a class="ae ks" href="https://arxiv.org/abs/1706.03762" rel="noopener ugc nofollow" target="_blank"> <strong class="jw iu">注意力是你所需要的</strong> </a></li><li id="46c8" class="mp mq it jw b jx my kb mz mj na ml nb mn nc kr nf mv mw mx bi translated"><a class="ae ks" href="https://arxiv.org/abs/1810.04805" rel="noopener ugc nofollow" target="_blank"> <strong class="jw iu">伯特</strong> </a> <strong class="jw iu"> : </strong>变压器的双向编码器表示</li></ol><p id="5f1f" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated"><a class="ae ks" rel="noopener" target="_blank" href="/language-modelingii-ulmfit-and-elmo-d66e96ed754f">我们将回顾其中的一些</a>，并在<a class="ae ks" rel="noopener" target="_blank" href="/language-modelingii-ulmfit-and-elmo-d66e96ed754f">的后续帖子</a>中继续讨论专门针对REALM的语言建模。</p><p id="e7fc" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated"><a class="ae ks" rel="noopener" target="_blank" href="/language-modeling-c1cf7b983685">链接到第一部分</a>:语言建模I <a class="ae ks" rel="noopener" target="_blank" href="/language-modelingii-ulmfit-and-elmo-d66e96ed754f"> <br/>链接到第二部分</a>:语言建模II: ELMo和ULMFiT <br/> <a class="ae ks" rel="noopener" target="_blank" href="/the-transformer-a-quick-run-through-ce9b21b4f3ed">链接到第三部分</a>:变压器:快速浏览</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="4690" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">继续学习和成长，直到那时！</p><p id="0ebe" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke mj kg kh ki ml kk kl km mn ko kp kq kr im bi translated">在推特上与我联系:<a class="ae ks" href="https://twitter.com/mandroid_6" rel="noopener ugc nofollow" target="_blank">https://twitter.com/mandroid_6</a></p><blockquote class="jq jr js"><p id="2272" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">以上所有图片都是我在我的iPad上创作的，我有权使用它们</p></blockquote></div></div>    
</body>
</html>