<html>
<head>
<title>Automate your Data Management Discipline with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python自动化您的数据管理规程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automate-your-data-management-discipline-with-python-d7f3e1d78a89?source=collection_archive---------21-----------------------#2020-02-17">https://towardsdatascience.com/automate-your-data-management-discipline-with-python-d7f3e1d78a89?source=collection_archive---------21-----------------------#2020-02-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c4b5" class="pw-subtitle-paragraph jy is it bd b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp dk translated">如何提高企业数据质量<em class="kq">和</em>简化您的工作流程</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/76d603dad7c1b5916385ad3a142dcc15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wi3evUWuxDodLD6CmMFUNw.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://www.pexels.com/@agk42?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">亚历山大·奈特</a>从<a class="ae lh" href="https://www.pexels.com/photo/high-angle-photo-of-robot-2599244/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">派克斯</a>拍摄</p></figure><p id="e5e1" class="pw-post-body-paragraph li lj it lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">任何与数据打交道的人都知道数据质量的重要性。无论你是在excel中进行基本分析，还是用决策树预测销售趋势，糟糕的数据总会让你举步维艰。将责任推给过度工作的数据管理员和贪婪的数据消费者很容易，但最终还是要由数据专业人员来承担这两者之间的联系。那么，<em class="me">您如何</em>提升您企业的数据管理能力并倡导更有效的分析呢？<strong class="lk iu">自动化您的数据质量指标</strong>。</p><p id="abdb" class="pw-post-body-paragraph li lj it lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">许多人以多种方式定义了数据质量指标。我喜欢使用<strong class="lk iu"> 4 V的</strong>和<strong class="lk iu"> 4 C的</strong>来构建关于质量的对话，因为它们易于记忆、营销和可视化:</p><h1 id="858f" class="mf mg it bd mh mi mj mk ml mm mn mo mp kh mq ki mr kk ms kl mt kn mu ko mv mw bi translated">4 C标准</h1><blockquote class="mx my mz"><p id="3b63" class="li lj me lk b ll lm kc ln lo lp kf lq na ls lt lu nb lw lx ly nc ma mb mc md im bi translated"><strong class="lk iu">完整性</strong> —预期的数据有多少？“重要”栏是否已填写？</p><p id="3f14" class="li lj me lk b ll lm kc ln lo lp kf lq na ls lt lu nb lw lx ly nc ma mb mc md im bi translated"><strong class="lk iu">一致性</strong> —数据集之间的数据值是否相同？</p><p id="4e87" class="li lj me lk b ll lm kc ln lo lp kf lq na ls lt lu nb lw lx ly nc ma mb mc md im bi translated">符合性 —数据是否符合规定的格式？</p><p id="3fda" class="li lj me lk b ll lm kc ln lo lp kf lq na ls lt lu nb lw lx ly nc ma mb mc md im bi translated"><strong class="lk iu">好奇心</strong> —利益相关者了解和/或参与了数据管理生命周期吗？</p></blockquote><h1 id="10a2" class="mf mg it bd mh mi mj mk ml mm mn mo mp kh mq ki mr kk ms kl mt kn mu ko mv mw bi translated">4 V的</h1><blockquote class="mx my mz"><p id="cc38" class="li lj me lk b ll lm kc ln lo lp kf lq na ls lt lu nb lw lx ly nc ma mb mc md im bi translated"><strong class="lk iu">卷</strong> —呈现多少信息？</p><p id="512c" class="li lj me lk b ll lm kc ln lo lp kf lq na ls lt lu nb lw lx ly nc ma mb mc md im bi translated"><strong class="lk iu">速度</strong> —输入数据的频率是多少？数据处理和传播的频率如何？</p><p id="4c61" class="li lj me lk b ll lm kc ln lo lp kf lq na ls lt lu nb lw lx ly nc ma mb mc md im bi translated"><strong class="lk iu">多样性</strong> —存在哪些类型的数据？数据是结构化的、非结构化的还是半结构化的？</p><p id="9023" class="li lj me lk b ll lm kc ln lo lp kf lq na ls lt lu nb lw lx ly nc ma mb mc md im bi translated"><strong class="lk iu">真实性</strong> —数据可信吗？有哪些内在的差异？</p></blockquote><p id="dddd" class="pw-post-body-paragraph li lj it lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我用几个Python包来快速测量和社会化这些概念。熊猫有很多内置的方法来调查数据:我用的是<a class="ae lh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.describe.html" rel="noopener ugc nofollow" target="_blank">。</a>描述用条件格式查找模式。为了得到更可靠的报告，我使用了<a class="ae lh" href="https://github.com/pandas-profiling/pandas-profiling" rel="noopener ugc nofollow" target="_blank">熊猫概况</a>，它可以很容易地嵌入到Jupyter笔记本中或者保存到HTML文件中。</p><pre class="ks kt ku kv gt nd ne nf ng aw nh bi"><span id="0226" class="ni mg it ne b gy nj nk l nl nm"><strong class="ne iu">import pandas as pd<br/>import </strong>pandas_profiling</span><span id="8274" class="ni mg it ne b gy nn nk l nl nm">df = read_csv("raw_data.csv")<br/>df.describe()</span><span id="15df" class="ni mg it ne b gy nn nk l nl nm">profile = pandas_profiling.ProfileReport(df)<br/>profile.to_file("profile.html")</span></pre><p id="478a" class="pw-post-body-paragraph li lj it lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Matplotlib和seaborn是绘制数据的很好的库。我最近一直在探索<a class="ae lh" href="https://plot.ly/python/" rel="noopener ugc nofollow" target="_blank">如何创建快速、通用和引人入胜的可视化效果，可以很容易地嵌入到网站中。这里有一个很棒的</a><a class="ae lh" rel="noopener" target="_blank" href="/how-to-create-a-plotly-visualization-and-embed-it-on-websites-517c1a78568b">指南</a>告诉你如何做到这一点。</p></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><h1 id="1320" class="mf mg it bd mh mi nv mk ml mm nw mo mp kh nx ki mr kk ny kl mt kn nz ko mv mw bi translated">企业中的数据规程</h1><p id="4b88" class="pw-post-body-paragraph li lj it lk b ll oa kc ln lo ob kf lq lr oc lt lu lv od lx ly lz oe mb mc md im bi translated">到目前为止，我们已经检查了一些陈腐的理论，以构建一个数据质量社会化的概念框架，并拥有可视化和呈现度量的基本工具。<strong class="lk iu">是时候自动化了！</strong>作为数据专业人员，我们通过揭露脏数据和阐明数据债务来教育和激励企业管理数据以进行有效分析，这一点至关重要。自动化可以通过保持透明度和问责制将最佳实践固化为<em class="me">规程</em>。</p><p id="c6c4" class="pw-post-body-paragraph li lj it lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我最近在做一个项目，主要关注数据摄取，计算按特许经营分组的 <strong class="lk iu">全球产品</strong>的<strong class="lk iu">利润率。这项努力最初是为了更好地理解盈利能力，但很快就失去了控制。像大多数拥有全球足迹的企业一样，我的客户通过收购将运营成本最小化的公司(如分销商)来简化供应链，从而实现战略增长。</strong></p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi of"><img src="../Images/a4cfd420d8f473e148394ebb760ece8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*V0l_n9IgnC021kE2.jpg"/></div></div></figure><p id="e90b" class="pw-post-body-paragraph li lj it lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">IT整合跟不上运营计划；以前计算利润的努力被证明是不成功的，因为不同的ERP系统(总共超过15个)，混乱的术语，高乘务员流动率等。</p><p id="0f48" class="pw-post-body-paragraph li lj it lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">来自世界各地的数据管理员会派个人。csv文件通过电子邮件发送给商业智能团队，在企业数据仓库中与发票销售数据手动合并。预先打包的报告被传递给领导层，附带无数的警告，被确信其他利益相关者在稀释数据的数据管理员破坏。<strong class="lk iu">数据质量如此混乱</strong>以至于基本利润分析的可见性都无法达到，更不用说持续了。精疲力竭的B.I小组需要一些帮助！</p><h2 id="ff07" class="ni mg it bd mh og oh dn ml oi oj dp mp lr ok ol mr lv om on mt lz oo op mv oq bi translated">问题定式化</h2><p id="9df1" class="pw-post-body-paragraph li lj it lk b ll oa kc ln lo ob kf lq lr oc lt lu lv od lx ly lz oe mb mc md im bi translated">数据<strong class="lk iu"> <em class="me">完整性</em> </strong> <em class="me"> </em>和<strong class="lk iu"> <em class="me">符合性</em> </strong> <em class="me"> </em>给利润计算带来了重大问题:不完整的数据会以多种不同的格式从没有结构的管理者那里涌入。<strong class="lk iu"> <em class="me">流速</em> </strong>不一致，不经常从各个群体中流出，在那里名声不佳<strong class="lk iu"> <em class="me">准确性低</em> </strong> <em class="me">。</em></p><p id="2b40" class="pw-post-body-paragraph li lj it lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最终，我将通过对利润计算进行高级分析来解释盈利能力和市场份额，从而为项目做出贡献。但是，如果没有有效的数据管理来计算数据科学管道中的利润率，我有很多机会来自动化一个有效的管道，并告知利益相关者数据质量。</p><h2 id="3c1d" class="ni mg it bd mh og oh dn ml oi oj dp mp lr ok ol mr lv om on mt lz oo op mv oq bi translated">战略</h2><p id="6625" class="pw-post-body-paragraph li lj it lk b ll oa kc ln lo ob kf lq lr oc lt lu lv od lx ly lz oe mb mc md im bi translated">我们与数据管理员、所有者和治理委员会合作，仅确定利润计算所需的相关值，并按功能进行组织:产品到产品映射、成本、计量单位转换和附加属性。模板被复制以适应每个全球特许经销商，因此数据管理员只负责维护他们的资产。我们总共会有50多个文件！</p><p id="0a00" class="pw-post-body-paragraph li lj it lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我构建了一个SharePoint站点来托管文档存储库中的模板，它相当于SharePoint中的目录文件夹。然后，我创建了一个简单的python脚本来遍历“文件夹”以按功能连接文件，添加了额外的列，如“修改日期”、“初始文件名”和一个“完整性”度量，该度量计算相对于总数(按行)填充了多少列。超过50个文件减少到4个，代表每个功能数据资产。为了传播数据质量概念，我使用pandas-profiling按功能构建数据质量报告，并嵌入到SharePoint站点上。</p><p id="b6f3" class="pw-post-body-paragraph li lj it lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">B.I团队厌倦了手动将平面文件上传到数据仓库。我使用了<a class="ae lh" href="https://pypi.org/project/pyodbc/" rel="noopener ugc nofollow" target="_blank"> pyODBC </a>来建立到企业SQL服务器的连接，并且<a class="ae lh" href="https://datatofish.com/insert-sql-server-python/" rel="noopener ugc nofollow" target="_blank">只加载了</a>满足适当“完整性”分数的记录。</p><pre class="ks kt ku kv gt nd ne nf ng aw nh bi"><span id="b5aa" class="ni mg it ne b gy nj nk l nl nm"><strong class="ne iu">import </strong>pyodbc<br/>conn = pyodbc.connect(<strong class="ne iu">'Driver={SQL Server};'<br/>                          'Server=&lt;server&gt;;'<br/>                          'Database=&lt;database&gt;;'<br/>                          'Trusted_Connection=yes;'</strong>)<br/><br/>cursor = conn.cursor()</span><span id="bce1" class="ni mg it ne b gy nn nk l nl nm">sql_query = <strong class="ne iu">"SELECT * FROM table_name"<br/></strong>cursor.execute(sql_query)<br/>cursor.fetchall()</span><span id="c2fd" class="ni mg it ne b gy nn nk l nl nm">sql_df = pd.read_sql(sql_query, conn)</span></pre><p id="faf8" class="pw-post-body-paragraph li lj it lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一旦将记录加载到数据仓库中，我就可以查询记录，并通过交叉引用具有信息模式和列约束的数据来检查<strong class="lk iu"> <em class="me">一致性</em></strong><em class="me"/>；如果列的VARCHAR限制为5，并且值的长度等于10，则不会加载记录。我将这个“错误日志”存储在SharePoint站点上，供数据管理员在需要时参考。</p><p id="6a39" class="pw-post-body-paragraph li lj it lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，我们计算加载到SQL Server中的记录的利润，并将结果存储在plotly图形中，以提供关于特许经营业绩的即时反馈。一个漂亮的动画形象化描述了预期记录、已提供记录、已加载记录、有利润的记录以及一段时间内总收入的百分比<em class="me">。</em>领导可以快速查看哪些数据管理员正在积极地贡献高质量的数据，哪些没有，以及哪里出现了主要的差异。最终结果是一个整合的平台，通过自动化管道实时更新数据质量指标，从而消耗特许经营的利润率。数据专业人员可以专注于将见解转化为行动，而不是“赶猫”。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi or"><img src="../Images/131fcdabcdabc3304a649e913ccec934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/0*XOHOWHciAMDdl0_s"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">来源:<a class="ae lh" href="https://i2.wp.com/obrag.org/wp-content/uploads/2019/06/herding-cats.jpg?fit=574%2C325&amp;ssl=1" rel="noopener ugc nofollow" target="_blank">牧羊猫</a>途经<a class="ae lh" href="https://obrag.org/2019/06/highs-and-lows-from-the-california-democratic-state-convention/herding-cats/" rel="noopener ugc nofollow" target="_blank">obrag.org</a></p></figure><h2 id="c932" class="ni mg it bd mh og oh dn ml oi oj dp mp lr ok ol mr lv om on mt lz oo op mv oq bi translated">结论</h2><p id="57f7" class="pw-post-body-paragraph li lj it lk b ll oa kc ln lo ob kf lq lr oc lt lu lv od lx ly lz oe mb mc md im bi translated">数据管理远不如分析和高级技术那么吸引人，但同样重要。如果管理不当，糟糕的数据将会分散您进行深刻分析的注意力，并困扰您企业中有才华的数据专业人员。虽然过于简单，但本文概述的方法阐明了人员、流程、数据和技术如何相互作用，以产生企业的整体指标。在跳到“有趣的东西”之前，通过关注数据管理生命周期的基础，项目团队可以快速地从吸收数据转向理解数据。</p><p id="a217" class="pw-post-body-paragraph li lj it lk b ll lm kc ln lo lp kf lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">总的来说，我的贡献每年将为企业节省400多个小时的人工工作。此外，我们还促成了一种缺乏数据管理的文化，并在此过程中帮助整合了数据质量战略。开始自动化您的数据管理纪律！</p></div></div>    
</body>
</html>