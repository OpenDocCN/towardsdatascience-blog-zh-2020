<html>
<head>
<title>Using Data Science to Predict the Origin of SARS-CoV-2 Coronavirus from Public Genome Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用数据科学从公共基因组数据预测新型冠状病毒冠状病毒的起源</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-data-science-to-predict-the-origin-of-sars-cov-2-coronavirus-from-public-genome-data-a-3e0a00eaca0f?source=collection_archive---------17-----------------------#2020-02-21">https://towardsdatascience.com/using-data-science-to-predict-the-origin-of-sars-cov-2-coronavirus-from-public-genome-data-a-3e0a00eaca0f?source=collection_archive---------17-----------------------#2020-02-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="09c1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">关于科学家如何发现蝙蝠可能是冠状病毒疾病2019(新冠肺炎)的起源的演练。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9cb1c03d112954ac67b1e7882a0e9451.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*ksYi77MMG84PQOoMBR1QSA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">电子显微镜下显示人体细胞中的新型冠状病毒病毒(黄色)</p></figure><p id="c7e2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">新型冠状病毒冠状病毒来自哪里？专家认为蝙蝠是病毒的源头。他们是如何得出这样的结论的？</p><p id="144e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">传统上，大多数医学科学家将使用传统的生物信息学工具，如BLAST序列比对。然而，在这篇文章中，我将展示我们如何从数据科学的角度分析冠状病毒基因组。具体来说，我们将使用数据科学方法，通过将其基因组序列与感染其他动物(如鸡、牛、鸭和蝙蝠)的其他冠状病毒进行比较，来预测新冠肺炎的起源。基于我们的分析，我们将展示蝙蝠是如何与其他动物相比具有最高的基因组序列相似性的。</p><p id="2361" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">数据集</strong></p><p id="07cf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2019年冠状病毒的基因组序列通过美国国家医学图书馆网站向公众开放(【https://www.ncbi.nlm.nih.gov/】T2实验室/病毒)。事实上，有一个<strong class="kx ir">“更新”</strong>提醒，当你访问网页时，它会立即出现在顶部。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ls"><img src="../Images/3dba78889a4edd23e32084034a1ba9ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1w5iIqOH1Md4eJSLlfoDLA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">新型2019病毒在这里被称为新型严重急性呼吸综合征冠状病毒2基因组</p></figure><p id="e235" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你会注意到有两种主要类型的病毒基因组序列:<strong class="kx ir">核苷酸a </strong>和<strong class="kx ir">蛋白质</strong>。这里，我们将具体分析4种动物的核苷酸序列，即<strong class="kx ir">鸡、蝙蝠、牛和鸭</strong>。我们将它们与从感染者身上收集的2019年冠状病毒核苷酸序列进行比较。你也可以用这里学到的方法来分析蛋白质序列。</p><p id="cf65" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">数据收集</strong></p><p id="a1e5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这项分析的主要目标是确定病毒的可能来源。在实践中，我们需要扫描新冠肺炎冠状病毒的基因组和所有在动物中传播的病毒。然而，由于计算资源有限，我们将只分析从鸡、蝙蝠、牛和鸭传播的冠状病毒。</p><p id="2c43" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，让我们从NCBI病毒网页点击<strong class="kx ir">核苷酸</strong>链接，下载新冠肺炎冠状病毒的核苷酸序列。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/96038a6cbf9d9825a87507c9d7d6b664.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*McYUw9Kp5X92zsq1qDkYMQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">点击核苷酸链接下载新冠肺炎冠状病毒的核苷酸序列</p></figure><p id="9d60" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">该网页是自我探索性的使用。你可以观察到在<strong class="kx ir">精炼结果</strong>过滤器的<strong class="kx ir">病毒</strong>部分下自动选择了“严重急性呼吸综合征冠状病毒2”。此外，还有两种不同的序列类型:<em class="lu">完成</em>或<em class="lu">引用序列</em>。对于本演练，从<strong class="kx ir">核苷酸序列类型</strong>部分选择<strong class="kx ir">完整的</strong>序列类型。接下来，点击页面右上角的<strong class="kx ir">下载</strong>蓝色按钮。基因组序列将作为<strong class="kx ir">下载到您的机器上。fasta </strong>文件格式。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lv"><img src="../Images/2ff0ea4c457fe5a510aa2713f9de9f85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tSU06T_KLbQeYO7_bMM3Jg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">一个可以下载冠状病毒基因组序列的网页。选择完整的核苷酸序列类型，并点击下载蓝色按钮下载基因组序列。</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/6b0d611b4f6272ceabb3668b0e2cdd29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*IrpUB5D8nBo-kmOWb4jlkA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">点击下一步，选择选项<strong class="bd lx">向下所有记录</strong>并选择<strong class="bd lx">默认选项</strong>用于FASTA定义行</p></figure><p id="f75c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一旦你下载了序列数据，让我们在你最喜欢的文本编辑器上打开它，看看基因组序列是什么样子的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/003bab3689c201bb070e75b08cd3207d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*4Ww-njNbKwbBnsDEPxuTvw.png"/></div></figure><blockquote class="lz ma mb"><p id="245b" class="kv kw lu kx b ky kz jr la lb lc ju ld mc lf lg lh md lj lk ll me ln lo lp lq ij bi translated">&gt; MN908947 |严重急性呼吸综合征冠状病毒2型分离株Wuhan-Hu-1|全基因组<br/>attaaaggttatatcttcccaggtaacaaaccaaccaactttcgatcttgtagatct<br/>gttctaaacgaactttaaaatcttaaatctgtgtggctgtcgttcactcggctgcatgcttagtgcact<br/>cacgcagtataattatataatactataatactatattactcgtctattc</p><p id="573c" class="kv kw lu kx b ky kz jr la lb lc ju ld mc lf lg lh md lj lk ll me ln lo lp lq ij bi translated">&gt;</p></blockquote><p id="e68c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可以观察到第一行以<strong class="kx ir"> ' &gt; ' </strong>开头，表示对病毒的单行描述。在撰写本文时，NCBI病毒数据库中有34个新冠肺炎冠状病毒样本。</p><p id="bc8c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，让我们下载四种动物(即鸡、牛、鸭和蝙蝠)的冠状病毒核苷酸序列。</p><p id="7cc7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为此，从<strong class="kx ir">细化结果</strong>的<strong class="kx ir">病毒</strong>部分移除新冠肺炎冠状病毒选项(即严重急性呼吸综合征冠状病毒2)，并改为搜索<strong class="kx ir">冠状病毒</strong>。冠状病毒是所有在动物中传播的冠状病毒的学名。选择此选项将为您提供医学科学家过去收集的所有类型冠状病毒家族的核苷酸序列样本列表。有趣的是，你可以从搜索结果中看到，第一次收集到冠状病毒的基因组样本是在1983年！</p><p id="1644" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可以先从收集鸡的核苷酸基因组序列开始。鸡的学名是<em class="lu"> gallus gallus </em>。进入<strong class="kx ir">提炼结果</strong>的<strong class="kx ir">主机</strong>部分，搜索<strong class="kx ir"> Gallus gallus (chicken) </strong>。选择该选项后，搜索结果列表将会更新，您可以再次点击<strong class="kx ir">下载</strong>按钮下载鸡的完整核苷酸序列。</p><p id="e0e7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对剩下的3种动物重复这些步骤:1)牛(牛)，2)鸭(鸭科)，3)蝙蝠(翼手目)。</p><p id="d033" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">数据转换</strong></p><p id="dd94" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的第一项任务是从序列数据fasta文件中读取新冠肺炎和其他四种动物的基因组序列，并将它们放到熊猫的数据框架中。为了实现这一点，我们将只需要提取序列字符(例如，<em class="lu">attaag</em>)，并忽略所有以“&gt;”开头的单行描述。以下代码通过'&gt;'识别每个核苷酸序列，并提取两个'&gt;'符号之间的序列字符。提取的序列字符随后被顺序附加到列表中。该列表包含每种动物基因组的整个字符串。</p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="003b" class="mk ml iq mg b gy mm mn l mo mp">from nltk.corpus import stopwords  <br/>from sklearn.feature_extraction.text import CountVectorizer<br/>import pandas as pd</span><span id="9df3" class="mk ml iq mg b gy mq mn l mo mp">def process_file(filename,target_val):<br/>    f = open(filename) #'datasets\\corona-nucleo-chicken-complete.fasta')<br/>    lines = ""<br/>    s1 = list()<br/>    step = 0<br/>    term = 0</span><span id="90a8" class="mk ml iq mg b gy mq mn l mo mp">for line in f:<br/>        line = ''.join(line.split())<br/>        if line.startswith("&gt;") and step==0:<br/>            line = line.split('&gt;',1)[0].strip()<br/>            step = step + 1</span><span id="bb7a" class="mk ml iq mg b gy mq mn l mo mp">if line.startswith("&gt;") and step&gt;=1: #and step&gt;=1:<br/>            line = line.split('&gt;',1)[0].strip()<br/>            s1.append(lines)<br/>            lines = ""<br/>            step = step + 1<br/>            term = 0<br/>        lines = lines + line</span></pre><p id="be1c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">序列的数字表示</strong></p><p id="4c1e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我们需要从包含序列字符的字符串中生成特征。由于序列被表示为一系列字母字符，我们需要将序列字符分割成小的记号。例如，只有2个字符的令牌、只有3个字符的令牌、只有4个字符的令牌等等。此外，我们需要将标记转换成数字表示格式，以便我们可以将它们输入到机器学习算法中进行预测。一种常见的方法是应用<strong class="kx ir">单词包</strong>数据表示，计算每个令牌的频率/出现次数。它跟踪两个重要信息:序列字符的词汇表和每个标记出现的次数。</p><p id="2c1e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了同时应用n-grams和词袋，我们可以使用来自<strong class="kx ir"> scikit-learn </strong>机器学习库的<strong class="kx ir">计数矢量器</strong> API。</p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="a5bc" class="mk ml iq mg b gy mm mn l mo mp">count_vect = CountVectorizer(lowercase=False, ngram_range=(2,4),analyzer=’char’)<br/> X1 = count_vect.fit_transform(s1)</span></pre><p id="e371" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本演练中，我们将只设置最小的n元文法来开始从2到4序列的令牌的<strong class="kx ir">。例如，2-gram最多包含2个字符(例如at)、3-gram(例如ACG)和4-gram(例如ACTT)。</strong></p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="b387" class="mk ml iq mg b gy mm mn l mo mp">def generate_ngrams(s1):<br/>    count_vect = CountVectorizer(lowercase=False, ngram_range=(2,4),analyzer='char')<br/>    X1 = count_vect.fit_transform(s1)<br/>    <br/>    lcount = list()<br/>    lcount = []<br/>    for i in s1:<br/>        count = len(i)<br/>        #print(count)<br/>        lcount.append(count)</span><span id="bcc5" class="mk ml iq mg b gy mq mn l mo mp">count_vect_df = pd.DataFrame(X1.todense(), columns=count_vect.get_feature_names())<br/>    <br/>    count_vect_df=count_vect_df.apply(lambda x: x / lcount[x.name] ,axis=1)<br/>        <br/>    return count_vect_df</span></pre><h2 id="7394" class="mk ml iq bd mr ms mt dn mu mv mw dp mx le my mz na li nb nc nd lm ne nf ng nh bi translated">数据标记</h2><p id="210d" class="pw-post-body-paragraph kv kw iq kx b ky ni jr la lb nj ju ld le nk lg lh li nl lk ll lm nm lo lp lq ij bi translated">一旦数据被转换成数字值作为特征，我们将需要为它们添加标签以进行预测。</p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="331b" class="mk ml iq mg b gy mm mn l mo mp">df1 = process_file(‘datasets\\corona-seq-chicken.fasta’,”chicken”)<br/>df2 = process_file(‘datasets\\corona-seq-duck.fasta’,”duck”)<br/>df3 = process_file(‘datasets\\corona-seq-cattle.fasta’,”cattle”)<br/>df4 = process_file(‘datasets\\corona-seq-bat.fasta’,”bat”)</span></pre><p id="a22e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这里，您可以看到每个fasta序列文件都被分配了自己的标签(即鸡、鸭、牛和蝙蝠)。标注在数据转换过程结束时完成。</p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="283e" class="mk ml iq mg b gy mm mn l mo mp">def generate_ngrams(s1):</span><span id="aa38" class="mk ml iq mg b gy mq mn l mo mp">.....<br/>count_vect_df = generate_ngrams(s1) <br/>count_vect_df[‘target’] = target_val<br/>return count_vect_df</span></pre><p id="a2b8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您做的一切都正确，您应该能够以pandas dataframe格式的数值查看所有的特性。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/1ba374c537751d0dd981ead6c1be14dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0RRo4QxeqWEE1OYlMmdUWA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">来自鸡核苷酸序列的样本特征</p></figure><p id="3cb4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">探索性分析</strong></p><p id="5c09" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">有了以数据帧格式表示的所有序列，我们可以探索我们的冠状病毒数据集的%分布。我们可以观察到，我们的数据集的64%是鸡的核苷酸序列，31%来自蝙蝠，剩下的4%和1%分别来自牛和鸭。</p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="7a96" class="mk ml iq mg b gy mm mn l mo mp">import matplotlib.pyplot as plt<br/>plot_size = plt.rcParams[“figure.figsize”]<br/>plot_size[0] = 8<br/>plot_size[1] = 6<br/>plt.rcParams[“figure.figsize”] = plot_size</span><span id="7d81" class="mk ml iq mg b gy mq mn l mo mp">df7[‘target’].value_counts().plot(kind=’pie’, autopct=’%1.0f%%’)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/753c4fd71b4b19010a27bb6f14d8cc13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*7VzOL7nWusOyNNJHpwq6Zw.png"/></div></figure><p id="1191" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">建立预测模型</strong></p><p id="53bc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们现在准备通过将我们标记的核苷酸数据集应用于机器学习算法来建立预测模型。在这种情况下，我们将使用XGBoost梯度增强算法来构建我们的预测模型。</p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="edf1" class="mk ml iq mg b gy mm mn l mo mp">from sklearn.model_selection import train_test_split </span><span id="e312" class="mk ml iq mg b gy mq mn l mo mp">from xgboost import XGBClassifier<br/>from xgboost import plot_importance<br/>import xgboost</span><span id="82aa" class="mk ml iq mg b gy mq mn l mo mp"># create a train/test split<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=7, shuffle=True)</span><span id="361a" class="mk ml iq mg b gy mq mn l mo mp">model = XGBClassifier()<br/>model.fit(X_train, y_train)</span></pre><p id="5a4f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用我们建立的模型，我们可以进一步分析，以确定核苷酸序列的哪些区域对确定哪些序列属于哪些动物具有最大的影响因素。我们可以观察到“CWG”、“AAAY”和“AAC”是区分4种动物基因组的前3个序列区域。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/fb49423861f6e361b6261306ce0c9806.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lv15sHYUbew3Qr_x9mLDQQ.png"/></div></div></figure><p id="5dd6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">新冠肺炎冠状病毒的数据转换和文本表示</strong></p><p id="b6a9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我们需要将新冠肺炎核苷酸序列文件加载到我们的程序中，以便进行预测。</p><p id="60a6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">与动物冠状病毒序列相似，我们需要对新冠肺炎冠状病毒进行数据转换和数值表示。n-gram和词袋算法都需要应用，但附加步骤也是必要的。我们将详细解释这些步骤。</p><p id="22e5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，我们将从Fasta文件中加载新冠肺炎冠状病毒的核苷酸。</p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="cb3d" class="mk ml iq mg b gy mm mn l mo mp">cov = process_file(‘datasets\\corona-covid-19.fasta’,“COVID-19”)<br/>cov</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/e4974895cabf3c0a9974d878064264b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EAZgl1YtSYomgKjC4CH_VQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/3d04c26bbee8ed09b5a966910066bb6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:234/format:webp/1*BOBTNy4rRdAYPmUmsQJ6Sw.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">我们可以看到有34个新冠肺炎样本和409个特征。但是，请注意，特征的数量与训练特征不匹配。</p></figure><p id="46ac" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为我们要做预测(而不是建立模型)，所以我们可以去掉目标标签</p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="e106" class="mk ml iq mg b gy mm mn l mo mp">cov = cov.drop(‘target’, axis=1)</span></pre><p id="de20" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">不幸的是，新冠肺炎产生的特征不会与我们动物的其他冠状病毒100%相同。我们可以观察到新冠肺炎冠状病毒的特征数量是409，这与动物冠状病毒的1786个特征相比要少得多。由于这种不匹配，在数据集与我们的预测模型完全兼容之前，我们需要执行另外两种类型的数据转换。</p><ol class=""><li id="2bac" class="ns nt iq kx b ky kz lb lc le nu li nv lm nw lq nx ny nz oa bi translated">动物冠状病毒中有哪些特征是新冠肺炎冠状病毒所没有的？</li></ol><p id="99db" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这意味着发现动物核苷酸序列中的特征，但它们不存在于新冠肺炎冠状病毒中<strong class="kx ir">。一旦我们发现这样的特征，我们将需要在预测数据集中将其填充为“未知”。</strong></p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="7734" class="mk ml iq mg b gy mm mn l mo mp">mc = X_train.columns.difference(cov.columns)<br/>mc</span></pre><p id="1eb6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以看到，“AAAM”、“AAR”和“AAAY”是我们在冠状病毒中发现的一些特征，但它们不存在于新冠肺炎冠状病毒中。</p><blockquote class="lz ma mb"><p id="e0a5" class="kv kw lu kx b ky kz jr la lb lc ju ld mc lf lg lh md lj lk ll me ln lo lp lq ij bi translated">索引(['AAAM '，' AAAR '，' AAAY '，' AACK '，' AACM '，' AACR '，' AAGK '，' AAGR '，' AAGW '，' AAGY '，… 'YTWC '，' YW '，' YWA '，' YWAT '，' YY '，' YYC '，' YYCT '，' YYT ']，dtype='object '，length=1392)</p></blockquote><p id="f5d8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">需要添加这些功能，以便与我们的训练数据集相匹配。因此，我们可以将值填充为<strong class="kx ir">未知</strong>。由于特性必须是数字形式，我们将使用“-999”数值来表示“未知”。</p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="8124" class="mk ml iq mg b gy mm mn l mo mp">for newcol in mc: cov[newcol]=-999</span></pre><p id="ac56" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> 2。新冠肺炎有哪些其他类型动物冠状病毒从未有过的新特征？</strong></p><p id="0423" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最重要的是，我们还需要找到存在于新冠肺炎但不存在于训练数据集中的特征。一旦我们发现这样的特征，我们将需要移除这些特征，以使它们与我们的训练数据集相匹配。</p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="3137" class="mk ml iq mg b gy mm mn l mo mp">rf = cov.columns.difference(X_train.columns)</span><span id="6d75" class="mk ml iq mg b gy mq mn l mo mp">cov = cov.drop(rf, axis=1)</span></pre><p id="2ed5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以看到，“AWGC”、“CS”、“CST”和“CSTG”是新冠肺炎病毒的一些新的核苷酸区域，这些区域以前在四种动物的冠状病毒中从未存在过。</p><blockquote class="lz ma mb"><p id="a6ac" class="kv kw lu kx b ky kz jr la lb lc ju ld mc lf lg lh md lj lk ll me ln lo lp lq ij bi translated">索引(['AWGC '，' CS '，' CST '，' CSTG '，' GCS '，' GCST '，' GGAW '，' STG '，' STGG '，' TGCS '，' TRCC '，' TTYA '，' TYAC '，' WGCT']，dtype='object ')</p></blockquote><p id="d5ae" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在从预测数据集中移除所有这些特征之后，我们的预测数据集最终与我们的训练数据集相匹配。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/e3fdc4b681229715b08f368b6c8492c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:272/format:webp/1*D0Xxk4dhZE5LrAz5IQqCgQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">现在，我们预测的数据集有1786个特征与训练数据集完全匹配</p></figure><p id="4622" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">关键时刻</strong></p><p id="76cf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们现在可以预测新冠肺炎冠状病毒的可能来源了！下一步是预测我们收集的34份新冠肺炎冠状病毒样本的可能来源。使用XGBoost predict API可以很容易地做到这一点。</p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="5c1b" class="mk ml iq mg b gy mm mn l mo mp">model.predict(cov)</span></pre><blockquote class="lz ma mb"><p id="f00c" class="kv kw lu kx b ky kz jr la lb lc ju ld mc lf lg lh md lj lk ll me ln lo lp lq ij bi translated">数组(['bat '，' bat '，' bat '，' bat '，' bat '，' T12 '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' T14 '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，' bat '，</p></blockquote><p id="a377" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">基于预测值，我们可以看到，我们的模型预测<strong class="kx ir">所有</strong>36个样本为<strong class="kx ir">蝙蝠</strong>。甚至没有一个样本被预测为其他动物。为了进一步分析这一点，我们将使用XGBoost的<strong class="kx ir"> predict_proba </strong> API来获得每个预测的概率。</p><pre class="kg kh ki kj gt mf mg mh mi aw mj bi"><span id="f155" class="mk ml iq mg b gy mm mn l mo mp">print(model.classes_)<br/>similarities = model.predict_proba(cov)<br/>np.round(similarities, 3)</span><span id="6d4c" class="mk ml iq mg b gy mq mn l mo mp">[‘bat’ ‘cattle’ ‘chicken’ ‘duck’]<br/>array([[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041],<br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041], <br/>[0.957, 0.001, 0.001, 0.041]], dtype=float32)</span></pre><p id="6fbd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">基于预测概率，我们可以清楚地看到，bat的预测概率极高，预测值为0.957。这意味着新冠肺炎病毒有95.7%的可能性来自蝙蝠，而只有4.1%的可能性来自鸭子。病毒来自牛或鸡的概率只有0.1%。因此，我们可以有力地得出结论，蝙蝠是2019年新型冠状病毒的<strong class="kx ir">可能起源</strong>。</p><p id="9e37" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">将我们的结果与BLAST进行比较</strong></p><p id="4c28" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">正如本文开头提到的，BLAST(基本局部比对搜索工具)[1]是典型的标准方法，允许科学家比较核苷酸或蛋白质序列的差异。这个节目在这里公开:<a class="ae lr" href="https://blast.ncbi.nlm.nih.gov/" rel="noopener ugc nofollow" target="_blank">https://blast.ncbi.nlm.nih.gov/</a>。从网站上，你可以上传你的新型冠状病毒序列为FASTA格式，该程序将根据其数据库查询你的序列，以找到任何与你的查询匹配的相似序列。与我们的方法不同，BLAST没有对特征应用任何预测模型，而是使用启发式搜索算法。我们的预测方法的一个主要好处是，它可以发现更多的洞察力，并且可以发现标准启发式搜索通常无法发现的隐藏模式。</p><p id="6c47" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">参考</strong></p><p id="0117" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">[1] R. M .凯西(2005年)。<a class="ae lr" href="http://www.b-eye-network.com/view/1730" rel="noopener ugc nofollow" target="_blank">“BLAST序列有助于基因组学和蛋白质组学”</a>。商业智能网络。</p></div></div>    
</body>
</html>