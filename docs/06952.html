<html>
<head>
<title>Facial recognition login system using Deep learning + ReactJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用深度学习+ ReactJS 的面部识别登录系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/facial-recognition-login-system-using-deep-learning-reactjs-61bff981eb74?source=collection_archive---------14-----------------------#2020-05-29">https://towardsdatascience.com/facial-recognition-login-system-using-deep-learning-reactjs-61bff981eb74?source=collection_archive---------14-----------------------#2020-05-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="362e" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">深度学习|反应</h2><div class=""/><div class=""><h2 id="8ac4" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">构建一个面部识别应用程序，可以作为登录阶段集成到任何系统中！</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/1b2e3851ddafba6e57d1b53dbaad8da6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QIjUJZjbV3M-6qGK"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><a class="ae lh" href="https://unsplash.com/@zvandrei?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">安德烈·萨金塞夫</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="0d8f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你一定在应用程序或网站中见过面部识别登录系统。如果您是应用程序开发人员或网站开发人员，您可能希望在您的系统中添加面部识别作为登录阶段。在这里，我们将从头开始构建一个非常容易适应的登录系统，您可以将其集成到任何应用程序或系统中进行登录。</p><p id="d67b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们将分两步建立这个系统。这些步骤包括创建一个包含我们深度学习模型的 Flask 服务器，并创建一个用于登录的 ReactJS 应用程序。ReactJS 应用程序可以在 Flask 服务器的帮助下与我们的深度学习模型进行通信。它可以发送人的图像，并且模型可以返回图像中人的真实身份。一旦我们开始编码，这些都将变得清晰。让我们进入编码部分，创建我们的登录系统。看看下图，消除对我们将要建立的系统的任何疑虑。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi me"><img src="../Images/ebac07b8732604287d791405b13bfee4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9f30Q030SvdPcaClCd2rQA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">系统的简单流程</p></figure><h1 id="18ef" class="mf mg it bd mh mi mj mk ml mm mn mo mp ki mq kj mr kl ms km mt ko mu kp mv mw bi translated">创建深度学习模型</h1><p id="2027" class="pw-post-body-paragraph li lj it lk b ll mx kd ln lo my kg lq lr mz lt lu lv na lx ly lz nb mb mc md im bi translated"><em class="nc">面部识别</em>和<em class="nc">面部验证</em>是两回事。面部识别涉及通过检测面部来识别图像中的人，而面部验证确定给定的两幅图像是否是同一个人。在这里，为了构建我们的登录系统，我们将需要一个模型，该模型可以从图像中检测人脸，并将<em class="nc">面部细节</em>转换为 128 维向量，我们稍后可以使用该向量进行面部识别或验证。</p><p id="1218" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们可以使用由<a class="ae lh" href="https://github.com/nyoki-mtl" rel="noopener ugc nofollow" target="_blank">Hiroki tanai</a>提供的 FaceNet 模型，这样我们就不必从头构建一个模型，也不必担心超参数。这个 FaceNet 模型已经在<a class="ae lh" href="https://www.microsoft.com/en-us/research/project/ms-celeb-1m-challenge-recognizing-one-million-celebrities-real-world/" rel="noopener ugc nofollow" target="_blank"> MS-Celeb-1M 数据集</a>上被训练，并且期望大小为 160x160 像素的彩色图像。模型可以从这里下载:<a class="ae lh" href="https://drive.google.com/open?id=1pwQ3H4aJ8a6yyJHZkTwtjcL4wYWQb7bn" rel="noopener ugc nofollow" target="_blank"> Keras FaceNet 预训练模型</a>。</p><p id="519d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">首先，让我们为包含深度学习模型的 Flask 服务器导入重要模块。</p><pre class="ks kt ku kv gt nd ne nf ng aw nh bi"><span id="ce97" class="ni mg it ne b gy nj nk l nl nm"># Import all the necessary files!<br/>import os<br/>import tensorflow as tf<br/>from tensorflow.keras import layers<br/>from tensorflow.keras import Model<br/>from tensorflow.python.keras.backend import set_session<br/>from flask import Flask, request<br/>from flask_cors import CORS<br/>import cv2<br/>import json<br/>import numpy as np<br/>import base64<br/>from datetime import datetime</span></pre><p id="c79e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们的 API 工作的一些重要步骤。你可以在这里了解更多关于我们为什么在 Flask <a class="ae lh" href="https://github.com/tensorflow/tensorflow/issues/28287#issuecomment-495005162" rel="noopener ugc nofollow" target="_blank">中使用会话的信息。</a></p><pre class="ks kt ku kv gt nd ne nf ng aw nh bi"><span id="5fa7" class="ni mg it ne b gy nj nk l nl nm">graph = tf.get_default_graph()</span><span id="f8aa" class="ni mg it ne b gy nn nk l nl nm">app = Flask(__name__)<br/>CORS(app)</span><span id="57c2" class="ni mg it ne b gy nn nk l nl nm">sess = tf.Session()<br/>set_session(sess)</span></pre><p id="3283" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，我们将加载我们的模型。</p><pre class="ks kt ku kv gt nd ne nf ng aw nh bi"><span id="63ff" class="ni mg it ne b gy nj nk l nl nm">model = tf.keras.models.load_model('facenet_keras.h5')</span></pre><p id="cbe8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们创建一个函数，将给定的图像转换成 128 维向量。这个函数将图像路径和我们的模型作为参数，并输出包含图像信息的向量。</p><pre class="ks kt ku kv gt nd ne nf ng aw nh bi"><span id="75c8" class="ni mg it ne b gy nj nk l nl nm">def img_to_encoding(path, model):<br/>  img1 = cv2.imread(path, 1)<br/>  img = img1[...,::-1]<br/>  dim = (160, 160)<br/>  # resize image<br/>  if(img.shape != (160, 160, 3)):<br/>    img = cv2.resize(img, dim, interpolation = cv2.INTER_AREA)<br/>  x_train = np.array([img])<br/>  embedding = model.predict(x_train)<br/>  return embedding</span></pre><p id="5770" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们创建一个存储人们身份的示例数据库。如果你愿意，你可以预先存储一些身份。您可以将一个人的图像作为参数提供给<em class="nc"> img_to_encoding </em>方法以及模型，您将获得 128 维的向量，您可以将该向量作为一个值存储到数据库字典中，其中人的名字是关键字。</p><pre class="ks kt ku kv gt nd ne nf ng aw nh bi"><span id="5f9f" class="ni mg it ne b gy nj nk l nl nm">database = {}<br/>database["Klaus"] = img_to_encoding("images/klaus.jpg", model)<br/>database["Levi"] = img_to_encoding("images/captain_levi.jpg", model)<br/>database["Eren"] = img_to_encoding("images/eren.jpg", model)<br/>database["Armin"] = img_to_encoding("images/armin.jpg", model)</span></pre><p id="f7dc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们创建一个函数，使用数据库返回图像中人的身份。它将如上所示为数据库中的所有条目和新图像计算距离，并找到最小距离。如果最小距离大于阈值，它将显示此人未注册，否则它将返回具有最小距离的身份。</p><pre class="ks kt ku kv gt nd ne nf ng aw nh bi"><span id="6551" class="ni mg it ne b gy nj nk l nl nm">def who_is_it(image_path, database, model):<br/>    encoding = img_to_encoding(image_path, model)<br/>    min_dist = 1000<br/>    #Looping over the names and encodings in the database.<br/>    for (name, db_enc) in database.items():<br/>        dist = np.linalg.norm(encoding-db_enc)<br/>        if dist &lt; min_dist:<br/>            min_dist = dist<br/>            identity = name<br/>    if min_dist &gt; 5:<br/>        print("Not in the database.")<br/>    else:<br/>        print ("it's " + str(identity) + ", the distance is " + str(min_dist))<br/>    return min_dist, identity</span></pre><p id="42ca" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">最后，我们希望我们的 Flask 服务器完成两项任务:1)如果用户没有注册，就在数据库字典中注册用户 2)从图像中识别用户的身份。我们将为我们的 API 创建路由。首先，我们将创建一个从图像中识别用户并返回身份的路由。此路由将从 React 应用程序接收用户一次捕获的图像的 base64 数据，如果用户已注册，它将返回用户的身份，或者它将发送用户未注册的提示，以便我们的 React 应用程序知道是否登录。<em class="nc">注:如果你想知道使用 TensorFlow 会话背后的原因，请前往</em> <a class="ae lh" href="https://github.com/tensorflow/tensorflow/issues/28287#issuecomment-495005162" rel="noopener ugc nofollow" target="_blank"> <em class="nc">此处</em> </a> <em class="nc">。</em></p><pre class="ks kt ku kv gt nd ne nf ng aw nh bi"><span id="1923" class="ni mg it ne b gy nj nk l nl nm">app.route('/verify', methods=['POST'])<br/>def verify():<br/>    img_data = request.get_json()['image64']<br/>    img_name = str(int(datetime.timestamp(datetime.now())))<br/>    with open('images/'+img_name+'.jpg', "wb") as fh:<br/>        fh.write(base64.b64decode(img_data[22:]))<br/>    path = 'images/'+img_name+'.jpg'<br/>    global sess<br/>    global graph<br/>    with graph.as_default():<br/>        set_session(sess)<br/>        min_dist, identity = who_is_it(path, database, model)<br/>    os.remove(path)<br/>    if min_dist &gt; 5:<br/>        return json.dumps({"identity": 0})<br/>    return json.dumps({"identity": str(identity)})</span></pre><p id="0d91" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">上面我们为我们的目的创建了一个临时图像文件，在检查了用户的身份后，我们删除了它，因为它对我们没有用。我们在时间戳的帮助下命名这个文件。</p><p id="4f5c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">是时候创建我们的第二条路线了，这条路线将把新人注册到数据库中。它将从 React 应用程序接收用户名和用户图像的 base64 数据。它将计算图像的 128 维向量，并将其存储到数据库字典中。如果注册成功，它将发送状态码 200，否则它将发送 500 状态码(内部错误)。</p><pre class="ks kt ku kv gt nd ne nf ng aw nh bi"><span id="43a8" class="ni mg it ne b gy nj nk l nl nm">@app.route('/register', methods=['POST'])<br/>def register():<br/>    try:<br/>        username = request.get_json()['username']<br/>        img_data = request.get_json()['image64']<br/>        with open('images/'+username+'.jpg', "wb") as fh:<br/>            fh.write(base64.b64decode(img_data[22:]))<br/>        path = 'images/'+username+'.jpg'</span><span id="7196" class="ni mg it ne b gy nn nk l nl nm">global sess<br/>        global graph<br/>        with graph.as_default():<br/>            set_session(sess)<br/>            database[username] = img_to_encoding(path, model)    <br/>        return json.dumps({"status": 200})<br/>    except:<br/>        return json.dumps({"status": 500})</span></pre><p id="a4b2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这就是系统的深度学习部分。有可能你仍然不清楚这些将如何适应我们正在建立的系统。让我们来看看创建完我们的 Flask 服务器后系统的流程。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi me"><img src="../Images/bcc5b7c8388d8632a2af72054a36a546.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*icIhP9yuLnRqyozORpC21A.png"/></div></div></figure></div><div class="ab cl no np hx nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="im in io ip iq"><h1 id="2c36" class="mf mg it bd mh mi nv mk ml mm nw mo mp ki nx kj mr kl ny km mt ko nz kp mv mw bi translated">正在创建 ReactJS 应用程序</h1><p id="7cd5" class="pw-post-body-paragraph li lj it lk b ll mx kd ln lo my kg lq lr mz lt lu lv na lx ly lz nb mb mc md im bi translated">应用程序的前端编码不属于本项目的范围。这里不讨论前端的细节，但是您可以从项目链接下载完整的代码。主页将如下所示:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oa"><img src="../Images/93ee68592edbe93543de7aaca24ff890.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SnxxXMqYH4PrB2S8ot-89Q.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">模板由<a class="ae lh" href="https://colorlib.com/wp/template/login-form-v5/" rel="noopener ugc nofollow" target="_blank"> Colorlib </a></p></figure><p id="f5b2" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们将讨论将在我们的应用程序中使用的两个重要的 React 组件— <Verify/>(用于登录)和<Signup/>(用于注册)。</p><p id="769a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">app.js 文件(包含<App/>组件)将包含以下代码。</p><pre class="ks kt ku kv gt nd ne nf ng aw nh bi"><span id="3400" class="ni mg it ne b gy nj nk l nl nm">import React, {Component} from 'react';<br/>import './App.css';<br/>import './css/main.css';<br/>import './css/util.css';<br/>import {Signup} from './signup.js';<br/>import {Verify} from './verify.js';<br/>export class App extends Component {<br/> constructor(props){<br/>  super(props);<br/>  this.state = {<br/>   signup : false,<br/>   verify : false<br/>  };<br/>  this.backhome = this.backhome.bind(this);<br/> }<br/> backhome(){<br/>  this.setState({<br/>   signup: false,<br/>   verify: false<br/>  })<br/> }<br/> signup(){<br/>  this.setState({<br/>   signup: true,<br/>   verify: false<br/>  })<br/> }<br/> verify(){<br/>  this.setState({<br/>   signup: false,<br/>   verify: true<br/>  })<br/> }<br/> render(){<br/>  let home = (<br/>    &lt;div&gt;<br/>     &lt;div className="limiter"&gt;<br/>      &lt;div className="container-login100"&gt;<br/>       &lt;div className="wrap-login100 p-l-110 p-r-110 p-t-62 p-b-33"&gt;<br/>        &lt;form className="login100-form validate-form flex-sb flex-w"&gt;<br/>         &lt;span className="login100-form-title p-b-53"&gt;<br/>          Sign In Or Up :)<br/>         &lt;/span&gt;<br/>         &lt;div className="container-login100-form-btn m-t-17"&gt;<br/>          &lt;button onClick={this.verify.bind(this)} className="login100-form-btn"&gt;<br/>           Sign In <br/>          &lt;/button&gt;<br/>         &lt;/div&gt;<br/>         &lt;div className="container-login100-form-btn m-t-17"&gt;<br/>          &lt;button onClick={this.signup.bind(this)} className="login100-form-btn"&gt;<br/>           Sign Up<br/>          &lt;/button&gt;<br/>         &lt;/div&gt;<br/>         &lt;div className="w-full text-center p-t-55"&gt;<br/>          &lt;span className="txt2"&gt;<br/>          &lt;/span&gt;<br/>          &lt;a href="#" className="txt2 bo1"&gt;<br/>          &lt;/a&gt;<br/>         &lt;/div&gt;<br/>        &lt;/form&gt;<br/>       &lt;/div&gt;<br/>      &lt;/div&gt;<br/>     &lt;/div&gt;<br/>     &lt;div id="dropDownSelect1"&gt;&lt;/div&gt;&lt;/div&gt;)</span><span id="45ee" class="ni mg it ne b gy nn nk l nl nm">return (<br/>      &lt;div&gt;<br/>      {!this.state.signup &amp;&amp; !this.state.verify ? home : ''}<br/>      {this.state.signup ? &lt;Signup backhome={this.backhome}/&gt; : ''}<br/>      {this.state.verify? &lt;Verify backhome={this.backhome}/&gt; : ''}<br/>      &lt;/div&gt;<br/>  )<br/> }<br/>}<br/>export default App;</span></pre><p id="4628" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">一些方法控制下一步呈现哪个组件。例如，<em class="nc"> this.signup </em>方法将更改状态值，以便呈现&lt; Signup/ &gt;组件。类似地，<em class="nc"> this.verify </em>方法将导致应用程序呈现&lt; Verify/ &gt;组件。<em class="nc"> this.backhome </em>方法用于返回主页面。代码的其余部分不言自明。</p><p id="7ca1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">让我们深入研究第一个组件<Verify/>(用于登录)。下面是 Verify.js 文件的代码。</p><pre class="ks kt ku kv gt nd ne nf ng aw nh bi"><span id="2a22" class="ni mg it ne b gy nj nk l nl nm">import React, {Component} from 'react';<br/>import './css/main.css';<br/>import './css/util.css';<br/>import './verify.css';<br/>import Sketch from "react-p5";<br/>const axios = require('axios');<br/>let video;<br/>export class Verify extends Component {<br/>constructor(props){<br/>  super(props);<br/>  this.state = {<br/>   verify : false,<br/>   idenity: ' '<br/>  };<br/> }</span><span id="3a44" class="ni mg it ne b gy nn nk l nl nm">setup(p5='', canvasParentRef='') {<br/>        p5.noCanvas();<br/>        video = p5.createCapture(p5.VIDEO);        <br/>    }</span><span id="f5d8" class="ni mg it ne b gy nn nk l nl nm">//to shut off the camera<br/>stop(){<br/>     const tracks = document.querySelector("video").srcObject.getTracks();<br/>     tracks.forEach(function(track) {<br/>        track.stop();<br/>     });<br/>    }</span><span id="0a04" class="ni mg it ne b gy nn nk l nl nm">logout(){<br/>     this.stop();<br/>     this.props.backhome();<br/>    }</span><span id="0eaa" class="ni mg it ne b gy nn nk l nl nm">setup2(){<br/>     const button = document.getElementById('submit');<br/>        button.addEventListener('click', async event =&gt; {<br/>          video.loadPixels();<br/>          console.log(video.canvas);<br/>          const image64 = video.canvas.toDataURL();<br/>          const data = { image64 };<br/>          const options = {<br/>            method: 'POST',<br/>            headers: {<br/>              'Content-Type': 'application/json'<br/>            },<br/>            body: JSON.stringify(data)<br/>          };<br/>          const response = await axios.post('<a class="ae lh" href="http://localhost:5000/verify'" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/verify'</a>, {'image64':image64});<br/>          console.log(response.data.identity);<br/>          if(response.data.identity){<br/>           this.stop();<br/>         this.setState({<br/>          verify:true,<br/>          idenity: response.data.identity<br/>         })<br/>          } else {<br/>           this.stop();<br/>           alert("Not a registered user!")<br/>           this.props.backhome();<br/>          }<br/>        });<br/>    }</span><span id="f54d" class="ni mg it ne b gy nn nk l nl nm">render(){</span><span id="e5be" class="ni mg it ne b gy nn nk l nl nm">let verify = (&lt;div&gt;<br/>     &lt;div className="limiter"&gt;<br/>      &lt;div className="container-login100"&gt;<br/>       &lt;div className="wrap-login100 p-l-110 p-r-110 p-t-62 p-b-33"&gt;<br/>        <br/>         &lt;span className="login100-form-title p-b-53"&gt;<br/>          Sign In With<br/>         &lt;/span&gt;<br/>         &lt;input/&gt;<br/>         &lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;<br/>         &lt;Sketch setup={this.setup} draw={this.draw}/&gt;<br/>         &lt;div className="container-login100-form-btn m-t-17"&gt;<br/>         &lt;button id="submit" onClick={this.setup2.bind(this)} className="login100-form-btn"&gt;<br/>           Sign In<br/>         &lt;/button&gt;<br/>         &lt;/div&gt;<br/>         &lt;div className="container-login100-form-btn m-t-17"&gt;<br/>         &lt;button onClick={this.logout.bind(this)} className="login100-form-btn"&gt;<br/>           Back!<br/>         &lt;/button&gt;<br/>        &lt;/div&gt;<br/>       &lt;/div&gt;<br/>      &lt;/div&gt;<br/>     &lt;/div&gt;<br/>   &lt;div id="dropDownSelect1"&gt;&lt;/div&gt;&lt;/div&gt;<br/>  )</span><span id="0e2e" class="ni mg it ne b gy nn nk l nl nm">return (&lt;div &gt;<br/>      {this.state.verify? &lt;div&gt;&lt;h1&gt;Welcome, {this.state.idenity}.&lt;/h1&gt;<br/>       &lt;button onClick={this.props.backhome} className="container-login100-form-btn"&gt;Logout!&lt;/button&gt;<br/>       &lt;/div&gt; : verify }<br/>      &lt;/div&gt;)<br/> }<br/>}<br/>export default Verify;</span></pre><p id="cdbe" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">为了捕捉用户的图像，我们将使用<a class="ae lh" href="https://p5js.org/" rel="noopener ugc nofollow" target="_blank"> p5.js </a>库。您可以在这里<a class="ae lh" href="https://p5js.org/" rel="noopener ugc nofollow" target="_blank">了解如何使用它</a>或者您可以直接复制代码并运行它，因为没有必要为了这个特定的应用程序而学习整个库。从我们的服务器得到响应后，我们将关闭相机，并相应地渲染下一个组件。</p><p id="54cc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是<Verify/>组件的第一个输出。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/b570dcd3ce0f841fe14f1b5ca99ded0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*bl_7IlXDEGMZd_KEbwvV0Q.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">未经注册</p></figure><p id="cf38" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们得到了一个错误，因为我们首先需要注册我们的用户名和脸。为此，我们将创建如下所示的<Signup/>组件。</p><pre class="ks kt ku kv gt nd ne nf ng aw nh bi"><span id="9be9" class="ni mg it ne b gy nj nk l nl nm">import React, {Component} from 'react';<br/>import './css/main.css';<br/>import './css/util.css';<br/>import './signup.css';<br/>import Sketch from "react-p5";<br/>const axios = require('axios');<br/>let video;<br/>export class Signup extends Component {<br/> constructor(props){<br/>  super(props);<br/>  this.state = {<br/>   signup : true<br/>  };<br/> }<br/> setup(p5, canvasParentRef) {<br/>        p5.noCanvas();<br/>        video = p5.createCapture(p5.VIDEO);<br/>        const v = document.querySelector("video");<br/>        let st = "position: absolute; top: 255px;"<br/>        v.setAttribute("style", st);<br/>    }</span><span id="348c" class="ni mg it ne b gy nn nk l nl nm">setup2(){<br/>     const button = document.getElementById('submit');<br/>        button.addEventListener('click', async event =&gt; {<br/>          const mood = document.getElementById('mood').value;<br/>          video.loadPixels();<br/>          console.log(video.canvas);<br/>          const image64 = video.canvas.toDataURL();<br/>          const data = { mood, image64 };<br/>          const options = {<br/>            method: 'POST',<br/>            headers: {<br/>              'Content-Type': 'application/json'<br/>            },<br/>            body: JSON.stringify(data)<br/>          };<br/>          console.log(image64);<br/>          const response = await axios.post('<a class="ae lh" href="http://localhost:5000/register'" rel="noopener ugc nofollow" target="_blank">http://localhost:5000/register'</a>, {'image64':image64, 'username':mood});<br/>          if(response.status==200){<br/>      const tracks = document.querySelector("video").srcObject.getTracks();<br/>      tracks.forEach(function(track) {<br/>        track.stop();<br/>      });<br/>     };<br/>           this.props.backhome();<br/>          }<br/>        );<br/>    }<br/>    logout(){<br/>     const tracks = document.querySelector("video").srcObject.getTracks();<br/>     tracks.forEach(function(track) {<br/>        track.stop();<br/>     });<br/>     this.props.backhome();<br/>    }</span><span id="cf8c" class="ni mg it ne b gy nn nk l nl nm">render(){</span><span id="c4b0" class="ni mg it ne b gy nn nk l nl nm">let signup = (<br/>    &lt;div&gt;<br/>     &lt;div className="limiter"&gt;<br/>      &lt;div className="container-login100"&gt;<br/>       &lt;div className="wrap-login100 p-l-110 p-r-110 p-t-62 p-b-33"&gt;<br/>         &lt;span className="login100-form-title p-b-53"&gt;<br/>          Sign Up With<br/>         &lt;/span&gt;<br/>         &lt;div className="p-t-31 p-b-9"&gt;<br/>          &lt;span className="txt1"&gt;<br/>           Username<br/>          &lt;/span&gt;<br/>         &lt;/div&gt;<br/>         &lt;div className="wrap-input100 validate-input" data-validate = "Username is required"&gt;<br/>          &lt;input id="mood" className="input100" type="text" name="username" /&gt;<br/>          &lt;span className="focus-input100"&gt;&lt;/span&gt;<br/>         &lt;/div&gt;<br/>         &lt;input/&gt;<br/>         &lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;<br/>         &lt;br/&gt;&lt;br/&gt;&lt;br/&gt;&lt;br/&gt;</span><span id="c14e" class="ni mg it ne b gy nn nk l nl nm">{this.state.signup?&lt;Sketch id="s" setup={this.setup} draw={this.draw}/&gt;:''}<br/>         <br/>         &lt;div className="container-login100-form-btn m-t-17"&gt;<br/>          &lt;button id="submit" onClick={this.setup2.bind(this)} className="login100-form-btn"&gt;<br/>           Sign Up<br/>          &lt;/button&gt;<br/>         &lt;/div&gt;<br/>         &lt;div className="container-login100-form-btn m-t-17"&gt;<br/>          &lt;button onClick={this.logout.bind(this)} className="login100-form-btn"&gt;<br/>           Back!<br/>          &lt;/button&gt;<br/>         &lt;/div&gt;      <br/>       &lt;/div&gt;<br/>      &lt;/div&gt;<br/>     &lt;/div&gt;<br/>     &lt;div id="dropDownSelect1"&gt;&lt;/div&gt;<br/>    &lt;/div&gt;<br/>  )<br/>     return (&lt;div &gt;<br/>      { signup }<br/>      &lt;/div&gt;<br/>  )<br/> }<br/>}<br/>export default Signup;</span></pre><p id="e84f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">当我们点击主页上的“注册”按钮时，摄像机将启动，用户将输入姓名，然后点击那里的“注册”按钮。该组件负责获取我们的用户名和图像，并将它们发送到我们之前创建的 Flask 服务器的'/register '路径。服务器会将我们的图像编码成 128 维向量，并将其存储在<em class="nc">数据库</em>字典中，以我们的用户名作为关键字，向量作为值。一旦我们的 React 应用程序获得状态 200，它将再次呈现主页，这表明用户已经成功注册。</p><p id="5c89" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">下面是上面代码的输出。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ob"><img src="../Images/2582265ca8076d7c0367d32d980de6e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*MsLxRS_e9_VsMQtyJfnoKQ.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">报名</p></figure><p id="a31b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，注册后，我们应该能够登录没有任何失败。让我们再次尝试登录。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi oc"><img src="../Images/d506cc5a80d9ea405a38f92ce5ceda38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*W6ku4sp4JbOmzSBPdsZ1kQ.gif"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">注册后成功登录</p></figure><p id="81ac" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">在登录阶段之后，可能会出现你想要的任何页面或网站。对于这篇文章，我一直保持简单。成功登录后，应用程序将简单地提示用户一条欢迎消息。</p><p id="4cf6" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">你可以从<a class="ae lh" href="https://github.com/jackfrost1411/facial-recognition-login" rel="noopener ugc nofollow" target="_blank"> GitHub </a>获得上面显示的所有代码。你也可以在<a class="ae lh" href="https://www.linkedin.com/in/dhruvilshah28/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上找到我。</p><h1 id="f5d2" class="mf mg it bd mh mi mj mk ml mm mn mo mp ki mq kj mr kl ms km mt ko mu kp mv mw bi translated">结论</h1><p id="aefe" class="pw-post-body-paragraph li lj it lk b ll mx kd ln lo my kg lq lr mz lt lu lv na lx ly lz nb mb mc md im bi translated">我们看到了如何集成深度学习和 ReactJS 来构建一个简单的面部识别登录应用程序。这个应用程序应该是你想要的任何应用程序或网站的登录阶段。成功登录后，您可以自定义下一阶段。</p><p id="84ee" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们使用深度学习来为我们的应用程序进行人脸识别和验证，但我们必须经历加载模型和管理图像的过程。我们也可以使用预编程库。JavaScript 的节点包管理器(npm)中有一个叫做<em class="nc"> face-api.js </em>的模块，是在 TensorFlow 上面实现的。你可以在这里查看这个库<a class="ae lh" href="https://github.com/justadudewhohacks/face-api.js/" rel="noopener ugc nofollow" target="_blank"/>。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi od"><img src="../Images/b1c812644d297ffdd22cd436d0951481.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JYuDJ3Y05nO2g0f1"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">照片由<a class="ae lh" href="https://unsplash.com/@amandadalbjorn?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿曼达·达尔比约恩</a>在<a class="ae lh" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="7dfb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">总之，面部识别领域发展非常迅速，这篇文章展示了一种非常简单的方法，与像<a class="ae lh" href="http://www.facebook.com" rel="noopener ugc nofollow" target="_blank">脸书</a>这样的公司在行业中使用的方法相比。高度先进的面部识别系统可以通过观察面部来检测人的情绪，或者检测性别，甚至估计人的年龄。</p></div></div>    
</body>
</html>