<html>
<head>
<title>My Experience with Twitter Premium Full Archive API using rTweet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我使用rTweet使用Twitter Premium Full Archive API的体验</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/my-experience-with-twitter-premium-full-archive-api-using-rtweet-f6309f789902?source=collection_archive---------41-----------------------#2020-06-16">https://towardsdatascience.com/my-experience-with-twitter-premium-full-archive-api-using-rtweet-f6309f789902?source=collection_archive---------41-----------------------#2020-06-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3e7c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从高级API访问数据有几个方面不是常识</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/917e9a2c5696d5ab7a2c78626255d91c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h4TLlisFk7XvtREAsS7C7Q.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图片来源:Unsplash</p></figure><p id="6ceb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Twitter的高级存档API允许访问超过30天的推文，可以追溯到2006年。这是一种重要的数据资源，自然也很昂贵。人们应该在开始使用它之前了解某些事情，因为每个请求都是付费的，并且有一个有限的请求配额。</p><p id="e96a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从premium API访问数据的整个过程在Twitter的开发者页面以及R和Python库的文档中都有很好的记录，但是有几个方面没有得到很好的解释或者完全被忽略了。</p><p id="d4da" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我的项目中，我需要访问两到三个月前的推文，所以我购买了Twitter的高级访问权限以获得完整的存档。我使用了“rtweet”包，这是R的库，可以访问Twitter的API。它有很好的文档记录，并且可能是唯一允许访问高级API的R包(但是它有令人痛苦的<a class="ae lr" href="https://github.com/ropensci/rtweet/issues/368" rel="noopener ugc nofollow" target="_blank">缺陷</a>)。</p><p id="baaf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，在你开始走这条路之前，有一些要点你应该知道。</p><ol class=""><li id="ea2f" class="ls lt iq kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated"><strong class="kx ir">成本+税— </strong>此处<a class="ae lr" href="https://developer.twitter.com/en/pricing/search-fullarchive" rel="noopener ugc nofollow" target="_blank">给出的成本表</a>不含税。我每月花224美元购买了250个请求，并额外支付了44美元。也许很多人都知道成本不包括税，但他们应该在某个地方说出来，特别是对于那些可能申请补助金/资金来支付这笔费用的人。</li><li id="2e4e" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated"><strong class="kx ir">最近到以前的推文— </strong>在构建获取推文的查询时，rtweet函数search_full archive允许输入日期范围。该查询如下所示:</li></ol><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="25d6" class="ml mm iq mh b gy mn mo l mp mq">tweet &lt;- search_fullarchive("#beyonce or #katyperry)(lang:en or lang:hi)" , n = 3000, fromDate = "201912120000", toDate = "201912120000", env_name = "curate", safedir = NULL, parse = TRUE, token = token)</span></pre><p id="0f7a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Twitter的premium API获取用户查询中提到的最近时间，然后一直工作到开始时间。这种方法不允许全天发布更大范围的推文，而只能在很短的时间内发布。</p><p id="a1cc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">3.<strong class="kx ir">推文配额—</strong><strong class="kx ir"/>Twitter Premium API允许每个请求访问500条推文。而且，你也可以得到500的倍数的推文。例如，(这是我的理解)在上面的查询中，我在一个请求中请求了3000条推文，这将被计为=3000/500 = 6个请求。人们需要注意这个数学问题，因为订阅允许一定数量的请求和一定数量的推文，在我的情况下，每月250到125，000条推文。如果你用完了请求，你将无法消耗你的tweets配额。在实验和查询构建中，很有可能一些请求会耗尽。</p><p id="2213" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">4.<strong class="kx ir"> rTweet消耗更多请求的速度更快— </strong>我最近发现rTweet软件包有一个缺陷，它消耗的请求比需要的多。我不确定他们是否已经修好了。但是，由于这个错误，我丢失了大量的推文。你可以<a class="ae lr" href="https://github.com/ropensci/rtweet/issues/368" rel="noopener ugc nofollow" target="_blank">在这里阅读关于这个bug的</a>。</p><p id="6f11" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当我开始使用Twitter Premium API时，我没有发现这些要点，因此我付出了惨痛的代价。</p><p id="3b66" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">希望有帮助。</p></div></div>    
</body>
</html>