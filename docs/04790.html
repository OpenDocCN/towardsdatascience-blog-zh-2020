<html>
<head>
<title>Building python from source on Ubuntu 20.04 LTS Focal Fossa</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Ubuntu 20.04 LTS Focal Fossa上从源代码构建python</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-python-from-source-on-ubuntu-20-04-2ed29eec152b?source=collection_archive---------7-----------------------#2020-04-27">https://towardsdatascience.com/building-python-from-source-on-ubuntu-20-04-2ed29eec152b?source=collection_archive---------7-----------------------#2020-04-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6c28" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解如何在基于Linux的操作系统上从源代码构建您最喜欢的语言。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/db5ba1229c811c541cca2e60f4ca15f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RkXX5hb2JFI0-Vi2eX23ag.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在你最喜欢的操作系统上构建你最喜欢的语言</p></figure><blockquote class="ky kz la"><p id="2e34" class="lb lc ld le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">除了面临依赖问题的用户之外，这个博客是为任何想尝试在任何基于Linux的操作系统上从源代码安装python的人准备的</p></blockquote><p id="6e84" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">如果你已经升级了你的操作系统，并且想知道为什么一些在Ubuntu 18.04上很容易安装的库不能在20.04上安装。当我的一个开发环境需要一个库，而我试图使用内置python来安装这个库时，我遇到了同样的问题。不幸的是，我面临着依赖问题。</p><p id="196f" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">这背后的原因是Ubuntu 20.04带有内置的python版本3.8.2，而Ubuntu 18.04带有Python 3.6.x</p><p id="2a6f" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">您可能会尝试安装不同的依赖于Python 3.6的库。别担心，这很容易..2..3</p><p id="8e92" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">让我们从一个特定的python版本开始，我将在这篇博客中使用Python 3.6.9，因为我是在以前的系统上工作的。</p><h1 id="946c" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">重要的事情先来</h1><p id="cabf" class="pw-post-body-paragraph lb lc it le b lf mt ju lh li mu jx lk ly mv ln lo lz mw lr ls ma mx lv lw lx im bi translated">安装构建库所需的基本依赖项</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="714b" class="nd mc it mz b gy ne nf l ng nh">sudo apt-get update<br/>sudo apt-get install -y build-essential checkinstall </span></pre><p id="190d" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">和</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="4fb9" class="nd mc it mz b gy ne nf l ng nh">sudo apt-get install libreadline-gplv2-dev libncursesw5-dev libssl-dev libsqlite3-dev tk-dev libgdbm-dev libc6-dev libbz2-dev</span></pre><h1 id="1193" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">让我们建造</h1><p id="b787" class="pw-post-body-paragraph lb lc it le b lf mt ju lh li mu jx lk ly mv ln lo lz mw lr ls ma mx lv lw lx im bi translated">从改变目录开始，从<a class="ae ni" href="https://www.python.org/downloads/source/" rel="noopener ugc nofollow" target="_blank"> <strong class="le iu"> python </strong> </a> <strong class="le iu">下载源代码。</strong></p><blockquote class="ky kz la"><p id="ceb4" class="lb lc ld le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">我将从<strong class="le iu"> /usr/src </strong>安装它，但是你可以使用你选择的任何位置</p></blockquote><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="578a" class="nd mc it mz b gy ne nf l ng nh">cd /usr/src<br/>sudo wget https://www.python.org/ftp/python/3.6.9/Python-3.6.9.tgz</span></pre><p id="f034" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">正在提取下载的包</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="0e0d" class="nd mc it mz b gy ne nf l ng nh">sudo tar xzf Python-3.6.9.tgz</span></pre><h1 id="a1c6" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">编译源</h1><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="d56e" class="nd mc it mz b gy ne nf l ng nh">cd Python-3.6.9<br/>sudo ./configure --enable-optimizations</span></pre><p id="7246" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">在这里，我们添加了一个新标志<code class="fe nj nk nl mz b">--enable-optimizations</code> <br/>，它设置了默认的make targets来启用Profile Guided Optimization (PGO ),并可用于在某些平台上自动启用链接时间优化(LTO)。</p><p id="0317" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">关于<code class="fe nj nk nl mz b">--enable-optimizations</code>的更多详情，请参见<a class="ae ni" href="https://github.com/docker-library/python/issues/160" rel="noopener ugc nofollow" target="_blank"> <em class="ld">此处的</em> </a></p><h1 id="c0c2" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">我们都在等待的一步</h1><p id="7ce9" class="pw-post-body-paragraph lb lc it le b lf mt ju lh li mu jx lk ly mv ln lo lz mw lr ls ma mx lv lw lx im bi translated">构建python</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="c879" class="nd mc it mz b gy ne nf l ng nh">sudo make altinstall</span></pre><p id="a4c2" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">当我们可以使用<code class="fe nj nk nl mz b">install</code>时，为什么要使用<code class="fe nj nk nl mz b">altinstall</code></p><blockquote class="ky kz la"><p id="af55" class="lb lc ld le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated"><strong class="le iu">原因</strong>:在Unix和Mac系统上，如果你打算安装多个版本的python，你必须注意你的主要Python可执行文件不会被不同版本的安装覆盖<br/>。<code class="fe nj nk nl mz b">altinstall</code>构建特定版本的python而不覆盖你的默认版本，这样你就可以使用多个版本的python。</p><p id="3f99" class="lb lc ld le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">注:根据设备配置，此步骤可能需要一些时间</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/9f33bd63b3f1e7c129293981544c6cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y3V1yCZcGt1fDqVjj-nsKg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">最终输出将是这样的</p></figure><p id="13b0" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">python版本将用后缀<code class="fe nj nk nl mz b">python3.6</code>构建</p><h1 id="6c7d" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">验证安装</h1><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="3462" class="nd mc it mz b gy ne nf l ng nh">python3.6 --version</span></pre><p id="dc60" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">注意我用了<code class="fe nj nk nl mz b">python3.6</code>来代替。如果你尝试运行<code class="fe nj nk nl mz b">python3 --version</code>,它会显示内置的python版本，从Ubuntu 20.04开始是3.8</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/4ee305260fba13d064758b161fcd4789.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hvpBr2pNLIR4dRLY7NQ99w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">注意区别</p></figure><h1 id="b993" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">用一个命令构建一切</h1><p id="42ce" class="pw-post-body-paragraph lb lc it le b lf mt ju lh li mu jx lk ly mv ln lo lz mw lr ls ma mx lv lw lx im bi translated">我为此创建了一个shell脚本，您可以从这里下载脚本文件。</p><div class="no np gp gr nq nr"><a href="https://github.com/novasush/build-python-from-source" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd iu gy z fp nw fr fs nx fu fw is bi translated">novas ush/build-python-from-source</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">用于从源代码构建python的Shell脚本...</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ks nr"/></div></div></a></div><h1 id="a69d" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">升级pip(可选)</h1><p id="ab85" class="pw-post-body-paragraph lb lc it le b lf mt ju lh li mu jx lk ly mv ln lo lz mw lr ls ma mx lv lw lx im bi translated">为pip安装依赖关系</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="42cb" class="nd mc it mz b gy ne nf l ng nh">sudo apt-get install -y python3-distutils python3-testresources</span></pre><p id="bed2" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">下载<a class="ae ni" href="https://bootstrap.pypa.io/get-pip.py" rel="noopener ugc nofollow" target="_blank"> <strong class="le iu"> get-pip.py </strong> </a>并运行</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="c994" class="nd mc it mz b gy ne nf l ng nh">cd ~/<br/>wget <a class="ae ni" href="https://bootstrap.pypa.io/get-pip.py" rel="noopener ugc nofollow" target="_blank">https://bootstrap.pypa.io/get-pip.py</a><br/>sudo python3.6 get-pip.py</span></pre><p id="e214" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">就像<code class="fe nj nk nl mz b">python3.6</code>这样使用前缀<code class="fe nj nk nl mz b">pip3.6</code>进行安装</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/3133808fe8aebfe5591090df31209055.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*di-Fi9lQs77WBjCLsdja1g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">pip3.6安装包</p></figure><h1 id="7b53" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">奖金</h1><p id="b1be" class="pw-post-body-paragraph lb lc it le b lf mt ju lh li mu jx lk ly mv ln lo lz mw lr ls ma mx lv lw lx im bi translated">如果你对每次使用<code class="fe nj nk nl mz b">python3.6</code>或<code class="fe nj nk nl mz b">pip3.6</code>感到厌烦，就使用下面提到的任何一种配置。</p><p id="c0f2" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated"><strong class="le iu">使用别名</strong></p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="1425" class="nd mc it mz b gy ne nf l ng nh">alias py36=python3.6<br/>alias pip36=pip3.6</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/f7f71a14103014bafd3d8269f040421d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5mG_au5De-ltSk3gd5IJSw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">python3.6和pip3.6的别名</p></figure><blockquote class="ky kz la"><p id="40e6" class="lb lc ld le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated"><strong class="le iu">别名</strong>命令的限制:<br/>要么在每次运行python或pip之前运行该命令，要么在<code class="fe nj nk nl mz b">~/.bashrc</code>的底部添加这些行，但它将仅在用户级别运行。<br/>解决这个问题的最佳方案是使用<code class="fe nj nk nl mz b">update-alternatives</code></p></blockquote><p id="d4ce" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated"><strong class="le iu">使用更新替代方案</strong></p><p id="2b6f" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">检查python路径，将其添加到更新替代配置中</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="9b67" class="nd mc it mz b gy ne nf l ng nh">which python3.6</span></pre><blockquote class="ky kz la"><p id="1f23" class="lb lc ld le b lf lg ju lh li lj jx lk ll lm ln lo lp lq lr ls lt lu lv lw lx im bi translated">我的路径是<strong class="le iu">/usr/local/bin/python 3.6</strong></p></blockquote><p id="244a" class="pw-post-body-paragraph lb lc it le b lf lg ju lh li lj jx lk ly lm ln lo lz lq lr ls ma lu lv lw lx im bi translated">添加更新替代配置的路径</p><pre class="kj kk kl km gt my mz na nb aw nc bi"><span id="0610" class="nd mc it mz b gy ne nf l ng nh">sudo update-alternatives --install /usr/bin/python python /usr/local/bin/python3.6 0</span></pre><h1 id="7aec" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">这是所有的乡亲</h1></div></div>    
</body>
</html>