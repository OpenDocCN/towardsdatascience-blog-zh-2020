<html>
<head>
<title>Trading Wind Energy: Wind Energy Forecasting Model based on Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">风能交易:基于深度学习的风能预测模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/trading-wind-energy-wind-energy-forecasting-model-based-on-deep-learning-a44f5906d531?source=collection_archive---------39-----------------------#2020-07-23">https://towardsdatascience.com/trading-wind-energy-wind-energy-forecasting-model-based-on-deep-learning-a44f5906d531?source=collection_archive---------39-----------------------#2020-07-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="cd87" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">基于深度学习为能源交易者开发一个有利可图的风能需求预测模型。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7ce50d1beb28b2ff75555dc6d8296687.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tzYg7HxXQKyggeU-D5p-kg.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">Rabih Shasha 在<a class="ae kv" href="https://unsplash.com/s/photos/wind-turbine?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="57ff" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">动机</h1><p id="672f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">创造稳定的能源供应总是至关重要的，因为我们的现代社会真正依赖于此。这就是为什么化石燃料或核能等可预测的能源仍然是有利的。然而，能源短缺的风险将持续存在，促使我们使用金融来预测和避免未来可能导致停电的能源生产短缺。人们可以考虑利用可再生能源来应对这一挑战。</p><p id="aed6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">迄今为止，在这些可再生能源中，有些依赖于环境，例如风能。顾名思义，能量将由不同速度和方向的风产生。不幸的是，作为产生能量的唯一触发器，风是利用这种替代能源的明显障碍。</p><p id="a72c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">简而言之，我们有三方参与这一能源事务——<strong class="lq ir">电网运营商</strong>、<strong class="lq ir">能源生产商</strong>和<strong class="lq ir">能源交易商</strong>。电网运营商负责为社会提供稳定的电能供应。否则，如果停电，政府会对他们罚款。接下来，供应商将管理能源短缺的风险，风能生产商。通常情况下，能源交易员会帮助供应商提前预测出售给电网的能源产量。换句话说，能源交易商代表客户实现利润最大化。</p><h1 id="53eb" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">目标</strong></h1><p id="daf4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir">我们将扮演能源交易员的角色。</strong>目标是每小时获得一次 T+18 小时能量预测！使用我们的能源预测模型和给定的交易算法，我们将为我们的客户，即风能生产商，实现利润最大化。我们将使用深度学习(神经网络)，特别是差分网络架构，基于时间序列数据集建立预测模型。</p><h1 id="abbf" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">交易算法</h1><p id="6036" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">来源:<a class="ae kv" href="https://ai4impact.org/dld.html" rel="noopener ugc nofollow" target="_blank">深度学习 Datathon 2020 (by ai4impact </a>)</p><ol class=""><li id="7f32" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj mu mv mw mx bi translated">你需要对客户风电场的发电量进行 T+18 小时的预测。这个预测是你交易的核心</li><li id="eac2" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">你的客户每向电网出售一千瓦时可获得 10 欧分。您只能向电网销售您预测的日期</li><li id="8087" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">如果实际发电量超过预测，超出部分将被电网吸收，但您的客户不会因此得到补偿。</li><li id="e9b2" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">如果实际发电量低于预测，您必须从现货市场购买能源(20 欧分/千瓦时)以供应电网。你有 10，000，000 欧分的现金储备，可以从现货市场购买能源。</li></ol><h1 id="6168" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">方法学</h1><ol class=""><li id="c650" class="mp mq iq lq b lr ls lu lv lx nd mb ne mf nf mj mu mv mw mx bi translated">检查随统计数据一起提供的数据。</li><li id="6bc0" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">标准化数据并设置基线风险(基于持久性)。</li><li id="0220" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">在风险函数上很好地拟合训练和测试集。测试损失应该超过基线风险。</li><li id="5cc1" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">提高模型性能(在减少滞后/保持零滞后的同时，不断降低风险)。</li><li id="f209" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj mu mv mw mx bi translated">检查最佳模型的再现性。</li></ol><h1 id="bea6" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">检查数据</h1><h2 id="6aee" class="ng kx iq bd ky nh ni dn lc nj nk dp lg lx nl nm li mb nn no lk mf np nq lm nr bi translated">数据集</h2><p id="cb86" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我们将使用如下两个不同的数据集:</p><p id="36bf" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> 1。风能生产<br/> </strong>来源:<a class="ae kv" href="https://www.rte-france.com/en/eco2mix/eco2mix-telechargement-en" rel="noopener ugc nofollow" target="_blank"/>法国能源传输管理局</p><p id="96db" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">该数据集名为 energy-ile-de-france，包含巴黎周围法兰西岛地区的统一近实时风能产量(单位为 kWh ),该数据已平均化并标准化为 1 小时的时基。数据提供时间为 2017 年 1 月 1 日至今。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/244a431c3a11d37de4ccff7670bf7029.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YzSL7MFOiAIQT6l0ddq3Pg.png"/></div></div></figure><p id="8d3f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">数据不是真的有规律，但还是能看出一些趋势。例如，能量峰值在冬季和季节转换时最为常见。到目前为止，最大的发电量发生在 2019-2020 年冬季，高达 89000 千瓦时。数据的基本统计如下所示。</p><blockquote class="nt nu nv"><p id="de51" class="lo lp nw lq b lr mk jr lt lu ml ju lw nx mm lz ma ny mn md me nz mo mh mi mj ij bi translated">平均值= 17560.44 千瓦时<br/>中值= 10500.0 千瓦时<br/>最大值= 89000.0 千瓦时<br/>最小值= 0.0 千瓦时<br/>极差= 89000.0 <br/>标准差= 19146.63</p></blockquote><p id="f548" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> 2。风力预报<br/> </strong>资料来源:<a class="ae kv" href="http://www.terra-weather.com" rel="noopener ugc nofollow" target="_blank"> Terra Weather </a> <br/> <br/>数据来自两种不同的风力预报模型(A 和 B)，适用于法兰西岛地区的 8 个风电场。因此，有 16 个预报，每个预报有 2 个变量:风速(米/秒)和风向方位(北纬度-即。45 度表示风从东北方向吹来)。天气预报每天每 6 小时更新一次，并以 1 小时为时间基数进行插值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/568df30a6b3493a8a5fedba9e3ca6fbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sfuOI1IeN2wuptxSk07Yeg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/3ed78ab3d8014194e29dbe1b30d948b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mn7ejwzcAKC3TIeOjfkIvg.png"/></div></div></figure><p id="47ef" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">风速图具有与能量图相似的趋势，表明这种预测数据可以作为输入特征用于我们的模型。关于这一点，最强的风出现在冬季，风速高达 12 米/秒。风数据的基本统计如下所示。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/7647e1207b70a647ff001c70aa9ec73e.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/1*4VAuUOdMSgftV2TEsd3w4A.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">风速预测统计</p></figure><p id="089e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">与风速预测相比，风向模式很难解读。但是我们将会看到，即使这样的数据仍然可以给我们的预测模型带来好处。</p><p id="b418" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">最后，我们的原始数据排列如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/be417a98e2c00263f3cbe66bda8d8091.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*Qj-_rA7a1FDxrJkRIwf8xA.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">原始数据集(31027 个示例)</p></figure><h2 id="bef0" class="ng kx iq bd ky nh ni dn lc nj nk dp lg lx nl nm li mb nn no lk mf np nq lm nr bi translated">标准化数据并设定基线风险</h2><p id="fda3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">为了加快训练过程，我们将使用下面的公式对数据进行归一化处理，使平均值和方差都为零。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/6122d84dd4f4b2d48b43aa8772df38ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OBVbD3DkH08Gh71gj7hhXw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者</p></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/47584d3b65c84b6649786b7e3ddeef96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*VhHsy4Dr65T1HicmWjjhZQ.png"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">标准化后的数据集</p></figure><p id="384d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">现在我们有了相同比例的每个特征。注意，我们只归一化能量和风速。风向值将在后面进行特殊处理。</p><p id="e09e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">接下来，我们将获得基于持久性风险的基线。我们使用均方误差(MSE)和平均绝对误差(MAE)提取基线风险。</p><ul class=""><li id="b2fa" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj og mv mw mx bi translated">持久性风险(MSE): 0.4448637</li><li id="de13" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">持久性风险(MAE): 0.6486683</li></ul><h1 id="4d83" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">开始实验！</h1><p id="87b4" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">使用差分网络结构，我们在风险函数(MSE 和 MAE)上很好地拟合训练和测试集。差异网络有助于我们更好地学习超越这个基线。提醒一下，我们的目标是获得提前 18 小时的能源预测。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/5fba1ec617911a822b258e6ffd7244cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DGuHjJ_TIWGLkDf7GDijqA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者设计的差分神经网络结构</p></figure><p id="266f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">以下是我们可以打开的几个超参数:</p><ul class=""><li id="e4e5" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj og mv mw mx bi translated">窗口输入特性(初始、差分、动量和力输入)</li><li id="7a6a" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">统计输入特征(平均值、标准差、最大值、最小值等)</li><li id="b4a3" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">优化器(Adam，SGD)</li><li id="3a07" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">激活功能(Relu，Tanh)</li><li id="e003" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">#隐藏层(2 至 5 层)</li><li id="58fd" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">正规化(辍学，L2)</li><li id="0448" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">NN 大小(8 到 256 个神经元，下一层减少 2/3)</li><li id="af11" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">子网(输入缩放、自动编码器)</li><li id="2794" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">感知器的类型(正常，平方感知器)</li><li id="875e" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">损失(MAE、MSE、动量损失、力损失)</li></ul><p id="9d10" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">事实上，这份名单太多了:)。但是请耐心等待，因为你会知道每个人对我们建立的模型有什么贡献。由于我们已经试验了很多次，我们将只向您展示提高我们目标的设置。</p><p id="093e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><em class="nw">注意:每个实验使用 10000 次最大迭代和提前停止方法。</em></p><h1 id="dbc5" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">实验 1</h1><p id="9eac" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir">输入缩放子网+ 4 个隐藏层(带辍学)</strong></p><p id="8837" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在第一个实验中，我们试图创建一个低 MAE(和 MSE ),它将超过基线。所以，我们希望自己的网络足够深，足够大，又不会过度拟合。因此，我们使用 Adam 来实现更好的学习，并添加一种称为 dropout layer 的正则化方法来防止过拟合。我们使用具有多重配置的 4 层网络，如下所示:</p><ul class=""><li id="b9bf" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj og mv mw mx bi translated">输入缩放子网络</li><li id="a944" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">NN-尺寸:32/64/128/256</li><li id="717c" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">辍学概率:0.05/0.1/0.25</li><li id="e83c" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">优化器:Adam</li><li id="f2b7" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">层数:4</li></ul><p id="0d73" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> <em class="nw">实验一:特征选择</em> </strong></p><p id="eb91" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">开窗是时间序列数据的基本操作。因此，对于输入特征，我们使用由过去 60 小时产生的能量(T-60)组成的窗口。然后，我们将窗口转换为不同动量力输入，提前时间为 18 小时。它将产生<strong class="lq ir"> 72 个特征</strong>。这种调整有助于模型检测运动及其速率，以执行更好的聚类。</p><p id="bc87" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们还添加了过去 60 小时的平均风速预测值和每个风模型在 T+18 小时的风速预测值。这又产生了<strong class="lq ir"> 4 个特征</strong>。因此，我们总共有<strong class="lq ir"> 76 个输入特征</strong>准备好提供给输入缩放子网。由于我们使用相对较大的输入，这个子网在将它提供给主网络之前减少了不需要的功能。</p><p id="bd89" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">总之，这些是我们的输入功能列表:</p><ul class=""><li id="da66" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj og mv mw mx bi translated">差异+动量+T-60h 的力输入过去的能量产生于 18h 的提前期</li><li id="f158" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">预测的过去风速的 T-60h 平均值(模型 A)</li><li id="5584" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">T+18 小时的风速预测(模型 A)</li><li id="acb1" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">这同样适用于模型 B</li></ul><p id="0739" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> <em class="nw">实验一:最佳配置损耗</em> </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/ac7b50ada5d5a2417a90f927633a638e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q-1HLewZC4EKgPVUri0XWg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">测试损失:0.554845(使用 MAE 作为损失函数)</p></figure><p id="b1c7" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> <em class="nw">实验一:评价</em> </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/eee33763516b3688dd9e8fd2780c3a3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n_o-SsPrbJ7FL2teannzcg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">exp 的评估摘要。一</p></figure><ul class=""><li id="04cc" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj og mv mw mx bi translated">最佳测试损失/持续误差<br/>MSE:0.280589/0.4448637<br/>MAE:0.5544554865</li><li id="1ecd" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">最佳 NN 尺寸:128</li><li id="e349" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">最佳辍学概率:0.05</li><li id="a477" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">请注意，我们已经战胜了持久性，实现了零延迟。</li><li id="9f79" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">训练和考输还是有很大差距的。可以考虑使用正则化，增加更多功能。</li></ul><h1 id="e2e6" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">实验二</h1><p id="a84e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir">输入缩放子网+ 4 个隐藏层<br/>(带辍学+ L2 正则化)</strong></p><p id="2992" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">与之前的模型一样，我们在模型中加入了 L2 正则化。我们还运行多配置，同时考虑最佳超参数。</p><ul class=""><li id="d0fe" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj og mv mw mx bi translated">输入缩放子网络</li><li id="8c9c" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">NN-尺寸:64/128/256</li><li id="621f" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">辍学概率:0.05/0.1</li><li id="243e" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">重量衰减:1.0E-4/1.0E-5/1.0E-6</li><li id="a5bb" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">优化器:Adam</li><li id="9f69" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">层数:4</li></ul><p id="e8b6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> <em class="nw">实验二:特征选择</em> </strong></p><p id="1161" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们添加了来自风向预测的新输入特征。虽然添加方向数据作为我们的输入有点无意义，但稳定的风向确实有所帮助。因此，我们不想天真地规范化方向，但我们将使用三角函数来“规范化”它。除了前一个，现在我们总共有<strong class="lq ir"> 84 个</strong>输入功能<strong class="lq ir">个</strong>。</p><p id="a997" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">总之，这些是我们输入功能的补充:</p><ul class=""><li id="db28" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj og mv mw mx bi translated">过去风向预测的 T-18h(平均)sin 函数(模型 A)</li><li id="5e36" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">过去风向预测的 T-18h(平均)cos 函数(模型 A)</li><li id="257c" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">sin 函数中 T+18 小时的风向预报(模式 A)</li><li id="6bfc" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">cos 函数中 T+18 小时的风向预报(模式 A)</li><li id="1953" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">这同样适用于模型 B</li></ul><p id="bb5b" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> <em class="nw">实验二:损失</em> </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/630f6b61e2ca4f710cb05ab0da944791.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hHSSWN-zsgIR51yjoto9Hw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">测试损失:0.549824(使用 MAE 作为损失函数)</p></figure><p id="9301" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> <em class="nw">实验二:评价</em> </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/f41ad38ded22747410812490214f257b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JGq84tS_P_bA_CuC41r0UA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">exp 的评估摘要。2</p></figure><ul class=""><li id="8e66" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj og mv mw mx bi translated">最佳测试损失/持续误差<br/>MSE:0.26769/0.4448637<br/>MAE:0.54924/0.648864866</li><li id="2bc9" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">最佳 NN 尺寸:128</li><li id="1992" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">最佳辍学概率:0.1</li><li id="3f91" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">最佳重量衰减:1.0E-4</li><li id="9fa8" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">请注意，我们已经产生了更好的测试损失，同时保持零滞后(也增加了滞后图的峰值)。</li><li id="ce97" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">我们仍然可以通过向模型添加更多输入要素或图层来提高性能。</li></ul><h1 id="497f" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">实验 3 —最终模型</h1><p id="3614" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir">输入缩放子网+ 4 个隐藏层<br/>(带辍学+ L2 正则化)</strong></p><p id="dfb3" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">通过设置固定的最佳超参数，以下是我们的网络配置:</p><ul class=""><li id="dad5" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj og mv mw mx bi translated">输入缩放子网络</li><li id="a7fa" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">NN-尺寸:128</li><li id="15d7" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">辍学概率:0.1</li><li id="4a77" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">重量衰减:1.0E-4</li><li id="0c10" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">优化器:Adam</li><li id="7d91" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">层数:4</li></ul><p id="a1b0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> <em class="nw">实验三:特征选择</em> </strong></p><p id="f942" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们包括新的统计特征作为新的附加输入，取自能量和风速数据。最后，我们总共有<strong class="lq ir">88</strong>T9】个输入特性。</p><ul class=""><li id="bb0b" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj og mv mw mx bi translated">过去产生能量的 T-60h 的平均值</li><li id="19e9" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">过去产生的能量的 T-60h 的标准偏差</li><li id="1563" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">预测的 T-60h 过去风速的标准偏差(模型 A)</li><li id="9a6c" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">预测的 T-60h 过去风速的标准偏差(模型 B)</li></ul><p id="d2a9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> <em class="nw">实验三:损失</em> </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/f34c7d78dbe3238429e1205071e41462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dl0qU3HVfT1OACT71Z1XmA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">测试损失:0.52758 <strong class="bd ol"> </strong>(使用 MAE 作为损失函数)</p></figure><p id="1141" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> <em class="nw">实验三:评价</em> </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/35d6c477ef748b479eab5d4fa9c51aed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pgO3bRmmg8B-P3lxoqQMNA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">exp 的评估摘要。3</p></figure><ul class=""><li id="60b1" class="mp mq iq lq b lr mk lu ml lx mr mb ms mf mt mj og mv mw mx bi translated">最佳测试损失/持续误差<br/>MSE:0.258521/0.4448637<br/>MAE:<strong class="lq ir">0.52758</strong>/0.6486683</li><li id="ed84" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">以欧分计的净利润<br/>MSE:1.392861351 e9<br/>MAE:<strong class="lq ir">1.447243201 e9</strong></li><li id="0efe" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">我们使用最后一个模型实现了最佳测试损耗，同时没有延迟。因此，我们的利润是所有车型中最高的。</li><li id="9c69" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">我们有更好的实际与训练/测试预测的散点图。虽然我们很适合训练集，但获得实际预测与测试预测的更好散点图仍然是一个挑战。</li></ul><h1 id="9fc9" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">检查再现性</h1><p id="9d9b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">之前，上面的最终模型已经重复训练了 40 次，每次最多迭代 10000 次。请注意，我们使用 MAE 作为损失函数，因为它为客户提供了更高的利润。测试损失的统计如下所示。</p><blockquote class="nt nu nv"><p id="0218" class="lo lp nw lq b lr mk jr lt lu ml ju lw nx mm lz ma ny mn md me nz mo mh mi mj ij bi translated">均值= 0.540747 <br/>中值= 0.540757 <br/>最大值= 0.550977 <br/>最小值= 0.527580 <br/>范围= 0.023397 <br/>(均值-最小值)/标准差= 2.690480</p></blockquote><h2 id="2fb5" class="ng kx iq bd ky nh ni dn lc nj nk dp lg lx nl nm li mb nn no lk mf np nq lm nr bi translated">最终模型预测</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/8bee1f61c9954abb6fb363a6a41d4d7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8nQCJAd-6p14Iexm6esNYQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/074d3d6832f82190f55b3d404181ead3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d0nQRZrERqHYsjAyfd0iZg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/1066a987f501a4a6908493756670fa4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EnMVyuWMzcdH5QsYsDdNIw.png"/></div></div></figure><h1 id="de1f" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">专门用语</h1><ul class=""><li id="0e1f" class="mp mq iq lq b lr ls lu lv lx nd mb ne mf nf mj og mv mw mx bi translated"><strong class="lq ir">增加更多的层</strong>减少了训练误差，但是增加了测试损失，降低了利润，尽管我们已经使用了正则化技术。因此，我们在最终模型中坚持使用 4 层。</li><li id="4c98" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated"><strong class="lq ir">自动编码器子网</strong>有助于减少输入特征的维数。然而，当添加到具有不超过 100 个特征的网络中时，它增加了我们模型的测试损失。</li><li id="3717" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">平方感知器被认为能提供比普通感知器更快更好的学习。然而，在实验过程中，它并没有在降低误差方面提高性能。</li><li id="0110" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">动量和力的损失被认为有助于减少滞后。然而，当我们将损耗加到网络上时，滞后图没有改变(仍然是零滞后),并且它使误差更高，因为网络需要将三个损耗(测试、动量和力损耗)一起最小化。</li></ul><h1 id="9b59" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">摘要</h1><ul class=""><li id="8618" class="mp mq iq lq b lr ls lu lv lx nd mb ne mf nf mj og mv mw mx bi translated">差分网络有效地利用时间序列数据建立预测模型，即使输入较少。</li><li id="a521" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">对于历史数据，DIFF 窗口与动量、力和统计特征相结合，可以帮助模型执行更好的预测。</li><li id="cccc" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">更大更深的网络支持模型很好的记忆(小心过拟合)。</li><li id="3a14" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">丢弃层(小丢弃概率)和 L2 正则化有助于网络处理过拟合问题，从而提高性能。</li><li id="7e9b" class="mp mq iq lq b lr my lu mz lx na mb nb mf nc mj og mv mw mx bi translated">虽然 RMSE(或 MSE)作为时间序列数据中的损失函数也很受欢迎，但当使用 MAE 时，我们的模型会产生更高的利润。MSE 倾向于惩罚异常值，而 MAE 则更倾向于误差的线性。由于模型没有异常值，MAE 被证明最适合我们的模型。</li></ul></div><div class="ab cl op oq hu or" role="separator"><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou"/></div><div class="ij ik il im in"><blockquote class="nt nu nv"><p id="e678" class="lo lp nw lq b lr mk jr lt lu ml ju lw nx mm lz ma ny mn md me nz mo mh mi mj ij bi translated">本文是 ai4impact 组织的深度学习数据大会 2020 期间项目文档的一部分。<br/>团队:Avektive <br/>成员:Diardano Raihan，Mitchell Edbert，M. Taufiq Ismail Hatta</p></blockquote></div></div>    
</body>
</html>