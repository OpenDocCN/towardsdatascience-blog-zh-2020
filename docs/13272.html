<html>
<head>
<title>A Beginner’s Guide to Sentiment Analysis with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 情感分析初学者指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-beginners-guide-to-sentiment-analysis-in-python-95e354ea84f6?source=collection_archive---------0-----------------------#2020-09-12">https://towardsdatascience.com/a-beginners-guide-to-sentiment-analysis-in-python-95e354ea84f6?source=collection_archive---------0-----------------------#2020-09-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f34f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于使用文本数据构建单词云、漂亮的可视化和机器学习模型的端到端指南。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/093d5a8c8548daacaf3ddc442021c119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sNd2NZUR4dMBQhN8l6Padw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由来自 StockSnap 的 Ryan McGuire 拍摄</p></figure><h1 id="f63c" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">什么是情感分析？</h1><p id="7bd9" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">情感分析是一种检测一段文本中潜在情感的技术。</p><p id="fe19" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">它是将文本分类为<em class="mr">阳性、阴性、</em>或<em class="mr">中性的过程。</em>机器学习技术用于评估一段文本，并确定其背后的情感。</p><h1 id="8b0c" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">情感分析为什么有用？</h1><p id="2448" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">情感分析对于企业评估客户反应至关重要。</p><p id="4a90" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls iu"> <em class="mr">想象一下这个</em> </strong>:你的公司刚刚发布了一款新产品，正在多个不同的渠道做广告。</p><p id="ced8" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">为了衡量客户对此产品的反应，可以进行情感分析。</p><p id="7cab" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">客户通常会在社交媒体和客户反馈论坛上谈论产品。可以收集和分析这些数据，以评估客户的总体反应。</p><p id="2005" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">更进一步，还可以检查数据的趋势。例如，某个年龄组和人口统计的客户可能对某个产品的反应比其他产品更积极。</p><p id="dab6" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">根据收集到的信息，公司可以对产品进行不同的定位，或者改变他们的目标受众。</p><h1 id="0b8d" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">分析</h1><p id="c401" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在本文中，我将引导您完成对大量数据执行情感分析的端到端过程。</p><p id="af2b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们将使用 Kaggle 的<strong class="ls iu">亚马逊美食评论数据集</strong>中的<a class="ae ms" href="https://www.kaggle.com/snap/amazon-fine-food-reviews?select=Reviews.csv" rel="noopener ugc nofollow" target="_blank"><em class="mr">Reviews . CSV</em></a><em class="mr"/>文件来执行分析。</p><p id="b714" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我使用 Jupyter 笔记本进行所有的分析和可视化，但是任何 Python IDE 都可以完成这项工作。</p><h2 id="f93f" class="mt kz it bd la mu mv dn le mw mx dp li lz my mz lk md na nb lm mh nc nd lo ne bi translated">步骤 1:读取数据帧</h2><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="2485" class="mt kz it ng b gy nk nl l nm nn">import pandas as pd<br/>df = pd.read_csv('Reviews.csv')<br/>df.head()</span></pre><p id="8fc0" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">检查数据帧的头部:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/b85048ecff0ed2a570affa0ad85be00f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vqjCqz431ooyyyIC.png"/></div></div></figure><p id="ba81" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们可以看到数据帧包含一些产品、用户和评论信息。</p><p id="4500" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们在此分析中最常用的数据是“<em class="mr">摘要”、“T17”、“T18”文本、“T19”和“T20”分数</em></p><p id="546f" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls iu"> <em class="mr">文本</em> </strong> —该变量包含完整的产品评论信息。</p><p id="1952" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls iu"> <em class="mr">总结</em> </strong> —这是整个复习的总结。</p><p id="a2b8" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls iu"> <em class="mr">评分— </em> </strong>客户提供的产品评分。</p><h2 id="270d" class="mt kz it bd la mu mv dn le mw mx dp li lz my mz lk md na nb lm mh nc nd lo ne bi translated">第二步:数据分析</h2><p id="0fd2" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">现在，我们来看看变量“<em class="mr">得分</em>”，看看大多数客户评级是正面还是负面。</p><p id="a264" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">为此，你必须先<a class="ae ms" href="https://plotly.com/python/getting-started/" rel="noopener ugc nofollow" target="_blank">安装<strong class="ls iu"><em class="mr"/></strong>库</a>。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="97ab" class="mt kz it ng b gy nk nl l nm nn"># Imports</span><span id="fdff" class="mt kz it ng b gy np nl l nm nn">import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>color = sns.color_palette()<br/>%matplotlib inline<br/>import plotly.offline as py<br/>py.init_notebook_mode(connected=True)<br/>import plotly.graph_objs as go<br/>import plotly.tools as tls<br/>import plotly.express as px</span><span id="6a1e" class="mt kz it ng b gy np nl l nm nn"># Product Scores</span><span id="1066" class="mt kz it ng b gy np nl l nm nn">fig = px.histogram(df, x="Score")<br/>fig.update_traces(marker_color="turquoise",marker_line_color='rgb(8,48,107)',<br/>                  marker_line_width=1.5)<br/>fig.update_layout(title_text='Product Score')<br/>fig.show()</span></pre><p id="225e" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">结果图如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/a4394b5b16e3931e800f3b5aa8fe8793.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EISMMHdA8aPDC0OMKtahyw.png"/></div></div></figure><p id="f4d4" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">从这里，我们可以看到大多数客户的评价是积极的。这让我相信大多数评论也会是非常正面的，这将在一段时间内进行分析。</p><p id="7445" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">现在，我们可以创建一些<strong class="ls iu"> <em class="mr">词云</em> </strong>来查看评论中最常用的词。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="978c" class="mt kz it ng b gy nk nl l nm nn">import nltk<br/>from nltk.corpus import stopwords</span><span id="ea86" class="mt kz it ng b gy np nl l nm nn"># Create stopword list:<br/>stopwords = set(STOPWORDS)<br/>stopwords.update(["br", "href"])<br/>textt = " ".join(review for review in df.Text)<br/>wordcloud = WordCloud(stopwords=stopwords).generate(textt)</span><span id="74d0" class="mt kz it ng b gy np nl l nm nn">plt.imshow(wordcloud, interpolation='bilinear')<br/>plt.axis("off")<br/>plt.savefig('wordcloud11.png')<br/>plt.show()</span></pre><p id="debf" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">运行上面的代码会生成一个单词云，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/76efc0965acbc2a1830a6686f80bbbf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*C5-yYYSXaySVVJD0rxioGw.png"/></div></figure><p id="5cca" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这里可以观察到的一些流行词有“<em class="mr">品味</em>、“<em class="mr">产品</em>、“<em class="mr">爱情</em>、“<em class="mr">亚马逊</em>”这些词大多是积极的，也表明数据集中的大多数评论表达了积极的情绪。</p><h2 id="c0f7" class="mt kz it bd la mu mv dn le mw mx dp li lz my mz lk md na nb lm mh nc nd lo ne bi translated">第三步:分类推文</h2><p id="b515" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在这一步中，我们将评论分为“正面”和“负面”，因此我们可以将此用作情感分类模型的训练数据。</p><p id="a166" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">正面评价将被归类为+1，负面评价将被归类为-1。</p><p id="ef4a" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们会将所有‘得分’&gt; 3 的评论归类为+1，表示它们是正面的。</p><p id="b273" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">所有带“分数”的评论&lt; 3 will be classified as -1. Reviews with ‘Score’ = 3 will be dropped, because they are neutral. Our model will only classify positive and negative reviews.</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="9a43" class="mt kz it ng b gy nk nl l nm nn"># assign reviews with score &gt; 3 as positive sentiment<br/># score &lt; 3 negative sentiment<br/># remove score = 3</span><span id="d9e3" class="mt kz it ng b gy np nl l nm nn">df = df[df['Score'] != 3]<br/>df['sentiment'] = df['Score'].apply(lambda rating : +1 if rating &gt; 3 else -1)</span></pre><p id="6521" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">Looking at the head of the data frame now, we can see a new column called ‘sentiment:’</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="ab gu cl ns"><img src="../Images/0fafed789b396233f32aa3436c80090d.png" data-original-src="https://miro.medium.com/v2/format:webp/0*ii2yvmIT9-QBfS66.png"/></div></figure><h2 id="54d7" class="mt kz it bd la mu mv dn le mw mx dp li lz my mz lk md na nb lm mh nc nd lo ne bi translated">Step 4: More Data Analysis</h2><p id="0082" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">Now that we have classified tweets into positive and negative, let’s build wordclouds for each!</p><p id="b975" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">First, we will create two data frames — one with all the positive reviews, and another with all the negative reviews.</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="e3b0" class="mt kz it ng b gy nk nl l nm nn"># split df - positive and negative sentiment:</span><span id="bebf" class="mt kz it ng b gy np nl l nm nn">positive = df[df['sentiment'] == 1]<br/>negative = df[df['sentiment'] == -1]</span></pre><p id="648c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls iu"> <em class="mr">文字云—正面情绪</em> </strong></p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="c759" class="mt kz it ng b gy nk nl l nm nn">stopwords = set(STOPWORDS)<br/>stopwords.update(["br", "href","good","great"]) </span><span id="d0c0" class="mt kz it ng b gy np nl l nm nn">## good and great removed because they were included in negative sentiment</span><span id="681d" class="mt kz it ng b gy np nl l nm nn">pos = " ".join(review for review in positive.Summary)<br/>wordcloud2 = WordCloud(stopwords=stopwords).generate(pos)</span><span id="0660" class="mt kz it ng b gy np nl l nm nn">plt.imshow(wordcloud2, interpolation='bilinear')<br/>plt.axis("off")<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/89617afc35bced297a3fa9e3b3accfa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*Pcvglyzl0HQaEdLpBhUNCg.png"/></div></figure><p id="910c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated"><strong class="ls iu"> <em class="mr"> Wordcloud —负面情绪</em> </strong></p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="c82d" class="mt kz it ng b gy nk nl l nm nn">neg = " ".join(review for review in negative.Summary)<br/>wordcloud3 = WordCloud(stopwords=stopwords).generate(neg)</span><span id="cc63" class="mt kz it ng b gy np nl l nm nn">plt.imshow(wordcloud3, interpolation='bilinear')<br/>plt.axis("off")<br/>plt.savefig('wordcloud33.png')<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/d49445cb2dd7d168a2d006fa0fc3a5ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*MOKgciFJxUeiQ89VoBXxiA.png"/></div></figure><p id="3f50" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">如上所见，积极情绪词云中充满了积极的词语，如“<strong class="ls iu"><em class="mr"/></strong><strong class="ls iu"><em class="mr"/></strong><strong class="ls iu"><em class="mr"/></strong><em class="mr">。</em></p><p id="abb0" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">《负面情绪词云》中充斥的大多是负面词，如“<strong class="ls iu"><em class="mr"/></strong>，“以及“<strong class="ls iu"><em class="mr"/></strong><em class="mr">”。</em></p><p id="b558" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">“<strong class="ls iu"><em class="mr"/></strong>”和“<strong class="ls iu"><em class="mr"/></strong>”这两个词最初出现在负面情绪词云中，尽管是正面词。这可能是因为它们被用在了否定的语境中，比如“<strong class="ls iu"> <em class="mr">不好</em> </strong>”正因如此，我把那两个字从单词 cloud 里去掉了。</p><p id="4fdd" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">最后，我们可以看看评论在整个数据集中的分布情况:</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="0bde" class="mt kz it ng b gy nk nl l nm nn">df['sentimentt'] = df['sentiment'].replace({-1 : 'negative'})<br/>df['sentimentt'] = df['sentimentt'].replace({1 : 'positive'})<br/>fig = px.histogram(df, x="sentimentt")<br/>fig.update_traces(marker_color="indianred",marker_line_color='rgb(8,48,107)',<br/>                  marker_line_width=1.5)<br/>fig.update_layout(title_text='Product Sentiment')<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nq"><img src="../Images/04ab02635fc698b10d3be067fe49bb36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9liLDi3vDVEHDfWkO-FUxQ.png"/></div></div></figure><h2 id="a3a0" class="mt kz it bd la mu mv dn le mw mx dp li lz my mz lk md na nb lm mh nc nd lo ne bi translated">步骤 5:构建模型</h2><p id="7421" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">最后，我们可以建立情感分析模型！</p><p id="f01d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这个模型将把评论作为输入。然后它会给出一个关于评论是正面还是负面的预测。</p><p id="5c8b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这是一个分类任务，因此我们将训练一个简单的逻辑回归模型来完成它。</p><p id="557b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">作为参考，再看一下数据框:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/5bdbfaacc3755e64ac03bfef3f5f3656.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2-YLQK3_bDstcTgu.png"/></div></div></figure><p id="b723" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们需要采取几个步骤:</p><ul class=""><li id="c4a9" class="nu nv it ls b lt mm lw mn lz nw md nx mh ny ml nz oa ob oc bi translated"><strong class="ls iu"> <em class="mr">数据清理</em> </strong></li></ul><p id="870b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们将使用汇总数据进行预测。首先，我们需要删除数据中的所有标点符号。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="7152" class="mt kz it ng b gy nk nl l nm nn">def remove_punctuation(text):<br/>    final = "".join(u for u in text if u not in ("?", ".", ";", ":",  "!",'"'))<br/>    return final</span><span id="9faf" class="mt kz it ng b gy np nl l nm nn">df['Text'] = df['Text'].apply(remove_punctuation)<br/>df = df.dropna(subset=['Summary'])<br/>df['Summary'] = df['Summary'].apply(remove_punctuation)</span></pre><ul class=""><li id="3c67" class="nu nv it ls b lt mm lw mn lz nw md nx mh ny ml nz oa ob oc bi translated"><strong class="ls iu"> <em class="mr">分割数据帧</em> </strong></li></ul><p id="df50" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">新的数据框应该只有两列—“<em class="mr">摘要</em>”(评审文本数据)和“<em class="mr">情绪</em>”(目标变量)。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="a71c" class="mt kz it ng b gy nk nl l nm nn">dfNew = df[['Summary','sentiment']]<br/>dfNew.head()</span></pre><p id="d600" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">看一下新数据帧的头部，这是它现在将包含的数据:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/242230bc172e65406dd2741625e6d1c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/0*hoGpWyYHJQ48RDbQ.png"/></div></figure><p id="3d51" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们现在将把数据帧分成训练集和测试集。80%的数据将用于训练，20%将用于测试。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="adaa" class="mt kz it ng b gy nk nl l nm nn"># random split train and test data</span><span id="7c26" class="mt kz it ng b gy np nl l nm nn">index = df.index<br/>df['random_number'] = np.random.randn(len(index))</span><span id="cafe" class="mt kz it ng b gy np nl l nm nn">train = df[df['random_number'] &lt;= 0.8]<br/>test = df[df['random_number'] &gt; 0.8]</span></pre><ul class=""><li id="6a6a" class="nu nv it ls b lt mm lw mn lz nw md nx mh ny ml nz oa ob oc bi translated"><strong class="ls iu"> <em class="mr">创造一袋文字</em> </strong></li></ul><p id="27fd" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">接下来，我们将使用 Scikit-learn 库中的计数矢量器。</p><p id="ca5d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">这将把我们的数据框中的文本转换成一个单词包模型，它将包含一个整数的稀疏矩阵。每个单词出现的次数将被计算并打印出来。</p><p id="e20b" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们需要将文本转换成单词袋模型，因为逻辑回归算法不能理解文本。</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="98e4" class="mt kz it ng b gy nk nl l nm nn"># count vectorizer:</span><span id="4531" class="mt kz it ng b gy np nl l nm nn">from sklearn.feature_extraction.text import CountVectorizer</span><span id="f679" class="mt kz it ng b gy np nl l nm nn">vectorizer = CountVectorizer(token_pattern=r'\b\w+\b')</span><span id="bd13" class="mt kz it ng b gy np nl l nm nn">train_matrix = vectorizer.fit_transform(train['Summary'])<br/>test_matrix = vectorizer.transform(test['Summary'])</span></pre><ul class=""><li id="9f95" class="nu nv it ls b lt mm lw mn lz nw md nx mh ny ml nz oa ob oc bi translated"><strong class="ls iu"> <em class="mr">导入逻辑回归</em> </strong></li></ul><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="acdc" class="mt kz it ng b gy nk nl l nm nn"># Logistic Regression</span><span id="0a1b" class="mt kz it ng b gy np nl l nm nn">from sklearn.linear_model import LogisticRegression<br/>lr = LogisticRegression()</span></pre><ul class=""><li id="d0af" class="nu nv it ls b lt mm lw mn lz nw md nx mh ny ml nz oa ob oc bi translated"><strong class="ls iu"> <em class="mr">分割目标和自变量</em> </strong></li></ul><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="aa90" class="mt kz it ng b gy nk nl l nm nn">X_train = train_matrix<br/>X_test = test_matrix<br/>y_train = train['sentiment']<br/>y_test = test['sentiment']</span></pre><ul class=""><li id="480d" class="nu nv it ls b lt mm lw mn lz nw md nx mh ny ml nz oa ob oc bi translated"><strong class="ls iu"> <em class="mr">拟合模型上的数据</em> </strong></li></ul><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="f5fa" class="mt kz it ng b gy nk nl l nm nn">lr.fit(X_train,y_train)</span></pre><ul class=""><li id="5805" class="nu nv it ls b lt mm lw mn lz nw md nx mh ny ml nz oa ob oc bi translated"><strong class="ls iu"> <em class="mr">做出预测</em> </strong></li></ul><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="2b2a" class="mt kz it ng b gy nk nl l nm nn">predictions = lr.predict(X_test)</span></pre><p id="b31c" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我们成功地建立了一个简单的逻辑回归模型，并对数据进行了训练。我们还使用该模型进行了预测。</p><h2 id="34c2" class="mt kz it bd la mu mv dn le mw mx dp li lz my mz lk md na nb lm mh nc nd lo ne bi translated">第六步:测试</h2><p id="fb4d" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">现在，我们可以测试模型的准确性了！</p><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="d4f4" class="mt kz it ng b gy nk nl l nm nn"># find accuracy, precision, recall:</span><span id="e39a" class="mt kz it ng b gy np nl l nm nn">from sklearn.metrics import confusion_matrix,classification_report<br/>new = np.asarray(y_test)<br/>confusion_matrix(predictions,y_test)</span></pre><p id="ba8d" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">你会得到一个类似这样的混淆矩阵:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/378772c520bcb70dcd14777b16ccd079.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/0*0Ninxy1Lquan8AgR.png"/></div></figure><pre class="kj kk kl km gt nf ng nh ni aw nj bi"><span id="9a84" class="mt kz it ng b gy nk nl l nm nn">print(classification_report(predictions,y_test))</span></pre><p id="7c77" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">分类报告:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/f770d8dfa7bd40996b51d23b7cb085c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/0*NTqlj34tMx8gHAZq.png"/></div></figure><p id="f587" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">该模型在测试数据上的总体准确率约为 93%，考虑到我们没有进行任何特征提取或大量预处理，这已经相当不错了。</p></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><p id="b128" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">还有…就是这样！</p><p id="f564" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">我希望你能从这篇教程中学到一些有用的东西。在这之后，你可以尝试的一个很好的练习是在你的分类任务中包括所有三种情绪——<em class="mr">积极、消极</em>和<em class="mr">中立。</em></p><p id="3b68" class="pw-post-body-paragraph lq lr it ls b lt mm ju lv lw mn jx ly lz mo mb mc md mp mf mg mh mq mj mk ml im bi translated">感谢阅读，记住— <strong class="ls iu"> <em class="mr">永远不要停止学习！</em> </strong></p><blockquote class="on oo op"><p id="629f" class="lq lr mr ls b lt mm ju lv lw mn jx ly oq mo mb mc or mp mf mg os mq mj mk ml im bi translated">世界是一所大学，里面的每个人都是老师。确保你早上醒来时，你去上学。</p></blockquote></div></div>    
</body>
</html>