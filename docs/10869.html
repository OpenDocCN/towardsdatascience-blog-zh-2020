<html>
<head>
<title>Time Series Forecasting with SARIMA in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç”¨ Python ä¸­çš„ SARIMA è¿›è¡Œæ—¶é—´åºåˆ—é¢„æµ‹</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/time-series-forecasting-with-sarima-in-python-cda5b793977b?source=collection_archive---------2-----------------------#2020-07-29">https://towardsdatascience.com/time-series-forecasting-with-sarima-in-python-cda5b793977b?source=collection_archive---------2-----------------------#2020-07-29</a></blockquote><div><div class="fc ij ik il im in"/><div class="io ip iq ir is"><div class=""/><div class=""><h2 id="3aca" class="pw-subtitle-paragraph js iu iv bd b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj dk translated">å…³äºä½¿ç”¨ Python ä½¿ç”¨ SARIMA è¿›è¡Œæ—¶é—´åºåˆ—å»ºæ¨¡çš„å®è·µæ•™ç¨‹</h2></div><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi kk"><img src="../Images/de7403e4110ac6dd439d798a95c94680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9sAh7U-BnKdb1sB6"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">æ‘©æ ¹Â·è±ªæ–¯å°”åœ¨<a class="ae la" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>ä¸Šçš„ç…§ç‰‡</p></figure><p id="dd24" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†<a class="ae la" rel="noopener" target="_blank" href="/how-to-model-time-series-in-python-9983ebbf82cf">ç§»åŠ¨å¹³å‡è¿‡ç¨‹ MA(q) </a>ï¼Œå’Œ<a class="ae la" rel="noopener" target="_blank" href="/time-series-forecasting-with-autoregressive-processes-ba629717401">è‡ªå›å½’è¿‡ç¨‹ AR(p) </a>ã€‚æˆ‘ä»¬å°†å®ƒä»¬ç»“åˆèµ·æ¥ï¼Œå½¢æˆäº† ARMA(pï¼Œq)å’Œ ARIMA(pï¼Œdï¼Œq)æ¨¡å‹æ¥æ¨¡æ‹Ÿæ›´å¤æ‚çš„æ—¶é—´åºåˆ—ã€‚</p><p id="a1ea" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ç°åœ¨ï¼Œç»™æ¨¡å‹æ·»åŠ æœ€åä¸€ä¸ªç»„ä»¶:å­£èŠ‚æ€§ã€‚</p><p id="c664" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">æœ¬æ–‡å°†æ¶µç›–:</p><ul class=""><li id="5f66" class="lx ly iv ld b le lf lh li lk lz lo ma ls mb lw mc md me mf bi translated">å­£èŠ‚æ€§ ARIMA æ¨¡å‹</li><li id="a182" class="lx ly iv ld b le mg lh mh lk mi lo mj ls mk lw mc md me mf bi translated">ä½¿ç”¨çœŸå®æ•°æ®çš„å®Œæ•´å»ºæ¨¡å’Œé¢„æµ‹é¡¹ç›®</li></ul><p id="020c" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">Github ä¸Šæœ‰<a class="ae la" href="https://github.com/marcopeix/time-series-analysis/tree/master/Advanced%20modelling" rel="noopener ugc nofollow" target="_blank">ç¬”è®°æœ¬</a>å’Œ<a class="ae la" href="https://github.com/marcopeix/time-series-analysis/tree/master/data" rel="noopener ugc nofollow" target="_blank">æ•°æ®é›†</a>ã€‚</p><p id="dc06" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">æˆ‘ä»¬å¼€å§‹å§ï¼</p><blockquote class="ml"><p id="7036" class="mm mn iv bd mo mp mq mr ms mt mu lw dk translated"><em class="mv">å…³äº Python ä¸­æ—¶é—´åºåˆ—åˆ†æçš„å®Œæ•´è¯¾ç¨‹ï¼Œæ¶µç›–ç»Ÿè®¡å’Œæ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œè¯·æŸ¥çœ‹æˆ‘æ–°å‘å¸ƒçš„</em> <a class="ae la" href="https://www.datasciencewithmarco.com/offers/tdU2mtVK" rel="noopener ugc nofollow" target="_blank"> <em class="mv">è¯¾ç¨‹</em> </a> <em class="mv">ï¼</em></p></blockquote><h1 id="c65e" class="mw mx iv bd my mz na nb nc nd ne nf ng kb nh kc ni ke nj kf nk kh nl ki nm nn bi translated">è¨é‡Œç›æ¨¡å‹</h1><p id="fddb" class="pw-post-body-paragraph lb lc iv ld b le no jw lg lh np jz lj lk nq lm ln lo nr lq lr ls ns lu lv lw io bi translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è¿˜æ²¡æœ‰è€ƒè™‘æ—¶é—´åºåˆ—ä¸­å­£èŠ‚æ€§çš„å½±å“ã€‚ç„¶è€Œï¼Œè¿™ç§è¡Œä¸ºè‚¯å®šå­˜åœ¨äºè®¸å¤šæƒ…å†µä¸‹ï¼Œå¦‚ç¤¼å“åº—é”€å”®æˆ–é£æœºä¹˜å®¢æ€»æ•°ã€‚</p><p id="da5c" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">å­£èŠ‚æ€§ ARIMA æ¨¡å‹æˆ–è¨é‡Œç›çš„å†™æ³•å¦‚ä¸‹:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi nt"><img src="../Images/325c889d30d23024fcf31b95580d52fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yxe5Sf5JSAROq-UVgMLtmA.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">è¨é‡Œç›ç¬¦å·</p></figure><p id="7b3d" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¸ºæ—¶é—´åºåˆ—çš„å­£èŠ‚æ€§éƒ¨åˆ†æ·»åŠ äº† Pã€D å’Œ Qã€‚å®ƒä»¬ä¸éå­£èŠ‚æ€§æˆåˆ†çš„æœ¯è¯­ç›¸åŒï¼Œå› ä¸ºå®ƒä»¬æ¶‰åŠå­£èŠ‚æ€§å‘¨æœŸçš„åç§»ã€‚</p><p id="8769" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">åœ¨ä¸Šé¢çš„å…¬å¼ä¸­ï¼Œ<em class="nu"> m </em>æ˜¯æ¯å¹´æˆ–ä¸€æ®µæ—¶é—´å†…çš„è§‚å¯Ÿæ¬¡æ•°ã€‚å¦‚æœæˆ‘ä»¬åˆ†æå­£åº¦æ•°æ®ï¼Œ<em class="nu"> m </em>ç­‰äº 4ã€‚</p><h2 id="f142" class="nv mx iv bd my nw nx dn nc ny nz dp ng lk oa ob ni lo oc od nk ls oe of nm og bi translated">ACF å’Œ PACF å›¾</h2><p id="b5ba" class="pw-post-body-paragraph lb lc iv ld b le no jw lg lh np jz lj lk nq lm ln lo nr lq lr ls ns lu lv lw io bi translated">AR å’Œ MA æ¨¡å‹çš„å­£èŠ‚æ€§éƒ¨åˆ†å¯ä»¥ä» PACF å’Œ ACF å›¾ä¸­æ¨æ–­å‡ºæ¥ã€‚</p><p id="9002" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">åœ¨ SARIMA æ¨¡å‹ä¸­ï¼Œåªæœ‰ä¸€ä¸ªé˜¶ä¸º 1ã€å‘¨æœŸä¸º 12 çš„å­£èŠ‚æ€§ç§»åŠ¨å¹³å‡è¿‡ç¨‹ï¼Œè¡¨ç¤ºä¸º:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/215fda5c908799add726f484c0215396.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*nnZS0-GhBBxuWNPYDa4SuQ.png"/></div></figure><ul class=""><li id="e758" class="lx ly iv ld b le lf lh li lk lz lo ma ls mb lw mc md me mf bi translated">åœ¨æ»å 12 æ—¶è§‚å¯Ÿåˆ°å³°å€¼</li><li id="bc58" class="lx ly iv ld b le mg lh mh lk mi lo mj ls mk lw mc md me mf bi translated">PACF å­£èŠ‚æ»åçš„æŒ‡æ•°è¡°å‡(æ»å 12ï¼Œ24ï¼Œ36ï¼Œâ€¦)</li></ul><p id="f101" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ç±»ä¼¼åœ°ï¼Œå¯¹äºä»…å…·æœ‰é˜¶ä¸º 1ã€å‘¨æœŸä¸º 12 çš„å­£èŠ‚æ€§è‡ªå›å½’è¿‡ç¨‹çš„æ¨¡å‹:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/65b1972b7dca01e131e1b1c5fc343698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*gE4up-SWOKh0jE3KblnNXw.png"/></div></figure><ul class=""><li id="0c9a" class="lx ly iv ld b le lf lh li lk lz lo ma ls mb lw mc md me mf bi translated">ACF å­£èŠ‚æ€§æ»åçš„æŒ‡æ•°è¡°å‡(æ»å 12ï¼Œ24ï¼Œ36ï¼Œâ€¦)</li><li id="5d7b" class="lx ly iv ld b le mg lh mh lk mi lo mj ls mk lw mc md me mf bi translated">åœ¨ PACF ä¸­ï¼Œåœ¨æ»å 12 æ—¶è§‚å¯Ÿåˆ°å³°å€¼</li></ul><h2 id="9df9" class="nv mx iv bd my nw nx dn nc ny nz dp ng lk oa ob ni lo oc od nk ls oe of nm og bi translated">ç³»ç»Ÿæ¨¡å‹åŒ–</h2><p id="4d16" class="pw-post-body-paragraph lb lc iv ld b le no jw lg lh np jz lj lk nq lm ln lo nr lq lr ls ns lu lv lw io bi translated">å»ºæ¨¡è¿‡ç¨‹ä¸éå­£èŠ‚æ€§ ARIMA æ¨¡å‹ç›¸åŒã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦è€ƒè™‘é¢å¤–çš„å‚æ•°ã€‚</p><p id="86b9" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ä½¿æ—¶é—´åºåˆ—å¹³ç¨³å’Œæ ¹æ®æœ€ä½ AIC é€‰æ‹©æ¨¡å‹æ‰€éœ€çš„æ­¥éª¤ä»ç•™åœ¨å»ºæ¨¡è¿‡ç¨‹ä¸­ã€‚</p><p id="96fd" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">è®©æˆ‘ä»¬ç”¨çœŸå®ä¸–ç•Œçš„æ•°æ®é›†æ¥æ¶µç›–ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ã€‚</p><h1 id="04c7" class="mw mx iv bd my mz na nb nc nd ne nf ng kb oj kc ni ke ok kf nk kh ol ki nm nn bi translated">é¡¹ç›®â€”ä¸ºå¼ºç”Ÿå…¬å¸çš„å­£åº¦æ¯è‚¡æ”¶ç›Šå»ºæ¨¡</h1><p id="dd12" class="pw-post-body-paragraph lb lc iv ld b le no jw lg lh np jz lj lk nq lm ln lo nr lq lr ls ns lu lv lw io bi translated">æˆ‘ä»¬å°†é‡æ¸©å¼ºç”Ÿå…¬å¸çš„å­£åº¦æ¯è‚¡æ”¶ç›Š(EPS)æ•°æ®é›†ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸æœ‰è¶£çš„æ•°æ®é›†ï¼Œå› ä¸ºæœ‰ä¸€ä¸ªç§»åŠ¨å¹³å‡è¿‡ç¨‹åœ¨èµ·ä½œç”¨ï¼Œè€Œä¸”æˆ‘ä»¬æœ‰å­£èŠ‚æ€§ï¼Œè¿™æ˜¯ç”¨ SARIMA è¿›è¡Œä¸€äº›ç»ƒä¹ çš„å®Œç¾æ—¶æœºã€‚</p><p id="acc9" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">å’Œå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¼å…¥æ‰€æœ‰å¿…è¦çš„åº“æ¥è¿›è¡Œåˆ†æ</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="466e" class="nv mx iv on b gy or os l ot ou">from statsmodels.graphics.tsaplots import plot_pacf<br/>from statsmodels.graphics.tsaplots import plot_acf<br/>from statsmodels.tsa.statespace.sarimax import SARIMAX<br/>from statsmodels.tsa.holtwinters import ExponentialSmoothing<br/>from statsmodels.tsa.stattools import adfuller<br/>import matplotlib.pyplot as plt<br/>from tqdm import tqdm_notebook<br/>import numpy as np<br/>import pandas as pd</span><span id="38a1" class="nv mx iv on b gy ov os l ot ou">from itertools import product</span><span id="41b6" class="nv mx iv on b gy ov os l ot ou">import warnings<br/>warnings.filterwarnings('ignore')</span><span id="2226" class="nv mx iv on b gy ov os l ot ou">%matplotlib inline</span></pre><p id="8cdd" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬è¯»å…¥æ•°æ®å¸§ä¸­çš„æ•°æ®:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="8f29" class="nv mx iv on b gy or os l ot ou">data = pd.read_csv('jj.csv')</span></pre><p id="fabb" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾ç¤ºä¸€ä¸ªæ—¶é—´åºåˆ—å›¾:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="d703" class="nv mx iv on b gy or os l ot ou">plt.figure(figsize=[15, 7.5]); # Set dimensions for figure<br/>plt.plot(data['date'], data['data'])<br/>plt.title('Quarterly EPS for Johnson &amp; Johnson')<br/>plt.ylabel('EPS per share ($)')<br/>plt.xlabel('Date')<br/>plt.xticks(rotation=90)<br/>plt.grid(True)<br/>plt.show()</span></pre><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi ow"><img src="../Images/2b27eea10e8957d429fc014f50bcd6df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S_rSv_YS-yCZJJPGlDUVgw.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">å¼ºç”Ÿå…¬å¸å­£åº¦æ¯è‚¡æ”¶ç›Š</p></figure><p id="90c5" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">å¾ˆæ˜æ˜¾ï¼Œæ—¶é—´åºåˆ—ä¸æ˜¯é™æ€çš„ï¼Œå› ä¸ºå®ƒçš„å¹³å‡å€¼åœ¨æ•´ä¸ªæ—¶é—´å†…ä¸æ˜¯æ’å®šçš„ï¼Œæˆ‘ä»¬çœ‹åˆ°æ•°æ®ä¸­çš„æ–¹å·®åœ¨å¢åŠ ï¼Œè¿™æ˜¯<strong class="ld iw">å¼‚æ–¹å·®</strong>çš„æ ‡å¿—ã€‚</p><p id="8cbf" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ä¸ºäº†ç¡®ä¿è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬ç»˜åˆ¶ PACF å’Œ ACF:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="321c" class="nv mx iv on b gy or os l ot ou">plot_pacf(data['data']);<br/>plot_acf(data['data']);</span></pre><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/fa346f2cdb66192ad2f1db8c7c6ca20c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*tDM1ADDqa5kA09RY3DQjXA.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">PACF å’Œ ACF</p></figure><p id="fe85" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">åŒæ ·ï¼Œä¸èƒ½ä»è¿™äº›å›¾ä¸­æ¨æ–­å‡ºä»»ä½•ä¿¡æ¯ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ‰©å±•çš„ Dickey-Fuller æµ‹è¯•è¿›ä¸€æ­¥æµ‹è¯•å¹³ç¨³æ€§:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="6801" class="nv mx iv on b gy or os l ot ou">ad_fuller_result = adfuller(data['data'])<br/>print(f'ADF Statistic: {ad_fuller_result[0]}')<br/>print(f'p-value: {ad_fuller_result[1]}')</span></pre><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/c84a2ecaf991d7a5c3578dfda5e10502.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*sMrifHyFDjHnoJXik9clDw.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">ADF æµ‹è¯•ç»“æœ</p></figure><p id="bcec" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ç”±äº p å€¼å¾ˆå¤§ï¼Œæˆ‘ä»¬ä¸èƒ½æ‹’ç»é›¶å‡è®¾ï¼Œå¿…é¡»å‡è®¾æ—¶é—´åºåˆ—æ˜¯éå¹³ç¨³çš„ã€‚</p><p id="14c9" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬å–å¯¹æ•°å·®ï¼ŒåŠªåŠ›ä½¿å®ƒä¿æŒç¨³å®š:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="0ea7" class="nv mx iv on b gy or os l ot ou">data['data'] = np.log(data['data'])<br/>data['data'] = data['data'].diff()<br/>data = data.drop(data.index[0])</span></pre><p id="3b2f" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ç»˜åˆ¶æ–°æ•°æ®åº”ç»™å‡º:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="0c21" class="nv mx iv on b gy or os l ot ou">plt.figure(figsize=[15, 7.5]); # Set dimensions for figure<br/>plt.plot(data['data'])<br/>plt.title("Log Difference of Quarterly EPS for Johnson &amp; Johnson")<br/>plt.show()</span></pre><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi oz"><img src="../Images/1dd916277a8c73ea8a47f4b68ad91821.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iNbAIE7iHqlkmXEi5sv0Zw.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">å¼ºç”Ÿå…¬å¸å­£åº¦æ¯è‚¡æ”¶ç›Šè®°å½•è¡¨</p></figure><p id="2d78" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">å‰å®³ï¼ç°åœ¨ï¼Œæˆ‘ä»¬ä»ç„¶åœ¨ä¸Šé¢çš„å›¾ä¸­çœ‹åˆ°å­£èŠ‚æ€§ã€‚å› ä¸ºæˆ‘ä»¬å¤„ç†çš„æ˜¯å­£åº¦æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„å‘¨æœŸæ˜¯ 4ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†åœ¨ 4:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="3530" class="nv mx iv on b gy or os l ot ou"># Seasonal differencing</span><span id="04fe" class="nv mx iv on b gy ov os l ot ou">data['data'] = data['data'].diff(4)<br/>data = data.drop([1, 2, 3, 4], axis=0).reset_index(drop=True)</span></pre><p id="b538" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ç»˜åˆ¶æ–°æ•°æ®:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="d881" class="nv mx iv on b gy or os l ot ou">plt.figure(figsize=[15, 7.5]); # Set dimensions for figure<br/>plt.plot(data['data'])<br/>plt.title("Log Difference of Quarterly EPS for Johnson &amp; Johnson")<br/>plt.show()</span></pre><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi pa"><img src="../Images/fa1f7ecbe1250ef4e67b7bf1dbc8f4a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uje-MWCpzCUXskrBtlJpgQ.png"/></div></div></figure><p id="d074" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">å®Œç¾ï¼è¯·è®°ä½ï¼Œè™½ç„¶æˆ‘ä»¬åœ¨ 4 ä¸ªæœˆçš„æ—¶é—´å†…å–äº†å·®å€¼ï¼Œä½†å­£èŠ‚å·®å€¼(D)çš„é¡ºåºæ˜¯ 1ï¼Œå› ä¸ºæˆ‘ä»¬åªå–äº†ä¸€æ¬¡å·®å€¼ã€‚</p><p id="46dc" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬å†æ¬¡è¿è¡Œæ‰©å±•çš„ Dickey-Fuller æµ‹è¯•ï¼Œçœ‹çœ‹æˆ‘ä»¬æ˜¯å¦æœ‰ä¸€ä¸ªå¹³ç¨³çš„æ—¶é—´åºåˆ—:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="1bd7" class="nv mx iv on b gy or os l ot ou">ad_fuller_result = adfuller(data['data'])<br/>print(f'ADF Statistic: {ad_fuller_result[0]}')<br/>print(f'p-value: {ad_fuller_result[1]}')</span></pre><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/f54664ceec843903a39701b68da5d4c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*TC6Z46Se-CN5NtKU0aj0-g.png"/></div></figure><p id="ed0d" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">äº‹å®ä¸Šï¼Œp å€¼è¶³å¤Ÿå°ï¼Œæˆ‘ä»¬å¯ä»¥æ‹’ç»é›¶å‡è®¾ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºæ—¶é—´åºåˆ—æ˜¯å¹³ç¨³çš„ã€‚</p><p id="74af" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">çœ‹çœ‹ ACF å’Œ PACF:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="43a3" class="nv mx iv on b gy or os l ot ou">plot_pacf(data['data']);<br/>plot_acf(data['data']);</span></pre><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/1ba7b8a50ce5771b6c1d60dd572cb481.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*h2kTtXNHn-EkQqkoekL4FA.png"/></div></figure><p id="c7a3" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">æˆ‘ä»¬å¯ä»¥ä» PACF ä¸­çœ‹åˆ°ï¼Œæˆ‘ä»¬åœ¨æ»å 1 å¤„æœ‰ä¸€ä¸ªæ˜¾è‘—çš„å³°å€¼ï¼Œè¿™è¡¨æ˜ AR(1)è¿‡ç¨‹ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬åœ¨æ»å 4 å¤„æœ‰å¦ä¸€ä¸ªå³°å€¼ï¼Œè¡¨æ˜ 1 é˜¶çš„å­£èŠ‚æ€§è‡ªå›å½’è¿‡ç¨‹(P = 1)ã€‚</p><p id="a67b" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">æŸ¥çœ‹ ACF å›¾ï¼Œæˆ‘ä»¬ä»…åœ¨æ»å 1 å¤„çœ‹åˆ°ä¸€ä¸ªæ˜¾è‘—çš„å³°å€¼ï¼Œè¡¨æ˜å­˜åœ¨éå­£èŠ‚æ€§ MA(1)è¿‡ç¨‹ã€‚</p><p id="37f9" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">å°½ç®¡è¿™äº›å›¾å¯ä»¥è®©æˆ‘ä»¬å¤§è‡´äº†è§£æ­£åœ¨è¿›è¡Œçš„è¿‡ç¨‹ï¼Œä½†æœ€å¥½æµ‹è¯•å¤šä¸ªåœºæ™¯ï¼Œå¹¶é€‰æ‹©äº§ç”Ÿæœ€ä½ AIC çš„æ¨¡å‹ã€‚</p><p id="2b8c" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">å› æ­¤ï¼Œè®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥æµ‹è¯• SARIMA æ¨¡å‹çš„ä¸€ç³»åˆ—å‚æ•°ï¼Œå¹¶è¾“å‡ºä¸€ä¸ªæ€§èƒ½æœ€ä½³çš„æ¨¡å‹ä½äºé¡¶éƒ¨çš„è¡¨:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="bd9e" class="nv mx iv on b gy or os l ot ou">def optimize_SARIMA(parameters_list, d, D, s, exog):<br/>    """<br/>        Return dataframe with parameters, corresponding AIC and SSE<br/>        <br/>        parameters_list - list with (p, q, P, Q) tuples<br/>        d - integration order<br/>        D - seasonal integration order<br/>        s - length of season<br/>        exog - the exogenous variable<br/>    """<br/>    <br/>    results = []<br/>    <br/>    for param in tqdm_notebook(parameters_list):<br/>        try: <br/>            model = SARIMAX(exog, order=(param[0], d, param[1]), seasonal_order=(param[2], D, param[3], s)).fit(disp=-1)<br/>        except:<br/>            continue<br/>            <br/>        aic = model.aic<br/>        results.append([param, aic])<br/>        <br/>    result_df = pd.DataFrame(results)<br/>    result_df.columns = ['(p,q)x(P,Q)', 'AIC']<br/>    #Sort in ascending order, lower AIC is better<br/>    result_df = result_df.sort_values(by='AIC', ascending=True).reset_index(drop=True)<br/>    <br/>    return result_df</span></pre><p id="dade" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å°†åªæµ‹è¯•å‚æ•° Pã€Pã€q å’Œ q çš„ä¸åŒå€¼ã€‚æˆ‘ä»¬çŸ¥é“å­£èŠ‚å’Œéå­£èŠ‚ç§¯åˆ†å‚æ•°éƒ½åº”è¯¥æ˜¯ 1ï¼Œå­£èŠ‚é•¿åº¦æ˜¯ 4ã€‚</p><p id="6b45" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">å› æ­¤ï¼Œæˆ‘ä»¬ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„å‚æ•°ç»„åˆ:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="c370" class="nv mx iv on b gy or os l ot ou">p = range(0, 4, 1)<br/>d = 1<br/>q = range(0, 4, 1)<br/>P = range(0, 4, 1)<br/>D = 1<br/>Q = range(0, 4, 1)<br/>s = 4</span><span id="0f0c" class="nv mx iv on b gy ov os l ot ou">parameters = product(p, q, P, Q)<br/>parameters_list = list(parameters)<br/>print(len(parameters_list))</span></pre><p id="e624" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ä½ åº”è¯¥çœ‹åˆ°æˆ‘ä»¬æœ‰ 256 ç§ä¸åŒçš„ç»„åˆï¼ç°åœ¨ï¼Œæˆ‘ä»¬çš„å‡½æ•°å°†æ ¹æ®æˆ‘ä»¬çš„æ•°æ®æ‹Ÿåˆ 256 ç§ä¸åŒçš„ SARIMA æ¨¡å‹ï¼Œä»¥æ‰¾åˆ° AIC æœ€ä½çš„æ¨¡å‹:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="f9a9" class="nv mx iv on b gy or os l ot ou">result_df = optimize_SARIMA(parameters_list, 1, 1, 4, data['data'])<br/>result_df</span></pre><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/d93c23ecbc56bf577641cf7a50b06e53.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*Vcoj8r0-fnM-AoOLIEvU6g.png"/></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">ç»“æœè¡¨</p></figure><p id="ccd1" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ä»è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼Œæœ€ä½³æ¨¡å‹æ˜¯:SARIMA(0ï¼Œ1ï¼Œ2)(0ï¼Œ1ï¼Œ2ï¼Œ4)ã€‚</p><p id="fb3b" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">æˆ‘ä»¬ç°åœ¨å¯ä»¥æ‹Ÿåˆæ¨¡å‹å¹¶è¾“å‡ºå…¶æ‘˜è¦:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="f35c" class="nv mx iv on b gy or os l ot ou">best_model = SARIMAX(data['data'], order=(0, 1, 2), seasonal_order=(0, 1, 2, 4)).fit(dis=-1)<br/>print(best_model.summary())</span></pre><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi pe"><img src="../Images/876379f45d77b0d8f4f4804cadc6358f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KwCtO3_mwtO2l6Tgvwln0Q.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">æœ€ä½³æ¨¡å¼æ€»ç»“</p></figure><p id="cff0" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥çœ‹åˆ°è¡¨ç°æœ€å¥½çš„æ¨¡å‹åŒæ—¶å…·æœ‰å­£èŠ‚æ€§å’Œéå­£èŠ‚æ€§ç§»åŠ¨å¹³å‡è¿‡ç¨‹ã€‚</p><p id="3a70" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">æ ¹æ®ä¸Šé¢çš„æ€»ç»“ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ç³»æ•°çš„å€¼åŠå…¶ p å€¼ã€‚è¯·æ³¨æ„ï¼Œä» p å€¼æ¥çœ‹ï¼Œæ‰€æœ‰ç³»æ•°éƒ½æ˜¯æ˜¾è‘—çš„ã€‚</p><p id="0ce8" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ç ”ç©¶æ®‹å·®:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="5a98" class="nv mx iv on b gy or os l ot ou">best_model.plot_diagnostics(figsize=(15,12));</span></pre><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi pf"><img src="../Images/b90e6da1025b98c276f0c7744d5f1ad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r4OqfGPim7nKl6V1_qY54g.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">æ¨¡å‹è¯Šæ–­</p></figure><p id="a87f" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ä»æ­£å¸¸çš„ Q-Q å›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å‡ ä¹æœ‰ä¸€æ¡ç›´çº¿ï¼Œè¿™è¡¨æ˜æ²¡æœ‰ç³»ç»Ÿåç¦»æ­£å¸¸ã€‚æ­¤å¤–ï¼Œå³ä¸‹è§’çš„ç›¸å…³å›¾è¡¨æ˜æ®‹å·®ä¸­æ²¡æœ‰è‡ªç›¸å…³ï¼Œå› æ­¤å®ƒä»¬å®é™…ä¸Šæ˜¯ç™½å™ªå£°ã€‚</p><p id="3d33" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½ç»˜åˆ¶æ¨¡å‹çš„é¢„æµ‹å›¾ï¼Œå¹¶é¢„æµ‹æœªæ¥:</p><pre class="kl km kn ko gt om on oo op aw oq bi"><span id="8666" class="nv mx iv on b gy or os l ot ou">data['arima_model'] = best_model.fittedvalues<br/>data['arima_model'][:4+1] = np.NaN</span><span id="686c" class="nv mx iv on b gy ov os l ot ou">forecast = best_model.predict(start=data.shape[0], end=data.shape[0] + 8)<br/>forecast = data['arima_model'].append(forecast)</span><span id="2290" class="nv mx iv on b gy ov os l ot ou">plt.figure(figsize=(15, 7.5))<br/>plt.plot(forecast, color='r', label='model')<br/>plt.axvspan(data.index[-1], forecast.index[-1], alpha=0.5, color='lightgrey')<br/>plt.plot(data['data'], label='actual')<br/>plt.legend()</span><span id="ff3a" class="nv mx iv on b gy ov os l ot ou">plt.show()</span></pre><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kq kr di ks bf kt"><div class="gh gi pg"><img src="../Images/9ddfe13d1c6869e9fc61c9aeecb9bde5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IQwLa1yvmuf0ALadM0HUiA.png"/></div></div><p class="kw kx gj gh gi ky kz bd b be z dk translated">æ¨¡å‹é¢„æµ‹</p></figure><p id="4cd3" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">ç§å•Šã€‚</p><h1 id="1fc7" class="mw mx iv bd my mz na nb nc nd ne nf ng kb oj kc ni ke ok kf nk kh ol ki nm nn bi translated">ç»“è®º</h1><p id="f012" class="pw-post-body-paragraph lb lc iv ld b le no jw lg lh np jz lj lk nq lm ln lo nr lq lr ls ns lu lv lw io bi translated">æ­å–œä½ ï¼æ‚¨ç°åœ¨äº†è§£äº†ä»€ä¹ˆæ˜¯å­£èŠ‚æ€§ ARIMA(æˆ– SARIMA)æ¨¡å‹ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒè¿›è¡Œå»ºæ¨¡å’Œé¢„æµ‹ã€‚</p><p id="a340" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">é€šè¿‡ä»¥ä¸‹è¯¾ç¨‹äº†è§£æœ‰å…³æ—¶é—´åºåˆ—çš„æ›´å¤šä¿¡æ¯:</p><ul class=""><li id="c836" class="lx ly iv ld b le lf lh li lk lz lo ma ls mb lw mc md me mf bi translated"><a class="ae la" href="https://www.datasciencewithmarco.com/offers/tdU2mtVK" rel="noopener ugc nofollow" target="_blank">åœ¨ Python ä¸­åº”ç”¨æ—¶é—´åºåˆ—åˆ†æ</a></li></ul><p id="c624" class="pw-post-body-paragraph lb lc iv ld b le lf jw lg lh li jz lj lk ll lm ln lo lp lq lr ls lt lu lv lw io bi translated">å¹²æ¯ğŸº</p></div></div>    
</body>
</html>