<html>
<head>
<title>Machine Learning Web Application Deployment in 5 steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习Web应用程序部署的5个步骤</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-web-application-deployment-in-5-steps-d8eb6a389cdd?source=collection_archive---------23-----------------------#2020-01-08">https://towardsdatascience.com/machine-learning-web-application-deployment-in-5-steps-d8eb6a389cdd?source=collection_archive---------23-----------------------#2020-01-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="ea33" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsdatascience.com/tagged/data-science-sprints" rel="noopener" target="_blank">数据科学冲刺</a></h2><div class=""/><div class=""><h2 id="9786" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">你已经建立了一个模型和一个应用程序；现在是时候让世界看看了！学习使用AWS免费部署ML web应用程序。</h2></div><p id="96bf" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">让我给你描述一下:</p><p id="2625" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><em class="ln">你花了两个月的时间在一个非常令人兴奋的数据科学应用上。它涉及高级数据收集、耗时的数据争论、数小时的培训和无尽的模型微优化。一旦你完成了，你就拥有了你真正满意的东西。但是今天，你的重磅炸弹模型已经完成3个月了，它只是和你的研究笔记本和半文档代码一起放在GitHub的仓库里。你已经获得了12颗星和2把叉子，但是你想知道，“是这个吗？这个世界上只有14个人关心我建造的这个伟大的东西吗？我应该做些不同的事情吗？如果有，是什么？”</em></p><p id="d45f" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果你有过这样的经历，创造了一些美好的东西，只有少数人与之互动，甚至更少人给你反馈，<strong class="kt jd">你并不孤单</strong>。我经常犯这种错误，我有很多从事数据科学的朋友也有类似的经历。现在，我不想贬低那些喜欢研究理论问题并在研究环境中茁壮成长的人们，但我确实认为有一些数据科学家需要向全世界展示他们的工作。这不仅有助于招聘人员等非技术人员看到并理解你的工作，还能打开接收项目真实反馈的大门。</p><p id="f83d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated"><strong class="kt jd">在本文中，我将分享如何在没有Amazon Beanstalk的情况下将机器学习web应用程序部署到Amazon AWS EC2实例，以保持我们的部署完全自由分层</strong>。你可以点击 查看我们最终产品<a class="ae lo" href="http://ec2-54-145-145-48.compute-1.amazonaws.com" rel="noopener ugc nofollow" target="_blank"> <strong class="kt jd">的现场演示。</strong></a></p><p id="d267" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">虽然您可以使用自己的模型和应用程序来跟进，但我将使用我以前的一个项目，我首先构建了一个情感分析分类器，然后在此基础上构建了一个flask web应用程序。你可以在<a class="ae lo" href="https://github.com/hr23232323/nlp_medium_p1" rel="noopener ugc nofollow" target="_blank">这个库</a>中找到我的模型的所有代码，在<a class="ae lo" href="https://github.com/hr23232323/nlp_medium_p2" rel="noopener ugc nofollow" target="_blank">这个库</a>中找到我的web应用程序的所有代码。我强烈推荐基于flask的开发技术栈，因为它最容易部署到AWS，并且应该足以满足任何基本的应用程序。</p><h1 id="53cc" class="lp lq it bd lr ls lt lu lv lw lx ly lz ki ma kj mb kl mc km md ko me kp mf mg bi translated">部署步骤</h1><p id="61a1" class="pw-post-body-paragraph kr ks it kt b ku mh kd kw kx mi kg kz la mj lc ld le mk lg lh li ml lk ll lm im bi translated">让我们现实一点，亚马逊网络服务(AWS)对于以前从未使用过网络技术和后端服务的人来说可能是超级可怕的。老实说，我是一名专业的全栈web开发人员，我仍然很难导航和开始使用AWS，因为它提供了太多不同的服务！你需要S3水桶吗？负载管理器怎么样？你必须使用Lambda请求，对吗？</p><p id="b114" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">快速提示:<strong class="kt jd">本指南并不针对生产或企业级解决方案，只应用于基本的个人项目</strong>。如果您对更适合生产的部署指南感兴趣，请随意发表评论，这样我(或其他媒体读者)可以为您指出正确的方向。在本文中，我真正关注的是个人使用的精益应用程序部署。我们将使用AWS EC2实例，它基本上是一个虚拟服务器。它是AWS提供的免费层的一部分，因此通过下面提到的步骤部署您的项目将是绝对免费的。</p><p id="ecf9" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">说完这些细节，让我们来讨论一下如何通过5个简单的步骤在一个普通EC2实例上部署我们的基本应用程序。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mm"><img src="../Images/84956a8bf40810e98f4565fe15c1b74c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aUgEWHJTU6dLzcXXZmAZcA.png"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">ML web应用部署的5个步骤</p></figure><p id="3c84" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">从很高的层面来看，我们的部署步骤可以在上图中看到。我们将从设置一个EC2实例开始，我们的应用程序将在该实例上运行。这将涉及利用一些指南，但我会帮助你通过这一点，并提到常见的错误，以节省您的时间和挫折。接下来，我们将连接到我们的实例，并将我们的代码迁移到它。在这里，我将分享我们今天将使用的应用程序，带您浏览我们的Flask目录设置和API。之后，我们将安装项目依赖项，然后设置一个本地Apache服务器在我们的EC2实例上运行，该实例将用于在EC2服务器提供的公共端口上为我们的应用程序提供服务。我们开始吧！</p><h1 id="15bb" class="lp lq it bd lr ls lt lu lv lw lx ly lz ki ma kj mb kl mc km md ko me kp mf mg bi translated">EC2实例设置</h1><p id="f830" class="pw-post-body-paragraph kr ks it kt b ku mh kd kw kx mi kg kz la mj lc ld le mk lg lh li ml lk ll lm im bi translated">在AWS上设置EC2实例并不太难，在TDS和其他领域的许多不同文章中都有介绍，所以我不会再浪费您的时间了。相反，我将指向对我帮助最大的指南，并浏览一些在安装过程中出现的常见错误/问题。请记住，这一步的目标是:</p><ol class=""><li id="5cd1" class="nc nd it kt b ku kv kx ky la ne le nf li ng lm nh ni nj nk bi translated">创建一个AWS帐户(如果您还没有)</li><li id="32b9" class="nc nd it kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">使用我将在下面提到的教程和指南启动EC2服务器</li><li id="d6b6" class="nc nd it kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">确保实例设置正确无误</li></ol><p id="f8b3" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">下面是帮助你设置实例的官方指南:<a class="ae lo" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EC2_GetStarted.html#ec2-launch-instance" rel="noopener ugc nofollow" target="_blank"> AWS官方EC2实例设置指南</a>。您需要对设置进行一些关键的更改，如下所示。</p><p id="7163" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在<em class="ln">步骤1:选择一个亚马逊机器镜像(AMI) </em>，选择<strong class="kt jd"> Ubuntu服务器16.04 LTS (HVM)。</strong></p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nq"><img src="../Images/146fd141c4834f540e1b33746e309bc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9nyhrLFR61_-VhFUI7K1SA.png"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">本文中使用的AMI</p></figure><p id="18df" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">坚持使用免费层选项(t2.micro ),因为它有足够的计算能力用于大多数小规模的个人项目。不要选择查看和启动按钮，点击不同的配置选项，并在<em class="ln">步骤6:配置安全组停止。</em>在这里，使用以下设置添加一个新的安全组:</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nr"><img src="../Images/829723aeaa18766dc437c5d24d2300ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R94WyWgLak5AvJhVeYpQAQ.png"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">第一个安全组应该已经存在，添加具有相同设置的第二个安全组:HTTPTCP80;任何地方；违约；描述(可选)</p></figure><p id="569c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这将允许世界上任何地方的用户能够使用HTTP访问正在运行的EC2实例上的端口，这对我们的web应用程序来说是完美的。现在，当您完成这一步后，查看并单击启动按钮，您将看到以下对话框:</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi ns"><img src="../Images/6d8e67bfd850d179acf229178511e029.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ygHPz7Foxek-_sWS2lv6A.png"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">密钥对屏幕</p></figure><p id="42ff" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">确保选择“创建新的密钥对”(如果您还没有)，并将此<code class="fe nt nu nv nw b">.pem</code>文件保存在一个安全的位置。你以后会需要这个的。恭喜，您的EC2实例现在已经启动并运行了！是时候连接到它并迁移您的应用程序了。</p><h1 id="7a69" class="lp lq it bd lr ls lt lu lv lw lx ly lz ki ma kj mb kl mc km md ko me kp mf mg bi translated">连接到EC2</h1><p id="a502" class="pw-post-body-paragraph kr ks it kt b ku mh kd kw kx mi kg kz la mj lc ld le mk lg lh li ml lk ll lm im bi translated">现在我们的实例已经启动并运行，我们可以连接到它了。基于你的操作系统，连接过程会有所不同，所以我不能为Mac/Linux用户提供太多的帮助，但是这里有一个<a class="ae lo" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AccessingInstances.html" rel="noopener ugc nofollow" target="_blank">很棒的页面</a>为你们提供资源。我将主要介绍Windows安装过程，并再次向您介绍一些好的资源，同时提到一些障碍和额外的步骤。我强烈建议使用PuTTY作为您的SSH客户端，因为它易于使用和简单。完成连接顺序的最佳指南还是AWS官方指南<a class="ae lo" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/putty.html" rel="noopener ugc nofollow" target="_blank">，所以请随意完成。</a></p><p id="2d5a" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">一旦你完成了你的。您的ppk密钥。pem键并准备好连接到您的实例，以下详细信息将有所帮助:</p><pre class="mn mo mp mq gt nx nw ny nz aw oa bi"><span id="680d" class="ob lq it nw b gy oc od l oe of"><strong class="nw jd">Hostname</strong>: ubuntu@<em class="ln">your_public_dns_name</em></span></pre><p id="52c8" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">您可以在AWS EC2主页上点击“运行实例”找到您的公共DNS名称:</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi og"><img src="../Images/0d8637e7d8b2f71a20e9725b653eb8aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GAQBT86uX1L7Fk9u4Z0EMw.png"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">AWS EC2运行实例页:用于查找您的公共DNS</p></figure><p id="3eca" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">指南中涉及的连接到EC2实例的其余步骤相当简单，但是请确保将您的设置保存在PuTTY页面中，这样您就不必每次都进行设置。注意:您的连接类型是SSH，在保存您的设置之前，请确保您的<code class="fe nt nu nv nw b">.ppk</code>文件连接在Connection &gt; SSH &gt; Auth下。</p><p id="f5c5" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果一切顺利，在这一步之后，您将能够使用PuTTY客户机访问您的实例。这将是一个黑色的70年代DOS风格的屏幕，这正是我们要找的！</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi oh"><img src="../Images/8aadc7ed0565b26317416bda760aab93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_6E2ljzY2DCiH2Ax4nJbiw.png"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">太好了，您已经在EC2实例中了！</p></figure><h1 id="8b7e" class="lp lq it bd lr ls lt lu lv lw lx ly lz ki ma kj mb kl mc km md ko me kp mf mg bi translated">将应用程序代码迁移到EC2</h1><p id="1dcb" class="pw-post-body-paragraph kr ks it kt b ku mh kd kw kx mi kg kz la mj lc ld le mk lg lh li ml lk ll lm im bi translated">正如我在文章前面提到的，我们将部署<a class="ae lo" rel="noopener" target="_blank" href="/web-app-development-for-data-scientists-48e445e54d7b">一个机器学习web应用程序</a>，它是我在过去两周内构建的。在我们进入代码迁移之前，关于模型、应用程序和项目结构的一些知识是必要的。该模型是具有增量学习能力的基本情感分析分类器。我们在此基础上创建了一个单页面应用程序来帮助用户与我们的模型进行交互。我们有两个Flask API路径，允许用户输入评论/想法并接收情感分析，并向模型提供反馈，从而允许持续学习。</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/df7da57e11c3920eec6c553d980191bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/0*6ScZZUqANmpGoUJb.png"/></div><p class="my mz gj gh gi na nb bd b be z dk translated">项目结构</p></figure><p id="0eb3" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">项目结构可以在右图中看到。我们所有的资产(图像、模型等。)在同一个主文件夹<code class="fe nt nu nv nw b">static</code>的不同子文件夹中，我们的HTML页面在<code class="fe nt nu nv nw b">templates</code>文件夹中，我们的<code class="fe nt nu nv nw b">app.py</code>文件在<code class="fe nt nu nv nw b">python</code>文件夹中。</p><p id="e4ea" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们将使用<code class="fe nt nu nv nw b">SCP</code>命令来帮助我们将文件从本地计算机(windows)传输到EC2实例。在此之前，使用以下命令在<code class="fe nt nu nv nw b">/home/ubuntu</code>中创建一个目录(我称之为我的web_app，我建议使用相同的名称以避免任何混淆)，您的应用程序将存在于该目录中</p><pre class="mn mo mp mq gt nx nw ny nz aw oa bi"><span id="953e" class="ob lq it nw b gy oc od l oe of">mkdir web_app</span></pre><p id="fb6b" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">因此，您希望实例上的部署位置是<code class="fe nt nu nv nw b">/home/ubuntu/web_app</code>。现在，您必须将上面提到的应用程序下载并解压缩到您的本地机器上。您可以在这个<a class="ae lo" href="https://github.com/hr23232323/nlp_medium_p2" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>中找到项目代码。一旦在本地机器上有了项目文件，就可以使用下面的<code class="fe nt nu nv nw b">SCP</code>命令(从windows终端)将文件从本地机器移动到AWS EC2实例:</p><pre class="mn mo mp mq gt nx nw ny nz aw oa bi"><span id="84be" class="ob lq it nw b gy oc od l oe of">scp -i <strong class="nw jd">&lt;path/to/pem/key&gt;</strong> -r <strong class="nw jd">&lt;local/path/to/project/folder&gt;</strong> <a class="ae lo" href="mailto:ubuntu@ec2-54-235-0-36.compute-1.amazonaws.com" rel="noopener ugc nofollow" target="_blank">ubuntu@</a><strong class="nw jd">&lt;instance/public/DNS&gt;</strong>:/home/ubuntu/web_app</span></pre><p id="8a07" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">注意:如果您遇到一个错误，显示如下消息“对‘私有密钥’的权限太开放了”，请查看这篇<a class="ae lo" href="https://superuser.com/questions/1296024/windows-ssh-permissions-for-private-key-are-too-open" rel="noopener ugc nofollow" target="_blank">很棒的文章</a>来解决这个问题。</p><p id="fb28" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">太好了！此时，您的项目文件应该都在EC2实例中了。确保文件夹结构/路径正确(例如:<code class="fe nt nu nv nw b">/home/ubuntu/web_app/python/app.py</code>等)。)现在我们可以进入下一步了。</p><h1 id="776b" class="lp lq it bd lr ls lt lu lv lw lx ly lz ki ma kj mb kl mc km md ko me kp mf mg bi translated">依赖安装</h1><p id="506b" class="pw-post-body-paragraph kr ks it kt b ku mh kd kw kx mi kg kz la mj lc ld le mk lg lh li ml lk ll lm im bi translated">现在，这一步可能是人们最困惑的，因为python环境、模块和其他安装可能会很快变得复杂和相互依赖。为了简单起见，我们将这一部分分为两个主要步骤:</p><ol class=""><li id="67e7" class="nc nd it kt b ku kv kx ky la ne le nf li ng lm nh ni nj nk bi translated">安装pip和其他python依赖项</li><li id="2f45" class="nc nd it kt b ku nl kx nm la nn le no li np lm nh ni nj nk bi translated">在我们的EC2实例上安装Apache和mod_wsgi</li></ol><p id="f7ca" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">让我们从确保运行Python 3并安装正确版本的Pip开始。您的EC2实例应该预装了python3。要进行检查，请使用以下命令:</p><pre class="mn mo mp mq gt nx nw ny nz aw oa bi"><span id="916e" class="ob lq it nw b gy oc od l oe of">python3 -V</span></pre><p id="586d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">您应该会看到高于3.5的版本。如果是这样，你可以继续下一步。如果没有，看看这个<a class="ae lo" href="https://docs.aws.amazon.com/cli/latest/userguide/install-linux-python.html" rel="noopener ugc nofollow" target="_blank">官方指南</a>。一旦安装了python3，就需要下载并安装正确的pip版本。为此，请使用以下命令(按顺序):</p><pre class="mn mo mp mq gt nx nw ny nz aw oa bi"><span id="4557" class="ob lq it nw b gy oc od l oe of">curl -O <a class="ae lo" href="https://bootstrap.pypa.io/get-pip.py" rel="noopener ugc nofollow" target="_blank">https://bootstrap.pypa.io/get-pip.py</a> <br/>sudo python3 get-pip.py</span></pre><p id="c189" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在，您应该已经安装了python3和pip。在进入下一步之前，运行以下命令以确保所有内容都是最新的:</p><pre class="mn mo mp mq gt nx nw ny nz aw oa bi"><span id="b556" class="ob lq it nw b gy oc od l oe of">sudo apt-get update</span></pre><p id="b453" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我们将通过使用以下命令安装我们的web应用程序依赖项(Flask和Scikit-learn)来完成这一步:</p><pre class="mn mo mp mq gt nx nw ny nz aw oa bi"><span id="d3b3" class="ob lq it nw b gy oc od l oe of">sudo pip install Flask<br/>sudo pip install scikit-learn</span></pre><p id="88f1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在我们可以进入下一步:<strong class="kt jd">安装Apache和mod_wsgi </strong>。</p><p id="8103" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">要设置Apache，您需要两个模块:Apache2和mod_wsgi。Apache2是我们的简单web服务器，mod_wsgi是用于基于Python的web应用程序的Apache模块。要安装python3的正确版本，请使用以下命令:</p><pre class="mn mo mp mq gt nx nw ny nz aw oa bi"><span id="6b46" class="ob lq it nw b gy oc od l oe of">sudo apt-get install apache2<br/>sudo apt-get install libapache2-mod-wsgi-py</span></pre><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi oj"><img src="../Images/e0231a5044c685bcf3c64d8160d0ce48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MJ5Y6cMIlx2-X9aeYQBwaQ.png"/></div></div><p class="my mz gj gh gi na nb bd b be z dk translated">Apache默认页面。恭喜，您的服务器已经启动并运行了！</p></figure><p id="d836" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">此时，Apache服务器应该在AWS EC2公共DNS上提供默认页面。要验证这一点，请注意AWS控制台中的公共DNS ( <code class="fe nt nu nv nw b">ec2-xx-xxx-xx-xxx.compute-x.amazonaws.com/</code>)并在浏览器中访问它。您应该会看到一个类似左边的屏幕。</p><p id="3e5d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如果您可以看到Apache的默认屏幕，那就高兴吧，因为您就快到了！如果没有，请随意使用评论区，这样我和其他人可以帮助你。您还可以查看Apache日志文件(<code class="fe nt nu nv nw b">/var/log/apache2/error.log</code>)来尝试调试自己。</p><p id="f80d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">您已经设置了python3和pip，安装了Apache及其所需的模块，并且已经提供了一个页面。现在，剩下的就是设置Apache，将它指向您的项目文件夹，并授予它访问这些文件的权限。</p><h1 id="b8db" class="lp lq it bd lr ls lt lu lv lw lx ly lz ki ma kj mb kl mc km md ko me kp mf mg bi translated">Apache设置和部署</h1><p id="3a9e" class="pw-post-body-paragraph kr ks it kt b ku mh kd kw kx mi kg kz la mj lc ld le mk lg lh li ml lk ll lm im bi translated">为了让我们的应用程序在服务器上运行，我们需要设置一些Apache配置。这包括两个步骤:设置服务器配置/权限和设置mod_wsgi配置。</p><p id="b572" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">要设置您的服务器配置，您需要编辑以下文件:<code class="fe nt nu nv nw b">/etc/apache2/sites-enabled/000-default.conf</code>。这是一个受限文件，因此你必须使用sudo来编辑它。使用以下命令:</p><pre class="mn mo mp mq gt nx nw ny nz aw oa bi"><span id="dc69" class="ob lq it nw b gy oc od l oe of">sudo vi /etc/apache2/sites-enabled/000-default.conf</span></pre><p id="8889" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">在第<code class="fe nt nu nv nw b">ServerAdmin webmaster@localhost</code>行之后添加以下代码块:</p><pre class="mn mo mp mq gt nx nw ny nz aw oa bi"><span id="5532" class="ob lq it nw b gy oc od l oe of">DocumentRoot /home/ubuntu/web_app</span><span id="5357" class="ob lq it nw b gy ok od l oe of">WSGIDaemonProcess flaskapp threads=5 python-home=/usr/local/lib/python3.5/site-packages/ user=ubuntu<br/>        WSGIScriptAlias / /home/ubuntu/web_app/static/flaskapp.wsgi</span><span id="65f5" class="ob lq it nw b gy ok od l oe of">&lt;Directory /home/ubuntu/web_app&gt;<br/>            WSGIProcessGroup flaskapp<br/>            WSGIApplicationGroup %{GLOBAL}<br/>            Require all granted<br/>        &lt;/Directory&gt;</span><span id="01e0" class="ob lq it nw b gy ok od l oe of">&lt;Directory python&gt;<br/>            Require all granted<br/>        &lt;/Directory&gt;</span><span id="7f99" class="ob lq it nw b gy ok od l oe of">&lt;Directory static&gt;<br/>            Require all granted<br/>        &lt;/Directory&gt;</span><span id="85a8" class="ob lq it nw b gy ok od l oe of">&lt;Directory static/models&gt;<br/>            Require all granted<br/>        &lt;/Directory&gt;</span></pre><p id="5b0d" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这些配置设置应该将Apache指向我们的web应用程序的位置，并给予它与我们的文件和模型进行交互所需的所有权限。</p><p id="7ce1" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">Apache设置的最后一步是配置mod_wsgi来支持基于Flask的应用程序。为此，您必须在<strong class="kt jd">静态文件夹</strong>中创建一个名为<code class="fe nt nu nv nw b">flaskapp.wsgi</code>的文件。将以下代码放入该文件:</p><pre class="mn mo mp mq gt nx nw ny nz aw oa bi"><span id="83c5" class="ob lq it nw b gy oc od l oe of">import sys<br/>import site<br/>site.addsitedir(‘/home/ubuntu/.local/lib/python3.5/site-packages’)<br/>sys.path.insert(0, ‘/home/ubuntu/web_app/python’)<br/>from app import app as application</span></pre><p id="7b5c" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这些是Apache定位python依赖项和项目文件夹所需的配置。一旦您创建/修改了这些文件并输入了适当的代码，您的应用程序就可以运行了。使用以下命令重新启动服务器，以查看更改是否生效:</p><pre class="mn mo mp mq gt nx nw ny nz aw oa bi"><span id="9188" class="ob lq it nw b gy oc od l oe of">sudo apachectl restart</span></pre><p id="3af2" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">希望在这一点上，您的web应用程序成功地运行在您的EC2公共DNS上，并准备好与外界进行交互！如果您看到403或500错误代码，请尝试查看Apache日志文件(<code class="fe nt nu nv nw b">/var/log/apache2/error.log</code>)来寻找出错的线索。和往常一样，你也可以在评论区分享错误，我会尽力帮忙。如果一切顺利，当您在浏览器中访问您的公共DNS时，您应该会看到我们的应用程序:</p><figure class="mn mo mp mq gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi ol"><img src="../Images/7071dbf30c843a29b66e235d5f54a8ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*BHL_eV9Y0WPAe_kNrz4gFQ.gif"/></div></div></figure><p id="a67a" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">你可以点击 查看<a class="ae lo" href="http://ec2-54-145-145-48.compute-1.amazonaws.com" rel="noopener ugc nofollow" target="_blank">T5的现场演示。</a></p><h1 id="9588" class="lp lq it bd lr ls lt lu lv lw lx ly lz ki ma kj mb kl mc km md ko me kp mf mg bi translated">结束语</h1><p id="a73e" class="pw-post-body-paragraph kr ks it kt b ku mh kd kw kx mi kg kz la mj lc ld le mk lg lh li ml lk ll lm im bi translated">我认为互联网应该充满真实世界的项目，这些项目是人们为了公开交流他们最感兴趣的想法而建造的。学习如何<a class="ae lo" rel="noopener" target="_blank" href="/building-and-deploying-a-data-science-project-in-two-weeks-3c63f0acdab1">从零开始构建一个模型</a>，<a class="ae lo" rel="noopener" target="_blank" href="/web-app-development-for-data-scientists-48e445e54d7b">围绕它设计和开发一个web应用</a>并最终部署到网上让全世界看到，这是朝着那个目标迈出的一大步。我希望你们中的一些人受到启发，建立并分享自己的东西，如果你这样做了，不要忘记通过鼓励其他人做同样的事情来回报它。</p><p id="b14e" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">我希望你喜欢读这篇文章，就像我喜欢把它放在一起一样。如果您有任何问题、反馈或意见，请随时通过<a class="ae lo" href="https://www.linkedin.com/in/harshrana1997/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>或我的<a class="ae lo" href="http://www.harshrana.com/" rel="noopener ugc nofollow" target="_blank">网站</a>与我联系。此外，如果您最终构建并部署了自己的应用程序，请与我分享，因为我很想看到它！</p></div></div>    
</body>
</html>