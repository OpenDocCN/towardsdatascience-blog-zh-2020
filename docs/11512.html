<html>
<head>
<title>How to Build a Spam Classifier in 10 Steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ç”¨ 10 ä¸ªæ­¥éª¤æ„å»ºåƒåœ¾é‚®ä»¶åˆ†ç±»å™¨</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/how-to-build-your-first-spam-classifier-in-10-steps-fdbf5b1b3870?source=collection_archive---------5-----------------------#2020-08-10">https://towardsdatascience.com/how-to-build-your-first-spam-classifier-in-10-steps-fdbf5b1b3870?source=collection_archive---------5-----------------------#2020-08-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="49e7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¦‚æœä½ åˆšåˆšå¼€å§‹æœºå™¨å­¦ä¹ ï¼Œå¾ˆæœ‰å¯èƒ½ä½ ä¼šè¿›è¡Œä¸€ä¸ªåˆ†ç±»é¡¹ç›®ã€‚ä½œä¸ºä¸€ä¸ªåˆå­¦è€…ï¼Œæˆ‘å»ºç«‹äº†ä¸€ä¸ªåƒåœ¾çŸ­ä¿¡åˆ†ç±»å™¨ï¼Œä½†åšäº†å¤§é‡çš„ç ”ç©¶ï¼ŒçŸ¥é“ä»å“ªé‡Œå¼€å§‹ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†ç”¨ 10 ä¸ªæ­¥éª¤å‘æ‚¨ä»‹ç»æˆ‘çš„é¡¹ç›®ï¼Œè®©æ‚¨æ›´å®¹æ˜“ä½¿ç”¨ Tf-IDF çŸ¢é‡å™¨å’Œæœ´ç´ è´å¶æ–¯æ¨¡å‹æ„å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªåƒåœ¾é‚®ä»¶åˆ†ç±»å™¨ï¼</p><h1 id="1324" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">1.åŠ è½½å¹¶ç®€åŒ–æ•°æ®é›†</h1><p id="239a" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">å¦‚æœæ‚¨åœ¨ pandas ä¸­é˜…è¯»ï¼Œæˆ‘ä»¬çš„ SMS æ–‡æœ¬æ¶ˆæ¯æ•°æ®é›†æœ‰ 5 åˆ—:v1(åŒ…å«æ¯æ¡æ–‡æœ¬æ¶ˆæ¯çš„åˆ†ç±»æ ‡ç­¾ ham/spam)ã€v2(åŒ…å«æ–‡æœ¬æ¶ˆæ¯æœ¬èº«)å’Œä¸‰ä¸ªæ²¡æœ‰ä½¿ç”¨çš„æœªå‘½ååˆ—ã€‚æˆ‘ä»¬å°† v1 å’Œ v2 åˆ—åˆ†åˆ«é‡å‘½åä¸º class_label å’Œ messageï¼ŒåŒæ—¶å»æ‰å…¶ä½™çš„åˆ—ã€‚</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="24b6" class="ma kp it lw b gy mb mc l md me">import pandas as pd<br/>df = pd.read_csv(r'spam.csv',encoding='ISO-8859-1')<br/>df.rename(columns = {'v1':'class_label', 'v2':'message'}, inplace = True)<br/>df.drop(['Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4'], axis = 1, inplace = True)</span><span id="3786" class="ma kp it lw b gy mf mc l md me">df</span></pre><figure class="lr ls lt lu gt mh gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/d2900da2d48e333e6817f6957991066b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*sUR5ZF9GiqLstnqCUaVfqw.png"/></div></figure><p id="f2aa" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">çœ‹çœ‹â€œ5572 è¡Œ x 2 åˆ—â€æ„å‘³ç€æˆ‘ä»¬çš„æ•°æ®é›†æœ‰ 5572 æ¡çŸ­ä¿¡ï¼</p><h1 id="3160" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">2.æµè§ˆæ•°æ®é›†:æ¡å½¢å›¾</h1><p id="a997" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">åœ¨å¼€å§‹å¤„ç†æ•°æ®ä¹‹å‰ï¼Œåœ¨åˆ†ç±»é—®é¢˜ä¸­æ‰§è¡Œä¸€äº›æ¢ç´¢æ€§æ•°æ®åˆ†æ(EDA)æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œä»¥ä¾¿å¯è§†åŒ–ã€ä»ä¸­è·å–ä¸€äº›ä¿¡æ¯æˆ–æ‰¾åˆ°æ•°æ®çš„ä»»ä½•é—®é¢˜ã€‚æˆ‘ä»¬å°†æŸ¥çœ‹æˆ‘ä»¬æœ‰å¤šå°‘åƒåœ¾é‚®ä»¶ï¼Œå¹¶ä¸ºå…¶åˆ›å»ºä¸€ä¸ªæ¡å½¢å›¾ã€‚</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="baf8" class="ma kp it lw b gy mb mc l md me">#exploring the dataset</span><span id="64cb" class="ma kp it lw b gy mf mc l md me">df['class_label'].value_counts()</span></pre><figure class="lr ls lt lu gt mh gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/7bebee07a6ac8327b5fa18bd4c2dd5c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*Iz7x-8dki4OsM4vSfR2RFA.png"/></div></figure><p id="dc12" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æˆ‘ä»¬çš„æ•°æ®é›†æœ‰ 4825 å°åƒåœ¾é‚®ä»¶å’Œ 747 å°åƒåœ¾é‚®ä»¶ã€‚è¿™æ˜¯ä¸€ä¸ªä¸å¹³è¡¡çš„æ•°æ®é›†ï¼›ç«è…¿ä¿¡æ¯çš„æ•°é‡è¿œè¿œé«˜äºåƒåœ¾ä¿¡æ¯çš„æ•°é‡ï¼è¿™å¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬çš„æ¨¡å‹æœ‰åå·®ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æˆ‘ä»¬çš„æ•°æ®è¿›è¡Œé‡æ–°é‡‡æ ·ï¼Œä»¥è·å¾—ç›¸åŒæ•°é‡çš„åƒåœ¾é‚®ä»¶ã€‚</p><p id="e106" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ä¸ºäº†ç”Ÿæˆæ¡å½¢å›¾ï¼Œæˆ‘ä»¬ä½¿ç”¨ Matplotlib ä¸­çš„ NumPy å’Œ pyplotã€‚</p><figure class="lr ls lt lu gt mh gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/5d3a79aed41b2cbc07f1ebc55367f56d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*xkrpe4Ew5Jb8El66K0gWtw.png"/></div></figure><h1 id="0c84" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">3.æ¢ç´¢æ•°æ®é›†:å•è¯äº‘</h1><p id="8c4f" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">åœ¨æˆ‘çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ç”Ÿæˆäº†åƒåœ¾é‚®ä»¶ä¸­æœ€å¸¸å‡ºç°çš„å•è¯çš„å•è¯äº‘ã€‚</p><p id="d500" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä»æ•°æ®é›†ä¸­è¿‡æ»¤æ‰æ‰€æœ‰åƒåœ¾é‚®ä»¶ã€‚df_spam æ˜¯ä¸€ä¸ªåªåŒ…å«åƒåœ¾æ¶ˆæ¯çš„æ•°æ®å¸§ã€‚</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="9d9e" class="ma kp it lw b gy mb mc l md me">df_spam = df[df.class_label=='spam']</span><span id="920d" class="ma kp it lw b gy mf mc l md me">df_spam</span></pre><figure class="lr ls lt lu gt mh gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/df1cafe516c916709c9a9ab12313dfb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*Ii033N655R8fCK7G8b7NMA.png"/></div></figure><p id="1537" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æŠŠæ•°æ®å¸§è½¬æ¢æˆä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯åƒåœ¾æ¶ˆæ¯ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ è¿æ¥æˆä¸€ä¸ªå¤§çš„åƒåœ¾é‚®ä»¶å­—ç¬¦ä¸²ã€‚è¯¥å­—ç¬¦ä¸²çš„å°å†™å½¢å¼æ˜¯æˆ‘ä»¬åˆ›å»ºå•è¯äº‘æ‰€éœ€çš„æ ¼å¼ã€‚</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="453d" class="ma kp it lw b gy mb mc l md me">spam_list= df_spam['message'].tolist()</span><span id="40c5" class="ma kp it lw b gy mf mc l md me">filtered_spam = filtered_spam.lower()</span></pre><p id="b158" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æœ€åï¼Œæˆ‘ä»¬å°†å¯¼å…¥ç›¸å…³çš„åº“ï¼Œå¹¶å°†æˆ‘ä»¬çš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ä¼ å…¥:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="b21f" class="ma kp it lw b gy mb mc l md me">import os<br/>from wordcloud import WordCloud<br/>from PIL import Image</span><span id="60f2" class="ma kp it lw b gy mf mc l md me">comment_mask = np.array(Image.open("comment.png"))<br/>#create and generate a word cloud image<br/>wordcloud = WordCloud(max_font_size = 160, margin=0, mask = comment_mask, background_color = "white", colormap="Reds").generate(filtered_spam)</span></pre><p id="1a7b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ˜¾ç¤ºå:</p><figure class="lr ls lt lu gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mn"><img src="../Images/efa6b1d18195eadb0a7f05a67ad6d5dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_h-9R05TGjciymCZ5f37Iw.png"/></div></div></figure><p id="4bff" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¾ˆé…·å§ã€‚åœ¨æˆ‘ä»¬çš„æ•°æ®é›†ä¸­ï¼Œåƒåœ¾çŸ­ä¿¡ä¸­æœ€å¸¸è§çš„è¯æ˜¯â€œå…è´¹â€ã€â€œç«‹å³æ‰“ç”µè¯â€ã€â€œè®¤é¢†â€ã€â€œä¸­å¥–â€ç­‰ã€‚</p><p id="e033" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">å¯¹äºè¿™ä¸ªå•è¯äº‘ï¼Œæˆ‘ä»¬éœ€è¦æ•å¤´åº“ï¼Œåªæ˜¯å› ä¸ºæˆ‘ä½¿ç”¨äº†é®ç½©æ¥åˆ›å»ºæ¼‚äº®çš„è¯­éŸ³æ°”æ³¡å½¢çŠ¶ã€‚å¦‚æœæ‚¨å¸Œæœ›å®ƒæ˜¯æ–¹å½¢çš„ï¼Œè¯·çœç•¥ mask å‚æ•°ã€‚</p><p id="a818" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç±»ä¼¼åœ°ï¼Œå¯¹äºä¸šä½™æ¶ˆæ¯:</p><figure class="lr ls lt lu gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi ms"><img src="../Images/ac2f58c355b1b2db1b4d5e7244c2716f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1gpUzCturYN6KX40QnRBQQ.png"/></div></div></figure><h1 id="16a2" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">4.å¤„ç†ä¸å¹³è¡¡çš„æ•°æ®é›†</h1><p id="70a4" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">è¦å¤„ç†ä¸å¹³è¡¡çš„æ•°æ®ï¼Œæ‚¨æœ‰å¤šç§é€‰æ‹©ã€‚æˆ‘åœ¨æˆ‘çš„é¡¹ç›®ä¸­å¾—åˆ°äº†ä¸€ä¸ªç›¸å½“å¥½çš„ f å€¼ï¼Œå³ä½¿æ˜¯æœªé‡‡æ ·çš„æ•°æ®ï¼Œä½†æ˜¯å¦‚æœä½ æƒ³é‡æ–°é‡‡æ ·ï¼Œè¯·çœ‹<a class="ae mt" href="https://elitedatascience.com/imbalanced-classes" rel="noopener ugc nofollow" target="_blank">è¿™ä¸ª</a>ã€‚</p><h1 id="0f7c" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">5.åˆ†å‰²æ•°æ®é›†</h1><p id="e125" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬å°†ç±»æ ‡ç­¾ä»å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—å½¢å¼:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="075c" class="ma kp it lw b gy mb mc l md me">df['class_label'] = df['class_label'].apply(lambda x: 1 if x == 'spam' else 0)</span></pre><p id="fc94" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å°†æ•°æ®åˆ†æˆä¸¤ä¸ªå­é›†â€”â€”è®­ç»ƒå’Œæµ‹è¯•ã€‚æˆ‘ä»¬å°†è®­ç»ƒé›†ä»¥åŠå®ƒçš„å·²çŸ¥è¾“å‡ºå€¼(åœ¨æœ¬ä¾‹ä¸­ï¼Œ0 æˆ– 1 å¯¹åº”äºåƒåœ¾é‚®ä»¶æˆ–ç«è…¿)æä¾›ç»™æˆ‘ä»¬çš„æ¨¡å‹ï¼Œä»¥ä¾¿å®ƒå­¦ä¹ æˆ‘ä»¬æ•°æ®ä¸­çš„æ¨¡å¼ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨æµ‹è¯•é›†æ¥è·å¾—æ¨¡å‹åœ¨è¿™ä¸ªå­é›†ä¸Šçš„é¢„æµ‹æ ‡ç­¾ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åˆ†å‰²æˆ‘ä»¬çš„æ•°æ®ã€‚</p><p id="4cc2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬ä» sklearn åº“ä¸­å¯¼å…¥ç›¸å…³çš„æ¨¡å—:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="773e" class="ma kp it lw b gy mb mc l md me">from sklearn.model_selection import train_test_split</span></pre><p id="392b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç„¶åæˆ‘ä»¬åˆ†å¼€:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="3572" class="ma kp it lw b gy mb mc l md me">x_train, x_test, y_train, y_test = train_test_split(df['message'], df['class_label'], test_size = 0.3, random_state = 0)</span></pre><p id="1197" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„æµ‹è¯•å’Œè®­ç»ƒå­é›†æœ‰å¤šå°‘æ¡æ¶ˆæ¯:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="830f" class="ma kp it lw b gy mb mc l md me">print('rows in test set: ' + str(x_test.shape))<br/>print('rows in train set: ' + str(x_train.shape))</span></pre><figure class="lr ls lt lu gt mh gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/f5a487a746102f54ff7bda5df100c33d.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*7rVnAzCA5O0Bu5voCjApOQ.png"/></div></figure><p id="c27d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æ‰€ä»¥æˆ‘ä»¬æœ‰ 1672 æ¡æ¶ˆæ¯ç”¨äºæµ‹è¯•ï¼Œ3900 æ¡æ¶ˆæ¯ç”¨äºè®­ç»ƒï¼</p><h1 id="1997" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">6.åº”ç”¨ Tf-IDF çŸ¢é‡å™¨è¿›è¡Œç‰¹å¾æå–</h1><p id="3a64" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">æˆ‘ä»¬çš„æœ´ç´ è´å¶æ–¯æ¨¡å‹è¦æ±‚æ•°æ®è¦ä¹ˆåœ¨ Tf-IDF å‘é‡ä¸­ï¼Œè¦ä¹ˆåœ¨å•è¯å‘é‡è®¡æ•°ä¸­ã€‚åè€…æ˜¯ä½¿ç”¨è®¡æ•°çŸ¢é‡å™¨å®ç°çš„ï¼Œä½†æˆ‘ä»¬å°†é€šè¿‡ä½¿ç”¨ Tf-IDF çŸ¢é‡å™¨è·å¾—å‰è€…ã€‚</p><p id="4ffe" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">Tf-IDF çŸ¢é‡å™¨ä¸ºçŸ­ä¿¡ä¸­çš„æ¯ä¸ªå•è¯åˆ›å»º TF-IDF å€¼ã€‚Tf-IDF å€¼çš„è®¡ç®—æ–¹å¼æ˜¯ä¸ºå‡ºç°é¢‘ç‡è¾ƒä½çš„è¯èµ‹äºˆè¾ƒé«˜çš„å€¼ï¼Œä»¥ä¾¿ç”±äºè‹±è¯­è¯­æ³•è€Œå‡ºç°å¤šæ¬¡çš„è¯ä¸ä¼šæ©ç›–å‡ºç°é¢‘ç‡è¾ƒä½ä½†æ›´æœ‰æ„ä¹‰å’Œæœ‰è¶£çš„è¯ã€‚</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="4a44" class="ma kp it lw b gy mb mc l md me">lst = x_train.tolist()<br/>vectorizer = TfidfVectorizer(<br/>input= lst ,  # input is the actual text<br/>lowercase=True,      # convert to lowercase before tokenizing<br/>stop_words='english' # remove stop words<br/>)</span><span id="1be0" class="ma kp it lw b gy mf mc l md me">features_train_transformed = vectorizer.fit_transform(list) #gives tf idf vector for x_train<br/>features_test_transformed  = vectorizer.transform(x_test) #gives tf idf vector for x_test</span></pre><h1 id="6e8a" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">7.è®­ç»ƒæˆ‘ä»¬çš„æœ´ç´ è´å¶æ–¯æ¨¡å‹</h1><p id="c4fd" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">æˆ‘ä»¬å°†æˆ‘ä»¬çš„æœ´ç´ è´å¶æ–¯æ¨¡å‹(ä¹Ÿç§°ä¸ºå¤šé¡¹å¼)æ‹Ÿåˆåˆ° x_train çš„ Tf-IDF çŸ¢é‡ç‰ˆæœ¬ï¼Œå¹¶å°†çœŸå®è¾“å‡ºæ ‡ç­¾å­˜å‚¨åœ¨ y_train ä¸­ã€‚</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="fd60" class="ma kp it lw b gy mb mc l md me">from sklearn.naive_bayes import MultinomialNB<br/># train the model<br/>classifier = MultinomialNB()<br/>classifier.fit(features_train_transformed, y_train)</span></pre><figure class="lr ls lt lu gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mv"><img src="../Images/0f3c5e00449cb1413753b285b0ec1358.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fdkjyznmQdRmaxAtShaDew.png"/></div></div></figure><h1 id="1b90" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">8.æ£€æŸ¥ç²¾ç¡®åº¦å’Œ f å€¼</h1><p id="d528" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">æ˜¯æ—¶å€™ä¼ å…¥æˆ‘ä»¬å¯¹åº”äº x_test çš„ Tf-IDF çŸ©é˜µï¼Œä»¥åŠçœŸå®çš„è¾“å‡ºæ ‡ç­¾(y_test)äº†ï¼Œæ¥çœ‹çœ‹æˆ‘ä»¬çš„æ¨¡å‹åšå¾—æœ‰å¤šå¥½ï¼</p><p id="f28f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ¨¡å‹çš„å‡†ç¡®æ€§:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="3e53" class="ma kp it lw b gy mb mc l md me">print("classifier accuracy {:.2f}%".format(classifier.score(features_test_transformed, y_test) * 100))</span></pre><figure class="lr ls lt lu gt mh gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/0099b3e4efae7b8227b0304236e07701.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*bnuH-b-mINB4qO8nE0CT1Q.png"/></div></figure><p id="85ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æˆ‘ä»¬çš„å‡†ç¡®åº¦å¾ˆé«˜ï¼ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬çš„æ¨¡å‹å˜å¾—æœ‰åå·®ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æŒ‡æ ‡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ‰§è¡Œä¸‹ä¸€æ­¥ã€‚</p><h1 id="f2a0" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">9.æŸ¥çœ‹æ··æ·†çŸ©é˜µå’Œåˆ†ç±»æŠ¥å‘Š</h1><p id="dfd8" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬çš„æ··æ·†çŸ©é˜µå’Œ f-measure åˆ†æ•°ï¼Œä»¥<em class="mx">ç¡®è®¤</em>æˆ‘ä»¬çš„æ¨¡å‹æ˜¯å¦æ­£å¸¸:</p><pre class="lr ls lt lu gt lv lw lx ly aw lz bi"><span id="df9f" class="ma kp it lw b gy mb mc l md me">labels = classifier.predict(features_test_transformed)<br/>from sklearn.metrics import f1_score<br/>from sklearn.metrics import confusion_matrix<br/>from sklearn.metrics import accuracy_score<br/>from sklearn.metrics import classification_report</span><span id="d254" class="ma kp it lw b gy mf mc l md me">actual = y_test.tolist()<br/>predicted = labels<br/>results = confusion_matrix(actual, predicted)<br/>print('Confusion Matrix :')<br/>print(results)<br/>print ('Accuracy Score :',accuracy_score(actual, predicted))<br/>print ('Report : ')<br/>print (classification_report(actual, predicted) )<br/>score_2 = f1_score(actual, predicted, average = 'binary')<br/>print('F-Measure: %.3f' % score_2)</span></pre><figure class="lr ls lt lu gt mh gh gi paragraph-image"><div class="gh gi my"><img src="../Images/f13fcad76de0b6f5b2b2c5c3cb521297.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*zvcwTqsw3wIHtc1RRhvOIw.png"/></div></figure><p id="80e2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">æˆ‘ä»¬çš„ f å€¼æ˜¯ 0.853ï¼Œæˆ‘ä»¬çš„æ··æ·†çŸ©é˜µæ˜¾ç¤ºæˆ‘ä»¬çš„æ¨¡å‹åªåšäº† 61 ä¸ªé”™è¯¯çš„åˆ†ç±»ã€‚åœ¨æˆ‘çœ‹æ¥ç›¸å½“ä¸é”™ğŸ˜Š</p><h1 id="e0cc" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">10.æˆ‘ä»¬æ··æ·†çŸ©é˜µçš„çƒ­å›¾(å¯é€‰)</h1><p id="0c0f" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">æ‚¨å¯ä»¥ä½¿ç”¨ seaborn åº“åˆ›å»ºä¸€ä¸ªçƒ­å›¾æ¥å¯è§†åŒ–æ‚¨çš„æ··æ·†çŸ©é˜µã€‚ä¸‹é¢çš„ä»£ç å°±æ˜¯è¿™ä¹ˆåšçš„ã€‚</p><figure class="lr ls lt lu gt mh gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/0b53e87c0b9d4126eb4df63bd9a07008.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*Ya5odVkCA4TtEcWMYdTmxQ.png"/></div></figure><p id="1121" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">è¿™å°±æ˜¯åˆ¶ä½œä½ è‡ªå·±çš„åƒåœ¾é‚®ä»¶åˆ†ç±»å™¨ï¼æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬å¯¼å…¥äº†æ•°æ®é›†å¹¶å¯¹å…¶è¿›è¡Œäº†å¯è§†åŒ–ã€‚ç„¶åæˆ‘ä»¬æŠŠå®ƒåˆ†æˆ train/testï¼Œè½¬æ¢æˆ Tf-IDF å‘é‡ã€‚æœ€åï¼Œæˆ‘ä»¬è®­ç»ƒäº†æˆ‘ä»¬çš„æœ´ç´ è´å¶æ–¯æ¨¡å‹ï¼Œå¹¶çœ‹åˆ°äº†ç»“æœï¼å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥æ›´è¿›ä¸€æ­¥ï¼ŒæŠŠå®ƒéƒ¨ç½²æˆä¸€ä¸ª web åº”ç”¨ç¨‹åºã€‚</p></div><div class="ab cl na nb hx nc" role="separator"><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf ng"/><span class="nd bw bk ne nf"/></div><div class="im in io ip iq"><h2 id="38ae" class="ma kp it bd kq nh ni dn ku nj nk dp ky kb nl nm lc kf nn no lg kj np nq lk nr bi translated">å‚è€ƒèµ„æ–™/èµ„æº:</h2><p id="0c45" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">[1] <strong class="js iu"> </strong> D. Tï¼Œæ··æ·†çŸ©é˜µå¯è§†åŒ–(2019)ï¼Œ<a class="ae mt" href="https://medium.com/@dtuk81/confusion-matrix-visualization-fc31e3f30fea" rel="noopener">https://medium . com/@ dtuk 81/æ··æ·†-çŸ©é˜µ-å¯è§†åŒ–-fc31e3f30fea </a></p><ol class=""><li id="6b1b" class="ns nt it js b jt ju jx jy kb nu kf nv kj nw kn nx ny nz oa bi translated">C.æ–‡æ–¯ï¼Œ<strong class="js iu"> </strong>æœ´ç´ è´å¶æ–¯åƒåœ¾é‚®ä»¶åˆ†ç±»å™¨(2018)ï¼Œ<a class="ae mt" href="https://www.codeproject.com/Articles/1231994/Naive-Bayes-Spam-Classifier" rel="noopener ugc nofollow" target="_blank">https://www . code project . com/Articles/1231994/Naive-Bayes-Spam-Classifier</a></li><li id="c08c" class="ns nt it js b jt ob jx oc kb od kf oe kj of kn nx ny nz oa bi translated">H.Attriï¼Œ<strong class="js iu"> </strong>ä½¿ç”¨ TF-IDF ç®—æ³•çš„ç‰¹å¾æå–(2019)ï¼Œ<a class="ae mt" href="https://medium.com/@hritikattri10/feature-extraction-using-tf-idf-algorithm-44eedb37305e" rel="noopener">https://medium . com/@ hritikattri 10/Feature-Extraction-using-TF-IDF-algorithm-44 eedb 37305 e</a></li><li id="6c7e" class="ns nt it js b jt ob jx oc kb od kf oe kj of kn nx ny nz oa bi translated">A.Bronshteinï¼ŒPython ä¸­çš„è®­ç»ƒ/æµ‹è¯•æ‹†åˆ†å’Œäº¤å‰éªŒè¯(2017)ï¼Œ<a class="ae mt" rel="noopener" target="_blank" href="/train-test-split-and-cross-validation-in-python-80b61beca4b6">https://towardsdatascience . com/Train-Test-Split-and-Cross-Validation-in-Python-80 b 61 beca 4 b 6</a></li><li id="23fa" class="ns nt it js b jt ob jx oc kb od kf oe kj of kn nx ny nz oa bi translated"><strong class="js iu">æ•°æ®é›†</strong>:<a class="ae mt" href="https://www.kaggle.com/uciml/sms-spam-collection-dataset" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/uciml/sms-spam-collection-dataset</a></li><li id="f188" class="ns nt it js b jt ob jx oc kb od kf oe kj of kn nx ny nz oa bi translated"><strong class="js iu">å®Œæ•´ä»£ç </strong>:<a class="ae mt" href="https://github.com/samimakhan/Spam-Classification-Project/tree/master/Naive-Bayes" rel="noopener ugc nofollow" target="_blank">https://github . com/samimakhan/Spam-Classification-Project/tree/master/Naive-Bayes</a></li></ol></div></div>    
</body>
</html>