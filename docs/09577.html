<html>
<head>
<title>Recommender System — Matrix Factorization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推荐系统——矩阵分解</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/recommendation-system-matrix-factorization-d61978660b4b?source=collection_archive---------1-----------------------#2020-07-08">https://towardsdatascience.com/recommendation-system-matrix-factorization-d61978660b4b?source=collection_archive---------1-----------------------#2020-07-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/183fb287eec1e3e50eafd068f9717dfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tdcn6sxdPRemUvFOnMAX1g.jpeg"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://www.freepik.com/free-photo/technological-device-with-netfilx-app_3380678.htm#page=1&amp;query=netflix&amp;position=3" rel="noopener ugc nofollow" target="_blank">freepik.com</a>拍摄</p></figure><p id="3cf3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi lb translated"><span class="l lc ld le bm lf lg lh li lj di"> R </span> ecommender 系统在亚马逊、UberEats、网飞和 Youtube 等多个领域得到应用。</p><blockquote class="lk ll lm"><p id="22a5" class="kd ke ln kf b kg kh ki kj kk kl km kn lo kp kq kr lp kt ku kv lq kx ky kz la ij bi translated"><strong class="kf ir"> <em class="iq">协同过滤:</em> </strong> <em class="iq">协同过滤是发现用户过去行为上的相似之处，并基于与其他用户相似的偏好对用户做出预测。该模型然后被用于预测用户可能感兴趣的项目(或项目的评级)。</em></p><p id="e70b" class="kd ke ln kf b kg kh ki kj kk kl km kn lo kp kq kr lp kt ku kv lq kx ky kz la ij bi translated"><strong class="kf ir"> <em class="iq">基于内容的过滤:</em> </strong> <em class="iq">基于内容的过滤用于根据项目的特征产生项目推荐。</em></p></blockquote><p id="474b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，您将学习推荐系统的矩阵分解算法:</p><p id="75f5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">(1)矩阵分解的介绍</p><p id="9fb3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">(2)矩阵分解的数学概念</p><p id="e38c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">(python 代码对矩阵分解的实践经验</p><h2 id="ee30" class="lr ls iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">矩阵分解导论</h2><p id="99cc" class="pw-post-body-paragraph kd ke iq kf b kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">矩阵分解是两种不同实体相乘时生成潜在特征的一种方式。协同过滤是矩阵分解的应用，用于识别项目和用户实体之间的关系。通过输入用户对商店商品的评级，我们希望预测用户将如何对商品进行评级，以便用户可以基于预测获得推荐。</p><p id="816c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设我们有 5 个用户和 5 部电影的客户评级表，评级是从 1 到 5 的整数，矩阵由下表提供。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/3928b6ac65468ebb74be38c0ecf56c9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jxSZEUlH081c-weZS1H1Gg.png"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">表 1-用户对电影的评分表</p></figure><p id="5ea5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为不是每个用户都给所有电影评级，所以矩阵中有许多缺失值，这导致了稀疏矩阵。因此，用户没有给出的空值将用 0 填充，以便为乘法运算提供填充的值。例如，当电影由他们最喜欢的男演员和女演员表演或者电影类型是动作片时，两个用户给某个动作高的评价，等等。从上表中我们可以发现，用户 1 和用户 3 都给了《move2》和《movie3》很高的评价。因此，从矩阵分解中，我们能够发现这些潜在特征，以给出关于用户偏好和交互的相似性的评级预测。</p><p id="bba3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">给定一个场景，用户 4 没有给电影 4 评级。我们想知道用户 4 是否喜欢电影 4。该方法是通过获取对电影 4 具有相似偏好的用户给出的评级来发现与用户 4 具有相似偏好的其他用户，并预测用户 4 是否喜欢电影 4。</p><h2 id="70a7" class="lr ls iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">矩阵分解的数学概念</h2><p id="2536" class="pw-post-body-paragraph kd ke iq kf b kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">定义一组用户(U)、项目(D)、R 大小|U|和|D|。矩阵|U|*|D|包括用户给出的所有评级。目标是发现潜在的特征。给定两个矩阵 P (|U|*k)和 Q (|D|*k)的输入，它将生成乘积结果 r。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/0c391acbaef5321ca37838e381101006.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*GMZcj4GrpyeYYYXfUjItwA.png"/></div></div></figure><p id="0972" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">矩阵 P 表示用户和特征之间的关联，而矩阵 Q 表示项目和特征之间的关联。通过计算 u_i 和 d_j 对应的两个向量的点积，我们可以得到对一个项目评分的预测。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/934b83676d873c8d6da13a71d0ec938a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*bfag_KKHukbSaGBCVpp1Rg.png"/></div></div></figure><p id="46dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了获得 P 和 Q 的两个实体，我们需要初始化这两个矩阵，并计算名为矩阵 m 的乘积的差。接下来，我们通过迭代来最小化差。该方法被称为<strong class="kf ir">梯度下降</strong>，旨在找到差异的局部最小值。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/69b685f4e66a083cf667986412429404.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VyRq_SNz7CTIPW10fCRWgg.png"/></div></div></figure><p id="90ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了使误差最小化，梯度能够使误差最小化，因此我们分别对上述方程的这两个变量进行微分。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/e1eec694b12bba8c48729612f3f8afff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zQ2qL_eUdw6Y_nXPItou9A.png"/></div></div></figure><p id="be5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据梯度，可以更新 p_ik 和 q_kj 的数学公式。a 是计算梯度时达到最小值的步长，a 通常设置为小值。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/a1ca0a13c0ff11e5b892973819fc319d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aIKCpXdgFRUec5DrFllZpQ.png"/></div></div></figure><p id="6a38" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据上面的等式，p'_ik 和 q'_kj 都可以通过迭代更新，直到误差收敛到最小值。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/6cb17260cb4dd33b20f22a3c8451f005.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cEUZ-2rCfC2TQ_v7gReAag.png"/></div></div></figure><h2 id="c36d" class="lr ls iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">矩阵分解的例子</h2><p id="c5f3" class="pw-post-body-paragraph kd ke iq kf b kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">用户和物品矩阵的点积可以生成评分矩阵，而用户矩阵是 k(用户)* f(特征)的形状，物品矩阵是 j(物品)* f(特征)的形状。从用户和项目的矩阵中，电影的特征可以是其类型、演员、情节等。有了分解矩阵的两个特征，让我们假设 F1 是“这部电影是不是喜剧？”F2 为“如果罗宾·威廉姆斯出演这部电影？”</p><p id="6973" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">用户矩阵:</strong>根据用户 1 的说法，如果这是一部喜剧电影，他会给它 4 分，如果罗宾·威廉姆斯是这部电影的演员，他会给它 3 分。</p><p id="b905" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">项目矩阵:</strong>项目矩阵中主要有二进制值，当满足上述特征的条件时为 1，否则为 0。通过执行用户矩阵和项目矩阵的点积，<em class="ln">将生成评级矩阵。</em></p><blockquote class="lk ll lm"><p id="dea0" class="kd ke ln kf b kg kh ki kj kk kl km kn lo kp kq kr lp kt ku kv lq kx ky kz la ij bi translated">当数学成本函数<strong class="kf ir"> RMSE </strong>通过矩阵分解最小化时，可以生成用户和项目矩阵的矩阵分解。根据上述数学概念，梯度下降是通过每次迭代最小化 RMSE 的方法之一。</p></blockquote><h2 id="d961" class="lr ls iq bd lt lu lv dn lw lx ly dp lz ko ma mb mc ks md me mf kw mg mh mi mj bi translated">矩阵分解的实用 Python 代码</h2><p id="6742" class="pw-post-body-paragraph kd ke iq kf b kg mk ki kj kk ml km kn ko mm kq kr ks mn ku kv kw mo ky kz la ij bi translated">下面是执行梯度下降算法的 python 代码片段。我们用 6 个用户给出的 4 部电影设置了一个评级矩阵。如你所见，有些用户之前没有看一些电影，所以在评分中给出的评分为 0。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="4e1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">预测矩阵生成如下。如您所见，预测矩阵具有与真实值相似的输出，0 评级被基于相似用户对电影的偏好的预测所取代。</p><p id="3e51" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到，对于现有的评级，我们有非常接近真实值的近似值，我们还可以获得一些未知值的“预测”。给定特征为 3 时，算法能够将用户和项目与三个不同的特征相关联，并且预测也遵循这些关联。我们可以发现，U2、U5 和 U6 对 M1 和 M2 给予低评级，而对 M3 给予高评级。即使 U5 没有看 M1，我们也会进一步推断 U5 可能不喜欢 M1。</p><figure class="mq mr ms mt gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="7716" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在现实世界中，评级矩阵非常稀疏，因为每个用户都以不同的频率观看电影。但是，误差函数 RMSE 仅使用非空等级进行计算。评级矩阵中缺失的条目将由因素矩阵的点积代替。因此，我们知道如何根据预测向用户推荐未看过的电影。</p><h1 id="f0f9" class="nc ls iq bd lt nd ne nf lw ng nh ni lz nj nk nl mc nm nn no mf np nq nr mi ns bi translated">总之:</h1><ul class=""><li id="f703" class="nt nu iq kf b kg mk kk ml ko nv ks nw kw nx la ny nz oa ob bi translated">矩阵分解是一种协同过滤方法，用于发现项目和用户实体之间的关系。潜在特征，即用户和电影矩阵之间的关联，被确定来寻找相似性并基于项目和用户实体进行预测</li><li id="72ad" class="nt nu iq kf b kg oc kk od ko oe ks of kw og la ny nz oa ob bi translated">当数学成本函数<strong class="kf ir"> RMSE </strong>通过矩阵分解被最小化时，可以生成用户和项目矩阵的矩阵分解。梯度下降是一种最小化成本函数的方法。</li></ul><h1 id="81bb" class="nc ls iq bd lt nd ne nf lw ng nh ni lz nj nk nl mc nm nn no mf np nq nr mi ns bi translated">参考:</h1><ol class=""><li id="200d" class="nt nu iq kf b kg mk kk ml ko nv ks nw kw nx la oh nz oa ob bi translated">矩阵分解:<a class="ae kc" href="http://www.quuxlabs.com/blog/2010/09/matrix-factorization-a-simple-tutorial-and-implementation-in-python/" rel="noopener ugc nofollow" target="_blank">http://www . quux labs . com/blog/2010/09/matrix-Factorization-a-simple-tutorial-and-implementation-in-python/</a></li></ol><p id="1f4e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.推荐系统:<a class="ae kc" href="https://medium.com/sfu-cspmp/recommendation-systems-collaborative-filtering-using-matrix-factorization-simplified-2118f4ef2cd3" rel="noopener">https://medium . com/sfu-cspmp/recommendation-Systems-collaborative-filtering-using-matrix-factorization-simplified-2118 F4 ef 2c D3</a></p></div></div>    
</body>
</html>