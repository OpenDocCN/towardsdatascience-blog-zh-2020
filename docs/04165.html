<html>
<head>
<title>Use Google Sheets, S3, and Python to Build a Website Quickly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用谷歌工作表，S3和Python快速建立一个网站</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/use-google-sheets-s3-and-python-to-build-a-website-quickly-8e4501dab02e?source=collection_archive---------8-----------------------#2020-04-16">https://towardsdatascience.com/use-google-sheets-s3-and-python-to-build-a-website-quickly-8e4501dab02e?source=collection_archive---------8-----------------------#2020-04-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a502" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">非web开发人员生存指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/93314516bd64b1f7cd5b21a9f22e30a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kjQ7Fd680PuEkuxI.jpg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com/" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae kv" href="https://unsplash.com/@barnimages" rel="noopener ugc nofollow" target="_blank"> barnimages </a>拍摄的照片</p></figure><p id="1cc7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我们开始之前，先介绍一些背景知识:</p><p id="9532" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">几天前，我在寻找因新冠肺炎而免费或打折的课程。我想其他人可能也在这样做，所以我决定收集一些资源并在网上发布。</p><p id="b879" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我开始用Google Sheet编辑课程，并计划在获得足够的资源后分享它。然而，有件事困扰着我。在手机上打开页面很糟糕，大多数人用手机浏览互联网。我以为我能做得更好。</p><p id="1009" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">问题是我在网站开发方面没有什么经验。此外，我不想花费超过几个小时来开发和发布网站。所以我决定快速建造一些东西。</p><p id="2b2f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是我为快速建立网站而设定的要求，以及我为满足这些要求而采取的方法:</p><p id="2a5e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">要求</strong></p><ol class=""><li id="1ddd" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">该网站应该加载速度快，在手机上看起来很好(或者至少比谷歌表更好)</li><li id="237e" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">我需要能够快速、轻松地添加或删除资源。请记住，我可能希望在未来从客户端添加更多的交互性。</li><li id="6208" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">尽可能多地使用Python(尽可能少地使用HTML/CSS/JS)</li><li id="9b7a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">我应该只需要几个小时就可以开发和发布</li><li id="e453" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">维护成本应该<em class="mg">非常非常</em>接近零😛</li></ol><p id="d696" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">接近</strong></p><ol class=""><li id="8278" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">用于引导程序(仅CSS，不包括JS组件)</li><li id="c471" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">使用Google Sheets管理内容。我使用Google Sheets API以编程方式将内容放入站点。如果需要，可以很容易地从Google Sheet创建一个web API。</li><li id="accf" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">使用Jinja2从基本的HTML/CSS模板生成网站</li><li id="90ad" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">在AWS S3 bucket + Cloudfront上托管站点(用于SSL证书)。用53号公路买下了域名</li><li id="7717" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">我对AWS服务的使用属于免费层。我不认为这种情况会很快改变。到目前为止，我只在网站上投资了15€</li></ol><p id="d2dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">几个小时后，我发射了<a class="ae kv" href="https://stayhomeandlearn.org/" rel="noopener ugc nofollow" target="_blank">stayhomeandlearn.org</a>。</p><p id="33e2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本文的其余部分是关于如何使用Google Sheets、AWS和Python构建静态站点的教程。</p><p id="df09" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于本教程，<strong class="ky ir">我们将建立一个从Google Sheets读取数据的脚本，使用预定义的模板生成一个静态站点，并将其部署到S3存储桶。</strong>这篇文章是为那些对web开发知之甚少，但想快速上手的程序员准备的。</p><p id="7352" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">教程中有五个部分:需求，回顾代码和Jinja模板，使用Google Sheets API，构建和部署你的站点。</p><h1 id="a05f" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">要求</h1><p id="88fc" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">这些你需要自己设置或检查。为此，我添加了一些链接。</p><ul class=""><li id="5767" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr ne ly lz ma bi translated"><a class="ae kv" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank"> Python &gt; = 3.7 </a></li><li id="f040" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated"><a class="ae kv" href="https://myaccount.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌账户</a></li><li id="970d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated"><a class="ae kv" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌云平台(GCP)账户</a></li><li id="0a85" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated"><a class="ae kv" href="https://aws.amazon.com/free/" rel="noopener ugc nofollow" target="_blank">亚马逊AWS账户</a></li><li id="f487" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated"><a class="ae kv" href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html" rel="noopener ugc nofollow" target="_blank"> AWS CLI </a>(如果你有Mac的话可以<a class="ae kv" href="https://formulae.brew.sh/formula/awscli" rel="noopener ugc nofollow" target="_blank">使用brew</a>)</li><li id="1de2" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated"><a class="ae kv" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html#cli-quick-configuration" rel="noopener ugc nofollow" target="_blank">在AWS CLI中配置的配置文件</a></li><li id="8c7f" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated">一点<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Introduction_to_HTML/Getting_started" rel="noopener ugc nofollow" target="_blank"> HTML </a>和<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Learn/CSS/First_steps/Getting_started" rel="noopener ugc nofollow" target="_blank"> CSS </a></li></ul><h1 id="68a9" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">代码和Jinja模板</h1><p id="4dcf" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">首先，创建一个名为<code class="fe nf ng nh ni b">my_pokemon_stats</code>的目录，并从那里打开一个终端。然后，创建一个虚拟环境并安装所需的软件包，如下所示:</p><p id="d51b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，在那里下载并保存这两个文件:<a class="ae kv" href="https://gist.github.com/dylanjcastillo/61018bf4474d388e2936a84368d40d07" rel="noopener ugc nofollow" target="_blank">template.html</a>和<a class="ae kv" href="https://gist.github.com/dylanjcastillo/fbbdcb83694c2334714866340442ce18" rel="noopener ugc nofollow" target="_blank"> site_builder.py </a>。这些是生成站点的构建块。</p><p id="0538" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><code class="fe nf ng nh ni b">template.html</code>是我们将用于构建网站的Jinja模板。这是一个类似HTML的文件，您可以在其中添加将用Python处理的逻辑，并生成最终的站点。该文件如下所示:</p><pre class="kg kh ki kj gt nj ni nk nl aw nm bi"><span id="6caf" class="nn mi iq ni b gy no np l nq nr">&lt;!doctype html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>    &lt;meta charset="UTF-8"&gt;<br/>    &lt;meta name="viewport"<br/>          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"&gt;<br/>    &lt;meta http-equiv="X-UA-Compatible" content="ie=edge"&gt;<br/>    &lt;link href="<a class="ae kv" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="noopener ugc nofollow" target="_blank">https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css</a>" rel="stylesheet"<br/>          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous"&gt;<br/>    &lt;title&gt;My Pokemon Stats&lt;/title&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;</span><span id="40a8" class="nn mi iq ni b gy ns np l nq nr">&lt;header id="header"&gt;<br/>    &lt;div class="container text-center"&gt;<br/>        &lt;h1 class="pt-5 pb-1 font-weight-bold"&gt;<br/>            My Pokemon Stats<br/>        &lt;/h1&gt;<br/>        &lt;hr&gt;<br/>        &lt;p class="pt-2"&gt;<br/>            This is a site I use to store the stats of all my Pokemon.<br/>        &lt;/p&gt;<br/>    &lt;/div&gt;<br/>&lt;/header&gt;</span><span id="4156" class="nn mi iq ni b gy ns np l nq nr">&lt;section id="pokemon_table"&gt;<br/>    &lt;div class="container py-4"&gt;<br/>        &lt;div class="table-responsive"&gt;<br/>            &lt;table class="table table-hover"&gt;<br/>                &lt;thead class="thead-dark"&gt;<br/>                &lt;tr&gt;<br/>                    &lt;th scope="col"&gt;Name&lt;/th&gt;<br/>                    &lt;th scope="col"&gt;Type 1&lt;/th&gt;<br/>                    &lt;th scope="col"&gt;Type 2&lt;/th&gt;<br/>                    &lt;th scope="col"&gt;Total&lt;/th&gt;<br/>                    &lt;th scope="col"&gt;HP&lt;/th&gt;<br/>                    &lt;th scope="col"&gt;Attack&lt;/th&gt;<br/>                    &lt;th scope="col"&gt;Defense&lt;/th&gt;<br/>                &lt;/tr&gt;<br/>                &lt;/thead&gt;<br/>                &lt;tbody&gt;<br/>                {% for row in data %}<br/>                &lt;tr&gt;<br/>                    &lt;td&gt;{{ row["Name"] }}&lt;/td&gt;<br/>                    &lt;td&gt;{{ row["Type 1"] }}&lt;/td&gt;<br/>                    &lt;td&gt;{{ row["Type 2"] }}&lt;/td&gt;<br/>                    &lt;td&gt;{{ row["Total"] }}&lt;/td&gt;<br/>                    &lt;td&gt;{{ row["HP"] }}&lt;/td&gt;<br/>                    &lt;td&gt;{{ row["Attack"] }}&lt;/td&gt;<br/>                    &lt;td&gt;{{ row["Defense"] }}&lt;/td&gt;<br/>                &lt;/tr&gt;<br/>                {% endfor %}<br/>                &lt;/tbody&gt;<br/>            &lt;/table&gt;<br/>        &lt;/div&gt;<br/>    &lt;/div&gt;<br/>&lt;/section&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="544f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们来分解一下:</p><ul class=""><li id="305a" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr ne ly lz ma bi translated">您可以放心地忽略<code class="fe nf ng nh ni b">&lt;head&gt;</code>标签中的大部分内容。这是你将在大多数页面中看到的标准HTML5代码。然而，我们将仔细研究两个有趣的标签:<code class="fe nf ng nh ni b">&lt;link&gt;</code>和<code class="fe nf ng nh ni b">&lt;title&gt;</code>。</li><li id="9713" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated">在这种情况下，<code class="fe nf ng nh ni b">&lt;link&gt;</code>标签用于导入<a class="ae kv" href="https://getbootstrap.com/" rel="noopener ugc nofollow" target="_blank">引导</a>组件库。我们将使用它来为页面的不同部分定义简单的样式，并毫不费力地使它看起来很好。<code class="fe nf ng nh ni b">&lt;title&gt;</code>定义页面的标题(你在浏览器标签中看到的)，它对SEO和社交媒体分享很有用。</li><li id="a3e9" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated">接下来，在<code class="fe nf ng nh ni b">&lt;body&gt;</code>标签中有一个<code class="fe nf ng nh ni b">&lt;header&gt;</code>部分。这是我们定义将出现在页面上的文本的地方。它将看起来像下面的图像。我使用了Bootstrap的标准样式来居中文本，并添加了一些填充。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/bc5cecdec53f631ca268259f77cafd8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*71C9RP1NPlMTjJsi.png"/></div></div></figure><ul class=""><li id="af6e" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr ne ly lz ma bi translated">最后，我们有了<code class="fe nf ng nh ni b">&lt;section id="pokemon_table"&gt;</code>。<code class="fe nf ng nh ni b">&lt;div&gt;</code>和<code class="fe nf ng nh ni b">&lt;table&gt;</code>标签为构建表格提供了一些基本的样式。接下来，我们在<code class="fe nf ng nh ni b">&lt;thead&gt;</code>标签中定义表格的标题。标签里面是Jinja施展魔法的地方</li><li id="fb02" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated"><code class="fe nf ng nh ni b">{% for row in data %}</code>是一个循环，遍历口袋妖怪的每一行数据。在每个<code class="fe nf ng nh ni b">&lt;td&gt;{{ row["..."] }}&lt;/td&gt;</code>中，我们从字段中获取每一行的信息(例如名称、类型1、类型2)。这会生成如下所示的内容:</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/749215bda27e199fdf5d4dc3827c78f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GoKi1Wn6CWPKAgOQ.png"/></div></div></figure><p id="aa2a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">接下来，我们有了<code class="fe nf ng nh ni b">site_builder.py</code>文件。这个脚本从Google Sheets下载口袋妖怪的数据，处理数据和<code class="fe nf ng nh ni b">template.html</code>文件，然后将结果文件上传到S3桶。</p><pre class="kg kh ki kj gt nj ni nk nl aw nm bi"><span id="0113" class="nn mi iq ni b gy no np l nq nr">import csv<br/><br/>import boto3<br/>import gspread<br/>import jinja2<br/>from oauth2client.service_account import ServiceAccountCredentials<br/><br/>AWS_PROFILE = "INSERT-AWS-PROFILE-HERE"<br/>BUCKET = "INSERT-BUCKET-NAME-HERE"<br/>WORKBOOK = "INSERT-WORKBOOK-NAME-HERE"<br/><br/><br/>def download_data():<br/>    """Download data using the Google Sheets API"""<br/>    scope = [<br/>        "https://spreadsheets.google.com/feeds",<br/>        "https://www.googleapis.com/auth/drive",<br/>    ]<br/>    credentials = ServiceAccountCredentials.from_json_keyfile_name(<br/>        "credentials.json", scope<br/>    )<br/>    client = gspread.authorize(credentials)<br/><br/>    worksheet = client.open(WORKBOOK).get_worksheet(0)<br/>    sheet_values = worksheet.get_all_values()<br/><br/>    print(f"Downloading: {worksheet.title}")<br/>    with open("my_pokemon_stats.csv", "w") as f:<br/>        writer = csv.writer(f)<br/>        writer.writerows(sheet_values)<br/><br/><br/>def generate_site():<br/>    """Generate site in local directory"""<br/>    print("Process data and build site")<br/><br/>    template_loader = jinja2.FileSystemLoader(searchpath="./")<br/>    template_env = jinja2.Environment(loader=template_loader)<br/>    template = template_env.get_template("template.html")<br/><br/>    with open("my_pokemon_stats.csv") as csv_file:<br/>        csv_reader = csv.DictReader(csv_file)<br/>        data = [row for row in csv_reader]<br/><br/>    output = template.render(data=data)<br/><br/>    with open("index.html", "w") as f:<br/>        f.write(output)<br/><br/><br/>def deploy_site():<br/>    """Deploy site S3 bucket"""<br/>    print("Upload data to S3")<br/>    session = boto3.Session(profile_name=AWS_PROFILE)<br/>    s3 = session.resource("s3")<br/>    s3.Bucket(BUCKET).upload_file(<br/>        Filename="index.html", Key="index.html", ExtraArgs={"ContentType": "text/html"}<br/>    )<br/><br/><br/>if __name__ == "__main__":<br/>    download_data()<br/>    generate_site()<br/>    deploy_site()</span></pre><p id="0d7a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">代码由三个功能构成:<code class="fe nf ng nh ni b">download_sheets</code>、<code class="fe nf ng nh ni b">generate_site</code>和<code class="fe nf ng nh ni b">deploy_site</code>。我们将在接下来的小节中详细介绍如何访问AWS和Google Sheets API。</p><h1 id="dcc2" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">使用Google Sheets API</h1><p id="0baf" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">按照以下步骤使用Google Sheets API下载口袋妖怪的数据:</p><ol class=""><li id="7378" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">在谷歌工作表中创建一个工作簿(你可以复制我的:<a class="ae kv" href="https://docs.google.com/spreadsheets/d/1Q6Gbe1bNoMo12hjtWwEFEaQzxyRKOuYsCfZ9AHLmhy0/edit?usp=sharing" rel="noopener ugc nofollow" target="_blank">我的口袋妖怪统计</a>)</li><li id="d4da" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">进入<a class="ae kv" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌API控制台</a></li><li id="6baa" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">创建一个名为<em class="mg"> MyPokemonStats </em>的新项目。</li><li id="b40a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">点击<em class="mg">启用API和服务</em>。搜索并启用Google Sheets API。</li><li id="999a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">回到<a class="ae kv" href="https://console.developers.google.com/" rel="noopener ugc nofollow" target="_blank">Google API控制台</a>并再次点击<em class="mg">启用API和服务</em>。现在搜索并启用Google Drive API。</li><li id="066d" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">点击<em class="mg">创建凭证。</em> <strong class="ky ir"> <em class="mg"> </em> </strong>下4题选择:<strong class="ky ir"><em class="mg"/></strong><em class="mg">Google Drive API</em>，<em class="mg"> Web服务器(如node.js，Tomcat) </em>，<em class="mg">应用数据，</em>和<em class="mg">不，我不使用它们。</em></li><li id="b49b" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">点击<em class="mg">我需要什么凭证？</em>为服务账户选择一个名称(例如get-data)授予其一个<em class="mg">项目</em>角色<em class="mg">编辑</em>。为<em class="mg">键类型</em>选择<em class="mg"> JSON </em>选项</li><li id="be05" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">将会打开一个对话框。保存JSON文件，复制到<code class="fe nf ng nh ni b">my_pokemon_stats</code>目录，重命名为<code class="fe nf ng nh ni b">credentials.json</code>。</li><li id="e0d9" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">打开<code class="fe nf ng nh ni b">credentials.json</code>文件。找到一个名为<code class="fe nf ng nh ni b">client_email</code>的键，复制它的值(例如get-data@iam....).在Google Sheets中返回到您的工作簿，点击右上角的<em class="mg">共享</em>按钮，将客户电子邮件粘贴到<em class="mg">人员</em>字段，赋予其编辑权限。点击发送。</li><li id="9f43" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">转到<code class="fe nf ng nh ni b">site_builder.py</code>脚本，将<code class="fe nf ng nh ni b">WORKBOOK</code>变量设置为您在第一步中给工作簿起的名字。</li></ol><h1 id="c2cf" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">设置S3时段和与AWS相关的配置</h1><p id="0340" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">现在，让我们创建S3桶，并配置我们的代码以编程方式访问AWS:</p><ol class=""><li id="e9aa" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">前往<a class="ae kv" href="https://console.aws.amazon.com/s3" rel="noopener ugc nofollow" target="_blank">亚马逊S3控制台</a></li><li id="d32f" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">创建S3存储桶</li><li id="050b" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">一旦进入桶中，点击<em class="mg">属性</em>，然后点击<em class="mg">静态网站托管</em></li><li id="a79f" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">选择选项<em class="mg">使用此桶托管网站</em></li><li id="3d50" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">在<em class="mg">索引文件</em>和<em class="mg">错误文件</em>下放置<code class="fe nf ng nh ni b">index.html</code></li><li id="1e79" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">保存来自<em class="mg">端点</em>的URL。您将使用该URL连接到您的站点。</li><li id="239a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">转到<em class="mg">权限</em>并点击<em class="mg">编辑</em></li><li id="6ab1" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">清除<em class="mg">阻止所有公共访问</em>，选择<em class="mg">保存</em>，并确认。当您更改此项时，互联网上的任何人都可以访问此存储桶的内容。当你发布一个网站时，这就是你想要的，但是，不要把任何私人的东西放在那里！</li><li id="78dd" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">现在转到<em class="mg"> Bucket Policy </em>，替换下面策略中的Bucket名称，粘贴到那里，点击Save。</li></ol><pre class="kg kh ki kj gt nj ni nk nl aw nm bi"><span id="262f" class="nn mi iq ni b gy no np l nq nr">{<br/>  "Version":"2012-10-17",<br/>  "Statement":[{<br/> "Sid":"PublicReadGetObject",<br/>        "Effect":"Allow",<br/>   "Principal": "*",<br/>      "Action":["s3:GetObject"],<br/>      "Resource":["arn:aws:s3:::BUCKET-NAME-HERE/*"<br/>      ]<br/>    }<br/>  ]<br/>}</span></pre><p id="9688" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">10.转到<code class="fe nf ng nh ni b">site_builder.py</code>脚本。将变量<code class="fe nf ng nh ni b">AWS_PROFILE</code>变量设置为用于访问AWS的配置文件名称(在UNIX系统中，它应该是<code class="fe nf ng nh ni b">~/.aws/credentials</code>中的一个配置文件)。</p><h1 id="2abe" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">构建和部署您的站点</h1><p id="6d0d" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">最后，您应该能够从项目的根文件夹中运行<code class="fe nf ng nh ni b">python site_builder.py</code>来生成站点。这将从谷歌工作表下载数据，使用Jinja处理<code class="fe nf ng nh ni b">template.html</code>文件，并将网站上传到S3桶。</p><p id="2873" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想要检查站点，请转到端点URL(上一节中的步骤6)。</p><h1 id="9bab" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">结束语</h1><p id="9786" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">这种方法绝不是完美的，但会帮助你快速出货。我用这个策略建造了<a class="ae kv" href="https://stayhomeandlearn.org/" rel="noopener ugc nofollow" target="_blank">stayhomeandlearn.org</a>，效果很好。从4月1日到4月16日，这个网站有超过15000的访问者，这超过了我最乐观的预期。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/49c30c74152f66bd60cc9f9034d9e5a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*IXmgfHxKcXjt5cGG.png"/></div></div></figure><p id="605f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个网站正在慢慢走向死亡。然而，<strong class="ky ir">这个过程教会了我关注运输而不是浪费时间寻找完美的工具有多重要</strong>。我很快建立了网站，人们喜欢它，第一天之后，它的流量已经超过了我迄今为止做过的任何一个附带项目。完美是好的敌人，这是真的。</p><p id="7fa6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我的例子中，出于样式和部署的目的，我必须向脚本添加更多的功能。有兴趣的可以看看我的<a class="ae kv" href="https://github.com/dylanjcastillo/stayhomeandlearn.org" rel="noopener ugc nofollow" target="_blank"> GitHub资源库</a>里的代码。</p><p id="68dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，现在你可以做几件事来让你的网站更有趣:</p><ul class=""><li id="61e0" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr ne ly lz ma bi translated"><a class="ae kv" href="https://victoria.dev/blog/hosting-your-static-site-with-aws-s3-route-53-and-cloudfront/" rel="noopener ugc nofollow" target="_blank">获得自己的域名和SSL证书</a></li><li id="b7c6" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated"><a class="ae kv" href="https://dev.to/milanmaharjan/build-a-custom-contact-form-for-your-static-website-1665" rel="noopener ugc nofollow" target="_blank">使用Google Sheets向您的网站添加联系表单</a></li><li id="f85a" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr ne ly lz ma bi translated"><a class="ae kv" href="https://startbootstrap.com/assets/img/icons/apple-touch-icon.png" rel="noopener ugc nofollow" target="_blank">让它更好看！</a></li></ul><p id="4f0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mg">本文原载于</em> <a class="ae kv" href="https://dylancastillo.co/build-a-site-quickly-using-google-sheets-python-and-aws/" rel="noopener ugc nofollow" target="_blank"> <em class="mg">我的博客</em> </a> <em class="mg">。</em></p><h1 id="5760" class="mh mi iq bd mj mk ml mm mn mo mp mq mr jw ms jx mt jz mu ka mv kc mw kd mx my bi translated">参考</h1><p id="5e1d" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf nb lh li lj nc ll lm ln nd lp lq lr ij bi translated">[1] G. Bauges，<a class="ae kv" href="https://www.twilio.com/blog/2017/02/an-easy-way-to-read-and-write-to-a-google-spreadsheet-in-python.html" rel="noopener ugc nofollow" target="_blank">谷歌电子表格和Python </a> (2017)</p><p id="ab57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[2] V. Drake，H .<a class="ae kv" href="https://victoria.dev/blog/hosting-your-static-site-with-aws-s3-route-53-and-cloudfront/" rel="noopener ugc nofollow" target="_blank">用AWS S3、Route 53和CloudFront </a>固定你的静态站点(2017)</p><p id="71b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">[3] A .巴拉达斯，<a class="ae kv" href="https://www.kaggle.com/abcsds/pokemon" rel="noopener ugc nofollow" target="_blank">口袋妖怪统计</a> (2016)</p></div></div>    
</body>
</html>