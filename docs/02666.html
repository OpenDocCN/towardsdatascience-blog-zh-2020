<html>
<head>
<title>Learn How to (easily!!) do 3 Advanced Excel Tasks in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习如何(轻松！！)用 Python 做 3 个高级 Excel 任务</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learn-how-to-easily-do-3-advanced-excel-tasks-in-python-925a6b7dd081?source=collection_archive---------4-----------------------#2020-03-15">https://towardsdatascience.com/learn-how-to-easily-do-3-advanced-excel-tasks-in-python-925a6b7dd081?source=collection_archive---------4-----------------------#2020-03-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bac1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">面向 Excel 高级用户的熊猫介绍</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/35250202f499bf7054e2430f09391508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0actSjcQFJs7nif0JSJ4PA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">对峙开始了！(来源:Nik Piepenbreier)</p></figure><p id="758e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Excel 是无处不在的数据分析工具——它很容易上手，大多数情况下每个人都有一份，一旦你掌握了它，它就非常强大！与此同时，Python 通常被认为是比较难学的，但是却有无限的潜力。在这篇文章中，我们将探索在 Python 中可以轻松完成的三件事，这三件事你通常在 Excel 中都能做到！</p><p id="ae21" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将从导入 pandas 开始，并根据工作簿中的工作表加载两个数据帧。我们称它们为<em class="lu">销售</em>和<em class="lu">状态</em>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="lv lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将我们的数据集导入熊猫数据框架。</p></figure><p id="bdfb" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">假设我们运行了。head()方法，如下所示:</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="923b" class="mc md it ly b gy me mf l mg mh">print(sales.head())</span></pre><p id="13f8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以将其与 Excel 中的数据进行比较:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/33efc247526684d498254d6ff943fcea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6sGRR_ZucpX7XjZrJtZmbg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">比较数据在 Excel 和 Pandas 中的显示方式(来源:Nik Piepenbreier)</p></figure><p id="e239" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以看到显示的数据与 Excel 显示数据的方式相对相似，但也有一些关键的区别:</p><ul class=""><li id="7fc6" class="mi mj it la b lb lc le lf lh mk ll ml lp mm lt mn mo mp mq bi translated">Excel 从第 1 行开始，而 Pandas 从第 0 行(' index ')开始，</li><li id="b34b" class="mi mj it la b lb mr le ms lh mt ll mu lp mv lt mn mo mp mq bi translated">Excel 用以 A 开头的字母标记列，而 Pandas 用变量名标记列</li></ul><p id="2994" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们开始深入研究如何与熊猫一起完成 Excel 任务。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="af07" class="nd md it bd ne nf ng nh ni nj nk nl nm jz nn ka no kc np kd nq kf nr kg ns nt bi translated">Python 中的 IF 函数</h1><p id="82d8" class="pw-post-body-paragraph ky kz it la b lb nu ju ld le nv jx lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">在 Excel 中使用 IF 函数非常方便，它允许我们根据另一个单元格中的条件应用某个标签。假设我们想要创建一个新列，让我们知道 B 列的单元格中的值是否大于 500。在 Excel 中，我们将 E 列标记为大于 500，我们将进入单元格 E2 并写入:</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="9875" class="mc md it ly b gy me mf l mg mh">=IF([@Sales]&gt;500, "Yes", "No")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/616fff829d65a5654ebc0ed99638a27c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*l8dIywEivfKqg2K8xcvAZw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在 Excel 中应用 IF 函数(来源:Nik Piepenbreier)</p></figure><p id="12b7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们想在 Pandas 中这样做，我们可以使用列表理解来轻松应用相同的 If 语句:</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="8836" class="mc md it ly b gy me mf l mg mh">sales['MoreThan500'] = ['Yes' if x &gt; 500 else 'No' for x in sales['Sales']]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/af2946da70230497f263608273f01dcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z_VRtQE6aDgPIVikunhkkQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">解释的理解列表(资料来源:Nik Piepenbreier)</p></figure><p id="4cf8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">列表理解是这类工作的好工具，它减少了编写复杂 if/else 语句的需要。您可以用 if/else 语句完成同样的事情，但是这样可以节省时间，并使代码更加简洁。你可以通过查看<a class="ae ob" href="https://datagy.io/list-comprehensions-in-python/" rel="noopener ugc nofollow" target="_blank">这篇文章</a>来了解更多关于列表理解的细节。</p><p id="98e8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">想了解更多关于列表理解的知识吗？看看我的视频！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oc lw l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Python 中的列表理解。资料来源:Nik Piepenbreier</p></figure></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="08f6" class="nd md it bd ne nf ng nh ni nj nk nl nm jz nn ka no kc np kd nq kf nr kg ns nt bi translated">熊猫视频</h1><p id="8fe5" class="pw-post-body-paragraph ky kz it la b lb nu ju ld le nv jx lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">在我们的数据集中，城市在一张表上，州/省在另一张表上。这并不理想，但是我们可以在 Excel 中使用 VLOOKUP 来链接数据。VLOOKUP 的工作方式类似于左连接，左数据集中的每个记录都被保留。我们告诉 Excel 在查找表中垂直上下查找某一列中的特定值，然后返回位于该列右侧特定列数的值。</p><p id="f26c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们添加一个名为“State”的列，并使用 VLOOKUP 从<em class="lu"> states </em>表中返回相应的状态。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/4e25656fd19a0651ec7f8d39ec4d2553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*XChzcvLkyHSwiTDSTc5kHQ.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用 VLOOKUP 添加州/省信息(来源:Nik Piepenbreier)</p></figure><p id="f6d4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在 Python 中，我们可以使用 Pandas <em class="lu"> merge </em>函数来完成同样的事情。Merge 获取两个数据帧并将其合并。为此，我们将编写以下代码:</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="bbc9" class="mc md it ly b gy me mf l mg mh">sales = pd.merge(sales, states, how='left', on='City')</span></pre><p id="7825" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们一个论点一个论点地来分析:</p><ol class=""><li id="28b0" class="mi mj it la b lb lc le lf lh mk ll ml lp mm lt od mo mp mq bi translated">第一个参数是原始数据帧</li><li id="3a51" class="mi mj it la b lb mr le ms lh mt ll mu lp mv lt od mo mp mq bi translated">第二个参数是我们要查找值的数据帧</li><li id="433b" class="mi mj it la b lb mr le ms lh mt ll mu lp mv lt od mo mp mq bi translated">如何指定我们要进行的连接类型</li><li id="6ac3" class="mi mj it la b lb mr le ms lh mt ll mu lp mv lt od mo mp mq bi translated">On 指定我们想要合并的变量(如果变量在每个数据帧中被称为不同的东西，还有 left_on 和 right_on)。</li></ol></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="f59a" class="nd md it bd ne nf ng nh ni nj nk nl nm jz nn ka no kc np kd nq kf nr kg ns nt bi translated">熊猫的数据透视表</h1><p id="16a8" class="pw-post-body-paragraph ky kz it la b lb nu ju ld le nv jx lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">数据透视表是 Excel 最强大的功能之一，它允许我们以令人难以置信的速度从大型数据集提取有意义的数据。让我们创建一个关于每个城市销售额的数据透视表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/72a651719b94a7b15fffb4008c91cd37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*I5HO8wZ2yrbJILooYeWWvg.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在 Excel 中生成数据透视表(来源:Nik Piepenbreier)</p></figure><p id="7dc4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为此，我们只需将 City 字段拖到 Rows 部分，将 Sales 字段拖到 Values 部分。Excel 会自动合计数据集中每个城市的销售额。</p><p id="1b3d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了在 Pandas 中生成相同的数据透视表，我们将编写以下代码:</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="179a" class="mc md it ly b gy me mf l mg mh">sales.pivot_table(index = 'City', values = 'Sales', aggfunc = 'sum')</span></pre><p id="282b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们再来分解一下:</p><ol class=""><li id="57c7" class="mi mj it la b lb lc le lf lh mk ll ml lp mm lt od mo mp mq bi translated">我们使用 sales.pivot_table 让 Pandas 知道我们想要基于销售数据框架创建一个数据透视表</li><li id="265b" class="mi mj it la b lb mr le ms lh mt ll mu lp mv lt od mo mp mq bi translated">Index 指定了我们想要聚合的值</li><li id="b02b" class="mi mj it la b lb mr le ms lh mt ll mu lp mv lt od mo mp mq bi translated">Values 指定我们要聚合的值</li><li id="dc25" class="mi mj it la b lb mr le ms lh mt ll mu lp mv lt od mo mp mq bi translated">Aggfunc 指定了我们想要使用的函数(我们也可以使用 mean，max，min 等)。)</li></ol></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><h1 id="4496" class="nd md it bd ne nf ng nh ni nj nk nl nm jz nn ka no kc np kd nq kf nr kg ns nt bi translated">包扎</h1><p id="cc1c" class="pw-post-body-paragraph ky kz it la b lb nu ju ld le nv jx lg lh nw lj lk ll nx ln lo lp ny lr ls lt im bi translated">在本文中，我们学习了如何将 Excel 数据导入 Pandas，如何完成 IF 和 VLOOKUP 函数，以及如何生成数据透视表。但是你可能会问自己，如果你可以在 Excel 中做这里列出的所有事情，为什么还要用熊猫呢？这里没有一个明确的答案。Python 让我们能够生成可重用、可追踪的代码，让我们能够轻松地复制我们的分析设计。对于较小的分析，Excel 可能就足够了。我鼓励你给熊猫打一针，看看你是否会喜欢上它。</p></div></div>    
</body>
</html>