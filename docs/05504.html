<html>
<head>
<title>4 Simple Ways to Import Word and PDF Data into Python when Pandas Fails</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当 Pandas 失败时，将 Word 和 PDF 数据导入 Python 的 4 种简单方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461?source=collection_archive---------14-----------------------#2020-05-09">https://towardsdatascience.com/4-simple-ways-to-import-word-and-pdf-files-into-python-when-pandas-fails-43cf81599461?source=collection_archive---------14-----------------------#2020-05-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9441" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">导入非结构化文本/图像数据的实用指南</h2></div><p id="4e63" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为数据科学/分析团队的一员，您可能会遇到许多要在 Python 中导入和分析的文件类型。在理想世界中，我们所有的数据都驻留在基于云的数据库(例如 SQL、NoSQL)中，这些数据库易于查询和提取。然而，在现实世界中，我们很少得到整洁的表格数据。此外，如果我们需要额外的数据(结构化或非结构化的)来增强分析，我们将不可避免地使用不同格式的原始数据文件。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/acc56ac7d797af3836d7a2f9af4746a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*tSLBEPDAE0BZ09wi7AilNw.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated"><a class="ae lq" href="https://www.pexels.com/photo/words-text-scrabble-blocks-695571/" rel="noopener ugc nofollow" target="_blank">照片由 Pexels 的 Skitterphoto 拍摄</a></p></figure><p id="61f0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最近，我的团队开始了一个项目，作为第一步，包括将原始数据文件整合成<em class="lr">格式。csv，。xlsx，。pdf，。docx、</em>和<em class="lr">。doc </em>。我的第一反应:威武<strong class="kk iu"> <em class="lr">熊猫</em> </strong>！其中当然处理了<em class="lr">。csv </em>和<em class="lr">。xlsx </em>，但是关于<em class="lr">。pdf </em>和<em class="lr">。docx </em>，我们将不得不探索超越<strong class="kk iu"> <em class="lr">熊猫</em> </strong>的可能性。</p><p id="dd91" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇博客中，我将分享我的技巧和诀窍，以帮助您轻松地导入 PDF 和 Word 文档(到 Python 中),以防它出现在您自己的工作中，尤其是在您的 NLP 自然语言处理项目中。所有样本数据文件都可以公开访问，文件副本以及相应的下载链接可以在<a class="ae lq" href="https://github.com/YiLi225/Import_PDF_Word_Python" rel="noopener ugc nofollow" target="_blank"> my Github repo </a>中找到。</p><ol class=""><li id="b40c" class="ls lt it kk b kl km ko kp kr lu kv lv kz lw ld lx ly lz ma bi translated"><a class="ae lq" href="https://python-docx.readthedocs.io/en/latest/user/documents.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> <em class="lr"> Python-docx → </em>用<em class="lr"> </em> MS Word 工作。docx 文件</strong> </a></li></ol><p id="b02c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为最常用的文档工具之一，MS Word 经常是人们编写和共享文本的首选。对于带有。<em class="lr"> docx </em>扩展，Python 模块<strong class="kk iu">T35】docxT37】是一个得心应手的工具，下面展示如何导入<em class="lr">。docx </em>段落只有 2 行代码，</strong></p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="8950" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们打印出输出信息，</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mb mc l"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">docx 返回的信息和示例段落</p></figure><p id="0d1b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们所看到的，返回的是一个字符串/句子的列表，因此我们可以利用字符串处理技术和正则表达式来获取文本数据以备进一步分析(例如，NLP)。</p><p id="66e4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 2。</strong><a class="ae lq" href="https://github.com/mhammond/pywin32" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu"><em class="lr">win 32 com</em>→用 MS Word 工作。doc 文件</strong> </a></p><p id="b80f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">尽管很容易使用，python-docx 模块不能接受老化的 T2。doc 分机，信不信由你，<em class="lr">。doc </em>文件仍然是许多利益相关者的首选文字处理器(尽管有<em class="lr">)。docx </em>已经存在十多年了)。如果在这种情况下，转换文件类型不是一个选项，我们可以求助于<strong class="kk iu"><em class="lr">win32 com . client</em></strong>包<strong class="kk iu"> <em class="lr"> </em> </strong>中的几个技巧。</p><p id="ba09" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基本技术是首先启动一个 Word 应用程序作为活动文档，然后读取 Python 中的内容/段落。下面定义的函数 docReader()展示了如何(并且<a class="ae lq" href="https://github.com/YiLi225/Import_PDF_Word_Python" rel="noopener ugc nofollow" target="_blank">完全烘焙的代码片段链接到这里</a>)，</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="ca3e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">运行这个函数后，我们应该会看到与第 1 部分相同的输出。<strong class="kk iu">两个小技巧:</strong> (1)我们设置<strong class="kk iu">字。Visible = False </strong>隐藏物理文件，这样所有的处理工作都在后台完成；(2)参数<strong class="kk iu"> doc_file_name </strong>需要完整的文件路径，而不仅仅是文件名。否则，函数文档。Open()不会识别文件，即使将工作目录设置为当前文件夹。</p><p id="c2b5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">加入我们的 YouTube 社区🎦  <a class="ae lq" href="https://www.youtube.com/channel/UCbGx9Om38Ywlqi0x8RljNdw" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> <em class="lr">【数据与 Kat 谈判】</em> </strong> </a> <strong class="kk iu"> <em class="lr">😄</em> </strong></p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="md mc l"/></div></figure><p id="ca9f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让我们来看看 PDF 文件，</p><p id="ce09" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 3。</strong> <a class="ae lq" href="https://github.com/euske/pdfminer" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> <em class="lr"> Pdfminer(代替 pypdf F2)</em>→使用 PDF 文本</strong> </a></p><p id="ea10" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">说到在 Python 中处理 PDF 文件，大家熟知的模块<a class="ae lq" href="https://github.com/mstamy2/PyPDF2" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu"><em class="lr">py PDF 2</em></strong></a>大概会是包括我自己在内的大部分分析师最初的尝试。因此，我使用<strong class="kk iu"> <em class="lr"> PyPDF2 </em> </strong>(完整代码可在我的<a class="ae lq" href="https://github.com/YiLi225/Import_PDF_Word_Python" rel="noopener ugc nofollow" target="_blank"> Github repo </a>中获得)对其进行编码，这给出了文本输出，如下所示。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="5549" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">嗯，显然这看起来不对，因为所有的空格都不见了！没有合适的空格，我们就无法正确解析字符串。</p><p id="a5ac" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">事实上，这个例子揭示了<strong class="kk iu"> <em class="lr"> PyPDF2 </em> </strong>中的函数 extractText()的一个警告:它对于包含复杂文本或不可打印的空格字符的 PDF 执行得不好。因此，让我们切换到<strong class="kk iu"> <em class="lr"> pdfminer </em> </strong>并探索如何将这个 pdf 文本导入，</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="313f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，输出看起来好多了，可以用文本挖掘技术轻松清理，</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="b9c8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 4。</strong><a class="ae lq" href="https://github.com/madmaze/pytesseract" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu"><em class="lr">Pdf 2 image+Pytesseract</em>→处理 PDF 扫描图像</strong> </a></p><p id="b299" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于数据科学家来说更复杂的是(当然), pdf 可以(并且经常)由扫描图像代替文本文档创建；因此，它们不能被 pdf 阅读器呈现为纯文本，不管它们被组织得多么整齐。</p><p id="9707" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这种情况下，我发现的最佳技术是首先显式地提取图像，然后用 Python 读取和解析这些图像。我们将用模块<a class="ae lq" href="https://github.com/Belval/pdf2image" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu"><em class="lr">pdf 2 image</em></strong></a>和<a class="ae lq" href="https://github.com/madmaze/pytesseract" rel="noopener ugc nofollow" target="_blank"><strong class="kk iu"><em class="lr">pytesract</em></strong></a><strong class="kk iu"><em class="lr">来实现这个想法。</em> </strong>如果后者听起来比较陌生，那么<strong class="kk iu"><em class="lr">pytesserac</em></strong>是 Python 的 OCR 光学字符识别工具，可以识别和读取图像中嵌入的文字。现在，这是基本功能，</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="mb mc l"/></div></figure><p id="4a65" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在输出中，您应该会看到如下所示的扫描图像文本:</p><pre class="lf lg lh li gt me mf mg mh aw mi bi"><span id="da6c" class="mj mk it mf b gy ml mm l mn mo">PREFACE   In 1939 the Yorkshire Parish Register Society, of which the Parish Register Section of the Yorkshire Archaeological Society is the successor (the publications having been issued in numerical sequence without any break) published as its Volume No. 108 the entries in the Register of Wensley Parish Church from 1538 to 1700 inclusive. These entries comprised the first 110 pages (and a few lines of p. 111) of the oldest register at Wensley.</span></pre><p id="4657" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">任务完成！另外，您现在还知道了如何从图像中提取数据，即<strong class="kk iu"><em class="lr">pytesserac</em></strong>模块中的 image_to_string()。</p><p id="7099" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">注意:</strong>要使<strong class="kk iu"> <em class="lr">宇宙魔方</em> </strong>模块成功运行，您可能需要执行额外的配置步骤，包括安装<strong class="kk iu"> <em class="lr"> poppler </em> </strong>和<strong class="kk iu"> <em class="lr">宇宙魔方</em> </strong>包。同样，请在<a class="ae lq" href="https://github.com/YiLi225/Import_PDF_Word_Python" rel="noopener ugc nofollow" target="_blank"> my Github 这里</a>随意抓取更健壮的实现和详细的配置列表。</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><p id="8542" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，Greg Horton 提到了一个数据科学笑话，他在文章中谈到了<a class="ae lq" href="https://blog.timextender.com/reversing-the-80-20-rule-in-data-wrangling" rel="noopener ugc nofollow" target="_blank">数据争论中的 80-20 法则</a>:</p><blockquote class="mw mx my"><p id="1c9e" class="ki kj lr kk b kl km ju kn ko kp jx kq mz ks kt ku na kw kx ky nb la lb lc ld im bi translated">数据科学家花 80%的时间处理数据准备问题，另外 20%的时间抱怨处理数据准备问题需要多长时间。</p></blockquote><p id="2cb8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过经历从 Word 和 PDF 文件中抓取文本的不同方式，我希望这个博客可以让你的 80%变得更容易/不那么无聊，这样你就不会拔头发，也可以减少另外 20%，这样你就可以花更多的时间阅读有趣的中等文章。</p><p id="a739" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">最后提示</strong>:一旦完成了对文件的处理，关闭连接以便其他应用程序可以访问该文件总是一个好的编码实践。这就是为什么你在上面每个函数的末尾看到了<code class="fe nc nd ne mf b">close()</code>方法。😃</p><p id="1d1d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lr">想要更多的数据科学和编程技巧？使用</em> </strong> <a class="ae lq" href="https://yilistats.medium.com/membership" rel="noopener"> <strong class="kk iu"> <em class="lr">我的链接</em> </strong> </a> <strong class="kk iu"> <em class="lr">注册 Medium，获得我所有内容的完全访问权限。</em> </strong></p><p id="5534" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="lr">还订阅我新创建的 YouTube 频道</em> </strong> <a class="ae lq" href="https://www.youtube.com/channel/UCbGx9Om38Ywlqi0x8RljNdw" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> <em class="lr">《数据与吉谈》</em></strong></a><strong class="kk iu"><em class="lr"/></strong></p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="md mc l"/></div></figure><h2 id="f6ef" class="mj mk it bd nf ng nh dn ni nj nk dp nl kr nm nn no kv np nq nr kz ns nt nu nv bi translated">喜欢这个博客吗？这是另一个你可能喜欢的数据科学博客:</h2><div class="nw nx gp gr ny nz"><a rel="noopener follow" target="_blank" href="/6-sql-tricks-every-data-scientist-should-know-f84be499aea5"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">每个数据科学家都应该知道的 6 个 SQL 技巧</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">提高分析效率的 SQL 技巧</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">towardsdatascience.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on lk nz"/></div></div></a></div></div></div>    
</body>
</html>