<html>
<head>
<title>Can Python DataViz libraries reproduce the Tableau worksheet?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python DataViz库能否重现Tableau工作表？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/can-python-dataviz-libraries-repeat-the-tableau-worksheet-e38ef2876f04?source=collection_archive---------10-----------------------#2020-03-20">https://towardsdatascience.com/can-python-dataviz-libraries-repeat-the-tableau-worksheet-e38ef2876f04?source=collection_archive---------10-----------------------#2020-03-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="cb29" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">数据可视化技巧</h2><div class=""/><div class=""><h2 id="9518" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">我对Tableau用法及其与Python代码的比较的第一印象</h2></div><p id="5c41" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">简单来说，答案是肯定的。尽管如此，在我探索画面的过程中，我还是注意到了一些很酷的事情。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ln"><img src="../Images/a83d6e69b464d87c2e4d5dd24e227860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6DcqgVPlBmbAYLLa"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">罗曼·博日科在<a class="ae md" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="5483" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">Tableau是我进入数据科学和数据可视化之旅的必去之地。对于快速了解数据集和初步探索性可视化来说，这是一个非常酷和方便的工具。它为原始数据分析和进一步探索提供了许多必要的工具。因此，作为一名初学数据的科学家，我对它感兴趣并不奇怪。不过，首先，我是一名软件开发人员，所以我不仅想得到一个新的奇特工具，还想了解它是如何工作的。主要目标是<strong class="kt jd">用Jupyter notebook和任何Python库(如plotly或matplotlib)从Tableau重新创建任何可视化</strong>。</p><h2 id="e967" class="me mf it bd mg mh mi dn mj mk ml dp mm la mn mo mp le mq mr ms li mt mu mv iz bi translated">让我们从一个数据集开始</h2><p id="85de" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">我们的任务需要对数据进行一些探索性的分析，所以我选择了一个数据集，它可以展示很多有趣的东西。就是来自Kaggle 的2018年Kickstarter项目(失败和成功都有)<a class="ae md" href="https://www.kaggle.com/kemical/kickstarter-projects" rel="noopener ugc nofollow" target="_blank">的</a><a class="ae md" href="https://www.kaggle.com/kemical/kickstarter-projects" rel="noopener ugc nofollow" target="_blank">表。它包含足够用于分组的分类变量(如项目类型和国家)、一些日期和日期范围(它们都有开始日期和截止日期)以及用于合计的数字变量(金额)。</a></p><p id="fc14" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">请注意数据:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nb"><img src="../Images/fa878dcad504c8bb65b6bde18d0dd706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t-AdIN_TgV-1uGZV2TFutA.png"/></div></div></figure><p id="42a5" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">虽然我的第一个冲动是使用熊猫，但我现在必须借助Tableau来查看数据。</p><h2 id="ac3e" class="me mf it bd mg mh mi dn mj mk ml dp mm la mn mo mp le mq mr ms li mt mu mv iz bi translated">第一印象</h2><p id="8622" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">Tableau只需点击几下就可以打开数据集，相当于熊猫的一行代码。虽然它带来了额外的功能，如自动列类型识别:日期/时间、地理数据、数字等..因此，Tableau方法看起来更有吸引力，所以我把我的数据集…</p><p id="a1d2" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">…我遇到了数据类型的问题，我的数据没有被解析。简单看了一下，发现问题出在本地的Windows语言设置上。我住在乌克兰，所以我有母语的月份名称，但数据集包含英语格式，Tableau在当前的语言设置下无法识别。我有点失望，这个程序需要本地设置，我不能在程序中调整它们。不管怎样，问题解决了，我继续工作。</p><p id="0f46" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在我们可以看到自动类型识别的所有优点:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nc"><img src="../Images/6e1b8a97a2e165c075ba3bf3ebd1e040.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hWq0vIqmZFNfnRkmldNv_A.png"/></div></div></figure><p id="e9d8" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">正如我们所见，它正确地识别了货币、日期和地理数据。除了一个小错误:“state”列被识别为地理数据，而不是原始文本。然而，这是一个很好的特性，有助于分析。</p><h2 id="5b9f" class="me mf it bd mg mh mi dn mj mk ml dp mm la mn mo mp le mq mr ms li mt mu mv iz bi translated">点击几下即可清洁</h2><p id="4915" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">数据集清理是数据分析过程中最耗时的步骤。所以我们需要使用任何工具来保持我们的时间。Tableau在这个过程中是一个优秀的助手，它有别名、计算列和过滤系统。例如，我们在Kickstarter数据集中有“state”列。它保持几个值:“成功”、“失败”、“活动”、“暂停”和“取消”。尽管我们只希望与“成功的”和“失败的”项目合作。让我们继续下一步:</p><ol class=""><li id="bc81" class="nd ne it kt b ku kv kx ky la nf le ng li nh lm ni nj nk nl bi translated">为“state”列创建一个过滤器，这样我们只留下“successful”、“failed”和“live”状态。</li><li id="6eb4" class="nd ne it kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">创建一个计算字段，将“实时”转换为“成功”。我们需要下一个公式:<code class="fe nr ns nt nu b">if [state] = “live” then “successful” else [state] end</code></li><li id="0c0a" class="nd ne it kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">如果需要，可以使用别名。</li><li id="69a0" class="nd ne it kt b ku nm kx nn la no le np li nq lm ni nj nk nl bi translated">将列重命名为“状态(失败/成功)”。</li></ol><p id="cc67" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">首先，所有这些步骤都可以通过几次点击来完成，这是可视化界面的一个明显优势。此外，计算字段允许执行任何复杂的条件。过滤器让我们可以快速访问该列的所有值。</p><p id="f136" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">由于我们使用的是比较，以下是相同工作的Python代码:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="98b4" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">当然，虽然我们已经完成了我们的例子，但是还有很多清理工作要做，所以让我们转到图表上来，这是本文的主要目标。</p><h2 id="a308" class="me mf it bd mg mh mi dn mj mk ml dp mm la mn mo mp le mq mr ms li mt mu mv iz bi translated">每个值都是一个可视化对象</h2><p id="ad8f" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">这是我在数据分析中遇到的最佳实践:Tableau将每一列(要素或测量或过滤器或计算字段)转换为拖放对象。所以你可以通过几次鼠标移动来创建一个完整的信息可视化。例如，我刚刚在列中添加了“主类别”特性，并在行中自动生成了“记录数”,条形图就准备好了。再移动一次以将总计数添加为条形标签，这是每个条形上带有额外视觉提示的结果:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nx"><img src="../Images/7aa8bed75ed454eceafc81a891f1642e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rPgVaC8Vrq3YnZW3gvVB1w.png"/></div></div></figure><p id="4774" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">同样的操作将花费更多的时间，但是Jupyter笔记本中的几行代码:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="a8e4" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">更复杂的图形呢？没问题:将“Country”列和“Number of records”行一起拖动，改变可视化类型，我们就有了树形图。更重要的是:将“Country”特性拖到filters部分，从可视化中删除USA行(这样会更清晰，因为USA有最多的记录)。结果仍然是交互的:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ny"><img src="../Images/63ce3c47acb9a1d67ee24b52cb6e6f6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jI006ccQbA770UFjZW8nNA.png"/></div></div></figure><p id="d173" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">尽管如此，可视化仍然可以用Python代码再现:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="264e" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">所以我们了解到，我们可以通过点击几下鼠标来创建简单的可视化。尽管我们还需要几行代码来在Python中得到相同的结果。让我们创造一些更复杂的东西。</p><h2 id="521c" class="me mf it bd mg mh mi dn mj mk ml dp mm la mn mo mp le mq mr ms li mt mu mv iz bi translated">自动聚合</h2><p id="c252" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">简单的图形向我们展示了两个变量之间的联系。如果我们需要显示三个以上的特征，我们使用聚合技术。例如，如果我们需要显示每个类别中成功和失败项目的数量，该怎么办？对Tableau来说这是个简单的任务。我们已经有了一个类别条形图，所以，让我们将“State”变量作为颜色属性添加到工作表中:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi nz"><img src="../Images/77e81023bba141ce9928ac74390e26e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dPCq4MKGaYLesCfxrDbGnw.png"/></div></div></figure><p id="27e6" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">一个动作，我们就收集了更多的信息。代码呢？嗯，我们需要大量的数据来制作这张图片:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="e196" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在让我们为“国家”特性创建一个类似于AB-test的东西，并显示成功和失败项目的比例。我们对“Country”执行与前面对“Category”相同的步骤，并更改聚合的属性以显示百分比:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi oa"><img src="../Images/c952591effee15c07d4587a2bd00ec50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XHmOITSz_SZHpW_5_Bpqzg.png"/></div></div></figure><p id="4c52" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这是代码。尽管这次更加复杂:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="11df" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">此外，Tableau对颜色方案、标签字体和自定义线条有不同的设置，正如我们在可视化中看到的那样。</p><p id="b6da" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">现在让我们转向另一种方法。</p><h2 id="2168" class="me mf it bd mg mh mi dn mj mk ml dp mm la mn mo mp le mq mr ms li mt mu mv iz bi translated">从头开始绘制地图</h2><p id="7c4f" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">正如标题所示，我们将创建一个地图。Python有许多额外的包来处理地理数据，如follow。不过，Tableau具有识别地理数据(如国家代码)并使用它构建地图的内置功能。与前面的部分一样，只需将变量拖放到工作表中，Tableau就会自动生成地图:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="lt lu di lv bf lw"><div class="gh gi ob"><img src="../Images/a0a4ed8b7d9ab596cb9c504a4e7429e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KSsRBHOmlU6ca715PVS0kQ.png"/></div></div></figure><p id="141f" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">再点击几下，我们就有了一个漂亮的交互式地图，上面用彩色符号标出了Kickstarter记录的数量。我们仍然可以完全控制标记、颜色、标签和其他设置。</p><p id="1c85" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">如上所述，我们使用GeoPy和GeoPy(将国家代码<a class="ae md" rel="noopener" target="_blank" href="/geolocations-and-geocodes-instrument-set-for-data-analysis-5eb4e33a1677">转换为地理数据</a>)来创建相同的地图:</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="51ba" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">这不像Tableau那么简单，但仍然是可复制的。</p><h2 id="b6d6" class="me mf it bd mg mh mi dn mj mk ml dp mm la mn mo mp le mq mr ms li mt mu mv iz bi translated">那又怎样？</h2><p id="4f20" class="pw-post-body-paragraph kr ks it kt b ku mw kd kw kx mx kg kz la my lc ld le mz lg lh li na lk ll lm im bi translated">这是一个合理的问题。我们已经知道，matplotlib、seaborn、plotly和其他Python库功能非常强大，几乎可以实现任何可视化。另一方面，Tableau是一种著名而又酷的乐器，具有非常相似的功能。我们可以从一开始就预测文章标题的答案。尽管如此，我相信这种比较对于展示一些不明显的思想是非常重要的:</p><ul class=""><li id="6868" class="nd ne it kt b ku kv kx ky la nf le ng li nh lm oc nj nk nl bi translated">将每个特征表示为一个可视对象可以多次加速可视化过程(只需记住使用matplotlib轴)；</li><li id="0ed4" class="nd ne it kt b ku nm kx nn la no le np li nq lm oc nj nk nl bi translated">Tableau内置了很多乐器，不需要每次都记住所有的包名或者组成一个新的环境；</li><li id="ce93" class="nd ne it kt b ku nm kx nn la no le np li nq lm oc nj nk nl bi translated">在另一次过滤后，您实际上可以看到数据和您应用的所有更改。甚至—每个筛选器或计算列都是一个单独的对象；</li><li id="2043" class="nd ne it kt b ku nm kx nn la no le np li nq lm oc nj nk nl bi translated">Tableau有自己的模拟脚本语言，用于构建复杂的条件和过滤器；</li><li id="f4ee" class="nd ne it kt b ku nm kx nn la no le np li nq lm oc nj nk nl bi translated">大量的聚合能力、默认类型检测和特性选择；</li><li id="5854" class="nd ne it kt b ku nm kx nn la no le np li nq lm oc nj nk nl bi translated">它只是漂亮，看起来像一件艺术品；</li></ul><p id="d978" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">但是</p><ul class=""><li id="64f1" class="nd ne it kt b ku kv kx ky la nf le ng li nh lm oc nj nk nl bi translated">代码给了我们更多的定制能力，特别是颜色、图例、附加元素、并行可视化等。你可以自由地用你的数据做任何事情；</li><li id="8b51" class="nd ne it kt b ku nm kx nn la no le np li nq lm oc nj nk nl bi translated">Tableau适用于已经清理过的数据集。它有很酷的设备，但是对于先进的清洗技术来说还不够；</li><li id="1e6e" class="nd ne it kt b ku nm kx nn la no le np li nq lm oc nj nk nl bi translated">Tableau中的每一个可视化都可以在Jupyter notebook中重现(只是没那么好看)。</li></ul><p id="1983" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">尽管我的结论是，我相信每个人都应该使用他喜欢和习惯的工具。我发现Tableau易于使用，在快速的主要数据集分析方面表现良好，并且能够在几次点击中创建分组并保存就绪的图像。虽然Python库可以做同样的工作，但Tableau可以做得更快，做得更漂亮。所以，<strong class="kt jd">我肯定会在我的作品</strong>中使用它，尤其是当我需要一张艺术般的照片时。尽管如此，我仍然更喜欢Jupyter notebook进行复杂的分析，及时显示几幅图像，快速记录，并在项目期间给予很大的自由。</p></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><p id="0aa4" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">您可以在我的Github上找到包含所有工作示例和内置图形的Jupyter笔记本，以及Tableau工作表:</p><div class="ok ol gp gr om on"><a href="https://github.com/Midvel/medium_jupyter_notes/blob/master/tableau_vs_python/tableau_vs_python.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="oo ab fo"><div class="op ab oq cl cj or"><h2 class="bd jd gy z fp os fr fs ot fu fw jc bi translated">中级/中等_jupyter_notes</h2><div class="ou l"><h3 class="bd b gy z fp os fr fs ot fu fw dk translated">permalink dissolve GitHub是4000多万开发人员的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="ov l"><p class="bd b dl z fp os fr fs ot fu fw dk translated">github.com</p></div></div><div class="ow l"><div class="ox l oy oz pa ow pb lx on"/></div></div></a></div><p id="70e3" class="pw-post-body-paragraph kr ks it kt b ku kv kd kw kx ky kg kz la lb lc ld le lf lg lh li lj lk ll lm im bi translated">此外，你可以自由分享一些有趣的技巧，用在Tableau中。</p></div></div>    
</body>
</html>