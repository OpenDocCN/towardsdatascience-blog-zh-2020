# å­¦ä¹  PyTorch çš„åŒæ—¶é¢„æµ‹è‹±é›„è”ç›Ÿæ¯”èµ›(ç¬¬äºŒéƒ¨åˆ†)

> åŸæ–‡ï¼š<https://towardsdatascience.com/predict-league-of-legends-matches-while-learning-pytorch-part-2-38b8e982c7ea?source=collection_archive---------40----------------------->

## å­¦ä¹ åœ¨ PyTorch ä¸­å®ç°ä¸€ä¸ªç®€å•çš„å‰é¦ˆç½‘ç»œï¼Œå¹¶ä½¿ç”¨ GPU ä¸ºä¸€ä¸ªåˆé€‚çš„ç”¨ä¾‹åœºæ™¯è¿›è¡Œè®­ç»ƒï¼ŒåŒæ—¶å­¦ä¹ ä¸€äº›ç†è®º

![](img/af5e778d8cd1fb342f1526e8ee4759af.png)

è¿™ä¸ªå°ç³»åˆ—çš„ç¬¬äºŒéƒ¨åˆ†ï¼Œæ‰‹ç»˜ç‰ˆï¼

> è¯»è€…æœ‹å‹ï¼Œä½ å¥½ï¼å¦‚æœä½ è¿˜æ²¡æœ‰è¯»è¿‡è¿™ä¸ªç”± 2 éƒ¨åˆ†ç»„æˆçš„â€œç³»åˆ—â€çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œæˆ‘å¼ºçƒˆæ¨èä½ åœ¨é˜…è¯»ä¹‹å‰é˜…è¯»å®ƒã€‚æ‚¨å¯ä»¥åœ¨æ­¤å¤„æˆ–ä¸‹æ–¹*è¿›è¡Œæ“ä½œğŸ‘‡*

[](/predict-matches-in-league-of-legends-while-learning-pytorch-basics-3dd43cf8d16f) [## åœ¨å­¦ä¹  PyTorch åŸºç¡€çŸ¥è¯†çš„åŒæ—¶é¢„æµ‹è‹±é›„è”ç›Ÿä¸­çš„æ¯”èµ›

### è¯·è·Ÿæˆ‘æ¥ï¼Œæˆ‘å°†ä½¿ç”¨ PyTorch å®ç°ä¸€ä¸ªé€»è¾‘å›å½’æ¨¡å‹æ¥é¢„æµ‹è‹±é›„è”ç›Ÿä¸­çš„æ¯”èµ›

towardsdatascience.com](/predict-matches-in-league-of-legends-while-learning-pytorch-basics-3dd43cf8d16f) 

ä¸Šä¸€æ¬¡ï¼Œæˆ‘ä»¬åœæ­¢äº†ç”¨ PyTorch åšä¸€ä¸ªé€»è¾‘å›å½’å™¨æ¥è¾¾åˆ°åŒæ ·çš„ç›®çš„ã€‚è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬å°†äº‹æƒ…æ¨è¿›äº†ä¸€æ­¥:åˆ›å»ºä¸€ä¸ªå‰é¦ˆç¥ç»ç½‘ç»œ(åªæœ‰å®Œå…¨è¿æ¥çš„å±‚)ã€‚å¦‚æœä½ æƒ³çŸ¥é“æ›´å¤šå…³äºè¿™æ ·åšçš„æ„å›¾ï¼Œè¿™ä¸ªè¿·ä½ é¡¹ç›®å°†ä½¿ç”¨çš„æ•°æ®é›†ï¼Œå’Œ/æˆ–æ•°æ®é›†çš„æ•°æ®å‡†å¤‡è¿‡ç¨‹ï¼Œé‚£ä¹ˆä½ åº”è¯¥çœ‹çœ‹æˆ‘çš„ç¬¬ä¸€ç¯‡æ–‡ç« [è¿™é‡Œ](/predict-matches-in-league-of-legends-while-learning-pytorch-basics-3dd43cf8d16f)æˆ–ä»¥ä¸Šã€‚

ã€Šè‹±é›„è”ç›Ÿã€‹æ˜¯æˆ‘ä¸€ç›´ä»¥æ¥æœ€å–œæ¬¢çš„æ¸¸æˆä¹‹ä¸€ï¼Œå°½ç®¡æˆ‘çœŸçš„å¾ˆä¸æ“…é•¿ã€‚LOL æ˜¯ä¸€ä¸ªæå…·ç«äº‰åŠ›çš„ MOBAï¼Œä¸¤ä¸ªç”± 5 äººç»„æˆçš„é˜Ÿä¼*(è“é˜Ÿå’Œçº¢é˜Ÿ)*ç›¸äº’å¯¹æŠ—ï¼Œä»¥æ‘§æ¯å¯¹æ–¹çš„åŸºåœ°(nexus)ã€‚è·èƒœé€šå¸¸éœ€è¦å¤§é‡çš„å›¢é˜Ÿåˆä½œã€åè°ƒï¼Œæˆ–è€…å¯¹äºä¸€ä¸ªå€¾æ–œçš„ç©å®¶æ¥è¯´ï¼Œâ€œè¿æ°”â€ã€‚ä¸ç®¡æ€æ ·ï¼Œå¯¹äºä¸€ä¸ªè”ç›Ÿç©å®¶(å³ä½¿ä»–ä»¬æ˜¯ç›¸å½“æ–°çš„)æ¥è¯´ï¼Œæ ¹æ®æ¸¸æˆè®°å½•çš„æ­»äº¡äººæ•°å’Œè®¸å¤šå…¶ä»–æ•°æ®æ¥åˆ¤æ–­å“ªä¸ªé˜Ÿå¯èƒ½ä¼šèµ¢å¹¶ä¸å¤ªéš¾ã€‚ç¥ç»ç½‘ç»œå¯ä»¥é¢„æµ‹çš„ä¸œè¥¿â€¦â€¦

# ç­‰ç­‰ï¼Œä»€ä¹ˆæ˜¯ç¥ç»ç½‘ç»œï¼Ÿ

> å˜¶ï¼å¦‚æœä½ ä¸æƒ³å­¦ä¹ ä¸€äº›ç†è®ºï¼Œå¯ä»¥è·³è¿‡è¿™ä¸€éƒ¨åˆ†ã€‚ä½ ä¼šé”™è¿‡ä¸€äº›æˆ‘è‡ªå·±çš„ç”»:(

ä¸Šæ¬¡æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†é€»è¾‘å›å½’æ¨¡å‹å¦‚ä½•åœ¨é¢„æµ‹æ–¹é¢åšå¾—ç›¸å½“å¥½(å®ƒåœ¨æµ‹è¯•æ•°æ®é›†ä¸Šå®ç°äº†é«˜è¾¾ 74%çš„å‡†ç¡®æ€§)ã€‚äº‹å®ä¸Šï¼Œé€»è¾‘å›å½’å˜é‡å‡ ä¹å®Œå…¨æ˜¯ä¸€ä¸ªçº¿æ€§å›å½’å˜é‡ï¼Œå®ƒæœ¬èº«å°±æ˜¯ä¸€ä¸ª T2ï¼Œä¸€ä¸ªä¸€æ‰¹è¾“å…¥ä¹‹é—´çš„çŸ©é˜µç‚¹ç§¯ï¼Œä¸€ä¸ªæƒé‡çŸ©é˜µï¼Œå¤–åŠ ä¸€ä¸ªåå·®å‘é‡ã€‚ *å¯å˜çš„æƒé‡å’Œåå·®ä½¿æ¨¡å‹èƒ½å¤Ÿè®­ç»ƒå¹¶æ›´å¥½åœ°åšå®ƒæ­£åœ¨åšçš„äº‹æƒ…ã€‚*çº¿æ€§å›å½’å’Œé€»è¾‘å›å½’ä¹‹é—´çš„å”¯ä¸€åŒºåˆ«æ˜¯ï¼Œå¯¹äºæ¶‰åŠç®€å•çš„æ˜¯æˆ–å¦é—®é¢˜(å°±åƒæ¯”èµ›ä¸­çš„ä¸€æ”¯çƒé˜Ÿèµ¢å¾—äº†æ¯”èµ›)æˆ–åˆ†ç±»é—®é¢˜çš„é¢„æµ‹ï¼Œå­˜åœ¨ä¸€ä¸ªå°†è¾“å‡ºâ€œæŒ¤å‹â€æˆä¸€ç³»åˆ—å€¼(é€šå¸¸ä» 0 åˆ° 1)çš„å‡½æ•°ã€‚é€»è¾‘å›å½’å˜é‡å°±æ˜¯ä½¿ç”¨è¿™ç§â€œæŒ¤å‹â€å‡½æ•°çš„å˜é‡ï¼Œå®ƒé€šå¸¸ä»¥ *sigmoid* æˆ– *softmax* å‡½æ•°çš„å½¢å¼å‡ºç°ã€‚

![](img/779cc38d5f73d71002906c804c775058.png)

çº¿æ€§å›å½’çš„åŸºæœ¬æ•°å­¦ï¼Œå…¶ä¸­çº¿æ€§å›å½’çš„çŸ©é˜µè¿ç®—ç”¨ sigmoid å‡½æ•°åŒ…è£…ã€‚æˆ‘ç”»çš„ğŸ˜¬ ğŸ”¥

é‚£ä¹ˆï¼Œç¥ç»ç½‘ç»œå¦‚ä½•è®¾ç½®è‡ªå·±ä»¥è·å¾—è¿›ä¸€æ­¥çš„æˆåŠŸå‘¢ï¼Ÿ**ç®€å•åœ°è¯´ï¼Œä¸€ä¸ªæ™®é€šçš„ç¥ç»ç½‘ç»œæ˜¯å¤šä¸ªçº¿æ€§å›å½’å™¨å †å åœ¨ä¸€èµ·ã€‚** *ç†è®ºä¸Šï¼Œè¿™åº”è¯¥å…è®¸ç¥ç»ç½‘ç»œæ‹¾å–æ•°æ®ä¹‹é—´çš„æ›´å¤šå…³ç³»/è¶‹åŠ¿ï¼Œä»¥å¸®åŠ©é¢„æµ‹ã€‚*ä½†ä¸å¯èƒ½è¿™ä¹ˆç®€å•ï¼ä¸åšä»»ä½•é¢å¤–çš„äº‹æƒ…ï¼Œé“¾æ¥çŸ©é˜µä¹˜æ³•å’ŒåŠ æ³•åªä¼šè®©æˆ‘ä»¬ä¸€æ— æ‰€è·ã€‚çœ‹ä¸€çœ‹:

![](img/18c1b57838b925d5675bbff75a3e1aae.png)

è¿™å°±æ˜¯å½“ä½ è¯•å›¾ç›´æ¥é“¾æ¥çº¿æ€§å›å½’æ“ä½œæ—¶ä¼šå‘ç”Ÿçš„æƒ…å†µã€‚

æ‚¨å¯ä»¥çœ‹åˆ°ï¼Œå°†ä¸¤ä¸ªçº¿æ€§å›å½’é“¾æ¥èµ·æ¥ä¸ä»…ä¸€ä¸ªçº¿æ€§å›å½’åŒä¹‰ï¼Œåªæ˜¯æƒé‡å’Œåå·®ä¸åŒã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ**æˆ‘ä»¬å¼•å…¥ä¸€ä¸ªéçº¿æ€§æ¿€æ´»å‡½æ•°**ï¼Œå®ƒå°†ç¯ç»•çº¿æ€§å›å½’æ“ä½œçš„æ¯ä¸ªå®ä¾‹ã€‚å®ƒä¸ä»…è§£å†³äº†ä¸Šé¢æ™®éå­˜åœ¨çš„é—®é¢˜ï¼Œè€Œä¸”è¿˜æ¨¡ä»¿äº†(åœ¨æŸç§æ„ä¹‰ä¸Š)ç”Ÿç‰©ç¥ç»å…ƒçš„å·¥ä½œæ–¹å¼ã€‚ä¾‹å¦‚ï¼Œç¥ç»å…ƒç¡®å®šä¿¡å·æ˜¯å¦è¶…è¿‡è®¾å®šçš„*é˜ˆå€¼*ï¼Œä»¥å°†ä¿¡å·å‘å‰ä¼ é€’åˆ°ä¸‹ä¸€ä¸ªç¥ç»å…ƒã€‚ç±»ä¼¼åœ°ï¼Œæ¿€æ´»å‡½æ•°å°†å†³å®šå¹¶è°ƒæ•´ç¥ç»ç½‘ç»œå±‚çš„æœ€ç»ˆè¾“å‡ºã€‚æˆ‘å¯ä»¥è¯¦ç»†è¯´æ˜æ¿€æ´»åŠŸèƒ½ï¼Œä½†æˆ‘ä»¬ä¼šæ½œæ°´å¤ªæ·±ï¼

*é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œä¸ºäº†ä½¿æˆ‘ä»¬å¯¹è¯æ±‡çš„ç”¨æ³•æ›´è¶‹å‘äºçº¦å®šä¿—æˆï¼Œä»ç°åœ¨å¼€å§‹è®©æˆ‘ä»¬æŠŠè¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„çº¿æ€§å›å½’çš„æ¯ä¸€ä¸ªå®ä¾‹éƒ½ç§°ä¸ºä¸€ä¸ª* ***ç¥ç»ç½‘ç»œçš„éšè—å±‚*** *ï¼Œè€Œæ¯ä¸€ä¸ªä¸ªä½“çš„æƒé‡å’Œåå·®éƒ½ç§°ä¸ºä¸€ä¸ª* ***èŠ‚ç‚¹*** *ã€‚*è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œè¿™å°±æ˜¯ç¥ç»ç½‘ç»œçš„â€œæ ·å­â€:

![](img/66a316a1c6e7c9c009df6af2bee073de.png)

æˆ–è€…ï¼Œä½ å¯ä»¥è°·æ­Œæœç´¢â€œç¥ç»ç½‘ç»œâ€ï¼Œä½ ä¼šçœ‹åˆ°æ›´å¥½çš„å›¾åƒï¼

å¥½äº†ï¼Œç°åœ¨è®©æˆ‘ä»¬å›åˆ°ç¼–ç ä¸Šæ¥ï¼å¦‚æœä½ æƒ³è¦ä¸€ä¸ªæ›´ç›´è§‚çš„æ–¹æ³•æ¥ç ”ç©¶ç¥ç»ç½‘ç»œ&æ›´å¤šï¼Œçœ‹çœ‹ [3blue1brown å…³äºæ·±åº¦ç¥ç»ç½‘ç»œçš„è§†é¢‘ç³»åˆ—](https://www.youtube.com/watch?v=aircAruvnKk&list=PLZHQObOWTQDNU6R1_67000Dx_ZCJB-3pi&index=2&t=0s)ï¼

# åˆ¶ä½œå‰é¦ˆç¥ç»ç½‘ç»œ

TLï¼›å¯¹äºæˆ‘ä»¬åˆšæ‰æ‰€è¯´çš„åšå£«:*ä¸€ä¸ªç¥ç»ç½‘ç»œåŸºæœ¬ä¸Šæ˜¯å¤šä¸ªçº¿æ€§å›å½’æ“ä½œ(éšè—å±‚)é“¾æ¥åœ¨ä¸€èµ·ï¼Œåœ¨æ¯ä¸€å±‚ä¹‹åæœ‰ä¸€ä¸ª* ***æ¿€æ´»å‡½æ•°*** *ã€‚*ä¸‹é¢æ˜¯å®šä¹‰æ¨¡å‹æ—¶çš„æ ·å­:

æ¯ä¸ªç‰¹æ€§çš„è¾“å…¥å¤§å°å°†æ˜¯ 29(å‚è§ç¬¬ä¸€ç¯‡æ–‡ç« )ï¼Œè¾“å‡ºå¤§å°å°†æ˜¯ 2ï¼Œæ¯ä¸€ä¸ªéƒ½æ˜¯å¯¹å›¢é˜Ÿè¾“èµ¢çš„é¢„æµ‹ã€‚

å½“æˆ‘ä»¬åˆå§‹åŒ–æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰å¤šä¸ªâ€œnn.Linearâ€å®ä¾‹ï¼Œæˆ‘ä»¬å°†é€šè¿‡æ¯ä¸€å±‚å’Œâ€œF.relu()â€ä¼ é€’è¾“å…¥(ç¨åå°†è¯¦ç»†ä»‹ç»)ã€‚

é…·ï¼Œ*ä½†æ˜¯ä»€ä¹ˆæ˜¯* `*F.relu()*`ï¼Ÿæ•´æµçº¿æ€§å•å…ƒ(ReLU)æ˜¯æ·±åº¦å­¦ä¹ ä¸­ä½¿ç”¨çš„è®¸å¤šæ¿€æ´»å‡½æ•°ä¹‹ä¸€ï¼Œä¸å…¶ä»–æ›¿ä»£æ–¹æ³•(ä¾‹å¦‚ Sigmoid)ç›¸æ¯”ï¼Œå®ƒçš„æ€§èƒ½éå¸¸å¥½ã€‚å¦‚æœä½ æƒ³çŸ¥é“æ›´å¤šå…³äº ReLU å’Œå…¶ä»–æ¿€æ´»åŠŸèƒ½çš„ä¿¡æ¯ï¼Œå»çœ‹çœ‹è¿™ç¯‡æ–‡ç« ã€‚PyTorch åœ¨`torch.nn.functional`(é€šå¸¸ä½œä¸º`F`å¯¼å…¥)ä¸­æä¾›äº†è¿‡å¤šçš„æ¿€æ´»å‡½æ•°ï¼Œæ‰€ä»¥ä¸€å®šè¦æ£€æŸ¥ä»–ä»¬çš„[æ–‡æ¡£](https://pytorch.org/docs/stable/nn.functional.html)ï¼Œçœ‹çœ‹ä½ æœ‰å“ªäº›é€‰é¡¹å¯ä»¥è‡ªå·±ä½¿ç”¨ã€‚

æˆ‘ä»¬å°†ä½¿ç”¨ SGD ä¼˜åŒ–å™¨å’Œäº¤å‰ç†µæŸå¤±å‡½æ•°æ¥è®­ç»ƒæ¨¡å‹ã€‚æˆ‘ä»¬å°†è®­ç»ƒå¾ªç¯å®šä¹‰å¦‚ä¸‹:

æˆ‘ä»¬åœ¨è¿™é‡Œå®šä¹‰äº†å¾ˆå¤šå‡½æ•°æ¥å½¢æˆè®­ç»ƒå¾ªç¯ã€‚è¿™é‡Œæä¾›äº†æ³¨é‡Šï¼Œå‘æ‚¨å±•ç¤ºå¤§å¤šæ•°ä»£ç è¡Œçš„ç”¨é€”ã€‚

# åœ¨ GPU ä¸Šè®­ç»ƒ

éšç€ç¥ç»ç½‘ç»œæ¨¡å‹å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œè®­ç»ƒè¿™äº›æ¨¡å‹çš„è®¡ç®—éœ€æ±‚ä¹Ÿæ€¥å‰§å¢åŠ ã€‚å›¾å½¢å¤„ç†å•å…ƒï¼Œè¢«ç§°ä¸º GPU æˆ–æ˜¾å¡ï¼Œæ˜¯ä¸“é—¨è®¾è®¡æ¥è¿›è¡Œå¤§è§„æ¨¡çŸ©é˜µè¿ç®—çš„ã€‚å¦‚æœä½ è¿˜ä¸çŸ¥é“ï¼Œé™¤éå¯ç”¨ï¼ŒPyTorch æ€»æ˜¯ä½¿ç”¨ä½ çš„ CPU è¿›è¡Œè®¡ç®—ï¼Œè¿™è‚¯å®šä¸å¦‚ GPU æœ‰æ•ˆã€‚è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬å°†å‘ç°å¦‚ä½•åˆ©ç”¨ GPU æ¥ä¸ºæˆ‘ä»¬çš„ç¥ç»ç½‘ç»œå¤„ç†æ•°æ®ã€‚

> åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œåªæ”¯æŒ NVIDIA GPUsï¼Œå¯¹ä¸èµ· AMD ç²‰ä¸*ğŸ˜¢ã€‚*

PyTorch æä¾›äº†ä¸€ä¸ªå‡½æ•°`torch.cuda.is_available()`ï¼Œå®ƒè¾“å‡ºä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨æ˜å®‰è£…äº† CUDA çš„å…¼å®¹(NVIDIA) GPU çš„å­˜åœ¨ã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªå—æ”¯æŒçš„ GPUï¼Œä½ å¯ä»¥å®Œæˆè®¾ç½®è¿‡ç¨‹ï¼Œæˆ–è€…ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª [kaggle](http://kaggle.com) æˆ– [google colab](http://colab.research.google.com) å¸æˆ·ï¼Œå¹¶è®¿é—®å…è´¹çš„ GPU ä»¥è¿›è¡Œæ·±åº¦å­¦ä¹ (å½“ç„¶æœ‰ä¸€äº›é™åˆ¶)ã€‚è®©æˆ‘ä»¬ä½¿ç”¨`is_available()`å‡½æ•°æ¥è®¾ç½® GPU çš„ä½¿ç”¨ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ GPUï¼Œå°±é€€å›åˆ° CPU:

Torch.device(â€¦)æ˜¯æŒ‡ PyTorch ä¸­å¯ç”¨çš„ç¡¬ä»¶ã€‚

ä½¿ç”¨ PyTorchï¼Œæ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨ä»»ä½•å¼ é‡æˆ–æ¨¡å‹çš„`.to()`æ–¹æ³•å°†æ•°æ®ç§»å…¥å’Œç§»å‡º GPU è®¾å¤‡ã€‚å› æ­¤ï¼Œè¦å¼€å§‹ä½¿ç”¨ GPUï¼Œ**æ‚¨é¦–å…ˆå¿…é¡»å°†æ‚¨çš„æ¨¡å‹ç§»åŠ¨åˆ° GPU ä¸Š**:

æˆ‘ä»¬åˆå§‹åŒ–æ¨¡å‹â€œLOLModelmk2()â€,å¹¶é€šè¿‡ä½¿ç”¨æ–¹æ³•â€œto(device)â€å°†å…¶ç§»åŠ¨åˆ° GPUï¼Œå…¶ä¸­ device =â€œtorch . device(â€œcudaâ€)â€

ç°åœ¨ï¼Œæˆ‘ä»¬å¼€å§‹è®­ç»ƒ:

åœ¨è®­ç»ƒä¹‹å‰ç”¨æµ‹è¯•æ•°æ®æµ‹è¯•æ¨¡å‹ã€‚æŸè€—å¾˜å¾Šåœ¨ 16%å·¦å³ï¼Œå‡†ç¡®ç‡ 50%ã€‚

æ‚¨å¯ä»¥çœ‹åˆ°éªŒè¯æŸå¤±æ€¥å‰§ä¸‹é™ï¼Œå‡†ç¡®æ€§å‡ºç°å³°å€¼ã€‚

è¿™ç§è¶‹åŠ¿åœ¨å¾ˆå°çš„èŒƒå›´å†…ç»§ç»­

ä¸‹é¢æ˜¯ä¸€äº›æ¼‚äº®çš„å›¾è¡¨ğŸ˜ï¼š

è¿™é‡Œæ˜¯æˆ‘ä»¬ä»æµ‹è¯•æ•°æ®é›†å¾—åˆ°çš„ç»“æœ:

å—¯å—¯â€¦

å—¯â€¦ ä¸çº¿æ€§å›å½’æ¨¡å‹(74%)ç›¸æ¯”ï¼Œæˆ‘ä»¬çš„æ¨¡å‹çœ‹èµ·æ¥è¡¨ç°å®Œå…¨ç›¸åŒã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯¹è¿™ä¸ªç»“æœæœ‰ä¸€äº›å¯èƒ½æ€§:

1.  æŸæ®µä»£ç ä¸æ­£ç¡®
2.  ç¥ç»ç½‘ç»œé€šå¸¸æ¯”é€»è¾‘å›å½’æ¨¡å‹å·®
3.  ç¥ç»ç½‘ç»œ*è¿‡æ‹Ÿåˆ*
4.  é€»è¾‘å›å½’æ¨¡å‹åœ¨å…¶è®­ç»ƒä¸­æ˜¯å¹¸è¿çš„(è¿™æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºæ•°æ®é›†è¢«éšæœºåˆ†ä¸ºå›å½’å™¨å’Œç¥ç»ç½‘ç»œçš„è®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†)
5.  åœ¨è¿™ç§æƒ…å†µä¸‹ä½¿ç”¨ç¥ç»ç½‘ç»œå¯èƒ½æ²¡æœ‰ä¼˜åŠ¿ï¼Œæˆ‘ä»¬æ­£åœ¨ç»å†æ”¶ç›Šé€’å‡ã€‚

## å¥½å§ï¼Œæˆ‘ä»¬ç”¨æ’é™¤æ³•ï¼Œå¥½å—ï¼Ÿ

ç»è¿‡é•¿æ—¶é—´çš„è°ƒè¯•ï¼Œæˆ‘åœ¨ä»£ç *ä¸­æ²¡æœ‰å‘ç°ä»»ä½•é”™è¯¯(å¦‚æœä½ å‘ç°äº†ä»€ä¹ˆï¼Œè¯·å‘Šè¯‰æˆ‘ï¼ï¼ï¼)*ï¼Œæ‰€ä»¥#1 å‡ºå±€äº†ã€‚#2 å¯èƒ½ä¸æ˜¯è¿™ç§æƒ…å†µ:æˆ‘ä»¬ä¹‹å‰å»ºç«‹äº†ç¥ç»ç½‘ç»œå¦‚ä½•åŸºäºçº¿æ€§å›å½’æ¨¡å‹ï¼Œçº¿æ€§å›å½’æ¨¡å‹åŸºæœ¬ä¸Šæ˜¯æ²¡æœ‰ *sigmoid/softmax* å‡½æ•°çš„é€»è¾‘å›å½’ã€‚ä»–ä»¬åº”è¯¥èƒ½å¤Ÿä»æ•°æ®ä¸­å¾—å‡ºæ›´å¤šçš„å…³ç³»ï¼Œè¿™éœ€è¦æ›´å¥½çš„å‡†ç¡®æ€§ï¼Œè€Œä¸æ˜¯ç›¸åã€‚

#3 æ¯”å…¶ä»–ä¸¤ä¸ªæ›´æœ‰å¯èƒ½ï¼Œå› ä¸ºç¥ç»ç½‘ç»œæ¯”é€»è¾‘å›å½’æ›´å¤æ‚ï¼Œå› æ­¤æ›´å®¹æ˜“æ¥å—è¿™ç±»é—®é¢˜ã€‚é€šå¸¸ï¼Œè¿‡åº¦æ‹Ÿåˆå¯ä»¥é€šè¿‡ä½¿ç”¨**ä¸¢å¼ƒ**æ¥è§£å†³ï¼Œè¿™ä»…ä»…æ„å‘³ç€åœ¨è®­ç»ƒæ—¶ç¦ç”¨éšæœºé€‰å–çš„æ¨¡å‹èŠ‚ç‚¹çš„ä¸€éƒ¨åˆ†ã€‚å¯¹äº PyTorch æ¥è¯´ï¼Œè¿™æ„å‘³ç€åœ¨`__init__()`ä¸­åˆå§‹åŒ–ä¸€ä¸ª`nn.Dropout()`å±‚ï¼Œå¹¶ç”¨ ReLU æŠŠå®ƒæ”¾åœ¨å±‚ä¹‹é—´ã€‚ä¸‹é¢æ˜¯å®ç°è¿‡ç¨‹:

æˆ‘ä»¬åªéœ€åˆå§‹åŒ–â€œnn.Dropoutâ€çš„ä¸€ä¸ªå®ä¾‹ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨æ¨¡å‹ç±»çš„ forward å‡½æ•°ä¸­å¤šæ¬¡ä½¿ç”¨ã€‚

å°½ç®¡å¦‚æ­¤ï¼Œè¯¥æ¨¡å‹åœ¨æµ‹è¯•æ•°æ®é›†ä¸Šçš„å‡†ç¡®ç‡ä»ä¿æŒåœ¨ 70%å·¦å³ã€‚

ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå³ä½¿è¿™æ ·ä¹Ÿä¸èµ·ä½œç”¨ï¼Œè¿™æ„å‘³ç€æ¨¡å‹æ²¡æœ‰è¿‡åº¦æ‹Ÿåˆè®­ç»ƒæ•°æ®ã€‚æœ€åï¼Œä¸ºäº†æµ‹è¯•æˆ‘ä»¬çš„å‡è®¾#4ï¼Œæˆ‘åœ¨é€»è¾‘å›å½’å™¨ä¸Šé‡æ–°æŸ¥çœ‹äº†æˆ‘çš„æ—§ç¬”è®°æœ¬ï¼Œå¹¶ç”¨è¿™ä¸ªæ¨¡å‹è¿›è¡Œäº†å‡ æ¬¡è¯•éªŒã€‚**äº‹å®è¯æ˜ï¼Œé€»è¾‘å›å½’å™¨ä¸Šæ¬¡ 74%çš„å‡†ç¡®ç‡æ˜¯ç›¸å½“å¹¸è¿çš„ã€‚**äº‹å®ä¸Šï¼Œè®©æˆ‘ä»¬å†æ¥çœ‹çœ‹#ä¸ªæ—¶æœŸçš„ç²¾åº¦å›¾:

å‡†ç¡®æ€§åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ç›¸å½“ä¸ç¨³å®šçš„ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œå®ƒå¾˜å¾Šåœ¨ 70%å·¦å³ï¼Œè¿™æ›´ç±»ä¼¼äºæˆ‘åæ¥åœ¨é€»è¾‘å›å½’å’Œæœ¬æ–‡ä¸­çš„ç¥ç»ç½‘ç»œä¸Šè¿è¡Œçš„è¯•éªŒã€‚

# ç»“è®º

é€šè¿‡è¿™ä¸ªä¾‹å­ï¼Œæ·±åº¦å­¦ä¹ å­¦ç§‘å¯ä»¥å­¦åˆ°å¾ˆå¤šä¸œè¥¿ã€‚ä¸»è¦æ˜¯ï¼Œæ·±åº¦å­¦ä¹ ä¸æ˜¯å·«æ¯’é­”æ³•ï¼›å®ƒä¸èƒ½ç¥å¥‡åœ°è§£å†³ä½ ç»™å®ƒçš„æ¯ä¸€ä¸ªåˆ†ç±»é—®é¢˜ã€‚å®ƒä¸èƒ½é¢„æµ‹æ¯ä¸€åœºè‹±é›„è”ç›Ÿçš„æ¯”èµ›ï¼›åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ¯”èµ›çš„å‰ 10 åˆ†é’Ÿä¸è¶³ä»¥å†³å®šå“ªæ”¯çƒé˜Ÿä¼šèµ¢(æˆ‘å¯ä»¥é€šè¿‡æˆ‘çš„ç»éªŒè¯æ˜)ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä»è¿™ç§ç»å†ä¸­è¿˜æ˜¯æœ‰å¾ˆå¤šæ”¶è·çš„ï¼Œæ¯”å¦‚å­¦ä¹ ç¥ç»ç½‘ç»œçš„æ¦‚å¿µå¹¶åœ¨ PyTorch ä¸­å®ç°å®ƒï¼Œåˆ©ç”¨ GPUï¼Œä»¥åŠåœ¨æ¨¡å‹è¿‡æ‹Ÿåˆçš„æƒ…å†µä¸‹é€€å‡ºã€‚åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘å¸Œæœ›ä½ å–œæ¬¢å’Œæˆ‘ä¸€èµ·ä¸ºè¿™ä¸ªè‹±é›„è”ç›Ÿæ•°æ®é›†æ„å»º PyTorch æ¨¡å‹çš„æ—…ç¨‹ã€‚ç¼–ç å¿«ä¹(è¿˜æœ‰ç»§ç»­æ‰“è”èµ›)ï¼

> å¦‚æœä½ æƒ³çŸ¥é“è¿™ä¸ªè¿·ä½ é¡¹ç›®ä½¿ç”¨çš„ jupyter ç¬”è®°æœ¬çš„æ¥æºï¼Œè¯·çœ‹è¿™é‡Œ:[https://jovian.ml/richardso21/lol-nn](https://jovian.ml/richardso21/lol-nn)ã€‚