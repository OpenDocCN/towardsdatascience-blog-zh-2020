<html>
<head>
<title>Cross Platform NLP GUI on Flutter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于颤振的跨平台NLP图形用户界面</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cross-platform-nlp-gui-on-flutter-75d59170864?source=collection_archive---------14-----------------------#2020-01-27">https://towardsdatascience.com/cross-platform-nlp-gui-on-flutter-75d59170864?source=collection_archive---------14-----------------------#2020-01-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="358f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Flutter + Python REST后端的情感分析GUI</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ed10533164ed9236b4d332e40fbeeeb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AjCMJbeBnv2vVDjiNJB3pw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">适用于Android、平板电脑和网络(iOS也是！)</p></figure><h1 id="8fdf" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">目标:</h1><p id="39fd" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">根据我的<a class="ae mm" href="https://medium.com/flutter-community/nlp-chat-on-flutter-azure-676aa4768fbb" rel="noopener">上一篇文章</a> [2]，我启动了一个项目来构建一个黑仔聊天应用程序，该应用程序利用NLP情绪分析器在实时聊天中执行实时聊天分析。本文是该项目的R &amp; D阶段:</p><ul class=""><li id="050e" class="mn mo it ls b lt mp lw mq lz mr md ms mh mt ml mu mv mw mx bi translated">用于情感分析的后端REST服务</li><li id="7b4d" class="mn mo it ls b lt my lw mz lz na md nb mh nc ml mu mv mw mx bi translated">前端可视化工具来查看模型产生的结果</li></ul><p id="1890" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">虽然我可以在Python笔记本中更容易地做到这一点，但我最终将在Flutter中构建聊天GUI，所以这是一个很好的实践！</p><h1 id="e745" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated"><strong class="ak">后端Python服务</strong></h1><p id="a538" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">在对NLP情感分析器的变体进行了大量研究之后[4]，我挑选了几个简单的进行交叉比较:</p><ul class=""><li id="47f3" class="mn mo it ls b lt mp lw mq lz mr md ms mh mt ml mu mv mw mx bi translated">维德</li><li id="1df9" class="mn mo it ls b lt my lw mz lz na md nb mh nc ml mu mv mw mx bi translated">文本Blob</li><li id="55ce" class="mn mo it ls b lt my lw mz lz na md nb mh nc ml mu mv mw mx bi translated">Azure文本分析(认知服务)</li><li id="f727" class="mn mo it ls b lt my lw mz lz na md nb mh nc ml mu mv mw mx bi translated">谷歌云自然语言API</li></ul><p id="15eb" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">还有十几个其他的库，我计划建立我自己的“Foo NLP”(<em class="ng">为了体验</em>)，我将在另一个博客中详述。最终，我会添加圣杯BERT [5],但这需要一些关于如何微调和操作w/o的策略，这让我在Azure上花费了$$$计算时间。</p><p id="c420" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">我的REST API有一个简单的接口:</p><ul class=""><li id="364d" class="mn mo it ls b lt mp lw mq lz mr md ms mh mt ml mu mv mw mx bi translated">输入:文本字符串</li><li id="597e" class="mn mo it ls b lt my lw mz lz na md nb mh nc ml mu mv mw mx bi translated">输出:情绪得分(-1到+1，即从负到正的范围)</li></ul><p id="339d" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">URL获取格式为"<a class="ae mm" href="http://nlp.foostack.ai/nlp/sa/all?data=I%20love%20you" rel="noopener ugc nofollow" target="_blank"><strong class="ls iu"><em class="ng">【http://nlp.foostack.ai/nlp/sa/all?textinput=I爱你】</em></strong></a><strong class="ls iu"><em class="ng">"</em></strong>您可以现场测试并查看其余JSON结果:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/b7759ca4dd25e5ea382e1dafcea8c166.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T6SlicRdq3b-3D5nBj1ixg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">休息服务结果</p></figure><p id="f9d9" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">Python实现使用了<a class="ae mm" href="http://flask.palletsprojects.com/en/1.1.x/" rel="noopener ugc nofollow" target="_blank"> Flask </a> web框架，并公开了一个REST API，该API反过来调用一些NLP情感分析器库或web服务，并将结果聚合到JSON响应中。Azure上简单而便宜的托管服务。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">REST服务的代码[1]</p></figure><h1 id="e6ad" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">颤振跨平台图形用户界面</h1><p id="c227" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">大多数人都知道Flutter是一个很棒的Android+iOS跨平台开发系统，但截至2019年年中，它还做Web。网络支持工作得非常好，尽管有它的怪癖:</p><ul class=""><li id="241f" class="mn mo it ls b lt mp lw mq lz mr md ms mh mt ml mu mv mw mx bi translated">一些第三方控件可能无法工作。(例如，Url启动器直到最近升级后才在web上运行)</li><li id="c991" class="mn mo it ls b lt my lw mz lz na md nb mh nc ml mu mv mw mx bi translated">复制-粘贴在Web中不起作用。文本等看起来像不可点击的图像或奇怪的东西(我需要进一步调查)</li><li id="969a" class="mn mo it ls b lt my lw mz lz na md nb mh nc ml mu mv mw mx bi translated">开发周期是一个有点笨重的单独构建和测试web</li><li id="75de" class="mn mo it ls b lt my lw mz lz na md nb mh nc ml mu mv mw mx bi translated">添加自定义web控件或HTML/JS似乎很困难</li></ul><p id="d1f6" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">最终，Flutter Web对FooStack的客户来说绰绰有余。</p><h1 id="2e87" class="ky kz it bd la lb lc ld le lf lg lh li jz lj ka lk kc ll kd lm kf ln kg lo lp bi translated">我的应用程序的结构</h1><p id="ac7b" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">Flutter将所有内容嵌套在子部件中。比如，垂直堆叠条目的列部件，增加空间的填充部件，标签的文本部件，等等。使一个简单的乐高式可互换系统。只需找出要抓取的组件，并将其堆叠在另一个小部件的上方、下方或内部。</p><h2 id="558c" class="nk kz it bd la nl nm dn le nn no dp li lz np nq lk md nr ns lm mh nt nu lo nv bi translated">我的Flutter应用程序的抽象结构:</h2><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="a1ec" class="nk kz it nx b gy ob oc l od oe">- &lt;Widget build&gt;<br/> - Scaffold               # shortcut with top,body,footer areas<br/>   - appBar:<br/>   - body:Center          # centers all subcomponents<br/>     - Column             # aligns subcomponents down the col<br/>       - Padding<br/>       - Text             # title (Foo Sentiment Analyzer)<br/>       - ContrainedBox    # width controlling container<br/>        - TextFormField   # input box for text to analyze<br/>       - FlatButton       # submit button<br/>       - Text             # title (Results)<br/>       - Wrap             # wrap n-results across and down <br/>        - Container<br/>         - Column         # single column result table <br/>          - DataTable     # formatted results table<br/>            - DataColumns # headers  <br/>            - DataCells   # rows<br/>   - floatingButton:      # bottom right help button</span></pre><h2 id="20eb" class="nk kz it bd la nl nm dn le nn no dp li lz np nq lk md nr ns lm mh nt nu lo nv bi translated">相同逻辑应用的可视化:</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/6201576213e99e44037b73cce8645c93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eOI8I8FNauBGz1F0Itv1xg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">颤振代码/布局的直观表示</p></figure><h2 id="e9a9" class="nk kz it bd la nl nm dn le nn no dp li lz np nq lk md nr ns lm mh nt nu lo nv bi translated">应用程序的实际飞镖/颤振代码</h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ni nj l"/></div></figure><p id="8830" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">另一个有趣的代码是我们如何从GUI调用REST服务。在Go按钮上，我们有一个事件处理程序“onPressed ”,它被映射到<strong class="ls iu"> <em class="ng"> _submit </em> </strong>函数。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="a137" class="nk kz it nx b gy ob oc l od oe"><strong class="nx iu">FlatButton </strong>(<br/>  child: Text(<strong class="nx iu">'</strong>Go<strong class="nx iu">'</strong>),<br/>  color: Colors.<em class="ng">blue</em>,<br/>  textColor: Colors.<em class="ng">white</em>,<br/><strong class="nx iu">  onPressed: _submit,<br/></strong>),</span></pre><p id="f419" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">我们将submit()定义为一个向REST服务发出HTTP请求并返回JSON的方法。JSON被重新映射到供GUI处理的映射列表。还有更多关于GUI如何自动更新的内容，我就不多说了(StatefulWidgets等)。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="38c4" class="nk kz it nx b gy ob oc l od oe"><strong class="nx iu">void _submit() async {<br/><em class="ng"> </em></strong><em class="ng"> // call REST service and extract JSON body<br/>  </em>var host = 'http://flaskmli.azurewebsites.net/nlp/sa/alldata=';<em class="ng"><br/>  </em>var response = await http.get(host+inputController.text);<br/>  var resp = response.body;</span><span id="fa00" class="nk kz it nx b gy og oc l od oe"><em class="ng">  // extract JSON "results" array to a Map (dictionary)<br/>  // push it onto the new dataList array (list of Maps)<br/></em>  Map&lt;String, dynamic&gt; nlps = jsonDecode(resp);<br/>  List&lt;dynamic&gt; results = nlps['results'];<br/>  List&lt;Map&lt;String, dynamic&gt;&gt; dataList = [];<br/>  results.forEach((result) {<br/>    dataList.add(result);<br/>  });</span><span id="31ab" class="nk kz it nx b gy og oc l od oe"><em class="ng">  // bit of hack here, add input text to _rawContentList<br/></em>  _rawContentList.insert(0,[dataList, inputController.text])<em class="ng"><br/>  </em>inputController.text = '';</span><span id="165a" class="nk kz it nx b gy og oc l od oe"><em class="ng">  // reset focus (clears keyboard on mobile devices)<br/></em>  FocusScope.<em class="ng">of</em>(context).requestFocus(FocusNode());<br/>  setState(() {});   <em class="ng">// make GUI refresh from _rawContentList</em><br/>}</span></pre><p id="d600" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated"><strong class="ls iu">都搞定了！</strong> <em class="ng">我越来越擅长旋舞了，这个只用了几天就造好了。</em></p><p id="b9f7" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">我可以通过Android Studio和谷歌Play商店开发并发布我的Android、平板电脑和iPhone应用程序。要发布我的Flutter Web应用程序，我只需运行“flutter build web”并手动将web/build构件部署到我的Web服务器上(实际上是将它们复制到一个现有的站点上，在我的例子中是复制到<a class="ae mm" href="http://foostack.ai/nlp" rel="noopener ugc nofollow" target="_blank">http://foostack.ai/nlp</a>——请随意测试)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/66d401558e51f5d78a9148f80df6225b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2RZ277Klt5OMrTEjzkSMVQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">现场Foostack NLP试用<a class="ae mm" href="http://foostack.ai/nlp" rel="noopener ugc nofollow" target="_blank">http://foostack.ai/nlp</a></p></figure><p id="8bcd" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">感谢阅读。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h2 id="c547" class="nk kz it bd la nl nm dn le nn no dp li lz np nq lk md nr ns lm mh nt nu lo nv bi translated"><strong class="ak">参考与启示</strong></h2><p id="abba" class="pw-post-body-paragraph lq lr it ls b lt lu ju lv lw lx jx ly lz ma mb mc md me mf mg mh mi mj mk ml im bi translated">[1]之前我的Flutter NLP聊天项目的文章—<a class="ae mm" href="https://medium.com/flutter-community/nlp-chat-on-flutter-azure-676aa4768fbb" rel="noopener">https://medium . com/Flutter-community/NLP-Chat-on-Flutter-azure-676 a 4768 fbb</a></p><p id="05c6" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">[2]学习颤振的前期文章—<a class="ae mm" href="https://codeburst.io/why-i-a-sr-manager-learned-flutter-8da9a05b2326?source=---------5------------------" rel="noopener" target="_blank">https://code burst . io/why-I-a-Sr-manager-learned-Flutter-8d a9 a 05 b 2326？来源= - 5 - </a></p><p id="4038" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">[3]启发我的好文章—<a class="ae mm" rel="noopener" target="_blank" href="/a-practitioners-guide-to-natural-language-processing-part-i-processing-understanding-text-9f4abfd13e72">https://towards data science . com/a-practices-guide-to-natural-language-processing-part-I-processing-understanding-text-9 F4 abfd 13 e 72</a></p><p id="7749" class="pw-post-body-paragraph lq lr it ls b lt mp ju lv lw mq jx ly lz nd mb mc md ne mf mg mh nf mj mk ml im bi translated">[4]关于BERT和一些其他NLP模型的一些信息—<a class="ae mm" href="https://medium.com/swlh/bert-bidirectional-encoder-representations-from-transformers-c1ba3ef5e2f4" rel="noopener">https://medium . com/swlh/BERT—双向—编码器—表示—来自—变压器—C1 ba 3 ef 5 e 2 f 4</a></p></div></div>    
</body>
</html>