<html>
<head>
<title>Draw Beautiful and Interactive Line Charts Using Bokeh in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 中的散景绘制漂亮的交互式折线图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/draw-beautiful-and-interactive-line-charts-using-bokeh-in-python-9f3e11e0a16e?source=collection_archive---------24-----------------------#2020-06-17">https://towardsdatascience.com/draw-beautiful-and-interactive-line-charts-using-bokeh-in-python-9f3e11e0a16e?source=collection_archive---------24-----------------------#2020-06-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div class="gh gi ir"><img src="../Images/346ce85111fbd9b3a25bd0539a76bbc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*-rLpXQdbA7FBU44rRDT3UQ.png"/></div><p class="iy iz gj gh gi ja jb bd b be z dk translated"><em class="jc">作者使用散景拍摄的图片</em></p></figure><div class=""/><div class=""><h2 id="dee3" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">数据分析师/科学家必须了解的 Python 可视化库</h2></div><p id="e7be" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">折线图可能是展示两个维度之间关系的最基本但最有用的图表。通常用于连续显示变量<code class="fe lq lr ls lt b">y</code>在时间轴<code class="fe lq lr ls lt b">x</code>上的方差，其中 x 轴必须排序。</p><p id="71dc" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">很容易从折线图中获得洞察力，如变量是增加、减少还是波动，以及获得其周期模式、峰值和尖峰。此外，我们可以在折线图上绘制多条线，以比较它们在同一时间窗口内的不同趋势，有时甚至可以了解它们如何相互影响。</p><p id="f321" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这篇文章中，我将演示如何使用 Bokeh，Python 中最流行的可视化库之一，来绘制一个漂亮的交互式折线图。</p><h1 id="f1b2" class="lu lv jf bd lw lx ly lz ma mb mc md me kl mf km mg ko mh kp mi kr mj ks mk ml bi translated">什么是散景？</h1><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mm"><img src="../Images/8572c0f1b4467c0e254049076d09dad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*cHEoKvbH9FZ-JAYf"/></div></div><p class="iy iz gj gh gi ja jb bd b be z dk translated"><a class="ae mv" href="https://unsplash.com/@ben_wong_31?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Benjamin Wong </a>在<a class="ae mv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="c20f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">官网对散景的定义非常好，如下。</p><blockquote class="mw mx my"><p id="6d25" class="ku kv mz kw b kx ky kg kz la lb kj lc na le lf lg nb li lj lk nc lm ln lo lp im bi translated">Bokeh 是一个用于现代网络浏览器的交互式可视化库。它提供了优雅、简洁的通用图形结构，并在大型或流式数据集上提供了高性能的交互性。散景可以帮助任何人快速方便地制作交互式绘图、仪表盘和数据应用程序。</p></blockquote><p id="65ae" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">基本上，散景可以帮助我们在网页中生成可视化效果，可以用任何流行的浏览器查看。不过需要强调的是，它还支持 Jupyter 笔记本。因此，您不必每次都在浏览器上的单独选项卡中生成图表。它就像 Matplotlib 一样，可以把你笔记本上直接渲染的数据绘制出来。</p><h1 id="769b" class="lu lv jf bd lw lx ly lz ma mb mc md me kl mf km mg ko mh kp mi kr mj ks mk ml bi translated">安装和导入</h1><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nd"><img src="../Images/4740a59766f0179b0100b7ba55a782b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*G-d2uZoJDH51LC_r"/></div></div><p class="iy iz gj gh gi ja jb bd b be z dk translated">照片由 K . I . I . A . N 拍摄📷 on <a class="ae mv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="7e07" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">安装散景非常容易。只需在命令行中运行<code class="fe lq lr ls lt b">pip</code>就可以获得它。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="84e0" class="ni lv jf lt b gy nj nk l nl nm">pip install bokeh</span></pre><p id="3d05" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">大多数时候，我会如下导入散景，这只是将被利用的基本包。当然，当有一些定制的需求时，我们可能需要导入更多的功能。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="273c" class="ni lv jf lt b gy nj nk l nl nm">from bokeh.plotting import figure, output_notebook, show</span></pre><p id="2598" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lq lr ls lt b">figure</code>包是我们用来绘制数据的主要包。<code class="fe lq lr ls lt b">show</code>包将在单独的网页中或者直接在笔记本上呈现图表。只有当我们想要在笔记本中渲染图表时，才需要<code class="fe lq lr ls lt b">output_notebook</code>，所以在本教程中我们需要它。</p><p id="35c7" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一旦我们导入了<code class="fe lq lr ls lt b">output_notebook</code>，我们只需要运行这个函数来启用“笔记本模式”。</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/1aa10113ba4821c4ad8cdd8440063d08.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*64FMnk4F-PhMnySX6uSICA.png"/></div></figure><p id="eaec" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我们应该开始了。</p><h1 id="742d" class="lu lv jf bd lw lx ly lz ma mb mc md me kl mf km mg ko mh kp mi kr mj ks mk ml bi translated">基本折线图</h1><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi no"><img src="../Images/98d8edfb911200c4f216d25c16954074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_FYmJJ9CRSK7TB8R"/></div></div><p class="iy iz gj gh gi ja jb bd b be z dk translated">照片由<a class="ae mv" href="https://unsplash.com/@sergeytrofimov?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Serghei Trofimov </a>在<a class="ae mv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="8cf2" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们从一些基本的开始。虽然 Matplotlib 也能很好地完成这项工作，但 Bokeh 让事情变得更直观，也更容易获得漂亮的效果。</p><p id="7013" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，我们需要生成一些随机数据。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="5e50" class="ni lv jf lt b gy nj nk l nl nm">import numpy as np</span><span id="a5fa" class="ni lv jf lt b gy np nk l nl nm"># Generate random data<br/>x = np.arange(1, 11)<br/>y = np.random.rand(10)</span></pre><p id="c75f" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后，初始化图形的“画布”。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="5fa6" class="ni lv jf lt b gy nj nk l nl nm"># Generate canvas<br/>fig = figure(title='Line Chart Example',<br/>             x_axis_label='x',<br/>             y_axis_label='y',<br/>             width=800,<br/>             height=400)</span></pre><p id="1829" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里的<code class="fe lq lr ls lt b">width</code>和<code class="fe lq lr ls lt b">height</code>是实际像素，与 Matplotlib 不同。事实上，我喜欢使用这些像素，这对任何有一些 web 前端体验的人来说都更友好。</p><p id="e1ce" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">之后，让我们划清界限。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="a68f" class="ni lv jf lt b gy nj nk l nl nm"># Draw the line<br/>fig.line(x, y, <br/>         line_alpha=0.8,<br/>         legend_label='example value', <br/>         line_width=2)</span></pre><p id="5bb7" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如代码所示，我们可以使用<code class="fe lq lr ls lt b">line_alpha</code>设置线条的透明度，设置图例标签以及线条宽度。</p><p id="5429" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">最后，我们需要调用<code class="fe lq lr ls lt b">show(fig)</code>函数来渲染这个折线图。如果您正确运行了<code class="fe lq lr ls lt b">output_notebook()</code>，图表应该绘制如下。</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nq"><img src="../Images/7caabc94938f1aea9b049b7a74d70956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WlFBpXVu6R0wZEQmVJYsgw.png"/></div></div></figure><h1 id="302e" class="lu lv jf bd lw lx ly lz ma mb mc md me kl mf km mg ko mh kp mi kr mj ks mk ml bi translated">多行</h1><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nr"><img src="../Images/867f708b821af63af2b728c3371ba0b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uSBJIwOVk5Xbe4iA"/></div></div><p class="iy iz gj gh gi ja jb bd b be z dk translated">萨姆·普林在<a class="ae mv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="93ea" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果我们有多条线呢？散景提供了一个非常方便的功能<code class="fe lq lr ls lt b">multi_line()</code>，可以一次绘制多条线。</p><p id="6a9c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以继续使用<code class="fe lq lr ls lt b">x</code>系列，但是生成两个不同的<code class="fe lq lr ls lt b">y</code>系列。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="5e63" class="ni lv jf lt b gy nj nk l nl nm"># Generate two data series<br/>y1 = np.random.rand(10)<br/>y2 = np.random.rand(10) + 1</span></pre><p id="e8c3" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这里我只是在第二个<code class="fe lq lr ls lt b">y2</code>数据上加 1，使其高于<code class="fe lq lr ls lt b">y1</code>，没什么神奇的。</p><p id="d10c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后，让我们创建图形并绘制两条线。不要忘记“显示()”它。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="0cf5" class="ni lv jf lt b gy nj nk l nl nm"># Multiple Lines<br/>fig = figure(title='Multi-Line Chart Example', width=800, height=400)</span><span id="7c5a" class="ni lv jf lt b gy np nk l nl nm"># Draw two lines<br/>fig.multi_line([x, x], [y1, y2], <br/>               color=['blue', 'red'], <br/>               alpha=[1, 0.3], <br/>               line_width=2)</span><span id="10e0" class="ni lv jf lt b gy np nk l nl nm"># Show the figure<br/>show(fig)</span></pre><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi ns"><img src="../Images/ab0f45ee74b140a5a5d1eaa36cd0bd47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XZb2IUyuJQ0zRcWh2w4IyQ.png"/></div></div></figure><h1 id="8b38" class="lu lv jf bd lw lx ly lz ma mb mc md me kl mf km mg ko mh kp mi kr mj ks mk ml bi translated">互动功能</h1><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nt"><img src="../Images/cbedae0e5db1cb93b25c2cc4fb6e0604.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*m9RcBOy0ythb4CZQ"/></div></div><p class="iy iz gj gh gi ja jb bd b be z dk translated"><a class="ae mv" href="https://unsplash.com/@agkdesign?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">亚历山大·奈特</a>在<a class="ae mv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="b672" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">到目前为止，与 Matplotlib 相比没有太大的不同，除了散景更漂亮。但是等等，你有没有注意到图表右边有一个工具栏。默认工具包括</p><ul class=""><li id="92b1" class="nu nv jf kw b kx ky la lb ld nw lh nx ll ny lp nz oa ob oc bi translated">平移手势</li><li id="1c1b" class="nu nv jf kw b kx od la oe ld of lh og ll oh lp nz oa ob oc bi translated">框放大</li><li id="687e" class="nu nv jf kw b kx od la oe ld of lh og ll oh lp nz oa ob oc bi translated">鼠标滚轮放大/缩小</li><li id="b595" class="nu nv jf kw b kx od la oe ld of lh og ll oh lp nz oa ob oc bi translated">将图形保存为 PNG 图像</li><li id="53a2" class="nu nv jf kw b kx od la oe ld of lh og ll oh lp nz oa ob oc bi translated">重置位置和缩放级别</li><li id="7b4e" class="nu nv jf kw b kx od la oe ld of lh og ll oh lp nz oa ob oc bi translated">帮助</li></ul><p id="50c1" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">生成图表时，可以启用更多支持的交互式功能。你可以参考官方文档来获得更多的细节，但是我相信这些默认工具对于大多数场景来说已经足够了。</p><h1 id="236a" class="lu lv jf bd lw lx ly lz ma mb mc md me kl mf km mg ko mh kp mi kr mj ks mk ml bi translated">高级定制</h1><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi oi"><img src="../Images/de4cb95e60f4913f1ef6f9ef3c9dbe97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4K8AqR38aLKtYbYi"/></div></div><p class="iy iz gj gh gi ja jb bd b be z dk translated"><a class="ae mv" href="https://unsplash.com/@jeshoots?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">JESHOOTS.COM</a>在<a class="ae mv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="1980" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有时，出于某种原因，我们可能需要定制我们的折线图。在这一节中，我将提供一些例子。</p><p id="89fa" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">比方说，我们想比较一些数学函数，以了解它们在 x 变大时的趋势。这些功能如下:</p><ul class=""><li id="d6c0" class="nu nv jf kw b kx ky la lb ld nw lh nx ll ny lp nz oa ob oc bi translated">y=x</li><li id="aa09" class="nu nv jf kw b kx od la oe ld of lh og ll oh lp nz oa ob oc bi translated">y=x</li><li id="2cc8" class="nu nv jf kw b kx od la oe ld of lh og ll oh lp nz oa ob oc bi translated">y=logx</li><li id="13e6" class="nu nv jf kw b kx od la oe ld of lh og ll oh lp nz oa ob oc bi translated">y=10^x</li><li id="30de" class="nu nv jf kw b kx od la oe ld of lh og ll oh lp nz oa ob oc bi translated">y=e^x</li></ul><p id="a253" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">让我们先生成数据。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="22b5" class="ni lv jf lt b gy nj nk l nl nm"># Generate functions and data<br/>x = np.arange(0, 3, 0.1)<br/>y1 = np.power(x, 2)<br/>y2 = np.log(x)<br/>y3 = np.power(10, x)<br/>y4 = np.exp(x)</span></pre><p id="f03c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">会有一些警告，因为 log0 是未定义的，但是不用担心，它将是 Numpy 数组中的一个<code class="fe lq lr ls lt b">-inf</code>。此外，Bokeh 足够聪明，可以在渲染数据时忽略该值。</p><h2 id="367d" class="ni lv jf bd lw oj ok dn ma ol om dp me ld on oo mg lh op oq mi ll or os mk ot bi translated">y 轴刻度和数据点形状</h2><p id="fa0c" class="pw-post-body-paragraph ku kv jf kw b kx ou kg kz la ov kj lc ld ow lf lg lh ox lj lk ll oy ln lo lp im bi translated">现在，我们可以再次使用<code class="fe lq lr ls lt b">multi_line()</code>函数来一次绘制所有的函数。但是，我想一个一个地做这件事，因为我认为把线和它们的配置分开会更清楚。当然，选择哪种方式取决于你。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="f576" class="ni lv jf lt b gy nj nk l nl nm">fig = figure(title='Compare the Trends of Different Functions', width=800, height=400)<br/>fig.line(x, x, legend_label='y=x', color='blue')<br/>fig.line(x, y1, legend_label='y=x^2', color='red')<br/>fig.line(x, y2, legend_label='y=logx', color='green')<br/>fig.line(x, y3, legend_label='y=10^x', color='purple')<br/>fig.line(x, y4, legend_label='y=e^x', color='brown')<br/>show(fig)</span></pre><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi oz"><img src="../Images/578d46966eab55caad9b09157c96b5cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hU-CTtxg4Tg80qTWKBfHWQ.png"/></div></div></figure><p id="ce99" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">嗯，它已经被正确地绘制出来了，但是它是不可用的。除了<code class="fe lq lr ls lt b">y=10^x</code>这个功能，其他都挤在一起了。所以，用这个折线图，我们实际上不能比较趋势。</p><p id="1ebb" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">解决方法是修改 y 轴的比例。如果我们可以使 y 轴不是线性的，它应该能够更清楚地区分功能。通过将<code class="fe lq lr ls lt b">y_axis_type</code>设置为<code class="fe lq lr ls lt b">log</code>，散景可以非常容易地做到这一点。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="7cd5" class="ni lv jf lt b gy nj nk l nl nm"># Generate figure object<br/>fig = figure(title='Compare the Trends of Different Functions', width=800, height=600, y_axis_type='log')</span></pre><p id="e88c" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">还有一个问题。即使我们为这些功能使用了不同的颜色，仍然不容易区分它们。让我们也为不同函数的数据点添加不同的形状。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="b97c" class="ni lv jf lt b gy nj nk l nl nm"># Use blue colour and circle for y=x<br/>fig.line(x, x, legend_label='y=x', color='blue', line_width=2)<br/>fig.circle(x, x, legend_label='y=x', color='blue', fill_color='white', size=5)</span><span id="0e09" class="ni lv jf lt b gy np nk l nl nm"># Use red colour and triangle for y=x^2<br/>fig.line(x, y1, legend_label='y1=x^2', color='red', line_width=2)<br/>fig.triangle(x, y1, legend_label='y1=x^2', color='red', fill_color='white', size=5)</span><span id="07a3" class="ni lv jf lt b gy np nk l nl nm"># Use green colour and square for y=logx<br/>fig.line(x, y2, legend_label='y2=logx', color='green', line_width=2)<br/>fig.square(x, y2, legend_label='y2=logx', color='green', fill_color='white', size=5)</span><span id="de79" class="ni lv jf lt b gy np nk l nl nm"># Use purple colour and diamond for y=10^x<br/>fig.line(x, y3, legend_label='y3=10^x', color='purple', line_width=2)<br/>fig.diamond(x, y3, legend_label='y3=10^x', color='purple', fill_color='white', size=5)</span><span id="3f9e" class="ni lv jf lt b gy np nk l nl nm"># Use brown colour and hexgon for y=e^x<br/>fig.line(x, y4, legend_label='y4=e^x', color='brown', line_width=2)<br/>fig.hex(x, y4, legend_label='y4=e^x', color='brown', fill_color='white', size=5)</span></pre><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi pa"><img src="../Images/a87ea8282faafcb237d0348c66315d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SjHlB41Xua72aV6Vg0Hy-w.png"/></div></div></figure><p id="7af1" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">酷！现在，我们可以很容易地确定这些函数及其趋势。</p><h2 id="6193" class="ni lv jf bd lw oj ok dn ma ol om dp me ld on oo mg lh op oq mi ll or os mk ot bi translated">图例位置和隐藏</h2><p id="eb11" class="pw-post-body-paragraph ku kv jf kw b kx ou kg kz la ov kj lc ld ow lf lg lh ox lj lk ll oy ln lo lp im bi translated">这个图形现在看起来不错，但是如果我们能够将图例重新定位到左上角，那就更好了，因为那里什么也没有。此外，该图中仍然有太多的线条，我们可能希望隐藏其中的一些线条，以便我们可以一次只比较其中的几条。</p><p id="6ff6" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">是的，散景很容易做到这一点。实际上，我们甚至不需要再次生成那个数字。因为我们有了图形对象<code class="fe lq lr ls lt b">fig</code>，我们可以直接修改它的属性来实现这些。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="6c8d" class="ni lv jf lt b gy nj nk l nl nm"># Relocate Legend<br/>fig.legend.location = 'top_left'<br/># Click to hide/show lines<br/>fig.legend.click_policy = 'hide'</span></pre><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi pb"><img src="../Images/b8083c060a5d39c8060f574ca967eea0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ws6GA7gnBBmf_J0-RsWXDA.png"/></div></div></figure><h2 id="fcf2" class="ni lv jf bd lw oj ok dn ma ol om dp me ld on oo mg lh op oq mi ll or os mk ot bi translated">带工具提示悬停</h2><p id="cbd5" class="pw-post-body-paragraph ku kv jf kw b kx ou kg kz la ov kj lc ld ow lf lg lh ox lj lk ll oy ln lo lp im bi translated">现在，假设我们希望将鼠标悬停在这些线上以获取数据点的值。我们也可以在散景中轻松实现这一点。此外，我们不需要重新生成图形，因为我们可以向图形对象添加“工具提示”。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="b5fd" class="ni lv jf lt b gy nj nk l nl nm">from bokeh.models.tools import HoverTool</span><span id="c612" class="ni lv jf lt b gy np nk l nl nm">fig.add_tools(HoverTool(<br/>    tooltips=[<br/>        ('(x, y)', '(<a class="ae mv" href="http://twitter.com/x" rel="noopener ugc nofollow" target="_blank">@x</a>, <a class="ae mv" href="http://twitter.com/y" rel="noopener ugc nofollow" target="_blank">@y</a>)')<br/>    ]<br/>))</span></pre><p id="5c84" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们需要导入<code class="fe lq lr ls lt b">HoverTool</code>类，以便将其作为“工具”添加到 figure 对象中。请注意，散景使得自定义工具提示变得非常灵活。具体来说，我们可以将每行文本定义为一个元组。对于元组的第二个值，我们可以使用<code class="fe lq lr ls lt b">@</code>符号来指代数据字段。在这个例子中，我只定义了一个元组。如果您用不同的格式和/或数据字段定义了多个元组，工具提示将显示它们。</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi pc"><img src="../Images/781513cf0d5ee62f8dc3d1c5a0aecff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jUbiMaffN4ASNq559t665w.png"/></div></div></figure><h2 id="1332" class="ni lv jf bd lw oj ok dn ma ol om dp me ld on oo mg lh op oq mi ll or os mk ot bi translated">用 HTML 模板定制工具提示</h2><p id="1090" class="pw-post-body-paragraph ku kv jf kw b kx ou kg kz la ov kj lc ld ow lf lg lh ox lj lk ll oy ln lo lp im bi translated">如果我们有更具体的要求呢？散景使得工具提示更加灵活，我们甚至可以使用 HTML 模板来定制工具提示。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="23a6" class="ni lv jf lt b gy nj nk l nl nm">fig.add_tools(HoverTool(<br/>    tooltips='&lt;font face="Arial" size="3"&gt;When x is <a class="ae mv" href="http://twitter.com/x" rel="noopener ugc nofollow" target="_blank">@x</a>{0.0}, y is <a class="ae mv" href="http://twitter.com/y" rel="noopener ugc nofollow" target="_blank">@y</a>{0.00}&lt;/font&gt;',<br/>    mode='vline'<br/>))</span></pre><p id="22b2" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请注意，我这次还加了<code class="fe lq lr ls lt b">mode='vline'</code>。这将在相同的垂直 x 轴位置显示所有行的工具提示。因此，它将显示所有不同<code class="fe lq lr ls lt b">y</code>的相同<code class="fe lq lr ls lt b">x</code>的值，这样更便于比较。</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi pd"><img src="../Images/035d7af055e897ee5a81b4b4707dbad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Osnzd2Np4JsrA7Pqa7uKdA.png"/></div></div></figure><h1 id="bc92" class="lu lv jf bd lw lx ly lz ma mb mc md me kl mf km mg ko mh kp mi kr mj ks mk ml bi translated">洛伦兹吸引子</h1><p id="0cf4" class="pw-post-body-paragraph ku kv jf kw b kx ou kg kz la ov kj lc ld ow lf lg lh ox lj lk ll oy ln lo lp im bi translated">让我们用一个来自官方图库的花式折线图来完成这篇文章。散景确实很美。</p><pre class="mn mo mp mq gt ne lt nf ng aw nh bi"><span id="ab6a" class="ni lv jf lt b gy nj nk l nl nm">from scipy.integrate import odeint</span><span id="4277" class="ni lv jf lt b gy np nk l nl nm">sigma = 10<br/>rho = 28<br/>beta = 8.0/3<br/>theta = 3 * np.pi / 4</span><span id="bdf8" class="ni lv jf lt b gy np nk l nl nm">def lorenz(xyz, t):<br/>    x, y, z = xyz<br/>    x_dot = sigma * (y - x)<br/>    y_dot = x * rho - x * z - y<br/>    z_dot = x * y - beta* z<br/>    return [x_dot, y_dot, z_dot]</span><span id="3ce6" class="ni lv jf lt b gy np nk l nl nm">initial = (-10, -7, 35)<br/>t = np.arange(0, 100, 0.006)</span><span id="b7a9" class="ni lv jf lt b gy np nk l nl nm">solution = odeint(lorenz, initial, t)</span><span id="0455" class="ni lv jf lt b gy np nk l nl nm">x = solution[:, 0]<br/>y = solution[:, 1]<br/>z = solution[:, 2]<br/>xprime = np.cos(theta) * x - np.sin(theta) * y</span><span id="f9bb" class="ni lv jf lt b gy np nk l nl nm">colors = ["#C6DBEF", "#9ECAE1", "#6BAED6", "#4292C6", "#2171B5", "#08519C", "#08306B",]</span><span id="7b8c" class="ni lv jf lt b gy np nk l nl nm">fig = figure(title="Lorenz attractor example", background_fill_color="#fafafa")</span><span id="3f39" class="ni lv jf lt b gy np nk l nl nm">fig.multi_line(np.array_split(xprime, 7), np.array_split(z, 7),<br/>             line_color=colors, line_alpha=0.8, line_width=1.5)</span><span id="3681" class="ni lv jf lt b gy np nk l nl nm">show(fig)</span></pre><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi pe"><img src="../Images/e8fbecbbdf461ba0b3122a9c1544f8c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UpyGv5Q8iAD80plM00weJg.png"/></div></div></figure><h1 id="8a3c" class="lu lv jf bd lw lx ly lz ma mb mc md me kl mf km mg ko mh kp mi kr mj ks mk ml bi translated">摘要</h1><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi pf"><img src="../Images/9c85c1c9f9d930de99ecc5572d4ed3e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iCog2uWzThV5OIZQ"/></div></div><p class="iy iz gj gh gi ja jb bd b be z dk translated">照片由<a class="ae mv" href="https://unsplash.com/@sctgrhm?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">斯科特·格雷厄姆</a>在<a class="ae mv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="b9e3" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这篇文章中，我介绍了如何使用散景来绘制美丽的折线图。作为 Python 中最流行的可视化库之一，Bokeh 提供了许多开箱即用的可视化特性，如交互式工具集。当涉及到较低的水平，它也提供了非常灵活的功能，让我们自定义我们的数字。</p><div class="is it gp gr iu pg"><a href="https://medium.com/@qiuyujx/membership" rel="noopener follow" target="_blank"><div class="ph ab fo"><div class="pi ab pj cl cj pk"><h2 class="bd jg gy z fp pl fr fs pm fu fw je bi translated">通过我的推荐链接加入 Medium 克里斯托弗·陶</h2><div class="pn l"><h3 class="bd b gy z fp pl fr fs pm fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="po l"><p class="bd b dl z fp pl fr fs pm fu fw dk translated">medium.com</p></div></div><div class="pp l"><div class="pq l pr ps pt pp pu iw pg"/></div></div></a></div><p id="7d6b" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果你觉得我的文章有帮助，请考虑加入 Medium 会员来支持我和成千上万的其他作者！(点击上面的链接)</p><h1 id="765b" class="lu lv jf bd lw lx ly lz ma mb mc md me kl mf km mg ko mh kp mi kr mj ks mk ml bi translated">参考</h1><p id="e314" class="pw-post-body-paragraph ku kv jf kw b kx ou kg kz la ov kj lc ld ow lf lg lh ox lj lk ll oy ln lo lp im bi translated">[1]散景最新文档，<a class="ae mv" href="https://docs.bokeh.org/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">https://docs.bokeh.org/en/latest/index.html</a></p><p id="e5f2" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">[2]散景画廊，洛伦兹吸引子，【https://docs.bokeh.org/en/latest/docs/gallery/lorenz.html T2】</p></div></div>    
</body>
</html>