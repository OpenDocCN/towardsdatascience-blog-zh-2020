<html>
<head>
<title>Non-native Speaker Accent Feedback with ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带 ML 的非母语口音反馈</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/non-native-spanish-speaker-accent-feedback-with-ml-7f33f9a0fbb7?source=collection_archive---------37-----------------------#2020-05-20">https://towardsdatascience.com/non-native-spanish-speaker-accent-feedback-with-ml-7f33f9a0fbb7?source=collection_archive---------37-----------------------#2020-05-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5fe5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用谷歌云平台评估 20 多种语言的口音</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1532baef3eceb6ca4cdb9ea8c41a5d44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tZaIo7CnaX6WFhTM"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">乔恩·泰森在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="f272" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一位非母语人士正在学习西班牙语。你如何利用机器学习对他们的发音提供实时反馈？在本帖中，我们将介绍如何使用谷歌的语音转文本 API 在 20 多种语言中实现这一点。</p><p id="0628" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您可以访问包含给定单词的非本地和本地语音记录的数据库，则可以很容易地进行口音识别。事实上，机器学习甚至可能不是必要的——人们可以比较音频片段的频谱图和梅尔频率倒谱系数。对于那些不熟悉的人来说，频谱图和 Mel 系数代表录音中的频率/音高。对本地和非本地录音的系数进行简单的比较就可以做到这一点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/85c8f1a1d38c77594f575d8dda2c5fc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GKBDCGEqt7iRKPt4zCoPuQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">重音不正确的“Hola”声谱图</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/bda8bf2bd74017a6f9a29ef50eeb3705.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3WBITfv96WAwz5L3kjWpjQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">适当重音的“Hola”声谱图</p></figure><p id="d04b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">图中是两张“Hola”的光谱图。第一个声谱图显示不正确的重音，而第二个声谱图显示正确的重音。人们可以计算两个图形之间的差异来量化发音之间的相似性。然而，这种方法并不可靠。不同的音调会改变计算结果以及说话的速度。此外，如前所述，这种方法需要来自母语使用者的录音数据库。</p><p id="f1f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，如果没有录音数据库，我们必须采用不同的解决方案。<strong class="lb iu">我们可以使用谷歌的语音转文本 API，而不是创建自己的模型。谷歌的模型已经根据母语人士的声音进行了训练，因此只能识别与母语人士的声音足够相似的录音。</strong>因此，如果谷歌的文本到语音模型能够识别我们的发音，我们就可以假设我们正确地发音了。正如我们将看到的，如果我们提供一个带有刺耳口音的音频剪辑，模型将无法识别该语音。</p><p id="92c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们开始吧</p><p id="2615" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">1.如果您还没有 Google Cloud 帐户，请务必先创建一个。<a class="ae ky" href="https://cloud.google.com/" rel="noopener ugc nofollow" target="_blank">https://cloud.google.com/</a></p><p id="5bc6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2.在 Google Cloud 中创建一个新项目(您可以从您的 Google Cloud 控制台执行此操作)。</p><p id="1730" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">3.启用语音转文本 API<a class="ae ky" href="https://console.cloud.google.com/apis/library/speech.googleapis.com" rel="noopener ugc nofollow" target="_blank">https://console . cloud . Google . com/APIs/library/speech . Google APIs . com</a></p><p id="a94c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">4.录制自己朗读西班牙语单词，并将音频剪辑保存为 MP3。</p><p id="af6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">5.安装 python 谷歌云语音库</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="9a4a" class="mc md it ly b gy me mf l mg mh">pip install google-cloud-speech</span></pre><p id="7375" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">6.如果您没有应用程序密钥，请创建一个。<a class="ae ky" href="https://cloud.google.com/docs/authentication/getting-started" rel="noopener ugc nofollow" target="_blank">https://cloud . Google . com/docs/authentic ation/get-started</a>。</p><p id="def9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">7.将这一行添加到 python 文件的开头，以使用密钥</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="29fe" class="mc md it ly b gy me mf l mg mh">import os<br/>os.environ["GOOGLE_APPLICATION_CREDENTIALS"] = PATH TO YOUR APPLICATION KEY.json</span></pre><p id="36d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">7.将这段 python 代码添加到语音到文本识别中。该功能将转录音频，并给出一个置信度得分。</p><pre class="kj kk kl km gt lx ly lz ma aw mb bi"><span id="0606" class="mc md it ly b gy me mf l mg mh">from google.cloud import speech_v1p1beta1<br/>client = speech_v1p1beta1.SpeechClient()</span><span id="f301" class="mc md it ly b gy mi mf l mg mh">def sample_recognize(local_file_path):<br/>    """<br/>    Print confidence level for individual words in a transcription of a short audio<br/>    file.</span><span id="bdde" class="mc md it ly b gy mi mf l mg mh">Args:<br/>      local_file_path Path to local audio file, e.g. /path/audio.wav or .mp3<br/>    """</span><span id="22a6" class="mc md it ly b gy mi mf l mg mh">client = speech_v1p1beta1.SpeechClient()</span><span id="1413" class="mc md it ly b gy mi mf l mg mh"># When enabled, the first result returned by the API will include a list<br/># of words and the confidence level for each of those words.<br/>   <br/>    enable_word_confidence = True</span><span id="e42e" class="mc md it ly b gy mi mf l mg mh"># The language of the supplied audio<br/>    language_code = "es-ES"<br/>    config = {<br/>        "enable_word_confidence": enable_word_confidence,<br/>        "language_code": language_code,<br/>        "encoding": "MP3",<br/>        "audio_channel_count": 2</span><span id="af01" class="mc md it ly b gy mi mf l mg mh">}<br/>    with io.open(local_file_path, "rb") as f:<br/>        content = f.read()<br/>    audio = {"content": content}</span><span id="14cd" class="mc md it ly b gy mi mf l mg mh">    response = client.recognize(config, audio, )</span><span id="2ce3" class="mc md it ly b gy mi mf l mg mh">    if len(response.results == 0):<br/>        return "FAILED"</span><span id="4d02" class="mc md it ly b gy mi mf l mg mh">    result = response.results[0]</span><span id="339b" class="mc md it ly b gy mi mf l mg mh">    alternatives = result.alternatives[0]<br/>    <br/>    return result</span></pre><p id="3744" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请注意几个要素:</p><ul class=""><li id="03ae" class="mj mk it lb b lc ld lf lg li ml lm mm lq mn lu mo mp mq mr bi translated">通过设置 enable_word_confidence = True，模型将输出每个单词的概率，这允许我们更精确地看到用户的表现如何</li><li id="f027" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">language_code = "es-ES "将语言从西班牙设置为西班牙语。如果你想改变语言或国家，语言代码是 https://cloud.google.com/speech-to-text/docs/languages<a class="ae ky" href="https://cloud.google.com/speech-to-text/docs/languages" rel="noopener ugc nofollow" target="_blank"/></li><li id="9be0" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">“audio _ channel _ count”:2 对应于您的话筒设置方式。大多数电脑使用立体声音频(双声道)录音，但如果您的电脑只在一个声道录音，您可能需要更改这一点</li><li id="a1f2" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">请注意，如果 Google 的 API 无法识别这个单词，它将返回一个空列表，因此 if len(response.results) == 0</li><li id="1370" class="mj mk it lb b lc ms lf mt li mu lm mv lq mw lu mo mp mq mr bi translated">变量 alternatives 提供了该函数中未使用的替代结果列表</li></ul><p id="d831" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">通过检查该函数的输出是否等于您试图发音的单词，您可以评估您的口音。为了得到更精确的分数，你可以在结果中使用置信度这个词。</p><p id="3b3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经在 react 网站上实现了这种口音识别算法:【https://hablame.org/accent<a class="ae ky" href="https://hablame.org/accent" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="75e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">带口音识别软件的 Flask App 代码:<a class="ae ky" href="https://github.com/DanielLongo/AccentRecognition" rel="noopener ugc nofollow" target="_blank">https://github.com/DanielLongo/AccentRecognition</a></p></div></div>    
</body>
</html>