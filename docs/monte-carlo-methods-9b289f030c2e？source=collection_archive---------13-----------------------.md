# è’™ç‰¹å¡ç½—æ–¹æ³•

> åŽŸæ–‡ï¼š<https://towardsdatascience.com/monte-carlo-methods-9b289f030c2e?source=collection_archive---------13----------------------->

## [æ·±åº¦å¼ºåŒ–å­¦ä¹ è®²è§£â€” 13](https://towardsdatascience.com/tagged/deep-r-l-explained)

## æŽ¢ç´¢-è§£é‡Šå›°å¢ƒ

![](img/fa0f6596bcb8f7d913d0517d5a751d20.png)

åœ¨*[*æ·±åº¦å¼ºåŒ–å­¦ä¹ è®²è§£*](/value-iteration-for-q-function-ac9e508d85bd)*ç³»åˆ—çš„è¿™ç¯‡æ–°å¸–ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦ä¸€ç§ç»å…¸çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•æ¥ä¼°è®¡ä¸€ä¸ªç­–ç•¥Ï€çš„å€¼ã€‚æœ€ç›´æŽ¥çš„æ–¹æ³•æ˜¯è¿è¡Œå‡ é›†ï¼Œæ”¶é›†æ•°ç™¾æ¡è½¨è¿¹ï¼Œç„¶åŽè®¡ç®—æ¯ä¸ªå·žçš„å¹³å‡å€¼ã€‚è¿™ç§ä¼°è®¡ä»·å€¼å‡½æ•°çš„æ–¹æ³•å«åš**è’™ç‰¹å¡ç½—é¢„æµ‹** (MC)ã€‚**

**åœ¨æœ¬å¸–ä¸­ï¼Œæˆ‘ä»¬è¿˜å°†ä»‹ç»å¦‚ä½•è¯„ä¼°æœ€ä¼˜ç­–ç•¥å’Œ**å‹˜æŽ¢-å¼€é‡‡å›°å¢ƒ**ã€‚**

> **[æœ¬å‡ºç‰ˆç‰©çš„è¥¿ç­ç‰™è¯­ç‰ˆæœ¬](https://medium.com/aprendizaje-por-refuerzo/5-evaluaci%C3%B3n-de-pol%C3%ADticas-con-monte-carlo-a6d70d1db7d4)**

**[](https://medium.com/aprendizaje-por-refuerzo/5-evaluaci%C3%B3n-de-pol%C3%ADticas-con-monte-carlo-a6d70d1db7d4) [## 5.è’™ç‰¹å¡æ´›æ”¿æ²»è¯„ä¼°

### è¯·è®¿é—®ç¬¬ 5 é¡µçš„è‡ªç”±ä»‹ç»

medium.com](https://medium.com/aprendizaje-por-refuerzo/5-evaluaci%C3%B3n-de-pol%C3%ADticas-con-monte-carlo-a6d70d1db7d4) 

# è’™ç‰¹å¡æ´›ä¸ŽåŠ¨æ€è§„åˆ’

åœ¨æœ¬ç³»åˆ—çš„ç¬¬ 1 éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†ä¸€ç§ MDP çš„è§£å†³æ–¹æ¡ˆï¼Œç§°ä¸ºåŠ¨æ€ç¼–ç¨‹ï¼Œç”±ç†æŸ¥å¾·Â·è´å°”æ›¼é¦–åˆ›ã€‚è®°ä½ï¼Œè´å°”æ›¼æ–¹ç¨‹å…è®¸æˆ‘ä»¬é€’å½’åœ°å®šä¹‰å€¼å‡½æ•°ï¼Œå¹¶ä¸”å¯ä»¥ç”¨å€¼è¿­ä»£ç®—æ³•æ±‚è§£ã€‚æ€»è€Œè¨€ä¹‹ï¼ŒåŠ¨æ€ç¼–ç¨‹ä¸ºå¼ºåŒ–å­¦ä¹ æä¾›äº†åŸºç¡€ï¼Œä½†æˆ‘ä»¬éœ€è¦åœ¨æ¯æ¬¡è¿­ä»£ä¸­å¾ªçŽ¯éåŽ†æ‰€æœ‰çŠ¶æ€(å®ƒä»¬çš„å¤§å°å¯ä»¥å‘ˆæŒ‡æ•°çº§å¢žé•¿ï¼ŒçŠ¶æ€ç©ºé—´å¯ä»¥éžå¸¸å¤§ï¼Œä¹Ÿå¯ä»¥æ— é™å¤§)ã€‚åŠ¨æ€ç¼–ç¨‹è¿˜éœ€è¦çŽ¯å¢ƒçš„æ¨¡åž‹ï¼Œç‰¹åˆ«æ˜¯çŸ¥é“çŠ¶æ€è½¬ç§»æ¦‚çŽ‡*p(sâ€²ï¼Œr|sï¼Œa)* ã€‚

ç›¸æ¯”ä¹‹ä¸‹ï¼Œè’™ç‰¹å¡ç½—æ–¹æ³•éƒ½æ˜¯ä»Žç»éªŒä¸­å­¦ä¹ ã€‚ä»»ä½•æœŸæœ›å€¼éƒ½å¯ä»¥é€šè¿‡æ ·æœ¬å‡å€¼æ¥è¿‘ä¼¼â€”â€”æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯æ’­æ”¾ä¸€å †å‰§é›†ï¼Œæ”¶é›†å›žæŠ¥ï¼Œç„¶åŽå–å¹³å‡å€¼ã€‚è’™ç‰¹å¡ç½—æ–¹æ³•å®žé™…ä¸Šæ˜¯åŸºæœ¬ç®—æ³•çš„ä¸€ç»„æ›¿ä»£æ–¹æ¡ˆã€‚è¿™äº›ä»…é€‚ç”¨äºŽå¶å‘ä»»åŠ¡ï¼Œå½“ä»£ç†é‡åˆ°ç»ˆæ­¢çŠ¶æ€æ—¶ï¼Œäº¤äº’åœæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å‡è®¾ä½“éªŒè¢«åˆ†æˆå‡ é›†ï¼Œå¹¶ä¸”ä¸ç®¡é€‰æ‹©ä»€ä¹ˆåŠ¨ä½œï¼Œæ‰€æœ‰çš„é›†æœ€ç»ˆéƒ½ä¼šç»ˆæ­¢ã€‚

> é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œè’™ç‰¹å¡ç½—æ–¹æ³•åªç»™æˆ‘ä»¬é‡åˆ°çš„çŠ¶æ€å’ŒåŠ¨ä½œä¸€ä¸ªå€¼ï¼Œå¦‚æžœæˆ‘ä»¬ä»Žæœªé‡åˆ°ä¸€ä¸ªçŠ¶æ€ï¼Œå®ƒçš„å€¼æ˜¯æœªçŸ¥çš„ã€‚

# è’™ç‰¹å¡ç½—æ–¹æ³•

> è¿™ç¯‡æ–‡ç« å°†æä¾›ä¸€ä¸ªç”¨äºŽå¼ºåŒ–å­¦ä¹ çš„è’™ç‰¹å¡ç½—çš„å®žç”¨æ–¹æ³•ã€‚å…³äºŽè¿™äº›æ–¹æ³•çš„æ›´æ­£å¼çš„è§£é‡Šï¼Œæˆ‘é‚€è¯·è¯»è€…é˜…è¯»ç†æŸ¥å¾·Â·è¨é¡¿å’Œå®‰å¾·é²Â·å·´å°”æ‰˜çš„æ•™ç§‘ä¹¦ [**å¼ºåŒ–å­¦ä¹ :ç®€ä»‹**](http://www.incompleteideas.net/book/the-book-2nd.html) çš„ç¬¬äº”ç« ã€‚

å›žæƒ³ä¸€ä¸‹ï¼Œ**æœ€ä¼˜ç­–ç•¥****ã€Ï€âˆ«**è§„å®šäº†ï¼Œå¯¹äºŽæ¯ä¸ªçŽ¯å¢ƒçŠ¶æ€*ï¼Œä»£ç†åº”è¯¥å¦‚ä½•é€‰æ‹©ä¸€ä¸ªè¡ŒåŠ¨*æ¥å®žçŽ°å…¶æœ€å¤§åŒ–æŠ¥é…¬*çš„ç›®æ ‡ã€‚æˆ‘ä»¬è¿˜äº†è§£åˆ°ï¼Œä»£ç†å¯ä»¥é€šè¿‡é¦–å…ˆä¼°è®¡**æœ€ä¼˜è¡ŒåŠ¨å€¼å‡½æ•°***q*âˆ‘æ¥æž„å»ºå¯¹æœ€ä¼˜ç­–ç•¥çš„æœç´¢ï¼›é‚£ä¹ˆä¸€æ—¦*q*âˆ«å·²çŸ¥ï¼Œå°±å¾ˆå¿«å¾—åˆ°*Ï€*âˆ«ã€‚***

**ä»£ç†å¼€å§‹é‡‡å–ä¸€ä¸ªåŸºæœ¬ç­–ç•¥ï¼Œåƒç­‰æ¦‚çŽ‡éšæœºç­–ç•¥**ï¼Œ**ä¸€ä¸ªéšæœºç­–ç•¥ï¼Œä»£ç†ä»Žæ¯ä¸ªçŠ¶æ€ä¸­éšæœºé€‰æ‹©ä¸€ç»„å¯ç”¨çš„åŠ¨ä½œï¼Œæ¯ä¸ªåŠ¨ä½œä»¥ç­‰æ¦‚çŽ‡è¢«é€‰æ‹©ã€‚ä»£ç†ä½¿ç”¨å½“å‰ç­–ç•¥Ï€å°†ä¸ŽçŽ¯å¢ƒäº¤äº’ä»¥æ”¶é›†ä¸€äº›æƒ…èŠ‚ï¼Œç„¶åŽåˆå¹¶ç»“æžœä»¥å¾—å‡ºæ›´å¥½çš„ç­–ç•¥ã€‚**

**æ–¹æ³•æ˜¯ç”¨ä¸€ä¸ªæˆ‘ä»¬ç§°ä¹‹ä¸º **Q è¡¨**çš„è¡¨æ¥ä¼°ç®—åŠ¨ä½œå€¼å‡½æ•°ã€‚è’™ç‰¹å¡ç½—æ–¹æ³•ä¸­çš„è¿™ä¸ªæ ¸å¿ƒè¡¨ä¸ºæ¯ä¸ªçŠ¶æ€æä¾›äº†ä¸€è¡Œï¼Œä¸ºæ¯ä¸ªåŠ¨ä½œæä¾›äº†ä¸€åˆ—ã€‚å¯¹åº”äºŽçŠ¶æ€ *s* å’ŒåŠ¨ä½œ *a* çš„æ¡ç›®è¡¨ç¤ºä¸º *Q* ( *s* ï¼Œ *a* )ã€‚**

**æˆ‘ä»¬ç§°ä¹‹ä¸ºé¢„æµ‹é—®é¢˜:*ç»™å®šä¸€ä¸ªç­–ç•¥ï¼Œä»£ç†å¦‚ä½•ä¼°è®¡è¯¥ç­–ç•¥çš„ä»·å€¼å‡½æ•°ï¼Ÿ*ã€‚æˆ‘ä»¬å°†é¢„æµ‹é—®é¢˜çš„è’™ç‰¹å¡ç½—(MC)æ–¹æ³•ç§°ä¸º **MC é¢„æµ‹æ–¹æ³•**ã€‚**

> **æˆ‘ä»¬å°†æŠŠæˆ‘ä»¬çš„è§£é‡Šé›†ä¸­äºŽåŠ¨ä½œå€¼å‡½æ•° Qï¼Œä½†æ˜¯ MC ä¹Ÿå¯ä»¥ç”¨äºŽä¼°è®¡çŠ¶æ€å€¼å‡½æ•° vã€‚**

**åœ¨ç”¨äºŽ MC é¢„æµ‹çš„ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æ”¶é›†ç­–ç•¥çš„è®¸å¤šç‰‡æ®µå¼€å§‹ã€‚ç„¶åŽï¼Œæˆ‘ä»¬æ³¨æ„åˆ° Q è¡¨ä¸­çš„æ¯ä¸ªæ¡ç›®å¯¹åº”äºŽä¸€ä¸ªç‰¹å®šçš„çŠ¶æ€å’ŒåŠ¨ä½œã€‚ä¸ºäº†å¡«å…… Q-table çš„ä¸€ä¸ªæ¡ç›®ï¼Œæˆ‘ä»¬ä½¿ç”¨å½“ä»£ç†å¤„äºŽé‚£ä¸ªçŠ¶æ€å¹¶é€‰æ‹©åŠ¨ä½œæ—¶è·Ÿéšçš„è¿”å›žã€‚**

**æˆ‘ä»¬å°†ä¸€é›†ä¸­çŠ¶æ€çš„æ¯æ¬¡å‡ºçŽ°å®šä¹‰ä¸ºå¯¹è¯¥çŠ¶æ€-åŠ¨ä½œå¯¹çš„**è®¿é—®**ã€‚åœ¨ä¸€é›†é‡Œï¼Œä¸€ä¸ªçŠ¶æ€-åŠ¨ä½œå¯¹å¯èƒ½è¢«è®¿é—®ä¸æ­¢ä¸€æ¬¡ã€‚è¿™å¯¼è‡´æˆ‘ä»¬æœ‰ä¸¤ä¸ªç‰ˆæœ¬çš„ MC é¢„æµ‹ç®—æ³•:**

*   ****æ¯æ¬¡è®¿é—® MC é¢„æµ‹**:åœ¨æ‰€æœ‰äº‹ä»¶ä¸­ï¼Œå¯¹æ¯ä¸ªçŠ¶æ€-åŠ¨ä½œå¯¹çš„æ‰€æœ‰è®¿é—®åŽçš„å›žæŠ¥è¿›è¡Œå¹³å‡ã€‚**
*   ****åˆè®¿ MC é¢„æµ‹**:æ¯ä¸€é›†ï¼Œæˆ‘ä»¬åªè€ƒè™‘åˆè®¿çŠ¶æ€-åŠ¨ä½œå¯¹ã€‚**

**é¦–æ¬¡è®¿é—®æ–¹æ³•å’Œæ¯æ¬¡è®¿é—®éƒ½è¢«è®¤ä¸ºæ˜¯ä¿è¯æ”¶æ•›åˆ°çœŸæ­£çš„è¡ŒåŠ¨ä»·å€¼å‡½æ•°ã€‚**

**åœ¨æœ¬å¸–ä¸­ï¼Œæˆ‘ä»¬å°†å¯¹ OpenAI å¥èº«æˆ¿çš„å·¥ä½œç¤ºä¾‹è¿›è¡Œé¦–æ¬¡è®¿é—®:[21 ç‚¹çŽ¯å¢ƒ](https://github.com/openai/gym/blob/master/gym/envs/toy_text/blackjack.py)ã€‚ä½†æ˜¯å®žé™…ä¸Šï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œé¦–æ¬¡è®¿é—®å’Œæ¯æ¬¡è®¿é—® MC è¿”å›žç›¸åŒçš„ç»“æžœã€‚æ³¨æ„ï¼ŒåŒä¸€ä¸ªçŠ¶æ€ä¸ä¼šåœ¨ä¸€ä¸ªæƒ…èŠ‚ä¸­é‡å¤å‡ºçŽ°ï¼Œæ‰€ä»¥åœ¨é¦–æ¬¡è®¿é—®å’Œæ¯æ¬¡è®¿é—® MC æ–¹æ³•ä¹‹é—´æ²¡æœ‰åŒºåˆ«ã€‚é¦–æ¬¡å°±è¯Š MC é¢„æµ‹çš„ä¼ªä»£ç å¦‚ä¸‹:**

**![](img/9c78dccbfc11012c97d6521e883ee5de.png)**

**åœ¨è¿™ä¸ªä¼ªä»£ç ä¸­ï¼Œå˜é‡ *num* _ *å‰§é›†*è¡¨ç¤ºä»£ç†æ”¶é›†çš„å‰§é›†æ•°ï¼Œæœ‰ä¸‰ä¸ªç›¸å…³çš„è¡¨æ ¼:**

*   ***Q* :ä¸€ä¸ª Q è¡¨ï¼Œæ¯ä¸ªçŠ¶æ€ä¸€è¡Œï¼Œæ¯ä¸ªåŠ¨ä½œä¸€åˆ—ã€‚**
*   ***N* :è®°å½•æˆ‘ä»¬å¯¹æ¯ä¸ªçŠ¶æ€-åŠ¨ä½œå¯¹çš„ç¬¬ä¸€æ¬¡è®¿é—®æ¬¡æ•°çš„è¡¨æ ¼ã€‚**
*   ***returns* _ *sum:ä¸€ä¸ª*è¡¨ï¼Œè®°å½•ç¬¬ä¸€æ¬¡è®¿é—®æ¯ä¸ªçŠ¶æ€-åŠ¨ä½œå¯¹åŽèŽ·å¾—çš„å¥–åŠ±çš„æ€»å’Œã€‚**

**åœ¨æ¯ä¸€é›†ä¹‹åŽï¼Œ *N* å’Œ*è¿”å›ž* _ *sum* è¡¨è¢«æ›´æ–°ä»¥å­˜å‚¨è¯¥é›†åŒ…å«çš„ä¿¡æ¯ã€‚åœ¨æ”¶é›†äº†æ‰€æœ‰å‰§é›†ä¹‹åŽï¼Œå®Œæˆå¯¹*Q(**Q è¡¨)çš„æœ€ç»ˆä¼°è®¡ã€‚***

# ***æ¡ˆä¾‹ç ”ç©¶:21 ç‚¹***

***ä¸ºäº†æ›´å¥½åœ°ç†è§£è’™ç‰¹å¡ç½—åœ¨å®žè·µä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ OpenAI çš„å¥èº«æˆ¿çŽ¯å¢ƒ`Blackjack-v0`å¯¹ 21 ç‚¹æ¸¸æˆæ‰§è¡Œä¸€æ­¥ä¸€æ­¥çš„ç¼–ç ã€‚***

## ***äºŒåä¸€ç‚¹è§„åˆ™***

***é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®šä¹‰æ¸¸æˆçš„è§„åˆ™å’Œæ¡ä»¶:***

*   ***æµè¡Œçš„èµŒåœºçº¸ç‰Œæ¸¸æˆ 21 ç‚¹çš„ç›®æ ‡æ˜¯èŽ·å¾—æ•°å€¼æ€»å’Œå°½å¯èƒ½å¤§è€Œä¸è¶…è¿‡ 21 çš„çº¸ç‰Œã€‚è¶…è¿‡ 21 å¯¼è‡´ç ´äº§ï¼Œè€ŒåŒæ–¹éƒ½æœ‰ 21 å¯¼è‡´å¹³å±€ã€‚***
*   ***æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªç®€åŒ–çš„ç‰ˆæœ¬ï¼Œå…¶ä¸­æ¯ä¸ªçŽ©å®¶ç‹¬ç«‹åœ°ä¸Žåº„å®¶ç«žäº‰ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å°†åªå’Œåº„å®¶å¯¹æ‰“ï¼Œæ²¡æœ‰å…¶ä»–çŽ©å®¶å‚ä¸Žã€‚***
*   ***æ•°å­—å¡çš„ä»·å€¼æ˜¯æŒ‰é¢å€¼è®¡ç®—çš„ã€‚ç‰Œ Jã€K å’Œ Q çš„å€¼æ˜¯ 10ã€‚ace çš„å€¼å¯ä»¥æ˜¯ 1 æˆ– 11ï¼Œå–å†³äºŽçŽ©å®¶çš„é€‰æ‹©ã€‚***
*   ***åŒæ–¹ï¼ŒçŽ©å®¶å’Œåº„å®¶ï¼Œéƒ½æœ‰ä¸¤å¼ ç‰Œã€‚çŽ©å®¶çš„ä¸¤å¼ ç‰Œé¢æœä¸Šï¼Œè€Œåº„å®¶çš„ä¸€å¼ ç‰Œé¢æœä¸Šã€‚åœ¨çŽ©å®¶çœ‹åˆ°ä»–ä»¬çš„ç‰Œå’Œåº„å®¶çš„ç¬¬ä¸€å¼ ç‰ŒåŽï¼ŒçŽ©å®¶å¯ä»¥é€‰æ‹©å‡»æ‰“æˆ–ç«™ç«‹ï¼Œç›´åˆ°ä»–å¯¹è‡ªå·±çš„æ€»å’Œæ„Ÿåˆ°æ»¡æ„ï¼Œä¹‹åŽä»–å°†ç«™ç«‹ã€‚***
*   ***ç„¶åŽï¼Œå‘ç‰Œè€…å±•ç¤ºä»–ä»¬çš„ç¬¬äºŒå¼ ç‰Œâ€”â€”å¦‚æžœæ€»æ•°å°äºŽ 17ï¼Œä»–ä»¬å°†ç»§ç»­æŠ½ç‰Œï¼Œç›´åˆ°è¾¾åˆ° 17ï¼Œä¹‹åŽä»–ä»¬å°†ç«™ç€ã€‚***

## ***å¼€æ”¾å¼å¥èº«æˆ¿:21 ç‚¹çŽ¯å¢ƒ***

***æˆ‘ä»¬å°†ä½¿ç”¨ OpenAI çš„å¥èº«æˆ¿çŽ¯å¢ƒ`[Blackjack-v0](https://github.com/openai/gym/blob/master/gym/envs/toy_text/blackjack.py)`ã€‚æ¯ä¸ªçŠ¶æ€æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„:***

*   ***çŽ©å®¶ç›®å‰çš„æ€»å’Œâˆˆ{0ï¼Œ1ï¼Œâ€¦ï¼Œ31}***
*   ***åº„å®¶çš„é¢æœä¸Šçš„ç‰Œâˆˆ{1ï¼Œâ€¦ï¼Œ10}***
*   ***æ— è®ºçŽ©å®¶æ˜¯å¦æœ‰å¯ç”¨çš„ aã€‚***

***ä»£ç†æœ‰ä¸¤ä¸ªæ½œåœ¨çš„æ“ä½œ:***

*   ****æ£*(åŠ¨ä½œ`0`):ä¸å†å–ç‰Œ(ä¹Ÿç§°â€œç«‹â€æˆ–â€œç•™â€)ã€‚***
*   ***å‡»*(åŠ¨ä½œ`1`):ä»Žåº„å®¶é‚£é‡Œå†æ‹¿ä¸€å¼ ç‰Œã€‚**

**21 ç‚¹çš„æ¯ä¸€å±€éƒ½æ˜¯ä¸€é›†ã€‚èµ¢ã€è¾“å’ŒæŠ½ç‰Œçš„å¥–åŠ±åˆ†åˆ«ä¸º+1ã€1 å’Œ 0ã€‚ä¸€ä¸ªæ¸¸æˆå†…æ‰€æœ‰å¥–åŠ±éƒ½æ˜¯ 0ï¼Œæˆ‘ä»¬ä¸æ‰“æŠ˜(gamma = 1)ï¼›å› æ­¤ï¼Œè¿™äº›æœ€ç»ˆçš„å›žæŠ¥ä¹Ÿæ˜¯å›žæŠ¥ã€‚**

> **è¿™ç¯‡æ–‡ç« çš„å…¨éƒ¨ä»£ç å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°ï¼Œè€Œ[å¯ä»¥é€šè¿‡è¿™ä¸ªé“¾æŽ¥ä½œä¸ºä¸€ä¸ªè°·æ­Œç¬”è®°æœ¬æ¥è¿è¡Œã€‚](https://colab.research.google.com/github/jorditorresBCN/Deep-Reinforcement-Learning-Explained/blob/master/DRL_13_Monte_Carlo.ipynb)**

**æˆ‘ä»¬ä»Žå¯¼å…¥å¿…è¦çš„åŒ…å¼€å§‹:**

```
**import sys
import gym
import numpy as np
from collections import defaultdictenv = gym.make('Blackjack-v0')
print(env.observation_space)
print(env.action_space)**
```

**æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨çŽ¯å¢ƒä¸­æœ‰ 704 ç§ä¸åŒçš„çŠ¶æ€ï¼Œå¯¹åº”äºŽ 32 ä¹˜ä»¥ 11 ä¹˜ä»¥ 2ï¼Œå¹¶ä¸”æœ‰ä¸¤ç§å¯èƒ½çš„åŠ¨ä½œå¯¹åº”äºŽé€‰æ‹©åšæŒæˆ–å‡»æ‰“:**

```
**Tuple(Discrete(32), Discrete(11), Discrete(2)) 
Discrete(2)**
```

**ä¸ºäº†åœ¨æ¯é›†çš„æ¯ä¸ªæ—¶é—´æ­¥éª¤ä¸­æŸ¥çœ‹ç¤ºä¾‹æ¸¸æˆï¼Œä»£ç†ä¸ŽçŽ¯å¢ƒè¿›è¡Œäº¤äº’ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä»¥ä¸‹ä»£ç (å¤šæ¬¡):**

```
**state = env.reset()
while True:
       print(state)
       action = env.action_space.sample()
       state, reward, done, info = env.step(action)
       if done:
          if reward > 0: 
             print('Reward: ', reward, '(Player won)\n')
          else: 
             print('Reward: ', reward, '(Player lost)\n')
          break**
```

**ç¤ºä¾‹æ¸¸æˆçš„ä¸€ä¸ªä¾‹å­æ˜¯:**

```
**(21, 4, True) 
(13, 4, False) 
(14, 4, False) 
Reward:  -1.0**
```

**ç»çºªäººè¾“æŽ‰æ¯”èµ›çš„åœ°æ–¹ã€‚æˆ‘å»ºè®®è¯»è€…è¿è¡Œè¿™æ®µä»£ç å‡ æ¬¡ï¼Œçœ‹çœ‹ä¸åŒçš„å‰§æœ¬ã€‚**

# **ä¸€ç§ç®€å•çš„ MC é¢„æµ‹æ–¹æ³•å®žçŽ°**

**è€ƒè™‘è¿™æ ·ä¸€ä¸ªç­–ç•¥ï¼ŒçŽ©å®¶åªæ ¹æ®å¥¹/ä»–å½“å‰çš„åˆ†æ•°æ¥å†³å®šä¸€ä¸ªåŠ¨ä½œã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæˆ‘ä»¬æ‹¥æœ‰çš„å¡çš„æ€»æ•°æ˜¯ 18 æˆ–æ›´å°‘ï¼Œæˆ‘ä»¬è®¤ä¸ºå¦‚æžœæˆ‘ä»¬è¦æ±‚ä¸€è¾†æ–°çš„æ±½è½¦å¯èƒ½æ˜¯æ²¡é—®é¢˜çš„ã€‚æˆ‘ä»¬æœ‰ 75%çš„å¯èƒ½æ€§åšåˆ°è¿™ä¸€ç‚¹ã€‚å¦‚æžœå¡çš„æ€»æ•°å¤§äºŽ 18ï¼Œæˆ‘ä»¬è®¤ä¸ºæŽ¥å—ä¸€å¼ æ–°å¡å¤ªå±é™©äº†ï¼Œæˆ‘ä»¬ä¸ä¼šä»¥ 75%çš„æ¦‚çŽ‡è¿™æ ·åšã€‚**

**æ€»ä¹‹ï¼Œå¦‚æžœæ€»å’Œå¤§äºŽ 18ï¼Œæˆ‘ä»¬ä»¥ 75%çš„æ¦‚çŽ‡é€‰æ‹©åŠ¨ä½œ*æ£’*;å¹¶ä¸”ï¼Œå¦‚æžœæ€»å’Œç­‰äºŽæˆ–å°äºŽ 18ï¼Œæˆ‘ä»¬é€‰æ‹©åŠ¨ä½œ*ä»¥ 75%çš„æ¦‚çŽ‡å‘½ä¸­*ã€‚**

**è¯·æ³¨æ„ï¼Œåœ¨ç¬¬ä¸€ç§ç­–ç•¥ä¸­ï¼Œæˆ‘ä»¬å¿½ç•¥äº†çŠ¶æ€ä¸­çš„ä¸€äº›ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼Œåº„å®¶çš„é¢æœä¸Šçš„ç‰Œæˆ–æˆ‘ä»¬æ˜¯å¦æœ‰å¯ç”¨çš„ aã€‚è¿™æ˜¯ä¸ºäº†ç®€åŒ–ç¤ºä¾‹ä¸­ä¸€æ®µé‡ç‚¹ä»£ç çš„è§£é‡Šã€‚ä»¥ä¸‹å‡½æ•°`generate_episode`ä½¿ç”¨è¯¥ç­–ç•¥å¯¹æƒ…èŠ‚è¿›è¡Œé‡‡æ ·:**

```
**def generate_episode(env):
    episode = []
    state = env.reset() 
    while True:
        probs = [0.75, 0.25] if state[0] > 18 else [0.25, 0.75]
        action = np.random.choice(np.arange(2), p=probs)
        next_state, reward, done, info = env.step(action)
        episode.append((state, action, reward))
        state = next_state
        if done:
           break
        return episode**
```

**è¿™æ®µä»£ç è¿”å›žä¸€ä¸ª`episode`(ä½¿ç”¨ç­–ç•¥ **Ï€** å†³å®š)ä½œä¸ºå…ƒç»„çš„(çŠ¶æ€ã€åŠ¨ä½œã€å›žæŠ¥)å…ƒç»„åˆ—è¡¨ã€‚`episode[i][0]`ã€`episode[i][1]`ã€`episode[i][2]`åˆ†åˆ«å¯¹åº”æ—¶æ­¥ð‘–çš„çŠ¶æ€ã€æ—¶æ­¥ *i* çš„åŠ¨ä½œã€æ—¶æ­¥ *ð‘–+1* çš„å¥–åŠ±ã€‚**

**ä¸ºäº†çŽ©(10 ä¸ªæ¸¸æˆ)ï¼Œæˆ‘ä»¬å¯ä»¥å¦‚ä¸‹æ‰§è¡Œå‰é¢çš„åŠŸèƒ½:**

```
**for i in range(10):
    print(generate_episode(env))**
```

**è¾“å‡ºå°†æ˜¯(åœ¨æˆ‘çš„è¿è¡Œä¸­):**

```
**[((19, 3, True), 1, 0.0), ((19, 3, False), 0, 1.0)] 
[((14, 5, False), 1, -1.0)] 
[((15, 10, False), 0, -1.0)] 
[((15, 10, False), 1, 0.0), ((17, 10, False), 1, -1.0)] 
[((13, 2, False), 1, -1.0)] 
[((13, 4, False), 1, 0.0), ((14, 4, False), 0, -1.0)] 
[((11, 10, False), 1, 0.0), ((21, 10, False), 0, 0.0)] 
[((15, 10, False), 1, -1.0)] 
[((9, 9, False), 1, 0.0), ((16, 9, False), 0, 1.0)] 
[((13, 7, False), 1, 0.0), ((18, 7, False), 1, 0.0), ((21, 7, False), 1, -1.0)]**
```

**å¥–åŠ±åªæœ‰åœ¨æ¸¸æˆç»“æŸæ—¶æ‰ä¼šæ”¶åˆ°ï¼Œå¦‚æžœæˆ‘ä»¬èµ¢äº†å°±æ˜¯`1.0`ï¼Œå¦‚æžœæˆ‘ä»¬è¾“äº†å°±æ˜¯`-1.0`ã€‚æˆ‘ä»¬çœ‹åˆ°æœ‰æ—¶æˆ‘ä»¬èµ¢äº†ï¼Œæœ‰æ—¶æˆ‘ä»¬è¾“äº†ã€‚**

**è®©æˆ‘ä»¬å¼€å§‹æ ¹æ®å‰é¢çš„ä¼ªä»£ç ç¼–å†™ä¸€ä¸ªä»£ç ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åˆå§‹åŒ–å­—å…¸`N`ã€`return_sum`å’Œ`Q`:**

```
**N = defaultdict(lambda: np.zeros(env.action_space.n))
returns_sum = defaultdict(lambda: np.zeros(env.action_space.n))
Q = defaultdict(lambda: np.zeros(env.action_space.n))**
```

**æŽ¥ä¸‹æ¥ï¼Œè¯¥ç®—æ³•åœ¨ä½¿ç”¨æ‰€æä¾›çš„ä½¿ç”¨è¯¥ç­–ç•¥çš„å‡½æ•°`generate_episode`ç”Ÿæˆçš„å‰§é›†ä¸Šå¾ªçŽ¯ã€‚æ¯ä¸€é›†éƒ½å°†æ˜¯çŠ¶æ€ã€åŠ¨ä½œå’Œå¥–åŠ±å…ƒç»„çš„åˆ—è¡¨ã€‚ç„¶åŽï¼Œæˆ‘ä»¬ä½¿ç”¨ zip å‘½ä»¤å°†çŠ¶æ€ã€åŠ¨ä½œå’Œå¥–åŠ±åˆ†æˆä¸åŒçš„é‡:**

```
**episode = generate_episode(env)
states, actions, rewards = zip(*episode)**
```

**è®©æˆ‘ä»¬å›žåˆ° de ä¼ªä»£ç ï¼Œçœ‹çœ‹æˆ‘ä»¬åœ¨æ—¶é—´æ­¥é•¿ä¸Šå¾ªçŽ¯ï¼ŒæŸ¥çœ‹æ¯ä¸ªæ—¶é—´æ­¥é•¿å¯¹åº”çš„çŠ¶æ€åŠ¨ä½œå¯¹ã€‚å¦‚æžœè¿™æ˜¯æˆ‘ä»¬ç¬¬ä¸€æ¬¡è®¿é—®è¯¥å¯¹ï¼Œæˆ‘ä»¬å°†è¡¨`N`çš„ç›¸åº”ä½ç½®å¢žåŠ  1ï¼Œå¹¶å°†æ­¤æ—¶æ­¥çš„è¿”å›žæ·»åŠ åˆ°è¡¨`return_sum`çš„ç›¸åº”æ¡ç›®ä¸­ã€‚**

**è¯·è®°ä½ï¼Œåœ¨è¿™ä¸ª 21 ç‚¹çš„ä¾‹å­ä¸­ï¼Œç¬¬ä¸€æ¬¡è®¿é—®å’Œæ¯æ¬¡è®¿é—® MC é¢„æµ‹æ˜¯ç­‰æ•ˆçš„ï¼Œå› æ­¤æˆ‘ä»¬å°†å¯¹æ¯ä¸ªæ—¶é—´æ­¥é•¿è¿›è¡Œæ›´æ–°ã€‚ç„¶åŽï¼Œä¸€æ—¦æˆ‘ä»¬æœ‰äº†`return_sum`å’Œ`N`çš„ç›¸åº”æ›´æ–°å€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨å®ƒä»¬æ¥æ›´æ–°æˆ‘ä»¬çš„`Q`ä¼°ç®—è¡¨ã€‚è¿™éƒ¨åˆ†çš„ä»£ç å¦‚ä¸‹:**

```
**discounts = np.array([gamma**i for i in range(len(rewards)+1)])for i, state in enumerate(states):
    returns_sum[state][actions[i]] += 
               sum(rewards[i:]*discounts[:-(1+i)])
    N[state][actions[i]] += 1.0
    Q[state][actions[i]] = returns_sum[state][actions[i]] 
               / N[state][actions[i]]**
```

**æˆ‘ä»¬çš„ MC é¢„æµ‹æ–¹æ³•çš„å®Œæ•´ä»£ç å¦‚ä¸‹:**

```
**def mc_prediction(env, num_episodes, generate_episode, gamma=1.0):

   returns_sum = defaultdict(lambda: np.zeros(env.action_space.n))
   N = defaultdict(lambda: np.zeros(env.action_space.n))
   Q = defaultdict(lambda: np.zeros(env.action_space.n))for episode in range(1, num_episodes+1):
      episode = generate_episode(env)
      states, actions, rewards = zip(*episode)discounts = np.array([gamma**i for i in 
                           range(len(rewards)+1)])for i, state in enumerate(states):
             returns_sum[state][actions[i]] += 
                        sum(rewards[i:]*discounts[:-(1+i)])
             N[state][actions[i]] += 1.0
             Q[state][actions[i]] = returns_sum[state][actions[i]] 
                      / N[state][actions[i]]
   return Q**
```

**è¯¥ç®—æ³•å°† OpenAI å¥èº«æˆ¿çŽ¯å¢ƒçš„å®žä¾‹ã€ç”Ÿæˆçš„å‰§é›†æ•°é‡ä»¥åŠæŠ˜æ‰£çŽ‡(é»˜è®¤å€¼`1`)ä½œä¸ºå‚æ•°ã€‚è¯¥ç®—æ³•è¿”å›žä½œä¸ºè¾“å‡ºçš„ Q è¡¨(åŠ¨ä½œå€¼å‡½æ•°çš„ä¼°è®¡)ï¼Œä¸€ä¸ªå­—å…¸(ä¸€ç»´æ•°ç»„)ã€‚**

**ç»˜åˆ¶ç›¸åº”çš„çŠ¶æ€å€¼å‡½æ•°ï¼Œçœ‹çœ‹å“ªäº›çŠ¶æ€å€¼æ›´å¤§ï¼Œä¼šå¾ˆæœ‰æ„æ€ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªç®€å•çš„ä»£ç ä»Ž Q-table ä¸­å®Œæˆï¼Œå®ƒé€šè¿‡æ ¹æ®æˆ‘ä»¬å¦‚ä½•å®šä¹‰é—®é¢˜æ¥åŠ æƒæ¯ä¸ªåŠ¨ä½œçš„å€¼æ¥èŽ·å¾—çŠ¶æ€çš„å€¼:**

```
**num_episodes=1000000Q = mc_prediction(env, num_episodes, generate_episode)State_Value_table={}
for state, actions in Q.items():
           State_Value_table[state]= 
                 (state[0]>18)*(np.dot([0.75, 0.25],actions)) +
                 (state[0]<=18)*(np.dot([0.75, 0.25],actions))**
```

**æˆ‘ä»¬å¯ä»¥ç”¨ä»Ž Udacity å€Ÿæ¥çš„ä»£ç [æ¥ç»˜åˆ¶è¿™ä¸ªå›¾ã€‚æœ‰ä¸¤ä¸ªå›¾å¯¹åº”äºŽæˆ‘ä»¬æ˜¯å¦æœ‰å¯ç”¨çš„ a æˆ–è€…æˆ‘ä»¬æ²¡æœ‰å¯ç”¨çš„ aã€‚ä½†æ˜¯åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çœ‹åˆ°æœ€é«˜çš„çŠ¶æ€å€¼å¯¹åº”äºŽå½“çŽ©å®¶å’Œæ˜¯ 20 æˆ– 21 çš„æ—¶å€™ï¼Œè¿™çœ‹èµ·æ¥å¾ˆæ˜Žæ˜¾ï¼Œå› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬æœ€æœ‰å¯èƒ½èµ¢å¾—æ¸¸æˆã€‚](https://github.com/udacity/deep-reinforcement-learning/blob/master/monte-carlo/plot_utils.py)**

**![](img/0a972a885fd55eccffbe2002048c6b70.png)**

**(æ¥æº:ä½œè€…)**

# **æŽ¢ç´¢ä¸Žå¼€å‘**

**åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†ä¸€ä¸ªä»£ç†å¦‚ä½•é‡‡ç”¨ä¸€ä¸ªåƒç­‰æ¦‚çŽ‡éšæœºç­–ç•¥è¿™æ ·çš„ç­–ç•¥ï¼Œä½¿ç”¨å®ƒæ¥ä¸ŽçŽ¯å¢ƒäº¤äº’ï¼Œç„¶åŽä½¿ç”¨è¯¥ç»éªŒæ¥å¡«å……ç›¸åº”çš„ Q è¡¨ï¼Œè¯¥ Q è¡¨æˆä¸ºè¯¥ç­–ç•¥çš„åŠ¨ä½œå€¼å‡½æ•°çš„ä¼°è®¡ã€‚æ‰€ä»¥ï¼ŒçŽ°åœ¨çš„é—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•åˆ©ç”¨è¿™ä¸€ç‚¹æ¥å¯»æ‰¾æœ€ä¼˜ç­–ç•¥ï¼Ÿ**

## **è´ªå©ªçš„æ”¿ç­–**

**ä¸ºäº†å¾—åˆ°ä¸€ä¸ªæ›´å¥½çš„æ”¿ç­–ï¼Œä¸ä¸€å®šæ˜¯æœ€ä¼˜çš„ï¼Œæˆ‘ä»¬åªéœ€è¦ä¸ºæ¯ä¸ªçŠ¶æ€é€‰æ‹©æœ€å¤§åŒ– Q è¡¨çš„è¡ŒåŠ¨ã€‚è®©æˆ‘ä»¬ç§°è¿™ä¸ªæ–°æ”¿ç­–ä¸º**ã€Ï€ã€‘**ã€‚å½“æˆ‘ä»¬æ‹¿ä¸€ä¸ª Q è¡¨ï¼Œå¹¶ä½¿ç”¨æœ€å¤§åŒ–æ¯ä¸€è¡Œ **çš„åŠ¨ä½œ**æ¥æå‡ºç­–ç•¥**æ—¶ï¼Œæˆ‘ä»¬è¯´æˆ‘ä»¬æ­£åœ¨æž„å»ºå…³äºŽ Q è¡¨çš„**è´ªå©ª**çš„ç­–ç•¥ã€‚****

**é€šå¸¸å°†æ‰€é€‰åŠ¨ä½œç§°ä¸º**è´ªå©ªåŠ¨ä½œ**ã€‚åœ¨æœ‰é™ MDP çš„æƒ…å†µä¸‹ï¼Œä½œç”¨å€¼å‡½æ•°ä¼°è®¡ç”¨ Q è¡¨è¡¨ç¤ºã€‚ç„¶åŽï¼Œä¸ºäº†å¾—åˆ°è´ªå©ªåŠ¨ä½œï¼Œå¯¹äºŽè¡¨ä¸­çš„æ¯ä¸€è¡Œï¼Œæˆ‘ä»¬åªéœ€è¦é€‰æ‹©å¯¹åº”äºŽæœ€å¤§åŒ–è¯¥è¡Œçš„åˆ—çš„åŠ¨ä½œã€‚**

## **Îµ-è´ªå©ªæ”¿ç­–**

**ç„¶è€Œï¼Œä¸æ˜¯æ€»æ˜¯æž„é€ ä¸€ä¸ªè´ªå©ªç­–ç•¥(æ€»æ˜¯é€‰æ‹©è´ªå©ªåŠ¨ä½œ),è€Œæ˜¯æž„é€ ä¸€ä¸ªæ‰€è°“çš„**Îµè´ªå©ªç­–ç•¥**,å®ƒæœ€æœ‰å¯èƒ½é€‰æ‹©è´ªå©ªåŠ¨ä½œï¼Œä½†ä¹Ÿæœ‰å¾ˆå°ä½†éžé›¶çš„æ¦‚çŽ‡é€‰æ‹©å…¶ä»–åŠ¨ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨ä¸€å®šåœ¨é›¶å’Œä¸€ä¹‹é—´çš„æŸä¸ªå°æ­£æ•°Îµ*Ïµ*ã€‚è¿™æ˜¯æœ‰åŠ¨æœºçš„ï¼Œæ­£å¦‚æˆ‘ä»¬å°†åœ¨åŽé¢æ›´è¯¦ç»†åœ°è§£é‡Šçš„é‚£æ ·ï¼Œç”±äºŽä»£ç†å¿…é¡»æ‰¾åˆ°ä¸€ç§æ–¹æ³•æ¥å¹³è¡¡åŸºäºŽä»–ä»¬å½“å‰çŸ¥è¯†çš„æœ€ä½³è¡Œä¸ºçš„é©±åŠ¨å’ŒèŽ·å–çŸ¥è¯†ä»¥èŽ·å¾—æ›´å¥½çš„æœªæ¥è¡Œä¸ºçš„éœ€è¦ã€‚**

## **è’™ç‰¹å¡æ´›æŽ§åˆ¶**

**æˆ‘ä»¬å·²ç»äº†è§£äº†ä»£ç†å¦‚ä½•é‡‡ç”¨ç­–ç•¥ *Ï€* ï¼Œä½¿ç”¨å®ƒä¸ŽçŽ¯å¢ƒè¿›è¡Œå¤šæ¬¡äº¤äº’ï¼Œç„¶åŽä½¿ç”¨ç»“æžœé€šè¿‡ Q è¡¨æ¥ä¼°è®¡åŠ¨ä½œå€¼å‡½æ•°ã€‚ä¸€æ—¦ q è¡¨éžå¸¸æŽ¥è¿‘åŠ¨ä½œå€¼å‡½æ•°ï¼Œä»£ç†å°±å¯ä»¥æž„é€ ç­–ç•¥ *Ï€* ï¼Œå³*Ïµ*â€”â€”ç›¸å¯¹äºŽ q è¡¨æ˜¯è´ªå©ªçš„ï¼Œè¿™å°†äº§ç”Ÿæ¯”åŽŸå§‹ç­–ç•¥ *Ï€* æ›´å¥½çš„ç­–ç•¥ã€‚ç„¶åŽæˆ‘ä»¬å¯ä»¥æ”¹è¿›è¿™ä¸ªç­–ç•¥ï¼ŒæŠŠå®ƒå˜æˆÏµçš„è´ªå©ªç­–ç•¥ã€‚**

**å› æ­¤ï¼Œå¦‚æžœä»£ç†äººåœ¨è¿™ä¸¤ä¸ªæ­¥éª¤ä¹‹é—´åå¤äº¤æ›¿ï¼Œç›´åˆ°æˆ‘ä»¬å¾—åˆ°è¶Šæ¥è¶Šå¥½çš„ç­–ç•¥ï¼Œå¸Œæœ›æˆ‘ä»¬æ”¶æ•›åˆ°æœ€ä¼˜ç­–ç•¥ï¼Œæˆ‘ä»¬æœ€ç»ˆä¼šå¾—åˆ°æœ€ä¼˜ç­–ç•¥*Ï€*âˆ«:**

*   ****æ­¥éª¤ 1** :ä½¿ç”¨ç­–ç•¥ *Ï€* æž„å»º Q è¡¨ï¼Œä»¥åŠ**
*   ****ç¬¬äºŒæ­¥**:å°†ç­–ç•¥ä¿®æ”¹ä¸º*Ïµ*â€”â€”è´ªå©ªå…³äºŽ q è¡¨(æ ‡æ³¨ä¸º*)ã€‚***

***åªè¦æˆ‘ä»¬è¿è¡Œè¶³å¤Ÿé•¿çš„æ—¶é—´ï¼Œè¿™ä¸ªè¢«æè®®çš„ç®—æ³•æ˜¯å¦‚æ­¤æŽ¥è¿‘ç»™æˆ‘ä»¬æœ€ä¼˜ç­–ç•¥ã€‚***

***æˆ‘ä»¬æŠŠè¿™ç§ç®—æ³•ç§°ä¸º**è’™ç‰¹å¡ç½—æŽ§åˆ¶æ–¹æ³•**ï¼Œç”¨æ¥ä¼°è®¡æœ€ä¼˜ç­–ç•¥ã€‚é€šå¸¸å°†**æ­¥éª¤ 1** ç§°ä¸º**ç­–ç•¥è¯„ä¼°**ï¼Œå› ä¸ºå®ƒç”¨äºŽç¡®å®šç­–ç•¥çš„åŠ¨ä½œ**å€¼**å‡½æ•°ã€‚åŒæ ·ï¼Œç”±äºŽ**æ­¥éª¤ 2** ç”¨äºŽ**æ”¹è¿›**ç­–ç•¥ï¼Œæˆ‘ä»¬ä¹Ÿå°†å…¶ç§°ä¸º**ç­–ç•¥æ”¹è¿›**æ­¥éª¤ã€‚ç¤ºæ„æ€§åœ°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶è¡¨ç¤ºä¸º:***

***![](img/be58859e4f4711fa6e9c2f39b4a22780.png)***

***å› æ­¤ï¼Œä½¿ç”¨è¿™ä¸ªæ–°æœ¯è¯­ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“å‡ºï¼Œæˆ‘ä»¬çš„**è’™ç‰¹å¡ç½—æŽ§åˆ¶æ–¹æ³•**åœ¨**ç­–ç•¥è¯„ä¼°**å’Œ**ç­–ç•¥æ”¹è¿›**æ­¥éª¤ä¹‹é—´äº¤æ›¿è¿›è¡Œï¼Œä»¥æ‰¾åˆ°æœ€ä¼˜ç­–ç•¥Ï€âˆ«:***

***![](img/7560d9c1e4770c6697f95c51c402642d.png)***

***å…¶ä¸­ç®­å¤´ä¸­çš„â€œEâ€è¡¨ç¤ºå®Œæ•´çš„æ”¿ç­–è¯„ä¼°,â€œIâ€è¡¨ç¤ºå®Œæ•´çš„æ”¿ç­–æ”¹è¿›ã€‚åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å±•ç¤ºè’™ç‰¹å¡ç½—æŽ§åˆ¶ç®—æ³•çš„å®žçŽ°ã€‚***

***ç„¶è€Œï¼Œä¸€äº›é—®é¢˜å‡ºçŽ°äº†ï¼Œåœ¨æž„é€  *Ïµ* è´ªå©ªç­–ç•¥æ—¶ï¼Œå¦‚ä½•è®¾ç½® *Ïµ* çš„å€¼ï¼Ÿåœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•å®žçŽ°ã€‚***

# **å‹˜æŽ¢å¼€å‘å›°å¢ƒ**

**å›žæƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„ä»£ç†æœ€åˆä¸çŸ¥é“çŽ¯å¢ƒçš„åŠ¨æ€ï¼Œç”±äºŽç›®æ ‡æ˜¯æœ€å¤§åŒ–å›žæŠ¥ï¼Œä»£ç†å¿…é¡»é€šè¿‡äº¤äº’æ¥äº†è§£çŽ¯å¢ƒã€‚ç„¶åŽï¼Œåœ¨æ¯ä¸€ä¸ªæ—¶é—´æ­¥ï¼Œå½“ä»£ç†é€‰æ‹©ä¸€ä¸ªåŠ¨ä½œæ—¶ï¼Œå®ƒæ ¹æ®è¿‡åŽ»å¯¹çŽ¯å¢ƒçš„ç»éªŒä½œå‡ºå†³å®šã€‚è€Œä¸”ï¼Œæœ¬èƒ½å¯èƒ½æ˜¯é€‰æ‹©åŸºäºŽè¿‡åŽ»ç»éªŒçš„**çš„è¡ŒåŠ¨ï¼Œå°†èŽ·å¾—æœ€å¤§å›žæŠ¥ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚ä¸­æ‰€è®¨è®ºçš„ï¼Œè¿™ç§å¯¹åŠ¨ä½œå€¼å‡½æ•°ä¼°è®¡è´ªå©ªçš„ç­–ç•¥å¾ˆå®¹æ˜“å¯¼è‡´æ”¶æ•›åˆ°æ¬¡ä¼˜ç­–ç•¥ã€‚****

## ***å¹³è¡¡å¼€å‘ä¸Žå‹˜æŽ¢***

***è¿™å¯èƒ½ä¼šå‘ç”Ÿï¼Œå› ä¸ºåœ¨æ—©æœŸï¼Œä»£ç†äººçš„çŸ¥è¯†éžå¸¸æœ‰é™ï¼Œå¹¶æ‹’ç»è€ƒè™‘å°±æœªæ¥å›žæŠ¥è€Œè¨€æ¯”å·²çŸ¥è¡Œä¸ºæ›´å¥½çš„éžè´ªå©ªè¡Œä¸ºã€‚è¿™æ„å‘³ç€ä¸€ä¸ªæˆåŠŸçš„ä»£ç†äººä¸å¯èƒ½åœ¨æ¯ä¸ªæ—¶é—´ç‚¹éƒ½è´ªå©ªåœ°è¡ŒåŠ¨ï¼›ç›¸åï¼Œä¸ºäº†å‘çŽ°æœ€ä¼˜ç­–ç•¥ï¼Œå®ƒå¿…é¡»ç»§ç»­æ”¹è¿›æ‰€æœ‰çŠ¶æ€-åŠ¨ä½œå¯¹çš„ä¼°è®¡å›žæŠ¥ã€‚ä½†åŒæ—¶ä¿æŒä¸€å®šç¨‹åº¦çš„è´ªå©ªè¡ŒåŠ¨ï¼Œä»¥å°½å¿«ç»´æŒå›žæŠ¥æœ€å¤§åŒ–çš„ç›®æ ‡ã€‚è¿™æ¿€å‘äº†æˆ‘ä»¬ä¹‹å‰æå‡ºçš„Ïµè´ªå©ªæ”¿ç­–çš„æƒ³æ³•ã€‚***

***æˆ‘ä»¬å°†å¹³è¡¡è¿™ä¸¤ä¸ªç«žäº‰éœ€æ±‚çš„éœ€æ±‚ç§°ä¸º**æŽ¢ç´¢-å¼€å‘å›°å¢ƒ**ï¼Œå…¶ä¸­ä»£ç†å¿…é¡»æ‰¾åˆ°ä¸€ç§æ–¹æ³•æ¥å¹³è¡¡åŸºäºŽå…¶å½“å‰çŸ¥è¯†çš„æœ€ä½³è¡Œä¸ºé©±åŠ¨(**å¼€å‘**)å’ŒèŽ·å–çŸ¥è¯†ä»¥èŽ·å¾—æ›´å¥½åˆ¤æ–­çš„éœ€æ±‚(**æŽ¢ç´¢**)ã€‚***

## ***è®¾ç½®Îµçš„å€¼***

***è¿™ç§å›°å¢ƒçš„ä¸€ä¸ªæ½œåœ¨è§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡åœ¨æž„å»º *Ïµ* è´ªå©ªç­–ç•¥æ—¶é€æ¸ä¿®æ”¹ *Ïµ* çš„å€¼æ¥å®žçŽ°çš„ã€‚å¯¹äºŽä»£ç†äººæ¥è¯´ï¼Œé€šè¿‡é€‰æ‹©**æŽ¢ç´¢**è€Œä¸æ˜¯**å¼€å‘**å°è¯•å„ç§ç­–ç•¥æ¥æœ€å¤§åŒ–å›žæŠ¥ï¼Œå¼€å§‹ä¸ŽçŽ¯å¢ƒçš„äº’åŠ¨æ˜¯æœ‰æ„ä¹‰çš„ã€‚è€ƒè™‘åˆ°è¿™ä¸€ç‚¹ï¼Œæœ€å¥½çš„å¼€å§‹ç­–ç•¥æ˜¯ç­‰æ¦‚çŽ‡éšæœºç­–ç•¥ï¼Œå› ä¸ºå®ƒåŒæ ·æœ‰å¯èƒ½æŽ¢ç´¢æ¯ä¸ªçŠ¶æ€çš„æ‰€æœ‰å¯èƒ½è¡Œä¸ºã€‚è®¾ç½® *Ïµ* =1 äº§ç”Ÿä¸€ä¸ª*Ïµ*-è´ªå©ªç­–ç•¥ï¼Œå®ƒç­‰ä»·äºŽç­‰æ¦‚çŽ‡éšæœºç­–ç•¥ã€‚***

**åœ¨éšåŽçš„æ—¶é—´æ­¥éª¤ä¸­ï¼Œä¿ƒè¿›**å¼€å‘**è€Œä¸æ˜¯**å‹˜æŽ¢**æ˜¯æœ‰æ„ä¹‰çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ”¿ç­–ç›¸å¯¹äºŽè¡ŒåŠ¨ä»·å€¼å‡½æ•°ä¼°è®¡é€æ¸å˜å¾—æ›´åŠ è´ªå©ªã€‚è®¾ç½® *Ïµ* =0 äº§ç”Ÿè´ªå©ªç­–ç•¥ã€‚å·²ç»è¡¨æ˜Žï¼Œæœ€åˆå€¾å‘äºŽé€šè¿‡å¼€å‘è¿›è¡Œå‹˜æŽ¢ï¼Œå¹¶é€æ¸å€¾å‘äºŽå¼€å‘è€Œä¸æ˜¯å‹˜æŽ¢æ˜¯ä¸€ç§æœ€ä½³ç­–ç•¥ã€‚**

**ä¸ºäº†ä¿è¯ MC æŽ§åˆ¶æ”¶æ•›åˆ°æœ€ä¼˜ç­–ç•¥*Ï€*âˆ‘ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶:æ¯ä¸ªçŠ¶æ€-åŠ¨ä½œå¯¹è¢«è®¿é—®æ— é™å¤šæ¬¡ï¼Œå¹¶ä¸”è¯¥ç­–ç•¥æ”¶æ•›åˆ°å…³äºŽåŠ¨ä½œ-å€¼å‡½æ•°ä¼°è®¡ *Q çš„è´ªå©ªç­–ç•¥*æˆ‘ä»¬å°†è¿™äº›æ¡ä»¶ç§°ä¸º**æ— é™æŽ¢ç´¢æžé™ä¸­çš„è´ªå©ª**ä»¥ç¡®ä¿ä»£ç†åœ¨æ‰€æœ‰æ—¶é—´æ­¥ç»§ç»­æŽ¢ç´¢ï¼Œå¹¶ä¸”ä»£ç†é€æ¸æŽ¢ç´¢æ›´å¤šå’ŒæŽ¢ç´¢æ›´å°‘ã€‚**

**æ»¡è¶³è¿™äº›æ¡ä»¶çš„ä¸€ç§æ–¹æ³•æ˜¯ä¿®æ”¹ *Ïµ* çš„å€¼ï¼Œå½“æŒ‡å®š *Ïµ* è´ªå©ªç­–ç•¥æ—¶ï¼Œä½¿å…¶é€æ¸è¡°å‡ã€‚ç„¶è€Œï¼Œåœ¨è®¾å®š *Ïµ.çš„è¡°å‡çŽ‡æ—¶å¿…é¡»éžå¸¸å°å¿ƒ*ç¡®å®šæœ€ä½³è¡°å˜ä¸æ˜¯å°äº‹ï¼Œéœ€è¦ä¸€ç‚¹ç‚¼é‡‘æœ¯ï¼Œä¹Ÿå°±æ˜¯ç»éªŒã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­çœ‹åˆ°å®žçŽ°çš„ä¾‹å­ã€‚**

# **ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿ**

**åˆ°ç›®å‰ä¸ºæ­¢ï¼Œåœ¨æˆ‘ä»¬å½“å‰çš„è’™ç‰¹å¡ç½—æŽ§åˆ¶ç®—æ³•ä¸­ï¼Œæˆ‘ä»¬æ”¶é›†äº†å¤§é‡çš„ç‰‡æ®µæ¥æž„å»º Q è¡¨ã€‚ç„¶åŽï¼Œåœ¨ Q è¡¨ä¸­çš„å€¼æ”¶æ•›ä¹‹åŽï¼Œæˆ‘ä»¬ä½¿ç”¨è¯¥è¡¨æ¥æå‡ºæ”¹è¿›çš„ç­–ç•¥ã€‚ç„¶è€Œï¼Œè’™ç‰¹å¡ç½—é¢„æµ‹æ–¹æ³•**å¯ä»¥åœ¨é€é›†çš„åŸºç¡€ä¸Šé€æ­¥å®žæ–½**ã€‚[åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ](/mc-control-methods-50c018271553)ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•æŒ‰ç…§è¿™ä¸ªæƒ³æ³•æž„å»ºæ›´å¥½çš„ MC æŽ§åˆ¶ç®—æ³•ã€‚ä¸‹æœŸå¸–å­å†è§ï¼**** 

# **æ·±åº¦å¼ºåŒ–å­¦ä¹ è®²è§£ç³»åˆ—**

****ç”±** [**UPC å·´å¡žç½—é‚£ç†å·¥å¤§å­¦**](https://www.upc.edu/en) **å’Œ** [**å·´å¡žç½—é‚£è¶…çº§è®¡ç®—ä¸­å¿ƒ**](https://www.bsc.es/)**

**ä¸€ä¸ªè½»æ¾çš„ä»‹ç»æ€§[ç³»åˆ—](https://torres.ai/deep-reinforcement-learning-explained-series/)ä»¥ä¸€ç§å®žç”¨çš„æ–¹å¼é€æ¸å‘è¯»è€…ä»‹ç»è¿™é¡¹ä»¤äººå…´å¥‹çš„æŠ€æœ¯ï¼Œå®ƒæ˜¯äººå·¥æ™ºèƒ½é¢†åŸŸæœ€æ–°çªç ´æ€§è¿›å±•çš„çœŸæ­£æŽ¨åŠ¨è€…ã€‚**

**[](https://torres.ai/deep-reinforcement-learning-explained-series/) [## æ·±åº¦å¼ºåŒ–å­¦ä¹ è§£é‡Š-ä¹”è¿ªæ‰˜é›·æ–¯ã€‚äººå·¥æ™ºèƒ½

### æœ¬ç³»åˆ—çš„å†…å®¹](https://torres.ai/deep-reinforcement-learning-explained-series/) 

# å…³äºŽè¿™ä¸ªç³»åˆ—

æˆ‘åœ¨äº”æœˆå¼€å§‹å†™è¿™ä¸ªç³»åˆ—ï¼Œåœ¨å·´å¡žç½—é‚£çš„**å°é”æœŸã€‚**è€å®žè¯´ï¼Œç”±äºŽå°é”ï¼Œåœ¨ä¸šä½™æ—¶é—´å†™è¿™äº›å¸–å­å¸®åŠ©äº†æˆ‘ [**#StayAtHome**](https://twitter.com/hashtag/StayAtHome?src=hashtag_click) ã€‚æ„Ÿè°¢æ‚¨å½“å¹´é˜…è¯»è¿™ä»½åˆŠç‰©ï¼›å®ƒè¯æ˜Žäº†æˆ‘æ‰€åšçš„åŠªåŠ›ã€‚

**å…è´£å£°æ˜Ž** â€”è¿™äº›å¸–å­æ˜¯åœ¨å·´å¡žç½—çº³å°é”æœŸé—´å†™çš„ï¼Œç›®çš„æ˜¯åˆ†æ•£ä¸ªäººæ³¨æ„åŠ›å’Œä¼ æ’­ç§‘å­¦çŸ¥è¯†ï¼Œä»¥é˜²å¯¹æŸäººæœ‰æ‰€å¸®åŠ©ï¼Œä½†ä¸æ˜¯ä¸ºäº†æˆä¸º DRL åœ°åŒºçš„å­¦æœ¯å‚è€ƒæ–‡çŒ®ã€‚å¦‚æžœè¯»è€…éœ€è¦æ›´ä¸¥è°¨çš„æ–‡æ¡£ï¼Œæœ¬ç³»åˆ—çš„æœ€åŽä¸€ç¯‡æ–‡ç« æä¾›äº†å¤§é‡çš„å­¦æœ¯èµ„æºå’Œä¹¦ç±ä¾›è¯»è€…å‚è€ƒã€‚ä½œè€…æ„è¯†åˆ°è¿™ä¸€ç³»åˆ—çš„å¸–å­å¯èƒ½åŒ…å«ä¸€äº›é”™è¯¯ï¼Œå¦‚æžœç›®çš„æ˜¯ä¸€ä¸ªå­¦æœ¯æ–‡ä»¶ï¼Œåˆ™éœ€è¦å¯¹è‹±æ–‡æ–‡æœ¬è¿›è¡Œä¿®è®¢ä»¥æ”¹è¿›å®ƒã€‚ä½†æ˜¯ï¼Œå°½ç®¡ä½œè€…æƒ³æé«˜å†…å®¹çš„æ•°é‡å’Œè´¨é‡ï¼Œä»–çš„èŒä¸šæ‰¿è¯ºå¹¶æ²¡æœ‰ç•™ç»™ä»–è¿™æ ·åšçš„è‡ªç”±æ—¶é—´ã€‚ç„¶è€Œï¼Œä½œè€…åŒæ„æç‚¼æ‰€æœ‰é‚£äº›è¯»è€…å¯ä»¥å°½å¿«æŠ¥å‘Šçš„é”™è¯¯ã€‚**