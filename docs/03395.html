<html>
<head>
<title>How to Build Your Geocoding Web App with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Python构建地理编码Web应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-your-geocoding-web-app-with-python-133e1e9e2d1a?source=collection_archive---------17-----------------------#2020-03-31">https://towardsdatascience.com/how-to-build-your-geocoding-web-app-with-python-133e1e9e2d1a?source=collection_archive---------17-----------------------#2020-03-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="54cf" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">易于遵循的指南和教程代码</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/de239222cb476de4b3ee0d3cf28ec989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oBHqFORpVJhxrlwF"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">格伦·卡斯滕斯-彼得斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="e5eb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们经常需要将地址转换为地理位置(纬度和经度)，这称为地理编码。您可以使用几个免费地理编码API(当然有限制)。在本教程中，我将向您展示如何创建免费的地理编码应用程序，您可以拖放带有地址的CSV文件，并以CSV格式获取(下载)地理编码地址。</p><p id="ee5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们使用<a class="ae ky" href="https://geopandas.org/index.html" rel="noopener ugc nofollow" target="_blank"> Geopandas </a>和<a class="ae ky" href="https://www.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>用Python构建地理编码应用。可选地，你需要一个像Visual studio代码这样的IDE来运行应用程序。让我们开始吧。我们首先导入库。</p><p id="905d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面这张GIF展示了我们将要构建的一瞥。它将允许用户上传文件，并通过选择正确的栏目进行互动。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/15eed25e064ce10940ee532305e67329.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*26JUF5PkplimfEEJv5TC6Q.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">地理编码应用程序-上传CSV文件</p></figure><h2 id="1950" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">简化基础知识</h2><p id="7da1" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">web应用程序使用Streamlit。Streamlit是一个简单易用的纯Python的web应用构建库。我创建了一个python文件(app.py ),我们将使用它来编写代码。</p><p id="2f87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们首先导入我们需要的库</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="45de" class="lw lx it mv b gy mz na l nb nc">import time<br/>import base64</span><span id="d821" class="lw lx it mv b gy nd na l nb nc">import streamlit as st</span><span id="ce86" class="lw lx it mv b gy nd na l nb nc">import pandas as pd<br/>import geopandas as gpd</span><span id="31e1" class="lw lx it mv b gy nd na l nb nc">import geopy<br/>from geopy.geocoders import Nominatim<br/>from geopy.extra.rate_limiter import RateLimiter</span><span id="e40a" class="lw lx it mv b gy nd na l nb nc">import plotly_express as px</span></pre><p id="2e0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们首先创建标题，然后运行应用程序来测试它是否有效。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="7a32" class="lw lx it mv b gy mz na l nb nc">st.image(“geocoding.jpg”)</span><span id="1bef" class="lw lx it mv b gy nd na l nb nc">st.title(“Geocoding Application in Python”)</span><span id="fee5" class="lw lx it mv b gy nd na l nb nc">st.markdown(“Uppload a CSV File with address columns (Street name &amp; number, Postcode, City)”)</span></pre><p id="19f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Streamlit使用一个定义良好的API，您可以简单地立即开始使用。看看上面的代码，我打赌你能猜到它是做什么的。在代码的第一行，我们使用<code class="fe ne nf ng mv b">st.image()</code>显示一幅图像。在第二行中，我们还使用<code class="fe ne nf ng mv b">st.tittle()</code>将测试显示为tittle。最后，我们使用<code class="fe ne nf ng mv b">st.markdown()</code>显示文本。现在，让我们运行应用程序。</p><p id="0fd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行Streamlit就像在终端上写一样简单:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="e4a9" class="lw lx it mv b gy mz na l nb nc">streamlit run app.py</span></pre><p id="585b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">运行应用程序将启动浏览器，如果没有错误，您可以看到应用程序正在运行。图像、标题和文本都在那里(见下图)。我们将继续致力于这个界面。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/a9b6e85377319039b5aa579a07f74842.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gg6DEYonYdWNZlR-jS1jug.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用Streamlit的地理编码应用程序</p></figure><h2 id="71b5" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">上传CSV文件</h2><p id="dcb8" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">上传文件，我们可以用<code class="fe ne nf ng mv b">st.file_upoader()</code>。我们创建一个函数，允许我们使用<code class="fe ne nf ng mv b">st.file_upoader()</code>与本地数据进行交互。</p><p id="9a42" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们创建主函数，并在其中上传一个CSV文件。一旦CSV被上传，我们就可以使用Pandas来读取数据并显示数据的前几行。我们将在开发应用程序的过程中编辑这个主菜单。你可以在最后一部分——应用程序中找到这个函数的最终代码。</p><h2 id="e8ed" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">创建或选择地址列</h2><p id="434b" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我们需要一个可能格式化的地址列，在这个应用程序中，因此我们设计，以便它可以接受一个格式良好的列和地理编码或从数据中的列创建地址列。下面是一个格式正确的地址示例。它有街道名称和号码，邮政编码，城市和国家。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="dd78" class="lw lx it mv b gy mz na l nb nc">Karlaplan 13,115 20,STOCKHOLM, Sweden</span></pre><p id="8125" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下两个功能允许用户选择他们想要的选项，然后在主菜单功能下处理选择。第一个从DataFrame列格式化并创建一个地址列。</p><p id="e814" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面的第二个函数只是选择一个可能格式化的列作为地址列。</p><h2 id="6607" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">地理编码</h2><p id="d64b" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我们现在可以开始地理编码，下面的功能使用nomim地理编码器。该函数返回包含纬度和经度列的地理编码数据框。</p><p id="1e01" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦我们对数据进行地理编码，我们就可以在地图上显示它。下面这个函数使用Plotly Express。要将图形传递给Streamlit，可以使用<code class="fe ne nf ng mv b">st.plotly_chart()</code>。请记住，您可以使用其他库来绘制数据。</p><h2 id="41e1" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">下载地理编码CSV文件</h2><p id="16c7" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">对数据进行地理编码后，应用程序会再次显示带有纬度和经度的数据框。这将是很好的，也能够下载地理编码的数据。</p><p id="6063" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要下载文件，我们可以编写下面的函数，它允许我们右键单击并用给定的名称保存文件。</p><h2 id="f8e1" class="lw lx it bd ly lz ma dn mb mc md dp me li mf mg mh lm mi mj mk lq ml mm mn mo bi translated">该应用程序</h2><p id="f760" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">将所有代码放在一起，地理编码应用程序代码如下所示。</p><p id="7748" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果我们愿意，我们可以添加更多的功能，并在此基础上构建其他用例。以下是如何在应用程序中下载地理编码文件的一瞥。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/b508faeaa45c2788acd335b6a4894c78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0_rmtkoTRnljpYn-Lig5XQ.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">地理编码应用程序-下载地理编码文件</p></figure><p id="1ccb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">代码也存放在这个Github存储库中。</p><div class="ni nj gp gr nk nl"><a href="https://github.com/shakasom/geocoding" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd iu gy z fp nq fr fs nr fu fw is bi translated">shaka som/地理编码</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">Python中的地理编码教程。通过在GitHub上创建帐户，为shaka som/地理编码开发做出贡献。</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">github.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz ks nl"/></div></div></a></div></div></div>    
</body>
</html>