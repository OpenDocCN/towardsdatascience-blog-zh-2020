<html>
<head>
<title>Tweedie Loss Function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">特威迪损失函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/tweedie-loss-function-for-right-skewed-data-2c5ca470678f?source=collection_archive---------17-----------------------#2020-03-18">https://towardsdatascience.com/tweedie-loss-function-for-right-skewed-data-2c5ca470678f?source=collection_archive---------17-----------------------#2020-03-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/db924cf8b9e3b815735ff1d0315185d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YYvj6ygSGnM-q9SB7X2aKg.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="8cd7" class="pw-subtitle-paragraph jy ja jb bd b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp dk translated">长尾右偏数据的损失函数</h2></div><p id="5832" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi lm translated">如今，观察具有右偏分布和长尾的数据并不罕见，例如，来自电子商务网站、广告点击&amp;购买、保险索赔等的数据。</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/3199810c323e2a0062ca49b1f9225a59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*U_j8CIbyMgvZPc8jgGpSPA.png"/></div></figure><p id="0a79" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">在这种情况下，如果使用其他分布的损失函数(例如，高斯分布的 MSE ),预测模型可能不会被很好地训练。在本文中，我们介绍了一种使用基于 Tweedie 的损失函数的方法，用于在这种长尾右偏数据上训练的模型。</p><h1 id="bde7" class="ma mb jb bd mc md me mf mg mh mi mj mk kh ml ki mm kk mn kl mo kn mp ko mq mr bi translated">特威迪分布</h1><p id="f430" class="pw-post-body-paragraph kq kr jb ks b kt ms kc kv kw mt kf ky kz mu lb lc ld mv lf lg lh mw lj lk ll ij bi translated"><a class="ae mx" href="https://en.wikipedia.org/wiki/Tweedie_distribution" rel="noopener ugc nofollow" target="_blank"> Tweedie 分布</a>是带有幂参数<em class="my"> p </em>的指数离差模型(EDM)的特例，其分布均值和方差之间的幂关系如下</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/53413f87c7dd04aec864cc773c1a5eda.png" data-original-src="https://miro.medium.com/v2/resize:fit:420/format:webp/1*hGbirIkeQtHqb5f6zR-clQ@2x.png"/></div></figure><p id="37a1" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">其中<em class="my"> μ </em>和<em class="my"> ϕ </em>分别是均值和离差参数。</p><p id="a7ab" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">功率参数<em class="my"> p </em>决定了族内分布的子类。例如，<em class="my"> p </em> =1 链接到泊松分布，<em class="my"> p </em> =3 链接到逆高斯分布，而本文的重点，<em class="my"> p∈ </em> (1，2)链接到复合泊松-伽马分布。</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/76cf3c4b25111a2009c5b0a9b82012fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VJaaeSNS1qjyoR8N1-l1AQ.png"/></div></div><p class="nb nc gj gh gi nd ne bd b be z dk translated">特威迪分布族的普通成员。</p></figure><p id="2852" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">假设是复合分布，随机变量<em class="my"> X </em> ~ <em class="my"> Tw </em> ( <em class="my"> p，μ，ϕ </em>)可以刻画为</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nf"><img src="../Images/81a44a78a6a9eef9809d2c20ccd4a5ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_GGLPSYJ9KmfdI0x6msg8A.png"/></div></div></figure><p id="98fa" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><em class="my"> x </em>的概率密度函数(pdf)为</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ng"><img src="../Images/b096b9429339b8878665fe03b5e58323.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r18lG0gJ3c1YcOYrNB0e4Q@2x.png"/></div></div></figure><p id="bbde" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">其中<em class="my"> α </em> ( <em class="my"> x，ϕ，p </em>)是一个归一化常数，确保这是一个有效的 pdf。</p><h1 id="1a65" class="ma mb jb bd mc md me mf mg mh mi mj mk kh ml ki mm kk mn kl mo kn mp ko mq mr bi translated">作为损失函数的特威迪</h1><p id="ff56" class="pw-post-body-paragraph kq kr jb ks b kt ms kc kv kw mt kf ky kz mu lb lc ld mv lf lg lh mw lj lk ll ij bi translated">为了将 Tweedie 分布转换为损失函数，我们需要通过模型训练来最大化样本数据的可能性。一种常见的方法是通过负对数似然</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/bc60e9c63cc80b539499e742c7cc7d09.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*wvIj6vydwp4iVkAPjCNKCA@2x.png"/></div></figure><p id="7bfa" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">如果我们使用分布均值<em class="my"> μ </em>作为估计量(即预测)，那么损失函数变成</p><figure class="lw lx ly lz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ni"><img src="../Images/05730ec2a98ce5c4ad6cdd1f3d3b0c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zm-P8gibbBwXQSuRYQVycQ.png"/></div></div></figure><h1 id="3e2a" class="ma mb jb bd mc md me mf mg mh mi mj mk kh ml ki mm kk mn kl mo kn mp ko mq mr bi translated">履行</h1><p id="46c3" class="pw-post-body-paragraph kq kr jb ks b kt ms kc kv kw mt kf ky kz mu lb lc ld mv lf lg lh mw lj lk ll ij bi translated">给定预定义的功率参数<em class="my"> p </em>(超参数)，Tweedie 损失函数可用于各种基于梯度的模型，如梯度提升树、神经网络等。下面给出了一个实现的例子。</p><pre class="lw lx ly lz gt nj nk nl nm aw nn bi"><span id="b46f" class="no mb jb nk b gy np nq l nr ns">import tensorflow as tf<br/>def tweedie_loss_func(p):<br/>    def tweedie_loglikelihood(y, y_hat):<br/>        loss = - y * tf.pow(y_hat, 1 - p) / (1 - p) + \<br/>               tf.pow(y_hat, 2 - p) / (2 - p)<br/>        return tf.reduce_mean(loss)</span><span id="eee6" class="no mb jb nk b gy nt nq l nr ns">return tweedie_loglikelihood</span></pre><h2 id="2dce" class="no mb jb bd mc nu nv dn mg nw nx dp mk kz ny nz mm ld oa ob mo lh oc od mq oe bi translated">参考</h2><p id="fa82" class="pw-post-body-paragraph kq kr jb ks b kt ms kc kv kw mt kf ky kz mu lb lc ld mv lf lg lh mw lj lk ll ij bi translated"><a class="ae mx" href="https://arxiv.org/search/stat?searchtype=author&amp;query=Zhou%2C+H" rel="noopener ugc nofollow" target="_blank">鹤舟先生</a>，<a class="ae mx" href="https://arxiv.org/search/stat?searchtype=author&amp;query=Yang%2C+Y" rel="noopener ugc nofollow" target="_blank">杨熠</a>，<a class="ae mx" href="https://arxiv.org/search/stat?searchtype=author&amp;query=Qian%2C+W" rel="noopener ugc nofollow" target="_blank">钱伟</a>。"对于极度不平衡的零膨胀数据的梯迪梯度提升."2019.</p><p id="4c5a" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated"><a class="ae mx" href="https://arxiv.org/search/stat?searchtype=author&amp;query=Halder%2C+A" rel="noopener ugc nofollow" target="_blank">阿里特拉·哈尔德</a>，<a class="ae mx" href="https://arxiv.org/search/stat?searchtype=author&amp;query=Mohammed%2C+S" rel="noopener ugc nofollow" target="_blank">沙里克·穆罕默德</a>，<a class="ae mx" href="https://arxiv.org/search/stat?searchtype=author&amp;query=Chen%2C+K" rel="noopener ugc nofollow" target="_blank">陈坤</a>，<a class="ae mx" href="https://arxiv.org/search/stat?searchtype=author&amp;query=Dey%2C+D" rel="noopener ugc nofollow" target="_blank">迪帕克·戴伊</a>。" Tweedie 复合泊松双广义线性模型中的空间风险估计."2020.</p></div></div>    
</body>
</html>