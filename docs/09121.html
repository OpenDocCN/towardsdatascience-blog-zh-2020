<html>
<head>
<title>Data Exploration 101 with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫数据探索 101</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-exploration-101-with-pandas-e059d0661313?source=collection_archive---------18-----------------------#2020-06-30">https://towardsdatascience.com/data-exploration-101-with-pandas-e059d0661313?source=collection_archive---------18-----------------------#2020-06-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bf13" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Pandas 是访问和使用数据的最强大的图书馆之一。有大量的功能涵盖数据操作，快速绘图以及读取和写入数据。</h2></div><p id="a162" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你是数据科学的新手，一个考试前时间不多的学生，或者你只是想看看其他人如何使用熊猫来<strong class="kk iu">探索和分析</strong> <strong class="kk iu">数据</strong>，请跟随我。对于这个快速介绍，我们将使用通过 Kaggle.com<a class="ae le" href="https://www.kaggle.com/sudalairajkumar/daily-temperature-of-major-cities/data?select=city_temperature.csv" rel="noopener ugc nofollow" target="_blank">获得的主要城市的每日气温数据集。</a></p><p id="30ef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">作为每个数据探索任务的起点，导入数据集是必要的。Python 通过“open()”函数使这变得非常容易，然而不管怎样，因为我们要使用 pandas 库，传统的开放不是办法。Pandas 提供了各种各样的 read_ 函数，允许同时打开文件并将其转换成数据帧。</p><h2 id="ec7b" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">输入数据</h2><figure class="lz ma mb mc gt md"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="58c2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">只用两行代码，您就可以导入数据并创建一个 dataframe 对象，这个对象非常适合使用。除了常见的 Python 数据结构(比如字典)，操作可以在所有数据点上执行，也可以在经过过滤甚至分组的数据点上执行。想象一下，你必须只用普通的数据结构来完成这项任务，这将是一场噩梦。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mg"><img src="../Images/c306ca58c1c86a9b5558d6701f2900af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Bjc5BlTGJV-La0hI"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">不要错过任何关于熊猫的数据细节</p></figure><p id="60fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Pandas 为您提供了令人难以置信的方便和易于应用的预览、修改和导出数据的可能性。在接下来的几行中，我们将通过几个非常有用的例子来操作数据帧。您可能会观察到，<a class="ae le" rel="noopener" target="_blank" href="/julia-r-and-python-7cd50c2b0fe4"> pandas 相当一致</a>(过滤、访问行等。)和其他著名的 Python 库，还有像 r。</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><h2 id="0dda" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">描述数据</h2><p id="a8ec" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">几乎每次分析新数据集时，您都可能会考虑两件事:</p><ol class=""><li id="6a7d" class="nd ne it kk b kl km ko kp kr nf kv ng kz nh ld ni nj nk nl bi translated">您的数据点位于什么范围内——这对于获得数据的“感觉”以及检查一致性、可靠性和异常值至关重要</li><li id="351f" class="nd ne it kk b kl nm ko nn kr no kv np kz nq ld ni nj nk nl bi translated">您是否在数据框架中看到无效或缺失的值</li></ol><figure class="lz ma mb mc gt md"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="1539" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">仅使用这些 to 行将允许您检查您的数据集并估计您是否需要做更多的数据清理。明确描述()对月、日或年没有意义，但掌握 AvgTemperature 是必不可少的。正如我们在这里看到的，这个度量很可能不是摄氏度(平均温度是 56 度)，而是华氏度。</p><pre class="lz ma mb mc gt nr ns nt nu aw nv bi"><span id="9c16" class="lg lh it ns b gy nw nx l ny nz">      Month        Day          Year          AvgTemperature<br/>count 2.906327e+06 2.906327e+06 2.906327e+06  2.906327e+06<br/>mean  6.469163e+00 1.571682e+01 2.006624e+03  5.600492e+01<br/>std   3.456489e+00 8.800534e+00 2.338226e+01  3.212359e+01<br/>min   1.000000e+00 0.000000e+00 2.000000e+02 -9.900000e+01<br/>25%   3.000000e+00 8.000000e+00 2.001000e+03  4.580000e+01<br/>50%   6.000000e+00 1.600000e+01 2.007000e+03  6.250000e+01<br/>75%   9.000000e+00 2.300000e+01 2.013000e+03  7.550000e+01<br/>max   1.200000e+01 3.100000e+01 2.020000e+03  1.100000e+02</span></pre><p id="3f41" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有时，有些用例要求数据提取可以很容易地复制和插入，我推荐使用<em class="lf"> to_markdown() </em>函数，它为此提供了很好的结果——确实是我的最爱之一。</p><pre class="lz ma mb mc gt nr ns nt nu aw nv bi"><span id="4f42" class="lg lh it ns b gy nw nx l ny nz">|         | Country   |   AvgTemperature |<br/>|--------:|:----------|-----------------:|<br/>| 2906322 | US        |             28   |<br/>| 2906323 | US        |             27.6 |<br/>| 2906324 | US        |             29   |<br/>| 2906325 | US        |             28.8 |<br/>| 2906326 | US        |             28.7 |</span></pre><p id="04f7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们需要进一步检查是否有“非数字”值。如我们所见，只有 State 有缺失字段，这对我们来说完全没问题。请记住，对于机器学习等更复杂的任务，删除以及内插或外推丢失的数据可能是数据科学家的一项关键工作。</p><pre class="lz ma mb mc gt nr ns nt nu aw nv bi"><span id="9a46" class="lg lh it ns b gy nw nx l ny nz">Region            False<br/>Country           False<br/>State              True<br/>City              False<br/>Month             False<br/>Day               False<br/>Year              False<br/>AvgTemperature    False<br/>dtype: bool</span></pre><p id="de5c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了获得一列的唯一值,<em class="lf"> unique() </em>函数非常有用——我们也可以在分组对象上使用它。</p><pre class="lz ma mb mc gt nr ns nt nu aw nv bi"><span id="c3ec" class="lg lh it ns b gy nw nx l ny nz">data.Region.unique()</span><span id="44ab" class="lg lh it ns b gy oa nx l ny nz">array(['Africa', 'Asia', 'Australia/South Pacific', 'Europe',<br/>       'Middle East', 'North America',<br/>       'South/Central America &amp; Carribean'], dtype=object)</span></pre><p id="b855" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当数据被图解或总结时，你可能会对数据有更好的感觉。如果您的数据是数字，您可能会发现散点图或箱线图非常方便。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/66707941d53cf0fc0ab599f6b19562fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*e_q0D8p-x0wenAHuaIIlOg.png"/></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">箱线图中的平均温度。包括异常值。</p></figure><p id="00c7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">旁白:有许多不同的库允许以非常漂亮和快速的方式绘制数据。从个人的角度来看，没有可视化的数据探索通常是困难的，而且要花费更多的时间，因为数据的不规则性可能会在过程的后期被发现。</p><p id="e3f2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是另一个直观的例子，它能让你立即感受到异常值，一个结合了数字和分类变量的非常密集的散点图:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/2e8cb9646d2a5fd6e828c6ae315db485.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*xCNAbxSl4jisEcz53sRLmQ.png"/></div></figure><h2 id="b6a8" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">修改数据</h2><p id="7225" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">正如我们在最初创建的描述表中看到的，温度以华氏温度为单位，对于非美国居民来说，处理数据可能会有点困难，尤其是当涉及到“这里似乎有什么不对劲”这一部分时。</p><p id="6ee2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Pandas 允许我们以一种非常简单直接的方式在列上执行操作。</p><figure class="lz ma mb mc gt md"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="8297" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">更通用的方法是对列应用函数。结果和上面一样，但是，我们可以通过这种方式更有创造性地应用函数。</p><figure class="lz ma mb mc gt md"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="de4e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="lf"> Apply( ) </em>允许用户创建复杂的函数，并将它们应用到一列甚至几列上。还要注意，除了定义一个函数(如我们的 to_celsius 函数)，<strong class="kk iu"> lambda 表达式</strong>也可以很容易地使用——这可能是<strong class="kk iu">只使用一次</strong>时最有用的。</p><p id="ccb0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您更频繁地面对<strong class="kk iu">复杂的修改任务</strong>，您可能希望构建能够通过正则表达式解析单元格值的<strong class="kk iu">函数。在这种情况下，你可能想把正则表达式和 pandas 的应用函数结合起来。如果您觉得需要复习一下数据科学的正则表达式，可以看看下面的链接:</strong></p><div class="od oe gp gr of og"><a rel="noopener follow" target="_blank" href="/mastering-regular-expressions-for-your-day-to-day-tasks-b01385aeea56"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">掌握日常任务的正则表达式</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">可以使用正则表达式的用例非常多。不管你是不是数据科学家收藏…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">towardsdatascience.com</p></div></div><div class="op l"><div class="oq l or os ot op ou ml og"/></div></div></a></div><h2 id="0ecd" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">分组数据— <em class="ov"> groupby() </em></h2><p id="43ba" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">当数据被分组在一起时，Pandas 创建一个 groupby 对象。有很多函数可以应用到一个分组的对象上，比如<em class="lf"> unique()、mean()、min()或 max()</em>——仅举几个例子。请注意，您不能直接“显示”groupby 对象，因为这将导致如下输出:</p><pre class="lz ma mb mc gt nr ns nt nu aw nv bi"><span id="d2c3" class="lg lh it ns b gy nw nx l ny nz">&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x000001F2B6879CD0&gt;</span></pre><p id="e578" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了获得平均值，下面这条线将有所帮助:</p><pre class="lz ma mb mc gt nr ns nt nu aw nv bi"><span id="088e" class="lg lh it ns b gy nw nx l ny nz">data.groupby([‘Region’,’Country’,’State’,’City’,’Year’]).mean()</span></pre><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi ow"><img src="../Images/1aa13fa81e927d266a11e582bd06a05c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fHA6lzwrGciPAfrsu9M0-Q.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">显示平均值的重新编制索引的分组对象</p></figure><p id="ebcf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">同样，平均值对于月或日没有任何意义，因此省略这些列是有用的。还请注意，上表需要重置索引，以便正确显示每行条目。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi ox"><img src="../Images/a8303b89104924952f4bd37e22bd82e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2d5AryD1mRxcShMf2dpV-w.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">更干净的输出</p></figure><h2 id="ca58" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">过滤数据</h2><p id="6f73" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">通常，您可能只对给定数据的一小部分感兴趣。为此，可以通过简单的过滤操作将数据帧最小化为较小的数据帧:</p><pre class="lz ma mb mc gt nr ns nt nu aw nv bi"><span id="b576" class="lg lh it ns b gy nw nx l ny nz">vienna = data[data['City']=='Vienna'].copy() # great city</span></pre><p id="aaa1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据帧的创建副本将只包含“城市”为“维也纳”的值。如果我们需要额外的过滤要求，pandas 允许通过“与”或“管道”来连接标准。</p><p id="2880" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一般来说，我们可以使用主数据框架来绘制相关信息，但是我更喜欢在较小的数据集上使用简单的绘制操作。plot 函数中的过滤数据使其难以阅读和理解。当我们看下面几行代码时，使用数据帧的专用副本的优势变得非常明显:</p><figure class="lz ma mb mc gt md"><div class="bz fp l di"><div class="me mf l"/></div></figure><p id="b326" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">只需 3 行代码，我们就能生成一个包含线性趋势的折线图:</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/6904149d4ff2ad6ca9ee2b577e7d533d.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*bd0yEixjAgsLv-BMyu8gPw.png"/></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">1995 年至 2020 年维也纳平均气温的简单线形图</p></figure><p id="8e17" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们计算一下我们在这里使用的代码行数和我们用这些代码进行的数据操作次数，毫无疑问<strong class="kk iu"> Pandas 是一个非常强大的数据操作工具</strong>，不需要大量的文档阅读和实践。</p><h2 id="5651" class="lg lh it bd li lj lk dn ll lm ln dp lo kr lp lq lr kv ls lt lu kz lv lw lx ly bi translated">有用的文档</h2><p id="e051" class="pw-post-body-paragraph ki kj it kk b kl my ju kn ko mz jx kq kr na kt ku kv nb kx ky kz nc lb lc ld im bi translated">如果您想更好地理解我们在本文中所涉及的内容，我建议您从下面的文档开始，仔细阅读与您相关的细节。请记住，就像每一项学习任务一样，做比(仅仅)阅读要好。</p><div class="od oe gp gr of og"><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">熊猫。数据框架- pandas 1.0.5 文档</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">数据结构还包含带标签的轴(行和列)。算术运算在行和列上都对齐…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">pandas.pydata.org</p></div></div></div></a></div><div class="od oe gp gr of og"><a href="https://matplotlib.org/tutorials/introductory/pyplot.html" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">Pyplot 教程- Matplotlib 3.2.2 文档</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">pyplot 接口介绍。是一个命令风格函数的集合，它使 matplotlib 像…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">matplotlib.org</p></div></div><div class="op l"><div class="oz l or os ot op ou ml og"/></div></div></a></div><div class="od oe gp gr of og"><a href="https://www.w3schools.com/python/numpy_array_filter.asp" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd iu gy z fp ol fr fs om fu fw is bi translated">NumPy 滤波器阵列</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">从现有数组中取出一些元素，然后用它们创建一个新数组，这叫做过滤。在 NumPy，你…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">www.w3schools.com</p></div></div><div class="op l"><div class="pa l or os ot op ou ml og"/></div></div></a></div><blockquote class="pb"><p id="ec8b" class="pc pd it bd pe pf pg ph pi pj pk ld dk translated">一如既往，下次再见，注意安全！</p></blockquote></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><p id="2408" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">图片由古斯塔夫·古尔斯特兰德提供，谢谢！</p></div></div>    
</body>
</html>