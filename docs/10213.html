<html>
<head>
<title>How to produce Interactive Matplotlib Plots in Jupyter Environment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Jupyter 环境下生成交互式 Matplotlib 图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-produce-interactive-matplotlib-plots-in-jupyter-environment-1e4329d71651?source=collection_archive---------0-----------------------#2020-07-19">https://towardsdatascience.com/how-to-produce-interactive-matplotlib-plots-in-jupyter-environment-1e4329d71651?source=collection_archive---------0-----------------------#2020-07-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="066a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用所有使用 Matplotlib 的 Python 库创建交互式绘图/地图</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/cfb21d6b6c3367031b0b8302ef9ca0a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2-MzhR-fxWdBAYxhXCBTOQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用 Canva 创建的图像</p></figure><p id="fad7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Matplotlib 是非常强大的可视化库，是许多其他 python 库的默认后端，包括 Pandas、Geopandas 和 Seaborn 等等。</p><p id="29aa" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">今天，有不同的选项来启用 Matplotlib 绘图的交互性。然而，新的本地 Matplotlib/Jupyter 交互小部件为所有使用 Matplotlib 的第三方包提供了更广泛的用途和好处。</p><p id="6572" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这项技术建立在 Matplotlib 和 Widgets 之上，允许您在没有第三方库的情况下进行交互式绘图。唯一的要求是安装 Ipympl，所有的交互性扩展都可以在您的 Jupiter 笔记本环境中获得。</p><p id="4813" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本教程中，我将介绍一些使用 ipympl 的 Matplotlib 交互式数据可视化的用例及示例。我们将首先介绍 ipympl 的基础知识，它的画布和一些例子。</p><blockquote class="lu lv lw"><p id="adcb" class="ky kz lx la b lb lc ju ld le lf jx lg ly li lj lk lz lm ln lo ma lq lr ls lt im bi translated">利用 Jupyter interactive widgets 框架，<a class="ae mb" href="https://github.com/matplotlib/ipympl" rel="noopener ugc nofollow" target="_blank"> IPYMPL </a>在 Jupyter 笔记本和 JupyterLab 中启用 matplotlib 的交互特性。</p></blockquote><h2 id="fcbd" class="mc md it bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">Jupyter 实验室的 IPYMPL</h2><p id="0c89" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">要启用交互式可视化后端，您只需使用 Jupyter magic 命令:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="4ce7" class="mc md it nb b gy nf ng l nh ni">%matplotlib widget</span></pre><p id="cb80" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，让我们设想一个 matplotlib 图。我们首先用 Pandas 读取数据，并用 Matplotlib 创建散点图。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="85fd" class="mc md it nb b gy nf ng l nh ni">url =</span><span id="f671" class="mc md it nb b gy nj ng l nh ni">df = pd.read_csv(<br/>“<a class="ae mb" href="https://raw.githubusercontent.com/plotly/datasets/master/tips.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/plotly/datasets/master/tips.csv</a>”<br/>)</span><span id="5ebf" class="mc md it nb b gy nj ng l nh ni"># Matplotlib Scatter Plot<br/>plt.scatter(‘total_bill’, ‘tip’,data=df)<br/>plt.xlabel(‘Total Bill’)<br/>plt.ylabel(‘Tip’)<br/>plt.show()</span></pre><p id="040e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">没有额外的代码，只使用简单的 matplotlib 代码，输出是一个交互式的绘图，您可以放大/缩小，平移并重置为原始视图。下面的 GIF 图像显示了 ipympl 可能的交互性。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/3510d4cb22849e89e0c60bda8df61c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*11_WvW_dvGcn-PHv5r08wg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用 Ipympl 的 Maptlotlib 交互式绘图</p></figure><p id="3b16" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，您还可以定制用户界面的可见性、画布页脚和画布大小。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="5701" class="mc md it nb b gy nf ng l nh ni">fig.canvas.toolbar_visible = <strong class="nb iu">False</strong><br/>fig.canvas.header_visible = <strong class="nb iu">False<br/></strong>fig.canvas.resizable = <strong class="nb iu">True</strong></span></pre><p id="f016" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这些命令改变 Ipympl 和 Matplotlib 图的用户界面。按钮将从用户界面上消失，但您仍然可以使用这些功能。要恢复到通常的 matplotlib 图，可以内联调用 matplotlib:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="c447" class="mc md it nb b gy nf ng l nh ni">%matplotlib inline</span></pre><p id="9ada" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们转向与熊猫互动的情节。</p><h2 id="658c" class="mc md it bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">互动熊猫情节</h2><p id="9697" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">熊猫图建立在 Matplotlib 之上；因此，我们也可以使用 Ipympl 创建交互式熊猫情节。让我们用熊猫做一个简单的线图。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="5a45" class="mc md it nb b gy nf ng l nh ni">df.plot(kind=”line”)</span></pre><p id="6795" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">瞧，我们有一个与熊猫互动的情节。这个线图很密集，有了这个交互功能，我们可以放大到特定的地方，与图进行交互。见下图 GIF。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/db4a34ac674b07e001f838be449f7efc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*cU_WdWASu2cgjEMK3utzMA.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">互动熊猫情节与 Ipympl</p></figure><p id="acc4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，熊猫已经有一些交互式后端选项，包括 Plotly 和 Bokeh。然而，这并没有扩展到构建在 Pandas 之上的其他库。Geopandas 就是这样一个库，多亏了 Ipympl，它获得了第一批交互式地图。</p><h2 id="2cc7" class="mc md it bd me mf mg dn mh mi mj dp mk lh ml mm mn ll mo mp mq lp mr ms mt mu bi translated">带有 Geopandas 的交互式地图</h2><p id="6759" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">如果您在 Pandas 中使用过地理空间数据，那么您应该已经知道 Geopandas，它在地理空间数据科学领域得到了广泛的应用。带有 Geopandas 的交互式地图改变了游戏规则。虽然 pandas 有其他后端选项来使其情节互动，但这在 Geopandas 上是不可能的。</p><p id="79e7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">由于 Geopandas 也构建在 Maptlotlib 之上，因此 Ipympl 的交互式后端也扩展到了它。我们现在可以在 Geopandas 中拥有交互式地图，而无需使用任何其他第三方地理可视化库。</p><p id="5add" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看一个由 Ipympl 支持的 Geopandas 交互式地图的例子。我将首先使用 Pandas 读取数据，因为我们使用 CSV 文件并将其转换为 Geopandas 地理数据框架。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="d900" class="mc md it nb b gy nf ng l nh ni">carshare = “<a class="ae mb" href="https://raw.githubusercontent.com/plotly/datasets/master/carshare.csv" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/plotly/datasets/master/carshare.csv</a>"<br/>df_carshare = pd.read_csv(carshare)</span><span id="c752" class="mc md it nb b gy nj ng l nh ni">gdf = gpd.GeoDataFrame(df_carshare, geometry=gpd.points_from_xy(df_carshare.centroid_lon, df_carshare.centroid_lat), crs=”EPSG:4326")</span></pre><p id="f160" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们现在可以使用 Geopandas 绘制任何地理空间数据。我们可以直接打电话。plot()以可视化地图。然而，在这个例子中，我还添加了一个用于上下文目的的底图。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="ad62" class="mc md it nb b gy nf ng l nh ni">import contextily as ctx<br/>fig, ax = plt.subplots()<br/>gdf.to_crs(epsg=3857).plot(ax=ax, color=”red”, edgecolor=”white”)<br/>ctx.add_basemap(ax, url=ctx.providers.CartoDB.Positron) <br/>plt.title(“Car Share”, fontsize=30, fontname=”Palatino Linotype”, color=”grey”)<br/>ax.axis(“off”)<br/>plt.show()</span></pre><p id="dbe3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们有一个互动地图，上面有 Geopandas。我们可以放大缩小和平移地图。太棒了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nm"><img src="../Images/9098452482e8e82bd3c709e44d98ac65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0g7ydM2-dGm1RpeX9zZHjg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用 Ipympl 的交互式 Geopandas 地图</p></figure><p id="6c9b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我每天都使用 Geoapndas，所以这是一个没有太多障碍的巨大补充。您仍然可以使用 Geopandas 并拥有交互式地图，而无需使用其他第三方包。</p><h1 id="6636" class="nn md it bd me no np nq mh nr ns nt mk jz nu ka mn kc nv kd mq kf nw kg mt nx bi translated">结论</h1><p id="b304" class="pw-post-body-paragraph ky kz it la b lb mv ju ld le mw jx lg lh mx lj lk ll my ln lo lp mz lr ls lt im bi translated">在本教程中，我们介绍了一种使用 Ipympl 通过 Maptlotlib 启用交互式绘图的简单方便的方法。我们已经看到了如何使用 Matplotlib、Pandas 和 Geopandas 创建交互式绘图。</p><p id="dc81" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">要使用 Ipympl 的交互功能，您可以使用 Conda/ pip 安装它:</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="a75f" class="mc md it nb b gy nf ng l nh ni">conda install -c conda-forge ipympl<br/>pip install ipympl</span></pre><p id="aa94" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果使用的是 jupyterLab，还需要安装 node js 和 Jupyter Lab 扩展管理器。</p><pre class="kj kk kl km gt na nb nc nd aw ne bi"><span id="f7be" class="mc md it nb b gy nf ng l nh ni">conda install -c conda-forge nodejs</span><span id="2985" class="mc md it nb b gy nj ng l nh ni">jupyter labextension install @jupyter-widgets/jupyterlab-manager<br/>jupyter lab build</span></pre></div></div>    
</body>
</html>