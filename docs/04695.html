<html>
<head>
<title>Get a 300x speed up of your Machine Learning pipeline with RapidsAI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">借助RapidsAI，将您的机器学习管道速度提高300倍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-get-more-then-300x-speed-up-of-your-machine-learning-pipeline-with-rapids-cuml-library-cbed4c4be6a0?source=collection_archive---------46-----------------------#2020-04-25">https://towardsdatascience.com/how-to-get-more-then-300x-speed-up-of-your-machine-learning-pipeline-with-rapids-cuml-library-cbed4c4be6a0?source=collection_archive---------46-----------------------#2020-04-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="19fe" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你有没有在GPU卡上运行过最近邻！没有吗？那你为什么还不读书？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fb64b678cc369b95aacbdda4129050a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Ly3556n4E5b-1D3Sp-4Sw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/photos/9HI8UJMSdZA" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/photos/9HI8UJMSdZA</a></p></figure><p id="0e0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当在大型数据集上使用简单的机器学习算法(如最近邻算法)时，找到好的模型超参数甚至建立强大的交叉验证框架往往会变得很困难，因为即使使用简单的训练测试分割，也需要模型时间来完成训练！克服这个问题的一种方法是使用Dask或PySpark在CPU上进行分配。但是今天我想向您展示另一种方法——使用您的GPU能力来拟合模型。以前从sklearn库中没有好的方法可以做到这一点，但是现在你可以使用<a class="ae ky" href="https://github.com/rapidsai" rel="noopener ugc nofollow" target="_blank"> Rapids </a> AI cuML库来适应绝大多数Sklearn模型！在这篇文章中，我想给你看一个Rapids cuML和Sklearn在近邻算法上的快速比较。如果你对安装过程感兴趣，在Rapids github页面上有很好的描述。我们开始吧！</p><h2 id="6d29" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">代码</h2><p id="1ad4" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我将使用<a class="ae ky" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>平台，该平台每周提供30小时的免费K-80 GPU使用(TPU也可用)。</p><p id="9337" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先，让我们从两个库中导入最近邻算法。这两个库中的API调用看起来是一样的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/cc2454d181c7a458e8640adf73609066.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*cI2u1L-YvKYQvHS7x6iMog.png"/></div></figure><p id="e9be" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我将使用<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_blobs.html" rel="noopener ugc nofollow" target="_blank">sk learn . datasets . make _ blobs</a>方法创建一个虚拟数据集。我将创建5个不同大小的数据集:从小到大。在每个数据集上，我将使用10个邻居来拟合最近邻居模型，然后计算测试集中每个点的最近邻居。让我们先来拟合Rapids GPU最近邻。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/72765100603c5aaae608b3a6370c85ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6xyam5oL1H65-fuVrvgVbw.png"/></div></div></figure><p id="c6a4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如你所见，它运行得非常快。现在，是时候适合Sklearn了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/487395bd368b94fcc464c5087b5cd2b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6xhPi4fZHzLWGv32KZqdwA.png"/></div></div></figure><p id="8442" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">哇！这真的很长。正如你在小数据集上看到的，sklearn优于rapids，但在最大数据集上，我们获得了300倍的速度提升。</p><p id="eee6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们也使用Plotly构建一个小的比较图(我将使用log转换，以便更好地显示结果)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/11294e85d08914c6f71b7344f8b18b19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h37Xhm6dKLOcsM-ATZ9kbw.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/1f69b7b9144fa26dad4e1b8b17d80482.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9GWG9QJBSTZx7Eld-oxlFg.png"/></div></div></figure><p id="a618" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">哇，我有时候还是不相信会有这么大的速度提升，cuML库绝对值得一试！将Rapids与Dask之类的东西进行比较也很有趣，但这是另一篇文章的想法。</p><p id="850f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读！</p><p id="ba58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">你可以在我的</strong> <a class="ae ky" href="http://artkulakov.com" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu">网站</strong> </a>上查看其他帖子</p></div></div>    
</body>
</html>