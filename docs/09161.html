<html>
<head>
<title>Getting Started with GANs Using PyTorch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 PyTorch 开始使用 GANs</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/getting-started-with-gans-using-pytorch-78e7c22a14a5?source=collection_archive---------5-----------------------#2020-07-01">https://towardsdatascience.com/getting-started-with-gans-using-pytorch-78e7c22a14a5?source=collection_archive---------5-----------------------#2020-07-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="2a5d" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph"><a class="ae ep" href="https://towardsai.net/p/category/machine-learning" rel="noopener ugc nofollow" target="_blank">机器学习</a></h2><div class=""/><div class=""><h2 id="4bd1" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">我们将看到 GAN 生成新图像的能力，乍一看，这使 GAN 看起来有点“神奇”。</h2></div><h1 id="545b" class="ko kp iq bd kq kr ks kt ku kv kw kx ky kf kz kg la ki lb kj lc kl ld km le lf bi translated">介绍</h1><p id="b086" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">生成对抗网络(GAN)是 Ian Goodfellow 和他的同事在 2014 年构想的一类机器学习框架。两个神经网络(生成器和鉴别器)像在游戏中一样相互竞争。这种技术学习在给定训练集的情况下，使用与训练集相同的统计信息来生成新数据。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/4158598f32b151dd36b6616b77d8de47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/1*NZv31JPYlg8KMrbsAPdHiQ.gif"/></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">生成的图像</p></figure><p id="56c2" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">在这篇博文中，我们将训练一个 GAN 来生成猫的面部图像。我们将使用由超过 15700 张猫图片组成的<a class="ae mt" href="https://www.kaggle.com/spandan2/cats-faces-64x64-for-generative-models" rel="noopener ugc nofollow" target="_blank">猫脸数据集</a>。由于生成建模是一种无监督的学习方法，因此图像上没有标签。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/23d314aa52afe25a2ed73a28ecdd06d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*gpYoqJXgA7IhZHGJrF5Qtw.png"/></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">来自数据集的真实图像</p></figure><p id="56cc" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">首先，获取所有需要的库，</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="f45f" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">由于我们在 Kaggle 上运行这个笔记本，我们可以使用边栏中的“+添加数据”选项，搜索<a class="ae mt" href="https://www.kaggle.com/spandan2/cats-faces-64x64-for-generative-models" rel="noopener ugc nofollow" target="_blank">猫脸数据集</a>。这将把数据下载到../输入。</p><p id="79e3" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">将数据集的路径保存在 DATA_DIR 中。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="7ca4" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">该数据集有一个名为 cats 的文件夹，其中包含超过 15，700 张 JPG 格式的图像。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="be36" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">现在使用 torchvision 中的 ImageFolder 类加载这个数据集。我们还将调整图像的大小并将其裁剪为 64x64 px，并使用 0.5 的平均值和标准偏差对像素值进行标准化。这将确保像素值在范围(-1，1)内，这对于鉴别器训练更方便。此外，我们将创建一个数据加载器，用于将数据加载到批处理中。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="mv mw l"/></div></figure><h1 id="2b46" class="ko kp iq bd kq kr ks kt ku kv kw kx ky kf kz kg la ki lb kj lc kl ld km le lf bi translated">生成对抗网络</h1><p id="c446" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">现在让我们建立鉴别器和生成器神经网络，生成器将生成图像，鉴别器将检测给定图像是真是假。他们都将相互竞争，并且都将在工作中做得更好。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/f28f3635c03777150ba266150f68a97e.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*Y9Y5iO-u9zfisjvzUJo3ZA.png"/></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">照片由<a class="ae mt" href="https://machinelearningmastery.com/what-are-generative-adversarial-networks-gans/" rel="noopener ugc nofollow" target="_blank"> machinelearningmastery </a>拍摄</p></figure><h1 id="5414" class="ko kp iq bd kq kr ks kt ku kv kw kx ky kf kz kg la ki lb kj lc kl ld km le lf bi translated">发电机</h1><p id="a5f8" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">生成器的输入是一个向量或随机数矩阵，用作图像生成的种子。该生成器可以将形状张量(128，1，1)转换成(3×28×28)形状张量图像。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="mv mw l"/></div></figure><h1 id="4606" class="ko kp iq bd kq kr ks kt ku kv kw kx ky kf kz kg la ki lb kj lc kl ld km le lf bi translated">鉴别器</h1><p id="fc57" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">鉴别器将图像作为其输入，并试图将其分类为“真实的”或“生成的”。这会将输入作为(3 x 64 x 64)张量，并将其转换为(1，1，1)张量。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="fc98" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">下面是保存每个时期后生成的每个图像的功能。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="mv mw l"/></div></figure><h1 id="acd5" class="ko kp iq bd kq kr ks kt ku kv kw kx ky kf kz kg la ki lb kj lc kl ld km le lf bi translated">培养</h1><p id="3d58" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">下一步是为鉴别器和生成器构建一个训练函数。该函数将用于训练两个神经网络。</p><p id="27d1" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">这是鉴别器的训练功能。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="1e0a" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">这是发电机的训练功能。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="7e90" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">现在我们将构建一个训练函数来训练鉴别器和生成器。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="179d" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">现在我们准备训练模型，我们取 lr = 0.0002，纪元数= 60。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="mv mw l"/></div></figure><h1 id="f63d" class="ko kp iq bd kq kr ks kt ku kv kw kx ky kf kz kg la ki lb kj lc kl ld km le lf bi translated">结果</h1><p id="255d" class="pw-post-body-paragraph lg lh iq li b lj lk ka ll lm ln kd lo lp lq lr ls lt lu lv lw lx ly lz ma mb ij bi translated">在训练模型 60 个时期后，我们可以看到生成的图像。</p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="mv mw l"/></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/484862f9d238db15f36f70fb7ed78ff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*OZIW4L-cr_Y9yGRhK4-OJw.png"/></div><p class="mk ml gj gh gi mm mn bd b be z dk translated">生成的图像</p></figure><p id="30d9" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">正如我们所见，从模型中生成的图像与真实图像相似。</p><p id="cf65" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">你可以在我的 Jovian 个人资料中找到完整的代码:</p><p id="805b" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated"><a class="ae mt" href="https://jovian.ml/shubham7169007/cat-dcgan" rel="noopener ugc nofollow" target="_blank">https://jovian.ml/shubham7169007/cat-dcgan</a></p><p id="c090" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated">Github 链接:</p><p id="e62a" class="pw-post-body-paragraph lg lh iq li b lj mo ka ll lm mp kd lo lp mq lr ls lt mr lv lw lx ms lz ma mb ij bi translated"><a class="ae mt" href="https://github.com/shubham7169/Projects/blob/master/CAT-dcgan.ipynb" rel="noopener ugc nofollow" target="_blank">https://github . com/Shu bham 7169/Projects/blob/master/CAT-dcgan . ipynb</a></p></div></div>    
</body>
</html>