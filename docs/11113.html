<html>
<head>
<title>Which is the best NLP library?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">哪个是最好的 NLP 库？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/which-is-the-best-nlp-d7965c71ec5f?source=collection_archive---------27-----------------------#2020-08-02">https://towardsdatascience.com/which-is-the-best-nlp-d7965c71ec5f?source=collection_archive---------27-----------------------#2020-08-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="68c7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通用 NLP 库的实时评估(带代码片段)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/499f821bd10e85a8a6e8fa3f7da55df2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VuaT7NuiSRjRRlBg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">艾拉·迪恩在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="2dc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated">自从我开始从事 NLP(自然语言处理)工作以来，我一直想知道哪一个是最好的 NLP 库，可以满足我们大多数常见的 NLP 需求。虽然确实不存在一刀切的做法，库的选择将取决于手头的任务，但我仍然很好奇，如果不同的库针对一个非常简单的任务进行基准测试，它们会如何进行比较。</p><p id="90e3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">考虑到这一点，我戴上开发人员的帽子，开始使用各种库编写 python 代码，并针对一个非常常见的任务对它们进行评估。为了简单起见，我决定使用 Twitter 文本分类问题进行评估。今天最常见的 NLP 库是 NLTK、Spacy、WordBlob、Gensim，当然还有使用 LSTM(长短期记忆)或 GRU(门控循环单元)细胞的深度神经网络架构。</p><h1 id="7548" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">问题陈述</h1><p id="9abb" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">我使用的数据集由一组 Twitter 消息组成。一些推文被贴上了种族主义的标签，而另一些则没有。这是一个经典的基于监督学习的二分类问题。我们的工作是基于不同的库创建模型，并使用它们将以前未见过的文本分类为种族主义或非种族主义。</p><p id="f760" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是一些可用的推文:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nb"><img src="../Images/44fdd683c8c159ff5a688bdf48e86d20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z5bj7GlzViYjREZziko7Yg.png"/></div></div></figure><p id="b00c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">标签 1 表示该推文是种族主义的，标签 0 表示不是。</p><p id="508c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了简洁起见，我将只关注代码的关键部分。完整代码，请随意访问我的 GitHub <a class="ae ky" href="https://github.com/rahulbtchrya/MachineLearning" rel="noopener ugc nofollow" target="_blank">机器学习</a>库。因为我已经清理了数据集并执行了 EDA(探索性数据分析),所以我也不会在这里讨论这些细节。</p><p id="2fa4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里我将重点介绍五个不同的库— <em class="nc"> NLTK </em>、<em class="nc"> WordBlob </em>、CNN 的<em class="nc"> Spacy、<em class="nc">document vectors</em>的<em class="nc"> Spacy，以及最后一个具有<em class="nc">双向 LSTM </em>单元的深度神经网络模型。</em></em></p><p id="c9a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将使用<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html" rel="noopener ugc nofollow" target="_blank"> ROC-AUC </a>得分和<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html" rel="noopener ugc nofollow" target="_blank">F1-得分</a>作为我的评估指标。</p><p id="d3da" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以让我们开始吧。</p><h1 id="a8a7" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated"><strong class="ak"> NLTK </strong></h1><p id="7df1" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">让我们从<a class="ae ky" href="https://www.nltk.org/" rel="noopener ugc nofollow" target="_blank"> NLTK </a>包开始。在这里，我们使用 NLTK 库对 tweets 进行标记化和词条化，使用<a class="ae ky" href="https://pypi.org/project/gensim/" rel="noopener ugc nofollow" target="_blank"> Gensim 的</a> <em class="nc"> Word2Vec </em>模型创建单词向量。最后使用<em class="nc"> XGBoost 分类器</em>模型进行训练和推理。下面是包含代码相关部分的代码片段</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><blockquote class="nf ng nh"><p id="3cea" class="kz la nc lb b lc ld ju le lf lg jx lh ni lj lk ll nj ln lo lp nk lr ls lt lu im bi translated">使用这种技术，我能够获得 ROC-AUC 分数为<strong class="lb iu"> 0.8 </strong>和 F1 分数为<strong class="lb iu"> 0.68 </strong></p></blockquote><h1 id="c4e1" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">文本 Blob</h1><p id="1c46" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">TextBlob 是一个初学者友好的 NLP 库，提供了很多很酷的特性。它还提供了内置的文本分类器。然而，我发现 TextBlob 比我用过的其他库要慢很多。</p><p id="c211" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">出于我们的目的，我们将使用 TextBlob 的内置<em class="nc"> DecisionTreeClassifier </em>。下面是代码片段:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><blockquote class="nf ng nh"><p id="f4c6" class="kz la nc lb b lc ld ju le lf lg jx lh ni lj lk ll nj ln lo lp nk lr ls lt lu im bi translated">使用这种技术，我能够得到 ROC-AUC 分数为<strong class="lb iu"> 0.68 </strong>和 F1 分数为<strong class="lb iu"> 0.46 </strong></p></blockquote><h1 id="2181" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">CNN 的空间</h1><p id="4e14" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">Spacy 是 NLP 最受欢迎和使用最广泛的库之一，提供了非常强大的特性。它提供了一个名为<em class="nc"> textcat </em>的内置文本分类器，可以作为默认的管道组件使用。<em class="nc"> textcat </em>组件支持<em class="nc"> BOW </em>(文字袋)、S <em class="nc"> imple-CNN </em>(卷积神经网络)和<em class="nc"> Ensemble </em>架构。</p><p id="4916" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我们的例子中，我们将使用<em class="nc">简单 cnn </em>架构。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><blockquote class="nf ng nh"><p id="66ae" class="kz la nc lb b lc ld ju le lf lg jx lh ni lj lk ll nj ln lo lp nk lr ls lt lu im bi translated">在这种情况下，我的 ROC-AUC 得分为<strong class="lb iu"> 0.78 </strong>，F1 得分为<strong class="lb iu"> 0.66 </strong></p></blockquote><h1 id="3298" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">文档向量空间</h1><p id="40aa" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">在这个例子中，我们将继续使用 Spacy，但不是使用它的内置文本分类器，而是使用 Spacy 来生成<em class="nc">文档向量</em>，然后将这些向量提供给 XGBoost 分类器。让我们看看这是否能提高我们的分数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><blockquote class="nf ng nh"><p id="6bf5" class="kz la nc lb b lc ld ju le lf lg jx lh ni lj lk ll nj ln lo lp nk lr ls lt lu im bi translated">这里我们得到的 ROC-AUC 分数为<strong class="lb iu"> 0.8 </strong>和 F1-分数为<strong class="lb iu"> 0.64 </strong></p></blockquote><h1 id="ab7a" class="me mf it bd mg mh mi mj mk ml mm mn mo jz mp ka mq kc mr kd ms kf mt kg mu mv bi translated">具有 LSTM 细胞的深度神经网络</h1><p id="2e76" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">最后，我们将使用双向 LSTM 细胞创建一个神经网络模型。我们将使用 TensorFlow 的<a class="ae ky" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>库，并使用它的特性，如标记化和序列填充</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nd ne l"/></div></figure><blockquote class="nf ng nh"><p id="e12c" class="kz la nc lb b lc ld ju le lf lg jx lh ni lj lk ll nj ln lo lp nk lr ls lt lu im bi translated">这里我们得到 ROC-AUC 分数为<strong class="lb iu"> 0.82 </strong>和 F1 分数为<strong class="lb iu"> 0.41 </strong></p></blockquote></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><h1 id="2166" class="me mf it bd mg mh ns mj mk ml nt mn mo jz nu ka mq kc nv kd ms kf nw kg mu mv bi translated">结论</h1><p id="7527" class="pw-post-body-paragraph kz la it lb b lc mw ju le lf mx jx lh li my lk ll lm mz lo lp lq na ls lt lu im bi translated">现在让我们来比较一下分数</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/968420f3ad6c91d547101c69103276f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*zvNoZwmIXL9IiRebZyOJ5A.png"/></div></figure><p id="a6b0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">模型的 ROC_AUC 得分非常相似。看看 F1 的分数，似乎 NLTK 和 Spacy 最适合这份工作。然而，使用各种优化技术和超参数调整，尤其是基于 LSTM 的模型，绝对有可能进一步改进模型。</p><p id="73f6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以上所有例子的完整代码都可以在我的 GitHub <a class="ae ky" href="https://github.com/rahulbtchrya/MachineLearning" rel="noopener ugc nofollow" target="_blank">机器学习</a>库中找到。</p><p id="c8f4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">经过预先训练的模特最近引起了很大的轰动。随着最近 OpenAI 的 GPT3 的发布，兴奋程度达到了历史最高水平。我很好奇<strong class="lb iu">他们</strong>会如何执行我们简单的文本分类任务。</p><p id="de6d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是我接下来要尝试的。请继续关注这个空间，了解更多信息。</p></div></div>    
</body>
</html>