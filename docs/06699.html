<html>
<head>
<title>Object Detection with Python &amp; YOLO</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python和YOLO进行对象检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-detect-objects-with-your-webcam-82693c47bd8?source=collection_archive---------16-----------------------#2020-05-26">https://towardsdatascience.com/how-to-detect-objects-with-your-webcam-82693c47bd8?source=collection_archive---------16-----------------------#2020-05-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/bf7a59d41b19f964ce71b34753c515bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LgqxDMP5qD1HE_uM33zZrg.png"/></div></div></figure><div class=""/><div class=""><h2 id="3355" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">使用网络摄像头的计算机视觉</h2></div><h2 id="f939" class="kt ku je bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">摘要</h2><p id="920a" class="pw-post-body-paragraph lp lq je lr b ls lt kf lu lv lw ki lx lc ly lz ma lg mb mc md lk me mf mg mh im bi translated">在本文中，我将展示如何使用计算机视觉，并通过几行代码获得许多乐趣。</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mi"><img src="../Images/b784256282e776ea965a0cdbb01765e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*DqOIcsxA295uw2ZqyzeCbQ.gif"/></div></div></figure><p id="6e13" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated"><strong class="lr jf">计算机视觉</strong>是人工智能领域，研究计算机如何从数字图像或视频中获得高层次的理解，以产生数字或符号信息。</p><p id="a945" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">计算机视觉的主要任务是图像分类和目标检测。第一种识别图像是关于什么的，并用标签对其进行分类。最好的例子是对狗和猫的照片进行分类。但是如果任务是数一张照片里有多少只狗和猫呢？这将是一个目标检测问题。<strong class="lr jf">对象检测</strong>处理在数字图像和视频中检测某类语义对象的实例。</p><p id="3aee" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated"><a class="ae ms" href="https://pjreddie.com/darknet/yolo/" rel="noopener ugc nofollow" target="_blank"><strong class="lr jf"/></a><strong class="lr jf"/>(你只看一次)是最快的，因此也是使用最多的实时物体检测系统。基本上，它将单个神经网络应用于整个图像，将其划分为多个区域，然后网络预测每个区域的边界框和概率。在这篇文章中，我将使用一个预训练的YOLO模型来进行对象检测，因此，如果你想了解更多关于神经网络结构以及如何训练它，我建议阅读<a class="ae ms" href="https://arxiv.org/abs/1506.02640" rel="noopener ugc nofollow" target="_blank">原始论文</a>。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h2 id="cb56" class="kt ku je bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">设置</h2><p id="765f" class="pw-post-body-paragraph lp lq je lr b ls lt kf lu lv lw ki lx lc ly lz ma lg mb mc md lk me mf mg mh im bi translated">有几种方法可以将预训练的模型用于计算机视觉，最流行的框架是Tensorflow和Keras。不过我觉得<a class="ae ms" href="https://imageai.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="lr jf"> ImageAI </strong> </a>对于我这种懒程序员来说是最方便的工具。这个包促进了深度学习和计算机视觉的使用，因为它提供了非常强大和简单的功能来执行对象检测和图像分类。</p><p id="347f" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">首先，我会<strong class="lr jf">从<a class="ae ms" href="https://github.com/OlafenwaMoses/ImageAI/releases/tag/1.0/" rel="noopener ugc nofollow" target="_blank">这里</a>下载预先训练好的YOLO </strong>的重量(文件“yolo.h5”)，并将该文件存储在我电脑的某个文件夹中。</p><pre class="mj mk ml mm gt na nb nc nd aw ne bi"><span id="5769" class="kt ku je nb b gy nf ng l nh ni">modelpath = "mycomputer/myfolder/yolo.h5"</span></pre><p id="9c8c" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">然后，我可以使用ImageAI非常容易地加载模型:</p><pre class="mj mk ml mm gt na nb nc nd aw ne bi"><span id="91a6" class="kt ku je nb b gy nf ng l nh ni">from <strong class="nb jf">imageai </strong>import Detection</span><span id="fd1c" class="kt ku je nb b gy nj ng l nh ni">yolo = Detection.<strong class="nb jf">ObjectDetection</strong>()<br/>yolo.setModelTypeAsYOLOv3()<br/>yolo.setModelPath(modelpath)<br/>yolo.loadModel()</span></pre><p id="a6d3" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">现在模型已经可以进行预测了，我们只需要数据。我将使用来自我的网络摄像头的实时视频流来为模型提供真实世界的图像。</p><p id="7c20" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">你可以用<a class="ae ms" href="https://docs.opencv.org/master/index.html" rel="noopener ugc nofollow" target="_blank"> OpenCV </a>包<strong class="lr jf">访问你的设备摄像头</strong>，它提供了一个视频捕捉对象，处理与打开和关闭网络摄像头相关的一切。</p><pre class="mj mk ml mm gt na nb nc nd aw ne bi"><span id="2138" class="kt ku je nb b gy nf ng l nh ni">import <strong class="nb jf">cv2</strong></span><span id="769c" class="kt ku je nb b gy nj ng l nh ni">cam = cv2.<strong class="nb jf">VideoCapture</strong>(0) #0=front-cam, 1=back-cam<br/>cam.set(cv2.CAP_PROP_FRAME_WIDTH, 1300)<br/>cam.set(cv2.CAP_PROP_FRAME_HEIGHT, 1500)</span></pre><h2 id="fa67" class="kt ku je bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">预测</h2><p id="c2d4" class="pw-post-body-paragraph lp lq je lr b ls lt kf lu lv lw ki lx lc ly lz ma lg mb mc md lk me mf mg mh im bi translated">现在我们可以开始和YOLO一起玩了。该模型将用于逐帧预测摄像机捕捉到的图像，直到循环被中断。</p><pre class="mj mk ml mm gt na nb nc nd aw ne bi"><span id="fe82" class="kt ku je nb b gy nf ng l nh ni">while True:</span><span id="bdf0" class="kt ku je nb b gy nj ng l nh ni">    <strong class="nb jf">## read frames</strong><br/>    ret, img = cam.read()</span><span id="8893" class="kt ku je nb b gy nj ng l nh ni">    <strong class="nb jf">## predict yolo</strong><br/>    img, preds = yolo.<strong class="nb jf">detectCustomObjectsFromImage</strong>(input_image=img, <br/>                      custom_objects=None, input_type="array",<br/>                      output_type="array",<br/>                      minimum_percentage_probability=70,<br/>                      display_percentage_probability=False,<br/>                      display_object_name=True)</span><span id="47c9" class="kt ku je nb b gy nj ng l nh ni">    <strong class="nb jf">## display predictions</strong><br/>    cv2.imshow("", img)</span><span id="7479" class="kt ku je nb b gy nj ng l nh ni"><strong class="nb jf">    ## press q or Esc to quit </strong>   <br/>    if (cv2.waitKey(1) &amp; 0xFF == ord("q")) or (<!-- -->cv2.waitKey(1)==27<!-- -->):<br/>        break</span><span id="6217" class="kt ku je nb b gy nj ng l nh ni"><strong class="nb jf">## close camera</strong><br/>cam.release()<br/>cv2.destroyAllWindows()</span></pre><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nk"><img src="../Images/55c7fc3b1000022364e983bb6470901e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qPJ0nJFmuYMnlJKYGNbZ8w.png"/></div></div></figure><p id="8d25" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">好玩吧。这个模型也做得很好，尽管它把一个橙子识别为一个“运动球”。</p><figure class="mj mk ml mm gt iv gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/d037bf363b0c3552c64413f04c39eb6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*hUmEnO0r26hXRaJtD8b6zQ.png"/></div></figure><p id="cc36" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">我使用的最小百分比概率为0.70，这意味着只有当模型至少有70%的把握时，我们才能检测到物体。降低该值会显示更多的对象，而增加该值可确保检测到精度最高的对象。</p><div class="mj mk ml mm gt ab cb"><figure class="nm iv nn no np nq nr paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><img src="../Images/b84c608f34f9451af25d774c5c106484.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*tDPmzQcptf8dCTaxCEMS7A.png"/></div></figure><figure class="nm iv ns no np nq nr paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><img src="../Images/03ae519c269241790aa2a823a810c657.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*bJTMoXM_mRooCGYKFaFvJw.png"/></div></figure></div><p id="8b08" class="pw-post-body-paragraph lp lq je lr b ls mn kf lu lv mo ki lx lc mp lz ma lg mq mc md lk mr mf mg mh im bi translated">我希望你喜欢它！如有问题和反馈，或者只是分享您感兴趣的项目，请随时联系我。</p><blockquote class="nt"><p id="3199" class="nu nv je bd nw nx ny nz oa ob oc mh dk translated">👉<a class="ae ms" href="https://linktr.ee/maurodp" rel="noopener ugc nofollow" target="_blank">我们来连线</a>👈</p></blockquote></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><blockquote class="od oe of"><p id="f460" class="lp lq og lr b ls mn kf lu lv mo ki lx oh mp lz ma oi mq mc md oj mr mf mg mh im bi translated">本文是Python 系列<strong class="lr jf"> CV的一部分，参见:</strong></p></blockquote><div class="is it gp gr iu ok"><a href="https://pub.towardsai.net/image-classification-with-python-cnn-vs-transformers-fe509cbbc2d0" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd jf gy z fp op fr fs oq fu fw jd bi translated">用Python进行图像分类:CNN与变形金刚</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">计算机视觉&amp;用卷积神经网络、迁移学习、ViT、TensorFlow和HuggingFace进行解释</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">pub.towardsai.net</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy ja ok"/></div></div></a></div><div class="is it gp gr iu ok"><a rel="noopener follow" target="_blank" href="/document-parsing-with-python-ocr-75543448e581"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd jf gy z fp op fr fs oq fu fw jd bi translated">使用Python和OCR进行文档解析</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">使用计算机视觉从任何类型的文档中检测和提取文本、图形、表格</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">towardsdatascience.com</p></div></div><div class="ot l"><div class="oz l ov ow ox ot oy ja ok"/></div></div></a></div></div></div>    
</body>
</html>