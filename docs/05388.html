<html>
<head>
<title>Optimising deep learning neural networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä¼˜åŒ–æ·±åº¦å­¦ä¹ ç¥ç»ç½‘ç»œ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/data-science-by-hazy-4c2f2352f3a0?source=collection_archive---------43-----------------------#2020-05-06">https://towardsdatascience.com/data-science-by-hazy-4c2f2352f3a0?source=collection_archive---------43-----------------------#2020-05-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="2577" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">Hazyçš„æ•°æ®ç§‘å­¦</h2><div class=""/><div class=""><h2 id="6c5b" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">æ·±åº¦å­¦ä¹ ç¥ç»ç½‘ç»œæœ‰ä¸€ç³»åˆ—ä»¤äººçœ¼èŠ±ç¼­ä¹±çš„å…ƒå‚æ•°ã€‚äº†è§£å¦‚ä½•å°†GANsåº”ç”¨äºç¥ç»ç½‘ç»œä¼˜åŒ–ã€‚</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/1cb4937b9bbdbb0c29921691bbbb4a11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I8OS_QHYY4N8IS8KPKtlXQ.jpeg"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">æ¥æº:<a class="ae lh" href="https://www.flickr.com/photos/wocintechchat/" rel="noopener ugc nofollow" target="_blank"> WOCinTech </a>ï¼ŒçŸ¥è¯†å…±äº«</p></figure><p id="bdb0" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">é“æ ¼æ‹‰æ–¯Â·äºšå½“æ–¯åœ¨ã€Šé“¶æ²³ç³»æ¼«æ¸¸æŒ‡å—ã€‹ä¸­æ›¾æ–­è¨€:â€œç©ºé—´å¾ˆå¤§ã€‚ä½ ä¸ä¼šç›¸ä¿¡å®ƒæœ‰å¤šä¹ˆå·¨å¤§ï¼Œä»¤äººéš¾ä»¥ç½®ä¿¡çš„å¤§ã€‚æˆ‘çš„æ„æ€æ˜¯ï¼Œä½ å¯èƒ½è®¤ä¸ºå»è¯åº—çš„è·¯å¾ˆé•¿ï¼Œä½†é‚£å¯¹å¤ªç©ºæ¥è¯´åªæ˜¯å¾®ä¸è¶³é“ã€‚â€</p><p id="2e73" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ç¥ç»ç½‘ç»œä¹Ÿå¾ˆå¤§ã€‚T2å¾®è½¯å›¾çµè‡ªç„¶è¯­è¨€ç”Ÿæˆæˆ–T-NLGç½‘ç»œæœ‰å¤§çº¦190äº¿ä¸ªå‚æ•°ã€‚ä»¥å¤§å¤šæ•°äººçš„æ ‡å‡†æ¥çœ‹ï¼Œè¿™å·²ç»å¾ˆå¤§äº†ã€‚</p><p id="d7ea" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ç„¶è€Œï¼Œæˆ‘ä»¬å…³å¿ƒçš„ä¸ä»…ä»…æ˜¯å‚æ•°çš„æ•°é‡ï¼Œè¿˜æœ‰å…ƒå‚æ•°ã€‚ç ”ç©¶ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ(GAN)çš„æ•°æ®ç§‘å­¦å®¶é€šå¸¸å¿…é¡»è¿è¡Œæ•°ç™¾ä¸‡æ¬¡å®éªŒï¼Œä»¥ä¼˜åŒ–ä»–ä»¬çš„ç¥ç»ç½‘ç»œã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è§£é‡Šäº†åœ¨Hazyï¼Œæˆ‘ä»¬å¦‚ä½•å°†è‡ªåŠ¨å…ƒå‚æ•°ä¼˜åŒ–æ³¨å…¥åˆ°æˆ‘ä»¬çš„GANsä¸­ï¼Œç„¶åè®©æ‚¨åœ¨è¾ƒå°‘æŒ«æŠ˜çš„æƒ…å†µä¸‹è®­ç»ƒæ›´å¥½çš„æ¨¡å‹ã€‚</p><h2 id="83b2" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">è°ƒæ•´å…ƒå‚æ•°:æˆä¸ºæœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆçš„å°è¯•</h2><p id="95c6" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">æ·±åº¦å­¦ä¹ ç¥ç»ç½‘ç»œæœ‰ä¸€ç³»åˆ—ä»¤äººçœ¼èŠ±ç¼­ä¹±çš„å…ƒå‚æ•°ã€‚</p><p id="107f" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">å…ƒå‚æ•°æ˜¯æä¾›ç»™ç½‘ç»œçš„å‚æ•°ï¼Œç”¨äºæŒ‡å¯¼ç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹ï¼Œæ§åˆ¶ç½‘ç»œå¦‚ä½•ä¿®æ”¹å‚æ•°ã€‚</p><p id="a1ef" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">å…ƒå‚æ•°åŒ…æ‹¬å­¦ä¹ é€Ÿç‡ã€åŠ¨é‡ã€éšè—å±‚çš„æ•°é‡ã€æ¯å±‚ç¥ç»å…ƒçš„æ•°é‡ä»¥åŠè¦ä½¿ç”¨çš„ä¼˜åŒ–å™¨çš„ç±»å‹ã€‚</p><p id="746d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆå·¥ä½œçš„ä¸€ä¸ªæ ‡å‡†éƒ¨åˆ†æ˜¯è°ƒæ•´ç½‘ç»œï¼Œä¹Ÿå°±æ˜¯é€‰æ‹©äº§ç”Ÿæœ€ä½³æ€§èƒ½çš„å…ƒå‚æ•°ã€‚è¿™å¯èƒ½æ˜¯ä¸€ä¸ªè€—æ—¶çš„è¿‡ç¨‹ï¼Œå› ä¸ºç½‘ç»œè¶Šå¤§ï¼Œæ”¶æ•›çš„æ—¶é—´å°±è¶Šé•¿ï¼Œå¹¶ä¸”é€šå¸¸éœ€è¦è°ƒæ•´å’Œè°ƒæ•´çš„å…ƒå‚æ•°å°±è¶Šå¤šã€‚</p><p id="0f1c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">è°ƒæ•´ç½‘ç»œå¾ˆåƒä¸€ä¸ªç§‘å­¦å®¶ï¼Œä»–æœ‰ä¸€å°å¤æ‚çš„è®¾å¤‡ï¼Œæœ‰è®¸å¤šæ—‹é’®è¦æ—‹è½¬ï¼Œè¦è¿›è¡Œå¤§é‡çš„å®éªŒï¼Œçœ‹å“ªä¸€ä¸ªèƒ½ç»™ä½ æœ€å¥½çš„ç»“æœã€‚</p><p id="03ef" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€äº›è½¯ä»¶åŒ…å¯ä»¥è®©è¿™é¡¹ä»»åŠ¡å˜å¾—æ›´å®¹æ˜“ã€‚</p><h2 id="93ad" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">åº”ç”¨äºGANsçš„Optunaä¼˜åŒ–</h2><p id="279d" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">åœ¨åˆæˆæ•°æ®ç”Ÿæˆå…¬å¸<a class="ae lh" href="https://www.hazy.com" rel="noopener ugc nofollow" target="_blank"> Hazy </a>ï¼Œæˆ‘ä»¬æ˜¯<a class="ae lh" href="https://optuna.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> Optuna PythonåŒ…</a>çš„å¿ å®ç²‰ä¸ã€‚</p><p id="dfa3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Optunaæ˜¯ä¸€ä¸ªè‡ªåŠ¨å…ƒå‚æ•°ä¼˜åŒ–è½¯ä»¶æ¡†æ¶ï¼Œä¸“é—¨ä¸ºæœºå™¨å­¦ä¹ è€Œè®¾è®¡ã€‚è¯¥ä»£ç æ˜¯é«˜åº¦æ¨¡å—åŒ–å’Œå¼ºåˆ¶æ€§çš„ã€‚å®ƒæ”¯æŒå¹¶è¡Œï¼Œåˆ†å¸ƒå¼ä¼˜åŒ–ï¼ŒåŠ¨æ€ä¿®å‰ªè¯•éªŒã€‚å®ƒä¸æœºå™¨å­¦ä¹ æ¡†æ¶æ— å…³ï¼Œå¹¶ä¸”é«˜åº¦å¯å®šåˆ¶ã€‚</p><p id="0571" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªGANï¼Œæˆ‘ä»¬å¸Œæœ›ä¼˜åŒ–å®ƒçš„ç”Ÿæˆå™¨å’Œé‰´åˆ«å™¨çš„å­¦ä¹ é€Ÿç‡ã€‚æˆ‘ä»¬è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p><h2 id="1762" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">æˆä¸ºç¥ç»ç½‘ç»œçš„è€ƒéªŒ</h2><p id="8143" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">Optunaæœ‰ä¸¤ä¸ªåŸºæœ¬æ¦‚å¿µ:ç ”ç©¶å’Œè¯•éªŒã€‚</p><p id="a7ce" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">è¯¥ç ”ç©¶æ˜¯ä¼˜åŒ–çš„æ€»ä½“ä»»åŠ¡ï¼ŒåŸºäºè¿”å›ä¼˜åŒ–ç»“æœçš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°é€šå¸¸è¢«ç§°ä¸ºç›®æ ‡å‡½æ•°ã€‚è¯•éªŒæ˜¯ç›®æ ‡å‡½æ•°çš„ä¸€æ¬¡æ‰§è¡Œã€‚</p><p id="14bf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œè¿™ä¸ªä¾‹å­å–è‡ªOptunaç½‘ç«™ï¼Œå¹¶åº”ç”¨äºHazyçš„GANæ¨¡å‹ï¼Œè®©æ‚¨äº†è§£ä»€ä¹ˆæ˜¯å¯èƒ½çš„ã€‚</p><p id="eeeb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç›®æ ‡å‡½æ•°æ¥ç ”ç©¶ã€‚</p><p id="dc6a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ç›®æ ‡å‡½æ•°å°è£…äº†æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ï¼Œå¹¶è¿”å›å…ƒå‚æ•°çš„è¿™ä¸ªç‰¹å®šå®ä¾‹çš„å€¼ã€‚</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="1aef" class="me mf it nc b gy ng nh l ni nj">def objective(trial):<br/>    iris = sklearn.datasets.load_iris()<br/>    <br/>    n_estimators = trial.suggest_int('n_estimators', 2, 20)<br/>    max_depth = int(trial.suggest_loguniform('max_depth', 1, 32))<br/>    <br/>    clf = sklearn.ensemble.RandomForestClassifier(<br/>        n_estimators=n_estimators, max_depth=max_depth)<br/>    <br/>    return sklearn.model_selection.cross_val_score(<br/>        clf, iris.data, iris.target, n_jobs=-1, cv=3).mean()</span></pre><p id="cca3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">è¯¥å‡½æ•°åŠ è½½äº†<a class="ae lh" href="https://scikit-learn.org/stable/auto_examples/datasets/plot_iris_dataset.html" rel="noopener ugc nofollow" target="_blank">è™¹è†œæ•°æ®é›†</a> â€”ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„ç”¨äºè¯„ä¼°æœºå™¨å­¦ä¹ åˆ†ç±»å™¨çš„æ•°æ®é›†ã€‚ç„¶åï¼Œå®ƒä»è¯•éªŒå¯¹è±¡è·å¾—å»ºè®®çš„ä¼°è®¡æ•°å’Œæœ€å¤§æ·±åº¦ã€‚ç„¶åå®ƒå®ä¾‹åŒ–ä¸€ä¸ª<a class="ae lh" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html" rel="noopener ugc nofollow" target="_blank">éšæœºæ£®æ—åˆ†ç±»å™¨</a>å¹¶è¿”å›åˆ†æ•°ã€‚</p><p id="567a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°è®¨è®ºä¸€ä¸‹ã€‚</p><p id="03b1" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æ•°æ®é›†ç”±ä¸‰ç§ä¸åŒç§ç±»çš„è™¹è†œç»„æˆï¼Œæœºå™¨å­¦ä¹ <strong class="lk jd">ä»»åŠ¡</strong>æ˜¯åœ¨ç»™å®šå››ä¸ªæµ‹é‡å€¼çš„æƒ…å†µä¸‹ï¼Œå°†ç»™å®šçš„æ•°æ®ç‚¹æ­£ç¡®åœ°åˆ†é…ç»™æ­£ç¡®çš„è™¹è†œç§ç±»:</p><ul class=""><li id="bc7b" class="nk nl it lk b ll lm lo lp lr nm lv nn lz no md np nq nr ns bi translated">è¼ç‰‡é•¿åº¦</li><li id="3532" class="nk nl it lk b ll nt lo nu lr nv lv nw lz nx md np nq nr ns bi translated">è¼ç‰‡å®½åº¦</li><li id="80fc" class="nk nl it lk b ll nt lo nu lr nv lv nw lz nx md np nq nr ns bi translated">èŠ±ç“£é•¿åº¦</li><li id="4c4a" class="nk nl it lk b ll nt lo nu lr nv lv nw lz nx md np nq nr ns bi translated">èŠ±ç“£å®½åº¦</li></ul><p id="f367" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Irisæ•°æ®é›†è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªç›¸å½“å›°éš¾çš„åˆ†ç±»é—®é¢˜ï¼Œå› ä¸ºå°±è¿™äº›æµ‹é‡è€Œè¨€ï¼Œç‰©ç§ä¹‹é—´æœ‰ç›¸å½“å¤šçš„é‡å ã€‚å¾ˆéš¾åœ¨ç‰©ç§ä¹‹é—´åˆ’å‡ºä¸€ä¸ªæ¸…æ™°çš„ç•Œé™ã€‚</p><p id="5ab7" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æˆ‘ä»¬å¸Œæœ›ä¼˜åŒ–çš„å…ƒå‚æ•°æ˜¯<strong class="lk jd">n _ estimates</strong>å’Œ<strong class="lk jd"> max_depth </strong>ã€‚</p><p id="2c73" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><a class="ae lh" href="https://optuna.readthedocs.io/en/latest/reference/trial.html" rel="noopener ugc nofollow" target="_blank">è¯•éªŒå¯¹è±¡</a>ä¸º<strong class="lk jd"> n_estimators </strong>å»ºè®®ä¸€ä¸ª2â‰¤ğ‘›â‰¤20èŒƒå›´å†…çš„æ•´æ•°:</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="d907" class="me mf it nc b gy ng nh l ni nj">n_estimators = trial.suggest_int('n_estimators', 2, 20)</span></pre><p id="1bca" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Optunaæœ‰è®¸å¤šä¸åŒçš„æœºåˆ¶æ¥æä¾›å…ƒå‚æ•°çš„å€¼ï¼Œä»¥ä¾¿åœ¨æ¯æ¬¡è¯•éªŒä¸­è¿›è¡Œæµ‹è¯•ï¼›ä½¿ç”¨å¯¹æ•°å‡åŒ€åˆ†å¸ƒåˆ†é…<strong class="lk jd">æœ€å¤§æ·±åº¦</strong>çš„å€¼:</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="49c5" class="me mf it nc b gy ng nh l ni nj">max_depth = int(<strong class="nc jd">trial</strong>.suggest_loguniform('max_depth', 1, 32))</span></pre><p id="e1f8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><a class="ae lh" href="https://optuna.readthedocs.io/en/latest/reference/trial.html#optuna.trial.Trial.suggest_loguniform" rel="noopener ugc nofollow" target="_blank"><strong class="lk jd">suggest _ log uniform</strong></a>å‡½æ•°æ¥å—ä¸€ä¸ªèŒƒå›´ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸º1â‰¤ ğ‘¥ â‰¤32ï¼Œå¹¶è¿”å›è¯¥èŒƒå›´å†…çš„æµ®ç‚¹å€¼ã€‚è¿™è¢«è½¬æ¢ä¸ºæ•´æ•°ã€‚</p><p id="73b8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ç„¶ååˆ›å»ºéšæœºæ£®æ—åˆ†ç±»å™¨ï¼Œå…·æœ‰å»ºè®®çš„<strong class="lk jd">æœ€å¤§æ·±åº¦</strong>å’Œ<strong class="lk jd"> nä¼°è®¡å™¨</strong>ã€‚å¯¹å®ƒè¿›è¡Œè¯„ä¼°ï¼Œå¹¶è¿”å›ä¸€ä¸ªåˆ†æ•°:</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="6829" class="me mf it nc b gy ng nh l ni nj">clf = sklearn.ensemble.RandomForestClassifier(<br/>        n_estimators=n_estimators, max_depth=max_depth)<br/>        <br/>return sklearn.model_selection.cross_val_score(<br/>        clf, iris.data, iris.target, n_jobs=-1, cv=3).mean()</span></pre><p id="478d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">åˆ›å»ºäº†ç›®æ ‡å‡½æ•°åï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªOptunaç ”ç©¶ï¼Œå¹¶åˆ›å»ºä¸€äº›è¯•éªŒã€‚ç„¶åï¼Œæˆ‘ä»¬è¾“å‡ºå…ƒå‚æ•°çš„æœ€ä½³å€¼:</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="a697" class="me mf it nc b gy ng nh l ni nj">import optuna<br/>import sklearn<br/>import sklearn.datasets<br/>import sklearn.ensemble<br/><br/>study = optuna.create_study(direction='maximize')<br/>study.optimize(objective, n_trials=100)<br/><br/>trial = study.best_trial<br/><br/>print('Accuracy: {}'.format(trial.value))<br/>print("Best hyperparameters: {}".format(trial.params))</span></pre><p id="9744" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">è¿™å°†è¾“å‡ºæ¯æ¬¡è¯•éªŒçš„åˆ†æ•°ï¼Œä»¥åŠæ‰€ä½¿ç”¨çš„å…ƒå‚æ•°ã€‚æœ€ç»ˆï¼Œåœ¨ç ”ç©¶å®Œæˆåï¼Œå®ƒè¾“å‡ºæœ€ä½³å…ƒå‚æ•°:</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="444e" class="me mf it nc b gy ng nh l ni nj">[I 2020-04-23 17:54:52,817] Finished trial#98 with value: 0.9738562091503268 with parameters: {'n_estimators': 17, 'max_depth': 3.303148836378194}. Best is trial#43 with value: 0.9738562091503268.<br/>[I 2020-04-23 17:54:52,899] Finished trial#99 with value: 0.960375816993464 with parameters: {'n_estimators': 17, 'max_depth': 3.136433926827928}. Best is trial#43 with value: 0.9738562091503268.<br/><br/>Accuracy: 0.9738562091503268<br/>Best hyperparameters: {'n_estimators': 12, 'max_depth': 4.419437654165229}</span></pre><h2 id="0ffb" class="me mf it bd mg mh mi dn mj mk ml dp mm lr mn mo mp lv mq mr ms lz mt mu mv iz bi translated">ä¼˜åŒ–GANs</h2><p id="8658" class="pw-post-body-paragraph li lj it lk b ll mw kd ln lo mx kg lq lr my lt lu lv mz lx ly lz na mb mc md im bi translated">æˆ‘ä»¬å¦‚ä½•åˆ©ç”¨è¿™ä¸€ç‚¹æ¥ä¼˜åŒ–ç”±ç”Ÿæˆæ€§å¯¹æŠ—ç½‘ç»œæ‰€ä»£è¡¨çš„é«˜åº¦å¤æ‚çš„ç³»ç»Ÿå‘¢ï¼Ÿ</p><p id="7fa8" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">è®©æˆ‘ä»¬ä¸ºé‚£äº›æƒ³è¦ä¼˜åŒ–çš„å…ƒå‚æ•°å®šä¹‰å‡ ä¸ªå‡½æ•°ã€‚</p><p id="aadf" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">GANç”±ä¸¤ä¸ªç¥ç»ç½‘ç»œç»„æˆï¼Œå³<em class="ny">å‘ç”Ÿå™¨</em>å’Œ<em class="ny">é‰´åˆ«å™¨</em>ã€‚ç”Ÿæˆå™¨çš„ä»»åŠ¡æ˜¯è¯•å›¾é€šè¿‡åˆ›å»ºå‡æ•°æ®æ¥æ¬ºéª—é‰´åˆ«å™¨ï¼›ç»™å®šçœŸå®å’Œè™šå‡æ•°æ®çš„è¾“å…¥ï¼Œé‰´åˆ«å™¨å¿…é¡»èƒ½å¤ŸåŒºåˆ†ä¸¤è€…ã€‚</p><p id="ba11" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">å‡è®¾æˆ‘ä»¬æƒ³è¦ä¼˜åŒ–ä¸¤ä¸ªç½‘ç»œçš„å­¦ä¹ é€Ÿç‡:</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="568f" class="me mf it nc b gy ng nh l ni nj">def opt_learning_rate(lr_key, trial):<br/>    """<br/>    lr_key: label to use for this learning rate<br/>    trial: optuna trial object<br/>    (one of those hyperparameters which may vary by orders of magnitude!)<br/>    Returns: a string containing which learning rate is being optimised, &amp; a suggested learning rate<br/>    """<br/>    return trial.suggest_loguniform(<br/>        lr_key,  1e-5, 1000<br/>    )</span></pre><p id="a906" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æˆ‘ä»¬ä½¿ç”¨äº†<strong class="lk jd">å»ºè®®_æ—¥å¿—ç»Ÿä¸€</strong>åŠŸèƒ½ï¼Œå¹¶èµ‹äºˆå…¶å¹¿æ³›çš„èŒƒå›´ã€‚</p><p id="b407" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨<a class="ae lh" href="http://archive.ics.uci.edu/ml/datasets/Adult" rel="noopener ugc nofollow" target="_blank">æˆäººæ•°æ®é›†</a>æ¥è®¾ç½®ä¼˜åŒ–ä¸¤ç§å­¦ä¹ ç‡çš„ä»£ç ã€‚</p><p id="913e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">è®©æˆ‘ä»¬ä»å»ºç«‹ä¸€ä¸ªPythonå­—å…¸å¼€å§‹ï¼Œè¯¥å­—å…¸å°†åŒ…å«ç”¨äºæ„å»ºç½‘ç»œçš„é»˜è®¤å…ƒå‚æ•°ã€‚</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="8d42" class="me mf it nc b gy ng nh l ni nj">default_network_dict = {<br/>    "epochs": 250,<br/>    "batch_size": 64,<br/>    "discriminator_learning_rate": 1e-5,<br/>    "generator_learning_rate": 5e-4,<br/>    "latent_dim": 100,<br/>    "input_output_dim": 20,<br/>    "num_bins": 100,<br/>    "layers": 3,<br/>    "hidden_dims": [64, 128, 256],<br/>    "num_critics": 4,<br/>    "dropout": 0.1,<br/>    "neuron_type": "LeakyReLU",<br/>    "optimiser": "RMSProp",<br/>    "output_folder": False,<br/>}</span></pre><p id="9af5" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æ³¨æ„ï¼Œæˆ‘ä»¬å·²ç»ä¸ºGANçš„å­¦ä¹ é€Ÿç‡æä¾›äº†é»˜è®¤å€¼ï¼›è¿™å…è®¸ç”¨æˆ·é€‰æ‹©ä»–ä»¬æƒ³è¦ä¼˜åŒ–çš„å…ƒå‚æ•°ã€‚æ‰€æœ‰è¿™äº›éƒ½æœ‰å¯èƒ½å¾—åˆ°ä¼˜åŒ–ï¼›ç„¶è€Œï¼Œå­—å…¸ä¹Ÿå¯ä»¥æŒ‰åŸæ ·ä½¿ç”¨ï¼Œä»¥åˆ›å»ºç¥ç»ç½‘ç»œã€‚</p><p id="0524" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ç”¨æˆ·ä¹Ÿå¯ä»¥ä»å‘½ä»¤è¡ŒæŒ‡å®šå…ƒå‚æ•°ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬é€šè¿‡ä»<strong class="lk jd"> argparse </strong>åˆ›å»ºä¸€ä¸ªå‘½ä»¤è¡Œè§£æå™¨åç§°ç©ºé—´æ¥é€‚åº”è¿™ç§æƒ…å†µã€‚</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="0d53" class="me mf it nc b gy ng nh l ni nj">import argparse<br/><br/>params = argparse.Namespace(<br/>    experiment_name = 'my-experiment',<br/>    location = 'metaparameter-optimisation',<br/>    dataset_name = 'adult',<br/>    #output_folder = 'output',<br/>    num_bins = 100,<br/>    epochs = 500,<br/>    batch_size = 64,<br/>    discriminator_rate = 1e-05,<br/>    generator_rate = 0.0005,<br/>    sigma = 0.1,<br/>    latent_dim = 200,<br/>    num_critics = 4,<br/>    cuda = 0,<br/>    optimise = ['generator_learning_rate', 'discriminator_learning_rate'],<br/>    hidden_dims = [64, 128, 256],<br/>    structure = False,<br/>)</span></pre><p id="296e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æˆ‘ä»¬éœ€è¦ä¸€ç§å°†æ¥è‡ªåç§°ç©ºé—´çš„å‘½ä»¤è¡Œå…ƒå‚æ•°ä¸é»˜è®¤ç½‘ç»œå­—å…¸ç›¸ç»“åˆçš„æ–¹æ³•:</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="f98e" class="me mf it nc b gy ng nh l ni nj">def override_params(default_params, optimisable, structure=False):<br/>    if structure:<br/>        default_params['layers'] = 'METAPARAM'<br/>        default_params['hidden_dims'] = 'METAPARAM'<br/>    tmp = dict.fromkeys(optimisable, 'METAPARAM')<br/>    return { **default_params, **tmp }</span></pre><p id="f7b9" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">æœ€åï¼Œæˆ‘ä»¬å®šä¹‰æˆ‘ä»¬çš„ç›®æ ‡å‡½æ•°ã€‚</p><p id="5b08" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ç›®æ ‡å‡½æ•°å¿…é¡»è¦†ç›–è®¸å¤šåŸºç¡€ï¼Œå› ä¸ºå®ƒå¿…é¡»åŒ…å«åˆ›å»ºã€è®­ç»ƒå’Œæµ‹è¯•GANçš„æ‰€æœ‰ä»£ç ã€‚è¯¥å‡½æ•°åˆ›å»ºä¸€ä¸ªGANã€‚ç„¶åå®ƒè®¾ç½®æ—¥å¿—ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°è¿è¡Œè¯•éªŒçš„ç»“æœã€‚ç„¶åç”¨ç»™å®šçš„å…ƒå‚æ•°è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ¥è¿è¡Œè¯•éªŒã€‚</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="ae00" class="me mf it nc b gy ng nh l ni nj">def objective(trial, params, network_dict):<br/>    # need to change all the requested metaparams<br/><br/>    logging.basicConfig(level=logging.INFO)<br/>    logger = logging.getLogger('__metaparams__')<br/><br/>    processor, df, processed_df, categories_n = initialise_processor(params['num_bins'],                                                                  params['dataset_name'],<br/>logger)<br/>   network_dict['input_output_dim'] = categories_n<br/>    fixed_params = fix_metaparams(trial, network_dict)<br/>    generator = build_generator_network(fixed_params)<br/>    discriminator = build_discriminator_network(fixed_params)<br/><br/>    # build the network's optimisers<br/>    gen_optimiser = build_network_optimiser(network_dict['optimiser'],<br/>                                            network_dict['generator_learning_rate'],<br/>                                            generator)<br/>    disc_optimiser = build_network_optimiser(network_dict['optimiser'],<br/>                                            network_dict['discriminator_learning_rate'],<br/>                                            discriminator)<br/><br/>    return run_experiment(<br/>        generator=generator,<br/>        discriminator=discriminator,<br/>        generator_solver=gen_optimiser,<br/>        discriminator_solver=disc_optimiser,<br/>        processor=processor,<br/>        df=df,<br/>        processed_df=processed_df,<br/>        latent_dim=fixed_params["latent_dim"],<br/>        output_folder=fixed_params["output_folder"],<br/>        num_bins=fixed_params["num_bins"],<br/>        epochs=fixed_params["epochs"],<br/>        batch_size=fixed_params["batch_size"],<br/>        sigma=params["sigma"],<br/>        num_critics=fixed_params["num_critics"],<br/>        cuda=params["cuda"],<br/>    )</span></pre><p id="ae7e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ç›®æ ‡å‡½æ•°å’Œå®ƒè°ƒç”¨çš„<strong class="lk jd"> run_experiment </strong>å‡½æ•°çœ‹èµ·æ¥éƒ½æœ‰ç‚¹å¤æ‚ï¼Œä½†æœ¬è´¨ä¸Šå®ƒä»¬åªæ˜¯åˆ†é…å’Œè§£æå‚æ•°ã€‚è¿™ä¸¤æ®µä»£ç ä¸­æœ‰ç›¸å½“å¤šçš„å†…å®¹ã€‚ç„¶è€Œï¼Œä»–ä»¬å®é™…ä¸Šåªæ˜¯è®¾ç½®äº†ç”Ÿæˆå™¨å’Œé‰´åˆ«å™¨ç½‘ç»œã€æ•°æ®é›†å’Œèµ‹å€¼å™¨ã€‚</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="b21e" class="me mf it nc b gy ng nh l ni nj">import logging<br/>from hazy_auto_tuning import initialise_processor, run_experiment<br/><br/>from hazy_network_metaparameters import check_requested_metaparameters, optimisable, fix_metaparams<br/># from metaparameter_tuning import build_discriminator_network, build_generator_network, build_network_optimiser<br/><br/>from metaparameter_tuning import build_discriminator_network, build_generator_network, build_network_optimiser</span></pre><p id="f17b" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">åœ¨ä»<a class="ae lh" href="https://hazy.com/" rel="noopener ugc nofollow" target="_blank"> Hazy </a>ä»£ç åº“ä¸­å†å¯¼å…¥å‡ æ¬¡ä¹‹åï¼Œä½ å¯ä»¥å»ºç«‹ä¸€ä¸ªOptunaç ”ç©¶å¯¹è±¡ï¼Œå¹¶è¦æ±‚å®ƒä¸ºæˆ‘ä»¬ä¼˜åŒ–æˆ‘ä»¬çš„å…ƒå‚æ•°ã€‚</p><pre class="ks kt ku kv gt nb nc nd ne aw nf bi"><span id="cceb" class="me mf it nc b gy ng nh l ni nj">study = optuna.create_study(direction="maximize")<br/>study.optimize(lambda trial: objective(trial, params_dict,       network_dict), n_trials=20)</span></pre><p id="5245" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">è¯·æ³¨æ„ï¼Œå¯¹äºä¸€é¡¹æœ‰ç”¨çš„ç ”ç©¶æ¥è¯´ï¼Œè¿™(å¯èƒ½)æ˜¯å¤ªå°‘çš„è¯•éªŒã€‚å¯¹äºå…ƒå‚æ•°ï¼Œå¦‚é‰´åˆ«å™¨å’Œç”Ÿæˆå™¨çš„å­¦ä¹ ç‡ï¼Œæˆ‘ä»¬éœ€è¦æ›´å¤šçš„è¯•éªŒã€‚ç±»ä¼¼åœ°ï¼Œå¯¹äºGANsæ€§èƒ½çš„ç²¾ç¡®è¯„ä¼°ï¼Œå†å…ƒçš„æ•°é‡å¯èƒ½ä¸å¤Ÿå¤§ã€‚è¿™äº›ä»…ä½œä¸ºä¾‹å­ç»™å‡ºã€‚</p><p id="a2fd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">ä½œä¸ºæœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆï¼Œèƒ½å¤Ÿè‡ªåŠ¨åŒ–å…ƒå‚æ•°ä¼˜åŒ–ä»¤äººå…´å¥‹ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥èŠ±æ›´å¤šæ—¶é—´æ¢ç´¢ä¼˜åŒ–å®ƒä»¬å¯¹æ‰€æä¾›çš„åˆæˆæ•°æ®é›†çš„å½±å“ã€‚æˆ‘ä»¬å·²ç»å°†Optunaä»£ç åº”ç”¨åˆ°æ¨¡å‹ä¸­ï¼Œè¿™å°†èŠ‚çœæˆ‘ä»¬æ‰€æœ‰äººçš„æ—¶é—´ã€‚</p></div></div>    
</body>
</html>