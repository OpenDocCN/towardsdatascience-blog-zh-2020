<html>
<head>
<title>Bullet Point Approach to Data Imbalance!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解决数据不平衡的要点方法！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bullet-point-approach-to-data-imbalance-34c701c8e686?source=collection_archive---------60-----------------------#2020-07-01">https://towardsdatascience.com/bullet-point-approach-to-data-imbalance-34c701c8e686?source=collection_archive---------60-----------------------#2020-07-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="efc3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">当绝大多数数据属于一个类(多数类)而少数类的样本很少时，就会出现数据不平衡问题或类不平衡问题。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/49ba55bc4e8d40fc4b2712ce87b9560b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gtkpxZMUKzZaTwDg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">由<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae kv" href="https://unsplash.com/@loicleray?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Loic Leray </a>拍摄的照片</p></figure><p id="0d99" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">如果:</strong>，就不会有数据不平衡的问题</p><ul class=""><li id="170f" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">你并不真正感兴趣的是，正确地划分少数阶级(很少发生！).</li><li id="7041" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">你有一个巨大的训练数据集，即使你的类样本比例非常不平衡，你仍然有很多样本在你的少数类。</li></ul><h2 id="c40b" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated"><strong class="ak">精确不是你的最佳选择</strong></h2><ul class=""><li id="9e70" class="ls lt iq ky b kz mz lc na lf nb lj nc ln nd lr lx ly lz ma bi translated">假设你有 1000 个样本(其中 990 个属于 A 类，10 个属于 b 类，你的智能算法决定把所有东西都归为 A 类！你的准确率，在这种情况下，是 99%！<br/>好看！除非你试图开发一个人工智能驱动的疾病识别工具，否则你将走向另一个<a class="ae kv" href="https://en.wikipedia.org/wiki/Theranos" rel="noopener ugc nofollow" target="_blank"> Theranos </a>故事。</li><li id="4e85" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">根据假阳性和假阴性的代价(和后果),你可以决定你应该更关注哪个指标。</li><li id="5cbe" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">例如，如果假阳性意味着您将损失 10 万美元，而假阴性意味着您将损失 10 美元，那么您知道您的指标应该更侧重于最小化假阳性！<br/> <a class="ae kv" href="https://en.wikipedia.org/wiki/False_positives_and_false_negatives" rel="noopener ugc nofollow" target="_blank">了解更多！</a></li></ul><h1 id="c944" class="ne mh iq bd mi nf ng nh ml ni nj nk mo jw nl jx mr jz nm ka mu kc nn kd mx no bi translated"><strong class="ak">如何处理问题？</strong></h1><p id="f8f0" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf np lh li lj nq ll lm ln nr lp lq lr ij bi translated">有 3 种方法:</p><ul class=""><li id="adf9" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">关注数据:</strong>使用各种采样、增强技术等。重点是要有一个更平衡的数据集。</li><li id="9574" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">关注算法:</strong>这些方法大多关注于修改损失函数。</li><li id="810e" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">混合方法:</strong>抽样和算法变化的结合。</li></ul><blockquote class="ns nt nu"><p id="47ea" class="kw kx nv ky b kz la jr lb lc ld ju le nw lg lh li nx lk ll lm ny lo lp lq lr ij bi translated">提示:根据假阳性和假阴性的代价(和后果),你可以决定你应该更关注哪个指标。</p></blockquote><p id="b60a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们从不同的方法开始</p><h2 id="5888" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated"><strong class="ak">过采样和欠采样</strong></h2><p id="0465" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf np lh li lj nq ll lm ln nr lp lq lr ij bi translated">也许处理数据不平衡最常见的方法之一是对少数类进行过采样或对多数类进行欠采样。请确保仅对定型集进行过采样。</p><ul class=""><li id="4c06" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">非常有用的关于 Python 中过采样的博客文章<a class="ae kv" href="https://beckernick.github.io/oversampling-modeling/" rel="noopener ugc nofollow" target="_blank"/></li><li id="84c3" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><a class="ae kv" href="https://www.rdocumentation.org/packages/mlr/versions/2.12.1/topics/oversample" rel="noopener ugc nofollow" target="_blank">R 中的过采样和欠采样</a></li></ul><h2 id="e993" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated"><strong class="ak">击杀</strong></h2><p id="4717" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf np lh li lj nq ll lm ln nr lp lq lr ij bi translated">过采样的一个有趣的概括是通过创建新的样本来合成少数类中的新数据点，而不仅仅是用替换进行过采样。该方法使用最近邻和随机数来生成新的合成(伪)数据点:</p><ol class=""><li id="4c0e" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr nz ly lz ma bi translated">随机选择一个数据点，称之为“主”。</li><li id="e2ac" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nz ly lz ma bi translated">找出五(k)个最近的邻居。</li><li id="cc37" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nz ly lz ma bi translated">随机选择这 5 个相邻点中的一个。</li><li id="4414" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nz ly lz ma bi translated">在你的“主要”点和随机选择的邻居之间画一条线。</li><li id="95b6" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr nz ly lz ma bi translated">在你画的线上创建一个随机点，并对其进行分类。</li></ol><p id="91c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://arxiv.org/pdf/1106.1813.pdf" rel="noopener ugc nofollow" target="_blank">主要论文</a>(有 5k+次引用)。如果你是视觉学习者，请看这里！ <br/> <strong class="ky ir"> Rose，</strong>是另一种使用平滑自举方法的半类似方法。</p><h2 id="9e94" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated"><strong class="ak">成本敏感分类</strong></h2><p id="ef7f" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf np lh li lj nq ll lm ln nr lp lq lr ij bi translated">常见的分类算法都试图最小化分类误差(如果你把 A 误分类为 B，就会通过增加代价函数来惩罚算法)。但是对于一个代价敏感的分类器，并不是所有的误分类都是一样的！当算法错误分类少数类(少数类获得更高的权重)时，它们会对算法进行更多的惩罚。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/f260e14f06b19f2d1ac31caa85488287.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*blqnArRgOCq7iQLo"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://unsplash.com/@fabioha?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">法比奥</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="46da" class="ne mh iq bd mi nf ng nh ml ni nj nk mo jw nl jx mr jz nm ka mu kc nn kd mx no bi translated"><strong class="ak">卷积神经网络(CNN)怎么样？</strong></h1><ul class=""><li id="5123" class="ls lt iq ky b kz mz lc na lf nb lj nc ln nd lr lx ly lz ma bi translated">上述方法工作良好。但是一些有趣的细微差别出现了，对于“经典的”机器学习技术来说不一定是真的。这是一篇关于的快速阅读实验论文。</li></ul><h2 id="d1c3" class="mg mh iq bd mi mj mk dn ml mm mn dp mo lf mp mq mr lj ms mt mu ln mv mw mx my bi translated"><strong class="ak">焦损失</strong></h2><p id="d79a" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf np lh li lj nq ll lm ln nr lp lq lr ij bi translated">这种相对较新的方法是我的一个朋友让我注意到的。该方法主要针对一阶段和两阶段目标识别，通过引入聚焦因子对交叉熵损失函数进行了改进。焦点因子给予更“难”的例子更高的权重。读艾的论文。</p><h1 id="3227" class="ne mh iq bd mi nf ng nh ml ni nj nk mo jw nl jx mr jz nm ka mu kc nn kd mx no bi translated"><strong class="ak">结论</strong></h1><p id="921e" class="pw-post-body-paragraph kw kx iq ky b kz mz jr lb lc na ju le lf np lh li lj nq ll lm ln nr lp lq lr ij bi translated">还有很多，但实际上这些是处理不平衡数据的非常有用的技术。我还想指出，有时将问题重新框定为异常检测问题会更容易！在异常检测中，问题变成了如何定义(和标记)正常行为。在下一篇文章中，我将在几个问题上使用这些技术，看看它们在 python 中的表现。</p></div></div>    
</body>
</html>