<html>
<head>
<title>Have you heard about the Optimization Problem?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你听说过最优化问题吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/have-you-heard-about-the-optimization-problem-a0bab74e26c?source=collection_archive---------54-----------------------#2020-06-08">https://towardsdatascience.com/have-you-heard-about-the-optimization-problem-a0bab74e26c?source=collection_archive---------54-----------------------#2020-06-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3729" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如果没有，这是问题的入门文章。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/feed3169d9ea2a6c99ccd22f0be2214e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FL291MGmxobgPfZK"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/@enginakyurt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> engin akyurt </a>拍摄的照片</p></figure><h1 id="de62" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="c33d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">作为一名数据科学家，有时我们需要创建一个脚本或机器学习模型来回答我们的问题。有时候，有很多方法可以解决我们的问题。举一个分类问题的例子；我们可以应用基于概率的模型、基于树的模型或基于线性的模型。最初，在EDA之后，我们会选择由数据填充的模型。现在，也许我们采用一个随机森林模型，并希望训练该模型。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/397a15013a86fce92f6bef2c26386971.png" data-original-src="https://miro.medium.com/v2/resize:fit:524/format:webp/1*UetSK11BBxe0FuejGxObgQ.png"/></div></figure><p id="d3fb" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">你们中的许多人会意识到有许多参数需要调整，就像旁边的图片一样。然后，您尝试参数的每个组合，直到找到适合您模型的<strong class="lt iu">‘最佳’</strong>参数，但这肯定会花费很长时间。</p><p id="8329" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我刚才在上面的文章中解释的就是我们所说的<strong class="lt iu">优化问题</strong>。</p><p id="bc25" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">形式上，我们可以将优化问题定义为</p><blockquote class="mt"><p id="bd74" class="mu mv it bd mw mx my mz na nb nc mm dk translated">"根据目标函数寻找最佳状态的问题."</p></blockquote><p id="e6bb" class="pw-post-body-paragraph lr ls it lt b lu nd ju lw lx ne jx lz ma nf mc md me ng mg mh mi nh mk ml mm im bi translated">我们所认为的状态是不同的，因为它取决于上下文。可能是</p><ul class=""><li id="8beb" class="ni nj it lt b lu mo lx mp ma nk me nl mi nm mm nn no np nq bi translated">随机森林模型的参数；</li><li id="08fe" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated">棋盘上的国际象棋位置；</li><li id="06c7" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated">深度学习模型中的神经网络权重</li><li id="0684" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm nn no np nq bi translated">地图上火车站的放置顺序。</li></ul><p id="2fe8" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">这里重要的是，可能的状态有很多种，但我们要找到的是<strong class="lt iu">【最佳】</strong>解(或者用数学术语<strong class="lt iu">目标函数</strong>、<strong class="lt iu">适应度函数</strong>、<strong class="lt iu">代价函数</strong>，或者<strong class="lt iu">损失函数</strong>)。对于优化问题，我们希望最大化或最小化这个函数。</p><p id="77ab" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在最优化问题的情况下，因为我们比较每个状态以找到数学上的最佳函数，这意味着状态应该是一个<strong class="lt iu">数值</strong>值(或数值向量)。优化问题本身可以分为连续优化，或者取决于变量的离散优化。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="6cc5" class="kz la it bd lb lc od le lf lg oe li lj jz of ka ll kc og kd ln kf oh kg lp lq bi translated">数学例题</h1><p id="837d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你想象有问题，让我用一个简单的数学函数来展示。想象一下，如果我们有一个如下的目标函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/ce7515498edc27031d6fe4d7a4105bdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*pPKSNhNNHlXoTikzKhengw.png"/></div></figure><p id="4bd0" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">其中x是由状态组成的向量</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/3feb78ab1077fe8d1d4f72d42ced6fdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*1gU4le1fi_0hdM5K0vwRag.png"/></div></figure><p id="e2ac" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">现在，例如，我们有一个优化问题，我们希望最大化目标函数，或者换句话说，从函数中获得尽可能大的最高值。在上面的问题中，函数只能取0或1之间的值。现在，我们可以有很多x的组合，可能是x = [0，0，0]，或者x = [0，1，1]等等。但是我们想最大化目标函数。也就是说，最优解应该是</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/3e7b166ddf603268d58ab791de37ad2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:280/format:webp/1*_-cu2U3S379UwBL3qwvOwQ.png"/></div></figure><p id="cc95" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">其中f(x)设为最优解的函数为<strong class="lt iu"> f(x) = 3。</strong>我刚才解释的是优化问题的一个例子，我们希望目标函数产生最大值。</p><p id="e5ff" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">在现实世界的问题中，等式永远不会那么简单。它通常涉及复杂功能和大量的状态组合。由于我们不能在合理的时间内优化目标函数，这就成了一个问题。</p><p id="ae9d" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">解决这个问题的一个方法是应用<strong class="lt iu">随机优化算法</strong>。顾名思义，我们不会遍历所有状态，而是从一个初始的“最佳”状态向量开始，然后随机生成一个新的状态向量(通常是当前“最佳”状态的邻居)。如果新状态更好，则新向量成为新的“最佳”状态向量。我们重复它，直到达到给定的最大重复次数。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="c6c5" class="kz la it bd lb lc od le lf lg oe li lj jz of ka ll kc og kd ln kf oh kg lp lq bi translated">实际应用——旅行推销员问题</h1><p id="8e40" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">旅行推销员问题(TSP)是一个优化问题，我们试图确定n个城市(或房子、车站等)的最短行程。你喜欢的任何类型)，在同一点开始和结束，并且访问所有的位置一次。例如，我在下面的网格中收集了五个城市。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/7c4614efc4be0c47e0ba6c9cef52f0ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*pwiMQU4tbQMSHOpI7t5DbA.png"/></div></figure><p id="2610" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我希望销售人员在所有城市旅行一次，并且在同一个城市开始和结束。如果我们设置解向量x = [0，1，2，3，4]并假设城市从0开始，那么推销员将像下面的网格一样旅行。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/2ba902351e98b07ab03f485cc8a9cc27.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*Di8a2qTeVlQUqhpxTzKvtQ.png"/></div></figure><p id="08e8" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">所走的路线似乎不是最佳路径。这就是我们试图找到最短路线或最优化问题的地方。</p><p id="73f7" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">对于本文，我将使用一个名为<a class="ae ky" href="https://mlrose.readthedocs.io/en/stable/index.html" rel="noopener ugc nofollow" target="_blank"> mlrose </a>的优化问题模块。如果要安装该模块，可以运行下面的代码。</p><pre class="kj kk kl km gt om on oo op aw oq bi"><span id="4c22" class="or la it on b gy os ot l ou ov">#Installing using pip<br/>pip install mlrose</span></pre><p id="6fd7" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">使用mlrose解决优化问题包括三个步骤:</p><ol class=""><li id="b8b3" class="ni nj it lt b lu mo lx mp ma nk me nl mi nm mm ow no np nq bi translated">定义一个适应度函数对象(我们喜欢最小化/最大化的函数)。</li><li id="bc65" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm ow no np nq bi translated">定义一个优化问题对象(包含我们试图解决的优化问题的所有基本信息的对象)。</li><li id="4a9a" class="ni nj it lt b lu nr lx ns ma nt me nu mi nv mm ow no np nq bi translated">运行随机优化算法。</li></ol><p id="3fc2" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">首先，我们需要定义适应度函数对象。幸运的是，mlrose已经有了用于定义适应度函数对象的<code class="fe ox oy oz on b">TravellingSales()</code>类。最初，<code class="fe ox oy oz on b">TravellingSales()</code>类需要所有城市的(x，y)坐标(或距离)。</p><pre class="kj kk kl km gt om on oo op aw oq bi"><span id="ab73" class="or la it on b gy os ot l ou ov">import mlrose</span><span id="2fb8" class="or la it on b gy pa ot l ou ov"><em class="pb"># List of city coordinates</em><br/>coords = [(1, 0), (3, 2), (7, 7), (1, 4), (5, 2)]</span><span id="9213" class="or la it on b gy pa ot l ou ov"><em class="pb"># Initialize fitness function object</em><br/>fitness_coords = mlrose.TravellingSales(coords = coords)</span></pre><p id="a4e7" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">启动适应度函数后，我们将定义优化问题对象。mlrose模块已经将<code class="fe ox oy oz on b">TSPOpt()</code>作为优化问题对象。我们只需要通过输入几个参数来定义对象。在上面的例子中，我们想要解决长度为5的最小化问题。在这种情况下，我们将优化对象定义如下</p><pre class="kj kk kl km gt om on oo op aw oq bi"><span id="2388" class="or la it on b gy os ot l ou ov"><em class="pb"># Define optimization problem object. length parameter is the number of the cities, fitness_fn is the fitness function, and we set maximize to false as we want the minimal distance</em></span><span id="e913" class="or la it on b gy pa ot l ou ov">problem = mlrose.TSPOpt(length = 5, fitness_fn = fitness_coords, maximize=False)</span></pre><p id="cd1f" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们现在准备选择一个随机优化算法，并用它来解决我们的问题。随机优化算法是基于<a class="ae ky" href="https://en.wikipedia.org/wiki/Evolutionary_algorithm" rel="noopener ugc nofollow" target="_blank">进化算法</a>，我不会深入解释此事，但mlrose模块中使用的参数就是基于此。在我们的示例中，我尝试将mutation_prob参数(只需将该参数视为基于当前最佳状态的状态变化率)设置为0.2，将max _ attemps(重复次数)设置为100。</p><pre class="kj kk kl km gt om on oo op aw oq bi"><span id="a66b" class="or la it on b gy os ot l ou ov">best_state, best_fitness = mlrose.genetic_alg(problem, mutation_prob = 0.2,max_attempts = 100, random_state = 2)</span><span id="9e40" class="or la it on b gy pa ot l ou ov">print('Best State is:')<br/>print(best_state)</span><span id="a1d9" class="or la it on b gy pa ot l ou ov">print('Best Fitness (Total Distances) is:')<br/>print(best_fitness)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/ce8ccfd397ac811a0145095c5e62b042.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*9weUuYgkeuM1CEQdrflxqw.png"/></div></figure><p id="ef0f" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">我们可以看到算法找到的最佳状态是[1，0，3，2，4]。我还提出了显示我们所走的总距离的最佳适合度，因为我们在这个问题中最小化的是总距离(准确地说是欧几里德距离)。如果我们把它形象化，我们的销售人员会走下面的路线。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/6ab2c3ecade3e57eada72fc8abdde5a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*VZTeJd3BkACD8g4k4mGXlg.png"/></div></figure><p id="85ca" class="pw-post-body-paragraph lr ls it lt b lu mo ju lw lx mp jx lz ma mq mc md me mr mg mh mi ms mk ml mm im bi translated">仅此而已。我们已经将优化问题应用到旅行推销员问题中，并找到了推销员可能走过的最佳路线。这就是我们如何用最优化问题来解决我们的问题。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="265d" class="kz la it bd lb lc od le lf lg oe li lj jz of ka ll kc og kd ln kf oh kg lp lq bi translated">结论</h1><p id="cb8c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">优化问题是根据目标函数寻找最佳状态的问题。这种状态可以是任何东西，从机器学习模型参数到推销员的旅行路线。目标是最大化或最小化给定状态的目标函数。</p></div><div class="ab cl nw nx hx ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="im in io ip iq"><h1 id="d6d8" class="kz la it bd lb lc od le lf lg oe li lj jz of ka ll kc og kd ln kf oh kg lp lq bi translated">如果您喜欢我的内容，并希望获得更多关于数据或数据科学家日常生活的深入知识，请考虑在此订阅我的<a class="ae ky" href="https://cornellius.substack.com/welcome" rel="noopener ugc nofollow" target="_blank">简讯。</a></h1><blockquote class="mt"><p id="f8ca" class="mu mv it bd mw mx my mz na nb nc mm dk translated">如果您没有订阅为中等会员，请考虑通过<a class="ae ky" href="https://cornelliusyudhawijaya.medium.com/membership" rel="noopener">我的推荐</a>订阅。</p></blockquote></div></div>    
</body>
</html>