<html>
<head>
<title>VAR and Panel Data Models — the powerhouse of multivariate forecasting techniques</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">VAR和面板数据模型——多元预测技术的发电站</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/var-and-panel-data-models-the-powerhouse-of-multivariate-forecasting-techniques-22b8d8888141?source=collection_archive---------28-----------------------#2020-06-18">https://towardsdatascience.com/var-and-panel-data-models-the-powerhouse-of-multivariate-forecasting-techniques-22b8d8888141?source=collection_archive---------28-----------------------#2020-06-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/83174a17ee39a71797d4ff682792ffaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jqL95z35zJArochm"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://unsplash.com/@aycai?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">艾伦蔡</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h2 id="3254" class="jh ji jj bd b dl jk jl jm jn jo jp dk jq translated" aria-label="kicker paragraph">时间序列</h2><div class=""/><div class=""><h2 id="146a" class="pw-subtitle-paragraph kp js jj bd b kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg dk translated">超越单变量时间序列预测</h2></div></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><p id="9e48" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">我们来做一个思维实验。</p><p id="6088" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">你是一家专门从事销售预测的预测分析公司。您的客户是一家大型食品连锁店，他要求您预测未来30天的销售量。</p><p id="3196" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">现在，您将寻找哪些信息来进行预测？</p><p id="d116" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">当然是过去的销售数据。假设你得到了他们过去两年的销售数据。所以你的预测模型变成了这样:</p><blockquote class="mk"><p id="6473" class="ml mm jj bd mn mo mp mq mr ms mt mj dk translated"><em class="mu">未来销售额= f(过去销售额)</em></p></blockquote><p id="c646" class="pw-post-body-paragraph lo lp jj lq b lr mv kt lt lu mw kw lw lx mx lz ma mb my md me mf mz mh mi mj im bi translated">现在想想，你能有多自信地说，只用这一个历史数据集，你就能做出一个好的、合理的预测？</p><p id="7ad1" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">在现实世界中当然不是这样。在现实世界中，预测历史销售额只是一条信息，但你还会寻找商店位置、法定假日、任何特殊事件、广告支出或促销活动等，事实上，每一条影响销售的信息。</p><p id="c8ce" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">这些信息的每一部分实质上都成为了预测模型中的一个变量:</p><blockquote class="mk"><p id="e0e8" class="ml mm jj bd mn mo mp mq mr ms mt mj dk translated">未来销售额= f(过去的销售额、特殊事件、假期、促销……)</p></blockquote><p id="9866" class="pw-post-body-paragraph lo lp jj lq b lr mv kt lt lu mw kw lw lx mx lz ma mb my md me mf mz mh mi mj im bi translated">这就是多元预测的力量所在。现实世界是相互联系的，一个过程的结果通常是多个输入和动作的结果。因此，难怪数据科学家会寻找与构建预测模型相关的每一条信息。</p><p id="3eac" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">在本文中，我将讨论两个强大的多变量时间序列预测模型——向量自回归(VAR)和面板数据模型——并用两种不同的编程语言——Python和r——的代码片段演示它们的应用。</p><p id="3485" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">所以让我们开始吧。</p></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><h1 id="a726" class="na nb jj bd nc nd ne nf ng nh ni nj nk ky nl kz nm lb nn lc no le np lf nq nr bi translated">一.向量自回归模型</h1><h2 id="007d" class="ns nb jj bd nc nt nu dn ng nv nw dp nk lx nx ny nm mb nz oa no mf ob oc nq jp bi translated">a)什么是向量自回归？</h2><p id="da1a" class="pw-post-body-paragraph lo lp jj lq b lr od kt lt lu oe kw lw lx of lz ma mb og md me mf oh mh mi mj im bi translated">在定义<em class="oi">向量自回归</em>之前，让我们了解一下什么是<em class="oi">自回归</em>。顾名思义，它是一个变量对自身的回归，对它过去的值的回归——就像我刚刚在引言中写的那样。在这种情况下，独立变量是被预测的同一个单变量数据序列的过去值。</p><p id="2935" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><em class="oi">向量自回归</em>概括了这一单变量概念，并允许在模型中包含额外的相关变量。在这种情况下，每个变量都使用其自身的过去值(滞后值)以及外部因素的滞后值进行预测。</p><h2 id="3008" class="ns nb jj bd nc nt nu dn ng nv nw dp nk lx nx ny nm mb nz oa no mf ob oc nq jp bi translated"><strong class="ak"> a)风险值模型的工作原理</strong></h2><p id="5973" class="pw-post-body-paragraph lo lp jj lq b lr od kt lt lu oe kw lw lx of lz ma mb og md me mf oh mh mi mj im bi translated">在单变量预测技术中，未来值被预测为过去值的函数。所以，如果你想预测一个城市在2021年的人口，你需要一个简单的单变量预测方法:</p><figure class="ok ol om on gt iv gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/236cccf6be169b235c137e4decf10f28.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*SRgZvUtAj7Aw7V3p2_zsEw.png"/></div></figure><p id="632c" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">但如果你想在更长的时间范围内做出预测(比如2050年的人口)，我们知道还有许多其他因素需要考虑——出生率、死亡率、教育、收入等等。这些因素被称为外源因素或<em class="oi">协变量</em>。在短期内，这些外部因素的影响不是很大，所以我们可以忽略它们，但从长期来看，它们的影响是复合的，并产生了可测量的差异。</p><p id="e2c6" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">VAR就是这样一种在建模过程中融入外生变量的多变量预测模型。在此过程中，因变量使用其自身的过去(滞后)值以及外部因素的滞后值进行预测。</p><figure class="ok ol om on gt iv gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/b9359226c6940254940fd3aa45e7ba4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*4FbxIdbbhiX_Pc1zenUuqg.png"/></div></figure><h2 id="0c04" class="ns nb jj bd nc nt nu dn ng nv nw dp nk lx nx ny nm mb nz oa no mf ob oc nq jp bi translated">c)用Python实现</h2><p id="0e93" class="pw-post-body-paragraph lo lp jj lq b lr od kt lt lu oe kw lw lx of lz ma mb og md me mf oh mh mi mj im bi translated">为了演示它是如何工作的，我使用了一个由14个不同变量组成的美国宏观经济数据集。这是从1959年到2009年的季度数据。然而，出于演示的目的，我只使用了两个变量:国内生产总值(realgdp)和个人消费支出(realcons)。您可以按照下面代码片段中的代码访问数据集。</p><figure class="ok ol om on gt iv gh gi paragraph-image"><div class="gh gi op"><img src="../Images/dd91eba0261403b965afe9b4cdba3585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*OWrfK92-Exhjwt9GArRh9Q.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">用于VAR实施的完整数据集的几行</p></figure><p id="5f1a" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">我将使用一个Python环境来利用其非常丰富的<code class="fe oq or os ot b">statsmodels</code>库，这是一个非常灵活的VAR实现选项的来源。演示的数据集也来自这个API。</p><p id="c8b3" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">所以这个练习的目标是对未来的<em class="oi">实际gdp </em>和<em class="oi">实际成本</em>进行5个时间步的预测。</p><figure class="ok ol om on gt iv"><div class="bz fp l di"><div class="ou ov l"/></div></figure><figure class="ok ol om on gt iv gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/0d2d0dd538b3ce48431edea0b1083fb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*q130yTRN1d9qKGmNzTdCuA.png"/></div></figure><figure class="ok ol om on gt iv gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/7ed7b5a59a36b832efc021c11fc8e1f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1232/format:webp/0*duiZrNCXCPQaNt4W.png"/></div></figure></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><h1 id="707c" class="na nb jj bd nc nd ne nf ng nh ni nj nk ky nl kz nm lb nn lc no le np lf nq nr bi translated">二。面板数据模型</h1><h2 id="efe3" class="ns nb jj bd nc nt nu dn ng nv nw dp nk lx nx ny nm mb nz oa no mf ob oc nq jp bi translated">a)什么是面板数据？</h2><p id="3d5b" class="pw-post-body-paragraph lo lp jj lq b lr od kt lt lu oe kw lw lx of lz ma mb og md me mf oh mh mi mj im bi translated">如果你之前没有听说过<em class="oi">面板数据</em>你并不孤单。但是我确信你以前见过这种数据，你只是不知道它有一个名字。以下是面板数据的正式定义:</p><p id="46b8" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><em class="oi">一个</em> <strong class="lq jt"> <em class="oi">面板数据</em> </strong> <em class="oi">是一个观察值的多维数据，随着时间的推移被反复测量。</em></p><p id="aa9e" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">简单地说，一个面板数据是对同一个对象或个体的重复观察。看看下面这些虚构的数据，它们可能比阅读定义更直观:</p><figure class="ok ol om on gt iv gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/79029567087d52804fab1c2c513c6130.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*66bJ3s9NorIoVW2AwvyO8Q.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd oz">图:假想面板数据表</strong></p></figure><h2 id="7135" class="ns nb jj bd nc nt nu dn ng nv nw dp nk lx nx ny nm mb nz oa no mf ob oc nq jp bi translated">b)面板数据模型如何工作？</h2><p id="4379" class="pw-post-body-paragraph lo lp jj lq b lr od kt lt lu oe kw lw lx of lz ma mb og md me mf oh mh mi mj im bi translated">从概念的角度来看，面板数据很像多元OLS回归，但比正常的OLS更有效。使用上述数据集，假设您对以下问题感兴趣:</p><blockquote class="pa pb pc"><p id="3451" class="lo lp oi lq b lr ls kt lt lu lv kw lw pd ly lz ma pe mc md me pf mg mh mi mj im bi translated"><strong class="lq jt">城市支出增加了入学人数吗？</strong></p></blockquote><p id="5e3e" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">通过运行OLS，我们可以快速检查城市支出和学校招生之间是否存在关联，并构建一个模型:</p><p id="add0" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><em class="oi">支出= f(学校招生)</em></p><p id="aeb5" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">然而，数据集不是普通的数据框架；这是一个面板数据，有两个额外的列——城市名称和年份——我们也可以在模型中使用。下面是三种不同的方法来构建模型，每种方法都增加了额外的可变效果。</p><p id="1f1f" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><strong class="lq jt"> <em class="oi">汇集OLS模式</em> </strong></p><figure class="ok ol om on gt iv gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/a166ea91bf10c040d2b184649d676ea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*Caab0R6kdnncmdBnfI-z7g.png"/></div></figure><p id="2771" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><strong class="lq jt"> <em class="oi">固定特效模式</em> </strong></p><figure class="ok ol om on gt iv gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/0b082a61fe435bb132c17987bad1ae22.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*ZxhXU3VQK94fw0qH4o3-Aw.png"/></div></figure><p id="6578" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated"><strong class="lq jt"> <em class="oi">随机效果模型</em> </strong></p><figure class="ok ol om on gt iv gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/1e49404837501ebd6fc03e1dda18377f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*7OtyTaL1zShE7fndC5PwMg.png"/></div></figure><h2 id="a03b" class="ns nb jj bd nc nt nu dn ng nv nw dp nk lx nx ny nm mb nz oa no mf ob oc nq jp bi translated">c)在<code class="fe oq or os ot b">R</code>中的实施</h2><p id="e31c" class="pw-post-body-paragraph lo lp jj lq b lr od kt lt lu oe kw lw lx of lz ma mb og md me mf oh mh mi mj im bi translated">我喜欢Python，但这是我在r上看到的为数不多的情况之一。它有一个强大的库叫做<code class="fe oq or os ot b">plm</code>,你可以用它只用几行代码构建面板数据模型。而且非常直观。</p><p id="c7d8" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">下面我正在创建一个关于随机效果模型的演示，但是你可以通过将模型类型(第16行)从“随机”改为“池化”或“内化”以及一些其他的建模变化来玩代码。</p><figure class="ok ol om on gt iv"><div class="bz fp l di"><div class="ou ov l"/></div></figure><figure class="ok ol om on gt iv gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/b90cba98a25062110dc72b3c41b10277.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*HRCvCZjGiDmWc4IJ8LSPEQ.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><strong class="bd oz">图:模型输出汇总</strong></p></figure></div><div class="ab cl lh li hx lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="im in io ip iq"><h2 id="2b96" class="ns nb jj bd nc nt nu dn ng nv nw dp nk lx nx ny nm mb nz oa no mf ob oc nq jp bi translated">最后的想法</h2><p id="8b5d" class="pw-post-body-paragraph lo lp jj lq b lr od kt lt lu oe kw lw lx of lz ma mb og md me mf oh mh mi mj im bi translated">本文的目的是展示两种强大的多元预测技术——向量自回归和面板数据模型——在现实应用中的价值。为什么要多元预测？因为单变量预测有其自身的局限性。认为未来完全依赖于过去是一个过于简单的假设。</p><p id="d9ce" class="pw-post-body-paragraph lo lp jj lq b lr ls kt lt lu lv kw lw lx ly lz ma mb mc md me mf mg mh mi mj im bi translated">建立模型的目的是为了重现和模仿现实世界。现实世界是复杂且相互关联的，因此这需要在我们的模型中得到反映。</p></div></div>    
</body>
</html>