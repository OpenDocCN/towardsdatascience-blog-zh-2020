<html>
<head>
<title>Automate These 3 (Boring!!) Excel Tasks with Python!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化这 3 个(无聊！！)用 Python 做 Excel 任务！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automate-these-3-boring-excel-tasks-with-python-666b4ded101b?source=collection_archive---------3-----------------------#2020-03-26">https://towardsdatascience.com/automate-these-3-boring-excel-tasks-with-python-666b4ded101b?source=collection_archive---------3-----------------------#2020-03-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0073" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">不用再打开数百个 Excel 文件</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/74bf3f6ad63c8a58a65fb213777f7ccd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*F7sRxt35c6GYEFhXJ6deew.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让我们来学习如何自动化一些枯燥的 Excel 任务！资料来源:Nik Piepenbreier</p></figure><p id="b4e8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Excel 无处不在。无论好坏，它基本上是工作场所中数据分析的默认应用程序。在你的日常生活中，你可能需要完成许多无聊的任务，这让你思考，“一定有更好的方法”。Python 在那边！</p><p id="452f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">所有这些例子在 VBA 都是可能的，但是 VBA 可能很乏味，嘿，我们喜欢 Python！</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="2f36" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">合并多个 Excel 文件</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/92a4e9bf6da76fefa253cd697d8cd663.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*CCSPWY3dnCg7wghzjqdCFA.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让我们将多个 Excel 文件合并成一个文件！资料来源:Nik Piepenbreier</p></figure><p id="06ec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可能会发现自己有许多 Excel 工作簿(例如每月销售报告)。有一天，你被要求计算所有这些报表的总销售额。我们可以使用 Pandas 库轻松地将 Excel 工作簿与 Python 结合起来。</p><p id="109e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您可以使用 pip 或 conda 安装 Pandas:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="a87b" class="mz mc it mv b gy na nb l nc nd">pip install pandas<br/>conda install pandas</span></pre><p id="ef13" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于本教程，让我们加载三个独立的 Excel 工作簿，它们链接到下面:</p><ul class=""><li id="27d3" class="ne nf it la b lb lc le lf lh ng ll nh lp ni lt nj nk nl nm bi translated">文件一:<a class="ae nn" href="https://github.com/datagy/mediumdata/raw/master/january.xlsx" rel="noopener ugc nofollow" target="_blank">https://github . com/datagy/medium data/raw/master/January . xlsx</a></li><li id="39fc" class="ne nf it la b lb no le np lh nq ll nr lp ns lt nj nk nl nm bi translated">文件二:h<a class="ae nn" href="https://github.com/datagy/mediumdata/raw/master/february.xlsx" rel="noopener ugc nofollow" target="_blank">ttps://github . com/datagy/medium data/raw/master/junior . xlsx</a></li><li id="25ad" class="ne nf it la b lb no le np lh nq ll nr lp ns lt nj nk nl nm bi translated">文件三:【https://github.com/datagy/mediumdata/raw/master/march.xlsx T4】</li></ul><p id="e491" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以看到数据直到第 4 行才真正开始，所以我们需要 Pandas 从那一行开始导入工作表。在下面的代码中，我们将使用 read_excel 和 append 函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">将 Excel 文件与 Python 相结合。资料来源:Nik Piepenbreier</p></figure><p id="2ccf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看我们在这里做了什么:</p><ol class=""><li id="63b4" class="ne nf it la b lb lc le lf lh ng ll nh lp ni lt nv nk nl nm bi translated">在第 1 部分中，我们导入了 pandas，创建了一个包含所有 URL 的列表，并生成了一个名为<em class="nw"> combined </em>的空白数据帧。</li><li id="d7a8" class="ne nf it la b lb no le np lh nq ll nr lp ns lt nv nk nl nm bi translated">在第 2 节中，我们遍历了<em class="nw">文件</em>中的每个 URL，将每个文件读入一个数据帧(“df”)，跳过前三行，并将其附加到组合的<em class="nw">数据帧中。</em></li><li id="e87e" class="ne nf it la b lb no le np lh nq ll nr lp ns lt nv nk nl nm bi translated">在第 3 节中，我们编写生成一个名为<em class="nw"> combined.xlsx </em>的新 Excel 文件，其中包含我们合并的 Excel 工作簿！</li></ol></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="a16e" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">从各种工作簿中获取值</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/acb1883b2f8cc5b89b5d1b013358f943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X4poGLj8UF5L09-KOmp6AQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">使用 Python，很容易从多个文件中获得任何值！资料来源:Nik Piepenbreier</p></figure><p id="1294" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们再来看另一个例子！假设我们只需要从每个销售报告中获得多伦多的总数，并将它们收集到一个列表中。我们知道总数存储在每个工作簿的单元格 F5 中。如果您正在跟进，如果您将文件存储在本地，这个包就可以工作。用上面的链接下载文件并保存到你的机器上。</p><p id="54d0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">对于这个例子，我们将使用另一个名为<strong class="la iu"> openpyxl </strong>的库。您可以使用以下代码安装 pip 或 conda:</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="2afb" class="mz mc it mv b gy na nb l nc nd">pip install openpyxl<br/>conda install openpyxl</span></pre><p id="1953" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们开始编码吧！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">用 Python 从多个工作簿中获取单元格。资料来源:Nik Piepenbreier</p></figure><p id="b33d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们一步一步地分解它:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/897831b0dfe8feeb06125444af919372.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*w2nHEzioH2A03FgmHePgZA.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在 Windows 中复制文件路径。资料来源:Nik Piepenbreier</p></figure><p id="9852" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<strong class="la iu">第 1 节</strong>中，我们:</p><ul class=""><li id="4fbb" class="ne nf it la b lb lc le lf lh ng ll nh lp ni lt nj nk nl nm bi translated">生成了一个包含所有文件链接的列表(“文件”)。在 Windows 中，我们可以按住 Shift 键并单击鼠标右键，然后使用“复制为路径”来获取它的路径。</li><li id="ed1e" class="ne nf it la b lb no le np lh nq ll nr lp ns lt nj nk nl nm bi translated">您可能希望将字符串转换为原始字符串，方法是在它前面加上前缀“r”。</li><li id="dfee" class="ne nf it la b lb no le np lh nq ll nr lp ns lt nj nk nl nm bi translated">我们还生成了一个空列表来存储我们的值。</li></ul><p id="e666" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<strong class="la iu">步骤</strong> 2 中，我们</p><ul class=""><li id="5444" class="ne nf it la b lb lc le lf lh ng ll nh lp ni lt nj nk nl nm bi translated">使用 openpyxl 遍历文件。</li><li id="9b9b" class="ne nf it la b lb no le np lh nq ll nr lp ns lt nj nk nl nm bi translated">的。load_workbook()方法加载一个文件。</li><li id="8bcd" class="ne nf it la b lb no le np lh nq ll nr lp ns lt nj nk nl nm bi translated">我们使用['Sheet1']和['F5']来引用工作簿和工作表对象中的工作表名称和单元格引用。</li><li id="a8f4" class="ne nf it la b lb no le np lh nq ll nr lp ns lt nj nk nl nm bi translated">最后，我们使用。value 属性提取单元格的值，并将其追加到<em class="nw">值</em>列表中。</li></ul></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="ba0b" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">在工作簿中应用公式</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/01b2041ee9e7365e080ceb9cac605dff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*KW3fnebs_N_3JO8m_y06eg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让我们在多个工作簿中应用相同的公式！资料来源:Nik Piepenbreier</p></figure><p id="f702" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看最后一个例子！在每个 Excel 工作簿中，我们都有跨行的汇总，但没有销售额的总计。同样，我们可以打开每个工作簿并添加一个公式，或者我们可以使用 Python 来完成这项工作！</p><p id="5ea8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将再次使用 openpyxl。如果您需要安装它，请查看上面的说明。上面也有下载文件的链接。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nt nu l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在工作簿中插入公式！资料来源:Nik Piepenbreier</p></figure><p id="b397" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这段代码中，我们再次填充了一个文件列表。for 循环打开每个文件，并将“Sheet1”分配给一个变量 Sheet。</p><p id="1798" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后，我们将字符串' =SUM(F5:F8)'赋给单元格 F9，并使用。属性将货币样式直接分配给单元格。更多单元格样式可在<a class="ae nn" href="https://openpyxl.readthedocs.io/en/stable/styles.html" rel="noopener ugc nofollow" target="_blank">官方文档</a>中找到。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="4fef" class="mb mc it bd md me mf mg mh mi mj mk ml jz mm ka mn kc mo kd mp kf mq kg mr ms bi translated">结论:用 Python 自动化 Excel</h1><p id="dff6" class="pw-post-body-paragraph ky kz it la b lb nz ju ld le oa jx lg lh ob lj lk ll oc ln lo lp od lr ls lt im bi translated">Python 使得使用 Excel 文件变得非常容易！在本文中，我们学习了如何组合各种 Excel 文件、获取特定值以及在工作簿中添加公式。</p><p id="3407" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们使用 Python 创建可追踪的、可复制的代码，让我们复制我们的分析设计。虽然您可能一整天都在使用 Excel 工作簿，但是 Python 可以自动完成一些随之而来的繁琐任务。</p></div></div>    
</body>
</html>