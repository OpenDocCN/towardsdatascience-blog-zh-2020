<html>
<head>
<title>Optimization Techniques — Simulated Annealing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">优化技术—模拟退火</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/optimization-techniques-simulated-annealing-d6a4785a1de7?source=collection_archive---------1-----------------------#2020-04-21">https://towardsdatascience.com/optimization-techniques-simulated-annealing-d6a4785a1de7?source=collection_archive---------1-----------------------#2020-04-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="af12" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">一种优化模型参数的流行方法</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/77b21f3511f087ee5e235a9cd235a7d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OyyX3J87mCQqt4_pNBzd1A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@clemhlrdt?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">克莱门特·H</a>在<a class="ae ky" href="https://unsplash.com/s/photos/classification-coding?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="241a" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">什么是物理退火？</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/74c47a0e63ad87d0983b90c8b22f5842.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-KC33ce7wwSFaFY0sO1IEQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@m_i_c_k_e_y?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">米盖尔·阿奎莱拉</a>在<a class="ae ky" href="https://unsplash.com/s/photos/metalworks?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="7258" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">模拟退火算法是基于现实生活中的物理退火。物理退火是加热材料直到其达到<strong class="lt iu">退火温度</strong>然后将<strong class="lt iu">缓慢冷却</strong>以将材料改变成所需结构的过程。当材料变热时，分子结构变弱，更容易发生变化。当材料冷却下来时，分子结构变得更硬，更不容易改变。</p><p id="b001" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这种类比的另一个重要部分是来自热力学的以下方程:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/41ec3f132433928d9b1c81e8108cc34e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WnBJxCX9FBYAhnHl5OfJhg.png"/></div></div></figure><p id="c692" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这个等式计算能量大小增加的概率。给定一些能量大小和一些温度<em class="mo"> t </em>以及玻尔兹曼常数<em class="mo"> k </em>，我们可以计算出这个值。</p><h1 id="fe10" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">模拟退火</h1><p id="e4f8" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">模拟退火(SA)模拟物理退火过程，但用于优化模型中的参数。这一过程对于存在大量局部极小值的情况非常有用，这样像梯度下降这样的算法就会停滞不前。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/2a758238f355035ae45cd700b46e46e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iXV2btukAUcn5lfd-ZjU7A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">局部极小值问题的例子</p></figure><p id="afec" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在类似上面的问题中，如果梯度下降从指定的起点开始，它将停留在局部最小值，而不能到达全局最小值。</p><h2 id="9bca" class="mv la it bd lb mw mx dn lf my mz dp lj ma na nb ll me nc nd ln mi ne nf lp ng bi translated">算法</h2><p id="2fcc" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">第一步:我们首先从一个初始解开始<strong class="lt iu"> s = S₀ </strong>。这可以是符合可接受解决方案标准的任何解决方案。我们也从初始温度开始，t = t₀。</p><p id="8901" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">第二步:</strong>设置降温功能<em class="mo">α</em>。通常有 3 种主要的降温规则:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/edfe791b0850365c2c71f28219f6d86e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v2XktDqca_Y6l53tyOV2Hg.png"/></div></div></figure><p id="a1df" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">每种缩减规则以不同的速率降低温度，并且每种方法更擅长优化不同类型的模型。对于第三个规则，<em class="mo"> beta </em>是一个任意的常数。</p><p id="ae63" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">步骤 3: </strong>从初始温度开始，循环通过步骤 4 的<em class="mo"> n </em>次迭代，然后根据<em class="mo">α</em>降低温度。停止该循环，直到达到<em class="mo">终止条件</em>。终止条件可以是达到某个最终温度、对于给定的一组参数达到某个可接受的性能阈值等。时间与温度的映射以及温度下降的速度称为<strong class="lt iu">退火程序</strong>。</p><p id="f2c2" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">步骤 4: </strong>给定解的邻域<em class="mo"> N(s) </em>，选择一个解，并计算旧解和新邻域解之间的成本差。解的邻域是所有接近该解的解。例如，如果我们改变五个参数中的一个，但保持其余四个不变，则一组五个参数的邻域可能是。</p><p id="d487" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated"><strong class="lt iu">第五步:</strong>如果新旧方案的成本差大于 0(新方案更好)，则接受新方案。如果成本差异小于 0(旧的解决方案更好)，则生成一个介于 0 和 1 之间的随机数，如果它低于根据之前的能量幅度方程计算的值，则接受它。</p><p id="5f2c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在模拟退火的情况下，该等式被修改为如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/740d236d5a73c0986a28c2cee8297ad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8QZWw1Rrj3pigx3MKMPzbg.png"/></div></div></figure><p id="a2c9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">其中<em class="mo">δc</em>是成本的变化，<em class="mo"> t </em>是当前温度。</p><p id="1aeb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这种情况下计算出的<em class="mo"> P </em>就是我们应该接受新方案的概率。</p><h2 id="fd6b" class="mv la it bd lb mw mx dn lf my mz dp lj ma na nb ll me nc nd ln mi ne nf lp ng bi translated">高温与低温</h2><p id="34f9" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">由于计算概率的方式，当温度较高时，算法是否更有可能接受更差的解决方案。这促进了搜索空间的<strong class="lt iu">探索</strong>，并允许算法更有可能沿着次优路径行进，以潜在地找到全局最大值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/29629987fe1cc147fd050f20f6418cd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3pRD5HJdAIPNsZyLNCA5Tg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">给定温度为 0.9 的样本接受概率</p></figure><p id="6a3c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">当温度较低时，算法不太可能或不愿意接受更差的解决方案。这促进了<strong class="lt iu">利用</strong>，这意味着一旦算法处于正确的搜索空间，就没有必要搜索搜索空间的其他部分，而是应该尝试收敛并找到全局最大值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/79f7e93d2f2bd6e6c0c8f92ea2777123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8j24JUQuWZVBw73mlHonJg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">给定温度为 0.1 的样本接受概率</p></figure><h1 id="e108" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">一些用 SA 优化问题的例子</h1><ul class=""><li id="c455" class="nl nm it lt b lu mp lx mq ma nn me no mi np mm nq nr ns nt bi translated">旅行推销员问题</li><li id="883f" class="nl nm it lt b lu nu lx nv ma nw me nx mi ny mm nq nr ns nt bi translated">调度问题</li><li id="de58" class="nl nm it lt b lu nu lx nv ma nw me nx mi ny mm nq nr ns nt bi translated">任务分配</li><li id="f95c" class="nl nm it lt b lu nu lx nv ma nw me nx mi ny mm nq nr ns nt bi translated">图的着色和划分</li><li id="66d6" class="nl nm it lt b lu nu lx nv ma nw me nx mi ny mm nq nr ns nt bi translated">非线性函数优化</li></ul><h1 id="7879" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">SA 的优势与劣势</h1><h2 id="49b6" class="mv la it bd lb mw mx dn lf my mz dp lj ma na nb ll me nc nd ln mi ne nf lp ng bi translated">优势</h2><ul class=""><li id="3cf7" class="nl nm it lt b lu mp lx mq ma nn me no mi np mm nq nr ns nt bi translated">易于实施和使用</li><li id="23c7" class="nl nm it lt b lu nu lx nv ma nw me nx mi ny mm nq nr ns nt bi translated">为各种问题提供最佳解决方案</li></ul><h2 id="eb6c" class="mv la it bd lb mw mx dn lf my mz dp lj ma na nb ll me nc nd ln mi ne nf lp ng bi translated">不足之处</h2><ul class=""><li id="c6fc" class="nl nm it lt b lu mp lx mq ma nn me no mi np mm nq nr ns nt bi translated">如果退火计划很长，可能需要很长时间运行</li><li id="dc90" class="nl nm it lt b lu nu lx nv ma nw me nx mi ny mm nq nr ns nt bi translated">该算法中有许多可调参数</li></ul><h1 id="8c33" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">SA 的实施</h1><p id="29b1" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">这是模拟退火的一个样本样板实现。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nz oa l"/></div></figure><h1 id="1095" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">结论</h1><p id="9882" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">模拟退火是一种用于优化多参数模型的流行算法，可以相对快速地实现。如果需要多次迭代，模拟退火的计算量会非常大，但它能够找到全局最大值，而不会陷入局部最小值。</p></div></div>    
</body>
</html>