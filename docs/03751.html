<html>
<head>
<title>Valuable Data Analysis with Pandas Value Counts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有价值的数据分析与熊猫价值计数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/valuable-data-analysis-with-pandas-value-counts-d87bbdf42f79?source=collection_archive---------10-----------------------#2020-04-08">https://towardsdatascience.com/valuable-data-analysis-with-pandas-value-counts-d87bbdf42f79?source=collection_archive---------10-----------------------#2020-04-08</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><figure class="it iu gq gs iv iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj is"><img src="../Images/c128b77f1230f8c7843468d6c609bd9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mBviWlffiep2aiJ_euS6zQ.jpeg"/></div></div><p class="jd je gk gi gj jf jg bd b be z dk translated">照片由<a class="ae jh" href="https://unsplash.com/@sharonmccutcheon?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">莎伦·麦卡琴</a>在<a class="ae jh" href="https://unsplash.com/s/photos/counting?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><div class=""/><div class=""><h2 id="8533" class="pw-subtitle-paragraph kh jj jk bd b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dk translated">使用这个简单的工具，你可以做比你想象的更多的数据分析</h2></div><p id="e4e4" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">流行的python数据科学库<a class="ae jh" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.value_counts.html" rel="noopener ugc nofollow" target="_blank"> Pandas </a>中的<code class="fe lv lw lx ly b"><strong class="lb jl">value_counts()</strong></code>函数是一种快速计算单个列中唯一值的方法，也称为一系列数据。</p><p id="e55e" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">这个函数对于在Pandas数据帧中包含的特定数据列上快速执行一些基本的数据分析非常有用。关于熊猫数据帧的介绍，请看上周的帖子，可以在这里找到<a class="ae jh" rel="noopener" target="_blank" href="/introduction-to-pandas-dataframes-b1b61d2cec35"/>。</p><p id="8260" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">在下面的文章中，我将向你展示一些使用这个工具进行数据分析的技巧。这篇文章将向你展示如何在你的代码中添加一些东西，你就可以使用这个函数进行大量的分析。</p></div><div class="ab cl lz ma hy mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="in io ip iq ir"><h2 id="645e" class="mg mh jk bd mi mj mk dn ml mm mn dp mo li mp mq mr lm ms mt mu lq mv mw mx my bi translated"><strong class="ak">数据</strong></h2><p id="83c2" class="pw-post-body-paragraph kz la jk lb b lc mz kl le lf na ko lh li nb lk ll lm nc lo lp lq nd ls lt lu in bi translated">在本文展示的例子中，我将使用来自Kaggle网站的数据集。它是为机器学习分类任务而设计的，包含有关医疗预约的信息和一个目标变量，该变量表示患者是否赴约。</p><p id="db40" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">可以在这里 下载<a class="ae jh" href="https://www.kaggle.com/somrikbanerjee/predicting-show-up-no-show" rel="noopener ugc nofollow" target="_blank"> <strong class="lb jl">。</strong></a></p><p id="d9a8" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">在下面的代码中，我已经导入了我将在整篇文章中使用的数据和库。</p><pre class="ne nf ng nh gu ni ly nj nk aw nl bi"><span id="ade3" class="mg mh jk ly b gz nm nn l no np">import pandas as pd</span><span id="b3ae" class="mg mh jk ly b gz nq nn l no np">import matplotlib.pyplot as plt<br/>%matplotlib inline</span><span id="fcb6" class="mg mh jk ly b gz nq nn l no np">data = pd.read_csv('KaggleV2-May-2016.csv')<br/>data.head()</span></pre><figure class="ne nf ng nh gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj nr"><img src="../Images/8092f142b36b45d17870e19db2e450bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NLKp1Aqt2n5qm7Pr-e-YDQ.png"/></div></div><p class="jd je gk gi gj jf jg bd b be z dk translated">来自Kaggle.com的医疗预约失约数据集的前几行</p></figure><h2 id="c54b" class="mg mh jk bd mi mj mk dn ml mm mn dp mo li mp mq mr lm ms mt mu lq mv mw mx my bi translated">基本计数</h2><p id="f725" class="pw-post-body-paragraph kz la jk lb b lc mz kl le lf na ko lh li nb lk ll lm nc lo lp lq nd ls lt lu in bi translated">可以通过以下方式使用<code class="fe lv lw lx ly b">value_counts()</code>函数来获得数据集中某一列的唯一值的计数。下面的代码给出了<strong class="lb jl">性别</strong>列中每个值的计数。</p><pre class="ne nf ng nh gu ni ly nj nk aw nl bi"><span id="f773" class="mg mh jk ly b gz nm nn l no np">data['Gender'].value_counts()</span></pre><figure class="ne nf ng nh gu iw gi gj paragraph-image"><div class="gi gj ns"><img src="../Images/b18badde7d3f3a3a0f999f1665b7953f.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*iE8D6V9Wz9IkUFyTUL6prg.png"/></div></figure><p id="66f3" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">要按升序或降序对值进行排序，我们可以使用<strong class="lb jl">排序</strong>参数。在下面的代码中，我添加了<code class="fe lv lw lx ly b"><strong class="lb jl">sort=True</strong></code>，以降序显示<strong class="lb jl">年龄</strong>列中的计数。</p><pre class="ne nf ng nh gu ni ly nj nk aw nl bi"><span id="5052" class="mg mh jk ly b gz nm nn l no np">data['Age'].value_counts(sort=True)</span></pre><figure class="ne nf ng nh gu iw gi gj paragraph-image"><div class="gi gj nt"><img src="../Images/e17456e2f9e488413d24a0756a203c19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*GM0eFtXdkzAJIAbz_QNCmA.png"/></div></figure><h2 id="f005" class="mg mh jk bd mi mj mk dn ml mm mn dp mo li mp mq mr lm ms mt mu lq mv mw mx my bi translated"><strong class="ak">与groupby()结合</strong></h2><p id="8f88" class="pw-post-body-paragraph kz la jk lb b lc mz kl le lf na ko lh li nb lk ll lm nc lo lp lq nd ls lt lu in bi translated">value_counts函数可以与其他Panadas函数结合使用，以获得更丰富的分析技术。一个例子是与<code class="fe lv lw lx ly b"><strong class="lb jl">groupby()</strong></code>函数结合。在下面的例子中，我正在计算性别列中的值，并应用<code class="fe lv lw lx ly b">groupby()</code>来进一步了解每组中未出现的人数。</p><pre class="ne nf ng nh gu ni ly nj nk aw nl bi"><span id="3faf" class="mg mh jk ly b gz nm nn l no np">data['No-show'].groupby(data['Gender']).value_counts(sort=True)</span></pre><figure class="ne nf ng nh gu iw gi gj paragraph-image"><div class="gi gj nu"><img src="../Images/0de457cf6608f384bd8baf516f9cc731.png" data-original-src="https://miro.medium.com/v2/resize:fit:888/format:webp/1*aYfDtocebpMkc-lZY99xVw.png"/></div></figure><h2 id="6bd7" class="mg mh jk bd mi mj mk dn ml mm mn dp mo li mp mq mr lm ms mt mu lq mv mw mx my bi translated">使标准化</h2><p id="d31d" class="pw-post-body-paragraph kz la jk lb b lc mz kl le lf na ko lh li nb lk ll lm nc lo lp lq nd ls lt lu in bi translated">在上面的例子中，显示绝对值不容易使我们理解两组之间的差异。更好的解决方案是显示每个组中唯一值的相对频率。</p><p id="628b" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们可以将<strong class="lb jl"> normalize </strong>参数添加到value_counts()中，以这种方式显示值。</p><pre class="ne nf ng nh gu ni ly nj nk aw nl bi"><span id="08d3" class="mg mh jk ly b gz nm nn l no np">data['No-show'].groupby(data['Gender']).value_counts(normalize=True)</span></pre><figure class="ne nf ng nh gu iw gi gj paragraph-image"><div class="gi gj nv"><img src="../Images/4df1876fbf77328ed593883ffcb1b828.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*y3iS5JmIjHadAPJrAjSB1Q.png"/></div></figure><h2 id="35d5" class="mg mh jk bd mi mj mk dn ml mm mn dp mo li mp mq mr lm ms mt mu lq mv mw mx my bi translated">扔掉</h2><p id="8bd7" class="pw-post-body-paragraph kz la jk lb b lc mz kl le lf na ko lh li nb lk ll lm nc lo lp lq nd ls lt lu in bi translated">对于有大量唯一值的列，value_counts()函数的输出并不总是特别有用。一个很好的例子是年龄列，我们在这篇文章的前面显示了它的值。</p><p id="ba12" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">幸运的是，value_counts()有一个<strong class="lb jl">bin</strong>参数。此参数允许我们以整数形式指定箱(或我们想要将数据分成的组)的数量。在下面的例子中，我添加了<code class="fe lv lw lx ly b"><strong class="lb jl">bins=5</strong></code>来将年龄分为5组。我们现在有了每个箱中的值的计数。</p><pre class="ne nf ng nh gu ni ly nj nk aw nl bi"><span id="3b01" class="mg mh jk ly b gz nm nn l no np">data['Age'].value_counts(bins=5)</span></pre><figure class="ne nf ng nh gu iw gi gj paragraph-image"><div class="gi gj nw"><img src="../Images/744b68328c60064028607562020843bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*gveURlwKw_J65exnIswOyQ.png"/></div></figure><p id="cb64" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">同样，显示绝对数字并不是特别有用，所以让我们也添加<code class="fe lv lw lx ly b">normalize=True</code>参数。现在我们有了一个有用的分析。</p><pre class="ne nf ng nh gu ni ly nj nk aw nl bi"><span id="bd3a" class="mg mh jk ly b gz nm nn l no np">data['Age'].value_counts(bins=5, normalize=True)</span></pre><figure class="ne nf ng nh gu iw gi gj paragraph-image"><div class="gi gj nx"><img src="../Images/634ba25be99078392e4db9d8ce8d001b.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*TL1GypGqbEEJ3lboW2NZUQ.png"/></div></figure><h2 id="23b3" class="mg mh jk bd mi mj mk dn ml mm mn dp mo li mp mq mr lm ms mt mu lq mv mw mx my bi translated">与nlargest()结合使用</h2><p id="4428" class="pw-post-body-paragraph kz la jk lb b lc mz kl le lf na ko lh li nb lk ll lm nc lo lp lq nd ls lt lu in bi translated">在我们的数据集中还有其他列有大量的唯一值，宁滨仍然不能为我们提供有用的分析。一个很好的例子就是<strong class="lb jl">邻域</strong>列。</p><p id="2ce9" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">如果我们简单地对此运行value_counts()，我们会得到一个不是特别有见地的输出。</p><pre class="ne nf ng nh gu ni ly nj nk aw nl bi"><span id="1d3c" class="mg mh jk ly b gz nm nn l no np">data['Neighbourhood'].value_counts(sort=True)</span></pre><figure class="ne nf ng nh gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj ny"><img src="../Images/b1f36753beaaec15b6d5ed14ff07cefa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qflfxj5n5KOsb2skPaO_SQ.png"/></div></div></figure><p id="6b73" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">展示这一点的更好方法可能是查看排名前10位的社区。我们可以通过结合另一个名为<code class="fe lv lw lx ly b"><strong class="lb jl">nlargest()</strong></code>的熊猫函数来做到这一点，如下所示。</p><pre class="ne nf ng nh gu ni ly nj nk aw nl bi"><span id="caca" class="mg mh jk ly b gz nm nn l no np">data['Neighbourhood'].value_counts(sort=True).nlargest(10)</span></pre><figure class="ne nf ng nh gu iw gi gj paragraph-image"><div class="gi gj nz"><img src="../Images/68eff86f1924af3305041be5e6712cf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*7jSubjQi0y97GmdUMzaUug.png"/></div></figure><p id="d406" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们还可以使用<code class="fe lv lw lx ly b"><strong class="lb jl">nsmallest()</strong></code>来显示排名最末的10个街区，这可能也很有用。</p><pre class="ne nf ng nh gu ni ly nj nk aw nl bi"><span id="6976" class="mg mh jk ly b gz nm nn l no np">data['Neighbourhood'].value_counts(sort=True).nsmallest(10)</span></pre><figure class="ne nf ng nh gu iw gi gj paragraph-image"><div class="gi gj oa"><img src="../Images/0b3b6f584d3b4bb37307edbb8009a2e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*duYfcWbNH_WuobChy5PxUA.png"/></div></figure><h2 id="6982" class="mg mh jk bd mi mj mk dn ml mm mn dp mo li mp mq mr lm ms mt mu lq mv mw mx my bi translated">测绘</h2><p id="86df" class="pw-post-body-paragraph kz la jk lb b lc mz kl le lf na ko lh li nb lk ll lm nc lo lp lq nd ls lt lu in bi translated">另一个方便的组合是Pandas绘图功能和value_counts()。将我们从value_counts()获得的分析显示为可视化的能力可以使查看趋势和模式变得容易得多。</p><p id="03e7" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们可以显示以上所有的例子，以及Pandas库中可用的大多数绘图类型。可用选项的完整列表可在<a class="ae jh" href="https://pandas.pydata.org/pandas-docs/version/0.23.4/generated/pandas.DataFrame.plot.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="cb63" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">让我们看几个例子。</p><p id="56c2" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们可以使用条形图来查看排名前10的社区。</p><pre class="ne nf ng nh gu ni ly nj nk aw nl bi"><span id="5f75" class="mg mh jk ly b gz nm nn l no np">data['Neighbourhood'].value_counts(sort=True).nlargest(10).plot.bar()</span></pre><figure class="ne nf ng nh gu iw gi gj paragraph-image"><div role="button" tabindex="0" class="ix iy di iz bf ja"><div class="gi gj ob"><img src="../Images/9cc0409e2f396f44882282e889717b09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0AK3wwB5t79F8q2nl-wP-A.png"/></div></div></figure><p id="d885" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我们可以制作一个饼图来更好地显示性别栏。</p><pre class="ne nf ng nh gu ni ly nj nk aw nl bi"><span id="e649" class="mg mh jk ly b gz nm nn l no np">data['Gender'].value_counts().plot.pie()</span></pre><figure class="ne nf ng nh gu iw gi gj paragraph-image"><div class="gi gj oc"><img src="../Images/f23f521acc9abbd575ad0530f1334884.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*4JKEvYgqlm_wGwq7PHAlvg.png"/></div></figure></div><div class="ab cl lz ma hy mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="in io ip iq ir"><p id="8870" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">value_counts()函数通常是我进行数据分析的第一个起点，因为它使我能够非常快速地绘制趋势图，并从数据集中的各个列中获得洞察力。本文已经给出了可以使用该函数的各种类型的分析的快速概述，但是该函数有更多的用途，超出了本文的范围。</p><p id="f314" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">感谢阅读！</p><p id="48b7" class="pw-post-body-paragraph kz la jk lb b lc ld kl le lf lg ko lh li lj lk ll lm ln lo lp lq lr ls lt lu in bi translated">我每月都会发一份简讯，如果你想加入，请点击此链接注册。期待成为您学习旅程的一部分！T3】</p></div></div>    
</body>
</html>