<html>
<head>
<title>Mastering Date and Time Manipulations with Python and Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 和 Pandas 掌握日期和时间操作</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/mastering-date-and-time-manipulations-with-python-and-pandas-e1cb2db8177a?source=collection_archive---------41-----------------------#2020-03-04">https://towardsdatascience.com/mastering-date-and-time-manipulations-with-python-and-pandas-e1cb2db8177a?source=collection_archive---------41-----------------------#2020-03-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="6969" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你不知道你不知道什么。</h2></div><p id="1b79" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有一句老话是这样说的:<em class="le">不管开发人员是初级还是高级，在处理日期时，他总是会参考文档。我同意，我的工作也是如此。有很多事情我可以不用引用的<strong class="kk iu">文档来实现，但是我最不擅长的是日期和时间操作，或者设法记住格式化代码。</strong></em></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/0eff2c377387a3690a78d79a87728ffc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*asgHJHzfXdFAFDfb"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">由<a class="ae lv" href="https://unsplash.com/@aronvisuals?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Aron Visuals </a>在<a class="ae lv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="3e70" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是我决定写一篇关于这个话题的文章的原因——我不觉得我在这种情况下是孤独的。</p><p id="70b8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">处理日期和时间并不难，但是肯定有很多事情需要记住。今天我们将讨论其中的大部分内容，以便您为下一个分析挑战做好准备。我们所做的一切要么在 Python 处理日期和时间的默认库中实现——方便地称为<code class="fe lw lx ly lz b">datetime</code>——要么在<strong class="kk iu"> Pandas </strong>中实现。</p><p id="16d4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是进口货:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/d4f60440dbf45ec86999d16231ed2fc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*38IfOqHSAsSfQvlNUb2DIQ.png"/></div></figure><p id="15a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">事不宜迟，让我们直接开始吧。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="3799" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">日期时间基础</h1><p id="aa9e" class="pw-post-body-paragraph ki kj it kk b kl na ju kn ko nb jx kq kr nc kt ku kv nd kx ky kz ne lb lc ld im bi translated">使用<code class="fe lw lx ly lz b">datetime</code>库，我们可以很容易地创建日期时间对象——如果您不关心小时、分钟和秒的信息，这里有一个如何创建日期时间对象的例子:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/0ec4a4e9b0937f800755c841c77811dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*6cpdnb6xjd38OPdHN98l4w.png"/></div></figure><p id="8466" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">或者，如果您确实关心这些，您可以很容易地指定值:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/882d4b2aa120c3d812bcb1f2f36dcece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*0pxez3kSCjuyzApQwKymVQ.png"/></div></figure><p id="d9bc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">也许你想知道现在的时间，精确到毫秒——你可以使用方便的<code class="fe lw lx ly lz b">.now()</code>功能:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/eea68b6deabc64d1f528e05549b78823.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*bFmsh32LZziahRgjFOOf0A.png"/></div></figure></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="2aca" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">时间增量</h1><p id="6d4d" class="pw-post-body-paragraph ki kj it kk b kl na ju kn ko nb jx kq kr nc kt ku kv nd kx ky kz ne lb lc ld im bi translated">让我们现在做一些不同的事情。我要声明一个变量，并将它的值设置为当前时间:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/3fcfa7e0338882197c44fa538d10a515.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*YUuOIU_gyyGifERQLkaKQA.png"/></div></figure><p id="cf3b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">稍后，我将声明另一个变量，并将其值设置为当前时间减去<code class="fe lw lx ly lz b">current_time</code>变量的值:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/1392397fde9d31d8fd2ca5b9632a5096.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*At4FS5uXniR4KLcUGP3TQA.png"/></div></figure><p id="f385" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以看到我们是如何返回这个<strong class="kk iu"> timedelta </strong>对象的，这表明在声明这两个变量之间经过了多长时间。您可以轻松访问这些信息:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/3ab8592cbb537cf1c1b1fa8e2b24cc67.png" data-original-src="https://miro.medium.com/v2/resize:fit:376/format:webp/1*GlgK22cp9lU8GHzpnOtVwA.png"/></div></figure><p id="e2b7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果要计算数据集中两个日期列之间的差异，这可能会很有用，例如，如果一列指示某个过程开始的时间，而另一列指示该过程结束的时间。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="0337" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">字符串到时间，反之亦然</h1><p id="10bf" class="pw-post-body-paragraph ki kj it kk b kl na ju kn ko nb jx kq kr nc kt ku kv nd kx ky kz ne lb lc ld im bi translated"><code class="fe lw lx ly lz b">datetime</code>库有两种更方便的方法将字符串记录转换成日期时间对象，或将日期时间对象转换成字符串。</p><p id="83dc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们探索第一个选项。您有一个字符串表示的时间信息，并希望将它转换成 datetime 对象，以便以后更快地操作(在这种情况下，实际上不能比较字符串)。在这种情况下，您将需要使用<code class="fe lw lx ly lz b">strptime()</code>功能:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/49876325da9a7fe5c26a8df27a2d7191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*UhLh01xP34A8mxsB1O_nsg.png"/></div></figure><p id="4e77" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你对格式感到困惑，看看这个网站，你会在那里找到所有的代码。</p><p id="9a3f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个过程可以反过来。假设您有日期信息，表示为 datetime，并且您需要以某种方式将值呈现给用户，比如说通过某种前端。<code class="fe lw lx ly lz b">strftime()</code>方法可以解决问题:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/0f81982c11492b4c83c61ccd6ded7cd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*omm-g5kAickNWBjIvAMz9w.png"/></div></figure><p id="e25d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，当我们有了这些工具，让我们探索一下<strong class="kk iu"> Pandas </strong>库提供了什么。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="73eb" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">熊猫的日期范围</h1><p id="eb8e" class="pw-post-body-paragraph ki kj it kk b kl na ju kn ko nb jx kq kr nc kt ku kv nd kx ky kz ne lb lc ld im bi translated">在处理日期的大部分时间里，我都在使用 Python 的<code class="fe lw lx ly lz b">datetime</code>库。唯一的例外情况是:</p><ul class=""><li id="869f" class="nn no it kk b kl km ko kp kr np kv nq kz nr ld ns nt nu nv bi translated">日期范围</li><li id="0331" class="nn no it kk b kl nw ko nx kr ny kv nz kz oa ld ns nt nu nv bi translated">时间重采样</li></ul><p id="0f2f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第二个问题需要一整篇文章来深入探讨，所以我将重点讨论第一个问题。</p><p id="9259" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我使用 Pandas 来创建日期范围，只是因为我想避免标准库的循环。如果你不确定我所说的“日期范围”是什么意思，这里有一个简短的例子。想法是从 2020 年 1 月 1 日开始创建一个 30 天的时间段:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/24bf65b518a837d014506d807dc03da2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*uTUSgaMVb9REuwT-zRx8dw.png"/></div></figure><p id="7e59" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你看到那有多容易了吗？T12】</p><p id="8365" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请记住，您不需要坚持某种特定的格式，因为 Pandas 很聪明，可以推断出这一点:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/ccab4d032eac784fe37f781100dfb778.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*ELKC8FgxVRjYptpgVK566A.png"/></div></figure><p id="eadf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这个也很好:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/2b31d47a92cadef7ee1d5dd1292fd5e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*aGlHrCkjt9Rkd9NnkYXMLg.png"/></div></figure><p id="6f91" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">即使是一些疯狂的组合也不成问题:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/f7aaca6a6efd7c7c38fcdbac62b1f3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*jlBTJGYkPWm3XGj88GBehA.png"/></div></figure></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><h1 id="c84d" class="mi mj it bd mk ml mm mn mo mp mq mr ms jz mt ka mu kc mv kd mw kf mx kg my mz bi translated">在你走之前</h1><p id="9459" class="pw-post-body-paragraph ki kj it kk b kl na ju kn ko nb jx kq kr nc kt ku kv nd kx ky kz ne lb lc ld im bi translated">Python 中的日期和时间声明和操作已经足够了。你可以做更高级的事情，但我发现这对大多数任务来说已经足够了。</p><p id="023e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你喜欢这篇文章，请继续关注，过几天我会发表一篇关于<strong class="kk iu">日期重采样</strong>和基于时间条件的高级数据过滤的文章。</p><p id="9c90" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读。</p></div><div class="ab cl mb mc hx md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="im in io ip iq"><p id="13e6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">喜欢这篇文章吗？成为</em> <a class="ae lv" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="le">中等会员</em> </a> <em class="le">继续无限制的学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="of og gp gr oh oi"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd iu gy z fp on fr fs oo fu fw is bi translated">通过我的推荐链接加入 Medium-Dario rade ci</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">medium.com</p></div></div><div class="or l"><div class="os l ot ou ov or ow lp oi"/></div></div></a></div></div></div>    
</body>
</html>