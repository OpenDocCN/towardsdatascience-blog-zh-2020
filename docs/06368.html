<html>
<head>
<title>Sentiment Analysis of Delhi Tweets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">德里推特的情感分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sentiment-analysis-of-delhi-tweets-877e060823b1?source=collection_archive---------43-----------------------#2020-05-21">https://towardsdatascience.com/sentiment-analysis-of-delhi-tweets-877e060823b1?source=collection_archive---------43-----------------------#2020-05-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/503dbaa36911f8fb5ca808f1aa768081.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F2bt003AndPVpBuxMoIOtw.jpeg"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">演职员表:莎拉·库菲斯，Unsplash</p></figure><div class=""/><div class=""><h2 id="38f6" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">估计推文中的正面/负面分数</h2></div><p id="5164" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">数据是一个比许多人认为的更广泛的术语。它不仅包含Excel文件或等效的结构化表格数据，还包含文本文件、音频文件、图片等非结构化数据。考虑到所有数据格式的详尽列表，可以很好地认识到结构化数据只是冰山一角。尤其是文本数据，可以在大多数主题中找到。</p><p id="8f6b" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">本文旨在使用关键词和特定位置的技术从Twitter上抓取推文。此外，我还将展示可以用来评估一条tweet的情绪的软件包。我感谢Twitter社区允许我们访问这些数据。使用的编程语言是Python 3.3，使用的IDE是Spyder 3.3.3。</p><h1 id="7d4d" class="lq lr jf bd ls lt lu lv lw lx ly lz ma kl mb km mc ko md kp me kr mf ks mg mh bi translated">检索推文</h1><p id="471c" class="pw-post-body-paragraph ku kv jf kw b kx mi kg kz la mj kj lc ld mk lf lg lh ml lj lk ll mm ln lo lp ij bi translated">Python提供了一些有趣的包来从Twitter中抓取tweets。GetOldTweets3就是这样一个包(我觉得它很方便，因为它很灵活)。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="5e38" class="mx lr jf mt b gy my mz l na nb">#Importing the Packages<br/>import pandas as pd<br/>import numpy as np<br/>import matplotlib.pyplot as plt<br/>import seaborn as sns<br/>import GetOldTweets3 as got</span><span id="7e3f" class="mx lr jf mt b gy nc mz l na nb">#Setting the Parameters<br/>text_query = 'coronavirus'<br/>location = 'Delhi'<br/> <br/>tweetCriteria = got.manager.TweetCriteria()<br/>.setQuerySearch(text_query).setNear(location)<br/>.setSince("2020-03-01").setUntil("2020-05-05")</span><span id="37ba" class="mx lr jf mt b gy nc mz l na nb">#Creating a list of all tweets<br/>tweets = got.manager.TweetManager.getTweets(tweetCriteria)</span><span id="e58e" class="mx lr jf mt b gy nc mz l na nb">#Creating list of chosen tweet data<br/>text_tweets = [[tweet.text] for tweet in tweets]<br/>text_date = [[tweet.date] for tweet in tweets]</span><span id="9ccb" class="mx lr jf mt b gy nc mz l na nb">tweets = pd.DataFrame(list(zip(text_date, text_tweets)), <br/>columns = ['Date', 'Tweet'])</span></pre><p id="daa1" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在导入基本的和必需的包之后，我们首先设置服务于我们目的的基本参数。这些参数包括:</p><p id="d516" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><em class="mn"> setQuerySearch </em>:一条推文应该包含的关键词或短语。</p><p id="ffa7" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><em class="mn"> setNear </em>:推文的参考位置。</p><p id="839a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><em class="mn"> setSince </em>:需要抓取推文的日期。</p><p id="05f7" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">set until:tweets需要被抓取的日期。</p><p id="49da" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">出于这个分析的目的，我将参考位置设置为<em class="mn">德里</em>，将文本查询设置为<em class="mn">冠状病毒</em>(因为这是人们目前在推特上谈论的主要内容)。开始日期设定为<em class="mn">2020–03–01</em>(2020年3月1日)至<em class="mn">2020–05–05</em>(2020年5月5日)。这是两个月多一点。</p><p id="c088" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">运行时间主要取决于tweets被抓取的数量和互联网速度。</p><p id="dfa8" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">一旦tweet被抓取，就会创建一个带有单独的日期和tweet列的数据框。该数据集包含37，135条推文和2列(日期和推文)。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="8430" class="mx lr jf mt b gy my mz l na nb">In [2]: tweets.shape<br/>Out[2]: (37135, 2)</span></pre><h1 id="158e" class="lq lr jf bd ls lt lu lv lw lx ly lz ma kl mb km mc ko md kp me kr mf ks mg mh bi translated">清理推文以供进一步分析</h1><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nd"><img src="../Images/b864dac828900fd4db46f6f5ee8d82ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4XmHid5s929KZYhtPcArWA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">Tweets预清理</p></figure><p id="9787" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">一旦创建了基本的数据框架，清理推文以供进一步分析就变得非常重要。这包括删除不必要的括号、撇号、用户名等。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="ecac" class="mx lr jf mt b gy my mz l na nb">#Cleaning the Tweets</span><span id="864b" class="mx lr jf mt b gy nc mz l na nb">from nltk.corpus import stopwords<br/>date = []<br/>tweet = []<br/>words = set(nltk.corpus.words.words())<br/>for i in range(0,len(tweets)):<br/> date.append(tweets.iloc[i,0])<br/> string = tweets.iloc[i,1]<br/> string = re.sub(r”http\S+”, “”, string) #Removes Hyperlink<br/> string = re.sub(‘@[^\s]+’,’’,string) #Removes Usernames<br/> string = re.sub(‘#[^\s]+’,’’,string) #Removes Hashtags<br/> tweet.append(string.strip(“[“).strip(“]”))</span><span id="0f57" class="mx lr jf mt b gy nc mz l na nb">new_tweet = pd.DataFrame(list(zip(date, tweet)), columns = [‘Date’, ‘Tweet’])</span></pre><p id="f929" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">上面几行代码删除了特殊字符和短语，如标签、超链接、用户名和括号。最后，我们得到一个相对干净的数据框架。</p><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ne"><img src="../Images/def92c3445544bd4e17793ea0c8883ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w0soQKitAkE5RKgvQSEBCg.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">清理后的推文</p></figure><h1 id="2a42" class="lq lr jf bd ls lt lu lv lw lx ly lz ma kl mb km mc ko md kp me kr mf ks mg mh bi translated">寻找推文的情感分数</h1><p id="10d7" class="pw-post-body-paragraph ku kv jf kw b kx mi kg kz la mj kj lc ld mk lf lg lh ml lj lk ll mm ln lo lp ij bi translated">Python提供了多个包来评估文本的情感。在这个实例中使用的包是<em class="mn">Vader perspection。更多关于这个包的信息可以在找到。</em></p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="6519" class="mx lr jf mt b gy my mz l na nb">#Checking the Polarity<br/>from vaderSentiment.vaderSentiment import SentimentIntensityAnalyzer<br/>sent = SentimentIntensityAnalyzer()<br/>sentiment_dict = []<br/>for i in range(0,len(new_tweet)):<br/> sentiment_dict.append(sent.polarity_scores(new_tweet.iloc[i,1]))</span><span id="318f" class="mx lr jf mt b gy nc mz l na nb">positive = []<br/>neutral = []<br/>negative = []<br/>compound = []<br/>for item in sentiment_dict:<br/> positive.append(item[‘pos’])<br/> neutral.append(item[‘neu’])<br/> negative.append(item[‘neg’])<br/> compound.append(item[‘compound’])</span><span id="198c" class="mx lr jf mt b gy nc mz l na nb">sentiment_df = pd.DataFrame(list(zip(positive, neutral, negative, compound)), columns = [‘Positive’, ‘Neutral’, ‘Negative’, ‘Compound’])<br/> <br/>new_tweet[‘Positive’] = sentiment_df[‘Positive’]<br/>new_tweet[‘Negative’] = sentiment_df[‘Negative’]<br/>new_tweet[‘Neutral’] = sentiment_df[‘Neutral’]<br/>new_tweet[‘Compound’] = sentiment_df[‘Compound’]</span></pre><p id="c1ba" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><em class="mn">Vader perspection</em>以字典的形式返回输出，包含4个键(<em class="mn"> pos，neu，neg，compound </em>)。<em class="mn"> pos、neu </em>和<em class="mn"> neg </em>的值介于0和1之间，0表示不具有该词的任何特征，1表示很可能是<em class="mn">正面、负面或中性评论。</em>最后一项<em class="mn">复合</em>表示根据<em class="mn"> pos、neu </em>和<em class="mn"> neg </em>得分计算的范围(-1，1)内的最终得分。</p><p id="31f4" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">运行代码，我们得到以下输出:</p><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ng"><img src="../Images/834b6ed45411fda6a3730e61cdfa5c65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QhmEWIS6lp9jckde6atf3g.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">情感得分</p></figure><p id="3864" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">让我们讨论上面输出中的一些实例。</p><p id="1705" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">索引11上的推文:推文是用印地语写的。因此，该算法无法为其分配任何情感，并且默认给出完美的<em class="mn">中性</em>分数。</p><p id="103a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">指数4上的推文:空白推文被分配一个完美的<em class="mn">中性</em>分数。</p><p id="ed85" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">索引12上的推文:用英语写的印地语推文也被分配为<em class="mn">中性。</em></p><p id="5864" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">有许多推文是用印地语写的，因为参考地点是德里。反击的一个方法是删除所有中立的推文。这符合逻辑，因为我们主要关注的是正面和负面的推文。</p><pre class="mo mp mq mr gt ms mt mu mv aw mw bi"><span id="4d6a" class="mx lr jf mt b gy my mz l na nb">#Removing all the neutral comments<br/>wf_tweet = new_tweet.loc[new_tweet[‘Neutral’] != 1].reset_index()<br/>wf_tweet = wf_tweet.drop(‘index’, axis = 1)</span></pre><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nh"><img src="../Images/aa69bf157e9aa9577e6fba823aa2efb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kdv5ZU6DIp_ghJWrg1TXtA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">最终输出</p></figure><p id="7ccb" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们现在已经给所有的推文分配了情感分数。具有负<em class="mn">复合</em>值的推文描绘负面情绪，而具有正<em class="mn">复合</em>值的推文描绘正面情绪。</p><p id="b1aa" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们现在可以将<em class="mn">复合</em>值分为正值和负值。</p><figure class="mo mp mq mr gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ni"><img src="../Images/d135134a32f7abe4c8a8a21861369165.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uTkASxOsmAQVJ7YrzewYMA.png"/></div></div><p class="iz ja gj gh gi jb jc bd b be z dk translated">输出</p></figure><h1 id="8f50" class="lq lr jf bd ls lt lu lv lw lx ly lz ma kl mb km mc ko md kp me kr mf ks mg mh bi translated">结论</h1><p id="bf81" class="pw-post-body-paragraph ku kv jf kw b kx mi kg kz la mj kj lc ld mk lf lg lh ml lj lk ll mm ln lo lp ij bi translated">我们有一个如上给出的最终输出。可以对数据框进行进一步分析，以挖掘信息，从而有趣地洞察德里(印度)民众对冠状病毒的看法。<em class="mn">日期</em>列可以证明是一个重要的属性，也可以看出人们的态度/情绪是如何随时间变化的。根据情绪得分，人们还可以发现哪些标签在负面和正面的推文中使用最多。然而，这种分析超出了本文的范围。</p><p id="e419" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><em class="mn">感谢您的阅读。我真诚地希望它对你有所帮助，我一如既往地欢迎讨论和建设性的反馈。</em></p><p id="7978" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">给我发邮件:<strong class="kw jg">icy.algorithms@gmail.com</strong></p><p id="c8f9" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">你可以在<a class="ae nf" href="https://www.linkedin.com/company/enka-analytics/?viewAsMember=true" rel="noopener ugc nofollow" target="_blank">领英</a>上找到我。</p><p id="bf57" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jg"> <em class="mn">编者按:</em> </strong> <em class="mn"> </em> <a class="ae nf" href="http://towardsdatascience.com" rel="noopener" target="_blank"> <em class="mn">走向数据科学</em> </a> <em class="mn">是一份以数据科学和机器学习研究为主的中型刊物。我们不是健康专家或流行病学家，本文的观点不应被解释为专业建议。想了解更多关于疫情冠状病毒的信息，可以点击</em> <a class="ae nf" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports" rel="noopener ugc nofollow" target="_blank"> <em class="mn">这里</em> </a> <em class="mn">。</em></p></div></div>    
</body>
</html>