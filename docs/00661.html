<html>
<head>
<title>Python Stock Analysis — Balance Sheet Trend Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python股票分析-资产负债表趋势分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-stock-analysis-balance-sheet-trend-analysis-18e6eb63cdc?source=collection_archive---------13-----------------------#2020-01-19">https://towardsdatascience.com/python-stock-analysis-balance-sheet-trend-analysis-18e6eb63cdc?source=collection_archive---------13-----------------------#2020-01-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e2ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了分析我感兴趣的任何公司的股票，我曾经在Excel中预先构建了大量的Excel模板。我的旧流程简单但效率低下，我会选择一些公司，查看年度报告，或者在最好的情况下，查看雅虎财经，以获取我的Excel模板所需的所有输入。最终，这是一个非常耗时的手动过程。</p><h2 id="cfa2" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">手动收集财务数据需要大量的工作，这使我无法在分析部分花费更多的时间。这是学习Python和Pandas的原因之一，并且尽可能地自动化所有的数据收集过程。</h2><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/0a8c8a384c765a8b949bde800e97b30b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*D7J9ErUG_GCGEx5s7BPtXg.jpeg"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">来源:Pixabay，via Pexels</p></figure><p id="f551" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我能够完全自动化我所有的股票分析之前，我花了几个月的时间达到Python和Pandas的良好水平。然而，这完全值得。现在，我只需写下我想分析的任何公司的名称，几秒钟后，结果就显示在我眼前。</p><p id="5848" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我想与你分享所有这些分析，并希望你能从中受益。在这篇文章中，我将向你展示如何用Python进行资产负债表趋势分析。</p><blockquote class="lq lr ls"><p id="fbbd" class="jn jo lt jp b jq jr js jt ju jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj kk ij bi translated">资产负债表趋势分析将显示每个资产负债表项目占总资产的百分比。这是比较资产负债表项目变化和分析长期趋势的非常有用的工具。</p></blockquote><p id="e72a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">除了中等的故事，我在Youtube上还有一个视频教程系列(<a class="ae lx" href="https://www.youtube.com/playlist?list=PLnzr8Oa9VylaswbINaepu7_IaY2phKb1S" rel="noopener ugc nofollow" target="_blank"> Python for Finance </a>)，在那里我一行一行地解释如何为一些分析开发代码。如果对下面分享的代码有什么不清楚的地方，请随时访问Youtube上的视频教程:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="acd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们来看代码。下面的脚本非常简单，只需要我们几分钟就可以写完。我们将使用Pandas、Requests和Json库。我们将从名为<a class="ae lx" href="https://financialmodelingprep.com/developer/docs/" rel="noopener ugc nofollow" target="_blank">金融建模准备</a>的API中提取数据。它是一个免费的API，拥有丰富的财务数据。</p><p id="98d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们首先导入<em class="lt"> Pandas、request和JSON </em>，并对<em class="lt">财务建模准备API端点</em>进行<em class="lt"> get </em>调用，这将返回我们通过get请求传递的任何公司的资产负债表信息。在这个例子中，我们将通过传递苹果公司的股票代码从苹果公司获取数据。然后，我们将数据转换成Json格式:</p><pre class="lf lg lh li gt ma mb mc md aw me bi"><span id="1fab" class="kl km iq mb b gy mf mg l mh mi">import pandas as pd<br/>import requests<br/>import json</span><span id="e868" class="kl km iq mb b gy mj mg l mh mi">bs = requests.get(f'https://financialmodelingprep.com/api/v3/financials/balance-sheet-statement/AAPL?period=quarter')</span><span id="a81f" class="kl km iq mb b gy mj mg l mh mi">bs = bs.json()</span></pre><p id="3d56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们需要解析存储在变量<em class="lt"> bs中的字典。</em>所需数据包含在一个名为<em class="lt"> financials的字典中。</em>然后，我们使用<em class="lt">Pandas DataFrame . from _ dict</em>方法将我们的字典转换成Pandas data frame。因为我们希望Pandas数据框架将数据资产负债表项目显示为行项目，所以我们将转置它。</p><pre class="lf lg lh li gt ma mb mc md aw me bi"><span id="6b43" class="kl km iq mb b gy mf mg l mh mi">bs = bs[‘financials’]</span><span id="c0a8" class="kl km iq mb b gy mj mg l mh mi">bs = pd.DataFrame.from_dict(bs)</span><span id="d2fd" class="kl km iq mb b gy mj mg l mh mi">bs = bs.T</span><span id="64e9" class="kl km iq mb b gy mj mg l mh mi">bs.columns = bs.iloc[0]</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mk"><img src="../Images/01d51508394353c27a01c576b76c7772.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZuTy3DM3YDObVtVDB5feDw.png"/></div></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">Python for Finance —检索资产负债表</p></figure><p id="a357" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们的熊猫数据框看起来和上面的图片一模一样。我们还需要再写几行代码来清理它，并显示资产负债表中每个项目占总资产的百分比。</p><p id="657f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们用下面的代码来做这件事。首先，我将所有的列存储在一个名为<em class="lt"> cols </em>的变量中。然后，我删除重复的第一行，仅保留4列和12行(即，前4列是4个最近的财务季度，并将删除第12行之后的负债和权益)。</p><p id="72fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们将列从<em class="lt">对象</em>转换为<em class="lt">浮动</em>，以便能够执行数学运算。你可以随时参考上面的Youtube视频，以防万一。</p><pre class="lf lg lh li gt ma mb mc md aw me bi"><span id="9277" class="kl km iq mb b gy mf mg l mh mi">cols = bs.columns</span><span id="2136" class="kl km iq mb b gy mj mg l mh mi">bs = bs.iloc[1:,]</span><span id="bccd" class="kl km iq mb b gy mj mg l mh mi">bs = bs.iloc[:12,:4]</span><span id="a0a1" class="kl km iq mb b gy mj mg l mh mi">cols = bs.columns</span><span id="8c93" class="kl km iq mb b gy mj mg l mh mi">bs[cols] = bs[cols].apply(pd.to_numeric, errors=’coerce’)</span></pre><p id="3869" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的熊猫数据框架开始变得更好看了。我们拥有苹果公司过去4个季度的所有资产:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mp"><img src="../Images/1eab2c707a2c5e89b09bb262d37386d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RHDPOX8WgC1gXK5v6TgRtw.png"/></div></div></figure><p id="7a4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了完成我们的脚本，我们只需要将一个季度的每个资产负债表项目除以该季度的总资产。让我们快点做那件事。</p><p id="ab3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们使用<em class="lt"> iloc[row，col]从每个季度提取<em class="lt">总资产</em>数字。然后，我们创建一个名为<em class="lt"> allassets的列表。</em>最后，我们将资产负债表的每个项目除以总资产再乘以100，以百分比的形式显示出来:</em></p><pre class="lf lg lh li gt ma mb mc md aw me bi"><span id="252c" class="kl km iq mb b gy mf mg l mh mi">assetsQ1 = bs.iloc[11,0]</span><span id="0963" class="kl km iq mb b gy mj mg l mh mi">assetsQ2 = bs.iloc[11,1]</span><span id="309d" class="kl km iq mb b gy mj mg l mh mi">assetsQ3 = bs.iloc[11,2]</span><span id="2b40" class="kl km iq mb b gy mj mg l mh mi">assetsQ4 = bs.iloc[11,3]</span><span id="1cfc" class="kl km iq mb b gy mj mg l mh mi">allassets = [assetsQ1,assetsQ2,assetsQ3,assetsQ4]</span><span id="09b0" class="kl km iq mb b gy mj mg l mh mi">bs[cols] = (bs[cols] / allassets)*100</span><span id="e061" class="kl km iq mb b gy mj mg l mh mi">pd.options.display.float_format = ‘{:.2f}%’.format</span></pre><p id="257b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们的分析完全自动化。现在，通过查看资产负债表趋势分析，我们可以很快看到，苹果去年一直在积累现金。从6月到9月，应收账款几乎翻了一番，长期投资有所减少。你可以根据这个趋势得出自己的结论。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mq"><img src="../Images/3813ef9bd704008ec5d107dee6dc4fa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X4t0hgaiPdFEELRpTOS7pg.png"/></div></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">用Python进行资产负债表趋势分析</p></figure><p id="7fc1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">请注意，我们可以为任何其他公司重用该分析，只需在代码开头将传递给get请求的url中的url ticker从<em class="lt"> AAPL </em>替换为任何其他公司。</strong></p></div></div>    
</body>
</html>