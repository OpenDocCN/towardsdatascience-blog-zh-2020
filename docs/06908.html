<html>
<head>
<title>Are You Really Taking Care of Overfitting?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你真的在照顾过度合身吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/are-you-really-taking-care-of-overfitting-b7f5cc893838?source=collection_archive---------59-----------------------#2020-05-28">https://towardsdatascience.com/are-you-really-taking-care-of-overfitting-b7f5cc893838?source=collection_archive---------59-----------------------#2020-05-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0653" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如果你的回答是“是的，我使用过提前停止”，你可能想看看这个</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5fe6754f62b65869cb305437613d5160.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O1jU_5bJBNxTcvqhDpS0Kw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">过度合身就像试着穿一套为别人量身定做的衣服。图片来源:<a class="ae ky" href="https://www.freepik.com/free-photo/yellow-tape-measure-blue-background_4886566.htm#page=1&amp;query=tape%20measure&amp;position=17" rel="noopener ugc nofollow" target="_blank"> Freepik </a></p></figure><p id="2cdb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi lv translated"><span class="l lw lx ly bm lz ma mb mc md di"> Y </span>你坐在一个满是数据科学家的酒吧里，无意中听到了下面这段对话:</p><blockquote class="me"><p id="f557" class="mf mg it bd mh mi mj mk ml mm mn lu dk translated">-等一下！你解决了过度装配的问题了吗？</p><p id="d3ac" class="mf mg it bd mh mi mj mk ml mm mn lu dk translated">-是的，我用过早停。</p></blockquote><p id="b093" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">即使你对机器学习一无所知，但你会说英语，你也能推断出两件事。首先，存在一种叫做“过度拟合”的不好的东西。第二，过度拟合可以用一种叫做“提前停止”的方法来克服。</p><p id="5f6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这不仅仅是酒吧里的谈资。如果你翻阅<a class="ae ky" href="https://www.amazon.com/Deep-Learning-Adaptive-Computation-Machine/dp/0262035618/ref=as_li_ss_tl?_encoding=UTF8&amp;qid=&amp;sr=&amp;linkCode=sl1&amp;tag=inspiredalgor-20&amp;linkId=e4e32749958369afb667e7e4323d65ba&amp;language=en_US" rel="noopener ugc nofollow" target="_blank">深度学习的圣经</a>，在第 425 页你会读到“早停应该几乎普遍使用”(Goodfellow)。在数据科学中，并不是每天都能听到“普遍”这个词。所以，你可能会相信提前停止是适配过度的哲人之石。但是，不幸的是，<a class="ae ky" href="https://harrypotter.fandom.com/wiki/Nicolas_Flamel" rel="noopener ugc nofollow" target="_blank">尼可·勒梅</a>从未致力于机器学习。</p><blockquote class="me"><p id="0456" class="mf mg it bd mh mi mj mk ml mm mn lu dk translated">提前停止是机器学习实践者最大的错觉之一。</p></blockquote><p id="2416" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">事实上，许多人认为，通过使用这种技术，他们变得对过度拟合免疫。遗憾的是，事实并非如此。事实上，经常发生的情况是，你使用早期停止，但是你最终得到一个严重过度拟合的模型。</p><p id="baf0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将使用著名的蘑菇数据集(可在<a class="ae ky" href="https://www.kaggle.com/uciml/mushroom-classification" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上获得)来展示这是多么容易发生。此外，我们将观察过度配合在实践中会造成什么样的损害。</p><p id="2518" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以下是段落列表:</p><ol class=""><li id="e2d0" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated"><strong class="lb iu">什么是过度拟合？</strong></li><li id="91dc" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated"><strong class="lb iu">什么是提前停止？</strong></li><li id="254c" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated"><strong class="lb iu">树林中的数据科学家</strong></li><li id="012c" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated"><strong class="lb iu">约翰尼·德普谬论</strong></li><li id="f457" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated"><strong class="lb iu">德怀特家的晚餐</strong></li><li id="670b" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated"><strong class="lb iu">收尾</strong></li></ol><h1 id="7f74" class="nh ni it bd nj nk nl nm nn no np nq nr jz ns ka nt kc nu kd nv kf nw kg nx ny bi translated">1.什么是过度拟合？</h1><blockquote class="me"><p id="9a18" class="mf mg it bd mh mi mj mk ml mm mn lu dk translated">过度拟合是预测模型无法将它从一些数据 A(“训练数据”)学到的东西推广到一些新数据 B(“测试数据”)。</p></blockquote><p id="f74c" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">例如，假设你给一个模型 100，000 张猫的肖像和 100，000 张狗的肖像(训练数据),让它学会区分猫和狗。然后，你拿一万张新的猫狗肖像(测试数据)，让模型给它们贴上标签。如果模型在测试数据上的表现不如在训练数据上的表现，则意味着您的模型不能进行归纳。</p><p id="f8cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，如果一个预测模型不能很好地处理新的(看不见的)数据，那么拥有一个预测模型首先有什么意义呢？如果不危险的话，过度拟合会使模型无用。这就是为什么它是任何数据科学家都必须处理的最大问题之一。</p><p id="4d5b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是数据科学家是聪明人，所以他们已经找到了防止过度拟合的方法。这些方法被称为“正则化技术”。</p><h1 id="94fd" class="nh ni it bd nj nk nl nm nn no np nq nr jz ns ka nt kc nu kd nv kf nw kg nx ny bi translated">2.什么是早停？</h1><p id="980f" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">早期停止是一种用于对抗过度拟合的正则化技术。它是“<strong class="lb iu">大概是深度学习中最常用的正则化形式</strong><em class="oe">”</em>(<a class="ae ky" href="https://www.amazon.com/Deep-Learning-Adaptive-Computation-Machine/dp/0262035618/ref=as_li_ss_tl?_encoding=UTF8&amp;qid=&amp;sr=&amp;linkCode=sl1&amp;tag=inspiredalgor-20&amp;linkId=e4e32749958369afb667e7e4323d65ba&amp;language=en_US" rel="noopener ugc nofollow" target="_blank">深度学习</a>，247 页)<em class="oe">。它是如此简单、有效且无副作用，以至于 Hinton、Bengio 和 LeCun 称之为“<a class="ae ky" href="https://aiatadams.files.wordpress.com/2016/02/bengio-lecun-20151207-deep-learning-tutorial-nips.pdf" rel="noopener ugc nofollow" target="_blank">一顿美好的免费午餐</a>”。</em></p><p id="8bbc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，早期停止可以应用于通过后续迭代训练的任何预测模型，例如具有梯度下降的逻辑回归、梯度推进算法、神经网络等。</p><p id="0192" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们看一个在迭代培训过程中培训和测试<em class="oe"> (*) </em>表现的典型例子。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/04bc385244c74ad2c6f793e51667b9f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*whcC5nvlXh9KN0B_BiPeWw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">说明提前停止是如何工作的</p></figure><p id="6a5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以看出，训练数据的性能不断提高。这是为什么呢？因为——随着迭代一个接一个地成功——模型对训练数据越来越“定制”。相反，测试数据的性能会提高到一定程度，然后开始下降。</p><p id="812d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">提前停止的功能正是利用了这种行为。提前停止意味着<strong class="lb iu">在测试集</strong>上获得最佳分数时(在这种情况下，在第 77 次迭代时)采用该模型。通过这样做，我们将不会浪费时间进行不必要的迭代，我们将拥有一个在看不见的数据上工作良好的模型。</p><p id="8075" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很神奇，不是吗？嗯，提前停止是强大的，但并不可靠。我们来看看为什么。</p><p id="3e1e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="oe"> (*)为了简单起见，在本文中，我将不适当地使用术语“测试”数据来代替“验证”数据</em></p><h1 id="afb9" class="nh ni it bd nj nk nl nm nn no np nq nr jz ns ka nt kc nu kd nv kf nw kg nx ny bi translated">3.树林中的数据科学家</h1><p id="e51a" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">Dwight 是一名数据科学家。由于他计划下周末去采蘑菇，他已经从 Kaggle 下载了<a class="ae ky" href="https://www.kaggle.com/uciml/mushroom-classification" rel="noopener ugc nofollow" target="_blank">蘑菇数据集</a>。Dwight 的目标是提出一个预测模型，能够根据蘑菇的特性告诉他蘑菇是否有毒。</p><p id="ce81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据集由 8124 个蘑菇组成。对于每种蘑菇，记录了 22 种不同的特征(如气味、菌盖形状、菌盖颜色等)。目标变量是蘑菇是可食用的还是有毒的。该数据集有一些特点:</p><ul class=""><li id="7ad6" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu og mz na nb bi translated">所有 22 个特征都是绝对的；</li><li id="a17b" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu og mz na nb bi translated">它们都由少数独特的价值观组成。</li></ul><p id="c5fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这使得数据集几乎不会过度拟合。</p><p id="2a89" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">德怀特意识到，如果他建立了一个糟糕的模型，他可能会因蘑菇中毒而住院。因此，他希望他的测试集非常可靠。因此，他只将 33%的数据放在训练集中，其余 67%放在测试集中。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/08fa660c916cfd40bddf64a471e34f41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8JKPP--2F4PCSLxedNN8-w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">德怀特数据帧的形状</p></figure><p id="eebe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是德怀特的训练集的样子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/aa5bfc28acf26fcd8d90fab2be883679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uOtQPUqaC8u8-YvkCjXZWg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">训练数据帧的前五行和前十列</p></figure><p id="0ca4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是的，你没看错。德怀特<strong class="lb iu">不小心忘记了特征中的行索引</strong>！这个男孩如此心不在焉。然而，这个错误应该不会造成太大的伤害。事实上，由于 Dwight 将使用一些正则化技术，模型应该自动忽略“ROW_INDEX ”,因为它会导致过多的过拟合。</p><p id="93d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于所有的特征(除了一个)都是分类的，Dwight 选择使用<a class="ae ky" href="https://catboost.ai/" rel="noopener ugc nofollow" target="_blank"> Catboost </a>，这是一种非常强大的算法，正是为了处理分类特征而诞生的。为了使模型防弹，德怀特还决定包括早期停止，他认为这应该足以避免过度拟合。</p><p id="540d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在设置了一些他认为合适的超参数后，Dwight 启动 catboost 分类器:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/430456d8f2e97b4308155dfa863bfe33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LlNF2DQ9aDiIoM7Bs-3pug.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Dwight 用于训练其模型的 Python 脚本</p></figure><h1 id="5406" class="nh ni it bd nj nk nl nm nn no np nq nr jz ns ka nt kc nu kd nv kf nw kg nx ny bi translated">4.约翰尼·德普谬论</h1><p id="ba5e" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">这就是 Dwight 的模型在每次迭代中对训练数据和测试数据的表现。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/326e0e14369bd7698dfc06750a234f6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YiewQ7hEMVrunaYJ3DlRFw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Dwight 模型在每次迭代中的训练和测试性能</p></figure><p id="da8e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这个数字是一个明显的例子，说明为什么早停并不像许多人认为的那样不可战胜。</p><blockquote class="me"><p id="b7a5" class="mf mg it bd mh mi mj mk ml mm mn lu dk translated">早期停止着眼于测试性能发生了什么，但它没有说训练性能。然而，过度拟合是由两者之间的关系给出的。</p></blockquote><p id="b620" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">事实上，在最后一次迭代中，该模型在训练集和测试集上的平均精度分别达到了 94%和 79%。这两个数字之间存在巨大差异，这是<strong class="lb iu">过度拟合</strong>的一个非常明显的迹象。</p><p id="5758" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但德怀特不在乎。“毕竟——他认为——79%的测试成绩并没有那么糟糕”。他是这么看的:</p><blockquote class="me"><p id="859e" class="mf mg it bd mh mi mj mk ml mm mn lu dk translated">“唯一重要的是测试集上的性能。谁在乎超配，只要我能有个好的考试成绩就行了？”</p></blockquote><p id="40b6" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我打赌你以前听过这种说法。事实上，在机器学习的世界里，存在一种普遍的倾向，即只关注测试表现，而完全忽视训练表现。这就是我所谓的“T2”约翰尼·德普谬论“T3”。</p><p id="3a1f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这和强尼·德普有什么关系？</p><p id="02fd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">想象你是一个电影制片人。你的下一部电影需要一名男主角，你开始四处寻找，直到你有了一个想法:约翰尼·德普将是那个角色的完美人选。因为你是彻底的家伙，所以你做足了功课，查了他的一些电影的票房，比如《Mortdecai》(4700 万美元)、《Black Mass》(1 亿美元)、《独行侠》(2.6 亿美元)。现在，你可能会想“哇，那可是一大笔钱啊！约翰尼·德普绝对是个不错的选择。”</p><p id="5173" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是你没有考虑电影预算。换句话说，这项投资值得吗？事实上，约翰尼·德普已经连续两年成为“T4 片酬最高的演员”。这意味着与他的电影票房相比，他的片酬太高了。如果你只关注票房，你就看不到真正重要的东西:投资回报。</p><p id="97e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这如何应用于机器学习？</p><p id="9d1a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如电影行业一样，在机器学习中，考虑投资回报也很重要。在机器学习中，<strong class="lb iu">“预期回报”是用训练集上的表现来表示的，而实际的“投资回报”是看不见的数据(测试集)上的表现</strong>。</p><p id="669e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">德怀特对模特的期望很高。事实上，该模型“承诺”交付 94%的平均精度(训练性能)。然而，结果非常令人失望，仅达到 79%(测试性能)。这种模式就像是一种无法偿还投资者的资产。</p><h1 id="c860" class="nh ni it bd nj nk nl nm nn no np nq nr jz ns ka nt kc nu kd nv kf nw kg nx ny bi translated">5.德怀特家的晚餐</h1><p id="2c3d" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">你可能认为票房和机器学习的类比有点鲁莽。好吧，如果你仍然不相信约翰尼·德普谬误在机器学习中与在电影行业中一样危险，那就看看德怀特模型的特征重要性吧:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/81d9fa66518dfec6fbec4a5d9f4d7a4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F1rIWxSkR_Kv6Y1Y0Y_6sw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">德怀特模型的特征重要性。行索引是最重要的特性。这没有任何意义！</p></figure><p id="6dad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“ROW_INDEX”是模型中最重要的特性。基本上，Dwight 主要根据数据集中蘑菇的行索引来决定他要吃哪些蘑菇，这只是一个随机数！如果你不是俄罗斯轮盘赌爱好者，我会在接受他的晚餐邀请前三思。</p><p id="8256" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当然，这只是一个玩具例子。在现实世界的应用中，模型要比这复杂得多。你不知道哪些功能应该是重要的，哪些功能不应该是重要的(如果你知道，你会从一开始就放弃这些功能)。这正是仔细观察训练和测试表现如此重要的原因。</p><p id="3818" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">例如，您可能最终拥有以下两种模型:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/c794aa70c9881b4a960eec212230777b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9_sqv993NGDYoYN2n-E8fA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">同样的考试成绩，不同的训练成绩</p></figure><p id="de47" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你是约翰尼·德普谬误的受害者，你可能会得出结论，模型 A 和模型 B 基本上是相同的，因为它们在测试数据上获得了相同的结果。然而，如果你有完整的图片，你会注意到模型 B 比模型 A 好得多，因为模型 A 显然是过度拟合的。</p><p id="9a37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">有很多原因可以解释你为什么要避免过度拟合:</p><ol class=""><li id="8549" class="mt mu it lb b lc ld lf lg li mv lm mw lq mx lu my mz na nb bi translated">当你有一个过拟合的模型时，很可能<em class="oe">可行</em>找到一个更好的模型(即训练性能较低和/或测试性能较高的模型)，这就是:从模型 A 转移到模型 b。</li><li id="ce2c" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">机器学习模型意味着学习模式。过度拟合模型是学习了许多<em class="oe">错误模式</em>的模型。</li><li id="5a10" class="mt mu it lb b lc nc lf nd li ne lm nf lq ng lu my mz na nb bi translated">过度合身的模特很快就会变老。如果你的意图是随着时间的推移使用你的模型，那么你将遭受更多的<a class="ae ky" href="https://machinelearningmastery.com/gentle-introduction-concept-drift-machine-learning/" rel="noopener ugc nofollow" target="_blank">概念漂移</a>。</li></ol><h1 id="6a7e" class="nh ni it bd nj nk nl nm nn no np nq nr jz ns ka nt kc nu kd nv kf nw kg nx ny bi translated"><strong class="ak"> 6。结束</strong></h1><p id="d4ce" class="pw-post-body-paragraph kz la it lb b lc nz ju le lf oa jx lh li ob lk ll lm oc lo lp lq od ls lt lu im bi translated">在本文中，我们使用了 Kaggle 上最不“过度适应”的数据集之一:蘑菇数据集。仍然不满足于此，我们还包括了在训练阶段提前停止。</p><p id="394c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但这是徒劳的:无论如何，我们最终得到了一个饱受过度拟合之苦的模型。这证明了<strong class="lb iu">对付过度拟合的灵丹妙药并不存在</strong>。</p><p id="5622" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">与过度拟合密切相关的是我们所称的“约翰尼·德普谬误”:<strong class="lb iu">忽视训练表现而只关注测试表现的诱惑</strong>。当然，测试性能很吸引人。但是，正如我们所看到的，这只是硬币的一面。</p><p id="a2c4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总之，<strong class="lb iu">处理过度拟合并不意味着仅仅使用早期停止(或任何其他正则化方法)，而是意味着检查模型在训练集和测试集上的表现</strong>。这是评估给定模型泛化能力的唯一方法。</p></div><div class="ab cl om on hx oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="im in io ip iq"><p id="a45a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<a class="ae ky" href="https://github.com/smazzanti/are_you_really_taking_care_of_overfitting" rel="noopener ugc nofollow" target="_blank">这款笔记本</a>可以重现上述所有结果。</p><p id="a93f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">笔记本上的任何错误都是德怀特的错。</p></div><div class="ab cl om on hx oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="im in io ip iq"><p id="b66f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读！我希望你喜欢这篇文章。</p><p id="163a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">相反，如果你非常喜欢它，请留下掌声，并跟随我在 Medium 上阅读更多关于数据科学的帖子。也可以在<a class="ae ky" href="https://www.linkedin.com/in/samuelemazzanti/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>上和我联系。</p></div></div>    
</body>
</html>