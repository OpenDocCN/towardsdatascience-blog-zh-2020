<html>
<head>
<title>Index Replication using Portfolio Optimization Methods</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用投资组合优化方法的指数复制</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/index-tracking-portfolio-optimization-8250d27449e6?source=collection_archive---------12-----------------------#2020-04-22">https://towardsdatascience.com/index-tracking-portfolio-optimization-8250d27449e6?source=collection_archive---------12-----------------------#2020-04-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5fac" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">市场指数的量化金融</h2></div><p id="3406" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">距离我上次发帖已经整整一年了，我想写一写我最近在家期间做的一个项目。很难在网上找到实用的资源。有许多数学和理论性的学术论文，但我想支持那些寻找代码和门外汉理解的人，因为我已经花了4天时间研究和处理这个项目。</p><p id="b157" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将在这篇文章中省略大部分代码，但你可以在这里访问所有内容:</p><p id="e840" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">👉🏻<a class="ae le" href="https://htmlpreview.github.io/?https://github.com/jasonyip184/Index-Tracking-Portfolio-Optimization/blob/master/Index-Tracking-Portfolio-Optimization.html" rel="noopener ugc nofollow" target="_blank">链接到代码/笔记本</a></p><p id="bc46" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">👉🏻<a class="ae le" href="https://github.com/jasonyip184/Index-Tracking-Portfolio-Optimization" rel="noopener ugc nofollow" target="_blank">回购链接</a></p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="b8d1" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">指数跟踪投资</h1><p id="2a16" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">是一种被动的投资策略，试图重新创建一个投资组合，产生类似于大盘指数的回报。这可以通过以下方式实现:</p><p id="eff8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">完全复制</strong></p><p id="81e5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">指数的完全复制要求基金持有指数中所有资产的份额，并尽可能复制指数中每种资产的权重。交易指数中的非流动性资产可能会增加基金的交易成本，导致更高的费用率和更差的基金业绩。</p><p id="c824" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">投资组合优化</strong></p><p id="ebce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该项目的目的是通过减少跟踪误差，使用指数中最大资产的最优投资组合选择来复制指数。最终，我们将为投资组合中每个最大的资产生成一个权重，以仅用几个资产复制指数的表现。</p><p id="a27a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">跟踪误差</strong></p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/5b313fe0eedbcea978eefe0825f6db84.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/0*06poo9rX8qjAHMjT.PNG"/></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">在这种情况下，基准是指数</p></figure><p id="997e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">信息比率</strong></p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mv"><img src="../Images/72e0dab2868e8817df25d84a6bb6a2b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v1LWrxi-8cpjGGO-ZmDyIw.png"/></div></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">类似夏普比率的衡量标准，量化投资组合的主动回报/主动风险</p></figure><p id="a840" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> Russell 1000 </strong>是富时罗素(FTSE Russell)维护的股票市场指数，跟踪整个美国股票市场排名最高的1000只股票，我们的目标是复制以下股票。<strong class="kk iu">测试期:</strong>2019–04–01至2019–04–30。</p></div><div class="ab cl lf lg hx lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="im in io ip iq"><h1 id="7396" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">数据收集</h1><p id="aaad" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">市场指数会定期进行再平衡，以确保与当前市场保持同步。当富时罗素在1984年创立该指数时，印第安纳标准石油公司是美国市值最大的公司之一。今天，该公司已经解散，不存在了。</p><p id="8e5c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据<a class="ae le" href="https://www.ftserussell.com/press/ftse-russell-announces-schedule-annual-russell-us-index-reconstitution https://www.ftserussell.com/press/ftse-russell-announces-2018-russell-us-indexes-reconstitution-schedule" rel="noopener ugc nofollow" target="_blank">年度重组时间表</a>，有一个“排名日”，在收盘时计算市值前1000家公司的排名。随后是在“生效日”进行重组之前的过渡期，在该日，市场以新重组的指数开盘。在用顶级公司来近似指数时，我们应该小心考虑这一点，因为它们(或它们的权重)可能会随着时间的推移而变化。我在<a class="ae le" href="https://content.ftserussell.com/sites/default/files/support_document/2018-russell-us-index-reconstitution-recap_0.pdf" rel="noopener ugc nofollow" target="_blank"> 2018 </a>和<a class="ae le" href="https://content.ftserussell.com/sites/default/files/support_document/2017_russell_reconstitution_recap_final.pdf" rel="noopener ugc nofollow" target="_blank"> 2017 </a>使用了富时重组摘要报告公布的指数前10名成分。训练数据取自2018年6月25日至2019年2月28日。</p><pre class="mk ml mm mn gt na nb nc nd aw ne bi"><span id="80cb" class="nf ln it nb b gy ng nh l ni nj">Market Cap of Top 10 in 2018 {'AAPL': 5016475823, 'AMZN': 483381822, 'GOOG': 694989876, 'MSFT': 7898764549, 'FB': 2917587472, 'BRK-B': 2444334034, 'JPM': 3601578394, 'XOM': 4614039868, 'JNJ': 2875386042, 'BAC': 10598321272}</span></pre><h1 id="12e6" class="lm ln it bd lo lp nk lr ls lt nl lv lw jz nm ka ly kc nn kd ma kf no kg mc md bi translated">基于罗素方法论的基准指数重构</h1><p id="4bdc" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">我们将使用Russell (第4页)的<a class="ae le" href="https://research.ftserussell.com/products/downloads/Russell_Index_Calculation_Methodology.pdf?_ga=2.110735813.1991880057.1587129456-1914712361.1587129456" rel="noopener ugc nofollow" target="_blank">价格回报指数来重建包含前10个成分的指数。</a><a class="ae le" href="https://research.ftserussell.com/products/downloads/Russell-US-equity-indexes-IOSCO.pdf?_ga=2.110735813.1991880057.1587129456-1914712361.1587129456" rel="noopener ugc nofollow" target="_blank">指数值</a>(第34页)然后通过复合价格回报指数的每日回报百分比获得。索引的起始值等于基数，在1978年12月31日设置为100。因此，在我们的基准日:2017年6月27日，我们将使用^RUI's收盘价= 1341.03(来自雅虎财经)作为我们的基准价。仅使用前10名，结果看起来一点也不接近。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi np"><img src="../Images/5b6384327c0c31d383f25c30d1db461f.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*QXhLqEHOe9A7pRRDmM3E9g.png"/></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">根据实际指数对重新创建的基准进行总体评估</p></figure><h1 id="22ab" class="lm ln it bd lo lp nk lr ls lt nl lv lw jz nm ka ly kc nn kd ma kf no kg mc md bi translated">使用非负最小二乘(NNLS)优化的分配</h1><p id="9c58" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">其想法是在训练期间，在一个受约束的线性最小二乘模型中，根据指数价格拟合当前前10种成分的线性组合。所获得的系数将是非负的，因为这是一个只做多的投资组合。</p><p id="85bc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">每个系数取系数之和，作为测试期内每个组件的权重。权重的总和将是投资组合复制指数价格所需的杠杆数量。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/37c7f5b2f47c8314a26331256309b40d.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*C-6jvrLQXrBr28bO0o5pbg.png"/></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">目标是优化它，其中x &amp; A是前10名的系数和历史价格，y是指数价格</p></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nr"><img src="../Images/95197a8aa040e6c877ee331f92a34eb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4lxsGJKzFaAcArWSEOAJkQ.png"/></div></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">样本x =前10名的历史价格</p></figure><p id="0eef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从库中调用的优化本质上是:</p><pre class="mk ml mm mn gt na nb nc nd aw ne bi"><span id="17b9" class="nf ln it nb b gy ng nh l ni nj"><strong class="nb iu">from</strong> <strong class="nb iu">scipy.optimize</strong> <strong class="nb iu">import</strong> nnls<br/>result = nnls(trainX, trainY)</span></pre><p id="87c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">系数然后被用作该线性组合中的权重，其中杠杆系数是系数之和:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ns"><img src="../Images/31259406e536a1c9010fe62688efb106.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yXkKo3uaEzi6IBNptgwFsw.png"/></div></div></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/59fb68d85ba977dd4df573c33302f3e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*sgCP9E5lXL8dXfElIlxiRg.png"/></div></figure><h2 id="c87a" class="nf ln it bd lo nu nv dn ls nw nx dp lw kr ny nz ly kv oa ob ma kz oc od mc oe bi translated">结果</h2><p id="4426" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">虽然我也在测试期之前的1个月的维持期内验证了模型，但我将只展示测试集上的结果。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi of"><img src="../Images/04404af0f0067d84597bdb254eb226e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KYrNjNbbsFDQuNYWHxqSzg.png"/></div></div></figure><p id="c655" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">就价格和每日回报而言，复制的指数似乎在视觉上与实际指数匹配得很好。跟踪误差为43个基点(0.43%)，RMSE(实际值)似乎相当低。</p><h1 id="5c34" class="lm ln it bd lo lp nk lr ls lt nl lv lw jz nm ka ly kc nn kd ma kf no kg mc md bi translated">使用相对偏相关的分配</h1><p id="a7e2" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">这种想法是，如果某个成分与指数的实际收盘点位相关性更高，就给它分配更多的权重。偏相关使来自1)其他IV上指数的最小二乘回归和2)其他IV上个体IV的最小二乘回归的残差相关。这说明了混淆和第三方的影响。我还忽略了负相关的成分，将其设置为0。类似地，我们将对每个相关性求和以获得权重</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi og"><img src="../Images/c385d380efb9eae13dc436239b89fda0.png" data-original-src="https://miro.medium.com/v2/resize:fit:474/format:webp/1*N83Cs5su7lBxaanuXgZiOA.png"/></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">相当于为IV1 &amp; DV捕捉D，为IV2 &amp; DV捕捉G</p></figure><p id="321e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从库中调用的优化本质上是(其中train包括历史成分和实际指数价格:</p><pre class="mk ml mm mn gt na nb nc nd aw ne bi"><span id="0059" class="nf ln it nb b gy ng nh l ni nj"><strong class="nb iu">import</strong> <strong class="nb iu">pandas</strong> <strong class="nb iu">as</strong> <strong class="nb iu">pd</strong><br/>train.pcorr()</span></pre><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/40d05aada208fa683f99695220c37260.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*1nodHmNHTpZWFqB1TWFeRQ.png"/></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">使用相对部分相关值作为权重</p></figure><p id="6f40" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如上所述，类似的线性组合方法将用于模拟实际。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi oi"><img src="../Images/f1a3a13c2c8fc53e4d0ffee8effba191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*76iXl_qoy-e58Y7oZYHhOw.png"/></div></div></figure><h2 id="39c7" class="nf ln it bd lo nu nv dn ls nw nx dp lw kr ny nz ly kv oa ob ma kz oc od mc oe bi translated">结果</h2><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi oj"><img src="../Images/d6674ea9d0a8f6ecd936a8bc8de6e50b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_91IOmVMFsAmvwIqpd_OCA.png"/></div></div></figure><p id="a33e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">跟踪误差和回报RMSE高于基准。但是，RMSE的价格要低很多。这可能是由于该模型在单独考虑每个组件的影响时过于简化。</p><h1 id="f5e1" class="lm ln it bd lo lp nk lr ls lt nl lv lw jz nm ka ly kc nn kd ma kf no kg mc md bi translated">使用动态时间弯曲(DTW)优化的分配</h1><p id="f1c1" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">Pearson correlation无法捕捉形状相似性，并将确定一对时间序列彼此不相关，即使它们可能非常相似并且只是不同相。这在领先/滞后变量及其对应变量之间可能很明显。这个想法是，如果一个组件与索引的DTW距离相对较短，从而具有更相似的形状，则向该组件分配更多的权重。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ok"><img src="../Images/9aea9f9ae51411d199702d5c6526c4ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aI7MA4aZ8wYIaH-uFkUW1Q.png"/></div></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">DTW距离说明了形状的相似性。</p></figure><p id="7201" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">目标是针对每个组件(x)和实际指数(y)进行优化:</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ol"><img src="../Images/d3cdae1fc11d59a9c75beaa0e6f65f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6NhnXUFt7YUvkPDLot4Beg.png"/></div></div></figure><p id="928e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从库中调用的优化本质上是:</p><pre class="mk ml mm mn gt na nb nc nd aw ne bi"><span id="5916" class="nf ln it nb b gy ng nh l ni nj"><strong class="nb iu">from</strong> <strong class="nb iu">tslearn.metrics</strong> <strong class="nb iu">import</strong> dtw<br/>trainX.apply(<strong class="nb iu">lambda</strong> x: dtw(x, trainY))</span></pre><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi om"><img src="../Images/2669c7858f89defe6b7acf64b5bc6bb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:854/format:webp/1*xIpWsFleq05lIrDLvAv1xA.png"/></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">每个距离的倒数作为相似性的度量，相似性作为相似性总和的一部分，用作线性组合中的权重，以复制索引。</p></figure><h2 id="4fba" class="nf ln it bd lo nu nv dn ls nw nx dp lw kr ny nz ly kv oa ob ma kz oc od mc oe bi translated">结果</h2><p id="2e42" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">跟踪误差，价格RMSE &amp;回报RMSE表现差于部分相关模型。这可能意味着形状相似性可能不是区分每个组件的重要因素。</p><h1 id="49e4" class="lm ln it bd lo lp nk lr ls lt nl lv lw jz nm ka ly kc nn kd ma kf no kg mc md bi translated">使用非负矩阵分解的分配(NMF)</h1><p id="788d" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">虽然NNLS是一种监督学习方法，但无监督NMF方法能够通过单个主成分来学习数据的表示。主成分将是资产的线性组合，使得由于该算法中的约束，系数将是非负的。我们的想法是找出每项资产对数据总体变化的相对重要性，并再次将其作为线性组合中的权重。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi on"><img src="../Images/6c8e86391db0155ee25acd2bf5564612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1188/format:webp/1*oIRstoiS28cNh2ugkNGyXQ.png"/></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">该算法通过优化X和Y=WH之间的距离，将数据分解为两个非负元素矩阵。x由W中的线性组合表示，使用h中的系数。</p></figure><p id="ef76" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从库中调用的优化本质上是:</p><pre class="mk ml mm mn gt na nb nc nd aw ne bi"><span id="8c7d" class="nf ln it nb b gy ng nh l ni nj"><strong class="nb iu">from</strong> <strong class="nb iu">sklearn.decomposition</strong> <strong class="nb iu">import</strong> NMF<br/>nmf = NMF(n_components=1)<br/>nmf.fit(trainX)<br/>coeffs = nmf.components_.tolist()[0]</span></pre><h2 id="195f" class="nf ln it bd lo nu nv dn ls nw nx dp lw kr ny nz ly kv oa ob ma kz oc od mc oe bi translated">结果</h2><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi oo"><img src="../Images/05ab54a0f7e5af3154f2073f5a1743bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*10M6s-A5eMJjrZviGf7Bbg.png"/></div></div></figure><p id="2224" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这种方法的问题是价格不能被正确地复制，因为我们不知道无监督学习方法中的杠杆因子，因此价格RMSE非常高。</p><h1 id="4f86" class="lm ln it bd lo lp nk lr ls lt nl lv lw jz nm ka ly kc nn kd ma kf no kg mc md bi translated">使用粒子群优化算法的分配</h1><p id="0647" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">PSO模拟分散在搜索空间中的“社会生物”,并移动以找到最优解。这里的优化函数是最小化跟踪误差。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi op"><img src="../Images/8b16c23b1b1f805f8f2a381e0ad32f83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/0*MUcSzVhNWQdxFG-H.gif"/></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">每个粒子代表一组随机初始化的投资组合权重。他们的行动受到(1)他们个人寻找的欲望和(2)群体或其邻居的集体行动的影响。</p></figure><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi oq"><img src="../Images/506278fd4f44cd275078fbb735987a13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pAvjLAYXazu9TwCkmFYCtA.png"/></div></div></figure><p id="719f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Bounds = [0，1]，因为系数是非负的，并且组件的值不能大于索引。</p><p id="09a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">网格搜索在c1，c2，w上执行。网格搜索的代码几乎与下面的块相同，它将为您提供在下面的块中使用的best_pos，以进行最终优化。</p><pre class="mk ml mm mn gt na nb nc nd aw ne bi"><span id="4e8c" class="nf ln it nb b gy ng nh l ni nj"><strong class="nb iu">from</strong> <strong class="nb iu">pyswarms.utils.search.grid_search</strong> <strong class="nb iu">import</strong> GridSearch<br/><strong class="nb iu">from</strong> <strong class="nb iu">pyswarms.utils.search.random_search</strong> <strong class="nb iu">import</strong> RandomSearch<br/><strong class="nb iu">from</strong> <strong class="nb iu">pyswarms.single.global_best</strong> <strong class="nb iu">import</strong> GlobalBestPSO<br/><strong class="nb iu">from</strong> <strong class="nb iu">pyswarms.utils.plotters</strong> <strong class="nb iu">import</strong> (plot_cost_history, plot_contour, plot_surface)</span><span id="ad39" class="nf ln it nb b gy or nh l ni nj"><strong class="nb iu">def</strong> find_particle_loss(coeffs):<br/>    trainX_returns = trainX.pct_change().dropna()<br/>    trainY_returns = trainY.pct_change().dropna()<br/>    benchmark_tracking_error = np.std(trainX.dot(coeffs) - trainY)<br/>    <strong class="nb iu">return</strong> benchmark_tracking_error<br/><br/><strong class="nb iu">def</strong> swarm(x):<br/>    n_particles = x.shape[0]<br/>    particle_loss = [find_particle_loss(x[i]) <strong class="nb iu">for</strong> i <strong class="nb iu">in</strong> range(n_particles)]<br/>    <strong class="nb iu">return</strong> particle_loss</span><span id="00ec" class="nf ln it nb b gy or nh l ni nj">feature_count = len(trainX.columns)<br/>min_bound = feature_count*[0]<br/>max_bound = feature_count*[1]</span><span id="be84" class="nf ln it nb b gy or nh l ni nj">optimizer = GlobalBestPSO(n_particles=1000,<br/>               dimensions=len(trainX.columns),<br/>               options=best_pos,<br/>               bounds=(min_bound,max_bound))<br/><em class="os"># Perform optimization, cost=lowest particle_loss among all iterations</em><br/>cost, pos = optimizer.optimize(swarm,iters=100)</span></pre><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/e93b6dad62386c9f7610001121fe6549.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*e6y1pEXKOQKIJgwnI3kp3A.png"/></div><p class="mr ms gj gh gi mt mu bd b be z dk translated">到目前为止，最低成本是从每一轮的所有粒子(系数集)中获得的。</p></figure><h2 id="c944" class="nf ln it bd lo nu nv dn ls nw nx dp lw kr ny nz ly kv oa ob ma kz oc od mc oe bi translated">结果</h2><p id="22f0" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">具有最低成本(跟踪误差)的粒子(系数组)将被用作系数，取系数之和作为权重，并在线性组合中用于重建索引。</p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ou"><img src="../Images/7966bac66006ba16cafd990b1aad5b2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tE8rEo9cwD_6AUY34QVT8w.png"/></div></div></figure><p id="53df" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">NMF(跟踪误差:56个基点，RMSE价格:368.7，RMSE回报率:0.006032)</p><p id="5500" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">NNLS(跟踪误差:43个基点，RMSE价格:27.37，RMSE回报率:0.004587)</p><p id="b7a6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">PSO模型的跟踪误差最小。</p><h1 id="9d7d" class="lm ln it bd lo lp nk lr ls lt nl lv lw jz nm ka ly kc nn kd ma kf no kg mc md bi translated">结论</h1><p id="5743" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">在训练期间，对前10种成分的价格和实际指数价格使用了以下定量方法:</p><ol class=""><li id="624a" class="ov ow it kk b kl km ko kp kr ox kv oy kz oz ld pa pb pc pd bi translated">非负最小二乘(NNLS)优化</li><li id="fc5e" class="ov ow it kk b kl pe ko pf kr pg kv ph kz pi ld pa pb pc pd bi translated">相对偏相关</li><li id="6061" class="ov ow it kk b kl pe ko pf kr pg kv ph kz pi ld pa pb pc pd bi translated">动态时间弯曲(DTW)优化</li><li id="fad8" class="ov ow it kk b kl pe ko pf kr pg kv ph kz pi ld pa pb pc pd bi translated">非负矩阵分解(NMF)</li><li id="9d47" class="ov ow it kk b kl pe ko pf kr pg kv ph kz pi ld pa pb pc pd bi translated">粒子群优化算法</li></ol><p id="1a30" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，获得的权重用于分配投资组合，以模拟测试期间的指数价格和每日回报。然后通过跟踪误差和实际指数的RMSE价格/日收益率来衡量业绩。</p><p id="3858" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在如此短的时间内，我从这个项目中学到了很多，它真的让我看到了定量方法在金融领域的更多应用。希望你喜欢阅读这篇文章，就像我喜欢创作它一样。</p></div></div>    
</body>
</html>