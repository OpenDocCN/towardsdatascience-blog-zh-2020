<html>
<head>
<title>Generalized Poisson Regression for Real World Datasets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">真实世界数据集的广义泊松回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/generalized-poisson-regression-for-real-world-datasets-d1ff32607d79?source=collection_archive---------11-----------------------#2020-04-04">https://towardsdatascience.com/generalized-poisson-regression-for-real-world-datasets-d1ff32607d79?source=collection_archive---------11-----------------------#2020-04-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/0a64bb42c149c314dc5ff8a94996922c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dW-a5JLilCb_fO2K204LIw.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Phil Dolby 的照片来自<a class="ae jg" href="https://pxhere.com/en/photo/275716" rel="noopener ugc nofollow" target="_blank"> PxHere </a>下<a class="ae jg" href="https://creativecommons.org/licenses/by/2.0/" rel="noopener ugc nofollow" target="_blank"> CC BY 2.0 </a></p></figure><div class=""/><div class=""><h2 id="dddc" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">以及用 Python 进行广义泊松回归的分步指南</h2></div><p id="2ccb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">常规泊松回归模型通常是基于计数的数据集的首选模型。泊松回归模型的主要假设是计数的方差与其平均值相同，即数据是<em class="lu">等分布的</em>。不幸的是，现实世界的数据很少是等分布的，这促使统计学家使用其他模型进行计算，例如:</p><ul class=""><li id="a06c" class="lv lw jj la b lb lc le lf lh lx ll ly lp lz lt ma mb mc md bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/negative-binomial-regression-f99031bb25b4">负二项式(NB)回归模型</a>以及，</li><li id="5f64" class="lv lw jj la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">广义泊松回归模型</li></ul><p id="06b3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这两个模型都<em class="lu">而不是</em>做出关于数据集的<em class="lu">方差=均值</em>假设。这使得它们成为基于计数的数据建模的更好的实用选择。在之前的一篇文章中，我详细介绍了 NB 模型。在本文中，我们将介绍<strong class="la jk">广义泊松回归模型</strong>。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="2df9" class="mq mr jj bd ms mt mu dn mv mw mx dp my lh mz na nb ll nc nd ne lp nf ng nh ni bi translated">文章的布局</h2><p id="fd3e" class="pw-post-body-paragraph ky kz jj la b lb nj kk ld le nk kn lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">我们将在本文中讨论以下主题:</p><ol class=""><li id="4d81" class="lv lw jj la b lb lc le lf lh lx ll ly lp lz lt no mb mc md bi translated">什么是基于计数的数据集？</li><li id="021c" class="lv lw jj la b lb me le mf lh mg ll mh lp mi lt no mb mc md bi translated">什么是等分散、分散不足、分散过度？我们将讨论泊松模型对于分散不足和分散过度的数据集的局限性。</li><li id="f262" class="lv lw jj la b lb me le mf lh mg ll mh lp mi lt no mb mc md bi translated"><strong class="la jk"> <em class="lu">领事的广义泊松回归(GP-1) </em>模型</strong>和<strong class="la jk"> <em class="lu">法莫耶的限制广义泊松回归(GP-2) </em>模型</strong>介绍。</li><li id="c352" class="lv lw jj la b lb me le mf lh mg ll mh lp mi lt no mb mc md bi translated">一个基于 Python 的教程，用于构建和训练 GP-1 和 GP-2 模型，并将它们的性能与标准泊松回归模型进行比较。</li></ol></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="194e" class="mq mr jj bd ms mt mu dn mv mw mx dp my lh mz na nb ll nc nd ne lp nf ng nh ni bi translated">什么是基于计数的数据？</h2><p id="fcf8" class="pw-post-body-paragraph ky kz jj la b lb nj kk ld le nk kn lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">基于计数的数据集是因变量<strong class="la jk"> <em class="lu"> y </em> </strong>代表某个事件发生的次数的数据集。以下是一些例子:</p><ol class=""><li id="6cdb" class="lv lw jj la b lb lc le lf lh lx ll ly lp lz lt no mb mc md bi translated">每月发现的系外行星数量。</li><li id="78cf" class="lv lw jj la b lb me le mf lh mg ll mh lp mi lt no mb mc md bi translated">历年太阳黑子的数量。</li><li id="9efb" class="lv lw jj la b lb me le mf lh mg ll mh lp mi lt no mb mc md bi translated">每小时走进急诊室的人数。</li></ol><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi np"><img src="../Images/d8b611fb785b034d2cc37adb2fb68641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AiziUA9XjN8Wb_DL-e3t0Q.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">太阳黑子(来源:<a class="ae jg" href="https://commons.wikimedia.org/wiki/File:Sunspots-gn-yr-total-smoothed-en.svg" rel="noopener ugc nofollow" target="_blank">维基共享</a>下 CC <a class="ae jg" href="https://creativecommons.org/licenses/by-sa/4.0/" rel="noopener ugc nofollow" target="_blank"> BY-SA 4.0 </a>)</p></figure><p id="fb23" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在上述每一个数据集中，因变量<strong class="la jk"> <em class="lu"> y </em> </strong>代表观察到的计数，而<strong class="la jk"> <em class="lu"> X </em> </strong>的选择，解释变量的矩阵，即被认为解释<strong class="la jk"> <em class="lu"> y </em> </strong>中的方差的一组变量，主要(可悲地)留给了统计建模者的判断。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="e8da" class="mq mr jj bd ms mt mu dn mv mw mx dp my lh mz na nb ll nc nd ne lp nf ng nh ni bi translated">等分散、欠分散、过分散和泊松模型的局限性</h2><p id="86e7" class="pw-post-body-paragraph ky kz jj la b lb nj kk ld le nk kn lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">可以从尝试将相关计数变量建模为泊松过程开始。不幸的是，在许多真实世界的数据集中，泊松过程无法令人满意地解释观察计数的可变性。这主要是由于泊松回归模型对数据的<em class="lu">方差=均值</em>假设。换句话说，泊松模型错误地假设计数是<em class="lu">等分布的</em>。</p><p id="7de1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/an-illustrated-guide-to-the-poisson-regression-model-50cccba15958">泊松模型</a>无法摆脱这一假设，因为该模型基于因变量<strong class="la jk"><em class="lu"/></strong>是一个服从泊松概率分布的随机变量的假设，可以证明泊松分布的随机变量的方差等于其均值。</p><p id="af1c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面的公式表示了泊松分布随机变量的概率分布函数(也称为<strong class="la jk"> P </strong>概率<strong class="la jk">M</strong>as<strong class="la jk">F</strong>函数)。可以看出:</p><p id="e945" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">方差(X) =均值(X) = λ </em>，单位时间内发生的事件数。</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/c991e3b8ceddf6d581e2243e626b15b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*dgf2jeuG_ItSkTwWhHFQUA.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">假设每单位时间发生λ个事件，看到 k 个事件的概率(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="169c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">下面是一些有趣的概率分布图，由上述公式针对不同的λ值生成:</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nv"><img src="../Images/746d6f39ff2c37c75ca46ddbd239859f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*puWzKzi2FoTXaj30FXZNOw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">不同λ值下看到 k 个事件的概率(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="b5c2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">顺便提一下，在回归建模中，谈论无条件方差和无条件均值是不常见的。相反，人们更喜欢将方差称为<a class="ae jg" rel="noopener" target="_blank" href="/3-conditionals-every-data-scientist-should-know-1916d48b078a"> <em class="lu">，条件是解释变量</em> <strong class="la jk"> <em class="lu"> X </em> </strong> <em class="lu">呈现某个特定值</em><strong class="la jk"><em class="lu">X _ I</em></strong><em class="lu">用于第 I 次观察</em> </a>。</p><p id="ec46" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">条件方差可以表示为<em class="lu">方差(</em><strong class="la jk"><em class="lu">y</em></strong><em class="lu">|</em><strong class="la jk"><em class="lu">X = X _ I</em></strong><em class="lu">)</em>。条件均值同上。</p><p id="ce3d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如前所述，现实世界的数据集很多都不是等分散的，所以<strong class="la jk"> <em class="lu"> y </em> </strong>的条件方差不等于<strong class="la jk"> <em class="lu"> y </em> </strong>的条件均值。其中一些的方差大于平均值，这种现象被称为<strong class="la jk">过度分散</strong>，而在其他情况下，方差小于平均值，也称为<strong class="la jk">分散不足</strong>。</p><p id="1507" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">总的来说:</p><blockquote class="nw nx ny"><p id="5173" class="ky kz lu la b lb lc kk ld le lf kn lg nz li lj lk oa lm ln lo ob lq lr ls lt im bi translated">当您的因变量<strong class="la jk"> <em class="jj"> y </em> </strong>的方差大于您的模型假设的方差时，那么从您的模型的角度来看，您的数据集是<strong class="la jk">过度分散的</strong>。</p><p id="ff02" class="ky kz lu la b lb lc kk ld le lf kn lg nz li lj lk oa lm ln lo ob lq lr ls lt im bi translated">当您的因变量<strong class="la jk"> <em class="jj"> y </em> </strong>的方差小于您的模型假设的方差时，那么从您的模型的角度来看，您的数据集是<strong class="la jk">欠分散的</strong>。</p></blockquote><p id="67fb" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">过度(或不足)分散的影响是您的模型将无法充分解释观察到的计数的可变性。相应地，它的预测质量会很差。</p><p id="96ea" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">解决这个问题的一个常见方法是假设方差是平均值的一般函数，即:</p><p id="b1ca" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">方差=</em><strong class="la jk"><em class="lu">f</em></strong><em class="lu">(均值)</em></p><p id="e6f3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">常用的一种形式为<em class="lu"> f(。)</em> </strong>如下:</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/ec21750ebabb58f7b3aedaeb12db501d.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*Euxgqf9GsKYNQymurPx3fw.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">一个常用的方差函数(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="f098" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">其中<em class="lu"> p=0，1，2… </em></p><p id="80b5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu"> α </em>被称为离差参数，它代表由一些未知变量集合引入的<strong class="la jk"><em class="lu">【y】</em></strong>的额外可变性，这些变量集合导致<strong class="la jk"><em class="lu"/></strong>y 的总体方差不同于您的回归模型预期的方差。</p><p id="04b7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">注意，当<em class="lu"> α=0 </em>时，<em class="lu">方差=均值</em>你就得到了标准泊松回归模型。</p><p id="ba18" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当<em class="lu"> α &gt; 0 </em>时，我们考虑两种有趣的情况，即当<em class="lu"> p=1 和 p=2 时。</em>在这两种情况下，我们得到了所谓的<strong class="la jk">负二项(NB)回归模型</strong>。</p><p id="0fb4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在 NB 回归模型中，我们假设观察计数<strong class="la jk"> <em class="lu"> y </em> </strong>是一个事件率为<strong class="la jk"> <em class="lu"> λ </em> </strong>和<strong class="la jk"> <em class="lu"> λ </em> </strong> <em class="lu">本身是一个伽玛分布随机变量</em>。</p><p id="177c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">负二项式回归模型(通常称为泊松-伽马混合模型)被证明是许多真实世界计数数据集的优秀模型。我在下面的文章中对此做了更详细的介绍:</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="af09" class="mq mr jj oe b gy oi oj l ok ol"><a class="ae jg" rel="noopener" target="_blank" href="/negative-binomial-regression-f99031bb25b4"><strong class="oe jk">Negative Binomial Regression: A Step by Step Guide</strong></a></span></pre><p id="5a2a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">还有许多其他方法可用于推广泊松回归模型，以将其扩展到过度分散和分散不足的数据。在本文中，我们将讨论两个这样的模型。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="98a0" class="mq mr jj bd ms mt mu dn mv mw mx dp my lh mz na nb ll nc nd ne lp nf ng nh ni bi translated">领事的广义泊松回归模型</h2><p id="aa6b" class="pw-post-body-paragraph ky kz jj la b lb nj kk ld le nk kn lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">1989 年，Prem C. Consul 在他的著作《广义泊松分布:性质和应用》<a class="ae jg" href="https://www.amazon.com/dp/B01K0UCF5C" rel="noopener ugc nofollow" target="_blank"><em class="lu"/></a><em class="lu">，</em>中提出了一种修正泊松分布的概率分布的方法，使其能够处理过分散和欠分散的数据。这个模型后来被称为<strong class="la jk"> GP-1(广义泊松-1)模型</strong>。GP-1 模型假设因变量<strong class="la jk"> <em class="lu"> y </em> </strong>是具有以下概率分布的随机变量:</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi om"><img src="../Images/d7d37872d056036d1331b99076ab5dd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2M_QmJBEZFCDyCzpazcZkA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">GP-1 模型的概率分布、方差和均值函数(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="f57f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果在上面的等式中设置分散参数<em class="lu"> α </em>为 0，GP-1 的 PMF、均值和方差基本上减少到标准泊松分布。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="8f2d" class="mq mr jj bd ms mt mu dn mv mw mx dp my lh mz na nb ll nc nd ne lp nf ng nh ni bi translated">法莫耶的限制性广义泊松分布</h2><p id="4344" class="pw-post-body-paragraph ky kz jj la b lb nj kk ld le nk kn lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">1993 年，Felix Famoye 引入了他所谓的受限广义泊松回归模型，作为一种将标准泊松模型的范围扩展到处理过度分散和分散不足数据集的方法。这个模型被称为<strong class="la jk"> GP-2(广义泊松-2)模型</strong>。</p><p id="4698" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">GP-2 模型假设因变量<strong class="la jk"> <em class="lu"> y </em> </strong>是具有以下概率分布的随机变量:</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi on"><img src="../Images/220b57d4ae30295c51e12b54f4f190da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*82zOm-_U6e_8ODp0QErVaw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">GP-2 模型的概率分布、方差和均值函数(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="623b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如前所述，当分散参数<em class="lu"> α </em>被设置为 0 时，GP-2 的 PMF、均值和方差函数基本上减少到标准泊松分布的那些。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="0bfd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">色散参数α使用以下公式估算:</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oo"><img src="../Images/4e132969135ecb3d9ade2786fd05bc3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XeYReRpk850P1OSc4P9-og.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">计算α的公式(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="a210" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<em class="lu"> statsmodels </em>库中，<em class="lu"> α </em>为您估算，作为 GP-1 和 GP-2 模型的模型拟合过程的一部分。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="ed9d" class="mq mr jj bd ms mt mu dn mv mw mx dp my lh mz na nb ll nc nd ne lp nf ng nh ni bi translated">GP-1 和 GP-2 在 Python 和 Statsmodels 中的实现</h2><p id="9fbf" class="pw-post-body-paragraph ky kz jj la b lb nj kk ld le nk kn lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">statsmodels 库包含通过<code class="fe op oq or oe b">statsmodels.discrete.discrete_model.GeneralizedPoisson</code>类实现的 GP-1 和 GP-2 模型。</p><p id="ef76" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在本节中，我们将展示如何使用 GP-1 和 GP-2 对以下真实世界的计数数据集进行建模。</p><h2 id="da3c" class="mq mr jj bd ms mt mu dn mv mw mx dp my lh mz na nb ll nc nd ne lp nf ng nh ni bi translated">真实世界的计数数据集</h2><p id="5c1f" class="pw-post-body-paragraph ky kz jj la b lb nj kk ld le nk kn lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">下表包含了骑自行车穿过纽约市各种桥梁的人数。从 2017 年 4 月 1 日到 2017 年 10 月 31 日每天测量计数。</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi os"><img src="../Images/9a0953544f729b1665ae6a9b8fef7794.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*O8xjs5x9Rv4BTTyz.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来源:<a class="ae jg" href="https://data.cityofnewyork.us/Transportation/Bicycle-Counts-for-East-River-Bridges/gua4-p9wg" rel="noopener ugc nofollow" target="_blank">东河大桥的自行车数量</a>(纽约开放数据)(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="4af4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里是到原始数据集的<a class="ae jg" href="https://data.cityofnewyork.us/Transportation/Bicycle-Counts-for-East-River-Bridges/gua4-p9wg" rel="noopener ugc nofollow" target="_blank">链接。</a></p><p id="eb3b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将集中分析每天穿过布鲁克林大桥的骑自行车的人数。这是布鲁克林大桥上自行车数量的时间顺序图:</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ot"><img src="../Images/e26a2149153a354eba6ba36e9e36a510.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JT5FpULvjjsbfOqb.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">每天骑自行车的人在布鲁克林大桥上计数(背景来源:<a class="ae jg" href="https://en.wikipedia.org/wiki/Brooklyn_Bridge#/media/File:Brooklyn_Bridge_Postdlf.jpg" rel="noopener ugc nofollow" target="_blank">从曼哈顿岛看到的布鲁克林大桥</a></p></figure></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="99d8" class="ou mr jj bd ms ov ow ox mv oy oz pa my kp pb kq nb ks pc kt ne kv pd kw nh pe bi translated">我们的回归目标</h1><p id="767a" class="pw-post-body-paragraph ky kz jj la b lb nj kk ld le nk kn lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">我们回归的目标是预测任意一天穿过布鲁克林大桥的骑自行车的人数。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h1 id="6805" class="ou mr jj bd ms ov ow ox mv oy oz pa my kp pb kq nb ks pc kt ne kv pd kw nh pe bi translated">我们的回归策略</h1><p id="54d0" class="pw-post-body-paragraph ky kz jj la b lb nj kk ld le nk kn lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">我们将使用数据集中的一组回归变量，即日、星期几(从日期中得出)、月(从日期中得出)、高温、低温和降水量，来“解释”布鲁克林大桥上观测到的计数的变化。</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/8f1adf46f81fc66e63c5e0acd931a44c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/0*wb_-pyXFVyIU6zHK.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">观察到的自行车数量的回归矩阵和向量(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><blockquote class="nw nx ny"><p id="b96b" class="ky kz lu la b lb lc kk ld le lf kn lg nz li lj lk oa lm ln lo ob lq lr ls lt im bi translated"><em class="jj">我们回归模型的训练算法会将观察到的计数</em> <strong class="la jk"> y <em class="jj"> </em> </strong> <em class="jj">拟合到回归矩阵</em> <strong class="la jk"> X <em class="jj">。</em> </strong></p></blockquote><p id="0b9a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一旦模型被训练，我们将在一个模型在训练期间根本没有见过的持续测试数据集上测试它的性能。</p><h2 id="0851" class="mq mr jj bd ms mt mu dn mv mw mx dp my lh mz na nb ll nc nd ne lp nf ng nh ni bi translated">回归策略—循序渐进</h2><ol class=""><li id="0db7" class="lv lw jj la b lb nj le nk lh pg ll ph lp pi lt no mb mc md bi translated">我们将首先在这个数据集上训练标准泊松回归模型。标准泊松模型也将作为测试广义泊松模型有效性的“控制”模型。</li><li id="e81c" class="lv lw jj la b lb me le mf lh mg ll mh lp mi lt no mb mc md bi translated">如果数据集中的方差与平均值大致相同，那么除了检查泊松模型的拟合优度之外，就没什么可做的了。</li><li id="7e89" class="lv lw jj la b lb me le mf lh mg ll mh lp mi lt no mb mc md bi translated">如果方差大于或小于泊松均值，那么我们将在数据集上依次训练 GP-1 和 GP-2 模型，并将它们的性能与泊松模型进行比较。</li></ol><p id="f7c5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将从导入所有需要的包开始。</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="181a" class="mq mr jj oe b gy oi oj l ok ol">import pandas as pd<br/>from patsy import dmatrices<br/>import numpy as np<br/>import statsmodels.api as sm<br/>import matplotlib.pyplot as plt</span></pre><p id="b8b5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为计数数据集创建一个熊猫数据框架。这里是数据集的<a class="ae jg" href="https://gist.github.com/sachinsdate/c17931a3f000492c1c42cf78bf4ce9fe" rel="noopener ugc nofollow" target="_blank">链接。</a></p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="1165" class="mq mr jj oe b gy oi oj l ok ol">df = pd.read_csv('nyc_bb_bicyclist_counts.csv', header=0, infer_datetime_format=True, parse_dates=[0], index_col=[0])</span></pre><p id="a311" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将在<strong class="la jk"> X </strong>矩阵中添加一些派生的回归变量。</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="3a1b" class="mq mr jj oe b gy oi oj l ok ol">ds = df.index.to_series()<br/>df['MONTH'] = ds.dt.month<br/>df['DAY_OF_WEEK'] = ds.dt.dayofweek<br/>df['DAY'] = ds.dt.day</span></pre><p id="95b2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们打印出数据集的前几行，看看它是什么样子:</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="53b7" class="mq mr jj oe b gy oi oj l ok ol">print(df.head(10))</span></pre><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pj"><img src="../Images/5c4dfe19065e57cda06c4959ce10a1b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dZe7NetyKJS6ywOAftXU5A.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="69e8" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们创建训练和测试数据集。</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="36ac" class="mq mr jj oe b gy oi oj l ok ol">mask = np.random.rand(len(df)) &lt; 0.8<br/>df_train = df[mask]<br/>df_test = df[~mask]<br/>print('Training data set length='+str(len(df_train)))<br/>print('Testing data set length='+str(len(df_test)))</span></pre><p id="9130" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在<a class="ae jg" href="https://patsy.readthedocs.io/en/latest/quickstart.html" rel="noopener ugc nofollow" target="_blank"> Patsy </a>符号中设置回归表达式。我们告诉 patsy，BB_COUNT 是我们的因变量<strong class="la jk"> <em class="lu"> y </em> </strong>，它取决于回归变量<strong class="la jk"> <em class="lu"> X </em> </strong> : DAY、DAY_OF_WEEK、MONTH、HIGH_T、LOW_T 和 PRECIP。</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="8c3c" class="mq mr jj oe b gy oi oj l ok ol">expr = 'BB_COUNT ~ DAY  + DAY_OF_WEEK + MONTH + HIGH_T + LOW_T + PRECIP'</span></pre><p id="ecc6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们使用 Patsy 为训练和测试数据集绘制出<strong class="la jk"> <em class="lu"> X </em> </strong>和<strong class="la jk"> <em class="lu"> y </em> </strong>矩阵:</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="53ea" class="mq mr jj oe b gy oi oj l ok ol">y_train, X_train = dmatrices(expr, df_train, return_type='dataframe')</span><span id="e46f" class="mq mr jj oe b gy pk oj l ok ol">y_test, X_test = dmatrices(expr, df_test, return_type='dataframe')</span></pre><p id="f8f7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">使用 statsmodels GLM 类，对定型数据集定型泊松回归模型。</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="3d27" class="mq mr jj oe b gy oi oj l ok ol">poisson_training_results = sm.GLM(y_train, X_train, family=sm.families.Poisson()).fit()</span></pre><p id="d349" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">打印培训总结。</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="7efb" class="mq mr jj oe b gy oi oj l ok ol">print(poisson_training_results.summary())</span></pre><p id="0f8e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这会打印出以下内容:</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pl"><img src="../Images/c405cdc627ea534e03b9c1b88a2c7aa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qlfWJaaNMYMaefCcb6yzAQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">泊松回归模型的训练总结(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="ba34" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我突出显示了输出中的重要部分。</p><p id="79f0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以看到，所有回归系数(回归术语中称为<strong class="la jk"> <em class="lu"> β </em> </strong>向量)在 95%的置信水平下具有统计显著性，因为它们的 p 值为&lt; 0.05。</p><p id="2d88" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">稍后将使用最大对数似然值(-11872)来比较模型与 GP-1 和 GP-2 模型的性能。</p><p id="be6f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们打印出数据集的方差和均值:</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="2d1d" class="mq mr jj oe b gy oi oj l ok ol">print('variance='+str(df['BB_COUNT'].var()))</span><span id="182f" class="mq mr jj oe b gy pk oj l ok ol">print('mean='+str(df['BB_COUNT'].mean()))</span></pre><p id="6c0d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这会打印出以下内容:</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="7cf9" class="mq mr jj oe b gy oi oj l ok ol">variance=730530.6601948135</span><span id="edf0" class="mq mr jj oe b gy pk oj l ok ol">mean=2680.042056074766</span></pre><p id="50a4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">方差显然比平均值大得多。数据非常分散，泊松模型的主要假设不成立。</p><p id="23fd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因此，我们接下来将构建和训练 GP-1 和 GP-2 模型，看看它们的表现是否会更好。</p><p id="89f1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Statsmodels 让您用 3 行代码就可以做到这一点！</p><p id="f3d1" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">建立 Consul 的广义毒物回归模型，称为 GP-1:</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="c367" class="mq mr jj oe b gy oi oj l ok ol">gen_poisson_gp1 = sm.GeneralizedPoisson(y_train, X_train, <strong class="oe jk">p=1</strong>)</span></pre><p id="88bc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">拟合(训练)模型:</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="b35a" class="mq mr jj oe b gy oi oj l ok ol">gen_poisson_gp1_results = gen_poisson_gp1.fit()</span></pre><p id="a736" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">打印结果:</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="c695" class="mq mr jj oe b gy oi oj l ok ol">print(gen_poisson_gp1_results.summary())</span></pre><p id="0be9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这会打印出以下内容(我在输出中突出显示了一些有趣的区域):</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pm"><img src="../Images/a35471202f8d6311ad14c75b7a28feb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dM6n_RBZxjliEBBs3qy5lw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">GP-1 模型的训练结果(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="7aa4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">请注意，除了日变量的系数，所有其他回归系数在 95%的置信水平下具有统计显著性，即它们的 p 值&gt; 0.05。回想一下，在泊松模型<em class="lu">中，发现所有</em>回归系数在 95%的置信水平下具有统计显著性。</p><h2 id="8053" class="mq mr jj bd ms mt mu dn mv mw mx dp my lh mz na nb ll nc nd ne lp nf ng nh ni bi translated">GP-1 模型的拟合优度</h2><p id="afc6" class="pw-post-body-paragraph ky kz jj la b lb nj kk ld le nk kn lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">GP-1 模型的最大似然估计为-1350.6，大于零模型的最大似然估计-1475.9。零模型是简单的仅截距模型，即穿过 y 截距的水平线。但是这种差异在统计学上有意义吗？似然比(LR)检验的 p 值显示为 3.12e-51，这是一个非常小的数字。因此，是的，GP-1 模型确实比简单的仅截取模型在数据建模方面做得更好。</p><p id="96e6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但是 GP-1 比常规泊松模型做得更好吗？</p><p id="48f2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">回想一下，常规泊松模型的最大似然估计是-11872。与 GP-1 的 MLE-1350.6 相比。显然，GP-1 产生了更好的拟合优度(它有更大的最大似然估计)。如果我们愿意，我们可以使用两个似然估计值进行 LR 检验，并使用卡方检验评估显著性。在这种情况下，这是不必要的，因为 GP-1 的最大似然比常规泊松模型的大得多。</p><h2 id="9b03" class="mq mr jj bd ms mt mu dn mv mw mx dp my lh mz na nb ll nc nd ne lp nf ng nh ni bi translated">预言；预测；预告</h2><p id="6d19" class="pw-post-body-paragraph ky kz jj la b lb nj kk ld le nk kn lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">让我们使用 GP-1 预测骑自行车的人数，使用模型在训练期间没有看到的测试数据集:</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="0fda" class="mq mr jj oe b gy oi oj l ok ol">gen_poisson_gp1_predictions = gen_poisson_gp1_results.predict(X_test)</span></pre><p id="7298" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">gen_poisson_gp1_predictions 是一个 pandas 系列对象，它包含 X_test 矩阵中每一行的预计骑自行车的人数。记住 y_test 包含实际观察到的计数。</p><p id="7fd6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们绘制预测和实际计数，以直观地评估预测的质量:</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="6122" class="mq mr jj oe b gy oi oj l ok ol">predicted_counts=gen_poisson_gp1_predictions<br/>actual_counts = y_test[<strong class="oe jk">'BB_COUNT'</strong>]</span><span id="e50b" class="mq mr jj oe b gy pk oj l ok ol">fig = plt.figure()</span><span id="576d" class="mq mr jj oe b gy pk oj l ok ol">fig.suptitle(<strong class="oe jk">'Predicted versus actual bicyclist counts on the Brooklyn bridge'</strong>)</span><span id="1f07" class="mq mr jj oe b gy pk oj l ok ol">predicted, = plt.plot(X_test.index, predicted_counts, <strong class="oe jk">'go-'</strong>, label=<strong class="oe jk">'Predicted counts'</strong>)</span><span id="d02f" class="mq mr jj oe b gy pk oj l ok ol">actual, = plt.plot(X_test.index, actual_counts, <strong class="oe jk">'ro-'</strong>, label=<strong class="oe jk">'Actual counts'</strong>)</span><span id="3378" class="mq mr jj oe b gy pk oj l ok ol">plt.legend(handles=[predicted, actual])</span><span id="3b5c" class="mq mr jj oe b gy pk oj l ok ol">plt.show()</span></pre><p id="b472" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们得到了预测的和实际的骑自行车的人数的图表:</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pn"><img src="../Images/20654edc13e98841e32c81d73386efe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J5lQdUya5LnqSPlT7XuBqQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">GP-1 模型中预测的和实际的骑自行车的人数对比图(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="4d14" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如你所看到的，除了一些计数，GP-1 模型在预测骑自行车的人数方面做得相当好。</p><p id="45ed" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果需要，我们可以通过比较 GP-1 预测的均方根误差(RMSE)与常规泊松模型对相同测试数据集的预测，来比较 GP-1 与常规泊松模型的预测质量。我将把它作为一个练习。</p><p id="2a7a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">最后，让我们也尝试一下<strong class="la jk">法莫耶的受限广义泊松回归模型</strong>，称为 GP-2:</p><p id="f959" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用同样的 3 步方法来构建和训练模型。注意参数 p=2:</p><pre class="nq nr ns nt gt od oe of og aw oh bi"><span id="cb1c" class="mq mr jj oe b gy oi oj l ok ol"><em class="lu">#Build Famoye's Restricted Generalized Poison regression model, know as GP-2<br/></em>gen_poisson_gp2 = sm.GeneralizedPoisson(y_train, X_train, <strong class="oe jk">p=2</strong>)<br/><br/><em class="lu">#Fit the model<br/></em>gen_poisson_gp2_results = gen_poisson_gp2.fit()<br/><br/><em class="lu">#print the results<br/></em>print(gen_poisson_gp2_results.summary())</span></pre><p id="bc26" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们看到以下培训输出:</p><figure class="nq nr ns nt gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi po"><img src="../Images/78bed8b26d2a377d27394e94a8f4649e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d-QoDy8_5whh-YKQ41wr_A.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">GP-2 模型的训练输出(图片由<a class="ae jg" href="https://sachin-date.medium.com/" rel="noopener">作者</a>提供)</p></figure><p id="a615" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">分析和比较 GP-2 的拟合优度和预测质量的方法与 GP-1 相同。但是请注意，在这种情况下，模型的训练算法无法收敛。因此，我们将不再研究这个模型，而是更倾向于使用 GP-1 而不是标准的泊松模型来对骑自行车的人计数数据进行建模。</p><h2 id="67b1" class="mq mr jj bd ms mt mu dn mv mw mx dp my lh mz na nb ll nc nd ne lp nf ng nh ni bi translated">源代码</h2><p id="65ea" class="pw-post-body-paragraph ky kz jj la b lb nj kk ld le nk kn lg lh nl lj lk ll nm ln lo lp nn lr ls lt im bi translated">以下是完整的源代码:</p><figure class="nq nr ns nt gt iv"><div class="bz fp l di"><div class="pp pq l"/></div></figure><p id="ad2b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这里是本文中使用的数据集的链接。</p></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><h2 id="f1c0" class="mq mr jj bd ms mt mu dn mv mw mx dp my lh mz na nb ll nc nd ne lp nf ng nh ni bi translated">摘要</h2><ul class=""><li id="413c" class="lv lw jj la b lb nj le nk lh pg ll ph lp pi lt ma mb mc md bi translated">标准泊松模型假设基于计数的数据的方差与平均值相同。这个假设经常被过度分散或分散不足的真实世界数据集所违背。</li><li id="0fd0" class="lv lw jj la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">因此，我们需要对基于计数的数据使用其他模型，如负二项式模型或广义泊松回归模型，它们不假设数据是等分散的。这种模型假设方差是均值的函数。</li><li id="b74e" class="lv lw jj la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">Consul 的广义泊松回归模型(称为 GP-1)和 Famoye 的受限广义泊松回归模型(GP-2)就是两个这样的 GP 模型，它们可用于对基于真实世界计数的数据集进行建模。</li><li id="47bb" class="lv lw jj la b lb me le mf lh mg ll mh lp mi lt ma mb mc md bi translated">Python 库 Statsmodels 恰好对构建和训练 GP-1 和 GP-2 模型提供了出色的支持。</li></ul></div><div class="ab cl mj mk hx ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="im in io ip iq"><p id="2211" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">感谢阅读！我撰写关于数据科学的主题，重点是时间序列分析和预测。</em></p><p id="972f" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="lu">如果你喜欢这篇文章，请关注我的</em><a class="ae jg" href="https://timeseriesreasoning.medium.com" rel="noopener"><strong class="la jk"><em class="lu">Sachin Date</em></strong></a><em class="lu">获取关于时间序列分析和预测主题的提示、操作方法和编程建议。</em></p></div></div>    
</body>
</html>