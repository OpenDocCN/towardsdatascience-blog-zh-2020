<html>
<head>
<title>Factor Analysis Tutorial</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">因子分析教程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/factor-analysis-a-complete-tutorial-1b7621890e42?source=collection_archive---------8-----------------------#2020-05-13">https://towardsdatascience.com/factor-analysis-a-complete-tutorial-1b7621890e42?source=collection_archive---------8-----------------------#2020-05-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1cac" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">特征值、要素创造和克朗巴赫的阿尔法</h2></div><p id="8a5c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因子分析的目标是用较少的变量(称为因子)来描述相关变量之间的可变性。它基于这样一种想法，即存在一些“潜在的”因素，这些因素可以描述多个变量。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/c885180ca792f0184d8bf2267f642857.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*QauB2jFRLZ2FeqRMT2DUPA.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">来源:自创图片</p></figure><p id="1ce3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们想在建立模型之前减少变量的数量，这是非常有用的。</p><p id="c220" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本教程使用的数据是航空公司乘客满意度数据集，可以在这里找到:<a class="ae lq" href="https://www.kaggle.com/teejmahal20/airline-passenger-satisfaction" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/teejmahal 20/Airline-Passenger-satisfaction</a></p><p id="e7b2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该数据集包含一项航空公司乘客满意度调查。它有 103，904 条意见和 25 个栏目，其中 14 个栏目代表了客户对一项调查的回应，该调查评估了航班的不同方面(机上 wifi 服务、食物和饮料、在线登机、座位舒适度等)。这 14 列对于我们即将进行的因子分析非常重要。</p><p id="3ebc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">任何因素分析的第一步都是查看所有变量的相关图，看是否有任何变量是无用的或与其他变量相关性太大。</p><pre class="lf lg lh li gt lr ls lt lu aw lv bi"><span id="ba12" class="lw lx it ls b gy ly lz l ma mb">import seaborn as sns</span><span id="de74" class="lw lx it ls b gy mc lz l ma mb">plt.figure(figsize=(20,10))<br/>c= df.corr()<br/>sns.heatmap(c)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi md"><img src="../Images/4605a7651fd36492a413fd7a1d2f9968.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SXRiLVrM4RlFKlV3.png"/></div></div></figure><p id="f9e3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一些变量高度相关，尤其是与调查答案相关的变量。然而，真正突出的是“出发延误分钟数”和“到达延误分钟数”之间极高的相关性(0.98)。有道理。如果飞机比预计的晚起飞，它也应该晚到达。考虑到这种极高的相关性，我决定从数据集中删除该列。</p><pre class="lf lg lh li gt lr ls lt lu aw lv bi"><span id="149a" class="lw lx it ls b gy ly lz l ma mb">df.drop(['Arrival Delay in Minutes'], axis=1, inplace=True)</span></pre><p id="f3ad" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们已经去掉了无用的变量，这里是将用于因子分析的 14 个变量。</p><pre class="lf lg lh li gt lr ls lt lu aw lv bi"><span id="c685" class="lw lx it ls b gy ly lz l ma mb">Inflight wifi service               <br/>Departure/Arrival time convenient    <br/>Ease of Online booking               <br/>Gate location                        <br/>Food and drink                       <br/>Online boarding                      <br/>Seat comfort                         <br/>Inflight entertainment               <br/>On-board service                     <br/>Leg room service                     <br/>Baggage handling                     <br/>Checkin service                      <br/>Inflight service                     <br/>Cleanliness                          </span></pre><h1 id="5e53" class="mi lx it bd mj mk ml mm mn mo mp mq mr jz ms ka mt kc mu kd mv kf mw kg mx my bi translated">要素分析</h1><p id="175b" class="pw-post-body-paragraph ki kj it kk b kl mz ju kn ko na jx kq kr nb kt ku kv nc kx ky kz nd lb lc ld im bi translated">那么我们的 14 个变量是否可以描述成更少的潜在变量(因子)？让我们来看看，但是首先，我们必须安装并导入所需的包。</p><pre class="lf lg lh li gt lr ls lt lu aw lv bi"><span id="8ff4" class="lw lx it ls b gy ly lz l ma mb">!pip install factor_analyzer  <br/>from factor_analyzer import FactorAnalyzer</span></pre><p id="603e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了弄清楚我们需要多少个因子，我们可以看看特征值，它是一个衡量一个因子能解释多少变量方差的指标。大于 1 的特征值意味着因子比唯一变量能解释更多的方差。特征值为 2.5 意味着该因子可以解释 2.5 个变量的方差，依此类推。</p><pre class="lf lg lh li gt lr ls lt lu aw lv bi"><span id="121c" class="lw lx it ls b gy ly lz l ma mb"><strong class="ls iu"><em class="ne">#Subset of the data, the 14 columns containing the survey answers</em><br/></strong>x =df[df.columns[6:20]] </span><span id="b168" class="lw lx it ls b gy mc lz l ma mb">fa = FactorAnalyzer()<br/>fa.fit(x, 10)</span><span id="485e" class="lw lx it ls b gy mc lz l ma mb"><strong class="ls iu"><em class="ne">#Get Eigen values and plot them</em><br/></strong>ev, v = fa.get_eigenvalues()<br/>ev<br/>plt.plot(range(1,x.shape[1]+1),ev)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/d0d0e8f7a483798e566bf210413a5212.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/0*s4q2wl8fnZAKS3go.png"/></div></figure><p id="5a1f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">考虑到第三个因子后特征值的大幅下降，我们在这里只使用 3 个因子。这些因子的特征值分别为 3.7、2.3 和 2.1，这意味着它们描述了大约 8.1 个变量的方差。</p><p id="4c57" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">FactorAnalyzer 函数用于指定所需的因子数量以及旋转类型。简单来说，旋转的思想是旋转因子，以便实现更简单、更可解释的结构。存在许多类型的旋转。下面，我将使用 varimax 旋转，它使平方负载的方差之和最大化，同时确保创建的因子不相关(正交性)。我们来看看是哪些因素造成的。</p><pre class="lf lg lh li gt lr ls lt lu aw lv bi"><span id="ddc6" class="lw lx it ls b gy ly lz l ma mb">fa = FactorAnalyzer(3, rotation='varimax')<br/>fa.fit(x)<br/>loads = fa.loadings_<br/>print(loads)</span></pre><p id="84c8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">出局:</p><pre class="lf lg lh li gt lr ls lt lu aw lv bi"><span id="fdb1" class="lw lx it ls b gy ly lz l ma mb">[[ 0.16826952  0.12827119  0.75809134]<br/> [-0.02950837  0.05968117  0.50138365]<br/> [ 0.03023106  0.02091435  0.93277526]<br/> [-0.0338282  -0.03231121  0.50404385]<br/> [ 0.75263893  0.01094635  0.00616734]<br/> [ 0.39545345  0.1138114   0.35906543]<br/> [ 0.78999049  0.08146326  0.02725824]<br/> [ 0.7456934   0.46674984  0.01203424]<br/> [ 0.09388069  0.70115382  0.02900913]<br/> [ 0.07445487  0.48144209  0.08065029]<br/> [ 0.02346305  0.76474833  0.02769279]<br/> [ 0.14351222  0.28418169  0.02888186]<br/> [ 0.01813146  0.79977083  0.01825226]<br/> [ 0.85842046  0.08814824 -0.00170807]]</span></pre><p id="3436" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因子负载越高，变量对所述因子越重要。这里将使用 0.5 的负载截止值。这个临界值决定了哪些变量属于哪个因子。例如，我们看到第一个因子包含变量 5、7、8 和 14(分别为 0.75、0.78、0.74 和 0.85 的载荷)。</p><p id="508a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是创建的 3 个因素、它们包含的变量及其可能的“可解释性”:</p><ol class=""><li id="f74f" class="ng nh it kk b kl km ko kp kr ni kv nj kz nk ld nl nm nn no bi translated"><strong class="kk iu">舒适度</strong>:食物和饮料、座位舒适度、机上娱乐、清洁度</li><li id="d066" class="ng nh it kk b kl np ko nq kr nr kv ns kz nt ld nl nm nn no bi translated"><strong class="kk iu">服务</strong>:机上服务、行李搬运、机上服务</li><li id="617c" class="ng nh it kk b kl np ko nq kr nr kv ns kz nt ld nl nm nn no bi translated"><strong class="kk iu">便利性</strong>:机上 Wifi、出发/到达时间便利性、在线预订、登机口位置。</li></ol><p id="3367" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这很好，但是我们怎么知道我们的因素是好的呢？那么，克朗巴赫阿尔法可以用来衡量一个因素的变量是否形成一个“连贯”和可靠的因素。α值大于 0.6 实际上是可以接受的。下面是使用 pingouin 包获取 Cronbach alpha 的代码。</p><pre class="lf lg lh li gt lr ls lt lu aw lv bi"><span id="0fc7" class="lw lx it ls b gy ly lz l ma mb">!pip install pingouin<br/>import pingouin as pg</span><span id="5bd4" class="lw lx it ls b gy mc lz l ma mb"><strong class="ls iu"><em class="ne">#Create the factors</em><br/></strong>factor1 = df[['Food and drink', 'Seat comfort', 'Inflight entertainment', 'Cleanliness']]<br/>factor2 = df[['On-board service', 'Baggage handling', 'Inflight service']]<br/>factor3 = df[['Inflight wifi service', 'Departure/Arrival time convenient', 'Ease of Online booking', 'Gate location']]</span><span id="d8c3" class="lw lx it ls b gy mc lz l ma mb"><strong class="ls iu"><em class="ne">#Get cronbach alpha</em><br/></strong>factor1_alpha = pg.cronbach_alpha(factor1)<br/>factor2_alpha = pg.cronbach_alpha(factor2)<br/>factor3_alpha = pg.cronbach_alpha(factor3)</span><span id="2e50" class="lw lx it ls b gy mc lz l ma mb">print(factor1_alpha, factor2_alpha, factor3_alpha)</span></pre><p id="5edc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">出局:</p><pre class="lf lg lh li gt lr ls lt lu aw lv bi"><span id="06a6" class="lw lx it ls b gy ly lz l ma mb">(0.876288, array([0.875, 0.878])) (0.794292, array([0.792, 0.796])) (0.767975, array([0.766, 0.77 ]))</span></pre><p id="fc1a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">α被评估为 0.87、0.79 和 0.76，这表明它们是有用的和连贯的。我们可以使用这些新的因素作为变量进行其他分析或预测。下面是将因子应用于整个数据帧并创建 3 个新变量的代码，这 3 个变量可用于替换 14 个变量。</p><pre class="lf lg lh li gt lr ls lt lu aw lv bi"><span id="bc4b" class="lw lx it ls b gy ly lz l ma mb">new_variables = fa.fit_transform(x)</span></pre><p id="86f1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">非常感谢你的阅读！</p></div></div>    
</body>
</html>