<html>
<head>
<title>My Python Pandas Cheat Sheet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的蟒蛇熊猫小抄</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/my-python-pandas-cheat-sheet-746b11e44368?source=collection_archive---------3-----------------------#2020-03-22">https://towardsdatascience.com/my-python-pandas-cheat-sheet-746b11e44368?source=collection_archive---------3-----------------------#2020-03-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a131" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">作为一名数据科学家和软件工程师，我每天都在使用熊猫的功能</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d44bf0aa092b5022846e7a45dbabb1ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wXkIJWBE_InOAu5Plf7TIg.png"/></div></div></figure><p id="a7dd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">一位导师曾经告诉我，软件工程师就像索引而不是教科书；我们不会记住所有的东西，但是我们知道如何快速查找。</p><p id="fe47" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">能够快速查找和使用函数，可以让我们在编写代码时达到一定的流程。所以我创建了这个函数清单，我每天都用它来构建网络应用和机器学习模型。</p><p id="8e19" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这不是一个全面的列表，但是包含了我最常用的函数，一个例子，以及我对什么时候它最有用的见解。</p><p id="b238" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">内容:<br/> </strong> 1)设置<br/> 2)导入<br/> 3)导出<br/> 4)查看和检查<br/> 5)选择<br/> 6)添加/删除<br/> 7)合并<br/> 8)过滤<br/> 9)分类<br/> 10)聚集<br/> 11)清洗<br/> 12)其他<br/> 13)结论</p><h1 id="cac3" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">1)设置</h1><p id="ea31" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">如果你想自己运行这些例子，从Kaggle下载<a class="ae mn" href="https://www.kaggle.com/CooperUnion/anime-recommendations-database" rel="noopener ugc nofollow" target="_blank">动漫推荐</a>数据集，解压后放到你jupyter笔记本的同一个文件夹里。</p><p id="036c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">接下来运行这些命令，你应该能够复制我的以下任何函数的结果。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="e589" class="mt lr it mp b gy mu mv l mw mx">import pandas as pd<br/>import numpy as np</span><span id="a3f0" class="mt lr it mp b gy my mv l mw mx">anime = pd.read_csv('anime-recommendations-database/anime.csv')<br/>rating = pd.read_csv('anime-recommendations-database/rating.csv')</span><span id="d13f" class="mt lr it mp b gy my mv l mw mx">anime_modified = anime.set_index('name')</span></pre><h1 id="eb60" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">2)导入</h1><h2 id="726a" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">加载CSV</h2><p id="e35e" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">将CSV直接转换为数据框。有时从CSV加载数据也需要指定一个<code class="fe nk nl nm mp b">encoding</code>(即:<code class="fe nk nl nm mp b">encoding='ISO-8859–1'</code>)。如果您的数据框包含不可读字符，这是您应该尝试的第一件事。</p><p id="fb0f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">另一个类似的函数叫做excel文件的<code class="fe nk nl nm mp b">pd.read_excel</code>。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="2c0f" class="mt lr it mp b gy mu mv l mw mx">anime = pd.read_csv('anime-recommendations-database/anime.csv')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nn"><img src="../Images/3f9da650f11aa75539258b4c28ce5628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zeYLkHyXykS790SDEypOlw.png"/></div></div></figure><h2 id="569a" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">从输入的数据构建数据框架</h2><p id="dc93" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">当您想要手动实例化简单数据时非常有用，这样您就可以看到数据在管道中流动时是如何变化的。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="51d5" class="mt lr it mp b gy mu mv l mw mx">df = pd.DataFrame([[1,'Bob', 'Builder'],<br/>                  [2,'Sally', 'Baker'],<br/>                  [3,'Scott', 'Candle Stick Maker']], <br/>columns=['id','name', 'occupation'])</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi gj"><img src="../Images/5c46b9ad330fdfaaa2a3513dddbee1e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8ZwPjOp47nij-u8T2TzqHA.png"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated">df.head()</p></figure><h2 id="a8fb" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">复制数据框</h2><p id="b68f" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">当您想要在保留原始数据框副本的同时对数据框进行更改时，此功能非常有用。加载完所有数据帧后立即<code class="fe nk nl nm mp b">copy</code>是一个很好的做法。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="4d69" class="mt lr it mp b gy mu mv l mw mx">anime_copy = anime.copy(deep=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ns"><img src="../Images/38df6fa0cc796641dee53dd249910ffd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4AWxZC4RVJlk2Xa4Ucbdlg.png"/></div></div></figure><h1 id="5407" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">3)出口</h1><h2 id="4629" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated"><strong class="ak">保存到CSV </strong></h2><p id="88ed" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">这会转储到与笔记本相同的目录中。我只保存下面的前10行，但你不需要这样做。同样，<code class="fe nk nl nm mp b">df.to_excel()</code>也存在，功能基本相同，为excel文件。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="50f9" class="mt lr it mp b gy mu mv l mw mx">rating[:10].to_csv('saved_ratings.csv', index=False)</span></pre><h1 id="ba13" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">4)查看和检查</h1><h2 id="b670" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">获取顶部或底部<code class="fe nk nl nm mp b">n</code>记录</h2><p id="08ef" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">显示数据框中的第一个<code class="fe nk nl nm mp b">n</code>记录。我经常在笔记本的某个地方打印一个数据框的顶部记录，这样如果我忘记了里面的内容，我就可以参考它。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="9b06" class="mt lr it mp b gy mu mv l mw mx">anime.head(3)<br/>rating.tail(1)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/43f641f1f091583453794cfbc139f786.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*esMUqyuK8-ai5f8QndSAWg.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/7329be33e169b4b2232dd4a13f42456b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FTm6T70itm4NXdK4a8PmyQ.png"/></div></div></figure><h2 id="b12a" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated"><strong class="ak">计算行数</strong></h2><p id="eb2c" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">这本身不是一个pandas函数，但是<code class="fe nk nl nm mp b">len()</code>计算行数，并且可以保存到一个变量中并在其他地方使用。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="62ab" class="mt lr it mp b gy mu mv l mw mx">len(df)<br/>#=&gt; 3</span></pre><h2 id="97e6" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">计算唯一的行</h2><p id="cff4" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">对列中的唯一值进行计数。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="0438" class="mt lr it mp b gy mu mv l mw mx">len(ratings['user_id'].unique())</span></pre><h2 id="8bf8" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">获取数据框信息</h2><p id="ed74" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">有用的获得一些一般信息，如标题，值的数量和列的数据类型。一个类似但不太有用的函数是<code class="fe nk nl nm mp b">df.dtypes</code>，它只给出列数据类型。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="d21f" class="mt lr it mp b gy mu mv l mw mx">anime.info()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/edd27df4c76b94b6a045191a5d568e9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lz7PcE0FsCphmVnsyd3vhQ.png"/></div></div></figure><h2 id="efc8" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">获取统计数据</h2><p id="e590" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">如果数据框包含大量数值，这将非常有用。了解评级列的平均值、最小值和最大值可以让我们了解数据框的整体外观。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="f176" class="mt lr it mp b gy mu mv l mw mx">anime.describe()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/6d0d933e74049e2016db01ece591750a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DUOkUnk6NxNhKtQQlgdApA.png"/></div></div></figure><h2 id="e453" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">获取值的计数</h2><p id="ff5b" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">获取特定列的值的计数。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="80cd" class="mt lr it mp b gy mu mv l mw mx">anime.type.value_counts()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/f899cac46aca60aeee1b09b462591e65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gzhrO8UADiNKsC4wPdhOqQ.png"/></div></div></figure><h1 id="3d74" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">5)选择</h1><h2 id="39cb" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">获取列的值列表或系列</h2><p id="3d6e" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">如果您需要将列中的值放入<code class="fe nk nl nm mp b">X</code>和<code class="fe nk nl nm mp b">y</code>变量中，这样您就可以适应机器学习模型，那么这种方法是有效的。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="e602" class="mt lr it mp b gy mu mv l mw mx">anime['genre'].tolist()<br/>anime['genre']</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/d3b9c2c01af741db75b8fa8bca9cc8ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2yHt3PJl0YY1fJjsBpunCg.png"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated">动漫【流派】。tolist()</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/9113ebfbbd84467e599ec26785b17b32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_YAZrga1KrtZ7f53RpptuQ.png"/></div></div><p class="no np gj gh gi nq nr bd b be z dk translated">动漫['流派']</p></figure><h2 id="2b67" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">获取索引值列表</h2><p id="55c4" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">从索引创建值列表。注意我在这里使用了<code class="fe nk nl nm mp b">anime_modified</code>数据框，因为指数值更有趣。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="d15f" class="mt lr it mp b gy mu mv l mw mx">anime_modified.index.tolist()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/8aecb930876e6612397ae8ef4303bc1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ax5riqrXotEbxdSe6uMfg.png"/></div></div></figure><h2 id="6318" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">获取列值列表</h2><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="58f7" class="mt lr it mp b gy mu mv l mw mx">anime.columns.tolist()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/bbf9a0b082fb8067277b4723158e2634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lG1tsnka4tDgpglZNcva8Q.png"/></div></div></figure><h1 id="a198" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">6)添加/删除</h1><h2 id="007a" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">用设定值追加新列</h2><p id="58fc" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">当我在两个独立的数据帧中有测试和训练集，并希望在组合它们之前标记哪些行与哪些集相关时，我有时会这样做。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="b828" class="mt lr it mp b gy mu mv l mw mx">anime['train set'] = True</span></pre><h2 id="7d42" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">从列的子集创建新的数据框</h2><p id="86cd" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">当您只想保留大型数据框中的几列，而不想指定要删除的每一列时，这种方法非常有用。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="c13a" class="mt lr it mp b gy mu mv l mw mx">anime[['name','episodes']]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/86e4909a8f638b1a7f4f07a121d51dba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lW7nLrkmXEYrKIexAk_NpA.png"/></div></div></figure><h2 id="ad15" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">删除指定的列</h2><p id="49e8" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">当您只需要删除几列时非常有用。否则，把它们都写出来会很乏味，我更喜欢前一个选项。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="7e06" class="mt lr it mp b gy mu mv l mw mx">anime.drop(['anime_id', 'genre', 'members'], axis=1).head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/16d368c12be0d79a0468931c09fc79d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ta-8MNb1Y3YQuSMScrqANg.png"/></div></div></figure><h2 id="6dbe" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">添加包含其他行总和的行</h2><p id="a07f" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">我们将在这里手动创建一个小数据框，因为这样更容易查看。这里有趣的部分是<code class="fe nk nl nm mp b">df.sum(axis=0)</code>，它将各行的值相加。或者，<code class="fe nk nl nm mp b">df.sum(axis=1)</code>将各列的值相加。</p><p id="4473" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">当计算计数或平均值时，同样的逻辑也适用，即:<code class="fe nk nl nm mp b">df.mean(axis=0)</code>。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="5018" class="mt lr it mp b gy mu mv l mw mx">df = pd.DataFrame([[1,'Bob', 8000],<br/>                  [2,'Sally', 9000],<br/>                  [3,'Scott', 20]], columns=['id','name', 'power level'])</span><span id="666e" class="mt lr it mp b gy my mv l mw mx">df.append(df.sum(axis=0), ignore_index=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/fda7b95f355ec69bf5c0b593b8238d3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GW6L-6gt-2TxxL4cXc7XWA.png"/></div></div></figure><h1 id="cb99" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">7)合并</h1><h2 id="2656" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">连接两个数据帧</h2><p id="f5f8" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">如果您有两个具有相同列的数据框，并且想要合并它们，请使用此选项。</p><p id="370a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在这里，我们将一个数据帧一分为二，然后将它们重新组合在一起。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="01b0" class="mt lr it mp b gy mu mv l mw mx">df1 = anime[0:2]</span><span id="f1ba" class="mt lr it mp b gy my mv l mw mx">df2 = anime[2:4]</span><span id="8e45" class="mt lr it mp b gy my mv l mw mx">pd.concat([df1, df2], ignore_index=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/e687cf0d12b7c65713973df648de37d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nd6BsIy9qjzDvWoRMq66eg.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/c4f6a299e66a15ec9e498a338268a4a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4f1t3GD8EObPkZHMUZGC6g.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/179d0058dfc1e1a4fc1be2ca86c7f9ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K2JGXw0LaKZ7zyBQZLAPOg.png"/></div></div></figure><h2 id="738c" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">合并数据帧</h2><p id="a7ac" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">当您有两个数据框并且想要在一列上连接时，这类似于SQL左连接。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="fb30" class="mt lr it mp b gy mu mv l mw mx">rating.merge(anime, left_on=’anime_id’, right_on=’anime_id’, suffixes=(‘_left’, ‘_right’))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/395c238d91e5ceca9afc93cc45d8becb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q1YhgOgTCT37bZpDaqzckg.png"/></div></div></figure><h1 id="fbdc" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">8)过滤</h1><h2 id="111f" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">检索具有匹配索引值的行</h2><p id="77fa" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated"><code class="fe nk nl nm mp b">anime_modified</code>中的索引值是动漫的名称。请注意我们如何使用这些名称来获取特定的列。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="b556" class="mt lr it mp b gy mu mv l mw mx">anime_modified.loc[['Haikyuu!! Second Season','Gintama']]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/5406dcda4ff9c07e2fbf5eff4c11d176.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tHczEFcBCQrfZj8v39TQ5w.png"/></div></div></figure><h2 id="a828" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">按编号索引值检索行</h2><p id="40c3" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">这与之前的功能不同。使用<code class="fe nk nl nm mp b">iloc</code>，第一行的索引为<code class="fe nk nl nm mp b">0</code>，第二行的索引为<code class="fe nk nl nm mp b">1</code>，以此类推……即使您已经修改了数据框，并且现在在索引列中使用字符串值。</p><p id="bdbe" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果您想要数据框中的前3行，请使用此选项。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="0281" class="mt lr it mp b gy mu mv l mw mx">anime_modified.iloc[0:3]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/b139bcd85e4c2510f7ec327edecf3e60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fQ-brJ7z30MSoSO37_e3FQ.png"/></div></div></figure><h2 id="a2a0" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">获取行</h2><p id="3af5" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">检索列值在给定列表中的行。<code class="fe nk nl nm mp b">anime[anime[‘type’] == 'TV']</code>在匹配单个值时也有效。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="8bef" class="mt lr it mp b gy mu mv l mw mx">anime[anime['type'].isin(['TV', 'Movie'])]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/ec2a27c0d2d5123b80f6fea5b9ff0832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AVullPsjhMdMZOLEuAP-lQ.png"/></div></div></figure><h2 id="d748" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">切片数据帧</h2><p id="1e03" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">这就像分割一个列表。对数据帧进行切片，以获取指定索引之前/之间/之后的所有行。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="7d40" class="mt lr it mp b gy mu mv l mw mx">anime[1:3]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/cb86266cf768ff9f16ffd441f516094e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b6aYu1K3-RJ1JP1jC8Klow.png"/></div></div></figure><h2 id="8f04" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">按值过滤</h2><p id="0aa1" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">过滤满足条件的行的数据框。请注意，这将保持现有的索引值。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="d643" class="mt lr it mp b gy mu mv l mw mx">anime[anime['rating'] &gt; 8]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/795c188e29887a4c14a8002a443f7c93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LvUVNHPktfm2u7aLeE9Z_A.png"/></div></div></figure><h1 id="cc0f" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">9)分类</h1><h2 id="cca1" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">排序值</h2><p id="6e17" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">按列中的值对数据框排序。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="509d" class="mt lr it mp b gy mu mv l mw mx">anime.sort_values('rating', ascending=False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/198b6e9085bf91d65777e3b745608f97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oNJQ5Jg6-blJDsk76VxvEQ.png"/></div></div></figure><h1 id="ed8f" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">10)聚集</h1><h2 id="b241" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">分组和计数</h2><p id="8854" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">计算列中每个不同值的记录数。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="e87e" class="mt lr it mp b gy mu mv l mw mx">anime.groupby('type').count()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/f3b9a26af816a63391ef36beeeb2c909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MPH4IsEAOQC6C_aFRkqZUg.png"/></div></div></figure><h2 id="85e2" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">Groupby和聚合列的方式不同</h2><p id="4674" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">注意，我添加了<code class="fe nk nl nm mp b">reset_index()</code>,否则<code class="fe nk nl nm mp b">type</code>列将成为索引列——我建议在大多数情况下也这样做。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="704f" class="mt lr it mp b gy mu mv l mw mx">anime.groupby(["type"]).agg({<br/>  "rating": "sum",<br/>  "episodes": "count",<br/>  "name": "last"<br/>}).reset_index()</span></pre><h2 id="a88b" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">创建数据透视表</h2><p id="8353" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">对于从数据框中提取数据子集来说，没有比数据透视表更好的了。</p><p id="396f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">请注意，我已经对数据框进行了严格的过滤，这样可以更快地构建数据透视表。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="12cd" class="mt lr it mp b gy mu mv l mw mx">tmp_df = rating.copy()<br/>tmp_df.sort_values('user_id', ascending=True, inplace=True)<br/>tmp_df = tmp_df[tmp_df.user_id &lt; 10] <br/>tmp_df = tmp_df[tmp_df.anime_id &lt; 30]<br/>tmp_df = tmp_df[tmp_df.rating != -1]</span><span id="ea68" class="mt lr it mp b gy my mv l mw mx">pd.pivot_table(tmp_df, values='rating', index=['user_id'], columns=['anime_id'], aggfunc=np.sum, fill_value=0)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/61858e97f43e320ecf6c5afe40acdabe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fOtyaEZnxKwZLFLJ1dSm6Q.png"/></div></div></figure><h1 id="25ac" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">11)清洁</h1><h2 id="ed4e" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">将NaN单元格设置为某个值</h2><p id="3d20" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">将<code class="fe nk nl nm mp b">NaN</code>值的单元格设置为<code class="fe nk nl nm mp b">0</code>。在这个例子中，我们创建了与之前相同的数据透视表，但是没有<code class="fe nk nl nm mp b">fill_value=0</code>，然后使用<code class="fe nk nl nm mp b">fillna(0)</code>来填充它们。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="6fc8" class="mt lr it mp b gy mu mv l mw mx">pivot = pd.pivot_table(tmp_df, values='rating', index=['user_id'], columns=['anime_id'], aggfunc=np.sum)</span><span id="a3fd" class="mt lr it mp b gy my mv l mw mx">pivot.fillna(0)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/04248180ae7ec40aec2059829f56365b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MqP7V9rSrEuhrQH0895PoQ.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi om"><img src="../Images/dfd0ce649f9ed86973d483e0e99ebc26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OxoJJvFDIQWumz_pc26Nvw.png"/></div></div></figure><h1 id="957b" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">12)其他</h1><h2 id="f1d9" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">对数据帧进行采样</h2><p id="2334" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">我一直用这个从一个大的数据框架中抽取一个小样本。它允许随机重新排列行，同时保持索引。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="9c60" class="mt lr it mp b gy mu mv l mw mx">anime.sample(frac=0.25)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nt"><img src="../Images/23a419c424e3b341d0f0b46112d935de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mwmBMFMFT4YOC8Gooo2OQA.png"/></div></div></figure><h2 id="02fe" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">迭代行索引</h2><p id="2e3d" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">迭代数据框中的索引和行。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="f48d" class="mt lr it mp b gy mu mv l mw mx">for idx,row in anime[:2].iterrows():<br/>    print(idx, row)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/de79b27129ccd2adf56df2f8d487e002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4c9lln3Wn9Y4PLbwPMkGGQ.png"/></div></div></figure><h2 id="75a9" class="mt lr it bd ls mz na dn lw nb nc dp ma ld nd ne mc lh nf ng me ll nh ni mg nj bi translated">启动jupyter笔记本</h2><p id="29d1" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">以非常高的数据速率限制启动笔记本电脑。</p><pre class="kj kk kl km gt mo mp mq mr aw ms bi"><span id="82de" class="mt lr it mp b gy mu mv l mw mx">jupyter notebook — NotebookApp.iopub_data_rate_limit=1.0e10</span></pre><h1 id="4226" class="lq lr it bd ls lt lu lv lw lx ly lz ma jz mb ka mc kc md kd me kf mf kg mg mh bi translated">13)结论</h1><p id="2bb6" class="pw-post-body-paragraph ku kv it kw b kx mi ju kz la mj jx lc ld mk lf lg lh ml lj lk ll mm ln lo lp im bi translated">我希望这也能成为你的参考指南。随着我发现更多有用的熊猫功能，我会不断更新。</p><p id="89d1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如果有任何你离不开的功能，请在下面的评论中发表！</p></div></div>    
</body>
</html>