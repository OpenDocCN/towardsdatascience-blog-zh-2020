<html>
<head>
<title>Getting Amazon Price Drop alert using this Python script</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用这个Python脚本获取Amazon价格下降警报</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/getting-amazon-price-drop-alert-using-this-python-script-616a98bcba6b?source=collection_archive---------39-----------------------#2020-06-01">https://towardsdatascience.com/getting-amazon-price-drop-alert-using-this-python-script-616a98bcba6b?source=collection_archive---------39-----------------------#2020-06-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e805" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">刮亚马逊获得降价预警！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/06e67a3fab9110df26382e73b4525265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f8lWlmSRM5ximHik5gkwVA.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">格伦·卡斯滕斯·彼得斯——<a class="ae kv" href="http://www.unsplash.com" rel="noopener ugc nofollow" target="_blank">Unsplash</a>的照片</p></figure><p id="8505" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Python做了很多奇妙的事情。而且，这种美丽的语言几乎没有做不到的事情。当涉及到数据分析、web抓取或任务自动化时，大量的库使得这种语言一枝独秀。</p><blockquote class="ls lt lu"><p id="a5e8" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">试想一下，你想买一部新iPhone。你厌倦了一遍又一遍地查看亚马逊网站。但是，它的价格没有下降，你总是失望。</p></blockquote><p id="49d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果，有一个自动价格检查器，会给你一个电子邮件提醒，如果有价格下降。令人兴奋，不是吗？让我们通过编写一个Python脚本来做同样的事情。</p><p id="e264" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">库配料</strong></p><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="6790" class="me mf iq ma b gy mg mh l mi mj">import smtplib<br/>import time<br/>import requests as rq<br/>from bs4 import BeautifulSoup</span></pre><p id="49c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">主要有三个库可以为我们完成这项工作。Requests库将与HTTP服务器通信，Beautiful Soup将与网页通信并提取网页元素，smtplib将向您发送电子邮件警报。</p><p id="8ada" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">肉</strong> <strong class="ky ir">码</strong></p><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="7fef" class="me mf iq ma b gy mg mh l mi mj">site = "https://www.amazon.in/Apple-iPhone-11-64GB-Green/dp/B07XVKBY68/ref=sr_1_7?keywords=iphone+11&amp;qid=1573668357&amp;sr=8-7"</span><span id="ebf3" class="me mf iq ma b gy mk mh l mi mj">header = {'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.97 Safari/537.36'}</span></pre><p id="51ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，我已经请求了亚马逊iPhone网页的网络服务器。然后，我创建了一个soup对象来解析网页。我们只想要产品的价格。所以，使用“选择”方法，我们可以得到产品的价格。</p><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="85ce" class="me mf iq ma b gy mg mh l mi mj">def get_price():<br/>    html = rq.get(site, headers=header).text<br/>    soup = BeautifulSoup(html, 'html.parser')<br/>    price = [i.get_text() for i in<br/>             soup.find_all('span', {'class': 'a-size-medium a-color-price priceBlockBuyingPriceString'})]<br/><br/>    final_price = ''.join(price)[2:8]<br/>    final_price = int(final_price.replace(',', ''))<br/><br/>    if final_price &lt; 64900:<br/>        send_email()</span></pre><p id="de67" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，每当“新价”变得小于“刮价”时。必须向用户发送一封关于价格下降的电子邮件。</p><p id="d468" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用smtplib库向用户发送电子邮件。首先，我们将创建一个SMTP对象来与域的SMTP服务器通信。</p><p id="5991" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦一切都完成并设置好，我们就可以登录我们的电子邮件帐户了。然后，将电子邮件发送给收件人。</p><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="d010" class="me mf iq ma b gy mg mh l mi mj">def send_email():<br/>    server = smtplib.SMTP('smtp.gmail.com', 587)<br/>    server.ehlo()<br/>    server.starttls()<br/>    server.ehlo()<br/><br/>    server.login('Your email address', 'Application-specific password')<br/><br/>    subject = "Price fell down"<br/>    body = "Check this link: https://www.amazon.in/Apple-iPhone-11-64GB-Green/dp/B07XVKBY68/ref=sr_1_7?keywords=iphone+11&amp;qid=1573668357&amp;sr=8-7"<br/>    msg = f"Subject:{subject}\n\n{body}"<br/><br/>    server.sendmail('Sender's email', 'Recipient email', msg)<br/><br/>    print("Hey, email has been sent!")<br/>    server.quit()</span></pre><blockquote class="ls lt lu"><p id="9c50" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">注意:smtplib中的参数可能会更改。SMTP()取决于域的SMTP服务器。如果您有Gmail帐户，您必须为您的电子邮件地址生成特定于应用程序的密码。否则，当您的程序试图登录时，您将得到一个特定于应用程序的需要密码的错误消息。</p></blockquote><pre class="kg kh ki kj gt lz ma mb mc aw md bi"><span id="5f7b" class="me mf iq ma b gy mg mh l mi mj">while True:<br/>    get_price()<br/>    time.sleep(60)</span></pre><p id="117d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这40-50行代码将为您完成这项工作。下一次，你不必一次又一次地查看网站上的价格下降。为其他电子商务网站制作这样的程序，节省您的时间和精力。</p><p id="2588" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有关讨论和疑问，请通过<a class="ae kv" href="http://linkedin.com/in/vishal-sharma-239965140" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>联系我！</p></div></div>    
</body>
</html>