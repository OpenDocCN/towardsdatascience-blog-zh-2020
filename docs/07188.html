<html>
<head>
<title>Create beautiful and simple ML web apps that you can deploy at scale in a few steps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建美观简单的 ML web 应用程序，只需几个步骤就可以大规模部署</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-beautiful-and-simple-ml-web-apps-that-you-can-deploy-at-scale-in-a-few-steps-2d7d62cf8601?source=collection_archive---------51-----------------------#2020-06-01">https://towardsdatascience.com/create-beautiful-and-simple-ml-web-apps-that-you-can-deploy-at-scale-in-a-few-steps-2d7d62cf8601?source=collection_archive---------51-----------------------#2020-06-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="71ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本文将教你如何使用<a class="ae ko" href="https://www.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>和<a class="ae ko" href="https://docs.aws.amazon.com/cdk/latest/guide/home.html" rel="noopener ugc nofollow" target="_blank"> AWS CDK </a>从头开始构建一个 ML 驱动的 web 应用，并从头到尾大规模部署到 AWS Fargate。</p><p id="31ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你可以看看<a class="ae ko" href="https://github.com/nicolasmetallo/legendary-streamlit-demo" rel="noopener ugc nofollow" target="_blank">这个回购</a>的代码。</p></div><div class="ab cl kp kq hx kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="im in io ip iq"><h1 id="dcf8" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">我们要建造什么？</h1><p id="0e03" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">我们将创建一个 web 应用程序，它可以为我们变魔术。这个技巧就是让某些东西从图像中“消失”。为此，我们将使用一种叫做<strong class="js iu">图像修复</strong>的东西，或者说是一种处理过程，在这种过程中，你获取图像中丢失的部分，然后根据背景信息对其进行恢复。我们将研究关于该主题的最新研究论文之一，该论文将于 2020 年 CVPR 上发表，名为<strong class="js iu">“超高分辨率图像修复的上下文残差聚合”</strong>。你可以阅读<a class="ae ko" href="https://arxiv.org/abs/2005.09704" rel="noopener ugc nofollow" target="_blank">易等人【2020】</a>在 arXiv 中的论文，并在<a class="ae ko" href="https://github.com/Atlas200dk/sample-imageinpainting-HiFill" rel="noopener ugc nofollow" target="_blank">本回购</a>中看到其代码实现。</p><p id="aa1f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但在我们实际运行任何图像内画之前，我们需要生成一个遮罩图像，该图像将只在白色前景上显示黑色像素，而我们希望从照片中消失一些东西。您可以手动完成，也可以让计算机为您完成。如果您选择第二个选项，那么您的最佳选择是使用“语义分割”算法，该算法将进行最接近该对象形状的像素级分类。但是，因为我们想尽可能简单，我们将运行“对象检测”，在这些对象的顶部绘制边界框。结果不会那么好，但也足够好了。我们将使用<a class="ae ko" href="https://aws.amazon.com/rekognition/" rel="noopener ugc nofollow" target="_blank"> AWS Rekognition </a>，因为它使用简单，推理时间短。你总是可以从<a class="ae ko" href="https://gluon-cv.mxnet.io/contents.html" rel="noopener ugc nofollow" target="_blank"> GluonCV 网站</a>或者其他一些<a class="ae ko" href="https://github.com/facebookresearch/detectron2" rel="noopener ugc nofollow" target="_blank">非常好的框架</a>中了解到关于这两个(以及更多)计算机视觉应用的更多信息。</p><p id="e52f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">以下是我们期望得到的结果。您可以在左边看到输入图像(见下面的作者信息),在右边看到输出图像。您可以在<code class="fe lz ma mb mc b">demo.ipynb</code>笔记本中找到获得该结果所需的所有步骤。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi md"><img src="../Images/960793fad1dd6cd1edccdd07ba4786d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZH9T0bYTILVt2uuJcYtsHQ.png"/></div></div></figure><p id="d801" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但是，如果我们想要构建一个更具交互性、动态性、易于调试、非常适合与非技术人员共享模型和结果的东西，该怎么办呢？有一些选项可以帮助你做到这一点，比如 Jupyter Voila 和 Plotly Dash，但它们都不能同时做到所有这些。就在那时，我开始关注<a class="ae ko" href="https://www.streamlit.io/" rel="noopener ugc nofollow" target="_blank"> Streamlit </a>，这是一个开源应用程序框架，它运行在 Python 中，让你用很少的开发工作就能创建看起来很棒的 web 应用程序。我不会详细介绍什么是 Streamlit 以及它是如何工作的，但是您可以在这里看到许多示例和演示<a class="ae ko" href="https://awesome-streamlit.org/" rel="noopener ugc nofollow" target="_blank">，在这里</a>看到一些最佳实践<a class="ae ko" href="https://pmbaumgartner.github.io/streamlitopedia/front/introduction.html" rel="noopener ugc nofollow" target="_blank">。</a></p><h1 id="3448" class="kw kx it bd ky kz mp lb lc ld mq lf lg lh mr lj lk ll ms ln lo lp mt lr ls lt bi translated">入门指南</h1><p id="4f65" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">每个人都有自己处理这类项目的方式，但对我来说最有效的方式是遵循一种精益方法，在这种方法中，我可以快速设计/构建、度量和学习。这些是我通常会做的步骤:</p><ul class=""><li id="d089" class="mu mv it js b jt ju jx jy kb mw kf mx kj my kn mz na nb nc bi translated">创建一个演示笔记本，证明我可以做我希望做的事情，例如，拍摄一个输入图像并生成一个内画图像输出</li><li id="b4ea" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">创建一个 Streamlit 应用程序，它将包含与演示笔记本相同的步骤。</li><li id="fc9e" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">将所有东西安装到 AWS CDK 项目中，为部署做好准备。</li></ul><p id="52d5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我不会详细介绍第一步，但我会深入探讨如何构建一个 Streamlit 应用程序，以及一旦您知道它可以工作，如何让您的项目适合大规模部署。</p><h2 id="4e55" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">要求</h2><ul class=""><li id="7a34" class="mu mv it js b jt lu jx lv kb nu kf nv kj nw kn mz na nb nc bi translated">AWS 帐户</li><li id="844d" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated"><a class="ae ko" href="https://docs.aws.amazon.com/cdk/latest/guide/getting_started.html" rel="noopener ugc nofollow" target="_blank"> AWS CDK </a></li><li id="36cd" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated"><a class="ae ko" href="https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html" rel="noopener ugc nofollow" target="_blank"> AWS CLI </a></li><li id="ef37" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">码头工人</li></ul></div><div class="ab cl kp kq hx kr" role="separator"><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku kv"/><span class="ks bw bk kt ku"/></div><div class="im in io ip iq"><h1 id="6347" class="kw kx it bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">1)创建演示笔记本</h1><p id="cd0c" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">转到您的终端并克隆这个存储库</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="2d89" class="ni kx it mc b gy ob oc l od oe">$ git clone <a class="ae ko" href="https://github.com/nicolasmetallo/legendary-streamlit-demo" rel="noopener ugc nofollow" target="_blank">https://github.com/nicolasmetallo/legendary-streamlit-demo</a></span></pre><p id="9692" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，<code class="fe lz ma mb mc b">cd</code>进入<code class="fe lz ma mb mc b">cdk/app</code>，你会发现<code class="fe lz ma mb mc b">demo.ipynb</code>。安装所有依赖项并在笔记本中运行代码。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="2f57" class="ni kx it mc b gy ob oc l od oe">$ cd cdk/app<br/>$ pip install -r requirements.txt</span></pre><h1 id="26a9" class="kw kx it bd ky kz mp lb lc ld mq lf lg lh mr lj lk ll ms ln lo lp mt lr ls lt bi translated">2)创建您的 Streamlit 应用程序</h1><h2 id="d494" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">项目结构</h2><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="bc8c" class="ni kx it mc b gy ob oc l od oe">.<br/>├── LICENSE<br/>├── README.md<br/>└── cdk<br/>    ├── README.md<br/>    ├── app<br/>    │   ├── Dockerfile<br/>    │   ├── app.py<br/>    │   ├── demo.ipynb<br/>    │   ├── helpers.py<br/>    │   ├── requirements.txt<br/>    │   ├── src<br/>    │   │   ├── input_img.png<br/>    │   │   ├── local_container.png<br/>    │   │   └── magic_trick.png<br/>    │   └── test_images<br/>    │       ├── image_1.jpg<br/>    │       ├── image_2.jpg<br/>    │       ├── image_3.jpg<br/>    │       ├── image_4.jpg<br/>    │       ├── image_5.jpg<br/>    │       └── image_6.jpg<br/>    ├── app.py<br/>    ├── cdk<br/>    │   ├── __init__.py<br/>    │   └── cdk_stack.py<br/>    ├── cdk.json<br/>    ├── requirements.txt<br/>    └── setup.py</span></pre><h2 id="d03d" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">您的 Streamlit 应用的主要部分</h2><p id="1029" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">我们的应用程序将从不同的来源(URL、示例库、用户上传)读取一个输入图像，生成一个内画图像，最后将两者并排绘制在一起。</p><p id="7f35" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们要做的第一件事是导入依赖项和帮助函数。彼得·鲍姆加特纳写了一篇关于重构和编写模块化代码的好文章<a class="ae ko" href="https://pmbaumgartner.github.io/streamlitopedia/refactoring-and-writing-modular-code.html" rel="noopener ugc nofollow" target="_blank"/>,应该可以帮助你更好地组织你的代码。</p><h2 id="b8b7" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">助手函数(作为导入)</h2><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="204e" class="ni kx it mc b gy ob oc l od oe">from helpers import InPainting<br/>magic_trick = InPainting()</span></pre><h2 id="4d5d" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">助手功能(在 app.py 中)</h2><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="9d85" class="ni kx it mc b gy ob oc l od oe">def show_images(input_img, output_img):<br/>    f = plt.figure(figsize=(20,20))<br/>    f.add_subplot(1,2,1)<br/>    plt.imshow(input_img)<br/>    f.add_subplot(1,2,2)<br/>    plt.imshow(output_img)<br/>    plt.show(block=True)<br/>    st.pyplot(bbox_inches='tight')</span></pre><h2 id="d446" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">阅读您的输入图像</h2><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="cf4b" class="ni kx it mc b gy ob oc l od oe">st.header('Read image')<br/>    st.image(<br/>        'src/input_img.png',<br/>        caption='Illustration by <a class="ae ko" href="https://blush.design/artists/vijay-verma'" rel="noopener ugc nofollow" target="_blank">https://blush.design/artists/vijay-verma'</a>,<br/>        use_column_width=True,<br/>    )<br/>    options = st.radio('Please choose any of the following options',<br/>        (<br/>            'Choose example from library',<br/>            'Download image from URL',<br/>            'Upload your own image',<br/>        )<br/>    )</span><span id="9787" class="ni kx it mc b gy of oc l od oe">input_image = None<br/>    if options == 'Choose example from library':<br/>        image_files = list(sorted([x for x in Path('test_images').rglob('*.jpg')]))<br/>        selected_file = st.selectbox(<br/>            'Select an image file from the list', image_files<br/>        )<br/>        st.write(f'You have selected `{selected_file}`')<br/>        input_image = Image.open(selected_file)<br/>    elif options == 'Download image from URL':<br/>        image_url = st.text_input('Image URL')<br/>        try:<br/>            r = requests.get(image_url)<br/>            input_image = Image.open(io.BytesIO(r.content))<br/>        except Exception:<br/>            st.error('There was an error downloading the image. Please check the URL again.')<br/>    elif options == 'Upload your own image':<br/>        uploaded_file = st.file_uploader("Choose file to upload")<br/>        if uploaded_file:<br/>            input_image = Image.open(io.BytesIO(uploaded_file.read()))<br/>            st.success('Image was successfully uploaded')</span><span id="3475" class="ni kx it mc b gy of oc l od oe">if input_image:<br/>        st.image(input_image, use_column_width=True)<br/>        st.info('''<br/>        Image will be resized to fit within `(1024,1024)`<br/>        pixels for easier processing.<br/>        ''')<br/>    else:<br/>        st.warning('There is no image loaded.')</span></pre><h2 id="5917" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">在图像上运行您的模型推理</h2><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="cbf1" class="ni kx it mc b gy ob oc l od oe">st.header('Run prediction')<br/>    st.write('')<br/>    prediction_checkbox = st.checkbox('Do a magic trick!')<br/>    if input_image and prediction_checkbox:<br/>        try:<br/>            with st.spinner():<br/>                output_image = magic_trick.run_main(input_image)<br/>                show_images(input_image, output_image)<br/>        except Exception as e:<br/>            st.error(e)<br/>            st.error('There was an error processing the input image')</span></pre><h2 id="f550" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">帮助者. py</h2><p id="cf68" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">为了生成内画图像，我们需要输入图像和遮罩图像，其中除了我们的目标以外，每个像素都是白色的。如前所述，我们将使用 AWS Rekognition 来检测一个对象和一个自定义类，以根据该检测创建一个遮罩图像。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="8946" class="ni kx it mc b gy ob oc l od oe">class Rekognition:<br/>    def __init__(self):<br/>        self.client = boto3.client(<br/>            'rekognition',<br/>            region_name = 'eu-west-2', # not needed<br/>            )</span><span id="d9aa" class="ni kx it mc b gy of oc l od oe">def predict_labels(self, image_bytes, max_labels=10, min_conf=90):<br/>        response = self.client.detect_labels(<br/>            Image = {'Bytes': image_bytes},<br/>            MaxLabels = max_labels,<br/>            MinConfidence = min_conf,<br/>            )<br/>        return response['Labels']<br/>    <br/>    def return_mask_img(self, image_bytes):<br/>        image = Image.open(io.BytesIO(image_bytes))<br/>        imgWidth, imgHeight = image.size<br/>        blank = Image.new('RGB', image.size, (255, 255, 255))<br/>        draw = ImageDraw.Draw(blank)<br/>        response = self.predict_labels(image_bytes)<br/>        <br/>        for idx, label in enumerate(response):<br/>            name = label['Name']<br/>            instances = label['Instances']</span><span id="689a" class="ni kx it mc b gy of oc l od oe">if len(instances) == 0: continue<br/>            for instance in instances:<br/>                confidence = instance['Confidence']<br/>                box = instance['BoundingBox']<br/>                left = imgWidth * box['Left']<br/>                top = imgHeight * box['Top']<br/>                width = imgWidth * box['Width']<br/>                height = imgHeight * box['Height']</span><span id="7b5a" class="ni kx it mc b gy of oc l od oe">points = (<br/>                    (left, top),<br/>                    (left + width, top),<br/>                    (left + width, top + height),<br/>                    (left , top + height),<br/>                    (left, top),<br/>                )</span><span id="5567" class="ni kx it mc b gy of oc l od oe"># draw bounding box<br/>                draw.rectangle([left, top, left + width, top + height], fill='black')<br/>                <br/>        return blank</span></pre><p id="07f9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">一旦我们有了这两个图像，我们应该能够运行图像在绘画模型预测。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="3a73" class="ni kx it mc b gy ob oc l od oe">class InPainting:<br/>    def __init__(self):<br/>        self.rekognition = Rekognition() <br/>        self.multiple = 6<br/>        self.INPUT_SIZE = 512  # input image size for Generator<br/>        self.ATTENTION_SIZE = 32 # size of contextual attention<br/>        <br/>    def PIL_to_cv2(self, pil_img):<br/>        np_img = np.array(pil_img.convert('RGB'))<br/>        return cv2.cvtColor(np_img, cv2.COLOR_RGB2BGR)<br/>    <br/>    def PIL_to_image_bytes(self, img):<br/>        buffer = io.BytesIO()<br/>        img.save(buffer, format='JPEG')<br/>        return buffer.getvalue()<br/>    <br/>    def cv2_to_PIL(self, cv2_im):<br/>        cv2_im = cv2.cvtColor(cv2_im, cv2.COLOR_BGR2RGB)<br/>        return Image.fromarray(cv2_im)<br/>                <br/>    def run_main(self, input_image, max_size = (1024,1024)):<br/>        with tf.Graph().as_default():<br/>            with open('sample-imageinpainting-HiFill/GPU_CPU/pb/hifill.pb', "rb") as f:<br/>                output_graph_def = tf.GraphDef()<br/>                output_graph_def.ParseFromString(f.read())<br/>                tf.import_graph_def(output_graph_def, name="")</span><span id="dbd9" class="ni kx it mc b gy of oc l od oe">with tf.Session() as sess:<br/>                init = tf.global_variables_initializer()<br/>                sess.run(init)<br/>                image_ph = sess.graph.get_tensor_by_name('img:0')<br/>                mask_ph = sess.graph.get_tensor_by_name('mask:0')<br/>                inpainted_512_node = sess.graph.get_tensor_by_name('inpainted:0')<br/>                attention_node = sess.graph.get_tensor_by_name('attention:0')<br/>                mask_512_node = sess.graph.get_tensor_by_name('mask_processed:0')<br/>        <br/>                input_image.thumbnail(max_size)<br/>                image_bytes = self.PIL_to_image_bytes(input_image)<br/>                raw_mask = self.PIL_to_cv2(self.rekognition.return_mask_img(image_bytes))<br/>                raw_img = self.PIL_to_cv2(input_image)<br/>                inpainted = self.inpaint(<br/>                            raw_img, raw_mask, sess, inpainted_512_node, <br/>                            attention_node, mask_512_node, image_ph, mask_ph, self.multiple)<br/>                return self.cv2_to_PIL(inpainted)</span></pre><h2 id="5fd7" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">创建 Dockerfile 文件</h2><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="f5aa" class="ni kx it mc b gy ob oc l od oe">FROM python:3.7<br/>EXPOSE 8501<br/>WORKDIR /app<br/>COPY requirements.txt ./requirements.txt<br/>RUN pip3 install -r requirements.txt<br/>RUN git clone <a class="ae ko" href="https://github.com/Atlas200dk/sample-imageinpainting-HiFill.git" rel="noopener ugc nofollow" target="_blank">https://github.com/Atlas200dk/sample-imageinpainting-HiFill.git</a> &amp;&amp; \<br/>        cd sample-imageinpainting-HiFill &amp;&amp; \<br/>        git checkout 1f7f769bd1ea225d4d5c8b094dd261ca9172927b<br/>COPY . .<br/>CMD streamlit run app.py \<br/>    --server.headless true \<br/>    --browser.serverAddress="0.0.0.0" \<br/>    --server.enableCORS false \<br/>    --browser.gatherUsageStats false</span></pre><h2 id="0398" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">构建映像并在本地运行以进行调试</h2><p id="85e5" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">在您的终端中运行下面的命令来构建您的容器映像</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="7b93" class="ni kx it mc b gy ob oc l od oe">$ docker build -t demo/magic-trick .</span></pre><p id="4f9f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在运行容器</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="3dd5" class="ni kx it mc b gy ob oc l od oe">$ docker run -it — rm -p ‘8501:8501’ demo/magic-trick</span></pre><p id="e153" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你打开浏览器，进入<a class="ae ko" href="http://localhost:8501/`" rel="noopener ugc nofollow" target="_blank"> http://localhost:8501 </a>，你应该能看到下面的… <strong class="js iu">成功！😃</strong></p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi og"><img src="../Images/8c366041ef737b20b04d0f2097e6a4a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CsHN5uB_Cza9msvQN1H0nw.png"/></div></div></figure><h1 id="50b6" class="kw kx it bd ky kz mp lb lc ld mq lf lg lh mr lj lk ll ms ln lo lp mt lr ls lt bi translated">3)使用 AWS CDK 将您的 Streamlit 应用程序部署到 AWS Fargate</h1><h2 id="9d9d" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">快速介绍</h2><p id="6cc8" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated"><strong class="js iu"> AWS CDK </strong>是一个软件开发框架，用于在代码中定义云基础设施，并通过<strong class="js iu"> AWS CloudFormation </strong>进行配置，使您能够:</p><ul class=""><li id="710a" class="mu mv it js b jt ju jx jy kb mw kf mx kj my kn mz na nb nc bi translated">可预测地重复创建和配置 AWS 基础设施部署。</li><li id="0748" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">利用 AWS 产品，如 Amazon EC2、Amazon Elastic Block Store、Amazon SNS、Elastic Load Balancing 和 Auto Scaling。</li><li id="befd" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">在云中构建高度可靠、高度可伸缩、经济高效的应用程序，而无需担心创建和配置底层 AWS 基础架构。</li><li id="7584" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">使用模板文件将资源集合作为一个单元(堆栈)一起创建和删除。</li></ul><p id="a8f6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> AWS Fargate </strong>是亚马逊 ECS 和 EKS 的计算引擎，允许你运行容器，而不必管理服务器或集群。我们将使用这两种服务来轻松地大规模部署我们的容器。</p><p id="57e6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你不理解所有这些，不要太担心，因为有一个很好的<a class="ae ko" href="https://docs.aws.amazon.com/cdk/latest/guide/getting_started.html" rel="noopener ugc nofollow" target="_blank">入门指南</a>供你参考，还有<a class="ae ko" href="https://docs.aws.amazon.com/cdk/api/latest/python/index.html" rel="noopener ugc nofollow" target="_blank">官方 Python 参考文档</a>供你查阅。我将按照官方的<a class="ae ko" href="https://docs.aws.amazon.com/de_de/cdk/latest/guide/ecs_example.html" rel="noopener ugc nofollow" target="_blank"> ECS 示例</a>列出您需要完成的每个步骤，但是因为这些步骤中的大部分已经在此 repo 中完成(例如，创建项目目录)，所以在跳到下面的<strong class="js iu">部署您的堆栈</strong>之前，请随意初始化 AWS CDK 并安装所有依赖项。</p><h2 id="1277" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">配置您的 AWS 凭据</h2><p id="f12a" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">如果您打算从本地机器部署您的栈，您应该确保您的 AWS 凭证在您的环境中被正确设置。你可以在<a class="ae ko" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-files.html" rel="noopener ugc nofollow" target="_blank">文档</a>中了解更多信息。</p><p id="49da" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">打开您的终端并运行以下命令。当询问时，添加您的访问密钥和密钥。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="868e" class="ni kx it mc b gy ob oc l od oe">$ aws configure</span></pre><p id="4d52" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">另一方面，如果您打算从 AWS 实例(例如 EC2、SageMaker 等)部署您的堆栈。)然后，您的环境将采用您分配给该实例的凭证和角色，您不需要进行任何配置。你只需要仔细检查你的角色能不能做你想做的一切。</p><h2 id="a81c" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">安装自动气象站 CDK</h2><p id="2c03" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">转到您的终端，使用以下命令安装 AWS CDK。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="1a92" class="ni kx it mc b gy ob oc l od oe">$ npm install -g aws-cdk</span></pre><p id="ffcf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(可选)如果您需要更新 AWS CDK 版本，请运行</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="6053" class="ni kx it mc b gy ob oc l od oe">$ npm update -g aws-cdk</span></pre><p id="5b98" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">运行以下命令验证安装是否正确，并打印 AWS CDK 的版本号。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="fa68" class="ni kx it mc b gy ob oc l od oe">$ cdk — version</span></pre><h2 id="f7d8" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">更新您的语言依赖</h2><p id="a88a" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">如果您收到一条错误消息，提示您的语言框架已过期，请使用以下命令之一来更新 AWS CDK 支持该语言所需的组件。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="c3e0" class="ni kx it mc b gy ob oc l od oe">$ pip install — upgrade aws-cdk.core</span></pre><h2 id="3b48" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">创建您的项目目录并初始化 AWS CDK</h2><p id="e3bf" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">让我们首先创建一个保存 AWS CDK 代码的目录，然后在该目录中创建一个 AWS CDK 应用程序。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="ebe5" class="ni kx it mc b gy ob oc l od oe">$ mkdir cdk<br/>$ cd cdk<br/>$ cdk init — language python<br/>$ source .env/bin/activate<br/>$ pip install -r requirements.txt</span></pre><p id="0f69" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您生成的<code class="fe lz ma mb mc b">cdk/cdk_stack.py</code>应该是这样的。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="30a7" class="ni kx it mc b gy ob oc l od oe">from aws_cdk import core</span><span id="32b5" class="ni kx it mc b gy of oc l od oe">class CdkStack(core.Stack):</span><span id="3944" class="ni kx it mc b gy of oc l od oe">def __init__(self, scope: core.Construct, id: str, **kwargs) -&gt; None:<br/>        super().__init__(scope, id, **kwargs)</span><span id="21c5" class="ni kx it mc b gy of oc l od oe"># The code that defines your stack goes here</span></pre><p id="3e71" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">构建并运行应用程序，并确认它创建了一个空堆栈。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="cabb" class="ni kx it mc b gy ob oc l od oe">$ cdk synth</span></pre><p id="55c8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您应该看到如下所示的堆栈，其中<code class="fe lz ma mb mc b">CDK-VERSION</code>是<code class="fe lz ma mb mc b">CDK</code>的版本，<code class="fe lz ma mb mc b">NODE-VERSION</code>是 Node.js 的版本。)</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="58a0" class="ni kx it mc b gy ob oc l od oe">Resources:<br/>  CDKMetadata:<br/>    Type: AWS::CDK::Metadata<br/>    Properties:<br/>      Modules: aws-cdk=CDK-VERSION,<a class="ae ko" href="http://twitter.com/aws" rel="noopener ugc nofollow" target="_blank">@aws</a>-cdk/core=CDK-VERSION,<a class="ae ko" href="http://twitter.com/aws" rel="noopener ugc nofollow" target="_blank">@aws</a>-cdk/cx-api=CDK-VERSION,jsii-runtime=node.js/NODE-VERSION</span></pre><h2 id="9043" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">添加 Amazon EC2 和 Amazon ECS 包</h2><p id="6767" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">为 Amazon EC2 和 Amazon ECS 安装 AWS 构造库模块。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="b3b5" class="ni kx it mc b gy ob oc l od oe">$ pip install aws_cdk.aws_ec2 aws_cdk.aws_ecs aws_cdk.aws_ecs_patterns</span></pre><h2 id="6feb" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">创建一个 Fargate 服务</h2><p id="d37e" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">使用 Amazon ECS 运行容器任务有两种不同的方式:</p><ul class=""><li id="a7bb" class="mu mv it js b jt ju jx jy kb mw kf mx kj my kn mz na nb nc bi translated">使用<code class="fe lz ma mb mc b">Fargate</code>启动类型，Amazon ECS 为您管理运行容器的物理机器。</li><li id="93fc" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">使用<code class="fe lz ma mb mc b">EC2</code>启动类型，在这里进行管理，比如指定自动缩放。</li></ul><p id="9503" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于本例，我们将创建一个运行在 ECS 集群上的 Fargate 服务，它由一个面向互联网的应用程序负载平衡器提供支持。在此基础上，我们将向该集群添加自动伸缩功能，并将策略附加到任务角色，以便容器能够使用 AWS Rekognition。</p><p id="d09b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">将以下 AWS 构造库模块导入添加到指定的文件中。</p><p id="4706" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">文件:<code class="fe lz ma mb mc b">cdk/cdk_stack.py</code></p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="0776" class="ni kx it mc b gy ob oc l od oe">from aws_cdk import (<br/>    aws_ec2 as ec2,<br/>    aws_ecs as ecs,<br/>    aws_ecr as ecr,<br/>    aws_iam as iam,<br/>    aws_ecs_patterns as ecs_patterns,<br/>    core,<br/>)</span></pre><p id="315f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">用下面的代码替换构造函数末尾的注释。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="3fdc" class="ni kx it mc b gy ob oc l od oe"># Create a VPC<br/>        vpc = ec2.Vpc(<br/>            self, "WebDemoVPC", <br/>            max_azs = 2,<br/>            )     # default is all AZs in region, <br/>                  # but you can limit to avoid reaching resource quota</span><span id="e7c6" class="ni kx it mc b gy of oc l od oe"># Create ECS cluster<br/>        cluster = ecs.Cluster(self, "WebDemoCluster", vpc=vpc)</span><span id="6f86" class="ni kx it mc b gy of oc l od oe"># Add an AutoScalingGroup with spot instances to the existing cluster<br/>        cluster.add_capacity("AsgSpot",<br/>            max_capacity=2,<br/>            min_capacity=1,<br/>            desired_capacity=2,<br/>            instance_type=ec2.InstanceType("c5.xlarge"),<br/>            spot_price="0.0735",<br/>            # Enable the Automated Spot Draining support for Amazon ECS<br/>            spot_instance_draining=True<br/>        )</span><span id="a684" class="ni kx it mc b gy of oc l od oe"># Build Dockerfile from local folder and push to ECR<br/>        image = ecs.ContainerImage.from_asset('app')</span><span id="04c9" class="ni kx it mc b gy of oc l od oe"># Create Fargate service<br/>        fargate_service = ecs_patterns.ApplicationLoadBalancedFargateService(<br/>            self, "WebDemoService",<br/>            cluster=cluster,            # Required<br/>            cpu=512,                    # Default is 256 (512 is 0.5 vCPU)<br/>            desired_count=1,            # Default is 1<br/>            task_image_options=ecs_patterns.ApplicationLoadBalancedTaskImageOptions(<br/>                image=image, <br/>                container_port=8501,<br/>                ),<br/>            memory_limit_mib=2048,      # Default is 512<br/>            public_load_balancer=True)  # Default is True</span><span id="f311" class="ni kx it mc b gy of oc l od oe"># Add policies to task role<br/>        fargate_service.task_definition.add_to_task_role_policy(iam.PolicyStatement(<br/>            effect=iam.Effect.ALLOW,<br/>            actions = ["rekognition:*"],<br/>            resources = ["*"],<br/>            )<br/>        )</span><span id="f040" class="ni kx it mc b gy of oc l od oe"># Setup task auto-scaling<br/>        scaling = fargate_service.service.auto_scale_task_count(<br/>            max_capacity=10<br/>        )<br/>        scaling.scale_on_cpu_utilization(<br/>            "CpuScaling",<br/>            target_utilization_percent=50,<br/>            scale_in_cooldown=core.Duration.seconds(60),<br/>            scale_out_cooldown=core.Duration.seconds(60),<br/>        )</span></pre><p id="41ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">设置 AWS CDK Python 脚本时需要考虑的一些事项</p><ul class=""><li id="c105" class="mu mv it js b jt ju jx jy kb mw kf mx kj my kn mz na nb nc bi translated">CloudFormation 尚不支持 Fargate Spot 实例(截至 2020 年 5 月 31 日)</li><li id="83e2" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">任务执行角色不同于任务角色。基本上，执行角色是执行 ECS 操作(如推和拉映像)的角色，任务角色是任务本身调用其他 AWS 服务(如 Rekognition、S3 等)所使用的角色。在<a class="ae ko" href="https://stackoverflow.com/questions/48999472/difference-between-aws-elastic-container-services-ecs-executionrole-and-taskr" rel="noopener ugc nofollow" target="_blank"> StackOverflow 问题</a>中了解更多信息。</li><li id="a84d" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">我们已经建立了一个 ECS 集群，它具有一个包含 spot 实例的自动扩展组，并且当 cpu 利用率增加到 50%以上时，可以启动多达 10 个新任务。你可以在这里阅读更多关于任务自动缩放<a class="ae ko" href="https://docs.aws.amazon.com/cdk/api/latest/python/aws_cdk.aws_ecs.README.html#task-auto-scaling" rel="noopener ugc nofollow" target="_blank">的内容。</a></li><li id="c1cb" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated">不要在每次想要部署项目时构建容器映像并将其推送到 ECR，您还可以从 ECR 存储库中提取一个现有的映像。你可以用</li></ul><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="9f49" class="ni kx it mc b gy ob oc l od oe">repository = ecr.Repository.from_repository_arn(<br/>        self, "{repository-name}",<br/>        "arn:aws:ecr:{region-name}:{account-id}:repository/{repository-name}")<br/>    image = ecs.ContainerImage.from_ecr_repository(repository=repository, tag="latest")</span></pre><h2 id="4127" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">部署您的堆栈</h2><p id="5f60" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">当您的应用程序只有一个堆栈时，不需要指定堆栈名称，您可以运行</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="7e8a" class="ni kx it mc b gy ob oc l od oe">$ cdk deploy</span></pre><p id="4881" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果您得到一个错误，如</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="d1d6" class="ni kx it mc b gy ob oc l od oe">This stack uses assets, so the toolkit stack must be deployed to the environment (Run “cdk bootstrap aws://unknown-account/unknown-region”)</span></pre><p id="a60a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后，在运行<code class="fe lz ma mb mc b">cdk deploy</code>之前，您需要引导您的默认概要文件所使用的帐户。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="a0b7" class="ni kx it mc b gy ob oc l od oe">$ cdk bootstrap<br/>…<br/>✅ Environment aws://{your-account-id}/{your-region-name} bootstrapped.</span></pre><p id="af9e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">整个过程大约需要 10 到 20 分钟，因为我们也在将我们的容器映像推送到 ECR。一旦该过程成功结束，您应该会看到类似这样的内容:</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="30dd" class="ni kx it mc b gy ob oc l od oe">✅ cdk</span><span id="c99f" class="ni kx it mc b gy of oc l od oe">Outputs:<br/>cdk.WebDemoServiceLoadBalancerDNS******A5 = cdk-WebDemo-PV******KA7D-******197.eu-west-2.elb.amazonaws.com<br/>cdk.WebDemoServiceServiceURL******7B = <a class="ae ko" href="http://cdk-WebDemo-PV******KA7D-******197.eu-west-2.elb.amazonaws.com" rel="noopener ugc nofollow" target="_blank">http://cdk-WebDemo-PV******KA7D-******197.eu-west-2.elb.amazonaws.com</a></span><span id="b779" class="ni kx it mc b gy of oc l od oe">Stack ARN:<br/>arn:aws:cloudformation:eu-west-2:************:stack/cdk/c7f457f0-a34d-11ea-a167-******e602c</span></pre><p id="8c2b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在，当你打开浏览器，进入<code class="fe lz ma mb mc b">cdk.WebDemoServiceServiceURL</code>，你会看到你的应用程序。请注意，由于我们只为该任务分配了 0.5 个 vCPU，所以推断时间会很长，在 20 到 30 秒之间。但是您可以随时返回，更改这一点，并使用<code class="fe lz ma mb mc b">cdk deploy</code>重新部署。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/e01a56726675857aad6fad9e77424e2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/1*b1oKb5proEAs5bmpgpJYzg.gif"/></div></figure><p id="b8f5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">恭喜你！您的应用程序现已上线</strong>😃</p><h2 id="5dd8" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">删除您的 AWS CDK 项目</h2><p id="30fb" class="pw-post-body-paragraph jq jr it js b jt lu jv jw jx lv jz ka kb lw kd ke kf lx kh ki kj ly kl km kn im bi translated">如果你不再希望你的应用程序存在，你可能需要清除 AWS CDK 设置的所有东西，以避免招致任何意想不到的成本。</p><pre class="me mf mg mh gt nx mc ny nz aw oa bi"><span id="8367" class="ni kx it mc b gy ob oc l od oe">$ cdk destroy</span></pre><h2 id="80b5" class="ni kx it bd ky nj nk dn lc nl nm dp lg kb nn no lk kf np nq lo kj nr ns ls nt bi translated">参考</h2><ul class=""><li id="0f06" class="mu mv it js b jt lu jx lv kb nu kf nv kj nw kn mz na nb nc bi translated">易，张，唐，张，徐，(2020)。超高分辨率图像修复的上下文残差聚合。*arXiv 预印本 arXiv:2005.09704*</li></ul><p id="dec9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">图片包含在</strong> <code class="fe lz ma mb mc b"><strong class="js iu">test_images</strong></code> <strong class="js iu">文件夹中</strong></p><ul class=""><li id="5730" class="mu mv it js b jt ju jx jy kb mw kf mx kj my kn mz na nb nc bi translated"><code class="fe lz ma mb mc b">image_1.jpg</code>，蒂姆·多弗勒，<a class="ae ko" href="https://unsplash.com/photos/dQT6hKtRWRw" rel="noopener ugc nofollow" target="_blank">链接</a></li><li id="f25d" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated"><code class="fe lz ma mb mc b">image_2.jpg</code>、巴特尔米·德·马泽诺德、<a class="ae ko" href="https://unsplash.com/photos/iw0SowaRxeY" rel="noopener ugc nofollow" target="_blank">链接</a></li><li id="e45e" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated"><code class="fe lz ma mb mc b">image_3.jpg</code>、唐纳德·詹纳蒂、<a class="ae ko" href="https://unsplash.com/photos/E9AyOAQL2R4" rel="noopener ugc nofollow" target="_blank">链接</a></li><li id="fbc2" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated"><code class="fe lz ma mb mc b">image_4.jpg</code>、韩亚库米、<a class="ae ko" href="https://unsplash.com/photos/vNVPAKf1GO4" rel="noopener ugc nofollow" target="_blank">链接</a></li><li id="b287" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated"><code class="fe lz ma mb mc b">image_5.jpg</code>、纪尧姆·德·热尔曼、<a class="ae ko" href="https://unsplash.com/photos/h1itWfWeQM4" rel="noopener ugc nofollow" target="_blank">链接</a></li><li id="3212" class="mu mv it js b jt nd jx ne kb nf kf ng kj nh kn mz na nb nc bi translated"><code class="fe lz ma mb mc b">image_6.jpg</code>、帖木儿【罗马诺夫】、<a class="ae ko" href="https://unsplash.com/photos/YgoLFkdrD8Q" rel="noopener ugc nofollow" target="_blank">链接</a></li></ul></div></div>    
</body>
</html>