<html>
<head>
<title>The Ultimate Guide To SMS: Spam or Ham Classifier Using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SMS 终极指南:使用 Python 的垃圾邮件或火腿分类器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-ultimate-guide-to-sms-spam-or-ham-detector-85f3c824e55a?source=collection_archive---------27-----------------------#2020-08-01">https://towardsdatascience.com/the-ultimate-guide-to-sms-spam-or-ham-detector-85f3c824e55a?source=collection_archive---------27-----------------------#2020-08-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="8a76" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph">人工智能概念的方法</h2><div class=""/><div class=""><h2 id="9b8b" class="pw-subtitle-paragraph jz jc it bd b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq dk translated">开发垃圾邮件或火腿分类器的详细报告:第 3 部分</h2></div><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kr"><img src="../Images/5662e9d75b32e0755bbd73354436f889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kAFUtb4i2R7K2ecRg4AYLA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">用<a class="ae lh" href="https://www.canva.com/templates/EADaoQ4RN_g-city-buildings-facebook-cover/" rel="noopener ugc nofollow" target="_blank"> Canva 设计。</a>插图来自<a class="ae lh" href="https://undraw.co/" rel="noopener ugc nofollow" target="_blank">未画</a>。</p></figure><p id="7141" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">TL；博士</strong>从人工智能概念的角度理解垃圾邮件或火腿分类器，使用各种分类算法，选择高精度产生算法，开发 Python Flask 应用。</p><blockquote class="me mf mg"><p id="9857" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated"><strong class="lk jd">该博客是博文</strong>的一个系列，如果您没有读过垃圾邮件或火腿分类器的理论人工智能概念，也没有在 jupyter notebook 中使用过算法，请访问:</p></blockquote><div class="ml mm gp gr mn mo"><a rel="noopener follow" target="_blank" href="/the-ultimate-guide-to-sms-spam-or-ham-detector-aec467aecd85"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd jd gy z fp mt fr fs mu fu fw jc bi translated">短信终极指南:垃圾邮件还是火腿探测器</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">开发垃圾邮件或火腿分类器的详细报告:第 1 部分</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">towardsdatascience.com</p></div></div><div class="mx l"><div class="my l mz na nb mx nc lb mo"/></div></div></a></div><div class="ml mm gp gr mn mo"><a rel="noopener follow" target="_blank" href="/the-ultimate-guide-to-sms-spam-or-ham-detector-67c179bc94dc"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd jd gy z fp mt fr fs mu fu fw jc bi translated">短信终极指南:垃圾邮件还是火腿探测器</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">开发垃圾邮件或火腿分类器的详细报告:第 2 部分</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">towardsdatascience.com</p></div></div><div class="mx l"><div class="nd l mz na nb mx nc lb mo"/></div></div></a></div><p id="064d" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">我们已经在第 1 部分&amp; 2 </strong>中介绍过</p><ul class=""><li id="2eae" class="ne nf it lk b ll lm lo lp lr ng lv nh lz ni md nj nk nl nm bi translated">关于垃圾邮件或火腿分类器的理论人工智能概念</li><li id="b961" class="ne nf it lk b ll nn lo no lr np lv nq lz nr md nj nk nl nm bi translated">分类算法</li><li id="c670" class="ne nf it lk b ll nn lo no lr np lv nq lz nr md nj nk nl nm bi translated">探索数据源</li><li id="cea8" class="ne nf it lk b ll nn lo no lr np lv nq lz nr md nj nk nl nm bi translated">数据准备</li><li id="1527" class="ne nf it lk b ll nn lo no lr np lv nq lz nr md nj nk nl nm bi translated">探索性数据分析</li></ul><p id="190e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">我们将在第 3 部分</strong>对此进行介绍</p><ul class=""><li id="adb8" class="ne nf it lk b ll lm lo lp lr ng lv nh lz ni md nj nk nl nm bi translated">垃圾邮件或火腿背后的朴素贝叶斯</li><li id="2c5d" class="ne nf it lk b ll nn lo no lr np lv nq lz nr md nj nk nl nm bi translated">绩效衡量标准</li><li id="1bfd" class="ne nf it lk b ll nn lo no lr np lv nq lz nr md nj nk nl nm bi translated">垃圾邮件检测器的开发</li></ul><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ns"><img src="../Images/d17bc65950854760a673d9127c7e2766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s8LPLNGB8-1cXUhRkn1ZLA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">由作者设计。从<a class="ae lh" href="https://undraw.co/" rel="noopener ugc nofollow" target="_blank">展开</a>的图示。</p></figure><h2 id="ab49" class="nt nu it bd nv nw nx dn ny nz oa dp ob lr oc od oe lv of og oh lz oi oj ok iz bi translated">垃圾邮件或火腿背后的朴素贝叶斯</h2><blockquote class="ol"><p id="a3ff" class="om on it bd oo op oq or os ot ou md dk translated">贝叶斯规则最有用的应用之一是所谓的朴素贝叶斯分类器。</p></blockquote><p id="8065" class="pw-post-body-paragraph li lj it lk b ll ov kd ln lo ow kg lq lr ox lt lu lv oy lx ly lz oz mb mc md im bi translated">朴素贝叶斯算法为 SMS 消息的分类创建了一个概率模型。尽管所有特征都对分类的总体概率有贡献，但朴素贝叶斯算法假设这些特征在统计上彼此独立[10]。虽然这种假设可能并不适用于所有情况，但与其他众所周知的分类算法相比，朴素贝叶斯算法已经显示出有希望的结果。朴素贝叶斯的一个优点是，它只需要少量的训练数据来估计分类所需的参数，并且由于数据集较小，朴素贝叶斯分类器可以胜过更强大的备选方案[18]。因为假设了独立变量，所以只需要确定每类变量的方差，而不是整个协方差矩阵。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pa"><img src="../Images/a22b5b9c5e8fedbfd9178067337177fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0IPNc3rz6eIpBSiTKNzvFQ.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">贝叶斯法则。图片由<a class="ae lh" href="https://www.norwegiancreations.com/2018/09/artificial-intelligence-bayes-network/" rel="noopener ugc nofollow" target="_blank">尼尔斯雅各布沙</a></p></figure><p id="3752" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">因此，对于垃圾邮件或 ham 中的 SMS 分类，项目想要计算的概率是:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/15226d48c33a1392433f0267c3b9d292.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*q6dkqxH4WMVxjYjlcz-cZg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">图片由塞巴斯蒂安·拉什卡提供。</p></figure><p id="f32e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">其中 x 是包含来自垃圾(或 Ham) SMS 文本的单词的特征向量[11]。</p><p id="0ecd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">Prior(spam) =“任何新消息是垃圾消息的概率”</p><p id="a202" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">火腿<strong class="lk jd"> : </strong> P(火腿)<strong class="lk jd"/>= 1p(垃圾)</p><h2 id="2625" class="nt nu it bd nv nw nx dn ny nz oa dp ob lr oc od oe lv of og oh lz oi oj ok iz bi translated">绩效衡量标准</h2><p id="7996" class="pw-post-body-paragraph li lj it lk b ll pc kd ln lo pd kg lq lr pe lt lu lv pf lx ly lz pg mb mc md im bi translated">它是正确分类的邮件的相对数量，正确分类的邮件的百分比用作评估过滤器性能的附加度量。然而，已经强调指出，使用准确性作为唯一的性能指标是不够的。必须考虑其他性能指标，如召回率、精确度、ROC 曲线下面积(AUC)和信息检索领域中使用的派生度量，决策理论中使用的假阳性和假阴性也是如此[12]。ROC 曲线及其相关曲线对于探索不同分类器在一系列成本上的权衡非常有用。粗略地说，曲线下的面积越大，性能越好。为了确定其他三个标准，首先项目应该定义一些术语:</p><p id="4070" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">真阳性(TP): </strong>被正确分类的合法短信的比率。</p><p id="2305" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">误报(FP): </strong>垃圾短信被正确分类的比率。</p><p id="8115" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">真阴性(TN): </strong>合法短信被错误分类为垃圾短信的比率。</p><p id="bfe4" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">误报(FN): </strong>垃圾短信被误认为合法短信的比率。</p><p id="28cb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">误报错误，它将合法的 SMS 转移为垃圾邮件，通常被认为比误报更严重。</p><p id="e1dd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">现在，所谓的性能测量标准可以定义为:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/21799ca73f4d8a46a9afe554673b42ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*52lLn0Te34EQtAg_mx7Fvg.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><em class="pi">模型的性能标准。图片作者。</em></p></figure><p id="685e" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">实际上，召回决定了正确分类的合法消息(文本)的比例，精度决定了所有正确分类的合法消息(文本)的比例，准确性决定了所有正确分类的消息(文本)的比例。</p><p id="a632" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">从项目(<a class="ae lh" href="https://github.com/maladeep/sms-spam-ham-detector/blob/master/notebookEDA.ipynb" rel="noopener ugc nofollow" target="_blank">见代码</a>)上看使用朴素贝叶斯混淆矩阵是:</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi pj"><img src="../Images/60351e3f9c6b3513ac26a4500a943e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FxyZh8F93BSBlXU1RSEFhA.png"/></div></div><p class="ld le gj gh gi lf lg bd b be z dk translated">混淆矩阵值。图片作者。</p></figure><p id="8b83" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">这表明该项目确实有对称数据集，其中假阳性(14)和假阴性(15)的值几乎相同。因此，该项目不需要查看其他参数来评估模型的性能[19]。然而，出于研究目的，该项目计算了以下矩阵。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/723e73eead1bd8206a2a33d34c7e5f73.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*_FMFTlsKv68-prDQRsJ3QQ.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><em class="pi">模型的性能矩阵。图片作者。</em></p></figure><p id="92fd" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">精度</strong>:精度是正确预测的正观测值与总预测正观测值之比。这个指标回答的问题是，在所有被标记为垃圾邮件的文本中，有多少实际上是垃圾邮件？高精度与低假阳性率相关。这个模型有 0.99 的精度，相当不错。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/4544c80b218304addc6ee9a966276252.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*KlLKAp4SPMsYbBUCkmk34Q.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated"><em class="pi">精密公式。图片作者。</em></p></figure><p id="1bfa" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">召回(灵敏度)</strong>:召回是正确预测的正面观察值与实际类中所有观察值的比率——是的。回忆回答的问题是:在所有真正垃圾的文本中，模型标记了多少？该模型的召回率为 0.93，这对该模型来说是好的，因为它高于 0.5。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/99b3cc4eea54ab56077632d29d6afbad.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*nZ5iNwB0mciaav0_vL105Q.png"/></div><p class="ld le gj gh gi lf lg bd b be z dk translated">回忆公式。图片作者。</p></figure><blockquote class="me mf mg"><p id="ac02" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated">从代理、环境、PEAS 等人工智能概念开始，探索七种二进制分类算法，执行矢量化、TF-IDF、EDA，实现算法并从混淆矩阵、精确度、召回率评估性能，我们创建了基于 web 的 SMS:Spam 或 Ham 检测器。</p></blockquote><h1 id="2161" class="pn nu it bd nv po pp pq ny pr ps pt ob ki pu kj oe kl pv km oh ko pw kp ok px bi translated">结论</h1><p id="cdc0" class="pw-post-body-paragraph li lj it lk b ll pc kd ln lo pd kg lq lr pe lt lu lv pf lx ly lz pg mb mc md im bi translated">朴素贝叶斯分类算法是处理分类数据的有效方法。它使用的基本理论是贝叶斯条件概率模型，用于在给定特定条件下寻找后验概率。之所以称之为“天真”，是因为假设数据集中的所有特征(单词集合)都是同等重要和独立的。使用朴素贝叶斯分类算法，该项目根据垃圾邮件包含的单词预测垃圾邮件的准确率超过 98%。为了使预测更加准确，项目需要增加数据集中的数据数量。</p><p id="d5bc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">我们的工作就此结束。现在，如果你想<strong class="lk jd">自己实现代码</strong>，那么请访问我的<a class="ae lh" href="https://github.com/maladeep/sms-spam-ham-detector" rel="noopener ugc nofollow" target="_blank"> GitHub </a>并克隆这本书并玩它。</p><p id="7c23" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">与最终产品互动</strong></p><div class="ml mm gp gr mn mo"><a href="https://sms-spam-ham-detector.herokuapp.com/" rel="noopener  ugc nofollow" target="_blank"><div class="mp ab fo"><div class="mq ab mr cl cj ms"><h2 class="bd jd gy z fp mt fr fs mu fu fw jc bi translated">垃圾短信|火腿</h2><div class="mv l"><h3 class="bd b gy z fp mt fr fs mu fu fw dk translated">这个项目的数据集取自 UCI 机器学习行动执行的 EDA 算法使用 Bagging…</h3></div><div class="mw l"><p class="bd b dl z fp mt fr fs mu fu fw dk translated">sms-spam-ham-detector.herokuapp.com</p></div></div></div></a></div><blockquote class="me mf mg"><p id="53d5" class="li lj mh lk b ll lm kd ln lo lp kg lq mi ls lt lu mj lw lx ly mk ma mb mc md im bi translated"><em class="it">如果你对这篇文章有任何疑问，或者想在你的下一个数据科学项目上合作，请在</em><a class="ae lh" href="https://www.linkedin.com/in/maladeep/" rel="noopener ugc nofollow" target="_blank"><em class="it">LinkedIn</em></a><em class="it">上 ping 我。</em></p></blockquote></div><div class="ab cl py pz hx qa" role="separator"><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd"/></div><div class="im in io ip iq"><h1 id="eb77" class="pn nu it bd nv po qf pq ny pr qg pt ob ki qh kj oe kl qi km oh ko qj kp ok px bi translated">推荐读物</h1><ul class=""><li id="2ca0" class="ne nf it lk b ll pc lo pd lr qk lv ql lz qm md nj nk nl nm bi translated"><a class="ae lh" href="https://sebastianraschka.com/Articles/2014_naive_bayes_1.html#References" rel="noopener ugc nofollow" target="_blank">朴素贝叶斯和文本分类</a></li><li id="8349" class="ne nf it lk b ll nn lo no lr np lv nq lz nr md nj nk nl nm bi translated"><a class="ae lh" href="https://blog.exsilio.com/all/accuracy-precision-recall-f1-score-interpretation-of-performance-measures/" rel="noopener ugc nofollow" target="_blank">准确度、精确度、召回率&amp; F1 分数:性能测量的解释</a></li><li id="3359" class="ne nf it lk b ll nn lo no lr np lv nq lz nr md nj nk nl nm bi translated"><a class="ae lh" rel="noopener" target="_blank" href="/machine-learning-classifiers-a5cc4e1b0623">机器学习分类器</a></li></ul></div><div class="ab cl py pz hx qa" role="separator"><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd qe"/><span class="qb bw bk qc qd"/></div><div class="im in io ip iq"><p id="844a" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated"><strong class="lk jd">参考文献</strong></p><p id="f4eb" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[10] Androutsopoulos，I .，Koutsias，j .，Chandrinos，K. V .，Paliouras，g .，和斯皮罗普洛斯特区(2000 年)。对朴素贝叶斯反垃圾邮件过滤的评估。arXiv 预印本 cs/0006013。</p><p id="b4bc" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[11] Chávez，G.(2019 年 2 月 28 日)“用五个步骤实现用于文本分类的朴素贝叶斯分类器”。检索于 2020 年 2 月 21 日，来自 https://towards data science . com/implementing-a-nave-Bayes-classifier-for-text-categorization-in-five-steps-f 9192 cdd 54 c 3</p><p id="ccd3" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[12] Dada，例如 Bassi，J. S .，Chiroma，h .，Adetunmbi，A. O .，&amp; Ajibuwa，O. E. (2019 年)。垃圾邮件过滤的机器学习:综述、方法和开放研究问题。Heliyon，5(6)，e01802。</p><p id="2c2c" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[16] <strong class="lk jd"> </strong> P. Domingos 和 M. Pazzani，“零一损失下简单贝叶斯分类器的最优性”，机器学习，第 29 卷，第 2-3 期，第 103-130 页，1997 年</p><p id="d308" class="pw-post-body-paragraph li lj it lk b ll lm kd ln lo lp kg lq lr ls lt lu lv lw lx ly lz ma mb mc md im bi translated">[19] Joshi，R.(2016 年 9 月 9 日)。“准确度、精确度、召回率和 F1 分数:性能指标的解释”。2020 年 3 月 5 日检索，来自<a class="ae lh" href="https://blog.exsilio.com/all/accuracy-precision-recall-f1-score-interpretation-of-performance-measures/" rel="noopener ugc nofollow" target="_blank">https://blog . ex silio . com/all/accuracy-precision-recall-f1-score-interpretation-of-performance-measures/</a></p></div></div>    
</body>
</html>