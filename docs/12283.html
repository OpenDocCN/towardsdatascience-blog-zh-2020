<html>
<head>
<title>fairmodels: let’s fight with biased Machine Learning models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">fairmodels:让我们和有偏见的机器学习模型战斗吧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fairmodels-lets-fight-with-biased-machine-learning-models-f7d66a2287fc?source=collection_archive---------38-----------------------#2020-08-24">https://towardsdatascience.com/fairmodels-lets-fight-with-biased-machine-learning-models-f7d66a2287fc?source=collection_archive---------38-----------------------#2020-08-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="76df" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第 3 部分:缓解</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/67eca9f527f651f2fb24f2731241d328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CE2FGAcvbWYA_2jjpG0C6w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><h2 id="5769" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">TL；速度三角形定位法(dead reckoning)</h2><p id="51d5" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">R 包<a class="ae mk" href="https://github.com/ModelOriented/FairModels" rel="noopener ugc nofollow" target="_blank"><strong class="lt ir">fair models</strong></a><strong class="lt ir"/>通过模型可视化促进了<strong class="lt ir">偏差检测。</strong>它实施了一些可以减少偏差的缓解策略。它能够方便地检查公平性指标，并在不同的机器学习(ML)模型之间进行比较。</p><h2 id="36e3" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">长版本</h2><p id="a3ba" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">偏见抑制是机器学习公平领域的一个重要课题。对于 python 用户来说，已经有一些算法被实现、很好地解释和描述(参见<a class="ae mk" href="http://aif360.mybluemix.net/check" rel="noopener ugc nofollow" target="_blank"> AIF360 </a>)。<strong class="lt ir"> fairmodels </strong>提供了一些流行的、有效的偏差缓解技术的实现，可以让你的模型更加公平。</p><h1 id="2ec9" class="ml kw iq bd kx mm mn mo la mp mq mr ld jw ms jx lh jz mt ka ll kc mu kd lp mv bi translated">我有一个有偏差的模型，现在怎么办？</h1><p id="f34b" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">有一个有偏见的模型并不是世界末日。有很多方法可以处理它。<strong class="lt ir"> fairmodels </strong>实现了各种算法来帮助你解决这个问题。首先，我必须描述一下预处理算法和后处理算法之间的区别。</p><ul class=""><li id="c2ec" class="mw mx iq lt b lu my lx mz le na li nb lm nc mj nd ne nf ng bi translated"><strong class="lt ir">预处理</strong>算法在模型训练前对数据进行处理。他们试图通过数据推断来减轻特权子群和非特权子群之间的偏差。</li><li id="d5aa" class="mw mx iq lt b lu nh lx ni le nj li nk lm nl mj nd ne nf ng bi translated"><strong class="lt ir">后处理</strong>算法改变用<a class="ae mk" href="https://github.com/ModelOriented/DALEX" rel="noopener ugc nofollow" target="_blank"> DALEX </a>解释的模型的输出，使其输出不那么偏向特权子群。</li></ul><h1 id="22a1" class="ml kw iq bd kx mm mn mo la mp mq mr ld jw ms jx lh jz mt ka ll kc mu kd lp mv bi translated">这些算法是如何工作的？</h1><p id="590b" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">在本节中，我将简要描述这些偏差缓解技术的工作原理。这里使用的更详细的例子和一些可视化代码可以在<a class="ae mk" href="https://modeloriented.github.io/fairmodels/articles/Advanced_tutorial.html" rel="noopener ugc nofollow" target="_blank">这篇短文</a>中找到。</p><h1 id="bca9" class="ml kw iq bd kx mm mn mo la mp mq mr ld jw ms jx lh jz mt ka ll kc mu kd lp mv bi translated">预处理</h1><h2 id="5c6a" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">不同的冲击消除器<a class="ae mk" href="https://arxiv.org/abs/1412.3756" rel="noopener ugc nofollow" target="_blank">(费尔德曼等人，2015) </a></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nm"><img src="../Images/17977ded72ef968064426cdd7ab1c5ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p6EbbdwXIHI6lIgk83avkA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)完全不同的影响消除。蓝色和红色分布被转换成“中间”分布。</p></figure><p id="085a" class="pw-post-body-paragraph lr ls iq lt b lu my jr lw lx mz ju lz le nn mb mc li no me mf lm np mh mi mj ij bi translated">该算法适用于数字、序数特征。它更改列值，使非特权(蓝色)和特权(红色)子组的分布彼此接近。一般来说，我们希望我们的算法不要根据特性的价值来判断，而是根据百分位数来判断(例如，从两个小组中雇用 20%的最佳申请人)。该算法的工作方式是，它找到这样的分布，即最小化<a class="ae mk" href="https://en.wikipedia.org/wiki/Earth_mover%27s_distance" rel="noopener ugc nofollow" target="_blank">推土机的距离</a>。简而言之，它找到“中间”分布，并为每个子组更改该特征的值。</p><h2 id="25b8" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">重新加权<a class="ae mk" href="https://link.springer.com/content/pdf/10.1007/s10115-011-0463-8.pdf" rel="noopener ugc nofollow" target="_blank">(卡米兰等人，2012 年)</a></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/390c80660023263b776fab0ba920b98c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ROlYonREbmVQ18QKxqjjQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)在这个模型示例中，S=1 是一个特权子群。S 和 y 的每个唯一组合都有一个权重。</p></figure><p id="5f83" class="pw-post-body-paragraph lr ls iq lt b lu my jr lw lx mz ju lz le nn mb mc li no me mf lm np mh mi mj ij bi translated">重新加权是一种简单而有效的工具，可以最大限度地减少偏差。该算法查看受保护的属性和真实标签。然后，假设受保护的属性和 y 是独立的，它计算分配有利标签(y=1)的概率。当然，如果有偏差，他们会有统计上的依赖性。然后，该算法将计算出的理论概率除以该事件的真实经验概率。重量就是这样产生的。利用这两个向量(受保护变量和 y ),我们可以为数据中的每个观察值创建权重向量。然后，我们将它传递给模型。就这么简单。但是一些模型没有权重参数，因此不能从该方法中受益。</p><h2 id="4291" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">重采样<a class="ae mk" href="https://link.springer.com/content/pdf/10.1007/s10115-011-0463-8.pdf" rel="noopener ugc nofollow" target="_blank">(卡米兰等人，2012 年)</a></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/75d617ebec23e88782033f9fd0f10a8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j8ITKuNgSiMLO2v6F1uJ2g.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)均匀采样。圆圈表示重复，x 表示省略观察。</p></figure><p id="ab7e" class="pw-post-body-paragraph lr ls iq lt b lu my jr lw lx mz ju lz le nn mb mc li no me mf lm np mh mi mj ij bi translated">重采样与先前的方法密切相关，因为它隐含地使用重新加权来计算在特定情况下必须省略/重复多少个观察值。假设有 2 组人，被剥夺的(S = 0)和被偏爱的(S = 1)。当标签为正时，该方法复制来自剥夺子群的观察值，并省略标签为负的观察值。然后对有利的组执行相反的操作。实现了两种重采样方法- <em class="nr">均匀</em>和<em class="nr">优先</em>。<em class="nr">均匀</em>随机选取观察值(如图所示)，而<em class="nr">优先</em>利用概率选取/忽略接近截止值的观察值(默认值为 0.5)。</p><h1 id="626a" class="ml kw iq bd kx mm mn mo la mp mq mr ld jw ms jx lh jz mt ka ll kc mu kd lp mv bi translated">后处理</h1><p id="2a0c" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">后处理发生在创建解释器之后。为了创建解释器，我们需要模型和<a class="ae mk" href="https://github.com/ModelOriented/DALEX" rel="noopener ugc nofollow" target="_blank"> DALEX </a>解释器。<em class="nr"> Gbm </em>模型将在<a class="ae mk" href="https://modeloriented.github.io/fairmodels/reference/adult.html" rel="noopener ugc nofollow" target="_blank"> <em class="nr">成人</em> </a> <em class="nr"> </em>数据集上训练，预测某个人年收入是否超过 5 万。</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="0a84" class="kv kw iq nt b gy nx ny l nz oa"><a class="ae mk" href="https://rdrr.io/r/base/library.html" rel="noopener ugc nofollow" target="_blank">library</a>(<a class="ae mk" href="https://github.com/gbm-developers/gbm" rel="noopener ugc nofollow" target="_blank">gbm</a>)<br/><a class="ae mk" href="https://rdrr.io/r/base/library.html" rel="noopener ugc nofollow" target="_blank">library</a>(<a class="ae mk" href="https://modeloriented.github.io/DALEX" rel="noopener ugc nofollow" target="_blank">DALEX</a>)<br/><a class="ae mk" href="https://rdrr.io/r/base/library.html" rel="noopener ugc nofollow" target="_blank">library</a>(<a class="ae mk" href="https://modeloriented.github.io/fairmodels/index.html" rel="noopener ugc nofollow" target="_blank">fairmodels</a>)</span><span id="cf1a" class="kv kw iq nt b gy ob ny l nz oa">data("adult")<br/>adult$salary   &lt;- <a class="ae mk" href="https://rdrr.io/r/base/numeric.html" rel="noopener ugc nofollow" target="_blank">as.numeric</a>(adult$salary) -1<br/>protected      &lt;- adult$sex<br/>adult &lt;- adult[<a class="ae mk" href="https://rdrr.io/r/base/colnames.html" rel="noopener ugc nofollow" target="_blank">colnames</a>(adult) != "sex"] # sex not specified<br/><br/># making model<br/><a class="ae mk" href="https://rdrr.io/r/base/Random.html" rel="noopener ugc nofollow" target="_blank">set.seed</a>(1)<br/>gbm_model &lt;-<a class="ae mk" href="https://rdrr.io/pkg/gbm/man/gbm.html" rel="noopener ugc nofollow" target="_blank">gbm</a>(salary ~. , data = adult, distribution = "bernoulli")<br/><br/># making explainer<br/>gbm_explainer &lt;- <a class="ae mk" href="https://rdrr.io/pkg/DALEX/man/explain.html" rel="noopener ugc nofollow" target="_blank">explain</a>(gbm_model,<br/>                         data = adult[,-1],<br/>                         y = adult$salary,<br/>                         colorize = FALSE)</span></pre><h2 id="08e0" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">拒绝基于选项的分类(pivot) </strong> <a class="ae mk" href="https://ieeexplore.ieee.org/document/6413831" rel="noopener ugc nofollow" target="_blank"> (Kamiran 等人，2012) </a></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/2b75a7d08f915ef6a65d612f2278a793.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qACdv9kxl4GjqyECPvL-kQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)红色-特权，蓝色-无特权。如果该值接近(-theta + cutoff，theta + cutoff)和特殊情况，概率将位置(和值)更改到 od cutoff 的另一侧。</p></figure><p id="0937" class="pw-post-body-paragraph lr ls iq lt b lu my jr lw lx mz ju lz le nn mb mc li no me mf lm np mh mi mj ij bi translated">ROC pivot 基于基于拒绝选项的分类实施。如果一个观察值来自非特权组并且在截止值的左边，则算法切换标签。然后对特权群体执行相反的操作。但有一个假设，即观察值必须接近(就概率而言)临界值。因此，用户必须输入某个值<em class="nr">θ</em>，以便算法知道观察值必须多接近开关的截止值。但是有一个问题。如果只是改变了标签，DALEX 解释者将很难正确计算模型的性能。因此，在该算法的<strong class="lt ir"> fairmodels </strong>实现中，被转换(旋转)的是概率，而不是标签。它们只是移动到另一侧，但与截止点的距离相等。</p><h2 id="d33f" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">切断操作</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/c92b49911960f21f12a9853619027e40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VNLx0-CTGjevXX3hmnc5WQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">(图片由作者提供)plot(ceteris _ pari bus _ cut off(fo object，cumulated = TRUE))</p></figure><p id="f422" class="pw-post-body-paragraph lr ls iq lt b lu my jr lw lx mz ju lz le nn mb mc li no me mf lm np mh mi mj ij bi translated">截断操作对于最小化模型中的偏差可能是一个很好的主意。我们只需选择临界值将改变的指标和子组。该图显示了最小值在哪里，并且对于该截止值<em class="nr">来说，奇偶损失</em>将是最低的。如何为特定子群创建具有不同截止值的公平对象？这很容易！</p><pre class="kg kh ki kj gt ns nt nu nv aw nw bi"><span id="7c05" class="kv kw iq nt b gy nx ny l nz oa">fobject &lt;- <a class="ae mk" href="https://modeloriented.github.io/fairmodels/reference/fairness_check.html" rel="noopener ugc nofollow" target="_blank">fairness_check</a>(gbm_explainer,<br/>                          protected  = protected, <br/>                          privileged = "Male",<br/>                          label      = "gbm_cutoff",<br/>                          cutoff     = <a class="ae mk" href="https://rdrr.io/r/base/list.html" rel="noopener ugc nofollow" target="_blank">list</a>(Female = 0.35))</span></pre><p id="be03" class="pw-post-body-paragraph lr ls iq lt b lu my jr lw lx mz ju lz le nn mb mc li no me mf lm np mh mi mj ij bi translated">现在<em class="nr">公平对象(fo object)</em>是一个具有指定截止值的结构，它将影响公平度量和性能。</p><h1 id="ee1c" class="ml kw iq bd kx mm mn mo la mp mq mr ld jw ms jx lh jz mt ka ll kc mu kd lp mv bi translated">公平性和准确性之间的权衡</h1><p id="be6b" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">如果我们想减少偏见，我们必须意识到这一行动可能带来的弊端。假设<em class="nr">静态平价</em>对我们来说是最重要的指标。降低该指标的<em class="nr">奇偶损失</em>将(可能)导致<em class="nr">假阳性</em>的增加，这将导致准确性下降。在这个例子中<a class="ae mk" href="https://modeloriented.github.io/fairmodels/articles/Advanced_tutorial.html" rel="noopener ugc nofollow" target="_blank">(你可以在这里找到)</a>一个<em class="nr"> gbm </em>模型被训练，然后用不同的偏差缓解技术处理。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/1f57508d6b9aa2d631ae1298f2127f5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4JfjHipK2qlk-a1uHOfYAQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">作者图片</p></figure><p id="fc76" class="pw-post-body-paragraph lr ls iq lt b lu my jr lw lx mz ju lz le nn mb mc li no me mf lm np mh mi mj ij bi translated">我们越是试图减少偏差，我们得到的准确性就越低。这对于这个指标来说是很自然的事情，用户应该意识到这一点。</p><h1 id="f511" class="ml kw iq bd kx mm mn mo la mp mq mr ld jw ms jx lh jz mt ka ll kc mu kd lp mv bi translated">摘要</h1><p id="2c88" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">在<strong class="lt ir"> fairmodels </strong>中实现的去偏置方法当然值得一试。它们很灵活，大多数适合每种型号。最重要的是，它们很容易使用。</p><h1 id="2f62" class="ml kw iq bd kx mm mn mo la mp mq mr ld jw ms jx lh jz mt ka ll kc mu kd lp mv bi translated">接下来读什么？</h1><ul class=""><li id="ac1b" class="mw mx iq lt b lu lv lx ly le od li oe lm of mj nd ne nf ng bi translated"><a class="ae mk" href="https://medium.com/@ModelOriented/fairmodels-lets-fight-with-biased-machine-learning-models-part-1-6c2786e6c97c" rel="noopener">关于公平、问题和解决方案介绍的博客文章</a></li><li id="cd83" class="mw mx iq lt b lu nh lx ni le nj li nk lm nl mj nd ne nf ng bi translated"><a class="ae mk" rel="noopener" target="_blank" href="/fairmodels-lets-fight-with-biased-machine-learning-models-part-2-visualization-66558630a4d">关于公平可视化的博文</a></li></ul><h1 id="861b" class="ml kw iq bd kx mm mn mo la mp mq mr ld jw ms jx lh jz mt ka ll kc mu kd lp mv bi translated">了解更多信息</h1><ul class=""><li id="2e90" class="mw mx iq lt b lu lv lx ly le od li oe lm of mj nd ne nf ng bi translated">查看<a class="ae mk" href="https://modeloriented.github.io/fairmodels/" rel="noopener ugc nofollow" target="_blank">包的 GitHub 网站</a>了解更多详情</li><li id="84ea" class="mw mx iq lt b lu nh lx ni le nj li nk lm nl mj nd ne nf ng bi translated"><a class="ae mk" href="https://modeloriented.github.io/fairmodels/articles/Basic_tutorial.html" rel="noopener ugc nofollow" target="_blank">教程</a>关于<strong class="lt ir"> fairmodels </strong>套装的全部功能</li><li id="91bd" class="mw mx iq lt b lu nh lx ni le nj li nk lm nl mj nd ne nf ng bi translated"><a class="ae mk" href="https://modeloriented.github.io/fairmodels/articles/Advanced_tutorial.html" rel="noopener ugc nofollow" target="_blank">关于偏差缓解技术的教程</a></li></ul></div></div>    
</body>
</html>