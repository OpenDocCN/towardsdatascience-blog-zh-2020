# åœ¨æ•°æ®å—ä¸Šä½¿ç”¨ Neo4j å’Œ PySpark

> åŸæ–‡ï¼š<https://towardsdatascience.com/using-neo4j-with-pyspark-on-databricks-eb3d127f2245?source=collection_archive---------16----------------------->

## [ç†è§£å¤§æ•°æ®](https://towardsdatascience.com/tagged/making-sense-of-big-data)

## é‡Šæ”¾ Spark å’Œå›¾å½¢æ•°æ®åº“æºæ‰‹å·¥ä½œçš„å…¨éƒ¨æ½œåŠ›

![](img/61e9e7c0620da718b13c91fd48b8e7b4.png)

ç”± [Fernand De Canne](https://unsplash.com/@fernanddecanne) åœ¨ [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„çš„ç…§ç‰‡

éšç€æœ€è¿‘å‘å¸ƒçš„åˆ©ç”¨ Spark æ•°æ®æº API çš„ Apache Spark å®˜æ–¹ Neo4j è¿æ¥å™¨ï¼Œåœ¨ Apache Spark ç¯å¢ƒä¸­æŸ¥è¯¢ Neo4j æ•°æ®çš„æ–¹å¼å‘ç”Ÿäº†æ ¹æœ¬æ€§çš„å˜åŒ–ã€‚é™¤äº†è¿™ä¸€å˜åŒ–ï¼Œ[ä»¥å‰çš„ Neo4j Spark è¿æ¥å™¨è¢«æ ‡è®°ä¸ºä¸æ¨èä½¿ç”¨](https://neo4j.com/developer/apache-spark/)ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘æƒ³åˆ†äº«ä¸€ä¸ªæ›´æ–°çš„**ç«¯åˆ°ç«¯å·¥ä½œæµï¼Œè¯¥å·¥ä½œæµè®¾ç½® Neo4j å’Œ Spark** çš„å®Œå…¨äº’è¿é…å¯¹ï¼Œè¯¥é…å¯¹åˆ©ç”¨äº†æ–°è¿æ¥å™¨çš„åŠŸèƒ½ã€‚

åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†é¦–å…ˆä½¿ç”¨ Azure è™šæ‹Ÿæœºè®¾ç½®ä¸€ä¸ª Neo4j äº‘å®ä¾‹ã€‚ä¹‹åï¼Œæˆ‘ä»¬å°†è®¾ç½®ä¸€ä¸ªè¿è¡Œ Spark çš„ [Azure Databricks](https://azure.microsoft.com/en-us/services/databricks/) å®ä¾‹ï¼Œç„¶åä½¿ç”¨ Apache Spark çš„æ–° [Neo4j è¿æ¥å™¨](https://github.com/neo4j-contrib/neo4j-spark-connector)åœ¨ä¸¤ä¸ªèµ„æºä¹‹é—´å»ºç«‹è¿æ¥ã€‚å¦‚æœæ‚¨å·²ç»æœ‰äº†ä¸€ä¸ªè¿è¡Œè‰¯å¥½çš„ Neo4j æˆ– Databricks å®ä¾‹ï¼Œé‚£ä¹ˆæ‚¨å½“ç„¶å¯ä»¥è·³è¿‡ç›¸åº”çš„æ­¥éª¤ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„æ¯ä¸ªæ­¥éª¤é¡¶éƒ¨çš„å…¼å®¹æ€§ä¿¡æ¯ã€‚

# æ­¥éª¤ 1:è®¾ç½® Neo4j äº‘å®ä¾‹

é¦–å…ˆï¼Œç®€å•è¯´ä¸€ä¸‹å…¼å®¹æ€§:æˆ‘ä»¬å°†ä½¿ç”¨çš„è¿æ¥å™¨æ”¯æŒ Neo4j åŠæ›´é«˜ç‰ˆæœ¬ã€‚**ä¸æ”¯æŒ 3.5 ä¹‹å‰çš„ç‰ˆæœ¬**ã€‚ä½†æ˜¯ï¼Œå®ƒæ”¯æŒ Neo4j ä¼ä¸šå’Œç¤¾åŒºä»¥åŠå•å®ä¾‹è™šæ‹Ÿæœºã€å› æœé›†ç¾¤å’Œ Neo4j Auraã€‚æœ¬æ–‡å°†å…³æ³¨å•å®ä¾‹è™šæ‹Ÿæœºçš„å·¥ä½œæµã€‚

ä½œä¸ºæˆ‘ä»¬çš„ Neo4j å®ä¾‹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ­£å¼çš„ Neo4j ä¼ä¸šè™šæ‹Ÿæœºæ˜ åƒã€‚æœ€æ–°ç‰ˆæœ¬åœ¨ Azure marketplace ä¸­è¢«åˆ—ä¸º *Neo4j Enterprise VM ç‰ˆæœ¬ 4.1* ã€‚å¦‚æœä½ æ²¡æœ‰ä¼ä¸šè®¸å¯è¯ï¼Œæœ‰ Websoft9 æä¾›çš„ç¤¾åŒºç‰ˆæœ¬çš„å›¾ç‰‡ä»¥åŠ Bitnami æä¾›çš„å®¹å™¨å›¾ç‰‡:

![](img/2770a533de540e392266e6fe9d8b4b31.png)

Azure marketplace ä¸Š N **eo4j** çš„æœç´¢ç»“æœ(ä½œè€…æˆªå›¾)

è™šæ‹Ÿæœºéƒ¨ç½²åï¼Œå¯¼èˆªåˆ°å®ƒçš„ Networking é€‰é¡¹å¡ï¼Œç¡®ä¿å®ƒçš„ç«¯å£è®¾ç½®æ˜¯æ­£ç¡®çš„:ä¸ºäº†ä» Spark æŸ¥è¯¢å®ƒï¼Œä¸€ä¸ª [*èºæ “*ç«¯å£](https://en.wikipedia.org/wiki/Bolt_(network_protocol))å¿…é¡»å…è®¸å…¥ç«™æµé‡ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™æ˜¯ç«¯å£ 7687ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Neo4j Web æ¥å£æ¥å¡«å……æ•°æ®åº“ï¼Œä¸ºæ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¼€æ”¾çš„ *HTTP* æˆ– *HTTPS* ç«¯å£ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬æ˜ å°„åˆ°ç«¯å£å· 7474 å’Œ 7473ã€‚å¦‚æœç¼ºå°‘è¿™äº›ç«¯å£è§„åˆ™ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œç‚¹å‡»*æ·»åŠ å…¥ç«™ç«¯å£è§„åˆ™*æŒ‰é’®æ·»åŠ å®ƒä»¬ã€‚

![](img/7e569c69ea293af895c70e9139872070.png)

Neo4j å®ä¾‹çš„å…¥ç«™ç«¯å£è®¾ç½®(ä½œè€…æˆªå›¾)

## ç”¨æ•°æ®å¡«å…… Neo4j å®ä¾‹

éªŒè¯ç«¯å£è®¾ç½®åï¼Œä»å…¶æ¦‚è¿°é€‰é¡¹å¡ä¸­è·å–è™šæ‹Ÿæœºçš„å…¬å…± IPï¼Œå¹¶é€šè¿‡å¯¼èˆªåˆ° *http://YOURã€‚VM.IP.ADDRESS:7474* ã€‚å¯¹äºæ–°å¯åŠ¨çš„è™šæ‹Ÿæœºï¼ŒNeo4j å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ‰èƒ½å¯åŠ¨å¹¶æ¥å—å…¥ç«™è¿æ¥ã€‚å¦‚æœæ‚¨ä½¿ç”¨ VPN æˆ–ä»£ç†ï¼Œè¯·ç¡®ä¿å¯¹å®ƒä»¬è¿›è¡Œäº†ç›¸åº”çš„é…ç½®ï¼Œå¦åˆ™æ‚¨å¯èƒ½ä¼šæ”¶åˆ°â€œ*æ­¤ç«™ç‚¹æ— æ³•è®¿é—®*â€é”™è¯¯ã€‚

å¦‚æœæ‰€æœ‰è®¾ç½®éƒ½æ­£ç¡®ï¼Œå°†å¼¹å‡º Neo4j æµè§ˆå™¨ Web UI:

![](img/64175049b517f79d111d4941705c0652.png)

Neo4j Web UI(æµè§ˆå™¨)(ä½œè€…æˆªå›¾)

ç³»ç»Ÿå°†æç¤ºæ‚¨è¾“å…¥ç™»å½•å‡­æ®ã€‚è¾“å…¥ç™»å½•æ•°æ®åº“çš„é»˜è®¤ç”¨æˆ·åå’Œå¯†ç :

*   ç”¨æˆ·å: *neo4j*
*   å¯†ç : *neo4j*

ç¬¬ä¸€æ¬¡è®¿é—®æ—¶ï¼Œå‡ºäºå®‰å…¨åŸå› ï¼Œæ‚¨å¿…é¡»ç«‹å³æ›´æ”¹é»˜è®¤å¯†ç ã€‚é€‰æ‹©ä¸€ä¸ªå¯é çš„å¯†ç å¹¶ç™»å½•åï¼Œå°±å¯ä»¥å¡«å……æ•°æ®åº“äº†ã€‚åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Cypher æŸ¥è¯¢è¯­è¨€é€šè¿‡åœ¨å‘½ä»¤è¡Œä¸­é”®å…¥ä»¥ä¸‹å†…å®¹æ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„è™šæ‹Ÿæ•°æ®é›†:

```
UNWIND range(1,100) as id
CREATE (p:Person {id:id}) WITH collect(p) as people
UNWIND people as p1
UNWIND range(1,10) as friend
WITH p1, people[(p1.id + friend) % size(people)] as p2
CREATE (p1)-[:KNOWS {years: abs(p2.id - p2.id)}]->(p2)
```

å› æ­¤ï¼Œå°†åˆ›å»ºä¸€ä¸ªç±»ä¼¼äºä¸‹é¢çš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­æ¯ä¸ª *Person* èŠ‚ç‚¹éƒ½ç”¨ä¸€ä¸ª ID æ ‡è®°ï¼Œæ¯ä¸ª *KNOWS* å…³ç³»éƒ½æœ‰ä¸€ä¸ªé™„åŠ çš„(ä»»æ„çš„)å±æ€§ *years* ï¼Œå®ƒæè¿°äº†åŒæ–¹è®¤è¯†å¤šä¹…äº†:

![](img/a2a7d85a19ebab9cdf9419ce5d98533a.png)

ç»“æœæ•°æ®ç»“æ„ï¼Œé™äº 5 ä¸ªèŠ‚ç‚¹(ä½œè€…æˆªå›¾)

å°±æ˜¯è¿™æ ·ï¼æˆ‘ä»¬çš„ Neo4j å›¾å½¢æ•°æ®åº“å·²ç»å¯åŠ¨å¹¶è¿è¡Œï¼Œè¿«ä¸åŠå¾…åœ°æƒ³ä» Spark ä¸­æŸ¥è¯¢ã€‚æˆ‘ä»¬ç°åœ¨å°†ç»§ç»­è®¾ç½®ä¸€ä¸ªåˆé€‚çš„ Spark ç¯å¢ƒã€‚

# *æ­¥éª¤ 2:* é…ç½®ç«èŠ±ç¯å¢ƒ

å†æ¬¡ï¼Œå…³äºå…¼å®¹æ€§çš„é‡è¦è¯´æ˜:åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œ [**Neo4j ä¸æ”¯æŒ Spark 3.0**](https://neo4j.com/developer/spark/overview/) çš„è¿æ¥å™¨ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸é€€å›åˆ° Spark 2.4 ç¯å¢ƒï¼Œä»¥ä¾¿ä¸ Neo4j é€šä¿¡ã€‚

å¯¹äºæˆ‘ä»¬çš„è®¾ç½®ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Azure Databricks å®ä¾‹ã€‚åœ¨ Azure marketplace ä¸Šæœç´¢*æ•°æ®å—*å¹¶åˆ›å»ºä¸€ä¸ªæ–°èµ„æºã€‚é™¤äº†é€šå¸¸çš„è®¾ç½®(èµ„æºç»„ã€åç§°ã€ä½ç½®å’Œå®šä»·å±‚)ï¼Œä¸éœ€è¦ä»»ä½•ç‰¹æ®Šçš„é…ç½®è®¾ç½®ã€‚

éƒ¨ç½²å®Œæˆåï¼Œé€šè¿‡å¯¼èˆªåˆ° Azure èµ„æºçš„æ¦‚è¿°é€‰é¡¹å¡å¹¶å•å‡»*å¯åŠ¨å·¥ä½œåŒº*æŒ‰é’®ï¼Œæ‰“å¼€ Databricks å·¥ä½œåŒºã€‚

![](img/27cfbddf905768dfb7fd3128d5fc7c6f.png)

(ä½œè€…æˆªå›¾)

é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªé›†ç¾¤ã€‚å¯¼èˆªåˆ°é›†ç¾¤é€‰é¡¹å¡å¹¶å•å‡»*åˆ›å»ºé›†ç¾¤*æŒ‰é’®ä»¥æ˜¾ç¤ºé›†ç¾¤é…ç½®å·¥å…·:

![](img/4b150b272e6ff1d7bb48b5ed5266267e.png)

Databricks é›†ç¾¤åˆ›å»ºå±å¹•(ä½œè€…æˆªå›¾)

é€‰æ‹©é›†ç¾¤åç§°å’Œå¯ç”¨æ€§æ¨¡å¼ï¼Œå¹¶æ ¹æ®æ‚¨çš„å–œå¥½é…ç½®å·¥ä½œèŠ‚ç‚¹çš„å¤§å°å’Œæ•°é‡ã€‚ç°åœ¨ï¼Œè¯·è®°ä½ï¼Œæˆ‘ä»¬è¢«è¿«ä½¿ç”¨ Spark 2 è®¾ç½®â€”â€”å¹¸è¿çš„æ˜¯ï¼ŒDatabricks ä»ç„¶æä¾›å„ç§ Spark 2.4.5 å‘è¡Œç‰ˆã€‚ç¡®ä¿åœ¨ *Databricks è¿è¡Œæ—¶ç‰ˆæœ¬*å­—æ®µä¸­é€‰æ‹©å…¶ä¸­ä¹‹ä¸€ï¼Œä¾‹å¦‚**è¿è¡Œæ—¶ç‰ˆæœ¬ 6.6** è¿è¡Œ **Spark 2.4.5** å’Œ **Scala 2.11** ã€‚

å¯åŠ¨æ‚¨çš„é›†ç¾¤ï¼Œä¸€åˆ‡å°±ç»ªï¼

# *æ­¥éª¤ 3:* åœ¨ Neo4j å’Œ Spark ä¹‹é—´å»ºç«‹è¿æ¥

æ—¢ç„¶æˆ‘ä»¬ç°åœ¨å·²ç»å¯åŠ¨å¹¶è¿è¡Œäº† Neo4j å’Œ Databricksï¼Œé‚£ä¹ˆæ˜¯æ—¶å€™å…³æ³¨å®ƒä»¬ä¹‹é—´çš„è”ç³»äº†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å°† Apache Spark çš„ Neo4j è¿æ¥å™¨æ·»åŠ åˆ°æˆ‘ä»¬çš„ Databricks é›†ç¾¤ä¸­ã€‚

åœ¨æ•°æ®å—ä¸­ï¼Œå¯¼èˆªåˆ°é›†ç¾¤é€‰é¡¹å¡ã€‚é€‰æ‹©å…ˆå‰åˆ›å»ºçš„é›†ç¾¤å¹¶è®¿é—®å…¶åº“é€‰é¡¹:

![](img/3fb558e36cd292f3dec7a79cce74bcf7.png)

Databricks é›†ç¾¤è§†å›¾(ä½œè€…æˆªå›¾)

ç°åœ¨ï¼Œé€šè¿‡ç‚¹å‡»*å®‰è£…æ–°çš„*æŒ‰é’®ï¼Œé€‰æ‹© Maven å¹¶ç‚¹å‡»*æœç´¢åŒ…*ï¼Œä¸º Apache Spark æ·»åŠ  Neo4j è¿æ¥å™¨ã€‚é”®å…¥â€œneo4jâ€æŸ¥çœ‹æ‰€æœ‰å¯ç”¨é€‰é¡¹ã€‚åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œæœç´¢ä¸­å‡ºç°äº†ä¸‰ä¸ªåŒ…:

![](img/b8dcf449f63ac2b92390f1b1e7fb39da.png)

(ä½œè€…æˆªå›¾)

*   **neo4j-spark-connector** :è¿™æ˜¯[å¼ƒç”¨çš„è¿æ¥å™¨ç‰ˆæœ¬(2.4)](https://neo4j.com/developer/apache-spark/) ã€‚å®ƒä¸å†å—åˆ°å¼€å‘è€…çš„ç§¯ææ”¯æŒã€‚
*   **neo4j-connector-Apache-spark _ 2.11**:è¿™æ˜¯å½“å‰çš„è¿æ¥å™¨ç‰ˆæœ¬(4.0)ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å°†è¦ä½¿ç”¨çš„ã€‚
*   neo4j-connector-Apache-spark _ 2.12:è¿™ä¹Ÿæ˜¯å½“å‰çš„è¿æ¥å™¨ç‰ˆæœ¬ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯å®ƒæ˜¯ä¸º Scala ç‰ˆæœ¬ 2.12 ç¼–å†™çš„ã€‚å› ä¸ºæˆ‘ä»¬çš„ Databricks ç¯å¢ƒè¿è¡Œ Scala 2.11ï¼Œæ‰€ä»¥è¿™ä¸ªä¸é€‚åˆæˆ‘ä»¬çš„ç›®çš„ã€‚

æ ¹æ®å¼€å‘äººå‘˜çš„è¯´æ³•ï¼Œç”±äº API çš„ä¸åŒï¼Œå°†ä¸¤ä¸ªè¿æ¥å™¨åˆ†å¼€æ˜¯å¿…è¦çš„:

> ç”±äº API çš„å·®å¼‚ï¼Œä¸åŒçš„ scala ç‰ˆæœ¬éœ€è¦ä¸åŒçš„ JAR æ–‡ä»¶ã€‚ç¡®ä¿æ‚¨æœ‰é€‚åˆæ‚¨çš„ç¯å¢ƒçš„ JAR æ–‡ä»¶ã€‚

## é˜…è¯» Neo4j

è¿æ¥å™¨å®‰è£…å®Œæˆåï¼Œåœ¨å·¥ä½œåŒºé€‰é¡¹å¡ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ Jupyter ç¬”è®°æœ¬(å³å‡»â†’ *æ–°å»º*)ã€‚åœ¨æ’å…¥ Neo4j è™šæ‹Ÿæœºçš„ *IPã€ç”¨æˆ·å*å’Œ*å¯†ç *åï¼Œé€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤å°è¯•è¯»å– Neo4j æ•°æ®åº“çš„èŠ‚ç‚¹æ•°æ®:

```
df = spark.read.format("org.neo4j.spark.DataSource")\
 .option("url", "bolt://***XXX.XXX.XXX.XXX***:7687")\
 .option("authentication.type", "basic")\
 .option("authentication.basic.username", "***neo4j"***)\
 .option("authentication.basic.password", "***password"***)\
 .option("labels", "Person")\
 .load()
display(df)
```

å¦‚æœæ‚¨æ”¶åˆ°*æ— æ³•è¿æ¥*é”™è¯¯ï¼Œè¯·ç¡®ä¿æ‚¨çš„ Neo4j è™šæ‹Ÿæœºä»åœ¨è¿è¡Œï¼Œå¹¶ä¸”å…¶ Bolt ç«¯å£æ¥å—å…¥ç«™æµé‡ã€‚å¦‚æœæŸ¥è¯¢è¿”å›

```
java.lang.NoSuchMethodError: scala.Product.$init$(Lscala/Product;)V
```

æ‚¨å¾ˆå¯èƒ½ä¸ºé”™è¯¯çš„ Scala ç‰ˆæœ¬å®‰è£…äº†è¿æ¥å™¨â€”â€”ç¡®ä¿æ‚¨é€‰æ‹©çš„æ˜¯ Scala 2.11 ç‰ˆæœ¬(è§ä¸Šæ–‡)ã€‚

å¦‚æœä¸€åˆ‡éƒ½è§£å†³äº†ï¼ŒæŸ¥è¯¢å°†è¿”å›å¦‚ä¸‹æ‰€ç¤ºçš„æ•°æ®å¸§:

![](img/cb062d8be39a806c630c2e34bd8fdb96.png)

æ¼”ç¤ºæŸ¥è¯¢ä»¥æ•°æ®å¸§æ ¼å¼è¿”å›çš„ç»“æœ(ä½œè€…æˆªå›¾)

ä½œä¸º Python çš„æ›¿ä»£ï¼Œæ‚¨ä¹Ÿå¯ä»¥é€šè¿‡åœ¨ç¬”è®°æœ¬å•å…ƒæ ¼é¡¶éƒ¨æ·»åŠ  *%scala* [é­”æ³•å‘½ä»¤](https://docs.databricks.com/notebooks/notebooks-use.html#mix-languages)æ¥ä½¿ç”¨ Scala è¿›è¡ŒæŸ¥è¯¢:

```
%scalaimport org.apache.spark.sql.{SaveMode, SparkSession}val spark = SparkSession.builder().getOrCreate()val df = spark.read.format("org.neo4j.spark.DataSource")
 .option("url", "bolt://***XXX.XXX.XXX.XXX***:7687")
 .option("authentication.type", "basic")
 .option("authentication.basic.username", "***neo4j"***)
 .option("authentication.basic.password", "***password"***)
 .option("labels", "Person")
 .load()display(df)
```

## å†™å…¥ Neo4j

å†™å…¥å›¾å½¢æ•°æ®åº“çš„å·¥ä½œæ–¹å¼ç±»ä¼¼ã€‚åœ¨ä¸‹é¢çš„æŸ¥è¯¢ä¸­ï¼Œæˆ‘ä»¬å°†æ›´æ–°åŸå§‹æ•°æ®ï¼Œä»¥åŒ…æ‹¬å‰ä¸¤ä¸ªèŠ‚ç‚¹çš„åç§°:

```
df = spark.createDataFrame(
 [(1, "John"),(2, "Thomas")],
 ["id", "name"]
)df.write.format("org.neo4j.spark.DataSource")\
 .option("urlâ€, "bolt://***XXX.XXX.XXX.XXX***:7687")\
 .option("authentication.type", "basic")\
 .option("authentication.basic.username", "***neo4j***")\
 .option("authentication.basic.password", "***password***")\
 .option("labels", ":Person")\
 .option("node.keys", "id")\
 .mode("Overwrite")\
 .save()
```

è¯·æ³¨æ„ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†*â€œOverwriteâ€*æ¨¡å¼ï¼Œå¹¶å°† *node.keys* é€‰é¡¹è®¾ç½®ä¸º DataFrame çš„ *id* åˆ—ï¼Œä»¥ä¾¿å°†æ–°å€¼é™„åŠ åˆ°ç°æœ‰èŠ‚ç‚¹ã€‚äº‹å®ä¸Šï¼Œå†æ¬¡è¿è¡Œ read æŸ¥è¯¢å°†è¿”å›æˆ‘ä»¬ä¹‹å‰çš„ç»“æœï¼Œè¯¥ç»“æœç”¨å‰ä¸¤ä¸ªèŠ‚ç‚¹çš„ name å±æ€§è¿›è¡Œäº†æ›´æ–°:

![](img/a6a917b995653cea4813e0868332157d.png)

å†™å…¥æ•°æ®åº“åè¯»å–æŸ¥è¯¢çš„ç»“æœ(ä½œè€…æˆªå›¾)

å°±æ˜¯è¿™æ ·ï¼ğŸ‰æ‚¨å·²ç»æˆåŠŸåœ°å»ºç«‹äº†ä¸€å¯¹å®Œå…¨åŸºäºäº‘çš„äº’è” Apache Spark å’Œ Neo4jï¼Œä½¿æ‚¨èƒ½å¤Ÿå……åˆ†åˆ©ç”¨â€œä¼ ç»Ÿâ€å¤§æ•°æ®å’Œå›¾å½¢æ•°æ®åº“çš„æ½œåŠ›ã€‚

è¦è·å¾—æ›´å¤šçš„æŸ¥è¯¢ç¤ºä¾‹å’Œè¯­æ³•æ¦‚è¿°ï¼Œè¯·æ·±å…¥é˜…è¯»å®˜æ–¹çš„ [Neo4j è¿æ¥å™¨ for Apache Spark æ–‡æ¡£](https://neo4j.com/developer/spark/overview/)æˆ–æŸ¥çœ‹å¿«é€ŸæŒ‡å—[é˜…è¯»](https://neo4j.com/developer/spark/reading/)å’Œ[ç¼–å†™æ¥è‡ª/åˆ° Neo4j çš„](https://neo4j.com/developer/spark/writing/)ã€‚å…¶ä»–ç¤ºä¾‹å¯ä»¥åœ¨ [Zeppelin ç¬”è®°æœ¬ç¤ºä¾‹åº“](https://github.com/utnaf/neo4j-connector-apache-spark-notebooks)ä¸­æ‰¾åˆ°ã€‚è¿æ¥å™¨è¿˜æ”¯æŒ Cypher æŸ¥è¯¢ï¼Œå…è®¸æ‚¨é‡ç”¨ Neo4j æ¡Œé¢/ Web åº”ç”¨ç¨‹åºä¸­çš„ç°æœ‰æŸ¥è¯¢ã€‚å¯†ç æŸ¥è¯¢ç¤ºä¾‹å¯åœ¨[å®˜æ–¹å¯†ç é¡µé¢](https://neo4j.com/developer/cypher/)ä¸Šæ‰¾åˆ°ã€‚