<html>
<head>
<title>Patchwork — The Next Generation of ggplots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">拼凑——下一代 ggplots</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/patchwork-the-next-generation-of-ggplots-1fcad5d2ba8a?source=collection_archive---------60-----------------------#2020-07-21">https://towardsdatascience.com/patchwork-the-next-generation-of-ggplots-1fcad5d2ba8a?source=collection_archive---------60-----------------------#2020-07-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2fa1" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">进一步扩展 ggplot2 的多功能性..</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d19326101a53e596c993e148212a902a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sw8VKzcQNpPDHKFtVVhlxQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">尼古拉斯·彼尔托在<a class="ae ky" href="https://unsplash.com/s/photos/patchwork-fields?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="051d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于 R 中的数据可视化，<code class="fe lv lw lx ly b">ggplot2</code>已经成为生成出色的、高质量的发布图的首选包。它的分层方法使我们能够从简单的视觉基础开始，并在每一层中不断添加修饰。即使是默认设置的最基本的绘图，看起来和感觉都比 base R 图形好得多。因此，如果你计划或需要与内部利益相关者或外部客户分享你的分析成果，你的技能组合中必须有 ggplot。是的，有一个学习曲线(自尊技能没有！)但一旦掌握，<code class="fe lv lw lx ly b">ggplot2</code>提供了极好的定制可能性，并以引人注目的方式传达您的洞察力。</p><p id="ed46" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是这个帖子本身并不是关于 ggplot 的！相反，它是关于现在可用的令人敬畏的布局功能，超越了通过<code class="fe lv lw lx ly b">ggplot2</code>的<code class="fe lv lw lx ly b">facet_wrap()</code>和<code class="fe lv lw lx ly b">facet_grid()</code>方法可用的标准网格选项。</p><p id="a74c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当您想要将一组相关的图组合到一个图形中，但是发现一些图看起来比其他的更宽，并且打乱了行和列以及行/列宽度的网格约束时，灵活的布局选项特别有用并且非常缺少。或者更糟的是，到处都有一连串的传说。</p><p id="59a9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">输入<code class="fe lv lw lx ly b">patchwork</code>！</p><p id="1377" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe lv lw lx ly b">patchwork</code>建立在<code class="fe lv lw lx ly b">+</code>的基础上，现在不仅能让我们在<code class="fe lv lw lx ly b">ggplot2</code>的基础剧情中增加一层，还能让我们控制支线剧情的位置和大小。所有这些只需要 3 个“操作符”:<code class="fe lv lw lx ly b">+</code>、<code class="fe lv lw lx ly b">()</code>和<code class="fe lv lw lx ly b">/</code>。让我们来看看吧！</p><h2 id="65ab" class="lz ma it bd mb mc md dn me mf mg dp mh li mi mj mk lm ml mm mn lq mo mp mq mr bi translated">装置</h2><p id="7b4a" class="pw-post-body-paragraph kz la it lb b lc ms ju le lf mt jx lh li mu lk ll lm mv lo lp lq mw ls lt lu im bi translated">确保您已经安装了<code class="fe lv lw lx ly b">ggplot2</code>包。如果你以前没有用过<code class="fe lv lw lx ly b">ggplot</code>，请点击 Selva Prabhakaran 的阅读这篇综合教程<a class="ae ky" href="http://r-statistics.co/Complete-Ggplot2-Tutorial-Part1-With-R-Code.html" rel="noopener ugc nofollow" target="_blank">。</a></p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="c536" class="lz ma it ly b gy nb nc l nd ne">library(ggplot2)<br/>install.packages('patchwork') # first time installation<br/>library('patchwork') # load the library in to your R environment</span></pre><p id="94fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用来自<code class="fe lv lw lx ly b">ggplot2</code>的德克萨斯房屋<code class="fe lv lw lx ly b">txhousing</code>数据集来演示<code class="fe lv lw lx ly b">patchwork</code>的能力。让我们快速检查数据集的维度和前几行。</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="8a00" class="lz ma it ly b gy nb nc l nd ne">data = ggplot2::txhousing<br/>dim(data)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/14b02cf7d93f41afa19684ee1ae8fa08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e-U10EZyZDjJjkth3AP8Ew.png"/></div></div></figure><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="16f0" class="lz ma it ly b gy nb nc l nd ne">head(data)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/75277863f840afbcc6414acdf5a1ec28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UNSiluSkdo_Ixatjle_pow.png"/></div></div></figure><p id="a253" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">它有 9 列和 8602 个观察值，包含美国德克萨斯州 2000-2015 年各月的城市房屋销售和库存数据信息。您可以在 R 控制台上使用<code class="fe lv lw lx ly b">help(txhousing)</code>命令来检查列的详细描述。为了演示的目的，让我们只考虑达拉斯市的数据。</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="8100" class="lz ma it ly b gy nb nc l nd ne">dallas = data[data$city == "Dallas",] # take a subset of data only for Dallas</span></pre><p id="ccdb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在将创建一些将在<code class="fe lv lw lx ly b">patchwork</code>使用的 gg 图</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="2937" class="lz ma it ly b gy nb nc l nd ne">avg.monthly.sales = dallas %&gt;% group_by(year) %&gt;% summarise(mean = mean(sales))</span><span id="9546" class="lz ma it ly b gy nh nc l nd ne">mytheme = theme(panel.background = element_rect(fill = "powderblue")) # set a ggplot theme for repeated use later</span><span id="12f0" class="lz ma it ly b gy nh nc l nd ne">p1 = ggplot(avg.monthly.sales, aes(year,mean)) +<br/>  geom_col(fill = "gold", color = "navyblue") + <br/>  ylab("Mean Monthly Sales (Nos)") +<br/>  mytheme + labs(title = "Dallas - 2000 to 2015")</span><span id="4593" class="lz ma it ly b gy nh nc l nd ne">p1</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/bd3859a5b3240206435e0a905980ebca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*C3NpcKG83DsFLJdrnXcDDQ.jpeg"/></div></div></figure><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="6f50" class="lz ma it ly b gy nb nc l nd ne">avg.monthly.vol = dallas %&gt;% group_by(year) %&gt;% summarise(mean = mean(volume))</span><span id="81f8" class="lz ma it ly b gy nh nc l nd ne">p2 = ggplot(avg.monthly.vol, aes(year,mean)) +<br/>  geom_col(fill = "gold", color = "navyblue") + <br/>  ylab("Mean Monthly volumes in USD") +<br/>  mytheme + labs(title = "Dallas - 2000 to 2015")</span><span id="357a" class="lz ma it ly b gy nh nc l nd ne">p2</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/529176124ad194ce013ab3c24f6f7303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*EqJQlq1Izhw9e6TgQdDnzQ.jpeg"/></div></div></figure><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="04aa" class="lz ma it ly b gy nb nc l nd ne">dal_2014 = dallas %&gt;% filter(year ==2014)</span><span id="a526" class="lz ma it ly b gy nh nc l nd ne">p3 = ggplot(dal_2014, aes(month,listings)) +<br/>  geom_line(color = "navyblue") + mytheme + <br/>  scale_x_continuous(breaks = c(seq(1,12,1))) +<br/>  labs(title = "Dallas 2014: Property Listing Count")</span><span id="10f4" class="lz ma it ly b gy nh nc l nd ne">p3</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/ae74189f3fb0e1fee6880436a0992961.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*7mtLOihy4QGJkjV1Ns8boQ.jpeg"/></div></div></figure><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="2808" class="lz ma it ly b gy nb nc l nd ne">avg.monthly.inventory = dallas %&gt;% group_by(year) %&gt;% summarise(mean = mean(inventory))</span><span id="6b24" class="lz ma it ly b gy nh nc l nd ne">p4 = ggplot(avg.monthly.inventory, aes(year,mean)) +<br/>  geom_col(fill = "gold", color = "navyblue") + <br/>  ylab("Mean Inventory (No of months)") +<br/>  mytheme + labs(title = "Dallas - 2000 to 2015")</span><span id="e596" class="lz ma it ly b gy nh nc l nd ne">p4</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/56022c8c9aa7e92c2984995901af2ebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*spRCyg_-s-VyWG_wEsBKoQ.jpeg"/></div></div></figure><p id="8f86" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，假设我们希望将两个或更多的图显示为一个图形。像<code class="fe lv lw lx ly b">gridExtra</code>这样的扩展可以胜任工作，但是选项仅限于正方形或矩形网格，每个单元格有一个子图。这里是<code class="fe lv lw lx ly b">patchwork</code>一击即中的地方，几乎不需要布局代码。看着！！</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="9c44" class="lz ma it ly b gy nb nc l nd ne">p1 + p2</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/29952b701fd1d9d6be59d003ade0b2a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JMFh5zfDHlJIGs5jEZdUbQ.jpeg"/></div></div></figure><p id="04ad" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就是这样！像加法一样简单..现在对于一些部门来说。</p><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="570f" class="lz ma it ly b gy nb nc l nd ne">(p1 + p2) /p3</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/db09486d70a13a2743ac54de6ca85ccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*8hA64en67dqPMSGCXh48EA.jpeg"/></div></figure><p id="5681" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">再多堆一些..！</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nl"><img src="../Images/0201470c6b6c5e1eb63c4ee382415a97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3_viFHs5NWPAeKXaaDk8dw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@amir_v_ali?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> amirali mirhashemian </a>在<a class="ae ky" href="https://unsplash.com/s/photos/stacked-burger?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><pre class="kj kk kl km gt mx ly my mz aw na bi"><span id="dde0" class="lz ma it ly b gy nb nc l nd ne">p1/(p3+p4)/p2</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/17966f5eb0dbef105cc57dcd5595015d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*2UyQ9bzlDCe3ml-4l9LHUw.jpeg"/></div></figure><p id="37b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">很棒吧？这个包还可以选择将所有相同的支线剧情合并成一个单独的图例和更多的特性。我将发布一篇单独的文章来讨论这个问题。</p><p id="1483" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">关于 R 中另一个方便的探索性数据分析(EDA)工具，点击<a class="ae ky" rel="noopener" target="_blank" href="/eda-in-r-with-smarteda-eae12f2c6094">这里</a>看我关于<code class="fe lv lw lx ly b">SmartEDA</code>的文章。</p><p id="51c5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读，并请留下您的意见和反馈。</p></div></div>    
</body>
</html>