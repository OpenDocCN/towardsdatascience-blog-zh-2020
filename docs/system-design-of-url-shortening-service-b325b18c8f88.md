# URL ç¼©çŸ­æœåŠ¡çš„ç³»ç»Ÿè®¾è®¡

> åŸæ–‡ï¼š<https://towardsdatascience.com/system-design-of-url-shortening-service-b325b18c8f88?source=collection_archive---------2----------------------->

## æä¾›ç¼©çŸ­ URL çš„ web æœåŠ¡çš„ç³»ç»Ÿè®¾è®¡åˆ†æ

![](img/03ae88be6c1cbad884aa83d5f39d8838.png)

ç…§ç‰‡ç”± [**é©¬åº“æ–¯Â·æ–¯çš®æ–¯å…‹**](https://www.pexels.com/@markusspiske?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels) å‘è‡ª [**ä½©å…‹æ–¯**](https://www.pexels.com/photo/working-pattern-internet-abstract-1089438/?utm_content=attributionCopyText&utm_medium=referral&utm_source=pexels)

ç³»ç»Ÿè®¾è®¡æ˜¯è½¯ä»¶å·¥ç¨‹ä¸­ ***æœ€é‡è¦ä¹Ÿæ˜¯æœ€ä»¤äººç•æƒ§çš„*** æ–¹é¢ã€‚è¿™ä¸ªè§‚ç‚¹æ¥è‡ªäºæˆ‘è‡ªå·±åœ¨ä¸€ä¸ªå»ºç­‘åŠ©ç†è¯¾ç¨‹ä¸­çš„å­¦ä¹ ç»å†ã€‚å½“æˆ‘å¼€å§‹æˆ‘çš„åŠ©ç†æ¶æ„è¯¾ç¨‹æ—¶ï¼Œæˆ‘å¾ˆéš¾ç†è§£è®¾è®¡ä¸€ä¸ªç³»ç»Ÿçš„æƒ³æ³•ã€‚

ä¸€ä¸ªä¸»è¦åŸå› æ˜¯è½¯ä»¶æ¶æ„ä¹¦ç±ä¸­ä½¿ç”¨çš„æœ¯è¯­ä¸€å¼€å§‹å¾ˆéš¾ç†è§£ï¼Œå¹¶ä¸”æ²¡æœ‰æ¸…æ™°çš„é€æ­¥æŒ‡å—ã€‚æ¯ä¸ªäººä¼¼ä¹éƒ½æœ‰ä¸åŒçš„æ–¹æ³•ã€‚

æ‰€ä»¥ï¼Œæˆ‘æ ¹æ®æˆ‘å­¦ä¹ å»ºç­‘è¯¾ç¨‹çš„ç»éªŒç€æ‰‹[è®¾è®¡ä¸€ä¸ªç³»ç»Ÿ](/system-design-101-b8f15162ef7c?source=friends_link&sk=be3d26de1f9d1671b4abe379aae814f8)ã€‚è¿™æ˜¯åˆå­¦è€…ç³»ç»Ÿè®¾è®¡ç³»åˆ—çš„ä¸€éƒ¨åˆ†(ä¸‹é¢ç»™å‡ºäº†é“¾æ¥)ã€‚å¯¹äºè¿™ä¸€ä¸ªï¼Œè®©æˆ‘ä»¬è®¾è®¡ URL ç¼©çŸ­æœåŠ¡ã€‚

åœ¨[ä¸­](https://medium.com/u/504c7870fdb6?source=post_page-----b325b18c8f88--------------------------------)ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç½‘å€ç›¸å½“å¤§ï¼Œå°¤å…¶æ˜¯å¥½å‹é“¾æ¥ï¼›å½“åˆ†äº«ä¸€ç¯‡æ–‡ç« æ—¶ï¼Œæˆ‘ä»¬å€¾å‘äºç¼©çŸ­ URLã€‚ä¸€äº›å·²çŸ¥çš„ URL ç¼©çŸ­æœåŠ¡æœ‰ TinyURLã€bit.lyã€goo.glã€rb.gy ç­‰ã€‚æˆ‘ä»¬å°†è®¾è®¡è¿™æ ·ä¸€ä¸ªç½‘å€ç¼©çŸ­æœåŠ¡ã€‚

## â˜…ç³»ç»Ÿçš„å®šä¹‰:

æˆ‘ä»¬éœ€è¦æ˜ç¡®ç³»ç»Ÿçš„ç›®æ ‡ã€‚*ç³»ç»Ÿè®¾è®¡æ˜¯ä¸€ä¸ªå¦‚æ­¤åºå¤§çš„è¯é¢˜ï¼›å¦‚æœæˆ‘ä»¬ä¸æŠŠå®ƒç¼©å°åˆ°ä¸€ä¸ªç‰¹å®šçš„ç›®çš„ï¼Œé‚£ä¹ˆè®¾è®¡ç³»ç»Ÿå°±ä¼šå˜å¾—å¤æ‚ï¼Œå°¤å…¶æ˜¯å¯¹äºæ–°æ‰‹æ¥è¯´ã€‚URL ç¼©çŸ­æœåŠ¡ä¸ºé•¿ URL æä¾›è¾ƒçŸ­çš„åˆ«åã€‚å½“ç”¨æˆ·ç‚¹å‡»ç¼©çŸ­çš„é“¾æ¥æ—¶ï¼Œä»–ä»¬å°†è¢«é‡å®šå‘åˆ°åŸæ¥çš„ç½‘å€ã€‚*

![](img/a3bd5144d3cfb97f3bb49d21c02a7799.png)

ä½œè€…å›¾ç‰‡

## â˜…ç³»ç»Ÿè¦æ±‚:

åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å†³å®šç³»ç»Ÿçš„åŠŸèƒ½ã€‚æˆ‘ä»¬éœ€è¦å…³æ³¨çš„éœ€æ±‚æ˜¯ä»€ä¹ˆï¼Ÿ**æˆ‘ä»¬å¯ä»¥å°†ç³»ç»Ÿéœ€æ±‚åˆ†ä¸ºä¸¤éƒ¨åˆ†:**

*   **åŠŸèƒ½éœ€æ±‚:**

ç”¨æˆ·ç»™å‡ºä¸€ä¸ª URL ä½œä¸ºè¾“å…¥ï¼›æˆ‘ä»¬çš„æœåŠ¡åº”è¯¥ä¸ºè¯¥ URL ç”Ÿæˆä¸€ä¸ªæ›´çŸ­ä¸”å”¯ä¸€çš„åˆ«åã€‚å½“ç”¨æˆ·ç‚¹å‡»è¾ƒçŸ­çš„é“¾æ¥æ—¶ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿåº”è¯¥å°†ä»–ä»¬é‡å®šå‘åˆ°åŸæ¥çš„é“¾æ¥ã€‚é“¾æ¥å¯èƒ½ä¼šåœ¨ä¸€æ®µæ—¶é—´åè¿‡æœŸã€‚ç”¨æˆ·å¯ä»¥æŒ‡å®šåˆ°æœŸæ—¶é—´ã€‚*æˆ‘ä»¬è¿™é‡Œä¸è€ƒè™‘ç”¨æˆ·è‡ªå®šä¹‰é“¾æ¥ã€‚*

è¿™æ˜¯ç³»ç»Ÿå¿…é¡»æä¾›çš„ä¸€ä¸ªéœ€æ±‚ã€‚è¿™æ˜¯ç³»ç»Ÿçš„ä¸»è¦ç›®æ ‡ã€‚

*   **éåŠŸèƒ½æ€§éœ€æ±‚:**

ç°åœ¨æ˜¯éœ€è¦åˆ†æçš„æ›´å…³é”®çš„éœ€æ±‚ã€‚å¦‚æœæˆ‘ä»¬ä¸æ»¡è¶³è¿™ä¸ªè¦æ±‚ï¼Œå®ƒå¯èƒ½å¯¹é¡¹ç›®çš„å•†ä¸šè®¡åˆ’æœ‰å®³ã€‚é‚£ä¹ˆï¼Œè®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸‹æˆ‘ä»¬çš„ nfr:

> ç³»ç»Ÿåº”è¯¥æ˜¯é«˜åº¦å¯ç”¨çš„ã€‚å¦‚æœæœåŠ¡å…³é—­ï¼Œæ‰€æœ‰ URL é‡å®šå‘éƒ½å°†å¤±è´¥ã€‚URL é‡å®šå‘åº”è¯¥å®æ—¶å‘ç”Ÿã€‚æ²¡æœ‰äººåº”è¯¥èƒ½å¤Ÿé¢„æµ‹ç¼©çŸ­çš„é“¾æ¥ã€‚

**æ€§èƒ½ã€å¯ä¿®æ”¹æ€§ã€å¯ç”¨æ€§ã€å¯ä¼¸ç¼©æ€§ã€å¯é æ€§ç­‰ã€‚æ˜¯ç³»ç»Ÿè®¾è®¡ä¸­ä¸€äº›é‡è¦çš„è´¨é‡è¦æ±‚ã€‚è¿™äº›â€˜èƒ½åŠ›â€™æ˜¯æˆ‘ä»¬åˆ†æä¸€ä¸ªç³»ç»Ÿå¹¶ç¡®å®šæˆ‘ä»¬çš„ç³»ç»Ÿè®¾è®¡æ˜¯å¦æ°å½“æ‰€éœ€è¦çš„ã€‚**

åœ¨è¿™ä¸ªç³»ç»Ÿä¸­ï¼Œå¯ç”¨æ€§æ˜¯ä¸»è¦çš„è´¨é‡å±æ€§ã€‚å®‰å…¨æ€§æ˜¯å¦ä¸€ä¸ªé‡è¦çš„å±æ€§ã€‚é€šå¸¸ï¼Œå¯ç”¨æ€§å’Œå¯ä¼¸ç¼©æ€§æ˜¯ç³»ç»Ÿè®¾è®¡çš„é‡è¦ç‰¹å¾ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ€§èƒ½æ˜¯é‡è¦çš„ï¼Œæ²¡æœ‰äººå¸Œæœ›æ„å»ºä¸€ä¸ªæ€§èƒ½æ›´å·®çš„ç³»ç»Ÿï¼Œå¯¹å—ï¼Ÿï¼

## â˜…ç³»ç»Ÿéœ€è¦å¤„ç†å¤šå°‘è¯·æ±‚ï¼Ÿ

è®©æˆ‘ä»¬å‡è®¾ï¼Œä¸€ä¸ªç”¨æˆ·å¯èƒ½è¯·æ±‚ä¸€ä¸ªæ–°çš„ URLï¼Œå¹¶ä½¿ç”¨å®ƒ 100 æ¬¡è¿›è¡Œé‡å®šå‘ã€‚å› æ­¤ï¼Œå†™å’Œè¯»çš„æ¯”ç‡åº”è¯¥æ˜¯ 1:100ã€‚æ‰€ä»¥ç³»ç»Ÿçš„è¯»å–é‡å¾ˆå¤§ã€‚

æˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡ä¸­å¤„ç†å¤šå°‘ URL è¯·æ±‚ï¼Ÿå‡è®¾æˆ‘ä»¬å¯èƒ½æ¯ç§’æ”¶åˆ° 200 ä¸ª URL è¯·æ±‚ã€‚æ‰€ä»¥ï¼Œä¸€ä¸ªæœˆçš„è®¡ç®—ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰ 30 å¤©* 24 å°æ—¶* 3600 ç§’*200 =~ 500 M çš„è¯·æ±‚ã€‚

å› æ­¤ï¼Œæ¯æœˆä¼šæœ‰è¿‘ 5 äº¿ä¸ªæ–°çš„ URL ç¼©çŸ­è¯·æ±‚ã€‚é‚£ä¹ˆï¼Œé‡å®šå‘è¯·æ±‚å°†æ˜¯ 500M * 100 = 50 äº¿ã€‚

è¦è®¡ç®—å¹´ä»½ï¼Œä½ å¿…é¡»å°†è¿™ä¸ªæ•°ä¹˜ä»¥ 12ã€‚

## â˜…æˆ‘ä»¬éœ€è¦å¤šå°‘å‚¨ç‰©ç©ºé—´ï¼Ÿ

è®©æˆ‘ä»¬å‡è®¾ï¼Œç³»ç»Ÿå°†æ‰€æœ‰çš„ URL ç¼©çŸ­è¯·æ±‚å’Œå®ƒä»¬çš„ç¼©çŸ­é“¾æ¥å­˜å‚¨äº† 5 å¹´ã€‚ç”±äºæˆ‘ä»¬é¢„è®¡æ¯ä¸ªæœˆä¼šæœ‰ 5 äº¿ä¸ªæ–°çš„ URLï¼Œæˆ‘ä»¬é¢„è®¡å­˜å‚¨çš„å¯¹è±¡æ€»æ•°å°†æ˜¯ 500 M * (5 * 12)ä¸ªæœˆ= 30 Bã€‚

ç°åœ¨è®©æˆ‘ä»¬å‡è®¾æ¯ä¸ªå­˜å‚¨çš„å¯¹è±¡å¤§çº¦æœ‰ 100 ä¸ªå­—èŠ‚ã€‚æˆ‘ä»¬å°†éœ€è¦ 300 äº¿* 100 å­—èŠ‚= 3 TB çš„æ€»å­˜å‚¨å®¹é‡ã€‚

å¦‚æœæˆ‘ä»¬æƒ³è¦ç¼“å­˜ä¸€äº›ç»å¸¸è¢«è®¿é—®çš„æµè¡Œ URLï¼Œå¦‚æœæˆ‘ä»¬éµå¾ª 80â€“20 è§„åˆ™ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä»ç¼“å­˜ä¸­ä¿ç•™ 20%çš„è¯·æ±‚ã€‚

å› ä¸ºæˆ‘ä»¬æ¯ç§’æœ‰ 20K ä¸ªè¯·æ±‚ï¼Œæˆ‘ä»¬å°†å¾—åˆ°

***20K * 60 ç§’* 60 åˆ†é’Ÿ* 24 å°æ—¶=æ¯å¤©~ 17 äº¿***

å¦‚æœæˆ‘ä»¬è®¡åˆ’ç¼“å­˜ 20%çš„è¯·æ±‚ï¼Œæˆ‘ä»¬å°†éœ€è¦

***0.2 * 17 äº¿* 100 å­—èŠ‚= 34GB å†…å­˜ã€‚***

## â˜…æ•°æ®æµ:

***å¯¹äºç³»ç»Ÿè®¾è®¡çš„æ–°æ‰‹ï¼Œè¯·è®°ä½ï¼Œâ€œå¦‚æœä½ å¯¹ç³»ç»Ÿè®¾è®¡ä»å“ªé‡Œå¼€å§‹æ„Ÿåˆ°å›°æƒ‘ï¼Œè¯·å°è¯•ä»æ•°æ®æµå¼€å§‹ã€‚â€***

ç°åœ¨ï¼ŒæœåŠ¡å™¨ç«¯ç»„ä»¶çš„ä¸»è¦ä»»åŠ¡ä¹‹ä¸€æ˜¯ä¸ºè¾“å…¥ URL ç”Ÿæˆå”¯ä¸€çš„é”®ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çš„è¾“å…¥æ•°æ®åªæ˜¯ä¸€ä¸ª URLã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒä»¬å­˜å‚¨ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è¾“å‡ºæ˜¯ URL çš„å¦ä¸€ä¸ªç¼©çŸ­ç‰ˆæœ¬ã€‚å¦‚æœæœ‰äººç‚¹å‡»è¿™ä¸ªç¼©çŸ­çš„ç½‘å€ï¼Œå®ƒä¼šé‡å®šå‘åˆ°åŸæ¥çš„ç½‘å€ã€‚ç°åœ¨ï¼Œæ¯ä¸ªè¾“å‡º URL éœ€è¦æ˜¯å”¯ä¸€çš„ã€‚

## â˜…ä¸ºç»™å®šçš„ URL ç”Ÿæˆä¸€ä¸ªç®€çŸ­çš„å”¯ä¸€é”®

*ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å–ä¸€ä¸ªéšæœºç¼©çŸ­çš„ç½‘å€â€œ*ã€rb.gy/ln9zebã€‘*â€ã€‚æœ€åå‡ ä¸ªå­—ç¬¦åº”è¯¥æ„æˆä¸€ä¸ªå”¯ä¸€çš„é”®ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬çš„è¾“å…¥æ˜¯ç”¨æˆ·ç»™çš„ä¸€ä¸ªé•¿ URLã€‚*

æˆ‘ä»¬éœ€è¦è®¡ç®—è¾“å…¥ URL çš„å”¯ä¸€æ•£åˆ—ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ base64 ç¼–ç ï¼Œ6 ä¸ªå­—ç¬¦é•¿çš„å¯†é’¥å°†ç»™æˆ‘ä»¬ 64 ä¸ª^(6)= ~ 687 äº¿ä¸ªå¯èƒ½çš„å­—ç¬¦ä¸²ï¼Œè¿™å¯¹äºæˆ‘ä»¬çš„ç³»ç»Ÿåº”è¯¥è¶³å¤Ÿäº†ã€‚

**é—®é¢˜:**å¦‚æœå¤šä¸ªç”¨æˆ·è¾“å…¥åŒä¸€ä¸ªç½‘å€ï¼Œç³»ç»Ÿåº”è¯¥ä¸ä¼šæä¾›ç›¸åŒçš„ç¼©çŸ­ç½‘å€ã€‚å¦‚æœä¸€äº›å­—ç¬¦ä¸²æ˜¯é‡å¤çš„ï¼Œç³»ç»Ÿä¼šæœ‰ä»€ä¹ˆè¡Œä¸ºï¼Ÿ

**è§£å†³æ–¹æ¡ˆ:**æˆ‘ä»¬å¯ä»¥å°†å¸¦æœ‰é€’å¢åºåˆ—å·çš„è¾“å…¥ URL é™„åŠ åˆ°æ¯ä¸ªè¯·æ±‚ URLã€‚å®ƒåº”è¯¥ä½¿ç½‘å€å”¯ä¸€ã€‚ä½†æ˜¯ï¼Œåºåˆ—å·çš„æº¢å‡ºå¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚å‡è®¾ user-id æ˜¯æƒŸä¸€çš„ï¼Œæˆ‘ä»¬å¯ä»¥å°† user-id é™„åŠ åˆ°è¾“å…¥ URLã€‚

## â˜…å”¯ä¸€å¯†é’¥ç”Ÿæˆ:

åœ¨ç³»ç»Ÿä¸­ï¼Œuser-id åº”è¯¥æ˜¯å”¯ä¸€çš„ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å”¯ä¸€çš„æ•£åˆ—ã€‚æˆ‘ä»¬å¯ä»¥æœ‰ä¸€ä¸ªç‹¬ç«‹çš„å”¯ä¸€å¯†é’¥ç”ŸæˆæœåŠ¡(UGS)ï¼Œå®ƒé¢„å…ˆç”Ÿæˆéšæœº id å¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚

![](img/4f492abd76bf44c790b35840758b9dd3.png)

å›¾:UGS å”¯ä¸€å¯†é’¥ç”ŸæˆæœåŠ¡(å›¾ç‰‡ç”±ä½œè€…æä¾›)

æ¯å½“æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–°çš„å¯†é’¥æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä»å·²ç»ç”Ÿæˆçš„ id ä¸­é€‰æ‹©ä¸€ä¸ªã€‚è¿™ç§æ–¹æ³•å¯ä»¥ä½¿äº‹æƒ…å˜å¾—æ›´å¿«ï¼Œå› ä¸ºå½“ä¸€ä¸ªæ–°çš„è¯·æ±‚åˆ°æ¥æ—¶ï¼Œæˆ‘ä»¬ä¸éœ€è¦åˆ›å»ºä¸€ä¸ª IDï¼Œç¡®ä¿å®ƒçš„å”¯ä¸€æ€§ï¼Œç­‰ç­‰ã€‚UGS å°†ç¡®ä¿æ‰€æœ‰çš„ id éƒ½æ˜¯å”¯ä¸€çš„ï¼Œå®ƒä»¬å¯ä»¥å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œè¿™æ ·å°±ä¸éœ€è¦æ¯æ¬¡éƒ½ç”Ÿæˆ idã€‚

å› ä¸ºæˆ‘ä»¬éœ€è¦ä¸€ä¸ªå­—èŠ‚æ¥å­˜å‚¨ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰è¿™äº›é”®å­˜å‚¨åœ¨:

6(å­—ç¬¦)* 68.7B(å”¯ä¸€é”®)~= 412 GBã€‚

## â˜…å¯ç”¨æ€§å’Œå¯é æ€§:

å¦‚æœæˆ‘ä»¬åªä¿ç•™ UGS çš„ä¸€ä»½æ‹·è´ï¼Œé‚£å°±æ˜¯å•ç‚¹æ•…éšœã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦åšä¸€ä¸ª UGS çš„å¤åˆ¶å“ã€‚å¦‚æœä¸»æœåŠ¡å™¨æ­»äº†ï¼Œå¤‡ç”¨æœåŠ¡å™¨å¯ä»¥å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ã€‚

**æ¯ä¸ª UGS æœåŠ¡å™¨éƒ½å¯ä»¥ç¼“å­˜ key-DB ä¸­çš„ä¸€äº›å¯†é’¥ã€‚å®ƒå¯ä»¥åŠ å¿«é€Ÿåº¦ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¿…é¡»å°å¿ƒï¼›å¦‚æœä¸€ä¸ªæœåŠ¡å™¨åœ¨ä½¿ç”¨å®Œæ‰€æœ‰å¯†é’¥ä¹‹å‰å°±æ­»æ‰äº†ï¼Œæˆ‘ä»¬å°±ä¼šä¸¢å¤±é‚£äº›å¯†é’¥ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾ï¼Œè¿™æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰å°†è¿‘ 68B ä¸ªå”¯ä¸€çš„å…­å­—æ¯é”®ã€‚**

ä¸ºäº†ç¡®ä¿å¯ç”¨æ€§ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿æ¶ˆé™¤ç³»ç»Ÿä¸­çš„å•ç‚¹æ•…éšœã€‚æ•°æ®å¤åˆ¶å°†æ¶ˆé™¤å•ç‚¹æ•…éšœå¹¶æä¾›å¤‡ä»½ã€‚æˆ‘ä»¬å¯ä»¥ä¿ç•™å¤šä¸ªå‰¯æœ¬ï¼Œä»¥ç¡®ä¿æ•°æ®åº“æœåŠ¡å™¨çš„å¯é æ€§ã€‚æ­¤å¤–ï¼Œä¸ºäº†å®ç°ä¸é—´æ–­æœåŠ¡ï¼Œå…¶ä»–æœåŠ¡å™¨ä¹Ÿéœ€è¦å‰¯æœ¬ã€‚

## â˜…æ•°æ®å­˜å‚¨:

åœ¨è¿™ä¸ªç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬éœ€è¦å­˜å‚¨æ•°åäº¿æ¡è®°å½•ã€‚æˆ‘ä»¬ä¿å­˜çš„æ¯ä¸ªå¯¹è±¡å¯èƒ½å°äº 1 KBã€‚ä¸€ä¸ª URL æ•°æ®ä¸å¦ä¸€ä¸ªä¸ç›¸å…³ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ NoSQL æ•°æ®åº“ï¼Œå¦‚ Cassandraã€DynamoDB ç­‰ã€‚NoSQL é€‰æ‹©å°†æ›´å®¹æ˜“æ‰©å±•ï¼Œè¿™æ˜¯æˆ‘ä»¬çš„è¦æ±‚ä¹‹ä¸€ã€‚

## â˜…å¯æ‰©å±•æ€§:

ä¸ºäº†æ”¯æŒæ•°åäº¿ä¸ª URLï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ•°æ®åº“è¿›è¡Œåˆ†åŒºï¼Œä»¥ä¾¿å°†æ•°æ®å­˜å‚¨åˆ°ä¸åŒçš„æ•°æ®åº“æœåŠ¡å™¨ä¸­ã€‚

I)æˆ‘ä»¬å¯ä»¥æ ¹æ®å“ˆå¸Œé”®çš„ç¬¬ä¸€ä¸ªå­—æ¯å¯¹æ•°æ®åº“è¿›è¡Œåˆ†åŒºã€‚æˆ‘ä»¬å¯ä»¥å°†ä»¥â€œAâ€å¼€å¤´çš„å¯†é’¥æ”¾åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå°†â€œBâ€æ”¾åœ¨å¦ä¸€å°æœåŠ¡å™¨ä¸Šã€‚è¿™è¢«ç§°ä¸º**åŸºäºèŒƒå›´çš„åˆ†åŒºã€‚**

è¿™ç§æ–¹æ³•çš„é—®é¢˜æ˜¯å®ƒä¼šå¯¼è‡´ä¸å¹³è¡¡çš„åˆ†åŒºã€‚ä¾‹å¦‚ï¼Œå¦ä¸€æ–¹é¢ï¼Œä»¥â€œzâ€å¼€å¤´çš„å•è¯å¾ˆå°‘ï¼›æˆ‘ä»¬å¯èƒ½æœ‰å¤ªå¤šä»¥å­—æ¯â€œeâ€å¼€å¤´çš„ URLã€‚

æˆ‘ä»¬å¯ä»¥å°†ä¸ç»å¸¸å‡ºç°çš„å­—æ¯ç»„åˆåˆ°ä¸€ä¸ªæ•°æ®åº“åˆ†åŒºä¸­ã€‚

ii)æˆ‘ä»¬è¿˜å¯ä»¥åŸºäºæˆ‘ä»¬å­˜å‚¨çš„å¯¹è±¡çš„æ•£åˆ—è¿›è¡Œåˆ†åŒºã€‚æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å…³é”®å­—çš„æ•£åˆ—æ¥ç¡®å®šå¯ä»¥å­˜å‚¨æ•°æ®å¯¹è±¡çš„åˆ†åŒºã€‚å“ˆå¸Œå‡½æ•°å°†ç”Ÿæˆä¸€ä¸ªæœåŠ¡å™¨å·ï¼Œæˆ‘ä»¬å°†å¯†é’¥å­˜å‚¨åœ¨è¯¥æœåŠ¡å™¨ä¸­ã€‚è¿™ä¸ªè¿‡ç¨‹å¯ä»¥ä½¿åˆ†å¸ƒæ›´åŠ éšæœºã€‚è¿™å°±æ˜¯**åŸºäºæ•£åˆ—çš„åˆ†åŒºã€‚**

å¦‚æœè¿™ç§æ–¹æ³•ä»ç„¶å¯¼è‡´åˆ†åŒºè¿‡è½½ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨[ä¸€è‡´æ•£åˆ—æ³•](https://en.wikipedia.org/wiki/Consistent_hashing)ã€‚

## â˜…ç¼“å­˜:

æˆ‘ä»¬å¯ä»¥ç¼“å­˜ç”¨æˆ·ç»å¸¸è®¿é—®çš„ URLã€‚åœ¨æŸ¥è¯¢æ•°æ®åº“ä¹‹å‰ï¼ŒUGS æœåŠ¡å™¨å¯ä»¥æ£€æŸ¥ç¼“å­˜æ˜¯å¦å…·æœ‰æ‰€éœ€çš„ URLã€‚é‚£ä¹ˆå®ƒä¸éœ€è¦å†æ¬¡è¿›è¡ŒæŸ¥è¯¢ã€‚

ç¼“å­˜æ»¡äº†ä¼šæ€ä¹ˆæ ·ï¼Ÿæˆ‘ä»¬å¯èƒ½ä¼šç”¨æ–°çš„æˆ–æµè¡Œçš„ URL æ›¿æ¢æ—§çš„æœªä½¿ç”¨çš„é“¾æ¥ã€‚æˆ‘ä»¬å¯ä»¥ä¸ºæˆ‘ä»¬çš„ç³»ç»Ÿé€‰æ‹©æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„(LRU)ç¼“å­˜å›æ”¶ç­–ç•¥ã€‚åœ¨æ­¤ç­–ç•¥ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ URLã€‚

## â˜…è´Ÿè½½å¹³è¡¡å™¨:

æˆ‘ä»¬å¯ä»¥åœ¨ç³»ç»Ÿçš„ä¸åŒä½ç½®æ·»åŠ ä¸€ä¸ªè´Ÿè½½å¹³è¡¡å±‚ï¼Œåœ¨ URL ç¼©çŸ­æœåŠ¡å™¨ã€æ•°æ®åº“å’Œç¼“å­˜æœåŠ¡å™¨ä¹‹å‰ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç®€å•çš„å¾ªç¯æ³•æ¥åˆ†é…è¯·æ±‚ã€‚åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼ŒLB åœ¨åç«¯æœåŠ¡å™¨ä¹‹é—´å¹³å‡åˆ†é…ä¼ å…¥çš„è¯·æ±‚ã€‚è¿™ç§ LB æ–¹æ³•å®ç°èµ·æ¥å¾ˆç®€å•ã€‚å¦‚æœä¸€ä¸ªæœåŠ¡å™¨æ­»äº†ï¼ŒLB å°†åœæ­¢å‘å®ƒå‘é€ä»»ä½•æµé‡ã€‚

é—®é¢˜:å¦‚æœä¸€ä¸ªæœåŠ¡å™¨è¿‡è½½ï¼ŒLB ä¸ä¼šåœæ­¢å‘è¿™ä¸ªæœåŠ¡å™¨å‘é€æ–°çš„è¯·æ±‚ã€‚æˆ‘ä»¬ä»¥åå¯èƒ½éœ€è¦ä¸€ä¸ªæ™ºèƒ½ LBã€‚

## â˜…ä¸€æ®µæ—¶é—´åé“¾æ¥è¿‡æœŸ:

å¦‚æœåˆ°äº† URL çš„åˆ°æœŸæ—¶é—´ï¼Œé“¾æ¥ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ

æˆ‘ä»¬å¯ä»¥åœ¨æ•°æ®å­˜å‚¨ä¸­æœç´¢å¹¶åˆ é™¤å®ƒä»¬ã€‚è¿™é‡Œçš„é—®é¢˜æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬é€‰æ‹©æœç´¢è¿‡æœŸçš„é“¾æ¥ï¼Œå°†å®ƒä»¬ä»æˆ‘ä»¬çš„æ•°æ®å­˜å‚¨ä¸­åˆ é™¤ï¼Œè¿™ä¼šç»™æˆ‘ä»¬çš„æ•°æ®åº“å¸¦æ¥å¾ˆå¤§çš„å‹åŠ›ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨å¦ä¸€ç§æ–¹æ³•ã€‚æˆ‘ä»¬å¯ä»¥å®šæœŸæ…¢æ…¢åˆ é™¤è¿‡æœŸçš„é“¾æ¥ã€‚å³ä½¿ä¸€äº›æ­»é“¾æ¥å­˜åœ¨çš„æ—¶é—´æ›´é•¿ï¼Œå®ƒä¹Ÿä¸åº”è¯¥è¿”å›ç»™ç”¨æˆ·ã€‚

å¦‚æœç”¨æˆ·è¯•å›¾è®¿é—®è¿‡æœŸçš„é“¾æ¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ é™¤è¯¥é“¾æ¥å¹¶å‘ç”¨æˆ·è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚å®šæœŸæ¸…ç†è¿‡ç¨‹å¯ä»¥è¿è¡Œï¼Œä»æˆ‘ä»¬çš„æ•°æ®åº“ä¸­åˆ é™¤è¿‡æœŸçš„é“¾æ¥ã€‚éšç€å­˜å‚¨è¶Šæ¥è¶Šä¾¿å®œï¼Œä¸€äº›é“¾æ¥å¯èƒ½ä¼šç•™åœ¨é‚£é‡Œï¼Œå³ä½¿æˆ‘ä»¬åœ¨æ¸…ç†æ—¶é”™è¿‡äº†ã€‚

ç§»é™¤é“¾æ¥åï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒæ”¾å›æ•°æ®åº“ä»¥ä¾›é‡ç”¨ã€‚

## â˜…å®‰å…¨æ€§:

æˆ‘ä»¬å¯ä»¥å°†æ¯ä¸ª URL çš„è®¿é—®ç±»å‹(å…¬å…±/ç§æœ‰)å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚å¦‚æœç”¨æˆ·è¯•å›¾è®¿é—®ä»–æ²¡æœ‰æƒé™çš„ URLï¼Œç³»ç»Ÿä¼šå‘å›ä¸€ä¸ªé”™è¯¯(HTTP 401)ã€‚

![](img/ead62f7ddd38f830fdb1d73ee679cefa.png)

å›¾:URL ç¼©çŸ­æœåŠ¡çš„æœ€ç»ˆè®¾è®¡(å›¾ç‰‡ç”±ä½œè€…æä¾›)

## ç»“è®º:

åœ¨è¿™ä¸ªç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰è€ƒè™‘ UI éƒ¨åˆ†ã€‚å› ä¸ºè¿™æ˜¯ä¸€ä¸ª web æœåŠ¡ï¼Œæ‰€ä»¥ä¹Ÿä¸è®¨è®ºå®¢æˆ·ç«¯éƒ¨åˆ†ã€‚å”¯ä¸€å¯†é’¥ç”Ÿæˆæ˜¯è¯¥ç³»ç»Ÿçš„é‡è¦éƒ¨åˆ†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªé¢å¤–çš„æœåŠ¡æ¥åˆ›å»ºå’Œå­˜å‚¨ URL çš„å”¯ä¸€é”®ã€‚ä¸ºäº†ç¡®ä¿æœåŠ¡çš„å¯ç”¨æ€§ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æœåŠ¡å™¨å¤åˆ¶ï¼Œè¿™æ ·ï¼Œå¦‚æœä¸€å°æœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œå…¶ä»–æœåŠ¡å™¨ä»ç„¶å¯ä»¥æä¾›æœåŠ¡ã€‚æ•°æ®åº“ä¹Ÿè¢«å¤åˆ¶ä»¥ç¡®ä¿æ•°æ®çš„å¯é æ€§ã€‚ç¼“å­˜æœåŠ¡å™¨ç”¨äºå­˜å‚¨ä¸€äº›æµè¡Œçš„æŸ¥è¯¢ï¼Œä»¥åŠ å¿«å»¶è¿Ÿã€‚å¹¶ä¸”æ·»åŠ äº†è´Ÿè½½å¹³è¡¡å™¨ï¼Œä»¥ä¾¿åœ¨åç«¯æœåŠ¡å™¨ä¹‹é—´å¹³å‡åˆ†é…ä¼ å…¥çš„è¯·æ±‚ã€‚

æ¥æº:é’»ç ”ç³»ç»Ÿè®¾è®¡é¢è¯•è¯¾ç¨‹ã€‚

*æ„Ÿè°¢æ‚¨é˜…è¯»æœ¬æ–‡ã€‚* ***è¿‡å¾—æ„‰å¿«ğŸ˜ƒ***

> æœ¬æ–‡æ˜¯é¢å‘åˆå­¦è€…çš„ç³»ç»Ÿè®¾è®¡ç³»åˆ—æ–‡ç« çš„ä¸€éƒ¨åˆ†ã€‚è¿™é‡Œæ˜¯[é“¾æ¥](https://medium.com/@ashchk/all-the-article-links-in-one-place-85c8526ead70?source=friends_link&sk=7e6ee3a65895cc893a32f97d5496bed4)ã€‚