<html>
<head>
<title>Building an easy GUI (graphical user interface) with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python构建简单的GUI(图形用户界面)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-an-easy-gui-graphical-user-interface-with-python-1c62ce6342e0?source=collection_archive---------11-----------------------#2020-05-02">https://towardsdatascience.com/building-an-easy-gui-graphical-user-interface-with-python-1c62ce6342e0?source=collection_archive---------11-----------------------#2020-05-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1e39" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有时我的代码需要从未见过命令行的人来使用。以下是如何让他们(和你)的生活更轻松的方法。</h2></div><p id="ba3b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你不是软件工程师，你可能会和不懂编程的人一起工作。然而，您的Python解决方案可以提高团队的效率，并将工作量减少10倍。但是如果你也需要教别人如何执行呢？对于许多人来说，使用终端或其他用户界面可能看起来过于陌生和复杂。</p><p id="e282" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本教程中，我将介绍为Python脚本创建GUI的过程。我们将使用Python包<a class="ae le" href="https://github.com/chriskiehl/Gooey" rel="noopener ugc nofollow" target="_blank"> Gooey </a>，这将使设计漂亮而简单的用户界面变得极其容易，对任何有电脑的人来说都很熟悉。您将需要:</p><ol class=""><li id="c141" class="lf lg it kk b kl km ko kp kr lh kv li kz lj ld lk ll lm ln bi translated">Python和IDLE</li><li id="f307" class="lf lg it kk b kl lo ko lp kr lq kv lr kz ls ld lk ll lm ln bi translated">设计技巧(开玩笑，<strong class="kk iu"> <em class="lt">这个包真的是那个神奇的</em> </strong>)</li></ol><p id="51d9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将运行一个例子，在这个例子中，我想打开一个GUI窗口，终端用户可以在这个窗口中搜索他所在地区的餐馆，并从程序中获得“推荐”。</p><p id="c6b1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一个简单的想法，但它很好地展示了Gooey可以做的很酷的事情。除此之外，我还发现Gooey对于上传文件、通过脚本运行文件以及自动将文件再次下载到你电脑中的指定文件夹非常有用。你可以通过添加</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="605d" class="md me it lz b gy mf mg l mh mi">widget="FileChooser"</span></pre><p id="18dc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">变成您论点之一！</p><p id="668c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是我的GUI最终的样子:</p><figure class="lu lv lw lx gt mk gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mj"><img src="../Images/e79ce75a90fc55674a507d0778024e55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K36c84g9Mt9c6XWzN5smJA.png"/></div></div></figure><h1 id="e556" class="mr me it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">安装</h1><p id="bfad" class="pw-post-body-paragraph ki kj it kk b kl ni ju kn ko nj jx kq kr nk kt ku kv nl kx ky kz nm lb lc ld im bi translated">Gooey不是为Jupyter设计的，所以我在这个项目中使用了IDLE。如果你安装了Python，你应该也已经有了IDLE。要安装Gooey，您应该在您的终端(OS)/命令提示符(Windows)中运行:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="84b0" class="md me it lz b gy mf mg l mh mi">pip install Gooey</span></pre><p id="da5e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据您的计算机上是否安装了更多的Python 2和3，您需要运行:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="89f5" class="md me it lz b gy mf mg l mh mi">pip3 install Gooey ## if you want to use python 3</span></pre><p id="5862" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还需要安装wxPython包，以便Gooey可以使用它来创建我们的接口。如果您想从头构建一个界面，学习更多关于wxPython的知识是一个好主意。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="a996" class="md me it lz b gy mf mg l mh mi">pip install wxPython==4.0.7 ## type pip3 instead to use python 3</span></pre><p id="402e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你以前没有用过IDLE，你也应该pip安装你将在你的脚本中使用的所有其他包(比如pandas，numpy，xlsxwriter等等)</p><h1 id="1dcf" class="mr me it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">结构</h1><p id="fb22" class="pw-post-body-paragraph ki kj it kk b kl ni ju kn ko nj jx kq kr nk kt ku kv nl kx ky kz nm lb lc ld im bi translated">GUI脚本看起来非常像普通的Python脚本，但是需要注意一些结构。我们将从进口开始:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="6a96" class="md me it lz b gy mf mg l mh mi">import pandas as pd<br/>from gooey import Gooey, GooeyParser<br/>import numpy as np<br/>from random import randint</span></pre><p id="aeb4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将通过定义几个参数来启动脚本:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="5efe" class="md me it lz b gy mf mg l mh mi"># the program name will show on your GUI window<br/># you can also set the sizing of the window (default_size)<br/># you can choose the color of your program using HEX codes <br/># (header_bg_color) and (body_bg_color)<br/># the (navigation) parameter refers to the design of the window</span><span id="72a2" class="md me it lz b gy nn mg l mh mi"><a class="ae le" href="http://twitter.com/Gooey" rel="noopener ugc nofollow" target="_blank">@Gooey</a>(program_name="robot restaurant recommendations",<br/>       default_size=(710, 700),<br/>       navigation='TABBED', <br/>       header_bg_color = '#FF0000',<br/>       body_bg_color = '#FFF900')</span></pre><p id="0c51" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的脚本将由函数构成，从定义窗口外观的函数开始，以及我们想从用户那里收集什么信息。</p><p id="3811" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的第一个函数将定义解析器并传递窗口参数。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="8a87" class="md me it lz b gy mf mg l mh mi">def parse_args():<br/>    parser = GooeyParser()</span></pre><p id="a933" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的第一个辩论组将是餐厅价格类别—“<em class="lt">我们今天感觉如何？</em>”，并给用户从$到$$$$的五个选项和一个将返回随机选择的“<em class="lt">让我吃惊</em>”选项。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="7dfc" class="md me it lz b gy mf mg l mh mi"># first we create a section of window called <strong class="lz iu">Price</strong></span><span id="5ca2" class="md me it lz b gy nn mg l mh mi">price_group = parser.add_argument_group('Price')</span><span id="097b" class="md me it lz b gy nn mg l mh mi">price_group.add_argument("prices",<br/>        metavar='How fancy are we feeling today?',<br/>        action = 'store',<br/>        choices=['$', '$$','$$$','$$$$','surprise me'],<br/>        default='$')</span><span id="102c" class="md me it lz b gy nn mg l mh mi"># we should set a default value if no option is chosen</span></pre><p id="bc41" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们需要知道他们在哪里，这样我们就可以推荐附近的餐馆。我们称这个组为<strong class="kk iu">邮政编码组</strong>。我们还在参数的末尾添加了一个验证器。验证器将评估用户输入，如果给出的邮政编码长度不是6位，它将不允许用户启动程序(<strong class="kk iu">非常重要的功能</strong>！).它甚至可以输出一条红色消息，告诉我们需要修复什么。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="5af8" class="md me it lz b gy mf mg l mh mi"># first we create a section of window called <strong class="lz iu">Postcode</strong></span><span id="d839" class="md me it lz b gy nn mg l mh mi">postcode_group = parser.add_argument_group('Postcode')</span><span id="cac1" class="md me it lz b gy nn mg l mh mi">postcode_group.add_argument('postcode',<br/>                    metavar='What is your postcode?',<br/>                    action='store',<br/>                    help = "6 digit postcode",<br/>                    gooey_options={<br/>                         'validator': {<br/>                             'test': 'len(user_input) == 6',<br/>                             'message': 'robot needs a 6 digit postcode!'<br/>                             }<br/>                         })</span></pre><p id="c6ef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请记住，<strong class="kk iu">元变量</strong>和<strong class="kk iu">。add_argument_group </strong>名称将出现在您的GUI窗口中，因此尽可能保持它们的标题简单明了。</p><p id="6d99" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">论点<strong class="kk iu">。add_argument_group </strong>将以粗体显示在窗口中，作为部分标题，即邮政编码</p><p id="e512" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">元变量将出现在最终用户输入之前，用于解释什么是想要的输入，即你的邮政编码是什么？</p><p id="2367" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们结束函数，指定我们希望它返回什么:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="ae49" class="md me it lz b gy mf mg l mh mi">args = parser.parse_args()<br/>return args</span></pre><p id="0d77" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一般来说，Gooey GUI的结构看起来有点像这样:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="c05f" class="md me it lz b gy mf mg l mh mi">import gooey<br/>#all other imports </span><span id="27ca" class="md me it lz b gy nn mg l mh mi">@Gooey(program_name="Restaurants",default_size=(710,700),navigation='TABBED', all other parameters...)</span><span id="3a7b" class="md me it lz b gy nn mg l mh mi">def parse_args():<br/>    parser = GooeyParser()</span><span id="a8e3" class="md me it lz b gy nn mg l mh mi"> group1 = parser.add_argument_group('group 1')<br/> group1.add_argument(metavar='a message to the user',<br/>                    action='store',<br/>                    help = "help the user understand what you want")</span><span id="2448" class="md me it lz b gy nn mg l mh mi"># add as many groups and arguments as necessary </span><span id="292b" class="md me it lz b gy nn mg l mh mi"># specify the return of the function</span><span id="ea8d" class="md me it lz b gy nn mg l mh mi"> args = parser.parse_args()<br/> return args</span><span id="bd57" class="md me it lz b gy nn mg l mh mi">def my_second_function():</span><span id="aa7b" class="md me it lz b gy nn mg l mh mi"># your python script here </span><span id="6f19" class="md me it lz b gy nn mg l mh mi">return something</span><span id="028a" class="md me it lz b gy nn mg l mh mi"># as many functions as necessary<br/></span><span id="d1e3" class="md me it lz b gy nn mg l mh mi"># time to call the functions and execute the script<br/>if __name__ == '__main__':</span><span id="b6ba" class="md me it lz b gy nn mg l mh mi"># execute the window</span><span id="902c" class="md me it lz b gy nn mg l mh mi">    args = parse_args()<br/>    my_second_function(variables)<br/>    ## and so on...</span><span id="8168" class="md me it lz b gy nn mg l mh mi"># THE END</span></pre><h1 id="81bf" class="mr me it bd ms mt mu mv mw mx my mz na jz nb ka nc kc nd kd ne kf nf kg ng nh bi translated">例如:餐馆</h1><p id="1d23" class="pw-post-body-paragraph ki kj it kk b kl ni ju kn ko nj jx kq kr nk kt ku kv nl kx ky kz nm lb lc ld im bi translated">Gooey 上有许多小部件、可定制的元素和动作。对于餐馆的例子，我们将应用其中的一些，但是一定要检查他们的GitHub中所有的<em class="lt">无限的可能性</em>！</p><p id="59af" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如前所述，这是我们的parse_args函数:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="c354" class="md me it lz b gy mf mg l mh mi">import pandas as pd<br/>from gooey import Gooey, GooeyParser<br/>import numpy as np<br/>from random import randint</span><span id="83be" class="md me it lz b gy nn mg l mh mi"><a class="ae le" href="http://twitter.com/Gooey" rel="noopener ugc nofollow" target="_blank">@Gooey</a>(program_name="robot restaurant recommendations",<br/>       default_size=(710, 700),<br/>       navigation='TABBED', header_bg_color = '#FF0000',<br/>       body_bg_color = '#FFF900')</span><span id="79bf" class="md me it lz b gy nn mg l mh mi">def parse_args():<br/>    parser = GooeyParser()<br/>    price_group = parser.add_argument_group('Price')<br/>    price_group.add_argument("prices",<br/>        metavar='How fancy are we feeling today?',<br/>        action = 'store',<br/>        choices=['$', '$$','$$$','$$$$','surprise me'],<br/>        default='$')<br/>    postcode_group = parser.add_argument_group('Postcode')<br/>    postcode_group.add_argument('postcode',<br/>                    metavar='What is your postcode?',<br/>                    action='store',<br/>                    help = "6 digit postcode",<br/>                    gooey_options={<br/>                         'validator': {<br/>                             'test': 'len(user_input) == 6',<br/>                             'message': '6 digit postcode!'<br/>                             }<br/>                         })</span><span id="1690" class="md me it lz b gy nn mg l mh mi">args = parser.parse_args()<br/>    return args</span><span id="953d" class="md me it lz b gy nn mg l mh mi">if __name__ == '__main__':<br/>    args = parse_args()<br/><br/>    prices = args.prices<br/>    postcode = args.postcode</span></pre><p id="385e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">但截至目前，它并没有向用户返还任何东西。为了做到这一点，我们需要创建更多的函数</strong>。让我们首先编写一个将给出的邮政编码与文件中的邮政编码相匹配的变量(我们将在<strong class="kk iu">if _ _ name _ _ = = ' _ _ main _ _ ':</strong>函数中定义这些变量并导入文件)</p><p id="c89c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> match_postcode </strong>函数将接收邮政编码和一个数据帧，清除数据帧的“zipcode”列中的任何空格(以避免用户输入和邮政编码之间的任何不匹配)，仅根据匹配用户邮政编码的行过滤数据帧，并将其返回，以便我们可以在下一个函数中使用该数据帧！</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="35f8" class="md me it lz b gy mf mg l mh mi">def match_postcode(postcode,df):<br/>    df.zipcode = df.zipcode.str.replace("\s","")<br/>    restaurants = df[df['zipcode'] == postcode]<br/>    return restaurants</span></pre><p id="e018" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">还记得我们有价格选择吗？每当你把这个论点传递给胶粘的T21，你可能需要做一个if语句来定义每个选择的不同结果。对于这个程序，我们只需要在用户选择“<em class="lt">给我惊喜</em>”时生成一个随机价格，所以在这个例子中，我只使用了一个if语句。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="6688" class="md me it lz b gy mf mg l mh mi">def match_price(prices, restaurants):<br/>    if prices == 'surprise me':<br/>        price_len = randint(1,4)<br/>    else:<br/>        price_len = len(prices)<br/>    print(price_len)<br/>    restaurants['length'] = restaurants['prices'].str.len()<br/>    restaurants = restaurants[restaurants['length'] == str(price_len)]<br/>    return restaurants</span></pre><p id="cfdc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们希望Gooey在一个弹出窗口中向我们显示推荐，这将引起最终用户的注意。所以我们定义了接下来的两个函数:一个用于当在参数范围内找到餐馆时，另一个用于当我们不能推荐任何东西时。<strong class="kk iu">在这里，我们在本地导入wx以避免它干扰Gooey </strong>。</p><p id="b23f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是一个使用wxPython定制Gooey的定制函数，但是它也可以在<a class="ae le" href="https://github.com/chriskiehl/Gooey" rel="noopener ugc nofollow" target="_blank"> Gooey库</a>上获得。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="19dc" class="md me it lz b gy mf mg l mh mi">def show_recommendations(message):<br/>    import wx<br/>    app = wx.App()<br/>    dlg = wx.MessageDialog(None, message, 'What about this one?', wx.ICON_INFORMATION)<br/>    dlg.ShowModal()</span><span id="f036" class="md me it lz b gy nn mg l mh mi">def show_error_message(message):<br/>    import wx<br/>    app = wx.App()<br/>    dlg = wx.MessageDialog(None, message, 'Whoops', wx.ICON_INFORMATION)<br/>    dlg.ShowModal()</span></pre><p id="9dc0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后但同样重要的是，我们需要将所有这些功能付诸行动:</p><p id="de9d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们定义变量prices和postcode，这是我们在脚本开始时从用户那里存储的。接下来，我们(在全球范围内)读取一个数据帧，该数据帧包含通过Yelp API获得的阿姆斯特丹餐馆的数据(查看我的其他文章了解更多信息！).之后，我们必须调用<strong class="kk iu"> match_ functions </strong>，并将它们的返回值赋给一个新的数据帧。</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="b826" class="md me it lz b gy mf mg l mh mi">if __name__ == '__main__':<br/>    args = parse_args()</span><span id="2054" class="md me it lz b gy nn mg l mh mi">    prices = args.prices<br/>    postcode = args.postcode<br/>    <br/>    df = pd.read_excel("yelp-ams.xlsx")<br/>    df2 = match_postcode(postcode,df)<br/>    df3 = match_price(prices, df2)</span></pre><p id="d048" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了向用户显示推荐，我们将该列转换成一个名为<strong class="kk iu">推荐</strong>的列表(然后转换成一个字典来删除任何重复的内容)，然后再转换回一个列表。如果列表不为空，我们调用<strong class="kk iu"> show_recommendations </strong>函数，如果为空，我们调用<strong class="kk iu"> show_error_message </strong>函数！</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="d1b7" class="md me it lz b gy mf mg l mh mi">recommendations = df3.name.tolist()<br/>    mylist = list( dict.fromkeys(recommendations) )<br/>    if mylist != []:<br/>        for restaurant in mylist:<br/>            show_recommendations(restaurant)<br/>    else:<br/>        show_error_message('Sorry! No restaurants found')</span></pre><p id="8e93" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你已经做到这里，谢谢你的阅读！一定要检查一下<a class="ae le" href="https://github.com/chriskiehl/Gooey" rel="noopener ugc nofollow" target="_blank"> Gooey Github </a>以了解更多关于它的所有功能，我在本教程中只提到了这些。希望这个图形用户界面可以帮助你和你的同事！</p></div></div>    
</body>
</html>