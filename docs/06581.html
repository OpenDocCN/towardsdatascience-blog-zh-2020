<html>
<head>
<title>Decision Trees in Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习中的决策树</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/decision-trees-in-machine-learning-d974efc37779?source=collection_archive---------53-----------------------#2020-05-24">https://towardsdatascience.com/decision-trees-in-machine-learning-d974efc37779?source=collection_archive---------53-----------------------#2020-05-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2744" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">手推车初学者指南</h2></div><p id="ab8c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有没有想过人类大脑在做决定时是如何工作的？在走上任何道路之前，要理解无限的可能性，所有关于奖励和惩罚的心理计算都必须考虑，以实现最佳的决策路线。是的，我们的大脑确实是一个杰作，我们将讨论如何教会我们的计算机决策的艺术。</p><p id="755f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">决策树是用于分类和回归任务的监督学习中的预测工具。它们现在被称为<strong class="kk iu"> CART </strong>，代表“分类和回归树”。决策树方法按照从根到叶遍历树状图形的算法，在每一步基于特定条件分割数据集。在每一个阶段，树的节点代表问题的可能测试用例，沿着节点的任何边前进代表一个可能的解决方案。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/377d800f939d99b839b0439e75206393.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BqSUHeLQVLDpH8kA"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">由<a class="ae lu" href="https://unsplash.com/@adigold1?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿迪·戈尔茨坦</a>在<a class="ae lu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="405d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">决策树</h1><p id="a41e" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">让我们看看决策树是什么样子的。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi mz"><img src="../Images/cfb709c360f7bea21753774f5750f74e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nLKcNuEEN8vFto9paF2Acw.png"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">基本决策树</p></figure><p id="362b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该图说明了一个简单的决策场景，其中一个人必须决定他/她是否有资格投票。因此，决策树从根开始，尝试根据用户的输入做出决策。在这里，这是一个分类问题，一个人只有当他/她是这个国家的公民并且年满18岁时才有资格投票。</p><p id="b416" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您现在可能会想，这可以在任何编程语言中使用简单的if-else语句来实现。但是，我向你保证，事情要比这复杂得多。</p><p id="262a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当涉及到庞大而复杂的数据集时，在整个树中进行决策时需要考虑各种参数。因此，决策树帮助我们做出这些决定。</p><p id="e4e8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看一个实际的例子，我们将根据一个人的属性来预测他是否能被录用。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="b3a7" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">招聘预测</h1><p id="7a49" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">让我们从导入数据集开始。</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="0f40" class="nf md it nb b gy ng nh l ni nj">import numpy as np<br/>import pandas as pd<br/>from sklearn import tree # import decision tree from scikit learn library</span><span id="814a" class="nf md it nb b gy nk nh l ni nj">df = pd.read_csv("PastHires.csv" , header = 0) # Read the dataset</span></pre><p id="c462" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看这里有什么。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nl"><img src="../Images/e907c0c8f771d91f682d6b8b9d3bb0fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*slUOy3iUzaB8rQMStrqDLg.png"/></div></div></figure><p id="d1bb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了能够使用机器学习，数据集中的每个字母条目都必须转换为数字。</p><p id="e5dc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">转换“已雇用？”中的“Y”条目、“顶级学校”、“实习”和“聘用”列设置为1，所有“N”项设置为0。</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="c853" class="nf md it nb b gy ng nh l ni nj"># Convert the alphabetical entries to numerical entries<br/>d = {'Y': 1, 'N': 0}<br/>df['Employed?'] = df['Employed?'].map(d)<br/>df['Top-tier school'] = df['Top-tier school'].map(d)<br/>df['Interned'] = df['Interned'].map(d)<br/>df['Hired'] = df['Hired'].map(d)</span></pre><p id="9d42" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们也把他们的资格映射成数字。0分代表理学士，1分代表理硕士，2分代表理博士。</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="bd70" class="nf md it nb b gy ng nh l ni nj">d = {'BS': 0, 'MS': 1, 'PhD': 2}<br/>df['Level of Education'] = df['Level of Education'].map(d)</span></pre><p id="894f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据集现在看起来像这样，</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="1260" class="nf md it nb b gy ng nh l ni nj">df.head()</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nm"><img src="../Images/6d97bd32b4c2105ec297dd0618cf769b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_C5dl23AlYcO-AvANltkOw.png"/></div></div></figure><p id="d2ca" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">“已雇用”列中的目标列是我们需要预测的列，其余列是我们在做出决策时考虑的功能。</p><p id="6790" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，将features列从目标中分离出来。</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="2f29" class="nf md it nb b gy ng nh l ni nj"># List the factors involved in making the decision to hire or not<br/>features = list(df.columns[:6])<br/>features</span></pre><p id="60fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在构建我们的树之前，让我们在x中调用我们的特性，在y中调用我们的目标。</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="56d5" class="nf md it nb b gy ng nh l ni nj">y = df["Hired"]<br/>X = df[features]</span></pre><p id="3366" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">是时候建造我们的圣诞树了。我们将使用树包中的<strong class="kk iu"> DecisionTreeClassifier() </strong>方法来制作我们的树。</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="d9d9" class="nf md it nb b gy ng nh l ni nj">clf = tree.DecisionTreeClassifier() # Decision tree Classifier<br/>clf = clf.fit(X,y)</span></pre><p id="6258" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">决策树现在已经准备好了。为了可视化树，我们必须安装pydotplus和graphviz包。</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="2cfe" class="nf md it nb b gy ng nh l ni nj">pip install pydotplus graphviz</span></pre><p id="60ac" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，想象决策树。</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="58c4" class="nf md it nb b gy ng nh l ni nj">from IPython.display import Image  <br/>from sklearn.externals.six import StringIO  <br/>import pydotplus</span><span id="2080" class="nf md it nb b gy nk nh l ni nj">dot_data = StringIO()  <br/>tree.export_graphviz(clf, out_file=dot_data,  <br/>                         feature_names=features)  <br/>graph = pydotplus.graph_from_dot_data(dot_data.getvalue())  <br/>Image(graph.create_png())</span></pre><p id="6f74" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">😲是啊！我们刚刚得到了一个惊人的决策树，可能是这样的。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/0ad1ccdf8da65264a2a68b5f3fccacfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*wET-NhFxewVJxFAPD3Rl2w.png"/></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">决策树</p></figure><h2 id="2636" class="nf md it bd me no np dn mi nq nr dp mm kr ns nt mo kv nu nv mq kz nw nx ms ny bi translated">推理</h2><p id="dec3" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">让我们分析一下我们刚刚得到的决策树，它对于理解这个算法是如何工作的至关重要。在任一点上，从树的右边往下，表示一个人被雇用，从左边往下，表示这个人没有被雇用。可以观察到一个人“就业？”值&gt; 0.5的列立即被雇用。被雇佣的人。列的值小于0.5，但在“Interned”列中的值大于0.5。类似地，可以评估树中的其他节点。该树有某些度量标准，它为自己设置了这些度量标准，以便在遍历该树时逐步做出决策。</p><h1 id="8409" class="mc md it bd me mf nz mh mi mj oa ml mm jz ob ka mo kc oc kd mq kf od kg ms mt bi translated">预言</h1><h2 id="7ab6" class="nf md it bd me no np dn mi nq nr dp mm kr ns nt mo kv nu nv mq kz nw nx ms ny bi translated">随机森林</h2><p id="2db4" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">随机森林只不过是大量的决策树。它将树的数量作为输入，并生成许多决策树的组合。最后，在分类的情况下，预测基于众数，在回归的情况下，预测基于平均数。</p><p id="01ba" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用sci-kit学习库中的<strong class="kk iu"> RandomForestClassifier() </strong>方法。让我们生成10个这样的决策树。</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="0d12" class="nf md it nb b gy ng nh l ni nj">from sklearn.ensemble import RandomForestClassifier</span><span id="ce45" class="nf md it nb b gy nk nh l ni nj">clf = RandomForestClassifier(n_estimators=10) # Set number of decision trees<br/>clf = clf.fit(X, y)</span></pre><p id="16c2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将使用这个随机森林来预测一个具有特定属性的人是否会被雇佣。对具有以下特征的人的预测:</p><ul class=""><li id="7502" class="oe of it kk b kl km ko kp kr og kv oh kz oi ld oj ok ol om bi translated">15年的经验</li><li id="5986" class="oe of it kk b kl on ko oo kr op kv oq kz or ld oj ok ol om bi translated">已经被雇佣了</li><li id="d183" class="oe of it kk b kl on ko oo kr op kv oq kz or ld oj ok ol om bi translated">4名前雇主</li><li id="aaa6" class="oe of it kk b kl on ko oo kr op kv oq kz or ld oj ok ol om bi translated">博士资格</li><li id="303b" class="oe of it kk b kl on ko oo kr op kv oq kz or ld oj ok ol om bi translated">顶级学校毕业的，而且</li><li id="19c2" class="oe of it kk b kl on ko oo kr op kv oq kz or ld oj ok ol om bi translated">已经实习</li></ul><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="0847" class="nf md it nb b gy ng nh l ni nj">print (clf.predict([[15, 1, 4, 2, 1, 1]]))<br/>[1]</span></pre><p id="57ac" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让我们预测另一个有特征的人:</p><ul class=""><li id="d951" class="oe of it kk b kl km ko kp kr og kv oh kz oi ld oj ok ol om bi translated">1年经验</li><li id="2794" class="oe of it kk b kl on ko oo kr op kv oq kz or ld oj ok ol om bi translated">未就业</li><li id="e6d3" class="oe of it kk b kl on ko oo kr op kv oq kz or ld oj ok ol om bi translated">0以前的雇主</li><li id="9ab1" class="oe of it kk b kl on ko oo kr op kv oq kz or ld oj ok ol om bi translated">学士资格证书</li><li id="233d" class="oe of it kk b kl on ko oo kr op kv oq kz or ld oj ok ol om bi translated">不是来自顶级学校</li><li id="8670" class="oe of it kk b kl on ko oo kr op kv oq kz or ld oj ok ol om bi translated">没有实习过</li></ul><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="79db" class="nf md it nb b gy ng nh l ni nj">print (clf.predict([[1, 0, 0, 0, 0, 0]]))<br/>[0]</span></pre></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="0b50" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结果</h1><p id="d6db" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">我们看到，在第一种情况下，非常适合这份工作的人甚至不需要一直沿着决策树往下走，就立即被归类为被雇用。在第二种情况下，这个人不符合公司雇佣他所需要的特征。</p><p id="7eb1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在运行多个测试用例的预测时，我们可以观察到，预测的值有时会发生变化。这是因为随机森林分类器方法每次运行时都会考虑随机生成的树。这是完全正常的，因为我们在虚构的数据集中只使用了14个条目。随着数据集大小的增加，需要考虑的不同组合也越来越多，这可以提高决策树的纯度。</p><p id="f04b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">耶！🙌我们刚刚建立了一个决策树，可以根据一个人的属性来预测他是否可以被录用。</p><p id="a426" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">希望你们都明白决策树在机器学习领域的重要性。如有任何疑问，请随时通过我的<a class="ae lu" href="https://www.linkedin.com/in/k-g-prajwal-a6b3b517a/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。完整的代码可以在我的<a class="ae lu" href="https://github.com/K-G-PRAJWAL?tab=repositories" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到。</p><h2 id="aad2" class="nf md it bd me no np dn mi nq nr dp mm kr ns nt mo kv nu nv mq kz nw nx ms ny bi translated">谢谢大家！</h2></div></div>    
</body>
</html>