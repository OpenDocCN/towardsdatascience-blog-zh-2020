<html>
<head>
<title>Getting used to the Pandas package — lesson, exercises and corrections</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">适应熊猫套餐——课程、练习和修改</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/exercises-to-get-used-to-the-pandas-package-lesson-aac431f3fe0e?source=collection_archive---------44-----------------------#2020-04-19">https://towardsdatascience.com/exercises-to-get-used-to-the-pandas-package-lesson-aac431f3fe0e?source=collection_archive---------44-----------------------#2020-04-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/c0a6da354c9bd281f1eb0032e574fc13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qsrQ31NQuSMlA_-HXKpScw.png"/></div></div></figure><h1 id="34c9" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">学习熊猫</h1><h2 id="2ac7" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">熊猫和数据框</h2><p id="6a2f" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">因为你用的是熊猫，你必须在(几乎)所有笔记本上写的第一行是</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="bb3e" class="kz kc it mo b gy ms mt l mu mv">import pandas as pd</span></pre><p id="acfe" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">在熊猫中，数据帧是一个表格。你可以在一个数据框架上做很多事情:对一列求和，绘制直方图，做一个数据透视表…</p><p id="1392" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">作为一个好的开始，简单地写“pd”在一个空的单元格中，使用键盘快捷键<strong class="lq iu"> Tab </strong>来查看 pandas 中所有可用的功能。你会的</p><h2 id="3bd6" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">创建数据框架</h2><p id="2ed2" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">要创建数据帧，请使用:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="1014" class="kz kc it mo b gy ms mt l mu mv">pd.DataFrame({<br/>  'age':[10, 45, 13]<br/>})</span></pre><p id="323d" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">函数' pd。DataFrame()'使用字典:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="4da9" class="kz kc it mo b gy ms mt l mu mv">{<br/>  'age':[10, 45, 13]<br/>}</span></pre><p id="78b6" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">其中“年龄”是列的名称，[10，45，13]是行的值。</p><p id="554c" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">注意您可以有多列:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="a470" class="kz kc it mo b gy ms mt l mu mv">{<br/>  'age':[10, 45, 13],<br/>  'name': ['George', 'Damien', 'Ingrid'],<br/>  'gender': ['male', 'male', 'female']<br/>}</span></pre><p id="06f7" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">你可以看到这有点不直观，因为我们习惯于把表格想象成由<em class="nb">行</em>组成的列表。更确切地说，熊猫数据框架使用了一系列<em class="nb">列</em>。这是要掌握的第一个概念。创建数据帧还有其他方法，但这是最常用的一种。其他的包括读取文件:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="f02d" class="kz kc it mo b gy ms mt l mu mv">pd.read_excel('myExcelFile.xlsx')</span></pre><p id="74d2" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated"><em class="nb">(打开文件前不要忘记关闭，否则会出错)</em></p><p id="b570" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">或者</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="dda2" class="kz kc it mo b gy ms mt l mu mv">pd.read_csv('myFile.csv')</span></pre><h2 id="01e6" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">组合数据帧</h2><p id="93ea" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">组合数据帧非常简单:使用任意一种。join()，。append()、pd.concat()或。合并()。</p><p id="79c2" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">见下文(很丑但很管用)</p><p id="7e3b" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated"><strong class="lq iu">同。join(): </strong></p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="db8f" class="kz kc it mo b gy ms mt l mu mv">pd.DataFrame({<br/>  'age':[10, 45, 13]<br/>}).<strong class="mo iu">join(</strong><br/>pd.DataFrame({<br/>  'name': ['George', 'Damien', 'Ingrid']<br/>})<br/><strong class="mo iu">)</strong>.<strong class="mo iu">join(</strong><br/>pd.DataFrame({<br/>  'gender': ['male', 'male', 'female']<br/>})<br/><strong class="mo iu">)</strong></span></pre><p id="3f6c" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">返回</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nc"><img src="../Images/147ddd6eb612dd8f7511c3f06b265cf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*jD9ZDXgCIqsjGmFReJrF3w.png"/></div></div></figure><p id="a409" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated"><strong class="lq iu">同。append(): </strong></p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="fcd2" class="kz kc it mo b gy ms mt l mu mv">pd.DataFrame({<br/>  'age':[10, 45, 13]<br/>}).<strong class="mo iu">append(</strong><br/>pd.DataFrame({<br/>  'age': ['George', 'Damien', 'Ingrid']<br/>})<br/><strong class="mo iu">)</strong>.<strong class="mo iu">append(</strong><br/>pd.DataFrame({<br/>  'age': ['male', 'male', 'female']<br/>})<br/><strong class="mo iu">)</strong></span></pre><p id="88b3" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">返回</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/4f30490e22b1bf785d6369eb4d9fc965.png" data-original-src="https://miro.medium.com/v2/resize:fit:332/format:webp/1*_TN8uct2NdM_1jmnq4EsVg.png"/></div></figure><p id="6257" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">(见丑索引:0，1，2，0，1，2，0，1，2)</p><p id="d872" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">注意 append 不能连接列上的数据帧，它必须通过行连接(一行在另一行之上，而不是一行挨着一行)。数据帧之间必须有相同的列名，否则会得到警告。</p><p id="438b" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated"><strong class="lq iu"> With pd.concat(): </strong></p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="12c3" class="kz kc it mo b gy ms mt l mu mv"><strong class="mo iu">pd.concat([</strong><br/>    pd.DataFrame({<br/>      'age':[10, 45, 13]<br/>    }),<br/>    pd.DataFrame({<br/>      'name': ['George', 'Damien', 'Ingrid']<br/>    }),<br/>    pd.DataFrame({<br/>      'gender': ['male', 'male', 'female']<br/>    })<br/><strong class="mo iu">], axis=1)</strong></span></pre><p id="a3bb" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">返回</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/1c7578d6a9eae148a643da5c2c64fb65.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*x1oygrYD5gdZRqsszA8RsA.png"/></div></figure><p id="3000" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">请注意，pd.concat()将用于数据帧列表，而不是数据帧。使用 pd.concat([df1，df2，…])。注意在熊猫中很常见的轴=1。基本上，轴=0 是列，轴=1 是行。</p><p id="60b8" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated"><strong class="lq iu">同。merge(): </strong></p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="7eae" class="kz kc it mo b gy ms mt l mu mv">pd.DataFrame({<br/>  'age':[10, 45, 13],<br/>  'name': ['George', 'Damien', 'Ingrid']<br/>})<strong class="mo iu">.merge(</strong><br/>pd.DataFrame({<br/>  'name': ['George', 'Damien', 'Ingrid'],<br/>  'gender': ['male', 'male', 'female']<br/>})<strong class="mo iu">, on=['name']</strong><br/><strong class="mo iu">)</strong></span></pre><p id="6489" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">返回</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/1c7578d6a9eae148a643da5c2c64fb65.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*x1oygrYD5gdZRqsszA8RsA.png"/></div></figure><p id="f07e" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">。“merge()”是 SQL“JOIN”。您至少需要一列来匹配它们。</p><h2 id="203f" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">在数据帧上运行操作</h2><p id="a8eb" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated"><strong class="lq iu">总和、最大值、最小值、平均值、中值</strong></p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="f2a0" class="kz kc it mo b gy ms mt l mu mv">pd.DataFrame({<br/>  'age':[10, 45, 13],<br/>  'name': ['George', 'Damien', 'Ingrid'],<br/>  'gender': ['male', 'male', 'female']<br/>})<strong class="mo iu">.mean()</strong></span></pre><p id="d2df" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">返回</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/e9d2e9745b0b71283c534afa0983612b.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*iVjnLrbvluL5eqZRGE7JLA.png"/></div></figure><p id="628b" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">请注意，它仅对数值列进行平均。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="9440" class="kz kc it mo b gy ms mt l mu mv">pd.DataFrame({<br/>  'age':[10, 45, 13],<br/>  'name': ['George', 'Damien', 'Ingrid'],<br/>  'gender': ['male', 'male', 'female']<br/>})<strong class="mo iu">.sum()</strong></span></pre><p id="b32a" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">返回</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/6cc117864dffb37f01e8a3d73e74e8bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*hkcub_gAHAz3cVRKcmT6Lw.png"/></div></figure><p id="6c9f" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">看到它适用于所有列了吗？！！它将文本连接在一起，并对“年龄”列求和。这是因为你可以用 Python 对文本求和:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="34ea" class="kz kc it mo b gy ms mt l mu mv">'Damien' + 'George'</span></pre><p id="5768" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">这里我们不关心文本的总和，但在某些情况下，它可能是有趣的。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="491c" class="kz kc it mo b gy ms mt l mu mv">pd.DataFrame({<br/>  'age':[10, 45, 13],<br/>  'name': ['George', 'Damien', 'Ingrid'],<br/>  'gender': ['male', 'male', 'female']<br/>})<strong class="mo iu">.min()</strong></span></pre><p id="df05" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">返回</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/2f2e6428773efc4cc429f80a87baf517.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*PqVyX_b2l7PApQZxzFcqDg.png"/></div></figure><p id="864d" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">。min()返回数值的最小值，同时也返回按字母顺序排列的字符串的最小值！这是因为您可以在 Python 中比较文本:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="7505" class="kz kc it mo b gy ms mt l mu mv">'Damien' &gt; 'George'</span></pre><p id="4e27" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated"><strong class="lq iu">透视表 _ 表格</strong></p><p id="5012" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">如果你是一个 Excel 用户，不需要介绍这个。数据透视表只是以一种易于阅读的方式将数据聚集在一起。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="8a57" class="kz kc it mo b gy ms mt l mu mv">pd.DataFrame({<br/>  'age':[10, 45, 13],<br/>  'name': ['George', 'Damien', 'Ingrid'],<br/>  'gender': ['male', 'male', 'female']<br/>})<strong class="mo iu">.pivot_table(</strong>index='gender', aggfunc='min'<strong class="mo iu">)</strong></span></pre><p id="18bf" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">返回</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ni"><img src="../Images/e69a1229a7d721b2ad70c885727ccc57.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*hwia9hothJ2PD7t-zY0s9Q.png"/></div></div></figure><p id="acb5" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">和以前一样,“min”操作符对数字列和字符串列都有效。</p><p id="a4b2" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated"><strong class="lq iu">自定义功能</strong></p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/05c8352c191a66370dfde924605c484d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/0*IVvt1DeNQilrsaWp.jpg"/></div></figure><p id="157a" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">要在 0 和 1 之间缩放数据集的列，可以编写以下代码:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="4b86" class="kz kc it mo b gy ms mt l mu mv">for column in df.columns:<br/>  df[column] = \<br/>    (df[column] — df[column].min()) / \<br/>    (df[column].max() — df[column].min())</span></pre><p id="b114" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">记住反斜杠是换行符。</p><p id="416d" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">更高级的写法是使用<strong class="lq iu">。应用()</strong>方法。顾名思义，它将一个函数同时应用于所有列或所有行。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="d422" class="kz kc it mo b gy ms mt l mu mv">df = df.apply(<br/>  lambda column: (column-column.min()) / (column.max()-column.min())<br/>)</span></pre><p id="6cd3" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">要对 1 个特定列执行自定义功能，请使用<strong class="lq iu">。</strong>地图()【方法】。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="6436" class="kz kc it mo b gy ms mt l mu mv">df['column_1_squared'] = df['column_1'].map(<br/>  lambda x: x * x<br/>)</span></pre><h2 id="bdb2" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">结论</h2><p id="326e" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">尽可能多地练习这些。它们会变得非常有用。</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/62f641dd66d54782205f9172a8579ed9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*a74LTcnT_m5JSbMV.png"/></div></div></figure><h1 id="0512" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">练习</h1><h2 id="f1e2" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">创建数据框架</h2><p id="a9cc" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated">创建如下图所示的数据帧。哦，找到一个聪明的方法来创建它们，不要只是在字典中硬编码这些值:</p><p id="9463" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi">1)</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/f593e544b90cc580535728b7b3f763f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:528/format:webp/0*2hi4wtrczGdvJ8jY.png"/></div><p class="nl nm gj gh gi nn no bd b be z dk translated">数据框#1:从 3 到 10 的正方形</p></figure><p id="e9a4" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi">2)</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi np"><img src="../Images/28efdb08ac87b1c8a723b388271806df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jEbSVpFY2qN-C0_J.png"/></div></div><p class="nl nm gj gh gi nn no bd b be z dk translated">数据帧#2:多列</p></figure><p id="f166" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi">3)</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/392a32b06ef7f81e209d07c8f65e2f34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7Vc8cNNJBVO6bb-x.png"/></div></div><p class="nl nm gj gh gi nn no bd b be z dk translated">数据帧#3:平方数</p></figure><h2 id="51e7" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">组合数据帧</h2><p id="7f42" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi">1)</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="85fc" class="kz kc it mo b gy ms mt l mu mv">customers1 = pd.DataFrame({<br/>  'age':[10, 45, 13],<br/>  'name': ['George', 'Damien', 'Ingrid'],<br/>  'gender': ['male', 'male', 'female']<br/>})customers2 = pd.DataFrame({<br/>  'age':[12, 23, 25],<br/>  'name': ['Albert', 'Jane', 'Angela'],<br/>  'gender': ['male', 'female', 'female']<br/>})</span></pre><p id="661c" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">如何在一行中编写连接两个客户表的表？</p><p id="5525" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">2) <strong class="lq iu"> <em class="nb">难</em> </strong></p><p id="2a3a" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">假设您的硬盘上有一些名为<strong class="lq iu"> cust_transactions </strong>的文件夹中的文件。每个文件都包含一些客户交易的以下信息:</p><p id="2e06" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated"><strong class="lq iu"> file_482.csv </strong>包含以下 4 列:</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nr"><img src="../Images/802f82e542dfa3b4f0e60d12b973dc76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8poUCr6nnk_VjRuv.png"/></div></div></figure><p id="1c71" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">如何将所有文件读入一个名为“transactions”的数据帧？</p><h2 id="53f8" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">最后一个</h2><p id="43ff" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi translated"><strong class="lq iu"> <em class="nb">非常困难；)</em> </strong></p><p id="626c" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">你有一个名为 model_1，model_2，…，model_5 的 5 sklearn 二元分类模型。您希望在名为 X_train 和 X_test 的训练集和测试集上测量所有这 5 个模型的 AUC、对数损失、准确性和 f1 得分。目标的实际值分别是 y_train 和 y_test。</p><p id="027c" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">每行代表一个模型的性能。</p><p id="9f17" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">你能写一个干净的代码来创建下面的表吗？</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/5850076d0cdb32837cb6f2733ce4920e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rlatPiEvhtT3R-cC.png"/></div></div></figure><p id="b9ee" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated"><em class="nb">提醒:</em></p><p id="2f98" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">这是衡量准确性的 4 个标准:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="fa74" class="kz kc it mo b gy ms mt l mu mv"><strong class="mo iu">from</strong> sklearn.metrics <strong class="mo iu">import</strong> log_loss, roc_auc_score, accuracy_score, f1_score</span></pre><p id="d339" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated"><strong class="lq iu"> log_loss </strong>和<strong class="lq iu"> roc_auc_score </strong>以预测的<em class="nb">概率</em>为输入，<strong class="lq iu"> accuracy_score </strong>和<strong class="lq iu"> f1_score </strong>以预测的<em class="nb">类</em>为输入。</p><p id="c715" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">例如，如果 m 是模型的名称:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="21da" class="kz kc it mo b gy ms mt l mu mv">log_loss(y_true=y_train, <strong class="mo iu">y_pred</strong>=m.<strong class="mo iu">predict_proba</strong>(X_train)<strong class="mo iu">[:,1]</strong>)<br/>roc_auc_score(y_true=y_train, <strong class="mo iu">y_score</strong>=m.<strong class="mo iu">predict_proba</strong>(X_train)<strong class="mo iu">[:,1]</strong>)</span></pre><p id="3678" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">注意一个用 y_pred，另一个用 y_score。</p><figure class="mj mk ml mm gt ju gh gi paragraph-image"><div class="ab gu cl nt"><img src="../Images/295e6c2c8a28fd80adc7ab5fcf5fbfba.png" data-original-src="https://miro.medium.com/v2/format:webp/0*KNc4iR1W9yxbkf2E.png"/></div></figure><h1 id="1c60" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">修改</h1><h2 id="ee28" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">创建数据框架</h2><p id="1a32" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi">1)</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="72ea" class="kz kc it mo b gy ms mt l mu mv">pd.DataFrame({<br/>    'n': range(3,11),<br/>    'n_squared': [n*n for n in range(3,11)]<br/>})</span></pre><p id="9a4e" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi">2)</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="488f" class="kz kc it mo b gy ms mt l mu mv">pd.DataFrame({'number_'+str(n):[n] for n in range(10)})</span></pre><p id="2876" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">别忘了 n 旁边的<strong class="lq iu"> [] </strong>。</p><p id="3505" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi">3)</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="d30d" class="kz kc it mo b gy ms mt l mu mv">pd.DataFrame({'column_'+str(n):[n*m for m in range(10)] for n in range(10)})</span></pre><p id="0d68" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">两个列表理解交织在一起。</p><h2 id="4163" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">组合数据帧</h2><p id="9285" class="pw-post-body-paragraph lo lp it lq b lr ls lt lu lv lw lx ly le lz ma mb lh mc md me lk mf mg mh mi im bi">1)</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="20c0" class="kz kc it mo b gy ms mt l mu mv">customers1.append(customers2, ignore_index=True)</span></pre><p id="c109" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">注意 ignore_index=True 不是必须的，获得一个干净的新索引是很好的。</p><p id="2386" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi">2)</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="5403" class="kz kc it mo b gy ms mt l mu mv">import ostransactions = pd.concat([<br/>    pd.read_csv(f) <br/>    for f in os.listdir('cust_transactions') <br/>    if f.endswith('.csv')<br/>])</span></pre><p id="6a6a" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">“导入操作系统”是调用“os.listdir('cust_transactions ')”所必需的，它列出了“cust_transactions”文件夹中的所有文件。我加了 if f.endswith(。csv)，以防文件夹中有其他类型的文件。</p><p id="fc45" class="pw-post-body-paragraph lo lp it lq b lr mw lt lu lv mx lx ly le my ma mb lh mz md me lk na mg mh mi im bi translated">使用多个。这里的 append()看起来也是一个不错的选择。但是在一起读几千或者几百万个文件的时候，会很慢。将 pd.concat([])与 pd.read_csv()一起使用将是最快的选择。</p><h2 id="d024" class="kz kc it bd kd la lb dn kh lc ld dp kl le lf lg kp lh li lj kt lk ll lm kx ln bi translated">最后一个</h2><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="8a51" class="kz kc it mo b gy ms mt l mu mv">models = [model_1, model_2, model_3, model_4, model_5]pd.concat(<br/>    [<br/>        pd.DataFrame({<br/>            sample+'_log_loss': [log_loss(y_true=y, y_pred=m.predict_proba(X)[:,1]) for m in models],<br/>            sample+'_AUC':      [roc_auc_score(y_true=y, y_score=m.predict_proba(X)[:,1]) for m in models],<br/>            sample+'_accuracy': [accuracy_score(y_true=y, y_pred=m.predict(X)) for m in models],<br/>            sample+'_f1score':  [f1_score(y_true=y, y_pred=m.predict(X)) for m in models]<br/>        })<br/>        for (sample,X,y) in zip(['train', 'test'], [X_train, X_test], [y_train, y_test])<br/>    ],<br/>    axis=1<br/>)</span></pre></div></div>    
</body>
</html>