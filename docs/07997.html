<html>
<head>
<title>Dealing with missing data in data science projects</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">处理数据科学项目中的缺失数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dealing-with-missing-data-in-data-science-projects-e8ac7a4efdff?source=collection_archive---------22-----------------------#2020-06-13">https://towardsdatascience.com/dealing-with-missing-data-in-data-science-projects-e8ac7a4efdff?source=collection_archive---------22-----------------------#2020-06-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2098" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">如何不因丢失数据而丢失有价值的信息</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2a8589ea4e19b795fbcfd745abfa5536.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TNuKxrRpjazdOHqQ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@emilymorter?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">艾米丽·莫特</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="9266" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是关于连接点…..它们在数据科学中是真实的。</p><p id="a89d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">缺失数据一直存在，一直是个问题。人们通常会根据数据集的大小和问题的严重程度来临时处理这些问题。</p><p id="906a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于数据的激增以及随之而来的不可避免的价值缺失，它最近越来越受到关注。人们在如何处理这些问题上很有创意，甚至发表了关于缺失数据问题和处理方法的学术论文。</p><p id="e450" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本文的目的是总结其中的一些讨论和技术，并演示如何在数据科学项目中导航。所以请容忍我。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="4ccc" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated"><strong class="ak">什么是缺失数据</strong></h1><p id="2679" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">缺失数据是没有记录在数据集中的值。它们可以是单个单元格中缺少的单个值，也可以是整个观察值(行)中缺少的值。连续变量(如学生的身高)或分类变量(如人口的性别)都可能出现缺失数据。</p><p id="e121" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">缺失数据在自然科学或行为科学的任何领域都很常见，但在社会科学研究数据中尤其常见。</p><p id="9f55" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在编程语言中，丢失的值被表示为<code class="fe na nb nc nd b">NA</code>或<code class="fe na nb nc nd b">NaN</code>或者只是对象中的一个空单元格。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/0f8dca04d27b0e764c82270bff9fc1f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PLyRon-PfTfGlwZ6wsSbvg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图:熊猫数据帧中显示为NaN的缺失值</p></figure><h1 id="5dda" class="md me it bd mf mg nf mi mj mk ng mm mn jz nh ka mp kc ni kd mr kf nj kg mt mu bi translated"><strong class="ak">缺失数据的来源</strong></h1><p id="061e" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">那么，缺失的价值观从何而来，它们为什么会存在？</p><p id="fa74" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">举个例子吧。您正在对受访者样本进行问卷调查；在问卷中，你问了一个关于家庭收入的问题。现在，如果一个回答者拒绝回答这个问题呢？你会编造还是留空白？您可能会将该单元格留空，从而创建一个缺少值的实例。</p><p id="ae62" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">或者一个丢失的值可能仅仅是由于人为错误引起的。有人可能输入了错误的数据(还记得异常值吗？)在数据清理或探索性数据分析(EDA)过程中被检测到并删除。</p><p id="e38a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在另一个例子中，一些时间序列数据-特别是调查数据集-可能包含缺失的观测值。这可能仅仅是因为在一个系列的一年或几年中没有进行调查。</p><h1 id="bf54" class="md me it bd mf mg nf mi mj mk ng mm mn jz nh ka mp kc ni kd mr kf nj kg mt mu bi translated"><strong class="ak">引起的问题</strong></h1><p id="9c41" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">缺失值肯定是不可取的，但在统计和机器学习项目中，很难量化影响的大小。如果它是一个大型数据集，并且丢失了很小一部分数据，那么这种影响可能根本无法察觉。</p><p id="1d5a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果数据集相对较小，每个数据点都很重要。在这些情况下，丢失数据点意味着丢失有价值的信息。</p><p id="9514" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在任何情况下，通常缺失的数据会造成不平衡的观察，导致有偏见的估计，在极端情况下，甚至会导致无效的结论。</p><h1 id="3fc8" class="md me it bd mf mg nf mi mj mk ng mm mn jz nh ka mp kc ni kd mr kf nj kg mt mu bi translated"><strong class="ak">如何处理丢失的数据</strong></h1><p id="e2d8" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">预防胜于治疗！</p><p id="a96c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，最大限度地减少生产中丢失数据的发生是处理它们的最有效方法。如果你正在进行客户调查，尽量不要让任何一个字段为空，继续跟进未回答的问题。如果样本量很小，确定缺失值的可接受阈值。如果超过了阈值，则扩大样本量。设计实验或收集数据，明确地以最小化缺失值为目标。</p><p id="f778" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果不可避免，以下是处理缺失数据的一些其他常用方法:</p><ul class=""><li id="125b" class="nk nl it lb b lc ld lf lg li nm lm nn lq no lu np nq nr ns bi translated"><strong class="lb iu">案例删除:</strong>如果数据集相对较大，则删除带有缺失值的完整记录</li><li id="9d0e" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated"><strong class="lb iu">替换:</strong>用(a)列平均值、(b)最近邻居的平均值、(c)移动平均值或(c)用最后一次观察值填充来替换缺失的单元格</li><li id="eba0" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated"><strong class="lb iu">统计插补:</strong>在给定数据集中其他信息的情况下，回归可能是确定缺失像元值的有效方法</li><li id="ba29" class="nk nl it lb b lc nt lf nu li nv lm nw lq nx lu np nq nr ns bi translated"><strong class="lb iu">敏感性分析:</strong>如果样本较小或缺失值相对较大，则进行多变量结果的敏感性分析。</li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h1 id="206a" class="md me it bd mf mg mh mi mj mk ml mm mn jz mo ka mp kc mq kd mr kf ms kg mt mu bi translated">数据科学解决方案</h1><p id="360f" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">那么它在实践中是如何工作的呢？下面是几个带有Python代码的示例。出于演示的目的，我使用了美国大陆上星巴克位置的数据集。</p><h2 id="fd57" class="ny me it bd mf nz oa dn mj ob oc dp mn li od oe mp lm of og mr lq oh oi mt oj bi translated"><strong class="ak"> 1。检查缺失值</strong></h2><p id="d051" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">将<code class="fe na nb nc nd b">pandas</code>和<code class="fe na nb nc nd b">numpy</code>库以及数据集作为pandas dataframe导入。</p><pre class="kj kk kl km gt ok nd ol om aw on bi"><span id="8280" class="ny me it nd b gy oo op l oq or"># import libraries<br/>import pandas as pd<br/>import numpy as np</span><span id="ae02" class="ny me it nd b gy os op l oq or"># import data<br/>df = pd.read_csv("starbucks_location.csv")</span></pre><p id="26c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以用一行代码检查每一列中缺失值的总数。</p><pre class="kj kk kl km gt ok nd ol om aw on bi"><span id="4762" class="ny me it nd b gy oo op l oq or">df.isnull().sum()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/487fe398c72ec7b8ff1eea753f6fed5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*w47XmfUxKVh_uq1MgMp3IQ.png"/></div></figure><p id="d43d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您还可以检查缺失值占所有观察值的百分比。</p><pre class="kj kk kl km gt ok nd ol om aw on bi"><span id="5409" class="ny me it nd b gy oo op l oq or">df.isnull().sum()*100/len(df)</span></pre><h2 id="8f29" class="ny me it bd mf nz oa dn mj ob oc dp mn li od oe mp lm of og mr lq oh oi mt oj bi translated">2.删除缺少的值</h2><p id="021c" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">对缺失值的一种处理方法是，如果数据集相对较大且缺失案例较少，则完全丢弃观察值。</p><pre class="kj kk kl km gt ok nd ol om aw on bi"><span id="d9e6" class="ny me it nd b gy oo op l oq or"># drop all rows containing null<br/>df.dropna()</span><span id="7178" class="ny me it nd b gy os op l oq or"># drop all columns containing null<br/>df.dropna(axis=1)</span><span id="dfc6" class="ny me it nd b gy os op l oq or"># drop columns with less than 5 na values<br/>df.dropna(axis=1, thresh=5)</span></pre><h2 id="fa5f" class="ny me it bd mf nz oa dn mj ob oc dp mn li od oe mp lm of og mr lq oh oi mt oj bi translated">3.归罪</h2><p id="94d1" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">您可以根据需要用适当的数据替换丢失的值。有很多方法可以做到这一点，看看哪种方法最适合你的目标。</p><pre class="kj kk kl km gt ok nd ol om aw on bi"><span id="8d7f" class="ny me it nd b gy oo op l oq or"># replace all na values with -9999<br/>df.fillna(-9999)</span><span id="31fa" class="ny me it nd b gy os op l oq or"># fill na values with NaN<br/>df.fillna(np.NaN)</span><span id="3603" class="ny me it nd b gy os op l oq or"># fill na values with strings<br/>df.fillna("data missing")</span><span id="7573" class="ny me it nd b gy os op l oq or"># fill na values with mean of columns<br/>df.fillna(df.mean())</span><span id="a573" class="ny me it nd b gy os op l oq or"># replace na values with mean value of specific columns<br/>df["col1"] = df["col1"].fillna(df.mean)</span></pre><h2 id="c232" class="ny me it bd mf nz oa dn mj ob oc dp mn li od oe mp lm of og mr lq oh oi mt oj bi translated">4.插入</h2><p id="cb6e" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">如果是时间序列数据，你可以插值或使用移动平均。</p><pre class="kj kk kl km gt ok nd ol om aw on bi"><span id="cb71" class="ny me it nd b gy oo op l oq or"># interpolation of missing values of all columns<br/>df.interpolate()</span><span id="c816" class="ny me it nd b gy os op l oq or"># interpolation of missing values of specific columns<br/>df["col"] = df["col"].interpolate()</span><span id="d88a" class="ny me it nd b gy os op l oq or"># using moving average or rolling window<br/>df['col'] = df['col'].rolling(window = 5).mean</span></pre></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><h2 id="c922" class="ny me it bd mf nz oa dn mj ob oc dp mn li od oe mp lm of og mr lq oh oi mt oj bi translated"><strong class="ak">最终想法</strong></h2><p id="4d7a" class="pw-post-body-paragraph kz la it lb b lc mv ju le lf mw jx lh li mx lk ll lm my lo lp lq mz ls lt lu im bi translated">在这篇文章中，我总结了丢失数据的来源，它们引起的问题以及消除/处理它们的方法。一些统计软件包会在执行统计分析之前自动消除缺失数据，但这并不总是最好的选择。作为一名数据科学家，您需要更好地处理如何处理缺失的观察值，我在本文中强调了一些行业最佳实践。</p></div></div>    
</body>
</html>