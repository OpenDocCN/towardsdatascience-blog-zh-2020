<html>
<head>
<title>Can Ronaldo Score a Goal? Let us find out using an AI!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">c罗能进球吗？让我们使用人工智能来找出答案！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/can-ronaldo-score-a-goal-let-us-find-out-using-an-ai-b6fc3364f0c5?source=collection_archive---------60-----------------------#2020-05-31">https://towardsdatascience.com/can-ronaldo-score-a-goal-let-us-find-out-using-an-ai-b6fc3364f0c5?source=collection_archive---------60-----------------------#2020-05-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0ac8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在这篇文章中，我将讲述我们如何使用人工智能和机器学习算法来研究和预测克里斯蒂亚诺 <em class="kf">罗纳尔多是否进球。</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/905f5d98f6e4b7216eef032da4357345.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o_izKowQiol_q71jrQE39A.jpeg"/></div></div></figure><h1 id="229e" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated"><strong class="ak">简介</strong></h1><p id="c1f3" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">在观看任何足球比赛时，我们都希望我们支持的球队能够进球。我们耐心地等待，直到我们支持的球队的一名球员足够靠近球门并射门，这似乎是要进球，但遗憾的是没有击中。但是，人工智能可以使用数据分析和机器学习来预测和解释为什么那个球员错过了那个特定位置的投篮吗？在这篇文章中，我们将实验不同的ML算法，并教一个AI预测一个球员是否会进球！</p><p id="fb59" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">机器学习在许多不同的应用中发挥着关键作用，如计算机视觉、数据挖掘、自然语言处理、语音识别等。ML在上述所有领域提供了潜在的解决方案，它肯定会成为我们未来数字文明的驱动力。在这里，我们将看到我们如何使用不同的机器学习算法，并建立一个简单的二进制分类器，该分类器将根据给定的输入数据对目标是否可以得分进行分类。这个项目是作为我参加的黑客马拉松的一部分完成的，这个项目的数据集也是由他们提供的。</p><p id="9ae4" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">在下一节中，我们将回顾不同机器学习算法的一些基本理论，我们将在本文的后面部分尝试编码和应用这些算法。</p><p id="69c7" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">此外，整个项目代码可以在我的Github这里找到—<a class="ae ml" href="https://github.com/rajatkeshri/ZS-HACK-predict-ronaldo-goal" rel="noopener ugc nofollow" target="_blank">https://github.com/rajatkeshri/ZS-HACK-predict-ronaldo-goal</a></p><h1 id="4603" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated"><strong class="ak">有些理论</strong></h1><p id="5e4e" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">现在有很多机器学习算法。在这个项目中，我们将使用分类算法，因为我们在这里将需要预测是否进球得分。这也称为二元分类。</p><p id="f978" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">如果你对机器学习中不同的机器学习算法和分类类型有基本的了解，可以随意跳过理论部分。</p><p id="aa32" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">机器学习中的分类有两种方式——监督和非监督。监督学习涉及给定的数据集以及每个数据点应该产生的输出。该算法学习产生特定输出的模式，并试图在监督下对其进行概括。监督学习基本上包含数据集中要预测的输出标签，并学习如何通过回溯和泛化来预测这些值。无监督学习对数据进行训练，并试图在不知道每个数据点属于哪个类别的情况下盲目地进行归纳。它创建一个模式，并根据其特征概括数据点，并在训练过程中为它们创建输出标签。</p><p id="3474" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">这里，我们将只关注监督学习方法。我们将尝试的一些监督学习方法有——线性回归、逻辑回归、随机森林和神经网络。要了解这些算法是如何工作的，请查看以下链接，这些链接解释得非常清楚，可以让您了解这些算法的工作原理。</p><ol class=""><li id="bcbc" class="mm mn iq lm b ln mg lq mh lt mo lx mp mb mq mf mr ms mt mu bi translated">线性回归—<a class="ae ml" rel="noopener" target="_blank" href="/linear-regression-detailed-view-ea73175f6e86">https://towards data science . com/linear-Regression-detailed-view-ea 73175 F6 e 86</a></li><li id="c85c" class="mm mn iq lm b ln mv lq mw lt mx lx my mb mz mf mr ms mt mu bi translated">逻辑回归—<a class="ae ml" rel="noopener" target="_blank" href="/logistic-regression-detailed-overview-46c4da4303bc">https://towards data science . com/logistic-Regression-detailed-overview-46 C4 da 4303 BC</a></li><li id="8ba8" class="mm mn iq lm b ln mv lq mw lt mx lx my mb mz mf mr ms mt mu bi translated">随机森林—<a class="ae ml" rel="noopener" target="_blank" href="/random-forest-and-its-implementation-71824ced454f">https://towards data science . com/random-Forest-and-its-implementation-71824 ced 454 f</a></li><li id="722d" class="mm mn iq lm b ln mv lq mw lt mx lx my mb mz mf mr ms mt mu bi translated">神经网络—<a class="ae ml" rel="noopener" target="_blank" href="/first-neural-network-for-beginners-explained-with-code-4cfd37e06eaf">https://towards data science . com/first-neural-network-for-初学者-用代码解释-4cfd37e06eaf </a></li></ol><p id="8f99" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">现在让我们开始了解我们预测进球与否的工作和方法。在我们开始任何代码之前，我们应该做的第一件事是彻底检查数据集。我们必须完全理解数据集，并试图从我们将用于训练模型的数据集中找出最重要的特征。采样和提取错误的要素有时可能会导致模型不准确。</p><h1 id="4bcf" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated"><strong class="ak">先决条件</strong></h1><p id="6b7a" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">以下软件包将用于该项目的开发。此外，我们将在这里使用Python 3.6，但任何高于3.6的版本都可以使用。</p><ol class=""><li id="83bb" class="mm mn iq lm b ln mg lq mh lt mo lx mp mb mq mf mr ms mt mu bi translated">Sklearn —机器学习库</li><li id="1a4f" class="mm mn iq lm b ln mv lq mw lt mx lx my mb mz mf mr ms mt mu bi translated">Pandas —用于导入csv文件和解析列的库。</li><li id="37b3" class="mm mn iq lm b ln mv lq mw lt mx lx my mb mz mf mr ms mt mu bi translated">Numpy —用于在数组中存储训练数据的库。Numpy数组最广泛地用于存储训练数据，sklearn库接受numpy数组形式的输入数据。</li></ol><p id="4086" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">如果您的系统中没有任何库，只需pip安装那个特定的库。以下是使用pip的指南—<a class="ae ml" href="https://www.w3schools.com/python/python_pip.asp" rel="noopener ugc nofollow" target="_blank">https://www.w3schools.com/python/python_pip.asp</a></p><p id="4e7b" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">下面的代码片段显示了所有要导入的库。</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="0803" class="nf kt iq nb b gy ng nh l ni nj">import pandas as pd<br/>import numpy as np<br/>import math<br/>import scipy<br/>from sklearn.preprocessing import LabelEncoder, OneHotEncoder<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.linear_model import LinearRegression<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.datasets import load_boston<br/>from sklearn.metrics import mean_squared_error<br/>from scipy.stats import spearmanr<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.preprocessing import scale<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.model_selection import train_test_split<br/>from sklearn import preprocessing<br/>from sklearn import svm<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.neural_network import MLPClassifier</span></pre><h1 id="4be8" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated"><strong class="ak">数据集预处理</strong></h1><p id="ba43" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">这里使用的数据集是一个CSV文件，包含皇家马德里与不同球队进行的不同比赛的信息。数据集包含描述罗纳尔多在不同情况和场景下进球的不同字段，如进球时间、距离球门多远、射门力量、进球角度等。如前所述，这个数据集是在一次黑客马拉松中给我的，我不确定它是否在Kaggle或任何其他网站上公开。不管怎样，数据集都在我的Github链接上，你可以从这里下载——https://github.com/rajatkeshri/ZS-HACK-predict-ronaldo-goal<a class="ae ml" href="https://github.com/rajatkeshri/ZS-HACK-predict-ronaldo-goal" rel="noopener ugc nofollow" target="_blank"/></p><p id="22f4" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">下图显示了数据集的一些列。从数据集中，我们将使用以下各列作为输入数据-位置x、位置y、拍摄功率、拍摄距离、剩余时间和目标列作为输出标注。您也可以使用其他字段来训练模型并进行实验，但是在本文中，我将解释这5个输入字段数据列的用法。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi nk"><img src="../Images/427125e3fddf1423a249b9e9aee80bd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GcPDHwx9aRb8cl-4ojhWbw.png"/></div></div></figure><p id="b3b5" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">我们注意到有许多字段是空的，并且在这个数据集中有许多噪声。我们的第一步是检查数据集，修复有噪声的数据，并删除所有的空字段。</p><p id="cae7" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">现在让我们跳到代码。首先，我们使用pandas打开数据集csv文件，并定义类似输入数据的列和作为训练输出标签的列。这里，列10是“is_goal”列，其作用类似于输出标签，而2、3、4、5、9列分别是输入标签location_x、location_y、remaining_sec、power_of_shot、distance_of_shot。如果您想尝试使用data.csv中的其他要素列来训练您的模型，只需在数组中添加这些列号。</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="b222" class="nf kt iq nb b gy ng nh l ni nj">datasets = pd.read_csv('data.csv')</span><span id="e469" class="nf kt iq nb b gy nl nh l ni nj">output=pd.DataFrame(datasets)<br/>cols = [10]<br/>output = output[output.columns[cols]]</span><span id="6f80" class="nf kt iq nb b gy nl nh l ni nj">df = pd.DataFrame(datasets)<br/>cols = [2,3,4,5,9]<br/>df = df[df.columns[cols]]</span></pre><p id="0956" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">一旦我们从csv文件中读取了特性，我们必须仔细检查并移除这些列中的所有干扰。我们遍历这些特性，检查该列的特定值是否为NAN。如果是NAN，我们就删除整行，去掉所有有噪声的数据。一旦去除了噪声数据，我们将多个列特征的整个二维数组存储在变量X和y中。</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="e19e" class="nf kt iq nb b gy ng nh l ni nj">#Removing rows with Output label not defined<br/>k=0<br/>x=[]<br/>for i in df["is_goal"]:<br/>    if math.isnan(i):<br/>        x.append(k)<br/>        #print(i)<br/>    k+=1<br/>df=(df.drop(x))</span><span id="8691" class="nf kt iq nb b gy nl nh l ni nj">#Removing rows with distance of shot not defined<br/>k=0<br/>x=[]<br/>for i in df["distance_of_shot"]:<br/>    <br/>    if math.isnan(i):<br/>        x.append(df.index[k])<br/>        #print(i)<br/>    k+=1<br/>df=(df.drop(x))</span><span id="8c30" class="nf kt iq nb b gy nl nh l ni nj">#Removing rows with power of shot not defined<br/>k=0<br/>x=[]<br/>for i in df["power_of_shot"]:<br/>    <br/>    if math.isnan(i):<br/>        x.append(df.index[k])<br/>        #print(i)<br/>    k+=1<br/>df=(df.drop(x))</span><span id="ae15" class="nf kt iq nb b gy nl nh l ni nj">#Removing rows with X axis location not defined<br/>k=0<br/>x=[]<br/>for i in df["location_x"]:<br/>    if math.isnan(i):<br/>        x.append(df.index[k])<br/>        #print(i)<br/>    k+=1<br/>df=(df.drop(x))</span><span id="5ac6" class="nf kt iq nb b gy nl nh l ni nj">#Removing rows with Y axis location not defined<br/>k=0<br/>x=[]<br/>for i in df["location_y"]:<br/>    if math.isnan(i):<br/>        x.append(df.index[k])<br/>        #print(i)<br/>    k+=1<br/>df=(df.drop(x))<br/>#print(df)</span><span id="14fa" class="nf kt iq nb b gy nl nh l ni nj">#Removing rows with remaining time not defined<br/>k=0<br/>x=[]<br/>for i in df["remaining_sec"]:<br/>    if math.isnan(i):<br/>        x.append(df.index[k])<br/>        #print(i)<br/>    k+=1<br/>df=(df.drop(x))<br/>#print(df)</span><span id="0fdb" class="nf kt iq nb b gy nl nh l ni nj">X = df.iloc[:, :-1].values<br/>Y = df.iloc[:, 4].values</span></pre><p id="fb5f" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">现在，我们有了干净的数据集，任何行或列都有噪声和空值。我们在这里要做的下一步是将整个数据分解成列车和测试数据。这样做是为了在训练数据上训练我们的模型，然后测试它的准确性和在测试数据上的分数。这将帮助我们理解我们的模型在预测中的地位，从而帮助我们调整模型。</p><p id="2f33" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">在这里，我们使用从sklearn库中导入的函数train_test_split来分割训练和测试数据。随机状态基本上是指用作训练和测试数据的数据的百分比。0.2表示20%。</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="0d2f" class="nf kt iq nb b gy ng nh l ni nj">(X_train, X_test, Y_train, Y_test) = train_test_split(X, Y, random_state=0.2)</span></pre><h1 id="377b" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated"><strong class="ak">训练</strong></h1><p id="c043" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">我们完成了对数据集的理解，并通过一些预处理清理了数据集。剩下的唯一步骤是训练模型。如前所述，我们将使用线性回归、逻辑回归、随机森林回归和神经网络来训练我们的模型。这些算法可以直接在sklearn库中获得，这就是我们将要使用的。</p><p id="e248" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">首先，我们创建不同机器学习算法的对象，然后将带有输出标签的输入特征传递给它们。这些算法基于我们提供给它们的数据进行了推广。为了训练这些模型，我们称之为”。适合”在这些物体上。关于每个机器学习算法类的更多信息，请参考本网站—<a class="ae ml" href="https://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank">https://scikit-learn.org/stable/</a>。</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="19f8" class="nf kt iq nb b gy ng nh l ni nj">LR=LinearRegression()<br/>Lr=LogisticRegression(random_state=0, solver='lbfgs', multi_class='ovr')<br/>RF = RandomForestClassifier(n_estimators=100, max_depth=2, random_state=0)<br/>NN = MLPClassifier(solver='lbfgs', alpha=1e-5, hidden_layer_sizes=(5, 2), random_state=1)</span><span id="221b" class="nf kt iq nb b gy nl nh l ni nj">LR.fit(X_train,Y_train) #linear regression<br/>Lr.fit(X_train,Y_train) #logistic regression<br/>RF.fit(X_train, Y_train) #random forest<br/>NN.fit(X_train, Y_train) #neural network multi-layer perception model</span></pre><p id="d8bd" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">培训完成后，我们会检查不同型号的表现。这可以通过调用。评分”的方法。”的声音。score”方法打印出我们的模型在测试数据上表现的准确性。</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="ae51" class="nf kt iq nb b gy ng nh l ni nj">print(LR.score(X_test,Y_test))<br/>print(Lr.score(X_test,Y_test))<br/>print(RF.score(X_test,Y_test))<br/>print(NN.score(X_test,Y_test))</span></pre><p id="1eee" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">此外，如果我们想检查对测试数据的预测，或者给出新的数据值，并预测是否进球，我们可以使用。预测”的方法。预测方法后产生的输出为1或0，其中1表示“是的，他进球了！”0代表“运气不好，他下次一定会得分”。</p><pre class="kh ki kj kk gt na nb nc nd aw ne bi"><span id="c5b5" class="nf kt iq nb b gy ng nh l ni nj">loc_x = 10<br/>loc_y = 12<br/>remaining_time = 20<br/>distance = 32<br/>power_of_shot = 3<br/>custom_input=[[loc_x,loc_y,remaining_time,power_of_shot,distance]]</span><span id="0e63" class="nf kt iq nb b gy nl nh l ni nj">print(LR.predict(X_test))<br/>print(Lr.predict(X_test))<br/>print(RF.predict(X_test))<br/>print(NN.predict(X_test))</span><span id="af09" class="nf kt iq nb b gy nl nh l ni nj">print(Lr.predict(custom_input))</span></pre><h1 id="ba18" class="ks kt iq bd ku kv kw kx ky kz la lb lc jw ld jx le jz lf ka lg kc lh kd li lj bi translated"><strong class="ak">结果</strong></h1><p id="6597" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">首先，祝贺您，我们成功构建了二元分类模型AI，可以预测罗纳尔多是否能进球。我们观察到这是一个基本的二进制分类问题，逻辑回归以约95%的准确率表现最好，但其他机器学习模型表现良好，准确率约为60-70%。通过在模型的训练中加入更多的特征，这种准确性肯定会得到提高。</p><p id="cf98" class="pw-post-body-paragraph lk ll iq lm b ln mg jr lp lq mh ju ls lt mi lv lw lx mj lz ma mb mk md me mf ij bi translated">谢谢你的时间。希望你喜欢这篇文章。干杯！</p></div></div>    
</body>
</html>