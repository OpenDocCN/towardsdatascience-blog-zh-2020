<html>
<head>
<title>The Practical SQL Guide I wish I had when I started Data Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我希望在开始数据分析时就有实用的 SQL 指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-practical-sql-guide-i-wish-i-had-when-i-started-data-analysis-537c93907268?source=collection_archive---------18-----------------------#2020-09-06">https://towardsdatascience.com/the-practical-sql-guide-i-wish-i-had-when-i-started-data-analysis-537c93907268?source=collection_archive---------18-----------------------#2020-09-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3d256e5d84ede352d8a8ec13abeebb35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xjGBpGjW0XOuG6no"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@aronvisuals?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿伦视觉</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="c3c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">SQL 已经成为各行各业和各种工作岗位的通用技能要求。公司要求他们的数据分析师、数据科学家和产品经理至少熟悉 SQL。这是因为<strong class="kf ir"> SQL 仍然是数据的语言。</strong>因此，为了实现数据驱动，人们需要知道如何访问和分析数据。</p><p id="5714" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我作为一名分析师寻找学习 SQL 的资源并为面试做准备时，所有的网站都有一套非常标准的“员工-薪水”表，其中包含非常基本的查询。虽然我从这些例子中很好地理解了 SQL 的基础知识，但是它没有理解在我们通常处理较大查询的实际环境中哪些概念是最重要的。所以我决定总结一些关键的提示，我希望我在开始我的旅程时就已经强调过了。</p><h2 id="d1cc" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated"><strong class="ak">了解你的基本查询结构</strong></h2><p id="e49d" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">这是最基本也是最重要的提示。无论问题有多复杂，您都应该记住基本结构，并将查询的每个部分分解成这个结构。即使当我处理多个表和连接时，它也总是有助于记住基本结构。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/94b4843c46ee5b22767191bd04e045b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*q2COygjIwpwosWziiO32Lg.png"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">基本 SQL 查询结构</p></figure><h2 id="c1a2" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">了解你的等级和分区</h2><p id="1bd2" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">在我做分析师的这些年里，接受几次采访是最常用的功能之一。这用于根据特定值对行进行排序，并按其他属性进行分区，或者查找聚合函数的滚动值。</p><p id="cd94" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当您需要所有行的唯一等级时，务必使用 row_number 而不是 rank/dense_rank。(3 种类型在秩函数上的区别是一个常见的面试问题。<a class="ae kc" href="https://www.codeproject.com/Tips/823497/What-is-the-Difference-between-ROW-NUMBER-RANK-and" rel="noopener ugc nofollow" target="_blank">这里</a>是一个很好的总结，供参考。)</p><p id="ee56" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些功能可以帮助我们解决多个问题，例如:</p><p id="2738" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mi">查找特定过滤器中的最新条目— </em></p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="bd5c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mi">查找累计金额— </em></p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="6fb1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mi">从表格中删除重复行- </em></p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="4d0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以及更多我可能还没有遇到的问题。</p><h2 id="129f" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">使用时间和弦</h2><p id="dc64" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">我用过的最常见的过滤器通常是基于时间和字符串的。这里有一些操纵时间的重要函数</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="mj mk l"/></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">重要的日期函数</p></figure><p id="8960" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于 string，你应该熟悉<code class="fe me mf mg mh b">LIKE</code>函数中使用的所有条件来识别模式。你可以参考一个完整的列表，但是总结一下，<code class="fe me mf mg mh b">%</code>用来表示任意数量的字符，而<code class="fe me mf mg mh b">_</code>用来表示单个字符。<code class="fe me mf mg mh b">[]</code>可在 SQL Server 中用于检查多个字符。例如，在一列<code class="fe me mf mg mh b">name</code>中查找名字，其中第二个字符有一个元音，最后一个字符是“t”</p><p id="5ccf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe me mf mg mh b">SELECT name from Table WHERE lower(name) <strong class="kf ir">LIKE '_[aeiou]%t'</strong></code></p><p id="2088" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个额外的提示，如果你把结果导出为。csv 始终记得删除所有字符串列中的逗号，以确保文件的格式正确。使用<code class="fe me mf mg mh b">regexp_replace(column_name, ’,’ , ’’) as column_name</code>删除列中的逗号。</p><h2 id="537f" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">熟悉连接并使用正确的格式</h2><p id="76e1" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">不幸的是，您几乎不会只处理一个表，大多数查询都有许多子查询和连接。所以你必须总是把你给定的问题分解成更简单的查询，然后解决问题。在这种情况下，连接的基本知识非常重要。(也是很常见的面试问题)。</p><p id="d2d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我使用的最常见的连接是左连接，这是我们需要保留第一个表中的所有数据，不管我们是否在第二个表中找到匹配。让我们在下一节的例子中看到这一点。</p><p id="7412" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，当处理多个表时，具有适当缩进的代码格式是最重要的。写任何代码时都要记住这一点——如果我把它交给第三个人，理解起来会有多容易。</p><h2 id="e4e4" class="lb lc iq bd ld le lf dn lg lh li dp lj ko lk ll lm ks ln lo lp kw lq lr ls lt bi translated">过滤计数和总和输出的用例</h2><p id="4dce" class="pw-post-body-paragraph kd ke iq kf b kg lu ki kj kk lv km kn ko lw kq kr ks lx ku kv kw ly ky kz la ij bi translated">你可以在过滤输出时使用 case，就像在 Excel 中使用 count if 一样。</p><p id="1038" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">(另一个常见的面试问题是<code class="fe me mf mg mh b">count(*)</code> <em class="mi">的区别，它返回 null 和非 null 的行数</em> <code class="fe me mf mg mh b">vs count(1)</code> <em class="mi">将计算所有的行，因为表达式“1”对于每一行都计算为非 null</em><code class="fe me mf mg mh b"> vs count(column_name) </code><em class="mi">对于给定的列</em>计算具有非 null 值的行)</p><p id="6b5d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们在下面的查询中看到这一切，我们将尝试找出阿姆斯特丹取消最多的顶级优步司机，并查看他们的登录时间和完成的骑行。我们将把包含所有已登录司机详细信息的登录时间表与包含所有状态为“成功完成”、“提前完成”、“被客户取消”或“被司机取消”的预订的预订表连接起来。</p><figure class="ma mb mc md gt jr"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="be49" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望这个指南能帮助你在编写 SQL 查询时变得更加自信，并解决你作为一名分析师甚至是一名受访者所面临的下一个问题。</p><p id="5509" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢阅读。</p></div></div>    
</body>
</html>