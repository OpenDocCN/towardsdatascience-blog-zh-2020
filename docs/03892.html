<html>
<head>
<title>RESTful APIs in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中的 RESTful APIs</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/restful-apis-in-python-121d3763a0e4?source=collection_archive---------5-----------------------#2020-04-11">https://towardsdatascience.com/restful-apis-in-python-121d3763a0e4?source=collection_archive---------5-----------------------#2020-04-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="3608" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">什么是 RESTful APIs 和在 Python 中实现 GET</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/21ec862151871b8b407f3b40f3881c86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0VJwgYFPRrrXBy5Pnp_DIQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@sincerelymedia?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">真诚媒体</a>在<a class="ae ky" href="https://unsplash.com/s/photos/rest?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="d155" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">API 是两个软件之间的假想契约。Web APIs 使得跨语言应用程序能够很好地工作。</p><p id="d146" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">应用程序编程接口通常用于从远程网站检索数据。为了向远程 web 服务器发出请求并检索数据，我们使用了提供 API 的 URL 端点。每个 URL 被称为一个<strong class="lb iu">请求</strong>，被发回的数据被称为一个<strong class="lb iu">响应</strong>。</p><p id="d10d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">RESTful API 是一个应用程序接口，它使用<em class="lv"> HTTP 请求</em>来获取、上传、发布和删除数据。基于 REST 的交互使用熟悉 HTTP 的任何人都熟悉的约束。并且交互使用标准的 HTTP 状态代码来传达它们的状态。</p><h1 id="9fd1" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">为什么使用 API 而不是可以下载的静态数据集？</h1><ol class=""><li id="d15f" class="mo mp it lb b lc mq lf mr li ms lm mt lq mu lu mv mw mx my bi translated">数据是不断变化的</li><li id="5d78" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu mv mw mx my bi translated">您想要更大的数据池中的一小部分</li></ol></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="c4fe" class="lw lx it bd ly lz nl mb mc md nm mf mg jz nn ka mi kc no kd mk kf np kg mm mn bi translated">API 请求</h1><p id="6c7b" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">API 托管在 web 服务器上。</p><p id="5f3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我们在浏览器的地址栏中键入<em class="lv">www.google.com</em>时，计算机实际上是在向<em class="lv">www.google.com</em>服务器请求一个网页，然后它将这个网页返回给浏览器。</p><p id="1385" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">API 的工作方式非常相似，除了不是网络浏览器请求网页，而是程序请求数据。</p><p id="c238" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这些数据以 JSON 格式返回。</p><p id="848c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了获得数据，我们向 web 服务器发出请求。然后，服务器用数据进行回复。在 Python 中，我们利用<code class="fe nt nu nv nw b">requests</code>库来做这件事。</p><h1 id="7dcf" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">“请求”</h1><p id="1f70" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">最常用的请求是 GET 请求，用于检索数据。GET 请求将是本文的重点。</p><h2 id="bde7" class="nx lx it bd ly ny nz dn mc oa ob dp mg li oc od mi lm oe of mk lq og oh mm oi bi translated">端点/路由</h2><p id="044e" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">根端点是我们请求的 API 的起点。它完成了确定被请求的资源的路径。例如-<a class="ae ky" href="https://www.google.com/maps" rel="noopener ugc nofollow" target="_blank">https://www.google.com/maps</a>。<br/><strong class="lb iu"><em class="lv">/地图</em> </strong>是终点，<strong class="lb iu"><em class="lv"/></strong>是起始网址。</p><h2 id="7b11" class="nx lx it bd ly ny nz dn mc oa ob dp mg li oc od mi lm oe of mk lq og oh mm oi bi translated">方法</h2><ul class=""><li id="e3a3" class="mo mp it lb b lc mq lf mr li ms lm mt lq mu lu oj mw mx my bi translated">获取—从服务器获取资源。</li><li id="ed4e" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu oj mw mx my bi translated">POST —在服务器上创建新资源。</li><li id="c5a1" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu oj mw mx my bi translated">上传、修补—更新服务器上的请求。</li><li id="39c8" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu oj mw mx my bi translated">删除—从服务器中删除资源。</li></ul><h2 id="5d4d" class="nx lx it bd ly ny nz dn mc oa ob dp mg li oc od mi lm oe of mk lq og oh mm oi bi translated">状态代码</h2><ul class=""><li id="4c12" class="mo mp it lb b lc mq lf mr li ms lm mt lq mu lu oj mw mx my bi translated"><strong class="lb iu"> 1xx:信息:</strong>传达传输协议级信息。</li><li id="6557" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu oj mw mx my bi translated"><strong class="lb iu"> 2xx:成功:</strong>客户的请求被成功接受。</li><li id="3bc5" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu oj mw mx my bi translated"><strong class="lb iu"> 3xx:重定向:</strong>客户端必须采取一些额外的动作来完成它们的请求。</li><li id="39ce" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu oj mw mx my bi translated"><strong class="lb iu"> 4xx:客户端错误:</strong>客户端错误。</li><li id="2834" class="mo mp it lb b lc mz lf na li nb lm nc lq nd lu oj mw mx my bi translated"><strong class="lb iu"> 5xx:服务器错误:</strong>服务器端错误。</li></ul><h2 id="1df9" class="nx lx it bd ly ny nz dn mc oa ob dp mg li oc od mi lm oe of mk lq og oh mm oi bi translated"><strong class="ak"> JSON 数据</strong></h2><p id="6d25" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">JSON 是数据在 API 之间来回传递的主要格式，大多数 API 服务器将以 JSON 格式发送响应——包含一个 JSON 对象的单个字符串。</p><p id="4d18" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">JSON 是一种将列表和字典等数据结构编码成字符串的方法，以确保它们易于被机器读取。</p><p id="d089" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，列表和字典可以转换成 JSON，字符串可以转换成列表和字典。</p><p id="ae5f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">JSON 看起来很像 Python 中的字典，存储了键值对。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="9447" class="lw lx it bd ly lz nl mb mc md nm mf mg jz nn ka mi kc no kd mk kf np kg mm mn bi translated">进入 Python</h1><p id="3d8c" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">我们将实现一个单一案例场景，它弥补了大多数 GET 请求的场景。</p><h2 id="17bc" class="nx lx it bd ly ny nz dn mc oa ob dp mg li oc od mi lm oe of mk lq og oh mm oi bi translated">进口货</h2><pre class="kj kk kl km gt ok nw ol om aw on bi"><span id="b9d8" class="nx lx it nw b gy oo op l oq or">import json<br/>import requests<br/>import urllib.parse</span></pre><p id="5615" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一些 GET 请求由端点组成，这些端点具有不可选的路径参数，并且是端点的一部分，例如-<strong class="lb iu"><em class="lv">/volunteer/{ volunteerID }/badge/{ badgeID }</em></strong></p><p id="ab99" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="lv">需要将 volunteerID </em>和<em class="lv"> badgeID </em>传入完整的 URL，以完成 GET 请求。</p><p id="3614" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是我们利用<code class="fe nt nu nv nw b">urllib.parse</code>的地方。</p><p id="672e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我们在一个 JSON 文件中有一个 volunteerIDs 和 badgeIDs 的列表，我们希望将它输入到端点中，调用 API 并获得结果信息。</p><pre class="kj kk kl km gt ok nw ol om aw on bi"><span id="4969" class="nx lx it nw b gy oo op l oq or"><strong class="nw iu">#reading in the JSON file</strong><br/>with open(‘volunteer_data.json’, ‘r’) as text_file_input:<br/>    data=text_file_input.read()</span><span id="ccfa" class="nx lx it nw b gy os op l oq or"><strong class="nw iu">#loading that file as a JSON object</strong><br/>obj = json.loads(data)</span></pre><p id="dd4c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一步是设置 URL。</p><pre class="kj kk kl km gt ok nw ol om aw on bi"><span id="4ddc" class="nx lx it nw b gy oo op l oq or">API_ENDPOINT = ‘https://registeredvolunteers.xyz.com/volunteer/{}/badge/{}'</span></pre><p id="7ef9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，让我们运行一个<code class="fe nt nu nv nw b">for</code>循环来调用 API。</p><pre class="kj kk kl km gt ok nw ol om aw on bi"><span id="da2c" class="nx lx it nw b gy oo op l oq or"><strong class="nw iu">#we pass on the arguments volunteerID and badgeID </strong><br/>for i in obj:<br/>     r=requests.get(API_ENDPOINT.format(urllib.parse.quote(<br/>i[‘volunteerID’]),<br/>i[‘badgeID’])<br/>)<br/>     print(r.text)</span><span id="da45" class="nx lx it nw b gy os op l oq or"><strong class="nw iu">#outside for loop</strong><br/>text_file_input.close()</span></pre><p id="49bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，如果你期待一个 JSON 输出，<code class="fe nt nu nv nw b">r.text</code>会给你一个由 JSON 对象组成的字符串。为了从中提取 JSON 对象，我们:</p><pre class="kj kk kl km gt ok nw ol om aw on bi"><span id="e474" class="nx lx it nw b gy oo op l oq or">output_json = json.loads(r.text)</span><span id="40ff" class="nx lx it nw b gy os op l oq or"><strong class="nw iu">#or directly use<br/></strong>r.json()</span></pre><p id="395b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">要获得请求的状态代码和状态代码的原因，</p><pre class="kj kk kl km gt ok nw ol om aw on bi"><span id="50f3" class="nx lx it nw b gy oo op l oq or">r.status_code<br/>r.reason</span></pre><h1 id="11c9" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">最终意见</h1><p id="71d7" class="pw-post-body-paragraph kz la it lb b lc mq ju le lf mr jx lh li nq lk ll lm nr lo lp lq ns ls lt lu im bi translated">上面的场景涵盖了 GET 请求的不同情况——是否需要传递 URL 参数，以及传入的这些参数是否存储在文件中；以及 GET 请求的不同属性，您可以研究这些属性来理解接收到的数据。</p><p id="dc6e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">获得 REST APIs 的领先优势！</p></div></div>    
</body>
</html>