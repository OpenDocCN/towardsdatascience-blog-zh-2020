<html>
<head>
<title>Data Modeling and Predictions with Newborn Baby</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">新生婴儿的数据建模和预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-modeling-and-predictions-with-newborn-baby-26ebbb5f3506?source=collection_archive---------21-----------------------#2020-01-14">https://towardsdatascience.com/data-modeling-and-predictions-with-newborn-baby-26ebbb5f3506?source=collection_archive---------21-----------------------#2020-01-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5397" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">请阅读我在产假期间与我的新生儿一起探索数据建模的经历</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/bed0c66f33d3befa4b97f72b95b7a3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7SgGPOeSn9uOKZKL2N2SCg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@thedakotacorbin?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">达科他·科尔宾</a>在<a class="ae ky" href="https://unsplash.com/s/photos/mother-child?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><p id="07d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">机器学习面临的挑战之一是处理数据。人们常说，数据建模是 90%的数据收集/清理和 10%的模型构建。因此，收集能够提供丰富见解的正确数据是一个巨大的难题。</p><p id="d154" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在我生孩子的前几周，我和一个朋友聊了聊我在休产假期间可以做的一些科技项目。毕竟，我要生孩子了，我可以收集她周围的大量数据！！我们认为的一些想法是:</p><p id="15ea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在一段时间内拍摄婴儿指纹的快照，并分析它们是否以及如何变化</p><p id="dd58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">收集不同婴儿哭声的音频剪辑，并使用机器学习模型对不同哭声的含义进行分类。</p><p id="0f19" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">嗯，这两个想法对我来说都失败了。我简直不能正确地提取我孩子的指纹。每次她哭的时候，录音剪辑就更难了。</p><p id="15aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个想法是用一个预测模型来找到她大便和小便的模式。我开始收集出生后几周内的尿布数据。然而，我意识到大便和小便的模式每周都在变化，这取决于婴儿摄入的母乳和配方奶的量。随着年龄的增长，情况也在发生变化。当我问医生不准确的原因时，她大声说道:“很明显，她的便便周期会改变。会有一些天她完全不便便，没什么好惊讶的”。我意识到很难对这么小的婴儿的便便频率进行预测分析。我的想法泡汤了！</p><p id="76a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我意识到仅仅是我孩子的数据不足以做出任何预测。在网上搜索时，我发现了一个新生儿体重的数据集。数据集包含婴儿的特征，如出生日期、性别、出生时间等，以及关于怀孕的数据点，如产前、生母的医疗状况，如妊娠糖尿病、贫血等，以及父母的病史，包括数据点，如种族、出生子女数、饮酒和吸烟习惯。总的来说，数据集[1]有 131422 个数据点，我觉得对于一个预测模型来说足够了。目标是根据怀孕周预测婴儿的出生体重。这是一个重要的目标，因为分娩时的大尺寸婴儿可能会增加新生儿及其母亲受伤的风险[2]。因此，医生对出生体重的预测越准确，分娩就越容易。</p><p id="74ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然超声波是医生预测婴儿体重的常用方法，但他们往往会有 10-15%的差异。我决定使用机器学习来预测出生体重。</p><h2 id="0267" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">第一步:准备工作空间</strong></h2><p id="7659" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我从 kaggle 链接导入了所需的库并加载了数据集“baby-weights-dataset2.csv”。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/cda98777e84d51294294fed21b5e01ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RxzKmQVR537X0b-gv2Eblw.png"/></div></div></figure><h2 id="1e6d" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">第二步:数据探索</strong></h2><p id="a160" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">这一步有助于我们理解目标可变出生体重——其平均值、标准偏差、最小值和最大值、中值等。我们还绘制了出生体重变量的直方图，以了解其性质。我们还计算目标变量的偏斜度和峰度</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/b4bf15640ee18216481d6b038cc50975.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1jk0odZWjnjdX-AIeeaMPg.png"/></div></div></figure><p id="ccea" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，我们从训练数据集中识别分类值，并打印定性和定量列。此时，我们处理缺失的值，并将它们设置为“缺失”。我们还采用定性变量 HISPMOM 和 HISPDAD 并对其进行编码。</p><p id="af9c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们使用 Spearman 的等级相关性来寻找变量之间的相关性，并在 Correlated_Feature 列表中选取最相关的特征，并将其用于进一步的建模。一些最相关的特征是妊娠完成周数、母亲体重增加量、母亲年龄、父母种族和产前检查次数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/881d182081cc779439dbc7031e794b22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cn1swhXGboTBFpyRWUYhxw.png"/></div></div></figure><h2 id="68a9" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">第三步:测试和训练集</strong></h2><p id="2643" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">接下来，我们使用下面的代码将 80%的数据分割成训练集，而将 20%的数据分割成测试集。test_size 变量是我们实际指定测试集比例的地方。</p><p id="0fff" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这里，“训练”集是用于创建机器学习模型的数据文件，而“测试”集是我们使用模型来预测目标变量的数据文件。ATrain 和 ATest 分割相关特征，而 BTrain 和 BTest 分割出生体重变量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/ba491268268c3aff6708d75c8fcaa4aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TpC-noCH0YaSq2VJHgSH9w.png"/></div></div></figure><p id="44f0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我们将归一化技术应用于我们的训练和测试特征数据集。</p><h2 id="919f" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">第四步:模型创建</strong></h2><p id="5251" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">把数据拆分成训练集和测试集之后，最后，就是训练我们算法的时候了。为此，我们需要设置种子并使用θ来计算预测值并改进模型。这一步也可以使用 scikit 学习线性回归库</p><p id="0639" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mx">模型公式:</em></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/fd332b8fb08baaa7918d1fbbc6eb812f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bbSnwi6U7c2zgWfmEsy91A.png"/></div></div></figure><h2 id="6346" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">第五步:预测出生体重</strong></h2><p id="0003" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">最后，让我们使用我们在步骤 4 中拟合的回归模型，使用该模型来预测每个测试数据集的出生体重目标变量。我使用误差函数检验了模型的表现:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mz"><img src="../Images/844dca3252308d9ad5c24107add5c098.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XHot9PggMBROR9SaTMfADA.png"/></div></div></figure><p id="5199" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我用平均 RMSE 和标准差来评估线性模型。RMSE 是更受欢迎的指标，通常与标准差一起用作解释模型的主要指标。</p><p id="b1d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">平均 RMSE 在 1.07 左右，我觉得对这个数据集来说已经不错了。此外，标准偏差约为 2.64，可通过进一步调整特性来改善。虽然仍然有一些足够好的误差，这些出生体重预测可能有助于医生在分娩过程中更准确地估计婴儿的大小。</p><p id="384a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">当我休完产假回到办公室时，我期待着分享这一模式的见解。</p><blockquote class="na nb nc"><p id="2426" class="kz la mx lb b lc ld ju le lf lg jx lh nd lj lk ll ne ln lo lp nf lr ls lt lu im bi translated">这个模型的代码和数据文件被添加到这个<a class="ae ky" href="https://github.com/sasthan/BabyWeightPrediction" rel="noopener ugc nofollow" target="_blank"> Github 库</a>中。如果你觉得这有用，请与你的朋友和同事分享。欢迎在评论区分享你的想法和反馈。</p></blockquote><p id="7184" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">参考资料:</p><ol class=""><li id="86e8" class="ng nh it lb b lc ld lf lg li ni lm nj lq nk lu nl nm nn no bi translated"><a class="ae ky" href="https://www.kaggle.com/c/csci-ml-s19-pa1/overview" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/c/csci-ml-s19-pa1/overview</a></li><li id="4237" class="ng nh it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated"><a class="ae ky" href="https://www.webmd.com/g00/baby/news/20020926/you-can-predict-your-newborns-weight?i10c.ua=1&amp;i10c.encReferrer=aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS8%3d&amp;i10c.dv=1" rel="noopener ugc nofollow" target="_blank">https://www . webmd . com/g00/baby/news/2002 09 26/you-can-predict-your-新生儿-体重？i10c . ua = 1&amp;i10c . encreferrer = ahr 0 CHM 6 ly 93d 3c uz 29 vz 2 xllmnvbs 8% 3d&amp;i10c . dv = 1</a></li></ol></div></div>    
</body>
</html>