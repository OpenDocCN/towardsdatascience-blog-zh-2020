<html>
<head>
<title>Visualizing Worldwide COVID-19 data using Python Plotly Maps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python Plotly地图可视化全球新冠肺炎数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/visualizing-worldwide-covid-19-data-using-python-plotly-maps-c0fba09a1b37?source=collection_archive---------18-----------------------#2020-04-15">https://towardsdatascience.com/visualizing-worldwide-covid-19-data-using-python-plotly-maps-c0fba09a1b37?source=collection_archive---------18-----------------------#2020-04-15</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><figure class="gm go js jt ju jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj jr"><img src="../Images/f87119b5f1da8ec595f3c27a8f9d2b82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Koc2tIT6j9_Hpi0yKO0KcQ.jpeg"/></div></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">埃德温·胡珀在<a class="ae kg" href="https://unsplash.com/s/photos/coronavirus?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="cdea" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv"> <em class="lf">编者按:</em> </strong> <em class="lf"> </em> <a class="ae kg" href="http://towardsdatascience.com/" rel="noopener" target="_blank"> <em class="lf">走向数据科学</em> </a> <em class="lf">是一份以数据科学和机器学习研究为主的中型刊物。我们不是健康专家或流行病学家，本文的观点不应被解释为专业建议。想了解更多关于疫情冠状病毒的信息，可以点击</em> <a class="ae kg" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports" rel="noopener ugc nofollow" target="_blank"> <em class="lf">这里</em> </a> <em class="lf">。</em></p></div><div class="ab cl lg lh hy li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="in io ip iq ir"><p id="10b5" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">2019年12月31日，世界卫生组织(世卫组织)驻中国国家办事处首次报告了一种未知的肺炎类型疾病。这种未知的疾病后来在2020年2月11日被命名为<strong class="kj iv">新冠肺炎</strong>，因为它与导致2003年SARS爆发的冠状病毒有遗传关系。新冠肺炎很快在世界范围内广泛传播，直到世卫组织于2020年1月30日宣布该疫情为国际关注的突发公共卫生事件。</p><p id="6d1d" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">在这篇文章中，我将介绍使用<a class="ae kg" href="https://plotly.com/python/" rel="noopener ugc nofollow" target="_blank"> <strong class="kj iv"> Python Plotly库</strong> </a>绘制地图的两种方法，以显示新冠肺炎病例在世界各地的分布。</p></div><div class="ab cl lg lh hy li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="in io ip iq ir"><h1 id="0169" class="ln lo iu bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">你需要什么</h1><h2 id="821e" class="ml lo iu bd lp mm mn dn lt mo mp dp lx ks mq mr mb kw ms mt mf la mu mv mj mw bi translated">先决条件Python库</h2><p id="a498" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated">python Plotly—<a class="ae kg" href="https://plotly.com/python/" rel="noopener ugc nofollow" target="_blank">https://plotly.com/python/</a></p><p id="7c4b" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">蟒蛇熊猫—<a class="ae kg" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">https://pandas.pydata.org/</a></p><p id="1d8d" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv"> <em class="lf">安装指南可以在官方网页上找到。</em> </strong></p><h2 id="befa" class="ml lo iu bd lp mm mn dn lt mo mp dp lx ks mq mr mb kw ms mt mf la mu mv mj mw bi translated"><strong class="ak">数据集</strong></h2><p id="9f25" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated"><a class="ae kg" href="https://www.kaggle.com/sudalairajkumar/novel-corona-virus-2019-dataset" rel="noopener ugc nofollow" target="_blank">新型冠状病毒数据集</a></p></div><div class="ab cl lg lh hy li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="in io ip iq ir"><h1 id="d717" class="ln lo iu bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">第1部分:地图上的散点图</h1><p id="1b0d" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated">在本节中，我们将使用来自plotly库的<em class="lf"> plotly.graph_objects </em>在世界地图上创建一个散点图，以显示新冠肺炎确诊病例在世界各地的分布。</p><h2 id="30a9" class="ml lo iu bd lp mm mn dn lt mo mp dp lx ks mq mr mb kw ms mt mf la mu mv mj mw bi translated">步骤1:探索新的冠状病毒数据集</h2><figure class="nc nd ne nf gu jv"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">探索新冠肺炎数据集的Python代码</p></figure><p id="1c00" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">代码解释</strong></p><p id="dd62" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第1–2行:</strong>导入熊猫和Plotly库</p><p id="a96c" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第3行:</strong>世界范围内的新冠肺炎数据可以在<a class="ae kg" href="https://www.kaggle.com/sudalairajkumar/novel-corona-virus-2019-dataset" rel="noopener ugc nofollow" target="_blank"> <em class="lf">小说电晕病毒数据集</em> </a> <strong class="kj iv"> <em class="lf">的一个CSV文件中找到。</em> </strong>我们可以使用熊猫<em class="lf"> read_csv </em>方法来读取文件。</p><p id="563e" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第4行</strong>:使用Pandas <em class="lf"> head </em>方法显示前5行记录。</p><figure class="nc nd ne nf gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj ni"><img src="../Images/d38b83294c25c87c47986262d47bb46c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oZnwAIzev_KWKO-OSDVHPQ.jpeg"/></div></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">数据集记录的前五行</p></figure><p id="4256" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">从上面的结果中，我们可以观察到数据集包括从2020年1月22日到2020年4月13日(截至本文撰写时)每个国家报告的新冠肺炎病例数。该数据集每天都会更新。不幸的是，数据集中缺少省/州的详细信息。我们可以看到在<em class="lf">省/州</em>列中有很多NaN值。</p><p id="987c" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">为了简化我们操作列和绘制地图的后续任务，建议简化一些列名(如国家/地区)。</p><figure class="nc nd ne nf gu jv"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">Python代码重命名列</p></figure><p id="7d0b" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">代码解释</strong></p><p id="5f2f" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第5行</strong>:我们可以使用熊猫<em class="lf">重命名</em>的方法，将列名“国家/地区”改为“国家”，“省/州”改为“省”。</p><p id="1e4a" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第6行</strong>:重命名列后，我们使用熊猫头<em class="lf">方法再次查看记录。</em></p><figure class="nc nd ne nf gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj nj"><img src="../Images/dda04ca6db4bb9cf95003aadf30b2df9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d-01vOdzvCFfqXaPlTC-6g.jpeg"/></div></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">重命名的列</p></figure><h2 id="7a69" class="ml lo iu bd lp mm mn dn lt mo mp dp lx ks mq mr mb kw ms mt mf la mu mv mj mw bi translated">步骤2:在地图上创建散点图</h2><p id="62f6" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated">我们现在可以继续使用Python Plotly库，使用<strong class="kj iv"><em class="lf">Plotly . graph _ objects</em></strong>在地图上创建散点图。</p><figure class="nc nd ne nf gu jv"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">用于在地图上创建散点图的Python代码</p></figure><p id="b5d8" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">这些代码(第8 - 39行)一开始看起来让人望而生畏。不要担心，它们只是我们需要为地图设置的参数，关于这些参数的信息可以在<a class="ae kg" href="https://plotly.com/python/reference/#scattergeo" rel="noopener ugc nofollow" target="_blank"> Plotly参考页面</a>中找到。这里我只讨论几个重要的参数。</p><p id="0226" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">代码解释</strong></p><p id="46ad" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第8行</strong>:设置将出现在数据点上的文本元素。这意味着当我们将鼠标悬停在地图上的数据点上时，预定义的文本(例如，国家名称+20年4月4日的病例数)将会弹出。</p><p id="fba0" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">Line 10–11</strong>:<em class="lf">lon</em>和<em class="lf"> lat </em>是我们为地图上每个数据点设置的经纬度参数。</p><p id="8f67" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第14–23行</strong> : <em class="lf">标记</em>是地图上数据点的表示。这里我们将符号(第19行)设置为<em class="lf">正方形</em>。这将在地图上将每个数据点呈现为一个正方形。我们可以将<em class="lf"> reversescale </em>和<em class="lf"> autocolorscale </em>保留为True，以使标记的颜色根据报告的新冠肺炎病例数自动改变。</p><p id="13e2" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第24–26行</strong> : <em class="lf"> cmin </em>和<em class="lf"> cmax </em>是数据点色域的下限和上限。</p><p id="51dc" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第31–37行</strong>:这是我们为整个地图设置参数值的部分，比如地图<em class="lf">标题</em>(第32行)，更重要的是<em class="lf">范围</em>(第34行)。如果我们打算在地图上显示世界范围的数据，我们需要将范围设置为“world ”, Plotly将生成一个世界地图。如果我们的目的只是只显示美国的数据点，我们可以将范围设置为“美国”。我们可以选择以下范围选项之一:</p><ul class=""><li id="444c" class="nk nl iu kj b kk kl ko kp ks nm kw nn la no le np nq nr ns bi translated">世界</li><li id="db31" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le np nq nr ns bi translated">美国</li><li id="6fda" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le np nq nr ns bi translated">欧洲</li><li id="1f60" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le np nq nr ns bi translated">非洲</li><li id="2913" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le np nq nr ns bi translated">北美洲</li><li id="4919" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le np nq nr ns bi translated">南美洲</li></ul><p id="651f" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第39行</strong> : <em class="lf"> fig.write_html </em>将生成一个显示散点图的html页面。</p><p id="b1e9" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv"> <em class="lf">注</em> </strong> : <em class="lf">可以在Jupyter笔记本或Jupyter Lab上显示地图，而不是在单独的HTML页面上。为此，我们必须为我们的Jupyter笔记本/ Jupyter实验室安装一个扩展(</em><a class="ae kg" href="https://plotly.com/python/getting-started/" rel="noopener ugc nofollow" target="_blank"><em class="lf">【https://plotly.com/python/getting-started/】</em></a><em class="lf">)。</em></p><figure class="nc nd ne nf gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj ny"><img src="../Images/f7219439432f0f264a106849e9d9f889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_EHIAL_k1JjCsglXlVD-1g.jpeg"/></div></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">地图上的散布图</p></figure><p id="ec54" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">上面的散点图让我们大致了解了2020年4月13日世界各地报告的新冠肺炎病例。与深色标记相比，黄色标记反映的报告病例相对较少。从地图上，我们可以看到美国是报告病例最多的国家，其次是欧洲的一些国家，如意大利、英国、法国等。当我们将鼠标悬停在地图上的一个数据点上时，我们可以看到一个预定义的弹出文本，显示与该数据点相关的国家名称和已报告病例数。</p><figure class="nc nd ne nf gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj nz"><img src="../Images/46fc059b260975659451434e1efd5665.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LAxHLK27djy3KDSKexdUMw.jpeg"/></div></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">弹出信息</p></figure></div><div class="ab cl lg lh hy li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="in io ip iq ir"><h1 id="9e17" class="ln lo iu bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">第2部分:Choropleth地图</h1><p id="5e2a" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated">我们也可以使用同一个数据集，通过<em class="lf"> plotly.graph_objects绘制choropleth图。</em>但是，我们需要对数据进行预处理，然后才能创建choropleth图。</p><h2 id="f1fb" class="ml lo iu bd lp mm mn dn lt mo mp dp lx ks mq mr mb kw ms mt mf la mu mv mj mw bi translated"><strong class="ak">第一步:数据预处理</strong></h2><p id="1b93" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated">为了创建choropleth图，我们需要从我们的数据集中获得两条信息:</p><ol class=""><li id="67d4" class="nk nl iu kj b kk kl ko kp ks nm kw nn la no le oa nq nr ns bi translated">独特的国家列表</li><li id="4b79" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le oa nq nr ns bi translated">每个国家报告的新冠肺炎病例总数(2020年4月13日)</li></ol><p id="9f5b" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">不幸的是，我们无法从原始数据集中直接提取出这两条所需的信息。通过预览一些记录，再次仔细查看我们的数据集。</p><figure class="nc nd ne nf gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj ob"><img src="../Images/c193d35c76e0a421902783bea4b5b6d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DfP-s_fu9ZXRCn4q7ImuJQ.jpeg"/></div></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">原始数据集中的两个问题</p></figure><p id="2990" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我们可以从我们的数据集中得到如下两个观察结果:</p><ol class=""><li id="91e0" class="nk nl iu kj b kk kl ko kp ks nm kw nn la no le oa nq nr ns bi translated">我们的记录中有重复的国家名称。这是因为给定数量的已报告新冠肺炎病例被分解到可能属于同一个国家的几个省/州。</li><li id="e296" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le oa nq nr ns bi translated">2020年4月13日报道的新冠肺炎案例的每一行都只是发生在一个国家的每个省或州的案例的小计。</li></ol><p id="7522" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">当我们逐个国家地遍历记录时，可以断断续续地看到上面的两个观察结果。这意味着原始数据集中的记录不一致。有些记录需要对一个国家的州进行细分，而有些记录只包含整个国家的单行数据。</p><p id="cbae" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">幸运的是，这里有一个简单的修复方法。我们可以使用熊猫图书馆来重组我们的数据。</p><figure class="nc nd ne nf gu jv"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">用于重构数据的Python代码</p></figure><p id="51ca" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">代码解释</strong></p><p id="e8a2" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第1–5行</strong>:这是导入必要的Plotly和Pandas库，读取CSV文件以及重命名一些列的步骤。</p><p id="c874" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第7行</strong>:我们可以使用Pandas <em class="lf"> groupby </em>方法根据国家对我们的数据进行分组，并应用sum方法计算每个国家报告的病例总数。结果是一个总和列表，我们将它赋给一个名为<em class="lf"> total_list </em>的变量。</p><figure class="nc nd ne nf gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj ca"><img src="../Images/1f971eb279d93f815f33271750300503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zZCAheyC5dWJbv1Hp5ZqtA.jpeg"/></div></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">每个国家报告病例总数系列</p></figure><p id="5058" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第9–13行</strong>:我们将清理国家列表并生成一个唯一的国家列表。</p><ul class=""><li id="a48a" class="nk nl iu kj b kk kl ko kp ks nm kw nn la no le np nq nr ns bi translated">首先，使用<em class="lf"> tolist </em>方法将<em class="lf"> Country </em>列转换为list对象，并将其赋给变量<em class="lf"> country_list </em>(第9行)。</li><li id="1dd9" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le np nq nr ns bi translated">接下来，使用<em class="lf"> set </em>方法将<em class="lf"> country_list </em>转换成Python set对象。set方法将自动从country_list中删除所有重复的国家名称。只有唯一的国家名称会存储在<em class="lf">国家设置</em>(第10行)中。</li><li id="099d" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le np nq nr ns bi translated">接下来，再次将<em class="lf"> country_set </em>转换为列表，并将其分配回<em class="lf"> country_list </em>(第11行)。</li><li id="709b" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le np nq nr ns bi translated">使用<em class="lf">排序</em>方法按照字母顺序重新排列<em class="lf">国家列表</em>(第12行)。<em class="lf">*这一步是必需的，因为之前使用的set方法会使国家/地区的顺序随机化。</em></li></ul><p id="480c" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第14行</strong>:最后，我们使用前面步骤生成的<em class="lf"> country_list </em>和<em class="lf"> total_list </em>作为新数据帧中仅有的两列，创建一个新数据帧。</p><figure class="nc nd ne nf gu jv gi gj paragraph-image"><div class="gi gj oc"><img src="../Images/7d97e82af3ecb2a32d658c5d5481c9e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*LxuPnZZD9SlSUnETYuRlRg.jpeg"/></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">重组原始数据后的新数据框架</p></figure><p id="73e3" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我们已经成功地重组了我们的数据，并将其存储到一个新的数据帧中，<em class="lf"> new_df </em>。<em class="lf"> new_df </em>包含了我们生成choropleth地图所需的数据(唯一的国家列表和每个国家的总病例数),我们现在准备进入下一步。</p><h2 id="c5cd" class="ml lo iu bd lp mm mn dn lt mo mp dp lx ks mq mr mb kw ms mt mf la mu mv mj mw bi translated">步骤2:生成Choropleth图</h2><p id="6fb6" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated">choropleth地图是一种由彩色多边形组成的地图，用于表示数量的空间变化。我们将使用<em class="lf"> go。Choropleth </em> graph对象创建一个Choropleth图，显示全球已报告新冠肺炎病例的分布。</p><figure class="nc nd ne nf gu jv"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">创建Choropleth地图的Python代码</p></figure><p id="6076" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">同样，这些代码一开始看起来令人望而生畏。然而，它们只不过是设置参数来构建choropleth图。我们可以参考官方网站上的<a class="ae kg" href="https://plotly.com/python/reference/#choropleth" rel="noopener ugc nofollow" target="_blank">参考页面</a>来获得更多关于参数的信息。</p><p id="9e3a" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">代码解释</strong></p><p id="0115" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第17–19行</strong>:我们可以为我们的choropleth贴图定义一个色域。要定义一个色域，我们只需创建一个六色代码列表。(*颜色代码可在此处<a class="ae kg" href="https://htmlcolorcodes.com/" rel="noopener ugc nofollow" target="_blank">获得</a>)。</p><p id="afca" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第22–33行</strong>:这是我们可以设置位置列表、色域、地图上显示的文本信息、标记线颜色等参数的部分。</p><ul class=""><li id="01c2" class="nk nl iu kj b kk kl ko kp ks nm kw nn la no le np nq nr ns bi translated">因为我们绘制地图来显示世界各地的新冠肺炎病例，所以我们将<em class="lf">位置模式</em>设置为“<strong class="kj iv">国家名称</strong>”。这使我们能够将<em class="lf">国家</em>列从<em class="lf"> new_df </em>设置为<em class="lf">地点</em>参数(第23–24行)。这是使Plotly能够将我们的新冠肺炎数据映射到choropleth地图上各自国家位置的重要一步。(<em class="lf">请注意，这里没有坐标，lat &amp; long，均为必填</em>)。</li><li id="afed" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le np nq nr ns bi translated">我们将来自<em class="lf"> new_df </em>的<em class="lf"> Total_Cases </em>数据设置为参数<em class="lf"> z </em>(第25行)<em class="lf">。</em>这是使Plotly能够根据应用于choropleth图的色域揭示报告病例频率的另一个关键步骤。</li><li id="1d90" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le np nq nr ns bi translated">我们还可以将“<em class="lf"> Total_Cases </em>”设置为<em class="lf">文本</em>参数(第26行)。每当我们将鼠标悬停在地图上的某个国家/地区上方时，就会在弹出文本中显示病例总数。</li><li id="252c" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le np nq nr ns bi translated">由于我们已经定义了自己的色域(第17–19行)，我们可以将参数<em class="lf"> autocolorscale </em>设置为false(第28行)。</li><li id="82da" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le np nq nr ns bi translated">我们还为颜色栏设置了一个标题(第30行)。</li></ul><p id="b69d" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">Line 33–37</strong>:这里，我们简单地为地图设置一个标题，并启用地图上显示的海岸线。</p><p id="e004" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第40行</strong>:将地图输出到HTML页面。</p><figure class="nc nd ne nf gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj od"><img src="../Images/19a192bf310c62c311ec2343444fecc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xRz2QtWSNAd5lpYaVQa7ww.jpeg"/></div></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">等值区域图</p></figure><p id="1dfa" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">最后，我们成功创建了一个Choropleth地图，显示了全球冠状病毒爆发的流行水平。当我们将鼠标放在一个国家地区的上方时，我们可以看到以弹出文本显示的报告病例数。</p><figure class="nc nd ne nf gu jv gi gj paragraph-image"><div class="gi gj oe"><img src="../Images/3f3608a8a4cea647662496f9aa169077.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*DBzqqqmCNlfGeDqV4H_Fgw.jpeg"/></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">Choropleth地图上的弹出文本</p></figure></div><div class="ab cl lg lh hy li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="in io ip iq ir"><h1 id="e1fb" class="ln lo iu bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">第3部分:在线发布Plotly地图</h1><p id="60f8" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated">你有没有想过我们可以在线发布我们的地图？Plotly为我们提供了一个免费与公众分享地图的选项。为此，我们只需遵循以下几个简单的步骤:</p><h2 id="b755" class="ml lo iu bd lp mm mn dn lt mo mp dp lx ks mq mr mb kw ms mt mf la mu mv mj mw bi translated"><strong class="ak">第一步:安装chart_studio </strong></h2><p id="941d" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated">打开您的终端(Mac)或命令提示符(Windows)，点击</p><pre class="nc nd ne nf gu of og oh oi aw oj bi"><span id="2531" class="ml lo iu og b gz ok ol l om on"><strong class="og iv">pip install chart_studio<br/>or<br/>sudo pip install chart_studio</strong></span></pre><h2 id="2330" class="ml lo iu bd lp mm mn dn lt mo mp dp lx ks mq mr mb kw ms mt mf la mu mv mj mw bi translated">第二步:注册一个Chart Studio的免费账户</h2><p id="6219" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated">访问<a class="ae kg" href="https://chart-studio.plotly.com/feed/#/" rel="noopener ugc nofollow" target="_blank">图表工作室页面</a>，注册一个免费账户。这个过程只需要不到3分钟。免费帐户允许我们与公众分享最多100张图表。</p><h2 id="bdeb" class="ml lo iu bd lp mm mn dn lt mo mp dp lx ks mq mr mb kw ms mt mf la mu mv mj mw bi translated"><strong class="ak">步骤3:在Python代码中设置凭证</strong></h2><p id="1cb0" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated">注册一个免费的Chart Studio帐户后，访问设置页面并寻找API键。复制API键并将其粘贴到我们之前的Python代码(散点图或Choropleth图)的顶部。</p><figure class="nc nd ne nf gu jv"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">设置Chart Studio凭据的Python代码</p></figure><p id="35ab" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated"><strong class="kj iv">第1–2行:</strong>这两行代码提供凭证信息，使我们的Python程序能够访问Chart Studio特性。</p><h2 id="a960" class="ml lo iu bd lp mm mn dn lt mo mp dp lx ks mq mr mb kw ms mt mf la mu mv mj mw bi translated">步骤4:将地图共享给公众</h2><p id="2bb1" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated">为了将我们的地图分享给公众，我们所需要的只是在现有Python程序的最后一行(第42行)添加一行代码。</p><figure class="nc nd ne nf gu jv"><div class="bz fq l di"><div class="ng nh l"/></div><p class="kc kd gk gi gj ke kf bd b be z dk translated">将地图共享给公众的Python代码</p></figure><p id="0b58" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">运行代码，Plotly将返回一个URL，将我们重定向到托管我们地图的网站。</p><p id="c3d1" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">您可以在此<a class="ae kg" href="https://plotly.com/~teobguan2020/5/" rel="noopener ugc nofollow" target="_blank">链接1 </a>查看我的共享散点图，在此<a class="ae kg" href="https://plotly.com/~teobguan2020/3/" rel="noopener ugc nofollow" target="_blank">链接2 </a>查看Choropleth地图。</p><figure class="nc nd ne nf gu jv"><div class="bz fq l di"><div class="oo nh l"/></div></figure><figure class="nc nd ne nf gu jv"><div class="bz fq l di"><div class="oo nh l"/></div></figure></div><div class="ab cl lg lh hy li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="in io ip iq ir"><h1 id="c846" class="ln lo iu bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">结束语</h1><p id="02f5" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated">Python Plotly是一个易于使用的图表绘图库，使我们能够创建令人惊叹的图表并与公众分享。这绝对值得我们花时间学习Plotly，并使用它来完成我们的数据可视化任务。如果你有兴趣了解更多关于Plotly库的知识，可以在这篇<a class="ae kg" href="https://neptune.ai/blog/plotly-python-tutorial-for-machine-learning-specialists" rel="noopener ugc nofollow" target="_blank">博客文章</a>中找到有用的教程。</p><p id="0905" class="pw-post-body-paragraph kh ki iu kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le in bi translated">我希望这篇文章能对你有所帮助。</p></div><div class="ab cl lg lh hy li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="in io ip iq ir"><h1 id="a33f" class="ln lo iu bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">为了与我联系，你可以</h1><ol class=""><li id="9549" class="nk nl iu kj b kk mx ko my ks op kw oq la or le oa nq nr ns bi translated">跟着我上<a class="ae kg" href="https://medium.com/@teobguan2013" rel="noopener"> <strong class="kj iv">中</strong> </a></li><li id="8b48" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le oa nq nr ns bi translated">通过<a class="ae kg" href="https://www.linkedin.com/in/bee-guan-teo-bb8570128/" rel="noopener ugc nofollow" target="_blank"> <strong class="kj iv"> LinkedIn </strong> </a>联系我</li></ol></div><div class="ab cl lg lh hy li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="in io ip iq ir"><h1 id="793f" class="ln lo iu bd lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk bi translated">开源代码库</h1><p id="78de" class="pw-post-body-paragraph kh ki iu kj b kk mx km kn ko my kq kr ks mz ku kv kw na ky kz la nb lc ld le in bi translated">本文中的所有源代码都可以在<a class="ae kg" href="https://github.com/teobeeguan/COVID-19-Scatter-Choropleth-Map" rel="noopener ugc nofollow" target="_blank"> GitHub资源库</a>中找到。</p><h1 id="b4af" class="ln lo iu bd lp lq os ls lt lu ot lw lx ly ou ma mb mc ov me mf mg ow mi mj mk bi translated">参考</h1><ol class=""><li id="7cc1" class="nk nl iu kj b kk mx ko my ks op kw oq la or le oa nq nr ns bi translated"><a class="ae kg" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/events-as-they-happen" rel="noopener ugc nofollow" target="_blank">https://www . who . int/emergencies/diseases/novel-coronavirus-2019/events-as-these-as-than-happens</a></li><li id="a620" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le oa nq nr ns bi translated">https://plotly.com/python/<a class="ae kg" href="https://plotly.com/python/" rel="noopener ugc nofollow" target="_blank"/></li><li id="e96a" class="nk nl iu kj b kk nt ko nu ks nv kw nw la nx le oa nq nr ns bi translated"><a class="ae kg" href="https://neptune.ai/blog/plotly-python-tutorial-for-machine-learning-specialists" rel="noopener ugc nofollow" target="_blank">https://Neptune . ai/blog/plotly-python-tutorial-for-machine-learning-specialists</a></li></ol></div></div>    
</body>
</html>