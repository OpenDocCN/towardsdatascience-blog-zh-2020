<html>
<head>
<title>7 advanced pandas tricks for data science</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学的 7 个高级熊猫技巧</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/7-advanced-tricks-in-pandas-for-data-science-41a71632b5d9?source=collection_archive---------8-----------------------#2020-04-12">https://towardsdatascience.com/7-advanced-tricks-in-pandas-for-data-science-41a71632b5d9?source=collection_archive---------8-----------------------#2020-04-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5cb6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Pandas 是数据科学的首选图书馆。这些是我用来更快更简单地完成重复性数据科学任务的捷径。</h2></div><h1 id="0261" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">1.使用 df.groupby()分析数据帧的样本。__iter__()</h1><p id="5e9d" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">与使用 Excel 相比，在 Jupyter 笔记本中逐行或逐组浏览数据集通常很难。一个有用的技巧是使用生成器并使用<em class="lw"> Ctrl + Enter </em>而不是<em class="lw"> Shift + Enter </em>，以便迭代地查看同一单元格内的不同样本，而不会在您的笔记本中造成混乱。</p><p id="9197" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">首先用生成器创建一个单元。groupby()(或。iterrows())并添加。__iter__():</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="679e" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">然后，使用键盘快捷键<em class="lw"> Ctrl + Enter </em>任意多次运行下面的单元格<strong class="lc iu">来观察对您最重要的数据:</strong></p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="6f25" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">这里有一个分析泰坦尼克号数据集中拥有完全相同机票号码的乘客的例子。您无法单独隔离每组乘客，因此使用这种方法可以让您以一种非常简单的方式逐个分析各组乘客:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/a96db4939bc249c4f297e5f9b6aa164d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*cCW6UYMxoA_3etQv4b2nIw.gif"/></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">使用 df.groupby()在 Titanic 数据集中搜索具有相同“机票”号码的乘客。__iter__()和键盘快捷键 Ctrl + Enter。</p></figure><h1 id="370f" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">2.用于数据探索和数据质量评估的熊猫概况分析</h1><p id="268f" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">在数据科学中，我们倾向于从头开始编写数据探索代码。既然所有的数据集都不一样，那就说得通了。然而，有一个神奇的<strong class="lc iu"> pandas_profiling </strong>包让这个推理变得毫无意义。该软件包实际上自动化了数据探索和数据质量评估步骤！看一看:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/31367fa03a375aac983c981f6d426e2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*vuM5AsEK8dPGfFjLPPW5Xw.gif"/></div></figure><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mq"><img src="../Images/d141841272eb3f1fb112128ef00452f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zpV03vkdrNiFLRVFaUJG6Q.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">点击“警告”以评估您的数据质量。</p></figure><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mv"><img src="../Images/45f3a1d4f36219462eb1e703df6bf050.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4eU3Krvw31-D1UDY7JzC8w.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">熊猫图谱相关分析。人们可以选择 5-6 个相关度。</p></figure><p id="ac81" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">它就像一个魔咒！</p><p id="a0f7" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">显然，它不能解决所有的数据探索，例如，如果您的数据中有自由文本变量。但这应该是你开始分析任何数据集的方式。</p><h1 id="fe00" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">3.多重链接</h1><p id="a4d6" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">一旦您理解了可以使用链接方法组合多个操作，Pandas 就会变得非常有趣。链接基本上是在同一行代码中添加操作。</p><p id="abf0" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">有了下面这行代码，我就</p><ul class=""><li id="1791" class="mw mx it lc b ld lx lg ly lj my ln mz lr na lv nb nc nd ne bi translated">在我的数据集中添加新列(。合并)</li><li id="3c41" class="mw mx it lc b ld nf lg ng lj nh ln ni lr nj lv nb nc nd ne bi translated">算上女乘客的比例(。申请(女性 _ 比例))</li><li id="c9c2" class="mw mx it lc b ld nf lg ng lj nh ln ni lr nj lv nb nc nd ne bi translated">对于超过 1 名乘客的团体(df。Ticket.value_counts()&gt;1)</li><li id="71bf" class="mw mx it lc b ld nf lg ng lj nh ln ni lr nj lv nb nc nd ne bi translated">有相同的票号(。groupby('Ticket '))。</li></ul><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mh mi l"/></div></figure><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="8a01" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">我不需要创建新的数据框架，新的变量，任何新的东西。链式方法允许你把你的想法“翻译”成实际的操作。</p><p id="64f7" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">下面的例子也是链式方法的一个很好的例子:</p><h1 id="31f4" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">4.用样式绘制系数/特征重要性</h1><p id="8cf5" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果你在做机器学习，你知道用通俗易懂的语言解释清楚你的机器学习模型有多困难。这里有一种方法可以帮助你很好地了解模型中的系数或变量的重要性。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nk"><img src="../Images/35f85f113450a91323031826791cf9b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AAF-9XWBN1qnqJMcoZJ6cg.png"/></div></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">你可以将系数(或变量重要性)放入数据框架中，以便可视化它们。</p></figure><p id="013d" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">我从多个来源收集了代码，得到了以下我一直在重复使用的可视化效果(避免重复发明轮子):</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="613f" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">它给出了以下输出:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/638103ee9218373934f5448a7175f8c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*6-iLrra9lujJmbvHphQLwA.png"/></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">变量根据系数(或变量重要性)进行排序，彩色条让我们可以快速找到最重要的变量。这里，“Pclass”列具有最大的(负)系数，其绝对值是第二大系数的两倍:“apollowed _ Q”。</p></figure><p id="ae7c" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">很漂亮吧？</p><h1 id="cece" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">5.sklearn _ 熊猫</h1><p id="c409" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">如果你是一个熊猫倡导者，你会不止一次地意识到与熊猫 DataFrame 和 sklearn 合作并不总是最合适的。但是不要就此打住。一些积极的贡献者创造了 sklearn_pandas，这是两个软件包之间的桥梁。它用熊猫友好的<strong class="lc iu">数据帧映射器</strong>取代了 sklearn 的<strong class="lc iu">列变换器</strong>。这几天开始只用 sklearn_pandas，没有失望。我希望我以前知道这件事。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="83f3" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">下面是使用。fit()方法:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nm"><img src="../Images/71fd6f44af4c3f92c9e7b112c8f1c9fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YUDnPCM4Uzli5wCwdpQDDA.png"/></div></div></figure><h1 id="8729" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">6.tqdm</h1><p id="dd93" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">当处理大型数据集时，数据操作需要时间。使用<strong class="lc iu"> tqdm </strong>来跟踪你的代码是否正在运行以及运行了多长时间，而不是在你的 Jupyter 笔记本前面无表情地等待，不知道发生了什么。对于运行速度太慢的脚本，这也是提前中止的好方法。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="a3e0" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">现在所有的熊猫数据框架都有了新的方法:</p><ul class=""><li id="e0d5" class="mw mx it lc b ld lx lg ly lj my ln mz lr na lv nb nc nd ne bi translated">。进度 _ 应用，。进度 _ 应用地图</li><li id="a6eb" class="mw mx it lc b ld nf lg ng lj nh ln ni lr nj lv nb nc nd ne bi translated">。用于列的 progress_map <em class="lw"/></li></ul><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/78a6ea84d7e4466eef4a8b28ccd46bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*lkH7tT5Zuh8me0Sr5QaL9Q.png"/></div></figure><p id="0f03" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">它们与应用、应用地图和地图相同，不同之处在于它们会绘制进度条。多有用啊！</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi no"><img src="../Images/8b79438e480a35dc048846e8c9f9daf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/0*9VBIjZMmFPc1wYBR.gif"/></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">tqdm pandas 方法生成的进度条示例。</p></figure><h1 id="1910" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">7.的。要粘贴到 Excel 中的 to_clipboard()</h1><p id="36f0" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">作为一名狂热的 Excel 用户，我开发了一些技巧来绘制性感的图表和漂亮的格式来展示数据的洞察力。尽管 pandas 有许多选项，但很难用最少的代码获得类似的输出水平。</p><p id="ce1b" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">有一件事我最终做了很多来应对，那就是将我的结果导出到 Excel。但不使用。to_excel 方法。相反，我使用平滑。to_clipboard(index=False)将数据复制到剪贴板。然后，我使用 Excel 中的<em class="lw"> Ctrl + V </em>将数据粘贴到我当前的电子表格中。给你，你可以释放你体内的 Excel 野兽。</p><p id="2791" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">许多数据科学家容易忘记的一件事是，非数据科学家通常擅长 Excel。与他们共享 Excel 文件比共享笔记本或导出为 html 文件的笔记本更容易。</p><p id="445d" class="pw-post-body-paragraph la lb it lc b ld lx ju lf lg ly jx li lj lz ll lm ln ma lp lq lr mb lt lu lv im bi translated">如果这对你有用，请在评论中告诉我！感谢阅读，如果你喜欢就鼓掌吧:)</p></div></div>    
</body>
</html>