<html>
<head>
<title>Understanding T5 Model : Text to Text Transfer Transformer Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解 T5 模型:文本到文本转换转换器模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-t5-model-text-to-text-transfer-transformer-model-69ce4c165023?source=collection_archive---------16-----------------------#2020-04-24">https://towardsdatascience.com/understanding-t5-model-text-to-text-transfer-transformer-model-69ce4c165023?source=collection_archive---------16-----------------------#2020-04-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/951ecebed1f1e907e06445c95bc6736b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oPH8tAGqu3aUp6qjMtqcHg.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://miro.medium.com/max/4006/1*D0J1gNQf8vrrUpKeyD8wPA.png" rel="noopener">来源</a></p></figure><h2 id="04a4" class="kg kh it bd ki kj kk dn kl km kn dp ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">介绍</h2><p id="9107" class="pw-post-body-paragraph lc ld it le b lf lg lh li lj lk ll lm kp ln lo lp kt lq lr ls kx lt lu lv lw im bi translated">最近几年已经有太多的预训练模型被开源到 NLP 社区，比如<a class="ae kf" href="https://arxiv.org/abs/1801.06146" rel="noopener ugc nofollow" target="_blank">乌尔姆菲特</a>、<a class="ae kf" href="https://ai.googleblog.com/2018/11/open-sourcing-bert-state-of-art-pre.html" rel="noopener ugc nofollow" target="_blank">伯特</a>、<a class="ae kf" href="https://openai.com/blog/better-language-models/" rel="noopener ugc nofollow" target="_blank"> GPT </a>等等。鉴于这种庞大模型的规模，考虑到所需的数据量和计算量，从头开始训练这种网络几乎是不可能的。这就是一种新的学习范式“<strong class="le iu">迁移学习</strong>”开始发挥作用的地方。迁移学习是机器学习中的一个研究问题，它专注于存储在解决一个问题时获得的知识，并将其应用于不同但相关的问题。这个想法是使用预先训练好的网络权重，并对其进行微调，以完成手头的一些特定任务。我们希望利用网络权重的事实要求它首先在一个非常大的高质量语料库上进行训练，以学习<strong class="le iu">语言结构</strong>、<strong class="le iu">语法</strong>和<strong class="le iu">语义</strong>。大多数现有的模型，如乌尔姆菲特、GPT，都是用<a class="ae kf" href="https://www.tensorflow.org/datasets/catalog/wikipedia" rel="noopener ugc nofollow" target="_blank">维基百科</a>和<a class="ae kf" href="https://research.google/tools/datasets/" rel="noopener ugc nofollow" target="_blank">谷歌新闻数据集</a>上的<a class="ae kf" href="https://en.wikipedia.org/wiki/Language_model" rel="noopener ugc nofollow" target="_blank">语言模型</a>目标进行预训练的。然而，另一方面，伯特接受了<strong class="le iu"> MLM(掩蔽语言模型)目标</strong>的训练。在这篇文章的后面，我们将会看到什么是 MLM，以及 T5 是如何以相似的目标进行训练的，只是做了一些一般化的调整。只是为了确保每个人都在同一页上，一个<a class="ae kf" href="https://en.wikipedia.org/wiki/Language_model" rel="noopener ugc nofollow" target="_blank">语言模型</a>是一个<a class="ae kf" href="https://en.wikipedia.org/wiki/Machine_learning" rel="noopener ugc nofollow" target="_blank">机器学习模型</a>，它查看句子的历史部分并预测句子中的下一个单词。</p><p id="3695" class="pw-post-body-paragraph lc ld it le b lf ly lh li lj lz ll lm kp ma lo lp kt mb lr ls kx mc lu lv lw im bi translated"><a class="ae kf" href="https://arxiv.org/pdf/1910.10683.pdf" rel="noopener ugc nofollow" target="_blank"><strong class="le iu">T5:</strong><strong class="le iu">T</strong>ext-<strong class="le iu">T</strong>o-<strong class="le iu">T</strong>ext-<strong class="le iu">T</strong>transfer-<strong class="le iu">T</strong>transformer</a>模型提出将所有 NLP 任务重新组织成一个<strong class="le iu">统一的文本到文本格式</strong>，其中输入和输出总是文本串。这种格式使一个 T5 型号适合多种任务。从特色动画中可以看出，它从左侧为各种 NLP 任务接收文本输入，并为相应的任务输出文本。我们将在下面的章节中看到更多关于模型如何被训练的内容。在此之前，我想讨论一下用于预训练模型的数据。作者将其命名为<a class="ae kf" href="https://www.tensorflow.org/datasets/catalog/c4" rel="noopener ugc nofollow" target="_blank"> C4 </a> <strong class="le iu">(庞大干净的爬行语料库)</strong>。它的大小约为 700GB，是清理后的版本<a class="ae kf" href="https://commoncrawl.org/" rel="noopener ugc nofollow" target="_blank">通用抓取</a>数据集。作者提到了仅提取英文文本、删除代码行、重复数据删除等意义上的清理。这是一个高质量的预处理英语语料库，他们已经提供了下载。此外，T5 模型在 C4 上进行了预先训练，在许多 NLP 基准测试中取得了最先进的结果，同时具有足够的灵活性，可以针对各种重要的下游任务进行微调。</p><h2 id="bc81" class="kg kh it bd ki kj kk dn kl km kn dp ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">培训目标</h2><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi md"><img src="../Images/0badadfbbce2f29ee2cc2bc41be3bbb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/0*yeXSc6Qs-SGKDzZP.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">第 10 页—<a class="ae kf" href="https://arxiv.org/pdf/1910.10683.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1910.10683.pdf</a></p></figure><p id="525c" class="pw-post-body-paragraph lc ld it le b lf ly lh li lj lz ll lm kp ma lo lp kt mb lr ls kx mc lu lv lw im bi translated">T5 的训练目标也与 BERT 的相同，即稍加修改的掩蔽语言模型。<strong class="le iu">掩蔽语言模型</strong>是<a class="ae kf" href="https://medium.com/@plusepsilon/the-bidirectional-language-model-1f3961d1fb27" rel="noopener">双向模型</a>，在任何时候 t，单词的表征都是从它的左右语境中导出的。T5 采用的细微差别是用单个掩码关键字替换多个连续的标记，这与对每个单词使用掩码标记的 BERT 不同。从上图中可以看出，通过添加扰动，原始文本被转换为输入和输出对。由于最终目标是训练一个输入文本和输出文本的模型，目标被设计成产生一个序列，与 BERT 不同，它试图通过最终的<a class="ae kf" rel="noopener" target="_blank" href="/deep-learning-feedforward-neural-network-26a6705dbdc7">前馈</a>和<a class="ae kf" href="https://en.wikipedia.org/wiki/Softmax_function" rel="noopener ugc nofollow" target="_blank"> softmax </a>在输出级别输出一个单词(本身)。</p><p id="08c2" class="pw-post-body-paragraph lc ld it le b lf ly lh li lj lz ll lm kp ma lo lp kt mb lr ls kx mc lu lv lw im bi translated">该模型在<strong class="le iu"> C4 语料库</strong> <em class="lx">(如上所述)</em>上进行训练，其目的与预训练的一部分相同。然后，它在各种任务上进行微调，如<a class="ae kf" href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/" rel="noopener ugc nofollow" target="_blank">语言翻译</a>、<a class="ae kf" href="https://machinelearningmastery.com/gentle-introduction-text-summarization/" rel="noopener ugc nofollow" target="_blank">摘要</a>、<a class="ae kf" href="https://medium.com/@adriensieg/text-similarities-da019229c894" rel="noopener">句子相似度</a>等。微调是通过向每个输入中添加特定于任务的前缀文本来显示模型 I/O 文本对。例如— <strong class="le iu">将英语翻译成德语:&lt; text &gt; </strong>，添加这样的前缀使模型能够针对手头的特定任务调整其权重，并且通过缩小其生成范围，仅产生该任务的预期输出。所有的任务本质上都有相同的目标、训练程序和解码过程。作者还声称，他们没有发现任何一个案例，其中模型变得混乱，并输出完全随机的东西或另一项任务的预期输出。一件非常有趣的事情是，他们甚至将<strong class="le iu">回归</strong>任务建模为文本生成目标，比如句子相似度。为了缩小实数的范围，他们生成了一个 0 到 5 之间的 0.2 量化的数字，这意味着，该模型只能生成 0.2 差异的数字，例如-3.2，3.4，3.6 等。LR 计划、符号化、序列长度等训练级别细节可在<a class="ae kf" href="https://arxiv.org/pdf/1910.10683.pdf" rel="noopener ugc nofollow" target="_blank"> 3.1.2 中详细阅读。培训科。</a></p><p id="2b1e" class="pw-post-body-paragraph lc ld it le b lf ly lh li lj lz ll lm kp ma lo lp kt mb lr ls kx mc lu lv lw im bi translated">作者进行了广泛的<a class="ae kf" href="https://en.wikipedia.org/wiki/Hyperparameter_optimization" rel="noopener ugc nofollow" target="_blank">超参数调整</a>和跨各种任务的测试。下图显示了不同级别的调整-</p><ol class=""><li id="0f6d" class="mi mj it le b lf ly lj lz kp mk kt ml kx mm lw mn mo mp mq bi translated"><strong class="le iu">预训练风格</strong> —他们尝试了典型的自回归风格语言建模目标、BERT 风格掩蔽语言模型目标和去混洗去噪目标。他们发现 BERT 风格(缺失上下文预测)是预训练模型的最佳选择。</li><li id="72e5" class="mi mj it le b lf mr lj ms kp mt kt mu kx mv lw mn mo mp mq bi translated"><strong class="le iu">讹误方案</strong>——他们试验了 3 种讹误策略，屏蔽一个随机单词，屏蔽一个跨度(超过 1 个连续单词)，从输入中删除一个单词。考虑到手头的任务类型，即两个 I/O 都是文本字符串，破坏 span 最适合它们。</li><li id="25b4" class="mi mj it le b lf mr lj ms kp mt kt mu kx mv lw mn mo mp mq bi translated"><strong class="le iu">腐败率</strong>-在尝试了不同的腐败率后，他们发现所有腐败率的表现几乎相同，其中 15%的腐败率略好。</li><li id="462b" class="mi mj it le b lf mr lj ms kp mt kt mu kx mv lw mn mo mp mq bi translated"><strong class="le iu">讹误长度</strong> —他们还试验了不同的讹误跨度长度，发现跨度长度越大，模型的性能越差，这似乎也是真的，考虑跨度长度等于句子长度将意味着模型从空输入中产生文本，使其具有高度可变性的灵活性。</li></ol><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/e494c89e7c9e76135e1fc49ed25ff7e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*08aX_x8QxPo_uQMbWtCvzg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">第 19 页—【https://arxiv.org/pdf/1910.10683.pdf T4】</p></figure><p id="5ad9" class="pw-post-body-paragraph lc ld it le b lf ly lh li lj lz ll lm kp ma lo lp kt mb lr ls kx mc lu lv lw im bi translated">我也鼓励读者阅读<a class="ae kf" href="https://arxiv.org/pdf/1910.10683.pdf" rel="noopener ugc nofollow" target="_blank">第 32 页:反思</a>来理解培训模型的要点。</p><h2 id="61c5" class="kg kh it bd ki kj kk dn kl km kn dp ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">演示</h2><p id="53e8" class="pw-post-body-paragraph lc ld it le b lf lg lh li lj lk ll lm kp ln lo lp kt lq lr ls kx lt lu lv lw im bi translated">本节将重点对预训练的 T5 模型进行推理。所有代码已经提交到<a class="ae kf" href="https://github.com/prakhar21/T5-Text-to-Text-Transfer-Transformer" rel="noopener ugc nofollow" target="_blank">Github:Text-to-Text-Transfer-Transformer</a>。随意克隆和玩。此外，不要忘记开始回购，以防你喜欢它。</p><div class="mx my gp gr mz na"><a href="https://github.com/prakhar21/T5-Text-to-Text-Transfer-Transformer" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd iu gy z fp nf fr fs ng fu fw is bi translated">prak har 21/T5-文本到文本转换器</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">针对各种预培训任务的 T5 模型演示。-prak har 21/T5-文本到文本转换器</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">github.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no jz na"/></div></div></a></div><p id="53e5" class="pw-post-body-paragraph lc ld it le b lf ly lh li lj lz ll lm kp ma lo lp kt mb lr ls kx mc lu lv lw im bi translated">你的母语不是英语吗？查看多语言字幕视频解说版本(同样，更详细)——</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="56a2" class="pw-post-body-paragraph lc ld it le b lf ly lh li lj lz ll lm kp ma lo lp kt mb lr ls kx mc lu lv lw im bi translated"><strong class="le iu">参考文献</strong> <br/> 1。<a class="ae kf" href="https://ai.googleblog.com/2020/02/exploring-transfer-learning-with-t5.html" rel="noopener ugc nofollow" target="_blank">谷歌 AI 博客—T5</a>T17】2。<a class="ae kf" href="https://arxiv.org/pdf/1910.10683.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/1910.10683.pdf</a></p><blockquote class="nr"><p id="5947" class="ns nt it bd nu nv nw nx ny nz oa lw dk translated">你也可以查看我写的其他研究论文的解释</p><p id="ee3b" class="ns nt it bd nu nv nw nx ny nz oa lw dk translated"><a class="ae kf" href="https://medium.com/mlearning-ai/a-graph-based-text-similarity-method-with-named-entity-information-in-nlp-abc7f1201d96" rel="noopener">基于图的文本相似度方法</a></p><p id="1c3c" class="ns nt it bd nu nv nw nx ny nz oa lw dk translated"><a class="ae kf" href="https://medium.com/mlearning-ai/efficient-system-for-grammar-error-correction-on-mobile-devices-3a207105b7a3" rel="noopener">用于移动设备的语法纠正系统</a></p><p id="19e9" class="ns nt it bd nu nv nw nx ny nz oa lw dk translated"><a class="ae kf" rel="noopener" target="_blank" href="/beyond-accuracy-behavioral-testing-of-nlp-models-with-checklist-48544db3fef1">超越准确性:使用清单对 NLP 模型进行行为测试</a></p><p id="f43f" class="ns nt it bd nu nv nw nx ny nz oa lw dk translated"><a class="ae kf" href="https://medium.com/analytics-vidhya/leveraging-bert-for-extractive-text-summarization-on-lectures-294feb643486" rel="noopener">用于摘要文本摘要的 BERT</a></p><p id="abc2" class="ns nt it bd nu nv nw nx ny nz oa lw dk translated"><a class="ae kf" href="https://medium.com/analytics-vidhya/pegasus-pre-training-with-extracted-gap-sentences-for-abstractive-summarization-acb238aa1096" rel="noopener">用于抽象概括的飞马</a></p></blockquote><p id="48ee" class="pw-post-body-paragraph lc ld it le b lf ob lh li lj oc ll lm kp od lo lp kt oe lr ls kx of lu lv lw im bi translated"><em class="lx">我希望这本书值得你花时间阅读。谢谢大家！</em></p></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><p id="5b44" class="pw-post-body-paragraph lc ld it le b lf ly lh li lj lz ll lm kp ma lo lp kt mb lr ls kx mc lu lv lw im bi translated">【https://prakhartechviz.blogspot.com】最初发表于<a class="ae kf" href="https://prakhartechviz.blogspot.com/2020/04/t5-text-to-text-transfer-transformer.html" rel="noopener ugc nofollow" target="_blank"><em class="lx"/></a><em class="lx">。</em></p></div></div>    
</body>
</html>