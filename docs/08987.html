<html>
<head>
<title>Downloading Stock Data and Representing it Visually</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">下载股票数据并直观地展示出来</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/downloading-stock-data-and-representing-it-visually-6433f7938f98?source=collection_archive---------31-----------------------#2020-06-28">https://towardsdatascience.com/downloading-stock-data-and-representing-it-visually-6433f7938f98?source=collection_archive---------31-----------------------#2020-06-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="125e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用 YFinance 和 Plotly 库进行股票数据分析</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/154c1f944c092cc18a19132e65e59ca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gJWKRVtrENoCSUm8"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Alec Favale 在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="bfd4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我将向您解释如何使用 python 库<strong class="lb iu"> YFinance </strong>，该库旨在通过提供一种可靠的、线程化的 python 方式从 Yahoo！下载历史市场数据，从而解决下载股票数据的问题金融。</p><p id="2b11" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在后面的部分中，我们将看到如何使用这些数据，通过使用 python 库来绘制不同的视觉上吸引人且高度互动的财务图表。plotly Python 库是一个交互式的<a class="ae ky" href="https://plotly.com/python/is-plotly-free" rel="noopener ugc nofollow" target="_blank">开源</a>绘图库，支持 40 多种独特的图表类型，涵盖了广泛的统计、金融、地理、科学和三维用例。</p><p id="2bfe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们开始吧。最初，我们将从安装 YFinace 库开始，我们将使用它来下载股票数据并查看它的一些特性。</p><h1 id="e97f" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">安装 YFinance</h1><p id="f766" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在命令提示符下运行下面给出的命令，使用 pip 安装 yfinance。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="8e99" class="mx lw it mt b gy my mz l na nb">pip install yfinance</span></pre><h1 id="5401" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated"><strong class="ak">在 Jupyter 笔记本中探索 YFinance 库</strong></h1><p id="c89b" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">让我们从导入库和下载股票数据开始。这里我使用的股票代码是 HINDPETRO。这是印度斯坦石油公司，你可以选择任何股票进行分析，只需用你的股票代码替换股票代码。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="5424" class="mx lw it mt b gy my mz l na nb"><br/>#importing Library<br/>import yfinance as yf</span><span id="cb2f" class="mx lw it mt b gy nc mz l na nb">#setting the ticker <br/>hindpetro = yf.Ticker("HINDPETRO.NS")</span><span id="0e31" class="mx lw it mt b gy nc mz l na nb">#Display stock information<br/>hindpetro.info</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/98d0f725f4567419ad33c58912cc6dfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P3_p86d2NUu_Ae3Ad_5pCQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这显示了与我们正在查看的公司相关的所有信息。</p></figure><p id="d9d2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们探索一下 YFinance 库提供的一些功能。这只是一个小例子，还有更多，你可以在这里<a class="ae ky" href="https://pypi.org/project/yfinance/" rel="noopener ugc nofollow" target="_blank">探索</a>。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="8818" class="mx lw it mt b gy my mz l na nb"># Dsiplay all the actions taken in the lifetime of the stock i.e    # dividends and splits with the dates when they are provided</span><span id="599f" class="mx lw it mt b gy nc mz l na nb">hindpetro.actions</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/e9821995963e81da52020101aa836908.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*wjBPdw1ii_mWk4SgV2UIFQ.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">显示股票行为，即股息和拆分以及各自的日期</p></figure><p id="30a8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">类似地，你可以使用下面给出的命令来分别显示查看股票股利和股票分割。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="c888" class="mx lw it mt b gy my mz l na nb">#Display Dividends<br/>hindpetro.dividends</span><span id="db5a" class="mx lw it mt b gy nc mz l na nb">#Display Splits<br/>hindpetro.splits</span></pre><p id="7d2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在让我们将数据下载到数据框中并显示出来。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="d514" class="mx lw it mt b gy my mz l na nb">df = hindpetro.history(period="max")<br/>df</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/a511db70501a461ec1f959840cc9be90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*O0UNr3LmcTTW1OTF69fWdw.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">HindPetro 从上市之日到今天的历史数据。</p></figure><p id="bca9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了执行进一步的操作，我们需要重置数据帧的索引，并将相应的列转换为 float 数据类型。下面给出的命令将解决我们的目的。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="f776" class="mx lw it mt b gy my mz l na nb">#Reseting the index<br/>df = df.reset_index()</span><span id="c11b" class="mx lw it mt b gy nc mz l na nb">#Converting the datatype to float<br/>for i in ['Open', 'High', 'Close', 'Low']:<br/>    df[i] = df[i].astype('float64')</span></pre><p id="65a6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在这之后，让我们从可视化部分开始。首先，我们需要安装 Plotly。</p><h1 id="21b6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">安装 Plotly</h1><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="bddc" class="mx lw it mt b gy my mz l na nb">pip install plotly</span></pre><h1 id="ee76" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用带范围滑块和按钮的 Plotly Graph_objects 创建折线图</h1><p id="8a72" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">折线图常用于时间序列分析，用于查看一段时间内的股票趋势。在这里，我将向您解释如何使用 Plotly 创建交互式折线图。以下命令将创建在最大时间段内存储在数据框中的股票数据的折线图。</p><p id="9384" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该代码还包括用于创建按钮的行，这些按钮可以被选择来显示特定时间段的折线图。</p><pre class="kj kk kl km gt ms mt mu mv aw mw bi"><span id="c3fb" class="mx lw it mt b gy my mz l na nb">import plotly.graph_objects as go<br/>import pandas as pd</span><span id="6f32" class="mx lw it mt b gy nc mz l na nb">fig = go.Figure([go.Scatter(x=df['Date'], y=df['High'])])</span><span id="f6ed" class="mx lw it mt b gy nc mz l na nb">fig.update_xaxes(<br/>    rangeslider_visible=True,<br/>    rangeselector=dict(<br/>        buttons=list([<br/>            dict(count=1, label="1m", step="month",                                        <br/>                 stepmode="backward"),<br/>            dict(count=6, label="6m", step="month",  <br/>                 stepmode="backward"),<br/>            dict(count=1, label="YTD", step="year", <br/>                 stepmode="todate"),<br/>            dict(count=1, label="1y", step="year", <br/>                 stepmode="backward"),<br/>            dict(step="all")<br/>        ])<br/>    )<br/>)<br/>fig.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/2921fc98599d7b575a2e18bacca79d0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-uIDtGTwmiEcPKB7-mbJdg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有范围选择器和范围选择按钮的股票数据折线图。</p></figure><h1 id="7dd4" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建 OHLC(开盘、盘高、盘低、收盘)图</h1><p id="d7ba" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu"> OHLC 图</strong>是一种棒线<strong class="lb iu">图</strong>，显示每个时期的开盘价、最高价、最低价和收盘价。<strong class="lb iu"> OHLC 图表</strong>很有用，因为它们显示了一段时间内的四个主要数据点，收盘价被许多交易者认为是最重要的。</p><p id="6d3e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面给出的代码将创建一个带有范围选择器的 OHLC 图表。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nh"><img src="../Images/45f6ff6e7e69e1ad3f00165c09879d96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_z6l1mxzRlq0oJn1_8vhuw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带范围选择器的 OHLC 图表</p></figure><h1 id="81ff" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">使用范围滑块创建烛台图表</h1><p id="5e64" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">烛台图表被交易者用来根据过去的模式决定可能的价格变动。烛台在交易时很有用，因为它们在交易者指定的时间内显示四个价格点(开盘价、收盘价、最高价和最低价)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ni"><img src="../Images/259fe051b4b1a6bc30272622380577e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jc7USQwXhoiR2Izd5bpoqw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">带有范围滑块的烛台图表</p></figure><h1 id="70a6" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">创建面积图</h1><p id="c7e0" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">面积图或面积图以图形方式显示定量数据。它基于折线图。轴和线之间的区域通常用颜色、纹理和影线来强调。</p><p id="5867" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下面给出的代码将创建股票数据的面积图。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nj"><img src="../Images/36f111ce10cfcca541037fbfe59dafeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*axbCJaYdFdfqhnjbvU8qdQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">股票数据面积图</p></figure><p id="08e8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有这些图表都是使用 Plotly 创建的，以便您可以与图表进行交互。上面提到的所有图表都是用于财务分析的主要图表。</p><h1 id="2670" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">结论</h1><p id="4e1c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">在本文中，我们从下载股票数据开始，并使用 YFinance 执行不同的操作/功能。之后，我们使用 Plotly 绘制了不同的财务图表，用于财务/股票数据分析。</p><div class="nk nl gp gr nm nn"><a rel="noopener follow" target="_blank" href="/understanding-data-analysis-step-by-step-48e604cb882"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">逐步了解数据分析</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">对数据集应用数据分析以获得关于数据的见解。</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob ks nn"/></div></div></a></div><div class="nk nl gp gr nm nn"><a rel="noopener follow" target="_blank" href="/creating-streamlit-dashboard-from-scratch-59316a74fa1"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd iu gy z fp ns fr fs nt fu fw is bi translated">从头开始创建 Streamlit 仪表板。</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">Streamlit 是一个很棒的工具，可以轻松构建视觉上吸引人的仪表板。</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">towardsdatascience.com</p></div></div><div class="nw l"><div class="oc l ny nz oa nw ob ks nn"/></div></div></a></div><h1 id="a3bf" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">在你走之前</h1><p id="0a2c" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu"> <em class="od">感谢</em> </strong> <em class="od">的阅读！如果你想与我取得联系，请随时通过 hmix13@gmail.com 联系我或我的</em> <a class="ae ky" href="http://www.linkedin.com/in/himanshusharmads" rel="noopener ugc nofollow" target="_blank"> <strong class="lb iu"> <em class="od"> LinkedIn 个人资料</em> </strong> </a> <em class="od">。也可以在我的</em><a class="ae ky" href="https://github.com/hmix13/YFinance" rel="noopener ugc nofollow" target="_blank"><strong class="lb iu"><em class="od">Github</em></strong></a><em class="od">中查看我在这里使用过的代码和数据集。另外，请随意浏览</em> <a class="ae ky" href="https://medium.com/@hmix13" rel="noopener"> <strong class="lb iu"> <em class="od">我的简介</em> </strong> </a> <em class="od">并阅读我写的与数据科学相关的不同文章。</em></p></div></div>    
</body>
</html>