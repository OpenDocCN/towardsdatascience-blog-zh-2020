<html>
<head>
<title>Paraphrase any question with T5 (Text-To-Text Transfer Transformer) — Pretrained model and training script provided</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用T5(文本到文本转换转换器)解释任何问题—提供预训练模型和训练脚本</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/paraphrase-any-question-with-t5-text-to-text-transfer-transformer-pretrained-model-and-cbb9e35f1555?source=collection_archive---------15-----------------------#2020-05-31">https://towardsdatascience.com/paraphrase-any-question-with-t5-text-to-text-transfer-transformer-pretrained-model-and-cbb9e35f1555?source=collection_archive---------15-----------------------#2020-05-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/0016e67457fc58463f8ef4e0291017da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CzTZUeiJAaWQMk3HRevz_w.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">来自<a class="ae kf" href="https://pixabay.com/" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的背景图像</p></figure><h2 id="18bf" class="kg kh it bd ki kj kk dn kl km kn dp ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">投入</h2><p id="6200" class="pw-post-body-paragraph lc ld it le b lf lg lh li lj lk ll lm kp ln lo lp kt lq lr ls kx lt lu lv lw im bi translated">我们节目的输入将是任何你能想到的<strong class="le iu">一般性问题</strong></p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="0e41" class="kg kh it mc b gy mg mh l mi mj"><strong class="mc iu">Which course should I take to get started in data Science?<br/>                 </strong></span></pre><h2 id="9625" class="kg kh it bd ki kj kk dn kl km kn dp ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">输出</h2><p id="e4e2" class="pw-post-body-paragraph lc ld it le b lf lg lh li lj lk ll lm kp ln lo lp kt lq lr ls kx lt lu lv lw im bi translated">输出将是<strong class="le iu">转述</strong>同一个问题的版本。转述一个问题意味着，你创造一个新的问题，用一个不同的词语选择来表达相同的意思。</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="5a1f" class="kg kh it mc b gy mg mh l mi mj"><strong class="mc iu">Paraphrased Questions generated from our T5 Model </strong>::<br/><strong class="mc iu">0: What should I learn to become a data scientist?<br/>1: How do I get started with data science?<br/>2: How would you start a data science career?<br/>3: How can I start learning data science?<br/>4: How do you get started in data science?<br/>5: What's the best course for data science?<br/>6: Which course should I start with for data science?<br/>7: What courses should I follow to get started in data science?<br/>8: What degree should be taken by a data scientist?<br/>9: Which course should I follow to become a Data Scientist?</strong></span></pre><p id="54e0" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">正如您所看到的，我们生成了大约10个问题，这些问题是对原问题的复述——“我应该学习哪门课程来开始学习数据科学？”</p><p id="6278" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">今天我们将看看如何从<a class="ae kf" href="https://github.com/huggingface/transformers" rel="noopener ugc nofollow" target="_blank"> Huggingface的变形金刚</a>库中训练一个T5模型来生成这些转述的问题。我们还将了解如何使用提供的<strong class="le iu">预训练模型</strong>来生成这些转述问题。</p><h2 id="ce4d" class="kg kh it bd ki kj kk dn kl km kn dp ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">实际使用案例</h2><figure class="lx ly lz ma gt ju gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/cd30cf6edf8c04192455e1bb86982ae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*k3_bW08x49P4UFcjJR9Eqg.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">来自<a class="ae kf" href="https://www.flaticon.com/authors/monkik" rel="noopener ugc nofollow" target="_blank">平面图标</a>的图标</p></figure><p id="2ab3" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">想象一个中学老师正在为班级准备一个测验。不是给每个学生一个固定的问题，而是他/她可以生成一个给定问题的多个变体，并分发给学生。学校也可以用这种技术用一个给定问题的几个变体来扩充他们的题库。</p><p id="6a18" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">让我们开始吧—</p><h2 id="c19a" class="kg kh it bd ki kj kk dn kl km kn dp ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">资料组</h2><figure class="lx ly lz ma gt ju gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/d0eb61b2d37571d8b6edef6f0ea0e437.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*3C5-AxIf64Ru-lYiFT3Pag.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">来自<a class="ae kf" href="https://www.flaticon.com/authors/freepik" rel="noopener ugc nofollow" target="_blank">平面图标</a>的图标</p></figure><p id="716a" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">我使用了<strong class="le iu"> </strong> <a class="ae kf" href="https://www.quora.com/q/quoradata/First-Quora-Dataset-Release-Question-Pairs" rel="noopener ugc nofollow" target="_blank"> <strong class="le iu"> Quora问题对</strong> </a>数据集来收集所有标记为<strong class="le iu">重复</strong>的问题，并准备了训练集和验证集。重复的问题有助于我们获得<strong class="le iu">释义</strong>对。</p><p id="dadc" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">我们会详细讨论你如何-</p><ol class=""><li id="95b7" class="mq mr it le b lf mk lj ml kp ms kt mt kx mu lw mv mw mx my bi translated">使用我的<strong class="le iu">预先训练的</strong>模型为任何给定的问题生成转述问题。</li><li id="641f" class="mq mr it le b lf mz lj na kp nb kt nc kx nd lw mv mw mx my bi translated">使用我的<strong class="le iu">训练</strong>代码和数据集在你自己的<strong class="le iu"> GPU </strong>机器上复制结果。</li></ol><h2 id="daf8" class="kg kh it bd ki kj kk dn kl km kn dp ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">训练算法— T5</h2><figure class="lx ly lz ma gt ju gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/634b09b7f6d57ac3b4431c5e6d36a0e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:256/format:webp/1*QiwXXyEWUkYtmbDZKIP3bw.png"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">用<a class="ae kf" href="https://www.flaticon.com/authors/freepik" rel="noopener ugc nofollow" target="_blank">扁平图标</a>生成的图标</p></figure><p id="d3cf" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">T5是Google的一个新的transformer模型，它以端到端的方式进行训练，将<strong class="le iu">文本作为输入</strong>，将修改后的<strong class="le iu">文本作为输出</strong>。你可以在这里了解更多关于<a class="ae kf" href="https://ai.googleblog.com/2020/02/exploring-transfer-learning-with-t5.html" rel="noopener ugc nofollow" target="_blank">的信息。</a></p><p id="1df0" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">它使用在大型文本语料库上训练的文本到文本转换器，在多个自然语言处理任务上实现了最先进的结果，如摘要、问题回答、机器翻译等。</p><p id="5f00" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">我用<strong class="le iu">原句</strong>作为<strong class="le iu">输入</strong>和<strong class="le iu">转述</strong>(来自Quora问题对的重复句)句子作为<strong class="le iu">输出</strong>来训练T5。</p><h2 id="7644" class="kg kh it bd ki kj kk dn kl km kn dp ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">密码</h2><p id="57bb" class="pw-post-body-paragraph lc ld it le b lf lg lh li lj lk ll lm kp ln lo lp kt lq lr ls kx lt lu lv lw im bi translated">使用<strong class="le iu">“使用预训练模型”</strong>部分中的Google Colab链接对此进行测试。使用给定数据训练模型的所有代码可从以下网址获得-</p><div class="ne nf gp gr ng nh"><a href="https://github.com/ramsrigouthamg/Paraphrase-any-question-with-T5-Text-To-Text-Transfer-Transformer-" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd iu gy z fp nm fr fs nn fu fw is bi translated">ramsrigouthamg/Paraphrase-any-question with-T5-Text-To-Text-Transfer-Transformer-</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">用T5(文本到文本转换转换器)解释任何问题-提供预先训练的模型和训练脚本…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">github.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv jz nh"/></div></div></a></div><h2 id="f268" class="kg kh it bd ki kj kk dn kl km kn dp ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">使用预先训练的模型</h2><p id="8b14" class="pw-post-body-paragraph lc ld it le b lf lg lh li lj lk ll lm kp ln lo lp kt lq lr ls kx lt lu lv lw im bi translated">Google Colab notebook<a class="ae kf" href="https://colab.research.google.com/drive/1SdUHXDc6V3jxji1ef2NmE-vsStO35Adr?usp=sharing" rel="noopener ugc nofollow" target="_blank">t5-pre trained-question-paraphraser</a>包含以下代码。</p><p id="c1b1" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">首先，安装必要的库-</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="b11a" class="kg kh it mc b gy mg mh l mi mj"><br/>!pip install transformers==2.8.0<br/></span></pre><p id="9218" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">将任何问题作为输入进行推理，并查看解释的结果。</p><figure class="lx ly lz ma gt ju"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="b691" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">上述代码的输出是-</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="0ddc" class="kg kh it mc b gy mg mh l mi mj">device  cpu<br/><br/><strong class="mc iu">Original Question ::</strong><br/>Which course should I take to get started in data science?<br/><br/><br/><strong class="mc iu">Paraphrased Questions :: </strong><br/>0: What should I learn to become a data scientist?<br/>1: How do I get started with data science?<br/>2: How would you start a data science career?<br/>3: How can I start learning data science?<br/>4: How do you get started in data science?<br/>5: What's the best course for data science?<br/>6: Which course should I start with for data science?<br/>7: What courses should I follow to get started in data science?<br/>8: What degree should be taken by a data scientist?<br/>9: Which course should I follow to become a Data Scientist?</span></pre><h1 id="b567" class="ny kh it bd ki nz oa ob kl oc od oe ko of og oh ks oi oj ok kw ol om on la oo bi translated">训练你自己的模型</h1><p id="05d9" class="pw-post-body-paragraph lc ld it le b lf lg lh li lj lk ll lm kp ln lo lp kt lq lr ls kx lt lu lv lw im bi translated">同样，所有用于训练的训练代码和数据集都可以在前面提到的Github repo中获得。我们将经历我用来训练模型的步骤。</p><h2 id="0ee3" class="kg kh it bd ki kj kk dn kl km kn dp ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">1.数据准备</h2><p id="aef4" class="pw-post-body-paragraph lc ld it le b lf lg lh li lj lk ll lm kp ln lo lp kt lq lr ls kx lt lu lv lw im bi translated">首先我下载了这个<a class="ae kf" href="https://www.quora.com/q/quoradata/First-Quora-Dataset-Release-Question-Pairs" rel="noopener ugc nofollow" target="_blank">链接</a>中提到的Quora问题对tsv文件(q<a class="ae kf" href="http://qim.fs.quoracdn.net/quora_duplicate_questions.tsv" rel="noopener ugc nofollow" target="_blank">uora _ duplicate _ questions . tsv</a>)。</p><p id="a167" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">仅提取具有<strong class="le iu"> is_duplicate =1 </strong>的行，因为它们是复述的疑问句。然后，我将数据分成训练集和验证集，并将它们存储在单独的CSV文件中。</p><p id="a5f6" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">最后，每个CSV文件都有两列“<strong class="le iu">问题1 </strong>”和“<strong class="le iu">问题2 </strong>”。“问题2”是“问题1”的意译版本。由于T5期望一个文本作为输入，我给了<strong class="le iu"> "question1" </strong>作为<strong class="le iu">输入</strong>源，并要求它生成<strong class="le iu"> "question2" </strong>作为目标<strong class="le iu">输出</strong>。</p><p id="7461" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">用于生成训练和验证CSV文件的代码如下所示。CSV文件位于Github repo中的<a class="ae kf" href="https://github.com/ramsrigouthamg/Paraphrase-any-question-with-T5-Text-To-Text-Transfer-Transformer-/tree/master/paraphrase_data" rel="noopener ugc nofollow" target="_blank"> paraphrase_data </a>文件夹下。</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="41b5" class="kg kh it mc b gy mg mh l mi mj">filename = "<strong class="mc iu">quora_duplicate_questions.tsv</strong>"<br/>import pandas as pd<br/>question_pairs = pd.read_csv(filename, sep='\t')<br/>question_pairs.drop(['qid1', 'qid2'], axis = 1,inplace = True)</span><span id="2c64" class="kg kh it mc b gy op mh l mi mj">question_pairs_correct_paraphrased = question_pairs[<strong class="mc iu">question_pairs['is_duplicate']==1</strong>]<br/>question_pairs_correct_paraphrased.drop(['id', 'is_duplicate'], axis = 1,inplace = True)</span><span id="361a" class="kg kh it mc b gy op mh l mi mj">from sklearn.model_selection import train_test_split<br/>train, test = train_test_split(question_pairs_correct_paraphrased, test_size=0.1)</span><span id="aa4e" class="kg kh it mc b gy op mh l mi mj">train.to_csv('<strong class="mc iu">Quora_Paraphrasing_train.csv</strong>', index = False)<br/>test.to_csv('<strong class="mc iu">Quora_Paraphrasing_val.csv</strong>', index = False)</span></pre><h2 id="c0ce" class="kg kh it bd ki kj kk dn kl km kn dp ko kp kq kr ks kt ku kv kw kx ky kz la lb bi translated">2.培养</h2><p id="3c98" class="pw-post-body-paragraph lc ld it le b lf lg lh li lj lk ll lm kp ln lo lp kt lq lr ls kx lt lu lv lw im bi translated">感谢<a class="ae kf" href="https://madewithml.com/@patil-suraj/" rel="noopener ugc nofollow" target="_blank"> Suraj Patil </a>给了我们一个神奇的<a class="ae kf" href="https://colab.research.google.com/drive/176NSaYjc2eeI-78oLH_F9-YV3po3qQQO?usp=sharing#scrollTo=SDVQ04fGRb1v" rel="noopener ugc nofollow" target="_blank"> Colab笔记本</a>来训练T5完成任何文本到文本的任务。我从Colab笔记本上借用了大部分训练代码，只更改了数据集类和训练参数。我根据Quora问题对数据集修改了数据集类。</p><p id="9f3a" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">Github Repo中的培训代码为<a class="ae kf" href="https://github.com/ramsrigouthamg/Paraphrase-any-question-with-T5-Text-To-Text-Transfer-Transformer-/blob/master/train.py" rel="noopener ugc nofollow" target="_blank"> train.py </a>。</p><p id="2b35" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">你需要做的就是<strong class="le iu">在任一台<strong class="le iu"> GPU </strong>机器上克隆</strong>repo，安装<strong class="le iu"> requirements.txt </strong>，运行<strong class="le iu"> train.py </strong>来训练T5模型。</p><p id="8d5d" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">在<strong class="le iu"> p2.xlarge </strong> (AWS ec2)上训练该模型2个纪元(默认)花费了大约20个小时。</p><p id="7580" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">数据集类如下所示—</p><figure class="lx ly lz ma gt ju"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="fd4b" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">关键是我们如何向T5模型培训师提供我们的输入和输出。对于数据集中任何给定的问题对，我给T5模型输入(源)和输出(目标)，如下所示</p><p id="3284" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated"><strong class="le iu">输入格式到T5进行训练</strong></p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="8b7b" class="kg kh it mc b gy mg mh l mi mj"><strong class="mc iu">paraphrase: What are the ingredients required to make a perfect cake? &lt;/s&gt;</strong></span></pre><p id="583f" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated"><strong class="le iu">输出格式到T5进行训练</strong></p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="f8b3" class="kg kh it mc b gy mg mh l mi mj"><strong class="mc iu">How do you bake a delicious cake? &lt;/s&gt;</strong></span></pre><p id="8a86" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">就是这样！你手里有一个最先进的问题解释器。</p><p id="caba" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">也许这是第一个从任何给定的问题中产生转述问题的作品。</p><p id="278e" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">编码快乐！</p><h1 id="01d9" class="ny kh it bd ki nz oa ob kl oc od oe ko of og oh ks oi oj ok kw ol om on la oo bi translated">使用自然语言处理的问题生成——教程</h1><p id="a8d7" class="pw-post-body-paragraph lc ld it le b lf lg lh li lj lk ll lm kp ln lo lp kt lq lr ls kx lt lu lv lw im bi translated">我推出了一个非常有趣的Udemy课程，名为“使用NLP生成问题”,扩展了这篇博文中讨论的一些技术。如果你想看一看，这里是<a class="ae kf" href="https://www.udemy.com/course/question-generation-using-natural-language-processing/?referralCode=C8EA86A28F5398CBF763" rel="noopener ugc nofollow" target="_blank">链接</a>。</p></div><div class="ab cl oq or hx os" role="separator"><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov ow"/><span class="ot bw bk ou ov"/></div><div class="im in io ip iq"><p id="5d3c" class="pw-post-body-paragraph lc ld it le b lf mk lh li lj ml ll lm kp mm lo lp kt mn lr ls kx mo lu lv lw im bi translated">祝NLP探索愉快，如果你喜欢它的内容，请随时在Twitter上找到我。</p></div></div>    
</body>
</html>