<html>
<head>
<title>Building a Content-Based Book Recommendation Engine</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建基于内容的图书推荐引擎</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-content-based-book-recommendation-engine-9fd4d57a4da?source=collection_archive---------14-----------------------#2020-03-16">https://towardsdatascience.com/building-a-content-based-book-recommendation-engine-9fd4d57a4da?source=collection_archive---------14-----------------------#2020-03-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/e4ce88e1a410900facec805e5207beb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bgOgLsFQty9HscwSKl7l0g.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来源:图片由<a class="ae jg" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=2507902" rel="noopener ugc nofollow" target="_blank"> Pixabay </a>的<a class="ae jg" href="https://pixabay.com/users/TuendeBede-3187213/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=2507902" rel="noopener ugc nofollow" target="_blank"> TuendeBede </a>提供</p></figure><div class=""/><div class=""><h2 id="b7c9" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">根据书籍描述和名称推荐相似的书籍</h2></div><p id="bf3b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们计划购买任何新产品，我们通常会询问我们的朋友，研究产品的特点，将该产品与类似产品进行比较，阅读互联网上的产品评论，然后我们做出决定。如果所有这些过程都被自动处理并高效地推荐产品，会有多方便？推荐引擎或推荐系统是这个问题的答案。</p><p id="0e37" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">基于内容的过滤和基于协作的过滤是两种流行的推荐系统。在这篇博客中，我们将看到如何使用 Goodreads.com 数据构建一个简单的基于内容的推荐系统。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="0204" class="mb mc jj bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">基于内容的推荐系统</h2><p id="16ee" class="pw-post-body-paragraph ky kz jj la b lb mu kk ld le mv kn lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">基于内容的推荐系统通过获取项目的相似性来向用户推荐项目。该推荐系统基于描述或特征来推荐产品或项目。它根据产品的描述来识别产品之间的相似性。它还会考虑用户以前的历史，以便推荐类似的产品。</p><p id="ed0e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如:如果用户喜欢西德尼·谢尔顿的小说“告诉我你的梦”，那么推荐系统推荐用户阅读西德尼·谢尔顿的其他小说，或者推荐体裁为“非小说”的小说。(西德尼·谢尔顿小说属于非小说体裁)。</p><p id="d97c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如我上面提到的，我们使用 goodreads.com 的数据，没有用户阅读历史。因此，我们使用了一个简单的基于内容的推荐系统。我们要用一个书名和图书描述来搭建两个推荐系统。</p><p id="d295" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们需要找到与给定书籍相似的书籍，然后向用户推荐这些相似的书籍。如何发现给定的书是相似还是不相似？使用相似性度量来找到相同的结果。</p><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/9c90906461e780e126824722055590fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/0*ub9wXGmbPv80UaI0"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">来源:<a class="ae jg" href="https://dataaspirant.com/2015/04/11/five-most-popular-similarity-measures-implementation-in-python/" rel="noopener ugc nofollow" target="_blank"> dataaspirant </a></p></figure><p id="5de3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有不同的相似性度量可用。余弦相似度被用于我们的推荐系统来推荐书籍。有关相似性度量的更多详细信息，请参考此<a class="ae jg" href="https://dataaspirant.com/2015/04/11/five-most-popular-similarity-measures-implementation-in-python/" rel="noopener ugc nofollow" target="_blank">文章</a>。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="d90b" class="mb mc jj bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">数据</h2><p id="6992" class="pw-post-body-paragraph ky kz jj la b lb mu kk ld le mv kn lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">我从 goodreads.com 那里搜集了有关商业、非小说和烹饪类型的书籍细节。</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="f153" class="mb mc jj nf b gy nj nk l nl nm"># Importing necessary libraries<br/>import pandas as pd<br/>import numpy as np<br/>import pandas as pd<br/>import numpy as np<br/>from nltk.corpus import stopwords<br/>from sklearn.metrics.pairwise import linear_kernel<br/>from sklearn.feature_extraction.text import CountVectorizer<br/>from sklearn.feature_extraction.text import TfidfVectorizer<br/>from nltk.tokenize import RegexpTokenizer<br/>import re<br/>import string<br/>import random<br/>from PIL import Image<br/>import requests<br/>from io import BytesIO<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline</span><span id="47c4" class="mb mc jj nf b gy nn nk l nl nm"># Reading the file<br/>df = pd.read_csv("goodread.csv")</span><span id="37d9" class="mb mc jj nf b gy nn nk l nl nm">#Reading the first five records<br/>df.head()</span><span id="aa5c" class="mb mc jj nf b gy nn nk l nl nm">#Checking the shape of the file<br/>df.shape()</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi no"><img src="../Images/c97a4fe48dddd83432c32d844066d1c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lN_RYIgeJanhaEGYPxP7lg.png"/></div></div></figure><p id="e6e6" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的数据集中总共有 3592 本书的详细信息。它有六列</p><p id="7a63" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">书名-&gt;书名</p><p id="0b72" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">评分-&gt;用户给出的图书评分</p><p id="ef89" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">体裁-&gt;类别(书的类型)。对于这个问题，我只选择了三种类型，如商业、非小说和烹饪</p><p id="2b9d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">作者-&gt;图书作者</p><p id="a7af" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Desc -&gt;图书描述</p><p id="d701" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">URL -&gt;图书封面图片链接</p><h1 id="bb28" class="np mc jj bd md nq nr ns mg nt nu nv mj kp nw kq mm ks nx kt mp kv ny kw ms nz bi translated">探索性数据分析</h1><h2 id="033d" class="mb mc jj bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated"><strong class="ak">流派分布</strong></h2><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="b743" class="mb mc jj nf b gy nj nk l nl nm"># Genre distribution<br/>df['genre'].value_counts().plot(x = 'genre', y ='count', kind = 'bar', figsize = (10,5)  )</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oa"><img src="../Images/31383e5233b5de1dd449333d4f939881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OtXN6_f9GyC8bhs48PlH-g.png"/></div></div></figure><p id="c76c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">随机打印书名和描述</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="0ff6" class="mb mc jj nf b gy nj nk l nl nm"># Printing the book title and description randomly<br/>df['title'] [2464]<br/>df['Desc'][2464]</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ob"><img src="../Images/02ed8f67fdc550e98ca9069bccb3b240.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0uOd2QmHe9FREK1uiE2hZg.png"/></div></div></figure><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="40d0" class="mb mc jj nf b gy nj nk l nl nm"># Printing the book title and description randomly<br/>df['title'] [367]<br/>df['Desc'][367]</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oc"><img src="../Images/cd4171f2f3dc11361a9140cd308e0467.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_PzS2I7oLp4wmvSXh16Ugw.png"/></div></div></figure><h2 id="6593" class="mb mc jj bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">图书描述—字数分布</h2><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="826b" class="mb mc jj nf b gy nj nk l nl nm"># Calculating the word count for book description<br/>df['word_count'] = df2['Desc'].apply(lambda x: len(str(x).split()))</span><span id="10b4" class="mb mc jj nf b gy nn nk l nl nm"># Plotting the word count<br/>df['word_count'].plot(<br/>    kind='hist',<br/>    bins = 50,<br/>    figsize = (12,8),title='Word Count Distribution for book descriptions')</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi od"><img src="../Images/fbb34a567fe1f6c625b8f1d64f57ce8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H4whlSXFRYTS8bKVuDF36g.png"/></div></div></figure><p id="0ec4" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们没有更长的书籍描述。很明显，好的读物只是提供了一个简短的描述。</p><h2 id="b099" class="mb mc jj bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">图书说明中词类标签的分布</h2><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="59d2" class="mb mc jj nf b gy nj nk l nl nm">from textblob import TextBlob<br/>blob = TextBlob(str(df['Desc']))<br/>pos_df = pd.DataFrame(blob.tags, columns = ['word' , 'pos'])<br/>pos_df = pos_df.pos.value_counts()[:20]<br/>pos_df.plot(kind = 'bar', figsize=(10, 8), title = "Top 20 Part-of-speech tagging for comments")</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oe"><img src="../Images/e9eccdc8384ea58b5a79825c028a0cee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EcmbiqKf4ITq4TCDU9Rv_w.png"/></div></div></figure><h2 id="e922" class="mb mc jj bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">图书描述的二元模型分布</h2><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="64a4" class="mb mc jj nf b gy nj nk l nl nm">#Converting text descriptions into vectors using TF-IDF using Bigram<br/>tf = TfidfVectorizer(ngram_range=(2, 2), stop_words='english', lowercase = False)<br/>tfidf_matrix = tf.fit_transform(df['Desc'])<br/>total_words = tfidf_matrix.sum(axis=0) <br/>#Finding the word frequency<br/>freq = [(word, total_words[0, idx]) for word, idx in tf.vocabulary_.items()]<br/>freq =sorted(freq, key = lambda x: x[1], reverse=True)<br/>#converting into dataframe <br/>bigram = pd.DataFrame(freq)<br/>bigram.rename(columns = {0:'bigram', 1: 'count'}, inplace = True) <br/>#Taking first 20 records<br/>bigram = bigram.head(20)</span><span id="48eb" class="mb mc jj nf b gy nn nk l nl nm">#Plotting the bigram distribution<br/>bigram.plot(x ='bigram', y='count', kind = 'bar', title = "Bigram disribution for the top 20 words in the book description", figsize = (15,7), )</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi of"><img src="../Images/ec7ee9b8e5ac84182c3afdd0a1ad0787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NeSjsa_O3QPi2-bF3AwBnA.png"/></div></div></figure><h2 id="e31f" class="mb mc jj bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">图书描述的三元模型分布</h2><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="108a" class="mb mc jj nf b gy nj nk l nl nm">#Converting text descriptions into vectors using TF-IDF using Trigram<br/>tf = TfidfVectorizer(ngram_range=(3, 3), stop_words='english', lowercase = False)<br/>tfidf_matrix = tf.fit_transform(df['Desc'])<br/>total_words = tfidf_matrix.sum(axis=0) <br/>#Finding the word frequency<br/>freq = [(word, total_words[0, idx]) for word, idx in tf.vocabulary_.items()]<br/>freq =sorted(freq, key = lambda x: x[1], reverse=True)</span><span id="9224" class="mb mc jj nf b gy nn nk l nl nm">#converting into dataframe <br/>trigram = pd.DataFrame(freq)<br/>trigram.rename(columns = {0:'trigram', 1: 'count'}, inplace = True) <br/>#Taking first 20 records<br/>trigram = trigram.head(20)</span><span id="7e5a" class="mb mc jj nf b gy nn nk l nl nm">#Plotting the trigramn distribution<br/>trigram.plot(x ='trigram', y='count', kind = 'bar', title = "Bigram disribution for the top 20 words in the book description", figsize = (15,7), )</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi og"><img src="../Images/3c1890f05acd1d1dd1030e13333588f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xWdcfIcqEwDSBQK0VpmD3w.png"/></div></div></figure></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="5178" class="np mc jj bd md nq oh ns mg nt oi nv mj kp oj kq mm ks ok kt mp kv ol kw ms nz bi translated">文本预处理</h1><p id="175d" class="pw-post-body-paragraph ky kz jj la b lb mu kk ld le mv kn lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">清理图书描述。</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="d21b" class="mb mc jj nf b gy nj nk l nl nm"># Function for removing NonAscii characters<br/>def _removeNonAscii(s):<br/>    return "".join(i for i in s if  ord(i)&lt;128)</span><span id="05f3" class="mb mc jj nf b gy nn nk l nl nm"># Function for converting into lower case<br/>def make_lower_case(text):<br/>    return text.lower()</span><span id="15b0" class="mb mc jj nf b gy nn nk l nl nm"># Function for removing stop words<br/>def remove_stop_words(text):<br/>    text = text.split()<br/>    stops = set(stopwords.words("english"))<br/>    text = [w for w in text if not w in stops]<br/>    text = " ".join(text)<br/>    return text</span><span id="51f2" class="mb mc jj nf b gy nn nk l nl nm"># Function for removing punctuation<br/>def remove_punctuation(text):<br/>    tokenizer = RegexpTokenizer(r'\w+')<br/>    text = tokenizer.tokenize(text)<br/>    text = " ".join(text)<br/>    return text<br/>#Function for removing the html tags<br/>def remove_html(text):<br/>    html_pattern = re.compile('&lt;.*?&gt;')<br/>    return html_pattern.sub(r'', text)</span><span id="977d" class="mb mc jj nf b gy nn nk l nl nm"># Applying all the functions in description and storing as a cleaned_desc<br/>df['cleaned_desc'] = df['Desc'].apply(_removeNonAscii)<br/>df['cleaned_desc'] = df.cleaned_desc.apply(func = make_lower_case)<br/>df['cleaned_desc'] = df.cleaned_desc.apply(func = remove_stop_words)<br/>df['cleaned_desc'] = df.cleaned_desc.apply(func=remove_punctuation)<br/>df['cleaned_desc'] = df.cleaned_desc.apply(func=remove_html)</span></pre></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h2 id="80e7" class="mb mc jj bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">推荐引擎</h2><p id="928c" class="pw-post-body-paragraph ky kz jj la b lb mu kk ld le mv kn lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">我们将使用书名和描述来构建两个推荐引擎。</p><ol class=""><li id="77f0" class="om on jj la b lb lc le lf lh oo ll op lp oq lt or os ot ou bi translated">使用 TF-IDF 和 bigram 将每本书的标题和描述转换成向量。关于<a class="ae jg" href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf" rel="noopener ugc nofollow" target="_blank"> TF-IDF </a>的更多详情</li><li id="ec76" class="om on jj la b lb ov le ow lh ox ll oy lp oz lt or os ot ou bi translated">我们正在构建两个推荐引擎，一个带有书名，另一个带有图书描述。该模型基于标题和描述推荐类似的书。</li><li id="7d80" class="om on jj la b lb ov le ow lh ox ll oy lp oz lt or os ot ou bi translated">使用余弦相似度计算所有书籍之间的相似度。</li><li id="3e3f" class="om on jj la b lb ov le ow lh ox ll oy lp oz lt or os ot ou bi translated">定义一个函数，将书名和流派作为输入，并根据书名和描述返回前五本相似的推荐书籍。</li></ol><h1 id="7319" class="np mc jj bd md nq nr ns mg nt nu nv mj kp nw kq mm ks nx kt mp kv ny kw ms nz bi translated">基于书名的推荐</h1><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="80d8" class="mb mc jj nf b gy nj nk l nl nm"># Function for recommending books based on Book title. It takes book title and genre as an input.</span><span id="9977" class="mb mc jj nf b gy nn nk l nl nm">def recommend(title, genre):<br/>    <br/>    # Matching the genre with the dataset and reset the index<br/>    data = df2.loc[df2['genre'] == genre]  <br/>    data.reset_index(level = 0, inplace = True) <br/>  <br/>    # Convert the index into series<br/>    indices = pd.Series(data.index, index = data['title'])<br/>    <br/>   <strong class="nf jk"> #Converting the book title into vectors and used bigram</strong><br/>    tf = TfidfVectorizer(analyzer='word', ngram_range=(2, 2), min_df = 1, stop_words='english')<br/>    tfidf_matrix = tf.fit_transform(data['title'])<br/>    <br/>    # Calculating the similarity measures based on Cosine Similarity<br/>    sg = cosine_similarity(tfidf_matrix, tfidf_matrix)<br/>    <br/>    # Get the index corresponding to original_title<br/>       <br/>    idx = indices[title]</span><span id="ee73" class="mb mc jj nf b gy nn nk l nl nm"># Get the pairwsie similarity scores <br/>    sig = list(enumerate(sg[idx]))</span><span id="be9f" class="mb mc jj nf b gy nn nk l nl nm"># Sort the books<br/>    sig = sorted(sig, key=lambda x: x[1], reverse=True)</span><span id="8756" class="mb mc jj nf b gy nn nk l nl nm"># Scores of the 5 most similar books <br/>    sig = sig[1:6]</span><span id="2a16" class="mb mc jj nf b gy nn nk l nl nm"># Book indicies<br/>    movie_indices = [i[0] for i in sig]<br/>   <br/>    # Top 5 book recommendation<br/>    rec = data[['title', 'url']].iloc[movie_indices]<br/>       <br/>    # It reads the top 5 recommend book url and print the images<br/>    <br/>    for i in rec['url']:<br/>        response = requests.get(i)<br/>        img = Image.open(BytesIO(response.content))<br/>        plt.figure()<br/>        print(plt.imshow(img))</span></pre><p id="7d89" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们推荐《史蒂夫·乔布斯》这本书和体裁《商业》</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="7492" class="mb mc jj nf b gy nj nk l nl nm">recommend("Steve Jobs", "Business")</span></pre><h2 id="307d" class="mb mc jj bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">输出</h2><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pa"><img src="../Images/4448a02e07eaf88b05a8bc1df8339a2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LGUul0Gb8urGEgghPklbEw.png"/></div></div></figure><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pb"><img src="../Images/699fd7ec63c7393b5c33645d356ba95a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EG-YvjDBMU2qHvvMj6MO8Q.png"/></div></div></figure><p id="3c3a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们已经给了史蒂夫·乔布斯的书作为输入，并且该模型基于书名中存在的相似性来推荐其他史蒂夫·乔布斯的书。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><h1 id="e451" class="np mc jj bd md nq oh ns mg nt oi nv mj kp oj kq mm ks ok kt mp kv ol kw ms nz bi translated">基于图书描述的推荐</h1><p id="8d8e" class="pw-post-body-paragraph ky kz jj la b lb mu kk ld le mv kn lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">我们通过将书籍描述转换成向量来使用上述相同的函数。</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="9b26" class="mb mc jj nf b gy nj nk l nl nm"># Function for recommending books based on Book title. It takes book title and genre as an input.</span><span id="cecb" class="mb mc jj nf b gy nn nk l nl nm">def recommend(title, genre):<br/>    <br/>    global rec<br/>    # Matching the genre with the dataset and reset the index<br/>    data = df2.loc[df2['genre'] == genre]  <br/>    data.reset_index(level = 0, inplace = True) <br/>  <br/>    # Convert the index into series<br/>    indices = pd.Series(data.index, index = data['title'])<br/>    <br/>    <strong class="nf jk">#Converting the book description into vectors and used bigram</strong><br/>    tf = TfidfVectorizer(analyzer='word', ngram_range=(2, 2), min_df = 1, stop_words='english')<br/>    tfidf_matrix = tf.fit_transform(data['cleaned_desc'])<br/>    <br/>    # Calculating the similarity measures based on Cosine Similarity<br/>    sg = cosine_similarity(tfidf_matrix, tfidf_matrix)<br/>    <br/>    # Get the index corresponding to original_title<br/>       <br/>    idx = indices[title]</span><span id="71f1" class="mb mc jj nf b gy nn nk l nl nm"># Get the pairwsie similarity scores <br/>    sig = list(enumerate(sg[idx]))</span><span id="9ddb" class="mb mc jj nf b gy nn nk l nl nm"># Sort the books<br/>    sig = sorted(sig, key=lambda x: x[1], reverse=True)</span><span id="55c6" class="mb mc jj nf b gy nn nk l nl nm"># Scores of the 5 most similar books <br/>    sig = sig[1:6]</span><span id="510b" class="mb mc jj nf b gy nn nk l nl nm"># Book indicies<br/>    movie_indices = [i[0] for i in sig]<br/>   <br/>    # Top 5 book recommendation<br/>    rec = data[['title', 'url']].iloc[movie_indices]<br/>    <br/>    # It reads the top 5 recommend book url and print the images<br/>    <br/>    for i in rec['url']:<br/>        response = requests.get(i)<br/>        img = Image.open(BytesIO(response.content))<br/>        plt.figure()<br/>        print(plt.imshow(img))</span></pre><p id="8d82" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">来推荐一下《哈利波特与阿兹卡班的囚徒》这本书和体裁《非小说》</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="3891" class="mb mc jj nf b gy nj nk l nl nm">recommend("Harry Potter and the Prisoner of Azkaban", "Non-Fiction")</span></pre><h2 id="caef" class="mb mc jj bd md me mf dn mg mh mi dp mj lh mk ml mm ll mn mo mp lp mq mr ms mt bi translated">输出</h2><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/86ddb772ee0c32ea848169777098a7a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/format:webp/1*nfi3gUtbuchaPEIPwOmSqQ.png"/></div></figure><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pd"><img src="../Images/bd6387849753af0769fd3c88dbde05df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RG1m0T6ZtlyCkKRdNxIGoQ.png"/></div></div></figure><p id="d089" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们提供了“哈利·波特与阿兹卡班的囚徒”和“非小说”作为输入。该模型推荐了与我们的输入相似的其他五本哈利波特书籍。</p><p id="372a" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">再推荐一个吧</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="106d" class="mb mc jj nf b gy nj nk l nl nm">recommend("Norwegian Wood", "Non-Fiction")</span></pre><figure class="na nb nc nd gt iv gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/c982957c2df955a68851501774ee1362.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/format:webp/1*6pi8FG6QYqF8pMzzeTJuew.png"/></div></figure><figure class="na nb nc nd gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pf"><img src="../Images/e2c1843678a8e276a8bb758297185658.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xbVzhT5HgAfkVNPTK2GMTg.png"/></div></div></figure><p id="e2a9" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">以上模型根据描述推荐五本类似《挪威的森林》的书。</p><p id="16f2" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这只是一个简单的基层推荐系统。真实世界的推荐系统更加强大和先进。我们可以通过添加其他元数据(如作者和流派)来进一步改进上述内容。</p><p id="8379" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">此外，我们可以使用 word2Vec 实现基于文本的语义推荐。我用过 Word2Vec，建过推荐引擎。请在这里查看<a class="ae jg" href="https://medium.com/towards-artificial-intelligence/content-based-recommendation-system-using-word-embeddings-c1c15de1ef95" rel="noopener"/>。</p><p id="2103" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">你可以在我的<a class="ae jg" href="https://github.com/sdhilip200/Content-Based-Recommendation---Good-Reads-data" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>里找到数据。</p></div><div class="ab cl lu lv hx lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="im in io ip iq"><p id="66d0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读。如果你有什么要补充的，欢迎随时留言评论！</p></div></div>    
</body>
</html>