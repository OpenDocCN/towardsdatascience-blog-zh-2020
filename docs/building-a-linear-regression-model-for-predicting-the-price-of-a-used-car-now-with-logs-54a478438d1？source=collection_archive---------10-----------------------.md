# 构建预测二手车价格的线性回归模型-现在使用日志！

> 原文：<https://towardsdatascience.com/building-a-linear-regression-model-for-predicting-the-price-of-a-used-car-now-with-logs-54a478438d1?source=collection_archive---------10----------------------->

![](img/55d23ae829d5cf09074bfc1d5534e0af.png)

约翰·皮门塔尔在 [Unsplash](https://unsplash.com/s/photos/log-car?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄的照片

## 你的车值多少钱？

欢迎大家回到另一个激动人心的环节，建立一个线性回归模型来给你的二手车定价！我知道你看到这个结局有多激动。对于那些希望跳到实际工作模型的人，我已经把它上传到 Heroku [这里](https://usedcarpricepredictor.herokuapp.com/)。

我们叙叙旧吧。在我们这次旅程的第一篇文章中，我们从 Cars.com 收集了数据，稍微清理了一下，并对新清理的数据运行了一些 EDA。我们了解到一些汽车具有绝对可怕的零售价值，我们推测了零售市场中某些品牌的代表性。与此同时，我了解到一些有趣的事实:奔驰在转售市场上非常突出，因为奔驰车主倾向于租赁，因为他们希望每 3 年买一辆新车。日产代表了转售市场的很大一部分，因为日产将其年产量的 30%送给租车公司，而大多数其他汽车公司最多只给 10%。这意味着，如果这个有趣的事实是正确的，如果你要买一辆二手尼桑，那么你很有可能会买一辆在以前的历史中作为租赁的汽车。你可以在这里通读第一部分[。](/whats-your-car-worth-a-simple-tour-of-used-car-prices-using-linear-regression-eda-section-e98f89804dd6?source=friends_link&sk=29ca1dc16949f0bde30f258f50459ae6)

我们的第二个博客致力于做一些探索性的关联，我们设法发现了一些有趣的关联。高城 _mpg 和高速公路 _mpg 与价格负相关，导致我推测 2019 年的人不太在乎节省油钱。这可能是由于与 2018 年相比，当年的平均燃料价格较低。我们还使用线性回归查看了一些初始运行，发现了一些有希望的 R 数，并取消了奢侈品作为一个新特征，以帮助平滑我们的模型。你可以在这里阅读所有这些。

我认为在这一点上，我们可以开始进入标准的线性回归工具箱。第一个也是最明显的工具是获取一个或多个变量的自然日志。自然对数的目的是减少偏斜数据的可变性。也就是说，如果您的数据到处都是，希望对其应用一个数学函数(如自然对数)将减少其可变性，从而使人们更容易确定模式。然而，你必须记住，一旦你创建了你的模型，你的自然日志，实际上所有的数据转换，必须被逆转，这样你才能产生真实的结果。

所以我们要做的第一件事是取目标变量价格的自然对数。让我们看看我们的模型现在是什么样子！

![](img/8778bb04ce1b653d30948c4dbdb964db.png)

现在好了！那是一个好看的 R，不是吗？记录我们的价格，我们已经达到了最高的 R 值 0.752。让我们看看我们的剩余部分，好吗？

![](img/c7de086f4fa3564b02a418d91390730d.png)

哦，伙计，我喜欢这个，现在它变得很有意义了。我几乎可以通过它画一条线，并考虑能够预测我可怜的二手车的价格！

为了让事情变得更有趣一点，我和我的伙伴决定尝试通过玩这些特性来微调我们的模型。我们为低里程的汽车创建了一个新功能，并将其设置为小于 7500 英里，以查看它是否会影响我们的模型。我们还喜欢我们创造的豪华功能，因为豪华在二手车定价中发挥了如此巨大的作用，所以为了简单起见，我们将它用于所有品牌，并重新运行我们的模型:

![](img/287475e5552ade04b1f1e38e6efea58c.png)

我们仍然有很大的 R 值，但低里程的 P 值是 0.844！这是一个可怕的 P 值。基本上，它告诉我们的是，增加低里程数在统计学上是无关紧要的！这意味着我们可以扔掉它，让我们看看没有它我们会得到什么，或者在功能创建方面进行实验，相同的价格日志，不低的里程数:

![](img/8813e4dd16cf86710904856bb820acf5.png)

相同的 R 和我们的 P 值已经平静了很多。所以我们要用那个。我们的残值怎么办？

![](img/12b545a8d7c0ea41186f4d8ea0aafcf6.png)

看起来相当不错！最终测试，让我们运行一些预测，看看它是如何摇出来的！

![](img/4c9f5b40741693ad949ee989358a819c.png)

左:价格预测，右:残差

好吧，该死，我喜欢它的样子。它并不完美，没有一个模型会完全完美，但我认为我们已经创建了一个逻辑回归模型，它可以很好地估计我们假设的二手车的价格。

# 容易理解的数学部分

所以我运行了一个模型，它符合。我们已经经历了许多线性回归，我已经向你们展示了对统计学家、计算机科学家和数据科学家有意义的统计数据。如果你是数学新手，或者你只是对汽车感兴趣，我该如何让你更容易理解呢？所有这些只是为了推导系数，你可以在下面的 OLS 图表中看到。

![](img/1a68c1e2cf2111cce11ddf84b6b2479a.png)

看到这些系数告诉我们多少调整我们的预测价格的轨迹。所以比如我们看 city_mpg，系数是. 0134。也就是说，每 0134 city _ mpg 上涨，我们的价格就增加 1 美元。整个模型试图根据所有这些竞争因素重新定价。事实上，所有的线性回归都是为了创建一个数学公式，通过一组代表汽车价格的点来画一条线。这条线试图足够完美地拟合，使得它覆盖或位于路径上合理距离内的所有这些点。

那看起来像什么？因为所有的线性回归只是试图建立一个公式，我们有从建立模型中得到的系数，我们所要做的就是考虑每个系数，然后建立公式。看起来像这样:

![](img/e74276de363eea55a01517099504aea6.png)

使用这个公式，我们只需将我们知道的汽车价值乘以我们通过线性回归得出的系数，一旦我们完成公式，我们就有了预测的二手车价格！这太简单了，你可以用纸和笔来做！

在 Streamlit 前端应用程序[这里](https://usedcarpricepredictor.herokuapp.com/)上尽情体验吧！

# 结论

我们已经实现了我们设定的目标。我们有一个相当准确的线性回归模型，它将考虑汽车的特征，并以相当的准确度预测价格。在我看来，更有趣的是我们从 EDA 中获得的有趣见解。我的意思是，我很高兴我的合作伙伴和我能够创造一个模型，帮助人们正确地为他们的汽车定价，帮助人们对我来说是世界上最重要的事情之一。但是，举例来说，发现开奔驰的人大多是租车，这让我了解了很多开奔驰的人是什么样的。正是这些小事影响了我们看待周围世界的方式，这让我很高兴，我决定从事数据科学方面的职业。