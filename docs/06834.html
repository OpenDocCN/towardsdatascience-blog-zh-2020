<html>
<head>
<title>Computer vision — creating a classifier using convolutions, pooling and TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">计算机视觉——使用卷积、池化和张量流创建分类器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/computer-vision-creating-a-classifier-using-convolutions-pooling-and-tensorflow-7e75d809acbc?source=collection_archive---------64-----------------------#2020-05-27">https://towardsdatascience.com/computer-vision-creating-a-classifier-using-convolutions-pooling-and-tensorflow-7e75d809acbc?source=collection_archive---------64-----------------------#2020-05-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4b53" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">计算机如何识别图像，以及如何在分类中使用它</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/bbd2e8772d6839006b9c19f1f60dfe7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/1*knsCKA0KcbUKRqLVcAB_pg.gif"/></div></figure><p id="acb3" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">本文旨在解释扁平化、卷积和汇集思想背后的直觉，以及在创建图像分类器时如何在TensorFlow中使用这些概念。</p><p id="6bcf" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">使用的技术有python，TensorFlow和Keras API。</p><p id="7f58" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">使用的数据集:</p><p id="c531" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu">时尚MNIST</strong>——【https://www.kaggle.com/zalando-research/fashionmnist T2】</p></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><p id="b23e" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">关于将用于说明关键概念的数据集的一些信息:</p><p id="f988" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">名称:<strong class="ks iu">时尚MNIST </strong></p><p id="c7e6" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">观察次数:<strong class="ks iu"> 70000 </strong></p><p id="53f5" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">类别数量:<strong class="ks iu"> 10 </strong></p><p id="4384" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">类别的标签和名称:</p><p id="42b7" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu"> 0 - T恤/上衣</strong></p><p id="ee67" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu">一条裤子</strong></p><p id="1c12" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu">两件套衫</strong></p><p id="b01b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu"> 3 -连衣裙</strong></p><p id="e7e6" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu">四层涂层</strong></p><p id="45a2" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu"> 5 -凉鞋</strong></p><p id="8a56" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu"> 6件衬衫</strong></p><p id="6239" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu"> 7 -运动鞋</strong></p><p id="57c8" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu"> 8袋</strong></p><p id="614f" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu"> 9 -踝靴</strong></p><p id="64c2" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">随机样本:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi gj"><img src="../Images/eeff41b2d6646507c359eda775a24dea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p2SKKOKSN6MDSRVwo0VzgA.png"/></div></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">集合中图像的随机样本</p></figure></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><p id="f2ba" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">让我们从检查来自时尚MNIST数据集的图像开始:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/ae5b6b2556df8c2e545b93c057d0280e.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*VS3ZDNnNoT-ueN0CoAsXYQ.png"/></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">28 x 28 t恤图片</p></figure><p id="639a" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这是一个<strong class="ks iu">灰度</strong>(意味着它只有一个像素通道)图像，宽28像素，高28像素。我们只能看到图片的渲染形式，但图像本身是以数字矩阵的形式存储在计算机内存中的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi md"><img src="../Images/551e83bb30b6af22c11f5b9cae191f32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0wHCp6N2gaeOAQWzVgV9WA.png"/></div></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">图片的矩阵表示</p></figure><p id="5a8c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">典型的像素值从0到255，其中0为白色，255为黑色。</p><p id="b300" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">计算机“看到”图像的方式仅仅是通过上面表示的像素值。即使是最先进的图像识别算法也只是将像素转换成数字数组。</p><p id="378d" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">基本上，当我们谈论计算机视觉时，我们谈论的是计算机学习数字矩阵和标签之间的关系。</p></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><p id="3840" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">当试图构造图像分类器时，最基本的方法是使用图像中的每个像素作为单独的特征。这个过程叫做展平。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi me"><img src="../Images/5fcee6363128f4f427f5a8f612f72f6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R5yNOC32Hyu8GLpeSG6uCw.png"/></div></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">拉平像素</p></figure><p id="77da" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在上面的图片中，我画了一个假想的笑脸图片，总共有36个像素。白色像素等于0，黑色像素等于1。</p><p id="eced" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">扁平化的过程只不过是将二维图片(或者更高维，如果图片有颜色的话)转换成一维向量。我假设数组从0开始，所以第7个坐标等于1(代表[2][2]像素)，第10个坐标等于1(代表[2][5]像素)，依此类推。展平的最终输出是一个36维向量。</p><p id="0b01" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">一般规则是，如果输入是n×m像素化的图像，那么输出将是n×m长度的向量。</p><p id="f5db" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">如果每张图片都有一个相关联的标签，比如“快乐”(=1)和“不快乐”(=0)，那么模型的矩阵<strong class="ks iu"> X </strong>和<strong class="ks iu"> Y </strong>的构造就很简单:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mf"><img src="../Images/f1bcd1995fd8366417431b78365728a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bmf-pyfgC5QTW9wI290wrQ.jpeg"/></div></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">从图片中创建矩阵</p></figure><p id="017f" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这个过程是将每张图片展平，并将每个矢量一个叠一个地堆叠起来。所以现在，我们可以开始建立模型，因为我们已经创建了代表图片的数字矩阵，各种优化算法可以开始工作了。</p><p id="dc9c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在上面画的例子中，如果我们有100张图片，那么X矩阵将有100行和36列(特征)，Y向量的长度将是100。对于这样的小图片，像逻辑回归这样的技术在预测未来的图像标签时可以做得很好。然而，在本文中，我将只使用深度学习模型。</p><p id="a717" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">让我们使用时尚MNIST数据集和一个非常简单的深度学习模型，并为此使用flatten()层:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mi"><img src="../Images/c875501b68e9a78e52d498e9e3dbe515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2peWAwW8-hQwwlXkpuWibw.png"/></div></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">模型拟合和测试</p></figure><p id="ef23" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">该模型在训练集和测试集中的准确率分别达到了<strong class="ks iu"> 91.5% </strong>和<strong class="ks iu"> 88.3% </strong>。</p></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><p id="4edf" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">虽然仅使用展平层作为像素的主要预处理器工作良好，但它有其缺点。</p><p id="7e55" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">首先，当图片从28 x 28像素增长到更真实的尺寸时，如256 x 256、512 x 512等等，每张图片的特征矩阵迅速扩展:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/638fa2983892b1d7505ecfd422b378a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*vwIhi3FgdnZp78LL2pCE2g.png"/></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">X矩阵的指数增长</p></figure><p id="eb36" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">因此，即使对于现代机器来说，训练一个具有数百万特征的前馈网络也是非常昂贵的。</p><p id="f360" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">第二，当我们使用单个像素作为特征时，图片的轻微变化，如人脸不在中心，各种相机旋转，背景的变化都可能以戏剧性的方式扭曲特征矩阵。这将导致创建在测试集上推广良好的分类器非常困难。</p><p id="b5ad" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">第三，在大多数图片中，有大量的背景噪声，这不会以任何方式提高分类器的决策。例如，在时尚MNIST数据集中，背景中有许多白色像素，这只是扩展了特征矩阵，而没有向神经模型添加太多信息。</p><p id="13ea" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">所有这三个问题都可以通过在神经网络中增加两层来解决——卷积和池化。</p></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><p id="d490" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">TensorFlow官方文档中的卷积层可以在这里找到:<a class="ae lm" href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Conv2D/" rel="noopener ugc nofollow" target="_blank">https://www . tensor flow . org/API _ docs/python/TF/keras/layers/Conv2D/</a>。</p><p id="3363" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">卷积是一种简单的数学运算，是许多常见图像处理运算符的基础。卷积提供了一种将两个数字数组“相乘”的方法，这两个数组通常大小不同，但维数相同，从而产生第三个维数相同的数字数组。这可以用在图像处理中，以实现其输出像素值是某些输入像素值的简单线性组合的算子。</p><p id="7e33" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">下面的动画很好地理解了卷积运算:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mk"><img src="../Images/9619d00e1a23cca1064039ffc32f2a1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*60uqHq7wJ2Mbg0uP4SRgvg.gif"/></div></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">回旋在行动</p></figure><p id="e5a9" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">左边的块代表具有特定像素值的图像，中间的小3x3块通常被称为<strong class="ks iu">滤镜</strong>。</p><p id="c0f5" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">最终值是通过一个简单的公式计算出来的——滤镜在图像上滑动，滤镜中的值乘以适当的像素值并求和。例如，结果块中的第一个值由以下公式计算:</p><p id="f770" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu">7 * 1+0 * 2+-1 * 3+1 * 4+5 * 0+3 *-1+3 * 1+3 * 0+2 *-1 = 6</strong></p><p id="691c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">不同的滤镜会突出显示图像中的不同属性。一些过滤器强调水平线，另一些强调垂直线和其间的任何东西。</p><p id="8ecd" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">比如一个滤镜:<br/><strong class="ks iu">【0 1 0】<br/>【1-4 1】<br/>【0 1 0】</strong></p><p id="86cc" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">会突出照片的边缘。python中的一个例子:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/83156999914718620bde83d104f871a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*6ebShIuA5y8UVOI_qXi0Fg.png"/></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">原图</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/6c7090ed580e4180fe92a63b4ee43175.png" data-original-src="https://miro.medium.com/v2/resize:fit:598/format:webp/1*qWGGibWro5ngCTxNDpuyyg.png"/></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">应用滤镜后的图片</p></figure><p id="8160" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">张量流卷积层创建固定大小的随机滤波器，然后在训练阶段，算法决定如何改变滤波器值以尽可能优化损失函数。</p></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><p id="7c23" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在获得上一节描述的卷积特征后，我们决定区域的大小，比如说𝑚𝑥𝑛来汇集卷积特征。然后，我们将我们的卷积特征分成不相交的𝑚𝑥𝑛区域，并在这些区域上取平均(或最大)特征激活以获得汇集的卷积特征。然后，这些汇集的特征可用于分类。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mn"><img src="../Images/6ca366dcc50c497111c09314ae9c4c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*BmS6WcGAQk7UJ99Np5epZg.gif"/></div></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">联营业务</p></figure><p id="bda6" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">这种技术很有用，因为至少在某种程度上，<strong class="ks iu">它消除了图像中小像素变化的影响</strong>。例如，一只鸟的头可以在图像的中间，或者稍微偏左或偏右。</p><p id="379d" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">TensorFlow官方文档:<a class="ae lm" href="https://www.tensorflow.org/api_docs/python/tf/nn/pool" rel="noopener ugc nofollow" target="_blank">https://www.tensorflow.org/api_docs/python/tf/nn/pool</a></p></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><p id="edcb" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">让我们将两个新层添加到我们的神经网络中:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="47aa" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="ks iu"> model.summary() </strong>输出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/3ebfea9e2831d9b0153753c0992dc6c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*Tx3XOB7FYC8mRx9mAKhLdA.png"/></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">模型概述</p></figure><p id="870e" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">您可能会注意到，第一个卷积层的输出形状是26 x 26 x 16，而图片的原始形状是28 x 28。像素的损失是由于过滤的性质。回想一下第一部分的动画。图片边缘的像素仅用于计算滤波器值和丢弃值。</p><p id="dfc5" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">max-pooling层输出的形状为13 x 13 x 16，这是因为我们使用了(2，2)正方形，将原始图片大小缩小到原始图片的四分之一(回想一下动画)。展平层输出大小可以通过公式13 * 13 * 16来计算。</p><p id="7e3c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">数字16等于tf.keras.layers.Conv2D层中定义的滤镜数。这意味着创建了16个独特的过滤器。因此，在网络的中心，从每一张输入图片中，有16张新图片被创造出来。</p><p id="6bcc" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">该模型的结果具有与更简单模型中相同的历元数:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mp"><img src="../Images/19e39aa653fe8701f9245f70f1f47696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bkUlbpTXxiBxDo8HqDH8_g.png"/></div></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">模型的训练</p></figure><p id="4155" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">池化和卷积层的加入提高了模型的训练和测试精度:训练集中的<strong class="ks iu"> 96.08% </strong>，测试集中的<strong class="ks iu"> 91.4% </strong>。</p></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><p id="0642" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">为了更好地理解计算机如何看待图像以及图像中的哪些特征最重要，我们可以直观地检查模型中第一层(即卷积层)的输出。</p><p id="308b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">为此，我将使用以下代码:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="0914" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">对于t恤衫:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/05d82d646d9f8c512c04abac12ca6a40.png" data-original-src="https://miro.medium.com/v2/resize:fit:534/format:webp/1*QjBZWI0Esf_DlL-oJ1KG5Q.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mr"><img src="../Images/293df6baa919ef1f7954fb3ca9c3d75b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dWcOlP04nSOY5J2Zi2vvHw.png"/></div></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">t恤的卷积层</p></figure><p id="1a69" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">对于鞋子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/2eacf125ff2609dafbe4de0be8905be1.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*gSD5ithISLon92ptv7m-Mw.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mt"><img src="../Images/5ed149f43e58b46f7932df90c65fc748.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KdtG_lV15An4SCappV-ZYg.png"/></div></div><p class="ly lz gj gh gi ma mb bd b be z dk translated">鞋子的回旋层</p></figure><p id="db71" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">对于t恤，我们可以看到t恤边缘的直线被照亮，这意味着这些像素有助于确定类别。此外，前面的标志也是一个明显的特征。</p><p id="a5cd" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">对于鞋子，完全不同的像素被点亮。在这种情况下，鞋子顶部轮廓的水平线被照亮。</p><p id="f97b" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现在卷积的图像与最大池层一起滑动，变平并馈送到简单的前馈网络。</p></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><p id="c0d6" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">总的来说，最先进的图像分类器是使用数百万张图片训练的，在这些网络的核心，有各种池和卷积层的组合。</p><p id="41ef" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">在获奖车型中，如</p><p id="bf80" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">【https://keras.io/api/applications/resnet/#resnet50-function T4】</p><p id="0093" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">或者</p><div class="mu mv gp gr mw mx"><a href="https://keras.io/api/applications/xception/" rel="noopener  ugc nofollow" target="_blank"><div class="my ab fo"><div class="mz ab na cl cj nb"><h2 class="bd iu gy z fp nc fr fs nd fu fw is bi translated">Keras文档:异常</h2><div class="ne l"><h3 class="bd b gy z fp nc fr fs nd fu fw dk translated">实例化异常架构。参考可选择加载ImageNet上预先训练的重量。请注意，数据…</h3></div><div class="nf l"><p class="bd b dl z fp nc fr fs nd fu fw dk translated">keras.io</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl ko mx"/></div></div></a></div><p id="2e2c" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">有数百万个参数和数百个层，但是基本的构建块是卷积和池。</p><p id="300e" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">我希望对于基本的图像分类任务，读者可以使用我提供的代码。</p><p id="a659" class="pw-post-body-paragraph kq kr it ks b kt ku ju kv kw kx jx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">编码快乐！</p></div></div>    
</body>
</html>