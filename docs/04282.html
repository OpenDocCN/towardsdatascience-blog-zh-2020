<html>
<head>
<title>Make a Beautiful Nightingale Rose Chart in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python制作一个漂亮的夜莺玫瑰图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/make-beautiful-nightingale-rose-chart-in-python-covid-19-death-rate-141a7a49bb61?source=collection_archive---------22-----------------------#2020-04-18">https://towardsdatascience.com/make-beautiful-nightingale-rose-chart-in-python-covid-19-death-rate-141a7a49bb61?source=collection_archive---------22-----------------------#2020-04-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5024" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><strong class="ak">设想新冠肺炎的死亡率</strong></h2></div><p id="9038" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">南丁格尔的玫瑰图，也被称为“极区图”或“鸡冠图”，是一个圆形图，结合了雷达图和柱形图的元素。这张特殊的图表是以护士、统计学家和改革家弗洛伦斯·南丁格尔的名字命名的。她发明了一种彩色统计图表，名为“东部军队的死亡原因图表”,生动地描述了在第二次世界大战(1954-1956)期间英国军队医院中不必要死亡的程度。图表显示，在战争过程中，流行病造成的英国人死亡比战场上受伤的多。</p><p id="96c5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在本教程中，我们将使用Pyechart库用Python创建一个南丁格尔玫瑰图。我们甚至不需要导入数据！只需要几个步骤，你就会有一个这样的玫瑰图！</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/be73b0c23fb4e5746a4d6a69e81909bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*5lHk7XdBwDRGDm-mSQ4A-Q.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">夜莺玫瑰图</p></figure><p id="5b06" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤1:导入库</p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="ca31" class="lv lw it lr b gy lx ly l lz ma">import numpy as np<br/>import pandas as pd<br/>from pyecharts.charts import Pie<br/>from pyecharts import options as opts</span></pre><p id="975a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第二步:打开网站，通过剪贴板功能获取数据</p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="1d83" class="lv lw it lr b gy lx ly l lz ma">import webbrowser<br/>website = ‘<a class="ae mb" href="https://www.worldometers.info/coronavirus/'" rel="noopener ugc nofollow" target="_blank">https://www.worldometers.info/coronavirus/'</a><br/>webbrowser.open(website)</span></pre><p id="7d4c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Worldmeters每天都以良好的格式更新新冠肺炎信息，因此本教程的数据来自该网站。Pandas中的read_clipboard()可以读取、复制、粘贴表格数据，并将其解析到一个数据框中。如果你想在小数据集上练习，这是一个非常有用的函数。其中一个限制是它不能处理合并的单元格。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mc"><img src="../Images/2d667e7f9a983146b53a9aee4f3ef1e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SAhOeKx8vckTXYEub05Omw.png"/></div></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">来自worldmeters.info的快照</p></figure><p id="1642" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当您从Worldmeters复制表格时，请不要包括第一行，它有列名。第一行中的每个单元格都是合并单元格，clipboard()无法处理它。它将返回错误。</p><p id="c5f3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在复制了除第一行以外的整个表之后，执行下面的代码</p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="8cd0" class="lv lw it lr b gy lx ly l lz ma">data = pd.read_clipboard()<br/>data</span></pre><p id="2015" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你会得到一张这样的桌子</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mh"><img src="../Images/8da1282ef511bfbe52ff1477e4d84e35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4-k2AbD38NsjtJAkZumBmQ.png"/></div></div></figure><p id="f669" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">第三步:第一行将被正确的列名替换</p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="c989" class="lv lw it lr b gy lx ly l lz ma">data.columns = [‘Country’,’TotalCases’,’NewCases’,’TotalDeaths’,’NewDeaths’,’TotalRecovered’,’ActiveCases’,’CriticalCondition’,‘TotCasesPerMillion’,’DeathsPerMillion’,’TotalTests’,’TestsPerMillion’]<br/>data</span></pre><p id="2484" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，数据帧看起来更好。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mi"><img src="../Images/75c1443ecbb799c670f28fbb16eae1dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5JLbj_e9kuJ5gAmnYuvU8g.png"/></div></div></figure><p id="b293" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤4:数据操作</p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="b3e5" class="lv lw it lr b gy lx ly l lz ma"># remove "," from the dataset<br/>for x in range(1,len(data.columns)):<br/> data[data.columns[x]] = data[data.columns[x]].str.replace(‘,’,’’) </span><span id="b343" class="lv lw it lr b gy mj ly l lz ma">#replace NaNs with zeros<br/>data = data.fillna(0)</span><span id="b452" class="lv lw it lr b gy mj ly l lz ma">#change the datatype from object to integer<br/>for i in range (1,len(data.columns)):<br/>    data[data.columns[i]] = data[data.columns[i]].astype(float).astype(int)</span><span id="ff44" class="lv lw it lr b gy mj ly l lz ma">#create a column 'Death Rate'<br/>data['DeathRate'] = data['TotalDeaths']/data['TotalCases']</span><span id="ce1a" class="lv lw it lr b gy mj ly l lz ma">#sort the data frame by 'Death Rate' in descending order<br/>data.sort_values(by=['DeathRate'], inplace=True, ascending=False)</span></pre><p id="b7e6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤5:选择死亡率最高的前15个国家</p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="c3c5" class="lv lw it lr b gy lx ly l lz ma">df=data[[‘Country’,’DeathRate’]].head(15) #select two columns and top 15 rows</span><span id="812c" class="lv lw it lr b gy mj ly l lz ma">df[‘DeathRate’] = (df[‘DeathRate’]*100).round(1)<br/>df</span></pre><p id="ab62" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用于进一步可视化的数据框已准备就绪。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/7489cb0d0a3b61f9af934c0458b0564b.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*rPK1RV4ZgI3MX5PPamLlnA.png"/></div></figure><p id="1e03" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">步骤6:可视化数据</p><pre class="lf lg lh li gt lq lr ls lt aw lu bi"><span id="9768" class="lv lw it lr b gy lx ly l lz ma">c = df[‘Country’].values.tolist()<br/>d = df[‘DeathRate’].values.tolist()</span><span id="5c06" class="lv lw it lr b gy mj ly l lz ma">#create the color_series for the rosechart<br/>color_series = [‘#802200’,’#B33000',’#FF4500',’#FAA327',’#9ECB3C’,<br/> ‘#6DBC49’,’#37B44E’,’#14ADCF’,’#209AC9',’#1E91CA’,<br/> ‘#2C6BA0’,’#2B55A1',’#2D3D8E’,’#44388E’,’#6A368B’,<br/> ‘#D02C2A’,’#D44C2D’,’#F57A34',’#FA8F2F’,’#D99D21']</span><span id="6fbe" class="lv lw it lr b gy mj ly l lz ma">rosechart = Pie(init_opts=opts.InitOpts(width='1350px', height='750px'))<br/># set the color<br/>rosechart.set_colors(color_series)<br/># add the data to the rosechart<br/>rosechart.add("", [list(z) for z in zip(c, d)],<br/>        radius=["20%", "95%"],  # 20% inside radius，95% ourside radius<br/>        center=["30%", "60%"],   # center of the chart<br/>        rosetype="area")</span><span id="253d" class="lv lw it lr b gy mj ly l lz ma"># set the global options for the chart<br/>rosechart.set_global_opts(title_opts=opts.TitleOpts(title='Nightingale Rose Chart',subtitle="Covid-19 Death Rate"),<br/>                     legend_opts=opts.LegendOpts(is_show=False),<br/>                     toolbox_opts=opts.ToolboxOpts())</span><span id="eac4" class="lv lw it lr b gy mj ly l lz ma"># set the series options<br/>rosechart.set_series_opts(label_opts=opts.LabelOpts(is_show=True, position="inside", font_size=12,formatter="{b}:{c}%", font_style="italic",font_weight="bold", font_family="Century"),)<br/>rosechart.render_notebook()</span></pre><p id="a146" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后生成美丽的夜莺玫瑰图！</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi ml"><img src="../Images/551b8688852cfe31a20f7d3bd595be1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VP0j5hGmTIA0XpPv1_NRsg.png"/></div></div></figure><p id="e4e9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从图表中很容易看出，MS Zaandam号游轮的死亡率最高。旁边是布隆迪、巴哈马和苏丹。据《纽约时报》报道，前15个国家的死亡率都超过了10%，大大高于普通季节性流感的死亡率，美国的死亡率通常在0.1%左右。</p><p id="2fe4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以，呆在家里享受学习数据可视化吧！</p><p id="7e97" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你对制作其他类型的漂亮图表感兴趣，你可以看看我的其他帖子。</p><ol class=""><li id="b603" class="mm mn it kk b kl km ko kp kr mo kv mp kz mq ld mr ms mt mu bi translated"><a class="ae mb" href="https://medium.com/python-in-plain-english/make-beautiful-water-polo-chart-in-a-few-lines-in-python-5d04f3f9335d" rel="noopener">用Python用几行字做一个漂亮的水球图</a></li><li id="f0f1" class="mm mn it kk b kl mv ko mw kr mx kv my kz mz ld mr ms mt mu bi translated"><a class="ae mb" href="https://medium.com/@han.candice/make-a-beautiful-bar-chart-in-just-few-lines-in-python-5625ebc71c49" rel="noopener">用Python制作一个只有几行的漂亮条形图</a></li><li id="cd53" class="mm mn it kk b kl mv ko mw kr mx kv my kz mz ld mr ms mt mu bi translated"><a class="ae mb" href="https://medium.com/@han.candice/make-a-beautiful-scatterplot-in-in-a-few-lines-in-python-to-make-your-report-outstanding-f47db0532094" rel="noopener">用Python制作几行漂亮的散点图，让你的报告出类拔萃</a></li><li id="b8ca" class="mm mn it kk b kl mv ko mw kr mx kv my kz mz ld mr ms mt mu bi translated"><a class="ae mb" href="https://medium.com/python-in-plain-english/animated-bubble-chart-with-plotly-in-python-inspired-by-professor-hans-rosling-b7262298dd03" rel="noopener">用Python语言Plotly制作令人印象深刻的动画泡泡图——灵感来自汉斯·罗斯林教授</a></li><li id="8b21" class="mm mn it kk b kl mv ko mw kr mx kv my kz mz ld mr ms mt mu bi translated"><a class="ae mb" href="https://medium.com/p/make-the-cutest-chart-in-python-visualize-your-data-with-hand-drawn-charts-f21157f76b4b" rel="noopener">用Python制作最可爱的图表——用手绘图表可视化你的数据</a></li></ol></div></div>    
</body>
</html>