<html>
<head>
<title>Predict daily electric consumption with neural networks.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用神经网络预测日用电量。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predict-daily-electric-consumption-with-neural-networks-8ba59471c1d?source=collection_archive---------19-----------------------#2020-01-24">https://towardsdatascience.com/predict-daily-electric-consumption-with-neural-networks-8ba59471c1d?source=collection_archive---------19-----------------------#2020-01-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/ce4e620b143db2997d8632ecf5d5bea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ikUZeZcFtYcNciAMVxVTuw.png"/></div></div></figure><div class=""/><div class=""><h2 id="c080" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">一个简单的三维结构如何减少错误，战胜更复杂的模型，并加倍节省。</h2></div><p id="4cc0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">2019年初，我们建立了一个深度学习模型，以每小时为基础预测电力消耗。因为最小的误差都会让电力公司损失数万美元，所以我们研究了许多更复杂的预测工具。最后，我们发现一个简单的全天方法是最有效的，通常可以将错误减半。</p><h1 id="c09e" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">该结构</h1><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mh"><img src="../Images/42cd584390d332d39a996ed2dde84577.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tvpfa2SKb7e38lbB29hO-w.png"/></div></div></figure><p id="da1d" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在我们之前的模型中，我们输入了所有我们认为与给定小时负载相关的特性:日期、天气数据等。然后，神经网络输出单小时负荷预测。这个过程重复了72次，给出了一个3天的预报。想要更深入的解释，可以考虑阅读<a class="ae mm" href="https://www.kmcelwee.com/load-forecasting/simple-load-forecasting" rel="noopener ugc nofollow" target="_blank">原文博文</a>。</p><p id="04e3" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">新的结构有效地结合了24小时模型。但是，我们没有计算一个小时，而是将所有重量合并到一个平坦的、完全连接的密集层中(我们决定大约。900个节点)。该层然后完全连接到一个24小时向量。然后，我们在3天内重复这一过程，给出72小时的预测。</p><h2 id="3b38" class="mn lq je bd lr mo mp dn lv mq mr dp lz lc ms mt mb lg mu mv md lk mw mx mf my bi translated">为什么这应该有效？</h2><p id="f138" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nb le lf lg nc li lj lk nd lm ln lo im bi translated">主要的要点应该是不同的时间互相“通知”。在我们的旧模型中，我们有一个非常直接的方法:给定所有这些因素，这一小时的预测是什么？但是在我们的新模型中，我们可以让所有对4pm的负载预测有贡献的因素影响5pm的负载预测。如果早上6点的温度是30华氏度，这难道不会影响到9点时加热器是否还在工作吗？神经网络可以识别这些复杂的相关性，并提供更明智的预测。</p><h2 id="33d8" class="mn lq je bd lr mo mp dn lv mq mr dp lz lc ms mt mb lg mu mv md lk mw mx mf my bi translated">这是怎么建的？</h2><p id="9ef7" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nb le lf lg nc li lj lk nd lm ln lo im bi translated">正确准备三维训练数据可能很棘手。下面是一个不太完美的函数，它将数据适当地分组到所需的维度。</p><figure class="mi mj mk ml gt iv"><div class="bz fp l di"><div class="ne nf l"/></div></figure><p id="ec4f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">然后，它被送入以下网络:</p><figure class="mi mj mk ml gt iv"><div class="bz fp l di"><div class="ne nf l"/></div></figure><h2 id="8d91" class="mn lq je bd lr mo mp dn lv mq mr dp lz lc ms mt mb lg mu mv md lk mw mx mf my bi translated">为什么不是RNN？</h2><p id="2a9a" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nb le lf lg nc li lj lk nd lm ln lo im bi translated">一个递归神经网络，或RNN，将类似于上面概述的网络运行。但是我们对LSTMs和GRUs(两个流行的RNN模型)的测试并不成功。我们无法制造出超越我们最简单的逐时结构的模型。简而言之，传统的RNN结构似乎让事情变得更糟。</p><h2 id="f38a" class="mn lq je bd lr mo mp dn lv mq mr dp lz lc ms mt mb lg mu mv md lk mw mx mf my bi translated">为什么一天24小时？</h2><p id="83be" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nb le lf lg nc li lj lk nd lm ln lo im bi translated">在我们的短期预测分析中，我们通常关心三天增量的负载(更远的预测很快变得无用)。那么为什么不在72小时的向量上训练呢？我们在技术上可以，但成本不会超过收益。在我们的24小时预测中，日模型的运行速度比小时模型慢三倍，但是回报(我们将在下面看到)非常高。但是，当我们增加到48或72小时的预测时，模型会严重变慢，但几乎没有改善。至少就我们的目的而言，分开训练三个24小时模型更好。</p><h1 id="2654" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">结果呢</h1><p id="167d" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nb le lf lg nc li lj lk nd lm ln lo im bi translated">我们在德克萨斯州的“中北部”地区测试了新模型。数据可以在这里找到<a class="ae mm" href="https://github.com/kmcelwee/load-forecasting/tree/main/data" rel="noopener ugc nofollow" target="_blank">。虽然实际上模型会每天训练，但在这次测试中，我们严格训练了前16年的数据(2002年至2017年)，并在最后一年(2018年)进行了测试。为了模拟天气预报的不确定性，我们向历史天气数据中添加了噪声，即24、48和72小时分组的标准偏差分别为2.5、4和6度的正态分布。</a></p><h2 id="d7d3" class="mn lq je bd lr mo mp dn lv mq mr dp lz lc ms mt mb lg mu mv md lk mw mx mf my bi translated">准确(性)</h2><p id="6fe8" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nb le lf lg nc li lj lk nd lm ln lo im bi translated">新模型的平均绝对百分比误差(MAPE)为3，而旧模型的前24小时MAPE为4。但是每小时的结果更令人信服。</p><p id="0e62" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">最重要的问题不仅是MAPE，而且是误差的传播(下面表示为四分位距，或IQR)。在开发我们的第一个模型时，我们发现当我们的模型是错误的时候，它通常是非常错误的。新模型中减少的方差可以帮助我们更有信心地向公用事业公司传达我们的不确定性。</p><figure class="mi mj mk ml gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ng"><img src="../Images/d6e515fd7395efcad9c31f52c42c9b75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p2iMFzqBV5TwhPb9P7xVgg.jpeg"/></div></div><p class="nh ni gj gh gi nj nk bd b be z dk translated">这些模型假设用户将在晚上11点预测第二天的电力消耗。因此，下图中的“提前0小时”意味着“凌晨12点”，“提前30小时”类似于“两天后的凌晨5点”，等等。</p></figure><h2 id="b482" class="mn lq je bd lr mo mp dn lv mq mr dp lz lc ms mt mb lg mu mv md lk mw mx mf my bi translated">节省的资金</h2><p id="7ab6" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nb le lf lg nc li lj lk nd lm ln lo im bi translated">而且最重要的是，省下来的钱！误差减少1个百分点可能看起来微不足道，但在2018年，这将使德克萨斯州的调峰储蓄增加一倍。(如果你对调峰不熟悉，可以考虑看看<a class="ae mm" href="https://www.next-kraftwerke.com/knowledge/what-is-peak-shaving" rel="noopener ugc nofollow" target="_blank">这位讲解者</a>)。</p><p id="d837" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">假设电池的充电功率为700千瓦，额定功率为500千瓦，我们可以通过完美的预测计算出可能出现的调峰量。使用我们的每小时神经网络模型，您可以捕获36%的最佳值。通过替换新模型(不确定性分析下没有任何花哨的<a class="ae mm" href="https://www.kmcelwee.com/load-forecasting/calculate-uncertainty" rel="noopener ugc nofollow" target="_blank">优化)，我们能够捕获64%的成本，几乎使我们的节约翻倍！</a></p><h1 id="544f" class="lp lq je bd lr ls lt lu lv lw lx ly lz kk ma kl mb kn mc ko md kq me kr mf mg bi translated">欢迎建议</h1><p id="7227" class="pw-post-body-paragraph kt ku je kv b kw mz kf ky kz na ki lb lc nb le lf lg nc li lj lk nd lm ln lo im bi translated">我们无法开发出比我们的模型更好的RNN，但这并不意味着它不存在。精度的微小提高可以极大地帮助电力公司，所以如果你认为有我们没有考虑到的结构，请随时联系我们！</p></div><div class="ab cl nl nm hx nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="im in io ip iq"><p id="4df6" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><em class="ns">疑问？更正？数据科学笑话？联系我或者在</em> <a class="ae mm" href="http://www.kmcelwee.com" rel="noopener ugc nofollow" target="_blank"> <em class="ns">我的网站</em> </a> <em class="ns">上看更多项目。</em></p><p id="43be" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><em class="ns">与</em> <a class="ae mm" href="http://omf.coop/" rel="noopener ugc nofollow" target="_blank"> <em class="ns">合作研究开放式建模框架</em> </a> <em class="ns">。</em></p><p id="3781" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这是关于神经网络调峰的三部分系列的更新。考虑在这里阅读更多:</p><div class="is it gp gr iu nt"><a href="https://www.kmcelwee.com/load-forecasting/" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd jf gy z fp ny fr fs nz fu fw jd bi translated">基于神经网络的⚡️负荷预测和调峰</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">预测技术给了公用事业单位一个机会来拉平他们的负荷曲线，提出了一个全新的家庭…</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">www.kmcelwee.com</p></div></div></div></a></div></div></div>    
</body>
</html>