<html>
<head>
<title>Super Easy Text Classification by Sentence Vector with sister (library)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">超级简单的文本分类句子向量与姐妹(库)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/super-easy-text-classification-by-sentence-vector-with-sister-library-843eabf962ae?source=collection_archive---------39-----------------------#2020-03-23">https://towardsdatascience.com/super-easy-text-classification-by-sentence-vector-with-sister-library-843eabf962ae?source=collection_archive---------39-----------------------#2020-03-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2acd793d478c8535ed54f9c7532ee56b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3Gb8Hq0XYN6SYCD_"/></div></div><p class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@alfonsmc10?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">阿尔方斯·莫拉莱斯</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="8925" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<a class="ae kc" rel="noopener" target="_blank" href="/super-easy-way-to-get-sentence-embedding-using-fasttext-in-python-a70f34ac5b7c">之前的帖子</a>中，我介绍了一个我写的库——<a class="ae kc" href="https://github.com/tofunlp/sister" rel="noopener ugc nofollow" target="_blank">姐姐</a>，它可以很容易地将一个句子转换成一个向量。我们看到了用很少的代码就能做到这一点是多么简单。</p><p id="22be" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，获得一个向量只是创建一个 ML 增强应用程序的第一步，我们需要在它上面放一个模型来做一些很酷的事情。</p><p id="d929" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本帖中，我们将通过几个简单的步骤，利用句子向量创建文本分类。</p><figure class="lb lc ld le gt jr"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="788b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了向您展示这样做有多简单，我将把整个代码放在前面。</p><p id="e143" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就这些了。包括空行，也就 27 行！！！</p><p id="8b61" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个程序主要做四件事。</p><ol class=""><li id="3aff" class="lh li iq kf b kg kh kk kl ko lj ks lk kw ll la lm ln lo lp bi translated">加载数据集。</li><li id="aaf9" class="lh li iq kf b kg lq kk lr ko ls ks lt kw lu la lm ln lo lp bi translated">将每个句子转换成一个向量。</li><li id="7bef" class="lh li iq kf b kg lq kk lr ko ls ks lt kw lu la lm ln lo lp bi translated">训练一个模特。</li><li id="65a6" class="lh li iq kf b kg lq kk lr ko ls ks lt kw lu la lm ln lo lp bi translated">评估。</li></ol></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><p id="f178" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我一步一步地解释它们</p><h1 id="1411" class="mc md iq bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">加载数据集</h1><p id="739c" class="pw-post-body-paragraph kd ke iq kf b kg na ki kj kk nb km kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi translated">主函数中的前几行，</p><pre class="lb lc ld le gt nf ng nh ni aw nj bi"><span id="8c97" class="nk md iq ng b gy nl nm l nn no">train = datasets.Imdb("train")test = datasets.Imdb("test")</span><span id="bdd4" class="nk md iq ng b gy np nm l nn no">train_texts, train_labels = zip(*train.all())test_texts, test_labels = zip(*test.all())</span></pre><p id="5b97" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正在加载一个著名的文本分类数据集，IMDb 数据集。这个数据集由电影评论和相应的情感标签组成。它有一个正面的标签—如果评论是正面的，则为 1。这意味着数据集中的所有样本都属于两个类中的一个，因此这是一个二元分类问题。</p><p id="57a5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了加载数据集，我使用了一个轻量级的 NLP 数据加载器库<a class="ae kc" href="https://github.com/tofunlp/lineflow" rel="noopener ugc nofollow" target="_blank"> LineFlow </a>。要了解更多这方面的信息，我建议你参考<a class="ae kc" rel="noopener" target="_blank" href="/lineflow-introduction-1caf7851125e">开发者写的一篇中型文章</a>。</p><h1 id="e736" class="mc md iq bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">将句子转换成向量</h1><p id="b321" class="pw-post-body-paragraph kd ke iq kf b kg na ki kj kk nb km kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi translated">现在酷的部分，通过使用<a class="ae kc" href="https://github.com/tofunlp/sister" rel="noopener ugc nofollow" target="_blank">姐妹</a>，我们将获得电影评论的数字表示。</p><pre class="lb lc ld le gt nf ng nh ni aw nj bi"><span id="e769" class="nk md iq ng b gy nl nm l nn no">sentence_embedding = sister.MeanEmbedding("en")</span><span id="df4c" class="nk md iq ng b gy np nm l nn no">train_x = np.array([sentence_embedding(t) for t in train_texts])test_x = np.array([sentence_embedding(t) for t in test_texts])</span></pre><p id="d60e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在第一行中，我们创建了一个类的实例，它获取一个句子，并将其中的单词转换成单词向量，最后是句子向量。想知道它是如何从一个单词向量序列中获取一个句子向量的，请参考<a class="ae kc" rel="noopener" target="_blank" href="/super-easy-way-to-get-sentence-embedding-using-fasttext-in-python-a70f34ac5b7c">我之前的文章</a>。</p><h1 id="ac60" class="mc md iq bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">训练模特</h1><p id="1b21" class="pw-post-body-paragraph kd ke iq kf b kg na ki kj kk nb km kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi translated">现在，我们已经为构建 ML 模型准备好了句子。为此，我将使用机器学习库之王，<a class="ae kc" href="https://scikit-learn.org/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>。通过使用这个，我们可以只用两行代码训练一个<a class="ae kc" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC" rel="noopener ugc nofollow" target="_blank">支持向量机</a>。</p><pre class="lb lc ld le gt nf ng nh ni aw nj bi"><span id="981f" class="nk md iq ng b gy nl nm l nn no">clf = SVC(kernel="linear")clf.fit(train_x, train_labels)</span></pre><h1 id="f488" class="mc md iq bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated">评价</h1><p id="b6e9" class="pw-post-body-paragraph kd ke iq kf b kg na ki kj kk nb km kn ko nc kq kr ks nd ku kv kw ne ky kz la ij bi translated">最后，我们可以用测试数据来测试模型训练得有多好。</p><pre class="lb lc ld le gt nf ng nh ni aw nj bi"><span id="9ac0" class="nk md iq ng b gy nl nm l nn no">print(clf.score(test_x, test_labels))</span></pre><p id="ea66" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过使用 scikit-learn，这也可以非常简单地完成。在我的本地机器上，它的准确率超过 80%。这不是一个很好的结果，但却是一个很好的起点。</p></div><div class="ab cl lv lw hu lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="ij ik il im in"><p id="e889" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们看到了如何构建一个以句子向量作为输入的 SVM 文本分类模型，并且我们用不到 30 行代码就实现了它。</p><p id="d0b9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我将以整个程序的 GitHub 要点 T4 来结束这篇文章。</p><p id="4348" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读！</p></div></div>    
</body>
</html>