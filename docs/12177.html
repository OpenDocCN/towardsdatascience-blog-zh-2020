<html>
<head>
<title>Advice and Tips to Properly Work with Virtual Environments</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">正确使用虚拟环境的建议和提示</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/advice-and-tips-to-properly-work-with-virtual-environments-67bbad9ba5b6?source=collection_archive---------19-----------------------#2020-08-22">https://towardsdatascience.com/advice-and-tips-to-properly-work-with-virtual-environments-67bbad9ba5b6?source=collection_archive---------19-----------------------#2020-08-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ec17" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">因为虚拟环境能够并且将会让您省心</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/efba23067fdae788e00f00a79fc196e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*F38uuz0j4oFbkxUW"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">来源:https://unsplash.com/photos/wl5AypUmamo<a class="ae ky" href="https://unsplash.com/photos/wl5AypUmamo" rel="noopener ugc nofollow" target="_blank"/></p></figure><p id="84ed" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">2020 年初，我正在使用 Keras/Tensorflow 进行一个学校项目。一切都很顺利。然后，我和我的队友分享了我的代码，这样他也可以开始工作了。然而，出于某种原因，这对他不起作用。</p><p id="eaf9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们花了几个小时想弄明白。最终，我们意识到这个问题是由于我们安装了不同版本的包造成的。一旦我们设法让它全部工作，我决定找到一种方法来避免这个问题再次发生。</p><p id="115f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这就是虚拟环境的用武之地。</p><blockquote class="lv lw lx"><p id="a71c" class="kz la ly lb b lc ld ju le lf lg jx lh lz lj lk ll ma ln lo lp mb lr ls lt lu im bi translated"><strong class="lb iu">如果你已经熟悉虚拟环境，你可以跳到第四部分，在那里我会给出一些建议和技巧来帮助你改进和定制你对虚拟环境的使用。</strong></p></blockquote></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h2 id="aee6" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">1.为什么要使用虚拟环境？</h2><p id="4ae4" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">随着您对 Python 的掌握越来越好，您将会使用越来越多的包，并且正确处理对早期版本包的依赖性将会越来越困难，因此需要虚拟环境。</p><p id="5839" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">可以将虚拟环境想象成一个独立的文件夹，您可以在其中保存特定版本的包，甚至是特定的 Python 版本，而不会影响您的其他项目。</p><p id="d391" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是一个简单的方法，可以确保你(和其他人)总是运行 Python 脚本而没有依赖问题，也就是说，总是为你的包使用正确的版本。</p><p id="05c6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所有出现的代码都可以直接从 Anaconda 提示符或命令行执行。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h2 id="fea8" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">2.如何创建虚拟环境</h2><p id="dc2e" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">超级简单。首先，确保你安装了 virtualenv，创建虚拟环境的库:<code class="fe nh ni nj nk b">pip install virtualenv</code>。</p><p id="b2f9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，下面几行代码将为您的项目创建一个新文件夹，并在其中创建/激活一个虚拟环境。</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="6d37" class="mj mk it nk b gy np nq l nr ns">&gt; mkdir new_folder        <strong class="nk iu">#create new folder for project</strong><br/>&gt; cd new_folder           <strong class="nk iu">#set current directory to folder<br/></strong>&gt; virtualenv venv         <strong class="nk iu">#Create a virtual environment called venv</strong><br/>&gt; cd venv/Scripts         <strong class="nk iu">#Set working directory to venv</strong><br/>&gt; . activate                <strong class="nk iu">#Activate the environment</strong></span></pre><p id="072e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从那里，您可以安装您需要的所有软件包及其特定版本:<code class="fe nh ni nj nk b">pip install beautifulsoup4==4.9.1</code>。</p><p id="bf37" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，有一个更好的方法可以做到这一点。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h2 id="197c" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">3.使用 requirements.txt 文件</h2><p id="319d" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">通过创建一个需求文件，您可以指定您想要在您的虚拟环境中使用的包和版本。下面是它应该是什么样子的一个例子:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/555c8006219f2ef7f426ee9a32891669.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*0qitiKApOH__g63mD3tozw.png"/></div></figure><p id="5b4f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，在确保文件位于当前工作目录中之后，您可以使用以下代码行安装文件中提到的所有软件包:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="73f0" class="mj mk it nk b gy np nq l nr ns">&gt; pip install -r requirements.txt</span></pre><p id="6f58" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这很好，但是还有一个更好的方法，我将在下一节中介绍。</p></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><h2 id="4f9c" class="mj mk it bd ml mm mn dn mo mp mq dp mr li ms mt mu lm mv mw mx lq my mz na nb bi translated">4.其他有用的提示和技巧</h2><p id="b08d" class="pw-post-body-paragraph kz la it lb b lc nc ju le lf nd jx lh li ne lk ll lm nf lo lp lq ng ls lt lu im bi translated">这里有一些提示和技巧，我相信它们会促进甚至改善你对虚拟环境的使用。</p><ol class=""><li id="e6a0" class="nu nv it lb b lc ld lf lg li nw lm nx lq ny lu nz oa ob oc bi translated"><strong class="lb iu">自动创建一个 requirements.txt 文件</strong></li></ol><p id="38a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">不需要手动创建需求文件，您可以(也应该)做的是将您的 Python 脚本放在虚拟环境中，并编写以下代码行:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="ca8c" class="mj mk it nk b gy np nq l nr ns">&gt; pip freeze &gt; requirements.txt</span></pre><p id="f868" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将为您自动创建它。</p><p id="c34a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一个选择也是使用<code class="fe nh ni nj nk b">pipregs</code>库。您所要做的就是将 Python 脚本的位置设为当前目录，然后键入<code class="fe nh ni nj nk b">pipregs</code>。</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="23bf" class="mj mk it nk b gy np nq l nr ns">&gt; pip install pipreqs<br/>&gt; pipreqs</span></pre><p id="c003" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将找到您的 Python 脚本，检测所有正在使用的包(和版本),并从中创建 requirements.txt 文件。</p><p id="44d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 2。用特定的 Python 版本创建虚拟环境</strong></p><p id="7bae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想让您的脚本在特定的 Python 版本上运行，这是很容易做到的。首先，确保您单独下载了您想要使用的版本。</p><p id="0edb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，在创建虚拟环境时，将代码的<code class="fe nh ni nj nk b">virtualenv venv</code>部分改为这样(例如，如果您想使用 Python 3.7):</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="76d2" class="mj mk it nk b gy np nq l nr ns">&gt; virtualenv venv --python=python3.7</span></pre><p id="40bb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 3。不要把你的 Python 脚本放在虚拟环境中</strong></p><p id="b4ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">删除虚拟环境最简单的方法是手动删除其文件夹。如果您将 python 脚本和需求文件插入其中，它们将随之被删除，这可能不是您想要做的。</p><p id="2f8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可能还想为多个项目使用同一个虚拟环境。将一切分开可以避免问题。</p><p id="8152" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最好的办法是将这些文件放在虚拟环境之外，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/22755f385d774d96c39174f089716f40.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*25TfZpRNBTuDGtMxJJmn1Q.png"/></div></figure><p id="3b63" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> 4。直接从虚拟环境中运行 Python 代码</strong></p><p id="6ca5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果您想直接从您的虚拟环境中运行您的代码，您只需在您的文件名前添加<code class="fe nh ni nj nk b">python</code>，就像这样:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="25c3" class="mj mk it nk b gy np nq l nr ns">&gt; python flights_scraping.py</span></pre></div><div class="ab cl mc md hx me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="im in io ip iq"><p id="4ed9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望这有所帮助。非常感谢你的阅读！</p></div></div>    
</body>
</html>