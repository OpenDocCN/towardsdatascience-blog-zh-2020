<html>
<head>
<title>How to train and compare Machine Learning models with few lines of code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用几行代码训练和比较机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-train-and-compare-machine-learning-models-with-few-lines-of-code-b1d5e1e266dd?source=collection_archive---------42-----------------------#2020-05-26">https://towardsdatascience.com/how-to-train-and-compare-machine-learning-models-with-few-lines-of-code-b1d5e1e266dd?source=collection_archive---------42-----------------------#2020-05-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a85b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">为您的项目选择最佳模型既简单又有趣！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f6d537cb8d250f759cdaf694e7a28c57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WHxWnEoQDZAdxgKxzBxO2A.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">有这么多选择，怎么只挑一个呢？<a class="ae ky" href="https://unsplash.com/photos/Ejcuhcdfwrs" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="477b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在机器学习项目中，我们花费大量时间清理数据并为训练做好准备，这可以代表数据科学家所有工作的80%以上，但当我们最终得到一个准备好建模的数据集时会发生什么，我们如何开始在其上训练不同的算法？不止如此，如何知道哪个更好？</p><p id="3046" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我将向您展示如何做到这一点的一种方法，一次训练几个算法，然后如何使用一个度量来比较结果并选择最佳选项。我使用的所有代码都可以在<a class="ae ky" href="https://www.kaggle.com/lucasmorato/technique-for-ml-model-selection" rel="noopener ugc nofollow" target="_blank">这里</a>找到，重要的是要注意，这篇文章并不是详尽的，有几种可能性来训练和比较结果，这只是其中之一。</p><h2 id="1ca7" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">数据集</h2><p id="8977" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们今天将使用Kaggle最受欢迎的分类问题数据集之一，<a class="ae ky" href="https://www.kaggle.com/c/forest-cover-type-prediction" rel="noopener ugc nofollow" target="_blank">森林覆盖类型预测</a>。该数据集约有15，000个观测值(行)和100多个要素(列)，包含有关地形、土壤类型、与道路的距离等多种信息。目标是在7个不同的类别中预测哪个封面类型是正确的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/e6a7752100290013cb793258dcf6a826.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZkHJ1T0KCWDavdLYVDc_pQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让我们进入(随机)森林？<a class="ae ky" href="https://unsplash.com/photos/-heLWtuAN3c" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><h2 id="0d71" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">让我向你介绍我们的模型！</h2><p id="5ac0" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">现在，让我简单介绍一下我们今天要尝试的五种分类算法。由于重点不是详细解释每一个，我会留下几个链接，以防你想了解更多。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/10fb6d846c7b6c4b1cd90ef6da247797.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/0*j65vS7OFjip5zaj4.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">当我们有这么多漂亮的选项时，如何选择算法？<a class="ae ky" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fgifer.com%2Fen%2FLbrU&amp;psig=AOvVaw09rXl1hmoLPh3LQDWt9LBF&amp;ust=1590400538803000&amp;source=images&amp;cd=vfe&amp;ved=0CAIQjRxqFwoTCOCA-_adzOkCFQAAAAAdAAAAABAJ" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><h2 id="8cc5" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">决策树</h2><p id="92af" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">这是一种监督学习算法，通过创建决策规则来解决分类和回归问题。你可以在这里阅读更多关于它的<a class="ae ky" rel="noopener" target="_blank" href="/decision-tree-algorithm-explained-83beb6e78ef4">。</a></p><h2 id="417f" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">随机森林</h2><p id="3ad5" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">与决策树一样，随机森林创建了一系列可用于分类和回归的规则，但在这种情况下，它创建了多个树，使用bootstrap聚合技术来创建随机组合。与简单的决策树相比，随机森林不太可能过度拟合训练数据，这是最常见的分类算法之一。更多信息请点击。</p><h2 id="1caa" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">k近邻</h2><p id="e1a1" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">顾名思义，在该方法中，每个数据点根据其“邻居”中最流行的标签进行分类。KNN基本上是围绕着相似性的概念工作的。这里有<a class="ae ky" rel="noopener" target="_blank" href="/machine-learning-basics-with-the-k-nearest-neighbors-algorithm-6a6e71d01761">这篇</a>优秀的文章，你可以找到更多关于它的内容。</p><h2 id="65c9" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">支持向量机</h2><p id="c913" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">该算法的工作原理是将数据点划分为超平面，这些超平面就像不同类别之间的边界。支持向量是影响超平面位置的数据点。这很难想象，但是<a class="ae ky" rel="noopener" target="_blank" href="/support-vector-machine-introduction-to-machine-learning-algorithms-934a444fca47">这个</a>深入的解释让我们很容易更好地理解SVM。</p><h2 id="6c85" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">XGBoost</h2><p id="f599" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">XGBoost代表极端梯度提升，不是指算法本身，而是指其背后的工程，旨在促进有效的计算使用和基于树的集成算法的最大速度。我们可以把它看作是随机森林的“进化”，它试图通过不同的技术来最小化它的错误。XGBoost是竞赛中使用最多的算法之一，提供了又好又快的结果。点击了解更多信息<a class="ae ky" rel="noopener" target="_blank" href="/https-medium-com-vishalmorde-xgboost-algorithm-long-she-may-rein-edd9f99be63d">。</a></p><h2 id="b3de" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">评估模型</h2><p id="d31a" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">现在，我们对将要使用的模型有了更多的了解，让我们选择如何评估它们。我们可以考虑的第一个指标是<strong class="lb iu">精度</strong>，它衡量算法正确预测一个类的频率。然而，<strong class="lb iu">并不是最好的成功衡量标准</strong>，因为当我们的班级不平衡时，它的效果很差。作为一个例子，考虑一个预测某人是否患有癌症的模型。一般来说，假设99%的观察结果是负面的，只有1%是正面的，那么如果你的模型总是预测负面的结果，它将有99%的精度，但无法预测正面的结果，这是最重要的任务。告诉我们模型在所有真阳性中正确预测的频率的测量被称为<strong class="lb iu">回忆</strong>。如果你感兴趣，我以前写过一篇解释召回的文章，可以在<a class="ae ky" rel="noopener" target="_blank" href="/let-me-recall-you-this-accuracy-isnt-everything-in-machine-learning-8e3a84ce0a8">这里</a>找到，你也可以在下图中直观地看到我刚才解释的内容:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/d3f99c4b05f645dd5168d62e69a167fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/0*_xnWngfrZ14pr-h7.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">精确度和召回率。<a class="ae ky" href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="1a7b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了检查每一类的精确度和召回率，我们今天使用了来自<em class="mw"> sklearn </em>的一个名为<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html" rel="noopener ugc nofollow" target="_blank">分类报告</a>的函数，它给出了这两个信息，加上<a class="ae ky" href="https://en.wikipedia.org/wiki/F1_score" rel="noopener ugc nofollow" target="_blank"> f1分数</a>，这基本上是两个测量值之间的调和平均值。我强烈建议您阅读该文档，因为它详细展示了所有指标，并解释了如何根据您的需要对其进行微调。</p><h2 id="e529" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">现在有趣的部分是:编码！</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/641b4864f5caa0f42f8dfa06053daf40.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/0*DyDV_R0aBHHo2Ncw.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">代码很好玩！</p></figure><p id="8d34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如上所述，正如我在本文标题中所承诺的，我将在下面的代码中向您展示如何创建一个循环来尝试每种算法并显示相应的分类报告。我已经包括了我认为对阐明每个步骤很重要的所有注释:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="4577" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">正如您所注意到的，核心是一个循环 的<a class="ae ky" href="https://www.datacamp.com/community/tutorials/for-loops-in-python?utm_source=adwords_ppc&amp;utm_campaignid=9942305733&amp;utm_adgroupid=100189364546&amp;utm_device=c&amp;utm_keyword=&amp;utm_matchtype=b&amp;utm_network=g&amp;utm_adpostion=&amp;utm_creative=229765585183&amp;utm_targetid=dsa-929501846124&amp;utm_loc_interest_ms=&amp;utm_loc_physical_ms=1007850&amp;gclid=CjwKCAjw_LL2BRAkEiwAv2Y3SdALDPYNKXyn5sGzUM1WRUvO9IMsB4ma5tnld1doKseWCs4X_Ig-vBoCJ3cQAvD_BwE" rel="noopener ugc nofollow" target="_blank"> <em class="mw">，上面有一些语句，这给了我们每个模型的总体准确性，加上带有精度、召回和f1分数的报告，因此我们可以更准确地比较性能。由于我们正在训练5个算法，结果将是5个报告，但是为了便于比较，我选择了具有最佳性能的两个，Random Forest和XGBoost，让我们看看它们相应的结果:</em></a></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi na"><img src="../Images/74addafac56a562e354657f219695337.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZYc322QEJD2QMUS6UVnehg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们路径的两个最佳模型:随机森林和XGBoost。</p></figure><p id="d2aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">报告看起来不错，不是吗？让我们一起来了解一下:</p><ul class=""><li id="f52e" class="nb nc it lb b lc ld lf lg li nd lm ne lq nf lu ng nh ni nj bi translated">RF的准确率为87%,而XGBoost的准确率为88%。然而，光是这些信息还不足以决定哪种模型是最好的。</li><li id="268c" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">看看f1分数栏。在这里，我们可以看到XGBoost在类别3、6和7上的表现优于Random Forest。这意味着XGBoost可以在这些类中更准确地识别真正的阳性，并且<strong class="lb iu">这是</strong>一个相关的信息，我们可以使用它来选择XGBoost作为我们今天的获胜者！</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/18cb74f5be5703e511bb1d5b815ec889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*ONoue_gIGARtOm42.gif"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">我们有一个基于公正评判的获胜者！<a class="ae ky" href="https://www.google.com/url?sa=i&amp;url=https%3A%2F%2Fgiphy.com%2Fgifs%2Fusa-reasons-pageant-b12Vdx1cZC3kY&amp;psig=AOvVaw2pC4d5rkmtZY9nRWPe_qF6&amp;ust=1590508922599000&amp;source=images&amp;cd=vfe&amp;ved=0CAIQjRxqFwoTCLj5wNWxz-kCFQAAAAAdAAAAABAN" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><h2 id="2920" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">未来的步骤</h2><p id="b8e9" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">到目前为止，我们所做的一切只是乐趣的开始！在选择了最有希望的模型之后，我们仍然需要执行更多的步骤，例如超参数调整，以提高模型的性能。根据我们目前所看到的，我们有一些关于我们可以进一步探索的线索，例如:</p><ul class=""><li id="041c" class="nb nc it lb b lc ld lf lg li nd lm ne lq nf lu ng nh ni nj bi translated">类别号2是具有最低精度和召回值的类别。也许值得尝试探索更多关于那个类的特性行为，以发现为什么我们在那里有糟糕的结果。</li><li id="3dde" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">在我们的测试集中，我们使用了大约3700个数据点，占总数的25%。如果我们增加或减少测试数据的数量，f1的分数会改变吗？</li><li id="69a4" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">如果我们更深入地挖掘数据清洗，去除离群值，并执行特征选择或降维技术，会发生什么？</li><li id="9620" class="nb nc it lb b lc nk lf nl li nm lm nn lq no lu ng nh ni nj bi translated">我们可以在循环中包含的另一个有用信息是运行每个模型的时间度量，因为它是真实项目中的一个关键因素。</li></ul><p id="d89b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">今天就到这里。如上所述，这是使用<em class="mw"> sklearn </em>和一些基本python知识对模型性能评估的非详尽介绍。非常感谢你一直关注我，请在评论中告诉我你的想法，你喜欢尝试你的机器学习模型吗？</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><p id="e6fc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你想联系，请随时通过<a class="ae ky" href="https://www.linkedin.com/in/hey-i-am-lucas/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae ky" href="https://twitter.com/lmmfrederico" rel="noopener ugc nofollow" target="_blank"> Twitter </a>联系我！</p></div></div>    
</body>
</html>