<html>
<head>
<title>The ultimate guide to A/B testing. Part 4: non-parametric tests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">A/B测试终极指南。第4部分:非参数检验</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-ultimate-guide-to-a-b-testing-part-4-non-parametric-tests-4db7b4b6a974?source=collection_archive---------17-----------------------#2020-02-25">https://towardsdatascience.com/the-ultimate-guide-to-a-b-testing-part-4-non-parametric-tests-4db7b4b6a974?source=collection_archive---------17-----------------------#2020-02-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/49253b686ab6437b8c2c9df69bfc3153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/0*PhPxRkw35qQrtzlV.jpeg"/></div></figure><p id="cfe6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">A/B测试是一种非常流行的技术，用于检查产品中的细微变化，而不会错误地考虑由外部因素引起的变化。在这一系列的文章中，我将尝试给出一个简单的关于如何设计、运行和评估a/b测试结果的操作手册，这样你就可以得到这些惊人的统计显著结果了！</p><p id="949b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><em class="kv">在部分</em> <a class="ae kw" href="https://medium.com/swlh/the-ultimate-guide-to-a-b-testing-part-1-experiment-design-8315a2470c63" rel="noopener"> <strong class="jz iu"> <em class="kv">中，一个</em> </strong> </a> <em class="kv">和</em> <a class="ae kw" rel="noopener" target="_blank" href="/the-ultimate-guide-to-a-b-testing-part-2-data-distributions-5ed429abbce"> <strong class="jz iu"> <em class="kv">两个</em> </strong> </a> <em class="kv">中，我们已经讨论了在运行a/b测试之前样本大小的估计和最常见的概率分布，它们实际上描述了您的数据是如何形成的。在</em> <a class="ae kw" rel="noopener" target="_blank" href="/the-ultimate-guide-to-a-b-testing-part-3-parametric-tests-2c629e8d98f8"> <strong class="jz iu"> <em class="kv">第三部分</em> </strong> </a> <em class="kv">中，我们谈到了两种类型的测试(参数测试和非参数测试)以及何时以及如何使用参数测试。</em></p><p id="bc48" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">如果你读了上一部分(<a class="ae kw" rel="noopener" target="_blank" href="/the-ultimate-guide-to-a-b-testing-part-3-parametric-tests-2c629e8d98f8"> <strong class="jz iu"> <em class="kv">第三部分</em> </strong> </a>)，你可能还记得我们在调查新的合作模式如何影响游戏的指标，并发现会话长度增加1分钟具有统计学意义(使用学生的T检验)。</p><p id="51af" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">因此，现在是时候检查我们的货币化指标是否有所下降，以及5%的留存增长是否显著了？</p><p id="0ee1" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">简单提醒一下A/B测试的设置:</p><blockquote class="kx ky kz"><p id="b06c" class="jx jy kv jz b ka kb kc kd ke kf kg kh la kj kk kl lb kn ko kp lc kr ks kt ku im bi translated">在过去的几年里，我们一直在开发这款令人惊叹的街机游戏，事情似乎进展得相当顺利。但在某个时候，社区开始要求合作模式。经过一些讨论后，游戏团队决定开发新的模式，并运行A/B测试来检查它如何影响指标。</p><p id="b273" class="jx jy kv jz b ka kb kc kd ke kf kg kh la kj kk kl lb kn ko kp lc kr ks kt ku im bi translated">我们对2500个用户的测试组(与控制组的规模相同)进行了A/B测试，得到了以下结果:</p><p id="fea5" class="jx jy kv jz b ka kb kc kd ke kf kg kh la kj kk kl lb kn ko kp lc kr ks kt ku im bi translated">-平均会话时间从8分钟增加到9分钟(具有统计学意义的结果)</p><p id="aa31" class="jx jy kv jz b ka kb kc kd ke kf kg kh la kj kk kl lb kn ko kp lc kr ks kt ku im bi translated">-第一天的保留率从40%增加到45%</p><p id="6cb4" class="jx jy kv jz b ka kb kc kd ke kf kg kh la kj kk kl lb kn ko kp lc kr ks kt ku im bi translated">-与此同时，转换率从2%降至1.7%</p></blockquote><p id="984c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">因此，当团队在庆祝平均会话的增长时，是时候弄清楚我们的保留和转换是否真的发生了变化，或者这些只是数据的波动。</p><p id="39e1" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">但是与平均会话长度不同，这两个指标不是正态分布的，因此需要使用非参数测试。</p><h1 id="3b8e" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">非参数检验</h1><p id="7b7d" class="pw-post-body-paragraph jx jy it jz b ka mb kc kd ke mc kg kh ki md kk kl km me ko kp kq mf ks kt ku im bi translated">非参数统计检验用于连续数据不服从正态分布或数据离散的情况，因此我们不能应用通常的参数方法，如T检验或ANOVA。</p><p id="be07" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">最受欢迎的非参数检验是<strong class="jz iu">皮尔逊卡方检验、费希尔精确检验</strong>T2检验和<strong class="jz iu">曼恩-惠特尼U检验。</strong></p><p id="04c5" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">对于我们的示例，让我们使用<strong class="jz iu">卡方</strong>来检查保持率，并使用<strong class="jz iu"> Fisher精确</strong> <strong class="jz iu">测试</strong>来进行转换(因为该指标数据非常不平衡)。</p><h1 id="d30e" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">皮尔逊卡方检验</h1><p id="4f9e" class="pw-post-body-paragraph jx jy it jz b ka mb kc kd ke mc kg kh ki md kk kl km me ko kp kq mf ks kt ku im bi translated">当您有两个或更多类别，并且想要检查它们之间是否有显著差异时，此测试仅对分类数据有效。</p><p id="57a8" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">让我们应用这个测试来检查5%的保留率增长是否具有统计学意义。</p><p id="44fe" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在我们的例子中，有两个类别:流失和回归玩家，零假设声称回归玩家的数量和新的合作模式之间没有相关性，因此回归玩家百分比的5%差异只是一个概率问题。另一种假设更乐观:我们通过增加新的游戏模式增加了留存率。</p><p id="56fc" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">首先，让我们将数据放在一个表格中，看看有哪些类别:</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mg"><img src="../Images/4795cc6786736035da5a365554e1b078.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xbC2C1NZOx0ICF3ip9FfEg.png"/></div></div></figure><p id="c9cc" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">卡方检验基于表中每个单元格的观察值和期望值之间的差异:</p><ul class=""><li id="37a8" class="mp mq it jz b ka kb ke kf ki mr km ms kq mt ku mu mv mw mx bi translated"><strong class="jz iu">观察值</strong>非常简单——这些是我们在表格中已经有的数字</li><li id="68b3" class="mp mq it jz b ka my ke mz ki na km nb kq nc ku mu mv mw mx bi translated"><strong class="jz iu">预期值</strong>是如果关于对照组和测试组之间没有差异的零假设是正确的，我们将得到的值</li></ul><p id="f995" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">因此，第二步是使用以下公式计算每个单元格的期望值:</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi nd"><img src="../Images/e7085f9d33e60c5987c6ce035b455a90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jVNEl2w4F3s_8t80O1-zEA.png"/></div></div></figure><p id="7d74" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在我们的例子中，计算看起来像这样:</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi ne"><img src="../Images/3afb82d80e6f12ffd096cffab66a2868.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xRhUzA9ItSZOC3cAHSA6xw.png"/></div></div></figure><p id="a83f" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><strong class="jz iu"> <em class="kv">注</em> </strong> <em class="kv">:因为在我们的例子中，对照组和测试组的总数相等(各为2500)，期望值也相等，但当a/b测试组的规模稍有不同时，情况就不同了。</em></p><p id="1dd5" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">让我们将结果和观察值一起放入表格中:</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi nf"><img src="../Images/3ffe278f7adfa8e5e568b55c32ccda22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dBSQ_yYfQ5uW-9AbpLKqGw.png"/></div></div></figure><p id="eef7" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在计算每个单元格的期望值后，我们最终得到卡方检验的值:</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi ng"><img src="../Images/02383dad56deb1741a529930b883b613.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CaWwc8RfcuiJTnXCv1RhKA.png"/></div></div></figure><p id="3ac3" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这里R -行数，C -表中的列数，Oij和Eij是每个单元格的观察值和期望值。</p><p id="069c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">应用该公式后，我们得到卡方等于12.79:</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi nh"><img src="../Images/459aa2afb9fd74e918c8804665d4b69d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_T1VNKDRiBrtlmxt5cl2Wg.png"/></div></div></figure><p id="60ac" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">最后一步是检查卡方的临界值，但是我们需要知道数据的自由度:每个卡方分布有不同数量的自由度，因此有不同的临界值。我们可以将其计算为(R-1)(C-1)，在我们的例子中是1。</p><p id="d61c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">所以总而言之，α = 0.05的临界值是3.841，低于我们的12.79，我们可以拒绝零假设，高兴地报告游戏性的变化让我们的留存增加了5%！</p><p id="59d8" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">测试用例得分多一个目标！2–0!在这一点上，我们可以得出结论，新的合作模式吸引了玩家，并对游戏产生了积极影响。</p><p id="c03c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">但是有了这些热情，让我们不要忘记货币化！正如我们所看到的，在测试组中，它从2%下降到了1.7%，这让董事会非常不安。</p><h1 id="3dfb" class="ld le it bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated"><strong class="ak">费雪精确的</strong> <strong class="ak">测试</strong></h1><p id="b6c4" class="pw-post-body-paragraph jx jy it jz b ka mb kc kd ke mc kg kh ki md kk kl km me ko kp kq mf ks kt ku im bi translated">Fisher精确检验是一种非参数检验，当数据集很小或类别不平衡时，它通常用作卡方检验的替代方法。</p><p id="0c84" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在我们的付费转换案例中，类别是高度不平衡的:测试组和对照组中只有1.7-2%的付费玩家，其余98%都是不付费的，所以我们可以应用Fisher的方法来检查转换从2%下降到1.7%是否真的有意义。</p><p id="dca0" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">正如卡方检验一样，Fisher检验使用表来表示所有可能的检验值，但它计算观察表中所见分布的确切概率(即p值)或甚至更极端的分布，这就是为什么它是一个“确切”的检验。</p><p id="54cb" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">与之前的测试一样，我们从表格开始:</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/24b25afff1bc4997cad2d5f7521350e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*gXaiIt73yV9UZPC1ixK8GA.png"/></div></figure><p id="6d57" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在这种情况下，零假设是测试组中玩家的付费人数与对照组相同，另一个假设是测试组中付费人数较少。</p><p id="92c2" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">费希尔检验计算出结果至少与数据一样极端，甚至更极端的概率，这意味着测试组中的支付者甚至更少。</p><p id="3aaa" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">计算概率的公式是:</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi nj"><img src="../Images/8f38aeb77aa41dd8ed98050941399eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3pjozZ1L7Jq8nqritYuGbg.png"/></div></div></figure><p id="23df" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">其中Cij是第I行第j列中的单元格，n —表格中观察值的总数。</p><p id="759c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">根据我们的数据，公式将如下所示:</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/699ffb1511ceaf8b4e16b6755a0dc35c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*4mwmTlXw1YzgFzXfWRXVmA.png"/></div></figure><p id="33cb" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">虽然<strong class="jz iu"> <em class="kv"> 5000！</em> </strong>看起来很恐怖，使用Python和Scipy库很容易计算:</p><pre class="mh mi mj mk gt nl nm nn no aw np bi"><span id="0259" class="nq le it nm b gy nr ns l nt nu">from scipy.stats import fisher_exact</span><span id="b481" class="nq le it nm b gy nv ns l nt nu">oddsratio, pvalue = fisher_exact([[50, 2450], [42, 2458]])</span></pre><p id="baa0" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">p值等于0.86，高于临界0.05，因此我们不能拒绝零假设，并愉快地报告转化率下降0.3%在统计上不显著。</p><p id="84f0" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我们可以得出结论，实验的结果非常好:从一个角度来看，我们的参与度有所增长，从另一个角度来看，货币化的减少并不明显，这对于业务来说是至关重要的，因此该功能可以推广到所有受众。</p><p id="166b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">话虽如此，我们已经讨论了最流行的参数和非参数统计方法，是时候来点概率性的了…所以下次我们将讨论贝叶斯测试。敬请期待！</p></div></div>    
</body>
</html>