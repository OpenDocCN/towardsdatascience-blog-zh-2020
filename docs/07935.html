<html>
<head>
<title>RNNs vs Traditional ML for Predictive Customer Lifetime Value</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">RNNs与传统ML在预测客户终身价值方面的比较</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/rnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe?source=collection_archive---------29-----------------------#2020-06-12">https://towardsdatascience.com/rnns-vs-traditional-ml-for-predictive-customer-lifetime-value-42b6b12558fe?source=collection_archive---------29-----------------------#2020-06-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="529d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">比较序列和贝叶斯方法预测未来收入</h2></div><p id="5a00" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我工作的公司RETINA.ai建立了ML模型来预测客户的终身价值(CLV)。我们的数据科学团队一直致力于利用最好的学术和行业研究来完善和改进这些模型。本文描述了我们使用递归神经网络(RNNs)预测CLV的结果。</p><p id="042d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为RETINA的客户需要从战略和战术两方面了解他们的客户，所以我们在宏观(群体层面)和微观(客户层面)购买模式上构建和测试我们的模型。我们将此作为评估模型性能的基础，这样我们就可以不断地迭代我们的模型。</p><p id="620c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇博文中，我们将展示RNN-LSTM(具有长/短期记忆的递归神经网络)机器学习模型如何能够像其他行业领先的模型一样准确地预测CLV。</p><h1 id="84c6" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">语境</h1><p id="2f32" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">为了建立一个预测性的CLV模型，我们从客户交易历史开始。我们输入到模型中的数据集可能如下所示:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mb"><img src="../Images/79560bde45f8cced812713d892cadd06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IDlolMadWKTcrsAxzXrOPg.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">订单表示例</p></figure><p id="8a48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从这个交易表中，我们不仅可以确定CLV，还可以预测每个客户的未来交易——并且，我们可以用一个<strong class="kk iu">时间模式图</strong>来直观显示这一点:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mr"><img src="../Images/5b3fcec051c40cd8bb8ba6a37b2a53d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D5T3ndby0lQqjDGzUvxbBg.png"/></div></div></figure><p id="02c7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上图显示了我们交易表中的每笔交易以及预测的未来交易:</p><ul class=""><li id="e2cd" class="ms mt it kk b kl km ko kp kr mu kv mv kz mw ld mx my mz na bi translated">垂直的灰线标志着今天</li><li id="7e11" class="ms mt it kk b kl nb ko nc kr nd kv ne kz nf ld mx my mz na bi translated">水平灰线代表个人客户</li><li id="badc" class="ms mt it kk b kl nb ko nc kr nd kv ne kz nf ld mx my mz na bi translated">黑点是我们交易历史中的交易</li><li id="18a2" class="ms mt it kk b kl nb ko nc kr nd kv ne kz nf ld mx my mz na bi translated">灰点是我们的模型预测的交易</li></ul><p id="6b48" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">除了预测交易数量，我们的模型还预测这些未来交易的平均收入值。当我们知道每笔未来交易的价格和交易量时，我们可以很容易地计算出客户的CLV。</p><h1 id="5b08" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">评估模型</h1><p id="072d" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">但是我们如何产生这些预测的交易和收入呢？更重要的是，我们如何知道它们有多精确？</p><p id="3bc5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，我们将交易历史数据分成两个数据集。我们通过确定数据集中最早的交易和最近的交易之间的大约80%的日期来实现这一点。在此日期当天或之前发生的事务是校准期的一部分，之后发生的事务是保持期的一部分。之所以这样命名这些数据集，是因为校准期间的数据被输入到模型中进行校准，而维持期间的数据被故意保留下来以测试模型的预测能力。</p><p id="b9be" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果一个模型可以使用校准期提供的数据准确预测维持期的数据，那么我们知道它是一个强模型。</p><h1 id="adb7" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">比较模型</h1><p id="9afc" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">用于计算CLV的常见模型是帕累托/NBD模型，尽管视网膜目前使用帕累托/GGG模型，这是对帕累托/NBD模型的改进。帕累托/GGG模型之所以成为如此强大的CLV模型，是因为它创建了三个伽玛分布来确定客户交易间隔时间(ITT)和流失概率。如果你想更深入地探索它，你可以在<a class="ae ng" href="http://www.reutterer.com/papers/platzer&amp;reutterer_pareto-ggg_2016.pdf" rel="noopener ugc nofollow" target="_blank">原始论文</a>或<a class="ae ng" href="https://cran.r-project.org/web/packages/BTYD/vignettes/BTYD-walkthrough.pdf" rel="noopener ugc nofollow" target="_blank"> BTYD包中阅读更多关于这个模型的内容。</a></p><p id="d22b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，Retina团队还开发了一个更新的模型，目前正在与帕累托/GGG进行比较。它被称为长短期记忆递归神经网络模型(RNN-LSTM)。这个模型接受一系列事件，寻找这些事件中导致现在的模式，这使它能够预测未来。我们向模型提供客户交易历史，希望它能够学习我们案例中的未来交易。</p><h1 id="95fd" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">结果</h1><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/5d575370180ed8791c46860620ec2fa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*D4MfqOBszsoJCCc-vaeBZA.gif"/></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">重演RNNs和PGGG之间的对决</p></figure><p id="f501" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过使用上面概述的校准/维持技术，我们能够看到每个模型的预测强度。我们还包括了额外的帕累托家族模型(BG/NBD和NBD)来为我们的结果提供背景。这是我们实验的结果:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi ni"><img src="../Images/16d4a4a9e77ce783a1e216078844137c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0JAnHSsh6k1K_a2mSKneKQ.png"/></div></div><p class="mn mo gj gh gi mp mq bd b be z dk translated">我们测试的所有模型的聚合CLV统计数据</p></figure><p id="2a8a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当我们将维持期内的实际事务数量与每个模型预测的数量进行比较时，我们可以看到每个模型的表现如何。上表按平均绝对误差(MAE)排序，即每个客户的预测交易数和实际交易数之间的平均差异。</p><p id="4170" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">除了NBD，统计模型在这一指标上都表现强劲(与真实值的偏差小于10%)。这意味着他们能够在总体水平上成功捕捉客户购买趋势。有趣的是，我们的RNN-LSTM模型是唯一低估抵制交易总数的模型。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nj"><img src="../Images/a6682ea75e8f7b278d0cd3d70ccf64da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*arHc692637k_aDSY_cQq7w.png"/></div></div></figure><p id="1b85" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该图比较了RNN-LSTM和帕累托/GGG在每个客户不同采购金额上的准确性:</p><p id="e540" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这张图表表明，RNN-LSTM法案严重低估了流失的客户(在抵制期没有购买任何东西的客户),并高估了3-4个购买客户。帕累托/GGG也低估了流失客户，高估了3-4个购买客户，但程度较轻。</p><h1 id="098a" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">讨论</h1><p id="4aa5" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">起初，帕累托/NBD似乎预测了接近完美的交易数量，这种准确性是由于预测的交易总数。正如我们在计算MAE时看到的，帕累托/NBD在个人层面上的表现实际上比帕累托/GGG和RNN-LSTM更差。在个人层面，CLV是一个更具可操作性的指标，因此我们决定将进一步分析的重点放在这两个模型上。</p><p id="dbc3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">回到我们的CLV拳击赛:当使用MAE时，帕累托/GGG胜过RNN-LSTM，但不是很多。这些结果是令人兴奋的，因为它不仅证明了帕累托/GGG的优越性，而且证明了RNN-LSTM作为CLV计算的竞争者的有效性。</p><p id="c2f2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在考虑哪种模型更优越时，有两个概念变得与我们的结果无关，应该加以讨论:可扩展性和解释能力。</p><p id="1cdd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">RNN-LSTM是CLV计算的一个强有力的选择，因为它是可扩展的。与帕累托/GGG不同，RNN-LSTM采用了大量可以由运行模型的数据科学家定制和聚合的功能。这意味着RNN-LSTM可以通过网站访问、电子邮件，甚至特定的行业趋势获得信息，以创建越来越智能的迭代。</p><p id="0f1d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于其解释能力，帕累托/GGG是CLV计算的一个强有力的选择。与RNN-LSTM法案不同，后者在理解<em class="nk">为什么</em>做出某种预测方面本质上是一个黑匣子，帕累托/GGG允许数据科学家理解模型做出的预测背后的底层框架。如果该模型似乎低估了流失客户，我们可以得出结论，这是一个过于乐观的流失预测伽马函数的函数。因此，当模型准确或比其他模型更好时，我们可以对<em class="nk">为什么</em>是更强的模型更有信心。对于机器学习模型，我们没有这种奢侈。</p><h1 id="dd50" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated">后续步骤</h1><p id="86a9" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">最后，有几个步骤将是建立在这些结果之上的激动人心的实验。我们热衷于尝试的一些未来迭代是:</p><ol class=""><li id="7808" class="ms mt it kk b kl km ko kp kr mu kv mv kz mw ld nl my mz na bi translated">预测维持中事务的<em class="nk">值</em>而不是数量，并在此指标上比较模型</li><li id="0436" class="ms mt it kk b kl nb ko nc kr nd kv ne kz nf ld nl my mz na bi translated">向RNN-LSTM模型添加额外的相关特征，看看新架构是否明显优于帕累托家族模型</li><li id="7e99" class="ms mt it kk b kl nb ko nc kr nd kv ne kz nf ld nl my mz na bi translated">调整RNN-LSTM的超参数，以观察更智能的超参数选择是否会产生更好的模型</li><li id="96b0" class="ms mt it kk b kl nb ko nc kr nd kv ne kz nf ld nl my mz na bi translated">修改帕累托/GGG输出以生成绘制的交易序列，以便与RNN-LSTM的预测能力进行直接比较</li></ol></div></div>    
</body>
</html>