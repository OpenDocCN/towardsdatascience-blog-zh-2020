<html>
<head>
<title>Chi-Squared Test for Feature Selection with implementation in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">特征选择的卡方检验及其 Python 实现</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/chi-squared-test-for-feature-selection-with-implementation-in-python-65b4ae7696db?source=collection_archive---------5-----------------------#2020-02-11">https://towardsdatascience.com/chi-squared-test-for-feature-selection-with-implementation-in-python-65b4ae7696db?source=collection_archive---------5-----------------------#2020-02-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d165" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><span class="l ki kj kk bm kl km kn ko kp di">一个</span>统计测试，用于识别两个变量之间的关联/关系及其在 Python 中的实现。</h2></div><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi kq"><img src="../Images/951bc863d3179c463214d8ce2db2e79f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*AFoMeLFaiQUDjrr8duwhTw.jpeg"/></div><p class="ky kz gj gh gi la lb bd b be z dk translated">图片提供:全菲尼克斯，[Pinterest 邮报]。于 2020 年 2 月 13 日从 https://in.pinterest.com/pin/641059328193274870/<a class="ae lc" href="https://in.pinterest.com/pin/641059328193274870/" rel="noopener ugc nofollow" target="_blank">检索</a></p></figure><h2 id="2882" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">简介:</h2><p id="a0ff" class="pw-post-body-paragraph lz ma it mb b mc md ju me mf mg jx mh lm mi mj mk lq ml mm mn lu mo mp mq mr im bi translated">机器学习中有各种技术来确定我们的输入特征是否与要预测的结果相关。我们可以使用这些技术找出并删除对模型结果没有贡献的不重要的特性。在某种程度上，我们只选择那些真正重要的特征，因此这些技术被称为特征选择方法。卡方检验可用于特征选择。让我们深入细节。</p><h2 id="73a5" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">特征选择方法:</h2><p id="361d" class="pw-post-body-paragraph lz ma it mb b mc md ju me mf mg jx mh lm mi mj mk lq ml mm mn lu mo mp mq mr im bi translated">确定特征重要性的方法有很多，主要分为两组:</p><p id="68c3" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">1) <strong class="mb iu">过滤器特征选择方法</strong> <br/> 2) <strong class="mb iu">包装器特征选择方法</strong></p><p id="dfe7" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">我们将只看到第一个，因为我们的卡方检验属于这一类。</p><p id="8870" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">简而言之，<strong class="mb iu">滤波器特征选择方法</strong>是那些使用一些统计技术(如卡方检验)考虑输入和目标变量的数据类型来评估它们之间关系的方法。</p><p id="88d5" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">有许多其他的统计测量可用于基于过滤器的特征选择。因此，统计测量的选择高度依赖于特征和目标变量数据类型。</p><blockquote class="mx my mz"><p id="732f" class="lz ma na mb b mc ms ju me mf mt jx mh nb mu mj mk nc mv mm mn nd mw mp mq mr im bi translated">数据类型可以是数字的，也可以是分类的。</p></blockquote><h2 id="0bc1" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">何时使用卡方检验:</strong></h2><p id="e978" class="pw-post-body-paragraph lz ma it mb b mc md ju me mf mg jx mh lm mi mj mk lq ml mm mn lu mo mp mq mr im bi translated">当要测试的特征的数据类型和目标变量都是分类的(即我们有一个分类问题)时，我们可以使用卡方检验。</p><h2 id="4374" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">卡方检验解释道:</h2><p id="f99a" class="pw-post-body-paragraph lz ma it mb b mc md ju me mf mg jx mh lm mi mj mk lq ml mm mn lu mo mp mq mr im bi translated">皮尔逊卡方检验，或简称卡方检验，是以数学家<a class="ae lc" href="https://en.wikipedia.org/wiki/Karl_Pearson" rel="noopener ugc nofollow" target="_blank"> <strong class="mb iu">卡尔·皮尔逊</strong> </a> <strong class="mb iu">命名的。</strong>它也被称为<strong class="mb iu">“拟合优度”</strong>统计量。</p><p id="d177" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">让我们看看如何进行这个测试，以及<strong class="mb iu"> 8 个简单步骤</strong>中的一个例子。</p><p id="4b25" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">例如，让我们考虑一个只有两列的非常简单的数据集。我们将发现性别是否与对运动的兴趣相关/依赖/联系在一起。</p><pre class="kr ks kt ku gt ne nf ng nh aw ni bi"><span id="f324" class="ld le it nf b gy nj nk l nl nm">╔════════╦══════════╗<br/>║ Gender ║ Interest ║<br/>╠════════╬══════════╣<br/>║ Male   ║ Cricket  ║<br/>║ Female ║ Tennis   ║<br/>║ Male   ║ Cricket  ║<br/>║ Male   ║ Football ║<br/>║ ....   ║ ....     ║<br/>╚════════╩══════════╝</span></pre><h2 id="7070" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">步骤 1:定义假设</h2><p id="db32" class="pw-post-body-paragraph lz ma it mb b mc md ju me mf mg jx mh lm mi mj mk lq ml mm mn lu mo mp mq mr im bi translated">假设检验是一种统计方法，它评估两个陈述(假设)并确定哪个陈述是正确的。在假设检验中，最初的陈述被称为<strong class="mb iu">零假设</strong>，表示为<strong class="mb iu"> H0 </strong>，通常与第一个陈述互补的第二个陈述被称为<strong class="mb iu">替代假设</strong>，表示为<strong class="mb iu"> H1。</strong></p><p id="7ed6" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">对于我们的例子，假设是:<br/> <strong class="mb iu"> H0: </strong>特征<strong class="mb iu">性别</strong>和<strong class="mb iu">兴趣</strong>是<strong class="mb iu">独立</strong>(也就是说它们没有关联)。<br/> <strong class="mb iu"> H1: </strong> <strong class="mb iu">性别</strong>和<strong class="mb iu">兴趣</strong>是<strong class="mb iu">不是独立的</strong>(也就是说它们是关联的)。</p><h2 id="7577" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">第二步:选择一个重要级别</h2><p id="796d" class="pw-post-body-paragraph lz ma it mb b mc md ju me mf mg jx mh lm mi mj mk lq ml mm mn lu mo mp mq mr im bi translated">基本上，由α (alpha)表示的显著性水平是我们希望对我们的结果有多确定的度量。</p><p id="578f" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">或者简单地说，显著性水平用于确定是否应该拒绝零假设。对于要拒绝的零假设，p 值<em class="na"/><em class="na">(稍后解释)</em>应小于显著性水平。</p><p id="a537" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">较低的α值通常是优选的，可以在 0.01 至 0.10 的范围内。</p><p id="cb03" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">我们选择<strong class="mb iu"> α = 0.05 </strong></p><h2 id="f241" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">步骤 3:创建列联表</h2><p id="0b12" class="pw-post-body-paragraph lz ma it mb b mc md ju me mf mg jx mh lm mi mj mk lq ml mm mn lu mo mp mq mr im bi translated">以行和列显示一个变量和另一个变量的频率分布的表格，用于研究两个变量之间的相关性，称为列联表(也称为交叉制表或交叉表)。看到下表后你会更清楚:</p><pre class="kr ks kt ku gt ne nf ng nh aw ni bi"><span id="e5ba" class="ld le it nf b gy nj nk l nl nm">╔══════════════╦═════════╦══════════╦════════╦═══════════╗<br/>║              ║ Cricket ║ Football ║ Tennis ║ Row Total ║<br/>╠══════════════╬═════════╬══════════╬════════╬═══════════╣<br/>║ Male         ║      20 ║       30 ║     15 ║        65 ║<br/>║ Female       ║      20 ║       15 ║     30 ║        65 ║<br/>║ Column Total ║      40 ║       45 ║     45 ║       130 ║<br/>╚══════════════╩═════════╩══════════╩════════╩═══════════╝</span></pre><p id="05d7" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">我们可以看到，在数据集中的 130 名候选人中，分别有 20 名、30 名和 15 名男性对板球、足球和网球感兴趣。同样，分别有 20、15 和 30 名女性对板球、足球和网球感兴趣。</p><p id="74a7" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">表中的值称为<strong class="mb iu">观察值。</strong></p><h2 id="2d18" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">步骤 4:计算预期频率</h2><p id="d29d" class="pw-post-body-paragraph lz ma it mb b mc md ju me mf mg jx mh lm mi mj mk lq ml mm mn lu mo mp mq mr im bi translated">我们计算每个单元的预期频率计数。计算预期频率的公式为:</p><pre class="kr ks kt ku gt ne nf ng nh aw ni bi"><span id="0fa9" class="ld le it nf b gy nj nk l nl nm">E = (row total * column total)/grand total</span></pre><p id="c1ea" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">第一个细胞(即雄性蟋蟀)的预期频率为:</p><pre class="kr ks kt ku gt ne nf ng nh aw ni bi"><span id="3d89" class="ld le it nf b gy nj nk l nl nm">E₁ = (65 * 40)/130 = <strong class="nf iu">20</strong></span></pre><p id="fb78" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">我们计算其余单元的预期频率，并得到下表，其中括号<strong class="mb iu"> '[]' </strong>中的值表示预期频率:</p><pre class="kr ks kt ku gt ne nf ng nh aw ni bi"><span id="687d" class="ld le it nf b gy nj nk l nl nm">╔══════════════╦═════════╦════════════╦═══════════╦═══════════╗<br/>║              ║ Cricket ║  Football  ║  Tennis   ║ Row Total ║<br/>╠══════════════╬═════════╬════════════╬═══════════╬═══════════╣<br/>║ Male         ║ 20 [20] ║  30 [22.5] ║ 15 [22.5] ║        65 ║<br/>║ Female       ║ 20 [20] ║  15 [22.5] ║ 30 [22.5] ║        65 ║<br/>║ Column Total ║ 40      ║ 45         ║ 45        ║       130 ║<br/>╚══════════════╩═════════╩════════════╩═══════════╩═══════════╝</span></pre><h2 id="4e10" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">步骤 5:计算卡方值或</strong>卡方统计</h2><p id="cc52" class="pw-post-body-paragraph lz ma it mb b mc md ju me mf mg jx mh lm mi mj mk lq ml mm mn lu mo mp mq mr im bi translated">计算卡方值或χ的公式为:</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/786205e3cb92f81f25ccd9efe02a5c6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/0*WmH7GM_lCsqpBLiF.png"/></div></figure><p id="1721" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">其中χ不是我们所知道的英语 aphabet 而是第 22 个希腊字母<a class="ae lc" href="https://en.wikipedia.org/wiki/Chi_(letter)" rel="noopener ugc nofollow" target="_blank"> Chi </a>。<br/>如图所示，χ是所有小区的观测频率和预期频率之间的平方差除以预期频率的总和。计算结果如下所示:</p><pre class="kr ks kt ku gt ne nf ng nh aw ni bi"><span id="923c" class="ld le it nf b gy nj nk l nl nm"><strong class="nf iu">Χ² = ((20-20)^2/20) + ((30-22.5)^2/22.5) + ((15-22.5)^2/22.5) + ((20-20)^2/20) + ((15-22.5)^2/22.5) + ((30-22.5)^2/22.5)</strong></span><span id="9480" class="ld le it nf b gy no nk l nl nm"><strong class="nf iu">Χ² = 0 + 2.5 + 2.5 + 0 + 2.5 + 2.5</strong></span><span id="70cd" class="ld le it nf b gy no nk l nl nm"><strong class="nf iu">Χ² = 10</strong></span></pre><h2 id="218d" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">步骤 6:计算自由度</h2><p id="e875" class="pw-post-body-paragraph lz ma it mb b mc md ju me mf mg jx mh lm mi mj mk lq ml mm mn lu mo mp mq mr im bi translated">自由度可以计算如下:</p><pre class="kr ks kt ku gt ne nf ng nh aw ni bi"><span id="75df" class="ld le it nf b gy nj nk l nl nm">df = (total_rows - 1) * (total_cols - 1)</span></pre><p id="abb7" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">列联表中有<strong class="mb iu"> 2 行</strong>和<strong class="mb iu"> 3 列</strong>，因此我们的自由度是<strong class="mb iu"> 2。</strong></p><h2 id="02af" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">第七步:寻找 p 值</h2><p id="de5d" class="pw-post-body-paragraph lz ma it mb b mc md ju me mf mg jx mh lm mi mj mk lq ml mm mn lu mo mp mq mr im bi translated">我们可以看到像<a class="ae lc" href="http://kisi.deu.edu.tr/joshua.cowley/Chi-square-table.pdf" rel="noopener ugc nofollow" target="_blank">这样的卡方分布表，这个</a>使用卡方和自由度值找到 p 值。</p><p id="86b2" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">如果您打开了到表的<a class="ae lc" href="http://kisi.deu.edu.tr/joshua.cowley/Chi-square-table.pdf" rel="noopener ugc nofollow" target="_blank">链接，选择左边的自由度值(2)，沿着它的行找到最接近卡方值(10)的数字，然后检查第一行中的相应数字，得到 p 值 0.005</a></p><p id="1293" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">也有一些网站像<a class="ae lc" href="https://www.socscistatistics.com/pvalues/chidistribution.aspx" rel="noopener ugc nofollow" target="_blank">这个</a>一样为你计算 p 值。<br/>这里我们得到的 p 值为. 0067，我们可以使用其中任何一个，让我们继续使用从表中得到的那个。</p><h2 id="11f7" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">步骤 8: <strong class="ak">决定是拒绝还是保留我们的零假设</strong></h2><p id="38c6" class="pw-post-body-paragraph lz ma it mb b mc md ju me mf mg jx mh lm mi mj mk lq ml mm mn lu mo mp mq mr im bi translated">简而言之，如果我们的<strong class="mb iu"> p 值小于显著性值</strong>，我们<strong class="mb iu">拒绝</strong>零假设，如果我们的<strong class="mb iu"> p 值大于显著性值</strong>，我们<strong class="mb iu">不拒绝它</strong>。</p><p id="e88a" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">由于 0.005 小于我们的显著性值 0.05，我们拒绝零假设，这意味着性别和感兴趣的运动之间存在关联。</p><h2 id="c0fb" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用 python 实现</h2><pre class="kr ks kt ku gt ne nf ng nh aw ni bi"><span id="24d6" class="ld le it nf b gy nj nk l nl nm"># required imports<br/>from scipy.stats import chi2_contingency</span><span id="98c7" class="ld le it nf b gy no nk l nl nm"># we create contingency table same as above<br/>table = [[20, 30, 15], [20,  15,  30]]</span><span id="6654" class="ld le it nf b gy no nk l nl nm"># Get chi-square value , p-value, degrees of freedom, expected frequencies using the function <strong class="nf iu">chi2_contingency</strong><br/>stat, p, dof, expected = chi2_contingency(table)</span><span id="d8c4" class="ld le it nf b gy no nk l nl nm"># select significance value<br/>alpha = 0.05</span><span id="14a4" class="ld le it nf b gy no nk l nl nm"># Determine whether to reject or keep your null hypothesis<br/>print('significance=%.3f, p=%.3f' % (alpha, p))<br/>if p &lt;= alpha:<br/>    print('Variables are associated (reject H0)')<br/>else:<br/>    print('Variables are not associated(fail to reject H0)')</span></pre><p id="23ff" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">为了简单起见，我创建了一个列联表。要从数据帧列中创建列联表，可以使用<a class="ae lc" href="https://pandas.pydata.org/pandas-docs/stable/getting_started/overview.html" rel="noopener ugc nofollow" target="_blank"> pandas </a>中的<a class="ae lc" href="https://www.geeksforgeeks.org/contingency-table-in-python/" rel="noopener ugc nofollow" target="_blank">交叉表</a>函数。</p><h2 id="acc2" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">摘要</h2><p id="5e7b" class="pw-post-body-paragraph lz ma it mb b mc md ju me mf mg jx mh lm mi mj mk lq ml mm mn lu mo mp mq mr im bi translated">我们已经看到了如何进行卡方检验来检查两个分类变量之间是否存在某种关系。</p><p id="e716" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">用很少几行代码我们就可以使用 Python 的<strong class="mb iu"> scipy </strong>库实现这个测试。</p><p id="9cdc" class="pw-post-body-paragraph lz ma it mb b mc ms ju me mf mt jx mh lm mu mj mk lq mv mm mn lu mw mp mq mr im bi translated">希望你喜欢。建议总是受欢迎的。</p><h2 id="5ecf" class="ld le it bd lf lg lh dn li lj lk dp ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">参考资料:</h2><div class="np nq gp gr nr ns"><a href="https://machinelearningmastery.com/chi-squared-test-for-machine-learning/" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">机器学习的卡方检验简介</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">应用机器学习中的一个常见问题是确定输入特征是否与输出相关</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">machinelearningmastery.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kw ns"/></div></div></a></div><div class="np nq gp gr nr ns"><a href="https://en.wikipedia.org/wiki/Chi-squared_test" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd iu gy z fp nx fr fs ny fu fw is bi translated">卡方检验</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">术语“卡方检验”，也写作，指的是某些类型的统计假设检验是有效的…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">en.wikipedia.org</p></div></div><div class="ob l"><div class="oh l od oe of ob og kw ns"/></div></div></a></div></div></div>    
</body>
</html>