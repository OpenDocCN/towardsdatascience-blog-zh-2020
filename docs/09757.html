<html>
<head>
<title>Building a Neural Network with Tensorflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Tensorflow 构建神经网络</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-an-ann-with-tensorflow-ec9652a7ddd4?source=collection_archive---------8-----------------------#2020-07-11">https://towardsdatascience.com/building-an-ann-with-tensorflow-ec9652a7ddd4?source=collection_archive---------8-----------------------#2020-07-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a65f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用 TensorFlow 构建神经网络的分步教程</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c5a099cbc5a9134cbbc85e7d64dac314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7xSVgBRPnKkcxoOynn8BFw.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">在<a class="ae kv" href="https://unsplash.com/s/photos/science?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae kv" href="https://unsplash.com/@halacious?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">halance</a>拍摄的照片</p></figure><p id="fe01" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你是人工神经网络的新手，你可以在下面的链接中查看我的关于人工神经网络介绍的博客</p><div class="ls lt gp gr lu lv"><a rel="noopener follow" target="_blank" href="/introduction-to-artificial-neural-networks-ac338f4154e5"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">人工神经网络导论</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">你深度学习的第一步</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">towardsdatascience.com</p></div></div><div class="me l"><div class="mf l mg mh mi me mj kp lv"/></div></div></a></div><p id="49fb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本教程中，我们将在时尚 MNIST 数据集上构建一个人工神经网络，该数据集由 70，000 幅图像组成，其中 60，000 幅图像属于训练集，10，000 幅图像属于测试集。每幅图像高 28 像素，宽 28 像素，总共 784 像素，有 10 个标签与之相关联。像素值是 0 到 255 之间的整数。每行是一个单独的图像，我们有 785 个列标签，包括一个类标签。在该数据集中，每个图像都与下面提到的一个标签相关联。</p><ul class=""><li id="daf4" class="mk ml iq ky b kz la lc ld lf mm lj mn ln mo lr mp mq mr ms bi translated">0 → T 恤/上衣</li><li id="d96a" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">1 →裤子</li><li id="5942" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">2 →套头衫</li><li id="ca3c" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">3 →着装</li><li id="9088" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">4 →外套</li><li id="3ca5" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">5 →凉鞋</li><li id="7ca8" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">6 →衬衫</li><li id="6f67" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">7 →运动鞋</li><li id="5820" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">8 →包</li><li id="e540" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">9 →踝靴</li></ul><h1 id="5fe2" class="my mz iq bd na nb nc nd ne nf ng nh ni jw nj jx nk jz nl ka nm kc nn kd no np bi translated">安装 Tensorflow</h1><p id="df26" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">如果你的 PC 或笔记本电脑没有 GPU，你可以使用 Google Colab，或者使用 Jupyter Notebook。如果您使用您的系统，请升级 pip，然后安装 TensorFlow，如下所示</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/40b477bbe77b182f96efc139b1600fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:792/format:webp/1*MlmQMfxVWl44u8dxwclDFQ.jpeg"/></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">tensorflow.org</p></figure><h1 id="137c" class="my mz iq bd na nb nc nd ne nf ng nh ni jw nj jx nk jz nl ka nm kc nn kd no np bi translated">导入依赖项</h1><p id="a362" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">在上面几行代码中，我只是导入了这个过程中需要的所有库</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h1 id="e3f4" class="my mz iq bd na nb nc nd ne nf ng nh ni jw nj jx nk jz nl ka nm kc nn kd no np bi translated">数据再处理</h1><h2 id="1dae" class="ny mz iq bd na nz oa dn ne ob oc dp ni lf od oe nk lj of og nm ln oh oi no oj bi translated">加载数据集</h2><p id="9a41" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">这里我们将使用<strong class="ky ir"> load_data() </strong>方法加载时尚 mnist 数据集。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="f64e" class="ny mz iq bd na nz oa dn ne ob oc dp ni lf od oe nk lj of og nm ln oh oi no oj bi translated">正常化</h2><p id="fb93" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">这里，我们将每个图像除以最大像素数(255)，这样图像范围将在 0 和 1 之间。我们将图像标准化，以便我们的人工神经网络模型训练得更快。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="0ab6" class="ny mz iq bd na nz oa dn ne ob oc dp ni lf od oe nk lj of og nm ln oh oi no oj bi translated">重塑</h2><p id="561d" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">我们将得到一个 2d 数组作为输出，其中第一维对应于图像的索引，第二维是包含图像所有像素的向量</p><p id="c37f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在二维数组中，我们将使用整形将二维数组转换为一维向量。这里我们传递两个参数</p><ul class=""><li id="e419" class="mk ml iq ky b kz la lc ld lf mm lj mn ln mo lr mp mq mr ms bi translated">-1 →我们需要重塑所有的形象</li><li id="a1d0" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">28*28 →合成矢量的大小(784 像素→ 1D)</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d71ac8834a030e94f710e0040e9e2d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C1BQQ1oDl6_hDyKLqgIzHQ.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@nasa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> NASA </a>在<a class="ae kv" href="https://unsplash.com/s/photos/science?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="e70c" class="my mz iq bd na nb nc nd ne nf ng nh ni jw nj jx nk jz nl ka nm kc nn kd no np bi translated">建筑安</h1><p id="ddc0" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">在建立模型之前，我们需要做的第一件事是创建一个模型对象本身，这个对象将是一个名为 Sequential 的类的实例。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="6df0" class="ny mz iq bd na nz oa dn ne ob oc dp ni lf od oe nk lj of og nm ln oh oi no oj bi translated">添加第一个完全连接的层</h2><p id="d7ae" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">如果你不知道层的类型和它们的功能，我建议你看看我的博客《人工神经网络导论》,它让你知道你应该知道的大部分概念。</p><p id="27a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">超参数:</p><ul class=""><li id="08ac" class="mk ml iq ky b kz la lc ld lf mm lj mn ln mo lr mp mq mr ms bi translated">神经元数量:128</li><li id="64af" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">激活功能:ReLU</li><li id="3054" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">输入 _ 形状:(784，)</li></ul><p id="02ee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这意味着该操作的输出应该具有 128 个神经元，其中我们应用 ReLU 激活函数来打破线性，并且 input_shape 是(784，)。我们使用<strong class="ky ir"> model.add() </strong>方法添加所有这些超参数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="b741" class="ny mz iq bd na nz oa dn ne ob oc dp ni lf od oe nk lj of og nm ln oh oi no oj bi translated">添加辍学层</h2><p id="fad9" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">这是一种正则化技术，我们将一层中的神经元随机设置为零。这样，某些百分比的神经元将不会被更新，整个训练过程是漫长的，我们有更少的机会过度拟合。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="fcdd" class="ny mz iq bd na nz oa dn ne ob oc dp ni lf od oe nk lj of og nm ln oh oi no oj bi translated">添加输出图层</h2><ul class=""><li id="bc13" class="mk ml iq ky b kz nq lc nr lf ok lj ol ln om lr mp mq mr ms bi translated">单位=课程数量(MNIST 时装公司为 10)</li><li id="424a" class="mk ml iq ky b kz mt lc mu lf mv lj mw ln mx lr mp mq mr ms bi translated">activation = softmax(返回类的概率)</li></ul><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="4a4a" class="ny mz iq bd na nz oa dn ne ob oc dp ni lf od oe nk lj of og nm ln oh oi no oj bi translated">编译模型</h2><p id="5f13" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">这意味着我们必须将整个网络连接到一个优化器，并选择一个损失。优化器是一种工具，它将在随机梯度下降过程中更新权重，即将您的损失反向传播到神经网络中。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="0f8d" class="ny mz iq bd na nz oa dn ne ob oc dp ni lf od oe nk lj of og nm ln oh oi no oj bi translated">训练模型</h2><p id="1425" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">我们使用 model.fit()方法来训练模型，我们在方法内部传递三个参数，它们是</p><p id="2512" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输入→ x_train 是馈入网络的输入</p><p id="ca7e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">输出→这包含 x_train(即 y_train)的正确答案</p><p id="750c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">次数→表示您要用数据集训练网络的次数。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="4b9b" class="ny mz iq bd na nz oa dn ne ob oc dp ni lf od oe nk lj of og nm ln oh oi no oj bi translated">评估模型</h2><p id="6db1" class="pw-post-body-paragraph kw kx iq ky b kz nq jr lb lc nr ju le lf ns lh li lj nt ll lm ln nu lp lq lr ij bi translated">我们将通过将模型应用于测试集来评估模型的性能。这里，evaluate 方法返回两个参数，一个是预测在测试集中引起的损失，另一个是准确性。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/231f2de5960b289c72965a4a4fb8b97e.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*ufEudIf3R6CwBkna630Rgw.jpeg"/></div></figure><p id="0375" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的数据达到了 87.2%的准确率。目前就这些，希望你实现了你的第一个深度学习模型。在我的下一篇博客中，我们将一起使用卷积神经网络实现 MNIST 模型。如果你想知道卷积神经网络的概念，可以看看我下面的博客</p><div class="ls lt gp gr lu lv"><a href="https://medium.com/dataseries/introduction-to-convolutional-neural-networks-5a227f61dd50" rel="noopener follow" target="_blank"><div class="lw ab fo"><div class="lx ab ly cl cj lz"><h2 class="bd ir gy z fp ma fr fs mb fu fw ip bi translated">卷积神经网络简介</h2><div class="mc l"><h3 class="bd b gy z fp ma fr fs mb fu fw dk translated">关于卷积神经网络如何工作的直觉</h3></div><div class="md l"><p class="bd b dl z fp ma fr fs mb fu fw dk translated">medium.com</p></div></div><div class="me l"><div class="oo l mg mh mi me mj kp lv"/></div></div></a></div></div></div>    
</body>
</html>