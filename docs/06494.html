<html>
<head>
<title>Upgrade your Nvidia GPU Drivers for a Better Performance 🚀</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">升级您的 Nvidia GPU 驱动程序以获得更好的性能🚀</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/upgrade-your-nvidia-gpu-drivers-for-a-better-performance-52818ad7ee8d?source=collection_archive---------27-----------------------#2020-05-23">https://towardsdatascience.com/upgrade-your-nvidia-gpu-drivers-for-a-better-performance-52818ad7ee8d?source=collection_archive---------27-----------------------#2020-05-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="729b" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">你的训练不稳定？考虑将 Cuda 升级到最新版本</h2></div><p id="d4dd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我有一个运行在 Ubuntu 16.04 发行版和 Nvidia 1080 TI 上的 GPU 服务器。2018 年买的，到今天还在用 Cuda 9.0，驱动版本 384.130。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/30aaed75b1214c16d8dc8d103e2d8dca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tcZubNoJvd8s1pVBtx_exA.jpeg"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">我的设置</p></figure><p id="8316" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我决定升级到 Cuda 10.2，用最新版本的驱动(440.33.01)。出于几个原因，我很早就想这么做了:</p><ul class=""><li id="7f5f" class="lu lv it kk b kl km ko kp kr lw kv lx kz ly ld lz ma mb mc bi translated">我偶尔会注意到我当前设置的不稳定训练和 GPU 故障</li><li id="6782" class="lu lv it kk b kl md ko me kr mf kv mg kz mh ld lz ma mb mc bi translated">一些最新版本的通用深度学习框架(主要是 PyTorch)只能在 Cuda 10+上运行</li></ul><p id="2a00" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以这是做这件事的最佳时机。我在这篇文章中记录了不同的步骤。我们走吧！</p><ol class=""><li id="8630" class="lu lv it kk b kl km ko kp kr lw kv lx kz ly ld mi ma mb mc bi translated">头顶<a class="ae mj" href="https://developer.nvidia.com/cuda-downloads" rel="noopener ugc nofollow" target="_blank">https://developer.nvidia.com/cuda-downloads</a></li><li id="4f6c" class="lu lv it kk b kl md ko me kr mf kv mg kz mh ld mi ma mb mc bi translated">选择您的<br/> -操作系统(Linux) <br/> -架构(x86_64) <br/> -发行版(Ubuntu) <br/> -版本(16.04) <br/> -安装程序类型(runfile (local))</li><li id="8639" class="lu lv it kk b kl md ko me kr mf kv mg kz mh ld mi ma mb mc bi translated">一旦您选择了元素，您将会得到以下两个命令的提示。处决他们</li></ol><pre class="lf lg lh li gt mk ml mm mn aw mo bi"><span id="6180" class="mp mq it ml b gy mr ms l mt mu"><strong class="ml iu">wget </strong><a class="ae mj" href="http://developer.download.nvidia.com/compute/cuda/10.2/Prod/local_installers/cuda_10.2.89_440.33.01_linux.run" rel="noopener ugc nofollow" target="_blank"><strong class="ml iu">http://developer.download.nvidia.com/compute/cuda/10.2/Prod/local_installers/cuda_10.2.89_440.33.01_linux.run</strong></a></span><span id="ea19" class="mp mq it ml b gy mv ms l mt mu"><strong class="ml iu">sudo sh cuda_10.2.89_440.33.01_linux.run</strong></span></pre><p id="cf3e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">4.重启你的机器</p><p id="5c07" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe mw mx my ml b"><strong class="kk iu">sudo reboot now</strong></code></p><p id="7ac5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你现在应该没事了。但是，如果您在运行<code class="fe mw mx my ml b">nvidia-smi</code>时遇到此错误消息</p><p id="a5fd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">未能初始化 NVML:驱动程序/库版本不匹配</strong></p><p id="c9e7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这意味着您以前的驱动程序太旧，无法被<code class="fe mw mx my ml b"><strong class="kk iu">cuda_10.2.89_440.33.01_linux.run</strong></code> <strong class="kk iu"> </strong>脚本检测和删除。</p><p id="e033" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是为什么你需要清除 Nvidia 旧的依赖:</p><pre class="lf lg lh li gt mk ml mm mn aw mo bi"><span id="2ba3" class="mp mq it ml b gy mr ms l mt mu"><strong class="ml iu">sudo apt-get update<br/>sudo apt-get --purge remove cuda<br/>sudo apt-get autoremove<br/>dpkg --list |grep "^rc" | cut -d " " -f 3 | xargs sudo dpkg --purge<br/>sudo apt-get purge nvidia*<br/>sudo apt-get update<br/>sudo reboot now</strong></span></pre><p id="4a99" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">5.创建指向 Cuda 最新版本的符号链接</p><pre class="lf lg lh li gt mk ml mm mn aw mo bi"><span id="a0ac" class="mp mq it ml b gy mr ms l mt mu"><strong class="ml iu">sudo ln -s /usr/local/cuda-10.2 /usr/local/cuda</strong></span></pre><p id="7da0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">6.更新您的。bashrc</p><p id="1e5e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">旧行:<br/> </strong>导出路径=/usr/local/cuda-9.0/bin:$ PATH<br/>导出 LD _ LIBRARY _ PATH =/usr/local/cuda-9.0/lib 64:$ LD _ LIBRARY _ PATH</p><p id="5db6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">新行:<br/> </strong>导出路径=/usr/local/cuda/bin:$PATH <br/>导出 LD _ LIBRARY _ PATH =/usr/local/cuda/lib 64:$ LD _ LIBRARY _ PATH</p><p id="7bbe" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后重启以保存更改。</p><p id="086c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">7.安装<strong class="kk iu"> Cudnn </strong></p><p id="865e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里创建一个 Nvidia 开发者账号<a class="ae mj" href="https://developer.nvidia.com/developer-program" rel="noopener ugc nofollow" target="_blank">。然后，点开这个</a><a class="ae mj" href="https://developer.nvidia.com/compute/machine-learning/cudnn/secure/7.6.5.32/Production/10.2_20191118/cudnn-10.2-linux-x64-v7.6.5.32.tgz" rel="noopener ugc nofollow" target="_blank">链接</a>，下载 Cudnn。</p><p id="bcd1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下载该文件后，运行以下命令:</p><pre class="lf lg lh li gt mk ml mm mn aw mo bi"><span id="d669" class="mp mq it ml b gy mr ms l mt mu"><strong class="ml iu">sudo cp cuda/include/cudnn.h /usr/local/cuda/include </strong></span><span id="6004" class="mp mq it ml b gy mv ms l mt mu"><strong class="ml iu">sudo cp cuda/lib64/libcudnn* /usr/local/cuda/lib64 </strong></span><span id="03ba" class="mp mq it ml b gy mv ms l mt mu"><strong class="ml iu">sudo chmod a+r /usr/local/cuda/include/cudnn.h /usr/local/cuda/lib64/libcudnn*</strong></span></pre><p id="88cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">8.检查您的安装</p><p id="0b45" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我用支持 Cuda 10.2 的最新 PyTorch 版本创建了一个新的 conda 环境。安装后，我运行以下命令:</p><pre class="lf lg lh li gt mk ml mm mn aw mo bi"><span id="075c" class="mp mq it ml b gy mr ms l mt mu"><strong class="ml iu">import torch</strong></span><span id="c7c0" class="mp mq it ml b gy mv ms l mt mu"><strong class="ml iu">torch.cuda.is_available()<br/># True</strong></span><span id="ab88" class="mp mq it ml b gy mv ms l mt mu"><strong class="ml iu">torch.version.cuda<br/># '10.2'</strong></span><span id="16bc" class="mp mq it ml b gy mv ms l mt mu"><strong class="ml iu">torch.backends.cudnn.version()<br/># 7605</strong></span></pre><p id="515b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是您也可以使用您最喜欢的框架进行检查。</p><p id="a28f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">感谢阅读，我希望这是有用的！</p><p id="16fa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">干杯！</p></div></div>    
</body>
</html>