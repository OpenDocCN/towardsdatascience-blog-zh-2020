<html>
<head>
<title>PDF tables’ parsing using YOLOv3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 YOLOv3 解析 PDF 表格</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pdfs-parsing-using-yolov3-987c85c639dc?source=collection_archive---------15-----------------------#2020-04-30">https://towardsdatascience.com/pdfs-parsing-using-yolov3-987c85c639dc?source=collection_archive---------15-----------------------#2020-04-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/690d5959a4be8d4ad3248d55658056a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*w719Q_BAZRsJtIvO"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://unsplash.com/@joaosilas?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">乔·塞拉斯</a>在<a class="ae jg" href="https://unsplash.com/s/photos/information?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><div class=""/><div class=""><h2 id="2804" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">用 python 解析 pdf 文件内容(包括表格)的最佳工具</h2></div></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><p id="f561" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">PDF 文件或表格是 Adobe 开发的一种文件类型，目的是创建各种形式的内容。特别地，它允许关于其内容变化的一致的安全性。一个 PDF 文件可以包含不同类型的数据:文本、图像、媒体等等。它是一个标签结构的文件，这使得它很容易解析，就像一个 HTML 页面。</p><p id="4191" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">也就是说，出于结构的考虑，我们可以将 PDF 文件分为两类:</p><ul class=""><li id="fb84" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated"><strong class="lh jk">文本文件</strong>:包含可复制粘贴的文本</li><li id="0622" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><strong class="lh jk">基于图像的文件</strong>:包含扫描文件等图像</li></ul><p id="2656" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">在本文中，我们将通过主要的<code class="fe mp mq mr ms b">python libraries</code>功能来解析基于文本和基于图像的 PDF 文件，这些文件将被<strong class="lh jk"> OCR </strong>化，然后作为基于文本的文件进行处理。我们还将在最后一章介绍如何使用对象检测算法 YOLOV3 来解析表格。</p><h1 id="c010" class="mt mu jj bd mv mw mx my mz na nb nc nd kp ne kq nf ks ng kt nh kv ni kw nj nk bi translated">目录表</h1><p id="0d64" class="pw-post-body-paragraph lf lg jj lh b li nl kk lk ll nm kn ln lo nn lq lr ls no lu lv lw np ly lz ma im bi translated">摘要如下:</p><ol class=""><li id="d74b" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma nq mh mi mj bi translated"><strong class="lh jk">基于图像的 pdf 文件<br/> </strong> <em class="nr"> 1.1。OCRMYPDF </em></li><li id="a0e4" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma nq mh mi mj bi translated"><strong class="lh jk">基于文本的 pdf 文件<br/> </strong> <em class="nr"> 2.1。PyPDF2 <br/> 2.2。PDF2IMG <br/> 2.4。卡梅洛特<br/> 2.5。卡米洛特与约洛夫 3 </em></li></ol><p id="9f88" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">为了便于本文的说明，我们将使用<a class="ae jg" href="https://s2.q4cdn.com/661678649/files/doc_financials/2019/q4/4Q19-Press-Release.pdf" rel="noopener ugc nofollow" target="_blank">这个</a> pdf 文件。</p></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="d144" class="mt mu jj bd mv mw ns my mz na nt nc nd kp nu kq nf ks nv kt nh kv nw kw nj nk bi translated">1.基于图像的 pdf 文件</h1><h2 id="2883" class="nx mu jj bd mv ny nz dn mz oa ob dp nd lo oc od nf ls oe of nh lw og oh nj oi bi translated">1.1.OCRMYPDF</h2><p id="6e26" class="pw-post-body-paragraph lf lg jj lh b li nl kk lk ll nm kn ln lo nn lq lr ls no lu lv lw np ly lz ma im bi translated">Ocrmypdf 是一个 python 包，它允许将基于图像的 pdf 转换为基于文本的 pdf，可以选择、复制和粘贴文本。<br/>为了安装 ocrmypdf，您可以使用命令行对 macOS 和 Linux 使用<code class="fe mp mq mr ms b">brew</code>:</p><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="4246" class="nx mu jj ms b gy or os l ot ou">brew install ocrmypdf</span></pre><p id="ae6d" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">安装软件包后，您可以通过运行以下命令行来 ocrise 您的 pdf 文件:</p><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="3c3f" class="nx mu jj ms b gy or os l ot ou">ocrmypdf input_file.pdf output_file.pdf</span></pre><p id="d0b8" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">其中:</p><ul class=""><li id="9cd9" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated"><strong class="lh jk"> ocrmypdf </strong>:路径变量</li><li id="e79d" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><strong class="lh jk"> input_file.pdf </strong>:基于图像的 pdf 文件</li><li id="71c5" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><strong class="lh jk"> output_file.pdf </strong>:输出文本文件</li></ul><figure class="oj ok ol om gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ov"><img src="../Images/535be0bbed007d0068b0814620525632.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6f6dUlVLE8xelbfLYhy09w.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="5bb8" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">一旦 pdf 转换成基于文本的格式，就可以使用下面详述的所有库进行处理。<br/>有关<code class="fe mp mq mr ms b">ocrmypdf</code>的更多详情，请访问以下官方<a class="ae jg" href="https://ocrmypdf.readthedocs.io/en/latest/introduction.html" rel="noopener ugc nofollow" target="_blank">网站</a>。</p></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="d06e" class="mt mu jj bd mv mw ns my mz na nt nc nd kp nu kq nf ks nv kt nh kv nw kw nj nk bi translated">2.基于文本的 pdf 文件</h1><p id="3308" class="pw-post-body-paragraph lf lg jj lh b li nl kk lk ll nm kn ln lo nn lq lr ls no lu lv lw np ly lz ma im bi translated">在这一节中，我们将主要关注三个 python 库，它们允许提取基于文本的 pdf 文件的内容。</p><h2 id="4e6b" class="nx mu jj bd mv ny nz dn mz oa ob dp nd lo oc od nf ls oe of nh lw og oh nj oi bi translated">2.1.PyPDF2</h2><p id="e2f9" class="pw-post-body-paragraph lf lg jj lh b li nl kk lk ll nm kn ln lo nn lq lr ls no lu lv lw np ly lz ma im bi translated">PyPDF2 是一个 python 工具，它使我们能够解析 PDF 文件的基本信息，如作者、标题等。它还允许在假设有密码的情况下获取给定页面的文本，以及拆分页面和打开加密文件。<br/> PyPDF2 可以使用<code class="fe mp mq mr ms b">pip</code>通过运行以下命令行来安装:</p><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="b806" class="nx mu jj ms b gy or os l ot ou">pip install PyPDF2</span></pre><p id="7793" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">我们总结了以下 python 脚本中列出的所有功能:</p><ul class=""><li id="0cdc" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated"><strong class="lh jk">读取 pdf 文件:</strong></li></ul><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="2ea4" class="nx mu jj ms b gy or os l ot ou">from PyPDF2 import PdfFileWriter, PdfFileReader<br/>PDF_PATH = "boeing.pdf"<br/>pdf_doc = PdfFileReader(open(PDF_PATH, "rb"))</span></pre><ul class=""><li id="4298" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated"><strong class="lh jk">提取文档信息:</strong></li></ul><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="9d9a" class="nx mu jj ms b gy or os l ot ou">print("---------------PDF's info---------------")<br/>print(pdf_doc.documentInfo)<br/>print("PDF is encrypted: " + str(pdf_doc.isEncrypted))<br/>print("---------------Number of pages---------------")<br/>print(pdf_doc.numPages)</span><span id="392c" class="nx mu jj ms b gy ow os l ot ou"><em class="nr">&gt;&gt; ---------------PDF's info---------------<br/>&gt;&gt; {'/Producer': 'WebFilings', '/Title': '2019 12 Dec 31 8K Press Release Exhibit 99.1', '/CreationDate': 'D:202001281616'}<br/>&gt;&gt; PDF is encrypted: False<br/>&gt;&gt; ---------------Number of pages---------------<br/>&gt;&gt; 14</em></span></pre><ul class=""><li id="84bc" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated"><strong class="lh jk">逐页分割文件:</strong></li></ul><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="66bc" class="nx mu jj ms b gy or os l ot ou">#indexation starts at 0<br/>pdf_page_1 = pdf_doc.getPage(0)<br/>pdf_page_4 = pdf_doc.getPage(3)<br/>print(pdf_page_1)<br/>print(pdf_page_4)</span><span id="1c26" class="nx mu jj ms b gy ow os l ot ou"><em class="nr">&gt;&gt; {'/Type': '/Page', '/Parent': IndirectObject(1, 0), '/MediaBox': [0, 0, 612, 792], '/Resources': IndirectObject(2, 0), '/Rotate': 0, '/Contents': IndirectObject(4, 0)}<br/>&gt;&gt; {'/Type': '/Page', '/Parent': IndirectObject(1, 0), '/MediaBox': [0, 0, 612, 792], '/Resources': IndirectObject(2, 0), '/Rotate': 0, '/Contents': IndirectObject(10, 0)}</em></span></pre><ul class=""><li id="c8ae" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated"><strong class="lh jk">从页面中提取文本:</strong></li></ul><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="a998" class="nx mu jj ms b gy or os l ot ou">text = pdf_page_1.extractText()<br/>print(text[:500])</span><span id="46c8" class="nx mu jj ms b gy ow os l ot ou"><em class="nr">&gt;&gt; '1Boeing Reports Fourth-Quarter ResultsFourth Quarter 2019 Financial results continue to be significantly impacted by the 737 MAX grounding Revenue of $17.9 billion, GAAP loss per share of ($1.79) and core (non-GAAP)* loss per share of ($2.33) Full-Year 2019 Revenue of $76.6€billion, GAAP loss per share of ($1.12) and core (non-GAAP)* loss per share of ($3.47) Operating cash flow of ($2.4)€billion; cash and marketable securities of $10.0 billion Total backlog of $463 billion, including over 5,400'</em></span></pre><ul class=""><li id="0afd" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated"><strong class="lh jk">逐页合并文档:</strong></li></ul><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="3e64" class="nx mu jj ms b gy or os l ot ou">new_pdf = PdfFileWriter()<br/>new_pdf.addPage(pdf_page_1)<br/>new_pdf.addPage(pdf_page_4)<br/>new_pdf.write(open("new_pdf.pdf", "wb"))<br/>print(new_pdf)</span><span id="3112" class="nx mu jj ms b gy ow os l ot ou"><em class="nr">&gt;&gt; &lt;PyPDF2.pdf.PdfFileWriter object at 0x11e23cb1</em><strong class="ms jk"><em class="nr">0</em></strong><em class="nr">&gt;</em></span></pre><ul class=""><li id="ce91" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated"><strong class="lh jk">裁剪页面:</strong></li></ul><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="136f" class="nx mu jj ms b gy or os l ot ou">print("Upper Left: ", pdf_page_1.cropBox.getUpperLeft())<br/>print("Lower Right: ", pdf_page_1.cropBox.getLowerRight())<br/><br/>x1, y1 = 0, 550<br/>x2, y2 = 612, 320<br/><br/>cropped_page = pdf_page_1<br/>cropped_page.cropBox.upperLeft = (x1, y1)<br/>cropped_page.cropBox.lowerRight = (x2, y2)<br/><br/>cropped_pdf = PdfFileWriter()<br/>cropped_pdf.addPage(cropped_page)<br/>cropped_pdf.write(open("cropped.pdf", "wb"))</span></pre><figure class="oj ok ol om gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ox"><img src="../Images/6508961f48317cbbf42e978ff974e494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kxdn4aiPzWVE3nfckZ16Yw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><ul class=""><li id="e3dc" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated"><strong class="lh jk">加密和解密 PDF 文件:</strong></li></ul><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="8eaa" class="nx mu jj ms b gy or os l ot ou">PASSWORD = "password_123"<br/>encrypted_pdf = PdfFileWriter()<br/>encrypted_pdf.addPage(pdf_page_1)<br/>encrypted_pdf.encrypt(PASSWORD)<br/>encrypted_pdf.write(open("encrypted_pdf.pdf", "wb"))<br/><br/>read_encrypted_pdf = PdfFileReader(open("encrypted_pdf.pdf", "rb"))<br/>print(read_encrypted_pdf.isEncrypted)<br/>if read_encrypted_pdf.isEncrypted:<br/>    read_encrypted_pdf.decrypt(PASSWORD)<br/>print(read_encrypted_pdf.documentInfo)</span><span id="0db3" class="nx mu jj ms b gy ow os l ot ou"><em class="nr">&gt;&gt; True<br/>&gt;&gt; {'/Producer': 'PyPDF2'}</em></span></pre><figure class="oj ok ol om gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi oy"><img src="../Images/e411c6fff65868380190cdcf78f6e3e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lzw6lpk_cMiSjZzGC-czeA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="2353" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">关于<code class="fe mp mq mr ms b">PyPDF2</code>的更多信息，请访问官方<a class="ae jg" href="https://pypi.org/project/PyPDF2/" rel="noopener ugc nofollow" target="_blank">网站</a>。</p><h2 id="2e6f" class="nx mu jj bd mv ny nz dn mz oa ob dp nd lo oc od nf ls oe of nh lw og oh nj oi bi translated">2.2.PDF2IMG</h2><p id="94cb" class="pw-post-body-paragraph lf lg jj lh b li nl kk lk ll nm kn ln lo nn lq lr ls no lu lv lw np ly lz ma im bi translated">PDF2IMG 是一个 python 库，允许将 PDF 页面转换成可以处理的图像，例如，通过计算机视觉算法。<br/>通过运行以下命令行，可以使用<code class="fe mp mq mr ms b">pip</code>安装 PDF2IMG:</p><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="83c6" class="nx mu jj ms b gy or os l ot ou">pip install pdf2image</span></pre><p id="cf15" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">我们可以将<strong class="lh jk">第一页</strong>和<strong class="lh jk">最后一页</strong>设置为从 pdf 文件转换成图像。</p><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="86d9" class="nx mu jj ms b gy or os l ot ou">from pdf2image import convert_from_path<br/>import matplotlib.pyplot as plt</span><span id="c39c" class="nx mu jj ms b gy ow os l ot ou">page=0<br/>img_page = convert_from_path(<!-- -->PDF_PATH<!-- -->, first_page=page, last_page=page+1, output_folder="./", fmt="jpg")</span><span id="ff2b" class="nx mu jj ms b gy ow os l ot ou">print(img_page)</span><span id="15c8" class="nx mu jj ms b gy ow os l ot ou"><em class="nr">&gt;&gt; &lt;PIL.PpmImagePlugin.PpmImageFile image mode=RGB size=1700x2200 at 0x11DF397D</em><strong class="ms jk"><em class="nr">0</em></strong><em class="nr">&gt;</em></span></pre><figure class="oj ok ol om gt iv gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/250833911ce0d56185fa78556d920a87.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*HHG3uZGrqcfrd6A-im_CdA.png"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><h2 id="365a" class="nx mu jj bd mv ny nz dn mz oa ob dp nd lo oc od nf ls oe of nh lw og oh nj oi bi translated">2.3.卡默洛特</h2><p id="10ec" class="pw-post-body-paragraph lf lg jj lh b li nl kk lk ll nm kn ln lo nn lq lr ls no lu lv lw np ly lz ma im bi translated"><a class="ae jg" href="https://camelot-py.readthedocs.io/en/master/" rel="noopener ugc nofollow" target="_blank"> Camelot </a>是一个专门解析 pdf 页面表格的 python 库。可以通过运行下面的命令行使用<code class="fe mp mq mr ms b">pip</code>来安装它:</p><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="07a8" class="nx mu jj ms b gy or os l ot ou">pip install camelot-py[cv]</span></pre><p id="077d" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">解析的输出是一个<code class="fe mp mq mr ms b">pandas dataframe</code>，这对数据处理非常有用。</p><pre class="oj ok ol om gt on ms oo op aw oq bi"><span id="f0ee" class="nx mu jj ms b gy or os l ot ou">import camelot<br/>output_camelot = camelot.read_pdf(<br/>    filepath="output_ocr.pdf", pages=str(0), flavor="stream"<br/>)<br/>print(output_camelot)<br/>table = output_camelot[0]<br/>print(table)<br/>print(table.parsing_report)</span><span id="68c9" class="nx mu jj ms b gy ow os l ot ou"><em class="nr">&gt;&gt; TableList n=</em><strong class="ms jk"><em class="nr">1</em></strong><em class="nr">&gt;<br/>&gt;&gt; &lt;Table shape=(18, 8)&gt;<br/>&gt;&gt; {'accuracy': 93.06, 'whitespace': 40.28, 'order': 1, 'page': 0}</em></span></pre><p id="274b" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">当 pdf 页面包含文本时，Camelot 的输出将是一个数据框，第一列中包含文本，随后是所需的表格。通过一些基本的处理，我们可以将它提取如下:</p><figure class="oj ok ol om gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pa"><img src="../Images/edec00e5487465f9e39d61d97b45deae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RovIhsodAOIeHV6_M07bhg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="5afa" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">卡梅洛特提供两种口味<strong class="lh jk">格子</strong>和<strong class="lh jk">流</strong>，我建议使用<code class="fe mp mq mr ms b">stream</code>，因为它对表格结构更灵活。</p><h2 id="5cd2" class="nx mu jj bd mv ny nz dn mz oa ob dp nd lo oc od nf ls oe of nh lw og oh nj oi bi translated">2.4.卡米洛特混有约洛夫 3</h2><p id="93fd" class="pw-post-body-paragraph lf lg jj lh b li nl kk lk ll nm kn ln lo nn lq lr ls no lu lv lw np ly lz ma im bi translated">Camelot 提供了通过变量<code class="fe mp mq mr ms b">table_areas="x1,y1,x2,y2"</code>指定要处理的区域的选项，其中(x1，y1)是 PDF 坐标空间的左上,( x2，y2)是右下。填写后，解析的结果会显著增强。</p><p id="856c" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated"><strong class="lh jk">解释基本想法</strong></p><p id="f18b" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">自动解析表的一种方法是训练一种算法，该算法能够返回环绕表的边界框的坐标，如下面的管道中所详述的:</p><figure class="oj ok ol om gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pb"><img src="../Images/4d74909474f05866e4d52edeca4990e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*67z51AO9_2lZA1qmJIrtYg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="4785" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">如果原始的 pdf 页面是基于图像的，我们可以使用<code class="fe mp mq mr ms b">ocrmypdf</code>转换成基于文本的页面，以便能够在表格中获取文本。然后，我们执行以下操作:</p><ul class=""><li id="54af" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">使用<code class="fe mp mq mr ms b">pdf2img</code>将 pdf 页面转换成图像页面</li><li id="e56e" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">使用经过训练的算法来检测表的区域。</li><li id="43aa" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">使用<em class="nr">图像尺寸</em>标准化边界框，这使得能够使用通过<code class="fe mp mq mr ms b">PyPDF2</code>获得的<em class="nr"> pdf 尺寸</em>获得 pdf 空间中的区域。</li><li id="5a7e" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated">将区域反馈给<code class="fe mp mq mr ms b">camelot</code>并获得相应的熊猫数据帧。</li></ul><p id="ba02" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">检测 pdf 图像中的表格时，我们扩展边界框以保证其完全包含，如下所示:</p><figure class="oj ok ol om gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pc"><img src="../Images/71da2b527edadcefbb787366e179d6d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CGMYQx36F9WkvFgU0ZDMVA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="6d2c" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated"><strong class="lh jk">表格检测</strong></p><p id="7bc7" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">允许检测表格的算法是 yolov3，我建议你阅读我以前的关于对象检测的文章。<br/>我们微调算法，检测表格，重新训练所有架构。为此，我们执行以下步骤:</p><ul class=""><li id="e07d" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">使用<code class="fe mp mq mr ms b"><a class="ae jg" href="https://www.makesense.ai/" rel="noopener ugc nofollow" target="_blank">Makesense</a></code>工具创建一个培训数据库，该工具能够以 YOLO 格式进行标记和导出:</li></ul><figure class="oj ok ol om gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pd"><img src="../Images/3775276fd339019786169d6d2e3664c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-MR52Ju-six-jxAr5KSMoQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><ul class=""><li id="3aff" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated">训练 a <code class="fe mp mq mr ms b"><a class="ae jg" rel="noopener" target="_blank" href="/object-detection-face-recognition-algorithms-146fec385205">yolov3</a></code> <code class="fe mp mq mr ms b"><a class="ae jg" href="https://github.com/ultralytics/yolov3" rel="noopener ugc nofollow" target="_blank">repository</a></code>被修改以适应我们在 AWS EC2 上的目的，我们得到以下结果:</li></ul><figure class="oj ok ol om gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pe"><img src="../Images/f2810bd1a92574a89ade736967bd0a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chzvS_e26jCDsld6ZP4lQA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="bcc9" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated"><strong class="lh jk">插图</strong></p><p id="49b9" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">检测结果如下所示:</p><figure class="oj ok ol om gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pf"><img src="../Images/4fbf5f7ab2cc15c8a051908e767fd287.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ga_AC81YEemV4ZaeKLzbag.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><h1 id="e2b0" class="mt mu jj bd mv mw ns my mz na nt nc nd kp nu kq nf ks nv kt nh kv nw kw nj nk bi translated"><strong class="ak">结论</strong></h1><p id="47ac" class="pw-post-body-paragraph lf lg jj lh b li nl kk lk ll nm kn ln lo nn lq lr ls no lu lv lw np ly lz ma im bi translated">当混合标准 python 库和深度学习算法时，有可能显著增强 PDF 文档的解析。事实上，按照相同的步骤，我们可以训练 YOLOV3 算法来检测 pdf 页面中的<code class="fe mp mq mr ms b">any other object</code>，例如可以从图像页面中提取的图形和图像。</p><p id="d64c" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">你可以在我的<a class="ae jg" href="https://github.com/ismail-mebsout/Parsing-PDFs-using-YOLOV3" rel="noopener ugc nofollow" target="_blank"> GitHub </a>里查看我的项目。</p><p id="b641" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated">不要犹豫，检查我以前的文章处理:</p><ul class=""><li id="43af" class="mb mc jj lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated"><a class="ae jg" href="https://medium.com/p/deep-learnings-mathematics-f52b3c4d2576" rel="noopener">深度学习的数学</a></li><li id="c422" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><a class="ae jg" href="https://medium.com/p/convolutional-neural-networks-mathematics-1beb3e6447c0" rel="noopener">卷积神经网络的数学</a></li><li id="7f71" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/object-detection-face-recognition-algorithms-146fec385205">物体检测&amp;人脸识别算法</a></li><li id="ebec" class="mb mc jj lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><a class="ae jg" rel="noopener" target="_blank" href="/recurrent-neural-networks-b7719b362c65">递归神经网络</a></li></ul></div><div class="ab cl ky kz hx la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="im in io ip iq"><p id="6323" class="pw-post-body-paragraph lf lg jj lh b li lj kk lk ll lm kn ln lo lp lq lr ls lt lu lv lw lx ly lz ma im bi translated"><em class="nr">原载于 2020 年 4 月 30 日 https://www.ismailmebsout.com</em><a class="ae jg" href="https://www.ismailmebsout.com/pdfs-parsing/" rel="noopener ugc nofollow" target="_blank"><em class="nr"/></a><em class="nr">。</em></p></div></div>    
</body>
</html>