<html>
<head>
<title>How to make Value-By-Alpha Maps in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python制作按Alpha值的地图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-make-value-by-alpha-maps-in-python-484722160490?source=collection_archive---------30-----------------------#2020-04-29">https://towardsdatascience.com/how-to-make-value-by-alpha-maps-in-python-484722160490?source=collection_archive---------30-----------------------#2020-04-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7497" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">关于如何用Python创建Alpha值映射的初学者指南和教程</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/5712f775095a55046b93cbd05ddd1303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P6pKz13Qpx_3QpSd"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://unsplash.com/@yangshuo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杨烁</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><p id="4421" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">自从我看到Alpha值地图的美丽美学，我就想做一个。当时，在QGIS或ArcGIS中稍加修改就能制作出它们并不困难。现在，由于Pysal库和Splot，您可以使用Python制作按alpha值的地图。</p><p id="c225" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本教程中，我将指导你如何使用Python制作alpha值贴图。但是首先，让我们了解什么是按阿尔法值的地图，为什么要使用它，什么时候使用合适？</p><h2 id="aa47" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">什么是阿尔法值图(VBA)</h2><p id="dc48" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">“按阿尔法值”是双变量choropleth技术，其中我们考虑两个相互影响的变量，例如，选举结果和人口密度。第二个变量充当另一个感兴趣的变量的均衡器。</p><p id="9efc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">因此，VBA通过阿尔法变量(透明度)修改背景颜色。因此，较低的值会淡出背景，而较高的值会弹出。VBA地图的出现是为了减少choropleth地图中较大的尺寸偏差。</p><p id="554b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">除了美学部分，如果你想通过色彩而不是尺寸来突出聚光灯，使用choropleth技术，VBA也是一个不错的选择。它确实比纯粹的choropleth图描绘了更好的信息。</p><p id="61ec" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，您首先需要有一个与感兴趣的变量相关的变量(即，拥有更多选民的县对选举结果有重要影响)。</p><h2 id="9e7c" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">如何用Python制作按alpha值排序的地图</h2><p id="c6d3" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">我们将使用<a class="ae ky" href="https://github.com/pysal/splot/tree/master/splot" rel="noopener ugc nofollow" target="_blank"> Splot Python库</a>来创建我们的地图和Geopandas来读取地理空间数据。我们使用了2012年美国大选的子集数据。让我们首先读取数据，看看前几行。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="c135" class="lv lw it mu b gy my mz l na nb">import geopandas as gpd<br/>from splot.mapping import vba_choropleth</span><span id="405b" class="lv lw it mu b gy nc mz l na nb">import matplotlib.pyplot as plt<br/>%matplotlib inline</span><span id="41b4" class="lv lw it mu b gy nc mz l na nb">gdf = gpd.read_file("data/MN_elections_2012.gpkg")<br/>gdf.head()</span></pre><p id="308d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">从下表中可以看出，我们有一个包含不同列的地理数据框架。例如，巴拉克·奥巴列保存该区域的结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/6b3935dc77cc102e0a5331bf33a3b5e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AZUSk1dCMfPkBr4DqS1wcw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">2012年选举数据</p></figure><p id="7c30" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们大部分时间使用choropleth地图，但是正如我们在前面提到的，它有其局限性。让我们首先从数据中制作一个choropleth图，为数据可视化创建一个基准。例如，我们可以选择使用巴拉克·奥巴马专栏。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="6ccb" class="lv lw it mu b gy my mz l na nb">fig, ax = plt.subplots(figsize=(12,10))<br/>gdf.plot(column=’BARACK OBA’, scheme=’quantiles’, cmap=’RdBu’, ax=ax)<br/>ax.axis(“off”)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/576a1dd4751171446fc636a139c0e524.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*IDNwFQ51J7THHE6pi9vHqg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">等值区域图</p></figure><p id="72ef" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们创建一个alpha值图。为了创建我们的地图，我们需要两列。第一列是我们感兴趣在地图中显示的内容；例如，巴拉克·奥巴马的结果。第二列保存要均衡的alpha值。这种alpha均衡将从贴图外观中消除低值，并增加高值区域的聚光灯效果。我们可以选择总结果作为alpha值。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="ef54" class="lv lw it mu b gy my mz l na nb">fig, ax = plt.subplots(figsize=(12,10))<br/>vba_choropleth(<br/>     gdf[‘BARACK OBA’].values, <br/>     gdf[‘Total Resu’].values, <br/>     gdf, <br/>     rgb_mapclassify=dict(classifier=’quantiles’),<br/>     alpha_mapclassify=dict(classifier=’quantiles’),<br/>     cmap=’RdBu’, <br/>     ax=ax,<br/>     revert_alpha=False )</span><span id="eb2c" class="lv lw it mu b gy nc mz l na nb">plt.show()</span></pre><p id="7f95" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“按alpha值”贴图会立即高亮显示高值区域，即使它们是n。与大区域在视觉上占主导地位的choropleth贴图相比，“按alpha值”贴图会清楚地显示高值区域。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/29d1ecd723e969c3e3b7f244a62e0120.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*PLD81kSuhU4x2wrIQsWHkA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">按alpha值映射</p></figure><p id="33fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以简单地使用黑色背景来强调聚光灯的效果。将下面的“按alpha值”贴图与上面的贴图进行比较。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="ecbc" class="lv lw it mu b gy my mz l na nb">plt.style.use('dark_background')<br/>fig, ax = plt.subplots(figsize=(12,10))<br/>vba_choropleth(<br/>     gdf[‘BARACK OBA’].values, <br/>     gdf[‘Total Resu’].values, <br/>     gdf, <br/>     rgb_mapclassify=dict(classifier=’quantiles’),<br/>     alpha_mapclassify=dict(classifier=’quantiles’),<br/>     cmap=’RdBu’, <br/>     ax=ax,<br/>     revert_alpha=False )</span><span id="08a9" class="lv lw it mu b gy nc mz l na nb">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/c17082885ae2c8b05d7d5d19efeeb1d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*fWDFFp_FUbFzb4nyj6LBkA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">alpha值贴图-黑色背景</p></figure><p id="0a61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没有图例，按alpha值的图很难阅读。Splot提供了一种创建图例的简单方法，甚至比其他重量级GIS软件应用程序都要简单。我们也回复到白色背景。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="8244" class="lv lw it mu b gy my mz l na nb">plt.style.use('default')<br/>fig, ax = plt.subplots(figsize=(12,10))<br/>vba_choropleth(<br/>     gdf[‘BARACK OBA’].values, <br/>     gdf[‘Total Resu’].values, <br/>     gdf, <br/>     rgb_mapclassify=dict(classifier=’quantiles’),<br/>     alpha_mapclassify=dict(classifier=’quantiles’),<br/>     cmap=’RdBu’, <br/>     ax=ax,<br/>     revert_alpha=False,<br/>     legend = True <br/>)</span><span id="e83d" class="lv lw it mu b gy nc mz l na nb">plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nf"><img src="../Images/df6d91fdd1a070d039c7c30a1899384e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IWD0AtJVa0wZ20UaSeymDA.png"/></div></div></figure><p id="8d09" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最后，我们可以给地图添加一些上下文。例如，我们可以添加主要城市，以帮助读者有效地阅读地图。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="960e" class="lv lw it mu b gy my mz l na nb">cities = gpd.read_file(“data/ne_10_populated_places.geojson”)<br/>cities = cities.to_crs(“EPSG:26915”)</span><span id="c055" class="lv lw it mu b gy nc mz l na nb">fig, ax = plt.subplots(figsize=(12,10))<br/>vba_choropleth(<br/>     gdf[‘BARACK OBA’].values, <br/>     gdf[‘Total Resu’].values, <br/>     gdf, <br/>     rgb_mapclassify=dict(classifier=’quantiles’),<br/>     alpha_mapclassify=dict(classifier=’quantiles’),<br/>     cmap=’RdBu’, <br/>     ax=ax,<br/>     revert_alpha=False,<br/>     legend = True <br/>)<br/>cities.plot(ax=ax, color = "white")<br/>for x, y, label in zip(cities.geometry.x, cities.geometry.y, cities.NAME):<br/>    ax.annotate(label, xy=(x, y), xytext=(3, 3), textcoords="offset points")<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/8cb7750299d88c14a8eec88174d5cdae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xOo05DgGNBRbq8cHM-t4qw.png"/></div></div></figure><p id="82d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我们有了一个美观的地图，帮助我们传达聚光灯的效果，而没有choropleth地图的限制。</p><h2 id="d8a7" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated">结论</h2><p id="b191" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">按alpha值排序的地图是可视化地理空间数据的有效方法，避免了choropleth和cartogram地图的限制。在本教程中，我们已经探索了什么是alpha值贴图，以及如何使用Splot库创建一个。</p><p id="6c81" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">本教程的代码可以从这个Github资源库获得。</p><div class="nh ni gp gr nj nk"><a href="https://github.com/shakasom/vba" rel="noopener  ugc nofollow" target="_blank"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">shakasom/vba</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">Python中alpha贴图的值。在GitHub上创建一个帐户，为shakasom/vba开发做贡献。</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">github.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny ks nk"/></div></div></a></div></div></div>    
</body>
</html>