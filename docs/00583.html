<html>
<head>
<title>The Fusion of Deep Learning and Combinatorics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习和组合学的融合</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-fusion-of-deep-learning-and-combinatorics-4d0112a74fa7?source=collection_archive---------7-----------------------#2020-01-17">https://towardsdatascience.com/the-fusion-of-deep-learning-and-combinatorics-4d0112a74fa7?source=collection_archive---------7-----------------------#2020-01-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/ff53059c00e46fbff868079aa498e7d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O70yjac3E9xXU89T3_mq2w.png"/></div></div></figure><div class=""/><div class=""><h2 id="8057" class="pw-subtitle-paragraph kb jd je bd b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks dk translated">我们如何在深度神经网络中无缝整合组合求解器。我们的ICLR 2020聚焦论文摘要。</h2></div><p id="fdb7" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">机器学习研究的当前景观表明，基于深度学习的现代方法与良好的老式人工智能方法不一致。深度学习在计算机视觉、强化学习、最优控制、自然语言处理等领域被证明是一种非常强大的特征提取工具。不幸的是，深度学习有一个致命弱点，即它无法处理需要组合概括的问题。一个例子是基于作为图像的地图输入，学习在谷歌地图中预测最快的路线，这是最短路径问题的一个实例。这类问题太多了，比如(最小，最大)割、最小成本完美匹配、旅行推销员、图匹配等等。</p><p id="7fd1" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">但是，如果要孤立地解决这样的组合问题，我们有一个惊人的求解器工具箱可用，从算法的高效C实现到更通用的MIP(混合整数编程)求解器，如<a class="ae lp" href="https://www.gurobi.com/downloads/?campaignid=2027425870&amp;adgroupid=77414946211&amp;creative=406173554813&amp;keyword=gurobi&amp;matchtype=e&amp;gclid=Cj0KCQiA04XxBRD5ARIsAGFygj8EcNGX-mt9kaGVsjWRYqHFD8tL1zI8-hv-sagIW87g0DsboLTiELIaAjpUEALw_wcB" rel="noopener ugc nofollow" target="_blank"> Gurobi </a>。求解器面临的问题是输入空间的表示，因为求解器需要明确定义的结构化输入。</p><p id="d35c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">尽管组合问题一直是机器学习研究社区中的一个主题，但是对解决这种问题的关注一直是缺乏的。这并不意味着组合归纳的问题没有被认为是通往智能系统道路上的一个关键挑战。理想情况下，人们将能够以端到端的方式将通过强大的函数逼近器(如神经网络)可用的丰富特征提取与高效的组合求解器相结合，而不会有任何妥协。这正是我们在<a class="ae lp" href="http://bit.ly/35IowfE" rel="noopener ugc nofollow" target="_blank">最近的论文</a> [1]中能够实现的，我们已经获得了最高的评论分数，并将在2020年ICLR大会上做重点演讲。</p><p id="5eac" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">对于以下部分，值得记住的是，我们并不试图改进解算器本身，而是使现有解算器能够与函数逼近协同使用。</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lq"><img src="../Images/e90ad6fdbb7c9456cb7736069b7af672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pz9Vu4PXlb89TZakvlCOkg.png"/></div></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">我们将黑盒解算器想象为深度学习的架构模块，我们可以简单地插入其中。</p></figure><h2 id="ba1a" class="lz ma je bd mb mc md dn me mf mg dp mh lc mi mj mk lg ml mm mn lk mo mp mq mr bi translated">黑盒解算器的梯度</h2><p id="37b8" class="pw-post-body-paragraph kt ku je kv b kw ms kf ky kz mt ki lb lc mu le lf lg mv li lj lk mw lm ln lo im bi translated">我们思考组合解算器的方式是从连续输入(例如图边的权重)到离散输出(例如最短路径、选定的图边)的映射，定义如下</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/4a80fae82d6cfc9564db20b8a26bb1f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:402/1*q_vM2k_QKVvl7E7cKf2V8g@2x.gif"/></div></figure><p id="b276" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">求解器最小化某种成本函数<strong class="kv jf"> c </strong> (ω，y)，例如路径的长度。更具体地，解算器解决以下优化问题:</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div class="gh gi my"><img src="../Images/991d8481b4ead986dc51e0669d6192ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/1*FP_Hm4XyA4hjkhl7uL8smw@2x.gif"/></div></figure><p id="3201" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">现在，假设ω是神经网络的输出，即我们学习的某种表示。直观来看，这个ω是什么意思？ω用于定义组合问题的实例。例如，ω可以是定义图的边权重的某个向量。在这种情况下，求解程序可以解决最短路径问题或旅行推销员问题，或者我们希望针对指定的边成本解决的任何问题。我们希望通过ω获得正确的问题规范。</p><p id="f89a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">自然地，我们想要优化我们的表示，使得它最小化损耗，损耗是求解器L(y)的输出的函数。我们现在面临的问题是，损失函数是分段常数，这意味着这个函数相对于ω表示的梯度几乎处处都是0，并且在损失函数的跳跃上是未定义的。更直白地说，梯度对于最小化损失函数是无用的。</p><p id="5dd0" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">到目前为止，已经有依赖于求解器松弛的方法，其中必须对其最优性做出牺牲。相比之下，我们已经开发了一种不影响求解器最优性的方法。我们通过定义原始目标函数的分段仿射插值来实现这一点，其中插值本身由超参数λ控制，如下图所示:</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mz"><img src="../Images/8d6105282e9ee5dd5bea01c5e56390f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9kmgVycclSB1oLMd1lR6Xw.png"/></div></div></figure><p id="c6cc" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们可以看到，<strong class="kv jf"> f </strong>(黑色)是分段常数。我们的插值(橙色)以合理的方式连接了平台。例如，注意最小值没有改变。</p><p id="67f9" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf"> f </strong>的定义域当然是多维的。这样，我们可以观察到输入集<strong class="kv jf"> ω </strong>，其中<strong class="kv jf"> f </strong>获得与多面体相同的值。自然，在<strong class="kv jf"> f </strong>的定义域中有很多这样的多面体。超参数<strong class="kv jf"> λ </strong>有效地做的是通过解算器输入的扰动来移动多面体，<strong class="kv jf"> ω </strong>。定义分段仿射目标的<strong class="kv jf"> g </strong>插值器将多面体的移动边界连接到原始边界。下图描述了这种情况，其中获得值<strong class="kv jf"> f(y2) </strong>的多面体的边界被移动以获得值<strong class="kv jf"> f(y1) </strong>。这也直观地解释了为什么更高的值<strong class="kv jf"> λ </strong>是优选的。位移必须足够大，以获得插值器<strong class="kv jf"> g </strong>，它将为我们提供信息梯度。证明可以在[1]中找到。</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi na"><img src="../Images/effd04872cb63ab3725e71db2901672c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wvvjv5jzfkTGIqZkCgfpnw.png"/></div></div></figure><p id="ac09" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">首先，让我们定义扰动优化问题的解决方案，其中扰动由超参数<strong class="kv jf"> λ </strong>控制:</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nb"><img src="../Images/33de5787f92dfa9212001839b301e646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6cUhnWrv-gNpfCp92ABfPg@2x.gif"/></div></div></figure><p id="0e3f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">如果我们假设成本函数<strong class="kv jf"> c </strong> (ω，y)是y和ω之间的点积，我们可以如下定义插值目标:</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nc"><img src="../Images/73f4f33007232e50d47eba4797865871.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*tdHZI8ilzNX1fvqwjJdwRw@2x.gif"/></div></div></figure><p id="fa18" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">注意，成本函数的线性并不像乍看上去那样严格。所有涉及边选择的问题，其代价是边权重的和，都属于这一类。最短路径问题(SPP)和旅行推销员问题(TSP)就是属于这类问题的例子。</p><figure class="lr ls lt lu gt iv"><div class="bz fp l di"><div class="nd ne l"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">(2)在这个动画中，我们可以看到插值如何随着λ的增加而演变。</p></figure><h2 id="42f4" class="lz ma je bd mb mc md dn me mf mg dp mh lc mi mj mk lg ml mm mn lk mo mp mq mr bi translated">该算法</h2><p id="3707" class="pw-post-body-paragraph kt ku je kv b kw ms kf ky kz mt ki lb lc mu le lf lg mv li lj lk mw lm ln lo im bi translated">通过我们的方法，我们能够通过简单修改反向传递来计算梯度，从而消除经典组合求解器和深度学习之间的裂痕。</p><figure class="lr ls lt lu gt iv"><div class="bz fp l di"><div class="nf ne l"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">向前传递时，我们只需为嵌入式解算器提供ω，并将解向前传播。此外，我们保存正向传递中计算的ω和解y_值。</p></figure><figure class="lr ls lt lu gt iv"><div class="bz fp l di"><div class="nf ne l"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">对于反向传递，我们只需用λ缩放的反向传播梯度扰动ω，并取前一个解和扰动的问题解之间的差。</p></figure><p id="2d4c" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">计算插值梯度的计算开销取决于求解器，额外的开销是在前向过程中调用求解器一次，在后向过程中调用一次。</p><h2 id="4622" class="lz ma je bd mb mc md dn me mf mg dp mh lc mi mj mk lg ml mm mn lk mo mp mq mr bi translated">实验</h2><p id="a99a" class="pw-post-body-paragraph kt ku je kv b kw ms kf ky kz mt ki lb lc mu le lf lg mv li lj lk mw lm ln lo im bi translated">我们开发了包含一定程度的组合复杂性的合成任务来验证该方法。在接下来的任务中，我们已经证明了我们的方法对于组合推广是必不可少的，因为朴素的监督学习方法无法推广到看不见的<br/>数据。同样，目标是学习组合问题的正确规范。</p><p id="42fa" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">对于<strong class="kv jf">魔兽最短路径</strong>问题，训练集由魔兽争霸II地图和地图上对应的最短路径作为目标组成。测试集由看不见的魔兽争霸2地图组成。地图本身编码一个<strong class="kv jf">k</strong>T5×T7】k网格。这些地图是卷积神经网络的输入，卷积神经网络输出地图的顶点成本，这些成本将反馈给求解器。最后，求解器(实际上是Dijkstra的最短路径算法)以指示器矩阵的形式在地图上输出最短路径。</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ng"><img src="../Images/1b5be84dd052aa03add5e42ebcaa6f8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8arB-mGJxMh8Au4e3K8ShQ.png"/></div></div></figure><p id="86cd" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">自然地，在训练开始时，网络不知道如何将正确的成本分配给地图的分块，但是使用我们的方法，我们能够学习正确的分块成本，从而学习正确的最短路径。直方图显示了我们的方法如何能够比ResNet的传统监督训练更好地概括<strong class="kv jf">。</strong></p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nh"><img src="../Images/c402254b6497788779eb72e830f6ac16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sF5QbqGu6_UXMu6LcLSU8Q.png"/></div></div></figure></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="0dfe" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在<strong class="kv jf"> MNIST最小成本完美匹配</strong>问题中，目标是输出MNIST数字网格的最小成本完美匹配。具体地说，在最小成本完美匹配问题中，我们应该选择这样的边，使得所有顶点都恰好包含在选择中一次，并且边成本的总和最小。网格中的每个单元包含一个MNIST数字，该数字是图中具有垂直和水平邻居的节点。通过垂直向下或水平向右读取两位数来确定边缘成本。</p><p id="dc8a" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">对于这个问题，卷积神经网络(CNN)接收MNIST网格的图像作为输入，并输出转换为边成本的顶点成本网格。然后将边缘公式交给Blossom V完美匹配解算器。</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div class="gh gi np"><img src="../Images/a0e9a5d749d074acc58c6376e49c206d.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*weFKye9vOvCNcLEC5fjQ3A.png"/></div><p class="lv lw gj gh gi lx ly bd b be z dk translated">解算器输出在匹配中选择的边的指示向量。右边匹配的代价是348(横向46 + 12，纵向27 + 45 + 40 + 67 + 78 + 33)。</p></figure><p id="5f33" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">同样，在性能图中，我们注意到在神经网络中嵌入实际完美匹配求解器的明显优势。</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nh"><img src="../Images/e94bd8e0ef050cc57d6b78fae69e4da4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_39HBGjOhKC4W8e30y0_4w.png"/></div></div></figure></div><div class="ab cl ni nj hx nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="im in io ip iq"><p id="dc7e" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们还研究了<strong class="kv jf">旅行推销员问题</strong>的公式，其中网络应该输出国家首都的最优旅行推销员旅行。对于这个问题，重要的是在潜在表征中学习正确的资本位置。我们的数据集由各国国旗(即原始表示)和各自首都的最佳旅游组成。一个训练例子由<strong class="kv jf"> k </strong>个国家组成。在这种情况下，卷积神经网络显示为国家标志的串联，并应输出最佳路线。</p><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nq"><img src="../Images/3539768beebd43b8787c43176981bab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*14Gi0ABwU6adGC4ErYxOsQ.png"/></div></div><p class="lv lw gj gh gi lx ly bd b be z dk">(5)</p></figure><figure class="lr ls lt lu gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nh"><img src="../Images/2d5a3fd69748bdbde6fa88b5463e198d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HDXpQntRIa_xB16BKITpAw.png"/></div></div></figure><p id="7211" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">在下面的动画中，我们可以看到在训练期间学习到的各国首都在地球上的位置。在开始时，位置是随机分散的，但是在训练之后，神经网络不仅学习输出正确的TSP参观，而且学习输出正确的表示，即各个首都的正确的3D坐标。值得注意的是，这是仅使用汉明距离损耗进行监督和在Gurobi中对网络输出使用混合整数程序的结果。</p><figure class="lr ls lt lu gt iv"><div class="bz fp l di"><div class="nr ne l"/></div></figure><h2 id="2294" class="lz ma je bd mb mc md dn me mf mg dp mh lc mi mj mk lg ml mm mn lk mo mp mq mr bi translated">结论</h2><p id="5dc0" class="pw-post-body-paragraph kt ku je kv b kw ms kf ky kz mt ki lb lc mu le lf lg mv li lj lk mw lm ln lo im bi translated">我们已经表明，事实上，在对解算器的成本函数的某些假设下，我们可以通过黑盒组合解算器传播梯度。这使我们能够实现标准神经网络结构基于传统监督所不能实现的组合概括。</p><p id="72fe" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">我们正在展示这种方法在处理需要组合推理的现实世界问题中有广泛的应用。我们已经演示了一个这样的应用程序来处理基于等级的度量优化[2]。然而，问题是我们离求解器成本的线性假设还有多远(理论上和实际上)。未来工作的另一个问题是，作为一个例子，我们是否可以了解MIP公式中组合问题的潜在约束。这种方法的应用范围很广，我们欢迎任何愿意合作的人来充分发挥这项工作的潜力。</p><h2 id="f465" class="lz ma je bd mb mc md dn me mf mg dp mh lc mi mj mk lg ml mm mn lk mo mp mq mr bi translated">相关推文</h2><figure class="lr ls lt lu gt iv"><div class="bz fp l di"><div class="ns ne l"/></div></figure><figure class="lr ls lt lu gt iv"><div class="bz fp l di"><div class="ns ne l"/></div></figure><h2 id="c9ae" class="lz ma je bd mb mc md dn me mf mg dp mh lc mi mj mk lg ml mm mn lk mo mp mq mr bi translated">参考</h2><p id="17a2" class="pw-post-body-paragraph kt ku je kv b kw ms kf ky kz mt ki lb lc mu le lf lg mv li lj lk mw lm ln lo im bi translated">[1] Vlastelica，Paulus等.<a class="ae lp" href="http://bit.ly/35IowfE" rel="noopener ugc nofollow" target="_blank">黑盒组合求解器的微分</a><em class="nt">arXiv预印本arXiv:1912.02175 </em> (2019)。(<a class="ae lp" href="http://bit.ly/35IowfE" rel="noopener ugc nofollow" target="_blank">http://bit.ly/35IowfE</a>)</p><p id="2530" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">[2]Rolínek等人，“使用黑盒区分优化基于等级的度量。”<em class="nt"> arXiv预印本arXiv:1912.03500 </em> (2019)。(<a class="ae lp" href="http://bit.ly/35EXIMN" rel="noopener ugc nofollow" target="_blank">http://bit.ly/35EXIMN</a>)</p><p id="186b" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated"><strong class="kv jf">确认</strong></p><p id="477f" class="pw-post-body-paragraph kt ku je kv b kw kx kf ky kz la ki lb lc ld le lf lg lh li lj lk ll lm ln lo im bi translated">这是来自马普智能系统研究所<a class="ae lp" href="https://al.is.tuebingen.mpg.de/" rel="noopener ugc nofollow" target="_blank">自主学习小组</a>和意大利费伦泽大学的联合工作。</p></div></div>    
</body>
</html>