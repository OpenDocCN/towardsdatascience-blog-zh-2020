# è®¤è¯†ç†ŠçŒ«æœ€éš¾çš„åŠŸèƒ½ï¼Œç¬¬äºŒéƒ¨åˆ†

> åŸæ–‡ï¼š<https://towardsdatascience.com/meet-the-hardest-functions-of-pandas-part-ii-f8029a2b0c9b?source=collection_archive---------1----------------------->

## ç”¨ç†ŠçŒ«é‡å¡‘æ•°æ®æ¡†

## æŒæ¡`crosstab()`çš„æ—¶é—´å’Œæ–¹å¼

![](img/26c56682e791529a1ef3c8cc816a0dc1.png)

## ä»‹ç»

æˆ‘è®°å¾—è‡ªå·±åœ¨ DataCamp ä¸Šå‚åŠ äº†ä¸€ä¸ªåä¸ºâ€œSeaborn ä¸­çº§æ•°æ®å¯è§†åŒ–â€çš„è¯¾ç¨‹ã€‚å®ƒä¸º DV æ•™æˆäº†éå¸¸æ£’çš„æƒ…èŠ‚å’Œæ–¹æ³•ã€‚å½“è°ˆåˆ°çƒ­å›¾æ—¶ï¼Œä¸çŸ¥ä»å“ªé‡Œå†’å‡ºæ¥çš„è®²å¸ˆä»‹ç»äº†ä¸€ä¸ªå…¨æ–°çš„`pandas`åŠŸèƒ½`crosstab()`ã€‚ç„¶åï¼Œèµ¶ç´§è¯´:â€œ`crosstab()`æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„å‡½æ•°ï¼Œå¯ä»¥è®¡ç®—äº¤å‰åˆ¶è¡¨è¡¨â€¦â€¦â€

æˆ‘åœ¨é‚£é‡Œè¿·è·¯äº†ã€‚æ˜¾ç„¶ï¼Œæˆ‘çš„ç¬¬ä¸€ååº”æ˜¯æŸ¥çœ‹è¯¥å‡½æ•°çš„æ–‡æ¡£ã€‚æˆ‘åˆšåˆšå¼€å§‹è§‰å¾—æˆ‘å¯ä»¥å¤„ç† Matplotlib ä¹‹åçš„ä»»ä½•æ–‡æ¡£ï¼Œä½†æ˜¯â€¦æˆ‘é”™äº†ã€‚ç”šè‡³è¿™äº›ä¾‹å­éƒ½æ˜¯åœ¨`numpy`é˜µåˆ—ä¸Šç»™å‡ºçš„ï¼Œè€Œæˆ‘æœ¬åº”è¯¥ä½¿ç”¨è¯¥æ­»çš„å‡½æ•°åˆ›å»ºçƒ­å›¾ğŸ¤¦â€â™‚ï¸.

åœ¨æˆ‘ç»ƒä¹ è¿‡ä¹‹åï¼Œæˆ‘çŸ¥é“è¿™ä¹Ÿæ˜¯å…¶ä»–äººä¼šä¸ºä¹‹å¥‹æ–—çš„äº‹æƒ…ã€‚æ‰€ä»¥ï¼Œæˆ‘åœ¨è¿™é‡Œå†™äº†ä¸€æ•´ç¯‡æ–‡ç« ã€‚

åœ¨æœ¬æ–‡çš„æœ€åä¸€éƒ¨åˆ†ï¼Œæˆ‘è°ˆåˆ°äº†ä¸ºä»€ä¹ˆæœ‰äº›è¯¾ç¨‹ä¸æ•™ä½ `crosstab()`è¿™æ ·çš„é«˜çº§åŠŸèƒ½ã€‚å¾ˆéš¾åˆ›å»ºè¿™æ ·çš„å‡½æ•°æœ‰ç”¨çš„ä¸Šä¸‹æ–‡ï¼ŒåŒæ—¶ä¿æŒåˆå­¦è€…çš„æ°´å¹³ã€‚æ­¤å¤–ï¼Œå¤§å¤šæ•°è¯¾ç¨‹ä½¿ç”¨å°å‹æˆ–ç©å…·æ•°æ®é›†ã€‚æ­¤ç±»åŠŸèƒ½çš„ä¼˜åŠ¿åœ¨æ›´å¤æ‚çš„æ•°æ®ç§‘å­¦ç¯å¢ƒä¸­æ›´ä¸ºæ˜æ˜¾ï¼Œé€šå¸¸ç”±æ›´æœ‰ç»éªŒçš„ç”¨æˆ·ä½¿ç”¨`pandas`ã€‚

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†æ•™ä½ å¦‚ä½•ä½¿ç”¨`crosstab()`ï¼Œä»¥åŠä½ é€‰æ‹©å®ƒè€Œä¸æ˜¯å…¶ä»–ç±»ä¼¼å‡½æ•°çš„æƒ…å†µã€‚å°½æƒ…äº«å—å§ï¼

[](https://ibexorigin.medium.com/membership) [## é€šè¿‡æˆ‘çš„æ¨èé“¾æ¥åŠ å…¥ Medium-BEXGBoost

### è·å¾—ç‹¬å®¶è®¿é—®æˆ‘çš„æ‰€æœ‰âš¡premiumâš¡å†…å®¹å’Œæ‰€æœ‰åª’ä½“æ²¡æœ‰é™åˆ¶ã€‚æ”¯æŒæˆ‘çš„å·¥ä½œï¼Œç»™æˆ‘ä¹°ä¸€ä¸ªâ€¦

ibexorigin.medium.com](https://ibexorigin.medium.com/membership) 

è·å¾—ç”±å¼ºå¤§çš„ AI-Alpha ä¿¡å·é€‰æ‹©å’Œæ€»ç»“çš„æœ€ä½³å’Œæœ€æ–°çš„ ML å’Œ AI è®ºæ–‡:

[](https://alphasignal.ai/?referrer=Bex) [## é˜¿å°”æ³•ä¿¡å·|æœºå™¨å­¦ä¹ çš„æå“ã€‚è‰¾æ€»ç»“çš„ã€‚

### ç•™åœ¨å¾ªç¯ä¸­ï¼Œä¸ç”¨èŠ±æ— æ•°æ—¶é—´æµè§ˆä¸‹ä¸€ä¸ªçªç ´ï¼›æˆ‘ä»¬çš„ç®—æ³•è¯†åˆ«â€¦

alphasignal.ai](https://alphasignal.ai/?referrer=Bex) 

## å¯ç‚¹å‡»çš„ç›®å½•(ä»…é™ç½‘ç»œ)

âˆ˜ [ç®€ä»‹](#c82f)
âˆ˜ [è®¾ç½®](#f5ba)
âˆ˜ [ç†ŠçŒ«äº¤å‰è¡¨()ï¼ŒåŸºç¡€çŸ¥è¯†](#d10e)
âˆ˜ [ç†ŠçŒ«äº¤å‰è¡¨()ä¸ pivot_table()å’Œ groupby()çš„æ¯”è¾ƒ](#1bf9)
âˆ˜ [ç†ŠçŒ«äº¤å‰è¡¨()ï¼Œè¿›ä¸€æ­¥å®šåˆ¶](#6f16)
âˆ˜ [ç†ŠçŒ«äº¤å‰è¡¨()ï¼Œå¤šä¸ªåˆ†ç»„](#7569)

> ä½ å¯ä»¥åœ¨ [this](https://github.com/BexTuychiev/medium_stories/tree/master/hardest_of_pandas2) GitHub repo ä¸Šä¸‹è½½è¿™ç¯‡æ–‡ç« çš„ç¬”è®°æœ¬ã€‚

## è®¾ç½®

å¯¹äºæ ·æœ¬æ•°æ®ï¼Œæˆ‘å°†ä½¿ç”¨ Seaborn å†…ç½®çš„`diamonds`æ•°æ®é›†ã€‚å®ƒè¶³å¤Ÿå¤§ï¼Œå¹¶ä¸”å…·æœ‰å¯ä»¥ç”¨`crosstab()`æ¦‚æ‹¬çš„å˜é‡:

![](img/f5055945b0b03577978f279d7c1f670f.png)

> ä»ç°åœ¨å¼€å§‹ï¼Œåœ¨æ¯ä¸ªå‡½æ•°çš„æ–‡æ¡£ç¬¬ä¸€æ¬¡å‡ºç°æ—¶ï¼Œæˆ‘éƒ½ä½¿ç”¨äº†è¶…é“¾æ¥ã€‚

## ç†ŠçŒ«`crosstab()`ï¼ŒåŸºç¡€çŸ¥è¯†

åƒè®¸å¤šè®¡ç®—åˆ†ç»„æ±‡æ€»ç»Ÿè®¡æ•°æ®çš„å‡½æ•°ä¸€æ ·ï¼Œ`[crosstab()](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.crosstab.html)`å¤„ç†åˆ†ç±»æ•°æ®ã€‚å®ƒå¯ç”¨äºå°†ä¸¤ä¸ªæˆ–å¤šä¸ªå˜é‡åˆ†ç»„ï¼Œå¹¶ä¸ºæ¯ä¸ªç»„çš„ç»™å®šå€¼æ‰§è¡Œè®¡ç®—ã€‚å½“ç„¶ï¼Œè¿™æ ·çš„æ“ä½œä½¿ç”¨`[groupby()](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html)`æˆ–`[pivot_table()](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html)`æ˜¯å¯èƒ½çš„ï¼Œä½†æ˜¯æ­£å¦‚æˆ‘ä»¬å°†åœ¨åé¢çœ‹åˆ°çš„ï¼Œ`crosstab()`ç»™ä½ çš„æ—¥å¸¸å·¥ä½œæµç¨‹å¸¦æ¥äº†è®¸å¤šå¥½å¤„ã€‚

`crosstab()`å‡½æ•°æ¥å—ä¸¤ä¸ªæˆ–å¤šä¸ªåˆ—è¡¨ã€`pandas`ç³»åˆ—æˆ– dataframe åˆ—ï¼Œå¹¶é»˜è®¤è¿”å›æ¯ä¸ªç»„åˆçš„é¢‘ç‡ã€‚æˆ‘æ€»æ˜¯å–œæ¬¢ä»ä¾‹å­å¼€å§‹ï¼Œè¿™æ ·ä½ å¯ä»¥æ›´å¥½åœ°ç†è§£å®šä¹‰ï¼Œç„¶åæˆ‘ä¼šç»§ç»­è§£é‡Šè¯­æ³•ã€‚

`crosstab()`æ€»æ˜¯è¿”å›ä¸€ä¸ªæ•°æ®å¸§ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚æ•°æ®æ¡†æ˜¯æ¥è‡ª`diamonds`çš„ä¸¤ä¸ªå˜é‡çš„äº¤å‰åˆ—è¡¨:`cut`å’Œ`color`ã€‚äº¤å‰åˆ¶è¡¨åªæ˜¯æŒ‡å–ä¸€ä¸ªå˜é‡ï¼Œå°†å…¶åˆ†ç»„æ˜¾ç¤ºä¸ºç´¢å¼•ï¼Œå–å¦ä¸€ä¸ªå˜é‡ï¼Œå°†å…¶åˆ†ç»„æ˜¾ç¤ºä¸ºåˆ—ã€‚

![](img/8348199177b533f4fa76a703aea64878.png)

è¯­æ³•ç›¸å½“ç®€å•ã€‚`index`ç”¨äºå°†å˜é‡åˆ†ç»„å¹¶æ˜¾ç¤ºä¸ºç´¢å¼•(è¡Œ)ï¼Œä¸`columns`ç›¸åŒã€‚å¦‚æœæ²¡æœ‰ç»™å®šèšåˆå‡½æ•°ï¼Œæ¯ä¸ªå•å…ƒæ ¼å°†è®¡ç®—æ¯ä¸ªç»„åˆä¸­çš„è§‚å¯Ÿå€¼æ•°é‡ã€‚ä¾‹å¦‚ï¼Œå·¦ä¸Šè§’çš„å•å…ƒæ ¼å‘Šè¯‰æˆ‘ä»¬æœ‰ 2834 é¢— ***ç†æƒ³åˆ‡å‰²çš„*** é’»çŸ³ï¼Œé¢œè‰²ä»£ç ä¸º ***D*** ã€‚

æ¥ä¸‹æ¥ï¼Œå¯¹äºæ¯ä¸ªç»„åˆï¼Œæˆ‘ä»¬å¸Œæœ›çœ‹åˆ°å®ƒä»¬çš„å¹³å‡ä»·æ ¼ã€‚`crosstab()`æä¾›`values`å‚æ•°ï¼Œä»¥å¼•å…¥ç¬¬ä¸‰ä¸ªæ•°å€¼å˜é‡è¿›è¡Œæ±‡æ€»:

![](img/587b7216d49e0a49bec8d8269617afb2.png)

ç°åœ¨ï¼Œæ¯ä¸ªå•å…ƒæ ¼åŒ…å«æ¯ç§åˆ‡å‰²å’Œé¢œè‰²ç»„åˆçš„å¹³å‡ä»·æ ¼ã€‚ä¸ºäº†å‘Šè¯‰æˆ‘ä»¬è¦è®¡ç®—å¹³å‡ä»·æ ¼ï¼Œæˆ‘ä»¬å°†`price`åˆ—ä¼ é€’ç»™`values`ã€‚è¯·æ³¨æ„ï¼Œæ‚¨å¿…é¡»åŒæ—¶ä½¿ç”¨`values`å’Œ`aggfunc`ã€‚å¦åˆ™ï¼Œæ‚¨å°†å¾—åˆ°ä¸€ä¸ªé”™è¯¯ã€‚æˆ‘è¿˜ç”¨`round()`æŠŠç­”æ¡ˆå››èˆäº”å…¥äº†ã€‚

å³ä½¿å®ƒæœ‰ç‚¹é«˜çº§ï¼Œå½“æ‚¨å°†å®ƒä»¬ä¼ é€’åˆ°`seaborn`çš„çƒ­å›¾ä¸­æ—¶ï¼Œæ‚¨å°†å……åˆ†åˆ©ç”¨`crosstab()`è¡¨çš„å¥½å¤„ã€‚è®©æˆ‘ä»¬åœ¨çƒ­å›¾ä¸­æŸ¥çœ‹ä¸Šè¡¨:

![](img/faa301c58f957321c7df3f45241a4063.png)

`seaborn`å¯ä»¥è‡ªåŠ¨å°†`crosstab()`è¡¨æ ¼å˜æˆçƒ­å›¾ã€‚æˆ‘å°†æ³¨é‡Šè®¾ç½®ä¸º`True`ï¼Œå¹¶ç”¨é¢œè‰²æ¡æ˜¾ç¤ºçƒ­å›¾ã€‚`seaborn`è¿˜ä¸ºåˆ—åå’Œç´¢å¼•åæ·»åŠ æ ·å¼(`fmt = 'g'`å°†æ•°å­—æ˜¾ç¤ºä¸ºæ•´æ•°ï¼Œè€Œä¸æ˜¯ç§‘å­¦è®°æ•°æ³•)ã€‚

çƒ­å›¾æ›´å®¹æ˜“è§£è¯»ã€‚ä½ ä¸å¸Œæœ›ä½ çš„ç»ˆç«¯ç”¨æˆ·çœ‹ç€æ»¡æ˜¯æ•°å­—çš„è¡¨æ ¼æ—¶çœ¼ç›**æµè¡€ã€‚æ‰€ä»¥ï¼Œæˆ‘ä¼šåœ¨éœ€è¦çš„æ—¶å€™æŠŠæ¯ä¸ª`crosstab()`ç»“æœæ”¾åˆ°çƒ­å›¾ä¸­ã€‚ä¸ºäº†é¿å…é‡å¤ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªæœ‰ç”¨çš„å‡½æ•°:**

## ç†ŠçŒ«äº¤å‰è¡¨()ä¸ pivot_table()å’Œ groupby()çš„æ¯”è¾ƒ

åœ¨æˆ‘ä»¬å¼€å§‹æ›´æœ‰è¶£çš„ä¸œè¥¿ä¹‹å‰ï¼Œæˆ‘æƒ³æˆ‘éœ€è¦æ¾„æ¸…è®¡ç®—åˆ†ç»„æ±‡æ€»ç»Ÿè®¡çš„ä¸‰ä¸ªå‡½æ•°ä¹‹é—´çš„åŒºåˆ«ã€‚

æˆ‘åœ¨æ–‡ç« çš„ç¬¬ä¸€éƒ¨åˆ†çš„[ä¸­æåˆ°äº†`pivot_table()`å’Œ`groupby()`çš„åŒºåˆ«ã€‚å¯¹äº`crosstab()`ï¼Œä¸‰è€…çš„åŒºåˆ«åœ¨äºè¯­æ³•å’Œç»“æœçš„å½¢çŠ¶ã€‚è®©æˆ‘ä»¬ä½¿ç”¨æ‰€æœ‰ä¸‰ä¸ªæ¥è®¡ç®—æœ€åä¸€ä¸ª`crosstab()`è¡¨:](/meet-the-hardest-functions-of-pandas-part-i-7d1f74597e92)

![](img/587b7216d49e0a49bec8d8269617afb2.png)

æ•°æ®é€è§†è¡¨çš„è¾“å‡º

![](img/587b7216d49e0a49bec8d8269617afb2.png)

äº¤å‰è¡¨çš„è¾“å‡º

æˆ‘æƒ³ä½ å·²ç»çŸ¥é“ä½ çš„æœ€çˆ±äº†ã€‚`groubpy()`è¿”å›ä¸€ä¸ªåºåˆ—ï¼Œè€Œå¦å¤–ä¸¤ä¸ªè¿”å›ç›¸åŒçš„æ•°æ®å¸§ã€‚ç„¶è€Œï¼Œå¯ä»¥å°†`groupby`ç³»åˆ—è½¬æ¢æˆç›¸åŒçš„æ•°æ®å¸§ï¼Œå¦‚ä¸‹æ‰€ç¤º:

![](img/587b7216d49e0a49bec8d8269617afb2.png)

> å¦‚æœä½ ä¸ç†è§£`pivot_table()`å’Œ`unstack()`çš„è¯­æ³•ï¼Œæˆ‘å¼ºçƒˆå»ºè®®ä½ é˜…è¯»æ–‡ç« çš„[ç¬¬ä¸€éƒ¨åˆ†](/meet-the-hardest-functions-of-pandas-part-i-7d1f74597e92)ã€‚

è¯´åˆ°é€Ÿåº¦ï¼Œ`crosstab()`æ¯”`pivot_table()`å¿«ï¼Œä½†éƒ½æ¯”`groupby()`æ…¢å¾—å¤š:

å¦‚ä½ æ‰€è§ï¼Œå³ä½¿ä¸`unstack()`é“¾æ¥åœ¨ä¸€èµ·ï¼Œ`groupby()`ä¹Ÿæ¯”å…¶ä»–ä¸¤ä¸ªå¿« 3 å€ã€‚è¿™å‘Šè¯‰æˆ‘ä»¬ï¼Œå¦‚æœæ‚¨åªæƒ³åˆ†ç»„å’Œè®¡ç®—æ±‡æ€»ç»Ÿè®¡æ•°æ®ï¼Œé‚£ä¹ˆæ‚¨åº”è¯¥ä½¿ç”¨ç›¸åŒçš„ ol' `groupby()`ã€‚å½“æˆ‘é“¾æ¥å…¶ä»–æ–¹æ³•å¦‚ simple `round()`æ—¶ï¼Œé€Ÿåº¦å·®å¼‚ç”šè‡³æ›´å¤§ã€‚

å‰©ä¸‹çš„æ¯”è¾ƒå°†ä¸»è¦æ˜¯å…³äº`pivot_table()`å’Œ`crosstab()`ã€‚å¦‚æ‚¨æ‰€è§ï¼Œä¸¤ä¸ªå‡½æ•°çš„ç»“æœå½¢çŠ¶æ˜¯ç›¸åŒçš„ã€‚ä¸¤è€…çš„ç¬¬ä¸€ä¸ªåŒºåˆ«æ˜¯`crosstab()`å¯ä»¥å¤„ç†ä»»ä½•æ•°æ®ç±»å‹ã€‚

å®ƒå¯ä»¥æ¥å—ä»»ä½•ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œå¦‚åˆ—è¡¨ã€`numpy`æ•°ç»„ã€æ•°æ®æ¡†åˆ—(æ˜¯`pandas`ç³»åˆ—)ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ`pivot_table()`åªå¯¹æ•°æ®å¸§æœ‰æ•ˆã€‚åœ¨ä¸€ä¸ªæœ‰ç”¨çš„ StackOverflow [çº¿ç¨‹](https://stackoverflow.com/questions/36267745/how-is-a-pandas-crosstab-different-from-a-pandas-pivot-table)ä¸­ï¼Œæˆ‘å‘ç°å¦‚æœä½ åœ¨ä¸€ä¸ªæ•°æ®å¸§ä¸Šä½¿ç”¨`crosstab()`ï¼Œå®ƒä¼šåœ¨åå°è°ƒç”¨`pivot_table()`ã€‚

æ¥ä¸‹æ¥æ˜¯å‚æ•°ã€‚æœ‰äº›å‚æ•°åªå­˜åœ¨äºä¸€ä¸ªä¸­ï¼Œåä¹‹äº¦ç„¶ã€‚ç¬¬ä¸€ä¸ªæœ€å—æ¬¢è¿çš„æ˜¯`crosstab()`çš„`normalize`ã€‚`normalize`æ¥å—è¿™äº›é€‰é¡¹(æ¥è‡ªæ–‡æ¡£):

*   å¦‚æœé€šè¿‡`all`æˆ–`True`ï¼Œå°†å¯¹æ‰€æœ‰å€¼è¿›è¡Œæ ‡å‡†åŒ–ã€‚
*   å¦‚æœé€šè¿‡,`index`å°†å¯¹æ¯è¡Œè¿›è¡Œæ ‡å‡†åŒ–ã€‚
*   å¦‚æœé€šè¿‡`columns`å°†å¯¹æ¯ä¸€åˆ—è¿›è¡Œæ ‡å‡†åŒ–ã€‚

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­:

![](img/75d135abde5c18d373fa78fa533f463b.png)

æ•°é‡æœ€å¤šçš„é’»çŸ³æ˜¯å¸¦æœ‰ ***ç†æƒ³åˆ‡å·¥*** å’Œè‰²ç  ***G*** çš„ã€‚

å¦‚æœé€šè¿‡`all`ï¼Œå¯¹äºæ¯ä¸ªå•å…ƒæ ¼ï¼Œ`pandas`å°†è®¡ç®—æ€»é‡çš„ç™¾åˆ†æ¯”:

å¦‚æœé€šè¿‡ï¼Œ`index`æˆ–`columns`ï¼Œåˆ™æŒ‰åˆ—æˆ–è¡Œæ‰§è¡Œç›¸åŒçš„æ“ä½œ:

![](img/bbbf978ee49318a33647ba19677a39aa.png)

æŒ‰è¡Œè§„èŒƒåŒ–ã€‚çœ‹æ¥åœ¨å‡ ä¹æ‰€æœ‰ç±»å‹çš„é’»çŸ³åˆ‡å·¥ä¸­ï¼Œå®ƒä»¬çš„æœ€é«˜ç¼–å·éƒ½æœ‰é¢œè‰²ä»£ç  ***G*** ã€‚

![](img/c7878935b15633f0aab4c9a8c2ebef2e.png)

æŒ‰åˆ—è§„èŒƒåŒ–ã€‚çƒ­å›¾å†æ¬¡æ˜¾ç¤ºï¼Œåœ¨æ•°æ®é›†ä¸­ï¼Œå¯¹äºæ¯ç§é¢œè‰²ä»£ç ï¼Œç†æƒ³åˆ‡å‰²çš„**é’»çŸ³æ•°é‡è¦é«˜å¾—å¤šã€‚**

åœ¨`crosstab()`ä¸­ï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨`rownames`å’Œ`colnames`åœ¨å‡½æ•°ä¸­ç›´æ¥æ›´æ”¹ç´¢å¼•å’Œåˆ—åã€‚æ‚¨ä¸å¿…åœ¨ä¹‹åæ‰‹åŠ¨æ“ä½œã€‚å½“æˆ‘ä»¬ä¸€æ¬¡æŒ‰å¤šä¸ªå˜é‡åˆ†ç»„æ—¶ï¼Œè¿™ä¸¤ä¸ªå‚æ•°éå¸¸æœ‰ç”¨ï¼Œç¨åæ‚¨å°†ä¼šçœ‹åˆ°ã€‚

å‚æ•°`fill_value`åªå­˜åœ¨äº`pivot_table()`ä¸­ã€‚æœ‰æ—¶ï¼Œå½“æ‚¨æŒ‰è®¸å¤šå˜é‡åˆ†ç»„æ—¶ï¼Œä¸å¯é¿å…åœ°ä¼šæœ‰`NaN` sã€‚åœ¨`pivot_table()`ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`fill_value`å°†å®ƒä»¬æ›´æ”¹ä¸ºè‡ªå®šä¹‰å€¼:

ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ä½¿ç”¨`crosstab()`ï¼Œæ‚¨å¯ä»¥é€šè¿‡åœ¨æ•°æ®å¸§ä¸Šé“¾æ¥`fillna()`æ¥å®ç°åŒæ ·çš„äº‹æƒ…:

## ç†ŠçŒ«äº¤å‰è¡¨()ï¼Œè¿›ä¸€æ­¥å®šåˆ¶

`crosstab()`çš„å¦å¤–ä¸¤ä¸ªæœ‰ç”¨å‚æ•°æ˜¯`margins`å’Œ`margins_name`(ä¸¤è€…ä¹Ÿå­˜åœ¨äº`pivot_table()`ä¸­)ã€‚å½“è®¾ç½®ä¸º`True`æ—¶ï¼Œ`margins`è®¡ç®—æ¯è¡Œå’Œæ¯åˆ—çš„å°è®¡ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­:

![](img/f4b9b1872663b5b44a24b364f5a8aa1d.png)

`pandas`è‡ªåŠ¨æ·»åŠ æœ€åä¸€è¡Œå’Œæœ€åä¸€åˆ—ï¼Œé»˜è®¤åç§°ä¸º`All`ã€‚æ§åˆ¶è¡Œä¸º:

![](img/ab8151e82558d368acceae7c37da0d4f.png)

å¦‚æœ`normalize`è¢«è®¾ç½®ä¸º`True`ï¼Œå³ä¸‹è§’çš„å•å…ƒæ ¼å°†å§‹ç»ˆåŒ…å«è§‚å¯Ÿçš„æ€»æ•°æˆ– 1:

![](img/637f068904d1cef52d8979e65f785e81.png)

> è¯·æ³¨æ„ï¼Œå¦‚æœå°†`margins`è®¾ç½®ä¸º`True`ï¼Œçƒ­å›¾æ˜¯æ²¡æœ‰ç”¨çš„ã€‚

## ç†ŠçŒ«`crosstab()`ï¼Œå¤šç»„

å¯¹äº`index`å’Œ`columns`å‚æ•°ï¼Œå¯ä»¥ä¼ é€’å¤šä¸ªå˜é‡ã€‚ç»“æœå°†æ˜¯ä¸€ä¸ªå¸¦æœ‰**å¤šçº§ç´¢å¼•**çš„æ•°æ®å¸§ã€‚è¿™æ¬¡è®©æˆ‘ä»¬æ’å…¥æ‰€æœ‰çš„åˆ†ç±»å˜é‡:

![](img/8536bbece835b9eafc615d557f7a1beb.png)

å¯¹äºæŒ‡æ•°ï¼Œæˆ‘é€šè¿‡äº†`color`å’Œ`cut`ã€‚å¦‚æœæˆ‘å°†å®ƒä»¬ä¼ é€’ç»™`columns`ï¼Œç»“æœå°†æ˜¯ä¸€ä¸ªæœ‰ 40 åˆ—çš„æ•°æ®å¸§ã€‚å¦‚æœæ‚¨æ³¨æ„çš„è¯ï¼Œå¤šçº§ç´¢å¼•å¦‚é¢„æœŸçš„é‚£æ ·è¢«å‘½åä¸º`cut`å’Œ`clarity`ã€‚å¯¹äºå­˜åœ¨å¤šçº§ç´¢å¼•æˆ–åˆ—åçš„æƒ…å†µï¼Œ`crosstab()`æœ‰æ–¹ä¾¿çš„å‚æ•°æ¥æ›´æ”¹å®ƒä»¬çš„åç§°:

![](img/7cad9305c0b7d81ba3cccbb899616afa.png)

æ‚¨ä¼ é€’ä¸€ä¸ªç›¸åº”åç§°çš„åˆ—è¡¨æ¥å°†ç´¢å¼•åç§°æ›´æ”¹ä¸º`rownames`ã€‚å¯¹äºæ§åˆ¶åˆ—åçš„`colnames`,è¿‡ç¨‹æ˜¯ç›¸åŒçš„ã€‚

è®©æˆ‘æƒŠè®¶çš„ä¸€ä»¶äº‹æ˜¯ï¼Œå¦‚æœä½ æŠŠå¤šä¸ªå‡½æ•°ä¼ é€’ç»™`aggfunc`ï¼Œ`pandas`ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚å†è¯´ä¸€æ¬¡ï¼ŒStackOverflow ä¸Šçš„äººè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ª bugï¼Œå·²ç»è¶…è¿‡ 6 å¹´æ²¡æœ‰è§£å†³äº†ã€‚å¦‚æœä½ æœ‰ä»»ä½•æƒ³æ³•ï¼Œè¯·åœ¨è¯„è®ºä¸­ç•™ä¸‹ï¼Œè¿™æ ·æˆ‘ä»¬éƒ½å¯ä»¥å­¦ä¹ ğŸ™Œã€‚

æœ€åè¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨`pivot_table()`å’Œ`crosstab()`ä¸­ï¼Œéƒ½æœ‰ä¸€ä¸ª`dropna`å‚æ•°ï¼Œå¦‚æœè®¾ç½®ä¸º`True`ï¼Œåˆ™åˆ é™¤æ‰€æœ‰`NaN`çš„åˆ—æˆ–è¡Œã€‚

# å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·åˆ†äº«å¹¶ç•™ä¸‹åé¦ˆã€‚ä½œä¸ºä¸€åä½œå®¶ï¼Œä½ çš„æ”¯æŒå¯¹æˆ‘æ¥è¯´æ„å‘³ç€ä¸€åˆ‡ï¼

é˜…è¯»æ›´å¤šä¸ä¸»é¢˜ç›¸å…³çš„æ–‡ç« :

[](/meet-the-hardest-functions-of-pandas-part-i-7d1f74597e92) [## è®¤è¯†ç†ŠçŒ«æœ€éš¾çš„åŠŸèƒ½ï¼Œç¬¬ä¸€éƒ¨åˆ†

### æŒæ¡ pivot_table()ã€stack()ã€unstack()çš„æ—¶æœºå’Œæ–¹å¼

towardsdatascience.com](/meet-the-hardest-functions-of-pandas-part-i-7d1f74597e92) [](/meet-the-hardest-functions-of-pandas-part-ii-f8029a2b0c9b) [## è®¤è¯†ç†ŠçŒ«æœ€éš¾çš„åŠŸèƒ½ï¼Œç¬¬äºŒéƒ¨åˆ†

### æŒæ¡äº¤å‰è¡¨çš„æ—¶é—´å’Œæ–¹å¼()

towardsdatascience.com](/meet-the-hardest-functions-of-pandas-part-ii-f8029a2b0c9b) [](/shape-tables-like-jelly-with-pandas-melt-and-pivot-f2e13e666d6) [## è®¤è¯†ç†ŠçŒ«æœ€éš¾çš„åŠŸèƒ½ï¼Œç¬¬ä¸‰éƒ¨åˆ†

### å½¢çŠ¶åƒæœå†»çš„æ¡Œå­æœ‰ç†ŠçŒ«æ—‹è½¬()å’ŒèåŒ–()

towardsdatascience.com](/shape-tables-like-jelly-with-pandas-melt-and-pivot-f2e13e666d6) [](/masteriadsf-246b4c16daaf) [## æŒæ¡è¿æ¥:Pandas åˆå¹¶ã€è¿æ¥ã€è¿½åŠ æ–¹æ³•

### ä»åŠè¿æ¥/åè¿æ¥åˆ°éªŒè¯æ•°æ®åˆå¹¶

towardsdatascience.com](/masteriadsf-246b4c16daaf) [](/how-i-customarily-bin-data-with-pandas-9303c9e4d946) [## æˆ‘ä¹ æƒ¯å¦‚ä½•å°†æ•°æ®ä¸ç†ŠçŒ«ç»‘å®š

### æ‚¨å¯èƒ½åªä½¿ç”¨äº†é»˜è®¤å€¼

towardsdatascience.com](/how-i-customarily-bin-data-with-pandas-9303c9e4d946) [](/from-kagglers-best-project-setup-for-ds-and-ml-ffb253485f98) [## æ¥è‡ª Kagglers:DS å’Œ ML çš„æœ€ä½³é¡¹ç›®è®¾ç½®

### æ¥è‡ªé¡¶çº§ Kagglers çš„é¡¹ç›®æˆåŠŸæœ€ä½³å®è·µçš„é›†åˆ

towardsdatascience.com](/from-kagglers-best-project-setup-for-ds-and-ml-ffb253485f98)