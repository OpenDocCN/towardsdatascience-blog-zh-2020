<html>
<head>
<title>All About Python List Comprehension</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于Python列表理解的所有内容</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/all-about-python-list-comprehension-14dd979ec0d1?source=collection_archive---------30-----------------------#2020-05-24">https://towardsdatascience.com/all-about-python-list-comprehension-14dd979ec0d1?source=collection_archive---------30-----------------------#2020-05-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/b4c9b42b136839645e3d787c6912a19f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uUTj1ax1NVkbvRGUxW-LrA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片提供:Pixabay</p></figure><div class=""/><div class=""><h2 id="09f2" class="pw-subtitle-paragraph kf jh ji bd b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw dk translated">优雅、舒适、简洁、快速的列表创建方式</h2></div><p id="dde6" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">Python是一种用简洁的代码表达的语言，非常优雅，易于理解。列表理解提供了一种创建列表的简洁方法。列表理解是构建一个可访问的、简洁的、快速的列表的合适的“pythonic式”方法。它允许使用一行代码对列表执行复杂的操作。</p><h1 id="ceae" class="lt lu ji bd lv lw lx ly lz ma mb mc md ko me kp mf kr mg ks mh ku mi kv mj mk bi translated">什么是列表理解？</h1><p id="215b" class="pw-post-body-paragraph kx ky ji kz b la ml kj lc ld mm km lf lg mn li lj lk mo lm ln lo mp lq lr ls im bi translated">列表理解为我们提供了一种简单的方法来创建一个基于某种序列的列表或者另一个我们可以循环的列表。在python术语中，任何可以循环的东西都称为iterable。在最基本的层面上，列表理解是一种从现有列表创建列表的语法结构。列表理解的核心，就是循环(“for”循环)。我们可以将任何列表理解表示为for循环，但是当我们在一行中用等价的列表理解来表示它时，它看起来确实是独一无二的。</p><p id="5e33" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">列表理解有以下几个重要部分:</p><ol class=""><li id="9505" class="mq mr ji kz b la lb ld le lg ms lk mt lo mu ls mv mw mx my bi translated">一个可迭代的输入序列(可以是一个列表、一个范围或者任何序列)，我们使用一个变量名来迭代它。</li><li id="3b49" class="mq mr ji kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated">输出表达式</li><li id="dc42" class="mq mr ji kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated">变量过滤或映射或执行某些逻辑操作的可选条件</li></ol><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ne"><img src="../Images/18d0b3f17edc1796f5f1ff079fad3613.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T7fcl8wIqlSrO9z6WcHE1g.png"/></div></div></figure><p id="038b" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">例如，如果我们想从1到5的变量列表中创建一个正方形列表，我们可以像下面这样使用标准的For循环，但是当我们使用列表理解时，它变得简洁和轻量级。</p><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nj"><img src="../Images/89d5789ee6fdb4d4aeffc8f0faeac40b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vDCTvLDtTahh4kfzjy1i8Q.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片:Pixabay的称重机</p></figure><p id="9e4d" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">如果我们分解列表理解部分，它看起来如下。</p><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nk"><img src="../Images/e4822741dccc760fdf6c57f6479f3f86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JtwtZPtmguABcRkayV-WIw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">解释一个简单列表，包括每个输入变量的输出平方</p></figure><p id="8d78" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">因此，这里iterable是range(1，6)，x是表示该范围内每个值的变量。对于每个x (1，2，3，4，5)，输出表达式x*x计算相应的输出(1，4，9，16，25)，最终成为最终的输出列表(参考上图)。</p><p id="fb31" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">基本构造之外的几种用法:</p><h1 id="3568" class="lt lu ji bd lv lw lx ly lz ma mb mc md ko me kp mf kr mg ks mh ku mi kv mj mk bi translated">1)基于条件的过滤</h1><p id="e035" class="pw-post-body-paragraph kx ky ji kz b la ml kj lc ld mm km lf lg mn li lj lk mo lm ln lo mp lq lr ls im bi translated">列表理解提供了一种方法来检查条件，并从输出的输入列表中过滤掉我们不需要的元素。这种过滤发生在输出表达式发生之前。参考下面的例子，我们只计算那些能被2整除的变量的平方。</p><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nl"><img src="../Images/240278196f35d4e19c45c8d16e32a21d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zwCHEE73TlKFPVPDDP8npQ.png"/></div></div></figure><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ne"><img src="../Images/2c8b7b152c9ac230367768aaa6f5b25a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zJ0XfN1fkWSvll2Bg8o46g.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">带有过滤条件的列表理解</p></figure><h1 id="1468" class="lt lu ji bd lv lw lx ly lz ma mb mc md ko me kp mf kr mg ks mh ku mi kv mj mk bi translated">2)嵌套条件</h1><p id="7677" class="pw-post-body-paragraph kx ky ji kz b la ml kj lc ld mm km lf lg mn li lj lk mo lm ln lo mp lq lr ls im bi translated">列表理解可以用来检查嵌套条件。参考下面的代码，我们想找到输入列表中所有的变量都可以被2，4 &amp; 5整除。</p><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nm"><img src="../Images/6e3ed914e0ad8728d82567bc83420256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uFMINpEzlskS-QkLfYeuiw.png"/></div></div></figure><h1 id="a637" class="lt lu ji bd lv lw lx ly lz ma mb mc md ko me kp mf kr mg ks mh ku mi kv mj mk bi translated">3)如果..列表理解中的else</h1><p id="e70f" class="pw-post-body-paragraph kx ky ji kz b la ml kj lc ld mm km lf lg mn li lj lk mo lm ln lo mp lq lr ls im bi translated">我们可以在Python的列表理解中使用“if-else”。参考下面的代码块，它查找奇数和偶数的数字列表。我们需要首先指定输出是什么，接着是“if”条件，然后是“else”，接着是“else”下的输出是什么</p><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nn"><img src="../Images/e0a5ec30217f183d6023d729fc9ce3e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LGvxvo4QWhSe3-Pl7_uckw.png"/></div></div></figure><p id="be0c" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">注意，如果不使用逗号和括号，我们不能直接打印输入值。</p><h1 id="cab6" class="lt lu ji bd lv lw lx ly lz ma mb mc md ko me kp mf kr mg ks mh ku mi kv mj mk bi translated">4)扁平化多维列表</h1><p id="345b" class="pw-post-body-paragraph kx ky ji kz b la ml kj lc ld mm km lf lg mn li lj lk mo lm ln lo mp lq lr ls im bi translated">假设我们必须展平一个2D列表。我们可以很容易地通过使用子列表来理解列表。</p><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi no"><img src="../Images/b26011248ef51fca3d9295648e749568.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UlGZWicxYiv1hqPjV_r45Q.png"/></div></div></figure><p id="1c99" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我们怎样才能使3D列表变平？这变得有点复杂，我们首先将3D平铺到2D，然后将2D平铺到1D。在下面的例子中，蓝色下划线部分是使2D从3D列表变平的步骤，然后外部部分对1D进行变平。</p><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi np"><img src="../Images/7de8049932693a93ee50a308c1859ece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GpducSHNnw1Pwt7xkPmsNQ.png"/></div></div></figure><h1 id="32e6" class="lt lu ji bd lv lw lx ly lz ma mb mc md ko me kp mf kr mg ks mh ku mi kv mj mk bi translated">5)嵌套的“for”列表理解</h1><p id="da6d" class="pw-post-body-paragraph kx ky ji kz b la ml kj lc ld mm km lf lg mn li lj lk mo lm ln lo mp lq lr ls im bi translated">我们可以对多个嵌套的“for”循环使用列表理解。当我们使用嵌套列表理解时，我们必须注意执行的顺序。假设我们有一个3x3的正方形矩阵，我们想使用这个矩阵创建一个矩阵，其中所有对角线值都必须是正方形，而其他值必须为零。这里的输出是一维的，我们需要额外的逻辑来转换成2D矩阵形式。这里我使用了“列”和“行”来解释，但是也可以直接用在“for循环”中，不需要中间变量(如下面列表理解中所使用的)。</p><pre class="nf ng nh ni gt nq nr ns nt aw nu bi"><span id="0284" class="nv lu ji nr b gy nw nx l ny nz">matrix = [[ 1, 2, 3],<br/>          [ 4, 5, 6],<br/>          [ 7, 8, 9]]</span><span id="d936" class="nv lu ji nr b gy oa nx l ny nz">row = len(matrix)<br/>column = len(matrix[0])<br/>output = []<br/>for i in range(row):<br/>    for j in range(column):<br/>        if i == j:<br/>            output.append(matrix[i][j] * matrix[i][j])<br/>        else:<br/>            output.append(0)<br/>            <br/>output<br/>[1, 0, 0, 0, 25, 0, 0, 0, 81]</span></pre><p id="8568" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">现在我们看到等价的嵌套列表理解(只有一行，但是为了容易理解，我用了3行)。</p><pre class="nf ng nh ni gt nq nr ns nt aw nu bi"><span id="9d26" class="nv lu ji nr b gy nw nx l ny nz">[[matrix[i][j]*matrix[i][j] if i == j else 0 <br/>              for i in range(len(matrix))] <br/>                  for j in range(len(matrix[0]))]</span></pre><p id="f209" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">现在，让我们通过每个循环是如何工作的图片来理解这一点。循环执行顺序是从上到下(绿色粗体箭头)。我们首先完成内部循环(深绿色)，然后控制回到外部循环(蓝色)。这里的列表理解是一行，而普通的“for循环”是五行，如上面的代码所示。我们也可以通过在第一个for循环后加括号直接得到输出的矩阵形式。</p><figure class="nf ng nh ni gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ob"><img src="../Images/0ef778535c1c43f6ed8c5388968b395b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hOvfVVEAPBV42LkLxMES1Q.png"/></div></div></figure><h1 id="ca6d" class="lt lu ji bd lv lw lx ly lz ma mb mc md ko me kp mf kr mg ks mh ku mi kv mj mk bi translated">列表理解的优势</h1><ol class=""><li id="1e5d" class="mq mr ji kz b la ml ld mm lg oc lk od lo oe ls mv mw mx my bi translated">列表理解的一个显著优点是开发人员需要编写更少的代码</li><li id="f5c6" class="mq mr ji kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated">列表理解通常变得更容易理解</li><li id="39d8" class="mq mr ji kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated">当向列表追加项目时，列表理解的速度明显优于for循环</li><li id="107c" class="mq mr ji kz b la mz ld na lg nb lk nc lo nd ls mv mw mx my bi translated">列表理解是内置的<strong class="kz jj">映射</strong>和<strong class="kz jj">过滤器</strong>函数的一个很好的替代品</li></ol><h1 id="6ada" class="lt lu ji bd lv lw lx ly lz ma mb mc md ko me kp mf kr mg ks mh ku mi kv mj mk bi translated">其他理解</h1><p id="afcf" class="pw-post-body-paragraph kx ky ji kz b la ml kj lc ld mm km lf lg mn li lj lk mo lm ln lo mp lq lr ls im bi translated">在Python中，我们也有“字典理解”和“集合理解”,它们在操作上是相似的，但只适用于字典和集合。Python也有“生成器表达式”，它使用了“圆形”括号。</p><h1 id="949e" class="lt lu ji bd lv lw lx ly lz ma mb mc md ko me kp mf kr mg ks mh ku mi kv mj mk bi translated">最后一个音符</h1><p id="3fae" class="pw-post-body-paragraph kx ky ji kz b la ml kj lc ld mm km lf lg mn li lj lk mo lm ln lo mp lq lr ls im bi translated">当我开始我的Python之旅时，我曾经发现理解列表理解是如何工作的很有挑战性。一旦我明白了它的优雅和力量，我就再也没有回头。尽管一开始感觉有点吓人，但是经过一点练习，每个python爱好者都可以爱上列表理解。</p><p id="1f28" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">我期待着你的评论和分享，如果你有任何独特的列表理解的经验。感谢阅读。可以联系我@ <a class="ae of" href="http://www.linkedin.com/in/baijayantaroy" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>。</p></div><div class="ab cl og oh hx oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="im in io ip iq"><p id="f858" class="pw-post-body-paragraph kx ky ji kz b la lb kj lc ld le km lf lg lh li lj lk ll lm ln lo lp lq lr ls im bi translated">只需每月5美元，就可以无限制地获取最鼓舞人心的内容……点击下面的链接，成为媒体会员，支持我的写作。谢谢大家！<br/><a class="ae of" href="https://baijayanta.medium.com/membership" rel="noopener"><strong class="kz jj"><em class="on">【https://baijayanta.medium.com/membership】</em></strong></a></p></div></div>    
</body>
</html>