# é€šè¿‡è§†é¢‘å½©è‰²åŒ–çš„è‡ªæˆ‘ç›‘ç£è·Ÿè¸ª

> åŸæ–‡ï¼š<https://towardsdatascience.com/self-supervised-tracking-via-video-colorization-7b2b066359d5?source=collection_archive---------44----------------------->

## ä½œä¸ºä»£ç†ä»»åŠ¡çš„è§†é¢‘ç€è‰²å’Œä½œä¸ºä¸‹æ¸¸ä»»åŠ¡çš„å¯¹è±¡è·Ÿè¸ª

![](img/c590540678b3cb7d0dd091b4676b1c09.png)

æ™®é‡Œè¥¿æ‹‰Â·æœÂ·æ™®é‡Œå…¹åœ¨ [Unsplash](https://unsplash.com/s/photos/night?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šçš„ç…§ç‰‡

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£ä¸€ç§æ–°é¢–çš„è‡ªç›‘ç£ç›®æ ‡è·Ÿè¸ªæ–¹æ³•ã€‚è‡ªæˆ‘ç›‘ç£æ˜¯æ¨¡å‹è‡ªæˆ‘å­¦ä¹ çš„ä¸€ç§æ–¹æ³•ğŸ˜ï¼Œè¿™æœ¬èº«å°±è®©é¢˜ç›®å¾ˆæœ‰æ„æ€ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°†çœ‹åˆ°æˆ‘ä»¬çš„æ¨¡å‹å¦‚ä½•å­¦ä¼šè‡ªå·±è·Ÿè¸ªå¯¹è±¡ã€‚æˆ‘ä»¬å°†ä»ç‰©ä½“è·Ÿè¸ªçš„åŸºç¡€å¼€å§‹ï¼Œç„¶åè®¨è®ºä»€ä¹ˆæ˜¯è®¡ç®—æœºè§†è§‰çš„è‡ªæˆ‘ç›‘ç£å­¦ä¹ ï¼Œæœ€åè¯¦ç»†è®¨è®ºè¿™ç§æ–¹æ³•ã€‚

> è¿™ä¸ªæ–¹æ³•çš„å®ç°å¯ä»¥åœ¨[è¿™é‡Œ](https://github.com/hyperparameters/tracking_via_colorization)æ‰¾åˆ°

# å¯¹è±¡è·Ÿè¸ªç®€ä»‹ğŸ¯

ç”¨ç®€å•çš„è¯­è¨€æ¥è¯´ï¼Œå®ƒå¯ä»¥ç†è§£ä¸ºåœ¨æ•´ä¸ªè§†é¢‘åºåˆ—ä¸­è¯†åˆ«å”¯ä¸€çš„å¯¹è±¡ã€‚è¦è·Ÿè¸ªçš„å¯¹è±¡é€šå¸¸è¢«ç§°ä¸º*ç›®æ ‡å¯¹è±¡ã€‚*è·Ÿè¸ªå¯ä»¥é€šè¿‡ [*åŒ…å›´ç›’*](https://d2l.ai/chapter_computer-vision/bounding-box.html) æˆ–è€… [*å®ä¾‹åˆ†å‰²*](https://kharshit.github.io/blog/2019/08/23/quick-intro-to-instance-segmentation) *æ¥å®Œæˆã€‚*æœ‰ä¸¤ç§ç±»å‹çš„å…¬å…±å¯¹è±¡è·Ÿè¸ªæŒ‘æˆ˜ã€‚

1.  å•ä¸ªå¯¹è±¡è·Ÿè¸ª:åœ¨æ•´ä¸ªè§†é¢‘åºåˆ—ä¸­è·Ÿè¸ªæ„Ÿå…´è¶£çš„å¯¹è±¡ã€‚ä¾‹å¦‚ [VOT æŒ‘æˆ˜](https://www.votchallenge.net/)
2.  å¤šç›®æ ‡è·Ÿè¸ª:åœ¨æ•´ä¸ªè§†é¢‘åºåˆ—ä¸­è·Ÿè¸ªå¤šä¸ªæ„Ÿå…´è¶£çš„ç›®æ ‡ã€‚ä¾‹å¦‚ [MOT æŒ‘æˆ˜](https://motchallenge.net/)

## ç ”ç©¶è¶‹åŠ¿

ç”¨äºè§£å†³å¯¹è±¡è·Ÿè¸ªçš„ä¸€äº›è‘—åçš„ç»å…¸ CV ç®—æ³•æ˜¯:

1.  [å‡å€¼æ¼‚ç§»](https://docs.opencv.org/master/d7/d00/tutorial_meanshift.html)
2.  [å…‰æµ](https://opencv-python-tutroals.readthedocs.io/en/latest/py_tutorials/py_video/py_lucas_kanade/py_lucas_kanade.html)
3.  [å¡å°”æ›¼æ»¤æ³¢å™¨](https://www.bzarg.com/p/how-a-kalman-filter-works-in-pictures/)

å…¶ä¸­æœ€è‘—åçš„å¤šç›®æ ‡è·Ÿè¸ªç®—æ³• [SORT](https://arxiv.org/abs/1602.00763) ä»¥å¡å°”æ›¼æ»¤æ³¢å™¨ä¸ºæ ¸å¿ƒï¼Œéå¸¸æˆåŠŸã€‚

éšç€æ·±åº¦å­¦ä¹ æ—¶ä»£çš„åˆ°æ¥ï¼Œéå¸¸åˆ›æ–°çš„ç ”ç©¶è¿›å…¥äº†ç¤¾åŒºï¼ŒDL åœ¨å…¬å…±è·Ÿè¸ªæŒ‘æˆ˜æ–¹é¢æˆåŠŸåœ°èƒœè¿‡äº†ç»å…¸çš„ CV æ–¹æ³•ã€‚å°½ç®¡ DL åœ¨å…¬å…±æŒ‘æˆ˜ä¸Šå–å¾—äº†å·¨å¤§æˆåŠŸï¼Œä½†å®ƒä»åœ¨åŠªåŠ›ä¸ºç°å®ä¸–ç•Œçš„é—®é¢˜é™ˆè¿°æä¾›é€šç”¨çš„è§£å†³æ–¹æ¡ˆã€‚

# æ·±åº¦æ¨¡å‹çš„æŒ‘æˆ˜ğŸ’­

å½“è®­ç»ƒæ·±åº¦ CNN æ¨¡å‹æ—¶ï¼Œæˆ‘ä»¬é¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜ä¹‹ä¸€æ˜¯è®­ç»ƒæ•°æ®ã€‚

*   **è®­ç»ƒæ•°æ®:**æ·±åº¦å­¦ä¹ æ–¹æ³•éœ€è¦å¤§é‡æ•°æ®ï¼Œè¿™å‡ ä¹æ¯æ¬¡éƒ½ä¼šæˆä¸ºç“¶é¢ˆã€‚æ­¤å¤–ï¼Œåƒå¤šç›®æ ‡è·Ÿè¸ªè¿™æ ·çš„ä»»åŠ¡å¾ˆéš¾æ³¨é‡Šï¼Œå¹¶ä¸”è¿™ä¸ªè¿‡ç¨‹å˜å¾—ä¸åˆ‡å®é™…ä¸”æ˜‚è´µã€‚

![](img/dc0ffd4f29fe15ccd3899b71c82d00b6.png)

DL æ¨¡å‹éœ€è¦å¤§é‡æ•°æ®

# è‡ªæˆ‘ç›‘ç£å­¦ä¹ è¥æ•‘ğŸ˜¯

æˆ‘ä»¬éƒ½çŸ¥é“[ç›‘ç£å’Œéç›‘ç£å­¦ä¹ ](https://blogs.nvidia.com/blog/2018/08/02/supervised-unsupervised-learning/#:~:text=In%20a%20supervised%20learning%20model,and%20patterns%20on%20its%20own.)æŠ€æœ¯ã€‚è¿™æ˜¯ä¸€ç§ç›¸å½“æ–°çš„ç±»å‹ï¼Œè¢«ç§°ä¸ºè‡ªæˆ‘ç›‘ç£å­¦ä¹ ã€‚åœ¨è¿™äº›ç±»å‹çš„å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬è¯•å›¾åˆ©ç”¨æ•°æ®ä¸­å·²ç»å­˜åœ¨çš„ä¿¡æ¯ï¼Œè€Œä¸æ˜¯ä»»ä½•å¤–éƒ¨æ ‡ç­¾ï¼Œæˆ–è€…æœ‰æ—¶æˆ‘ä»¬è¯´æ¨¡å‹è‡ªå·±å­¦ä¹ ã€‚åœ¨ç°å®ä¸­ï¼Œæˆ‘ä»¬æ‰€åšçš„æ˜¯è®­ç»ƒ CNN æ¨¡å‹æ¥å®Œæˆä¸€äº›å…¶ä»–çš„ä»»åŠ¡ï¼Œé—´æ¥å¸®åŠ©æˆ‘ä»¬å®ç°æˆ‘ä»¬çš„ç›®æ ‡ï¼Œæ¨¡å‹ä¼šè‡ªæˆ‘ç›‘ç£ã€‚è¿™äº›ä»»åŠ¡è¢«ç§°ä¸ºâ€œ*ä»£ç†ä»»åŠ¡*æˆ–â€œ*å€Ÿå£ä»»åŠ¡*â€ã€‚
ä»£ç†ä»»åŠ¡çš„å‡ ä¸ªä¾‹å­æ˜¯:

*   **ç€è‰²**

![](img/8b15ed00c6f952e511622020d13cd7be.png)

CNN æ¨¡å‹å­¦ä¹ ä»ç°åº¦å›¾åƒé¢„æµ‹é¢œè‰²ã€‚[ [æ¥æº](https://arxiv.org/abs/1603.08511)

*   **å°†å›¾åƒè¡¥ä¸æ”¾ç½®åœ¨æ­£ç¡®çš„ä½ç½®**

![](img/0bd0111f6c3b243b6cda942716f625c5.png)

è¿™äº›å°å—æ˜¯ä»å›¾åƒä¸­æå–å‡ºæ¥çš„ï¼Œå¹¶è¢«æ··æ´—ã€‚è¯¥æ¨¡å‹å­¦ä¹ è§£å†³è¿™ä¸ªæ‹¼å›¾ï¼Œå¹¶æŒ‰ç…§æ­£ç¡®çš„é¡ºåºæ’åˆ—ç“·ç –ï¼Œå¦‚å›¾ 3 æ‰€ç¤ºã€‚[ [æ¥æº](https://arxiv.org/abs/1603.09246)

*   **æŒ‰ç…§æ­£ç¡®çš„é¡ºåºæ”¾ç½®æ¡†æ¶**

![](img/a20854a163cc1654b8386e250059a47b.png)

è¯¥æ¨¡å‹å­¦ä¹ å¯¹è§†é¢‘åºåˆ—ä¸­çš„æ··æ´—å¸§è¿›è¡Œæ’åºã€‚[ [æ¥æº](https://arxiv.org/abs/1708.01246)

è®¸å¤šè¿™æ ·çš„ä»»åŠ¡å¯ä»¥ç”¨ä½œè®¡ç®—æœºè§†è§‰é—®é¢˜çš„ä»£ç†ä»»åŠ¡ã€‚è¿™ç§åŸ¹è®­çš„ä¸€ä¸ªä¸»è¦å¥½å¤„æ˜¯ï¼ŒåŸ¹è®­ä¸éœ€è¦æ‰‹åŠ¨æ³¨é‡Šæ•°æ®ï¼Œå¹¶ä¸”é€‚åˆè§£å†³ç°å®ç”Ÿæ´»ä¸­çš„ç”¨ä¾‹ã€‚

# é€šè¿‡è§†é¢‘å½©è‰²åŒ–çš„è‡ªæˆ‘ç›‘ç£è·Ÿè¸ª

æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ä»€ä¹ˆæ˜¯è‡ªæˆ‘ç›‘ç£æ¨¡å‹ï¼Œä½ ä¸€å®šå·²ç»çŒœåˆ°äº†æˆ‘ä»¬å°†ä½¿ç”¨ç€è‰²ä½œä¸ºæˆ‘ä»¬çš„ä»£ç†ä»»åŠ¡çš„åç§°ã€‚

 [## é€šè¿‡ç»™è§†é¢‘ç€è‰²ï¼Œè·Ÿè¸ªå‡ºç°äº†

### æˆ‘ä»¬ä½¿ç”¨å¤§é‡æœªæ ‡è®°çš„è§†é¢‘æ¥å­¦ä¹ æ¨¡å‹ï¼Œä»¥ä¾¿åœ¨æ²¡æœ‰äººå·¥ç›‘ç£çš„æƒ…å†µä¸‹è¿›è¡Œè§†è§‰è·Ÿè¸ªã€‚æˆ‘ä»¬â€¦

arxiv.org](https://arxiv.org/abs/1806.09594) 

## ä»‹ç»

ç€è‰²æ˜¯æˆ‘ä»¬çš„*ä»£ç†ä»»åŠ¡*æˆ–*å€Ÿå£ä»»åŠ¡*ï¼Œç‰©ä½“è·Ÿè¸ªæ˜¯*ä¸»ä»»åŠ¡*æˆ–*ä¸‹æ¸¸ä»»åŠ¡*ã€‚å¤§è§„æ¨¡æ— æ ‡ç­¾è§†é¢‘ç”¨äºè®­ç»ƒæ¨¡å‹ï¼Œæ²¡æœ‰ä»»ä½•å•ä¸ªåƒç´ è¢«äººç±»æ ‡æ³¨ã€‚è§†é¢‘çš„æ—¶é—´ç›¸å¹²æ€§ç”¨äºä½¿æ¨¡å‹å­¦ä¹ ç»™ç°åº¦è§†é¢‘ç€è‰²ã€‚è¿™å¯èƒ½çœ‹èµ·æ¥ä»¤äººå›°æƒ‘ï¼Œä½†åšæŒä¸‹å»ï¼Œæˆ‘ä¼šæŠŠäº‹æƒ…å¼„æ¸…æ¥šã€‚

## æ¨¡å‹å°†å¦‚ä½•å­¦ä¹ è·Ÿè¸ªï¼Ÿ

æˆ‘ä»¬å°†å–ä¸¤ä¸ªå¸§ä¸€ä¸ªç›®æ ‡å¸§(åœ¨æ—¶é—´ t)å’Œä¸€ä¸ªå‚è€ƒå¸§(åœ¨æ—¶é—´ t-1)ï¼Œå¹¶é€šè¿‡æ¨¡å‹ã€‚æœŸæœ›è¯¥æ¨¡å‹æ ¹æ®å‚è€ƒå¸§çš„é¢œè‰²çš„å…ˆéªŒçŸ¥è¯†æ¥é¢„æµ‹ç›®æ ‡å¸§çš„é¢œè‰²ã€‚è¿™æ ·ï¼Œæ¨¡å‹å†…éƒ¨å­¦ä¹ æŒ‡å‘æ­£ç¡®çš„åŒºåŸŸï¼Œä»¥ä¾¿ä»å‚è€ƒå¸§å¤åˆ¶é¢œè‰²ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚è¿™ç§æŒ‡å‘æœºåˆ¶å¯ä»¥ç”¨ä½œæ¨æ–­è¿‡ç¨‹ä¸­çš„è·Ÿè¸ªæœºåˆ¶ã€‚æˆ‘ä»¬å°†å¾ˆå¿«çœ‹åˆ°å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ã€‚

![](img/7d208e6f15e3f56de0d2a9f2a050df52.png)

è¯¥æ¨¡å‹æ¥æ”¶ä¸€ä¸ªå½©è‰²å¸§å’Œä¸€ä¸ªç°åº¦è§†é¢‘ä½œä¸ºè¾“å…¥ï¼Œå¹¶é¢„æµ‹ä¸‹ä¸€å¸§çš„é¢œè‰²ã€‚è¯¥æ¨¡å‹å­¦ä¹ ä»å‚è€ƒå¸§å¤åˆ¶é¢œè‰²ï¼Œè¿™ä½¿å¾—èƒ½å¤Ÿåœ¨æ²¡æœ‰äººç±»ç›‘ç£çš„æƒ…å†µä¸‹å­¦ä¹ è·Ÿè¸ªæœºåˆ¶[ [æ¥æº](https://ai.googleblog.com/2018/06/self-supervised-tracking-via-video.html)

æˆ‘ä»¬ä¸å¤åˆ¶ç½‘ç»œä¸­çš„é¢œè‰²ï¼Œè€Œæ˜¯è®­ç»ƒæˆ‘ä»¬çš„ CNN ç½‘ç»œæ¥å­¦ä¹ ç›®æ ‡å¸§çš„åƒç´ å’Œå‚è€ƒå¸§çš„åƒç´ ä¹‹é—´çš„ç›¸ä¼¼æ€§*(ç›¸ä¼¼æ€§æ˜¯ç°åº¦åƒç´ ä¹‹é—´çš„ç›¸ä¼¼æ€§)*ï¼Œç„¶åå½“ä¸å‚è€ƒå¸§çš„çœŸå®é¢œè‰²çº¿æ€§ç»„åˆæ—¶ï¼Œè¯¥ç›¸ä¼¼æ€§çŸ©é˜µç»™å‡ºé¢„æµ‹çš„é¢œè‰²ã€‚æ•°å­¦ä¸Šï¼Œè®© *Cáµ¢* æ˜¯å‚è€ƒå¸§ä¸­æ¯ä¸ªåƒç´  *i* çš„çœŸå®é¢œè‰²ï¼Œè®© *Câ±¼* æ˜¯ç›®æ ‡å¸§ä¸­æ¯ä¸ªåƒç´  *j* çš„çœŸå®é¢œè‰²ã€‚è¯¥æ¨¡å‹ç»™å‡ºäº†ç›®æ ‡å¸§å’Œå‚è€ƒå¸§ä¹‹é—´çš„ç›¸ä¼¼æ€§çŸ©é˜µ *Aáµ¢â±¼* ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡çº¿æ€§ç»„åˆå¾—åˆ°é¢„æµ‹çš„é¢œè‰² *yáµ¢* ã€‚

![](img/a18a4e1954633b10400c65228d72f292.png)

[ [æ¥æº](https://arxiv.org/abs/1806.09594)

![](img/9738f71fe402735c62086798ca90f056.png)

**ç­‰å¼ 1** :é¢„æµ‹é¢œè‰²ä¸å‚è€ƒé¢œè‰²çš„çº¿æ€§ç»„åˆ

## ç›¸ä¼¼çŸ©é˜µæ€ä¹ˆç®—ï¼Ÿ

å½“é€šè¿‡æ¨¡å‹æ—¶ï¼Œå›¾åƒã€å‚è€ƒå¸§å’Œç›®æ ‡å¸§éƒ½å­¦ä¹ å¯¹æ¯ä¸ªåƒç´ çš„ä½çº§åµŒå…¥ï¼Œè¿™é‡Œ *fáµ¢* æ˜¯å¯¹å‚è€ƒå¸§ä¸­çš„åƒç´  *i* çš„åµŒå…¥ï¼Œç±»ä¼¼åœ°ï¼Œ *fâ±¼* æ˜¯å¯¹ç›®æ ‡å¸§ä¸­çš„åƒç´  *j* çš„åµŒå…¥ã€‚é‚£ä¹ˆç›¸ä¼¼æ€§çŸ©é˜µå¯ä»¥é€šè¿‡ä¸‹å¼è®¡ç®—:

![](img/b6b718c6a895b9329ee513752823f464.png)

**ç­‰å¼ 2:** å†…éƒ¨
äº§å“ç›¸ä¼¼åº¦ç”± softmax å½’ä¸€åŒ–

ç›¸ä¼¼æ€§çŸ©é˜µä¸­çš„æ¯ä¸€è¡Œè¡¨ç¤ºå‚è€ƒå¸§çš„æ‰€æœ‰åƒç´  *i* å’Œç›®æ ‡å¸§çš„åƒç´  *j* ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œå› æ­¤ä¸ºäº†ä½¿æ€»æƒé‡ä¸º 1ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸€è¡Œåº”ç”¨ softmaxã€‚

```
Lets look an example with dimension to make it clear,we try to find a similarity matrix of 1 pixel from target frame.
An illustration of this example is shown below.Consider reference image and target image, size (5, 5) => (25,1)for each pixel, cnn gives embedding of size (64, 1)
*fáµ¢*, embedding for reference frame, size (64, 25)
*fâ±¼*, embedding for target frame, size (64, 25)
*at j=2 fâ‚‚*,  embedding for 3rd pixel in target frame, size (64, 1)**Similarity Matrix,** between reference frame and target pixel, j=2
 *Aáµ¢â‚‚* =softmax *(fáµ¢áµ€ x fâ‚‚)* , size (25, 64) *x* (64, 1) => (25,1) =>   (5, 5)
we get a similarity between all the ref pixels and a target pixel at j=2.**Colorization,** To copy the color (here, colours are not RGB but quantized colour of with 1 channel) from reference frame,
*cáµ¢*, Colors of reference frame size (5, 5) => (25, 1)
*Aáµ¢â‚‚*, Similarity matrix, size (5, 5) => (1, 25)**Predicted color** at j=2, 
*yâ‚‚ = Aáµ¢â‚‚ x cáµ¢*, size (1, 25) *x* (25, 1) => (1, 1)From the similarity matrix in below figure, we can see reference color at i=1 is dominant(0.46), thus we have a color copied for target, j=2 from reference, i=1**PS:** 1\. áµ€ denotes transpose
2\. matrix indices starts from 0
```

![](img/e2b2ad6e48e6099e18d1b9e9883df396.png)

(a)ç¤ºå‡ºäº†å¤§å°ä¸º(5ï¼Œ5)çš„ 2 ä¸ªå¸§ï¼Œ(b)å‚è€ƒå¸§åµŒå…¥å’Œ j =2 å¤„çš„ç›®æ ‡åƒç´ åµŒå…¥çš„å†…ç§¯ï¼Œ(softmax ä¹‹åçš„ç›¸ä¼¼æ€§çŸ©é˜µï¼Œ(d)ç›¸ä¼¼æ€§çŸ©é˜µå’Œå‚è€ƒå¸§çš„çœŸå®é¢œè‰²çš„çº¿æ€§ç»„åˆ[ [æº](https://github.com/hyperparameters/tracking_via_colorization) ]

ç±»ä¼¼åœ°ï¼Œå¯¹äºç›®æ ‡å¸§ä¸­çš„æ¯ä¸ªç›®æ ‡åƒç´ ( *(5ï¼Œ5)= > 25 åƒç´ )ï¼Œ*æˆ‘ä»¬å°†å…·æœ‰å¤§å°ä¸º(5ï¼Œ5)çš„ç›¸ä¼¼æ€§çŸ©é˜µï¼Œå³å¤§å°ä¸º(5ï¼Œ5ï¼Œ25) = (25ï¼Œ25)çš„å®Œæ•´ç›¸ä¼¼æ€§çŸ©é˜µ *Aáµ¢â±¼* ã€‚
æˆ‘ä»¬å°†åœ¨å®ç°ä¸­ä½¿ç”¨(256 x 256)å›¾åƒæ‰©å±•ç›¸åŒçš„æ¦‚å¿µã€‚

## å›¾åƒé‡åŒ–

![](img/51ffe926531a957fb9e00ba359f58ae7.png)

ç¬¬ä¸€è¡Œæ˜¾ç¤ºåŸå§‹å¸§ï¼Œç¬¬äºŒ
è¡Œæ˜¾ç¤ºæ¥è‡ª Lab space çš„ ab é¢œè‰²é€šé“ã€‚ç¬¬ä¸‰è¡Œå°†é¢œè‰²ç©ºé—´é‡åŒ–ä¸ºç¦»æ•£çš„é¢å…ƒï¼Œå¹¶æ‰°åŠ¨é¢œè‰²ä»¥ä½¿æ•ˆæœæ›´åŠ æ˜æ˜¾ã€‚[ [æ¥æº](https://arxiv.org/abs/1806.09594)

é¢œè‰²æ˜¯ä½ç©ºé—´é¢‘ç‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä½åˆ†è¾¨ç‡çš„å¸§ã€‚æˆ‘ä»¬ä¸éœ€è¦ *C(255ï¼Œ3)* é¢œè‰²ç»„åˆï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ›å»ºäº† 16 ä¸ªèšç±»ï¼Œå¹¶å°†é¢œè‰²ç©ºé—´é‡åŒ–åˆ°è¿™äº›èšç±»ä¸­ã€‚ç°åœ¨æˆ‘ä»¬åªæœ‰ 16 ç§ç‹¬ç‰¹çš„é¢œè‰²ï¼Œ(è§ä¸Šå›¾ç¬¬ä¸‰æ )ã€‚èšç±»æ˜¯ä½¿ç”¨ k-means å®Œæˆçš„ã€‚16 ä¸ªç°‡ä¼šä¸¢å¤±ä¸€äº›é¢œè‰²ä¿¡æ¯ï¼Œä½†è¶³ä»¥è¯†åˆ«ç‰©ä½“ã€‚æˆ‘ä»¬å¯ä»¥å¢åŠ èšç±»çš„æ•°é‡æ¥æé«˜ç€è‰²çš„ç²¾åº¦ï¼Œä½†ä»£ä»·æ˜¯å¢åŠ è®¡ç®—é‡ã€‚

## ä¸ºä»€ä¹ˆ LAB è‰²å½©ç©ºé—´ä¼˜äº RGBï¼Ÿ

![](img/b05855c75b5cea4b688005a10ead3b30.png)

æ¥æº

ä¸ºäº†å°†å›¾åƒé‡åŒ–æˆç°‡ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ LAB è‰²å½©ç©ºé—´çš„ AB é€šé“ï¼Œè€Œä¸æ˜¯ RGB è‰²å½©ç©ºé—´ã€‚ä¸Šå›¾æ˜¾ç¤ºäº† RGB å’Œ LAB é€šé“é—´ç›¸å…³æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä»å›¾ä¸­å¾—å‡ºä»¥ä¸‹ç»“è®º

*   RGB å¾€å¾€æ¯” LAB æœ‰æ›´å¤šçš„ç›¸å…³æ€§ã€‚
*   LAB å°†è¿«ä½¿æ¨¡å‹å­¦ä¹ æ–¹å·®ï¼Œå®ƒå°†è¿«ä½¿å­¦ä¹ æ›´å¥å£®çš„è¡¨ç¤ºï¼Œè€Œä¸æ˜¯ä¾èµ–äºå±€éƒ¨é¢œè‰²ä¿¡æ¯

å¯ä»¥ä½¿ç”¨ sklearn çš„ [KMeans](https://www.analyticsvidhya.com/blog/2019/08/comprehensive-guide-k-means-clustering/) åŒ…æ¥å®Œæˆé›†ç¾¤ã€‚

è¿™ä¸ªç±»å°†è¢«ç”¨æ¥åˆ¶ä½œé¢œè‰²ç°‡ï¼Œæˆ‘ä»¬å°†æŠŠå®ƒä½œä¸ºæ³¡èœæ¥ä¿å­˜ã€‚

# å±¥è¡ŒğŸ’»

> **æ³¨æ„**:æˆ‘ç”¨ pytorch å®ç°ï¼Œå®ƒéµå¾ª(Nï¼ŒCï¼ŒHï¼ŒW)æ ¼å¼ã€‚åœ¨å¤„ç†çŸ©é˜µæ•´å½¢æ—¶ï¼Œè¯·è®°ä½è¿™ä¸€ç‚¹ã€‚å¦‚æœä½ å¯¹å½¢çŠ¶æœ‰ä»»ä½•ç–‘é—®ï¼Œè¯·è”ç³»æˆ‘ä»¬ã€‚

![](img/deea1b6d51d18480483377f1e4f7525c.png)![](img/305123c07e616c346781f4d9a3614803.png)

è¯¥æ¨¡å‹ä»å‚è€ƒå¸§å­¦ä¹ ç»™è§†é¢‘å¸§ç€è‰²ã€‚[ [æ¥æº](https://ai.googleblog.com/2018/06/self-supervised-tracking-via-video.html)

## æŠ•å…¥

è¯¥æ¨¡å‹çš„è¾“å…¥æ˜¯ä¸‹é‡‡æ ·åˆ°
256 Ã— 256 çš„å››ä¸ªç°åº¦è§†é¢‘å¸§ã€‚ä¸‰ä¸ªå‚è€ƒå¸§å’Œä¸€ä¸ªç›®æ ‡å¸§ã€‚

## é¢„å¤„ç†

é¦–å…ˆï¼Œæˆ‘ä»¬å°†æŠŠæ‰€æœ‰çš„è®­ç»ƒè§†é¢‘å‹ç¼©åˆ° 6 å¸§/ç§’ã€‚ç„¶åé¢„å¤„ç†å¸§ä»¥åˆ›å»ºä¸¤ä¸ªä¸åŒçš„é›†åˆã€‚ä¸€ä¸ªç”¨äº CNN æ¨¡å‹ï¼Œå¦ä¸€ä¸ªç”¨äºç€è‰²ä»»åŠ¡ã€‚

```
- Video fps is reduced to 6 fps**SET 1 - for CNN Model**- Down sampled to 256 x 256- Normalise to have intensities between [-1, 1]**SET 2 - for Colourization**- Convert to LAB colour space- Downsample to 32 x 32- Quantize in 16 clusters using k-means- Create one-hot vector corresponding to the nearest cluster centroid
```

## æ¨¡å‹æ¶æ„

ä½¿ç”¨çš„ä¸»å¹²æ˜¯ *ResNet-18* ï¼Œå› æ­¤ç»“æœä¸å…¶ä»–æ–¹æ³•ç›¸å½“ã€‚ResNet-18 çš„æœ€åä¸€å±‚è¢«æ›´æ–°ä»¥ç»™å‡º 32 x 32 x 256 çš„å°ºå¯¸è¾“å‡ºã€‚ResNet-18 çš„è¾“å‡ºç„¶åè¢«ä¼ é€’åˆ° 3D-Conv ç½‘ç»œï¼Œæœ€ç»ˆè¾“å‡ºæ˜¯ 32 x 32 x 64ã€‚(*ä¸‹é¢çš„ä»£ç å—æ˜¾ç¤ºäº†ä» ResNet-18 ç½‘ç»œ*è·å–è¾“å…¥çš„ 3D ç½‘ç»œ)

## åŸ¹å…»

åŸ¹è®­å¯åˆ†ä¸ºä»¥ä¸‹ 3 ä¸ªæ­¥éª¤:

1.  **ç½‘ç»œé€šé“**
    æˆ‘ä»¬å°†ä½¿ç”¨é¢„å¤„ç†å¸§çš„é›†åˆ 1ï¼Œå³å¤§å°ä¸º(256 x 256)çš„ 4 ä¸ªç°åº¦å¸§é€šè¿‡ç½‘ç»œï¼Œä»¥è·å¾—å…·æœ‰ 64 ä¸ªé€šé“çš„(32 x 32)ç©ºé—´å›¾ã€‚è¿™å¯ä»¥è§£é‡Šä¸ºå¯¹(32 x 32)å›¾åƒçš„æ¯ä¸ªåƒç´ è¿›è¡Œ 64 ç»´åµŒå…¥ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ‰å››ä¸ªè¿™æ ·çš„åƒç´ çº§åµŒå…¥ï¼Œä¸‰ä¸ªç”¨äºå‚è€ƒå›¾åƒï¼Œä¸€ä¸ªç”¨äºç›®æ ‡å›¾åƒã€‚

1.  **ç›¸ä¼¼æ€§çŸ©é˜µ** åˆ©ç”¨è¿™äº”ä¸ªåµŒå…¥ï¼Œæˆ‘ä»¬æ‰¾åˆ°å‚è€ƒå¸§å’Œç›®æ ‡å¸§ä¹‹é—´çš„ç›¸ä¼¼æ€§çŸ©é˜µã€‚å¯¹äºç›®æ ‡å¸§ä¸­çš„åƒç´ ï¼Œæˆ‘ä»¬å°†é€šè¿‡ softmax å°†æ‰€æœ‰ä¸‰ä¸ªå‚è€ƒå¸§ä¸­çš„æ‰€æœ‰åƒç´ çš„ç›¸ä¼¼æ€§å€¼å½’ä¸€åŒ–ä¸º 1ã€‚

**3ã€‚ç€è‰²** æˆ‘ä»¬å°†ä½¿ç”¨é¢„å¤„ç†å¸§çš„é›†åˆ 2ï¼Œå³å››ä¸ªä¸‹é‡‡æ ·ä¸º(32 x 32)å¹¶é‡åŒ–çš„å¸§ç”¨äºç€è‰²ã€‚å°†ä¸‰ä¸ªå‚è€ƒå¸§ä¸ç›¸ä¼¼æ€§çŸ©é˜µç»„åˆä»¥è·å¾—é¢„æµ‹çš„é‡åŒ–å¸§ã€‚æˆ‘ä»¬ç”¨é¢„æµ‹çš„é¢œè‰²*æ‰¾åˆ° [*äº¤å‰ç†µæŸå¤±*](https://machinelearningmastery.com/cross-entropy-for-machine-learning/) (è®°å¾—æˆ‘ä»¬å°†å¸§é‡åŒ–ä¸º 16 ä¸ªç°‡ï¼Œç°åœ¨æˆ‘ä»¬æœ‰ 16 ä¸ªç±»åˆ«ã€‚æˆ‘ä»¬åœ¨è¿™äº›é¢œè‰²ä¸Šå‘ç°äº†å¤šç±»åˆ«äº¤å‰ç†µæŸå¤±ã€‚)*

## æ¨ç†

![](img/789bf969e808af6e7792b8f4d51c4ec1.png)![](img/6b083438f770b7edfc83d4b790a1dc22.png)![](img/42d59420e4c23e7b474689f1277ab843.png)

è·Ÿè¸ªé¢„æµ‹ç¤ºä¾‹[ [æ¥æº](https://ai.googleblog.com/2018/06/self-supervised-tracking-via-video.html)

åœ¨å­¦ä¹ äº†ç€è‰²çš„ä»»åŠ¡ä¹‹åï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå¯ä»¥ä¸ºä¸€å¯¹ç›®æ ‡å’Œå‚è€ƒå¸§è®¡ç®—ç›¸ä¼¼çŸ©é˜µ *Aáµ¢â±¼* çš„æ¨¡å‹ã€‚ç°åœ¨å¯¹äºå®é™…çš„è·Ÿè¸ªä»»åŠ¡ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†æˆ‘ä»¬çš„æ¨¡å‹åœ¨æ ‡ç­¾ç©ºé—´ä¸­æ˜¯éå‚æ•°çš„ç‰¹æ€§ã€‚æˆ‘ä»¬ç®€å•åœ°é‡å¤ä½¿ç”¨ e *æ–¹ç¨‹ 1* æ¥ä¼ æ’­ï¼Œä½†æ˜¯ä¸æ˜¯ä¼ æ’­é¢œè‰²ï¼Œè€Œæ˜¯ä¼ æ’­ç±»åˆ«çš„åˆ†å¸ƒã€‚å¯¹äºç¬¬ä¸€å¸§ï¼Œæˆ‘ä»¬æœ‰åœ°é¢çœŸå®é®ç½©ï¼Œæˆ‘ä»¬å°†æŠŠæ‰€æœ‰å®ä¾‹é®ç½©å®‰æ’ä¸ºç‹¬çƒ­å‘é‡ c *áµ¢(è¿™ç±»ä¼¼äºè®­ç»ƒæœŸé—´ä½¿ç”¨çš„é‡åŒ–é¢œè‰²çš„ç‹¬çƒ­å‘é‡)*ã€‚å°† c *áµ¢* ä¸æˆ‘ä»¬çš„ç›¸ä¼¼æ€§çŸ©é˜µ *Aáµ¢â±¼* ç»“åˆèµ·æ¥ï¼Œæ‰¾åˆ°è’™ç‰ˆ*ã€*çš„æ–°ä½ç½®ï¼Œä½†æ˜¯è®°ä½é¢„æµ‹ c *â±¼* åœ¨éšåçš„å¸§ä¸­ä¼šå˜è½¯ï¼Œè¡¨ç¤ºæ¨¡å‹çš„ç½®ä¿¡åº¦ã€‚è¦åšä¸€ä¸ªè‰°éš¾çš„å†³å®šï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å–æœ€æœ‰ä¿¡å¿ƒçš„ä¸€ç±»ã€‚æ¨ç†çš„ç®—æ³•å°†æ˜¯:

```
**WHILE (**target frame, reference frames) in the videostep 1\. Pass the target and reference frames through CNN modelstep 2\. Find Similarity Matrixstep 3\. Take ground truth object masks as one-hot encodingstep 4\. Linear combine the object masks with similarity matrixstep 5\. Update ground truth object masks by predicted masks
```

## æ•…éšœæ¨¡å¼

è®©æˆ‘ä»¬è®¨è®ºä¸€ä¸‹åœ¨æŸäº›æƒ…å†µä¸‹æ¨¡å‹ä»€ä¹ˆæ—¶å€™ä¼šå¤±è´¥ï¼Œè¿™ä¸»è¦æ˜¯ç€è‰²å¤±è´¥çš„æƒ…å†µï¼Œè¿™æ„å‘³ç€ç€è‰²ä¸è·Ÿè¸ªæœ‰å¾ˆé«˜çš„ç›¸å…³æ€§ã€‚
åœ¨ä»¥ä¸‹æƒ…å†µä¸‹ä¼šå‘ç°ä¸€äº›æ•…éšœ:

*   å½“è§†é¢‘ä¸­çš„å…‰çº¿å‰§çƒˆæˆ–é¢‘ç¹å˜åŒ–æ—¶
*   è¯¥æ–¹æ³•æˆåŠŸåœ°è·Ÿè¸ªå…·æœ‰è½»å¾®åˆ°ä¸­ç­‰é®æŒ¡ç‰©ä½“ï¼Œä½†æ˜¯å½“ç‰©ä½“ç»å†è¾ƒå¤§é®æŒ¡æ—¶ä»ç„¶å¤±è´¥
*   ç‰©ä½“å°ºå¯¸çš„çªç„¶å˜åŒ–

# ç»“è®º

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ä¸€ä¸ªæ¨¡å‹å¦‚ä½•åœ¨æ²¡æœ‰ä»»ä½•æ‰‹åŠ¨æ³¨é‡Šæ•°æ®çš„æƒ…å†µä¸‹ä»è‡ªå·±çš„æ¨¡å‹ä¸­å­¦ä¹ ã€‚æˆ‘ä»¬å­¦ä¹ äº†å¦‚ä½•åœ¨ä¸€äº›ä»£ç†ä»»åŠ¡ä¸Šè®­ç»ƒ CNN æ¨¡å‹ï¼Œå¹¶åˆ©ç”¨è¿™ç§å­¦ä¹ æ¥å®Œæˆå®é™…çš„ä»»åŠ¡ã€‚æˆ‘ä»¬ä½¿ç”¨ç€è‰²ä½œä¸ºä»£ç†ï¼Œä½†ä¸é™äºæ­¤ï¼Œå„ç§æ–°çš„æ–¹æ³•ä½œä¸ºæ–°çš„[ä»£ç†ä»»åŠ¡](https://www.fast.ai/2020/01/13/self_supervised/)å‡ºç°ã€‚è‡ªæˆ‘ç›‘ç£çš„æ–¹æ³•æ˜¯å½“å‰çš„éœ€è¦ï¼Œå®ƒä»¬å¯ä»¥æ¶ˆé™¤ç°å®ä¸–ç•Œç”¨ä¾‹çš„æ˜‚è´µæ•°æ®æ”¶é›†çš„ä¸»è¦é™åˆ¶ã€‚è¿™ä¸ªæ¨¡å‹è¿˜ä¸èƒ½å‡»è´¥ç›®å‰çš„ SOTA ç›‘ç£æ¨¡å‹ï¼Œä½†ä¼˜äºè®¸å¤šå…¶ä»–æ¨¡å‹ã€‚

è¯¥æ–¹æ³•åœ¨æ–¹æ³•å’Œçµæ´»æ€§æ–¹é¢éå¸¸æœ‰å‰é€”ã€‚ç”±äºè‡ªèº«çš„ä¼˜åŠ¿ï¼Œè‡ªç›‘ç£æ¨¡å‹å°†å¾ˆå¿«æˆä¸ºè§£å†³æœ€å¤§ä¼¼ç„¶é—®é¢˜çš„é¦–é€‰ã€‚è¿™ç¯‡æ–‡ç« æ˜¯åŸºäºâ€œ [Google Research](https://arxiv.org/abs/1806.09594) â€çš„ç ”ç©¶å’Œä»–ä»¬æ‰€æœ‰çš„åŠŸåŠ³ã€‚æˆ‘è¯•å›¾æ ¹æ®æˆ‘çš„çŸ¥è¯†å’Œç†è§£æ¥è§£é‡Šè¿™é¡¹ç ”ç©¶ã€‚

# å…³äºæˆ‘

æˆ‘æ˜¯ Tushar Kolheï¼Œåœ¨ Fynd æ‹…ä»»æ·±åº¦å­¦ä¹ å·¥ç¨‹å¸ˆã€‚æˆ‘çš„å…´è¶£æ˜¯å»ºç«‹è§£å†³ç°å®ä¸–ç•Œé—®é¢˜çš„è®¡ç®—æœºè§†è§‰æ¨¡å‹ã€‚
é€šè¿‡[ç”µå­é‚®ä»¶](mailto:tushark.engg@outlook.com)å¯»æ±‚ä»»ä½•å»ºè®®æˆ–å¸®åŠ©ã€‚

> æˆ‘åšä¿¡ï¼Œå¦‚æœæœ‰è¶³å¤Ÿçš„åŠ¨åŠ›ï¼Œä»»ä½•äººéƒ½å¯ä»¥å­¦åˆ°ä»»ä½•ä¸œè¥¿ï¼Œæ·±åº¦æ¨¡å‹ä¹Ÿæ˜¯å¦‚æ­¤ğŸ˜›ã€‚

# é™„å½•

ç›®æ ‡è·Ÿè¸ªé¢†åŸŸçš„ä¸€äº›æœ‰è¶£ç ”ç©¶:

1.  *ç®€å•çš„åœ¨çº¿å®æ—¶è·Ÿè¸ªï¼Œå…·æœ‰æ·±åº¦å…³è”åº¦é‡ã€‚ã€* [*è®ºæ–‡*](https://arxiv.org/abs/1703.07402)*â†’æ‰©å±•æ’åº*
2.  *æ²¡æœ‰èŠ±é‡Œèƒ¡å“¨çš„è·Ÿè¸ªã€‚ã€* [*è®ºæ–‡*](https://arxiv.org/pdf/1903.05625.pdf)*ã€‘*
3.  *å•æ¬¡å¤šç›®æ ‡è·Ÿè¸ªçš„ç®€å•åŸºçº¿- FairMOT* ã€‚*[*è®ºæ–‡*](http://arxiv.org/abs/2004.01888)*
4.  ***å­¦ä¹ ç”¨äºå¤šç›®æ ‡è·Ÿè¸ªçš„ç¥ç»è§£ç®—å™¨ã€‚ã€* [*è®ºæ–‡*](https://arxiv.org/abs/1912.07515)*ã€‘***

**ä½ å¯ä»¥æ‰¾åˆ°æ›´å¤šæœ‰è¶£çš„ç ”ç©¶ï¼Œè¯„è®ºä½ è§‰å¾—æœ‰è¶£çš„ç ”ç©¶ã€‚**

# **å‚è€ƒ**

1.  **å†¯å¾·é‡Œå…‹ã€æ–½é‡Œç“¦æ–¯å¡”ç“¦ã€æ³•è’‚ã€ç“œè¾¾æ‹‰é©¬å’Œå¢¨è²(2018 å¹´)ã€‚è·Ÿè¸ªæ˜¯é€šè¿‡ç»™è§†é¢‘ç€è‰²è€Œå‡ºç°çš„ã€‚ *ArXivï¼Œabs/1806.09594* ã€‚**
2.  **[ä½•](https://arxiv.org/search/cs?searchtype=author&query=He%2C+K)ã€[ã€](https://arxiv.org/search/cs?searchtype=author&query=Zhang%2C+X)ã€[ã€](https://arxiv.org/search/cs?searchtype=author&query=Ren%2C+S)ã€[ã€](https://arxiv.org/search/cs?searchtype=author&query=Sun%2C+J)ã€‚ç”¨äºå›¾åƒè¯†åˆ«çš„æ·±åº¦æ®‹å·®å­¦ä¹ ã€‚*ArXiv*[*ABS/1512.03385*](https://arxiv.org/abs/1512.03385v1)**
3.  **[å¼ æ›¦è½²](https://arxiv.org/search/cs?searchtype=author&query=Zhang%2C+R)ï¼Œ[è²åˆ©æ™®Â·ä¼Šç´¢æ‹‰](https://arxiv.org/search/cs?searchtype=author&query=Isola%2C+P)ï¼Œ[é˜¿åˆ—å…‹è°¢Â·é˜¿Â·åŸƒå¤«ç½—æ–¯](https://arxiv.org/search/cs?searchtype=author&query=Efros%2C+A+A)ã€‚å½©è‰²å›¾åƒå½©è‰²åŒ–ã€‚*ArXiv*T58*ABS/1603.08511***
4.  **è¿ˆèµ«è¿ªÂ·è¯ºé²é½ï¼Œ[ä¿ç½—Â·æ³•ç“¦ç½—](https://arxiv.org/search/cs?searchtype=author&query=Favaro%2C+P)ã€‚é€šè¿‡è§£å†³æ‹¼å›¾æ¸¸æˆå®ç°è§†è§‰è¡¨å¾çš„æ— ç›‘ç£å­¦ä¹ ã€‚ *ArXiv abs/1603.09246***
5.  **[ææ–°è‹±](https://arxiv.org/search/cs?searchtype=author&query=Lee%2C+H)ï¼Œ[è´¾-é»„æ–Œ](https://arxiv.org/search/cs?searchtype=author&query=Huang%2C+J)ï¼Œ[è¾›æ ¼](https://arxiv.org/search/cs?searchtype=author&query=Singh%2C+M)ï¼Œ[æ˜-æ¨ç„](https://arxiv.org/search/cs?searchtype=author&query=Yang%2C+M)ã€‚é€šè¿‡æ’åºåºåˆ—çš„æ— ç›‘ç£è¡¨ç¤ºå­¦ä¹ ã€‚ *ArXiv abs/1708.01246***
6.  **[https://www.fast.ai/2020/01/13/self_supervised/](https://www.fast.ai/2020/01/13/self_supervised/)**