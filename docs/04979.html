<html>
<head>
<title>How to simulate trades in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python模拟交易</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-simulate-trades-in-python-7e613c83fd5a?source=collection_archive---------11-----------------------#2020-04-30">https://towardsdatascience.com/how-to-simulate-trades-in-python-7e613c83fd5a?source=collection_archive---------11-----------------------#2020-04-30</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><p id="f20e" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我们总是看到，所谓的交易者声称他们有超过70%的胜率，他们的风险回报比超过1:2(风险1%，盈利2%)。你觉得可能吗？让我们来了解一下！</p><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj kp"><img src="../Images/d7dba5a5309d644ef2d7d964b25e0b96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7p1hlghnZLXe8yHHxZxz8g.png"/></div></div><p class="lb lc gk gi gj ld le bd b be z dk translated">作者图片</p></figure><blockquote class="lf"><p id="1c7d" class="lg lh iu bd li lj lk ll lm ln lo ko dk translated">我有70%的胜率，风险回报比为1:2</p></blockquote><p id="064d" class="pw-post-body-paragraph jr js iu jt b ju lp jw jx jy lq ka kb kc lr ke kf kg ls ki kj kk lt km kn ko in bi translated">ROFL！你确定你没有错过高中的数学课(可能是小学？！)?请记住，在2019年，对冲基金的平均回报率为6%。<a class="ae lu" href="https://www.marketwatch.com/story/hedge-fund-returns-badly-lagged-behind-the-stock-market-in-2019-2020-01-02" rel="noopener ugc nofollow" target="_blank">这里是来源</a>的链接。</p><p id="828a" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><strong class="jt iv">现在让我们开始谈论Python。</strong></p><p id="90b8" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我们只需要两个库</p><pre class="kq kr ks kt gu lv lw lx ly aw lz bi"><span id="7acf" class="ma mb iu lw b gz mc md l me mf">import numpy as np<br/>import matplotlib.pyplot as plt</span></pre><p id="08c5" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">现在我们需要写一个函数来模拟交易。当然不是真的。</p><pre class="kq kr ks kt gu lv lw lx ly aw lz bi"><span id="acdc" class="ma mb iu lw b gz mc md l me mf">def simulate(account_size, total_trades, risk_per_trade, win_rate, risk_reward):<br/>    account = account_size<br/>    accounts = [account]<br/>    profits = []<br/>    loss = []<br/>    wins = []<br/>    total_win = 0<br/>    max_con_l = 0<br/>    max_con_w = 0<br/>    con_l = 0<br/>    con_w = 0<br/>    pre = 0<br/>    rnd = list(np.round(np.random.uniform(1, 101, total_trades), 2))<br/>    for i in range(len(rnd)):<br/>        r = rnd[i]<br/>        win = r &lt;= win_rate<br/>        risk = -np.round(account * risk_per_trade / 100, 2)<br/>        profit_per_trade = abs(risk) * risk_reward<br/>        profit = profit_per_trade if win else risk<br/>        profits.append(profit)<br/>        account += profit<br/>        accounts.append(account)<br/>        if profit &gt; 0:<br/>            total_win += 1<br/>            wins.append(profit)<br/>            con_l = 0<br/>            if pre == 1:<br/>                con_w += 1<br/>                if con_w &gt; max_con_w:<br/>                    max_con_w = con_w<br/>            pre = 1<br/>        else: # 0 is also a loss (spread + commissions)<br/>            loss.append(abs(profit))<br/>            con_w = 0<br/>            if pre == -1:<br/>                con_l += 1<br/>                if con_l &gt; max_con_l:<br/>                    max_con_l = con_l<br/>            pre = -1<br/>    avg_win = np.mean(wins)<br/>    avg_loss = np.mean(loss)<br/>    max_win = np.max(wins)<br/>    max_loss = np.max(loss)<br/>    win_r = np.round(total_win / total_trades * 100, 2)<br/>    rrr = np.round(avg_win / avg_loss, 2)<br/>    profit_factor = np.round(np.sum(wins) / np.sum(loss), 2)<br/>    net_profits = np.cumsum(profits)<br/>    gain = np.round(accounts[-1] - account_size, 2)<br/>    growth_rate = np.round((accounts[-1] - account_size) / account_size * 100, 2)<br/>    print("--- Trading Results ---\n")<br/>    print("Total trades       : {}".format(total_trades))<br/>    print("Wins               : {} / {}%".format(total_win, win_r))<br/>    print("Average Win        : {}".format(np.round(avg_win, 2)))<br/>    print("Average Loss       : {}".format(np.round(avg_loss, 2)))<br/>    print("Max Win            : {}".format(np.round(max_win, 2)))<br/>    print("Max Loss           : {}".format(np.round(max_loss, 2)))<br/>    print("Max Cons. Wins     : {}".format(max_con_w))<br/>    print("Max Cons. Loss     : {}".format(max_con_l))<br/>    print("Risk Reward Ratio  : {}".format(rrr))<br/>    print("Profit Factor      : {}".format(profit_factor))<br/>    print("Risk per trade     : {}%".format(risk_per_trade))<br/>    print("---")<br/>    print("Initial Account    : {}".format(account_size))<br/>    print("Profit             : {} / {}%".format(gain, growth_rate))<br/>    print("Final Account      : {}".format(np.round(account, 2)))<br/>    print()<br/>    print("Results are compounded. Spread and commissions are not calculated.")<br/>    fig, ax = plt.subplots(2, 1, figsize=(16, 10))<br/>    ax[0].plot(net_profits)<br/>    ax[1].plot(accounts)<br/>    ax[1].axhline(account_size, color="#000000", ls="-.", linewidth=0.5)<br/>    ax[0].set_title("Equirty Curve")<br/>    ax[1].set_title("Account Growth")<br/>    plt.show()</span></pre><p id="68b6" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">让我们来定义一下这个人的说法</p><pre class="kq kr ks kt gu lv lw lx ly aw lz bi"><span id="19fa" class="ma mb iu lw b gz mc md l me mf">account_size = 10000<br/>total_trades = 200 #trades per year maybe?<br/>risk_per_trade = 2 #risk 2% of your account per trade<br/>win_rate = 70 # in percentage<br/>risk_reward = 2 # risk 1% profit 2%</span></pre><p id="f654" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">OMG！这太疯狂了。如果你准备好了，我们就跑吧？:)</p><pre class="kq kr ks kt gu lv lw lx ly aw lz bi"><span id="21a5" class="ma mb iu lw b gz mc md l me mf">simulate(account_size, total_trades, risk_per_trade, win_rate, risk_reward)</span></pre><p id="7da7" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><strong class="jt iv">奥斯卡颁给了这个家伙！！！！</strong></p><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj mg"><img src="../Images/6f57e2a048210664aad4e961ff124154.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7darq_lK_rdoFtS6Db11NA.png"/></div></div></figure><p id="d3ce" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">他每年能赚80% 25%还想卖给你一个产品？！加油！！！！</p><p id="9a4d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">ok；现在让我们试着更现实一点。我将使用以下参数:</p><pre class="kq kr ks kt gu lv lw lx ly aw lz bi"><span id="6cc2" class="ma mb iu lw b gz mc md l me mf">account_size = 10000<br/>total_trades = 200 #trades per year maybe?<br/>risk_per_trade = 2 #risk 2% of your account per trade<br/>win_rate = 52<br/>risk_reward = 1.4</span></pre><p id="db4f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">结果呢</p><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj mh"><img src="../Images/402cdcd4b9cba2117cb3085e2d7a46e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sC25MxU7ajDRa27BvrZf3w.png"/></div></div></figure><p id="bf4f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">即使有52%的胜率和1.4的风险回报比，每年也能赚193%！然而，这并不容易。</p><h1 id="186f" class="mi mb iu bd mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne bi translated">结论</h1><p id="e6e8" class="pw-post-body-paragraph jr js iu jt b ju nf jw jx jy ng ka kb kc nh ke kf kg ni ki kj kk nj km kn ko in bi translated">请不要再相信那些所谓的交易者了。大多数社交媒体交易者都是骗子。他们只是想卖给你一个梦想和他们所谓的圣杯产品。没有圣杯，你也不需要70%的胜率。</p><p id="bacf" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><strong class="jt iv"> <em class="nk">免责声明</em> </strong></p><p id="0c03" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我不是专业的财务顾问。这篇文章和代码，分享仅用于教育目的，而不是财务建议。你要对自己的输赢负责。</p><p id="02c1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><em class="nk">本文的全部代码可以在这个资源库中找到:</em></p><div class="nl nm gq gs nn no"><a href="https://github.com/atillayurtseven/TradeSimulation" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fp"><div class="nq ab nr cl cj ns"><h2 class="bd iv gz z fq nt fs ft nu fv fx it bi translated">atillayrutten/贸易模拟</h2><div class="nv l"><h3 class="bd b gz z fq nt fs ft nu fv fx dk translated">如何用Python模拟交易？通过创建一个关于…的帐户，为培训/贸易模拟发展做出贡献</h3></div><div class="nw l"><p class="bd b dl z fq nt fs ft nu fv fx dk translated">github.com</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc kz no"/></div></div></a></div><p id="1eea" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><strong class="jt iv">啊也；记得在以下社交渠道关注我:</strong></p><p id="e8f1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><a class="ae lu" href="https://medium.com/@atillayurtseven" rel="noopener">中型</a> <br/> <a class="ae lu" href="https://twitter.com/atillayurtseven" rel="noopener ugc nofollow" target="_blank">推特</a> <br/> <a class="ae lu" href="https://youtube.com/AtillaYurtseven" rel="noopener ugc nofollow" target="_blank"> YouTube！</a> <br/> <a class="ae lu" href="https://www.tradingview.com/u/AtillaYurtseven/" rel="noopener ugc nofollow" target="_blank">交易视图</a></p><p id="e2ce" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">直到下次；保持安全，交易安全！！！</p><p id="4b1c" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">图片来自:<a class="ae lu" href="https://hackernoon.com/algo-trading-for-dummies-implementing-an-actual-trading-strategy-part-4-acec5543052b" rel="noopener ugc nofollow" target="_blank">https://hacker noon . com/algo-trading-for-dummies-implementing-an-actual-trading-strategy-part-4-acec 5543052 b</a></p><p id="5391" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">阿蒂拉·尤尔特塞文</p><p id="999e" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><strong class="jt iv"> <em class="nk">注来自《走向数据科学》的编辑:</em> </strong> <em class="nk">虽然我们允许独立作者根据我们的</em> <a class="ae lu" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="nk">规则和指导方针</em> </a> <em class="nk">发表文章，但我们不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae lu" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="nk">读者术语</em> </a> <em class="nk">。</em></p></div></div>    
</body>
</html>