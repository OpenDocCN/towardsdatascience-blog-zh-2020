<html>
<head>
<title>FaceMask Detection using Tensorflow and OpenCV</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于Tensorflow和OpenCV的人脸检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/facemask-detection-using-tensorflow-and-opencv-824b69cad837?source=collection_archive---------45-----------------------#2020-06-01">https://towardsdatascience.com/facemask-detection-using-tensorflow-and-opencv-824b69cad837?source=collection_archive---------45-----------------------#2020-06-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f00eaf2cb3026fce780811f060884630.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*a68i8-uqHj7lbHE2"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">格伦·卡丽在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</p></figure><p id="cf11" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">简介:</strong></p><p id="9977" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在新冠肺炎危机中，戴口罩对于公共卫生和控制疫情的传播是绝对必要的。如果我们有一个系统可以监控我们周围的人是否遵守这些安全措施，会怎么样？</p><p id="e3e8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">借助深度学习的力量，这个系统可以检测出一个人是否戴了面具。感谢<a class="ae kf" href="https://github.com/prajnasb/observations" rel="noopener ugc nofollow" target="_blank"> prajnasb </a>编译我用于训练的数据集。我们从这里开始…</p><div class="le lf gp gr lg lh"><a href="https://github.com/HOD101s/Face-Mask-Detection" rel="noopener  ugc nofollow" target="_blank"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd iu gy z fp lm fr fs ln fu fw is bi translated">hod 101s/面罩检测</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">在COVID19危机中，戴口罩对于公共卫生和控制传染病的传播是绝对必要的</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">github.com</p></div></div><div class="lq l"><div class="lr l ls lt lu lq lv jz lh"/></div></div></a></div></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="4087" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">了解我们的数据:</strong></p><p id="1749" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在网上找到的所有资料中，由<a class="ae kf" href="https://github.com/prajnasb/observations" rel="noopener ugc nofollow" target="_blank"> prajnasb </a>发布的数据很容易处理，所以我继续使用同样的方法。任何具有大量戴口罩和不戴口罩的人的图像的数据集都适用于这个问题。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi md"><img src="../Images/e0018eab8749799d418134cb7a4618df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fEBMswpgm3thCT4o21nZEg.png"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://medium.com/@manasbass.99" rel="noopener">马纳斯·阿查里亚</a>拍摄</p></figure><p id="b8be" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的数据相当平衡，667幅图像属于无_掩码类，690幅图像属于有_掩码类。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="4525" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">处理我们的数据:</strong></p><p id="f5ca" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于keras强大的处理库，<strong class="ki iu">图像增强</strong>和<strong class="ki iu">数据管道化</strong>的过程变得非常容易。这里我使用了keras在其图像预处理函数下提供的<a class="ae kf" href="https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">imagedata generator</strong></a>。使用ImageDataGenerator，我们可以构建图像数据扩充管道，在训练期间实时执行扩充，从而节省内存，使其成为扩充数据的一个非常方便的解决方案。</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="36c6" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里我构建了两个数据生成器:一个用于训练和验证数据，另一个用于测试数据。训练和验证数据只是水平翻转，所以也没有应用大的扩充。完整的功能列表可在<a class="ae kf" href="https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image/ImageDataGenerator" rel="noopener ugc nofollow" target="_blank">文档</a>中找到。一个单独的测试数据生成器已经完成，因为我没有对它进行任何扩充。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="c56f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">模型架构和训练:</strong></p><p id="339c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我已经利用了<strong class="ki iu">迁移学习</strong>，感谢tensorflow <a class="ae kf" href="https://www.tensorflow.org/api_docs/python/tf/keras/applications" rel="noopener ugc nofollow" target="_blank">应用程序api </a>，这是一个非常简单的任务。使用<a class="ae kf" href="https://www.tensorflow.org/api_docs/python/tf/keras/applications/MobileNetV2" rel="noopener ugc nofollow" target="_blank"><strong class="ki iu">MobileNetV2</strong></a><strong class="ki iu"/>模型来构建我的分类器网络。</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="3396" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过使用迁移学习，我正在利用预先训练的MobileNetV2的特征检测能力，并将其应用于我们相当简单的模型。MobileNetV2之后是我们的DNN，由GlobalAveragePooling、Dense和Dropout层组成。由于我们的问题是一个二元分类问题，最后一层有2个神经元和softmax激活。</p><p id="3f62" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个通用的Adam优化器和Categorical _ crossentropy loss可以很好地收敛到我的网络的最佳权重。</p><p id="efda" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">到第六个纪元时，我在所有测试、训练和验证集上都获得了100%的结果。</p></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="8e94" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">部署:</strong></p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mk"><img src="../Images/351e729a207af498ad1538be84806686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XBc6xGjqvcqfsieL"/></div></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">照片由<a class="ae kf" href="https://unsplash.com/@adamsky1973?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Adam niecioruk</a>在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="1cf7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这里，我使用了流行的OpenCV库来获取我的网络摄像头馈送，并在我的模型中运行它。</p><p id="fa3e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们从人脸检测开始。为此，我使用了<a class="ae kf" href="https://docs.opencv.org/3.4/db/d28/tutorial_cascade_classifier.html" rel="noopener ugc nofollow" target="_blank">哈斯级联分类器</a>算法。接下来，我切下面部图像，对其进行归一化和缩放，然后输入到我的分类模型中。</p><figure class="me mf mg mh gt ju"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="2619" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用于训练网络的图像尺寸为224 x 224，因此我们需要按照<em class="ml"> prepImg(pth) </em>中所述，通过整形和归一化，以类似的方式准备我们的输入图像。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/6aa857d34a21f5f023640a6a09b22de8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*Wxj3jOnIgWEwr08qpjq8Tg.gif"/></div><p class="kb kc gj gh gi kd ke bd b be z dk translated">Gif由<a class="ae kf" href="https://medium.com/@manasbass.99" rel="noopener"> Manas Acharya </a></p></figure><p id="341f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">OpenCV实现只是以下内容的连续循环:</p><ul class=""><li id="9437" class="mn mo it ki b kj kk kn ko kr mp kv mq kz mr ld ms mt mu mv bi translated">检测面部</li><li id="b9d4" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">切片人脸图像</li><li id="0788" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">通过分类器</li><li id="12de" class="mn mo it ki b kj mw kn mx kr my kv mz kz na ld ms mt mu mv bi translated">获取并显示预测</li></ul></div><div class="ab cl lw lx hx ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="im in io ip iq"><p id="0033" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">结论:</strong></p><p id="76d1" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们已经准备好了一个工作模型，它可以检测一个人是否戴着面罩，并提示这个人戴上面罩！鉴于事情的发展方式，口罩将成为我们社会和公众健康的一个更重要的组成部分，在这种情况下，该系统将是确保遵守安全指南的必要条件。</p><p id="5d24" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您有任何建议或想法想要讨论，您可以通过LinkedIn与我联系。精益求精！</p><div class="le lf gp gr lg lh"><a href="https://www.linkedin.com/in/manas-acharya/" rel="noopener  ugc nofollow" target="_blank"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd iu gy z fp lm fr fs ln fu fw is bi translated">Manas Acharya -机器学习工程师- KubixSquare | LinkedIn</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">机器学习和数据科学爱好者，曾在前端Web领域担任全栈开发人员…</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">www.linkedin.com</p></div></div><div class="lq l"><div class="nb l ls lt lu lq lv jz lh"/></div></div></a></div><div class="le lf gp gr lg lh"><a rel="noopener follow" target="_blank" href="/building-a-rock-paper-scissors-ai-using-tensorflow-and-opencv-d5fc44fc8222"><div class="li ab fo"><div class="lj ab lk cl cj ll"><h2 class="bd iu gy z fp lm fr fs ln fu fw is bi translated">使用Tensorflow和OpenCV构建石头剪刀布人工智能</h2><div class="lo l"><h3 class="bd b gy z fp lm fr fs ln fu fw dk translated">古老的游戏被重新想象和更新……</h3></div><div class="lp l"><p class="bd b dl z fp lm fr fs ln fu fw dk translated">towardsdatascience.com</p></div></div><div class="lq l"><div class="nc l ls lt lu lq lv jz lh"/></div></div></a></div></div></div>    
</body>
</html>