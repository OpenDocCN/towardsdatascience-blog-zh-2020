<html>
<head>
<title>Forecasting Wars: Classical Forecasting Methods vs Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测战争:经典预测方法与机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/forecasting-wars-classical-forecasting-methods-vs-machine-learning-4fd5d2ceb716?source=collection_archive---------21-----------------------#2020-04-10">https://towardsdatascience.com/forecasting-wars-classical-forecasting-methods-vs-machine-learning-4fd5d2ceb716?source=collection_archive---------21-----------------------#2020-04-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/79daf2760c6b304a834ea1489038ab49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uJMyzHmSdTdUDMYf5F_NQw.png"/></div></div></figure><p id="dd16" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将使用来自kaggle竞赛的数据<a class="ae kz" href="https://www.kaggle.com/c/m5-forecasting-accuracy" rel="noopener ugc nofollow" target="_blank"> M5预测-准确性</a>。</p><p id="f1c4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">任务是尽可能精确地预测沃尔玛在美国销售的各种产品的单位销售(需求)。</p><p id="38fa" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">更准确地说，我们必须预测未来28天的日销售额。该数据涵盖了美国三个州(加利福尼亚州、德克萨斯州和威斯康星州)的商店，包括商品级别、部门、产品类别和商店详细信息。</p><p id="3d7f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">数据是巨大的，对于这个演示，我将使用其中的一个子集，一个来自销售数据集中的产品。</p><p id="0120" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">我们的目标是将经典的时间序列分析技术与机器学习算法进行比较。</strong></p><p id="ea39" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">所有代码都可以在<a class="ae kz" href="https://github.com/Deffro/Data-Science-Portfolio/tree/master/Notebooks/Forecasting%20Wars%20-%20Classical%20Forecasting%20Methods%20vs%20Machine%20Learning" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上获得。</p><p id="1e26" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">谁会更好地预测未来？</p><p id="da7f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">竞争对手:</p><ol class=""><li id="d9be" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky lf lg lh li bi translated">简单指数平滑</li><li id="3e48" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">双指数平滑</li><li id="620b" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">三重指数平滑</li><li id="c670" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">ARIMA</li><li id="daf2" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">萨里玛</li><li id="2f55" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">萨里马克斯</li><li id="cd63" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">光梯度增强</li><li id="89c0" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">随机森林</li><li id="3e4e" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">线性回归</li></ol><p id="d217" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">下注吧！</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">加载要使用的包。</p></figure><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">读取数据。</p></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ly"><img src="../Images/5e291d5b0bc5274b558a27b4e9400316.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PAZcUmLwqxLsGHZWQKcIpQ.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">数据集的前5行。</p></figure><p id="f780" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要预测的<strong class="kd iu">目标</strong>变量是<strong class="kd iu">需求</strong>(该产品在该日期将售出多少件)。</p><p id="c64c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">日期从2011年1月29日到2016年5月22日，总共1941天。后28天是竞赛_测试集，按照竞赛的指示，所以我们不知道需求(等于0)。</p><p id="8201" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了训练和验证模型，我将数据分成两部分:训练和测试。测试装置不应与竞赛测试装置混淆。</p><p id="5b0b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">测试集</strong>将具有与测试competition_test相同的长度，以模拟相同的条件。因此，它将由2016年3月27日<strong class="kd iu">和2016年4月24日(28天)</strong>之间的日期组成。训练集将是所有其他先前的值。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">从初始数据中分离出训练测试。</p></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lz"><img src="../Images/7a6d556c9164f120efca600b2ffa07b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jXZDBLYl-N25x7b7r-a-dA.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">时间序列(训练-测试)线图。</p></figure><p id="0d71" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们有很多训练数据，过去28天是测试集。我们的目标是使用以前的值来预测它们。</p><p id="501d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我将创建一个<em class="ma">预测</em>数据帧来存储所有模型的预测。每个模型将是该数据框架中的一列。另外，一个<em class="ma"> stats </em> dataframe存储每个模型的性能和执行时间。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div></figure><h1 id="45e9" class="mb mc it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">训练和评估模型</h1><p id="5bad" class="pw-post-body-paragraph kb kc it kd b ke mz kg kh ki na kk kl km nb ko kp kq nc ks kt ku nd kw kx ky im bi translated">我们将从简单的传统预测模型开始。不要低估他们。</p><h1 id="622a" class="mb mc it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">简单指数平滑</h1><p id="bdac" class="pw-post-body-paragraph kb kc it kd b ke mz kg kh ki na kk kl km nb ko kp kq nc ks kt ku nd kw kx ky im bi translated">这是简单移动平均的一种变体，称为指数加权移动平均(EWMA)或简单霍尔特-温特斯法。用于将其加载到Python的包称为SimpleExpSmoothing。我们必须定义一个名为<em class="ma"> span </em>的参数，它将等于数据集的季节周期。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">自相关。</p></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ne"><img src="../Images/387a9e7d606a089eaaba5888191aac68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8lZm9sQVLPLTKveRxHO1Cw.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">每个值与多达60个以前的滞后进行比较。</p></figure><p id="cca4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">从自相关图中，我们可以清楚地看到，每7个滞后就有一个相关性峰值。这意味着当天的值和之前7天的值具有很高的相关性。我将设置span等于7。经过训练，使用<em class="ma">。预测(x) </em>，x=28天，模型预测未来28天。将使用均方根误差进行评估。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">简单的指数平滑。</p></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/be1014db4449a891faeaeb496ba47cc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nogrdey4lCPPHrldO-ckBA.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">简单指数平滑的性能。</p></figure><p id="c1fe" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">那些投票支持简单指数平滑的人确实会失望。然而，让我们以RMSE为基准。</p><h1 id="c74c" class="mb mc it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">双指数平滑</h1><p id="a29a" class="pw-post-body-paragraph kb kc it kd b ke mz kg kh ki na kk kl km nb ko kp kq nc ks kt ku nd kw kx ky im bi translated">简单指数平滑仅使用一个平滑因子α (alpha ),而双指数平滑添加了第二个平滑因子β (beta ),用于处理数据趋势。我们必须定义<em class="ma">季节周期</em>。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">双重指数平滑。</p></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ng"><img src="../Images/b792a6e7302c653ee03984f0fc9ddc99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q6zf0-WXRCAeYzeKdDfQuA.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">双指数平滑的性能。</p></figure><p id="54d0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">比SES好，但还是直线。我们能做得更好吗？</p><h1 id="cb1a" class="mb mc it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">三重指数平滑</h1><p id="0ab0" class="pw-post-body-paragraph kb kc it kd b ke mz kg kh ki na kk kl km nb ko kp kq nc ks kt ku nd kw kx ky im bi translated">与霍尔特-温特斯最密切相关的三重指数平滑法增加了对数据中趋势和季节性的支持。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">三重指数平滑。</p></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/f50d5c34a55d0b3d16bc918ce344a5a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VkKoUPqM5QZzOcbu_kdGAA.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">三重指数平滑的性能。</p></figure><p id="bc38" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们正在做一些事情！TES很好地捕捉到了数据的季节性，并且几乎总是接近测试数据。缺点是我们必须输入季节周期的数量。如果这个数字不是7，性能会变差。</p><h1 id="8ed0" class="mb mc it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">ARIMA</h1><p id="3126" class="pw-post-body-paragraph kb kc it kd b ke mz kg kh ki na kk kl km nb ko kp kq nc ks kt ku nd kw kx ky im bi translated">一个ARIMA模型由三部分组成:p，d，q</p><ul class=""><li id="5221" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky ni lg lh li bi translated">p是AR项的阶数。它是指用作预测值的Y的滞后数。</li><li id="dc7c" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky ni lg lh li bi translated">q是MA项的阶数。它是指应该进入ARIMA模型的滞后预测误差的数量。</li><li id="baf7" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky ni lg lh li bi translated">d是使时间序列平稳所需的差分次数</li></ul><p id="06bc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">自动选择ARIMA参数</strong></p><p id="c4fb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将使用优秀的<em class="ma"> auto_arima </em>包，它会自动发现arima模型的最佳订单。</p><p id="0e8a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们忽略季节性。如果我们加上季节性，这个模型将是SARIMA，这将在后面讨论。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/dc78f3d6feb30a77698442dc3876373f.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*EQXlmsh_xSwXEzXr1JgHwQ.png"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">arima的auto_arima结果。</p></figure><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">ARIMA。</p></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nk"><img src="../Images/db610eb15423bcbbb833e99913da5de3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*upu0JtLcVzUwGzYNe3EdcA.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">ARIMA的表演。</p></figure><p id="6ce0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里使用的简单ARIMA模型没有考虑季节性。这是一个(5，1，3)模型。这意味着它使用5个滞后来预测当前值。涉及滞后预测误差数量的移动窗口的大小等于1。使时间序列平稳所需的差值为3。</p><p id="2a62" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">该模型的性能比三重指数平滑法差。</p><h1 id="ed01" class="mb mc it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">萨里玛</h1><p id="5ff2" class="pw-post-body-paragraph kb kc it kd b ke mz kg kh ki na kk kl km nb ko kp kq nc ks kt ku nd kw kx ky im bi translated">它是ARIMA的扩展，接受一组额外的参数，专门描述模型的季节组成部分。</p><p id="6d61" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">与ARIMA相比，我们将使用2个额外的参数:<em class="ma">季节性=真实值</em>和<em class="ma"> m=7 </em>。我们现在考虑季节性，并对模型说它等于7。Auto_arima运行的时间要长得多。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/d82684205d775a6abc9b3ae6ff20c70a.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*Mo8w9XSm7OaWrj7FmNIKBA.png"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">SARIMA的auto_arima结果。</p></figure><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">萨里玛。</p></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nk"><img src="../Images/c4074b6eaa353acc3762078faf493937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o6dIg_nbP1T6T10sOmpx3A.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">萨里玛的表演。</p></figure><p id="b163" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这比简单的ARIMA好得多，事实上也比三重指数平滑法好得多！</p><h1 id="9aac" class="mb mc it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">萨里马克斯</h1><p id="be69" class="pw-post-body-paragraph kb kc it kd b ke mz kg kh ki na kk kl km nb ko kp kq nc ks kt ku nd kw kx ky im bi translated">使用以前的方法，我们唯一可以使用的数据是以前的历史数据。带有外生回归的季节性自回归综合移动平均引入了外部特征可以影响时间序列的思想。</p><p id="e0fa" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将添加数据集的另一个特征，即<em class="ma"> sell_price </em>，以帮助模型，并有望做出更好的预测。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">萨里麦克斯。</p></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/889ab9b394dd298c86ee5f6d8176e595.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*e2nsUaO6dLF38C8m8bAu9Q.png"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">SARIMAX的auto_arima结果。</p></figure><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/1558b8cad1e921dc36f23cbd868e258d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2wjzknnsl7-0Pnq8r66opw.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">SARIMAX的性能。</p></figure><p id="3e1d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">SARIMAX运行时间更长。额外的功能减少了误差！</p><h1 id="9c1a" class="mb mc it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">机器学习</h1><p id="3fa3" class="pw-post-body-paragraph kb kc it kd b ke mz kg kh ki na kk kl km nb ko kp kq nc ks kt ku nd kw kx ky im bi translated">机器学习模型，不能仅仅通过它本身以前的值来预测目标。他们需要特色。这就是我们将要做的，构造一些特征。</p><p id="2f5d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">目标先前值的所有信息都将丢失。我们将创建要素来维护这些信息。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">史上最大的github gist。</p></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nn"><img src="../Images/15a75171fed3c98bfc24c1af9b8d4b2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HpEdPc1ODwL8sVU6HcGGHg.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">数据集的前5行。</p></figure><p id="a2b2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我将创建的功能相对较少且简单。</p><ul class=""><li id="b170" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky ni lg lh li bi translated">滞后7:提前7天的需求值</li><li id="488c" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky ni lg lh li bi translated">滚动平均值7_7:在滞后7上，计算前7天的滚动平均值。这意味着我们现在回到了14天前。</li></ul><p id="4742" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当滞后7捕获一天时，滚动平均7在单个特征中捕获关于7天的信息。</p><p id="96e3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">有人可能会想，哦，那么我们为什么不为每个滞后创建一个特征呢？滞后1，2，3，..1885,..？我们可以创建一些，如滞后6和8(我们看到它们在自相关图中很强)，或滞后14，30。然而，增加数据集的维度将是一个严重的问题。RAM过载、巨大的执行时间、过拟合、相关性。</p><p id="397a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">创建的其他功能包括:</p><ul class=""><li id="2977" class="la lb it kd b ke kf ki kj km lc kq ld ku le ky ni lg lh li bi translated">每月需求平均值，最大值，最大值到最小值差值。这捕获了信息:该产品在12月、4月等的平均销售额是多少。</li><li id="e3de" class="la lb it kd b ke lj ki lk km ll kq lm ku ln ky ni lg lh li bi translated">每天每周平均值、中值、最大值</li></ul><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">创建特征的函数。</p></figure><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">为ML准备数据。</p></figure><h1 id="2096" class="mb mc it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">适合模型</h1><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">适合三个ML模型。</p></figure><h1 id="7ce3" class="mb mc it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">使用滑动窗口通过模型进行预测</h1><p id="db8a" class="pw-post-body-paragraph kb kc it kd b ke mz kg kh ki na kk kl km nb ko kp kq nc ks kt ku nd kw kx ky im bi translated">这部分需要更多的关注。我会解释的。</p><p id="c44c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">测试集由28天组成。假设是第1，2，3…，28天。还记得我们为训练集创建的特性lag_7吗？显然，我们将为测试集创建相同的特性。当我们为测试集的第一天创建这个特性时，它被创建得非常好。它提前7天(在训练集中)并复制该值。如果我们在第10天创建这个特性，它会提前7天。这是测试的第三天。我们不知道它的价值！</p><p id="6dc7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">所以我们做了一个滑动窗口，一次向前移动一天。在每次迭代中，我们预测今天的价值。所以我们用我们的预测来填充测试集。当我们到达测试集中的第10天时，我们将具有先前的值，并且可以计算lag7。</p><p id="2ee2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">等等，你为什么使用长度为15的滑动窗口(max_lags=15)？功能lag 7需要至少提前7天的样本。特征滚动平均7_7需要提前14天。因此，为了成功创建要素，最小窗口大小应为14。如果我们增加窗口的大小，它不会影响这些功能。他们不使用早期的值。但如果我们增加它，那么它将影响其他功能(每月平均需求等)。我尝试过增加它，但rmse减少了一点，执行时间增加了一点。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">预测未知未来的滑动窗口技术。</p></figure><h1 id="10a4" class="mb mc it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">光梯度增强</h1><p id="a0ef" class="pw-post-body-paragraph kb kc it kd b ke mz kg kh ki na kk kl km nb ko kp kq nc ks kt ku nd kw kx ky im bi translated">我调整了算法的参数以获得更好的性能。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">光梯度增强。</p></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nk"><img src="../Images/184f019507677c3e8961ca8534b4f8ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qSFmRYccPhpCoWutHKdmlw.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">光梯度增强的性能。</p></figure><p id="8d09" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">啊，LightGB...它从不让人失望。(但是，不要盲目的用在每个问题上。)</p><h1 id="88b7" class="mb mc it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">随机森林</h1><p id="d5a4" class="pw-post-body-paragraph kb kc it kd b ke mz kg kh ki na kk kl km nb ko kp kq nc ks kt ku nd kw kx ky im bi translated">我调整了树的最大深度以获得更好的性能。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">随机森林。</p></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/46519975d911d714372e46b5ce60949f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*66H7atBbtdbRxDeInJ-k9w.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">随机森林的性能。</p></figure><p id="4f3b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">随机森林的表现也很好。</p><h1 id="9795" class="mb mc it bd md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my bi translated">线性回归</h1><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">线性回归。</p></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/5afce569464e576c23166e74bcc96c0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MpPzXniv31D8NKYBDgJPIA.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">线性回归的性能。</p></figure><p id="595f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">好老线性回归在这里是极好的！</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div class="gh gi np"><img src="../Images/855216129fec6d579b0b808aec5d4d4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*32vq-Bn1HgG_3JRr_h2Jiw.png"/></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">所有竞争者的执行时间和RMSE。</p></figure><p id="d56f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">传统的预测方法要慢得多。</p><figure class="lo lp lq lr gt ju"><div class="bz fp l di"><div class="ls lt l"/></div></figure><figure class="lo lp lq lr gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/37a5f6e986a72eb01b079057e9034d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wMuWLXMHZYU4fOY_dcREBw.png"/></div></div><p class="lu lv gj gh gi lw lx bd b be z dk translated">每个模型的均方根误差。越低越好。</p></figure><p id="5c20" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我们分析的最后，我可以说这只是一个基线实验。当然，可以创建更多的特征，然后通过特征选择技术来选择最佳数量，可以进行更多的超参数调整，这样的例子不胜枚举。</p><p id="f194" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">那么ML方法是否优于经典的时间序列预测方法呢？</p><p id="7080" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="ma">也许是</em></p><p id="4b3c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这当然取决于问题。机器学习方法需要特征。如果我们只有时间序列的值，那么我们能够创建的唯一特征就是基于它们。这些将是滞后，移动平均线等，所以我们可以包括尽可能多的信息，而不需要做太多的栏目。只有6个特征的线性回归优于所有经典方法。通过特征工程使ML方法变得更好是数据科学家的职责。突出算法的不一定是模型，而是提供给算法的数据。</p><p id="6897" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">所以带LightGB的ML机型赢了战斗，但没打赢战争。</p></div></div>    
</body>
</html>