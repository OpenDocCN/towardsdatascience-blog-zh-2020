<html>
<head>
<title>Urban Sound Classification using Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于神经网络的城市声音分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/urban-sound-classification-using-neural-networks-9b6fcd8a9150?source=collection_archive---------16-----------------------#2020-09-10">https://towardsdatascience.com/urban-sound-classification-using-neural-networks-9b6fcd8a9150?source=collection_archive---------16-----------------------#2020-09-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9175" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用深度学习进行声音分类</h2></div><p id="c578" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每天我们都会听到不同的声音，这是我们生活的一部分。人类可以很容易地区分不同的声音，但是如果计算机也能把声音分类，那该多好啊。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/045ee3eff1b78a6c5a7d269003f05bc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oXg2r1PctEZBPOSmcf3ZcA.png"/></div></div><p class="ln lo gj gh gi lp lq bd b be z dk translated">图片由<a class="ae lr" href="https://pixabay.com/users/CSTRSK-642467/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=856771" rel="noopener ugc nofollow" target="_blank"> CSTRSK </a>来自<a class="ae lr" href="https://pixabay.com/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=856771" rel="noopener ugc nofollow" target="_blank"> Pixabay </a></p></figure><p id="9097" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇博文中，我们将学习使用带有神经网络的机器学习对城市声音进行分类的技术。该数据集取自一个名为<a class="ae lr" href="https://datahack.analyticsvidhya.com/contest/practice-problem-urban-sound-classification/" rel="noopener ugc nofollow" target="_blank">城市声音</a>的分析视频竞赛。该数据集包含 8732 个标记的城市声音摘录，来自 10 个类别:空调、汽车喇叭、儿童玩耍、狗叫、钻孔、发动机空转、枪击、手提钻、警笛和街头音乐。</p><p id="d2ac" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我将使用 python librosa 库从音频剪辑中提取数字特征，并使用这些特征来训练神经网络模型。</p><p id="3159" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，让我们得到所有需要的库，</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="3b65" class="lx ly iq lt b gy lz ma l mb mc"><strong class="lt ir">import</strong> <strong class="lt ir">IPython.display</strong> <strong class="lt ir">as</strong> <strong class="lt ir">ipd</strong><br/><strong class="lt ir">import</strong> <strong class="lt ir">os</strong><br/><strong class="lt ir">import</strong> <strong class="lt ir">numpy</strong> <strong class="lt ir">as</strong> <strong class="lt ir">np</strong><br/><strong class="lt ir">import</strong> <strong class="lt ir">pandas</strong> <strong class="lt ir">as</strong> <strong class="lt ir">pd</strong><br/><strong class="lt ir">import</strong> <strong class="lt ir">matplotlib.pyplot</strong> <strong class="lt ir">as</strong> <strong class="lt ir">plt</strong><br/><strong class="lt ir">import</strong> <strong class="lt ir">librosa</strong><br/><strong class="lt ir">from</strong> <strong class="lt ir">tqdm</strong> <strong class="lt ir">import</strong> tqdm<br/><strong class="lt ir">from</strong> <strong class="lt ir">sklearn.preprocessing</strong> <strong class="lt ir">import</strong> StandardScaler<br/><strong class="lt ir">from</strong> <strong class="lt ir">keras.models</strong> <strong class="lt ir">import</strong> Sequential<br/><strong class="lt ir">from</strong> <strong class="lt ir">keras.layers</strong> <strong class="lt ir">import</strong> Dense, Dropout, Activation<br/><strong class="lt ir">from</strong> <strong class="lt ir">keras.optimizers</strong> <strong class="lt ir">import</strong> Adam</span></pre><p id="c56c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据集可以在 google drive 中找到，可以从<a class="ae lr" href="https://drive.google.com/drive/folders/0By0bAi7hOBAFUHVXd1JCN3MwTEU" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><p id="aa68" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数据集包含保存声音摘录的 train、test 文件夹，并且存在具有每个声音摘录的标签的 train.csv 和 test.csv。我将只使用训练文件夹进行训练、验证和测试，它包含 5435 个标记的声音。</p><p id="cafe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们阅读 train.csv，它包含有关声音摘录的标签信息。</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="36bf" class="lx ly iq lt b gy lz ma l mb mc">data=pd.read_csv('/content/drive/MyDrive/colab_notebook/train.csv')</span><span id="2a9f" class="lx ly iq lt b gy md ma l mb mc">data.head()#To see the dataset</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi me"><img src="../Images/342daa1b902dc33c94eef78be30219df.png" data-original-src="https://miro.medium.com/v2/resize:fit:338/format:webp/1*QHbYMWXsUt7bqox2LBmTjw.png"/></div></figure><p id="46f4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们听听数据集中的任何随机声音，</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="11a0" class="lx ly iq lt b gy lz ma l mb mc">ipd.Audio(‘/content/drive/My Drive/colab_notebook/Train/123.wav’)</span></pre><p id="3fc7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，主要步骤是从数据集中提取要素。为此，我将使用 librosa 库。这是一个很好的音频文件库。</p><p id="58a6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用 librosa 库，我将从音频文件中提取四个特征。这些特征是 mel 倒谱系数(MFCCs)、tonnetz、Mel 标度谱图和来自波形的色谱图。</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="57d0" class="lx ly iq lt b gy lz ma l mb mc">mfc=[]<br/>chr=[]<br/>me=[]<br/>ton=[]<br/>lab=[]<br/><strong class="lt ir">for</strong> i <strong class="lt ir">in</strong> tqdm(range(len(data))):<br/>    f_name='/content/drive/My Drive/colab_notebook/Train/'+str(data.ID[i])+'.wav'<br/>    X, s_rate = librosa.load(f_name, res_type='kaiser_fast')<br/>    mf = np.mean(librosa.feature.mfcc(y=X, sr=s_rate).T,axis=0)<br/>    mfc.append(mf)<br/>    l=data.Class[i]<br/>    lab.append(l)<br/>    <strong class="lt ir">try</strong>:<br/>        t =    np.mean(librosa.feature.tonnetz(<br/>                       y=librosa.effects.harmonic(X),<br/>                       sr=s_rate).T,axis=0)<br/>        ton.append(t)<br/>    <strong class="lt ir">except</strong>:<br/>        print(f_name)  <br/>    m = np.mean(librosa.feature.melspectrogram(X, sr=s_rate).T,axis=0)<br/>    me.append(m)<br/>    s = np.abs(librosa.stft(X))<br/>    c = np.mean(librosa.feature.chroma_stft(S=s, sr=s_rate).T,axis=0)<br/>    chr.append(c)</span></pre><p id="5dd9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我有 186 个功能，每个音频文件都有各自的标签。</p><p id="4880" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从音频文件中提取特征后，保存特征，因为提取特征将花费大量时间。</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="c546" class="lx ly iq lt b gy lz ma l mb mc">mfcc = pd.DataFrame(mfc)<br/>mfcc.to_csv('/content/drive/My Drive/colab_notebook/mfc.csv', index=<strong class="lt ir">False</strong>)<br/>chrr = pd.DataFrame(chr)<br/>chrr.to_csv('/content/drive/My Drive/colab_notebook/chr.csv', index=<strong class="lt ir">False</strong>)<br/>mee = pd.DataFrame(me)<br/>mee.to_csv('/content/drive/My Drive/colab_notebook/me.csv', index=<strong class="lt ir">False</strong>)<br/>tonn = pd.DataFrame(ton)<br/>tonn.to_csv('/content/drive/My Drive/colab_notebook/ton.csv', index=<strong class="lt ir">False</strong>)<br/>la = pd.DataFrame(lab)<br/>la.to_csv('/content/drive/My Drive/colab_notebook/labels.csv', index=<strong class="lt ir">False</strong>)</span></pre><p id="77f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将特征连接成一个数组，以便传递给模型。</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="d923" class="lx ly iq lt b gy lz ma l mb mc">features = []<br/><strong class="lt ir">for</strong> i <strong class="lt ir">in</strong> range(len(ton)):<br/>    features.append(np.concatenate((me[i], mfc[i], <br/>                ton[i], chr[i]), axis=0))</span></pre><p id="a74a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对标签进行编码，以便模型能够理解。</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="4cc1" class="lx ly iq lt b gy lz ma l mb mc">la = pd.get_dummies(lab)</span><span id="0784" class="lx ly iq lt b gy md ma l mb mc">label_columns=la.columns #To get the classes</span><span id="7a83" class="lx ly iq lt b gy md ma l mb mc">target = la.to_numpy() #Convert labels to numpy array</span></pre><p id="586b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在归一化的特点，使梯度下降可以更快地收敛。</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="c45d" class="lx ly iq lt b gy lz ma l mb mc">tran = StandardScaler()<br/>features_train = tran.fit_transform(features)</span></pre><p id="edb2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我将创建训练、验证和测试数据集。</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="3921" class="lx ly iq lt b gy lz ma l mb mc">feat_train=features_train[:4434]<br/>target_train=target[:4434]<br/>y_train=features_train[4434:5330]<br/>y_val=target[4434:5330]<br/>test_data=features_train[5330:]<br/>test_label=lab['0'][5330:]</span><span id="47e3" class="lx ly iq lt b gy md ma l mb mc">print("Training",feat_train.shape)<br/>print(target_train.shape)<br/>print("Validation",y_train.shape)<br/>print(y_val.shape)<br/>print("Test",test_data.shape)<br/>print(test_label.shape)</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/cd54bb6c3543c568dac17a962a5c72dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:342/format:webp/1*Z7NEEFuBLiu0TBkjIoZ_rQ.png"/></div></figure><p id="f149" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下一步是建立模型。</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="13ed" class="lx ly iq lt b gy lz ma l mb mc">model = Sequential()<br/><br/>model.add(Dense(186, input_shape=(186,), activation = 'relu'))<br/><br/>model.add(Dense(256, activation = 'relu'))<br/>model.add(Dropout(0.6))<br/><br/>model.add(Dense(128, activation = 'relu'))<br/>model.add(Dropout(0.5))<br/><br/>model.add(Dense(10, activation = 'softmax'))<br/><br/>model.compile(loss='categorical_crossentropy', metrics=['accuracy'], optimizer='adam')</span></pre><p id="d364" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是将用于培训的最终模型。</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="f3f2" class="lx ly iq lt b gy lz ma l mb mc">history = model.fit(feat_train, target_train, batch_size=64, epochs=30, <br/>                    validation_data=(y_train, y_val))</span></pre><p id="16fe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该模型将针对 epoch =30 进行训练，并且批量大小为 64。</p><p id="bc6e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在训练模型之后，它给出了 92%的验证准确度。</p><p id="02c5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们看看我们的模型将如何在测试数据集上执行。</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="822d" class="lx ly iq lt b gy lz ma l mb mc">predict = model.predict_classes(test_data) #<em class="mg">To predict labels</em></span></pre><p id="e43f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将获得现在的值，以获得作为类的预测。</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="c23b" class="lx ly iq lt b gy lz ma l mb mc">prediction=[]<br/><strong class="lt ir">for</strong> i <strong class="lt ir">in</strong> predict:<br/>  j=label_columns[i]<br/>  prediction.append(j)</span></pre><p id="2ce6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">预测有 104 个测试标签，现在计算有多少是正确预测。</p><pre class="lc ld le lf gt ls lt lu lv aw lw bi"><span id="3680" class="lx ly iq lt b gy lz ma l mb mc">k=0<br/>for i, j in zip(test_label,prediction):<br/>    if i==j:<br/>       k=k+1</span></pre><p id="58fe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在 104 个标签中，这个模型已经正确预测了 94 个标签，这是非常好的。</p><p id="6fd1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇博客中，我们讨论了如何使用 librosa 库从音频文件中提取特征，然后建立一个模型来将音频文件分类到不同的类别中。</p><p id="a14d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文中的所有代码都驻留在这个 Github <a class="ae lr" href="https://github.com/shubham7169/Projects/blob/master/Urban%20Sound%20Classification.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a>上:</p><div class="mh mi gp gr mj mk"><a href="https://github.com/shubham7169/Projects/blob/master/Urban%20Sound%20Classification.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="ml ab fo"><div class="mm ab mn cl cj mo"><h2 class="bd ir gy z fp mp fr fs mq fu fw ip bi translated">Shu bham 7169/项目</h2><div class="mr l"><h3 class="bd b gy z fp mp fr fs mq fu fw dk translated">permalink dissolve GitHub 是超过 5000 万开发人员的家园，他们一起工作来托管和审查代码，管理…</h3></div><div class="ms l"><p class="bd b dl z fp mp fr fs mq fu fw dk translated">github.com</p></div></div><div class="mt l"><div class="mu l mv mw mx mt my ll mk"/></div></div></a></div></div></div>    
</body>
</html>