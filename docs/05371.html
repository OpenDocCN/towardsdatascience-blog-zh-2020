<html>
<head>
<title>How to use apply, applymap and map in 3 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在3分钟内使用应用、应用地图和地图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-apply-applymap-and-map-in-3-minutes-36a08c09257?source=collection_archive---------26-----------------------#2020-05-06">https://towardsdatascience.com/how-to-use-apply-applymap-and-map-in-3-minutes-36a08c09257?source=collection_archive---------26-----------------------#2020-05-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="700e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有时不太清楚什么时候使用map、applymap或map。我会解释何时使用哪一个。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4702f64c8bd0971a51f200818ea60b64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*22Rb-fVvFzyxhLNzXEMnVw.png"/></div></div></figure><p id="9579" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi lq translated">当你开始使用Python进行数据分析时，你会对所有的可能性着迷，但有时你也会感到困惑。通常有很多方法可以达到相同的目标，但你不确定该用哪一种。比如，很多人并不清楚<code class="fe lz ma mb mc b">apply</code>、<code class="fe lz ma mb mc b">applymap</code>和<code class="fe lz ma mb mc b">map</code>的区别。为此，我想讨论一下三种方法的区别以及何时使用哪一种方法。</p><h2 id="1282" class="md me it bd mf mg mh dn mi mj mk dp ml ld mm mn mo lh mp mq mr ll ms mt mu mv bi translated">示例1 —应用</h2><p id="8680" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">假设你是辛普森团队的数据科学家。该系列的明星得到了赞助，每个明星每一季都有预算来买东西。你有第一季到第三季的成本:</p><pre class="kj kk kl km gt nb mc nc nd aw ne bi"><span id="5244" class="md me it mc b gy nf ng l nh ni">&gt;&gt;&gt; df = pd.DataFrame({'Customer': 'Mr.Burns Lisa Marge Milhouse Bart Homer'.split(),<br/> 'Costs_1': np.arange(6) *2, 'Costs_2': np.arange(6) * 4, 'Costs_3': np.arange(6) * 6})<br/>&gt;&gt;&gt; df<br/>   Customer  Costs_1  Costs_2  Costs_3<br/>0  Mr.Burns        0        0        0<br/>1      Lisa        2        4        6<br/>2     Marge        4        8       12<br/>3  Milhouse        6       12       18<br/>4      Bart        8       16       24<br/>5     Homer       10       20       30</span></pre><p id="f338" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">第一项任务是确定每个季度的支出差异有多大。为此，我们首先创建一个函数来确定列的最大值和最小值，并将它们相减:</p><pre class="kj kk kl km gt nb mc nc nd aw ne bi"><span id="9373" class="md me it mc b gy nf ng l nh ni">&gt;&gt;&gt; def diff_calc(x):<br/> diff = x.max() — x.min()<br/> return diff</span></pre><p id="8518" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在我们将该函数应用于数据帧中所有需要的列之后:</p><pre class="kj kk kl km gt nb mc nc nd aw ne bi"><span id="0481" class="md me it mc b gy nf ng l nh ni">&gt;&gt;&gt; df[['Costs_1', 'Costs_2', 'Costs_3']].apply(diff_calc)<br/>Costs_1    10<br/>Costs_2    20<br/>Costs_3    30<br/>dtype: int64</span></pre><p id="50b4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如您所见，我们总共得到三个结果。我们对其应用函数的每一列都有一个结果。这是一个有趣的发现:每一季差异都在增加，所以我们似乎有特别渴望消费的明星。</p><blockquote class="nj nk nl"><p id="99b2" class="ku kv nm kw b kx ky ju kz la lb jx lc nn le lf lg no li lj lk np lm ln lo lp im bi translated">我们为什么使用apply？</p></blockquote><p id="504b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><code class="fe lz ma mb mc b">apply</code>方法可以用于一维数组。该方法可用于列和行。一维数组总是作为输入，即函数是逐行或逐列执行的。如果我们添加<code class="fe lz ma mb mc b">axis=1</code>作为参数，我们得到一个逐行计算:</p><pre class="kj kk kl km gt nb mc nc nd aw ne bi"><span id="7e4d" class="md me it mc b gy nf ng l nh ni">&gt;&gt;&gt; df[['Costs_1', 'Costs_2', 'Costs_3']].apply(diff_calc, axis=1)<br/>0     0<br/>1     4<br/>2     8<br/>3    12<br/>4    16<br/>5    20<br/>dtype: int64</span></pre><h2 id="0a88" class="md me it bd mf mg mh dn mi mj mk dp ml ld mm mn mo lh mp mq mr ll ms mt mu mv bi translated">示例2 —应用地图</h2><p id="9fdc" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">在第一个例子中，我们希望对数据帧的每个数字列应用一个特定的函数。如果我们想单独改变每个元素呢？假设市场部的一位同事要求您将每个元素格式化为字符串，并为每个元素添加前缀“S_”作为Simpson值的标签。在这种情况下，您需要一个可以应用于每个单独元素的函数。让我们首先创建函数:</p><pre class="kj kk kl km gt nb mc nc nd aw ne bi"><span id="bc0f" class="md me it mc b gy nf ng l nh ni">&gt;&gt;&gt; def simpsons_string(x):<br/> result = "S_" + str(x)<br/> return result</span></pre><p id="fbcc" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用<code class="fe lz ma mb mc b">applymap</code>,我们现在可以将函数应用于数据帧的任何元素:</p><pre class="kj kk kl km gt nb mc nc nd aw ne bi"><span id="6c12" class="md me it mc b gy nf ng l nh ni">&gt;&gt;&gt; df.applymap(simpsons_string)<br/>     Customer Costs_1 Costs_2 Costs_3<br/>0  S_Mr.Burns     S_0     S_0     S_0<br/>1      S_Lisa     S_2     S_4     S_6<br/>2     S_Marge     S_4     S_8    S_12<br/>3  S_Milhouse     S_6    S_12    S_18<br/>4      S_Bart     S_8    S_16    S_24<br/>5     S_Homer    S_10    S_20    S_30</span></pre><p id="2c24" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">好吧，实际上我们应该告诉我们的同事，这个要求在数据处理方面不是最佳的，但是<code class="fe lz ma mb mc b">applymap</code>为我们提供了很好的服务。</p><h2 id="c027" class="md me it bd mf mg mh dn mi mj mk dp ml ld mm mn mo lh mp mq mr ll ms mt mu mv bi translated">示例3 —地图()</h2><p id="5ae6" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">在我们准备了上面的数据并给每个元素添加了前缀之后，我们得到的反馈是这位同事犯了一个错误。他只希望所有的字符串元素都有一个前缀。所以现在我们必须改变列的每个元素:</p><pre class="kj kk kl km gt nb mc nc nd aw ne bi"><span id="a1a6" class="md me it mc b gy nf ng l nh ni">&gt;&gt;&gt; df['Customer'].map(simpsons_string)<br/>0    S_Mr.Burns<br/>1        S_Lisa<br/>2       S_Marge<br/>3    S_Milhouse<br/>4        S_Bart<br/>5       S_Homer<br/>Name: Customer, dtype: object</span></pre><p id="9f26" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">完美！使用<code class="fe lz ma mb mc b">map()</code>,我们可以将函数应用于一列中的每个元素，而使用<code class="fe lz ma mb mc b">applymap()</code>,我们可以将函数应用于整个数据帧。</p><h2 id="351f" class="md me it bd mf mg mh dn mi mj mk dp ml ld mm mn mo lh mp mq mr ll ms mt mu mv bi translated">结论</h2><p id="0324" class="pw-post-body-paragraph ku kv it kw b kx mw ju kz la mx jx lc ld my lf lg lh mz lj lk ll na ln lo lp im bi translated">通过这三种方法，<code class="fe lz ma mb mc b">apply()</code>、<code class="fe lz ma mb mc b">applymap()</code>和<code class="fe lz ma mb mc b">map()</code>功能可应用于数据帧或部分数据帧。使用<code class="fe lz ma mb mc b">apply()</code>将函数应用于列或行，<code class="fe lz ma mb mc b">applymap()</code>对整个数据帧的元素起作用，<code class="fe lz ma mb mc b">map()</code>对单个系列的元素起作用。</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><p id="c2df" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><a class="ae nx" href="https://medium.com/@droste.benedikt/membership" rel="noopener">如果您喜欢中级数据科学，并且尚未注册，请随时使用我的推荐链接加入该社区。</a></p></div></div>    
</body>
</html>