<html>
<head>
<title>Adding Style to Pandas (in just a few lines of code!)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">给熊猫添加样式(只用了几行代码！)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/adding-style-to-pandas-in-just-a-few-lines-of-code-be942f65b3a5?source=collection_archive---------14-----------------------#2020-04-20">https://towardsdatascience.com/adding-style-to-pandas-in-just-a-few-lines-of-code-be942f65b3a5?source=collection_archive---------14-----------------------#2020-04-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="1c9c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">制作你的数据框架(很多！！)更漂亮</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/35db195e10d028e464d3cab3ac7c1b69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3__oGPc7TD6c25RNpoIphg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">让我们给我们的熊猫数据框添加一些风格吧！资料来源:Nik Piepenbreier</p></figure><p id="d7ca" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Pandas 是 Python 中数据分析的典型工具，但让数据看起来像样并不总是最容易的。为此，许多分析师在与我们更广泛的受众分享数据之前，仍然求助于 Excel 来添加数据样式(如货币)或条件格式。在这篇文章中，我们将探索如何利用 Excel 中常见的这些特性，并演示如何使用熊猫风格的 API 来利用这些特性！</p><h1 id="7372" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated"><strong class="ak">我们为什么要设计数据的样式？</strong></h1><p id="d5df" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">我们的最终目标应该是让读者更容易理解数据，同时保持数据框架中底层数据的可用性。例如，10%可能比值 0.10 更容易理解，但保持 0.10 的比例对于进一步分析更有用。</p><h1 id="1bb3" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">什么是熊猫风格 API？</h1><p id="7600" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">熊猫在 2019 年开发了造型 API，自那以来一直在积极开发。API 返回一个新的<strong class="la iu"> Styler </strong>对象，它有一些有用的方法来对数据帧应用格式和样式。最终的样式是用 CSS 完成的，通过样式函数，通过<em class="mr">属性:值</em>对应用于标量、序列或整个数据帧。</p><p id="c0dc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu"> Styler </strong>对象有两个关键方法:</p><ol class=""><li id="e98e" class="ms mt it la b lb lc le lf lh mu ll mv lp mw lt mx my mz na bi translated"><strong class="la iu"> Styler.applymap </strong> —将样式应用于元素</li><li id="5338" class="ms mt it la b lb nb le nc lh nd ll ne lp nf lt mx my mz na bi translated"><strong class="la iu"> Styler.apply </strong> —应用列/行/数据帧样式</li></ol><p id="55db" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们首先从加载数据开始。</p><p id="b133" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们将使用在我的数据透视表教程中可用的相同数据集，并且我们将使用我们在那里概述的一些步骤。如果你不熟悉熊猫的数据透视表，我们推荐<a class="ae ng" href="https://datagy.io/python-pivot-tables/" rel="noopener ugc nofollow" target="_blank">看看我的教程</a>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">导入我们的数据报。资料来源:Nik Piepenbreier</p></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="c54b" class="no lv it nk b gy np nq l nr ns">Out:<br/>  Date 	        Region 	Type 	                Units 	Sales<br/>0 2020-07-11 	East 	Children's Clothing 	18 	306<br/>1 2020-09-23 	North 	Children's Clothing 	14 	448<br/>2 2020-04-02 	South 	Women's Clothing 	17 	425<br/>3 2020-02-28 	East 	Children's Clothing 	26 	832<br/>4 2020-03-19 	West 	Women's Clothing 	3 	33</span></pre><p id="fb8d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以看到，我们有一些销售，提供了有关地区、类型、售出单位数量和总销售成本的信息。</p><p id="b950" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们创建一个数据透视表，按照我之前的教程:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="3d26" class="no lv it nk b gy np nq l nr ns">Output:<br/>                            Sales<br/>Region Type                      <br/>East   Children's Clothing  45849<br/>       Men's Clothing       51685<br/>       Women's Clothing     70229<br/>North  Children's Clothing  37306<br/>       Men's Clothing       39975<br/>       Women's Clothing     61419<br/>South  Children's Clothing  18570<br/>       Men's Clothing       18542<br/>       Women's Clothing     22203<br/>West   Children's Clothing  20182<br/>       Men's Clothing       19077<br/>       Women's Clothing     22217</span></pre><p id="cf54" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在我们已经将数据加载并存储在名为<strong class="la iu"> <em class="mr"> pivot、</em> </strong>的数据框架中，我们可以开始在 Pandas 中对数据进行样式化。</p><h1 id="6f53" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">熊猫的数据类型标签</h1><p id="2ed5" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在我们的 data frame<strong class="la iu"><em class="mr">pivot</em></strong>中，列<strong class="la iu"> Sales </strong>代表以美元表示的销售总数。然而，读者并不清楚这一点，因为没有美元符号，千位值也没有用逗号分隔。让我们来探索如何做到这一点:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="3a23" class="no lv it nk b gy np nq l nr ns">Output:<br/>                            Sales<br/>Region Type                      <br/>East   Children's Clothing  $45,849<br/>       Men's Clothing       $51,685<br/>       Women's Clothing     $70,229<br/>North  Children's Clothing  $37,306<br/>       Men's Clothing       $39,975<br/>       Women's Clothing     $61,419<br/>South  Children's Clothing  $18,570<br/>       Men's Clothing       $18,542<br/>       Women's Clothing     $22,203<br/>West   Children's Clothing  $20,182<br/>       Men's Clothing       $19,077<br/>       Women's Clothing     $22,217</span></pre><p id="63f4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以看到，数据立即更容易理解！</p><p id="e2fe" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">字符串格式可以以不同的方式应用。其他一些例子包括:</p><ul class=""><li id="670b" class="ms mt it la b lb lc le lf lh mu ll mv lp mw lt nt my mz na bi translated">带两位小数的浮点数:{:.2f}</li><li id="72e0" class="ms mt it la b lb nb le nc lh nd ll ne lp nf lt nt my mz na bi translated">用零填充数字:{:0&gt;2d}</li><li id="44a8" class="ms mt it la b lb nb le nc lh nd ll ne lp nf lt nt my mz na bi translated">带两位小数的百分比:{:.2%}</li></ul><p id="9d53" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们想为多列传递格式，定义一个可以传递给样式函数的字典可能更容易。例如，我们可以编写一本字典，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="7879" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">然后可以传递到如下所示的对象上:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="b7ca" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">添加条件格式</h1><p id="6f44" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在 Excel 中，条件格式是一个非常有用的工具。它使我们能够根据内容轻松识别价值。这对熊猫来说同样简单，但是隐藏了一点。我们将展示在 Pandas 中实现条件格式是多么容易。</p><p id="9c0c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">例如，如果我们想突出显示任何超过 50，000 美元的销售额(比如说，在这之后他们有资格获得奖金)。我们可以使用 applymap 方法做到这一点。在开始之前，我们将定义一个可以传递给 applymap 方法的函数。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="b025" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们现在可以将这个函数传递给 applymap 方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="5c66" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将返回以下数据帧:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/a259d1d2c43ca908657db55ae9546de9.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*SyIWvVf6HEo1umseOAT1fA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">突出显示超过 50，000 的值。资料来源:Nik Piepenbreier</p></figure><p id="bb53" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们还可以将数据样式与条件格式联系起来:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/eecf564ace353fc9675ecdd311231942.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*kbY2-JNAi3MRL-hju2keug.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">突出显示值和添加货币标签。资料来源:Nik Piepenbreier</p></figure><h1 id="5dff" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">让链接的方法更容易阅读</h1><p id="9127" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">链接方法在 Python 中是一个非常有用的特性，但它并不总是最容易阅读的。我们可以使用\字符将链拆分成多行，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="1565" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，假设我们想要突出显示最大值和最小值，我们可以用另一个 Styler 对象来实现。虽然我们可以使用函数和 applymap 方法来实现这一点，但是 Pandas 有内置的方法来直接突出显示最大值和最小值。在下面的例子中，我们提供了命名颜色，但是你也可以提供更具体的十六进制值。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/bbc691ae9ddad0e5fa3cd12c20f9db90.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*ceLsz_1dH_7mOCIVYRFj3Q.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">轻松突出显示最大值和最小值。资料来源:Nik Piepenbreier</p></figure><h1 id="3ed7" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">给熊猫添加色阶</h1><p id="aeca" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">有时，我们会希望标识一列中彼此相关的值。这就是色阶发挥作用的地方。我们可以使用 background_gradient 方法作为样式方法很容易地实现这一点。让我们试一试:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="b02a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将返回如下所示的数据帧:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/d9991847de557169da64d64d5984f022.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*-jbNqHypTBA3RaviwyIJqg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">添加色阶。资料来源:Nik Piepenbreier</p></figure><p id="dc80" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您也可以使用不同的 cmaps。要了解更多关于 cmaps 的信息，请查看 Matplotlib 指南。</p><h1 id="26e8" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">限制格式化的列</h1><p id="8d65" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">现在让我们生成一个包含多列值的数据透视表:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="8acc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将创建一个如下所示的数据透视表:</p><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="6855" class="no lv it nk b gy np nq l nr ns">                                sum 	count<br/>		                Sales 	Sales<br/>Region 	Type 		<br/>East 	Children's Clothing 	45849 	113<br/>        Men's   Clothing 	51685 	122<br/>        Women's Clothing 	70229 	176<br/>North 	Children's Clothing 	37306 	85<br/>        Men's   Clothing 	39975 	89<br/>        Women's Clothing 	61419 	142<br/>South 	Children's Clothing 	18570 	45<br/>        Men's   Clothing 	18542 	39<br/>        Women's Clothing 	22203 	53<br/>West 	Children's Clothing 	20182 	42<br/>        Men's   Clothing 	19077 	41<br/>        Women's Clothing 	22217 	53</span></pre><p id="79e2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在，让我们应用背景 _ 渐变方法:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="152e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将返回以下数据帧:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/ebda381408ecc999707291df384fb685.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*p_n2fxAR8PjkEFtYnKjFuA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">向多列添加色标。资料来源:Nik Piepenbreier</p></figure><p id="fc4e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们想将此限制为只有一列，我们可以使用 subset 参数，如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/b8c6bbf2da1d14ead50ece919e10418e.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*PLfXUEeYM-T24RNUYAaGHA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">仅向一列添加色标。资料来源:Nik Piepenbreier</p></figure><h1 id="f71d" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">给熊猫添加颜色条</h1><p id="6645" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">向列中值的大小添加上下文的另一种说明性方法是添加颜色条。这是一种非常简单的方式来提供视觉效果，也很容易打印出来。通过使用下面的代码，我们可以使用 Python 来实现这一点:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="8772" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这将返回以下数据帧:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/c67d3374ba7aabb1731dd5a505b5c733.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*JhMRi8F1dPfsmLjz1unebA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">给我们的数据框架添加颜色条。资料来源:Nik Piepenbreier</p></figure><p id="6fe1" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">颜色条让我们更容易看到规模。我们还可以使用<em class="mr"> align </em> =center 参数，如果值为负，则在左边显示条形，如果值为正，则在右边显示条形。</p><h1 id="71e9" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">如何在熊猫中重用样式</h1><p id="6968" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在你花了一些时间创建了一个你真正喜欢的样式后，你可能想重用它。令人欣慰的是，Pandas 使它变得简单，无需重复您精心创建的代码。你用。对另一个数据报的样式对象使用方法。例如，如果我们有两个数据帧，style1 和 style 2，我们可以通过使用以下内容重用 style1 的样式:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="bd00" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">隐藏索引或列</h1><p id="afcb" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">既然我们讨论的是为显示做好数据准备，那就让我们来谈谈 Excel 使之变得非常简单的另一部分:隐藏列。我们也可以使用 styler 对象在熊猫身上实现这一点。如果我们想隐藏索引，我们可以写:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="e973" class="no lv it nk b gy np nq l nr ns">Date 	    Region Type 	        Units 	        Sales<br/>2020-07-11  East   Children's Clothing 	18.000000 	306<br/>2020-09-23  North  Children's Clothing 	14.000000 	448<br/>2020-04-02  South  Women's Clothing 	17.000000 	425<br/>2020-02-28  East   Children's Clothing 	26.000000 	832<br/>2020-03-19  West   Women's Clothing 	3.000000 	33</span></pre><p id="c33a" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">类似地，如果我们想隐藏一列，我们可以写:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><pre class="kj kk kl km gt nj nk nl nm aw nn bi"><span id="c043" class="no lv it nk b gy np nq l nr ns">        Date 	                Region 	Type 	               Sales<br/>0 	2020-07-11 00:00:00 	East 	Children's Clothing    306<br/>1 	2020-09-23 00:00:00 	North 	Children's Clothing    448<br/>2 	2020-04-02 00:00:00 	South 	Women's Clothing       425<br/>3 	2020-02-28 00:00:00 	East 	Children's Clothing    832<br/>4 	2020-03-19 00:00:00 	West 	Women's Clothing       33</span></pre><h1 id="164d" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">将样式化的数据框架导出到 Excel</h1><p id="b30e" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">我在文章的前面提到过，风格 API 是熊猫仍然是实验性的。我们目前不能导出所有这些方法，但是目前可以导出<em class="mr">背景色</em>和<em class="mr">颜色</em>。例如，如果我们想要导出以下数据帧:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><p id="28f8" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们可以用。to_excel 方法将我们的样式化数据帧提取到 excel 工作簿:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/dc9ed0af8296d061d956da56fb36743b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IthKzyd1GpR7j_8Usfk71Q.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">如果都不行，就用 Excel 吧！资料来源:Nik Piepenbreier</p></figure><h1 id="537e" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">也许用 Excel 就好了？</h1><p id="ff91" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">最后，也许在某些情况下，将数据导入 Excel 会更有效率？在这种情况下，您可以使用 df.to_clipboard()方法将整个数据帧复制到剪贴板！</p><p id="c3de" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这没什么不对的…</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nh ni l"/></div></figure><h1 id="42e0" class="lu lv it bd lw lx ly lz ma mb mc md me jz mf ka mg kc mh kd mi kf mj kg mk ml bi translated">非常感谢你的阅读！</h1><p id="4e2f" class="pw-post-body-paragraph ky kz it la b lb mm ju ld le mn jx lg lh mo lj lk ll mp ln lo lp mq lr ls lt im bi translated">在这篇文章中，我们学习了如何使用熊猫样式 API 来设计熊猫数据帧的样式。我们学习了如何添加数据类型样式、条件格式、色标和色带。与 Excel 中的样式类似，Pandas 使对数据帧应用样式变得很容易。这使我们能够更好地表示数据，并直观地发现数据中的趋势。</p></div><div class="ab cl oc od hx oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="im in io ip iq"><p id="a6de" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="mr">原载于 2020 年 4 月 20 日</em><a class="ae ng" href="https://datagy.io/pandas-style/" rel="noopener ugc nofollow" target="_blank"><em class="mr">https://datagy . io</em></a><em class="mr">。</em></p></div></div>    
</body>
</html>