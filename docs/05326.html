<html>
<head>
<title>Towards better estimates of recovered COVID-19 cases</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对恢复的新冠肺炎病例进行更好的估计</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/towards-better-estimates-of-recovered-covid-19-cases-d6d1e35b8bda?source=collection_archive---------48-----------------------#2020-05-05">https://towardsdatascience.com/towards-better-estimates-of-recovered-covid-19-cases-d6d1e35b8bda?source=collection_archive---------48-----------------------#2020-05-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a95a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">呼吁在我们的公共话语中多一点贝叶斯思维</h2></div><p id="9315" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">TL；DR——在过去的两周里，关于新冠肺炎抗体的初步血清学检测结果已经公布了很多。最早的例子之一是斯坦福大学一份广为流传的研究草案。该研究的作者估计圣克拉拉县(加利福尼亚州)3300名受试者中的抗体可能流行率为1.5%，尽管他们也接受了将真实流行率置于1.11至1.97%范围内的不确定性(95%的置信度)。本文解释了如何考虑处理不确定性和观察数据的众所周知的统计和机器学习概念，特别是贝叶斯定理，将更现实地估计真实患病率位于0.2%至2.1%的更大范围内(95%可信)。正如其他科学家所批评的那样，如果最初就能发现如此大的误差，斯坦福大学研究的作者对不确定性的更仔细考虑可能会避免该研究最初发现的过度耸人听闻。</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/65f4265a5ace604241049f5e191f7ff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mty0v5DN5zCGkG386m2esA.png"/></div></div></figure><p id="4358" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我可以想象，在我们这个以COVID为中心的新世界中，每个人都找到了自己收集、筛选和解释数据、新闻以及关于正在发生的事情和地点的信息的方式。对我来说，我一直着迷于世界各地正在发生的数据科学和建模，以了解这种病毒的性质及其对公共卫生和经济的影响。除此之外，我一直对一种“新常态”的出现非常着迷(如果不是一点点担心的话)，这种“新常态”指的是学术界产生的关键科学研究如何影响政策。我们已经很快到达了这样一个点，几个而不是一个未经审查的流行病学模拟研究和测试结果的预印本已经成为重大新闻标题和政策决定的驱动力，对国家经济和公共卫生战略产生了重大影响。当然，这并非没有充分的理由。这场危机要求我们根据现有的最佳数据、分析和专家做出紧急、直接的决策。做出关键决定的时间窗口，如选择是否以及何时触发留在家中的订单，与大多数典型的学术期刊审查流程不一致。未来几年，我们是否在这场危机开始时观察到了正确的数据，听取了正确的声音(澄清一下，我不是其中之一)，将会引发很多争论。这篇文章更侧重于我们现在才开始关注的一组特定数据:新冠肺炎抗体的血清学检测。</p><p id="8f33" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在过去的两周里，血清学检测已经成为新冠肺炎数据收集工作的新领域。获取这些数据似乎对回答我们未来面临的重要问题至关重要:在过去几个月里，我们漏诊了多少轻度或无症状的新冠肺炎病例？我们离所谓的“群体免疫”还有多远？我们应该考虑给那些体内检测出抗体的人发放“免疫护照”吗？</p><p id="b69b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这可能部分是由于我们的兴趣(或不耐烦？)为了尽快回答这些问题，斯坦福大学的Bendavid等人在4月初发表的一项研究以其惊人的结果迅速引起了媒体和公众的注意。如果你不熟悉它，你可以<a class="ae ln" href="https://www.medrxiv.org/content/10.1101/2020.04.14.20062463v1?versioned=true" rel="noopener ugc nofollow" target="_blank">阅读最初的研究</a>，或者可能阅读<a class="ae ln" href="https://www.sciencemag.org/news/2020/04/antibody-surveys-suggesting-vast-undercount-coronavirus-infections-may-be-unreliable" rel="noopener ugc nofollow" target="_blank">一些立即涉及它的文章</a>。该研究的作者对加利福尼亚州圣克拉拉县的3300名成人样本进行了血清学测试。他们发现3300名受试者中有50人新冠肺炎抗体检测呈阳性。当这一结果被外推以反映圣克拉拉县的全部人口时，作者估计，在过去几个月中感染新冠肺炎的真实人数可能比迄今为止诊断的人数高“50至80倍”。</p><p id="04a1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尽管斯坦福大学研究的披露令人震惊，更不用说头条新闻了，但没过多久，一群科学家就(理所当然地)对斯坦福大学论文的作者如何解释他们的结果并得出结论进行了抨击。对这项研究<a class="ae ln" href="https://statmodeling.stat.columbia.edu/2020/04/19/fatal-flaws-in-stanford-study-of-coronavirus-prevalence/" rel="noopener ugc nofollow" target="_blank">最值得注意的批评来自哥伦比亚大学的Andrew Gelman </a>教授，这位统计学家非常忠实地撰写了关于现代统计数据分析方法的教科书。<em class="lo">(原谅我，常客们，把“贝叶斯”等同于“现代”。请不要让这个毁了你的一天。)</em>。</p><p id="dc5e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这篇文章表明，如果在斯坦福大学的研究中透明地进行，关注处理不确定性的贝叶斯方法将如何揭示一个更广泛的，最终不那么耸人听闻的关于圣克拉拉县新冠肺炎抗体流行的结论。明确地说，这篇文章的目标读者不是统计学家或流行病学家，我怀疑他们在大学里学过这些方法。相反，本文是为对不确定性分析和贝叶斯定理感兴趣，但又迫切需要真实用例的应用科学家、科学记者或精通数学的读者而写的。本文采用的方法摘自学术参考文献[2–4]。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="11e1" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">第一部分:用于描述诊断测试准确性的变量</h1><p id="5c0a" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">当我们对普通人群进行血清学检测时，我们可能会直觉地认为产生阳性结果的检测百分比可能等于(或足够接近)受检人群中抗体的<em class="lo">流行率</em>。毕竟，如果我们的测试不是高度准确的，我们为什么要继续花钱测试我们的人口呢？</p><p id="b90c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是斯坦福大学研究中提出的一个问题的关键。事实证明，该研究中应用的测试误差——虽然看起来很小——却大到足以对该研究的总体建议的可信度产生怀疑，即圣克拉拉县的实际新冠肺炎感染人数实际上比官方检测的数字高出“50-80倍”。</p><p id="cefb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了说明原因，我们首先引入两个关键变量，这两个变量告知任何疾病的诊断测试，或者被任何疾病的诊断测试告知:该疾病在抽样人群中的患病率，以及首先检测为该疾病阳性的概率。</p><p id="cda1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，让我们想象一下，我们有100个人，我们绝对肯定地知道其中36人有新冠肺炎抗体。在这种情况下，我们可以计算出患病率为36/100 = 0.36 = 36%。我们也可以用概率来重写这个变量，<em class="lo"> p </em>，因为我们可以假设在这100个人口中，任何随机选择的个体都有36/100的机会拥有新冠肺炎抗体。所以，如果我们代表一个拥有<em class="lo"> V+ </em>抗体的个体，那么我们可以把患病率称为<em class="lo"> p(V+) </em> = 36/100 = 0.36。</p><p id="705e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们要介绍的第二个变量是抗体检测阳性的概率，<em class="lo"> p(T+) </em>。如果在上述100个个体的群体中，发现30个使用特定的测试试剂盒实际测试抗体呈阳性，那么我们可以进行初步估计，即<em class="lo"> p(T+) </em> = 30/100 = 0.30。</p><p id="1c43" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个特定的场景中，我们已经可以看到这里有一个错误。检测呈阳性的概率低于实际拥有新冠肺炎病毒抗体的概率。具体来说，看起来这个测试很容易产生假阴性。然而，我们必须考虑到这可能不是测试的唯一错误(因此我们估计<em class="lo"> p(T+) </em>的方法也可能不太正确)。让我们看看下面这个由11个人组成的随机测试样本的例子:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/1b1f7c00eae3d5ca6db7887ff6d66b3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*rWobJ2s4vqm0sTKWRjflcQ.png"/></div></figure><p id="80d3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在总共11个样本中，有8个实际阳性病例，只有7个样本检测为阳性。在这7个阳性测试中，2个是假阴性的结果，因此只有5个阳性与实际阳性病例相匹配。另外两个实际案例导致假阴性测试。因此，在逐个样本的基础上，诊断测试可以正确地识别阳性病例，可以正确地识别阴性病例，或者它可能错误地对已知的阳性病例产生阴性结果，或者它可能错误地对已知的阴性病例产生阳性结果。在任何类型的诊断测试中，后两种错误的程度可以分别通过测试的<strong class="kh ir">灵敏度</strong> <em class="lo"> </em>和<em class="lo"> </em> <strong class="kh ir">特异性</strong>来确定。</p><p id="22b1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">灵敏度</strong> <em class="lo"> </em>确定了诊断测试在检测病例时的准确性，这些病例将通过所谓的“金标准”进行识别，即100%准确的参考诊断。在上表中，我们看到八分之五的真阳性病例也检测为阳性。如果这是我们得到的确定测试灵敏度的唯一数据，我们估计为5/8 = 0.625 = 62.5%。</p><p id="b109" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">特异性</strong>确定诊断测试在检测已知阴性病例时的准确性。对于新冠肺炎血清学检测，这将意味着成功地识别出那些(尚未)在其系统中具有相关量抗体的个体。在上表中，每三个实际阴性病例中只有一个测试结果也是阴性。因此，特异性估计为1/3=0.333=33.3%。这是一个非常可怕的测试！)</p><p id="6672" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的数学公式中，我们将<strong class="kh ir">敏感性</strong>和<strong class="kh ir">特异性</strong>表示为两个术语，分别为<em class="lo"> p </em> (𝑇+|𝑉+)和<em class="lo"> p </em> (𝑇−|𝑉−)。<br/>敏感度，<em class="lo"> p </em> (𝑇+|𝑉+)，被认为是对已知阳性病例𝑉+的任意测试将产生阳性测试结果𝑇+.的概率同样地，<br/>特异性，<em class="lo"> p </em> (𝑇−|𝑉−)，是对一个已知未感染病例——𝑉−——的任意测试将产生一个阴性结果——𝑇−.的概率<em class="lo">(对于那些以前没有见过这种类型的符号的读者来说，当你看到“</em> | <em class="lo">”符号时，想到“given”这个词会有所帮助)。</em></p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="b163" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">第二部分:根据已知的特异性和敏感性估计患病率</h1><p id="bc6d" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">在这一点上，我们知道，如果抗体检测不是100%准确，检测人群中新冠肺炎抗体的<em class="lo">流行率</em>很可能与抗体检测呈阳性的病例数不同。这里有一个错误，这个错误(至少)归因于测试的<em class="lo">灵敏度</em>和<em class="lo">特异性</em>。那么我们如何在这些不同的参数和疾病流行率之间建立清晰的数学联系呢，𝑉+？</p><p id="24a8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">“全概率法则”的“美”就在于此。我试图用几句话来解释这一点，可能对这篇文章(或统计科学)不公平，但还是来了。如果我们对一个随机的人群进行抽样，以确定任何样本检测出𝑇+新冠肺炎病毒阳性的概率，我们知道每个检测出阳性的人只能有两种身体状况:他们要么拥有𝑉+病毒的抗体，要么没有𝑉−.病毒的抗体全概率法则允许我们以这两种表现的组成概率之和的形式来估计p(𝑇+)，例如:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/7095cb6e99cd45ecfb53abfb7d74d5b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/0*nEcAY0QjKZQ7pOzc.png"/></div></figure><p id="51cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用“全概率”规则非常有用，因为我们现在开始看到我们引入的一些变量之间建立的数学关系，如敏感度，<em class="lo"> p </em> (𝑇+|𝑉+)和患病率，<em class="lo"> p </em> (𝑉+).为了让数学看起来简单一点，从现在开始，我们将对𝑆𝑒使用敏感性术语<em class="lo"> p </em> (𝑇+|𝑉+)，对𝑃𝑣.使用流行性术语<em class="lo"> p </em> (𝑉+)我们现在有:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/07cf7e6c3e70ac626729d7b8509fe82b.png" data-original-src="https://miro.medium.com/v2/resize:fit:674/format:webp/0*rerFckI91KavqFOo.png"/></div></figure><p id="2de3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以进一步清理。不拥有抗体的概率𝑝(𝑉−)一定与拥有抗体的概率𝑃𝑣.有关如果10个人中有9个人有抗体，𝑃𝑣=9/10=0.9，那么通过推论，10个人中只有1个人一定没有抗体，𝑝(𝑉−)=1/10=0.1.因此我们可以假设𝑝(𝑉−)=1−𝑃𝑣.误报的概率，𝑝(𝑇+|𝑉−)，可以遵循类似的规则，如<br/> 𝑝(𝑇+|𝑉−)=1−𝑝(𝑇−|𝑉−).我们已经引入了最后一项作为特异性，如果我们现在把这一项和𝑆𝑝联系起来，我们可以把这个关系写成𝑝(𝑇+|𝑉−)=1−𝑆𝑝.</p><p id="e65c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们现在能够将𝑝(𝑇+方程提炼为仅测试的灵敏度、特异性和患病率的函数:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/91761c01a6364709115ededc01e7c5ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/0*L2XnLOaqVix94DKW.png"/></div></figure><p id="4897" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们的目的是对患病率进行估计，我们也可以重新排列等式:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/b6ec8d973711928e5057569c37f5f829.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/0*TgIb1gHmDdCYzPsO.png"/></div></figure><p id="2943" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们似乎可以仅仅从这个等式中梳理出斯坦福/圣克拉拉研究的验证。在下面的要点中，给定斯坦福研究中陈述的<em class="lo"> Sp </em>和<em class="lo"> Se </em>的确定性值，并假设<em class="lo"> p </em> (𝑇+) = 50/3330，我对抗体<em class="lo"> Pv </em>的患病率进行点估计。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="5e3f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我已经从本文的内容中排除了上面的例子，因为它离题太远，最终不适用于我们正在评估的现实世界的问题。当且仅当我们绝对确定地知道<em class="lo"> Se </em>和<em class="lo"> Sp </em>时，我们才能接受使用上述等式的<em class="lo"> Pv </em>的点估计。不幸的是，我们不能，正如斯坦福研究的作者也不能。甚至诊断测试的报告错误也可能有错误。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h1 id="39a3" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">第三部分:当血清学试验的敏感性和特异性不确定时，估计患病率</h1><p id="5c29" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">为什么我们不能100%确定诊断试验的特异性和敏感性的真实值，这可能有几个原因。例如，尽管我们尽了最大努力，我们可能永远无法将测试的诊断性能与本身100%准确的“黄金标准”测试进行比较。在Andrew Gelman对斯坦福研究的评论中，他讨论了该研究的作者在估计他们测试的特异性和敏感性的误差时所采用的令人困惑的方法。</p><p id="2d9f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尽管如此，我们仍然可以证明斯坦福研究结论所面临的核心问题，即使我们从表面价值上考虑该研究自己对敏感性和特异性不确定性的估计。虽然作者对<em class="lo"> Se </em>的总体估计为80.3%，但他们认为<em class="lo"> Se </em>的真实值可能在72.1%至87%的更大范围内(95%的置信度)。作者同样估计他们的测试的真实的<em class="lo"> Sp </em>在98.3到99.9%的范围内(95%的置信度)。</p><p id="e726" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尝试以概率分布的形式来描述这些误差是有帮助的，这给了我们一种𝑆𝑒=0.721与𝑆𝑒=0.803.相比的可能性有多大的感觉文献[2，3]中通常使用贝塔分布来表示𝑆𝑒和𝑆𝑝的估计误差，因此我将通过数值拟合分布来估计𝑆𝑒和𝑆𝑝贝塔分布的关键参数，使得每个分布的95 %置信区间等于斯坦福研究中提供的𝑆𝑒和𝑆𝑝的95 %置信区间的界限。</p><pre class="lc ld le lf gt na nb nc nd aw ne bi"><span id="3c75" class="nf lx iq nb b gy ng nh l ni nj">from scipy import stats<br/>from scipy.optimize import differential_evolution<br/>from scipy.stats import beta<br/>import numpy as np</span><span id="1574" class="nf lx iq nb b gy nk nh l ni nj"># This code is a lazy solver, from a human’s perspective. <br/># It uses a a fairly raw evolutionary algorithm to search for <br/># the values of Beta distribution parameters ‘alpha’ and ‘beta’ <br/># that characterise the assumed prior distributions for<br/># sensitivity (Se) and specificity (Sp). Could this be done <br/># analytically? Of course it could, but I’m lazy.</span><span id="10ce" class="nf lx iq nb b gy nk nh l ni nj">alpha = 0.05    # This tells the solver that we’re <br/>                # providing it with input values<br/>                # that correspond with the 95% CI of estimates, <br/>                # where alpha = 1 — CI.</span><span id="b90a" class="nf lx iq nb b gy nk nh l ni nj"># Confidence intervals of estimated uncertainty in <br/># sensitivity and specificity as reported from <br/># Stanford / Santa Clara Study (April 17, 2020 pre-print)</span><span id="ba32" class="nf lx iq nb b gy nk nh l ni nj">Se_lower_95 = 0.721<br/>Se_upper_95 = 0.87<br/>Sp_lower_95 = 0.983<br/>Sp_upper_95 = 0.999</span><span id="e52c" class="nf lx iq nb b gy nk nh l ni nj"># Establish and run the solver for Beta probability distributions that fit to prior estimates of Se and Sp</span><span id="c3d2" class="nf lx iq nb b gy nk nh l ni nj">def results_Se(x):<br/>   lower_est,upper_est = beta.ppf(alpha / 2, a=x[0], b=x[1]),<br/>                         beta.ppf(1 — alpha / 2, a=x[0], b=x[1])</span><span id="9939" class="nf lx iq nb b gy nk nh l ni nj">   return ((Se_lower_95-lower_est)**2 + <br/>           (Se_upper_95-upper_est)**2)**0.5</span><span id="e81f" class="nf lx iq nb b gy nk nh l ni nj">def results_Sp(x):<br/>   lower_est,upper_est = beta.ppf(alpha / 2, a=x[0], b=x[1]),<br/>                         beta.ppf(1 — alpha / 2, a=x[0], b=x[1])</span><span id="8a53" class="nf lx iq nb b gy nk nh l ni nj">   return ((Sp_lower_95-lower_est)**2 + <br/>           (Sp_upper_95-upper_est)**2)**0.5</span><span id="a5e2" class="nf lx iq nb b gy nk nh l ni nj">res_Se = differential_evolution(results_Se,<br/>                                tol = 0.0000001, <br/>                                bounds=((0.00001,3000),<br/>                                        (0.00001,3000)))</span><span id="bf36" class="nf lx iq nb b gy nk nh l ni nj">res_Sp = differential_evolution(results_Sp,<br/>                                tol=0.0000001,<br/>                                bounds=((0.00001,3000)<br/>                                        (0.00001,3000)))</span><span id="a70c" class="nf lx iq nb b gy nk nh l ni nj"># Extract estimates for alpha and betas of <br/># Beta distributions for Se and Sp</span><span id="eba0" class="nf lx iq nb b gy nk nh l ni nj">alphas = [res_Se.x[0],res_Sp.x[0]]<br/>betas = [res_Se.x[1],res_Sp.x[1]]</span></pre><p id="8214" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">定义了Beta分布的关键参数后，我们可以绘制这些分布，并将其与源数据进行比较。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/918d68544aaeec84f1931a98ab2ba41e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*xEbQBaiKiS0NHIFGIOnIDA.png"/></div></figure><p id="bc8c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">成功。我们的贝塔分布的特征(众数和置信区间)与研究数据非常匹配。我们现在还应该考虑如何描述我们对𝑃𝑣.的初始估计的概率分布的特征虽然本文的目的是对𝑃𝑣进行修正估计，但在后面的方法中，我们也要对这个参数进行初始估计，这一点很重要。</p><p id="e199" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在想，一个保守的，尽管普遍不了解情况的估计是，𝑃𝑣可能在0%到3%的范围内。然而，因为我对𝑃𝑣更有可能是0%还是1.5%还是2%还是3%没有什么初步概念，所以我将假设𝑃𝑣是这些数字中的任何一个的可能性相等，或者介于两者之间。这需要均匀的概率分布:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/2533a3f11b6b6f221d65f7dd3f580319.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*Y3miRR04AVPQSGWJiiwltA.png"/></div></figure><p id="807a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，要以一种既能让不熟悉贝叶斯统计的人满意，又能让熟悉贝叶斯统计的人满意的方式来解释剩余的过程变得越来越困难了。提前道歉。让我们再来看看我们的临界方程:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/29f467d8e2f5dfe4dab88bfcb089bfc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/0*vA7UtB9kgDS90hl_.png"/></div></figure><p id="2af9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">利用这个等式，我们可以从对𝑆𝑒、𝑆𝑝和𝑝(𝑇+的预测中推断出对𝑃𝑣的预测，但在所有这些中，哪里有空间根据我们从真实世界测试中获得的对𝑇+的实际观察来校准、调整或修正我们的预测呢？最后，这里进入贝叶斯定理，它为我们提供了一种将模型预测的估计概率与现场观察到真实事件的概率联系起来的方法。贝叶斯定理认为:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/35399222e578337ba27f55f17d8d790f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/0*QGvQNp3pQ3QEX0Bj.png"/></div></figure><p id="8ab4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们让阳性检验率的预测值𝑝(𝑇+ =𝑃𝑡，𝑛和𝑘分别代表样本总体的大小和返回阳性检验的数量，那么我们可以将贝叶斯定理应用于我们的问题，如下所示:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/ee7147305d4eab7cf99a814a7b67c2f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/0*ZyuKDfQUSfO61I6y.png"/></div></figure><p id="e0ed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">到目前为止，我们已经介绍了解决上述方程所需的所有项，除了可能性，𝑇+|𝑃𝑡).的𝑝(observations惯例是对这种类型的情况使用二项分布。二项式分布表示在给定模型的情况下，从𝑛样本中观察到𝑘病例的概率，在我们的情况下，该分布变为:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi no"><img src="../Images/2473635c8c3d4e5b67c3d4e38967e4e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/0*73gDS0pVMzJX76nJ.png"/></div></figure><p id="c4f9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我知道这个理论已经让人精疲力尽了，但我知道我无法在一篇短文中做出恰当的解释。好消息是我们已经走到了尽头。我们现在有了一个全面的、可解决的模型，可以通过以下步骤来执行:</p><ol class=""><li id="67cb" class="np nq iq kh b ki kj kl km ko nr ks ns kw nt la nu nv nw nx bi translated">我们可以从𝑆𝑝.𝑆𝑒的初始(先验)概率分布中随机抽取值和𝑃𝑣，并得出对𝑃𝑡的估计</li><li id="0715" class="np nq iq kh b ki ny kl nz ko oa ks ob kw oc la nu nv nw nx bi translated">我们可以将我们对𝑃𝑡的估计与观察到的记录(即𝑛=3300).的𝑘=50病例检测呈阳性)进行比较这使我们能够评估我们对𝑆𝑒、𝑆𝑝和𝑃𝑣的估计是否会产生对𝑃𝑡的估计，而这种估计是否有数据支持。</li><li id="335a" class="np nq iq kh b ki ny kl nz ko oa ks ob kw oc la nu nv nw nx bi translated">我们可以重复步骤(1)和(2)很多次(成千上万次),以确定𝑆𝑒、𝑆𝑝和𝑃𝑣的哪个值更有可能出现(假设𝑝(observing 𝑘在𝑛测试了|𝑃𝑡)</li><li id="977e" class="np nq iq kh b ki ny kl nz ko oa ks ob kw oc la nu nv nw nx bi translated">我们可以整理在步骤3中发现的所有新的估计值<em class="lo"> Se </em>、<em class="lo"> Sp </em>和<em class="lo"> Pv </em>，并规定这些参数的一组更新的(也称为后验)概率分布</li></ol><p id="0140" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从第1步到第4步的整个过程被称为贝叶斯推理，但是解释我们如何通过计算实现这些步骤需要更多的信息和知识，这是我所能提供的(或花费的时间)。我将开门见山地说<a class="ae ln" href="https://docs.pymc.io/" rel="noopener ugc nofollow" target="_blank"> PyMC3 </a>是一个伟大的Python库，用于解决利用蒙特卡罗马尔可夫链(MCMC)方法的概率数学问题，例如贝叶斯推理。</p><p id="d8ba" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在下面的代码中，我们使用PyMC3来推断𝑆𝑒、𝑆𝑣和𝑃𝑣的更新(后验)估计值，这是基于我们对一项单一诊断测试的了解，其中3300名个体中有50名检测出新冠肺炎抗体阳性。求解器的结果，在PyMC3中称为“踪迹”,是一组对𝑆𝑒、𝑆𝑝和𝑃𝑣.的可能真值的修订估计</p><pre class="lc ld le lf gt na nb nc nd aw ne bi"><span id="ce50" class="nf lx iq nb b gy ng nh l ni nj">import pymc3 as pm</span><span id="7fe9" class="nf lx iq nb b gy nk nh l ni nj">k = 50 # Number of individuals that were observed to test positive<br/>n = 3300 # Size of population tested</span><span id="8fae" class="nf lx iq nb b gy nk nh l ni nj">p_true = k/n</span><span id="74c3" class="nf lx iq nb b gy nk nh l ni nj">model = pm.Model()<br/>with model:</span><span id="7611" class="nf lx iq nb b gy nk nh l ni nj">   Se = pm.Beta(‘Se’,alpha=alphas[0],beta=betas[0])<br/>   Sp = pm.Beta(‘Sp’,alpha=alphas[1],beta=betas[1])<br/>   Pv = pm.Uniform(‘Prevalence’,lower=0,upper=0.03)</span><span id="aedc" class="nf lx iq nb b gy nk nh l ni nj">   Pt = ((Se*Pv+(1-Sp)*(1-Pv)))<br/>   y_obs = pm.Binomial( ‘y_obs’, p=Pt, n=n, observed=k)</span><span id="3560" class="nf lx iq nb b gy nk nh l ni nj">   trace = pm.sample(12000, chains=2, tune=2000, target_accept=0.95)</span></pre><p id="4d26" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">贝叶斯推理过程的结果返回了我们对𝑆𝑒、𝑆𝑝和𝑃𝑣在概率分布方面的先验和后验估计的比较。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi od"><img src="../Images/328c0d2155b1b8bd2526b033ea456671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*enVH4Iq4EBhsTVyF7___tQ.png"/></div></div></figure><p id="5507" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些结果带来了这个相对简单过程的重大发现。因为我们只评估一种测试和一种诊断，所以很少有信息表明该测试的敏感性和特异性与该研究作者最初定义的有任何不同。然而，我们确实看到𝑃𝑣的后验分布已经围绕一系列新的值联合起来。我们的后验估计显示，不仅与我们的初始估计值<em class="lo"> Pv </em>(例如，0至0.03%，100% CI)相比，而且与斯坦福研究的估计值(例如，1.11至1.97%，95% CI)相比，患病率有相当显著的修正。最后的评估是，基于一项单一的真实世界测试的结果，该测试从3300个观察到的阳性中返回了50个，真实的流行率必须在至少0.2%和2.1%的范围内(95%可信区间)。为了与原始研究进行比较，我们可以再生成一个图:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/4c2520a9189dde5100c99a00c7922b0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*_hC3Dz36jPqQnfC9fkICIQ.png"/></div></figure><h1 id="e275" class="lw lx iq bd ly lz of mb mc md og mf mg jw oh jx mi jz oi ka mk kc oj kd mm mn bi translated">结论</h1><p id="fc5b" class="pw-post-body-paragraph kf kg iq kh b ki mo jr kk kl mp ju kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">这就是了。使用适当的统计推断，特别是在贝叶斯规则和机器学习技术的帮助下解决贝叶斯推断的问题，我们通过适当考虑所用血清学检测试剂盒的规定误差和误差的误差，对斯坦福/圣克拉拉研究中采样的3，300名受试者的抗体流行率进行了新的估计。虽然最有可能的患病率是1.3%，但我们发现该值位于0.2%和2.1%之间的任何地方的概率肯定是95%。这似乎使任何声称新冠肺炎抗体在圣克拉拉县人口中的患病率比预期高“50-80倍”的说法有点可疑…至少在没有更多数据的情况下不会。</p><p id="73f8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Andrew Gelman和其他人一样，已经解决了斯坦福研究中的这个关键问题，而不需要像我在这篇文章中所做的那样深入研究建模的细节。根据这位专家和其他专家的解释，如果某项检测的特异性很低，假阳性的检出率等于或高于阳性检测结果的观察率，那么几乎所有的阳性检测都有可能是假阳性，而不是对抗体携带者的真实鉴定。对于我们预计新冠肺炎抗体流行率仍然较低的地区(显然包括我的家乡不列颠哥伦比亚省温哥华)，我们最终需要特异性非常高的血清学检测，以区分真阳性和假阳性。</p><p id="a370" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在写这篇文章的过程中，斯坦福研究的作者们在4月30日发布了他们工作的修订版，很大程度上解决了他们第一次提交的一些问题。他们现在包括:1)将贝叶斯推断应用于他们对<em class="lo"> Pv、</em>和<em class="lo"> </em>的估计，锐化<em class="lo"> </em>他们基于额外的参考测试数据对灵敏度和特异性的估计。在他们提交修改后的一天后，<a class="ae ln" href="https://statmodeling.stat.columbia.edu/2020/05/01/simple-bayesian-analysis-inference-of-coronavirus-infection-rate-from-the-stanford-study-in-santa-clara-county/" rel="noopener ugc nofollow" target="_blank"> Andrew Gelman贡献了一份对这份修改过的作品的贝叶斯分析</a>，使用了一种比我在这篇文章中更彻底的方法。尽管他发现斯坦福团队对不确定性的新评估有待改进，但他展示了使用贝叶斯定理的不确定性分析可以(或应该)应用于他们工作的更充分程度。我的最后一个例子是不同分析的总结:1)斯坦福研究的第一个版本的结果(2020年4月17日预印)，2)我在本文中概述的患病率估计，3)修订的斯坦福研究的结果(2020年4月30日重新提交)，4)我根据这些修订的结果对患病率的估计，以及5) Andrew Gelman最近根据这些修订的数据对患病率的估计。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/bfc2dc0235becab564b36d1db041f509.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aAQ-rdnqxGYHxnnuiyfKFA.png"/></div></div></figure><p id="2020" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，当我们试图衡量新冠肺炎危机的程度(以及我们为摆脱危机所做的决定)时，适当的不确定性量化方法，也许是贝叶斯方法，应该是最重要的吗？我不得不相信，它们就在我们医疗保健和疾病控制当局模糊的走廊里，但偶尔大声喊出来提醒一下也无妨——尤其是对我们试图理解事物的一线科学记者来说。</p><p id="84b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我将通过回答常见问题中几个问题来结束本文:</p><blockquote class="ok ol om"><p id="5ca8" class="kf kg lo kh b ki kj jr kk kl km ju kn on kp kq kr oo kt ku kv op kx ky kz la ij bi translated">在一篇中等水平的文章中解决这些问题是不是有点矫枉过正？</p></blockquote><p id="1c8b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是的，很可能。</p><blockquote class="ok ol om"><p id="ed0b" class="kf kg lo kh b ki kj jr kk kl km ju kn on kp kq kr oo kt ku kv op kx ky kz la ij bi translated">做这个很难吗？</p></blockquote><p id="7b57" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不，我的意思不是吹捧我自己对这方面的知识。</p><blockquote class="ok ol om"><p id="0ebb" class="kf kg lo kh b ki kj jr kk kl km ju kn on kp kq kr oo kt ku kv op kx ky kz la ij bi translated">我是否使用了最先进的程序来使用贝叶斯定理评估诊断测试的不确定性？</p></blockquote><p id="fabb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个我没法完整回答。我的方法是合理的，但有更彻底的方法来考虑诊断测试中的不确定性(因此，为什么Gelman的方法-更彻底-显示了基于2020年4月30日重新提交的估计值的更大不确定性)。我的结果在多大程度上是可靠的，取决于我们对可用数据的掌握程度以及对诊断测试错误的理解程度。<a class="ae ln" href="https://www.sciencedirect.com/science/article/pii/S0167587705000334" rel="noopener ugc nofollow" target="_blank">布兰斯克姆等人</a>【2】和<a class="ae ln" href="https://www.sciencedirect.com/science/article/pii/S0167587700001173" rel="noopener ugc nofollow" target="_blank">恩诺埃等人</a>【3】的作品，我觉得还是相关的入门。</p><blockquote class="ok ol om"><p id="dbed" class="kf kg lo kh b ki kj jr kk kl km ju kn on kp kq kr oo kt ku kv op kx ky kz la ij bi translated">我看了你的简历。一个建筑与风景园林学院的教授写这样的文章干什么？</p></blockquote><p id="0f91" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是的，完全公开，我的职业是建筑工程师——不是流行病学家、统计学家或数学家。然而，像许多应用科学领域的学者一样，我职业生涯中越来越多的部分都专注于使用数据和机器学习的新方法来解决现实世界的设计和决策问题。在我的直接工作领域，这通常是关于我们如何设计和运行健康、舒适、理想的碳中和的建筑。我的博士生导师是，我称之为，贝叶斯主义者；首批建筑科学家之一，在预测建筑能源需求或建筑占用趋势时，使用贝叶斯定理和“新颖”统计技术来评估不确定性。虽然我只能试着追随她的脚步，但当我想到，在开始攻读博士学位的十年后，我现在在自己的研究小组中对贝叶斯定理保持着浓厚的兴趣，这让我感到振奋。</p><p id="1082" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">参考文献</strong></p><p id="275f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[1] Gelman，a .，Carlin，J. B .，Stern，H. S .，Dunson，D. B .，Vehtari，a .，和Rubin，D. B. (2013年)。贝叶斯数据分析。CRC出版社。</p><p id="7a8a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[2]刘易斯，F. I .，&amp;托格森，P. R. (2012年)。在缺乏金标准诊断的情况下估计人类和动物疾病流行的指南。流行病学的新兴主题，9(1)，9。</p><p id="9992" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[3] Branscum，A. J .，Gardner，I. A .，&amp; Johnson，W. O. (2005年)。通过贝叶斯建模评估诊断试验的敏感性和特异性。预防兽医学，68(2–4)，145–163。</p><p id="c033" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[4]恩诺埃，c .，乔吉亚迪斯，M. P .，&amp;约翰逊，W. O. (2000年)。当真正的疾病状态未知时，对诊断试验和疾病流行的敏感性和特异性的估计。<em class="lo">预防兽医学</em>，<em class="lo">45</em>(1–2)，61–81。</p></div></div>    
</body>
</html>