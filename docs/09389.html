<html>
<head>
<title>You’re Plotting the Wrong Things</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你在策划错误的事情</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/youre-plotting-the-wrong-things-3914402a3653?source=collection_archive---------14-----------------------#2020-07-05">https://towardsdatascience.com/youre-plotting-the-wrong-things-3914402a3653?source=collection_archive---------14-----------------------#2020-07-05</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e581" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">更聪明的 EDA 的技巧</h2></div><p id="f96f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">快，告诉我，X1 能很好地预测 Y 吗？</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/b5a953a053578d5afb05dcef6c4919dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*Nfxbe876zWLueRZcscnA9A.jpeg"/></div></figure><p id="37c7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正确答案是“不知道。看情况。”如果你很肯定地回答了是/否，那么我很抱歉地说，你对统计学有一个致命的误解。X1 和 Y 之间的相关性没有告诉我们任何关于预测能力的信息。</p><p id="a421" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">除了检测数据质量问题之外，绘制变量之间的关系图没有什么价值。如果有什么不同的话，它会导致人们得出不必要的错误结论。然而，这是探索性数据分析中的一个常见步骤(为什么？？？).</p><p id="f65b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文将解释为什么应该跳过这一步，以及您可以做些什么。</p><h1 id="364e" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">因果机制</h1><p id="bfe6" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">" X1 是预测 Y 的好方法吗？"含蓄地问“如果我们加上 X1，模型会试图适应随机噪声吗？”答案是否会随着其他变量的变化而变化还不太明显。Pairs plots 天真地看待两个变量，好像其他变量都不存在。</p><p id="3dc8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">事实证明，答案取决于(通常未知的)数据生成过程，可以使用因果图来表示。下面是一个有三列的数据集的一些可能的因果图，其中 X → Y 表示“X 引起 Y”:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/4656059cf962b7732121412c7b2e3c27.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*mjI1BJKJXsuinNnVyoVKGQ.png"/></div></figure><p id="a99d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">u 是未观察到的变量。还有许多其他可能的图表，但我们将用这四个作为例子。如果你想更多地了解这些图表是如何工作的，请跳到<a class="ae ml" rel="noopener" target="_blank" href="/beyond-a-b-testing-primer-on-causal-inference-d8e462d90a0b">我上一篇关于因果关系的文章</a>的后三分之一。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/da7e4a9bd0e5ae05131a84fc2156031e.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*VwODzpAGTfQgBzz_lfTTQg.png"/></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">X1 作为<strong class="bd mq">的预测器<em class="mr">只有在 X2 不在的时候</em> </strong>才有用</p></figure><p id="7ef8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面的两个因果图表明，当我们有 X2 时，X1 作为预测因子是没有用的。从 X1 到 Y 的唯一路径只有通过 X2；一旦我们知道了 X2，X1 就变成了纯噪声。然而，如果我们没有 X2，那么 X1 是一个很好的预测！</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/d094f255e2a127f81229da4a89e6788c.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*jMVI9NgIBI6pOQEXUbi9nA.png"/></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">X1 作为预测值总是有用的</p></figure><p id="1c64" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面这两个因果图表明，不管 X2 如何，X1 总是一个有用的预测因子，因为从 X1 到 Y 的信息流不经过 X2。</p><p id="6ef1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在所有这些图的<strong class="kk iu">中，X1 与 Y 相关！这种相关性没有告诉我们 X1 作为预测因子的有用性。</strong></p><p id="c94f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">多重共线性检查从因果角度看也很愚蠢；最后一张图使 X1 和 X2 相关，但两者都是有用的预测指标！</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/2e303a5c136da8140bf361ad8965ee44.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*Z15CRULNSAkwgXQiziaUag.png"/></div><p class="mm mn gj gh gi mo mp bd b be z dk translated">没有 X2，X1 是一个很好的预测因子，尽管没有因果关系</p></figure><p id="1d86" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，请记住预测和因果推断是不同的任务。看这张图表。如果我们的目标是预测，那么在没有 X2 的情况下，X1 应该用来预测 Y。如果我们的目标是因果推理，那么 X1 应该<strong class="kk iu">而不是</strong>在没有 X2 的情况下使用。本文主要关注预测模型。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/b35462fe81aac4ed6c3c832eb5e49b37.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*Xm3WmTlrFeYV3wWbjjofMA.png"/></div></figure><p id="c2ef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我使用上面的图表生成了数据。看看如果我回归 Y~X1 会发生什么:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/9a742c96021917595e2ceb5a85978225.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*4W88RiRoOW4tMio8R209Tg.png"/></div></figure><p id="136e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这表明 X1 是一个很好的预测因子。但是请记住，数据生成过程表明，当我们有 X2 时，X1 是无用的。在控制 X2 之后，查看 X1 中包含多少信息:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/82e18cafb6591d7fd3be7e77db76580d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*u9NbmxOAcfJTBBElUEKdow.jpeg"/></div></figure><p id="e9a5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们通过回归 Y~X2 并绘制相对于 X1 的残差来得到这个图，通常称为“增加变量图”或“部分回归图”。几乎没有留下任何信息。X1 变成纯噪声。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/b04dcdd9f3f81a64bcfd099f27265bf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*VM6U_zU0V5TpT-ABL5lYew.png"/></div></figure><p id="14f2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然而，这并不<strong class="kk iu">而不是</strong>意味着 X1 对 y 没有影响。X1 确实有因果关系，但它完全由 X2 介导。</p><p id="6f68" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">回归输出取决于很多因素。有可能 X1 最终成为重要的一个，或者两者都是。在这种情况下，如果我们观察 X2 的部分回归图(在控制 X1 之后):</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/c7ba4276db3e9e1a962747bec1f6acd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*bmNIEWRK_fUNSA3WEVYbEA.jpeg"/></div></figure><p id="285f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们应该看到信息的痕迹，表明 X2 属于这个模型。</p><p id="072b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">除了最简单的问题，我们很少知道“真正的”因果图。与其猜测哪些变量应该或不应该出现在回归模型中，不如保留所有的预测值，并把它们扔进<a class="ae ml" href="https://en.wikipedia.org/wiki/Lasso_(statistics)" rel="noopener ugc nofollow" target="_blank">套索</a>的嘴里？我们有通过正则化自动选择变量的算法。在本例中，LASSO 将系数 0 指定给 X1:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/80bc01ccd8c53c135dbb04a5fdf523a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*Llw9svA7r0mSibsocrIBjg.png"/></div></figure><p id="ece2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">介绍性回归课程讲授使用 AIC/BIC/F/Adj. R 的前向/后向选择，以及基于 VIF 移除预测因子。好吧，当你走出考场的时候，把这些都忘掉吧，因为它们在实践中毫无用处。您<a class="ae ml" href="https://www.stat.cmu.edu/~cshalizi/mreg/15/lectures/26/lecture-26.pdf" rel="noopener ugc nofollow" target="_blank">无法在这些系数</a>上计算有效的 p 值，并且系数的幅度会太大(过拟合)。相反，或者咨询领域专家来构建一个<a class="ae ml" href="https://ftp.cs.ucla.edu/pub/stat_ser/r332.pdf" rel="noopener ugc nofollow" target="_blank">因果 DAG </a>或者使用交叉验证正则化。</p><h1 id="f0c4" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">掩饰</h1><p id="4360" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">新数据集！现在告诉我，X1 能很好地预测 Y 吗？</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/865899428df0bfecbfdb4ab2dd0ad562.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*zCjQOCSFQPjno19Ii64JmA.jpeg"/></div></figure><p id="2773" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你回答“我不知道”，很好！X1 和 Y 是不相关的，但是一旦我们控制了 X2，X1 就成为 Y 的一个很好的预测因子:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/2c9c177521a3b35a036c16e189af893f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*vC73_fpWTQzEFz7qTs4aKw.jpeg"/></div></figure><p id="69c6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这一次，因果结构就是所谓的倒叉:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/38f5fe5cdc822dbc230e48154da65553.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*rgZLCHxkAe3T48LFjOKfyw.png"/></div></figure><p id="47fb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们不知道 X2，X1 和 Y 确实是独立的:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi my"><img src="../Images/0989d920f994eb44244346731fbf8395.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*lZYIm4vJ-tBXA9Y1Zimdkw.png"/></div></figure><p id="b06f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是一旦我们知道了 X2，X1 给了我们关于 Y 的信息:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi my"><img src="../Images/dd6ca3e5c60411a760a9b55e7bec41e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:864/format:webp/1*ROC541rTsBareo7CnU0prg.png"/></div></figure><p id="40e0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">再次请参考<a class="ae ml" rel="noopener" target="_blank" href="/beyond-a-b-testing-primer-on-causal-inference-d8e462d90a0b">我之前的文章</a>更详细的解释。这篇文章的目的只是为了表明，将变量彼此对立起来是荒谬的。</p><p id="742d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">需要明确的是，X1 对 Y 没有任何因果关系。但是，它是 Y 的一个很好的预测因子，如果目标是纯预测能力，则应该包括在模型中。</p><p id="b832" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">虽然第一个例子相对来说是良性的，但是当分析师因为没有相关性而从不尝试将 X1 放入模型时，这个例子可能是灾难性的。或者，同样糟糕的是，他们做了相关性测试，得出 X1 和 Y 完全不相关的结论:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/f6174be6fd377edaa6556d7a7daa8946.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*tnT8HB6rxptlxTAbPqwdMw.png"/></div></figure><p id="f61e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">永远不要<em class="mj">永远不要</em> </strong>使用相关性或曲线手动选择回归变量。要么咨询领域专家来绘制因果 DAG，要么让它正规化——LASSO 可以比你我做得更好。</p><h1 id="e55f" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">转换</h1><p id="e4ca" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">从这两个例子中，应该很清楚<strong class="kk iu">残差是信息的使者</strong>。</p><p id="069d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">新数据集！X1 是 Y 的好预测吗？</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/3906a0119a47c25da8eeaacd421653d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*aW9VIFgx_CP8uwonQGsGwg.jpeg"/></div></figure><p id="e497" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正确的答案是，“我不知道。”</p><p id="01af" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如我们到目前为止所了解的，这种类型的视觉化几乎是没有意义的。那么我们应该用什么呢？当然是残差 vs 变量！这里我们回归 Y~X1+X2，并检查每个预测值的残差:</p><div class="lf lg lh li gt ab cb"><figure class="na lj nb nc nd ne nf paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><img src="../Images/2be3e1c30f93c137c0fa2694c98af9d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*_WOWca5z7rSBwvksEf9mWA.jpeg"/></div></figure><figure class="na lj nb nc nd ne nf paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><img src="../Images/142ac6b9ca10036e702ee1817dec5772.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*yj522AnkdhLqjZFhH7RfpA.jpeg"/></div></figure></div><p id="3ebb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们看到我们需要将 X1 特征工程到我们的回归模型中。这在变量与变量图中几乎看不到，但一旦我们检查残差，就会一目了然。</p><p id="d0c9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要获得关于 Y 的信息，您需要根据残差回归拟合值。在这种情况下，只能看到来自省略的 X1 的弱信号:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/0cc21eb5350a34bc176590d2aff076d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*h9tFCJyaHf8S9irFGoq8gg.jpeg"/></div></figure><p id="a81f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你从 pairs 图中看到的任何必要的变换也可以通过残差图看到，但是反过来就不正确了。<strong class="kk iu">你可以通过将所有变量放入一个回归中，并检查单个变量的残差来进行 EDA。</strong></p><h1 id="e200" class="lm ln it bd lo lp lq lr ls lt lu lv lw jz lx ka ly kc lz kd ma kf mb kg mc md bi translated">最后</h1><p id="3794" class="pw-post-body-paragraph ki kj it kk b kl me ju kn ko mf jx kq kr mg kt ku kv mh kx ky kz mi lb lc ld im bi translated">希望你已经知道传统的<strong class="kk iu">对图/关联热图对于分析数据几乎没有意义</strong>。相反，依靠<strong class="kk iu">残差</strong>和拟合系数来查看因变量和自变量之间的关系。</p><p id="9d03" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">有些人可能会反对“但是我们需要检查变量的分布！”实际上，<strong class="kk iu">不</strong>，除了检查数据质量问题，我们真的不关心，例如，丢失的数据是否编码为 9999？数据被正确审查了吗？是否存在数据泄露？(尽管最后一项出现在好得令人难以置信的评估指标中。)</p><p id="4681" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">回归对任何变量的分布绝对没有假设或限制。假设是在<strong class="kk iu">残差</strong>上，甚至常态部分往往都无关紧要。</p><p id="ade8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我最讨厌的一件事是，人们抱怨他们的预测值不是正态分布的，log/Box-Cox 变换不能使预测值成为高斯分布。然后他们开始抱怨统计因为不切实际的假设而不切实际，而他们抱怨的假设根本不存在。绝对触发。</p><p id="d9de" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">反正<strong class="kk iu"> EDA 对变量不好，EDA 对残差好</strong>。</p></div></div>    
</body>
</html>