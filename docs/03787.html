<html>
<head>
<title>Top 3 Pandas Functions I Wish I Knew Earlier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫的三大功能我希望我能早点知道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/top-3-pandas-functions-i-wish-i-knew-earlier-6711030bf48a?source=collection_archive---------8-----------------------#2020-04-09">https://towardsdatascience.com/top-3-pandas-functions-i-wish-i-knew-earlier-6711030bf48a?source=collection_archive---------8-----------------------#2020-04-09</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="29a6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">节省时间和精力的功能——一定要了解它们。</h2></div><p id="3246" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">数据科学是一个如此广阔的领域，不可能有人精通每一种语言和每一个库——在这个行业呆了这么久，我知道的就这么多。不断的学习让我在游戏中坚持下来，回头看看这篇文章中的函数将会节省大量的时间(和精力)。</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi le"><img src="../Images/a34c16ff1ce3f655a4d2095fc3d7f03a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Vow9_0cPeyowmBf0"/></div></div><p class="lq lr gj gh gi ls lt bd b be z dk translated">照片由<a class="ae lu" href="https://unsplash.com/@kilyan_s?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Kilyan Sockalingum </a>在<a class="ae lu" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="ebbc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">其中一些纯粹是一个功能，但另一方面，一些是指你使用熊猫的方式，以及为什么一种方法比另一种更好。</p><p id="9389" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以让我们从第一个开始——它的效率可能会让你吃惊。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="5d0e" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">itertuples()</h1><p id="0732" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated"><em class="mz">等等，什么？</em>是的，这不是一个函数，它指的是使用 Pandas 的更有效的方式，因此是通过数据集迭代的更快的方式。</p><p id="553a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，在您在评论部分为难之前，我知道有更有效的方法来对列值求和，但是我这样做只是为了说明一点。</p><p id="9775" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们将声明一个只有一列的简单数据集，包含从 1 到 100 万的数字。方法如下:</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="29cc" class="nf md it nb b gy ng nh l ni nj">df = pd.DataFrame(data={<br/>   'Number': range(1, 1000000)<br/>})</span></pre><p id="9705" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是前几行的样子:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/e8cb57382995c361a9e0855e556f789b.png" data-original-src="https://miro.medium.com/v2/resize:fit:268/format:webp/1*5ZheIL_aYnbniojhMLNokg.png"/></div></figure><p id="f1a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们用错误的方式做事。我们将声明一个变量<code class="fe nl nm nn nb b">total</code>并将其设置为<code class="fe nl nm nn nb b">0</code>。然后，通过使用<code class="fe nl nm nn nb b">iterrows()</code>，我们将对数据集进行迭代，并将<code class="fe nl nm nn nb b">total</code>增加当前行的值。此外，我们将测量时间。代码如下:</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="4ed6" class="nf md it nb b gy ng nh l ni nj">%%time</span><span id="e5e9" class="nf md it nb b gy no nh l ni nj">total = 0</span><span id="00f5" class="nf md it nb b gy no nh l ni nj">for _, row in df.iterrows():<br/>    total += row['Number']<br/> <br/>total</span><span id="8cf6" class="nf md it nb b gy no nh l ni nj"><strong class="nb iu">&gt;&gt;&gt; Wall time: 18.7 s</strong></span></pre><p id="a97e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于这个琐碎的操作，几乎需要<strong class="kk iu"> 19 秒</strong>——但是有更好的方法。让我们现在做同样的事情，但是用<code class="fe nl nm nn nb b">iteruples</code>代替<code class="fe nl nm nn nb b">iterrows</code>:</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="7844" class="nf md it nb b gy ng nh l ni nj">%%time</span><span id="eece" class="nf md it nb b gy no nh l ni nj">total = 0</span><span id="f3e9" class="nf md it nb b gy no nh l ni nj">for row in df.itertuples(index=False):<br/>    total += row.Number<br/> <br/>total</span><span id="2920" class="nf md it nb b gy no nh l ni nj"><strong class="nb iu">&gt;&gt;&gt; Wall time: 82.1 ms</strong></span></pre><p id="a5f1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我不会做计算，但速度的提高是显着的。下次执行循环时记住这一点。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="9015" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">nlargest()和 nsmallest()</h1><p id="241b" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">就在昨天，我还在计算两个纬度/经度对之间的千米距离。这是问题的第一部分，第二部分是选择距离最小的前 N 个记录。</p><p id="5028" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">回车— <code class="fe nl nm nn nb b">nsmallest()</code>。</p><p id="1467" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">顾名思义，<code class="fe nl nm nn nb b">nlargest()</code>将返回 N 个最大值，而<code class="fe nl nm nn nb b">nsmallest()</code>则正好相反。</p><p id="12a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们看看它的实际效果。对于实践部分，我准备了一个小数据集:</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="e575" class="nf md it nb b gy ng nh l ni nj">df = pd.DataFrame(data={<br/>    'Name': ['Bob', 'Mark', 'Josh', 'Anna', 'Peter', 'Dexter'],<br/>    'Points': [37, 91, 66, 42, 99, 81]<br/>})</span></pre><p id="0dd7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是它的样子:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi np"><img src="../Images/5bddf332c15d058d1e46413ae8fad2d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/1*yr6FcCUp1IjxXjNrnMdOvQ.png"/></div></div></figure><p id="3218" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，让我们假设这个数据集不包含 6 行，而是包含 6000 行，您希望找出哪些学生表现最好，因此他们有最大的<strong class="kk iu">点数</strong>。一种方法是这样的:</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="58de" class="nf md it nb b gy ng nh l ni nj">df['Points'].nlargest(3)</span></pre><p id="9449" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">不是最佳解决方案，因为它会导致以下结果:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/01761dc77aee48e0557775125e7b959a.png" data-original-src="https://miro.medium.com/v2/resize:fit:522/format:webp/1*FMHf0nv_CoTvM26qie1dMQ.png"/></div></figure><p id="268f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这并不好，因为你并不清楚实际的名字。以下是改进的方法:</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="c447" class="nf md it nb b gy ng nh l ni nj">df.nlargest(3, columns='Points')</span></pre><p id="7d78" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在结果更加令人满意:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/491e79002418e697c0b79a637122415a.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*e-Y0JurhQQKq7WQl5ST7Jw.png"/></div></figure><p id="e265" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以使用几乎相同的逻辑找到 3 名表现最差的学生——使用<code class="fe nl nm nn nb b">nsmallest()</code>函数:</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="21e3" class="nf md it nb b gy ng nh l ni nj">df.nsmallest(3, columns='Points')</span></pre><p id="7c7b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下是输出结果:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/3b7898e97982853485f54474a0e2b6bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:296/format:webp/1*nAmBZMI2x5hQ4sbERPJUKQ.png"/></div></figure><p id="27c1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在让我们进行最后一个函数。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="e7a5" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">切割()</h1><p id="18f0" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">为了演示这个函数的功能，我们将使用上一节中的数据集。概括一下，这就是:</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="cc11" class="nf md it nb b gy ng nh l ni nj">df = pd.DataFrame(data={<br/>    'Name': ['Bob', 'Mark', 'Josh', 'Anna', 'Peter', 'Dexter'],<br/>    'Points': [37, 91, 66, 42, 99, 81]<br/>})</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi np"><img src="../Images/5bddf332c15d058d1e46413ae8fad2d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:314/format:webp/1*yr6FcCUp1IjxXjNrnMdOvQ.png"/></div></div></figure><p id="0716" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nl nm nn nb b">cut()</code>函数背后的基本思想是将宁滨值分成<strong class="kk iu">个离散区间</strong>。下面是最简单的例子——我们将从<code class="fe nl nm nn nb b">Points</code>属性创建两个 bin:</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="6e67" class="nf md it nb b gy ng nh l ni nj">pd.cut(df['Points'], bins=2)</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/d19d2ae2c6a2e4149812ce00a5b4c6cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*EgqCbugoGMdwxCF_FTFiiA.png"/></div></figure><p id="9585" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">暂时没什么用处。但是如何声明第一个 bin 从 0 到 50，第二个 bin 从 50 到 100 呢？听起来像个计划。代码如下:</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="bed6" class="nf md it nb b gy ng nh l ni nj">pd.cut(df['Points'], bins=[0, 50, 100])</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/393d3418b09aa4d25679e073548cc90e.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*Mgfc8Zig0JT4pRuzrGXAVg.png"/></div></figure><p id="b443" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，假设你想显示<code class="fe nl nm nn nb b">Fail</code>而不是<code class="fe nl nm nn nb b">(0, 50]</code>，显示<code class="fe nl nm nn nb b">Pass</code>而不是<code class="fe nl nm nn nb b">(50, 100]</code>。下面是如何做到这一点:</p><pre class="lf lg lh li gt na nb nc nd aw ne bi"><span id="446e" class="nf md it nb b gy ng nh l ni nj">pd.cut(df['Points'], bins=[0, 50, 100], labels=['Fail', 'Pass'])</span></pre><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi nv"><img src="../Images/68bbbfeaaf0f7f920a082ce4040e1322.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*HEkTjhEG3CJj1QfcLZ16Cg.png"/></div></div></figure><p id="eb3b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这下好了。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="f4ad" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">在你走之前</h1><p id="aa7d" class="pw-post-body-paragraph ki kj it kk b kl mu ju kn ko mv jx kq kr mw kt ku kv mx kx ky kz my lb lc ld im bi translated">如果你刚刚开始，这个功能将帮助你节省时间和精力。如果你不是，阅读这篇文章将帮助你<strong class="kk iu">巩固这些函数存在的知识</strong>——因为很容易忘记它们并从头开始编写逻辑。</p><p id="5187" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是这样做没有意义。</p><p id="5c4d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我希望你喜欢它。感谢阅读。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="d7b2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mz">喜欢这篇文章吗？成为</em> <a class="ae lu" href="https://medium.com/@radecicdario/membership" rel="noopener"> <em class="mz">中等会员</em> </a> <em class="mz">继续无限制学习。如果你使用下面的链接，我会收到你的一部分会员费，不需要你额外付费。</em></p><div class="nw nx gp gr ny nz"><a href="https://medium.com/@radecicdario/membership" rel="noopener follow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">通过我的推荐链接加入 Medium-Dario rade ci</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">medium.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on lo nz"/></div></div></a></div></div></div>    
</body>
</html>