<html>
<head>
<title>Automating Random Forests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化随机森林</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/automating-random-forests-a75c580f360e?source=collection_archive---------55-----------------------#2020-08-19">https://towardsdatascience.com/automating-random-forests-a75c580f360e?source=collection_archive---------55-----------------------#2020-08-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d635" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">建立你自己的自动机器学习系统的教程。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f5833b233efec20d3a9b980b45d377ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aYIwQPp8_7J9crm-"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">克里斯里德在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="759c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我最近完成了一个<a class="ae ky" href="https://nocodeml.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">网站</a>的开发，它可以进行端到端的机器学习(作为一个 GUI ),也就是说，它可以自动完成以下步骤:</p><ul class=""><li id="eb34" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">使用表单从用户处获取培训数据和测试数据。</li><li id="1d0d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">清理数据并使其可用于机器学习模型(如填充缺失值、处理分类变量等。).</li><li id="ea64" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">根据数据训练随机森林并调整其超参数。</li><li id="4838" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">对数据执行特征工程。</li><li id="8ec0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">为最终模型绘制特征重要性图。</li><li id="9c7c" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">根据测试数据生成预测，并将结果和功能重要性图发送到用户提供的电子邮件地址。</li></ul><p id="ba06" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以在这篇博客中，我将带你浏览设置这样一个系统的代码。你可以在这里找到包含网站<a class="ae ky" href="https://github.com/shaan2909/Automating-RF-Website/blob/master/ml/mlcode.py" rel="noopener ugc nofollow" target="_blank">机器学习部分核心代码的 GitHub repo。</a></p><p id="3855" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们将使用旧的 fastai 库(v0.7)的一部分作为开始的初始基础(代码直到第 500 行包含来自库的片段和其他将被使用的必要导入)。您可以复制代码片段或安装库。我们将从这里开始编码！</p><p id="ae4d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我将一段一段地解释代码。所以让我们开始吧！</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="95f3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码定义了一些函数，随着我们的深入，这些函数将被重复使用。两个功能最为突出:</p><ul class=""><li id="c9c4" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">“print_score”:它将用于评估我们的模型在训练和验证数据集上的性能。</li><li id="5d00" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">“auto_train”:它将用于使用给定的超参数来训练随机森林。</li></ul><p id="080d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">下一个函数“data_trainer”有点长，所以我将把它分成两部分来解释给你听。它将用于执行以下任务:</p><ul class=""><li id="cabb" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">清理数据，处理分类变量，从日期(如果有的话)中提取信息，并填充缺失的值。</li><li id="5749" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">训练随机森林并调整其超参数。</li><li id="4191" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">特征工程。</li><li id="5121" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">删除多余的变量。</li><li id="1952" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">绘制特征重要性图。</li></ul><p id="9237" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，让我们开始吧！我已经添加了注释来划分与每个过程相对应的部分。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="cdaa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上述代码(“data_trainer”的第一部分)执行以下任务:</p><ol class=""><li id="4dc1" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ml mb mc md bi translated">它从日期列(如果有的话)中提取数据，比如年、日、月、季度末与否、年末与否等等。</li><li id="d9eb" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ml mb mc md bi translated">它将分类变量转换成机器学习模型可以使用的格式。它还会填充缺失的值。</li><li id="1570" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ml mb mc md bi translated">它将数据分成训练和验证数据集。</li><li id="dd05" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ml mb mc md bi translated">如果数据集非常大，它将使用“RF _ sampling”(fastai 中的一种加速方法)。</li><li id="7dc0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ml mb mc md bi translated">然后，它将使用循环开始调整随机森林的超参数，即“min_samples_leaf”和“max_features ”,以获得最佳结果。</li></ol><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="79f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码(“data_trainer”的第二部分)将执行特征工程，并删除不影响我们的目标变量或多余的变量。<br/>之后，该函数将返回最佳超参数和用于训练最终模型的特征列表。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="5dbd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">上面的代码定义了一个函数来预测测试数据集，并生成和保存特征重要性图。它执行以下所有操作:</p><ul class=""><li id="a554" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">像我们对训练数据集所做的那样，从日期列(如果有)中提取信息。</li><li id="e910" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在整个数据集(训练+验证)上训练随机森林(使用在先前函数中获得的超参数和特征工程信息),并将其应用于测试数据集以生成预测。</li><li id="2348" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">生成特征重要性图并保存。</li></ul><p id="e58e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在剩下要做的就是将所有先前定义的函数捆绑在一起，通过适当的输入以适当的顺序调用它们，这就是下面要做的。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="7ce8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">总结:<br/>我们首先定义了一个函数来清理训练数据，找到最佳超参数，并执行特征工程(称为“data_trainer”)。然后，我们定义了一个函数，使用从上述函数获得的信息来训练模型，并使用它来生成测试数据集的功能重要性图和预测(称为“auto_applyer”)。然后，我们使用一个名为“auto_predictor”的函数将一切联系起来。此外，如果你想建立一个电子邮件系统来发送包含结果的电子邮件，你可以在这里找到代码<a class="ae ky" href="https://gist.github.com/shaan-shah/dfc51a2988964f42564baf1ca63dbf2b" rel="noopener ugc nofollow" target="_blank">。</a> <br/>瞧！我们建立了自己的自动化机器学习系统。</p><p id="03bc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你可以查看网站(端到端 GUI) <a class="ae ky" href="https://nocodeml.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">这里</a>这里是 GitHub repo <a class="ae ky" href="https://github.com/shaan2909/Automating-RF-Website" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="839b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">非常感谢你阅读这个博客！</p><p id="b677" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">附言<br/>如有任何问题或建议，请随时通过<a class="ae ky" href="https://www.linkedin.com/in/shaan-shah-88085819b/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>与我联系。</p></div></div>    
</body>
</html>