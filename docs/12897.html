<html>
<head>
<title>Don’t Know the Breed of Your Dog? ML Can Help!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不知道你家狗狗的品种？ML 可以帮忙！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dont-know-the-breed-of-your-dog-ml-can-help-6558eb5f7f05?source=collection_archive---------42-----------------------#2020-09-04">https://towardsdatascience.com/dont-know-the-breed-of-your-dog-ml-can-help-6558eb5f7f05?source=collection_archive---------42-----------------------#2020-09-04</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="783e" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习如何建立一个生产就绪的软件，可以分类品种的狗的图像</h2></div><p id="60cf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你有没有想过你的狗或者你在街上看到的其他狗的品种？关于那件事，你可能得问专家。嗯，不会再有了！在这篇文章中，我将教你构建自己的 web 应用程序，它将接受你的狗的图像并以超过 80%的准确率输出它的品种！</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi le"><img src="../Images/f13b39ddbcc68726032969a75d506eba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*oJSDSETx88eKVLTOtYmXmg.jpeg"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">这只狗是什么品种？来自<a class="ae lq" href="https://www.pexels.com/photo/brown-and-white-short-coated-dog-sitting-and-smiling-2463238/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank"> Pexels </a>的<a class="ae lq" href="https://www.pexels.com/@alexdolle?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">亚历克斯·多勒</a>的照片</p></figure><p id="2453" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可能想知道这怎么可能？嗯，我们将使用机器学习，特别是深度学习，在狗的图像数据集上训练一个模型，并记录它们的品种，以学习区分每个品种的特征。那我们开始吧！</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="0de8" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">数据分析</h1><p id="9336" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">数据集可以从<a class="ae lq" href="https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/dogImages.zip" rel="noopener ugc nofollow" target="_blank">这里</a>下载。成功加载和浏览数据集后，以下是关于数据的一些见解:</p><ol class=""><li id="4b8c" class="mv mw it kk b kl km ko kp kr mx kv my kz mz ld na nb nc nd bi translated">狗的品种总数:133</li><li id="c353" class="mv mw it kk b kl ne ko nf kr ng kv nh kz ni ld na nb nc nd bi translated">狗图像总数:8351(训练:6680，有效:835，测试:836)</li><li id="1052" class="mv mw it kk b kl ne ko nf kr ng kv nh kz ni ld na nb nc nd bi translated">最受欢迎的品种:<code class="fe nj nk nl nm b">Alaskan_malamute:96</code>，<code class="fe nj nk nl nm b">Border_collie: 93</code></li></ol><p id="939a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">按图片数量排序的前 30 个品种如下所示:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div role="button" tabindex="0" class="no np di nq bf nr"><div class="gh gi nn"><img src="../Images/3767f51eed582d1298b3fe57dfe906ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18t6gze0RpaYEOspCxovCw.png"/></div></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">作者图片</p></figure><p id="85b5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们还可以在这里看到一些狗的图片和它们的品种:</p><figure class="lf lg lh li gt lj gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/35ec5938e08a2589f2159ad7561fe785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*7N51tIQ9QQbaMzt312oI_Q.png"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">作者图片(<a class="ae lq" href="https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/dogImages.zip" rel="noopener ugc nofollow" target="_blank">数据集</a>)</p></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="af21" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">数据预处理</h1><p id="b377" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">分析之后，是为机器学习算法准备数据的部分。我们将加载每个图像作为一个 NumPy 数组，并将它们的大小调整为 224x224，因为这是大多数传统神经网络接受图像的默认大小。我们还将为图像的数量添加另一个维度</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nt nu l"/></div><p class="lm ln gj gh gi lo lp bd b be z dk translated">细胞神经网络图像预处理</p></figure><p id="9e40" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，我们将使用<code class="fe nj nk nl nm b">ImageDataGenerator</code>对图像进行动态缩放和增强</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nt nu l"/></div></figure></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="ba95" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">CNN 从零开始</h1><p id="bcd7" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">我们将从在预处理数据集上从头开始训练卷积神经网络(CNN)开始，如下所示:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="9c72" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们使用回调<code class="fe nj nk nl nm b">ModelCheckpoint</code>来保存基于验证分数的模型。测试这个模型，我们得到了大约 1%的精确度</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="91be" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">使用迁移学习</h1><p id="e88f" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">现在，我们将看到使用预先训练的功能如何产生巨大的差异。下载<a class="ae lq" href="https://s3-us-west-1.amazonaws.com/udacity-aind/dog-project/DogResnet50Data.npz" rel="noopener ugc nofollow" target="_blank"> ResNet-50 瓶颈功能</a>。您可以通过运行下面的代码单元格来提取相应的定型集、测试集和验证集:</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="e2f7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们现在将再次定义模型，并对提取的特征使用<code class="fe nj nk nl nm b">GlobalAveragePooling2D</code>,将一组特征平均为一个值。最后，如果验证损失在连续 2 个时期内没有增加，我们使用额外的回调来降低学习速率<code class="fe nj nk nl nm b">ReduceLROnPlateau</code>，并且如果验证损失在连续 5 个时期内没有增加，我们还使用额外的回调来提前停止训练<code class="fe nj nk nl nm b">EarlyStopping</code>。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="9165" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在测试集上的准确率为<strong class="kk iu"> 82.65%。与我们从零开始训练的模型相比，这是一个巨大的进步。</strong></p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="47e6" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">构建 web 应用程序</h1><p id="e336" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">对于 web 应用程序，我们将首先编写一个助手函数，它接受图像路径并返回品种。<code class="fe nj nk nl nm b">label_to_cat</code> dictionary 将每个数字标签映射到其犬种。</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="0eb7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于 web 应用程序，我们将使用<strong class="kk iu"> Flask </strong> web 框架，它帮助我们用最少的代码创建 web 应用程序。我们将定义一条接受图像的路线，并呈现一个带有狗的品种的输出模板</p><figure class="lf lg lh li gt lj"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="2f23" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><code class="fe nj nk nl nm b">predict.html</code>是分别显示图片及其犬种的模板。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><h1 id="a899" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">结论</h1><p id="af7a" class="pw-post-body-paragraph ki kj it kk b kl mq ju kn ko mr jx kq kr ms kt ku kv mt kx ky kz mu lb lc ld im bi translated">恭喜你！你已经成功地实现了一个犬种分类器，并且可以自信地辨别犬种。让我们总结一下我们在这里学到的东西:</p><ol class=""><li id="0974" class="mv mw it kk b kl km ko kp kr mx kv my kz mz ld na nb nc nd bi translated">我们对数据集进行了分析和预处理。独立的<strong class="kk iu">训练、测试和验证集</strong>对于机器学习算法进行有把握的预测是必要的。</li><li id="6048" class="mv mw it kk b kl ne ko nf kr ng kv nh kz ni ld na nb nc nd bi translated">我们从零开始使用了一个<strong class="kk iu">CNN</strong>，它表现很差，因为它无法提取特征。</li><li id="c30e" class="mv mw it kk b kl ne ko nf kr ng kv nh kz ni ld na nb nc nd bi translated">然后我们使用<strong class="kk iu">迁移学习</strong>，准确度提高了很多</li><li id="f246" class="mv mw it kk b kl ne ko nf kr ng kv nh kz ni ld na nb nc nd bi translated">最后，我们构建了一个 Flask web 应用程序，使我们的项目<strong class="kk iu">可以投入生产</strong></li></ol><p id="81ad" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们确实学到了很多，但是还有很多其他的事情你可以尝试。您可以在 Heroku 上部署 web 应用程序，或者尝试使用不同的层(如<code class="fe nj nk nl nm b">Dropout</code>层)来提高准确性。</p><p id="fab6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要了解更多信息和详细分析，请务必点击这里查看我的 GitHub <a class="ae lq" href="https://github.com/nouman-10/Dog-Breed-Classifier" rel="noopener ugc nofollow" target="_blank">上的代码。</a></p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><p id="4b9c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您觉得以上内容对您有用，请分享并随时支持我--&gt;</p><ul class=""><li id="86c7" class="mv mw it kk b kl km ko kp kr mx kv my kz mz ld nv nb nc nd bi translated"><a class="ae lq" href="https://www.buymeacoffee.com/nouman10" rel="noopener ugc nofollow" target="_blank">https://www.buymeacoffee.com/nouman10</a></li></ul></div></div>    
</body>
</html>