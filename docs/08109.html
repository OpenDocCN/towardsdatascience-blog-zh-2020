<html>
<head>
<title>Stop Using Excel for Data Analytics: Upgrade to Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">停止使用Excel进行数据分析:升级到Python</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/stop-using-excel-for-data-analytics-upgrade-to-python-46b5963fb036?source=collection_archive---------18-----------------------#2020-06-15">https://towardsdatascience.com/stop-using-excel-for-data-analytics-upgrade-to-python-46b5963fb036?source=collection_archive---------18-----------------------#2020-06-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/8a83ddc8f62752de4f6e33c67005f7c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lg827u6a10qYOUSi"/></div></div></figure><p id="7bfe" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">2017年，估计全球有7.5亿人使用Excel。2017年世界人口约为76亿。这意味着大约10%的人在使用Excel，我猜主要是为了数据分析。这太疯狂了。</p><p id="ffd4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">毫无疑问，Excel对于公司来说是一个极其重要的工具，并且仍然在每个数据分析师和科学家的工具包中占有一席之地，但是对于你的大部分工作来说，你需要停止使用Excel并升级到Python。我会告诉你为什么。</p><p id="8e36" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">所以，如果你还没有开始学习Python，并把你的数据分析和可视化技能提高到一个新的水平，我给你提供了5个你现在需要学习Python的理由。最后，我相信你会期待用Python取代你的大部分Excel工作。</p><h1 id="03cb" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">规模和自动化</h1><p id="ba49" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">当你想对小数据进行快速、特别的分析时，Excel是很好的工具，但是一旦你想进行更大规模的分析，它就不起作用了。Excel最多可以支持1，048，576行16，384列的数据。另一方面，Python可以扩展到内存大小，并且有许多工具支持内存外计算。</p><p id="4948" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">例如，Dask库允许您将计算扩展到在一个机器集群上运行，而不仅仅是在您的笔记本电脑上。事实上，如果你熟悉熊猫，在CSV中阅读几乎完全相同的代码:</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="fcd8" class="mm lb it mi b gy mn mo l mp mq">import dask.dataframe as dd<br/> <br/># Load the data with Dask instead of Pandas.<br/> <br/>df = dd.read_csv(&lt;file_path&gt;)</span></pre><p id="be07" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一行代码，你现在读入的数据就超过了你电脑的内存。我会告诉你如何在Excel中做到这一点，但这甚至是不可能的。</p><blockquote class="mr ms mt"><p id="e7dc" class="kb kc mu kd b ke kf kg kh ki kj kk kl mv kn ko kp mw kr ks kt mx kv kw kx ky im bi translated"><em class="it">如果这段代码看起来很奇怪，看看这个</em> <a class="ae kz" href="https://www.educative.io/courses/python-data-analysis-and-visualization" rel="noopener ugc nofollow" target="_blank"> <em class="it">课程</em> </a> <em class="it">，它会教你入门熊猫所需要知道的一切。</em></p></blockquote><p id="a122" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此外，Python可以扩展到多个数据源。虽然Excel既是数据存储又是计算引擎，但是Python完全是数据不可知的。如果您能找到将数据读入Python的方法，您就可以使用它。由于Python有这么多优秀的库，从CSV、Excel、JSON和SQL数据库等许多来源读入数据是很容易的。</p><p id="4162" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后，就自动化而言，Python是一种令人惊叹的编程语言。因为您可以将Python直接连接到任何数据源，所以很容易安排一个作业，该作业将使用任何更新重新提取您的数据，运行您的计算，甚至创建报告或动态仪表板，从而节省您大量的时间。另一方面，Excel需要太多的手工劳动，并且不能自动更新。</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/a6cafb95872e2c6601dda9f36e5cabd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fKQLclF82VqHGEti"/></div></div><p class="mz na gj gh gi nb nc bd b be z dk translated">Python可以直接连接到数据库进行自动更新。来源:NobleDesktop</p></figure><h1 id="d442" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">再现性</h1><p id="d65d" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">可再现性是这样一个概念，即你创建的任何分析或可视化都应该简单明了地为他人再现。不仅需要有人能够重新运行您的过程并以相同的结果结束，而且他们还应该能够通过您的步骤来确保准确性。当你开始依赖自动化时，这个概念是极其重要的。当工作正常时，自动化是惊人的，但当不正确时，自动化报告可能是一场噩梦。</p><p id="4849" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Excel的重现性非常具有挑战性。单元格中的Excel计算几乎不可能在任何规模下进行检查。数据类型非常令人困惑，因为你看到的并不总是原始数据中所表示的，虽然VBA使再现性稍微好一点，但在这一点上，你最好投资学习Python。</p><p id="cd2d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">看看这个Excel文档:</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nd"><img src="../Images/6523b4d3618d92ff4ca139ccffdacedf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_lJLfMqHLcqYF7q1"/></div></div></figure><p id="c090" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你知道<code class="fe ne nf ng mi b">sum</code>列应该是a和b的和，但是你怎么确认呢？您可以检查其中一个公式，并看到它实际上是总和，但由于每个单元格都可以是自己的公式，如果它们都不正确呢？如果你没有注意，你可能会错过x行是错误的。</p><p id="1511" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">但是在Python中，您求和将如下所示:</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="c570" class="mm lb it mi b gy mn mo l mp mq">a = [1,2,3,4]<br/>b = [5,6,7,8]<br/>sum = []<br/>for i in range(a):<br/>    sum.append(a[i] + b[i])</span></pre><p id="82fe" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这段代码很清楚，很容易确认总和总是计算正确。</p><p id="e744" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">有了Python，你可以获得为软件工程师更好地实现<strong class="kd iu">再现性和协作而开发的所有工具。最重要的是，Python在数据连接方面更胜一筹，允许我们在云端分析数据，并立即重复一个过程。Git、单元测试、文档和代码格式标准在Python社区中非常流行。使用Python 3，您甚至可以添加静态类型，使您的代码更加清晰。所有这些工具都使得确保你的代码写得又好又正确变得更加容易。这样下次你看你的代码或者别人拿起它的时候，就很容易复制和理解了。</strong></p><h1 id="a786" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">可转移的技能</h1><p id="1391" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">懂Excel就懂Excel。虽然你学到的技能是有用的，但它们不能转移到其他任何东西上。我最喜欢Python的一点是，它不仅是一个令人惊叹的数据分析和可视化工具，而且是一种可靠的编程语言，可以用于许多其他事情。</p><p id="81cb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">想做<a class="ae kz" href="https://www.educative.io/blog/machine-learning-for-data-science" rel="noopener ugc nofollow" target="_blank">机器学习</a>甚至深度学习？使用Python可以做到这一点。想建个网站？Python可以做到这一点。想让你的智能家居自动化吗？Python也可以这样做。</p><p id="c6b8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此外，Python比Excel更接近于其他编程语言。这使得你更容易学会沿途可能遇到的其他语言。学习Python比Excel打开了更多的大门。</p><p id="1e79" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后，对Python的<strong class="kd iu">需求非常高</strong>。根据StackOverflow的数据，2019年，它在专业软件开发人员中被评为世界第四大最受欢迎的编程语言，也是第一大最受欢迎的编程语言。事实上，据说2020年美国Python开发人员的平均年薪是12万美元。还不错。</p><h1 id="2784" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">高级功能</h1><p id="d549" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">Excel有很多内置公式，但与Python的功能相比就相形见绌了。Python不仅提供了数百个库来简化高级统计和分析，还可以将您的可视化提升到另一个层次。使用Matplotlib、Plotly、Streamlit和Seaborn等工具，您可以创建漂亮的数据可视化以及交互式仪表盘和绘图。</p><p id="5b35" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Numpy和scipy对科学计算、线性代数和矢量化计算有惊人的支持。而scikit-learn可以让你训练从决策树到梯度推进机器的机器学习算法。我觉得<a class="ae kz" href="https://xkcd.com/353/" rel="noopener ugc nofollow" target="_blank"> xkcd </a>说的最好:</p><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/1e74da8975f37ad5e6af9967a75ec50c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0oSYSupbkV2c3_Kl"/></div></div></figure><h1 id="3ca6" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Python很容易学</h1><p id="d4a5" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">鉴于Python相对于Excel的所有惊人优势，它一定很难学，对吗？<em class="mu">不！</em>查看Java版的<code class="fe ne nf ng mi b">Hello World</code>，最简单的程序:</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="f392" class="mm lb it mi b gy mn mo l mp mq">class HelloWorld {</span><span id="ae20" class="mm lb it mi b gy ni mo l mp mq">    public static void main( String args[] ) {</span><span id="cd9c" class="mm lb it mi b gy ni mo l mp mq">        System.out.println( "Hello World!" );</span><span id="f291" class="mm lb it mi b gy ni mo l mp mq">    }</span><span id="f46c" class="mm lb it mi b gy ni mo l mp mq">}</span></pre><p id="77ce" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Python字面上就是一行:<code class="fe ne nf ng mi b">print(“Hello World!”)</code>。没有比这更简单的了。Python是最容易掌握的编程语言之一，并且拥有最活跃的社区之一，尤其是在数据分析领域。Python是最直观的编程语言之一，即使对计算机科学没有多少背景知识的人也能理解！虽然学习曲线Excel可能看起来更好，但另一端的回报要少得多。<strong class="kd iu"> Python的学习曲线值得花费时间和精力</strong>，这是Excel因其一刀切的设计而永远无法比拟的。</p><p id="e9ee" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Python很容易使用，而且有一个巨大的支持社区，学习它从来没有这么容易过。</p><p id="df7c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了向您展示Python有多简单，在下一节中，我将向您介绍Python中数据分析和可视化的一些基础。</p><h1 id="eda4" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">开始使用Python进行数据分析</h1><p id="b60f" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">为了让您入门，我想带您了解Python中的一些基本命令和操作，这对您的数据分析技能至关重要。让我们从基础开始。</p><p id="db38" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你会注意到的第一件事是Python使用了空格，而不像其他语言那样使用分号<code class="fe ne nf ng mi b">;</code>。这里有一个非常简单的例子:</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="0e90" class="mm lb it mi b gy mn mo l mp mq">x = 5</span><span id="cb55" class="mm lb it mi b gy ni mo l mp mq">y = 10</span><span id="7527" class="mm lb it mi b gy ni mo l mp mq">print(x+y)</span></pre><h1 id="b95a" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">导入功能</h1><p id="3814" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">我们将利用许多库，有些是Python预装的，有些我们必须自己安装。使用import语句获取库:</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="c9cb" class="mm lb it mi b gy mn mo l mp mq">from collections import Counter</span></pre><p id="89d1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这个命令从集合库中导入类计数器。计数器对于数据科学家来说是非常有用的工具；它可以计算项目在列表等集合中出现的次数。例如，在下面的代码中，我们将创建一个结婚年龄列表。使用计数器，我们可以快速计算每个独特的年龄出现的次数。</p><h1 id="d933" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Python中的列表</h1><p id="b714" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">列表是存储数据的一种有用的数据结构。我们将在下一课中更详细地研究它们。例如:</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="8972" class="mm lb it mi b gy mn mo l mp mq">from collections import Counter</span><span id="b283" class="mm lb it mi b gy ni mo l mp mq">marriage_ages = [22, 22, 25, 25, 30, 24, 26, 24, 35]</span><span id="8b1f" class="mm lb it mi b gy ni mo l mp mq">value_counts = Counter(marriage_ages)</span><span id="6144" class="mm lb it mi b gy ni mo l mp mq">print(value_counts.most_common())</span></pre><p id="5960" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">您可以看到，我们在第2行使用<code class="fe ne nf ng mi b">[]</code>创建了一个包含结婚年龄的列表。然后，我们在第4行将该列表输入到<code class="fe ne nf ng mi b">Counter</code>函数中，在第5行将最常见的值作为元组列表打印出来。</p><p id="028a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">元组是<code class="fe ne nf ng mi b">()</code>内部的集合。这些元组包含两个元素:值和该值在列表中出现的次数。频率对元组列表进行排序。出现次数最多的值最先出现。</p><h1 id="6b1c" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Python中的函数</h1><p id="041b" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">函数也很有用。Python中的函数以关键字<code class="fe ne nf ng mi b">def</code>和函数名开始，后面是函数在括号中期望的输入。下面是一个函数，它接受两个输入，<code class="fe ne nf ng mi b">x</code>和<code class="fe ne nf ng mi b">y</code>，并返回<code class="fe ne nf ng mi b">sum</code>:</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="ba57" class="mm lb it mi b gy mn mo l mp mq">def add_two_numbers(x, y):  # function header</span><span id="b965" class="mm lb it mi b gy ni mo l mp mq">    """</span><span id="1cec" class="mm lb it mi b gy ni mo l mp mq">    Takes in two numbers and returns the sum</span><span id="b6ec" class="mm lb it mi b gy ni mo l mp mq">    parameters</span><span id="7c88" class="mm lb it mi b gy ni mo l mp mq">    x : str</span><span id="f6ba" class="mm lb it mi b gy ni mo l mp mq">        first number</span><span id="816f" class="mm lb it mi b gy ni mo l mp mq">    y : str</span><span id="d8a1" class="mm lb it mi b gy ni mo l mp mq">        second number</span><span id="01a3" class="mm lb it mi b gy ni mo l mp mq">    returns</span><span id="16b2" class="mm lb it mi b gy ni mo l mp mq">        x+y</span><span id="189b" class="mm lb it mi b gy ni mo l mp mq">    """</span><span id="0492" class="mm lb it mi b gy ni mo l mp mq">    z = x + y</span><span id="bbc1" class="mm lb it mi b gy ni mo l mp mq">    return z  # function return</span><span id="0a69" class="mm lb it mi b gy ni mo l mp mq">print(add_two_numbers(100,5))  # function  call</span></pre><p id="15d8" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">函数也可以是匿名的，这意味着你不必用上面的结构来声明它们。相反，您可以使用<code class="fe ne nf ng mi b">lambda</code>关键字。下面是与上面相同的函数，但作为匿名函数:</p><pre class="md me mf mg gt mh mi mj mk aw ml bi"><span id="5aec" class="mm lb it mi b gy mn mo l mp mq">y = lambda x, y: x + y</span><span id="dc91" class="mm lb it mi b gy ni mo l mp mq">print(y(100,5))  # call the function</span></pre><h1 id="8330" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">包扎</h1><p id="4606" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">是时候转换到Python了。再也没有借口了！我希望这篇文章能帮助你看到学习Python的好处，并打破一些学习的障碍。</p></div><div class="ab cl nj nk hx nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="im in io ip iq"><p id="a908" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="mu">快去用Python把你的技能</em> <a class="ae kz" href="https://www.educative.io/courses/python-data-analysis-and-visualization" rel="noopener ugc nofollow" target="_blank"> <em class="mu">更上一层楼吧！</em>T13】</a></p></div></div>    
</body>
</html>