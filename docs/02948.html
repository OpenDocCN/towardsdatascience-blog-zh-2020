<html>
<head>
<title>Genre Classification of Electronic Dance Music Using Spotify’s Audio Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用 Spotify 的音频分析对电子舞曲进行流派分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/genre-classification-of-electronic-dance-music-using-spotifys-audio-analysis-7350cac7daf0?source=collection_archive---------6-----------------------#2020-03-21">https://towardsdatascience.com/genre-classification-of-electronic-dance-music-using-spotifys-audio-analysis-7350cac7daf0?source=collection_archive---------6-----------------------#2020-03-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="21fc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用机器学习深入研究 EDM</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/1871be0f0cb24d90e03e6877e661e3c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MHLScq2WZ4dRkxByxDGf7w.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Aditya Chinchure 在<a class="ae ky" href="https://unsplash.com/s/photos/music-festival?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="0187" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">介绍</h1><p id="b426" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">电子舞曲有一个史诗般的起源故事。它始于 DJ 用鼓机给迪斯科唱片配音，并在非法的仓库派对上播放。我们今天所知的 EDM 已经发展成为一个价值 7 . 5 亿美元的庞大产业。随着受欢迎程度的提高，越来越多的听众将会接触到他们从未听过的流派和子流派。</p><p id="4d7b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">随着 Spotify 等流媒体服务使用机器学习算法推出个性化歌曲推荐，发现新音乐也变得前所未有的简单。作为一名听众，第一次听到一首歌并沉浸在一种新的风格中是最令人愉快的部分。发现自己在一个有趣的兔子洞，异想天开地添加越来越多的歌曲到您保存的歌曲。可能会导致 Spotify 图书馆混乱无序。</p><p id="2e49" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该项目探索了机器学习算法的应用，使用 Spotify 的音频分析对给定歌曲的流派进行识别和分类。允许用户按流派自动组织他们的图书馆。</p><p id="e10a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这个项目的所有代码可以在这里找到:【https://github.com/towenwolf/genre-classification T4】</p><h1 id="1eb1" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">数据集</h1><p id="6095" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">包含 7 个独特的电子舞曲类别的 21，000 首歌曲的音频分析:tech house，techno，trance，psy-trance，trap，drum &amp; bass 和 hardstyle。这些歌曲是从 136 个用户创建的播放列表中收集来的，来自可靠的来源，如经过验证的唱片公司和官方 Spotify 播放列表。</p><p id="03f7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了获得数据集，我在 python 上编写了一个脚本，从 Spotify 的开发者应用程序获取凭证，读取播放列表的 csv 文件，检索播放列表中每首歌曲的音频特征，并创建一个按流派标记的歌曲数据框。该脚本还删除了任何重复的，低于 50 bpm 的低节奏歌曲，以及超过 16 分钟的歌曲。最终的数据集随机抽取了每个类别的 3000 首歌曲进行分析。</p><p id="380c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">数据帧的每一行代表一首歌曲，列是歌曲的<a class="ae ky" href="https://developer.spotify.com/documentation/web-api/reference/tracks/get-audio-analysis/" rel="noopener ugc nofollow" target="_blank">音频特征</a>测量:</p><p id="5c6a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">声学</strong> —一首歌曲是纯声学的还是合成的概率。歌曲的录音将具有接近 1 的值。</p><p id="ddb9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">乐器性</strong> —一首歌不含人声的概率。纯器乐歌曲的值会更接近 1。</p><p id="1e26" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">语音度</strong> —一首歌只包含语音的概率。朗读单词轨道和声乐简介的值将接近 1。</p><p id="8d03" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">可跳性</strong> —一首歌的可跳性从 0 到 1 不等。</p><p id="50d9" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">活跃度</strong> —检测录像中是否有观众，范围从 0 到 1。</p><p id="83d7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">价</strong>——一首歌的意境。听起来快乐的歌曲值接近 1，听起来悲伤的歌曲值接近 0。</p><p id="96f6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">能量</strong> —强度和活动的感知度量。高能轨道感觉起来很快，很响，很嘈杂，接近 1。</p><p id="7c70" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> Key </strong> —估计的轨道整体 Key。</p><p id="4a21" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">响度</strong> —音轨的整体响度，单位为分贝(dB)。</p><p id="fb52" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> Mode </strong> —表示一个音轨的模态(大调或小调)，大调用 1 表示，小调为 0。</p><p id="1f1c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">速度</strong> —轨道的总体估计速度，单位为每分钟节拍数(BPM)。</p><p id="e06f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">拍号</strong> —一个音轨的估计整体拍号。</p><p id="35bf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">持续时间</strong> —音轨的持续时间，单位为毫秒(ms)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="ms mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">获取 _ 数据笔记本</p></figure><p id="cb33" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用 Spotify 的 API 来构建数据集而不是分析原始音频的优点是节省时间和计算能力，尤其是在大型数据集的情况下。要了解如何使用 Spotify 的 API，请查看这篇文章。</p><h1 id="db7e" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">探索性数据分析</h1><p id="87d4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了找到有助于按流派对歌曲进行分类的特征，我们应该听听它们之间的差异……一些歌曲比其他的快/慢吗？因为我们没有时间去听数据集中的每一首歌。让我们通过查看每种风格的速度分布直方图来直观地检查差异。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/7aaaa348527d9cfbda80a61c82e6bd82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ajjq5znGd2NEX0feErygg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 1:歌曲速度</p></figure><p id="748f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们看到一些节奏较低的歌曲，特别是陷阱、鼓和贝斯以及硬派风格的歌曲。我怀疑音频分析返回的是半场节奏，而不是全程节奏。这不是问题，考虑到中场休息在音乐上是正确的。只是换个角度看每分钟打多少拍，只数第一和第三个四分音符而不是一、二、三、四。比如一首 140 bpm 的歌，半场就 70 bpm 了，这对于某些流派来说很常见。为了解决这个问题，我编写了一个函数，将任何作为半场时间返回的速度更改为全时时间，以保持数据的一致性。</p><p id="0547" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当使用用户创建的播放列表时，我们遇到的另一个潜在问题是将不属于该流派的歌曲添加到播放列表中，导致错误标记的观察。例如，用户可能错误地将一首说唱歌曲放在了家庭播放列表中。查看技术宅节奏的描述统计，我们可以看到最小值和最大值远远高于和低于平均值。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="7d12" class="na la it mw b gy nb nc l nd ne">techhouse<br/>count    3509.000000<br/>mean      124.917453<br/>std         2.845667<br/>min        95.075000<br/>25%       123.995000<br/>50%       124.995000<br/>75%       125.998000<br/>max       217.009000</span></pre><p id="81a1" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这些远离平均节奏的数据点告诉我们，它们实际上并不属于科技流派。如果我们像这样给算法错误标记的观察值，它会导致分类器正确预测的问题。因此，为了解决这个问题，我根据阿贝尔顿的音乐制作章节中关于<a class="ae ky" href="https://learningmusic.ableton.com/make-beats/tempo-and-genre.html" rel="noopener ugc nofollow" target="_blank">节奏</a>的内容，用流派的<em class="nf">已知</em>节奏为数据设置了一个阈值。</p><h2 id="bec3" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated">类型的速度范围</h2><ul class=""><li id="71da" class="nr ns it lt b lu lv lx ly ma nt me nu mi nv mm nw nx ny nz bi translated">配音:60-90 BPM</li><li id="19bf" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated">嘻哈音乐:60-100 次/分钟</li><li id="2633" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated">房价:每分钟 115 至 130 美元</li><li id="cb9c" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated">技术/催眠:120-140 次/分钟</li><li id="b245" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated">dubstep:135–145 BPM</li><li id="4a91" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated">鼓和贝斯:160–180 BPM</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/8f2b29fe355573b88807e823bf098259.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q2x8m-Qlkg_rkj0lV9L6dA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 2:调整半场/用户错误后的歌曲速度</p></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/e54b4f3d958189de085de3fd8c8fc90f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*G7U5yYR_ahJB0NU_Qkzjhw.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 3:按流派的节奏统计</p></figure><p id="358e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在对用户的错误进行调整并将半拍节奏改为全拍节奏后，流派节奏的分布显示出围绕其均值和等方差的单峰结构。从统计学上讲，数据具有这些特征是很重要的，因为许多算法使用假设正态性的线性模型。这意味着在预测一首歌曲的风格时，节奏会有很大的分量。</p><p id="3aa5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在，除了速度，还有什么其他音频分析功能可以帮助预测正确的流派？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/f83b5be32551be0f08b14fb0df5e2c90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xp4g3T3ZTh00Ss7ORZj26w.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 4–15:音频分析特征直方图</p></figure><p id="b4d2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你看一下可跳舞性的直方图(图 7)，我们会发现技术宅和电子乐平均来说比所有其他流派更“适合跳舞”。这并不奇怪，豪斯和泰克诺以他们的高帽和掌声让舞者们点头而闻名。数据的结构是正常的，并且类型的平均值彼此不同，表明这将是另一个有助于分类的特征。</p><p id="c411" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">观察歌曲整体响度的差异(图 12)也给了我们一些对流派差异的洞察。陷阱，鼓&amp;低音和 hardstyle 都是以非常高的分贝录制的，揭示了这些流派在扬声器上可以输出的强度和力量。听这些流派的时候不要把耳机开得太大。</p><p id="64b5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">歌曲的持续时间(图 15)也在它可能属于的流派中起作用。Psy-trance 和 techno 歌曲比其他类型的歌曲长得多，75%以上的数据在每首 6-15 分钟之间。</p><p id="54ec" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">不适合分析的突出特征是调、调式和拍号，这些都是与歌曲的音乐性相关的分类特征。它们可能在以后的分析中有用，但对于本项目，它们将从要素选择中移除。</p><h1 id="ebb8" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">训练机器学习分类器</h1><p id="fa00" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了训练分类模型，我们需要将数据分成特征和标签。使用来自 sklearn 的标签编码器对类型标签进行编码。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="9db7" class="na la it mw b gy nb nc l nd ne">X = data[features].copy()<br/>y = LabelEncoder().fit_transform(data[‘genre’])</span></pre><h2 id="b615" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated">列车测试分离</h2><p id="d3d5" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">然后使用 sklearn 的 train_test_split 将数据分成训练集和验证集，随机将数据分成 80/20%的块，用于训练和验证分类器。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="026b" class="na la it mw b gy nb nc l nd ne">X_train, X_test = train_test_split(X, test_size=0.2, random_state=98)<br/>y_train, y_test = train_test_split(y, test_size=0.2, random_state=98)</span></pre><h2 id="7b38" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated"><em class="oh">数据预处理</em></h2><p id="5713" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用 sklearn 的 MinMaxScaler，所有的特征将被转换为 0 到 1 之间的相同比例。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="3feb" class="na la it mw b gy nb nc l nd ne">scaler = MinMaxScaler()<br/>scaler.fit(X_train)</span><span id="d884" class="na la it mw b gy oi nc l nd ne">X_train = pd.DataFrame(scaler.transform(X_train), columns = X.columns)<br/>X_test = pd.DataFrame(scaler.transform(X_test), columns = X.columns)</span></pre><h2 id="7093" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated">分类器</h2><p id="b335" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">既然数据准备好了，分类器就要被训练并预测每种类型的概率。分类器是一种算法或“机器”,它使用统计数据来输出一个数学模型，该模型与我们输入的数据相匹配。允许我们预测有用的东西，比如一首歌是什么类型的！在本文中，我们不打算深入研究每一种算法的数学原理，但会提供一个简短的解释，说明是什么使这些分类算法成为这个用例的候选算法。</p><h2 id="04aa" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated">逻辑回归</h2><p id="c27c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">是一个线性数学模型，通常用于二元分类。在这种情况下，我们有 7 个类别，并将实施 One vs Rest 方法，该方法将训练 7 个单独的模型，概率最高的一个将是预测的类别。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="1102" class="na la it mw b gy nb nc l nd ne"># Train logistic regression model<br/>logreg = LogisticRegression(penalty='l2', max_iter=10000, multi_class='ovr')<br/>logreg.fit(X_train, y_train)</span><span id="1a7f" class="na la it mw b gy oi nc l nd ne"># Probabilities of each genre<br/>logreg_probs = logreg.predict_proba(X_test)</span></pre><h2 id="1ab4" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated">随机森林</h2><p id="c0c7" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">是适合许多决策树分类器的集成分类器。使用 sklearn 的 GridSearchCV 找到了最佳参数。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="2353" class="na la it mw b gy nb nc l nd ne"># Train random forest model with optimal parameters<br/>rf = RandomForestClassifier(max_depth=25, min_samples_leaf=1, min_samples_split=5, n_estimators=1200)<br/>rf.fit(X_train, y_train)</span><span id="a766" class="na la it mw b gy oi nc l nd ne"># Probabilities of each genre <br/>rf_probs = rf.predict_proba(X_test)</span></pre><h2 id="14c5" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated">XGBoost</h2><p id="2d53" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Boosting 是另一种通过组合多个弱学习器(如决策树)获得的集成分类器。使用 sklearn 的 GridSearchCV 找到了最佳参数。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="59c3" class="na la it mw b gy nb nc l nd ne"># Train model with optimal parameters<br/>xgb = XGBClassifier(max_depth=5, learning_rate=0.1, objective='multi:softprob', n_estimators=500, sub_sample = 0.8, num_class = len(genres))<br/>xgb.fit(X_train, y_train)</span><span id="1799" class="na la it mw b gy oi nc l nd ne"># Probabilities of each genre<br/>xgb_probs = xgb.predict_proba(X_test)</span></pre><h2 id="b5ac" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated">SVM</h2><p id="e8ff" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">经典的分类算法，常用于二元分类。就像逻辑回归一样，将使用一对其余的方法。</p><pre class="kj kk kl km gt mv mw mx my aw mz bi"><span id="3d84" class="na la it mw b gy nb nc l nd ne"># Train model with optimal parameters<br/>svm = SVC(gamma='auto', probability=True)<br/>svm.fit(X_train, y_train)</span><span id="e075" class="na la it mw b gy oi nc l nd ne"># Probabilities of each genre<br/>svm_probs = svm.predict_proba(X_test)</span></pre><h1 id="6010" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">评估分类模型</strong></h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/7a7a743dd9ea54cd4d968808a3c9a47d.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*Vg42y2Z90_R4lv_1fyALFA.png"/></div></figure><h2 id="0df4" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated"><em class="oh">逻辑回归</em></h2><p id="7034" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">准确率:84%</p><p id="9181" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">F1 得分:0.84</p><p id="badb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">ROC AUC: 0.974</p><p id="5079" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">墙壁时间:543 毫秒</p><p id="9053" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">对于一个简单的分类器来说还不错，预测最正确的类型是技术宅和 psy-trance。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/3b4953e044ac2445d4d4e974c6eaa77a.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*Tkm1TqpdiJ3ARtBJqSkVzw.png"/></div></figure><h2 id="d43e" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated"><em class="oh">随机森林</em></h2><p id="ef3d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">准确率:93%</p><p id="ea99" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">F1 得分:0.93</p><p id="2e04" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">ROC AUC: 0.994</p><p id="c0ee" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">挂壁时间:40.6 秒</p><p id="1e96" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">随机森林的表现明显更好。建议决策树分类器是使用该数据进行分类的好方法。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/7e4d827b2fe5c5319efd0befee0a0fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*rGOi_R2TydmsCiji0DRPpw.png"/></div></figure><h2 id="ff30" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated"><em class="oh"> XGBoost </em></h2><p id="19d9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">准确率:93%</p><p id="a0b3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">F1 得分:0.93</p><p id="22a7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">ROC AUC: 0.994</p><p id="ac4d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">挂壁时间:52.2 秒</p><p id="53b8" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">得分几乎与 random forest 完全相同，只是在预测上有微小的变化。预测的准确性有一个清晰的结构。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/e15972f7100139d19b04d3df2e7b4e14.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*pvFX2DzmmwCvaKWZ_9AFdA.png"/></div></figure><h2 id="c9f8" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated"><em class="oh">支持向量机</em></h2><p id="e1de" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">准确率:88%</p><p id="8f7a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">F1 得分:0.88</p><p id="560b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">ROC AUC: 0.986</p><p id="e66b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">挂壁时间:16.1 秒</p><p id="a10b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">除了电子音乐和硬派音乐之外，大多数音乐类型都有相对较高的准确度。错误地预测了两者的关系。</p><h2 id="68ba" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated">受试者工作特征曲线</h2><p id="76d8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">评估分类器算法性能的另一种方法。说明了特异性和敏感性的权衡，曲线下面积越大，预测越准确。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/6f024ba1905d769d21be9caf23cb3bae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lsq6LkxpIbm2gCQCPUuKzg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图 20:分类器的 ROC 曲线</p></figure><p id="40f5" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">XGBoost 和 Random forest 算法在预测歌曲类型方面表现最佳。在对技术宅进行分类时，所有算法都表现良好，在所有分类器上都具有近乎完美的准确性。一些 techno 的例子经常与 hardstyle 混淆，反之亦然，也是 psy-trance 的陷阱。这表明这些流派之间的差异可能比音频特征能够检测到的更微妙。</p><h2 id="9bd7" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated">讨论</h2><p id="87e6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">Random Forest 和 XGBoost 的性能在大规模自动分类流派的能力方面都很有前途。能够根据音频分析的特征来确定一首歌曲的流派，可以帮助听众组织他们的图书馆或推荐类似的歌曲。</p><p id="7b72" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">但最终，真正让每种音乐风格独一无二的是它在聆听时激发的感觉和情感。自己听一听，这里有分析中使用的 Spotify 播放列表的链接。</p><ul class=""><li id="495d" class="nr ns it lt b lu mn lx mo ma ol me om mi on mm nw nx ny nz bi translated"><a class="ae ky" href="https://open.spotify.com/playlist/7AUqarp6W3pf0tVFrRvzZw?si=HcQlT3iPSPGRseRFOOJcCg" rel="noopener ugc nofollow" target="_blank">技术宅</a></li><li id="6455" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated"><a class="ae ky" href="https://open.spotify.com/playlist/37i9dQZF1DX6J5NfMJS675?si=cm_V6tw4TmmZZd--LRNbWw" rel="noopener ugc nofollow" target="_blank">泰克诺</a></li><li id="521a" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated"><a class="ae ky" href="https://open.spotify.com/playlist/37i9dQZF1DX91oIci4su1D?si=6HrdgfzHQy-KkSjXAV7aXg" rel="noopener ugc nofollow" target="_blank">恍惚</a></li><li id="55db" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated"><a class="ae ky" href="https://open.spotify.com/playlist/37i9dQZF1DWXWbLEOaHnU3?si=MuWeSFtxQLSYkMpzCAT06Q" rel="noopener ugc nofollow" target="_blank">精神恍惚</a></li><li id="4ded" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated"><a class="ae ky" href="https://open.spotify.com/playlist/6Sr742m2alGaGfmqf9uweW?si=NywOUTIPRdi3lPPKofACZw" rel="noopener ugc nofollow" target="_blank">陷阱/低音音乐</a></li><li id="8550" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated"><a class="ae ky" href="https://open.spotify.com/playlist/56Dq7bAWZ6aXfGnYHqPtm3?si=Voex0bGdQbCZFQ6HCzwPLw" rel="noopener ugc nofollow" target="_blank">硬质风格</a></li><li id="17b9" class="nr ns it lt b lu oa lx ob ma oc me od mi oe mm nw nx ny nz bi translated"><a class="ae ky" href="https://open.spotify.com/playlist/6qkFoVGCjhrfQzHZ153fG8?si=qCKuXepvThiw1nTnDOXLkw" rel="noopener ugc nofollow" target="_blank">鼓&amp;贝斯</a></li></ul><p id="0a13" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">接下来，我想找到算法有效分类一个流派的最少歌曲数量。这样一来，流派数量的规模就可以包括大量的小众流派。如果某个流派有足够多的播放列表，那么分类器甚至能够预测最狂野的流派，比如俄罗斯波尔卡硬核音乐(见下文)。所以，走出去，做一些你最喜欢的类型的公共播放列表。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oo mt l"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">Gif 由 Ohmagif.com 的未知</p></figure><h2 id="15f3" class="na la it bd lb ng nh dn lf ni nj dp lj ma nk nl ll me nm nn ln mi no np lp nq bi translated">参考</h2><div class="op oq gp gr or os"><a href="https://arxiv.org/abs/1804.01149" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">使用机器学习技术的音乐流派分类</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">在音乐信息检索领域，根据音乐文件的类型对其进行分类是一项具有挑战性的任务</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">arxiv.org</p></div></div></div></a></div><div class="op oq gp gr or os"><a href="https://medium.com/@maxtingle/getting-started-with-spotifys-api-spotipy-197c3dc6353b" rel="noopener follow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">开始使用 Spotify 的 API &amp; Spotipy</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">《数据科学家快速入门指南》,指导如何浏览 Spotify 的 Web API 并使用 Spotipy Python 访问数据…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">medium.com</p></div></div><div class="pb l"><div class="pc l pd pe pf pb pg ks os"/></div></div></a></div><div class="op oq gp gr or os"><a href="https://learningmusic.ableton.com/make-beats/tempo-and-genre.html" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">节奏和风格</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">一首音乐的风格(或流派)是由许多因素决定的，包括声音的类型和…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">learningmusic.ableton.com</p></div></div><div class="pb l"><div class="ph l pd pe pf pb pg ks os"/></div></div></a></div><div class="op oq gp gr or os"><a href="https://spotipy.readthedocs.io/en/2.9.0/" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">欢迎来到 Spotipy！- spotipy 2.0 文档</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">Spotipy 是 Spotify Web API 的轻量级 Python 库。有了 Spotipy，您可以完全访问所有音乐…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">spotipy.readthedocs.io</p></div></div><div class="pb l"><div class="pi l pd pe pf pb pg ks os"/></div></div></a></div><div class="op oq gp gr or os"><a rel="noopener follow" target="_blank" href="/making-your-own-discover-weekly-f1ac7546fedb"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">制作自己的 Spotify Discover 每周播放列表</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">每周一醒来我都很兴奋。在你认为我是那种喜欢每天去上课的怪人之前…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">towardsdatascience.com</p></div></div><div class="pb l"><div class="pj l pd pe pf pb pg ks os"/></div></div></a></div><div class="op oq gp gr or os"><a href="https://stackoverflow.com/questions/39086287/spotipy-how-to-read-more-than-100-tracks-from-a-playlist" rel="noopener  ugc nofollow" target="_blank"><div class="ot ab fo"><div class="ou ab ov cl cj ow"><h2 class="bd iu gy z fp ox fr fs oy fu fw is bi translated">Spotipy:如何从一个播放列表中读取超过 100 首曲目</h2><div class="oz l"><h3 class="bd b gy z fp ox fr fs oy fu fw dk translated">感谢贡献一个堆栈溢出的答案！请务必回答问题。提供详细信息并分享…</h3></div><div class="pa l"><p class="bd b dl z fp ox fr fs oy fu fw dk translated">stackoverflow.com</p></div></div><div class="pb l"><div class="pk l pd pe pf pb pg ks os"/></div></div></a></div></div></div>    
</body>
</html>