# è·Ÿä¸Šè´èŒ¨

> åŸæ–‡ï¼š<https://towardsdatascience.com/keeping-up-with-the-berts-5b7beb92766?source=collection_archive---------12----------------------->

## NLP é•‡æœ€å—æ¬¢è¿çš„å®¶åº­

![](img/354c3f6ca741d99f2e8ddeece93d6856.png)

è±æ˜‚çº³å¤šÂ·å¤§ä¹…ä¿ä¿Šéƒåœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ç…§ç‰‡

å¦‚æœä½ ç¨å¾®å…³æ³¨ä¸€ä¸‹ NLP ä¸–ç•Œï¼Œæˆ–è€…ç”šè‡³æ˜¯ ML æ–°é—»ï¼Œä½ æœ€æœ‰å¯èƒ½é‡åˆ° Google çš„ BERT æ¨¡å‹æˆ–è€…å®ƒçš„ä¸€ä¸ªäº²æˆšã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰å¹¶ä¸”ä»ç„¶å¶ç„¶çœ‹åˆ°è¿™ç¯‡æ–‡ç« ï¼Œé‚£ä¹ˆè®©æˆ‘è£å¹¸åœ°å‘æ‚¨ä»‹ç» BERTâ€”â€”å¼ºå¤§çš„ NLP æ€ªå…½ã€‚

# ä¼¯ç‰¹æ˜¯ä»€ä¹ˆï¼Ÿ

BERT ä»£è¡¨***B****I directional****E****n coder****R****è¡¨ç¤ºæ¥è‡ª****T****transformers*ï¼Œæ˜¯ Google çš„ä¸€ä¸ªè¯­è¨€è¡¨ç¤ºæ¨¡å‹ã€‚å®ƒä½¿ç”¨ä¸¤ä¸ªæ­¥éª¤ï¼Œé¢„è®­ç»ƒå’Œå¾®è°ƒï¼Œä¸ºå¹¿æ³›çš„ä»»åŠ¡åˆ›å»ºæœ€å…ˆè¿›çš„æ¨¡å‹ã€‚

å®ƒä¸ä¼—ä¸åŒçš„ç‰¹ç‚¹æ˜¯è·¨ä¸åŒä¸‹æ¸¸ä»»åŠ¡çš„ç»Ÿä¸€æ¶æ„â€”â€”è¿™äº›æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬å°†å¾ˆå¿«è®¨è®ºã€‚è¿™æ„å‘³ç€ç›¸åŒçš„é¢„è®­ç»ƒæ¨¡å‹å¯ä»¥é’ˆå¯¹å„ç§æœ€ç»ˆä»»åŠ¡è¿›è¡Œå¾®è°ƒï¼Œè¿™äº›æœ€ç»ˆä»»åŠ¡å¯èƒ½ä¸è®­ç»ƒçš„ä»»åŠ¡æ¨¡å‹ä¸ç›¸ä¼¼ï¼Œå¹¶ç»™å‡ºæ¥è¿‘æœ€å…ˆè¿›çš„ç»“æœã€‚

![](img/e7be39e8160ec25a76fee59ad2b1304d.png)

BERT ç”±ä¸¤ä¸ªæ­¥éª¤ç»„æˆã€‚æ¥æº:[è®ºæ–‡](https://arxiv.org/abs/1810.04805)ã€‚

æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬é¦–å…ˆåœ¨é¢„è®­ç»ƒä»»åŠ¡ä¸ŠåŒæ—¶è®­ç»ƒæ¨¡å‹ã€‚ä¸€æ—¦é¢„è®­ç»ƒå®Œæˆï¼ŒåŒä¸€æ¨¡å‹å¯ä»¥é’ˆå¯¹å„ç§ä¸‹æ¸¸ä»»åŠ¡è¿›è¡Œå¾®è°ƒã€‚è¯·æ³¨æ„ï¼Œå•ç‹¬çš„æ¨¡å‹é’ˆå¯¹ç‰¹å®šçš„ä¸‹æ¸¸ä»»åŠ¡è¿›è¡Œäº†å¾®è°ƒã€‚å› æ­¤ï¼Œå•ä¸ªé¢„è®­ç»ƒæ¨¡å‹å¯ä»¥åœ¨å¾®è°ƒåç”Ÿæˆå¤šä¸ªä¸‹æ¸¸ä»»åŠ¡ç‰¹å®šæ¨¡å‹ã€‚

# ä¼¯ç‰¹å»ºç­‘

ç®€å•æ¥è¯´å°±æ˜¯ ***ä¸€å †å˜å‹å™¨çš„ç¼–ç å™¨*** ã€‚ä½ å¯ä»¥åœ¨[æˆ‘ä¹‹å‰çš„æ–‡ç« ](/transformers-89034557de14)ä¸­è¯¦ç»†äº†è§£å˜å½¢é‡‘åˆšã€‚æˆ–è€…ï¼Œå¦‚æœä½ å·²ç»å¯¹å®ƒæœ‰äº†ä¸€äº›æ¨¡ç³Šçš„æƒ³æ³•ï¼Œè¯·æŸ¥çœ‹[è¿™ä¸ª](https://peltarion.com/knowledge-center/documentation/modeling-view/build-an-ai-model/blocks/bert-encoder)ç»å¯¹æ˜¯ BERT ä¸­ä½¿ç”¨çš„ç¼–ç å™¨å—çš„ 3D ç‚¸å¼¹å›¾ã€‚è¯´çœŸçš„ï¼Œä½ ä¸èƒ½é”™è¿‡è¿™ä¸ªï¼

[](/transformers-89034557de14) [## å˜å½¢é‡‘åˆš(ç”µå½±å)

### æˆ–è€…æˆ‘å–œæ¬¢ç§°ä¹‹ä¸ºç±»å›ºé†‡å¼•èµ·çš„æ³¨æ„ã€‚ğŸ’‰ğŸ’Š

towardsdatascience.com](/transformers-89034557de14) 

ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€äº›æˆ‘ä»¬éƒ½ä¸ä¼šè®°å¾—çš„æ•°å­—ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰å®ƒä»¬ï¼Œæˆ‘ä»¬çš„ç†è§£ä¼šæ„Ÿåˆ°ä¸å®Œæ•´ï¼Œæ‰€ä»¥è¿™é‡Œä»€ä¹ˆéƒ½ä¸è¯´:

**L** =å±‚æ•°(å³å †æ ˆä¸­çš„#ä¸ªå˜æ¢å™¨ç¼–ç å™¨å—)ã€‚
**H** =éšè—å¤§å°(å³ *qï¼Œk* å’Œ *v* å‘é‡çš„å¤§å°)ã€‚
**A** =å…³æ³¨å¤´æ•°ã€‚

*   ***ä¼¯ç‰¹åŸº*** : L=12ï¼ŒH=768ï¼ŒA=12ã€‚
    æ€»å‚æ•°=110Mï¼
*   ***ä¼¯ç‰¹å¤§å·*** : L=24ï¼ŒH=1024ï¼ŒA=16ã€‚
    æ€»å‚æ•°=340Mï¼ï¼

## ä»€ä¹ˆä½¿å¾—å®ƒæ˜¯åŒå‘çš„ï¼Ÿ

æˆ‘ä»¬é€šå¸¸é€šè¿‡åœ¨ä¸€äº›ä¸ç›¸å…³çš„ä»»åŠ¡ä¸Šè®­ç»ƒå®ƒæ¥åˆ›å»ºè¯­è¨€æ¨¡å‹ï¼Œä½†æ˜¯è¿™äº›ä»»åŠ¡æœ‰åŠ©äºå¼€å‘å¯¹æ¨¡å‹ä¸­å•è¯çš„ä¸Šä¸‹æ–‡ç†è§£ã€‚è¿™ç§ä»»åŠ¡é€šå¸¸åŒ…æ‹¬é¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯æˆ–å½¼æ­¤éå¸¸æ¥è¿‘çš„å•è¯ã€‚è¿™ç§è®­ç»ƒæ–¹æ³•ä¸èƒ½æ‰©å±•å¹¶ç”¨äºåŒå‘æ¨¡å‹ï¼Œå› ä¸ºå®ƒä¼šè®©æ¯ä¸ªå•è¯é—´æ¥â€œçœ‹åˆ°è‡ªå·±â€â€”â€”å½“ä½ ä»ç›¸åçš„æ–¹å‘å†æ¬¡æ¥è¿‘åŒä¸€ä¸ªå¥å­æ—¶ï¼Œä½ å·²ç»çŸ¥é“ä¼šå‘ç”Ÿä»€ä¹ˆäº†ã€‚ä¸€ä¸ªæ•°æ®æ³„éœ²çš„æ¡ˆä¾‹ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¨¡å‹å¯ä»¥è½»æ˜“åœ°é¢„æµ‹ç›®æ ‡å•è¯ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¸èƒ½ä¿è¯è¯¥æ¨¡å‹ï¼Œå¦‚æœç»è¿‡å®Œå…¨è®­ç»ƒï¼Œåœ¨æŸç§ç¨‹åº¦ä¸Šå·²ç»å­¦ä¼šäº†å•è¯çš„ä¸Šä¸‹æ–‡å«ä¹‰ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸“æ³¨äºä¼˜åŒ–çç¢çš„é¢„æµ‹ã€‚

é‚£ä¹ˆä¼¯ç‰¹æ˜¯å¦‚ä½•åšåˆ°åŒå‘é¢„è®­ç»ƒçš„å‘¢ï¼Ÿå®ƒé€šè¿‡ä½¿ç”¨ä¸€ä¸ªç§°ä¸ºå±è”½ LM çš„è¿‡ç¨‹æ¥å®ç°è¿™ä¸€ç‚¹ã€‚ç¨åä¼šæœ‰æ›´å¤šçš„ç»†èŠ‚ï¼Œæ‰€ä»¥è¯·ç»§ç»­è¯»ä¸‹å»ï¼Œæˆ‘çš„æœ‹å‹ã€‚

# é¢„è®­ç»ƒä¼¯ç‰¹

BERT æ¨¡å‹åœ¨ä»¥ä¸‹ä¸¤ä¸ªæ— ç›‘ç£çš„ä»»åŠ¡ä¸Šè¢«è®­ç»ƒã€‚

## 1.æ©è”½è¯­è¨€æ¨¡å‹(MLM)

æ­¤ä»»åŠ¡å¯ç”¨æ¨¡å‹çš„æ·±åº¦åŒå‘å­¦ä¹ æ–¹é¢ã€‚åœ¨æ­¤ä»»åŠ¡ä¸­ï¼Œéšæœºå±è”½(ç”¨[*MASK*token æ›¿æ¢)ä¸€å®šç™¾åˆ†æ¯”çš„è¾“å…¥æ ‡è®°ï¼Œæ¨¡å‹å°è¯•é¢„æµ‹è¿™äº›å±è”½çš„æ ‡è®°ï¼Œè€Œä¸æ˜¯æ•´ä¸ªè¾“å…¥åºåˆ—ã€‚ç„¶åï¼Œæ¥è‡ªè¯¥æ¨¡å‹çš„é¢„æµ‹æ ‡è®°è¢«é¦ˆé€åˆ°è¯æ±‡è¡¨ä¸Šçš„è¾“å‡º softmax ä¸­ï¼Œä»¥è·å¾—æœ€ç»ˆçš„è¾“å‡ºå•è¯ã€‚

ç„¶è€Œï¼Œè¿™åœ¨é¢„è®­ç»ƒå’Œå¾®è°ƒä»»åŠ¡ä¹‹é—´äº§ç”Ÿäº†ä¸åŒ¹é…ï¼Œå› ä¸ºåè€…åœ¨å¤§å¤šæ•°ä¸‹æ¸¸ä»»åŠ¡ä¸­ä¸æ¶‰åŠé¢„æµ‹å±è”½è¯ã€‚è¿™é€šè¿‡æˆ‘ä»¬å¦‚ä½•å±è”½è¾“å…¥ä»¤ç‰Œçš„å¾®å¦™å˜åŒ–å¾—ä»¥ç¼“è§£ã€‚

å¤§çº¦ 15%çš„å•è¯åœ¨è®­ç»ƒæ—¶è¢«å±è”½ï¼Œä½†æ˜¯æ‰€æœ‰è¢«å±è”½çš„å•è¯éƒ½ä¸ä¼šè¢«[*MASK*token æ›¿æ¢ã€‚

*   80%çš„æ—¶é—´ç”¨[ *å±è”½*ä»¤ç‰Œã€‚
*   10%çš„æ—¶å€™ç”¨éšæœºä»£å¸ã€‚
*   10%çš„æ—¶é—´ï¼Œæœªæ”¹å˜çš„è¾“å…¥ä»¤ç‰Œè¢«å±è”½ã€‚

## 2.ä¸‹ä¸€å¥é¢„æµ‹(NSP)

LM å¹¶ä¸ç›´æ¥æ•æ‰ä¸¤ä¸ªå¥å­ä¹‹é—´çš„å…³ç³»ï¼Œè€Œè¿™ç§å…³ç³»åœ¨è®¸å¤šä¸‹æ¸¸ä»»åŠ¡ä¸­æ˜¯ç›¸å…³çš„ï¼Œä¾‹å¦‚[é—®ç­”(QA)å’Œè‡ªç„¶è¯­è¨€æ¨ç†(NLI)](/evaluation-of-an-nlp-model-latest-benchmarks-90fd8ce6fae5) ã€‚é€šè¿‡å¯¹äºŒå€¼åŒ– NSP ä»»åŠ¡çš„è®­ç»ƒï¼Œè¯¥æ¨¡å‹è¢«æ•™å¯¼å¥å­å…³ç³»ã€‚

åœ¨è¿™ä¸ªä»»åŠ¡ä¸­ï¼Œé€‰æ‹©äº†ä¸¤ä¸ªå¥å­â€”â€”A å’Œ Bâ€”â€”è¿›è¡Œé¢„è®­ç»ƒã€‚

*   50%çš„æ—¶é—´ B å®é™…ä¸Šæ˜¯ a åé¢çš„ä¸‹ä¸€å¥è¯ã€‚
*   50%çš„æ—¶é—´ B æ˜¯ä»è¯­æ–™åº“ä¸­éšæœºæŠ½å–çš„å¥å­ã€‚

## åŸ¹è®­â€”â€”è¾“å…¥å’Œè¾“å‡ºã€‚

è¯¥æ¨¡å‹åŒæ—¶åœ¨ä¸Šè¿°ä¸¤ä¸ªä»»åŠ¡ä¸Šè¢«è®­ç»ƒã€‚è¿™æ˜¯é€šè¿‡è¾“å…¥å’Œè¾“å‡ºçš„å·§å¦™è¿ç”¨è€Œæˆä¸ºå¯èƒ½çš„ã€‚

## è¾“å…¥

![](img/527599e41dcfbc09dd35d874634c037c.png)

ä¼¯ç‰¹çš„è¾“å…¥è¡¨ç¤ºã€‚æ¥æº:[è®ºæ–‡](https://arxiv.org/abs/1810.04805)ã€‚

è¯¥æ¨¡å‹éœ€è¦æ¥å—å•ä¸ªå¥å­æˆ–æ˜ç¡®æ‰“åŒ…åœ¨ä¸€ä¸ªæ ‡è®°åºåˆ—ä¸­çš„ä¸¤ä¸ªå¥å­çš„è¾“å…¥ã€‚ä½œè€…æ³¨æ„åˆ°â€œå¥å­â€å¯ä»¥æ˜¯è¿ç»­æ–‡æœ¬çš„ä»»æ„è·¨åº¦ï¼Œè€Œä¸æ˜¯å®é™…çš„è¯­è¨€å¥å­ã€‚ä¸€ä¸ª[SEP]æ ‡è®°ç”¨äºåˆ†éš”ä¸¤ä¸ªå¥å­ï¼Œä»¥åŠä½¿ç”¨ä¸€ä¸ªå­¦ä¹ è¿‡çš„ç‰‡æ®µåµŒå…¥æ¥æŒ‡ç¤ºä¸€ä¸ªæ ‡è®°ä½œä¸ºç‰‡æ®µ A æˆ– b çš„ä¸€éƒ¨åˆ†ã€‚

*é—®é¢˜#1:* æ‰€æœ‰çš„è¾“å…¥éƒ½æ˜¯åœ¨ä¸€ä¸ªæ­¥éª¤ä¸­é¦ˆå…¥çš„â€”â€”ä¸é¡ºåºé¦ˆå…¥è¾“å…¥çš„ RNNs ç›¸åï¼Œæ¨¡å‹ ***ä¸èƒ½ä¿æŒè¾“å…¥ä»¤ç‰Œçš„æ’åº*** ã€‚æ¯ç§è¯­è¨€çš„è¯åºéƒ½å¾ˆé‡è¦ï¼Œæ— è®ºæ˜¯è¯­ä¹‰ä¸Šè¿˜æ˜¯å¥æ³•ä¸Šã€‚

*é—®é¢˜#2:* ä¸ºäº†æ­£ç¡®æ‰§è¡Œä¸‹ä¸€ä¸ªå¥å­é¢„æµ‹ä»»åŠ¡ï¼Œæˆ‘ä»¬éœ€è¦èƒ½å¤Ÿ ***åŒºåˆ†å¥å­ A å’Œ B*** ã€‚å›ºå®šå¥å­çš„é•¿åº¦å¯èƒ½é™åˆ¶å¤ªå¤šï¼Œå¹¶ä¸”æ˜¯å„ç§ä¸‹æ¸¸ä»»åŠ¡çš„æ½œåœ¨ç“¶é¢ˆã€‚

è¿™ä¸¤ä¸ªé—®é¢˜éƒ½æ˜¯é€šè¿‡å‘æˆ‘ä»¬çš„åŸå§‹ä»¤ç‰Œæ·»åŠ åŒ…å«æ‰€éœ€ä¿¡æ¯çš„åµŒå…¥å¹¶å°†ç»“æœç”¨ä½œæˆ‘ä»¬çš„ BERT æ¨¡å‹çš„è¾“å…¥æ¥è§£å†³çš„ã€‚ä»¥ä¸‹åµŒå…¥è¢«æ·»åŠ åˆ°ä»¤ç‰ŒåµŒå…¥ä¸­:

*   ***ç‰‡æ®µåµŒå…¥*** :å®ƒä»¬æä¾›äº†ç‰¹å®šæ ‡è®°æ‰€å±å¥å­çš„ä¿¡æ¯ã€‚
*   ***ä½ç½®åµŒå…¥*** :å®ƒä»¬æä¾›äº†å•è¯åœ¨è¾“å…¥ä¸­çš„é¡ºåºä¿¡æ¯ã€‚

## è¾“å‡º

å¦‚ä½•åŒæ—¶é¢„æµ‹ä¸¤ä¸ªä¸åŒä»»åŠ¡çš„äº§å‡ºï¼Ÿç­”æ¡ˆæ˜¯é€šè¿‡ä½¿ç”¨ä¸åŒçš„ FFNN + Softmax å±‚ï¼Œè¯¥å±‚å»ºç«‹åœ¨æ¥è‡ªæœ€åä¸€ä¸ªç¼–ç å™¨çš„è¾“å‡ºçš„é¡¶éƒ¨ï¼Œå¯¹åº”äºæœŸæœ›çš„è¾“å…¥ä»¤ç‰Œã€‚æˆ‘ä»¬å°†æœ€åä¸€ä¸ªç¼–ç å™¨çš„è¾“å‡ºç§°ä¸ºæœ€ç»ˆçŠ¶æ€ã€‚

ç¬¬ä¸€ä¸ªè¾“å…¥ä»¤ç‰Œæ€»æ˜¯ä¸€ä¸ªç‰¹æ®Šåˆ†ç±»*ã€CLSã€‘*ä»¤ç‰Œã€‚å¯¹åº”äºè¯¥ä»¤ç‰Œçš„æœ€ç»ˆçŠ¶æ€è¢«ç”¨ä½œåˆ†ç±»ä»»åŠ¡çš„èšé›†åºåˆ—è¡¨ç¤ºï¼Œå¹¶è¢«ç”¨äºä¸‹ä¸€å¥é¢„æµ‹ï¼Œå…¶ä¸­å®ƒè¢«é¦ˆé€åˆ°é¢„æµ‹æ ‡ç­¾â€œ *IsNext* æˆ–â€œ *NotNext* â€çš„æ¦‚ç‡çš„ FFNN + Softmax å±‚ã€‚

å¯¹åº”äº[ *MASK* ] tokens çš„æœ€ç»ˆçŠ¶æ€è¢«è¾“å…¥ FFNN+Softmaxï¼Œä»¥ä»æˆ‘ä»¬çš„è¯æ±‡è¡¨ä¸­é¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯ã€‚

# å¾®è°ƒä¼¯ç‰¹

é€šè¿‡äº¤æ¢é€‚å½“çš„è¾“å…¥æˆ–è¾“å‡ºï¼Œå¯ä»¥å¯¹å„ç§ä¸‹æ¸¸ä»»åŠ¡è¿›è¡Œå¾®è°ƒã€‚åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸ºäº†è®­ç»ƒç‰¹å®šäºä»»åŠ¡çš„æ¨¡å‹ï¼Œæˆ‘ä»¬å‘ç°æœ‰çš„ BERT æ·»åŠ ä¸€ä¸ªé¢å¤–çš„è¾“å‡ºå±‚ï¼Œå¹¶å¯¹ç»“æœæ¨¡å‹è¿›è¡Œå¾®è°ƒâ€”â€”æ‰€æœ‰å‚æ•°ï¼Œç«¯åˆ°ç«¯ã€‚å¢åŠ è¾“å…¥/è¾“å‡ºå±‚è€Œä¸æ”¹å˜ BERT æ¨¡å‹çš„ä¸€ä¸ªç§¯æç»“æœæ˜¯ï¼Œåªéœ€è¦ä»å¤´å¼€å§‹å­¦ä¹ æœ€å°‘æ•°é‡çš„å‚æ•°ï¼Œä½¿å¾—è¿‡ç¨‹å¿«é€Ÿã€æˆæœ¬å’Œèµ„æºé«˜æ•ˆã€‚

ä¸ºäº†è®©ä½ äº†è§£å®ƒçš„é€Ÿåº¦å’Œæ•ˆç‡ï¼Œä½œè€…å£°ç§°ï¼Œä»å®Œå…¨ç›¸åŒçš„é¢„è®­ç»ƒæ¨¡å‹å¼€å§‹ï¼Œè®ºæ–‡ä¸­çš„æ‰€æœ‰ç»“æœåœ¨*å•äº‘ TPU* ä¸Šæœ€å¤šå¯ä»¥åœ¨*1 å°æ—¶*å†…å¤åˆ¶ï¼Œåœ¨ GPU ä¸Šæœ€å¤šå¯ä»¥åœ¨*å‡ å°æ—¶å†…å¤åˆ¶ã€‚*

![](img/914db5d7c90c535151c8397aa638f68a.png)

åœ¨å„ç§ä¸‹æ¸¸ä»»åŠ¡ä¸Šå¾®è°ƒ BERTã€‚æ¥æº:[è®ºæ–‡](https://arxiv.org/abs/1810.04805)ã€‚

åœ¨å¥å­å¯¹åˆ†ç±»å’Œå•å¥åˆ†ç±»ä¸­ï¼Œå¯¹åº”äº[ *CLS* è®°å·çš„æœ€ç»ˆçŠ¶æ€è¢«ç”¨ä½œè¿›è¡Œé¢„æµ‹çš„é™„åŠ å±‚çš„è¾“å…¥ã€‚

åœ¨ QA ä»»åŠ¡ä¸­ï¼Œåœ¨å¾®è°ƒæœŸé—´å¼•å…¥äº†å¼€å§‹(S)å’Œç»“æŸ(E)å‘é‡ã€‚é—®é¢˜ä½œä¸ºå¥å­ A è¾“å…¥ï¼Œç­”æ¡ˆä½œä¸ºå¥å­ b è¾“å…¥ã€‚å•è¯ *i* ä½œä¸ºç­”æ¡ˆåŒºé—´å¼€å§‹çš„æ¦‚ç‡è®¡ç®—ä¸º T *i* (å¯¹åº”äºç¬¬ *i* ä¸ªè¾“å…¥æ ‡è®°çš„æœ€ç»ˆçŠ¶æ€)å’Œ S(å¼€å§‹å‘é‡)ä¹‹é—´çš„ç‚¹ç§¯ï¼Œåé¢æ˜¯æ®µè½ä¸­æ‰€æœ‰å•è¯çš„ softmaxã€‚ç«¯è·¨é‡‡ç”¨ç±»ä¼¼çš„æ–¹æ³•ã€‚
ä»ä½ç½® *i* åˆ°ä½ç½® *j* çš„å€™é€‰åŒºé—´çš„å¾—åˆ†å®šä¹‰ä¸º S T *i* + E T *j* ï¼Œä»¥ *j* â‰¥ *i* çš„æœ€å¤§å¾—åˆ†åŒºé—´ä½œä¸ºé¢„æµ‹

# GPTâ€”â€”è¿œæˆ¿è¡¨äº²

ä¼¯ç‰¹æ˜¯äº§ç”Ÿè¿™äº›çªç ´æ€§æˆæœçš„å”¯ä¸€æ¨¡å‹å—ï¼Ÿä¸æ˜¯ã€‚OpenAI çš„å¦ä¸€ä¸ªæ¨¡å‹ï¼Œå«åš GPTï¼Œå·²ç»åœ¨ç½‘ä¸Šå¼•èµ·äº†è½°åŠ¨ã€‚

ä½†æ˜¯å¾ˆå¤šäººæ²¡æœ‰æ„è¯†åˆ°è¿™ä¸¤ä¸ªæ¨¡å‹æœ‰ä¸€ä¸ªå…±åŒç‚¹ï¼Œé‚£å°±æ˜¯è¿™ä¸¤ä¸ªæ¨¡å‹éƒ½é‡ç”¨äº†ä¸€ä¸ª Transformer ç»„ä»¶ã€‚å¦‚å‰æ‰€è¿° **BERT å°†å˜å‹å™¨çš„ç¼–ç å™¨éƒ¨åˆ†**ä½œä¸ºå…¶æ„å»ºæ¨¡å—ã€‚åŒæ—¶ï¼Œ **GPT ä½¿ç”¨å˜å‹å™¨çš„è§£ç å™¨éƒ¨åˆ†**ä½œä¸ºå…¶æ„å»ºæ¨¡å—ã€‚

![](img/0a9cd8deebf7597ef151389b28fe67ae.png)

æ¥æº:[è®ºæ–‡ã€‚](https://arxiv.org/abs/1810.04805)

è¯·æ³¨æ„ï¼Œç”±äºç¼–ç å™¨çš„åŒå‘è‡ªæˆ‘å…³æ³¨ï¼ŒBERT ä¸­çš„åŒå‘è¿æ¥ã€‚ä¸æ­¤åŒæ—¶ï¼ŒGPT çš„è¿æ¥åªæ˜¯å•å‘çš„ï¼Œä»å·¦åˆ°å³ï¼Œç”±äºè§£ç å™¨çš„è®¾è®¡é˜²æ­¢æŸ¥çœ‹æœªæ¥çš„é¢„æµ‹â€”â€”æ›´å¤šä¿¡æ¯è¯·å‚è€ƒ[å˜å½¢é‡‘åˆš](/transformers-89034557de14)ã€‚

# ä¼¯ç‰¹ä¸€å®¶

å¦‚æœæˆ‘ä»¬ä¸æŠŠä¸€äº›å·¥ä½œå¾—å¾ˆå¥½çš„ä¸œè¥¿æ‹¿æ¥ï¼Œå¹¶è¯•å›¾é‡æ–°åˆ›é€ æˆ–ä¿®æ”¹å®ƒï¼Œé‚£å°±ä¸æ˜¯ 21 ä¸–çºªäº†ã€‚ä¼¯ç‰¹å»ºç­‘ä¹Ÿä¸ä¾‹å¤–ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›æœ€æµè¡Œçš„å˜ä½“:

*   [**é˜¿å°”ä¼¯ç‰¹**](https://arxiv.org/abs/1909.11942) ç”±è°·æ­Œå’Œæ›´å¤š-æœ¬æ–‡æè¿°äº†å‚æ•°å‡å°‘æŠ€æœ¯ï¼Œä»¥é™ä½å†…å­˜å‡å°‘å’Œæé«˜ BERT æ¨¡å‹çš„è®­ç»ƒé€Ÿåº¦ã€‚
*   [**ç½—ä¼¯å¡”**](https://arxiv.org/abs/1907.11692) è„¸ä¹¦â€”â€”æœ¬æ–‡è®¤ä¸ºæœ€åˆçš„ BERT æ¨¡å‹è®­ç»ƒä¸è¶³ï¼Œå¹¶è¡¨æ˜ç»è¿‡æ›´å¤šçš„è®­ç»ƒ/è°ƒæ•´ï¼Œå®ƒå¯ä»¥è¶…è¶Šæœ€åˆçš„ç»“æœã€‚
*   [**ERNIE**](https://arxiv.org/abs/1904.09223) :ç™¾åº¦é€šè¿‡çŸ¥è¯†æ•´åˆå¢å¼ºè¡¨ç¤ºâ€”â€”å— BERT æ©è”½ç­–ç•¥å¯å‘ï¼Œå­¦ä¹ é€šè¿‡çŸ¥è¯†æ©è”½ç­–ç•¥å¢å¼ºçš„è¯­è¨€è¡¨ç¤ºï¼ŒåŒ…æ‹¬å®ä½“çº§æ©è”½å’ŒçŸ­è¯­çº§æ©è”½ã€‚
*   [**è’¸é¦ä¼¯ç‰¹**](https://arxiv.org/abs/1910.01108)â€”â€”ä½¿ç”¨ Huggingface æ¨¡å‹è’¸é¦çš„è¾ƒå°ä¼¯ç‰¹ã€‚

ä½ å¯ä»¥åœ¨ [the GLUE æ’è¡Œæ¦œ](https://gluebenchmark.com/leaderboard)æŸ¥çœ‹æ›´å¤šä¼¯ç‰¹é£æ ¼çš„æ¨¡ç‰¹ã€‚

# ç»“è®º

1.  BERT æ˜¯ä¸€ä¸ªå †å å˜å‹å™¨çš„ç¼–ç å™¨æ¨¡å‹ã€‚
2.  å®ƒæœ‰ä¸¤ä¸ªé˜¶æ®µâ€”â€”é¢„è®­ç»ƒå’Œå¾®è°ƒã€‚
3.  é¢„è®­ç»ƒæ˜¯è®¡ç®—å’Œæ—¶é—´å¯†é›†å‹çš„ã€‚
4.  ç„¶è€Œï¼Œå®ƒç‹¬ç«‹äºå®ƒæœ€ç»ˆå®Œæˆçš„ä»»åŠ¡ï¼Œå› æ­¤ç›¸åŒçš„é¢„è®­ç»ƒæ¨¡å‹å¯ä»¥ç”¨äºè®¸å¤šä»»åŠ¡ã€‚
5.  GPT å’Œä¼¯ç‰¹æ²¡ä»€ä¹ˆä¸åŒï¼Œæ˜¯ä¸€ä¸ªå †å å˜å‹å™¨çš„è§£ç å™¨æ¨¡å‹ã€‚
6.  ä¼¯ç‰¹æœ‰è®¸å¤šå˜ç§ã€‚

# å‚è€ƒæ–‡çŒ®+æ¨èé˜…è¯»

*   [å˜å‹å™¨](/transformers-89034557de14)â€”â€”å¦‚æœæ‚¨æƒ³æ›´æ·±å…¥åœ°äº†è§£ä¸Šè¿°ç¼–ç å™¨/è§£ç å™¨æ¶æ„ã€‚
*   è®ºæ–‡â€”â€”å¾ˆå®¹æ˜“é˜…è¯»ï¼Œè€Œä¸”ä»–ä»¬ä¹Ÿç¨å¾®é˜è¿°äº†ä¸€äº›å®é™…çš„ç»†èŠ‚ã€‚å€¼å¾—ä¸€è¯»ã€‚
*   [æ°ä¼ŠÂ·é˜¿æ‹‰ç›çš„åšå®¢](http://jalammar.github.io/illustrated-bert/)ã€‚
*   [å®˜æ–¹ GitHub å›è´­ã€‚](https://github.com/google-research/bert)
*   [æ›´å¤š BERT è½¦å‹](/2019-year-of-bert-and-transformer-f200b53d05b9)ã€‚

> æˆ‘å¾ˆé«˜å…´ä½ åšæŒåˆ°è¿™ç¯‡æ–‡ç« ç»“æŸã€‚ğŸ‰æˆ‘å¸Œæœ›ä½ çš„é˜…è¯»ä½“éªŒå’Œæˆ‘å†™è¿™ç¯‡æ–‡ç« æ—¶ä¸€æ ·ä¸°å¯Œã€‚ğŸ’–
> 
> *å°½è¯·æŸ¥çœ‹æˆ‘çš„å…¶ä»–æ–‡ç« * [*è¿™é‡Œ*](https://medium.com/@ria.kulshrestha16) *ã€‚*
> 
> *å¦‚æœä½ æƒ³è”ç³»æˆ‘ï¼Œæˆ‘ä¼šé€‰æ‹©*[*Twitter*](https://twitter.com/ree_____ree)*ã€‚*