<html>
<head>
<title>1+1=? Better decision-making when causal inference meets machine learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">1+1=?当因果推理遇到机器学习时更好的决策</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/1-1-better-decision-making-when-causal-inference-meets-machine-learning-bd3b00d8286b?source=collection_archive---------46-----------------------#2020-04-27">https://towardsdatascience.com/1-1-better-decision-making-when-causal-inference-meets-machine-learning-bd3b00d8286b?source=collection_archive---------46-----------------------#2020-04-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="931f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">双机器学习:使用机器学习(ML)方法估计因果效应的一般框架</h2></div><p id="0ed6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">近年来，机器学习已经应用于不同的领域，如在线营销和商务，个性化医疗和数据驱动的政策制定。这一巨大的成功使得人们对自主系统做出正确决策的期望越来越高。公司经常使用经典的机器学习工具来解决决策问题，例如在哪里定价，或者营销活动以哪些客户为目标。这引发了当今机器学习的主要挑战之一，即理解<strong class="kh ir">因果</strong>联系。</p><h1 id="d83e" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">决策问题需要因果关系</h1><p id="e634" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">要做出数据驱动的决策，对因果关系的理解是关键。这里有一个来自我们日常业务的简单例子:<strong class="kh ir">价格弹性。</strong>为产品设定最优价格，公司需要知道在不同(假设)价格水平下会卖多少，这就是需求的价格弹性。</p><p id="069c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你是一个ML从业者，一个经典的ML算法，以价格水平作为一个特征来预测销售结果，可能是你的首选。然而，在实践中，这种方法不能简单地给出价格对销售的因果影响。下面的情节展示了“为什么”——<em class="ly">预测和因果推理是截然不同的(尽管密切相关)问题。(Athey，2017，第484页)</em>左手边，是预测问题，我们在寻找价格和数量的相关性。在右边，虚线是反事实，即如果我改变价格，给定产品的销售额是多少。尽管有积极的联系，因果关系是负面的。如果我们提高价格，数量就会减少。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi lz"><img src="../Images/1eef4bec935ea1895f47411b247edf80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HSEe62UXIVnxYAL3ktl4tQ.png"/></div></div><p class="ml mm gj gh gi mn mo bd b be z dk translated">预测(左)与因果推理</p></figure><p id="41f6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如上面的例子和许多其他例子在<a class="ae mp" href="https://science.sciencemag.org/content/355/6324/483" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> Athey，S. (2017)中描述的那样。超越预测:使用大数据解决政策问题。科学335，483–485</strong></a><strong class="kh ir">，</strong>机器学习模型不是为了估计因果关系而建立的。应用机器学习的现成预测方法会导致对因果影响的有偏估计。另一方面，传统的因果推理需要对模型的函数形式进行强有力的假设。如果我们错误地指定了函数形式，我们最终会得到有偏差的估计。因此，可以修改现有的机器学习技术，以利用机器学习的优势从数据中学习条件期望函数的形式——双机器学习<strong class="kh ir">的诞生</strong>！</p><h1 id="1db2" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated"><strong class="ak">两全其美的通用框架</strong></h1><p id="923e" class="pw-post-body-paragraph kf kg iq kh b ki lt jr kk kl lu ju kn ko lv kq kr ks lw ku kv kw lx ky kz la ij bi translated">有许多研究人员在因果机器学习领域开发方法。我对双机学习特别感兴趣，因为它的通用性和简单性。它可以与惩罚方法、神经网络、树算法和集成方法结合使用，并且易于操作。让我告诉你这有多简单:</p><p id="ace0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设我们有几组具有重要特性X的产品，我们用P来表示价格，Y是需求响应(销售)。我们然后:</p><ol class=""><li id="a43d" class="mq mr iq kh b ki kj kl km ko ms ks mt kw mu la mv mw mx my bi translated">在X上回归Y，并计算Y与模型中Y的预测值之间的差值(即残差)，我们称之为Y_res。</li><li id="f4a2" class="mq mr iq kh b ki mz kl na ko nb ks nc kw nd la mv mw mx my bi translated">我们类似地回归X上的P，并计算P_res，即P与模型中P的预测值之间的差值。</li><li id="a680" class="mq mr iq kh b ki mz kl na ko nb ks nc kw nd la mv mw mx my bi translated">最后，我们在P_res上回归Y _ RES。P _ RES上的结果系数是P对Y的因果效应的点估计。</li></ol><p id="860a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了得到一个公正的估计。你需要在每个步骤中应用交叉拟合。更具体地说，您应该:1)将您的数据随机划分为两个子集2)在第一个子集中拟合两个ML模型3)使用我们在第一个子集中拟合的模型估计第二个子集中的系数4)检查1到3，但在每个步骤中翻转子集5)平均系数，这将是无偏估计</p><p id="c5c0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这不是简单明了吗？！如果你仍然对如何实现它没有信心，我推荐一个很棒的python包，叫做<a class="ae mp" href="https://github.com/microsoft/EconML" rel="noopener ugc nofollow" target="_blank"> econML </a>。它包含了许多前沿的因果机器学习作品，double ML就是其中之一。以下是该包的代码片段:</p><pre class="ma mb mc md gt ne nf ng nh aw ni bi"><span id="7659" class="nj lc iq nf b gy nk nl l nm nn"><br/>est = LinearDMLCateEstimator(model_y=MultiTaskElasticNetCV(cv=3, tol=1, selection='random'),<br/>                             model_t=MultiTaskElasticNetCV(cv=3),<br/>                             featurizer=PolynomialFeatures(1),<br/>                             linear_first_stages=<strong class="nf ir">True</strong>)<br/>est.fit(Y, T, X, W)<br/>te_pred = est.const_marginal_effect(X_test)</span><span id="60f0" class="nj lc iq nf b gy no nl l nm nn"># Reference: <a class="ae mp" href="https://github.com/microsoft/EconML/blob/master/notebooks/Double%20Machine%20Learning%20Examples.ipynb" rel="noopener ugc nofollow" target="_blank">https://github.com/microsoft/EconML/blob/master/notebooks/Double%20Machine%20Learning%20Examples.ipynb</a></span></pre><p id="1b6b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其中Y是结果，T是治疗，X是特征，W是共同创始人。这个包可以让你把不同的机器学习模型嵌入到它的double ML类中，超级方便。</p><p id="48f1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我介绍了因果关系和机器学习的一些基本概念。此外，我还引入了一个广义ML框架来估计因果效应。您可以将这种方法应用到您的工作或其他数据科学项目中，以帮助您获得最佳控制，从而更快地获得正确答案。</p><p id="6a8d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我计划分享更多关于这种方法的理论，这样你就能更好地理解为什么以及如何推进这种方法。</p><h1 id="a9a0" class="lb lc iq bd ld le lf lg lh li lj lk ll jw lm jx ln jz lo ka lp kc lq kd lr ls bi translated">参考:</h1><ol class=""><li id="04d1" class="mq mr iq kh b ki lt kl lu ko np ks nq kw nr la mv mw mx my bi translated"><a class="ae mp" href="https://www.microsoft.com/en-us/research/project/alice/" rel="noopener ugc nofollow" target="_blank">爱丽丝(因果关系和经济学的自动学习和智能)——微软研究院</a></li><li id="61cf" class="mq mr iq kh b ki mz kl na ko nb ks nc kw nd la mv mw mx my bi translated"><a class="ae mp" href="https://arxiv.org/abs/1712.04802" rel="noopener ugc nofollow" target="_blank">对随机实验中异质治疗效果的一般机器学习推断</a></li></ol></div></div>    
</body>
</html>