<html>
<head>
<title>Hierarchical Performance Metrics and Where to Find Them</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分层性能指标以及在哪里可以找到它们</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hierarchical-performance-metrics-and-where-to-find-them-7090aaa07183?source=collection_archive---------21-----------------------#2020-08-26">https://towardsdatascience.com/hierarchical-performance-metrics-and-where-to-find-them-7090aaa07183?source=collection_archive---------21-----------------------#2020-08-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f4d5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何衡量你的层次分类模型的性能？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/83cb405f953ecf2f2f8d8d45307bc1d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KXYrygY53DVi7uWC"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">考尔德 B 在 Unsplash 上拍摄的照片</p></figure><p id="a885" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">分层机器学习模型是一个顶级技巧。正如在 <a class="ae lr" rel="noopener" target="_blank" href="/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382">之前的</a> <a class="ae lr" rel="noopener" target="_blank" href="/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc">帖子</a>中所讨论的<a class="ae lr" rel="noopener" target="_blank" href="/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076">，在设计我们的模型时考虑数据的自然分类是非常值得的。我们能够使用它们，使我们的模型更智能、更准确，而不是变平并忽略那些内部层次。</a></p><p id="c025" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">“更准确”，我说——然而，他们是吗？我们怎么知道？毕竟，我们是从事科学的人，我们期望大胆的主张能得到数据的支持。这就是为什么我们有性能指标。无论是精确度、f1 分数，还是我们关注的任何其他可爱的指标——如果在我们的模型中使用层次提高了它们的性能，指标应该显示出来。</p><p id="be1f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">问题是，如果我们使用常规的性能指标(为平面、一级分类设计的指标)，我们又会忽略数据的自然分类。</p><p id="062a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我们做等级制度，那就一路做下去。如果我们决定庆祝我们的数据的分类，并按照它的形象构建我们的模型，这也需要成为衡量其性能的一部分。</p><p id="5cb3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们如何做到这一点？答案就在下面。</p><h1 id="b219" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">在我们开始之前</h1><p id="82a2" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">这篇文章是关于测量为分层分类设计的机器学习模型的性能。它假设你知道所有这些单词的意思。如果没有，查看一下<a class="ae lr" rel="noopener" target="_blank" href="/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076">我的</a> <a class="ae lr" rel="noopener" target="_blank" href="/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382">之前的</a> <a class="ae lr" rel="noopener" target="_blank" href="/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc">帖子</a>上的话题。尤其是<a class="ae lr" rel="noopener" target="_blank" href="/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076">介绍主题</a>的那个。真的。在学习如何测量之前，你会想知道什么是等级分类。这是一个很明显的问题。</p><p id="c8f4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这篇文章中，我将根据常见宠物的分类给出一些例子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/6c555107f25b98fcef5b96502e35d70a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z68UG1eIK9GASUEb1nSbzg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">常见家养宠物的分类。我的邻居刚刚收养了最可爱的小飞马。</p></figure><h1 id="1125" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">哦，这么多指标</h1><p id="5143" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">因此，我们已经有了一整套层次结构的局部分类器，随时准备执行我们的命令。我们如何评价他们？</p><p id="5e02" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这不是一个微不足道的问题，解决办法也不明显。正如我们在本系列前面的问题中看到的，不同的项目需要不同的处理方式。最佳指标可能会有所不同，这取决于项目的具体要求和限制。</p><p id="8bea" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">总而言之，主要有三种选择。让我们介绍他们，好吗？</p><p id="0545" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">参赛者们，带着他们所有的优雅和荣耀:</p><h2 id="bb50" class="mq lt iq bd lu mr ms dn ly mt mu dp mc le mv mw me li mx my mg lm mz na mi nb bi translated">实际的一个:平面分类度量</h2><p id="273d" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">这些都是我们都知道并喜爱的分类指标(精确度、召回率、f 值——你能想到的),应用起来…嗯，很简单。</p><p id="495e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">与最初的“扁平分类”方法相同(在本系列的<a class="ae lr" rel="noopener" target="_blank" href="/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076">第一篇文章中有所描述)，这种方法完全忽略了层级。只考虑最终的叶节点预测(在我们的家养宠物例子中，这些是特定的品种)，它们都被认为是平等的类，没有对兄弟类和非兄弟类的任何特殊处理。</a></p><p id="be28" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这种方法很简单，但显然不理想。我们不希望不同等级的错误以同样的方式受到惩罚(如果我把飞马误认为独角鲸，那还不如误认为拉布拉多来得糟糕)。此外，没有一种明显的方法来处理最终预测不是叶节点预测的情况——如果您实现了前面提到的<a class="ae lr" rel="noopener" target="_blank" href="/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc"> <strong class="kx ir">置信阻塞</strong> </a> <strong class="kx ir"> </strong>方法，这种情况肯定会发生。</p><h2 id="2e84" class="mq lt iq bd lu mr ms dn ly mt mu dp mc le mv mw me li mx my mg lm mz na mi nb bi translated">潮人一号:定制尺码</h2><p id="2476" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">不满意平坦的指标，并感觉到指尖有创意的火花？您可以想象出您自己的特殊度量，它特别适合您独特的用例雪花。</p><p id="d8b3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当模型需要适应一些不寻常的业务约束时，这可能是有用的。例如，如果你真的不在乎错误地将狗识别为独角兽，但 Sphynx 猫必须被正确地发现或完全失控，你可以相应地设计你的度量标准，给不同的错误或多或少的权重。</p><h2 id="c996" class="mq lt iq bd lu mr ms dn ly mt mu dp mc le mv mw me li mx my mg lm mz na mi nb bi translated">自命不凡的一个:常规分类指标的特定于层次的变体</h2><p id="b964" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">这些都是众所周知的精度，召回和 f 分数指标的变化，特别是适应分层分类。</p><p id="86a5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">请原谅我在你的大致方向上抛出一些数学符号:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/03916849077c1429c64fdb913772f4ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2hhRmQx9KnUB3muTBqE5iA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">分别定义了层次精度(hP)、层次召回率(hR)和层次 f-measure (hF)。</p></figure><p id="2521" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，这一切意味着什么呢？</p><p id="d80f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> Pi </strong>是由每个测试实例 I 的<strong class="kx ir">预测的</strong>最具体的类(或多个类，在多标签问题的情况下)及其所有祖先类组成的集合；<strong class="kx ir"> Ti </strong>是由测试例 I 的<strong class="kx ir">真</strong>最特定类及其所有祖先类组成的集合；当然，每个总和是在所有测试集示例上计算的<strong class="kx ir">。</strong></p><p id="8334" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这一个有点难解开，所以如果你发现自己困惑，检查一下附录，在那里我会更详细地解释。</p><p id="82de" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，如果您已经用<strong class="kx ir">非强制叶节点预测</strong>实现了您的模型(意味着预测的最具体级别不一定是最深的级别)，那么需要进行一些调整；我不会在这里深入探讨，但是如果你想了解更多，请告诉我。</p><h1 id="00fd" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">哪个指标是最佳匹配？</h1><p id="dc54" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">永恒的问题。正如我之前提到的，没有一个显而易见的答案，但这里有我自己对这个问题的想法:</p><ul class=""><li id="f6d8" class="nd ne iq kx b ky kz lb lc le nf li ng lm nh lq ni nj nk nl bi translated"><strong class="kx ir"> Flat </strong> <strong class="kx ir"> metrics: </strong>这是一个足够简单的方法，但是它丢失了层次结构信息，如果您首先经历了构建层次集成模型的麻烦，您可能会认为这些信息很重要。<em class="nm">我建议只对那些超快超脏的项目使用扁平指标，因为时间限制是一个很大的因素。</em></li><li id="253b" class="nd ne iq kx b ky nn lb no le np li nq lm nr lq ni nj nk nl bi translated"><strong class="kx ir">定制的、独特的指标:</strong>可能更合适，但你要付出时间和努力。此外，由于您将使用未经同行评审的指标，您可能会错过一些重要的东西。只有当手头的项目有非常独特的需求，并且在评估模型性能时应该考虑到这些需求时，我才会推荐定制的度量标准。</li><li id="d92a" class="nd ne iq kx b ky nn lb no le np li nq lm nr lq ni nj nk nl bi translated"><strong class="kx ir">常见分类指标的层次版本:</strong>这种方法有些直观(一旦你掌握了它的窍门)，对于一个层次模型来说很有意义。然而，它可能不是最适合您自己的用例(例如，没有为最深类的正确/错误预测增加权重——这在某些用例中可能很重要)。它还需要一些额外的实现时间。总而言之，我认为这是一个足够好的预制解决方案，应该是大多数项目的首选。</li></ul><h1 id="1eb5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">最后</h1><p id="83ab" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">没有性能指标，机器学习模型什么都不是，分层模型需要它们自己的特殊照顾。没有一个最好的方法来度量基于层次的分类:不同的方法各有利弊，每个项目都有自己最适合的方法。如果您已经做到了这一步，那么您很有希望知道哪种方法最适合您的方法，并且一旦您开始使用它，现在就可以测量您的模型了。</p><p id="f9dc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这篇文章总结了我关于层次分类模型的四篇系列文章。如果您已经阅读了所有这些内容，那么您应该拥有设计、构建和衡量一个出色的层次分类项目所需的所有工具。我希望你尽可能充分利用它。</p></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><p id="f2a6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="nm">该系列的前几篇文章:</em></p><ol class=""><li id="927f" class="nd ne iq kx b ky kz lb lc le nf li ng lm nh lq nz nj nk nl bi translated"><a class="ae lr" rel="noopener" target="_blank" href="/https-medium-com-noa-weiss-the-hitchhikers-guide-to-hierarchical-classification-f8428ea1e076"> <em class="nm">分层分类</em> </a></li><li id="4dc1" class="nd ne iq kx b ky nn lb no le np li nq lm nr lq nz nj nk nl bi translated"><a class="ae lr" rel="noopener" target="_blank" href="/hierarchical-classification-with-local-classifiers-down-the-rabbit-hole-21cdf3bd2382"> <em class="nm">用局部分类器进行分层分类:下兔子洞</em> </a></li><li id="367f" class="nd ne iq kx b ky nn lb no le np li nq lm nr lq nz nj nk nl bi translated"><a class="ae lr" rel="noopener" target="_blank" href="/hierarchical-classification-by-local-classifiers-your-must-know-tweaks-tricks-f7297702f8fc"> <em class="nm">通过局部分类器进行层次分类:你的必知妙招&amp;招数</em> </a></li></ol></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><p id="dc1d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Noa Weiss 是一名人工智能机器学习顾问，总部位于特拉维夫。 </p></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><h1 id="6702" class="ls lt iq bd lu lv oa lx ly lz ob mb mc jw oc jx me jz od ka mg kc oe kd mi mj bi translated">附录</h1><p id="2bbf" class="pw-post-body-paragraph kv kw iq kx b ky mk jr la lb ml ju ld le mm lg lh li mn lk ll lm mo lo lp lq ij bi translated">搞不清那些讨厌的等级指标？我是来帮忙的。</p><p id="0170" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在下面的表格中，我回顾了“普通家养宠物”层次模型的模拟结果，<strong class="kx ir">查看了“大麦町”类的度量</strong>(记住:精确度、召回率和 f 分数度量是按类计算的，将标签(预测的和真实的)视为二进制)。</p><p id="91c4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我看了几个例子，检查了每个例子对精确度和召回分数的贡献。记住——最终的精确/回忆分数是所有这些例子的总和。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/1be0113c48f121cb0a9ab37982beace1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LhX_q5UtpljO4vo8F8Veew.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">一次揭开一只狗的层级指标的神秘面纱。</p></figure><p id="bb11" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="nm">评论举例</em> </strong>:</p><ol class=""><li id="256f" class="nd ne iq kx b ky kz lb lc le nf li ng lm nh lq nz nj nk nl bi translated"><em class="nm">将一个不同的品种错误地归类为一只斑点狗:召回得满分(因为“狗”的部分被正确识别)，但精确度只有半分(因为“狗”是正确的，但预测的“斑点狗”标签是错误的)。召回不会受到负面影响，因为此处遗漏的“拉布拉多”标签不属于此处测量的[狗、斑点狗]类别。</em></li><li id="cade" class="nd ne iq kx b ky nn lb no le np li nq lm nr lq nz nj nk nl bi translated">将独角鲸错误分类为斑点狗——精确度为零(因为“狗”和“斑点狗”预测标签都是错误的)，但召回指标不受影响，因为真正的独角鲸标签与[狗，斑点狗]类别的测量无关。</li><li id="b907" class="nd ne iq kx b ky nn lb no le np li nq lm nr lq nz nj nk nl bi translated"><em class="nm">完美预测——预测和回忆都加分。</em></li><li id="aa3c" class="nd ne iq kx b ky nn lb no le np li nq lm nr lq nz nj nk nl bi translated"><em class="nm">将一只达尔马提亚狗错误地归类为不同的品种:精确度指标得满分(因为“狗”分类器是两个分类器中唯一正确的)，但召回率只有半分(因为“狗”标签被正确识别，但“达尔马提亚”标签被遗漏)。</em></li><li id="b19c" class="nd ne iq kx b ky nn lb no le np li nq lm nr lq nz nj nk nl bi translated">一只达尔马提亚狗被误归类为彩虹独角兽:召回率为 0(因为狗和达尔马提亚狗的标签都被遗漏了)，但精确度分数不受影响。</li><li id="6b82" class="nd ne iq kx b ky nn lb no le np li nq lm nr lq nz nj nk nl bi translated"><em class="nm">这个例子没有告诉我们任何关于狗/斑点狗分类器的表现，所以它不影响分数是显而易见的。</em></li></ol></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><p id="41ba" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="nm">资料来源</em> : C.N. Silla &amp; A.A. Freitas，<a class="ae lr" href="https://link.springer.com/article/10.1007/s10618-010-0175-9" rel="noopener ugc nofollow" target="_blank"> <em class="nm">跨不同应用领域的层次分类综述</em> </a> <em class="nm"> </em> (2011)，<em class="nm">数据挖掘与知识发现</em>，22(1–2):182–196</p></div></div>    
</body>
</html>