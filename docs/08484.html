<html>
<head>
<title>M5 Forecasting- Accuracy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">M5预测-准确性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/m5-forecasting-accuracy-24d7f42130de?source=collection_archive---------15-----------------------#2020-06-20">https://towardsdatascience.com/m5-forecasting-accuracy-24d7f42130de?source=collection_archive---------15-----------------------#2020-06-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="98ee" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用Xgboost、Catboost、Lightgbm进行预测比较</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/03cb531229f42cb71f4f22461c377752.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*q8XrLJePG4SXB9bP"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@jamie452?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">杰米街</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><h1 id="028c" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">介绍</h1><p id="33ec" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><em class="mk">在本博客中，使用R对M5竞争数据进行探索性数据分析，使用</em> Xgboost、Catboost、Lightgbm、<em class="mk">和</em>脸书预言家<em class="mk">预测28天的销量。通过比较</em> SMAPE误差率<em class="mk">和</em>一个标准误差规则<strong class="lq ir">来选择最佳模型。</strong></p><h2 id="7e25" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">竞争背景:</h2><p id="b6f1" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir"> Makridakis竞赛</strong>(也称为<em class="mk"> M竞赛</em>)是由预测研究员Spyros Makridakis领导的团队组织的一系列公开竞赛，旨在评估和比较不同预测方法的准确性。名为M-Competition的第一次比赛是在1982年举行的，当时只有1001个数据点，模型的复杂性和数据规模随着每次连续迭代而增加。</p><p id="20e9" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">比赛链接:<a class="ae kv" href="https://www.kaggle.com/c/m5-forecasting-accuracy" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/c/m5-forecasting-accuracy</a></p><h2 id="80c8" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">目标:</h2><p id="f8ed" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">今年3月(2020年)，第五届迭代命名为M5竞赛举行。本次m5竞赛旨在预测未来28天(即截至2016年5月22日)的日销售额，并对这些预测进行不确定性估计。在这篇博客中，我只是要做预测，不确定性将在我的下一篇博客中用最佳选择的模型进行。</p><h2 id="52d4" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">数据集:</h2><p id="1270" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">所提供的数据集包含来自沃尔玛的42，840个分层销售数据。该数据集涵盖了美国三个州(加利福尼亚州、德克萨斯州和威斯康星州)的商店，包括从2011年1月29日到2016年4月24日这五年的商品级别、部门、产品类别和商店详细信息。此外，它还有解释变量，如价格、快照事件、星期几以及特殊事件和节日。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/00a8123513c4a9a8fb4e489eb269632e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lPCqY7i6GRRx_eirsSov-Q.jpeg"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd nd">图1:M5系列数据组织方式概述</strong></p></figure><p id="72dc" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">该数据包括在3个州的10家商店销售的3大类7个部门的3049件产品。分层聚合捕获了这些因素的组合，这使得执行自下而上的方法或自上而下的方法变得可行。例如，我们可以为所有销售创建一个时间序列，或者分别为每个州执行，等等。</p><h1 id="788c" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">假设</h1><p id="c8f3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">根据给出的数据，可能影响销售的一些因素如下:</p><ol class=""><li id="52e5" class="ne nf iq lq b lr mx lu my lx ng mb nh mf ni mj nj nk nl nm bi translated"><strong class="lq ir">日- </strong>顾客购物的时间和支出大多取决于周末。许多顾客可能只喜欢在周末购物。</li><li id="06e6" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated"><strong class="lq ir">特殊活动/节假日:</strong>根据活动和节假日的不同，客户的购买行为可能会发生变化。对于像复活节这样的节日，食品销售可能会上升，对于像超级碗决赛这样的体育赛事，家庭用品销售可能会上升。</li><li id="0107" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated"><strong class="lq ir">产品价格:</strong>销售受产品价格影响最大。大多数顾客在最终购买之前都会检查价格标签。</li><li id="cfde" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated"><strong class="lq ir">产品类别:</strong>产品的类型很大程度上影响销售。例如，与食品销售相比，电视等家用产品的销售将会减少。</li><li id="2ef8" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">地点:地点在销售中也起着重要的作用。在像加利福尼亚这样的州，顾客可能会购买他们想要的产品而不考虑价格，而另一个地区的顾客可能对价格敏感。</li></ol><p id="f634" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">在深入研究数据之前，先快速概述一下每个州的人口和收入中位数:</p><h2 id="8074" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">加利福尼亚</h2><p id="6d68" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">人口:3951万</p><p id="f0e4" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">家庭年收入中位数:75277美元</p><h2 id="de09" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">得克萨斯州</h2><p id="6bbc" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">人口:2900万</p><p id="5719" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">家庭年收入中位数:59570美元</p><h2 id="5014" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">威斯康星州</h2><p id="6d61" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">人口582.2万</p><p id="34fb" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">收入中位数:60733美元</p><p id="d8e5" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">探索性数据分析是为了检验这些假设。</p><h1 id="9835" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">探索性数据分析</h1><p id="320b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">让我们开始数据分析，首先了解哪一个州的销售额最高，以及这三个州的各个部门的销售额。</p><h2 id="5d3c" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">探索商店的位置</h2><p id="b59d" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">本节旨在回答:</p><ol class=""><li id="e3bf" class="ne nf iq lq b lr mx lu my lx ng mb nh mf ni mj nj nk nl nm bi translated">哪个州的销售额最高？</li><li id="b74e" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">哪个部门的销售额最高？</li><li id="19de" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">表现最好的商店？</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/eeab527d9c1627e9238d513cf27a79d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pYexK-ZehaIQqJ0x4kDDhQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图二。每个州的总销售额</p></figure><p id="bce2" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">不出所料，食品部在这三个州都创下了最高的销售额。此外，从图2中可以看出，加州的总销售额最高。拥有4家商店和更多的人口可能是原因。令人惊讶的是，与德克萨斯州相比，人口密度较低的威斯康星州也创下了相同的销售额。为了更好地理解，绘制了每个商店的销售额。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/fd05f5b59635e2a1700f283f3b7f93f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b4eqftbMCb1Fk7FEQv-B_w.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图三。店内总销售额</p></figure><p id="fa71" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">因为与其他商店相比，ca3的销售额几乎是两倍。CA_3可能是一个更大的商店。人口密度和收入中位数也影响这些销售。</p><p id="4ab9" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">现在，我们已经了解了不同地点对销售的影响，现在让我们深入了解各个部门</p><h2 id="4406" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">探索价格和产品类别</h2><p id="9f76" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">本节旨在回答:</p><ol class=""><li id="bfde" class="ne nf iq lq b lr mx lu my lx ng mb nh mf ni mj nj nk nl nm bi translated">每个部门有多少不同的产品？</li><li id="26fc" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">不同州所有可用产品的平均价格是多少？</li><li id="ff83" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">哪个部门销售额最高最少？</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/2e8b0c7679973c7528ca6cb51dae0b2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bBISGWHIE7-Q13NfOcvUDg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图4可用产品总数</p></figure><p id="bb96" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">Food_3部门的可用产品数量更多。因此，食品3部门可能包括日常消费的食品，如牛奶等。现在，让我们看看价格是否对销售有任何影响</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/7d0c7fb8b5a29183bd0f8c54378bb32e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AYSexqma6o_RV2hYRA5ZgQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图五。所有产品的平均价格</p></figure><p id="e733" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">可以看出，爱好_1部门均价最高，美食3最低。尽管与德克萨斯州和威斯康星州相比，加利福尼亚州人口的平均家庭年收入更高，但三个州的平均价格几乎相似，这使得加利福尼亚州人口更能负担得起这些产品。现在让我们来看看每个产品在各州的销售情况。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/21b7bd502c0a3bcb4cf113be9fb72163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I_gZcN-Q9f1-8Rf3mQ80Pw.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图六。所有产品的总销售额</p></figure><p id="1c33" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">这里，平均价格最低的食品3部门销售额最高。更有趣的是，尽管爱好1的平均价格最高，几乎是爱好2的两倍，但爱好1的销售额也很高。家庭1销售额很高。这可能表明该产品部门拥有肥皂和洗涤剂等日常必需品。</p><p id="b552" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">如前所述，加利福尼亚州的销售量较高，其次是德克萨斯州和威斯康星州。与德克萨斯州相比，威斯康辛州的食品1和食品2类的销售额更高。因此，可以假设威斯康辛州的人口喜欢食物1和食物2部门。</p><p id="fc16" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">我们能够证明一些与产品价格、位置和产品类别相关的论文陈述。现在，让我们进入时间序列分析，看看不同的工作日、月份和事件是如何影响销售的。</p><h1 id="17a4" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">时间序列分析</h1><p id="843e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">本节旨在回答:</p><ol class=""><li id="5be5" class="ne nf iq lq b lr mx lu my lx ng mb nh mf ni mj nj nk nl nm bi translated">总销售额的每日季节性趋势</li><li id="ba36" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">哪个月的销售额最高和最低？</li><li id="fd35" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">在不同的州，人们更喜欢哪个工作日去杂货店购物？</li></ol><p id="d016" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">绘制所有年份的时间序列，以观察不同部门所有3个州的季节性趋势。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/bfe1b5d400366ff45b6b0b432ee61d8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wrtimO359wNT88INFCfMwA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图7。部门的每日销售趋势</p></figure><p id="79c5" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">季节性趋势遵循相同的模式，并且在所有3个州都是平行的。最高的食品是销售额最高的部门，其次是爱好和家庭。为了更好地理解每日趋势，绘制了2015年的热图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/43f30447a35979aa8257ad4045feb749.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IkbpGOm-BTKMmR2JIo_sMQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated"><strong class="bd nd">图8。2015年日历热图</strong></p></figure><p id="be46" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">沃尔玛似乎在圣诞节不营业。可以看出，在新年和感恩节这样的日子里，销售额很少。这是由于节日期间工作时间减少。此外，与平时相比，周末的销售额相对较高。</p><h2 id="79fb" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">月度销售趋势</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/168e43b010ad72ec474327865947943b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BtQylYnWROgmOISeRPbcrg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图九。全州每月销售趋势</p></figure><p id="9d72" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">令人惊讶的是，这三个州5年来的趋势都是一样的。可以看出，总销售额每年都在增加。这种趋势是因为沃尔玛每年都会推出新产品。此外，每年增加或减少的趋势模式几乎相似。为了更好地理解月度趋势，我们将一年中的所有月度销售额进行了分组，并绘制了图表。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/6c44e2e88da228355ce04e024c0f19a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IXTdSXa-qQ070V9tSGj8ng.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图10。类别月度销售趋势</p></figure><p id="2784" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">可以看出，销售额每年都在增长，并在三月份达到顶峰。三月之后，销售额开始下降，直到五月，六月销售额骤降至全年最低。6月份之后，销售额在两个月内逐渐增加，直到11月份才进一步下降。</p><h2 id="9e53" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">每周趋势</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/c2dd1f877aeeea76b5fa31bfbfa5b549.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*22PNR-UfZoz5X7LqPr65Bg.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图11。全州每周销售趋势</p></figure><p id="4456" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">不出所料，与正常工作日相比，周六和周日的总销售额更高。即使在这里，威斯康辛州也是一个例外，周六是销售高峰，而加州和德克萨斯州是周日。所以，也许威斯康辛州的居民更喜欢在周六去杂货店购物。</p><p id="2bb4" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">为了更好地观察工作日和月份的趋势，绘制了工作日和月份的总状态热图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/0e9136636e6d8d59db67e0a16568b34a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JCcUly3MNREQevJB2Txn0A.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图12。工作日与月份销售热图</p></figure><p id="c333" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">这张销售热图有一个有趣的模式。可以观察到，每个月记录的销售数量都在增加。也就是说，如果在二月份的星期一记录了最高的销售额，我们可以看到在三月份星期二有更多的销售额。</p><h2 id="ab6c" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">假日和特殊活动的销售趋势:</h2><p id="00ce" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">本节旨在回答:</p><ol class=""><li id="c271" class="ne nf iq lq b lr mx lu my lx ng mb nh mf ni mj nj nk nl nm bi translated">节日活动和节假日如何影响销售趋势？</li><li id="14d6" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">哪个节日的销售额最高？</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/4a1cb0df85cedde910887fdd6f040ae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sTlvB8qX84FAVy3Djg9pMA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图13。特殊活动的总销售额</p></figure><p id="51d7" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">超级碗体育赛事的销售额最高。国庆节那天，销售额很低。宗教节日当天的销售情况也是如此。为了观察销售趋势，绘制了2015年的季节性趋势图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/9c120947b8f467ba4091c0e443b1a7d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ExBUkm0lrAeZLhDx1r6zUA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图14。特殊活动的总销售趋势</p></figure><p id="3e28" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">观察结果:</p><ol class=""><li id="e44d" class="ne nf iq lq b lr mx lu my lx ng mb nh mf ni mj nj nk nl nm bi translated">在像新年和复活节这样的节日，由于营业时间减少，销售额很低。</li><li id="d37b" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">圣诞节销售额为零，可能是因为沃尔玛关门了。</li><li id="d5c3" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">像NBA决赛这样的体育赛事显示了一个有趣的洞察力，赛事前一天的销售额很高，而赛事当天的销售额下降。</li><li id="3c7d" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">在父亲节、母亲节等特殊日子，销售额会下降。</li><li id="039f" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated">国定假日和宗教节日对体育赛事也有类似的影响。</li></ol><h1 id="81f9" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">建模:</h1><p id="a9bc" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">该竞赛旨在预测28天的销售情况。</p><p id="697b" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">涉及的步骤:</p><ol class=""><li id="923a" class="ne nf iq lq b lr mx lu my lx ng mb nh mf ni mj nj nk nl nm bi translated"><strong class="lq ir">引入滞后和滚动平均值</strong></li><li id="ef93" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated"><strong class="lq ir">训练/测试分流</strong></li><li id="0f6f" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated"><strong class="lq ir">数字编码</strong></li><li id="74e5" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated"><strong class="lq ir">将数据转换成所需格式(</strong> data.matrix，LGB)。数据集，Cat.loadpool <strong class="lq ir"> ) </strong></li><li id="7738" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated"><strong class="lq ir">参数选择</strong></li><li id="9f82" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated"><strong class="lq ir">模型训练/交叉验证</strong></li><li id="e6a6" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated"><strong class="lq ir">预测</strong></li><li id="61ba" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated"><strong class="lq ir">型号对比的SMAPE误差</strong></li><li id="ade1" class="ne nf iq lq b lr nn lu no lx np mb nq mf nr mj nj nk nl nm bi translated"><strong class="lq ir">单标准误差规则</strong></li></ol><h2 id="6a9d" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">引入滞后和滚动平均值</h2><p id="33d1" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">由于缺乏计算能力，10%的数据是使用分层抽样选择的。分层随机抽样准确地反映了被研究的人群，因为它在应用随机抽样方法之前对整个人群进行了分层。简而言之，它确保人口中的每个亚群体在样本中得到适当的代表。</p><p id="da98" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">由于机器学习模型，我们使用的是具有滞后天数的时间序列，滚动平均值有助于改进模型，因此引入了新的滞后变量，分别用于1周、2周、1个月、2个月的时变效应变量。有了更好的计算能力，也可以引入1年的滞后，因为每年的销售模式是相似的。引入了1周和1个月滞后变量的滚动平均值和滚动标准偏差。</p><p id="8875" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">对于不了解滞后的人来说，一个<strong class="lq ir">滞后</strong>是一段固定的流逝时间；时间序列中的一组观察值被绘制(滞后)在第二组数据之后。第k个滞后是发生在时间之前“k”个时间点的时间段</p><p id="7297" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated"><strong class="lq ir">训练/测试分流</strong></p><p id="0e86" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">因为我们需要用5年的数据来预测28天。所有日期小于或等于2016年3月27日的数据都被视为训练数据。并将日期大于2016年3月27日且小于2016年4月24日的28天数据作为测试数据。最后28天用于验证。</p><p id="5580" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated"><strong class="lq ir">数字编码:</strong></p><p id="e766" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">由于许多机器学习模型无法读取字符类型数据，因此所有列都应转换为数字格式。我在R中使用了一个简单的命令</p><pre class="kg kh ki kj gt nu nv nw nx aw ny bi"><span id="9da5" class="ml kx iq nv b gy nz oa l ob oc">data%&gt;%mutate_if(is.factor, as.integer)</span></pre><p id="f239" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated"><strong class="lq ir">为什么要组装模型？</strong></p><p id="8802" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">集成方法通过组合多个模型来帮助改善机器学习结果。与单一模型相比，使用集合方法可以让我们做出更好的预测。因此，集成方法在许多著名的机器学习竞赛中排名第一，因此使用sMAPE错误率来比较不同的集成。</p><h2 id="843b" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">为什么是sMape？</h2><p id="4edc" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">使用sMAPE误差率是因为它是M3预报中规定的评估指标。sMape误差率或对称平均绝对百分比误差被列为重要的但不常见的预测误差测量方法之一。然而，它在计算上的复杂性和解释上的困难使它远远落后于最常见的MAD和MAPE预测误差计算。</p><p id="de70" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">sMape误差计算如下</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/a536737013a189d2a6be6c04a9f186e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*7zrC5-pDmxW_eRkA0JDLtQ.jpeg"/></div></figure><p id="412e" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">对于任何想了解所用模型以及一个模型相对于其他模型的优势的人，这里有一个<a class="ae kv" rel="noopener" target="_blank" href="/catboost-vs-light-gbm-vs-xgboost-5f93620723db">链接</a>指向一篇比较Xgboost vs catboost vs Lightgbm的文章。</p><h2 id="f4a1" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">Xgboost:</h2><p id="4a98" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">Xgboost需要xgb格式的数据。用于预测的DMatrix格式，因此训练集和测试集都转换为xgb。使用下面的命令。</p><pre class="kg kh ki kj gt nu nv nw nx aw ny bi"><span id="c960" class="ml kx iq nv b gy nz oa l ob oc">train_set_xgb = xgb.DMatrix(data = data.matrix(train_data[,features]), label = data.matrix(train_labels))<br/>test_set_xgb = xgb.DMatrix(data = data.matrix(test_data[,features]), label = data.matrix(test_labels))</span></pre><p id="5456" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">为Xgboost选择的参数如下</p><pre class="kg kh ki kj gt nu nv nw nx aw ny bi"><span id="1abf" class="ml kx iq nv b gy nz oa l ob oc">params &lt;- list(booster = "gbtree",<br/>               tree_method='gpu_hist', gpu_id=0,task_type = "GPU",<br/>          objective = "reg:tweedie", eta=0.4, gamma=0 nrounds = 20,    <br/>           nthreads = 10,early_stopping_round = 10)</span></pre><p id="f6c1" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">由于我们的数据包含大量零值，使用目标as <strong class="lq ir">回归</strong>没有给出预期的结果。在浏览了一些研究<a class="ae kv" href="https://arxiv.org/pdf/1811.10192.pdf" rel="noopener ugc nofollow" target="_blank">的文章</a>之后，我们发现Tweedie是含有大量零的非负数据的最佳模型。因此<strong class="lq ir"> Tweedie </strong>目标用于训练模型。</p><p id="5dc1" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">由于最新的Xgboost版本支持使用GPU，因此使用GPU对模型进行训练。选择RMSE评估度量来训练模型。给出了10次的早期停止循环，因此如果模型RMSE在10次迭代中没有改进，模型将停止。并且将返回最佳RMSE值。</p><p id="9e7d" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">最佳RMSE值为<strong class="lq ir"> 2.48 </strong></p><p id="d1f5" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">进行<strong class="lq ir"> 3重交叉验证</strong>是为了检查模型的一致性。为交叉验证返回的最佳RMSE值是<strong class="lq ir"> 2.637。</strong></p><p id="ab68" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">定义一个函数来计算sMAPE值，如下所示:</p><pre class="kg kh ki kj gt nu nv nw nx aw ny bi"><span id="d4f6" class="ml kx iq nv b gy nz oa l ob oc">smape_cal &lt;- function(outsample, forecasts){<br/>  outsample &lt;- as.numeric(outsample)<br/>  forecasts&lt;-as.numeric(forecasts)<br/>  smape &lt;- (abs(outsample-forecasts))/((abs(outsample)+abs(forecasts))/2)<br/>  return(smape)<br/>}</span></pre><p id="bb74" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">Xgboost的SMAPE值为<strong class="lq ir"> 1.897968 </strong></p><h2 id="da54" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">Catboost:</h2><p id="b62b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">catboost需要load_pool格式的数据来进行预测，因此使用以下命令将训练集和测试集都转换为load_pool格式。</p><pre class="kg kh ki kj gt nu nv nw nx aw ny bi"><span id="1ad3" class="ml kx iq nv b gy nz oa l ob oc">train_cat &lt;- catboost.load_pool(data = data.matrix(train_data_cat[,features]), label = data.matrix(train_labels))<br/>test_cat &lt;- catboost.load_pool(data = data.matrix(test_data_cat[,features]), label = data.matrix(test_labels))</span></pre><p id="3f87" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">为Catboost选择的参数如下</p><pre class="kg kh ki kj gt nu nv nw nx aw ny bi"><span id="42a1" class="ml kx iq nv b gy nz oa l ob oc">params_cat &lt;- list(iterations = 1500,<br/>                metric_period = 100,<br/>               tree_method='gpu_hist',task_type = "GPU",<br/>               loss_function = "RMSE",<br/>               eval_metric = "RMSE",<br/>               random_strength = 0.5,<br/>               depth = 7,<br/>               early_stopping_rounds = 100,<br/>               learning_rate = 0.18,<br/>               l2_leaf_reg = 0.1,<br/>               random_seed = 93)</span></pre><p id="95a4" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">RMSE被用作损失函数和训练模型的评估度量。使用Kaggle GPU进行1500次迭代的计算时间约为5分钟。第一轮是100轮。</p><p id="b5fa" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">最佳RMSE值为<strong class="lq ir"> 2.36541 </strong></p><p id="80e9" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">执行<strong class="lq ir"> 3重交叉验证</strong>以检查模型一致性。为交叉验证返回的最佳RMSE值是<strong class="lq ir"> 2.39741。</strong></p><p id="104b" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">Catboost的sMAPE值为<strong class="lq ir"> 1.34523，</strong>，似乎比xgboost更好。</p><h2 id="0301" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">Lightgbm</h2><p id="62e5" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">lighgbm需要lgb_dataset格式的数据进行预测，因此训练集和测试集都转换为lgb。使用以下命令格式化数据集。</p><pre class="kg kh ki kj gt nu nv nw nx aw ny bi"><span id="0dc5" class="ml kx iq nv b gy nz oa l ob oc">train_set_lgb &lt;- lgb.Dataset(data=as.matrix(train_data[,features]), label = as.matrix(train_labels))<br/>test_set_lgb &lt;- lgb.Dataset(data=as.matrix(test_data[,features]), label =as.matrix(test_labels))<br/>valids=list(train=train_set_lgb,test = test_set_lgb)</span></pre><p id="c654" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">使用的参数如下</p><pre class="kg kh ki kj gt nu nv nw nx aw ny bi"><span id="8a8a" class="ml kx iq nv b gy nz oa l ob oc">parameters =list(objective = "tweedie",<br/>           tweedie_variance_power=1.1,<br/>           metric ="rmse",<br/>          force_row_wise = TRUE,<br/>                  num_leaves=90,<br/>            learning_rate = 0.03,<br/>            feature_fraction= 0.5,<br/>            bagging_fraction= 0.5,<br/>            max_bin=100,<br/>            bagging_freq = 1,<br/>            boost_from_average=FALSE,<br/>          lambda_l1 = 0,<br/>          lambda_l2 = 0,<br/>          nthread = 4)</span><span id="d15d" class="ml kx iq nv b gy oe oa l ob oc">freeram()</span></pre><p id="f967" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">Tweedie用作目标函数，RMSE用作训练模型的评估度量。</p><p id="de33" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">最佳RMSE值为<strong class="lq ir"> 2.1967701 </strong></p><p id="fbe4" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">执行<strong class="lq ir"> 3重交叉验证</strong>以检查模型的一致性。为交叉验证返回的最佳RMSE值是<strong class="lq ir"> 2.21。</strong></p><p id="910c" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">Lgboost模型的sMAPE值为<strong class="lq ir"> 1.14，</strong>是所有3个模型中最好的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/9f88cfe5e3433be500beb190b6c7ac88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sBfbblSpzDXHvSfwolNSeQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图15。LGB模型的特征重要性</p></figure><p id="ae95" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">基于sMape误差，Lgb是最好的模型。只是为了确认，一个标准误差适用于所有3个模型的交叉验证RMSE值。</p><p id="3d50" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated"><strong class="lq ir">一个标准误差规则:</strong></p><p id="d199" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">对于那些不知道一个标准误差规则的人，在交叉验证中使用一个标准误差规则，其中我们采用最简单的模型，其误差在最佳模型(误差最小的模型)的一个标准误差内。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/f8f7d2088dbe8415b68c4a9c1cf2820d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T7Jhu2qhQiSQg6FV5fFRTQ.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">图16。一个标准误差图</p></figure><h2 id="23ce" class="ml kx iq bd ky mm mn dn lc mo mp dp lg lx mq mr li mb ms mt lk mf mu mv lm mw bi translated">结论:</h2><p id="34fc" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">即使在这里，LGB也是RMSE值最低的表现最好的车型。因为其他模型平均误差点不在Lihtgbm模型的标准差范围内。根据一个标准误差规则，Lightgbm被选为最佳模型。</p><p id="37ae" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">表现最好的模型的提交分数在0.46左右。</p><h1 id="1365" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">附录</h1><p id="e42f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">所有绘图都是使用r .中的<strong class="lq ir"> ggplot2 </strong>包制作的，因为代码非常大。我把我的Kaggle笔记本分享给任何想在比赛中使用代码的人。</p><p id="9fb0" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">ka ggle:<a class="ae kv" href="https://www.kaggle.com/jaswanthhbadvelu/cat-xgb-lgboost-prophet" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/jaswanthhbadvellu/cat-xgb-lgboost-prophet</a></p><p id="a794" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">数据集:【https://www.kaggle.com/c/m5-forecasting-accuracy/data T4】</p><p id="e461" class="pw-post-body-paragraph lo lp iq lq b lr mx jr lt lu my ju lw lx mz lz ma mb na md me mf nb mh mi mj ij bi translated">分层采样后的样本数据集如下所示</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi of"><img src="../Images/01d9923eefd050b2d8f24870f9950cfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kidnIX4tSvzbKbdALNa1oQ.jpeg"/></div></div></figure></div></div>    
</body>
</html>