<html>
<head>
<title>Machine Learning: observe how a Linear Model works by predicting the prices of Fiat 500</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习:通过预测菲亚特 500 的价格来观察线性模型是如何工作的</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-observe-how-a-linear-model-works-by-predicting-the-prices-of-the-fiat-500-fb38e0d22681?source=collection_archive---------61-----------------------#2020-08-24">https://towardsdatascience.com/machine-learning-observe-how-a-linear-model-works-by-predicting-the-prices-of-the-fiat-500-fb38e0d22681?source=collection_archive---------61-----------------------#2020-08-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bb84" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用实例研究机器学习</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/44147f914a5d8e88dcf0b9051f9030c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ly5uGGXDekOY0BKIAeWtQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图尔古特·阿利耶夫在<a class="ae ky" href="https://unsplash.com/s/photos/fiat-500?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="52af" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">简介</strong></p><p id="6dc9" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在本文中，我想通过向您介绍我做的一个真实项目来谈论线性模型。你可以在<a class="ae ky" href="https://github.com/moryba/Predicting-the-prices-of-Fiat-500-with-Linear-Regression" rel="noopener ugc nofollow" target="_blank"> my Github </a>中找到的项目包括预测菲亚特 500 的价格。</p><p id="b839" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我的模型的数据集有 8 列，如下图所示，1538 行。</p><ul class=""><li id="bab0" class="mc md it li b lj lk lm ln lp me lt mf lx mg mb mh mi mj mk bi translated">型号:流行、休闲、运动</li><li id="1d4e" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">发动机功率:发动机的千瓦数</li><li id="ddcc" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">车龄天数:车龄天数</li><li id="4b57" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">公里:汽车行驶的公里数</li><li id="aa5d" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">previous_owners:以前所有者的数量</li><li id="ec83" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">lat:卖家所在的纬度(意大利的汽车价格从该国北部到南部各不相同)</li><li id="a760" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">lon:卖家的经度(意大利的汽车价格从该国北部到南部各不相同)</li><li id="8899" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">价格:销售价格</li></ul><p id="0770" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在本文中，我们将在第一部分看到关于线性回归、岭回归和套索回归的一些概念。然后，我将向您展示我对我考虑的数据集的基本见解，最后但同样重要的是，我们将看到我用来评估模型性能的准备工作和指标。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="f95f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">第一部分:线性回归、岭回归和套索回归</strong></p><p id="f080" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">线性模型是一类使用输入要素的线性函数进行预测的模型。</p><p id="55e5" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">关于回归，我们知道一般公式如下:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/17855312d45093f6416afb69dfa35c47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0hpOyTY-IM1iPtWGtug0dg.png"/></div></div></figure><p id="8b60" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">正如你已经知道的，x[0]到 x[p]代表单个数据点的特征。相反，<strong class="li iu"> m </strong> a <strong class="li iu"> b </strong>是学习的模型参数，<strong class="li iu"> ŷ </strong>是模型做出的预测。</p><p id="5cfb" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">回归有很多线性模型。这些模型之间的区别在于如何从训练数据中学习模型参数<strong class="li iu"> m </strong>和<strong class="li iu"> b </strong>以及如何控制模型复杂度。我们将看到三种回归模型。</p><ul class=""><li id="f36f" class="mc md it li b lj lk lm ln lp me lt mf lx mg mb mh mi mj mk bi translated"><strong class="li iu">线性回归(普通最小二乘法)</strong> →在训练集上找到使预测和真实回归目标 y 之间的均方误差最小的参数<strong class="li iu"> m </strong>和<strong class="li iu"> b </strong>。MSE 是预测值和真实值之间的平方差之和。下面介绍如何用 scikit-learn 计算它。</li></ul><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="18b6" class="mw mx it ms b gy my mz l na nb">from sklearn.linear_model import LinearRegression </span><span id="82ff" class="mw mx it ms b gy nc mz l na nb">X_train, X_test, y_train, y_test=train_test_split(X, y, random_state=0)</span><span id="ac14" class="mw mx it ms b gy nc mz l na nb">lr = LinearRegression()</span><span id="e534" class="mw mx it ms b gy nc mz l na nb">lr.fit(X_train, y_train)</span><span id="3b16" class="mw mx it ms b gy nc mz l na nb">print(“lr.coef_: {}”.format(lr.coef_)) </span><span id="0dfe" class="mw mx it ms b gy nc mz l na nb">print(“lr.intercept_: {}”.format(lr.intercept_))</span></pre><ul class=""><li id="9b3f" class="mc md it li b lj lk lm ln lp me lt mf lx mg mb mh mi mj mk bi translated"><strong class="li iu">岭回归</strong> →它用于预测的公式与用于线性回归的公式相同。在岭回归中，系数(m)被选择用于很好地预测训练数据，但也适合附加约束。我们希望 m 的所有条目都接近于零。这意味着每个特征应该对结果有尽可能小的影响(小斜率)，同时仍然预测良好。这种约束被称为正则化，这意味着限制模型以避免过度拟合。这种特殊的岭回归正则化称为 L2。岭回归在<strong class="li iu"> linear_model 中实现。山脊</strong>如下图所示。特别是，通过增加 alpha，我们将系数移向零，这降低了训练集的性能，但可能有助于泛化并避免过度拟合。</li></ul><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="ab27" class="mw mx it ms b gy my mz l na nb">from sklearn.linear_model import Ridge </span><span id="0906" class="mw mx it ms b gy nc mz l na nb">ridge = Ridge(alpha=11).fit(X_train, y_train)</span><span id="d8ac" class="mw mx it ms b gy nc mz l na nb">print(“Training set score: {:.2f}”.format(ridge.score(X_train, y_train))) </span><span id="4313" class="mw mx it ms b gy nc mz l na nb">print(“Test set score: {:.2f}”.format(ridge.score(X_test, y_test)))</span></pre><ul class=""><li id="6d1e" class="mc md it li b lj lk lm ln lp me lt mf lx mg mb mh mi mj mk bi translated"><strong class="li iu">套索回归</strong> →另一种正则化方法是套索。与岭回归一样，使用套索也将系数限制为接近于零，但方式略有不同，称为 L1 正则化。L1 正则化的后果是，当使用套索时，某些系数恰好为零。这意味着模型完全忽略了一些特征。</li></ul><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="f6ca" class="mw mx it ms b gy my mz l na nb">from sklearn.linear_model import </span><span id="0390" class="mw mx it ms b gy nc mz l na nb">Lasso lasso = Lasso(alpha=3).fit(X_train, y_train) <br/></span><span id="a48b" class="mw mx it ms b gy nc mz l na nb">print(“Training set score: {:.2f}”.format(lasso.score(X_train, y_train))) </span><span id="2a98" class="mw mx it ms b gy nc mz l na nb">print(“Test set score: {:.2f}”.format(lasso.score(X_test, y_test))) </span><span id="005c" class="mw mx it ms b gy nc mz l na nb">print(“Number of features used: {}”.format(np.sum(lasso.coef_ != 0)))</span></pre></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="9d5f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">第二部分:我发现的见解</strong></p><p id="3d96" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在看到关于模型的准备和评估的部分之前，看一下数据集的情况是有用的。</p><p id="1cf6" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在下面的散点图中，我们可以观察到一些特征之间有一些特殊的相关性，如公里数、使用年限和价格。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nd"><img src="../Images/9437eb861fbc5375723948834b04b940.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*idlO7Efgi0132_N_ip4CaQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0dbf" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">相反，在下面的相关矩阵中，我们可以很好地看到特征之间的相关结果。</p><p id="b4dd" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">特别是在年龄天数和价格或者公里数和价格之间，我们有很大的相关性。</p><p id="328c" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这是构建我们的模型的起点，并知道哪个机器学习模型可能更适合。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/697f3ce13871616f2120a39a72043906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*RkuVvead9Z_0XClR5f8SAQ.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="22bf" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">第三部分:准备并评估模型的性能</strong></p><p id="a4e1" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">为了训练和测试数据集，我使用了线性回归。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="7b1b" class="mw mx it ms b gy my mz l na nb"><strong class="ms iu">from</strong> <strong class="ms iu">sklearn.linear_model</strong> <strong class="ms iu">import</strong> <strong class="ms iu">LinearRegression</strong><br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)<br/>lr = LinearRegression()<br/>lr.fit(X_train, y_train)</span></pre><p id="c8da" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">出局:</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="cd1a" class="mw mx it ms b gy my mz l na nb">LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=False)</span></pre><p id="43f5" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在下表中，有我为我的模型考虑的每个特征的系数。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="c74f" class="mw mx it ms b gy my mz l na nb">coef_df = pd.DataFrame(lr.coef_, X.columns, columns=['Coefficient'])<br/>coef_df</span></pre><p id="9752" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">出局:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/c202b1a65aeddbdd10da755d50788147.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*37WnPMZDXZwzup9RsToCTg.png"/></div></figure><p id="3701" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在，是时候对模型进行评估了。在下图中，以 30 个数据点的样本为特征，我们可以观察预测值和实际值之间的比较。正如我们所见，我们的模型相当不错。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/be150a2b369e3dc3f8ede99d77e4d266.png" data-original-src="https://miro.medium.com/v2/resize:fit:1294/format:webp/1*E9kCq6tDmP7vLB7z8_fz-w.jpeg"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="6e31" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">R 平方是模型输入解释因变量变化的能力的良好度量。在我们的例子中，我们有 85%。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="3558" class="mw mx it ms b gy my mz l na nb"><strong class="ms iu">from</strong> <strong class="ms iu">sklearn.metrics</strong> <strong class="ms iu">import</strong> <strong class="ms iu">r2_score</strong> round(sklearn.metrics.r2_score(y_test, y_pred), 2)</span></pre><p id="a720" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">出局:</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="ce7d" class="mw mx it ms b gy my mz l na nb">0.85</span></pre><p id="ae05" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">现在，我计算 MAE、MSE 和 RMSE，以便更精确地了解模型的性能。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="e089" class="mw mx it ms b gy my mz l na nb"><strong class="ms iu">from</strong> <strong class="ms iu">sklearn</strong> <strong class="ms iu">import</strong> <strong class="ms iu">metrics</strong> </span><span id="afa7" class="mw mx it ms b gy nc mz l na nb">print(‘Mean Absolute Error:’, metrics.mean_absolute_error(y_test, y_pred)) </span><span id="c23b" class="mw mx it ms b gy nc mz l na nb">print(‘Mean Squared Error:’, metrics.mean_squared_error(y_test, y_pred))</span><span id="744b" class="mw mx it ms b gy nc mz l na nb">print(‘Root Mean Squared Error:',<br/>np.sqrt(metrics.mean_squared_error(y_test, y_pred)))</span></pre><p id="14fc" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">最后，通过比较训练集得分和测试集得分，我们可以看到我们的模型是如何执行的。</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="4bd0" class="mw mx it ms b gy my mz l na nb">print("Training set score: {:.2f}".format(lr.score(X_train, y_train)))</span><span id="ee07" class="mw mx it ms b gy nc mz l na nb">print("Test set score: {:.2f}".format(lr.score(X_test, y_test)))</span></pre><p id="c291" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">出局:</p><pre class="kj kk kl km gt mr ms mt mu aw mv bi"><span id="cd76" class="mw mx it ms b gy my mz l na nb">Training set score: 0.83 </span><span id="d497" class="mw mx it ms b gy nc mz l na nb">Test set score: 0.85</span></pre></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="5a2f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated"><strong class="li iu">结论</strong></p><p id="ad61" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">线性模型是在实践中广泛使用的一类模型，并且在过去几年中被广泛研究，特别是对于机器学习。所以，有了这篇文章，我希望你已经获得了一个良好的起点，以便提高自己，创建自己的线性模型。</p></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><p id="9b5f" class="pw-post-body-paragraph lg lh it li b lj lk ju ll lm ln jx lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">感谢你阅读这篇文章。您还可以通过其他方式与我保持联系并关注我的工作:</p><ul class=""><li id="bb1e" class="mc md it li b lj lk lm ln lp me lt mf lx mg mb mh mi mj mk bi translated"><a class="ae ky" href="https://upscri.be/wxv1zi" rel="noopener ugc nofollow" target="_blank">订阅</a>我的时事通讯。</li><li id="5db2" class="mc md it li b lj ml lm mm lp mn lt mo lx mp mb mh mi mj mk bi translated">也可以通过我的电报群<a class="ae ky" href="https://t.me/DataScienceForBeginners" rel="noopener ugc nofollow" target="_blank"> <em class="nh">初学数据科学</em> </a>联系。</li></ul></div></div>    
</body>
</html>