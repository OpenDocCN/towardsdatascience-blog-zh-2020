<html>
<head>
<title>9 functions that make natural language pre-processing a piece of cake</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让自然语言预处理变得轻而易举的 9 个函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/9-functions-that-make-natural-language-pre-processing-a-piece-of-cake-8b885c151955?source=collection_archive---------16-----------------------#2020-07-02">https://towardsdatascience.com/9-functions-that-make-natural-language-pre-processing-a-piece-of-cake-8b885c151955?source=collection_archive---------16-----------------------#2020-07-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="09b8" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">NLP 最耗时的方面可以总结为快速简单的步骤。表情符号处理奖金。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0aa95244fc7000728ed9f43923f256e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-_J1_fBviUWOHqi1CIRQvQ.png"/></div></div></figure><h1 id="9b5a" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">什么是 NLP，为什么它很重要</h1><p id="8b82" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">自然语言处理帮助计算机用人类自己的语言与人类交流。它使计算机有可能阅读文本，听到讲话，翻译它，测量情绪，并确定哪些部分是重要的。</p><p id="f9bb" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">它允许我们和我们的机器发展我们的逻辑、情感和直觉智能，这对当今世界的生存和发展特别有用。</p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><p id="b24b" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">如果您还不是会员，请在此获得您的中级会员资格<a class="ae mu" href="https://medium.com/@alejandra.vlerick/membership" rel="noopener">！</a></p></div><div class="ab cl mn mo hx mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="im in io ip iq"><h2 id="545e" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">你会在这篇文章中发现什么——清洁和处理</h2><ol class=""><li id="4047" class="nh ni it lo b lp lq ls lt lv nj lz nk md nl mh nm nn no np bi translated">从文本文件创建熊猫数据帧</li><li id="cdea" class="nh ni it lo b lp nq ls nr lv ns lz nt md nu mh nm nn no np bi translated">将所有单词变为小写</li><li id="fc71" class="nh ni it lo b lp nq ls nr lv ns lz nt md nu mh nm nn no np bi translated">删除标点符号</li><li id="cf7c" class="nh ni it lo b lp nq ls nr lv ns lz nt md nu mh nm nn no np bi translated">去掉不必要的空格</li><li id="70a9" class="nh ni it lo b lp nq ls nr lv ns lz nt md nu mh nm nn no np bi translated">使用<strong class="lo iu">正则表达式</strong>删除你将在这篇文章中找到的内容</li><li id="1f1d" class="nh ni it lo b lp nq ls nr lv ns lz nt md nu mh nm nn no np bi translated">统计<strong class="lo iu">字符</strong>或<strong class="lo iu">单词的重复次数</strong></li><li id="b553" class="nh ni it lo b lp nq ls nr lv ns lz nt md nu mh nm nn no np bi translated">数一行中<strong class="lo iu">字</strong>的<strong class="lo iu">号</strong></li><li id="17dd" class="nh ni it lo b lp nq ls nr lv ns lz nt md nu mh nm nn no np bi translated">计算一行中<strong class="lo iu">字符</strong>的数量</li><li id="1f37" class="nh ni it lo b lp nq ls nr lv ns lz nt md nu mh nm nn no np bi translated">统计最多的<strong class="lo iu">重复</strong>字</li><li id="aa1a" class="nh ni it lo b lp nq ls nr lv ns lz nt md nu mh nm nn no np bi translated">处理<strong class="lo iu"> <em class="nv">表情符号</em> </strong>。奖金❤️</li></ol><h2 id="c99c" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">NLP 中一些常用的可视化</h2><ol class=""><li id="e825" class="nh ni it lo b lp lq ls lt lv nj lz nk md nl mh nm nn no np bi translated">词云</li><li id="5d82" class="nh ni it lo b lp nq ls nr lv ns lz nt md nu mh nm nn no np bi translated">树形地图</li></ol><h2 id="fc8f" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">图书馆</h2><p id="21e7" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">我在 Pycharm 上运行我的代码，这些是我在分析的第一部分中使用的库。如你所见，我把事情做得又好又简单:)</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="36a3" class="mv kv it nx b gy ob oc l od oe">import pandas as pd<br/>import numpy as np<br/>import regex as re<br/>from collections import Counter</span></pre><h2 id="9fa3" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">1.从文本文件创建熊猫数据帧</h2><p id="aa2d" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">对于这个例子，我们将使用《权力的游戏》的剧本。每集的文本文件可以在这里找到。</p><p id="009e" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我想做的第一件事是创建一个有两列的熊猫数据帧，第一列是角色的名字，第二列是角色说的台词。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/febe829c489d538d49c3bd3f4159a3de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-G7Tnq2bCgo2O_uV2SRjxQ.png"/></div></div></figure><p id="7a89" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">通过添加参数<strong class="lo iu"> sep: ":" </strong>我们指出列之间的分隔将使用每个冒号。使用<strong class="lo iu"> error_bad_lines=False </strong>参数，当没有找到冒号时，该行将被删除。这对于我们的非语音行特别有效，比如[GARED grubbles]，我不想保留它。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="85f1" class="mv kv it nx b gy ob oc l od oe">df = pd.read_csv('r"file.txt"<strong class="nx iu">, </strong>sep=":"<strong class="nx iu">, </strong>error_bad_lines=False)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/267b1cdf440ce121606d77bcb87ab2c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ouzBVRz6DWKSEjb9U9L4jA.png"/></div></div></figure><h2 id="2bee" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">2.将所有单词变为小写</h2><p id="98bc" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">ASCII 或 UNICODE 编码区分小写和大写字母，因此在我们开始 NLP 分析之前，所有的<strong class="lo iu">单词都是小写是很重要的。否则，我们会得到不必要的重复</strong></p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="d01c" class="mv kv it nx b gy ob oc l od oe">df1['name']= df1['name'].str.lower()<br/>df1['line']= df1['line'].str.lower()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/201893d8c37b34c0377d94ec29f9ee22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*drQwBWKqex2daFEPd_VRkQ.png"/></div></div></figure><h2 id="2afe" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">3.用一个字符替换另一个字符</h2><p id="1355" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">我想去掉这一行中的所有标点符号，我决定保持简单，并使用了 replace()函数。我发现这一步在统计单词重复次数和频率时相当重要。逗号后面的单词将被不同地计数，这使得我的结果非常嘈杂，难以分析。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="ba9a" class="mv kv it nx b gy ob oc l od oe">df['line'] = df['line'].str.replace(','<strong class="nx iu">, </strong>'')<br/>df['line'] = df['line'].str.replace('.'<strong class="nx iu">, </strong>'')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/1d8a2d66dda7e317fd3890751d9d344b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ldJUtIk_9He5aIMYtEmvzA.png"/></div></div></figure><h2 id="6823" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">4.去掉不必要的空格</h2><p id="71e6" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">区分“提利昂”和“提利昂”。当试图根据名称合并数据帧时，或者当我们生成单词云时，它们以不同的间距多次计数同一个单词，这会导致许多问题。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="9e01" class="mv kv it nx b gy ob oc l od oe">df1['name'] = df1['name'].str.strip() # Delete preceding spaces</span></pre><h2 id="ccc5" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">5.使用正则表达式删除特殊字符分组</h2><p id="1da5" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">最近发现了 Regex，心生敬畏。它是如此强大！</p><blockquote class="oj ok ol"><p id="0602" class="lm ln nv lo b lp mi ju lr ls mj jx lu om mk lx ly on ml mb mc oo mm mf mg mh im bi translated">一个<strong class="lo iu">正则表达式<em class="it"> (Regex) </em> </strong>是一个定义搜索模式的字符序列。通常，字符串搜索算法使用这种模式对字符串进行“查找”或“查找和替换”操作，或者进行输入验证。它是在理论计算机科学和形式语言理论中发展起来的一种技术。</p></blockquote><p id="e45b" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我注意到，有时带有角色名的那一行会在括号中包含情感和语气指示。使用这些正则表达式可以去掉括号和括号内的所有内容。我们得到了结果</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="b420" class="mv kv it nx b gy ob oc l od oe">Arya (crying and shouting): How dare you!<br/>Arya: How dare you!</span></pre><p id="2d1f" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">这种删除可以通过以下函数和正则表达式编码来实现:</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="6051" class="mv kv it nx b gy ob oc l od oe"># Delete everything between the brackets<br/>df['person']=df['person'].str.replace(r"\(.*\)","")</span></pre><p id="fee4" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">另一个方便的 Regex 应用程序的例子是删除 name 列中每个字符的姓。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="e7ec" class="mv kv it nx b gy ob oc l od oe"># Delete last name<br/>df['name']=df['name'].str.replace(r"^(\s*(?:\S+\s+){1})\S+",r"\1")</span></pre><h2 id="0c0a" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">6.计算字符或单词的重复次数</h2><p id="489a" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">我想调查一个角色使用感叹号来表达强烈情感的次数。我决定使用<strong class="lo iu"> lambda </strong>和<strong class="lo iu"> count() </strong>函数对感叹号进行计数，并创建一个包含总计数的新列。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="c6ef" class="mv kv it nx b gy ob oc l od oe">df['exc'] = df['line'].map(lambda x: x.count("!"))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/0b03d196e9fc624f3e53fedc297af9df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*98_e-tvTvBnm4Y58fI5msQ.png"/></div></div><p class="oq or gj gh gi os ot bd b be z dk translated">一行包含感叹号的次数</p></figure><p id="2fe0" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">完全相同的函数也可以用来计算一个特定单词重复出现的次数。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="db1a" class="mv kv it nx b gy ob oc l od oe">df['queen'] = df['line'].map(lambda x: x.count("Daenerys!"))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/f8a1d3d13c3465a677507902eeac1696.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*goO39UESUVYX78lsshVpzw.png"/></div></div><p class="oq or gj gh gi os ot bd b be z dk translated">每个字符使用的感叹号的数量</p></figure><h2 id="82c2" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">7.计算一行中的字数</h2><p id="ba39" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated"><em class="nv">看一下本文末尾的</em> <strong class="lo iu"> <em class="nv">树形图</em> </strong> <em class="nv">来可视化《权力的游戏》全部 8 季中每个角色说的话的比例。</em></p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="070c" class="mv kv it nx b gy ob oc l od oe">df['words'] = [len(x.split()) for x in df['line'].tolist()]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/79cee999c52f90fe210b00408bba413e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X634Na3Sv4LM1ydIEs4acw.png"/></div></div></figure><h2 id="7ced" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated"><strong class="ak"> 8。计算一行中的字符数</strong></h2><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="def8" class="mv kv it nx b gy ob oc l od oe">df['characters_nb'] = df.line.apply(len)</span></pre><h2 id="d0df" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">9.统计重复次数最多的单词</h2><p id="c005" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">这个函数和 6 中的函数的区别在于，这个函数查看所有的单词，并计算它们被说的次数。步骤 6 中的函数搜索输入中给出的单个特定单词。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="c0c2" class="mv kv it nx b gy ob oc l od oe">wd = pd.DataFrame(Counter(words.split()).most_common(200), columns=[<strong class="nx iu">'word'</strong>, <strong class="nx iu">'frequency'</strong>])</span></pre><p id="ed27" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">当我们运行这个函数时，我们得到一个字典，映射所有说过的单词和它们被说的次数。</p><p id="9274" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">为了只查看一个角色说的话，我可以使用下面的代码行只保留他/她的台词。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="b1a8" class="mv kv it nx b gy ob oc l od oe">df = df[df[‘name’] == “arya”]</span></pre><p id="69f9" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><em class="nv">看看本文末尾的</em> <strong class="lo iu"> <em class="nv">词云</em> </strong> <em class="nv">来可视化《权力的游戏》全部 8 季中每个角色最常用的词。</em></p><h2 id="6496" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">10.计算表情符号</h2><p id="638c" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">我认为添加关于处理表情符号的信息是必要的。它们无处不在，我们必须知道如何充分利用这些新信息。</p><p id="e953" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">这是我另一个项目的代码摘录，我在这个项目中分析了一个 WhatsApp 对话。</p><p id="356b" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我导入了表情库，然后使用 append()函数创建了所用表情的列表。然后我用<strong class="lo iu"> Counter() </strong>函数统计了每个表情符号在列表中出现的次数。我用所有使用的表情符号和它们相应的频率创建了一个字典。最后，我应用了 sorted()函数来枚举和排序使用最多和最少的表情符号。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="1bcf" class="mv kv it nx b gy ob oc l od oe">import emoji</span><span id="5f4c" class="mv kv it nx b gy ow oc l od oe">emojis_df=[]</span><span id="1dd7" class="mv kv it nx b gy ow oc l od oe">for string in df['line']:<br/>    my_str = str(string)<br/>    for each in my_str:<br/>        if each in emoji.UNICODE_EMOJI:<br/>            emojis_df.append(each)</span><span id="3d7b" class="mv kv it nx b gy ow oc l od oe">freq = dict(Counter(i <strong class="nx iu">for </strong>sub <strong class="nx iu">in </strong>emojis_df <strong class="nx iu">for </strong>i <strong class="nx iu">in </strong>set(sub))) </span><span id="92be" class="mv kv it nx b gy ow oc l od oe">sort_orders = sorted(freq.items(), key=<strong class="nx iu">lambda </strong>x: x[1], reverse=<strong class="nx iu">True</strong>)</span></pre><p id="3f70" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">对于所有这些功能(尤其是表情符号)的实际应用，看看这篇文章:“WhatsApp 的对话告诉了我们什么关于我们的友谊”</p><div class="ox oy gp gr oz pa"><a rel="noopener follow" target="_blank" href="/what-whatsapp-conversations-tell-us-about-our-friendships-73ce7104d84e"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">WhatsApp 上的对话告诉我们关于友谊的什么</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">三年的友谊能告诉你什么关于你的交流习惯？</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pk l pl pm pn pj po ks pa"/></div></div></a></div><h1 id="5ecb" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">数据可视化</h1><p id="52e2" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated"><strong class="lo iu">看着吓人，其实真的不是！</strong></p><p id="bff5" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">首先，我们选择想要分析的角色。然后我按照和表情符号练习完全一样的步骤。列出单词，统计重复次数，创建词典，最后绘制单词云！容易的。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="f8fb" class="mv kv it nx b gy ob oc l od oe">from wordcloud import WordCloud<strong class="nx iu">, </strong>STOPWORDS<strong class="nx iu">, </strong>ImageColorGenerator</span><span id="f9dc" class="mv kv it nx b gy ow oc l od oe"># Choose a character<br/>df = df[df[<strong class="nx iu">'name'</strong>]  == <strong class="nx iu">"cersei"</strong>]</span><span id="4da1" class="mv kv it nx b gy ow oc l od oe"><em class="nv"># Make all words lowercase and add them to an array</em><br/>words = <strong class="nx iu">''<br/>for </strong>i <strong class="nx iu">in </strong>df.line.values:<br/>    words += <strong class="nx iu">'{} '</strong>.format(i.lower())</span><span id="8083" class="mv kv it nx b gy ow oc l od oe"><em class="nv"># Create a pandas dataframe with the word and its frequency<br/></em>wd = pd.DataFrame(Counter(words.split()).most_common(200), columns=[<strong class="nx iu">'word'</strong>, <strong class="nx iu">'frequency'</strong>])</span><span id="f05c" class="mv kv it nx b gy ow oc l od oe"># Convert the dataframe to a dictionary<br/>data = dict(zip(wd[<strong class="nx iu">'word'</strong>].tolist(), wd[<strong class="nx iu">'frequency'</strong>].tolist()))<br/><br/>wc = WordCloud(background_color=<strong class="nx iu">'white'</strong>,<br/>               stopwords=STOPWORDS,<br/>               max_words=200).generate_from_frequencies(data)<br/>plt.imshow(wc, interpolation=<strong class="nx iu">'bilinear'</strong>)<br/>plt.show()</span></pre><p id="a63f" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">关于颜色、形状和字体，Word Cloud 文档可以在<a class="ae mu" href="https://amueller.github.io/word_cloud/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/dfb8b51ff7c60faecf2ae903e7d2f838.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ZufHn_6IihmUGmRzqYhfw.png"/></div></div></figure><h2 id="5eac" class="mv kv it bd kw mw mx dn la my mz dp le lv na nb lg lz nc nd li md ne nf lk ng bi translated">树形地图</h2><p id="fcba" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">这个情节背后的想法是为了形象化电视节目中我和女主角的对话比例。</p><p id="abfa" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">我把我的数据帧格式化，这样单词就可以按字符计数，每个字符都被赋予一个性别和一种颜色。女人是红色的，男人是蓝色的。我需要改变数据帧的每一列，使其成为熊猫系列。然后，这可以用作使用 squarify.plot()函数的树形图的输入。</p><pre class="kj kk kl km gt nw nx ny nz aw oa bi"><span id="c2a0" class="mv kv it nx b gy ob oc l od oe">import squarify</span><span id="1d9d" class="mv kv it nx b gy ow oc l od oe">df = df.groupby([<strong class="nx iu">'name'</strong>,<strong class="nx iu">'sex'</strong>, <strong class="nx iu">'color'</strong>])[<strong class="nx iu">'words'</strong>].sum().reset_index()<br/><br/>x1=pd.Series(df[<strong class="nx iu">'name'</strong>])<br/>x2=pd.Series(df[<strong class="nx iu">'words'</strong>])<br/>x3=pd.Series(df[<strong class="nx iu">'color'</strong>])<br/>x2=x2.tolist()<br/>x1=x1.tolist()<br/>x3=x3.tolist()<br/><br/>squarify.plot(<br/>sizes=x2, <br/>label=x1, <br/>color =x3,<br/>alpha=.7,<br/>bar_kwargs=dict(linewidth=1, edgecolor=<strong class="nx iu">"#222222"</strong>))</span><span id="3b02" class="mv kv it nx b gy ow oc l od oe">plt.show()</span></pre><p id="e94b" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">瞧啊。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pq"><img src="../Images/f5950a4faf317522cd94065735a00ffb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6_Fjr5WFUM7ctwsF5gBSPw.png"/></div></div></figure><p id="c3da" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">对于《权力的游戏》的粉丝来说，看看<a class="ae mu" rel="noopener" target="_blank" href="/3-quick-and-easy-data-visualisations-inspired-by-game-of-thrones-37c0e611b9bf">这篇</a>文章:<strong class="lo iu">受《权力的游戏》启发的 3 个快速简单的数据可视化</strong></p><div class="ox oy gp gr oz pa"><a rel="noopener follow" target="_blank" href="/3-quick-and-easy-data-visualisations-inspired-by-game-of-thrones-37c0e611b9bf"><div class="pb ab fo"><div class="pc ab pd cl cj pe"><h2 class="bd iu gy z fp pf fr fs pg fu fw is bi translated">受《权力的游戏》启发的 3 种快速简单的数据可视化</h2><div class="ph l"><h3 class="bd b gy z fp pf fr fs pg fu fw dk translated">回答这个问题:我在看什么？</h3></div><div class="pi l"><p class="bd b dl z fp pf fr fs pg fu fw dk translated">towardsdatascience.com</p></div></div><div class="pj l"><div class="pr l pl pm pn pj po ks pa"/></div></div></a></div><h1 id="025a" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">非常感谢你的阅读！</h1><p id="7489" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">更多类似的文章，请点击在 Medium <a class="ae mu" href="https://towardsdatascience.com/medium.com/@alejandra.vlerick" rel="noopener" target="_blank">上找到我！</a></p><p id="4521" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">如果你有任何关于如何改进的<strong class="lo iu">问题</strong>、<strong class="lo iu">建议</strong>或<strong class="lo iu">想法</strong>，请在下面留下评论或通过 LinkedIn <a class="ae mu" href="https://www.linkedin.com/in/alejandra-g-283595b8" rel="noopener ugc nofollow" target="_blank">这里</a>取得联系。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ps"><img src="../Images/b9e69c51ca7e3ad1b00168b67c9c0a51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wlSofLFSYGTiFKMv0ektRA.jpeg"/></div></div><p class="oq or gj gh gi os ot bd b be z dk translated">照片由<a class="ae mu" href="https://unsplash.com/@wilhelmgunkel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">威廉·冈克尔</a>在<a class="ae mu" href="https://unsplash.com/s/photos/thank-you?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="6772" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">Github 知识库</h1><p id="27fa" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">所有代码都可以在 Github <a class="ae mu" href="https://github.com/alejandra-gutierrez/Chat_Analysis.git" rel="noopener ugc nofollow" target="_blank">上的<strong class="lo iu"> got_analysis.py </strong>文件中找到这里</a>。</p></div></div>    
</body>
</html>