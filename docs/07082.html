<html>
<head>
<title>Build Python Packages Without Publishing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在不发布的情况下构建 Python 包</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-python-package-without-publishing-e2d36c4686cd?source=collection_archive---------13-----------------------#2020-05-31">https://towardsdatascience.com/building-a-python-package-without-publishing-e2d36c4686cd?source=collection_archive---------13-----------------------#2020-05-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="97a0" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">轻松访问和组织您的 Python 模块</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/2934c5ab5667ed928913f5499cdea126.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TewEs-3n49g--3TF"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ky" href="https://unsplash.com/@fempreneurstyledstock?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Leone Venter </a>拍摄的照片</p></figure><p id="6bd1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">python 中的包允许无缝分发 Python 模块。当我们使用 pip install 时，我们经常从<a class="ae ky" href="https://pypi.org/" rel="noopener ugc nofollow" target="_blank"> PyPI </a>下载一个公开可用的包。本地包对于代码组织和重用也很有用，允许您简单地导入一个模块，而不必导航到它的目录或重写代码。在本次演示中，我们将构建和访问一个基本的 Python 包。</p><p id="8816" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我们创建两个简单的模块并将它们打包。然后，我们将使用这个包编写一个简单的应用程序，提示用户从他们的计算机中选择一个. jpg 图像进行灰度化。</p><h1 id="4ca4" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">编写您的模块</h1><p id="ba15" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><em class="ms"> ui.py </em></p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="6c6a" class="my lw it mu b gy mz na l nb nc">#ui.py</span><span id="b3fc" class="my lw it mu b gy nd na l nb nc">from tkinter import filedialog<br/>from tkinter import Tk</span><span id="361f" class="my lw it mu b gy nd na l nb nc">def get_image_file():<br/>    Tk().withdraw()<br/>    filename =  filedialog.askopenfilename(title = "Select file",filetypes = [("jpeg files","*.jpg")])<br/>    return filename</span></pre><p id="c578" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ms"> image_edits.py </em></p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="bbc5" class="my lw it mu b gy mz na l nb nc">#image_edits.py</span><span id="a31d" class="my lw it mu b gy nd na l nb nc">from cv2 import imread, COLOR_RGB2GRAY, cvtColor, imwrite<br/>import os</span><span id="0003" class="my lw it mu b gy nd na l nb nc">def write_grayscale_image(filepath):<br/>    original_image = imread(filepath)<br/>    grayed_image = cvtColor(original_image, COLOR_RGB2GRAY)<br/>    grayed_filename=os.path.join(os.path.split(filepath)[0],'grayed_'+os.path.split(filepath)[1])<br/>    print(grayed_filename)<br/>    imwrite(grayed_filename, grayed_image) #export grayscaled image<br/>    return grayed_filename</span></pre><h1 id="b018" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">初始化和设置文件</h1><p id="d78f" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">创建一个空白的<em class="ms"> __init__。py </em>文件，Python 将使用它来识别这个包。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="ae90" class="my lw it mu b gy mz na l nb nc">$ touch __init__.py</span></pre><p id="0327" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此时，我们的文件结构应该如下所示:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="42a5" class="my lw it mu b gy mz na l nb nc">dir/<br/>    image_pkg/<br/>              ui.py<br/>              image_edits.py<br/>              __init__.py</span></pre><p id="cfd5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">接下来，在您的包目录外创建一个<em class="ms"> setup.py </em>文件</p><p id="2434" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ms"> setup.py </em></p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="f530" class="my lw it mu b gy mz na l nb nc">import setuptools</span><span id="dd00" class="my lw it mu b gy nd na l nb nc">setuptools.setup(name='examplepackage',<br/>version='0.1',<br/>description='An example package',<br/>url='#',<br/>author='max',<br/>install_requires=['opencv-python'],<br/>author_email='',<br/>packages=setuptools.find_packages(),<br/>zip_safe=False)</span></pre><p id="0b0c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">注意，python 标准库中没有包含的包应该包含在<em class="ms"> install_requires </em>中。我们的文件结构现在应该看起来像这样:</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="71c2" class="my lw it mu b gy mz na l nb nc">dir/<br/>    image_pkg/<br/>              ui.py<br/>              image_edits.py<br/>              __init__.py<br/>    setup.py</span></pre><h1 id="93ff" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">构建并安装您的软件包</h1><p id="fda3" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">如果您正在使用<a class="ae ky" href="https://docs.python.org/3/tutorial/venv.html" rel="noopener ugc nofollow" target="_blank">虚拟环境</a>(Python 开发的一般良好实践)，创建并激活您的环境。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="f895" class="my lw it mu b gy mz na l nb nc">$ python3 -m venv myenv<br/>$ source myenv/bin/activate</span></pre><p id="85dd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">安装车轮。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="8139" class="my lw it mu b gy mz na l nb nc">$ pip install wheel</span></pre><p id="9ce6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">将软件包安装到您的环境中。</p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="cc14" class="my lw it mu b gy mz na l nb nc">$ pip install .</span></pre><p id="09d5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的包已经创建好了，现在我们可以在任何地方使用它。让我们创建一个简单的应用程序，它包含了我们的包内容。</p><p id="815c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ms"> main.py </em></p><pre class="kj kk kl km gt mt mu mv mw aw mx bi"><span id="2484" class="my lw it mu b gy mz na l nb nc">#main.py</span><span id="0056" class="my lw it mu b gy nd na l nb nc">from image_pkg.ui import get_image_file<br/>from image_pkg.image_edits import write_grayscale_image</span><span id="dec5" class="my lw it mu b gy nd na l nb nc">write_grayscale_image(get_image_file())</span></pre><p id="7fc0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在已经构建并实现了一个基本的 python 包！关于软件包分发、许可和安装的更多信息可以在<a class="ae ky" href="https://packaging.python.org/tutorials/packaging-projects/#" rel="noopener ugc nofollow" target="_blank">文档</a>中找到。</p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h2 id="7c85" class="my lw it bd lx nl nm dn mb nn no dp mf li np nq mh lm nr ns mj lq nt nu ml nv bi translated">其他 Python 教程:</h2><div class="nw nx gp gr ny nz"><a rel="noopener follow" target="_blank" href="/solving-mazes-with-python-f7a412f2493f"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">用 Python 解迷宫</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">使用 Dijkstra 的算法和 OpenCV</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">towardsdatascience.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on ks nz"/></div></div></a></div><div class="nw nx gp gr ny nz"><a rel="noopener follow" target="_blank" href="/building-a-simple-ui-for-python-fd0e5f2a2d8b"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">为 Python 构建一个简单的 UI</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">Streamlit:一个基于浏览器的 Python UI，不需要 HTML/CSS/JS</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">towardsdatascience.co</p></div></div><div class="oi l"><div class="oo l ok ol om oi on ks nz"/></div></div></a></div></div></div>    
</body>
</html>