<html>
<head>
<title>Heart Disease UCI-Diagnosis &amp; Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">心脏病 UCI-诊断和预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/heart-disease-uci-diagnosis-prediction-b1943ee835a7?source=collection_archive---------0-----------------------#2020-06-18">https://towardsdatascience.com/heart-disease-uci-diagnosis-prediction-b1943ee835a7?source=collection_archive---------0-----------------------#2020-06-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="99c5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><em class="kf">使用逻辑回归进行预测，准确率为 87%</em></h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/cd292a008aff6b9be9f5658f33e3faca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*P-EN5Z4l3LbWg4V8"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">由<a class="ae kw" href="https://unsplash.com/@averey?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Robina Weermeijer </a>在<a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="d81e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">每天，人类的平均心脏跳动约 10 万次，将 2000 加仑的血液输送到全身。在你的体内有 60，000 英里长的血管。</p><p id="aecd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">女性心脏病发作的迹象远不如男性明显。在女性中，心脏病发作可能会感到胸部中心挤压、压力、胀满或疼痛等不适。它也可能导致一个或两个手臂，背部，颈部，下巴或胃部疼痛，呼吸急促，恶心和其他症状。男性经历心脏病发作的典型症状，如胸痛、不适和压力。他们也可能经历其他部位的疼痛，如手臂、颈部、背部和下巴，以及呼吸急促、出汗和类似烧心的不适。</p><p id="9adb" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">对于一个就像一个大拳头，重量在 8 到 12 盎司之间的器官来说，这是一个很大的工作量。</p><p id="bdd0" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">来源:healthblog.uofmhealth</p><p id="ca6f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">由 Hardik 编码:</strong></p><p id="ce3f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">Google colab 笔记本链接:<a class="ae kw" href="https://colab.research.google.com/drive/16iFRPq0vx_CZypo4ZyJ_qTLrvds3FlDb?usp=sharing" rel="noopener ugc nofollow" target="_blank">https://colab . research . Google . com/drive/16 ifrpq 0 VX _ czy po 4 zyj _ qtlrvds 3 fldb？usp =分享</a></p><p id="240c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">GitHub:<a class="ae kw" href="https://github.com/smarthardik10/Heart-Disease-UCI-Diagnosis-Prediction" rel="noopener ugc nofollow" target="_blank">https://GitHub . com/smarthardk 10/Heart-Disease-UCI-诊断-预测</a></p><p id="c7a8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">UCI 心脏病数据集:</strong></p><p id="b835" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据集来源:<a class="ae kw" href="https://archive.ics.uci.edu/ml/datasets/Heart+Disease" rel="noopener ugc nofollow" target="_blank">https://archive.ics.uci.edu/ml/datasets/Heart+Disease</a></p><p id="a818" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">数据集列:</strong></p><ul class=""><li id="9139" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">年龄:以年为单位的人员年龄</li><li id="e4ac" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">性别:人的性别(1 =男性，0 =女性)</li><li id="f29e" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">cp:胸痛类型<br/> —值 0:无症状<br/> —值 1:不典型心绞痛<br/> —值 2:非心绞痛性疼痛<br/> —值 3:典型心绞痛</li><li id="31c6" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">trestbps:患者的静息血压(入院时为毫米汞柱)</li><li id="3b9e" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">胆固醇:人体的胆固醇含量，单位为毫克/分升</li><li id="114c" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">fbs:人的空腹血糖(&gt; 120 mg/dl，1 =真；0 =假)</li><li id="6335" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">restecg:静息心电图结果<br/> —值 0:根据 Estes 标准<br/> —值 1:正常<br/> —值 2:ST-T 波异常(T 波倒置和/或 ST 段抬高或压低&gt; 0.05 mV)</li><li id="1aae" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">thalach:人达到的最大心率</li><li id="047b" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">exang:运动诱发的心绞痛(1 =是；0 =否)</li><li id="6abf" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">oldpeak:运动相对于休息诱发的 st 段压低(“ST”与心电图图上的位置有关。点击此处查看更多)</li><li id="1553" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">斜率:运动 ST 段峰值的斜率— 0:下降；1:平；2:上坡<br/> 0:下坡；1:平；2:上坡</li><li id="49de" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">ca:主要血管的数量(0-3)</li><li id="5fe8" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">地中海贫血:一种称为地中海贫血的血液疾病值 0:空(从先前的数据集中删除<br/>值 1:固定缺陷(心脏的某些部分没有血流)<br/>值 2:正常血流<br/>值 3:可逆缺陷(观察到血流但不正常)</li><li id="17c7" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">目标:心脏病(1 =否，0=是)</li></ul><p id="09e2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">语境:</strong></p><p id="5276" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这是多变量类型的数据集，这意味着提供或涉及各种单独的数学或统计变量，多变量数值数据分析。它由 14 个属性组成，即年龄、性别、胸痛类型、静息血压、血清胆固醇、空腹血糖、静息心电图结果、达到的最大心率、运动诱发的心绞痛、运动相对于静息诱发的老峰-st 段压低、运动 ST 段峰值斜率、主要血管数和地中海贫血。该数据库包括 76 个属性，但所有发表的研究都涉及其中 14 个属性的子集的使用。克利夫兰数据库是迄今为止 ML 研究人员唯一使用的数据库。该数据集的主要任务之一是基于患者的给定属性来预测该特定人是否患有心脏病，其他任务是实验性任务，以诊断并从该数据集找出各种见解，这有助于更好地理解问题。</p><p id="d419" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir">数据集由:- </strong>创建</p><p id="04c1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">1.匈牙利心脏病研究所。布达佩斯:医学博士安朵斯·雅诺西。瑞士苏黎世大学医院:William Steinbrunn，医学博士。瑞士巴塞尔大学医院:医学博士马蒂亚斯·普菲斯特勒。弗吉尼亚医疗中心，长滩和克利夫兰诊所基金会:罗伯特·德特拉诺，医学博士，哲学博士。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="608c" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">目录</h2><ol class=""><li id="25db" class="lt lu iq kz b la nh ld ni lg nj lk nk lo nl ls nm lz ma mb bi translated"><a class="ae kw" href="#a3db" rel="noopener ugc nofollow">导入和读取数据集</a></li><li id="50cf" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls nm lz ma mb bi translated"><a class="ae kw" href="#1257" rel="noopener ugc nofollow">数据描述</a></li></ol><ul class=""><li id="0408" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated"><a class="ae kw" href="#0140" rel="noopener ugc nofollow">描述</a></li><li id="bacb" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated"><a class="ae kw" href="#de14" rel="noopener ugc nofollow">空值</a></li></ul><p id="d915" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">3.<a class="ae kw" href="#d39b" rel="noopener ugc nofollow">数据分析</a></p><ul class=""><li id="8bff" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated"><a class="ae kw" href="#70b1" rel="noopener ugc nofollow"> 1)单变量选择</a></li><li id="0c23" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated"><a class="ae kw" href="#70f9" rel="noopener ugc nofollow"> 2)特征选择</a></li><li id="d451" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated"><a class="ae kw" href="#2bcc" rel="noopener ugc nofollow"> 3)与热图的关联矩阵</a></li></ul><p id="5714" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">4.<a class="ae kw" href="#82cd" rel="noopener ugc nofollow">数据可视化</a></p><ul class=""><li id="8415" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">1) <a class="ae kw" href="#61e6" rel="noopener ugc nofollow">计数图</a></li><li id="869b" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">2) <a class="ae kw" href="#ecb0" rel="noopener ugc nofollow">距离图</a></li><li id="4f53" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">3) <a class="ae kw" href="#077e" rel="noopener ugc nofollow">接头图</a></li><li id="0f07" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">4) <a class="ae kw" href="#23b0" rel="noopener ugc nofollow">矩形图/紫色图</a></li><li id="ae41" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">5) <a class="ae kw" href="#c467" rel="noopener ugc nofollow">集群地图</a></li><li id="635e" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">6) <a class="ae kw" href="#36ad" rel="noopener ugc nofollow"> Pairplot </a></li><li id="642f" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated"><a class="ae kw" href="#3ec5" rel="noopener ugc nofollow">分类树</a></li></ul><p id="683c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">5.<a class="ae kw" href="#ba87" rel="noopener ugc nofollow">数据预处理</a></p><ul class=""><li id="e155" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">1) <a class="ae kw" href="#5ada" rel="noopener ugc nofollow">预处理</a></li><li id="d2e2" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">2) <a class="ae kw" href="#3cd8" rel="noopener ugc nofollow">一个热编码</a></li></ul><p id="db96" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">6.<a class="ae kw" href="#7e86" rel="noopener ugc nofollow">逻辑回归</a></p><ul class=""><li id="9605" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">1) <a class="ae kw" href="#2bd0" rel="noopener ugc nofollow">聚集列</a></li><li id="fcf4" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">2) <a class="ae kw" href="#f346" rel="noopener ugc nofollow">拆分数据</a></li><li id="23bf" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">3) <a class="ae kw" href="#1edc" rel="noopener ugc nofollow">正常化</a></li><li id="daee" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">4) <a class="ae kw" href="#b904" rel="noopener ugc nofollow">拟合入模型</a></li><li id="b474" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">5) <a class="ae kw" href="#c22c" rel="noopener ugc nofollow">预测</a></li><li id="a7ae" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">6) <a class="ae kw" href="#0621" rel="noopener ugc nofollow">模型评估</a></li></ul><p id="c47e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">7.<a class="ae kw" href="#7f6e" rel="noopener ugc nofollow">结论</a></p><ul class=""><li id="4255" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">1) <a class="ae kw" href="#4600" rel="noopener ugc nofollow">系数</a></li><li id="6403" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">2) <a class="ae kw" href="#da70" rel="noopener ugc nofollow">分析</a></li><li id="7d8c" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">3) <a class="ae kw" href="#d3f0" rel="noopener ugc nofollow">结论</a></li></ul><h1 id="a3db" class="nn mp iq bd mq no np nq mt nr ns nt mw jw nu jx mz jz nv ka nc kc nw kd nf nx bi translated">1.导入和读取数据集</h1><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="28b0" class="mo mp iq nz b gy od oe l of og">import numpy as np<br/>import pandas as pd<br/>import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>%matplotlib inline</span><span id="ec75" class="mo mp iq nz b gy oh oe l of og">df = pd.read_csv('/content/drive/My Drive/dataset/heart.csv')</span><span id="d8fa" class="mo mp iq nz b gy oh oe l of og">df.head()</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oi"><img src="../Images/bbb42879a890cd2569153eb287d1743d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FChFX1q0zMKFSoF585Fz3g.png"/></div></div><p class="ks kt gj gh gi ku kv bd b be z dk translated">heart.csv</p></figure><h1 id="1257" class="nn mp iq bd mq no np nq mt nr ns nt mw jw nu jx mz jz nv ka nc kc nw kd nf nx bi translated">2.数据描述</h1><h2 id="0140" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">形容</h2><p id="bc7a" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg oj li lj lk ok lm ln lo ol lq lr ls ij bi translated">关于元数据有很多混乱，因为有各种不同的元数据可用。下面我从 kaggle 得到了两个最常用的元数据描述。所以我们要遵循第二个描述(2 —描述)。</p><p id="7be6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">1 —描述</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="c2db" class="mo mp iq nz b gy od oe l of og">•    age: The person's age in years<br/>•    sex: The person's sex (1 = male, 0 = female)<br/>•    cp: The chest pain experienced (Value 1: typical angina, Value 2: atypical angina, Value 3: non-anginal pain, Value 4: asymptomatic)<br/>•    trestbps: The person's resting blood pressure (mm Hg on admission to the hospital)<br/>•    chol: The person's cholesterol measurement in mg/dl<br/>•    fbs: The person's fasting blood sugar (&gt; 120 mg/dl, 1 = true; 0 = false)<br/>•    restecg: Resting electrocardiographic measurement (0 = normal, 1 = having ST-T wave abnormality, 2 = showing probable or definite left ventricular hypertrophy by Estes' criteria)<br/>•    thalach: The person's maximum heart rate achieved<br/>•    exang: Exercise induced angina (1 = yes; 0 = no)<br/>•    oldpeak: ST depression induced by exercise relative to rest ('ST' relates to positions on the ECG plot. See more here)<br/>•    slope: the slope of the peak exercise ST segment (Value 1: upsloping, Value 2: flat, Value 3: downsloping)<br/>•    ca: The number of major vessels (0-3)<br/>•    thal: A blood disorder called thalassemia (3 = normal; 6 = fixed defect; 7 = reversable defect)<br/>•    target: Heart disease (0 = no, 1 = yes)</span></pre><p id="6d38" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">2 —描述</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="34a3" class="mo mp iq nz b gy od oe l of og"><br/>cp: chest pain type<br/>-- Value 0: asymptomatic<br/>-- Value 1: atypical angina<br/>-- Value 2: non-anginal pain<br/>-- Value 3: typical angina<br/> <br/>restecg: resting electrocardiographic results<br/>-- Value 0: showing probable or definite left ventricular hypertrophy by Estes' criteria<br/>-- Value 1: normal<br/>-- Value 2: having ST-T wave abnormality (T wave inversions and/or ST elevation or depression of &gt; 0.05 mV)<br/> <br/>slope: the slope of the peak exercise ST segment<br/>0: downsloping; 1: flat; 2: upsloping<br/> <br/>thal<br/>Results of the blood flow observed via the radioactive dye.<br/> <br/>Value 0: NULL (dropped from the dataset previously)<br/>Value 1: fixed defect (no blood flow in some part of the heart)<br/>Value 2: normal blood flow<br/>Value 3: reversible defect (a blood flow is observed but it is not normal)<br/>This feature and the next one are obtained through a very invasive process for the patients. But, by themselves, they give a very good indication of the presence of a heart disease or not.<br/> <br/>target : 0 = disease, 1 = no disease</span><span id="c7b3" class="mo mp iq nz b gy oh oe l of og">df.info()</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi om"><img src="../Images/9256cba91f3d82be22f8439f5547a9da.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*yxC3bm0HVtC_D2vHnCX91w.png"/></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="4335" class="mo mp iq nz b gy od oe l of og">df.describe()</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi on"><img src="../Images/2b2f145d2556e78722c1d2735a41d8f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UWNBo9FyXb0xAwX0fIFPhw.png"/></div></div></figure><h2 id="de14" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">空</h2><p id="d960" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg oj li lj lk ok lm ln lo ol lq lr ls ij bi translated">检查空值</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="19c3" class="mo mp iq nz b gy od oe l of og">df.isnull().sum()</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/d1e72976f3f5965df0318fbbfa58dd94.png" data-original-src="https://miro.medium.com/v2/resize:fit:260/format:webp/1*dEG2y85mRD4rKildsE42cw.png"/></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="36d9" class="mo mp iq nz b gy od oe l of og">#visualizing Null values if it exists <br/>plt.figure(figsize=(22,10))</span><span id="1d6a" class="mo mp iq nz b gy oh oe l of og">plt.xticks(size=20,color='grey')<br/>plt.tick_params(size=12,color='grey')</span><span id="9be3" class="mo mp iq nz b gy oh oe l of og">plt.title('Finding Null Values Using Heatmap\n',color='grey',size=30)</span><span id="9f4b" class="mo mp iq nz b gy oh oe l of og">sns.heatmap(df.isnull(),<br/>            yticklabels=False,<br/>            cbar=False,<br/>            cmap='PuBu_r',<br/>            )</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi op"><img src="../Images/597418f6421174be1a61dff38367dbcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4fSN0cVrxWSxO1a1qUwyfA.png"/></div></div></figure><p id="feb6" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">数据集没有空值</p><h2 id="3123" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">熊猫-侧写</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="b9f5" class="mo mp iq nz b gy od oe l of og">!pip install https://github.com/pandas-profiling/pandas-profiling/archive/master.zip</span><span id="8730" class="mo mp iq nz b gy oh oe l of og">import pandas_profiling as pp<br/>pp.ProfileReport(df)</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi oq"><img src="../Images/01524333f725c2a714208739553730a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*miyjIt6hf5wjgAKDZJZ2ZA.png"/></div></div></figure><p id="a997" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">详细查看:<a class="ae kw" href="https://colab.research.google.com/drive/16iFRPq0vx_CZypo4ZyJ_qTLrvds3FlDb#scrollTo=5crIBqgn9FiI&amp;line=1&amp;uniqifier=1" rel="noopener ugc nofollow" target="_blank">https://colab . research . Google . com/drive/16 ifrpq 0 VX _ czypo 4 zyj _ qtlrvds 3 fldb # scroll to = 5 cribqgn 9 fii&amp;line = 1&amp;uniqifier = 1</a></p><h1 id="d39b" class="nn mp iq bd mq no np nq mt nr ns nt mw jw nu jx mz jz nv ka nc kc nw kd nf nx bi translated">3.数据分析</h1><p id="c159" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg oj li lj lk ok lm ln lo ol lq lr ls ij bi translated"><strong class="kz ir">功能选择</strong></p><ol class=""><li id="70b1" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls nm lz ma mb bi translated">单变量选择—统计测试可用于挑选与性能变量有最佳关系的某些特征。<br/>sci kit-learn 库提供了 SelectKBest 类，可用于在一套不同的统计测试中选择特定数量的特征。<br/>以下示例使用非负特征的卡方(chi2)统计测试从数据集中选择 13 个最佳特征。</li></ol><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="a099" class="mo mp iq nz b gy od oe l of og">from sklearn.feature_selection import SelectKBest<br/>from sklearn.feature_selection import chi2<br/>data = df.copy()<br/>X = data.iloc[:,0:13]  #independent columns<br/>y = data.iloc[:,-1]    #target column <br/>#apply SelectKBest class to extract top best features<br/>bestfeatures = SelectKBest(score_func=chi2, k=10)<br/>fit = bestfeatures.fit(X,y)<br/>dfscores = pd.DataFrame(fit.scores_)<br/>dfcolumns = pd.DataFrame(X.columns)<br/>#concat two dataframes for better visualization <br/>featureScores = pd.concat([dfcolumns,dfscores],axis=1)<br/>featureScores.columns = ['Specs','Score']  #naming the dataframe columns<br/>print(featureScores.nlargest(12,'Score'))  #print best features</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi or"><img src="../Images/9b13ad5ed8021f0326b9422a4c585165.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*JL8RAzx-lPaRWIUebanpkA.png"/></div></figure><p id="70f9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">2.要素重要性-通过使用模型特征属性，可以获得数据集每个要素的重要性。<br/>特征值为您的结果的每个功能给出一个分数，分数越高，性能变量越重要或合适。<br/>特征重要性是基于树的分类器自带的内置类，我们将使用额外的树分类器来提取数据集的顶部特征。</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="6eb1" class="mo mp iq nz b gy od oe l of og">from sklearn.ensemble import ExtraTreesClassifier</span><span id="1380" class="mo mp iq nz b gy oh oe l of og">model = ExtraTreesClassifier()<br/>model.fit(X,y)<br/>print(model.feature_importances_) #use inbuilt class feature_importances of tree based classifiers<br/>#plot graph of feature importances for better visualization<br/>feat_importances = pd.Series(model.feature_importances_, index=X.columns)<br/>feat_importances.nlargest(13).plot(kind='barh')<br/>plt.show()</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi os"><img src="../Images/6d46d773da7bd310bc1101e51bc1a292.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*7VsCFn67kr0qeCdzXyHjxw.png"/></div></figure><p id="2bcc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">3.带热点图的关联矩阵-关联表示要素之间或要素与目标变量之间的关联方式。<br/>相关性可能是正的(增加一个特性值会增加目标变量的值)或负的(增加一个特性值会减少目标变量的值)<br/>热图可以很容易地对与目标变量最相关的特性进行分类，我们将使用 seaborn 库绘制热图的相关特性。</p><p id="d770" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">相关性显示特征是否相互关联或与目标变量相关。相关性可以是正的(增加一个值，目标变量的值增加)或负的(增加一个值，目标变量的值减少)。从该热图中，我们可以观察到“cp”胸痛与目标变量高度相关。与其他两个变量之间的关系相比，我们可以说胸痛在预测心脏病的存在方面贡献最大。医疗急救是心脏病发作。当血块阻塞了流向心脏的血液时，通常会发生心脏病。组织在没有血液的情况下失去氧气并死亡，导致胸痛。</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="be2e" class="mo mp iq nz b gy od oe l of og">plt.figure(figsize=(12,10))<br/>sns.heatmap(df.corr(),annot=True,cmap="magma",fmt='.2f')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ot"><img src="../Images/3dc69dd163daa893158f40846ccb56ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OJWYxl9iZz3P6airL5fmgA.png"/></div></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="54e6" class="mo mp iq nz b gy od oe l of og">for i in df.columns:<br/>    print(i,len(df[i].unique()))</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/f0b1d23bea1f4c418c6036cd71286881.png" data-original-src="https://miro.medium.com/v2/resize:fit:234/format:webp/1*86e8b8XzoBIREqwNZQs7Vg.png"/></div></figure><h1 id="82cd" class="nn mp iq bd mq no np nq mt nr ns nt mw jw nu jx mz jz nv ka nc kc nw kd nf nx bi translated">4.数据可视化</h1><p id="a5c5" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg oj li lj lk ok lm ln lo ol lq lr ls ij bi translated"><strong class="kz ir"> Seaborn </strong></p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="871e" class="mo mp iq nz b gy od oe l of og">sns.set_style('darkgrid')<br/>sns.set_palette('Set2')</span></pre><p id="3e29" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">准备数据</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="a435" class="mo mp iq nz b gy od oe l of og">df2 = df.copy()</span><span id="99b0" class="mo mp iq nz b gy oh oe l of og">def chng(sex):<br/>    if sex == 0:<br/>        return 'female'<br/>    else:<br/>        return 'male'</span><span id="9a9b" class="mo mp iq nz b gy oh oe l of og">df2['sex'] = df2['sex'].apply(chng)</span><span id="6118" class="mo mp iq nz b gy oh oe l of og">def chng2(prob):<br/>    if prob == 0:<br/>        return ‘Heart Disease’<br/>    else:<br/>        return ‘No Heart Disease’</span><span id="93f8" class="mo mp iq nz b gy oh oe l of og">df2['target'] = df2['target'].apply(chng2)</span></pre><h2 id="61e6" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">1.计数图</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="a458" class="mo mp iq nz b gy od oe l of og">df2['target'] = df2['target'].apply(chng2)<br/>sns.countplot(data= df2, x='sex',hue='target')<br/>plt.title('Gender v/s target\n')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/523d593ea89a736c768c93dbd6973658.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*Frqo3efoecW7-FKQO74rOQ.png"/></div></figure><p id="1e2f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">根据克利夫兰的数据，男性比女性更容易患心脏病。男性比女性更容易患心脏病。70% — 89%的男性经历过突发心脏病。女性可能会在完全没有胸部压力的情况下经历心脏病发作，她们通常会经历恶心或呕吐，这往往与胃酸倒流或流感相混淆。</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="10c3" class="mo mp iq nz b gy od oe l of og">sns.countplot(data= df2, x='cp',hue='target')<br/>plt.title('Chest Pain Type v/s target\n')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/3cf96022b5c4a9ea086da05c1d65f33e.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*RBxhQbotl_CtbE0olR0awg.png"/></div></figure><p id="1cd1" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">有四种类型的胸痛，无症状、非典型心绞痛、非心绞痛性疼痛和典型心绞痛。大多数心脏病患者被发现有无症状的胸痛。这些人群可能会出现非典型症状，如消化不良、流感或胸肌劳损。与任何心脏病发作一样，无症状的发作会导致流向心脏的血流受阻，并可能对心肌造成损害。无症状心脏病发作的危险因素与有心脏病症状的相同。这些因素包括:</p><p id="a48d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">年龄</p><p id="64db" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">糖尿病</p><p id="1935" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">过重</p><p id="9bce" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">心脏病家族史</p><p id="34dd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">高血压</p><p id="c8a9" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">高胆固醇</p><p id="b398" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">缺乏锻炼</p><p id="769f" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">先前心脏病发作</p><p id="2ac3" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">烟草使用</p><p id="1fc5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">无症状的心脏病发作会增加你再次心脏病发作的风险，这可能是致命的。再次心脏病发作也会增加并发症的风险，如心力衰竭。没有测试来确定你无症状心脏病发作的可能性。判断你是否有无症状发作的唯一方法是通过心电图或超声心动图。这些测试可以揭示预示心脏病发作的变化。</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="0cc7" class="mo mp iq nz b gy od oe l of og">sns.countplot(data= df2, x='sex',hue='thal')<br/>plt.title('Gender v/s Thalassemia\n')<br/>print('Thalassemia (thal-uh-SEE-me-uh) is an inherited blood disorder that causes your body to have less hemoglobin than normal. Hemoglobin enables red blood cells to carry oxygen')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/d22bc1e230295889d2f715704578ab7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*tTTn5oE0Jmjpr4QTwf3xsw.png"/></div></figure><p id="97df" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">β地中海贫血性心肌病主要以两种不同的表型为特征，扩张型伴有左心室扩张和收缩性受损，而限制性表型伴有限制性左心室感觉、肺动脉高压和右心衰竭。心脏问题、充血性心力衰竭和心律异常可能与严重的地中海贫血有关。</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="3126" class="mo mp iq nz b gy od oe l of og">sns.countplot(data= df2, x='slope',hue='target')<br/>plt.title('Slope v/s Target\n')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/430f68931934801e1b36638c2d3424a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*41GDC-L_TbvbDQCtoRuZwg.png"/></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="1c5c" class="mo mp iq nz b gy od oe l of og">sns.countplot(data= df2, x='exang',hue='thal')<br/>plt.title('exang v/s Thalassemia\n')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/e4759b4b7cfbe1506c91a4654832d01d.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*MpGogTHk2UYrLDzw7JMN8Q.png"/></div></figure><h2 id="ecb0" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">2.距离图</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="b6c5" class="mo mp iq nz b gy od oe l of og">plt.figure(figsize=(16,7))<br/>sns.distplot(df[df['target']==0]['age'],kde=False,bins=50)<br/>plt.title('Age of Heart Diseased Patients\n')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/d7e0e215aa269d2c525f9339c6a6d67d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*srpiDM9ZzegmZmxm2lA7IA.png"/></div></figure><p id="ac9a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">心脏病在 60 岁及以上年龄组的老年人中非常常见，在 41 至 60 岁年龄组的成年人中也很常见。但是在 19 到 40 岁的年龄组中很少见，在 0 到 18 岁的年龄组中非常少见。</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="1b2b" class="mo mp iq nz b gy od oe l of og">plt.figure(figsize=(16,7))<br/>sns.distplot(df[df['target']==0]['chol'],kde=False,bins=40)<br/>plt.title('Chol of Heart Diseased Patients\n')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pb"><img src="../Images/96215cfed76068f9ec5e6f5b84efdec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JZpR2DHBWlDRwOj2o8Ls6g.png"/></div></div></figure><ul class=""><li id="c78e" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">总胆固醇</li><li id="0fc7" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">低密度脂蛋白——“坏胆固醇”</li><li id="7709" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">高密度脂蛋白——“好胆固醇”</li></ul><p id="5025" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在成人中，总胆固醇水平低于 200 毫克/分升(mg / dL)被认为是理想的。在 200 至 239 毫克/分升和 240 毫克/分升及以上之间的边界线被认为是高的。低密度脂蛋白应含有少于 100 毫克/分升的胆固醇。对于没有任何健康问题的人来说，100 mg / dl 的剂量率是合适的，但对于有心脏问题或有心脏病风险因素的人来说可能更合适。水平介于 130 至 159 毫克/分升和 160 至 189 毫克/分升之间。读数很高，达到或超过 190 毫克/分升。高密度脂蛋白水平应保持在较高水平。心血管疾病的危险因素被称为读数低于 40 毫克/分升。临界低被认为是在 41 毫克/分升和 59 毫克/分升之间。高密度脂蛋白水平最高可达 60 毫克/分升。</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="eb93" class="mo mp iq nz b gy od oe l of og">plt.figure(figsize=(16,7))<br/>sns.distplot(df[df['target']==0]['thalach'],kde=False,bins=40)<br/>plt.title('thalach of Heart Diseased Patients\n')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pc"><img src="../Images/c7a8b9a63bb194dd7f69415aab4fafe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eSAbEyeHF2RvAgY2NGME9w.png"/></div></div></figure><h2 id="077e" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">3.接合图</h2><p id="ce7f" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg oj li lj lk ok lm ln lo ol lq lr ls ij bi translated">准备数据</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="1c3b" class="mo mp iq nz b gy od oe l of og">df3 = df[df['target'] == 0 ][['age', 'sex', 'cp', 'trestbps', 'chol', 'fbs', 'restecg', 'thalach',<br/>       'exang', 'oldpeak', 'slope', 'ca', 'thal', 'target']] <br/>#target 0 - people with heart disease</span><span id="c2cd" class="mo mp iq nz b gy oh oe l of og">pal = sns.light_palette("blue", as_cmap=True)</span><span id="0c97" class="mo mp iq nz b gy oh oe l of og">print('Age vs trestbps(Heart Diseased Patinets)')<br/>sns.jointplot(data=df3,<br/>              x='age',<br/>              y='trestbps',<br/>              kind='hex',<br/>              cmap='Reds'<br/>           <br/>              )</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/28178e05f47984618ed6843c8752df90.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*HfoR09Ivh91PZAROLGwNBQ.png"/></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="ac7d" class="mo mp iq nz b gy od oe l of og">sns.jointplot(data=df3,<br/>              x='chol',<br/>              y='age',<br/>              kind='kde',<br/>              cmap='PuBu'<br/>              )</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/32a9a2ba1dd58b0b068f026ed0f2fe8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*1ot8W_nVB73yrWuHsrAn8w.png"/></div></figure><p id="817c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">seaborn 的联合图有助于我们理解两个特征之间的趋势。从上面的图中可以看出，大多数 50 多岁或 60 多岁的心脏病患者的胆固醇含量在 200 毫克/分升到 300 毫克/分升之间。</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="ad89" class="mo mp iq nz b gy od oe l of og">sns.jointplot(data=df3,<br/>              x='chol',<br/>              y='trestbps',<br/>              kind='resid',<br/>             <br/>              )</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/d4fdb9ccdf449e22e095a3b45992a080.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*Ts0mlN8Boh9neGxhBwQoeA.png"/></div></figure><h2 id="23b0" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">4.箱线图/紫线图</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="3e58" class="mo mp iq nz b gy od oe l of og">sns.boxplot(data=df2,x='target',y='age')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/72cddc11eba27072e1abe426a50f0104.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/format:webp/1*h0pHBGQNlrlNquS5ifXCQg.png"/></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="c6a5" class="mo mp iq nz b gy od oe l of og">plt.figure(figsize=(14,8))<br/>sns.violinplot(data=df2,x='ca',y='age',hue='target')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pg"><img src="../Images/7739ab10587f619c77f8b54f1fe5976b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ipsuoIwrltp1pmVKP_WvoA.png"/></div></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="b1ea" class="mo mp iq nz b gy od oe l of og">sns.boxplot(data=df2,x='cp',y='thalach',hue='target')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/854149c72aeb15e5ea695e9006a25f40.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*npZjW1eWpomZl4E_vYWTyw.png"/></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="f9da" class="mo mp iq nz b gy od oe l of og">plt.figure(figsize=(10,7))<br/>sns.boxplot(data=df2,x='fbs',y='trestbps',hue='target')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pi"><img src="../Images/cae08cc75f3ae7c11d8ec567aede1f28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rxy38lPAQ-zyzLpx3ZGiTg.png"/></div></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="b8a2" class="mo mp iq nz b gy od oe l of og">plt.figure(figsize=(10,7))<br/>sns.violinplot(data=df2,x='exang',y='oldpeak',hue='target')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pj"><img src="../Images/8133acc09d126c73e9df149ba0d59f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EJPC677y31PcLdDjN5NTaQ.png"/></div></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="f0d1" class="mo mp iq nz b gy od oe l of og">plt.figure(figsize=(10,7))<br/>sns.boxplot(data=df2,x='slope',y='thalach',hue='target')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pk"><img src="../Images/e682c4c218556b67ae28c4f6a9067ed8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UhH1dECGke9Fgrpt3NwyJA.png"/></div></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="d13a" class="mo mp iq nz b gy od oe l of og">sns.violinplot(data=df2,x='thal',y='oldpeak',hue='target')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/061b848d62027ad50565652ac969de0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*HGIPA_to-lsXWssal7B0eA.png"/></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="4cfa" class="mo mp iq nz b gy od oe l of og">sns.violinplot(data=df2,x='target',y='thalach')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/3b8cbe261c61984ee3133c1f4b12a8b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*Yn39mFkfdphzjjjKZmFGIg.png"/></div></figure><h2 id="c467" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">5.聚类图</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="fb42" class="mo mp iq nz b gy od oe l of og">sns.clustermap(df.corr(),annot=True)</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pn"><img src="../Images/8c487397086fe71c37a7fc6afd4778cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C9A7UBboA25i5zyHGq_FXQ.png"/></div></div></figure><h2 id="36ad" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">6.配对图</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="1126" class="mo mp iq nz b gy od oe l of og">sns.pairplot(df,hue='cp')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi po"><img src="../Images/7d3a93204d5447282ef65032bc612fd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_CARlkLO_NKpeXWnHLr2ZA.png"/></div></div></figure><h2 id="3ec5" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">分类树</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="2015" class="mo mp iq nz b gy od oe l of og">from sklearn.tree import DecisionTreeClassifier # Import Decision Tree Classifier<br/>from sklearn.model_selection import train_test_split # Import train_test_split function<br/>from sklearn import metrics #Import scikit-learn metrics module for accuracy calculation<br/>X = df.iloc[:,0:13] # Features<br/>y = df.iloc[:,13] # Target variable<br/>X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=1) # 70% training and 30% test</span><span id="b995" class="mo mp iq nz b gy oh oe l of og"># Create Decision Tree classifer object<br/>clf = DecisionTreeClassifier()</span><span id="8c3d" class="mo mp iq nz b gy oh oe l of og"># Train Decision Tree Classifer<br/>clf = clf.fit(X_train,y_train)</span><span id="eb88" class="mo mp iq nz b gy oh oe l of og">#Predict the response for test dataset<br/>y_pred = clf.predict(X_test)</span><span id="5c1a" class="mo mp iq nz b gy oh oe l of og">print("Accuracy:",metrics.accuracy_score(y_test, y_pred))</span></pre><p id="ca26" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe pp pq pr nz b">Accuracy: 0.7142857142857143</code></p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="6550" class="mo mp iq nz b gy od oe l of og">feature_cols = ['age', 'sex', 'cp', 'trestbps','chol', 'fbs', 'restecg', 'thalach','exang', 'oldpeak', 'slope', 'ca', 'thal']</span><span id="9120" class="mo mp iq nz b gy oh oe l of og">from sklearn.tree import export_graphviz<br/>from sklearn.externals.six import StringIO  <br/>from IPython.display import Image  <br/>import pydotplus</span><span id="d10c" class="mo mp iq nz b gy oh oe l of og">dot_data = StringIO()<br/>export_graphviz(clf, out_file=dot_data,  <br/>                filled=True, rounded=True,<br/>                special_characters=True,feature_names = feature_cols  ,class_names=['0','1'])<br/>graph = pydotplus.graph_from_dot_data(dot_data.getvalue())  <br/>graph.write_png('diabetes.png')<br/>Image(graph.create_png())</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ps"><img src="../Images/d0f1e11d02d12eede83df4bf39152cde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BdWLh3XlVwJhgv3X93eprw.png"/></div></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="7f5e" class="mo mp iq nz b gy od oe l of og"># Create Decision Tree classifer object<br/>clf = DecisionTreeClassifier(criterion="entropy", max_depth=3)</span><span id="06fc" class="mo mp iq nz b gy oh oe l of og"># Train Decision Tree Classifer<br/>clf = clf.fit(X_train,y_train)</span><span id="3451" class="mo mp iq nz b gy oh oe l of og">#Predict the response for test dataset<br/>y_pred = clf.predict(X_test)</span><span id="3818" class="mo mp iq nz b gy oh oe l of og"># Model Accuracy, how often is the classifier correct?<br/>print("Accuracy:",metrics.accuracy_score(y_test, y_pred))</span></pre><p id="98fa" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe pp pq pr nz b">Accuracy: 0.7362637362637363</code></p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="0bf4" class="mo mp iq nz b gy od oe l of og">from sklearn.externals.six import StringIO  <br/>from IPython.display import Image  <br/>from sklearn.tree import export_graphviz<br/>import pydotplus<br/>dot_data = StringIO()<br/>export_graphviz(clf, out_file=dot_data,  <br/>                filled=True, rounded=True,<br/>                special_characters=True, feature_names = feature_cols,class_names=['0','1'])<br/>graph = pydotplus.graph_from_dot_data(dot_data.getvalue())  <br/>graph.write_png('diabetes.png')<br/>Image(graph.create_png())</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi pt"><img src="../Images/1e5f12bbb07d37cb0dff4600ab18865b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e8vzu4R6PrDiRnCC5_XeKA.png"/></div></div></figure><h1 id="ba87" class="nn mp iq bd mq no np nq mt nr ns nt mw jw nu jx mz jz nv ka nc kc nw kd nf nx bi translated">5.数据预处理</h1><h2 id="5ada" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">预处理</h2><p id="2483" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg oj li lj lk ok lm ln lo ol lq lr ls ij bi translated">更改列的名称</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="74b9" class="mo mp iq nz b gy od oe l of og">df.columns = ['age', 'sex', 'chest_pain_type', 'resting_blood_pressure', 'cholesterol', 'fasting_blood_sugar', 'rest_ecg_type', 'max_heart_rate_achieved',<br/>       'exercise_induced_angina', 'st_depression', 'st_slope_type', 'num_major_vessels', 'thalassemia_type', 'target']</span><span id="2a44" class="mo mp iq nz b gy oh oe l of og">df.columns</span></pre><p id="6937" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe pp pq pr nz b">Index([‘age’, ‘sex’, ‘chest_pain_type’, ‘resting_blood_pressure’, ‘cholesterol’, ‘fasting_blood_sugar’, ‘rest_ecg_type’, ‘max_heart_rate_achieved’, ‘exercise_induced_angina’, ‘st_depression’, ‘st_slope_type’, ‘num_major_vessels’, ‘thalassemia_type’, ‘target’], dtype=’object’)</code></p><p id="378c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们有 4 个分类列，如使用 pandas profiling 的数据描述所示:</p><p id="82f2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">cp —胸痛类型</p><p id="aaef" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">restecg — rest_ecg_type</p><p id="b494" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">坡度 st _ slope _ type</p><p id="28e5" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">地中海贫血型</p><p id="c84b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">生成分类列值</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="58af" class="mo mp iq nz b gy od oe l of og">#cp - chest_pain_type<br/>df.loc[df['chest_pain_type'] == 0, 'chest_pain_type'] = 'asymptomatic'<br/>df.loc[df['chest_pain_type'] == 1, 'chest_pain_type'] = 'atypical angina'<br/>df.loc[df['chest_pain_type'] == 2, 'chest_pain_type'] = 'non-anginal pain'<br/>df.loc[df['chest_pain_type'] == 3, 'chest_pain_type'] = 'typical angina'</span><span id="dcf9" class="mo mp iq nz b gy oh oe l of og">#restecg - rest_ecg_type<br/>df.loc[df['rest_ecg_type'] == 0, 'rest_ecg_type'] = 'left ventricular hypertrophy'<br/>df.loc[df['rest_ecg_type'] == 1, 'rest_ecg_type'] = 'normal'<br/>df.loc[df['rest_ecg_type'] == 2, 'rest_ecg_type'] = 'ST-T wave abnormality'</span><span id="f92c" class="mo mp iq nz b gy oh oe l of og">#slope - st_slope_type<br/>df.loc[df['st_slope_type'] == 0, 'st_slope_type'] = 'downsloping'<br/>df.loc[df['st_slope_type'] == 1, 'st_slope_type'] = 'flat'<br/>df.loc[df['st_slope_type'] == 2, 'st_slope_type'] = 'upsloping'</span><span id="b9f3" class="mo mp iq nz b gy oh oe l of og">#thal - thalassemia_type<br/>df.loc[df['thalassemia_type'] == 0, 'thalassemia_type'] = 'nothing'<br/>df.loc[df['thalassemia_type'] == 1, 'thalassemia_type'] = 'fixed defect'<br/>df.loc[df['thalassemia_type'] == 2, 'thalassemia_type'] = 'normal'<br/>df.loc[df['thalassemia_type'] == 3, 'thalassemia_type'] = 'reversable defect'</span></pre><h2 id="3cd8" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">一个热编码</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="fb4c" class="mo mp iq nz b gy od oe l of og">data = pd.get_dummies(df, drop_first=False)<br/>data.columns</span></pre><p id="e106" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe pp pq pr nz b">Index([‘age’, ‘sex’, ‘resting_blood_pressure’, ‘cholesterol’, ‘fasting_blood_sugar’, ‘max_heart_rate_achieved’, ‘exercise_induced_angina’, ‘st_depression’, ‘num_major_vessels’, ‘target’, ‘chest_pain_type_asymptomatic’, ‘chest_pain_type_atypical angina’, ‘chest_pain_type_non-anginal pain’, ‘chest_pain_type_typical angina’, ‘rest_ecg_type_ST-T wave abnormality’, ‘rest_ecg_type_left ventricular hypertrophy’, ‘rest_ecg_type_normal’, ‘st_slope_type_downsloping’, ‘st_slope_type_flat’, ‘st_slope_type_upsloping’, ‘thalassemia_type_fixed defect’, ‘thalassemia_type_normal’, ‘thalassemia_type_nothing’, ‘thalassemia_type_reversable defect’], dtype=’object’)</code></p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="3e37" class="mo mp iq nz b gy od oe l of og">df_temp = data['thalassemia_type_fixed defect']<br/>data = pd.get_dummies(df, drop_first=True)<br/>data.head()</span></pre><div class="kh ki kj kk gt ab cb"><figure class="pu kl pv pw px py pz paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><img src="../Images/7d8eaea58b652fbeb25f9f2a9a485152.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*qiFPnmrwrnzSsnxz3FYKFA.png"/></div></figure><figure class="pu kl qa pw px py pz paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><img src="../Images/3c3150fe3df90f5b59b83f0ce5f06071.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*mkRdyJkuzpTcYZRLtxT1kw.png"/></div></figure></div><p id="160c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">由于一个热编码删除了“地中海贫血 _ 类型 _ 固定缺陷”列，与空列“地中海贫血 _ 类型 _ 无”相比，这是一个有用的列，因此我们删除了“地中海贫血 _ 类型 _ 无”和串联的“地中海贫血 _ 类型 _ 固定缺陷”</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="0ba1" class="mo mp iq nz b gy od oe l of og">frames = [data, df_temp]<br/>result = pd.concat(frames,axis=1)<br/>result.drop('thalassemia_type_nothing',axis=1,inplace=True)<br/>resultc = result.copy()# making a copy for further analysis in conclusion section</span></pre><h1 id="7e86" class="nn mp iq bd mq no np nq mt nr ns nt mw jw nu jx mz jz nv ka nc kc nw kd nf nx bi translated">6.逻辑回归</h1><h2 id="2bd0" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">1.收集列</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="faa2" class="mo mp iq nz b gy od oe l of og">X = result.drop('target', axis = 1)<br/>y = result['target']</span></pre><h2 id="f346" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">2.拆分数据</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="7e08" class="mo mp iq nz b gy od oe l of og">from sklearn.model_selection import train_test_split</span><span id="7ef6" class="mo mp iq nz b gy oh oe l of og">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)</span></pre><h2 id="1edc" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">3.正常化</h2><p id="4865" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg oj li lj lk ok lm ln lo ol lq lr ls ij bi translated">最小-最大归一化法用于归一化数据。此方法将数据范围缩放到[0，1]。在大多数情况下，标准化也是基于特性的。</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi qb"><img src="../Images/cd53d6636aa8fd396f3fcb03c1b14bdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*k_w3tvviIMw62syi.png"/></div></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="bf74" class="mo mp iq nz b gy od oe l of og">X_train=(X_train-np.min(X_train))/(np.max(X_train)-np.min(X_train)).values</span><span id="44ad" class="mo mp iq nz b gy oh oe l of og">X_test=(X_test-np.min(X_test))/(np.max(X_test)-np.min(X_test)).values</span></pre><h2 id="b904" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">4.适合模型</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="07cc" class="mo mp iq nz b gy od oe l of og">from sklearn.linear_model import LogisticRegression<br/>logre = LogisticRegression()<br/>logre.fit(X_train,y_train)</span></pre><p id="5733" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe pp pq pr nz b">LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True, intercept_scaling=1, l1_ratio=None, max_iter=100, multi_class=’auto’, n_jobs=None, penalty=’l2', random_state=None, solver=’lbfgs’, tol=0.0001, verbose=0, warm_start=False)</code></p><h2 id="c22c" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">5.预言；预测；预告</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="c4d2" class="mo mp iq nz b gy od oe l of og">y_pred = logre.predict(X_test)<br/>actual = []<br/>predcition = []</span><span id="4f0a" class="mo mp iq nz b gy oh oe l of og">for i,j in zip(y_test,y_pred):<br/>  actual.append(i)<br/>  predcition.append(j)</span><span id="3e3c" class="mo mp iq nz b gy oh oe l of og">dic = {'Actual':actual,<br/>       'Prediction':predcition<br/>       }</span><span id="d829" class="mo mp iq nz b gy oh oe l of og">result  = pd.DataFrame(dic)</span><span id="537c" class="mo mp iq nz b gy oh oe l of og">import plotly.graph_objects as go<br/> <br/>fig = go.Figure()<br/> <br/> <br/>fig.add_trace(go.Scatter(x=np.arange(0,len(y_test)), y=y_test,<br/>                    mode='markers+lines',<br/>                    name='Test'))<br/>fig.add_trace(go.Scatter(x=np.arange(0,len(y_test)), y=y_pred,<br/>                    mode='markers',<br/>                    name='Pred'))</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi qc"><img src="../Images/c3a99235a773af74b8a9dbf6f63f70f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JGQoM7lbZ9YjNjCD4Wrl4w.png"/></div></div></figure><p id="c1aa" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">红点代表 0 或 1 的预测值，蓝线和点代表特定患者的实际值。红点和蓝点不重叠的地方是错误的预测值，而红点和蓝点重叠的地方是正确的预测值。</p><h2 id="0621" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">6.模型评估</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="8188" class="mo mp iq nz b gy od oe l of og">from sklearn.metrics import accuracy_score<br/>print(accuracy_score(y_test,y_pred))</span></pre><p id="5f5e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe pp pq pr nz b">0.8688524590163934</code></p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="6240" class="mo mp iq nz b gy od oe l of og">from sklearn.metrics import classification_report<br/>print(classification_report(y_test,y_pred))</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi qd"><img src="../Images/1a19e31810bcf98d2b085738c5c50b50.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*-9lbMeLmK3yGrKZw_OF5fw.png"/></div></figure><p id="e336" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">该模型的分类报告显示，91%的无心脏病预测被正确预测，83%的有心脏病预测被正确预测。</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="dce0" class="mo mp iq nz b gy od oe l of og">from sklearn.metrics import confusion_matrix<br/>print(confusion_matrix(y_test,y_pred))<br/>sns.heatmap(confusion_matrix(y_test,y_pred),annot=True)</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi qe"><img src="../Images/6dba2db555028df93a7994036fa75ae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*gg4ckjv0q5ZotniFrDQXfw.png"/></div></figure><p id="cbbe" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">混乱矩阵</p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi qf"><img src="../Images/bbf971c7cceb6256f60987818724ecad.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*gdIoF8dsWv3dbKSeHLZy_A.png"/></div></figure><p id="b791" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">混淆矩阵真正值是 24，真负值是 29。假阳性是 3，假阴性是 5。</p><p id="3242" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><strong class="kz ir"> ROC 曲线</strong></p><p id="9e49" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">ROC 曲线总结了使用不同概率阈值的预测模型的真阳性率和假阳性率之间的权衡。</p><p id="6bff" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">ROC 曲线的准确性为 87.09%。</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="6e4a" class="mo mp iq nz b gy od oe l of og">from sklearn.metrics import roc_curve<br/>fpr, tpr, thresholds = roc_curve(y_test, y_pred)<br/>plt.plot(fpr,tpr)<br/>plt.xlim([0.0, 1.0])<br/>plt.ylim([0.0, 1.0])<br/>plt.title('ROC curve for Heart disease classifier')<br/>plt.xlabel('False positive rate (1-Specificity)')<br/>plt.ylabel('True positive rate (Sensitivity)')<br/>plt.grid(True)</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi qg"><img src="../Images/074937bc29ce4a31b0bbf49f0d9c6d00.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*xh0P0q4Xu1mNROBkBzNZcA.png"/></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="e80e" class="mo mp iq nz b gy od oe l of og">import sklearn<br/>sklearn.metrics.roc_auc_score(y_test,y_pred)</span></pre><p id="ad9a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe pp pq pr nz b">0.8709150326797386</code></p><h1 id="7f6e" class="nn mp iq bd mq no np nq mt nr ns nt mw jw nu jx mz jz nv ka nc kc nw kd nf nx bi translated">7.结论</h1><h2 id="4600" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">1.系数</h2><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="0e21" class="mo mp iq nz b gy od oe l of og">print(logre.intercept_)<br/>plt.figure(figsize=(10,12))<br/>coeffecients = pd.DataFrame(logre.coef_.ravel(),X.columns)<br/>coeffecients.columns = ['Coeffecient']<br/>coeffecients.sort_values(by=['Coeffecient'],inplace=True,ascending=False)<br/>coeffecientsts</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi qh"><img src="../Images/721d20ec9f74df8f8adec0682a2ef481.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*FuFP6VdibESr58DLeTF1jw.png"/></div></figure><h2 id="da70" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">2.分析</h2><p id="db56" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg oj li lj lk ok lm ln lo ol lq lr ls ij bi translated">准备用于分析的数据</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="ff14" class="mo mp iq nz b gy od oe l of og">df4 = df[df['target'] == 0 ][['age', 'sex', 'chest_pain_type', 'resting_blood_pressure','cholesterol', 'fasting_blood_sugar', 'rest_ecg_type', 'max_heart_rate_achieved', 'exercise_induced_angina', 'st_depression','st_slope_type', 'num_major_vessels', 'thalassemia_type', 'target']] #target 0 - people with heart disease</span></pre><p id="6586" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">心脏病患者的可视化</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="3646" class="mo mp iq nz b gy od oe l of og">plt.figure(figsize=(16,6))<br/>sns.distplot(df4['max_heart_rate_achieved'])</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi qi"><img src="../Images/d93ac95dbff1b765686c821c7c997262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*voC0Ng0bQ8saP5AzXkbVyw.png"/></div></div></figure><p id="36be" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">正常的心率在 60 到 100 次/分之间。在心脏病发作期间，由于缺乏血液，心肌的一些区域将开始死亡。一个人的脉搏可能会变得更慢(心动过缓)或更快(心动过速)，这取决于他们所经历的心脏病发作的类型。</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="4662" class="mo mp iq nz b gy od oe l of og">plt.figure(figsize=(20,6))<br/>sns.boxenplot(data=df4,x='rest_ecg_type',y='cholesterol',hue='st_slope_type')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi qj"><img src="../Images/70e0cfdb173cbc06c4ee1e071698e8b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*99ONer3ZGeAFC7p_Yl4rDQ.png"/></div></div></figure><p id="bbd8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在正常类型的休息心电图证明是重要的预测模型，随着向下倾斜的 st 斜率。由这两种特征组成的病人通常胆固醇水平在 170-225mg/dl 之间。其余心电图的其他类型的偏差似乎更分散，更不简洁。</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="e86e" class="mo mp iq nz b gy od oe l of og">plt.figure(figsize=(20,6))<br/>sns.boxenplot(data=df4,x='chest_pain_type',y='max_heart_rate_achieved',hue='thalassemia_type')</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi qk"><img src="../Images/5cf099a423bee1f514f120ca6df66801.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X-mKq6DazvhlQl1gaTkFtQ.png"/></div></div></figure><h2 id="dd7f" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">Shap</h2><p id="1692" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg oj li lj lk ok lm ln lo ol lq lr ls ij bi translated">形状值</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="b7e7" class="mo mp iq nz b gy od oe l of og">!pip install shap <br/>import shap<br/>explainer = shap.TreeExplainer(model)<br/>shap_values = explainer.shap_values(X_test,check_additivity=False)</span><span id="afa2" class="mo mp iq nz b gy oh oe l of og">shap.summary_plot(shap_values[1], X_test, plot_type="bar")</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi ql"><img src="../Images/9fb2b30569424126d662f3d6b5c687ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xe_p8TFLuOxnuQ95PMuV1w.png"/></div></div></figure><p id="7945" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">模型解释的形状值</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="f2e4" class="mo mp iq nz b gy od oe l of og">shap.summary_plot(shap_values[1], X_test)</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi qm"><img src="../Images/fd382123881ededaeb86870ca3e059b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VklK3V9lSXkLBeybfe23rA.png"/></div></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="6e77" class="mo mp iq nz b gy od oe l of og">def patient_analysis(model, patient):<br/>  explainer = shap.TreeExplainer(model)<br/>  shap_values = explainer.shap_values(patient)<br/>  shap.initjs()<br/>  return shap.force_plot(explainer.expected_value[1], shap_values[1], patient)</span></pre><p id="9633" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">两个病人的报告</p><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="12ec" class="mo mp iq nz b gy od oe l of og">patients = X_test.iloc[3,:].astype(float)<br/>patients_target = y_test.iloc[3:4]<br/>print('Target : ',int(patients_target))<br/>patient_analysis(model, patients)</span></pre><p id="146b" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe pp pq pr nz b">Target : 0</code></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi qn"><img src="../Images/0ff75b7b2b759545fa80543f8714b66c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V7DfU0tMbRYDH5yPIOEjCA.png"/></div></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="4f33" class="mo mp iq nz b gy od oe l of og">patients = X_test.iloc[33,:].astype(float)<br/>patients_target = y_test.iloc[33:34]<br/>print('Target : ',int(patients_target))<br/>patient_analysis(model, patients)</span></pre><p id="199c" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><code class="fe pp pq pr nz b">Target : 1</code></p><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi qo"><img src="../Images/855d83d93680152b8a959158d0e0e5e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RbTJNy40MWLSgVjjmrOkxA.png"/></div></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="8b47" class="mo mp iq nz b gy od oe l of og"># dependence plot</span><span id="9d4f" class="mo mp iq nz b gy oh oe l of og">shap.dependence_plot('num_major_vessels', shap_values[1], X_test, interaction_index = "st_depression")</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div class="gh gi qp"><img src="../Images/f0f2effacf5047b4122bb7239265c704.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*93b8oTL6cSWn9SNJtxReKA.png"/></div></figure><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="d6e7" class="mo mp iq nz b gy od oe l of og">shap_values = explainer.shap_values(X_train.iloc[:50],check_additivity=False)</span><span id="95b2" class="mo mp iq nz b gy oh oe l of og">shap.initjs()</span><span id="839e" class="mo mp iq nz b gy oh oe l of og">shap.force_plot(explainer.expected_value[1], shap_values[1], X_test.iloc[:50])</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi qq"><img src="../Images/c6ad88443682720e8f9649e8db7aac96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CGYrFNEdkHF0hMkTZJBUAg.png"/></div></div></figure><h2 id="d3f0" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">3.结论</h2><ul class=""><li id="d756" class="lt lu iq kz b la nh ld ni lg nj lk nk lo nl ls ly lz ma mb bi translated">ROC 曲线下的面积为 87.09%，这是令人满意的。</li><li id="8dfb" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">模型预测准确率为 86.88%。该模型更具体而非敏感。</li><li id="7891" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">根据该模型，有助于预测模型精度的主要特征在热图中按升序显示。</li></ul><pre class="kh ki kj kk gt ny nz oa ob aw oc bi"><span id="02e7" class="mo mp iq nz b gy od oe l of og">plt.figure(figsize=(10,12))</span><span id="6ddf" class="mo mp iq nz b gy oh oe l of og">coeffecients = pd.DataFrame(logre.coef_.ravel(),X.columns)</span><span id="c5ff" class="mo mp iq nz b gy oh oe l of og">coeffecients.columns = ['Coeffecient']</span><span id="64e0" class="mo mp iq nz b gy oh oe l of og">coeffecients.sort_values(by=['Coeffecient'],inplace=True,ascending=False)</span><span id="90b7" class="mo mp iq nz b gy oh oe l of og">sns.heatmap(coeffecients,annot=True,fmt='.2f',cmap='Set2',linewidths=0.5)</span></pre><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi qr"><img src="../Images/4a706e60be30c71d6c0633488767836e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SKELWrek4CV6jqDu91rr6w.png"/></div></div></figure><p id="a8dd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">有助于预测准确性的重要特征通过热图以降序显示。在银色码中，最有贡献的特征、胸痛类型和达到的最大心率被证明更有价值 1.28 至 1.03 个单位。</p><h2 id="db6b" class="mo mp iq bd mq mr ms dn mt mu mv dp mw lg mx my mz lk na nb nc lo nd ne nf ng bi translated">参考</h2><p id="b4f3" class="pw-post-body-paragraph kx ky iq kz b la nh jr lc ld ni ju lf lg oj li lj lk ok lm ln lo ol lq lr ls ij bi translated">【https://www.kaggle.com/ronitf/heart-disease-uci/kernels T2】号</p><h1 id="7a25" class="nn mp iq bd mq no np nq mt nr ns nt mw jw nu jx mz jz nv ka nc kc nw kd nf nx bi translated">鳍。</h1></div></div>    
</body>
</html>