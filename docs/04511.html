<html>
<head>
<title>From Streamlit to Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从细流到赫罗库</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/from-streamlit-to-heroku-62a655b7319?source=collection_archive---------16-----------------------#2020-04-22">https://towardsdatascience.com/from-streamlit-to-heroku-62a655b7319?source=collection_archive---------16-----------------------#2020-04-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/b09737721985d822a2f71b1847a75587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rz58e_Tu_QL_f3qwceY0HQ.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated"><a class="ae jg" href="https://unsplash.com/@thematthoward?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">马特·霍华德</a>在<a class="ae jg" href="https://unsplash.com/s/photos/journey?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍照</p></figure><div class=""/><div class=""><h2 id="8360" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">如何主持你的项目的简单指南？</h2></div><h2 id="7801" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">*注意*这个指南是针对Heroku上的主机的，如果你想在AWS实例上主机，请查看我的朋友Marco的Streamlit to AWS指南<a class="ae jg" rel="noopener" target="_blank" href="/creating-a-website-to-host-your-python-web-application-f06f694a87e8">这里！</a></h2><p id="3f1d" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">大家好，本周我将一步一步地介绍如何将您的streamlit项目从笔记本电脑转移到在线服务器上。对于这个例子，我将使用我的Yelp评论应用程序来指导您。</p><p id="30fe" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">我们开始吧，好吗？假设我们已经在本地安装并运行了我们的streamlit应用程序，但是我们希望在我们的家庭环境之外安装它。在你的Jupyter笔记本上应该是这样的:</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ms"><img src="../Images/26c0394dc652647bc49597b299c7d712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D9S_k-SKjKaFxz_g6bqlwg.png"/></div></div></figure><p id="4497" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">现在，如你所知，为了让你的Streamlit应用程序启动并运行，你必须把它放到一个. py文件中，以便Streamlit在本地运行它，Heroku也是如此。因此，我们将点击“文件”和“下载为..”一个python文件。</p><h1 id="9135" class="mx kz jj bd la my mz na ld nb nc nd lg kp ne kq lk ks nf kt lo kv ng kw ls nh bi translated">为Heroku做准备</h1><p id="10e0" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">Heroku为开发者提供了一个在云上运行和操作平台的平台。它不仅提供托管服务，还为你的应用程序提供了一个易于构建的虚拟环境。因此，我们需要给Heroku准备一堆指令来启动和运行它。</p><p id="e6c9" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">对我来说，开始时最好的事情是把我的前端和项目的其他部分分开，因为我们要做一些翻找和创建文件的工作，我不想让这些文件混淆。首先，Heroku需要一些文件来给它必要的指令，以使虚拟环境运行起来。下面是我的文件树的样子，列出了必要的文件:</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/822f833da6beffc15024e15413222a95.png" data-original-src="https://miro.medium.com/v2/resize:fit:400/format:webp/1*h-3si7asdNbC2waxCUMaOg.png"/></div></figure><h2 id="7df4" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">Procfile</h2><p id="38b6" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">现在，app.py就是您在。py格式。下一个文件，<em class="nj"> Procfile </em>是一个声明启动时要运行什么命令的文件。它没有特殊的扩展名，只是简单地命名为Procfile。要创建它，只需打开Jupyter笔记本上的应用程序，点击右上角的“新建”按钮，然后选择“文本文件”</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nk"><img src="../Images/ef3bcd640e92c8a46030a8ce10ec4ef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZmVfD8Vq8dttfvaQPf07Bw.png"/></div></div></figure><p id="9be4" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">这将创建一个没有特殊附件的空白文档。打开它，输入以下代码:</p><pre class="mt mu mv mw gt nl nm nn no aw np bi"><span id="127c" class="ky kz jj nm b gy nq nr l ns nt">web: sh setup.sh &amp;&amp; streamlit run app.py</span></pre><p id="a898" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">您会注意到代码的后半部分包含运行我们的应用程序的streamlit命令。</p><h2 id="e6b5" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">requirements.txt</h2><p id="4f0d" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">现在，我们将对<em class="nj"> requirements.txt做同样的事情。Requirements.txt </em>向Heroku提供了关于库的说明，这是我们运行应用程序所需要的。这实质上是定义您在设置虚拟环境时需要的东西。在我的<em class="nj"> requirements.txt，</em>我正在输入以下内容:</p><pre class="mt mu mv mw gt nl nm nn no aw np bi"><span id="df03" class="ky kz jj nm b gy nq nr l ns nt">streamlit==0.49.0<br/>numpy==1.17.3</span></pre><p id="44c1" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">通过这种方式，我让Heroku知道这个应用程序需要这个版本的Streamlit和那个版本的Numpy。这并不是说Heroku手头没有它，但这允许我修正我想要的版本，而不必担心一些新的更新会破坏我的代码。</p><h2 id="475e" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">setup.sh</h2><p id="f949" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated"><em class="nj">编辑:来自</em> <a class="ae jg" href="https://medium.com/@samudralasaikiranmayee?source=follow_footer--------------------------follow_footer-" rel="noopener"> <em class="nj">的反馈Samudrala Sai kiran mayee</em></a><em class="nj">表示setup.sh全部小写以避免问题很重要。</em></p><p id="d1b7" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">转到<em class="nj"> setup.sh </em>，我们将按照创建上两个文件的相同方式创建文件，在Jupyter Notebook中创建一个新的txt文件。顺便说一下，不要忘记用适当的扩展名来重命名您的文件。与<em class="nj"> requirements.txt </em>一样，s <em class="nj"> etup.sh </em>有助于为我们的streamlit应用程序的运行创建必要的环境。我们将在s <em class="nj"> etup.sh </em>中输入以下命令:</p><pre class="mt mu mv mw gt nl nm nn no aw np bi"><span id="77ab" class="ky kz jj nm b gy nq nr l ns nt">mkdir -p ~/.streamlit/</span><span id="c5f2" class="ky kz jj nm b gy nu nr l ns nt">echo “\<br/>[general]\n\<br/>email = \”<a class="ae jg" href="mailto:your-email@domain.com" rel="noopener ugc nofollow" target="_blank">your-email@domain.com</a>\”\n\<br/>“ &gt; ~/.streamlit/credentials.toml</span><span id="2d7c" class="ky kz jj nm b gy nu nr l ns nt">echo “\<br/>[server]\n\<br/>headless = true\n\<br/>enableCORS=false\n\<br/>port = $PORT\n\<br/>“ &gt; ~/.streamlit/config.toml</span></pre><p id="245c" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">如果你愿意，可以把电子邮件改成你自己的。如果没有，不要担心，它仍然会运行良好。</p><h1 id="f826" class="mx kz jj bd la my mz na ld nb nc nd lg kp ne kq lk ks nf kt lo kv ng kw ls nh bi translated">与Heroku互动</h1><p id="48ec" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">现在我们已经安排好了所有的事情，是时候准备和Heroku接触了。有一个git方法，但是我更喜欢使用Heroku的CLI(命令行界面),因为它可以减少混乱。你可以在这里安装Heroku的CLI <a class="ae jg" href="https://devcenter.heroku.com/articles/getting-started-with-python#set-up" rel="noopener ugc nofollow" target="_blank">。注意，你还需要在你的电脑上安装某种形式的Github。Heroku与Github携手合作，我还没有看到一个部署选项在某种程度上不需要Git。我个人用Github桌面。</a></p><h2 id="b310" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">登录Heroku</h2><p id="f769" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">Heroku的CLI允许您从家庭终端直接与Heroku交互。打开终端，用CD找到你的应用程序的根目录。在那里，输入以下命令:</p><pre class="mt mu mv mw gt nl nm nn no aw np bi"><span id="84c2" class="ky kz jj nm b gy nq nr l ns nt">$ heroku login</span></pre><p id="f1e7" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">这将触发一个新的网络浏览器，您可以在其中输入Heroku的登录信息。输入您的登录信息并点击登录，当网站通知您已登录时，您就可以关闭浏览器了。</p><h2 id="0fa4" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">创建一个Heroku实例</h2><p id="718e" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">接下来，我们通过键入以下命令指示Heroku创建一个Heroku实例:</p><pre class="mt mu mv mw gt nl nm nn no aw np bi"><span id="27d7" class="ky kz jj nm b gy nq nr l ns nt">$ heroku create</span></pre><p id="13ec" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">Heroku会自动运行并给你的应用分配一个随机的名字，我们稍后会更改它的名字。</p><h2 id="df8b" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">将你的文件载入Heroku</h2><p id="a90e" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">接下来，我们将把所有文件传送到heroku实例中。因为heroku使用Git，所以这个过程应该很熟悉:</p><pre class="mt mu mv mw gt nl nm nn no aw np bi"><span id="bc02" class="ky kz jj nm b gy nq nr l ns nt">$ git push heroku master</span></pre><p id="1e08" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">现在请记住，我们仍然应该在你的应用程序的前端根目录，所以它会把所有的东西都转移到Heroku。记住这一点很重要，因为稍后我们将讨论在您做出更改时更新Heroku上的应用程序。</p><h2 id="8c35" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">运行您的应用</h2><p id="8e4c" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">最后，我们将启动并运行我们的应用程序。输入以下内容:</p><pre class="mt mu mv mw gt nl nm nn no aw np bi"><span id="7fa2" class="ky kz jj nm b gy nq nr l ns nt">$ heroku ps:scale web=1<br/>$ heroku open</span></pre><p id="d9c4" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">第一个命令告诉Heroku启动一个dyno (Heroku对虚拟机实例的术语)。PS 是Heroku影响dynos的许多命令的前缀。<em class="nj"> Scale web=1 </em>告诉Heroku加速1 dyno，根据你的服务器流量，你可以告诉它加速更多。这整个命令基本上启动了你的应用程序。</p><p id="7855" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">最后一个命令将弹出你选择的浏览器，并把你带到应用程序。您会注意到网址是自动生成的实例名加上heroku。</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nv"><img src="../Images/64b437c520f2336863d705371d4ee9ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ohd-_3ld7Zbbh7EKZH60uA.png"/></div></div></figure><h2 id="24e2" class="ky kz jj bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">更改应用程序的名称</h2><p id="be29" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">要改变这一点，我们必须去我们的heroku仪表板。在你的浏览器中，进入Heroku.com。前往您的仪表盘，点击您的应用程序。</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nw"><img src="../Images/ade9bde405d1acfbf4a3ec0fe5e296ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9I0hrgPHzINDb4ll-RrVNg.png"/></div></div></figure><p id="c4f2" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">你现在应该在你的应用程序的“概述”页面。点击设置。</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/3fef5346aa1ae0c44ee547285874c51b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uepZsuwxWFweSpBgIAMu7A.png"/></div></div></figure><p id="0647" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">“设置”是一个非常明显的工作页面，您应该可以在这里看到更改应用程序名称的选项:</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/68da2d31252c4bb66c0122391773f0fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ozwmBCiztnbSgAxUCYyrrw.png"/></div></div></figure><h1 id="be32" class="mx kz jj bd la my mz na ld nb nc nd lg kp ne kq lk ks nf kt lo kv ng kw ls nh bi translated">更新您的Git远程路径</h1><p id="cf1c" class="pw-post-body-paragraph lu lv jj lw b lx ly kk lz ma mb kn mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">请记住，更改名称将要求您在进行任何更新之前更新git remotes。这里的<a class="ae jg" href="https://devcenter.heroku.com/articles/renaming-apps#updating-git-remotes" rel="noopener ugc nofollow" target="_blank">给出了这样做的指示</a>。</p><p id="ab2b" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">最后，在我们结束之前，如果您已经在本地更新了您的应用程序，并且想要更新您的应用程序，您需要做的就是单击“部署”</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/0b83d79106e230a495a8baf0903337db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QyOsuezZ_TT8hR8To5yt8Q.png"/></div></div></figure><p id="e67f" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">向下滚动deploy页面，您会看到一些有用的git命令，帮助您根据需要克隆或更新heroku实例。</p><figure class="mt mu mv mw gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ny"><img src="../Images/c671245d267353489273a9d816c88604.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XlWPMltlaO_RW-GbnF7cMw.png"/></div></div></figure><p id="5f51" class="pw-post-body-paragraph lu lv jj lw b lx mn kk lz ma mo kn mc lh mp me mf ll mq mh mi lp mr mk ml mm im bi translated">这就对了。您的应用程序应该已经启动并运行，希望用户已经准备好了！我希望这个指南对你有所帮助。还有许多其他有用的streamlit到Heroku指南，但更多的例子总是更好。祝你好运，并享受构建应用的乐趣！</p></div></div>    
</body>
</html>