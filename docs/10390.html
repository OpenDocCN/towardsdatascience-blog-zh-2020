<html>
<head>
<title>Baby Steps Towards Data Science: Decision Tree Regression in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">迈向数据科学的一小步:Python 中的决策树回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/baby-steps-towards-data-science-decision-tree-regression-in-python-323beeacbb6e?source=collection_archive---------40-----------------------#2020-07-21">https://towardsdatascience.com/baby-steps-towards-data-science-decision-tree-regression-in-python-323beeacbb6e?source=collection_archive---------40-----------------------#2020-07-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8557" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">理解决策树回归背后的直觉，并用 python 实现。提供源代码和数据集。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/11f117f32cee43c454b5a6078893dac0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Nt8FpH8gMYbZOtuJ"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">埃里克·马塞利诺在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure></div><div class="ab cl kz la hx lb" role="separator"><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le lf"/><span class="lc bw bk ld le"/></div><div class="im in io ip iq"><h1 id="8c32" class="lg lh it bd li lj lk ll lm ln lo lp lq jz lr ka ls kc lt kd lu kf lv kg lw lx bi translated">什么是决策树回归？</h1><p id="e2a7" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">决策树主要用于分类问题，但是，让我们试着理解它在回归中的含义，并且试着理解为什么在回归中使用它不是一个好主意。</p><p id="2285" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">决策树回归可以将数据分成多个部分。这些拆分通常回答一个简单的 if-else 条件。该算法决定数据中的最佳分割数。由于这种拆分数据的方法非常类似于树的分支，因此这种方法可能被称为决策树。事实上，最后一层(即适合、不适合)被称为叶子。</p><p id="80ec" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">例如，看上面的图片，有关于顾客的数据，他们的年龄，他们是否吃比萨饼和他们是否锻炼。通过执行决策树回归，数据按照年龄被分成两类，即年龄&lt; 30 and age&gt; 30。年龄内&lt; 30 category, the data is again split into 2 categories by their eating habits i.e., people eating pizza and people not eating pizza. The same goes for exercise as well. By doing these splits, we can simply account for the behavior of the customers based on their choices and we end up deciding whether they are fit or unfit.</p><h1 id="b9d8" class="lg lh it bd li lj mz ll lm ln na lp lq jz nb ka ls kc nc kd lu kf nd kg lw lx bi translated">Implementation in Python</h1><p id="bba3" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">Let us deep dive into python and build a polynomial regression model and try to predict the salary of an employee of 6.5 level(hypothetical).</p><p id="26e7" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">Before you move forward, please download the CSV data file from my GitHub Gist.</p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="75ff" class="nj lh it nf b gy nk nl l nm nn"><a class="ae ky" href="https://gist.github.com/tharunpeddisetty/433e5fe5af0e6b6cdd9d7df3339931a5" rel="noopener ugc nofollow" target="_blank">https://gist.github.com/tharunpeddisetty/433e5fe5af0e6b6cdd9d7df3339931a5</a><br/>Once you open the link, you can find "Download Zip" button on the top right corner of the window. Go ahead and download the files.<br/>You can download 1) python file 2)data file (.csv)<br/>Rename the folder accordingly and store it in desired location and you are all set.If you are a beginner I highly recommend you to open your python IDE and follow the steps below because here, I write detailed comments(statements after #.., these do not compile when our run the code) on the working of code. You can use the actual python as your backup file or for your future reference.</span></pre><p id="28d5" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="no">导入库</em> </strong></p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="c505" class="nj lh it nf b gy nk nl l nm nn">import numpy as np<br/>import matplotlib.pyplot as plt<br/>import pandas as pd</span></pre><p id="3c32" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="no">导入数据并定义 X 和 Y 变量</em> </strong></p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="01a5" class="nj lh it nf b gy nk nl l nm nn">dataset = pd.read_csv(‘/Users/tharunpeddisetty/Desktop/Position_Salaries.csv’) #add your file path<br/><br/>X = dataset.iloc[:,1:-1].values<br/>y = dataset.iloc[:, -1].values</span><span id="b4de" class="nj lh it nf b gy np nl l nm nn">#iloc takes the values from the specified index locations and stores them in the assigned variable as an array</span></pre><p id="ede7" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu">让我们看看我们的数据，了解变量:</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/2e7b6c01f37c646b6c4973e7acef3f3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/0*_6zTEv8-CvpS1zPL.png"/></div></figure><p id="6cfc" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">该数据描述了员工的职位/级别及其工资。这与我在多项式回归文章中使用的数据集相同。</p><p id="8d65" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="no">可视化数据</em> </strong></p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="8a4c" class="nj lh it nf b gy nk nl l nm nn">plt.scatter(X, y, color = ‘red’)<br/>plt.plot(X,regressor.predict(X), color = ‘blue’)<br/>plt.title(‘Decision Tree’)<br/>plt.xlabel(‘Position level’)<br/>plt.ylabel(‘Salary’)<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/3a57fbb8349b90e433e17e541e8db67f.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*vqMBNe19BalDbmmgXPycZg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="0843" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="no">训练模特</em> </strong></p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="2817" class="nj lh it nf b gy nk nl l nm nn">from sklearn.tree import DecisionTreeRegressor<br/>regressor = DecisionTreeRegressor(random_state=0)<br/>regressor.fit(X,y)</span><span id="bcde" class="nj lh it nf b gy np nl l nm nn">#random_state is the seed value, just to make sure we both get same results.</span></pre><p id="0855" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我们将使用模型中的全部数据，因此您不需要将数据分成训练和测试数据。</p><p id="fd17" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="no">可视化决策树回归的结果</em> </strong></p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="b9e8" class="nj lh it nf b gy nk nl l nm nn">X_grid = np.arange(min(X), max(X), 0.1)<br/>X_grid = X_grid.reshape((len(X_grid), 1))<br/>plt.scatter(X, y, color = 'red')<br/>plt.plot(X_grid,regressor.predict(X_grid), color = 'blue')<br/>plt.title('Decision Tree')<br/>plt.xlabel('Position level')<br/>plt.ylabel('Salary')<br/>plt.show()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/ecc53fd4cbae7ccdabba83fad04224f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*1moc1GV6TI6VpkSrJ5g9mg.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="8e8b" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">您可以看到我们的模型如何预测与数据点相同的精确数据水平。这种可视化仅用于说明目的。实际上，我们几乎没有任何只有 X 和 Y 变量的数据集(X=职位级别，Y =薪水)。因为这个数据是二维的，我们能够绘制它。如果数据是多维的，我们就不会绘制它。这显然是有道理的。</p><p id="45a2" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="no">使用决策树回归预测 6.5 级结果</em> </strong></p><pre class="kj kk kl km gt ne nf ng nh aw ni bi"><span id="2af8" class="nj lh it nf b gy nk nl l nm nn">print(regressor.predict([[6.5]]))<br/># predict method expects a 2D array thats the reason you see [[6.5]]<br/></span></pre><p id="60f1" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated"><strong class="ma iu"> <em class="no">结果</em> </strong></p><p id="4f82" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">决策树回归:150000</p><h1 id="08de" class="lg lh it bd li lj mz ll lm ln na lp lq jz nb ka ls kc nc kd lu kf nd kg lw lx bi translated">结论</h1><p id="3625" class="pw-post-body-paragraph ly lz it ma b mb mc ju md me mf jx mg mh mi mj mk ml mm mn mo mp mq mr ms mt im bi translated">我们可以看到，我们的模型预测了与 6 级员工相同的工资。这是由决策树算法的本质决定的。它的工作假设是，如果一个雇员有某些特征(在这种情况下是水平)，那么另一个具有相似特征的雇员也获得相同的工资。</p><p id="3c7b" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我把这个留给你的智慧去理解这个模型有多好。开个玩笑！你可以清楚地看到这是不公平的，对吗？同样，我们可以得出结论，这种模式表现不佳。正如我在本文开始时已经提到的，这个模型更适合于分类问题，我将在以后的文章中处理这个问题。我将确保在我的下一篇文章中使用相同的数据集来实现不同的回归技术。通过这样做，您可以比较结果，并决定哪个模型是最好的。</p><p id="e3d2" class="pw-post-body-paragraph ly lz it ma b mb mu ju md me mv jx mg mh mw mj mk ml mx mn mo mp my mr ms mt im bi translated">我希望这对你来说是有趣的。恭喜你！您已经用最少的代码行实现了决策树回归。当我说婴儿迈向数据科学时，我是认真的。现在您有了代码的模板，您可以在其他数据集上实现它并观察结果。机器学习快乐！</p></div></div>    
</body>
</html>