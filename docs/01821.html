<html>
<head>
<title>Visualizing Infrastructure Growth with Python and Tableau</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 和 Tableau 可视化基础设施增长</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/projecting-and-visualizing-infrastructure-growth-trends-with-python-1e578d9e4260?source=collection_archive---------31-----------------------#2020-02-19">https://towardsdatascience.com/projecting-and-visualizing-infrastructure-growth-trends-with-python-1e578d9e4260?source=collection_archive---------31-----------------------#2020-02-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9437" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Python 如何逐月汇总数据消耗，并避免数小时的手动计算</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/4cf66ecfca36133116c3b6d6955413e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bNBceI1x9DPpPe9AyCoQZQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">unsplash.com</p></figure><p id="62d2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当进行项目规划时，了解您的数据库或专用网络共享是否能够处理增加的数据负载对于避免性能故障至关重要。虽然后端管道开发、数据工程和基础设施维护不像如今的数据科学、机器学习或分析那样“热门”，但它确实是公司数据需求的核心。如果没有坚实的基础或实施策略来处理来自不同来源和系统的大量数据，就很难对数据进行任何转换。</p><p id="cb67" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这是一种很自然也很频繁出现的查询——我们在优化我们的基础设施吗？</p><p id="05b4" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">令人欣慰的是，我们不必手动整理过去三年中成千上万的文件，我们可以让 Python 来完成繁重的工作。当面对我们的应用程序数据需要如何随时间变化的问题时，我创建了一个方便的脚本来按月汇总数据量。一旦这样做了，就很容易绘制出一段时间内的趋势。</p><p id="2f50" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在这里的使用案例中，我想知道的是，在一个公共的 Windows 网络连接共享上，每个应用程序的逐月流量是如何增加的。由于许多服务使用同一个位置，因此首先按应用程序，然后按文件夹位置分离报告非常重要。这个脚本最好的部分是它是可重用的，并且可以很容易地为任何其他应用程序或网络位置进行配置，因为这个函数是通用的。</p><p id="c7ff" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">问题:</strong></p><p id="edce" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">逐月确定 Windows 位置上文件的数据量</p><p id="8ae2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">解决方案:</strong></p><p id="ddc0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">解析每个文件的时间戳和大小，然后按月合计总数据量</p><p id="58ac" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">第一步:</strong>加载所需的库——pandas、datetime、os、os.path、time</p><p id="c335" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">步骤 2: </strong>命名输出文件(您想要保存报告的地方)</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="d3e1" class="lz ma it lv b gy mb mc l md me">appService = "abc_service"<br/>writer = pd.ExcelWriter(r"C:\\scripts\\output\\" + appService + ".xlsx", engine='xlsxwriter')</span></pre><p id="9925" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">步骤 3: </strong>创建一个函数，返回所提供的网络位置在一个月间隔内的总流量</p><p id="ff91" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">或者，您可以选择添加一个额外的以 MB 或 GB 为单位的列，因为 Python 返回的默认值是以字节为单位的。</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="d3c1" class="lz ma it lv b gy mb mc l md me">def getFileSummaryByMonth(directory, path):<br/> folder = path<br/> filepaths = [os.path.join(folder, f) for f in os.listdir(folder)]</span><span id="50c9" class="lz ma it lv b gy mf mc l md me">stats = {}<br/> i = 0</span><span id="76c4" class="lz ma it lv b gy mf mc l md me">for file in filepaths:<br/>  # Get the unique date for each file<br/>  file_name = file<br/>  last_Mod = os.stat(file).st_ctime<br/>  size = os.stat(file).st_size<br/>  str1 = time.ctime(os.path.getmtime(file_name)) <br/>  datetime_object = datetime.datetime.strptime(str1, '%a %b %d %H:%M:%S %Y')<br/>  date = datetime_object.strftime("%Y-%m") # 06/07/2013<br/>  # Add values to dictionary<br/>  stats = {'Index': i, 'file_name': file_name, 'date': date, 'size': size}<br/>  print(stats)<br/>  i = i+1<br/>  dict_obj.add(i, stats)</span><span id="d9e4" class="lz ma it lv b gy mf mc l md me"># Create duplicate file info dictionary<br/> filestats = stats</span><span id="bd2f" class="lz ma it lv b gy mf mc l md me"># Convert to dataframe<br/> filestats = pd.DataFrame.from_dict(dict_obj,orient='index')<br/> print(filestats)</span><span id="13c1" class="lz ma it lv b gy mf mc l md me"># Aggregate files by unique month and filesize<br/> filestats["date"] = pd.to_datetime(filestats["date"])<br/> grouped_by_month_stats = filestats.groupby(filestats['date'].dt.strftime('%Y-%m'))['size'].sum().sort_values()<br/> print(grouped_by_month_stats)<br/> df = pd.Series.to_frame(grouped_by_month_stats)<br/> df.sort_values(by='date', inplace=True, ascending=False)</span><span id="c80e" class="lz ma it lv b gy mf mc l md me"># Write each filtered dataframe to a different worksheet in the same Excel file<br/> df.to_excel(writer, sheet_name=directory)</span></pre><p id="7991" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">第四步:</strong>更新脚本包含所有路径，调用上面提到的 getFileSummaryByMonth 函数</p><pre class="kj kk kl km gt lu lv lw lx aw ly bi"><span id="60d9" class="lz ma it lv b gy mb mc l md me">getFileSummaryByMonth('reporting_service', 'C://first_path//')<br/>getFileSummaryByMonth('archive_service', 'C://second_path//')<br/>getFileSummaryByMonth('search_service', 'C://third_path//')</span></pre><p id="69cf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">步骤 5: </strong>执行脚本后查看结果——每个文件夹将在输出 Excel 电子表格中保存为不同的选项卡。根据您的需要，您可以选择更新脚本以相应地显示结果。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/068d8ef1849e97de035203bc043a2c40.png" data-original-src="https://miro.medium.com/v2/resize:fit:826/format:webp/1*_za3VxXcQAmhcTzGC0YlIg.png"/></div></figure><p id="d6a3" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">为了形象化成长，你可以根据你的最终目标来创造 Tableau。我的目标是每月观察过去三年的交易量增长。如果您知道预期的文件大小，您可以相应地调整电子表格的容量，并再次绘图以预测所需的总存储量。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/ac9cfa733510bc09d1b44b56dbf8ce9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pYXXLICMHqHgckAK5KZuWw.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/f7e37c27e86cac5721ea188c630ea436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*iSgt1LP4QUFLzrVbFT9YsQ.png"/></div></figure><p id="0962" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">希望这个 Python 脚本能帮助您踏上数据科学和数据工程之旅！</p></div></div>    
</body>
</html>