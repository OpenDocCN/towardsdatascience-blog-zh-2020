<html>
<head>
<title>Using R and Python in Google Sheets Formulas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Google Sheets公式中使用R和Python</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-r-and-python-in-google-sheets-formulas-b397b302098?source=collection_archive---------9-----------------------#2020-05-21">https://towardsdatascience.com/using-r-and-python-in-google-sheets-formulas-b397b302098?source=collection_archive---------9-----------------------#2020-05-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="d6c5" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Google Sheets中的自定义编程语言功能</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c2421ba4528f7110d3f3996ca6da7553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZQVGyVPXy5XYQPzl"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae ky" href="https://unsplash.com/@kmuza?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Carlos Muza </a>拍摄的照片</p></figure><h1 id="275d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">谷歌床单太神奇了！</h1><p id="2b7d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">谷歌的电子表格版本叫做<a class="ae ky" href="https://www.google.com/sheets/about/" rel="noopener ugc nofollow" target="_blank">谷歌表格</a>，它有一个隐藏的宝石，可以显著增加你的电子表格的功能，叫做<a class="ae ky" href="https://developers.google.com/apps-script" rel="noopener ugc nofollow" target="_blank">谷歌应用程序脚本</a>。Google Apps Script使用Javascript调用其他Google服务，创建交互式弹出对话框，甚至进行API调用。通过一点设置，您可以创建电子表格公式供其他人使用，执行R、Python或几乎任何编程语言代码！虽然Shiny和Dash是分享您的工作的好方法，但是按照本文中的说明，您将能够直接在Google Sheets中创建R和Python仪表板。另外，这些方法允许您将R和Python功能插入到其他Google服务中，比如文档、表单和幻灯片！</p><h1 id="4071" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">这里有几个例子</h1><ol class=""><li id="9a89" class="mn mo it lt b lu lv lx ly ma mp me mq mi mr mm ms mt mu mv bi translated"><strong class="lt iu">矩阵乘法</strong></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/240de559a6c553456f09c42c2d4c8849.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*X0XnpOECcdR0L9l28mnNww.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="2623" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated"><strong class="lt iu"> 2。绘图(基数R) </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/fb8696f4d441e8fcdb0b4d2c50d7eda5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*EO5aEZThWteDT6OwP3aMOg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d057" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated"><strong class="lt iu"> 3。绘图(ggplot2) </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/d3ea96b06dc19b990702f81b3495b8c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*DKcY92EY2Rhk8lTqQN9xlg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="d105" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated"><strong class="lt iu"> 4。部署模型</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/2eaa607939220af7a82ab99565aea016.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*6wqyGEfQrk_FfKiJ_Y_pcg.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="dccf" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated"><strong class="lt iu"> 5。任何R脚本！</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/31cdff692c8af586c4dff93bbb57f4a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*65GVtcUtTG-jdBP8ddZU8w.gif"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="115d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">这是什么魔法<strong class="ak">？</strong></h1><p id="ef4c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在幕后，每个自定义函数都是一个Google Apps脚本，它对我在Google Cloud Run中设置的一个端点进行API调用。如果您可以设置运行R、Python或任何其他语言脚本的API端点，那么您可以将这些功能导入到Google电子表格中。这是惊人的！</p><h1 id="ee1c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">尝试一下</h1><p id="95ce" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">下面的6个步骤从最容易到最难排列，将简单地让你开始使用你自己的定制的电子表格函数。关于Google Apps脚本、创建自己的API和Google Cloud Run还有很多内容可以在另一篇文章中介绍。</p><ol class=""><li id="499a" class="mn mo it lt b lu mx lx my ma nc me nd mi ne mm ms mt mu mv bi translated"><strong class="lt iu">在Google Drive中创建电子表格</strong></li><li id="55b8" class="mn mo it lt b lu nf lx ng ma nh me ni mi nj mm ms mt mu mv bi translated"><strong class="lt iu">工具菜单- &gt;脚本编辑器</strong></li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nk"><img src="../Images/387955ec6a001ef9070852fc78988087.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_JBgXUPWBwALLesp6J4kZA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="3b03" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">3.将下面的代码复制并粘贴到编辑器中。适应你的需求。</p><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="d49e" class="nq la it nm b gy nr ns l nt nu">/**<br/> * Run an R, Python, or other language script on spreadsheet data.<br/> *<br/> * <a class="ae ky" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> var1 The value or cell contents to pass to your API.<br/> * <a class="ae ky" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> var2 The value or cell contents to pass to your API.<br/> * <a class="ae ky" href="http://twitter.com/return" rel="noopener ugc nofollow" target="_blank">@return</a> The results of the API call you're about to make.<br/> * <a class="ae ky" href="http://twitter.com/customfunction" rel="noopener ugc nofollow" target="_blank">@customfunction</a><br/> */<br/>function myCustomFunction(var1 = null, var2 = null){<br/>  <br/>  // Assuming your API endpoint is like {baseURL}/{endpoint}.<br/>  var baseURL = '(Copy and paste API base url w/o trailing /)';<br/>  var endpoint = 'myCustomFunction';<br/>  <br/>  // Encode the variable values as JSON (or XML, or something else). <br/>  // See Google Apps Script UrlFetchApp documentation.<br/>  var data = {<br/>    'var1': var1,<br/>    'var2': var2,<br/>  }</span><span id="5a30" class="nq la it nm b gy nv ns l nt nu">// Set up the API call. Use POST requests to pass variables.<br/>// You can pass variables as query params of GET requests instead.<br/>  var options = {<br/>    'method' : 'post',<br/>    'contentType': 'application/json',<br/>    'payload' : JSON.stringify(data)<br/>  };<br/>  <br/>  // Make the API call. NOTE: Trailing slashes are important!<br/>  var response = UrlFetchApp.fetch(baseURL + '/' + endpoint + '/', options);<br/>  <br/>  // Parse the response.<br/>  data = JSON.parse(response.getContentText());<br/> <br/>  // I return "Error: {the error}" on script errors. <br/>  // Not necessary, but it shows useful error messages in cells.<br/>  if(String(data).substring(0,6) == "Error:"){<br/>    throw(String(data));<br/>  }<br/> <br/>  return(data);<br/>}</span></pre><p id="97ce" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">4.<strong class="lt iu">创建一个名为“Dockerfile”的不带扩展名的纯文本文件。<br/> </strong>把它放在硬盘上自己的文件夹里。不要紧张；你不需要在你的系统上安装Docker来执行这些步骤(但是你绝对应该在你的日常工作中使用Docker！)</p><p id="0aed" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">将以下内容之一复制并粘贴到docker文件中。</p><ul class=""><li id="526e" class="mn mo it lt b lu mx lx my ma nc me nd mi ne mm nw mt mu mv bi translated">R示例1:这里有一个R API的docker文件，它使用了令人惊奇的<a class="ae ky" href="https://www.rplumber.io/" rel="noopener ugc nofollow" target="_blank"> Plumber包</a>。这不是Tidyverse的产品，但它能创造出苗条的形象。</li></ul><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="c5fb" class="nq la it nm b gy nr ns l nt nu">FROM trestletech/plumber</span><span id="1bf4" class="nq la it nm b gy nv ns l nt nu">COPY [".", "./"]</span><span id="d5df" class="nq la it nm b gy nv ns l nt nu">ENTRYPOINT ["R", "-e", "pr &lt;- plumber::plumb(commandArgs()[4]); pr$run(host='0.0.0.0', port=as.numeric(Sys.getenv('PORT')), swagger = T)"]</span><span id="4f01" class="nq la it nm b gy nv ns l nt nu">CMD ["Plumber.R"]</span></pre><ul class=""><li id="8f7b" class="mn mo it lt b lu mx lx my ma nc me nd mi ne mm nw mt mu mv bi translated">R示例2:这里有一个R API的rocker文件，它确实带有Tidyverse和Tensorflow(基于<a class="ae ky" href="https://hub.docker.com/r/rocker/ml" rel="noopener ugc nofollow" target="_blank"> rocker/ml image </a>)。这就产生了臃肿的图像，并附带了RStudio。它不是用来生产的。</li></ul><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="51f4" class="nq la it nm b gy nr ns l nt nu">FROM samterfa/rmlsheets</span><span id="863c" class="nq la it nm b gy nv ns l nt nu">COPY [".", "./"]</span><span id="8b7d" class="nq la it nm b gy nv ns l nt nu">ENTRYPOINT ["Rscript", "-e", "pr &lt;- plumber::plumb(commandArgs()[9]); pr$run(host='0.0.0.0', port=as.numeric(Sys.getenv('PORT')), swagger = T)"]</span><span id="1209" class="nq la it nm b gy nv ns l nt nu">CMD ["Plumber.R"]</span></pre><ul class=""><li id="88a7" class="mn mo it lt b lu mx lx my ma nc me nd mi ne mm nw mt mu mv bi translated">Python示例:这里有一个Dockerfile文件，它使用了名副其实的<a class="ae ky" href="https://pypi.org/project/fastapi/" rel="noopener ugc nofollow" target="_blank">快速API </a>。</li></ul><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="a8c8" class="nq la it nm b gy nr ns l nt nu">FROM tiangolo/uvicorn-gunicorn-fastapi:python3.7</span><span id="1bbc" class="nq la it nm b gy nv ns l nt nu">RUN pip install pandas</span><span id="8baf" class="nq la it nm b gy nv ns l nt nu">COPY [".", "./"]</span></pre><p id="2ed2" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">5.<strong class="lt iu">创建支持自定义功能的脚本。将以下文件添加到与您的docker文件相同的文件夹中。请注意，Google Sheets中的单元格引用是作为单个单元格的单个值或多个单元格的嵌套列表传入的。</strong></p><ul class=""><li id="4329" class="mn mo it lt b lu mx lx my ma nc me nd mi ne mm nw mt mu mv bi translated">R API文件:创建一个名为Plumber.R的文件。</li></ul><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="0539" class="nq la it nm b gy nr ns l nt nu"># Swagger docs at ...s/__swagger__/ (needs trailing slash!)<br/>if(Sys.getenv('PORT') == '') Sys.setenv(PORT = 8000)</span><span id="21ac" class="nq la it nm b gy nv ns l nt nu">#' <a class="ae ky" href="http://twitter.com/apiTitle" rel="noopener ugc nofollow" target="_blank">@apiTitle</a> R Google Sheets Formulas<br/>#' <a class="ae ky" href="http://twitter.com/apiDescription" rel="noopener ugc nofollow" target="_blank">@apiDescription</a> These endpoints allow the user to create custom functions in Google spreadsheets which call R functions.</span><span id="4c20" class="nq la it nm b gy nv ns l nt nu">#* Return the product of 2 matrices<br/>#* <a class="ae ky" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> var1 An array of values representing the first matrix.<br/>#* <a class="ae ky" href="http://twitter.com/param" rel="noopener ugc nofollow" target="_blank">@param</a> var2 An array of values representing the second matrix.<br/>#* <a class="ae ky" href="http://twitter.com/post" rel="noopener ugc nofollow" target="_blank">@post</a> /myCustomFunction/<br/>function(var1, var2){<br/>  <br/>  err &lt;- tryCatch({<br/>    <br/>    return(data.matrix(var1) %*% data.matrix(var2))<br/>    <br/>  }, error = function(e) e)<br/>  <br/>  return(paste0('Error: ', err$message))<br/>}</span><span id="d2a6" class="nq la it nm b gy nv ns l nt nu">#* Confirmation Message<br/>#* <a class="ae ky" href="http://twitter.com/get" rel="noopener ugc nofollow" target="_blank">@get</a> /<br/>function(msg=""){<br/>  "My API Deployed!"<br/>}</span></pre><ul class=""><li id="34e6" class="mn mo it lt b lu mx lx my ma nc me nd mi ne mm nw mt mu mv bi translated">Python API文件:创建一个名为Main.py的文件。</li></ul><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="5330" class="nq la it nm b gy nr ns l nt nu">from fastapi import FastAPI<br/>from pydantic import BaseModel</span><span id="3bc6" class="nq la it nm b gy nv ns l nt nu">class Matrices(BaseModel):<br/>    var1: list<br/>    var2: list<br/>    <br/>app = FastAPI()</span><span id="33de" class="nq la it nm b gy nv ns l nt nu"><a class="ae ky" href="http://twitter.com/app" rel="noopener ugc nofollow" target="_blank">@app</a>.post("/myCustomFunction/")<br/>def myCustomFunction(matrices: Matrices):<br/>  <br/>  import sys<br/>  import numpy as np</span><span id="ef96" class="nq la it nm b gy nv ns l nt nu">  try:<br/>    <br/>    var1 = np.matrix(matrices.var1)<br/>    var2 = np.matrix(matrices.var2)<br/>    <br/>    results = np.matmul(var1, var2)<br/>    <br/>    return np.array(results).tolist()<br/>  <br/>  except:</span><span id="9b05" class="nq la it nm b gy nv ns l nt nu">    e_type, e_value, e_traceback = sys.exc_info()<br/>    <br/>    return 'Error: ' + str(e_type) + ' ' + str(e_value)</span><span id="53f2" class="nq la it nm b gy nv ns l nt nu">@app.get("/")<br/>def myAPIdeployed():</span><span id="48c1" class="nq la it nm b gy nv ns l nt nu">    return "My API Deployed!"</span></pre><p id="ebe2" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">注意:要在Google Sheet中运行任意的R或Python脚本，该脚本需要确定传递的数组是否包含列名。代码有点笨拙，但是我在本文的结尾加入了一个R尝试。</p><p id="2ca9" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">6.<strong class="lt iu">部署您的API(到Google Cloud Run) <br/> </strong>如果您已经知道如何部署R或Python API，那么您可能已经停止阅读这篇文章并开始比赛了！对于我们其余的人，我将指导您使用Google Cloud Run来托管您的API。</p><p id="01be" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">马克·埃德蒙森创造了一个惊人的R包，名为<a class="ae ky" href="https://code.markedmondson.me/googleCloudRunner/index.html" rel="noopener ugc nofollow" target="_blank"> googleCloudRunner </a>。这个包处理auth，创建构建，并将容器部署到Google Cloud Run。这真的很了不起。如果您没有安装R，您可以遵循<a class="ae ky" href="https://medium.com/google-cloud/google-cloud-run-or-how-to-run-your-static-website-in-5-minutes-and-much-more-dbe8f2804395" rel="noopener">这些项目设置说明</a>，以及<a class="ae ky" href="https://medium.com/google-cloud/hosting-a-website-on-google-cloud-using-cloud-run-a65343a98fce" rel="noopener">这些部署说明</a>，记住我们正在尝试从上面部署我们的Dockerfile。从现在开始，我将假设您已经安装了R running和googleCloudRunner。</p><ul class=""><li id="5583" class="mn mo it lt b lu mx lx my ma nc me nd mi ne mm nw mt mu mv bi translated">转到<a class="ae ky" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">https://console.cloud.google.com/</a></li><li id="0ffe" class="mn mo it lt b lu nf lx ng ma nh me ni mi nj mm nw mt mu mv bi translated">如果您以前从未创建过项目，请同意条款和服务。</li><li id="4386" class="mn mo it lt b lu nf lx ng ma nh me ni mi nj mm nw mt mu mv bi translated">点击<em class="nx">选择一个项目</em>，然后<em class="nx">新建项目</em>。</li><li id="66c3" class="mn mo it lt b lu nf lx ng ma nh me ni mi nj mm nw mt mu mv bi translated">命名并创建项目。我喜欢脚本、Pyscripts或类似的东西。</li><li id="8b44" class="mn mo it lt b lu nf lx ng ma nh me ni mi nj mm nw mt mu mv bi translated">确保项目名称在左上方的下拉列表中。</li><li id="d5ec" class="mn mo it lt b lu nf lx ng ma nh me ni mi nj mm nw mt mu mv bi translated">点击左侧下拉菜单，点击<em class="nx">计费</em>，然后<em class="nx">添加计费账户</em>。我保证，<a class="ae ky" href="https://cloud.google.com/run/pricing" rel="noopener ugc nofollow" target="_blank">很便宜</a>！</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/3dc18fa279f3dd6a12757a40ab48d102.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hSyV7Q0Tz1tjkCcTy77HkA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><ul class=""><li id="97aa" class="mn mo it lt b lu mx lx my ma nc me nd mi ne mm nw mt mu mv bi translated">对于其余的设置，遵循马克埃德蒙森的指示<a class="ae ky" href="https://code.markedmondson.me/googleCloudRunner/articles/setup.html#gcp-settings" rel="noopener ugc nofollow" target="_blank">这里</a>。</li><li id="e47b" class="mn mo it lt b lu nf lx ng ma nh me ni mi nj mm nw mt mu mv bi translated">确定包含docker文件和API文件的文件夹的路径。姑且称之为“/用户/我/我的/API/路径”。</li><li id="1897" class="mn mo it lt b lu nf lx ng ma nh me ni mi nj mm nw mt mu mv bi translated">使用R，运行以下命令来部署您的API！在Google Cloud Run中创建的服务的名称将是文件夹路径中最后一个文件夹的名称，所以请确保您喜欢这个名称，并且它的名称是小写的。</li></ul><pre class="kj kk kl km gt nl nm nn no aw np bi"><span id="5694" class="nq la it nm b gy nr ns l nt nu">googleCloudRunner::cr_deploy_run(local = "/users/me/my/api/path")</span><span id="4a99" class="nq la it nm b gy nv ns l nt nu"># Wait, that's it? Just that?</span></pre><ul class=""><li id="11f2" class="mn mo it lt b lu mx lx my ma nc me nd mi ne mm nw mt mu mv bi translated">将打开一个浏览器，显示您的构建进度。如果有错误，您可以使用日志消息来确定哪里出错了。常见的问题是缺少服务帐户权限和代码问题。如果您对Docker感到满意，可以在本地进行测试，以确保没有代码问题。如果成功，您应该会看到一条消息(如果您复制并粘贴了我的代码)。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nz"><img src="../Images/48842f2fa4b84e761d79bfbf36adfdd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3KLRgTAYMqW3IHhJikfADQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><ul class=""><li id="515a" class="mn mo it lt b lu mx lx my ma nc me nd mi ne mm nw mt mu mv bi translated">一旦启动，你需要将上面的API URL复制并粘贴到你的Google Apps脚本中。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oa"><img src="../Images/ac4c95b1109f110f05741a5e82102b5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qNSfV2JDfgI6kt7KAJGOzg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><ul class=""><li id="dc90" class="mn mo it lt b lu mx lx my ma nc me nd mi ne mm nw mt mu mv bi translated">试试吧！在Google工作表中创建两个数字数组，它们可以作为矩阵相乘，开始输入“=myCustomFunction("，突出显示单元格，然后给自己留下深刻印象。</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/c88af9afb3339747b480afbd2ea8672b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zh4VhI9toGwyeISQYNKcTA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><h1 id="bf0d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">资源</h1><ol class=""><li id="b51b" class="mn mo it lt b lu lv lx ly ma mp me mq mi mr mm ms mt mu mv bi translated"><strong class="lt iu">免费API</strong><a class="ae ky" href="https://swagger.io/docs/specification/2-0/what-is-swagger/" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">Swagger</strong></a><strong class="lt iu">网页<br/> </strong>这些都是自动为你生成的，因为你用了R包Plumber或者基于Python的FastAPI。</li></ol><ul class=""><li id="dadb" class="mn mo it lt b lu mx lx my ma nc me nd mi ne mm nw mt mu mv bi translated">r版本位于{YourBaseURL}/__swagger__/</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oc"><img src="../Images/45d4b3bfea7328f263a527e8249ec4ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*51vjTJ-eqfYY1WaUyjQrAQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><ul class=""><li id="6aa6" class="mn mo it lt b lu mx lx my ma nc me nd mi ne mm nw mt mu mv bi translated">Python版本位于{YourBaseURL}/docs</li></ul><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi od"><img src="../Images/94f6bdb515c0800d9a3802ecb35303c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R-8UOarXRSBBkR5oi4Om6g.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">作者图片</p></figure><p id="b486" class="pw-post-body-paragraph lr ls it lt b lu mx ju lw lx my jx lz ma mz mc md me na mg mh mi nb mk ml mm im bi translated">2.<a class="ae ky" href="https://github.com/samterfa/rpysheets" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu">samterfa/rpysheets</strong><strong class="lt iu">GitHub Repo</strong></a><strong class="lt iu"><br/></strong>这个Repo包含上面列出的所有文件加上一些额外的材料。奖励材料包括通用脚本函数，以及MNIST数字预测函数。如果你想对大型模型进行预测，谷歌表单会给你30秒的时间限制。你可能还需要增强你的谷歌云运行服务。</p></div></div>    
</body>
</html>