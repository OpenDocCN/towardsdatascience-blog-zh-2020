# æœºå™¨å­¦ä¹ ä¸­æœ€å¸¸è§çš„æŸå¤±å‡½æ•°

> åŸæ–‡ï¼š<https://towardsdatascience.com/most-common-loss-functions-in-machine-learning-c7212a99dae0?source=collection_archive---------17----------------------->

## ç°å®ä¸–ç•Œä¸­çš„ DS

## æ¯ä¸ªæœºå™¨å­¦ä¹ å·¥ç¨‹å¸ˆéƒ½åº”è¯¥äº†è§£æœºå™¨å­¦ä¹ ä¸­è¿™äº›å¸¸è§çš„æŸå¤±å‡½æ•°ï¼Œä»¥åŠä½•æ—¶ä½¿ç”¨å®ƒä»¬ã€‚

> åœ¨[æ•°å­¦ä¼˜åŒ–](https://en.wikipedia.org/wiki/Mathematical_optimization)å’Œ[å†³ç­–ç†è®º](https://en.wikipedia.org/wiki/Decision_theory)ä¸­ï¼ŒæŸå¤±å‡½æ•°æˆ–æˆæœ¬å‡½æ•°æ˜¯å°†[äº‹ä»¶](https://en.wikipedia.org/wiki/Event_(probability_theory))æˆ–ä¸€ä¸ªæˆ–å¤šä¸ªå˜é‡çš„å€¼æ˜ å°„åˆ°[å®æ•°](https://en.wikipedia.org/wiki/Real_number)ä¸Šçš„å‡½æ•°ï¼Œè¯¥å®æ•°ç›´è§‚åœ°è¡¨ç¤ºä¸è¯¥äº‹ä»¶ç›¸å…³çš„ä¸€äº›â€œæˆæœ¬â€ã€‚
> â€”â€”[ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Loss_function)

![](img/d97bcee98a515aa9bb9675ce1727a9c2.png)

[çº¦ä»€Â·ç½—æ–¯](https://unsplash.com/@joshsrose?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ç…§ç‰‡

ä½œä¸ºä¸€ä¸ªæ ¸å¿ƒå…ƒç´ ï¼ŒæŸå¤±å‡½æ•°æ˜¯ä¸€ç§è¯„ä¼°æœºå™¨å­¦ä¹ ç®—æ³•çš„æ–¹æ³•ï¼Œå®ƒå¯ä»¥å¾ˆå¥½åœ°æ¨¡æ‹Ÿæ‚¨çš„ç‰¹å¾æ•°æ®é›†ã€‚å®ƒè¢«å®šä¹‰ä¸º**è¡¡é‡ä½ çš„æ¨¡å‹åœ¨é¢„æµ‹é¢„æœŸç»“æœæ–¹é¢æœ‰å¤šå¥½ã€‚**

***æˆæœ¬å‡½æ•°*** å’Œ ***æŸå¤±å‡½æ•°*** æŒ‡åŒä¸€ä¸Šä¸‹æ–‡ã€‚æˆæœ¬å‡½æ•°æ˜¯ä½œä¸ºæ‰€æœ‰æŸå¤±å‡½æ•°å€¼çš„å¹³å‡å€¼è®¡ç®—çš„å‡½æ•°ã€‚ç„¶è€Œï¼ŒæŸå¤±å‡½æ•°æ˜¯é’ˆå¯¹æ¯ä¸ªæ ·æœ¬è¾“å‡ºä¸å…¶å®é™…å€¼çš„æ¯”è¾ƒæ¥è®¡ç®—çš„ã€‚

***æŸå¤±å‡½æ•°ä¸ä½ å·²ç»å»ºç«‹çš„æ¨¡å‹çš„é¢„æµ‹ç›´æ¥ç›¸å…³ã€‚å› æ­¤ï¼Œå¦‚æœæ‚¨çš„æŸå¤±å‡½æ•°å€¼è¾ƒå°ï¼Œæ‚¨çš„æ¨¡å‹å°†æä¾›è‰¯å¥½çš„ç»“æœã€‚æŸå¤±å‡½æ•°ï¼Œæˆ–è€…æ›´ç¡®åˆ‡åœ°è¯´ï¼Œç”¨äºè¯„ä¼°æ¨¡å‹æ€§èƒ½çš„æˆæœ¬å‡½æ•°ï¼Œéœ€è¦æœ€å°åŒ–ä»¥æé«˜å…¶æ€§èƒ½ã€‚***

ç°åœ¨è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶æŸå¤±å‡½æ•°ã€‚

å¹¿æ³›åœ°è¯´ï¼ŒæŸå¤±å‡½æ•°å¯ä»¥æ ¹æ®æˆ‘ä»¬åœ¨ç°å®ä¸–ç•Œä¸­é‡åˆ°çš„é—®é¢˜ç±»å‹åˆ†ä¸ºä¸¤å¤§ç±»â€”[](https://en.wikipedia.org/wiki/Loss_functions_for_classification)**åˆ†ç±»å’Œ**å›å½’**ã€‚åœ¨åˆ†ç±»ä¸­ï¼Œä»»åŠ¡æ˜¯é¢„æµ‹é—®é¢˜æ‰€å¤„ç†çš„æ‰€æœ‰ç±»åˆ«å„è‡ªçš„æ¦‚ç‡ã€‚ç›¸åï¼Œåœ¨å›å½’ä¸­ï¼Œä»»åŠ¡æ˜¯é¢„æµ‹å…³äºå­¦ä¹ ç®—æ³•çš„ä¸€ç»„ç»™å®šç‹¬ç«‹ç‰¹å¾çš„è¿ç»­å€¼ã€‚**

```
**Assumptions:**
    n/m â€” Number of training samples.
    i â€” ith training sample in a dataset.
    y(i) â€” Actual value for the ith training sample.
    y_hat(i) â€” Predicted value for the ith training sample.
```

# **åˆ†ç±»æŸå¤±**

## **1.äºŒå…ƒäº¤å‰ç†µæŸå¤±/å¯¹æ•°æŸå¤±**

**è¿™æ˜¯åˆ†ç±»é—®é¢˜ä¸­æœ€å¸¸ç”¨çš„æŸå¤±å‡½æ•°ã€‚äº¤å‰ç†µæŸå¤±éšç€é¢„æµ‹æ¦‚ç‡æ”¶æ•›åˆ°å®é™…æ ‡ç­¾è€Œå‡å°‘ã€‚å®ƒæµ‹é‡åˆ†ç±»æ¨¡å‹çš„æ€§èƒ½ï¼Œè¯¥æ¨¡å‹çš„é¢„æµ‹è¾“å‡ºæ˜¯ä»‹äº 0 å’Œ 1 ä¹‹é—´çš„æ¦‚ç‡å€¼ã€‚**

****å½“ç±»åˆ«æ•°ä¸º 2 æ—¶ï¼Œ*äºŒå…ƒåˆ†ç±»*****

**![](img/17061658ec554151f795222e0d92b5e7.png)**

****å½“ç±»åˆ«æ•°å¤§äº 2 æ—¶ï¼Œ*å¤šç±»åˆ«åˆ†ç±»*****

**![](img/b8d780bb64fe7ebaa6c86b99ea005c8a.png)****![](img/b2222151ef3ac4767cee1b46eee9b070.png)**

**äº¤å‰ç†µæŸå¤±å…¬å¼æ˜¯ä»æ­£åˆ™ä¼¼ç„¶å‡½æ•°ä¸­æ¨å¯¼å‡ºæ¥çš„ï¼Œä½†æ˜¯åŠ å…¥äº†å¯¹æ•°ã€‚**

## **2.é“°é“¾æŸè€—**

**ç”¨äºåˆ†ç±»é—®é¢˜çš„ç¬¬äºŒå¸¸è§æŸå¤±å‡½æ•°å’Œäº¤å‰ç†µæŸå¤±å‡½æ•°çš„æ›¿ä»£å‡½æ•°æ˜¯é“°é“¾æŸå¤±ï¼Œä¸»è¦ç”¨äºæ”¯æŒå‘é‡æœº(SVM)æ¨¡å‹è¯„ä¼°ã€‚**

**![](img/62c58841808e8c33ea3262e481d555a2.png)****![](img/adc53276a54fcb43e2d18bf77ac6212f.png)**

> ***é“°é“¾æŸå¤±ä¸ä»…æƒ©ç½šé”™è¯¯çš„é¢„æµ‹ï¼Œä¹Ÿæƒ©ç½šä¸è‡ªä¿¡çš„æ­£ç¡®é¢„æµ‹ã€‚å®ƒä¸»è¦ç”¨äºç±»åˆ«æ ‡ç­¾ä¸º-1 å’Œ 1 çš„ SVM åˆ†ç±»å™¨ã€‚ç¡®ä¿å°†æ¶æ€§åˆ†ç±»æ ‡ç­¾ä» 0 æ›´æ”¹ä¸º-1ã€‚***

**![](img/16d28840de25c623ff766e4eaf468a9f.png)**

**ç…§ç‰‡ç”± [Jen Theodore](https://unsplash.com/@jentheodore?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šæ‹æ‘„**

# **å›å½’æŸå¤±**

## **1.å‡æ–¹è¯¯å·®/äºŒæ¬¡æŸè€—/ L2 æŸè€—**

**MSE æŸå¤±å‡½æ•°è¢«å®šä¹‰ä¸ºå®é™…å€¼å’Œé¢„æµ‹å€¼ä¹‹é—´çš„å¹³æ–¹å·®çš„å¹³å‡å€¼ã€‚å®ƒæ˜¯æœ€å¸¸ç”¨çš„å›å½’æŸå¤±å‡½æ•°ã€‚**

**![](img/8554425e7ceda1beb1c20886c5f74349.png)****![](img/c9132a1bc37272922980a83b62d5666f.png)**

**å¯¹åº”çš„ä»£ä»·å‡½æ•°æ˜¯è¿™äº›**å¹³æ–¹è¯¯å·®**çš„**å‡å€¼**ã€‚MSE æŸå¤±å‡½æ•°é€šè¿‡å¹³æ–¹å®ƒä»¬æ¥æƒ©ç½šäº§ç”Ÿå¤§è¯¯å·®çš„æ¨¡å‹ï¼Œå¹¶ä¸”è¯¥å±æ€§ä½¿å¾— MSE æˆæœ¬å‡½æ•°å¯¹å¼‚å¸¸å€¼ä¸å¤ªç¨³å¥ã€‚å› æ­¤ï¼Œ ***å¦‚æœæ•°æ®å®¹æ˜“å‡ºç°å¾ˆå¤šç¦»ç¾¤å€¼ï¼Œå°±ä¸åº”è¯¥ä½¿ç”¨ã€‚*****

## **2.å¹³å‡ç»å¯¹è¯¯å·®/ L1 æŸè€—**

**MSE æŸå¤±å‡½æ•°è¢«å®šä¹‰ä¸ºå®é™…å€¼å’Œé¢„æµ‹å€¼ä¹‹é—´çš„ç»å¯¹å·®å€¼çš„å¹³å‡å€¼ã€‚è¿™æ˜¯ç¬¬äºŒä¸ªæœ€å¸¸ç”¨çš„å›å½’æŸå¤±å‡½æ•°ã€‚å®ƒæµ‹é‡ä¸€ç»„é¢„æµ‹ä¸­è¯¯å·®çš„å¹³å‡å¤§å°ï¼Œä¸è€ƒè™‘å®ƒä»¬çš„æ–¹å‘ã€‚**

**![](img/bd8348c28f43455c8ce8f2be610881e4.png)****![](img/9e5f098c21be00a0fb14df83b993a567.png)**

**å¯¹åº”çš„ä»£ä»·å‡½æ•°æ˜¯è¿™äº›**ç»å¯¹è¯¯å·®(MAE)** çš„**å‡å€¼**ã€‚ä¸ MSE æŸå¤±å‡½æ•°ç›¸æ¯”ï¼ŒMAE æŸå¤±å‡½æ•°å¯¹å¼‚å¸¸å€¼æ›´ç¨³å¥ã€‚å› æ­¤ï¼Œ ***åœ¨æ•°æ®å®¹æ˜“å‡ºç°å¾ˆå¤šç¦»ç¾¤å€¼çš„æƒ…å†µä¸‹åº”è¯¥ä½¿ç”¨ã€‚*****

## **3.Huber æŸå¤±/å¹³æ»‘å¹³å‡ç»å¯¹è¯¯å·®**

**Huber æŸå¤±å‡½æ•°è¢«å®šä¹‰ä¸ºå½“ğ›¿ ~ 0 æ—¶ MSE å’Œå½“ğ›¿ ~ âˆ(å¤§æ•°)æ—¶ MAE æ¥è¿‘**æ—¶ MSE å’Œ MAE æŸå¤±å‡½æ•°çš„ç»„åˆã€‚å®ƒæ˜¯å¹³å‡ç»å¯¹è¯¯å·®ï¼Œå½“è¯¯å·®å¾ˆå°æ—¶ï¼Œå®ƒå˜æˆäºŒæ¬¡è¯¯å·®ã€‚ä½¿è¯¯å·®ä¸ºäºŒæ¬¡å‹å–å†³äºè¯¯å·®æœ‰å¤šå°ï¼Œè¿™æ˜¯ç”±ä¸€ä¸ªå¯ä»¥è°ƒèŠ‚çš„è¶…å‚æ•°ğ›¿(Î´)æ§åˆ¶çš„ã€‚****

**![](img/ae2b32a66feeac088062959b4f1c5568.png)****![](img/50b5cb58e6a4da4a78c5041cebb9d70a.png)**

**å¢é‡å€¼çš„é€‰æ‹©è‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒå†³å®šäº†æ‚¨æ„¿æ„å°†ä»€ä¹ˆè§†ä¸ºå¼‚å¸¸å€¼ã€‚å› æ­¤ï¼Œå–å†³äºè¶…å‚æ•°å€¼ï¼Œä¸ MSE æŸå¤±å‡½æ•°ç›¸æ¯”ï¼ŒHuber æŸå¤±å‡½æ•°å¯¹å¼‚å¸¸å€¼ä¸å¤ªæ•æ„Ÿã€‚å› æ­¤ï¼Œ ***å¦‚æœæ•°æ®å®¹æ˜“å‡ºç°å¼‚å¸¸å€¼ï¼Œå¯ä»¥ä½¿ç”¨å®ƒï¼Œå¹¶ä¸”*æˆ‘ä»¬å¯èƒ½éœ€è¦è®­ç»ƒè¶…å‚æ•° deltaï¼Œè¿™æ˜¯ä¸€ä¸ªè¿­ä»£è¿‡ç¨‹ã€‚****

## **4.å¯¹æ•°æŸå¤±**

**å¯¹æ•°ä½™å¼¦æŸå¤±å‡½æ•°è¢«å®šä¹‰ä¸ºé¢„æµ‹è¯¯å·®çš„åŒæ›²ä½™å¼¦çš„å¯¹æ•°ã€‚è¿™æ˜¯å›å½’ä»»åŠ¡ä¸­ä½¿ç”¨çš„å¦ä¸€ä¸ªå‡½æ•°ï¼Œæ¯” MSE æŸå¤±å¹³æ»‘å¾—å¤šã€‚å®ƒå…·æœ‰ Huber æŸå¤±çš„æ‰€æœ‰ä¼˜ç‚¹ï¼Œå¹¶ä¸”å®ƒåœ¨ä»»ä½•åœ°æ–¹éƒ½æ˜¯ä¸¤æ¬¡å¯å¾®çš„ï¼Œä¸åƒ Huber æŸå¤±ï¼Œå› ä¸ºåƒ XGBoost è¿™æ ·çš„ä¸€äº›å­¦ä¹ ç®—æ³•ä½¿ç”¨ç‰›é¡¿æ³•æ¥å¯»æ‰¾æœ€ä¼˜å€¼ï¼Œå› æ­¤éœ€è¦äºŒé˜¶å¯¼æ•°( *Hessian* )ã€‚**

**![](img/139282adfe2a1985be9ca7e3e6266832.png)****![](img/eccf1cadf1be41b0178377d97a398f65.png)**

> **`*log(cosh(x))*` *çº¦ç­‰äº* `*(x ** 2) / 2*` *ä¸ºå°* `*x*` *ï¼Œä»¥* `*abs(x) - log(2)*` *ä¸ºå¤§* `*x*` *ã€‚è¿™æ„å‘³ç€â€œlogcoshâ€çš„å·¥ä½œæ–¹å¼å¾ˆå¤§ç¨‹åº¦ä¸Šç±»ä¼¼äºå‡æ–¹è¯¯å·®ï¼Œä½†ä¸ä¼šå—åˆ°å¶å°”å‡ºç°çš„ä¸¥é‡é”™è¯¯é¢„æµ‹çš„å¼ºçƒˆå½±å“ã€‚
> â€”* [*Tensorflow æ–‡æ¡£*](https://www.tensorflow.org/api_docs/python/tf/keras/losses/logcosh)**

## ****5ã€‚åˆ†ä½æ•°æŸå¤±****

**åˆ†ä½æ•°æ˜¯ä¸€ä¸ªå€¼ï¼Œä½äºè¿™ä¸ªå€¼ï¼Œä¸€ä¸ªç»„ä¸­çš„ä¸€éƒ¨åˆ†æ ·æœ¬å°±ä¼šä¸‹é™ã€‚æœºå™¨å­¦ä¹ æ¨¡å‹é€šè¿‡æœ€å°åŒ–(æˆ–æœ€å¤§åŒ–)ç›®æ ‡å‡½æ•°æ¥å·¥ä½œã€‚é¡¾åæ€ä¹‰ï¼Œåˆ†ä½æ•°å›å½’æŸå¤±å‡½æ•°ç”¨äºé¢„æµ‹åˆ†ä½æ•°ã€‚å¯¹äºä¸€ç»„é¢„æµ‹ï¼ŒæŸå¤±å°†æ˜¯å…¶å¹³å‡å€¼ã€‚**

**![](img/3d744c02c693f84fd142f732c32cb38c.png)****![](img/a9ec9fda72373ed86f80ea982b0bff4a.png)**

**[åˆ†ä½æ•°æŸå¤±å‡½æ•°](/deep-quantile-regression-c85481548b5a)åœ¨æˆ‘ä»¬å¯¹é¢„æµ‹åŒºé—´è€Œä¸ä»…ä»…æ˜¯ç‚¹é¢„æµ‹æ„Ÿå…´è¶£æ—¶éå¸¸æœ‰ç”¨ã€‚**

**æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼å¸Œæœ›è¿™ç¯‡å¸–å­æœ‰ç”¨ã€‚æˆ‘æ„Ÿè°¢åé¦ˆå’Œå»ºè®¾æ€§çš„æ‰¹è¯„ã€‚å¦‚æœä½ æƒ³è°ˆè®ºè¿™ç¯‡æ–‡ç« æˆ–å…¶ä»–ç›¸å…³è¯é¢˜ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œæˆ–æˆ‘çš„ [LinkedIn](https://www.linkedin.com/in/imsparsh/) è´¦æˆ·ä¸Šç»™æˆ‘å‘çŸ­ä¿¡ã€‚**

**![](img/463b4304d8622ab8bd9075b5656497bc.png)**

**ç…§ç‰‡ç”±[å…‹åŠ³ç¦å¾·ä¹”åˆ©](https://unsplash.com/@crawford?utm_source=medium&utm_medium=referral)åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) æ‹æ‘„**