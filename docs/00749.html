<html>
<head>
<title>SQL Joins: A Brief Example</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL 连接:一个简单的例子</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sql-joins-a-brief-example-9d015868b56a?source=collection_archive---------25-----------------------#2020-01-21">https://towardsdatascience.com/sql-joins-a-brief-example-9d015868b56a?source=collection_archive---------25-----------------------#2020-01-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/5e04cfbdb6309729ce9dc7409e7b664d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*eJT-XE76alWaXKld"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">照片由<a class="ae jg" href="https://unsplash.com/@jjying?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> JJ 英</a>在<a class="ae jg" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure><div class=""/><div class=""><h2 id="9826" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">理解 SQL 连接的原因和方式</h2></div><p id="b80e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi lu translated"><span class="l lv lw lx bm ly lz ma mb mc di"> T </span>他的博客文章原本打算作为我的<em class="md">熊猫加入与合并</em>文章的旁注。但事实证明，它足够长，足以保证自己的帖子(而且对于旁注来说太冗长了)。这并不意味着它是 SQL 连接的全面入门，而是一个示例，帮助那些 SQL 和关系数据库新手开始理解连接两个表的意义。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="57cb" class="ml mm jj bd mn mo mp mq mr ms mt mu mv kp mw kq mx ks my kt mz kv na kw nb nc bi translated">我们为什么加入？</h1><p id="7e31" class="pw-post-body-paragraph ky kz jj la b lb nd kk ld le ne kn lg lh nf lj lk ll ng ln lo lp nh lr ls lt im bi translated">为什么要费心加入呢？难道我们不能把所有的东西都放进一个电子表格里，然后在那里分类吗？也许…但是这将非常耗时，乏味，并且容易出错。</p><p id="1a82" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">关系数据库是为连接而设计的。数据库中的每个表都包含特定形式或功能的数据。</strong>例如，一个表可能包含公司客户的基本数据，如客户 ID(可用于识别每个客户的唯一 ID)、姓名、年龄、性别、首次购买日期和地址。而一个单独的大得多的表存储详细的交易级别数据—交易 ID、交易日期、客户 ID、产品类别、产品 ID、销售单位和价格。</p><p id="e7dd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一个给定的客户(或客户 ID)可能有数百甚至数千笔交易，因此为 transactions 表中的每一行反复存储该客户的基本信息是非常多余的。交易表应该只用于与交易相关的数据。表之间有太多重叠数据是一种浪费，并且会对系统性能产生负面影响。</p><p id="e578" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">但这并不意味着我们不关心表之间的联系。考虑到每个表的特殊性，只涉及单个表的分析通常是没有用的。有趣的分析来自组合了多个表的数据集。例如，我们可能希望按年龄或地理位置对交易进行细分。为此，<strong class="la jk">我们需要两个表中的数据。这就是加入的作用。</strong></p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="bad1" class="ml mm jj bd mn mo mp mq mr ms mt mu mv kp mw kq mx ks my kt mz kv na kw nb nc bi translated">我们如何加入？</h1><p id="71d8" class="pw-post-body-paragraph ky kz jj la b lb nd kk ld le ne kn lg lh nf lj lk ll ng ln lo lp nh lr ls lt im bi translated"><strong class="la jk">当我们连接两个表时，我们通过一个选定的特征将它们链接在一起。假设我们有两张桌子。第一个是<strong class="la jk">雇员</strong>，列出了雇员的惟一 ID 号、姓名和职务。第二个是<strong class="la jk"> Sale </strong>，它通过将雇员的 ID 号和售出的单位附加到一个唯一的销售号上，列出了谁进行了何种销售的数据:</strong></p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="5abd" class="nr mm jj nn b gy ns nt l nu nv">SELECT * FROM Employee<br/>SELECT * FROM Sale</span></pre><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nw"><img src="../Images/ac1314dee821ed719dbb6cdd792dfe17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mZZVn0ScrSKQrby04oy1dA.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">我们的两张表，员工(左)和销售(右)</p></figure><p id="f129" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><em class="md">(为了清晰起见，我省略了图形中列名的下划线)</em></p><p id="28c7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们把两张桌子连接起来。为了链接这两个表，我们需要选择一个列(或列的组合)作为交叉点——让我们将选择的列称为连接索引。共享相同连接索引值的表条目被连接在一起。请注意，交集不一定是一对一的。例如，Tony 完成了两笔销售，因此在连接表时，他的两笔销售都将链接到 Tony(也称为雇员 ID 1)。</p><p id="a22e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们连接表时，我们通常希望连接索引是惟一的。如果连接索引不是惟一的，可能会发生奇怪的事情。例如，假设我们有第二个员工叫 Tony(以及下面的表格)，他是一个超级明星销售员。如果我们不是根据“员工 ID”加入，而是根据“姓名”加入，那么我们会错误地将超级巨星托尼的销售额与我联系起来，使我的奖金过高:</p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/e3e4cd4fc5cf14e990301ed0695fc206.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zeh3gFvEoRifV9Jdu-Ni4A.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">不建议对非唯一列进行联接</p></figure><p id="cc9b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">超级巨星托尼也会因为我可怜的销售业绩而得到好评(他并不需要)。因此，为了避免这种情况，我们加入了一个具有独特值的列，如“员工 id”(我删除了超级巨星托尼，因为他只是为了说明不要做什么，他令人难以置信的成功让我感到不值):</p><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ny"><img src="../Images/19d1c0a9e1d02681f1c339c8d90ff4ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M8i0SXBqwqyb8xB1SucZ3w.jpeg"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">“雇员 ID”列提供了两个表之间的链接</p></figure><p id="46b0" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">有各种类型的 SQL 连接，我不会在这里详细讨论它们。在这个例子中，我们将使用一个<strong class="la jk">左连接</strong>，这意味着我们对左表中的行进行优先级排序。<strong class="la jk">因此，我们的输出将包括左表</strong>(带有“姓名”和“职位”的那一行)中的每一行，而不管是否与右表匹配——因此，没有销售的雇员仍将在我们的输出中有一行，但是“销售数量”和“销售单位”列没有值(确切地说是空值)。</p><p id="d450" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们来看看我们的输出(我们只从右边的表中选择“销售数量”和“售出单位”，并按“员工 ID”排序):</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="623f" class="nr mm jj nn b gy ns nt l nu nv">SELECT e.*, s.Sale_Number, s.Units_Sold<br/>FROM Employee as e<br/>    LEFT JOIN Sale as s ON e.Employee_ID=s.Employee_ID<br/>ORDER BY e.Employee_ID</span></pre><figure class="ni nj nk nl gt iv gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/6030142a3c476ea7c158bd6afc422aa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*wpBPzBd7onTiunugJ6elLw.jpeg"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">我们左连接的结果</p></figure><p id="8dba" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们的连接的输出现在包括了来自两个表的数据。Tony 的销售数据与他的员工数据(由于员工 ID)相关联，Lisa 也是如此。注意两件事:</p><ol class=""><li id="c137" class="oa ob jj la b lb lc le lf lh oc ll od lp oe lt of og oh oi bi translated">这看起来有点重复，因为“雇员 ID”、“姓名”和“职位”会重复出现，次数与雇员的销售额一样多。实际上，我们不会就此止步。接下来，我们很有可能用做一个<strong class="la jk">分组，以统计每个雇员的销售额，或者计算每个雇员每次销售的平均销售量。</strong></li><li id="886c" class="oa ob jj la b lb oj le ok lh ol ll om lp on lt of og oh oi bi translated">输出中缺少雇员 ID 3，因为我们进行了左连接，在左表中没有雇员 ID 3 的条目。因此，它被省略了。</li></ol><p id="b86b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们简短的例子到此结束。希望这能让您对我们为什么需要连接以及它们是如何工作的有一个基本的了解。</p></div><div class="ab cl me mf hx mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="im in io ip iq"><h1 id="d559" class="ml mm jj bd mn mo mp mq mr ms mt mu mv kp mw kq mx ks my kt mz kv na kw nb nc bi translated">关键要点:</h1><ul class=""><li id="4639" class="oa ob jj la b lb nd le ne lh oo ll op lp oq lt or og oh oi bi translated">数据库表通常包含非常具体的信息。因此，有意义的分析通常结合来自多个表的数据。</li><li id="daa4" class="oa ob jj la b lb oj le ok lh ol ll om lp on lt or og oh oi bi translated">这是通过 join 操作完成的，join 操作通过基于指定的列匹配两个表来组合它们。</li><li id="1dc9" class="oa ob jj la b lb oj le ok lh ol ll om lp on lt or og oh oi bi translated">用于合并表的列应该只包含唯一的值。</li><li id="e5e8" class="oa ob jj la b lb oj le ok lh ol ll om lp on lt or og oh oi bi translated">有各种类型的连接。本例中的一个是左连接，它返回左表中的每一行，不管是否匹配。</li></ul></div></div>    
</body>
</html>