<html>
<head>
<title>Footballers’ Paradoxical Birthdays</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">足球运动员自相矛盾的生日</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/footballers-paradoxical-birthdays-1aa0cbade7e5?source=collection_archive---------43-----------------------#2020-04-02">https://towardsdatascience.com/footballers-paradoxical-birthdays-1aa0cbade7e5?source=collection_archive---------43-----------------------#2020-04-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a4be" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">用贝叶斯因子证明生日问题</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/79f927f0c21673341904d4724ea15955.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*6i0uhxdpFSNjVVQ2IPpGYA.jpeg"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">在<a class="ae ku" href="https://unsplash.com/s/photos/birthday?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上<a class="ae ku" href="https://unsplash.com/@seagull_tree?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">卡特琳娜·伯杰</a>的照片</p></figure><h1 id="93a4" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">序文</h1><p id="b100" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">好吧，好吧。这个标题有点误导——甚至是<em class="mj"> clickbait </em>。至少有66%是这样的。首先，我今天要解决的现象并不是足球运动员独有的，但鉴于在可预见的未来，白俄罗斯以外的所有足球活动都将被取消，我想我们都可以通过这种方式解决问题。其次，他们的生日一点也不矛盾。生日悖论如此命名纯粹是因为它的反直觉性质；这只不过是冷酷的统计数字。</p><p id="43b7" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">生日问题(我们以后会更准确地提到它)指出，给定一个只有70个人的房间，有99.9%的可能性至少有两个人同一天生日。事实上，房间里的23个人将确保我们有比扔硬币更好的机会(&gt; 50%)在一年中的至少一天为不止一个人唱生日快乐歌。考虑到一年中至少有365个可能的生日，这听起来很奇怪。其实我们是不会相信的。我们会证明的。有证据。</p><p id="db49" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">瞧，命运安排得好，参赛国最多允许带23名运动员参加国际足球比赛。这对我们来说非常方便，因为我们刚刚声称，有(超过)50%的机会，一个满是23个人的房间会有至少一对人一起过生日。因此，如果我们看一些国际足球队，其中大约一半应该有球员一起切蛋糕。</p><p id="d6ff" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated"><em class="mj">但是，即使这是真的，也可能是偶然发生的——</em>我听到你说——<em class="mj">也许你只是运气好</em>。我欣赏你的怀疑精神。这就是为什么我们将使用贝叶斯推理来发现我们的结果有多么重要，并一劳永逸地撕掉隐喻性的史酷比小人面具。</p><h1 id="e856" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">为什么</h1><p id="9258" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">嗯，<em class="mj">为什么不是</em>。除非你预测办公室蛋糕费用，否则你很难找到与生日问题直接相关的业务。但是我们<em class="mj">将</em>从数据科学家的瑞士军刀技术中探索两个基本工具:</p><ul class=""><li id="d71d" class="mp mq it lp b lq mk lt ml lw mr ma ms me mt mi mu mv mw mx bi translated"><strong class="lp iu">网络搜集:</strong>我们将从网页上收集数据，以建立我们对足球运动员生日的了解。从客户参与到市场分析，抓取网页是许多真实数据科学用例的基本元素。</li><li id="80f1" class="mp mq it lp b lq my lt mz lw na ma nb me nc mi mu mv mw mx bi translated"><strong class="lp iu">数据操作:</strong>我们将使用Pandas从我们从网络收集的数据中提取相关信息。</li><li id="6581" class="mp mq it lp b lq my lt mz lw na ma nb me nc mi mu mv mw mx bi translated"><strong class="lp iu">统计评估:</strong>我们将使用贝叶斯因子来检验我们的假设。假设检验是任何自尊的数据科学家的面包和黄油，贝叶斯统计与机器学习和模型选择有很强的相关性。</li></ul><p id="bb9f" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">此外，我发现生日问题是一个有趣的问题，谁不喜欢一个好的证明呢？</p><h1 id="742f" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">什么</h1><p id="939b" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">让我们浏览一下我们的攻击计划和所需的概念。</p><h2 id="9f29" class="nd kw it bd kx ne nf dn lb ng nh dp lf lw ni nj lh ma nk nl lj me nm nn ll no bi translated">生日</h2><p id="6dcd" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">生日问题是怎么解决的？上面我们做了一些大胆的主张，那么我们来提供一个数学上的解释。为了更好地理解至少两个人同一天生日的概率，思考一下在任何群体中没有<em class="mj">或</em>个人同一天生日的概率是有帮助的:</p><p id="3eff" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">设想两个人在一个房间里，亚伦和比阿特丽斯。他们<em class="mj">不</em>同一天生日的概率有多大？Aaron <em class="mj"> </em>将在一年中的某一天过生日，Beatrice可以在一年中的任何一天过生日，因为他们不在同一天过生日。因此概率为<em class="mj"> 364/365 </em>。</p><p id="fd45" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated"><em class="mj">注意:在整个练习中，我将使用365天。我假设如果有人出生在闰日，他们的父母会仁慈地伪造他们的出生证明。</em></p><p id="c94c" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">如果有第三个人，塞西尔出现了呢？嗯，Aaron过生日，Beatrice过另一个生日，所以她还有363天可以选择。因此，她不和艾伦和塞西儿过同一天生日的概率是363/365。艾伦和比阿特丽斯不在同一天生日的概率是<em class="mj">364/365</em>×<em class="mj">363/365</em>。然后迪米特里出现了，留给他的是363/365的概率，如此等等…</p><p id="dc5e" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">因此，Aaron、Beatrice、Cecile和Dimitri中没有两个人同一天生日的概率是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi np"><img src="../Images/084338f920876e9947cf70781c73f7a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*A0Va_fvrEMblotQh-Il2sw.png"/></div></figure><p id="9cde" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">因为在我们的设置中有两种可能的结果，没有两个人过同一天生日<strong class="lp iu">或</strong>至少有两个人过同一天生日，所以这些结果的概率总和必须是1。因此，Aaron、Beatrice、Cecile和Dimitri中的至少一个生日相同的概率是:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/1a0f15c1ed21ac88468c172609d145a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*Gir_SYSq5BwOHZ5EUVA0rw.png"/></div></figure><p id="5327" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">如果我们把这个思考过程扩展到23个人(省去了我再想出19个字母名字的麻烦)，我们会得到:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/15b35a2b14c8a2c7bbf9a4cec4801f64.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*izWEr7247MARG9cxc9daLA.png"/></div></figure><p id="853d" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">给定一个满是23的房间，至少两个人共享一个生日的概率确实超过50%。但是我还是觉得不太对劲。别担心，我们会用数据证明这一点。</p><h2 id="ee29" class="nd kw it bd kx ne nf dn lb ng nh dp lf lw ni nj lh ma nk nl lj me nm nn ll no bi translated">足球运动员</h2><p id="08c8" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我们将使用哪些数据？我在上面提到过，每个国际足球队由23名球员组成。因此，我们将分析18/19 FIFA世界杯的球队，并收集他们每个球员的生日。</p><p id="0a97" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">我们将使用这些维基百科页面获得每个国家队的球员名单:</p><ul class=""><li id="facf" class="mp mq it lp b lq mk lt ml lw mr ma ms me mt mi mu mv mw mx bi translated"><a class="ae ku" href="https://en.wikipedia.org/wiki/2018_FIFA_World_Cup_squads" rel="noopener ugc nofollow" target="_blank"> FIFA 2018男足世界杯阵容</a></li><li id="bf59" class="mp mq it lp b lq my lt mz lw na ma nb me nc mi mu mv mw mx bi translated"><a class="ae ku" href="https://en.wikipedia.org/wiki/2019_FIFA_Women%27s_World_Cup_squads" rel="noopener ugc nofollow" target="_blank">国际足联2019女足世界杯阵容</a></li></ul><p id="4886" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">将这些组合起来，我们将得到56个组，这是一个不错的样本。</p><h2 id="22cb" class="nd kw it bd kx ne nf dn lb ng nh dp lf lw ni nj lh ma nk nl lj me nm nn ll no bi translated">悖论</h2><p id="a63a" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我们将如何证明帕拉…呃，T4问题？我们将分析56组23人的生日，并检查是否有任何匹配。拥有至少一对匹配生日的团队的百分比将是我们的实验结果，而理论值为50.73%。</p><p id="b3df" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">但是我们的结果有多可靠呢？如果你仔细考虑我们的问题，这实际上是<em class="mj">一系列的掷硬币——一个二元结果的实验(球队要么有同一天生日的球员，要么没有)，在这种情况下，我们可以很容易地测试我们结果的重要性。唯一的区别是，考虑到概率略高于50%，我们的硬币稍微偏向一边。</em></p><p id="fded" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">测试这一点的<em class="mj"> frequentist </em>方法将使用<em class="mj"> p值</em>。我们将建立一个无效假设，即生日匹配的概率确实是50.73%，即我们的硬币是<em class="mj">公平的</em>。然后，我们将计算生日相同的球队数量(即人头数)，并计算在给定样本的情况下获得该数字的概率。这将给出我们的<em class="mj"> p值</em>，如果低于预先确定的值(通常为1%-5%)，我们将拒绝我们的零假设，并说我们的理论是错误的，即我们的硬币是不公平的。</p><p id="d08a" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">然而，我们不仅仅是常客。我们将使用托马斯·贝叶斯对p值的回答，贝叶斯因子。它比较两个概率模型，帮助我们选择更合适的一个，定义为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/d819d3dae7e1102882e988fe461bf144.png" data-original-src="https://miro.medium.com/v2/resize:fit:298/format:webp/1*nk7o6PmfW3JELwYHKlaqBQ.png"/></div></figure><p id="76bb" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">用英语来说，就是得到我们的数据的可能性，<em class="mj"> D </em>，给定模型<em class="mj"> M1 </em>，除以得到数据的可能性<em class="mj"> D </em>给定模型<em class="mj"> M2 </em>。一般来说，至少5比1的比率(即&gt; 5的值)意味着对<em class="mj"> M1 </em>的实质性支持。</p><p id="1d50" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">贝叶斯因子优于p值的一个主要优点是它对样本大小的矛盾性。虽然我说过我们有一个不错的样本，有56个团队，但这并不完全是大数据。</p><p id="c651" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">我们将建立两个基本模型来描述给定实验结果的理论概率。我们的第一个模型，<em class="mj"> M1 </em>将是，概率正好是50.73%。因此，<em class="mj"> M1 </em>的概率密度在该点为∞，在其他地方为0。我们的第二个模型将非常天真，我们将假设我们根本不知道概率，它们都是同样可能的:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi nt"><img src="../Images/8317c43a3943f6cacb19c17742388eb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D_E-GRQwM97EyUWGEkjasA.png"/></div></div></figure><h1 id="403d" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">怎么做</h1><p id="c703" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">让我们做些重活。</p><h2 id="808a" class="nd kw it bd kx ne nf dn lb ng nh dp lf lw ni nj lh ma nk nl lj me nm nn ll no bi translated">网页抓取</h2><p id="16d0" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">维基百科页面在一个单独的表格中列出了每个国家队中的每个球员。我们希望建立一个数据框，每行都有一名球员，包括他们的出生日期和他们为哪个国家效力。这意味着我们需要从维基百科中获得:</p><ol class=""><li id="2ca4" class="mp mq it lp b lq mk lt ml lw mr ma ms me mt mi ny mv mw mx bi translated">民族</li><li id="0710" class="mp mq it lp b lq my lt mz lw na ma nb me nc mi ny mv mw mx bi translated">玩家姓名</li><li id="fea5" class="mp mq it lp b lq my lt mz lw na ma nb me nc mi ny mv mw mx bi translated">生日</li></ol><p id="a810" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">首先，让我们使用BeautifulSoup解析Wikipedia页面的HTML内容:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="acfc" class="nd kw it oa b gy oe of l og oh">import requests<br/>from bs4 import BeautifulSoup</span><span id="fd42" class="nd kw it oa b gy oi of l og oh">mens_wiki = requests.get('https://en.wikipedia.org/wiki/2018_FIFA_World_Cup_squads')</span><span id="5e90" class="nd kw it oa b gy oi of l og oh">mens_soup = BeautifulSoup(mens_wiki.content, 'html.parser')</span></pre><p id="4246" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">我们将从维基百科页面获取这些信息，并找出包含它们的HMTL元素标签/类，为搜集做准备:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/7a1677bce9f2dd4fba7196d9d13800dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*HWi_8biKv10K5JQtmlOvag.png"/></div><p class="kq kr gj gh gi ks kt bd b be z dk translated">维基百科页面上感兴趣的HTML元素</p></figure><p id="7771" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated"><strong class="lp iu">国家:</strong>表格按顺序列出，每个表格都以国家名称开头，这是一个h3 HTML元素，带有“mw-headline”类。比赛中有32个国家参赛，所以我们取页面上的前32个h3元素(后面有我们不想要的h3文本)。然后我们将使用<em class="mj"> np.repeat() </em>重复每个国家23次(每个玩家一次):</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="d846" class="nd kw it oa b gy oe of l og oh">h3 = mens_soup.find_all('h3')</span><span id="34c1" class="nd kw it oa b gy oi of l og oh">h3 = h3[:32]</span><span id="8280" class="nd kw it oa b gy oi of l og oh">mens_countries = []</span><span id="8d73" class="nd kw it oa b gy oi of l og oh">for h in h3:<br/>    mens_countries.append(h.find('span', class_='mw-headline').text)</span><span id="c954" class="nd kw it oa b gy oi of l og oh">mens_countries = np.repeat(mens_countries, 23)</span></pre><p id="d77d" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated"><strong class="lp iu">表格:</strong>每个国家都有单独的球员信息表格。他们的类是“sortable wiki table plainrow headers”，页面上没有这种类型的表，所以我们将它们全部收集起来:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="e360" class="nd kw it oa b gy oe of l og oh">tables = mens_soup.find_all("table", class_="sortable wikitable plainrowheaders")</span></pre><p id="6d75" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated"><strong class="lp iu"> Row: </strong>在每个表中，我们将遍历这些行来获取其中的数据。我们可以使用以下方式识别每个表中的行:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="9e12" class="nd kw it oa b gy oe of l og oh">rows = table.find_all('tr', class_='nat-fs-player')</span></pre><p id="5c4e" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated"><strong class="lp iu">姓名和出生日期:</strong>我们将找到每一行中的第二个链接，并获取与之相关的文本；我们还将从每一行中获取出生日期，这是一个带有类“bday”的span元素:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="72d6" class="nd kw it oa b gy oe of l og oh">player = row.find_all('a')[1].text</span><span id="5797" class="nd kw it oa b gy oi of l og oh">bday = row.find('span', class_='bday').text</span></pre><p id="8808" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">将所有这些整合到一个函数中，并对团队的数量进行参数化，以确保我们可以为女子团队(有24个团队，而不是32个团队)重复该过程:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="a53a" class="nd kw it oa b gy oe of l og oh">def get_football_bdays(main_url, n_teams):<br/>  '''<br/>  function to generate df of footballers and bdays<br/>  '''</span><span id="69ec" class="nd kw it oa b gy oi of l og oh">  # get main Wiki page<br/>  wiki = requests.get(main_url)<br/>  soup = BeautifulSoup(wiki.content)</span><span id="bbc5" class="nd kw it oa b gy oi of l og oh">  # get list of country names<br/>  h3 = soup.find_all('h3')<br/>  h3 = h3[:n_teams]<br/>  countries = []<br/>  for h in h3:<br/>    countries.append(h.find('span', class_='mw-headline').text)</span><span id="4564" class="nd kw it oa b gy oi of l og oh">  countries = np.repeat(countries, 23)</span><span id="66a0" class="nd kw it oa b gy oi of l og oh">  # get players and birthdays<br/>  players = []<br/>  player_links = []<br/>  bdays = []</span><span id="273c" class="nd kw it oa b gy oi of l og oh">  tables = soup.find_all("table", class_="sortable wikitable plainrowheaders")</span><span id="fdbd" class="nd kw it oa b gy oi of l og oh">  for table in tables:<br/>    table.find_all('th')</span><span id="c2fc" class="nd kw it oa b gy oi of l og oh">    rows = table.find_all('tr', class_='nat-fs-player')</span><span id="dd1d" class="nd kw it oa b gy oi of l og oh">    for row in rows:<br/>      players.append(row.find_all('a')[1].text)<br/>      bdays.append(row.find('span',  class_='bday').text)</span><span id="5aca" class="nd kw it oa b gy oi of l og oh">  df = pd.DataFrame(data={'Country': countries,<br/>                          'Player': players,<br/>                          'Date_of_Birth': bdays})</span><span id="998b" class="nd kw it oa b gy oi of l og oh">  return df</span></pre><p id="fa90" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">我们将应用于男子和女子队页面，并将结果数据框合并为一个:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="f2d1" class="nd kw it oa b gy oe of l og oh">df_men = get_football_bdays('https://en.wikipedia.org/wiki/2018_FIFA_World_Cup_squads', 32)</span><span id="c9f0" class="nd kw it oa b gy oi of l og oh">df_women = get_football_bdays('https://en.wikipedia.org/wiki/2019_FIFA_Women%27s_World_Cup_squads', 24)</span><span id="2206" class="nd kw it oa b gy oi of l og oh">df_men['Gender'] = 'Men'<br/>df_women['Gender'] = 'Women'<br/>df = df_men.append(df_women).reset_index(drop=True)</span></pre><p id="53cf" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">让我们来看看我们的数据:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/22818a687033545cca6b8aa303f8764f.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*UEh4iBmlnq-B3wPtQL2xkQ.png"/></div></figure><h2 id="9531" class="nd kw it bd kx ne nf dn lb ng nh dp lf lw ni nj lh ma nk nl lj me nm nn ll no bi translated">数据操作</h2><p id="6cc9" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">在这一部分，我们将找出至少有一对生日相同的团队。为此，我们将首先提取每个出生日期的月和日元素:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="701d" class="nd kw it oa b gy oe of l og oh">df['Date_of_Birth'] = df['Date_of_Birth'].apply(pd.to_datetime)</span><span id="7813" class="nd kw it oa b gy oi of l og oh">df['Birthday'] = df['Date_of_Birth'].map(lambda x: str(x.month) + '-' + str(x.day))</span></pre><p id="17db" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">然后，我们将创建一个列来指示生日是否在团队中重复(如果重复，则用1表示，否则用0表示):</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="0386" class="nd kw it oa b gy oe of l og oh">df['Duplicated'] = df.duplicated(['Gender', 'Country', 'Birthday']).astype(int)</span></pre><p id="8357" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">计算每个团队中的副本数量，并显示结果:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="6215" class="nd kw it oa b gy oe of l og oh">df_duplicates = df.groupby(['Gender', 'Country']).agg({'Duplicated':'sum'}).reset_index()<br/>df_duplicates = df_duplicates.sort_values('Duplicated', ascending=False)<br/>df_duplicates['Team'] = df_duplicates.apply(lambda x: x['Country'] + ' ' + x['Gender'], axis=1)</span><span id="6df5" class="nd kw it oa b gy oi of l og oh">g = sns.barplot(data=df_duplicates, x='Team', y='Duplicated', hue='Duplicated', dodge=False, palette=sns.color_palette("GnBu_d"))</span><span id="bdad" class="nd kw it oa b gy oi of l og oh">g.set_xticklabels(g.get_xticklabels(), rotation=90, fontsize=6)<br/>g.set_ylabel('Shared Birthdays')<br/>g.set_title('Number of shared birthdays in each team')<br/>g.legend_.remove()</span><span id="f4ed" class="nd kw it oa b gy oi of l og oh">fig = g.get_figure()<br/>fig.tight_layout()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi nt"><img src="../Images/9e4b61eaa8204f8f1f2da21f027d47ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zed4awGuWiQcl01yfizjpg.png"/></div></div></figure><p id="6856" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">波兰男队23名球员中有多达4对重复生日；葡萄牙男人有3个；摩洛哥男队和两支巴西队各得2分。更重要的是，56支队伍中有28支队伍有相同的生日，正好是一半。似乎很幸运！或者是？</p><h2 id="9461" class="nd kw it bd kx ne nf dn lb ng nh dp lf lw ni nj lh ma nk nl lj me nm nn ll no bi translated">统计计算</h2><p id="2bb7" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我们已经掷了56次硬币，假设50.73%的时间硬币落在头上，但有一半的时间硬币落在头上。我们的硬币公平吗，即我们50.73%概率的模型正确吗？</p><p id="c8ce" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">给定50.73%的理论概率，获得28个生日匹配的团队的可能性由二项式概率质量函数给出:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/fb07836c2df412537517b72d70fc9411.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*wJREI6HDFTglvn8ihAd5JQ.png"/></div></figure><p id="1fdf" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">其中<em class="mj"> n </em>是试验次数，<em class="mj"> k </em>是成功次数，<em class="mj"> p </em>是我们的理论概率。我们会用Python找到确切的可能性。</p><p id="412a" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">首先，我们计算得到至少一对与23个人生日匹配的精确理论概率:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="264e" class="nd kw it oa b gy oe of l og oh">mltp = 1</span><span id="16cd" class="nd kw it oa b gy oi of l og oh">for i in range(343, 366):<br/>  mltp*=i</span><span id="74c5" class="nd kw it oa b gy oi of l og oh">p = 1 - mltp*((1/365)**23)</span></pre><p id="ac1d" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">得出<em class="mj"> 0.5072972343239852 </em>。我们的<em class="mj"> k </em>和<em class="mj"> n </em>简单来说就是生日匹配的队伍数量和队伍总数，分别是:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="eab5" class="nd kw it oa b gy oe of l og oh">k = len(df_duplicates[df_duplicates['Duplicated']&gt;0].index)<br/># 28</span><span id="076a" class="nd kw it oa b gy oi of l og oh">n = len(df_duplicates.index)<br/># 56</span></pre><p id="9b55" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">我们将使用Scipy中的<em class="mj"> binom() </em>函数来计算可能性:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="a935" class="nd kw it oa b gy oe of l og oh">from scipy.stats import binom</span><span id="c843" class="nd kw it oa b gy oi of l og oh">p_M1 = binom.pmf(k, n, p)</span></pre><p id="2853" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">以上(结果为<em class="mj"> 0.10551566641902223 </em>)是在56支队伍中找到28支生日相匹配的队伍的可能性，给定我们不久前的模型<em class="mj"> M1 </em>:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/098ce16357aa42cc085508afbc1900ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:516/format:webp/1*CDJ4HFODHVMZxV0_JlRQXg.png"/></div></figure><p id="e8ae" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">我们的另一种先验信念是，所有的概率都是同等可能的——也就是说，我们不知道概率。这可以用贝塔函数参数<em class="mj"> α = 1，β = 1 </em>的贝塔二项式先验分布来建模。贝塔二项式概率质量函数为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi on"><img src="../Images/563c013f3a85f691ea7d4ba754a32b0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*geHZ3yoOzWqL3MULj6QoCQ.png"/></div></figure><p id="7138" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">其中B()是β函数，参数如上所述。幸运的是，SciPy对此也有一句俏皮话:</p><pre class="kj kk kl km gt nz oa ob oc aw od bi"><span id="417a" class="nd kw it oa b gy oe of l og oh">from scipy.stats import betabinom</span><span id="b118" class="nd kw it oa b gy oi of l og oh">p_M2 = betabinom.pmf(k, n, 1, 1)</span></pre><p id="fe57" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">上面是给定一个均匀的概率密度先验，得到28个生日匹配的球队的可能性。这表现为:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/47c704e2e92c2d556ef98f34f474cb69.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*U2C5cJkLbY0zAeJYFh0I-w.png"/></div></figure><p id="9046" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">我们记得贝叶斯因子是两种可能性的比率:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi op"><img src="../Images/35c2ae5192e65cfc340b6fa51daa3e67.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*nz33zG4zU_q8CT8HohTU8A.png"/></div></figure><p id="e252" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">超过5的K 值指向<em class="mj"> M1 </em>的“实质性”证据，支持我们的假设，即我们的结果用50.73%的概率描述要比随机描述好得多。</p><h1 id="641e" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">外卖</h1><p id="e3d1" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">那么我们从这一切中学到了什么呢？</p><ul class=""><li id="e92c" class="mp mq it lp b lq mk lt ml lw mr ma ms me mt mi mu mv mw mx bi translated">我们已经详细探讨了生日问题，并从数学上表明，在23人的小组中，两个人更有可能过同一天生日。</li><li id="9395" class="mp mq it lp b lq my lt mz lw na ma nb me nc mi mu mv mw mx bi translated">我们通过分析2018/19年世界杯每队23名球员的生日来寻找支持这一观点的证据，通过使用<strong class="lp iu">自定义网页抓取功能</strong>抓取两个维基百科页面来收集必要的数据。</li><li id="fdd2" class="mp mq it lp b lq my lt mz lw na ma nb me nc mi mu mv mw mx bi translated">我们发现56支参赛队伍中有一半的队员是同一天生日的；有些甚至超过两对。</li><li id="d8e7" class="mp mq it lp b lq my lt mz lw na ma nb me nc mi mu mv mw mx bi translated">给定我们收集的数据，我们使用<strong class="lp iu"> Bayes因子</strong>来测试两个先验假设:使用二项式概率质量函数计算的概率是精确的；或者，使用β-二项式概率质量函数，所有概率都是同等可能的(即<em class="mj">我们不知道</em>)。</li><li id="3746" class="mp mq it lp b lq my lt mz lw na ma nb me nc mi mu mv mw mx bi translated">我们为前一个模型找到了<strong class="lp iu">的实质性证据</strong>，证明了生日问题(以及引申开来的<em class="mj">数学</em>)是正确的。</li></ul><p id="96fc" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">引人入胜的东西，如果我可以这么说。</p><h1 id="6a6b" class="kv kw it bd kx ky kz la lb lc ld le lf jz lg ka lh kc li kd lj kf lk kg ll lm bi translated">事后思考</h1><p id="f618" class="pw-post-body-paragraph ln lo it lp b lq lr ju ls lt lu jx lv lw lx ly lz ma mb mc md me mf mg mh mi im bi translated">我做错什么了吗？我能做得更好吗？我做得好吗？</p><p id="b0b0" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">请随时在<a class="ae ku" href="https://www.linkedin.com/in/marcell-ferencz-9892a3a6" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我；如果你对我的工作感兴趣，我总是很乐意接受挑战或者只是聊聊天。</p><p id="5bfe" class="pw-post-body-paragraph ln lo it lp b lq mk ju ls lt ml jx lv lw mm ly lz ma mn mc md me mo mg mh mi im bi translated">如果你想自己玩代码，请点击我的Google Colab笔记本的链接:</p><div class="oq or gp gr os ot"><a href="https://colab.research.google.com/drive/1BfeeVJbHqets02tTNwIiEeWpQ7xtX163" rel="noopener  ugc nofollow" target="_blank"><div class="ou ab fo"><div class="ov ab ow cl cj ox"><h2 class="bd iu gy z fp oy fr fs oz fu fw is bi translated">谷歌联合实验室</h2><div class="pa l"><h3 class="bd b gy z fp oy fr fs oz fu fw dk translated">编辑描述</h3></div><div class="pb l"><p class="bd b dl z fp oy fr fs oz fu fw dk translated">colab.research.google.com</p></div></div><div class="pc l"><div class="pd l pe pf pg pc ph ko ot"/></div></div></a></div></div></div>    
</body>
</html>