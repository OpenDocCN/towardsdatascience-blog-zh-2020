# 实践几乎所有 SQL 概念的 10 大问题

> 原文：<https://towardsdatascience.com/10-problems-to-practice-almost-all-sql-concepts-37545e7c5219?source=collection_archive---------2----------------------->

## 涵盖连接、聚合、窗口函数和子查询的所有 SQL 概念

![](img/06562d0aa84554c579ef7eb0257bd8a6.png)

图片由 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 上的 [Alexandru Acea](https://unsplash.com/@alexacea?utm_source=medium&utm_medium=referral) 拍摄

# 介绍

我最近在 Leetcode 上用 25 天的时间完成了所有 117 个 SQL 问题，leet code 可能是最受欢迎的练习各种编程语言编码技能的网站之一。该网站将所有问题漂亮地分为三类，即简单、中等和困难，其中难度随着每个后续级别的提高而大幅提高。完成所有这些问题后，我决定突出 10 个问题，它们几乎涵盖了从基础到高级 SQL 的所有概念，您可以通过练习来提高 SQL 编程技能。此外，几乎所有大型科技公司都在面试中问过这些问题。

## 以下是每个问题中测试的 SQL 技能的明细:

*   **Q1 平均工资:** CTE **，**聚集在窗口函数中，CASE WHEN，DATE_PART、INNER JOIN 等日期函数
*   **Q2 在结果中找到安静的学生—** 子查询，最小值，最大值，窗口函数，窗口别名，内部连接，所有关键字
*   **Q3 体育场人流量—** 左连接子查询，CTE，行号
*   **Q4 每次访问的事务数量—** 递归 CTE、联合、计数
*   **Q5 报告连续日期(MySQL)——**日期子，行数
*   **Q6 按周销售—** 数据透视表，CASE WHEN
*   **Q7 部门前 3 名薪资—** DENSE_RANK
*   **Q8 餐厅增长—** 移动平均线前置，偏置
*   **Q9 平面内最短距离—** 交叉连接、SQRT、POW
*   **Q10 连续数字—** 滞后，超前

所以，我们言归正传吧！

1.  ***给定下面两张表，写一个查询，显示某部门员工平均工资与公司平均工资的比较结果(高/低/相同)。***

***方案一:***

**2*。*** ***写一个 SQL 查询，报告学生(student_id，student_name)在所有考试中“安静”的情况。“相当”的学生是指至少参加了一次考试，既没有高分也没有低分的学生。***

***方案二*** :

***3。编写一个查询来显示连续 3 行或
多行且人数超过 100(含)的记录。***

***方案三:***

***4。编写一个 SQL 查询来查找有多少用户访问了银行但没有进行任何交易，有多少用户访问了银行并进行一次交易等等。***

***方案四:***

***5。编写 SQL 查询，为 2019 年 1 月 1 日至 2019 年 12 月 31 日期间的每个连续天数间隔生成 period_state 报告。***

***方案五:***

**6*6。编写一个 SQL 查询来报告一周中每天每个类别中订购了多少台。***

***方案六:***

**7*。编写一个 SQL 查询来查找每个部门中工资最高的三名员工。对于上面的表，您的 SQL 查询应该返回下面的行(行的顺序无关紧要)。***

***解决方案 7:***

***8。编写一个 SQL 查询来计算 7 天内(当天+ 6 天前)客户支付金额的移动平均值。***

***解决方案 8:***

**9*。编写一个查询，找出这些点之间的最短距离，四舍五入到 2 位小数。***

***解决方案 9:***

**10*。编写一个 SQL 查询来查找至少连续出现三次的所有数字。***

***方案 10:***

这是一个总结！我希望您喜欢这些问题，并且能够实践一些最重要的 SQL 概念。如果你想练习更多像这样的问题，请随时到我的[**Github**](https://github.com/mrinal1704/SQL-Leetcode-Challenge)*页面，我已经上传了所有 117 个解决方案。*

# *谢谢大家！*

*如果你喜欢我的作品，请在不久的将来跟随我在媒体上阅读更多的文章。*

*   *阅读我关于[特征工程](/the-art-of-engineering-features-for-a-strong-machine-learning-model-a47a876e654c) & [自动化基础数据分析](/learn-how-to-automate-the-basic-steps-of-data-analysis-45e118048172)的其他文章。*
*   *很乐意在 LinkedIn 上与您联系。*