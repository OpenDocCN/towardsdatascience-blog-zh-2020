<html>
<head>
<title>.NET Core API for the Angular Tour of Heroes App — Introduction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">。英雄角游 App 的 NET 核心 API 简介</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/net-core-api-for-the-angular-tour-of-heroes-app-5895a36d2129?source=collection_archive---------27-----------------------#2020-03-15">https://towardsdatascience.com/net-core-api-for-the-angular-tour-of-heroes-app-5895a36d2129?source=collection_archive---------27-----------------------#2020-03-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9f8c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">从本地开发到云部署的史诗之旅！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/c9ab11ab5cc9a3d21a6f232d03223541.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hFeL0qh18C8wg2cS20JGPg.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">亚历克斯·阿扎巴赫在<a class="ae ky" href="https://unsplash.com/s/photos/bridge?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="9852" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">继续之前:</h1><p id="6c03" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">本文假设你已经搭建了 Angular 官方教程——英雄之旅 app。如果你还没有建立这个，你应该检查从这里下载的<a class="ae ky" href="https://angular.io/tutorial" rel="noopener ugc nofollow" target="_blank">角度文件</a>或<a class="ae ky" href="https://angular.io/generated/zips/toh-pt6/toh-pt6.zip" rel="noopener ugc nofollow" target="_blank">。</a>其他一切都将在本系列文章中处理！</p><h1 id="f9fc" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">我们将完成什么</h1><p id="ba8e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这个系列中，我们将开始一次神奇的探索。NET Core，Angular，Docker，Azure，Azure SQL Server。</p><p id="c54f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将熟悉一些技术，比如 Docker 容器、C#、JavaScript、SQL 和 Azure 命令行界面。</p><p id="dadf" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这些文章的最终结果将是一个带有. NET 核心 API 的前端，它与 Azure SQL server 对话，所有这些都托管在 Azure 上。</p><h1 id="54ae" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">系列大纲</h1><ol class=""><li id="2a30" class="ms mt it lt b lu lv lx ly ma mu me mv mi mw mm mx my mz na bi translated">这篇文章 MVC 的环境设置和解释。</li><li id="a29d" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://medium.com/@richardpeterson320/build-a-mssql-docker-container-800166ecca21" rel="noopener">微软 SQL 服务器(mssql)的本地 Docker 设置。</a></li><li id="f663" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/net-core-api-dive-into-c-27dcd4170066">建造。NET API。</a></li><li id="5d5b" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/deploy-a-net-api-to-azure-84ea79d42d1a">将您的 API 部署到 Azure。</a></li><li id="a8b8" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://medium.com/swlh/deploy-an-angular-app-to-azure-955f0c750686" rel="noopener">将您的 Angular 应用程序部署到 Azure。</a></li></ol><h1 id="e614" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">开始所需的工具</h1><ol class=""><li id="6d68" class="ms mt it lt b lu lv lx ly ma mu me mv mi mw mm mx my mz na bi translated">Visual Studio 代码<a class="ae ky" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank">(是免费的)</a></li><li id="72d9" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">Angular CLI <a class="ae ky" href="https://angular.io/guide/setup-local" rel="noopener ugc nofollow" target="_blank">(应该已经从英雄之旅教程中设置好了)</a></li><li id="128d" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">。NET Core — <a class="ae ky" href="https://dotnet.microsoft.com/download/dotnet-core/3.0" rel="noopener ugc nofollow" target="_blank">该 API 将使用版本 3.0.2 </a></li><li id="b1f3" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">邮递员— <a class="ae ky" href="https://www.postman.com/downloads/" rel="noopener ugc nofollow" target="_blank">用于测试 API </a></li><li id="1b35" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">Docker — <a class="ae ky" href="https://www.docker.com/products/docker-desktop" rel="noopener ugc nofollow" target="_blank">用于本地开发数据库，以及封装我们的应用</a></li></ol><p id="ff5b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">使用我的 GitHub repo 跟进。</p><h1 id="3af7" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">我们开始吧！</h1><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/429f2c7195137d7b742b315a52aaea1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N-E8hoiDTdO5xdI0F6Jjtw.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">安德里亚·莱奥帕尔迪在<a class="ae ky" href="https://unsplash.com/s/photos/running-mountain?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><h1 id="7971" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">测试 Angular 应用</h1><p id="0ac1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先，从应用程序的根目录运行<code class="fe nh ni nj nk b">ng serve --open</code>，启动英雄之旅 Angular 应用程序。您应该看到应用程序运行在端口 4200 上。</p><p id="b9f4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">当你创建最初的应用程序时，它有一个内置的网络服务器<a class="ae ky" href="https://angular.io/tutorial/toh-pt6'" rel="noopener ugc nofollow" target="_blank">来模拟真实的服务器。我们将用 C#编写的 web API 替换这个人工服务器。NET 框架。让我们关闭应用程序，开始使用 API。</a></p><h1 id="1682" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">使用创建一个 web API。网络核心 CLI</h1><p id="cd3e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">确保。运行<code class="fe nh ni nj nk b">dotnet --version</code>安装 NET Core CLI。的。NET Core CLI 有许多模板可供选择。用<code class="fe nh ni nj nk b">dotnet new -h</code>检查这些选项标志。你看到 ASP.NET 核心 Web API 的模板了吗？它的简称是 webapi。通过运行以下命令从命令行创建 API:</p><pre class="kj kk kl km gt nl nk nm nn aw no bi"><span id="f7e5" class="np la it nk b gy nq nr l ns nt">dotnet new webapi -n Heroes.API</span></pre><p id="a054" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你应该会得到一个<code class="fe nh ni nj nk b">Restore succeeded</code>的结果。输入<code class="fe nh ni nj nk b">cd Heroes.API</code>进入新目录。检查<code class="fe nh ni nj nk b">ls</code>以查看已经创建的文件夹和文件，并通过键入(带句点)<code class="fe nh ni nj nk b">code .</code>启动该目录中的 VS 代码。</p><p id="b77f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们通过运行<code class="fe nh ni nj nk b">dotnet run</code>来确保 API 启动。在 web 浏览器中，导航到<a class="ae ky" href="https://localhost:5001/weatherforecast" rel="noopener ugc nofollow" target="_blank">https://localhost:5001/weather forecast</a>并接受不安全的目的地，以查看您的 API 以 JSON 格式返回的示例输出。这很好，因为它让你知道。NET 核心 API 通过使用模型和控制器来工作。我们将创建自己的<strong class="lt iu">模型</strong>和<strong class="lt iu">控制器</strong>，还将添加一个数据库<strong class="lt iu">上下文</strong>。</p><h1 id="c811" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">模型-视图-控制器</h1><p id="6d07" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">MVC 是一种 web 开发理念，它建议将应用程序的各个部分分离成逻辑组件。这使得你可以单独构建每一个部分，并确认其工作正常，然后将你的部分连接成一个完整的整体。来自 FreeCodeCamp.org 的这篇文章很好地解释了 MVC 就像在酒吧里点一杯酒。饮料菜单就是视图，你向调酒师(控制器)提出请求，调酒师根据配料和说明(模型)制作饮料，并把你完成的饮料返回给吧台(视图)。</p><p id="6815" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我们的应用程序中，这意味着:</p><ol class=""><li id="204c" class="ms mt it lt b lu mn lx mo ma nu me nv mi nw mm mx my mz na bi translated"><strong class="lt iu"> <em class="nx">视图</em></strong>:Angular app 会接收输入，发出请求，显示数据。</li><li id="c295" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> <em class="nx">控制器:</em> </strong> C#类，接受传入的请求，解密请求的路由，并根据接收到的路由使用指定的模型与数据库进行交互。</li><li id="fedf" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu"> <em class="nx"> MODEL: </em> </strong> C#类，定义传递给数据库或从数据库中检索的数据。这将意味着定义像 id 是一个整数，name 是一个字符串这样的东西，这样 C#就可以用 SQL 可以解释的方式传递这些值。数据库上下文对模型很重要</li></ol><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/f552e4d8a7ec62173b0e237b26f91af1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MjAeauRC4ZNMJAQ1PAqHmA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">由作者创建</p></figure><p id="a461" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">微软已经发布了关于。NET Core，我强烈推荐查看:</p><ol class=""><li id="1081" class="ms mt it lt b lu mn lx mo ma nu me nv mi nw mm mx my mz na bi translated"><a class="ae ky" href="https://docs.microsoft.com/en-us/aspnet/core/tutorials/first-web-api?view=aspnetcore-3.1&amp;tabs=visual-studio-code" rel="noopener ugc nofollow" target="_blank">教程:用 ASP.NET 核心创建一个 web API。</a></li><li id="38cc" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://docs.microsoft.com/en-us/aspnet/core/tutorials/first-mvc-app/?view=aspnetcore-3.1" rel="noopener ugc nofollow" target="_blank">用 ASP.NET 核心 MVC 创建一个 web 应用</a></li></ol><h1 id="fa7c" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">下一步:数据库</h1><p id="1e6d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">此时，您应该有两个资源:</p><ol class=""><li id="57de" class="ms mt it lt b lu mn lx mo ma nu me nv mi nw mm mx my mz na bi translated">一个工作角度的英雄之旅应用程序。</li><li id="fe9f" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">一个仿制药。NET 核心 API。</li></ol><p id="af3b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们需要创建一个可以处理来自 API 控制器的请求的数据库。我们最终将迁移到托管的 Azure SQL 数据库，但现在，让我们启动一个 Microsoft SQL 服务器的本地 Docker 容器。这个容器是 SQL Server 的一个轻量级版本，我们可以轻松地进行开发。</p><p id="17eb" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">前往<a class="ae ky" href="https://medium.com/@richardpeterson320/build-a-mssql-docker-container-800166ecca21" rel="noopener">构建一个 MSSQL Docker 容器</a>来设置数据库！</p><h1 id="fde3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">构建一个. NET API 来处理来自 Angular 的请求</h1><p id="cee8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">打造你的。NET API，在 aspnet-codegenerator 的帮助下。该应用程序将处理对这些路线的 API 请求:</p><ol class=""><li id="2896" class="ms mt it lt b lu mn lx mo ma nu me nv mi nw mm mx my mz na bi translated"><em class="nx"> GET: api/Heroes — </em>该方法将返回数据库中的所有英雄</li><li id="7de2" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><em class="nx"> GET: api/Heroes/5 — </em>这个方法将从数据库中返回一个特定的英雄。在这种情况下，它将返回 Id 为 5 的英雄。</li><li id="a62b" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><em class="nx"> PUT: api/Heroes/5 — </em>这个方法会更新一个特定英雄的信息。</li><li id="7818" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><em class="nx"> POST: api/Heroes — </em>这个方法将向数据库发布一个新的英雄。</li><li id="d3a6" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><em class="nx"> DELETE: api/Heroes/5 — </em>这个方法将从数据库中删除一个特定的英雄。</li></ol><p id="e229" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在本文结束时，您将拥有 Angular 应用程序的本地版本。NET API 和数据库。</p><h1 id="2d38" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">云部署</h1><p id="e85c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">最后，您将<a class="ae ky" rel="noopener" target="_blank" href="/deploy-a-net-api-to-azure-84ea79d42d1a">创建一个 Azure SQL server 并部署您的。NET API </a>到 Azure 远程 git repo，并与 web 应用一起提供服务。</p><p id="b1ec" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">然后你将<a class="ae ky" href="https://medium.com/swlh/deploy-an-angular-app-to-azure-955f0c750686" rel="noopener">把你的 angular 应用</a>作为 Docker 容器 web 应用部署到 Azure。</p><p id="8c24" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">感谢您的阅读！</p></div></div>    
</body>
</html>