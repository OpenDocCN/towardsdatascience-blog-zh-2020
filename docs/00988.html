<html>
<head>
<title>Political Data Science: A tale of tweets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">政治数据科学:推特的故事</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/political-data-science-a-tale-of-tweets-75b762224e56?source=collection_archive---------31-----------------------#2020-01-28">https://towardsdatascience.com/political-data-science-a-tale-of-tweets-75b762224e56?source=collection_archive---------31-----------------------#2020-01-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="a263" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">分析对新苏格兰独立公投的情绪</h2></div><p id="5c73" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">关键词:Twitter，tweepy，Bayes 情操论，nltk，scikit learn，keras，机器学习，深度学习，LSTM，RNN，SVM，朴素贝叶斯，geoplot，geopy，nominatim，folium，pygeocoder。</em></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/fadc019168a701967b2bd08f689279e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h1qPEC8vDhkFwHdGWVTd6A.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">推特上的文字云</p></figure><p id="7a75" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们都很熟悉数据驱动的政治竞选在选民中的巨大力量。我们只要看看 2016 年美国总统大选，希拉里·克林顿和唐纳德·特朗普针锋相对，最终彻底改变了美国政治家赢得选举的方式。</p><p id="f0c6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">他们的竞选活动没有使用传统策略，而是利用数据，这些数据赋予了他们微观锁定选民的能力。耶鲁大学教授艾坦·赫什(Eitan Hersh)在他的著作《黑掉选民<a class="ae lv" href="https://www.cambridge.org/core/books/hacking-the-electorate/C0D269F47449B042767A51EC512DD82E" rel="noopener ugc nofollow" target="_blank"><em class="le"/></a><em class="le"/>中总结道，如果你有足够的数据，你就可以预测人们会如何表现，甚至他们会如何投票。竞选团队已经发展出复杂的方式来做到这一点。</p><p id="f1a0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">尽管选民最终会支持与他们的优先事项最相符的政治家或想法，但重要的是要知道数据给了我们发现这些优先事项是什么的方法。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lw"><img src="../Images/73512bef0648f64f1261a719406a76ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0YCmwOr-sh2cuRK5"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">照片由<a class="ae lv" href="https://unsplash.com/@element5digital?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">元素 5 数码</a>在<a class="ae lv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><p id="3f7a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在英国，事情进行得并不容易，英国退出欧盟的支持者从川普的竞选中吸取了很多经验教训并加以利用。快进到 2020 年，英国退出欧盟的主要人物鲍里斯·约翰逊现在是分裂的“联合”王国新当选的保守党首相。</p><p id="6271" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">英国退出欧盟投票后，以及最近鲍里斯·约翰逊在 2019 年冬季大选中获胜后，苏格兰当前的政治局势非常激烈。</p><p id="1c51" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">苏格兰选民在 2014 年 9 月的公投中首次被问及是否希望苏格兰成为独立国家；结果是 55%对 45%反对独立。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/4db28d5e04f26b702d11eb2573ec549d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GrAGxJszEh7RchKSDQ6zCw.jpeg"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">FT 蒙太奇/Getty/PA</p></figure><p id="c660" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">苏格兰民族党(SNP)2019 年大选宣言称，该党打算在 2020 年举行第二次公投；他们赢得了苏格兰在英国下议院 59 个席位中的 48 席。因此，很自然地，首席部长尼古拉·斯特金现在声称<em class="le"/><em class="le">苏格兰大多数人期望的未来与英国其他大部分人喜欢的非常明显不同。本月早些时候，她正式要求在 2020 年底前举行独立公投，但不久后被鲍里斯·约翰逊(Boris Johnson)否认。</em></p><p id="b470" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所有这些在鲍里斯约翰逊(Boris Johnson)领导下的英国制造了一个复杂的环境，这个国家似乎处于非常困难(也不是非常有利)的境地。</p><h1 id="d59d" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">内容</h1><ol class=""><li id="a28f" class="mq mr it kk b kl ms ko mt kr mu kv mv kz mw ld mx my mz na bi translated"><a class="ae lv" href="#2d05" rel="noopener ugc nofollow">提问</a></li><li id="3b8e" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld mx my mz na bi translated"><a class="ae lv" href="#428b" rel="noopener ugc nofollow">为什么是推特？</a></li><li id="c550" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld mx my mz na bi translated"><a class="ae lv" href="#f1f4" rel="noopener ugc nofollow"> ETL:提取、加载、转换</a></li><li id="dd36" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld mx my mz na bi translated"><a class="ae lv" href="#ea26" rel="noopener ugc nofollow">特色工程</a></li><li id="3429" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld mx my mz na bi translated"><a class="ae lv" href="#9617" rel="noopener ugc nofollow">模型定义和训练</a></li><li id="71d7" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld mx my mz na bi translated"><a class="ae lv" href="#d886" rel="noopener ugc nofollow">模型评估</a></li><li id="61c1" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld mx my mz na bi translated"><a class="ae lv" href="#e55e" rel="noopener ugc nofollow">未知建模:公投推特数据。</a></li><li id="9d0d" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld mx my mz na bi translated"><a class="ae lv" href="#1b98" rel="noopener ugc nofollow">地理空间分析</a></li><li id="db22" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld mx my mz na bi translated"><a class="ae lv" href="#d2b0" rel="noopener ugc nofollow">结论</a></li></ol><h1 id="f007" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated"><strong class="ak">提问</strong></h1><p id="2d05" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">鉴于这种情况，我想知道我们是否能了解苏格兰人民在这个动荡时期的反应。尤其是在鲍里斯·约翰逊(Boris Johnson)获胜并拒绝允许苏格兰人再次公投之后。</p><p id="c1d3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以我的问题是:</p><blockquote class="nj"><p id="7611" class="nk nl it bd nm nn no np nq nr ns ld dk translated">英国人民如何应对当前关于苏格兰独立公投的政治气候？鲍里斯·约翰逊拒绝允许吗？</p><p id="d28e" class="nk nl it bd nm nn no np nq nr ns ld dk translated">苏格兰、英格兰、威尔士和北爱尔兰人的反应有何不同？对苏格兰特别感兴趣。</p></blockquote><p id="d236" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">于是，我用关键词<em class="le">“indyref 2”</em><em class="le">“苏格兰独立”</em><em class="le">“scot ref”</em>下载了 2020 年 1 月 8 日至 1 月 15 日一周的推文。我收集数据和分析情绪的过程可以在任何 twitter 账户或媒体页面上重复。</p><p id="14bc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用<a class="ae lv" rel="noopener" target="_blank" href="/sentiment-analysis-concept-analysis-and-applications-6c94d6f58c17"> <strong class="kk iu">情感分析</strong> </a>(也称为意见挖掘)，一个<strong class="kk iu">自然语言处理</strong>子领域，我把推特作为苏格兰独立的一种政治晴雨表。我训练了两个有监督的机器学习模型:<strong class="kk iu">支持向量机</strong> (SVM)和<strong class="kk iu">朴素贝叶斯分类器</strong>。然后，我与一个被称为长短期记忆(LSTM)网络的<strong class="kk iu">深度学习递归神经网络</strong> (RNN)进行了系统的比较。在对模型进行评估后，我选择并使用 LSTM 模型来预测 twitter 数据集中的情绪。</p><p id="a4ee" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以在<a class="ae lv" href="https://github.com/gracecarrillo/Political-Data-Science" rel="noopener ugc nofollow" target="_blank"> Github 库</a>中查看完整的项目及其技术细节。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ny"><img src="../Images/c51e336a2e4f01f9ea349c9e285c5c88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*snOgjBJqL4M8P9qE"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">乔治·帕甘三世在<a class="ae lv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><h1 id="428b" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">为什么是 twitter？</h1><p id="58d7" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">我选择关注 Twitter 是因为它——以及一般的社交媒体——正日益成为日常生活的一部分，这在政治领域也是如此。此外，情感分析项目主要使用 Twitter 数据，因为这些数据(几乎)是公开的，而从脸书收集任何有用的数据(几乎)是不可能的。</p><h1 id="f1f4" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">ETL:提取、加载、转换</h1><p id="95a9" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated"><strong class="kk iu">训练数据</strong>是从<a class="ae lv" href="http://help.sentiment140.com/" rel="noopener ugc nofollow" target="_blank">感知 140 </a>中获得的，由大约 160 万条随机推文组成，相应的二进制标签“0”表示负面情绪，“4”表示正面情绪。原始数据集由 80k 条标注为正面的推文和 80k 条标注为负面的推文组成。推文真多。所以我从更大的训练数据集中抽取了一个样本，以避免长时间的等待。最后，我用 25160 条标注为负面的推文和 24840 条标注为正面的推文进行训练。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/8201f7fd463ac6ba7a1889f427d3bd3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*68rx0Vep2h-pUQPmSwPikg.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">按字数统计的训练数据集中正面和负面推文的分布。</p></figure><p id="caed" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个非常平衡的训练数据集，如上图直方图所示。</p><p id="b015" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在任何自然语言处理任务中，清理原始文本数据都是重要的一步。它有助于去掉不需要的单词和字符，从而有助于获得更好的特征。对于这一步，我使用了一个类似于<strong class="kk iu">管道的预处理</strong>步骤，使用一些辅助函数来去除 tweets 中不需要的噪声:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="oa ob l"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><a class="ae lv" href="https://gist.github.com/gracecarrillo/53ab0c64121514abe02a74e483fd29ce#file-preprocessing-pipeline" rel="noopener ugc nofollow" target="_blank">预处理流水线</a></p></figure><p id="55b9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">经过这一步，你可以非常清楚地看到原始推文和干净推文之间的差异。只有推文中的重要单词被保留，噪音(数字、标点符号和特殊字符)被删除。</p><p id="6012" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于<strong class="kk iu">测试数据，</strong>我使用 twitter 的 API 下载了数据集，并用它来测试模型的真实性能。我使用了<code class="fe oc od oe of b">tweepy</code>,这是 Twitter API 的一个 python 包装器库，可以让你更好地控制如何查询它。为了获得测试数据集的大量数据，我通过 API 搜索函数使用关键字<code class="fe oc od oe of b">'indyref2'</code>、<code class="fe oc od oe of b">'scottish independence'</code>和<code class="fe oc od oe of b">'scotref'</code>下载了数据。不过 Twitter 的 REST API 在其免费版本中有一个限制。它搜索过去 7 天内发布的推文样本。所以我只能收集到 636 条推文的样本。尽管如此，我还是从他们身上提取了一些有趣的信息。</p><p id="f1c3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要了解这一部分的详细步骤，请查看我的 Github 中的<a class="ae lv" href="http://ETL_Sentiment_Analysis_Scotref2.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本。</a></p><h1 id="ea26" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">特征工程</h1><p id="6146" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">为了分析预处理过的数据，需要将其转换成特征。根据使用情况，可以使用各种技术构建文本特征，如<a class="ae lv" href="https://machinelearningmastery.com/gentle-introduction-bag-words-model/" rel="noopener ugc nofollow" target="_blank">单词包</a>(BoG)<a class="ae lv" href="https://machinelearningmastery.com/gentle-introduction-bag-words-model/" rel="noopener ugc nofollow" target="_blank">TF-IDF</a>和<a class="ae lv" href="https://machinelearningmastery.com/what-are-word-embeddings/" rel="noopener ugc nofollow" target="_blank">单词嵌入</a>。</p><p id="c8d9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了使项目简单，我去找了一大堆单词。但是，一种基本的方法无法捕捉到像<em class="le">“我喜欢你”</em>这样的短语之间的差异，其中<em class="le">“喜欢”</em>是一个带有积极情绪的动词，而<em class="le">“我喜欢你”</em>，其中<em class="le">“喜欢”</em>是一个表达不同情绪的介词。</p><p id="990d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了改进这项技术，我使用<strong class="kk iu">维达的极性分数</strong>和<strong class="kk iu">词性(POS)标签提取特征。</strong></p><p id="caaf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae lv" href="https://github.com/cjhutto/vaderSentiment" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">维达情绪分析工具</strong> </a> <strong class="kk iu"> </strong>产生四个情绪指标。前三个，积极的，中性的和消极的，这是不言自明的。最后一个指标，复合得分，是所有词汇等级的总和，然后标准化为-1 到 1 之间的范围。我使用这些分数来创建基于推文情感指标的特征，这些特征被用作建模的附加特征。如果你想对一个给定的句子进行多维度的情感测量，这些是非常有用的指标。我用下面的辅助函数提取并创建了新特性:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="oa ob l"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><a class="ae lv" href="https://gist.github.com/gracecarrillo/2eb646cad60a146d5b93fa2e3c6213fb#file-vadersentiment-helper-function" rel="noopener ugc nofollow" target="_blank">Vader 情操助手功能</a></p></figure><p id="8bd6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae lv" href="https://www.geeksforgeeks.org/nlp-part-of-speech-tagged-word-corpus/" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">【词性标注(POS) </strong> </a>是使用上下文线索将词性分配给列表中的每个单词。这很有用，因为同一个词有不同的词性，可能有两种完全不同的意思。是根据上下文和定义将语料库(一串文本)中的单词标记为语音标签的相应部分的过程。这项任务并不简单，因为一个特定的单词根据其使用的上下文可能有不同的词性。对于这个项目，我使用了一个简单的基于词汇的方法，将 POS 标签分配给训练语料库中最频繁出现的单词，并将标签作为特征添加到我们的模型中。关于助手功能，请参见下文:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="oa ob l"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><a class="ae lv" href="https://gist.github.com/gracecarrillo/f1f56ad0a369781fd1030362e9b8f983#file-pos-helper-function" rel="noopener ugc nofollow" target="_blank"> POS 助手功能</a></p></figure><p id="1814" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看我的 Github 中的<a class="ae lv" href="http://Feature_Engineering_Sentiment_Analysis_Scotref2.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本，了解这一部分的分步操作。</a></p><h1 id="9617" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">模型定义和培训</h1><h2 id="5346" class="og lz it bd ma oh oi dn me oj ok dp mi kr ol om mk kv on oo mm kz op oq mo or bi translated">监督机器学习</h2><p id="1314" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">在完成所有的预建模阶段后，我们构建模型，训练它们并测试它们。对于这项任务，我首先定义并训练了两个有监督的机器学习算法:</p><ul class=""><li id="0d4c" class="mq mr it kk b kl km ko kp kr os kv ot kz ou ld ov my mz na bi translated">朴素贝叶斯分类器</li><li id="64fa" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld ov my mz na bi translated">支持向量机分类器</li></ul><p id="1ebf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">它们可以说是任何分类任务中最常用的两种技术。</p><p id="f1ca" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">朴素贝叶斯</strong>是一种利用贝叶斯定理的分类器。它预测每个类的成员概率，例如给定记录或数据点属于特定类的概率。具有最高概率的类被认为是最可能的类。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ow"><img src="../Images/27472f18e3bd95451b14e4dcd155a638.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pkpoXVmLeBGauIAppMSVYQ.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">版权克里斯·阿尔邦，2020。</p></figure><p id="92dd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> SVM 分类器</strong>的工作原理是将数据映射到一个高维特征空间，这样即使数据不是线性可分的，也可以对数据点进行分类。找到类别之间的分隔符，然后对数据进行转换，使得分隔符可以绘制为超平面。在此之后，新数据的特征可以用于预测新记录应该属于哪个组。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ow"><img src="../Images/f31d91bcc7cd72c6dfd95761a26e5768.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W2jHLTDFqkJhc7QrIwnolA.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">版权克里斯·阿尔邦，2020。</p></figure><p id="ec8d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">定义模型后，我使用 Scikit Learn <a class="ae lv" href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="noopener ugc nofollow" target="_blank"> GridSearchCV </a>进行交叉验证，同时选择最佳的超参数配置。使用网格搜索，您可以设置超参数值的网格，并为每个组合训练一个模型，并根据验证数据进行评分。在这种方法中，尝试了超参数值的每一个组合。</p><p id="101a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我为每个分类器将组合的超参数传递给 GridsearchCV 对象，并为交叉验证传递 10 个折叠，这意味着对于每个参数组合，网格每次都用不同的测试集运行 10 次不同的迭代(这需要一段时间……)。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="oa ob l"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><a class="ae lv" href="https://gist.github.com/gracecarrillo/84218a4403b2165fa6d44ba7736598fd#file-cross-validation-txt" rel="noopener ugc nofollow" target="_blank">交叉验证</a></p></figure><p id="e5c9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在尝试了不同的模型参数组合之后，GridsearchCV 返回了每个分类器的最佳性能模型。然后，我保存模型进行评估。如果我们计划部署模型，这是一个必要的步骤。</p><h2 id="7e0a" class="og lz it bd ma oh oi dn me oj ok dp mi kr ol om mk kv on oo mm kz op oq mo or bi translated">深度学习</h2><p id="b0fb" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">为了比较，我还实现了一个<strong class="kk iu">递归神经网络(RNN) </strong>，称为<strong class="kk iu">长短期记忆(LSTM)。</strong></p><p id="76b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了快速描述它，想想我们是如何思考的。我们不是每秒钟都从零开始思考。我们以此为基础。就在你读这篇文章的时候，你在阅读的过程中增加了对它的理解。</p><p id="af2c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><a class="ae lv" href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener ugc nofollow" target="_blank">传统神经网络做不到这一点</a>。</p><p id="fe3d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们想要一个神经网络来理解我们的推文，我们需要一个可以从它读取的内容中学习并建立在其上的神经网络。rnn 解决了这个问题。它们是带有环路的网络，允许信息持续存在。但是我们也需要我们的网络使用一些推文中的上下文来学习。也就是说，我们需要它比其他 RNN 兄弟姐妹能记住更长时间的信息。</p><p id="2916" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">进入 LSTMs！他们是我们需要的孩子。</p><p id="9bfa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我使用的网络架构如下:</p><ul class=""><li id="21b9" class="mq mr it kk b kl km ko kp kr os kv ot kz ou ld ov my mz na bi translated">首先，我们将单词传递给一个嵌入层，<strong class="kk iu">我们的第一个隐藏层。</strong></li><li id="7ba9" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld ov my mz na bi translated">在输入单词被传递到嵌入层之后，新的嵌入被传递到 LSTM 单元，<strong class="kk iu">我们的第二个隐藏层</strong>。</li><li id="46fc" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld ov my mz na bi translated">最后，LSTM 输出到<strong class="kk iu"> softmax 输出层。</strong></li></ul><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi ox"><img src="../Images/cace770db820b756504598221c2c97d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J5W8FrASMi93Z81NlAui4w.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">来源:<a class="ae lv" href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener ugc nofollow" target="_blank">https://colah.github.io/posts/2015-08-Understanding-LSTMs/</a></p></figure><p id="d444" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了让推文准备好进入 LSTM 网络，需要做大量的数据准备。我必须将推特上的文字编码成整数。因此，我不得不使用 Keras 中的<code class="fe oc od oe of b">Tokenizer</code>将 tweets 转换成整数序列。然后，编码后的推文可以传入网络。</p><p id="8adf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用 Keras 构建网络相当容易。您可以简单地将多层堆叠在一起:</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="oa ob l"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><a class="ae lv" href="https://gist.github.com/gracecarrillo/45279ecc33f3a7d217ac76ff44273735#file-lstm-network-with-keras" rel="noopener ugc nofollow" target="_blank"> LSTM 网络与 Keras </a></p></figure><p id="1e5c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我运行了 10 个时期的模型，并观察到验证数据的损失在时期 1 之后开始增加，这表明过度拟合。在助手函数<code class="fe oc od oe of b">eval_metric</code>和<code class="fe oc od oe of b">optimal_epoch</code>的帮助下，我稍微调整了一下模型，解决了这个问题。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/78daff0b0306adf8ee2384e6afbf578f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*N_-1TodAtRMGI2uNeevSPA.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">在时段 1 中达到最小验证损失</p></figure><p id="fd30" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们从图表中观察到两件事:</p><ul class=""><li id="925d" class="mq mr it kk b kl km ko kp kr os kv ot kz ou ld ov my mz na bi translated">训练损失在每个时期之后保持减少。我们的模型正在学习识别训练集中的特定模式。</li><li id="33f6" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld ov my mz na bi translated">验证损失在每个时期之后持续增加。我们的模型在验证集上不够通用。</li></ul><p id="a274" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">训练损失继续下降，在第 10 个时期几乎为零。这是正常的，因为模型被训练以尽可能好地适应训练数据。</p><p id="4b61" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以，我们是<strong class="kk iu">过度训练(又称，模型过度拟合)。</strong></p><p id="e4a8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了解决这个问题，我应用了正则化，这可以归结为对大权重的损失函数增加一个成本。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/96379c1ac04ed047e481ab93c318483a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*_kkGY0_HwwLTIRld88jtHw.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">在时段 2 中达到最小验证损失</p></figure><p id="baeb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以看到，它在第二个时期开始过拟合，之后验证损失增加较慢。</p><p id="1125" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">乍一看，简化的模型似乎是概括的最佳模型。但后来我使用<code class="fe oc od oe of b">test_model</code>辅助函数检查了测试集，它给出了第一个 LSTM 的测试准确率为 74.81%，LSTM 的测试准确率为 74.47%。</p><p id="f9ef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，应用正则化有助于过度拟合，但对模型在测试数据上的准确性没有太大影响。</p><p id="0a3f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看我的 Github 中的<a class="ae lv" href="http://Models_Definition_&amp;_Training_Sentiment_Analysis_Scotref2.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本，了解这一部分的分步操作。</a></p><h1 id="d886" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">模型评估</h1><p id="c83a" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">模型评估是模型开发过程不可或缺的一部分。它有助于找到代表我们的数据的最佳模型，以及所选模型在未来的工作情况。对于此分类任务，我使用了以下评估指标:</p><ul class=""><li id="38e5" class="mq mr it kk b kl km ko kp kr os kv ot kz ou ld ov my mz na bi translated">混淆矩阵</li><li id="66d7" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld ov my mz na bi translated">准确度、召回率、精确度和 F1 分数</li></ul><p id="57a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">混淆矩阵</strong>显示了与数据中的实际结果(目标值)相比，分类模型做出的正确和错误预测的数量。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi oz"><img src="../Images/8db4f522a7933698bd3502b9dadfaca4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YaVn6t1mu7MvTxl8WztMqw.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">我们的监督机器学习模型的混淆矩阵</p></figure><p id="5fcc" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从上面可以看出:</p><ul class=""><li id="9952" class="mq mr it kk b kl km ko kp kr os kv ot kz ou ld ov my mz na bi translated"><strong class="kk iu">朴素贝叶斯分类器</strong>:该模型正确预测 76%的标签为阴性，73%正确预测为阳性。该模型预测 27%的标签为阴性，但它们是阳性的(假阴性)。当它们是阴性(假阳性)时，该模型预测 24%的标记为阳性。</li><li id="825b" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld ov my mz na bi translated"><strong class="kk iu"> SVM 分类器</strong>:模型正确预测 75%的标签为阴性，75%正确预测为阳性。该模型预测 25%的标签为阴性，但它们是阳性的(假阴性)。当它们是阴性(假阳性)时，该模型预测 25%的标记为阳性。</li></ul><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pa"><img src="../Images/b39e50408c43d96ac6ebe91729d94e1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3DAgQ6tilwIJnVIFTsvDJA.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">我们的 LSTM 递归神经网络的混淆矩阵</p></figure><p id="00d3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从上面可以看出:</p><ul class=""><li id="e5f4" class="mq mr it kk b kl km ko kp kr os kv ot kz ou ld ov my mz na bi translated"><strong class="kk iu"> LSTM 神经网络</strong>:该模型预测 76%的标签正确为阴性，73%正确为阳性。该模型预测 27%的标签为阴性，但它们是阳性的(假阴性)。当它们是阴性(假阳性)时，该模型预测 24%的标记为阳性。</li><li id="bbd4" class="mq mr it kk b kl nb ko nc kr nd kv ne kz nf ld ov my mz na bi translated"><strong class="kk iu">具有正则化的 LSTM 神经网络</strong>:该模型正确预测 74%的标签为阴性，73%正确预测为阳性。该模型预测 25%的标签为阴性，但它们是阳性的(假阴性)。当标签为阴性(假阳性)时，该模型预测 26%的标签为阳性，这比第一个 RNN 模型在准确性上有一点提高。</li></ul><p id="17c7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我们查看<strong class="kk iu">分类报告</strong>中的<strong class="kk iu">准确度、召回率、精确度</strong>和<strong class="kk iu">F1-分数</strong>。这些指标之间的差异以及我们为什么不简单地依赖准确性得分在这篇文章中有很好的解释。</p><p id="0611" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于朴素贝叶斯和 SVM:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pb"><img src="../Images/e4a44e1bca328464eeb8c6bc403511c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sT4zw1EDa5BIUdBg2sw_QA.jpeg"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">监督机器学习模型的分类报告</p></figure><p id="30d2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于 LSTM 车型:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pb"><img src="../Images/74bc2d599712c71a725ab390f5d48287.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pHx8LUBpp-KbRFyoYdP0eQ.jpeg"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">LSTM 车型的分类报告</p></figure><p id="00df" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从上述指标来看，我们的模型似乎表现得相对较好。请注意，在所有四个模型中，宏观和微观平均得分相同。这意味着我们的数据非常平衡，也就是说，我们训练数据集中的类分布是对称的。但是我们已经知道了。关键是，一个平衡的数据集允许我们依靠整体准确性指标来选择模型。</p><p id="0ffd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">相比之下，在这篇论文中，研究人员发现人类评分者通常在 80%的情况下会同意。</p><p id="c35c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，一个 75%准确的模型几乎和人类评分员一样好。</p><p id="5046" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">没有正则化的 SVM 和 LSTM 网络分类器都优于其他模型 1%，实现了 75%的总准确率。</p><p id="74b2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下一步我选择了 LSTM 而不是 SVM 模型，因为一般来说，<a class="ae lv" rel="noopener" target="_blank" href="/why-deep-learning-is-needed-over-traditional-machine-learning-1b6a99177063">深度学习在处理复杂问题时真的很出色</a>，比如自然语言处理。另一个优势是，当涉及到模型部署时，我们不太担心特性工程部分。</p><p id="3ae7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最终，真正的测试是在看不见的真实世界数据上使用模型。</p><p id="c1e2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看我的 Github 中的<a class="ae lv" href="http://Model_Evaluation_Sentiment_Analysis_Scotref2.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本，了解模型评估部分的详细步骤。</a></p><h1 id="e55e" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">未知建模:公投推特数据。</h1><p id="3e90" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">最后，我们到了有趣的部分。我们的话题相关的 twitter 数据！</p><p id="8ff9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们先浏览一下数据，看看数据集中最常见的单词是什么:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/f958bf0e7b6f5bb3f0db8aa0ef265a21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*9hlXTlQGJjPD-PHgdCoXHQ.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">理解推文中的常用词</p></figure><p id="f5d4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以看到，“indyref2”、“scottish”、“independent”和“scotland”这几个词出现的频率高得不成比例。他们当然是。它们是我下载推文的关键词的一部分！所以我把它们排除在外，再看一看:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/37a16253b20e06e2de4544a0369c0bae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*lT7Pax0wxbrDvSDaPnLh-Q.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">理解没有关键词的推文中使用的常用词</p></figure><p id="1a5d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">三月？为什么这个词是用得最多的？</p><p id="9b20" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">啊！如果你住在英国，你可能会注意到 1 月 11 日，<a class="ae lv" href="https://www.theguardian.com/politics/2020/jan/11/thousands-scottish-independence-supporters-march-glasgow" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu">数千名苏格兰独立支持者游行穿过格拉斯哥，这是计划于 2020 年举行的一系列抗议活动的第一场。</strong>并且该日期落在下载的推文的时间范围内。</a></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pe"><img src="../Images/954cd6ef61b6b848dc7599fbbc1998d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S_Aa7D7o4P57SwAeNvm1kQ.jpeg"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图片来源:罗伯特·佩里</p></figure><p id="31a3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">所以是的…三月。</p><p id="7f01" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们用单词云图来形象化所有的单词，因为它们很酷:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/fadc019168a701967b2bd08f689279e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h1qPEC8vDhkFwHdGWVTd6A.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><em class="pf">词频词云</em></p></figure><p id="0d24" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以看到，像“格拉斯哥”、“snp”、“人民”、“今天”、“工会”、“游行”、“公投”这些词是出现频率最高的。然而，它并没有给我们任何关于推文相关情绪的想法。所以让我们继续预测吧。</p><p id="e749" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我使用 LSTM 训练模型来创建推文数据集的预测。我必须强调的是<strong class="kk iu">这个模型通常检测消极或积极情绪</strong>。它不会检测某人是否在推特上发布了反对或支持该话题的内容。</p><p id="c224" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我还必须做一些清理，使它对神经网络友好。基本上相同的预处理应用于训练数据。</p><p id="99e1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">预测之后，正面标签推文的数量是 263 条<br/>，负面标签推文的数量是 373 条:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/76a77bf22ef78e18878fa49bd744cb8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*KFMsQMoWlotjTpmNjUwotw.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">twitter 数据集中正面和负面推文的字数分布。</p></figure><p id="a007" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">与被标记为正面的推文相比，被标记为负面的推文数量更多，尤其是当推文的字数更高时。对于我们的数据来说，推文越长，越有可能是负面的。</p><p id="2504" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">快速查看推文和它们的标签也很好。</p><p id="2b8c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下推文被标记为负面:</p><blockquote class="nj"><p id="3433" class="nk nl it bd nm nn no np nq nr ns ld dk translated">@anninnis @BBCPolitics 投票反对留在欧盟他们在 2014 年说过。世事变迁，因缘际会</p><p id="edff" class="nk nl it bd nm nn no np nq nr ns ld dk translated">对于@BorisJohnson 拒绝了@NicolaSturgeon 持有#Indyref2 的请求，我一点也不感到意外。</p></blockquote><p id="9f76" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">他们读起来确实有点生气或不安，尽管这取决于读者的视角。</p><p id="486c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下内容被我们的模型标记为阳性:</p><blockquote class="nj"><p id="3dcf" class="nk nl it bd nm nn no np nq nr ns ld dk translated">@CoyJudge 因为那次投票已经结束并且失败了，所以我继续前进，现在我们有了英国退出欧盟，我是获胜的一方。</p><p id="3b92" class="nk nl it bd nm nn no np nq nr ns ld dk translated">我是工党，在这一点上我完全同意鲍里斯。SNP 整理出他们在苏格兰创造的所有 sh*t。Indyref2 死了。</p></blockquote><p id="ed38" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">没错。所以第二条推特预测对我来说有点奇怪，我不会把它归类为积极情绪。</p><p id="010f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">唉，为了这个项目的目的，我继续用这个模型预测。</p><h1 id="1b98" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">地理空间分析</h1><p id="0c0d" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">因为我喜欢地图，我不得不创建地理可视化来探索它们在苏格兰和英国的分布情况，因为推文围绕着苏格兰和英国的新闻。</p><p id="4a14" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">值得一提的是，我们的数据集在发展过程中存在局限性。大多数 twitter 用户不广播他们的地理位置，但我的搜索标准只提取了一些信息，让我可以得到它。</p><p id="2f51" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，我可能错过了很多没有地理标签的推文，这些推文描绘的画面可能与我在地图上绘制的画面不同。</p><p id="df79" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">了解这一点不仅对解释结果至关重要，而且对理解我们如何在未来的分析中使模型更加稳健也至关重要。</p><p id="65e4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">策划这一切并不容易。数据有几个问题，缺少形状文件和其他问题。例如，一个位置被指示为位于格拉斯哥的 Kelvingrove 公园，因此它应该被替换为格拉斯哥标签。或者一些推文展示了小城镇，比如属于法夫地区的巴尔戈尼镇。为了保持一致，我还得重新命名它。</p><p id="462a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这之后，我终于为一些地块和地质地块做好了准备。</p><p id="0746" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，让我们看看大多数推文来自哪里。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/705a59310c6219f9e32964a885769f95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*0YMrdr1gk1t9lt0WN158Dw.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><em class="pf">来源国推文统计直方图</em></p></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/5dfa48a8753cc58d43052989ab7b6804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*jsr_vB-plEE5kSy1jApoJw.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><em class="pf">按国家/州划分的推文统计直方图</em></p></figure><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/f64dd0c3951b82e571e7d7eca9e9bba1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*MhFP6JX1D3nup3L4FJ4cVg.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><em class="pf">来源城市的推文统计直方图</em></p></figure><p id="eddb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">大多数推文来自苏格兰，具体来说，来自格拉斯哥，不是首都，而是苏格兰最大的城市，以其高比例的独立支持者而闻名。然而，相当一部分来自英国。</p><p id="18db" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我提取了英国每个城市的总体情绪，将正面情绪与负面情绪相加，最终的数字是一个+/-指标。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/a109a45863bfcad55ce82d4ea572c36b.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*U88jxwHnLKjhaV_CJpfNmA.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><em class="pf">总情绪直方图</em></p></figure><p id="e00b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">从直方图中可以清楚地看出，大多数值位于<code class="fe oc od oe of b">-5</code>和<code class="fe oc od oe of b">5</code>之间，总体情绪稍微偏向负面。平均情绪是负面情绪(<code class="fe oc od oe of b">-1</code>)。与数据框架中的其他城市相比，还有几个城市的总体负面情绪值较大。</p><p id="6c18" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后，我生成了下面的地图，通过这些消极和积极的情绪维度来可视化数据框架中城市的空间分布。点击此处查看<a class="ae lv" href="https://gracecarrillo.github.io/Political-Data-Science/twitter_uksentiment_map.html" rel="noopener ugc nofollow" target="_blank">互动地图。</a></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pk"><img src="../Images/7752e991d49076d68eb6bea1e5c3f269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HZDTeYL1z5xY9oqugglztw.jpeg"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><em class="pf">情感分布图</em></p></figure><p id="a60e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">提醒一下，所用的总情绪是通过对每个城市的积极和消极因素求和得出最终数字。</p><p id="8d44" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我设置了一个颜色等级，其中任何低于<code class="fe oc od oe of b">-1</code>的情绪都被标记为红色和消极，在<code class="fe oc od oe of b">-1</code>和<code class="fe oc od oe of b">1</code>之间的情绪是浅蓝色和中性，最后，高于<code class="fe oc od oe of b">1</code>的情绪被认为是积极的，并被涂上蓝色。</p><p id="4556" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总体而言，似乎来自苏格兰城市的推文比来自英格兰和威尔士的推文有更多的负面情绪。北爱尔兰有一个城市的推文总体上给人一种中性的感觉。总体负面情绪最高的城市(<code class="fe oc od oe of b">-19</code>)是格拉斯哥，其次是苏格兰北部的因弗戈登(<code class="fe oc od oe of b">-13</code>)。</p><p id="df57" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总之，来自爱丁堡、格拉斯哥、邓迪和斯特灵的推文显示负面情绪，阿伯丁是唯一一个正面情绪的主要城市。对于英格兰来说，我们可以看到更多的蓝点而不是红色。然而，来自曼彻斯特、伦敦和布里斯托尔等大城市的推文总体上有负面情绪。来自威尔士首府卡迪夫的推文总体上情绪积极。没有足够的发自北爱尔兰的推文来了解整体情绪。</p><p id="8e3e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">接下来，我生成了一个热图，以查看数据集中来自各自地理位置数据的每条推文，并观察推文的密度。点击这里查看<a class="ae lv" href="https://gracecarrillo.github.io/Political-Data-Science/twitter_uk_map.html" rel="noopener ugc nofollow" target="_blank">互动地图。</a></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi pl"><img src="../Images/59af3a4513c366556f36cab68ba647b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*guHDxKCv-ZWNvxJXWl2xaA.jpeg"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">带有<em class="pf">的热图英国地图数据集中的所有推文来源</em></p></figure><p id="76cb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">热图显示，正如预期的那样，许多推文来自人口密度高的城市地区。这些地区是格拉斯哥、爱丁堡、伦敦、利物浦、曼彻斯特和卡迪夫。这是可以预料的。很可能大多数 twitter 用户都居住在城市地区。</p><p id="65c9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看我的 Github 中的<a class="ae lv" href="http://Model_Deployment_Sentiment_Analysis_Scotref2.ipynb" rel="noopener ugc nofollow" target="_blank">完整笔记本和代码。</a></p><h1 id="d2b0" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated">结论</h1><p id="87e7" class="pw-post-body-paragraph ki kj it kk b kl ms ju kn ko mt jx kq kr ng kt ku kv nh kx ky kz ni lb lc ld im bi translated">在这篇文章的开始，我开始回答两个问题:</p><blockquote class="nj"><p id="049b" class="nk nl it bd nm nn no np nq nr ns ld dk translated">英国人对当前要求苏格兰独立公投的政治气候有何反应？鲍里斯·约翰逊拒绝允许吗？</p></blockquote><p id="807b" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">发自苏格兰的推文告诉我们，总的来说，人们的反应是消极的。鲍里斯·约翰逊宣布拒绝在 1 月 14 日举行全民公决。因此，可以解释为这些反应与该公告有关，因为它在我们下载的推文的时间范围内。</p><blockquote class="nj"><p id="c2e9" class="nk nl it bd nm nn no np nq nr ns ld dk translated">苏格兰、英格兰、威尔士和北爱尔兰人的反应有何不同？对苏格兰特别感兴趣。</p></blockquote><p id="62f2" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">与来自英格兰城镇的推文相比，来自苏格兰的推文的情绪似乎有明显的差异。来自威尔士和北爱尔兰的信息不多。</p><p id="8c1a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个有趣的步骤可能是在地图上添加一个时间维度，以可视化时间序列中的推文，并观察宣布前后推文情绪的变化。</p><blockquote class="nj"><p id="13d3" class="nk nl it bd nm nn no np nq nr ns ld dk translated">现在，这些结果并不意味着苏格兰发推文的人对第二次苏格兰独立公投持负面看法，而英格兰发推文的人持正面看法。</p></blockquote><p id="7701" class="pw-post-body-paragraph ki kj it kk b kl nt ju kn ko nu jx kq kr nv kt ku kv nw kx ky kz nx lb lc ld im bi translated">重要的是要记住，在最基本的形式下，情感分析算法是一种根据文本包含的被分类为正面或负面的单词的相对数量来确定文本内容正面或负面程度的方法。</p><p id="7c75" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我使用了一个超越基础的 LSTM 网络，因为它已经显示出<a class="ae lv" href="https://www.aclweb.org/anthology/O18-1021.pdf" rel="noopener ugc nofollow" target="_blank">在给定足够的训练数据的情况下，它可以有效地学习社交媒体环境中的单词用法。</a></p><p id="ba49" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但它在确定推文是否对正在讨论的话题持负面态度方面是有限的。更像是，推文的意图是消极的还是积极的。</p><p id="949f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">格拉斯哥的整体负面情绪可以解释为格拉斯哥人在推特上发布了很多负面词汇。当我们看一些推文时，非常愤怒的话。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/a7ca188c0b9cfe247e51365663b363db.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*RlxtE7ntYcrmV3urFcx3-Q.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">图片:<a class="ae lv" href="https://cinismoilustrado.com/" rel="noopener ugc nofollow" target="_blank">https://cinismoilustrado.com/</a></p></figure><p id="64aa" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">利益相关者可能对苏格兰独立的具体情绪感兴趣，而不是极性本身。他们可能想了解<strong class="kk iu">人们对这个话题</strong>的感受，意识到与之相关的日益增长的愤怒、恐惧或失望。</p><p id="e174" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇<a class="ae lv" href="http://emnlp2014.org/papers/pdf/EMNLP2014127.pdf" rel="noopener ugc nofollow" target="_blank">论文</a>中，研究人员能够训练一个模型来学习三种类型的推文情绪指标:标签、标签模式和五种情绪之一的短语:喜爱、愤怒/愤怒、恐惧/焦虑、快乐或悲伤/失望。</p><p id="4063" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">用情感短语和它们的上下文来训练我们的分类器将是非常有益的。特别是用特殊的社区行为和特定区域的情感词汇来训练它。单词<em class="le"> soft </em>在很多情况下可能会唤起温暖的积极含义，但称橄榄球运动员<em class="le"> soft </em>是一种侮辱。</p><p id="fd5c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一个使用了反映愤怒、快乐、失望和其他情绪的苏格兰特有单词和短语的训练数据集可能会帮助我们了解苏格兰人对当前事态的真实看法。</p></div><div class="ab cl pn po hx pp" role="separator"><span class="pq bw bk pr ps pt"/><span class="pq bw bk pr ps pt"/><span class="pq bw bk pr ps"/></div><div class="im in io ip iq"><p id="83c2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">仅此而已。我对政治非常有热情，所以这是一个非常令人兴奋的项目。</p><p id="0a83" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你设法看完了整本书，并且正在阅读这篇文章，感谢你的时间！非常感谢任何反馈。</p></div></div>    
</body>
</html>