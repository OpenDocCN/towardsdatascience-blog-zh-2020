<html>
<head>
<title>Creating Your Interactive and Animated Graphics with R in 5 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用R在5分钟内创建您的交互式动画图形</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/channel-your-creativity-interactive-and-animated-graphics-in-r-with-covid-19-data-5f7bede4b29f?source=collection_archive---------33-----------------------#2020-04-01">https://towardsdatascience.com/channel-your-creativity-interactive-and-animated-graphics-in-r-with-covid-19-data-5f7bede4b29f?source=collection_archive---------33-----------------------#2020-04-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7923" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">D3.js中没有编码的动画可视化</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fd95837359ff52e4a333d429e0e8f1e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JjoQDtQ5izP9U1GSZldjdQ.png"/></div></div></figure><p id="bfe7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">冠状病毒，或称新冠肺炎病毒，在不到两个月的时间里已经在几个大洲传播，并且肯定已经引起了公众的恐慌和疫情的恐惧！这个星球上的每条新闻都在报道冠状病毒，股票市场正在崩溃，人们正在让焦虑支配他们的行为。当然，我对病毒遗传学和流行病学没有任何专长，但就我而言，理性的做法是采取必要的预防措施，呆在家里，保持社交距离，直到我们一起度过难关！</p><p id="f9db" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">与其呆在家里做最坏的打算，我们为什么不积极地用一些有创造性的东西来占据我们的大脑呢？在这篇博客中，我将使用COVID–19数据来讨论R中使用较少代码行生成图形的几种技术，以及如何在R中创建交互式动画图形，而无需在<a class="ae lq" href="https://d3js.org/" rel="noopener ugc nofollow" target="_blank"> D3.js </a>中编写一行代码。现在，让我们加入到r中新冠肺炎可视化的潮流中来</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><p id="c4a3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们将使用由约翰霍普金斯大学CSSE 2019-nCoV Github存储库维护并每日更新的新冠肺炎数据集(<a class="ae lq" href="https://github.com/CSSEGISandData/COVID-19/tree/master/csse_covid_19_data/csse_covid_19_time_series" rel="noopener ugc nofollow" target="_blank">这里是链接</a>)。有3个单独的数据集，分别用于确诊、死亡和恢复的病例，这3个数据集都是宽格式的，从1月22日持续到3月28日(当我开始这篇博客时)。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ly"><img src="../Images/6ec333c2e62390505c80b734be48651c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tNJIZJ-SnrP4Gr-w7SZKjg.png"/></div></div><p class="lz ma gj gh gi mb mc bd b be z dk translated">新冠肺炎确诊病例数据集</p></figure><p id="e551" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">同时读入数据集(并创建绘图变量)</strong></p><p id="7fb8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">首先，让我们把3个数据集读入R，</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="2639" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">注意，我们在每个数据集中创建了一个额外的变量，标记为<strong class="kw iu">‘Status’</strong>。我稍后会解释原因，但是现在，让我们做一个快速的完整性检查，以确保3个数据集包含相同的绑定列。这种健全性检查总是有用的，尤其是在原始数据源发生变化的情况下，并且(复活节彩蛋)下面的代码显示了如何做<a class="ae lq" href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" rel="noopener ugc nofollow" target="_blank"> DRY </a>。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="a929" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们需要将数据集列表追加到一个数据框中，</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="23e0" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，让我们回到我们在读取每个数据集时创建的<strong class="kw iu">‘Status’</strong>变量。在已确认、已死亡和已恢复数据集中，此堆叠变量的值将分别为“已确认”、“已死亡”和“已恢复”。将此'<strong class="kw iu">状态</strong>'变量作为单独的一列，可将其指定为{ggplot2}中的计算和绘图参数。</p><p id="d9cb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，下面展示了按“国家”和“状态”分组的数据准备步骤(这里，我选择了4个国家进行比较——中国、意大利、美国和伊朗)。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="bbcd" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">(复活节彩蛋)注意到了<em class="mf"> colnames(。)</em>？这可能是{ magrittr }管道中我最喜欢的功能。)这里接收上一次操作返回的所有内容。超级得心应手！</p><p id="52f7" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">静态热图显示确诊病例</strong></p><p id="50a3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">可视化纵向数据或任何二维数据的一种方法是热图，因此，让我们继续看第一个图表——上述4个国家确诊病例的热图。</p><p id="4872" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">出于演示的目的，我只绘制了从2月22日到3月28日的数据，但是如果您愿意的话，可以随意扩展时间线，</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="da83" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是我们的热图，显示与其他国家相比，中国的确诊病例数一直是最高的，直到美国和意大利在3月底超过了这些数字。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mg"><img src="../Images/8638dd0f3154cb8abd212b6d6e2df19e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OLdQ-0fZe7gR9Bes6SU1Gw.png"/></div></div></figure><p id="6d68" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">热图的一个缺点是它不能处理第三维度，这意味着如果我们要观察确诊、死亡和康复病例的模式，我们必须做3个单独的热图。</p><p id="771b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">交互式纵向意大利面条图</strong></p><p id="6c49" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">纵向折线图适用于添加第三层(即确诊、死亡和痊愈)的任务。在这里，对于每个国家，情节的开始日期被设置为第一个病例被报告确认的日期，我们需要将格式从宽转换为长，</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="6420" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了一次创建多个图，{ggplot2}有一个很棒的函数<strong class="kw iu">‘facet _ wrap’</strong>(查看<a class="ae lq" href="http://www.cookbook-r.com/Graphs/Facets_(ggplot2)/" rel="noopener ugc nofollow" target="_blank">此链接</a>了解详情)，这里我们允许不同国家的比例有所不同。为了让剧情互动，{plotly}是我们的打包产品，</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="fd8a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这是我们的互动折线图，</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="mh me l"/></div></figure><p id="251b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我们可以直观地说出4个选定国家的轨迹，那么其他国家呢？</p><p id="9b14" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">R中的动画条形图</strong></p><p id="daaa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我们可以创建一个赛车条形图，显示确诊病例最多的前N个国家，我们可以使用{gganimate}软件包在R中完成！</p><p id="0915" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">完整的代码可以在<a class="ae lq" href="https://github.com/YiLi225/COVID-19_analysis" rel="noopener ugc nofollow" target="_blank"> my Github </a>中找到，但是基本上，我们首先定义一个静态图，就像我们定义{ggplot2}一样，</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="19a5" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后定义动画部分，(复活节彩蛋)函数<strong class="kw iu"> ease_aes() </strong>可以用来调整你的酒吧过渡的平滑度，</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="8b07" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">瞧，在这里。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mi"><img src="../Images/8f67c6c1f15a621ff0ed78b4554c3b40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*E_UYQWu4okaP57sNrLytPw.gif"/></div></div></figure><p id="aba8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">我希望这篇博客让你从冠状病毒恐慌中分散了一点注意力，更好的是，你学到了一些新东西。同样，你可以在my Github中找到完整的代码，包括如何将你的动画情节保存为GIF或MP4 <a class="ae lq" href="https://github.com/YiLi225/COVID-19_analysis" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="9033" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">保持积极，保持健康！</p><p id="248a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu"> <em class="mf">编者注:</em> </strong> <em class="mf"> </em> <a class="ae lq" href="http://towardsdatascience.com/" rel="noopener" target="_blank"> <em class="mf">走向数据科学</em> </a> <em class="mf">是一份以研究数据科学和机器学习为主的中型刊物。我们不是健康专家或流行病学家，本文的观点不应被解释为专业建议。想了解更多关于疫情冠状病毒的信息，可以点击</em> <a class="ae lq" href="https://www.who.int/emergencies/diseases/novel-coronavirus-2019/situation-reports" rel="noopener ugc nofollow" target="_blank"> <em class="mf">这里</em> </a> <em class="mf">。</em></p></div></div>    
</body>
</html>