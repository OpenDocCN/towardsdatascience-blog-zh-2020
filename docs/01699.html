<html>
<head>
<title>Confusion Matrix “Un-confused”</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">混淆矩阵“未混淆”</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/confusion-matrix-un-confused-1ba98dee0d7f?source=collection_archive---------22-----------------------#2020-02-16">https://towardsdatascience.com/confusion-matrix-un-confused-1ba98dee0d7f?source=collection_archive---------22-----------------------#2020-02-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8cb2" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">打破混乱矩阵</h2></div><p id="7415" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">工业中应用机器学习的目标是驱动商业价值。因此，能够评估您的机器学习算法的性能对于深入了解您的模型极其重要。</p><p id="50e0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我的目标是以一种对那些积极使用它们的人和那些只是好奇的人来说容易理解的方式深入到困惑矩阵中。也就是说，本文的结构如下:</p><ol class=""><li id="b896" class="le lf it kk b kl km ko kp kr lg kv lh kz li ld lj lk ll lm bi translated">什么是混淆矩阵</li><li id="3cd4" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">如何解读混淆矩阵</li><li id="f895" class="le lf it kk b kl ln ko lo kr lp kv lq kz lr ld lj lk ll lm bi translated">案例研究(准确度、召回率、精确度和 F 值)</li></ol><p id="d4b5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">混淆矩阵是什么？</strong></p><p id="cbbf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">混淆矩阵是用于机器学习中分类任务的有用工具，其主要目的是可视化机器学习模型的性能。</p><p id="86eb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在负类为 0、正类为 1 的二元分类设置中，混淆矩阵由一个 2x2 网格表构成，其中行是数据的实际输出，列是模型的预测值。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi ls"><img src="../Images/2439802367f85dbcd0a7798de77c2778.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*0MS7FKf9W0T0ipFwXZi_tg.png"/></div></div><p class="me mf gj gh gi mg mh bd b be z dk translated">图 1:混淆矩阵的可视化表示(没有注释)</p></figure><p id="ecce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mi">我将解释为什么某些网格是一种颜色，而其他的却是另一种颜色，现在，这只是混淆矩阵是什么以及它对于二进制分类任务看起来会是什么样子的视觉表示。</em></p><p id="34f3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">注意:许多来源以不同的方式构建混淆矩阵，例如，行可能是预测值，列可能是实际值。如果您正在使用框架(即 Sci-kit learn ),阅读混淆矩阵的文档以了解混淆矩阵的格式是很重要的。</strong></p><blockquote class="mj mk ml"><p id="9ff0" class="ki kj mi kk b kl km ju kn ko kp jx kq mm ks kt ku mn kw kx ky mo la lb lc ld im bi translated">无论您在<em class="it">图 1 </em>中停留在哪个网格块上，其相邻的网格都会以另一种颜色高亮显示。这考虑到了混乱矩阵的不同变化，如果您简单地旋转网格，您可能会看到这些变化。</p></blockquote><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/412328148f7bd96a16e2ed04a7f6463e.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*cssty5XNrMiGlrxW_7Qmig.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">图 2:混淆矩阵的变化</p></figure><p id="c685" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">很好！既然你已经熟悉了二元分类任务的混淆矩阵的格式，现在知道如何填写混淆矩阵是很重要的。</p><p id="95ec" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们用经典的猫和狗的例子。如果我们的分类任务已经被训练来区分猫和狗，混淆矩阵将为预测模型创建结果摘要以供进一步分析。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/5297c09754efaade4db5327055ec5c55.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*7yivynEYCUB5K7TvXw1h9w.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">图 3:取自<a class="ae mr" href="https://computersciencesource.wordpress.com/2010/01/07/year-2-machine-learning-confusion-matrix/" rel="noopener ugc nofollow" target="_blank"> Badgerati </a>的混淆矩阵结果</p></figure><p id="0248" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<em class="mi">图 3 中的 50 只猫中，</em>模型预测实际上有 15 只猫，35 只狗。关于狗，模型预测 40 只为猫，10 只为狗。所有正确的预测都被分配在表格的对角线上(从上到下)——是的，你猜对了！这就是为什么这些盒子被涂上了与图 1 中<em class="mi">一样的颜色。</em></p><p id="4801" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你现在已经学会了如何绘制你自己的困惑矩阵。作为数据科学家，我们想知道为什么模型做得不好，以便我们更好地了解我们的数据，我们可以使用这些数据为下一个建模阶段设计新功能。</p></div><div class="ab cl ms mt hx mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="im in io ip iq"><p id="3651" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">如何解读困惑矩阵</strong></p><p id="cffb" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我将首先描述一些术语，如果你能猜出它们的走向，那么你就成功了一半:</p><p id="d8c4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">真阳性:</strong>模型预测阳性，标签实际阳性。</p><p id="4b69" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">真阴性:</strong>模型预测为阴性，标签实际为阴性。</p><p id="fc90" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">假阳性:</strong>模型预测为阳性，而标签实际上是阴性——我喜欢把这想象成<strong class="kk iu"> <em class="mi">被错误地归类为阳性</em> </strong>。</p><p id="5fcd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">假阴性:</strong>模型预测为阴性，而标签实际上是阳性——我喜欢把这想象成<strong class="kk iu"> <em class="mi">被错误地归类为阴性</em> </strong>。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mz"><img src="../Images/e002bd2fbe5486614e93870e622dfc1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XsFcyoLXNdAkbSfNGnxhEg.png"/></div></div><p class="me mf gj gh gi mg mh bd b be z dk translated">图 4:带注释的混淆矩阵</p></figure><p id="7da0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果你能够将这些标签归类到这些列中，那就太棒了，你现在已经全面掌握了混淆矩阵。让我们进一步挖掘！</p><p id="c7a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的混淆矩阵在我们的网格上有两个红色补丁，这向我们推断出我们的模型正在犯的错误的类型。第一类错误是当我们的模型错误地将实际上是阴性的东西分类为阳性(假阳性)——因此它可以被认为是一个错误的警报——例如预测某人患有哮喘，而他们实际上没有。第二类错误是当我们错误地将实际上是阳性的东西归类为阴性(假阴性)——在我们的哮喘病例中，这将是说某人没有哮喘，而实际上他们有。</p><p id="3ef1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我知道这些文字会让你很难理解，所以如果你觉得它还没有被很好地接受，回到图 4 来获得一个视觉概念。</p><p id="0c1e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您现在已经了解了混淆矩阵是一种用于评估预测模型在分类任务中的性能的工具。此外，您还知道与我们的预测模型的每个输出相关的术语。</p><p id="5042" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">案例研究:</strong></p><p id="60a2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们的任务是建立一个分类器，预测不同交易的欺诈或非欺诈。这些数据是由英国一家安全措施非常严格的大银行交给我们的——出于隐私考虑，所有客户的个人信息都被加密了——因此欺诈交易不会经常发生。事实上，他们给我们的数据有 10，000 个负面案例(非欺诈)和 1000 个(欺诈)案例。<em class="mi">图 5 </em>显示了我们分类器的结果。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi na"><img src="../Images/44a4ffc44cc9bea30d6e6003919cb17c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZ29-MqSzGPHfXlQvhtq6w.png"/></div></div><p class="me mf gj gh gi mg mh bd b be z dk translated">图 5:用例模型的结果</p></figure><p id="94e5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="mi">准确度</em> </strong></p><p id="ea77" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">准确度是指测量值与标准值或已知值的接近程度。在我们建立了一个分类器并使用它进行预测之后，我们很快地调出我们的混淆矩阵来确定我们的模型有多准确，我们惊讶地发现我们的模型有 92%的准确性。当我们开始梦想我们将从中获得的奖金时，有什么东西拉了拉我们的<em class="mi">数据科学骨骼</em>并告诉我们更多地查看我们的模型预测，因为我们不知道为什么我们的模型如此准确，因为当我们的目标变量(在这种情况下，欺诈或非欺诈)不平衡时，准确性可能是一个误导性的指标。我们再次回顾了混淆矩阵(参见<em class="mi">图 5) </em>，以获得更多的指标来告诉我们为什么我们的模型如此准确。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi nb"><img src="../Images/f458b3b28c19aad91d3665ed02dd9231.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4qIx0pq0T8xCp9JOfFY0Rg.png"/></div></div><p class="me mf gj gh gi mg mh bd b be z dk translated">图 6:精确度公式</p></figure><p id="d9f7" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">精度和召回</strong></p><p id="ae5f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">精度(也称为阳性预测值)告诉我们，从我们的分类器标记为阳性的标签，实际上是阳性的量。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi nc"><img src="../Images/637ab7247875bcbe26cb420cee58f4ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0lidptyfNzMv9p6qIo_cnw.png"/></div></div><p class="me mf gj gh gi mg mh bd b be z dk translated">图 7:精度公式</p></figure><p id="9ddd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一方面，回忆(也称为敏感度或真实阳性率)告诉我们我们的模型正确识别的实际阳性的数量。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/d62fd28bf078221593421c7e1a41662b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*ezdC-lOk4WybyZ8DEo8foQ.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">图 8:召回公式</p></figure><blockquote class="mj mk ml"><p id="9102" class="ki kj mi kk b kl km ju kn ko kp jx kq mm ks kt ku mn kw kx ky mo la lb lc ld im bi translated"><strong class="kk iu">注:精确度和召回率基于对阳性标签(相关性)的理解和测量。</strong></p></blockquote><p id="30d3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们计算刚刚学过的精确和回忆公式:</p><p id="64ce" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mi">精度</em> = 83%</p><p id="77b5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">是啊！！这太棒了，这意味着 83%被我们标记为阳性的标签实际上是阳性的。这是惊人的…是吗？让我们检查一下召回情况。</p><p id="3b9c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="mi">回忆</em> = 24%</p><p id="766f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这告诉我们，我们的分类器正确识别的阳性标签的数量。换句话说，欺诈在 76%的时间里都没有被发现！不需要博士学位就知道这一点也不好。</p><p id="3414" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对于这个问题，我们希望优化召回，这意味着我们希望通过在更多情况下预测阳性来减少假阴性的数量(当实际标签是阳性时错误地分类为阴性)。然而，有些时候你可能想优化精确度，例如在垃圾邮件分类器中，我们不希望重要的邮件被归类为垃圾邮件并发送到我们的垃圾邮件中。就我们的欺诈分类器而言，我们希望优化召回率，为了做到这一点，我们必须降低分类器的阈值，以将其分类为肯定类别。请注意，由于我们的分类器现在预测阳性更多，它降低了(我们曾经很高的)83%的精度，因为现在我们的模型预测假阳性发出更多假警报的可能性更高，但在这种情况下我们不介意。</p><p id="89c8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">精确和回忆爱恨关系</strong></p><p id="a27d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">精确度和召回率很少被孤立地讨论，正如我们在上面发现的，它们之间经常有一种反比关系——增加一个度量就会减少另一个。当我们需要在精确度和召回率之间取得平衡时，一个更好的度量标准是 F1 值(也称为 F 值)。F1-score 是一种考虑精确度和召回率的精确度衡量标准(下面的公式将向您展示它是如何做到这一点的)。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/498c8f683f90af99300dfdfe88ad7811.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*NCnlyG-9H0A4ttTeGwtJHg.png"/></div><p class="me mf gj gh gi mg mh bd b be z dk translated">图 9:F1 分数的公式</p></figure><p id="42f8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">总之，从我们的混淆矩阵中可以得出更多的度量。对混淆矩阵中的术语有一个牢固的理解，这是继续理解可以推导出的其他度量的坚实基础。如果你想继续，<a class="nf ng ep" href="https://medium.com/u/7fe94d3af4e6?source=post_page-----1ba98dee0d7f--------------------------------" rel="noopener" target="_blank"> Sarang Narkhede </a>在他的个人资料上有一个关于困惑矩阵的惊人帖子(<a class="ae mr" rel="noopener" target="_blank" href="/understanding-confusion-matrix-a9ad42dcfd62">点击这里导航到那里</a>)。<a class="nf ng ep" href="https://medium.com/u/71f58a3cb5e8?source=post_page-----1ba98dee0d7f--------------------------------" rel="noopener" target="_blank"> Koo Ping Shung </a>更详细地介绍了何时使用准确度、精确度、回忆和 F1 分数，并且以友好的方式撰写，因此任何人都可以理解(<a class="ae mr" rel="noopener" target="_blank" href="/accuracy-precision-recall-or-f1-331fb37c5cb9">单击此处获取链接</a>)。我们还有著名的维基百科，你可以点击<a class="ae mr" href="https://en.wikipedia.org/wiki/Confusion_matrix" rel="noopener ugc nofollow" target="_blank">这里</a>进入。我在下面附上了一个帖子，它扩展了混淆矩阵，我们用它来绘制 ROC 曲线，如果你不知道那是什么，或者你知道但不太理解它，那么点击下面的链接可以很好地掌握它。</p><div class="nh ni gp gr nj nk"><a rel="noopener follow" target="_blank" href="/comprehension-of-the-auc-roc-curve-e876191280f9"><div class="nl ab fo"><div class="nm ab nn cl cj no"><h2 class="bd iu gy z fp np fr fs nq fu fw is bi translated">理解 AUC-ROC 曲线</h2><div class="nr l"><h3 class="bd b gy z fp np fr fs nq fu fw dk translated">深入了解 AUC-ROC…</h3></div><div class="ns l"><p class="bd b dl z fp np fr fs nq fu fw dk translated">towardsdatascience.com</p></div></div><div class="nt l"><div class="nu l nv nw nx nt ny mc nk"/></div></div></a></div></div></div>    
</body>
</html>