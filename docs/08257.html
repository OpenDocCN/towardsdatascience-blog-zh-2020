<html>
<head>
<title>Using machine learning to predict future bitcoin prices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用机器学习预测未来比特币价格</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/using-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f?source=collection_archive---------5-----------------------#2020-06-17">https://towardsdatascience.com/using-machine-learning-to-predict-future-bitcoin-prices-6637e7bfa58f?source=collection_archive---------5-----------------------#2020-06-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="eb09" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何利用深度学习预测未来</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/111260526af3f2914c8a38afac32ad8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uVKMcAV-7uYXgIVUILbybA.png"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">克里斯·利维拉尼在<a class="ae kv" href="/s/photos/data?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="f08e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有没有可能预测明天的比特币价格？或者如果这个跳跃太远，那么20分钟后的价格呢？</p><p id="f195" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我将使用<a class="ae kv" href="https://www.bioinf.jku.at/publications/older/2604.pdf" rel="noopener ugc nofollow" target="_blank">长短期记忆</a> (LSTM) RNN机器学习模型来预测20分钟后的比特币价格，仅仅依靠简单的历史金融数据。</p><p id="c17c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我写这篇文章，部分是作为一个指南，部分是作为一个练习，探索LSTM模型在比特币价格预测中的潜在用途。因此，我可能会跳过一些基本原理，因为这些很容易在其他地方找到。</p><p id="b590" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">免责声明:我的经验主要来自好奇心、个人和专业能力的实际应用，以及对有效市场的兴趣。这可能意味着使用的一些术语和方法可能与其他术语和方法不同。</p><h1 id="be1f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">LSTM模式简介</h1><p id="3d59" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">LSTM模式到底是什么？简而言之，这是一种能够学习长期依赖性的递归神经网络。与我们使用以前的经验来告知(最好是更好的)未来结果类似，LSTM模型使用更新门和遗忘门来随机记住和忘记历史信息片段，以告知他们的预测。</p><p id="fb66" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">像这样使用历史“背景”的能力使得这些模型在许多其他应用中特别适合于预测目的。</p><p id="a5c0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了建立更深入的理解，请看一看<a class="ae kv" href="https://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener ugc nofollow" target="_blank">这个</a>伟大的资源，它深入研究了这种类型的神经网络的确切机制。</p><h1 id="b4a1" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">我们将使用什么工具</h1><p id="e4be" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">对于这个练习，我使用<a class="ae kv" href="https://numpy.org/install/" rel="noopener ugc nofollow" target="_blank"> Numpy </a>和<a class="ae kv" href="https://pandas.pydata.org/getting_started.html" rel="noopener ugc nofollow" target="_blank"> Pandas </a>来处理数据，使用<a class="ae kv" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a> / <a class="ae kv" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> Tensorflow </a>来实现机器学习功能。为了调试和更好地呈现代码，我使用了Jupyter笔记本。</p><h1 id="368c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">收集所需的数据</h1><p id="ecf2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">为了训练我们的模型，我们需要训练数据。任何金融定价数据在这里都足够了，只要它可以以分钟为间隔获得，并且大小合理。我使用的是大约23天的财务数据，时间间隔为一分钟。</p><p id="8120" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我自己使用<a class="ae kv" href="https://www.kraken.com/features/api" rel="noopener ugc nofollow" target="_blank">北海巨妖API </a>收集了这些数据，所以它很可能包含缺口。但这只是为了举例说明。你可以在这里找到我的数据和完整的源代码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h1 id="6c56" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">数据准备</h1><p id="4ce1" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">首先，我们从导入所有必需的包开始，加载数据集并删除我们不感兴趣的行。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="ae3c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将数据集分成训练集和测试集，并标准化其特征。标准化是很好的实践，因为它减少了在某些特征的方差可能高于其他特征的情况下的过度拟合。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="4761" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">LSTM模型要求我们按块组织数据。我们的数据以一分钟为间隔进行分组，我们将使用50分钟的数据块来预测下一个数据块。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h1 id="01f0" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">模型</h1><p id="75ed" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在是时候训练我们的模型了。我们选择我们想要使用的模型类型；在这种情况下是连续的，我们决定超参数。</p><p id="1094" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我使用的模型相对简单，包含5个隐藏层，每个隐藏层有50个神经元，每个隐藏层之间有一个漏失。我们使用均方误差损失函数，Adam优化器，将批量大小设置为32，并遍历该网络10个时期。</p><p id="7bbf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">决定超参数更多的是艺术而不是科学，值得测试出多种选择，以了解什么最适合您的测试数据和生产。优化你的超参数超出了本文的范围，但是网上有一些很好的资源。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="2a7d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们有了一个可以用来建立预测的模型，我们可以看看它在测试数据中的表现。下图绘制了要价和出价的测试数据(y_test)预测(y_hat)。正如我们可以看到的，预测值与训练数据非常匹配。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/34423415ea16ef13505c763487002cf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8iznkIw3SxUJTWGW1VdiDw.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="272d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">酷！所以这意味着我现在可以预测比特币的价格了？</p><p id="6c8f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不，不是真的。不幸的是。</p><p id="053e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这些模型的预测能力绝对令人印象深刻，但如果你仔细观察预测，你会发现它与测试数据非常接近。这种预测似乎密切跟踪价格的变化，但往往不能正确预测这些变化发生时的价格。这对于任何你想用它的交易策略来说都不是非常有用。</p><h1 id="8481" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">预测未来</h1><p id="c1eb" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果我们想预测20分钟后的价格，一种选择是在最近的历史数据间隔内运行模型，将预测连接到历史数据数组的末尾，然后将该数组反馈到模型中，继续这一过程，直到我们有20个预测的价格预测块。</p><p id="d07e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码正是这样做的，并根据测试数据绘制了买价和卖价。不出所料，它并没有真正告诉你太多，这个特定的预测错误地预测了价格上涨。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/d5c6ef934dbe0ac6434a365d10c3f29b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1bm2MVKi5DxP2pTv4C1rIA.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="0388" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是对于剩余的测试数据来说，情况会是这样吗？由于测试数据由6，661行组成，我们有133个窗口可以预测交易。</p><p id="007d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们预测剩余的20分钟，并对n=4和n=0时的ask_price的累积差值求和。</p><p id="28c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图显示了预测的<em class="mt">有利可图的</em>交易和实际交易的累积收益，其中一个人以n=0的要价买入，以n=4的要价卖出。</p><p id="8e2c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">有趣的是，给你带来实际净收益的交易似乎超过了会导致亏损的交易。有了100美元的本金，你将获得31美元。仅仅过了4.5天。那可是天文数字的回报！</p><p id="f44f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好得难以置信。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/c21c12ec3333412647998127e6e9467a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NsNoOT9MCux7l9HVjReC4A.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="a72c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">任何曾经在交易所购买BTC或任何金融工具的人现在都会告诉我，你实际上不能在市场上以要价卖出。买卖价差会阻止我们从价格上涨中获利，只有当资产的增值高于价差时，我们才能从交易中获利。</p><p id="b560" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦我们把这个模型应用到我们的预测中，我们的金鹅开始失去一些羽毛。我们同样的100美元仍将升值约3.40美元！仍然是令人印象深刻的1318%的年回报率。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/dc68ee0e3f72d49040efd2a1233cb0e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QBahzNuisRDPh4oU3iVj7A.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="647c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在让我们加入交易成本。我们将采取自由的假设，我们可以在市场上交易，只收取0.1%的低费用——这是为交易量非常大的交易者保留的。</p><p id="e22e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很快就会发现，我们的金鹅根本不是金子。我们的模型只能识别3个潜在的盈利交易，同样的100美元现在会变成2.26美元的亏损。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/71dcf663006b00ea2b1c4f0b5fda1485.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RyT1DC-2cjekmZMgicZFXw.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><h1 id="5bd6" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="6ef9" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">上面的练习表明，简单的金融数据在预测价格的短期变化方面具有一定的预测能力，但是由于没有从这些信息中获利的实际机会，所以从交易的角度来看，这种特定的模型是相对无用的。</p><p id="db0a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">LSTM模型等工具正变得越来越容易获得，大型团体和机构正在通过更好的数据和卓越的处理能力来拓展这些模型的能力。这导致市场将越来越多的信息整合到资产价格中，使得套利机会变得很少。</p><p id="dc0d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">建立一个具有战胜市场的预测能力的模型不是一件简单的事情，如果有人能够轻松地使用这些工具赚钱，我肯定不会在这里与你分享。</p><p id="51dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="mt">注来自《走向数据科学》的编辑:</em> </strong> <em class="mt">虽然我们允许独立作者根据我们的</em> <a class="ae kv" rel="noopener" target="_blank" href="/questions-96667b06af5"> <em class="mt">规则和指导方针</em> </a> <em class="mt">发表文章，但我们不认可每个作者的贡献。你不应该在没有寻求专业建议的情况下依赖一个作者的作品。详见我们的</em> <a class="ae kv" rel="noopener" target="_blank" href="/readers-terms-b5d780a700a4"> <em class="mt">读者术语</em> </a> <em class="mt">。</em></p></div></div>    
</body>
</html>