# PyCaret ä¸­ä½ åšé”™çš„ 5 ä»¶äº‹

> åŸæ–‡ï¼š<https://towardsdatascience.com/5-things-you-are-doing-wrong-in-pycaret-e01981575d2a?source=collection_archive---------6----------------------->

## æ¥è‡ª PyCaret çš„åˆ›é€ è€…

![](img/141c45537d1959408ba1a137ed9b6f03.png)

æœ¬Â·æ€€ç‰¹åœ¨ [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) ä¸Šçš„ç…§ç‰‡

# PyCaret

PyCaret æ˜¯ä¸€ä¸ªç”¨ Python ç¼–å†™çš„å¼€æºã€ä½ä»£ç çš„æœºå™¨å­¦ä¹ åº“ï¼Œå¯ä»¥è‡ªåŠ¨åŒ–æœºå™¨å­¦ä¹ å·¥ä½œæµã€‚å®ƒæ˜¯ä¸€ä¸ªç«¯åˆ°ç«¯çš„æœºå™¨å­¦ä¹ å’Œæ¨¡å‹ç®¡ç†å·¥å…·ï¼Œå¯ä»¥åŠ å¿«æœºå™¨å­¦ä¹ å®éªŒå‘¨æœŸï¼Œè®©ä½ æ›´æœ‰æ•ˆç‡ã€‚

ä¸å…¶ä»–å¼€æºæœºå™¨å­¦ä¹ åº“ç›¸æ¯”ï¼ŒPyCaret æ˜¯ä¸€ä¸ªæ›¿ä»£çš„ä½ä»£ç åº“ï¼Œå¯ä»¥ç”¨æ¥æ›¿æ¢æ•°ç™¾è¡Œä»£ç ã€‚è¿™ä½¿å¾—å®éªŒå¿«é€Ÿæœ‰æ•ˆã€‚

å®˜æ–¹:ã€https://www.pycaret.orgã€‘T4

æ–‡ä»¶:[https://pycaret.readthedocs.io/en/latest/](https://pycaret.readthedocs.io/en/latest/)

https://www.github.com/pycaret/pycaret

# ğŸ‘‰compare_models åšçš„æ¯”ä½ æƒ³çš„æ›´å¤š

å½“æˆ‘ä»¬åœ¨ 2020 å¹´ 4 æœˆå‘å¸ƒ py caret 1.0 ç‰ˆæœ¬æ—¶ï¼Œ **compare_models** å‡½æ•°æ­£åœ¨æ¯”è¾ƒåº“ä¸­çš„æ‰€æœ‰æ¨¡å‹ï¼Œä»¥è¿”å›å¹³å‡çš„äº¤å‰éªŒè¯æ€§èƒ½æŒ‡æ ‡ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ **create_model** æ¥è®­ç»ƒæ€§èƒ½æœ€ä½³çš„æ¨¡å‹ï¼Œå¹¶è·å¾—å¯ç”¨äºé¢„æµ‹çš„è®­ç»ƒæ¨¡å‹è¾“å‡ºã€‚

è¿™ç§è¡Œä¸ºåæ¥åœ¨ 2.0 ç‰ˆä¸­æœ‰æ‰€æ”¹å˜ã€‚ **compare_models** ç°åœ¨æ ¹æ® **n_select** å‚æ•°è¿”å›æœ€ä½³æ¨¡å‹ï¼Œè¯¥å‚æ•°é»˜è®¤è®¾ç½®ä¸º 1ï¼Œè¿™æ„å‘³ç€å®ƒå°†è¿”å›æœ€ä½³æ¨¡å‹(é»˜è®¤)ã€‚

![](img/54895079b3418ca761a411b643c53708.png)

æ¯”è¾ƒæ¨¡å‹(n_select = 1)

é€šè¿‡å°†é»˜è®¤çš„ **n_select** å‚æ•°æ›´æ”¹ä¸º 3ï¼Œæ‚¨å¯ä»¥è·å¾—å‰ 3 ä¸ªæ¨¡å‹çš„åˆ—è¡¨ã€‚ä¾‹å¦‚:

![](img/3054bf73884c3a680259d101795bbad8.png)

æ¯”è¾ƒæ¨¡å‹(n_select = 3)

è¿”å›çš„å¯¹è±¡æ˜¯è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œä½ çœŸçš„ä¸éœ€è¦å†è°ƒç”¨ **create_model** æ¥è®­ç»ƒå®ƒä»¬ã€‚å¦‚æœæ„¿æ„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¿™äº›æ¨¡å‹æ¥ç”Ÿæˆè¯Šæ–­å›¾ï¼Œç”šè‡³å°†å…¶ç”¨äºé¢„æµ‹ã€‚ä¾‹å¦‚:

![](img/9e0491b715a34d4b3280f83ccb8d2fad.png)

é¢„æµ‹æ¨¡å‹å‡½æ•°

# ğŸ‘‰ä½ è®¤ä¸ºä½ ä»…é™äº scikit-learn æ¨¡å‹

æˆ‘ä»¬æ”¶åˆ°å¾ˆå¤šè¯·æ±‚ï¼Œè¦æ±‚å°†é *scikit-learn* æ¨¡å‹åŒ…å«åœ¨æ¨¡å‹åº“ä¸­ã€‚å¾ˆå¤šäººæ²¡æœ‰æ„è¯†åˆ°ï¼Œä½ å¹¶ä¸ä»…é™äºé»˜è®¤çš„æ¨¡å¼ã€‚ **create_model** å‡½æ•°é™¤äº†æ¥å—æ¨¡å‹åº“ä¸­å¯ç”¨æ¨¡å‹çš„ ID å¤–ï¼Œè¿˜æ¥å—æœªè®­ç»ƒçš„æ¨¡å‹å¯¹è±¡ã€‚åªè¦ä½ çš„å¯¹è±¡ä¸*scikit-learn*fit/predict API å…¼å®¹ï¼Œå®ƒå°±èƒ½æ­£å¸¸å·¥ä½œã€‚ä¾‹å¦‚ï¼Œè¿™é‡Œæˆ‘ä»¬é€šè¿‡ç®€å•åœ°å¯¼å…¥æœªè®­ç»ƒçš„ NGBClassifierï¼Œä» [ngboost](https://github.com/stanfordmlgroup/ngboost) åº“ä¸­è®­ç»ƒå¹¶è¯„ä¼°äº† ***NGBClassifier*** :

![](img/c5832f706773d0126fcd0e8241ab6ea5.png)

ä½¿ç”¨å¤–éƒ¨æ¨¡å‹åˆ›å»ºæ¨¡å‹

ä¹Ÿå¯ä»¥é€šè¿‡ **compare_models** çš„ **include** å‚æ•°ä¸­çš„æœªè®­ç»ƒæ¨¡å‹ï¼Œå°±å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚

![](img/45726ff0b5721316276cb7311f7a5b12.png)

å°†æ¨¡å‹ä¸æœªè®­ç»ƒçš„å¯¹è±¡è¿›è¡Œæ¯”è¾ƒ

è¯·æ³¨æ„ï¼ŒåŒ…å«å‚æ•°åŒ…æ‹¬æ¥è‡ªæ¨¡å‹åº“çš„ä¸‰ä¸ªæœªè®­ç»ƒæ¨¡å‹çš„ IDï¼Œå³é€»è¾‘å›å½’ã€å†³ç­–æ ‘å’Œ K ä¸ªé‚»å±…ä»¥åŠæ¥è‡ª ngboost åº“çš„ä¸€ä¸ªæœªè®­ç»ƒå¯¹è±¡ã€‚å¦å¤–ï¼Œè¯·æ³¨æ„ï¼Œç´¢å¼•è¡¨ç¤ºåœ¨ include å‚æ•°ä¸­è¾“å…¥çš„æ¨¡å‹çš„ä½ç½®ã€‚

# ğŸ‘‰ä½ ä¸çŸ¥é“ pull()å‡½æ•°

æ‰€æœ‰è®­ç»ƒåŠŸèƒ½(åˆ›å»ºæ¨¡å‹ã€è°ƒæ•´æ¨¡å‹ã€é›†åˆæ¨¡å‹ç­‰ã€‚)æ˜¾ç¤ºä¸€ä¸ªä¹è°±ç½‘æ ¼ï¼Œä½†å®ƒä¸è¿”å›ä¹è°±ç½‘æ ¼ã€‚å› æ­¤ï¼Œä½ ä¸èƒ½åœ¨ä¸€ä¸ªåƒ pandas.DataFrame è¿™æ ·çš„å¯¹è±¡ä¸­å­˜å‚¨åˆ†æ•°ç½‘æ ¼ã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€ä¸ªåä¸º **pull** çš„å‡½æ•°å…è®¸ä½ è¿™æ ·åšã€‚ä¾‹å¦‚:

![](img/0afb4d4198e3f011c9e5d5a555f82d6c.png)

å¸¦ create_model çš„æ‹‰å‡½æ•°

å½“æ‚¨ä½¿ç”¨ **predict_model** å‡½æ•°æ—¶ï¼Œè¿™ä¹Ÿé€‚ç”¨äºç»´æŒåˆ†æ•°ç½‘æ ¼ã€‚

![](img/b2db2c2ff299308f2e26f294310d287b.png)

å¸¦é¢„æµ‹æ¨¡å‹çš„æ‹‰å‡½æ•°

ç°åœ¨ï¼Œæ‚¨å¯ä»¥åƒç†ŠçŒ«ä¸€æ ·è®¿é—®æŒ‡æ ‡ã€‚DataFrameï¼Œä½ å¯ä»¥åˆ›é€ å¥‡è¿¹ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªå¾ªç¯æ¥è®­ç»ƒå…·æœ‰ä¸åŒå‚æ•°çš„æ¨¡å‹ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹ç®€å•ä»£ç åˆ›å»ºä¸€ä¸ªæ¯”è¾ƒè¡¨:

![](img/278720cf8ebbb16ae058b3721d2054da.png)

åˆ›å»º _ æ¨¡å‹å’Œæ‹‰åŠŸèƒ½

# ğŸ‘‰ä½ è®¤ä¸º PyCaret æ˜¯ä¸€ä¸ªé»‘ç›’ï¼Œå®ƒä¸æ˜¯ã€‚

å¦ä¸€ä¸ªå¸¸è§çš„å›°æƒ‘æ˜¯ï¼Œæ‰€æœ‰çš„é¢„å¤„ç†éƒ½æ˜¯åœ¨åå°è¿›è¡Œçš„ï¼Œç”¨æˆ·æ— æ³•è®¿é—®ã€‚å› æ­¤ï¼Œä½ ä¸èƒ½å®¡è®¡å½“ä½ è¿è¡Œ**è®¾ç½®**åŠŸèƒ½æ—¶å‘ç”Ÿäº†ä»€ä¹ˆã€‚è¿™ä¸æ˜¯çœŸçš„ã€‚

PyCaret **get_config** å’Œ **set_config** ä¸­æœ‰ä¸¤ä¸ªå‡½æ•°å…è®¸æ‚¨åœ¨åå°è®¿é—®å’Œæ›´æ”¹ä¸€åˆ‡ï¼Œä»æ‚¨çš„è®­ç»ƒé›†åˆ°æ‚¨çš„æ¨¡å‹çš„éšæœºçŠ¶æ€ã€‚æ‚¨å¯ä»¥é€šè¿‡ç®€å•åœ°è°ƒç”¨ **help(get_config)** æ¥æŸ¥çœ‹ **get_config** å‡½æ•°çš„æ–‡æ¡£ï¼Œä»¥æŸ¥çœ‹æ‚¨å¯ä»¥è®¿é—®å“ªäº›å˜é‡:

![](img/c68bd489eb050d3569243c4398578042.png)

å¸®åŠ©(è·å–é…ç½®)

æ‚¨å¯ä»¥é€šè¿‡åœ¨ **get_config** å‡½æ•°ä¸­è°ƒç”¨è¯¥å˜é‡æ¥è®¿é—®å®ƒã€‚ä¾‹å¦‚ï¼Œè¦è®¿é—® **X_train** è½¬æ¢çš„æ•°æ®é›†ï¼Œæ‚¨å°†ç¼–å†™ä»¥ä¸‹ä»£ç :

![](img/a2487f55066f0c1da3779a58f241729b.png)

get_config('X_train ')

æ‚¨å¯ä»¥ä½¿ç”¨ **set_config** åŠŸèƒ½æ¥æ›´æ”¹ç¯å¢ƒå˜é‡ã€‚æœ‰äº†ç›®å‰ä¸ºæ­¢ä½ æ‰€çŸ¥é“çš„å…³äº **pullã€get_configã€**å’Œ **set_config** å‡½æ•°ã€ä½ å¯ä»¥åˆ›å»ºä¸€äº›éå¸¸å¤æ‚çš„å·¥ä½œæµã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥å¯¹ç»´æŒé›† ***é‡æ–°é‡‡æ · N æ¬¡*** æ¥è¯„ä¼°å¹³å‡æ€§èƒ½æŒ‡æ ‡ï¼Œè€Œä¸æ˜¯ä¾èµ–äºä¸€ä¸ªç»´æŒé›†:

```
import numpy as npXtest = get_config('X_test')
ytest = get_config('y_test')AUC = []for i in np.random.randint(0,1000,size=10):
    Xtest_sampled = Xtest.sample(n = 100, random_state = i)
    ytest_sampled = ytest[Xtest_sampled.index]
    set_config('X_test', Xtest_sampled)
    set_config('y_test', ytest_sampled)
    predict_model(dt);
    AUC.append(pull()['AUC'][0])>>> print(AUC)**[Output]:** [0.8182, 0.7483, 0.7812, 0.7887, 0.7799, 0.7967, 0.7812, 0.7209, 0.7958, 0.7404]>>> print(np.array(AUC).mean())**[Output]: 0.77513**
```

# ğŸ‘‰ä½ æ²¡æœ‰è®°å½•ä½ çš„å®éªŒ

å¦‚æœä½ æ²¡æœ‰è®°å½•ä½ çš„å®éªŒï¼Œä½ åº”è¯¥ç°åœ¨å°±å¼€å§‹è®°å½•ã€‚ä¸ç®¡ä½ æ˜¯å¦æƒ³ä½¿ç”¨ MLFlow åç«¯æœåŠ¡å™¨ï¼Œä½ ä»ç„¶åº”è¯¥è®°å½•ä½ æ‰€æœ‰çš„å®éªŒã€‚å½“ä½ æ‰§è¡Œä»»ä½•å®éªŒæ—¶ï¼Œä½ ä¼šäº§ç”Ÿå¤§é‡çš„å…ƒæ•°æ®ï¼Œè€Œè¿™äº›å…ƒæ•°æ®æ˜¯ä¸å¯èƒ½è¢«æ‰‹åŠ¨è·Ÿè¸ªçš„ã€‚

å½“æ‚¨ä½¿ç”¨ **get_logs** å‡½æ•°æ—¶ï¼ŒPyCaret çš„æ—¥å¿—åŠŸèƒ½å°†ç”Ÿæˆä¸€ä¸ªæ¼‚äº®ã€è½»é‡çº§ã€æ˜“äºç†è§£çš„ excel ç”µå­è¡¨æ ¼ã€‚ä¾‹å¦‚:

```
**# loading dataset**
from pycaret.datasets import get_data
data = get_data('juice')**# initializing setup**
from pycaret.classification import *s = setup(data, target = 'Purchase', silent = True, log_experiment = True, experiment_name = 'juice1')**# compare baseline models**
best = compare_models()**# generate logs**
get_logs()
```

![](img/7ade0a45ba19553896300b0bdc4e8970.png)

è·å–æ—¥å¿—()

åœ¨è¿™ä¸ªéå¸¸çŸ­çš„å®éªŒä¸­ï¼Œæˆ‘ä»¬å·²ç»ç”Ÿæˆäº† 3ï¼Œ000 å¤šä¸ªå…ƒæ•°æ®ç‚¹(æŒ‡æ ‡ã€è¶…å‚æ•°ã€è¿è¡Œæ—¶é—´ç­‰ã€‚).æƒ³è±¡ä¸€ä¸‹ï¼Œæ‚¨ä¼šå¦‚ä½•æ‰‹åŠ¨è·Ÿè¸ªè¿™äº›æ•°æ®ç‚¹ï¼Ÿä¹Ÿè®¸ï¼Œè¿™å®é™…ä¸Šä¸å¯èƒ½ã€‚å¹¸è¿çš„æ˜¯ï¼ŒPyCaret æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•ã€‚åªéœ€åœ¨**è®¾ç½®**åŠŸèƒ½**ä¸­å°† **log_experiment** è®¾ç½®ä¸ºçœŸã€‚**

ä½¿ç”¨ Python ä¸­çš„è½»é‡çº§å·¥ä½œæµè‡ªåŠ¨åŒ–åº“ï¼Œæ‚¨å¯ä»¥å®ç°çš„ç›®æ ‡æ˜¯æ— é™çš„ã€‚å¦‚æœä½ è§‰å¾—è¿™æœ‰ç”¨ï¼Œè¯·ä¸è¦å¿˜è®°ç»™æˆ‘ä»¬ GitHub repo ä¸Šçš„â­ï¸ã€‚

æƒ³äº†è§£æ›´å¤šå…³äº PyCaret çš„ä¿¡æ¯ï¼Œè¯·å…³æ³¨æˆ‘ä»¬çš„ LinkedIn å’Œ Youtubeã€‚

è¦äº†è§£ PyCaret 2.2 ä¸­æ‰€æœ‰æ›´æ–°çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§[å‘è¡Œè¯´æ˜](https://github.com/pycaret/pycaret/releases)æˆ–é˜…è¯»æ­¤[å…¬å‘Š](/pycaret-2-2-is-here-whats-new-ad7612ca63b)ã€‚

# é‡è¦é“¾æ¥

[ç”¨æˆ·æŒ‡å—](https://www.pycaret.org/guide)
[æ–‡æ¡£](https://pycaret.readthedocs.io/en/latest/)
[å®˜æ–¹æ•™ç¨‹](https://github.com/pycaret/pycaret/tree/master/tutorials) [ç¤ºä¾‹ç¬”è®°æœ¬](https://github.com/pycaret/pycaret/tree/master/examples)
[å…¶ä»–èµ„æº](https://github.com/pycaret/pycaret/tree/master/resources)

# æƒ³äº†è§£æŸä¸ªç‰¹å®šæ¨¡å—ï¼Ÿ

å•å‡»ä¸‹é¢çš„é“¾æ¥æŸ¥çœ‹æ–‡æ¡£å’Œå·¥ä½œç¤ºä¾‹ã€‚

[åˆ†ç±»](https://pycaret.readthedocs.io/en/latest/api/classification.html)
[å›å½’](https://pycaret.readthedocs.io/en/latest/api/regression.html)
[èšç±»](https://pycaret.readthedocs.io/en/latest/api/clustering.html)
[å¼‚å¸¸æ£€æµ‹](https://pycaret.readthedocs.io/en/latest/api/anomaly.html)
[è‡ªç„¶è¯­è¨€å¤„ç†](https://pycaret.readthedocs.io/en/latest/api/nlp.html) å…³è”è§„åˆ™æŒ–æ˜