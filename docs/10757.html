<html>
<head>
<title>Machine Learning — Handling Missing Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习——处理缺失数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-handling-missing-data-27b09ab146ba?source=collection_archive---------47-----------------------#2020-07-27">https://towardsdatascience.com/machine-learning-handling-missing-data-27b09ab146ba?source=collection_archive---------47-----------------------#2020-07-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="7468" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">开始使用数据前如何清理数据的指南。</h2></div><p id="3ca9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">这里是我们将在教程中使用的数据:</strong> <a class="ae le" href="https://catalog.data.gov/dataset/accidental-drug-related-deaths-january-2012-sept-2015" rel="noopener ugc nofollow" target="_blank">点击这里</a></p><p id="a30a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">当数据中有空值时，它们通常会以 NAN 值的形式出现在 IDE 中。在开始数据训练之前，您需要处理这些缺失的数据。我们有两种基本的方法可以做到这一点。我们可以删除缺少值的行，或者填充它们。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/61af5c8bb5e8c091d1fb77958a24bae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6xMwQa7rgb6kiPPxSPihMQ.png"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><strong class="bd lv">图 1: </strong>来自 PC 的数据集截图</p></figure><p id="54bd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">上面你可以看到有多少单元格丢失了数据。</p><h1 id="0256" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">检查是否存在 nan</h1><p id="25e1" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">数据集真的很大，那么如何快速找到空值呢？</p><p id="51b8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用<code class="fe mt mu mv mw b">isNull()</code>方法找到任何可能出现的 NAN 值。我们可以使用<code class="fe mt mu mv mw b">.sum()</code>方法获得每列所有 NAN 值的<strong class="kk iu">计数</strong></p><p id="5c73" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">代码片段:</strong> <code class="fe mt mu mv mw b"> dataset.isnull().sum()</code></p><p id="1cb2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是上面数据集的部分示例:</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/b3ac72ecfe7a66922b1b23181fc121b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*uqVuXNmW4slHKu5vqgdXYw.png"/></div><p class="lr ls gj gh gi lt lu bd b be z dk translated"><strong class="bd lv">图片 2: </strong>从电脑上截取的截图</p></figure><p id="3e73" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在这里看到'<strong class="kk iu"> <em class="my">年龄</em> </strong>'有<em class="my"> 2 南值</em>和'<strong class="kk iu"> <em class="my">死亡县</em> </strong>'有 1100。这段代码片段为我们提供了数据集中每列 NAN 值的准确数量。</p><h1 id="ed17" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">处理南价值观。</h1><p id="84f5" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">根据如何处理 NAN 值的数据集，您有几种选择。</p><h1 id="cc40" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">1.删除丢失的值</h1><p id="ca21" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">在上例中，我们看到'<strong class="kk iu"> <em class="my">日期</em> </strong>'有<em class="my"> 2 个 NAN 值</em>。</p><p id="8a21" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在对我来说，'<strong class="kk iu"> <em class="my"> Date </em> </strong>'可能是我的处理所必需的，所以我想删除任何没有日期值的行。</p><p id="bcf5" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了实现这一点，我们可以使用内置方法，<code class="fe mt mu mv mw b">dropna().</code>这个方法自动删除任何带有 NAN 的行。但是，我们将希望使用特定的列，所以让我们看看如何做到这一点</p><p id="d061" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> a .删除列中缺少值的行</strong></p><p id="40bf" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">代码片段:</strong> <code class="fe mt mu mv mw b"> dataset.dropna(subset=['ColumnName1', 'CoulmnName2'], how='any')</code></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi mz"><img src="../Images/6e83f97ceaac5165bf953f026ac5cfab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zn-CtTvWamc1MqyGSLGwiQ.png"/></div></div></figure><p id="b117" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这里我们看到不再有任何与 NAN 相关的日期行。</p><p id="2fb3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> <em class="my">快速旁注，</em> </strong>如果任何选中的列有 NAN ，则<code class="fe mt mu mv mw b">how=’any’</code>将删除该行<em class="my">。在这个例子中，我只看了一列，所以没关系，但是假设<code class="fe mt mu mv mw b">subset=[‘Date’, ‘Age’]</code>。如果'<strong class="kk iu"> <em class="my"> Date </em> </strong>'或<strong class="kk iu"> 'Age' </strong>有一个 NAN 值，该行将被删除。</em></p><p id="c1e9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们希望仅当<strong class="kk iu"> <em class="my">【日期】&amp;【年龄】都是 NAN </em> </strong>时才删除该行，我们可以使用<code class="fe mt mu mv mw b">how=’all’</code>，它在删除该行之前检查所有值是否都是 NAN 。</p><h2 id="cc9c" class="na lx it bd ly nb nc dn mc nd ne dp mg kr nf ng mi kv nh ni mk kz nj nk mm nl bi translated"><strong class="ak"> b .删除所有带有 NAN 的行</strong></h2><p id="bd52" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">可能的情况是，当任何列有 NAN 时，我只想删除任何行。使用<code class="fe mt mu mv mw b">.dropna()</code>方法很容易做到:</p><p id="bb40" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">代码片段:</strong> <code class="fe mt mu mv mw b"> dataset = dataset.dropna(how=’any’)</code></p><p id="d9e6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是在我们的例子中，执行这个操作会删除所有的行，所以它不是很有用。</p><h2 id="9b66" class="na lx it bd ly nb nc dn mc nd ne dp mg kr nf ng mi kv nh ni mk kz nj nk mm nl bi translated">c.删除所有列都是 NAN 的行</h2><p id="2271" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">有时会发生这样的情况，有些行只包含所有的 NAN 值。要删除这些不必要的行，我们可以:</p><p id="0c4b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">代码片段:</strong>T5】</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h1 id="3c91" class="lw lx it bd ly lz ma mb mc md me mf mg jz mh ka mi kc mj kd mk kf ml kg mm mn bi translated">2.填充缺失值</h1><p id="9562" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">因此，有时我们的数据几乎是完美的，但我们只是有一些需要填充的缺失值，以便我们可以处理数据。</p><h2 id="5a59" class="na lx it bd ly nb nc dn mc nd ne dp mg kr nf ng mi kv nh ni mk kz nj nk mm nl bi translated"><strong class="ak"> a .填写分类数据</strong></h2><p id="8b22" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">让我们以“种族”一栏为例。如果我们用<code class="fe mt mu mv mw b">value_counts()</code>方法查看数据集中的值，确保设置<code class="fe mt mu mv mw b">dropna=False</code>以便我们也可以计算 NAN 值，而不仅仅是类别，我们会得到这样的结果:</p><p id="8a67" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">代码片段</strong> : <code class="fe mt mu mv mw b">dataset[‘Race’].value_counts(dropna=False)</code></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi no"><img src="../Images/d04375da01fa5a009a0304e08879c132.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sw3kr1QMJ-Of3cfXeUAirA.png"/></div></div></figure><p id="a726" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们在这里看到'<strong class="kk iu"> <em class="my">种族</em> </strong>'列中有 13 个 NAN 值。幸运的是，我们已经有了像“<strong class="kk iu"><em class="my"/></strong>”或“<strong class="kk iu"> <em class="my">其他</em> </strong>”这样的类别可以使用。</p><p id="fba8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这种情况下，我们将所有 NAN 值映射到“<strong class="kk iu"><em class="my"/></strong>”类别是有意义的，因为我们不知道这些值是否属于任何<em class="my">主要类别</em>或属于“<strong class="kk iu"> <em class="my">其他</em> </strong>”类别。</p><p id="f397" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要做到这一点，我们只需要使用下面的<code class="fe mt mu mv mw b">.fillna()</code>方法，我们可以将所有缺失的值赋给'<strong class="kk iu"> <em class="my">未知的</em> </strong>'。</p><p id="2fb2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">代码片段</strong> : <code class="fe mt mu mv mw b">dataset[‘ColName’].fillna(value= ‘Replace’, inplace=True)</code></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi np"><img src="../Images/b3052999bb38ec764df1233c7c264133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*og9EegUkpjlEdWYsCei_JQ.png"/></div></div></figure><p id="8028" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">然后砰！所有的 NAN 值已经被映射到'<strong class="kk iu"> <em class="my">未知的</em> </strong>'就像我们想要的那样。</p><h2 id="fcd2" class="na lx it bd ly nb nc dn mc nd ne dp mg kr nf ng mi kv nh ni mk kz nj nk mm nl bi translated">b.填写数字数据</h2><p id="c18c" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">如果我们以'<strong class="kk iu"> <em class="my">年龄</em> </strong>'为例，我们可以从我们之前的运行(图 3)中看到有<strong class="kk iu"> 3 行，其中年龄为 NAN </strong>。现在，由于这不是很多丢失的数据，通常我们可以删除它们，因为它可能不会影响我们的训练。但是假设我们需要处理它们，我们可以采用什么策略呢？</p><p id="4bfd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">替换为列的平均值、中间值或最频繁值</strong></p><p id="2979" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">根据具体情况，您可能希望用平均值、中值或众数来替换这些值。在这种情况下，mean 是有意义的，但是让我们用三种方法来做。</p><p id="d136" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">平均值</strong> : <code class="fe mt mu mv mw b">dataset[‘col’].fillna((dataset[‘col’].mean()), inplace=True)<br/></code> <strong class="kk iu">最频繁</strong> : <code class="fe mt mu mv mw b">dataset[‘col’].fillna(dataset[‘col’].mode().iloc[0], inplace=True)</code> <br/> <strong class="kk iu">中位数</strong> : <code class="fe mt mu mv mw b">dataset[‘col’].fillna((dataset[‘col’].median()), inplace=True)</code></p><p id="ad2d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个年龄示例中，我们可以看到<strong class="kk iu">索引 0、12 和 4887 是 NAN 值</strong></p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nq"><img src="../Images/ea5bf595896740cd11f634e5e679ee21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5xh5vo97ktW8ZXGsycje3w.png"/></div></div></figure><p id="ec2b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">运行 median 的代码(并进行一些舍入)后，我们得到了看起来更好的东西。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nr"><img src="../Images/26d27bc382e7415d87f8eeb8b1d59e85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*trSnt6z2OgoB0rt_xipQfQ.png"/></div></div></figure><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="nm nn l"/></div></figure></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nz"><img src="../Images/754540c4b830f7c7f81810e28326a881.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kupPqa3K9qp4K0kQ"/></div></div><p class="lr ls gj gh gi lt lu bd b be z dk translated">马库斯·温克勒在<a class="ae le" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><p id="992a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这就是处理丢失数据的基本方法。通常情况下，您应该能够只使用这里的代码，或者通过谷歌搜索一些罕见的情况。</p><p id="e14c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">下期龙珠 Z:更多预处理！</strong></p></div></div>    
</body>
</html>