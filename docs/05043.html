<html>
<head>
<title>Anomaly Detection made simple</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">异常检测变得简单</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/anomaly-detection-made-simple-70775c914377?source=collection_archive---------21-----------------------#2020-05-01">https://towardsdatascience.com/anomaly-detection-made-simple-70775c914377?source=collection_archive---------21-----------------------#2020-05-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="4d1d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">利用 pycaret 包的信用卡诈骗案</h2></div><p id="0e32" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated"><span class="l lf lg lh bm li lj lk ll lm di">在</span>这个银行业的新时代，Stripe、Square 等金融支付服务巨头使信用卡支付无缝化，信用卡交易每年都以倍数增长(<a class="ae ln" href="https://www.creditcards.com/credit-card-news/market-share-statistics.php" rel="noopener ugc nofollow" target="_blank">来源</a>)。因此也导致信用卡诈骗报告每年翻一番(<a class="ae ln" href="https://www.fool.com/the-ascent/research/identity-theft-credit-card-fraud-statistics/" rel="noopener ugc nofollow" target="_blank">来源</a>)。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/8b61e5f1f372753b010d4ad62cc9d216.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*Ip02aiwNGeVIvGtiMXOMjQ.png"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated">按年份分类的信用卡欺诈报告(<a class="ae ln" href="https://www.fool.com/the-ascent/research/identity-theft-credit-card-fraud-statistics/" rel="noopener ugc nofollow" target="_blank">来源</a>)</p></figure><p id="5b6c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">什么是异常？</strong></p><p id="180e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">异常是偏离正常或预期的东西。在信用卡交易中，大多数欺诈案件偏离了正常交易的行为。说什么是正常的交易行为是主观的，但是有不同类型的异常检测技术来发现这种行为。这里我们将讨论三种类型的技术。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi me"><img src="../Images/31d04d84a7781a48f34304ae01364fbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*O01Fkpf5nzJKLLV6.jpg"/></div></div><p class="ma mb gj gh gi mc md bd b be z dk translated"><a class="ae ln" href="https://www.sdadata.org/digital-evangelism-blog/words-matter-so-do-you" rel="noopener ugc nofollow" target="_blank">来源</a></p></figure><p id="b996" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">信用卡诈骗侦破案例:</strong></p><p id="dc09" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我正在考虑卡格尔信用卡欺诈检测进行异常 detection⁴.</p><p id="85dd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">从 API 调用下载数据集:</strong></p><p id="2b5c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">首先，进入您的 Kaggle 我的帐户(<a class="ae ln" href="https://www.kaggle.com/*Your-Username*/account)" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/*Your-Username*/account)</a>，进入“API”部分，点击“创建新的 API 令牌”，下载您的 API 令牌。您现在将下载一个名为“kaggle.json”的文件。你必须把这个文件上传到你的笔记本上。</p><pre class="lp lq lr ls gt mf mg mh mi aw mj bi"><span id="f41f" class="mk ml it mg b gy mm mn l mo mp">from google.colab import files<br/>uploaded = files.upload()</span></pre><p id="5044" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在，您可以使用下面给出的代码来下载和解压缩数据集。</p><pre class="lp lq lr ls gt mf mg mh mi aw mj bi"><span id="331a" class="mk ml it mg b gy mm mn l mo mp">!pip uninstall -y kaggle<br/>!pip install --upgrade pip<br/>!pip install kaggle==1.5.6<br/>!kaggle -v<br/>!mkdir -p ~/.kaggle<br/>!cp kaggle.json ~/.kaggle/<br/>!chmod 600 ~/.kaggle/kaggle.json<br/>!kaggle datasets download -d mlg-ulb/creditcardfraud<br/>!unzip creditcardfraud.zip</span></pre><h2 id="ae52" class="mk ml it bd mq mr ms dn mt mu mv dp mw kr mx my mz kv na nb nc kz nd ne nf ng bi translated">预处理:</h2><p id="6faf" class="pw-post-body-paragraph ki kj it kk b kl nh ju kn ko ni jx kq kr nj kt ku kv nk kx ky kz nl lb lc ld im bi translated">在给定的数据集中，284，807 笔交易中有 492 笔欺诈，我正在考虑一个 0.1 的样本用于我们的分析，而不会丢失离群分数用于进一步的无监督学习。异常分数是 0.001723。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="b992" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">设置初始化 pycaret⁵的环境，并创建转换管道，为建模和部署准备数据。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="b276" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 1。隔离林:</strong></p><p id="afb1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated"><span class="l lf lg lh bm li lj lk ll lm di"> T </span>隔离森林算法通过随机选择一个特征，然后随机选择所选特征的最大值和最小值之间的分割值来分离观察值，类似地，通过创建随机决策 trees⁶.来构建分离因此，异常分数被计算为分离给定观察所需的条件的数量。</p><p id="1158" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">建立模型:</strong></p><p id="a606" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用 pycaret 包中的 create_model 函数建立模型，可以使用下面的代码相应地修改参数。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="2b1b" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用 assign_model⁷函数寻找孤立森林异常分数和标签。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi no"><img src="../Images/af756954e9e1515728f9fbb8875ae612.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*7vvF79-9vj6SNiR_tpMnyg.png"/></div></figure><p id="456c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">评价:</strong></p><p id="6327" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">隔离林的 ROC_AUC 为 0.935。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi np"><img src="../Images/e0988e22457a263ae3e0b3dc42f485ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*dDx-q5_pxcRnf1clDkAVXA.png"/></div></figure><p id="6fd3" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 2。基于角度的异常检测:</strong></p><p id="2323" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated"><span class="l lf lg lh bm li lj lk ll lm di">在</span>中，基于角度的异常值检测通过比较距离向量对之间的<strong class="kk iu">角度</strong>来解决高维度问题，而不是使用距离 directly⁸.</p><p id="0bdd" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">建立模型:</strong></p><p id="b20e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用 pycaret 包中的 create_model 函数建立模型，可以使用下面的代码相应地修改参数。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="1014" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用 assign_model 函数查找 ABOD 分数和标签。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/910e50dad0101ea36239c5c3ac6a1e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*HmwJCNrrcBAiCCHKm92xmg.png"/></div></figure><p id="74a1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">评估:</strong></p><p id="7145" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">基于角度的异常值检测的 ROC_AUC 是 0.777。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/938a00ad5c40a76166a73ddd54255c11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*lFHELZVjffDdx1eFWNdO_A.png"/></div></figure><p id="0ef4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 3。子空间离群点检测:</strong></p><p id="1732" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi le translated"><span class="l lf lg lh bm li lj lk ll lm di">t</span><strong class="kk iu"/>子空间离群值通过寻找低维空间中具有异常低 density⁹.的数据的局部区域来识别</p><p id="2393" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">建立模型:</strong></p><p id="b9c2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用 pycaret 包中的 create_model 函数建立模型，可以使用下面的代码相应地修改参数。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="8942" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用 assign_model 函数查找 SOD 分数和标签。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/420f7644b149dd7e55ef563d4a290621.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*_dZ5kl7DxL1jKMNO_U5o6g.png"/></div></figure><p id="8909" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">评价:</strong></p><p id="ac7f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">子空间离群点检测<strong class="kk iu"> </strong>的 ROC_AUC 为 0.942。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/6c8427da040122f1ade0e7b0ff98977b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*kbxhm64VaQ9sEA1yZXEvDA.png"/></div></figure><p id="38e2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu"> 4。最小协方差行列式:</strong></p><p id="86ef" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这是发现异常值的最稳健的方法之一，它考虑使用称为 MCD 估计量的稳健估计量。这说明了掩蔽效应:经典估计值会受到污染的强烈影响，以至于诊断工具(如马氏距离)无法检测异常值⁰.由于稳健距离对掩蔽效应不敏感，因此它们可用于标记异常值。</p><p id="ca3f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">建立模型:</strong></p><p id="3822" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以使用 pycaret 包中的 create_model 函数建立模型，可以使用下面的代码相应地修改参数。</p><figure class="lp lq lr ls gt lt"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="f55c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">使用 assign_model 函数查找 MCD 异常分数和标签。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/0e51cdea480b7a83db09a911acd53ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*JHBJlUvU79f3MJhwjcEjNw.png"/></div></figure><p id="1f9e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">评价:</strong></p><p id="0c5c" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最小协方差行列式异常值检测的 ROC_AUC 为 0.906。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/b14e63ec8a996a46b4a9c4478ae2dd32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*4ysDrzlIYr_YQThMArdWiw.png"/></div></figure><h1 id="d876" class="nw ml it bd mq nx ny nz mt oa ob oc mw jz od ka mz kc oe kd nc kf of kg nf og bi translated"><strong class="ak">比较结果:</strong></h1><p id="6d2f" class="pw-post-body-paragraph ki kj it kk b kl nh ju kn ko ni jx kq kr nj kt ku kv nk kx ky kz nl lb lc ld im bi translated">从这个 kaggle 信用欺诈检测数据集的所有四种异常检测技术中，我们看到，根据 ROC_AUC，子空间异常检测相对给出更好的结果。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/2d898f0d08ca8489fcd7b1dc638e6c56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*bwmzK8rT1Km1VaPeGwiowA.gif"/></div><p class="ma mb gj gh gi mc md bd b be z dk translated">子空间异常值检测的异常值的 3d TSNE 图(黄色欺诈，蓝色正常)</p></figure><p id="a053" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">请从这个<a class="ae ln" href="https://colab.research.google.com/drive/1tlW9QZwJSYD1OCWt8lWTimfDw_EcKuP7#scrollTo=hI9a8EOzTRN1" rel="noopener ugc nofollow" target="_blank"> <strong class="kk iu"> colab </strong> </a> <strong class="kk iu">查看这些异常检测技术的详细代码。</strong></p><h1 id="7852" class="nw ml it bd mq nx ny nz mt oa ob oc mw jz od ka mz kc oe kd nc kf of kg nf og bi translated">结论:</h1><p id="d245" class="pw-post-body-paragraph ki kj it kk b kl nh ju kn ko ni jx kq kr nj kt ku kv nk kx ky kz nl lb lc ld im bi translated">大多数银行和支付服务使用不同的异常评分方法，要么使用一个异常评分，要么对某些异常评分技术的分级异常评分进行平均，以确保不丢失任何欺诈交易。</p><h1 id="ad39" class="nw ml it bd mq nx ny nz mt oa ob oc mw jz od ka mz kc oe kd nc kf of kg nf og bi translated">参考资料:</h1><ol class=""><li id="99a3" class="oi oj it kk b kl nh ko ni kr ok kv ol kz om ld on oo op oq bi translated"><a class="ae ln" href="https://www.creditcards.com/credit-card-news/market-share-statistics.php" rel="noopener ugc nofollow" target="_blank">按年份统计的信用卡统计</a>。</li><li id="a346" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated"><a class="ae ln" href="https://www.fool.com/the-ascent/research/identity-theft-credit-card-fraud-statistics/" rel="noopener ugc nofollow" target="_blank">信用卡报表统计</a>。</li><li id="edfa" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated"><a class="ae ln" href="https://books.google.be/books?id=8ZWfDwAAQBAJ&amp;pg=PA335&amp;lpg=PA335&amp;dq=An+Anomaly+is+something+that+deviates+from+what+is+normal+or+expected.+In+credit+card+transactions,+mostly+fraudulent+cases+are+deviates+from+what+behavior+of+a+normal+transaction&amp;source=bl&amp;ots=_6T1OTpqPF&amp;sig=ACfU3U1CNJOxUbokON2aVNrU2UIIdEnF0g&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwjMvv26n5PpAhVICewKHZVADfsQ6AEwAHoECAoQAQ#v=onepage&amp;q=An%20Anomaly%20is%20something%20that%20deviates%20from%20what%20is%20normal%20or%20expected.%20In%20credit%20card%20transactions%2C%20mostly%20fraudulent%20cases%20are%20deviates%20from%20what%20behavior%20of%20a%20normal%20transaction&amp;f=false" rel="noopener ugc nofollow" target="_blank">人工智能的进展和趋势</a>。</li><li id="db24" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated"><a class="ae ln" href="https://www.kaggle.com/mlg-ulb/creditcardfraud" rel="noopener ugc nofollow" target="_blank"> kaggle 信用卡欺诈检测</a>。</li><li id="e4b2" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated"><a class="ae ln" href="https://pycaret.org/" rel="noopener ugc nofollow" target="_blank"> pycaret </a></li><li id="8754" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated"><a class="ae ln" href="https://www.researchgate.net/publication/224384174_Isolation_Forest" rel="noopener ugc nofollow" target="_blank">隔离林研究论文</a>。</li><li id="dcf1" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated">pycaret assign_model 。</li><li id="21ed" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated"><a class="ae ln" href="https://www.researchgate.net/publication/221653435_Angle-based_outlier_detection_in_high-dimensional_data" rel="noopener ugc nofollow" target="_blank">基于角度的离群点检测研究论文</a>。</li><li id="3dfb" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated"><a class="ae ln" href="https://link.springer.com/chapter/10.1007/978-3-642-03547-0_15" rel="noopener ugc nofollow" target="_blank">子空间离群点检测研究论文</a>。</li><li id="8876" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated"><a class="ae ln" href="https://arxiv.org/pdf/1707.09752.pdf" rel="noopener ugc nofollow" target="_blank">稳健统计异常检测</a>。</li><li id="4ffe" class="oi oj it kk b kl or ko os kr ot kv ou kz ov ld on oo op oq bi translated"><a class="ae ln" href="https://www.jstor.org/stable/1270566?seq=1#metadata_info_tab_contents" rel="noopener ugc nofollow" target="_blank">最小协方差行列式估计量的快速算法</a>。</li></ol></div></div>    
</body>
</html>