<html>
<head>
<title>R and Leaflet to create interactive choropleth maps.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">r 和传单来创建交互式 choropleth 地图。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/r-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275?source=collection_archive---------33-----------------------#2020-07-24">https://towardsdatascience.com/r-and-leaflet-to-create-interactive-choropleth-maps-8515ef83e275?source=collection_archive---------33-----------------------#2020-07-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e689" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">地理可视化选举数据</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d696244821f12072e5781e2e7f875e9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6dZ7MgjgUGBwCgy3"/></div></div><p class="kr ks gj gh gi kt ku bd b be z dk translated">照片由<a class="ae kv" href="https://unsplash.com/@marjan_blan?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">марьянблан| @ marjanblan</a>在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></p></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="fb4c" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在我开始之前，这里是 Github 页面上完整交互版主机的链接。</p><div class="lz ma gp gr mb mc"><a href="https://ejooco.github.io/MapStats.github.io/" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">用传单创建交互式地图</h2><div class="mj l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">ejooco.github.io</p></div></div></div></a></div><p id="a536" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我先说:这不是一篇关于冠状病毒的文章。</p><p id="8573" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">尽管新冠肺炎是世界上的一个大事件，它实际上对数据科学家来说是迷人的，特别是数据可视化。这可能激励了很多人进入这个行业。</p><p id="46d0" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在未来几十年，我想象大学和在线课程将使用新冠肺炎数据集来教授数据收集、辩论、可视化、建模等。</p><p id="2a7f" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">但在此之前，真正的数据之王可以说是政治，因此在这里我将向数据可视化的前任统治者致敬，并一步步地向您介绍如何使用 R Studio 和传单库构建交互式 choropleth 地图来显示选举结果。</p><p id="af9c" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">让我们开始吧！</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="6601" class="mk ml iq bd mm mn mo mp mq mr ms mt mu jw mv jx mw jz mx ka my kc mz kd na nb bi translated"><strong class="ak">加载项目的库</strong></h1><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="b7ef" class="nh ml iq nd b gy ni nj l nk nl"><strong class="nd ir">library</strong>(rgeos)<br/><strong class="nd ir">library</strong>(maptools)<br/><strong class="nd ir">library</strong>(leaflet)</span></pre><h1 id="959e" class="mk ml iq bd mm mn nm mp mq mr nn mt mu jw no jx mw jz np ka my kc nq kd na nb bi translated"><strong class="ak">数据</strong></h1><p id="0ff6" class="pw-post-body-paragraph ld le iq lf b lg nr jr li lj ns ju ll lm nt lo lp lq nu ls lt lu nv lw lx ly ij bi translated">我们需要两组不同的数据。一个用于映射几何图形，一个用于选举结果。</p><p id="67ae" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我使用的数据来自澳大利亚选举委员会，可以在这里找到:</p><div class="lz ma gp gr mb mc"><a href="https://aec.gov.au/Electorates/gis/gis_datadownload.htm" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">联邦选举边界地理信息系统数据免费下载</h2><div class="nw l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">虽然我们已尽力确保本产品中数据的准确性，但数据的所有者(包括…</h3></div><div class="mj l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">aec.gov.au</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc kp mc"/></div></div></a></div><div class="lz ma gp gr mb mc"><a href="https://results.aec.gov.au/24310/Website/HouseDivisionalResults-24310.htm" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">部门结果</h2><div class="nw l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">此表允许您按名称搜索分部。此表可通过选择列标题进行排序，您可以…</h3></div><div class="mj l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">results.aec.gov.au</p></div></div><div class="nx l"><div class="od l nz oa ob nx oc kp mc"/></div></div></a></div><h1 id="66d5" class="mk ml iq bd mm mn nm mp mq mr nn mt mu jw no jx mw jz np ka my kc nq kd na nb bi translated">绘制形状文件</h1><p id="30eb" class="pw-post-body-paragraph ld le iq lf b lg nr jr li lj ns ju ll lm nt lo lp lq nu ls lt lu nv lw lx ly ij bi translated">使用 maptools 包中的 readShapeSpatial()，我们将形状文件作为它自己需要的参数传入，并将其赋给一个变量。使用 plot()函数来查看它的外观。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="7270" class="nh ml iq nd b gy ni nj l nk nl">vicmapdata &lt;- readShapeSpatial(".\\vic-july-2018-esri\\E_AUGFN3_region.shp")<br/>plot(vicmapdata)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/f10d94179d01da46f01b15e8a1305b09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aJUt6WAun19BkY9202iYDA.png"/></div></div></figure><p id="e0f9" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">读取选举数据并将其传递给一个变量</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="5ccf" class="nh ml iq nd b gy ni nj l nk nl">electiondata &lt;- read.csv(".\\vic_elect_results.csv")</span></pre><h1 id="e10a" class="mk ml iq bd mm mn nm mp mq mr nn mt mu jw no jx mw jz np ka my kc nq kd na nb bi translated">数据争论</h1><p id="d426" class="pw-post-body-paragraph ld le iq lf b lg nr jr li lj ns ju ll lm nt lo lp lq nu ls lt lu nv lw lx ly ij bi translated">首先，我们来看看数据的结构</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="8bc1" class="nh ml iq nd b gy ni nj l nk nl">summary(electiondata)</span><span id="47f0" class="nh ml iq nd b gy of nj l nk nl">##      Division  State                  Successful.Party   TCP.Margin<br/>##  Aston   : 1   VIC:38   Australian Labor Party:21      1,090  : 1  <br/>##  Ballarat: 1            Independent           : 1      10,934 : 1  <br/>##  Bendigo : 1            Liberal               :12      11,289 : 1  <br/>##  Bruce   : 1            The Greens            : 1      11,326 : 1  <br/>##  Calwell : 1            The Nationals         : 3      12,134 : 1  <br/>##  Casey   : 1                                           12,453 : 1  <br/>##  (Other) :32                                           (Other):32</span></pre><p id="01ef" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">首先，我不喜欢变量的名字。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="8c4d" class="nh ml iq nd b gy ni nj l nk nl">colnames(electiondata) &lt;- c("Divisions", "State", "Party", "Marginal Votes")</span><span id="96e3" class="nh ml iq nd b gy of nj l nk nl">summary(electiondata)</span><span id="6533" class="nh ml iq nd b gy of nj l nk nl">##     Divisions  State                       Party    Marginal Votes<br/>##  Aston   : 1   VIC:38   Australian Labor Party:21   1,090  : 1    <br/>##  Ballarat: 1            Independent           : 1   10,934 : 1    <br/>##  Bendigo : 1            Liberal               :12   11,289 : 1    <br/>##  Bruce   : 1            The Greens            : 1   11,326 : 1    <br/>##  Calwell : 1            The Nationals         : 3   12,134 : 1    <br/>##  Casey   : 1                                        12,453 : 1    <br/>##  (Other) :32                                        (Other):32</span></pre><p id="5778" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">这看起来更好接下来，我们将查看 shapefile 数据中的部门名称。这一点很重要，因为 electiondata 部分必须精确地映射到 shapefile 部分</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="d412" class="nh ml iq nd b gy ni nj l nk nl">summary(vicmapdata)</span><span id="8909" class="nh ml iq nd b gy of nj l nk nl">## Object of class SpatialPolygonsDataFrame<br/>## Coordinates:<br/>##         min       max<br/>## x 140.96168 149.97668<br/>## y -39.15919 -33.98043<br/>## Is projected: NA <br/>## proj4string : [NA]<br/>## Data attributes:<br/>##    E_div_numb       <strong class="nd ir"><em class="og">Elect_div</em> </strong>    Numccds          Actual      <br/>##  Min.   : 1.00   <strong class="nd ir">Aston   : 1</strong>   Min.   :267.0   Min.   :100151  <br/>##  1st Qu.:10.25   <strong class="nd ir">Ballarat: 1</strong>   1st Qu.:337.5   1st Qu.:105494  <br/>##  Median :19.50   <strong class="nd ir">Bendigo : 1</strong>   Median :354.0   Median :107416  <br/>##  Mean   :19.50   <strong class="nd ir">Bruce   : 1</strong>   Mean   :359.1   Mean   :106954  <br/>##  3rd Qu.:28.75   <strong class="nd ir">Calwell : 1</strong>   3rd Qu.:387.0   3rd Qu.:109115  <br/>##  Max.   :38.00   <strong class="nd ir">Casey   : 1</strong>   Max.   :467.0   Max.   :112265  <br/>##                  (Other) :32                                   <br/>##    Projected        Total_Popu   Australian   Area_SqKm            Sortname <br/>##  Min.   :107381   Min.   :0    Min.   :0    Min.   :   40.46   Aston   : 1  <br/>##  1st Qu.:109070   1st Qu.:0    1st Qu.:0    1st Qu.:   80.59   Ballarat: 1  <br/>##  Median :109986   Median :0    Median :0    Median :  170.28   Bendigo : 1  <br/>##  Mean   :110372   Mean   :0    Mean   :0    Mean   : 5987.93   Bruce   : 1  <br/>##  3rd Qu.:111484   3rd Qu.:0    3rd Qu.:0    3rd Qu.: 2619.61   Calwell : 1  <br/>##  Max.   :113924   Max.   :0    Max.   :0    Max.   :81962.21   Casey   : 1  <br/>##                                                                (Other) :32</span></pre><p id="9856" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">看起来 shapefile 中的分区在变量 Elect_div 下</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="1779" class="nh ml iq nd b gy ni nj l nk nl">vicmapdata$Elect_div</span><span id="387d" class="nh ml iq nd b gy of nj l nk nl">##  [1] Aston       Ballarat    Bendigo     Bruce       Calwell     Casey      <br/>##  [7] Chisholm    Cooper      Corangamite Corio       Deakin      Dunkley    <br/>## [13] Flinders    Fraser      Gellibrand  Gippsland   Goldstein   Gorton     <br/>## [19] Higgins     Holt        Hotham      Indi        Isaacs      Jagajaga   <br/>## [25] Kooyong     La Trobe    Lalor       Macnamara   Mallee      Maribyrnong<br/>## [31] Mcewen      Melbourne   Menzies     Monash      Nicholls    Scullin    <br/>## [37] Wannon      Wills      <br/>## 38 Levels: Aston Ballarat Bendigo Bruce Calwell Casey Chisholm ... Wills</span></pre><p id="4611" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">到目前为止一切顺利。election data＄Divisions 和 vicmapdata＄Elect _ div 都有 38 个级别，这是一个好的开始。我们可以在这种规模下手动检查它们，但如果我们检查整个国家，或者一个更大的国家呢？我们需要明智地做这件事，并让 R 为我们做这些繁重的工作。</p><p id="b4c8" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">两个数据集中的名称必须完全匹配，这样两个数据集才能正确映射。</strong></p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="b6a6" class="nh ml iq nd b gy ni nj l nk nl">setdiff(electiondata$Division, vicmapdata$Elect_div)</span><span id="652c" class="nh ml iq nd b gy of nj l nk nl">## [1] "McEwen"</span></pre><p id="f5cb" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们确实有矛盾。它告诉我们“McEwen”在第一个向量中，但不在第二个向量中。我们先找出第一个向量中“McEwen”的位置，看看第二个向量中对应的位置是什么。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="f4b0" class="nh ml iq nd b gy ni nj l nk nl">which(electiondata$Division=="McEwen")</span><span id="1510" class="nh ml iq nd b gy of nj l nk nl">## [1] 31</span></pre><p id="a867" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">所以在 31 号位置。另一个向量的 31 号位置是什么？</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="ebd9" class="nh ml iq nd b gy ni nj l nk nl">vicmapdata$Elect_div[31]</span><span id="7f25" class="nh ml iq nd b gy of nj l nk nl">## [1] Mcewen<br/>## 38 Levels: Aston Ballarat Bendigo Bruce Calwell Casey Chisholm ... Wills</span></pre><p id="7c98" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">好的，它很小，但是第一个向量有一个 E，第二个向量有一个 E。为了留在代码中，并且不必手动修复(记住这需要可伸缩)，我们将把数据从一个向量映射到另一个向量(现在我们知道其他一切都是相同的)</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="026d" class="nh ml iq nd b gy ni nj l nk nl">vicmapdata$Elect_div &lt;- electiondata$Divisions</span></pre><p id="15ac" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在，让我们像以前一样进行检查，以确保值匹配</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="4ee3" class="nh ml iq nd b gy ni nj l nk nl">setdiff(electiondata$Division, vicmapdata$Elect_div)</span><span id="05d1" class="nh ml iq nd b gy of nj l nk nl">## character(0)</span></pre><p id="d110" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">那更好！</p><h1 id="6d92" class="mk ml iq bd mm mn nm mp mq mr nn mt mu jw no jx mw jz np ka my kc nq kd na nb bi translated">创造视觉效果</h1><p id="4183" class="pw-post-body-paragraph ld le iq lf b lg nr jr li lj ns ju ll lm nt lo lp lq nu ls lt lu nv lw lx ly ij bi translated">有趣的部分来了！我们将使用传单，而不是我们上面使用的绘图功能。我们会把我们的“受害者地图数据”传给它。当我们设置 stroke=True 时，addPolygons 将为我们绘制边界。我们将使用 1.5 粗细的白线</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="75e5" class="nh ml iq nd b gy ni nj l nk nl">leaflet(vicmapdata) %&gt;%<br/>  addPolygons(<br/>    stroke = TRUE, <br/>    color = 'White', <br/>    weight = 1.5, <br/>    )</span></pre><p id="d5c5" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">(点击页面顶部的链接查看互动版)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/2d90ce85686f56c01e02bc6e3ebdf0b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*8z3gW_tncrynpxnRKBWs_g.png"/></div></figure><p id="d8d0" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">此时，我们有两个数据变量。1 用于映射数据，我们刚才已经演示过了。现在，我们需要将我们的选举数据映射到绘图上。</p><p id="0741" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">首先，我们将创建标签。这意味着当我们将鼠标悬停在某个选民上时，它会告诉我们相关的统计数据。我们使用一些 HTML 工具来格式化渲染后的图形。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="8188" class="nh ml iq nd b gy ni nj l nk nl">mylabels &lt;- paste(<br/>  "Electorate: ", vicmapdata$Elect_div, "&lt;br/&gt;",<br/>  "Party: ", electiondata$Party, "&lt;br/&gt;",<br/>  "Margin(votes): ", electiondata$`Marginal Votes`<br/>) %&gt;%<br/>  lapply(htmltools::HTML)</span></pre><p id="cea7" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在，我们将把 mylabels 变量插入到之前的传单代码块中</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="e55b" class="nh ml iq nd b gy ni nj l nk nl">leaflet(vicmapdata) %&gt;%<br/>  addPolygons(<br/>    stroke = TRUE, <br/>    color = 'White', <br/>    weight = 1.5, <br/>    label = mylabels,<br/>    labelOptions = labelOptions( <br/>      style = list("font-weight" = "normal", padding = "3px 8px"), <br/>      textsize = "13px", <br/>      direction = "auto"<br/>    )<br/>    )</span></pre><p id="8bdb" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">(点击页面顶部的链接查看互动版)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/1b29f7d48f0f3586110feadf04ac1da2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*6aE1YcPji64OOpp0G85Yug.png"/></div></figure><p id="64c0" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">到目前为止一切顺利。现在我们将添加一些颜色。我创建了一个名为 factpal(因子调色板)的变量。我们使用传单库中的 colorFactor 函数。topo.colors(5)告诉该函数，我们需要 topo.colors 调色板中的 5 种颜色，unique()允许我们将一种颜色分配到特定级别。在这种情况下，我们希望同一个获胜政党的所有选民都被分配相同的颜色。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="0d77" class="nh ml iq nd b gy ni nj l nk nl">factpal &lt;- colorFactor(topo.colors(5), unique(electiondata$Party))</span></pre><p id="ebf5" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在我们将 factpal 函数插入到传单代码块中</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="94fa" class="nh ml iq nd b gy ni nj l nk nl">leaflet(vicmapdata) %&gt;%<br/>  addPolygons(<br/>    fillColor = ~factpal(electiondata$Party), <br/>    stroke = TRUE, <br/>    color = 'White', <br/>    weight = 1.5, <br/>    label = mylabels,<br/>    labelOptions = labelOptions( <br/>      style = list("font-weight" = "normal", padding = "3px 8px"), <br/>      textsize = "13px", <br/>      direction = "auto"<br/>    )<br/>    )</span></pre><p id="f008" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">(点击页面顶部的链接查看互动版)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/199f2e697c5df550e5487b64e269f920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*XXOy4vYxSMwjm8DZAckXYw.png"/></div></figure><p id="ba91" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">看起来更好了</p><p id="a44d" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">从这里开始，我们只需要添加一些文本和一个图例。</p><p id="4f73" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">文本:我们需要一个标题和一些数据的参考链接</p><p id="24f5" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">图例:哪些颜色等同于哪个政党</p><p id="bbb2" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">下面是文本标签的代码。我们本质上只是在 HTML 中进食</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="e16a" class="nh ml iq nd b gy ni nj l nk nl">htmltitle &lt;- "&lt;h5&gt; How Victoria voted in the 2019 Federal Election | House of Representatives&lt;/h5&gt;"</span><span id="c560" class="nh ml iq nd b gy of nj l nk nl">references &lt;- "&lt;h5&gt;References&lt;/h5&gt;&lt;a target='_blank' href='https://results.aec.gov.au/24310/Website/HouseDivisionalResults-24310.htm'&gt;&lt;h5&gt;Election Data&lt;/h5&gt;&lt;/a&gt;&lt;a target='_blank' href='https://aec.gov.au/Electorates/gis/gis_datadownload.htm'&gt;&lt;h5&gt;Geometric Data&lt;/h5&gt;&lt;/a&gt;"</span></pre><p id="ce5e" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在，我们只需插入上面的标题和参考数据，并在 addLegend 函数下添加图例，如下图所示。</p><pre class="kg kh ki kj gt nc nd ne nf aw ng bi"><span id="b4c7" class="nh ml iq nd b gy ni nj l nk nl">leaflet(vicmapdata) %&gt;%<br/>  addPolygons(<br/>    fillColor = ~factpal(electiondata$Party), <br/>    stroke = TRUE, <br/>    color = 'White', <br/>    weight = 1.5, <br/>    label = mylabels,<br/>    labelOptions = labelOptions( <br/>      style = list("font-weight" = "normal", padding = "3px 8px"), <br/>      textsize = "13px", <br/>      direction = "auto"<br/>    )<br/>    ) %&gt;%<br/>  addLegend( pal=factpal, <br/>             values=~electiondata$Party, <br/>             opacity=0.3, <br/>             title = "Political Party", <br/>             position = "bottomleft" <br/>             ) %&gt;%<br/>  addControl(html=htmltitle, position = "topright") %&gt;%<br/>  addControl(html=references, position = "bottomright")</span></pre><p id="4faf" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">(点击页面顶部的链接查看互动版)</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/a1126aa6bb0e62634a4dfd9ffa2ca92e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*z1Ujycx2V3dkUdQxRYzI8g.png"/></div></div></figure><h1 id="65ef" class="mk ml iq bd mm mn nm mp mq mr nn mt mu jw no jx mw jz np ka my kc nq kd na nb bi translated">可能的延续</h1><ol class=""><li id="3a44" class="ol om iq lf b lg nr lj ns lm on lq oo lu op ly oq or os ot bi translated">添加时间刻度以显示选举结果随时间的变化</li><li id="97ab" class="ol om iq lf b lg ou lj ov lm ow lq ox lu oy ly oq or os ot bi translated">创建另一个视觉效果来查看哪些选民易手了</li><li id="6170" class="ol om iq lf b lg ou lj ov lm ow lq ox lu oy ly oq or os ot bi translated">扩大到整个澳大利亚</li></ol><h1 id="95d6" class="mk ml iq bd mm mn nm mp mq mr nn mt mu jw no jx mw jz np ka my kc nq kd na nb bi translated">如果你正在读这封信，说明你已经看完了</h1><p id="79da" class="pw-post-body-paragraph ld le iq lf b lg nr jr li lj ns ju ll lm nt lo lp lq nu ls lt lu nv lw lx ly ij bi translated">感谢您的阅读。云中见。</p><p id="1a59" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">埃蒙</p><p id="bd2d" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">推特@ejooco</p><p id="9f5d" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">https://github.com/ejooco</p></div></div>    
</body>
</html>