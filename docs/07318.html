<html>
<head>
<title>Pandas Sidetable Just Announced</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">熊猫侧桌刚刚宣布</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/pandas-sidetable-just-announced-708e5f65938f?source=collection_archive---------14-----------------------#2020-06-03">https://towardsdatascience.com/pandas-sidetable-just-announced-708e5f65938f?source=collection_archive---------14-----------------------#2020-06-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cdfe" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">对数据框架的信息丰富、见解深刻的概述。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0a5d9c6f7ef6ecd0294f1b1d0f308f4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hwzFGsryDyF0E0Ji.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@markusspiske?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae ky" href="https://unsplash.com/s/photos/different-colors?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</p></figure><p id="f87c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Pandas 是一个非常强大和通用的 Python 数据分析库，它加速了数据科学项目的预处理步骤。它提供了许多在数据分析中非常有用的函数和方法。</p><p id="e21f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">虽然熊猫的内置功能能够执行有效的数据分析，但定制的功能或库为熊猫增加了价值。在本帖中，我们将探究其中一个附加组件。</p><p id="512d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">昨天，克里斯·莫菲特宣布了一个新的名为<strong class="lb iu"> sidetable </strong>的熊猫实用程序库。这里是 sidetable 的<a class="ae ky" href="https://github.com/chris1610/sidetable" rel="noopener ugc nofollow" target="_blank"> github repo </a>。我发现它非常有用，并计划在我的日常分析中应用。这就是为什么我想通过一些例子来分享和传播这个词。</p><p id="ed94" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Sidetable 基于选定的列创建频率表。假设我们有一个数据集，其中包含某个分类变量的一些测量值(例如模型)。我们有许多不同的模型，每个模型都有许多观察值(行)。通过使用 sidetable，我们可以得到一个概览，显示每个模型在数据集中所占的份额。这也可以使用 pandas 的<code class="fe lv lw lx ly b"><strong class="lb iu">value_counts</strong></code>功能来实现，但是 sidetable 提供的信息更多，我们将在示例中看到。</p><p id="7291" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果你使用 jupyter 笔记本，我们首先需要用<code class="fe lv lw lx ly b">pip</code>或<code class="fe lv lw lx ly b">!pip</code>安装它:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="6c06" class="md me it ly b gy mf mg l mh mi">!pip install sidetable</span></pre><p id="4282" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后导入它:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="bfc9" class="md me it ly b gy mf mg l mh mi">import pandas as pd<br/>import sidetable</span></pre><p id="2303" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们现在可以使用<strong class="lb iu"> stb </strong>作为数据帧的存取器。我将使用 kaggle 上可用的美国汽车数据集。它包含了拍卖的二手车的数据。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="cd77" class="md me it ly b gy mf mg l mh mi">df = pd.read_csv("/content/USA_cars_datasets.csv")</span><span id="a9cd" class="md me it ly b gy mj mg l mh mi">#drop redundant columns<br/>df.drop(['Unnamed: 0','vin','lot'], axis=1, inplace=True)</span><span id="0ae4" class="md me it ly b gy mj mg l mh mi">df.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mk"><img src="../Images/502a50a8a18b725450c980a2f9d335ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NEFlVRuLvYAZMxKTr5_NwQ.png"/></div></div></figure><p id="f7fe" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可能想看看主导品牌是什么。一种方法是使用<code class="fe lv lw lx ly b">value_counts</code>功能。数据集中出现次数最多的 10 个品牌:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="96a8" class="md me it ly b gy mf mg l mh mi">df.brand.value_counts()[:10]</span><span id="2838" class="md me it ly b gy mj mg l mh mi">ford         1235 <br/>dodge         432 <br/>nissan        312 <br/>chevrolet     297 <br/>gmc            42 <br/>jeep           30 <br/>chrysler       18 <br/>bmw            17 <br/>hyundai        15 <br/>kia            13 </span><span id="adee" class="md me it ly b gy mj mg l mh mi">Name: brand, dtype: int64</span></pre><p id="f853" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以通过使用归一化参数来获得频率比:</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="6b29" class="md me it ly b gy mf mg l mh mi">df.brand.value_counts(normalize=True)[:10]</span><span id="4996" class="md me it ly b gy mj mg l mh mi">ford         0.494198 <br/>dodge        0.172869 <br/>nissan       0.124850 <br/>chevrolet    0.118848 <br/>gmc          0.016807 <br/>jeep         0.012005 <br/>chrysler     0.007203 <br/>bmw          0.006803 <br/>hyundai      0.006002 <br/>kia          0.005202 </span><span id="952d" class="md me it ly b gy mj mg l mh mi">Name: brand, dtype: float64</span></pre><p id="d398" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据集中几乎 50%的汽车都是福特的。这比只看到计数更能提供信息。Sidetable 更进了一步。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="8e60" class="md me it ly b gy mf mg l mh mi">df.stb.freq(['brand'])[:10]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ml"><img src="../Images/d946a0145abb1d035da46188e01e6ba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*Mutf983-zy0oR8mdpVwifg.png"/></div></div></figure><p id="8ee9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu"> Sidetable </strong>返回每个品牌的计数和百分比以及累计值。肯定比<code class="fe lv lw lx ly b"><strong class="lb iu">value_counts</strong></code>信息量大。我们对数据集中的分布有了更多的了解。累积值的一个额外特性是我们可以设置累积百分比的阈值。然后，达到阈值后的类别被标记为“其他”。我们也可以使用<strong class="lb iu"> other_label </strong>参数为“其他”指定一个标签。例如，我们可能希望看到构成数据集 90%的品牌。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="2013" class="md me it ly b gy mf mg l mh mi">df.stb.freq(['brand'], thresh=.9, other_label='other brands')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/36ed2337de17eaa117f138333fdf8b50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*LFb6HPMlFWvNO597FPUrQg.png"/></div></div></figure><p id="e32b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以通过多列，看到更具体的分布。让我们看看数据集中排名靠前的品牌年份组合。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="d9eb" class="md me it ly b gy mf mg l mh mi">df.stb.freq(['brand','year'], thresh=.5)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/abee46fbc2c24c7ac34c1ba24473a81f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*5btGv9ypS3SngT2AIZ9-Iw.png"/></div></figure><p id="e198" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">福特以 50%的份额在数据集中占据主导地位。大多数福特汽车都是 2019 款，占整个数据集的 19%。请注意，19%表示整个数据集中的比率，而不仅仅是福特品牌中的比率。为了获得福特品牌的分布情况，我们可以对数据帧应用过滤器。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="3f63" class="md me it ly b gy mf mg l mh mi">df[df.brand == 'ford'].stb.freq(['year'], thresh=.9)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/a6d3b5e5b188ec67196c308f925b3392.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*XN2sZ5XHGBSbVxfUQGtAXw.png"/></div></figure><p id="9a87" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，2019 款福特汽车占所有福特品牌汽车的 38%。回想一下前面的例子，2019 款福特汽车占据了整个数据集的 19%。</p><p id="1efd" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">sidetable 的另一个有用特性是它提供了基于值的分布。例如，我们可以检查每个品牌汽车的总价。要聚合的列被传递给<strong class="lb iu">值</strong>参数。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="e0cb" class="md me it ly b gy mf mg l mh mi">df.stb.freq(['brand'], value='price', thresh=.95)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/ba38fd8076b2012cdf9f1b04ef929977.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*c_JO0xOWTS4RQGdmj8NrWw.png"/></div></figure><p id="8d44" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">数据集中福特汽车的总价超过 2600 万，占所有汽车总价的 57%。回想一下前面的例子，数据集中 49%的汽车是福特品牌的。就总价而言，这一比例上升至 57%，表明福特汽车的平均价格高于其他品牌的平均价格。当然，还有其他因素会对价格产生影响，比如年份、里程、所有权状况等等。但是，它提供了一个一般的洞察力。</p><p id="307d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">如果值的格式看起来不吸引人，可以使用<strong class="lb iu">样式</strong>参数进行更改。</p><pre class="kj kk kl km gt lz ly ma mb aw mc bi"><span id="71b6" class="md me it ly b gy mf mg l mh mi">df.stb.freq(['brand'], value='price', thresh=.95, style=True)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/545178820c7ca21719376ba1e0307168.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*RPWEA_sMfcZm_czx-VfAtg.png"/></div></div></figure></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><p id="edc4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我认为熊猫的成功和流行来自于其多功能、强大且易于使用的操作和分析数据的功能。和熊猫一起完成一项任务几乎总是有多种方式。熊猫上添加的定制实用程序库优化了某些操作，并为熊猫带来了更多价值。再次感谢<a class="ae ky" href="https://twitter.com/chris1610" rel="noopener ugc nofollow" target="_blank">克里斯·莫菲特</a>提供的这个有价值的工具。</p><p id="bf41" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由于花在数据科学项目上的大部分时间都花在了数据清理和预处理步骤上，Pandas 是您武库中的宝贵资产。</p><p id="cd5e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢您的阅读。如果您有任何反馈，请告诉我。</p></div></div>    
</body>
</html>