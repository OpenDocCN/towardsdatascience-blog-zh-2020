<html>
<head>
<title>How to create an Ethereum DeFi realtime dashboard</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建以太坊定义实时仪表板</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-a-ethereum-defi-realtime-dashboard-a60c23b527f7?source=collection_archive---------25-----------------------#2020-07-26">https://towardsdatascience.com/how-to-create-a-ethereum-defi-realtime-dashboard-a60c23b527f7?source=collection_archive---------25-----------------------#2020-07-26</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="61c9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用图形和谷歌电子表格来存储数据，并使用谷歌数据工作室创建一个实时仪表板</h2></div><p id="31b8" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">获取区块链数据越来越容易，速度也越来越快。在本帖中，我们将看到如何从 DeFi(分散金融)协议中提取数据，用 Google 电子表格创建数据集。有了它，我们将创建一个仪表板，实时显示这些数据，为我们提供 Aave 协议中请求的贷款信息。</p><h1 id="ac76" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated"><strong class="ak">获取数据</strong></h1><p id="14a8" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">为了获得数据，我们将使用图形的 Api，如<a class="ae mb" href="https://medium.com/coinmonks/defi-protocol-data-how-to-query-618c934dbbe2" rel="noopener">这篇文章中所解释的。</a></p><p id="8fad" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们要提取的是与所请求的贷款相关的数据，所有的历史记录，以便能够在以后进行分析。为此，我们必须创建如下所示的查询:</p><pre class="mc md me mf gt mg mh mi mj aw mk bi"><span id="4a2d" class="ml lf it mh b gy mm mn l mo mp">{<br/>  borrows (first: 1000) {<br/>    id,<br/>    amount,<br/>    reserve {<br/>      id,<br/>      symbol<br/>    },<br/>    borrowRate,<br/>    borrowRateMode,<br/>    timestamp<br/>   }<br/>}</span></pre><p id="2e05" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过这个查询，我们获得了前 1000 个结果，这是图形在一个数据块中允许的最大值，然后我们将继续迭代以获得以下结果，直到我们恢复所有结果。</p><p id="0720" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果我们在<a class="ae mb" href="https://thegraph.com/explorer/subgraph/aave/protocol-raw" rel="noopener ugc nofollow" target="_blank">这个游乐场</a>测试这个查询，我们看到它返回:</p><figure class="mc md me mf gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mq"><img src="../Images/1bdbfd1c4a2ee40695d4431b954e998a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*B3ORNllzTbj1p48i"/></div></div></figure><p id="070d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">之后，我们将获得所有贷款的数据，包括请求的加密资产、金额、利息和利率。通过将这些数据直接导入到 Google Sheets 的文档中，我们将拥有一个实时数据集来构建我们的分析模型。</p><h1 id="de3b" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated"><strong class="ak">创建数据集</strong></h1><p id="0d99" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">为了将数据保存在 Google excel 表中，我们将在其中创建一个脚本，选项为:</p><figure class="mc md me mf gt mr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/b6ef3b9828e857009fc4e460a997a577.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*nARgu9SiNWVIMG1Rk4fYrQ.png"/></div></figure><p id="993f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个脚本中，我们包含了以下代码:</p><figure class="mc md me mf gt mr"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="37a0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">让我们来看看每一行的细节:</p><ul class=""><li id="f474" class="nb nc it kk b kl km ko kp kr nd kv ne kz nf ld ng nh ni nj bi translated"><strong class="kk iu">第 4–22 行:</strong>将被调用来填充数据集的函数。在这个函数中定义了要调用的端点以及用来获取数据和查询的查询。用这些，提取它的函数被调用，然后它们被写在 excel 中。</li><li id="c1ce" class="nb nc it kk b kl nk ko nl kr nm kv nn kz no ld ng nh ni nj bi translated"><strong class="kk iu">第 30–37 行:</strong>函数构建将在 API 调用中传递的选项，每次迭代都调用一个动态参数“skip ”,用这个新参数创建选项。</li><li id="7aea" class="nb nc it kk b kl nk ko nl kr nm kv nn kz no ld ng nh ni nj bi translated"><strong class="kk iu">第 44–49 行:</strong>将数据写入 excel 表格的函数。接收数组形式的数据作为参数，并将其写入执行脚本的 excel。</li><li id="d764" class="nb nc it kk b kl nk ko nl kr nm kv nn kz no ld ng nh ni nj bi translated"><strong class="kk iu">第 57–86 行:</strong>函数迭代历史中存在的所有数据块。创建一个从 api 请求数据的循环，在有数据时将 skip 参数增加 1，000 个单位。一旦接收到数据，它就将数据存储为一个数组，从 api 返回的 json 中检索该数组。</li></ul><p id="12be" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦创建了脚本，就必须执行它以便加载数据。我们以下列方式执行它:</p><figure class="mc md me mf gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi np"><img src="../Images/2b10cdeaa08399bb9176e5f8ae64dc4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4leQ4kQpHiMPvogCNMocOA.png"/></div></div></figure><p id="834f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们可以看到 excel 是如何填充数据的</p><figure class="mc md me mf gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nq"><img src="../Images/8f3e312d4ae5b7a95b8f3f08026110f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4oevkit-ih_iqsEr"/></div></div></figure><h1 id="dd99" class="le lf it bd lg lh li lj lk ll lm ln lo jz lp ka lq kc lr kd ls kf lt kg lu lv bi translated"><strong class="ak">分析数据</strong></h1><p id="aa8b" class="pw-post-body-paragraph ki kj it kk b kl lw ju kn ko lx jx kq kr ly kt ku kv lz kx ky kz ma lb lc ld im bi translated">使用填充的数据集，我们可以分析我们的数据。最快和最简单的方法是使用谷歌数据工作室仪表板。</p><p id="753a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们创建一个新的报告，并指出数据源将是一个电子表格。</p><figure class="mc md me mf gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nr"><img src="../Images/f11891b753ff46d7270bd6f09e183d9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UcQUnYbO7pPxALawXuzh0g.png"/></div></div></figure><p id="75b2" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过选择我们已经创建的表，我们可以使用 Google Data Studio 中存在的模板，并立即创建一个仪表板，以一种简单而非常有吸引力的方式向我们显示数据</p><figure class="mc md me mf gt mr gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi ns"><img src="../Images/53606c09dac406407c3c96a2bace343a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4EQCnFkQLLjEPUyP"/></div></div></figure><p id="ce57" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通过这个简单的脚本，我们可以实时获得来自协议定义的数据，并分析来自整个贷款历史的数据，这是一个非常重要的信息，能够以完全可访问的方式创建模型。</p><p id="4951" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">此外，这些信息可以非常容易地共享。创建的仪表盘可以在这里<a class="ae mb" href="https://datastudio.google.com/reporting/c7806832-8ba6-4250-9c27-8dab1238247b" rel="noopener ugc nofollow" target="_blank">查阅。</a></p></div></div>    
</body>
</html>