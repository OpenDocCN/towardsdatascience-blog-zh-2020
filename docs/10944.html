<html>
<head>
<title>How To Evaluate Image Segmentation Models?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何评价图像分割模型？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-accurate-is-image-segmentation-dd448f896388?source=collection_archive---------9-----------------------#2020-07-30">https://towardsdatascience.com/how-accurate-is-image-segmentation-dd448f896388?source=collection_archive---------9-----------------------#2020-07-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/fb5441f665619ac76a0a79ca043f40fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i1EzFvVroA7OKoi-LZJbIg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">Riho Kroll 在<a class="ae jg" href="https://unsplash.com/s/photos/throwing-dice?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</p></figure><div class=""/><div class=""><h2 id="f36e" class="pw-subtitle-paragraph kg ji jj bd b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dk translated">骰子和雅克卡德的解释…</h2></div><p id="9d18" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们正在研究一个深度学习模型，该模型可以预测脑瘤或皮肤损伤的<strong class="la jk">面具</strong>。什么是做面膜？我们将图像的像素分为 1 或 0。如果在一个像素中有一个掩模，我们声明 1，如果没有掩模，我们声明 0。对图像进行逐像素的二值分类称为“语义分割”。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lu"><img src="../Images/f52043abc8cb935c089f9ace4cb5e8ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8jbPEjPbdadKPqTC1PQXmg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片由作者提供:脑肿瘤磁共振成像和相应的面具</p></figure><p id="624e" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">如果我们试图识别图像中的许多对象，我们正在执行“实例分割”。实例分段是多类分段。例如，在自动驾驶汽车中，物体被分类为汽车、道路、树、房子、天空、行人等。</p><p id="edee" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在语义(二元)和实例(多类)分割中，我们需要一个损失函数来计算梯度。</p><p id="c7b5" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">哪个精度损失函数用于图像分割？</p><p id="0f43" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们看看我们的一些选择:</p><h1 id="174c" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated"><strong class="ak"> 1。像素精度:</strong></h1><p id="75d6" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated">我们可以将每个像素点逐一与地面真相遮罩进行比较。但是在阶级不平衡的地方，这是很成问题的。我举个例子解释一下:</p><p id="b53c" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">当我们为脑瘤创建一个如图 1 所示的遮罩时，它应该看起来像图 2 所示。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi lu"><img src="../Images/0a6dd81c1258def72ced9bb623f9c855.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VOhEiBl2JeTHIvl9EJn_5Q.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片由作者提供:脑肿瘤核磁共振成像和面具</p></figure><p id="0d03" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">现在让我们看看下面的面具。当我们为图 1 中的脑瘤制作以下掩模时，精确度似乎上升了大约 98%。为什么？</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mx"><img src="../Images/5722ddb1dce1983b7197927b19c38673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aWwUnNXRTuHVkJcIetl21Q.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者图片</p></figure><p id="cbb7" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">因为我们检查像素是否被正确分类并为每个像素赋值 0。在 MRI 图像中，肿瘤占据的部分仅占总图像的 2%,其余部分占 98%,因此该模型的准确度为 98%。精确度真的很高，但实际上我们连一个掩模都没有！这就是所谓的“阶层失衡”问题。(对于图像的一个像素，我们有两个类:1 遮罩，0 无遮罩。)</p><p id="1341" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">只比较这两个掩码可能是一个更好的主意。让我们看看；</p><h1 id="f934" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated">2.Jaccard 指数(并集交集，IoU)</h1><p id="a16b" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated">在这种准确性度量中，我们将基础真实遮罩(由放射科医师手动绘制的遮罩)与我们创建的遮罩进行比较。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi my"><img src="../Images/d1556552214a1bedb6eb71c261c3f8f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fMM5V8atXzqB0lx2KmW7tQ.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片作者:脑瘤，真实面具，预测面具。</p></figure><p id="5163" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">让我们说得更简单些:</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mx"><img src="../Images/cc75ee8772ee2ccb78e1fad0c2c53379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gQRNYorfocy7Lna3Jt1FOg.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者与 Canva 的图像:预测和地面真相面具的交集</p></figure><p id="236d" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">绿色区域:我们估计为 1，地面真实值为 1。(真阳性，TP)</p><p id="98b3" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">蓝色区域:我们估计值为 1，但实际值为 0。(假阳性，FP)</p><p id="8838" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">黄色区域:我们估计值为 0，但实际值为 1。(假阴性，FN)</p><p id="a304" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">灰色区域:我们估计为 0，地面真实为 0。(真阴性，TN)</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mx"><img src="../Images/eeb0da042dadaf32fd2daa846ddbd4d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eTtV99EAVsXWkhZAGHraeA.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">图片由作者用 Canva: Jaccard 的指数公式</p></figure><p id="e06b" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">Jaccard 的指数介于 0 和 1 之间。</p><h1 id="bf02" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated"><strong class="ak"> 3。骰子系数</strong></h1><p id="c940" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated">Dice 系数与 Jaccard 的指数非常相似。骰子系数双倍计算交集(TP)。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mx"><img src="../Images/33baf8dfd0d7052e45c9ec88eae018ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oY9S9VNsfv3NHuwjxwIU5A.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者使用 Canva 的图片:Dice 系数公式</p></figure><p id="2fbd" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">骰子系数是两个遮罩之间重叠的度量。1 表示完全重叠，0 表示没有重叠。</p><figure class="lv lw lx ly gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mx"><img src="../Images/fb8a2aa2988a0701d3936a7ddd32f3af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JzjyLM2pJZsJaBK6V3F1Cw.png"/></div></div><p class="jc jd gj gh gi je jf bd b be z dk translated">作者使用 Canva 的图像:重叠和非重叠图像</p></figure><p id="9662" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">骰子损失= 1 —骰子系数。轻松点。</p><p id="af58" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我们计算反向传播中骰子损失的梯度。</p><blockquote class="mz na nb"><p id="e762" class="ky kz lz la b lb lc kk ld le lf kn lg nc li lj lk nd lm ln lo ne lq lr ls lt im bi translated">为什么用 Dice Loss 而不是 Jaccard 的？因为 Dice 很容易微分，而 Jaccard 不容易微分。</p></blockquote><h1 id="e631" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated"><strong class="ak">代码示例:</strong></h1><p id="3ad6" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated">让我给你我用 Pytorch 脑瘤语义分割项目的骰子准确度和骰子丢失的代码。在这段代码中，我在一个函数中使用了二进制交叉熵损失和骰子损失。</p><figure class="lv lw lx ly gt iv"><div class="bz fp l di"><div class="nf ng l"/></div><p class="jc jd gj gh gi je jf bd b be z dk translated">骰子准确度、骰子损失和二进制交叉熵+骰子损失的代码片段</p></figure><h1 id="8394" class="ma mb jj bd mc md me mf mg mh mi mj mk kp ml kq mm ks mn kt mo kv mp kw mq mr bi translated"><strong class="ak">结论:</strong></h1><p id="89df" class="pw-post-body-paragraph ky kz jj la b lb ms kk ld le mt kn lg lh mu lj lk ll mv ln lo lp mw lr ls lt im bi translated">在我们的图像分割项目中，我们可以运行“dice_loss”或“bce_dice_loss”作为损失函数。在大多数情况下，我们获得了比单独的二元交叉熵损失更精确的结果。即插即用！</p><p id="21fc" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">感谢阅读。</strong></p><p id="de07" class="pw-post-body-paragraph ky kz jj la b lb lc kk ld le lf kn lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la jk">如果你想取得联系，你可以给我发电子邮件到 eymatas@gmail.com 的</strong> <a class="ae jg" href="http://www.clausraasted.dk/" rel="noopener ugc nofollow" target="_blank"> <strong class="la jk"> s </strong> </a> <strong class="la jk">，或者你可以通过 https://www.linkedin.com/in/seyma-tas/的</strong><a class="ae jg" href="https://www.linkedin.com/in/seyma-tas/" rel="noopener ugc nofollow" target="_blank"><strong class="la jk"/></a>找到我</p></div></div>    
</body>
</html>