<html>
<head>
<title>3 Primary Methods for Pandas Data Selection You Should Know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你应该知道的熊猫数据选择的 3 个主要方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-primary-methods-for-pandas-data-selection-you-should-know-21c3153b7fc1?source=collection_archive---------62-----------------------#2020-05-25">https://towardsdatascience.com/3-primary-methods-for-pandas-data-selection-you-should-know-21c3153b7fc1?source=collection_archive---------62-----------------------#2020-05-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="aa12" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">以您需要的方式选择您的数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/64259274cbcc5cb0fdbd4ec9f4a02616.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FNgsWuQZNvQagXdu"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">罗伯特·卡茨基在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="d59d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">熊猫作为一个数据科学家是一个不可分割的库，尤其是对于 Pythonist 来说。这是因为库能够轻松地存储和操作数据。熊猫图书馆力量的一个例子是我们可以多么容易地选择我们想要的数据。下面让我用 seaborn 库中的 mpg 数据集给你举个例子。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4c43" class="ma mb it lw b gy mc md l me mf">#importing the library<br/>import pandas as pd<br/>import seaborn as sns</span><span id="9982" class="ma mb it lw b gy mg md l me mf">mpg = sns.load_dataset('mpg')<br/>mpg.head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/f85952b61b544fd04e0910d757137475.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zWTwsfOjDiUmdLmcMQgRKQ.png"/></div></div></figure><p id="af52" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是数据框形式的 mpg 数据集。现在，假设我只想要 mpg 列，我们可以用下面的代码得到它。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d543" class="ma mb it lw b gy mc md l me mf">#Getting the data column with bracket and the column name<br/>mpg['mpg'].head()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/c69147cff915e9a5554e317d9c9e3233.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*mZpb66FMrmwhCUQ-FlugSw.png"/></div></figure><p id="53c1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们最终得到了之前选择的列的系列数据。这只是选择数据的例子。在下一节中，我将展示使用 Pandas 选择数据的四种不同的主要方法。</p><blockquote class="mj"><p id="8f5b" class="mk ml it bd mm mn mo mp mq mr ms lu dk translated">"熊猫是一个不可分割的图书馆作为一个数据科学家，尤其是对 Pythonist 来说."</p></blockquote></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="4d61" class="na mb it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">1.按标签选择</h1><p id="87b4" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">取自熊猫文献。</p><blockquote class="nw nx ny"><p id="2071" class="kz la nz lb b lc ld ju le lf lg jx lh oa lj lk ll ob ln lo lp oc lr ls lt lu im bi translated">“pandas 提供了一套方法来让<strong class="lb iu">完全基于标签的索引</strong>。这是一个基于严格包含的协议。要求的每个标签都必须在索引中，否则将引发一个<code class="fe od oe of lw b"><em class="it">KeyError</em></code></p></blockquote><p id="3440" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">熊猫让我们根据标签选择数据。如果你意识到，在我们之前的例子中，我们只选择了基于列的数据。对于基于标签的<strong class="lb iu">选择，我们需要熊猫<code class="fe od oe of lw b">.loc</code>属性。让我们在下面的例子中展示它是如何工作的。</strong></p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="abff" class="ma mb it lw b gy mc md l me mf">#Selecting data on index 0<br/>mpg.loc[0]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/ee94cd45adecfacd5f5f36d02d2c6890.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*M5X-DTfNzdRg4eYoGBzQkw.png"/></div></div></figure><p id="41ae" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用<code class="fe od oe of lw b">.loc</code>属性，我们选择标签 0 数据，并以标签 0 行的序列结束。现在，如果我们想要<strong class="lb iu">在我们的选择</strong>中包含更多的标签，我们需要选择一系列带有<code class="fe od oe of lw b">:</code>符号的标签，如下所示。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="a448" class="ma mb it lw b gy mc md l me mf">#Selecting data from index 0 to 4<br/>mpg.loc[0:4]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oh"><img src="../Images/b3bce84f01e7142e7b66401edf3a600c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HQI7tpskXd69UvkpxkbKag.png"/></div></div></figure><p id="73dc" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">假设我只想<strong class="lb iu">从各行中选择某个标签</strong>，我需要把它放入列表对象中。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="9fd3" class="ma mb it lw b gy mc md l me mf">#Selecting data from index 0,4,6<br/>mpg.loc[[0,4,6]]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mh"><img src="../Images/e6c1cefc7b7345a6976a828d109b33a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nZ1C0LahRbLRcjIyNxuFxg.png"/></div></div></figure><p id="a690" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们也可以<strong class="lb iu">添加我们希望</strong>在<code class="fe od oe of lw b">.loc</code>属性中选择的列，如下所示。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="23d4" class="ma mb it lw b gy mc md l me mf">#Select the column we want with the list of the columns name<br/>mpg.loc[[0,4,6], ['mpg', 'cylinders', 'origin']]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/e6899dab8845bac208ab7f4f7ff01758.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/format:webp/1*g0rDnsHG0ZbDu3ZvJUniVg.png"/></div></figure><p id="ea2d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在熊猫对象中，第一个位置是行位置，第二个位置是列位置。这就是为什么当我们选择数据时，我们首先根据行，然后根据列进行选择。</p><p id="b12d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们的数据框大部分时间都有默认标签，但是我们可以<strong class="lb iu">将另一列设置为标签</strong>并基于新索引选择数据。我将在下面的例子中展示它。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="2282" class="ma mb it lw b gy mc md l me mf">#Set the 'origin' column as the new index using .set_index then selecting the data using .loc</span><span id="f8cb" class="ma mb it lw b gy mg md l me mf">mpg.set_index('origin').loc['europe']</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/00386b73f786a71fbe78946d6d4e9bee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bLiAl7iyeXYqfMd9TyoGiw.png"/></div></div></figure><p id="fb8b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的数据框中，现在我只得到带有‘欧洲’标签的数据。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="328c" class="na mb it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">2.按位置选择</h1><p id="8d7b" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">如果在前面的部分中我们基于标签选择数据，Pandas 也提供了一个基于<strong class="lb iu">整数索引位置</strong>的选择方法。我们将使用的熊猫属性是<code class="fe od oe of lw b">.iloc</code>属性。</p><blockquote class="nw nx ny"><p id="f772" class="kz la nz lb b lc ld ju le lf lg jx lh oa lj lk ll ob ln lo lp oc lr ls lt lu im bi translated">这些是<code class="fe od oe of lw b"><em class="it">0-based</em></code>索引。切片时，起始边界为<em class="it">包含</em>，上限为<em class="it">排除</em>。试图使用一个非整数，甚至一个<strong class="lb iu">有效的</strong>标签都会引发一个<code class="fe od oe of lw b"><em class="it">IndexError</em></code>。</p></blockquote><p id="b29b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以上是熊猫官方文档说明。从解释中我们可以看到，当我们选择数据时，我们<strong class="lb iu">只</strong> <strong class="lb iu">使用</strong> <strong class="lb iu">整数值作为从 0 开始的位置，而不是标签</strong>。让我在下面的例子中展示一下。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="d5c0" class="ma mb it lw b gy mc md l me mf">#Selecting the data in the index position two<br/>mpg.iloc[2]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/357efe089dc5526f4782248d55795721.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*oUujiO02_bnEc1x182eIkg.png"/></div></figure><p id="a491" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们从位置索引位置 2 的数据帧中获取序列。一目了然，与使用标签方法相比没有什么不同，但如果我们将标签更改为非整数标签，会有什么不同。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="82e3" class="ma mb it lw b gy mc md l me mf">mpg.set_index('origin').iloc['europe']</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/a4908a648fada2170833668f43330c90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*OLEaPnCGBhDC-nbN9EN3KQ.png"/></div></figure><p id="55ab" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这会引发一个错误，因为使用<code class="fe od oe of lw b">.iloc</code>属性是基于位置的，而不是标签本身。现在，如果使用与上面相同的数据，但是我使用一个整数值来选择数据，会发生什么呢？</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="7300" class="ma mb it lw b gy mc md l me mf">mpg.set_index('origin').iloc[2]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/a286b7b6ab1c64e88919405566380406.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*9NeRiAnkIZk3wVJbyvwxNg.png"/></div></figure><p id="b2ca" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我们可以看到，如果我们不改变指数，结果是相似的。这是因为我们根据位置而不是标签来选择数据。现在，像上一节那样的序列索引怎么样？它还能用吗？</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="1385" class="ma mb it lw b gy mc md l me mf">#Selecting a sequence index based on position<br/>mpg.iloc[0:4]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi on"><img src="../Images/b678d366c2f44966c32b324e0f196e3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YVMJYR57s70OxhKmS8ieZQ.png"/></div></div></figure><p id="defb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">是的，我们仍然可以基于序列选择，但是我们需要记住的是，在基于位置的选择中，下限不包括在内。我们选择<code class="fe od oe of lw b">0:4</code>,但是我们最终只得到从位置 0 到 3 的数据。</p><p id="87a3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">就像以前一样，我们也可以通过使用 list 对象来选择一个特定的位置。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="5a39" class="ma mb it lw b gy mc md l me mf">mpg.iloc[[0,4,6]]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oo"><img src="../Images/609754c34661c618c9b51eb4f3ba70f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7QNJrxnbaQL6GMKr4eq0DA.png"/></div></div></figure><p id="4a34" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">但是，如果我们想在这里包含列选择。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="aa25" class="ma mb it lw b gy mc md l me mf">mpg.iloc[[0,4,6], ['mpg', 'cylinders', 'origin']]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/ed97d0a7a9c12a03af54912b0414f2b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r_04BADw-eXswuYgeVh4sg.png"/></div></div></figure><p id="4167" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">会出现错误，因为<code class="fe od oe of lw b">.iloc</code>函数只接受数字索引，不接受其他内容。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="3be0" class="na mb it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">3.布尔选择</h1><p id="68a2" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">在我们继续讨论之前，我想解释一下熊猫怎么会有<strong class="lb iu">布尔结果</strong>。试试下面的代码。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="8709" class="ma mb it lw b gy mc md l me mf">#Comparing the 'mpg' data with integer 17<br/>mpg['mpg'] &gt; 17</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/0350301c01c891e9ca5eb8a63bfd19e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*MyLaR5jzLi4srLCYdr1jEw.png"/></div></figure><p id="4afb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果将是一系列布尔值，这些值指示结果状态。True 表示大于 17 的数据，False 表示小于 17 的数据。现在，我们可以把布尔值作为选择标准。让我们试试下面的代码。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="4319" class="ma mb it lw b gy mc md l me mf">#Inputing the criteria within the square bracket<br/>mpg[mpg['mpg'] &gt; 17]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi or"><img src="../Images/feaa42c050824e2df8fbbc5fa87858fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wp4w0eIP9Fbba0mS9L3-Xg.png"/></div></div></figure><p id="3963" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果将是“mpg”数据大于 17 的所有数据或每个单个真布尔结果。如果我们想要两个或更多的标准呢？我们也可以像下面的代码那样做。</p><pre class="kj kk kl km gt lv lw lx ly aw lz bi"><span id="c0d9" class="ma mb it lw b gy mc md l me mf">mpg[(mpg['mpg'] &gt; 17) &amp; (mpg['origin'] == 'japan')|~(mpg['horsepower'] &lt;120)]</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/bb7d0ba8fff669c7166122ac69c95808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9epx_9fJdrOB7EOHr39sPQ.png"/></div></div></figure><p id="79c3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在上面的代码中，我指定了三个标准；“mpg”数据高于 17，“原产地”数据等于日本，“马力”数据不低于 120。当我们提出一个以上的标准时，我们需要把它放在括号中。而且，我们用<code class="fe od oe of lw b">&amp;</code>符号作为与，<code class="fe od oe of lw b">|</code>符号作为或，<code class="fe od oe of lw b">~</code>符号作为非。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="20a7" class="na mb it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">结论</h1><p id="d8b9" class="pw-post-body-paragraph kz la it lb b lc nr ju le lf ns jx lh li nt lk ll lm nu lo lp lq nv ls lt lu im bi translated">在这里，我向您展示了如何根据标签、位置和布尔值选择数据。虽然有许多选择数据的方法，但请使用您更熟悉的方法。</p></div><div class="ab cl mt mu hx mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="im in io ip iq"><h1 id="4869" class="na mb it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">如果您喜欢我的内容，并希望获得更多关于数据或数据科学家日常生活的深入知识，请考虑在此订阅我的<a class="ae ky" href="https://cornellius.substack.com/welcome" rel="noopener ugc nofollow" target="_blank">简讯。</a></h1><blockquote class="mj"><p id="27e9" class="mk ml it bd mm mn mo mp mq mr ms lu dk translated">如果您没有订阅为中等会员，请考虑通过<a class="ae ky" href="https://cornelliusyudhawijaya.medium.com/membership" rel="noopener">我的推荐</a>订阅。</p></blockquote></div></div>    
</body>
</html>