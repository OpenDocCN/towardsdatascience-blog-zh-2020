# å˜å‹å™¨æ˜¯å›¾å½¢ç¥ç»ç½‘ç»œ

> åŸæ–‡ï¼š<https://towardsdatascience.com/transformers-are-graph-neural-networks-bca9f75412aa?source=collection_archive---------7----------------------->

## è¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯åœ¨ NLP çš„ Transformer æ¶æ„èƒŒåå»ºç«‹ç›´è§‰ï¼Œä»¥åŠå®ƒä¸å›¾ä¸Šç¥ç»ç½‘ç»œçš„è”ç³»ã€‚

![](img/bd138b531afdbaf4b8a4475e89458dc5.png)

é˜¿ç‘Ÿå°¼Â·æ‰˜å¤åˆ—å¤«åœ¨ [Unsplash](https://unsplash.com/s/photos/transformers?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) ä¸Šçš„ç…§ç‰‡

å·¥ç¨‹å¸ˆæœ‹å‹ç»å¸¸é—®æˆ‘:å›¾æ·±åº¦å­¦ä¹ å¬èµ·æ¥å¾ˆæ£’ï¼Œä½†æ˜¯æœ‰æ²¡æœ‰å¤§çš„å•†ä¸šæˆåŠŸæ¡ˆä¾‹ï¼Ÿåœ¨å®é™…åº”ç”¨ä¸­éƒ¨ç½²äº†å—ï¼Ÿ

é™¤äº†é‚£äº›æ˜¾è€Œæ˜“è§çš„â€”â€”åœ¨ [Pinterest](https://medium.com/pinterest-engineering/pinsage-a-new-graph-convolutional-neural-network-for-web-scale-recommender-systems-88795a107f48) ã€ [Alibaba](https://arxiv.org/abs/1902.08730) å’Œ [Twitter](https://blog.twitter.com/en_us/topics/company/2019/Twitter-acquires-Fabula-AI.html) çš„æ¨èç³»ç»Ÿâ€”â€”ä¸€ä¸ªç¨å¾®å¾®å¦™çš„æˆåŠŸæ•…äº‹æ˜¯[**Transformer architecture**](https://arxiv.org/abs/1706.03762)ï¼Œå®ƒå·²ç»[è¢«](https://openai.com/blog/better-language-models/) [storm](https://nv-adlr.github.io/MegatronLM) å¸¦èµ°äº†[NLP](https://www.microsoft.com/en-us/research/project/large-scale-pretraining-for-response-generation/)[è¡Œä¸š](https://ai.facebook.com/blog/roberta-an-optimized-method-for-pretraining-self-supervised-nlp-systems/) [ã€‚](https://blog.einstein.ai/introducing-a-conditional-transformer-language-model-for-controllable-generation/)

é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘æƒ³åœ¨[å›¾å½¢ç¥ç»ç½‘ç»œ(GNNs)](https://graphdeeplearning.github.io/project/spatial-convnets/) å’Œå˜å½¢é‡‘åˆšä¹‹é—´å»ºç«‹è”ç³»ã€‚æˆ‘å°†è°ˆè®º NLP å’Œ GNN ç¤¾åŒºä¸­æ¨¡å‹æ¶æ„èƒŒåçš„ç›´è§‰ï¼Œä½¿ç”¨ç­‰å¼å’Œæ•°å­—å»ºç«‹è”ç³»ï¼Œå¹¶è®¨è®ºæˆ‘ä»¬å¦‚ä½•ä¸€èµ·å·¥ä½œæ¥æ¨åŠ¨è¿›å±•ã€‚

è®©æˆ‘ä»¬ä»è®¨è®ºæ¨¡å‹æ¶æ„çš„ç›®çš„å¼€å§‹â€”â€”*è¡¨ç¤ºå­¦ä¹ *ã€‚

# è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„è¡¨å¾å­¦ä¹ 

åœ¨é«˜å±‚æ¬¡ä¸Šï¼Œæ‰€æœ‰ç¥ç»ç½‘ç»œæ¶æ„å°†è¾“å…¥æ•°æ®çš„*è¡¨ç¤º*æ„å»ºä¸ºå‘é‡/åµŒå…¥ï¼Œå…¶ç¼–ç å…³äºæ•°æ®çš„æœ‰ç”¨çš„ç»Ÿè®¡å’Œè¯­ä¹‰ä¿¡æ¯ã€‚è¿™äº›*æ½œåœ¨çš„*æˆ–*éšè—çš„*è¡¨å¾ç„¶åå¯ä»¥è¢«ç”¨æ¥æ‰§è¡Œä¸€äº›æœ‰ç”¨çš„äº‹æƒ…ï¼Œæ¯”å¦‚å¯¹ä¸€å¹…å›¾åƒè¿›è¡Œåˆ†ç±»æˆ–è€…ç¿»è¯‘ä¸€ä¸ªå¥å­ã€‚ç¥ç»ç½‘ç»œ*å­¦ä¹ *é€šè¿‡æ¥æ”¶åé¦ˆæ¥å»ºç«‹è¶Šæ¥è¶Šå¥½çš„è¡¨ç¤ºï¼Œé€šå¸¸æ˜¯é€šè¿‡è¯¯å·®/æŸå¤±å‡½æ•°ã€‚

å¯¹äºè‡ªç„¶è¯­è¨€å¤„ç†(NLP)ï¼Œä¼ ç»Ÿä¸Šï¼Œ**é€’å½’ç¥ç»ç½‘ç»œ** (RNNs)ä»¥é¡ºåºæ–¹å¼æ„å»ºå¥å­ä¸­æ¯ä¸ªå•è¯çš„è¡¨ç¤ºï¼Œ*å³*ã€**ä¸€æ¬¡ä¸€ä¸ªå•è¯**ã€‚ç›´è§‚åœ°è¯´ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ RNN å±‚æƒ³è±¡æˆä¸€æ¡ä¼ é€å¸¦ï¼Œä¸Šé¢çš„æ–‡å­—ä»å·¦åˆ°å³è¿›è¡Œè‡ªå›å½’å¤„ç†ã€‚æœ€åï¼Œæˆ‘ä»¬ä¸ºå¥å­ä¸­çš„æ¯ä¸ªå•è¯è·å¾—ä¸€ä¸ªéšè—çš„ç‰¹å¾ï¼Œæˆ‘ä»¬å°†å®ƒä¼ é€’ç»™ä¸‹ä¸€ä¸ª RNN å±‚æˆ–ç”¨äºæˆ‘ä»¬é€‰æ‹©çš„ NLP ä»»åŠ¡ã€‚

> *æˆ‘å¼ºçƒˆæ¨è Chris Olah çš„ä¼ å¥‡åšå®¢ recaps å…³äº NLP çš„*[*RNNs*](http://colah.github.io/posts/2015-08-Understanding-LSTMs/)*å’Œ* [*è¡¨è±¡å­¦ä¹ *](http://colah.github.io/posts/2014-07-NLP-RNNs-Representations/) *ã€‚*

![](img/5c618308c08ed07a3404843de24bdc5b.png)

RNNs ä»¥è¿ç»­çš„æ–¹å¼æ„å»ºå¥å­ä¸­æ¯ä¸ªå•è¯çš„è¡¨ç¤ºï¼Œ*å³*ã€**ä¸€æ¬¡ä¸€ä¸ªå•è¯**ã€‚å¦ä¸€æ–¹é¢ï¼Œå˜å½¢é‡‘åˆšä½¿ç”¨ä¸€ç§æ³¨æ„åŠ›æœºåˆ¶æ¥è®¡ç®—å‡º**åœ¨å¥å­ä¸­çš„é‡è¦æ€§ã€‚**

æœ€åˆä¸ºæœºå™¨ç¿»è¯‘å¼•å…¥çš„**å˜å½¢é‡‘åˆš**å·²ç»é€æ¸å–ä»£ä¸»æµ NLP ä¸­çš„ rnnã€‚è¯¥æ¶æ„é‡‡ç”¨äº†ä¸€ç§å…¨æ–°çš„è¡¨ç¤ºå­¦ä¹ æ–¹æ³•:å®Œå…¨æ¶ˆé™¤é€’å½’ï¼Œå˜å½¢é‡‘åˆšä½¿ç”¨ä¸€ç§[æ³¨æ„åŠ›](https://distill.pub/2016/augmented-rnns/) [æœºåˆ¶](https://lilianweng.github.io/lil-log/2018/06/24/attention-attention.html)æ¥æ„å»ºæ¯ä¸ªå•è¯çš„ç‰¹å¾ï¼Œä»¥è®¡ç®—å‡º**åœ¨å¥å­ä¸­çš„æ‰€æœ‰å…¶ä»–å•è¯**å¯¹äºå‰è¿°å•è¯çš„é‡è¦æ€§ã€‚çŸ¥é“äº†è¿™ä¸€ç‚¹ï¼Œå•è¯çš„æ›´æ–°ç‰¹å¾å°±æ˜¯æ‰€æœ‰å•è¯çš„ç‰¹å¾çš„çº¿æ€§å˜æ¢çš„æ€»å’Œï¼Œé€šè¿‡å®ƒä»¬çš„é‡è¦æ€§æ¥åŠ æƒã€‚

> *å›åˆ° 2017 å¹´ï¼Œè¿™ä¸ªæƒ³æ³•å¬èµ·æ¥éå¸¸æ¿€è¿›ï¼Œå› ä¸º NLP ç¤¾åŒºéå¸¸ä¹ æƒ¯äºç”¨ RNNs å¤„ç†æ–‡æœ¬çš„é¡ºåº-ä¸€æ¬¡ä¸€ä¸ªå•è¯-é£æ ¼ã€‚è®ºæ–‡æ ‡é¢˜å¤§æ¦‚æ˜¯ç«ä¸Šæµ‡æ²¹å§ï¼*
> 
> *ä¸ºäº†é‡è¿°ï¼Œæ‰¬å°¼å…‹Â·åŸºå°”å½»åˆ¶ä½œäº†ä¸€éƒ¨å‡ºè‰²çš„* [*è§†é¢‘æ¦‚è¿°*](https://www.youtube.com/watch?v=iDulhoQ2pro) *ã€‚*

# åˆ†è§£å˜å‹å™¨

è®©æˆ‘ä»¬é€šè¿‡å°†å‰é¢çš„æ®µè½ç¿»è¯‘æˆæ•°å­¦ç¬¦å·å’Œå‘é‡çš„è¯­è¨€æ¥å‘å±•å¯¹æ¶æ„çš„ç›´è§‰ã€‚æˆ‘ä»¬ä»å±‚ *â„“* åˆ°å±‚ *â„“+1* æ›´æ–°å¥å­ *S* ä¸­ç¬¬ *i* ä¸ªå•è¯çš„éšè—ç‰¹å¾ *h* å¦‚ä¸‹:

![](img/84394b342e19ffba5567d76df6e1f469.png)

å…¶ä¸­ *jâˆˆ S* è¡¨ç¤ºå¥å­ä¸­çš„å•è¯é›†åˆï¼Œè€Œ *Qï¼ŒKï¼ŒV* æ˜¯å¯å­¦ä¹ çš„çº¿æ€§æƒé‡(åˆ†åˆ«è¡¨ç¤ºç”¨äºæ³¨æ„åŠ›è®¡ç®—çš„ **Q** ueryï¼Œ **K** ey å’Œ **V** å€¼)ã€‚å¯¹å¥å­ä¸­çš„æ¯ä¸ªå•è¯å¹¶è¡Œæ‰§è¡Œæ³¨æ„æœºåˆ¶ï¼Œä»¥åœ¨ *one shot* ä¸­è·å¾—å®ƒä»¬çš„æ›´æ–°ç‰¹å¾ RNNs ä¸Šçš„å˜å½¢é‡‘åˆšçš„å¦ä¸€ä¸ªåŠ åˆ†é¡¹ï¼Œå®ƒé€è¯æ›´æ–°ç‰¹å¾ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ç®¡é“æ›´å¥½åœ°ç†è§£æ³¨æ„æœºåˆ¶:

![](img/a703b96fa3439a774592e1989e15e7a2.png)

å¸æ”¶å•è¯ *h_i^â„“* çš„ç‰¹å¾å’Œå¥å­â€œh_j^â„“â€ä¸­çš„å…¶ä»–å•è¯é›†åˆï¼›âˆ€ jâˆˆ Sï¼Œæˆ‘ä»¬é€šè¿‡ç‚¹ç§¯è®¡ç®—æ¯ä¸€å¯¹(Iï¼Œj)çš„æ³¨æ„åŠ›æƒé‡ w_{ij}ï¼Œéšåæ˜¯æ‰€æœ‰ j çš„ softmaxã€‚æœ€åï¼Œæˆ‘ä»¬é€šè¿‡å¯¹ç”±å®ƒä»¬ç›¸åº”çš„ w_{ij}åŠ æƒçš„æ‰€æœ‰ h_j^â„“'s æ±‚å’Œæ¥äº§ç”Ÿå•è¯ I çš„æ›´æ–°çš„å•è¯ç‰¹å¾ h_i^{â„“+1}ã€‚å¥å­ä¸­çš„æ¯ä¸ªå•è¯å¹¶è¡Œåœ°ç»å†ç›¸åŒçš„æµæ°´çº¿æ¥æ›´æ–°å…¶ç‰¹å¾ã€‚

# å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶

è®©è¿™ç§ç‚¹ç§¯æ³¨æ„åŠ›æœºåˆ¶å‘æŒ¥ä½œç”¨è¢«è¯æ˜æ˜¯æ£˜æ‰‹çš„â€”â€”ç³Ÿç³•çš„éšæœºåˆå§‹åŒ–ä¼šç ´åå­¦ä¹ è¿‡ç¨‹çš„ç¨³å®šæ€§ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¹¶è¡Œæ‰§è¡Œå¤šä¸ªæ³¨æ„åŠ›â€œå¤´éƒ¨â€å¹¶è¿æ¥ç»“æœ(æ¯ä¸ªå¤´éƒ¨ç°åœ¨æœ‰å•ç‹¬çš„å¯å­¦ä¹ æƒé‡)æ¥å…‹æœè¿™ä¸€ç‚¹:

![](img/dabfc7fb0f17c6b2c57c54a77fcc4fcc.png)

å…¶ä¸­ *Q^k,K^kã€V^k* æ˜¯ç¬¬ *k* æ³¨æ„å¤´çš„å¯å­¦ä¹ é‡é‡ï¼Œè€Œ *O* æ˜¯å‘ä¸‹æŠ•å½±ï¼Œä»¥åŒ¹é…å„å±‚çš„ *h_i^{â„“+1}* å’Œ *h_i^â„“* çš„å°ºå¯¸ã€‚

å¤šä¸ªå¤´éƒ¨å…è®¸æ³¨æ„åŠ›æœºåˆ¶å®è´¨ä¸Šâ€œå¯¹å†²èµŒæ³¨â€ï¼Œä»ä¸Šä¸€å±‚æŸ¥çœ‹éšè—ç‰¹å¾çš„ä¸åŒè½¬æ¢æˆ–æ–¹é¢ã€‚æˆ‘ä»¬ç¨åä¼šè¯¦ç»†è®¨è®ºè¿™ä¸€ç‚¹ã€‚

# æ¯”ä¾‹é—®é¢˜å’Œå‰é¦ˆå­å±‚

æ¨åŠ¨æœ€ç»ˆå˜å‹å™¨æ¶æ„çš„ä¸€ä¸ªå…³é”®é—®é¢˜æ˜¯ï¼Œåœ¨ä¹‹åçš„å•è¯*çš„ç‰¹å¾ï¼Œæ³¨æ„æœºåˆ¶å¯èƒ½å¤„äº**ä¸åŒçš„æ ‡åº¦**æˆ–**å¤§å°** : (1)è¿™å¯èƒ½æ˜¯ç”±äºå½“å¯¹å…¶ä»–å•è¯çš„ç‰¹å¾æ±‚å’Œæ—¶ï¼Œä¸€äº›å•è¯å…·æœ‰éå¸¸å°–é”æˆ–éå¸¸åˆ†æ•£çš„æ³¨æ„æƒé‡ *w_{ij}* ã€‚(2)åœ¨å•ä¸ªç‰¹å¾/å‘é‡æ¡ç›®çº§åˆ«ï¼Œè·¨å¤šä¸ªæ³¨æ„åŠ›å¤´(æ¯ä¸ªæ³¨æ„åŠ›å¤´å¯èƒ½ä»¥ä¸åŒçš„æ¯”ä¾‹è¾“å‡ºå€¼)è¿›è¡Œè¿æ¥å¯ä»¥å¯¼è‡´æœ€ç»ˆå‘é‡ *h_i^{â„“+1}* çš„æ¡ç›®å…·æœ‰å¤§èŒƒå›´çš„å€¼ã€‚æŒ‰ç…§ä¼ ç»Ÿçš„ ML æ™ºæ…§ï¼Œåœ¨ç®¡é“ä¸­æ·»åŠ ä¸€ä¸ª[è§„èŒƒåŒ–å±‚](https://nealjean.com/ml/neural-network-normalization/)ä¼¼ä¹æ˜¯åˆç†çš„ã€‚*

å˜å½¢é‡‘åˆšç”¨ [**å›¾å±‚å**](https://arxiv.org/abs/1607.06450) å…‹æœäº†é—®é¢˜(2)ï¼Œè¯¥å›¾å±‚ååœ¨ç‰¹å¾çº§æ ‡å‡†åŒ–å¹¶å­¦ä¹ ä»¿å°„å˜æ¢ã€‚æ­¤å¤–ï¼Œ**é€šè¿‡ç‰¹å¾å°ºå¯¸çš„å¹³æ–¹æ ¹ç¼©æ”¾ç‚¹ç§¯**æ³¨æ„åŠ›æœ‰åŠ©äºæŠµæ¶ˆé—®é¢˜(1)ã€‚

æœ€åï¼Œä½œè€…æå‡ºäº†å¦ä¸€ç§æ§åˆ¶å°ºåº¦é—®é¢˜çš„â€œæŠ€å·§â€:**ä¸€ç§å…·æœ‰ç‰¹æ®Šç»“æ„çš„ä½ç½®å¼ä¸¤å±‚ MLP** ã€‚åœ¨å¤šå¤´å…³æ³¨ä¹‹åï¼Œä»–ä»¬é€šè¿‡ä¸€ä¸ªå¯å­¦ä¹ çš„æƒé‡å°† *h_i^{â„“+1}* æŠ•å°„åˆ°ä¸€ä¸ª(è’è°¬çš„)æ›´é«˜ç»´åº¦ï¼Œåœ¨é‚£é‡Œå®ƒç»å†äº† ReLU éçº¿æ€§ï¼Œç„¶åè¢«æŠ•å°„å›å…¶åŸå§‹ç»´åº¦ï¼Œæ¥ç€æ˜¯å¦ä¸€ä¸ªå½’ä¸€åŒ–:

![](img/cf3de61a017a237fdb54199506076b69.png)

> *è€å®è¯´ï¼Œæˆ‘ä¸ç¡®å®šè¿‡åº¦å‚æ•°åŒ–çš„å‰é¦ˆå­å±‚èƒŒåçš„ç¡®åˆ‡ç›´è§‰æ˜¯ä»€ä¹ˆï¼Œä¼¼ä¹ä¹Ÿæ²¡æœ‰äººå¯¹æ­¤æå‡ºç–‘é—®ï¼æˆ‘è®¤ä¸ºå›¾å±‚å½’ä¸€åŒ–å’Œç¼©æ”¾ç‚¹ç§¯æ²¡æœ‰å®Œå…¨è§£å†³çªå‡ºæ˜¾ç¤ºçš„é—®é¢˜ï¼Œæ‰€ä»¥å¤§ MLP æ˜¯ä¸€ç§é‡æ–°ç¼©æ”¾å½¼æ­¤ç‹¬ç«‹çš„ç‰¹å¾å‘é‡çš„æ–¹æ³•ã€‚*
> 
> [*é‚®ä»¶æˆ‘*](mailto:chaitanya.joshi@ntu.edu.sg) *å¦‚æœä½ äº†è§£æ›´å¤šï¼*

å˜å½¢å±‚çš„æœ€ç»ˆå›¾ç‰‡å¦‚ä¸‹æ‰€ç¤º:

![](img/1413280000a0bdff8e73d6d67fab6610.png)

Transformer æ¶æ„ä¹Ÿéå¸¸é€‚åˆéå¸¸æ·±çš„ç½‘ç»œï¼Œä½¿ NLP ç¤¾åŒºèƒ½å¤Ÿåœ¨æ¨¡å‹å‚æ•°å’Œæ•°æ®æ–¹é¢æ‰©å±•[](https://arxiv.org/abs/1910.10683)**[](https://arxiv.org/abs/2001.08361)*ã€‚**æ¯ä¸ªå¤šå¤´æ³¨æ„åŠ›å­å±‚å’Œå‰é¦ˆå­å±‚çš„è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„å‰©ä½™è¿æ¥**æ˜¯å †å å˜å‹å™¨å±‚çš„å…³é”®(ä½†ä¸ºäº†æ¸…æ¥šèµ·è§åœ¨å›¾ä¸­çœç•¥)ã€‚***

# ***gnn æ„å»ºå›¾å½¢çš„è¡¨ç¤º***

***è®©æˆ‘ä»¬æš‚æ—¶ç¦»å¼€ NLP ä¸€æ­¥ã€‚***

***å›¾å½¢ç¥ç»ç½‘ç»œ(gnn)æˆ–å›¾å½¢å·ç§¯ç½‘ç»œ(gcn)åœ¨å›¾å½¢æ•°æ®ä¸­æ„å»ºèŠ‚ç‚¹å’Œè¾¹çš„è¡¨ç¤ºã€‚å®ƒä»¬é€šè¿‡**é‚»åŸŸèšåˆ**(æˆ–æ¶ˆæ¯ä¼ é€’)æ¥å®ç°ï¼Œå…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹ä»å…¶é‚»å±…æ”¶é›†ç‰¹å¾ï¼Œä»¥æ›´æ–°å…¶å‘¨å›´çš„*å±€éƒ¨*å›¾ç»“æ„çš„è¡¨ç¤ºã€‚å †å å‡ ä¸ª GNN å›¾å±‚ä½¿æ¨¡å‹èƒ½å¤Ÿåœ¨æ•´ä¸ªå›¾ä¸­ä¼ æ’­æ¯ä¸ªèŠ‚ç‚¹çš„ç‰¹å¾-ä»å…¶é‚»å±…åˆ°é‚»å±…çš„é‚»å±…ï¼Œç­‰ç­‰ã€‚***

**![](img/d7090951558bfbe71d23b67b90cd3efe.png)**

***ä»¥è¿™ä¸ªè¡¨æƒ…ç¬¦å·ç¤¾äº¤ç½‘ç»œä¸ºä¾‹:GNN äº§ç”Ÿçš„èŠ‚ç‚¹ç‰¹å¾å¯ç”¨äºé¢„æµ‹ä»»åŠ¡ï¼Œå¦‚è¯†åˆ«æœ€æœ‰å½±å“åŠ›çš„æˆå‘˜æˆ–æå‡ºæ½œåœ¨çš„è”ç³»ã€‚***

**åœ¨å…¶æœ€åŸºæœ¬çš„å½¢å¼ä¸­ï¼Œgnn æ›´æ–°èŠ‚ç‚¹ *i* çš„éšè—ç‰¹å¾ *h* (ä¾‹å¦‚ğŸ˜†)åœ¨å±‚ *â„“* é€šè¿‡èŠ‚ç‚¹è‡ªèº«ç‰¹å¾çš„éçº¿æ€§å˜æ¢ *h_i^â„“* æ·»åŠ åˆ°æ¥è‡ªæ¯ä¸ªç›¸é‚»èŠ‚ç‚¹çš„ç‰¹å¾é›†åˆ*h_j^â„“*jâˆˆn(I):**

**![](img/ab19c3fb1534470a755a9e5739916fdb.png)**

**å…¶ä¸­ *Uï¼ŒV* æ˜¯ GNN å±‚çš„å¯å­¦ä¹ æƒé‡çŸ©é˜µï¼Œè€Œ *Ïƒ* æ˜¯è¯¸å¦‚ ReLU çš„éçº¿æ€§ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ *N* (ğŸ˜†) *= {* ğŸ˜˜,ğŸ˜,ğŸ˜œ,ğŸ¤© *}* ã€‚**

**å¯ä»¥ç”¨å…¶ä»–è¾“å…¥å¤§å°ä¸å˜çš„**èšåˆå‡½æ•°**æ¥ä»£æ›¿å¯¹é‚»åŸŸèŠ‚ç‚¹ *jâˆˆ N(i)ã€‘çš„æ±‚å’Œï¼Œä¾‹å¦‚ç®€å•çš„å¹³å‡å€¼/æœ€å¤§å€¼æˆ–è€…æ›´å¼ºå¤§çš„å‡½æ•°ï¼Œä¾‹å¦‚ç»ç”±[æ³¨æ„æœºåˆ¶å’Œ](https://petar-v.com/GAT/)çš„åŠ æƒæ±‚å’Œã€‚***

**å¬èµ·æ¥ç†Ÿæ‚‰å—ï¼Ÿ**

**ä¹Ÿè®¸ç®¡é“æœ‰åŠ©äºå»ºç«‹è”ç³»:**

**![](img/d236f2c738ed3db703cbc8ba69e50f5d.png)**

> **å¦‚æœæˆ‘ä»¬è¦è¿›è¡Œå¤šä¸ªå¹¶è¡Œçš„é‚»å±…å¤´èšåˆï¼Œå¹¶ç”¨å…³æ³¨æœºåˆ¶*å³*çš„åŠ æƒå’Œæ¥ä»£æ›¿é‚»å±… j ä¸Šçš„æ±‚å’Œï¼Œæˆ‘ä»¬å°†å¾—åˆ°**å›¾å…³æ³¨ç½‘ç»œ** (GAT)ã€‚åŠ ä¸Šå½’ä¸€åŒ–å’Œå‰é¦ˆ MLPï¼Œç§ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª**å›¾å½¢è½¬æ¢å™¨**ï¼**

# **å¥å­æ˜¯å®Œå…¨è¿æ¥çš„å•è¯å›¾**

**ä¸ºäº†ä½¿è¿™ç§è”ç³»æ›´åŠ æ˜ç¡®ï¼Œå¯ä»¥æŠŠä¸€ä¸ªå¥å­çœ‹ä½œä¸€ä¸ªå®Œå…¨è¿é€šå›¾ï¼Œå…¶ä¸­æ¯ä¸ªå•è¯éƒ½ä¸å…¶ä»–æ¯ä¸ªå•è¯ç›¸è¿ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ GNN ä¸ºå›¾(å¥å­)ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹(å•è¯)æ„å»ºç‰¹å¾ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥æ‰§è¡Œ NLP ä»»åŠ¡ã€‚**

**![](img/e6d5bb2506692d6f1d48382e05e6f5e2.png)**

**å¤§ä½“ä¸Šï¼Œè¿™å°±æ˜¯å˜å½¢é‡‘åˆšæ­£åœ¨åšçš„äº‹æƒ…:å®ƒä»¬æ˜¯å…·æœ‰å¤šå¤´æ³¨æ„åŠ›çš„ gnnï¼Œä½œä¸ºé‚»å±…èšåˆå‡½æ•°ã€‚æ ‡å‡† gnn ä»å®ƒä»¬çš„å±€éƒ¨é‚»åŸŸèŠ‚ç‚¹ *jâˆˆ N(i)* èšé›†ç‰¹å¾ï¼Œè€Œ NLP çš„ Transformers å°†æ•´ä¸ªå¥å­ *S* è§†ä¸ºå±€éƒ¨é‚»åŸŸï¼Œåœ¨æ¯ä¸€å±‚ä»æ¯ä¸ªå•è¯ *jâˆˆ S* èšé›†ç‰¹å¾ã€‚**

**é‡è¦çš„æ˜¯ï¼Œå„ç§ç‰¹å®šé—®é¢˜çš„æŠ€å·§â€”â€”å¦‚ä½ç½®ç¼–ç ã€å› æœ/æ©è”½èšåˆã€å­¦ä¹ ç‡è®¡åˆ’å’Œå¹¿æ³›çš„å‰æœŸåŸ¹è®­â€”â€”å¯¹å˜å½¢é‡‘åˆšçš„æˆåŠŸè‡³å…³é‡è¦ï¼Œä½†åœ¨ GNN ç¤¾åŒºä¸­å´å¾ˆå°‘å‡ºç°ã€‚ä¸æ­¤åŒæ—¶ï¼Œä» GNN çš„è§’åº¦æ¥çœ‹ã€Šå˜å½¢é‡‘åˆšã€‹å¯ä»¥å¯å‘æˆ‘ä»¬æ‘†è„±æ¶æ„ä¸­çš„è®¸å¤šèŠ±é‡Œèƒ¡å“¨ã€‚**

# **æˆ‘ä»¬èƒ½ä»å½¼æ­¤èº«ä¸Šå­¦åˆ°ä»€ä¹ˆï¼Ÿ**

**ç°åœ¨æˆ‘ä»¬å·²ç»åœ¨å˜å½¢é‡‘åˆšå’Œ GNNs ä¹‹é—´å»ºç«‹äº†è”ç³»ï¼Œè®©æˆ‘æ¥ç»™å¤§å®¶ä¸€äº›æƒ³æ³•â€¦**

## **å…¨è¿é€šå›¾æ˜¯ NLP çš„æœ€ä½³è¾“å…¥æ ¼å¼å—ï¼Ÿ**

**åœ¨ç»Ÿè®¡ NLP å’Œ ML ä¹‹å‰ï¼Œåƒè¯ºå§†Â·ä¹”å§†æ–¯åŸºè¿™æ ·çš„è¯­è¨€å­¦å®¶ä¸“æ³¨äºå‘å±•[è¯­è¨€ç»“æ„](https://en.wikipedia.org/wiki/Syntactic_Structures)çš„å½¢å¼åŒ–ç†è®ºï¼Œä¾‹å¦‚**è¯­æ³•æ ‘/å›¾**ã€‚å·²ç»å°è¯•è¿‡äº†ï¼Œä½†æ˜¯ä¹Ÿè®¸ Transformers/gnn æ˜¯æ›´å¥½çš„æ¶æ„ï¼Œè®©è¯­è¨€ç†è®ºå’Œç»Ÿè®¡ NLP çš„ä¸–ç•Œæ›´è¿‘ä¸€æ­¥ï¼Ÿ**

**![](img/3794439f3864ae11f1f1b0f25c6d2390.png)**

**æ¥æº:[ç»´åŸºç™¾ç§‘](https://en.wikipedia.org/wiki/Syntactic_Structures#/media/File:Cgisf-tgg.svg)**

## **å¦‚ä½•å­¦ä¹ é•¿æœŸä¾èµ–ï¼Ÿ**

**å…¨è¿é€šå›¾çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå®ƒä»¬ä½¿å¾—å­¦ä¹ å•è¯ä¹‹é—´çš„é•¿æœŸä¾èµ–å…³ç³»å˜å¾—å›°éš¾ã€‚è¿™ä»…ä»…æ˜¯ç”±äºå›¾ä¸­çš„è¾¹æ•°**ä¸èŠ‚ç‚¹æ•°*å³*çš„å¹³æ–¹æ¯”ä¾‹å…³ç³»ï¼Œåœ¨ä¸€ä¸ª *n* å•è¯å¥å­ä¸­ï¼Œè½¬æ¢å™¨/GNN å°†å¯¹ *n^2* å•è¯å¯¹è¿›è¡Œè®¡ç®—ã€‚äº‹æƒ…å¤±å»äº†æ§åˆ¶ã€‚****

**NLP ç¤¾åŒºå¯¹é•¿åºåˆ—å’Œä¾èµ–æ€§é—®é¢˜çš„è§‚ç‚¹å¾ˆæœ‰è¶£:æ ¹æ®è¾“å…¥å¤§å°ä½¿æ³¨æ„åŠ›æœºåˆ¶[ç¨€ç–](https://openai.com/blog/sparse-transformer/)æˆ–[è‡ªé€‚åº”](https://ai.facebook.com/blog/making-transformer-networks-simpler-and-more-efficient/)ï¼Œåœ¨æ¯ä¸€å±‚ä¸­æ·»åŠ [é€’å½’](https://ai.googleblog.com/2019/01/transformer-xl-unleashing-potential-of.html)æˆ–[å‹ç¼©](https://deepmind.com/blog/article/A_new_model_and_dataset_for_long-range_memory)ï¼Œä»¥åŠä½¿ç”¨[ä½ç½®æ•æ„Ÿæ•£åˆ—](https://www.pragmatic.ml/reformer-deep-dive/)è¿›è¡Œæœ‰æ•ˆçš„æ³¨æ„åŠ›éƒ½æ˜¯æ›´å¥½çš„è½¬æ¢å™¨çš„æœ‰å¸Œæœ›çš„æ–°æ€è·¯ã€‚**

**æœ‰è¶£çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¥è‡ª GNN ç¤¾åŒºçš„æƒ³æ³•æ··åˆåœ¨ä¸€èµ·ï¼Œ*ä¾‹å¦‚ï¼Œ*ï¼Œ[å¥å­çš„äºŒå…ƒåˆ’åˆ†](https://arxiv.org/abs/1911.04070)ï¼Œ**å›¾ç¨€ç–åŒ–**ä¼¼ä¹æ˜¯å¦ä¸€ç§ä»¤äººå…´å¥‹çš„æ–¹æ³•ã€‚**

**![](img/65998ae2e583cd52733d953fdaf16390.png)**

**æ¥æº:[å¶ç­‰ï¼Œ2019](https://arxiv.org/abs/1911.04070)**

## **å˜å½¢é‡‘åˆšåœ¨å­¦ä¹ â€˜ç¥ç»å¥æ³•â€™å—ï¼Ÿ**

**å·²ç»æœ‰å‡ ç¯‡æ¥è‡ª NLP ç¤¾åŒºçš„[æœ‰è¶£çš„](https://arxiv.org/abs/1905.05950) [è®ºæ–‡](https://arxiv.org/abs/1906.04341)å…³äºå˜å½¢é‡‘åˆšå¯èƒ½åœ¨å­¦ä¹ ä»€ä¹ˆã€‚åŸºæœ¬å‰ææ˜¯ï¼Œå¯¹ä¸€ä¸ªå¥å­ä¸­çš„æ‰€æœ‰è¯å¯¹è¿›è¡Œå…³æ³¨â€”â€”ç›®çš„æ˜¯è¯†åˆ«å“ªäº›è¯å¯¹æœ€æœ‰è¶£â€”â€”ä½¿å˜å½¢é‡‘åˆšèƒ½å¤Ÿå­¦ä¹ ç±»ä¼¼äº**ä»»åŠ¡ç‰¹å®šè¯­æ³•**çš„ä¸œè¥¿ã€‚å¤šå¤´æ³¨æ„åŠ›ä¸­çš„ä¸åŒå¤´ä¹Ÿå¯èƒ½â€œçœ‹â€ä¸åŒçš„å¥æ³•å±æ€§ã€‚**

**åœ¨å›¾çš„æœ¯è¯­ä¸­ï¼Œé€šè¿‡åœ¨å…¨å›¾ä¸Šä½¿ç”¨ GNNsï¼Œæˆ‘ä»¬èƒ½ä» GNN å¦‚ä½•åœ¨æ¯ä¸€å±‚æ‰§è¡Œé‚»åŸŸèšåˆä¸­æ¢å¤æœ€é‡è¦çš„è¾¹â€”â€”ä»¥åŠå®ƒä»¬å¯èƒ½åŒ…å«çš„å†…å®¹å—ï¼Ÿæˆ‘è¿˜ä¸å¤ªç›¸ä¿¡è¿™ä¸ªè§‚ç‚¹ã€‚**

**![](img/3237dfa586ba176c56e4ab57bcbe33b4.png)**

**æ¥æº:[å…‹æ‹‰å…‹ç­‰äººï¼Œ2019](https://arxiv.org/abs/1906.04341)**

## **ä¸ºä»€ä¹ˆè¦å¤šä¸ªå¤´åƒå…³æ³¨ï¼Ÿä¸ºä»€ä¹ˆå…³æ³¨ï¼Ÿ**

**æˆ‘æ›´èµåŒå¤šå¤´æœºåˆ¶çš„ä¼˜åŒ–è§‚ç‚¹â€”â€”æ‹¥æœ‰å¤šä¸ªæ³¨æ„åŠ›å¤´**å¯ä»¥æé«˜å­¦ä¹ èƒ½åŠ›**å¹¶å…‹æœ**ç³Ÿç³•çš„éšæœºåˆå§‹åŒ–**ã€‚ä¾‹å¦‚ï¼Œ[è¿™äº›](https://lena-voita.github.io/posts/acl19_heads.html) [è®ºæ–‡](https://arxiv.org/abs/1905.10650)è¡¨æ˜ï¼Œåœ¨åŸ¹è®­åï¼Œå˜å‹å™¨å¤´å¯ä»¥è¢«â€œä¿®å‰ªâ€æˆ–ç§»é™¤*ï¼Œè€Œä¸ä¼šå¯¹æ€§èƒ½äº§ç”Ÿé‡å¤§å½±å“ã€‚***

**å¤šå¤´é‚»åŸŸèšåˆæœºåˆ¶åœ¨ GNNs ä¸­ä¹Ÿè¢«è¯æ˜æ˜¯æœ‰æ•ˆçš„ï¼Œ*ä¾‹å¦‚*ï¼ŒGAT ä½¿ç”¨ç›¸åŒçš„å¤šå¤´æ³¨æ„åŠ›ï¼Œ [MoNet](https://arxiv.org/abs/1611.08402) ä½¿ç”¨å¤šä¸ª*é«˜æ–¯æ ¸*æ¥èšåˆç‰¹å¾ã€‚è™½ç„¶å‘æ˜å¤šå¤´æŠ€å·§æ˜¯ä¸ºäº†ç¨³å®šæ³¨æ„åŠ›æœºåˆ¶ï¼Œä½†å®ƒèƒ½æˆä¸ºæŒ¤å‡ºé¢å¤–æ¨¡å‹æ€§èƒ½çš„æ ‡å‡†å—ï¼Ÿ**

**ç›¸åï¼Œå…·æœ‰æ›´ç®€å•çš„èšåˆå‡½æ•°å¦‚ sum æˆ– max çš„ gnn ä¸éœ€è¦å¤šä¸ªèšåˆå¤´è¿›è¡Œç¨³å®šçš„è®­ç»ƒã€‚å¦‚æœæˆ‘ä»¬ä¸å¿…è®¡ç®—å¥å­ä¸­æ¯ä¸ªè¯å¯¹ä¹‹é—´çš„æˆå¯¹å…¼å®¹æ€§ï¼Œè¿™å¯¹å˜å½¢é‡‘åˆšä¸æ˜¯å¾ˆå¥½å—ï¼Ÿ**

**å˜å½¢é‡‘åˆšèƒ½ä»è½¬ç§»æ³¨æ„åŠ›ä¸­è·ç›Šå—ï¼ŸYann Dauphin åŠå…¶åˆä½œè€…çš„[æœ€è¿‘çš„](https://arxiv.org/abs/1705.03122) [å·¥ä½œ](https://arxiv.org/abs/1901.10430)æå‡ºäº†ä¸€ç§æ›¿ä»£çš„ **ConvNet æ¶æ„**ã€‚å˜å½¢é‡‘åˆšä¹Ÿä¸€æ ·ï¼Œæœ€ç»ˆå¯èƒ½ä¼šåšä¸åº·æ–‡ç½‘ç±»ä¼¼çš„äº‹æƒ…ã€‚**

**![](img/5fd60339bc1070b6426bdbd984c072ab.png)**

**æ¥æº:[å´ç­‰ï¼Œ2019](https://arxiv.org/pdf/1901.10430.pdf)**

## **ä¸ºä»€ä¹ˆè®­ç»ƒå˜å½¢é‡‘åˆšè¿™ä¹ˆéš¾ï¼Ÿ**

**é˜…è¯»æ–°çš„ã€Šå˜å½¢é‡‘åˆšã€‹è®ºæ–‡è®©æˆ‘è§‰å¾—ï¼Œåœ¨ç¡®å®šæœ€ä½³**å­¦ä¹ ç‡è®¡åˆ’ã€é¢„çƒ­ç­–ç•¥**å’Œ**è¡°å‡è®¾ç½®**æ—¶ï¼Œè®­ç»ƒè¿™äº›æ¨¡å‹éœ€è¦ç±»ä¼¼äº*é»‘é­”æ³•*çš„ä¸œè¥¿ã€‚è¿™å¯èƒ½ä»…ä»…æ˜¯å› ä¸ºæ¨¡å‹æ˜¯å¦‚æ­¤åºå¤§ï¼Œè€Œæ‰€ç ”ç©¶çš„ NLP ä»»åŠ¡æ˜¯å¦‚æ­¤å…·æœ‰æŒ‘æˆ˜æ€§ã€‚**

**ä½†æ˜¯[æœ€è¿‘çš„](https://arxiv.org/abs/1906.01787) [ç»“æœ](https://arxiv.org/abs/1910.06764) [æš—ç¤º](https://arxiv.org/abs/2002.04745)è¿™ä¹Ÿå¯èƒ½æ˜¯ç”±äºæ¶æ„å†…å½’ä¸€åŒ–å’Œå‰©ä½™è¿æ¥çš„ç‰¹å®šæ’åˆ—ã€‚**

**åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œæˆ‘åœ¨å’†å“®ï¼Œä½†è¿™è®©æˆ‘æ€€ç–‘:æˆ‘ä»¬çœŸçš„éœ€è¦å¤šä¸ªæ˜‚è´µçš„æˆå¯¹æ³¨æ„åŠ›ã€è¿‡åº¦å‚æ•°åŒ–çš„ MLP å­å±‚å’Œå¤æ‚çš„å­¦ä¹ æ—¶é—´è¡¨å—ï¼Ÿ**

**æˆ‘ä»¬çœŸçš„éœ€è¦ç¢³è¶³è¿¹[å·¨å¤§çš„æ¨¡å‹](https://www.technologyreview.com/s/613630/training-a-single-ai-model-can-emit-as-much-carbon-as-five-cars-in-their-lifetimes/)å—ï¼Ÿ**

**å¯¹äºæ‰‹å¤´çš„ä»»åŠ¡ï¼Œå…·æœ‰è‰¯å¥½[å½’çº³åå·®](https://arxiv.org/abs/1806.01261)çš„æ¶æ„éš¾é“ä¸åº”è¯¥æ›´å®¹æ˜“è®­ç»ƒå—ï¼Ÿ**

# **è¿›ä¸€æ­¥é˜…è¯»**

**è¦ä» NLP çš„è§’åº¦æ·±å…¥äº†è§£ Transformer æ¶æ„ï¼Œè¯·æŸ¥çœ‹è¿™äº›ä»¤äººæƒŠå¹çš„åšå®¢å¸–å­:[å›¾è§£ Transformer](http://jalammar.github.io/illustrated-transformer/) å’Œ[æ³¨é‡Š Transformer](http://nlp.seas.harvard.edu/2018/04/03/attention.html) ã€‚**

**æ­¤å¤–ï¼Œè¿™ä¸ªåšå®¢å¹¶ä¸æ˜¯ç¬¬ä¸€ä¸ªå°† gnn å’Œå˜å½¢é‡‘åˆšè”ç³»èµ·æ¥çš„åšå®¢:è¿™æ˜¯ Arthur Szlam å…³äºæ³¨æ„åŠ›/è®°å¿†ç½‘ç»œã€gnn å’Œå˜å½¢é‡‘åˆšçš„å†å²å’Œè”ç³»çš„ç²¾å½©æ¼”è®²ã€‚åŒæ ·ï¼ŒDeepMind çš„[ä¼—æ˜Ÿäº‘é›†çš„ç«‹åœºæ–‡ä»¶](https://arxiv.org/abs/1806.01261)å¼•å…¥äº†*å›¾ç½‘ç»œ*æ¡†æ¶ï¼Œç»Ÿä¸€äº†æ‰€æœ‰è¿™äº›æƒ³æ³•ã€‚å¯¹äºä»£ç æ¼”ç»ƒï¼ŒDGL å›¢é˜Ÿæœ‰ä¸€ä¸ªå…³äº seq2seq ä½œä¸ºå›¾é—®é¢˜å’Œæ„å»ºå˜å½¢é‡‘åˆšä½œä¸º gnn çš„å¾ˆå¥½çš„æ•™ç¨‹ã€‚**

****åœ¨æˆ‘ä»¬çš„ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†åšç›¸åçš„äº‹æƒ…:ä½¿ç”¨ GNN æ¶æ„ä½œä¸º NLP çš„å˜å½¢é‡‘åˆš(åŸºäº** [**çš„å˜å½¢é‡‘åˆšåº“)ğŸ¤—HuggingFace**](https://github.com/huggingface/transformers) **)ã€‚****

**æœ€åï¼Œæˆ‘ä»¬å†™äº†[ä¸€ç¯‡æœ€è¿‘çš„è®ºæ–‡](https://graphdeeplearning.github.io/publication/xu-2019-multi/)å°†å˜å½¢é‡‘åˆšåº”ç”¨äºè‰å›¾ã€‚ä¸€å®šè¦å»çœ‹çœ‹ï¼**

## **æ›´æ–°**

***å˜å½¢é‡‘åˆš GNNs* ä¸[T3ã€æ¸å˜ã€‘](https://thegradient.pub/transformers-are-graph-neural-networks/) äº 2020 å¹´ 9 æœˆå‡ºç‰ˆï¼**

**è¯¥å¸–å­æœ€åˆå‡ºç°åœ¨ [NTU å›¾å½¢æ·±åº¦å­¦ä¹ å®éªŒå®¤ç½‘ç«™](https://graphdeeplearning.github.io/post/transformers-are-gnns/)ï¼Œä¹Ÿè¢«ç¿»è¯‘æˆäº†[ä¸­æ–‡](https://mp.weixin.qq.com/s/DABEcNf1hHahlZFMttiT2g)å’Œ[ä¿„æ–‡](https://habr.com/ru/post/491576/)ã€‚ä¸€å®šè¦åœ¨ [Twitter](https://twitter.com/chaitjo/status/1233220586358181888?s=20) ã€ [Reddit](https://www.reddit.com/r/MachineLearning/comments/fb86mo/d_transformers_are_graph_neural_networks_blog/) æˆ– [HackerNews](https://news.ycombinator.com/item?id=22518263) ä¸ŠåŠ å…¥è®¨è®ºï¼**

## **å¼•ç”¨**

***åœ¨å­¦æœ¯è¯­å¢ƒæˆ–ä¹¦ç±ä¸­çš„å½’å±ï¼Œè¯·å°†æ­¤ä½œå“å¼•ç”¨ä¸º***

> ***æŸ´å¦å°¼äºšÂ·kÂ·ä¹”å¸Œï¼Œã€Šå˜å½¢é‡‘åˆšæ˜¯å›¾å½¢ç¥ç»ç½‘ç»œã€‹ï¼ŒThe Gradientï¼Œ2020ã€‚***

***BibTeX å¼•ç”¨:***

> ***@ article { Joshi 2020 Transformersï¼Œ
> ä½œè€…= {Joshiï¼ŒChaitanya}ï¼Œ
> æ ‡é¢˜= { Transformers is Gradient ç¥ç»ç½‘ç»œ}ï¼Œ
> æœŸåˆŠ= {The Gradient}ï¼Œ
> å¹´ä»½= {2020}ï¼Œ
> å¦‚ä½•å‘å¸ƒ= { \ URL {*[*https://The Gradient . pub/Transformers-are-gaph-Neural-Networks/*](https://thegradient.pub/transformers-are-gaph-neural-networks/)*}ï¼Œ***