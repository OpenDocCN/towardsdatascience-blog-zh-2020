<html>
<head>
<title>Still using Accuracy as a Classification Metric?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">仍然使用准确性作为分类标准吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-top-n-accuracy-metrics-8aa90170b35?source=collection_archive---------52-----------------------#2020-06-01">https://towardsdatascience.com/understanding-top-n-accuracy-metrics-8aa90170b35?source=collection_archive---------52-----------------------#2020-06-01</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9957" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">了解多类分类问题的前N名准确性指标</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/23dc9216689212f2429039ea1f90b3ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MKaTFdl07fCI4bXEtGhAUQ.jpeg"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">里卡多·阿尔塞在<a class="ae ky" href="https://unsplash.com/s/photos/accuracy?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</p></figure><p id="2bac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">准确性是分类模型最常见的评估标准，因为它简单明了。但是，当您手头有一个多类分类问题时，比方说，有15个不同的目标类，查看模型的标准准确性可能会产生误导。这就是“前N名”准确度可能有所用处的地方，在本文中，我将带您了解前N名准确度的基本直觉和python实现。</p><p id="3596" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在讨论前N名精度之前，先回顾一下标准精度指标:</p><h2 id="08dd" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">什么是准确性？</strong></h2><p id="df44" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">准确性是模型正确预测的记录总数的百分比。准确度=(正确预测的记录数/记录总数)或准确度= (TP+TN) / (TP+TN+FP+FN)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/20070846f765e0f5a641c0328635f55b.png" data-original-src="https://miro.medium.com/v2/resize:fit:572/format:webp/0*VnMuW8UdlQNEUDWA.png"/></div></figure><h2 id="18e9" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">为什么准确度不是多类问题的完美衡量标准？</strong></h2><p id="5b8a" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">当您有许多不同的类别时，分类模型可能无法准确预测正确的类别。在文本分类这样的NLP情况下，这尤其成为一个问题，在这种情况下，您有大量的特征，并且数据没有充分地跨类聚类。因此，查看您的标准准确性指标有时可能会产生误导。如前所述，测量前N个精度可能有助于解决这个问题。</p><h2 id="919f" class="lv lw it bd lx ly lz dn ma mb mc dp md li me mf mg lm mh mi mj lq mk ml mm mn bi translated"><strong class="ak">什么是top N精度？</strong></h2><p id="78af" class="pw-post-body-paragraph kz la it lb b lc mo ju le lf mp jx lh li mq lk ll lm mr lo lp lq ms ls lt lu im bi translated">前N个精度并不是任何不同的度量，而是真实类的标准精度等于分类模型预测的N个最有可能的类中的任何一个。</p><p id="9b8f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最高1级准确度是指真实类别与模型预测的最可能类别相匹配的准确度，与我们的标准准确度相同。</p><p id="0532" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">前2名准确度是指真实类别与模型预测的2个最可能类别中的任何一个匹配的准确度。</p><p id="6fe8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">前3名准确度是指真实类别与模型预测的3个最可能类别中的任何一个匹配的准确度。</p><p id="a72d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">同样，我们可以衡量前4名、前5名、前6名等等。</p><p id="8bac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">让我举个例子让你更好的理解。考虑必须将记录分类到相应的动物中(狗、猫、狮子、老虎和大象)。该表显示了6个记录的真实类别和预测类别。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/10a7b856538afe633cd3f791518832eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:394/format:webp/0*KSyCmSMlnGyhBwUh.png"/></div></figure><p id="94a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">由此，我们将得到50%的准确率，这并不令人满意。现在让我们找出这个问题的前2个精度。该表显示了同一组记录的真实类别和2个最可能的类别。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/18730255db6347315659e468871eafbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/0*ZoDFZ9mM6w8Bsof6.png"/></div></figure><p id="abb2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这样，我们得到了83%的准确率，与之前相比有了显著的提高。这是找到前N个精度背后的基本直觉。</p><p id="fa2f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我希望你已经理解了测量前N个精度的重要性。即使分类模型无法预测准确的类别，查看前2名或前3名的准确性在许多情况下可能是有用的，尤其是在有许多不同类别(如15或20)的情况下。</p><p id="2e8a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">现在，我将向您展示一些使用python 查找前N个精度的<strong class="lb iu">代码。不幸是，sci-kit learn没有任何内置的功能。所以我在这里定义了一个函数，你可以直接复制，用在你的问题中。</strong></p><p id="83ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">导入所需的库并预处理数据后，运行提供的函数。</p><pre class="kj kk kl km gt mw mx my mz aw na bi"><span id="f22a" class="lv lw it mx b gy nb nc l nd ne">def top_n_accuracy(X,y,n,classifier):<br/>  X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)<br/>  vectorizer = TfidfVectorizer(min_df=2)<br/>  X_train_sparse = vectorizer.fit_transform(X_train)<br/>  feature_names = vectorizer.get_feature_names()<br/>  test = vectorizer.transform(X_test)<br/>  clf = classifier<br/>  clf.fit(X_train_sparse,y_train)<br/>  predictions = clf.predict(test)<br/>  probs = clf.predict_proba(test)<br/>  topn = np.argsort(probs, axis = 1)[:,-n:]<br/>  y_true = np.array(y_test)<br/>  return np.mean(np.array([1 if y_true[k] in topn[k] else 0 for k in range(len(topn))]))</span></pre><p id="07e1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">您可以通过提供以下参数来调用该函数:</p><ol class=""><li id="65fd" class="nf ng it lb b lc ld lf lg li nh lm ni lq nj lu nk nl nm nn bi translated">X =特征变量</li><li id="0e15" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">y =目标类别</li><li id="c8a3" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">n =要测量的前N名(例如，前2名的n=2)</li><li id="14ee" class="nf ng it lb b lc no lf np li nq lm nr lq ns lu nk nl nm nn bi translated">分类器=您想要使用的分类模型(例如LogisticRegression())</li></ol><p id="d642" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我已经为文本分类定义了这个函数，但是您可以简单地删除具有<em class="nt">矢量器</em>实例的行，并将其用于标准分类。</p></div></div>    
</body>
</html>