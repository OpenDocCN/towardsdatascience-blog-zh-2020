<html>
<head>
<title>Your complete guide to Machine Learning Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你的机器学习模型完全指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/your-complete-guide-to-machine-learning-models-403b4716172c?source=collection_archive---------42-----------------------#2020-06-23">https://towardsdatascience.com/your-complete-guide-to-machine-learning-models-403b4716172c?source=collection_archive---------42-----------------------#2020-06-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5ebc" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用哪种模型，何时使用，为什么？如何调优你的算法？让我们一起投入进去吧！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/390a6059e3859a25bbe1145ab387e266.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5zT3ANpxGfcDUFOe"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@drscythe?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">张秀坤镰刀</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</p></figure><h1 id="e861" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">简介</h1><p id="043c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">通常，你通过在互联网上寻找指南来开始你的机器学习研究，这些指南将帮助你——最终——将一个项目带入生活，对吗？</p><p id="9bb6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">随着时间的推移，你开始意识到有很多东西要学，并开始思考你是否有能力做到。过于困难的教程、不充分的解释、问题；“也许我不够好，”你想。</p><p id="63b7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在故事的结尾，你会准确地认出每一步。我们开始吧！</p><h1 id="af14" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">你今天会学到什么？</h1><ul class=""><li id="a92d" class="ms mt it lt b lu lv lx ly ma mu me mv mi mw mm mx my mz na bi translated">如何选择将提供最佳结果的模型；</li><li id="3a59" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">创建机器学习模型所需的每个过程；</li><li id="035d" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">如何准备您的数据:将分类转换为数值，填充空值，等等；</li><li id="4da3" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">如何创建功能，帮助您自动化您的工作过程，以及更多！</li></ul><p id="e9f7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们将使用scikit-learn库。在极简主义的定义中，每个机器学习过程都围绕这个库旋转。<a class="ae ky" href="https://scikit-learn.org/" rel="noopener ugc nofollow" target="_blank">点击这里</a>了解更多。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="9f90" class="kz la it bd lb lc nn le lf lg no li lj jz np ka ll kc nq kd ln kf nr kg lp lq bi translated">我应该使用哪种机器学习算法？</h1><p id="1bfe" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这是第一个问题，也是最重要的问题。如果选择了不正确的估计量(aka模型)，就会产生错误的推论。这通常取决于您的数据和您想要预测的内容。<strong class="lt iu">输出决定了这里的规则。</strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/5298206cd85eaee92f8636681065ede8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VMzTrcNI3nVH4dK6rXbgyA.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://medium.com/@renfelo" rel="noopener">雷南·洛里科</a>拍摄——中号</p></figure><h1 id="2743" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">回归</h1><p id="980c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你需要预测几个数字输出，比如工资，这就需要一个回归估计器。与分类不同，回归估计量根据特征预测不同范围的未知数值。此外，度量标准也不一样。不要忘记。</p><h2 id="014e" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">问题</h2><blockquote class="of og oh"><p id="656d" class="lr ls oi lt b lu mn ju lw lx mo jx lz oj mp mc md ok mq mg mh ol mr mk ml mm im bi translated">基于这些特性，<strong class="lt iu">会输出多少</strong>？</p></blockquote><h2 id="0ad2" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">试一试算法</h2><ul class=""><li id="afdf" class="ms mt it lt b lu lv lx ly ma mu me mv mi mw mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html" rel="noopener ugc nofollow" target="_blank">线性回归</a>(线性_模型包)</li><li id="e15e" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVR.html#sklearn.svm.LinearSVR" rel="noopener ugc nofollow" target="_blank"> LinearSVR </a> (svm包)</li><li id="19e8" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsRegressor.html#sklearn.neighbors.KNeighborsRegressor" rel="noopener ugc nofollow" target="_blank"> KNeighborsRegressor </a>(邻居包)</li><li id="0a72" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html" rel="noopener ugc nofollow" target="_blank"> RandomForestRegressor </a>(集合包)</li><li id="5d7c" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeRegressor.html" rel="noopener ugc nofollow" target="_blank">决策树回归器</a>(树包)</li><li id="589b" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDRegressor.html#sklearn.linear_model.SGDRegressor" rel="noopener ugc nofollow" target="_blank"> SGDRegressor </a>(线性_模型包)</li></ul><h2 id="ab72" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">技巧</h2><ul class=""><li id="8451" class="ms mt it lt b lu lv lx ly ma mu me mv mi mw mm mx my mz na bi translated">想要快速输出有效结果吗？选择决策树和随机森林，它们永远不会失败。默认参数是一个良好的开端。</li><li id="97b0" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">没有足够的数据，并希望您的模型能够正确概括？尝试线性回归、最近邻或支持向量机算法。</li><li id="4425" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">没有一个像预期的那样有效？尝试使用RandomizedSearchCV或GridSearchCV调整您的默认参数。</li></ul><h1 id="0279" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">分类</h1><p id="4a47" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">每当你需要预测某样东西是A还是B(直到Z)时，分类估计器是有用的。像这样的问题:是猫还是浣熊？哪个月更有可能发生？你用一个分类估计器来阐明这些问题。</p><h2 id="1fd7" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">问题</h2><blockquote class="of og oh"><p id="d2c1" class="lr ls oi lt b lu mn ju lw lx mo jx lz oj mp mc md ok mq mg mh ol mr mk ml mm im bi translated">根据这些特性，<strong class="lt iu">会输出哪种类型的</strong>？</p></blockquote><h2 id="5c31" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">试一试算法</h2><ul class=""><li id="e7b4" class="ms mt it lt b lu lv lx ly ma mu me mv mi mw mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html#sklearn.linear_model.SGDClassifier" rel="noopener ugc nofollow" target="_blank">SGD分类器</a>(线性_模型包)</li><li id="58cd" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html" rel="noopener ugc nofollow" target="_blank">物流回收</a>(线性_模型包)</li><li id="429b" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html#sklearn.neighbors.KNeighborsClassifier" rel="noopener ugc nofollow" target="_blank">邻居分类器</a>(邻居包)</li><li id="0efd" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.tree.DecisionTreeClassifier.html" rel="noopener ugc nofollow" target="_blank">决策树分类器</a>(树包)</li><li id="009e" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html#sklearn.ensemble.RandomForestClassifier" rel="noopener ugc nofollow" target="_blank"> RandomForestClassifier </a>(集合包)</li><li id="d4b8" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.ExtraTreesClassifier.html#sklearn.ensemble.ExtraTreesClassifier" rel="noopener ugc nofollow" target="_blank">提取器</a>(套装)</li><li id="d39e" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html#sklearn.svm.LinearSVC" rel="noopener ugc nofollow" target="_blank">线性SVC </a>和<a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC" rel="noopener ugc nofollow" target="_blank"> SVC </a> (svc包)</li></ul><h2 id="4a55" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">技巧</h2><ul class=""><li id="93c0" class="ms mt it lt b lu lv lx ly ma mu me mv mi mw mm mx my mz na bi translated">如果你的数据小于100，000个样本(分类样本)，那么来自<a class="ae ky" href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.linear_model" rel="noopener ugc nofollow" target="_blank">线性模型包</a>的算法是一个好的开始；</li><li id="020e" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">想要快速输出有效结果吗？从决策树和随机森林(系综和树包)开始。</li><li id="3cd3" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">没有足够的数据，并希望您的模型能够正确概括？尝试最近邻或支持向量机算法。</li><li id="73ed" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">没有一个像预期的那样有效？尝试使用RandomizedSearchCV或GridSearchCV调整您的默认参数。</li></ul><h1 id="f63b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">使聚集</h1><p id="d862" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">当您需要根据样本的特征将样本分成不同的组合时，聚类算法非常有用。想根据客户的购买历史对他们进行分组吗？使用这种估计器。</p><h2 id="3a13" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">问题</h2><blockquote class="of og oh"><p id="d61e" class="lr ls oi lt b lu mn ju lw lx mo jx lz oj mp mc md ok mq mg mh ol mr mk ml mm im bi translated">基于这些资源，<strong class="lt iu">他们如何表现</strong>？</p></blockquote><h2 id="a034" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">试一试算法</h2><ul class=""><li id="abc4" class="ms mt it lt b lu lv lx ly ma mu me mv mi mw mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html#sklearn.cluster.KMeans" rel="noopener ugc nofollow" target="_blank">k表示</a></li><li id="bc05" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.MiniBatchKMeans.html#sklearn.cluster.MiniBatchKMeans" rel="noopener ugc nofollow" target="_blank">迷你批处理是指</a></li><li id="69c9" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.AgglomerativeClustering.html#sklearn.cluster.AgglomerativeClustering" rel="noopener ugc nofollow" target="_blank">凝聚聚类</a></li><li id="b9fe" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><a class="ae ky" href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.Birch.html#sklearn.cluster.Birch" rel="noopener ugc nofollow" target="_blank">桦树</a></li></ul><p id="596e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">它们都来自集群包。</p><h2 id="542c" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">技巧</h2><ul class=""><li id="f15e" class="ms mt it lt b lu lv lx ly ma mu me mv mi mw mm mx my mz na bi translated">每种方法都可以根据你想做的事情而有所不同，寻找合适的方法。</li><li id="7582" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">不知道从哪里开始？试试KMean算法。</li></ul><h1 id="497b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">还有更多</h1><p id="dbb6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你会注意到有更多的算法用于特殊用途，比如控制和关联等等。如果许多特征根本没有价值，我们使用第一种方法，因此我们清理数据集。其他的都是针对无监督学习和强化学习的，今天就不讨论了。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><h1 id="830d" class="kz la it bd lb lc nn le lf lg no li lj jz np ka ll kc nq kd ln kf nr kg lp lq bi translated">端到端机器学习模型创建</h1><p id="9e8e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">是时候创建我们的模型了。为了深入理解，请阅读我在代码中的所有主题。</p><h1 id="8efb" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">关于我们的数据</h1><p id="1f18" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们将使用UCI提供的成人人口普查数据集，<a class="ae ky" href="https://archive.ics.uci.edu/ml/datasets/Adult" rel="noopener ugc nofollow" target="_blank">点击此处</a>在网站上直接查看。背后的原因如下:</p><ul class=""><li id="d1b8" class="ms mt it lt b lu mn lx mo ma om me on mi oo mm mx my mz na bi translated">有空条目，所以我们需要填充它。</li><li id="184d" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">有分类值，所以我们需要将其转换成数字。</li></ul><p id="d7ae" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这是一个分类问题，我们想预测一个人的年收入是否超过5万英镑。我们期望一个布尔输出，如果大于50K将触发true，如果小于50K将触发false。让我们看看我们的数据集是什么样子的。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi op"><img src="../Images/44630d1b33696980ff5347dde80ce7bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W0gIPgYgfKmCKSuQ6halcw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由雷南·洛里科拍摄——中号</p></figure><h2 id="c210" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">1)数据清理</h2><p id="8d6f" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">任何机器学习项目的第一步都是准备好你的数据。填充空值，删除未使用的列，等等。这里我想做的第一件事是为列输入正确的名称。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi os"><img src="../Images/89658fd8bd0b7ed049eb33bc449c7012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5TUeitUVJewO0EYNAjUh4A.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://medium.com/@renfelo" rel="noopener">雷南·洛里科</a>拍摄——中号</p></figure><h2 id="c339" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">2)数据争论</h2><p id="99cf" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在是时候对我们的数据进行必要的修改了。删除不正确的符号，并将少于两个唯一值的列转换为数字。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ot"><img src="../Images/5f89d5b6a863079ca61c3eefb04b41d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wr5Hy--KCUGaX_L-JGuWkg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://medium.com/@renfelo" rel="noopener">雷南·罗利科</a>拍摄——中号</p></figure><h2 id="b4af" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">3)探索性数据分析(EDA)</h2><p id="d2eb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">好了，现在我们的数据看起来更友好了。在这个阶段，你需要回答当前出现的疑问。在开始管理您的模型之前，您需要完全了解引擎盖下是什么，所以不要害羞。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/4c500c39bb60aaaa17d5f76ed087fa67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qRCjkrEtuCIwd0Et2H6JZg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://medium.com/@renfelo" rel="noopener">雷南·洛里科</a>拍摄——中号</p></figure><p id="64f2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">问题1: </strong>根据性别，年收入高于和低于5万英镑的员工的年龄和每周工作时间有什么区别？</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ov"><img src="../Images/f0b40234710524e1829206f06e399ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c3omDkg93CS86xIRxHK-Fw.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://medium.com/@renfelo" rel="noopener">雷南·洛里科</a>拍摄——中号</p></figure><p id="543b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">问题2: </strong>我们的数据分布如何？有离群值？</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ow"><img src="../Images/54fac384737ab452d5dbc381482eb18e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MNl_2lQDpcRB9fPCXK5FAg.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://medium.com/@renfelo" rel="noopener">雷南·洛里科</a>拍摄——中号</p></figure><p id="1ac2" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">问题3: </strong>工作类型如何影响目标？</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/c5b5e34e0ae0bf505fbbdc51783398c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sFm9YK9jN65LVIWbXtHilQ.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://medium.com/@renfelo" rel="noopener">雷南·洛里科</a>拍摄——中号</p></figure><h2 id="938a" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">4)数据拆分</h2><p id="3de8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">是时候了，让我们开始处理数据吧。首先，我们需要创建拆分。更准确地说，是训练和测试。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="ce79" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你在做一个复杂的项目，也许需要将你的数据分成训练、验证和测试。这里的不同之处在于，您只是从测试数据中得到推论，并通过使用验证来调整您的模型。我准备了一个函数来帮助你。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><h2 id="6cd2" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">5)预处理</h2><p id="c3ea" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这一阶段，您可以对数据进行任何类型的修改，如规范化、标准化、编码、输入等等。在进入代码之前，让我们看看我将在这里做什么:</p><ul class=""><li id="8da6" class="ms mt it lt b lu mn lx mo ma om me on mi oo mm mx my mz na bi translated">首先，我们将创建管道来估算缺失值并对我们的分类特征进行编码；</li><li id="b397" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">最后，我将把这些管道放在ColumnTransformer中来修改我们的数据；</li></ul><p id="a36e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我已经添加了LabelEncoder，但是这里没有<strong class="lt iu">需要</strong>，我们的目标(y)已经被编码了。好，让我们看看它在代码上是什么样子。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="20ee" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">别担心，上面的代码什么都不做，我们以后会用到它。</p><h2 id="1e71" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">6)基本分数</h2><p id="f1a4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我们使用基本分数来大致了解我们的模型预测的好坏。在进行下一步之前，我们将删除得分最低的型号。我将使用三种不同的算法来创建模型:</p><ul class=""><li id="94c5" class="ms mt it lt b lu mn lx mo ma om me on mi oo mm mx my mz na bi translated">随机森林分类器</li><li id="b67a" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">近邻分类器</li><li id="27ca" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated">线性SVC</li></ul><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oy"><img src="../Images/6f09b1ef9542155e13a4b133b867fd7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*zfcKR31or-0RvHCeHiuwng.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">这是我们的产出。LinearSVC确实是故意做的不好。图片由<a class="ae ky" href="https://medium.com/@renfelo" rel="noopener">雷南·洛里科</a>拍摄——中号</p></figure><h2 id="7dff" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">7)指标</h2><p id="173b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">每种模型类型都有自己的一套度量标准。它用于输出模型的精度。下面我们来看看最知名的。</p><ul class=""><li id="270b" class="ms mt it lt b lu mn lx mo ma om me on mi oo mm mx my mz na bi translated"><strong class="lt iu">回归:</strong>回归指标基于平均值，即所有值的总和除以值的个数。最常用的是平均绝对误差(MAE)、均方误差(MSE)、均方根误差(RMSE)和均方根对数误差(RMSLE)。</li><li id="4939" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu">分类:</strong>根据分数，你可以检查你的推论有多少不一致性。一些指标是准确度、精确度、F1分数、召回率、日志损失和二进制交叉熵。</li><li id="4255" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm mx my mz na bi translated"><strong class="lt iu">聚类</strong>:肘法大家都知道，但更多的有:剪影系数、高斯混合、贝叶斯信息准则(BIC)比如；</li></ul><p id="5688" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请记住，任何项目都需要它们，但一点也不复杂。如果有疑问，就谷歌一下。</p><h2 id="90bf" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">8)超参数调谐</h2><p id="59a4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">了解了初始模型在基本参数集下的表现后，现在是时候尝试改进您的设置了。我们将使用交叉验证方法，在数据的不同部分测试我们的参数。</p><h2 id="b692" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">a)随机搜索</h2><p id="5b30" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这里没有什么玄机！你只需调整每个模型参数。最初，我们从RandomizedSearchCV开始，它将为每个参数随机选择一个值，并尝试寻找能够提供最佳结果的包。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/b4de33901df2e685a8c60b6f171bc474.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*3VCF1pdLhn_OtpGFkW3-0g.png"/></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://medium.com/@renfelo" rel="noopener">雷南·洛里科</a>拍摄——中号</p></figure><p id="407f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请注意，我已经创建了一个字典(第4行),它包含参数名，后跟一个可能值的列表。该字典放在RandomizedSearchCV的param_distributions参数中(第19行)。</p><h2 id="9c96" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">b) GridSearchCV</h2><p id="3f54" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">根据项目的复杂程度，您需要强制搜索以进行改进。与为每个参数随机选择一个值的随机搜索不同，GridSearchCV将尝试所有的值。</p><blockquote class="pa"><p id="f46f" class="pb pc it bd pd pe pf pg ph pi pj mm dk translated">记住你传入随机搜索的参数多少并不重要，但是这里不能夸大，要注意。</p></blockquote><figure class="pk pl pm pn po kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><p id="ca98" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你花在寻找改进上的时间越多，你的模型就变得越好。</p><p id="6c7a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在调整和评估您的模型之后，您将获得针对您的问题的最佳参数集。低于预期？试试别的型号。做得很好吗？可能是过拟合问题，下面来看看。</p><h2 id="0e69" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">9)欠拟合和过拟合</h2><p id="140d" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">这是一个额外的部分。你需要知道你的模型会面临什么问题，如何度过。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pp"><img src="../Images/7bb2c1e313b1749b6ab4e411e124e212.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nkNGbC0nHeRr5Kn2cqLBLA.png"/></div></div><p class="ku kv gj gh gi kw kx bd b be z dk translated">图片由<a class="ae ky" href="https://scikit-learn.org/stable/auto_examples/model_selection/plot_underfitting_overfitting.html" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a></p></figure><ol class=""><li id="b76a" class="ms mt it lt b lu mn lx mo ma om me on mi oo mm pq my mz na bi translated"><strong class="lt iu">欠拟合</strong>(图1)意味着你的算法不能很好地处理你的数据。第一个原因是没有足够的数据。此外，如果您的参数相关性不够，也会发生这种情况。来解决？<strong class="lt iu">尝试获取更多数据，应用更好的数据辩论，以及特性工程</strong>。如果你的模型一直输出不好的结果，也许你的数据不适合你的问题。</li><li id="1ea1" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm pq my mz na bi translated"><strong class="lt iu">过拟合</strong>(图3) <strong class="lt iu"> </strong>与上述刚好相反。你的估计值非常符合数据，相信我，这并不好。如果你的模型很好地学习了如何从训练数据中进行推断，你就会对新数据有问题。这通常是因为<strong class="lt iu">您已经用相同的数据</strong>训练和评估了您的模型，这就是为什么我们将数据集分为训练、验证和测试。</li><li id="ac64" class="ms mt it lt b lu nb lx nc ma nd me ne mi nf mm pq my mz na bi translated">图2是你需要瞄准的目标。非常适合，但也有一些偏差。</li></ol><h2 id="c54c" class="nt la it bd lb nu nv dn lf nw nx dp lj ma ny nz ll me oa ob ln mi oc od lp oe bi translated">10)最终模型</h2><p id="7c0e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">您已经为您的问题选择了最佳算法，学会了如何调整您的参数，并最终学会了如何防止一些问题。我们还讨论了评估模型的指标。很快，到目前为止你学到了很多。现在您可以创建最终的模型，即将投入生产的模型。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oq or l"/></div></figure><h1 id="536d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">就这样，伙计们！</h1><p id="1c51" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">希望你已经喜欢上了这个内容，能够融会贯通的应用你的新知识！如果你想每天坚持学一些有趣的东西，如果你跟着我，我真的会很开心！</p><p id="0cc3" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">另外，你可以查看我的Github个人资料。我从事一些数据科学项目已经有一段时间了。所有的关键概念都可以学习和重用！</p><div class="pr ps gp gr pt pu"><a href="https://github.com/renfelo" rel="noopener  ugc nofollow" target="_blank"><div class="pv ab fo"><div class="pw ab px cl cj py"><h2 class="bd iu gy z fp pz fr fs qa fu fw is bi translated">雷南·洛利科——GitHub</h2><div class="qb l"><h3 class="bd b gy z fp pz fr fs qa fu fw dk translated">在GitHub上注册你自己的个人资料，这是托管代码、管理项目和构建软件的最佳地方…</h3></div><div class="qc l"><p class="bd b dl z fp pz fr fs qa fu fw dk translated">github.com</p></div></div><div class="qd l"><div class="qe l qf qg qh qd qi ks pu"/></div></div></a></div></div></div>    
</body>
</html>