<html>
<head>
<title>GitHub for Data Scientists: Commit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学家 GitHub:提交</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/collaborate-on-github-like-a-pro-commit-d832e613b109?source=collection_archive---------65-----------------------#2020-08-24">https://towardsdatascience.com/collaborate-on-github-like-a-pro-commit-d832e613b109?source=collection_archive---------65-----------------------#2020-08-24</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><h2 id="04fa" class="is it iu bd b dl iv iw ix iy iz ja dk jb translated" aria-label="kicker paragraph">GitHub 的权威指南:提交</h2><div class=""/><div class=""><h2 id="4fba" class="pw-subtitle-paragraph ka jd iu bd b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dk translated">了解提交的组成部分、提交、重置或删除提交。</h2></div><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj ks"><img src="../Images/97f5cf263a6bf36883a09dda73922c8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*zkAHKfDLPh5BsyVTpbsDig.png"/></div><p class="la lb gk gi gj lc ld bd b be z dk translated">路易斯·尤西比奥(<a class="ae le" href="https://unsplash.com/@lceusebio" rel="noopener ugc nofollow" target="_blank">https://unsplash.com/@lceusebio</a>)的照片</p></figure><p id="a2e5" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated">本文是 GitHub 协作后续系列的一部分。本文将尝试详细理解提交，比如提交的组成部分，在推送之前和之后删除提交，或者重置提交。</p><p id="23eb" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated">对于初学者来说，强烈推荐快速阅读这篇文章，像 Pro: <strong class="lh je"> Part1 </strong>一样在 GitHub 上协作。</p><p id="acc5" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated">这个系列，像 pro 一样在 GitHub 上协作，关注特定的主题:</p><ol class=""><li id="9058" class="mb mc iu lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated"><strong class="lh je">GitHub 入门</strong> : <a class="ae le" href="https://medium.com/@snehal.1409/collaborate-on-github-like-a-pro-part1-8d11ccf12084" rel="noopener">像 Pro 一样在 GitHub 上协作:<strong class="lh je"> Part1 </strong> </a></li><li id="1656" class="mb mc iu lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><strong class="lh je">分支:</strong> <a class="ae le" href="https://medium.com/@snehal.1409/collaborate-on-github-like-pro-part2-26a6790e8f93" rel="noopener">像 Pro 一样在 GitHub 上协作:<strong class="lh je"> Part2 </strong> </a></li><li id="5dc6" class="mb mc iu lh b li mk ll ml lo mm ls mn lw mo ma mg mh mi mj bi translated"><strong class="lh je">提交:</strong>像 Pro 一样在 GitHub 上协作:<strong class="lh je">提交</strong></li></ol><h1 id="0986" class="mp mq iu bd mr ms mt mu mv mw mx my mz kj na kk nb km nc kn nd kp ne kq nf ng bi translated">什么是提交？</h1><p id="e29a" class="pw-post-body-paragraph lf lg iu lh b li nh ke lk ll ni kh ln lo nj lq lr ls nk lu lv lw nl ly lz ma in bi translated">提交是用<strong class="lh je"> git commit </strong>命令创建的，用于捕获项目的状态。Git 存储一个提交对象，该对象指向快照暂存内容(已索引)。请参见下面红框中突出显示的提交阶段。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj nm"><img src="../Images/e6fd590b427d5dae181eca7f8e4692a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*-b5WCLetICqvYEmL-758Cw.png"/></div><p class="la lb gk gi gj lc ld bd b be z dk translated">提交流程图</p></figure><h1 id="75c1" class="mp mq iu bd mr ms mt mu mv mw mx my mz kj na kk nb km nc kn nd kp ne kq nf ng bi translated">提交的组成部分:</h1><p id="f5cd" class="pw-post-body-paragraph lf lg iu lh b li nh ke lk ll ni kh ln lo nj lq lr ls nk lu lv lw nl ly lz ma in bi translated">让我们看一下提交对象，如下所示。提交中的三个主要组件包括<strong class="lh je">哈希</strong>、<strong class="lh je">头、</strong>和<strong class="lh je">分支</strong>(主)，如下所述。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj nn"><img src="../Images/f5929c8eb585a6a2265349f92ff1637c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*U-cEH_rQkoHEyM2ky3ACcA.png"/></div><p class="la lb gk gi gj lc ld bd b be z dk translated">提交对象</p></figure><p id="f758" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated"><strong class="lh je">散列</strong>:每次提交都会为各自的提交创建一个唯一的散列。稍后使用这些散列恢复到以前的版本，或者查找有关提交的详细信息。只需要前七个字符来查找各自的提交。</p><p id="5334" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated"><strong class="lh je">头</strong>:显示当前工作分支。在上图中，头指向主分支，这意味着当前的工作分支在主分支上。</p><p id="67d1" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated"><strong class="lh je">分支:</strong>默认情况下，开发的第一行(分支)命名为主。不同分支上的所有先前的工作被合并到 master。</p><p id="0dc3" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated">要进一步理解这个概念，请参考这篇博客<a class="ae le" href="https://git-scm.com/book/en/v2/Git-Branching-Branches-in-a-Nutshell" rel="noopener ugc nofollow" target="_blank">的帖子</a>。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj no"><img src="../Images/676a0a6e20cae2d38ea38e8caef0e108.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*gRugMBTNar8hl8OJSv_Y5Q.png"/></div><p class="la lb gk gi gj lc ld bd b be z dk translated">三次提交后主分支</p></figure><h1 id="341b" class="mp mq iu bd mr ms mt mu mv mw mx my mz kj na kk nb km nc kn nd kp ne kq nf ng bi translated">切换到特定提交</h1><p id="4545" class="pw-post-body-paragraph lf lg iu lh b li nh ke lk ll ni kh ln lo nj lq lr ls nk lu lv lw nl ly lz ma in bi translated">基于用例，有多种方法可以检验特定的提交，比如进行临时或永久的切换，后退几步添加一个特性。</p><h2 id="07bd" class="np mq iu bd mr nq nr dn mv ns nt dp mz lo nu nv nb ls nw nx nd lw ny nz nf ja bi translated">临时开关</h2><p id="a990" class="pw-post-body-paragraph lf lg iu lh b li nh ke lk ll ni kh ln lo nj lq lr ls nk lu lv lw nl ly lz ma in bi translated">要临时切换到第一次提交(7d8d1af)并从特定提交进行少量提交，请运行以下命令。</p><pre class="kt ku kv kw gu oa ob oc od aw oe bi"><span id="1f04" class="np mq iu ob b gz of og l oh oi">$ cd autos/ (git project root)<br/>$ git checkout 7d8d1af (Use hash if you know it, else)<br/>$ git checkout HEAD~3 (Use number of commits to go back, our case 3)</span><span id="d899" class="np mq iu ob b gz oj og l oh oi">$ git checkout -b new-branch 7d8d1af (create new branch on the commit)<br/>$ git checkout branch_name (to go back to respective branch)</span></pre><p id="0206" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated">当签出提交时，头被分离。<strong class="lh je">分离的头</strong>意味着该头没有指向最近的提交；相反，它指向签出时的提交。</p><figure class="kt ku kv kw gu kx gi gj paragraph-image"><div class="gi gj ok"><img src="../Images/f1c3144e15628e0fa211fa6d8ee9ad65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*Ad8eEyLALyf-nHty6e1T7w.png"/></div><p class="la lb gk gi gj lc ld bd b be z dk translated">临时提交签出流程</p></figure><h2 id="d5cd" class="np mq iu bd mr nq nr dn mv ns nt dp mz lo nu nv nb ls nw nx nd lw ny nz nf ja bi translated">永久开关</h2><p id="4d00" class="pw-post-body-paragraph lf lg iu lh b li nh ke lk ll ni kh ln lo nj lq lr ls nk lu lv lw nl ly lz ma in bi translated">要永久删除提交，使用<strong class="lh je"> Git reset </strong>。Git 复位主要有五种模式:<strong class="lh je">软、混合、合并、硬、保持</strong>。有关详细信息和不同的解决方案，请参考<a class="ae le" href="https://stackoverflow.com/questions/4114095/how-do-i-revert-a-git-repository-to-a-previous-commit/4114122#4114122" rel="noopener ugc nofollow" target="_blank">堆栈溢出</a>。</p><ul class=""><li id="fa0d" class="mb mc iu lh b li lj ll lm lo md ls me lw mf ma ol mh mi mj bi translated"><strong class="lh je"> Git reset — hard </strong>将更改磁头、索引(阶段)和工作目录。记得运行<strong class="lh je"> git status 来</strong>检查工作树是否干净，否则所有未提交的更改都将丢失。</li><li id="330d" class="mb mc iu lh b li mk ll ml lo mm ls mn lw mo ma ol mh mi mj bi translated"><strong class="lh je"> Git 复位—软</strong>将改变磁头，不改变索引(阶段)或工作目录。这是最安全的选择。</li></ul><p id="b831" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated">例如，我们希望重置到第一次提交(7d8d1af)。处理这种情况有两种方法。</p><ol class=""><li id="f9b2" class="mb mc iu lh b li lj ll lm lo md ls me lw mf ma mg mh mi mj bi translated"><strong class="lh je">提交未推送到远程</strong></li></ol><p id="12e2" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated">总是运行 git status 来检查工作树是否干净。要仅删除当前提交，但保留文件并对其进行索引，请使用 soft。</p><pre class="kt ku kv kw gu oa ob oc od aw oe bi"><span id="c02d" class="np mq iu ob b gz of og l oh oi">$ cd autos/ (git project root)<br/>$ git reset --soft HEAD~3</span></pre><p id="5640" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated">“工作树是干净的”意味着没有你可以失去的未提交的工作。在这种情况下，安全地使用<strong class="lh je">硬</strong>。</p><pre class="kt ku kv kw gu oa ob oc od aw oe bi"><span id="27da" class="np mq iu ob b gz of og l oh oi">$ cd autos/ (git project root)<br/>$ git reset --hard 7d8d1af (Use hash if you know it, else)<br/>$ git reset HEAD~3 (Use number of commits to go back, our case 3)</span></pre><p id="6f31" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated">在“工作树是<strong class="lh je">而不是</strong>干净的”的情况下，你知道如果你直接使用 hard 可能会丢失一些未提交的工作，在命令 hard 之前运行“stash”来保存你的本地更改。</p><pre class="kt ku kv kw gu oa ob oc od aw oe bi"><span id="26a3" class="np mq iu ob b gz of og l oh oi">$ cd autos/ (git project root)<br/>$ git stash<br/>$ git reset --hard 7d8d1af<br/>$ git stash pop</span></pre><p id="d294" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated"><strong class="lh je"> 2。提交推送到远程</strong></p><pre class="kt ku kv kw gu oa ob oc od aw oe bi"><span id="4110" class="np mq iu ob b gz of og l oh oi">$ git revert --no-commit 7d8d1af HEAD<br/>$ git commit<br/>$ git push</span><span id="07dc" class="np mq iu ob b gz oj og l oh oi"># To abort the above steps<br/>git revert --abort</span></pre><p id="8f76" class="pw-post-body-paragraph lf lg iu lh b li lj ke lk ll lm kh ln lo lp lq lr ls lt lu lv lw lx ly lz ma in bi translated">要了解更多关于 git 重置/恢复和返回到 Git 中先前状态的信息，请参考这篇写得很好的<a class="ae le" href="https://opensource.com/article/18/6/git-reset-revert-rebase-commands" rel="noopener ugc nofollow" target="_blank">博客</a>，有关代码，请参考<a class="ae le" href="https://github.com/snehalnair/collaborate-github" rel="noopener ugc nofollow" target="_blank"> GitHub 库</a>。</p><h2 id="22ae" class="np mq iu bd mr nq nr dn mv ns nt dp mz lo nu nv nb ls nw nx nd lw ny nz nf ja bi translated">参考:</h2><p id="9cd3" class="pw-post-body-paragraph lf lg iu lh b li nh ke lk ll ni kh ln lo nj lq lr ls nk lu lv lw nl ly lz ma in bi translated"><a class="ae le" href="https://stackoverflow.com/questions/4114095/how-do-i-revert-a-git-repository-to-a-previous-commit/4114122#4114122" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/4114095/how-do-I-revert-a-git-repository-to-a-previous-commit/4114122 # 4114122</a></p></div></div>    
</body>
</html>